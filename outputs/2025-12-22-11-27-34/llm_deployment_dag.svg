<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="469pt" height="2160pt"
 viewBox="0.00 0.00 469.12 2160.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.1 0.1) rotate(0) translate(4 21896.93)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-21896.93 4752.6,-21896.93 4752.6,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_legend</title>
<polygon fill="none" stroke="gray" stroke-dasharray="5,2" points="2417,-21809.93 2417,-21884.93 2980,-21884.93 2980,-21809.93 2417,-21809.93"/>
<text text-anchor="middle" x="2698.5" y="-21869.73" font-family="Times,serif" font-size="14.00">Legend</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightpink" stroke="black" cx="2323" cy="-21835.93" rx="84.29" ry="36.54"/>
<text text-anchor="middle" x="2323" y="-21849.93" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="2323" y="-21838.93" font-family="Arial" font-size="10.00">Batch: 2048 sequences</text>
<text text-anchor="middle" x="2323" y="-21827.93" font-family="Arial" font-size="10.00">Seq_len: 512</text>
<text text-anchor="middle" x="2323" y="-21816.93" font-family="Arial" font-size="10.00">GPU: All</text>
</g>
<!-- dp_split -->
<g id="node2" class="node">
<title>dp_split</title>
<polygon fill="lightyellow" stroke="black" points="2421.48,-21743.16 2264.82,-21743.16 2224.52,-21661.16 2381.18,-21661.16 2421.48,-21743.16"/>
<text text-anchor="middle" x="2323" y="-21710.66" font-family="Arial" font-size="10.00">Data Parallel Split</text>
<text text-anchor="middle" x="2323" y="-21699.66" font-family="Arial" font-size="10.00">256 seq/GPU</text>
<text text-anchor="middle" x="2323" y="-21688.66" font-family="Arial" font-size="10.00">GPU: All</text>
</g>
<!-- input&#45;&gt;dp_split -->
<g id="edge1" class="edge">
<title>input&#45;&gt;dp_split</title>
<path fill="none" stroke="black" d="M2323,-21798.93C2323,-21784.94 2323,-21768.66 2323,-21753.54"/>
<polygon fill="black" stroke="black" points="2326.5,-21753.3 2323,-21743.3 2319.5,-21753.3 2326.5,-21753.3"/>
<text text-anchor="middle" x="2365.5" y="-21773.96" font-family="Arial" font-size="9.00">Split batch</text>
<text text-anchor="middle" x="2365.5" y="-21763.96" font-family="Arial" font-size="9.00">2048â†’256 seq/GPU</text>
</g>
<!-- gpu0_embed -->
<g id="node3" class="node">
<title>gpu0_embed</title>
<polygon fill="lightblue" stroke="black" points="1886,-21605.16 1764,-21605.16 1764,-21553.16 1886,-21553.16 1886,-21605.16"/>
<text text-anchor="middle" x="1825" y="-21593.16" font-family="Arial" font-size="10.00">Embedding Layer</text>
<text text-anchor="middle" x="1825" y="-21582.16" font-family="Arial" font-size="10.00">Input: [256, 512]</text>
<text text-anchor="middle" x="1825" y="-21571.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1825" y="-21560.16" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- dp_split&#45;&gt;gpu0_embed -->
<g id="edge2" class="edge">
<title>dp_split&#45;&gt;gpu0_embed</title>
<path fill="none" stroke="black" d="M2238.63,-21690.19C2172.5,-21680.61 2078.53,-21664.84 1998,-21643.16 1963.59,-21633.9 1926.35,-21620.76 1895.26,-21608.88"/>
<polygon fill="black" stroke="black" points="1896.41,-21605.57 1885.82,-21605.24 1893.89,-21612.1 1896.41,-21605.57"/>
<text text-anchor="middle" x="2030" y="-21635.96" font-family="Arial" font-size="9.00">GPU 0</text>
<text text-anchor="middle" x="2030" y="-21625.96" font-family="Arial" font-size="9.00">256 sequences</text>
</g>
<!-- gpu1_embed -->
<g id="node263" class="node">
<title>gpu1_embed</title>
<polygon fill="lightblue" stroke="black" points="2030,-21605.16 1908,-21605.16 1908,-21553.16 2030,-21553.16 2030,-21605.16"/>
<text text-anchor="middle" x="1969" y="-21593.16" font-family="Arial" font-size="10.00">Embedding Layer</text>
<text text-anchor="middle" x="1969" y="-21582.16" font-family="Arial" font-size="10.00">Input: [256, 512]</text>
<text text-anchor="middle" x="1969" y="-21571.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1969" y="-21560.16" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- dp_split&#45;&gt;gpu1_embed -->
<g id="edge326" class="edge">
<title>dp_split&#45;&gt;gpu1_embed</title>
<path fill="none" stroke="black" d="M2233.16,-21679.17C2195.92,-21669.3 2152.51,-21656.8 2114,-21643.16 2086.35,-21633.37 2056.51,-21620.78 2031.14,-21609.43"/>
<polygon fill="black" stroke="black" points="2032.56,-21606.23 2022,-21605.31 2029.68,-21612.61 2032.56,-21606.23"/>
<text text-anchor="middle" x="2146" y="-21635.96" font-family="Arial" font-size="9.00">GPU 1</text>
<text text-anchor="middle" x="2146" y="-21625.96" font-family="Arial" font-size="9.00">256 sequences</text>
</g>
<!-- gpu2_embed -->
<g id="node523" class="node">
<title>gpu2_embed</title>
<polygon fill="lightblue" stroke="black" points="2172,-21605.16 2050,-21605.16 2050,-21553.16 2172,-21553.16 2172,-21605.16"/>
<text text-anchor="middle" x="2111" y="-21593.16" font-family="Arial" font-size="10.00">Embedding Layer</text>
<text text-anchor="middle" x="2111" y="-21582.16" font-family="Arial" font-size="10.00">Input: [256, 512]</text>
<text text-anchor="middle" x="2111" y="-21571.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2111" y="-21560.16" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- dp_split&#45;&gt;gpu2_embed -->
<g id="edge650" class="edge">
<title>dp_split&#45;&gt;gpu2_embed</title>
<path fill="none" stroke="black" d="M2244.37,-21661.03C2233.42,-21655.17 2222.38,-21649.1 2212,-21643.16 2194.28,-21633.03 2175.2,-21621.33 2158.44,-21610.79"/>
<polygon fill="black" stroke="black" points="2160.23,-21607.79 2149.91,-21605.4 2156.49,-21613.7 2160.23,-21607.79"/>
<text text-anchor="middle" x="2244" y="-21635.96" font-family="Arial" font-size="9.00">GPU 2</text>
<text text-anchor="middle" x="2244" y="-21625.96" font-family="Arial" font-size="9.00">256 sequences</text>
</g>
<!-- gpu3_embed -->
<g id="node783" class="node">
<title>gpu3_embed</title>
<polygon fill="lightblue" stroke="black" points="2314,-21605.16 2192,-21605.16 2192,-21553.16 2314,-21553.16 2314,-21605.16"/>
<text text-anchor="middle" x="2253" y="-21593.16" font-family="Arial" font-size="10.00">Embedding Layer</text>
<text text-anchor="middle" x="2253" y="-21582.16" font-family="Arial" font-size="10.00">Input: [256, 512]</text>
<text text-anchor="middle" x="2253" y="-21571.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2253" y="-21560.16" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- dp_split&#45;&gt;gpu3_embed -->
<g id="edge974" class="edge">
<title>dp_split&#45;&gt;gpu3_embed</title>
<path fill="none" stroke="black" d="M2299.69,-21660.87C2290.93,-21645.73 2281.07,-21628.68 2272.67,-21614.16"/>
<polygon fill="black" stroke="black" points="2275.69,-21612.39 2267.65,-21605.49 2269.63,-21615.9 2275.69,-21612.39"/>
<text text-anchor="middle" x="2320" y="-21635.96" font-family="Arial" font-size="9.00">GPU 3</text>
<text text-anchor="middle" x="2320" y="-21625.96" font-family="Arial" font-size="9.00">256 sequences</text>
</g>
<!-- gpu4_embed -->
<g id="node1043" class="node">
<title>gpu4_embed</title>
<polygon fill="lightblue" stroke="black" points="2455,-21605.16 2333,-21605.16 2333,-21553.16 2455,-21553.16 2455,-21605.16"/>
<text text-anchor="middle" x="2394" y="-21593.16" font-family="Arial" font-size="10.00">Embedding Layer</text>
<text text-anchor="middle" x="2394" y="-21582.16" font-family="Arial" font-size="10.00">Input: [256, 512]</text>
<text text-anchor="middle" x="2394" y="-21571.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2394" y="-21560.16" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- dp_split&#45;&gt;gpu4_embed -->
<g id="edge1298" class="edge">
<title>dp_split&#45;&gt;gpu4_embed</title>
<path fill="none" stroke="black" d="M2346.64,-21660.87C2355.53,-21645.73 2365.53,-21628.68 2374.05,-21614.16"/>
<polygon fill="black" stroke="black" points="2377.1,-21615.89 2379.14,-21605.49 2371.06,-21612.34 2377.1,-21615.89"/>
<text text-anchor="middle" x="2399" y="-21635.96" font-family="Arial" font-size="9.00">GPU 4</text>
<text text-anchor="middle" x="2399" y="-21625.96" font-family="Arial" font-size="9.00">256 sequences</text>
</g>
<!-- gpu5_embed -->
<g id="node1303" class="node">
<title>gpu5_embed</title>
<polygon fill="lightblue" stroke="black" points="2596,-21605.16 2474,-21605.16 2474,-21553.16 2596,-21553.16 2596,-21605.16"/>
<text text-anchor="middle" x="2535" y="-21593.16" font-family="Arial" font-size="10.00">Embedding Layer</text>
<text text-anchor="middle" x="2535" y="-21582.16" font-family="Arial" font-size="10.00">Input: [256, 512]</text>
<text text-anchor="middle" x="2535" y="-21571.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2535" y="-21560.16" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- dp_split&#45;&gt;gpu5_embed -->
<g id="edge1622" class="edge">
<title>dp_split&#45;&gt;gpu5_embed</title>
<path fill="none" stroke="black" d="M2385.71,-21669.87C2401.91,-21661.47 2419.23,-21652.2 2435,-21643.16 2452.59,-21633.09 2471.49,-21621.41 2488.08,-21610.87"/>
<polygon fill="black" stroke="black" points="2489.98,-21613.81 2496.52,-21605.47 2486.21,-21607.91 2489.98,-21613.81"/>
<text text-anchor="middle" x="2500" y="-21635.96" font-family="Arial" font-size="9.00">GPU 5</text>
<text text-anchor="middle" x="2500" y="-21625.96" font-family="Arial" font-size="9.00">256 sequences</text>
</g>
<!-- gpu6_embed -->
<g id="node1563" class="node">
<title>gpu6_embed</title>
<polygon fill="lightblue" stroke="black" points="2739,-21605.16 2617,-21605.16 2617,-21553.16 2739,-21553.16 2739,-21605.16"/>
<text text-anchor="middle" x="2678" y="-21593.16" font-family="Arial" font-size="10.00">Embedding Layer</text>
<text text-anchor="middle" x="2678" y="-21582.16" font-family="Arial" font-size="10.00">Input: [256, 512]</text>
<text text-anchor="middle" x="2678" y="-21571.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2678" y="-21560.16" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- dp_split&#45;&gt;gpu6_embed -->
<g id="edge1946" class="edge">
<title>dp_split&#45;&gt;gpu6_embed</title>
<path fill="none" stroke="black" d="M2392.89,-21684.98C2434.86,-21674.56 2489.06,-21659.86 2536,-21643.16 2563.15,-21633.51 2592.38,-21620.94 2617.21,-21609.57"/>
<polygon fill="black" stroke="black" points="2618.89,-21612.65 2626.5,-21605.28 2615.96,-21606.29 2618.89,-21612.65"/>
<text text-anchor="middle" x="2615" y="-21635.96" font-family="Arial" font-size="9.00">GPU 6</text>
<text text-anchor="middle" x="2615" y="-21625.96" font-family="Arial" font-size="9.00">256 sequences</text>
</g>
<!-- gpu7_embed -->
<g id="node1823" class="node">
<title>gpu7_embed</title>
<polygon fill="lightblue" stroke="black" points="2887,-21605.16 2765,-21605.16 2765,-21553.16 2887,-21553.16 2887,-21605.16"/>
<text text-anchor="middle" x="2826" y="-21593.16" font-family="Arial" font-size="10.00">Embedding Layer</text>
<text text-anchor="middle" x="2826" y="-21582.16" font-family="Arial" font-size="10.00">Input: [256, 512]</text>
<text text-anchor="middle" x="2826" y="-21571.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2826" y="-21560.16" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- dp_split&#45;&gt;gpu7_embed -->
<g id="edge2270" class="edge">
<title>dp_split&#45;&gt;gpu7_embed</title>
<path fill="none" stroke="black" d="M2396.41,-21691.84C2463.4,-21682.47 2564.81,-21666.12 2651,-21643.16 2685.92,-21633.86 2723.76,-21620.65 2755.29,-21608.73"/>
<polygon fill="black" stroke="black" points="2756.76,-21611.91 2764.86,-21605.08 2754.27,-21605.37 2756.76,-21611.91"/>
<text text-anchor="middle" x="2746" y="-21635.96" font-family="Arial" font-size="9.00">GPU 7</text>
<text text-anchor="middle" x="2746" y="-21625.96" font-family="Arial" font-size="9.00">256 sequences</text>
</g>
<!-- gpu0_layer0_ln1 -->
<g id="node4" class="node">
<title>gpu0_layer0_ln1</title>
<polygon fill="lightblue" stroke="black" points="1824,-21516.16 1702,-21516.16 1702,-21464.16 1824,-21464.16 1824,-21516.16"/>
<text text-anchor="middle" x="1763" y="-21504.16" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="1763" y="-21493.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1763" y="-21482.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1763" y="-21471.16" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_embed&#45;&gt;gpu0_layer0_ln1 -->
<g id="edge7" class="edge">
<title>gpu0_embed&#45;&gt;gpu0_layer0_ln1</title>
<path fill="none" stroke="black" d="M1807.07,-21553C1800.77,-21544.16 1793.59,-21534.09 1786.88,-21524.68"/>
<polygon fill="black" stroke="black" points="1789.55,-21522.38 1780.89,-21516.27 1783.85,-21526.45 1789.55,-21522.38"/>
</g>
<!-- gpu0_layer0_qkv -->
<g id="node5" class="node">
<title>gpu0_layer0_qkv</title>
<polygon fill="lightblue" stroke="black" points="1767,-21427.16 1645,-21427.16 1645,-21375.16 1767,-21375.16 1767,-21427.16"/>
<text text-anchor="middle" x="1706" y="-21415.16" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1706" y="-21404.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1706" y="-21393.16" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="1706" y="-21382.16" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer0_ln1&#45;&gt;gpu0_layer0_qkv -->
<g id="edge8" class="edge">
<title>gpu0_layer0_ln1&#45;&gt;gpu0_layer0_qkv</title>
<path fill="none" stroke="black" d="M1746.51,-21464C1740.72,-21455.16 1734.12,-21445.09 1727.96,-21435.68"/>
<polygon fill="black" stroke="black" points="1730.86,-21433.72 1722.45,-21427.27 1725,-21437.55 1730.86,-21433.72"/>
</g>
<!-- gpu0_layer0_reshape -->
<g id="node6" class="node">
<title>gpu0_layer0_reshape</title>
<polygon fill="lightblue" stroke="black" points="1766,-21338.16 1638,-21338.16 1638,-21286.16 1766,-21286.16 1766,-21338.16"/>
<text text-anchor="middle" x="1702" y="-21326.16" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="1702" y="-21315.16" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="1702" y="-21304.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1702" y="-21293.16" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer0_qkv&#45;&gt;gpu0_layer0_reshape -->
<g id="edge9" class="edge">
<title>gpu0_layer0_qkv&#45;&gt;gpu0_layer0_reshape</title>
<path fill="none" stroke="black" d="M1704.84,-21375C1704.46,-21366.7 1704.03,-21357.32 1703.62,-21348.41"/>
<polygon fill="black" stroke="black" points="1707.11,-21348.1 1703.15,-21338.27 1700.12,-21348.42 1707.11,-21348.1"/>
</g>
<!-- gpu0_layer0_attn -->
<g id="node7" class="node">
<title>gpu0_layer0_attn</title>
<polygon fill="lightblue" stroke="black" points="1669,-21249.16 1541,-21249.16 1541,-21197.16 1669,-21197.16 1669,-21249.16"/>
<text text-anchor="middle" x="1605" y="-21237.16" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1605" y="-21226.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1605" y="-21215.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1605" y="-21204.16" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer0_reshape&#45;&gt;gpu0_layer0_attn -->
<g id="edge10" class="edge">
<title>gpu0_layer0_reshape&#45;&gt;gpu0_layer0_attn</title>
<path fill="none" stroke="black" d="M1673.94,-21286C1663.49,-21276.62 1651.48,-21265.85 1640.45,-21255.96"/>
<polygon fill="black" stroke="black" points="1642.77,-21253.34 1632.99,-21249.27 1638.1,-21258.55 1642.77,-21253.34"/>
</g>
<!-- gpu0_layer0_attn_reshape -->
<g id="node9" class="node">
<title>gpu0_layer0_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1423,-21160.16 1301,-21160.16 1301,-21108.16 1423,-21108.16 1423,-21160.16"/>
<text text-anchor="middle" x="1362" y="-21148.16" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="1362" y="-21137.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1362" y="-21126.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1362" y="-21115.16" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer0_attn&#45;&gt;gpu0_layer0_attn_reshape -->
<g id="edge11" class="edge">
<title>gpu0_layer0_attn&#45;&gt;gpu0_layer0_attn_reshape</title>
<path fill="none" stroke="black" d="M1540.84,-21199.19C1507.55,-21187.27 1466.81,-21172.69 1432.62,-21160.45"/>
<polygon fill="black" stroke="black" points="1433.76,-21157.14 1423.17,-21157.06 1431.4,-21163.73 1433.76,-21157.14"/>
</g>
<!-- gpu0_layer0_attn_out -->
<g id="node8" class="node">
<title>gpu0_layer0_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1310,-21071.16 1188,-21071.16 1188,-21019.16 1310,-21019.16 1310,-21071.16"/>
<text text-anchor="middle" x="1249" y="-21059.16" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="1249" y="-21048.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1249" y="-21037.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1249" y="-21026.16" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer0_kv_update -->
<g id="node10" class="node">
<title>gpu0_layer0_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="1230" cy="-20945.4" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="1230" y="-20959.4" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="1230" y="-20948.4" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1230" y="-20937.4" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1230" y="-20926.4" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer0_attn_out&#45;&gt;gpu0_layer0_kv_update -->
<g id="edge13" class="edge">
<title>gpu0_layer0_attn_out&#45;&gt;gpu0_layer0_kv_update</title>
<path fill="none" stroke="black" d="M1244.11,-21018.99C1242.51,-21010.76 1240.68,-21001.35 1238.88,-20992.09"/>
<polygon fill="black" stroke="black" points="1242.3,-20991.32 1236.95,-20982.17 1235.43,-20992.66 1242.3,-20991.32"/>
</g>
<!-- gpu0_layer0_attn_reshape&#45;&gt;gpu0_layer0_attn_out -->
<g id="edge12" class="edge">
<title>gpu0_layer0_attn_reshape&#45;&gt;gpu0_layer0_attn_out</title>
<path fill="none" stroke="black" d="M1329.32,-21108C1316.9,-21098.44 1302.61,-21087.44 1289.55,-21077.39"/>
<polygon fill="black" stroke="black" points="1291.67,-21074.6 1281.61,-21071.27 1287.4,-21080.15 1291.67,-21074.6"/>
</g>
<!-- gpu0_layer0_res1 -->
<g id="node11" class="node">
<title>gpu0_layer0_res1</title>
<polygon fill="lightblue" stroke="black" points="1106,-20871.63 984,-20871.63 984,-20819.63 1106,-20819.63 1106,-20871.63"/>
<text text-anchor="middle" x="1045" y="-20859.63" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="1045" y="-20848.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1045" y="-20837.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1045" y="-20826.63" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer0_kv_update&#45;&gt;gpu0_layer0_res1 -->
<g id="edge14" class="edge">
<title>gpu0_layer0_kv_update&#45;&gt;gpu0_layer0_res1</title>
<path fill="none" stroke="black" d="M1176.99,-20916.38C1153.32,-20903.87 1125.4,-20889.12 1101.35,-20876.41"/>
<polygon fill="black" stroke="black" points="1102.82,-20873.22 1092.34,-20871.65 1099.55,-20879.41 1102.82,-20873.22"/>
</g>
<!-- gpu0_layer0_ln2 -->
<g id="node12" class="node">
<title>gpu0_layer0_ln2</title>
<polygon fill="lightblue" stroke="black" points="598,-20782.63 476,-20782.63 476,-20730.63 598,-20730.63 598,-20782.63"/>
<text text-anchor="middle" x="537" y="-20770.63" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="537" y="-20759.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="537" y="-20748.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="537" y="-20737.63" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer0_res1&#45;&gt;gpu0_layer0_ln2 -->
<g id="edge15" class="edge">
<title>gpu0_layer0_res1&#45;&gt;gpu0_layer0_ln2</title>
<path fill="none" stroke="black" d="M983.98,-20834.17C889.55,-20818 708.47,-20786.99 608.21,-20769.82"/>
<polygon fill="black" stroke="black" points="608.62,-20766.34 598.17,-20768.1 607.43,-20773.24 608.62,-20766.34"/>
</g>
<!-- gpu0_layer0_routing -->
<g id="node13" class="node">
<title>gpu0_layer0_routing</title>
<polygon fill="lightyellow" stroke="black" points="536.47,-20693.63 335.29,-20693.63 283.53,-20567.63 484.71,-20567.63 536.47,-20693.63"/>
<text text-anchor="middle" x="410" y="-20650.13" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="410" y="-20639.13" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="410" y="-20628.13" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="410" y="-20617.13" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="410" y="-20606.13" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer0_ln2&#45;&gt;gpu0_layer0_routing -->
<g id="edge16" class="edge">
<title>gpu0_layer0_ln2&#45;&gt;gpu0_layer0_routing</title>
<path fill="none" stroke="black" d="M511.3,-20730.53C502.32,-20721.77 491.76,-20711.45 480.9,-20700.85"/>
<polygon fill="black" stroke="black" points="483.34,-20698.34 473.74,-20693.86 478.45,-20703.35 483.34,-20698.34"/>
</g>
<!-- gpu0_layer0_expert0 -->
<g id="node14" class="node">
<title>gpu0_layer0_expert0</title>
<polygon fill="lightblue" stroke="black" points="122,-20521.63 0,-20521.63 0,-20469.63 122,-20469.63 122,-20521.63"/>
<text text-anchor="middle" x="61" y="-20509.63" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="61" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer0_routing&#45;&gt;gpu0_layer0_expert0 -->
<g id="edge3" class="edge">
<title>gpu0_layer0_routing&#45;&gt;gpu0_layer0_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M289.89,-20583.85C237.25,-20563.79 177.26,-20540.93 131.91,-20523.65"/>
<polygon fill="black" stroke="black" points="133.05,-20520.34 122.46,-20520.05 130.56,-20526.88 133.05,-20520.34"/>
<text text-anchor="middle" x="223.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer0_expert1 -->
<g id="node15" class="node">
<title>gpu0_layer0_expert1</title>
<polygon fill="lightblue" stroke="black" points="262,-20521.63 140,-20521.63 140,-20469.63 262,-20469.63 262,-20521.63"/>
<text text-anchor="middle" x="201" y="-20509.63" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="201" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer0_routing&#45;&gt;gpu0_layer0_expert1 -->
<g id="edge4" class="edge">
<title>gpu0_layer0_routing&#45;&gt;gpu0_layer0_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M312.54,-20567.6C290.39,-20553.51 267.82,-20539.14 248.82,-20527.06"/>
<polygon fill="black" stroke="black" points="250.68,-20524.09 240.37,-20521.68 246.92,-20530 250.68,-20524.09"/>
<text text-anchor="middle" x="310.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer0_expert2 -->
<g id="node16" class="node">
<title>gpu0_layer0_expert2</title>
<polygon fill="lightblue" stroke="black" points="402,-20521.63 280,-20521.63 280,-20469.63 402,-20469.63 402,-20521.63"/>
<text text-anchor="middle" x="341" y="-20509.63" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="341" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer0_routing&#45;&gt;gpu0_layer0_expert2 -->
<g id="edge5" class="edge">
<title>gpu0_layer0_routing&#45;&gt;gpu0_layer0_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M377.72,-20567.41C371.2,-20554.84 364.57,-20542.06 358.78,-20530.89"/>
<polygon fill="black" stroke="black" points="361.83,-20529.18 354.12,-20521.92 355.62,-20532.41 361.83,-20529.18"/>
<text text-anchor="middle" x="397.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer0_expert3 -->
<g id="node17" class="node">
<title>gpu0_layer0_expert3</title>
<polygon fill="lightblue" stroke="black" points="542,-20521.63 420,-20521.63 420,-20469.63 542,-20469.63 542,-20521.63"/>
<text text-anchor="middle" x="481" y="-20509.63" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="481" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer0_routing&#45;&gt;gpu0_layer0_expert3 -->
<g id="edge6" class="edge">
<title>gpu0_layer0_routing&#45;&gt;gpu0_layer0_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M443.21,-20567.41C449.92,-20554.84 456.74,-20542.06 462.71,-20530.89"/>
<polygon fill="black" stroke="black" points="465.88,-20532.39 467.5,-20521.92 459.7,-20529.09 465.88,-20532.39"/>
<text text-anchor="middle" x="488.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer0_expert_agg -->
<g id="node18" class="node">
<title>gpu0_layer0_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-20432.63 266.29,-20432.63 214.53,-20328.63 415.71,-20328.63 467.47,-20432.63"/>
<text text-anchor="middle" x="341" y="-20394.63" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="341" y="-20383.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-20372.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-20361.63" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer0_routing&#45;&gt;gpu0_layer0_expert_agg -->
<g id="edge21" class="edge">
<title>gpu0_layer0_routing&#45;&gt;gpu0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M492.28,-20584.75C537.35,-20554.09 578.89,-20511.55 551,-20469.63 530.44,-20438.71 496.7,-20418.64 462.22,-20405.61"/>
<polygon fill="black" stroke="black" points="463.08,-20402.2 452.48,-20402.12 460.71,-20408.79 463.08,-20402.2"/>
</g>
<!-- gpu0_layer0_expert0&#45;&gt;gpu0_layer0_expert_agg -->
<g id="edge17" class="edge">
<title>gpu0_layer0_expert0&#45;&gt;gpu0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M122.1,-20469.97C158.98,-20455.08 206.7,-20435.83 248.16,-20419.09"/>
<polygon fill="black" stroke="black" points="249.5,-20422.33 257.46,-20415.34 246.88,-20415.84 249.5,-20422.33"/>
</g>
<!-- gpu0_layer0_expert1&#45;&gt;gpu0_layer0_expert_agg -->
<g id="edge18" class="edge">
<title>gpu0_layer0_expert1&#45;&gt;gpu0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M232.07,-20469.55C243.32,-20460.47 256.53,-20449.81 269.8,-20439.1"/>
<polygon fill="black" stroke="black" points="272.02,-20441.8 277.6,-20432.8 267.62,-20436.35 272.02,-20441.8"/>
</g>
<!-- gpu0_layer0_expert2&#45;&gt;gpu0_layer0_expert_agg -->
<g id="edge19" class="edge">
<title>gpu0_layer0_expert2&#45;&gt;gpu0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M341,-20469.55C341,-20461.62 341,-20452.48 341,-20443.16"/>
<polygon fill="black" stroke="black" points="344.5,-20443.03 341,-20433.03 337.5,-20443.03 344.5,-20443.03"/>
</g>
<!-- gpu0_layer0_expert3&#45;&gt;gpu0_layer0_expert_agg -->
<g id="edge20" class="edge">
<title>gpu0_layer0_expert3&#45;&gt;gpu0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M449.93,-20469.55C438.68,-20460.47 425.47,-20449.81 412.2,-20439.1"/>
<polygon fill="black" stroke="black" points="414.38,-20436.35 404.4,-20432.8 409.98,-20441.8 414.38,-20436.35"/>
</g>
<!-- gpu0_layer0_res2 -->
<g id="node19" class="node">
<title>gpu0_layer0_res2</title>
<polygon fill="lightblue" stroke="black" points="402,-20291.63 280,-20291.63 280,-20239.63 402,-20239.63 402,-20291.63"/>
<text text-anchor="middle" x="341" y="-20279.63" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="341" y="-20268.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-20257.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-20246.63" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer0_expert_agg&#45;&gt;gpu0_layer0_res2 -->
<g id="edge22" class="edge">
<title>gpu0_layer0_expert_agg&#45;&gt;gpu0_layer0_res2</title>
<path fill="none" stroke="black" d="M341,-20328.42C341,-20319.46 341,-20310.34 341,-20301.94"/>
<polygon fill="black" stroke="black" points="344.5,-20301.76 341,-20291.76 337.5,-20301.76 344.5,-20301.76"/>
</g>
<!-- gpu0_layer1_ln1 -->
<g id="node20" class="node">
<title>gpu0_layer1_ln1</title>
<polygon fill="lightblue" stroke="black" points="402,-20202.63 280,-20202.63 280,-20150.63 402,-20150.63 402,-20202.63"/>
<text text-anchor="middle" x="341" y="-20190.63" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="341" y="-20179.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-20168.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-20157.63" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer0_res2&#45;&gt;gpu0_layer1_ln1 -->
<g id="edge27" class="edge">
<title>gpu0_layer0_res2&#45;&gt;gpu0_layer1_ln1</title>
<path fill="none" stroke="black" d="M341,-20239.46C341,-20231.17 341,-20221.78 341,-20212.87"/>
<polygon fill="black" stroke="black" points="344.5,-20212.73 341,-20202.73 337.5,-20212.73 344.5,-20212.73"/>
</g>
<!-- gpu0_layer1_qkv -->
<g id="node21" class="node">
<title>gpu0_layer1_qkv</title>
<polygon fill="lightblue" stroke="black" points="402,-20113.63 280,-20113.63 280,-20061.63 402,-20061.63 402,-20113.63"/>
<text text-anchor="middle" x="341" y="-20101.63" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="341" y="-20090.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-20079.63" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-20068.63" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer1_ln1&#45;&gt;gpu0_layer1_qkv -->
<g id="edge28" class="edge">
<title>gpu0_layer1_ln1&#45;&gt;gpu0_layer1_qkv</title>
<path fill="none" stroke="black" d="M341,-20150.46C341,-20142.17 341,-20132.78 341,-20123.87"/>
<polygon fill="black" stroke="black" points="344.5,-20123.73 341,-20113.73 337.5,-20123.73 344.5,-20123.73"/>
</g>
<!-- gpu0_layer1_reshape -->
<g id="node22" class="node">
<title>gpu0_layer1_reshape</title>
<polygon fill="lightblue" stroke="black" points="405,-20024.63 277,-20024.63 277,-19972.63 405,-19972.63 405,-20024.63"/>
<text text-anchor="middle" x="341" y="-20012.63" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="341" y="-20001.63" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-19990.63" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-19979.63" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer1_qkv&#45;&gt;gpu0_layer1_reshape -->
<g id="edge29" class="edge">
<title>gpu0_layer1_qkv&#45;&gt;gpu0_layer1_reshape</title>
<path fill="none" stroke="black" d="M341,-20061.46C341,-20053.17 341,-20043.78 341,-20034.87"/>
<polygon fill="black" stroke="black" points="344.5,-20034.73 341,-20024.73 337.5,-20034.73 344.5,-20034.73"/>
</g>
<!-- gpu0_layer1_attn -->
<g id="node23" class="node">
<title>gpu0_layer1_attn</title>
<polygon fill="lightblue" stroke="black" points="405,-19935.63 277,-19935.63 277,-19883.63 405,-19883.63 405,-19935.63"/>
<text text-anchor="middle" x="341" y="-19923.63" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="341" y="-19912.63" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-19901.63" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-19890.63" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer1_reshape&#45;&gt;gpu0_layer1_attn -->
<g id="edge30" class="edge">
<title>gpu0_layer1_reshape&#45;&gt;gpu0_layer1_attn</title>
<path fill="none" stroke="black" d="M341,-19972.46C341,-19964.17 341,-19954.78 341,-19945.87"/>
<polygon fill="black" stroke="black" points="344.5,-19945.73 341,-19935.73 337.5,-19945.73 344.5,-19945.73"/>
</g>
<!-- gpu0_layer1_attn_reshape -->
<g id="node25" class="node">
<title>gpu0_layer1_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="402,-19846.63 280,-19846.63 280,-19794.63 402,-19794.63 402,-19846.63"/>
<text text-anchor="middle" x="341" y="-19834.63" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="341" y="-19823.63" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-19812.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-19801.63" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer1_attn&#45;&gt;gpu0_layer1_attn_reshape -->
<g id="edge31" class="edge">
<title>gpu0_layer1_attn&#45;&gt;gpu0_layer1_attn_reshape</title>
<path fill="none" stroke="black" d="M341,-19883.46C341,-19875.17 341,-19865.78 341,-19856.87"/>
<polygon fill="black" stroke="black" points="344.5,-19856.73 341,-19846.73 337.5,-19856.73 344.5,-19856.73"/>
</g>
<!-- gpu0_layer1_attn_out -->
<g id="node24" class="node">
<title>gpu0_layer1_attn_out</title>
<polygon fill="lightblue" stroke="black" points="402,-19757.63 280,-19757.63 280,-19705.63 402,-19705.63 402,-19757.63"/>
<text text-anchor="middle" x="341" y="-19745.63" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="341" y="-19734.63" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-19723.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-19712.63" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer1_kv_update -->
<g id="node26" class="node">
<title>gpu0_layer1_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="341" cy="-19631.86" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="341" y="-19645.86" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="341" y="-19634.86" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-19623.86" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-19612.86" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer1_attn_out&#45;&gt;gpu0_layer1_kv_update -->
<g id="edge33" class="edge">
<title>gpu0_layer1_attn_out&#45;&gt;gpu0_layer1_kv_update</title>
<path fill="none" stroke="black" d="M341,-19705.45C341,-19697.31 341,-19688.01 341,-19678.85"/>
<polygon fill="black" stroke="black" points="344.5,-19678.64 341,-19668.64 337.5,-19678.64 344.5,-19678.64"/>
</g>
<!-- gpu0_layer1_attn_reshape&#45;&gt;gpu0_layer1_attn_out -->
<g id="edge32" class="edge">
<title>gpu0_layer1_attn_reshape&#45;&gt;gpu0_layer1_attn_out</title>
<path fill="none" stroke="black" d="M341,-19794.46C341,-19786.17 341,-19776.78 341,-19767.87"/>
<polygon fill="black" stroke="black" points="344.5,-19767.73 341,-19757.73 337.5,-19767.73 344.5,-19767.73"/>
</g>
<!-- gpu0_layer1_res1 -->
<g id="node27" class="node">
<title>gpu0_layer1_res1</title>
<polygon fill="lightblue" stroke="black" points="402,-19558.09 280,-19558.09 280,-19506.09 402,-19506.09 402,-19558.09"/>
<text text-anchor="middle" x="341" y="-19546.09" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="341" y="-19535.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-19524.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-19513.09" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer1_kv_update&#45;&gt;gpu0_layer1_res1 -->
<g id="edge34" class="edge">
<title>gpu0_layer1_kv_update&#45;&gt;gpu0_layer1_res1</title>
<path fill="none" stroke="black" d="M341,-19595.01C341,-19586.33 341,-19577.06 341,-19568.4"/>
<polygon fill="black" stroke="black" points="344.5,-19568.23 341,-19558.23 337.5,-19568.23 344.5,-19568.23"/>
</g>
<!-- gpu0_layer1_ln2 -->
<g id="node28" class="node">
<title>gpu0_layer1_ln2</title>
<polygon fill="lightblue" stroke="black" points="402,-19469.09 280,-19469.09 280,-19417.09 402,-19417.09 402,-19469.09"/>
<text text-anchor="middle" x="341" y="-19457.09" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="341" y="-19446.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-19435.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-19424.09" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer1_res1&#45;&gt;gpu0_layer1_ln2 -->
<g id="edge35" class="edge">
<title>gpu0_layer1_res1&#45;&gt;gpu0_layer1_ln2</title>
<path fill="none" stroke="black" d="M341,-19505.92C341,-19497.63 341,-19488.24 341,-19479.34"/>
<polygon fill="black" stroke="black" points="344.5,-19479.19 341,-19469.19 337.5,-19479.19 344.5,-19479.19"/>
</g>
<!-- gpu0_layer1_routing -->
<g id="node29" class="node">
<title>gpu0_layer1_routing</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-19380.09 266.29,-19380.09 214.53,-19254.09 415.71,-19254.09 467.47,-19380.09"/>
<text text-anchor="middle" x="341" y="-19336.59" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="341" y="-19325.59" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-19314.59" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-19303.59" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="341" y="-19292.59" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer1_ln2&#45;&gt;gpu0_layer1_routing -->
<g id="edge36" class="edge">
<title>gpu0_layer1_ln2&#45;&gt;gpu0_layer1_routing</title>
<path fill="none" stroke="black" d="M341,-19416.99C341,-19409.06 341,-19399.86 341,-19390.33"/>
<polygon fill="black" stroke="black" points="344.5,-19390.32 341,-19380.32 337.5,-19390.32 344.5,-19390.32"/>
</g>
<!-- gpu0_layer1_expert0 -->
<g id="node30" class="node">
<title>gpu0_layer1_expert0</title>
<polygon fill="lightblue" stroke="black" points="122,-19208.09 0,-19208.09 0,-19156.09 122,-19156.09 122,-19208.09"/>
<text text-anchor="middle" x="61" y="-19196.09" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="61" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer1_routing&#45;&gt;gpu0_layer1_expert0 -->
<g id="edge23" class="edge">
<title>gpu0_layer1_routing&#45;&gt;gpu0_layer1_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M215.33,-19256.39C183.34,-19241.2 150.34,-19225.52 123.11,-19212.59"/>
<polygon fill="black" stroke="black" points="124.26,-19209.26 113.73,-19208.13 121.26,-19215.58 124.26,-19209.26"/>
<text text-anchor="middle" x="197.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer1_expert1 -->
<g id="node31" class="node">
<title>gpu0_layer1_expert1</title>
<polygon fill="lightblue" stroke="black" points="262,-19208.09 140,-19208.09 140,-19156.09 262,-19156.09 262,-19208.09"/>
<text text-anchor="middle" x="201" y="-19196.09" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="201" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer1_routing&#45;&gt;gpu0_layer1_expert1 -->
<g id="edge24" class="edge">
<title>gpu0_layer1_routing&#45;&gt;gpu0_layer1_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M275.51,-19253.87C261.48,-19240.55 247.21,-19226.99 234.97,-19215.36"/>
<polygon fill="black" stroke="black" points="237.29,-19212.73 227.63,-19208.38 232.46,-19217.81 237.29,-19212.73"/>
<text text-anchor="middle" x="284.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer1_expert2 -->
<g id="node32" class="node">
<title>gpu0_layer1_expert2</title>
<polygon fill="lightblue" stroke="black" points="402,-19208.09 280,-19208.09 280,-19156.09 402,-19156.09 402,-19208.09"/>
<text text-anchor="middle" x="341" y="-19196.09" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="341" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer1_routing&#45;&gt;gpu0_layer1_expert2 -->
<g id="edge25" class="edge">
<title>gpu0_layer1_routing&#45;&gt;gpu0_layer1_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M341,-19253.87C341,-19241.8 341,-19229.55 341,-19218.7"/>
<polygon fill="black" stroke="black" points="344.5,-19218.38 341,-19208.38 337.5,-19218.38 344.5,-19218.38"/>
<text text-anchor="middle" x="370.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer1_expert3 -->
<g id="node33" class="node">
<title>gpu0_layer1_expert3</title>
<polygon fill="lightblue" stroke="black" points="542,-19208.09 420,-19208.09 420,-19156.09 542,-19156.09 542,-19208.09"/>
<text text-anchor="middle" x="481" y="-19196.09" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="481" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer1_routing&#45;&gt;gpu0_layer1_expert3 -->
<g id="edge26" class="edge">
<title>gpu0_layer1_routing&#45;&gt;gpu0_layer1_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M406.49,-19253.87C420.52,-19240.55 434.79,-19226.99 447.03,-19215.36"/>
<polygon fill="black" stroke="black" points="449.54,-19217.81 454.37,-19208.38 444.71,-19212.73 449.54,-19217.81"/>
<text text-anchor="middle" x="465.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer1_expert_agg -->
<g id="node34" class="node">
<title>gpu0_layer1_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-19119.09 266.29,-19119.09 214.53,-19015.09 415.71,-19015.09 467.47,-19119.09"/>
<text text-anchor="middle" x="341" y="-19081.09" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="341" y="-19070.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-19059.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-19048.09" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer1_routing&#45;&gt;gpu0_layer1_expert_agg -->
<g id="edge41" class="edge">
<title>gpu0_layer1_routing&#45;&gt;gpu0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M430.22,-19289.17C503.96,-19262.01 590.6,-19215.62 551,-19156.09 530.44,-19125.17 496.7,-19105.1 462.22,-19092.07"/>
<polygon fill="black" stroke="black" points="463.08,-19088.66 452.48,-19088.58 460.71,-19095.25 463.08,-19088.66"/>
</g>
<!-- gpu0_layer1_expert0&#45;&gt;gpu0_layer1_expert_agg -->
<g id="edge37" class="edge">
<title>gpu0_layer1_expert0&#45;&gt;gpu0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M122.1,-19156.43C158.98,-19141.55 206.7,-19122.29 248.16,-19105.55"/>
<polygon fill="black" stroke="black" points="249.5,-19108.79 257.46,-19101.8 246.88,-19102.3 249.5,-19108.79"/>
</g>
<!-- gpu0_layer1_expert1&#45;&gt;gpu0_layer1_expert_agg -->
<g id="edge38" class="edge">
<title>gpu0_layer1_expert1&#45;&gt;gpu0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M232.07,-19156.01C243.32,-19146.93 256.53,-19136.27 269.8,-19125.56"/>
<polygon fill="black" stroke="black" points="272.02,-19128.26 277.6,-19119.26 267.62,-19122.82 272.02,-19128.26"/>
</g>
<!-- gpu0_layer1_expert2&#45;&gt;gpu0_layer1_expert_agg -->
<g id="edge39" class="edge">
<title>gpu0_layer1_expert2&#45;&gt;gpu0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M341,-19156.01C341,-19148.08 341,-19138.95 341,-19129.62"/>
<polygon fill="black" stroke="black" points="344.5,-19129.49 341,-19119.49 337.5,-19129.49 344.5,-19129.49"/>
</g>
<!-- gpu0_layer1_expert3&#45;&gt;gpu0_layer1_expert_agg -->
<g id="edge40" class="edge">
<title>gpu0_layer1_expert3&#45;&gt;gpu0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M449.93,-19156.01C438.68,-19146.93 425.47,-19136.27 412.2,-19125.56"/>
<polygon fill="black" stroke="black" points="414.38,-19122.82 404.4,-19119.26 409.98,-19128.26 414.38,-19122.82"/>
</g>
<!-- gpu0_layer1_res2 -->
<g id="node35" class="node">
<title>gpu0_layer1_res2</title>
<polygon fill="lightblue" stroke="black" points="402,-18978.09 280,-18978.09 280,-18926.09 402,-18926.09 402,-18978.09"/>
<text text-anchor="middle" x="341" y="-18966.09" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="341" y="-18955.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-18944.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-18933.09" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer1_expert_agg&#45;&gt;gpu0_layer1_res2 -->
<g id="edge42" class="edge">
<title>gpu0_layer1_expert_agg&#45;&gt;gpu0_layer1_res2</title>
<path fill="none" stroke="black" d="M341,-19014.88C341,-19005.93 341,-18996.8 341,-18988.4"/>
<polygon fill="black" stroke="black" points="344.5,-18988.22 341,-18978.22 337.5,-18988.22 344.5,-18988.22"/>
</g>
<!-- gpu0_layer2_ln1 -->
<g id="node36" class="node">
<title>gpu0_layer2_ln1</title>
<polygon fill="lightblue" stroke="black" points="402,-18889.09 280,-18889.09 280,-18837.09 402,-18837.09 402,-18889.09"/>
<text text-anchor="middle" x="341" y="-18877.09" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="341" y="-18866.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-18855.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-18844.09" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer1_res2&#45;&gt;gpu0_layer2_ln1 -->
<g id="edge47" class="edge">
<title>gpu0_layer1_res2&#45;&gt;gpu0_layer2_ln1</title>
<path fill="none" stroke="black" d="M341,-18925.92C341,-18917.63 341,-18908.24 341,-18899.34"/>
<polygon fill="black" stroke="black" points="344.5,-18899.19 341,-18889.19 337.5,-18899.19 344.5,-18899.19"/>
</g>
<!-- gpu0_layer2_qkv -->
<g id="node37" class="node">
<title>gpu0_layer2_qkv</title>
<polygon fill="lightblue" stroke="black" points="402,-18800.09 280,-18800.09 280,-18748.09 402,-18748.09 402,-18800.09"/>
<text text-anchor="middle" x="341" y="-18788.09" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="341" y="-18777.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-18766.09" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-18755.09" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer2_ln1&#45;&gt;gpu0_layer2_qkv -->
<g id="edge48" class="edge">
<title>gpu0_layer2_ln1&#45;&gt;gpu0_layer2_qkv</title>
<path fill="none" stroke="black" d="M341,-18836.92C341,-18828.63 341,-18819.24 341,-18810.34"/>
<polygon fill="black" stroke="black" points="344.5,-18810.19 341,-18800.19 337.5,-18810.19 344.5,-18810.19"/>
</g>
<!-- gpu0_layer2_reshape -->
<g id="node38" class="node">
<title>gpu0_layer2_reshape</title>
<polygon fill="lightblue" stroke="black" points="405,-18711.09 277,-18711.09 277,-18659.09 405,-18659.09 405,-18711.09"/>
<text text-anchor="middle" x="341" y="-18699.09" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="341" y="-18688.09" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-18677.09" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-18666.09" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer2_qkv&#45;&gt;gpu0_layer2_reshape -->
<g id="edge49" class="edge">
<title>gpu0_layer2_qkv&#45;&gt;gpu0_layer2_reshape</title>
<path fill="none" stroke="black" d="M341,-18747.92C341,-18739.63 341,-18730.24 341,-18721.34"/>
<polygon fill="black" stroke="black" points="344.5,-18721.19 341,-18711.19 337.5,-18721.19 344.5,-18721.19"/>
</g>
<!-- gpu0_layer2_attn -->
<g id="node39" class="node">
<title>gpu0_layer2_attn</title>
<polygon fill="lightblue" stroke="black" points="405,-18622.09 277,-18622.09 277,-18570.09 405,-18570.09 405,-18622.09"/>
<text text-anchor="middle" x="341" y="-18610.09" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="341" y="-18599.09" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-18588.09" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-18577.09" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer2_reshape&#45;&gt;gpu0_layer2_attn -->
<g id="edge50" class="edge">
<title>gpu0_layer2_reshape&#45;&gt;gpu0_layer2_attn</title>
<path fill="none" stroke="black" d="M341,-18658.92C341,-18650.63 341,-18641.24 341,-18632.34"/>
<polygon fill="black" stroke="black" points="344.5,-18632.19 341,-18622.19 337.5,-18632.19 344.5,-18632.19"/>
</g>
<!-- gpu0_layer2_attn_reshape -->
<g id="node41" class="node">
<title>gpu0_layer2_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="402,-18533.09 280,-18533.09 280,-18481.09 402,-18481.09 402,-18533.09"/>
<text text-anchor="middle" x="341" y="-18521.09" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="341" y="-18510.09" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-18499.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-18488.09" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer2_attn&#45;&gt;gpu0_layer2_attn_reshape -->
<g id="edge51" class="edge">
<title>gpu0_layer2_attn&#45;&gt;gpu0_layer2_attn_reshape</title>
<path fill="none" stroke="black" d="M341,-18569.92C341,-18561.63 341,-18552.24 341,-18543.34"/>
<polygon fill="black" stroke="black" points="344.5,-18543.19 341,-18533.19 337.5,-18543.19 344.5,-18543.19"/>
</g>
<!-- gpu0_layer2_attn_out -->
<g id="node40" class="node">
<title>gpu0_layer2_attn_out</title>
<polygon fill="lightblue" stroke="black" points="402,-18444.09 280,-18444.09 280,-18392.09 402,-18392.09 402,-18444.09"/>
<text text-anchor="middle" x="341" y="-18432.09" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="341" y="-18421.09" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-18410.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-18399.09" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer2_kv_update -->
<g id="node42" class="node">
<title>gpu0_layer2_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="341" cy="-18318.32" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="341" y="-18332.32" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="341" y="-18321.32" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-18310.32" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-18299.32" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer2_attn_out&#45;&gt;gpu0_layer2_kv_update -->
<g id="edge53" class="edge">
<title>gpu0_layer2_attn_out&#45;&gt;gpu0_layer2_kv_update</title>
<path fill="none" stroke="black" d="M341,-18391.91C341,-18383.77 341,-18374.47 341,-18365.31"/>
<polygon fill="black" stroke="black" points="344.5,-18365.1 341,-18355.1 337.5,-18365.1 344.5,-18365.1"/>
</g>
<!-- gpu0_layer2_attn_reshape&#45;&gt;gpu0_layer2_attn_out -->
<g id="edge52" class="edge">
<title>gpu0_layer2_attn_reshape&#45;&gt;gpu0_layer2_attn_out</title>
<path fill="none" stroke="black" d="M341,-18480.92C341,-18472.63 341,-18463.24 341,-18454.34"/>
<polygon fill="black" stroke="black" points="344.5,-18454.19 341,-18444.19 337.5,-18454.19 344.5,-18454.19"/>
</g>
<!-- gpu0_layer2_res1 -->
<g id="node43" class="node">
<title>gpu0_layer2_res1</title>
<polygon fill="lightblue" stroke="black" points="402,-18244.55 280,-18244.55 280,-18192.55 402,-18192.55 402,-18244.55"/>
<text text-anchor="middle" x="341" y="-18232.55" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="341" y="-18221.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-18210.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-18199.55" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer2_kv_update&#45;&gt;gpu0_layer2_res1 -->
<g id="edge54" class="edge">
<title>gpu0_layer2_kv_update&#45;&gt;gpu0_layer2_res1</title>
<path fill="none" stroke="black" d="M341,-18281.47C341,-18272.79 341,-18263.52 341,-18254.86"/>
<polygon fill="black" stroke="black" points="344.5,-18254.69 341,-18244.69 337.5,-18254.69 344.5,-18254.69"/>
</g>
<!-- gpu0_layer2_ln2 -->
<g id="node44" class="node">
<title>gpu0_layer2_ln2</title>
<polygon fill="lightblue" stroke="black" points="402,-18155.55 280,-18155.55 280,-18103.55 402,-18103.55 402,-18155.55"/>
<text text-anchor="middle" x="341" y="-18143.55" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="341" y="-18132.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-18121.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-18110.55" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer2_res1&#45;&gt;gpu0_layer2_ln2 -->
<g id="edge55" class="edge">
<title>gpu0_layer2_res1&#45;&gt;gpu0_layer2_ln2</title>
<path fill="none" stroke="black" d="M341,-18192.38C341,-18184.09 341,-18174.7 341,-18165.8"/>
<polygon fill="black" stroke="black" points="344.5,-18165.65 341,-18155.65 337.5,-18165.65 344.5,-18165.65"/>
</g>
<!-- gpu0_layer2_routing -->
<g id="node45" class="node">
<title>gpu0_layer2_routing</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-18066.55 266.29,-18066.55 214.53,-17940.55 415.71,-17940.55 467.47,-18066.55"/>
<text text-anchor="middle" x="341" y="-18023.05" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="341" y="-18012.05" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-18001.05" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-17990.05" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="341" y="-17979.05" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer2_ln2&#45;&gt;gpu0_layer2_routing -->
<g id="edge56" class="edge">
<title>gpu0_layer2_ln2&#45;&gt;gpu0_layer2_routing</title>
<path fill="none" stroke="black" d="M341,-18103.45C341,-18095.52 341,-18086.33 341,-18076.8"/>
<polygon fill="black" stroke="black" points="344.5,-18076.78 341,-18066.78 337.5,-18076.78 344.5,-18076.78"/>
</g>
<!-- gpu0_layer2_expert0 -->
<g id="node46" class="node">
<title>gpu0_layer2_expert0</title>
<polygon fill="lightblue" stroke="black" points="122,-17894.55 0,-17894.55 0,-17842.55 122,-17842.55 122,-17894.55"/>
<text text-anchor="middle" x="61" y="-17882.55" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="61" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer2_routing&#45;&gt;gpu0_layer2_expert0 -->
<g id="edge43" class="edge">
<title>gpu0_layer2_routing&#45;&gt;gpu0_layer2_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M215.33,-17942.86C183.34,-17927.66 150.34,-17911.98 123.11,-17899.05"/>
<polygon fill="black" stroke="black" points="124.26,-17895.72 113.73,-17894.59 121.26,-17902.04 124.26,-17895.72"/>
<text text-anchor="middle" x="197.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer2_expert1 -->
<g id="node47" class="node">
<title>gpu0_layer2_expert1</title>
<polygon fill="lightblue" stroke="black" points="262,-17894.55 140,-17894.55 140,-17842.55 262,-17842.55 262,-17894.55"/>
<text text-anchor="middle" x="201" y="-17882.55" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="201" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer2_routing&#45;&gt;gpu0_layer2_expert1 -->
<g id="edge44" class="edge">
<title>gpu0_layer2_routing&#45;&gt;gpu0_layer2_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M275.51,-17940.33C261.48,-17927.01 247.21,-17913.45 234.97,-17901.82"/>
<polygon fill="black" stroke="black" points="237.29,-17899.19 227.63,-17894.84 232.46,-17904.27 237.29,-17899.19"/>
<text text-anchor="middle" x="284.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer2_expert2 -->
<g id="node48" class="node">
<title>gpu0_layer2_expert2</title>
<polygon fill="lightblue" stroke="black" points="402,-17894.55 280,-17894.55 280,-17842.55 402,-17842.55 402,-17894.55"/>
<text text-anchor="middle" x="341" y="-17882.55" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="341" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer2_routing&#45;&gt;gpu0_layer2_expert2 -->
<g id="edge45" class="edge">
<title>gpu0_layer2_routing&#45;&gt;gpu0_layer2_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M341,-17940.33C341,-17928.26 341,-17916.01 341,-17905.16"/>
<polygon fill="black" stroke="black" points="344.5,-17904.84 341,-17894.84 337.5,-17904.84 344.5,-17904.84"/>
<text text-anchor="middle" x="370.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer2_expert3 -->
<g id="node49" class="node">
<title>gpu0_layer2_expert3</title>
<polygon fill="lightblue" stroke="black" points="542,-17894.55 420,-17894.55 420,-17842.55 542,-17842.55 542,-17894.55"/>
<text text-anchor="middle" x="481" y="-17882.55" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="481" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer2_routing&#45;&gt;gpu0_layer2_expert3 -->
<g id="edge46" class="edge">
<title>gpu0_layer2_routing&#45;&gt;gpu0_layer2_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M406.49,-17940.33C420.52,-17927.01 434.79,-17913.45 447.03,-17901.82"/>
<polygon fill="black" stroke="black" points="449.54,-17904.27 454.37,-17894.84 444.71,-17899.19 449.54,-17904.27"/>
<text text-anchor="middle" x="465.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer2_expert_agg -->
<g id="node50" class="node">
<title>gpu0_layer2_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-17805.55 266.29,-17805.55 214.53,-17701.55 415.71,-17701.55 467.47,-17805.55"/>
<text text-anchor="middle" x="341" y="-17767.55" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="341" y="-17756.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-17745.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-17734.55" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer2_routing&#45;&gt;gpu0_layer2_expert_agg -->
<g id="edge61" class="edge">
<title>gpu0_layer2_routing&#45;&gt;gpu0_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M430.22,-17975.63C503.96,-17948.47 590.6,-17902.08 551,-17842.55 530.44,-17811.64 496.7,-17791.56 462.22,-17778.53"/>
<polygon fill="black" stroke="black" points="463.08,-17775.12 452.48,-17775.04 460.71,-17781.71 463.08,-17775.12"/>
</g>
<!-- gpu0_layer2_expert0&#45;&gt;gpu0_layer2_expert_agg -->
<g id="edge57" class="edge">
<title>gpu0_layer2_expert0&#45;&gt;gpu0_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M122.1,-17842.89C158.98,-17828.01 206.7,-17808.75 248.16,-17792.01"/>
<polygon fill="black" stroke="black" points="249.5,-17795.25 257.46,-17788.26 246.88,-17788.76 249.5,-17795.25"/>
</g>
<!-- gpu0_layer2_expert1&#45;&gt;gpu0_layer2_expert_agg -->
<g id="edge58" class="edge">
<title>gpu0_layer2_expert1&#45;&gt;gpu0_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M232.07,-17842.47C243.32,-17833.39 256.53,-17822.73 269.8,-17812.02"/>
<polygon fill="black" stroke="black" points="272.02,-17814.72 277.6,-17805.72 267.62,-17809.28 272.02,-17814.72"/>
</g>
<!-- gpu0_layer2_expert2&#45;&gt;gpu0_layer2_expert_agg -->
<g id="edge59" class="edge">
<title>gpu0_layer2_expert2&#45;&gt;gpu0_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M341,-17842.47C341,-17834.54 341,-17825.41 341,-17816.09"/>
<polygon fill="black" stroke="black" points="344.5,-17815.95 341,-17805.95 337.5,-17815.95 344.5,-17815.95"/>
</g>
<!-- gpu0_layer2_expert3&#45;&gt;gpu0_layer2_expert_agg -->
<g id="edge60" class="edge">
<title>gpu0_layer2_expert3&#45;&gt;gpu0_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M449.93,-17842.47C438.68,-17833.39 425.47,-17822.73 412.2,-17812.02"/>
<polygon fill="black" stroke="black" points="414.38,-17809.28 404.4,-17805.72 409.98,-17814.72 414.38,-17809.28"/>
</g>
<!-- gpu0_layer2_res2 -->
<g id="node51" class="node">
<title>gpu0_layer2_res2</title>
<polygon fill="lightblue" stroke="black" points="402,-17664.55 280,-17664.55 280,-17612.55 402,-17612.55 402,-17664.55"/>
<text text-anchor="middle" x="341" y="-17652.55" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="341" y="-17641.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-17630.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-17619.55" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer2_expert_agg&#45;&gt;gpu0_layer2_res2 -->
<g id="edge62" class="edge">
<title>gpu0_layer2_expert_agg&#45;&gt;gpu0_layer2_res2</title>
<path fill="none" stroke="black" d="M341,-17701.34C341,-17692.39 341,-17683.26 341,-17674.86"/>
<polygon fill="black" stroke="black" points="344.5,-17674.68 341,-17664.68 337.5,-17674.68 344.5,-17674.68"/>
</g>
<!-- gpu0_layer3_ln1 -->
<g id="node52" class="node">
<title>gpu0_layer3_ln1</title>
<polygon fill="lightblue" stroke="black" points="402,-17575.55 280,-17575.55 280,-17523.55 402,-17523.55 402,-17575.55"/>
<text text-anchor="middle" x="341" y="-17563.55" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="341" y="-17552.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-17541.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-17530.55" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer2_res2&#45;&gt;gpu0_layer3_ln1 -->
<g id="edge67" class="edge">
<title>gpu0_layer2_res2&#45;&gt;gpu0_layer3_ln1</title>
<path fill="none" stroke="black" d="M341,-17612.38C341,-17604.09 341,-17594.7 341,-17585.8"/>
<polygon fill="black" stroke="black" points="344.5,-17585.65 341,-17575.65 337.5,-17585.65 344.5,-17585.65"/>
</g>
<!-- gpu0_layer3_qkv -->
<g id="node53" class="node">
<title>gpu0_layer3_qkv</title>
<polygon fill="lightblue" stroke="black" points="402,-17486.55 280,-17486.55 280,-17434.55 402,-17434.55 402,-17486.55"/>
<text text-anchor="middle" x="341" y="-17474.55" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="341" y="-17463.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-17452.55" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-17441.55" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer3_ln1&#45;&gt;gpu0_layer3_qkv -->
<g id="edge68" class="edge">
<title>gpu0_layer3_ln1&#45;&gt;gpu0_layer3_qkv</title>
<path fill="none" stroke="black" d="M341,-17523.38C341,-17515.09 341,-17505.7 341,-17496.8"/>
<polygon fill="black" stroke="black" points="344.5,-17496.65 341,-17486.65 337.5,-17496.65 344.5,-17496.65"/>
</g>
<!-- gpu0_layer3_reshape -->
<g id="node54" class="node">
<title>gpu0_layer3_reshape</title>
<polygon fill="lightblue" stroke="black" points="405,-17397.55 277,-17397.55 277,-17345.55 405,-17345.55 405,-17397.55"/>
<text text-anchor="middle" x="341" y="-17385.55" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="341" y="-17374.55" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-17363.55" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-17352.55" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer3_qkv&#45;&gt;gpu0_layer3_reshape -->
<g id="edge69" class="edge">
<title>gpu0_layer3_qkv&#45;&gt;gpu0_layer3_reshape</title>
<path fill="none" stroke="black" d="M341,-17434.38C341,-17426.09 341,-17416.7 341,-17407.8"/>
<polygon fill="black" stroke="black" points="344.5,-17407.65 341,-17397.65 337.5,-17407.65 344.5,-17407.65"/>
</g>
<!-- gpu0_layer3_attn -->
<g id="node55" class="node">
<title>gpu0_layer3_attn</title>
<polygon fill="lightblue" stroke="black" points="405,-17308.55 277,-17308.55 277,-17256.55 405,-17256.55 405,-17308.55"/>
<text text-anchor="middle" x="341" y="-17296.55" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="341" y="-17285.55" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-17274.55" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-17263.55" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer3_reshape&#45;&gt;gpu0_layer3_attn -->
<g id="edge70" class="edge">
<title>gpu0_layer3_reshape&#45;&gt;gpu0_layer3_attn</title>
<path fill="none" stroke="black" d="M341,-17345.38C341,-17337.09 341,-17327.7 341,-17318.8"/>
<polygon fill="black" stroke="black" points="344.5,-17318.65 341,-17308.65 337.5,-17318.65 344.5,-17318.65"/>
</g>
<!-- gpu0_layer3_attn_reshape -->
<g id="node57" class="node">
<title>gpu0_layer3_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="402,-17219.55 280,-17219.55 280,-17167.55 402,-17167.55 402,-17219.55"/>
<text text-anchor="middle" x="341" y="-17207.55" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="341" y="-17196.55" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-17185.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-17174.55" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer3_attn&#45;&gt;gpu0_layer3_attn_reshape -->
<g id="edge71" class="edge">
<title>gpu0_layer3_attn&#45;&gt;gpu0_layer3_attn_reshape</title>
<path fill="none" stroke="black" d="M341,-17256.38C341,-17248.09 341,-17238.7 341,-17229.8"/>
<polygon fill="black" stroke="black" points="344.5,-17229.65 341,-17219.65 337.5,-17229.65 344.5,-17229.65"/>
</g>
<!-- gpu0_layer3_attn_out -->
<g id="node56" class="node">
<title>gpu0_layer3_attn_out</title>
<polygon fill="lightblue" stroke="black" points="402,-17130.55 280,-17130.55 280,-17078.55 402,-17078.55 402,-17130.55"/>
<text text-anchor="middle" x="341" y="-17118.55" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="341" y="-17107.55" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-17096.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-17085.55" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer3_kv_update -->
<g id="node58" class="node">
<title>gpu0_layer3_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="341" cy="-17004.78" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="341" y="-17018.78" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="341" y="-17007.78" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-16996.78" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-16985.78" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer3_attn_out&#45;&gt;gpu0_layer3_kv_update -->
<g id="edge73" class="edge">
<title>gpu0_layer3_attn_out&#45;&gt;gpu0_layer3_kv_update</title>
<path fill="none" stroke="black" d="M341,-17078.37C341,-17070.23 341,-17060.93 341,-17051.77"/>
<polygon fill="black" stroke="black" points="344.5,-17051.56 341,-17041.56 337.5,-17051.56 344.5,-17051.56"/>
</g>
<!-- gpu0_layer3_attn_reshape&#45;&gt;gpu0_layer3_attn_out -->
<g id="edge72" class="edge">
<title>gpu0_layer3_attn_reshape&#45;&gt;gpu0_layer3_attn_out</title>
<path fill="none" stroke="black" d="M341,-17167.38C341,-17159.09 341,-17149.7 341,-17140.8"/>
<polygon fill="black" stroke="black" points="344.5,-17140.65 341,-17130.65 337.5,-17140.65 344.5,-17140.65"/>
</g>
<!-- gpu0_layer3_res1 -->
<g id="node59" class="node">
<title>gpu0_layer3_res1</title>
<polygon fill="lightblue" stroke="black" points="402,-16931.01 280,-16931.01 280,-16879.01 402,-16879.01 402,-16931.01"/>
<text text-anchor="middle" x="341" y="-16919.01" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="341" y="-16908.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-16897.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-16886.01" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer3_kv_update&#45;&gt;gpu0_layer3_res1 -->
<g id="edge74" class="edge">
<title>gpu0_layer3_kv_update&#45;&gt;gpu0_layer3_res1</title>
<path fill="none" stroke="black" d="M341,-16967.93C341,-16959.25 341,-16949.98 341,-16941.32"/>
<polygon fill="black" stroke="black" points="344.5,-16941.15 341,-16931.15 337.5,-16941.15 344.5,-16941.15"/>
</g>
<!-- gpu0_layer3_ln2 -->
<g id="node60" class="node">
<title>gpu0_layer3_ln2</title>
<polygon fill="lightblue" stroke="black" points="402,-16842.01 280,-16842.01 280,-16790.01 402,-16790.01 402,-16842.01"/>
<text text-anchor="middle" x="341" y="-16830.01" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="341" y="-16819.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-16808.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-16797.01" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer3_res1&#45;&gt;gpu0_layer3_ln2 -->
<g id="edge75" class="edge">
<title>gpu0_layer3_res1&#45;&gt;gpu0_layer3_ln2</title>
<path fill="none" stroke="black" d="M341,-16878.84C341,-16870.55 341,-16861.16 341,-16852.26"/>
<polygon fill="black" stroke="black" points="344.5,-16852.12 341,-16842.12 337.5,-16852.12 344.5,-16852.12"/>
</g>
<!-- gpu0_layer3_routing -->
<g id="node61" class="node">
<title>gpu0_layer3_routing</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-16753.01 266.29,-16753.01 214.53,-16627.01 415.71,-16627.01 467.47,-16753.01"/>
<text text-anchor="middle" x="341" y="-16709.51" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="341" y="-16698.51" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-16687.51" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-16676.51" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="341" y="-16665.51" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer3_ln2&#45;&gt;gpu0_layer3_routing -->
<g id="edge76" class="edge">
<title>gpu0_layer3_ln2&#45;&gt;gpu0_layer3_routing</title>
<path fill="none" stroke="black" d="M341,-16789.92C341,-16781.98 341,-16772.79 341,-16763.26"/>
<polygon fill="black" stroke="black" points="344.5,-16763.24 341,-16753.24 337.5,-16763.24 344.5,-16763.24"/>
</g>
<!-- gpu0_layer3_expert0 -->
<g id="node62" class="node">
<title>gpu0_layer3_expert0</title>
<polygon fill="lightblue" stroke="black" points="122,-16581.01 0,-16581.01 0,-16529.01 122,-16529.01 122,-16581.01"/>
<text text-anchor="middle" x="61" y="-16569.01" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="61" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer3_routing&#45;&gt;gpu0_layer3_expert0 -->
<g id="edge63" class="edge">
<title>gpu0_layer3_routing&#45;&gt;gpu0_layer3_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M215.33,-16629.32C183.34,-16614.12 150.34,-16598.44 123.11,-16585.51"/>
<polygon fill="black" stroke="black" points="124.26,-16582.18 113.73,-16581.05 121.26,-16588.51 124.26,-16582.18"/>
<text text-anchor="middle" x="197.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer3_expert1 -->
<g id="node63" class="node">
<title>gpu0_layer3_expert1</title>
<polygon fill="lightblue" stroke="black" points="262,-16581.01 140,-16581.01 140,-16529.01 262,-16529.01 262,-16581.01"/>
<text text-anchor="middle" x="201" y="-16569.01" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="201" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer3_routing&#45;&gt;gpu0_layer3_expert1 -->
<g id="edge64" class="edge">
<title>gpu0_layer3_routing&#45;&gt;gpu0_layer3_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M275.51,-16626.79C261.48,-16613.47 247.21,-16599.91 234.97,-16588.28"/>
<polygon fill="black" stroke="black" points="237.29,-16585.65 227.63,-16581.3 232.46,-16590.73 237.29,-16585.65"/>
<text text-anchor="middle" x="284.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer3_expert2 -->
<g id="node64" class="node">
<title>gpu0_layer3_expert2</title>
<polygon fill="lightblue" stroke="black" points="402,-16581.01 280,-16581.01 280,-16529.01 402,-16529.01 402,-16581.01"/>
<text text-anchor="middle" x="341" y="-16569.01" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="341" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer3_routing&#45;&gt;gpu0_layer3_expert2 -->
<g id="edge65" class="edge">
<title>gpu0_layer3_routing&#45;&gt;gpu0_layer3_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M341,-16626.79C341,-16614.72 341,-16602.47 341,-16591.62"/>
<polygon fill="black" stroke="black" points="344.5,-16591.3 341,-16581.3 337.5,-16591.3 344.5,-16591.3"/>
<text text-anchor="middle" x="370.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer3_expert3 -->
<g id="node65" class="node">
<title>gpu0_layer3_expert3</title>
<polygon fill="lightblue" stroke="black" points="542,-16581.01 420,-16581.01 420,-16529.01 542,-16529.01 542,-16581.01"/>
<text text-anchor="middle" x="481" y="-16569.01" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="481" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer3_routing&#45;&gt;gpu0_layer3_expert3 -->
<g id="edge66" class="edge">
<title>gpu0_layer3_routing&#45;&gt;gpu0_layer3_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M406.49,-16626.79C420.52,-16613.47 434.79,-16599.91 447.03,-16588.28"/>
<polygon fill="black" stroke="black" points="449.54,-16590.73 454.37,-16581.3 444.71,-16585.65 449.54,-16590.73"/>
<text text-anchor="middle" x="465.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer3_expert_agg -->
<g id="node66" class="node">
<title>gpu0_layer3_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-16492.01 266.29,-16492.01 214.53,-16388.01 415.71,-16388.01 467.47,-16492.01"/>
<text text-anchor="middle" x="341" y="-16454.01" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="341" y="-16443.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-16432.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-16421.01" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer3_routing&#45;&gt;gpu0_layer3_expert_agg -->
<g id="edge81" class="edge">
<title>gpu0_layer3_routing&#45;&gt;gpu0_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M430.22,-16662.09C503.96,-16634.93 590.6,-16588.54 551,-16529.01 530.44,-16498.1 496.7,-16478.02 462.22,-16464.99"/>
<polygon fill="black" stroke="black" points="463.08,-16461.58 452.48,-16461.5 460.71,-16468.17 463.08,-16461.58"/>
</g>
<!-- gpu0_layer3_expert0&#45;&gt;gpu0_layer3_expert_agg -->
<g id="edge77" class="edge">
<title>gpu0_layer3_expert0&#45;&gt;gpu0_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M122.1,-16529.35C158.98,-16514.47 206.7,-16495.21 248.16,-16478.47"/>
<polygon fill="black" stroke="black" points="249.5,-16481.71 257.46,-16474.72 246.88,-16475.22 249.5,-16481.71"/>
</g>
<!-- gpu0_layer3_expert1&#45;&gt;gpu0_layer3_expert_agg -->
<g id="edge78" class="edge">
<title>gpu0_layer3_expert1&#45;&gt;gpu0_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M232.07,-16528.93C243.32,-16519.85 256.53,-16509.19 269.8,-16498.48"/>
<polygon fill="black" stroke="black" points="272.02,-16501.18 277.6,-16492.18 267.62,-16495.74 272.02,-16501.18"/>
</g>
<!-- gpu0_layer3_expert2&#45;&gt;gpu0_layer3_expert_agg -->
<g id="edge79" class="edge">
<title>gpu0_layer3_expert2&#45;&gt;gpu0_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M341,-16528.93C341,-16521 341,-16511.87 341,-16502.55"/>
<polygon fill="black" stroke="black" points="344.5,-16502.41 341,-16492.41 337.5,-16502.41 344.5,-16502.41"/>
</g>
<!-- gpu0_layer3_expert3&#45;&gt;gpu0_layer3_expert_agg -->
<g id="edge80" class="edge">
<title>gpu0_layer3_expert3&#45;&gt;gpu0_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M449.93,-16528.93C438.68,-16519.85 425.47,-16509.19 412.2,-16498.48"/>
<polygon fill="black" stroke="black" points="414.38,-16495.74 404.4,-16492.18 409.98,-16501.18 414.38,-16495.74"/>
</g>
<!-- gpu0_layer3_res2 -->
<g id="node67" class="node">
<title>gpu0_layer3_res2</title>
<polygon fill="lightblue" stroke="black" points="402,-16351.01 280,-16351.01 280,-16299.01 402,-16299.01 402,-16351.01"/>
<text text-anchor="middle" x="341" y="-16339.01" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="341" y="-16328.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-16317.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-16306.01" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer3_expert_agg&#45;&gt;gpu0_layer3_res2 -->
<g id="edge82" class="edge">
<title>gpu0_layer3_expert_agg&#45;&gt;gpu0_layer3_res2</title>
<path fill="none" stroke="black" d="M341,-16387.8C341,-16378.85 341,-16369.72 341,-16361.32"/>
<polygon fill="black" stroke="black" points="344.5,-16361.14 341,-16351.14 337.5,-16361.14 344.5,-16361.14"/>
</g>
<!-- gpu0_layer4_ln1 -->
<g id="node68" class="node">
<title>gpu0_layer4_ln1</title>
<polygon fill="lightblue" stroke="black" points="402,-16262.01 280,-16262.01 280,-16210.01 402,-16210.01 402,-16262.01"/>
<text text-anchor="middle" x="341" y="-16250.01" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="341" y="-16239.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-16228.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-16217.01" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer3_res2&#45;&gt;gpu0_layer4_ln1 -->
<g id="edge87" class="edge">
<title>gpu0_layer3_res2&#45;&gt;gpu0_layer4_ln1</title>
<path fill="none" stroke="black" d="M341,-16298.84C341,-16290.55 341,-16281.16 341,-16272.26"/>
<polygon fill="black" stroke="black" points="344.5,-16272.12 341,-16262.12 337.5,-16272.12 344.5,-16272.12"/>
</g>
<!-- gpu0_layer4_qkv -->
<g id="node69" class="node">
<title>gpu0_layer4_qkv</title>
<polygon fill="lightblue" stroke="black" points="402,-16173.01 280,-16173.01 280,-16121.01 402,-16121.01 402,-16173.01"/>
<text text-anchor="middle" x="341" y="-16161.01" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="341" y="-16150.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-16139.01" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-16128.01" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer4_ln1&#45;&gt;gpu0_layer4_qkv -->
<g id="edge88" class="edge">
<title>gpu0_layer4_ln1&#45;&gt;gpu0_layer4_qkv</title>
<path fill="none" stroke="black" d="M341,-16209.84C341,-16201.55 341,-16192.16 341,-16183.26"/>
<polygon fill="black" stroke="black" points="344.5,-16183.12 341,-16173.12 337.5,-16183.12 344.5,-16183.12"/>
</g>
<!-- gpu0_layer4_reshape -->
<g id="node70" class="node">
<title>gpu0_layer4_reshape</title>
<polygon fill="lightblue" stroke="black" points="405,-16084.01 277,-16084.01 277,-16032.01 405,-16032.01 405,-16084.01"/>
<text text-anchor="middle" x="341" y="-16072.01" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="341" y="-16061.01" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-16050.01" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-16039.01" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer4_qkv&#45;&gt;gpu0_layer4_reshape -->
<g id="edge89" class="edge">
<title>gpu0_layer4_qkv&#45;&gt;gpu0_layer4_reshape</title>
<path fill="none" stroke="black" d="M341,-16120.84C341,-16112.55 341,-16103.16 341,-16094.26"/>
<polygon fill="black" stroke="black" points="344.5,-16094.12 341,-16084.12 337.5,-16094.12 344.5,-16094.12"/>
</g>
<!-- gpu0_layer4_attn -->
<g id="node71" class="node">
<title>gpu0_layer4_attn</title>
<polygon fill="lightblue" stroke="black" points="405,-15995.01 277,-15995.01 277,-15943.01 405,-15943.01 405,-15995.01"/>
<text text-anchor="middle" x="341" y="-15983.01" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="341" y="-15972.01" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-15961.01" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-15950.01" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer4_reshape&#45;&gt;gpu0_layer4_attn -->
<g id="edge90" class="edge">
<title>gpu0_layer4_reshape&#45;&gt;gpu0_layer4_attn</title>
<path fill="none" stroke="black" d="M341,-16031.84C341,-16023.55 341,-16014.16 341,-16005.26"/>
<polygon fill="black" stroke="black" points="344.5,-16005.12 341,-15995.12 337.5,-16005.12 344.5,-16005.12"/>
</g>
<!-- gpu0_layer4_attn_reshape -->
<g id="node73" class="node">
<title>gpu0_layer4_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="402,-15906.01 280,-15906.01 280,-15854.01 402,-15854.01 402,-15906.01"/>
<text text-anchor="middle" x="341" y="-15894.01" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="341" y="-15883.01" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-15872.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-15861.01" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer4_attn&#45;&gt;gpu0_layer4_attn_reshape -->
<g id="edge91" class="edge">
<title>gpu0_layer4_attn&#45;&gt;gpu0_layer4_attn_reshape</title>
<path fill="none" stroke="black" d="M341,-15942.84C341,-15934.55 341,-15925.16 341,-15916.26"/>
<polygon fill="black" stroke="black" points="344.5,-15916.12 341,-15906.12 337.5,-15916.12 344.5,-15916.12"/>
</g>
<!-- gpu0_layer4_attn_out -->
<g id="node72" class="node">
<title>gpu0_layer4_attn_out</title>
<polygon fill="lightblue" stroke="black" points="402,-15817.01 280,-15817.01 280,-15765.01 402,-15765.01 402,-15817.01"/>
<text text-anchor="middle" x="341" y="-15805.01" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="341" y="-15794.01" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-15783.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-15772.01" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer4_kv_update -->
<g id="node74" class="node">
<title>gpu0_layer4_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="341" cy="-15691.24" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="341" y="-15705.24" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="341" y="-15694.24" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-15683.24" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-15672.24" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer4_attn_out&#45;&gt;gpu0_layer4_kv_update -->
<g id="edge93" class="edge">
<title>gpu0_layer4_attn_out&#45;&gt;gpu0_layer4_kv_update</title>
<path fill="none" stroke="black" d="M341,-15764.83C341,-15756.69 341,-15747.39 341,-15738.23"/>
<polygon fill="black" stroke="black" points="344.5,-15738.02 341,-15728.02 337.5,-15738.02 344.5,-15738.02"/>
</g>
<!-- gpu0_layer4_attn_reshape&#45;&gt;gpu0_layer4_attn_out -->
<g id="edge92" class="edge">
<title>gpu0_layer4_attn_reshape&#45;&gt;gpu0_layer4_attn_out</title>
<path fill="none" stroke="black" d="M341,-15853.84C341,-15845.55 341,-15836.16 341,-15827.26"/>
<polygon fill="black" stroke="black" points="344.5,-15827.12 341,-15817.12 337.5,-15827.12 344.5,-15827.12"/>
</g>
<!-- gpu0_layer4_res1 -->
<g id="node75" class="node">
<title>gpu0_layer4_res1</title>
<polygon fill="lightblue" stroke="black" points="402,-15617.47 280,-15617.47 280,-15565.47 402,-15565.47 402,-15617.47"/>
<text text-anchor="middle" x="341" y="-15605.47" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="341" y="-15594.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-15583.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-15572.47" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer4_kv_update&#45;&gt;gpu0_layer4_res1 -->
<g id="edge94" class="edge">
<title>gpu0_layer4_kv_update&#45;&gt;gpu0_layer4_res1</title>
<path fill="none" stroke="black" d="M341,-15654.39C341,-15645.71 341,-15636.44 341,-15627.78"/>
<polygon fill="black" stroke="black" points="344.5,-15627.62 341,-15617.62 337.5,-15627.62 344.5,-15627.62"/>
</g>
<!-- gpu0_layer4_ln2 -->
<g id="node76" class="node">
<title>gpu0_layer4_ln2</title>
<polygon fill="lightblue" stroke="black" points="402,-15528.47 280,-15528.47 280,-15476.47 402,-15476.47 402,-15528.47"/>
<text text-anchor="middle" x="341" y="-15516.47" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="341" y="-15505.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-15494.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-15483.47" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer4_res1&#45;&gt;gpu0_layer4_ln2 -->
<g id="edge95" class="edge">
<title>gpu0_layer4_res1&#45;&gt;gpu0_layer4_ln2</title>
<path fill="none" stroke="black" d="M341,-15565.31C341,-15557.01 341,-15547.62 341,-15538.72"/>
<polygon fill="black" stroke="black" points="344.5,-15538.58 341,-15528.58 337.5,-15538.58 344.5,-15538.58"/>
</g>
<!-- gpu0_layer4_routing -->
<g id="node77" class="node">
<title>gpu0_layer4_routing</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-15439.47 266.29,-15439.47 214.53,-15313.47 415.71,-15313.47 467.47,-15439.47"/>
<text text-anchor="middle" x="341" y="-15395.97" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="341" y="-15384.97" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-15373.97" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-15362.97" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="341" y="-15351.97" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer4_ln2&#45;&gt;gpu0_layer4_routing -->
<g id="edge96" class="edge">
<title>gpu0_layer4_ln2&#45;&gt;gpu0_layer4_routing</title>
<path fill="none" stroke="black" d="M341,-15476.38C341,-15468.45 341,-15459.25 341,-15449.72"/>
<polygon fill="black" stroke="black" points="344.5,-15449.7 341,-15439.7 337.5,-15449.7 344.5,-15449.7"/>
</g>
<!-- gpu0_layer4_expert0 -->
<g id="node78" class="node">
<title>gpu0_layer4_expert0</title>
<polygon fill="lightblue" stroke="black" points="122,-15267.47 0,-15267.47 0,-15215.47 122,-15215.47 122,-15267.47"/>
<text text-anchor="middle" x="61" y="-15255.47" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="61" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer4_routing&#45;&gt;gpu0_layer4_expert0 -->
<g id="edge83" class="edge">
<title>gpu0_layer4_routing&#45;&gt;gpu0_layer4_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M215.33,-15315.78C183.34,-15300.58 150.34,-15284.91 123.11,-15271.97"/>
<polygon fill="black" stroke="black" points="124.26,-15268.64 113.73,-15267.51 121.26,-15274.97 124.26,-15268.64"/>
<text text-anchor="middle" x="197.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer4_expert1 -->
<g id="node79" class="node">
<title>gpu0_layer4_expert1</title>
<polygon fill="lightblue" stroke="black" points="262,-15267.47 140,-15267.47 140,-15215.47 262,-15215.47 262,-15267.47"/>
<text text-anchor="middle" x="201" y="-15255.47" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="201" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer4_routing&#45;&gt;gpu0_layer4_expert1 -->
<g id="edge84" class="edge">
<title>gpu0_layer4_routing&#45;&gt;gpu0_layer4_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M275.51,-15313.25C261.48,-15299.93 247.21,-15286.37 234.97,-15274.74"/>
<polygon fill="black" stroke="black" points="237.29,-15272.11 227.63,-15267.76 232.46,-15277.19 237.29,-15272.11"/>
<text text-anchor="middle" x="284.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer4_expert2 -->
<g id="node80" class="node">
<title>gpu0_layer4_expert2</title>
<polygon fill="lightblue" stroke="black" points="402,-15267.47 280,-15267.47 280,-15215.47 402,-15215.47 402,-15267.47"/>
<text text-anchor="middle" x="341" y="-15255.47" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="341" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer4_routing&#45;&gt;gpu0_layer4_expert2 -->
<g id="edge85" class="edge">
<title>gpu0_layer4_routing&#45;&gt;gpu0_layer4_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M341,-15313.25C341,-15301.18 341,-15288.93 341,-15278.08"/>
<polygon fill="black" stroke="black" points="344.5,-15277.76 341,-15267.76 337.5,-15277.76 344.5,-15277.76"/>
<text text-anchor="middle" x="370.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer4_expert3 -->
<g id="node81" class="node">
<title>gpu0_layer4_expert3</title>
<polygon fill="lightblue" stroke="black" points="542,-15267.47 420,-15267.47 420,-15215.47 542,-15215.47 542,-15267.47"/>
<text text-anchor="middle" x="481" y="-15255.47" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="481" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer4_routing&#45;&gt;gpu0_layer4_expert3 -->
<g id="edge86" class="edge">
<title>gpu0_layer4_routing&#45;&gt;gpu0_layer4_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M406.49,-15313.25C420.52,-15299.93 434.79,-15286.37 447.03,-15274.74"/>
<polygon fill="black" stroke="black" points="449.54,-15277.19 454.37,-15267.76 444.71,-15272.11 449.54,-15277.19"/>
<text text-anchor="middle" x="465.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer4_expert_agg -->
<g id="node82" class="node">
<title>gpu0_layer4_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-15178.47 266.29,-15178.47 214.53,-15074.47 415.71,-15074.47 467.47,-15178.47"/>
<text text-anchor="middle" x="341" y="-15140.47" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="341" y="-15129.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-15118.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-15107.47" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer4_routing&#45;&gt;gpu0_layer4_expert_agg -->
<g id="edge101" class="edge">
<title>gpu0_layer4_routing&#45;&gt;gpu0_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M430.22,-15348.55C503.96,-15321.39 590.6,-15275 551,-15215.47 530.44,-15184.56 496.7,-15164.48 462.22,-15151.45"/>
<polygon fill="black" stroke="black" points="463.08,-15148.04 452.48,-15147.96 460.71,-15154.63 463.08,-15148.04"/>
</g>
<!-- gpu0_layer4_expert0&#45;&gt;gpu0_layer4_expert_agg -->
<g id="edge97" class="edge">
<title>gpu0_layer4_expert0&#45;&gt;gpu0_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M122.1,-15215.81C158.98,-15200.93 206.7,-15181.67 248.16,-15164.94"/>
<polygon fill="black" stroke="black" points="249.5,-15168.17 257.46,-15161.18 246.88,-15161.68 249.5,-15168.17"/>
</g>
<!-- gpu0_layer4_expert1&#45;&gt;gpu0_layer4_expert_agg -->
<g id="edge98" class="edge">
<title>gpu0_layer4_expert1&#45;&gt;gpu0_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M232.07,-15215.39C243.32,-15206.31 256.53,-15195.65 269.8,-15184.94"/>
<polygon fill="black" stroke="black" points="272.02,-15187.64 277.6,-15178.64 267.62,-15182.2 272.02,-15187.64"/>
</g>
<!-- gpu0_layer4_expert2&#45;&gt;gpu0_layer4_expert_agg -->
<g id="edge99" class="edge">
<title>gpu0_layer4_expert2&#45;&gt;gpu0_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M341,-15215.39C341,-15207.46 341,-15198.33 341,-15189.01"/>
<polygon fill="black" stroke="black" points="344.5,-15188.87 341,-15178.87 337.5,-15188.87 344.5,-15188.87"/>
</g>
<!-- gpu0_layer4_expert3&#45;&gt;gpu0_layer4_expert_agg -->
<g id="edge100" class="edge">
<title>gpu0_layer4_expert3&#45;&gt;gpu0_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M449.93,-15215.39C438.68,-15206.31 425.47,-15195.65 412.2,-15184.94"/>
<polygon fill="black" stroke="black" points="414.38,-15182.2 404.4,-15178.64 409.98,-15187.64 414.38,-15182.2"/>
</g>
<!-- gpu0_layer4_res2 -->
<g id="node83" class="node">
<title>gpu0_layer4_res2</title>
<polygon fill="lightblue" stroke="black" points="402,-15037.47 280,-15037.47 280,-14985.47 402,-14985.47 402,-15037.47"/>
<text text-anchor="middle" x="341" y="-15025.47" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="341" y="-15014.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-15003.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-14992.47" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer4_expert_agg&#45;&gt;gpu0_layer4_res2 -->
<g id="edge102" class="edge">
<title>gpu0_layer4_expert_agg&#45;&gt;gpu0_layer4_res2</title>
<path fill="none" stroke="black" d="M341,-15074.26C341,-15065.31 341,-15056.18 341,-15047.78"/>
<polygon fill="black" stroke="black" points="344.5,-15047.6 341,-15037.6 337.5,-15047.6 344.5,-15047.6"/>
</g>
<!-- gpu0_layer5_ln1 -->
<g id="node84" class="node">
<title>gpu0_layer5_ln1</title>
<polygon fill="lightblue" stroke="black" points="402,-14948.47 280,-14948.47 280,-14896.47 402,-14896.47 402,-14948.47"/>
<text text-anchor="middle" x="341" y="-14936.47" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="341" y="-14925.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-14914.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-14903.47" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer4_res2&#45;&gt;gpu0_layer5_ln1 -->
<g id="edge107" class="edge">
<title>gpu0_layer4_res2&#45;&gt;gpu0_layer5_ln1</title>
<path fill="none" stroke="black" d="M341,-14985.31C341,-14977.01 341,-14967.62 341,-14958.72"/>
<polygon fill="black" stroke="black" points="344.5,-14958.58 341,-14948.58 337.5,-14958.58 344.5,-14958.58"/>
</g>
<!-- gpu0_layer5_qkv -->
<g id="node85" class="node">
<title>gpu0_layer5_qkv</title>
<polygon fill="lightblue" stroke="black" points="402,-14859.47 280,-14859.47 280,-14807.47 402,-14807.47 402,-14859.47"/>
<text text-anchor="middle" x="341" y="-14847.47" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="341" y="-14836.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-14825.47" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-14814.47" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer5_ln1&#45;&gt;gpu0_layer5_qkv -->
<g id="edge108" class="edge">
<title>gpu0_layer5_ln1&#45;&gt;gpu0_layer5_qkv</title>
<path fill="none" stroke="black" d="M341,-14896.31C341,-14888.01 341,-14878.62 341,-14869.72"/>
<polygon fill="black" stroke="black" points="344.5,-14869.58 341,-14859.58 337.5,-14869.58 344.5,-14869.58"/>
</g>
<!-- gpu0_layer5_reshape -->
<g id="node86" class="node">
<title>gpu0_layer5_reshape</title>
<polygon fill="lightblue" stroke="black" points="405,-14770.47 277,-14770.47 277,-14718.47 405,-14718.47 405,-14770.47"/>
<text text-anchor="middle" x="341" y="-14758.47" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="341" y="-14747.47" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-14736.47" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-14725.47" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer5_qkv&#45;&gt;gpu0_layer5_reshape -->
<g id="edge109" class="edge">
<title>gpu0_layer5_qkv&#45;&gt;gpu0_layer5_reshape</title>
<path fill="none" stroke="black" d="M341,-14807.31C341,-14799.01 341,-14789.62 341,-14780.72"/>
<polygon fill="black" stroke="black" points="344.5,-14780.58 341,-14770.58 337.5,-14780.58 344.5,-14780.58"/>
</g>
<!-- gpu0_layer5_attn -->
<g id="node87" class="node">
<title>gpu0_layer5_attn</title>
<polygon fill="lightblue" stroke="black" points="405,-14681.47 277,-14681.47 277,-14629.47 405,-14629.47 405,-14681.47"/>
<text text-anchor="middle" x="341" y="-14669.47" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="341" y="-14658.47" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-14647.47" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-14636.47" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer5_reshape&#45;&gt;gpu0_layer5_attn -->
<g id="edge110" class="edge">
<title>gpu0_layer5_reshape&#45;&gt;gpu0_layer5_attn</title>
<path fill="none" stroke="black" d="M341,-14718.31C341,-14710.01 341,-14700.62 341,-14691.72"/>
<polygon fill="black" stroke="black" points="344.5,-14691.58 341,-14681.58 337.5,-14691.58 344.5,-14691.58"/>
</g>
<!-- gpu0_layer5_attn_reshape -->
<g id="node89" class="node">
<title>gpu0_layer5_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="402,-14592.47 280,-14592.47 280,-14540.47 402,-14540.47 402,-14592.47"/>
<text text-anchor="middle" x="341" y="-14580.47" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="341" y="-14569.47" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-14558.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-14547.47" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer5_attn&#45;&gt;gpu0_layer5_attn_reshape -->
<g id="edge111" class="edge">
<title>gpu0_layer5_attn&#45;&gt;gpu0_layer5_attn_reshape</title>
<path fill="none" stroke="black" d="M341,-14629.31C341,-14621.01 341,-14611.62 341,-14602.72"/>
<polygon fill="black" stroke="black" points="344.5,-14602.58 341,-14592.58 337.5,-14602.58 344.5,-14602.58"/>
</g>
<!-- gpu0_layer5_attn_out -->
<g id="node88" class="node">
<title>gpu0_layer5_attn_out</title>
<polygon fill="lightblue" stroke="black" points="402,-14503.47 280,-14503.47 280,-14451.47 402,-14451.47 402,-14503.47"/>
<text text-anchor="middle" x="341" y="-14491.47" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="341" y="-14480.47" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-14469.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-14458.47" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer5_kv_update -->
<g id="node90" class="node">
<title>gpu0_layer5_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="341" cy="-14377.7" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="341" y="-14391.7" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="341" y="-14380.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-14369.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-14358.7" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer5_attn_out&#45;&gt;gpu0_layer5_kv_update -->
<g id="edge113" class="edge">
<title>gpu0_layer5_attn_out&#45;&gt;gpu0_layer5_kv_update</title>
<path fill="none" stroke="black" d="M341,-14451.29C341,-14443.15 341,-14433.86 341,-14424.69"/>
<polygon fill="black" stroke="black" points="344.5,-14424.48 341,-14414.48 337.5,-14424.48 344.5,-14424.48"/>
</g>
<!-- gpu0_layer5_attn_reshape&#45;&gt;gpu0_layer5_attn_out -->
<g id="edge112" class="edge">
<title>gpu0_layer5_attn_reshape&#45;&gt;gpu0_layer5_attn_out</title>
<path fill="none" stroke="black" d="M341,-14540.31C341,-14532.01 341,-14522.62 341,-14513.72"/>
<polygon fill="black" stroke="black" points="344.5,-14513.58 341,-14503.58 337.5,-14513.58 344.5,-14513.58"/>
</g>
<!-- gpu0_layer5_res1 -->
<g id="node91" class="node">
<title>gpu0_layer5_res1</title>
<polygon fill="lightblue" stroke="black" points="402,-14303.93 280,-14303.93 280,-14251.93 402,-14251.93 402,-14303.93"/>
<text text-anchor="middle" x="341" y="-14291.93" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="341" y="-14280.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-14269.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-14258.93" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer5_kv_update&#45;&gt;gpu0_layer5_res1 -->
<g id="edge114" class="edge">
<title>gpu0_layer5_kv_update&#45;&gt;gpu0_layer5_res1</title>
<path fill="none" stroke="black" d="M341,-14340.85C341,-14332.17 341,-14322.9 341,-14314.25"/>
<polygon fill="black" stroke="black" points="344.5,-14314.08 341,-14304.08 337.5,-14314.08 344.5,-14314.08"/>
</g>
<!-- gpu0_layer5_ln2 -->
<g id="node92" class="node">
<title>gpu0_layer5_ln2</title>
<polygon fill="lightblue" stroke="black" points="402,-14214.93 280,-14214.93 280,-14162.93 402,-14162.93 402,-14214.93"/>
<text text-anchor="middle" x="341" y="-14202.93" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="341" y="-14191.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-14180.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-14169.93" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer5_res1&#45;&gt;gpu0_layer5_ln2 -->
<g id="edge115" class="edge">
<title>gpu0_layer5_res1&#45;&gt;gpu0_layer5_ln2</title>
<path fill="none" stroke="black" d="M341,-14251.77C341,-14243.47 341,-14234.08 341,-14225.18"/>
<polygon fill="black" stroke="black" points="344.5,-14225.04 341,-14215.04 337.5,-14225.04 344.5,-14225.04"/>
</g>
<!-- gpu0_layer5_routing -->
<g id="node93" class="node">
<title>gpu0_layer5_routing</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-14125.93 266.29,-14125.93 214.53,-13999.93 415.71,-13999.93 467.47,-14125.93"/>
<text text-anchor="middle" x="341" y="-14082.43" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="341" y="-14071.43" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-14060.43" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-14049.43" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="341" y="-14038.43" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer5_ln2&#45;&gt;gpu0_layer5_routing -->
<g id="edge116" class="edge">
<title>gpu0_layer5_ln2&#45;&gt;gpu0_layer5_routing</title>
<path fill="none" stroke="black" d="M341,-14162.84C341,-14154.91 341,-14145.71 341,-14136.18"/>
<polygon fill="black" stroke="black" points="344.5,-14136.17 341,-14126.17 337.5,-14136.17 344.5,-14136.17"/>
</g>
<!-- gpu0_layer5_expert0 -->
<g id="node94" class="node">
<title>gpu0_layer5_expert0</title>
<polygon fill="lightblue" stroke="black" points="122,-13953.93 0,-13953.93 0,-13901.93 122,-13901.93 122,-13953.93"/>
<text text-anchor="middle" x="61" y="-13941.93" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="61" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer5_routing&#45;&gt;gpu0_layer5_expert0 -->
<g id="edge103" class="edge">
<title>gpu0_layer5_routing&#45;&gt;gpu0_layer5_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M215.33,-14002.24C183.34,-13987.04 150.34,-13971.37 123.11,-13958.43"/>
<polygon fill="black" stroke="black" points="124.26,-13955.1 113.73,-13953.98 121.26,-13961.43 124.26,-13955.1"/>
<text text-anchor="middle" x="197.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer5_expert1 -->
<g id="node95" class="node">
<title>gpu0_layer5_expert1</title>
<polygon fill="lightblue" stroke="black" points="262,-13953.93 140,-13953.93 140,-13901.93 262,-13901.93 262,-13953.93"/>
<text text-anchor="middle" x="201" y="-13941.93" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="201" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer5_routing&#45;&gt;gpu0_layer5_expert1 -->
<g id="edge104" class="edge">
<title>gpu0_layer5_routing&#45;&gt;gpu0_layer5_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M275.51,-13999.71C261.48,-13986.39 247.21,-13972.83 234.97,-13961.2"/>
<polygon fill="black" stroke="black" points="237.29,-13958.57 227.63,-13954.22 232.46,-13963.65 237.29,-13958.57"/>
<text text-anchor="middle" x="284.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer5_expert2 -->
<g id="node96" class="node">
<title>gpu0_layer5_expert2</title>
<polygon fill="lightblue" stroke="black" points="402,-13953.93 280,-13953.93 280,-13901.93 402,-13901.93 402,-13953.93"/>
<text text-anchor="middle" x="341" y="-13941.93" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="341" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer5_routing&#45;&gt;gpu0_layer5_expert2 -->
<g id="edge105" class="edge">
<title>gpu0_layer5_routing&#45;&gt;gpu0_layer5_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M341,-13999.71C341,-13987.65 341,-13975.39 341,-13964.54"/>
<polygon fill="black" stroke="black" points="344.5,-13964.22 341,-13954.22 337.5,-13964.22 344.5,-13964.22"/>
<text text-anchor="middle" x="370.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer5_expert3 -->
<g id="node97" class="node">
<title>gpu0_layer5_expert3</title>
<polygon fill="lightblue" stroke="black" points="542,-13953.93 420,-13953.93 420,-13901.93 542,-13901.93 542,-13953.93"/>
<text text-anchor="middle" x="481" y="-13941.93" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="481" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer5_routing&#45;&gt;gpu0_layer5_expert3 -->
<g id="edge106" class="edge">
<title>gpu0_layer5_routing&#45;&gt;gpu0_layer5_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M406.49,-13999.71C420.52,-13986.39 434.79,-13972.83 447.03,-13961.2"/>
<polygon fill="black" stroke="black" points="449.54,-13963.65 454.37,-13954.22 444.71,-13958.57 449.54,-13963.65"/>
<text text-anchor="middle" x="465.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer5_expert_agg -->
<g id="node98" class="node">
<title>gpu0_layer5_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-13864.93 266.29,-13864.93 214.53,-13760.93 415.71,-13760.93 467.47,-13864.93"/>
<text text-anchor="middle" x="341" y="-13826.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="341" y="-13815.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-13804.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-13793.93" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer5_routing&#45;&gt;gpu0_layer5_expert_agg -->
<g id="edge121" class="edge">
<title>gpu0_layer5_routing&#45;&gt;gpu0_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M430.22,-14035.01C503.96,-14007.85 590.6,-13961.46 551,-13901.93 530.44,-13871.02 496.7,-13850.94 462.22,-13837.91"/>
<polygon fill="black" stroke="black" points="463.08,-13834.5 452.48,-13834.42 460.71,-13841.09 463.08,-13834.5"/>
</g>
<!-- gpu0_layer5_expert0&#45;&gt;gpu0_layer5_expert_agg -->
<g id="edge117" class="edge">
<title>gpu0_layer5_expert0&#45;&gt;gpu0_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M122.1,-13902.27C158.98,-13887.39 206.7,-13868.13 248.16,-13851.4"/>
<polygon fill="black" stroke="black" points="249.5,-13854.63 257.46,-13847.65 246.88,-13848.14 249.5,-13854.63"/>
</g>
<!-- gpu0_layer5_expert1&#45;&gt;gpu0_layer5_expert_agg -->
<g id="edge118" class="edge">
<title>gpu0_layer5_expert1&#45;&gt;gpu0_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M232.07,-13901.85C243.32,-13892.77 256.53,-13882.11 269.8,-13871.4"/>
<polygon fill="black" stroke="black" points="272.02,-13874.11 277.6,-13865.1 267.62,-13868.66 272.02,-13874.11"/>
</g>
<!-- gpu0_layer5_expert2&#45;&gt;gpu0_layer5_expert_agg -->
<g id="edge119" class="edge">
<title>gpu0_layer5_expert2&#45;&gt;gpu0_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M341,-13901.85C341,-13893.93 341,-13884.79 341,-13875.47"/>
<polygon fill="black" stroke="black" points="344.5,-13875.33 341,-13865.33 337.5,-13875.33 344.5,-13875.33"/>
</g>
<!-- gpu0_layer5_expert3&#45;&gt;gpu0_layer5_expert_agg -->
<g id="edge120" class="edge">
<title>gpu0_layer5_expert3&#45;&gt;gpu0_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M449.93,-13901.85C438.68,-13892.77 425.47,-13882.11 412.2,-13871.4"/>
<polygon fill="black" stroke="black" points="414.38,-13868.66 404.4,-13865.1 409.98,-13874.11 414.38,-13868.66"/>
</g>
<!-- gpu0_layer5_res2 -->
<g id="node99" class="node">
<title>gpu0_layer5_res2</title>
<polygon fill="lightblue" stroke="black" points="402,-13723.93 280,-13723.93 280,-13671.93 402,-13671.93 402,-13723.93"/>
<text text-anchor="middle" x="341" y="-13711.93" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="341" y="-13700.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-13689.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-13678.93" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer5_expert_agg&#45;&gt;gpu0_layer5_res2 -->
<g id="edge122" class="edge">
<title>gpu0_layer5_expert_agg&#45;&gt;gpu0_layer5_res2</title>
<path fill="none" stroke="black" d="M341,-13760.72C341,-13751.77 341,-13742.64 341,-13734.24"/>
<polygon fill="black" stroke="black" points="344.5,-13734.06 341,-13724.06 337.5,-13734.06 344.5,-13734.06"/>
</g>
<!-- gpu0_layer6_ln1 -->
<g id="node100" class="node">
<title>gpu0_layer6_ln1</title>
<polygon fill="lightblue" stroke="black" points="402,-13634.93 280,-13634.93 280,-13582.93 402,-13582.93 402,-13634.93"/>
<text text-anchor="middle" x="341" y="-13622.93" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="341" y="-13611.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-13600.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-13589.93" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer5_res2&#45;&gt;gpu0_layer6_ln1 -->
<g id="edge127" class="edge">
<title>gpu0_layer5_res2&#45;&gt;gpu0_layer6_ln1</title>
<path fill="none" stroke="black" d="M341,-13671.77C341,-13663.47 341,-13654.08 341,-13645.18"/>
<polygon fill="black" stroke="black" points="344.5,-13645.04 341,-13635.04 337.5,-13645.04 344.5,-13645.04"/>
</g>
<!-- gpu0_layer6_qkv -->
<g id="node101" class="node">
<title>gpu0_layer6_qkv</title>
<polygon fill="lightblue" stroke="black" points="402,-13545.93 280,-13545.93 280,-13493.93 402,-13493.93 402,-13545.93"/>
<text text-anchor="middle" x="341" y="-13533.93" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="341" y="-13522.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-13511.93" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-13500.93" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer6_ln1&#45;&gt;gpu0_layer6_qkv -->
<g id="edge128" class="edge">
<title>gpu0_layer6_ln1&#45;&gt;gpu0_layer6_qkv</title>
<path fill="none" stroke="black" d="M341,-13582.77C341,-13574.47 341,-13565.08 341,-13556.18"/>
<polygon fill="black" stroke="black" points="344.5,-13556.04 341,-13546.04 337.5,-13556.04 344.5,-13556.04"/>
</g>
<!-- gpu0_layer6_reshape -->
<g id="node102" class="node">
<title>gpu0_layer6_reshape</title>
<polygon fill="lightblue" stroke="black" points="405,-13456.93 277,-13456.93 277,-13404.93 405,-13404.93 405,-13456.93"/>
<text text-anchor="middle" x="341" y="-13444.93" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="341" y="-13433.93" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-13422.93" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-13411.93" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer6_qkv&#45;&gt;gpu0_layer6_reshape -->
<g id="edge129" class="edge">
<title>gpu0_layer6_qkv&#45;&gt;gpu0_layer6_reshape</title>
<path fill="none" stroke="black" d="M341,-13493.77C341,-13485.47 341,-13476.08 341,-13467.18"/>
<polygon fill="black" stroke="black" points="344.5,-13467.04 341,-13457.04 337.5,-13467.04 344.5,-13467.04"/>
</g>
<!-- gpu0_layer6_attn -->
<g id="node103" class="node">
<title>gpu0_layer6_attn</title>
<polygon fill="lightblue" stroke="black" points="405,-13367.93 277,-13367.93 277,-13315.93 405,-13315.93 405,-13367.93"/>
<text text-anchor="middle" x="341" y="-13355.93" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="341" y="-13344.93" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-13333.93" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-13322.93" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer6_reshape&#45;&gt;gpu0_layer6_attn -->
<g id="edge130" class="edge">
<title>gpu0_layer6_reshape&#45;&gt;gpu0_layer6_attn</title>
<path fill="none" stroke="black" d="M341,-13404.77C341,-13396.47 341,-13387.08 341,-13378.18"/>
<polygon fill="black" stroke="black" points="344.5,-13378.04 341,-13368.04 337.5,-13378.04 344.5,-13378.04"/>
</g>
<!-- gpu0_layer6_attn_reshape -->
<g id="node105" class="node">
<title>gpu0_layer6_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="402,-13278.93 280,-13278.93 280,-13226.93 402,-13226.93 402,-13278.93"/>
<text text-anchor="middle" x="341" y="-13266.93" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="341" y="-13255.93" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-13244.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-13233.93" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer6_attn&#45;&gt;gpu0_layer6_attn_reshape -->
<g id="edge131" class="edge">
<title>gpu0_layer6_attn&#45;&gt;gpu0_layer6_attn_reshape</title>
<path fill="none" stroke="black" d="M341,-13315.77C341,-13307.47 341,-13298.08 341,-13289.18"/>
<polygon fill="black" stroke="black" points="344.5,-13289.04 341,-13279.04 337.5,-13289.04 344.5,-13289.04"/>
</g>
<!-- gpu0_layer6_attn_out -->
<g id="node104" class="node">
<title>gpu0_layer6_attn_out</title>
<polygon fill="lightblue" stroke="black" points="402,-13189.93 280,-13189.93 280,-13137.93 402,-13137.93 402,-13189.93"/>
<text text-anchor="middle" x="341" y="-13177.93" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="341" y="-13166.93" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-13155.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-13144.93" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer6_kv_update -->
<g id="node106" class="node">
<title>gpu0_layer6_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="341" cy="-13064.16" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="341" y="-13078.16" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="341" y="-13067.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-13056.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-13045.16" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer6_attn_out&#45;&gt;gpu0_layer6_kv_update -->
<g id="edge133" class="edge">
<title>gpu0_layer6_attn_out&#45;&gt;gpu0_layer6_kv_update</title>
<path fill="none" stroke="black" d="M341,-13137.75C341,-13129.61 341,-13120.32 341,-13111.16"/>
<polygon fill="black" stroke="black" points="344.5,-13110.94 341,-13100.94 337.5,-13110.94 344.5,-13110.94"/>
</g>
<!-- gpu0_layer6_attn_reshape&#45;&gt;gpu0_layer6_attn_out -->
<g id="edge132" class="edge">
<title>gpu0_layer6_attn_reshape&#45;&gt;gpu0_layer6_attn_out</title>
<path fill="none" stroke="black" d="M341,-13226.77C341,-13218.47 341,-13209.08 341,-13200.18"/>
<polygon fill="black" stroke="black" points="344.5,-13200.04 341,-13190.04 337.5,-13200.04 344.5,-13200.04"/>
</g>
<!-- gpu0_layer6_res1 -->
<g id="node107" class="node">
<title>gpu0_layer6_res1</title>
<polygon fill="lightblue" stroke="black" points="402,-12990.39 280,-12990.39 280,-12938.39 402,-12938.39 402,-12990.39"/>
<text text-anchor="middle" x="341" y="-12978.39" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="341" y="-12967.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-12956.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-12945.39" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer6_kv_update&#45;&gt;gpu0_layer6_res1 -->
<g id="edge134" class="edge">
<title>gpu0_layer6_kv_update&#45;&gt;gpu0_layer6_res1</title>
<path fill="none" stroke="black" d="M341,-13027.31C341,-13018.63 341,-13009.36 341,-13000.71"/>
<polygon fill="black" stroke="black" points="344.5,-13000.54 341,-12990.54 337.5,-13000.54 344.5,-13000.54"/>
</g>
<!-- gpu0_layer6_ln2 -->
<g id="node108" class="node">
<title>gpu0_layer6_ln2</title>
<polygon fill="lightblue" stroke="black" points="402,-12901.39 280,-12901.39 280,-12849.39 402,-12849.39 402,-12901.39"/>
<text text-anchor="middle" x="341" y="-12889.39" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="341" y="-12878.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-12867.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-12856.39" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer6_res1&#45;&gt;gpu0_layer6_ln2 -->
<g id="edge135" class="edge">
<title>gpu0_layer6_res1&#45;&gt;gpu0_layer6_ln2</title>
<path fill="none" stroke="black" d="M341,-12938.23C341,-12929.93 341,-12920.55 341,-12911.64"/>
<polygon fill="black" stroke="black" points="344.5,-12911.5 341,-12901.5 337.5,-12911.5 344.5,-12911.5"/>
</g>
<!-- gpu0_layer6_routing -->
<g id="node109" class="node">
<title>gpu0_layer6_routing</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-12812.39 266.29,-12812.39 214.53,-12686.39 415.71,-12686.39 467.47,-12812.39"/>
<text text-anchor="middle" x="341" y="-12768.89" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="341" y="-12757.89" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-12746.89" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-12735.89" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="341" y="-12724.89" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer6_ln2&#45;&gt;gpu0_layer6_routing -->
<g id="edge136" class="edge">
<title>gpu0_layer6_ln2&#45;&gt;gpu0_layer6_routing</title>
<path fill="none" stroke="black" d="M341,-12849.3C341,-12841.37 341,-12832.17 341,-12822.64"/>
<polygon fill="black" stroke="black" points="344.5,-12822.63 341,-12812.63 337.5,-12822.63 344.5,-12822.63"/>
</g>
<!-- gpu0_layer6_expert0 -->
<g id="node110" class="node">
<title>gpu0_layer6_expert0</title>
<polygon fill="lightblue" stroke="black" points="122,-12640.39 0,-12640.39 0,-12588.39 122,-12588.39 122,-12640.39"/>
<text text-anchor="middle" x="61" y="-12628.39" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="61" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer6_routing&#45;&gt;gpu0_layer6_expert0 -->
<g id="edge123" class="edge">
<title>gpu0_layer6_routing&#45;&gt;gpu0_layer6_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M215.33,-12688.7C183.34,-12673.5 150.34,-12657.83 123.11,-12644.89"/>
<polygon fill="black" stroke="black" points="124.26,-12641.57 113.73,-12640.44 121.26,-12647.89 124.26,-12641.57"/>
<text text-anchor="middle" x="197.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer6_expert1 -->
<g id="node111" class="node">
<title>gpu0_layer6_expert1</title>
<polygon fill="lightblue" stroke="black" points="262,-12640.39 140,-12640.39 140,-12588.39 262,-12588.39 262,-12640.39"/>
<text text-anchor="middle" x="201" y="-12628.39" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="201" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer6_routing&#45;&gt;gpu0_layer6_expert1 -->
<g id="edge124" class="edge">
<title>gpu0_layer6_routing&#45;&gt;gpu0_layer6_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M275.51,-12686.17C261.48,-12672.85 247.21,-12659.29 234.97,-12647.66"/>
<polygon fill="black" stroke="black" points="237.29,-12645.03 227.63,-12640.68 232.46,-12650.11 237.29,-12645.03"/>
<text text-anchor="middle" x="284.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer6_expert2 -->
<g id="node112" class="node">
<title>gpu0_layer6_expert2</title>
<polygon fill="lightblue" stroke="black" points="402,-12640.39 280,-12640.39 280,-12588.39 402,-12588.39 402,-12640.39"/>
<text text-anchor="middle" x="341" y="-12628.39" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="341" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer6_routing&#45;&gt;gpu0_layer6_expert2 -->
<g id="edge125" class="edge">
<title>gpu0_layer6_routing&#45;&gt;gpu0_layer6_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M341,-12686.17C341,-12674.11 341,-12661.85 341,-12651"/>
<polygon fill="black" stroke="black" points="344.5,-12650.68 341,-12640.68 337.5,-12650.68 344.5,-12650.68"/>
<text text-anchor="middle" x="370.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer6_expert3 -->
<g id="node113" class="node">
<title>gpu0_layer6_expert3</title>
<polygon fill="lightblue" stroke="black" points="542,-12640.39 420,-12640.39 420,-12588.39 542,-12588.39 542,-12640.39"/>
<text text-anchor="middle" x="481" y="-12628.39" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="481" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer6_routing&#45;&gt;gpu0_layer6_expert3 -->
<g id="edge126" class="edge">
<title>gpu0_layer6_routing&#45;&gt;gpu0_layer6_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M406.49,-12686.17C420.52,-12672.85 434.79,-12659.29 447.03,-12647.66"/>
<polygon fill="black" stroke="black" points="449.54,-12650.11 454.37,-12640.68 444.71,-12645.03 449.54,-12650.11"/>
<text text-anchor="middle" x="465.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer6_expert_agg -->
<g id="node114" class="node">
<title>gpu0_layer6_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-12551.39 266.29,-12551.39 214.53,-12447.39 415.71,-12447.39 467.47,-12551.39"/>
<text text-anchor="middle" x="341" y="-12513.39" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="341" y="-12502.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-12491.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-12480.39" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer6_routing&#45;&gt;gpu0_layer6_expert_agg -->
<g id="edge141" class="edge">
<title>gpu0_layer6_routing&#45;&gt;gpu0_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M430.22,-12721.47C503.96,-12694.32 590.6,-12647.92 551,-12588.39 530.44,-12557.48 496.7,-12537.4 462.22,-12524.38"/>
<polygon fill="black" stroke="black" points="463.08,-12520.97 452.48,-12520.88 460.71,-12527.55 463.08,-12520.97"/>
</g>
<!-- gpu0_layer6_expert0&#45;&gt;gpu0_layer6_expert_agg -->
<g id="edge137" class="edge">
<title>gpu0_layer6_expert0&#45;&gt;gpu0_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M122.1,-12588.73C158.98,-12573.85 206.7,-12554.59 248.16,-12537.86"/>
<polygon fill="black" stroke="black" points="249.5,-12541.09 257.46,-12534.11 246.88,-12534.6 249.5,-12541.09"/>
</g>
<!-- gpu0_layer6_expert1&#45;&gt;gpu0_layer6_expert_agg -->
<g id="edge138" class="edge">
<title>gpu0_layer6_expert1&#45;&gt;gpu0_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M232.07,-12588.31C243.32,-12579.24 256.53,-12568.57 269.8,-12557.86"/>
<polygon fill="black" stroke="black" points="272.02,-12560.57 277.6,-12551.56 267.62,-12555.12 272.02,-12560.57"/>
</g>
<!-- gpu0_layer6_expert2&#45;&gt;gpu0_layer6_expert_agg -->
<g id="edge139" class="edge">
<title>gpu0_layer6_expert2&#45;&gt;gpu0_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M341,-12588.31C341,-12580.39 341,-12571.25 341,-12561.93"/>
<polygon fill="black" stroke="black" points="344.5,-12561.79 341,-12551.79 337.5,-12561.79 344.5,-12561.79"/>
</g>
<!-- gpu0_layer6_expert3&#45;&gt;gpu0_layer6_expert_agg -->
<g id="edge140" class="edge">
<title>gpu0_layer6_expert3&#45;&gt;gpu0_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M449.93,-12588.31C438.68,-12579.24 425.47,-12568.57 412.2,-12557.86"/>
<polygon fill="black" stroke="black" points="414.38,-12555.12 404.4,-12551.56 409.98,-12560.57 414.38,-12555.12"/>
</g>
<!-- gpu0_layer6_res2 -->
<g id="node115" class="node">
<title>gpu0_layer6_res2</title>
<polygon fill="lightblue" stroke="black" points="402,-12410.39 280,-12410.39 280,-12358.39 402,-12358.39 402,-12410.39"/>
<text text-anchor="middle" x="341" y="-12398.39" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="341" y="-12387.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-12376.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-12365.39" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer6_expert_agg&#45;&gt;gpu0_layer6_res2 -->
<g id="edge142" class="edge">
<title>gpu0_layer6_expert_agg&#45;&gt;gpu0_layer6_res2</title>
<path fill="none" stroke="black" d="M341,-12447.18C341,-12438.23 341,-12429.1 341,-12420.7"/>
<polygon fill="black" stroke="black" points="344.5,-12420.52 341,-12410.52 337.5,-12420.52 344.5,-12420.52"/>
</g>
<!-- gpu0_layer7_ln1 -->
<g id="node116" class="node">
<title>gpu0_layer7_ln1</title>
<polygon fill="lightblue" stroke="black" points="402,-12321.39 280,-12321.39 280,-12269.39 402,-12269.39 402,-12321.39"/>
<text text-anchor="middle" x="341" y="-12309.39" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="341" y="-12298.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-12287.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-12276.39" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer6_res2&#45;&gt;gpu0_layer7_ln1 -->
<g id="edge147" class="edge">
<title>gpu0_layer6_res2&#45;&gt;gpu0_layer7_ln1</title>
<path fill="none" stroke="black" d="M341,-12358.23C341,-12349.93 341,-12340.55 341,-12331.64"/>
<polygon fill="black" stroke="black" points="344.5,-12331.5 341,-12321.5 337.5,-12331.5 344.5,-12331.5"/>
</g>
<!-- gpu0_layer7_qkv -->
<g id="node117" class="node">
<title>gpu0_layer7_qkv</title>
<polygon fill="lightblue" stroke="black" points="402,-12232.39 280,-12232.39 280,-12180.39 402,-12180.39 402,-12232.39"/>
<text text-anchor="middle" x="341" y="-12220.39" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="341" y="-12209.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-12198.39" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-12187.39" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer7_ln1&#45;&gt;gpu0_layer7_qkv -->
<g id="edge148" class="edge">
<title>gpu0_layer7_ln1&#45;&gt;gpu0_layer7_qkv</title>
<path fill="none" stroke="black" d="M341,-12269.23C341,-12260.93 341,-12251.55 341,-12242.64"/>
<polygon fill="black" stroke="black" points="344.5,-12242.5 341,-12232.5 337.5,-12242.5 344.5,-12242.5"/>
</g>
<!-- gpu0_layer7_reshape -->
<g id="node118" class="node">
<title>gpu0_layer7_reshape</title>
<polygon fill="lightblue" stroke="black" points="405,-12143.39 277,-12143.39 277,-12091.39 405,-12091.39 405,-12143.39"/>
<text text-anchor="middle" x="341" y="-12131.39" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="341" y="-12120.39" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-12109.39" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-12098.39" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer7_qkv&#45;&gt;gpu0_layer7_reshape -->
<g id="edge149" class="edge">
<title>gpu0_layer7_qkv&#45;&gt;gpu0_layer7_reshape</title>
<path fill="none" stroke="black" d="M341,-12180.23C341,-12171.93 341,-12162.55 341,-12153.64"/>
<polygon fill="black" stroke="black" points="344.5,-12153.5 341,-12143.5 337.5,-12153.5 344.5,-12153.5"/>
</g>
<!-- gpu0_layer7_attn -->
<g id="node119" class="node">
<title>gpu0_layer7_attn</title>
<polygon fill="lightblue" stroke="black" points="405,-12054.39 277,-12054.39 277,-12002.39 405,-12002.39 405,-12054.39"/>
<text text-anchor="middle" x="341" y="-12042.39" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="341" y="-12031.39" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-12020.39" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-12009.39" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer7_reshape&#45;&gt;gpu0_layer7_attn -->
<g id="edge150" class="edge">
<title>gpu0_layer7_reshape&#45;&gt;gpu0_layer7_attn</title>
<path fill="none" stroke="black" d="M341,-12091.23C341,-12082.93 341,-12073.55 341,-12064.64"/>
<polygon fill="black" stroke="black" points="344.5,-12064.5 341,-12054.5 337.5,-12064.5 344.5,-12064.5"/>
</g>
<!-- gpu0_layer7_attn_reshape -->
<g id="node121" class="node">
<title>gpu0_layer7_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="402,-11965.39 280,-11965.39 280,-11913.39 402,-11913.39 402,-11965.39"/>
<text text-anchor="middle" x="341" y="-11953.39" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="341" y="-11942.39" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-11931.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-11920.39" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer7_attn&#45;&gt;gpu0_layer7_attn_reshape -->
<g id="edge151" class="edge">
<title>gpu0_layer7_attn&#45;&gt;gpu0_layer7_attn_reshape</title>
<path fill="none" stroke="black" d="M341,-12002.23C341,-11993.93 341,-11984.55 341,-11975.64"/>
<polygon fill="black" stroke="black" points="344.5,-11975.5 341,-11965.5 337.5,-11975.5 344.5,-11975.5"/>
</g>
<!-- gpu0_layer7_attn_out -->
<g id="node120" class="node">
<title>gpu0_layer7_attn_out</title>
<polygon fill="lightblue" stroke="black" points="402,-11876.39 280,-11876.39 280,-11824.39 402,-11824.39 402,-11876.39"/>
<text text-anchor="middle" x="341" y="-11864.39" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="341" y="-11853.39" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-11842.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-11831.39" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer7_kv_update -->
<g id="node122" class="node">
<title>gpu0_layer7_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="341" cy="-11750.62" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="341" y="-11764.62" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="341" y="-11753.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-11742.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-11731.62" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer7_attn_out&#45;&gt;gpu0_layer7_kv_update -->
<g id="edge153" class="edge">
<title>gpu0_layer7_attn_out&#45;&gt;gpu0_layer7_kv_update</title>
<path fill="none" stroke="black" d="M341,-11824.21C341,-11816.07 341,-11806.78 341,-11797.62"/>
<polygon fill="black" stroke="black" points="344.5,-11797.4 341,-11787.4 337.5,-11797.4 344.5,-11797.4"/>
</g>
<!-- gpu0_layer7_attn_reshape&#45;&gt;gpu0_layer7_attn_out -->
<g id="edge152" class="edge">
<title>gpu0_layer7_attn_reshape&#45;&gt;gpu0_layer7_attn_out</title>
<path fill="none" stroke="black" d="M341,-11913.23C341,-11904.93 341,-11895.55 341,-11886.64"/>
<polygon fill="black" stroke="black" points="344.5,-11886.5 341,-11876.5 337.5,-11886.5 344.5,-11886.5"/>
</g>
<!-- gpu0_layer7_res1 -->
<g id="node123" class="node">
<title>gpu0_layer7_res1</title>
<polygon fill="lightblue" stroke="black" points="402,-11676.85 280,-11676.85 280,-11624.85 402,-11624.85 402,-11676.85"/>
<text text-anchor="middle" x="341" y="-11664.85" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="341" y="-11653.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-11642.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-11631.85" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer7_kv_update&#45;&gt;gpu0_layer7_res1 -->
<g id="edge154" class="edge">
<title>gpu0_layer7_kv_update&#45;&gt;gpu0_layer7_res1</title>
<path fill="none" stroke="black" d="M341,-11713.77C341,-11705.09 341,-11695.82 341,-11687.17"/>
<polygon fill="black" stroke="black" points="344.5,-11687 341,-11677 337.5,-11687 344.5,-11687"/>
</g>
<!-- gpu0_layer7_ln2 -->
<g id="node124" class="node">
<title>gpu0_layer7_ln2</title>
<polygon fill="lightblue" stroke="black" points="402,-11587.85 280,-11587.85 280,-11535.85 402,-11535.85 402,-11587.85"/>
<text text-anchor="middle" x="341" y="-11575.85" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="341" y="-11564.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-11553.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-11542.85" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer7_res1&#45;&gt;gpu0_layer7_ln2 -->
<g id="edge155" class="edge">
<title>gpu0_layer7_res1&#45;&gt;gpu0_layer7_ln2</title>
<path fill="none" stroke="black" d="M341,-11624.69C341,-11616.39 341,-11607.01 341,-11598.1"/>
<polygon fill="black" stroke="black" points="344.5,-11597.96 341,-11587.96 337.5,-11597.96 344.5,-11597.96"/>
</g>
<!-- gpu0_layer7_routing -->
<g id="node125" class="node">
<title>gpu0_layer7_routing</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-11498.85 266.29,-11498.85 214.53,-11372.85 415.71,-11372.85 467.47,-11498.85"/>
<text text-anchor="middle" x="341" y="-11455.35" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="341" y="-11444.35" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-11433.35" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-11422.35" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="341" y="-11411.35" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer7_ln2&#45;&gt;gpu0_layer7_routing -->
<g id="edge156" class="edge">
<title>gpu0_layer7_ln2&#45;&gt;gpu0_layer7_routing</title>
<path fill="none" stroke="black" d="M341,-11535.76C341,-11527.83 341,-11518.63 341,-11509.1"/>
<polygon fill="black" stroke="black" points="344.5,-11509.09 341,-11499.09 337.5,-11509.09 344.5,-11509.09"/>
</g>
<!-- gpu0_layer7_expert0 -->
<g id="node126" class="node">
<title>gpu0_layer7_expert0</title>
<polygon fill="lightblue" stroke="black" points="122,-11326.85 0,-11326.85 0,-11274.85 122,-11274.85 122,-11326.85"/>
<text text-anchor="middle" x="61" y="-11314.85" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="61" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer7_routing&#45;&gt;gpu0_layer7_expert0 -->
<g id="edge143" class="edge">
<title>gpu0_layer7_routing&#45;&gt;gpu0_layer7_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M215.33,-11375.16C183.34,-11359.96 150.34,-11344.29 123.11,-11331.35"/>
<polygon fill="black" stroke="black" points="124.26,-11328.03 113.73,-11326.9 121.26,-11334.35 124.26,-11328.03"/>
<text text-anchor="middle" x="197.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer7_expert1 -->
<g id="node127" class="node">
<title>gpu0_layer7_expert1</title>
<polygon fill="lightblue" stroke="black" points="262,-11326.85 140,-11326.85 140,-11274.85 262,-11274.85 262,-11326.85"/>
<text text-anchor="middle" x="201" y="-11314.85" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="201" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer7_routing&#45;&gt;gpu0_layer7_expert1 -->
<g id="edge144" class="edge">
<title>gpu0_layer7_routing&#45;&gt;gpu0_layer7_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M275.51,-11372.64C261.48,-11359.31 247.21,-11345.76 234.97,-11334.12"/>
<polygon fill="black" stroke="black" points="237.29,-11331.5 227.63,-11327.15 232.46,-11336.57 237.29,-11331.5"/>
<text text-anchor="middle" x="284.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer7_expert2 -->
<g id="node128" class="node">
<title>gpu0_layer7_expert2</title>
<polygon fill="lightblue" stroke="black" points="402,-11326.85 280,-11326.85 280,-11274.85 402,-11274.85 402,-11326.85"/>
<text text-anchor="middle" x="341" y="-11314.85" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="341" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer7_routing&#45;&gt;gpu0_layer7_expert2 -->
<g id="edge145" class="edge">
<title>gpu0_layer7_routing&#45;&gt;gpu0_layer7_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M341,-11372.64C341,-11360.57 341,-11348.31 341,-11337.46"/>
<polygon fill="black" stroke="black" points="344.5,-11337.15 341,-11327.15 337.5,-11337.15 344.5,-11337.15"/>
<text text-anchor="middle" x="370.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer7_expert3 -->
<g id="node129" class="node">
<title>gpu0_layer7_expert3</title>
<polygon fill="lightblue" stroke="black" points="542,-11326.85 420,-11326.85 420,-11274.85 542,-11274.85 542,-11326.85"/>
<text text-anchor="middle" x="481" y="-11314.85" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="481" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer7_routing&#45;&gt;gpu0_layer7_expert3 -->
<g id="edge146" class="edge">
<title>gpu0_layer7_routing&#45;&gt;gpu0_layer7_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M406.49,-11372.64C420.52,-11359.31 434.79,-11345.76 447.03,-11334.12"/>
<polygon fill="black" stroke="black" points="449.54,-11336.57 454.37,-11327.15 444.71,-11331.5 449.54,-11336.57"/>
<text text-anchor="middle" x="465.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer7_expert_agg -->
<g id="node130" class="node">
<title>gpu0_layer7_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-11237.85 266.29,-11237.85 214.53,-11133.85 415.71,-11133.85 467.47,-11237.85"/>
<text text-anchor="middle" x="341" y="-11199.85" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="341" y="-11188.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-11177.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-11166.85" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer7_routing&#45;&gt;gpu0_layer7_expert_agg -->
<g id="edge161" class="edge">
<title>gpu0_layer7_routing&#45;&gt;gpu0_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M430.22,-11407.94C503.96,-11380.78 590.6,-11334.39 551,-11274.85 530.44,-11243.94 496.7,-11223.87 462.22,-11210.84"/>
<polygon fill="black" stroke="black" points="463.08,-11207.43 452.48,-11207.35 460.71,-11214.02 463.08,-11207.43"/>
</g>
<!-- gpu0_layer7_expert0&#45;&gt;gpu0_layer7_expert_agg -->
<g id="edge157" class="edge">
<title>gpu0_layer7_expert0&#45;&gt;gpu0_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M122.1,-11275.19C158.98,-11260.31 206.7,-11241.05 248.16,-11224.32"/>
<polygon fill="black" stroke="black" points="249.5,-11227.56 257.46,-11220.57 246.88,-11221.06 249.5,-11227.56"/>
</g>
<!-- gpu0_layer7_expert1&#45;&gt;gpu0_layer7_expert_agg -->
<g id="edge158" class="edge">
<title>gpu0_layer7_expert1&#45;&gt;gpu0_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M232.07,-11274.77C243.32,-11265.7 256.53,-11255.03 269.8,-11244.32"/>
<polygon fill="black" stroke="black" points="272.02,-11247.03 277.6,-11238.02 267.62,-11241.58 272.02,-11247.03"/>
</g>
<!-- gpu0_layer7_expert2&#45;&gt;gpu0_layer7_expert_agg -->
<g id="edge159" class="edge">
<title>gpu0_layer7_expert2&#45;&gt;gpu0_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M341,-11274.77C341,-11266.85 341,-11257.71 341,-11248.39"/>
<polygon fill="black" stroke="black" points="344.5,-11248.25 341,-11238.25 337.5,-11248.25 344.5,-11248.25"/>
</g>
<!-- gpu0_layer7_expert3&#45;&gt;gpu0_layer7_expert_agg -->
<g id="edge160" class="edge">
<title>gpu0_layer7_expert3&#45;&gt;gpu0_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M449.93,-11274.77C438.68,-11265.7 425.47,-11255.03 412.2,-11244.32"/>
<polygon fill="black" stroke="black" points="414.38,-11241.58 404.4,-11238.02 409.98,-11247.03 414.38,-11241.58"/>
</g>
<!-- gpu0_layer7_res2 -->
<g id="node131" class="node">
<title>gpu0_layer7_res2</title>
<polygon fill="lightblue" stroke="black" points="402,-11096.85 280,-11096.85 280,-11044.85 402,-11044.85 402,-11096.85"/>
<text text-anchor="middle" x="341" y="-11084.85" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="341" y="-11073.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-11062.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-11051.85" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer7_expert_agg&#45;&gt;gpu0_layer7_res2 -->
<g id="edge162" class="edge">
<title>gpu0_layer7_expert_agg&#45;&gt;gpu0_layer7_res2</title>
<path fill="none" stroke="black" d="M341,-11133.64C341,-11124.69 341,-11115.56 341,-11107.16"/>
<polygon fill="black" stroke="black" points="344.5,-11106.98 341,-11096.98 337.5,-11106.98 344.5,-11106.98"/>
</g>
<!-- gpu0_layer8_ln1 -->
<g id="node132" class="node">
<title>gpu0_layer8_ln1</title>
<polygon fill="lightblue" stroke="black" points="402,-11007.85 280,-11007.85 280,-10955.85 402,-10955.85 402,-11007.85"/>
<text text-anchor="middle" x="341" y="-10995.85" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="341" y="-10984.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-10973.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-10962.85" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer7_res2&#45;&gt;gpu0_layer8_ln1 -->
<g id="edge167" class="edge">
<title>gpu0_layer7_res2&#45;&gt;gpu0_layer8_ln1</title>
<path fill="none" stroke="black" d="M341,-11044.69C341,-11036.39 341,-11027.01 341,-11018.1"/>
<polygon fill="black" stroke="black" points="344.5,-11017.96 341,-11007.96 337.5,-11017.96 344.5,-11017.96"/>
</g>
<!-- gpu0_layer8_qkv -->
<g id="node133" class="node">
<title>gpu0_layer8_qkv</title>
<polygon fill="lightblue" stroke="black" points="402,-10918.85 280,-10918.85 280,-10866.85 402,-10866.85 402,-10918.85"/>
<text text-anchor="middle" x="341" y="-10906.85" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="341" y="-10895.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-10884.85" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-10873.85" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer8_ln1&#45;&gt;gpu0_layer8_qkv -->
<g id="edge168" class="edge">
<title>gpu0_layer8_ln1&#45;&gt;gpu0_layer8_qkv</title>
<path fill="none" stroke="black" d="M341,-10955.69C341,-10947.39 341,-10938.01 341,-10929.1"/>
<polygon fill="black" stroke="black" points="344.5,-10928.96 341,-10918.96 337.5,-10928.96 344.5,-10928.96"/>
</g>
<!-- gpu0_layer8_reshape -->
<g id="node134" class="node">
<title>gpu0_layer8_reshape</title>
<polygon fill="lightblue" stroke="black" points="405,-10829.85 277,-10829.85 277,-10777.85 405,-10777.85 405,-10829.85"/>
<text text-anchor="middle" x="341" y="-10817.85" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="341" y="-10806.85" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-10795.85" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-10784.85" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer8_qkv&#45;&gt;gpu0_layer8_reshape -->
<g id="edge169" class="edge">
<title>gpu0_layer8_qkv&#45;&gt;gpu0_layer8_reshape</title>
<path fill="none" stroke="black" d="M341,-10866.69C341,-10858.39 341,-10849.01 341,-10840.1"/>
<polygon fill="black" stroke="black" points="344.5,-10839.96 341,-10829.96 337.5,-10839.96 344.5,-10839.96"/>
</g>
<!-- gpu0_layer8_attn -->
<g id="node135" class="node">
<title>gpu0_layer8_attn</title>
<polygon fill="lightblue" stroke="black" points="405,-10740.85 277,-10740.85 277,-10688.85 405,-10688.85 405,-10740.85"/>
<text text-anchor="middle" x="341" y="-10728.85" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="341" y="-10717.85" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-10706.85" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-10695.85" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer8_reshape&#45;&gt;gpu0_layer8_attn -->
<g id="edge170" class="edge">
<title>gpu0_layer8_reshape&#45;&gt;gpu0_layer8_attn</title>
<path fill="none" stroke="black" d="M341,-10777.69C341,-10769.39 341,-10760.01 341,-10751.1"/>
<polygon fill="black" stroke="black" points="344.5,-10750.96 341,-10740.96 337.5,-10750.96 344.5,-10750.96"/>
</g>
<!-- gpu0_layer8_attn_reshape -->
<g id="node137" class="node">
<title>gpu0_layer8_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="402,-10651.85 280,-10651.85 280,-10599.85 402,-10599.85 402,-10651.85"/>
<text text-anchor="middle" x="341" y="-10639.85" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="341" y="-10628.85" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-10617.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-10606.85" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer8_attn&#45;&gt;gpu0_layer8_attn_reshape -->
<g id="edge171" class="edge">
<title>gpu0_layer8_attn&#45;&gt;gpu0_layer8_attn_reshape</title>
<path fill="none" stroke="black" d="M341,-10688.69C341,-10680.39 341,-10671.01 341,-10662.1"/>
<polygon fill="black" stroke="black" points="344.5,-10661.96 341,-10651.96 337.5,-10661.96 344.5,-10661.96"/>
</g>
<!-- gpu0_layer8_attn_out -->
<g id="node136" class="node">
<title>gpu0_layer8_attn_out</title>
<polygon fill="lightblue" stroke="black" points="402,-10562.85 280,-10562.85 280,-10510.85 402,-10510.85 402,-10562.85"/>
<text text-anchor="middle" x="341" y="-10550.85" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="341" y="-10539.85" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-10528.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-10517.85" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer8_kv_update -->
<g id="node138" class="node">
<title>gpu0_layer8_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="341" cy="-10437.08" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="341" y="-10451.08" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="341" y="-10440.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-10429.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-10418.08" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer8_attn_out&#45;&gt;gpu0_layer8_kv_update -->
<g id="edge173" class="edge">
<title>gpu0_layer8_attn_out&#45;&gt;gpu0_layer8_kv_update</title>
<path fill="none" stroke="black" d="M341,-10510.67C341,-10502.53 341,-10493.24 341,-10484.08"/>
<polygon fill="black" stroke="black" points="344.5,-10483.86 341,-10473.86 337.5,-10483.86 344.5,-10483.86"/>
</g>
<!-- gpu0_layer8_attn_reshape&#45;&gt;gpu0_layer8_attn_out -->
<g id="edge172" class="edge">
<title>gpu0_layer8_attn_reshape&#45;&gt;gpu0_layer8_attn_out</title>
<path fill="none" stroke="black" d="M341,-10599.69C341,-10591.39 341,-10582.01 341,-10573.1"/>
<polygon fill="black" stroke="black" points="344.5,-10572.96 341,-10562.96 337.5,-10572.96 344.5,-10572.96"/>
</g>
<!-- gpu0_layer8_res1 -->
<g id="node139" class="node">
<title>gpu0_layer8_res1</title>
<polygon fill="lightblue" stroke="black" points="402,-10363.31 280,-10363.31 280,-10311.31 402,-10311.31 402,-10363.31"/>
<text text-anchor="middle" x="341" y="-10351.31" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="341" y="-10340.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-10329.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-10318.31" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer8_kv_update&#45;&gt;gpu0_layer8_res1 -->
<g id="edge174" class="edge">
<title>gpu0_layer8_kv_update&#45;&gt;gpu0_layer8_res1</title>
<path fill="none" stroke="black" d="M341,-10400.23C341,-10391.55 341,-10382.28 341,-10373.63"/>
<polygon fill="black" stroke="black" points="344.5,-10373.46 341,-10363.46 337.5,-10373.46 344.5,-10373.46"/>
</g>
<!-- gpu0_layer8_ln2 -->
<g id="node140" class="node">
<title>gpu0_layer8_ln2</title>
<polygon fill="lightblue" stroke="black" points="402,-10274.31 280,-10274.31 280,-10222.31 402,-10222.31 402,-10274.31"/>
<text text-anchor="middle" x="341" y="-10262.31" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="341" y="-10251.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-10240.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-10229.31" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer8_res1&#45;&gt;gpu0_layer8_ln2 -->
<g id="edge175" class="edge">
<title>gpu0_layer8_res1&#45;&gt;gpu0_layer8_ln2</title>
<path fill="none" stroke="black" d="M341,-10311.15C341,-10302.85 341,-10293.47 341,-10284.56"/>
<polygon fill="black" stroke="black" points="344.5,-10284.42 341,-10274.42 337.5,-10284.42 344.5,-10284.42"/>
</g>
<!-- gpu0_layer8_routing -->
<g id="node141" class="node">
<title>gpu0_layer8_routing</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-10185.31 266.29,-10185.31 214.53,-10059.31 415.71,-10059.31 467.47,-10185.31"/>
<text text-anchor="middle" x="341" y="-10141.81" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="341" y="-10130.81" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-10119.81" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-10108.81" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="341" y="-10097.81" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer8_ln2&#45;&gt;gpu0_layer8_routing -->
<g id="edge176" class="edge">
<title>gpu0_layer8_ln2&#45;&gt;gpu0_layer8_routing</title>
<path fill="none" stroke="black" d="M341,-10222.22C341,-10214.29 341,-10205.09 341,-10195.56"/>
<polygon fill="black" stroke="black" points="344.5,-10195.55 341,-10185.55 337.5,-10195.55 344.5,-10195.55"/>
</g>
<!-- gpu0_layer8_expert0 -->
<g id="node142" class="node">
<title>gpu0_layer8_expert0</title>
<polygon fill="lightblue" stroke="black" points="122,-10013.31 0,-10013.31 0,-9961.31 122,-9961.31 122,-10013.31"/>
<text text-anchor="middle" x="61" y="-10001.31" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="61" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer8_routing&#45;&gt;gpu0_layer8_expert0 -->
<g id="edge163" class="edge">
<title>gpu0_layer8_routing&#45;&gt;gpu0_layer8_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M215.33,-10061.62C183.34,-10046.42 150.34,-10030.75 123.11,-10017.81"/>
<polygon fill="black" stroke="black" points="124.26,-10014.49 113.73,-10013.36 121.26,-10020.81 124.26,-10014.49"/>
<text text-anchor="middle" x="197.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer8_expert1 -->
<g id="node143" class="node">
<title>gpu0_layer8_expert1</title>
<polygon fill="lightblue" stroke="black" points="262,-10013.31 140,-10013.31 140,-9961.31 262,-9961.31 262,-10013.31"/>
<text text-anchor="middle" x="201" y="-10001.31" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="201" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer8_routing&#45;&gt;gpu0_layer8_expert1 -->
<g id="edge164" class="edge">
<title>gpu0_layer8_routing&#45;&gt;gpu0_layer8_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M275.51,-10059.1C261.48,-10045.77 247.21,-10032.22 234.97,-10020.58"/>
<polygon fill="black" stroke="black" points="237.29,-10017.96 227.63,-10013.61 232.46,-10023.03 237.29,-10017.96"/>
<text text-anchor="middle" x="284.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer8_expert2 -->
<g id="node144" class="node">
<title>gpu0_layer8_expert2</title>
<polygon fill="lightblue" stroke="black" points="402,-10013.31 280,-10013.31 280,-9961.31 402,-9961.31 402,-10013.31"/>
<text text-anchor="middle" x="341" y="-10001.31" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="341" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer8_routing&#45;&gt;gpu0_layer8_expert2 -->
<g id="edge165" class="edge">
<title>gpu0_layer8_routing&#45;&gt;gpu0_layer8_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M341,-10059.1C341,-10047.03 341,-10034.77 341,-10023.92"/>
<polygon fill="black" stroke="black" points="344.5,-10023.61 341,-10013.61 337.5,-10023.61 344.5,-10023.61"/>
<text text-anchor="middle" x="370.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer8_expert3 -->
<g id="node145" class="node">
<title>gpu0_layer8_expert3</title>
<polygon fill="lightblue" stroke="black" points="542,-10013.31 420,-10013.31 420,-9961.31 542,-9961.31 542,-10013.31"/>
<text text-anchor="middle" x="481" y="-10001.31" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="481" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer8_routing&#45;&gt;gpu0_layer8_expert3 -->
<g id="edge166" class="edge">
<title>gpu0_layer8_routing&#45;&gt;gpu0_layer8_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M406.49,-10059.1C420.52,-10045.77 434.79,-10032.22 447.03,-10020.58"/>
<polygon fill="black" stroke="black" points="449.54,-10023.03 454.37,-10013.61 444.71,-10017.96 449.54,-10023.03"/>
<text text-anchor="middle" x="465.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer8_expert_agg -->
<g id="node146" class="node">
<title>gpu0_layer8_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-9924.31 266.29,-9924.31 214.53,-9820.31 415.71,-9820.31 467.47,-9924.31"/>
<text text-anchor="middle" x="341" y="-9886.31" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="341" y="-9875.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-9864.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-9853.31" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer8_routing&#45;&gt;gpu0_layer8_expert_agg -->
<g id="edge181" class="edge">
<title>gpu0_layer8_routing&#45;&gt;gpu0_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M430.22,-10094.4C503.96,-10067.24 590.6,-10020.85 551,-9961.31 530.44,-9930.4 496.7,-9910.33 462.22,-9897.3"/>
<polygon fill="black" stroke="black" points="463.08,-9893.89 452.48,-9893.81 460.71,-9900.48 463.08,-9893.89"/>
</g>
<!-- gpu0_layer8_expert0&#45;&gt;gpu0_layer8_expert_agg -->
<g id="edge177" class="edge">
<title>gpu0_layer8_expert0&#45;&gt;gpu0_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M122.1,-9961.65C158.98,-9946.77 206.7,-9927.51 248.16,-9910.78"/>
<polygon fill="black" stroke="black" points="249.5,-9914.02 257.46,-9907.03 246.88,-9907.52 249.5,-9914.02"/>
</g>
<!-- gpu0_layer8_expert1&#45;&gt;gpu0_layer8_expert_agg -->
<g id="edge178" class="edge">
<title>gpu0_layer8_expert1&#45;&gt;gpu0_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M232.07,-9961.23C243.32,-9952.16 256.53,-9941.49 269.8,-9930.78"/>
<polygon fill="black" stroke="black" points="272.02,-9933.49 277.6,-9924.48 267.62,-9928.04 272.02,-9933.49"/>
</g>
<!-- gpu0_layer8_expert2&#45;&gt;gpu0_layer8_expert_agg -->
<g id="edge179" class="edge">
<title>gpu0_layer8_expert2&#45;&gt;gpu0_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M341,-9961.23C341,-9953.31 341,-9944.17 341,-9934.85"/>
<polygon fill="black" stroke="black" points="344.5,-9934.71 341,-9924.71 337.5,-9934.71 344.5,-9934.71"/>
</g>
<!-- gpu0_layer8_expert3&#45;&gt;gpu0_layer8_expert_agg -->
<g id="edge180" class="edge">
<title>gpu0_layer8_expert3&#45;&gt;gpu0_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M449.93,-9961.23C438.68,-9952.16 425.47,-9941.49 412.2,-9930.78"/>
<polygon fill="black" stroke="black" points="414.38,-9928.04 404.4,-9924.48 409.98,-9933.49 414.38,-9928.04"/>
</g>
<!-- gpu0_layer8_res2 -->
<g id="node147" class="node">
<title>gpu0_layer8_res2</title>
<polygon fill="lightblue" stroke="black" points="402,-9783.31 280,-9783.31 280,-9731.31 402,-9731.31 402,-9783.31"/>
<text text-anchor="middle" x="341" y="-9771.31" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="341" y="-9760.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-9749.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-9738.31" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer8_expert_agg&#45;&gt;gpu0_layer8_res2 -->
<g id="edge182" class="edge">
<title>gpu0_layer8_expert_agg&#45;&gt;gpu0_layer8_res2</title>
<path fill="none" stroke="black" d="M341,-9820.1C341,-9811.15 341,-9802.02 341,-9793.62"/>
<polygon fill="black" stroke="black" points="344.5,-9793.44 341,-9783.44 337.5,-9793.44 344.5,-9793.44"/>
</g>
<!-- gpu0_layer9_ln1 -->
<g id="node148" class="node">
<title>gpu0_layer9_ln1</title>
<polygon fill="lightblue" stroke="black" points="402,-9694.31 280,-9694.31 280,-9642.31 402,-9642.31 402,-9694.31"/>
<text text-anchor="middle" x="341" y="-9682.31" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="341" y="-9671.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-9660.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-9649.31" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer8_res2&#45;&gt;gpu0_layer9_ln1 -->
<g id="edge187" class="edge">
<title>gpu0_layer8_res2&#45;&gt;gpu0_layer9_ln1</title>
<path fill="none" stroke="black" d="M341,-9731.15C341,-9722.85 341,-9713.47 341,-9704.56"/>
<polygon fill="black" stroke="black" points="344.5,-9704.42 341,-9694.42 337.5,-9704.42 344.5,-9704.42"/>
</g>
<!-- gpu0_layer9_qkv -->
<g id="node149" class="node">
<title>gpu0_layer9_qkv</title>
<polygon fill="lightblue" stroke="black" points="402,-9605.31 280,-9605.31 280,-9553.31 402,-9553.31 402,-9605.31"/>
<text text-anchor="middle" x="341" y="-9593.31" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="341" y="-9582.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-9571.31" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-9560.31" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer9_ln1&#45;&gt;gpu0_layer9_qkv -->
<g id="edge188" class="edge">
<title>gpu0_layer9_ln1&#45;&gt;gpu0_layer9_qkv</title>
<path fill="none" stroke="black" d="M341,-9642.15C341,-9633.85 341,-9624.47 341,-9615.56"/>
<polygon fill="black" stroke="black" points="344.5,-9615.42 341,-9605.42 337.5,-9615.42 344.5,-9615.42"/>
</g>
<!-- gpu0_layer9_reshape -->
<g id="node150" class="node">
<title>gpu0_layer9_reshape</title>
<polygon fill="lightblue" stroke="black" points="405,-9516.31 277,-9516.31 277,-9464.31 405,-9464.31 405,-9516.31"/>
<text text-anchor="middle" x="341" y="-9504.31" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="341" y="-9493.31" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-9482.31" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-9471.31" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer9_qkv&#45;&gt;gpu0_layer9_reshape -->
<g id="edge189" class="edge">
<title>gpu0_layer9_qkv&#45;&gt;gpu0_layer9_reshape</title>
<path fill="none" stroke="black" d="M341,-9553.15C341,-9544.85 341,-9535.47 341,-9526.56"/>
<polygon fill="black" stroke="black" points="344.5,-9526.42 341,-9516.42 337.5,-9526.42 344.5,-9526.42"/>
</g>
<!-- gpu0_layer9_attn -->
<g id="node151" class="node">
<title>gpu0_layer9_attn</title>
<polygon fill="lightblue" stroke="black" points="405,-9427.31 277,-9427.31 277,-9375.31 405,-9375.31 405,-9427.31"/>
<text text-anchor="middle" x="341" y="-9415.31" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="341" y="-9404.31" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-9393.31" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-9382.31" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer9_reshape&#45;&gt;gpu0_layer9_attn -->
<g id="edge190" class="edge">
<title>gpu0_layer9_reshape&#45;&gt;gpu0_layer9_attn</title>
<path fill="none" stroke="black" d="M341,-9464.15C341,-9455.85 341,-9446.47 341,-9437.56"/>
<polygon fill="black" stroke="black" points="344.5,-9437.42 341,-9427.42 337.5,-9437.42 344.5,-9437.42"/>
</g>
<!-- gpu0_layer9_attn_reshape -->
<g id="node153" class="node">
<title>gpu0_layer9_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="402,-9338.31 280,-9338.31 280,-9286.31 402,-9286.31 402,-9338.31"/>
<text text-anchor="middle" x="341" y="-9326.31" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="341" y="-9315.31" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-9304.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-9293.31" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer9_attn&#45;&gt;gpu0_layer9_attn_reshape -->
<g id="edge191" class="edge">
<title>gpu0_layer9_attn&#45;&gt;gpu0_layer9_attn_reshape</title>
<path fill="none" stroke="black" d="M341,-9375.15C341,-9366.85 341,-9357.47 341,-9348.56"/>
<polygon fill="black" stroke="black" points="344.5,-9348.42 341,-9338.42 337.5,-9348.42 344.5,-9348.42"/>
</g>
<!-- gpu0_layer9_attn_out -->
<g id="node152" class="node">
<title>gpu0_layer9_attn_out</title>
<polygon fill="lightblue" stroke="black" points="402,-9249.31 280,-9249.31 280,-9197.31 402,-9197.31 402,-9249.31"/>
<text text-anchor="middle" x="341" y="-9237.31" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="341" y="-9226.31" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-9215.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-9204.31" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer9_kv_update -->
<g id="node154" class="node">
<title>gpu0_layer9_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="341" cy="-9123.54" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="341" y="-9137.54" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="341" y="-9126.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-9115.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-9104.54" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer9_attn_out&#45;&gt;gpu0_layer9_kv_update -->
<g id="edge193" class="edge">
<title>gpu0_layer9_attn_out&#45;&gt;gpu0_layer9_kv_update</title>
<path fill="none" stroke="black" d="M341,-9197.13C341,-9189 341,-9179.7 341,-9170.54"/>
<polygon fill="black" stroke="black" points="344.5,-9170.32 341,-9160.32 337.5,-9170.32 344.5,-9170.32"/>
</g>
<!-- gpu0_layer9_attn_reshape&#45;&gt;gpu0_layer9_attn_out -->
<g id="edge192" class="edge">
<title>gpu0_layer9_attn_reshape&#45;&gt;gpu0_layer9_attn_out</title>
<path fill="none" stroke="black" d="M341,-9286.15C341,-9277.85 341,-9268.47 341,-9259.56"/>
<polygon fill="black" stroke="black" points="344.5,-9259.42 341,-9249.42 337.5,-9259.42 344.5,-9259.42"/>
</g>
<!-- gpu0_layer9_res1 -->
<g id="node155" class="node">
<title>gpu0_layer9_res1</title>
<polygon fill="lightblue" stroke="black" points="402,-9049.77 280,-9049.77 280,-8997.77 402,-8997.77 402,-9049.77"/>
<text text-anchor="middle" x="341" y="-9037.77" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="341" y="-9026.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-9015.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-9004.77" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer9_kv_update&#45;&gt;gpu0_layer9_res1 -->
<g id="edge194" class="edge">
<title>gpu0_layer9_kv_update&#45;&gt;gpu0_layer9_res1</title>
<path fill="none" stroke="black" d="M341,-9086.69C341,-9078.01 341,-9068.74 341,-9060.09"/>
<polygon fill="black" stroke="black" points="344.5,-9059.92 341,-9049.92 337.5,-9059.92 344.5,-9059.92"/>
</g>
<!-- gpu0_layer9_ln2 -->
<g id="node156" class="node">
<title>gpu0_layer9_ln2</title>
<polygon fill="lightblue" stroke="black" points="402,-8960.77 280,-8960.77 280,-8908.77 402,-8908.77 402,-8960.77"/>
<text text-anchor="middle" x="341" y="-8948.77" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="341" y="-8937.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-8926.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-8915.77" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer9_res1&#45;&gt;gpu0_layer9_ln2 -->
<g id="edge195" class="edge">
<title>gpu0_layer9_res1&#45;&gt;gpu0_layer9_ln2</title>
<path fill="none" stroke="black" d="M341,-8997.61C341,-8989.31 341,-8979.93 341,-8971.02"/>
<polygon fill="black" stroke="black" points="344.5,-8970.88 341,-8960.88 337.5,-8970.88 344.5,-8970.88"/>
</g>
<!-- gpu0_layer9_routing -->
<g id="node157" class="node">
<title>gpu0_layer9_routing</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-8871.77 266.29,-8871.77 214.53,-8745.77 415.71,-8745.77 467.47,-8871.77"/>
<text text-anchor="middle" x="341" y="-8828.27" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="341" y="-8817.27" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-8806.27" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-8795.27" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="341" y="-8784.27" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer9_ln2&#45;&gt;gpu0_layer9_routing -->
<g id="edge196" class="edge">
<title>gpu0_layer9_ln2&#45;&gt;gpu0_layer9_routing</title>
<path fill="none" stroke="black" d="M341,-8908.68C341,-8900.75 341,-8891.55 341,-8882.02"/>
<polygon fill="black" stroke="black" points="344.5,-8882.01 341,-8872.01 337.5,-8882.01 344.5,-8882.01"/>
</g>
<!-- gpu0_layer9_expert0 -->
<g id="node158" class="node">
<title>gpu0_layer9_expert0</title>
<polygon fill="lightblue" stroke="black" points="122,-8699.77 0,-8699.77 0,-8647.77 122,-8647.77 122,-8699.77"/>
<text text-anchor="middle" x="61" y="-8687.77" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="61" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer9_routing&#45;&gt;gpu0_layer9_expert0 -->
<g id="edge183" class="edge">
<title>gpu0_layer9_routing&#45;&gt;gpu0_layer9_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M215.33,-8748.08C183.34,-8732.89 150.34,-8717.21 123.11,-8704.27"/>
<polygon fill="black" stroke="black" points="124.26,-8700.95 113.73,-8699.82 121.26,-8707.27 124.26,-8700.95"/>
<text text-anchor="middle" x="197.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer9_expert1 -->
<g id="node159" class="node">
<title>gpu0_layer9_expert1</title>
<polygon fill="lightblue" stroke="black" points="262,-8699.77 140,-8699.77 140,-8647.77 262,-8647.77 262,-8699.77"/>
<text text-anchor="middle" x="201" y="-8687.77" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="201" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer9_routing&#45;&gt;gpu0_layer9_expert1 -->
<g id="edge184" class="edge">
<title>gpu0_layer9_routing&#45;&gt;gpu0_layer9_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M275.51,-8745.56C261.48,-8732.23 247.21,-8718.68 234.97,-8707.04"/>
<polygon fill="black" stroke="black" points="237.29,-8704.42 227.63,-8700.07 232.46,-8709.49 237.29,-8704.42"/>
<text text-anchor="middle" x="284.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer9_expert2 -->
<g id="node160" class="node">
<title>gpu0_layer9_expert2</title>
<polygon fill="lightblue" stroke="black" points="402,-8699.77 280,-8699.77 280,-8647.77 402,-8647.77 402,-8699.77"/>
<text text-anchor="middle" x="341" y="-8687.77" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="341" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer9_routing&#45;&gt;gpu0_layer9_expert2 -->
<g id="edge185" class="edge">
<title>gpu0_layer9_routing&#45;&gt;gpu0_layer9_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M341,-8745.56C341,-8733.49 341,-8721.23 341,-8710.39"/>
<polygon fill="black" stroke="black" points="344.5,-8710.07 341,-8700.07 337.5,-8710.07 344.5,-8710.07"/>
<text text-anchor="middle" x="370.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer9_expert3 -->
<g id="node161" class="node">
<title>gpu0_layer9_expert3</title>
<polygon fill="lightblue" stroke="black" points="542,-8699.77 420,-8699.77 420,-8647.77 542,-8647.77 542,-8699.77"/>
<text text-anchor="middle" x="481" y="-8687.77" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="481" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer9_routing&#45;&gt;gpu0_layer9_expert3 -->
<g id="edge186" class="edge">
<title>gpu0_layer9_routing&#45;&gt;gpu0_layer9_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M406.49,-8745.56C420.52,-8732.23 434.79,-8718.68 447.03,-8707.04"/>
<polygon fill="black" stroke="black" points="449.54,-8709.49 454.37,-8700.07 444.71,-8704.42 449.54,-8709.49"/>
<text text-anchor="middle" x="465.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer9_expert_agg -->
<g id="node162" class="node">
<title>gpu0_layer9_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-8610.77 266.29,-8610.77 214.53,-8506.77 415.71,-8506.77 467.47,-8610.77"/>
<text text-anchor="middle" x="341" y="-8572.77" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="341" y="-8561.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-8550.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-8539.77" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer9_routing&#45;&gt;gpu0_layer9_expert_agg -->
<g id="edge201" class="edge">
<title>gpu0_layer9_routing&#45;&gt;gpu0_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M430.22,-8780.86C503.96,-8753.7 590.6,-8707.31 551,-8647.77 530.44,-8616.86 496.7,-8596.79 462.22,-8583.76"/>
<polygon fill="black" stroke="black" points="463.08,-8580.35 452.48,-8580.27 460.71,-8586.94 463.08,-8580.35"/>
</g>
<!-- gpu0_layer9_expert0&#45;&gt;gpu0_layer9_expert_agg -->
<g id="edge197" class="edge">
<title>gpu0_layer9_expert0&#45;&gt;gpu0_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M122.1,-8648.12C158.98,-8633.23 206.7,-8613.97 248.16,-8597.24"/>
<polygon fill="black" stroke="black" points="249.5,-8600.48 257.46,-8593.49 246.88,-8593.99 249.5,-8600.48"/>
</g>
<!-- gpu0_layer9_expert1&#45;&gt;gpu0_layer9_expert_agg -->
<g id="edge198" class="edge">
<title>gpu0_layer9_expert1&#45;&gt;gpu0_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M232.07,-8647.7C243.32,-8638.62 256.53,-8627.95 269.8,-8617.24"/>
<polygon fill="black" stroke="black" points="272.02,-8619.95 277.6,-8610.95 267.62,-8614.5 272.02,-8619.95"/>
</g>
<!-- gpu0_layer9_expert2&#45;&gt;gpu0_layer9_expert_agg -->
<g id="edge199" class="edge">
<title>gpu0_layer9_expert2&#45;&gt;gpu0_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M341,-8647.7C341,-8639.77 341,-8630.63 341,-8621.31"/>
<polygon fill="black" stroke="black" points="344.5,-8621.17 341,-8611.17 337.5,-8621.17 344.5,-8621.17"/>
</g>
<!-- gpu0_layer9_expert3&#45;&gt;gpu0_layer9_expert_agg -->
<g id="edge200" class="edge">
<title>gpu0_layer9_expert3&#45;&gt;gpu0_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M449.93,-8647.7C438.68,-8638.62 425.47,-8627.95 412.2,-8617.24"/>
<polygon fill="black" stroke="black" points="414.38,-8614.5 404.4,-8610.95 409.98,-8619.95 414.38,-8614.5"/>
</g>
<!-- gpu0_layer9_res2 -->
<g id="node163" class="node">
<title>gpu0_layer9_res2</title>
<polygon fill="lightblue" stroke="black" points="402,-8469.77 280,-8469.77 280,-8417.77 402,-8417.77 402,-8469.77"/>
<text text-anchor="middle" x="341" y="-8457.77" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="341" y="-8446.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-8435.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-8424.77" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer9_expert_agg&#45;&gt;gpu0_layer9_res2 -->
<g id="edge202" class="edge">
<title>gpu0_layer9_expert_agg&#45;&gt;gpu0_layer9_res2</title>
<path fill="none" stroke="black" d="M341,-8506.56C341,-8497.61 341,-8488.48 341,-8480.08"/>
<polygon fill="black" stroke="black" points="344.5,-8479.9 341,-8469.9 337.5,-8479.9 344.5,-8479.9"/>
</g>
<!-- gpu0_layer10_ln1 -->
<g id="node164" class="node">
<title>gpu0_layer10_ln1</title>
<polygon fill="lightblue" stroke="black" points="402,-8380.77 280,-8380.77 280,-8328.77 402,-8328.77 402,-8380.77"/>
<text text-anchor="middle" x="341" y="-8368.77" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="341" y="-8357.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-8346.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-8335.77" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer9_res2&#45;&gt;gpu0_layer10_ln1 -->
<g id="edge207" class="edge">
<title>gpu0_layer9_res2&#45;&gt;gpu0_layer10_ln1</title>
<path fill="none" stroke="black" d="M341,-8417.61C341,-8409.31 341,-8399.93 341,-8391.02"/>
<polygon fill="black" stroke="black" points="344.5,-8390.88 341,-8380.88 337.5,-8390.88 344.5,-8390.88"/>
</g>
<!-- gpu0_layer10_qkv -->
<g id="node165" class="node">
<title>gpu0_layer10_qkv</title>
<polygon fill="lightblue" stroke="black" points="402,-8291.77 280,-8291.77 280,-8239.77 402,-8239.77 402,-8291.77"/>
<text text-anchor="middle" x="341" y="-8279.77" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="341" y="-8268.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-8257.77" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-8246.77" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer10_ln1&#45;&gt;gpu0_layer10_qkv -->
<g id="edge208" class="edge">
<title>gpu0_layer10_ln1&#45;&gt;gpu0_layer10_qkv</title>
<path fill="none" stroke="black" d="M341,-8328.61C341,-8320.31 341,-8310.93 341,-8302.02"/>
<polygon fill="black" stroke="black" points="344.5,-8301.88 341,-8291.88 337.5,-8301.88 344.5,-8301.88"/>
</g>
<!-- gpu0_layer10_reshape -->
<g id="node166" class="node">
<title>gpu0_layer10_reshape</title>
<polygon fill="lightblue" stroke="black" points="405,-8202.77 277,-8202.77 277,-8150.77 405,-8150.77 405,-8202.77"/>
<text text-anchor="middle" x="341" y="-8190.77" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="341" y="-8179.77" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-8168.77" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-8157.77" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer10_qkv&#45;&gt;gpu0_layer10_reshape -->
<g id="edge209" class="edge">
<title>gpu0_layer10_qkv&#45;&gt;gpu0_layer10_reshape</title>
<path fill="none" stroke="black" d="M341,-8239.61C341,-8231.31 341,-8221.93 341,-8213.02"/>
<polygon fill="black" stroke="black" points="344.5,-8212.88 341,-8202.88 337.5,-8212.88 344.5,-8212.88"/>
</g>
<!-- gpu0_layer10_attn -->
<g id="node167" class="node">
<title>gpu0_layer10_attn</title>
<polygon fill="lightblue" stroke="black" points="405,-8113.77 277,-8113.77 277,-8061.77 405,-8061.77 405,-8113.77"/>
<text text-anchor="middle" x="341" y="-8101.77" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="341" y="-8090.77" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-8079.77" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-8068.77" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer10_reshape&#45;&gt;gpu0_layer10_attn -->
<g id="edge210" class="edge">
<title>gpu0_layer10_reshape&#45;&gt;gpu0_layer10_attn</title>
<path fill="none" stroke="black" d="M341,-8150.61C341,-8142.31 341,-8132.93 341,-8124.02"/>
<polygon fill="black" stroke="black" points="344.5,-8123.88 341,-8113.88 337.5,-8123.88 344.5,-8123.88"/>
</g>
<!-- gpu0_layer10_attn_reshape -->
<g id="node169" class="node">
<title>gpu0_layer10_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="402,-8024.77 280,-8024.77 280,-7972.77 402,-7972.77 402,-8024.77"/>
<text text-anchor="middle" x="341" y="-8012.77" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="341" y="-8001.77" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-7990.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-7979.77" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer10_attn&#45;&gt;gpu0_layer10_attn_reshape -->
<g id="edge211" class="edge">
<title>gpu0_layer10_attn&#45;&gt;gpu0_layer10_attn_reshape</title>
<path fill="none" stroke="black" d="M341,-8061.61C341,-8053.31 341,-8043.93 341,-8035.02"/>
<polygon fill="black" stroke="black" points="344.5,-8034.88 341,-8024.88 337.5,-8034.88 344.5,-8034.88"/>
</g>
<!-- gpu0_layer10_attn_out -->
<g id="node168" class="node">
<title>gpu0_layer10_attn_out</title>
<polygon fill="lightblue" stroke="black" points="402,-7935.77 280,-7935.77 280,-7883.77 402,-7883.77 402,-7935.77"/>
<text text-anchor="middle" x="341" y="-7923.77" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="341" y="-7912.77" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-7901.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-7890.77" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer10_kv_update -->
<g id="node170" class="node">
<title>gpu0_layer10_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="341" cy="-7810" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="341" y="-7824" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="341" y="-7813" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-7802" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-7791" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer10_attn_out&#45;&gt;gpu0_layer10_kv_update -->
<g id="edge213" class="edge">
<title>gpu0_layer10_attn_out&#45;&gt;gpu0_layer10_kv_update</title>
<path fill="none" stroke="black" d="M341,-7883.6C341,-7875.46 341,-7866.16 341,-7857"/>
<polygon fill="black" stroke="black" points="344.5,-7856.78 341,-7846.78 337.5,-7856.78 344.5,-7856.78"/>
</g>
<!-- gpu0_layer10_attn_reshape&#45;&gt;gpu0_layer10_attn_out -->
<g id="edge212" class="edge">
<title>gpu0_layer10_attn_reshape&#45;&gt;gpu0_layer10_attn_out</title>
<path fill="none" stroke="black" d="M341,-7972.61C341,-7964.31 341,-7954.93 341,-7946.02"/>
<polygon fill="black" stroke="black" points="344.5,-7945.88 341,-7935.88 337.5,-7945.88 344.5,-7945.88"/>
</g>
<!-- gpu0_layer10_res1 -->
<g id="node171" class="node">
<title>gpu0_layer10_res1</title>
<polygon fill="lightblue" stroke="black" points="402,-7736.23 280,-7736.23 280,-7684.23 402,-7684.23 402,-7736.23"/>
<text text-anchor="middle" x="341" y="-7724.23" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="341" y="-7713.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-7702.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-7691.23" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer10_kv_update&#45;&gt;gpu0_layer10_res1 -->
<g id="edge214" class="edge">
<title>gpu0_layer10_kv_update&#45;&gt;gpu0_layer10_res1</title>
<path fill="none" stroke="black" d="M341,-7773.15C341,-7764.47 341,-7755.2 341,-7746.55"/>
<polygon fill="black" stroke="black" points="344.5,-7746.38 341,-7736.38 337.5,-7746.38 344.5,-7746.38"/>
</g>
<!-- gpu0_layer10_ln2 -->
<g id="node172" class="node">
<title>gpu0_layer10_ln2</title>
<polygon fill="lightblue" stroke="black" points="402,-7647.23 280,-7647.23 280,-7595.23 402,-7595.23 402,-7647.23"/>
<text text-anchor="middle" x="341" y="-7635.23" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="341" y="-7624.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-7613.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-7602.23" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer10_res1&#45;&gt;gpu0_layer10_ln2 -->
<g id="edge215" class="edge">
<title>gpu0_layer10_res1&#45;&gt;gpu0_layer10_ln2</title>
<path fill="none" stroke="black" d="M341,-7684.07C341,-7675.77 341,-7666.39 341,-7657.48"/>
<polygon fill="black" stroke="black" points="344.5,-7657.34 341,-7647.34 337.5,-7657.34 344.5,-7657.34"/>
</g>
<!-- gpu0_layer10_routing -->
<g id="node173" class="node">
<title>gpu0_layer10_routing</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-7558.23 266.29,-7558.23 214.53,-7432.23 415.71,-7432.23 467.47,-7558.23"/>
<text text-anchor="middle" x="341" y="-7514.73" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="341" y="-7503.73" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-7492.73" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-7481.73" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="341" y="-7470.73" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer10_ln2&#45;&gt;gpu0_layer10_routing -->
<g id="edge216" class="edge">
<title>gpu0_layer10_ln2&#45;&gt;gpu0_layer10_routing</title>
<path fill="none" stroke="black" d="M341,-7595.14C341,-7587.21 341,-7578.01 341,-7568.48"/>
<polygon fill="black" stroke="black" points="344.5,-7568.47 341,-7558.47 337.5,-7568.47 344.5,-7568.47"/>
</g>
<!-- gpu0_layer10_expert0 -->
<g id="node174" class="node">
<title>gpu0_layer10_expert0</title>
<polygon fill="lightblue" stroke="black" points="122,-7386.23 0,-7386.23 0,-7334.23 122,-7334.23 122,-7386.23"/>
<text text-anchor="middle" x="61" y="-7374.23" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="61" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer10_routing&#45;&gt;gpu0_layer10_expert0 -->
<g id="edge203" class="edge">
<title>gpu0_layer10_routing&#45;&gt;gpu0_layer10_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M215.33,-7434.54C183.34,-7419.35 150.34,-7403.67 123.11,-7390.74"/>
<polygon fill="black" stroke="black" points="124.26,-7387.41 113.73,-7386.28 121.26,-7393.73 124.26,-7387.41"/>
<text text-anchor="middle" x="197.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer10_expert1 -->
<g id="node175" class="node">
<title>gpu0_layer10_expert1</title>
<polygon fill="lightblue" stroke="black" points="262,-7386.23 140,-7386.23 140,-7334.23 262,-7334.23 262,-7386.23"/>
<text text-anchor="middle" x="201" y="-7374.23" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="201" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer10_routing&#45;&gt;gpu0_layer10_expert1 -->
<g id="edge204" class="edge">
<title>gpu0_layer10_routing&#45;&gt;gpu0_layer10_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M275.51,-7432.02C261.48,-7418.69 247.21,-7405.14 234.97,-7393.5"/>
<polygon fill="black" stroke="black" points="237.29,-7390.88 227.63,-7386.53 232.46,-7395.95 237.29,-7390.88"/>
<text text-anchor="middle" x="284.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer10_expert2 -->
<g id="node176" class="node">
<title>gpu0_layer10_expert2</title>
<polygon fill="lightblue" stroke="black" points="402,-7386.23 280,-7386.23 280,-7334.23 402,-7334.23 402,-7386.23"/>
<text text-anchor="middle" x="341" y="-7374.23" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="341" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer10_routing&#45;&gt;gpu0_layer10_expert2 -->
<g id="edge205" class="edge">
<title>gpu0_layer10_routing&#45;&gt;gpu0_layer10_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M341,-7432.02C341,-7419.95 341,-7407.69 341,-7396.85"/>
<polygon fill="black" stroke="black" points="344.5,-7396.53 341,-7386.53 337.5,-7396.53 344.5,-7396.53"/>
<text text-anchor="middle" x="370.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer10_expert3 -->
<g id="node177" class="node">
<title>gpu0_layer10_expert3</title>
<polygon fill="lightblue" stroke="black" points="542,-7386.23 420,-7386.23 420,-7334.23 542,-7334.23 542,-7386.23"/>
<text text-anchor="middle" x="481" y="-7374.23" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="481" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer10_routing&#45;&gt;gpu0_layer10_expert3 -->
<g id="edge206" class="edge">
<title>gpu0_layer10_routing&#45;&gt;gpu0_layer10_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M406.49,-7432.02C420.52,-7418.69 434.79,-7405.14 447.03,-7393.5"/>
<polygon fill="black" stroke="black" points="449.54,-7395.95 454.37,-7386.53 444.71,-7390.88 449.54,-7395.95"/>
<text text-anchor="middle" x="465.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer10_expert_agg -->
<g id="node178" class="node">
<title>gpu0_layer10_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-7297.23 266.29,-7297.23 214.53,-7193.23 415.71,-7193.23 467.47,-7297.23"/>
<text text-anchor="middle" x="341" y="-7259.23" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="341" y="-7248.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-7237.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-7226.23" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer10_routing&#45;&gt;gpu0_layer10_expert_agg -->
<g id="edge221" class="edge">
<title>gpu0_layer10_routing&#45;&gt;gpu0_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M430.22,-7467.32C503.96,-7440.16 590.6,-7393.77 551,-7334.23 530.44,-7303.32 496.7,-7283.25 462.22,-7270.22"/>
<polygon fill="black" stroke="black" points="463.08,-7266.81 452.48,-7266.73 460.71,-7273.4 463.08,-7266.81"/>
</g>
<!-- gpu0_layer10_expert0&#45;&gt;gpu0_layer10_expert_agg -->
<g id="edge217" class="edge">
<title>gpu0_layer10_expert0&#45;&gt;gpu0_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M122.1,-7334.58C158.98,-7319.69 206.7,-7300.44 248.16,-7283.7"/>
<polygon fill="black" stroke="black" points="249.5,-7286.94 257.46,-7279.95 246.88,-7280.45 249.5,-7286.94"/>
</g>
<!-- gpu0_layer10_expert1&#45;&gt;gpu0_layer10_expert_agg -->
<g id="edge218" class="edge">
<title>gpu0_layer10_expert1&#45;&gt;gpu0_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M232.07,-7334.16C243.32,-7325.08 256.53,-7314.42 269.8,-7303.71"/>
<polygon fill="black" stroke="black" points="272.02,-7306.41 277.6,-7297.41 267.62,-7300.96 272.02,-7306.41"/>
</g>
<!-- gpu0_layer10_expert2&#45;&gt;gpu0_layer10_expert_agg -->
<g id="edge219" class="edge">
<title>gpu0_layer10_expert2&#45;&gt;gpu0_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M341,-7334.16C341,-7326.23 341,-7317.09 341,-7307.77"/>
<polygon fill="black" stroke="black" points="344.5,-7307.64 341,-7297.64 337.5,-7307.64 344.5,-7307.64"/>
</g>
<!-- gpu0_layer10_expert3&#45;&gt;gpu0_layer10_expert_agg -->
<g id="edge220" class="edge">
<title>gpu0_layer10_expert3&#45;&gt;gpu0_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M449.93,-7334.16C438.68,-7325.08 425.47,-7314.42 412.2,-7303.71"/>
<polygon fill="black" stroke="black" points="414.38,-7300.96 404.4,-7297.41 409.98,-7306.41 414.38,-7300.96"/>
</g>
<!-- gpu0_layer10_res2 -->
<g id="node179" class="node">
<title>gpu0_layer10_res2</title>
<polygon fill="lightblue" stroke="black" points="402,-7156.23 280,-7156.23 280,-7104.23 402,-7104.23 402,-7156.23"/>
<text text-anchor="middle" x="341" y="-7144.23" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="341" y="-7133.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-7122.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-7111.23" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer10_expert_agg&#45;&gt;gpu0_layer10_res2 -->
<g id="edge222" class="edge">
<title>gpu0_layer10_expert_agg&#45;&gt;gpu0_layer10_res2</title>
<path fill="none" stroke="black" d="M341,-7193.02C341,-7184.07 341,-7174.94 341,-7166.55"/>
<polygon fill="black" stroke="black" points="344.5,-7166.37 341,-7156.37 337.5,-7166.37 344.5,-7166.37"/>
</g>
<!-- gpu0_layer11_ln1 -->
<g id="node180" class="node">
<title>gpu0_layer11_ln1</title>
<polygon fill="lightblue" stroke="black" points="402,-7067.23 280,-7067.23 280,-7015.23 402,-7015.23 402,-7067.23"/>
<text text-anchor="middle" x="341" y="-7055.23" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="341" y="-7044.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-7033.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-7022.23" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer10_res2&#45;&gt;gpu0_layer11_ln1 -->
<g id="edge227" class="edge">
<title>gpu0_layer10_res2&#45;&gt;gpu0_layer11_ln1</title>
<path fill="none" stroke="black" d="M341,-7104.07C341,-7095.77 341,-7086.39 341,-7077.48"/>
<polygon fill="black" stroke="black" points="344.5,-7077.34 341,-7067.34 337.5,-7077.34 344.5,-7077.34"/>
</g>
<!-- gpu0_layer11_qkv -->
<g id="node181" class="node">
<title>gpu0_layer11_qkv</title>
<polygon fill="lightblue" stroke="black" points="402,-6978.23 280,-6978.23 280,-6926.23 402,-6926.23 402,-6978.23"/>
<text text-anchor="middle" x="341" y="-6966.23" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="341" y="-6955.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-6944.23" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-6933.23" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer11_ln1&#45;&gt;gpu0_layer11_qkv -->
<g id="edge228" class="edge">
<title>gpu0_layer11_ln1&#45;&gt;gpu0_layer11_qkv</title>
<path fill="none" stroke="black" d="M341,-7015.07C341,-7006.77 341,-6997.39 341,-6988.48"/>
<polygon fill="black" stroke="black" points="344.5,-6988.34 341,-6978.34 337.5,-6988.34 344.5,-6988.34"/>
</g>
<!-- gpu0_layer11_reshape -->
<g id="node182" class="node">
<title>gpu0_layer11_reshape</title>
<polygon fill="lightblue" stroke="black" points="405,-6889.23 277,-6889.23 277,-6837.23 405,-6837.23 405,-6889.23"/>
<text text-anchor="middle" x="341" y="-6877.23" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="341" y="-6866.23" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-6855.23" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-6844.23" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer11_qkv&#45;&gt;gpu0_layer11_reshape -->
<g id="edge229" class="edge">
<title>gpu0_layer11_qkv&#45;&gt;gpu0_layer11_reshape</title>
<path fill="none" stroke="black" d="M341,-6926.07C341,-6917.77 341,-6908.39 341,-6899.48"/>
<polygon fill="black" stroke="black" points="344.5,-6899.34 341,-6889.34 337.5,-6899.34 344.5,-6899.34"/>
</g>
<!-- gpu0_layer11_attn -->
<g id="node183" class="node">
<title>gpu0_layer11_attn</title>
<polygon fill="lightblue" stroke="black" points="405,-6800.23 277,-6800.23 277,-6748.23 405,-6748.23 405,-6800.23"/>
<text text-anchor="middle" x="341" y="-6788.23" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="341" y="-6777.23" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-6766.23" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-6755.23" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer11_reshape&#45;&gt;gpu0_layer11_attn -->
<g id="edge230" class="edge">
<title>gpu0_layer11_reshape&#45;&gt;gpu0_layer11_attn</title>
<path fill="none" stroke="black" d="M341,-6837.07C341,-6828.77 341,-6819.39 341,-6810.48"/>
<polygon fill="black" stroke="black" points="344.5,-6810.34 341,-6800.34 337.5,-6810.34 344.5,-6810.34"/>
</g>
<!-- gpu0_layer11_attn_reshape -->
<g id="node185" class="node">
<title>gpu0_layer11_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="402,-6711.23 280,-6711.23 280,-6659.23 402,-6659.23 402,-6711.23"/>
<text text-anchor="middle" x="341" y="-6699.23" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="341" y="-6688.23" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-6677.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-6666.23" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer11_attn&#45;&gt;gpu0_layer11_attn_reshape -->
<g id="edge231" class="edge">
<title>gpu0_layer11_attn&#45;&gt;gpu0_layer11_attn_reshape</title>
<path fill="none" stroke="black" d="M341,-6748.07C341,-6739.77 341,-6730.39 341,-6721.48"/>
<polygon fill="black" stroke="black" points="344.5,-6721.34 341,-6711.34 337.5,-6721.34 344.5,-6721.34"/>
</g>
<!-- gpu0_layer11_attn_out -->
<g id="node184" class="node">
<title>gpu0_layer11_attn_out</title>
<polygon fill="lightblue" stroke="black" points="402,-6622.23 280,-6622.23 280,-6570.23 402,-6570.23 402,-6622.23"/>
<text text-anchor="middle" x="341" y="-6610.23" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="341" y="-6599.23" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-6588.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-6577.23" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer11_kv_update -->
<g id="node186" class="node">
<title>gpu0_layer11_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="341" cy="-6496.47" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="341" y="-6510.47" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="341" y="-6499.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-6488.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-6477.47" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer11_attn_out&#45;&gt;gpu0_layer11_kv_update -->
<g id="edge233" class="edge">
<title>gpu0_layer11_attn_out&#45;&gt;gpu0_layer11_kv_update</title>
<path fill="none" stroke="black" d="M341,-6570.06C341,-6561.92 341,-6552.62 341,-6543.46"/>
<polygon fill="black" stroke="black" points="344.5,-6543.24 341,-6533.24 337.5,-6543.24 344.5,-6543.24"/>
</g>
<!-- gpu0_layer11_attn_reshape&#45;&gt;gpu0_layer11_attn_out -->
<g id="edge232" class="edge">
<title>gpu0_layer11_attn_reshape&#45;&gt;gpu0_layer11_attn_out</title>
<path fill="none" stroke="black" d="M341,-6659.07C341,-6650.77 341,-6641.39 341,-6632.48"/>
<polygon fill="black" stroke="black" points="344.5,-6632.34 341,-6622.34 337.5,-6632.34 344.5,-6632.34"/>
</g>
<!-- gpu0_layer11_res1 -->
<g id="node187" class="node">
<title>gpu0_layer11_res1</title>
<polygon fill="lightblue" stroke="black" points="402,-6422.7 280,-6422.7 280,-6370.7 402,-6370.7 402,-6422.7"/>
<text text-anchor="middle" x="341" y="-6410.7" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="341" y="-6399.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-6388.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-6377.7" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer11_kv_update&#45;&gt;gpu0_layer11_res1 -->
<g id="edge234" class="edge">
<title>gpu0_layer11_kv_update&#45;&gt;gpu0_layer11_res1</title>
<path fill="none" stroke="black" d="M341,-6459.61C341,-6450.94 341,-6441.67 341,-6433.01"/>
<polygon fill="black" stroke="black" points="344.5,-6432.84 341,-6422.84 337.5,-6432.84 344.5,-6432.84"/>
</g>
<!-- gpu0_layer11_ln2 -->
<g id="node188" class="node">
<title>gpu0_layer11_ln2</title>
<polygon fill="lightblue" stroke="black" points="402,-6333.7 280,-6333.7 280,-6281.7 402,-6281.7 402,-6333.7"/>
<text text-anchor="middle" x="341" y="-6321.7" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="341" y="-6310.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-6299.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-6288.7" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer11_res1&#45;&gt;gpu0_layer11_ln2 -->
<g id="edge235" class="edge">
<title>gpu0_layer11_res1&#45;&gt;gpu0_layer11_ln2</title>
<path fill="none" stroke="black" d="M341,-6370.53C341,-6362.24 341,-6352.85 341,-6343.94"/>
<polygon fill="black" stroke="black" points="344.5,-6343.8 341,-6333.8 337.5,-6343.8 344.5,-6343.8"/>
</g>
<!-- gpu0_layer11_routing -->
<g id="node189" class="node">
<title>gpu0_layer11_routing</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-6244.7 266.29,-6244.7 214.53,-6118.7 415.71,-6118.7 467.47,-6244.7"/>
<text text-anchor="middle" x="341" y="-6201.2" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="341" y="-6190.2" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-6179.2" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-6168.2" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="341" y="-6157.2" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer11_ln2&#45;&gt;gpu0_layer11_routing -->
<g id="edge236" class="edge">
<title>gpu0_layer11_ln2&#45;&gt;gpu0_layer11_routing</title>
<path fill="none" stroke="black" d="M341,-6281.6C341,-6273.67 341,-6264.47 341,-6254.94"/>
<polygon fill="black" stroke="black" points="344.5,-6254.93 341,-6244.93 337.5,-6254.93 344.5,-6254.93"/>
</g>
<!-- gpu0_layer11_expert0 -->
<g id="node190" class="node">
<title>gpu0_layer11_expert0</title>
<polygon fill="lightblue" stroke="black" points="122,-6072.7 0,-6072.7 0,-6020.7 122,-6020.7 122,-6072.7"/>
<text text-anchor="middle" x="61" y="-6060.7" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="61" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer11_routing&#45;&gt;gpu0_layer11_expert0 -->
<g id="edge223" class="edge">
<title>gpu0_layer11_routing&#45;&gt;gpu0_layer11_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M215.33,-6121C183.34,-6105.81 150.34,-6090.13 123.11,-6077.2"/>
<polygon fill="black" stroke="black" points="124.26,-6073.87 113.73,-6072.74 121.26,-6080.19 124.26,-6073.87"/>
<text text-anchor="middle" x="197.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer11_expert1 -->
<g id="node191" class="node">
<title>gpu0_layer11_expert1</title>
<polygon fill="lightblue" stroke="black" points="262,-6072.7 140,-6072.7 140,-6020.7 262,-6020.7 262,-6072.7"/>
<text text-anchor="middle" x="201" y="-6060.7" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="201" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer11_routing&#45;&gt;gpu0_layer11_expert1 -->
<g id="edge224" class="edge">
<title>gpu0_layer11_routing&#45;&gt;gpu0_layer11_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M275.51,-6118.48C261.48,-6105.15 247.21,-6091.6 234.97,-6079.97"/>
<polygon fill="black" stroke="black" points="237.29,-6077.34 227.63,-6072.99 232.46,-6082.41 237.29,-6077.34"/>
<text text-anchor="middle" x="284.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer11_expert2 -->
<g id="node192" class="node">
<title>gpu0_layer11_expert2</title>
<polygon fill="lightblue" stroke="black" points="402,-6072.7 280,-6072.7 280,-6020.7 402,-6020.7 402,-6072.7"/>
<text text-anchor="middle" x="341" y="-6060.7" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="341" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer11_routing&#45;&gt;gpu0_layer11_expert2 -->
<g id="edge225" class="edge">
<title>gpu0_layer11_routing&#45;&gt;gpu0_layer11_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M341,-6118.48C341,-6106.41 341,-6094.15 341,-6083.31"/>
<polygon fill="black" stroke="black" points="344.5,-6082.99 341,-6072.99 337.5,-6082.99 344.5,-6082.99"/>
<text text-anchor="middle" x="370.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer11_expert3 -->
<g id="node193" class="node">
<title>gpu0_layer11_expert3</title>
<polygon fill="lightblue" stroke="black" points="542,-6072.7 420,-6072.7 420,-6020.7 542,-6020.7 542,-6072.7"/>
<text text-anchor="middle" x="481" y="-6060.7" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="481" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer11_routing&#45;&gt;gpu0_layer11_expert3 -->
<g id="edge226" class="edge">
<title>gpu0_layer11_routing&#45;&gt;gpu0_layer11_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M406.49,-6118.48C420.52,-6105.15 434.79,-6091.6 447.03,-6079.97"/>
<polygon fill="black" stroke="black" points="449.54,-6082.41 454.37,-6072.99 444.71,-6077.34 449.54,-6082.41"/>
<text text-anchor="middle" x="465.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer11_expert_agg -->
<g id="node194" class="node">
<title>gpu0_layer11_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-5983.7 266.29,-5983.7 214.53,-5879.7 415.71,-5879.7 467.47,-5983.7"/>
<text text-anchor="middle" x="341" y="-5945.7" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="341" y="-5934.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-5923.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-5912.7" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer11_routing&#45;&gt;gpu0_layer11_expert_agg -->
<g id="edge241" class="edge">
<title>gpu0_layer11_routing&#45;&gt;gpu0_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M430.22,-6153.78C503.96,-6126.62 590.6,-6080.23 551,-6020.7 530.44,-5989.78 496.7,-5969.71 462.22,-5956.68"/>
<polygon fill="black" stroke="black" points="463.08,-5953.27 452.48,-5953.19 460.71,-5959.86 463.08,-5953.27"/>
</g>
<!-- gpu0_layer11_expert0&#45;&gt;gpu0_layer11_expert_agg -->
<g id="edge237" class="edge">
<title>gpu0_layer11_expert0&#45;&gt;gpu0_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M122.1,-6021.04C158.98,-6006.15 206.7,-5986.9 248.16,-5970.16"/>
<polygon fill="black" stroke="black" points="249.5,-5973.4 257.46,-5966.41 246.88,-5966.91 249.5,-5973.4"/>
</g>
<!-- gpu0_layer11_expert1&#45;&gt;gpu0_layer11_expert_agg -->
<g id="edge238" class="edge">
<title>gpu0_layer11_expert1&#45;&gt;gpu0_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M232.07,-6020.62C243.32,-6011.54 256.53,-6000.88 269.8,-5990.17"/>
<polygon fill="black" stroke="black" points="272.02,-5992.87 277.6,-5983.87 267.62,-5987.42 272.02,-5992.87"/>
</g>
<!-- gpu0_layer11_expert2&#45;&gt;gpu0_layer11_expert_agg -->
<g id="edge239" class="edge">
<title>gpu0_layer11_expert2&#45;&gt;gpu0_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M341,-6020.62C341,-6012.69 341,-6003.55 341,-5994.23"/>
<polygon fill="black" stroke="black" points="344.5,-5994.1 341,-5984.1 337.5,-5994.1 344.5,-5994.1"/>
</g>
<!-- gpu0_layer11_expert3&#45;&gt;gpu0_layer11_expert_agg -->
<g id="edge240" class="edge">
<title>gpu0_layer11_expert3&#45;&gt;gpu0_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M449.93,-6020.62C438.68,-6011.54 425.47,-6000.88 412.2,-5990.17"/>
<polygon fill="black" stroke="black" points="414.38,-5987.42 404.4,-5983.87 409.98,-5992.87 414.38,-5987.42"/>
</g>
<!-- gpu0_layer11_res2 -->
<g id="node195" class="node">
<title>gpu0_layer11_res2</title>
<polygon fill="lightblue" stroke="black" points="402,-5842.7 280,-5842.7 280,-5790.7 402,-5790.7 402,-5842.7"/>
<text text-anchor="middle" x="341" y="-5830.7" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="341" y="-5819.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-5808.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-5797.7" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer11_expert_agg&#45;&gt;gpu0_layer11_res2 -->
<g id="edge242" class="edge">
<title>gpu0_layer11_expert_agg&#45;&gt;gpu0_layer11_res2</title>
<path fill="none" stroke="black" d="M341,-5879.49C341,-5870.53 341,-5861.41 341,-5853.01"/>
<polygon fill="black" stroke="black" points="344.5,-5852.83 341,-5842.83 337.5,-5852.83 344.5,-5852.83"/>
</g>
<!-- gpu0_layer12_ln1 -->
<g id="node196" class="node">
<title>gpu0_layer12_ln1</title>
<polygon fill="lightblue" stroke="black" points="402,-5753.7 280,-5753.7 280,-5701.7 402,-5701.7 402,-5753.7"/>
<text text-anchor="middle" x="341" y="-5741.7" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="341" y="-5730.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-5719.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-5708.7" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer11_res2&#45;&gt;gpu0_layer12_ln1 -->
<g id="edge247" class="edge">
<title>gpu0_layer11_res2&#45;&gt;gpu0_layer12_ln1</title>
<path fill="none" stroke="black" d="M341,-5790.53C341,-5782.24 341,-5772.85 341,-5763.94"/>
<polygon fill="black" stroke="black" points="344.5,-5763.8 341,-5753.8 337.5,-5763.8 344.5,-5763.8"/>
</g>
<!-- gpu0_layer12_qkv -->
<g id="node197" class="node">
<title>gpu0_layer12_qkv</title>
<polygon fill="lightblue" stroke="black" points="402,-5664.7 280,-5664.7 280,-5612.7 402,-5612.7 402,-5664.7"/>
<text text-anchor="middle" x="341" y="-5652.7" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="341" y="-5641.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-5630.7" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-5619.7" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer12_ln1&#45;&gt;gpu0_layer12_qkv -->
<g id="edge248" class="edge">
<title>gpu0_layer12_ln1&#45;&gt;gpu0_layer12_qkv</title>
<path fill="none" stroke="black" d="M341,-5701.53C341,-5693.24 341,-5683.85 341,-5674.94"/>
<polygon fill="black" stroke="black" points="344.5,-5674.8 341,-5664.8 337.5,-5674.8 344.5,-5674.8"/>
</g>
<!-- gpu0_layer12_reshape -->
<g id="node198" class="node">
<title>gpu0_layer12_reshape</title>
<polygon fill="lightblue" stroke="black" points="405,-5575.7 277,-5575.7 277,-5523.7 405,-5523.7 405,-5575.7"/>
<text text-anchor="middle" x="341" y="-5563.7" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="341" y="-5552.7" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-5541.7" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-5530.7" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer12_qkv&#45;&gt;gpu0_layer12_reshape -->
<g id="edge249" class="edge">
<title>gpu0_layer12_qkv&#45;&gt;gpu0_layer12_reshape</title>
<path fill="none" stroke="black" d="M341,-5612.53C341,-5604.24 341,-5594.85 341,-5585.94"/>
<polygon fill="black" stroke="black" points="344.5,-5585.8 341,-5575.8 337.5,-5585.8 344.5,-5585.8"/>
</g>
<!-- gpu0_layer12_attn -->
<g id="node199" class="node">
<title>gpu0_layer12_attn</title>
<polygon fill="lightblue" stroke="black" points="405,-5486.7 277,-5486.7 277,-5434.7 405,-5434.7 405,-5486.7"/>
<text text-anchor="middle" x="341" y="-5474.7" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="341" y="-5463.7" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-5452.7" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-5441.7" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer12_reshape&#45;&gt;gpu0_layer12_attn -->
<g id="edge250" class="edge">
<title>gpu0_layer12_reshape&#45;&gt;gpu0_layer12_attn</title>
<path fill="none" stroke="black" d="M341,-5523.53C341,-5515.24 341,-5505.85 341,-5496.94"/>
<polygon fill="black" stroke="black" points="344.5,-5496.8 341,-5486.8 337.5,-5496.8 344.5,-5496.8"/>
</g>
<!-- gpu0_layer12_attn_reshape -->
<g id="node201" class="node">
<title>gpu0_layer12_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="402,-5397.7 280,-5397.7 280,-5345.7 402,-5345.7 402,-5397.7"/>
<text text-anchor="middle" x="341" y="-5385.7" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="341" y="-5374.7" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-5363.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-5352.7" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer12_attn&#45;&gt;gpu0_layer12_attn_reshape -->
<g id="edge251" class="edge">
<title>gpu0_layer12_attn&#45;&gt;gpu0_layer12_attn_reshape</title>
<path fill="none" stroke="black" d="M341,-5434.53C341,-5426.24 341,-5416.85 341,-5407.94"/>
<polygon fill="black" stroke="black" points="344.5,-5407.8 341,-5397.8 337.5,-5407.8 344.5,-5407.8"/>
</g>
<!-- gpu0_layer12_attn_out -->
<g id="node200" class="node">
<title>gpu0_layer12_attn_out</title>
<polygon fill="lightblue" stroke="black" points="402,-5308.7 280,-5308.7 280,-5256.7 402,-5256.7 402,-5308.7"/>
<text text-anchor="middle" x="341" y="-5296.7" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="341" y="-5285.7" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-5274.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-5263.7" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer12_kv_update -->
<g id="node202" class="node">
<title>gpu0_layer12_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="341" cy="-5182.93" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="341" y="-5196.93" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="341" y="-5185.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-5174.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-5163.93" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer12_attn_out&#45;&gt;gpu0_layer12_kv_update -->
<g id="edge253" class="edge">
<title>gpu0_layer12_attn_out&#45;&gt;gpu0_layer12_kv_update</title>
<path fill="none" stroke="black" d="M341,-5256.52C341,-5248.38 341,-5239.08 341,-5229.92"/>
<polygon fill="black" stroke="black" points="344.5,-5229.71 341,-5219.71 337.5,-5229.71 344.5,-5229.71"/>
</g>
<!-- gpu0_layer12_attn_reshape&#45;&gt;gpu0_layer12_attn_out -->
<g id="edge252" class="edge">
<title>gpu0_layer12_attn_reshape&#45;&gt;gpu0_layer12_attn_out</title>
<path fill="none" stroke="black" d="M341,-5345.53C341,-5337.24 341,-5327.85 341,-5318.94"/>
<polygon fill="black" stroke="black" points="344.5,-5318.8 341,-5308.8 337.5,-5318.8 344.5,-5318.8"/>
</g>
<!-- gpu0_layer12_res1 -->
<g id="node203" class="node">
<title>gpu0_layer12_res1</title>
<polygon fill="lightblue" stroke="black" points="402,-5109.16 280,-5109.16 280,-5057.16 402,-5057.16 402,-5109.16"/>
<text text-anchor="middle" x="341" y="-5097.16" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="341" y="-5086.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-5075.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-5064.16" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer12_kv_update&#45;&gt;gpu0_layer12_res1 -->
<g id="edge254" class="edge">
<title>gpu0_layer12_kv_update&#45;&gt;gpu0_layer12_res1</title>
<path fill="none" stroke="black" d="M341,-5146.08C341,-5137.4 341,-5128.13 341,-5119.47"/>
<polygon fill="black" stroke="black" points="344.5,-5119.3 341,-5109.3 337.5,-5119.3 344.5,-5119.3"/>
</g>
<!-- gpu0_layer12_ln2 -->
<g id="node204" class="node">
<title>gpu0_layer12_ln2</title>
<polygon fill="lightblue" stroke="black" points="402,-5020.16 280,-5020.16 280,-4968.16 402,-4968.16 402,-5020.16"/>
<text text-anchor="middle" x="341" y="-5008.16" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="341" y="-4997.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-4986.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-4975.16" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer12_res1&#45;&gt;gpu0_layer12_ln2 -->
<g id="edge255" class="edge">
<title>gpu0_layer12_res1&#45;&gt;gpu0_layer12_ln2</title>
<path fill="none" stroke="black" d="M341,-5056.99C341,-5048.7 341,-5039.31 341,-5030.4"/>
<polygon fill="black" stroke="black" points="344.5,-5030.26 341,-5020.26 337.5,-5030.26 344.5,-5030.26"/>
</g>
<!-- gpu0_layer12_routing -->
<g id="node205" class="node">
<title>gpu0_layer12_routing</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-4931.16 266.29,-4931.16 214.53,-4805.16 415.71,-4805.16 467.47,-4931.16"/>
<text text-anchor="middle" x="341" y="-4887.66" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="341" y="-4876.66" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-4865.66" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-4854.66" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="341" y="-4843.66" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer12_ln2&#45;&gt;gpu0_layer12_routing -->
<g id="edge256" class="edge">
<title>gpu0_layer12_ln2&#45;&gt;gpu0_layer12_routing</title>
<path fill="none" stroke="black" d="M341,-4968.06C341,-4960.13 341,-4950.93 341,-4941.4"/>
<polygon fill="black" stroke="black" points="344.5,-4941.39 341,-4931.39 337.5,-4941.39 344.5,-4941.39"/>
</g>
<!-- gpu0_layer12_expert0 -->
<g id="node206" class="node">
<title>gpu0_layer12_expert0</title>
<polygon fill="lightblue" stroke="black" points="122,-4759.16 0,-4759.16 0,-4707.16 122,-4707.16 122,-4759.16"/>
<text text-anchor="middle" x="61" y="-4747.16" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="61" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer12_routing&#45;&gt;gpu0_layer12_expert0 -->
<g id="edge243" class="edge">
<title>gpu0_layer12_routing&#45;&gt;gpu0_layer12_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M215.33,-4807.46C183.34,-4792.27 150.34,-4776.59 123.11,-4763.66"/>
<polygon fill="black" stroke="black" points="124.26,-4760.33 113.73,-4759.2 121.26,-4766.65 124.26,-4760.33"/>
<text text-anchor="middle" x="197.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer12_expert1 -->
<g id="node207" class="node">
<title>gpu0_layer12_expert1</title>
<polygon fill="lightblue" stroke="black" points="262,-4759.16 140,-4759.16 140,-4707.16 262,-4707.16 262,-4759.16"/>
<text text-anchor="middle" x="201" y="-4747.16" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="201" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer12_routing&#45;&gt;gpu0_layer12_expert1 -->
<g id="edge244" class="edge">
<title>gpu0_layer12_routing&#45;&gt;gpu0_layer12_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M275.51,-4804.94C261.48,-4791.62 247.21,-4778.06 234.97,-4766.43"/>
<polygon fill="black" stroke="black" points="237.29,-4763.8 227.63,-4759.45 232.46,-4768.88 237.29,-4763.8"/>
<text text-anchor="middle" x="284.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer12_expert2 -->
<g id="node208" class="node">
<title>gpu0_layer12_expert2</title>
<polygon fill="lightblue" stroke="black" points="402,-4759.16 280,-4759.16 280,-4707.16 402,-4707.16 402,-4759.16"/>
<text text-anchor="middle" x="341" y="-4747.16" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="341" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer12_routing&#45;&gt;gpu0_layer12_expert2 -->
<g id="edge245" class="edge">
<title>gpu0_layer12_routing&#45;&gt;gpu0_layer12_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M341,-4804.94C341,-4792.87 341,-4780.62 341,-4769.77"/>
<polygon fill="black" stroke="black" points="344.5,-4769.45 341,-4759.45 337.5,-4769.45 344.5,-4769.45"/>
<text text-anchor="middle" x="370.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer12_expert3 -->
<g id="node209" class="node">
<title>gpu0_layer12_expert3</title>
<polygon fill="lightblue" stroke="black" points="542,-4759.16 420,-4759.16 420,-4707.16 542,-4707.16 542,-4759.16"/>
<text text-anchor="middle" x="481" y="-4747.16" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="481" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer12_routing&#45;&gt;gpu0_layer12_expert3 -->
<g id="edge246" class="edge">
<title>gpu0_layer12_routing&#45;&gt;gpu0_layer12_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M406.49,-4804.94C420.52,-4791.62 434.79,-4778.06 447.03,-4766.43"/>
<polygon fill="black" stroke="black" points="449.54,-4768.88 454.37,-4759.45 444.71,-4763.8 449.54,-4768.88"/>
<text text-anchor="middle" x="465.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer12_expert_agg -->
<g id="node210" class="node">
<title>gpu0_layer12_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-4670.16 266.29,-4670.16 214.53,-4566.16 415.71,-4566.16 467.47,-4670.16"/>
<text text-anchor="middle" x="341" y="-4632.16" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="341" y="-4621.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-4610.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-4599.16" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer12_routing&#45;&gt;gpu0_layer12_expert_agg -->
<g id="edge261" class="edge">
<title>gpu0_layer12_routing&#45;&gt;gpu0_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M430.22,-4840.24C503.96,-4813.08 590.6,-4766.69 551,-4707.16 530.44,-4676.24 496.7,-4656.17 462.22,-4643.14"/>
<polygon fill="black" stroke="black" points="463.08,-4639.73 452.48,-4639.65 460.71,-4646.32 463.08,-4639.73"/>
</g>
<!-- gpu0_layer12_expert0&#45;&gt;gpu0_layer12_expert_agg -->
<g id="edge257" class="edge">
<title>gpu0_layer12_expert0&#45;&gt;gpu0_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M122.1,-4707.5C158.98,-4692.62 206.7,-4673.36 248.16,-4656.62"/>
<polygon fill="black" stroke="black" points="249.5,-4659.86 257.46,-4652.87 246.88,-4653.37 249.5,-4659.86"/>
</g>
<!-- gpu0_layer12_expert1&#45;&gt;gpu0_layer12_expert_agg -->
<g id="edge258" class="edge">
<title>gpu0_layer12_expert1&#45;&gt;gpu0_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M232.07,-4707.08C243.32,-4698 256.53,-4687.34 269.8,-4676.63"/>
<polygon fill="black" stroke="black" points="272.02,-4679.33 277.6,-4670.33 267.62,-4673.89 272.02,-4679.33"/>
</g>
<!-- gpu0_layer12_expert2&#45;&gt;gpu0_layer12_expert_agg -->
<g id="edge259" class="edge">
<title>gpu0_layer12_expert2&#45;&gt;gpu0_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M341,-4707.08C341,-4699.15 341,-4690.02 341,-4680.69"/>
<polygon fill="black" stroke="black" points="344.5,-4680.56 341,-4670.56 337.5,-4680.56 344.5,-4680.56"/>
</g>
<!-- gpu0_layer12_expert3&#45;&gt;gpu0_layer12_expert_agg -->
<g id="edge260" class="edge">
<title>gpu0_layer12_expert3&#45;&gt;gpu0_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M449.93,-4707.08C438.68,-4698 425.47,-4687.34 412.2,-4676.63"/>
<polygon fill="black" stroke="black" points="414.38,-4673.89 404.4,-4670.33 409.98,-4679.33 414.38,-4673.89"/>
</g>
<!-- gpu0_layer12_res2 -->
<g id="node211" class="node">
<title>gpu0_layer12_res2</title>
<polygon fill="lightblue" stroke="black" points="402,-4529.16 280,-4529.16 280,-4477.16 402,-4477.16 402,-4529.16"/>
<text text-anchor="middle" x="341" y="-4517.16" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="341" y="-4506.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-4495.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-4484.16" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer12_expert_agg&#45;&gt;gpu0_layer12_res2 -->
<g id="edge262" class="edge">
<title>gpu0_layer12_expert_agg&#45;&gt;gpu0_layer12_res2</title>
<path fill="none" stroke="black" d="M341,-4565.95C341,-4557 341,-4547.87 341,-4539.47"/>
<polygon fill="black" stroke="black" points="344.5,-4539.29 341,-4529.29 337.5,-4539.29 344.5,-4539.29"/>
</g>
<!-- gpu0_layer13_ln1 -->
<g id="node212" class="node">
<title>gpu0_layer13_ln1</title>
<polygon fill="lightblue" stroke="black" points="402,-4440.16 280,-4440.16 280,-4388.16 402,-4388.16 402,-4440.16"/>
<text text-anchor="middle" x="341" y="-4428.16" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="341" y="-4417.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-4406.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-4395.16" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer12_res2&#45;&gt;gpu0_layer13_ln1 -->
<g id="edge267" class="edge">
<title>gpu0_layer12_res2&#45;&gt;gpu0_layer13_ln1</title>
<path fill="none" stroke="black" d="M341,-4476.99C341,-4468.7 341,-4459.31 341,-4450.4"/>
<polygon fill="black" stroke="black" points="344.5,-4450.26 341,-4440.26 337.5,-4450.26 344.5,-4450.26"/>
</g>
<!-- gpu0_layer13_qkv -->
<g id="node213" class="node">
<title>gpu0_layer13_qkv</title>
<polygon fill="lightblue" stroke="black" points="402,-4351.16 280,-4351.16 280,-4299.16 402,-4299.16 402,-4351.16"/>
<text text-anchor="middle" x="341" y="-4339.16" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="341" y="-4328.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-4317.16" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-4306.16" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer13_ln1&#45;&gt;gpu0_layer13_qkv -->
<g id="edge268" class="edge">
<title>gpu0_layer13_ln1&#45;&gt;gpu0_layer13_qkv</title>
<path fill="none" stroke="black" d="M341,-4387.99C341,-4379.7 341,-4370.31 341,-4361.4"/>
<polygon fill="black" stroke="black" points="344.5,-4361.26 341,-4351.26 337.5,-4361.26 344.5,-4361.26"/>
</g>
<!-- gpu0_layer13_reshape -->
<g id="node214" class="node">
<title>gpu0_layer13_reshape</title>
<polygon fill="lightblue" stroke="black" points="405,-4262.16 277,-4262.16 277,-4210.16 405,-4210.16 405,-4262.16"/>
<text text-anchor="middle" x="341" y="-4250.16" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="341" y="-4239.16" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-4228.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-4217.16" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer13_qkv&#45;&gt;gpu0_layer13_reshape -->
<g id="edge269" class="edge">
<title>gpu0_layer13_qkv&#45;&gt;gpu0_layer13_reshape</title>
<path fill="none" stroke="black" d="M341,-4298.99C341,-4290.7 341,-4281.31 341,-4272.4"/>
<polygon fill="black" stroke="black" points="344.5,-4272.26 341,-4262.26 337.5,-4272.26 344.5,-4272.26"/>
</g>
<!-- gpu0_layer13_attn -->
<g id="node215" class="node">
<title>gpu0_layer13_attn</title>
<polygon fill="lightblue" stroke="black" points="405,-4173.16 277,-4173.16 277,-4121.16 405,-4121.16 405,-4173.16"/>
<text text-anchor="middle" x="341" y="-4161.16" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="341" y="-4150.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-4139.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-4128.16" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer13_reshape&#45;&gt;gpu0_layer13_attn -->
<g id="edge270" class="edge">
<title>gpu0_layer13_reshape&#45;&gt;gpu0_layer13_attn</title>
<path fill="none" stroke="black" d="M341,-4209.99C341,-4201.7 341,-4192.31 341,-4183.4"/>
<polygon fill="black" stroke="black" points="344.5,-4183.26 341,-4173.26 337.5,-4183.26 344.5,-4183.26"/>
</g>
<!-- gpu0_layer13_attn_reshape -->
<g id="node217" class="node">
<title>gpu0_layer13_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="402,-4084.16 280,-4084.16 280,-4032.16 402,-4032.16 402,-4084.16"/>
<text text-anchor="middle" x="341" y="-4072.16" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="341" y="-4061.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-4050.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-4039.16" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer13_attn&#45;&gt;gpu0_layer13_attn_reshape -->
<g id="edge271" class="edge">
<title>gpu0_layer13_attn&#45;&gt;gpu0_layer13_attn_reshape</title>
<path fill="none" stroke="black" d="M341,-4120.99C341,-4112.7 341,-4103.31 341,-4094.4"/>
<polygon fill="black" stroke="black" points="344.5,-4094.26 341,-4084.26 337.5,-4094.26 344.5,-4094.26"/>
</g>
<!-- gpu0_layer13_attn_out -->
<g id="node216" class="node">
<title>gpu0_layer13_attn_out</title>
<polygon fill="lightblue" stroke="black" points="402,-3995.16 280,-3995.16 280,-3943.16 402,-3943.16 402,-3995.16"/>
<text text-anchor="middle" x="341" y="-3983.16" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="341" y="-3972.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-3961.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-3950.16" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer13_kv_update -->
<g id="node218" class="node">
<title>gpu0_layer13_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="341" cy="-3869.39" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="341" y="-3883.39" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="341" y="-3872.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-3861.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-3850.39" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer13_attn_out&#45;&gt;gpu0_layer13_kv_update -->
<g id="edge273" class="edge">
<title>gpu0_layer13_attn_out&#45;&gt;gpu0_layer13_kv_update</title>
<path fill="none" stroke="black" d="M341,-3942.98C341,-3934.84 341,-3925.54 341,-3916.38"/>
<polygon fill="black" stroke="black" points="344.5,-3916.17 341,-3906.17 337.5,-3916.17 344.5,-3916.17"/>
</g>
<!-- gpu0_layer13_attn_reshape&#45;&gt;gpu0_layer13_attn_out -->
<g id="edge272" class="edge">
<title>gpu0_layer13_attn_reshape&#45;&gt;gpu0_layer13_attn_out</title>
<path fill="none" stroke="black" d="M341,-4031.99C341,-4023.7 341,-4014.31 341,-4005.4"/>
<polygon fill="black" stroke="black" points="344.5,-4005.26 341,-3995.26 337.5,-4005.26 344.5,-4005.26"/>
</g>
<!-- gpu0_layer13_res1 -->
<g id="node219" class="node">
<title>gpu0_layer13_res1</title>
<polygon fill="lightblue" stroke="black" points="402,-3795.62 280,-3795.62 280,-3743.62 402,-3743.62 402,-3795.62"/>
<text text-anchor="middle" x="341" y="-3783.62" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="341" y="-3772.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-3761.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-3750.62" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer13_kv_update&#45;&gt;gpu0_layer13_res1 -->
<g id="edge274" class="edge">
<title>gpu0_layer13_kv_update&#45;&gt;gpu0_layer13_res1</title>
<path fill="none" stroke="black" d="M341,-3832.54C341,-3823.86 341,-3814.59 341,-3805.93"/>
<polygon fill="black" stroke="black" points="344.5,-3805.76 341,-3795.76 337.5,-3805.76 344.5,-3805.76"/>
</g>
<!-- gpu0_layer13_ln2 -->
<g id="node220" class="node">
<title>gpu0_layer13_ln2</title>
<polygon fill="lightblue" stroke="black" points="402,-3706.62 280,-3706.62 280,-3654.62 402,-3654.62 402,-3706.62"/>
<text text-anchor="middle" x="341" y="-3694.62" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="341" y="-3683.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-3672.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-3661.62" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer13_res1&#45;&gt;gpu0_layer13_ln2 -->
<g id="edge275" class="edge">
<title>gpu0_layer13_res1&#45;&gt;gpu0_layer13_ln2</title>
<path fill="none" stroke="black" d="M341,-3743.45C341,-3735.16 341,-3725.77 341,-3716.87"/>
<polygon fill="black" stroke="black" points="344.5,-3716.72 341,-3706.72 337.5,-3716.72 344.5,-3716.72"/>
</g>
<!-- gpu0_layer13_routing -->
<g id="node221" class="node">
<title>gpu0_layer13_routing</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-3617.62 266.29,-3617.62 214.53,-3491.62 415.71,-3491.62 467.47,-3617.62"/>
<text text-anchor="middle" x="341" y="-3574.12" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="341" y="-3563.12" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-3552.12" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-3541.12" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="341" y="-3530.12" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer13_ln2&#45;&gt;gpu0_layer13_routing -->
<g id="edge276" class="edge">
<title>gpu0_layer13_ln2&#45;&gt;gpu0_layer13_routing</title>
<path fill="none" stroke="black" d="M341,-3654.52C341,-3646.59 341,-3637.4 341,-3627.87"/>
<polygon fill="black" stroke="black" points="344.5,-3627.85 341,-3617.85 337.5,-3627.85 344.5,-3627.85"/>
</g>
<!-- gpu0_layer13_expert0 -->
<g id="node222" class="node">
<title>gpu0_layer13_expert0</title>
<polygon fill="lightblue" stroke="black" points="122,-3445.62 0,-3445.62 0,-3393.62 122,-3393.62 122,-3445.62"/>
<text text-anchor="middle" x="61" y="-3433.62" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="61" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer13_routing&#45;&gt;gpu0_layer13_expert0 -->
<g id="edge263" class="edge">
<title>gpu0_layer13_routing&#45;&gt;gpu0_layer13_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M215.33,-3493.93C183.34,-3478.73 150.34,-3463.05 123.11,-3450.12"/>
<polygon fill="black" stroke="black" points="124.26,-3446.79 113.73,-3445.66 121.26,-3453.11 124.26,-3446.79"/>
<text text-anchor="middle" x="197.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer13_expert1 -->
<g id="node223" class="node">
<title>gpu0_layer13_expert1</title>
<polygon fill="lightblue" stroke="black" points="262,-3445.62 140,-3445.62 140,-3393.62 262,-3393.62 262,-3445.62"/>
<text text-anchor="middle" x="201" y="-3433.62" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="201" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer13_routing&#45;&gt;gpu0_layer13_expert1 -->
<g id="edge264" class="edge">
<title>gpu0_layer13_routing&#45;&gt;gpu0_layer13_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M275.51,-3491.4C261.48,-3478.08 247.21,-3464.52 234.97,-3452.89"/>
<polygon fill="black" stroke="black" points="237.29,-3450.26 227.63,-3445.91 232.46,-3455.34 237.29,-3450.26"/>
<text text-anchor="middle" x="284.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer13_expert2 -->
<g id="node224" class="node">
<title>gpu0_layer13_expert2</title>
<polygon fill="lightblue" stroke="black" points="402,-3445.62 280,-3445.62 280,-3393.62 402,-3393.62 402,-3445.62"/>
<text text-anchor="middle" x="341" y="-3433.62" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="341" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer13_routing&#45;&gt;gpu0_layer13_expert2 -->
<g id="edge265" class="edge">
<title>gpu0_layer13_routing&#45;&gt;gpu0_layer13_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M341,-3491.4C341,-3479.33 341,-3467.08 341,-3456.23"/>
<polygon fill="black" stroke="black" points="344.5,-3455.91 341,-3445.91 337.5,-3455.91 344.5,-3455.91"/>
<text text-anchor="middle" x="370.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer13_expert3 -->
<g id="node225" class="node">
<title>gpu0_layer13_expert3</title>
<polygon fill="lightblue" stroke="black" points="542,-3445.62 420,-3445.62 420,-3393.62 542,-3393.62 542,-3445.62"/>
<text text-anchor="middle" x="481" y="-3433.62" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="481" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer13_routing&#45;&gt;gpu0_layer13_expert3 -->
<g id="edge266" class="edge">
<title>gpu0_layer13_routing&#45;&gt;gpu0_layer13_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M406.49,-3491.4C420.52,-3478.08 434.79,-3464.52 447.03,-3452.89"/>
<polygon fill="black" stroke="black" points="449.54,-3455.34 454.37,-3445.91 444.71,-3450.26 449.54,-3455.34"/>
<text text-anchor="middle" x="465.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer13_expert_agg -->
<g id="node226" class="node">
<title>gpu0_layer13_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-3356.62 266.29,-3356.62 214.53,-3252.62 415.71,-3252.62 467.47,-3356.62"/>
<text text-anchor="middle" x="341" y="-3318.62" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="341" y="-3307.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-3296.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-3285.62" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer13_routing&#45;&gt;gpu0_layer13_expert_agg -->
<g id="edge281" class="edge">
<title>gpu0_layer13_routing&#45;&gt;gpu0_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M430.22,-3526.7C503.96,-3499.54 590.6,-3453.15 551,-3393.62 530.44,-3362.71 496.7,-3342.63 462.22,-3329.6"/>
<polygon fill="black" stroke="black" points="463.08,-3326.19 452.48,-3326.11 460.71,-3332.78 463.08,-3326.19"/>
</g>
<!-- gpu0_layer13_expert0&#45;&gt;gpu0_layer13_expert_agg -->
<g id="edge277" class="edge">
<title>gpu0_layer13_expert0&#45;&gt;gpu0_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M122.1,-3393.96C158.98,-3379.08 206.7,-3359.82 248.16,-3343.08"/>
<polygon fill="black" stroke="black" points="249.5,-3346.32 257.46,-3339.33 246.88,-3339.83 249.5,-3346.32"/>
</g>
<!-- gpu0_layer13_expert1&#45;&gt;gpu0_layer13_expert_agg -->
<g id="edge278" class="edge">
<title>gpu0_layer13_expert1&#45;&gt;gpu0_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M232.07,-3393.54C243.32,-3384.46 256.53,-3373.8 269.8,-3363.09"/>
<polygon fill="black" stroke="black" points="272.02,-3365.79 277.6,-3356.79 267.62,-3360.35 272.02,-3365.79"/>
</g>
<!-- gpu0_layer13_expert2&#45;&gt;gpu0_layer13_expert_agg -->
<g id="edge279" class="edge">
<title>gpu0_layer13_expert2&#45;&gt;gpu0_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M341,-3393.54C341,-3385.61 341,-3376.48 341,-3367.16"/>
<polygon fill="black" stroke="black" points="344.5,-3367.02 341,-3357.02 337.5,-3367.02 344.5,-3367.02"/>
</g>
<!-- gpu0_layer13_expert3&#45;&gt;gpu0_layer13_expert_agg -->
<g id="edge280" class="edge">
<title>gpu0_layer13_expert3&#45;&gt;gpu0_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M449.93,-3393.54C438.68,-3384.46 425.47,-3373.8 412.2,-3363.09"/>
<polygon fill="black" stroke="black" points="414.38,-3360.35 404.4,-3356.79 409.98,-3365.79 414.38,-3360.35"/>
</g>
<!-- gpu0_layer13_res2 -->
<g id="node227" class="node">
<title>gpu0_layer13_res2</title>
<polygon fill="lightblue" stroke="black" points="402,-3215.62 280,-3215.62 280,-3163.62 402,-3163.62 402,-3215.62"/>
<text text-anchor="middle" x="341" y="-3203.62" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="341" y="-3192.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-3181.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-3170.62" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer13_expert_agg&#45;&gt;gpu0_layer13_res2 -->
<g id="edge282" class="edge">
<title>gpu0_layer13_expert_agg&#45;&gt;gpu0_layer13_res2</title>
<path fill="none" stroke="black" d="M341,-3252.41C341,-3243.46 341,-3234.33 341,-3225.93"/>
<polygon fill="black" stroke="black" points="344.5,-3225.75 341,-3215.75 337.5,-3225.75 344.5,-3225.75"/>
</g>
<!-- gpu0_layer14_ln1 -->
<g id="node228" class="node">
<title>gpu0_layer14_ln1</title>
<polygon fill="lightblue" stroke="black" points="402,-3126.62 280,-3126.62 280,-3074.62 402,-3074.62 402,-3126.62"/>
<text text-anchor="middle" x="341" y="-3114.62" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="341" y="-3103.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-3092.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-3081.62" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer13_res2&#45;&gt;gpu0_layer14_ln1 -->
<g id="edge287" class="edge">
<title>gpu0_layer13_res2&#45;&gt;gpu0_layer14_ln1</title>
<path fill="none" stroke="black" d="M341,-3163.45C341,-3155.16 341,-3145.77 341,-3136.87"/>
<polygon fill="black" stroke="black" points="344.5,-3136.72 341,-3126.72 337.5,-3136.72 344.5,-3136.72"/>
</g>
<!-- gpu0_layer14_qkv -->
<g id="node229" class="node">
<title>gpu0_layer14_qkv</title>
<polygon fill="lightblue" stroke="black" points="402,-3037.62 280,-3037.62 280,-2985.62 402,-2985.62 402,-3037.62"/>
<text text-anchor="middle" x="341" y="-3025.62" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="341" y="-3014.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-3003.62" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-2992.62" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer14_ln1&#45;&gt;gpu0_layer14_qkv -->
<g id="edge288" class="edge">
<title>gpu0_layer14_ln1&#45;&gt;gpu0_layer14_qkv</title>
<path fill="none" stroke="black" d="M341,-3074.45C341,-3066.16 341,-3056.77 341,-3047.87"/>
<polygon fill="black" stroke="black" points="344.5,-3047.72 341,-3037.72 337.5,-3047.72 344.5,-3047.72"/>
</g>
<!-- gpu0_layer14_reshape -->
<g id="node230" class="node">
<title>gpu0_layer14_reshape</title>
<polygon fill="lightblue" stroke="black" points="405,-2948.62 277,-2948.62 277,-2896.62 405,-2896.62 405,-2948.62"/>
<text text-anchor="middle" x="341" y="-2936.62" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="341" y="-2925.62" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-2914.62" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-2903.62" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer14_qkv&#45;&gt;gpu0_layer14_reshape -->
<g id="edge289" class="edge">
<title>gpu0_layer14_qkv&#45;&gt;gpu0_layer14_reshape</title>
<path fill="none" stroke="black" d="M341,-2985.45C341,-2977.16 341,-2967.77 341,-2958.87"/>
<polygon fill="black" stroke="black" points="344.5,-2958.72 341,-2948.72 337.5,-2958.72 344.5,-2958.72"/>
</g>
<!-- gpu0_layer14_attn -->
<g id="node231" class="node">
<title>gpu0_layer14_attn</title>
<polygon fill="lightblue" stroke="black" points="405,-2859.62 277,-2859.62 277,-2807.62 405,-2807.62 405,-2859.62"/>
<text text-anchor="middle" x="341" y="-2847.62" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="341" y="-2836.62" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-2825.62" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-2814.62" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer14_reshape&#45;&gt;gpu0_layer14_attn -->
<g id="edge290" class="edge">
<title>gpu0_layer14_reshape&#45;&gt;gpu0_layer14_attn</title>
<path fill="none" stroke="black" d="M341,-2896.45C341,-2888.16 341,-2878.77 341,-2869.87"/>
<polygon fill="black" stroke="black" points="344.5,-2869.72 341,-2859.72 337.5,-2869.72 344.5,-2869.72"/>
</g>
<!-- gpu0_layer14_attn_reshape -->
<g id="node233" class="node">
<title>gpu0_layer14_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="402,-2770.62 280,-2770.62 280,-2718.62 402,-2718.62 402,-2770.62"/>
<text text-anchor="middle" x="341" y="-2758.62" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="341" y="-2747.62" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-2736.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-2725.62" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer14_attn&#45;&gt;gpu0_layer14_attn_reshape -->
<g id="edge291" class="edge">
<title>gpu0_layer14_attn&#45;&gt;gpu0_layer14_attn_reshape</title>
<path fill="none" stroke="black" d="M341,-2807.45C341,-2799.16 341,-2789.77 341,-2780.87"/>
<polygon fill="black" stroke="black" points="344.5,-2780.72 341,-2770.72 337.5,-2780.72 344.5,-2780.72"/>
</g>
<!-- gpu0_layer14_attn_out -->
<g id="node232" class="node">
<title>gpu0_layer14_attn_out</title>
<polygon fill="lightblue" stroke="black" points="402,-2681.62 280,-2681.62 280,-2629.62 402,-2629.62 402,-2681.62"/>
<text text-anchor="middle" x="341" y="-2669.62" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="341" y="-2658.62" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-2647.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-2636.62" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer14_kv_update -->
<g id="node234" class="node">
<title>gpu0_layer14_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="341" cy="-2555.85" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="341" y="-2569.85" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="341" y="-2558.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-2547.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-2536.85" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer14_attn_out&#45;&gt;gpu0_layer14_kv_update -->
<g id="edge293" class="edge">
<title>gpu0_layer14_attn_out&#45;&gt;gpu0_layer14_kv_update</title>
<path fill="none" stroke="black" d="M341,-2629.44C341,-2621.3 341,-2612 341,-2602.84"/>
<polygon fill="black" stroke="black" points="344.5,-2602.63 341,-2592.63 337.5,-2602.63 344.5,-2602.63"/>
</g>
<!-- gpu0_layer14_attn_reshape&#45;&gt;gpu0_layer14_attn_out -->
<g id="edge292" class="edge">
<title>gpu0_layer14_attn_reshape&#45;&gt;gpu0_layer14_attn_out</title>
<path fill="none" stroke="black" d="M341,-2718.45C341,-2710.16 341,-2700.77 341,-2691.87"/>
<polygon fill="black" stroke="black" points="344.5,-2691.72 341,-2681.72 337.5,-2691.72 344.5,-2691.72"/>
</g>
<!-- gpu0_layer14_res1 -->
<g id="node235" class="node">
<title>gpu0_layer14_res1</title>
<polygon fill="lightblue" stroke="black" points="402,-2482.08 280,-2482.08 280,-2430.08 402,-2430.08 402,-2482.08"/>
<text text-anchor="middle" x="341" y="-2470.08" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="341" y="-2459.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-2448.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-2437.08" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer14_kv_update&#45;&gt;gpu0_layer14_res1 -->
<g id="edge294" class="edge">
<title>gpu0_layer14_kv_update&#45;&gt;gpu0_layer14_res1</title>
<path fill="none" stroke="black" d="M341,-2519C341,-2510.32 341,-2501.05 341,-2492.39"/>
<polygon fill="black" stroke="black" points="344.5,-2492.22 341,-2482.22 337.5,-2492.22 344.5,-2492.22"/>
</g>
<!-- gpu0_layer14_ln2 -->
<g id="node236" class="node">
<title>gpu0_layer14_ln2</title>
<polygon fill="lightblue" stroke="black" points="402,-2393.08 280,-2393.08 280,-2341.08 402,-2341.08 402,-2393.08"/>
<text text-anchor="middle" x="341" y="-2381.08" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="341" y="-2370.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-2359.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-2348.08" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer14_res1&#45;&gt;gpu0_layer14_ln2 -->
<g id="edge295" class="edge">
<title>gpu0_layer14_res1&#45;&gt;gpu0_layer14_ln2</title>
<path fill="none" stroke="black" d="M341,-2429.91C341,-2421.62 341,-2412.23 341,-2403.33"/>
<polygon fill="black" stroke="black" points="344.5,-2403.19 341,-2393.19 337.5,-2403.19 344.5,-2403.19"/>
</g>
<!-- gpu0_layer14_routing -->
<g id="node237" class="node">
<title>gpu0_layer14_routing</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-2304.08 266.29,-2304.08 214.53,-2178.08 415.71,-2178.08 467.47,-2304.08"/>
<text text-anchor="middle" x="341" y="-2260.58" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="341" y="-2249.58" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-2238.58" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-2227.58" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="341" y="-2216.58" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer14_ln2&#45;&gt;gpu0_layer14_routing -->
<g id="edge296" class="edge">
<title>gpu0_layer14_ln2&#45;&gt;gpu0_layer14_routing</title>
<path fill="none" stroke="black" d="M341,-2340.98C341,-2333.05 341,-2323.86 341,-2314.33"/>
<polygon fill="black" stroke="black" points="344.5,-2314.31 341,-2304.31 337.5,-2314.31 344.5,-2314.31"/>
</g>
<!-- gpu0_layer14_expert0 -->
<g id="node238" class="node">
<title>gpu0_layer14_expert0</title>
<polygon fill="lightblue" stroke="black" points="122,-2132.08 0,-2132.08 0,-2080.08 122,-2080.08 122,-2132.08"/>
<text text-anchor="middle" x="61" y="-2120.08" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="61" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer14_routing&#45;&gt;gpu0_layer14_expert0 -->
<g id="edge283" class="edge">
<title>gpu0_layer14_routing&#45;&gt;gpu0_layer14_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M215.33,-2180.39C183.34,-2165.19 150.34,-2149.51 123.11,-2136.58"/>
<polygon fill="black" stroke="black" points="124.26,-2133.25 113.73,-2132.12 121.26,-2139.58 124.26,-2133.25"/>
<text text-anchor="middle" x="197.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer14_expert1 -->
<g id="node239" class="node">
<title>gpu0_layer14_expert1</title>
<polygon fill="lightblue" stroke="black" points="262,-2132.08 140,-2132.08 140,-2080.08 262,-2080.08 262,-2132.08"/>
<text text-anchor="middle" x="201" y="-2120.08" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="201" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer14_routing&#45;&gt;gpu0_layer14_expert1 -->
<g id="edge284" class="edge">
<title>gpu0_layer14_routing&#45;&gt;gpu0_layer14_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M275.51,-2177.86C261.48,-2164.54 247.21,-2150.98 234.97,-2139.35"/>
<polygon fill="black" stroke="black" points="237.29,-2136.72 227.63,-2132.37 232.46,-2141.8 237.29,-2136.72"/>
<text text-anchor="middle" x="284.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer14_expert2 -->
<g id="node240" class="node">
<title>gpu0_layer14_expert2</title>
<polygon fill="lightblue" stroke="black" points="402,-2132.08 280,-2132.08 280,-2080.08 402,-2080.08 402,-2132.08"/>
<text text-anchor="middle" x="341" y="-2120.08" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="341" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer14_routing&#45;&gt;gpu0_layer14_expert2 -->
<g id="edge285" class="edge">
<title>gpu0_layer14_routing&#45;&gt;gpu0_layer14_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M341,-2177.86C341,-2165.79 341,-2153.54 341,-2142.69"/>
<polygon fill="black" stroke="black" points="344.5,-2142.37 341,-2132.37 337.5,-2142.37 344.5,-2142.37"/>
<text text-anchor="middle" x="370.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer14_expert3 -->
<g id="node241" class="node">
<title>gpu0_layer14_expert3</title>
<polygon fill="lightblue" stroke="black" points="542,-2132.08 420,-2132.08 420,-2080.08 542,-2080.08 542,-2132.08"/>
<text text-anchor="middle" x="481" y="-2120.08" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="481" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer14_routing&#45;&gt;gpu0_layer14_expert3 -->
<g id="edge286" class="edge">
<title>gpu0_layer14_routing&#45;&gt;gpu0_layer14_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M406.49,-2177.86C420.52,-2164.54 434.79,-2150.98 447.03,-2139.35"/>
<polygon fill="black" stroke="black" points="449.54,-2141.8 454.37,-2132.37 444.71,-2136.72 449.54,-2141.8"/>
<text text-anchor="middle" x="465.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer14_expert_agg -->
<g id="node242" class="node">
<title>gpu0_layer14_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-2043.08 266.29,-2043.08 214.53,-1939.08 415.71,-1939.08 467.47,-2043.08"/>
<text text-anchor="middle" x="341" y="-2005.08" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="341" y="-1994.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-1983.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-1972.08" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer14_routing&#45;&gt;gpu0_layer14_expert_agg -->
<g id="edge301" class="edge">
<title>gpu0_layer14_routing&#45;&gt;gpu0_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M430.22,-2213.16C503.96,-2186 590.6,-2139.61 551,-2080.08 530.44,-2049.17 496.7,-2029.09 462.22,-2016.06"/>
<polygon fill="black" stroke="black" points="463.08,-2012.65 452.48,-2012.57 460.71,-2019.24 463.08,-2012.65"/>
</g>
<!-- gpu0_layer14_expert0&#45;&gt;gpu0_layer14_expert_agg -->
<g id="edge297" class="edge">
<title>gpu0_layer14_expert0&#45;&gt;gpu0_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M122.1,-2080.42C158.98,-2065.54 206.7,-2046.28 248.16,-2029.54"/>
<polygon fill="black" stroke="black" points="249.5,-2032.78 257.46,-2025.79 246.88,-2026.29 249.5,-2032.78"/>
</g>
<!-- gpu0_layer14_expert1&#45;&gt;gpu0_layer14_expert_agg -->
<g id="edge298" class="edge">
<title>gpu0_layer14_expert1&#45;&gt;gpu0_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M232.07,-2080C243.32,-2070.92 256.53,-2060.26 269.8,-2049.55"/>
<polygon fill="black" stroke="black" points="272.02,-2052.25 277.6,-2043.25 267.62,-2046.81 272.02,-2052.25"/>
</g>
<!-- gpu0_layer14_expert2&#45;&gt;gpu0_layer14_expert_agg -->
<g id="edge299" class="edge">
<title>gpu0_layer14_expert2&#45;&gt;gpu0_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M341,-2080C341,-2072.07 341,-2062.94 341,-2053.62"/>
<polygon fill="black" stroke="black" points="344.5,-2053.48 341,-2043.48 337.5,-2053.48 344.5,-2053.48"/>
</g>
<!-- gpu0_layer14_expert3&#45;&gt;gpu0_layer14_expert_agg -->
<g id="edge300" class="edge">
<title>gpu0_layer14_expert3&#45;&gt;gpu0_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M449.93,-2080C438.68,-2070.92 425.47,-2060.26 412.2,-2049.55"/>
<polygon fill="black" stroke="black" points="414.38,-2046.81 404.4,-2043.25 409.98,-2052.25 414.38,-2046.81"/>
</g>
<!-- gpu0_layer14_res2 -->
<g id="node243" class="node">
<title>gpu0_layer14_res2</title>
<polygon fill="lightblue" stroke="black" points="402,-1902.08 280,-1902.08 280,-1850.08 402,-1850.08 402,-1902.08"/>
<text text-anchor="middle" x="341" y="-1890.08" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="341" y="-1879.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-1868.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-1857.08" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer14_expert_agg&#45;&gt;gpu0_layer14_res2 -->
<g id="edge302" class="edge">
<title>gpu0_layer14_expert_agg&#45;&gt;gpu0_layer14_res2</title>
<path fill="none" stroke="black" d="M341,-1938.87C341,-1929.92 341,-1920.79 341,-1912.39"/>
<polygon fill="black" stroke="black" points="344.5,-1912.21 341,-1902.21 337.5,-1912.21 344.5,-1912.21"/>
</g>
<!-- gpu0_layer15_ln1 -->
<g id="node244" class="node">
<title>gpu0_layer15_ln1</title>
<polygon fill="lightblue" stroke="black" points="402,-1813.08 280,-1813.08 280,-1761.08 402,-1761.08 402,-1813.08"/>
<text text-anchor="middle" x="341" y="-1801.08" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="341" y="-1790.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-1779.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-1768.08" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer14_res2&#45;&gt;gpu0_layer15_ln1 -->
<g id="edge307" class="edge">
<title>gpu0_layer14_res2&#45;&gt;gpu0_layer15_ln1</title>
<path fill="none" stroke="black" d="M341,-1849.91C341,-1841.62 341,-1832.23 341,-1823.33"/>
<polygon fill="black" stroke="black" points="344.5,-1823.19 341,-1813.19 337.5,-1823.19 344.5,-1823.19"/>
</g>
<!-- gpu0_layer15_qkv -->
<g id="node245" class="node">
<title>gpu0_layer15_qkv</title>
<polygon fill="lightblue" stroke="black" points="402,-1724.08 280,-1724.08 280,-1672.08 402,-1672.08 402,-1724.08"/>
<text text-anchor="middle" x="341" y="-1712.08" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="341" y="-1701.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-1690.08" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-1679.08" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer15_ln1&#45;&gt;gpu0_layer15_qkv -->
<g id="edge308" class="edge">
<title>gpu0_layer15_ln1&#45;&gt;gpu0_layer15_qkv</title>
<path fill="none" stroke="black" d="M341,-1760.91C341,-1752.62 341,-1743.23 341,-1734.33"/>
<polygon fill="black" stroke="black" points="344.5,-1734.19 341,-1724.19 337.5,-1734.19 344.5,-1734.19"/>
</g>
<!-- gpu0_layer15_reshape -->
<g id="node246" class="node">
<title>gpu0_layer15_reshape</title>
<polygon fill="lightblue" stroke="black" points="405,-1635.08 277,-1635.08 277,-1583.08 405,-1583.08 405,-1635.08"/>
<text text-anchor="middle" x="341" y="-1623.08" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="341" y="-1612.08" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="341" y="-1601.08" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-1590.08" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer15_qkv&#45;&gt;gpu0_layer15_reshape -->
<g id="edge309" class="edge">
<title>gpu0_layer15_qkv&#45;&gt;gpu0_layer15_reshape</title>
<path fill="none" stroke="black" d="M341,-1671.91C341,-1663.62 341,-1654.23 341,-1645.33"/>
<polygon fill="black" stroke="black" points="344.5,-1645.19 341,-1635.19 337.5,-1645.19 344.5,-1645.19"/>
</g>
<!-- gpu0_layer15_attn -->
<g id="node247" class="node">
<title>gpu0_layer15_attn</title>
<polygon fill="lightblue" stroke="black" points="405,-1546.08 277,-1546.08 277,-1494.08 405,-1494.08 405,-1546.08"/>
<text text-anchor="middle" x="341" y="-1534.08" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="341" y="-1523.08" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-1512.08" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-1501.08" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer15_reshape&#45;&gt;gpu0_layer15_attn -->
<g id="edge310" class="edge">
<title>gpu0_layer15_reshape&#45;&gt;gpu0_layer15_attn</title>
<path fill="none" stroke="black" d="M341,-1582.91C341,-1574.62 341,-1565.23 341,-1556.33"/>
<polygon fill="black" stroke="black" points="344.5,-1556.19 341,-1546.19 337.5,-1556.19 344.5,-1556.19"/>
</g>
<!-- gpu0_layer15_attn_reshape -->
<g id="node249" class="node">
<title>gpu0_layer15_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="402,-1457.08 280,-1457.08 280,-1405.08 402,-1405.08 402,-1457.08"/>
<text text-anchor="middle" x="341" y="-1445.08" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="341" y="-1434.08" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-1423.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-1412.08" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer15_attn&#45;&gt;gpu0_layer15_attn_reshape -->
<g id="edge311" class="edge">
<title>gpu0_layer15_attn&#45;&gt;gpu0_layer15_attn_reshape</title>
<path fill="none" stroke="black" d="M341,-1493.91C341,-1485.62 341,-1476.23 341,-1467.33"/>
<polygon fill="black" stroke="black" points="344.5,-1467.19 341,-1457.19 337.5,-1467.19 344.5,-1467.19"/>
</g>
<!-- gpu0_layer15_attn_out -->
<g id="node248" class="node">
<title>gpu0_layer15_attn_out</title>
<polygon fill="lightblue" stroke="black" points="402,-1368.08 280,-1368.08 280,-1316.08 402,-1316.08 402,-1368.08"/>
<text text-anchor="middle" x="341" y="-1356.08" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="341" y="-1345.08" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="341" y="-1334.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-1323.08" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer15_kv_update -->
<g id="node250" class="node">
<title>gpu0_layer15_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="341" cy="-1242.31" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="341" y="-1256.31" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="341" y="-1245.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-1234.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-1223.31" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer15_attn_out&#45;&gt;gpu0_layer15_kv_update -->
<g id="edge313" class="edge">
<title>gpu0_layer15_attn_out&#45;&gt;gpu0_layer15_kv_update</title>
<path fill="none" stroke="black" d="M341,-1315.9C341,-1307.76 341,-1298.46 341,-1289.3"/>
<polygon fill="black" stroke="black" points="344.5,-1289.09 341,-1279.09 337.5,-1289.09 344.5,-1289.09"/>
</g>
<!-- gpu0_layer15_attn_reshape&#45;&gt;gpu0_layer15_attn_out -->
<g id="edge312" class="edge">
<title>gpu0_layer15_attn_reshape&#45;&gt;gpu0_layer15_attn_out</title>
<path fill="none" stroke="black" d="M341,-1404.91C341,-1396.62 341,-1387.23 341,-1378.33"/>
<polygon fill="black" stroke="black" points="344.5,-1378.19 341,-1368.19 337.5,-1378.19 344.5,-1378.19"/>
</g>
<!-- gpu0_layer15_res1 -->
<g id="node251" class="node">
<title>gpu0_layer15_res1</title>
<polygon fill="lightblue" stroke="black" points="402,-1168.54 280,-1168.54 280,-1116.54 402,-1116.54 402,-1168.54"/>
<text text-anchor="middle" x="341" y="-1156.54" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="341" y="-1145.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-1134.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-1123.54" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer15_kv_update&#45;&gt;gpu0_layer15_res1 -->
<g id="edge314" class="edge">
<title>gpu0_layer15_kv_update&#45;&gt;gpu0_layer15_res1</title>
<path fill="none" stroke="black" d="M341,-1205.46C341,-1196.78 341,-1187.51 341,-1178.85"/>
<polygon fill="black" stroke="black" points="344.5,-1178.69 341,-1168.69 337.5,-1178.69 344.5,-1178.69"/>
</g>
<!-- gpu0_layer15_ln2 -->
<g id="node252" class="node">
<title>gpu0_layer15_ln2</title>
<polygon fill="lightblue" stroke="black" points="402,-1079.54 280,-1079.54 280,-1027.54 402,-1027.54 402,-1079.54"/>
<text text-anchor="middle" x="341" y="-1067.54" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="341" y="-1056.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-1045.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-1034.54" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer15_res1&#45;&gt;gpu0_layer15_ln2 -->
<g id="edge315" class="edge">
<title>gpu0_layer15_res1&#45;&gt;gpu0_layer15_ln2</title>
<path fill="none" stroke="black" d="M341,-1116.38C341,-1108.08 341,-1098.69 341,-1089.79"/>
<polygon fill="black" stroke="black" points="344.5,-1089.65 341,-1079.65 337.5,-1089.65 344.5,-1089.65"/>
</g>
<!-- gpu0_layer15_routing -->
<g id="node253" class="node">
<title>gpu0_layer15_routing</title>
<polygon fill="lightyellow" stroke="black" points="467.47,-990.54 266.29,-990.54 214.53,-864.54 415.71,-864.54 467.47,-990.54"/>
<text text-anchor="middle" x="341" y="-947.04" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="341" y="-936.04" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-925.04" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-914.04" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="341" y="-903.04" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer15_ln2&#45;&gt;gpu0_layer15_routing -->
<g id="edge316" class="edge">
<title>gpu0_layer15_ln2&#45;&gt;gpu0_layer15_routing</title>
<path fill="none" stroke="black" d="M341,-1027.45C341,-1019.51 341,-1010.32 341,-1000.79"/>
<polygon fill="black" stroke="black" points="344.5,-1000.77 341,-990.77 337.5,-1000.77 344.5,-1000.77"/>
</g>
<!-- gpu0_layer15_expert0 -->
<g id="node254" class="node">
<title>gpu0_layer15_expert0</title>
<polygon fill="lightblue" stroke="black" points="122,-818.54 0,-818.54 0,-766.54 122,-766.54 122,-818.54"/>
<text text-anchor="middle" x="61" y="-806.54" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="61" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="61" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer15_routing&#45;&gt;gpu0_layer15_expert0 -->
<g id="edge303" class="edge">
<title>gpu0_layer15_routing&#45;&gt;gpu0_layer15_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M215.33,-866.85C183.34,-851.65 150.34,-835.98 123.11,-823.04"/>
<polygon fill="black" stroke="black" points="124.26,-819.71 113.73,-818.58 121.26,-826.04 124.26,-819.71"/>
<text text-anchor="middle" x="197.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer15_expert1 -->
<g id="node255" class="node">
<title>gpu0_layer15_expert1</title>
<polygon fill="lightblue" stroke="black" points="262,-818.54 140,-818.54 140,-766.54 262,-766.54 262,-818.54"/>
<text text-anchor="middle" x="201" y="-806.54" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="201" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="201" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer15_routing&#45;&gt;gpu0_layer15_expert1 -->
<g id="edge304" class="edge">
<title>gpu0_layer15_routing&#45;&gt;gpu0_layer15_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M275.51,-864.32C261.48,-851 247.21,-837.44 234.97,-825.81"/>
<polygon fill="black" stroke="black" points="237.29,-823.18 227.63,-818.83 232.46,-828.26 237.29,-823.18"/>
<text text-anchor="middle" x="284.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer15_expert2 -->
<g id="node256" class="node">
<title>gpu0_layer15_expert2</title>
<polygon fill="lightblue" stroke="black" points="402,-818.54 280,-818.54 280,-766.54 402,-766.54 402,-818.54"/>
<text text-anchor="middle" x="341" y="-806.54" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="341" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="341" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer15_routing&#45;&gt;gpu0_layer15_expert2 -->
<g id="edge305" class="edge">
<title>gpu0_layer15_routing&#45;&gt;gpu0_layer15_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M341,-864.32C341,-852.25 341,-840 341,-829.15"/>
<polygon fill="black" stroke="black" points="344.5,-828.83 341,-818.83 337.5,-828.83 344.5,-828.83"/>
<text text-anchor="middle" x="370.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer15_expert3 -->
<g id="node257" class="node">
<title>gpu0_layer15_expert3</title>
<polygon fill="lightblue" stroke="black" points="542,-818.54 420,-818.54 420,-766.54 542,-766.54 542,-818.54"/>
<text text-anchor="middle" x="481" y="-806.54" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="481" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="481" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer15_routing&#45;&gt;gpu0_layer15_expert3 -->
<g id="edge306" class="edge">
<title>gpu0_layer15_routing&#45;&gt;gpu0_layer15_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M406.49,-864.32C420.52,-851 434.79,-837.44 447.03,-825.81"/>
<polygon fill="black" stroke="black" points="449.54,-828.26 454.37,-818.83 444.71,-823.18 449.54,-828.26"/>
<text text-anchor="middle" x="465.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu0_layer15_expert_agg -->
<g id="node258" class="node">
<title>gpu0_layer15_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="573.47,-729.54 372.29,-729.54 320.53,-625.54 521.71,-625.54 573.47,-729.54"/>
<text text-anchor="middle" x="447" y="-691.54" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="447" y="-680.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="447" y="-669.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="447" y="-658.54" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer15_routing&#45;&gt;gpu0_layer15_expert_agg -->
<g id="edge321" class="edge">
<title>gpu0_layer15_routing&#45;&gt;gpu0_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M432.02,-904.14C476.26,-888.13 525.3,-861.57 551,-818.54 562.85,-798.7 560.72,-787.5 551,-766.54 546.02,-755.81 539.02,-745.92 530.98,-736.94"/>
<polygon fill="black" stroke="black" points="533.44,-734.44 524,-729.62 528.37,-739.27 533.44,-734.44"/>
</g>
<!-- gpu0_layer15_expert0&#45;&gt;gpu0_layer15_expert_agg -->
<g id="edge317" class="edge">
<title>gpu0_layer15_expert0&#45;&gt;gpu0_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M122.38,-769.34C125.29,-768.38 128.17,-767.44 131,-766.54 203.13,-743.65 285.53,-720.81 348.1,-704.14"/>
<polygon fill="black" stroke="black" points="349.2,-707.46 357.96,-701.51 347.4,-700.7 349.2,-707.46"/>
</g>
<!-- gpu0_layer15_expert1&#45;&gt;gpu0_layer15_expert_agg -->
<g id="edge318" class="edge">
<title>gpu0_layer15_expert1&#45;&gt;gpu0_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M255.6,-766.46C285.1,-752.91 322.29,-735.82 356.03,-720.32"/>
<polygon fill="black" stroke="black" points="357.82,-723.35 365.45,-716 354.9,-716.99 357.82,-723.35"/>
</g>
<!-- gpu0_layer15_expert2&#45;&gt;gpu0_layer15_expert_agg -->
<g id="edge319" class="edge">
<title>gpu0_layer15_expert2&#45;&gt;gpu0_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M364.52,-766.46C372.67,-757.78 382.18,-747.64 391.79,-737.4"/>
<polygon fill="black" stroke="black" points="394.49,-739.63 398.78,-729.94 389.39,-734.84 394.49,-739.63"/>
</g>
<!-- gpu0_layer15_expert3&#45;&gt;gpu0_layer15_expert_agg -->
<g id="edge320" class="edge">
<title>gpu0_layer15_expert3&#45;&gt;gpu0_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M473.45,-766.46C471.04,-758.45 468.26,-749.2 465.43,-739.78"/>
<polygon fill="black" stroke="black" points="468.7,-738.51 462.47,-729.94 462,-740.52 468.7,-738.51"/>
</g>
<!-- gpu0_layer15_res2 -->
<g id="node259" class="node">
<title>gpu0_layer15_res2</title>
<polygon fill="lightblue" stroke="black" points="1168,-588.54 1046,-588.54 1046,-536.54 1168,-536.54 1168,-588.54"/>
<text text-anchor="middle" x="1107" y="-576.54" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="1107" y="-565.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1107" y="-554.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1107" y="-543.54" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer15_expert_agg&#45;&gt;gpu0_layer15_res2 -->
<g id="edge322" class="edge">
<title>gpu0_layer15_expert_agg&#45;&gt;gpu0_layer15_res2</title>
<path fill="none" stroke="black" d="M539.47,-660.71C672.53,-637.93 915.2,-596.38 1035.48,-575.78"/>
<polygon fill="black" stroke="black" points="1036.42,-579.17 1045.68,-574.04 1035.24,-572.28 1036.42,-579.17"/>
</g>
<!-- gpu0_final_ln -->
<g id="node260" class="node">
<title>gpu0_final_ln</title>
<polygon fill="lightblue" stroke="black" points="1337,-499.54 1215,-499.54 1215,-447.54 1337,-447.54 1337,-499.54"/>
<text text-anchor="middle" x="1276" y="-487.54" font-family="Arial" font-size="10.00">Final LayerNorm</text>
<text text-anchor="middle" x="1276" y="-476.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1276" y="-465.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1276" y="-454.54" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_layer15_res2&#45;&gt;gpu0_final_ln -->
<g id="edge323" class="edge">
<title>gpu0_layer15_res2&#45;&gt;gpu0_final_ln</title>
<path fill="none" stroke="black" d="M1155.88,-536.38C1175.33,-526.37 1197.85,-514.77 1218.1,-504.34"/>
<polygon fill="black" stroke="black" points="1219.94,-507.34 1227.23,-499.65 1216.74,-501.11 1219.94,-507.34"/>
</g>
<!-- gpu0_output_proj -->
<g id="node261" class="node">
<title>gpu0_output_proj</title>
<polygon fill="lightblue" stroke="black" points="1382,-410.54 1254,-410.54 1254,-358.54 1382,-358.54 1382,-410.54"/>
<text text-anchor="middle" x="1318" y="-398.54" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="1318" y="-387.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1318" y="-376.54" font-family="Arial" font-size="10.00">Output: [256, 512, 32000]</text>
<text text-anchor="middle" x="1318" y="-365.54" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_final_ln&#45;&gt;gpu0_output_proj -->
<g id="edge324" class="edge">
<title>gpu0_final_ln&#45;&gt;gpu0_output_proj</title>
<path fill="none" stroke="black" d="M1288.15,-447.38C1292.28,-438.81 1296.98,-429.08 1301.4,-419.92"/>
<polygon fill="black" stroke="black" points="1304.68,-421.17 1305.88,-410.65 1298.38,-418.13 1304.68,-421.17"/>
</g>
<!-- gpu0_softmax -->
<g id="node262" class="node">
<title>gpu0_softmax</title>
<polygon fill="lightblue" stroke="black" points="1606,-321.54 1478,-321.54 1478,-269.54 1606,-269.54 1606,-321.54"/>
<text text-anchor="middle" x="1542" y="-309.54" font-family="Arial" font-size="10.00">Softmax</text>
<text text-anchor="middle" x="1542" y="-298.54" font-family="Arial" font-size="10.00">Input: [256, 512, 32000]</text>
<text text-anchor="middle" x="1542" y="-287.54" font-family="Arial" font-size="10.00">Output: [256, 512, 32000]</text>
<text text-anchor="middle" x="1542" y="-276.54" font-family="Arial" font-size="10.00">GPU: GPU0</text>
</g>
<!-- gpu0_output_proj&#45;&gt;gpu0_softmax -->
<g id="edge325" class="edge">
<title>gpu0_output_proj&#45;&gt;gpu0_softmax</title>
<path fill="none" stroke="black" d="M1382.19,-358.61C1409.02,-348.19 1440.36,-336.02 1468.14,-325.23"/>
<polygon fill="black" stroke="black" points="1469.75,-328.36 1477.8,-321.47 1467.21,-321.83 1469.75,-328.36"/>
</g>
<!-- dp_aggregate -->
<g id="node2083" class="node">
<title>dp_aggregate</title>
<polygon fill="lightgreen" stroke="black" points="2591.28,-223.54 2315.63,-223.54 2244.72,-119.54 2520.37,-119.54 2591.28,-223.54"/>
<text text-anchor="middle" x="2418" y="-185.54" font-family="Arial" font-size="10.00">Data Parallel Aggregate</text>
<text text-anchor="middle" x="2418" y="-174.54" font-family="Arial" font-size="10.00">Input: [256, 512, 32000] x 8 GPUs</text>
<text text-anchor="middle" x="2418" y="-163.54" font-family="Arial" font-size="10.00">Output: [2048, 512, 32000]</text>
<text text-anchor="middle" x="2418" y="-152.54" font-family="Arial" font-size="10.00">GPU: All</text>
</g>
<!-- gpu0_softmax&#45;&gt;dp_aggregate -->
<g id="edge2594" class="edge">
<title>gpu0_softmax&#45;&gt;dp_aggregate</title>
<path fill="none" stroke="black" d="M1606.27,-271.71C1609.21,-270.93 1612.13,-270.2 1615,-269.54 1842.93,-217.35 2114.08,-192.02 2275.79,-180.68"/>
<polygon fill="black" stroke="black" points="2276.07,-184.17 2285.8,-179.99 2275.59,-177.19 2276.07,-184.17"/>
<text text-anchor="middle" x="1772.5" y="-244.34" font-family="Arial" font-size="9.00">GPU 0 output</text>
</g>
<!-- gpu1_layer0_ln1 -->
<g id="node264" class="node">
<title>gpu1_layer0_ln1</title>
<polygon fill="lightblue" stroke="black" points="2015,-21516.16 1893,-21516.16 1893,-21464.16 2015,-21464.16 2015,-21516.16"/>
<text text-anchor="middle" x="1954" y="-21504.16" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="1954" y="-21493.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1954" y="-21482.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1954" y="-21471.16" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_embed&#45;&gt;gpu1_layer0_ln1 -->
<g id="edge331" class="edge">
<title>gpu1_embed&#45;&gt;gpu1_layer0_ln1</title>
<path fill="none" stroke="black" d="M1964.66,-21553C1963.23,-21544.7 1961.61,-21535.32 1960.08,-21526.41"/>
<polygon fill="black" stroke="black" points="1963.48,-21525.53 1958.33,-21516.27 1956.58,-21526.72 1963.48,-21525.53"/>
</g>
<!-- gpu1_layer0_qkv -->
<g id="node265" class="node">
<title>gpu1_layer0_qkv</title>
<polygon fill="lightblue" stroke="black" points="1999,-21427.16 1877,-21427.16 1877,-21375.16 1999,-21375.16 1999,-21427.16"/>
<text text-anchor="middle" x="1938" y="-21415.16" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1938" y="-21404.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1938" y="-21393.16" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="1938" y="-21382.16" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer0_ln1&#45;&gt;gpu1_layer0_qkv -->
<g id="edge332" class="edge">
<title>gpu1_layer0_ln1&#45;&gt;gpu1_layer0_qkv</title>
<path fill="none" stroke="black" d="M1949.37,-21464C1947.83,-21455.61 1946.08,-21446.12 1944.43,-21437.12"/>
<polygon fill="black" stroke="black" points="1947.87,-21436.47 1942.62,-21427.27 1940.98,-21437.74 1947.87,-21436.47"/>
</g>
<!-- gpu1_layer0_reshape -->
<g id="node266" class="node">
<title>gpu1_layer0_reshape</title>
<polygon fill="lightblue" stroke="black" points="1976,-21338.16 1848,-21338.16 1848,-21286.16 1976,-21286.16 1976,-21338.16"/>
<text text-anchor="middle" x="1912" y="-21326.16" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="1912" y="-21315.16" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="1912" y="-21304.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1912" y="-21293.16" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer0_qkv&#45;&gt;gpu1_layer0_reshape -->
<g id="edge333" class="edge">
<title>gpu1_layer0_qkv&#45;&gt;gpu1_layer0_reshape</title>
<path fill="none" stroke="black" d="M1930.48,-21375C1927.97,-21366.61 1925.13,-21357.12 1922.45,-21348.12"/>
<polygon fill="black" stroke="black" points="1925.72,-21346.85 1919.5,-21338.27 1919.01,-21348.86 1925.72,-21346.85"/>
</g>
<!-- gpu1_layer0_attn -->
<g id="node267" class="node">
<title>gpu1_layer0_attn</title>
<polygon fill="lightblue" stroke="black" points="1909,-21249.16 1781,-21249.16 1781,-21197.16 1909,-21197.16 1909,-21249.16"/>
<text text-anchor="middle" x="1845" y="-21237.16" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1845" y="-21226.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1845" y="-21215.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1845" y="-21204.16" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer0_reshape&#45;&gt;gpu1_layer0_attn -->
<g id="edge334" class="edge">
<title>gpu1_layer0_reshape&#45;&gt;gpu1_layer0_attn</title>
<path fill="none" stroke="black" d="M1892.62,-21286C1885.75,-21277.07 1877.9,-21266.88 1870.59,-21257.39"/>
<polygon fill="black" stroke="black" points="1873.21,-21255.06 1864.34,-21249.27 1867.66,-21259.33 1873.21,-21255.06"/>
</g>
<!-- gpu1_layer0_attn_reshape -->
<g id="node269" class="node">
<title>gpu1_layer0_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1639,-21160.16 1517,-21160.16 1517,-21108.16 1639,-21108.16 1639,-21160.16"/>
<text text-anchor="middle" x="1578" y="-21148.16" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="1578" y="-21137.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1578" y="-21126.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1578" y="-21115.16" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer0_attn&#45;&gt;gpu1_layer0_attn_reshape -->
<g id="edge335" class="edge">
<title>gpu1_layer0_attn&#45;&gt;gpu1_layer0_attn_reshape</title>
<path fill="none" stroke="black" d="M1780.71,-21201.22C1740.99,-21188.28 1689.99,-21171.65 1649.07,-21158.32"/>
<polygon fill="black" stroke="black" points="1650.03,-21154.95 1639.44,-21155.18 1647.86,-21161.61 1650.03,-21154.95"/>
</g>
<!-- gpu1_layer0_attn_out -->
<g id="node268" class="node">
<title>gpu1_layer0_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1615,-21071.16 1493,-21071.16 1493,-21019.16 1615,-21019.16 1615,-21071.16"/>
<text text-anchor="middle" x="1554" y="-21059.16" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="1554" y="-21048.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1554" y="-21037.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1554" y="-21026.16" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer0_kv_update -->
<g id="node270" class="node">
<title>gpu1_layer0_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="1507" cy="-20945.4" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="1507" y="-20959.4" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="1507" y="-20948.4" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1507" y="-20937.4" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1507" y="-20926.4" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer0_attn_out&#45;&gt;gpu1_layer0_kv_update -->
<g id="edge337" class="edge">
<title>gpu1_layer0_attn_out&#45;&gt;gpu1_layer0_kv_update</title>
<path fill="none" stroke="black" d="M1541.9,-21018.99C1537.77,-21010.41 1533.03,-21000.55 1528.4,-20990.92"/>
<polygon fill="black" stroke="black" points="1531.51,-20989.3 1524.02,-20981.8 1525.2,-20992.33 1531.51,-20989.3"/>
</g>
<!-- gpu1_layer0_attn_reshape&#45;&gt;gpu1_layer0_attn_out -->
<g id="edge336" class="edge">
<title>gpu1_layer0_attn_reshape&#45;&gt;gpu1_layer0_attn_out</title>
<path fill="none" stroke="black" d="M1571.06,-21108C1568.74,-21099.61 1566.12,-21090.12 1563.64,-21081.12"/>
<polygon fill="black" stroke="black" points="1566.96,-21079.98 1560.93,-21071.27 1560.21,-21081.84 1566.96,-21079.98"/>
</g>
<!-- gpu1_layer0_res1 -->
<g id="node271" class="node">
<title>gpu1_layer0_res1</title>
<polygon fill="lightblue" stroke="black" points="1345,-20871.63 1223,-20871.63 1223,-20819.63 1345,-20819.63 1345,-20871.63"/>
<text text-anchor="middle" x="1284" y="-20859.63" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="1284" y="-20848.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1284" y="-20837.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1284" y="-20826.63" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer0_kv_update&#45;&gt;gpu1_layer0_res1 -->
<g id="edge338" class="edge">
<title>gpu1_layer0_kv_update&#45;&gt;gpu1_layer0_res1</title>
<path fill="none" stroke="black" d="M1447.83,-20918.45C1417.89,-20905.33 1381.45,-20889.35 1350.54,-20875.8"/>
<polygon fill="black" stroke="black" points="1351.7,-20872.49 1341.14,-20871.68 1348.89,-20878.9 1351.7,-20872.49"/>
</g>
<!-- gpu1_layer0_ln2 -->
<g id="node272" class="node">
<title>gpu1_layer0_ln2</title>
<polygon fill="lightblue" stroke="black" points="1235,-20782.63 1113,-20782.63 1113,-20730.63 1235,-20730.63 1235,-20782.63"/>
<text text-anchor="middle" x="1174" y="-20770.63" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="1174" y="-20759.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1174" y="-20748.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1174" y="-20737.63" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer0_res1&#45;&gt;gpu1_layer0_ln2 -->
<g id="edge339" class="edge">
<title>gpu1_layer0_res1&#45;&gt;gpu1_layer0_ln2</title>
<path fill="none" stroke="black" d="M1252.18,-20819.46C1240.21,-20809.99 1226.45,-20799.11 1213.84,-20789.13"/>
<polygon fill="black" stroke="black" points="1215.76,-20786.19 1205.75,-20782.73 1211.42,-20791.68 1215.76,-20786.19"/>
</g>
<!-- gpu1_layer0_routing -->
<g id="node273" class="node">
<title>gpu1_layer0_routing</title>
<polygon fill="lightyellow" stroke="black" points="1142.47,-20693.63 941.29,-20693.63 889.53,-20567.63 1090.71,-20567.63 1142.47,-20693.63"/>
<text text-anchor="middle" x="1016" y="-20650.13" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="1016" y="-20639.13" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1016" y="-20628.13" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1016" y="-20617.13" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="1016" y="-20606.13" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer0_ln2&#45;&gt;gpu1_layer0_routing -->
<g id="edge340" class="edge">
<title>gpu1_layer0_ln2&#45;&gt;gpu1_layer0_routing</title>
<path fill="none" stroke="black" d="M1142.03,-20730.53C1130.64,-20721.6 1117.21,-20711.06 1103.44,-20700.25"/>
<polygon fill="black" stroke="black" points="1105.33,-20697.28 1095.3,-20693.86 1101.01,-20702.79 1105.33,-20697.28"/>
</g>
<!-- gpu1_layer0_expert0 -->
<g id="node274" class="node">
<title>gpu1_layer0_expert0</title>
<polygon fill="lightblue" stroke="black" points="720,-20521.63 598,-20521.63 598,-20469.63 720,-20469.63 720,-20521.63"/>
<text text-anchor="middle" x="659" y="-20509.63" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="659" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer0_routing&#45;&gt;gpu1_layer0_expert0 -->
<g id="edge327" class="edge">
<title>gpu1_layer0_routing&#45;&gt;gpu1_layer0_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M896.63,-20585.15C841.25,-20564.52 777.32,-20540.71 729.73,-20522.98"/>
<polygon fill="black" stroke="black" points="730.73,-20519.61 720.13,-20519.4 728.28,-20526.17 730.73,-20519.61"/>
<text text-anchor="middle" x="825.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer0_expert1 -->
<g id="node275" class="node">
<title>gpu1_layer0_expert1</title>
<polygon fill="lightblue" stroke="black" points="860,-20521.63 738,-20521.63 738,-20469.63 860,-20469.63 860,-20521.63"/>
<text text-anchor="middle" x="799" y="-20509.63" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="799" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer0_routing&#45;&gt;gpu1_layer0_expert1 -->
<g id="edge328" class="edge">
<title>gpu1_layer0_routing&#45;&gt;gpu1_layer0_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M914.81,-20567.6C891.81,-20553.51 868.37,-20539.14 848.66,-20527.06"/>
<polygon fill="black" stroke="black" points="850.23,-20523.92 839.87,-20521.68 846.57,-20529.89 850.23,-20523.92"/>
<text text-anchor="middle" x="911.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer0_expert2 -->
<g id="node276" class="node">
<title>gpu1_layer0_expert2</title>
<polygon fill="lightblue" stroke="black" points="1000,-20521.63 878,-20521.63 878,-20469.63 1000,-20469.63 1000,-20521.63"/>
<text text-anchor="middle" x="939" y="-20509.63" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="939" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer0_routing&#45;&gt;gpu1_layer0_expert2 -->
<g id="edge329" class="edge">
<title>gpu1_layer0_routing&#45;&gt;gpu1_layer0_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M979.98,-20567.41C972.7,-20554.84 965.31,-20542.06 958.84,-20530.89"/>
<polygon fill="black" stroke="black" points="961.68,-20528.82 953.64,-20521.92 955.63,-20532.33 961.68,-20528.82"/>
<text text-anchor="middle" x="998.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer0_expert3 -->
<g id="node277" class="node">
<title>gpu1_layer0_expert3</title>
<polygon fill="lightblue" stroke="black" points="1140,-20521.63 1018,-20521.63 1018,-20469.63 1140,-20469.63 1140,-20521.63"/>
<text text-anchor="middle" x="1079" y="-20509.63" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1079" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer0_routing&#45;&gt;gpu1_layer0_expert3 -->
<g id="edge330" class="edge">
<title>gpu1_layer0_routing&#45;&gt;gpu1_layer0_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1045.47,-20567.41C1051.37,-20554.96 1057.36,-20542.32 1062.61,-20531.22"/>
<polygon fill="black" stroke="black" points="1065.9,-20532.46 1067.02,-20521.92 1059.57,-20529.46 1065.9,-20532.46"/>
<text text-anchor="middle" x="1088.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer0_expert_agg -->
<g id="node278" class="node">
<title>gpu1_layer0_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-20432.63 864.29,-20432.63 812.53,-20328.63 1013.71,-20328.63 1065.47,-20432.63"/>
<text text-anchor="middle" x="939" y="-20394.63" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="939" y="-20383.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-20372.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-20361.63" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer0_routing&#45;&gt;gpu1_layer0_expert_agg -->
<g id="edge345" class="edge">
<title>gpu1_layer0_routing&#45;&gt;gpu1_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M1097.03,-20582.01C1138.67,-20551.25 1175.61,-20509.63 1149,-20469.63 1128.44,-20438.71 1094.7,-20418.64 1060.22,-20405.61"/>
<polygon fill="black" stroke="black" points="1061.08,-20402.2 1050.48,-20402.12 1058.71,-20408.79 1061.08,-20402.2"/>
</g>
<!-- gpu1_layer0_expert0&#45;&gt;gpu1_layer0_expert_agg -->
<g id="edge341" class="edge">
<title>gpu1_layer0_expert0&#45;&gt;gpu1_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M720.1,-20469.97C756.98,-20455.08 804.7,-20435.83 846.16,-20419.09"/>
<polygon fill="black" stroke="black" points="847.5,-20422.33 855.46,-20415.34 844.88,-20415.84 847.5,-20422.33"/>
</g>
<!-- gpu1_layer0_expert1&#45;&gt;gpu1_layer0_expert_agg -->
<g id="edge342" class="edge">
<title>gpu1_layer0_expert1&#45;&gt;gpu1_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M830.07,-20469.55C841.32,-20460.47 854.53,-20449.81 867.8,-20439.1"/>
<polygon fill="black" stroke="black" points="870.02,-20441.8 875.6,-20432.8 865.62,-20436.35 870.02,-20441.8"/>
</g>
<!-- gpu1_layer0_expert2&#45;&gt;gpu1_layer0_expert_agg -->
<g id="edge343" class="edge">
<title>gpu1_layer0_expert2&#45;&gt;gpu1_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M939,-20469.55C939,-20461.62 939,-20452.48 939,-20443.16"/>
<polygon fill="black" stroke="black" points="942.5,-20443.03 939,-20433.03 935.5,-20443.03 942.5,-20443.03"/>
</g>
<!-- gpu1_layer0_expert3&#45;&gt;gpu1_layer0_expert_agg -->
<g id="edge344" class="edge">
<title>gpu1_layer0_expert3&#45;&gt;gpu1_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M1047.93,-20469.55C1036.68,-20460.47 1023.47,-20449.81 1010.2,-20439.1"/>
<polygon fill="black" stroke="black" points="1012.38,-20436.35 1002.4,-20432.8 1007.98,-20441.8 1012.38,-20436.35"/>
</g>
<!-- gpu1_layer0_res2 -->
<g id="node279" class="node">
<title>gpu1_layer0_res2</title>
<polygon fill="lightblue" stroke="black" points="1000,-20291.63 878,-20291.63 878,-20239.63 1000,-20239.63 1000,-20291.63"/>
<text text-anchor="middle" x="939" y="-20279.63" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="939" y="-20268.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-20257.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-20246.63" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer0_expert_agg&#45;&gt;gpu1_layer0_res2 -->
<g id="edge346" class="edge">
<title>gpu1_layer0_expert_agg&#45;&gt;gpu1_layer0_res2</title>
<path fill="none" stroke="black" d="M939,-20328.42C939,-20319.46 939,-20310.34 939,-20301.94"/>
<polygon fill="black" stroke="black" points="942.5,-20301.76 939,-20291.76 935.5,-20301.76 942.5,-20301.76"/>
</g>
<!-- gpu1_layer1_ln1 -->
<g id="node280" class="node">
<title>gpu1_layer1_ln1</title>
<polygon fill="lightblue" stroke="black" points="1000,-20202.63 878,-20202.63 878,-20150.63 1000,-20150.63 1000,-20202.63"/>
<text text-anchor="middle" x="939" y="-20190.63" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="939" y="-20179.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-20168.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-20157.63" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer0_res2&#45;&gt;gpu1_layer1_ln1 -->
<g id="edge351" class="edge">
<title>gpu1_layer0_res2&#45;&gt;gpu1_layer1_ln1</title>
<path fill="none" stroke="black" d="M939,-20239.46C939,-20231.17 939,-20221.78 939,-20212.87"/>
<polygon fill="black" stroke="black" points="942.5,-20212.73 939,-20202.73 935.5,-20212.73 942.5,-20212.73"/>
</g>
<!-- gpu1_layer1_qkv -->
<g id="node281" class="node">
<title>gpu1_layer1_qkv</title>
<polygon fill="lightblue" stroke="black" points="1000,-20113.63 878,-20113.63 878,-20061.63 1000,-20061.63 1000,-20113.63"/>
<text text-anchor="middle" x="939" y="-20101.63" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="939" y="-20090.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-20079.63" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-20068.63" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer1_ln1&#45;&gt;gpu1_layer1_qkv -->
<g id="edge352" class="edge">
<title>gpu1_layer1_ln1&#45;&gt;gpu1_layer1_qkv</title>
<path fill="none" stroke="black" d="M939,-20150.46C939,-20142.17 939,-20132.78 939,-20123.87"/>
<polygon fill="black" stroke="black" points="942.5,-20123.73 939,-20113.73 935.5,-20123.73 942.5,-20123.73"/>
</g>
<!-- gpu1_layer1_reshape -->
<g id="node282" class="node">
<title>gpu1_layer1_reshape</title>
<polygon fill="lightblue" stroke="black" points="1003,-20024.63 875,-20024.63 875,-19972.63 1003,-19972.63 1003,-20024.63"/>
<text text-anchor="middle" x="939" y="-20012.63" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="939" y="-20001.63" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-19990.63" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-19979.63" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer1_qkv&#45;&gt;gpu1_layer1_reshape -->
<g id="edge353" class="edge">
<title>gpu1_layer1_qkv&#45;&gt;gpu1_layer1_reshape</title>
<path fill="none" stroke="black" d="M939,-20061.46C939,-20053.17 939,-20043.78 939,-20034.87"/>
<polygon fill="black" stroke="black" points="942.5,-20034.73 939,-20024.73 935.5,-20034.73 942.5,-20034.73"/>
</g>
<!-- gpu1_layer1_attn -->
<g id="node283" class="node">
<title>gpu1_layer1_attn</title>
<polygon fill="lightblue" stroke="black" points="1003,-19935.63 875,-19935.63 875,-19883.63 1003,-19883.63 1003,-19935.63"/>
<text text-anchor="middle" x="939" y="-19923.63" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="939" y="-19912.63" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-19901.63" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-19890.63" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer1_reshape&#45;&gt;gpu1_layer1_attn -->
<g id="edge354" class="edge">
<title>gpu1_layer1_reshape&#45;&gt;gpu1_layer1_attn</title>
<path fill="none" stroke="black" d="M939,-19972.46C939,-19964.17 939,-19954.78 939,-19945.87"/>
<polygon fill="black" stroke="black" points="942.5,-19945.73 939,-19935.73 935.5,-19945.73 942.5,-19945.73"/>
</g>
<!-- gpu1_layer1_attn_reshape -->
<g id="node285" class="node">
<title>gpu1_layer1_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1000,-19846.63 878,-19846.63 878,-19794.63 1000,-19794.63 1000,-19846.63"/>
<text text-anchor="middle" x="939" y="-19834.63" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="939" y="-19823.63" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-19812.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-19801.63" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer1_attn&#45;&gt;gpu1_layer1_attn_reshape -->
<g id="edge355" class="edge">
<title>gpu1_layer1_attn&#45;&gt;gpu1_layer1_attn_reshape</title>
<path fill="none" stroke="black" d="M939,-19883.46C939,-19875.17 939,-19865.78 939,-19856.87"/>
<polygon fill="black" stroke="black" points="942.5,-19856.73 939,-19846.73 935.5,-19856.73 942.5,-19856.73"/>
</g>
<!-- gpu1_layer1_attn_out -->
<g id="node284" class="node">
<title>gpu1_layer1_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1000,-19757.63 878,-19757.63 878,-19705.63 1000,-19705.63 1000,-19757.63"/>
<text text-anchor="middle" x="939" y="-19745.63" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="939" y="-19734.63" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-19723.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-19712.63" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer1_kv_update -->
<g id="node286" class="node">
<title>gpu1_layer1_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="939" cy="-19631.86" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="939" y="-19645.86" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="939" y="-19634.86" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-19623.86" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-19612.86" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer1_attn_out&#45;&gt;gpu1_layer1_kv_update -->
<g id="edge357" class="edge">
<title>gpu1_layer1_attn_out&#45;&gt;gpu1_layer1_kv_update</title>
<path fill="none" stroke="black" d="M939,-19705.45C939,-19697.31 939,-19688.01 939,-19678.85"/>
<polygon fill="black" stroke="black" points="942.5,-19678.64 939,-19668.64 935.5,-19678.64 942.5,-19678.64"/>
</g>
<!-- gpu1_layer1_attn_reshape&#45;&gt;gpu1_layer1_attn_out -->
<g id="edge356" class="edge">
<title>gpu1_layer1_attn_reshape&#45;&gt;gpu1_layer1_attn_out</title>
<path fill="none" stroke="black" d="M939,-19794.46C939,-19786.17 939,-19776.78 939,-19767.87"/>
<polygon fill="black" stroke="black" points="942.5,-19767.73 939,-19757.73 935.5,-19767.73 942.5,-19767.73"/>
</g>
<!-- gpu1_layer1_res1 -->
<g id="node287" class="node">
<title>gpu1_layer1_res1</title>
<polygon fill="lightblue" stroke="black" points="1000,-19558.09 878,-19558.09 878,-19506.09 1000,-19506.09 1000,-19558.09"/>
<text text-anchor="middle" x="939" y="-19546.09" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="939" y="-19535.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-19524.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-19513.09" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer1_kv_update&#45;&gt;gpu1_layer1_res1 -->
<g id="edge358" class="edge">
<title>gpu1_layer1_kv_update&#45;&gt;gpu1_layer1_res1</title>
<path fill="none" stroke="black" d="M939,-19595.01C939,-19586.33 939,-19577.06 939,-19568.4"/>
<polygon fill="black" stroke="black" points="942.5,-19568.23 939,-19558.23 935.5,-19568.23 942.5,-19568.23"/>
</g>
<!-- gpu1_layer1_ln2 -->
<g id="node288" class="node">
<title>gpu1_layer1_ln2</title>
<polygon fill="lightblue" stroke="black" points="1000,-19469.09 878,-19469.09 878,-19417.09 1000,-19417.09 1000,-19469.09"/>
<text text-anchor="middle" x="939" y="-19457.09" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="939" y="-19446.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-19435.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-19424.09" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer1_res1&#45;&gt;gpu1_layer1_ln2 -->
<g id="edge359" class="edge">
<title>gpu1_layer1_res1&#45;&gt;gpu1_layer1_ln2</title>
<path fill="none" stroke="black" d="M939,-19505.92C939,-19497.63 939,-19488.24 939,-19479.34"/>
<polygon fill="black" stroke="black" points="942.5,-19479.19 939,-19469.19 935.5,-19479.19 942.5,-19479.19"/>
</g>
<!-- gpu1_layer1_routing -->
<g id="node289" class="node">
<title>gpu1_layer1_routing</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-19380.09 864.29,-19380.09 812.53,-19254.09 1013.71,-19254.09 1065.47,-19380.09"/>
<text text-anchor="middle" x="939" y="-19336.59" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="939" y="-19325.59" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-19314.59" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-19303.59" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="939" y="-19292.59" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer1_ln2&#45;&gt;gpu1_layer1_routing -->
<g id="edge360" class="edge">
<title>gpu1_layer1_ln2&#45;&gt;gpu1_layer1_routing</title>
<path fill="none" stroke="black" d="M939,-19416.99C939,-19409.06 939,-19399.86 939,-19390.33"/>
<polygon fill="black" stroke="black" points="942.5,-19390.32 939,-19380.32 935.5,-19390.32 942.5,-19390.32"/>
</g>
<!-- gpu1_layer1_expert0 -->
<g id="node290" class="node">
<title>gpu1_layer1_expert0</title>
<polygon fill="lightblue" stroke="black" points="720,-19208.09 598,-19208.09 598,-19156.09 720,-19156.09 720,-19208.09"/>
<text text-anchor="middle" x="659" y="-19196.09" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="659" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer1_routing&#45;&gt;gpu1_layer1_expert0 -->
<g id="edge347" class="edge">
<title>gpu1_layer1_routing&#45;&gt;gpu1_layer1_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M813.33,-19256.39C781.34,-19241.2 748.34,-19225.52 721.11,-19212.59"/>
<polygon fill="black" stroke="black" points="722.26,-19209.26 711.73,-19208.13 719.26,-19215.58 722.26,-19209.26"/>
<text text-anchor="middle" x="795.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer1_expert1 -->
<g id="node291" class="node">
<title>gpu1_layer1_expert1</title>
<polygon fill="lightblue" stroke="black" points="860,-19208.09 738,-19208.09 738,-19156.09 860,-19156.09 860,-19208.09"/>
<text text-anchor="middle" x="799" y="-19196.09" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="799" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer1_routing&#45;&gt;gpu1_layer1_expert1 -->
<g id="edge348" class="edge">
<title>gpu1_layer1_routing&#45;&gt;gpu1_layer1_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M873.51,-19253.87C859.48,-19240.55 845.21,-19226.99 832.97,-19215.36"/>
<polygon fill="black" stroke="black" points="835.29,-19212.73 825.63,-19208.38 830.46,-19217.81 835.29,-19212.73"/>
<text text-anchor="middle" x="882.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer1_expert2 -->
<g id="node292" class="node">
<title>gpu1_layer1_expert2</title>
<polygon fill="lightblue" stroke="black" points="1000,-19208.09 878,-19208.09 878,-19156.09 1000,-19156.09 1000,-19208.09"/>
<text text-anchor="middle" x="939" y="-19196.09" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="939" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer1_routing&#45;&gt;gpu1_layer1_expert2 -->
<g id="edge349" class="edge">
<title>gpu1_layer1_routing&#45;&gt;gpu1_layer1_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M939,-19253.87C939,-19241.8 939,-19229.55 939,-19218.7"/>
<polygon fill="black" stroke="black" points="942.5,-19218.38 939,-19208.38 935.5,-19218.38 942.5,-19218.38"/>
<text text-anchor="middle" x="968.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer1_expert3 -->
<g id="node293" class="node">
<title>gpu1_layer1_expert3</title>
<polygon fill="lightblue" stroke="black" points="1140,-19208.09 1018,-19208.09 1018,-19156.09 1140,-19156.09 1140,-19208.09"/>
<text text-anchor="middle" x="1079" y="-19196.09" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1079" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer1_routing&#45;&gt;gpu1_layer1_expert3 -->
<g id="edge350" class="edge">
<title>gpu1_layer1_routing&#45;&gt;gpu1_layer1_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1004.49,-19253.87C1018.52,-19240.55 1032.79,-19226.99 1045.03,-19215.36"/>
<polygon fill="black" stroke="black" points="1047.54,-19217.81 1052.37,-19208.38 1042.71,-19212.73 1047.54,-19217.81"/>
<text text-anchor="middle" x="1063.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer1_expert_agg -->
<g id="node294" class="node">
<title>gpu1_layer1_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-19119.09 864.29,-19119.09 812.53,-19015.09 1013.71,-19015.09 1065.47,-19119.09"/>
<text text-anchor="middle" x="939" y="-19081.09" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="939" y="-19070.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-19059.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-19048.09" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer1_routing&#45;&gt;gpu1_layer1_expert_agg -->
<g id="edge365" class="edge">
<title>gpu1_layer1_routing&#45;&gt;gpu1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M1028.22,-19289.17C1101.96,-19262.01 1188.6,-19215.62 1149,-19156.09 1128.44,-19125.17 1094.7,-19105.1 1060.22,-19092.07"/>
<polygon fill="black" stroke="black" points="1061.08,-19088.66 1050.48,-19088.58 1058.71,-19095.25 1061.08,-19088.66"/>
</g>
<!-- gpu1_layer1_expert0&#45;&gt;gpu1_layer1_expert_agg -->
<g id="edge361" class="edge">
<title>gpu1_layer1_expert0&#45;&gt;gpu1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M720.1,-19156.43C756.98,-19141.55 804.7,-19122.29 846.16,-19105.55"/>
<polygon fill="black" stroke="black" points="847.5,-19108.79 855.46,-19101.8 844.88,-19102.3 847.5,-19108.79"/>
</g>
<!-- gpu1_layer1_expert1&#45;&gt;gpu1_layer1_expert_agg -->
<g id="edge362" class="edge">
<title>gpu1_layer1_expert1&#45;&gt;gpu1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M830.07,-19156.01C841.32,-19146.93 854.53,-19136.27 867.8,-19125.56"/>
<polygon fill="black" stroke="black" points="870.02,-19128.26 875.6,-19119.26 865.62,-19122.82 870.02,-19128.26"/>
</g>
<!-- gpu1_layer1_expert2&#45;&gt;gpu1_layer1_expert_agg -->
<g id="edge363" class="edge">
<title>gpu1_layer1_expert2&#45;&gt;gpu1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M939,-19156.01C939,-19148.08 939,-19138.95 939,-19129.62"/>
<polygon fill="black" stroke="black" points="942.5,-19129.49 939,-19119.49 935.5,-19129.49 942.5,-19129.49"/>
</g>
<!-- gpu1_layer1_expert3&#45;&gt;gpu1_layer1_expert_agg -->
<g id="edge364" class="edge">
<title>gpu1_layer1_expert3&#45;&gt;gpu1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M1047.93,-19156.01C1036.68,-19146.93 1023.47,-19136.27 1010.2,-19125.56"/>
<polygon fill="black" stroke="black" points="1012.38,-19122.82 1002.4,-19119.26 1007.98,-19128.26 1012.38,-19122.82"/>
</g>
<!-- gpu1_layer1_res2 -->
<g id="node295" class="node">
<title>gpu1_layer1_res2</title>
<polygon fill="lightblue" stroke="black" points="1000,-18978.09 878,-18978.09 878,-18926.09 1000,-18926.09 1000,-18978.09"/>
<text text-anchor="middle" x="939" y="-18966.09" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="939" y="-18955.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-18944.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-18933.09" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer1_expert_agg&#45;&gt;gpu1_layer1_res2 -->
<g id="edge366" class="edge">
<title>gpu1_layer1_expert_agg&#45;&gt;gpu1_layer1_res2</title>
<path fill="none" stroke="black" d="M939,-19014.88C939,-19005.93 939,-18996.8 939,-18988.4"/>
<polygon fill="black" stroke="black" points="942.5,-18988.22 939,-18978.22 935.5,-18988.22 942.5,-18988.22"/>
</g>
<!-- gpu1_layer2_ln1 -->
<g id="node296" class="node">
<title>gpu1_layer2_ln1</title>
<polygon fill="lightblue" stroke="black" points="1000,-18889.09 878,-18889.09 878,-18837.09 1000,-18837.09 1000,-18889.09"/>
<text text-anchor="middle" x="939" y="-18877.09" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="939" y="-18866.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-18855.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-18844.09" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer1_res2&#45;&gt;gpu1_layer2_ln1 -->
<g id="edge371" class="edge">
<title>gpu1_layer1_res2&#45;&gt;gpu1_layer2_ln1</title>
<path fill="none" stroke="black" d="M939,-18925.92C939,-18917.63 939,-18908.24 939,-18899.34"/>
<polygon fill="black" stroke="black" points="942.5,-18899.19 939,-18889.19 935.5,-18899.19 942.5,-18899.19"/>
</g>
<!-- gpu1_layer2_qkv -->
<g id="node297" class="node">
<title>gpu1_layer2_qkv</title>
<polygon fill="lightblue" stroke="black" points="1000,-18800.09 878,-18800.09 878,-18748.09 1000,-18748.09 1000,-18800.09"/>
<text text-anchor="middle" x="939" y="-18788.09" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="939" y="-18777.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-18766.09" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-18755.09" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer2_ln1&#45;&gt;gpu1_layer2_qkv -->
<g id="edge372" class="edge">
<title>gpu1_layer2_ln1&#45;&gt;gpu1_layer2_qkv</title>
<path fill="none" stroke="black" d="M939,-18836.92C939,-18828.63 939,-18819.24 939,-18810.34"/>
<polygon fill="black" stroke="black" points="942.5,-18810.19 939,-18800.19 935.5,-18810.19 942.5,-18810.19"/>
</g>
<!-- gpu1_layer2_reshape -->
<g id="node298" class="node">
<title>gpu1_layer2_reshape</title>
<polygon fill="lightblue" stroke="black" points="1003,-18711.09 875,-18711.09 875,-18659.09 1003,-18659.09 1003,-18711.09"/>
<text text-anchor="middle" x="939" y="-18699.09" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="939" y="-18688.09" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-18677.09" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-18666.09" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer2_qkv&#45;&gt;gpu1_layer2_reshape -->
<g id="edge373" class="edge">
<title>gpu1_layer2_qkv&#45;&gt;gpu1_layer2_reshape</title>
<path fill="none" stroke="black" d="M939,-18747.92C939,-18739.63 939,-18730.24 939,-18721.34"/>
<polygon fill="black" stroke="black" points="942.5,-18721.19 939,-18711.19 935.5,-18721.19 942.5,-18721.19"/>
</g>
<!-- gpu1_layer2_attn -->
<g id="node299" class="node">
<title>gpu1_layer2_attn</title>
<polygon fill="lightblue" stroke="black" points="1003,-18622.09 875,-18622.09 875,-18570.09 1003,-18570.09 1003,-18622.09"/>
<text text-anchor="middle" x="939" y="-18610.09" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="939" y="-18599.09" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-18588.09" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-18577.09" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer2_reshape&#45;&gt;gpu1_layer2_attn -->
<g id="edge374" class="edge">
<title>gpu1_layer2_reshape&#45;&gt;gpu1_layer2_attn</title>
<path fill="none" stroke="black" d="M939,-18658.92C939,-18650.63 939,-18641.24 939,-18632.34"/>
<polygon fill="black" stroke="black" points="942.5,-18632.19 939,-18622.19 935.5,-18632.19 942.5,-18632.19"/>
</g>
<!-- gpu1_layer2_attn_reshape -->
<g id="node301" class="node">
<title>gpu1_layer2_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1000,-18533.09 878,-18533.09 878,-18481.09 1000,-18481.09 1000,-18533.09"/>
<text text-anchor="middle" x="939" y="-18521.09" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="939" y="-18510.09" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-18499.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-18488.09" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer2_attn&#45;&gt;gpu1_layer2_attn_reshape -->
<g id="edge375" class="edge">
<title>gpu1_layer2_attn&#45;&gt;gpu1_layer2_attn_reshape</title>
<path fill="none" stroke="black" d="M939,-18569.92C939,-18561.63 939,-18552.24 939,-18543.34"/>
<polygon fill="black" stroke="black" points="942.5,-18543.19 939,-18533.19 935.5,-18543.19 942.5,-18543.19"/>
</g>
<!-- gpu1_layer2_attn_out -->
<g id="node300" class="node">
<title>gpu1_layer2_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1000,-18444.09 878,-18444.09 878,-18392.09 1000,-18392.09 1000,-18444.09"/>
<text text-anchor="middle" x="939" y="-18432.09" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="939" y="-18421.09" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-18410.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-18399.09" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer2_kv_update -->
<g id="node302" class="node">
<title>gpu1_layer2_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="939" cy="-18318.32" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="939" y="-18332.32" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="939" y="-18321.32" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-18310.32" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-18299.32" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer2_attn_out&#45;&gt;gpu1_layer2_kv_update -->
<g id="edge377" class="edge">
<title>gpu1_layer2_attn_out&#45;&gt;gpu1_layer2_kv_update</title>
<path fill="none" stroke="black" d="M939,-18391.91C939,-18383.77 939,-18374.47 939,-18365.31"/>
<polygon fill="black" stroke="black" points="942.5,-18365.1 939,-18355.1 935.5,-18365.1 942.5,-18365.1"/>
</g>
<!-- gpu1_layer2_attn_reshape&#45;&gt;gpu1_layer2_attn_out -->
<g id="edge376" class="edge">
<title>gpu1_layer2_attn_reshape&#45;&gt;gpu1_layer2_attn_out</title>
<path fill="none" stroke="black" d="M939,-18480.92C939,-18472.63 939,-18463.24 939,-18454.34"/>
<polygon fill="black" stroke="black" points="942.5,-18454.19 939,-18444.19 935.5,-18454.19 942.5,-18454.19"/>
</g>
<!-- gpu1_layer2_res1 -->
<g id="node303" class="node">
<title>gpu1_layer2_res1</title>
<polygon fill="lightblue" stroke="black" points="1000,-18244.55 878,-18244.55 878,-18192.55 1000,-18192.55 1000,-18244.55"/>
<text text-anchor="middle" x="939" y="-18232.55" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="939" y="-18221.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-18210.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-18199.55" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer2_kv_update&#45;&gt;gpu1_layer2_res1 -->
<g id="edge378" class="edge">
<title>gpu1_layer2_kv_update&#45;&gt;gpu1_layer2_res1</title>
<path fill="none" stroke="black" d="M939,-18281.47C939,-18272.79 939,-18263.52 939,-18254.86"/>
<polygon fill="black" stroke="black" points="942.5,-18254.69 939,-18244.69 935.5,-18254.69 942.5,-18254.69"/>
</g>
<!-- gpu1_layer2_ln2 -->
<g id="node304" class="node">
<title>gpu1_layer2_ln2</title>
<polygon fill="lightblue" stroke="black" points="1000,-18155.55 878,-18155.55 878,-18103.55 1000,-18103.55 1000,-18155.55"/>
<text text-anchor="middle" x="939" y="-18143.55" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="939" y="-18132.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-18121.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-18110.55" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer2_res1&#45;&gt;gpu1_layer2_ln2 -->
<g id="edge379" class="edge">
<title>gpu1_layer2_res1&#45;&gt;gpu1_layer2_ln2</title>
<path fill="none" stroke="black" d="M939,-18192.38C939,-18184.09 939,-18174.7 939,-18165.8"/>
<polygon fill="black" stroke="black" points="942.5,-18165.65 939,-18155.65 935.5,-18165.65 942.5,-18165.65"/>
</g>
<!-- gpu1_layer2_routing -->
<g id="node305" class="node">
<title>gpu1_layer2_routing</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-18066.55 864.29,-18066.55 812.53,-17940.55 1013.71,-17940.55 1065.47,-18066.55"/>
<text text-anchor="middle" x="939" y="-18023.05" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="939" y="-18012.05" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-18001.05" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-17990.05" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="939" y="-17979.05" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer2_ln2&#45;&gt;gpu1_layer2_routing -->
<g id="edge380" class="edge">
<title>gpu1_layer2_ln2&#45;&gt;gpu1_layer2_routing</title>
<path fill="none" stroke="black" d="M939,-18103.45C939,-18095.52 939,-18086.33 939,-18076.8"/>
<polygon fill="black" stroke="black" points="942.5,-18076.78 939,-18066.78 935.5,-18076.78 942.5,-18076.78"/>
</g>
<!-- gpu1_layer2_expert0 -->
<g id="node306" class="node">
<title>gpu1_layer2_expert0</title>
<polygon fill="lightblue" stroke="black" points="720,-17894.55 598,-17894.55 598,-17842.55 720,-17842.55 720,-17894.55"/>
<text text-anchor="middle" x="659" y="-17882.55" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="659" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer2_routing&#45;&gt;gpu1_layer2_expert0 -->
<g id="edge367" class="edge">
<title>gpu1_layer2_routing&#45;&gt;gpu1_layer2_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M813.33,-17942.86C781.34,-17927.66 748.34,-17911.98 721.11,-17899.05"/>
<polygon fill="black" stroke="black" points="722.26,-17895.72 711.73,-17894.59 719.26,-17902.04 722.26,-17895.72"/>
<text text-anchor="middle" x="795.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer2_expert1 -->
<g id="node307" class="node">
<title>gpu1_layer2_expert1</title>
<polygon fill="lightblue" stroke="black" points="860,-17894.55 738,-17894.55 738,-17842.55 860,-17842.55 860,-17894.55"/>
<text text-anchor="middle" x="799" y="-17882.55" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="799" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer2_routing&#45;&gt;gpu1_layer2_expert1 -->
<g id="edge368" class="edge">
<title>gpu1_layer2_routing&#45;&gt;gpu1_layer2_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M873.51,-17940.33C859.48,-17927.01 845.21,-17913.45 832.97,-17901.82"/>
<polygon fill="black" stroke="black" points="835.29,-17899.19 825.63,-17894.84 830.46,-17904.27 835.29,-17899.19"/>
<text text-anchor="middle" x="882.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer2_expert2 -->
<g id="node308" class="node">
<title>gpu1_layer2_expert2</title>
<polygon fill="lightblue" stroke="black" points="1000,-17894.55 878,-17894.55 878,-17842.55 1000,-17842.55 1000,-17894.55"/>
<text text-anchor="middle" x="939" y="-17882.55" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="939" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer2_routing&#45;&gt;gpu1_layer2_expert2 -->
<g id="edge369" class="edge">
<title>gpu1_layer2_routing&#45;&gt;gpu1_layer2_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M939,-17940.33C939,-17928.26 939,-17916.01 939,-17905.16"/>
<polygon fill="black" stroke="black" points="942.5,-17904.84 939,-17894.84 935.5,-17904.84 942.5,-17904.84"/>
<text text-anchor="middle" x="968.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer2_expert3 -->
<g id="node309" class="node">
<title>gpu1_layer2_expert3</title>
<polygon fill="lightblue" stroke="black" points="1140,-17894.55 1018,-17894.55 1018,-17842.55 1140,-17842.55 1140,-17894.55"/>
<text text-anchor="middle" x="1079" y="-17882.55" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1079" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer2_routing&#45;&gt;gpu1_layer2_expert3 -->
<g id="edge370" class="edge">
<title>gpu1_layer2_routing&#45;&gt;gpu1_layer2_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1004.49,-17940.33C1018.52,-17927.01 1032.79,-17913.45 1045.03,-17901.82"/>
<polygon fill="black" stroke="black" points="1047.54,-17904.27 1052.37,-17894.84 1042.71,-17899.19 1047.54,-17904.27"/>
<text text-anchor="middle" x="1063.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer2_expert_agg -->
<g id="node310" class="node">
<title>gpu1_layer2_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-17805.55 864.29,-17805.55 812.53,-17701.55 1013.71,-17701.55 1065.47,-17805.55"/>
<text text-anchor="middle" x="939" y="-17767.55" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="939" y="-17756.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-17745.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-17734.55" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer2_routing&#45;&gt;gpu1_layer2_expert_agg -->
<g id="edge385" class="edge">
<title>gpu1_layer2_routing&#45;&gt;gpu1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M1028.22,-17975.63C1101.96,-17948.47 1188.6,-17902.08 1149,-17842.55 1128.44,-17811.64 1094.7,-17791.56 1060.22,-17778.53"/>
<polygon fill="black" stroke="black" points="1061.08,-17775.12 1050.48,-17775.04 1058.71,-17781.71 1061.08,-17775.12"/>
</g>
<!-- gpu1_layer2_expert0&#45;&gt;gpu1_layer2_expert_agg -->
<g id="edge381" class="edge">
<title>gpu1_layer2_expert0&#45;&gt;gpu1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M720.1,-17842.89C756.98,-17828.01 804.7,-17808.75 846.16,-17792.01"/>
<polygon fill="black" stroke="black" points="847.5,-17795.25 855.46,-17788.26 844.88,-17788.76 847.5,-17795.25"/>
</g>
<!-- gpu1_layer2_expert1&#45;&gt;gpu1_layer2_expert_agg -->
<g id="edge382" class="edge">
<title>gpu1_layer2_expert1&#45;&gt;gpu1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M830.07,-17842.47C841.32,-17833.39 854.53,-17822.73 867.8,-17812.02"/>
<polygon fill="black" stroke="black" points="870.02,-17814.72 875.6,-17805.72 865.62,-17809.28 870.02,-17814.72"/>
</g>
<!-- gpu1_layer2_expert2&#45;&gt;gpu1_layer2_expert_agg -->
<g id="edge383" class="edge">
<title>gpu1_layer2_expert2&#45;&gt;gpu1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M939,-17842.47C939,-17834.54 939,-17825.41 939,-17816.09"/>
<polygon fill="black" stroke="black" points="942.5,-17815.95 939,-17805.95 935.5,-17815.95 942.5,-17815.95"/>
</g>
<!-- gpu1_layer2_expert3&#45;&gt;gpu1_layer2_expert_agg -->
<g id="edge384" class="edge">
<title>gpu1_layer2_expert3&#45;&gt;gpu1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M1047.93,-17842.47C1036.68,-17833.39 1023.47,-17822.73 1010.2,-17812.02"/>
<polygon fill="black" stroke="black" points="1012.38,-17809.28 1002.4,-17805.72 1007.98,-17814.72 1012.38,-17809.28"/>
</g>
<!-- gpu1_layer2_res2 -->
<g id="node311" class="node">
<title>gpu1_layer2_res2</title>
<polygon fill="lightblue" stroke="black" points="1000,-17664.55 878,-17664.55 878,-17612.55 1000,-17612.55 1000,-17664.55"/>
<text text-anchor="middle" x="939" y="-17652.55" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="939" y="-17641.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-17630.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-17619.55" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer2_expert_agg&#45;&gt;gpu1_layer2_res2 -->
<g id="edge386" class="edge">
<title>gpu1_layer2_expert_agg&#45;&gt;gpu1_layer2_res2</title>
<path fill="none" stroke="black" d="M939,-17701.34C939,-17692.39 939,-17683.26 939,-17674.86"/>
<polygon fill="black" stroke="black" points="942.5,-17674.68 939,-17664.68 935.5,-17674.68 942.5,-17674.68"/>
</g>
<!-- gpu1_layer3_ln1 -->
<g id="node312" class="node">
<title>gpu1_layer3_ln1</title>
<polygon fill="lightblue" stroke="black" points="1000,-17575.55 878,-17575.55 878,-17523.55 1000,-17523.55 1000,-17575.55"/>
<text text-anchor="middle" x="939" y="-17563.55" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="939" y="-17552.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-17541.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-17530.55" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer2_res2&#45;&gt;gpu1_layer3_ln1 -->
<g id="edge391" class="edge">
<title>gpu1_layer2_res2&#45;&gt;gpu1_layer3_ln1</title>
<path fill="none" stroke="black" d="M939,-17612.38C939,-17604.09 939,-17594.7 939,-17585.8"/>
<polygon fill="black" stroke="black" points="942.5,-17585.65 939,-17575.65 935.5,-17585.65 942.5,-17585.65"/>
</g>
<!-- gpu1_layer3_qkv -->
<g id="node313" class="node">
<title>gpu1_layer3_qkv</title>
<polygon fill="lightblue" stroke="black" points="1000,-17486.55 878,-17486.55 878,-17434.55 1000,-17434.55 1000,-17486.55"/>
<text text-anchor="middle" x="939" y="-17474.55" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="939" y="-17463.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-17452.55" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-17441.55" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer3_ln1&#45;&gt;gpu1_layer3_qkv -->
<g id="edge392" class="edge">
<title>gpu1_layer3_ln1&#45;&gt;gpu1_layer3_qkv</title>
<path fill="none" stroke="black" d="M939,-17523.38C939,-17515.09 939,-17505.7 939,-17496.8"/>
<polygon fill="black" stroke="black" points="942.5,-17496.65 939,-17486.65 935.5,-17496.65 942.5,-17496.65"/>
</g>
<!-- gpu1_layer3_reshape -->
<g id="node314" class="node">
<title>gpu1_layer3_reshape</title>
<polygon fill="lightblue" stroke="black" points="1003,-17397.55 875,-17397.55 875,-17345.55 1003,-17345.55 1003,-17397.55"/>
<text text-anchor="middle" x="939" y="-17385.55" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="939" y="-17374.55" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-17363.55" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-17352.55" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer3_qkv&#45;&gt;gpu1_layer3_reshape -->
<g id="edge393" class="edge">
<title>gpu1_layer3_qkv&#45;&gt;gpu1_layer3_reshape</title>
<path fill="none" stroke="black" d="M939,-17434.38C939,-17426.09 939,-17416.7 939,-17407.8"/>
<polygon fill="black" stroke="black" points="942.5,-17407.65 939,-17397.65 935.5,-17407.65 942.5,-17407.65"/>
</g>
<!-- gpu1_layer3_attn -->
<g id="node315" class="node">
<title>gpu1_layer3_attn</title>
<polygon fill="lightblue" stroke="black" points="1003,-17308.55 875,-17308.55 875,-17256.55 1003,-17256.55 1003,-17308.55"/>
<text text-anchor="middle" x="939" y="-17296.55" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="939" y="-17285.55" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-17274.55" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-17263.55" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer3_reshape&#45;&gt;gpu1_layer3_attn -->
<g id="edge394" class="edge">
<title>gpu1_layer3_reshape&#45;&gt;gpu1_layer3_attn</title>
<path fill="none" stroke="black" d="M939,-17345.38C939,-17337.09 939,-17327.7 939,-17318.8"/>
<polygon fill="black" stroke="black" points="942.5,-17318.65 939,-17308.65 935.5,-17318.65 942.5,-17318.65"/>
</g>
<!-- gpu1_layer3_attn_reshape -->
<g id="node317" class="node">
<title>gpu1_layer3_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1000,-17219.55 878,-17219.55 878,-17167.55 1000,-17167.55 1000,-17219.55"/>
<text text-anchor="middle" x="939" y="-17207.55" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="939" y="-17196.55" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-17185.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-17174.55" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer3_attn&#45;&gt;gpu1_layer3_attn_reshape -->
<g id="edge395" class="edge">
<title>gpu1_layer3_attn&#45;&gt;gpu1_layer3_attn_reshape</title>
<path fill="none" stroke="black" d="M939,-17256.38C939,-17248.09 939,-17238.7 939,-17229.8"/>
<polygon fill="black" stroke="black" points="942.5,-17229.65 939,-17219.65 935.5,-17229.65 942.5,-17229.65"/>
</g>
<!-- gpu1_layer3_attn_out -->
<g id="node316" class="node">
<title>gpu1_layer3_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1000,-17130.55 878,-17130.55 878,-17078.55 1000,-17078.55 1000,-17130.55"/>
<text text-anchor="middle" x="939" y="-17118.55" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="939" y="-17107.55" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-17096.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-17085.55" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer3_kv_update -->
<g id="node318" class="node">
<title>gpu1_layer3_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="939" cy="-17004.78" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="939" y="-17018.78" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="939" y="-17007.78" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-16996.78" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-16985.78" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer3_attn_out&#45;&gt;gpu1_layer3_kv_update -->
<g id="edge397" class="edge">
<title>gpu1_layer3_attn_out&#45;&gt;gpu1_layer3_kv_update</title>
<path fill="none" stroke="black" d="M939,-17078.37C939,-17070.23 939,-17060.93 939,-17051.77"/>
<polygon fill="black" stroke="black" points="942.5,-17051.56 939,-17041.56 935.5,-17051.56 942.5,-17051.56"/>
</g>
<!-- gpu1_layer3_attn_reshape&#45;&gt;gpu1_layer3_attn_out -->
<g id="edge396" class="edge">
<title>gpu1_layer3_attn_reshape&#45;&gt;gpu1_layer3_attn_out</title>
<path fill="none" stroke="black" d="M939,-17167.38C939,-17159.09 939,-17149.7 939,-17140.8"/>
<polygon fill="black" stroke="black" points="942.5,-17140.65 939,-17130.65 935.5,-17140.65 942.5,-17140.65"/>
</g>
<!-- gpu1_layer3_res1 -->
<g id="node319" class="node">
<title>gpu1_layer3_res1</title>
<polygon fill="lightblue" stroke="black" points="1000,-16931.01 878,-16931.01 878,-16879.01 1000,-16879.01 1000,-16931.01"/>
<text text-anchor="middle" x="939" y="-16919.01" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="939" y="-16908.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-16897.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-16886.01" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer3_kv_update&#45;&gt;gpu1_layer3_res1 -->
<g id="edge398" class="edge">
<title>gpu1_layer3_kv_update&#45;&gt;gpu1_layer3_res1</title>
<path fill="none" stroke="black" d="M939,-16967.93C939,-16959.25 939,-16949.98 939,-16941.32"/>
<polygon fill="black" stroke="black" points="942.5,-16941.15 939,-16931.15 935.5,-16941.15 942.5,-16941.15"/>
</g>
<!-- gpu1_layer3_ln2 -->
<g id="node320" class="node">
<title>gpu1_layer3_ln2</title>
<polygon fill="lightblue" stroke="black" points="1000,-16842.01 878,-16842.01 878,-16790.01 1000,-16790.01 1000,-16842.01"/>
<text text-anchor="middle" x="939" y="-16830.01" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="939" y="-16819.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-16808.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-16797.01" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer3_res1&#45;&gt;gpu1_layer3_ln2 -->
<g id="edge399" class="edge">
<title>gpu1_layer3_res1&#45;&gt;gpu1_layer3_ln2</title>
<path fill="none" stroke="black" d="M939,-16878.84C939,-16870.55 939,-16861.16 939,-16852.26"/>
<polygon fill="black" stroke="black" points="942.5,-16852.12 939,-16842.12 935.5,-16852.12 942.5,-16852.12"/>
</g>
<!-- gpu1_layer3_routing -->
<g id="node321" class="node">
<title>gpu1_layer3_routing</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-16753.01 864.29,-16753.01 812.53,-16627.01 1013.71,-16627.01 1065.47,-16753.01"/>
<text text-anchor="middle" x="939" y="-16709.51" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="939" y="-16698.51" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-16687.51" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-16676.51" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="939" y="-16665.51" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer3_ln2&#45;&gt;gpu1_layer3_routing -->
<g id="edge400" class="edge">
<title>gpu1_layer3_ln2&#45;&gt;gpu1_layer3_routing</title>
<path fill="none" stroke="black" d="M939,-16789.92C939,-16781.98 939,-16772.79 939,-16763.26"/>
<polygon fill="black" stroke="black" points="942.5,-16763.24 939,-16753.24 935.5,-16763.24 942.5,-16763.24"/>
</g>
<!-- gpu1_layer3_expert0 -->
<g id="node322" class="node">
<title>gpu1_layer3_expert0</title>
<polygon fill="lightblue" stroke="black" points="720,-16581.01 598,-16581.01 598,-16529.01 720,-16529.01 720,-16581.01"/>
<text text-anchor="middle" x="659" y="-16569.01" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="659" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer3_routing&#45;&gt;gpu1_layer3_expert0 -->
<g id="edge387" class="edge">
<title>gpu1_layer3_routing&#45;&gt;gpu1_layer3_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M813.33,-16629.32C781.34,-16614.12 748.34,-16598.44 721.11,-16585.51"/>
<polygon fill="black" stroke="black" points="722.26,-16582.18 711.73,-16581.05 719.26,-16588.51 722.26,-16582.18"/>
<text text-anchor="middle" x="795.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer3_expert1 -->
<g id="node323" class="node">
<title>gpu1_layer3_expert1</title>
<polygon fill="lightblue" stroke="black" points="860,-16581.01 738,-16581.01 738,-16529.01 860,-16529.01 860,-16581.01"/>
<text text-anchor="middle" x="799" y="-16569.01" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="799" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer3_routing&#45;&gt;gpu1_layer3_expert1 -->
<g id="edge388" class="edge">
<title>gpu1_layer3_routing&#45;&gt;gpu1_layer3_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M873.51,-16626.79C859.48,-16613.47 845.21,-16599.91 832.97,-16588.28"/>
<polygon fill="black" stroke="black" points="835.29,-16585.65 825.63,-16581.3 830.46,-16590.73 835.29,-16585.65"/>
<text text-anchor="middle" x="882.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer3_expert2 -->
<g id="node324" class="node">
<title>gpu1_layer3_expert2</title>
<polygon fill="lightblue" stroke="black" points="1000,-16581.01 878,-16581.01 878,-16529.01 1000,-16529.01 1000,-16581.01"/>
<text text-anchor="middle" x="939" y="-16569.01" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="939" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer3_routing&#45;&gt;gpu1_layer3_expert2 -->
<g id="edge389" class="edge">
<title>gpu1_layer3_routing&#45;&gt;gpu1_layer3_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M939,-16626.79C939,-16614.72 939,-16602.47 939,-16591.62"/>
<polygon fill="black" stroke="black" points="942.5,-16591.3 939,-16581.3 935.5,-16591.3 942.5,-16591.3"/>
<text text-anchor="middle" x="968.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer3_expert3 -->
<g id="node325" class="node">
<title>gpu1_layer3_expert3</title>
<polygon fill="lightblue" stroke="black" points="1140,-16581.01 1018,-16581.01 1018,-16529.01 1140,-16529.01 1140,-16581.01"/>
<text text-anchor="middle" x="1079" y="-16569.01" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1079" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer3_routing&#45;&gt;gpu1_layer3_expert3 -->
<g id="edge390" class="edge">
<title>gpu1_layer3_routing&#45;&gt;gpu1_layer3_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1004.49,-16626.79C1018.52,-16613.47 1032.79,-16599.91 1045.03,-16588.28"/>
<polygon fill="black" stroke="black" points="1047.54,-16590.73 1052.37,-16581.3 1042.71,-16585.65 1047.54,-16590.73"/>
<text text-anchor="middle" x="1063.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer3_expert_agg -->
<g id="node326" class="node">
<title>gpu1_layer3_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-16492.01 864.29,-16492.01 812.53,-16388.01 1013.71,-16388.01 1065.47,-16492.01"/>
<text text-anchor="middle" x="939" y="-16454.01" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="939" y="-16443.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-16432.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-16421.01" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer3_routing&#45;&gt;gpu1_layer3_expert_agg -->
<g id="edge405" class="edge">
<title>gpu1_layer3_routing&#45;&gt;gpu1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M1028.22,-16662.09C1101.96,-16634.93 1188.6,-16588.54 1149,-16529.01 1128.44,-16498.1 1094.7,-16478.02 1060.22,-16464.99"/>
<polygon fill="black" stroke="black" points="1061.08,-16461.58 1050.48,-16461.5 1058.71,-16468.17 1061.08,-16461.58"/>
</g>
<!-- gpu1_layer3_expert0&#45;&gt;gpu1_layer3_expert_agg -->
<g id="edge401" class="edge">
<title>gpu1_layer3_expert0&#45;&gt;gpu1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M720.1,-16529.35C756.98,-16514.47 804.7,-16495.21 846.16,-16478.47"/>
<polygon fill="black" stroke="black" points="847.5,-16481.71 855.46,-16474.72 844.88,-16475.22 847.5,-16481.71"/>
</g>
<!-- gpu1_layer3_expert1&#45;&gt;gpu1_layer3_expert_agg -->
<g id="edge402" class="edge">
<title>gpu1_layer3_expert1&#45;&gt;gpu1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M830.07,-16528.93C841.32,-16519.85 854.53,-16509.19 867.8,-16498.48"/>
<polygon fill="black" stroke="black" points="870.02,-16501.18 875.6,-16492.18 865.62,-16495.74 870.02,-16501.18"/>
</g>
<!-- gpu1_layer3_expert2&#45;&gt;gpu1_layer3_expert_agg -->
<g id="edge403" class="edge">
<title>gpu1_layer3_expert2&#45;&gt;gpu1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M939,-16528.93C939,-16521 939,-16511.87 939,-16502.55"/>
<polygon fill="black" stroke="black" points="942.5,-16502.41 939,-16492.41 935.5,-16502.41 942.5,-16502.41"/>
</g>
<!-- gpu1_layer3_expert3&#45;&gt;gpu1_layer3_expert_agg -->
<g id="edge404" class="edge">
<title>gpu1_layer3_expert3&#45;&gt;gpu1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M1047.93,-16528.93C1036.68,-16519.85 1023.47,-16509.19 1010.2,-16498.48"/>
<polygon fill="black" stroke="black" points="1012.38,-16495.74 1002.4,-16492.18 1007.98,-16501.18 1012.38,-16495.74"/>
</g>
<!-- gpu1_layer3_res2 -->
<g id="node327" class="node">
<title>gpu1_layer3_res2</title>
<polygon fill="lightblue" stroke="black" points="1000,-16351.01 878,-16351.01 878,-16299.01 1000,-16299.01 1000,-16351.01"/>
<text text-anchor="middle" x="939" y="-16339.01" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="939" y="-16328.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-16317.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-16306.01" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer3_expert_agg&#45;&gt;gpu1_layer3_res2 -->
<g id="edge406" class="edge">
<title>gpu1_layer3_expert_agg&#45;&gt;gpu1_layer3_res2</title>
<path fill="none" stroke="black" d="M939,-16387.8C939,-16378.85 939,-16369.72 939,-16361.32"/>
<polygon fill="black" stroke="black" points="942.5,-16361.14 939,-16351.14 935.5,-16361.14 942.5,-16361.14"/>
</g>
<!-- gpu1_layer4_ln1 -->
<g id="node328" class="node">
<title>gpu1_layer4_ln1</title>
<polygon fill="lightblue" stroke="black" points="1000,-16262.01 878,-16262.01 878,-16210.01 1000,-16210.01 1000,-16262.01"/>
<text text-anchor="middle" x="939" y="-16250.01" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="939" y="-16239.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-16228.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-16217.01" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer3_res2&#45;&gt;gpu1_layer4_ln1 -->
<g id="edge411" class="edge">
<title>gpu1_layer3_res2&#45;&gt;gpu1_layer4_ln1</title>
<path fill="none" stroke="black" d="M939,-16298.84C939,-16290.55 939,-16281.16 939,-16272.26"/>
<polygon fill="black" stroke="black" points="942.5,-16272.12 939,-16262.12 935.5,-16272.12 942.5,-16272.12"/>
</g>
<!-- gpu1_layer4_qkv -->
<g id="node329" class="node">
<title>gpu1_layer4_qkv</title>
<polygon fill="lightblue" stroke="black" points="1000,-16173.01 878,-16173.01 878,-16121.01 1000,-16121.01 1000,-16173.01"/>
<text text-anchor="middle" x="939" y="-16161.01" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="939" y="-16150.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-16139.01" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-16128.01" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer4_ln1&#45;&gt;gpu1_layer4_qkv -->
<g id="edge412" class="edge">
<title>gpu1_layer4_ln1&#45;&gt;gpu1_layer4_qkv</title>
<path fill="none" stroke="black" d="M939,-16209.84C939,-16201.55 939,-16192.16 939,-16183.26"/>
<polygon fill="black" stroke="black" points="942.5,-16183.12 939,-16173.12 935.5,-16183.12 942.5,-16183.12"/>
</g>
<!-- gpu1_layer4_reshape -->
<g id="node330" class="node">
<title>gpu1_layer4_reshape</title>
<polygon fill="lightblue" stroke="black" points="1003,-16084.01 875,-16084.01 875,-16032.01 1003,-16032.01 1003,-16084.01"/>
<text text-anchor="middle" x="939" y="-16072.01" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="939" y="-16061.01" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-16050.01" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-16039.01" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer4_qkv&#45;&gt;gpu1_layer4_reshape -->
<g id="edge413" class="edge">
<title>gpu1_layer4_qkv&#45;&gt;gpu1_layer4_reshape</title>
<path fill="none" stroke="black" d="M939,-16120.84C939,-16112.55 939,-16103.16 939,-16094.26"/>
<polygon fill="black" stroke="black" points="942.5,-16094.12 939,-16084.12 935.5,-16094.12 942.5,-16094.12"/>
</g>
<!-- gpu1_layer4_attn -->
<g id="node331" class="node">
<title>gpu1_layer4_attn</title>
<polygon fill="lightblue" stroke="black" points="1003,-15995.01 875,-15995.01 875,-15943.01 1003,-15943.01 1003,-15995.01"/>
<text text-anchor="middle" x="939" y="-15983.01" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="939" y="-15972.01" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-15961.01" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-15950.01" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer4_reshape&#45;&gt;gpu1_layer4_attn -->
<g id="edge414" class="edge">
<title>gpu1_layer4_reshape&#45;&gt;gpu1_layer4_attn</title>
<path fill="none" stroke="black" d="M939,-16031.84C939,-16023.55 939,-16014.16 939,-16005.26"/>
<polygon fill="black" stroke="black" points="942.5,-16005.12 939,-15995.12 935.5,-16005.12 942.5,-16005.12"/>
</g>
<!-- gpu1_layer4_attn_reshape -->
<g id="node333" class="node">
<title>gpu1_layer4_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1000,-15906.01 878,-15906.01 878,-15854.01 1000,-15854.01 1000,-15906.01"/>
<text text-anchor="middle" x="939" y="-15894.01" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="939" y="-15883.01" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-15872.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-15861.01" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer4_attn&#45;&gt;gpu1_layer4_attn_reshape -->
<g id="edge415" class="edge">
<title>gpu1_layer4_attn&#45;&gt;gpu1_layer4_attn_reshape</title>
<path fill="none" stroke="black" d="M939,-15942.84C939,-15934.55 939,-15925.16 939,-15916.26"/>
<polygon fill="black" stroke="black" points="942.5,-15916.12 939,-15906.12 935.5,-15916.12 942.5,-15916.12"/>
</g>
<!-- gpu1_layer4_attn_out -->
<g id="node332" class="node">
<title>gpu1_layer4_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1000,-15817.01 878,-15817.01 878,-15765.01 1000,-15765.01 1000,-15817.01"/>
<text text-anchor="middle" x="939" y="-15805.01" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="939" y="-15794.01" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-15783.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-15772.01" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer4_kv_update -->
<g id="node334" class="node">
<title>gpu1_layer4_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="939" cy="-15691.24" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="939" y="-15705.24" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="939" y="-15694.24" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-15683.24" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-15672.24" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer4_attn_out&#45;&gt;gpu1_layer4_kv_update -->
<g id="edge417" class="edge">
<title>gpu1_layer4_attn_out&#45;&gt;gpu1_layer4_kv_update</title>
<path fill="none" stroke="black" d="M939,-15764.83C939,-15756.69 939,-15747.39 939,-15738.23"/>
<polygon fill="black" stroke="black" points="942.5,-15738.02 939,-15728.02 935.5,-15738.02 942.5,-15738.02"/>
</g>
<!-- gpu1_layer4_attn_reshape&#45;&gt;gpu1_layer4_attn_out -->
<g id="edge416" class="edge">
<title>gpu1_layer4_attn_reshape&#45;&gt;gpu1_layer4_attn_out</title>
<path fill="none" stroke="black" d="M939,-15853.84C939,-15845.55 939,-15836.16 939,-15827.26"/>
<polygon fill="black" stroke="black" points="942.5,-15827.12 939,-15817.12 935.5,-15827.12 942.5,-15827.12"/>
</g>
<!-- gpu1_layer4_res1 -->
<g id="node335" class="node">
<title>gpu1_layer4_res1</title>
<polygon fill="lightblue" stroke="black" points="1000,-15617.47 878,-15617.47 878,-15565.47 1000,-15565.47 1000,-15617.47"/>
<text text-anchor="middle" x="939" y="-15605.47" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="939" y="-15594.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-15583.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-15572.47" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer4_kv_update&#45;&gt;gpu1_layer4_res1 -->
<g id="edge418" class="edge">
<title>gpu1_layer4_kv_update&#45;&gt;gpu1_layer4_res1</title>
<path fill="none" stroke="black" d="M939,-15654.39C939,-15645.71 939,-15636.44 939,-15627.78"/>
<polygon fill="black" stroke="black" points="942.5,-15627.62 939,-15617.62 935.5,-15627.62 942.5,-15627.62"/>
</g>
<!-- gpu1_layer4_ln2 -->
<g id="node336" class="node">
<title>gpu1_layer4_ln2</title>
<polygon fill="lightblue" stroke="black" points="1000,-15528.47 878,-15528.47 878,-15476.47 1000,-15476.47 1000,-15528.47"/>
<text text-anchor="middle" x="939" y="-15516.47" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="939" y="-15505.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-15494.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-15483.47" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer4_res1&#45;&gt;gpu1_layer4_ln2 -->
<g id="edge419" class="edge">
<title>gpu1_layer4_res1&#45;&gt;gpu1_layer4_ln2</title>
<path fill="none" stroke="black" d="M939,-15565.31C939,-15557.01 939,-15547.62 939,-15538.72"/>
<polygon fill="black" stroke="black" points="942.5,-15538.58 939,-15528.58 935.5,-15538.58 942.5,-15538.58"/>
</g>
<!-- gpu1_layer4_routing -->
<g id="node337" class="node">
<title>gpu1_layer4_routing</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-15439.47 864.29,-15439.47 812.53,-15313.47 1013.71,-15313.47 1065.47,-15439.47"/>
<text text-anchor="middle" x="939" y="-15395.97" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="939" y="-15384.97" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-15373.97" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-15362.97" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="939" y="-15351.97" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer4_ln2&#45;&gt;gpu1_layer4_routing -->
<g id="edge420" class="edge">
<title>gpu1_layer4_ln2&#45;&gt;gpu1_layer4_routing</title>
<path fill="none" stroke="black" d="M939,-15476.38C939,-15468.45 939,-15459.25 939,-15449.72"/>
<polygon fill="black" stroke="black" points="942.5,-15449.7 939,-15439.7 935.5,-15449.7 942.5,-15449.7"/>
</g>
<!-- gpu1_layer4_expert0 -->
<g id="node338" class="node">
<title>gpu1_layer4_expert0</title>
<polygon fill="lightblue" stroke="black" points="720,-15267.47 598,-15267.47 598,-15215.47 720,-15215.47 720,-15267.47"/>
<text text-anchor="middle" x="659" y="-15255.47" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="659" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer4_routing&#45;&gt;gpu1_layer4_expert0 -->
<g id="edge407" class="edge">
<title>gpu1_layer4_routing&#45;&gt;gpu1_layer4_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M813.33,-15315.78C781.34,-15300.58 748.34,-15284.91 721.11,-15271.97"/>
<polygon fill="black" stroke="black" points="722.26,-15268.64 711.73,-15267.51 719.26,-15274.97 722.26,-15268.64"/>
<text text-anchor="middle" x="795.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer4_expert1 -->
<g id="node339" class="node">
<title>gpu1_layer4_expert1</title>
<polygon fill="lightblue" stroke="black" points="860,-15267.47 738,-15267.47 738,-15215.47 860,-15215.47 860,-15267.47"/>
<text text-anchor="middle" x="799" y="-15255.47" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="799" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer4_routing&#45;&gt;gpu1_layer4_expert1 -->
<g id="edge408" class="edge">
<title>gpu1_layer4_routing&#45;&gt;gpu1_layer4_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M873.51,-15313.25C859.48,-15299.93 845.21,-15286.37 832.97,-15274.74"/>
<polygon fill="black" stroke="black" points="835.29,-15272.11 825.63,-15267.76 830.46,-15277.19 835.29,-15272.11"/>
<text text-anchor="middle" x="882.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer4_expert2 -->
<g id="node340" class="node">
<title>gpu1_layer4_expert2</title>
<polygon fill="lightblue" stroke="black" points="1000,-15267.47 878,-15267.47 878,-15215.47 1000,-15215.47 1000,-15267.47"/>
<text text-anchor="middle" x="939" y="-15255.47" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="939" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer4_routing&#45;&gt;gpu1_layer4_expert2 -->
<g id="edge409" class="edge">
<title>gpu1_layer4_routing&#45;&gt;gpu1_layer4_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M939,-15313.25C939,-15301.18 939,-15288.93 939,-15278.08"/>
<polygon fill="black" stroke="black" points="942.5,-15277.76 939,-15267.76 935.5,-15277.76 942.5,-15277.76"/>
<text text-anchor="middle" x="968.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer4_expert3 -->
<g id="node341" class="node">
<title>gpu1_layer4_expert3</title>
<polygon fill="lightblue" stroke="black" points="1140,-15267.47 1018,-15267.47 1018,-15215.47 1140,-15215.47 1140,-15267.47"/>
<text text-anchor="middle" x="1079" y="-15255.47" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1079" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer4_routing&#45;&gt;gpu1_layer4_expert3 -->
<g id="edge410" class="edge">
<title>gpu1_layer4_routing&#45;&gt;gpu1_layer4_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1004.49,-15313.25C1018.52,-15299.93 1032.79,-15286.37 1045.03,-15274.74"/>
<polygon fill="black" stroke="black" points="1047.54,-15277.19 1052.37,-15267.76 1042.71,-15272.11 1047.54,-15277.19"/>
<text text-anchor="middle" x="1063.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer4_expert_agg -->
<g id="node342" class="node">
<title>gpu1_layer4_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-15178.47 864.29,-15178.47 812.53,-15074.47 1013.71,-15074.47 1065.47,-15178.47"/>
<text text-anchor="middle" x="939" y="-15140.47" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="939" y="-15129.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-15118.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-15107.47" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer4_routing&#45;&gt;gpu1_layer4_expert_agg -->
<g id="edge425" class="edge">
<title>gpu1_layer4_routing&#45;&gt;gpu1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M1028.22,-15348.55C1101.96,-15321.39 1188.6,-15275 1149,-15215.47 1128.44,-15184.56 1094.7,-15164.48 1060.22,-15151.45"/>
<polygon fill="black" stroke="black" points="1061.08,-15148.04 1050.48,-15147.96 1058.71,-15154.63 1061.08,-15148.04"/>
</g>
<!-- gpu1_layer4_expert0&#45;&gt;gpu1_layer4_expert_agg -->
<g id="edge421" class="edge">
<title>gpu1_layer4_expert0&#45;&gt;gpu1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M720.1,-15215.81C756.98,-15200.93 804.7,-15181.67 846.16,-15164.94"/>
<polygon fill="black" stroke="black" points="847.5,-15168.17 855.46,-15161.18 844.88,-15161.68 847.5,-15168.17"/>
</g>
<!-- gpu1_layer4_expert1&#45;&gt;gpu1_layer4_expert_agg -->
<g id="edge422" class="edge">
<title>gpu1_layer4_expert1&#45;&gt;gpu1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M830.07,-15215.39C841.32,-15206.31 854.53,-15195.65 867.8,-15184.94"/>
<polygon fill="black" stroke="black" points="870.02,-15187.64 875.6,-15178.64 865.62,-15182.2 870.02,-15187.64"/>
</g>
<!-- gpu1_layer4_expert2&#45;&gt;gpu1_layer4_expert_agg -->
<g id="edge423" class="edge">
<title>gpu1_layer4_expert2&#45;&gt;gpu1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M939,-15215.39C939,-15207.46 939,-15198.33 939,-15189.01"/>
<polygon fill="black" stroke="black" points="942.5,-15188.87 939,-15178.87 935.5,-15188.87 942.5,-15188.87"/>
</g>
<!-- gpu1_layer4_expert3&#45;&gt;gpu1_layer4_expert_agg -->
<g id="edge424" class="edge">
<title>gpu1_layer4_expert3&#45;&gt;gpu1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M1047.93,-15215.39C1036.68,-15206.31 1023.47,-15195.65 1010.2,-15184.94"/>
<polygon fill="black" stroke="black" points="1012.38,-15182.2 1002.4,-15178.64 1007.98,-15187.64 1012.38,-15182.2"/>
</g>
<!-- gpu1_layer4_res2 -->
<g id="node343" class="node">
<title>gpu1_layer4_res2</title>
<polygon fill="lightblue" stroke="black" points="1000,-15037.47 878,-15037.47 878,-14985.47 1000,-14985.47 1000,-15037.47"/>
<text text-anchor="middle" x="939" y="-15025.47" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="939" y="-15014.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-15003.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-14992.47" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer4_expert_agg&#45;&gt;gpu1_layer4_res2 -->
<g id="edge426" class="edge">
<title>gpu1_layer4_expert_agg&#45;&gt;gpu1_layer4_res2</title>
<path fill="none" stroke="black" d="M939,-15074.26C939,-15065.31 939,-15056.18 939,-15047.78"/>
<polygon fill="black" stroke="black" points="942.5,-15047.6 939,-15037.6 935.5,-15047.6 942.5,-15047.6"/>
</g>
<!-- gpu1_layer5_ln1 -->
<g id="node344" class="node">
<title>gpu1_layer5_ln1</title>
<polygon fill="lightblue" stroke="black" points="1000,-14948.47 878,-14948.47 878,-14896.47 1000,-14896.47 1000,-14948.47"/>
<text text-anchor="middle" x="939" y="-14936.47" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="939" y="-14925.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-14914.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-14903.47" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer4_res2&#45;&gt;gpu1_layer5_ln1 -->
<g id="edge431" class="edge">
<title>gpu1_layer4_res2&#45;&gt;gpu1_layer5_ln1</title>
<path fill="none" stroke="black" d="M939,-14985.31C939,-14977.01 939,-14967.62 939,-14958.72"/>
<polygon fill="black" stroke="black" points="942.5,-14958.58 939,-14948.58 935.5,-14958.58 942.5,-14958.58"/>
</g>
<!-- gpu1_layer5_qkv -->
<g id="node345" class="node">
<title>gpu1_layer5_qkv</title>
<polygon fill="lightblue" stroke="black" points="1000,-14859.47 878,-14859.47 878,-14807.47 1000,-14807.47 1000,-14859.47"/>
<text text-anchor="middle" x="939" y="-14847.47" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="939" y="-14836.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-14825.47" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-14814.47" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer5_ln1&#45;&gt;gpu1_layer5_qkv -->
<g id="edge432" class="edge">
<title>gpu1_layer5_ln1&#45;&gt;gpu1_layer5_qkv</title>
<path fill="none" stroke="black" d="M939,-14896.31C939,-14888.01 939,-14878.62 939,-14869.72"/>
<polygon fill="black" stroke="black" points="942.5,-14869.58 939,-14859.58 935.5,-14869.58 942.5,-14869.58"/>
</g>
<!-- gpu1_layer5_reshape -->
<g id="node346" class="node">
<title>gpu1_layer5_reshape</title>
<polygon fill="lightblue" stroke="black" points="1003,-14770.47 875,-14770.47 875,-14718.47 1003,-14718.47 1003,-14770.47"/>
<text text-anchor="middle" x="939" y="-14758.47" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="939" y="-14747.47" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-14736.47" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-14725.47" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer5_qkv&#45;&gt;gpu1_layer5_reshape -->
<g id="edge433" class="edge">
<title>gpu1_layer5_qkv&#45;&gt;gpu1_layer5_reshape</title>
<path fill="none" stroke="black" d="M939,-14807.31C939,-14799.01 939,-14789.62 939,-14780.72"/>
<polygon fill="black" stroke="black" points="942.5,-14780.58 939,-14770.58 935.5,-14780.58 942.5,-14780.58"/>
</g>
<!-- gpu1_layer5_attn -->
<g id="node347" class="node">
<title>gpu1_layer5_attn</title>
<polygon fill="lightblue" stroke="black" points="1003,-14681.47 875,-14681.47 875,-14629.47 1003,-14629.47 1003,-14681.47"/>
<text text-anchor="middle" x="939" y="-14669.47" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="939" y="-14658.47" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-14647.47" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-14636.47" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer5_reshape&#45;&gt;gpu1_layer5_attn -->
<g id="edge434" class="edge">
<title>gpu1_layer5_reshape&#45;&gt;gpu1_layer5_attn</title>
<path fill="none" stroke="black" d="M939,-14718.31C939,-14710.01 939,-14700.62 939,-14691.72"/>
<polygon fill="black" stroke="black" points="942.5,-14691.58 939,-14681.58 935.5,-14691.58 942.5,-14691.58"/>
</g>
<!-- gpu1_layer5_attn_reshape -->
<g id="node349" class="node">
<title>gpu1_layer5_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1000,-14592.47 878,-14592.47 878,-14540.47 1000,-14540.47 1000,-14592.47"/>
<text text-anchor="middle" x="939" y="-14580.47" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="939" y="-14569.47" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-14558.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-14547.47" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer5_attn&#45;&gt;gpu1_layer5_attn_reshape -->
<g id="edge435" class="edge">
<title>gpu1_layer5_attn&#45;&gt;gpu1_layer5_attn_reshape</title>
<path fill="none" stroke="black" d="M939,-14629.31C939,-14621.01 939,-14611.62 939,-14602.72"/>
<polygon fill="black" stroke="black" points="942.5,-14602.58 939,-14592.58 935.5,-14602.58 942.5,-14602.58"/>
</g>
<!-- gpu1_layer5_attn_out -->
<g id="node348" class="node">
<title>gpu1_layer5_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1000,-14503.47 878,-14503.47 878,-14451.47 1000,-14451.47 1000,-14503.47"/>
<text text-anchor="middle" x="939" y="-14491.47" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="939" y="-14480.47" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-14469.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-14458.47" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer5_kv_update -->
<g id="node350" class="node">
<title>gpu1_layer5_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="939" cy="-14377.7" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="939" y="-14391.7" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="939" y="-14380.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-14369.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-14358.7" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer5_attn_out&#45;&gt;gpu1_layer5_kv_update -->
<g id="edge437" class="edge">
<title>gpu1_layer5_attn_out&#45;&gt;gpu1_layer5_kv_update</title>
<path fill="none" stroke="black" d="M939,-14451.29C939,-14443.15 939,-14433.86 939,-14424.69"/>
<polygon fill="black" stroke="black" points="942.5,-14424.48 939,-14414.48 935.5,-14424.48 942.5,-14424.48"/>
</g>
<!-- gpu1_layer5_attn_reshape&#45;&gt;gpu1_layer5_attn_out -->
<g id="edge436" class="edge">
<title>gpu1_layer5_attn_reshape&#45;&gt;gpu1_layer5_attn_out</title>
<path fill="none" stroke="black" d="M939,-14540.31C939,-14532.01 939,-14522.62 939,-14513.72"/>
<polygon fill="black" stroke="black" points="942.5,-14513.58 939,-14503.58 935.5,-14513.58 942.5,-14513.58"/>
</g>
<!-- gpu1_layer5_res1 -->
<g id="node351" class="node">
<title>gpu1_layer5_res1</title>
<polygon fill="lightblue" stroke="black" points="1000,-14303.93 878,-14303.93 878,-14251.93 1000,-14251.93 1000,-14303.93"/>
<text text-anchor="middle" x="939" y="-14291.93" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="939" y="-14280.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-14269.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-14258.93" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer5_kv_update&#45;&gt;gpu1_layer5_res1 -->
<g id="edge438" class="edge">
<title>gpu1_layer5_kv_update&#45;&gt;gpu1_layer5_res1</title>
<path fill="none" stroke="black" d="M939,-14340.85C939,-14332.17 939,-14322.9 939,-14314.25"/>
<polygon fill="black" stroke="black" points="942.5,-14314.08 939,-14304.08 935.5,-14314.08 942.5,-14314.08"/>
</g>
<!-- gpu1_layer5_ln2 -->
<g id="node352" class="node">
<title>gpu1_layer5_ln2</title>
<polygon fill="lightblue" stroke="black" points="1000,-14214.93 878,-14214.93 878,-14162.93 1000,-14162.93 1000,-14214.93"/>
<text text-anchor="middle" x="939" y="-14202.93" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="939" y="-14191.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-14180.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-14169.93" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer5_res1&#45;&gt;gpu1_layer5_ln2 -->
<g id="edge439" class="edge">
<title>gpu1_layer5_res1&#45;&gt;gpu1_layer5_ln2</title>
<path fill="none" stroke="black" d="M939,-14251.77C939,-14243.47 939,-14234.08 939,-14225.18"/>
<polygon fill="black" stroke="black" points="942.5,-14225.04 939,-14215.04 935.5,-14225.04 942.5,-14225.04"/>
</g>
<!-- gpu1_layer5_routing -->
<g id="node353" class="node">
<title>gpu1_layer5_routing</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-14125.93 864.29,-14125.93 812.53,-13999.93 1013.71,-13999.93 1065.47,-14125.93"/>
<text text-anchor="middle" x="939" y="-14082.43" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="939" y="-14071.43" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-14060.43" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-14049.43" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="939" y="-14038.43" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer5_ln2&#45;&gt;gpu1_layer5_routing -->
<g id="edge440" class="edge">
<title>gpu1_layer5_ln2&#45;&gt;gpu1_layer5_routing</title>
<path fill="none" stroke="black" d="M939,-14162.84C939,-14154.91 939,-14145.71 939,-14136.18"/>
<polygon fill="black" stroke="black" points="942.5,-14136.17 939,-14126.17 935.5,-14136.17 942.5,-14136.17"/>
</g>
<!-- gpu1_layer5_expert0 -->
<g id="node354" class="node">
<title>gpu1_layer5_expert0</title>
<polygon fill="lightblue" stroke="black" points="720,-13953.93 598,-13953.93 598,-13901.93 720,-13901.93 720,-13953.93"/>
<text text-anchor="middle" x="659" y="-13941.93" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="659" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer5_routing&#45;&gt;gpu1_layer5_expert0 -->
<g id="edge427" class="edge">
<title>gpu1_layer5_routing&#45;&gt;gpu1_layer5_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M813.33,-14002.24C781.34,-13987.04 748.34,-13971.37 721.11,-13958.43"/>
<polygon fill="black" stroke="black" points="722.26,-13955.1 711.73,-13953.98 719.26,-13961.43 722.26,-13955.1"/>
<text text-anchor="middle" x="795.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer5_expert1 -->
<g id="node355" class="node">
<title>gpu1_layer5_expert1</title>
<polygon fill="lightblue" stroke="black" points="860,-13953.93 738,-13953.93 738,-13901.93 860,-13901.93 860,-13953.93"/>
<text text-anchor="middle" x="799" y="-13941.93" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="799" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer5_routing&#45;&gt;gpu1_layer5_expert1 -->
<g id="edge428" class="edge">
<title>gpu1_layer5_routing&#45;&gt;gpu1_layer5_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M873.51,-13999.71C859.48,-13986.39 845.21,-13972.83 832.97,-13961.2"/>
<polygon fill="black" stroke="black" points="835.29,-13958.57 825.63,-13954.22 830.46,-13963.65 835.29,-13958.57"/>
<text text-anchor="middle" x="882.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer5_expert2 -->
<g id="node356" class="node">
<title>gpu1_layer5_expert2</title>
<polygon fill="lightblue" stroke="black" points="1000,-13953.93 878,-13953.93 878,-13901.93 1000,-13901.93 1000,-13953.93"/>
<text text-anchor="middle" x="939" y="-13941.93" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="939" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer5_routing&#45;&gt;gpu1_layer5_expert2 -->
<g id="edge429" class="edge">
<title>gpu1_layer5_routing&#45;&gt;gpu1_layer5_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M939,-13999.71C939,-13987.65 939,-13975.39 939,-13964.54"/>
<polygon fill="black" stroke="black" points="942.5,-13964.22 939,-13954.22 935.5,-13964.22 942.5,-13964.22"/>
<text text-anchor="middle" x="968.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer5_expert3 -->
<g id="node357" class="node">
<title>gpu1_layer5_expert3</title>
<polygon fill="lightblue" stroke="black" points="1140,-13953.93 1018,-13953.93 1018,-13901.93 1140,-13901.93 1140,-13953.93"/>
<text text-anchor="middle" x="1079" y="-13941.93" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1079" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer5_routing&#45;&gt;gpu1_layer5_expert3 -->
<g id="edge430" class="edge">
<title>gpu1_layer5_routing&#45;&gt;gpu1_layer5_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1004.49,-13999.71C1018.52,-13986.39 1032.79,-13972.83 1045.03,-13961.2"/>
<polygon fill="black" stroke="black" points="1047.54,-13963.65 1052.37,-13954.22 1042.71,-13958.57 1047.54,-13963.65"/>
<text text-anchor="middle" x="1063.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer5_expert_agg -->
<g id="node358" class="node">
<title>gpu1_layer5_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-13864.93 864.29,-13864.93 812.53,-13760.93 1013.71,-13760.93 1065.47,-13864.93"/>
<text text-anchor="middle" x="939" y="-13826.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="939" y="-13815.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-13804.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-13793.93" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer5_routing&#45;&gt;gpu1_layer5_expert_agg -->
<g id="edge445" class="edge">
<title>gpu1_layer5_routing&#45;&gt;gpu1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M1028.22,-14035.01C1101.96,-14007.85 1188.6,-13961.46 1149,-13901.93 1128.44,-13871.02 1094.7,-13850.94 1060.22,-13837.91"/>
<polygon fill="black" stroke="black" points="1061.08,-13834.5 1050.48,-13834.42 1058.71,-13841.09 1061.08,-13834.5"/>
</g>
<!-- gpu1_layer5_expert0&#45;&gt;gpu1_layer5_expert_agg -->
<g id="edge441" class="edge">
<title>gpu1_layer5_expert0&#45;&gt;gpu1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M720.1,-13902.27C756.98,-13887.39 804.7,-13868.13 846.16,-13851.4"/>
<polygon fill="black" stroke="black" points="847.5,-13854.63 855.46,-13847.65 844.88,-13848.14 847.5,-13854.63"/>
</g>
<!-- gpu1_layer5_expert1&#45;&gt;gpu1_layer5_expert_agg -->
<g id="edge442" class="edge">
<title>gpu1_layer5_expert1&#45;&gt;gpu1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M830.07,-13901.85C841.32,-13892.77 854.53,-13882.11 867.8,-13871.4"/>
<polygon fill="black" stroke="black" points="870.02,-13874.11 875.6,-13865.1 865.62,-13868.66 870.02,-13874.11"/>
</g>
<!-- gpu1_layer5_expert2&#45;&gt;gpu1_layer5_expert_agg -->
<g id="edge443" class="edge">
<title>gpu1_layer5_expert2&#45;&gt;gpu1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M939,-13901.85C939,-13893.93 939,-13884.79 939,-13875.47"/>
<polygon fill="black" stroke="black" points="942.5,-13875.33 939,-13865.33 935.5,-13875.33 942.5,-13875.33"/>
</g>
<!-- gpu1_layer5_expert3&#45;&gt;gpu1_layer5_expert_agg -->
<g id="edge444" class="edge">
<title>gpu1_layer5_expert3&#45;&gt;gpu1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M1047.93,-13901.85C1036.68,-13892.77 1023.47,-13882.11 1010.2,-13871.4"/>
<polygon fill="black" stroke="black" points="1012.38,-13868.66 1002.4,-13865.1 1007.98,-13874.11 1012.38,-13868.66"/>
</g>
<!-- gpu1_layer5_res2 -->
<g id="node359" class="node">
<title>gpu1_layer5_res2</title>
<polygon fill="lightblue" stroke="black" points="1000,-13723.93 878,-13723.93 878,-13671.93 1000,-13671.93 1000,-13723.93"/>
<text text-anchor="middle" x="939" y="-13711.93" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="939" y="-13700.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-13689.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-13678.93" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer5_expert_agg&#45;&gt;gpu1_layer5_res2 -->
<g id="edge446" class="edge">
<title>gpu1_layer5_expert_agg&#45;&gt;gpu1_layer5_res2</title>
<path fill="none" stroke="black" d="M939,-13760.72C939,-13751.77 939,-13742.64 939,-13734.24"/>
<polygon fill="black" stroke="black" points="942.5,-13734.06 939,-13724.06 935.5,-13734.06 942.5,-13734.06"/>
</g>
<!-- gpu1_layer6_ln1 -->
<g id="node360" class="node">
<title>gpu1_layer6_ln1</title>
<polygon fill="lightblue" stroke="black" points="1000,-13634.93 878,-13634.93 878,-13582.93 1000,-13582.93 1000,-13634.93"/>
<text text-anchor="middle" x="939" y="-13622.93" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="939" y="-13611.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-13600.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-13589.93" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer5_res2&#45;&gt;gpu1_layer6_ln1 -->
<g id="edge451" class="edge">
<title>gpu1_layer5_res2&#45;&gt;gpu1_layer6_ln1</title>
<path fill="none" stroke="black" d="M939,-13671.77C939,-13663.47 939,-13654.08 939,-13645.18"/>
<polygon fill="black" stroke="black" points="942.5,-13645.04 939,-13635.04 935.5,-13645.04 942.5,-13645.04"/>
</g>
<!-- gpu1_layer6_qkv -->
<g id="node361" class="node">
<title>gpu1_layer6_qkv</title>
<polygon fill="lightblue" stroke="black" points="1000,-13545.93 878,-13545.93 878,-13493.93 1000,-13493.93 1000,-13545.93"/>
<text text-anchor="middle" x="939" y="-13533.93" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="939" y="-13522.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-13511.93" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-13500.93" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer6_ln1&#45;&gt;gpu1_layer6_qkv -->
<g id="edge452" class="edge">
<title>gpu1_layer6_ln1&#45;&gt;gpu1_layer6_qkv</title>
<path fill="none" stroke="black" d="M939,-13582.77C939,-13574.47 939,-13565.08 939,-13556.18"/>
<polygon fill="black" stroke="black" points="942.5,-13556.04 939,-13546.04 935.5,-13556.04 942.5,-13556.04"/>
</g>
<!-- gpu1_layer6_reshape -->
<g id="node362" class="node">
<title>gpu1_layer6_reshape</title>
<polygon fill="lightblue" stroke="black" points="1003,-13456.93 875,-13456.93 875,-13404.93 1003,-13404.93 1003,-13456.93"/>
<text text-anchor="middle" x="939" y="-13444.93" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="939" y="-13433.93" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-13422.93" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-13411.93" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer6_qkv&#45;&gt;gpu1_layer6_reshape -->
<g id="edge453" class="edge">
<title>gpu1_layer6_qkv&#45;&gt;gpu1_layer6_reshape</title>
<path fill="none" stroke="black" d="M939,-13493.77C939,-13485.47 939,-13476.08 939,-13467.18"/>
<polygon fill="black" stroke="black" points="942.5,-13467.04 939,-13457.04 935.5,-13467.04 942.5,-13467.04"/>
</g>
<!-- gpu1_layer6_attn -->
<g id="node363" class="node">
<title>gpu1_layer6_attn</title>
<polygon fill="lightblue" stroke="black" points="1003,-13367.93 875,-13367.93 875,-13315.93 1003,-13315.93 1003,-13367.93"/>
<text text-anchor="middle" x="939" y="-13355.93" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="939" y="-13344.93" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-13333.93" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-13322.93" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer6_reshape&#45;&gt;gpu1_layer6_attn -->
<g id="edge454" class="edge">
<title>gpu1_layer6_reshape&#45;&gt;gpu1_layer6_attn</title>
<path fill="none" stroke="black" d="M939,-13404.77C939,-13396.47 939,-13387.08 939,-13378.18"/>
<polygon fill="black" stroke="black" points="942.5,-13378.04 939,-13368.04 935.5,-13378.04 942.5,-13378.04"/>
</g>
<!-- gpu1_layer6_attn_reshape -->
<g id="node365" class="node">
<title>gpu1_layer6_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1000,-13278.93 878,-13278.93 878,-13226.93 1000,-13226.93 1000,-13278.93"/>
<text text-anchor="middle" x="939" y="-13266.93" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="939" y="-13255.93" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-13244.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-13233.93" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer6_attn&#45;&gt;gpu1_layer6_attn_reshape -->
<g id="edge455" class="edge">
<title>gpu1_layer6_attn&#45;&gt;gpu1_layer6_attn_reshape</title>
<path fill="none" stroke="black" d="M939,-13315.77C939,-13307.47 939,-13298.08 939,-13289.18"/>
<polygon fill="black" stroke="black" points="942.5,-13289.04 939,-13279.04 935.5,-13289.04 942.5,-13289.04"/>
</g>
<!-- gpu1_layer6_attn_out -->
<g id="node364" class="node">
<title>gpu1_layer6_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1000,-13189.93 878,-13189.93 878,-13137.93 1000,-13137.93 1000,-13189.93"/>
<text text-anchor="middle" x="939" y="-13177.93" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="939" y="-13166.93" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-13155.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-13144.93" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer6_kv_update -->
<g id="node366" class="node">
<title>gpu1_layer6_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="939" cy="-13064.16" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="939" y="-13078.16" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="939" y="-13067.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-13056.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-13045.16" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer6_attn_out&#45;&gt;gpu1_layer6_kv_update -->
<g id="edge457" class="edge">
<title>gpu1_layer6_attn_out&#45;&gt;gpu1_layer6_kv_update</title>
<path fill="none" stroke="black" d="M939,-13137.75C939,-13129.61 939,-13120.32 939,-13111.16"/>
<polygon fill="black" stroke="black" points="942.5,-13110.94 939,-13100.94 935.5,-13110.94 942.5,-13110.94"/>
</g>
<!-- gpu1_layer6_attn_reshape&#45;&gt;gpu1_layer6_attn_out -->
<g id="edge456" class="edge">
<title>gpu1_layer6_attn_reshape&#45;&gt;gpu1_layer6_attn_out</title>
<path fill="none" stroke="black" d="M939,-13226.77C939,-13218.47 939,-13209.08 939,-13200.18"/>
<polygon fill="black" stroke="black" points="942.5,-13200.04 939,-13190.04 935.5,-13200.04 942.5,-13200.04"/>
</g>
<!-- gpu1_layer6_res1 -->
<g id="node367" class="node">
<title>gpu1_layer6_res1</title>
<polygon fill="lightblue" stroke="black" points="1000,-12990.39 878,-12990.39 878,-12938.39 1000,-12938.39 1000,-12990.39"/>
<text text-anchor="middle" x="939" y="-12978.39" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="939" y="-12967.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-12956.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-12945.39" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer6_kv_update&#45;&gt;gpu1_layer6_res1 -->
<g id="edge458" class="edge">
<title>gpu1_layer6_kv_update&#45;&gt;gpu1_layer6_res1</title>
<path fill="none" stroke="black" d="M939,-13027.31C939,-13018.63 939,-13009.36 939,-13000.71"/>
<polygon fill="black" stroke="black" points="942.5,-13000.54 939,-12990.54 935.5,-13000.54 942.5,-13000.54"/>
</g>
<!-- gpu1_layer6_ln2 -->
<g id="node368" class="node">
<title>gpu1_layer6_ln2</title>
<polygon fill="lightblue" stroke="black" points="1000,-12901.39 878,-12901.39 878,-12849.39 1000,-12849.39 1000,-12901.39"/>
<text text-anchor="middle" x="939" y="-12889.39" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="939" y="-12878.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-12867.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-12856.39" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer6_res1&#45;&gt;gpu1_layer6_ln2 -->
<g id="edge459" class="edge">
<title>gpu1_layer6_res1&#45;&gt;gpu1_layer6_ln2</title>
<path fill="none" stroke="black" d="M939,-12938.23C939,-12929.93 939,-12920.55 939,-12911.64"/>
<polygon fill="black" stroke="black" points="942.5,-12911.5 939,-12901.5 935.5,-12911.5 942.5,-12911.5"/>
</g>
<!-- gpu1_layer6_routing -->
<g id="node369" class="node">
<title>gpu1_layer6_routing</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-12812.39 864.29,-12812.39 812.53,-12686.39 1013.71,-12686.39 1065.47,-12812.39"/>
<text text-anchor="middle" x="939" y="-12768.89" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="939" y="-12757.89" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-12746.89" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-12735.89" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="939" y="-12724.89" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer6_ln2&#45;&gt;gpu1_layer6_routing -->
<g id="edge460" class="edge">
<title>gpu1_layer6_ln2&#45;&gt;gpu1_layer6_routing</title>
<path fill="none" stroke="black" d="M939,-12849.3C939,-12841.37 939,-12832.17 939,-12822.64"/>
<polygon fill="black" stroke="black" points="942.5,-12822.63 939,-12812.63 935.5,-12822.63 942.5,-12822.63"/>
</g>
<!-- gpu1_layer6_expert0 -->
<g id="node370" class="node">
<title>gpu1_layer6_expert0</title>
<polygon fill="lightblue" stroke="black" points="720,-12640.39 598,-12640.39 598,-12588.39 720,-12588.39 720,-12640.39"/>
<text text-anchor="middle" x="659" y="-12628.39" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="659" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer6_routing&#45;&gt;gpu1_layer6_expert0 -->
<g id="edge447" class="edge">
<title>gpu1_layer6_routing&#45;&gt;gpu1_layer6_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M813.33,-12688.7C781.34,-12673.5 748.34,-12657.83 721.11,-12644.89"/>
<polygon fill="black" stroke="black" points="722.26,-12641.57 711.73,-12640.44 719.26,-12647.89 722.26,-12641.57"/>
<text text-anchor="middle" x="795.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer6_expert1 -->
<g id="node371" class="node">
<title>gpu1_layer6_expert1</title>
<polygon fill="lightblue" stroke="black" points="860,-12640.39 738,-12640.39 738,-12588.39 860,-12588.39 860,-12640.39"/>
<text text-anchor="middle" x="799" y="-12628.39" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="799" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer6_routing&#45;&gt;gpu1_layer6_expert1 -->
<g id="edge448" class="edge">
<title>gpu1_layer6_routing&#45;&gt;gpu1_layer6_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M873.51,-12686.17C859.48,-12672.85 845.21,-12659.29 832.97,-12647.66"/>
<polygon fill="black" stroke="black" points="835.29,-12645.03 825.63,-12640.68 830.46,-12650.11 835.29,-12645.03"/>
<text text-anchor="middle" x="882.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer6_expert2 -->
<g id="node372" class="node">
<title>gpu1_layer6_expert2</title>
<polygon fill="lightblue" stroke="black" points="1000,-12640.39 878,-12640.39 878,-12588.39 1000,-12588.39 1000,-12640.39"/>
<text text-anchor="middle" x="939" y="-12628.39" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="939" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer6_routing&#45;&gt;gpu1_layer6_expert2 -->
<g id="edge449" class="edge">
<title>gpu1_layer6_routing&#45;&gt;gpu1_layer6_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M939,-12686.17C939,-12674.11 939,-12661.85 939,-12651"/>
<polygon fill="black" stroke="black" points="942.5,-12650.68 939,-12640.68 935.5,-12650.68 942.5,-12650.68"/>
<text text-anchor="middle" x="968.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer6_expert3 -->
<g id="node373" class="node">
<title>gpu1_layer6_expert3</title>
<polygon fill="lightblue" stroke="black" points="1140,-12640.39 1018,-12640.39 1018,-12588.39 1140,-12588.39 1140,-12640.39"/>
<text text-anchor="middle" x="1079" y="-12628.39" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1079" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer6_routing&#45;&gt;gpu1_layer6_expert3 -->
<g id="edge450" class="edge">
<title>gpu1_layer6_routing&#45;&gt;gpu1_layer6_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1004.49,-12686.17C1018.52,-12672.85 1032.79,-12659.29 1045.03,-12647.66"/>
<polygon fill="black" stroke="black" points="1047.54,-12650.11 1052.37,-12640.68 1042.71,-12645.03 1047.54,-12650.11"/>
<text text-anchor="middle" x="1063.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer6_expert_agg -->
<g id="node374" class="node">
<title>gpu1_layer6_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-12551.39 864.29,-12551.39 812.53,-12447.39 1013.71,-12447.39 1065.47,-12551.39"/>
<text text-anchor="middle" x="939" y="-12513.39" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="939" y="-12502.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-12491.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-12480.39" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer6_routing&#45;&gt;gpu1_layer6_expert_agg -->
<g id="edge465" class="edge">
<title>gpu1_layer6_routing&#45;&gt;gpu1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M1028.22,-12721.47C1101.96,-12694.32 1188.6,-12647.92 1149,-12588.39 1128.44,-12557.48 1094.7,-12537.4 1060.22,-12524.38"/>
<polygon fill="black" stroke="black" points="1061.08,-12520.97 1050.48,-12520.88 1058.71,-12527.55 1061.08,-12520.97"/>
</g>
<!-- gpu1_layer6_expert0&#45;&gt;gpu1_layer6_expert_agg -->
<g id="edge461" class="edge">
<title>gpu1_layer6_expert0&#45;&gt;gpu1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M720.1,-12588.73C756.98,-12573.85 804.7,-12554.59 846.16,-12537.86"/>
<polygon fill="black" stroke="black" points="847.5,-12541.09 855.46,-12534.11 844.88,-12534.6 847.5,-12541.09"/>
</g>
<!-- gpu1_layer6_expert1&#45;&gt;gpu1_layer6_expert_agg -->
<g id="edge462" class="edge">
<title>gpu1_layer6_expert1&#45;&gt;gpu1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M830.07,-12588.31C841.32,-12579.24 854.53,-12568.57 867.8,-12557.86"/>
<polygon fill="black" stroke="black" points="870.02,-12560.57 875.6,-12551.56 865.62,-12555.12 870.02,-12560.57"/>
</g>
<!-- gpu1_layer6_expert2&#45;&gt;gpu1_layer6_expert_agg -->
<g id="edge463" class="edge">
<title>gpu1_layer6_expert2&#45;&gt;gpu1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M939,-12588.31C939,-12580.39 939,-12571.25 939,-12561.93"/>
<polygon fill="black" stroke="black" points="942.5,-12561.79 939,-12551.79 935.5,-12561.79 942.5,-12561.79"/>
</g>
<!-- gpu1_layer6_expert3&#45;&gt;gpu1_layer6_expert_agg -->
<g id="edge464" class="edge">
<title>gpu1_layer6_expert3&#45;&gt;gpu1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M1047.93,-12588.31C1036.68,-12579.24 1023.47,-12568.57 1010.2,-12557.86"/>
<polygon fill="black" stroke="black" points="1012.38,-12555.12 1002.4,-12551.56 1007.98,-12560.57 1012.38,-12555.12"/>
</g>
<!-- gpu1_layer6_res2 -->
<g id="node375" class="node">
<title>gpu1_layer6_res2</title>
<polygon fill="lightblue" stroke="black" points="1000,-12410.39 878,-12410.39 878,-12358.39 1000,-12358.39 1000,-12410.39"/>
<text text-anchor="middle" x="939" y="-12398.39" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="939" y="-12387.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-12376.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-12365.39" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer6_expert_agg&#45;&gt;gpu1_layer6_res2 -->
<g id="edge466" class="edge">
<title>gpu1_layer6_expert_agg&#45;&gt;gpu1_layer6_res2</title>
<path fill="none" stroke="black" d="M939,-12447.18C939,-12438.23 939,-12429.1 939,-12420.7"/>
<polygon fill="black" stroke="black" points="942.5,-12420.52 939,-12410.52 935.5,-12420.52 942.5,-12420.52"/>
</g>
<!-- gpu1_layer7_ln1 -->
<g id="node376" class="node">
<title>gpu1_layer7_ln1</title>
<polygon fill="lightblue" stroke="black" points="1000,-12321.39 878,-12321.39 878,-12269.39 1000,-12269.39 1000,-12321.39"/>
<text text-anchor="middle" x="939" y="-12309.39" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="939" y="-12298.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-12287.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-12276.39" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer6_res2&#45;&gt;gpu1_layer7_ln1 -->
<g id="edge471" class="edge">
<title>gpu1_layer6_res2&#45;&gt;gpu1_layer7_ln1</title>
<path fill="none" stroke="black" d="M939,-12358.23C939,-12349.93 939,-12340.55 939,-12331.64"/>
<polygon fill="black" stroke="black" points="942.5,-12331.5 939,-12321.5 935.5,-12331.5 942.5,-12331.5"/>
</g>
<!-- gpu1_layer7_qkv -->
<g id="node377" class="node">
<title>gpu1_layer7_qkv</title>
<polygon fill="lightblue" stroke="black" points="1000,-12232.39 878,-12232.39 878,-12180.39 1000,-12180.39 1000,-12232.39"/>
<text text-anchor="middle" x="939" y="-12220.39" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="939" y="-12209.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-12198.39" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-12187.39" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer7_ln1&#45;&gt;gpu1_layer7_qkv -->
<g id="edge472" class="edge">
<title>gpu1_layer7_ln1&#45;&gt;gpu1_layer7_qkv</title>
<path fill="none" stroke="black" d="M939,-12269.23C939,-12260.93 939,-12251.55 939,-12242.64"/>
<polygon fill="black" stroke="black" points="942.5,-12242.5 939,-12232.5 935.5,-12242.5 942.5,-12242.5"/>
</g>
<!-- gpu1_layer7_reshape -->
<g id="node378" class="node">
<title>gpu1_layer7_reshape</title>
<polygon fill="lightblue" stroke="black" points="1003,-12143.39 875,-12143.39 875,-12091.39 1003,-12091.39 1003,-12143.39"/>
<text text-anchor="middle" x="939" y="-12131.39" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="939" y="-12120.39" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-12109.39" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-12098.39" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer7_qkv&#45;&gt;gpu1_layer7_reshape -->
<g id="edge473" class="edge">
<title>gpu1_layer7_qkv&#45;&gt;gpu1_layer7_reshape</title>
<path fill="none" stroke="black" d="M939,-12180.23C939,-12171.93 939,-12162.55 939,-12153.64"/>
<polygon fill="black" stroke="black" points="942.5,-12153.5 939,-12143.5 935.5,-12153.5 942.5,-12153.5"/>
</g>
<!-- gpu1_layer7_attn -->
<g id="node379" class="node">
<title>gpu1_layer7_attn</title>
<polygon fill="lightblue" stroke="black" points="1003,-12054.39 875,-12054.39 875,-12002.39 1003,-12002.39 1003,-12054.39"/>
<text text-anchor="middle" x="939" y="-12042.39" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="939" y="-12031.39" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-12020.39" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-12009.39" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer7_reshape&#45;&gt;gpu1_layer7_attn -->
<g id="edge474" class="edge">
<title>gpu1_layer7_reshape&#45;&gt;gpu1_layer7_attn</title>
<path fill="none" stroke="black" d="M939,-12091.23C939,-12082.93 939,-12073.55 939,-12064.64"/>
<polygon fill="black" stroke="black" points="942.5,-12064.5 939,-12054.5 935.5,-12064.5 942.5,-12064.5"/>
</g>
<!-- gpu1_layer7_attn_reshape -->
<g id="node381" class="node">
<title>gpu1_layer7_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1000,-11965.39 878,-11965.39 878,-11913.39 1000,-11913.39 1000,-11965.39"/>
<text text-anchor="middle" x="939" y="-11953.39" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="939" y="-11942.39" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-11931.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-11920.39" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer7_attn&#45;&gt;gpu1_layer7_attn_reshape -->
<g id="edge475" class="edge">
<title>gpu1_layer7_attn&#45;&gt;gpu1_layer7_attn_reshape</title>
<path fill="none" stroke="black" d="M939,-12002.23C939,-11993.93 939,-11984.55 939,-11975.64"/>
<polygon fill="black" stroke="black" points="942.5,-11975.5 939,-11965.5 935.5,-11975.5 942.5,-11975.5"/>
</g>
<!-- gpu1_layer7_attn_out -->
<g id="node380" class="node">
<title>gpu1_layer7_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1000,-11876.39 878,-11876.39 878,-11824.39 1000,-11824.39 1000,-11876.39"/>
<text text-anchor="middle" x="939" y="-11864.39" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="939" y="-11853.39" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-11842.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-11831.39" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer7_kv_update -->
<g id="node382" class="node">
<title>gpu1_layer7_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="939" cy="-11750.62" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="939" y="-11764.62" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="939" y="-11753.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-11742.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-11731.62" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer7_attn_out&#45;&gt;gpu1_layer7_kv_update -->
<g id="edge477" class="edge">
<title>gpu1_layer7_attn_out&#45;&gt;gpu1_layer7_kv_update</title>
<path fill="none" stroke="black" d="M939,-11824.21C939,-11816.07 939,-11806.78 939,-11797.62"/>
<polygon fill="black" stroke="black" points="942.5,-11797.4 939,-11787.4 935.5,-11797.4 942.5,-11797.4"/>
</g>
<!-- gpu1_layer7_attn_reshape&#45;&gt;gpu1_layer7_attn_out -->
<g id="edge476" class="edge">
<title>gpu1_layer7_attn_reshape&#45;&gt;gpu1_layer7_attn_out</title>
<path fill="none" stroke="black" d="M939,-11913.23C939,-11904.93 939,-11895.55 939,-11886.64"/>
<polygon fill="black" stroke="black" points="942.5,-11886.5 939,-11876.5 935.5,-11886.5 942.5,-11886.5"/>
</g>
<!-- gpu1_layer7_res1 -->
<g id="node383" class="node">
<title>gpu1_layer7_res1</title>
<polygon fill="lightblue" stroke="black" points="1000,-11676.85 878,-11676.85 878,-11624.85 1000,-11624.85 1000,-11676.85"/>
<text text-anchor="middle" x="939" y="-11664.85" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="939" y="-11653.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-11642.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-11631.85" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer7_kv_update&#45;&gt;gpu1_layer7_res1 -->
<g id="edge478" class="edge">
<title>gpu1_layer7_kv_update&#45;&gt;gpu1_layer7_res1</title>
<path fill="none" stroke="black" d="M939,-11713.77C939,-11705.09 939,-11695.82 939,-11687.17"/>
<polygon fill="black" stroke="black" points="942.5,-11687 939,-11677 935.5,-11687 942.5,-11687"/>
</g>
<!-- gpu1_layer7_ln2 -->
<g id="node384" class="node">
<title>gpu1_layer7_ln2</title>
<polygon fill="lightblue" stroke="black" points="1000,-11587.85 878,-11587.85 878,-11535.85 1000,-11535.85 1000,-11587.85"/>
<text text-anchor="middle" x="939" y="-11575.85" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="939" y="-11564.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-11553.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-11542.85" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer7_res1&#45;&gt;gpu1_layer7_ln2 -->
<g id="edge479" class="edge">
<title>gpu1_layer7_res1&#45;&gt;gpu1_layer7_ln2</title>
<path fill="none" stroke="black" d="M939,-11624.69C939,-11616.39 939,-11607.01 939,-11598.1"/>
<polygon fill="black" stroke="black" points="942.5,-11597.96 939,-11587.96 935.5,-11597.96 942.5,-11597.96"/>
</g>
<!-- gpu1_layer7_routing -->
<g id="node385" class="node">
<title>gpu1_layer7_routing</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-11498.85 864.29,-11498.85 812.53,-11372.85 1013.71,-11372.85 1065.47,-11498.85"/>
<text text-anchor="middle" x="939" y="-11455.35" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="939" y="-11444.35" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-11433.35" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-11422.35" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="939" y="-11411.35" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer7_ln2&#45;&gt;gpu1_layer7_routing -->
<g id="edge480" class="edge">
<title>gpu1_layer7_ln2&#45;&gt;gpu1_layer7_routing</title>
<path fill="none" stroke="black" d="M939,-11535.76C939,-11527.83 939,-11518.63 939,-11509.1"/>
<polygon fill="black" stroke="black" points="942.5,-11509.09 939,-11499.09 935.5,-11509.09 942.5,-11509.09"/>
</g>
<!-- gpu1_layer7_expert0 -->
<g id="node386" class="node">
<title>gpu1_layer7_expert0</title>
<polygon fill="lightblue" stroke="black" points="720,-11326.85 598,-11326.85 598,-11274.85 720,-11274.85 720,-11326.85"/>
<text text-anchor="middle" x="659" y="-11314.85" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="659" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer7_routing&#45;&gt;gpu1_layer7_expert0 -->
<g id="edge467" class="edge">
<title>gpu1_layer7_routing&#45;&gt;gpu1_layer7_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M813.33,-11375.16C781.34,-11359.96 748.34,-11344.29 721.11,-11331.35"/>
<polygon fill="black" stroke="black" points="722.26,-11328.03 711.73,-11326.9 719.26,-11334.35 722.26,-11328.03"/>
<text text-anchor="middle" x="795.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer7_expert1 -->
<g id="node387" class="node">
<title>gpu1_layer7_expert1</title>
<polygon fill="lightblue" stroke="black" points="860,-11326.85 738,-11326.85 738,-11274.85 860,-11274.85 860,-11326.85"/>
<text text-anchor="middle" x="799" y="-11314.85" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="799" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer7_routing&#45;&gt;gpu1_layer7_expert1 -->
<g id="edge468" class="edge">
<title>gpu1_layer7_routing&#45;&gt;gpu1_layer7_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M873.51,-11372.64C859.48,-11359.31 845.21,-11345.76 832.97,-11334.12"/>
<polygon fill="black" stroke="black" points="835.29,-11331.5 825.63,-11327.15 830.46,-11336.57 835.29,-11331.5"/>
<text text-anchor="middle" x="882.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer7_expert2 -->
<g id="node388" class="node">
<title>gpu1_layer7_expert2</title>
<polygon fill="lightblue" stroke="black" points="1000,-11326.85 878,-11326.85 878,-11274.85 1000,-11274.85 1000,-11326.85"/>
<text text-anchor="middle" x="939" y="-11314.85" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="939" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer7_routing&#45;&gt;gpu1_layer7_expert2 -->
<g id="edge469" class="edge">
<title>gpu1_layer7_routing&#45;&gt;gpu1_layer7_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M939,-11372.64C939,-11360.57 939,-11348.31 939,-11337.46"/>
<polygon fill="black" stroke="black" points="942.5,-11337.15 939,-11327.15 935.5,-11337.15 942.5,-11337.15"/>
<text text-anchor="middle" x="968.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer7_expert3 -->
<g id="node389" class="node">
<title>gpu1_layer7_expert3</title>
<polygon fill="lightblue" stroke="black" points="1140,-11326.85 1018,-11326.85 1018,-11274.85 1140,-11274.85 1140,-11326.85"/>
<text text-anchor="middle" x="1079" y="-11314.85" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1079" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer7_routing&#45;&gt;gpu1_layer7_expert3 -->
<g id="edge470" class="edge">
<title>gpu1_layer7_routing&#45;&gt;gpu1_layer7_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1004.49,-11372.64C1018.52,-11359.31 1032.79,-11345.76 1045.03,-11334.12"/>
<polygon fill="black" stroke="black" points="1047.54,-11336.57 1052.37,-11327.15 1042.71,-11331.5 1047.54,-11336.57"/>
<text text-anchor="middle" x="1063.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer7_expert_agg -->
<g id="node390" class="node">
<title>gpu1_layer7_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-11237.85 864.29,-11237.85 812.53,-11133.85 1013.71,-11133.85 1065.47,-11237.85"/>
<text text-anchor="middle" x="939" y="-11199.85" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="939" y="-11188.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-11177.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-11166.85" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer7_routing&#45;&gt;gpu1_layer7_expert_agg -->
<g id="edge485" class="edge">
<title>gpu1_layer7_routing&#45;&gt;gpu1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M1028.22,-11407.94C1101.96,-11380.78 1188.6,-11334.39 1149,-11274.85 1128.44,-11243.94 1094.7,-11223.87 1060.22,-11210.84"/>
<polygon fill="black" stroke="black" points="1061.08,-11207.43 1050.48,-11207.35 1058.71,-11214.02 1061.08,-11207.43"/>
</g>
<!-- gpu1_layer7_expert0&#45;&gt;gpu1_layer7_expert_agg -->
<g id="edge481" class="edge">
<title>gpu1_layer7_expert0&#45;&gt;gpu1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M720.1,-11275.19C756.98,-11260.31 804.7,-11241.05 846.16,-11224.32"/>
<polygon fill="black" stroke="black" points="847.5,-11227.56 855.46,-11220.57 844.88,-11221.06 847.5,-11227.56"/>
</g>
<!-- gpu1_layer7_expert1&#45;&gt;gpu1_layer7_expert_agg -->
<g id="edge482" class="edge">
<title>gpu1_layer7_expert1&#45;&gt;gpu1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M830.07,-11274.77C841.32,-11265.7 854.53,-11255.03 867.8,-11244.32"/>
<polygon fill="black" stroke="black" points="870.02,-11247.03 875.6,-11238.02 865.62,-11241.58 870.02,-11247.03"/>
</g>
<!-- gpu1_layer7_expert2&#45;&gt;gpu1_layer7_expert_agg -->
<g id="edge483" class="edge">
<title>gpu1_layer7_expert2&#45;&gt;gpu1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M939,-11274.77C939,-11266.85 939,-11257.71 939,-11248.39"/>
<polygon fill="black" stroke="black" points="942.5,-11248.25 939,-11238.25 935.5,-11248.25 942.5,-11248.25"/>
</g>
<!-- gpu1_layer7_expert3&#45;&gt;gpu1_layer7_expert_agg -->
<g id="edge484" class="edge">
<title>gpu1_layer7_expert3&#45;&gt;gpu1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M1047.93,-11274.77C1036.68,-11265.7 1023.47,-11255.03 1010.2,-11244.32"/>
<polygon fill="black" stroke="black" points="1012.38,-11241.58 1002.4,-11238.02 1007.98,-11247.03 1012.38,-11241.58"/>
</g>
<!-- gpu1_layer7_res2 -->
<g id="node391" class="node">
<title>gpu1_layer7_res2</title>
<polygon fill="lightblue" stroke="black" points="1000,-11096.85 878,-11096.85 878,-11044.85 1000,-11044.85 1000,-11096.85"/>
<text text-anchor="middle" x="939" y="-11084.85" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="939" y="-11073.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-11062.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-11051.85" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer7_expert_agg&#45;&gt;gpu1_layer7_res2 -->
<g id="edge486" class="edge">
<title>gpu1_layer7_expert_agg&#45;&gt;gpu1_layer7_res2</title>
<path fill="none" stroke="black" d="M939,-11133.64C939,-11124.69 939,-11115.56 939,-11107.16"/>
<polygon fill="black" stroke="black" points="942.5,-11106.98 939,-11096.98 935.5,-11106.98 942.5,-11106.98"/>
</g>
<!-- gpu1_layer8_ln1 -->
<g id="node392" class="node">
<title>gpu1_layer8_ln1</title>
<polygon fill="lightblue" stroke="black" points="1000,-11007.85 878,-11007.85 878,-10955.85 1000,-10955.85 1000,-11007.85"/>
<text text-anchor="middle" x="939" y="-10995.85" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="939" y="-10984.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-10973.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-10962.85" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer7_res2&#45;&gt;gpu1_layer8_ln1 -->
<g id="edge491" class="edge">
<title>gpu1_layer7_res2&#45;&gt;gpu1_layer8_ln1</title>
<path fill="none" stroke="black" d="M939,-11044.69C939,-11036.39 939,-11027.01 939,-11018.1"/>
<polygon fill="black" stroke="black" points="942.5,-11017.96 939,-11007.96 935.5,-11017.96 942.5,-11017.96"/>
</g>
<!-- gpu1_layer8_qkv -->
<g id="node393" class="node">
<title>gpu1_layer8_qkv</title>
<polygon fill="lightblue" stroke="black" points="1000,-10918.85 878,-10918.85 878,-10866.85 1000,-10866.85 1000,-10918.85"/>
<text text-anchor="middle" x="939" y="-10906.85" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="939" y="-10895.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-10884.85" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-10873.85" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer8_ln1&#45;&gt;gpu1_layer8_qkv -->
<g id="edge492" class="edge">
<title>gpu1_layer8_ln1&#45;&gt;gpu1_layer8_qkv</title>
<path fill="none" stroke="black" d="M939,-10955.69C939,-10947.39 939,-10938.01 939,-10929.1"/>
<polygon fill="black" stroke="black" points="942.5,-10928.96 939,-10918.96 935.5,-10928.96 942.5,-10928.96"/>
</g>
<!-- gpu1_layer8_reshape -->
<g id="node394" class="node">
<title>gpu1_layer8_reshape</title>
<polygon fill="lightblue" stroke="black" points="1003,-10829.85 875,-10829.85 875,-10777.85 1003,-10777.85 1003,-10829.85"/>
<text text-anchor="middle" x="939" y="-10817.85" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="939" y="-10806.85" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-10795.85" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-10784.85" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer8_qkv&#45;&gt;gpu1_layer8_reshape -->
<g id="edge493" class="edge">
<title>gpu1_layer8_qkv&#45;&gt;gpu1_layer8_reshape</title>
<path fill="none" stroke="black" d="M939,-10866.69C939,-10858.39 939,-10849.01 939,-10840.1"/>
<polygon fill="black" stroke="black" points="942.5,-10839.96 939,-10829.96 935.5,-10839.96 942.5,-10839.96"/>
</g>
<!-- gpu1_layer8_attn -->
<g id="node395" class="node">
<title>gpu1_layer8_attn</title>
<polygon fill="lightblue" stroke="black" points="1003,-10740.85 875,-10740.85 875,-10688.85 1003,-10688.85 1003,-10740.85"/>
<text text-anchor="middle" x="939" y="-10728.85" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="939" y="-10717.85" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-10706.85" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-10695.85" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer8_reshape&#45;&gt;gpu1_layer8_attn -->
<g id="edge494" class="edge">
<title>gpu1_layer8_reshape&#45;&gt;gpu1_layer8_attn</title>
<path fill="none" stroke="black" d="M939,-10777.69C939,-10769.39 939,-10760.01 939,-10751.1"/>
<polygon fill="black" stroke="black" points="942.5,-10750.96 939,-10740.96 935.5,-10750.96 942.5,-10750.96"/>
</g>
<!-- gpu1_layer8_attn_reshape -->
<g id="node397" class="node">
<title>gpu1_layer8_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1000,-10651.85 878,-10651.85 878,-10599.85 1000,-10599.85 1000,-10651.85"/>
<text text-anchor="middle" x="939" y="-10639.85" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="939" y="-10628.85" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-10617.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-10606.85" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer8_attn&#45;&gt;gpu1_layer8_attn_reshape -->
<g id="edge495" class="edge">
<title>gpu1_layer8_attn&#45;&gt;gpu1_layer8_attn_reshape</title>
<path fill="none" stroke="black" d="M939,-10688.69C939,-10680.39 939,-10671.01 939,-10662.1"/>
<polygon fill="black" stroke="black" points="942.5,-10661.96 939,-10651.96 935.5,-10661.96 942.5,-10661.96"/>
</g>
<!-- gpu1_layer8_attn_out -->
<g id="node396" class="node">
<title>gpu1_layer8_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1000,-10562.85 878,-10562.85 878,-10510.85 1000,-10510.85 1000,-10562.85"/>
<text text-anchor="middle" x="939" y="-10550.85" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="939" y="-10539.85" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-10528.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-10517.85" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer8_kv_update -->
<g id="node398" class="node">
<title>gpu1_layer8_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="939" cy="-10437.08" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="939" y="-10451.08" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="939" y="-10440.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-10429.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-10418.08" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer8_attn_out&#45;&gt;gpu1_layer8_kv_update -->
<g id="edge497" class="edge">
<title>gpu1_layer8_attn_out&#45;&gt;gpu1_layer8_kv_update</title>
<path fill="none" stroke="black" d="M939,-10510.67C939,-10502.53 939,-10493.24 939,-10484.08"/>
<polygon fill="black" stroke="black" points="942.5,-10483.86 939,-10473.86 935.5,-10483.86 942.5,-10483.86"/>
</g>
<!-- gpu1_layer8_attn_reshape&#45;&gt;gpu1_layer8_attn_out -->
<g id="edge496" class="edge">
<title>gpu1_layer8_attn_reshape&#45;&gt;gpu1_layer8_attn_out</title>
<path fill="none" stroke="black" d="M939,-10599.69C939,-10591.39 939,-10582.01 939,-10573.1"/>
<polygon fill="black" stroke="black" points="942.5,-10572.96 939,-10562.96 935.5,-10572.96 942.5,-10572.96"/>
</g>
<!-- gpu1_layer8_res1 -->
<g id="node399" class="node">
<title>gpu1_layer8_res1</title>
<polygon fill="lightblue" stroke="black" points="1000,-10363.31 878,-10363.31 878,-10311.31 1000,-10311.31 1000,-10363.31"/>
<text text-anchor="middle" x="939" y="-10351.31" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="939" y="-10340.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-10329.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-10318.31" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer8_kv_update&#45;&gt;gpu1_layer8_res1 -->
<g id="edge498" class="edge">
<title>gpu1_layer8_kv_update&#45;&gt;gpu1_layer8_res1</title>
<path fill="none" stroke="black" d="M939,-10400.23C939,-10391.55 939,-10382.28 939,-10373.63"/>
<polygon fill="black" stroke="black" points="942.5,-10373.46 939,-10363.46 935.5,-10373.46 942.5,-10373.46"/>
</g>
<!-- gpu1_layer8_ln2 -->
<g id="node400" class="node">
<title>gpu1_layer8_ln2</title>
<polygon fill="lightblue" stroke="black" points="1000,-10274.31 878,-10274.31 878,-10222.31 1000,-10222.31 1000,-10274.31"/>
<text text-anchor="middle" x="939" y="-10262.31" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="939" y="-10251.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-10240.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-10229.31" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer8_res1&#45;&gt;gpu1_layer8_ln2 -->
<g id="edge499" class="edge">
<title>gpu1_layer8_res1&#45;&gt;gpu1_layer8_ln2</title>
<path fill="none" stroke="black" d="M939,-10311.15C939,-10302.85 939,-10293.47 939,-10284.56"/>
<polygon fill="black" stroke="black" points="942.5,-10284.42 939,-10274.42 935.5,-10284.42 942.5,-10284.42"/>
</g>
<!-- gpu1_layer8_routing -->
<g id="node401" class="node">
<title>gpu1_layer8_routing</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-10185.31 864.29,-10185.31 812.53,-10059.31 1013.71,-10059.31 1065.47,-10185.31"/>
<text text-anchor="middle" x="939" y="-10141.81" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="939" y="-10130.81" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-10119.81" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-10108.81" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="939" y="-10097.81" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer8_ln2&#45;&gt;gpu1_layer8_routing -->
<g id="edge500" class="edge">
<title>gpu1_layer8_ln2&#45;&gt;gpu1_layer8_routing</title>
<path fill="none" stroke="black" d="M939,-10222.22C939,-10214.29 939,-10205.09 939,-10195.56"/>
<polygon fill="black" stroke="black" points="942.5,-10195.55 939,-10185.55 935.5,-10195.55 942.5,-10195.55"/>
</g>
<!-- gpu1_layer8_expert0 -->
<g id="node402" class="node">
<title>gpu1_layer8_expert0</title>
<polygon fill="lightblue" stroke="black" points="720,-10013.31 598,-10013.31 598,-9961.31 720,-9961.31 720,-10013.31"/>
<text text-anchor="middle" x="659" y="-10001.31" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="659" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer8_routing&#45;&gt;gpu1_layer8_expert0 -->
<g id="edge487" class="edge">
<title>gpu1_layer8_routing&#45;&gt;gpu1_layer8_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M813.33,-10061.62C781.34,-10046.42 748.34,-10030.75 721.11,-10017.81"/>
<polygon fill="black" stroke="black" points="722.26,-10014.49 711.73,-10013.36 719.26,-10020.81 722.26,-10014.49"/>
<text text-anchor="middle" x="795.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer8_expert1 -->
<g id="node403" class="node">
<title>gpu1_layer8_expert1</title>
<polygon fill="lightblue" stroke="black" points="860,-10013.31 738,-10013.31 738,-9961.31 860,-9961.31 860,-10013.31"/>
<text text-anchor="middle" x="799" y="-10001.31" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="799" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer8_routing&#45;&gt;gpu1_layer8_expert1 -->
<g id="edge488" class="edge">
<title>gpu1_layer8_routing&#45;&gt;gpu1_layer8_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M873.51,-10059.1C859.48,-10045.77 845.21,-10032.22 832.97,-10020.58"/>
<polygon fill="black" stroke="black" points="835.29,-10017.96 825.63,-10013.61 830.46,-10023.03 835.29,-10017.96"/>
<text text-anchor="middle" x="882.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer8_expert2 -->
<g id="node404" class="node">
<title>gpu1_layer8_expert2</title>
<polygon fill="lightblue" stroke="black" points="1000,-10013.31 878,-10013.31 878,-9961.31 1000,-9961.31 1000,-10013.31"/>
<text text-anchor="middle" x="939" y="-10001.31" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="939" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer8_routing&#45;&gt;gpu1_layer8_expert2 -->
<g id="edge489" class="edge">
<title>gpu1_layer8_routing&#45;&gt;gpu1_layer8_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M939,-10059.1C939,-10047.03 939,-10034.77 939,-10023.92"/>
<polygon fill="black" stroke="black" points="942.5,-10023.61 939,-10013.61 935.5,-10023.61 942.5,-10023.61"/>
<text text-anchor="middle" x="968.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer8_expert3 -->
<g id="node405" class="node">
<title>gpu1_layer8_expert3</title>
<polygon fill="lightblue" stroke="black" points="1140,-10013.31 1018,-10013.31 1018,-9961.31 1140,-9961.31 1140,-10013.31"/>
<text text-anchor="middle" x="1079" y="-10001.31" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1079" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer8_routing&#45;&gt;gpu1_layer8_expert3 -->
<g id="edge490" class="edge">
<title>gpu1_layer8_routing&#45;&gt;gpu1_layer8_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1004.49,-10059.1C1018.52,-10045.77 1032.79,-10032.22 1045.03,-10020.58"/>
<polygon fill="black" stroke="black" points="1047.54,-10023.03 1052.37,-10013.61 1042.71,-10017.96 1047.54,-10023.03"/>
<text text-anchor="middle" x="1063.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer8_expert_agg -->
<g id="node406" class="node">
<title>gpu1_layer8_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-9924.31 864.29,-9924.31 812.53,-9820.31 1013.71,-9820.31 1065.47,-9924.31"/>
<text text-anchor="middle" x="939" y="-9886.31" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="939" y="-9875.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-9864.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-9853.31" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer8_routing&#45;&gt;gpu1_layer8_expert_agg -->
<g id="edge505" class="edge">
<title>gpu1_layer8_routing&#45;&gt;gpu1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M1028.22,-10094.4C1101.96,-10067.24 1188.6,-10020.85 1149,-9961.31 1128.44,-9930.4 1094.7,-9910.33 1060.22,-9897.3"/>
<polygon fill="black" stroke="black" points="1061.08,-9893.89 1050.48,-9893.81 1058.71,-9900.48 1061.08,-9893.89"/>
</g>
<!-- gpu1_layer8_expert0&#45;&gt;gpu1_layer8_expert_agg -->
<g id="edge501" class="edge">
<title>gpu1_layer8_expert0&#45;&gt;gpu1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M720.1,-9961.65C756.98,-9946.77 804.7,-9927.51 846.16,-9910.78"/>
<polygon fill="black" stroke="black" points="847.5,-9914.02 855.46,-9907.03 844.88,-9907.52 847.5,-9914.02"/>
</g>
<!-- gpu1_layer8_expert1&#45;&gt;gpu1_layer8_expert_agg -->
<g id="edge502" class="edge">
<title>gpu1_layer8_expert1&#45;&gt;gpu1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M830.07,-9961.23C841.32,-9952.16 854.53,-9941.49 867.8,-9930.78"/>
<polygon fill="black" stroke="black" points="870.02,-9933.49 875.6,-9924.48 865.62,-9928.04 870.02,-9933.49"/>
</g>
<!-- gpu1_layer8_expert2&#45;&gt;gpu1_layer8_expert_agg -->
<g id="edge503" class="edge">
<title>gpu1_layer8_expert2&#45;&gt;gpu1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M939,-9961.23C939,-9953.31 939,-9944.17 939,-9934.85"/>
<polygon fill="black" stroke="black" points="942.5,-9934.71 939,-9924.71 935.5,-9934.71 942.5,-9934.71"/>
</g>
<!-- gpu1_layer8_expert3&#45;&gt;gpu1_layer8_expert_agg -->
<g id="edge504" class="edge">
<title>gpu1_layer8_expert3&#45;&gt;gpu1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M1047.93,-9961.23C1036.68,-9952.16 1023.47,-9941.49 1010.2,-9930.78"/>
<polygon fill="black" stroke="black" points="1012.38,-9928.04 1002.4,-9924.48 1007.98,-9933.49 1012.38,-9928.04"/>
</g>
<!-- gpu1_layer8_res2 -->
<g id="node407" class="node">
<title>gpu1_layer8_res2</title>
<polygon fill="lightblue" stroke="black" points="1000,-9783.31 878,-9783.31 878,-9731.31 1000,-9731.31 1000,-9783.31"/>
<text text-anchor="middle" x="939" y="-9771.31" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="939" y="-9760.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-9749.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-9738.31" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer8_expert_agg&#45;&gt;gpu1_layer8_res2 -->
<g id="edge506" class="edge">
<title>gpu1_layer8_expert_agg&#45;&gt;gpu1_layer8_res2</title>
<path fill="none" stroke="black" d="M939,-9820.1C939,-9811.15 939,-9802.02 939,-9793.62"/>
<polygon fill="black" stroke="black" points="942.5,-9793.44 939,-9783.44 935.5,-9793.44 942.5,-9793.44"/>
</g>
<!-- gpu1_layer9_ln1 -->
<g id="node408" class="node">
<title>gpu1_layer9_ln1</title>
<polygon fill="lightblue" stroke="black" points="1000,-9694.31 878,-9694.31 878,-9642.31 1000,-9642.31 1000,-9694.31"/>
<text text-anchor="middle" x="939" y="-9682.31" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="939" y="-9671.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-9660.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-9649.31" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer8_res2&#45;&gt;gpu1_layer9_ln1 -->
<g id="edge511" class="edge">
<title>gpu1_layer8_res2&#45;&gt;gpu1_layer9_ln1</title>
<path fill="none" stroke="black" d="M939,-9731.15C939,-9722.85 939,-9713.47 939,-9704.56"/>
<polygon fill="black" stroke="black" points="942.5,-9704.42 939,-9694.42 935.5,-9704.42 942.5,-9704.42"/>
</g>
<!-- gpu1_layer9_qkv -->
<g id="node409" class="node">
<title>gpu1_layer9_qkv</title>
<polygon fill="lightblue" stroke="black" points="1000,-9605.31 878,-9605.31 878,-9553.31 1000,-9553.31 1000,-9605.31"/>
<text text-anchor="middle" x="939" y="-9593.31" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="939" y="-9582.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-9571.31" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-9560.31" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer9_ln1&#45;&gt;gpu1_layer9_qkv -->
<g id="edge512" class="edge">
<title>gpu1_layer9_ln1&#45;&gt;gpu1_layer9_qkv</title>
<path fill="none" stroke="black" d="M939,-9642.15C939,-9633.85 939,-9624.47 939,-9615.56"/>
<polygon fill="black" stroke="black" points="942.5,-9615.42 939,-9605.42 935.5,-9615.42 942.5,-9615.42"/>
</g>
<!-- gpu1_layer9_reshape -->
<g id="node410" class="node">
<title>gpu1_layer9_reshape</title>
<polygon fill="lightblue" stroke="black" points="1003,-9516.31 875,-9516.31 875,-9464.31 1003,-9464.31 1003,-9516.31"/>
<text text-anchor="middle" x="939" y="-9504.31" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="939" y="-9493.31" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-9482.31" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-9471.31" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer9_qkv&#45;&gt;gpu1_layer9_reshape -->
<g id="edge513" class="edge">
<title>gpu1_layer9_qkv&#45;&gt;gpu1_layer9_reshape</title>
<path fill="none" stroke="black" d="M939,-9553.15C939,-9544.85 939,-9535.47 939,-9526.56"/>
<polygon fill="black" stroke="black" points="942.5,-9526.42 939,-9516.42 935.5,-9526.42 942.5,-9526.42"/>
</g>
<!-- gpu1_layer9_attn -->
<g id="node411" class="node">
<title>gpu1_layer9_attn</title>
<polygon fill="lightblue" stroke="black" points="1003,-9427.31 875,-9427.31 875,-9375.31 1003,-9375.31 1003,-9427.31"/>
<text text-anchor="middle" x="939" y="-9415.31" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="939" y="-9404.31" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-9393.31" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-9382.31" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer9_reshape&#45;&gt;gpu1_layer9_attn -->
<g id="edge514" class="edge">
<title>gpu1_layer9_reshape&#45;&gt;gpu1_layer9_attn</title>
<path fill="none" stroke="black" d="M939,-9464.15C939,-9455.85 939,-9446.47 939,-9437.56"/>
<polygon fill="black" stroke="black" points="942.5,-9437.42 939,-9427.42 935.5,-9437.42 942.5,-9437.42"/>
</g>
<!-- gpu1_layer9_attn_reshape -->
<g id="node413" class="node">
<title>gpu1_layer9_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1000,-9338.31 878,-9338.31 878,-9286.31 1000,-9286.31 1000,-9338.31"/>
<text text-anchor="middle" x="939" y="-9326.31" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="939" y="-9315.31" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-9304.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-9293.31" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer9_attn&#45;&gt;gpu1_layer9_attn_reshape -->
<g id="edge515" class="edge">
<title>gpu1_layer9_attn&#45;&gt;gpu1_layer9_attn_reshape</title>
<path fill="none" stroke="black" d="M939,-9375.15C939,-9366.85 939,-9357.47 939,-9348.56"/>
<polygon fill="black" stroke="black" points="942.5,-9348.42 939,-9338.42 935.5,-9348.42 942.5,-9348.42"/>
</g>
<!-- gpu1_layer9_attn_out -->
<g id="node412" class="node">
<title>gpu1_layer9_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1000,-9249.31 878,-9249.31 878,-9197.31 1000,-9197.31 1000,-9249.31"/>
<text text-anchor="middle" x="939" y="-9237.31" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="939" y="-9226.31" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-9215.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-9204.31" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer9_kv_update -->
<g id="node414" class="node">
<title>gpu1_layer9_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="939" cy="-9123.54" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="939" y="-9137.54" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="939" y="-9126.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-9115.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-9104.54" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer9_attn_out&#45;&gt;gpu1_layer9_kv_update -->
<g id="edge517" class="edge">
<title>gpu1_layer9_attn_out&#45;&gt;gpu1_layer9_kv_update</title>
<path fill="none" stroke="black" d="M939,-9197.13C939,-9189 939,-9179.7 939,-9170.54"/>
<polygon fill="black" stroke="black" points="942.5,-9170.32 939,-9160.32 935.5,-9170.32 942.5,-9170.32"/>
</g>
<!-- gpu1_layer9_attn_reshape&#45;&gt;gpu1_layer9_attn_out -->
<g id="edge516" class="edge">
<title>gpu1_layer9_attn_reshape&#45;&gt;gpu1_layer9_attn_out</title>
<path fill="none" stroke="black" d="M939,-9286.15C939,-9277.85 939,-9268.47 939,-9259.56"/>
<polygon fill="black" stroke="black" points="942.5,-9259.42 939,-9249.42 935.5,-9259.42 942.5,-9259.42"/>
</g>
<!-- gpu1_layer9_res1 -->
<g id="node415" class="node">
<title>gpu1_layer9_res1</title>
<polygon fill="lightblue" stroke="black" points="1000,-9049.77 878,-9049.77 878,-8997.77 1000,-8997.77 1000,-9049.77"/>
<text text-anchor="middle" x="939" y="-9037.77" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="939" y="-9026.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-9015.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-9004.77" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer9_kv_update&#45;&gt;gpu1_layer9_res1 -->
<g id="edge518" class="edge">
<title>gpu1_layer9_kv_update&#45;&gt;gpu1_layer9_res1</title>
<path fill="none" stroke="black" d="M939,-9086.69C939,-9078.01 939,-9068.74 939,-9060.09"/>
<polygon fill="black" stroke="black" points="942.5,-9059.92 939,-9049.92 935.5,-9059.92 942.5,-9059.92"/>
</g>
<!-- gpu1_layer9_ln2 -->
<g id="node416" class="node">
<title>gpu1_layer9_ln2</title>
<polygon fill="lightblue" stroke="black" points="1000,-8960.77 878,-8960.77 878,-8908.77 1000,-8908.77 1000,-8960.77"/>
<text text-anchor="middle" x="939" y="-8948.77" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="939" y="-8937.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-8926.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-8915.77" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer9_res1&#45;&gt;gpu1_layer9_ln2 -->
<g id="edge519" class="edge">
<title>gpu1_layer9_res1&#45;&gt;gpu1_layer9_ln2</title>
<path fill="none" stroke="black" d="M939,-8997.61C939,-8989.31 939,-8979.93 939,-8971.02"/>
<polygon fill="black" stroke="black" points="942.5,-8970.88 939,-8960.88 935.5,-8970.88 942.5,-8970.88"/>
</g>
<!-- gpu1_layer9_routing -->
<g id="node417" class="node">
<title>gpu1_layer9_routing</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-8871.77 864.29,-8871.77 812.53,-8745.77 1013.71,-8745.77 1065.47,-8871.77"/>
<text text-anchor="middle" x="939" y="-8828.27" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="939" y="-8817.27" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-8806.27" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-8795.27" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="939" y="-8784.27" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer9_ln2&#45;&gt;gpu1_layer9_routing -->
<g id="edge520" class="edge">
<title>gpu1_layer9_ln2&#45;&gt;gpu1_layer9_routing</title>
<path fill="none" stroke="black" d="M939,-8908.68C939,-8900.75 939,-8891.55 939,-8882.02"/>
<polygon fill="black" stroke="black" points="942.5,-8882.01 939,-8872.01 935.5,-8882.01 942.5,-8882.01"/>
</g>
<!-- gpu1_layer9_expert0 -->
<g id="node418" class="node">
<title>gpu1_layer9_expert0</title>
<polygon fill="lightblue" stroke="black" points="720,-8699.77 598,-8699.77 598,-8647.77 720,-8647.77 720,-8699.77"/>
<text text-anchor="middle" x="659" y="-8687.77" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="659" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer9_routing&#45;&gt;gpu1_layer9_expert0 -->
<g id="edge507" class="edge">
<title>gpu1_layer9_routing&#45;&gt;gpu1_layer9_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M813.33,-8748.08C781.34,-8732.89 748.34,-8717.21 721.11,-8704.27"/>
<polygon fill="black" stroke="black" points="722.26,-8700.95 711.73,-8699.82 719.26,-8707.27 722.26,-8700.95"/>
<text text-anchor="middle" x="795.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer9_expert1 -->
<g id="node419" class="node">
<title>gpu1_layer9_expert1</title>
<polygon fill="lightblue" stroke="black" points="860,-8699.77 738,-8699.77 738,-8647.77 860,-8647.77 860,-8699.77"/>
<text text-anchor="middle" x="799" y="-8687.77" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="799" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer9_routing&#45;&gt;gpu1_layer9_expert1 -->
<g id="edge508" class="edge">
<title>gpu1_layer9_routing&#45;&gt;gpu1_layer9_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M873.51,-8745.56C859.48,-8732.23 845.21,-8718.68 832.97,-8707.04"/>
<polygon fill="black" stroke="black" points="835.29,-8704.42 825.63,-8700.07 830.46,-8709.49 835.29,-8704.42"/>
<text text-anchor="middle" x="882.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer9_expert2 -->
<g id="node420" class="node">
<title>gpu1_layer9_expert2</title>
<polygon fill="lightblue" stroke="black" points="1000,-8699.77 878,-8699.77 878,-8647.77 1000,-8647.77 1000,-8699.77"/>
<text text-anchor="middle" x="939" y="-8687.77" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="939" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer9_routing&#45;&gt;gpu1_layer9_expert2 -->
<g id="edge509" class="edge">
<title>gpu1_layer9_routing&#45;&gt;gpu1_layer9_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M939,-8745.56C939,-8733.49 939,-8721.23 939,-8710.39"/>
<polygon fill="black" stroke="black" points="942.5,-8710.07 939,-8700.07 935.5,-8710.07 942.5,-8710.07"/>
<text text-anchor="middle" x="968.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer9_expert3 -->
<g id="node421" class="node">
<title>gpu1_layer9_expert3</title>
<polygon fill="lightblue" stroke="black" points="1140,-8699.77 1018,-8699.77 1018,-8647.77 1140,-8647.77 1140,-8699.77"/>
<text text-anchor="middle" x="1079" y="-8687.77" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1079" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer9_routing&#45;&gt;gpu1_layer9_expert3 -->
<g id="edge510" class="edge">
<title>gpu1_layer9_routing&#45;&gt;gpu1_layer9_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1004.49,-8745.56C1018.52,-8732.23 1032.79,-8718.68 1045.03,-8707.04"/>
<polygon fill="black" stroke="black" points="1047.54,-8709.49 1052.37,-8700.07 1042.71,-8704.42 1047.54,-8709.49"/>
<text text-anchor="middle" x="1063.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer9_expert_agg -->
<g id="node422" class="node">
<title>gpu1_layer9_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-8610.77 864.29,-8610.77 812.53,-8506.77 1013.71,-8506.77 1065.47,-8610.77"/>
<text text-anchor="middle" x="939" y="-8572.77" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="939" y="-8561.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-8550.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-8539.77" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer9_routing&#45;&gt;gpu1_layer9_expert_agg -->
<g id="edge525" class="edge">
<title>gpu1_layer9_routing&#45;&gt;gpu1_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M1028.22,-8780.86C1101.96,-8753.7 1188.6,-8707.31 1149,-8647.77 1128.44,-8616.86 1094.7,-8596.79 1060.22,-8583.76"/>
<polygon fill="black" stroke="black" points="1061.08,-8580.35 1050.48,-8580.27 1058.71,-8586.94 1061.08,-8580.35"/>
</g>
<!-- gpu1_layer9_expert0&#45;&gt;gpu1_layer9_expert_agg -->
<g id="edge521" class="edge">
<title>gpu1_layer9_expert0&#45;&gt;gpu1_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M720.1,-8648.12C756.98,-8633.23 804.7,-8613.97 846.16,-8597.24"/>
<polygon fill="black" stroke="black" points="847.5,-8600.48 855.46,-8593.49 844.88,-8593.99 847.5,-8600.48"/>
</g>
<!-- gpu1_layer9_expert1&#45;&gt;gpu1_layer9_expert_agg -->
<g id="edge522" class="edge">
<title>gpu1_layer9_expert1&#45;&gt;gpu1_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M830.07,-8647.7C841.32,-8638.62 854.53,-8627.95 867.8,-8617.24"/>
<polygon fill="black" stroke="black" points="870.02,-8619.95 875.6,-8610.95 865.62,-8614.5 870.02,-8619.95"/>
</g>
<!-- gpu1_layer9_expert2&#45;&gt;gpu1_layer9_expert_agg -->
<g id="edge523" class="edge">
<title>gpu1_layer9_expert2&#45;&gt;gpu1_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M939,-8647.7C939,-8639.77 939,-8630.63 939,-8621.31"/>
<polygon fill="black" stroke="black" points="942.5,-8621.17 939,-8611.17 935.5,-8621.17 942.5,-8621.17"/>
</g>
<!-- gpu1_layer9_expert3&#45;&gt;gpu1_layer9_expert_agg -->
<g id="edge524" class="edge">
<title>gpu1_layer9_expert3&#45;&gt;gpu1_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M1047.93,-8647.7C1036.68,-8638.62 1023.47,-8627.95 1010.2,-8617.24"/>
<polygon fill="black" stroke="black" points="1012.38,-8614.5 1002.4,-8610.95 1007.98,-8619.95 1012.38,-8614.5"/>
</g>
<!-- gpu1_layer9_res2 -->
<g id="node423" class="node">
<title>gpu1_layer9_res2</title>
<polygon fill="lightblue" stroke="black" points="1000,-8469.77 878,-8469.77 878,-8417.77 1000,-8417.77 1000,-8469.77"/>
<text text-anchor="middle" x="939" y="-8457.77" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="939" y="-8446.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-8435.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-8424.77" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer9_expert_agg&#45;&gt;gpu1_layer9_res2 -->
<g id="edge526" class="edge">
<title>gpu1_layer9_expert_agg&#45;&gt;gpu1_layer9_res2</title>
<path fill="none" stroke="black" d="M939,-8506.56C939,-8497.61 939,-8488.48 939,-8480.08"/>
<polygon fill="black" stroke="black" points="942.5,-8479.9 939,-8469.9 935.5,-8479.9 942.5,-8479.9"/>
</g>
<!-- gpu1_layer10_ln1 -->
<g id="node424" class="node">
<title>gpu1_layer10_ln1</title>
<polygon fill="lightblue" stroke="black" points="1000,-8380.77 878,-8380.77 878,-8328.77 1000,-8328.77 1000,-8380.77"/>
<text text-anchor="middle" x="939" y="-8368.77" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="939" y="-8357.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-8346.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-8335.77" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer9_res2&#45;&gt;gpu1_layer10_ln1 -->
<g id="edge531" class="edge">
<title>gpu1_layer9_res2&#45;&gt;gpu1_layer10_ln1</title>
<path fill="none" stroke="black" d="M939,-8417.61C939,-8409.31 939,-8399.93 939,-8391.02"/>
<polygon fill="black" stroke="black" points="942.5,-8390.88 939,-8380.88 935.5,-8390.88 942.5,-8390.88"/>
</g>
<!-- gpu1_layer10_qkv -->
<g id="node425" class="node">
<title>gpu1_layer10_qkv</title>
<polygon fill="lightblue" stroke="black" points="1000,-8291.77 878,-8291.77 878,-8239.77 1000,-8239.77 1000,-8291.77"/>
<text text-anchor="middle" x="939" y="-8279.77" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="939" y="-8268.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-8257.77" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-8246.77" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer10_ln1&#45;&gt;gpu1_layer10_qkv -->
<g id="edge532" class="edge">
<title>gpu1_layer10_ln1&#45;&gt;gpu1_layer10_qkv</title>
<path fill="none" stroke="black" d="M939,-8328.61C939,-8320.31 939,-8310.93 939,-8302.02"/>
<polygon fill="black" stroke="black" points="942.5,-8301.88 939,-8291.88 935.5,-8301.88 942.5,-8301.88"/>
</g>
<!-- gpu1_layer10_reshape -->
<g id="node426" class="node">
<title>gpu1_layer10_reshape</title>
<polygon fill="lightblue" stroke="black" points="1003,-8202.77 875,-8202.77 875,-8150.77 1003,-8150.77 1003,-8202.77"/>
<text text-anchor="middle" x="939" y="-8190.77" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="939" y="-8179.77" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-8168.77" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-8157.77" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer10_qkv&#45;&gt;gpu1_layer10_reshape -->
<g id="edge533" class="edge">
<title>gpu1_layer10_qkv&#45;&gt;gpu1_layer10_reshape</title>
<path fill="none" stroke="black" d="M939,-8239.61C939,-8231.31 939,-8221.93 939,-8213.02"/>
<polygon fill="black" stroke="black" points="942.5,-8212.88 939,-8202.88 935.5,-8212.88 942.5,-8212.88"/>
</g>
<!-- gpu1_layer10_attn -->
<g id="node427" class="node">
<title>gpu1_layer10_attn</title>
<polygon fill="lightblue" stroke="black" points="1003,-8113.77 875,-8113.77 875,-8061.77 1003,-8061.77 1003,-8113.77"/>
<text text-anchor="middle" x="939" y="-8101.77" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="939" y="-8090.77" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-8079.77" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-8068.77" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer10_reshape&#45;&gt;gpu1_layer10_attn -->
<g id="edge534" class="edge">
<title>gpu1_layer10_reshape&#45;&gt;gpu1_layer10_attn</title>
<path fill="none" stroke="black" d="M939,-8150.61C939,-8142.31 939,-8132.93 939,-8124.02"/>
<polygon fill="black" stroke="black" points="942.5,-8123.88 939,-8113.88 935.5,-8123.88 942.5,-8123.88"/>
</g>
<!-- gpu1_layer10_attn_reshape -->
<g id="node429" class="node">
<title>gpu1_layer10_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1000,-8024.77 878,-8024.77 878,-7972.77 1000,-7972.77 1000,-8024.77"/>
<text text-anchor="middle" x="939" y="-8012.77" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="939" y="-8001.77" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-7990.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-7979.77" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer10_attn&#45;&gt;gpu1_layer10_attn_reshape -->
<g id="edge535" class="edge">
<title>gpu1_layer10_attn&#45;&gt;gpu1_layer10_attn_reshape</title>
<path fill="none" stroke="black" d="M939,-8061.61C939,-8053.31 939,-8043.93 939,-8035.02"/>
<polygon fill="black" stroke="black" points="942.5,-8034.88 939,-8024.88 935.5,-8034.88 942.5,-8034.88"/>
</g>
<!-- gpu1_layer10_attn_out -->
<g id="node428" class="node">
<title>gpu1_layer10_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1000,-7935.77 878,-7935.77 878,-7883.77 1000,-7883.77 1000,-7935.77"/>
<text text-anchor="middle" x="939" y="-7923.77" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="939" y="-7912.77" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-7901.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-7890.77" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer10_kv_update -->
<g id="node430" class="node">
<title>gpu1_layer10_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="939" cy="-7810" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="939" y="-7824" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="939" y="-7813" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-7802" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-7791" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer10_attn_out&#45;&gt;gpu1_layer10_kv_update -->
<g id="edge537" class="edge">
<title>gpu1_layer10_attn_out&#45;&gt;gpu1_layer10_kv_update</title>
<path fill="none" stroke="black" d="M939,-7883.6C939,-7875.46 939,-7866.16 939,-7857"/>
<polygon fill="black" stroke="black" points="942.5,-7856.78 939,-7846.78 935.5,-7856.78 942.5,-7856.78"/>
</g>
<!-- gpu1_layer10_attn_reshape&#45;&gt;gpu1_layer10_attn_out -->
<g id="edge536" class="edge">
<title>gpu1_layer10_attn_reshape&#45;&gt;gpu1_layer10_attn_out</title>
<path fill="none" stroke="black" d="M939,-7972.61C939,-7964.31 939,-7954.93 939,-7946.02"/>
<polygon fill="black" stroke="black" points="942.5,-7945.88 939,-7935.88 935.5,-7945.88 942.5,-7945.88"/>
</g>
<!-- gpu1_layer10_res1 -->
<g id="node431" class="node">
<title>gpu1_layer10_res1</title>
<polygon fill="lightblue" stroke="black" points="1000,-7736.23 878,-7736.23 878,-7684.23 1000,-7684.23 1000,-7736.23"/>
<text text-anchor="middle" x="939" y="-7724.23" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="939" y="-7713.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-7702.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-7691.23" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer10_kv_update&#45;&gt;gpu1_layer10_res1 -->
<g id="edge538" class="edge">
<title>gpu1_layer10_kv_update&#45;&gt;gpu1_layer10_res1</title>
<path fill="none" stroke="black" d="M939,-7773.15C939,-7764.47 939,-7755.2 939,-7746.55"/>
<polygon fill="black" stroke="black" points="942.5,-7746.38 939,-7736.38 935.5,-7746.38 942.5,-7746.38"/>
</g>
<!-- gpu1_layer10_ln2 -->
<g id="node432" class="node">
<title>gpu1_layer10_ln2</title>
<polygon fill="lightblue" stroke="black" points="1000,-7647.23 878,-7647.23 878,-7595.23 1000,-7595.23 1000,-7647.23"/>
<text text-anchor="middle" x="939" y="-7635.23" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="939" y="-7624.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-7613.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-7602.23" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer10_res1&#45;&gt;gpu1_layer10_ln2 -->
<g id="edge539" class="edge">
<title>gpu1_layer10_res1&#45;&gt;gpu1_layer10_ln2</title>
<path fill="none" stroke="black" d="M939,-7684.07C939,-7675.77 939,-7666.39 939,-7657.48"/>
<polygon fill="black" stroke="black" points="942.5,-7657.34 939,-7647.34 935.5,-7657.34 942.5,-7657.34"/>
</g>
<!-- gpu1_layer10_routing -->
<g id="node433" class="node">
<title>gpu1_layer10_routing</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-7558.23 864.29,-7558.23 812.53,-7432.23 1013.71,-7432.23 1065.47,-7558.23"/>
<text text-anchor="middle" x="939" y="-7514.73" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="939" y="-7503.73" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-7492.73" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-7481.73" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="939" y="-7470.73" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer10_ln2&#45;&gt;gpu1_layer10_routing -->
<g id="edge540" class="edge">
<title>gpu1_layer10_ln2&#45;&gt;gpu1_layer10_routing</title>
<path fill="none" stroke="black" d="M939,-7595.14C939,-7587.21 939,-7578.01 939,-7568.48"/>
<polygon fill="black" stroke="black" points="942.5,-7568.47 939,-7558.47 935.5,-7568.47 942.5,-7568.47"/>
</g>
<!-- gpu1_layer10_expert0 -->
<g id="node434" class="node">
<title>gpu1_layer10_expert0</title>
<polygon fill="lightblue" stroke="black" points="720,-7386.23 598,-7386.23 598,-7334.23 720,-7334.23 720,-7386.23"/>
<text text-anchor="middle" x="659" y="-7374.23" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="659" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer10_routing&#45;&gt;gpu1_layer10_expert0 -->
<g id="edge527" class="edge">
<title>gpu1_layer10_routing&#45;&gt;gpu1_layer10_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M813.33,-7434.54C781.34,-7419.35 748.34,-7403.67 721.11,-7390.74"/>
<polygon fill="black" stroke="black" points="722.26,-7387.41 711.73,-7386.28 719.26,-7393.73 722.26,-7387.41"/>
<text text-anchor="middle" x="795.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer10_expert1 -->
<g id="node435" class="node">
<title>gpu1_layer10_expert1</title>
<polygon fill="lightblue" stroke="black" points="860,-7386.23 738,-7386.23 738,-7334.23 860,-7334.23 860,-7386.23"/>
<text text-anchor="middle" x="799" y="-7374.23" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="799" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer10_routing&#45;&gt;gpu1_layer10_expert1 -->
<g id="edge528" class="edge">
<title>gpu1_layer10_routing&#45;&gt;gpu1_layer10_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M873.51,-7432.02C859.48,-7418.69 845.21,-7405.14 832.97,-7393.5"/>
<polygon fill="black" stroke="black" points="835.29,-7390.88 825.63,-7386.53 830.46,-7395.95 835.29,-7390.88"/>
<text text-anchor="middle" x="882.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer10_expert2 -->
<g id="node436" class="node">
<title>gpu1_layer10_expert2</title>
<polygon fill="lightblue" stroke="black" points="1000,-7386.23 878,-7386.23 878,-7334.23 1000,-7334.23 1000,-7386.23"/>
<text text-anchor="middle" x="939" y="-7374.23" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="939" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer10_routing&#45;&gt;gpu1_layer10_expert2 -->
<g id="edge529" class="edge">
<title>gpu1_layer10_routing&#45;&gt;gpu1_layer10_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M939,-7432.02C939,-7419.95 939,-7407.69 939,-7396.85"/>
<polygon fill="black" stroke="black" points="942.5,-7396.53 939,-7386.53 935.5,-7396.53 942.5,-7396.53"/>
<text text-anchor="middle" x="968.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer10_expert3 -->
<g id="node437" class="node">
<title>gpu1_layer10_expert3</title>
<polygon fill="lightblue" stroke="black" points="1140,-7386.23 1018,-7386.23 1018,-7334.23 1140,-7334.23 1140,-7386.23"/>
<text text-anchor="middle" x="1079" y="-7374.23" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1079" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer10_routing&#45;&gt;gpu1_layer10_expert3 -->
<g id="edge530" class="edge">
<title>gpu1_layer10_routing&#45;&gt;gpu1_layer10_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1004.49,-7432.02C1018.52,-7418.69 1032.79,-7405.14 1045.03,-7393.5"/>
<polygon fill="black" stroke="black" points="1047.54,-7395.95 1052.37,-7386.53 1042.71,-7390.88 1047.54,-7395.95"/>
<text text-anchor="middle" x="1063.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer10_expert_agg -->
<g id="node438" class="node">
<title>gpu1_layer10_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-7297.23 864.29,-7297.23 812.53,-7193.23 1013.71,-7193.23 1065.47,-7297.23"/>
<text text-anchor="middle" x="939" y="-7259.23" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="939" y="-7248.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-7237.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-7226.23" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer10_routing&#45;&gt;gpu1_layer10_expert_agg -->
<g id="edge545" class="edge">
<title>gpu1_layer10_routing&#45;&gt;gpu1_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M1028.22,-7467.32C1101.96,-7440.16 1188.6,-7393.77 1149,-7334.23 1128.44,-7303.32 1094.7,-7283.25 1060.22,-7270.22"/>
<polygon fill="black" stroke="black" points="1061.08,-7266.81 1050.48,-7266.73 1058.71,-7273.4 1061.08,-7266.81"/>
</g>
<!-- gpu1_layer10_expert0&#45;&gt;gpu1_layer10_expert_agg -->
<g id="edge541" class="edge">
<title>gpu1_layer10_expert0&#45;&gt;gpu1_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M720.1,-7334.58C756.98,-7319.69 804.7,-7300.44 846.16,-7283.7"/>
<polygon fill="black" stroke="black" points="847.5,-7286.94 855.46,-7279.95 844.88,-7280.45 847.5,-7286.94"/>
</g>
<!-- gpu1_layer10_expert1&#45;&gt;gpu1_layer10_expert_agg -->
<g id="edge542" class="edge">
<title>gpu1_layer10_expert1&#45;&gt;gpu1_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M830.07,-7334.16C841.32,-7325.08 854.53,-7314.42 867.8,-7303.71"/>
<polygon fill="black" stroke="black" points="870.02,-7306.41 875.6,-7297.41 865.62,-7300.96 870.02,-7306.41"/>
</g>
<!-- gpu1_layer10_expert2&#45;&gt;gpu1_layer10_expert_agg -->
<g id="edge543" class="edge">
<title>gpu1_layer10_expert2&#45;&gt;gpu1_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M939,-7334.16C939,-7326.23 939,-7317.09 939,-7307.77"/>
<polygon fill="black" stroke="black" points="942.5,-7307.64 939,-7297.64 935.5,-7307.64 942.5,-7307.64"/>
</g>
<!-- gpu1_layer10_expert3&#45;&gt;gpu1_layer10_expert_agg -->
<g id="edge544" class="edge">
<title>gpu1_layer10_expert3&#45;&gt;gpu1_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M1047.93,-7334.16C1036.68,-7325.08 1023.47,-7314.42 1010.2,-7303.71"/>
<polygon fill="black" stroke="black" points="1012.38,-7300.96 1002.4,-7297.41 1007.98,-7306.41 1012.38,-7300.96"/>
</g>
<!-- gpu1_layer10_res2 -->
<g id="node439" class="node">
<title>gpu1_layer10_res2</title>
<polygon fill="lightblue" stroke="black" points="1000,-7156.23 878,-7156.23 878,-7104.23 1000,-7104.23 1000,-7156.23"/>
<text text-anchor="middle" x="939" y="-7144.23" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="939" y="-7133.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-7122.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-7111.23" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer10_expert_agg&#45;&gt;gpu1_layer10_res2 -->
<g id="edge546" class="edge">
<title>gpu1_layer10_expert_agg&#45;&gt;gpu1_layer10_res2</title>
<path fill="none" stroke="black" d="M939,-7193.02C939,-7184.07 939,-7174.94 939,-7166.55"/>
<polygon fill="black" stroke="black" points="942.5,-7166.37 939,-7156.37 935.5,-7166.37 942.5,-7166.37"/>
</g>
<!-- gpu1_layer11_ln1 -->
<g id="node440" class="node">
<title>gpu1_layer11_ln1</title>
<polygon fill="lightblue" stroke="black" points="1000,-7067.23 878,-7067.23 878,-7015.23 1000,-7015.23 1000,-7067.23"/>
<text text-anchor="middle" x="939" y="-7055.23" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="939" y="-7044.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-7033.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-7022.23" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer10_res2&#45;&gt;gpu1_layer11_ln1 -->
<g id="edge551" class="edge">
<title>gpu1_layer10_res2&#45;&gt;gpu1_layer11_ln1</title>
<path fill="none" stroke="black" d="M939,-7104.07C939,-7095.77 939,-7086.39 939,-7077.48"/>
<polygon fill="black" stroke="black" points="942.5,-7077.34 939,-7067.34 935.5,-7077.34 942.5,-7077.34"/>
</g>
<!-- gpu1_layer11_qkv -->
<g id="node441" class="node">
<title>gpu1_layer11_qkv</title>
<polygon fill="lightblue" stroke="black" points="1000,-6978.23 878,-6978.23 878,-6926.23 1000,-6926.23 1000,-6978.23"/>
<text text-anchor="middle" x="939" y="-6966.23" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="939" y="-6955.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-6944.23" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-6933.23" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer11_ln1&#45;&gt;gpu1_layer11_qkv -->
<g id="edge552" class="edge">
<title>gpu1_layer11_ln1&#45;&gt;gpu1_layer11_qkv</title>
<path fill="none" stroke="black" d="M939,-7015.07C939,-7006.77 939,-6997.39 939,-6988.48"/>
<polygon fill="black" stroke="black" points="942.5,-6988.34 939,-6978.34 935.5,-6988.34 942.5,-6988.34"/>
</g>
<!-- gpu1_layer11_reshape -->
<g id="node442" class="node">
<title>gpu1_layer11_reshape</title>
<polygon fill="lightblue" stroke="black" points="1003,-6889.23 875,-6889.23 875,-6837.23 1003,-6837.23 1003,-6889.23"/>
<text text-anchor="middle" x="939" y="-6877.23" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="939" y="-6866.23" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-6855.23" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-6844.23" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer11_qkv&#45;&gt;gpu1_layer11_reshape -->
<g id="edge553" class="edge">
<title>gpu1_layer11_qkv&#45;&gt;gpu1_layer11_reshape</title>
<path fill="none" stroke="black" d="M939,-6926.07C939,-6917.77 939,-6908.39 939,-6899.48"/>
<polygon fill="black" stroke="black" points="942.5,-6899.34 939,-6889.34 935.5,-6899.34 942.5,-6899.34"/>
</g>
<!-- gpu1_layer11_attn -->
<g id="node443" class="node">
<title>gpu1_layer11_attn</title>
<polygon fill="lightblue" stroke="black" points="1003,-6800.23 875,-6800.23 875,-6748.23 1003,-6748.23 1003,-6800.23"/>
<text text-anchor="middle" x="939" y="-6788.23" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="939" y="-6777.23" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-6766.23" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-6755.23" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer11_reshape&#45;&gt;gpu1_layer11_attn -->
<g id="edge554" class="edge">
<title>gpu1_layer11_reshape&#45;&gt;gpu1_layer11_attn</title>
<path fill="none" stroke="black" d="M939,-6837.07C939,-6828.77 939,-6819.39 939,-6810.48"/>
<polygon fill="black" stroke="black" points="942.5,-6810.34 939,-6800.34 935.5,-6810.34 942.5,-6810.34"/>
</g>
<!-- gpu1_layer11_attn_reshape -->
<g id="node445" class="node">
<title>gpu1_layer11_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1000,-6711.23 878,-6711.23 878,-6659.23 1000,-6659.23 1000,-6711.23"/>
<text text-anchor="middle" x="939" y="-6699.23" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="939" y="-6688.23" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-6677.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-6666.23" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer11_attn&#45;&gt;gpu1_layer11_attn_reshape -->
<g id="edge555" class="edge">
<title>gpu1_layer11_attn&#45;&gt;gpu1_layer11_attn_reshape</title>
<path fill="none" stroke="black" d="M939,-6748.07C939,-6739.77 939,-6730.39 939,-6721.48"/>
<polygon fill="black" stroke="black" points="942.5,-6721.34 939,-6711.34 935.5,-6721.34 942.5,-6721.34"/>
</g>
<!-- gpu1_layer11_attn_out -->
<g id="node444" class="node">
<title>gpu1_layer11_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1000,-6622.23 878,-6622.23 878,-6570.23 1000,-6570.23 1000,-6622.23"/>
<text text-anchor="middle" x="939" y="-6610.23" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="939" y="-6599.23" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-6588.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-6577.23" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer11_kv_update -->
<g id="node446" class="node">
<title>gpu1_layer11_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="939" cy="-6496.47" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="939" y="-6510.47" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="939" y="-6499.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-6488.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-6477.47" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer11_attn_out&#45;&gt;gpu1_layer11_kv_update -->
<g id="edge557" class="edge">
<title>gpu1_layer11_attn_out&#45;&gt;gpu1_layer11_kv_update</title>
<path fill="none" stroke="black" d="M939,-6570.06C939,-6561.92 939,-6552.62 939,-6543.46"/>
<polygon fill="black" stroke="black" points="942.5,-6543.24 939,-6533.24 935.5,-6543.24 942.5,-6543.24"/>
</g>
<!-- gpu1_layer11_attn_reshape&#45;&gt;gpu1_layer11_attn_out -->
<g id="edge556" class="edge">
<title>gpu1_layer11_attn_reshape&#45;&gt;gpu1_layer11_attn_out</title>
<path fill="none" stroke="black" d="M939,-6659.07C939,-6650.77 939,-6641.39 939,-6632.48"/>
<polygon fill="black" stroke="black" points="942.5,-6632.34 939,-6622.34 935.5,-6632.34 942.5,-6632.34"/>
</g>
<!-- gpu1_layer11_res1 -->
<g id="node447" class="node">
<title>gpu1_layer11_res1</title>
<polygon fill="lightblue" stroke="black" points="1000,-6422.7 878,-6422.7 878,-6370.7 1000,-6370.7 1000,-6422.7"/>
<text text-anchor="middle" x="939" y="-6410.7" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="939" y="-6399.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-6388.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-6377.7" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer11_kv_update&#45;&gt;gpu1_layer11_res1 -->
<g id="edge558" class="edge">
<title>gpu1_layer11_kv_update&#45;&gt;gpu1_layer11_res1</title>
<path fill="none" stroke="black" d="M939,-6459.61C939,-6450.94 939,-6441.67 939,-6433.01"/>
<polygon fill="black" stroke="black" points="942.5,-6432.84 939,-6422.84 935.5,-6432.84 942.5,-6432.84"/>
</g>
<!-- gpu1_layer11_ln2 -->
<g id="node448" class="node">
<title>gpu1_layer11_ln2</title>
<polygon fill="lightblue" stroke="black" points="1000,-6333.7 878,-6333.7 878,-6281.7 1000,-6281.7 1000,-6333.7"/>
<text text-anchor="middle" x="939" y="-6321.7" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="939" y="-6310.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-6299.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-6288.7" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer11_res1&#45;&gt;gpu1_layer11_ln2 -->
<g id="edge559" class="edge">
<title>gpu1_layer11_res1&#45;&gt;gpu1_layer11_ln2</title>
<path fill="none" stroke="black" d="M939,-6370.53C939,-6362.24 939,-6352.85 939,-6343.94"/>
<polygon fill="black" stroke="black" points="942.5,-6343.8 939,-6333.8 935.5,-6343.8 942.5,-6343.8"/>
</g>
<!-- gpu1_layer11_routing -->
<g id="node449" class="node">
<title>gpu1_layer11_routing</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-6244.7 864.29,-6244.7 812.53,-6118.7 1013.71,-6118.7 1065.47,-6244.7"/>
<text text-anchor="middle" x="939" y="-6201.2" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="939" y="-6190.2" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-6179.2" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-6168.2" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="939" y="-6157.2" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer11_ln2&#45;&gt;gpu1_layer11_routing -->
<g id="edge560" class="edge">
<title>gpu1_layer11_ln2&#45;&gt;gpu1_layer11_routing</title>
<path fill="none" stroke="black" d="M939,-6281.6C939,-6273.67 939,-6264.47 939,-6254.94"/>
<polygon fill="black" stroke="black" points="942.5,-6254.93 939,-6244.93 935.5,-6254.93 942.5,-6254.93"/>
</g>
<!-- gpu1_layer11_expert0 -->
<g id="node450" class="node">
<title>gpu1_layer11_expert0</title>
<polygon fill="lightblue" stroke="black" points="720,-6072.7 598,-6072.7 598,-6020.7 720,-6020.7 720,-6072.7"/>
<text text-anchor="middle" x="659" y="-6060.7" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="659" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer11_routing&#45;&gt;gpu1_layer11_expert0 -->
<g id="edge547" class="edge">
<title>gpu1_layer11_routing&#45;&gt;gpu1_layer11_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M813.33,-6121C781.34,-6105.81 748.34,-6090.13 721.11,-6077.2"/>
<polygon fill="black" stroke="black" points="722.26,-6073.87 711.73,-6072.74 719.26,-6080.19 722.26,-6073.87"/>
<text text-anchor="middle" x="795.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer11_expert1 -->
<g id="node451" class="node">
<title>gpu1_layer11_expert1</title>
<polygon fill="lightblue" stroke="black" points="860,-6072.7 738,-6072.7 738,-6020.7 860,-6020.7 860,-6072.7"/>
<text text-anchor="middle" x="799" y="-6060.7" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="799" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer11_routing&#45;&gt;gpu1_layer11_expert1 -->
<g id="edge548" class="edge">
<title>gpu1_layer11_routing&#45;&gt;gpu1_layer11_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M873.51,-6118.48C859.48,-6105.15 845.21,-6091.6 832.97,-6079.97"/>
<polygon fill="black" stroke="black" points="835.29,-6077.34 825.63,-6072.99 830.46,-6082.41 835.29,-6077.34"/>
<text text-anchor="middle" x="882.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer11_expert2 -->
<g id="node452" class="node">
<title>gpu1_layer11_expert2</title>
<polygon fill="lightblue" stroke="black" points="1000,-6072.7 878,-6072.7 878,-6020.7 1000,-6020.7 1000,-6072.7"/>
<text text-anchor="middle" x="939" y="-6060.7" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="939" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer11_routing&#45;&gt;gpu1_layer11_expert2 -->
<g id="edge549" class="edge">
<title>gpu1_layer11_routing&#45;&gt;gpu1_layer11_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M939,-6118.48C939,-6106.41 939,-6094.15 939,-6083.31"/>
<polygon fill="black" stroke="black" points="942.5,-6082.99 939,-6072.99 935.5,-6082.99 942.5,-6082.99"/>
<text text-anchor="middle" x="968.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer11_expert3 -->
<g id="node453" class="node">
<title>gpu1_layer11_expert3</title>
<polygon fill="lightblue" stroke="black" points="1140,-6072.7 1018,-6072.7 1018,-6020.7 1140,-6020.7 1140,-6072.7"/>
<text text-anchor="middle" x="1079" y="-6060.7" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1079" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer11_routing&#45;&gt;gpu1_layer11_expert3 -->
<g id="edge550" class="edge">
<title>gpu1_layer11_routing&#45;&gt;gpu1_layer11_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1004.49,-6118.48C1018.52,-6105.15 1032.79,-6091.6 1045.03,-6079.97"/>
<polygon fill="black" stroke="black" points="1047.54,-6082.41 1052.37,-6072.99 1042.71,-6077.34 1047.54,-6082.41"/>
<text text-anchor="middle" x="1063.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer11_expert_agg -->
<g id="node454" class="node">
<title>gpu1_layer11_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-5983.7 864.29,-5983.7 812.53,-5879.7 1013.71,-5879.7 1065.47,-5983.7"/>
<text text-anchor="middle" x="939" y="-5945.7" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="939" y="-5934.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-5923.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-5912.7" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer11_routing&#45;&gt;gpu1_layer11_expert_agg -->
<g id="edge565" class="edge">
<title>gpu1_layer11_routing&#45;&gt;gpu1_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M1028.22,-6153.78C1101.96,-6126.62 1188.6,-6080.23 1149,-6020.7 1128.44,-5989.78 1094.7,-5969.71 1060.22,-5956.68"/>
<polygon fill="black" stroke="black" points="1061.08,-5953.27 1050.48,-5953.19 1058.71,-5959.86 1061.08,-5953.27"/>
</g>
<!-- gpu1_layer11_expert0&#45;&gt;gpu1_layer11_expert_agg -->
<g id="edge561" class="edge">
<title>gpu1_layer11_expert0&#45;&gt;gpu1_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M720.1,-6021.04C756.98,-6006.15 804.7,-5986.9 846.16,-5970.16"/>
<polygon fill="black" stroke="black" points="847.5,-5973.4 855.46,-5966.41 844.88,-5966.91 847.5,-5973.4"/>
</g>
<!-- gpu1_layer11_expert1&#45;&gt;gpu1_layer11_expert_agg -->
<g id="edge562" class="edge">
<title>gpu1_layer11_expert1&#45;&gt;gpu1_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M830.07,-6020.62C841.32,-6011.54 854.53,-6000.88 867.8,-5990.17"/>
<polygon fill="black" stroke="black" points="870.02,-5992.87 875.6,-5983.87 865.62,-5987.42 870.02,-5992.87"/>
</g>
<!-- gpu1_layer11_expert2&#45;&gt;gpu1_layer11_expert_agg -->
<g id="edge563" class="edge">
<title>gpu1_layer11_expert2&#45;&gt;gpu1_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M939,-6020.62C939,-6012.69 939,-6003.55 939,-5994.23"/>
<polygon fill="black" stroke="black" points="942.5,-5994.1 939,-5984.1 935.5,-5994.1 942.5,-5994.1"/>
</g>
<!-- gpu1_layer11_expert3&#45;&gt;gpu1_layer11_expert_agg -->
<g id="edge564" class="edge">
<title>gpu1_layer11_expert3&#45;&gt;gpu1_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M1047.93,-6020.62C1036.68,-6011.54 1023.47,-6000.88 1010.2,-5990.17"/>
<polygon fill="black" stroke="black" points="1012.38,-5987.42 1002.4,-5983.87 1007.98,-5992.87 1012.38,-5987.42"/>
</g>
<!-- gpu1_layer11_res2 -->
<g id="node455" class="node">
<title>gpu1_layer11_res2</title>
<polygon fill="lightblue" stroke="black" points="1000,-5842.7 878,-5842.7 878,-5790.7 1000,-5790.7 1000,-5842.7"/>
<text text-anchor="middle" x="939" y="-5830.7" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="939" y="-5819.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-5808.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-5797.7" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer11_expert_agg&#45;&gt;gpu1_layer11_res2 -->
<g id="edge566" class="edge">
<title>gpu1_layer11_expert_agg&#45;&gt;gpu1_layer11_res2</title>
<path fill="none" stroke="black" d="M939,-5879.49C939,-5870.53 939,-5861.41 939,-5853.01"/>
<polygon fill="black" stroke="black" points="942.5,-5852.83 939,-5842.83 935.5,-5852.83 942.5,-5852.83"/>
</g>
<!-- gpu1_layer12_ln1 -->
<g id="node456" class="node">
<title>gpu1_layer12_ln1</title>
<polygon fill="lightblue" stroke="black" points="1000,-5753.7 878,-5753.7 878,-5701.7 1000,-5701.7 1000,-5753.7"/>
<text text-anchor="middle" x="939" y="-5741.7" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="939" y="-5730.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-5719.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-5708.7" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer11_res2&#45;&gt;gpu1_layer12_ln1 -->
<g id="edge571" class="edge">
<title>gpu1_layer11_res2&#45;&gt;gpu1_layer12_ln1</title>
<path fill="none" stroke="black" d="M939,-5790.53C939,-5782.24 939,-5772.85 939,-5763.94"/>
<polygon fill="black" stroke="black" points="942.5,-5763.8 939,-5753.8 935.5,-5763.8 942.5,-5763.8"/>
</g>
<!-- gpu1_layer12_qkv -->
<g id="node457" class="node">
<title>gpu1_layer12_qkv</title>
<polygon fill="lightblue" stroke="black" points="1000,-5664.7 878,-5664.7 878,-5612.7 1000,-5612.7 1000,-5664.7"/>
<text text-anchor="middle" x="939" y="-5652.7" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="939" y="-5641.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-5630.7" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-5619.7" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer12_ln1&#45;&gt;gpu1_layer12_qkv -->
<g id="edge572" class="edge">
<title>gpu1_layer12_ln1&#45;&gt;gpu1_layer12_qkv</title>
<path fill="none" stroke="black" d="M939,-5701.53C939,-5693.24 939,-5683.85 939,-5674.94"/>
<polygon fill="black" stroke="black" points="942.5,-5674.8 939,-5664.8 935.5,-5674.8 942.5,-5674.8"/>
</g>
<!-- gpu1_layer12_reshape -->
<g id="node458" class="node">
<title>gpu1_layer12_reshape</title>
<polygon fill="lightblue" stroke="black" points="1003,-5575.7 875,-5575.7 875,-5523.7 1003,-5523.7 1003,-5575.7"/>
<text text-anchor="middle" x="939" y="-5563.7" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="939" y="-5552.7" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-5541.7" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-5530.7" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer12_qkv&#45;&gt;gpu1_layer12_reshape -->
<g id="edge573" class="edge">
<title>gpu1_layer12_qkv&#45;&gt;gpu1_layer12_reshape</title>
<path fill="none" stroke="black" d="M939,-5612.53C939,-5604.24 939,-5594.85 939,-5585.94"/>
<polygon fill="black" stroke="black" points="942.5,-5585.8 939,-5575.8 935.5,-5585.8 942.5,-5585.8"/>
</g>
<!-- gpu1_layer12_attn -->
<g id="node459" class="node">
<title>gpu1_layer12_attn</title>
<polygon fill="lightblue" stroke="black" points="1003,-5486.7 875,-5486.7 875,-5434.7 1003,-5434.7 1003,-5486.7"/>
<text text-anchor="middle" x="939" y="-5474.7" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="939" y="-5463.7" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-5452.7" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-5441.7" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer12_reshape&#45;&gt;gpu1_layer12_attn -->
<g id="edge574" class="edge">
<title>gpu1_layer12_reshape&#45;&gt;gpu1_layer12_attn</title>
<path fill="none" stroke="black" d="M939,-5523.53C939,-5515.24 939,-5505.85 939,-5496.94"/>
<polygon fill="black" stroke="black" points="942.5,-5496.8 939,-5486.8 935.5,-5496.8 942.5,-5496.8"/>
</g>
<!-- gpu1_layer12_attn_reshape -->
<g id="node461" class="node">
<title>gpu1_layer12_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1000,-5397.7 878,-5397.7 878,-5345.7 1000,-5345.7 1000,-5397.7"/>
<text text-anchor="middle" x="939" y="-5385.7" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="939" y="-5374.7" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-5363.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-5352.7" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer12_attn&#45;&gt;gpu1_layer12_attn_reshape -->
<g id="edge575" class="edge">
<title>gpu1_layer12_attn&#45;&gt;gpu1_layer12_attn_reshape</title>
<path fill="none" stroke="black" d="M939,-5434.53C939,-5426.24 939,-5416.85 939,-5407.94"/>
<polygon fill="black" stroke="black" points="942.5,-5407.8 939,-5397.8 935.5,-5407.8 942.5,-5407.8"/>
</g>
<!-- gpu1_layer12_attn_out -->
<g id="node460" class="node">
<title>gpu1_layer12_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1000,-5308.7 878,-5308.7 878,-5256.7 1000,-5256.7 1000,-5308.7"/>
<text text-anchor="middle" x="939" y="-5296.7" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="939" y="-5285.7" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-5274.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-5263.7" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer12_kv_update -->
<g id="node462" class="node">
<title>gpu1_layer12_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="939" cy="-5182.93" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="939" y="-5196.93" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="939" y="-5185.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-5174.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-5163.93" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer12_attn_out&#45;&gt;gpu1_layer12_kv_update -->
<g id="edge577" class="edge">
<title>gpu1_layer12_attn_out&#45;&gt;gpu1_layer12_kv_update</title>
<path fill="none" stroke="black" d="M939,-5256.52C939,-5248.38 939,-5239.08 939,-5229.92"/>
<polygon fill="black" stroke="black" points="942.5,-5229.71 939,-5219.71 935.5,-5229.71 942.5,-5229.71"/>
</g>
<!-- gpu1_layer12_attn_reshape&#45;&gt;gpu1_layer12_attn_out -->
<g id="edge576" class="edge">
<title>gpu1_layer12_attn_reshape&#45;&gt;gpu1_layer12_attn_out</title>
<path fill="none" stroke="black" d="M939,-5345.53C939,-5337.24 939,-5327.85 939,-5318.94"/>
<polygon fill="black" stroke="black" points="942.5,-5318.8 939,-5308.8 935.5,-5318.8 942.5,-5318.8"/>
</g>
<!-- gpu1_layer12_res1 -->
<g id="node463" class="node">
<title>gpu1_layer12_res1</title>
<polygon fill="lightblue" stroke="black" points="1000,-5109.16 878,-5109.16 878,-5057.16 1000,-5057.16 1000,-5109.16"/>
<text text-anchor="middle" x="939" y="-5097.16" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="939" y="-5086.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-5075.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-5064.16" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer12_kv_update&#45;&gt;gpu1_layer12_res1 -->
<g id="edge578" class="edge">
<title>gpu1_layer12_kv_update&#45;&gt;gpu1_layer12_res1</title>
<path fill="none" stroke="black" d="M939,-5146.08C939,-5137.4 939,-5128.13 939,-5119.47"/>
<polygon fill="black" stroke="black" points="942.5,-5119.3 939,-5109.3 935.5,-5119.3 942.5,-5119.3"/>
</g>
<!-- gpu1_layer12_ln2 -->
<g id="node464" class="node">
<title>gpu1_layer12_ln2</title>
<polygon fill="lightblue" stroke="black" points="1000,-5020.16 878,-5020.16 878,-4968.16 1000,-4968.16 1000,-5020.16"/>
<text text-anchor="middle" x="939" y="-5008.16" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="939" y="-4997.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-4986.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-4975.16" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer12_res1&#45;&gt;gpu1_layer12_ln2 -->
<g id="edge579" class="edge">
<title>gpu1_layer12_res1&#45;&gt;gpu1_layer12_ln2</title>
<path fill="none" stroke="black" d="M939,-5056.99C939,-5048.7 939,-5039.31 939,-5030.4"/>
<polygon fill="black" stroke="black" points="942.5,-5030.26 939,-5020.26 935.5,-5030.26 942.5,-5030.26"/>
</g>
<!-- gpu1_layer12_routing -->
<g id="node465" class="node">
<title>gpu1_layer12_routing</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-4931.16 864.29,-4931.16 812.53,-4805.16 1013.71,-4805.16 1065.47,-4931.16"/>
<text text-anchor="middle" x="939" y="-4887.66" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="939" y="-4876.66" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-4865.66" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-4854.66" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="939" y="-4843.66" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer12_ln2&#45;&gt;gpu1_layer12_routing -->
<g id="edge580" class="edge">
<title>gpu1_layer12_ln2&#45;&gt;gpu1_layer12_routing</title>
<path fill="none" stroke="black" d="M939,-4968.06C939,-4960.13 939,-4950.93 939,-4941.4"/>
<polygon fill="black" stroke="black" points="942.5,-4941.39 939,-4931.39 935.5,-4941.39 942.5,-4941.39"/>
</g>
<!-- gpu1_layer12_expert0 -->
<g id="node466" class="node">
<title>gpu1_layer12_expert0</title>
<polygon fill="lightblue" stroke="black" points="720,-4759.16 598,-4759.16 598,-4707.16 720,-4707.16 720,-4759.16"/>
<text text-anchor="middle" x="659" y="-4747.16" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="659" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer12_routing&#45;&gt;gpu1_layer12_expert0 -->
<g id="edge567" class="edge">
<title>gpu1_layer12_routing&#45;&gt;gpu1_layer12_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M813.33,-4807.46C781.34,-4792.27 748.34,-4776.59 721.11,-4763.66"/>
<polygon fill="black" stroke="black" points="722.26,-4760.33 711.73,-4759.2 719.26,-4766.65 722.26,-4760.33"/>
<text text-anchor="middle" x="795.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer12_expert1 -->
<g id="node467" class="node">
<title>gpu1_layer12_expert1</title>
<polygon fill="lightblue" stroke="black" points="860,-4759.16 738,-4759.16 738,-4707.16 860,-4707.16 860,-4759.16"/>
<text text-anchor="middle" x="799" y="-4747.16" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="799" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer12_routing&#45;&gt;gpu1_layer12_expert1 -->
<g id="edge568" class="edge">
<title>gpu1_layer12_routing&#45;&gt;gpu1_layer12_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M873.51,-4804.94C859.48,-4791.62 845.21,-4778.06 832.97,-4766.43"/>
<polygon fill="black" stroke="black" points="835.29,-4763.8 825.63,-4759.45 830.46,-4768.88 835.29,-4763.8"/>
<text text-anchor="middle" x="882.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer12_expert2 -->
<g id="node468" class="node">
<title>gpu1_layer12_expert2</title>
<polygon fill="lightblue" stroke="black" points="1000,-4759.16 878,-4759.16 878,-4707.16 1000,-4707.16 1000,-4759.16"/>
<text text-anchor="middle" x="939" y="-4747.16" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="939" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer12_routing&#45;&gt;gpu1_layer12_expert2 -->
<g id="edge569" class="edge">
<title>gpu1_layer12_routing&#45;&gt;gpu1_layer12_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M939,-4804.94C939,-4792.87 939,-4780.62 939,-4769.77"/>
<polygon fill="black" stroke="black" points="942.5,-4769.45 939,-4759.45 935.5,-4769.45 942.5,-4769.45"/>
<text text-anchor="middle" x="968.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer12_expert3 -->
<g id="node469" class="node">
<title>gpu1_layer12_expert3</title>
<polygon fill="lightblue" stroke="black" points="1140,-4759.16 1018,-4759.16 1018,-4707.16 1140,-4707.16 1140,-4759.16"/>
<text text-anchor="middle" x="1079" y="-4747.16" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1079" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer12_routing&#45;&gt;gpu1_layer12_expert3 -->
<g id="edge570" class="edge">
<title>gpu1_layer12_routing&#45;&gt;gpu1_layer12_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1004.49,-4804.94C1018.52,-4791.62 1032.79,-4778.06 1045.03,-4766.43"/>
<polygon fill="black" stroke="black" points="1047.54,-4768.88 1052.37,-4759.45 1042.71,-4763.8 1047.54,-4768.88"/>
<text text-anchor="middle" x="1063.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer12_expert_agg -->
<g id="node470" class="node">
<title>gpu1_layer12_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-4670.16 864.29,-4670.16 812.53,-4566.16 1013.71,-4566.16 1065.47,-4670.16"/>
<text text-anchor="middle" x="939" y="-4632.16" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="939" y="-4621.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-4610.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-4599.16" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer12_routing&#45;&gt;gpu1_layer12_expert_agg -->
<g id="edge585" class="edge">
<title>gpu1_layer12_routing&#45;&gt;gpu1_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M1028.22,-4840.24C1101.96,-4813.08 1188.6,-4766.69 1149,-4707.16 1128.44,-4676.24 1094.7,-4656.17 1060.22,-4643.14"/>
<polygon fill="black" stroke="black" points="1061.08,-4639.73 1050.48,-4639.65 1058.71,-4646.32 1061.08,-4639.73"/>
</g>
<!-- gpu1_layer12_expert0&#45;&gt;gpu1_layer12_expert_agg -->
<g id="edge581" class="edge">
<title>gpu1_layer12_expert0&#45;&gt;gpu1_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M720.1,-4707.5C756.98,-4692.62 804.7,-4673.36 846.16,-4656.62"/>
<polygon fill="black" stroke="black" points="847.5,-4659.86 855.46,-4652.87 844.88,-4653.37 847.5,-4659.86"/>
</g>
<!-- gpu1_layer12_expert1&#45;&gt;gpu1_layer12_expert_agg -->
<g id="edge582" class="edge">
<title>gpu1_layer12_expert1&#45;&gt;gpu1_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M830.07,-4707.08C841.32,-4698 854.53,-4687.34 867.8,-4676.63"/>
<polygon fill="black" stroke="black" points="870.02,-4679.33 875.6,-4670.33 865.62,-4673.89 870.02,-4679.33"/>
</g>
<!-- gpu1_layer12_expert2&#45;&gt;gpu1_layer12_expert_agg -->
<g id="edge583" class="edge">
<title>gpu1_layer12_expert2&#45;&gt;gpu1_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M939,-4707.08C939,-4699.15 939,-4690.02 939,-4680.69"/>
<polygon fill="black" stroke="black" points="942.5,-4680.56 939,-4670.56 935.5,-4680.56 942.5,-4680.56"/>
</g>
<!-- gpu1_layer12_expert3&#45;&gt;gpu1_layer12_expert_agg -->
<g id="edge584" class="edge">
<title>gpu1_layer12_expert3&#45;&gt;gpu1_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M1047.93,-4707.08C1036.68,-4698 1023.47,-4687.34 1010.2,-4676.63"/>
<polygon fill="black" stroke="black" points="1012.38,-4673.89 1002.4,-4670.33 1007.98,-4679.33 1012.38,-4673.89"/>
</g>
<!-- gpu1_layer12_res2 -->
<g id="node471" class="node">
<title>gpu1_layer12_res2</title>
<polygon fill="lightblue" stroke="black" points="1000,-4529.16 878,-4529.16 878,-4477.16 1000,-4477.16 1000,-4529.16"/>
<text text-anchor="middle" x="939" y="-4517.16" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="939" y="-4506.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-4495.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-4484.16" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer12_expert_agg&#45;&gt;gpu1_layer12_res2 -->
<g id="edge586" class="edge">
<title>gpu1_layer12_expert_agg&#45;&gt;gpu1_layer12_res2</title>
<path fill="none" stroke="black" d="M939,-4565.95C939,-4557 939,-4547.87 939,-4539.47"/>
<polygon fill="black" stroke="black" points="942.5,-4539.29 939,-4529.29 935.5,-4539.29 942.5,-4539.29"/>
</g>
<!-- gpu1_layer13_ln1 -->
<g id="node472" class="node">
<title>gpu1_layer13_ln1</title>
<polygon fill="lightblue" stroke="black" points="1000,-4440.16 878,-4440.16 878,-4388.16 1000,-4388.16 1000,-4440.16"/>
<text text-anchor="middle" x="939" y="-4428.16" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="939" y="-4417.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-4406.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-4395.16" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer12_res2&#45;&gt;gpu1_layer13_ln1 -->
<g id="edge591" class="edge">
<title>gpu1_layer12_res2&#45;&gt;gpu1_layer13_ln1</title>
<path fill="none" stroke="black" d="M939,-4476.99C939,-4468.7 939,-4459.31 939,-4450.4"/>
<polygon fill="black" stroke="black" points="942.5,-4450.26 939,-4440.26 935.5,-4450.26 942.5,-4450.26"/>
</g>
<!-- gpu1_layer13_qkv -->
<g id="node473" class="node">
<title>gpu1_layer13_qkv</title>
<polygon fill="lightblue" stroke="black" points="1000,-4351.16 878,-4351.16 878,-4299.16 1000,-4299.16 1000,-4351.16"/>
<text text-anchor="middle" x="939" y="-4339.16" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="939" y="-4328.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-4317.16" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-4306.16" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer13_ln1&#45;&gt;gpu1_layer13_qkv -->
<g id="edge592" class="edge">
<title>gpu1_layer13_ln1&#45;&gt;gpu1_layer13_qkv</title>
<path fill="none" stroke="black" d="M939,-4387.99C939,-4379.7 939,-4370.31 939,-4361.4"/>
<polygon fill="black" stroke="black" points="942.5,-4361.26 939,-4351.26 935.5,-4361.26 942.5,-4361.26"/>
</g>
<!-- gpu1_layer13_reshape -->
<g id="node474" class="node">
<title>gpu1_layer13_reshape</title>
<polygon fill="lightblue" stroke="black" points="1003,-4262.16 875,-4262.16 875,-4210.16 1003,-4210.16 1003,-4262.16"/>
<text text-anchor="middle" x="939" y="-4250.16" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="939" y="-4239.16" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-4228.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-4217.16" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer13_qkv&#45;&gt;gpu1_layer13_reshape -->
<g id="edge593" class="edge">
<title>gpu1_layer13_qkv&#45;&gt;gpu1_layer13_reshape</title>
<path fill="none" stroke="black" d="M939,-4298.99C939,-4290.7 939,-4281.31 939,-4272.4"/>
<polygon fill="black" stroke="black" points="942.5,-4272.26 939,-4262.26 935.5,-4272.26 942.5,-4272.26"/>
</g>
<!-- gpu1_layer13_attn -->
<g id="node475" class="node">
<title>gpu1_layer13_attn</title>
<polygon fill="lightblue" stroke="black" points="1003,-4173.16 875,-4173.16 875,-4121.16 1003,-4121.16 1003,-4173.16"/>
<text text-anchor="middle" x="939" y="-4161.16" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="939" y="-4150.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-4139.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-4128.16" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer13_reshape&#45;&gt;gpu1_layer13_attn -->
<g id="edge594" class="edge">
<title>gpu1_layer13_reshape&#45;&gt;gpu1_layer13_attn</title>
<path fill="none" stroke="black" d="M939,-4209.99C939,-4201.7 939,-4192.31 939,-4183.4"/>
<polygon fill="black" stroke="black" points="942.5,-4183.26 939,-4173.26 935.5,-4183.26 942.5,-4183.26"/>
</g>
<!-- gpu1_layer13_attn_reshape -->
<g id="node477" class="node">
<title>gpu1_layer13_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1000,-4084.16 878,-4084.16 878,-4032.16 1000,-4032.16 1000,-4084.16"/>
<text text-anchor="middle" x="939" y="-4072.16" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="939" y="-4061.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-4050.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-4039.16" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer13_attn&#45;&gt;gpu1_layer13_attn_reshape -->
<g id="edge595" class="edge">
<title>gpu1_layer13_attn&#45;&gt;gpu1_layer13_attn_reshape</title>
<path fill="none" stroke="black" d="M939,-4120.99C939,-4112.7 939,-4103.31 939,-4094.4"/>
<polygon fill="black" stroke="black" points="942.5,-4094.26 939,-4084.26 935.5,-4094.26 942.5,-4094.26"/>
</g>
<!-- gpu1_layer13_attn_out -->
<g id="node476" class="node">
<title>gpu1_layer13_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1000,-3995.16 878,-3995.16 878,-3943.16 1000,-3943.16 1000,-3995.16"/>
<text text-anchor="middle" x="939" y="-3983.16" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="939" y="-3972.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-3961.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-3950.16" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer13_kv_update -->
<g id="node478" class="node">
<title>gpu1_layer13_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="939" cy="-3869.39" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="939" y="-3883.39" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="939" y="-3872.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-3861.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-3850.39" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer13_attn_out&#45;&gt;gpu1_layer13_kv_update -->
<g id="edge597" class="edge">
<title>gpu1_layer13_attn_out&#45;&gt;gpu1_layer13_kv_update</title>
<path fill="none" stroke="black" d="M939,-3942.98C939,-3934.84 939,-3925.54 939,-3916.38"/>
<polygon fill="black" stroke="black" points="942.5,-3916.17 939,-3906.17 935.5,-3916.17 942.5,-3916.17"/>
</g>
<!-- gpu1_layer13_attn_reshape&#45;&gt;gpu1_layer13_attn_out -->
<g id="edge596" class="edge">
<title>gpu1_layer13_attn_reshape&#45;&gt;gpu1_layer13_attn_out</title>
<path fill="none" stroke="black" d="M939,-4031.99C939,-4023.7 939,-4014.31 939,-4005.4"/>
<polygon fill="black" stroke="black" points="942.5,-4005.26 939,-3995.26 935.5,-4005.26 942.5,-4005.26"/>
</g>
<!-- gpu1_layer13_res1 -->
<g id="node479" class="node">
<title>gpu1_layer13_res1</title>
<polygon fill="lightblue" stroke="black" points="1000,-3795.62 878,-3795.62 878,-3743.62 1000,-3743.62 1000,-3795.62"/>
<text text-anchor="middle" x="939" y="-3783.62" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="939" y="-3772.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-3761.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-3750.62" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer13_kv_update&#45;&gt;gpu1_layer13_res1 -->
<g id="edge598" class="edge">
<title>gpu1_layer13_kv_update&#45;&gt;gpu1_layer13_res1</title>
<path fill="none" stroke="black" d="M939,-3832.54C939,-3823.86 939,-3814.59 939,-3805.93"/>
<polygon fill="black" stroke="black" points="942.5,-3805.76 939,-3795.76 935.5,-3805.76 942.5,-3805.76"/>
</g>
<!-- gpu1_layer13_ln2 -->
<g id="node480" class="node">
<title>gpu1_layer13_ln2</title>
<polygon fill="lightblue" stroke="black" points="1000,-3706.62 878,-3706.62 878,-3654.62 1000,-3654.62 1000,-3706.62"/>
<text text-anchor="middle" x="939" y="-3694.62" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="939" y="-3683.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-3672.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-3661.62" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer13_res1&#45;&gt;gpu1_layer13_ln2 -->
<g id="edge599" class="edge">
<title>gpu1_layer13_res1&#45;&gt;gpu1_layer13_ln2</title>
<path fill="none" stroke="black" d="M939,-3743.45C939,-3735.16 939,-3725.77 939,-3716.87"/>
<polygon fill="black" stroke="black" points="942.5,-3716.72 939,-3706.72 935.5,-3716.72 942.5,-3716.72"/>
</g>
<!-- gpu1_layer13_routing -->
<g id="node481" class="node">
<title>gpu1_layer13_routing</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-3617.62 864.29,-3617.62 812.53,-3491.62 1013.71,-3491.62 1065.47,-3617.62"/>
<text text-anchor="middle" x="939" y="-3574.12" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="939" y="-3563.12" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-3552.12" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-3541.12" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="939" y="-3530.12" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer13_ln2&#45;&gt;gpu1_layer13_routing -->
<g id="edge600" class="edge">
<title>gpu1_layer13_ln2&#45;&gt;gpu1_layer13_routing</title>
<path fill="none" stroke="black" d="M939,-3654.52C939,-3646.59 939,-3637.4 939,-3627.87"/>
<polygon fill="black" stroke="black" points="942.5,-3627.85 939,-3617.85 935.5,-3627.85 942.5,-3627.85"/>
</g>
<!-- gpu1_layer13_expert0 -->
<g id="node482" class="node">
<title>gpu1_layer13_expert0</title>
<polygon fill="lightblue" stroke="black" points="720,-3445.62 598,-3445.62 598,-3393.62 720,-3393.62 720,-3445.62"/>
<text text-anchor="middle" x="659" y="-3433.62" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="659" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer13_routing&#45;&gt;gpu1_layer13_expert0 -->
<g id="edge587" class="edge">
<title>gpu1_layer13_routing&#45;&gt;gpu1_layer13_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M813.33,-3493.93C781.34,-3478.73 748.34,-3463.05 721.11,-3450.12"/>
<polygon fill="black" stroke="black" points="722.26,-3446.79 711.73,-3445.66 719.26,-3453.11 722.26,-3446.79"/>
<text text-anchor="middle" x="795.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer13_expert1 -->
<g id="node483" class="node">
<title>gpu1_layer13_expert1</title>
<polygon fill="lightblue" stroke="black" points="860,-3445.62 738,-3445.62 738,-3393.62 860,-3393.62 860,-3445.62"/>
<text text-anchor="middle" x="799" y="-3433.62" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="799" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer13_routing&#45;&gt;gpu1_layer13_expert1 -->
<g id="edge588" class="edge">
<title>gpu1_layer13_routing&#45;&gt;gpu1_layer13_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M873.51,-3491.4C859.48,-3478.08 845.21,-3464.52 832.97,-3452.89"/>
<polygon fill="black" stroke="black" points="835.29,-3450.26 825.63,-3445.91 830.46,-3455.34 835.29,-3450.26"/>
<text text-anchor="middle" x="882.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer13_expert2 -->
<g id="node484" class="node">
<title>gpu1_layer13_expert2</title>
<polygon fill="lightblue" stroke="black" points="1000,-3445.62 878,-3445.62 878,-3393.62 1000,-3393.62 1000,-3445.62"/>
<text text-anchor="middle" x="939" y="-3433.62" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="939" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer13_routing&#45;&gt;gpu1_layer13_expert2 -->
<g id="edge589" class="edge">
<title>gpu1_layer13_routing&#45;&gt;gpu1_layer13_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M939,-3491.4C939,-3479.33 939,-3467.08 939,-3456.23"/>
<polygon fill="black" stroke="black" points="942.5,-3455.91 939,-3445.91 935.5,-3455.91 942.5,-3455.91"/>
<text text-anchor="middle" x="968.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer13_expert3 -->
<g id="node485" class="node">
<title>gpu1_layer13_expert3</title>
<polygon fill="lightblue" stroke="black" points="1140,-3445.62 1018,-3445.62 1018,-3393.62 1140,-3393.62 1140,-3445.62"/>
<text text-anchor="middle" x="1079" y="-3433.62" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1079" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer13_routing&#45;&gt;gpu1_layer13_expert3 -->
<g id="edge590" class="edge">
<title>gpu1_layer13_routing&#45;&gt;gpu1_layer13_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1004.49,-3491.4C1018.52,-3478.08 1032.79,-3464.52 1045.03,-3452.89"/>
<polygon fill="black" stroke="black" points="1047.54,-3455.34 1052.37,-3445.91 1042.71,-3450.26 1047.54,-3455.34"/>
<text text-anchor="middle" x="1063.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer13_expert_agg -->
<g id="node486" class="node">
<title>gpu1_layer13_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-3356.62 864.29,-3356.62 812.53,-3252.62 1013.71,-3252.62 1065.47,-3356.62"/>
<text text-anchor="middle" x="939" y="-3318.62" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="939" y="-3307.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-3296.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-3285.62" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer13_routing&#45;&gt;gpu1_layer13_expert_agg -->
<g id="edge605" class="edge">
<title>gpu1_layer13_routing&#45;&gt;gpu1_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M1028.22,-3526.7C1101.96,-3499.54 1188.6,-3453.15 1149,-3393.62 1128.44,-3362.71 1094.7,-3342.63 1060.22,-3329.6"/>
<polygon fill="black" stroke="black" points="1061.08,-3326.19 1050.48,-3326.11 1058.71,-3332.78 1061.08,-3326.19"/>
</g>
<!-- gpu1_layer13_expert0&#45;&gt;gpu1_layer13_expert_agg -->
<g id="edge601" class="edge">
<title>gpu1_layer13_expert0&#45;&gt;gpu1_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M720.1,-3393.96C756.98,-3379.08 804.7,-3359.82 846.16,-3343.08"/>
<polygon fill="black" stroke="black" points="847.5,-3346.32 855.46,-3339.33 844.88,-3339.83 847.5,-3346.32"/>
</g>
<!-- gpu1_layer13_expert1&#45;&gt;gpu1_layer13_expert_agg -->
<g id="edge602" class="edge">
<title>gpu1_layer13_expert1&#45;&gt;gpu1_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M830.07,-3393.54C841.32,-3384.46 854.53,-3373.8 867.8,-3363.09"/>
<polygon fill="black" stroke="black" points="870.02,-3365.79 875.6,-3356.79 865.62,-3360.35 870.02,-3365.79"/>
</g>
<!-- gpu1_layer13_expert2&#45;&gt;gpu1_layer13_expert_agg -->
<g id="edge603" class="edge">
<title>gpu1_layer13_expert2&#45;&gt;gpu1_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M939,-3393.54C939,-3385.61 939,-3376.48 939,-3367.16"/>
<polygon fill="black" stroke="black" points="942.5,-3367.02 939,-3357.02 935.5,-3367.02 942.5,-3367.02"/>
</g>
<!-- gpu1_layer13_expert3&#45;&gt;gpu1_layer13_expert_agg -->
<g id="edge604" class="edge">
<title>gpu1_layer13_expert3&#45;&gt;gpu1_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M1047.93,-3393.54C1036.68,-3384.46 1023.47,-3373.8 1010.2,-3363.09"/>
<polygon fill="black" stroke="black" points="1012.38,-3360.35 1002.4,-3356.79 1007.98,-3365.79 1012.38,-3360.35"/>
</g>
<!-- gpu1_layer13_res2 -->
<g id="node487" class="node">
<title>gpu1_layer13_res2</title>
<polygon fill="lightblue" stroke="black" points="1000,-3215.62 878,-3215.62 878,-3163.62 1000,-3163.62 1000,-3215.62"/>
<text text-anchor="middle" x="939" y="-3203.62" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="939" y="-3192.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-3181.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-3170.62" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer13_expert_agg&#45;&gt;gpu1_layer13_res2 -->
<g id="edge606" class="edge">
<title>gpu1_layer13_expert_agg&#45;&gt;gpu1_layer13_res2</title>
<path fill="none" stroke="black" d="M939,-3252.41C939,-3243.46 939,-3234.33 939,-3225.93"/>
<polygon fill="black" stroke="black" points="942.5,-3225.75 939,-3215.75 935.5,-3225.75 942.5,-3225.75"/>
</g>
<!-- gpu1_layer14_ln1 -->
<g id="node488" class="node">
<title>gpu1_layer14_ln1</title>
<polygon fill="lightblue" stroke="black" points="1000,-3126.62 878,-3126.62 878,-3074.62 1000,-3074.62 1000,-3126.62"/>
<text text-anchor="middle" x="939" y="-3114.62" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="939" y="-3103.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-3092.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-3081.62" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer13_res2&#45;&gt;gpu1_layer14_ln1 -->
<g id="edge611" class="edge">
<title>gpu1_layer13_res2&#45;&gt;gpu1_layer14_ln1</title>
<path fill="none" stroke="black" d="M939,-3163.45C939,-3155.16 939,-3145.77 939,-3136.87"/>
<polygon fill="black" stroke="black" points="942.5,-3136.72 939,-3126.72 935.5,-3136.72 942.5,-3136.72"/>
</g>
<!-- gpu1_layer14_qkv -->
<g id="node489" class="node">
<title>gpu1_layer14_qkv</title>
<polygon fill="lightblue" stroke="black" points="1000,-3037.62 878,-3037.62 878,-2985.62 1000,-2985.62 1000,-3037.62"/>
<text text-anchor="middle" x="939" y="-3025.62" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="939" y="-3014.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-3003.62" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-2992.62" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer14_ln1&#45;&gt;gpu1_layer14_qkv -->
<g id="edge612" class="edge">
<title>gpu1_layer14_ln1&#45;&gt;gpu1_layer14_qkv</title>
<path fill="none" stroke="black" d="M939,-3074.45C939,-3066.16 939,-3056.77 939,-3047.87"/>
<polygon fill="black" stroke="black" points="942.5,-3047.72 939,-3037.72 935.5,-3047.72 942.5,-3047.72"/>
</g>
<!-- gpu1_layer14_reshape -->
<g id="node490" class="node">
<title>gpu1_layer14_reshape</title>
<polygon fill="lightblue" stroke="black" points="1003,-2948.62 875,-2948.62 875,-2896.62 1003,-2896.62 1003,-2948.62"/>
<text text-anchor="middle" x="939" y="-2936.62" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="939" y="-2925.62" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-2914.62" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-2903.62" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer14_qkv&#45;&gt;gpu1_layer14_reshape -->
<g id="edge613" class="edge">
<title>gpu1_layer14_qkv&#45;&gt;gpu1_layer14_reshape</title>
<path fill="none" stroke="black" d="M939,-2985.45C939,-2977.16 939,-2967.77 939,-2958.87"/>
<polygon fill="black" stroke="black" points="942.5,-2958.72 939,-2948.72 935.5,-2958.72 942.5,-2958.72"/>
</g>
<!-- gpu1_layer14_attn -->
<g id="node491" class="node">
<title>gpu1_layer14_attn</title>
<polygon fill="lightblue" stroke="black" points="1003,-2859.62 875,-2859.62 875,-2807.62 1003,-2807.62 1003,-2859.62"/>
<text text-anchor="middle" x="939" y="-2847.62" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="939" y="-2836.62" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-2825.62" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-2814.62" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer14_reshape&#45;&gt;gpu1_layer14_attn -->
<g id="edge614" class="edge">
<title>gpu1_layer14_reshape&#45;&gt;gpu1_layer14_attn</title>
<path fill="none" stroke="black" d="M939,-2896.45C939,-2888.16 939,-2878.77 939,-2869.87"/>
<polygon fill="black" stroke="black" points="942.5,-2869.72 939,-2859.72 935.5,-2869.72 942.5,-2869.72"/>
</g>
<!-- gpu1_layer14_attn_reshape -->
<g id="node493" class="node">
<title>gpu1_layer14_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1000,-2770.62 878,-2770.62 878,-2718.62 1000,-2718.62 1000,-2770.62"/>
<text text-anchor="middle" x="939" y="-2758.62" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="939" y="-2747.62" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-2736.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-2725.62" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer14_attn&#45;&gt;gpu1_layer14_attn_reshape -->
<g id="edge615" class="edge">
<title>gpu1_layer14_attn&#45;&gt;gpu1_layer14_attn_reshape</title>
<path fill="none" stroke="black" d="M939,-2807.45C939,-2799.16 939,-2789.77 939,-2780.87"/>
<polygon fill="black" stroke="black" points="942.5,-2780.72 939,-2770.72 935.5,-2780.72 942.5,-2780.72"/>
</g>
<!-- gpu1_layer14_attn_out -->
<g id="node492" class="node">
<title>gpu1_layer14_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1000,-2681.62 878,-2681.62 878,-2629.62 1000,-2629.62 1000,-2681.62"/>
<text text-anchor="middle" x="939" y="-2669.62" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="939" y="-2658.62" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-2647.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-2636.62" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer14_kv_update -->
<g id="node494" class="node">
<title>gpu1_layer14_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="939" cy="-2555.85" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="939" y="-2569.85" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="939" y="-2558.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-2547.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-2536.85" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer14_attn_out&#45;&gt;gpu1_layer14_kv_update -->
<g id="edge617" class="edge">
<title>gpu1_layer14_attn_out&#45;&gt;gpu1_layer14_kv_update</title>
<path fill="none" stroke="black" d="M939,-2629.44C939,-2621.3 939,-2612 939,-2602.84"/>
<polygon fill="black" stroke="black" points="942.5,-2602.63 939,-2592.63 935.5,-2602.63 942.5,-2602.63"/>
</g>
<!-- gpu1_layer14_attn_reshape&#45;&gt;gpu1_layer14_attn_out -->
<g id="edge616" class="edge">
<title>gpu1_layer14_attn_reshape&#45;&gt;gpu1_layer14_attn_out</title>
<path fill="none" stroke="black" d="M939,-2718.45C939,-2710.16 939,-2700.77 939,-2691.87"/>
<polygon fill="black" stroke="black" points="942.5,-2691.72 939,-2681.72 935.5,-2691.72 942.5,-2691.72"/>
</g>
<!-- gpu1_layer14_res1 -->
<g id="node495" class="node">
<title>gpu1_layer14_res1</title>
<polygon fill="lightblue" stroke="black" points="1000,-2482.08 878,-2482.08 878,-2430.08 1000,-2430.08 1000,-2482.08"/>
<text text-anchor="middle" x="939" y="-2470.08" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="939" y="-2459.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-2448.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-2437.08" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer14_kv_update&#45;&gt;gpu1_layer14_res1 -->
<g id="edge618" class="edge">
<title>gpu1_layer14_kv_update&#45;&gt;gpu1_layer14_res1</title>
<path fill="none" stroke="black" d="M939,-2519C939,-2510.32 939,-2501.05 939,-2492.39"/>
<polygon fill="black" stroke="black" points="942.5,-2492.22 939,-2482.22 935.5,-2492.22 942.5,-2492.22"/>
</g>
<!-- gpu1_layer14_ln2 -->
<g id="node496" class="node">
<title>gpu1_layer14_ln2</title>
<polygon fill="lightblue" stroke="black" points="1000,-2393.08 878,-2393.08 878,-2341.08 1000,-2341.08 1000,-2393.08"/>
<text text-anchor="middle" x="939" y="-2381.08" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="939" y="-2370.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-2359.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-2348.08" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer14_res1&#45;&gt;gpu1_layer14_ln2 -->
<g id="edge619" class="edge">
<title>gpu1_layer14_res1&#45;&gt;gpu1_layer14_ln2</title>
<path fill="none" stroke="black" d="M939,-2429.91C939,-2421.62 939,-2412.23 939,-2403.33"/>
<polygon fill="black" stroke="black" points="942.5,-2403.19 939,-2393.19 935.5,-2403.19 942.5,-2403.19"/>
</g>
<!-- gpu1_layer14_routing -->
<g id="node497" class="node">
<title>gpu1_layer14_routing</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-2304.08 864.29,-2304.08 812.53,-2178.08 1013.71,-2178.08 1065.47,-2304.08"/>
<text text-anchor="middle" x="939" y="-2260.58" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="939" y="-2249.58" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-2238.58" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-2227.58" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="939" y="-2216.58" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer14_ln2&#45;&gt;gpu1_layer14_routing -->
<g id="edge620" class="edge">
<title>gpu1_layer14_ln2&#45;&gt;gpu1_layer14_routing</title>
<path fill="none" stroke="black" d="M939,-2340.98C939,-2333.05 939,-2323.86 939,-2314.33"/>
<polygon fill="black" stroke="black" points="942.5,-2314.31 939,-2304.31 935.5,-2314.31 942.5,-2314.31"/>
</g>
<!-- gpu1_layer14_expert0 -->
<g id="node498" class="node">
<title>gpu1_layer14_expert0</title>
<polygon fill="lightblue" stroke="black" points="720,-2132.08 598,-2132.08 598,-2080.08 720,-2080.08 720,-2132.08"/>
<text text-anchor="middle" x="659" y="-2120.08" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="659" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer14_routing&#45;&gt;gpu1_layer14_expert0 -->
<g id="edge607" class="edge">
<title>gpu1_layer14_routing&#45;&gt;gpu1_layer14_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M813.33,-2180.39C781.34,-2165.19 748.34,-2149.51 721.11,-2136.58"/>
<polygon fill="black" stroke="black" points="722.26,-2133.25 711.73,-2132.12 719.26,-2139.58 722.26,-2133.25"/>
<text text-anchor="middle" x="795.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer14_expert1 -->
<g id="node499" class="node">
<title>gpu1_layer14_expert1</title>
<polygon fill="lightblue" stroke="black" points="860,-2132.08 738,-2132.08 738,-2080.08 860,-2080.08 860,-2132.08"/>
<text text-anchor="middle" x="799" y="-2120.08" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="799" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer14_routing&#45;&gt;gpu1_layer14_expert1 -->
<g id="edge608" class="edge">
<title>gpu1_layer14_routing&#45;&gt;gpu1_layer14_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M873.51,-2177.86C859.48,-2164.54 845.21,-2150.98 832.97,-2139.35"/>
<polygon fill="black" stroke="black" points="835.29,-2136.72 825.63,-2132.37 830.46,-2141.8 835.29,-2136.72"/>
<text text-anchor="middle" x="882.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer14_expert2 -->
<g id="node500" class="node">
<title>gpu1_layer14_expert2</title>
<polygon fill="lightblue" stroke="black" points="1000,-2132.08 878,-2132.08 878,-2080.08 1000,-2080.08 1000,-2132.08"/>
<text text-anchor="middle" x="939" y="-2120.08" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="939" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer14_routing&#45;&gt;gpu1_layer14_expert2 -->
<g id="edge609" class="edge">
<title>gpu1_layer14_routing&#45;&gt;gpu1_layer14_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M939,-2177.86C939,-2165.79 939,-2153.54 939,-2142.69"/>
<polygon fill="black" stroke="black" points="942.5,-2142.37 939,-2132.37 935.5,-2142.37 942.5,-2142.37"/>
<text text-anchor="middle" x="968.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer14_expert3 -->
<g id="node501" class="node">
<title>gpu1_layer14_expert3</title>
<polygon fill="lightblue" stroke="black" points="1140,-2132.08 1018,-2132.08 1018,-2080.08 1140,-2080.08 1140,-2132.08"/>
<text text-anchor="middle" x="1079" y="-2120.08" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1079" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer14_routing&#45;&gt;gpu1_layer14_expert3 -->
<g id="edge610" class="edge">
<title>gpu1_layer14_routing&#45;&gt;gpu1_layer14_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1004.49,-2177.86C1018.52,-2164.54 1032.79,-2150.98 1045.03,-2139.35"/>
<polygon fill="black" stroke="black" points="1047.54,-2141.8 1052.37,-2132.37 1042.71,-2136.72 1047.54,-2141.8"/>
<text text-anchor="middle" x="1063.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer14_expert_agg -->
<g id="node502" class="node">
<title>gpu1_layer14_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-2043.08 864.29,-2043.08 812.53,-1939.08 1013.71,-1939.08 1065.47,-2043.08"/>
<text text-anchor="middle" x="939" y="-2005.08" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="939" y="-1994.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-1983.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-1972.08" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer14_routing&#45;&gt;gpu1_layer14_expert_agg -->
<g id="edge625" class="edge">
<title>gpu1_layer14_routing&#45;&gt;gpu1_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M1028.22,-2213.16C1101.96,-2186 1188.6,-2139.61 1149,-2080.08 1128.44,-2049.17 1094.7,-2029.09 1060.22,-2016.06"/>
<polygon fill="black" stroke="black" points="1061.08,-2012.65 1050.48,-2012.57 1058.71,-2019.24 1061.08,-2012.65"/>
</g>
<!-- gpu1_layer14_expert0&#45;&gt;gpu1_layer14_expert_agg -->
<g id="edge621" class="edge">
<title>gpu1_layer14_expert0&#45;&gt;gpu1_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M720.1,-2080.42C756.98,-2065.54 804.7,-2046.28 846.16,-2029.54"/>
<polygon fill="black" stroke="black" points="847.5,-2032.78 855.46,-2025.79 844.88,-2026.29 847.5,-2032.78"/>
</g>
<!-- gpu1_layer14_expert1&#45;&gt;gpu1_layer14_expert_agg -->
<g id="edge622" class="edge">
<title>gpu1_layer14_expert1&#45;&gt;gpu1_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M830.07,-2080C841.32,-2070.92 854.53,-2060.26 867.8,-2049.55"/>
<polygon fill="black" stroke="black" points="870.02,-2052.25 875.6,-2043.25 865.62,-2046.81 870.02,-2052.25"/>
</g>
<!-- gpu1_layer14_expert2&#45;&gt;gpu1_layer14_expert_agg -->
<g id="edge623" class="edge">
<title>gpu1_layer14_expert2&#45;&gt;gpu1_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M939,-2080C939,-2072.07 939,-2062.94 939,-2053.62"/>
<polygon fill="black" stroke="black" points="942.5,-2053.48 939,-2043.48 935.5,-2053.48 942.5,-2053.48"/>
</g>
<!-- gpu1_layer14_expert3&#45;&gt;gpu1_layer14_expert_agg -->
<g id="edge624" class="edge">
<title>gpu1_layer14_expert3&#45;&gt;gpu1_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M1047.93,-2080C1036.68,-2070.92 1023.47,-2060.26 1010.2,-2049.55"/>
<polygon fill="black" stroke="black" points="1012.38,-2046.81 1002.4,-2043.25 1007.98,-2052.25 1012.38,-2046.81"/>
</g>
<!-- gpu1_layer14_res2 -->
<g id="node503" class="node">
<title>gpu1_layer14_res2</title>
<polygon fill="lightblue" stroke="black" points="1000,-1902.08 878,-1902.08 878,-1850.08 1000,-1850.08 1000,-1902.08"/>
<text text-anchor="middle" x="939" y="-1890.08" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="939" y="-1879.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-1868.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-1857.08" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer14_expert_agg&#45;&gt;gpu1_layer14_res2 -->
<g id="edge626" class="edge">
<title>gpu1_layer14_expert_agg&#45;&gt;gpu1_layer14_res2</title>
<path fill="none" stroke="black" d="M939,-1938.87C939,-1929.92 939,-1920.79 939,-1912.39"/>
<polygon fill="black" stroke="black" points="942.5,-1912.21 939,-1902.21 935.5,-1912.21 942.5,-1912.21"/>
</g>
<!-- gpu1_layer15_ln1 -->
<g id="node504" class="node">
<title>gpu1_layer15_ln1</title>
<polygon fill="lightblue" stroke="black" points="1000,-1813.08 878,-1813.08 878,-1761.08 1000,-1761.08 1000,-1813.08"/>
<text text-anchor="middle" x="939" y="-1801.08" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="939" y="-1790.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-1779.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-1768.08" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer14_res2&#45;&gt;gpu1_layer15_ln1 -->
<g id="edge631" class="edge">
<title>gpu1_layer14_res2&#45;&gt;gpu1_layer15_ln1</title>
<path fill="none" stroke="black" d="M939,-1849.91C939,-1841.62 939,-1832.23 939,-1823.33"/>
<polygon fill="black" stroke="black" points="942.5,-1823.19 939,-1813.19 935.5,-1823.19 942.5,-1823.19"/>
</g>
<!-- gpu1_layer15_qkv -->
<g id="node505" class="node">
<title>gpu1_layer15_qkv</title>
<polygon fill="lightblue" stroke="black" points="1000,-1724.08 878,-1724.08 878,-1672.08 1000,-1672.08 1000,-1724.08"/>
<text text-anchor="middle" x="939" y="-1712.08" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="939" y="-1701.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-1690.08" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-1679.08" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer15_ln1&#45;&gt;gpu1_layer15_qkv -->
<g id="edge632" class="edge">
<title>gpu1_layer15_ln1&#45;&gt;gpu1_layer15_qkv</title>
<path fill="none" stroke="black" d="M939,-1760.91C939,-1752.62 939,-1743.23 939,-1734.33"/>
<polygon fill="black" stroke="black" points="942.5,-1734.19 939,-1724.19 935.5,-1734.19 942.5,-1734.19"/>
</g>
<!-- gpu1_layer15_reshape -->
<g id="node506" class="node">
<title>gpu1_layer15_reshape</title>
<polygon fill="lightblue" stroke="black" points="1003,-1635.08 875,-1635.08 875,-1583.08 1003,-1583.08 1003,-1635.08"/>
<text text-anchor="middle" x="939" y="-1623.08" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="939" y="-1612.08" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="939" y="-1601.08" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-1590.08" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer15_qkv&#45;&gt;gpu1_layer15_reshape -->
<g id="edge633" class="edge">
<title>gpu1_layer15_qkv&#45;&gt;gpu1_layer15_reshape</title>
<path fill="none" stroke="black" d="M939,-1671.91C939,-1663.62 939,-1654.23 939,-1645.33"/>
<polygon fill="black" stroke="black" points="942.5,-1645.19 939,-1635.19 935.5,-1645.19 942.5,-1645.19"/>
</g>
<!-- gpu1_layer15_attn -->
<g id="node507" class="node">
<title>gpu1_layer15_attn</title>
<polygon fill="lightblue" stroke="black" points="1003,-1546.08 875,-1546.08 875,-1494.08 1003,-1494.08 1003,-1546.08"/>
<text text-anchor="middle" x="939" y="-1534.08" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="939" y="-1523.08" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-1512.08" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-1501.08" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer15_reshape&#45;&gt;gpu1_layer15_attn -->
<g id="edge634" class="edge">
<title>gpu1_layer15_reshape&#45;&gt;gpu1_layer15_attn</title>
<path fill="none" stroke="black" d="M939,-1582.91C939,-1574.62 939,-1565.23 939,-1556.33"/>
<polygon fill="black" stroke="black" points="942.5,-1556.19 939,-1546.19 935.5,-1556.19 942.5,-1556.19"/>
</g>
<!-- gpu1_layer15_attn_reshape -->
<g id="node509" class="node">
<title>gpu1_layer15_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1000,-1457.08 878,-1457.08 878,-1405.08 1000,-1405.08 1000,-1457.08"/>
<text text-anchor="middle" x="939" y="-1445.08" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="939" y="-1434.08" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-1423.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-1412.08" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer15_attn&#45;&gt;gpu1_layer15_attn_reshape -->
<g id="edge635" class="edge">
<title>gpu1_layer15_attn&#45;&gt;gpu1_layer15_attn_reshape</title>
<path fill="none" stroke="black" d="M939,-1493.91C939,-1485.62 939,-1476.23 939,-1467.33"/>
<polygon fill="black" stroke="black" points="942.5,-1467.19 939,-1457.19 935.5,-1467.19 942.5,-1467.19"/>
</g>
<!-- gpu1_layer15_attn_out -->
<g id="node508" class="node">
<title>gpu1_layer15_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1000,-1368.08 878,-1368.08 878,-1316.08 1000,-1316.08 1000,-1368.08"/>
<text text-anchor="middle" x="939" y="-1356.08" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="939" y="-1345.08" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="939" y="-1334.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-1323.08" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer15_kv_update -->
<g id="node510" class="node">
<title>gpu1_layer15_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="939" cy="-1242.31" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="939" y="-1256.31" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="939" y="-1245.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-1234.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-1223.31" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer15_attn_out&#45;&gt;gpu1_layer15_kv_update -->
<g id="edge637" class="edge">
<title>gpu1_layer15_attn_out&#45;&gt;gpu1_layer15_kv_update</title>
<path fill="none" stroke="black" d="M939,-1315.9C939,-1307.76 939,-1298.46 939,-1289.3"/>
<polygon fill="black" stroke="black" points="942.5,-1289.09 939,-1279.09 935.5,-1289.09 942.5,-1289.09"/>
</g>
<!-- gpu1_layer15_attn_reshape&#45;&gt;gpu1_layer15_attn_out -->
<g id="edge636" class="edge">
<title>gpu1_layer15_attn_reshape&#45;&gt;gpu1_layer15_attn_out</title>
<path fill="none" stroke="black" d="M939,-1404.91C939,-1396.62 939,-1387.23 939,-1378.33"/>
<polygon fill="black" stroke="black" points="942.5,-1378.19 939,-1368.19 935.5,-1378.19 942.5,-1378.19"/>
</g>
<!-- gpu1_layer15_res1 -->
<g id="node511" class="node">
<title>gpu1_layer15_res1</title>
<polygon fill="lightblue" stroke="black" points="1000,-1168.54 878,-1168.54 878,-1116.54 1000,-1116.54 1000,-1168.54"/>
<text text-anchor="middle" x="939" y="-1156.54" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="939" y="-1145.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-1134.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-1123.54" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer15_kv_update&#45;&gt;gpu1_layer15_res1 -->
<g id="edge638" class="edge">
<title>gpu1_layer15_kv_update&#45;&gt;gpu1_layer15_res1</title>
<path fill="none" stroke="black" d="M939,-1205.46C939,-1196.78 939,-1187.51 939,-1178.85"/>
<polygon fill="black" stroke="black" points="942.5,-1178.69 939,-1168.69 935.5,-1178.69 942.5,-1178.69"/>
</g>
<!-- gpu1_layer15_ln2 -->
<g id="node512" class="node">
<title>gpu1_layer15_ln2</title>
<polygon fill="lightblue" stroke="black" points="1000,-1079.54 878,-1079.54 878,-1027.54 1000,-1027.54 1000,-1079.54"/>
<text text-anchor="middle" x="939" y="-1067.54" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="939" y="-1056.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-1045.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-1034.54" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer15_res1&#45;&gt;gpu1_layer15_ln2 -->
<g id="edge639" class="edge">
<title>gpu1_layer15_res1&#45;&gt;gpu1_layer15_ln2</title>
<path fill="none" stroke="black" d="M939,-1116.38C939,-1108.08 939,-1098.69 939,-1089.79"/>
<polygon fill="black" stroke="black" points="942.5,-1089.65 939,-1079.65 935.5,-1089.65 942.5,-1089.65"/>
</g>
<!-- gpu1_layer15_routing -->
<g id="node513" class="node">
<title>gpu1_layer15_routing</title>
<polygon fill="lightyellow" stroke="black" points="1065.47,-990.54 864.29,-990.54 812.53,-864.54 1013.71,-864.54 1065.47,-990.54"/>
<text text-anchor="middle" x="939" y="-947.04" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="939" y="-936.04" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-925.04" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-914.04" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="939" y="-903.04" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer15_ln2&#45;&gt;gpu1_layer15_routing -->
<g id="edge640" class="edge">
<title>gpu1_layer15_ln2&#45;&gt;gpu1_layer15_routing</title>
<path fill="none" stroke="black" d="M939,-1027.45C939,-1019.51 939,-1010.32 939,-1000.79"/>
<polygon fill="black" stroke="black" points="942.5,-1000.77 939,-990.77 935.5,-1000.77 942.5,-1000.77"/>
</g>
<!-- gpu1_layer15_expert0 -->
<g id="node514" class="node">
<title>gpu1_layer15_expert0</title>
<polygon fill="lightblue" stroke="black" points="720,-818.54 598,-818.54 598,-766.54 720,-766.54 720,-818.54"/>
<text text-anchor="middle" x="659" y="-806.54" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="659" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="659" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer15_routing&#45;&gt;gpu1_layer15_expert0 -->
<g id="edge627" class="edge">
<title>gpu1_layer15_routing&#45;&gt;gpu1_layer15_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M813.33,-866.85C781.34,-851.65 748.34,-835.98 721.11,-823.04"/>
<polygon fill="black" stroke="black" points="722.26,-819.71 711.73,-818.58 719.26,-826.04 722.26,-819.71"/>
<text text-anchor="middle" x="795.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer15_expert1 -->
<g id="node515" class="node">
<title>gpu1_layer15_expert1</title>
<polygon fill="lightblue" stroke="black" points="860,-818.54 738,-818.54 738,-766.54 860,-766.54 860,-818.54"/>
<text text-anchor="middle" x="799" y="-806.54" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="799" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="799" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer15_routing&#45;&gt;gpu1_layer15_expert1 -->
<g id="edge628" class="edge">
<title>gpu1_layer15_routing&#45;&gt;gpu1_layer15_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M873.51,-864.32C859.48,-851 845.21,-837.44 832.97,-825.81"/>
<polygon fill="black" stroke="black" points="835.29,-823.18 825.63,-818.83 830.46,-828.26 835.29,-823.18"/>
<text text-anchor="middle" x="882.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer15_expert2 -->
<g id="node516" class="node">
<title>gpu1_layer15_expert2</title>
<polygon fill="lightblue" stroke="black" points="1000,-818.54 878,-818.54 878,-766.54 1000,-766.54 1000,-818.54"/>
<text text-anchor="middle" x="939" y="-806.54" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="939" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="939" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer15_routing&#45;&gt;gpu1_layer15_expert2 -->
<g id="edge629" class="edge">
<title>gpu1_layer15_routing&#45;&gt;gpu1_layer15_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M939,-864.32C939,-852.25 939,-840 939,-829.15"/>
<polygon fill="black" stroke="black" points="942.5,-828.83 939,-818.83 935.5,-828.83 942.5,-828.83"/>
<text text-anchor="middle" x="968.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer15_expert3 -->
<g id="node517" class="node">
<title>gpu1_layer15_expert3</title>
<polygon fill="lightblue" stroke="black" points="1140,-818.54 1018,-818.54 1018,-766.54 1140,-766.54 1140,-818.54"/>
<text text-anchor="middle" x="1079" y="-806.54" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1079" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1079" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer15_routing&#45;&gt;gpu1_layer15_expert3 -->
<g id="edge630" class="edge">
<title>gpu1_layer15_routing&#45;&gt;gpu1_layer15_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1004.49,-864.32C1018.52,-851 1032.79,-837.44 1045.03,-825.81"/>
<polygon fill="black" stroke="black" points="1047.54,-828.26 1052.37,-818.83 1042.71,-823.18 1047.54,-828.26"/>
<text text-anchor="middle" x="1063.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu1_layer15_expert_agg -->
<g id="node518" class="node">
<title>gpu1_layer15_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1121.47,-729.54 920.29,-729.54 868.53,-625.54 1069.71,-625.54 1121.47,-729.54"/>
<text text-anchor="middle" x="995" y="-691.54" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="995" y="-680.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="995" y="-669.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="995" y="-658.54" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer15_routing&#45;&gt;gpu1_layer15_expert_agg -->
<g id="edge645" class="edge">
<title>gpu1_layer15_routing&#45;&gt;gpu1_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M1030.02,-904.14C1074.26,-888.13 1123.3,-861.57 1149,-818.54 1160.85,-798.7 1160.6,-786.53 1149,-766.54 1142.35,-755.08 1133.58,-744.98 1123.6,-736.12"/>
<polygon fill="black" stroke="black" points="1125.67,-733.29 1115.74,-729.58 1121.19,-738.67 1125.67,-733.29"/>
</g>
<!-- gpu1_layer15_expert0&#45;&gt;gpu1_layer15_expert_agg -->
<g id="edge641" class="edge">
<title>gpu1_layer15_expert0&#45;&gt;gpu1_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M720.05,-769.64C723.08,-768.58 726.07,-767.55 729,-766.54 785.18,-747.22 848.29,-726.3 898.94,-709.71"/>
<polygon fill="black" stroke="black" points="900.16,-713 908.57,-706.56 897.98,-706.35 900.16,-713"/>
</g>
<!-- gpu1_layer15_expert1&#45;&gt;gpu1_layer15_expert_agg -->
<g id="edge642" class="edge">
<title>gpu1_layer15_expert1&#45;&gt;gpu1_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M842.5,-766.46C861.9,-755.28 885.48,-741.68 908.24,-728.56"/>
<polygon fill="black" stroke="black" points="910,-731.59 916.91,-723.56 906.5,-725.52 910,-731.59"/>
</g>
<!-- gpu1_layer15_expert2&#45;&gt;gpu1_layer15_expert_agg -->
<g id="edge643" class="edge">
<title>gpu1_layer15_expert2&#45;&gt;gpu1_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M951.43,-766.46C955.48,-758.28 960.17,-748.81 964.95,-739.18"/>
<polygon fill="black" stroke="black" points="968.22,-740.45 969.53,-729.94 961.95,-737.35 968.22,-740.45"/>
</g>
<!-- gpu1_layer15_expert3&#45;&gt;gpu1_layer15_expert_agg -->
<g id="edge644" class="edge">
<title>gpu1_layer15_expert3&#45;&gt;gpu1_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M1060.36,-766.46C1054.03,-757.94 1046.66,-748.03 1039.2,-737.99"/>
<polygon fill="black" stroke="black" points="1041.98,-735.88 1033.21,-729.94 1036.37,-740.05 1041.98,-735.88"/>
</g>
<!-- gpu1_layer15_res2 -->
<g id="node519" class="node">
<title>gpu1_layer15_res2</title>
<polygon fill="lightblue" stroke="black" points="1344,-588.54 1222,-588.54 1222,-536.54 1344,-536.54 1344,-588.54"/>
<text text-anchor="middle" x="1283" y="-576.54" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="1283" y="-565.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1283" y="-554.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1283" y="-543.54" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer15_expert_agg&#45;&gt;gpu1_layer15_res2 -->
<g id="edge646" class="edge">
<title>gpu1_layer15_expert_agg&#45;&gt;gpu1_layer15_res2</title>
<path fill="none" stroke="black" d="M1079.08,-643.55C1121.35,-626.97 1172,-607.09 1212.25,-591.3"/>
<polygon fill="black" stroke="black" points="1213.69,-594.49 1221.72,-587.58 1211.13,-587.98 1213.69,-594.49"/>
</g>
<!-- gpu1_final_ln -->
<g id="node520" class="node">
<title>gpu1_final_ln</title>
<polygon fill="lightblue" stroke="black" points="1491,-499.54 1369,-499.54 1369,-447.54 1491,-447.54 1491,-499.54"/>
<text text-anchor="middle" x="1430" y="-487.54" font-family="Arial" font-size="10.00">Final LayerNorm</text>
<text text-anchor="middle" x="1430" y="-476.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1430" y="-465.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1430" y="-454.54" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_layer15_res2&#45;&gt;gpu1_final_ln -->
<g id="edge647" class="edge">
<title>gpu1_layer15_res2&#45;&gt;gpu1_final_ln</title>
<path fill="none" stroke="black" d="M1325.52,-536.38C1342.13,-526.55 1361.32,-515.19 1378.68,-504.91"/>
<polygon fill="black" stroke="black" points="1380.75,-507.75 1387.58,-499.65 1377.19,-501.73 1380.75,-507.75"/>
</g>
<!-- gpu1_output_proj -->
<g id="node521" class="node">
<title>gpu1_output_proj</title>
<polygon fill="lightblue" stroke="black" points="1535,-410.54 1407,-410.54 1407,-358.54 1535,-358.54 1535,-410.54"/>
<text text-anchor="middle" x="1471" y="-398.54" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="1471" y="-387.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1471" y="-376.54" font-family="Arial" font-size="10.00">Output: [256, 512, 32000]</text>
<text text-anchor="middle" x="1471" y="-365.54" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_final_ln&#45;&gt;gpu1_output_proj -->
<g id="edge648" class="edge">
<title>gpu1_final_ln&#45;&gt;gpu1_output_proj</title>
<path fill="none" stroke="black" d="M1441.86,-447.38C1445.9,-438.81 1450.48,-429.08 1454.8,-419.92"/>
<polygon fill="black" stroke="black" points="1458.07,-421.18 1459.17,-410.65 1451.74,-418.2 1458.07,-421.18"/>
</g>
<!-- gpu1_softmax -->
<g id="node522" class="node">
<title>gpu1_softmax</title>
<polygon fill="lightblue" stroke="black" points="1752,-321.54 1624,-321.54 1624,-269.54 1752,-269.54 1752,-321.54"/>
<text text-anchor="middle" x="1688" y="-309.54" font-family="Arial" font-size="10.00">Softmax</text>
<text text-anchor="middle" x="1688" y="-298.54" font-family="Arial" font-size="10.00">Input: [256, 512, 32000]</text>
<text text-anchor="middle" x="1688" y="-287.54" font-family="Arial" font-size="10.00">Output: [256, 512, 32000]</text>
<text text-anchor="middle" x="1688" y="-276.54" font-family="Arial" font-size="10.00">GPU: GPU1</text>
</g>
<!-- gpu1_output_proj&#45;&gt;gpu1_softmax -->
<g id="edge649" class="edge">
<title>gpu1_output_proj&#45;&gt;gpu1_softmax</title>
<path fill="none" stroke="black" d="M1533.47,-358.49C1559.35,-348.12 1589.51,-336.03 1616.28,-325.29"/>
<polygon fill="black" stroke="black" points="1617.61,-328.53 1625.59,-321.56 1615.01,-322.03 1617.61,-328.53"/>
</g>
<!-- gpu1_softmax&#45;&gt;dp_aggregate -->
<g id="edge2595" class="edge">
<title>gpu1_softmax&#45;&gt;dp_aggregate</title>
<path fill="none" stroke="black" d="M1752.12,-283.98C1804.75,-275.31 1881.21,-262.68 1948,-251.54 2061.59,-232.6 2190.59,-210.9 2284.67,-195.05"/>
<polygon fill="black" stroke="black" points="2285.53,-198.45 2294.81,-193.34 2284.37,-191.55 2285.53,-198.45"/>
<text text-anchor="middle" x="2026.5" y="-244.34" font-family="Arial" font-size="9.00">GPU 1 output</text>
</g>
<!-- gpu2_layer0_ln1 -->
<g id="node524" class="node">
<title>gpu2_layer0_ln1</title>
<polygon fill="lightblue" stroke="black" points="2162,-21516.16 2040,-21516.16 2040,-21464.16 2162,-21464.16 2162,-21516.16"/>
<text text-anchor="middle" x="2101" y="-21504.16" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2101" y="-21493.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2101" y="-21482.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2101" y="-21471.16" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_embed&#45;&gt;gpu2_layer0_ln1 -->
<g id="edge655" class="edge">
<title>gpu2_embed&#45;&gt;gpu2_layer0_ln1</title>
<path fill="none" stroke="black" d="M2108.11,-21553C2107.15,-21544.7 2106.08,-21535.32 2105.05,-21526.41"/>
<polygon fill="black" stroke="black" points="2108.51,-21525.81 2103.89,-21516.27 2101.55,-21526.61 2108.51,-21525.81"/>
</g>
<!-- gpu2_layer0_qkv -->
<g id="node525" class="node">
<title>gpu2_layer0_qkv</title>
<polygon fill="lightblue" stroke="black" points="2158,-21427.16 2036,-21427.16 2036,-21375.16 2158,-21375.16 2158,-21427.16"/>
<text text-anchor="middle" x="2097" y="-21415.16" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2097" y="-21404.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2097" y="-21393.16" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2097" y="-21382.16" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer0_ln1&#45;&gt;gpu2_layer0_qkv -->
<g id="edge656" class="edge">
<title>gpu2_layer0_ln1&#45;&gt;gpu2_layer0_qkv</title>
<path fill="none" stroke="black" d="M2099.84,-21464C2099.46,-21455.7 2099.03,-21446.32 2098.62,-21437.41"/>
<polygon fill="black" stroke="black" points="2102.11,-21437.1 2098.15,-21427.27 2095.12,-21437.42 2102.11,-21437.1"/>
</g>
<!-- gpu2_layer0_reshape -->
<g id="node526" class="node">
<title>gpu2_layer0_reshape</title>
<polygon fill="lightblue" stroke="black" points="2154,-21338.16 2026,-21338.16 2026,-21286.16 2154,-21286.16 2154,-21338.16"/>
<text text-anchor="middle" x="2090" y="-21326.16" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2090" y="-21315.16" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2090" y="-21304.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2090" y="-21293.16" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer0_qkv&#45;&gt;gpu2_layer0_reshape -->
<g id="edge657" class="edge">
<title>gpu2_layer0_qkv&#45;&gt;gpu2_layer0_reshape</title>
<path fill="none" stroke="black" d="M2094.98,-21375C2094.31,-21366.7 2093.55,-21357.32 2092.84,-21348.41"/>
<polygon fill="black" stroke="black" points="2096.31,-21347.96 2092.02,-21338.27 2089.33,-21348.52 2096.31,-21347.96"/>
</g>
<!-- gpu2_layer0_attn -->
<g id="node527" class="node">
<title>gpu2_layer0_attn</title>
<polygon fill="lightblue" stroke="black" points="2104,-21249.16 1976,-21249.16 1976,-21197.16 2104,-21197.16 2104,-21249.16"/>
<text text-anchor="middle" x="2040" y="-21237.16" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2040" y="-21226.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2040" y="-21215.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2040" y="-21204.16" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer0_reshape&#45;&gt;gpu2_layer0_attn -->
<g id="edge658" class="edge">
<title>gpu2_layer0_reshape&#45;&gt;gpu2_layer0_attn</title>
<path fill="none" stroke="black" d="M2075.54,-21286C2070.51,-21277.25 2064.79,-21267.3 2059.43,-21257.97"/>
<polygon fill="black" stroke="black" points="2062.45,-21256.2 2054.43,-21249.27 2056.38,-21259.69 2062.45,-21256.2"/>
</g>
<!-- gpu2_layer0_attn_reshape -->
<g id="node529" class="node">
<title>gpu2_layer0_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2058,-21160.16 1936,-21160.16 1936,-21108.16 2058,-21108.16 2058,-21160.16"/>
<text text-anchor="middle" x="1997" y="-21148.16" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="1997" y="-21137.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1997" y="-21126.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1997" y="-21115.16" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer0_attn&#45;&gt;gpu2_layer0_attn_reshape -->
<g id="edge659" class="edge">
<title>gpu2_layer0_attn&#45;&gt;gpu2_layer0_attn_reshape</title>
<path fill="none" stroke="black" d="M2027.56,-21197C2023.28,-21188.34 2018.42,-21178.5 2013.85,-21169.25"/>
<polygon fill="black" stroke="black" points="2016.98,-21167.69 2009.41,-21160.27 2010.7,-21170.79 2016.98,-21167.69"/>
</g>
<!-- gpu2_layer0_attn_out -->
<g id="node528" class="node">
<title>gpu2_layer0_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1973,-21071.16 1851,-21071.16 1851,-21019.16 1973,-21019.16 1973,-21071.16"/>
<text text-anchor="middle" x="1912" y="-21059.16" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="1912" y="-21048.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1912" y="-21037.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1912" y="-21026.16" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer0_kv_update -->
<g id="node530" class="node">
<title>gpu2_layer0_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="1741" cy="-20945.4" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="1741" y="-20959.4" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="1741" y="-20948.4" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1741" y="-20937.4" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1741" y="-20926.4" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer0_attn_out&#45;&gt;gpu2_layer0_kv_update -->
<g id="edge661" class="edge">
<title>gpu2_layer0_attn_out&#45;&gt;gpu2_layer0_kv_update</title>
<path fill="none" stroke="black" d="M1867.96,-21018.99C1847.35,-21007.2 1822.48,-20992.98 1800.25,-20980.27"/>
<polygon fill="black" stroke="black" points="1801.97,-20977.22 1791.55,-20975.3 1798.49,-20983.3 1801.97,-20977.22"/>
</g>
<!-- gpu2_layer0_attn_reshape&#45;&gt;gpu2_layer0_attn_out -->
<g id="edge660" class="edge">
<title>gpu2_layer0_attn_reshape&#45;&gt;gpu2_layer0_attn_out</title>
<path fill="none" stroke="black" d="M1972.41,-21108C1963.43,-21098.8 1953.13,-21088.27 1943.62,-21078.53"/>
<polygon fill="black" stroke="black" points="1946.02,-21075.98 1936.53,-21071.27 1941.02,-21080.87 1946.02,-21075.98"/>
</g>
<!-- gpu2_layer0_res1 -->
<g id="node531" class="node">
<title>gpu2_layer0_res1</title>
<polygon fill="lightblue" stroke="black" points="1764,-20871.63 1642,-20871.63 1642,-20819.63 1764,-20819.63 1764,-20871.63"/>
<text text-anchor="middle" x="1703" y="-20859.63" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="1703" y="-20848.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1703" y="-20837.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1703" y="-20826.63" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer0_kv_update&#45;&gt;gpu2_layer0_res1 -->
<g id="edge662" class="edge">
<title>gpu2_layer0_kv_update&#45;&gt;gpu2_layer0_res1</title>
<path fill="none" stroke="black" d="M1727.17,-20908.82C1723.68,-20899.84 1719.94,-20890.21 1716.47,-20881.27"/>
<polygon fill="black" stroke="black" points="1719.71,-20879.97 1712.83,-20871.92 1713.19,-20882.5 1719.71,-20879.97"/>
</g>
<!-- gpu2_layer0_ln2 -->
<g id="node532" class="node">
<title>gpu2_layer0_ln2</title>
<polygon fill="lightblue" stroke="black" points="1707,-20782.63 1585,-20782.63 1585,-20730.63 1707,-20730.63 1707,-20782.63"/>
<text text-anchor="middle" x="1646" y="-20770.63" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="1646" y="-20759.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1646" y="-20748.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1646" y="-20737.63" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer0_res1&#45;&gt;gpu2_layer0_ln2 -->
<g id="edge663" class="edge">
<title>gpu2_layer0_res1&#45;&gt;gpu2_layer0_ln2</title>
<path fill="none" stroke="black" d="M1686.51,-20819.46C1680.72,-20810.62 1674.12,-20800.55 1667.96,-20791.14"/>
<polygon fill="black" stroke="black" points="1670.86,-20789.18 1662.45,-20782.73 1665,-20793.02 1670.86,-20789.18"/>
</g>
<!-- gpu2_layer0_routing -->
<g id="node533" class="node">
<title>gpu2_layer0_routing</title>
<polygon fill="lightyellow" stroke="black" points="1691.47,-20693.63 1490.29,-20693.63 1438.53,-20567.63 1639.71,-20567.63 1691.47,-20693.63"/>
<text text-anchor="middle" x="1565" y="-20650.13" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="1565" y="-20639.13" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1565" y="-20628.13" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1565" y="-20617.13" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="1565" y="-20606.13" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer0_ln2&#45;&gt;gpu2_layer0_routing -->
<g id="edge664" class="edge">
<title>gpu2_layer0_ln2&#45;&gt;gpu2_layer0_routing</title>
<path fill="none" stroke="black" d="M1629.61,-20730.53C1624.16,-20722.18 1617.78,-20712.43 1611.21,-20702.37"/>
<polygon fill="black" stroke="black" points="1614.05,-20700.32 1605.65,-20693.86 1608.19,-20704.15 1614.05,-20700.32"/>
</g>
<!-- gpu2_layer0_expert0 -->
<g id="node534" class="node">
<title>gpu2_layer0_expert0</title>
<polygon fill="lightblue" stroke="black" points="1318,-20521.63 1196,-20521.63 1196,-20469.63 1318,-20469.63 1318,-20521.63"/>
<text text-anchor="middle" x="1257" y="-20509.63" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1257" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer0_routing&#45;&gt;gpu2_layer0_expert0 -->
<g id="edge651" class="edge">
<title>gpu2_layer0_routing&#45;&gt;gpu2_layer0_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1441.94,-20576.49C1401.97,-20559.23 1359.09,-20540.71 1324.7,-20525.86"/>
<polygon fill="black" stroke="black" points="1325.8,-20522.52 1315.23,-20521.77 1323.02,-20528.95 1325.8,-20522.52"/>
<text text-anchor="middle" x="1404.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer0_expert1 -->
<g id="node535" class="node">
<title>gpu2_layer0_expert1</title>
<polygon fill="lightblue" stroke="black" points="1458,-20521.63 1336,-20521.63 1336,-20469.63 1458,-20469.63 1458,-20521.63"/>
<text text-anchor="middle" x="1397" y="-20509.63" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1397" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer0_routing&#45;&gt;gpu2_layer0_expert1 -->
<g id="edge652" class="edge">
<title>gpu2_layer0_routing&#45;&gt;gpu2_layer0_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1486.41,-20567.41C1469.26,-20553.83 1451.81,-20540.02 1436.93,-20528.24"/>
<polygon fill="black" stroke="black" points="1438.96,-20525.38 1428.95,-20521.92 1434.62,-20530.87 1438.96,-20525.38"/>
<text text-anchor="middle" x="1491.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer0_expert2 -->
<g id="node536" class="node">
<title>gpu2_layer0_expert2</title>
<polygon fill="lightblue" stroke="black" points="1598,-20521.63 1476,-20521.63 1476,-20469.63 1598,-20469.63 1598,-20521.63"/>
<text text-anchor="middle" x="1537" y="-20509.63" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="1537" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer0_routing&#45;&gt;gpu2_layer0_expert2 -->
<g id="edge653" class="edge">
<title>gpu2_layer0_routing&#45;&gt;gpu2_layer0_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1551.9,-20567.41C1549.33,-20555.22 1546.73,-20542.83 1544.43,-20531.9"/>
<polygon fill="black" stroke="black" points="1547.81,-20530.98 1542.33,-20521.92 1540.96,-20532.43 1547.81,-20530.98"/>
<text text-anchor="middle" x="1577.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer0_expert3 -->
<g id="node537" class="node">
<title>gpu2_layer0_expert3</title>
<polygon fill="lightblue" stroke="black" points="1738,-20521.63 1616,-20521.63 1616,-20469.63 1738,-20469.63 1738,-20521.63"/>
<text text-anchor="middle" x="1677" y="-20509.63" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1677" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer0_routing&#45;&gt;gpu2_layer0_expert3 -->
<g id="edge654" class="edge">
<title>gpu2_layer0_routing&#45;&gt;gpu2_layer0_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1617.39,-20567.41C1628.3,-20554.46 1639.38,-20541.3 1648.99,-20529.89"/>
<polygon fill="black" stroke="black" points="1651.94,-20531.82 1655.7,-20521.92 1646.58,-20527.31 1651.94,-20531.82"/>
<text text-anchor="middle" x="1670.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer0_expert_agg -->
<g id="node538" class="node">
<title>gpu2_layer0_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-20432.63 1462.29,-20432.63 1410.53,-20328.63 1611.71,-20328.63 1663.47,-20432.63"/>
<text text-anchor="middle" x="1537" y="-20394.63" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="1537" y="-20383.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-20372.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-20361.63" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer0_routing&#45;&gt;gpu2_layer0_expert_agg -->
<g id="edge669" class="edge">
<title>gpu2_layer0_routing&#45;&gt;gpu2_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M1651.69,-20596.64C1714.14,-20567.61 1781.78,-20521.91 1747,-20469.63 1726.44,-20438.71 1692.7,-20418.64 1658.22,-20405.61"/>
<polygon fill="black" stroke="black" points="1659.08,-20402.2 1648.48,-20402.12 1656.71,-20408.79 1659.08,-20402.2"/>
</g>
<!-- gpu2_layer0_expert0&#45;&gt;gpu2_layer0_expert_agg -->
<g id="edge665" class="edge">
<title>gpu2_layer0_expert0&#45;&gt;gpu2_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M1318.1,-20469.97C1354.98,-20455.08 1402.7,-20435.83 1444.16,-20419.09"/>
<polygon fill="black" stroke="black" points="1445.5,-20422.33 1453.46,-20415.34 1442.88,-20415.84 1445.5,-20422.33"/>
</g>
<!-- gpu2_layer0_expert1&#45;&gt;gpu2_layer0_expert_agg -->
<g id="edge666" class="edge">
<title>gpu2_layer0_expert1&#45;&gt;gpu2_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M1428.07,-20469.55C1439.32,-20460.47 1452.53,-20449.81 1465.8,-20439.1"/>
<polygon fill="black" stroke="black" points="1468.02,-20441.8 1473.6,-20432.8 1463.62,-20436.35 1468.02,-20441.8"/>
</g>
<!-- gpu2_layer0_expert2&#45;&gt;gpu2_layer0_expert_agg -->
<g id="edge667" class="edge">
<title>gpu2_layer0_expert2&#45;&gt;gpu2_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M1537,-20469.55C1537,-20461.62 1537,-20452.48 1537,-20443.16"/>
<polygon fill="black" stroke="black" points="1540.5,-20443.03 1537,-20433.03 1533.5,-20443.03 1540.5,-20443.03"/>
</g>
<!-- gpu2_layer0_expert3&#45;&gt;gpu2_layer0_expert_agg -->
<g id="edge668" class="edge">
<title>gpu2_layer0_expert3&#45;&gt;gpu2_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M1645.93,-20469.55C1634.68,-20460.47 1621.47,-20449.81 1608.2,-20439.1"/>
<polygon fill="black" stroke="black" points="1610.38,-20436.35 1600.4,-20432.8 1605.98,-20441.8 1610.38,-20436.35"/>
</g>
<!-- gpu2_layer0_res2 -->
<g id="node539" class="node">
<title>gpu2_layer0_res2</title>
<polygon fill="lightblue" stroke="black" points="1598,-20291.63 1476,-20291.63 1476,-20239.63 1598,-20239.63 1598,-20291.63"/>
<text text-anchor="middle" x="1537" y="-20279.63" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="1537" y="-20268.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-20257.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-20246.63" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer0_expert_agg&#45;&gt;gpu2_layer0_res2 -->
<g id="edge670" class="edge">
<title>gpu2_layer0_expert_agg&#45;&gt;gpu2_layer0_res2</title>
<path fill="none" stroke="black" d="M1537,-20328.42C1537,-20319.46 1537,-20310.34 1537,-20301.94"/>
<polygon fill="black" stroke="black" points="1540.5,-20301.76 1537,-20291.76 1533.5,-20301.76 1540.5,-20301.76"/>
</g>
<!-- gpu2_layer1_ln1 -->
<g id="node540" class="node">
<title>gpu2_layer1_ln1</title>
<polygon fill="lightblue" stroke="black" points="1598,-20202.63 1476,-20202.63 1476,-20150.63 1598,-20150.63 1598,-20202.63"/>
<text text-anchor="middle" x="1537" y="-20190.63" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="1537" y="-20179.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-20168.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-20157.63" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer0_res2&#45;&gt;gpu2_layer1_ln1 -->
<g id="edge675" class="edge">
<title>gpu2_layer0_res2&#45;&gt;gpu2_layer1_ln1</title>
<path fill="none" stroke="black" d="M1537,-20239.46C1537,-20231.17 1537,-20221.78 1537,-20212.87"/>
<polygon fill="black" stroke="black" points="1540.5,-20212.73 1537,-20202.73 1533.5,-20212.73 1540.5,-20212.73"/>
</g>
<!-- gpu2_layer1_qkv -->
<g id="node541" class="node">
<title>gpu2_layer1_qkv</title>
<polygon fill="lightblue" stroke="black" points="1598,-20113.63 1476,-20113.63 1476,-20061.63 1598,-20061.63 1598,-20113.63"/>
<text text-anchor="middle" x="1537" y="-20101.63" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1537" y="-20090.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-20079.63" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-20068.63" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer1_ln1&#45;&gt;gpu2_layer1_qkv -->
<g id="edge676" class="edge">
<title>gpu2_layer1_ln1&#45;&gt;gpu2_layer1_qkv</title>
<path fill="none" stroke="black" d="M1537,-20150.46C1537,-20142.17 1537,-20132.78 1537,-20123.87"/>
<polygon fill="black" stroke="black" points="1540.5,-20123.73 1537,-20113.73 1533.5,-20123.73 1540.5,-20123.73"/>
</g>
<!-- gpu2_layer1_reshape -->
<g id="node542" class="node">
<title>gpu2_layer1_reshape</title>
<polygon fill="lightblue" stroke="black" points="1601,-20024.63 1473,-20024.63 1473,-19972.63 1601,-19972.63 1601,-20024.63"/>
<text text-anchor="middle" x="1537" y="-20012.63" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="1537" y="-20001.63" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-19990.63" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-19979.63" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer1_qkv&#45;&gt;gpu2_layer1_reshape -->
<g id="edge677" class="edge">
<title>gpu2_layer1_qkv&#45;&gt;gpu2_layer1_reshape</title>
<path fill="none" stroke="black" d="M1537,-20061.46C1537,-20053.17 1537,-20043.78 1537,-20034.87"/>
<polygon fill="black" stroke="black" points="1540.5,-20034.73 1537,-20024.73 1533.5,-20034.73 1540.5,-20034.73"/>
</g>
<!-- gpu2_layer1_attn -->
<g id="node543" class="node">
<title>gpu2_layer1_attn</title>
<polygon fill="lightblue" stroke="black" points="1601,-19935.63 1473,-19935.63 1473,-19883.63 1601,-19883.63 1601,-19935.63"/>
<text text-anchor="middle" x="1537" y="-19923.63" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1537" y="-19912.63" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-19901.63" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-19890.63" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer1_reshape&#45;&gt;gpu2_layer1_attn -->
<g id="edge678" class="edge">
<title>gpu2_layer1_reshape&#45;&gt;gpu2_layer1_attn</title>
<path fill="none" stroke="black" d="M1537,-19972.46C1537,-19964.17 1537,-19954.78 1537,-19945.87"/>
<polygon fill="black" stroke="black" points="1540.5,-19945.73 1537,-19935.73 1533.5,-19945.73 1540.5,-19945.73"/>
</g>
<!-- gpu2_layer1_attn_reshape -->
<g id="node545" class="node">
<title>gpu2_layer1_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1598,-19846.63 1476,-19846.63 1476,-19794.63 1598,-19794.63 1598,-19846.63"/>
<text text-anchor="middle" x="1537" y="-19834.63" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="1537" y="-19823.63" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-19812.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-19801.63" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer1_attn&#45;&gt;gpu2_layer1_attn_reshape -->
<g id="edge679" class="edge">
<title>gpu2_layer1_attn&#45;&gt;gpu2_layer1_attn_reshape</title>
<path fill="none" stroke="black" d="M1537,-19883.46C1537,-19875.17 1537,-19865.78 1537,-19856.87"/>
<polygon fill="black" stroke="black" points="1540.5,-19856.73 1537,-19846.73 1533.5,-19856.73 1540.5,-19856.73"/>
</g>
<!-- gpu2_layer1_attn_out -->
<g id="node544" class="node">
<title>gpu2_layer1_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1598,-19757.63 1476,-19757.63 1476,-19705.63 1598,-19705.63 1598,-19757.63"/>
<text text-anchor="middle" x="1537" y="-19745.63" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="1537" y="-19734.63" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-19723.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-19712.63" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer1_kv_update -->
<g id="node546" class="node">
<title>gpu2_layer1_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="1537" cy="-19631.86" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="1537" y="-19645.86" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="1537" y="-19634.86" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-19623.86" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-19612.86" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer1_attn_out&#45;&gt;gpu2_layer1_kv_update -->
<g id="edge681" class="edge">
<title>gpu2_layer1_attn_out&#45;&gt;gpu2_layer1_kv_update</title>
<path fill="none" stroke="black" d="M1537,-19705.45C1537,-19697.31 1537,-19688.01 1537,-19678.85"/>
<polygon fill="black" stroke="black" points="1540.5,-19678.64 1537,-19668.64 1533.5,-19678.64 1540.5,-19678.64"/>
</g>
<!-- gpu2_layer1_attn_reshape&#45;&gt;gpu2_layer1_attn_out -->
<g id="edge680" class="edge">
<title>gpu2_layer1_attn_reshape&#45;&gt;gpu2_layer1_attn_out</title>
<path fill="none" stroke="black" d="M1537,-19794.46C1537,-19786.17 1537,-19776.78 1537,-19767.87"/>
<polygon fill="black" stroke="black" points="1540.5,-19767.73 1537,-19757.73 1533.5,-19767.73 1540.5,-19767.73"/>
</g>
<!-- gpu2_layer1_res1 -->
<g id="node547" class="node">
<title>gpu2_layer1_res1</title>
<polygon fill="lightblue" stroke="black" points="1598,-19558.09 1476,-19558.09 1476,-19506.09 1598,-19506.09 1598,-19558.09"/>
<text text-anchor="middle" x="1537" y="-19546.09" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="1537" y="-19535.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-19524.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-19513.09" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer1_kv_update&#45;&gt;gpu2_layer1_res1 -->
<g id="edge682" class="edge">
<title>gpu2_layer1_kv_update&#45;&gt;gpu2_layer1_res1</title>
<path fill="none" stroke="black" d="M1537,-19595.01C1537,-19586.33 1537,-19577.06 1537,-19568.4"/>
<polygon fill="black" stroke="black" points="1540.5,-19568.23 1537,-19558.23 1533.5,-19568.23 1540.5,-19568.23"/>
</g>
<!-- gpu2_layer1_ln2 -->
<g id="node548" class="node">
<title>gpu2_layer1_ln2</title>
<polygon fill="lightblue" stroke="black" points="1598,-19469.09 1476,-19469.09 1476,-19417.09 1598,-19417.09 1598,-19469.09"/>
<text text-anchor="middle" x="1537" y="-19457.09" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="1537" y="-19446.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-19435.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-19424.09" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer1_res1&#45;&gt;gpu2_layer1_ln2 -->
<g id="edge683" class="edge">
<title>gpu2_layer1_res1&#45;&gt;gpu2_layer1_ln2</title>
<path fill="none" stroke="black" d="M1537,-19505.92C1537,-19497.63 1537,-19488.24 1537,-19479.34"/>
<polygon fill="black" stroke="black" points="1540.5,-19479.19 1537,-19469.19 1533.5,-19479.19 1540.5,-19479.19"/>
</g>
<!-- gpu2_layer1_routing -->
<g id="node549" class="node">
<title>gpu2_layer1_routing</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-19380.09 1462.29,-19380.09 1410.53,-19254.09 1611.71,-19254.09 1663.47,-19380.09"/>
<text text-anchor="middle" x="1537" y="-19336.59" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="1537" y="-19325.59" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-19314.59" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-19303.59" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="1537" y="-19292.59" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer1_ln2&#45;&gt;gpu2_layer1_routing -->
<g id="edge684" class="edge">
<title>gpu2_layer1_ln2&#45;&gt;gpu2_layer1_routing</title>
<path fill="none" stroke="black" d="M1537,-19416.99C1537,-19409.06 1537,-19399.86 1537,-19390.33"/>
<polygon fill="black" stroke="black" points="1540.5,-19390.32 1537,-19380.32 1533.5,-19390.32 1540.5,-19390.32"/>
</g>
<!-- gpu2_layer1_expert0 -->
<g id="node550" class="node">
<title>gpu2_layer1_expert0</title>
<polygon fill="lightblue" stroke="black" points="1318,-19208.09 1196,-19208.09 1196,-19156.09 1318,-19156.09 1318,-19208.09"/>
<text text-anchor="middle" x="1257" y="-19196.09" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1257" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer1_routing&#45;&gt;gpu2_layer1_expert0 -->
<g id="edge671" class="edge">
<title>gpu2_layer1_routing&#45;&gt;gpu2_layer1_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1411.33,-19256.39C1379.34,-19241.2 1346.34,-19225.52 1319.11,-19212.59"/>
<polygon fill="black" stroke="black" points="1320.26,-19209.26 1309.73,-19208.13 1317.26,-19215.58 1320.26,-19209.26"/>
<text text-anchor="middle" x="1393.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer1_expert1 -->
<g id="node551" class="node">
<title>gpu2_layer1_expert1</title>
<polygon fill="lightblue" stroke="black" points="1458,-19208.09 1336,-19208.09 1336,-19156.09 1458,-19156.09 1458,-19208.09"/>
<text text-anchor="middle" x="1397" y="-19196.09" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1397" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer1_routing&#45;&gt;gpu2_layer1_expert1 -->
<g id="edge672" class="edge">
<title>gpu2_layer1_routing&#45;&gt;gpu2_layer1_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1471.51,-19253.87C1457.48,-19240.55 1443.21,-19226.99 1430.97,-19215.36"/>
<polygon fill="black" stroke="black" points="1433.29,-19212.73 1423.63,-19208.38 1428.46,-19217.81 1433.29,-19212.73"/>
<text text-anchor="middle" x="1480.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer1_expert2 -->
<g id="node552" class="node">
<title>gpu2_layer1_expert2</title>
<polygon fill="lightblue" stroke="black" points="1598,-19208.09 1476,-19208.09 1476,-19156.09 1598,-19156.09 1598,-19208.09"/>
<text text-anchor="middle" x="1537" y="-19196.09" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="1537" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer1_routing&#45;&gt;gpu2_layer1_expert2 -->
<g id="edge673" class="edge">
<title>gpu2_layer1_routing&#45;&gt;gpu2_layer1_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1537,-19253.87C1537,-19241.8 1537,-19229.55 1537,-19218.7"/>
<polygon fill="black" stroke="black" points="1540.5,-19218.38 1537,-19208.38 1533.5,-19218.38 1540.5,-19218.38"/>
<text text-anchor="middle" x="1566.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer1_expert3 -->
<g id="node553" class="node">
<title>gpu2_layer1_expert3</title>
<polygon fill="lightblue" stroke="black" points="1738,-19208.09 1616,-19208.09 1616,-19156.09 1738,-19156.09 1738,-19208.09"/>
<text text-anchor="middle" x="1677" y="-19196.09" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1677" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer1_routing&#45;&gt;gpu2_layer1_expert3 -->
<g id="edge674" class="edge">
<title>gpu2_layer1_routing&#45;&gt;gpu2_layer1_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1602.49,-19253.87C1616.52,-19240.55 1630.79,-19226.99 1643.03,-19215.36"/>
<polygon fill="black" stroke="black" points="1645.54,-19217.81 1650.37,-19208.38 1640.71,-19212.73 1645.54,-19217.81"/>
<text text-anchor="middle" x="1661.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer1_expert_agg -->
<g id="node554" class="node">
<title>gpu2_layer1_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-19119.09 1462.29,-19119.09 1410.53,-19015.09 1611.71,-19015.09 1663.47,-19119.09"/>
<text text-anchor="middle" x="1537" y="-19081.09" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="1537" y="-19070.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-19059.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-19048.09" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer1_routing&#45;&gt;gpu2_layer1_expert_agg -->
<g id="edge689" class="edge">
<title>gpu2_layer1_routing&#45;&gt;gpu2_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M1626.22,-19289.17C1699.96,-19262.01 1786.6,-19215.62 1747,-19156.09 1726.44,-19125.17 1692.7,-19105.1 1658.22,-19092.07"/>
<polygon fill="black" stroke="black" points="1659.08,-19088.66 1648.48,-19088.58 1656.71,-19095.25 1659.08,-19088.66"/>
</g>
<!-- gpu2_layer1_expert0&#45;&gt;gpu2_layer1_expert_agg -->
<g id="edge685" class="edge">
<title>gpu2_layer1_expert0&#45;&gt;gpu2_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M1318.1,-19156.43C1354.98,-19141.55 1402.7,-19122.29 1444.16,-19105.55"/>
<polygon fill="black" stroke="black" points="1445.5,-19108.79 1453.46,-19101.8 1442.88,-19102.3 1445.5,-19108.79"/>
</g>
<!-- gpu2_layer1_expert1&#45;&gt;gpu2_layer1_expert_agg -->
<g id="edge686" class="edge">
<title>gpu2_layer1_expert1&#45;&gt;gpu2_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M1428.07,-19156.01C1439.32,-19146.93 1452.53,-19136.27 1465.8,-19125.56"/>
<polygon fill="black" stroke="black" points="1468.02,-19128.26 1473.6,-19119.26 1463.62,-19122.82 1468.02,-19128.26"/>
</g>
<!-- gpu2_layer1_expert2&#45;&gt;gpu2_layer1_expert_agg -->
<g id="edge687" class="edge">
<title>gpu2_layer1_expert2&#45;&gt;gpu2_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M1537,-19156.01C1537,-19148.08 1537,-19138.95 1537,-19129.62"/>
<polygon fill="black" stroke="black" points="1540.5,-19129.49 1537,-19119.49 1533.5,-19129.49 1540.5,-19129.49"/>
</g>
<!-- gpu2_layer1_expert3&#45;&gt;gpu2_layer1_expert_agg -->
<g id="edge688" class="edge">
<title>gpu2_layer1_expert3&#45;&gt;gpu2_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M1645.93,-19156.01C1634.68,-19146.93 1621.47,-19136.27 1608.2,-19125.56"/>
<polygon fill="black" stroke="black" points="1610.38,-19122.82 1600.4,-19119.26 1605.98,-19128.26 1610.38,-19122.82"/>
</g>
<!-- gpu2_layer1_res2 -->
<g id="node555" class="node">
<title>gpu2_layer1_res2</title>
<polygon fill="lightblue" stroke="black" points="1598,-18978.09 1476,-18978.09 1476,-18926.09 1598,-18926.09 1598,-18978.09"/>
<text text-anchor="middle" x="1537" y="-18966.09" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="1537" y="-18955.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-18944.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-18933.09" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer1_expert_agg&#45;&gt;gpu2_layer1_res2 -->
<g id="edge690" class="edge">
<title>gpu2_layer1_expert_agg&#45;&gt;gpu2_layer1_res2</title>
<path fill="none" stroke="black" d="M1537,-19014.88C1537,-19005.93 1537,-18996.8 1537,-18988.4"/>
<polygon fill="black" stroke="black" points="1540.5,-18988.22 1537,-18978.22 1533.5,-18988.22 1540.5,-18988.22"/>
</g>
<!-- gpu2_layer2_ln1 -->
<g id="node556" class="node">
<title>gpu2_layer2_ln1</title>
<polygon fill="lightblue" stroke="black" points="1598,-18889.09 1476,-18889.09 1476,-18837.09 1598,-18837.09 1598,-18889.09"/>
<text text-anchor="middle" x="1537" y="-18877.09" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="1537" y="-18866.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-18855.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-18844.09" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer1_res2&#45;&gt;gpu2_layer2_ln1 -->
<g id="edge695" class="edge">
<title>gpu2_layer1_res2&#45;&gt;gpu2_layer2_ln1</title>
<path fill="none" stroke="black" d="M1537,-18925.92C1537,-18917.63 1537,-18908.24 1537,-18899.34"/>
<polygon fill="black" stroke="black" points="1540.5,-18899.19 1537,-18889.19 1533.5,-18899.19 1540.5,-18899.19"/>
</g>
<!-- gpu2_layer2_qkv -->
<g id="node557" class="node">
<title>gpu2_layer2_qkv</title>
<polygon fill="lightblue" stroke="black" points="1598,-18800.09 1476,-18800.09 1476,-18748.09 1598,-18748.09 1598,-18800.09"/>
<text text-anchor="middle" x="1537" y="-18788.09" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1537" y="-18777.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-18766.09" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-18755.09" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer2_ln1&#45;&gt;gpu2_layer2_qkv -->
<g id="edge696" class="edge">
<title>gpu2_layer2_ln1&#45;&gt;gpu2_layer2_qkv</title>
<path fill="none" stroke="black" d="M1537,-18836.92C1537,-18828.63 1537,-18819.24 1537,-18810.34"/>
<polygon fill="black" stroke="black" points="1540.5,-18810.19 1537,-18800.19 1533.5,-18810.19 1540.5,-18810.19"/>
</g>
<!-- gpu2_layer2_reshape -->
<g id="node558" class="node">
<title>gpu2_layer2_reshape</title>
<polygon fill="lightblue" stroke="black" points="1601,-18711.09 1473,-18711.09 1473,-18659.09 1601,-18659.09 1601,-18711.09"/>
<text text-anchor="middle" x="1537" y="-18699.09" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="1537" y="-18688.09" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-18677.09" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-18666.09" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer2_qkv&#45;&gt;gpu2_layer2_reshape -->
<g id="edge697" class="edge">
<title>gpu2_layer2_qkv&#45;&gt;gpu2_layer2_reshape</title>
<path fill="none" stroke="black" d="M1537,-18747.92C1537,-18739.63 1537,-18730.24 1537,-18721.34"/>
<polygon fill="black" stroke="black" points="1540.5,-18721.19 1537,-18711.19 1533.5,-18721.19 1540.5,-18721.19"/>
</g>
<!-- gpu2_layer2_attn -->
<g id="node559" class="node">
<title>gpu2_layer2_attn</title>
<polygon fill="lightblue" stroke="black" points="1601,-18622.09 1473,-18622.09 1473,-18570.09 1601,-18570.09 1601,-18622.09"/>
<text text-anchor="middle" x="1537" y="-18610.09" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1537" y="-18599.09" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-18588.09" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-18577.09" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer2_reshape&#45;&gt;gpu2_layer2_attn -->
<g id="edge698" class="edge">
<title>gpu2_layer2_reshape&#45;&gt;gpu2_layer2_attn</title>
<path fill="none" stroke="black" d="M1537,-18658.92C1537,-18650.63 1537,-18641.24 1537,-18632.34"/>
<polygon fill="black" stroke="black" points="1540.5,-18632.19 1537,-18622.19 1533.5,-18632.19 1540.5,-18632.19"/>
</g>
<!-- gpu2_layer2_attn_reshape -->
<g id="node561" class="node">
<title>gpu2_layer2_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1598,-18533.09 1476,-18533.09 1476,-18481.09 1598,-18481.09 1598,-18533.09"/>
<text text-anchor="middle" x="1537" y="-18521.09" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="1537" y="-18510.09" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-18499.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-18488.09" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer2_attn&#45;&gt;gpu2_layer2_attn_reshape -->
<g id="edge699" class="edge">
<title>gpu2_layer2_attn&#45;&gt;gpu2_layer2_attn_reshape</title>
<path fill="none" stroke="black" d="M1537,-18569.92C1537,-18561.63 1537,-18552.24 1537,-18543.34"/>
<polygon fill="black" stroke="black" points="1540.5,-18543.19 1537,-18533.19 1533.5,-18543.19 1540.5,-18543.19"/>
</g>
<!-- gpu2_layer2_attn_out -->
<g id="node560" class="node">
<title>gpu2_layer2_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1598,-18444.09 1476,-18444.09 1476,-18392.09 1598,-18392.09 1598,-18444.09"/>
<text text-anchor="middle" x="1537" y="-18432.09" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="1537" y="-18421.09" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-18410.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-18399.09" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer2_kv_update -->
<g id="node562" class="node">
<title>gpu2_layer2_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="1537" cy="-18318.32" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="1537" y="-18332.32" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="1537" y="-18321.32" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-18310.32" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-18299.32" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer2_attn_out&#45;&gt;gpu2_layer2_kv_update -->
<g id="edge701" class="edge">
<title>gpu2_layer2_attn_out&#45;&gt;gpu2_layer2_kv_update</title>
<path fill="none" stroke="black" d="M1537,-18391.91C1537,-18383.77 1537,-18374.47 1537,-18365.31"/>
<polygon fill="black" stroke="black" points="1540.5,-18365.1 1537,-18355.1 1533.5,-18365.1 1540.5,-18365.1"/>
</g>
<!-- gpu2_layer2_attn_reshape&#45;&gt;gpu2_layer2_attn_out -->
<g id="edge700" class="edge">
<title>gpu2_layer2_attn_reshape&#45;&gt;gpu2_layer2_attn_out</title>
<path fill="none" stroke="black" d="M1537,-18480.92C1537,-18472.63 1537,-18463.24 1537,-18454.34"/>
<polygon fill="black" stroke="black" points="1540.5,-18454.19 1537,-18444.19 1533.5,-18454.19 1540.5,-18454.19"/>
</g>
<!-- gpu2_layer2_res1 -->
<g id="node563" class="node">
<title>gpu2_layer2_res1</title>
<polygon fill="lightblue" stroke="black" points="1598,-18244.55 1476,-18244.55 1476,-18192.55 1598,-18192.55 1598,-18244.55"/>
<text text-anchor="middle" x="1537" y="-18232.55" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="1537" y="-18221.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-18210.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-18199.55" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer2_kv_update&#45;&gt;gpu2_layer2_res1 -->
<g id="edge702" class="edge">
<title>gpu2_layer2_kv_update&#45;&gt;gpu2_layer2_res1</title>
<path fill="none" stroke="black" d="M1537,-18281.47C1537,-18272.79 1537,-18263.52 1537,-18254.86"/>
<polygon fill="black" stroke="black" points="1540.5,-18254.69 1537,-18244.69 1533.5,-18254.69 1540.5,-18254.69"/>
</g>
<!-- gpu2_layer2_ln2 -->
<g id="node564" class="node">
<title>gpu2_layer2_ln2</title>
<polygon fill="lightblue" stroke="black" points="1598,-18155.55 1476,-18155.55 1476,-18103.55 1598,-18103.55 1598,-18155.55"/>
<text text-anchor="middle" x="1537" y="-18143.55" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="1537" y="-18132.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-18121.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-18110.55" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer2_res1&#45;&gt;gpu2_layer2_ln2 -->
<g id="edge703" class="edge">
<title>gpu2_layer2_res1&#45;&gt;gpu2_layer2_ln2</title>
<path fill="none" stroke="black" d="M1537,-18192.38C1537,-18184.09 1537,-18174.7 1537,-18165.8"/>
<polygon fill="black" stroke="black" points="1540.5,-18165.65 1537,-18155.65 1533.5,-18165.65 1540.5,-18165.65"/>
</g>
<!-- gpu2_layer2_routing -->
<g id="node565" class="node">
<title>gpu2_layer2_routing</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-18066.55 1462.29,-18066.55 1410.53,-17940.55 1611.71,-17940.55 1663.47,-18066.55"/>
<text text-anchor="middle" x="1537" y="-18023.05" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="1537" y="-18012.05" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-18001.05" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-17990.05" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="1537" y="-17979.05" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer2_ln2&#45;&gt;gpu2_layer2_routing -->
<g id="edge704" class="edge">
<title>gpu2_layer2_ln2&#45;&gt;gpu2_layer2_routing</title>
<path fill="none" stroke="black" d="M1537,-18103.45C1537,-18095.52 1537,-18086.33 1537,-18076.8"/>
<polygon fill="black" stroke="black" points="1540.5,-18076.78 1537,-18066.78 1533.5,-18076.78 1540.5,-18076.78"/>
</g>
<!-- gpu2_layer2_expert0 -->
<g id="node566" class="node">
<title>gpu2_layer2_expert0</title>
<polygon fill="lightblue" stroke="black" points="1318,-17894.55 1196,-17894.55 1196,-17842.55 1318,-17842.55 1318,-17894.55"/>
<text text-anchor="middle" x="1257" y="-17882.55" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1257" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer2_routing&#45;&gt;gpu2_layer2_expert0 -->
<g id="edge691" class="edge">
<title>gpu2_layer2_routing&#45;&gt;gpu2_layer2_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1411.33,-17942.86C1379.34,-17927.66 1346.34,-17911.98 1319.11,-17899.05"/>
<polygon fill="black" stroke="black" points="1320.26,-17895.72 1309.73,-17894.59 1317.26,-17902.04 1320.26,-17895.72"/>
<text text-anchor="middle" x="1393.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer2_expert1 -->
<g id="node567" class="node">
<title>gpu2_layer2_expert1</title>
<polygon fill="lightblue" stroke="black" points="1458,-17894.55 1336,-17894.55 1336,-17842.55 1458,-17842.55 1458,-17894.55"/>
<text text-anchor="middle" x="1397" y="-17882.55" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1397" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer2_routing&#45;&gt;gpu2_layer2_expert1 -->
<g id="edge692" class="edge">
<title>gpu2_layer2_routing&#45;&gt;gpu2_layer2_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1471.51,-17940.33C1457.48,-17927.01 1443.21,-17913.45 1430.97,-17901.82"/>
<polygon fill="black" stroke="black" points="1433.29,-17899.19 1423.63,-17894.84 1428.46,-17904.27 1433.29,-17899.19"/>
<text text-anchor="middle" x="1480.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer2_expert2 -->
<g id="node568" class="node">
<title>gpu2_layer2_expert2</title>
<polygon fill="lightblue" stroke="black" points="1598,-17894.55 1476,-17894.55 1476,-17842.55 1598,-17842.55 1598,-17894.55"/>
<text text-anchor="middle" x="1537" y="-17882.55" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="1537" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer2_routing&#45;&gt;gpu2_layer2_expert2 -->
<g id="edge693" class="edge">
<title>gpu2_layer2_routing&#45;&gt;gpu2_layer2_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1537,-17940.33C1537,-17928.26 1537,-17916.01 1537,-17905.16"/>
<polygon fill="black" stroke="black" points="1540.5,-17904.84 1537,-17894.84 1533.5,-17904.84 1540.5,-17904.84"/>
<text text-anchor="middle" x="1566.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer2_expert3 -->
<g id="node569" class="node">
<title>gpu2_layer2_expert3</title>
<polygon fill="lightblue" stroke="black" points="1738,-17894.55 1616,-17894.55 1616,-17842.55 1738,-17842.55 1738,-17894.55"/>
<text text-anchor="middle" x="1677" y="-17882.55" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1677" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer2_routing&#45;&gt;gpu2_layer2_expert3 -->
<g id="edge694" class="edge">
<title>gpu2_layer2_routing&#45;&gt;gpu2_layer2_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1602.49,-17940.33C1616.52,-17927.01 1630.79,-17913.45 1643.03,-17901.82"/>
<polygon fill="black" stroke="black" points="1645.54,-17904.27 1650.37,-17894.84 1640.71,-17899.19 1645.54,-17904.27"/>
<text text-anchor="middle" x="1661.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer2_expert_agg -->
<g id="node570" class="node">
<title>gpu2_layer2_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-17805.55 1462.29,-17805.55 1410.53,-17701.55 1611.71,-17701.55 1663.47,-17805.55"/>
<text text-anchor="middle" x="1537" y="-17767.55" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="1537" y="-17756.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-17745.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-17734.55" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer2_routing&#45;&gt;gpu2_layer2_expert_agg -->
<g id="edge709" class="edge">
<title>gpu2_layer2_routing&#45;&gt;gpu2_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M1626.22,-17975.63C1699.96,-17948.47 1786.6,-17902.08 1747,-17842.55 1726.44,-17811.64 1692.7,-17791.56 1658.22,-17778.53"/>
<polygon fill="black" stroke="black" points="1659.08,-17775.12 1648.48,-17775.04 1656.71,-17781.71 1659.08,-17775.12"/>
</g>
<!-- gpu2_layer2_expert0&#45;&gt;gpu2_layer2_expert_agg -->
<g id="edge705" class="edge">
<title>gpu2_layer2_expert0&#45;&gt;gpu2_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M1318.1,-17842.89C1354.98,-17828.01 1402.7,-17808.75 1444.16,-17792.01"/>
<polygon fill="black" stroke="black" points="1445.5,-17795.25 1453.46,-17788.26 1442.88,-17788.76 1445.5,-17795.25"/>
</g>
<!-- gpu2_layer2_expert1&#45;&gt;gpu2_layer2_expert_agg -->
<g id="edge706" class="edge">
<title>gpu2_layer2_expert1&#45;&gt;gpu2_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M1428.07,-17842.47C1439.32,-17833.39 1452.53,-17822.73 1465.8,-17812.02"/>
<polygon fill="black" stroke="black" points="1468.02,-17814.72 1473.6,-17805.72 1463.62,-17809.28 1468.02,-17814.72"/>
</g>
<!-- gpu2_layer2_expert2&#45;&gt;gpu2_layer2_expert_agg -->
<g id="edge707" class="edge">
<title>gpu2_layer2_expert2&#45;&gt;gpu2_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M1537,-17842.47C1537,-17834.54 1537,-17825.41 1537,-17816.09"/>
<polygon fill="black" stroke="black" points="1540.5,-17815.95 1537,-17805.95 1533.5,-17815.95 1540.5,-17815.95"/>
</g>
<!-- gpu2_layer2_expert3&#45;&gt;gpu2_layer2_expert_agg -->
<g id="edge708" class="edge">
<title>gpu2_layer2_expert3&#45;&gt;gpu2_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M1645.93,-17842.47C1634.68,-17833.39 1621.47,-17822.73 1608.2,-17812.02"/>
<polygon fill="black" stroke="black" points="1610.38,-17809.28 1600.4,-17805.72 1605.98,-17814.72 1610.38,-17809.28"/>
</g>
<!-- gpu2_layer2_res2 -->
<g id="node571" class="node">
<title>gpu2_layer2_res2</title>
<polygon fill="lightblue" stroke="black" points="1598,-17664.55 1476,-17664.55 1476,-17612.55 1598,-17612.55 1598,-17664.55"/>
<text text-anchor="middle" x="1537" y="-17652.55" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="1537" y="-17641.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-17630.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-17619.55" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer2_expert_agg&#45;&gt;gpu2_layer2_res2 -->
<g id="edge710" class="edge">
<title>gpu2_layer2_expert_agg&#45;&gt;gpu2_layer2_res2</title>
<path fill="none" stroke="black" d="M1537,-17701.34C1537,-17692.39 1537,-17683.26 1537,-17674.86"/>
<polygon fill="black" stroke="black" points="1540.5,-17674.68 1537,-17664.68 1533.5,-17674.68 1540.5,-17674.68"/>
</g>
<!-- gpu2_layer3_ln1 -->
<g id="node572" class="node">
<title>gpu2_layer3_ln1</title>
<polygon fill="lightblue" stroke="black" points="1598,-17575.55 1476,-17575.55 1476,-17523.55 1598,-17523.55 1598,-17575.55"/>
<text text-anchor="middle" x="1537" y="-17563.55" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="1537" y="-17552.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-17541.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-17530.55" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer2_res2&#45;&gt;gpu2_layer3_ln1 -->
<g id="edge715" class="edge">
<title>gpu2_layer2_res2&#45;&gt;gpu2_layer3_ln1</title>
<path fill="none" stroke="black" d="M1537,-17612.38C1537,-17604.09 1537,-17594.7 1537,-17585.8"/>
<polygon fill="black" stroke="black" points="1540.5,-17585.65 1537,-17575.65 1533.5,-17585.65 1540.5,-17585.65"/>
</g>
<!-- gpu2_layer3_qkv -->
<g id="node573" class="node">
<title>gpu2_layer3_qkv</title>
<polygon fill="lightblue" stroke="black" points="1598,-17486.55 1476,-17486.55 1476,-17434.55 1598,-17434.55 1598,-17486.55"/>
<text text-anchor="middle" x="1537" y="-17474.55" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1537" y="-17463.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-17452.55" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-17441.55" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer3_ln1&#45;&gt;gpu2_layer3_qkv -->
<g id="edge716" class="edge">
<title>gpu2_layer3_ln1&#45;&gt;gpu2_layer3_qkv</title>
<path fill="none" stroke="black" d="M1537,-17523.38C1537,-17515.09 1537,-17505.7 1537,-17496.8"/>
<polygon fill="black" stroke="black" points="1540.5,-17496.65 1537,-17486.65 1533.5,-17496.65 1540.5,-17496.65"/>
</g>
<!-- gpu2_layer3_reshape -->
<g id="node574" class="node">
<title>gpu2_layer3_reshape</title>
<polygon fill="lightblue" stroke="black" points="1601,-17397.55 1473,-17397.55 1473,-17345.55 1601,-17345.55 1601,-17397.55"/>
<text text-anchor="middle" x="1537" y="-17385.55" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="1537" y="-17374.55" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-17363.55" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-17352.55" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer3_qkv&#45;&gt;gpu2_layer3_reshape -->
<g id="edge717" class="edge">
<title>gpu2_layer3_qkv&#45;&gt;gpu2_layer3_reshape</title>
<path fill="none" stroke="black" d="M1537,-17434.38C1537,-17426.09 1537,-17416.7 1537,-17407.8"/>
<polygon fill="black" stroke="black" points="1540.5,-17407.65 1537,-17397.65 1533.5,-17407.65 1540.5,-17407.65"/>
</g>
<!-- gpu2_layer3_attn -->
<g id="node575" class="node">
<title>gpu2_layer3_attn</title>
<polygon fill="lightblue" stroke="black" points="1601,-17308.55 1473,-17308.55 1473,-17256.55 1601,-17256.55 1601,-17308.55"/>
<text text-anchor="middle" x="1537" y="-17296.55" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1537" y="-17285.55" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-17274.55" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-17263.55" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer3_reshape&#45;&gt;gpu2_layer3_attn -->
<g id="edge718" class="edge">
<title>gpu2_layer3_reshape&#45;&gt;gpu2_layer3_attn</title>
<path fill="none" stroke="black" d="M1537,-17345.38C1537,-17337.09 1537,-17327.7 1537,-17318.8"/>
<polygon fill="black" stroke="black" points="1540.5,-17318.65 1537,-17308.65 1533.5,-17318.65 1540.5,-17318.65"/>
</g>
<!-- gpu2_layer3_attn_reshape -->
<g id="node577" class="node">
<title>gpu2_layer3_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1598,-17219.55 1476,-17219.55 1476,-17167.55 1598,-17167.55 1598,-17219.55"/>
<text text-anchor="middle" x="1537" y="-17207.55" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="1537" y="-17196.55" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-17185.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-17174.55" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer3_attn&#45;&gt;gpu2_layer3_attn_reshape -->
<g id="edge719" class="edge">
<title>gpu2_layer3_attn&#45;&gt;gpu2_layer3_attn_reshape</title>
<path fill="none" stroke="black" d="M1537,-17256.38C1537,-17248.09 1537,-17238.7 1537,-17229.8"/>
<polygon fill="black" stroke="black" points="1540.5,-17229.65 1537,-17219.65 1533.5,-17229.65 1540.5,-17229.65"/>
</g>
<!-- gpu2_layer3_attn_out -->
<g id="node576" class="node">
<title>gpu2_layer3_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1598,-17130.55 1476,-17130.55 1476,-17078.55 1598,-17078.55 1598,-17130.55"/>
<text text-anchor="middle" x="1537" y="-17118.55" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="1537" y="-17107.55" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-17096.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-17085.55" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer3_kv_update -->
<g id="node578" class="node">
<title>gpu2_layer3_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="1537" cy="-17004.78" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="1537" y="-17018.78" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="1537" y="-17007.78" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-16996.78" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-16985.78" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer3_attn_out&#45;&gt;gpu2_layer3_kv_update -->
<g id="edge721" class="edge">
<title>gpu2_layer3_attn_out&#45;&gt;gpu2_layer3_kv_update</title>
<path fill="none" stroke="black" d="M1537,-17078.37C1537,-17070.23 1537,-17060.93 1537,-17051.77"/>
<polygon fill="black" stroke="black" points="1540.5,-17051.56 1537,-17041.56 1533.5,-17051.56 1540.5,-17051.56"/>
</g>
<!-- gpu2_layer3_attn_reshape&#45;&gt;gpu2_layer3_attn_out -->
<g id="edge720" class="edge">
<title>gpu2_layer3_attn_reshape&#45;&gt;gpu2_layer3_attn_out</title>
<path fill="none" stroke="black" d="M1537,-17167.38C1537,-17159.09 1537,-17149.7 1537,-17140.8"/>
<polygon fill="black" stroke="black" points="1540.5,-17140.65 1537,-17130.65 1533.5,-17140.65 1540.5,-17140.65"/>
</g>
<!-- gpu2_layer3_res1 -->
<g id="node579" class="node">
<title>gpu2_layer3_res1</title>
<polygon fill="lightblue" stroke="black" points="1598,-16931.01 1476,-16931.01 1476,-16879.01 1598,-16879.01 1598,-16931.01"/>
<text text-anchor="middle" x="1537" y="-16919.01" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="1537" y="-16908.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-16897.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-16886.01" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer3_kv_update&#45;&gt;gpu2_layer3_res1 -->
<g id="edge722" class="edge">
<title>gpu2_layer3_kv_update&#45;&gt;gpu2_layer3_res1</title>
<path fill="none" stroke="black" d="M1537,-16967.93C1537,-16959.25 1537,-16949.98 1537,-16941.32"/>
<polygon fill="black" stroke="black" points="1540.5,-16941.15 1537,-16931.15 1533.5,-16941.15 1540.5,-16941.15"/>
</g>
<!-- gpu2_layer3_ln2 -->
<g id="node580" class="node">
<title>gpu2_layer3_ln2</title>
<polygon fill="lightblue" stroke="black" points="1598,-16842.01 1476,-16842.01 1476,-16790.01 1598,-16790.01 1598,-16842.01"/>
<text text-anchor="middle" x="1537" y="-16830.01" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="1537" y="-16819.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-16808.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-16797.01" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer3_res1&#45;&gt;gpu2_layer3_ln2 -->
<g id="edge723" class="edge">
<title>gpu2_layer3_res1&#45;&gt;gpu2_layer3_ln2</title>
<path fill="none" stroke="black" d="M1537,-16878.84C1537,-16870.55 1537,-16861.16 1537,-16852.26"/>
<polygon fill="black" stroke="black" points="1540.5,-16852.12 1537,-16842.12 1533.5,-16852.12 1540.5,-16852.12"/>
</g>
<!-- gpu2_layer3_routing -->
<g id="node581" class="node">
<title>gpu2_layer3_routing</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-16753.01 1462.29,-16753.01 1410.53,-16627.01 1611.71,-16627.01 1663.47,-16753.01"/>
<text text-anchor="middle" x="1537" y="-16709.51" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="1537" y="-16698.51" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-16687.51" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-16676.51" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="1537" y="-16665.51" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer3_ln2&#45;&gt;gpu2_layer3_routing -->
<g id="edge724" class="edge">
<title>gpu2_layer3_ln2&#45;&gt;gpu2_layer3_routing</title>
<path fill="none" stroke="black" d="M1537,-16789.92C1537,-16781.98 1537,-16772.79 1537,-16763.26"/>
<polygon fill="black" stroke="black" points="1540.5,-16763.24 1537,-16753.24 1533.5,-16763.24 1540.5,-16763.24"/>
</g>
<!-- gpu2_layer3_expert0 -->
<g id="node582" class="node">
<title>gpu2_layer3_expert0</title>
<polygon fill="lightblue" stroke="black" points="1318,-16581.01 1196,-16581.01 1196,-16529.01 1318,-16529.01 1318,-16581.01"/>
<text text-anchor="middle" x="1257" y="-16569.01" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1257" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer3_routing&#45;&gt;gpu2_layer3_expert0 -->
<g id="edge711" class="edge">
<title>gpu2_layer3_routing&#45;&gt;gpu2_layer3_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1411.33,-16629.32C1379.34,-16614.12 1346.34,-16598.44 1319.11,-16585.51"/>
<polygon fill="black" stroke="black" points="1320.26,-16582.18 1309.73,-16581.05 1317.26,-16588.51 1320.26,-16582.18"/>
<text text-anchor="middle" x="1393.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer3_expert1 -->
<g id="node583" class="node">
<title>gpu2_layer3_expert1</title>
<polygon fill="lightblue" stroke="black" points="1458,-16581.01 1336,-16581.01 1336,-16529.01 1458,-16529.01 1458,-16581.01"/>
<text text-anchor="middle" x="1397" y="-16569.01" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1397" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer3_routing&#45;&gt;gpu2_layer3_expert1 -->
<g id="edge712" class="edge">
<title>gpu2_layer3_routing&#45;&gt;gpu2_layer3_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1471.51,-16626.79C1457.48,-16613.47 1443.21,-16599.91 1430.97,-16588.28"/>
<polygon fill="black" stroke="black" points="1433.29,-16585.65 1423.63,-16581.3 1428.46,-16590.73 1433.29,-16585.65"/>
<text text-anchor="middle" x="1480.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer3_expert2 -->
<g id="node584" class="node">
<title>gpu2_layer3_expert2</title>
<polygon fill="lightblue" stroke="black" points="1598,-16581.01 1476,-16581.01 1476,-16529.01 1598,-16529.01 1598,-16581.01"/>
<text text-anchor="middle" x="1537" y="-16569.01" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="1537" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer3_routing&#45;&gt;gpu2_layer3_expert2 -->
<g id="edge713" class="edge">
<title>gpu2_layer3_routing&#45;&gt;gpu2_layer3_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1537,-16626.79C1537,-16614.72 1537,-16602.47 1537,-16591.62"/>
<polygon fill="black" stroke="black" points="1540.5,-16591.3 1537,-16581.3 1533.5,-16591.3 1540.5,-16591.3"/>
<text text-anchor="middle" x="1566.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer3_expert3 -->
<g id="node585" class="node">
<title>gpu2_layer3_expert3</title>
<polygon fill="lightblue" stroke="black" points="1738,-16581.01 1616,-16581.01 1616,-16529.01 1738,-16529.01 1738,-16581.01"/>
<text text-anchor="middle" x="1677" y="-16569.01" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1677" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer3_routing&#45;&gt;gpu2_layer3_expert3 -->
<g id="edge714" class="edge">
<title>gpu2_layer3_routing&#45;&gt;gpu2_layer3_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1602.49,-16626.79C1616.52,-16613.47 1630.79,-16599.91 1643.03,-16588.28"/>
<polygon fill="black" stroke="black" points="1645.54,-16590.73 1650.37,-16581.3 1640.71,-16585.65 1645.54,-16590.73"/>
<text text-anchor="middle" x="1661.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer3_expert_agg -->
<g id="node586" class="node">
<title>gpu2_layer3_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-16492.01 1462.29,-16492.01 1410.53,-16388.01 1611.71,-16388.01 1663.47,-16492.01"/>
<text text-anchor="middle" x="1537" y="-16454.01" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="1537" y="-16443.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-16432.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-16421.01" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer3_routing&#45;&gt;gpu2_layer3_expert_agg -->
<g id="edge729" class="edge">
<title>gpu2_layer3_routing&#45;&gt;gpu2_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M1626.22,-16662.09C1699.96,-16634.93 1786.6,-16588.54 1747,-16529.01 1726.44,-16498.1 1692.7,-16478.02 1658.22,-16464.99"/>
<polygon fill="black" stroke="black" points="1659.08,-16461.58 1648.48,-16461.5 1656.71,-16468.17 1659.08,-16461.58"/>
</g>
<!-- gpu2_layer3_expert0&#45;&gt;gpu2_layer3_expert_agg -->
<g id="edge725" class="edge">
<title>gpu2_layer3_expert0&#45;&gt;gpu2_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M1318.1,-16529.35C1354.98,-16514.47 1402.7,-16495.21 1444.16,-16478.47"/>
<polygon fill="black" stroke="black" points="1445.5,-16481.71 1453.46,-16474.72 1442.88,-16475.22 1445.5,-16481.71"/>
</g>
<!-- gpu2_layer3_expert1&#45;&gt;gpu2_layer3_expert_agg -->
<g id="edge726" class="edge">
<title>gpu2_layer3_expert1&#45;&gt;gpu2_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M1428.07,-16528.93C1439.32,-16519.85 1452.53,-16509.19 1465.8,-16498.48"/>
<polygon fill="black" stroke="black" points="1468.02,-16501.18 1473.6,-16492.18 1463.62,-16495.74 1468.02,-16501.18"/>
</g>
<!-- gpu2_layer3_expert2&#45;&gt;gpu2_layer3_expert_agg -->
<g id="edge727" class="edge">
<title>gpu2_layer3_expert2&#45;&gt;gpu2_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M1537,-16528.93C1537,-16521 1537,-16511.87 1537,-16502.55"/>
<polygon fill="black" stroke="black" points="1540.5,-16502.41 1537,-16492.41 1533.5,-16502.41 1540.5,-16502.41"/>
</g>
<!-- gpu2_layer3_expert3&#45;&gt;gpu2_layer3_expert_agg -->
<g id="edge728" class="edge">
<title>gpu2_layer3_expert3&#45;&gt;gpu2_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M1645.93,-16528.93C1634.68,-16519.85 1621.47,-16509.19 1608.2,-16498.48"/>
<polygon fill="black" stroke="black" points="1610.38,-16495.74 1600.4,-16492.18 1605.98,-16501.18 1610.38,-16495.74"/>
</g>
<!-- gpu2_layer3_res2 -->
<g id="node587" class="node">
<title>gpu2_layer3_res2</title>
<polygon fill="lightblue" stroke="black" points="1598,-16351.01 1476,-16351.01 1476,-16299.01 1598,-16299.01 1598,-16351.01"/>
<text text-anchor="middle" x="1537" y="-16339.01" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="1537" y="-16328.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-16317.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-16306.01" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer3_expert_agg&#45;&gt;gpu2_layer3_res2 -->
<g id="edge730" class="edge">
<title>gpu2_layer3_expert_agg&#45;&gt;gpu2_layer3_res2</title>
<path fill="none" stroke="black" d="M1537,-16387.8C1537,-16378.85 1537,-16369.72 1537,-16361.32"/>
<polygon fill="black" stroke="black" points="1540.5,-16361.14 1537,-16351.14 1533.5,-16361.14 1540.5,-16361.14"/>
</g>
<!-- gpu2_layer4_ln1 -->
<g id="node588" class="node">
<title>gpu2_layer4_ln1</title>
<polygon fill="lightblue" stroke="black" points="1598,-16262.01 1476,-16262.01 1476,-16210.01 1598,-16210.01 1598,-16262.01"/>
<text text-anchor="middle" x="1537" y="-16250.01" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="1537" y="-16239.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-16228.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-16217.01" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer3_res2&#45;&gt;gpu2_layer4_ln1 -->
<g id="edge735" class="edge">
<title>gpu2_layer3_res2&#45;&gt;gpu2_layer4_ln1</title>
<path fill="none" stroke="black" d="M1537,-16298.84C1537,-16290.55 1537,-16281.16 1537,-16272.26"/>
<polygon fill="black" stroke="black" points="1540.5,-16272.12 1537,-16262.12 1533.5,-16272.12 1540.5,-16272.12"/>
</g>
<!-- gpu2_layer4_qkv -->
<g id="node589" class="node">
<title>gpu2_layer4_qkv</title>
<polygon fill="lightblue" stroke="black" points="1598,-16173.01 1476,-16173.01 1476,-16121.01 1598,-16121.01 1598,-16173.01"/>
<text text-anchor="middle" x="1537" y="-16161.01" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1537" y="-16150.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-16139.01" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-16128.01" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer4_ln1&#45;&gt;gpu2_layer4_qkv -->
<g id="edge736" class="edge">
<title>gpu2_layer4_ln1&#45;&gt;gpu2_layer4_qkv</title>
<path fill="none" stroke="black" d="M1537,-16209.84C1537,-16201.55 1537,-16192.16 1537,-16183.26"/>
<polygon fill="black" stroke="black" points="1540.5,-16183.12 1537,-16173.12 1533.5,-16183.12 1540.5,-16183.12"/>
</g>
<!-- gpu2_layer4_reshape -->
<g id="node590" class="node">
<title>gpu2_layer4_reshape</title>
<polygon fill="lightblue" stroke="black" points="1601,-16084.01 1473,-16084.01 1473,-16032.01 1601,-16032.01 1601,-16084.01"/>
<text text-anchor="middle" x="1537" y="-16072.01" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="1537" y="-16061.01" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-16050.01" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-16039.01" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer4_qkv&#45;&gt;gpu2_layer4_reshape -->
<g id="edge737" class="edge">
<title>gpu2_layer4_qkv&#45;&gt;gpu2_layer4_reshape</title>
<path fill="none" stroke="black" d="M1537,-16120.84C1537,-16112.55 1537,-16103.16 1537,-16094.26"/>
<polygon fill="black" stroke="black" points="1540.5,-16094.12 1537,-16084.12 1533.5,-16094.12 1540.5,-16094.12"/>
</g>
<!-- gpu2_layer4_attn -->
<g id="node591" class="node">
<title>gpu2_layer4_attn</title>
<polygon fill="lightblue" stroke="black" points="1601,-15995.01 1473,-15995.01 1473,-15943.01 1601,-15943.01 1601,-15995.01"/>
<text text-anchor="middle" x="1537" y="-15983.01" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1537" y="-15972.01" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-15961.01" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-15950.01" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer4_reshape&#45;&gt;gpu2_layer4_attn -->
<g id="edge738" class="edge">
<title>gpu2_layer4_reshape&#45;&gt;gpu2_layer4_attn</title>
<path fill="none" stroke="black" d="M1537,-16031.84C1537,-16023.55 1537,-16014.16 1537,-16005.26"/>
<polygon fill="black" stroke="black" points="1540.5,-16005.12 1537,-15995.12 1533.5,-16005.12 1540.5,-16005.12"/>
</g>
<!-- gpu2_layer4_attn_reshape -->
<g id="node593" class="node">
<title>gpu2_layer4_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1598,-15906.01 1476,-15906.01 1476,-15854.01 1598,-15854.01 1598,-15906.01"/>
<text text-anchor="middle" x="1537" y="-15894.01" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="1537" y="-15883.01" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-15872.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-15861.01" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer4_attn&#45;&gt;gpu2_layer4_attn_reshape -->
<g id="edge739" class="edge">
<title>gpu2_layer4_attn&#45;&gt;gpu2_layer4_attn_reshape</title>
<path fill="none" stroke="black" d="M1537,-15942.84C1537,-15934.55 1537,-15925.16 1537,-15916.26"/>
<polygon fill="black" stroke="black" points="1540.5,-15916.12 1537,-15906.12 1533.5,-15916.12 1540.5,-15916.12"/>
</g>
<!-- gpu2_layer4_attn_out -->
<g id="node592" class="node">
<title>gpu2_layer4_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1598,-15817.01 1476,-15817.01 1476,-15765.01 1598,-15765.01 1598,-15817.01"/>
<text text-anchor="middle" x="1537" y="-15805.01" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="1537" y="-15794.01" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-15783.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-15772.01" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer4_kv_update -->
<g id="node594" class="node">
<title>gpu2_layer4_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="1537" cy="-15691.24" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="1537" y="-15705.24" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="1537" y="-15694.24" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-15683.24" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-15672.24" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer4_attn_out&#45;&gt;gpu2_layer4_kv_update -->
<g id="edge741" class="edge">
<title>gpu2_layer4_attn_out&#45;&gt;gpu2_layer4_kv_update</title>
<path fill="none" stroke="black" d="M1537,-15764.83C1537,-15756.69 1537,-15747.39 1537,-15738.23"/>
<polygon fill="black" stroke="black" points="1540.5,-15738.02 1537,-15728.02 1533.5,-15738.02 1540.5,-15738.02"/>
</g>
<!-- gpu2_layer4_attn_reshape&#45;&gt;gpu2_layer4_attn_out -->
<g id="edge740" class="edge">
<title>gpu2_layer4_attn_reshape&#45;&gt;gpu2_layer4_attn_out</title>
<path fill="none" stroke="black" d="M1537,-15853.84C1537,-15845.55 1537,-15836.16 1537,-15827.26"/>
<polygon fill="black" stroke="black" points="1540.5,-15827.12 1537,-15817.12 1533.5,-15827.12 1540.5,-15827.12"/>
</g>
<!-- gpu2_layer4_res1 -->
<g id="node595" class="node">
<title>gpu2_layer4_res1</title>
<polygon fill="lightblue" stroke="black" points="1598,-15617.47 1476,-15617.47 1476,-15565.47 1598,-15565.47 1598,-15617.47"/>
<text text-anchor="middle" x="1537" y="-15605.47" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="1537" y="-15594.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-15583.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-15572.47" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer4_kv_update&#45;&gt;gpu2_layer4_res1 -->
<g id="edge742" class="edge">
<title>gpu2_layer4_kv_update&#45;&gt;gpu2_layer4_res1</title>
<path fill="none" stroke="black" d="M1537,-15654.39C1537,-15645.71 1537,-15636.44 1537,-15627.78"/>
<polygon fill="black" stroke="black" points="1540.5,-15627.62 1537,-15617.62 1533.5,-15627.62 1540.5,-15627.62"/>
</g>
<!-- gpu2_layer4_ln2 -->
<g id="node596" class="node">
<title>gpu2_layer4_ln2</title>
<polygon fill="lightblue" stroke="black" points="1598,-15528.47 1476,-15528.47 1476,-15476.47 1598,-15476.47 1598,-15528.47"/>
<text text-anchor="middle" x="1537" y="-15516.47" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="1537" y="-15505.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-15494.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-15483.47" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer4_res1&#45;&gt;gpu2_layer4_ln2 -->
<g id="edge743" class="edge">
<title>gpu2_layer4_res1&#45;&gt;gpu2_layer4_ln2</title>
<path fill="none" stroke="black" d="M1537,-15565.31C1537,-15557.01 1537,-15547.62 1537,-15538.72"/>
<polygon fill="black" stroke="black" points="1540.5,-15538.58 1537,-15528.58 1533.5,-15538.58 1540.5,-15538.58"/>
</g>
<!-- gpu2_layer4_routing -->
<g id="node597" class="node">
<title>gpu2_layer4_routing</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-15439.47 1462.29,-15439.47 1410.53,-15313.47 1611.71,-15313.47 1663.47,-15439.47"/>
<text text-anchor="middle" x="1537" y="-15395.97" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="1537" y="-15384.97" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-15373.97" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-15362.97" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="1537" y="-15351.97" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer4_ln2&#45;&gt;gpu2_layer4_routing -->
<g id="edge744" class="edge">
<title>gpu2_layer4_ln2&#45;&gt;gpu2_layer4_routing</title>
<path fill="none" stroke="black" d="M1537,-15476.38C1537,-15468.45 1537,-15459.25 1537,-15449.72"/>
<polygon fill="black" stroke="black" points="1540.5,-15449.7 1537,-15439.7 1533.5,-15449.7 1540.5,-15449.7"/>
</g>
<!-- gpu2_layer4_expert0 -->
<g id="node598" class="node">
<title>gpu2_layer4_expert0</title>
<polygon fill="lightblue" stroke="black" points="1318,-15267.47 1196,-15267.47 1196,-15215.47 1318,-15215.47 1318,-15267.47"/>
<text text-anchor="middle" x="1257" y="-15255.47" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1257" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer4_routing&#45;&gt;gpu2_layer4_expert0 -->
<g id="edge731" class="edge">
<title>gpu2_layer4_routing&#45;&gt;gpu2_layer4_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1411.33,-15315.78C1379.34,-15300.58 1346.34,-15284.91 1319.11,-15271.97"/>
<polygon fill="black" stroke="black" points="1320.26,-15268.64 1309.73,-15267.51 1317.26,-15274.97 1320.26,-15268.64"/>
<text text-anchor="middle" x="1393.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer4_expert1 -->
<g id="node599" class="node">
<title>gpu2_layer4_expert1</title>
<polygon fill="lightblue" stroke="black" points="1458,-15267.47 1336,-15267.47 1336,-15215.47 1458,-15215.47 1458,-15267.47"/>
<text text-anchor="middle" x="1397" y="-15255.47" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1397" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer4_routing&#45;&gt;gpu2_layer4_expert1 -->
<g id="edge732" class="edge">
<title>gpu2_layer4_routing&#45;&gt;gpu2_layer4_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1471.51,-15313.25C1457.48,-15299.93 1443.21,-15286.37 1430.97,-15274.74"/>
<polygon fill="black" stroke="black" points="1433.29,-15272.11 1423.63,-15267.76 1428.46,-15277.19 1433.29,-15272.11"/>
<text text-anchor="middle" x="1480.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer4_expert2 -->
<g id="node600" class="node">
<title>gpu2_layer4_expert2</title>
<polygon fill="lightblue" stroke="black" points="1598,-15267.47 1476,-15267.47 1476,-15215.47 1598,-15215.47 1598,-15267.47"/>
<text text-anchor="middle" x="1537" y="-15255.47" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="1537" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer4_routing&#45;&gt;gpu2_layer4_expert2 -->
<g id="edge733" class="edge">
<title>gpu2_layer4_routing&#45;&gt;gpu2_layer4_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1537,-15313.25C1537,-15301.18 1537,-15288.93 1537,-15278.08"/>
<polygon fill="black" stroke="black" points="1540.5,-15277.76 1537,-15267.76 1533.5,-15277.76 1540.5,-15277.76"/>
<text text-anchor="middle" x="1566.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer4_expert3 -->
<g id="node601" class="node">
<title>gpu2_layer4_expert3</title>
<polygon fill="lightblue" stroke="black" points="1738,-15267.47 1616,-15267.47 1616,-15215.47 1738,-15215.47 1738,-15267.47"/>
<text text-anchor="middle" x="1677" y="-15255.47" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1677" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer4_routing&#45;&gt;gpu2_layer4_expert3 -->
<g id="edge734" class="edge">
<title>gpu2_layer4_routing&#45;&gt;gpu2_layer4_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1602.49,-15313.25C1616.52,-15299.93 1630.79,-15286.37 1643.03,-15274.74"/>
<polygon fill="black" stroke="black" points="1645.54,-15277.19 1650.37,-15267.76 1640.71,-15272.11 1645.54,-15277.19"/>
<text text-anchor="middle" x="1661.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer4_expert_agg -->
<g id="node602" class="node">
<title>gpu2_layer4_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-15178.47 1462.29,-15178.47 1410.53,-15074.47 1611.71,-15074.47 1663.47,-15178.47"/>
<text text-anchor="middle" x="1537" y="-15140.47" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="1537" y="-15129.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-15118.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-15107.47" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer4_routing&#45;&gt;gpu2_layer4_expert_agg -->
<g id="edge749" class="edge">
<title>gpu2_layer4_routing&#45;&gt;gpu2_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M1626.22,-15348.55C1699.96,-15321.39 1786.6,-15275 1747,-15215.47 1726.44,-15184.56 1692.7,-15164.48 1658.22,-15151.45"/>
<polygon fill="black" stroke="black" points="1659.08,-15148.04 1648.48,-15147.96 1656.71,-15154.63 1659.08,-15148.04"/>
</g>
<!-- gpu2_layer4_expert0&#45;&gt;gpu2_layer4_expert_agg -->
<g id="edge745" class="edge">
<title>gpu2_layer4_expert0&#45;&gt;gpu2_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M1318.1,-15215.81C1354.98,-15200.93 1402.7,-15181.67 1444.16,-15164.94"/>
<polygon fill="black" stroke="black" points="1445.5,-15168.17 1453.46,-15161.18 1442.88,-15161.68 1445.5,-15168.17"/>
</g>
<!-- gpu2_layer4_expert1&#45;&gt;gpu2_layer4_expert_agg -->
<g id="edge746" class="edge">
<title>gpu2_layer4_expert1&#45;&gt;gpu2_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M1428.07,-15215.39C1439.32,-15206.31 1452.53,-15195.65 1465.8,-15184.94"/>
<polygon fill="black" stroke="black" points="1468.02,-15187.64 1473.6,-15178.64 1463.62,-15182.2 1468.02,-15187.64"/>
</g>
<!-- gpu2_layer4_expert2&#45;&gt;gpu2_layer4_expert_agg -->
<g id="edge747" class="edge">
<title>gpu2_layer4_expert2&#45;&gt;gpu2_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M1537,-15215.39C1537,-15207.46 1537,-15198.33 1537,-15189.01"/>
<polygon fill="black" stroke="black" points="1540.5,-15188.87 1537,-15178.87 1533.5,-15188.87 1540.5,-15188.87"/>
</g>
<!-- gpu2_layer4_expert3&#45;&gt;gpu2_layer4_expert_agg -->
<g id="edge748" class="edge">
<title>gpu2_layer4_expert3&#45;&gt;gpu2_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M1645.93,-15215.39C1634.68,-15206.31 1621.47,-15195.65 1608.2,-15184.94"/>
<polygon fill="black" stroke="black" points="1610.38,-15182.2 1600.4,-15178.64 1605.98,-15187.64 1610.38,-15182.2"/>
</g>
<!-- gpu2_layer4_res2 -->
<g id="node603" class="node">
<title>gpu2_layer4_res2</title>
<polygon fill="lightblue" stroke="black" points="1598,-15037.47 1476,-15037.47 1476,-14985.47 1598,-14985.47 1598,-15037.47"/>
<text text-anchor="middle" x="1537" y="-15025.47" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="1537" y="-15014.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-15003.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-14992.47" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer4_expert_agg&#45;&gt;gpu2_layer4_res2 -->
<g id="edge750" class="edge">
<title>gpu2_layer4_expert_agg&#45;&gt;gpu2_layer4_res2</title>
<path fill="none" stroke="black" d="M1537,-15074.26C1537,-15065.31 1537,-15056.18 1537,-15047.78"/>
<polygon fill="black" stroke="black" points="1540.5,-15047.6 1537,-15037.6 1533.5,-15047.6 1540.5,-15047.6"/>
</g>
<!-- gpu2_layer5_ln1 -->
<g id="node604" class="node">
<title>gpu2_layer5_ln1</title>
<polygon fill="lightblue" stroke="black" points="1598,-14948.47 1476,-14948.47 1476,-14896.47 1598,-14896.47 1598,-14948.47"/>
<text text-anchor="middle" x="1537" y="-14936.47" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="1537" y="-14925.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-14914.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-14903.47" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer4_res2&#45;&gt;gpu2_layer5_ln1 -->
<g id="edge755" class="edge">
<title>gpu2_layer4_res2&#45;&gt;gpu2_layer5_ln1</title>
<path fill="none" stroke="black" d="M1537,-14985.31C1537,-14977.01 1537,-14967.62 1537,-14958.72"/>
<polygon fill="black" stroke="black" points="1540.5,-14958.58 1537,-14948.58 1533.5,-14958.58 1540.5,-14958.58"/>
</g>
<!-- gpu2_layer5_qkv -->
<g id="node605" class="node">
<title>gpu2_layer5_qkv</title>
<polygon fill="lightblue" stroke="black" points="1598,-14859.47 1476,-14859.47 1476,-14807.47 1598,-14807.47 1598,-14859.47"/>
<text text-anchor="middle" x="1537" y="-14847.47" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1537" y="-14836.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-14825.47" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-14814.47" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer5_ln1&#45;&gt;gpu2_layer5_qkv -->
<g id="edge756" class="edge">
<title>gpu2_layer5_ln1&#45;&gt;gpu2_layer5_qkv</title>
<path fill="none" stroke="black" d="M1537,-14896.31C1537,-14888.01 1537,-14878.62 1537,-14869.72"/>
<polygon fill="black" stroke="black" points="1540.5,-14869.58 1537,-14859.58 1533.5,-14869.58 1540.5,-14869.58"/>
</g>
<!-- gpu2_layer5_reshape -->
<g id="node606" class="node">
<title>gpu2_layer5_reshape</title>
<polygon fill="lightblue" stroke="black" points="1601,-14770.47 1473,-14770.47 1473,-14718.47 1601,-14718.47 1601,-14770.47"/>
<text text-anchor="middle" x="1537" y="-14758.47" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="1537" y="-14747.47" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-14736.47" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-14725.47" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer5_qkv&#45;&gt;gpu2_layer5_reshape -->
<g id="edge757" class="edge">
<title>gpu2_layer5_qkv&#45;&gt;gpu2_layer5_reshape</title>
<path fill="none" stroke="black" d="M1537,-14807.31C1537,-14799.01 1537,-14789.62 1537,-14780.72"/>
<polygon fill="black" stroke="black" points="1540.5,-14780.58 1537,-14770.58 1533.5,-14780.58 1540.5,-14780.58"/>
</g>
<!-- gpu2_layer5_attn -->
<g id="node607" class="node">
<title>gpu2_layer5_attn</title>
<polygon fill="lightblue" stroke="black" points="1601,-14681.47 1473,-14681.47 1473,-14629.47 1601,-14629.47 1601,-14681.47"/>
<text text-anchor="middle" x="1537" y="-14669.47" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1537" y="-14658.47" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-14647.47" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-14636.47" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer5_reshape&#45;&gt;gpu2_layer5_attn -->
<g id="edge758" class="edge">
<title>gpu2_layer5_reshape&#45;&gt;gpu2_layer5_attn</title>
<path fill="none" stroke="black" d="M1537,-14718.31C1537,-14710.01 1537,-14700.62 1537,-14691.72"/>
<polygon fill="black" stroke="black" points="1540.5,-14691.58 1537,-14681.58 1533.5,-14691.58 1540.5,-14691.58"/>
</g>
<!-- gpu2_layer5_attn_reshape -->
<g id="node609" class="node">
<title>gpu2_layer5_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1598,-14592.47 1476,-14592.47 1476,-14540.47 1598,-14540.47 1598,-14592.47"/>
<text text-anchor="middle" x="1537" y="-14580.47" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="1537" y="-14569.47" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-14558.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-14547.47" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer5_attn&#45;&gt;gpu2_layer5_attn_reshape -->
<g id="edge759" class="edge">
<title>gpu2_layer5_attn&#45;&gt;gpu2_layer5_attn_reshape</title>
<path fill="none" stroke="black" d="M1537,-14629.31C1537,-14621.01 1537,-14611.62 1537,-14602.72"/>
<polygon fill="black" stroke="black" points="1540.5,-14602.58 1537,-14592.58 1533.5,-14602.58 1540.5,-14602.58"/>
</g>
<!-- gpu2_layer5_attn_out -->
<g id="node608" class="node">
<title>gpu2_layer5_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1598,-14503.47 1476,-14503.47 1476,-14451.47 1598,-14451.47 1598,-14503.47"/>
<text text-anchor="middle" x="1537" y="-14491.47" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="1537" y="-14480.47" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-14469.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-14458.47" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer5_kv_update -->
<g id="node610" class="node">
<title>gpu2_layer5_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="1537" cy="-14377.7" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="1537" y="-14391.7" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="1537" y="-14380.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-14369.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-14358.7" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer5_attn_out&#45;&gt;gpu2_layer5_kv_update -->
<g id="edge761" class="edge">
<title>gpu2_layer5_attn_out&#45;&gt;gpu2_layer5_kv_update</title>
<path fill="none" stroke="black" d="M1537,-14451.29C1537,-14443.15 1537,-14433.86 1537,-14424.69"/>
<polygon fill="black" stroke="black" points="1540.5,-14424.48 1537,-14414.48 1533.5,-14424.48 1540.5,-14424.48"/>
</g>
<!-- gpu2_layer5_attn_reshape&#45;&gt;gpu2_layer5_attn_out -->
<g id="edge760" class="edge">
<title>gpu2_layer5_attn_reshape&#45;&gt;gpu2_layer5_attn_out</title>
<path fill="none" stroke="black" d="M1537,-14540.31C1537,-14532.01 1537,-14522.62 1537,-14513.72"/>
<polygon fill="black" stroke="black" points="1540.5,-14513.58 1537,-14503.58 1533.5,-14513.58 1540.5,-14513.58"/>
</g>
<!-- gpu2_layer5_res1 -->
<g id="node611" class="node">
<title>gpu2_layer5_res1</title>
<polygon fill="lightblue" stroke="black" points="1598,-14303.93 1476,-14303.93 1476,-14251.93 1598,-14251.93 1598,-14303.93"/>
<text text-anchor="middle" x="1537" y="-14291.93" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="1537" y="-14280.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-14269.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-14258.93" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer5_kv_update&#45;&gt;gpu2_layer5_res1 -->
<g id="edge762" class="edge">
<title>gpu2_layer5_kv_update&#45;&gt;gpu2_layer5_res1</title>
<path fill="none" stroke="black" d="M1537,-14340.85C1537,-14332.17 1537,-14322.9 1537,-14314.25"/>
<polygon fill="black" stroke="black" points="1540.5,-14314.08 1537,-14304.08 1533.5,-14314.08 1540.5,-14314.08"/>
</g>
<!-- gpu2_layer5_ln2 -->
<g id="node612" class="node">
<title>gpu2_layer5_ln2</title>
<polygon fill="lightblue" stroke="black" points="1598,-14214.93 1476,-14214.93 1476,-14162.93 1598,-14162.93 1598,-14214.93"/>
<text text-anchor="middle" x="1537" y="-14202.93" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="1537" y="-14191.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-14180.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-14169.93" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer5_res1&#45;&gt;gpu2_layer5_ln2 -->
<g id="edge763" class="edge">
<title>gpu2_layer5_res1&#45;&gt;gpu2_layer5_ln2</title>
<path fill="none" stroke="black" d="M1537,-14251.77C1537,-14243.47 1537,-14234.08 1537,-14225.18"/>
<polygon fill="black" stroke="black" points="1540.5,-14225.04 1537,-14215.04 1533.5,-14225.04 1540.5,-14225.04"/>
</g>
<!-- gpu2_layer5_routing -->
<g id="node613" class="node">
<title>gpu2_layer5_routing</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-14125.93 1462.29,-14125.93 1410.53,-13999.93 1611.71,-13999.93 1663.47,-14125.93"/>
<text text-anchor="middle" x="1537" y="-14082.43" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="1537" y="-14071.43" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-14060.43" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-14049.43" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="1537" y="-14038.43" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer5_ln2&#45;&gt;gpu2_layer5_routing -->
<g id="edge764" class="edge">
<title>gpu2_layer5_ln2&#45;&gt;gpu2_layer5_routing</title>
<path fill="none" stroke="black" d="M1537,-14162.84C1537,-14154.91 1537,-14145.71 1537,-14136.18"/>
<polygon fill="black" stroke="black" points="1540.5,-14136.17 1537,-14126.17 1533.5,-14136.17 1540.5,-14136.17"/>
</g>
<!-- gpu2_layer5_expert0 -->
<g id="node614" class="node">
<title>gpu2_layer5_expert0</title>
<polygon fill="lightblue" stroke="black" points="1318,-13953.93 1196,-13953.93 1196,-13901.93 1318,-13901.93 1318,-13953.93"/>
<text text-anchor="middle" x="1257" y="-13941.93" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1257" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer5_routing&#45;&gt;gpu2_layer5_expert0 -->
<g id="edge751" class="edge">
<title>gpu2_layer5_routing&#45;&gt;gpu2_layer5_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1411.33,-14002.24C1379.34,-13987.04 1346.34,-13971.37 1319.11,-13958.43"/>
<polygon fill="black" stroke="black" points="1320.26,-13955.1 1309.73,-13953.98 1317.26,-13961.43 1320.26,-13955.1"/>
<text text-anchor="middle" x="1393.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer5_expert1 -->
<g id="node615" class="node">
<title>gpu2_layer5_expert1</title>
<polygon fill="lightblue" stroke="black" points="1458,-13953.93 1336,-13953.93 1336,-13901.93 1458,-13901.93 1458,-13953.93"/>
<text text-anchor="middle" x="1397" y="-13941.93" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1397" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer5_routing&#45;&gt;gpu2_layer5_expert1 -->
<g id="edge752" class="edge">
<title>gpu2_layer5_routing&#45;&gt;gpu2_layer5_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1471.51,-13999.71C1457.48,-13986.39 1443.21,-13972.83 1430.97,-13961.2"/>
<polygon fill="black" stroke="black" points="1433.29,-13958.57 1423.63,-13954.22 1428.46,-13963.65 1433.29,-13958.57"/>
<text text-anchor="middle" x="1480.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer5_expert2 -->
<g id="node616" class="node">
<title>gpu2_layer5_expert2</title>
<polygon fill="lightblue" stroke="black" points="1598,-13953.93 1476,-13953.93 1476,-13901.93 1598,-13901.93 1598,-13953.93"/>
<text text-anchor="middle" x="1537" y="-13941.93" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="1537" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer5_routing&#45;&gt;gpu2_layer5_expert2 -->
<g id="edge753" class="edge">
<title>gpu2_layer5_routing&#45;&gt;gpu2_layer5_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1537,-13999.71C1537,-13987.65 1537,-13975.39 1537,-13964.54"/>
<polygon fill="black" stroke="black" points="1540.5,-13964.22 1537,-13954.22 1533.5,-13964.22 1540.5,-13964.22"/>
<text text-anchor="middle" x="1566.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer5_expert3 -->
<g id="node617" class="node">
<title>gpu2_layer5_expert3</title>
<polygon fill="lightblue" stroke="black" points="1738,-13953.93 1616,-13953.93 1616,-13901.93 1738,-13901.93 1738,-13953.93"/>
<text text-anchor="middle" x="1677" y="-13941.93" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1677" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer5_routing&#45;&gt;gpu2_layer5_expert3 -->
<g id="edge754" class="edge">
<title>gpu2_layer5_routing&#45;&gt;gpu2_layer5_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1602.49,-13999.71C1616.52,-13986.39 1630.79,-13972.83 1643.03,-13961.2"/>
<polygon fill="black" stroke="black" points="1645.54,-13963.65 1650.37,-13954.22 1640.71,-13958.57 1645.54,-13963.65"/>
<text text-anchor="middle" x="1661.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer5_expert_agg -->
<g id="node618" class="node">
<title>gpu2_layer5_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-13864.93 1462.29,-13864.93 1410.53,-13760.93 1611.71,-13760.93 1663.47,-13864.93"/>
<text text-anchor="middle" x="1537" y="-13826.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="1537" y="-13815.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-13804.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-13793.93" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer5_routing&#45;&gt;gpu2_layer5_expert_agg -->
<g id="edge769" class="edge">
<title>gpu2_layer5_routing&#45;&gt;gpu2_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M1626.22,-14035.01C1699.96,-14007.85 1786.6,-13961.46 1747,-13901.93 1726.44,-13871.02 1692.7,-13850.94 1658.22,-13837.91"/>
<polygon fill="black" stroke="black" points="1659.08,-13834.5 1648.48,-13834.42 1656.71,-13841.09 1659.08,-13834.5"/>
</g>
<!-- gpu2_layer5_expert0&#45;&gt;gpu2_layer5_expert_agg -->
<g id="edge765" class="edge">
<title>gpu2_layer5_expert0&#45;&gt;gpu2_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M1318.1,-13902.27C1354.98,-13887.39 1402.7,-13868.13 1444.16,-13851.4"/>
<polygon fill="black" stroke="black" points="1445.5,-13854.63 1453.46,-13847.65 1442.88,-13848.14 1445.5,-13854.63"/>
</g>
<!-- gpu2_layer5_expert1&#45;&gt;gpu2_layer5_expert_agg -->
<g id="edge766" class="edge">
<title>gpu2_layer5_expert1&#45;&gt;gpu2_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M1428.07,-13901.85C1439.32,-13892.77 1452.53,-13882.11 1465.8,-13871.4"/>
<polygon fill="black" stroke="black" points="1468.02,-13874.11 1473.6,-13865.1 1463.62,-13868.66 1468.02,-13874.11"/>
</g>
<!-- gpu2_layer5_expert2&#45;&gt;gpu2_layer5_expert_agg -->
<g id="edge767" class="edge">
<title>gpu2_layer5_expert2&#45;&gt;gpu2_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M1537,-13901.85C1537,-13893.93 1537,-13884.79 1537,-13875.47"/>
<polygon fill="black" stroke="black" points="1540.5,-13875.33 1537,-13865.33 1533.5,-13875.33 1540.5,-13875.33"/>
</g>
<!-- gpu2_layer5_expert3&#45;&gt;gpu2_layer5_expert_agg -->
<g id="edge768" class="edge">
<title>gpu2_layer5_expert3&#45;&gt;gpu2_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M1645.93,-13901.85C1634.68,-13892.77 1621.47,-13882.11 1608.2,-13871.4"/>
<polygon fill="black" stroke="black" points="1610.38,-13868.66 1600.4,-13865.1 1605.98,-13874.11 1610.38,-13868.66"/>
</g>
<!-- gpu2_layer5_res2 -->
<g id="node619" class="node">
<title>gpu2_layer5_res2</title>
<polygon fill="lightblue" stroke="black" points="1598,-13723.93 1476,-13723.93 1476,-13671.93 1598,-13671.93 1598,-13723.93"/>
<text text-anchor="middle" x="1537" y="-13711.93" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="1537" y="-13700.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-13689.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-13678.93" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer5_expert_agg&#45;&gt;gpu2_layer5_res2 -->
<g id="edge770" class="edge">
<title>gpu2_layer5_expert_agg&#45;&gt;gpu2_layer5_res2</title>
<path fill="none" stroke="black" d="M1537,-13760.72C1537,-13751.77 1537,-13742.64 1537,-13734.24"/>
<polygon fill="black" stroke="black" points="1540.5,-13734.06 1537,-13724.06 1533.5,-13734.06 1540.5,-13734.06"/>
</g>
<!-- gpu2_layer6_ln1 -->
<g id="node620" class="node">
<title>gpu2_layer6_ln1</title>
<polygon fill="lightblue" stroke="black" points="1598,-13634.93 1476,-13634.93 1476,-13582.93 1598,-13582.93 1598,-13634.93"/>
<text text-anchor="middle" x="1537" y="-13622.93" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="1537" y="-13611.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-13600.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-13589.93" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer5_res2&#45;&gt;gpu2_layer6_ln1 -->
<g id="edge775" class="edge">
<title>gpu2_layer5_res2&#45;&gt;gpu2_layer6_ln1</title>
<path fill="none" stroke="black" d="M1537,-13671.77C1537,-13663.47 1537,-13654.08 1537,-13645.18"/>
<polygon fill="black" stroke="black" points="1540.5,-13645.04 1537,-13635.04 1533.5,-13645.04 1540.5,-13645.04"/>
</g>
<!-- gpu2_layer6_qkv -->
<g id="node621" class="node">
<title>gpu2_layer6_qkv</title>
<polygon fill="lightblue" stroke="black" points="1598,-13545.93 1476,-13545.93 1476,-13493.93 1598,-13493.93 1598,-13545.93"/>
<text text-anchor="middle" x="1537" y="-13533.93" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1537" y="-13522.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-13511.93" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-13500.93" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer6_ln1&#45;&gt;gpu2_layer6_qkv -->
<g id="edge776" class="edge">
<title>gpu2_layer6_ln1&#45;&gt;gpu2_layer6_qkv</title>
<path fill="none" stroke="black" d="M1537,-13582.77C1537,-13574.47 1537,-13565.08 1537,-13556.18"/>
<polygon fill="black" stroke="black" points="1540.5,-13556.04 1537,-13546.04 1533.5,-13556.04 1540.5,-13556.04"/>
</g>
<!-- gpu2_layer6_reshape -->
<g id="node622" class="node">
<title>gpu2_layer6_reshape</title>
<polygon fill="lightblue" stroke="black" points="1601,-13456.93 1473,-13456.93 1473,-13404.93 1601,-13404.93 1601,-13456.93"/>
<text text-anchor="middle" x="1537" y="-13444.93" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="1537" y="-13433.93" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-13422.93" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-13411.93" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer6_qkv&#45;&gt;gpu2_layer6_reshape -->
<g id="edge777" class="edge">
<title>gpu2_layer6_qkv&#45;&gt;gpu2_layer6_reshape</title>
<path fill="none" stroke="black" d="M1537,-13493.77C1537,-13485.47 1537,-13476.08 1537,-13467.18"/>
<polygon fill="black" stroke="black" points="1540.5,-13467.04 1537,-13457.04 1533.5,-13467.04 1540.5,-13467.04"/>
</g>
<!-- gpu2_layer6_attn -->
<g id="node623" class="node">
<title>gpu2_layer6_attn</title>
<polygon fill="lightblue" stroke="black" points="1601,-13367.93 1473,-13367.93 1473,-13315.93 1601,-13315.93 1601,-13367.93"/>
<text text-anchor="middle" x="1537" y="-13355.93" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1537" y="-13344.93" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-13333.93" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-13322.93" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer6_reshape&#45;&gt;gpu2_layer6_attn -->
<g id="edge778" class="edge">
<title>gpu2_layer6_reshape&#45;&gt;gpu2_layer6_attn</title>
<path fill="none" stroke="black" d="M1537,-13404.77C1537,-13396.47 1537,-13387.08 1537,-13378.18"/>
<polygon fill="black" stroke="black" points="1540.5,-13378.04 1537,-13368.04 1533.5,-13378.04 1540.5,-13378.04"/>
</g>
<!-- gpu2_layer6_attn_reshape -->
<g id="node625" class="node">
<title>gpu2_layer6_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1598,-13278.93 1476,-13278.93 1476,-13226.93 1598,-13226.93 1598,-13278.93"/>
<text text-anchor="middle" x="1537" y="-13266.93" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="1537" y="-13255.93" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-13244.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-13233.93" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer6_attn&#45;&gt;gpu2_layer6_attn_reshape -->
<g id="edge779" class="edge">
<title>gpu2_layer6_attn&#45;&gt;gpu2_layer6_attn_reshape</title>
<path fill="none" stroke="black" d="M1537,-13315.77C1537,-13307.47 1537,-13298.08 1537,-13289.18"/>
<polygon fill="black" stroke="black" points="1540.5,-13289.04 1537,-13279.04 1533.5,-13289.04 1540.5,-13289.04"/>
</g>
<!-- gpu2_layer6_attn_out -->
<g id="node624" class="node">
<title>gpu2_layer6_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1598,-13189.93 1476,-13189.93 1476,-13137.93 1598,-13137.93 1598,-13189.93"/>
<text text-anchor="middle" x="1537" y="-13177.93" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="1537" y="-13166.93" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-13155.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-13144.93" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer6_kv_update -->
<g id="node626" class="node">
<title>gpu2_layer6_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="1537" cy="-13064.16" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="1537" y="-13078.16" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="1537" y="-13067.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-13056.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-13045.16" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer6_attn_out&#45;&gt;gpu2_layer6_kv_update -->
<g id="edge781" class="edge">
<title>gpu2_layer6_attn_out&#45;&gt;gpu2_layer6_kv_update</title>
<path fill="none" stroke="black" d="M1537,-13137.75C1537,-13129.61 1537,-13120.32 1537,-13111.16"/>
<polygon fill="black" stroke="black" points="1540.5,-13110.94 1537,-13100.94 1533.5,-13110.94 1540.5,-13110.94"/>
</g>
<!-- gpu2_layer6_attn_reshape&#45;&gt;gpu2_layer6_attn_out -->
<g id="edge780" class="edge">
<title>gpu2_layer6_attn_reshape&#45;&gt;gpu2_layer6_attn_out</title>
<path fill="none" stroke="black" d="M1537,-13226.77C1537,-13218.47 1537,-13209.08 1537,-13200.18"/>
<polygon fill="black" stroke="black" points="1540.5,-13200.04 1537,-13190.04 1533.5,-13200.04 1540.5,-13200.04"/>
</g>
<!-- gpu2_layer6_res1 -->
<g id="node627" class="node">
<title>gpu2_layer6_res1</title>
<polygon fill="lightblue" stroke="black" points="1598,-12990.39 1476,-12990.39 1476,-12938.39 1598,-12938.39 1598,-12990.39"/>
<text text-anchor="middle" x="1537" y="-12978.39" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="1537" y="-12967.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-12956.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-12945.39" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer6_kv_update&#45;&gt;gpu2_layer6_res1 -->
<g id="edge782" class="edge">
<title>gpu2_layer6_kv_update&#45;&gt;gpu2_layer6_res1</title>
<path fill="none" stroke="black" d="M1537,-13027.31C1537,-13018.63 1537,-13009.36 1537,-13000.71"/>
<polygon fill="black" stroke="black" points="1540.5,-13000.54 1537,-12990.54 1533.5,-13000.54 1540.5,-13000.54"/>
</g>
<!-- gpu2_layer6_ln2 -->
<g id="node628" class="node">
<title>gpu2_layer6_ln2</title>
<polygon fill="lightblue" stroke="black" points="1598,-12901.39 1476,-12901.39 1476,-12849.39 1598,-12849.39 1598,-12901.39"/>
<text text-anchor="middle" x="1537" y="-12889.39" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="1537" y="-12878.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-12867.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-12856.39" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer6_res1&#45;&gt;gpu2_layer6_ln2 -->
<g id="edge783" class="edge">
<title>gpu2_layer6_res1&#45;&gt;gpu2_layer6_ln2</title>
<path fill="none" stroke="black" d="M1537,-12938.23C1537,-12929.93 1537,-12920.55 1537,-12911.64"/>
<polygon fill="black" stroke="black" points="1540.5,-12911.5 1537,-12901.5 1533.5,-12911.5 1540.5,-12911.5"/>
</g>
<!-- gpu2_layer6_routing -->
<g id="node629" class="node">
<title>gpu2_layer6_routing</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-12812.39 1462.29,-12812.39 1410.53,-12686.39 1611.71,-12686.39 1663.47,-12812.39"/>
<text text-anchor="middle" x="1537" y="-12768.89" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="1537" y="-12757.89" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-12746.89" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-12735.89" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="1537" y="-12724.89" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer6_ln2&#45;&gt;gpu2_layer6_routing -->
<g id="edge784" class="edge">
<title>gpu2_layer6_ln2&#45;&gt;gpu2_layer6_routing</title>
<path fill="none" stroke="black" d="M1537,-12849.3C1537,-12841.37 1537,-12832.17 1537,-12822.64"/>
<polygon fill="black" stroke="black" points="1540.5,-12822.63 1537,-12812.63 1533.5,-12822.63 1540.5,-12822.63"/>
</g>
<!-- gpu2_layer6_expert0 -->
<g id="node630" class="node">
<title>gpu2_layer6_expert0</title>
<polygon fill="lightblue" stroke="black" points="1318,-12640.39 1196,-12640.39 1196,-12588.39 1318,-12588.39 1318,-12640.39"/>
<text text-anchor="middle" x="1257" y="-12628.39" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1257" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer6_routing&#45;&gt;gpu2_layer6_expert0 -->
<g id="edge771" class="edge">
<title>gpu2_layer6_routing&#45;&gt;gpu2_layer6_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1411.33,-12688.7C1379.34,-12673.5 1346.34,-12657.83 1319.11,-12644.89"/>
<polygon fill="black" stroke="black" points="1320.26,-12641.57 1309.73,-12640.44 1317.26,-12647.89 1320.26,-12641.57"/>
<text text-anchor="middle" x="1393.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer6_expert1 -->
<g id="node631" class="node">
<title>gpu2_layer6_expert1</title>
<polygon fill="lightblue" stroke="black" points="1458,-12640.39 1336,-12640.39 1336,-12588.39 1458,-12588.39 1458,-12640.39"/>
<text text-anchor="middle" x="1397" y="-12628.39" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1397" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer6_routing&#45;&gt;gpu2_layer6_expert1 -->
<g id="edge772" class="edge">
<title>gpu2_layer6_routing&#45;&gt;gpu2_layer6_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1471.51,-12686.17C1457.48,-12672.85 1443.21,-12659.29 1430.97,-12647.66"/>
<polygon fill="black" stroke="black" points="1433.29,-12645.03 1423.63,-12640.68 1428.46,-12650.11 1433.29,-12645.03"/>
<text text-anchor="middle" x="1480.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer6_expert2 -->
<g id="node632" class="node">
<title>gpu2_layer6_expert2</title>
<polygon fill="lightblue" stroke="black" points="1598,-12640.39 1476,-12640.39 1476,-12588.39 1598,-12588.39 1598,-12640.39"/>
<text text-anchor="middle" x="1537" y="-12628.39" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="1537" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer6_routing&#45;&gt;gpu2_layer6_expert2 -->
<g id="edge773" class="edge">
<title>gpu2_layer6_routing&#45;&gt;gpu2_layer6_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1537,-12686.17C1537,-12674.11 1537,-12661.85 1537,-12651"/>
<polygon fill="black" stroke="black" points="1540.5,-12650.68 1537,-12640.68 1533.5,-12650.68 1540.5,-12650.68"/>
<text text-anchor="middle" x="1566.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer6_expert3 -->
<g id="node633" class="node">
<title>gpu2_layer6_expert3</title>
<polygon fill="lightblue" stroke="black" points="1738,-12640.39 1616,-12640.39 1616,-12588.39 1738,-12588.39 1738,-12640.39"/>
<text text-anchor="middle" x="1677" y="-12628.39" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1677" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer6_routing&#45;&gt;gpu2_layer6_expert3 -->
<g id="edge774" class="edge">
<title>gpu2_layer6_routing&#45;&gt;gpu2_layer6_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1602.49,-12686.17C1616.52,-12672.85 1630.79,-12659.29 1643.03,-12647.66"/>
<polygon fill="black" stroke="black" points="1645.54,-12650.11 1650.37,-12640.68 1640.71,-12645.03 1645.54,-12650.11"/>
<text text-anchor="middle" x="1661.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer6_expert_agg -->
<g id="node634" class="node">
<title>gpu2_layer6_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-12551.39 1462.29,-12551.39 1410.53,-12447.39 1611.71,-12447.39 1663.47,-12551.39"/>
<text text-anchor="middle" x="1537" y="-12513.39" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="1537" y="-12502.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-12491.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-12480.39" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer6_routing&#45;&gt;gpu2_layer6_expert_agg -->
<g id="edge789" class="edge">
<title>gpu2_layer6_routing&#45;&gt;gpu2_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M1626.22,-12721.47C1699.96,-12694.32 1786.6,-12647.92 1747,-12588.39 1726.44,-12557.48 1692.7,-12537.4 1658.22,-12524.38"/>
<polygon fill="black" stroke="black" points="1659.08,-12520.97 1648.48,-12520.88 1656.71,-12527.55 1659.08,-12520.97"/>
</g>
<!-- gpu2_layer6_expert0&#45;&gt;gpu2_layer6_expert_agg -->
<g id="edge785" class="edge">
<title>gpu2_layer6_expert0&#45;&gt;gpu2_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M1318.1,-12588.73C1354.98,-12573.85 1402.7,-12554.59 1444.16,-12537.86"/>
<polygon fill="black" stroke="black" points="1445.5,-12541.09 1453.46,-12534.11 1442.88,-12534.6 1445.5,-12541.09"/>
</g>
<!-- gpu2_layer6_expert1&#45;&gt;gpu2_layer6_expert_agg -->
<g id="edge786" class="edge">
<title>gpu2_layer6_expert1&#45;&gt;gpu2_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M1428.07,-12588.31C1439.32,-12579.24 1452.53,-12568.57 1465.8,-12557.86"/>
<polygon fill="black" stroke="black" points="1468.02,-12560.57 1473.6,-12551.56 1463.62,-12555.12 1468.02,-12560.57"/>
</g>
<!-- gpu2_layer6_expert2&#45;&gt;gpu2_layer6_expert_agg -->
<g id="edge787" class="edge">
<title>gpu2_layer6_expert2&#45;&gt;gpu2_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M1537,-12588.31C1537,-12580.39 1537,-12571.25 1537,-12561.93"/>
<polygon fill="black" stroke="black" points="1540.5,-12561.79 1537,-12551.79 1533.5,-12561.79 1540.5,-12561.79"/>
</g>
<!-- gpu2_layer6_expert3&#45;&gt;gpu2_layer6_expert_agg -->
<g id="edge788" class="edge">
<title>gpu2_layer6_expert3&#45;&gt;gpu2_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M1645.93,-12588.31C1634.68,-12579.24 1621.47,-12568.57 1608.2,-12557.86"/>
<polygon fill="black" stroke="black" points="1610.38,-12555.12 1600.4,-12551.56 1605.98,-12560.57 1610.38,-12555.12"/>
</g>
<!-- gpu2_layer6_res2 -->
<g id="node635" class="node">
<title>gpu2_layer6_res2</title>
<polygon fill="lightblue" stroke="black" points="1598,-12410.39 1476,-12410.39 1476,-12358.39 1598,-12358.39 1598,-12410.39"/>
<text text-anchor="middle" x="1537" y="-12398.39" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="1537" y="-12387.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-12376.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-12365.39" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer6_expert_agg&#45;&gt;gpu2_layer6_res2 -->
<g id="edge790" class="edge">
<title>gpu2_layer6_expert_agg&#45;&gt;gpu2_layer6_res2</title>
<path fill="none" stroke="black" d="M1537,-12447.18C1537,-12438.23 1537,-12429.1 1537,-12420.7"/>
<polygon fill="black" stroke="black" points="1540.5,-12420.52 1537,-12410.52 1533.5,-12420.52 1540.5,-12420.52"/>
</g>
<!-- gpu2_layer7_ln1 -->
<g id="node636" class="node">
<title>gpu2_layer7_ln1</title>
<polygon fill="lightblue" stroke="black" points="1598,-12321.39 1476,-12321.39 1476,-12269.39 1598,-12269.39 1598,-12321.39"/>
<text text-anchor="middle" x="1537" y="-12309.39" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="1537" y="-12298.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-12287.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-12276.39" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer6_res2&#45;&gt;gpu2_layer7_ln1 -->
<g id="edge795" class="edge">
<title>gpu2_layer6_res2&#45;&gt;gpu2_layer7_ln1</title>
<path fill="none" stroke="black" d="M1537,-12358.23C1537,-12349.93 1537,-12340.55 1537,-12331.64"/>
<polygon fill="black" stroke="black" points="1540.5,-12331.5 1537,-12321.5 1533.5,-12331.5 1540.5,-12331.5"/>
</g>
<!-- gpu2_layer7_qkv -->
<g id="node637" class="node">
<title>gpu2_layer7_qkv</title>
<polygon fill="lightblue" stroke="black" points="1598,-12232.39 1476,-12232.39 1476,-12180.39 1598,-12180.39 1598,-12232.39"/>
<text text-anchor="middle" x="1537" y="-12220.39" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1537" y="-12209.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-12198.39" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-12187.39" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer7_ln1&#45;&gt;gpu2_layer7_qkv -->
<g id="edge796" class="edge">
<title>gpu2_layer7_ln1&#45;&gt;gpu2_layer7_qkv</title>
<path fill="none" stroke="black" d="M1537,-12269.23C1537,-12260.93 1537,-12251.55 1537,-12242.64"/>
<polygon fill="black" stroke="black" points="1540.5,-12242.5 1537,-12232.5 1533.5,-12242.5 1540.5,-12242.5"/>
</g>
<!-- gpu2_layer7_reshape -->
<g id="node638" class="node">
<title>gpu2_layer7_reshape</title>
<polygon fill="lightblue" stroke="black" points="1601,-12143.39 1473,-12143.39 1473,-12091.39 1601,-12091.39 1601,-12143.39"/>
<text text-anchor="middle" x="1537" y="-12131.39" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="1537" y="-12120.39" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-12109.39" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-12098.39" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer7_qkv&#45;&gt;gpu2_layer7_reshape -->
<g id="edge797" class="edge">
<title>gpu2_layer7_qkv&#45;&gt;gpu2_layer7_reshape</title>
<path fill="none" stroke="black" d="M1537,-12180.23C1537,-12171.93 1537,-12162.55 1537,-12153.64"/>
<polygon fill="black" stroke="black" points="1540.5,-12153.5 1537,-12143.5 1533.5,-12153.5 1540.5,-12153.5"/>
</g>
<!-- gpu2_layer7_attn -->
<g id="node639" class="node">
<title>gpu2_layer7_attn</title>
<polygon fill="lightblue" stroke="black" points="1601,-12054.39 1473,-12054.39 1473,-12002.39 1601,-12002.39 1601,-12054.39"/>
<text text-anchor="middle" x="1537" y="-12042.39" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1537" y="-12031.39" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-12020.39" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-12009.39" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer7_reshape&#45;&gt;gpu2_layer7_attn -->
<g id="edge798" class="edge">
<title>gpu2_layer7_reshape&#45;&gt;gpu2_layer7_attn</title>
<path fill="none" stroke="black" d="M1537,-12091.23C1537,-12082.93 1537,-12073.55 1537,-12064.64"/>
<polygon fill="black" stroke="black" points="1540.5,-12064.5 1537,-12054.5 1533.5,-12064.5 1540.5,-12064.5"/>
</g>
<!-- gpu2_layer7_attn_reshape -->
<g id="node641" class="node">
<title>gpu2_layer7_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1598,-11965.39 1476,-11965.39 1476,-11913.39 1598,-11913.39 1598,-11965.39"/>
<text text-anchor="middle" x="1537" y="-11953.39" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="1537" y="-11942.39" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-11931.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-11920.39" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer7_attn&#45;&gt;gpu2_layer7_attn_reshape -->
<g id="edge799" class="edge">
<title>gpu2_layer7_attn&#45;&gt;gpu2_layer7_attn_reshape</title>
<path fill="none" stroke="black" d="M1537,-12002.23C1537,-11993.93 1537,-11984.55 1537,-11975.64"/>
<polygon fill="black" stroke="black" points="1540.5,-11975.5 1537,-11965.5 1533.5,-11975.5 1540.5,-11975.5"/>
</g>
<!-- gpu2_layer7_attn_out -->
<g id="node640" class="node">
<title>gpu2_layer7_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1598,-11876.39 1476,-11876.39 1476,-11824.39 1598,-11824.39 1598,-11876.39"/>
<text text-anchor="middle" x="1537" y="-11864.39" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="1537" y="-11853.39" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-11842.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-11831.39" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer7_kv_update -->
<g id="node642" class="node">
<title>gpu2_layer7_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="1537" cy="-11750.62" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="1537" y="-11764.62" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="1537" y="-11753.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-11742.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-11731.62" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer7_attn_out&#45;&gt;gpu2_layer7_kv_update -->
<g id="edge801" class="edge">
<title>gpu2_layer7_attn_out&#45;&gt;gpu2_layer7_kv_update</title>
<path fill="none" stroke="black" d="M1537,-11824.21C1537,-11816.07 1537,-11806.78 1537,-11797.62"/>
<polygon fill="black" stroke="black" points="1540.5,-11797.4 1537,-11787.4 1533.5,-11797.4 1540.5,-11797.4"/>
</g>
<!-- gpu2_layer7_attn_reshape&#45;&gt;gpu2_layer7_attn_out -->
<g id="edge800" class="edge">
<title>gpu2_layer7_attn_reshape&#45;&gt;gpu2_layer7_attn_out</title>
<path fill="none" stroke="black" d="M1537,-11913.23C1537,-11904.93 1537,-11895.55 1537,-11886.64"/>
<polygon fill="black" stroke="black" points="1540.5,-11886.5 1537,-11876.5 1533.5,-11886.5 1540.5,-11886.5"/>
</g>
<!-- gpu2_layer7_res1 -->
<g id="node643" class="node">
<title>gpu2_layer7_res1</title>
<polygon fill="lightblue" stroke="black" points="1598,-11676.85 1476,-11676.85 1476,-11624.85 1598,-11624.85 1598,-11676.85"/>
<text text-anchor="middle" x="1537" y="-11664.85" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="1537" y="-11653.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-11642.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-11631.85" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer7_kv_update&#45;&gt;gpu2_layer7_res1 -->
<g id="edge802" class="edge">
<title>gpu2_layer7_kv_update&#45;&gt;gpu2_layer7_res1</title>
<path fill="none" stroke="black" d="M1537,-11713.77C1537,-11705.09 1537,-11695.82 1537,-11687.17"/>
<polygon fill="black" stroke="black" points="1540.5,-11687 1537,-11677 1533.5,-11687 1540.5,-11687"/>
</g>
<!-- gpu2_layer7_ln2 -->
<g id="node644" class="node">
<title>gpu2_layer7_ln2</title>
<polygon fill="lightblue" stroke="black" points="1598,-11587.85 1476,-11587.85 1476,-11535.85 1598,-11535.85 1598,-11587.85"/>
<text text-anchor="middle" x="1537" y="-11575.85" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="1537" y="-11564.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-11553.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-11542.85" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer7_res1&#45;&gt;gpu2_layer7_ln2 -->
<g id="edge803" class="edge">
<title>gpu2_layer7_res1&#45;&gt;gpu2_layer7_ln2</title>
<path fill="none" stroke="black" d="M1537,-11624.69C1537,-11616.39 1537,-11607.01 1537,-11598.1"/>
<polygon fill="black" stroke="black" points="1540.5,-11597.96 1537,-11587.96 1533.5,-11597.96 1540.5,-11597.96"/>
</g>
<!-- gpu2_layer7_routing -->
<g id="node645" class="node">
<title>gpu2_layer7_routing</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-11498.85 1462.29,-11498.85 1410.53,-11372.85 1611.71,-11372.85 1663.47,-11498.85"/>
<text text-anchor="middle" x="1537" y="-11455.35" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="1537" y="-11444.35" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-11433.35" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-11422.35" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="1537" y="-11411.35" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer7_ln2&#45;&gt;gpu2_layer7_routing -->
<g id="edge804" class="edge">
<title>gpu2_layer7_ln2&#45;&gt;gpu2_layer7_routing</title>
<path fill="none" stroke="black" d="M1537,-11535.76C1537,-11527.83 1537,-11518.63 1537,-11509.1"/>
<polygon fill="black" stroke="black" points="1540.5,-11509.09 1537,-11499.09 1533.5,-11509.09 1540.5,-11509.09"/>
</g>
<!-- gpu2_layer7_expert0 -->
<g id="node646" class="node">
<title>gpu2_layer7_expert0</title>
<polygon fill="lightblue" stroke="black" points="1318,-11326.85 1196,-11326.85 1196,-11274.85 1318,-11274.85 1318,-11326.85"/>
<text text-anchor="middle" x="1257" y="-11314.85" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1257" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer7_routing&#45;&gt;gpu2_layer7_expert0 -->
<g id="edge791" class="edge">
<title>gpu2_layer7_routing&#45;&gt;gpu2_layer7_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1411.33,-11375.16C1379.34,-11359.96 1346.34,-11344.29 1319.11,-11331.35"/>
<polygon fill="black" stroke="black" points="1320.26,-11328.03 1309.73,-11326.9 1317.26,-11334.35 1320.26,-11328.03"/>
<text text-anchor="middle" x="1393.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer7_expert1 -->
<g id="node647" class="node">
<title>gpu2_layer7_expert1</title>
<polygon fill="lightblue" stroke="black" points="1458,-11326.85 1336,-11326.85 1336,-11274.85 1458,-11274.85 1458,-11326.85"/>
<text text-anchor="middle" x="1397" y="-11314.85" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1397" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer7_routing&#45;&gt;gpu2_layer7_expert1 -->
<g id="edge792" class="edge">
<title>gpu2_layer7_routing&#45;&gt;gpu2_layer7_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1471.51,-11372.64C1457.48,-11359.31 1443.21,-11345.76 1430.97,-11334.12"/>
<polygon fill="black" stroke="black" points="1433.29,-11331.5 1423.63,-11327.15 1428.46,-11336.57 1433.29,-11331.5"/>
<text text-anchor="middle" x="1480.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer7_expert2 -->
<g id="node648" class="node">
<title>gpu2_layer7_expert2</title>
<polygon fill="lightblue" stroke="black" points="1598,-11326.85 1476,-11326.85 1476,-11274.85 1598,-11274.85 1598,-11326.85"/>
<text text-anchor="middle" x="1537" y="-11314.85" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="1537" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer7_routing&#45;&gt;gpu2_layer7_expert2 -->
<g id="edge793" class="edge">
<title>gpu2_layer7_routing&#45;&gt;gpu2_layer7_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1537,-11372.64C1537,-11360.57 1537,-11348.31 1537,-11337.46"/>
<polygon fill="black" stroke="black" points="1540.5,-11337.15 1537,-11327.15 1533.5,-11337.15 1540.5,-11337.15"/>
<text text-anchor="middle" x="1566.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer7_expert3 -->
<g id="node649" class="node">
<title>gpu2_layer7_expert3</title>
<polygon fill="lightblue" stroke="black" points="1738,-11326.85 1616,-11326.85 1616,-11274.85 1738,-11274.85 1738,-11326.85"/>
<text text-anchor="middle" x="1677" y="-11314.85" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1677" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer7_routing&#45;&gt;gpu2_layer7_expert3 -->
<g id="edge794" class="edge">
<title>gpu2_layer7_routing&#45;&gt;gpu2_layer7_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1602.49,-11372.64C1616.52,-11359.31 1630.79,-11345.76 1643.03,-11334.12"/>
<polygon fill="black" stroke="black" points="1645.54,-11336.57 1650.37,-11327.15 1640.71,-11331.5 1645.54,-11336.57"/>
<text text-anchor="middle" x="1661.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer7_expert_agg -->
<g id="node650" class="node">
<title>gpu2_layer7_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-11237.85 1462.29,-11237.85 1410.53,-11133.85 1611.71,-11133.85 1663.47,-11237.85"/>
<text text-anchor="middle" x="1537" y="-11199.85" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="1537" y="-11188.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-11177.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-11166.85" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer7_routing&#45;&gt;gpu2_layer7_expert_agg -->
<g id="edge809" class="edge">
<title>gpu2_layer7_routing&#45;&gt;gpu2_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M1626.22,-11407.94C1699.96,-11380.78 1786.6,-11334.39 1747,-11274.85 1726.44,-11243.94 1692.7,-11223.87 1658.22,-11210.84"/>
<polygon fill="black" stroke="black" points="1659.08,-11207.43 1648.48,-11207.35 1656.71,-11214.02 1659.08,-11207.43"/>
</g>
<!-- gpu2_layer7_expert0&#45;&gt;gpu2_layer7_expert_agg -->
<g id="edge805" class="edge">
<title>gpu2_layer7_expert0&#45;&gt;gpu2_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M1318.1,-11275.19C1354.98,-11260.31 1402.7,-11241.05 1444.16,-11224.32"/>
<polygon fill="black" stroke="black" points="1445.5,-11227.56 1453.46,-11220.57 1442.88,-11221.06 1445.5,-11227.56"/>
</g>
<!-- gpu2_layer7_expert1&#45;&gt;gpu2_layer7_expert_agg -->
<g id="edge806" class="edge">
<title>gpu2_layer7_expert1&#45;&gt;gpu2_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M1428.07,-11274.77C1439.32,-11265.7 1452.53,-11255.03 1465.8,-11244.32"/>
<polygon fill="black" stroke="black" points="1468.02,-11247.03 1473.6,-11238.02 1463.62,-11241.58 1468.02,-11247.03"/>
</g>
<!-- gpu2_layer7_expert2&#45;&gt;gpu2_layer7_expert_agg -->
<g id="edge807" class="edge">
<title>gpu2_layer7_expert2&#45;&gt;gpu2_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M1537,-11274.77C1537,-11266.85 1537,-11257.71 1537,-11248.39"/>
<polygon fill="black" stroke="black" points="1540.5,-11248.25 1537,-11238.25 1533.5,-11248.25 1540.5,-11248.25"/>
</g>
<!-- gpu2_layer7_expert3&#45;&gt;gpu2_layer7_expert_agg -->
<g id="edge808" class="edge">
<title>gpu2_layer7_expert3&#45;&gt;gpu2_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M1645.93,-11274.77C1634.68,-11265.7 1621.47,-11255.03 1608.2,-11244.32"/>
<polygon fill="black" stroke="black" points="1610.38,-11241.58 1600.4,-11238.02 1605.98,-11247.03 1610.38,-11241.58"/>
</g>
<!-- gpu2_layer7_res2 -->
<g id="node651" class="node">
<title>gpu2_layer7_res2</title>
<polygon fill="lightblue" stroke="black" points="1598,-11096.85 1476,-11096.85 1476,-11044.85 1598,-11044.85 1598,-11096.85"/>
<text text-anchor="middle" x="1537" y="-11084.85" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="1537" y="-11073.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-11062.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-11051.85" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer7_expert_agg&#45;&gt;gpu2_layer7_res2 -->
<g id="edge810" class="edge">
<title>gpu2_layer7_expert_agg&#45;&gt;gpu2_layer7_res2</title>
<path fill="none" stroke="black" d="M1537,-11133.64C1537,-11124.69 1537,-11115.56 1537,-11107.16"/>
<polygon fill="black" stroke="black" points="1540.5,-11106.98 1537,-11096.98 1533.5,-11106.98 1540.5,-11106.98"/>
</g>
<!-- gpu2_layer8_ln1 -->
<g id="node652" class="node">
<title>gpu2_layer8_ln1</title>
<polygon fill="lightblue" stroke="black" points="1598,-11007.85 1476,-11007.85 1476,-10955.85 1598,-10955.85 1598,-11007.85"/>
<text text-anchor="middle" x="1537" y="-10995.85" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="1537" y="-10984.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-10973.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-10962.85" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer7_res2&#45;&gt;gpu2_layer8_ln1 -->
<g id="edge815" class="edge">
<title>gpu2_layer7_res2&#45;&gt;gpu2_layer8_ln1</title>
<path fill="none" stroke="black" d="M1537,-11044.69C1537,-11036.39 1537,-11027.01 1537,-11018.1"/>
<polygon fill="black" stroke="black" points="1540.5,-11017.96 1537,-11007.96 1533.5,-11017.96 1540.5,-11017.96"/>
</g>
<!-- gpu2_layer8_qkv -->
<g id="node653" class="node">
<title>gpu2_layer8_qkv</title>
<polygon fill="lightblue" stroke="black" points="1598,-10918.85 1476,-10918.85 1476,-10866.85 1598,-10866.85 1598,-10918.85"/>
<text text-anchor="middle" x="1537" y="-10906.85" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1537" y="-10895.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-10884.85" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-10873.85" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer8_ln1&#45;&gt;gpu2_layer8_qkv -->
<g id="edge816" class="edge">
<title>gpu2_layer8_ln1&#45;&gt;gpu2_layer8_qkv</title>
<path fill="none" stroke="black" d="M1537,-10955.69C1537,-10947.39 1537,-10938.01 1537,-10929.1"/>
<polygon fill="black" stroke="black" points="1540.5,-10928.96 1537,-10918.96 1533.5,-10928.96 1540.5,-10928.96"/>
</g>
<!-- gpu2_layer8_reshape -->
<g id="node654" class="node">
<title>gpu2_layer8_reshape</title>
<polygon fill="lightblue" stroke="black" points="1601,-10829.85 1473,-10829.85 1473,-10777.85 1601,-10777.85 1601,-10829.85"/>
<text text-anchor="middle" x="1537" y="-10817.85" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="1537" y="-10806.85" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-10795.85" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-10784.85" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer8_qkv&#45;&gt;gpu2_layer8_reshape -->
<g id="edge817" class="edge">
<title>gpu2_layer8_qkv&#45;&gt;gpu2_layer8_reshape</title>
<path fill="none" stroke="black" d="M1537,-10866.69C1537,-10858.39 1537,-10849.01 1537,-10840.1"/>
<polygon fill="black" stroke="black" points="1540.5,-10839.96 1537,-10829.96 1533.5,-10839.96 1540.5,-10839.96"/>
</g>
<!-- gpu2_layer8_attn -->
<g id="node655" class="node">
<title>gpu2_layer8_attn</title>
<polygon fill="lightblue" stroke="black" points="1601,-10740.85 1473,-10740.85 1473,-10688.85 1601,-10688.85 1601,-10740.85"/>
<text text-anchor="middle" x="1537" y="-10728.85" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1537" y="-10717.85" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-10706.85" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-10695.85" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer8_reshape&#45;&gt;gpu2_layer8_attn -->
<g id="edge818" class="edge">
<title>gpu2_layer8_reshape&#45;&gt;gpu2_layer8_attn</title>
<path fill="none" stroke="black" d="M1537,-10777.69C1537,-10769.39 1537,-10760.01 1537,-10751.1"/>
<polygon fill="black" stroke="black" points="1540.5,-10750.96 1537,-10740.96 1533.5,-10750.96 1540.5,-10750.96"/>
</g>
<!-- gpu2_layer8_attn_reshape -->
<g id="node657" class="node">
<title>gpu2_layer8_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1598,-10651.85 1476,-10651.85 1476,-10599.85 1598,-10599.85 1598,-10651.85"/>
<text text-anchor="middle" x="1537" y="-10639.85" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="1537" y="-10628.85" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-10617.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-10606.85" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer8_attn&#45;&gt;gpu2_layer8_attn_reshape -->
<g id="edge819" class="edge">
<title>gpu2_layer8_attn&#45;&gt;gpu2_layer8_attn_reshape</title>
<path fill="none" stroke="black" d="M1537,-10688.69C1537,-10680.39 1537,-10671.01 1537,-10662.1"/>
<polygon fill="black" stroke="black" points="1540.5,-10661.96 1537,-10651.96 1533.5,-10661.96 1540.5,-10661.96"/>
</g>
<!-- gpu2_layer8_attn_out -->
<g id="node656" class="node">
<title>gpu2_layer8_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1598,-10562.85 1476,-10562.85 1476,-10510.85 1598,-10510.85 1598,-10562.85"/>
<text text-anchor="middle" x="1537" y="-10550.85" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="1537" y="-10539.85" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-10528.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-10517.85" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer8_kv_update -->
<g id="node658" class="node">
<title>gpu2_layer8_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="1537" cy="-10437.08" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="1537" y="-10451.08" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="1537" y="-10440.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-10429.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-10418.08" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer8_attn_out&#45;&gt;gpu2_layer8_kv_update -->
<g id="edge821" class="edge">
<title>gpu2_layer8_attn_out&#45;&gt;gpu2_layer8_kv_update</title>
<path fill="none" stroke="black" d="M1537,-10510.67C1537,-10502.53 1537,-10493.24 1537,-10484.08"/>
<polygon fill="black" stroke="black" points="1540.5,-10483.86 1537,-10473.86 1533.5,-10483.86 1540.5,-10483.86"/>
</g>
<!-- gpu2_layer8_attn_reshape&#45;&gt;gpu2_layer8_attn_out -->
<g id="edge820" class="edge">
<title>gpu2_layer8_attn_reshape&#45;&gt;gpu2_layer8_attn_out</title>
<path fill="none" stroke="black" d="M1537,-10599.69C1537,-10591.39 1537,-10582.01 1537,-10573.1"/>
<polygon fill="black" stroke="black" points="1540.5,-10572.96 1537,-10562.96 1533.5,-10572.96 1540.5,-10572.96"/>
</g>
<!-- gpu2_layer8_res1 -->
<g id="node659" class="node">
<title>gpu2_layer8_res1</title>
<polygon fill="lightblue" stroke="black" points="1598,-10363.31 1476,-10363.31 1476,-10311.31 1598,-10311.31 1598,-10363.31"/>
<text text-anchor="middle" x="1537" y="-10351.31" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="1537" y="-10340.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-10329.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-10318.31" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer8_kv_update&#45;&gt;gpu2_layer8_res1 -->
<g id="edge822" class="edge">
<title>gpu2_layer8_kv_update&#45;&gt;gpu2_layer8_res1</title>
<path fill="none" stroke="black" d="M1537,-10400.23C1537,-10391.55 1537,-10382.28 1537,-10373.63"/>
<polygon fill="black" stroke="black" points="1540.5,-10373.46 1537,-10363.46 1533.5,-10373.46 1540.5,-10373.46"/>
</g>
<!-- gpu2_layer8_ln2 -->
<g id="node660" class="node">
<title>gpu2_layer8_ln2</title>
<polygon fill="lightblue" stroke="black" points="1598,-10274.31 1476,-10274.31 1476,-10222.31 1598,-10222.31 1598,-10274.31"/>
<text text-anchor="middle" x="1537" y="-10262.31" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="1537" y="-10251.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-10240.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-10229.31" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer8_res1&#45;&gt;gpu2_layer8_ln2 -->
<g id="edge823" class="edge">
<title>gpu2_layer8_res1&#45;&gt;gpu2_layer8_ln2</title>
<path fill="none" stroke="black" d="M1537,-10311.15C1537,-10302.85 1537,-10293.47 1537,-10284.56"/>
<polygon fill="black" stroke="black" points="1540.5,-10284.42 1537,-10274.42 1533.5,-10284.42 1540.5,-10284.42"/>
</g>
<!-- gpu2_layer8_routing -->
<g id="node661" class="node">
<title>gpu2_layer8_routing</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-10185.31 1462.29,-10185.31 1410.53,-10059.31 1611.71,-10059.31 1663.47,-10185.31"/>
<text text-anchor="middle" x="1537" y="-10141.81" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="1537" y="-10130.81" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-10119.81" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-10108.81" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="1537" y="-10097.81" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer8_ln2&#45;&gt;gpu2_layer8_routing -->
<g id="edge824" class="edge">
<title>gpu2_layer8_ln2&#45;&gt;gpu2_layer8_routing</title>
<path fill="none" stroke="black" d="M1537,-10222.22C1537,-10214.29 1537,-10205.09 1537,-10195.56"/>
<polygon fill="black" stroke="black" points="1540.5,-10195.55 1537,-10185.55 1533.5,-10195.55 1540.5,-10195.55"/>
</g>
<!-- gpu2_layer8_expert0 -->
<g id="node662" class="node">
<title>gpu2_layer8_expert0</title>
<polygon fill="lightblue" stroke="black" points="1318,-10013.31 1196,-10013.31 1196,-9961.31 1318,-9961.31 1318,-10013.31"/>
<text text-anchor="middle" x="1257" y="-10001.31" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1257" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer8_routing&#45;&gt;gpu2_layer8_expert0 -->
<g id="edge811" class="edge">
<title>gpu2_layer8_routing&#45;&gt;gpu2_layer8_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1411.33,-10061.62C1379.34,-10046.42 1346.34,-10030.75 1319.11,-10017.81"/>
<polygon fill="black" stroke="black" points="1320.26,-10014.49 1309.73,-10013.36 1317.26,-10020.81 1320.26,-10014.49"/>
<text text-anchor="middle" x="1393.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer8_expert1 -->
<g id="node663" class="node">
<title>gpu2_layer8_expert1</title>
<polygon fill="lightblue" stroke="black" points="1458,-10013.31 1336,-10013.31 1336,-9961.31 1458,-9961.31 1458,-10013.31"/>
<text text-anchor="middle" x="1397" y="-10001.31" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1397" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer8_routing&#45;&gt;gpu2_layer8_expert1 -->
<g id="edge812" class="edge">
<title>gpu2_layer8_routing&#45;&gt;gpu2_layer8_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1471.51,-10059.1C1457.48,-10045.77 1443.21,-10032.22 1430.97,-10020.58"/>
<polygon fill="black" stroke="black" points="1433.29,-10017.96 1423.63,-10013.61 1428.46,-10023.03 1433.29,-10017.96"/>
<text text-anchor="middle" x="1480.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer8_expert2 -->
<g id="node664" class="node">
<title>gpu2_layer8_expert2</title>
<polygon fill="lightblue" stroke="black" points="1598,-10013.31 1476,-10013.31 1476,-9961.31 1598,-9961.31 1598,-10013.31"/>
<text text-anchor="middle" x="1537" y="-10001.31" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="1537" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer8_routing&#45;&gt;gpu2_layer8_expert2 -->
<g id="edge813" class="edge">
<title>gpu2_layer8_routing&#45;&gt;gpu2_layer8_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1537,-10059.1C1537,-10047.03 1537,-10034.77 1537,-10023.92"/>
<polygon fill="black" stroke="black" points="1540.5,-10023.61 1537,-10013.61 1533.5,-10023.61 1540.5,-10023.61"/>
<text text-anchor="middle" x="1566.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer8_expert3 -->
<g id="node665" class="node">
<title>gpu2_layer8_expert3</title>
<polygon fill="lightblue" stroke="black" points="1738,-10013.31 1616,-10013.31 1616,-9961.31 1738,-9961.31 1738,-10013.31"/>
<text text-anchor="middle" x="1677" y="-10001.31" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1677" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer8_routing&#45;&gt;gpu2_layer8_expert3 -->
<g id="edge814" class="edge">
<title>gpu2_layer8_routing&#45;&gt;gpu2_layer8_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1602.49,-10059.1C1616.52,-10045.77 1630.79,-10032.22 1643.03,-10020.58"/>
<polygon fill="black" stroke="black" points="1645.54,-10023.03 1650.37,-10013.61 1640.71,-10017.96 1645.54,-10023.03"/>
<text text-anchor="middle" x="1661.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer8_expert_agg -->
<g id="node666" class="node">
<title>gpu2_layer8_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-9924.31 1462.29,-9924.31 1410.53,-9820.31 1611.71,-9820.31 1663.47,-9924.31"/>
<text text-anchor="middle" x="1537" y="-9886.31" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="1537" y="-9875.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-9864.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-9853.31" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer8_routing&#45;&gt;gpu2_layer8_expert_agg -->
<g id="edge829" class="edge">
<title>gpu2_layer8_routing&#45;&gt;gpu2_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M1626.22,-10094.4C1699.96,-10067.24 1786.6,-10020.85 1747,-9961.31 1726.44,-9930.4 1692.7,-9910.33 1658.22,-9897.3"/>
<polygon fill="black" stroke="black" points="1659.08,-9893.89 1648.48,-9893.81 1656.71,-9900.48 1659.08,-9893.89"/>
</g>
<!-- gpu2_layer8_expert0&#45;&gt;gpu2_layer8_expert_agg -->
<g id="edge825" class="edge">
<title>gpu2_layer8_expert0&#45;&gt;gpu2_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M1318.1,-9961.65C1354.98,-9946.77 1402.7,-9927.51 1444.16,-9910.78"/>
<polygon fill="black" stroke="black" points="1445.5,-9914.02 1453.46,-9907.03 1442.88,-9907.52 1445.5,-9914.02"/>
</g>
<!-- gpu2_layer8_expert1&#45;&gt;gpu2_layer8_expert_agg -->
<g id="edge826" class="edge">
<title>gpu2_layer8_expert1&#45;&gt;gpu2_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M1428.07,-9961.23C1439.32,-9952.16 1452.53,-9941.49 1465.8,-9930.78"/>
<polygon fill="black" stroke="black" points="1468.02,-9933.49 1473.6,-9924.48 1463.62,-9928.04 1468.02,-9933.49"/>
</g>
<!-- gpu2_layer8_expert2&#45;&gt;gpu2_layer8_expert_agg -->
<g id="edge827" class="edge">
<title>gpu2_layer8_expert2&#45;&gt;gpu2_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M1537,-9961.23C1537,-9953.31 1537,-9944.17 1537,-9934.85"/>
<polygon fill="black" stroke="black" points="1540.5,-9934.71 1537,-9924.71 1533.5,-9934.71 1540.5,-9934.71"/>
</g>
<!-- gpu2_layer8_expert3&#45;&gt;gpu2_layer8_expert_agg -->
<g id="edge828" class="edge">
<title>gpu2_layer8_expert3&#45;&gt;gpu2_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M1645.93,-9961.23C1634.68,-9952.16 1621.47,-9941.49 1608.2,-9930.78"/>
<polygon fill="black" stroke="black" points="1610.38,-9928.04 1600.4,-9924.48 1605.98,-9933.49 1610.38,-9928.04"/>
</g>
<!-- gpu2_layer8_res2 -->
<g id="node667" class="node">
<title>gpu2_layer8_res2</title>
<polygon fill="lightblue" stroke="black" points="1598,-9783.31 1476,-9783.31 1476,-9731.31 1598,-9731.31 1598,-9783.31"/>
<text text-anchor="middle" x="1537" y="-9771.31" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="1537" y="-9760.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-9749.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-9738.31" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer8_expert_agg&#45;&gt;gpu2_layer8_res2 -->
<g id="edge830" class="edge">
<title>gpu2_layer8_expert_agg&#45;&gt;gpu2_layer8_res2</title>
<path fill="none" stroke="black" d="M1537,-9820.1C1537,-9811.15 1537,-9802.02 1537,-9793.62"/>
<polygon fill="black" stroke="black" points="1540.5,-9793.44 1537,-9783.44 1533.5,-9793.44 1540.5,-9793.44"/>
</g>
<!-- gpu2_layer9_ln1 -->
<g id="node668" class="node">
<title>gpu2_layer9_ln1</title>
<polygon fill="lightblue" stroke="black" points="1598,-9694.31 1476,-9694.31 1476,-9642.31 1598,-9642.31 1598,-9694.31"/>
<text text-anchor="middle" x="1537" y="-9682.31" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="1537" y="-9671.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-9660.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-9649.31" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer8_res2&#45;&gt;gpu2_layer9_ln1 -->
<g id="edge835" class="edge">
<title>gpu2_layer8_res2&#45;&gt;gpu2_layer9_ln1</title>
<path fill="none" stroke="black" d="M1537,-9731.15C1537,-9722.85 1537,-9713.47 1537,-9704.56"/>
<polygon fill="black" stroke="black" points="1540.5,-9704.42 1537,-9694.42 1533.5,-9704.42 1540.5,-9704.42"/>
</g>
<!-- gpu2_layer9_qkv -->
<g id="node669" class="node">
<title>gpu2_layer9_qkv</title>
<polygon fill="lightblue" stroke="black" points="1598,-9605.31 1476,-9605.31 1476,-9553.31 1598,-9553.31 1598,-9605.31"/>
<text text-anchor="middle" x="1537" y="-9593.31" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1537" y="-9582.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-9571.31" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-9560.31" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer9_ln1&#45;&gt;gpu2_layer9_qkv -->
<g id="edge836" class="edge">
<title>gpu2_layer9_ln1&#45;&gt;gpu2_layer9_qkv</title>
<path fill="none" stroke="black" d="M1537,-9642.15C1537,-9633.85 1537,-9624.47 1537,-9615.56"/>
<polygon fill="black" stroke="black" points="1540.5,-9615.42 1537,-9605.42 1533.5,-9615.42 1540.5,-9615.42"/>
</g>
<!-- gpu2_layer9_reshape -->
<g id="node670" class="node">
<title>gpu2_layer9_reshape</title>
<polygon fill="lightblue" stroke="black" points="1601,-9516.31 1473,-9516.31 1473,-9464.31 1601,-9464.31 1601,-9516.31"/>
<text text-anchor="middle" x="1537" y="-9504.31" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="1537" y="-9493.31" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-9482.31" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-9471.31" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer9_qkv&#45;&gt;gpu2_layer9_reshape -->
<g id="edge837" class="edge">
<title>gpu2_layer9_qkv&#45;&gt;gpu2_layer9_reshape</title>
<path fill="none" stroke="black" d="M1537,-9553.15C1537,-9544.85 1537,-9535.47 1537,-9526.56"/>
<polygon fill="black" stroke="black" points="1540.5,-9526.42 1537,-9516.42 1533.5,-9526.42 1540.5,-9526.42"/>
</g>
<!-- gpu2_layer9_attn -->
<g id="node671" class="node">
<title>gpu2_layer9_attn</title>
<polygon fill="lightblue" stroke="black" points="1601,-9427.31 1473,-9427.31 1473,-9375.31 1601,-9375.31 1601,-9427.31"/>
<text text-anchor="middle" x="1537" y="-9415.31" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1537" y="-9404.31" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-9393.31" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-9382.31" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer9_reshape&#45;&gt;gpu2_layer9_attn -->
<g id="edge838" class="edge">
<title>gpu2_layer9_reshape&#45;&gt;gpu2_layer9_attn</title>
<path fill="none" stroke="black" d="M1537,-9464.15C1537,-9455.85 1537,-9446.47 1537,-9437.56"/>
<polygon fill="black" stroke="black" points="1540.5,-9437.42 1537,-9427.42 1533.5,-9437.42 1540.5,-9437.42"/>
</g>
<!-- gpu2_layer9_attn_reshape -->
<g id="node673" class="node">
<title>gpu2_layer9_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1598,-9338.31 1476,-9338.31 1476,-9286.31 1598,-9286.31 1598,-9338.31"/>
<text text-anchor="middle" x="1537" y="-9326.31" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="1537" y="-9315.31" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-9304.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-9293.31" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer9_attn&#45;&gt;gpu2_layer9_attn_reshape -->
<g id="edge839" class="edge">
<title>gpu2_layer9_attn&#45;&gt;gpu2_layer9_attn_reshape</title>
<path fill="none" stroke="black" d="M1537,-9375.15C1537,-9366.85 1537,-9357.47 1537,-9348.56"/>
<polygon fill="black" stroke="black" points="1540.5,-9348.42 1537,-9338.42 1533.5,-9348.42 1540.5,-9348.42"/>
</g>
<!-- gpu2_layer9_attn_out -->
<g id="node672" class="node">
<title>gpu2_layer9_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1598,-9249.31 1476,-9249.31 1476,-9197.31 1598,-9197.31 1598,-9249.31"/>
<text text-anchor="middle" x="1537" y="-9237.31" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="1537" y="-9226.31" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-9215.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-9204.31" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer9_kv_update -->
<g id="node674" class="node">
<title>gpu2_layer9_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="1537" cy="-9123.54" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="1537" y="-9137.54" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="1537" y="-9126.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-9115.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-9104.54" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer9_attn_out&#45;&gt;gpu2_layer9_kv_update -->
<g id="edge841" class="edge">
<title>gpu2_layer9_attn_out&#45;&gt;gpu2_layer9_kv_update</title>
<path fill="none" stroke="black" d="M1537,-9197.13C1537,-9189 1537,-9179.7 1537,-9170.54"/>
<polygon fill="black" stroke="black" points="1540.5,-9170.32 1537,-9160.32 1533.5,-9170.32 1540.5,-9170.32"/>
</g>
<!-- gpu2_layer9_attn_reshape&#45;&gt;gpu2_layer9_attn_out -->
<g id="edge840" class="edge">
<title>gpu2_layer9_attn_reshape&#45;&gt;gpu2_layer9_attn_out</title>
<path fill="none" stroke="black" d="M1537,-9286.15C1537,-9277.85 1537,-9268.47 1537,-9259.56"/>
<polygon fill="black" stroke="black" points="1540.5,-9259.42 1537,-9249.42 1533.5,-9259.42 1540.5,-9259.42"/>
</g>
<!-- gpu2_layer9_res1 -->
<g id="node675" class="node">
<title>gpu2_layer9_res1</title>
<polygon fill="lightblue" stroke="black" points="1598,-9049.77 1476,-9049.77 1476,-8997.77 1598,-8997.77 1598,-9049.77"/>
<text text-anchor="middle" x="1537" y="-9037.77" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="1537" y="-9026.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-9015.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-9004.77" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer9_kv_update&#45;&gt;gpu2_layer9_res1 -->
<g id="edge842" class="edge">
<title>gpu2_layer9_kv_update&#45;&gt;gpu2_layer9_res1</title>
<path fill="none" stroke="black" d="M1537,-9086.69C1537,-9078.01 1537,-9068.74 1537,-9060.09"/>
<polygon fill="black" stroke="black" points="1540.5,-9059.92 1537,-9049.92 1533.5,-9059.92 1540.5,-9059.92"/>
</g>
<!-- gpu2_layer9_ln2 -->
<g id="node676" class="node">
<title>gpu2_layer9_ln2</title>
<polygon fill="lightblue" stroke="black" points="1598,-8960.77 1476,-8960.77 1476,-8908.77 1598,-8908.77 1598,-8960.77"/>
<text text-anchor="middle" x="1537" y="-8948.77" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="1537" y="-8937.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-8926.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-8915.77" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer9_res1&#45;&gt;gpu2_layer9_ln2 -->
<g id="edge843" class="edge">
<title>gpu2_layer9_res1&#45;&gt;gpu2_layer9_ln2</title>
<path fill="none" stroke="black" d="M1537,-8997.61C1537,-8989.31 1537,-8979.93 1537,-8971.02"/>
<polygon fill="black" stroke="black" points="1540.5,-8970.88 1537,-8960.88 1533.5,-8970.88 1540.5,-8970.88"/>
</g>
<!-- gpu2_layer9_routing -->
<g id="node677" class="node">
<title>gpu2_layer9_routing</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-8871.77 1462.29,-8871.77 1410.53,-8745.77 1611.71,-8745.77 1663.47,-8871.77"/>
<text text-anchor="middle" x="1537" y="-8828.27" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="1537" y="-8817.27" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-8806.27" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-8795.27" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="1537" y="-8784.27" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer9_ln2&#45;&gt;gpu2_layer9_routing -->
<g id="edge844" class="edge">
<title>gpu2_layer9_ln2&#45;&gt;gpu2_layer9_routing</title>
<path fill="none" stroke="black" d="M1537,-8908.68C1537,-8900.75 1537,-8891.55 1537,-8882.02"/>
<polygon fill="black" stroke="black" points="1540.5,-8882.01 1537,-8872.01 1533.5,-8882.01 1540.5,-8882.01"/>
</g>
<!-- gpu2_layer9_expert0 -->
<g id="node678" class="node">
<title>gpu2_layer9_expert0</title>
<polygon fill="lightblue" stroke="black" points="1318,-8699.77 1196,-8699.77 1196,-8647.77 1318,-8647.77 1318,-8699.77"/>
<text text-anchor="middle" x="1257" y="-8687.77" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1257" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer9_routing&#45;&gt;gpu2_layer9_expert0 -->
<g id="edge831" class="edge">
<title>gpu2_layer9_routing&#45;&gt;gpu2_layer9_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1411.33,-8748.08C1379.34,-8732.89 1346.34,-8717.21 1319.11,-8704.27"/>
<polygon fill="black" stroke="black" points="1320.26,-8700.95 1309.73,-8699.82 1317.26,-8707.27 1320.26,-8700.95"/>
<text text-anchor="middle" x="1393.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer9_expert1 -->
<g id="node679" class="node">
<title>gpu2_layer9_expert1</title>
<polygon fill="lightblue" stroke="black" points="1458,-8699.77 1336,-8699.77 1336,-8647.77 1458,-8647.77 1458,-8699.77"/>
<text text-anchor="middle" x="1397" y="-8687.77" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1397" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer9_routing&#45;&gt;gpu2_layer9_expert1 -->
<g id="edge832" class="edge">
<title>gpu2_layer9_routing&#45;&gt;gpu2_layer9_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1471.51,-8745.56C1457.48,-8732.23 1443.21,-8718.68 1430.97,-8707.04"/>
<polygon fill="black" stroke="black" points="1433.29,-8704.42 1423.63,-8700.07 1428.46,-8709.49 1433.29,-8704.42"/>
<text text-anchor="middle" x="1480.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer9_expert2 -->
<g id="node680" class="node">
<title>gpu2_layer9_expert2</title>
<polygon fill="lightblue" stroke="black" points="1598,-8699.77 1476,-8699.77 1476,-8647.77 1598,-8647.77 1598,-8699.77"/>
<text text-anchor="middle" x="1537" y="-8687.77" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="1537" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer9_routing&#45;&gt;gpu2_layer9_expert2 -->
<g id="edge833" class="edge">
<title>gpu2_layer9_routing&#45;&gt;gpu2_layer9_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1537,-8745.56C1537,-8733.49 1537,-8721.23 1537,-8710.39"/>
<polygon fill="black" stroke="black" points="1540.5,-8710.07 1537,-8700.07 1533.5,-8710.07 1540.5,-8710.07"/>
<text text-anchor="middle" x="1566.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer9_expert3 -->
<g id="node681" class="node">
<title>gpu2_layer9_expert3</title>
<polygon fill="lightblue" stroke="black" points="1738,-8699.77 1616,-8699.77 1616,-8647.77 1738,-8647.77 1738,-8699.77"/>
<text text-anchor="middle" x="1677" y="-8687.77" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1677" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer9_routing&#45;&gt;gpu2_layer9_expert3 -->
<g id="edge834" class="edge">
<title>gpu2_layer9_routing&#45;&gt;gpu2_layer9_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1602.49,-8745.56C1616.52,-8732.23 1630.79,-8718.68 1643.03,-8707.04"/>
<polygon fill="black" stroke="black" points="1645.54,-8709.49 1650.37,-8700.07 1640.71,-8704.42 1645.54,-8709.49"/>
<text text-anchor="middle" x="1661.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer9_expert_agg -->
<g id="node682" class="node">
<title>gpu2_layer9_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-8610.77 1462.29,-8610.77 1410.53,-8506.77 1611.71,-8506.77 1663.47,-8610.77"/>
<text text-anchor="middle" x="1537" y="-8572.77" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="1537" y="-8561.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-8550.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-8539.77" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer9_routing&#45;&gt;gpu2_layer9_expert_agg -->
<g id="edge849" class="edge">
<title>gpu2_layer9_routing&#45;&gt;gpu2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M1626.22,-8780.86C1699.96,-8753.7 1786.6,-8707.31 1747,-8647.77 1726.44,-8616.86 1692.7,-8596.79 1658.22,-8583.76"/>
<polygon fill="black" stroke="black" points="1659.08,-8580.35 1648.48,-8580.27 1656.71,-8586.94 1659.08,-8580.35"/>
</g>
<!-- gpu2_layer9_expert0&#45;&gt;gpu2_layer9_expert_agg -->
<g id="edge845" class="edge">
<title>gpu2_layer9_expert0&#45;&gt;gpu2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M1318.1,-8648.12C1354.98,-8633.23 1402.7,-8613.97 1444.16,-8597.24"/>
<polygon fill="black" stroke="black" points="1445.5,-8600.48 1453.46,-8593.49 1442.88,-8593.99 1445.5,-8600.48"/>
</g>
<!-- gpu2_layer9_expert1&#45;&gt;gpu2_layer9_expert_agg -->
<g id="edge846" class="edge">
<title>gpu2_layer9_expert1&#45;&gt;gpu2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M1428.07,-8647.7C1439.32,-8638.62 1452.53,-8627.95 1465.8,-8617.24"/>
<polygon fill="black" stroke="black" points="1468.02,-8619.95 1473.6,-8610.95 1463.62,-8614.5 1468.02,-8619.95"/>
</g>
<!-- gpu2_layer9_expert2&#45;&gt;gpu2_layer9_expert_agg -->
<g id="edge847" class="edge">
<title>gpu2_layer9_expert2&#45;&gt;gpu2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M1537,-8647.7C1537,-8639.77 1537,-8630.63 1537,-8621.31"/>
<polygon fill="black" stroke="black" points="1540.5,-8621.17 1537,-8611.17 1533.5,-8621.17 1540.5,-8621.17"/>
</g>
<!-- gpu2_layer9_expert3&#45;&gt;gpu2_layer9_expert_agg -->
<g id="edge848" class="edge">
<title>gpu2_layer9_expert3&#45;&gt;gpu2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M1645.93,-8647.7C1634.68,-8638.62 1621.47,-8627.95 1608.2,-8617.24"/>
<polygon fill="black" stroke="black" points="1610.38,-8614.5 1600.4,-8610.95 1605.98,-8619.95 1610.38,-8614.5"/>
</g>
<!-- gpu2_layer9_res2 -->
<g id="node683" class="node">
<title>gpu2_layer9_res2</title>
<polygon fill="lightblue" stroke="black" points="1598,-8469.77 1476,-8469.77 1476,-8417.77 1598,-8417.77 1598,-8469.77"/>
<text text-anchor="middle" x="1537" y="-8457.77" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="1537" y="-8446.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-8435.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-8424.77" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer9_expert_agg&#45;&gt;gpu2_layer9_res2 -->
<g id="edge850" class="edge">
<title>gpu2_layer9_expert_agg&#45;&gt;gpu2_layer9_res2</title>
<path fill="none" stroke="black" d="M1537,-8506.56C1537,-8497.61 1537,-8488.48 1537,-8480.08"/>
<polygon fill="black" stroke="black" points="1540.5,-8479.9 1537,-8469.9 1533.5,-8479.9 1540.5,-8479.9"/>
</g>
<!-- gpu2_layer10_ln1 -->
<g id="node684" class="node">
<title>gpu2_layer10_ln1</title>
<polygon fill="lightblue" stroke="black" points="1598,-8380.77 1476,-8380.77 1476,-8328.77 1598,-8328.77 1598,-8380.77"/>
<text text-anchor="middle" x="1537" y="-8368.77" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="1537" y="-8357.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-8346.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-8335.77" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer9_res2&#45;&gt;gpu2_layer10_ln1 -->
<g id="edge855" class="edge">
<title>gpu2_layer9_res2&#45;&gt;gpu2_layer10_ln1</title>
<path fill="none" stroke="black" d="M1537,-8417.61C1537,-8409.31 1537,-8399.93 1537,-8391.02"/>
<polygon fill="black" stroke="black" points="1540.5,-8390.88 1537,-8380.88 1533.5,-8390.88 1540.5,-8390.88"/>
</g>
<!-- gpu2_layer10_qkv -->
<g id="node685" class="node">
<title>gpu2_layer10_qkv</title>
<polygon fill="lightblue" stroke="black" points="1598,-8291.77 1476,-8291.77 1476,-8239.77 1598,-8239.77 1598,-8291.77"/>
<text text-anchor="middle" x="1537" y="-8279.77" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1537" y="-8268.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-8257.77" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-8246.77" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer10_ln1&#45;&gt;gpu2_layer10_qkv -->
<g id="edge856" class="edge">
<title>gpu2_layer10_ln1&#45;&gt;gpu2_layer10_qkv</title>
<path fill="none" stroke="black" d="M1537,-8328.61C1537,-8320.31 1537,-8310.93 1537,-8302.02"/>
<polygon fill="black" stroke="black" points="1540.5,-8301.88 1537,-8291.88 1533.5,-8301.88 1540.5,-8301.88"/>
</g>
<!-- gpu2_layer10_reshape -->
<g id="node686" class="node">
<title>gpu2_layer10_reshape</title>
<polygon fill="lightblue" stroke="black" points="1601,-8202.77 1473,-8202.77 1473,-8150.77 1601,-8150.77 1601,-8202.77"/>
<text text-anchor="middle" x="1537" y="-8190.77" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="1537" y="-8179.77" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-8168.77" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-8157.77" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer10_qkv&#45;&gt;gpu2_layer10_reshape -->
<g id="edge857" class="edge">
<title>gpu2_layer10_qkv&#45;&gt;gpu2_layer10_reshape</title>
<path fill="none" stroke="black" d="M1537,-8239.61C1537,-8231.31 1537,-8221.93 1537,-8213.02"/>
<polygon fill="black" stroke="black" points="1540.5,-8212.88 1537,-8202.88 1533.5,-8212.88 1540.5,-8212.88"/>
</g>
<!-- gpu2_layer10_attn -->
<g id="node687" class="node">
<title>gpu2_layer10_attn</title>
<polygon fill="lightblue" stroke="black" points="1601,-8113.77 1473,-8113.77 1473,-8061.77 1601,-8061.77 1601,-8113.77"/>
<text text-anchor="middle" x="1537" y="-8101.77" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1537" y="-8090.77" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-8079.77" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-8068.77" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer10_reshape&#45;&gt;gpu2_layer10_attn -->
<g id="edge858" class="edge">
<title>gpu2_layer10_reshape&#45;&gt;gpu2_layer10_attn</title>
<path fill="none" stroke="black" d="M1537,-8150.61C1537,-8142.31 1537,-8132.93 1537,-8124.02"/>
<polygon fill="black" stroke="black" points="1540.5,-8123.88 1537,-8113.88 1533.5,-8123.88 1540.5,-8123.88"/>
</g>
<!-- gpu2_layer10_attn_reshape -->
<g id="node689" class="node">
<title>gpu2_layer10_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1598,-8024.77 1476,-8024.77 1476,-7972.77 1598,-7972.77 1598,-8024.77"/>
<text text-anchor="middle" x="1537" y="-8012.77" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="1537" y="-8001.77" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-7990.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-7979.77" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer10_attn&#45;&gt;gpu2_layer10_attn_reshape -->
<g id="edge859" class="edge">
<title>gpu2_layer10_attn&#45;&gt;gpu2_layer10_attn_reshape</title>
<path fill="none" stroke="black" d="M1537,-8061.61C1537,-8053.31 1537,-8043.93 1537,-8035.02"/>
<polygon fill="black" stroke="black" points="1540.5,-8034.88 1537,-8024.88 1533.5,-8034.88 1540.5,-8034.88"/>
</g>
<!-- gpu2_layer10_attn_out -->
<g id="node688" class="node">
<title>gpu2_layer10_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1598,-7935.77 1476,-7935.77 1476,-7883.77 1598,-7883.77 1598,-7935.77"/>
<text text-anchor="middle" x="1537" y="-7923.77" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="1537" y="-7912.77" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-7901.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-7890.77" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer10_kv_update -->
<g id="node690" class="node">
<title>gpu2_layer10_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="1537" cy="-7810" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="1537" y="-7824" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="1537" y="-7813" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-7802" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-7791" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer10_attn_out&#45;&gt;gpu2_layer10_kv_update -->
<g id="edge861" class="edge">
<title>gpu2_layer10_attn_out&#45;&gt;gpu2_layer10_kv_update</title>
<path fill="none" stroke="black" d="M1537,-7883.6C1537,-7875.46 1537,-7866.16 1537,-7857"/>
<polygon fill="black" stroke="black" points="1540.5,-7856.78 1537,-7846.78 1533.5,-7856.78 1540.5,-7856.78"/>
</g>
<!-- gpu2_layer10_attn_reshape&#45;&gt;gpu2_layer10_attn_out -->
<g id="edge860" class="edge">
<title>gpu2_layer10_attn_reshape&#45;&gt;gpu2_layer10_attn_out</title>
<path fill="none" stroke="black" d="M1537,-7972.61C1537,-7964.31 1537,-7954.93 1537,-7946.02"/>
<polygon fill="black" stroke="black" points="1540.5,-7945.88 1537,-7935.88 1533.5,-7945.88 1540.5,-7945.88"/>
</g>
<!-- gpu2_layer10_res1 -->
<g id="node691" class="node">
<title>gpu2_layer10_res1</title>
<polygon fill="lightblue" stroke="black" points="1598,-7736.23 1476,-7736.23 1476,-7684.23 1598,-7684.23 1598,-7736.23"/>
<text text-anchor="middle" x="1537" y="-7724.23" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="1537" y="-7713.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-7702.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-7691.23" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer10_kv_update&#45;&gt;gpu2_layer10_res1 -->
<g id="edge862" class="edge">
<title>gpu2_layer10_kv_update&#45;&gt;gpu2_layer10_res1</title>
<path fill="none" stroke="black" d="M1537,-7773.15C1537,-7764.47 1537,-7755.2 1537,-7746.55"/>
<polygon fill="black" stroke="black" points="1540.5,-7746.38 1537,-7736.38 1533.5,-7746.38 1540.5,-7746.38"/>
</g>
<!-- gpu2_layer10_ln2 -->
<g id="node692" class="node">
<title>gpu2_layer10_ln2</title>
<polygon fill="lightblue" stroke="black" points="1598,-7647.23 1476,-7647.23 1476,-7595.23 1598,-7595.23 1598,-7647.23"/>
<text text-anchor="middle" x="1537" y="-7635.23" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="1537" y="-7624.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-7613.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-7602.23" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer10_res1&#45;&gt;gpu2_layer10_ln2 -->
<g id="edge863" class="edge">
<title>gpu2_layer10_res1&#45;&gt;gpu2_layer10_ln2</title>
<path fill="none" stroke="black" d="M1537,-7684.07C1537,-7675.77 1537,-7666.39 1537,-7657.48"/>
<polygon fill="black" stroke="black" points="1540.5,-7657.34 1537,-7647.34 1533.5,-7657.34 1540.5,-7657.34"/>
</g>
<!-- gpu2_layer10_routing -->
<g id="node693" class="node">
<title>gpu2_layer10_routing</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-7558.23 1462.29,-7558.23 1410.53,-7432.23 1611.71,-7432.23 1663.47,-7558.23"/>
<text text-anchor="middle" x="1537" y="-7514.73" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="1537" y="-7503.73" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-7492.73" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-7481.73" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="1537" y="-7470.73" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer10_ln2&#45;&gt;gpu2_layer10_routing -->
<g id="edge864" class="edge">
<title>gpu2_layer10_ln2&#45;&gt;gpu2_layer10_routing</title>
<path fill="none" stroke="black" d="M1537,-7595.14C1537,-7587.21 1537,-7578.01 1537,-7568.48"/>
<polygon fill="black" stroke="black" points="1540.5,-7568.47 1537,-7558.47 1533.5,-7568.47 1540.5,-7568.47"/>
</g>
<!-- gpu2_layer10_expert0 -->
<g id="node694" class="node">
<title>gpu2_layer10_expert0</title>
<polygon fill="lightblue" stroke="black" points="1318,-7386.23 1196,-7386.23 1196,-7334.23 1318,-7334.23 1318,-7386.23"/>
<text text-anchor="middle" x="1257" y="-7374.23" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1257" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer10_routing&#45;&gt;gpu2_layer10_expert0 -->
<g id="edge851" class="edge">
<title>gpu2_layer10_routing&#45;&gt;gpu2_layer10_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1411.33,-7434.54C1379.34,-7419.35 1346.34,-7403.67 1319.11,-7390.74"/>
<polygon fill="black" stroke="black" points="1320.26,-7387.41 1309.73,-7386.28 1317.26,-7393.73 1320.26,-7387.41"/>
<text text-anchor="middle" x="1393.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer10_expert1 -->
<g id="node695" class="node">
<title>gpu2_layer10_expert1</title>
<polygon fill="lightblue" stroke="black" points="1458,-7386.23 1336,-7386.23 1336,-7334.23 1458,-7334.23 1458,-7386.23"/>
<text text-anchor="middle" x="1397" y="-7374.23" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1397" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer10_routing&#45;&gt;gpu2_layer10_expert1 -->
<g id="edge852" class="edge">
<title>gpu2_layer10_routing&#45;&gt;gpu2_layer10_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1471.51,-7432.02C1457.48,-7418.69 1443.21,-7405.14 1430.97,-7393.5"/>
<polygon fill="black" stroke="black" points="1433.29,-7390.88 1423.63,-7386.53 1428.46,-7395.95 1433.29,-7390.88"/>
<text text-anchor="middle" x="1480.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer10_expert2 -->
<g id="node696" class="node">
<title>gpu2_layer10_expert2</title>
<polygon fill="lightblue" stroke="black" points="1598,-7386.23 1476,-7386.23 1476,-7334.23 1598,-7334.23 1598,-7386.23"/>
<text text-anchor="middle" x="1537" y="-7374.23" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="1537" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer10_routing&#45;&gt;gpu2_layer10_expert2 -->
<g id="edge853" class="edge">
<title>gpu2_layer10_routing&#45;&gt;gpu2_layer10_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1537,-7432.02C1537,-7419.95 1537,-7407.69 1537,-7396.85"/>
<polygon fill="black" stroke="black" points="1540.5,-7396.53 1537,-7386.53 1533.5,-7396.53 1540.5,-7396.53"/>
<text text-anchor="middle" x="1566.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer10_expert3 -->
<g id="node697" class="node">
<title>gpu2_layer10_expert3</title>
<polygon fill="lightblue" stroke="black" points="1738,-7386.23 1616,-7386.23 1616,-7334.23 1738,-7334.23 1738,-7386.23"/>
<text text-anchor="middle" x="1677" y="-7374.23" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1677" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer10_routing&#45;&gt;gpu2_layer10_expert3 -->
<g id="edge854" class="edge">
<title>gpu2_layer10_routing&#45;&gt;gpu2_layer10_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1602.49,-7432.02C1616.52,-7418.69 1630.79,-7405.14 1643.03,-7393.5"/>
<polygon fill="black" stroke="black" points="1645.54,-7395.95 1650.37,-7386.53 1640.71,-7390.88 1645.54,-7395.95"/>
<text text-anchor="middle" x="1661.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer10_expert_agg -->
<g id="node698" class="node">
<title>gpu2_layer10_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-7297.23 1462.29,-7297.23 1410.53,-7193.23 1611.71,-7193.23 1663.47,-7297.23"/>
<text text-anchor="middle" x="1537" y="-7259.23" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="1537" y="-7248.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-7237.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-7226.23" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer10_routing&#45;&gt;gpu2_layer10_expert_agg -->
<g id="edge869" class="edge">
<title>gpu2_layer10_routing&#45;&gt;gpu2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M1626.22,-7467.32C1699.96,-7440.16 1786.6,-7393.77 1747,-7334.23 1726.44,-7303.32 1692.7,-7283.25 1658.22,-7270.22"/>
<polygon fill="black" stroke="black" points="1659.08,-7266.81 1648.48,-7266.73 1656.71,-7273.4 1659.08,-7266.81"/>
</g>
<!-- gpu2_layer10_expert0&#45;&gt;gpu2_layer10_expert_agg -->
<g id="edge865" class="edge">
<title>gpu2_layer10_expert0&#45;&gt;gpu2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M1318.1,-7334.58C1354.98,-7319.69 1402.7,-7300.44 1444.16,-7283.7"/>
<polygon fill="black" stroke="black" points="1445.5,-7286.94 1453.46,-7279.95 1442.88,-7280.45 1445.5,-7286.94"/>
</g>
<!-- gpu2_layer10_expert1&#45;&gt;gpu2_layer10_expert_agg -->
<g id="edge866" class="edge">
<title>gpu2_layer10_expert1&#45;&gt;gpu2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M1428.07,-7334.16C1439.32,-7325.08 1452.53,-7314.42 1465.8,-7303.71"/>
<polygon fill="black" stroke="black" points="1468.02,-7306.41 1473.6,-7297.41 1463.62,-7300.96 1468.02,-7306.41"/>
</g>
<!-- gpu2_layer10_expert2&#45;&gt;gpu2_layer10_expert_agg -->
<g id="edge867" class="edge">
<title>gpu2_layer10_expert2&#45;&gt;gpu2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M1537,-7334.16C1537,-7326.23 1537,-7317.09 1537,-7307.77"/>
<polygon fill="black" stroke="black" points="1540.5,-7307.64 1537,-7297.64 1533.5,-7307.64 1540.5,-7307.64"/>
</g>
<!-- gpu2_layer10_expert3&#45;&gt;gpu2_layer10_expert_agg -->
<g id="edge868" class="edge">
<title>gpu2_layer10_expert3&#45;&gt;gpu2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M1645.93,-7334.16C1634.68,-7325.08 1621.47,-7314.42 1608.2,-7303.71"/>
<polygon fill="black" stroke="black" points="1610.38,-7300.96 1600.4,-7297.41 1605.98,-7306.41 1610.38,-7300.96"/>
</g>
<!-- gpu2_layer10_res2 -->
<g id="node699" class="node">
<title>gpu2_layer10_res2</title>
<polygon fill="lightblue" stroke="black" points="1598,-7156.23 1476,-7156.23 1476,-7104.23 1598,-7104.23 1598,-7156.23"/>
<text text-anchor="middle" x="1537" y="-7144.23" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="1537" y="-7133.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-7122.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-7111.23" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer10_expert_agg&#45;&gt;gpu2_layer10_res2 -->
<g id="edge870" class="edge">
<title>gpu2_layer10_expert_agg&#45;&gt;gpu2_layer10_res2</title>
<path fill="none" stroke="black" d="M1537,-7193.02C1537,-7184.07 1537,-7174.94 1537,-7166.55"/>
<polygon fill="black" stroke="black" points="1540.5,-7166.37 1537,-7156.37 1533.5,-7166.37 1540.5,-7166.37"/>
</g>
<!-- gpu2_layer11_ln1 -->
<g id="node700" class="node">
<title>gpu2_layer11_ln1</title>
<polygon fill="lightblue" stroke="black" points="1598,-7067.23 1476,-7067.23 1476,-7015.23 1598,-7015.23 1598,-7067.23"/>
<text text-anchor="middle" x="1537" y="-7055.23" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="1537" y="-7044.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-7033.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-7022.23" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer10_res2&#45;&gt;gpu2_layer11_ln1 -->
<g id="edge875" class="edge">
<title>gpu2_layer10_res2&#45;&gt;gpu2_layer11_ln1</title>
<path fill="none" stroke="black" d="M1537,-7104.07C1537,-7095.77 1537,-7086.39 1537,-7077.48"/>
<polygon fill="black" stroke="black" points="1540.5,-7077.34 1537,-7067.34 1533.5,-7077.34 1540.5,-7077.34"/>
</g>
<!-- gpu2_layer11_qkv -->
<g id="node701" class="node">
<title>gpu2_layer11_qkv</title>
<polygon fill="lightblue" stroke="black" points="1598,-6978.23 1476,-6978.23 1476,-6926.23 1598,-6926.23 1598,-6978.23"/>
<text text-anchor="middle" x="1537" y="-6966.23" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1537" y="-6955.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-6944.23" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-6933.23" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer11_ln1&#45;&gt;gpu2_layer11_qkv -->
<g id="edge876" class="edge">
<title>gpu2_layer11_ln1&#45;&gt;gpu2_layer11_qkv</title>
<path fill="none" stroke="black" d="M1537,-7015.07C1537,-7006.77 1537,-6997.39 1537,-6988.48"/>
<polygon fill="black" stroke="black" points="1540.5,-6988.34 1537,-6978.34 1533.5,-6988.34 1540.5,-6988.34"/>
</g>
<!-- gpu2_layer11_reshape -->
<g id="node702" class="node">
<title>gpu2_layer11_reshape</title>
<polygon fill="lightblue" stroke="black" points="1601,-6889.23 1473,-6889.23 1473,-6837.23 1601,-6837.23 1601,-6889.23"/>
<text text-anchor="middle" x="1537" y="-6877.23" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="1537" y="-6866.23" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-6855.23" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-6844.23" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer11_qkv&#45;&gt;gpu2_layer11_reshape -->
<g id="edge877" class="edge">
<title>gpu2_layer11_qkv&#45;&gt;gpu2_layer11_reshape</title>
<path fill="none" stroke="black" d="M1537,-6926.07C1537,-6917.77 1537,-6908.39 1537,-6899.48"/>
<polygon fill="black" stroke="black" points="1540.5,-6899.34 1537,-6889.34 1533.5,-6899.34 1540.5,-6899.34"/>
</g>
<!-- gpu2_layer11_attn -->
<g id="node703" class="node">
<title>gpu2_layer11_attn</title>
<polygon fill="lightblue" stroke="black" points="1601,-6800.23 1473,-6800.23 1473,-6748.23 1601,-6748.23 1601,-6800.23"/>
<text text-anchor="middle" x="1537" y="-6788.23" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1537" y="-6777.23" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-6766.23" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-6755.23" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer11_reshape&#45;&gt;gpu2_layer11_attn -->
<g id="edge878" class="edge">
<title>gpu2_layer11_reshape&#45;&gt;gpu2_layer11_attn</title>
<path fill="none" stroke="black" d="M1537,-6837.07C1537,-6828.77 1537,-6819.39 1537,-6810.48"/>
<polygon fill="black" stroke="black" points="1540.5,-6810.34 1537,-6800.34 1533.5,-6810.34 1540.5,-6810.34"/>
</g>
<!-- gpu2_layer11_attn_reshape -->
<g id="node705" class="node">
<title>gpu2_layer11_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1598,-6711.23 1476,-6711.23 1476,-6659.23 1598,-6659.23 1598,-6711.23"/>
<text text-anchor="middle" x="1537" y="-6699.23" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="1537" y="-6688.23" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-6677.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-6666.23" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer11_attn&#45;&gt;gpu2_layer11_attn_reshape -->
<g id="edge879" class="edge">
<title>gpu2_layer11_attn&#45;&gt;gpu2_layer11_attn_reshape</title>
<path fill="none" stroke="black" d="M1537,-6748.07C1537,-6739.77 1537,-6730.39 1537,-6721.48"/>
<polygon fill="black" stroke="black" points="1540.5,-6721.34 1537,-6711.34 1533.5,-6721.34 1540.5,-6721.34"/>
</g>
<!-- gpu2_layer11_attn_out -->
<g id="node704" class="node">
<title>gpu2_layer11_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1598,-6622.23 1476,-6622.23 1476,-6570.23 1598,-6570.23 1598,-6622.23"/>
<text text-anchor="middle" x="1537" y="-6610.23" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="1537" y="-6599.23" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-6588.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-6577.23" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer11_kv_update -->
<g id="node706" class="node">
<title>gpu2_layer11_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="1537" cy="-6496.47" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="1537" y="-6510.47" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="1537" y="-6499.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-6488.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-6477.47" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer11_attn_out&#45;&gt;gpu2_layer11_kv_update -->
<g id="edge881" class="edge">
<title>gpu2_layer11_attn_out&#45;&gt;gpu2_layer11_kv_update</title>
<path fill="none" stroke="black" d="M1537,-6570.06C1537,-6561.92 1537,-6552.62 1537,-6543.46"/>
<polygon fill="black" stroke="black" points="1540.5,-6543.24 1537,-6533.24 1533.5,-6543.24 1540.5,-6543.24"/>
</g>
<!-- gpu2_layer11_attn_reshape&#45;&gt;gpu2_layer11_attn_out -->
<g id="edge880" class="edge">
<title>gpu2_layer11_attn_reshape&#45;&gt;gpu2_layer11_attn_out</title>
<path fill="none" stroke="black" d="M1537,-6659.07C1537,-6650.77 1537,-6641.39 1537,-6632.48"/>
<polygon fill="black" stroke="black" points="1540.5,-6632.34 1537,-6622.34 1533.5,-6632.34 1540.5,-6632.34"/>
</g>
<!-- gpu2_layer11_res1 -->
<g id="node707" class="node">
<title>gpu2_layer11_res1</title>
<polygon fill="lightblue" stroke="black" points="1598,-6422.7 1476,-6422.7 1476,-6370.7 1598,-6370.7 1598,-6422.7"/>
<text text-anchor="middle" x="1537" y="-6410.7" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="1537" y="-6399.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-6388.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-6377.7" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer11_kv_update&#45;&gt;gpu2_layer11_res1 -->
<g id="edge882" class="edge">
<title>gpu2_layer11_kv_update&#45;&gt;gpu2_layer11_res1</title>
<path fill="none" stroke="black" d="M1537,-6459.61C1537,-6450.94 1537,-6441.67 1537,-6433.01"/>
<polygon fill="black" stroke="black" points="1540.5,-6432.84 1537,-6422.84 1533.5,-6432.84 1540.5,-6432.84"/>
</g>
<!-- gpu2_layer11_ln2 -->
<g id="node708" class="node">
<title>gpu2_layer11_ln2</title>
<polygon fill="lightblue" stroke="black" points="1598,-6333.7 1476,-6333.7 1476,-6281.7 1598,-6281.7 1598,-6333.7"/>
<text text-anchor="middle" x="1537" y="-6321.7" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="1537" y="-6310.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-6299.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-6288.7" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer11_res1&#45;&gt;gpu2_layer11_ln2 -->
<g id="edge883" class="edge">
<title>gpu2_layer11_res1&#45;&gt;gpu2_layer11_ln2</title>
<path fill="none" stroke="black" d="M1537,-6370.53C1537,-6362.24 1537,-6352.85 1537,-6343.94"/>
<polygon fill="black" stroke="black" points="1540.5,-6343.8 1537,-6333.8 1533.5,-6343.8 1540.5,-6343.8"/>
</g>
<!-- gpu2_layer11_routing -->
<g id="node709" class="node">
<title>gpu2_layer11_routing</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-6244.7 1462.29,-6244.7 1410.53,-6118.7 1611.71,-6118.7 1663.47,-6244.7"/>
<text text-anchor="middle" x="1537" y="-6201.2" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="1537" y="-6190.2" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-6179.2" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-6168.2" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="1537" y="-6157.2" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer11_ln2&#45;&gt;gpu2_layer11_routing -->
<g id="edge884" class="edge">
<title>gpu2_layer11_ln2&#45;&gt;gpu2_layer11_routing</title>
<path fill="none" stroke="black" d="M1537,-6281.6C1537,-6273.67 1537,-6264.47 1537,-6254.94"/>
<polygon fill="black" stroke="black" points="1540.5,-6254.93 1537,-6244.93 1533.5,-6254.93 1540.5,-6254.93"/>
</g>
<!-- gpu2_layer11_expert0 -->
<g id="node710" class="node">
<title>gpu2_layer11_expert0</title>
<polygon fill="lightblue" stroke="black" points="1318,-6072.7 1196,-6072.7 1196,-6020.7 1318,-6020.7 1318,-6072.7"/>
<text text-anchor="middle" x="1257" y="-6060.7" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1257" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer11_routing&#45;&gt;gpu2_layer11_expert0 -->
<g id="edge871" class="edge">
<title>gpu2_layer11_routing&#45;&gt;gpu2_layer11_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1411.33,-6121C1379.34,-6105.81 1346.34,-6090.13 1319.11,-6077.2"/>
<polygon fill="black" stroke="black" points="1320.26,-6073.87 1309.73,-6072.74 1317.26,-6080.19 1320.26,-6073.87"/>
<text text-anchor="middle" x="1393.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer11_expert1 -->
<g id="node711" class="node">
<title>gpu2_layer11_expert1</title>
<polygon fill="lightblue" stroke="black" points="1458,-6072.7 1336,-6072.7 1336,-6020.7 1458,-6020.7 1458,-6072.7"/>
<text text-anchor="middle" x="1397" y="-6060.7" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1397" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer11_routing&#45;&gt;gpu2_layer11_expert1 -->
<g id="edge872" class="edge">
<title>gpu2_layer11_routing&#45;&gt;gpu2_layer11_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1471.51,-6118.48C1457.48,-6105.15 1443.21,-6091.6 1430.97,-6079.97"/>
<polygon fill="black" stroke="black" points="1433.29,-6077.34 1423.63,-6072.99 1428.46,-6082.41 1433.29,-6077.34"/>
<text text-anchor="middle" x="1480.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer11_expert2 -->
<g id="node712" class="node">
<title>gpu2_layer11_expert2</title>
<polygon fill="lightblue" stroke="black" points="1598,-6072.7 1476,-6072.7 1476,-6020.7 1598,-6020.7 1598,-6072.7"/>
<text text-anchor="middle" x="1537" y="-6060.7" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="1537" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer11_routing&#45;&gt;gpu2_layer11_expert2 -->
<g id="edge873" class="edge">
<title>gpu2_layer11_routing&#45;&gt;gpu2_layer11_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1537,-6118.48C1537,-6106.41 1537,-6094.15 1537,-6083.31"/>
<polygon fill="black" stroke="black" points="1540.5,-6082.99 1537,-6072.99 1533.5,-6082.99 1540.5,-6082.99"/>
<text text-anchor="middle" x="1566.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer11_expert3 -->
<g id="node713" class="node">
<title>gpu2_layer11_expert3</title>
<polygon fill="lightblue" stroke="black" points="1738,-6072.7 1616,-6072.7 1616,-6020.7 1738,-6020.7 1738,-6072.7"/>
<text text-anchor="middle" x="1677" y="-6060.7" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1677" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer11_routing&#45;&gt;gpu2_layer11_expert3 -->
<g id="edge874" class="edge">
<title>gpu2_layer11_routing&#45;&gt;gpu2_layer11_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1602.49,-6118.48C1616.52,-6105.15 1630.79,-6091.6 1643.03,-6079.97"/>
<polygon fill="black" stroke="black" points="1645.54,-6082.41 1650.37,-6072.99 1640.71,-6077.34 1645.54,-6082.41"/>
<text text-anchor="middle" x="1661.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer11_expert_agg -->
<g id="node714" class="node">
<title>gpu2_layer11_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-5983.7 1462.29,-5983.7 1410.53,-5879.7 1611.71,-5879.7 1663.47,-5983.7"/>
<text text-anchor="middle" x="1537" y="-5945.7" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="1537" y="-5934.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-5923.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-5912.7" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer11_routing&#45;&gt;gpu2_layer11_expert_agg -->
<g id="edge889" class="edge">
<title>gpu2_layer11_routing&#45;&gt;gpu2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M1626.22,-6153.78C1699.96,-6126.62 1786.6,-6080.23 1747,-6020.7 1726.44,-5989.78 1692.7,-5969.71 1658.22,-5956.68"/>
<polygon fill="black" stroke="black" points="1659.08,-5953.27 1648.48,-5953.19 1656.71,-5959.86 1659.08,-5953.27"/>
</g>
<!-- gpu2_layer11_expert0&#45;&gt;gpu2_layer11_expert_agg -->
<g id="edge885" class="edge">
<title>gpu2_layer11_expert0&#45;&gt;gpu2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M1318.1,-6021.04C1354.98,-6006.15 1402.7,-5986.9 1444.16,-5970.16"/>
<polygon fill="black" stroke="black" points="1445.5,-5973.4 1453.46,-5966.41 1442.88,-5966.91 1445.5,-5973.4"/>
</g>
<!-- gpu2_layer11_expert1&#45;&gt;gpu2_layer11_expert_agg -->
<g id="edge886" class="edge">
<title>gpu2_layer11_expert1&#45;&gt;gpu2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M1428.07,-6020.62C1439.32,-6011.54 1452.53,-6000.88 1465.8,-5990.17"/>
<polygon fill="black" stroke="black" points="1468.02,-5992.87 1473.6,-5983.87 1463.62,-5987.42 1468.02,-5992.87"/>
</g>
<!-- gpu2_layer11_expert2&#45;&gt;gpu2_layer11_expert_agg -->
<g id="edge887" class="edge">
<title>gpu2_layer11_expert2&#45;&gt;gpu2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M1537,-6020.62C1537,-6012.69 1537,-6003.55 1537,-5994.23"/>
<polygon fill="black" stroke="black" points="1540.5,-5994.1 1537,-5984.1 1533.5,-5994.1 1540.5,-5994.1"/>
</g>
<!-- gpu2_layer11_expert3&#45;&gt;gpu2_layer11_expert_agg -->
<g id="edge888" class="edge">
<title>gpu2_layer11_expert3&#45;&gt;gpu2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M1645.93,-6020.62C1634.68,-6011.54 1621.47,-6000.88 1608.2,-5990.17"/>
<polygon fill="black" stroke="black" points="1610.38,-5987.42 1600.4,-5983.87 1605.98,-5992.87 1610.38,-5987.42"/>
</g>
<!-- gpu2_layer11_res2 -->
<g id="node715" class="node">
<title>gpu2_layer11_res2</title>
<polygon fill="lightblue" stroke="black" points="1598,-5842.7 1476,-5842.7 1476,-5790.7 1598,-5790.7 1598,-5842.7"/>
<text text-anchor="middle" x="1537" y="-5830.7" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="1537" y="-5819.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-5808.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-5797.7" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer11_expert_agg&#45;&gt;gpu2_layer11_res2 -->
<g id="edge890" class="edge">
<title>gpu2_layer11_expert_agg&#45;&gt;gpu2_layer11_res2</title>
<path fill="none" stroke="black" d="M1537,-5879.49C1537,-5870.53 1537,-5861.41 1537,-5853.01"/>
<polygon fill="black" stroke="black" points="1540.5,-5852.83 1537,-5842.83 1533.5,-5852.83 1540.5,-5852.83"/>
</g>
<!-- gpu2_layer12_ln1 -->
<g id="node716" class="node">
<title>gpu2_layer12_ln1</title>
<polygon fill="lightblue" stroke="black" points="1598,-5753.7 1476,-5753.7 1476,-5701.7 1598,-5701.7 1598,-5753.7"/>
<text text-anchor="middle" x="1537" y="-5741.7" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="1537" y="-5730.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-5719.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-5708.7" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer11_res2&#45;&gt;gpu2_layer12_ln1 -->
<g id="edge895" class="edge">
<title>gpu2_layer11_res2&#45;&gt;gpu2_layer12_ln1</title>
<path fill="none" stroke="black" d="M1537,-5790.53C1537,-5782.24 1537,-5772.85 1537,-5763.94"/>
<polygon fill="black" stroke="black" points="1540.5,-5763.8 1537,-5753.8 1533.5,-5763.8 1540.5,-5763.8"/>
</g>
<!-- gpu2_layer12_qkv -->
<g id="node717" class="node">
<title>gpu2_layer12_qkv</title>
<polygon fill="lightblue" stroke="black" points="1598,-5664.7 1476,-5664.7 1476,-5612.7 1598,-5612.7 1598,-5664.7"/>
<text text-anchor="middle" x="1537" y="-5652.7" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1537" y="-5641.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-5630.7" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-5619.7" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer12_ln1&#45;&gt;gpu2_layer12_qkv -->
<g id="edge896" class="edge">
<title>gpu2_layer12_ln1&#45;&gt;gpu2_layer12_qkv</title>
<path fill="none" stroke="black" d="M1537,-5701.53C1537,-5693.24 1537,-5683.85 1537,-5674.94"/>
<polygon fill="black" stroke="black" points="1540.5,-5674.8 1537,-5664.8 1533.5,-5674.8 1540.5,-5674.8"/>
</g>
<!-- gpu2_layer12_reshape -->
<g id="node718" class="node">
<title>gpu2_layer12_reshape</title>
<polygon fill="lightblue" stroke="black" points="1601,-5575.7 1473,-5575.7 1473,-5523.7 1601,-5523.7 1601,-5575.7"/>
<text text-anchor="middle" x="1537" y="-5563.7" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="1537" y="-5552.7" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-5541.7" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-5530.7" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer12_qkv&#45;&gt;gpu2_layer12_reshape -->
<g id="edge897" class="edge">
<title>gpu2_layer12_qkv&#45;&gt;gpu2_layer12_reshape</title>
<path fill="none" stroke="black" d="M1537,-5612.53C1537,-5604.24 1537,-5594.85 1537,-5585.94"/>
<polygon fill="black" stroke="black" points="1540.5,-5585.8 1537,-5575.8 1533.5,-5585.8 1540.5,-5585.8"/>
</g>
<!-- gpu2_layer12_attn -->
<g id="node719" class="node">
<title>gpu2_layer12_attn</title>
<polygon fill="lightblue" stroke="black" points="1601,-5486.7 1473,-5486.7 1473,-5434.7 1601,-5434.7 1601,-5486.7"/>
<text text-anchor="middle" x="1537" y="-5474.7" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1537" y="-5463.7" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-5452.7" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-5441.7" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer12_reshape&#45;&gt;gpu2_layer12_attn -->
<g id="edge898" class="edge">
<title>gpu2_layer12_reshape&#45;&gt;gpu2_layer12_attn</title>
<path fill="none" stroke="black" d="M1537,-5523.53C1537,-5515.24 1537,-5505.85 1537,-5496.94"/>
<polygon fill="black" stroke="black" points="1540.5,-5496.8 1537,-5486.8 1533.5,-5496.8 1540.5,-5496.8"/>
</g>
<!-- gpu2_layer12_attn_reshape -->
<g id="node721" class="node">
<title>gpu2_layer12_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1598,-5397.7 1476,-5397.7 1476,-5345.7 1598,-5345.7 1598,-5397.7"/>
<text text-anchor="middle" x="1537" y="-5385.7" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="1537" y="-5374.7" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-5363.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-5352.7" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer12_attn&#45;&gt;gpu2_layer12_attn_reshape -->
<g id="edge899" class="edge">
<title>gpu2_layer12_attn&#45;&gt;gpu2_layer12_attn_reshape</title>
<path fill="none" stroke="black" d="M1537,-5434.53C1537,-5426.24 1537,-5416.85 1537,-5407.94"/>
<polygon fill="black" stroke="black" points="1540.5,-5407.8 1537,-5397.8 1533.5,-5407.8 1540.5,-5407.8"/>
</g>
<!-- gpu2_layer12_attn_out -->
<g id="node720" class="node">
<title>gpu2_layer12_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1598,-5308.7 1476,-5308.7 1476,-5256.7 1598,-5256.7 1598,-5308.7"/>
<text text-anchor="middle" x="1537" y="-5296.7" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="1537" y="-5285.7" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-5274.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-5263.7" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer12_kv_update -->
<g id="node722" class="node">
<title>gpu2_layer12_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="1537" cy="-5182.93" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="1537" y="-5196.93" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="1537" y="-5185.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-5174.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-5163.93" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer12_attn_out&#45;&gt;gpu2_layer12_kv_update -->
<g id="edge901" class="edge">
<title>gpu2_layer12_attn_out&#45;&gt;gpu2_layer12_kv_update</title>
<path fill="none" stroke="black" d="M1537,-5256.52C1537,-5248.38 1537,-5239.08 1537,-5229.92"/>
<polygon fill="black" stroke="black" points="1540.5,-5229.71 1537,-5219.71 1533.5,-5229.71 1540.5,-5229.71"/>
</g>
<!-- gpu2_layer12_attn_reshape&#45;&gt;gpu2_layer12_attn_out -->
<g id="edge900" class="edge">
<title>gpu2_layer12_attn_reshape&#45;&gt;gpu2_layer12_attn_out</title>
<path fill="none" stroke="black" d="M1537,-5345.53C1537,-5337.24 1537,-5327.85 1537,-5318.94"/>
<polygon fill="black" stroke="black" points="1540.5,-5318.8 1537,-5308.8 1533.5,-5318.8 1540.5,-5318.8"/>
</g>
<!-- gpu2_layer12_res1 -->
<g id="node723" class="node">
<title>gpu2_layer12_res1</title>
<polygon fill="lightblue" stroke="black" points="1598,-5109.16 1476,-5109.16 1476,-5057.16 1598,-5057.16 1598,-5109.16"/>
<text text-anchor="middle" x="1537" y="-5097.16" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="1537" y="-5086.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-5075.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-5064.16" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer12_kv_update&#45;&gt;gpu2_layer12_res1 -->
<g id="edge902" class="edge">
<title>gpu2_layer12_kv_update&#45;&gt;gpu2_layer12_res1</title>
<path fill="none" stroke="black" d="M1537,-5146.08C1537,-5137.4 1537,-5128.13 1537,-5119.47"/>
<polygon fill="black" stroke="black" points="1540.5,-5119.3 1537,-5109.3 1533.5,-5119.3 1540.5,-5119.3"/>
</g>
<!-- gpu2_layer12_ln2 -->
<g id="node724" class="node">
<title>gpu2_layer12_ln2</title>
<polygon fill="lightblue" stroke="black" points="1598,-5020.16 1476,-5020.16 1476,-4968.16 1598,-4968.16 1598,-5020.16"/>
<text text-anchor="middle" x="1537" y="-5008.16" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="1537" y="-4997.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-4986.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-4975.16" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer12_res1&#45;&gt;gpu2_layer12_ln2 -->
<g id="edge903" class="edge">
<title>gpu2_layer12_res1&#45;&gt;gpu2_layer12_ln2</title>
<path fill="none" stroke="black" d="M1537,-5056.99C1537,-5048.7 1537,-5039.31 1537,-5030.4"/>
<polygon fill="black" stroke="black" points="1540.5,-5030.26 1537,-5020.26 1533.5,-5030.26 1540.5,-5030.26"/>
</g>
<!-- gpu2_layer12_routing -->
<g id="node725" class="node">
<title>gpu2_layer12_routing</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-4931.16 1462.29,-4931.16 1410.53,-4805.16 1611.71,-4805.16 1663.47,-4931.16"/>
<text text-anchor="middle" x="1537" y="-4887.66" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="1537" y="-4876.66" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-4865.66" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-4854.66" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="1537" y="-4843.66" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer12_ln2&#45;&gt;gpu2_layer12_routing -->
<g id="edge904" class="edge">
<title>gpu2_layer12_ln2&#45;&gt;gpu2_layer12_routing</title>
<path fill="none" stroke="black" d="M1537,-4968.06C1537,-4960.13 1537,-4950.93 1537,-4941.4"/>
<polygon fill="black" stroke="black" points="1540.5,-4941.39 1537,-4931.39 1533.5,-4941.39 1540.5,-4941.39"/>
</g>
<!-- gpu2_layer12_expert0 -->
<g id="node726" class="node">
<title>gpu2_layer12_expert0</title>
<polygon fill="lightblue" stroke="black" points="1318,-4759.16 1196,-4759.16 1196,-4707.16 1318,-4707.16 1318,-4759.16"/>
<text text-anchor="middle" x="1257" y="-4747.16" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1257" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer12_routing&#45;&gt;gpu2_layer12_expert0 -->
<g id="edge891" class="edge">
<title>gpu2_layer12_routing&#45;&gt;gpu2_layer12_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1411.33,-4807.46C1379.34,-4792.27 1346.34,-4776.59 1319.11,-4763.66"/>
<polygon fill="black" stroke="black" points="1320.26,-4760.33 1309.73,-4759.2 1317.26,-4766.65 1320.26,-4760.33"/>
<text text-anchor="middle" x="1393.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer12_expert1 -->
<g id="node727" class="node">
<title>gpu2_layer12_expert1</title>
<polygon fill="lightblue" stroke="black" points="1458,-4759.16 1336,-4759.16 1336,-4707.16 1458,-4707.16 1458,-4759.16"/>
<text text-anchor="middle" x="1397" y="-4747.16" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1397" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer12_routing&#45;&gt;gpu2_layer12_expert1 -->
<g id="edge892" class="edge">
<title>gpu2_layer12_routing&#45;&gt;gpu2_layer12_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1471.51,-4804.94C1457.48,-4791.62 1443.21,-4778.06 1430.97,-4766.43"/>
<polygon fill="black" stroke="black" points="1433.29,-4763.8 1423.63,-4759.45 1428.46,-4768.88 1433.29,-4763.8"/>
<text text-anchor="middle" x="1480.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer12_expert2 -->
<g id="node728" class="node">
<title>gpu2_layer12_expert2</title>
<polygon fill="lightblue" stroke="black" points="1598,-4759.16 1476,-4759.16 1476,-4707.16 1598,-4707.16 1598,-4759.16"/>
<text text-anchor="middle" x="1537" y="-4747.16" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="1537" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer12_routing&#45;&gt;gpu2_layer12_expert2 -->
<g id="edge893" class="edge">
<title>gpu2_layer12_routing&#45;&gt;gpu2_layer12_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1537,-4804.94C1537,-4792.87 1537,-4780.62 1537,-4769.77"/>
<polygon fill="black" stroke="black" points="1540.5,-4769.45 1537,-4759.45 1533.5,-4769.45 1540.5,-4769.45"/>
<text text-anchor="middle" x="1566.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer12_expert3 -->
<g id="node729" class="node">
<title>gpu2_layer12_expert3</title>
<polygon fill="lightblue" stroke="black" points="1738,-4759.16 1616,-4759.16 1616,-4707.16 1738,-4707.16 1738,-4759.16"/>
<text text-anchor="middle" x="1677" y="-4747.16" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1677" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer12_routing&#45;&gt;gpu2_layer12_expert3 -->
<g id="edge894" class="edge">
<title>gpu2_layer12_routing&#45;&gt;gpu2_layer12_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1602.49,-4804.94C1616.52,-4791.62 1630.79,-4778.06 1643.03,-4766.43"/>
<polygon fill="black" stroke="black" points="1645.54,-4768.88 1650.37,-4759.45 1640.71,-4763.8 1645.54,-4768.88"/>
<text text-anchor="middle" x="1661.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer12_expert_agg -->
<g id="node730" class="node">
<title>gpu2_layer12_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-4670.16 1462.29,-4670.16 1410.53,-4566.16 1611.71,-4566.16 1663.47,-4670.16"/>
<text text-anchor="middle" x="1537" y="-4632.16" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="1537" y="-4621.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-4610.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-4599.16" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer12_routing&#45;&gt;gpu2_layer12_expert_agg -->
<g id="edge909" class="edge">
<title>gpu2_layer12_routing&#45;&gt;gpu2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M1626.22,-4840.24C1699.96,-4813.08 1786.6,-4766.69 1747,-4707.16 1726.44,-4676.24 1692.7,-4656.17 1658.22,-4643.14"/>
<polygon fill="black" stroke="black" points="1659.08,-4639.73 1648.48,-4639.65 1656.71,-4646.32 1659.08,-4639.73"/>
</g>
<!-- gpu2_layer12_expert0&#45;&gt;gpu2_layer12_expert_agg -->
<g id="edge905" class="edge">
<title>gpu2_layer12_expert0&#45;&gt;gpu2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M1318.1,-4707.5C1354.98,-4692.62 1402.7,-4673.36 1444.16,-4656.62"/>
<polygon fill="black" stroke="black" points="1445.5,-4659.86 1453.46,-4652.87 1442.88,-4653.37 1445.5,-4659.86"/>
</g>
<!-- gpu2_layer12_expert1&#45;&gt;gpu2_layer12_expert_agg -->
<g id="edge906" class="edge">
<title>gpu2_layer12_expert1&#45;&gt;gpu2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M1428.07,-4707.08C1439.32,-4698 1452.53,-4687.34 1465.8,-4676.63"/>
<polygon fill="black" stroke="black" points="1468.02,-4679.33 1473.6,-4670.33 1463.62,-4673.89 1468.02,-4679.33"/>
</g>
<!-- gpu2_layer12_expert2&#45;&gt;gpu2_layer12_expert_agg -->
<g id="edge907" class="edge">
<title>gpu2_layer12_expert2&#45;&gt;gpu2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M1537,-4707.08C1537,-4699.15 1537,-4690.02 1537,-4680.69"/>
<polygon fill="black" stroke="black" points="1540.5,-4680.56 1537,-4670.56 1533.5,-4680.56 1540.5,-4680.56"/>
</g>
<!-- gpu2_layer12_expert3&#45;&gt;gpu2_layer12_expert_agg -->
<g id="edge908" class="edge">
<title>gpu2_layer12_expert3&#45;&gt;gpu2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M1645.93,-4707.08C1634.68,-4698 1621.47,-4687.34 1608.2,-4676.63"/>
<polygon fill="black" stroke="black" points="1610.38,-4673.89 1600.4,-4670.33 1605.98,-4679.33 1610.38,-4673.89"/>
</g>
<!-- gpu2_layer12_res2 -->
<g id="node731" class="node">
<title>gpu2_layer12_res2</title>
<polygon fill="lightblue" stroke="black" points="1598,-4529.16 1476,-4529.16 1476,-4477.16 1598,-4477.16 1598,-4529.16"/>
<text text-anchor="middle" x="1537" y="-4517.16" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="1537" y="-4506.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-4495.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-4484.16" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer12_expert_agg&#45;&gt;gpu2_layer12_res2 -->
<g id="edge910" class="edge">
<title>gpu2_layer12_expert_agg&#45;&gt;gpu2_layer12_res2</title>
<path fill="none" stroke="black" d="M1537,-4565.95C1537,-4557 1537,-4547.87 1537,-4539.47"/>
<polygon fill="black" stroke="black" points="1540.5,-4539.29 1537,-4529.29 1533.5,-4539.29 1540.5,-4539.29"/>
</g>
<!-- gpu2_layer13_ln1 -->
<g id="node732" class="node">
<title>gpu2_layer13_ln1</title>
<polygon fill="lightblue" stroke="black" points="1598,-4440.16 1476,-4440.16 1476,-4388.16 1598,-4388.16 1598,-4440.16"/>
<text text-anchor="middle" x="1537" y="-4428.16" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="1537" y="-4417.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-4406.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-4395.16" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer12_res2&#45;&gt;gpu2_layer13_ln1 -->
<g id="edge915" class="edge">
<title>gpu2_layer12_res2&#45;&gt;gpu2_layer13_ln1</title>
<path fill="none" stroke="black" d="M1537,-4476.99C1537,-4468.7 1537,-4459.31 1537,-4450.4"/>
<polygon fill="black" stroke="black" points="1540.5,-4450.26 1537,-4440.26 1533.5,-4450.26 1540.5,-4450.26"/>
</g>
<!-- gpu2_layer13_qkv -->
<g id="node733" class="node">
<title>gpu2_layer13_qkv</title>
<polygon fill="lightblue" stroke="black" points="1598,-4351.16 1476,-4351.16 1476,-4299.16 1598,-4299.16 1598,-4351.16"/>
<text text-anchor="middle" x="1537" y="-4339.16" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1537" y="-4328.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-4317.16" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-4306.16" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer13_ln1&#45;&gt;gpu2_layer13_qkv -->
<g id="edge916" class="edge">
<title>gpu2_layer13_ln1&#45;&gt;gpu2_layer13_qkv</title>
<path fill="none" stroke="black" d="M1537,-4387.99C1537,-4379.7 1537,-4370.31 1537,-4361.4"/>
<polygon fill="black" stroke="black" points="1540.5,-4361.26 1537,-4351.26 1533.5,-4361.26 1540.5,-4361.26"/>
</g>
<!-- gpu2_layer13_reshape -->
<g id="node734" class="node">
<title>gpu2_layer13_reshape</title>
<polygon fill="lightblue" stroke="black" points="1601,-4262.16 1473,-4262.16 1473,-4210.16 1601,-4210.16 1601,-4262.16"/>
<text text-anchor="middle" x="1537" y="-4250.16" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="1537" y="-4239.16" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-4228.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-4217.16" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer13_qkv&#45;&gt;gpu2_layer13_reshape -->
<g id="edge917" class="edge">
<title>gpu2_layer13_qkv&#45;&gt;gpu2_layer13_reshape</title>
<path fill="none" stroke="black" d="M1537,-4298.99C1537,-4290.7 1537,-4281.31 1537,-4272.4"/>
<polygon fill="black" stroke="black" points="1540.5,-4272.26 1537,-4262.26 1533.5,-4272.26 1540.5,-4272.26"/>
</g>
<!-- gpu2_layer13_attn -->
<g id="node735" class="node">
<title>gpu2_layer13_attn</title>
<polygon fill="lightblue" stroke="black" points="1601,-4173.16 1473,-4173.16 1473,-4121.16 1601,-4121.16 1601,-4173.16"/>
<text text-anchor="middle" x="1537" y="-4161.16" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1537" y="-4150.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-4139.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-4128.16" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer13_reshape&#45;&gt;gpu2_layer13_attn -->
<g id="edge918" class="edge">
<title>gpu2_layer13_reshape&#45;&gt;gpu2_layer13_attn</title>
<path fill="none" stroke="black" d="M1537,-4209.99C1537,-4201.7 1537,-4192.31 1537,-4183.4"/>
<polygon fill="black" stroke="black" points="1540.5,-4183.26 1537,-4173.26 1533.5,-4183.26 1540.5,-4183.26"/>
</g>
<!-- gpu2_layer13_attn_reshape -->
<g id="node737" class="node">
<title>gpu2_layer13_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1598,-4084.16 1476,-4084.16 1476,-4032.16 1598,-4032.16 1598,-4084.16"/>
<text text-anchor="middle" x="1537" y="-4072.16" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="1537" y="-4061.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-4050.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-4039.16" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer13_attn&#45;&gt;gpu2_layer13_attn_reshape -->
<g id="edge919" class="edge">
<title>gpu2_layer13_attn&#45;&gt;gpu2_layer13_attn_reshape</title>
<path fill="none" stroke="black" d="M1537,-4120.99C1537,-4112.7 1537,-4103.31 1537,-4094.4"/>
<polygon fill="black" stroke="black" points="1540.5,-4094.26 1537,-4084.26 1533.5,-4094.26 1540.5,-4094.26"/>
</g>
<!-- gpu2_layer13_attn_out -->
<g id="node736" class="node">
<title>gpu2_layer13_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1598,-3995.16 1476,-3995.16 1476,-3943.16 1598,-3943.16 1598,-3995.16"/>
<text text-anchor="middle" x="1537" y="-3983.16" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="1537" y="-3972.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-3961.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-3950.16" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer13_kv_update -->
<g id="node738" class="node">
<title>gpu2_layer13_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="1537" cy="-3869.39" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="1537" y="-3883.39" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="1537" y="-3872.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-3861.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-3850.39" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer13_attn_out&#45;&gt;gpu2_layer13_kv_update -->
<g id="edge921" class="edge">
<title>gpu2_layer13_attn_out&#45;&gt;gpu2_layer13_kv_update</title>
<path fill="none" stroke="black" d="M1537,-3942.98C1537,-3934.84 1537,-3925.54 1537,-3916.38"/>
<polygon fill="black" stroke="black" points="1540.5,-3916.17 1537,-3906.17 1533.5,-3916.17 1540.5,-3916.17"/>
</g>
<!-- gpu2_layer13_attn_reshape&#45;&gt;gpu2_layer13_attn_out -->
<g id="edge920" class="edge">
<title>gpu2_layer13_attn_reshape&#45;&gt;gpu2_layer13_attn_out</title>
<path fill="none" stroke="black" d="M1537,-4031.99C1537,-4023.7 1537,-4014.31 1537,-4005.4"/>
<polygon fill="black" stroke="black" points="1540.5,-4005.26 1537,-3995.26 1533.5,-4005.26 1540.5,-4005.26"/>
</g>
<!-- gpu2_layer13_res1 -->
<g id="node739" class="node">
<title>gpu2_layer13_res1</title>
<polygon fill="lightblue" stroke="black" points="1598,-3795.62 1476,-3795.62 1476,-3743.62 1598,-3743.62 1598,-3795.62"/>
<text text-anchor="middle" x="1537" y="-3783.62" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="1537" y="-3772.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-3761.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-3750.62" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer13_kv_update&#45;&gt;gpu2_layer13_res1 -->
<g id="edge922" class="edge">
<title>gpu2_layer13_kv_update&#45;&gt;gpu2_layer13_res1</title>
<path fill="none" stroke="black" d="M1537,-3832.54C1537,-3823.86 1537,-3814.59 1537,-3805.93"/>
<polygon fill="black" stroke="black" points="1540.5,-3805.76 1537,-3795.76 1533.5,-3805.76 1540.5,-3805.76"/>
</g>
<!-- gpu2_layer13_ln2 -->
<g id="node740" class="node">
<title>gpu2_layer13_ln2</title>
<polygon fill="lightblue" stroke="black" points="1598,-3706.62 1476,-3706.62 1476,-3654.62 1598,-3654.62 1598,-3706.62"/>
<text text-anchor="middle" x="1537" y="-3694.62" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="1537" y="-3683.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-3672.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-3661.62" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer13_res1&#45;&gt;gpu2_layer13_ln2 -->
<g id="edge923" class="edge">
<title>gpu2_layer13_res1&#45;&gt;gpu2_layer13_ln2</title>
<path fill="none" stroke="black" d="M1537,-3743.45C1537,-3735.16 1537,-3725.77 1537,-3716.87"/>
<polygon fill="black" stroke="black" points="1540.5,-3716.72 1537,-3706.72 1533.5,-3716.72 1540.5,-3716.72"/>
</g>
<!-- gpu2_layer13_routing -->
<g id="node741" class="node">
<title>gpu2_layer13_routing</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-3617.62 1462.29,-3617.62 1410.53,-3491.62 1611.71,-3491.62 1663.47,-3617.62"/>
<text text-anchor="middle" x="1537" y="-3574.12" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="1537" y="-3563.12" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-3552.12" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-3541.12" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="1537" y="-3530.12" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer13_ln2&#45;&gt;gpu2_layer13_routing -->
<g id="edge924" class="edge">
<title>gpu2_layer13_ln2&#45;&gt;gpu2_layer13_routing</title>
<path fill="none" stroke="black" d="M1537,-3654.52C1537,-3646.59 1537,-3637.4 1537,-3627.87"/>
<polygon fill="black" stroke="black" points="1540.5,-3627.85 1537,-3617.85 1533.5,-3627.85 1540.5,-3627.85"/>
</g>
<!-- gpu2_layer13_expert0 -->
<g id="node742" class="node">
<title>gpu2_layer13_expert0</title>
<polygon fill="lightblue" stroke="black" points="1318,-3445.62 1196,-3445.62 1196,-3393.62 1318,-3393.62 1318,-3445.62"/>
<text text-anchor="middle" x="1257" y="-3433.62" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1257" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer13_routing&#45;&gt;gpu2_layer13_expert0 -->
<g id="edge911" class="edge">
<title>gpu2_layer13_routing&#45;&gt;gpu2_layer13_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1411.33,-3493.93C1379.34,-3478.73 1346.34,-3463.05 1319.11,-3450.12"/>
<polygon fill="black" stroke="black" points="1320.26,-3446.79 1309.73,-3445.66 1317.26,-3453.11 1320.26,-3446.79"/>
<text text-anchor="middle" x="1393.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer13_expert1 -->
<g id="node743" class="node">
<title>gpu2_layer13_expert1</title>
<polygon fill="lightblue" stroke="black" points="1458,-3445.62 1336,-3445.62 1336,-3393.62 1458,-3393.62 1458,-3445.62"/>
<text text-anchor="middle" x="1397" y="-3433.62" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1397" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer13_routing&#45;&gt;gpu2_layer13_expert1 -->
<g id="edge912" class="edge">
<title>gpu2_layer13_routing&#45;&gt;gpu2_layer13_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1471.51,-3491.4C1457.48,-3478.08 1443.21,-3464.52 1430.97,-3452.89"/>
<polygon fill="black" stroke="black" points="1433.29,-3450.26 1423.63,-3445.91 1428.46,-3455.34 1433.29,-3450.26"/>
<text text-anchor="middle" x="1480.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer13_expert2 -->
<g id="node744" class="node">
<title>gpu2_layer13_expert2</title>
<polygon fill="lightblue" stroke="black" points="1598,-3445.62 1476,-3445.62 1476,-3393.62 1598,-3393.62 1598,-3445.62"/>
<text text-anchor="middle" x="1537" y="-3433.62" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="1537" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer13_routing&#45;&gt;gpu2_layer13_expert2 -->
<g id="edge913" class="edge">
<title>gpu2_layer13_routing&#45;&gt;gpu2_layer13_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1537,-3491.4C1537,-3479.33 1537,-3467.08 1537,-3456.23"/>
<polygon fill="black" stroke="black" points="1540.5,-3455.91 1537,-3445.91 1533.5,-3455.91 1540.5,-3455.91"/>
<text text-anchor="middle" x="1566.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer13_expert3 -->
<g id="node745" class="node">
<title>gpu2_layer13_expert3</title>
<polygon fill="lightblue" stroke="black" points="1738,-3445.62 1616,-3445.62 1616,-3393.62 1738,-3393.62 1738,-3445.62"/>
<text text-anchor="middle" x="1677" y="-3433.62" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1677" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer13_routing&#45;&gt;gpu2_layer13_expert3 -->
<g id="edge914" class="edge">
<title>gpu2_layer13_routing&#45;&gt;gpu2_layer13_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1602.49,-3491.4C1616.52,-3478.08 1630.79,-3464.52 1643.03,-3452.89"/>
<polygon fill="black" stroke="black" points="1645.54,-3455.34 1650.37,-3445.91 1640.71,-3450.26 1645.54,-3455.34"/>
<text text-anchor="middle" x="1661.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer13_expert_agg -->
<g id="node746" class="node">
<title>gpu2_layer13_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-3356.62 1462.29,-3356.62 1410.53,-3252.62 1611.71,-3252.62 1663.47,-3356.62"/>
<text text-anchor="middle" x="1537" y="-3318.62" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="1537" y="-3307.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-3296.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-3285.62" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer13_routing&#45;&gt;gpu2_layer13_expert_agg -->
<g id="edge929" class="edge">
<title>gpu2_layer13_routing&#45;&gt;gpu2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M1626.22,-3526.7C1699.96,-3499.54 1786.6,-3453.15 1747,-3393.62 1726.44,-3362.71 1692.7,-3342.63 1658.22,-3329.6"/>
<polygon fill="black" stroke="black" points="1659.08,-3326.19 1648.48,-3326.11 1656.71,-3332.78 1659.08,-3326.19"/>
</g>
<!-- gpu2_layer13_expert0&#45;&gt;gpu2_layer13_expert_agg -->
<g id="edge925" class="edge">
<title>gpu2_layer13_expert0&#45;&gt;gpu2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M1318.1,-3393.96C1354.98,-3379.08 1402.7,-3359.82 1444.16,-3343.08"/>
<polygon fill="black" stroke="black" points="1445.5,-3346.32 1453.46,-3339.33 1442.88,-3339.83 1445.5,-3346.32"/>
</g>
<!-- gpu2_layer13_expert1&#45;&gt;gpu2_layer13_expert_agg -->
<g id="edge926" class="edge">
<title>gpu2_layer13_expert1&#45;&gt;gpu2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M1428.07,-3393.54C1439.32,-3384.46 1452.53,-3373.8 1465.8,-3363.09"/>
<polygon fill="black" stroke="black" points="1468.02,-3365.79 1473.6,-3356.79 1463.62,-3360.35 1468.02,-3365.79"/>
</g>
<!-- gpu2_layer13_expert2&#45;&gt;gpu2_layer13_expert_agg -->
<g id="edge927" class="edge">
<title>gpu2_layer13_expert2&#45;&gt;gpu2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M1537,-3393.54C1537,-3385.61 1537,-3376.48 1537,-3367.16"/>
<polygon fill="black" stroke="black" points="1540.5,-3367.02 1537,-3357.02 1533.5,-3367.02 1540.5,-3367.02"/>
</g>
<!-- gpu2_layer13_expert3&#45;&gt;gpu2_layer13_expert_agg -->
<g id="edge928" class="edge">
<title>gpu2_layer13_expert3&#45;&gt;gpu2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M1645.93,-3393.54C1634.68,-3384.46 1621.47,-3373.8 1608.2,-3363.09"/>
<polygon fill="black" stroke="black" points="1610.38,-3360.35 1600.4,-3356.79 1605.98,-3365.79 1610.38,-3360.35"/>
</g>
<!-- gpu2_layer13_res2 -->
<g id="node747" class="node">
<title>gpu2_layer13_res2</title>
<polygon fill="lightblue" stroke="black" points="1598,-3215.62 1476,-3215.62 1476,-3163.62 1598,-3163.62 1598,-3215.62"/>
<text text-anchor="middle" x="1537" y="-3203.62" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="1537" y="-3192.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-3181.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-3170.62" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer13_expert_agg&#45;&gt;gpu2_layer13_res2 -->
<g id="edge930" class="edge">
<title>gpu2_layer13_expert_agg&#45;&gt;gpu2_layer13_res2</title>
<path fill="none" stroke="black" d="M1537,-3252.41C1537,-3243.46 1537,-3234.33 1537,-3225.93"/>
<polygon fill="black" stroke="black" points="1540.5,-3225.75 1537,-3215.75 1533.5,-3225.75 1540.5,-3225.75"/>
</g>
<!-- gpu2_layer14_ln1 -->
<g id="node748" class="node">
<title>gpu2_layer14_ln1</title>
<polygon fill="lightblue" stroke="black" points="1598,-3126.62 1476,-3126.62 1476,-3074.62 1598,-3074.62 1598,-3126.62"/>
<text text-anchor="middle" x="1537" y="-3114.62" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="1537" y="-3103.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-3092.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-3081.62" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer13_res2&#45;&gt;gpu2_layer14_ln1 -->
<g id="edge935" class="edge">
<title>gpu2_layer13_res2&#45;&gt;gpu2_layer14_ln1</title>
<path fill="none" stroke="black" d="M1537,-3163.45C1537,-3155.16 1537,-3145.77 1537,-3136.87"/>
<polygon fill="black" stroke="black" points="1540.5,-3136.72 1537,-3126.72 1533.5,-3136.72 1540.5,-3136.72"/>
</g>
<!-- gpu2_layer14_qkv -->
<g id="node749" class="node">
<title>gpu2_layer14_qkv</title>
<polygon fill="lightblue" stroke="black" points="1598,-3037.62 1476,-3037.62 1476,-2985.62 1598,-2985.62 1598,-3037.62"/>
<text text-anchor="middle" x="1537" y="-3025.62" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1537" y="-3014.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-3003.62" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-2992.62" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer14_ln1&#45;&gt;gpu2_layer14_qkv -->
<g id="edge936" class="edge">
<title>gpu2_layer14_ln1&#45;&gt;gpu2_layer14_qkv</title>
<path fill="none" stroke="black" d="M1537,-3074.45C1537,-3066.16 1537,-3056.77 1537,-3047.87"/>
<polygon fill="black" stroke="black" points="1540.5,-3047.72 1537,-3037.72 1533.5,-3047.72 1540.5,-3047.72"/>
</g>
<!-- gpu2_layer14_reshape -->
<g id="node750" class="node">
<title>gpu2_layer14_reshape</title>
<polygon fill="lightblue" stroke="black" points="1601,-2948.62 1473,-2948.62 1473,-2896.62 1601,-2896.62 1601,-2948.62"/>
<text text-anchor="middle" x="1537" y="-2936.62" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="1537" y="-2925.62" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-2914.62" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-2903.62" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer14_qkv&#45;&gt;gpu2_layer14_reshape -->
<g id="edge937" class="edge">
<title>gpu2_layer14_qkv&#45;&gt;gpu2_layer14_reshape</title>
<path fill="none" stroke="black" d="M1537,-2985.45C1537,-2977.16 1537,-2967.77 1537,-2958.87"/>
<polygon fill="black" stroke="black" points="1540.5,-2958.72 1537,-2948.72 1533.5,-2958.72 1540.5,-2958.72"/>
</g>
<!-- gpu2_layer14_attn -->
<g id="node751" class="node">
<title>gpu2_layer14_attn</title>
<polygon fill="lightblue" stroke="black" points="1601,-2859.62 1473,-2859.62 1473,-2807.62 1601,-2807.62 1601,-2859.62"/>
<text text-anchor="middle" x="1537" y="-2847.62" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1537" y="-2836.62" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-2825.62" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-2814.62" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer14_reshape&#45;&gt;gpu2_layer14_attn -->
<g id="edge938" class="edge">
<title>gpu2_layer14_reshape&#45;&gt;gpu2_layer14_attn</title>
<path fill="none" stroke="black" d="M1537,-2896.45C1537,-2888.16 1537,-2878.77 1537,-2869.87"/>
<polygon fill="black" stroke="black" points="1540.5,-2869.72 1537,-2859.72 1533.5,-2869.72 1540.5,-2869.72"/>
</g>
<!-- gpu2_layer14_attn_reshape -->
<g id="node753" class="node">
<title>gpu2_layer14_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1598,-2770.62 1476,-2770.62 1476,-2718.62 1598,-2718.62 1598,-2770.62"/>
<text text-anchor="middle" x="1537" y="-2758.62" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="1537" y="-2747.62" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-2736.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-2725.62" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer14_attn&#45;&gt;gpu2_layer14_attn_reshape -->
<g id="edge939" class="edge">
<title>gpu2_layer14_attn&#45;&gt;gpu2_layer14_attn_reshape</title>
<path fill="none" stroke="black" d="M1537,-2807.45C1537,-2799.16 1537,-2789.77 1537,-2780.87"/>
<polygon fill="black" stroke="black" points="1540.5,-2780.72 1537,-2770.72 1533.5,-2780.72 1540.5,-2780.72"/>
</g>
<!-- gpu2_layer14_attn_out -->
<g id="node752" class="node">
<title>gpu2_layer14_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1598,-2681.62 1476,-2681.62 1476,-2629.62 1598,-2629.62 1598,-2681.62"/>
<text text-anchor="middle" x="1537" y="-2669.62" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="1537" y="-2658.62" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-2647.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-2636.62" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer14_kv_update -->
<g id="node754" class="node">
<title>gpu2_layer14_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="1537" cy="-2555.85" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="1537" y="-2569.85" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="1537" y="-2558.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-2547.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-2536.85" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer14_attn_out&#45;&gt;gpu2_layer14_kv_update -->
<g id="edge941" class="edge">
<title>gpu2_layer14_attn_out&#45;&gt;gpu2_layer14_kv_update</title>
<path fill="none" stroke="black" d="M1537,-2629.44C1537,-2621.3 1537,-2612 1537,-2602.84"/>
<polygon fill="black" stroke="black" points="1540.5,-2602.63 1537,-2592.63 1533.5,-2602.63 1540.5,-2602.63"/>
</g>
<!-- gpu2_layer14_attn_reshape&#45;&gt;gpu2_layer14_attn_out -->
<g id="edge940" class="edge">
<title>gpu2_layer14_attn_reshape&#45;&gt;gpu2_layer14_attn_out</title>
<path fill="none" stroke="black" d="M1537,-2718.45C1537,-2710.16 1537,-2700.77 1537,-2691.87"/>
<polygon fill="black" stroke="black" points="1540.5,-2691.72 1537,-2681.72 1533.5,-2691.72 1540.5,-2691.72"/>
</g>
<!-- gpu2_layer14_res1 -->
<g id="node755" class="node">
<title>gpu2_layer14_res1</title>
<polygon fill="lightblue" stroke="black" points="1598,-2482.08 1476,-2482.08 1476,-2430.08 1598,-2430.08 1598,-2482.08"/>
<text text-anchor="middle" x="1537" y="-2470.08" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="1537" y="-2459.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-2448.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-2437.08" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer14_kv_update&#45;&gt;gpu2_layer14_res1 -->
<g id="edge942" class="edge">
<title>gpu2_layer14_kv_update&#45;&gt;gpu2_layer14_res1</title>
<path fill="none" stroke="black" d="M1537,-2519C1537,-2510.32 1537,-2501.05 1537,-2492.39"/>
<polygon fill="black" stroke="black" points="1540.5,-2492.22 1537,-2482.22 1533.5,-2492.22 1540.5,-2492.22"/>
</g>
<!-- gpu2_layer14_ln2 -->
<g id="node756" class="node">
<title>gpu2_layer14_ln2</title>
<polygon fill="lightblue" stroke="black" points="1598,-2393.08 1476,-2393.08 1476,-2341.08 1598,-2341.08 1598,-2393.08"/>
<text text-anchor="middle" x="1537" y="-2381.08" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="1537" y="-2370.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-2359.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-2348.08" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer14_res1&#45;&gt;gpu2_layer14_ln2 -->
<g id="edge943" class="edge">
<title>gpu2_layer14_res1&#45;&gt;gpu2_layer14_ln2</title>
<path fill="none" stroke="black" d="M1537,-2429.91C1537,-2421.62 1537,-2412.23 1537,-2403.33"/>
<polygon fill="black" stroke="black" points="1540.5,-2403.19 1537,-2393.19 1533.5,-2403.19 1540.5,-2403.19"/>
</g>
<!-- gpu2_layer14_routing -->
<g id="node757" class="node">
<title>gpu2_layer14_routing</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-2304.08 1462.29,-2304.08 1410.53,-2178.08 1611.71,-2178.08 1663.47,-2304.08"/>
<text text-anchor="middle" x="1537" y="-2260.58" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="1537" y="-2249.58" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-2238.58" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-2227.58" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="1537" y="-2216.58" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer14_ln2&#45;&gt;gpu2_layer14_routing -->
<g id="edge944" class="edge">
<title>gpu2_layer14_ln2&#45;&gt;gpu2_layer14_routing</title>
<path fill="none" stroke="black" d="M1537,-2340.98C1537,-2333.05 1537,-2323.86 1537,-2314.33"/>
<polygon fill="black" stroke="black" points="1540.5,-2314.31 1537,-2304.31 1533.5,-2314.31 1540.5,-2314.31"/>
</g>
<!-- gpu2_layer14_expert0 -->
<g id="node758" class="node">
<title>gpu2_layer14_expert0</title>
<polygon fill="lightblue" stroke="black" points="1318,-2132.08 1196,-2132.08 1196,-2080.08 1318,-2080.08 1318,-2132.08"/>
<text text-anchor="middle" x="1257" y="-2120.08" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1257" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer14_routing&#45;&gt;gpu2_layer14_expert0 -->
<g id="edge931" class="edge">
<title>gpu2_layer14_routing&#45;&gt;gpu2_layer14_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1411.33,-2180.39C1379.34,-2165.19 1346.34,-2149.51 1319.11,-2136.58"/>
<polygon fill="black" stroke="black" points="1320.26,-2133.25 1309.73,-2132.12 1317.26,-2139.58 1320.26,-2133.25"/>
<text text-anchor="middle" x="1393.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer14_expert1 -->
<g id="node759" class="node">
<title>gpu2_layer14_expert1</title>
<polygon fill="lightblue" stroke="black" points="1458,-2132.08 1336,-2132.08 1336,-2080.08 1458,-2080.08 1458,-2132.08"/>
<text text-anchor="middle" x="1397" y="-2120.08" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1397" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer14_routing&#45;&gt;gpu2_layer14_expert1 -->
<g id="edge932" class="edge">
<title>gpu2_layer14_routing&#45;&gt;gpu2_layer14_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1471.51,-2177.86C1457.48,-2164.54 1443.21,-2150.98 1430.97,-2139.35"/>
<polygon fill="black" stroke="black" points="1433.29,-2136.72 1423.63,-2132.37 1428.46,-2141.8 1433.29,-2136.72"/>
<text text-anchor="middle" x="1480.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer14_expert2 -->
<g id="node760" class="node">
<title>gpu2_layer14_expert2</title>
<polygon fill="lightblue" stroke="black" points="1598,-2132.08 1476,-2132.08 1476,-2080.08 1598,-2080.08 1598,-2132.08"/>
<text text-anchor="middle" x="1537" y="-2120.08" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="1537" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer14_routing&#45;&gt;gpu2_layer14_expert2 -->
<g id="edge933" class="edge">
<title>gpu2_layer14_routing&#45;&gt;gpu2_layer14_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1537,-2177.86C1537,-2165.79 1537,-2153.54 1537,-2142.69"/>
<polygon fill="black" stroke="black" points="1540.5,-2142.37 1537,-2132.37 1533.5,-2142.37 1540.5,-2142.37"/>
<text text-anchor="middle" x="1566.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer14_expert3 -->
<g id="node761" class="node">
<title>gpu2_layer14_expert3</title>
<polygon fill="lightblue" stroke="black" points="1738,-2132.08 1616,-2132.08 1616,-2080.08 1738,-2080.08 1738,-2132.08"/>
<text text-anchor="middle" x="1677" y="-2120.08" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1677" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer14_routing&#45;&gt;gpu2_layer14_expert3 -->
<g id="edge934" class="edge">
<title>gpu2_layer14_routing&#45;&gt;gpu2_layer14_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1602.49,-2177.86C1616.52,-2164.54 1630.79,-2150.98 1643.03,-2139.35"/>
<polygon fill="black" stroke="black" points="1645.54,-2141.8 1650.37,-2132.37 1640.71,-2136.72 1645.54,-2141.8"/>
<text text-anchor="middle" x="1661.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer14_expert_agg -->
<g id="node762" class="node">
<title>gpu2_layer14_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-2043.08 1462.29,-2043.08 1410.53,-1939.08 1611.71,-1939.08 1663.47,-2043.08"/>
<text text-anchor="middle" x="1537" y="-2005.08" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="1537" y="-1994.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-1983.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-1972.08" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer14_routing&#45;&gt;gpu2_layer14_expert_agg -->
<g id="edge949" class="edge">
<title>gpu2_layer14_routing&#45;&gt;gpu2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M1626.22,-2213.16C1699.96,-2186 1786.6,-2139.61 1747,-2080.08 1726.44,-2049.17 1692.7,-2029.09 1658.22,-2016.06"/>
<polygon fill="black" stroke="black" points="1659.08,-2012.65 1648.48,-2012.57 1656.71,-2019.24 1659.08,-2012.65"/>
</g>
<!-- gpu2_layer14_expert0&#45;&gt;gpu2_layer14_expert_agg -->
<g id="edge945" class="edge">
<title>gpu2_layer14_expert0&#45;&gt;gpu2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M1318.1,-2080.42C1354.98,-2065.54 1402.7,-2046.28 1444.16,-2029.54"/>
<polygon fill="black" stroke="black" points="1445.5,-2032.78 1453.46,-2025.79 1442.88,-2026.29 1445.5,-2032.78"/>
</g>
<!-- gpu2_layer14_expert1&#45;&gt;gpu2_layer14_expert_agg -->
<g id="edge946" class="edge">
<title>gpu2_layer14_expert1&#45;&gt;gpu2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M1428.07,-2080C1439.32,-2070.92 1452.53,-2060.26 1465.8,-2049.55"/>
<polygon fill="black" stroke="black" points="1468.02,-2052.25 1473.6,-2043.25 1463.62,-2046.81 1468.02,-2052.25"/>
</g>
<!-- gpu2_layer14_expert2&#45;&gt;gpu2_layer14_expert_agg -->
<g id="edge947" class="edge">
<title>gpu2_layer14_expert2&#45;&gt;gpu2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M1537,-2080C1537,-2072.07 1537,-2062.94 1537,-2053.62"/>
<polygon fill="black" stroke="black" points="1540.5,-2053.48 1537,-2043.48 1533.5,-2053.48 1540.5,-2053.48"/>
</g>
<!-- gpu2_layer14_expert3&#45;&gt;gpu2_layer14_expert_agg -->
<g id="edge948" class="edge">
<title>gpu2_layer14_expert3&#45;&gt;gpu2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M1645.93,-2080C1634.68,-2070.92 1621.47,-2060.26 1608.2,-2049.55"/>
<polygon fill="black" stroke="black" points="1610.38,-2046.81 1600.4,-2043.25 1605.98,-2052.25 1610.38,-2046.81"/>
</g>
<!-- gpu2_layer14_res2 -->
<g id="node763" class="node">
<title>gpu2_layer14_res2</title>
<polygon fill="lightblue" stroke="black" points="1598,-1902.08 1476,-1902.08 1476,-1850.08 1598,-1850.08 1598,-1902.08"/>
<text text-anchor="middle" x="1537" y="-1890.08" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="1537" y="-1879.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-1868.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-1857.08" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer14_expert_agg&#45;&gt;gpu2_layer14_res2 -->
<g id="edge950" class="edge">
<title>gpu2_layer14_expert_agg&#45;&gt;gpu2_layer14_res2</title>
<path fill="none" stroke="black" d="M1537,-1938.87C1537,-1929.92 1537,-1920.79 1537,-1912.39"/>
<polygon fill="black" stroke="black" points="1540.5,-1912.21 1537,-1902.21 1533.5,-1912.21 1540.5,-1912.21"/>
</g>
<!-- gpu2_layer15_ln1 -->
<g id="node764" class="node">
<title>gpu2_layer15_ln1</title>
<polygon fill="lightblue" stroke="black" points="1598,-1813.08 1476,-1813.08 1476,-1761.08 1598,-1761.08 1598,-1813.08"/>
<text text-anchor="middle" x="1537" y="-1801.08" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="1537" y="-1790.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-1779.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-1768.08" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer14_res2&#45;&gt;gpu2_layer15_ln1 -->
<g id="edge955" class="edge">
<title>gpu2_layer14_res2&#45;&gt;gpu2_layer15_ln1</title>
<path fill="none" stroke="black" d="M1537,-1849.91C1537,-1841.62 1537,-1832.23 1537,-1823.33"/>
<polygon fill="black" stroke="black" points="1540.5,-1823.19 1537,-1813.19 1533.5,-1823.19 1540.5,-1823.19"/>
</g>
<!-- gpu2_layer15_qkv -->
<g id="node765" class="node">
<title>gpu2_layer15_qkv</title>
<polygon fill="lightblue" stroke="black" points="1598,-1724.08 1476,-1724.08 1476,-1672.08 1598,-1672.08 1598,-1724.08"/>
<text text-anchor="middle" x="1537" y="-1712.08" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1537" y="-1701.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-1690.08" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-1679.08" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer15_ln1&#45;&gt;gpu2_layer15_qkv -->
<g id="edge956" class="edge">
<title>gpu2_layer15_ln1&#45;&gt;gpu2_layer15_qkv</title>
<path fill="none" stroke="black" d="M1537,-1760.91C1537,-1752.62 1537,-1743.23 1537,-1734.33"/>
<polygon fill="black" stroke="black" points="1540.5,-1734.19 1537,-1724.19 1533.5,-1734.19 1540.5,-1734.19"/>
</g>
<!-- gpu2_layer15_reshape -->
<g id="node766" class="node">
<title>gpu2_layer15_reshape</title>
<polygon fill="lightblue" stroke="black" points="1601,-1635.08 1473,-1635.08 1473,-1583.08 1601,-1583.08 1601,-1635.08"/>
<text text-anchor="middle" x="1537" y="-1623.08" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="1537" y="-1612.08" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="1537" y="-1601.08" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-1590.08" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer15_qkv&#45;&gt;gpu2_layer15_reshape -->
<g id="edge957" class="edge">
<title>gpu2_layer15_qkv&#45;&gt;gpu2_layer15_reshape</title>
<path fill="none" stroke="black" d="M1537,-1671.91C1537,-1663.62 1537,-1654.23 1537,-1645.33"/>
<polygon fill="black" stroke="black" points="1540.5,-1645.19 1537,-1635.19 1533.5,-1645.19 1540.5,-1645.19"/>
</g>
<!-- gpu2_layer15_attn -->
<g id="node767" class="node">
<title>gpu2_layer15_attn</title>
<polygon fill="lightblue" stroke="black" points="1601,-1546.08 1473,-1546.08 1473,-1494.08 1601,-1494.08 1601,-1546.08"/>
<text text-anchor="middle" x="1537" y="-1534.08" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1537" y="-1523.08" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-1512.08" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-1501.08" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer15_reshape&#45;&gt;gpu2_layer15_attn -->
<g id="edge958" class="edge">
<title>gpu2_layer15_reshape&#45;&gt;gpu2_layer15_attn</title>
<path fill="none" stroke="black" d="M1537,-1582.91C1537,-1574.62 1537,-1565.23 1537,-1556.33"/>
<polygon fill="black" stroke="black" points="1540.5,-1556.19 1537,-1546.19 1533.5,-1556.19 1540.5,-1556.19"/>
</g>
<!-- gpu2_layer15_attn_reshape -->
<g id="node769" class="node">
<title>gpu2_layer15_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1598,-1457.08 1476,-1457.08 1476,-1405.08 1598,-1405.08 1598,-1457.08"/>
<text text-anchor="middle" x="1537" y="-1445.08" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="1537" y="-1434.08" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-1423.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-1412.08" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer15_attn&#45;&gt;gpu2_layer15_attn_reshape -->
<g id="edge959" class="edge">
<title>gpu2_layer15_attn&#45;&gt;gpu2_layer15_attn_reshape</title>
<path fill="none" stroke="black" d="M1537,-1493.91C1537,-1485.62 1537,-1476.23 1537,-1467.33"/>
<polygon fill="black" stroke="black" points="1540.5,-1467.19 1537,-1457.19 1533.5,-1467.19 1540.5,-1467.19"/>
</g>
<!-- gpu2_layer15_attn_out -->
<g id="node768" class="node">
<title>gpu2_layer15_attn_out</title>
<polygon fill="lightblue" stroke="black" points="1598,-1368.08 1476,-1368.08 1476,-1316.08 1598,-1316.08 1598,-1368.08"/>
<text text-anchor="middle" x="1537" y="-1356.08" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="1537" y="-1345.08" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="1537" y="-1334.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-1323.08" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer15_kv_update -->
<g id="node770" class="node">
<title>gpu2_layer15_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="1537" cy="-1242.31" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="1537" y="-1256.31" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="1537" y="-1245.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-1234.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-1223.31" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer15_attn_out&#45;&gt;gpu2_layer15_kv_update -->
<g id="edge961" class="edge">
<title>gpu2_layer15_attn_out&#45;&gt;gpu2_layer15_kv_update</title>
<path fill="none" stroke="black" d="M1537,-1315.9C1537,-1307.76 1537,-1298.46 1537,-1289.3"/>
<polygon fill="black" stroke="black" points="1540.5,-1289.09 1537,-1279.09 1533.5,-1289.09 1540.5,-1289.09"/>
</g>
<!-- gpu2_layer15_attn_reshape&#45;&gt;gpu2_layer15_attn_out -->
<g id="edge960" class="edge">
<title>gpu2_layer15_attn_reshape&#45;&gt;gpu2_layer15_attn_out</title>
<path fill="none" stroke="black" d="M1537,-1404.91C1537,-1396.62 1537,-1387.23 1537,-1378.33"/>
<polygon fill="black" stroke="black" points="1540.5,-1378.19 1537,-1368.19 1533.5,-1378.19 1540.5,-1378.19"/>
</g>
<!-- gpu2_layer15_res1 -->
<g id="node771" class="node">
<title>gpu2_layer15_res1</title>
<polygon fill="lightblue" stroke="black" points="1598,-1168.54 1476,-1168.54 1476,-1116.54 1598,-1116.54 1598,-1168.54"/>
<text text-anchor="middle" x="1537" y="-1156.54" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="1537" y="-1145.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-1134.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-1123.54" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer15_kv_update&#45;&gt;gpu2_layer15_res1 -->
<g id="edge962" class="edge">
<title>gpu2_layer15_kv_update&#45;&gt;gpu2_layer15_res1</title>
<path fill="none" stroke="black" d="M1537,-1205.46C1537,-1196.78 1537,-1187.51 1537,-1178.85"/>
<polygon fill="black" stroke="black" points="1540.5,-1178.69 1537,-1168.69 1533.5,-1178.69 1540.5,-1178.69"/>
</g>
<!-- gpu2_layer15_ln2 -->
<g id="node772" class="node">
<title>gpu2_layer15_ln2</title>
<polygon fill="lightblue" stroke="black" points="1598,-1079.54 1476,-1079.54 1476,-1027.54 1598,-1027.54 1598,-1079.54"/>
<text text-anchor="middle" x="1537" y="-1067.54" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="1537" y="-1056.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-1045.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-1034.54" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer15_res1&#45;&gt;gpu2_layer15_ln2 -->
<g id="edge963" class="edge">
<title>gpu2_layer15_res1&#45;&gt;gpu2_layer15_ln2</title>
<path fill="none" stroke="black" d="M1537,-1116.38C1537,-1108.08 1537,-1098.69 1537,-1089.79"/>
<polygon fill="black" stroke="black" points="1540.5,-1089.65 1537,-1079.65 1533.5,-1089.65 1540.5,-1089.65"/>
</g>
<!-- gpu2_layer15_routing -->
<g id="node773" class="node">
<title>gpu2_layer15_routing</title>
<polygon fill="lightyellow" stroke="black" points="1663.47,-990.54 1462.29,-990.54 1410.53,-864.54 1611.71,-864.54 1663.47,-990.54"/>
<text text-anchor="middle" x="1537" y="-947.04" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="1537" y="-936.04" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-925.04" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-914.04" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="1537" y="-903.04" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer15_ln2&#45;&gt;gpu2_layer15_routing -->
<g id="edge964" class="edge">
<title>gpu2_layer15_ln2&#45;&gt;gpu2_layer15_routing</title>
<path fill="none" stroke="black" d="M1537,-1027.45C1537,-1019.51 1537,-1010.32 1537,-1000.79"/>
<polygon fill="black" stroke="black" points="1540.5,-1000.77 1537,-990.77 1533.5,-1000.77 1540.5,-1000.77"/>
</g>
<!-- gpu2_layer15_expert0 -->
<g id="node774" class="node">
<title>gpu2_layer15_expert0</title>
<polygon fill="lightblue" stroke="black" points="1318,-818.54 1196,-818.54 1196,-766.54 1318,-766.54 1318,-818.54"/>
<text text-anchor="middle" x="1257" y="-806.54" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1257" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1257" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer15_routing&#45;&gt;gpu2_layer15_expert0 -->
<g id="edge951" class="edge">
<title>gpu2_layer15_routing&#45;&gt;gpu2_layer15_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1411.33,-866.85C1379.34,-851.65 1346.34,-835.98 1319.11,-823.04"/>
<polygon fill="black" stroke="black" points="1320.26,-819.71 1309.73,-818.58 1317.26,-826.04 1320.26,-819.71"/>
<text text-anchor="middle" x="1393.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer15_expert1 -->
<g id="node775" class="node">
<title>gpu2_layer15_expert1</title>
<polygon fill="lightblue" stroke="black" points="1458,-818.54 1336,-818.54 1336,-766.54 1458,-766.54 1458,-818.54"/>
<text text-anchor="middle" x="1397" y="-806.54" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1397" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1397" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer15_routing&#45;&gt;gpu2_layer15_expert1 -->
<g id="edge952" class="edge">
<title>gpu2_layer15_routing&#45;&gt;gpu2_layer15_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1471.51,-864.32C1457.48,-851 1443.21,-837.44 1430.97,-825.81"/>
<polygon fill="black" stroke="black" points="1433.29,-823.18 1423.63,-818.83 1428.46,-828.26 1433.29,-823.18"/>
<text text-anchor="middle" x="1480.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer15_expert2 -->
<g id="node776" class="node">
<title>gpu2_layer15_expert2</title>
<polygon fill="lightblue" stroke="black" points="1598,-818.54 1476,-818.54 1476,-766.54 1598,-766.54 1598,-818.54"/>
<text text-anchor="middle" x="1537" y="-806.54" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="1537" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1537" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer15_routing&#45;&gt;gpu2_layer15_expert2 -->
<g id="edge953" class="edge">
<title>gpu2_layer15_routing&#45;&gt;gpu2_layer15_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1537,-864.32C1537,-852.25 1537,-840 1537,-829.15"/>
<polygon fill="black" stroke="black" points="1540.5,-828.83 1537,-818.83 1533.5,-828.83 1540.5,-828.83"/>
<text text-anchor="middle" x="1566.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer15_expert3 -->
<g id="node777" class="node">
<title>gpu2_layer15_expert3</title>
<polygon fill="lightblue" stroke="black" points="1738,-818.54 1616,-818.54 1616,-766.54 1738,-766.54 1738,-818.54"/>
<text text-anchor="middle" x="1677" y="-806.54" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1677" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1677" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer15_routing&#45;&gt;gpu2_layer15_expert3 -->
<g id="edge954" class="edge">
<title>gpu2_layer15_routing&#45;&gt;gpu2_layer15_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1602.49,-864.32C1616.52,-851 1630.79,-837.44 1643.03,-825.81"/>
<polygon fill="black" stroke="black" points="1645.54,-828.26 1650.37,-818.83 1640.71,-823.18 1645.54,-828.26"/>
<text text-anchor="middle" x="1661.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu2_layer15_expert_agg -->
<g id="node778" class="node">
<title>gpu2_layer15_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="1741.47,-729.54 1540.29,-729.54 1488.53,-625.54 1689.71,-625.54 1741.47,-729.54"/>
<text text-anchor="middle" x="1615" y="-691.54" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="1615" y="-680.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1615" y="-669.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1615" y="-658.54" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer15_routing&#45;&gt;gpu2_layer15_expert_agg -->
<g id="edge969" class="edge">
<title>gpu2_layer15_routing&#45;&gt;gpu2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M1628.02,-904.14C1672.26,-888.13 1721.3,-861.57 1747,-818.54 1758.85,-798.7 1757.91,-786.92 1747,-766.54 1741.05,-755.43 1733.01,-745.47 1723.82,-736.62"/>
<polygon fill="black" stroke="black" points="1725.98,-733.86 1716.22,-729.76 1721.29,-739.06 1725.98,-733.86"/>
</g>
<!-- gpu2_layer15_expert0&#45;&gt;gpu2_layer15_expert_agg -->
<g id="edge965" class="edge">
<title>gpu2_layer15_expert0&#45;&gt;gpu2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M1318.03,-769.56C1321.06,-768.52 1324.06,-767.51 1327,-766.54 1390.09,-745.65 1461.54,-723.8 1517.48,-707.11"/>
<polygon fill="black" stroke="black" points="1518.8,-710.37 1527.39,-704.16 1516.81,-703.66 1518.8,-710.37"/>
</g>
<!-- gpu2_layer15_expert1&#45;&gt;gpu2_layer15_expert_agg -->
<g id="edge966" class="edge">
<title>gpu2_layer15_expert1&#45;&gt;gpu2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M1445.38,-766.46C1469.15,-754.14 1498.56,-738.9 1526.18,-724.58"/>
<polygon fill="black" stroke="black" points="1527.8,-727.68 1535.07,-719.97 1524.58,-721.46 1527.8,-727.68"/>
</g>
<!-- gpu2_layer15_expert2&#45;&gt;gpu2_layer15_expert_agg -->
<g id="edge967" class="edge">
<title>gpu2_layer15_expert2&#45;&gt;gpu2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M1554.31,-766.46C1560.13,-758.03 1566.9,-748.23 1573.76,-738.29"/>
<polygon fill="black" stroke="black" points="1576.72,-740.16 1579.52,-729.94 1570.96,-736.18 1576.72,-740.16"/>
</g>
<!-- gpu2_layer15_expert3&#45;&gt;gpu2_layer15_expert_agg -->
<g id="edge968" class="edge">
<title>gpu2_layer15_expert3&#45;&gt;gpu2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M1663.24,-766.46C1658.71,-758.2 1653.45,-748.62 1648.11,-738.89"/>
<polygon fill="black" stroke="black" points="1651.08,-737.02 1643.2,-729.94 1644.94,-740.39 1651.08,-737.02"/>
</g>
<!-- gpu2_layer15_res2 -->
<g id="node779" class="node">
<title>gpu2_layer15_res2</title>
<polygon fill="lightblue" stroke="black" points="1737,-588.54 1615,-588.54 1615,-536.54 1737,-536.54 1737,-588.54"/>
<text text-anchor="middle" x="1676" y="-576.54" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="1676" y="-565.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1676" y="-554.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1676" y="-543.54" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer15_expert_agg&#45;&gt;gpu2_layer15_res2 -->
<g id="edge970" class="edge">
<title>gpu2_layer15_expert_agg&#45;&gt;gpu2_layer15_res2</title>
<path fill="none" stroke="black" d="M1642.64,-625.33C1647.69,-615.98 1652.84,-606.44 1657.54,-597.73"/>
<polygon fill="black" stroke="black" points="1660.76,-599.13 1662.43,-588.67 1654.6,-595.81 1660.76,-599.13"/>
</g>
<!-- gpu2_final_ln -->
<g id="node780" class="node">
<title>gpu2_final_ln</title>
<polygon fill="lightblue" stroke="black" points="1858,-499.54 1736,-499.54 1736,-447.54 1858,-447.54 1858,-499.54"/>
<text text-anchor="middle" x="1797" y="-487.54" font-family="Arial" font-size="10.00">Final LayerNorm</text>
<text text-anchor="middle" x="1797" y="-476.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1797" y="-465.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1797" y="-454.54" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_layer15_res2&#45;&gt;gpu2_final_ln -->
<g id="edge971" class="edge">
<title>gpu2_layer15_res2&#45;&gt;gpu2_final_ln</title>
<path fill="none" stroke="black" d="M1711,-536.38C1724.29,-526.82 1739.6,-515.81 1753.58,-505.76"/>
<polygon fill="black" stroke="black" points="1756,-508.33 1762.08,-499.65 1751.92,-502.64 1756,-508.33"/>
</g>
<!-- gpu2_output_proj -->
<g id="node781" class="node">
<title>gpu2_output_proj</title>
<polygon fill="lightblue" stroke="black" points="1935,-410.54 1807,-410.54 1807,-358.54 1935,-358.54 1935,-410.54"/>
<text text-anchor="middle" x="1871" y="-398.54" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="1871" y="-387.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1871" y="-376.54" font-family="Arial" font-size="10.00">Output: [256, 512, 32000]</text>
<text text-anchor="middle" x="1871" y="-365.54" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_final_ln&#45;&gt;gpu2_output_proj -->
<g id="edge972" class="edge">
<title>gpu2_final_ln&#45;&gt;gpu2_output_proj</title>
<path fill="none" stroke="black" d="M1818.4,-447.38C1826.07,-438.36 1834.84,-428.05 1842.98,-418.48"/>
<polygon fill="black" stroke="black" points="1845.83,-420.53 1849.64,-410.65 1840.5,-416 1845.83,-420.53"/>
</g>
<!-- gpu2_softmax -->
<g id="node782" class="node">
<title>gpu2_softmax</title>
<polygon fill="lightblue" stroke="black" points="2213,-321.54 2085,-321.54 2085,-269.54 2213,-269.54 2213,-321.54"/>
<text text-anchor="middle" x="2149" y="-309.54" font-family="Arial" font-size="10.00">Softmax</text>
<text text-anchor="middle" x="2149" y="-298.54" font-family="Arial" font-size="10.00">Input: [256, 512, 32000]</text>
<text text-anchor="middle" x="2149" y="-287.54" font-family="Arial" font-size="10.00">Output: [256, 512, 32000]</text>
<text text-anchor="middle" x="2149" y="-276.54" font-family="Arial" font-size="10.00">GPU: GPU2</text>
</g>
<!-- gpu2_output_proj&#45;&gt;gpu2_softmax -->
<g id="edge973" class="edge">
<title>gpu2_output_proj&#45;&gt;gpu2_softmax</title>
<path fill="none" stroke="black" d="M1935.13,-363.47C1976.87,-350.41 2031.45,-333.33 2075.03,-319.69"/>
<polygon fill="black" stroke="black" points="2076.22,-322.98 2084.71,-316.66 2074.12,-316.3 2076.22,-322.98"/>
</g>
<!-- gpu2_softmax&#45;&gt;dp_aggregate -->
<g id="edge2596" class="edge">
<title>gpu2_softmax&#45;&gt;dp_aggregate</title>
<path fill="none" stroke="black" d="M2204.41,-269.41C2233.21,-256.35 2269.52,-239.88 2303.99,-224.25"/>
<polygon fill="black" stroke="black" points="2305.51,-227.4 2313.18,-220.08 2302.62,-221.02 2305.51,-227.4"/>
<text text-anchor="middle" x="2287.5" y="-244.34" font-family="Arial" font-size="9.00">GPU 2 output</text>
</g>
<!-- gpu3_layer0_ln1 -->
<g id="node784" class="node">
<title>gpu3_layer0_ln1</title>
<polygon fill="lightblue" stroke="black" points="2314,-21516.16 2192,-21516.16 2192,-21464.16 2314,-21464.16 2314,-21516.16"/>
<text text-anchor="middle" x="2253" y="-21504.16" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2253" y="-21493.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2253" y="-21482.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2253" y="-21471.16" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_embed&#45;&gt;gpu3_layer0_ln1 -->
<g id="edge979" class="edge">
<title>gpu3_embed&#45;&gt;gpu3_layer0_ln1</title>
<path fill="none" stroke="black" d="M2253,-21553C2253,-21544.7 2253,-21535.32 2253,-21526.41"/>
<polygon fill="black" stroke="black" points="2256.5,-21526.27 2253,-21516.27 2249.5,-21526.27 2256.5,-21526.27"/>
</g>
<!-- gpu3_layer0_qkv -->
<g id="node785" class="node">
<title>gpu3_layer0_qkv</title>
<polygon fill="lightblue" stroke="black" points="2314,-21427.16 2192,-21427.16 2192,-21375.16 2314,-21375.16 2314,-21427.16"/>
<text text-anchor="middle" x="2253" y="-21415.16" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2253" y="-21404.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2253" y="-21393.16" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2253" y="-21382.16" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer0_ln1&#45;&gt;gpu3_layer0_qkv -->
<g id="edge980" class="edge">
<title>gpu3_layer0_ln1&#45;&gt;gpu3_layer0_qkv</title>
<path fill="none" stroke="black" d="M2253,-21464C2253,-21455.7 2253,-21446.32 2253,-21437.41"/>
<polygon fill="black" stroke="black" points="2256.5,-21437.27 2253,-21427.27 2249.5,-21437.27 2256.5,-21437.27"/>
</g>
<!-- gpu3_layer0_reshape -->
<g id="node786" class="node">
<title>gpu3_layer0_reshape</title>
<polygon fill="lightblue" stroke="black" points="2316,-21338.16 2188,-21338.16 2188,-21286.16 2316,-21286.16 2316,-21338.16"/>
<text text-anchor="middle" x="2252" y="-21326.16" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2252" y="-21315.16" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2252" y="-21304.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2252" y="-21293.16" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer0_qkv&#45;&gt;gpu3_layer0_reshape -->
<g id="edge981" class="edge">
<title>gpu3_layer0_qkv&#45;&gt;gpu3_layer0_reshape</title>
<path fill="none" stroke="black" d="M2252.71,-21375C2252.62,-21366.7 2252.51,-21357.32 2252.41,-21348.41"/>
<polygon fill="black" stroke="black" points="2255.9,-21348.23 2252.29,-21338.27 2248.9,-21348.31 2255.9,-21348.23"/>
</g>
<!-- gpu3_layer0_attn -->
<g id="node787" class="node">
<title>gpu3_layer0_attn</title>
<polygon fill="lightblue" stroke="black" points="2316,-21249.16 2188,-21249.16 2188,-21197.16 2316,-21197.16 2316,-21249.16"/>
<text text-anchor="middle" x="2252" y="-21237.16" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2252" y="-21226.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2252" y="-21215.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2252" y="-21204.16" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer0_reshape&#45;&gt;gpu3_layer0_attn -->
<g id="edge982" class="edge">
<title>gpu3_layer0_reshape&#45;&gt;gpu3_layer0_attn</title>
<path fill="none" stroke="black" d="M2252,-21286C2252,-21277.7 2252,-21268.32 2252,-21259.41"/>
<polygon fill="black" stroke="black" points="2255.5,-21259.27 2252,-21249.27 2248.5,-21259.27 2255.5,-21259.27"/>
</g>
<!-- gpu3_layer0_attn_reshape -->
<g id="node789" class="node">
<title>gpu3_layer0_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2282,-21160.16 2160,-21160.16 2160,-21108.16 2282,-21108.16 2282,-21160.16"/>
<text text-anchor="middle" x="2221" y="-21148.16" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2221" y="-21137.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2221" y="-21126.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2221" y="-21115.16" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer0_attn&#45;&gt;gpu3_layer0_attn_reshape -->
<g id="edge983" class="edge">
<title>gpu3_layer0_attn&#45;&gt;gpu3_layer0_attn_reshape</title>
<path fill="none" stroke="black" d="M2243.03,-21197C2240.01,-21188.52 2236.59,-21178.91 2233.35,-21169.83"/>
<polygon fill="black" stroke="black" points="2236.6,-21168.52 2229.95,-21160.27 2230.01,-21170.87 2236.6,-21168.52"/>
</g>
<!-- gpu3_layer0_attn_out -->
<g id="node788" class="node">
<title>gpu3_layer0_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2282,-21071.16 2160,-21071.16 2160,-21019.16 2282,-21019.16 2282,-21071.16"/>
<text text-anchor="middle" x="2221" y="-21059.16" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2221" y="-21048.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2221" y="-21037.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2221" y="-21026.16" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer0_kv_update -->
<g id="node790" class="node">
<title>gpu3_layer0_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2219" cy="-20945.4" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2219" y="-20959.4" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2219" y="-20948.4" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2219" y="-20937.4" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2219" y="-20926.4" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer0_attn_out&#45;&gt;gpu3_layer0_kv_update -->
<g id="edge985" class="edge">
<title>gpu3_layer0_attn_out&#45;&gt;gpu3_layer0_kv_update</title>
<path fill="none" stroke="black" d="M2220.48,-21018.99C2220.32,-21010.85 2220.13,-21001.55 2219.94,-20992.39"/>
<polygon fill="black" stroke="black" points="2223.44,-20992.1 2219.73,-20982.17 2216.44,-20992.24 2223.44,-20992.1"/>
</g>
<!-- gpu3_layer0_attn_reshape&#45;&gt;gpu3_layer0_attn_out -->
<g id="edge984" class="edge">
<title>gpu3_layer0_attn_reshape&#45;&gt;gpu3_layer0_attn_out</title>
<path fill="none" stroke="black" d="M2221,-21108C2221,-21099.7 2221,-21090.32 2221,-21081.41"/>
<polygon fill="black" stroke="black" points="2224.5,-21081.27 2221,-21071.27 2217.5,-21081.27 2224.5,-21081.27"/>
</g>
<!-- gpu3_layer0_res1 -->
<g id="node791" class="node">
<title>gpu3_layer0_res1</title>
<polygon fill="lightblue" stroke="black" points="2277,-20871.63 2155,-20871.63 2155,-20819.63 2277,-20819.63 2277,-20871.63"/>
<text text-anchor="middle" x="2216" y="-20859.63" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2216" y="-20848.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2216" y="-20837.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2216" y="-20826.63" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer0_kv_update&#45;&gt;gpu3_layer0_res1 -->
<g id="edge986" class="edge">
<title>gpu3_layer0_kv_update&#45;&gt;gpu3_layer0_res1</title>
<path fill="none" stroke="black" d="M2217.9,-20908.54C2217.63,-20899.87 2217.35,-20890.6 2217.08,-20881.94"/>
<polygon fill="black" stroke="black" points="2220.58,-20881.66 2216.77,-20871.77 2213.58,-20881.87 2220.58,-20881.66"/>
</g>
<!-- gpu3_layer0_ln2 -->
<g id="node792" class="node">
<title>gpu3_layer0_ln2</title>
<polygon fill="lightblue" stroke="black" points="2259,-20782.63 2137,-20782.63 2137,-20730.63 2259,-20730.63 2259,-20782.63"/>
<text text-anchor="middle" x="2198" y="-20770.63" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2198" y="-20759.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2198" y="-20748.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2198" y="-20737.63" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer0_res1&#45;&gt;gpu3_layer0_ln2 -->
<g id="edge987" class="edge">
<title>gpu3_layer0_res1&#45;&gt;gpu3_layer0_ln2</title>
<path fill="none" stroke="black" d="M2210.79,-20819.46C2209.06,-20811.08 2207.09,-20801.58 2205.23,-20792.58"/>
<polygon fill="black" stroke="black" points="2208.65,-20791.82 2203.19,-20782.73 2201.79,-20793.23 2208.65,-20791.82"/>
</g>
<!-- gpu3_layer0_routing -->
<g id="node793" class="node">
<title>gpu3_layer0_routing</title>
<polygon fill="lightyellow" stroke="black" points="2288.47,-20693.63 2087.29,-20693.63 2035.53,-20567.63 2236.71,-20567.63 2288.47,-20693.63"/>
<text text-anchor="middle" x="2162" y="-20650.13" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2162" y="-20639.13" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2162" y="-20628.13" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2162" y="-20617.13" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2162" y="-20606.13" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer0_ln2&#45;&gt;gpu3_layer0_routing -->
<g id="edge988" class="edge">
<title>gpu3_layer0_ln2&#45;&gt;gpu3_layer0_routing</title>
<path fill="none" stroke="black" d="M2190.71,-20730.53C2188.39,-20722.52 2185.69,-20713.21 2182.89,-20703.57"/>
<polygon fill="black" stroke="black" points="2186.22,-20702.49 2180.07,-20693.86 2179.5,-20704.44 2186.22,-20702.49"/>
</g>
<!-- gpu3_layer0_expert0 -->
<g id="node794" class="node">
<title>gpu3_layer0_expert0</title>
<polygon fill="lightblue" stroke="black" points="1916,-20521.63 1794,-20521.63 1794,-20469.63 1916,-20469.63 1916,-20521.63"/>
<text text-anchor="middle" x="1855" y="-20509.63" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1855" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer0_routing&#45;&gt;gpu3_layer0_expert0 -->
<g id="edge975" class="edge">
<title>gpu3_layer0_routing&#45;&gt;gpu3_layer0_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2038.9,-20576.3C1999.1,-20559.05 1956.47,-20540.58 1922.28,-20525.77"/>
<polygon fill="black" stroke="black" points="1923.43,-20522.46 1912.87,-20521.69 1920.65,-20528.88 1923.43,-20522.46"/>
<text text-anchor="middle" x="2001.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer0_expert1 -->
<g id="node795" class="node">
<title>gpu3_layer0_expert1</title>
<polygon fill="lightblue" stroke="black" points="2056,-20521.63 1934,-20521.63 1934,-20469.63 2056,-20469.63 2056,-20521.63"/>
<text text-anchor="middle" x="1995" y="-20509.63" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1995" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer0_routing&#45;&gt;gpu3_layer0_expert1 -->
<g id="edge976" class="edge">
<title>gpu3_layer0_routing&#45;&gt;gpu3_layer0_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2083.88,-20567.41C2066.83,-20553.83 2049.48,-20540.02 2034.69,-20528.24"/>
<polygon fill="black" stroke="black" points="2036.76,-20525.41 2026.76,-20521.92 2032.4,-20530.89 2036.76,-20525.41"/>
<text text-anchor="middle" x="2088.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer0_expert2 -->
<g id="node796" class="node">
<title>gpu3_layer0_expert2</title>
<polygon fill="lightblue" stroke="black" points="2196,-20521.63 2074,-20521.63 2074,-20469.63 2196,-20469.63 2196,-20521.63"/>
<text text-anchor="middle" x="2135" y="-20509.63" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2135" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer0_routing&#45;&gt;gpu3_layer0_expert2 -->
<g id="edge977" class="edge">
<title>gpu3_layer0_routing&#45;&gt;gpu3_layer0_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2149.37,-20567.41C2146.89,-20555.22 2144.38,-20542.83 2142.16,-20531.9"/>
<polygon fill="black" stroke="black" points="2145.55,-20531.02 2140.13,-20521.92 2138.69,-20532.42 2145.55,-20531.02"/>
<text text-anchor="middle" x="2175.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer0_expert3 -->
<g id="node797" class="node">
<title>gpu3_layer0_expert3</title>
<polygon fill="lightblue" stroke="black" points="2336,-20521.63 2214,-20521.63 2214,-20469.63 2336,-20469.63 2336,-20521.63"/>
<text text-anchor="middle" x="2275" y="-20509.63" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2275" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer0_routing&#45;&gt;gpu3_layer0_expert3 -->
<g id="edge978" class="edge">
<title>gpu3_layer0_routing&#45;&gt;gpu3_layer0_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2214.86,-20567.41C2225.97,-20554.34 2237.26,-20541.04 2247.02,-20529.56"/>
<polygon fill="black" stroke="black" points="2249.7,-20531.81 2253.51,-20521.92 2244.37,-20527.27 2249.7,-20531.81"/>
<text text-anchor="middle" x="2268.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer0_expert_agg -->
<g id="node798" class="node">
<title>gpu3_layer0_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-20432.63 2060.29,-20432.63 2008.53,-20328.63 2209.71,-20328.63 2261.47,-20432.63"/>
<text text-anchor="middle" x="2135" y="-20394.63" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2135" y="-20383.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-20372.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-20361.63" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer0_routing&#45;&gt;gpu3_layer0_expert_agg -->
<g id="edge993" class="edge">
<title>gpu3_layer0_routing&#45;&gt;gpu3_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M2248.81,-20596.87C2311.66,-20567.9 2379.94,-20522.16 2345,-20469.63 2324.44,-20438.71 2290.7,-20418.64 2256.22,-20405.61"/>
<polygon fill="black" stroke="black" points="2257.08,-20402.2 2246.48,-20402.12 2254.71,-20408.79 2257.08,-20402.2"/>
</g>
<!-- gpu3_layer0_expert0&#45;&gt;gpu3_layer0_expert_agg -->
<g id="edge989" class="edge">
<title>gpu3_layer0_expert0&#45;&gt;gpu3_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M1916.1,-20469.97C1952.98,-20455.08 2000.7,-20435.83 2042.16,-20419.09"/>
<polygon fill="black" stroke="black" points="2043.5,-20422.33 2051.46,-20415.34 2040.88,-20415.84 2043.5,-20422.33"/>
</g>
<!-- gpu3_layer0_expert1&#45;&gt;gpu3_layer0_expert_agg -->
<g id="edge990" class="edge">
<title>gpu3_layer0_expert1&#45;&gt;gpu3_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M2026.07,-20469.55C2037.32,-20460.47 2050.53,-20449.81 2063.8,-20439.1"/>
<polygon fill="black" stroke="black" points="2066.02,-20441.8 2071.6,-20432.8 2061.62,-20436.35 2066.02,-20441.8"/>
</g>
<!-- gpu3_layer0_expert2&#45;&gt;gpu3_layer0_expert_agg -->
<g id="edge991" class="edge">
<title>gpu3_layer0_expert2&#45;&gt;gpu3_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M2135,-20469.55C2135,-20461.62 2135,-20452.48 2135,-20443.16"/>
<polygon fill="black" stroke="black" points="2138.5,-20443.03 2135,-20433.03 2131.5,-20443.03 2138.5,-20443.03"/>
</g>
<!-- gpu3_layer0_expert3&#45;&gt;gpu3_layer0_expert_agg -->
<g id="edge992" class="edge">
<title>gpu3_layer0_expert3&#45;&gt;gpu3_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M2243.93,-20469.55C2232.68,-20460.47 2219.47,-20449.81 2206.2,-20439.1"/>
<polygon fill="black" stroke="black" points="2208.38,-20436.35 2198.4,-20432.8 2203.98,-20441.8 2208.38,-20436.35"/>
</g>
<!-- gpu3_layer0_res2 -->
<g id="node799" class="node">
<title>gpu3_layer0_res2</title>
<polygon fill="lightblue" stroke="black" points="2196,-20291.63 2074,-20291.63 2074,-20239.63 2196,-20239.63 2196,-20291.63"/>
<text text-anchor="middle" x="2135" y="-20279.63" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2135" y="-20268.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-20257.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-20246.63" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer0_expert_agg&#45;&gt;gpu3_layer0_res2 -->
<g id="edge994" class="edge">
<title>gpu3_layer0_expert_agg&#45;&gt;gpu3_layer0_res2</title>
<path fill="none" stroke="black" d="M2135,-20328.42C2135,-20319.46 2135,-20310.34 2135,-20301.94"/>
<polygon fill="black" stroke="black" points="2138.5,-20301.76 2135,-20291.76 2131.5,-20301.76 2138.5,-20301.76"/>
</g>
<!-- gpu3_layer1_ln1 -->
<g id="node800" class="node">
<title>gpu3_layer1_ln1</title>
<polygon fill="lightblue" stroke="black" points="2196,-20202.63 2074,-20202.63 2074,-20150.63 2196,-20150.63 2196,-20202.63"/>
<text text-anchor="middle" x="2135" y="-20190.63" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2135" y="-20179.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-20168.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-20157.63" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer0_res2&#45;&gt;gpu3_layer1_ln1 -->
<g id="edge999" class="edge">
<title>gpu3_layer0_res2&#45;&gt;gpu3_layer1_ln1</title>
<path fill="none" stroke="black" d="M2135,-20239.46C2135,-20231.17 2135,-20221.78 2135,-20212.87"/>
<polygon fill="black" stroke="black" points="2138.5,-20212.73 2135,-20202.73 2131.5,-20212.73 2138.5,-20212.73"/>
</g>
<!-- gpu3_layer1_qkv -->
<g id="node801" class="node">
<title>gpu3_layer1_qkv</title>
<polygon fill="lightblue" stroke="black" points="2196,-20113.63 2074,-20113.63 2074,-20061.63 2196,-20061.63 2196,-20113.63"/>
<text text-anchor="middle" x="2135" y="-20101.63" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2135" y="-20090.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-20079.63" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-20068.63" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer1_ln1&#45;&gt;gpu3_layer1_qkv -->
<g id="edge1000" class="edge">
<title>gpu3_layer1_ln1&#45;&gt;gpu3_layer1_qkv</title>
<path fill="none" stroke="black" d="M2135,-20150.46C2135,-20142.17 2135,-20132.78 2135,-20123.87"/>
<polygon fill="black" stroke="black" points="2138.5,-20123.73 2135,-20113.73 2131.5,-20123.73 2138.5,-20123.73"/>
</g>
<!-- gpu3_layer1_reshape -->
<g id="node802" class="node">
<title>gpu3_layer1_reshape</title>
<polygon fill="lightblue" stroke="black" points="2199,-20024.63 2071,-20024.63 2071,-19972.63 2199,-19972.63 2199,-20024.63"/>
<text text-anchor="middle" x="2135" y="-20012.63" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2135" y="-20001.63" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-19990.63" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-19979.63" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer1_qkv&#45;&gt;gpu3_layer1_reshape -->
<g id="edge1001" class="edge">
<title>gpu3_layer1_qkv&#45;&gt;gpu3_layer1_reshape</title>
<path fill="none" stroke="black" d="M2135,-20061.46C2135,-20053.17 2135,-20043.78 2135,-20034.87"/>
<polygon fill="black" stroke="black" points="2138.5,-20034.73 2135,-20024.73 2131.5,-20034.73 2138.5,-20034.73"/>
</g>
<!-- gpu3_layer1_attn -->
<g id="node803" class="node">
<title>gpu3_layer1_attn</title>
<polygon fill="lightblue" stroke="black" points="2199,-19935.63 2071,-19935.63 2071,-19883.63 2199,-19883.63 2199,-19935.63"/>
<text text-anchor="middle" x="2135" y="-19923.63" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2135" y="-19912.63" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-19901.63" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-19890.63" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer1_reshape&#45;&gt;gpu3_layer1_attn -->
<g id="edge1002" class="edge">
<title>gpu3_layer1_reshape&#45;&gt;gpu3_layer1_attn</title>
<path fill="none" stroke="black" d="M2135,-19972.46C2135,-19964.17 2135,-19954.78 2135,-19945.87"/>
<polygon fill="black" stroke="black" points="2138.5,-19945.73 2135,-19935.73 2131.5,-19945.73 2138.5,-19945.73"/>
</g>
<!-- gpu3_layer1_attn_reshape -->
<g id="node805" class="node">
<title>gpu3_layer1_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2196,-19846.63 2074,-19846.63 2074,-19794.63 2196,-19794.63 2196,-19846.63"/>
<text text-anchor="middle" x="2135" y="-19834.63" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2135" y="-19823.63" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-19812.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-19801.63" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer1_attn&#45;&gt;gpu3_layer1_attn_reshape -->
<g id="edge1003" class="edge">
<title>gpu3_layer1_attn&#45;&gt;gpu3_layer1_attn_reshape</title>
<path fill="none" stroke="black" d="M2135,-19883.46C2135,-19875.17 2135,-19865.78 2135,-19856.87"/>
<polygon fill="black" stroke="black" points="2138.5,-19856.73 2135,-19846.73 2131.5,-19856.73 2138.5,-19856.73"/>
</g>
<!-- gpu3_layer1_attn_out -->
<g id="node804" class="node">
<title>gpu3_layer1_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2196,-19757.63 2074,-19757.63 2074,-19705.63 2196,-19705.63 2196,-19757.63"/>
<text text-anchor="middle" x="2135" y="-19745.63" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2135" y="-19734.63" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-19723.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-19712.63" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer1_kv_update -->
<g id="node806" class="node">
<title>gpu3_layer1_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2135" cy="-19631.86" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2135" y="-19645.86" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2135" y="-19634.86" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-19623.86" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-19612.86" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer1_attn_out&#45;&gt;gpu3_layer1_kv_update -->
<g id="edge1005" class="edge">
<title>gpu3_layer1_attn_out&#45;&gt;gpu3_layer1_kv_update</title>
<path fill="none" stroke="black" d="M2135,-19705.45C2135,-19697.31 2135,-19688.01 2135,-19678.85"/>
<polygon fill="black" stroke="black" points="2138.5,-19678.64 2135,-19668.64 2131.5,-19678.64 2138.5,-19678.64"/>
</g>
<!-- gpu3_layer1_attn_reshape&#45;&gt;gpu3_layer1_attn_out -->
<g id="edge1004" class="edge">
<title>gpu3_layer1_attn_reshape&#45;&gt;gpu3_layer1_attn_out</title>
<path fill="none" stroke="black" d="M2135,-19794.46C2135,-19786.17 2135,-19776.78 2135,-19767.87"/>
<polygon fill="black" stroke="black" points="2138.5,-19767.73 2135,-19757.73 2131.5,-19767.73 2138.5,-19767.73"/>
</g>
<!-- gpu3_layer1_res1 -->
<g id="node807" class="node">
<title>gpu3_layer1_res1</title>
<polygon fill="lightblue" stroke="black" points="2196,-19558.09 2074,-19558.09 2074,-19506.09 2196,-19506.09 2196,-19558.09"/>
<text text-anchor="middle" x="2135" y="-19546.09" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2135" y="-19535.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-19524.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-19513.09" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer1_kv_update&#45;&gt;gpu3_layer1_res1 -->
<g id="edge1006" class="edge">
<title>gpu3_layer1_kv_update&#45;&gt;gpu3_layer1_res1</title>
<path fill="none" stroke="black" d="M2135,-19595.01C2135,-19586.33 2135,-19577.06 2135,-19568.4"/>
<polygon fill="black" stroke="black" points="2138.5,-19568.23 2135,-19558.23 2131.5,-19568.23 2138.5,-19568.23"/>
</g>
<!-- gpu3_layer1_ln2 -->
<g id="node808" class="node">
<title>gpu3_layer1_ln2</title>
<polygon fill="lightblue" stroke="black" points="2196,-19469.09 2074,-19469.09 2074,-19417.09 2196,-19417.09 2196,-19469.09"/>
<text text-anchor="middle" x="2135" y="-19457.09" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2135" y="-19446.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-19435.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-19424.09" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer1_res1&#45;&gt;gpu3_layer1_ln2 -->
<g id="edge1007" class="edge">
<title>gpu3_layer1_res1&#45;&gt;gpu3_layer1_ln2</title>
<path fill="none" stroke="black" d="M2135,-19505.92C2135,-19497.63 2135,-19488.24 2135,-19479.34"/>
<polygon fill="black" stroke="black" points="2138.5,-19479.19 2135,-19469.19 2131.5,-19479.19 2138.5,-19479.19"/>
</g>
<!-- gpu3_layer1_routing -->
<g id="node809" class="node">
<title>gpu3_layer1_routing</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-19380.09 2060.29,-19380.09 2008.53,-19254.09 2209.71,-19254.09 2261.47,-19380.09"/>
<text text-anchor="middle" x="2135" y="-19336.59" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2135" y="-19325.59" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-19314.59" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-19303.59" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2135" y="-19292.59" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer1_ln2&#45;&gt;gpu3_layer1_routing -->
<g id="edge1008" class="edge">
<title>gpu3_layer1_ln2&#45;&gt;gpu3_layer1_routing</title>
<path fill="none" stroke="black" d="M2135,-19416.99C2135,-19409.06 2135,-19399.86 2135,-19390.33"/>
<polygon fill="black" stroke="black" points="2138.5,-19390.32 2135,-19380.32 2131.5,-19390.32 2138.5,-19390.32"/>
</g>
<!-- gpu3_layer1_expert0 -->
<g id="node810" class="node">
<title>gpu3_layer1_expert0</title>
<polygon fill="lightblue" stroke="black" points="1916,-19208.09 1794,-19208.09 1794,-19156.09 1916,-19156.09 1916,-19208.09"/>
<text text-anchor="middle" x="1855" y="-19196.09" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1855" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer1_routing&#45;&gt;gpu3_layer1_expert0 -->
<g id="edge995" class="edge">
<title>gpu3_layer1_routing&#45;&gt;gpu3_layer1_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2009.33,-19256.39C1977.34,-19241.2 1944.34,-19225.52 1917.11,-19212.59"/>
<polygon fill="black" stroke="black" points="1918.26,-19209.26 1907.73,-19208.13 1915.26,-19215.58 1918.26,-19209.26"/>
<text text-anchor="middle" x="1991.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer1_expert1 -->
<g id="node811" class="node">
<title>gpu3_layer1_expert1</title>
<polygon fill="lightblue" stroke="black" points="2056,-19208.09 1934,-19208.09 1934,-19156.09 2056,-19156.09 2056,-19208.09"/>
<text text-anchor="middle" x="1995" y="-19196.09" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1995" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer1_routing&#45;&gt;gpu3_layer1_expert1 -->
<g id="edge996" class="edge">
<title>gpu3_layer1_routing&#45;&gt;gpu3_layer1_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2069.51,-19253.87C2055.48,-19240.55 2041.21,-19226.99 2028.97,-19215.36"/>
<polygon fill="black" stroke="black" points="2031.29,-19212.73 2021.63,-19208.38 2026.46,-19217.81 2031.29,-19212.73"/>
<text text-anchor="middle" x="2078.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer1_expert2 -->
<g id="node812" class="node">
<title>gpu3_layer1_expert2</title>
<polygon fill="lightblue" stroke="black" points="2196,-19208.09 2074,-19208.09 2074,-19156.09 2196,-19156.09 2196,-19208.09"/>
<text text-anchor="middle" x="2135" y="-19196.09" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2135" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer1_routing&#45;&gt;gpu3_layer1_expert2 -->
<g id="edge997" class="edge">
<title>gpu3_layer1_routing&#45;&gt;gpu3_layer1_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2135,-19253.87C2135,-19241.8 2135,-19229.55 2135,-19218.7"/>
<polygon fill="black" stroke="black" points="2138.5,-19218.38 2135,-19208.38 2131.5,-19218.38 2138.5,-19218.38"/>
<text text-anchor="middle" x="2164.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer1_expert3 -->
<g id="node813" class="node">
<title>gpu3_layer1_expert3</title>
<polygon fill="lightblue" stroke="black" points="2336,-19208.09 2214,-19208.09 2214,-19156.09 2336,-19156.09 2336,-19208.09"/>
<text text-anchor="middle" x="2275" y="-19196.09" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2275" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer1_routing&#45;&gt;gpu3_layer1_expert3 -->
<g id="edge998" class="edge">
<title>gpu3_layer1_routing&#45;&gt;gpu3_layer1_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2200.49,-19253.87C2214.52,-19240.55 2228.79,-19226.99 2241.03,-19215.36"/>
<polygon fill="black" stroke="black" points="2243.54,-19217.81 2248.37,-19208.38 2238.71,-19212.73 2243.54,-19217.81"/>
<text text-anchor="middle" x="2259.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer1_expert_agg -->
<g id="node814" class="node">
<title>gpu3_layer1_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-19119.09 2060.29,-19119.09 2008.53,-19015.09 2209.71,-19015.09 2261.47,-19119.09"/>
<text text-anchor="middle" x="2135" y="-19081.09" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2135" y="-19070.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-19059.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-19048.09" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer1_routing&#45;&gt;gpu3_layer1_expert_agg -->
<g id="edge1013" class="edge">
<title>gpu3_layer1_routing&#45;&gt;gpu3_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2224.22,-19289.17C2297.96,-19262.01 2384.6,-19215.62 2345,-19156.09 2324.44,-19125.17 2290.7,-19105.1 2256.22,-19092.07"/>
<polygon fill="black" stroke="black" points="2257.08,-19088.66 2246.48,-19088.58 2254.71,-19095.25 2257.08,-19088.66"/>
</g>
<!-- gpu3_layer1_expert0&#45;&gt;gpu3_layer1_expert_agg -->
<g id="edge1009" class="edge">
<title>gpu3_layer1_expert0&#45;&gt;gpu3_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M1916.1,-19156.43C1952.98,-19141.55 2000.7,-19122.29 2042.16,-19105.55"/>
<polygon fill="black" stroke="black" points="2043.5,-19108.79 2051.46,-19101.8 2040.88,-19102.3 2043.5,-19108.79"/>
</g>
<!-- gpu3_layer1_expert1&#45;&gt;gpu3_layer1_expert_agg -->
<g id="edge1010" class="edge">
<title>gpu3_layer1_expert1&#45;&gt;gpu3_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2026.07,-19156.01C2037.32,-19146.93 2050.53,-19136.27 2063.8,-19125.56"/>
<polygon fill="black" stroke="black" points="2066.02,-19128.26 2071.6,-19119.26 2061.62,-19122.82 2066.02,-19128.26"/>
</g>
<!-- gpu3_layer1_expert2&#45;&gt;gpu3_layer1_expert_agg -->
<g id="edge1011" class="edge">
<title>gpu3_layer1_expert2&#45;&gt;gpu3_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2135,-19156.01C2135,-19148.08 2135,-19138.95 2135,-19129.62"/>
<polygon fill="black" stroke="black" points="2138.5,-19129.49 2135,-19119.49 2131.5,-19129.49 2138.5,-19129.49"/>
</g>
<!-- gpu3_layer1_expert3&#45;&gt;gpu3_layer1_expert_agg -->
<g id="edge1012" class="edge">
<title>gpu3_layer1_expert3&#45;&gt;gpu3_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2243.93,-19156.01C2232.68,-19146.93 2219.47,-19136.27 2206.2,-19125.56"/>
<polygon fill="black" stroke="black" points="2208.38,-19122.82 2198.4,-19119.26 2203.98,-19128.26 2208.38,-19122.82"/>
</g>
<!-- gpu3_layer1_res2 -->
<g id="node815" class="node">
<title>gpu3_layer1_res2</title>
<polygon fill="lightblue" stroke="black" points="2196,-18978.09 2074,-18978.09 2074,-18926.09 2196,-18926.09 2196,-18978.09"/>
<text text-anchor="middle" x="2135" y="-18966.09" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2135" y="-18955.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-18944.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-18933.09" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer1_expert_agg&#45;&gt;gpu3_layer1_res2 -->
<g id="edge1014" class="edge">
<title>gpu3_layer1_expert_agg&#45;&gt;gpu3_layer1_res2</title>
<path fill="none" stroke="black" d="M2135,-19014.88C2135,-19005.93 2135,-18996.8 2135,-18988.4"/>
<polygon fill="black" stroke="black" points="2138.5,-18988.22 2135,-18978.22 2131.5,-18988.22 2138.5,-18988.22"/>
</g>
<!-- gpu3_layer2_ln1 -->
<g id="node816" class="node">
<title>gpu3_layer2_ln1</title>
<polygon fill="lightblue" stroke="black" points="2196,-18889.09 2074,-18889.09 2074,-18837.09 2196,-18837.09 2196,-18889.09"/>
<text text-anchor="middle" x="2135" y="-18877.09" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2135" y="-18866.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-18855.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-18844.09" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer1_res2&#45;&gt;gpu3_layer2_ln1 -->
<g id="edge1019" class="edge">
<title>gpu3_layer1_res2&#45;&gt;gpu3_layer2_ln1</title>
<path fill="none" stroke="black" d="M2135,-18925.92C2135,-18917.63 2135,-18908.24 2135,-18899.34"/>
<polygon fill="black" stroke="black" points="2138.5,-18899.19 2135,-18889.19 2131.5,-18899.19 2138.5,-18899.19"/>
</g>
<!-- gpu3_layer2_qkv -->
<g id="node817" class="node">
<title>gpu3_layer2_qkv</title>
<polygon fill="lightblue" stroke="black" points="2196,-18800.09 2074,-18800.09 2074,-18748.09 2196,-18748.09 2196,-18800.09"/>
<text text-anchor="middle" x="2135" y="-18788.09" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2135" y="-18777.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-18766.09" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-18755.09" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer2_ln1&#45;&gt;gpu3_layer2_qkv -->
<g id="edge1020" class="edge">
<title>gpu3_layer2_ln1&#45;&gt;gpu3_layer2_qkv</title>
<path fill="none" stroke="black" d="M2135,-18836.92C2135,-18828.63 2135,-18819.24 2135,-18810.34"/>
<polygon fill="black" stroke="black" points="2138.5,-18810.19 2135,-18800.19 2131.5,-18810.19 2138.5,-18810.19"/>
</g>
<!-- gpu3_layer2_reshape -->
<g id="node818" class="node">
<title>gpu3_layer2_reshape</title>
<polygon fill="lightblue" stroke="black" points="2199,-18711.09 2071,-18711.09 2071,-18659.09 2199,-18659.09 2199,-18711.09"/>
<text text-anchor="middle" x="2135" y="-18699.09" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2135" y="-18688.09" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-18677.09" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-18666.09" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer2_qkv&#45;&gt;gpu3_layer2_reshape -->
<g id="edge1021" class="edge">
<title>gpu3_layer2_qkv&#45;&gt;gpu3_layer2_reshape</title>
<path fill="none" stroke="black" d="M2135,-18747.92C2135,-18739.63 2135,-18730.24 2135,-18721.34"/>
<polygon fill="black" stroke="black" points="2138.5,-18721.19 2135,-18711.19 2131.5,-18721.19 2138.5,-18721.19"/>
</g>
<!-- gpu3_layer2_attn -->
<g id="node819" class="node">
<title>gpu3_layer2_attn</title>
<polygon fill="lightblue" stroke="black" points="2199,-18622.09 2071,-18622.09 2071,-18570.09 2199,-18570.09 2199,-18622.09"/>
<text text-anchor="middle" x="2135" y="-18610.09" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2135" y="-18599.09" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-18588.09" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-18577.09" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer2_reshape&#45;&gt;gpu3_layer2_attn -->
<g id="edge1022" class="edge">
<title>gpu3_layer2_reshape&#45;&gt;gpu3_layer2_attn</title>
<path fill="none" stroke="black" d="M2135,-18658.92C2135,-18650.63 2135,-18641.24 2135,-18632.34"/>
<polygon fill="black" stroke="black" points="2138.5,-18632.19 2135,-18622.19 2131.5,-18632.19 2138.5,-18632.19"/>
</g>
<!-- gpu3_layer2_attn_reshape -->
<g id="node821" class="node">
<title>gpu3_layer2_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2196,-18533.09 2074,-18533.09 2074,-18481.09 2196,-18481.09 2196,-18533.09"/>
<text text-anchor="middle" x="2135" y="-18521.09" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2135" y="-18510.09" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-18499.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-18488.09" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer2_attn&#45;&gt;gpu3_layer2_attn_reshape -->
<g id="edge1023" class="edge">
<title>gpu3_layer2_attn&#45;&gt;gpu3_layer2_attn_reshape</title>
<path fill="none" stroke="black" d="M2135,-18569.92C2135,-18561.63 2135,-18552.24 2135,-18543.34"/>
<polygon fill="black" stroke="black" points="2138.5,-18543.19 2135,-18533.19 2131.5,-18543.19 2138.5,-18543.19"/>
</g>
<!-- gpu3_layer2_attn_out -->
<g id="node820" class="node">
<title>gpu3_layer2_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2196,-18444.09 2074,-18444.09 2074,-18392.09 2196,-18392.09 2196,-18444.09"/>
<text text-anchor="middle" x="2135" y="-18432.09" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2135" y="-18421.09" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-18410.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-18399.09" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer2_kv_update -->
<g id="node822" class="node">
<title>gpu3_layer2_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2135" cy="-18318.32" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2135" y="-18332.32" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2135" y="-18321.32" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-18310.32" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-18299.32" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer2_attn_out&#45;&gt;gpu3_layer2_kv_update -->
<g id="edge1025" class="edge">
<title>gpu3_layer2_attn_out&#45;&gt;gpu3_layer2_kv_update</title>
<path fill="none" stroke="black" d="M2135,-18391.91C2135,-18383.77 2135,-18374.47 2135,-18365.31"/>
<polygon fill="black" stroke="black" points="2138.5,-18365.1 2135,-18355.1 2131.5,-18365.1 2138.5,-18365.1"/>
</g>
<!-- gpu3_layer2_attn_reshape&#45;&gt;gpu3_layer2_attn_out -->
<g id="edge1024" class="edge">
<title>gpu3_layer2_attn_reshape&#45;&gt;gpu3_layer2_attn_out</title>
<path fill="none" stroke="black" d="M2135,-18480.92C2135,-18472.63 2135,-18463.24 2135,-18454.34"/>
<polygon fill="black" stroke="black" points="2138.5,-18454.19 2135,-18444.19 2131.5,-18454.19 2138.5,-18454.19"/>
</g>
<!-- gpu3_layer2_res1 -->
<g id="node823" class="node">
<title>gpu3_layer2_res1</title>
<polygon fill="lightblue" stroke="black" points="2196,-18244.55 2074,-18244.55 2074,-18192.55 2196,-18192.55 2196,-18244.55"/>
<text text-anchor="middle" x="2135" y="-18232.55" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2135" y="-18221.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-18210.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-18199.55" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer2_kv_update&#45;&gt;gpu3_layer2_res1 -->
<g id="edge1026" class="edge">
<title>gpu3_layer2_kv_update&#45;&gt;gpu3_layer2_res1</title>
<path fill="none" stroke="black" d="M2135,-18281.47C2135,-18272.79 2135,-18263.52 2135,-18254.86"/>
<polygon fill="black" stroke="black" points="2138.5,-18254.69 2135,-18244.69 2131.5,-18254.69 2138.5,-18254.69"/>
</g>
<!-- gpu3_layer2_ln2 -->
<g id="node824" class="node">
<title>gpu3_layer2_ln2</title>
<polygon fill="lightblue" stroke="black" points="2196,-18155.55 2074,-18155.55 2074,-18103.55 2196,-18103.55 2196,-18155.55"/>
<text text-anchor="middle" x="2135" y="-18143.55" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2135" y="-18132.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-18121.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-18110.55" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer2_res1&#45;&gt;gpu3_layer2_ln2 -->
<g id="edge1027" class="edge">
<title>gpu3_layer2_res1&#45;&gt;gpu3_layer2_ln2</title>
<path fill="none" stroke="black" d="M2135,-18192.38C2135,-18184.09 2135,-18174.7 2135,-18165.8"/>
<polygon fill="black" stroke="black" points="2138.5,-18165.65 2135,-18155.65 2131.5,-18165.65 2138.5,-18165.65"/>
</g>
<!-- gpu3_layer2_routing -->
<g id="node825" class="node">
<title>gpu3_layer2_routing</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-18066.55 2060.29,-18066.55 2008.53,-17940.55 2209.71,-17940.55 2261.47,-18066.55"/>
<text text-anchor="middle" x="2135" y="-18023.05" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2135" y="-18012.05" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-18001.05" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-17990.05" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2135" y="-17979.05" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer2_ln2&#45;&gt;gpu3_layer2_routing -->
<g id="edge1028" class="edge">
<title>gpu3_layer2_ln2&#45;&gt;gpu3_layer2_routing</title>
<path fill="none" stroke="black" d="M2135,-18103.45C2135,-18095.52 2135,-18086.33 2135,-18076.8"/>
<polygon fill="black" stroke="black" points="2138.5,-18076.78 2135,-18066.78 2131.5,-18076.78 2138.5,-18076.78"/>
</g>
<!-- gpu3_layer2_expert0 -->
<g id="node826" class="node">
<title>gpu3_layer2_expert0</title>
<polygon fill="lightblue" stroke="black" points="1916,-17894.55 1794,-17894.55 1794,-17842.55 1916,-17842.55 1916,-17894.55"/>
<text text-anchor="middle" x="1855" y="-17882.55" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1855" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer2_routing&#45;&gt;gpu3_layer2_expert0 -->
<g id="edge1015" class="edge">
<title>gpu3_layer2_routing&#45;&gt;gpu3_layer2_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2009.33,-17942.86C1977.34,-17927.66 1944.34,-17911.98 1917.11,-17899.05"/>
<polygon fill="black" stroke="black" points="1918.26,-17895.72 1907.73,-17894.59 1915.26,-17902.04 1918.26,-17895.72"/>
<text text-anchor="middle" x="1991.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer2_expert1 -->
<g id="node827" class="node">
<title>gpu3_layer2_expert1</title>
<polygon fill="lightblue" stroke="black" points="2056,-17894.55 1934,-17894.55 1934,-17842.55 2056,-17842.55 2056,-17894.55"/>
<text text-anchor="middle" x="1995" y="-17882.55" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1995" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer2_routing&#45;&gt;gpu3_layer2_expert1 -->
<g id="edge1016" class="edge">
<title>gpu3_layer2_routing&#45;&gt;gpu3_layer2_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2069.51,-17940.33C2055.48,-17927.01 2041.21,-17913.45 2028.97,-17901.82"/>
<polygon fill="black" stroke="black" points="2031.29,-17899.19 2021.63,-17894.84 2026.46,-17904.27 2031.29,-17899.19"/>
<text text-anchor="middle" x="2078.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer2_expert2 -->
<g id="node828" class="node">
<title>gpu3_layer2_expert2</title>
<polygon fill="lightblue" stroke="black" points="2196,-17894.55 2074,-17894.55 2074,-17842.55 2196,-17842.55 2196,-17894.55"/>
<text text-anchor="middle" x="2135" y="-17882.55" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2135" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer2_routing&#45;&gt;gpu3_layer2_expert2 -->
<g id="edge1017" class="edge">
<title>gpu3_layer2_routing&#45;&gt;gpu3_layer2_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2135,-17940.33C2135,-17928.26 2135,-17916.01 2135,-17905.16"/>
<polygon fill="black" stroke="black" points="2138.5,-17904.84 2135,-17894.84 2131.5,-17904.84 2138.5,-17904.84"/>
<text text-anchor="middle" x="2164.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer2_expert3 -->
<g id="node829" class="node">
<title>gpu3_layer2_expert3</title>
<polygon fill="lightblue" stroke="black" points="2336,-17894.55 2214,-17894.55 2214,-17842.55 2336,-17842.55 2336,-17894.55"/>
<text text-anchor="middle" x="2275" y="-17882.55" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2275" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer2_routing&#45;&gt;gpu3_layer2_expert3 -->
<g id="edge1018" class="edge">
<title>gpu3_layer2_routing&#45;&gt;gpu3_layer2_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2200.49,-17940.33C2214.52,-17927.01 2228.79,-17913.45 2241.03,-17901.82"/>
<polygon fill="black" stroke="black" points="2243.54,-17904.27 2248.37,-17894.84 2238.71,-17899.19 2243.54,-17904.27"/>
<text text-anchor="middle" x="2259.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer2_expert_agg -->
<g id="node830" class="node">
<title>gpu3_layer2_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-17805.55 2060.29,-17805.55 2008.53,-17701.55 2209.71,-17701.55 2261.47,-17805.55"/>
<text text-anchor="middle" x="2135" y="-17767.55" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2135" y="-17756.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-17745.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-17734.55" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer2_routing&#45;&gt;gpu3_layer2_expert_agg -->
<g id="edge1033" class="edge">
<title>gpu3_layer2_routing&#45;&gt;gpu3_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M2224.22,-17975.63C2297.96,-17948.47 2384.6,-17902.08 2345,-17842.55 2324.44,-17811.64 2290.7,-17791.56 2256.22,-17778.53"/>
<polygon fill="black" stroke="black" points="2257.08,-17775.12 2246.48,-17775.04 2254.71,-17781.71 2257.08,-17775.12"/>
</g>
<!-- gpu3_layer2_expert0&#45;&gt;gpu3_layer2_expert_agg -->
<g id="edge1029" class="edge">
<title>gpu3_layer2_expert0&#45;&gt;gpu3_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M1916.1,-17842.89C1952.98,-17828.01 2000.7,-17808.75 2042.16,-17792.01"/>
<polygon fill="black" stroke="black" points="2043.5,-17795.25 2051.46,-17788.26 2040.88,-17788.76 2043.5,-17795.25"/>
</g>
<!-- gpu3_layer2_expert1&#45;&gt;gpu3_layer2_expert_agg -->
<g id="edge1030" class="edge">
<title>gpu3_layer2_expert1&#45;&gt;gpu3_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M2026.07,-17842.47C2037.32,-17833.39 2050.53,-17822.73 2063.8,-17812.02"/>
<polygon fill="black" stroke="black" points="2066.02,-17814.72 2071.6,-17805.72 2061.62,-17809.28 2066.02,-17814.72"/>
</g>
<!-- gpu3_layer2_expert2&#45;&gt;gpu3_layer2_expert_agg -->
<g id="edge1031" class="edge">
<title>gpu3_layer2_expert2&#45;&gt;gpu3_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M2135,-17842.47C2135,-17834.54 2135,-17825.41 2135,-17816.09"/>
<polygon fill="black" stroke="black" points="2138.5,-17815.95 2135,-17805.95 2131.5,-17815.95 2138.5,-17815.95"/>
</g>
<!-- gpu3_layer2_expert3&#45;&gt;gpu3_layer2_expert_agg -->
<g id="edge1032" class="edge">
<title>gpu3_layer2_expert3&#45;&gt;gpu3_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M2243.93,-17842.47C2232.68,-17833.39 2219.47,-17822.73 2206.2,-17812.02"/>
<polygon fill="black" stroke="black" points="2208.38,-17809.28 2198.4,-17805.72 2203.98,-17814.72 2208.38,-17809.28"/>
</g>
<!-- gpu3_layer2_res2 -->
<g id="node831" class="node">
<title>gpu3_layer2_res2</title>
<polygon fill="lightblue" stroke="black" points="2196,-17664.55 2074,-17664.55 2074,-17612.55 2196,-17612.55 2196,-17664.55"/>
<text text-anchor="middle" x="2135" y="-17652.55" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2135" y="-17641.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-17630.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-17619.55" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer2_expert_agg&#45;&gt;gpu3_layer2_res2 -->
<g id="edge1034" class="edge">
<title>gpu3_layer2_expert_agg&#45;&gt;gpu3_layer2_res2</title>
<path fill="none" stroke="black" d="M2135,-17701.34C2135,-17692.39 2135,-17683.26 2135,-17674.86"/>
<polygon fill="black" stroke="black" points="2138.5,-17674.68 2135,-17664.68 2131.5,-17674.68 2138.5,-17674.68"/>
</g>
<!-- gpu3_layer3_ln1 -->
<g id="node832" class="node">
<title>gpu3_layer3_ln1</title>
<polygon fill="lightblue" stroke="black" points="2196,-17575.55 2074,-17575.55 2074,-17523.55 2196,-17523.55 2196,-17575.55"/>
<text text-anchor="middle" x="2135" y="-17563.55" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2135" y="-17552.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-17541.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-17530.55" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer2_res2&#45;&gt;gpu3_layer3_ln1 -->
<g id="edge1039" class="edge">
<title>gpu3_layer2_res2&#45;&gt;gpu3_layer3_ln1</title>
<path fill="none" stroke="black" d="M2135,-17612.38C2135,-17604.09 2135,-17594.7 2135,-17585.8"/>
<polygon fill="black" stroke="black" points="2138.5,-17585.65 2135,-17575.65 2131.5,-17585.65 2138.5,-17585.65"/>
</g>
<!-- gpu3_layer3_qkv -->
<g id="node833" class="node">
<title>gpu3_layer3_qkv</title>
<polygon fill="lightblue" stroke="black" points="2196,-17486.55 2074,-17486.55 2074,-17434.55 2196,-17434.55 2196,-17486.55"/>
<text text-anchor="middle" x="2135" y="-17474.55" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2135" y="-17463.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-17452.55" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-17441.55" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer3_ln1&#45;&gt;gpu3_layer3_qkv -->
<g id="edge1040" class="edge">
<title>gpu3_layer3_ln1&#45;&gt;gpu3_layer3_qkv</title>
<path fill="none" stroke="black" d="M2135,-17523.38C2135,-17515.09 2135,-17505.7 2135,-17496.8"/>
<polygon fill="black" stroke="black" points="2138.5,-17496.65 2135,-17486.65 2131.5,-17496.65 2138.5,-17496.65"/>
</g>
<!-- gpu3_layer3_reshape -->
<g id="node834" class="node">
<title>gpu3_layer3_reshape</title>
<polygon fill="lightblue" stroke="black" points="2199,-17397.55 2071,-17397.55 2071,-17345.55 2199,-17345.55 2199,-17397.55"/>
<text text-anchor="middle" x="2135" y="-17385.55" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2135" y="-17374.55" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-17363.55" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-17352.55" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer3_qkv&#45;&gt;gpu3_layer3_reshape -->
<g id="edge1041" class="edge">
<title>gpu3_layer3_qkv&#45;&gt;gpu3_layer3_reshape</title>
<path fill="none" stroke="black" d="M2135,-17434.38C2135,-17426.09 2135,-17416.7 2135,-17407.8"/>
<polygon fill="black" stroke="black" points="2138.5,-17407.65 2135,-17397.65 2131.5,-17407.65 2138.5,-17407.65"/>
</g>
<!-- gpu3_layer3_attn -->
<g id="node835" class="node">
<title>gpu3_layer3_attn</title>
<polygon fill="lightblue" stroke="black" points="2199,-17308.55 2071,-17308.55 2071,-17256.55 2199,-17256.55 2199,-17308.55"/>
<text text-anchor="middle" x="2135" y="-17296.55" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2135" y="-17285.55" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-17274.55" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-17263.55" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer3_reshape&#45;&gt;gpu3_layer3_attn -->
<g id="edge1042" class="edge">
<title>gpu3_layer3_reshape&#45;&gt;gpu3_layer3_attn</title>
<path fill="none" stroke="black" d="M2135,-17345.38C2135,-17337.09 2135,-17327.7 2135,-17318.8"/>
<polygon fill="black" stroke="black" points="2138.5,-17318.65 2135,-17308.65 2131.5,-17318.65 2138.5,-17318.65"/>
</g>
<!-- gpu3_layer3_attn_reshape -->
<g id="node837" class="node">
<title>gpu3_layer3_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2196,-17219.55 2074,-17219.55 2074,-17167.55 2196,-17167.55 2196,-17219.55"/>
<text text-anchor="middle" x="2135" y="-17207.55" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2135" y="-17196.55" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-17185.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-17174.55" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer3_attn&#45;&gt;gpu3_layer3_attn_reshape -->
<g id="edge1043" class="edge">
<title>gpu3_layer3_attn&#45;&gt;gpu3_layer3_attn_reshape</title>
<path fill="none" stroke="black" d="M2135,-17256.38C2135,-17248.09 2135,-17238.7 2135,-17229.8"/>
<polygon fill="black" stroke="black" points="2138.5,-17229.65 2135,-17219.65 2131.5,-17229.65 2138.5,-17229.65"/>
</g>
<!-- gpu3_layer3_attn_out -->
<g id="node836" class="node">
<title>gpu3_layer3_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2196,-17130.55 2074,-17130.55 2074,-17078.55 2196,-17078.55 2196,-17130.55"/>
<text text-anchor="middle" x="2135" y="-17118.55" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2135" y="-17107.55" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-17096.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-17085.55" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer3_kv_update -->
<g id="node838" class="node">
<title>gpu3_layer3_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2135" cy="-17004.78" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2135" y="-17018.78" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2135" y="-17007.78" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-16996.78" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-16985.78" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer3_attn_out&#45;&gt;gpu3_layer3_kv_update -->
<g id="edge1045" class="edge">
<title>gpu3_layer3_attn_out&#45;&gt;gpu3_layer3_kv_update</title>
<path fill="none" stroke="black" d="M2135,-17078.37C2135,-17070.23 2135,-17060.93 2135,-17051.77"/>
<polygon fill="black" stroke="black" points="2138.5,-17051.56 2135,-17041.56 2131.5,-17051.56 2138.5,-17051.56"/>
</g>
<!-- gpu3_layer3_attn_reshape&#45;&gt;gpu3_layer3_attn_out -->
<g id="edge1044" class="edge">
<title>gpu3_layer3_attn_reshape&#45;&gt;gpu3_layer3_attn_out</title>
<path fill="none" stroke="black" d="M2135,-17167.38C2135,-17159.09 2135,-17149.7 2135,-17140.8"/>
<polygon fill="black" stroke="black" points="2138.5,-17140.65 2135,-17130.65 2131.5,-17140.65 2138.5,-17140.65"/>
</g>
<!-- gpu3_layer3_res1 -->
<g id="node839" class="node">
<title>gpu3_layer3_res1</title>
<polygon fill="lightblue" stroke="black" points="2196,-16931.01 2074,-16931.01 2074,-16879.01 2196,-16879.01 2196,-16931.01"/>
<text text-anchor="middle" x="2135" y="-16919.01" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2135" y="-16908.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-16897.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-16886.01" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer3_kv_update&#45;&gt;gpu3_layer3_res1 -->
<g id="edge1046" class="edge">
<title>gpu3_layer3_kv_update&#45;&gt;gpu3_layer3_res1</title>
<path fill="none" stroke="black" d="M2135,-16967.93C2135,-16959.25 2135,-16949.98 2135,-16941.32"/>
<polygon fill="black" stroke="black" points="2138.5,-16941.15 2135,-16931.15 2131.5,-16941.15 2138.5,-16941.15"/>
</g>
<!-- gpu3_layer3_ln2 -->
<g id="node840" class="node">
<title>gpu3_layer3_ln2</title>
<polygon fill="lightblue" stroke="black" points="2196,-16842.01 2074,-16842.01 2074,-16790.01 2196,-16790.01 2196,-16842.01"/>
<text text-anchor="middle" x="2135" y="-16830.01" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2135" y="-16819.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-16808.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-16797.01" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer3_res1&#45;&gt;gpu3_layer3_ln2 -->
<g id="edge1047" class="edge">
<title>gpu3_layer3_res1&#45;&gt;gpu3_layer3_ln2</title>
<path fill="none" stroke="black" d="M2135,-16878.84C2135,-16870.55 2135,-16861.16 2135,-16852.26"/>
<polygon fill="black" stroke="black" points="2138.5,-16852.12 2135,-16842.12 2131.5,-16852.12 2138.5,-16852.12"/>
</g>
<!-- gpu3_layer3_routing -->
<g id="node841" class="node">
<title>gpu3_layer3_routing</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-16753.01 2060.29,-16753.01 2008.53,-16627.01 2209.71,-16627.01 2261.47,-16753.01"/>
<text text-anchor="middle" x="2135" y="-16709.51" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2135" y="-16698.51" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-16687.51" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-16676.51" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2135" y="-16665.51" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer3_ln2&#45;&gt;gpu3_layer3_routing -->
<g id="edge1048" class="edge">
<title>gpu3_layer3_ln2&#45;&gt;gpu3_layer3_routing</title>
<path fill="none" stroke="black" d="M2135,-16789.92C2135,-16781.98 2135,-16772.79 2135,-16763.26"/>
<polygon fill="black" stroke="black" points="2138.5,-16763.24 2135,-16753.24 2131.5,-16763.24 2138.5,-16763.24"/>
</g>
<!-- gpu3_layer3_expert0 -->
<g id="node842" class="node">
<title>gpu3_layer3_expert0</title>
<polygon fill="lightblue" stroke="black" points="1916,-16581.01 1794,-16581.01 1794,-16529.01 1916,-16529.01 1916,-16581.01"/>
<text text-anchor="middle" x="1855" y="-16569.01" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1855" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer3_routing&#45;&gt;gpu3_layer3_expert0 -->
<g id="edge1035" class="edge">
<title>gpu3_layer3_routing&#45;&gt;gpu3_layer3_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2009.33,-16629.32C1977.34,-16614.12 1944.34,-16598.44 1917.11,-16585.51"/>
<polygon fill="black" stroke="black" points="1918.26,-16582.18 1907.73,-16581.05 1915.26,-16588.51 1918.26,-16582.18"/>
<text text-anchor="middle" x="1991.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer3_expert1 -->
<g id="node843" class="node">
<title>gpu3_layer3_expert1</title>
<polygon fill="lightblue" stroke="black" points="2056,-16581.01 1934,-16581.01 1934,-16529.01 2056,-16529.01 2056,-16581.01"/>
<text text-anchor="middle" x="1995" y="-16569.01" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1995" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer3_routing&#45;&gt;gpu3_layer3_expert1 -->
<g id="edge1036" class="edge">
<title>gpu3_layer3_routing&#45;&gt;gpu3_layer3_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2069.51,-16626.79C2055.48,-16613.47 2041.21,-16599.91 2028.97,-16588.28"/>
<polygon fill="black" stroke="black" points="2031.29,-16585.65 2021.63,-16581.3 2026.46,-16590.73 2031.29,-16585.65"/>
<text text-anchor="middle" x="2078.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer3_expert2 -->
<g id="node844" class="node">
<title>gpu3_layer3_expert2</title>
<polygon fill="lightblue" stroke="black" points="2196,-16581.01 2074,-16581.01 2074,-16529.01 2196,-16529.01 2196,-16581.01"/>
<text text-anchor="middle" x="2135" y="-16569.01" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2135" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer3_routing&#45;&gt;gpu3_layer3_expert2 -->
<g id="edge1037" class="edge">
<title>gpu3_layer3_routing&#45;&gt;gpu3_layer3_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2135,-16626.79C2135,-16614.72 2135,-16602.47 2135,-16591.62"/>
<polygon fill="black" stroke="black" points="2138.5,-16591.3 2135,-16581.3 2131.5,-16591.3 2138.5,-16591.3"/>
<text text-anchor="middle" x="2164.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer3_expert3 -->
<g id="node845" class="node">
<title>gpu3_layer3_expert3</title>
<polygon fill="lightblue" stroke="black" points="2336,-16581.01 2214,-16581.01 2214,-16529.01 2336,-16529.01 2336,-16581.01"/>
<text text-anchor="middle" x="2275" y="-16569.01" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2275" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer3_routing&#45;&gt;gpu3_layer3_expert3 -->
<g id="edge1038" class="edge">
<title>gpu3_layer3_routing&#45;&gt;gpu3_layer3_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2200.49,-16626.79C2214.52,-16613.47 2228.79,-16599.91 2241.03,-16588.28"/>
<polygon fill="black" stroke="black" points="2243.54,-16590.73 2248.37,-16581.3 2238.71,-16585.65 2243.54,-16590.73"/>
<text text-anchor="middle" x="2259.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer3_expert_agg -->
<g id="node846" class="node">
<title>gpu3_layer3_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-16492.01 2060.29,-16492.01 2008.53,-16388.01 2209.71,-16388.01 2261.47,-16492.01"/>
<text text-anchor="middle" x="2135" y="-16454.01" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2135" y="-16443.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-16432.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-16421.01" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer3_routing&#45;&gt;gpu3_layer3_expert_agg -->
<g id="edge1053" class="edge">
<title>gpu3_layer3_routing&#45;&gt;gpu3_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M2224.22,-16662.09C2297.96,-16634.93 2384.6,-16588.54 2345,-16529.01 2324.44,-16498.1 2290.7,-16478.02 2256.22,-16464.99"/>
<polygon fill="black" stroke="black" points="2257.08,-16461.58 2246.48,-16461.5 2254.71,-16468.17 2257.08,-16461.58"/>
</g>
<!-- gpu3_layer3_expert0&#45;&gt;gpu3_layer3_expert_agg -->
<g id="edge1049" class="edge">
<title>gpu3_layer3_expert0&#45;&gt;gpu3_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M1916.1,-16529.35C1952.98,-16514.47 2000.7,-16495.21 2042.16,-16478.47"/>
<polygon fill="black" stroke="black" points="2043.5,-16481.71 2051.46,-16474.72 2040.88,-16475.22 2043.5,-16481.71"/>
</g>
<!-- gpu3_layer3_expert1&#45;&gt;gpu3_layer3_expert_agg -->
<g id="edge1050" class="edge">
<title>gpu3_layer3_expert1&#45;&gt;gpu3_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M2026.07,-16528.93C2037.32,-16519.85 2050.53,-16509.19 2063.8,-16498.48"/>
<polygon fill="black" stroke="black" points="2066.02,-16501.18 2071.6,-16492.18 2061.62,-16495.74 2066.02,-16501.18"/>
</g>
<!-- gpu3_layer3_expert2&#45;&gt;gpu3_layer3_expert_agg -->
<g id="edge1051" class="edge">
<title>gpu3_layer3_expert2&#45;&gt;gpu3_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M2135,-16528.93C2135,-16521 2135,-16511.87 2135,-16502.55"/>
<polygon fill="black" stroke="black" points="2138.5,-16502.41 2135,-16492.41 2131.5,-16502.41 2138.5,-16502.41"/>
</g>
<!-- gpu3_layer3_expert3&#45;&gt;gpu3_layer3_expert_agg -->
<g id="edge1052" class="edge">
<title>gpu3_layer3_expert3&#45;&gt;gpu3_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M2243.93,-16528.93C2232.68,-16519.85 2219.47,-16509.19 2206.2,-16498.48"/>
<polygon fill="black" stroke="black" points="2208.38,-16495.74 2198.4,-16492.18 2203.98,-16501.18 2208.38,-16495.74"/>
</g>
<!-- gpu3_layer3_res2 -->
<g id="node847" class="node">
<title>gpu3_layer3_res2</title>
<polygon fill="lightblue" stroke="black" points="2196,-16351.01 2074,-16351.01 2074,-16299.01 2196,-16299.01 2196,-16351.01"/>
<text text-anchor="middle" x="2135" y="-16339.01" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2135" y="-16328.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-16317.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-16306.01" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer3_expert_agg&#45;&gt;gpu3_layer3_res2 -->
<g id="edge1054" class="edge">
<title>gpu3_layer3_expert_agg&#45;&gt;gpu3_layer3_res2</title>
<path fill="none" stroke="black" d="M2135,-16387.8C2135,-16378.85 2135,-16369.72 2135,-16361.32"/>
<polygon fill="black" stroke="black" points="2138.5,-16361.14 2135,-16351.14 2131.5,-16361.14 2138.5,-16361.14"/>
</g>
<!-- gpu3_layer4_ln1 -->
<g id="node848" class="node">
<title>gpu3_layer4_ln1</title>
<polygon fill="lightblue" stroke="black" points="2196,-16262.01 2074,-16262.01 2074,-16210.01 2196,-16210.01 2196,-16262.01"/>
<text text-anchor="middle" x="2135" y="-16250.01" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2135" y="-16239.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-16228.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-16217.01" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer3_res2&#45;&gt;gpu3_layer4_ln1 -->
<g id="edge1059" class="edge">
<title>gpu3_layer3_res2&#45;&gt;gpu3_layer4_ln1</title>
<path fill="none" stroke="black" d="M2135,-16298.84C2135,-16290.55 2135,-16281.16 2135,-16272.26"/>
<polygon fill="black" stroke="black" points="2138.5,-16272.12 2135,-16262.12 2131.5,-16272.12 2138.5,-16272.12"/>
</g>
<!-- gpu3_layer4_qkv -->
<g id="node849" class="node">
<title>gpu3_layer4_qkv</title>
<polygon fill="lightblue" stroke="black" points="2196,-16173.01 2074,-16173.01 2074,-16121.01 2196,-16121.01 2196,-16173.01"/>
<text text-anchor="middle" x="2135" y="-16161.01" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2135" y="-16150.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-16139.01" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-16128.01" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer4_ln1&#45;&gt;gpu3_layer4_qkv -->
<g id="edge1060" class="edge">
<title>gpu3_layer4_ln1&#45;&gt;gpu3_layer4_qkv</title>
<path fill="none" stroke="black" d="M2135,-16209.84C2135,-16201.55 2135,-16192.16 2135,-16183.26"/>
<polygon fill="black" stroke="black" points="2138.5,-16183.12 2135,-16173.12 2131.5,-16183.12 2138.5,-16183.12"/>
</g>
<!-- gpu3_layer4_reshape -->
<g id="node850" class="node">
<title>gpu3_layer4_reshape</title>
<polygon fill="lightblue" stroke="black" points="2199,-16084.01 2071,-16084.01 2071,-16032.01 2199,-16032.01 2199,-16084.01"/>
<text text-anchor="middle" x="2135" y="-16072.01" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2135" y="-16061.01" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-16050.01" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-16039.01" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer4_qkv&#45;&gt;gpu3_layer4_reshape -->
<g id="edge1061" class="edge">
<title>gpu3_layer4_qkv&#45;&gt;gpu3_layer4_reshape</title>
<path fill="none" stroke="black" d="M2135,-16120.84C2135,-16112.55 2135,-16103.16 2135,-16094.26"/>
<polygon fill="black" stroke="black" points="2138.5,-16094.12 2135,-16084.12 2131.5,-16094.12 2138.5,-16094.12"/>
</g>
<!-- gpu3_layer4_attn -->
<g id="node851" class="node">
<title>gpu3_layer4_attn</title>
<polygon fill="lightblue" stroke="black" points="2199,-15995.01 2071,-15995.01 2071,-15943.01 2199,-15943.01 2199,-15995.01"/>
<text text-anchor="middle" x="2135" y="-15983.01" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2135" y="-15972.01" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-15961.01" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-15950.01" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer4_reshape&#45;&gt;gpu3_layer4_attn -->
<g id="edge1062" class="edge">
<title>gpu3_layer4_reshape&#45;&gt;gpu3_layer4_attn</title>
<path fill="none" stroke="black" d="M2135,-16031.84C2135,-16023.55 2135,-16014.16 2135,-16005.26"/>
<polygon fill="black" stroke="black" points="2138.5,-16005.12 2135,-15995.12 2131.5,-16005.12 2138.5,-16005.12"/>
</g>
<!-- gpu3_layer4_attn_reshape -->
<g id="node853" class="node">
<title>gpu3_layer4_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2196,-15906.01 2074,-15906.01 2074,-15854.01 2196,-15854.01 2196,-15906.01"/>
<text text-anchor="middle" x="2135" y="-15894.01" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2135" y="-15883.01" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-15872.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-15861.01" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer4_attn&#45;&gt;gpu3_layer4_attn_reshape -->
<g id="edge1063" class="edge">
<title>gpu3_layer4_attn&#45;&gt;gpu3_layer4_attn_reshape</title>
<path fill="none" stroke="black" d="M2135,-15942.84C2135,-15934.55 2135,-15925.16 2135,-15916.26"/>
<polygon fill="black" stroke="black" points="2138.5,-15916.12 2135,-15906.12 2131.5,-15916.12 2138.5,-15916.12"/>
</g>
<!-- gpu3_layer4_attn_out -->
<g id="node852" class="node">
<title>gpu3_layer4_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2196,-15817.01 2074,-15817.01 2074,-15765.01 2196,-15765.01 2196,-15817.01"/>
<text text-anchor="middle" x="2135" y="-15805.01" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2135" y="-15794.01" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-15783.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-15772.01" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer4_kv_update -->
<g id="node854" class="node">
<title>gpu3_layer4_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2135" cy="-15691.24" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2135" y="-15705.24" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2135" y="-15694.24" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-15683.24" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-15672.24" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer4_attn_out&#45;&gt;gpu3_layer4_kv_update -->
<g id="edge1065" class="edge">
<title>gpu3_layer4_attn_out&#45;&gt;gpu3_layer4_kv_update</title>
<path fill="none" stroke="black" d="M2135,-15764.83C2135,-15756.69 2135,-15747.39 2135,-15738.23"/>
<polygon fill="black" stroke="black" points="2138.5,-15738.02 2135,-15728.02 2131.5,-15738.02 2138.5,-15738.02"/>
</g>
<!-- gpu3_layer4_attn_reshape&#45;&gt;gpu3_layer4_attn_out -->
<g id="edge1064" class="edge">
<title>gpu3_layer4_attn_reshape&#45;&gt;gpu3_layer4_attn_out</title>
<path fill="none" stroke="black" d="M2135,-15853.84C2135,-15845.55 2135,-15836.16 2135,-15827.26"/>
<polygon fill="black" stroke="black" points="2138.5,-15827.12 2135,-15817.12 2131.5,-15827.12 2138.5,-15827.12"/>
</g>
<!-- gpu3_layer4_res1 -->
<g id="node855" class="node">
<title>gpu3_layer4_res1</title>
<polygon fill="lightblue" stroke="black" points="2196,-15617.47 2074,-15617.47 2074,-15565.47 2196,-15565.47 2196,-15617.47"/>
<text text-anchor="middle" x="2135" y="-15605.47" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2135" y="-15594.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-15583.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-15572.47" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer4_kv_update&#45;&gt;gpu3_layer4_res1 -->
<g id="edge1066" class="edge">
<title>gpu3_layer4_kv_update&#45;&gt;gpu3_layer4_res1</title>
<path fill="none" stroke="black" d="M2135,-15654.39C2135,-15645.71 2135,-15636.44 2135,-15627.78"/>
<polygon fill="black" stroke="black" points="2138.5,-15627.62 2135,-15617.62 2131.5,-15627.62 2138.5,-15627.62"/>
</g>
<!-- gpu3_layer4_ln2 -->
<g id="node856" class="node">
<title>gpu3_layer4_ln2</title>
<polygon fill="lightblue" stroke="black" points="2196,-15528.47 2074,-15528.47 2074,-15476.47 2196,-15476.47 2196,-15528.47"/>
<text text-anchor="middle" x="2135" y="-15516.47" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2135" y="-15505.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-15494.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-15483.47" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer4_res1&#45;&gt;gpu3_layer4_ln2 -->
<g id="edge1067" class="edge">
<title>gpu3_layer4_res1&#45;&gt;gpu3_layer4_ln2</title>
<path fill="none" stroke="black" d="M2135,-15565.31C2135,-15557.01 2135,-15547.62 2135,-15538.72"/>
<polygon fill="black" stroke="black" points="2138.5,-15538.58 2135,-15528.58 2131.5,-15538.58 2138.5,-15538.58"/>
</g>
<!-- gpu3_layer4_routing -->
<g id="node857" class="node">
<title>gpu3_layer4_routing</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-15439.47 2060.29,-15439.47 2008.53,-15313.47 2209.71,-15313.47 2261.47,-15439.47"/>
<text text-anchor="middle" x="2135" y="-15395.97" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2135" y="-15384.97" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-15373.97" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-15362.97" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2135" y="-15351.97" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer4_ln2&#45;&gt;gpu3_layer4_routing -->
<g id="edge1068" class="edge">
<title>gpu3_layer4_ln2&#45;&gt;gpu3_layer4_routing</title>
<path fill="none" stroke="black" d="M2135,-15476.38C2135,-15468.45 2135,-15459.25 2135,-15449.72"/>
<polygon fill="black" stroke="black" points="2138.5,-15449.7 2135,-15439.7 2131.5,-15449.7 2138.5,-15449.7"/>
</g>
<!-- gpu3_layer4_expert0 -->
<g id="node858" class="node">
<title>gpu3_layer4_expert0</title>
<polygon fill="lightblue" stroke="black" points="1916,-15267.47 1794,-15267.47 1794,-15215.47 1916,-15215.47 1916,-15267.47"/>
<text text-anchor="middle" x="1855" y="-15255.47" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1855" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer4_routing&#45;&gt;gpu3_layer4_expert0 -->
<g id="edge1055" class="edge">
<title>gpu3_layer4_routing&#45;&gt;gpu3_layer4_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2009.33,-15315.78C1977.34,-15300.58 1944.34,-15284.91 1917.11,-15271.97"/>
<polygon fill="black" stroke="black" points="1918.26,-15268.64 1907.73,-15267.51 1915.26,-15274.97 1918.26,-15268.64"/>
<text text-anchor="middle" x="1991.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer4_expert1 -->
<g id="node859" class="node">
<title>gpu3_layer4_expert1</title>
<polygon fill="lightblue" stroke="black" points="2056,-15267.47 1934,-15267.47 1934,-15215.47 2056,-15215.47 2056,-15267.47"/>
<text text-anchor="middle" x="1995" y="-15255.47" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1995" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer4_routing&#45;&gt;gpu3_layer4_expert1 -->
<g id="edge1056" class="edge">
<title>gpu3_layer4_routing&#45;&gt;gpu3_layer4_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2069.51,-15313.25C2055.48,-15299.93 2041.21,-15286.37 2028.97,-15274.74"/>
<polygon fill="black" stroke="black" points="2031.29,-15272.11 2021.63,-15267.76 2026.46,-15277.19 2031.29,-15272.11"/>
<text text-anchor="middle" x="2078.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer4_expert2 -->
<g id="node860" class="node">
<title>gpu3_layer4_expert2</title>
<polygon fill="lightblue" stroke="black" points="2196,-15267.47 2074,-15267.47 2074,-15215.47 2196,-15215.47 2196,-15267.47"/>
<text text-anchor="middle" x="2135" y="-15255.47" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2135" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer4_routing&#45;&gt;gpu3_layer4_expert2 -->
<g id="edge1057" class="edge">
<title>gpu3_layer4_routing&#45;&gt;gpu3_layer4_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2135,-15313.25C2135,-15301.18 2135,-15288.93 2135,-15278.08"/>
<polygon fill="black" stroke="black" points="2138.5,-15277.76 2135,-15267.76 2131.5,-15277.76 2138.5,-15277.76"/>
<text text-anchor="middle" x="2164.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer4_expert3 -->
<g id="node861" class="node">
<title>gpu3_layer4_expert3</title>
<polygon fill="lightblue" stroke="black" points="2336,-15267.47 2214,-15267.47 2214,-15215.47 2336,-15215.47 2336,-15267.47"/>
<text text-anchor="middle" x="2275" y="-15255.47" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2275" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer4_routing&#45;&gt;gpu3_layer4_expert3 -->
<g id="edge1058" class="edge">
<title>gpu3_layer4_routing&#45;&gt;gpu3_layer4_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2200.49,-15313.25C2214.52,-15299.93 2228.79,-15286.37 2241.03,-15274.74"/>
<polygon fill="black" stroke="black" points="2243.54,-15277.19 2248.37,-15267.76 2238.71,-15272.11 2243.54,-15277.19"/>
<text text-anchor="middle" x="2259.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer4_expert_agg -->
<g id="node862" class="node">
<title>gpu3_layer4_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-15178.47 2060.29,-15178.47 2008.53,-15074.47 2209.71,-15074.47 2261.47,-15178.47"/>
<text text-anchor="middle" x="2135" y="-15140.47" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2135" y="-15129.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-15118.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-15107.47" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer4_routing&#45;&gt;gpu3_layer4_expert_agg -->
<g id="edge1073" class="edge">
<title>gpu3_layer4_routing&#45;&gt;gpu3_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M2224.22,-15348.55C2297.96,-15321.39 2384.6,-15275 2345,-15215.47 2324.44,-15184.56 2290.7,-15164.48 2256.22,-15151.45"/>
<polygon fill="black" stroke="black" points="2257.08,-15148.04 2246.48,-15147.96 2254.71,-15154.63 2257.08,-15148.04"/>
</g>
<!-- gpu3_layer4_expert0&#45;&gt;gpu3_layer4_expert_agg -->
<g id="edge1069" class="edge">
<title>gpu3_layer4_expert0&#45;&gt;gpu3_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M1916.1,-15215.81C1952.98,-15200.93 2000.7,-15181.67 2042.16,-15164.94"/>
<polygon fill="black" stroke="black" points="2043.5,-15168.17 2051.46,-15161.18 2040.88,-15161.68 2043.5,-15168.17"/>
</g>
<!-- gpu3_layer4_expert1&#45;&gt;gpu3_layer4_expert_agg -->
<g id="edge1070" class="edge">
<title>gpu3_layer4_expert1&#45;&gt;gpu3_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M2026.07,-15215.39C2037.32,-15206.31 2050.53,-15195.65 2063.8,-15184.94"/>
<polygon fill="black" stroke="black" points="2066.02,-15187.64 2071.6,-15178.64 2061.62,-15182.2 2066.02,-15187.64"/>
</g>
<!-- gpu3_layer4_expert2&#45;&gt;gpu3_layer4_expert_agg -->
<g id="edge1071" class="edge">
<title>gpu3_layer4_expert2&#45;&gt;gpu3_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M2135,-15215.39C2135,-15207.46 2135,-15198.33 2135,-15189.01"/>
<polygon fill="black" stroke="black" points="2138.5,-15188.87 2135,-15178.87 2131.5,-15188.87 2138.5,-15188.87"/>
</g>
<!-- gpu3_layer4_expert3&#45;&gt;gpu3_layer4_expert_agg -->
<g id="edge1072" class="edge">
<title>gpu3_layer4_expert3&#45;&gt;gpu3_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M2243.93,-15215.39C2232.68,-15206.31 2219.47,-15195.65 2206.2,-15184.94"/>
<polygon fill="black" stroke="black" points="2208.38,-15182.2 2198.4,-15178.64 2203.98,-15187.64 2208.38,-15182.2"/>
</g>
<!-- gpu3_layer4_res2 -->
<g id="node863" class="node">
<title>gpu3_layer4_res2</title>
<polygon fill="lightblue" stroke="black" points="2196,-15037.47 2074,-15037.47 2074,-14985.47 2196,-14985.47 2196,-15037.47"/>
<text text-anchor="middle" x="2135" y="-15025.47" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2135" y="-15014.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-15003.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-14992.47" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer4_expert_agg&#45;&gt;gpu3_layer4_res2 -->
<g id="edge1074" class="edge">
<title>gpu3_layer4_expert_agg&#45;&gt;gpu3_layer4_res2</title>
<path fill="none" stroke="black" d="M2135,-15074.26C2135,-15065.31 2135,-15056.18 2135,-15047.78"/>
<polygon fill="black" stroke="black" points="2138.5,-15047.6 2135,-15037.6 2131.5,-15047.6 2138.5,-15047.6"/>
</g>
<!-- gpu3_layer5_ln1 -->
<g id="node864" class="node">
<title>gpu3_layer5_ln1</title>
<polygon fill="lightblue" stroke="black" points="2196,-14948.47 2074,-14948.47 2074,-14896.47 2196,-14896.47 2196,-14948.47"/>
<text text-anchor="middle" x="2135" y="-14936.47" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2135" y="-14925.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-14914.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-14903.47" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer4_res2&#45;&gt;gpu3_layer5_ln1 -->
<g id="edge1079" class="edge">
<title>gpu3_layer4_res2&#45;&gt;gpu3_layer5_ln1</title>
<path fill="none" stroke="black" d="M2135,-14985.31C2135,-14977.01 2135,-14967.62 2135,-14958.72"/>
<polygon fill="black" stroke="black" points="2138.5,-14958.58 2135,-14948.58 2131.5,-14958.58 2138.5,-14958.58"/>
</g>
<!-- gpu3_layer5_qkv -->
<g id="node865" class="node">
<title>gpu3_layer5_qkv</title>
<polygon fill="lightblue" stroke="black" points="2196,-14859.47 2074,-14859.47 2074,-14807.47 2196,-14807.47 2196,-14859.47"/>
<text text-anchor="middle" x="2135" y="-14847.47" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2135" y="-14836.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-14825.47" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-14814.47" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer5_ln1&#45;&gt;gpu3_layer5_qkv -->
<g id="edge1080" class="edge">
<title>gpu3_layer5_ln1&#45;&gt;gpu3_layer5_qkv</title>
<path fill="none" stroke="black" d="M2135,-14896.31C2135,-14888.01 2135,-14878.62 2135,-14869.72"/>
<polygon fill="black" stroke="black" points="2138.5,-14869.58 2135,-14859.58 2131.5,-14869.58 2138.5,-14869.58"/>
</g>
<!-- gpu3_layer5_reshape -->
<g id="node866" class="node">
<title>gpu3_layer5_reshape</title>
<polygon fill="lightblue" stroke="black" points="2199,-14770.47 2071,-14770.47 2071,-14718.47 2199,-14718.47 2199,-14770.47"/>
<text text-anchor="middle" x="2135" y="-14758.47" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2135" y="-14747.47" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-14736.47" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-14725.47" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer5_qkv&#45;&gt;gpu3_layer5_reshape -->
<g id="edge1081" class="edge">
<title>gpu3_layer5_qkv&#45;&gt;gpu3_layer5_reshape</title>
<path fill="none" stroke="black" d="M2135,-14807.31C2135,-14799.01 2135,-14789.62 2135,-14780.72"/>
<polygon fill="black" stroke="black" points="2138.5,-14780.58 2135,-14770.58 2131.5,-14780.58 2138.5,-14780.58"/>
</g>
<!-- gpu3_layer5_attn -->
<g id="node867" class="node">
<title>gpu3_layer5_attn</title>
<polygon fill="lightblue" stroke="black" points="2199,-14681.47 2071,-14681.47 2071,-14629.47 2199,-14629.47 2199,-14681.47"/>
<text text-anchor="middle" x="2135" y="-14669.47" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2135" y="-14658.47" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-14647.47" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-14636.47" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer5_reshape&#45;&gt;gpu3_layer5_attn -->
<g id="edge1082" class="edge">
<title>gpu3_layer5_reshape&#45;&gt;gpu3_layer5_attn</title>
<path fill="none" stroke="black" d="M2135,-14718.31C2135,-14710.01 2135,-14700.62 2135,-14691.72"/>
<polygon fill="black" stroke="black" points="2138.5,-14691.58 2135,-14681.58 2131.5,-14691.58 2138.5,-14691.58"/>
</g>
<!-- gpu3_layer5_attn_reshape -->
<g id="node869" class="node">
<title>gpu3_layer5_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2196,-14592.47 2074,-14592.47 2074,-14540.47 2196,-14540.47 2196,-14592.47"/>
<text text-anchor="middle" x="2135" y="-14580.47" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2135" y="-14569.47" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-14558.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-14547.47" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer5_attn&#45;&gt;gpu3_layer5_attn_reshape -->
<g id="edge1083" class="edge">
<title>gpu3_layer5_attn&#45;&gt;gpu3_layer5_attn_reshape</title>
<path fill="none" stroke="black" d="M2135,-14629.31C2135,-14621.01 2135,-14611.62 2135,-14602.72"/>
<polygon fill="black" stroke="black" points="2138.5,-14602.58 2135,-14592.58 2131.5,-14602.58 2138.5,-14602.58"/>
</g>
<!-- gpu3_layer5_attn_out -->
<g id="node868" class="node">
<title>gpu3_layer5_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2196,-14503.47 2074,-14503.47 2074,-14451.47 2196,-14451.47 2196,-14503.47"/>
<text text-anchor="middle" x="2135" y="-14491.47" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2135" y="-14480.47" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-14469.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-14458.47" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer5_kv_update -->
<g id="node870" class="node">
<title>gpu3_layer5_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2135" cy="-14377.7" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2135" y="-14391.7" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2135" y="-14380.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-14369.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-14358.7" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer5_attn_out&#45;&gt;gpu3_layer5_kv_update -->
<g id="edge1085" class="edge">
<title>gpu3_layer5_attn_out&#45;&gt;gpu3_layer5_kv_update</title>
<path fill="none" stroke="black" d="M2135,-14451.29C2135,-14443.15 2135,-14433.86 2135,-14424.69"/>
<polygon fill="black" stroke="black" points="2138.5,-14424.48 2135,-14414.48 2131.5,-14424.48 2138.5,-14424.48"/>
</g>
<!-- gpu3_layer5_attn_reshape&#45;&gt;gpu3_layer5_attn_out -->
<g id="edge1084" class="edge">
<title>gpu3_layer5_attn_reshape&#45;&gt;gpu3_layer5_attn_out</title>
<path fill="none" stroke="black" d="M2135,-14540.31C2135,-14532.01 2135,-14522.62 2135,-14513.72"/>
<polygon fill="black" stroke="black" points="2138.5,-14513.58 2135,-14503.58 2131.5,-14513.58 2138.5,-14513.58"/>
</g>
<!-- gpu3_layer5_res1 -->
<g id="node871" class="node">
<title>gpu3_layer5_res1</title>
<polygon fill="lightblue" stroke="black" points="2196,-14303.93 2074,-14303.93 2074,-14251.93 2196,-14251.93 2196,-14303.93"/>
<text text-anchor="middle" x="2135" y="-14291.93" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2135" y="-14280.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-14269.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-14258.93" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer5_kv_update&#45;&gt;gpu3_layer5_res1 -->
<g id="edge1086" class="edge">
<title>gpu3_layer5_kv_update&#45;&gt;gpu3_layer5_res1</title>
<path fill="none" stroke="black" d="M2135,-14340.85C2135,-14332.17 2135,-14322.9 2135,-14314.25"/>
<polygon fill="black" stroke="black" points="2138.5,-14314.08 2135,-14304.08 2131.5,-14314.08 2138.5,-14314.08"/>
</g>
<!-- gpu3_layer5_ln2 -->
<g id="node872" class="node">
<title>gpu3_layer5_ln2</title>
<polygon fill="lightblue" stroke="black" points="2196,-14214.93 2074,-14214.93 2074,-14162.93 2196,-14162.93 2196,-14214.93"/>
<text text-anchor="middle" x="2135" y="-14202.93" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2135" y="-14191.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-14180.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-14169.93" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer5_res1&#45;&gt;gpu3_layer5_ln2 -->
<g id="edge1087" class="edge">
<title>gpu3_layer5_res1&#45;&gt;gpu3_layer5_ln2</title>
<path fill="none" stroke="black" d="M2135,-14251.77C2135,-14243.47 2135,-14234.08 2135,-14225.18"/>
<polygon fill="black" stroke="black" points="2138.5,-14225.04 2135,-14215.04 2131.5,-14225.04 2138.5,-14225.04"/>
</g>
<!-- gpu3_layer5_routing -->
<g id="node873" class="node">
<title>gpu3_layer5_routing</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-14125.93 2060.29,-14125.93 2008.53,-13999.93 2209.71,-13999.93 2261.47,-14125.93"/>
<text text-anchor="middle" x="2135" y="-14082.43" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2135" y="-14071.43" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-14060.43" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-14049.43" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2135" y="-14038.43" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer5_ln2&#45;&gt;gpu3_layer5_routing -->
<g id="edge1088" class="edge">
<title>gpu3_layer5_ln2&#45;&gt;gpu3_layer5_routing</title>
<path fill="none" stroke="black" d="M2135,-14162.84C2135,-14154.91 2135,-14145.71 2135,-14136.18"/>
<polygon fill="black" stroke="black" points="2138.5,-14136.17 2135,-14126.17 2131.5,-14136.17 2138.5,-14136.17"/>
</g>
<!-- gpu3_layer5_expert0 -->
<g id="node874" class="node">
<title>gpu3_layer5_expert0</title>
<polygon fill="lightblue" stroke="black" points="1916,-13953.93 1794,-13953.93 1794,-13901.93 1916,-13901.93 1916,-13953.93"/>
<text text-anchor="middle" x="1855" y="-13941.93" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1855" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer5_routing&#45;&gt;gpu3_layer5_expert0 -->
<g id="edge1075" class="edge">
<title>gpu3_layer5_routing&#45;&gt;gpu3_layer5_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2009.33,-14002.24C1977.34,-13987.04 1944.34,-13971.37 1917.11,-13958.43"/>
<polygon fill="black" stroke="black" points="1918.26,-13955.1 1907.73,-13953.98 1915.26,-13961.43 1918.26,-13955.1"/>
<text text-anchor="middle" x="1991.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer5_expert1 -->
<g id="node875" class="node">
<title>gpu3_layer5_expert1</title>
<polygon fill="lightblue" stroke="black" points="2056,-13953.93 1934,-13953.93 1934,-13901.93 2056,-13901.93 2056,-13953.93"/>
<text text-anchor="middle" x="1995" y="-13941.93" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1995" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer5_routing&#45;&gt;gpu3_layer5_expert1 -->
<g id="edge1076" class="edge">
<title>gpu3_layer5_routing&#45;&gt;gpu3_layer5_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2069.51,-13999.71C2055.48,-13986.39 2041.21,-13972.83 2028.97,-13961.2"/>
<polygon fill="black" stroke="black" points="2031.29,-13958.57 2021.63,-13954.22 2026.46,-13963.65 2031.29,-13958.57"/>
<text text-anchor="middle" x="2078.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer5_expert2 -->
<g id="node876" class="node">
<title>gpu3_layer5_expert2</title>
<polygon fill="lightblue" stroke="black" points="2196,-13953.93 2074,-13953.93 2074,-13901.93 2196,-13901.93 2196,-13953.93"/>
<text text-anchor="middle" x="2135" y="-13941.93" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2135" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer5_routing&#45;&gt;gpu3_layer5_expert2 -->
<g id="edge1077" class="edge">
<title>gpu3_layer5_routing&#45;&gt;gpu3_layer5_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2135,-13999.71C2135,-13987.65 2135,-13975.39 2135,-13964.54"/>
<polygon fill="black" stroke="black" points="2138.5,-13964.22 2135,-13954.22 2131.5,-13964.22 2138.5,-13964.22"/>
<text text-anchor="middle" x="2164.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer5_expert3 -->
<g id="node877" class="node">
<title>gpu3_layer5_expert3</title>
<polygon fill="lightblue" stroke="black" points="2336,-13953.93 2214,-13953.93 2214,-13901.93 2336,-13901.93 2336,-13953.93"/>
<text text-anchor="middle" x="2275" y="-13941.93" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2275" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer5_routing&#45;&gt;gpu3_layer5_expert3 -->
<g id="edge1078" class="edge">
<title>gpu3_layer5_routing&#45;&gt;gpu3_layer5_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2200.49,-13999.71C2214.52,-13986.39 2228.79,-13972.83 2241.03,-13961.2"/>
<polygon fill="black" stroke="black" points="2243.54,-13963.65 2248.37,-13954.22 2238.71,-13958.57 2243.54,-13963.65"/>
<text text-anchor="middle" x="2259.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer5_expert_agg -->
<g id="node878" class="node">
<title>gpu3_layer5_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-13864.93 2060.29,-13864.93 2008.53,-13760.93 2209.71,-13760.93 2261.47,-13864.93"/>
<text text-anchor="middle" x="2135" y="-13826.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2135" y="-13815.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-13804.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-13793.93" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer5_routing&#45;&gt;gpu3_layer5_expert_agg -->
<g id="edge1093" class="edge">
<title>gpu3_layer5_routing&#45;&gt;gpu3_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M2224.22,-14035.01C2297.96,-14007.85 2384.6,-13961.46 2345,-13901.93 2324.44,-13871.02 2290.7,-13850.94 2256.22,-13837.91"/>
<polygon fill="black" stroke="black" points="2257.08,-13834.5 2246.48,-13834.42 2254.71,-13841.09 2257.08,-13834.5"/>
</g>
<!-- gpu3_layer5_expert0&#45;&gt;gpu3_layer5_expert_agg -->
<g id="edge1089" class="edge">
<title>gpu3_layer5_expert0&#45;&gt;gpu3_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M1916.1,-13902.27C1952.98,-13887.39 2000.7,-13868.13 2042.16,-13851.4"/>
<polygon fill="black" stroke="black" points="2043.5,-13854.63 2051.46,-13847.65 2040.88,-13848.14 2043.5,-13854.63"/>
</g>
<!-- gpu3_layer5_expert1&#45;&gt;gpu3_layer5_expert_agg -->
<g id="edge1090" class="edge">
<title>gpu3_layer5_expert1&#45;&gt;gpu3_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M2026.07,-13901.85C2037.32,-13892.77 2050.53,-13882.11 2063.8,-13871.4"/>
<polygon fill="black" stroke="black" points="2066.02,-13874.11 2071.6,-13865.1 2061.62,-13868.66 2066.02,-13874.11"/>
</g>
<!-- gpu3_layer5_expert2&#45;&gt;gpu3_layer5_expert_agg -->
<g id="edge1091" class="edge">
<title>gpu3_layer5_expert2&#45;&gt;gpu3_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M2135,-13901.85C2135,-13893.93 2135,-13884.79 2135,-13875.47"/>
<polygon fill="black" stroke="black" points="2138.5,-13875.33 2135,-13865.33 2131.5,-13875.33 2138.5,-13875.33"/>
</g>
<!-- gpu3_layer5_expert3&#45;&gt;gpu3_layer5_expert_agg -->
<g id="edge1092" class="edge">
<title>gpu3_layer5_expert3&#45;&gt;gpu3_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M2243.93,-13901.85C2232.68,-13892.77 2219.47,-13882.11 2206.2,-13871.4"/>
<polygon fill="black" stroke="black" points="2208.38,-13868.66 2198.4,-13865.1 2203.98,-13874.11 2208.38,-13868.66"/>
</g>
<!-- gpu3_layer5_res2 -->
<g id="node879" class="node">
<title>gpu3_layer5_res2</title>
<polygon fill="lightblue" stroke="black" points="2196,-13723.93 2074,-13723.93 2074,-13671.93 2196,-13671.93 2196,-13723.93"/>
<text text-anchor="middle" x="2135" y="-13711.93" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2135" y="-13700.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-13689.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-13678.93" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer5_expert_agg&#45;&gt;gpu3_layer5_res2 -->
<g id="edge1094" class="edge">
<title>gpu3_layer5_expert_agg&#45;&gt;gpu3_layer5_res2</title>
<path fill="none" stroke="black" d="M2135,-13760.72C2135,-13751.77 2135,-13742.64 2135,-13734.24"/>
<polygon fill="black" stroke="black" points="2138.5,-13734.06 2135,-13724.06 2131.5,-13734.06 2138.5,-13734.06"/>
</g>
<!-- gpu3_layer6_ln1 -->
<g id="node880" class="node">
<title>gpu3_layer6_ln1</title>
<polygon fill="lightblue" stroke="black" points="2196,-13634.93 2074,-13634.93 2074,-13582.93 2196,-13582.93 2196,-13634.93"/>
<text text-anchor="middle" x="2135" y="-13622.93" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2135" y="-13611.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-13600.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-13589.93" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer5_res2&#45;&gt;gpu3_layer6_ln1 -->
<g id="edge1099" class="edge">
<title>gpu3_layer5_res2&#45;&gt;gpu3_layer6_ln1</title>
<path fill="none" stroke="black" d="M2135,-13671.77C2135,-13663.47 2135,-13654.08 2135,-13645.18"/>
<polygon fill="black" stroke="black" points="2138.5,-13645.04 2135,-13635.04 2131.5,-13645.04 2138.5,-13645.04"/>
</g>
<!-- gpu3_layer6_qkv -->
<g id="node881" class="node">
<title>gpu3_layer6_qkv</title>
<polygon fill="lightblue" stroke="black" points="2196,-13545.93 2074,-13545.93 2074,-13493.93 2196,-13493.93 2196,-13545.93"/>
<text text-anchor="middle" x="2135" y="-13533.93" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2135" y="-13522.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-13511.93" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-13500.93" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer6_ln1&#45;&gt;gpu3_layer6_qkv -->
<g id="edge1100" class="edge">
<title>gpu3_layer6_ln1&#45;&gt;gpu3_layer6_qkv</title>
<path fill="none" stroke="black" d="M2135,-13582.77C2135,-13574.47 2135,-13565.08 2135,-13556.18"/>
<polygon fill="black" stroke="black" points="2138.5,-13556.04 2135,-13546.04 2131.5,-13556.04 2138.5,-13556.04"/>
</g>
<!-- gpu3_layer6_reshape -->
<g id="node882" class="node">
<title>gpu3_layer6_reshape</title>
<polygon fill="lightblue" stroke="black" points="2199,-13456.93 2071,-13456.93 2071,-13404.93 2199,-13404.93 2199,-13456.93"/>
<text text-anchor="middle" x="2135" y="-13444.93" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2135" y="-13433.93" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-13422.93" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-13411.93" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer6_qkv&#45;&gt;gpu3_layer6_reshape -->
<g id="edge1101" class="edge">
<title>gpu3_layer6_qkv&#45;&gt;gpu3_layer6_reshape</title>
<path fill="none" stroke="black" d="M2135,-13493.77C2135,-13485.47 2135,-13476.08 2135,-13467.18"/>
<polygon fill="black" stroke="black" points="2138.5,-13467.04 2135,-13457.04 2131.5,-13467.04 2138.5,-13467.04"/>
</g>
<!-- gpu3_layer6_attn -->
<g id="node883" class="node">
<title>gpu3_layer6_attn</title>
<polygon fill="lightblue" stroke="black" points="2199,-13367.93 2071,-13367.93 2071,-13315.93 2199,-13315.93 2199,-13367.93"/>
<text text-anchor="middle" x="2135" y="-13355.93" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2135" y="-13344.93" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-13333.93" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-13322.93" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer6_reshape&#45;&gt;gpu3_layer6_attn -->
<g id="edge1102" class="edge">
<title>gpu3_layer6_reshape&#45;&gt;gpu3_layer6_attn</title>
<path fill="none" stroke="black" d="M2135,-13404.77C2135,-13396.47 2135,-13387.08 2135,-13378.18"/>
<polygon fill="black" stroke="black" points="2138.5,-13378.04 2135,-13368.04 2131.5,-13378.04 2138.5,-13378.04"/>
</g>
<!-- gpu3_layer6_attn_reshape -->
<g id="node885" class="node">
<title>gpu3_layer6_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2196,-13278.93 2074,-13278.93 2074,-13226.93 2196,-13226.93 2196,-13278.93"/>
<text text-anchor="middle" x="2135" y="-13266.93" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2135" y="-13255.93" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-13244.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-13233.93" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer6_attn&#45;&gt;gpu3_layer6_attn_reshape -->
<g id="edge1103" class="edge">
<title>gpu3_layer6_attn&#45;&gt;gpu3_layer6_attn_reshape</title>
<path fill="none" stroke="black" d="M2135,-13315.77C2135,-13307.47 2135,-13298.08 2135,-13289.18"/>
<polygon fill="black" stroke="black" points="2138.5,-13289.04 2135,-13279.04 2131.5,-13289.04 2138.5,-13289.04"/>
</g>
<!-- gpu3_layer6_attn_out -->
<g id="node884" class="node">
<title>gpu3_layer6_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2196,-13189.93 2074,-13189.93 2074,-13137.93 2196,-13137.93 2196,-13189.93"/>
<text text-anchor="middle" x="2135" y="-13177.93" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2135" y="-13166.93" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-13155.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-13144.93" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer6_kv_update -->
<g id="node886" class="node">
<title>gpu3_layer6_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2135" cy="-13064.16" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2135" y="-13078.16" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2135" y="-13067.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-13056.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-13045.16" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer6_attn_out&#45;&gt;gpu3_layer6_kv_update -->
<g id="edge1105" class="edge">
<title>gpu3_layer6_attn_out&#45;&gt;gpu3_layer6_kv_update</title>
<path fill="none" stroke="black" d="M2135,-13137.75C2135,-13129.61 2135,-13120.32 2135,-13111.16"/>
<polygon fill="black" stroke="black" points="2138.5,-13110.94 2135,-13100.94 2131.5,-13110.94 2138.5,-13110.94"/>
</g>
<!-- gpu3_layer6_attn_reshape&#45;&gt;gpu3_layer6_attn_out -->
<g id="edge1104" class="edge">
<title>gpu3_layer6_attn_reshape&#45;&gt;gpu3_layer6_attn_out</title>
<path fill="none" stroke="black" d="M2135,-13226.77C2135,-13218.47 2135,-13209.08 2135,-13200.18"/>
<polygon fill="black" stroke="black" points="2138.5,-13200.04 2135,-13190.04 2131.5,-13200.04 2138.5,-13200.04"/>
</g>
<!-- gpu3_layer6_res1 -->
<g id="node887" class="node">
<title>gpu3_layer6_res1</title>
<polygon fill="lightblue" stroke="black" points="2196,-12990.39 2074,-12990.39 2074,-12938.39 2196,-12938.39 2196,-12990.39"/>
<text text-anchor="middle" x="2135" y="-12978.39" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2135" y="-12967.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-12956.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-12945.39" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer6_kv_update&#45;&gt;gpu3_layer6_res1 -->
<g id="edge1106" class="edge">
<title>gpu3_layer6_kv_update&#45;&gt;gpu3_layer6_res1</title>
<path fill="none" stroke="black" d="M2135,-13027.31C2135,-13018.63 2135,-13009.36 2135,-13000.71"/>
<polygon fill="black" stroke="black" points="2138.5,-13000.54 2135,-12990.54 2131.5,-13000.54 2138.5,-13000.54"/>
</g>
<!-- gpu3_layer6_ln2 -->
<g id="node888" class="node">
<title>gpu3_layer6_ln2</title>
<polygon fill="lightblue" stroke="black" points="2196,-12901.39 2074,-12901.39 2074,-12849.39 2196,-12849.39 2196,-12901.39"/>
<text text-anchor="middle" x="2135" y="-12889.39" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2135" y="-12878.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-12867.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-12856.39" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer6_res1&#45;&gt;gpu3_layer6_ln2 -->
<g id="edge1107" class="edge">
<title>gpu3_layer6_res1&#45;&gt;gpu3_layer6_ln2</title>
<path fill="none" stroke="black" d="M2135,-12938.23C2135,-12929.93 2135,-12920.55 2135,-12911.64"/>
<polygon fill="black" stroke="black" points="2138.5,-12911.5 2135,-12901.5 2131.5,-12911.5 2138.5,-12911.5"/>
</g>
<!-- gpu3_layer6_routing -->
<g id="node889" class="node">
<title>gpu3_layer6_routing</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-12812.39 2060.29,-12812.39 2008.53,-12686.39 2209.71,-12686.39 2261.47,-12812.39"/>
<text text-anchor="middle" x="2135" y="-12768.89" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2135" y="-12757.89" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-12746.89" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-12735.89" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2135" y="-12724.89" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer6_ln2&#45;&gt;gpu3_layer6_routing -->
<g id="edge1108" class="edge">
<title>gpu3_layer6_ln2&#45;&gt;gpu3_layer6_routing</title>
<path fill="none" stroke="black" d="M2135,-12849.3C2135,-12841.37 2135,-12832.17 2135,-12822.64"/>
<polygon fill="black" stroke="black" points="2138.5,-12822.63 2135,-12812.63 2131.5,-12822.63 2138.5,-12822.63"/>
</g>
<!-- gpu3_layer6_expert0 -->
<g id="node890" class="node">
<title>gpu3_layer6_expert0</title>
<polygon fill="lightblue" stroke="black" points="1916,-12640.39 1794,-12640.39 1794,-12588.39 1916,-12588.39 1916,-12640.39"/>
<text text-anchor="middle" x="1855" y="-12628.39" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1855" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer6_routing&#45;&gt;gpu3_layer6_expert0 -->
<g id="edge1095" class="edge">
<title>gpu3_layer6_routing&#45;&gt;gpu3_layer6_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2009.33,-12688.7C1977.34,-12673.5 1944.34,-12657.83 1917.11,-12644.89"/>
<polygon fill="black" stroke="black" points="1918.26,-12641.57 1907.73,-12640.44 1915.26,-12647.89 1918.26,-12641.57"/>
<text text-anchor="middle" x="1991.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer6_expert1 -->
<g id="node891" class="node">
<title>gpu3_layer6_expert1</title>
<polygon fill="lightblue" stroke="black" points="2056,-12640.39 1934,-12640.39 1934,-12588.39 2056,-12588.39 2056,-12640.39"/>
<text text-anchor="middle" x="1995" y="-12628.39" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1995" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer6_routing&#45;&gt;gpu3_layer6_expert1 -->
<g id="edge1096" class="edge">
<title>gpu3_layer6_routing&#45;&gt;gpu3_layer6_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2069.51,-12686.17C2055.48,-12672.85 2041.21,-12659.29 2028.97,-12647.66"/>
<polygon fill="black" stroke="black" points="2031.29,-12645.03 2021.63,-12640.68 2026.46,-12650.11 2031.29,-12645.03"/>
<text text-anchor="middle" x="2078.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer6_expert2 -->
<g id="node892" class="node">
<title>gpu3_layer6_expert2</title>
<polygon fill="lightblue" stroke="black" points="2196,-12640.39 2074,-12640.39 2074,-12588.39 2196,-12588.39 2196,-12640.39"/>
<text text-anchor="middle" x="2135" y="-12628.39" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2135" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer6_routing&#45;&gt;gpu3_layer6_expert2 -->
<g id="edge1097" class="edge">
<title>gpu3_layer6_routing&#45;&gt;gpu3_layer6_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2135,-12686.17C2135,-12674.11 2135,-12661.85 2135,-12651"/>
<polygon fill="black" stroke="black" points="2138.5,-12650.68 2135,-12640.68 2131.5,-12650.68 2138.5,-12650.68"/>
<text text-anchor="middle" x="2164.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer6_expert3 -->
<g id="node893" class="node">
<title>gpu3_layer6_expert3</title>
<polygon fill="lightblue" stroke="black" points="2336,-12640.39 2214,-12640.39 2214,-12588.39 2336,-12588.39 2336,-12640.39"/>
<text text-anchor="middle" x="2275" y="-12628.39" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2275" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer6_routing&#45;&gt;gpu3_layer6_expert3 -->
<g id="edge1098" class="edge">
<title>gpu3_layer6_routing&#45;&gt;gpu3_layer6_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2200.49,-12686.17C2214.52,-12672.85 2228.79,-12659.29 2241.03,-12647.66"/>
<polygon fill="black" stroke="black" points="2243.54,-12650.11 2248.37,-12640.68 2238.71,-12645.03 2243.54,-12650.11"/>
<text text-anchor="middle" x="2259.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer6_expert_agg -->
<g id="node894" class="node">
<title>gpu3_layer6_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-12551.39 2060.29,-12551.39 2008.53,-12447.39 2209.71,-12447.39 2261.47,-12551.39"/>
<text text-anchor="middle" x="2135" y="-12513.39" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2135" y="-12502.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-12491.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-12480.39" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer6_routing&#45;&gt;gpu3_layer6_expert_agg -->
<g id="edge1113" class="edge">
<title>gpu3_layer6_routing&#45;&gt;gpu3_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M2224.22,-12721.47C2297.96,-12694.32 2384.6,-12647.92 2345,-12588.39 2324.44,-12557.48 2290.7,-12537.4 2256.22,-12524.38"/>
<polygon fill="black" stroke="black" points="2257.08,-12520.97 2246.48,-12520.88 2254.71,-12527.55 2257.08,-12520.97"/>
</g>
<!-- gpu3_layer6_expert0&#45;&gt;gpu3_layer6_expert_agg -->
<g id="edge1109" class="edge">
<title>gpu3_layer6_expert0&#45;&gt;gpu3_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M1916.1,-12588.73C1952.98,-12573.85 2000.7,-12554.59 2042.16,-12537.86"/>
<polygon fill="black" stroke="black" points="2043.5,-12541.09 2051.46,-12534.11 2040.88,-12534.6 2043.5,-12541.09"/>
</g>
<!-- gpu3_layer6_expert1&#45;&gt;gpu3_layer6_expert_agg -->
<g id="edge1110" class="edge">
<title>gpu3_layer6_expert1&#45;&gt;gpu3_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M2026.07,-12588.31C2037.32,-12579.24 2050.53,-12568.57 2063.8,-12557.86"/>
<polygon fill="black" stroke="black" points="2066.02,-12560.57 2071.6,-12551.56 2061.62,-12555.12 2066.02,-12560.57"/>
</g>
<!-- gpu3_layer6_expert2&#45;&gt;gpu3_layer6_expert_agg -->
<g id="edge1111" class="edge">
<title>gpu3_layer6_expert2&#45;&gt;gpu3_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M2135,-12588.31C2135,-12580.39 2135,-12571.25 2135,-12561.93"/>
<polygon fill="black" stroke="black" points="2138.5,-12561.79 2135,-12551.79 2131.5,-12561.79 2138.5,-12561.79"/>
</g>
<!-- gpu3_layer6_expert3&#45;&gt;gpu3_layer6_expert_agg -->
<g id="edge1112" class="edge">
<title>gpu3_layer6_expert3&#45;&gt;gpu3_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M2243.93,-12588.31C2232.68,-12579.24 2219.47,-12568.57 2206.2,-12557.86"/>
<polygon fill="black" stroke="black" points="2208.38,-12555.12 2198.4,-12551.56 2203.98,-12560.57 2208.38,-12555.12"/>
</g>
<!-- gpu3_layer6_res2 -->
<g id="node895" class="node">
<title>gpu3_layer6_res2</title>
<polygon fill="lightblue" stroke="black" points="2196,-12410.39 2074,-12410.39 2074,-12358.39 2196,-12358.39 2196,-12410.39"/>
<text text-anchor="middle" x="2135" y="-12398.39" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2135" y="-12387.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-12376.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-12365.39" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer6_expert_agg&#45;&gt;gpu3_layer6_res2 -->
<g id="edge1114" class="edge">
<title>gpu3_layer6_expert_agg&#45;&gt;gpu3_layer6_res2</title>
<path fill="none" stroke="black" d="M2135,-12447.18C2135,-12438.23 2135,-12429.1 2135,-12420.7"/>
<polygon fill="black" stroke="black" points="2138.5,-12420.52 2135,-12410.52 2131.5,-12420.52 2138.5,-12420.52"/>
</g>
<!-- gpu3_layer7_ln1 -->
<g id="node896" class="node">
<title>gpu3_layer7_ln1</title>
<polygon fill="lightblue" stroke="black" points="2196,-12321.39 2074,-12321.39 2074,-12269.39 2196,-12269.39 2196,-12321.39"/>
<text text-anchor="middle" x="2135" y="-12309.39" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2135" y="-12298.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-12287.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-12276.39" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer6_res2&#45;&gt;gpu3_layer7_ln1 -->
<g id="edge1119" class="edge">
<title>gpu3_layer6_res2&#45;&gt;gpu3_layer7_ln1</title>
<path fill="none" stroke="black" d="M2135,-12358.23C2135,-12349.93 2135,-12340.55 2135,-12331.64"/>
<polygon fill="black" stroke="black" points="2138.5,-12331.5 2135,-12321.5 2131.5,-12331.5 2138.5,-12331.5"/>
</g>
<!-- gpu3_layer7_qkv -->
<g id="node897" class="node">
<title>gpu3_layer7_qkv</title>
<polygon fill="lightblue" stroke="black" points="2196,-12232.39 2074,-12232.39 2074,-12180.39 2196,-12180.39 2196,-12232.39"/>
<text text-anchor="middle" x="2135" y="-12220.39" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2135" y="-12209.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-12198.39" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-12187.39" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer7_ln1&#45;&gt;gpu3_layer7_qkv -->
<g id="edge1120" class="edge">
<title>gpu3_layer7_ln1&#45;&gt;gpu3_layer7_qkv</title>
<path fill="none" stroke="black" d="M2135,-12269.23C2135,-12260.93 2135,-12251.55 2135,-12242.64"/>
<polygon fill="black" stroke="black" points="2138.5,-12242.5 2135,-12232.5 2131.5,-12242.5 2138.5,-12242.5"/>
</g>
<!-- gpu3_layer7_reshape -->
<g id="node898" class="node">
<title>gpu3_layer7_reshape</title>
<polygon fill="lightblue" stroke="black" points="2199,-12143.39 2071,-12143.39 2071,-12091.39 2199,-12091.39 2199,-12143.39"/>
<text text-anchor="middle" x="2135" y="-12131.39" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2135" y="-12120.39" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-12109.39" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-12098.39" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer7_qkv&#45;&gt;gpu3_layer7_reshape -->
<g id="edge1121" class="edge">
<title>gpu3_layer7_qkv&#45;&gt;gpu3_layer7_reshape</title>
<path fill="none" stroke="black" d="M2135,-12180.23C2135,-12171.93 2135,-12162.55 2135,-12153.64"/>
<polygon fill="black" stroke="black" points="2138.5,-12153.5 2135,-12143.5 2131.5,-12153.5 2138.5,-12153.5"/>
</g>
<!-- gpu3_layer7_attn -->
<g id="node899" class="node">
<title>gpu3_layer7_attn</title>
<polygon fill="lightblue" stroke="black" points="2199,-12054.39 2071,-12054.39 2071,-12002.39 2199,-12002.39 2199,-12054.39"/>
<text text-anchor="middle" x="2135" y="-12042.39" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2135" y="-12031.39" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-12020.39" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-12009.39" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer7_reshape&#45;&gt;gpu3_layer7_attn -->
<g id="edge1122" class="edge">
<title>gpu3_layer7_reshape&#45;&gt;gpu3_layer7_attn</title>
<path fill="none" stroke="black" d="M2135,-12091.23C2135,-12082.93 2135,-12073.55 2135,-12064.64"/>
<polygon fill="black" stroke="black" points="2138.5,-12064.5 2135,-12054.5 2131.5,-12064.5 2138.5,-12064.5"/>
</g>
<!-- gpu3_layer7_attn_reshape -->
<g id="node901" class="node">
<title>gpu3_layer7_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2196,-11965.39 2074,-11965.39 2074,-11913.39 2196,-11913.39 2196,-11965.39"/>
<text text-anchor="middle" x="2135" y="-11953.39" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2135" y="-11942.39" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-11931.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-11920.39" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer7_attn&#45;&gt;gpu3_layer7_attn_reshape -->
<g id="edge1123" class="edge">
<title>gpu3_layer7_attn&#45;&gt;gpu3_layer7_attn_reshape</title>
<path fill="none" stroke="black" d="M2135,-12002.23C2135,-11993.93 2135,-11984.55 2135,-11975.64"/>
<polygon fill="black" stroke="black" points="2138.5,-11975.5 2135,-11965.5 2131.5,-11975.5 2138.5,-11975.5"/>
</g>
<!-- gpu3_layer7_attn_out -->
<g id="node900" class="node">
<title>gpu3_layer7_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2196,-11876.39 2074,-11876.39 2074,-11824.39 2196,-11824.39 2196,-11876.39"/>
<text text-anchor="middle" x="2135" y="-11864.39" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2135" y="-11853.39" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-11842.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-11831.39" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer7_kv_update -->
<g id="node902" class="node">
<title>gpu3_layer7_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2135" cy="-11750.62" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2135" y="-11764.62" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2135" y="-11753.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-11742.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-11731.62" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer7_attn_out&#45;&gt;gpu3_layer7_kv_update -->
<g id="edge1125" class="edge">
<title>gpu3_layer7_attn_out&#45;&gt;gpu3_layer7_kv_update</title>
<path fill="none" stroke="black" d="M2135,-11824.21C2135,-11816.07 2135,-11806.78 2135,-11797.62"/>
<polygon fill="black" stroke="black" points="2138.5,-11797.4 2135,-11787.4 2131.5,-11797.4 2138.5,-11797.4"/>
</g>
<!-- gpu3_layer7_attn_reshape&#45;&gt;gpu3_layer7_attn_out -->
<g id="edge1124" class="edge">
<title>gpu3_layer7_attn_reshape&#45;&gt;gpu3_layer7_attn_out</title>
<path fill="none" stroke="black" d="M2135,-11913.23C2135,-11904.93 2135,-11895.55 2135,-11886.64"/>
<polygon fill="black" stroke="black" points="2138.5,-11886.5 2135,-11876.5 2131.5,-11886.5 2138.5,-11886.5"/>
</g>
<!-- gpu3_layer7_res1 -->
<g id="node903" class="node">
<title>gpu3_layer7_res1</title>
<polygon fill="lightblue" stroke="black" points="2196,-11676.85 2074,-11676.85 2074,-11624.85 2196,-11624.85 2196,-11676.85"/>
<text text-anchor="middle" x="2135" y="-11664.85" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2135" y="-11653.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-11642.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-11631.85" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer7_kv_update&#45;&gt;gpu3_layer7_res1 -->
<g id="edge1126" class="edge">
<title>gpu3_layer7_kv_update&#45;&gt;gpu3_layer7_res1</title>
<path fill="none" stroke="black" d="M2135,-11713.77C2135,-11705.09 2135,-11695.82 2135,-11687.17"/>
<polygon fill="black" stroke="black" points="2138.5,-11687 2135,-11677 2131.5,-11687 2138.5,-11687"/>
</g>
<!-- gpu3_layer7_ln2 -->
<g id="node904" class="node">
<title>gpu3_layer7_ln2</title>
<polygon fill="lightblue" stroke="black" points="2196,-11587.85 2074,-11587.85 2074,-11535.85 2196,-11535.85 2196,-11587.85"/>
<text text-anchor="middle" x="2135" y="-11575.85" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2135" y="-11564.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-11553.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-11542.85" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer7_res1&#45;&gt;gpu3_layer7_ln2 -->
<g id="edge1127" class="edge">
<title>gpu3_layer7_res1&#45;&gt;gpu3_layer7_ln2</title>
<path fill="none" stroke="black" d="M2135,-11624.69C2135,-11616.39 2135,-11607.01 2135,-11598.1"/>
<polygon fill="black" stroke="black" points="2138.5,-11597.96 2135,-11587.96 2131.5,-11597.96 2138.5,-11597.96"/>
</g>
<!-- gpu3_layer7_routing -->
<g id="node905" class="node">
<title>gpu3_layer7_routing</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-11498.85 2060.29,-11498.85 2008.53,-11372.85 2209.71,-11372.85 2261.47,-11498.85"/>
<text text-anchor="middle" x="2135" y="-11455.35" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2135" y="-11444.35" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-11433.35" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-11422.35" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2135" y="-11411.35" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer7_ln2&#45;&gt;gpu3_layer7_routing -->
<g id="edge1128" class="edge">
<title>gpu3_layer7_ln2&#45;&gt;gpu3_layer7_routing</title>
<path fill="none" stroke="black" d="M2135,-11535.76C2135,-11527.83 2135,-11518.63 2135,-11509.1"/>
<polygon fill="black" stroke="black" points="2138.5,-11509.09 2135,-11499.09 2131.5,-11509.09 2138.5,-11509.09"/>
</g>
<!-- gpu3_layer7_expert0 -->
<g id="node906" class="node">
<title>gpu3_layer7_expert0</title>
<polygon fill="lightblue" stroke="black" points="1916,-11326.85 1794,-11326.85 1794,-11274.85 1916,-11274.85 1916,-11326.85"/>
<text text-anchor="middle" x="1855" y="-11314.85" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1855" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer7_routing&#45;&gt;gpu3_layer7_expert0 -->
<g id="edge1115" class="edge">
<title>gpu3_layer7_routing&#45;&gt;gpu3_layer7_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2009.33,-11375.16C1977.34,-11359.96 1944.34,-11344.29 1917.11,-11331.35"/>
<polygon fill="black" stroke="black" points="1918.26,-11328.03 1907.73,-11326.9 1915.26,-11334.35 1918.26,-11328.03"/>
<text text-anchor="middle" x="1991.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer7_expert1 -->
<g id="node907" class="node">
<title>gpu3_layer7_expert1</title>
<polygon fill="lightblue" stroke="black" points="2056,-11326.85 1934,-11326.85 1934,-11274.85 2056,-11274.85 2056,-11326.85"/>
<text text-anchor="middle" x="1995" y="-11314.85" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1995" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer7_routing&#45;&gt;gpu3_layer7_expert1 -->
<g id="edge1116" class="edge">
<title>gpu3_layer7_routing&#45;&gt;gpu3_layer7_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2069.51,-11372.64C2055.48,-11359.31 2041.21,-11345.76 2028.97,-11334.12"/>
<polygon fill="black" stroke="black" points="2031.29,-11331.5 2021.63,-11327.15 2026.46,-11336.57 2031.29,-11331.5"/>
<text text-anchor="middle" x="2078.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer7_expert2 -->
<g id="node908" class="node">
<title>gpu3_layer7_expert2</title>
<polygon fill="lightblue" stroke="black" points="2196,-11326.85 2074,-11326.85 2074,-11274.85 2196,-11274.85 2196,-11326.85"/>
<text text-anchor="middle" x="2135" y="-11314.85" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2135" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer7_routing&#45;&gt;gpu3_layer7_expert2 -->
<g id="edge1117" class="edge">
<title>gpu3_layer7_routing&#45;&gt;gpu3_layer7_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2135,-11372.64C2135,-11360.57 2135,-11348.31 2135,-11337.46"/>
<polygon fill="black" stroke="black" points="2138.5,-11337.15 2135,-11327.15 2131.5,-11337.15 2138.5,-11337.15"/>
<text text-anchor="middle" x="2164.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer7_expert3 -->
<g id="node909" class="node">
<title>gpu3_layer7_expert3</title>
<polygon fill="lightblue" stroke="black" points="2336,-11326.85 2214,-11326.85 2214,-11274.85 2336,-11274.85 2336,-11326.85"/>
<text text-anchor="middle" x="2275" y="-11314.85" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2275" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer7_routing&#45;&gt;gpu3_layer7_expert3 -->
<g id="edge1118" class="edge">
<title>gpu3_layer7_routing&#45;&gt;gpu3_layer7_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2200.49,-11372.64C2214.52,-11359.31 2228.79,-11345.76 2241.03,-11334.12"/>
<polygon fill="black" stroke="black" points="2243.54,-11336.57 2248.37,-11327.15 2238.71,-11331.5 2243.54,-11336.57"/>
<text text-anchor="middle" x="2259.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer7_expert_agg -->
<g id="node910" class="node">
<title>gpu3_layer7_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-11237.85 2060.29,-11237.85 2008.53,-11133.85 2209.71,-11133.85 2261.47,-11237.85"/>
<text text-anchor="middle" x="2135" y="-11199.85" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2135" y="-11188.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-11177.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-11166.85" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer7_routing&#45;&gt;gpu3_layer7_expert_agg -->
<g id="edge1133" class="edge">
<title>gpu3_layer7_routing&#45;&gt;gpu3_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M2224.22,-11407.94C2297.96,-11380.78 2384.6,-11334.39 2345,-11274.85 2324.44,-11243.94 2290.7,-11223.87 2256.22,-11210.84"/>
<polygon fill="black" stroke="black" points="2257.08,-11207.43 2246.48,-11207.35 2254.71,-11214.02 2257.08,-11207.43"/>
</g>
<!-- gpu3_layer7_expert0&#45;&gt;gpu3_layer7_expert_agg -->
<g id="edge1129" class="edge">
<title>gpu3_layer7_expert0&#45;&gt;gpu3_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M1916.1,-11275.19C1952.98,-11260.31 2000.7,-11241.05 2042.16,-11224.32"/>
<polygon fill="black" stroke="black" points="2043.5,-11227.56 2051.46,-11220.57 2040.88,-11221.06 2043.5,-11227.56"/>
</g>
<!-- gpu3_layer7_expert1&#45;&gt;gpu3_layer7_expert_agg -->
<g id="edge1130" class="edge">
<title>gpu3_layer7_expert1&#45;&gt;gpu3_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M2026.07,-11274.77C2037.32,-11265.7 2050.53,-11255.03 2063.8,-11244.32"/>
<polygon fill="black" stroke="black" points="2066.02,-11247.03 2071.6,-11238.02 2061.62,-11241.58 2066.02,-11247.03"/>
</g>
<!-- gpu3_layer7_expert2&#45;&gt;gpu3_layer7_expert_agg -->
<g id="edge1131" class="edge">
<title>gpu3_layer7_expert2&#45;&gt;gpu3_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M2135,-11274.77C2135,-11266.85 2135,-11257.71 2135,-11248.39"/>
<polygon fill="black" stroke="black" points="2138.5,-11248.25 2135,-11238.25 2131.5,-11248.25 2138.5,-11248.25"/>
</g>
<!-- gpu3_layer7_expert3&#45;&gt;gpu3_layer7_expert_agg -->
<g id="edge1132" class="edge">
<title>gpu3_layer7_expert3&#45;&gt;gpu3_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M2243.93,-11274.77C2232.68,-11265.7 2219.47,-11255.03 2206.2,-11244.32"/>
<polygon fill="black" stroke="black" points="2208.38,-11241.58 2198.4,-11238.02 2203.98,-11247.03 2208.38,-11241.58"/>
</g>
<!-- gpu3_layer7_res2 -->
<g id="node911" class="node">
<title>gpu3_layer7_res2</title>
<polygon fill="lightblue" stroke="black" points="2196,-11096.85 2074,-11096.85 2074,-11044.85 2196,-11044.85 2196,-11096.85"/>
<text text-anchor="middle" x="2135" y="-11084.85" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2135" y="-11073.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-11062.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-11051.85" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer7_expert_agg&#45;&gt;gpu3_layer7_res2 -->
<g id="edge1134" class="edge">
<title>gpu3_layer7_expert_agg&#45;&gt;gpu3_layer7_res2</title>
<path fill="none" stroke="black" d="M2135,-11133.64C2135,-11124.69 2135,-11115.56 2135,-11107.16"/>
<polygon fill="black" stroke="black" points="2138.5,-11106.98 2135,-11096.98 2131.5,-11106.98 2138.5,-11106.98"/>
</g>
<!-- gpu3_layer8_ln1 -->
<g id="node912" class="node">
<title>gpu3_layer8_ln1</title>
<polygon fill="lightblue" stroke="black" points="2196,-11007.85 2074,-11007.85 2074,-10955.85 2196,-10955.85 2196,-11007.85"/>
<text text-anchor="middle" x="2135" y="-10995.85" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2135" y="-10984.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-10973.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-10962.85" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer7_res2&#45;&gt;gpu3_layer8_ln1 -->
<g id="edge1139" class="edge">
<title>gpu3_layer7_res2&#45;&gt;gpu3_layer8_ln1</title>
<path fill="none" stroke="black" d="M2135,-11044.69C2135,-11036.39 2135,-11027.01 2135,-11018.1"/>
<polygon fill="black" stroke="black" points="2138.5,-11017.96 2135,-11007.96 2131.5,-11017.96 2138.5,-11017.96"/>
</g>
<!-- gpu3_layer8_qkv -->
<g id="node913" class="node">
<title>gpu3_layer8_qkv</title>
<polygon fill="lightblue" stroke="black" points="2196,-10918.85 2074,-10918.85 2074,-10866.85 2196,-10866.85 2196,-10918.85"/>
<text text-anchor="middle" x="2135" y="-10906.85" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2135" y="-10895.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-10884.85" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-10873.85" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer8_ln1&#45;&gt;gpu3_layer8_qkv -->
<g id="edge1140" class="edge">
<title>gpu3_layer8_ln1&#45;&gt;gpu3_layer8_qkv</title>
<path fill="none" stroke="black" d="M2135,-10955.69C2135,-10947.39 2135,-10938.01 2135,-10929.1"/>
<polygon fill="black" stroke="black" points="2138.5,-10928.96 2135,-10918.96 2131.5,-10928.96 2138.5,-10928.96"/>
</g>
<!-- gpu3_layer8_reshape -->
<g id="node914" class="node">
<title>gpu3_layer8_reshape</title>
<polygon fill="lightblue" stroke="black" points="2199,-10829.85 2071,-10829.85 2071,-10777.85 2199,-10777.85 2199,-10829.85"/>
<text text-anchor="middle" x="2135" y="-10817.85" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2135" y="-10806.85" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-10795.85" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-10784.85" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer8_qkv&#45;&gt;gpu3_layer8_reshape -->
<g id="edge1141" class="edge">
<title>gpu3_layer8_qkv&#45;&gt;gpu3_layer8_reshape</title>
<path fill="none" stroke="black" d="M2135,-10866.69C2135,-10858.39 2135,-10849.01 2135,-10840.1"/>
<polygon fill="black" stroke="black" points="2138.5,-10839.96 2135,-10829.96 2131.5,-10839.96 2138.5,-10839.96"/>
</g>
<!-- gpu3_layer8_attn -->
<g id="node915" class="node">
<title>gpu3_layer8_attn</title>
<polygon fill="lightblue" stroke="black" points="2199,-10740.85 2071,-10740.85 2071,-10688.85 2199,-10688.85 2199,-10740.85"/>
<text text-anchor="middle" x="2135" y="-10728.85" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2135" y="-10717.85" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-10706.85" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-10695.85" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer8_reshape&#45;&gt;gpu3_layer8_attn -->
<g id="edge1142" class="edge">
<title>gpu3_layer8_reshape&#45;&gt;gpu3_layer8_attn</title>
<path fill="none" stroke="black" d="M2135,-10777.69C2135,-10769.39 2135,-10760.01 2135,-10751.1"/>
<polygon fill="black" stroke="black" points="2138.5,-10750.96 2135,-10740.96 2131.5,-10750.96 2138.5,-10750.96"/>
</g>
<!-- gpu3_layer8_attn_reshape -->
<g id="node917" class="node">
<title>gpu3_layer8_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2196,-10651.85 2074,-10651.85 2074,-10599.85 2196,-10599.85 2196,-10651.85"/>
<text text-anchor="middle" x="2135" y="-10639.85" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2135" y="-10628.85" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-10617.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-10606.85" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer8_attn&#45;&gt;gpu3_layer8_attn_reshape -->
<g id="edge1143" class="edge">
<title>gpu3_layer8_attn&#45;&gt;gpu3_layer8_attn_reshape</title>
<path fill="none" stroke="black" d="M2135,-10688.69C2135,-10680.39 2135,-10671.01 2135,-10662.1"/>
<polygon fill="black" stroke="black" points="2138.5,-10661.96 2135,-10651.96 2131.5,-10661.96 2138.5,-10661.96"/>
</g>
<!-- gpu3_layer8_attn_out -->
<g id="node916" class="node">
<title>gpu3_layer8_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2196,-10562.85 2074,-10562.85 2074,-10510.85 2196,-10510.85 2196,-10562.85"/>
<text text-anchor="middle" x="2135" y="-10550.85" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2135" y="-10539.85" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-10528.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-10517.85" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer8_kv_update -->
<g id="node918" class="node">
<title>gpu3_layer8_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2135" cy="-10437.08" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2135" y="-10451.08" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2135" y="-10440.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-10429.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-10418.08" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer8_attn_out&#45;&gt;gpu3_layer8_kv_update -->
<g id="edge1145" class="edge">
<title>gpu3_layer8_attn_out&#45;&gt;gpu3_layer8_kv_update</title>
<path fill="none" stroke="black" d="M2135,-10510.67C2135,-10502.53 2135,-10493.24 2135,-10484.08"/>
<polygon fill="black" stroke="black" points="2138.5,-10483.86 2135,-10473.86 2131.5,-10483.86 2138.5,-10483.86"/>
</g>
<!-- gpu3_layer8_attn_reshape&#45;&gt;gpu3_layer8_attn_out -->
<g id="edge1144" class="edge">
<title>gpu3_layer8_attn_reshape&#45;&gt;gpu3_layer8_attn_out</title>
<path fill="none" stroke="black" d="M2135,-10599.69C2135,-10591.39 2135,-10582.01 2135,-10573.1"/>
<polygon fill="black" stroke="black" points="2138.5,-10572.96 2135,-10562.96 2131.5,-10572.96 2138.5,-10572.96"/>
</g>
<!-- gpu3_layer8_res1 -->
<g id="node919" class="node">
<title>gpu3_layer8_res1</title>
<polygon fill="lightblue" stroke="black" points="2196,-10363.31 2074,-10363.31 2074,-10311.31 2196,-10311.31 2196,-10363.31"/>
<text text-anchor="middle" x="2135" y="-10351.31" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2135" y="-10340.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-10329.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-10318.31" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer8_kv_update&#45;&gt;gpu3_layer8_res1 -->
<g id="edge1146" class="edge">
<title>gpu3_layer8_kv_update&#45;&gt;gpu3_layer8_res1</title>
<path fill="none" stroke="black" d="M2135,-10400.23C2135,-10391.55 2135,-10382.28 2135,-10373.63"/>
<polygon fill="black" stroke="black" points="2138.5,-10373.46 2135,-10363.46 2131.5,-10373.46 2138.5,-10373.46"/>
</g>
<!-- gpu3_layer8_ln2 -->
<g id="node920" class="node">
<title>gpu3_layer8_ln2</title>
<polygon fill="lightblue" stroke="black" points="2196,-10274.31 2074,-10274.31 2074,-10222.31 2196,-10222.31 2196,-10274.31"/>
<text text-anchor="middle" x="2135" y="-10262.31" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2135" y="-10251.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-10240.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-10229.31" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer8_res1&#45;&gt;gpu3_layer8_ln2 -->
<g id="edge1147" class="edge">
<title>gpu3_layer8_res1&#45;&gt;gpu3_layer8_ln2</title>
<path fill="none" stroke="black" d="M2135,-10311.15C2135,-10302.85 2135,-10293.47 2135,-10284.56"/>
<polygon fill="black" stroke="black" points="2138.5,-10284.42 2135,-10274.42 2131.5,-10284.42 2138.5,-10284.42"/>
</g>
<!-- gpu3_layer8_routing -->
<g id="node921" class="node">
<title>gpu3_layer8_routing</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-10185.31 2060.29,-10185.31 2008.53,-10059.31 2209.71,-10059.31 2261.47,-10185.31"/>
<text text-anchor="middle" x="2135" y="-10141.81" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2135" y="-10130.81" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-10119.81" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-10108.81" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2135" y="-10097.81" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer8_ln2&#45;&gt;gpu3_layer8_routing -->
<g id="edge1148" class="edge">
<title>gpu3_layer8_ln2&#45;&gt;gpu3_layer8_routing</title>
<path fill="none" stroke="black" d="M2135,-10222.22C2135,-10214.29 2135,-10205.09 2135,-10195.56"/>
<polygon fill="black" stroke="black" points="2138.5,-10195.55 2135,-10185.55 2131.5,-10195.55 2138.5,-10195.55"/>
</g>
<!-- gpu3_layer8_expert0 -->
<g id="node922" class="node">
<title>gpu3_layer8_expert0</title>
<polygon fill="lightblue" stroke="black" points="1916,-10013.31 1794,-10013.31 1794,-9961.31 1916,-9961.31 1916,-10013.31"/>
<text text-anchor="middle" x="1855" y="-10001.31" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1855" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer8_routing&#45;&gt;gpu3_layer8_expert0 -->
<g id="edge1135" class="edge">
<title>gpu3_layer8_routing&#45;&gt;gpu3_layer8_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2009.33,-10061.62C1977.34,-10046.42 1944.34,-10030.75 1917.11,-10017.81"/>
<polygon fill="black" stroke="black" points="1918.26,-10014.49 1907.73,-10013.36 1915.26,-10020.81 1918.26,-10014.49"/>
<text text-anchor="middle" x="1991.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer8_expert1 -->
<g id="node923" class="node">
<title>gpu3_layer8_expert1</title>
<polygon fill="lightblue" stroke="black" points="2056,-10013.31 1934,-10013.31 1934,-9961.31 2056,-9961.31 2056,-10013.31"/>
<text text-anchor="middle" x="1995" y="-10001.31" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1995" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer8_routing&#45;&gt;gpu3_layer8_expert1 -->
<g id="edge1136" class="edge">
<title>gpu3_layer8_routing&#45;&gt;gpu3_layer8_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2069.51,-10059.1C2055.48,-10045.77 2041.21,-10032.22 2028.97,-10020.58"/>
<polygon fill="black" stroke="black" points="2031.29,-10017.96 2021.63,-10013.61 2026.46,-10023.03 2031.29,-10017.96"/>
<text text-anchor="middle" x="2078.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer8_expert2 -->
<g id="node924" class="node">
<title>gpu3_layer8_expert2</title>
<polygon fill="lightblue" stroke="black" points="2196,-10013.31 2074,-10013.31 2074,-9961.31 2196,-9961.31 2196,-10013.31"/>
<text text-anchor="middle" x="2135" y="-10001.31" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2135" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer8_routing&#45;&gt;gpu3_layer8_expert2 -->
<g id="edge1137" class="edge">
<title>gpu3_layer8_routing&#45;&gt;gpu3_layer8_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2135,-10059.1C2135,-10047.03 2135,-10034.77 2135,-10023.92"/>
<polygon fill="black" stroke="black" points="2138.5,-10023.61 2135,-10013.61 2131.5,-10023.61 2138.5,-10023.61"/>
<text text-anchor="middle" x="2164.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer8_expert3 -->
<g id="node925" class="node">
<title>gpu3_layer8_expert3</title>
<polygon fill="lightblue" stroke="black" points="2336,-10013.31 2214,-10013.31 2214,-9961.31 2336,-9961.31 2336,-10013.31"/>
<text text-anchor="middle" x="2275" y="-10001.31" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2275" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer8_routing&#45;&gt;gpu3_layer8_expert3 -->
<g id="edge1138" class="edge">
<title>gpu3_layer8_routing&#45;&gt;gpu3_layer8_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2200.49,-10059.1C2214.52,-10045.77 2228.79,-10032.22 2241.03,-10020.58"/>
<polygon fill="black" stroke="black" points="2243.54,-10023.03 2248.37,-10013.61 2238.71,-10017.96 2243.54,-10023.03"/>
<text text-anchor="middle" x="2259.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer8_expert_agg -->
<g id="node926" class="node">
<title>gpu3_layer8_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-9924.31 2060.29,-9924.31 2008.53,-9820.31 2209.71,-9820.31 2261.47,-9924.31"/>
<text text-anchor="middle" x="2135" y="-9886.31" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2135" y="-9875.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-9864.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-9853.31" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer8_routing&#45;&gt;gpu3_layer8_expert_agg -->
<g id="edge1153" class="edge">
<title>gpu3_layer8_routing&#45;&gt;gpu3_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M2224.22,-10094.4C2297.96,-10067.24 2384.6,-10020.85 2345,-9961.31 2324.44,-9930.4 2290.7,-9910.33 2256.22,-9897.3"/>
<polygon fill="black" stroke="black" points="2257.08,-9893.89 2246.48,-9893.81 2254.71,-9900.48 2257.08,-9893.89"/>
</g>
<!-- gpu3_layer8_expert0&#45;&gt;gpu3_layer8_expert_agg -->
<g id="edge1149" class="edge">
<title>gpu3_layer8_expert0&#45;&gt;gpu3_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M1916.1,-9961.65C1952.98,-9946.77 2000.7,-9927.51 2042.16,-9910.78"/>
<polygon fill="black" stroke="black" points="2043.5,-9914.02 2051.46,-9907.03 2040.88,-9907.52 2043.5,-9914.02"/>
</g>
<!-- gpu3_layer8_expert1&#45;&gt;gpu3_layer8_expert_agg -->
<g id="edge1150" class="edge">
<title>gpu3_layer8_expert1&#45;&gt;gpu3_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M2026.07,-9961.23C2037.32,-9952.16 2050.53,-9941.49 2063.8,-9930.78"/>
<polygon fill="black" stroke="black" points="2066.02,-9933.49 2071.6,-9924.48 2061.62,-9928.04 2066.02,-9933.49"/>
</g>
<!-- gpu3_layer8_expert2&#45;&gt;gpu3_layer8_expert_agg -->
<g id="edge1151" class="edge">
<title>gpu3_layer8_expert2&#45;&gt;gpu3_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M2135,-9961.23C2135,-9953.31 2135,-9944.17 2135,-9934.85"/>
<polygon fill="black" stroke="black" points="2138.5,-9934.71 2135,-9924.71 2131.5,-9934.71 2138.5,-9934.71"/>
</g>
<!-- gpu3_layer8_expert3&#45;&gt;gpu3_layer8_expert_agg -->
<g id="edge1152" class="edge">
<title>gpu3_layer8_expert3&#45;&gt;gpu3_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M2243.93,-9961.23C2232.68,-9952.16 2219.47,-9941.49 2206.2,-9930.78"/>
<polygon fill="black" stroke="black" points="2208.38,-9928.04 2198.4,-9924.48 2203.98,-9933.49 2208.38,-9928.04"/>
</g>
<!-- gpu3_layer8_res2 -->
<g id="node927" class="node">
<title>gpu3_layer8_res2</title>
<polygon fill="lightblue" stroke="black" points="2196,-9783.31 2074,-9783.31 2074,-9731.31 2196,-9731.31 2196,-9783.31"/>
<text text-anchor="middle" x="2135" y="-9771.31" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2135" y="-9760.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-9749.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-9738.31" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer8_expert_agg&#45;&gt;gpu3_layer8_res2 -->
<g id="edge1154" class="edge">
<title>gpu3_layer8_expert_agg&#45;&gt;gpu3_layer8_res2</title>
<path fill="none" stroke="black" d="M2135,-9820.1C2135,-9811.15 2135,-9802.02 2135,-9793.62"/>
<polygon fill="black" stroke="black" points="2138.5,-9793.44 2135,-9783.44 2131.5,-9793.44 2138.5,-9793.44"/>
</g>
<!-- gpu3_layer9_ln1 -->
<g id="node928" class="node">
<title>gpu3_layer9_ln1</title>
<polygon fill="lightblue" stroke="black" points="2196,-9694.31 2074,-9694.31 2074,-9642.31 2196,-9642.31 2196,-9694.31"/>
<text text-anchor="middle" x="2135" y="-9682.31" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2135" y="-9671.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-9660.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-9649.31" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer8_res2&#45;&gt;gpu3_layer9_ln1 -->
<g id="edge1159" class="edge">
<title>gpu3_layer8_res2&#45;&gt;gpu3_layer9_ln1</title>
<path fill="none" stroke="black" d="M2135,-9731.15C2135,-9722.85 2135,-9713.47 2135,-9704.56"/>
<polygon fill="black" stroke="black" points="2138.5,-9704.42 2135,-9694.42 2131.5,-9704.42 2138.5,-9704.42"/>
</g>
<!-- gpu3_layer9_qkv -->
<g id="node929" class="node">
<title>gpu3_layer9_qkv</title>
<polygon fill="lightblue" stroke="black" points="2196,-9605.31 2074,-9605.31 2074,-9553.31 2196,-9553.31 2196,-9605.31"/>
<text text-anchor="middle" x="2135" y="-9593.31" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2135" y="-9582.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-9571.31" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-9560.31" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer9_ln1&#45;&gt;gpu3_layer9_qkv -->
<g id="edge1160" class="edge">
<title>gpu3_layer9_ln1&#45;&gt;gpu3_layer9_qkv</title>
<path fill="none" stroke="black" d="M2135,-9642.15C2135,-9633.85 2135,-9624.47 2135,-9615.56"/>
<polygon fill="black" stroke="black" points="2138.5,-9615.42 2135,-9605.42 2131.5,-9615.42 2138.5,-9615.42"/>
</g>
<!-- gpu3_layer9_reshape -->
<g id="node930" class="node">
<title>gpu3_layer9_reshape</title>
<polygon fill="lightblue" stroke="black" points="2199,-9516.31 2071,-9516.31 2071,-9464.31 2199,-9464.31 2199,-9516.31"/>
<text text-anchor="middle" x="2135" y="-9504.31" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2135" y="-9493.31" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-9482.31" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-9471.31" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer9_qkv&#45;&gt;gpu3_layer9_reshape -->
<g id="edge1161" class="edge">
<title>gpu3_layer9_qkv&#45;&gt;gpu3_layer9_reshape</title>
<path fill="none" stroke="black" d="M2135,-9553.15C2135,-9544.85 2135,-9535.47 2135,-9526.56"/>
<polygon fill="black" stroke="black" points="2138.5,-9526.42 2135,-9516.42 2131.5,-9526.42 2138.5,-9526.42"/>
</g>
<!-- gpu3_layer9_attn -->
<g id="node931" class="node">
<title>gpu3_layer9_attn</title>
<polygon fill="lightblue" stroke="black" points="2199,-9427.31 2071,-9427.31 2071,-9375.31 2199,-9375.31 2199,-9427.31"/>
<text text-anchor="middle" x="2135" y="-9415.31" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2135" y="-9404.31" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-9393.31" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-9382.31" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer9_reshape&#45;&gt;gpu3_layer9_attn -->
<g id="edge1162" class="edge">
<title>gpu3_layer9_reshape&#45;&gt;gpu3_layer9_attn</title>
<path fill="none" stroke="black" d="M2135,-9464.15C2135,-9455.85 2135,-9446.47 2135,-9437.56"/>
<polygon fill="black" stroke="black" points="2138.5,-9437.42 2135,-9427.42 2131.5,-9437.42 2138.5,-9437.42"/>
</g>
<!-- gpu3_layer9_attn_reshape -->
<g id="node933" class="node">
<title>gpu3_layer9_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2196,-9338.31 2074,-9338.31 2074,-9286.31 2196,-9286.31 2196,-9338.31"/>
<text text-anchor="middle" x="2135" y="-9326.31" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2135" y="-9315.31" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-9304.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-9293.31" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer9_attn&#45;&gt;gpu3_layer9_attn_reshape -->
<g id="edge1163" class="edge">
<title>gpu3_layer9_attn&#45;&gt;gpu3_layer9_attn_reshape</title>
<path fill="none" stroke="black" d="M2135,-9375.15C2135,-9366.85 2135,-9357.47 2135,-9348.56"/>
<polygon fill="black" stroke="black" points="2138.5,-9348.42 2135,-9338.42 2131.5,-9348.42 2138.5,-9348.42"/>
</g>
<!-- gpu3_layer9_attn_out -->
<g id="node932" class="node">
<title>gpu3_layer9_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2196,-9249.31 2074,-9249.31 2074,-9197.31 2196,-9197.31 2196,-9249.31"/>
<text text-anchor="middle" x="2135" y="-9237.31" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2135" y="-9226.31" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-9215.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-9204.31" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer9_kv_update -->
<g id="node934" class="node">
<title>gpu3_layer9_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2135" cy="-9123.54" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2135" y="-9137.54" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2135" y="-9126.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-9115.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-9104.54" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer9_attn_out&#45;&gt;gpu3_layer9_kv_update -->
<g id="edge1165" class="edge">
<title>gpu3_layer9_attn_out&#45;&gt;gpu3_layer9_kv_update</title>
<path fill="none" stroke="black" d="M2135,-9197.13C2135,-9189 2135,-9179.7 2135,-9170.54"/>
<polygon fill="black" stroke="black" points="2138.5,-9170.32 2135,-9160.32 2131.5,-9170.32 2138.5,-9170.32"/>
</g>
<!-- gpu3_layer9_attn_reshape&#45;&gt;gpu3_layer9_attn_out -->
<g id="edge1164" class="edge">
<title>gpu3_layer9_attn_reshape&#45;&gt;gpu3_layer9_attn_out</title>
<path fill="none" stroke="black" d="M2135,-9286.15C2135,-9277.85 2135,-9268.47 2135,-9259.56"/>
<polygon fill="black" stroke="black" points="2138.5,-9259.42 2135,-9249.42 2131.5,-9259.42 2138.5,-9259.42"/>
</g>
<!-- gpu3_layer9_res1 -->
<g id="node935" class="node">
<title>gpu3_layer9_res1</title>
<polygon fill="lightblue" stroke="black" points="2196,-9049.77 2074,-9049.77 2074,-8997.77 2196,-8997.77 2196,-9049.77"/>
<text text-anchor="middle" x="2135" y="-9037.77" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2135" y="-9026.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-9015.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-9004.77" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer9_kv_update&#45;&gt;gpu3_layer9_res1 -->
<g id="edge1166" class="edge">
<title>gpu3_layer9_kv_update&#45;&gt;gpu3_layer9_res1</title>
<path fill="none" stroke="black" d="M2135,-9086.69C2135,-9078.01 2135,-9068.74 2135,-9060.09"/>
<polygon fill="black" stroke="black" points="2138.5,-9059.92 2135,-9049.92 2131.5,-9059.92 2138.5,-9059.92"/>
</g>
<!-- gpu3_layer9_ln2 -->
<g id="node936" class="node">
<title>gpu3_layer9_ln2</title>
<polygon fill="lightblue" stroke="black" points="2196,-8960.77 2074,-8960.77 2074,-8908.77 2196,-8908.77 2196,-8960.77"/>
<text text-anchor="middle" x="2135" y="-8948.77" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2135" y="-8937.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-8926.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-8915.77" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer9_res1&#45;&gt;gpu3_layer9_ln2 -->
<g id="edge1167" class="edge">
<title>gpu3_layer9_res1&#45;&gt;gpu3_layer9_ln2</title>
<path fill="none" stroke="black" d="M2135,-8997.61C2135,-8989.31 2135,-8979.93 2135,-8971.02"/>
<polygon fill="black" stroke="black" points="2138.5,-8970.88 2135,-8960.88 2131.5,-8970.88 2138.5,-8970.88"/>
</g>
<!-- gpu3_layer9_routing -->
<g id="node937" class="node">
<title>gpu3_layer9_routing</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-8871.77 2060.29,-8871.77 2008.53,-8745.77 2209.71,-8745.77 2261.47,-8871.77"/>
<text text-anchor="middle" x="2135" y="-8828.27" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2135" y="-8817.27" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-8806.27" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-8795.27" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2135" y="-8784.27" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer9_ln2&#45;&gt;gpu3_layer9_routing -->
<g id="edge1168" class="edge">
<title>gpu3_layer9_ln2&#45;&gt;gpu3_layer9_routing</title>
<path fill="none" stroke="black" d="M2135,-8908.68C2135,-8900.75 2135,-8891.55 2135,-8882.02"/>
<polygon fill="black" stroke="black" points="2138.5,-8882.01 2135,-8872.01 2131.5,-8882.01 2138.5,-8882.01"/>
</g>
<!-- gpu3_layer9_expert0 -->
<g id="node938" class="node">
<title>gpu3_layer9_expert0</title>
<polygon fill="lightblue" stroke="black" points="1916,-8699.77 1794,-8699.77 1794,-8647.77 1916,-8647.77 1916,-8699.77"/>
<text text-anchor="middle" x="1855" y="-8687.77" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1855" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer9_routing&#45;&gt;gpu3_layer9_expert0 -->
<g id="edge1155" class="edge">
<title>gpu3_layer9_routing&#45;&gt;gpu3_layer9_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2009.33,-8748.08C1977.34,-8732.89 1944.34,-8717.21 1917.11,-8704.27"/>
<polygon fill="black" stroke="black" points="1918.26,-8700.95 1907.73,-8699.82 1915.26,-8707.27 1918.26,-8700.95"/>
<text text-anchor="middle" x="1991.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer9_expert1 -->
<g id="node939" class="node">
<title>gpu3_layer9_expert1</title>
<polygon fill="lightblue" stroke="black" points="2056,-8699.77 1934,-8699.77 1934,-8647.77 2056,-8647.77 2056,-8699.77"/>
<text text-anchor="middle" x="1995" y="-8687.77" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1995" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer9_routing&#45;&gt;gpu3_layer9_expert1 -->
<g id="edge1156" class="edge">
<title>gpu3_layer9_routing&#45;&gt;gpu3_layer9_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2069.51,-8745.56C2055.48,-8732.23 2041.21,-8718.68 2028.97,-8707.04"/>
<polygon fill="black" stroke="black" points="2031.29,-8704.42 2021.63,-8700.07 2026.46,-8709.49 2031.29,-8704.42"/>
<text text-anchor="middle" x="2078.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer9_expert2 -->
<g id="node940" class="node">
<title>gpu3_layer9_expert2</title>
<polygon fill="lightblue" stroke="black" points="2196,-8699.77 2074,-8699.77 2074,-8647.77 2196,-8647.77 2196,-8699.77"/>
<text text-anchor="middle" x="2135" y="-8687.77" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2135" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer9_routing&#45;&gt;gpu3_layer9_expert2 -->
<g id="edge1157" class="edge">
<title>gpu3_layer9_routing&#45;&gt;gpu3_layer9_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2135,-8745.56C2135,-8733.49 2135,-8721.23 2135,-8710.39"/>
<polygon fill="black" stroke="black" points="2138.5,-8710.07 2135,-8700.07 2131.5,-8710.07 2138.5,-8710.07"/>
<text text-anchor="middle" x="2164.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer9_expert3 -->
<g id="node941" class="node">
<title>gpu3_layer9_expert3</title>
<polygon fill="lightblue" stroke="black" points="2336,-8699.77 2214,-8699.77 2214,-8647.77 2336,-8647.77 2336,-8699.77"/>
<text text-anchor="middle" x="2275" y="-8687.77" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2275" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer9_routing&#45;&gt;gpu3_layer9_expert3 -->
<g id="edge1158" class="edge">
<title>gpu3_layer9_routing&#45;&gt;gpu3_layer9_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2200.49,-8745.56C2214.52,-8732.23 2228.79,-8718.68 2241.03,-8707.04"/>
<polygon fill="black" stroke="black" points="2243.54,-8709.49 2248.37,-8700.07 2238.71,-8704.42 2243.54,-8709.49"/>
<text text-anchor="middle" x="2259.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer9_expert_agg -->
<g id="node942" class="node">
<title>gpu3_layer9_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-8610.77 2060.29,-8610.77 2008.53,-8506.77 2209.71,-8506.77 2261.47,-8610.77"/>
<text text-anchor="middle" x="2135" y="-8572.77" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2135" y="-8561.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-8550.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-8539.77" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer9_routing&#45;&gt;gpu3_layer9_expert_agg -->
<g id="edge1173" class="edge">
<title>gpu3_layer9_routing&#45;&gt;gpu3_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M2224.22,-8780.86C2297.96,-8753.7 2384.6,-8707.31 2345,-8647.77 2324.44,-8616.86 2290.7,-8596.79 2256.22,-8583.76"/>
<polygon fill="black" stroke="black" points="2257.08,-8580.35 2246.48,-8580.27 2254.71,-8586.94 2257.08,-8580.35"/>
</g>
<!-- gpu3_layer9_expert0&#45;&gt;gpu3_layer9_expert_agg -->
<g id="edge1169" class="edge">
<title>gpu3_layer9_expert0&#45;&gt;gpu3_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M1916.1,-8648.12C1952.98,-8633.23 2000.7,-8613.97 2042.16,-8597.24"/>
<polygon fill="black" stroke="black" points="2043.5,-8600.48 2051.46,-8593.49 2040.88,-8593.99 2043.5,-8600.48"/>
</g>
<!-- gpu3_layer9_expert1&#45;&gt;gpu3_layer9_expert_agg -->
<g id="edge1170" class="edge">
<title>gpu3_layer9_expert1&#45;&gt;gpu3_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M2026.07,-8647.7C2037.32,-8638.62 2050.53,-8627.95 2063.8,-8617.24"/>
<polygon fill="black" stroke="black" points="2066.02,-8619.95 2071.6,-8610.95 2061.62,-8614.5 2066.02,-8619.95"/>
</g>
<!-- gpu3_layer9_expert2&#45;&gt;gpu3_layer9_expert_agg -->
<g id="edge1171" class="edge">
<title>gpu3_layer9_expert2&#45;&gt;gpu3_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M2135,-8647.7C2135,-8639.77 2135,-8630.63 2135,-8621.31"/>
<polygon fill="black" stroke="black" points="2138.5,-8621.17 2135,-8611.17 2131.5,-8621.17 2138.5,-8621.17"/>
</g>
<!-- gpu3_layer9_expert3&#45;&gt;gpu3_layer9_expert_agg -->
<g id="edge1172" class="edge">
<title>gpu3_layer9_expert3&#45;&gt;gpu3_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M2243.93,-8647.7C2232.68,-8638.62 2219.47,-8627.95 2206.2,-8617.24"/>
<polygon fill="black" stroke="black" points="2208.38,-8614.5 2198.4,-8610.95 2203.98,-8619.95 2208.38,-8614.5"/>
</g>
<!-- gpu3_layer9_res2 -->
<g id="node943" class="node">
<title>gpu3_layer9_res2</title>
<polygon fill="lightblue" stroke="black" points="2196,-8469.77 2074,-8469.77 2074,-8417.77 2196,-8417.77 2196,-8469.77"/>
<text text-anchor="middle" x="2135" y="-8457.77" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2135" y="-8446.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-8435.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-8424.77" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer9_expert_agg&#45;&gt;gpu3_layer9_res2 -->
<g id="edge1174" class="edge">
<title>gpu3_layer9_expert_agg&#45;&gt;gpu3_layer9_res2</title>
<path fill="none" stroke="black" d="M2135,-8506.56C2135,-8497.61 2135,-8488.48 2135,-8480.08"/>
<polygon fill="black" stroke="black" points="2138.5,-8479.9 2135,-8469.9 2131.5,-8479.9 2138.5,-8479.9"/>
</g>
<!-- gpu3_layer10_ln1 -->
<g id="node944" class="node">
<title>gpu3_layer10_ln1</title>
<polygon fill="lightblue" stroke="black" points="2196,-8380.77 2074,-8380.77 2074,-8328.77 2196,-8328.77 2196,-8380.77"/>
<text text-anchor="middle" x="2135" y="-8368.77" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2135" y="-8357.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-8346.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-8335.77" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer9_res2&#45;&gt;gpu3_layer10_ln1 -->
<g id="edge1179" class="edge">
<title>gpu3_layer9_res2&#45;&gt;gpu3_layer10_ln1</title>
<path fill="none" stroke="black" d="M2135,-8417.61C2135,-8409.31 2135,-8399.93 2135,-8391.02"/>
<polygon fill="black" stroke="black" points="2138.5,-8390.88 2135,-8380.88 2131.5,-8390.88 2138.5,-8390.88"/>
</g>
<!-- gpu3_layer10_qkv -->
<g id="node945" class="node">
<title>gpu3_layer10_qkv</title>
<polygon fill="lightblue" stroke="black" points="2196,-8291.77 2074,-8291.77 2074,-8239.77 2196,-8239.77 2196,-8291.77"/>
<text text-anchor="middle" x="2135" y="-8279.77" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2135" y="-8268.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-8257.77" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-8246.77" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer10_ln1&#45;&gt;gpu3_layer10_qkv -->
<g id="edge1180" class="edge">
<title>gpu3_layer10_ln1&#45;&gt;gpu3_layer10_qkv</title>
<path fill="none" stroke="black" d="M2135,-8328.61C2135,-8320.31 2135,-8310.93 2135,-8302.02"/>
<polygon fill="black" stroke="black" points="2138.5,-8301.88 2135,-8291.88 2131.5,-8301.88 2138.5,-8301.88"/>
</g>
<!-- gpu3_layer10_reshape -->
<g id="node946" class="node">
<title>gpu3_layer10_reshape</title>
<polygon fill="lightblue" stroke="black" points="2199,-8202.77 2071,-8202.77 2071,-8150.77 2199,-8150.77 2199,-8202.77"/>
<text text-anchor="middle" x="2135" y="-8190.77" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2135" y="-8179.77" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-8168.77" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-8157.77" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer10_qkv&#45;&gt;gpu3_layer10_reshape -->
<g id="edge1181" class="edge">
<title>gpu3_layer10_qkv&#45;&gt;gpu3_layer10_reshape</title>
<path fill="none" stroke="black" d="M2135,-8239.61C2135,-8231.31 2135,-8221.93 2135,-8213.02"/>
<polygon fill="black" stroke="black" points="2138.5,-8212.88 2135,-8202.88 2131.5,-8212.88 2138.5,-8212.88"/>
</g>
<!-- gpu3_layer10_attn -->
<g id="node947" class="node">
<title>gpu3_layer10_attn</title>
<polygon fill="lightblue" stroke="black" points="2199,-8113.77 2071,-8113.77 2071,-8061.77 2199,-8061.77 2199,-8113.77"/>
<text text-anchor="middle" x="2135" y="-8101.77" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2135" y="-8090.77" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-8079.77" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-8068.77" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer10_reshape&#45;&gt;gpu3_layer10_attn -->
<g id="edge1182" class="edge">
<title>gpu3_layer10_reshape&#45;&gt;gpu3_layer10_attn</title>
<path fill="none" stroke="black" d="M2135,-8150.61C2135,-8142.31 2135,-8132.93 2135,-8124.02"/>
<polygon fill="black" stroke="black" points="2138.5,-8123.88 2135,-8113.88 2131.5,-8123.88 2138.5,-8123.88"/>
</g>
<!-- gpu3_layer10_attn_reshape -->
<g id="node949" class="node">
<title>gpu3_layer10_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2196,-8024.77 2074,-8024.77 2074,-7972.77 2196,-7972.77 2196,-8024.77"/>
<text text-anchor="middle" x="2135" y="-8012.77" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2135" y="-8001.77" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-7990.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-7979.77" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer10_attn&#45;&gt;gpu3_layer10_attn_reshape -->
<g id="edge1183" class="edge">
<title>gpu3_layer10_attn&#45;&gt;gpu3_layer10_attn_reshape</title>
<path fill="none" stroke="black" d="M2135,-8061.61C2135,-8053.31 2135,-8043.93 2135,-8035.02"/>
<polygon fill="black" stroke="black" points="2138.5,-8034.88 2135,-8024.88 2131.5,-8034.88 2138.5,-8034.88"/>
</g>
<!-- gpu3_layer10_attn_out -->
<g id="node948" class="node">
<title>gpu3_layer10_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2196,-7935.77 2074,-7935.77 2074,-7883.77 2196,-7883.77 2196,-7935.77"/>
<text text-anchor="middle" x="2135" y="-7923.77" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2135" y="-7912.77" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-7901.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-7890.77" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer10_kv_update -->
<g id="node950" class="node">
<title>gpu3_layer10_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2135" cy="-7810" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2135" y="-7824" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2135" y="-7813" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-7802" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-7791" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer10_attn_out&#45;&gt;gpu3_layer10_kv_update -->
<g id="edge1185" class="edge">
<title>gpu3_layer10_attn_out&#45;&gt;gpu3_layer10_kv_update</title>
<path fill="none" stroke="black" d="M2135,-7883.6C2135,-7875.46 2135,-7866.16 2135,-7857"/>
<polygon fill="black" stroke="black" points="2138.5,-7856.78 2135,-7846.78 2131.5,-7856.78 2138.5,-7856.78"/>
</g>
<!-- gpu3_layer10_attn_reshape&#45;&gt;gpu3_layer10_attn_out -->
<g id="edge1184" class="edge">
<title>gpu3_layer10_attn_reshape&#45;&gt;gpu3_layer10_attn_out</title>
<path fill="none" stroke="black" d="M2135,-7972.61C2135,-7964.31 2135,-7954.93 2135,-7946.02"/>
<polygon fill="black" stroke="black" points="2138.5,-7945.88 2135,-7935.88 2131.5,-7945.88 2138.5,-7945.88"/>
</g>
<!-- gpu3_layer10_res1 -->
<g id="node951" class="node">
<title>gpu3_layer10_res1</title>
<polygon fill="lightblue" stroke="black" points="2196,-7736.23 2074,-7736.23 2074,-7684.23 2196,-7684.23 2196,-7736.23"/>
<text text-anchor="middle" x="2135" y="-7724.23" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2135" y="-7713.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-7702.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-7691.23" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer10_kv_update&#45;&gt;gpu3_layer10_res1 -->
<g id="edge1186" class="edge">
<title>gpu3_layer10_kv_update&#45;&gt;gpu3_layer10_res1</title>
<path fill="none" stroke="black" d="M2135,-7773.15C2135,-7764.47 2135,-7755.2 2135,-7746.55"/>
<polygon fill="black" stroke="black" points="2138.5,-7746.38 2135,-7736.38 2131.5,-7746.38 2138.5,-7746.38"/>
</g>
<!-- gpu3_layer10_ln2 -->
<g id="node952" class="node">
<title>gpu3_layer10_ln2</title>
<polygon fill="lightblue" stroke="black" points="2196,-7647.23 2074,-7647.23 2074,-7595.23 2196,-7595.23 2196,-7647.23"/>
<text text-anchor="middle" x="2135" y="-7635.23" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2135" y="-7624.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-7613.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-7602.23" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer10_res1&#45;&gt;gpu3_layer10_ln2 -->
<g id="edge1187" class="edge">
<title>gpu3_layer10_res1&#45;&gt;gpu3_layer10_ln2</title>
<path fill="none" stroke="black" d="M2135,-7684.07C2135,-7675.77 2135,-7666.39 2135,-7657.48"/>
<polygon fill="black" stroke="black" points="2138.5,-7657.34 2135,-7647.34 2131.5,-7657.34 2138.5,-7657.34"/>
</g>
<!-- gpu3_layer10_routing -->
<g id="node953" class="node">
<title>gpu3_layer10_routing</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-7558.23 2060.29,-7558.23 2008.53,-7432.23 2209.71,-7432.23 2261.47,-7558.23"/>
<text text-anchor="middle" x="2135" y="-7514.73" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2135" y="-7503.73" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-7492.73" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-7481.73" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2135" y="-7470.73" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer10_ln2&#45;&gt;gpu3_layer10_routing -->
<g id="edge1188" class="edge">
<title>gpu3_layer10_ln2&#45;&gt;gpu3_layer10_routing</title>
<path fill="none" stroke="black" d="M2135,-7595.14C2135,-7587.21 2135,-7578.01 2135,-7568.48"/>
<polygon fill="black" stroke="black" points="2138.5,-7568.47 2135,-7558.47 2131.5,-7568.47 2138.5,-7568.47"/>
</g>
<!-- gpu3_layer10_expert0 -->
<g id="node954" class="node">
<title>gpu3_layer10_expert0</title>
<polygon fill="lightblue" stroke="black" points="1916,-7386.23 1794,-7386.23 1794,-7334.23 1916,-7334.23 1916,-7386.23"/>
<text text-anchor="middle" x="1855" y="-7374.23" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1855" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer10_routing&#45;&gt;gpu3_layer10_expert0 -->
<g id="edge1175" class="edge">
<title>gpu3_layer10_routing&#45;&gt;gpu3_layer10_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2009.33,-7434.54C1977.34,-7419.35 1944.34,-7403.67 1917.11,-7390.74"/>
<polygon fill="black" stroke="black" points="1918.26,-7387.41 1907.73,-7386.28 1915.26,-7393.73 1918.26,-7387.41"/>
<text text-anchor="middle" x="1991.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer10_expert1 -->
<g id="node955" class="node">
<title>gpu3_layer10_expert1</title>
<polygon fill="lightblue" stroke="black" points="2056,-7386.23 1934,-7386.23 1934,-7334.23 2056,-7334.23 2056,-7386.23"/>
<text text-anchor="middle" x="1995" y="-7374.23" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1995" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer10_routing&#45;&gt;gpu3_layer10_expert1 -->
<g id="edge1176" class="edge">
<title>gpu3_layer10_routing&#45;&gt;gpu3_layer10_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2069.51,-7432.02C2055.48,-7418.69 2041.21,-7405.14 2028.97,-7393.5"/>
<polygon fill="black" stroke="black" points="2031.29,-7390.88 2021.63,-7386.53 2026.46,-7395.95 2031.29,-7390.88"/>
<text text-anchor="middle" x="2078.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer10_expert2 -->
<g id="node956" class="node">
<title>gpu3_layer10_expert2</title>
<polygon fill="lightblue" stroke="black" points="2196,-7386.23 2074,-7386.23 2074,-7334.23 2196,-7334.23 2196,-7386.23"/>
<text text-anchor="middle" x="2135" y="-7374.23" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2135" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer10_routing&#45;&gt;gpu3_layer10_expert2 -->
<g id="edge1177" class="edge">
<title>gpu3_layer10_routing&#45;&gt;gpu3_layer10_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2135,-7432.02C2135,-7419.95 2135,-7407.69 2135,-7396.85"/>
<polygon fill="black" stroke="black" points="2138.5,-7396.53 2135,-7386.53 2131.5,-7396.53 2138.5,-7396.53"/>
<text text-anchor="middle" x="2164.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer10_expert3 -->
<g id="node957" class="node">
<title>gpu3_layer10_expert3</title>
<polygon fill="lightblue" stroke="black" points="2336,-7386.23 2214,-7386.23 2214,-7334.23 2336,-7334.23 2336,-7386.23"/>
<text text-anchor="middle" x="2275" y="-7374.23" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2275" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer10_routing&#45;&gt;gpu3_layer10_expert3 -->
<g id="edge1178" class="edge">
<title>gpu3_layer10_routing&#45;&gt;gpu3_layer10_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2200.49,-7432.02C2214.52,-7418.69 2228.79,-7405.14 2241.03,-7393.5"/>
<polygon fill="black" stroke="black" points="2243.54,-7395.95 2248.37,-7386.53 2238.71,-7390.88 2243.54,-7395.95"/>
<text text-anchor="middle" x="2259.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer10_expert_agg -->
<g id="node958" class="node">
<title>gpu3_layer10_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-7297.23 2060.29,-7297.23 2008.53,-7193.23 2209.71,-7193.23 2261.47,-7297.23"/>
<text text-anchor="middle" x="2135" y="-7259.23" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2135" y="-7248.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-7237.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-7226.23" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer10_routing&#45;&gt;gpu3_layer10_expert_agg -->
<g id="edge1193" class="edge">
<title>gpu3_layer10_routing&#45;&gt;gpu3_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M2224.22,-7467.32C2297.96,-7440.16 2384.6,-7393.77 2345,-7334.23 2324.44,-7303.32 2290.7,-7283.25 2256.22,-7270.22"/>
<polygon fill="black" stroke="black" points="2257.08,-7266.81 2246.48,-7266.73 2254.71,-7273.4 2257.08,-7266.81"/>
</g>
<!-- gpu3_layer10_expert0&#45;&gt;gpu3_layer10_expert_agg -->
<g id="edge1189" class="edge">
<title>gpu3_layer10_expert0&#45;&gt;gpu3_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M1916.1,-7334.58C1952.98,-7319.69 2000.7,-7300.44 2042.16,-7283.7"/>
<polygon fill="black" stroke="black" points="2043.5,-7286.94 2051.46,-7279.95 2040.88,-7280.45 2043.5,-7286.94"/>
</g>
<!-- gpu3_layer10_expert1&#45;&gt;gpu3_layer10_expert_agg -->
<g id="edge1190" class="edge">
<title>gpu3_layer10_expert1&#45;&gt;gpu3_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M2026.07,-7334.16C2037.32,-7325.08 2050.53,-7314.42 2063.8,-7303.71"/>
<polygon fill="black" stroke="black" points="2066.02,-7306.41 2071.6,-7297.41 2061.62,-7300.96 2066.02,-7306.41"/>
</g>
<!-- gpu3_layer10_expert2&#45;&gt;gpu3_layer10_expert_agg -->
<g id="edge1191" class="edge">
<title>gpu3_layer10_expert2&#45;&gt;gpu3_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M2135,-7334.16C2135,-7326.23 2135,-7317.09 2135,-7307.77"/>
<polygon fill="black" stroke="black" points="2138.5,-7307.64 2135,-7297.64 2131.5,-7307.64 2138.5,-7307.64"/>
</g>
<!-- gpu3_layer10_expert3&#45;&gt;gpu3_layer10_expert_agg -->
<g id="edge1192" class="edge">
<title>gpu3_layer10_expert3&#45;&gt;gpu3_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M2243.93,-7334.16C2232.68,-7325.08 2219.47,-7314.42 2206.2,-7303.71"/>
<polygon fill="black" stroke="black" points="2208.38,-7300.96 2198.4,-7297.41 2203.98,-7306.41 2208.38,-7300.96"/>
</g>
<!-- gpu3_layer10_res2 -->
<g id="node959" class="node">
<title>gpu3_layer10_res2</title>
<polygon fill="lightblue" stroke="black" points="2196,-7156.23 2074,-7156.23 2074,-7104.23 2196,-7104.23 2196,-7156.23"/>
<text text-anchor="middle" x="2135" y="-7144.23" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2135" y="-7133.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-7122.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-7111.23" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer10_expert_agg&#45;&gt;gpu3_layer10_res2 -->
<g id="edge1194" class="edge">
<title>gpu3_layer10_expert_agg&#45;&gt;gpu3_layer10_res2</title>
<path fill="none" stroke="black" d="M2135,-7193.02C2135,-7184.07 2135,-7174.94 2135,-7166.55"/>
<polygon fill="black" stroke="black" points="2138.5,-7166.37 2135,-7156.37 2131.5,-7166.37 2138.5,-7166.37"/>
</g>
<!-- gpu3_layer11_ln1 -->
<g id="node960" class="node">
<title>gpu3_layer11_ln1</title>
<polygon fill="lightblue" stroke="black" points="2196,-7067.23 2074,-7067.23 2074,-7015.23 2196,-7015.23 2196,-7067.23"/>
<text text-anchor="middle" x="2135" y="-7055.23" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2135" y="-7044.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-7033.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-7022.23" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer10_res2&#45;&gt;gpu3_layer11_ln1 -->
<g id="edge1199" class="edge">
<title>gpu3_layer10_res2&#45;&gt;gpu3_layer11_ln1</title>
<path fill="none" stroke="black" d="M2135,-7104.07C2135,-7095.77 2135,-7086.39 2135,-7077.48"/>
<polygon fill="black" stroke="black" points="2138.5,-7077.34 2135,-7067.34 2131.5,-7077.34 2138.5,-7077.34"/>
</g>
<!-- gpu3_layer11_qkv -->
<g id="node961" class="node">
<title>gpu3_layer11_qkv</title>
<polygon fill="lightblue" stroke="black" points="2196,-6978.23 2074,-6978.23 2074,-6926.23 2196,-6926.23 2196,-6978.23"/>
<text text-anchor="middle" x="2135" y="-6966.23" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2135" y="-6955.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-6944.23" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-6933.23" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer11_ln1&#45;&gt;gpu3_layer11_qkv -->
<g id="edge1200" class="edge">
<title>gpu3_layer11_ln1&#45;&gt;gpu3_layer11_qkv</title>
<path fill="none" stroke="black" d="M2135,-7015.07C2135,-7006.77 2135,-6997.39 2135,-6988.48"/>
<polygon fill="black" stroke="black" points="2138.5,-6988.34 2135,-6978.34 2131.5,-6988.34 2138.5,-6988.34"/>
</g>
<!-- gpu3_layer11_reshape -->
<g id="node962" class="node">
<title>gpu3_layer11_reshape</title>
<polygon fill="lightblue" stroke="black" points="2199,-6889.23 2071,-6889.23 2071,-6837.23 2199,-6837.23 2199,-6889.23"/>
<text text-anchor="middle" x="2135" y="-6877.23" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2135" y="-6866.23" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-6855.23" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-6844.23" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer11_qkv&#45;&gt;gpu3_layer11_reshape -->
<g id="edge1201" class="edge">
<title>gpu3_layer11_qkv&#45;&gt;gpu3_layer11_reshape</title>
<path fill="none" stroke="black" d="M2135,-6926.07C2135,-6917.77 2135,-6908.39 2135,-6899.48"/>
<polygon fill="black" stroke="black" points="2138.5,-6899.34 2135,-6889.34 2131.5,-6899.34 2138.5,-6899.34"/>
</g>
<!-- gpu3_layer11_attn -->
<g id="node963" class="node">
<title>gpu3_layer11_attn</title>
<polygon fill="lightblue" stroke="black" points="2199,-6800.23 2071,-6800.23 2071,-6748.23 2199,-6748.23 2199,-6800.23"/>
<text text-anchor="middle" x="2135" y="-6788.23" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2135" y="-6777.23" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-6766.23" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-6755.23" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer11_reshape&#45;&gt;gpu3_layer11_attn -->
<g id="edge1202" class="edge">
<title>gpu3_layer11_reshape&#45;&gt;gpu3_layer11_attn</title>
<path fill="none" stroke="black" d="M2135,-6837.07C2135,-6828.77 2135,-6819.39 2135,-6810.48"/>
<polygon fill="black" stroke="black" points="2138.5,-6810.34 2135,-6800.34 2131.5,-6810.34 2138.5,-6810.34"/>
</g>
<!-- gpu3_layer11_attn_reshape -->
<g id="node965" class="node">
<title>gpu3_layer11_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2196,-6711.23 2074,-6711.23 2074,-6659.23 2196,-6659.23 2196,-6711.23"/>
<text text-anchor="middle" x="2135" y="-6699.23" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2135" y="-6688.23" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-6677.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-6666.23" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer11_attn&#45;&gt;gpu3_layer11_attn_reshape -->
<g id="edge1203" class="edge">
<title>gpu3_layer11_attn&#45;&gt;gpu3_layer11_attn_reshape</title>
<path fill="none" stroke="black" d="M2135,-6748.07C2135,-6739.77 2135,-6730.39 2135,-6721.48"/>
<polygon fill="black" stroke="black" points="2138.5,-6721.34 2135,-6711.34 2131.5,-6721.34 2138.5,-6721.34"/>
</g>
<!-- gpu3_layer11_attn_out -->
<g id="node964" class="node">
<title>gpu3_layer11_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2196,-6622.23 2074,-6622.23 2074,-6570.23 2196,-6570.23 2196,-6622.23"/>
<text text-anchor="middle" x="2135" y="-6610.23" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2135" y="-6599.23" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-6588.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-6577.23" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer11_kv_update -->
<g id="node966" class="node">
<title>gpu3_layer11_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2135" cy="-6496.47" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2135" y="-6510.47" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2135" y="-6499.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-6488.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-6477.47" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer11_attn_out&#45;&gt;gpu3_layer11_kv_update -->
<g id="edge1205" class="edge">
<title>gpu3_layer11_attn_out&#45;&gt;gpu3_layer11_kv_update</title>
<path fill="none" stroke="black" d="M2135,-6570.06C2135,-6561.92 2135,-6552.62 2135,-6543.46"/>
<polygon fill="black" stroke="black" points="2138.5,-6543.24 2135,-6533.24 2131.5,-6543.24 2138.5,-6543.24"/>
</g>
<!-- gpu3_layer11_attn_reshape&#45;&gt;gpu3_layer11_attn_out -->
<g id="edge1204" class="edge">
<title>gpu3_layer11_attn_reshape&#45;&gt;gpu3_layer11_attn_out</title>
<path fill="none" stroke="black" d="M2135,-6659.07C2135,-6650.77 2135,-6641.39 2135,-6632.48"/>
<polygon fill="black" stroke="black" points="2138.5,-6632.34 2135,-6622.34 2131.5,-6632.34 2138.5,-6632.34"/>
</g>
<!-- gpu3_layer11_res1 -->
<g id="node967" class="node">
<title>gpu3_layer11_res1</title>
<polygon fill="lightblue" stroke="black" points="2196,-6422.7 2074,-6422.7 2074,-6370.7 2196,-6370.7 2196,-6422.7"/>
<text text-anchor="middle" x="2135" y="-6410.7" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2135" y="-6399.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-6388.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-6377.7" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer11_kv_update&#45;&gt;gpu3_layer11_res1 -->
<g id="edge1206" class="edge">
<title>gpu3_layer11_kv_update&#45;&gt;gpu3_layer11_res1</title>
<path fill="none" stroke="black" d="M2135,-6459.61C2135,-6450.94 2135,-6441.67 2135,-6433.01"/>
<polygon fill="black" stroke="black" points="2138.5,-6432.84 2135,-6422.84 2131.5,-6432.84 2138.5,-6432.84"/>
</g>
<!-- gpu3_layer11_ln2 -->
<g id="node968" class="node">
<title>gpu3_layer11_ln2</title>
<polygon fill="lightblue" stroke="black" points="2196,-6333.7 2074,-6333.7 2074,-6281.7 2196,-6281.7 2196,-6333.7"/>
<text text-anchor="middle" x="2135" y="-6321.7" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2135" y="-6310.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-6299.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-6288.7" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer11_res1&#45;&gt;gpu3_layer11_ln2 -->
<g id="edge1207" class="edge">
<title>gpu3_layer11_res1&#45;&gt;gpu3_layer11_ln2</title>
<path fill="none" stroke="black" d="M2135,-6370.53C2135,-6362.24 2135,-6352.85 2135,-6343.94"/>
<polygon fill="black" stroke="black" points="2138.5,-6343.8 2135,-6333.8 2131.5,-6343.8 2138.5,-6343.8"/>
</g>
<!-- gpu3_layer11_routing -->
<g id="node969" class="node">
<title>gpu3_layer11_routing</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-6244.7 2060.29,-6244.7 2008.53,-6118.7 2209.71,-6118.7 2261.47,-6244.7"/>
<text text-anchor="middle" x="2135" y="-6201.2" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2135" y="-6190.2" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-6179.2" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-6168.2" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2135" y="-6157.2" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer11_ln2&#45;&gt;gpu3_layer11_routing -->
<g id="edge1208" class="edge">
<title>gpu3_layer11_ln2&#45;&gt;gpu3_layer11_routing</title>
<path fill="none" stroke="black" d="M2135,-6281.6C2135,-6273.67 2135,-6264.47 2135,-6254.94"/>
<polygon fill="black" stroke="black" points="2138.5,-6254.93 2135,-6244.93 2131.5,-6254.93 2138.5,-6254.93"/>
</g>
<!-- gpu3_layer11_expert0 -->
<g id="node970" class="node">
<title>gpu3_layer11_expert0</title>
<polygon fill="lightblue" stroke="black" points="1916,-6072.7 1794,-6072.7 1794,-6020.7 1916,-6020.7 1916,-6072.7"/>
<text text-anchor="middle" x="1855" y="-6060.7" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1855" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer11_routing&#45;&gt;gpu3_layer11_expert0 -->
<g id="edge1195" class="edge">
<title>gpu3_layer11_routing&#45;&gt;gpu3_layer11_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2009.33,-6121C1977.34,-6105.81 1944.34,-6090.13 1917.11,-6077.2"/>
<polygon fill="black" stroke="black" points="1918.26,-6073.87 1907.73,-6072.74 1915.26,-6080.19 1918.26,-6073.87"/>
<text text-anchor="middle" x="1991.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer11_expert1 -->
<g id="node971" class="node">
<title>gpu3_layer11_expert1</title>
<polygon fill="lightblue" stroke="black" points="2056,-6072.7 1934,-6072.7 1934,-6020.7 2056,-6020.7 2056,-6072.7"/>
<text text-anchor="middle" x="1995" y="-6060.7" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1995" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer11_routing&#45;&gt;gpu3_layer11_expert1 -->
<g id="edge1196" class="edge">
<title>gpu3_layer11_routing&#45;&gt;gpu3_layer11_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2069.51,-6118.48C2055.48,-6105.15 2041.21,-6091.6 2028.97,-6079.97"/>
<polygon fill="black" stroke="black" points="2031.29,-6077.34 2021.63,-6072.99 2026.46,-6082.41 2031.29,-6077.34"/>
<text text-anchor="middle" x="2078.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer11_expert2 -->
<g id="node972" class="node">
<title>gpu3_layer11_expert2</title>
<polygon fill="lightblue" stroke="black" points="2196,-6072.7 2074,-6072.7 2074,-6020.7 2196,-6020.7 2196,-6072.7"/>
<text text-anchor="middle" x="2135" y="-6060.7" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2135" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer11_routing&#45;&gt;gpu3_layer11_expert2 -->
<g id="edge1197" class="edge">
<title>gpu3_layer11_routing&#45;&gt;gpu3_layer11_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2135,-6118.48C2135,-6106.41 2135,-6094.15 2135,-6083.31"/>
<polygon fill="black" stroke="black" points="2138.5,-6082.99 2135,-6072.99 2131.5,-6082.99 2138.5,-6082.99"/>
<text text-anchor="middle" x="2164.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer11_expert3 -->
<g id="node973" class="node">
<title>gpu3_layer11_expert3</title>
<polygon fill="lightblue" stroke="black" points="2336,-6072.7 2214,-6072.7 2214,-6020.7 2336,-6020.7 2336,-6072.7"/>
<text text-anchor="middle" x="2275" y="-6060.7" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2275" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer11_routing&#45;&gt;gpu3_layer11_expert3 -->
<g id="edge1198" class="edge">
<title>gpu3_layer11_routing&#45;&gt;gpu3_layer11_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2200.49,-6118.48C2214.52,-6105.15 2228.79,-6091.6 2241.03,-6079.97"/>
<polygon fill="black" stroke="black" points="2243.54,-6082.41 2248.37,-6072.99 2238.71,-6077.34 2243.54,-6082.41"/>
<text text-anchor="middle" x="2259.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer11_expert_agg -->
<g id="node974" class="node">
<title>gpu3_layer11_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-5983.7 2060.29,-5983.7 2008.53,-5879.7 2209.71,-5879.7 2261.47,-5983.7"/>
<text text-anchor="middle" x="2135" y="-5945.7" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2135" y="-5934.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-5923.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-5912.7" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer11_routing&#45;&gt;gpu3_layer11_expert_agg -->
<g id="edge1213" class="edge">
<title>gpu3_layer11_routing&#45;&gt;gpu3_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M2224.22,-6153.78C2297.96,-6126.62 2384.6,-6080.23 2345,-6020.7 2324.44,-5989.78 2290.7,-5969.71 2256.22,-5956.68"/>
<polygon fill="black" stroke="black" points="2257.08,-5953.27 2246.48,-5953.19 2254.71,-5959.86 2257.08,-5953.27"/>
</g>
<!-- gpu3_layer11_expert0&#45;&gt;gpu3_layer11_expert_agg -->
<g id="edge1209" class="edge">
<title>gpu3_layer11_expert0&#45;&gt;gpu3_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M1916.1,-6021.04C1952.98,-6006.15 2000.7,-5986.9 2042.16,-5970.16"/>
<polygon fill="black" stroke="black" points="2043.5,-5973.4 2051.46,-5966.41 2040.88,-5966.91 2043.5,-5973.4"/>
</g>
<!-- gpu3_layer11_expert1&#45;&gt;gpu3_layer11_expert_agg -->
<g id="edge1210" class="edge">
<title>gpu3_layer11_expert1&#45;&gt;gpu3_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M2026.07,-6020.62C2037.32,-6011.54 2050.53,-6000.88 2063.8,-5990.17"/>
<polygon fill="black" stroke="black" points="2066.02,-5992.87 2071.6,-5983.87 2061.62,-5987.42 2066.02,-5992.87"/>
</g>
<!-- gpu3_layer11_expert2&#45;&gt;gpu3_layer11_expert_agg -->
<g id="edge1211" class="edge">
<title>gpu3_layer11_expert2&#45;&gt;gpu3_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M2135,-6020.62C2135,-6012.69 2135,-6003.55 2135,-5994.23"/>
<polygon fill="black" stroke="black" points="2138.5,-5994.1 2135,-5984.1 2131.5,-5994.1 2138.5,-5994.1"/>
</g>
<!-- gpu3_layer11_expert3&#45;&gt;gpu3_layer11_expert_agg -->
<g id="edge1212" class="edge">
<title>gpu3_layer11_expert3&#45;&gt;gpu3_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M2243.93,-6020.62C2232.68,-6011.54 2219.47,-6000.88 2206.2,-5990.17"/>
<polygon fill="black" stroke="black" points="2208.38,-5987.42 2198.4,-5983.87 2203.98,-5992.87 2208.38,-5987.42"/>
</g>
<!-- gpu3_layer11_res2 -->
<g id="node975" class="node">
<title>gpu3_layer11_res2</title>
<polygon fill="lightblue" stroke="black" points="2196,-5842.7 2074,-5842.7 2074,-5790.7 2196,-5790.7 2196,-5842.7"/>
<text text-anchor="middle" x="2135" y="-5830.7" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2135" y="-5819.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-5808.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-5797.7" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer11_expert_agg&#45;&gt;gpu3_layer11_res2 -->
<g id="edge1214" class="edge">
<title>gpu3_layer11_expert_agg&#45;&gt;gpu3_layer11_res2</title>
<path fill="none" stroke="black" d="M2135,-5879.49C2135,-5870.53 2135,-5861.41 2135,-5853.01"/>
<polygon fill="black" stroke="black" points="2138.5,-5852.83 2135,-5842.83 2131.5,-5852.83 2138.5,-5852.83"/>
</g>
<!-- gpu3_layer12_ln1 -->
<g id="node976" class="node">
<title>gpu3_layer12_ln1</title>
<polygon fill="lightblue" stroke="black" points="2196,-5753.7 2074,-5753.7 2074,-5701.7 2196,-5701.7 2196,-5753.7"/>
<text text-anchor="middle" x="2135" y="-5741.7" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2135" y="-5730.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-5719.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-5708.7" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer11_res2&#45;&gt;gpu3_layer12_ln1 -->
<g id="edge1219" class="edge">
<title>gpu3_layer11_res2&#45;&gt;gpu3_layer12_ln1</title>
<path fill="none" stroke="black" d="M2135,-5790.53C2135,-5782.24 2135,-5772.85 2135,-5763.94"/>
<polygon fill="black" stroke="black" points="2138.5,-5763.8 2135,-5753.8 2131.5,-5763.8 2138.5,-5763.8"/>
</g>
<!-- gpu3_layer12_qkv -->
<g id="node977" class="node">
<title>gpu3_layer12_qkv</title>
<polygon fill="lightblue" stroke="black" points="2196,-5664.7 2074,-5664.7 2074,-5612.7 2196,-5612.7 2196,-5664.7"/>
<text text-anchor="middle" x="2135" y="-5652.7" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2135" y="-5641.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-5630.7" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-5619.7" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer12_ln1&#45;&gt;gpu3_layer12_qkv -->
<g id="edge1220" class="edge">
<title>gpu3_layer12_ln1&#45;&gt;gpu3_layer12_qkv</title>
<path fill="none" stroke="black" d="M2135,-5701.53C2135,-5693.24 2135,-5683.85 2135,-5674.94"/>
<polygon fill="black" stroke="black" points="2138.5,-5674.8 2135,-5664.8 2131.5,-5674.8 2138.5,-5674.8"/>
</g>
<!-- gpu3_layer12_reshape -->
<g id="node978" class="node">
<title>gpu3_layer12_reshape</title>
<polygon fill="lightblue" stroke="black" points="2199,-5575.7 2071,-5575.7 2071,-5523.7 2199,-5523.7 2199,-5575.7"/>
<text text-anchor="middle" x="2135" y="-5563.7" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2135" y="-5552.7" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-5541.7" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-5530.7" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer12_qkv&#45;&gt;gpu3_layer12_reshape -->
<g id="edge1221" class="edge">
<title>gpu3_layer12_qkv&#45;&gt;gpu3_layer12_reshape</title>
<path fill="none" stroke="black" d="M2135,-5612.53C2135,-5604.24 2135,-5594.85 2135,-5585.94"/>
<polygon fill="black" stroke="black" points="2138.5,-5585.8 2135,-5575.8 2131.5,-5585.8 2138.5,-5585.8"/>
</g>
<!-- gpu3_layer12_attn -->
<g id="node979" class="node">
<title>gpu3_layer12_attn</title>
<polygon fill="lightblue" stroke="black" points="2199,-5486.7 2071,-5486.7 2071,-5434.7 2199,-5434.7 2199,-5486.7"/>
<text text-anchor="middle" x="2135" y="-5474.7" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2135" y="-5463.7" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-5452.7" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-5441.7" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer12_reshape&#45;&gt;gpu3_layer12_attn -->
<g id="edge1222" class="edge">
<title>gpu3_layer12_reshape&#45;&gt;gpu3_layer12_attn</title>
<path fill="none" stroke="black" d="M2135,-5523.53C2135,-5515.24 2135,-5505.85 2135,-5496.94"/>
<polygon fill="black" stroke="black" points="2138.5,-5496.8 2135,-5486.8 2131.5,-5496.8 2138.5,-5496.8"/>
</g>
<!-- gpu3_layer12_attn_reshape -->
<g id="node981" class="node">
<title>gpu3_layer12_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2196,-5397.7 2074,-5397.7 2074,-5345.7 2196,-5345.7 2196,-5397.7"/>
<text text-anchor="middle" x="2135" y="-5385.7" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2135" y="-5374.7" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-5363.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-5352.7" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer12_attn&#45;&gt;gpu3_layer12_attn_reshape -->
<g id="edge1223" class="edge">
<title>gpu3_layer12_attn&#45;&gt;gpu3_layer12_attn_reshape</title>
<path fill="none" stroke="black" d="M2135,-5434.53C2135,-5426.24 2135,-5416.85 2135,-5407.94"/>
<polygon fill="black" stroke="black" points="2138.5,-5407.8 2135,-5397.8 2131.5,-5407.8 2138.5,-5407.8"/>
</g>
<!-- gpu3_layer12_attn_out -->
<g id="node980" class="node">
<title>gpu3_layer12_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2196,-5308.7 2074,-5308.7 2074,-5256.7 2196,-5256.7 2196,-5308.7"/>
<text text-anchor="middle" x="2135" y="-5296.7" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2135" y="-5285.7" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-5274.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-5263.7" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer12_kv_update -->
<g id="node982" class="node">
<title>gpu3_layer12_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2135" cy="-5182.93" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2135" y="-5196.93" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2135" y="-5185.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-5174.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-5163.93" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer12_attn_out&#45;&gt;gpu3_layer12_kv_update -->
<g id="edge1225" class="edge">
<title>gpu3_layer12_attn_out&#45;&gt;gpu3_layer12_kv_update</title>
<path fill="none" stroke="black" d="M2135,-5256.52C2135,-5248.38 2135,-5239.08 2135,-5229.92"/>
<polygon fill="black" stroke="black" points="2138.5,-5229.71 2135,-5219.71 2131.5,-5229.71 2138.5,-5229.71"/>
</g>
<!-- gpu3_layer12_attn_reshape&#45;&gt;gpu3_layer12_attn_out -->
<g id="edge1224" class="edge">
<title>gpu3_layer12_attn_reshape&#45;&gt;gpu3_layer12_attn_out</title>
<path fill="none" stroke="black" d="M2135,-5345.53C2135,-5337.24 2135,-5327.85 2135,-5318.94"/>
<polygon fill="black" stroke="black" points="2138.5,-5318.8 2135,-5308.8 2131.5,-5318.8 2138.5,-5318.8"/>
</g>
<!-- gpu3_layer12_res1 -->
<g id="node983" class="node">
<title>gpu3_layer12_res1</title>
<polygon fill="lightblue" stroke="black" points="2196,-5109.16 2074,-5109.16 2074,-5057.16 2196,-5057.16 2196,-5109.16"/>
<text text-anchor="middle" x="2135" y="-5097.16" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2135" y="-5086.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-5075.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-5064.16" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer12_kv_update&#45;&gt;gpu3_layer12_res1 -->
<g id="edge1226" class="edge">
<title>gpu3_layer12_kv_update&#45;&gt;gpu3_layer12_res1</title>
<path fill="none" stroke="black" d="M2135,-5146.08C2135,-5137.4 2135,-5128.13 2135,-5119.47"/>
<polygon fill="black" stroke="black" points="2138.5,-5119.3 2135,-5109.3 2131.5,-5119.3 2138.5,-5119.3"/>
</g>
<!-- gpu3_layer12_ln2 -->
<g id="node984" class="node">
<title>gpu3_layer12_ln2</title>
<polygon fill="lightblue" stroke="black" points="2196,-5020.16 2074,-5020.16 2074,-4968.16 2196,-4968.16 2196,-5020.16"/>
<text text-anchor="middle" x="2135" y="-5008.16" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2135" y="-4997.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-4986.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-4975.16" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer12_res1&#45;&gt;gpu3_layer12_ln2 -->
<g id="edge1227" class="edge">
<title>gpu3_layer12_res1&#45;&gt;gpu3_layer12_ln2</title>
<path fill="none" stroke="black" d="M2135,-5056.99C2135,-5048.7 2135,-5039.31 2135,-5030.4"/>
<polygon fill="black" stroke="black" points="2138.5,-5030.26 2135,-5020.26 2131.5,-5030.26 2138.5,-5030.26"/>
</g>
<!-- gpu3_layer12_routing -->
<g id="node985" class="node">
<title>gpu3_layer12_routing</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-4931.16 2060.29,-4931.16 2008.53,-4805.16 2209.71,-4805.16 2261.47,-4931.16"/>
<text text-anchor="middle" x="2135" y="-4887.66" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2135" y="-4876.66" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-4865.66" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-4854.66" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2135" y="-4843.66" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer12_ln2&#45;&gt;gpu3_layer12_routing -->
<g id="edge1228" class="edge">
<title>gpu3_layer12_ln2&#45;&gt;gpu3_layer12_routing</title>
<path fill="none" stroke="black" d="M2135,-4968.06C2135,-4960.13 2135,-4950.93 2135,-4941.4"/>
<polygon fill="black" stroke="black" points="2138.5,-4941.39 2135,-4931.39 2131.5,-4941.39 2138.5,-4941.39"/>
</g>
<!-- gpu3_layer12_expert0 -->
<g id="node986" class="node">
<title>gpu3_layer12_expert0</title>
<polygon fill="lightblue" stroke="black" points="1916,-4759.16 1794,-4759.16 1794,-4707.16 1916,-4707.16 1916,-4759.16"/>
<text text-anchor="middle" x="1855" y="-4747.16" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1855" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer12_routing&#45;&gt;gpu3_layer12_expert0 -->
<g id="edge1215" class="edge">
<title>gpu3_layer12_routing&#45;&gt;gpu3_layer12_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2009.33,-4807.46C1977.34,-4792.27 1944.34,-4776.59 1917.11,-4763.66"/>
<polygon fill="black" stroke="black" points="1918.26,-4760.33 1907.73,-4759.2 1915.26,-4766.65 1918.26,-4760.33"/>
<text text-anchor="middle" x="1991.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer12_expert1 -->
<g id="node987" class="node">
<title>gpu3_layer12_expert1</title>
<polygon fill="lightblue" stroke="black" points="2056,-4759.16 1934,-4759.16 1934,-4707.16 2056,-4707.16 2056,-4759.16"/>
<text text-anchor="middle" x="1995" y="-4747.16" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1995" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer12_routing&#45;&gt;gpu3_layer12_expert1 -->
<g id="edge1216" class="edge">
<title>gpu3_layer12_routing&#45;&gt;gpu3_layer12_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2069.51,-4804.94C2055.48,-4791.62 2041.21,-4778.06 2028.97,-4766.43"/>
<polygon fill="black" stroke="black" points="2031.29,-4763.8 2021.63,-4759.45 2026.46,-4768.88 2031.29,-4763.8"/>
<text text-anchor="middle" x="2078.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer12_expert2 -->
<g id="node988" class="node">
<title>gpu3_layer12_expert2</title>
<polygon fill="lightblue" stroke="black" points="2196,-4759.16 2074,-4759.16 2074,-4707.16 2196,-4707.16 2196,-4759.16"/>
<text text-anchor="middle" x="2135" y="-4747.16" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2135" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer12_routing&#45;&gt;gpu3_layer12_expert2 -->
<g id="edge1217" class="edge">
<title>gpu3_layer12_routing&#45;&gt;gpu3_layer12_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2135,-4804.94C2135,-4792.87 2135,-4780.62 2135,-4769.77"/>
<polygon fill="black" stroke="black" points="2138.5,-4769.45 2135,-4759.45 2131.5,-4769.45 2138.5,-4769.45"/>
<text text-anchor="middle" x="2164.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer12_expert3 -->
<g id="node989" class="node">
<title>gpu3_layer12_expert3</title>
<polygon fill="lightblue" stroke="black" points="2336,-4759.16 2214,-4759.16 2214,-4707.16 2336,-4707.16 2336,-4759.16"/>
<text text-anchor="middle" x="2275" y="-4747.16" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2275" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer12_routing&#45;&gt;gpu3_layer12_expert3 -->
<g id="edge1218" class="edge">
<title>gpu3_layer12_routing&#45;&gt;gpu3_layer12_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2200.49,-4804.94C2214.52,-4791.62 2228.79,-4778.06 2241.03,-4766.43"/>
<polygon fill="black" stroke="black" points="2243.54,-4768.88 2248.37,-4759.45 2238.71,-4763.8 2243.54,-4768.88"/>
<text text-anchor="middle" x="2259.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer12_expert_agg -->
<g id="node990" class="node">
<title>gpu3_layer12_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-4670.16 2060.29,-4670.16 2008.53,-4566.16 2209.71,-4566.16 2261.47,-4670.16"/>
<text text-anchor="middle" x="2135" y="-4632.16" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2135" y="-4621.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-4610.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-4599.16" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer12_routing&#45;&gt;gpu3_layer12_expert_agg -->
<g id="edge1233" class="edge">
<title>gpu3_layer12_routing&#45;&gt;gpu3_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M2224.22,-4840.24C2297.96,-4813.08 2384.6,-4766.69 2345,-4707.16 2324.44,-4676.24 2290.7,-4656.17 2256.22,-4643.14"/>
<polygon fill="black" stroke="black" points="2257.08,-4639.73 2246.48,-4639.65 2254.71,-4646.32 2257.08,-4639.73"/>
</g>
<!-- gpu3_layer12_expert0&#45;&gt;gpu3_layer12_expert_agg -->
<g id="edge1229" class="edge">
<title>gpu3_layer12_expert0&#45;&gt;gpu3_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M1916.1,-4707.5C1952.98,-4692.62 2000.7,-4673.36 2042.16,-4656.62"/>
<polygon fill="black" stroke="black" points="2043.5,-4659.86 2051.46,-4652.87 2040.88,-4653.37 2043.5,-4659.86"/>
</g>
<!-- gpu3_layer12_expert1&#45;&gt;gpu3_layer12_expert_agg -->
<g id="edge1230" class="edge">
<title>gpu3_layer12_expert1&#45;&gt;gpu3_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M2026.07,-4707.08C2037.32,-4698 2050.53,-4687.34 2063.8,-4676.63"/>
<polygon fill="black" stroke="black" points="2066.02,-4679.33 2071.6,-4670.33 2061.62,-4673.89 2066.02,-4679.33"/>
</g>
<!-- gpu3_layer12_expert2&#45;&gt;gpu3_layer12_expert_agg -->
<g id="edge1231" class="edge">
<title>gpu3_layer12_expert2&#45;&gt;gpu3_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M2135,-4707.08C2135,-4699.15 2135,-4690.02 2135,-4680.69"/>
<polygon fill="black" stroke="black" points="2138.5,-4680.56 2135,-4670.56 2131.5,-4680.56 2138.5,-4680.56"/>
</g>
<!-- gpu3_layer12_expert3&#45;&gt;gpu3_layer12_expert_agg -->
<g id="edge1232" class="edge">
<title>gpu3_layer12_expert3&#45;&gt;gpu3_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M2243.93,-4707.08C2232.68,-4698 2219.47,-4687.34 2206.2,-4676.63"/>
<polygon fill="black" stroke="black" points="2208.38,-4673.89 2198.4,-4670.33 2203.98,-4679.33 2208.38,-4673.89"/>
</g>
<!-- gpu3_layer12_res2 -->
<g id="node991" class="node">
<title>gpu3_layer12_res2</title>
<polygon fill="lightblue" stroke="black" points="2196,-4529.16 2074,-4529.16 2074,-4477.16 2196,-4477.16 2196,-4529.16"/>
<text text-anchor="middle" x="2135" y="-4517.16" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2135" y="-4506.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-4495.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-4484.16" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer12_expert_agg&#45;&gt;gpu3_layer12_res2 -->
<g id="edge1234" class="edge">
<title>gpu3_layer12_expert_agg&#45;&gt;gpu3_layer12_res2</title>
<path fill="none" stroke="black" d="M2135,-4565.95C2135,-4557 2135,-4547.87 2135,-4539.47"/>
<polygon fill="black" stroke="black" points="2138.5,-4539.29 2135,-4529.29 2131.5,-4539.29 2138.5,-4539.29"/>
</g>
<!-- gpu3_layer13_ln1 -->
<g id="node992" class="node">
<title>gpu3_layer13_ln1</title>
<polygon fill="lightblue" stroke="black" points="2196,-4440.16 2074,-4440.16 2074,-4388.16 2196,-4388.16 2196,-4440.16"/>
<text text-anchor="middle" x="2135" y="-4428.16" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2135" y="-4417.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-4406.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-4395.16" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer12_res2&#45;&gt;gpu3_layer13_ln1 -->
<g id="edge1239" class="edge">
<title>gpu3_layer12_res2&#45;&gt;gpu3_layer13_ln1</title>
<path fill="none" stroke="black" d="M2135,-4476.99C2135,-4468.7 2135,-4459.31 2135,-4450.4"/>
<polygon fill="black" stroke="black" points="2138.5,-4450.26 2135,-4440.26 2131.5,-4450.26 2138.5,-4450.26"/>
</g>
<!-- gpu3_layer13_qkv -->
<g id="node993" class="node">
<title>gpu3_layer13_qkv</title>
<polygon fill="lightblue" stroke="black" points="2196,-4351.16 2074,-4351.16 2074,-4299.16 2196,-4299.16 2196,-4351.16"/>
<text text-anchor="middle" x="2135" y="-4339.16" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2135" y="-4328.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-4317.16" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-4306.16" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer13_ln1&#45;&gt;gpu3_layer13_qkv -->
<g id="edge1240" class="edge">
<title>gpu3_layer13_ln1&#45;&gt;gpu3_layer13_qkv</title>
<path fill="none" stroke="black" d="M2135,-4387.99C2135,-4379.7 2135,-4370.31 2135,-4361.4"/>
<polygon fill="black" stroke="black" points="2138.5,-4361.26 2135,-4351.26 2131.5,-4361.26 2138.5,-4361.26"/>
</g>
<!-- gpu3_layer13_reshape -->
<g id="node994" class="node">
<title>gpu3_layer13_reshape</title>
<polygon fill="lightblue" stroke="black" points="2199,-4262.16 2071,-4262.16 2071,-4210.16 2199,-4210.16 2199,-4262.16"/>
<text text-anchor="middle" x="2135" y="-4250.16" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2135" y="-4239.16" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-4228.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-4217.16" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer13_qkv&#45;&gt;gpu3_layer13_reshape -->
<g id="edge1241" class="edge">
<title>gpu3_layer13_qkv&#45;&gt;gpu3_layer13_reshape</title>
<path fill="none" stroke="black" d="M2135,-4298.99C2135,-4290.7 2135,-4281.31 2135,-4272.4"/>
<polygon fill="black" stroke="black" points="2138.5,-4272.26 2135,-4262.26 2131.5,-4272.26 2138.5,-4272.26"/>
</g>
<!-- gpu3_layer13_attn -->
<g id="node995" class="node">
<title>gpu3_layer13_attn</title>
<polygon fill="lightblue" stroke="black" points="2199,-4173.16 2071,-4173.16 2071,-4121.16 2199,-4121.16 2199,-4173.16"/>
<text text-anchor="middle" x="2135" y="-4161.16" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2135" y="-4150.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-4139.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-4128.16" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer13_reshape&#45;&gt;gpu3_layer13_attn -->
<g id="edge1242" class="edge">
<title>gpu3_layer13_reshape&#45;&gt;gpu3_layer13_attn</title>
<path fill="none" stroke="black" d="M2135,-4209.99C2135,-4201.7 2135,-4192.31 2135,-4183.4"/>
<polygon fill="black" stroke="black" points="2138.5,-4183.26 2135,-4173.26 2131.5,-4183.26 2138.5,-4183.26"/>
</g>
<!-- gpu3_layer13_attn_reshape -->
<g id="node997" class="node">
<title>gpu3_layer13_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2196,-4084.16 2074,-4084.16 2074,-4032.16 2196,-4032.16 2196,-4084.16"/>
<text text-anchor="middle" x="2135" y="-4072.16" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2135" y="-4061.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-4050.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-4039.16" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer13_attn&#45;&gt;gpu3_layer13_attn_reshape -->
<g id="edge1243" class="edge">
<title>gpu3_layer13_attn&#45;&gt;gpu3_layer13_attn_reshape</title>
<path fill="none" stroke="black" d="M2135,-4120.99C2135,-4112.7 2135,-4103.31 2135,-4094.4"/>
<polygon fill="black" stroke="black" points="2138.5,-4094.26 2135,-4084.26 2131.5,-4094.26 2138.5,-4094.26"/>
</g>
<!-- gpu3_layer13_attn_out -->
<g id="node996" class="node">
<title>gpu3_layer13_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2196,-3995.16 2074,-3995.16 2074,-3943.16 2196,-3943.16 2196,-3995.16"/>
<text text-anchor="middle" x="2135" y="-3983.16" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2135" y="-3972.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-3961.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-3950.16" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer13_kv_update -->
<g id="node998" class="node">
<title>gpu3_layer13_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2135" cy="-3869.39" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2135" y="-3883.39" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2135" y="-3872.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-3861.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-3850.39" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer13_attn_out&#45;&gt;gpu3_layer13_kv_update -->
<g id="edge1245" class="edge">
<title>gpu3_layer13_attn_out&#45;&gt;gpu3_layer13_kv_update</title>
<path fill="none" stroke="black" d="M2135,-3942.98C2135,-3934.84 2135,-3925.54 2135,-3916.38"/>
<polygon fill="black" stroke="black" points="2138.5,-3916.17 2135,-3906.17 2131.5,-3916.17 2138.5,-3916.17"/>
</g>
<!-- gpu3_layer13_attn_reshape&#45;&gt;gpu3_layer13_attn_out -->
<g id="edge1244" class="edge">
<title>gpu3_layer13_attn_reshape&#45;&gt;gpu3_layer13_attn_out</title>
<path fill="none" stroke="black" d="M2135,-4031.99C2135,-4023.7 2135,-4014.31 2135,-4005.4"/>
<polygon fill="black" stroke="black" points="2138.5,-4005.26 2135,-3995.26 2131.5,-4005.26 2138.5,-4005.26"/>
</g>
<!-- gpu3_layer13_res1 -->
<g id="node999" class="node">
<title>gpu3_layer13_res1</title>
<polygon fill="lightblue" stroke="black" points="2196,-3795.62 2074,-3795.62 2074,-3743.62 2196,-3743.62 2196,-3795.62"/>
<text text-anchor="middle" x="2135" y="-3783.62" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2135" y="-3772.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-3761.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-3750.62" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer13_kv_update&#45;&gt;gpu3_layer13_res1 -->
<g id="edge1246" class="edge">
<title>gpu3_layer13_kv_update&#45;&gt;gpu3_layer13_res1</title>
<path fill="none" stroke="black" d="M2135,-3832.54C2135,-3823.86 2135,-3814.59 2135,-3805.93"/>
<polygon fill="black" stroke="black" points="2138.5,-3805.76 2135,-3795.76 2131.5,-3805.76 2138.5,-3805.76"/>
</g>
<!-- gpu3_layer13_ln2 -->
<g id="node1000" class="node">
<title>gpu3_layer13_ln2</title>
<polygon fill="lightblue" stroke="black" points="2196,-3706.62 2074,-3706.62 2074,-3654.62 2196,-3654.62 2196,-3706.62"/>
<text text-anchor="middle" x="2135" y="-3694.62" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2135" y="-3683.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-3672.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-3661.62" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer13_res1&#45;&gt;gpu3_layer13_ln2 -->
<g id="edge1247" class="edge">
<title>gpu3_layer13_res1&#45;&gt;gpu3_layer13_ln2</title>
<path fill="none" stroke="black" d="M2135,-3743.45C2135,-3735.16 2135,-3725.77 2135,-3716.87"/>
<polygon fill="black" stroke="black" points="2138.5,-3716.72 2135,-3706.72 2131.5,-3716.72 2138.5,-3716.72"/>
</g>
<!-- gpu3_layer13_routing -->
<g id="node1001" class="node">
<title>gpu3_layer13_routing</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-3617.62 2060.29,-3617.62 2008.53,-3491.62 2209.71,-3491.62 2261.47,-3617.62"/>
<text text-anchor="middle" x="2135" y="-3574.12" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2135" y="-3563.12" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-3552.12" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-3541.12" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2135" y="-3530.12" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer13_ln2&#45;&gt;gpu3_layer13_routing -->
<g id="edge1248" class="edge">
<title>gpu3_layer13_ln2&#45;&gt;gpu3_layer13_routing</title>
<path fill="none" stroke="black" d="M2135,-3654.52C2135,-3646.59 2135,-3637.4 2135,-3627.87"/>
<polygon fill="black" stroke="black" points="2138.5,-3627.85 2135,-3617.85 2131.5,-3627.85 2138.5,-3627.85"/>
</g>
<!-- gpu3_layer13_expert0 -->
<g id="node1002" class="node">
<title>gpu3_layer13_expert0</title>
<polygon fill="lightblue" stroke="black" points="1916,-3445.62 1794,-3445.62 1794,-3393.62 1916,-3393.62 1916,-3445.62"/>
<text text-anchor="middle" x="1855" y="-3433.62" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1855" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer13_routing&#45;&gt;gpu3_layer13_expert0 -->
<g id="edge1235" class="edge">
<title>gpu3_layer13_routing&#45;&gt;gpu3_layer13_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2009.33,-3493.93C1977.34,-3478.73 1944.34,-3463.05 1917.11,-3450.12"/>
<polygon fill="black" stroke="black" points="1918.26,-3446.79 1907.73,-3445.66 1915.26,-3453.11 1918.26,-3446.79"/>
<text text-anchor="middle" x="1991.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer13_expert1 -->
<g id="node1003" class="node">
<title>gpu3_layer13_expert1</title>
<polygon fill="lightblue" stroke="black" points="2056,-3445.62 1934,-3445.62 1934,-3393.62 2056,-3393.62 2056,-3445.62"/>
<text text-anchor="middle" x="1995" y="-3433.62" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1995" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer13_routing&#45;&gt;gpu3_layer13_expert1 -->
<g id="edge1236" class="edge">
<title>gpu3_layer13_routing&#45;&gt;gpu3_layer13_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2069.51,-3491.4C2055.48,-3478.08 2041.21,-3464.52 2028.97,-3452.89"/>
<polygon fill="black" stroke="black" points="2031.29,-3450.26 2021.63,-3445.91 2026.46,-3455.34 2031.29,-3450.26"/>
<text text-anchor="middle" x="2078.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer13_expert2 -->
<g id="node1004" class="node">
<title>gpu3_layer13_expert2</title>
<polygon fill="lightblue" stroke="black" points="2196,-3445.62 2074,-3445.62 2074,-3393.62 2196,-3393.62 2196,-3445.62"/>
<text text-anchor="middle" x="2135" y="-3433.62" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2135" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer13_routing&#45;&gt;gpu3_layer13_expert2 -->
<g id="edge1237" class="edge">
<title>gpu3_layer13_routing&#45;&gt;gpu3_layer13_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2135,-3491.4C2135,-3479.33 2135,-3467.08 2135,-3456.23"/>
<polygon fill="black" stroke="black" points="2138.5,-3455.91 2135,-3445.91 2131.5,-3455.91 2138.5,-3455.91"/>
<text text-anchor="middle" x="2164.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer13_expert3 -->
<g id="node1005" class="node">
<title>gpu3_layer13_expert3</title>
<polygon fill="lightblue" stroke="black" points="2336,-3445.62 2214,-3445.62 2214,-3393.62 2336,-3393.62 2336,-3445.62"/>
<text text-anchor="middle" x="2275" y="-3433.62" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2275" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer13_routing&#45;&gt;gpu3_layer13_expert3 -->
<g id="edge1238" class="edge">
<title>gpu3_layer13_routing&#45;&gt;gpu3_layer13_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2200.49,-3491.4C2214.52,-3478.08 2228.79,-3464.52 2241.03,-3452.89"/>
<polygon fill="black" stroke="black" points="2243.54,-3455.34 2248.37,-3445.91 2238.71,-3450.26 2243.54,-3455.34"/>
<text text-anchor="middle" x="2259.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer13_expert_agg -->
<g id="node1006" class="node">
<title>gpu3_layer13_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-3356.62 2060.29,-3356.62 2008.53,-3252.62 2209.71,-3252.62 2261.47,-3356.62"/>
<text text-anchor="middle" x="2135" y="-3318.62" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2135" y="-3307.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-3296.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-3285.62" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer13_routing&#45;&gt;gpu3_layer13_expert_agg -->
<g id="edge1253" class="edge">
<title>gpu3_layer13_routing&#45;&gt;gpu3_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M2224.22,-3526.7C2297.96,-3499.54 2384.6,-3453.15 2345,-3393.62 2324.44,-3362.71 2290.7,-3342.63 2256.22,-3329.6"/>
<polygon fill="black" stroke="black" points="2257.08,-3326.19 2246.48,-3326.11 2254.71,-3332.78 2257.08,-3326.19"/>
</g>
<!-- gpu3_layer13_expert0&#45;&gt;gpu3_layer13_expert_agg -->
<g id="edge1249" class="edge">
<title>gpu3_layer13_expert0&#45;&gt;gpu3_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M1916.1,-3393.96C1952.98,-3379.08 2000.7,-3359.82 2042.16,-3343.08"/>
<polygon fill="black" stroke="black" points="2043.5,-3346.32 2051.46,-3339.33 2040.88,-3339.83 2043.5,-3346.32"/>
</g>
<!-- gpu3_layer13_expert1&#45;&gt;gpu3_layer13_expert_agg -->
<g id="edge1250" class="edge">
<title>gpu3_layer13_expert1&#45;&gt;gpu3_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M2026.07,-3393.54C2037.32,-3384.46 2050.53,-3373.8 2063.8,-3363.09"/>
<polygon fill="black" stroke="black" points="2066.02,-3365.79 2071.6,-3356.79 2061.62,-3360.35 2066.02,-3365.79"/>
</g>
<!-- gpu3_layer13_expert2&#45;&gt;gpu3_layer13_expert_agg -->
<g id="edge1251" class="edge">
<title>gpu3_layer13_expert2&#45;&gt;gpu3_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M2135,-3393.54C2135,-3385.61 2135,-3376.48 2135,-3367.16"/>
<polygon fill="black" stroke="black" points="2138.5,-3367.02 2135,-3357.02 2131.5,-3367.02 2138.5,-3367.02"/>
</g>
<!-- gpu3_layer13_expert3&#45;&gt;gpu3_layer13_expert_agg -->
<g id="edge1252" class="edge">
<title>gpu3_layer13_expert3&#45;&gt;gpu3_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M2243.93,-3393.54C2232.68,-3384.46 2219.47,-3373.8 2206.2,-3363.09"/>
<polygon fill="black" stroke="black" points="2208.38,-3360.35 2198.4,-3356.79 2203.98,-3365.79 2208.38,-3360.35"/>
</g>
<!-- gpu3_layer13_res2 -->
<g id="node1007" class="node">
<title>gpu3_layer13_res2</title>
<polygon fill="lightblue" stroke="black" points="2196,-3215.62 2074,-3215.62 2074,-3163.62 2196,-3163.62 2196,-3215.62"/>
<text text-anchor="middle" x="2135" y="-3203.62" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2135" y="-3192.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-3181.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-3170.62" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer13_expert_agg&#45;&gt;gpu3_layer13_res2 -->
<g id="edge1254" class="edge">
<title>gpu3_layer13_expert_agg&#45;&gt;gpu3_layer13_res2</title>
<path fill="none" stroke="black" d="M2135,-3252.41C2135,-3243.46 2135,-3234.33 2135,-3225.93"/>
<polygon fill="black" stroke="black" points="2138.5,-3225.75 2135,-3215.75 2131.5,-3225.75 2138.5,-3225.75"/>
</g>
<!-- gpu3_layer14_ln1 -->
<g id="node1008" class="node">
<title>gpu3_layer14_ln1</title>
<polygon fill="lightblue" stroke="black" points="2196,-3126.62 2074,-3126.62 2074,-3074.62 2196,-3074.62 2196,-3126.62"/>
<text text-anchor="middle" x="2135" y="-3114.62" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2135" y="-3103.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-3092.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-3081.62" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer13_res2&#45;&gt;gpu3_layer14_ln1 -->
<g id="edge1259" class="edge">
<title>gpu3_layer13_res2&#45;&gt;gpu3_layer14_ln1</title>
<path fill="none" stroke="black" d="M2135,-3163.45C2135,-3155.16 2135,-3145.77 2135,-3136.87"/>
<polygon fill="black" stroke="black" points="2138.5,-3136.72 2135,-3126.72 2131.5,-3136.72 2138.5,-3136.72"/>
</g>
<!-- gpu3_layer14_qkv -->
<g id="node1009" class="node">
<title>gpu3_layer14_qkv</title>
<polygon fill="lightblue" stroke="black" points="2196,-3037.62 2074,-3037.62 2074,-2985.62 2196,-2985.62 2196,-3037.62"/>
<text text-anchor="middle" x="2135" y="-3025.62" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2135" y="-3014.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-3003.62" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-2992.62" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer14_ln1&#45;&gt;gpu3_layer14_qkv -->
<g id="edge1260" class="edge">
<title>gpu3_layer14_ln1&#45;&gt;gpu3_layer14_qkv</title>
<path fill="none" stroke="black" d="M2135,-3074.45C2135,-3066.16 2135,-3056.77 2135,-3047.87"/>
<polygon fill="black" stroke="black" points="2138.5,-3047.72 2135,-3037.72 2131.5,-3047.72 2138.5,-3047.72"/>
</g>
<!-- gpu3_layer14_reshape -->
<g id="node1010" class="node">
<title>gpu3_layer14_reshape</title>
<polygon fill="lightblue" stroke="black" points="2199,-2948.62 2071,-2948.62 2071,-2896.62 2199,-2896.62 2199,-2948.62"/>
<text text-anchor="middle" x="2135" y="-2936.62" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2135" y="-2925.62" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-2914.62" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-2903.62" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer14_qkv&#45;&gt;gpu3_layer14_reshape -->
<g id="edge1261" class="edge">
<title>gpu3_layer14_qkv&#45;&gt;gpu3_layer14_reshape</title>
<path fill="none" stroke="black" d="M2135,-2985.45C2135,-2977.16 2135,-2967.77 2135,-2958.87"/>
<polygon fill="black" stroke="black" points="2138.5,-2958.72 2135,-2948.72 2131.5,-2958.72 2138.5,-2958.72"/>
</g>
<!-- gpu3_layer14_attn -->
<g id="node1011" class="node">
<title>gpu3_layer14_attn</title>
<polygon fill="lightblue" stroke="black" points="2199,-2859.62 2071,-2859.62 2071,-2807.62 2199,-2807.62 2199,-2859.62"/>
<text text-anchor="middle" x="2135" y="-2847.62" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2135" y="-2836.62" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-2825.62" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-2814.62" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer14_reshape&#45;&gt;gpu3_layer14_attn -->
<g id="edge1262" class="edge">
<title>gpu3_layer14_reshape&#45;&gt;gpu3_layer14_attn</title>
<path fill="none" stroke="black" d="M2135,-2896.45C2135,-2888.16 2135,-2878.77 2135,-2869.87"/>
<polygon fill="black" stroke="black" points="2138.5,-2869.72 2135,-2859.72 2131.5,-2869.72 2138.5,-2869.72"/>
</g>
<!-- gpu3_layer14_attn_reshape -->
<g id="node1013" class="node">
<title>gpu3_layer14_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2196,-2770.62 2074,-2770.62 2074,-2718.62 2196,-2718.62 2196,-2770.62"/>
<text text-anchor="middle" x="2135" y="-2758.62" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2135" y="-2747.62" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-2736.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-2725.62" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer14_attn&#45;&gt;gpu3_layer14_attn_reshape -->
<g id="edge1263" class="edge">
<title>gpu3_layer14_attn&#45;&gt;gpu3_layer14_attn_reshape</title>
<path fill="none" stroke="black" d="M2135,-2807.45C2135,-2799.16 2135,-2789.77 2135,-2780.87"/>
<polygon fill="black" stroke="black" points="2138.5,-2780.72 2135,-2770.72 2131.5,-2780.72 2138.5,-2780.72"/>
</g>
<!-- gpu3_layer14_attn_out -->
<g id="node1012" class="node">
<title>gpu3_layer14_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2196,-2681.62 2074,-2681.62 2074,-2629.62 2196,-2629.62 2196,-2681.62"/>
<text text-anchor="middle" x="2135" y="-2669.62" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2135" y="-2658.62" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-2647.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-2636.62" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer14_kv_update -->
<g id="node1014" class="node">
<title>gpu3_layer14_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2135" cy="-2555.85" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2135" y="-2569.85" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2135" y="-2558.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-2547.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-2536.85" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer14_attn_out&#45;&gt;gpu3_layer14_kv_update -->
<g id="edge1265" class="edge">
<title>gpu3_layer14_attn_out&#45;&gt;gpu3_layer14_kv_update</title>
<path fill="none" stroke="black" d="M2135,-2629.44C2135,-2621.3 2135,-2612 2135,-2602.84"/>
<polygon fill="black" stroke="black" points="2138.5,-2602.63 2135,-2592.63 2131.5,-2602.63 2138.5,-2602.63"/>
</g>
<!-- gpu3_layer14_attn_reshape&#45;&gt;gpu3_layer14_attn_out -->
<g id="edge1264" class="edge">
<title>gpu3_layer14_attn_reshape&#45;&gt;gpu3_layer14_attn_out</title>
<path fill="none" stroke="black" d="M2135,-2718.45C2135,-2710.16 2135,-2700.77 2135,-2691.87"/>
<polygon fill="black" stroke="black" points="2138.5,-2691.72 2135,-2681.72 2131.5,-2691.72 2138.5,-2691.72"/>
</g>
<!-- gpu3_layer14_res1 -->
<g id="node1015" class="node">
<title>gpu3_layer14_res1</title>
<polygon fill="lightblue" stroke="black" points="2196,-2482.08 2074,-2482.08 2074,-2430.08 2196,-2430.08 2196,-2482.08"/>
<text text-anchor="middle" x="2135" y="-2470.08" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2135" y="-2459.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-2448.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-2437.08" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer14_kv_update&#45;&gt;gpu3_layer14_res1 -->
<g id="edge1266" class="edge">
<title>gpu3_layer14_kv_update&#45;&gt;gpu3_layer14_res1</title>
<path fill="none" stroke="black" d="M2135,-2519C2135,-2510.32 2135,-2501.05 2135,-2492.39"/>
<polygon fill="black" stroke="black" points="2138.5,-2492.22 2135,-2482.22 2131.5,-2492.22 2138.5,-2492.22"/>
</g>
<!-- gpu3_layer14_ln2 -->
<g id="node1016" class="node">
<title>gpu3_layer14_ln2</title>
<polygon fill="lightblue" stroke="black" points="2196,-2393.08 2074,-2393.08 2074,-2341.08 2196,-2341.08 2196,-2393.08"/>
<text text-anchor="middle" x="2135" y="-2381.08" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2135" y="-2370.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-2359.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-2348.08" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer14_res1&#45;&gt;gpu3_layer14_ln2 -->
<g id="edge1267" class="edge">
<title>gpu3_layer14_res1&#45;&gt;gpu3_layer14_ln2</title>
<path fill="none" stroke="black" d="M2135,-2429.91C2135,-2421.62 2135,-2412.23 2135,-2403.33"/>
<polygon fill="black" stroke="black" points="2138.5,-2403.19 2135,-2393.19 2131.5,-2403.19 2138.5,-2403.19"/>
</g>
<!-- gpu3_layer14_routing -->
<g id="node1017" class="node">
<title>gpu3_layer14_routing</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-2304.08 2060.29,-2304.08 2008.53,-2178.08 2209.71,-2178.08 2261.47,-2304.08"/>
<text text-anchor="middle" x="2135" y="-2260.58" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2135" y="-2249.58" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-2238.58" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-2227.58" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2135" y="-2216.58" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer14_ln2&#45;&gt;gpu3_layer14_routing -->
<g id="edge1268" class="edge">
<title>gpu3_layer14_ln2&#45;&gt;gpu3_layer14_routing</title>
<path fill="none" stroke="black" d="M2135,-2340.98C2135,-2333.05 2135,-2323.86 2135,-2314.33"/>
<polygon fill="black" stroke="black" points="2138.5,-2314.31 2135,-2304.31 2131.5,-2314.31 2138.5,-2314.31"/>
</g>
<!-- gpu3_layer14_expert0 -->
<g id="node1018" class="node">
<title>gpu3_layer14_expert0</title>
<polygon fill="lightblue" stroke="black" points="1916,-2132.08 1794,-2132.08 1794,-2080.08 1916,-2080.08 1916,-2132.08"/>
<text text-anchor="middle" x="1855" y="-2120.08" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1855" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer14_routing&#45;&gt;gpu3_layer14_expert0 -->
<g id="edge1255" class="edge">
<title>gpu3_layer14_routing&#45;&gt;gpu3_layer14_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2009.33,-2180.39C1977.34,-2165.19 1944.34,-2149.51 1917.11,-2136.58"/>
<polygon fill="black" stroke="black" points="1918.26,-2133.25 1907.73,-2132.12 1915.26,-2139.58 1918.26,-2133.25"/>
<text text-anchor="middle" x="1991.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer14_expert1 -->
<g id="node1019" class="node">
<title>gpu3_layer14_expert1</title>
<polygon fill="lightblue" stroke="black" points="2056,-2132.08 1934,-2132.08 1934,-2080.08 2056,-2080.08 2056,-2132.08"/>
<text text-anchor="middle" x="1995" y="-2120.08" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1995" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer14_routing&#45;&gt;gpu3_layer14_expert1 -->
<g id="edge1256" class="edge">
<title>gpu3_layer14_routing&#45;&gt;gpu3_layer14_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2069.51,-2177.86C2055.48,-2164.54 2041.21,-2150.98 2028.97,-2139.35"/>
<polygon fill="black" stroke="black" points="2031.29,-2136.72 2021.63,-2132.37 2026.46,-2141.8 2031.29,-2136.72"/>
<text text-anchor="middle" x="2078.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer14_expert2 -->
<g id="node1020" class="node">
<title>gpu3_layer14_expert2</title>
<polygon fill="lightblue" stroke="black" points="2196,-2132.08 2074,-2132.08 2074,-2080.08 2196,-2080.08 2196,-2132.08"/>
<text text-anchor="middle" x="2135" y="-2120.08" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2135" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer14_routing&#45;&gt;gpu3_layer14_expert2 -->
<g id="edge1257" class="edge">
<title>gpu3_layer14_routing&#45;&gt;gpu3_layer14_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2135,-2177.86C2135,-2165.79 2135,-2153.54 2135,-2142.69"/>
<polygon fill="black" stroke="black" points="2138.5,-2142.37 2135,-2132.37 2131.5,-2142.37 2138.5,-2142.37"/>
<text text-anchor="middle" x="2164.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer14_expert3 -->
<g id="node1021" class="node">
<title>gpu3_layer14_expert3</title>
<polygon fill="lightblue" stroke="black" points="2336,-2132.08 2214,-2132.08 2214,-2080.08 2336,-2080.08 2336,-2132.08"/>
<text text-anchor="middle" x="2275" y="-2120.08" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2275" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer14_routing&#45;&gt;gpu3_layer14_expert3 -->
<g id="edge1258" class="edge">
<title>gpu3_layer14_routing&#45;&gt;gpu3_layer14_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2200.49,-2177.86C2214.52,-2164.54 2228.79,-2150.98 2241.03,-2139.35"/>
<polygon fill="black" stroke="black" points="2243.54,-2141.8 2248.37,-2132.37 2238.71,-2136.72 2243.54,-2141.8"/>
<text text-anchor="middle" x="2259.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer14_expert_agg -->
<g id="node1022" class="node">
<title>gpu3_layer14_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-2043.08 2060.29,-2043.08 2008.53,-1939.08 2209.71,-1939.08 2261.47,-2043.08"/>
<text text-anchor="middle" x="2135" y="-2005.08" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2135" y="-1994.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-1983.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-1972.08" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer14_routing&#45;&gt;gpu3_layer14_expert_agg -->
<g id="edge1273" class="edge">
<title>gpu3_layer14_routing&#45;&gt;gpu3_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M2224.22,-2213.16C2297.96,-2186 2384.6,-2139.61 2345,-2080.08 2324.44,-2049.17 2290.7,-2029.09 2256.22,-2016.06"/>
<polygon fill="black" stroke="black" points="2257.08,-2012.65 2246.48,-2012.57 2254.71,-2019.24 2257.08,-2012.65"/>
</g>
<!-- gpu3_layer14_expert0&#45;&gt;gpu3_layer14_expert_agg -->
<g id="edge1269" class="edge">
<title>gpu3_layer14_expert0&#45;&gt;gpu3_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M1916.1,-2080.42C1952.98,-2065.54 2000.7,-2046.28 2042.16,-2029.54"/>
<polygon fill="black" stroke="black" points="2043.5,-2032.78 2051.46,-2025.79 2040.88,-2026.29 2043.5,-2032.78"/>
</g>
<!-- gpu3_layer14_expert1&#45;&gt;gpu3_layer14_expert_agg -->
<g id="edge1270" class="edge">
<title>gpu3_layer14_expert1&#45;&gt;gpu3_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M2026.07,-2080C2037.32,-2070.92 2050.53,-2060.26 2063.8,-2049.55"/>
<polygon fill="black" stroke="black" points="2066.02,-2052.25 2071.6,-2043.25 2061.62,-2046.81 2066.02,-2052.25"/>
</g>
<!-- gpu3_layer14_expert2&#45;&gt;gpu3_layer14_expert_agg -->
<g id="edge1271" class="edge">
<title>gpu3_layer14_expert2&#45;&gt;gpu3_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M2135,-2080C2135,-2072.07 2135,-2062.94 2135,-2053.62"/>
<polygon fill="black" stroke="black" points="2138.5,-2053.48 2135,-2043.48 2131.5,-2053.48 2138.5,-2053.48"/>
</g>
<!-- gpu3_layer14_expert3&#45;&gt;gpu3_layer14_expert_agg -->
<g id="edge1272" class="edge">
<title>gpu3_layer14_expert3&#45;&gt;gpu3_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M2243.93,-2080C2232.68,-2070.92 2219.47,-2060.26 2206.2,-2049.55"/>
<polygon fill="black" stroke="black" points="2208.38,-2046.81 2198.4,-2043.25 2203.98,-2052.25 2208.38,-2046.81"/>
</g>
<!-- gpu3_layer14_res2 -->
<g id="node1023" class="node">
<title>gpu3_layer14_res2</title>
<polygon fill="lightblue" stroke="black" points="2196,-1902.08 2074,-1902.08 2074,-1850.08 2196,-1850.08 2196,-1902.08"/>
<text text-anchor="middle" x="2135" y="-1890.08" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2135" y="-1879.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-1868.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-1857.08" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer14_expert_agg&#45;&gt;gpu3_layer14_res2 -->
<g id="edge1274" class="edge">
<title>gpu3_layer14_expert_agg&#45;&gt;gpu3_layer14_res2</title>
<path fill="none" stroke="black" d="M2135,-1938.87C2135,-1929.92 2135,-1920.79 2135,-1912.39"/>
<polygon fill="black" stroke="black" points="2138.5,-1912.21 2135,-1902.21 2131.5,-1912.21 2138.5,-1912.21"/>
</g>
<!-- gpu3_layer15_ln1 -->
<g id="node1024" class="node">
<title>gpu3_layer15_ln1</title>
<polygon fill="lightblue" stroke="black" points="2196,-1813.08 2074,-1813.08 2074,-1761.08 2196,-1761.08 2196,-1813.08"/>
<text text-anchor="middle" x="2135" y="-1801.08" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2135" y="-1790.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-1779.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-1768.08" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer14_res2&#45;&gt;gpu3_layer15_ln1 -->
<g id="edge1279" class="edge">
<title>gpu3_layer14_res2&#45;&gt;gpu3_layer15_ln1</title>
<path fill="none" stroke="black" d="M2135,-1849.91C2135,-1841.62 2135,-1832.23 2135,-1823.33"/>
<polygon fill="black" stroke="black" points="2138.5,-1823.19 2135,-1813.19 2131.5,-1823.19 2138.5,-1823.19"/>
</g>
<!-- gpu3_layer15_qkv -->
<g id="node1025" class="node">
<title>gpu3_layer15_qkv</title>
<polygon fill="lightblue" stroke="black" points="2196,-1724.08 2074,-1724.08 2074,-1672.08 2196,-1672.08 2196,-1724.08"/>
<text text-anchor="middle" x="2135" y="-1712.08" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2135" y="-1701.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-1690.08" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-1679.08" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer15_ln1&#45;&gt;gpu3_layer15_qkv -->
<g id="edge1280" class="edge">
<title>gpu3_layer15_ln1&#45;&gt;gpu3_layer15_qkv</title>
<path fill="none" stroke="black" d="M2135,-1760.91C2135,-1752.62 2135,-1743.23 2135,-1734.33"/>
<polygon fill="black" stroke="black" points="2138.5,-1734.19 2135,-1724.19 2131.5,-1734.19 2138.5,-1734.19"/>
</g>
<!-- gpu3_layer15_reshape -->
<g id="node1026" class="node">
<title>gpu3_layer15_reshape</title>
<polygon fill="lightblue" stroke="black" points="2199,-1635.08 2071,-1635.08 2071,-1583.08 2199,-1583.08 2199,-1635.08"/>
<text text-anchor="middle" x="2135" y="-1623.08" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2135" y="-1612.08" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2135" y="-1601.08" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-1590.08" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer15_qkv&#45;&gt;gpu3_layer15_reshape -->
<g id="edge1281" class="edge">
<title>gpu3_layer15_qkv&#45;&gt;gpu3_layer15_reshape</title>
<path fill="none" stroke="black" d="M2135,-1671.91C2135,-1663.62 2135,-1654.23 2135,-1645.33"/>
<polygon fill="black" stroke="black" points="2138.5,-1645.19 2135,-1635.19 2131.5,-1645.19 2138.5,-1645.19"/>
</g>
<!-- gpu3_layer15_attn -->
<g id="node1027" class="node">
<title>gpu3_layer15_attn</title>
<polygon fill="lightblue" stroke="black" points="2199,-1546.08 2071,-1546.08 2071,-1494.08 2199,-1494.08 2199,-1546.08"/>
<text text-anchor="middle" x="2135" y="-1534.08" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2135" y="-1523.08" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-1512.08" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-1501.08" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer15_reshape&#45;&gt;gpu3_layer15_attn -->
<g id="edge1282" class="edge">
<title>gpu3_layer15_reshape&#45;&gt;gpu3_layer15_attn</title>
<path fill="none" stroke="black" d="M2135,-1582.91C2135,-1574.62 2135,-1565.23 2135,-1556.33"/>
<polygon fill="black" stroke="black" points="2138.5,-1556.19 2135,-1546.19 2131.5,-1556.19 2138.5,-1556.19"/>
</g>
<!-- gpu3_layer15_attn_reshape -->
<g id="node1029" class="node">
<title>gpu3_layer15_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2196,-1457.08 2074,-1457.08 2074,-1405.08 2196,-1405.08 2196,-1457.08"/>
<text text-anchor="middle" x="2135" y="-1445.08" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2135" y="-1434.08" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-1423.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-1412.08" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer15_attn&#45;&gt;gpu3_layer15_attn_reshape -->
<g id="edge1283" class="edge">
<title>gpu3_layer15_attn&#45;&gt;gpu3_layer15_attn_reshape</title>
<path fill="none" stroke="black" d="M2135,-1493.91C2135,-1485.62 2135,-1476.23 2135,-1467.33"/>
<polygon fill="black" stroke="black" points="2138.5,-1467.19 2135,-1457.19 2131.5,-1467.19 2138.5,-1467.19"/>
</g>
<!-- gpu3_layer15_attn_out -->
<g id="node1028" class="node">
<title>gpu3_layer15_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2196,-1368.08 2074,-1368.08 2074,-1316.08 2196,-1316.08 2196,-1368.08"/>
<text text-anchor="middle" x="2135" y="-1356.08" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2135" y="-1345.08" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2135" y="-1334.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-1323.08" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer15_kv_update -->
<g id="node1030" class="node">
<title>gpu3_layer15_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2135" cy="-1242.31" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2135" y="-1256.31" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2135" y="-1245.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-1234.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-1223.31" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer15_attn_out&#45;&gt;gpu3_layer15_kv_update -->
<g id="edge1285" class="edge">
<title>gpu3_layer15_attn_out&#45;&gt;gpu3_layer15_kv_update</title>
<path fill="none" stroke="black" d="M2135,-1315.9C2135,-1307.76 2135,-1298.46 2135,-1289.3"/>
<polygon fill="black" stroke="black" points="2138.5,-1289.09 2135,-1279.09 2131.5,-1289.09 2138.5,-1289.09"/>
</g>
<!-- gpu3_layer15_attn_reshape&#45;&gt;gpu3_layer15_attn_out -->
<g id="edge1284" class="edge">
<title>gpu3_layer15_attn_reshape&#45;&gt;gpu3_layer15_attn_out</title>
<path fill="none" stroke="black" d="M2135,-1404.91C2135,-1396.62 2135,-1387.23 2135,-1378.33"/>
<polygon fill="black" stroke="black" points="2138.5,-1378.19 2135,-1368.19 2131.5,-1378.19 2138.5,-1378.19"/>
</g>
<!-- gpu3_layer15_res1 -->
<g id="node1031" class="node">
<title>gpu3_layer15_res1</title>
<polygon fill="lightblue" stroke="black" points="2196,-1168.54 2074,-1168.54 2074,-1116.54 2196,-1116.54 2196,-1168.54"/>
<text text-anchor="middle" x="2135" y="-1156.54" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2135" y="-1145.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-1134.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-1123.54" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer15_kv_update&#45;&gt;gpu3_layer15_res1 -->
<g id="edge1286" class="edge">
<title>gpu3_layer15_kv_update&#45;&gt;gpu3_layer15_res1</title>
<path fill="none" stroke="black" d="M2135,-1205.46C2135,-1196.78 2135,-1187.51 2135,-1178.85"/>
<polygon fill="black" stroke="black" points="2138.5,-1178.69 2135,-1168.69 2131.5,-1178.69 2138.5,-1178.69"/>
</g>
<!-- gpu3_layer15_ln2 -->
<g id="node1032" class="node">
<title>gpu3_layer15_ln2</title>
<polygon fill="lightblue" stroke="black" points="2196,-1079.54 2074,-1079.54 2074,-1027.54 2196,-1027.54 2196,-1079.54"/>
<text text-anchor="middle" x="2135" y="-1067.54" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2135" y="-1056.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-1045.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-1034.54" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer15_res1&#45;&gt;gpu3_layer15_ln2 -->
<g id="edge1287" class="edge">
<title>gpu3_layer15_res1&#45;&gt;gpu3_layer15_ln2</title>
<path fill="none" stroke="black" d="M2135,-1116.38C2135,-1108.08 2135,-1098.69 2135,-1089.79"/>
<polygon fill="black" stroke="black" points="2138.5,-1089.65 2135,-1079.65 2131.5,-1089.65 2138.5,-1089.65"/>
</g>
<!-- gpu3_layer15_routing -->
<g id="node1033" class="node">
<title>gpu3_layer15_routing</title>
<polygon fill="lightyellow" stroke="black" points="2261.47,-990.54 2060.29,-990.54 2008.53,-864.54 2209.71,-864.54 2261.47,-990.54"/>
<text text-anchor="middle" x="2135" y="-947.04" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2135" y="-936.04" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-925.04" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-914.04" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2135" y="-903.04" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer15_ln2&#45;&gt;gpu3_layer15_routing -->
<g id="edge1288" class="edge">
<title>gpu3_layer15_ln2&#45;&gt;gpu3_layer15_routing</title>
<path fill="none" stroke="black" d="M2135,-1027.45C2135,-1019.51 2135,-1010.32 2135,-1000.79"/>
<polygon fill="black" stroke="black" points="2138.5,-1000.77 2135,-990.77 2131.5,-1000.77 2138.5,-1000.77"/>
</g>
<!-- gpu3_layer15_expert0 -->
<g id="node1034" class="node">
<title>gpu3_layer15_expert0</title>
<polygon fill="lightblue" stroke="black" points="1916,-818.54 1794,-818.54 1794,-766.54 1916,-766.54 1916,-818.54"/>
<text text-anchor="middle" x="1855" y="-806.54" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1855" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1855" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer15_routing&#45;&gt;gpu3_layer15_expert0 -->
<g id="edge1275" class="edge">
<title>gpu3_layer15_routing&#45;&gt;gpu3_layer15_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2009.33,-866.85C1977.34,-851.65 1944.34,-835.98 1917.11,-823.04"/>
<polygon fill="black" stroke="black" points="1918.26,-819.71 1907.73,-818.58 1915.26,-826.04 1918.26,-819.71"/>
<text text-anchor="middle" x="1991.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer15_expert1 -->
<g id="node1035" class="node">
<title>gpu3_layer15_expert1</title>
<polygon fill="lightblue" stroke="black" points="2056,-818.54 1934,-818.54 1934,-766.54 2056,-766.54 2056,-818.54"/>
<text text-anchor="middle" x="1995" y="-806.54" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1995" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="1995" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer15_routing&#45;&gt;gpu3_layer15_expert1 -->
<g id="edge1276" class="edge">
<title>gpu3_layer15_routing&#45;&gt;gpu3_layer15_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2069.51,-864.32C2055.48,-851 2041.21,-837.44 2028.97,-825.81"/>
<polygon fill="black" stroke="black" points="2031.29,-823.18 2021.63,-818.83 2026.46,-828.26 2031.29,-823.18"/>
<text text-anchor="middle" x="2078.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer15_expert2 -->
<g id="node1036" class="node">
<title>gpu3_layer15_expert2</title>
<polygon fill="lightblue" stroke="black" points="2196,-818.54 2074,-818.54 2074,-766.54 2196,-766.54 2196,-818.54"/>
<text text-anchor="middle" x="2135" y="-806.54" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2135" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2135" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer15_routing&#45;&gt;gpu3_layer15_expert2 -->
<g id="edge1277" class="edge">
<title>gpu3_layer15_routing&#45;&gt;gpu3_layer15_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2135,-864.32C2135,-852.25 2135,-840 2135,-829.15"/>
<polygon fill="black" stroke="black" points="2138.5,-828.83 2135,-818.83 2131.5,-828.83 2138.5,-828.83"/>
<text text-anchor="middle" x="2164.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer15_expert3 -->
<g id="node1037" class="node">
<title>gpu3_layer15_expert3</title>
<polygon fill="lightblue" stroke="black" points="2336,-818.54 2214,-818.54 2214,-766.54 2336,-766.54 2336,-818.54"/>
<text text-anchor="middle" x="2275" y="-806.54" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2275" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2275" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer15_routing&#45;&gt;gpu3_layer15_expert3 -->
<g id="edge1278" class="edge">
<title>gpu3_layer15_routing&#45;&gt;gpu3_layer15_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2200.49,-864.32C2214.52,-851 2228.79,-837.44 2241.03,-825.81"/>
<polygon fill="black" stroke="black" points="2243.54,-828.26 2248.37,-818.83 2238.71,-823.18 2243.54,-828.26"/>
<text text-anchor="middle" x="2259.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu3_layer15_expert_agg -->
<g id="node1038" class="node">
<title>gpu3_layer15_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2328.47,-729.54 2127.29,-729.54 2075.53,-625.54 2276.71,-625.54 2328.47,-729.54"/>
<text text-anchor="middle" x="2202" y="-691.54" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2202" y="-680.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2202" y="-669.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2202" y="-658.54" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer15_routing&#45;&gt;gpu3_layer15_expert_agg -->
<g id="edge1293" class="edge">
<title>gpu3_layer15_routing&#45;&gt;gpu3_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M2226.02,-904.14C2270.26,-888.13 2319.3,-861.57 2345,-818.54 2356.85,-798.7 2356.27,-786.71 2345,-766.54 2338.65,-755.18 2330.18,-745.11 2320.5,-736.22"/>
<polygon fill="black" stroke="black" points="2322.74,-733.54 2312.88,-729.66 2318.17,-738.84 2322.74,-733.54"/>
</g>
<!-- gpu3_layer15_expert0&#45;&gt;gpu3_layer15_expert_agg -->
<g id="edge1289" class="edge">
<title>gpu3_layer15_expert0&#45;&gt;gpu3_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M1916.04,-769.6C1919.07,-768.55 1922.07,-767.53 1925,-766.54 1984.64,-746.42 2051.92,-725.02 2105.24,-708.36"/>
<polygon fill="black" stroke="black" points="2106.53,-711.62 2115.03,-705.3 2104.44,-704.94 2106.53,-711.62"/>
</g>
<!-- gpu3_layer15_expert1&#45;&gt;gpu3_layer15_expert_agg -->
<g id="edge1290" class="edge">
<title>gpu3_layer15_expert1&#45;&gt;gpu3_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M2040.94,-766.46C2062.57,-754.65 2089.12,-740.16 2114.37,-726.38"/>
<polygon fill="black" stroke="black" points="2116.14,-729.4 2123.24,-721.53 2112.78,-723.25 2116.14,-729.4"/>
</g>
<!-- gpu3_layer15_expert2&#45;&gt;gpu3_layer15_expert_agg -->
<g id="edge1291" class="edge">
<title>gpu3_layer15_expert2&#45;&gt;gpu3_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M2149.87,-766.46C2154.82,-758.11 2160.56,-748.42 2166.4,-738.59"/>
<polygon fill="black" stroke="black" points="2169.43,-740.33 2171.52,-729.94 2163.41,-736.76 2169.43,-740.33"/>
</g>
<!-- gpu3_layer15_expert3&#45;&gt;gpu3_layer15_expert_agg -->
<g id="edge1292" class="edge">
<title>gpu3_layer15_expert3&#45;&gt;gpu3_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M2258.8,-766.46C2253.41,-758.11 2247.15,-748.42 2240.79,-738.59"/>
<polygon fill="black" stroke="black" points="2243.57,-736.44 2235.21,-729.94 2237.69,-740.24 2243.57,-736.44"/>
</g>
<!-- gpu3_layer15_res2 -->
<g id="node1039" class="node">
<title>gpu3_layer15_res2</title>
<polygon fill="lightblue" stroke="black" points="2270,-588.54 2148,-588.54 2148,-536.54 2270,-536.54 2270,-588.54"/>
<text text-anchor="middle" x="2209" y="-576.54" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2209" y="-565.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2209" y="-554.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2209" y="-543.54" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer15_expert_agg&#45;&gt;gpu3_layer15_res2 -->
<g id="edge1294" class="edge">
<title>gpu3_layer15_expert_agg&#45;&gt;gpu3_layer15_res2</title>
<path fill="none" stroke="black" d="M2205.17,-625.33C2205.73,-616.38 2206.29,-607.25 2206.81,-598.85"/>
<polygon fill="black" stroke="black" points="2210.32,-598.87 2207.44,-588.67 2203.33,-598.43 2210.32,-598.87"/>
</g>
<!-- gpu3_final_ln -->
<g id="node1040" class="node">
<title>gpu3_final_ln</title>
<polygon fill="lightblue" stroke="black" points="2280,-499.54 2158,-499.54 2158,-447.54 2280,-447.54 2280,-499.54"/>
<text text-anchor="middle" x="2219" y="-487.54" font-family="Arial" font-size="10.00">Final LayerNorm</text>
<text text-anchor="middle" x="2219" y="-476.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2219" y="-465.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2219" y="-454.54" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_layer15_res2&#45;&gt;gpu3_final_ln -->
<g id="edge1295" class="edge">
<title>gpu3_layer15_res2&#45;&gt;gpu3_final_ln</title>
<path fill="none" stroke="black" d="M2211.89,-536.38C2212.85,-528.08 2213.92,-518.69 2214.95,-509.79"/>
<polygon fill="black" stroke="black" points="2218.45,-509.98 2216.11,-499.65 2211.49,-509.18 2218.45,-509.98"/>
</g>
<!-- gpu3_output_proj -->
<g id="node1041" class="node">
<title>gpu3_output_proj</title>
<polygon fill="lightblue" stroke="black" points="2294,-410.54 2166,-410.54 2166,-358.54 2294,-358.54 2294,-410.54"/>
<text text-anchor="middle" x="2230" y="-398.54" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="2230" y="-387.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2230" y="-376.54" font-family="Arial" font-size="10.00">Output: [256, 512, 32000]</text>
<text text-anchor="middle" x="2230" y="-365.54" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_final_ln&#45;&gt;gpu3_output_proj -->
<g id="edge1296" class="edge">
<title>gpu3_final_ln&#45;&gt;gpu3_output_proj</title>
<path fill="none" stroke="black" d="M2222.18,-447.38C2223.23,-439.08 2224.42,-429.69 2225.54,-420.79"/>
<polygon fill="black" stroke="black" points="2229.04,-421.01 2226.83,-410.65 2222.1,-420.13 2229.04,-421.01"/>
</g>
<!-- gpu3_softmax -->
<g id="node1042" class="node">
<title>gpu3_softmax</title>
<polygon fill="lightblue" stroke="black" points="2359,-321.54 2231,-321.54 2231,-269.54 2359,-269.54 2359,-321.54"/>
<text text-anchor="middle" x="2295" y="-309.54" font-family="Arial" font-size="10.00">Softmax</text>
<text text-anchor="middle" x="2295" y="-298.54" font-family="Arial" font-size="10.00">Input: [256, 512, 32000]</text>
<text text-anchor="middle" x="2295" y="-287.54" font-family="Arial" font-size="10.00">Output: [256, 512, 32000]</text>
<text text-anchor="middle" x="2295" y="-276.54" font-family="Arial" font-size="10.00">GPU: GPU3</text>
</g>
<!-- gpu3_output_proj&#45;&gt;gpu3_softmax -->
<g id="edge1297" class="edge">
<title>gpu3_output_proj&#45;&gt;gpu3_softmax</title>
<path fill="none" stroke="black" d="M2248.8,-358.38C2255.47,-349.45 2263.08,-339.26 2270.18,-329.76"/>
<polygon fill="black" stroke="black" points="2273.06,-331.75 2276.24,-321.65 2267.45,-327.56 2273.06,-331.75"/>
</g>
<!-- gpu3_softmax&#45;&gt;dp_aggregate -->
<g id="edge2597" class="edge">
<title>gpu3_softmax&#45;&gt;dp_aggregate</title>
<path fill="none" stroke="black" d="M2320.49,-269.26C2331.81,-258.03 2345.65,-244.3 2359.31,-230.75"/>
<polygon fill="black" stroke="black" points="2361.78,-233.23 2366.42,-223.7 2356.85,-228.26 2361.78,-233.23"/>
<text text-anchor="middle" x="2373.5" y="-244.34" font-family="Arial" font-size="9.00">GPU 3 output</text>
</g>
<!-- gpu4_layer0_ln1 -->
<g id="node1044" class="node">
<title>gpu4_layer0_ln1</title>
<polygon fill="lightblue" stroke="black" points="2457,-21516.16 2335,-21516.16 2335,-21464.16 2457,-21464.16 2457,-21516.16"/>
<text text-anchor="middle" x="2396" y="-21504.16" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2396" y="-21493.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2396" y="-21482.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2396" y="-21471.16" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_embed&#45;&gt;gpu4_layer0_ln1 -->
<g id="edge1303" class="edge">
<title>gpu4_embed&#45;&gt;gpu4_layer0_ln1</title>
<path fill="none" stroke="black" d="M2394.58,-21553C2394.77,-21544.7 2394.98,-21535.32 2395.19,-21526.41"/>
<polygon fill="black" stroke="black" points="2398.69,-21526.35 2395.42,-21516.27 2391.69,-21526.19 2398.69,-21526.35"/>
</g>
<!-- gpu4_layer0_qkv -->
<g id="node1045" class="node">
<title>gpu4_layer0_qkv</title>
<polygon fill="lightblue" stroke="black" points="2458,-21427.16 2336,-21427.16 2336,-21375.16 2458,-21375.16 2458,-21427.16"/>
<text text-anchor="middle" x="2397" y="-21415.16" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2397" y="-21404.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2397" y="-21393.16" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2397" y="-21382.16" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer0_ln1&#45;&gt;gpu4_layer0_qkv -->
<g id="edge1304" class="edge">
<title>gpu4_layer0_ln1&#45;&gt;gpu4_layer0_qkv</title>
<path fill="none" stroke="black" d="M2396.29,-21464C2396.38,-21455.7 2396.49,-21446.32 2396.59,-21437.41"/>
<polygon fill="black" stroke="black" points="2400.1,-21437.31 2396.71,-21427.27 2393.1,-21437.23 2400.1,-21437.31"/>
</g>
<!-- gpu4_layer0_reshape -->
<g id="node1046" class="node">
<title>gpu4_layer0_reshape</title>
<polygon fill="lightblue" stroke="black" points="2462,-21338.16 2334,-21338.16 2334,-21286.16 2462,-21286.16 2462,-21338.16"/>
<text text-anchor="middle" x="2398" y="-21326.16" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2398" y="-21315.16" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2398" y="-21304.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2398" y="-21293.16" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer0_qkv&#45;&gt;gpu4_layer0_reshape -->
<g id="edge1305" class="edge">
<title>gpu4_layer0_qkv&#45;&gt;gpu4_layer0_reshape</title>
<path fill="none" stroke="black" d="M2397.29,-21375C2397.38,-21366.7 2397.49,-21357.32 2397.59,-21348.41"/>
<polygon fill="black" stroke="black" points="2401.1,-21348.31 2397.71,-21338.27 2394.1,-21348.23 2401.1,-21348.31"/>
</g>
<!-- gpu4_layer0_attn -->
<g id="node1047" class="node">
<title>gpu4_layer0_attn</title>
<polygon fill="lightblue" stroke="black" points="2462,-21249.16 2334,-21249.16 2334,-21197.16 2462,-21197.16 2462,-21249.16"/>
<text text-anchor="middle" x="2398" y="-21237.16" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2398" y="-21226.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2398" y="-21215.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2398" y="-21204.16" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer0_reshape&#45;&gt;gpu4_layer0_attn -->
<g id="edge1306" class="edge">
<title>gpu4_layer0_reshape&#45;&gt;gpu4_layer0_attn</title>
<path fill="none" stroke="black" d="M2398,-21286C2398,-21277.7 2398,-21268.32 2398,-21259.41"/>
<polygon fill="black" stroke="black" points="2401.5,-21259.27 2398,-21249.27 2394.5,-21259.27 2401.5,-21259.27"/>
</g>
<!-- gpu4_layer0_attn_reshape -->
<g id="node1049" class="node">
<title>gpu4_layer0_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2542,-21160.16 2420,-21160.16 2420,-21108.16 2542,-21108.16 2542,-21160.16"/>
<text text-anchor="middle" x="2481" y="-21148.16" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2481" y="-21137.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2481" y="-21126.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2481" y="-21115.16" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer0_attn&#45;&gt;gpu4_layer0_attn_reshape -->
<g id="edge1307" class="edge">
<title>gpu4_layer0_attn&#45;&gt;gpu4_layer0_attn_reshape</title>
<path fill="none" stroke="black" d="M2422.01,-21197C2430.78,-21187.8 2440.83,-21177.27 2450.12,-21167.53"/>
<polygon fill="black" stroke="black" points="2452.68,-21169.92 2457.05,-21160.27 2447.61,-21165.09 2452.68,-21169.92"/>
</g>
<!-- gpu4_layer0_attn_out -->
<g id="node1048" class="node">
<title>gpu4_layer0_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2636,-21071.16 2514,-21071.16 2514,-21019.16 2636,-21019.16 2636,-21071.16"/>
<text text-anchor="middle" x="2575" y="-21059.16" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2575" y="-21048.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2575" y="-21037.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2575" y="-21026.16" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer0_kv_update -->
<g id="node1050" class="node">
<title>gpu4_layer0_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2584" cy="-20945.4" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2584" y="-20959.4" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2584" y="-20948.4" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2584" y="-20937.4" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2584" y="-20926.4" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer0_attn_out&#45;&gt;gpu4_layer0_kv_update -->
<g id="edge1309" class="edge">
<title>gpu4_layer0_attn_out&#45;&gt;gpu4_layer0_kv_update</title>
<path fill="none" stroke="black" d="M2577.32,-21018.99C2578.07,-21010.85 2578.92,-21001.55 2579.77,-20992.39"/>
<polygon fill="black" stroke="black" points="2583.27,-20992.45 2580.71,-20982.17 2576.3,-20991.81 2583.27,-20992.45"/>
</g>
<!-- gpu4_layer0_attn_reshape&#45;&gt;gpu4_layer0_attn_out -->
<g id="edge1308" class="edge">
<title>gpu4_layer0_attn_reshape&#45;&gt;gpu4_layer0_attn_out</title>
<path fill="none" stroke="black" d="M2508.19,-21108C2518.22,-21098.71 2529.73,-21088.06 2540.34,-21078.24"/>
<polygon fill="black" stroke="black" points="2542.91,-21080.63 2547.87,-21071.27 2538.16,-21075.5 2542.91,-21080.63"/>
</g>
<!-- gpu4_layer0_res1 -->
<g id="node1051" class="node">
<title>gpu4_layer0_res1</title>
<polygon fill="lightblue" stroke="black" points="2647,-20871.63 2525,-20871.63 2525,-20819.63 2647,-20819.63 2647,-20871.63"/>
<text text-anchor="middle" x="2586" y="-20859.63" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2586" y="-20848.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2586" y="-20837.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2586" y="-20826.63" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer0_kv_update&#45;&gt;gpu4_layer0_res1 -->
<g id="edge1310" class="edge">
<title>gpu4_layer0_kv_update&#45;&gt;gpu4_layer0_res1</title>
<path fill="none" stroke="black" d="M2584.73,-20908.54C2584.91,-20899.87 2585.1,-20890.6 2585.28,-20881.94"/>
<polygon fill="black" stroke="black" points="2588.78,-20881.84 2585.49,-20871.77 2581.78,-20881.7 2588.78,-20881.84"/>
</g>
<!-- gpu4_layer0_ln2 -->
<g id="node1052" class="node">
<title>gpu4_layer0_ln2</title>
<polygon fill="lightblue" stroke="black" points="2656,-20782.63 2534,-20782.63 2534,-20730.63 2656,-20730.63 2656,-20782.63"/>
<text text-anchor="middle" x="2595" y="-20770.63" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2595" y="-20759.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2595" y="-20748.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2595" y="-20737.63" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer0_res1&#45;&gt;gpu4_layer0_ln2 -->
<g id="edge1311" class="edge">
<title>gpu4_layer0_res1&#45;&gt;gpu4_layer0_ln2</title>
<path fill="none" stroke="black" d="M2588.6,-20819.46C2589.46,-20811.17 2590.43,-20801.78 2591.35,-20792.87"/>
<polygon fill="black" stroke="black" points="2594.86,-20793.04 2592.4,-20782.73 2587.89,-20792.32 2594.86,-20793.04"/>
</g>
<!-- gpu4_layer0_routing -->
<g id="node1053" class="node">
<title>gpu4_layer0_routing</title>
<polygon fill="lightyellow" stroke="black" points="2723.47,-20693.63 2522.29,-20693.63 2470.53,-20567.63 2671.71,-20567.63 2723.47,-20693.63"/>
<text text-anchor="middle" x="2597" y="-20650.13" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2597" y="-20639.13" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2597" y="-20628.13" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2597" y="-20617.13" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2597" y="-20606.13" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer0_ln2&#45;&gt;gpu4_layer0_routing -->
<g id="edge1312" class="edge">
<title>gpu4_layer0_ln2&#45;&gt;gpu4_layer0_routing</title>
<path fill="none" stroke="black" d="M2595.4,-20730.53C2595.53,-20722.6 2595.68,-20713.4 2595.83,-20703.87"/>
<polygon fill="black" stroke="black" points="2599.33,-20703.92 2596,-20693.86 2592.34,-20703.8 2599.33,-20703.92"/>
</g>
<!-- gpu4_layer0_expert0 -->
<g id="node1054" class="node">
<title>gpu4_layer0_expert0</title>
<polygon fill="lightblue" stroke="black" points="2514,-20521.63 2392,-20521.63 2392,-20469.63 2514,-20469.63 2514,-20521.63"/>
<text text-anchor="middle" x="2453" y="-20509.63" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="2453" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer0_routing&#45;&gt;gpu4_layer0_expert0 -->
<g id="edge1299" class="edge">
<title>gpu4_layer0_routing&#45;&gt;gpu4_layer0_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2529.64,-20567.41C2515.21,-20554.08 2500.53,-20540.53 2487.94,-20528.9"/>
<polygon fill="black" stroke="black" points="2490.11,-20526.13 2480.39,-20521.92 2485.36,-20531.28 2490.11,-20526.13"/>
<text text-anchor="middle" x="2536.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer0_expert1 -->
<g id="node1055" class="node">
<title>gpu4_layer0_expert1</title>
<polygon fill="lightblue" stroke="black" points="2654,-20521.63 2532,-20521.63 2532,-20469.63 2654,-20469.63 2654,-20521.63"/>
<text text-anchor="middle" x="2593" y="-20509.63" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="2593" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer0_routing&#45;&gt;gpu4_layer0_expert1 -->
<g id="edge1300" class="edge">
<title>gpu4_layer0_routing&#45;&gt;gpu4_layer0_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2595.13,-20567.41C2594.77,-20555.34 2594.4,-20543.08 2594.07,-20532.24"/>
<polygon fill="black" stroke="black" points="2597.56,-20531.81 2593.76,-20521.92 2590.56,-20532.02 2597.56,-20531.81"/>
<text text-anchor="middle" x="2623.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer0_expert2 -->
<g id="node1056" class="node">
<title>gpu4_layer0_expert2</title>
<polygon fill="lightblue" stroke="black" points="2794,-20521.63 2672,-20521.63 2672,-20469.63 2794,-20469.63 2794,-20521.63"/>
<text text-anchor="middle" x="2733" y="-20509.63" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2733" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer0_routing&#45;&gt;gpu4_layer0_expert2 -->
<g id="edge1301" class="edge">
<title>gpu4_layer0_routing&#45;&gt;gpu4_layer0_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2660.62,-20567.41C2674.12,-20554.21 2687.84,-20540.78 2699.67,-20529.23"/>
<polygon fill="black" stroke="black" points="2702.43,-20531.41 2707.14,-20521.92 2697.54,-20526.41 2702.43,-20531.41"/>
<text text-anchor="middle" x="2718.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer0_expert3 -->
<g id="node1057" class="node">
<title>gpu4_layer0_expert3</title>
<polygon fill="lightblue" stroke="black" points="2934,-20521.63 2812,-20521.63 2812,-20469.63 2934,-20469.63 2934,-20521.63"/>
<text text-anchor="middle" x="2873" y="-20509.63" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2873" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer0_routing&#45;&gt;gpu4_layer0_expert3 -->
<g id="edge1302" class="edge">
<title>gpu4_layer0_routing&#45;&gt;gpu4_layer0_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2680.93,-20589.18C2723.22,-20568.8 2773.55,-20544.55 2812.08,-20525.98"/>
<polygon fill="black" stroke="black" points="2813.62,-20529.13 2821.11,-20521.63 2810.58,-20522.82 2813.62,-20529.13"/>
<text text-anchor="middle" x="2812.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer0_expert_agg -->
<g id="node1058" class="node">
<title>gpu4_layer0_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-20432.63 2658.29,-20432.63 2606.53,-20328.63 2807.71,-20328.63 2859.47,-20432.63"/>
<text text-anchor="middle" x="2733" y="-20394.63" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2733" y="-20383.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-20372.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-20361.63" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer0_routing&#45;&gt;gpu4_layer0_expert_agg -->
<g id="edge1317" class="edge">
<title>gpu4_layer0_routing&#45;&gt;gpu4_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M2690.48,-20613.24C2782.27,-20595.03 2912.8,-20562.69 2943,-20521.63 2976.89,-20475.54 2921.61,-20440.05 2859.28,-20416.34"/>
<polygon fill="black" stroke="black" points="2860.23,-20412.96 2849.64,-20412.78 2857.81,-20419.52 2860.23,-20412.96"/>
</g>
<!-- gpu4_layer0_expert0&#45;&gt;gpu4_layer0_expert_agg -->
<g id="edge1313" class="edge">
<title>gpu4_layer0_expert0&#45;&gt;gpu4_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M2514.1,-20469.97C2550.98,-20455.08 2598.7,-20435.83 2640.16,-20419.09"/>
<polygon fill="black" stroke="black" points="2641.5,-20422.33 2649.46,-20415.34 2638.88,-20415.84 2641.5,-20422.33"/>
</g>
<!-- gpu4_layer0_expert1&#45;&gt;gpu4_layer0_expert_agg -->
<g id="edge1314" class="edge">
<title>gpu4_layer0_expert1&#45;&gt;gpu4_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M2624.07,-20469.55C2635.32,-20460.47 2648.53,-20449.81 2661.8,-20439.1"/>
<polygon fill="black" stroke="black" points="2664.02,-20441.8 2669.6,-20432.8 2659.62,-20436.35 2664.02,-20441.8"/>
</g>
<!-- gpu4_layer0_expert2&#45;&gt;gpu4_layer0_expert_agg -->
<g id="edge1315" class="edge">
<title>gpu4_layer0_expert2&#45;&gt;gpu4_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M2733,-20469.55C2733,-20461.62 2733,-20452.48 2733,-20443.16"/>
<polygon fill="black" stroke="black" points="2736.5,-20443.03 2733,-20433.03 2729.5,-20443.03 2736.5,-20443.03"/>
</g>
<!-- gpu4_layer0_expert3&#45;&gt;gpu4_layer0_expert_agg -->
<g id="edge1316" class="edge">
<title>gpu4_layer0_expert3&#45;&gt;gpu4_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M2841.93,-20469.55C2830.68,-20460.47 2817.47,-20449.81 2804.2,-20439.1"/>
<polygon fill="black" stroke="black" points="2806.38,-20436.35 2796.4,-20432.8 2801.98,-20441.8 2806.38,-20436.35"/>
</g>
<!-- gpu4_layer0_res2 -->
<g id="node1059" class="node">
<title>gpu4_layer0_res2</title>
<polygon fill="lightblue" stroke="black" points="2794,-20291.63 2672,-20291.63 2672,-20239.63 2794,-20239.63 2794,-20291.63"/>
<text text-anchor="middle" x="2733" y="-20279.63" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2733" y="-20268.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-20257.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-20246.63" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer0_expert_agg&#45;&gt;gpu4_layer0_res2 -->
<g id="edge1318" class="edge">
<title>gpu4_layer0_expert_agg&#45;&gt;gpu4_layer0_res2</title>
<path fill="none" stroke="black" d="M2733,-20328.42C2733,-20319.46 2733,-20310.34 2733,-20301.94"/>
<polygon fill="black" stroke="black" points="2736.5,-20301.76 2733,-20291.76 2729.5,-20301.76 2736.5,-20301.76"/>
</g>
<!-- gpu4_layer1_ln1 -->
<g id="node1060" class="node">
<title>gpu4_layer1_ln1</title>
<polygon fill="lightblue" stroke="black" points="2794,-20202.63 2672,-20202.63 2672,-20150.63 2794,-20150.63 2794,-20202.63"/>
<text text-anchor="middle" x="2733" y="-20190.63" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2733" y="-20179.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-20168.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-20157.63" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer0_res2&#45;&gt;gpu4_layer1_ln1 -->
<g id="edge1323" class="edge">
<title>gpu4_layer0_res2&#45;&gt;gpu4_layer1_ln1</title>
<path fill="none" stroke="black" d="M2733,-20239.46C2733,-20231.17 2733,-20221.78 2733,-20212.87"/>
<polygon fill="black" stroke="black" points="2736.5,-20212.73 2733,-20202.73 2729.5,-20212.73 2736.5,-20212.73"/>
</g>
<!-- gpu4_layer1_qkv -->
<g id="node1061" class="node">
<title>gpu4_layer1_qkv</title>
<polygon fill="lightblue" stroke="black" points="2794,-20113.63 2672,-20113.63 2672,-20061.63 2794,-20061.63 2794,-20113.63"/>
<text text-anchor="middle" x="2733" y="-20101.63" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2733" y="-20090.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-20079.63" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-20068.63" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer1_ln1&#45;&gt;gpu4_layer1_qkv -->
<g id="edge1324" class="edge">
<title>gpu4_layer1_ln1&#45;&gt;gpu4_layer1_qkv</title>
<path fill="none" stroke="black" d="M2733,-20150.46C2733,-20142.17 2733,-20132.78 2733,-20123.87"/>
<polygon fill="black" stroke="black" points="2736.5,-20123.73 2733,-20113.73 2729.5,-20123.73 2736.5,-20123.73"/>
</g>
<!-- gpu4_layer1_reshape -->
<g id="node1062" class="node">
<title>gpu4_layer1_reshape</title>
<polygon fill="lightblue" stroke="black" points="2797,-20024.63 2669,-20024.63 2669,-19972.63 2797,-19972.63 2797,-20024.63"/>
<text text-anchor="middle" x="2733" y="-20012.63" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2733" y="-20001.63" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-19990.63" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-19979.63" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer1_qkv&#45;&gt;gpu4_layer1_reshape -->
<g id="edge1325" class="edge">
<title>gpu4_layer1_qkv&#45;&gt;gpu4_layer1_reshape</title>
<path fill="none" stroke="black" d="M2733,-20061.46C2733,-20053.17 2733,-20043.78 2733,-20034.87"/>
<polygon fill="black" stroke="black" points="2736.5,-20034.73 2733,-20024.73 2729.5,-20034.73 2736.5,-20034.73"/>
</g>
<!-- gpu4_layer1_attn -->
<g id="node1063" class="node">
<title>gpu4_layer1_attn</title>
<polygon fill="lightblue" stroke="black" points="2797,-19935.63 2669,-19935.63 2669,-19883.63 2797,-19883.63 2797,-19935.63"/>
<text text-anchor="middle" x="2733" y="-19923.63" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2733" y="-19912.63" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-19901.63" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-19890.63" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer1_reshape&#45;&gt;gpu4_layer1_attn -->
<g id="edge1326" class="edge">
<title>gpu4_layer1_reshape&#45;&gt;gpu4_layer1_attn</title>
<path fill="none" stroke="black" d="M2733,-19972.46C2733,-19964.17 2733,-19954.78 2733,-19945.87"/>
<polygon fill="black" stroke="black" points="2736.5,-19945.73 2733,-19935.73 2729.5,-19945.73 2736.5,-19945.73"/>
</g>
<!-- gpu4_layer1_attn_reshape -->
<g id="node1065" class="node">
<title>gpu4_layer1_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2794,-19846.63 2672,-19846.63 2672,-19794.63 2794,-19794.63 2794,-19846.63"/>
<text text-anchor="middle" x="2733" y="-19834.63" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2733" y="-19823.63" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-19812.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-19801.63" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer1_attn&#45;&gt;gpu4_layer1_attn_reshape -->
<g id="edge1327" class="edge">
<title>gpu4_layer1_attn&#45;&gt;gpu4_layer1_attn_reshape</title>
<path fill="none" stroke="black" d="M2733,-19883.46C2733,-19875.17 2733,-19865.78 2733,-19856.87"/>
<polygon fill="black" stroke="black" points="2736.5,-19856.73 2733,-19846.73 2729.5,-19856.73 2736.5,-19856.73"/>
</g>
<!-- gpu4_layer1_attn_out -->
<g id="node1064" class="node">
<title>gpu4_layer1_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2794,-19757.63 2672,-19757.63 2672,-19705.63 2794,-19705.63 2794,-19757.63"/>
<text text-anchor="middle" x="2733" y="-19745.63" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2733" y="-19734.63" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-19723.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-19712.63" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer1_kv_update -->
<g id="node1066" class="node">
<title>gpu4_layer1_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2733" cy="-19631.86" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2733" y="-19645.86" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2733" y="-19634.86" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-19623.86" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-19612.86" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer1_attn_out&#45;&gt;gpu4_layer1_kv_update -->
<g id="edge1329" class="edge">
<title>gpu4_layer1_attn_out&#45;&gt;gpu4_layer1_kv_update</title>
<path fill="none" stroke="black" d="M2733,-19705.45C2733,-19697.31 2733,-19688.01 2733,-19678.85"/>
<polygon fill="black" stroke="black" points="2736.5,-19678.64 2733,-19668.64 2729.5,-19678.64 2736.5,-19678.64"/>
</g>
<!-- gpu4_layer1_attn_reshape&#45;&gt;gpu4_layer1_attn_out -->
<g id="edge1328" class="edge">
<title>gpu4_layer1_attn_reshape&#45;&gt;gpu4_layer1_attn_out</title>
<path fill="none" stroke="black" d="M2733,-19794.46C2733,-19786.17 2733,-19776.78 2733,-19767.87"/>
<polygon fill="black" stroke="black" points="2736.5,-19767.73 2733,-19757.73 2729.5,-19767.73 2736.5,-19767.73"/>
</g>
<!-- gpu4_layer1_res1 -->
<g id="node1067" class="node">
<title>gpu4_layer1_res1</title>
<polygon fill="lightblue" stroke="black" points="2794,-19558.09 2672,-19558.09 2672,-19506.09 2794,-19506.09 2794,-19558.09"/>
<text text-anchor="middle" x="2733" y="-19546.09" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2733" y="-19535.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-19524.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-19513.09" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer1_kv_update&#45;&gt;gpu4_layer1_res1 -->
<g id="edge1330" class="edge">
<title>gpu4_layer1_kv_update&#45;&gt;gpu4_layer1_res1</title>
<path fill="none" stroke="black" d="M2733,-19595.01C2733,-19586.33 2733,-19577.06 2733,-19568.4"/>
<polygon fill="black" stroke="black" points="2736.5,-19568.23 2733,-19558.23 2729.5,-19568.23 2736.5,-19568.23"/>
</g>
<!-- gpu4_layer1_ln2 -->
<g id="node1068" class="node">
<title>gpu4_layer1_ln2</title>
<polygon fill="lightblue" stroke="black" points="2794,-19469.09 2672,-19469.09 2672,-19417.09 2794,-19417.09 2794,-19469.09"/>
<text text-anchor="middle" x="2733" y="-19457.09" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2733" y="-19446.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-19435.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-19424.09" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer1_res1&#45;&gt;gpu4_layer1_ln2 -->
<g id="edge1331" class="edge">
<title>gpu4_layer1_res1&#45;&gt;gpu4_layer1_ln2</title>
<path fill="none" stroke="black" d="M2733,-19505.92C2733,-19497.63 2733,-19488.24 2733,-19479.34"/>
<polygon fill="black" stroke="black" points="2736.5,-19479.19 2733,-19469.19 2729.5,-19479.19 2736.5,-19479.19"/>
</g>
<!-- gpu4_layer1_routing -->
<g id="node1069" class="node">
<title>gpu4_layer1_routing</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-19380.09 2658.29,-19380.09 2606.53,-19254.09 2807.71,-19254.09 2859.47,-19380.09"/>
<text text-anchor="middle" x="2733" y="-19336.59" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2733" y="-19325.59" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-19314.59" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-19303.59" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2733" y="-19292.59" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer1_ln2&#45;&gt;gpu4_layer1_routing -->
<g id="edge1332" class="edge">
<title>gpu4_layer1_ln2&#45;&gt;gpu4_layer1_routing</title>
<path fill="none" stroke="black" d="M2733,-19416.99C2733,-19409.06 2733,-19399.86 2733,-19390.33"/>
<polygon fill="black" stroke="black" points="2736.5,-19390.32 2733,-19380.32 2729.5,-19390.32 2736.5,-19390.32"/>
</g>
<!-- gpu4_layer1_expert0 -->
<g id="node1070" class="node">
<title>gpu4_layer1_expert0</title>
<polygon fill="lightblue" stroke="black" points="2514,-19208.09 2392,-19208.09 2392,-19156.09 2514,-19156.09 2514,-19208.09"/>
<text text-anchor="middle" x="2453" y="-19196.09" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="2453" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer1_routing&#45;&gt;gpu4_layer1_expert0 -->
<g id="edge1319" class="edge">
<title>gpu4_layer1_routing&#45;&gt;gpu4_layer1_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2607.33,-19256.39C2575.34,-19241.2 2542.34,-19225.52 2515.11,-19212.59"/>
<polygon fill="black" stroke="black" points="2516.26,-19209.26 2505.73,-19208.13 2513.26,-19215.58 2516.26,-19209.26"/>
<text text-anchor="middle" x="2588.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer1_expert1 -->
<g id="node1071" class="node">
<title>gpu4_layer1_expert1</title>
<polygon fill="lightblue" stroke="black" points="2654,-19208.09 2532,-19208.09 2532,-19156.09 2654,-19156.09 2654,-19208.09"/>
<text text-anchor="middle" x="2593" y="-19196.09" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="2593" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer1_routing&#45;&gt;gpu4_layer1_expert1 -->
<g id="edge1320" class="edge">
<title>gpu4_layer1_routing&#45;&gt;gpu4_layer1_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2667.51,-19253.87C2653.48,-19240.55 2639.21,-19226.99 2626.97,-19215.36"/>
<polygon fill="black" stroke="black" points="2629.29,-19212.73 2619.63,-19208.38 2624.46,-19217.81 2629.29,-19212.73"/>
<text text-anchor="middle" x="2675.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer1_expert2 -->
<g id="node1072" class="node">
<title>gpu4_layer1_expert2</title>
<polygon fill="lightblue" stroke="black" points="2794,-19208.09 2672,-19208.09 2672,-19156.09 2794,-19156.09 2794,-19208.09"/>
<text text-anchor="middle" x="2733" y="-19196.09" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2733" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer1_routing&#45;&gt;gpu4_layer1_expert2 -->
<g id="edge1321" class="edge">
<title>gpu4_layer1_routing&#45;&gt;gpu4_layer1_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2733,-19253.87C2733,-19241.8 2733,-19229.55 2733,-19218.7"/>
<polygon fill="black" stroke="black" points="2736.5,-19218.38 2733,-19208.38 2729.5,-19218.38 2736.5,-19218.38"/>
<text text-anchor="middle" x="2762.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer1_expert3 -->
<g id="node1073" class="node">
<title>gpu4_layer1_expert3</title>
<polygon fill="lightblue" stroke="black" points="2934,-19208.09 2812,-19208.09 2812,-19156.09 2934,-19156.09 2934,-19208.09"/>
<text text-anchor="middle" x="2873" y="-19196.09" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2873" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer1_routing&#45;&gt;gpu4_layer1_expert3 -->
<g id="edge1322" class="edge">
<title>gpu4_layer1_routing&#45;&gt;gpu4_layer1_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2798.49,-19253.87C2812.52,-19240.55 2826.79,-19226.99 2839.03,-19215.36"/>
<polygon fill="black" stroke="black" points="2841.54,-19217.81 2846.37,-19208.38 2836.71,-19212.73 2841.54,-19217.81"/>
<text text-anchor="middle" x="2856.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer1_expert_agg -->
<g id="node1074" class="node">
<title>gpu4_layer1_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-19119.09 2658.29,-19119.09 2606.53,-19015.09 2807.71,-19015.09 2859.47,-19119.09"/>
<text text-anchor="middle" x="2733" y="-19081.09" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2733" y="-19070.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-19059.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-19048.09" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer1_routing&#45;&gt;gpu4_layer1_expert_agg -->
<g id="edge1337" class="edge">
<title>gpu4_layer1_routing&#45;&gt;gpu4_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2822.22,-19289.17C2895.96,-19262.01 2982.6,-19215.62 2943,-19156.09 2922.44,-19125.17 2888.7,-19105.1 2854.22,-19092.07"/>
<polygon fill="black" stroke="black" points="2855.08,-19088.66 2844.48,-19088.58 2852.71,-19095.25 2855.08,-19088.66"/>
</g>
<!-- gpu4_layer1_expert0&#45;&gt;gpu4_layer1_expert_agg -->
<g id="edge1333" class="edge">
<title>gpu4_layer1_expert0&#45;&gt;gpu4_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2514.1,-19156.43C2550.98,-19141.55 2598.7,-19122.29 2640.16,-19105.55"/>
<polygon fill="black" stroke="black" points="2641.5,-19108.79 2649.46,-19101.8 2638.88,-19102.3 2641.5,-19108.79"/>
</g>
<!-- gpu4_layer1_expert1&#45;&gt;gpu4_layer1_expert_agg -->
<g id="edge1334" class="edge">
<title>gpu4_layer1_expert1&#45;&gt;gpu4_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2624.07,-19156.01C2635.32,-19146.93 2648.53,-19136.27 2661.8,-19125.56"/>
<polygon fill="black" stroke="black" points="2664.02,-19128.26 2669.6,-19119.26 2659.62,-19122.82 2664.02,-19128.26"/>
</g>
<!-- gpu4_layer1_expert2&#45;&gt;gpu4_layer1_expert_agg -->
<g id="edge1335" class="edge">
<title>gpu4_layer1_expert2&#45;&gt;gpu4_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2733,-19156.01C2733,-19148.08 2733,-19138.95 2733,-19129.62"/>
<polygon fill="black" stroke="black" points="2736.5,-19129.49 2733,-19119.49 2729.5,-19129.49 2736.5,-19129.49"/>
</g>
<!-- gpu4_layer1_expert3&#45;&gt;gpu4_layer1_expert_agg -->
<g id="edge1336" class="edge">
<title>gpu4_layer1_expert3&#45;&gt;gpu4_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2841.93,-19156.01C2830.68,-19146.93 2817.47,-19136.27 2804.2,-19125.56"/>
<polygon fill="black" stroke="black" points="2806.38,-19122.82 2796.4,-19119.26 2801.98,-19128.26 2806.38,-19122.82"/>
</g>
<!-- gpu4_layer1_res2 -->
<g id="node1075" class="node">
<title>gpu4_layer1_res2</title>
<polygon fill="lightblue" stroke="black" points="2794,-18978.09 2672,-18978.09 2672,-18926.09 2794,-18926.09 2794,-18978.09"/>
<text text-anchor="middle" x="2733" y="-18966.09" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2733" y="-18955.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-18944.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-18933.09" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer1_expert_agg&#45;&gt;gpu4_layer1_res2 -->
<g id="edge1338" class="edge">
<title>gpu4_layer1_expert_agg&#45;&gt;gpu4_layer1_res2</title>
<path fill="none" stroke="black" d="M2733,-19014.88C2733,-19005.93 2733,-18996.8 2733,-18988.4"/>
<polygon fill="black" stroke="black" points="2736.5,-18988.22 2733,-18978.22 2729.5,-18988.22 2736.5,-18988.22"/>
</g>
<!-- gpu4_layer2_ln1 -->
<g id="node1076" class="node">
<title>gpu4_layer2_ln1</title>
<polygon fill="lightblue" stroke="black" points="2794,-18889.09 2672,-18889.09 2672,-18837.09 2794,-18837.09 2794,-18889.09"/>
<text text-anchor="middle" x="2733" y="-18877.09" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2733" y="-18866.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-18855.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-18844.09" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer1_res2&#45;&gt;gpu4_layer2_ln1 -->
<g id="edge1343" class="edge">
<title>gpu4_layer1_res2&#45;&gt;gpu4_layer2_ln1</title>
<path fill="none" stroke="black" d="M2733,-18925.92C2733,-18917.63 2733,-18908.24 2733,-18899.34"/>
<polygon fill="black" stroke="black" points="2736.5,-18899.19 2733,-18889.19 2729.5,-18899.19 2736.5,-18899.19"/>
</g>
<!-- gpu4_layer2_qkv -->
<g id="node1077" class="node">
<title>gpu4_layer2_qkv</title>
<polygon fill="lightblue" stroke="black" points="2794,-18800.09 2672,-18800.09 2672,-18748.09 2794,-18748.09 2794,-18800.09"/>
<text text-anchor="middle" x="2733" y="-18788.09" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2733" y="-18777.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-18766.09" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-18755.09" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer2_ln1&#45;&gt;gpu4_layer2_qkv -->
<g id="edge1344" class="edge">
<title>gpu4_layer2_ln1&#45;&gt;gpu4_layer2_qkv</title>
<path fill="none" stroke="black" d="M2733,-18836.92C2733,-18828.63 2733,-18819.24 2733,-18810.34"/>
<polygon fill="black" stroke="black" points="2736.5,-18810.19 2733,-18800.19 2729.5,-18810.19 2736.5,-18810.19"/>
</g>
<!-- gpu4_layer2_reshape -->
<g id="node1078" class="node">
<title>gpu4_layer2_reshape</title>
<polygon fill="lightblue" stroke="black" points="2797,-18711.09 2669,-18711.09 2669,-18659.09 2797,-18659.09 2797,-18711.09"/>
<text text-anchor="middle" x="2733" y="-18699.09" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2733" y="-18688.09" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-18677.09" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-18666.09" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer2_qkv&#45;&gt;gpu4_layer2_reshape -->
<g id="edge1345" class="edge">
<title>gpu4_layer2_qkv&#45;&gt;gpu4_layer2_reshape</title>
<path fill="none" stroke="black" d="M2733,-18747.92C2733,-18739.63 2733,-18730.24 2733,-18721.34"/>
<polygon fill="black" stroke="black" points="2736.5,-18721.19 2733,-18711.19 2729.5,-18721.19 2736.5,-18721.19"/>
</g>
<!-- gpu4_layer2_attn -->
<g id="node1079" class="node">
<title>gpu4_layer2_attn</title>
<polygon fill="lightblue" stroke="black" points="2797,-18622.09 2669,-18622.09 2669,-18570.09 2797,-18570.09 2797,-18622.09"/>
<text text-anchor="middle" x="2733" y="-18610.09" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2733" y="-18599.09" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-18588.09" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-18577.09" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer2_reshape&#45;&gt;gpu4_layer2_attn -->
<g id="edge1346" class="edge">
<title>gpu4_layer2_reshape&#45;&gt;gpu4_layer2_attn</title>
<path fill="none" stroke="black" d="M2733,-18658.92C2733,-18650.63 2733,-18641.24 2733,-18632.34"/>
<polygon fill="black" stroke="black" points="2736.5,-18632.19 2733,-18622.19 2729.5,-18632.19 2736.5,-18632.19"/>
</g>
<!-- gpu4_layer2_attn_reshape -->
<g id="node1081" class="node">
<title>gpu4_layer2_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2794,-18533.09 2672,-18533.09 2672,-18481.09 2794,-18481.09 2794,-18533.09"/>
<text text-anchor="middle" x="2733" y="-18521.09" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2733" y="-18510.09" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-18499.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-18488.09" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer2_attn&#45;&gt;gpu4_layer2_attn_reshape -->
<g id="edge1347" class="edge">
<title>gpu4_layer2_attn&#45;&gt;gpu4_layer2_attn_reshape</title>
<path fill="none" stroke="black" d="M2733,-18569.92C2733,-18561.63 2733,-18552.24 2733,-18543.34"/>
<polygon fill="black" stroke="black" points="2736.5,-18543.19 2733,-18533.19 2729.5,-18543.19 2736.5,-18543.19"/>
</g>
<!-- gpu4_layer2_attn_out -->
<g id="node1080" class="node">
<title>gpu4_layer2_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2794,-18444.09 2672,-18444.09 2672,-18392.09 2794,-18392.09 2794,-18444.09"/>
<text text-anchor="middle" x="2733" y="-18432.09" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2733" y="-18421.09" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-18410.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-18399.09" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer2_kv_update -->
<g id="node1082" class="node">
<title>gpu4_layer2_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2733" cy="-18318.32" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2733" y="-18332.32" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2733" y="-18321.32" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-18310.32" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-18299.32" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer2_attn_out&#45;&gt;gpu4_layer2_kv_update -->
<g id="edge1349" class="edge">
<title>gpu4_layer2_attn_out&#45;&gt;gpu4_layer2_kv_update</title>
<path fill="none" stroke="black" d="M2733,-18391.91C2733,-18383.77 2733,-18374.47 2733,-18365.31"/>
<polygon fill="black" stroke="black" points="2736.5,-18365.1 2733,-18355.1 2729.5,-18365.1 2736.5,-18365.1"/>
</g>
<!-- gpu4_layer2_attn_reshape&#45;&gt;gpu4_layer2_attn_out -->
<g id="edge1348" class="edge">
<title>gpu4_layer2_attn_reshape&#45;&gt;gpu4_layer2_attn_out</title>
<path fill="none" stroke="black" d="M2733,-18480.92C2733,-18472.63 2733,-18463.24 2733,-18454.34"/>
<polygon fill="black" stroke="black" points="2736.5,-18454.19 2733,-18444.19 2729.5,-18454.19 2736.5,-18454.19"/>
</g>
<!-- gpu4_layer2_res1 -->
<g id="node1083" class="node">
<title>gpu4_layer2_res1</title>
<polygon fill="lightblue" stroke="black" points="2794,-18244.55 2672,-18244.55 2672,-18192.55 2794,-18192.55 2794,-18244.55"/>
<text text-anchor="middle" x="2733" y="-18232.55" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2733" y="-18221.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-18210.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-18199.55" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer2_kv_update&#45;&gt;gpu4_layer2_res1 -->
<g id="edge1350" class="edge">
<title>gpu4_layer2_kv_update&#45;&gt;gpu4_layer2_res1</title>
<path fill="none" stroke="black" d="M2733,-18281.47C2733,-18272.79 2733,-18263.52 2733,-18254.86"/>
<polygon fill="black" stroke="black" points="2736.5,-18254.69 2733,-18244.69 2729.5,-18254.69 2736.5,-18254.69"/>
</g>
<!-- gpu4_layer2_ln2 -->
<g id="node1084" class="node">
<title>gpu4_layer2_ln2</title>
<polygon fill="lightblue" stroke="black" points="2794,-18155.55 2672,-18155.55 2672,-18103.55 2794,-18103.55 2794,-18155.55"/>
<text text-anchor="middle" x="2733" y="-18143.55" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2733" y="-18132.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-18121.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-18110.55" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer2_res1&#45;&gt;gpu4_layer2_ln2 -->
<g id="edge1351" class="edge">
<title>gpu4_layer2_res1&#45;&gt;gpu4_layer2_ln2</title>
<path fill="none" stroke="black" d="M2733,-18192.38C2733,-18184.09 2733,-18174.7 2733,-18165.8"/>
<polygon fill="black" stroke="black" points="2736.5,-18165.65 2733,-18155.65 2729.5,-18165.65 2736.5,-18165.65"/>
</g>
<!-- gpu4_layer2_routing -->
<g id="node1085" class="node">
<title>gpu4_layer2_routing</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-18066.55 2658.29,-18066.55 2606.53,-17940.55 2807.71,-17940.55 2859.47,-18066.55"/>
<text text-anchor="middle" x="2733" y="-18023.05" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2733" y="-18012.05" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-18001.05" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-17990.05" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2733" y="-17979.05" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer2_ln2&#45;&gt;gpu4_layer2_routing -->
<g id="edge1352" class="edge">
<title>gpu4_layer2_ln2&#45;&gt;gpu4_layer2_routing</title>
<path fill="none" stroke="black" d="M2733,-18103.45C2733,-18095.52 2733,-18086.33 2733,-18076.8"/>
<polygon fill="black" stroke="black" points="2736.5,-18076.78 2733,-18066.78 2729.5,-18076.78 2736.5,-18076.78"/>
</g>
<!-- gpu4_layer2_expert0 -->
<g id="node1086" class="node">
<title>gpu4_layer2_expert0</title>
<polygon fill="lightblue" stroke="black" points="2514,-17894.55 2392,-17894.55 2392,-17842.55 2514,-17842.55 2514,-17894.55"/>
<text text-anchor="middle" x="2453" y="-17882.55" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="2453" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer2_routing&#45;&gt;gpu4_layer2_expert0 -->
<g id="edge1339" class="edge">
<title>gpu4_layer2_routing&#45;&gt;gpu4_layer2_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2607.33,-17942.86C2575.34,-17927.66 2542.34,-17911.98 2515.11,-17899.05"/>
<polygon fill="black" stroke="black" points="2516.26,-17895.72 2505.73,-17894.59 2513.26,-17902.04 2516.26,-17895.72"/>
<text text-anchor="middle" x="2588.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer2_expert1 -->
<g id="node1087" class="node">
<title>gpu4_layer2_expert1</title>
<polygon fill="lightblue" stroke="black" points="2654,-17894.55 2532,-17894.55 2532,-17842.55 2654,-17842.55 2654,-17894.55"/>
<text text-anchor="middle" x="2593" y="-17882.55" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="2593" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer2_routing&#45;&gt;gpu4_layer2_expert1 -->
<g id="edge1340" class="edge">
<title>gpu4_layer2_routing&#45;&gt;gpu4_layer2_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2667.51,-17940.33C2653.48,-17927.01 2639.21,-17913.45 2626.97,-17901.82"/>
<polygon fill="black" stroke="black" points="2629.29,-17899.19 2619.63,-17894.84 2624.46,-17904.27 2629.29,-17899.19"/>
<text text-anchor="middle" x="2675.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer2_expert2 -->
<g id="node1088" class="node">
<title>gpu4_layer2_expert2</title>
<polygon fill="lightblue" stroke="black" points="2794,-17894.55 2672,-17894.55 2672,-17842.55 2794,-17842.55 2794,-17894.55"/>
<text text-anchor="middle" x="2733" y="-17882.55" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2733" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer2_routing&#45;&gt;gpu4_layer2_expert2 -->
<g id="edge1341" class="edge">
<title>gpu4_layer2_routing&#45;&gt;gpu4_layer2_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2733,-17940.33C2733,-17928.26 2733,-17916.01 2733,-17905.16"/>
<polygon fill="black" stroke="black" points="2736.5,-17904.84 2733,-17894.84 2729.5,-17904.84 2736.5,-17904.84"/>
<text text-anchor="middle" x="2762.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer2_expert3 -->
<g id="node1089" class="node">
<title>gpu4_layer2_expert3</title>
<polygon fill="lightblue" stroke="black" points="2934,-17894.55 2812,-17894.55 2812,-17842.55 2934,-17842.55 2934,-17894.55"/>
<text text-anchor="middle" x="2873" y="-17882.55" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2873" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer2_routing&#45;&gt;gpu4_layer2_expert3 -->
<g id="edge1342" class="edge">
<title>gpu4_layer2_routing&#45;&gt;gpu4_layer2_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2798.49,-17940.33C2812.52,-17927.01 2826.79,-17913.45 2839.03,-17901.82"/>
<polygon fill="black" stroke="black" points="2841.54,-17904.27 2846.37,-17894.84 2836.71,-17899.19 2841.54,-17904.27"/>
<text text-anchor="middle" x="2856.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer2_expert_agg -->
<g id="node1090" class="node">
<title>gpu4_layer2_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-17805.55 2658.29,-17805.55 2606.53,-17701.55 2807.71,-17701.55 2859.47,-17805.55"/>
<text text-anchor="middle" x="2733" y="-17767.55" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2733" y="-17756.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-17745.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-17734.55" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer2_routing&#45;&gt;gpu4_layer2_expert_agg -->
<g id="edge1357" class="edge">
<title>gpu4_layer2_routing&#45;&gt;gpu4_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M2822.22,-17975.63C2895.96,-17948.47 2982.6,-17902.08 2943,-17842.55 2922.44,-17811.64 2888.7,-17791.56 2854.22,-17778.53"/>
<polygon fill="black" stroke="black" points="2855.08,-17775.12 2844.48,-17775.04 2852.71,-17781.71 2855.08,-17775.12"/>
</g>
<!-- gpu4_layer2_expert0&#45;&gt;gpu4_layer2_expert_agg -->
<g id="edge1353" class="edge">
<title>gpu4_layer2_expert0&#45;&gt;gpu4_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M2514.1,-17842.89C2550.98,-17828.01 2598.7,-17808.75 2640.16,-17792.01"/>
<polygon fill="black" stroke="black" points="2641.5,-17795.25 2649.46,-17788.26 2638.88,-17788.76 2641.5,-17795.25"/>
</g>
<!-- gpu4_layer2_expert1&#45;&gt;gpu4_layer2_expert_agg -->
<g id="edge1354" class="edge">
<title>gpu4_layer2_expert1&#45;&gt;gpu4_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M2624.07,-17842.47C2635.32,-17833.39 2648.53,-17822.73 2661.8,-17812.02"/>
<polygon fill="black" stroke="black" points="2664.02,-17814.72 2669.6,-17805.72 2659.62,-17809.28 2664.02,-17814.72"/>
</g>
<!-- gpu4_layer2_expert2&#45;&gt;gpu4_layer2_expert_agg -->
<g id="edge1355" class="edge">
<title>gpu4_layer2_expert2&#45;&gt;gpu4_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M2733,-17842.47C2733,-17834.54 2733,-17825.41 2733,-17816.09"/>
<polygon fill="black" stroke="black" points="2736.5,-17815.95 2733,-17805.95 2729.5,-17815.95 2736.5,-17815.95"/>
</g>
<!-- gpu4_layer2_expert3&#45;&gt;gpu4_layer2_expert_agg -->
<g id="edge1356" class="edge">
<title>gpu4_layer2_expert3&#45;&gt;gpu4_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M2841.93,-17842.47C2830.68,-17833.39 2817.47,-17822.73 2804.2,-17812.02"/>
<polygon fill="black" stroke="black" points="2806.38,-17809.28 2796.4,-17805.72 2801.98,-17814.72 2806.38,-17809.28"/>
</g>
<!-- gpu4_layer2_res2 -->
<g id="node1091" class="node">
<title>gpu4_layer2_res2</title>
<polygon fill="lightblue" stroke="black" points="2794,-17664.55 2672,-17664.55 2672,-17612.55 2794,-17612.55 2794,-17664.55"/>
<text text-anchor="middle" x="2733" y="-17652.55" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2733" y="-17641.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-17630.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-17619.55" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer2_expert_agg&#45;&gt;gpu4_layer2_res2 -->
<g id="edge1358" class="edge">
<title>gpu4_layer2_expert_agg&#45;&gt;gpu4_layer2_res2</title>
<path fill="none" stroke="black" d="M2733,-17701.34C2733,-17692.39 2733,-17683.26 2733,-17674.86"/>
<polygon fill="black" stroke="black" points="2736.5,-17674.68 2733,-17664.68 2729.5,-17674.68 2736.5,-17674.68"/>
</g>
<!-- gpu4_layer3_ln1 -->
<g id="node1092" class="node">
<title>gpu4_layer3_ln1</title>
<polygon fill="lightblue" stroke="black" points="2794,-17575.55 2672,-17575.55 2672,-17523.55 2794,-17523.55 2794,-17575.55"/>
<text text-anchor="middle" x="2733" y="-17563.55" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2733" y="-17552.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-17541.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-17530.55" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer2_res2&#45;&gt;gpu4_layer3_ln1 -->
<g id="edge1363" class="edge">
<title>gpu4_layer2_res2&#45;&gt;gpu4_layer3_ln1</title>
<path fill="none" stroke="black" d="M2733,-17612.38C2733,-17604.09 2733,-17594.7 2733,-17585.8"/>
<polygon fill="black" stroke="black" points="2736.5,-17585.65 2733,-17575.65 2729.5,-17585.65 2736.5,-17585.65"/>
</g>
<!-- gpu4_layer3_qkv -->
<g id="node1093" class="node">
<title>gpu4_layer3_qkv</title>
<polygon fill="lightblue" stroke="black" points="2794,-17486.55 2672,-17486.55 2672,-17434.55 2794,-17434.55 2794,-17486.55"/>
<text text-anchor="middle" x="2733" y="-17474.55" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2733" y="-17463.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-17452.55" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-17441.55" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer3_ln1&#45;&gt;gpu4_layer3_qkv -->
<g id="edge1364" class="edge">
<title>gpu4_layer3_ln1&#45;&gt;gpu4_layer3_qkv</title>
<path fill="none" stroke="black" d="M2733,-17523.38C2733,-17515.09 2733,-17505.7 2733,-17496.8"/>
<polygon fill="black" stroke="black" points="2736.5,-17496.65 2733,-17486.65 2729.5,-17496.65 2736.5,-17496.65"/>
</g>
<!-- gpu4_layer3_reshape -->
<g id="node1094" class="node">
<title>gpu4_layer3_reshape</title>
<polygon fill="lightblue" stroke="black" points="2797,-17397.55 2669,-17397.55 2669,-17345.55 2797,-17345.55 2797,-17397.55"/>
<text text-anchor="middle" x="2733" y="-17385.55" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2733" y="-17374.55" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-17363.55" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-17352.55" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer3_qkv&#45;&gt;gpu4_layer3_reshape -->
<g id="edge1365" class="edge">
<title>gpu4_layer3_qkv&#45;&gt;gpu4_layer3_reshape</title>
<path fill="none" stroke="black" d="M2733,-17434.38C2733,-17426.09 2733,-17416.7 2733,-17407.8"/>
<polygon fill="black" stroke="black" points="2736.5,-17407.65 2733,-17397.65 2729.5,-17407.65 2736.5,-17407.65"/>
</g>
<!-- gpu4_layer3_attn -->
<g id="node1095" class="node">
<title>gpu4_layer3_attn</title>
<polygon fill="lightblue" stroke="black" points="2797,-17308.55 2669,-17308.55 2669,-17256.55 2797,-17256.55 2797,-17308.55"/>
<text text-anchor="middle" x="2733" y="-17296.55" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2733" y="-17285.55" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-17274.55" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-17263.55" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer3_reshape&#45;&gt;gpu4_layer3_attn -->
<g id="edge1366" class="edge">
<title>gpu4_layer3_reshape&#45;&gt;gpu4_layer3_attn</title>
<path fill="none" stroke="black" d="M2733,-17345.38C2733,-17337.09 2733,-17327.7 2733,-17318.8"/>
<polygon fill="black" stroke="black" points="2736.5,-17318.65 2733,-17308.65 2729.5,-17318.65 2736.5,-17318.65"/>
</g>
<!-- gpu4_layer3_attn_reshape -->
<g id="node1097" class="node">
<title>gpu4_layer3_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2794,-17219.55 2672,-17219.55 2672,-17167.55 2794,-17167.55 2794,-17219.55"/>
<text text-anchor="middle" x="2733" y="-17207.55" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2733" y="-17196.55" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-17185.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-17174.55" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer3_attn&#45;&gt;gpu4_layer3_attn_reshape -->
<g id="edge1367" class="edge">
<title>gpu4_layer3_attn&#45;&gt;gpu4_layer3_attn_reshape</title>
<path fill="none" stroke="black" d="M2733,-17256.38C2733,-17248.09 2733,-17238.7 2733,-17229.8"/>
<polygon fill="black" stroke="black" points="2736.5,-17229.65 2733,-17219.65 2729.5,-17229.65 2736.5,-17229.65"/>
</g>
<!-- gpu4_layer3_attn_out -->
<g id="node1096" class="node">
<title>gpu4_layer3_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2794,-17130.55 2672,-17130.55 2672,-17078.55 2794,-17078.55 2794,-17130.55"/>
<text text-anchor="middle" x="2733" y="-17118.55" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2733" y="-17107.55" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-17096.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-17085.55" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer3_kv_update -->
<g id="node1098" class="node">
<title>gpu4_layer3_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2733" cy="-17004.78" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2733" y="-17018.78" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2733" y="-17007.78" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-16996.78" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-16985.78" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer3_attn_out&#45;&gt;gpu4_layer3_kv_update -->
<g id="edge1369" class="edge">
<title>gpu4_layer3_attn_out&#45;&gt;gpu4_layer3_kv_update</title>
<path fill="none" stroke="black" d="M2733,-17078.37C2733,-17070.23 2733,-17060.93 2733,-17051.77"/>
<polygon fill="black" stroke="black" points="2736.5,-17051.56 2733,-17041.56 2729.5,-17051.56 2736.5,-17051.56"/>
</g>
<!-- gpu4_layer3_attn_reshape&#45;&gt;gpu4_layer3_attn_out -->
<g id="edge1368" class="edge">
<title>gpu4_layer3_attn_reshape&#45;&gt;gpu4_layer3_attn_out</title>
<path fill="none" stroke="black" d="M2733,-17167.38C2733,-17159.09 2733,-17149.7 2733,-17140.8"/>
<polygon fill="black" stroke="black" points="2736.5,-17140.65 2733,-17130.65 2729.5,-17140.65 2736.5,-17140.65"/>
</g>
<!-- gpu4_layer3_res1 -->
<g id="node1099" class="node">
<title>gpu4_layer3_res1</title>
<polygon fill="lightblue" stroke="black" points="2794,-16931.01 2672,-16931.01 2672,-16879.01 2794,-16879.01 2794,-16931.01"/>
<text text-anchor="middle" x="2733" y="-16919.01" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2733" y="-16908.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-16897.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-16886.01" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer3_kv_update&#45;&gt;gpu4_layer3_res1 -->
<g id="edge1370" class="edge">
<title>gpu4_layer3_kv_update&#45;&gt;gpu4_layer3_res1</title>
<path fill="none" stroke="black" d="M2733,-16967.93C2733,-16959.25 2733,-16949.98 2733,-16941.32"/>
<polygon fill="black" stroke="black" points="2736.5,-16941.15 2733,-16931.15 2729.5,-16941.15 2736.5,-16941.15"/>
</g>
<!-- gpu4_layer3_ln2 -->
<g id="node1100" class="node">
<title>gpu4_layer3_ln2</title>
<polygon fill="lightblue" stroke="black" points="2794,-16842.01 2672,-16842.01 2672,-16790.01 2794,-16790.01 2794,-16842.01"/>
<text text-anchor="middle" x="2733" y="-16830.01" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2733" y="-16819.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-16808.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-16797.01" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer3_res1&#45;&gt;gpu4_layer3_ln2 -->
<g id="edge1371" class="edge">
<title>gpu4_layer3_res1&#45;&gt;gpu4_layer3_ln2</title>
<path fill="none" stroke="black" d="M2733,-16878.84C2733,-16870.55 2733,-16861.16 2733,-16852.26"/>
<polygon fill="black" stroke="black" points="2736.5,-16852.12 2733,-16842.12 2729.5,-16852.12 2736.5,-16852.12"/>
</g>
<!-- gpu4_layer3_routing -->
<g id="node1101" class="node">
<title>gpu4_layer3_routing</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-16753.01 2658.29,-16753.01 2606.53,-16627.01 2807.71,-16627.01 2859.47,-16753.01"/>
<text text-anchor="middle" x="2733" y="-16709.51" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2733" y="-16698.51" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-16687.51" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-16676.51" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2733" y="-16665.51" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer3_ln2&#45;&gt;gpu4_layer3_routing -->
<g id="edge1372" class="edge">
<title>gpu4_layer3_ln2&#45;&gt;gpu4_layer3_routing</title>
<path fill="none" stroke="black" d="M2733,-16789.92C2733,-16781.98 2733,-16772.79 2733,-16763.26"/>
<polygon fill="black" stroke="black" points="2736.5,-16763.24 2733,-16753.24 2729.5,-16763.24 2736.5,-16763.24"/>
</g>
<!-- gpu4_layer3_expert0 -->
<g id="node1102" class="node">
<title>gpu4_layer3_expert0</title>
<polygon fill="lightblue" stroke="black" points="2514,-16581.01 2392,-16581.01 2392,-16529.01 2514,-16529.01 2514,-16581.01"/>
<text text-anchor="middle" x="2453" y="-16569.01" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="2453" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer3_routing&#45;&gt;gpu4_layer3_expert0 -->
<g id="edge1359" class="edge">
<title>gpu4_layer3_routing&#45;&gt;gpu4_layer3_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2607.33,-16629.32C2575.34,-16614.12 2542.34,-16598.44 2515.11,-16585.51"/>
<polygon fill="black" stroke="black" points="2516.26,-16582.18 2505.73,-16581.05 2513.26,-16588.51 2516.26,-16582.18"/>
<text text-anchor="middle" x="2588.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer3_expert1 -->
<g id="node1103" class="node">
<title>gpu4_layer3_expert1</title>
<polygon fill="lightblue" stroke="black" points="2654,-16581.01 2532,-16581.01 2532,-16529.01 2654,-16529.01 2654,-16581.01"/>
<text text-anchor="middle" x="2593" y="-16569.01" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="2593" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer3_routing&#45;&gt;gpu4_layer3_expert1 -->
<g id="edge1360" class="edge">
<title>gpu4_layer3_routing&#45;&gt;gpu4_layer3_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2667.51,-16626.79C2653.48,-16613.47 2639.21,-16599.91 2626.97,-16588.28"/>
<polygon fill="black" stroke="black" points="2629.29,-16585.65 2619.63,-16581.3 2624.46,-16590.73 2629.29,-16585.65"/>
<text text-anchor="middle" x="2675.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer3_expert2 -->
<g id="node1104" class="node">
<title>gpu4_layer3_expert2</title>
<polygon fill="lightblue" stroke="black" points="2794,-16581.01 2672,-16581.01 2672,-16529.01 2794,-16529.01 2794,-16581.01"/>
<text text-anchor="middle" x="2733" y="-16569.01" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2733" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer3_routing&#45;&gt;gpu4_layer3_expert2 -->
<g id="edge1361" class="edge">
<title>gpu4_layer3_routing&#45;&gt;gpu4_layer3_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2733,-16626.79C2733,-16614.72 2733,-16602.47 2733,-16591.62"/>
<polygon fill="black" stroke="black" points="2736.5,-16591.3 2733,-16581.3 2729.5,-16591.3 2736.5,-16591.3"/>
<text text-anchor="middle" x="2762.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer3_expert3 -->
<g id="node1105" class="node">
<title>gpu4_layer3_expert3</title>
<polygon fill="lightblue" stroke="black" points="2934,-16581.01 2812,-16581.01 2812,-16529.01 2934,-16529.01 2934,-16581.01"/>
<text text-anchor="middle" x="2873" y="-16569.01" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2873" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer3_routing&#45;&gt;gpu4_layer3_expert3 -->
<g id="edge1362" class="edge">
<title>gpu4_layer3_routing&#45;&gt;gpu4_layer3_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2798.49,-16626.79C2812.52,-16613.47 2826.79,-16599.91 2839.03,-16588.28"/>
<polygon fill="black" stroke="black" points="2841.54,-16590.73 2846.37,-16581.3 2836.71,-16585.65 2841.54,-16590.73"/>
<text text-anchor="middle" x="2856.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer3_expert_agg -->
<g id="node1106" class="node">
<title>gpu4_layer3_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-16492.01 2658.29,-16492.01 2606.53,-16388.01 2807.71,-16388.01 2859.47,-16492.01"/>
<text text-anchor="middle" x="2733" y="-16454.01" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2733" y="-16443.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-16432.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-16421.01" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer3_routing&#45;&gt;gpu4_layer3_expert_agg -->
<g id="edge1377" class="edge">
<title>gpu4_layer3_routing&#45;&gt;gpu4_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M2822.22,-16662.09C2895.96,-16634.93 2982.6,-16588.54 2943,-16529.01 2922.44,-16498.1 2888.7,-16478.02 2854.22,-16464.99"/>
<polygon fill="black" stroke="black" points="2855.08,-16461.58 2844.48,-16461.5 2852.71,-16468.17 2855.08,-16461.58"/>
</g>
<!-- gpu4_layer3_expert0&#45;&gt;gpu4_layer3_expert_agg -->
<g id="edge1373" class="edge">
<title>gpu4_layer3_expert0&#45;&gt;gpu4_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M2514.1,-16529.35C2550.98,-16514.47 2598.7,-16495.21 2640.16,-16478.47"/>
<polygon fill="black" stroke="black" points="2641.5,-16481.71 2649.46,-16474.72 2638.88,-16475.22 2641.5,-16481.71"/>
</g>
<!-- gpu4_layer3_expert1&#45;&gt;gpu4_layer3_expert_agg -->
<g id="edge1374" class="edge">
<title>gpu4_layer3_expert1&#45;&gt;gpu4_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M2624.07,-16528.93C2635.32,-16519.85 2648.53,-16509.19 2661.8,-16498.48"/>
<polygon fill="black" stroke="black" points="2664.02,-16501.18 2669.6,-16492.18 2659.62,-16495.74 2664.02,-16501.18"/>
</g>
<!-- gpu4_layer3_expert2&#45;&gt;gpu4_layer3_expert_agg -->
<g id="edge1375" class="edge">
<title>gpu4_layer3_expert2&#45;&gt;gpu4_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M2733,-16528.93C2733,-16521 2733,-16511.87 2733,-16502.55"/>
<polygon fill="black" stroke="black" points="2736.5,-16502.41 2733,-16492.41 2729.5,-16502.41 2736.5,-16502.41"/>
</g>
<!-- gpu4_layer3_expert3&#45;&gt;gpu4_layer3_expert_agg -->
<g id="edge1376" class="edge">
<title>gpu4_layer3_expert3&#45;&gt;gpu4_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M2841.93,-16528.93C2830.68,-16519.85 2817.47,-16509.19 2804.2,-16498.48"/>
<polygon fill="black" stroke="black" points="2806.38,-16495.74 2796.4,-16492.18 2801.98,-16501.18 2806.38,-16495.74"/>
</g>
<!-- gpu4_layer3_res2 -->
<g id="node1107" class="node">
<title>gpu4_layer3_res2</title>
<polygon fill="lightblue" stroke="black" points="2794,-16351.01 2672,-16351.01 2672,-16299.01 2794,-16299.01 2794,-16351.01"/>
<text text-anchor="middle" x="2733" y="-16339.01" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2733" y="-16328.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-16317.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-16306.01" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer3_expert_agg&#45;&gt;gpu4_layer3_res2 -->
<g id="edge1378" class="edge">
<title>gpu4_layer3_expert_agg&#45;&gt;gpu4_layer3_res2</title>
<path fill="none" stroke="black" d="M2733,-16387.8C2733,-16378.85 2733,-16369.72 2733,-16361.32"/>
<polygon fill="black" stroke="black" points="2736.5,-16361.14 2733,-16351.14 2729.5,-16361.14 2736.5,-16361.14"/>
</g>
<!-- gpu4_layer4_ln1 -->
<g id="node1108" class="node">
<title>gpu4_layer4_ln1</title>
<polygon fill="lightblue" stroke="black" points="2794,-16262.01 2672,-16262.01 2672,-16210.01 2794,-16210.01 2794,-16262.01"/>
<text text-anchor="middle" x="2733" y="-16250.01" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2733" y="-16239.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-16228.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-16217.01" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer3_res2&#45;&gt;gpu4_layer4_ln1 -->
<g id="edge1383" class="edge">
<title>gpu4_layer3_res2&#45;&gt;gpu4_layer4_ln1</title>
<path fill="none" stroke="black" d="M2733,-16298.84C2733,-16290.55 2733,-16281.16 2733,-16272.26"/>
<polygon fill="black" stroke="black" points="2736.5,-16272.12 2733,-16262.12 2729.5,-16272.12 2736.5,-16272.12"/>
</g>
<!-- gpu4_layer4_qkv -->
<g id="node1109" class="node">
<title>gpu4_layer4_qkv</title>
<polygon fill="lightblue" stroke="black" points="2794,-16173.01 2672,-16173.01 2672,-16121.01 2794,-16121.01 2794,-16173.01"/>
<text text-anchor="middle" x="2733" y="-16161.01" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2733" y="-16150.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-16139.01" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-16128.01" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer4_ln1&#45;&gt;gpu4_layer4_qkv -->
<g id="edge1384" class="edge">
<title>gpu4_layer4_ln1&#45;&gt;gpu4_layer4_qkv</title>
<path fill="none" stroke="black" d="M2733,-16209.84C2733,-16201.55 2733,-16192.16 2733,-16183.26"/>
<polygon fill="black" stroke="black" points="2736.5,-16183.12 2733,-16173.12 2729.5,-16183.12 2736.5,-16183.12"/>
</g>
<!-- gpu4_layer4_reshape -->
<g id="node1110" class="node">
<title>gpu4_layer4_reshape</title>
<polygon fill="lightblue" stroke="black" points="2797,-16084.01 2669,-16084.01 2669,-16032.01 2797,-16032.01 2797,-16084.01"/>
<text text-anchor="middle" x="2733" y="-16072.01" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2733" y="-16061.01" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-16050.01" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-16039.01" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer4_qkv&#45;&gt;gpu4_layer4_reshape -->
<g id="edge1385" class="edge">
<title>gpu4_layer4_qkv&#45;&gt;gpu4_layer4_reshape</title>
<path fill="none" stroke="black" d="M2733,-16120.84C2733,-16112.55 2733,-16103.16 2733,-16094.26"/>
<polygon fill="black" stroke="black" points="2736.5,-16094.12 2733,-16084.12 2729.5,-16094.12 2736.5,-16094.12"/>
</g>
<!-- gpu4_layer4_attn -->
<g id="node1111" class="node">
<title>gpu4_layer4_attn</title>
<polygon fill="lightblue" stroke="black" points="2797,-15995.01 2669,-15995.01 2669,-15943.01 2797,-15943.01 2797,-15995.01"/>
<text text-anchor="middle" x="2733" y="-15983.01" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2733" y="-15972.01" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-15961.01" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-15950.01" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer4_reshape&#45;&gt;gpu4_layer4_attn -->
<g id="edge1386" class="edge">
<title>gpu4_layer4_reshape&#45;&gt;gpu4_layer4_attn</title>
<path fill="none" stroke="black" d="M2733,-16031.84C2733,-16023.55 2733,-16014.16 2733,-16005.26"/>
<polygon fill="black" stroke="black" points="2736.5,-16005.12 2733,-15995.12 2729.5,-16005.12 2736.5,-16005.12"/>
</g>
<!-- gpu4_layer4_attn_reshape -->
<g id="node1113" class="node">
<title>gpu4_layer4_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2794,-15906.01 2672,-15906.01 2672,-15854.01 2794,-15854.01 2794,-15906.01"/>
<text text-anchor="middle" x="2733" y="-15894.01" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2733" y="-15883.01" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-15872.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-15861.01" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer4_attn&#45;&gt;gpu4_layer4_attn_reshape -->
<g id="edge1387" class="edge">
<title>gpu4_layer4_attn&#45;&gt;gpu4_layer4_attn_reshape</title>
<path fill="none" stroke="black" d="M2733,-15942.84C2733,-15934.55 2733,-15925.16 2733,-15916.26"/>
<polygon fill="black" stroke="black" points="2736.5,-15916.12 2733,-15906.12 2729.5,-15916.12 2736.5,-15916.12"/>
</g>
<!-- gpu4_layer4_attn_out -->
<g id="node1112" class="node">
<title>gpu4_layer4_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2794,-15817.01 2672,-15817.01 2672,-15765.01 2794,-15765.01 2794,-15817.01"/>
<text text-anchor="middle" x="2733" y="-15805.01" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2733" y="-15794.01" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-15783.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-15772.01" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer4_kv_update -->
<g id="node1114" class="node">
<title>gpu4_layer4_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2733" cy="-15691.24" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2733" y="-15705.24" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2733" y="-15694.24" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-15683.24" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-15672.24" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer4_attn_out&#45;&gt;gpu4_layer4_kv_update -->
<g id="edge1389" class="edge">
<title>gpu4_layer4_attn_out&#45;&gt;gpu4_layer4_kv_update</title>
<path fill="none" stroke="black" d="M2733,-15764.83C2733,-15756.69 2733,-15747.39 2733,-15738.23"/>
<polygon fill="black" stroke="black" points="2736.5,-15738.02 2733,-15728.02 2729.5,-15738.02 2736.5,-15738.02"/>
</g>
<!-- gpu4_layer4_attn_reshape&#45;&gt;gpu4_layer4_attn_out -->
<g id="edge1388" class="edge">
<title>gpu4_layer4_attn_reshape&#45;&gt;gpu4_layer4_attn_out</title>
<path fill="none" stroke="black" d="M2733,-15853.84C2733,-15845.55 2733,-15836.16 2733,-15827.26"/>
<polygon fill="black" stroke="black" points="2736.5,-15827.12 2733,-15817.12 2729.5,-15827.12 2736.5,-15827.12"/>
</g>
<!-- gpu4_layer4_res1 -->
<g id="node1115" class="node">
<title>gpu4_layer4_res1</title>
<polygon fill="lightblue" stroke="black" points="2794,-15617.47 2672,-15617.47 2672,-15565.47 2794,-15565.47 2794,-15617.47"/>
<text text-anchor="middle" x="2733" y="-15605.47" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2733" y="-15594.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-15583.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-15572.47" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer4_kv_update&#45;&gt;gpu4_layer4_res1 -->
<g id="edge1390" class="edge">
<title>gpu4_layer4_kv_update&#45;&gt;gpu4_layer4_res1</title>
<path fill="none" stroke="black" d="M2733,-15654.39C2733,-15645.71 2733,-15636.44 2733,-15627.78"/>
<polygon fill="black" stroke="black" points="2736.5,-15627.62 2733,-15617.62 2729.5,-15627.62 2736.5,-15627.62"/>
</g>
<!-- gpu4_layer4_ln2 -->
<g id="node1116" class="node">
<title>gpu4_layer4_ln2</title>
<polygon fill="lightblue" stroke="black" points="2794,-15528.47 2672,-15528.47 2672,-15476.47 2794,-15476.47 2794,-15528.47"/>
<text text-anchor="middle" x="2733" y="-15516.47" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2733" y="-15505.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-15494.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-15483.47" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer4_res1&#45;&gt;gpu4_layer4_ln2 -->
<g id="edge1391" class="edge">
<title>gpu4_layer4_res1&#45;&gt;gpu4_layer4_ln2</title>
<path fill="none" stroke="black" d="M2733,-15565.31C2733,-15557.01 2733,-15547.62 2733,-15538.72"/>
<polygon fill="black" stroke="black" points="2736.5,-15538.58 2733,-15528.58 2729.5,-15538.58 2736.5,-15538.58"/>
</g>
<!-- gpu4_layer4_routing -->
<g id="node1117" class="node">
<title>gpu4_layer4_routing</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-15439.47 2658.29,-15439.47 2606.53,-15313.47 2807.71,-15313.47 2859.47,-15439.47"/>
<text text-anchor="middle" x="2733" y="-15395.97" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2733" y="-15384.97" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-15373.97" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-15362.97" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2733" y="-15351.97" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer4_ln2&#45;&gt;gpu4_layer4_routing -->
<g id="edge1392" class="edge">
<title>gpu4_layer4_ln2&#45;&gt;gpu4_layer4_routing</title>
<path fill="none" stroke="black" d="M2733,-15476.38C2733,-15468.45 2733,-15459.25 2733,-15449.72"/>
<polygon fill="black" stroke="black" points="2736.5,-15449.7 2733,-15439.7 2729.5,-15449.7 2736.5,-15449.7"/>
</g>
<!-- gpu4_layer4_expert0 -->
<g id="node1118" class="node">
<title>gpu4_layer4_expert0</title>
<polygon fill="lightblue" stroke="black" points="2514,-15267.47 2392,-15267.47 2392,-15215.47 2514,-15215.47 2514,-15267.47"/>
<text text-anchor="middle" x="2453" y="-15255.47" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="2453" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer4_routing&#45;&gt;gpu4_layer4_expert0 -->
<g id="edge1379" class="edge">
<title>gpu4_layer4_routing&#45;&gt;gpu4_layer4_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2607.33,-15315.78C2575.34,-15300.58 2542.34,-15284.91 2515.11,-15271.97"/>
<polygon fill="black" stroke="black" points="2516.26,-15268.64 2505.73,-15267.51 2513.26,-15274.97 2516.26,-15268.64"/>
<text text-anchor="middle" x="2588.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer4_expert1 -->
<g id="node1119" class="node">
<title>gpu4_layer4_expert1</title>
<polygon fill="lightblue" stroke="black" points="2654,-15267.47 2532,-15267.47 2532,-15215.47 2654,-15215.47 2654,-15267.47"/>
<text text-anchor="middle" x="2593" y="-15255.47" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="2593" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer4_routing&#45;&gt;gpu4_layer4_expert1 -->
<g id="edge1380" class="edge">
<title>gpu4_layer4_routing&#45;&gt;gpu4_layer4_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2667.51,-15313.25C2653.48,-15299.93 2639.21,-15286.37 2626.97,-15274.74"/>
<polygon fill="black" stroke="black" points="2629.29,-15272.11 2619.63,-15267.76 2624.46,-15277.19 2629.29,-15272.11"/>
<text text-anchor="middle" x="2675.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer4_expert2 -->
<g id="node1120" class="node">
<title>gpu4_layer4_expert2</title>
<polygon fill="lightblue" stroke="black" points="2794,-15267.47 2672,-15267.47 2672,-15215.47 2794,-15215.47 2794,-15267.47"/>
<text text-anchor="middle" x="2733" y="-15255.47" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2733" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer4_routing&#45;&gt;gpu4_layer4_expert2 -->
<g id="edge1381" class="edge">
<title>gpu4_layer4_routing&#45;&gt;gpu4_layer4_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2733,-15313.25C2733,-15301.18 2733,-15288.93 2733,-15278.08"/>
<polygon fill="black" stroke="black" points="2736.5,-15277.76 2733,-15267.76 2729.5,-15277.76 2736.5,-15277.76"/>
<text text-anchor="middle" x="2762.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer4_expert3 -->
<g id="node1121" class="node">
<title>gpu4_layer4_expert3</title>
<polygon fill="lightblue" stroke="black" points="2934,-15267.47 2812,-15267.47 2812,-15215.47 2934,-15215.47 2934,-15267.47"/>
<text text-anchor="middle" x="2873" y="-15255.47" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2873" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer4_routing&#45;&gt;gpu4_layer4_expert3 -->
<g id="edge1382" class="edge">
<title>gpu4_layer4_routing&#45;&gt;gpu4_layer4_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2798.49,-15313.25C2812.52,-15299.93 2826.79,-15286.37 2839.03,-15274.74"/>
<polygon fill="black" stroke="black" points="2841.54,-15277.19 2846.37,-15267.76 2836.71,-15272.11 2841.54,-15277.19"/>
<text text-anchor="middle" x="2856.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer4_expert_agg -->
<g id="node1122" class="node">
<title>gpu4_layer4_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-15178.47 2658.29,-15178.47 2606.53,-15074.47 2807.71,-15074.47 2859.47,-15178.47"/>
<text text-anchor="middle" x="2733" y="-15140.47" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2733" y="-15129.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-15118.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-15107.47" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer4_routing&#45;&gt;gpu4_layer4_expert_agg -->
<g id="edge1397" class="edge">
<title>gpu4_layer4_routing&#45;&gt;gpu4_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M2822.22,-15348.55C2895.96,-15321.39 2982.6,-15275 2943,-15215.47 2922.44,-15184.56 2888.7,-15164.48 2854.22,-15151.45"/>
<polygon fill="black" stroke="black" points="2855.08,-15148.04 2844.48,-15147.96 2852.71,-15154.63 2855.08,-15148.04"/>
</g>
<!-- gpu4_layer4_expert0&#45;&gt;gpu4_layer4_expert_agg -->
<g id="edge1393" class="edge">
<title>gpu4_layer4_expert0&#45;&gt;gpu4_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M2514.1,-15215.81C2550.98,-15200.93 2598.7,-15181.67 2640.16,-15164.94"/>
<polygon fill="black" stroke="black" points="2641.5,-15168.17 2649.46,-15161.18 2638.88,-15161.68 2641.5,-15168.17"/>
</g>
<!-- gpu4_layer4_expert1&#45;&gt;gpu4_layer4_expert_agg -->
<g id="edge1394" class="edge">
<title>gpu4_layer4_expert1&#45;&gt;gpu4_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M2624.07,-15215.39C2635.32,-15206.31 2648.53,-15195.65 2661.8,-15184.94"/>
<polygon fill="black" stroke="black" points="2664.02,-15187.64 2669.6,-15178.64 2659.62,-15182.2 2664.02,-15187.64"/>
</g>
<!-- gpu4_layer4_expert2&#45;&gt;gpu4_layer4_expert_agg -->
<g id="edge1395" class="edge">
<title>gpu4_layer4_expert2&#45;&gt;gpu4_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M2733,-15215.39C2733,-15207.46 2733,-15198.33 2733,-15189.01"/>
<polygon fill="black" stroke="black" points="2736.5,-15188.87 2733,-15178.87 2729.5,-15188.87 2736.5,-15188.87"/>
</g>
<!-- gpu4_layer4_expert3&#45;&gt;gpu4_layer4_expert_agg -->
<g id="edge1396" class="edge">
<title>gpu4_layer4_expert3&#45;&gt;gpu4_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M2841.93,-15215.39C2830.68,-15206.31 2817.47,-15195.65 2804.2,-15184.94"/>
<polygon fill="black" stroke="black" points="2806.38,-15182.2 2796.4,-15178.64 2801.98,-15187.64 2806.38,-15182.2"/>
</g>
<!-- gpu4_layer4_res2 -->
<g id="node1123" class="node">
<title>gpu4_layer4_res2</title>
<polygon fill="lightblue" stroke="black" points="2794,-15037.47 2672,-15037.47 2672,-14985.47 2794,-14985.47 2794,-15037.47"/>
<text text-anchor="middle" x="2733" y="-15025.47" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2733" y="-15014.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-15003.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-14992.47" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer4_expert_agg&#45;&gt;gpu4_layer4_res2 -->
<g id="edge1398" class="edge">
<title>gpu4_layer4_expert_agg&#45;&gt;gpu4_layer4_res2</title>
<path fill="none" stroke="black" d="M2733,-15074.26C2733,-15065.31 2733,-15056.18 2733,-15047.78"/>
<polygon fill="black" stroke="black" points="2736.5,-15047.6 2733,-15037.6 2729.5,-15047.6 2736.5,-15047.6"/>
</g>
<!-- gpu4_layer5_ln1 -->
<g id="node1124" class="node">
<title>gpu4_layer5_ln1</title>
<polygon fill="lightblue" stroke="black" points="2794,-14948.47 2672,-14948.47 2672,-14896.47 2794,-14896.47 2794,-14948.47"/>
<text text-anchor="middle" x="2733" y="-14936.47" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2733" y="-14925.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-14914.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-14903.47" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer4_res2&#45;&gt;gpu4_layer5_ln1 -->
<g id="edge1403" class="edge">
<title>gpu4_layer4_res2&#45;&gt;gpu4_layer5_ln1</title>
<path fill="none" stroke="black" d="M2733,-14985.31C2733,-14977.01 2733,-14967.62 2733,-14958.72"/>
<polygon fill="black" stroke="black" points="2736.5,-14958.58 2733,-14948.58 2729.5,-14958.58 2736.5,-14958.58"/>
</g>
<!-- gpu4_layer5_qkv -->
<g id="node1125" class="node">
<title>gpu4_layer5_qkv</title>
<polygon fill="lightblue" stroke="black" points="2794,-14859.47 2672,-14859.47 2672,-14807.47 2794,-14807.47 2794,-14859.47"/>
<text text-anchor="middle" x="2733" y="-14847.47" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2733" y="-14836.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-14825.47" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-14814.47" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer5_ln1&#45;&gt;gpu4_layer5_qkv -->
<g id="edge1404" class="edge">
<title>gpu4_layer5_ln1&#45;&gt;gpu4_layer5_qkv</title>
<path fill="none" stroke="black" d="M2733,-14896.31C2733,-14888.01 2733,-14878.62 2733,-14869.72"/>
<polygon fill="black" stroke="black" points="2736.5,-14869.58 2733,-14859.58 2729.5,-14869.58 2736.5,-14869.58"/>
</g>
<!-- gpu4_layer5_reshape -->
<g id="node1126" class="node">
<title>gpu4_layer5_reshape</title>
<polygon fill="lightblue" stroke="black" points="2797,-14770.47 2669,-14770.47 2669,-14718.47 2797,-14718.47 2797,-14770.47"/>
<text text-anchor="middle" x="2733" y="-14758.47" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2733" y="-14747.47" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-14736.47" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-14725.47" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer5_qkv&#45;&gt;gpu4_layer5_reshape -->
<g id="edge1405" class="edge">
<title>gpu4_layer5_qkv&#45;&gt;gpu4_layer5_reshape</title>
<path fill="none" stroke="black" d="M2733,-14807.31C2733,-14799.01 2733,-14789.62 2733,-14780.72"/>
<polygon fill="black" stroke="black" points="2736.5,-14780.58 2733,-14770.58 2729.5,-14780.58 2736.5,-14780.58"/>
</g>
<!-- gpu4_layer5_attn -->
<g id="node1127" class="node">
<title>gpu4_layer5_attn</title>
<polygon fill="lightblue" stroke="black" points="2797,-14681.47 2669,-14681.47 2669,-14629.47 2797,-14629.47 2797,-14681.47"/>
<text text-anchor="middle" x="2733" y="-14669.47" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2733" y="-14658.47" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-14647.47" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-14636.47" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer5_reshape&#45;&gt;gpu4_layer5_attn -->
<g id="edge1406" class="edge">
<title>gpu4_layer5_reshape&#45;&gt;gpu4_layer5_attn</title>
<path fill="none" stroke="black" d="M2733,-14718.31C2733,-14710.01 2733,-14700.62 2733,-14691.72"/>
<polygon fill="black" stroke="black" points="2736.5,-14691.58 2733,-14681.58 2729.5,-14691.58 2736.5,-14691.58"/>
</g>
<!-- gpu4_layer5_attn_reshape -->
<g id="node1129" class="node">
<title>gpu4_layer5_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2794,-14592.47 2672,-14592.47 2672,-14540.47 2794,-14540.47 2794,-14592.47"/>
<text text-anchor="middle" x="2733" y="-14580.47" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2733" y="-14569.47" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-14558.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-14547.47" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer5_attn&#45;&gt;gpu4_layer5_attn_reshape -->
<g id="edge1407" class="edge">
<title>gpu4_layer5_attn&#45;&gt;gpu4_layer5_attn_reshape</title>
<path fill="none" stroke="black" d="M2733,-14629.31C2733,-14621.01 2733,-14611.62 2733,-14602.72"/>
<polygon fill="black" stroke="black" points="2736.5,-14602.58 2733,-14592.58 2729.5,-14602.58 2736.5,-14602.58"/>
</g>
<!-- gpu4_layer5_attn_out -->
<g id="node1128" class="node">
<title>gpu4_layer5_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2794,-14503.47 2672,-14503.47 2672,-14451.47 2794,-14451.47 2794,-14503.47"/>
<text text-anchor="middle" x="2733" y="-14491.47" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2733" y="-14480.47" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-14469.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-14458.47" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer5_kv_update -->
<g id="node1130" class="node">
<title>gpu4_layer5_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2733" cy="-14377.7" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2733" y="-14391.7" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2733" y="-14380.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-14369.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-14358.7" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer5_attn_out&#45;&gt;gpu4_layer5_kv_update -->
<g id="edge1409" class="edge">
<title>gpu4_layer5_attn_out&#45;&gt;gpu4_layer5_kv_update</title>
<path fill="none" stroke="black" d="M2733,-14451.29C2733,-14443.15 2733,-14433.86 2733,-14424.69"/>
<polygon fill="black" stroke="black" points="2736.5,-14424.48 2733,-14414.48 2729.5,-14424.48 2736.5,-14424.48"/>
</g>
<!-- gpu4_layer5_attn_reshape&#45;&gt;gpu4_layer5_attn_out -->
<g id="edge1408" class="edge">
<title>gpu4_layer5_attn_reshape&#45;&gt;gpu4_layer5_attn_out</title>
<path fill="none" stroke="black" d="M2733,-14540.31C2733,-14532.01 2733,-14522.62 2733,-14513.72"/>
<polygon fill="black" stroke="black" points="2736.5,-14513.58 2733,-14503.58 2729.5,-14513.58 2736.5,-14513.58"/>
</g>
<!-- gpu4_layer5_res1 -->
<g id="node1131" class="node">
<title>gpu4_layer5_res1</title>
<polygon fill="lightblue" stroke="black" points="2794,-14303.93 2672,-14303.93 2672,-14251.93 2794,-14251.93 2794,-14303.93"/>
<text text-anchor="middle" x="2733" y="-14291.93" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2733" y="-14280.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-14269.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-14258.93" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer5_kv_update&#45;&gt;gpu4_layer5_res1 -->
<g id="edge1410" class="edge">
<title>gpu4_layer5_kv_update&#45;&gt;gpu4_layer5_res1</title>
<path fill="none" stroke="black" d="M2733,-14340.85C2733,-14332.17 2733,-14322.9 2733,-14314.25"/>
<polygon fill="black" stroke="black" points="2736.5,-14314.08 2733,-14304.08 2729.5,-14314.08 2736.5,-14314.08"/>
</g>
<!-- gpu4_layer5_ln2 -->
<g id="node1132" class="node">
<title>gpu4_layer5_ln2</title>
<polygon fill="lightblue" stroke="black" points="2794,-14214.93 2672,-14214.93 2672,-14162.93 2794,-14162.93 2794,-14214.93"/>
<text text-anchor="middle" x="2733" y="-14202.93" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2733" y="-14191.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-14180.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-14169.93" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer5_res1&#45;&gt;gpu4_layer5_ln2 -->
<g id="edge1411" class="edge">
<title>gpu4_layer5_res1&#45;&gt;gpu4_layer5_ln2</title>
<path fill="none" stroke="black" d="M2733,-14251.77C2733,-14243.47 2733,-14234.08 2733,-14225.18"/>
<polygon fill="black" stroke="black" points="2736.5,-14225.04 2733,-14215.04 2729.5,-14225.04 2736.5,-14225.04"/>
</g>
<!-- gpu4_layer5_routing -->
<g id="node1133" class="node">
<title>gpu4_layer5_routing</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-14125.93 2658.29,-14125.93 2606.53,-13999.93 2807.71,-13999.93 2859.47,-14125.93"/>
<text text-anchor="middle" x="2733" y="-14082.43" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2733" y="-14071.43" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-14060.43" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-14049.43" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2733" y="-14038.43" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer5_ln2&#45;&gt;gpu4_layer5_routing -->
<g id="edge1412" class="edge">
<title>gpu4_layer5_ln2&#45;&gt;gpu4_layer5_routing</title>
<path fill="none" stroke="black" d="M2733,-14162.84C2733,-14154.91 2733,-14145.71 2733,-14136.18"/>
<polygon fill="black" stroke="black" points="2736.5,-14136.17 2733,-14126.17 2729.5,-14136.17 2736.5,-14136.17"/>
</g>
<!-- gpu4_layer5_expert0 -->
<g id="node1134" class="node">
<title>gpu4_layer5_expert0</title>
<polygon fill="lightblue" stroke="black" points="2514,-13953.93 2392,-13953.93 2392,-13901.93 2514,-13901.93 2514,-13953.93"/>
<text text-anchor="middle" x="2453" y="-13941.93" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="2453" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer5_routing&#45;&gt;gpu4_layer5_expert0 -->
<g id="edge1399" class="edge">
<title>gpu4_layer5_routing&#45;&gt;gpu4_layer5_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2607.33,-14002.24C2575.34,-13987.04 2542.34,-13971.37 2515.11,-13958.43"/>
<polygon fill="black" stroke="black" points="2516.26,-13955.1 2505.73,-13953.98 2513.26,-13961.43 2516.26,-13955.1"/>
<text text-anchor="middle" x="2588.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer5_expert1 -->
<g id="node1135" class="node">
<title>gpu4_layer5_expert1</title>
<polygon fill="lightblue" stroke="black" points="2654,-13953.93 2532,-13953.93 2532,-13901.93 2654,-13901.93 2654,-13953.93"/>
<text text-anchor="middle" x="2593" y="-13941.93" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="2593" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer5_routing&#45;&gt;gpu4_layer5_expert1 -->
<g id="edge1400" class="edge">
<title>gpu4_layer5_routing&#45;&gt;gpu4_layer5_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2667.51,-13999.71C2653.48,-13986.39 2639.21,-13972.83 2626.97,-13961.2"/>
<polygon fill="black" stroke="black" points="2629.29,-13958.57 2619.63,-13954.22 2624.46,-13963.65 2629.29,-13958.57"/>
<text text-anchor="middle" x="2675.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer5_expert2 -->
<g id="node1136" class="node">
<title>gpu4_layer5_expert2</title>
<polygon fill="lightblue" stroke="black" points="2794,-13953.93 2672,-13953.93 2672,-13901.93 2794,-13901.93 2794,-13953.93"/>
<text text-anchor="middle" x="2733" y="-13941.93" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2733" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer5_routing&#45;&gt;gpu4_layer5_expert2 -->
<g id="edge1401" class="edge">
<title>gpu4_layer5_routing&#45;&gt;gpu4_layer5_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2733,-13999.71C2733,-13987.65 2733,-13975.39 2733,-13964.54"/>
<polygon fill="black" stroke="black" points="2736.5,-13964.22 2733,-13954.22 2729.5,-13964.22 2736.5,-13964.22"/>
<text text-anchor="middle" x="2762.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer5_expert3 -->
<g id="node1137" class="node">
<title>gpu4_layer5_expert3</title>
<polygon fill="lightblue" stroke="black" points="2934,-13953.93 2812,-13953.93 2812,-13901.93 2934,-13901.93 2934,-13953.93"/>
<text text-anchor="middle" x="2873" y="-13941.93" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2873" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer5_routing&#45;&gt;gpu4_layer5_expert3 -->
<g id="edge1402" class="edge">
<title>gpu4_layer5_routing&#45;&gt;gpu4_layer5_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2798.49,-13999.71C2812.52,-13986.39 2826.79,-13972.83 2839.03,-13961.2"/>
<polygon fill="black" stroke="black" points="2841.54,-13963.65 2846.37,-13954.22 2836.71,-13958.57 2841.54,-13963.65"/>
<text text-anchor="middle" x="2856.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer5_expert_agg -->
<g id="node1138" class="node">
<title>gpu4_layer5_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-13864.93 2658.29,-13864.93 2606.53,-13760.93 2807.71,-13760.93 2859.47,-13864.93"/>
<text text-anchor="middle" x="2733" y="-13826.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2733" y="-13815.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-13804.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-13793.93" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer5_routing&#45;&gt;gpu4_layer5_expert_agg -->
<g id="edge1417" class="edge">
<title>gpu4_layer5_routing&#45;&gt;gpu4_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M2822.22,-14035.01C2895.96,-14007.85 2982.6,-13961.46 2943,-13901.93 2922.44,-13871.02 2888.7,-13850.94 2854.22,-13837.91"/>
<polygon fill="black" stroke="black" points="2855.08,-13834.5 2844.48,-13834.42 2852.71,-13841.09 2855.08,-13834.5"/>
</g>
<!-- gpu4_layer5_expert0&#45;&gt;gpu4_layer5_expert_agg -->
<g id="edge1413" class="edge">
<title>gpu4_layer5_expert0&#45;&gt;gpu4_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M2514.1,-13902.27C2550.98,-13887.39 2598.7,-13868.13 2640.16,-13851.4"/>
<polygon fill="black" stroke="black" points="2641.5,-13854.63 2649.46,-13847.65 2638.88,-13848.14 2641.5,-13854.63"/>
</g>
<!-- gpu4_layer5_expert1&#45;&gt;gpu4_layer5_expert_agg -->
<g id="edge1414" class="edge">
<title>gpu4_layer5_expert1&#45;&gt;gpu4_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M2624.07,-13901.85C2635.32,-13892.77 2648.53,-13882.11 2661.8,-13871.4"/>
<polygon fill="black" stroke="black" points="2664.02,-13874.11 2669.6,-13865.1 2659.62,-13868.66 2664.02,-13874.11"/>
</g>
<!-- gpu4_layer5_expert2&#45;&gt;gpu4_layer5_expert_agg -->
<g id="edge1415" class="edge">
<title>gpu4_layer5_expert2&#45;&gt;gpu4_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M2733,-13901.85C2733,-13893.93 2733,-13884.79 2733,-13875.47"/>
<polygon fill="black" stroke="black" points="2736.5,-13875.33 2733,-13865.33 2729.5,-13875.33 2736.5,-13875.33"/>
</g>
<!-- gpu4_layer5_expert3&#45;&gt;gpu4_layer5_expert_agg -->
<g id="edge1416" class="edge">
<title>gpu4_layer5_expert3&#45;&gt;gpu4_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M2841.93,-13901.85C2830.68,-13892.77 2817.47,-13882.11 2804.2,-13871.4"/>
<polygon fill="black" stroke="black" points="2806.38,-13868.66 2796.4,-13865.1 2801.98,-13874.11 2806.38,-13868.66"/>
</g>
<!-- gpu4_layer5_res2 -->
<g id="node1139" class="node">
<title>gpu4_layer5_res2</title>
<polygon fill="lightblue" stroke="black" points="2794,-13723.93 2672,-13723.93 2672,-13671.93 2794,-13671.93 2794,-13723.93"/>
<text text-anchor="middle" x="2733" y="-13711.93" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2733" y="-13700.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-13689.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-13678.93" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer5_expert_agg&#45;&gt;gpu4_layer5_res2 -->
<g id="edge1418" class="edge">
<title>gpu4_layer5_expert_agg&#45;&gt;gpu4_layer5_res2</title>
<path fill="none" stroke="black" d="M2733,-13760.72C2733,-13751.77 2733,-13742.64 2733,-13734.24"/>
<polygon fill="black" stroke="black" points="2736.5,-13734.06 2733,-13724.06 2729.5,-13734.06 2736.5,-13734.06"/>
</g>
<!-- gpu4_layer6_ln1 -->
<g id="node1140" class="node">
<title>gpu4_layer6_ln1</title>
<polygon fill="lightblue" stroke="black" points="2794,-13634.93 2672,-13634.93 2672,-13582.93 2794,-13582.93 2794,-13634.93"/>
<text text-anchor="middle" x="2733" y="-13622.93" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2733" y="-13611.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-13600.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-13589.93" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer5_res2&#45;&gt;gpu4_layer6_ln1 -->
<g id="edge1423" class="edge">
<title>gpu4_layer5_res2&#45;&gt;gpu4_layer6_ln1</title>
<path fill="none" stroke="black" d="M2733,-13671.77C2733,-13663.47 2733,-13654.08 2733,-13645.18"/>
<polygon fill="black" stroke="black" points="2736.5,-13645.04 2733,-13635.04 2729.5,-13645.04 2736.5,-13645.04"/>
</g>
<!-- gpu4_layer6_qkv -->
<g id="node1141" class="node">
<title>gpu4_layer6_qkv</title>
<polygon fill="lightblue" stroke="black" points="2794,-13545.93 2672,-13545.93 2672,-13493.93 2794,-13493.93 2794,-13545.93"/>
<text text-anchor="middle" x="2733" y="-13533.93" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2733" y="-13522.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-13511.93" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-13500.93" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer6_ln1&#45;&gt;gpu4_layer6_qkv -->
<g id="edge1424" class="edge">
<title>gpu4_layer6_ln1&#45;&gt;gpu4_layer6_qkv</title>
<path fill="none" stroke="black" d="M2733,-13582.77C2733,-13574.47 2733,-13565.08 2733,-13556.18"/>
<polygon fill="black" stroke="black" points="2736.5,-13556.04 2733,-13546.04 2729.5,-13556.04 2736.5,-13556.04"/>
</g>
<!-- gpu4_layer6_reshape -->
<g id="node1142" class="node">
<title>gpu4_layer6_reshape</title>
<polygon fill="lightblue" stroke="black" points="2797,-13456.93 2669,-13456.93 2669,-13404.93 2797,-13404.93 2797,-13456.93"/>
<text text-anchor="middle" x="2733" y="-13444.93" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2733" y="-13433.93" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-13422.93" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-13411.93" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer6_qkv&#45;&gt;gpu4_layer6_reshape -->
<g id="edge1425" class="edge">
<title>gpu4_layer6_qkv&#45;&gt;gpu4_layer6_reshape</title>
<path fill="none" stroke="black" d="M2733,-13493.77C2733,-13485.47 2733,-13476.08 2733,-13467.18"/>
<polygon fill="black" stroke="black" points="2736.5,-13467.04 2733,-13457.04 2729.5,-13467.04 2736.5,-13467.04"/>
</g>
<!-- gpu4_layer6_attn -->
<g id="node1143" class="node">
<title>gpu4_layer6_attn</title>
<polygon fill="lightblue" stroke="black" points="2797,-13367.93 2669,-13367.93 2669,-13315.93 2797,-13315.93 2797,-13367.93"/>
<text text-anchor="middle" x="2733" y="-13355.93" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2733" y="-13344.93" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-13333.93" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-13322.93" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer6_reshape&#45;&gt;gpu4_layer6_attn -->
<g id="edge1426" class="edge">
<title>gpu4_layer6_reshape&#45;&gt;gpu4_layer6_attn</title>
<path fill="none" stroke="black" d="M2733,-13404.77C2733,-13396.47 2733,-13387.08 2733,-13378.18"/>
<polygon fill="black" stroke="black" points="2736.5,-13378.04 2733,-13368.04 2729.5,-13378.04 2736.5,-13378.04"/>
</g>
<!-- gpu4_layer6_attn_reshape -->
<g id="node1145" class="node">
<title>gpu4_layer6_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2794,-13278.93 2672,-13278.93 2672,-13226.93 2794,-13226.93 2794,-13278.93"/>
<text text-anchor="middle" x="2733" y="-13266.93" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2733" y="-13255.93" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-13244.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-13233.93" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer6_attn&#45;&gt;gpu4_layer6_attn_reshape -->
<g id="edge1427" class="edge">
<title>gpu4_layer6_attn&#45;&gt;gpu4_layer6_attn_reshape</title>
<path fill="none" stroke="black" d="M2733,-13315.77C2733,-13307.47 2733,-13298.08 2733,-13289.18"/>
<polygon fill="black" stroke="black" points="2736.5,-13289.04 2733,-13279.04 2729.5,-13289.04 2736.5,-13289.04"/>
</g>
<!-- gpu4_layer6_attn_out -->
<g id="node1144" class="node">
<title>gpu4_layer6_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2794,-13189.93 2672,-13189.93 2672,-13137.93 2794,-13137.93 2794,-13189.93"/>
<text text-anchor="middle" x="2733" y="-13177.93" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2733" y="-13166.93" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-13155.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-13144.93" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer6_kv_update -->
<g id="node1146" class="node">
<title>gpu4_layer6_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2733" cy="-13064.16" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2733" y="-13078.16" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2733" y="-13067.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-13056.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-13045.16" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer6_attn_out&#45;&gt;gpu4_layer6_kv_update -->
<g id="edge1429" class="edge">
<title>gpu4_layer6_attn_out&#45;&gt;gpu4_layer6_kv_update</title>
<path fill="none" stroke="black" d="M2733,-13137.75C2733,-13129.61 2733,-13120.32 2733,-13111.16"/>
<polygon fill="black" stroke="black" points="2736.5,-13110.94 2733,-13100.94 2729.5,-13110.94 2736.5,-13110.94"/>
</g>
<!-- gpu4_layer6_attn_reshape&#45;&gt;gpu4_layer6_attn_out -->
<g id="edge1428" class="edge">
<title>gpu4_layer6_attn_reshape&#45;&gt;gpu4_layer6_attn_out</title>
<path fill="none" stroke="black" d="M2733,-13226.77C2733,-13218.47 2733,-13209.08 2733,-13200.18"/>
<polygon fill="black" stroke="black" points="2736.5,-13200.04 2733,-13190.04 2729.5,-13200.04 2736.5,-13200.04"/>
</g>
<!-- gpu4_layer6_res1 -->
<g id="node1147" class="node">
<title>gpu4_layer6_res1</title>
<polygon fill="lightblue" stroke="black" points="2794,-12990.39 2672,-12990.39 2672,-12938.39 2794,-12938.39 2794,-12990.39"/>
<text text-anchor="middle" x="2733" y="-12978.39" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2733" y="-12967.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-12956.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-12945.39" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer6_kv_update&#45;&gt;gpu4_layer6_res1 -->
<g id="edge1430" class="edge">
<title>gpu4_layer6_kv_update&#45;&gt;gpu4_layer6_res1</title>
<path fill="none" stroke="black" d="M2733,-13027.31C2733,-13018.63 2733,-13009.36 2733,-13000.71"/>
<polygon fill="black" stroke="black" points="2736.5,-13000.54 2733,-12990.54 2729.5,-13000.54 2736.5,-13000.54"/>
</g>
<!-- gpu4_layer6_ln2 -->
<g id="node1148" class="node">
<title>gpu4_layer6_ln2</title>
<polygon fill="lightblue" stroke="black" points="2794,-12901.39 2672,-12901.39 2672,-12849.39 2794,-12849.39 2794,-12901.39"/>
<text text-anchor="middle" x="2733" y="-12889.39" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2733" y="-12878.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-12867.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-12856.39" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer6_res1&#45;&gt;gpu4_layer6_ln2 -->
<g id="edge1431" class="edge">
<title>gpu4_layer6_res1&#45;&gt;gpu4_layer6_ln2</title>
<path fill="none" stroke="black" d="M2733,-12938.23C2733,-12929.93 2733,-12920.55 2733,-12911.64"/>
<polygon fill="black" stroke="black" points="2736.5,-12911.5 2733,-12901.5 2729.5,-12911.5 2736.5,-12911.5"/>
</g>
<!-- gpu4_layer6_routing -->
<g id="node1149" class="node">
<title>gpu4_layer6_routing</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-12812.39 2658.29,-12812.39 2606.53,-12686.39 2807.71,-12686.39 2859.47,-12812.39"/>
<text text-anchor="middle" x="2733" y="-12768.89" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2733" y="-12757.89" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-12746.89" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-12735.89" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2733" y="-12724.89" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer6_ln2&#45;&gt;gpu4_layer6_routing -->
<g id="edge1432" class="edge">
<title>gpu4_layer6_ln2&#45;&gt;gpu4_layer6_routing</title>
<path fill="none" stroke="black" d="M2733,-12849.3C2733,-12841.37 2733,-12832.17 2733,-12822.64"/>
<polygon fill="black" stroke="black" points="2736.5,-12822.63 2733,-12812.63 2729.5,-12822.63 2736.5,-12822.63"/>
</g>
<!-- gpu4_layer6_expert0 -->
<g id="node1150" class="node">
<title>gpu4_layer6_expert0</title>
<polygon fill="lightblue" stroke="black" points="2514,-12640.39 2392,-12640.39 2392,-12588.39 2514,-12588.39 2514,-12640.39"/>
<text text-anchor="middle" x="2453" y="-12628.39" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="2453" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer6_routing&#45;&gt;gpu4_layer6_expert0 -->
<g id="edge1419" class="edge">
<title>gpu4_layer6_routing&#45;&gt;gpu4_layer6_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2607.33,-12688.7C2575.34,-12673.5 2542.34,-12657.83 2515.11,-12644.89"/>
<polygon fill="black" stroke="black" points="2516.26,-12641.57 2505.73,-12640.44 2513.26,-12647.89 2516.26,-12641.57"/>
<text text-anchor="middle" x="2588.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer6_expert1 -->
<g id="node1151" class="node">
<title>gpu4_layer6_expert1</title>
<polygon fill="lightblue" stroke="black" points="2654,-12640.39 2532,-12640.39 2532,-12588.39 2654,-12588.39 2654,-12640.39"/>
<text text-anchor="middle" x="2593" y="-12628.39" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="2593" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer6_routing&#45;&gt;gpu4_layer6_expert1 -->
<g id="edge1420" class="edge">
<title>gpu4_layer6_routing&#45;&gt;gpu4_layer6_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2667.51,-12686.17C2653.48,-12672.85 2639.21,-12659.29 2626.97,-12647.66"/>
<polygon fill="black" stroke="black" points="2629.29,-12645.03 2619.63,-12640.68 2624.46,-12650.11 2629.29,-12645.03"/>
<text text-anchor="middle" x="2675.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer6_expert2 -->
<g id="node1152" class="node">
<title>gpu4_layer6_expert2</title>
<polygon fill="lightblue" stroke="black" points="2794,-12640.39 2672,-12640.39 2672,-12588.39 2794,-12588.39 2794,-12640.39"/>
<text text-anchor="middle" x="2733" y="-12628.39" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2733" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer6_routing&#45;&gt;gpu4_layer6_expert2 -->
<g id="edge1421" class="edge">
<title>gpu4_layer6_routing&#45;&gt;gpu4_layer6_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2733,-12686.17C2733,-12674.11 2733,-12661.85 2733,-12651"/>
<polygon fill="black" stroke="black" points="2736.5,-12650.68 2733,-12640.68 2729.5,-12650.68 2736.5,-12650.68"/>
<text text-anchor="middle" x="2762.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer6_expert3 -->
<g id="node1153" class="node">
<title>gpu4_layer6_expert3</title>
<polygon fill="lightblue" stroke="black" points="2934,-12640.39 2812,-12640.39 2812,-12588.39 2934,-12588.39 2934,-12640.39"/>
<text text-anchor="middle" x="2873" y="-12628.39" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2873" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer6_routing&#45;&gt;gpu4_layer6_expert3 -->
<g id="edge1422" class="edge">
<title>gpu4_layer6_routing&#45;&gt;gpu4_layer6_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2798.49,-12686.17C2812.52,-12672.85 2826.79,-12659.29 2839.03,-12647.66"/>
<polygon fill="black" stroke="black" points="2841.54,-12650.11 2846.37,-12640.68 2836.71,-12645.03 2841.54,-12650.11"/>
<text text-anchor="middle" x="2856.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer6_expert_agg -->
<g id="node1154" class="node">
<title>gpu4_layer6_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-12551.39 2658.29,-12551.39 2606.53,-12447.39 2807.71,-12447.39 2859.47,-12551.39"/>
<text text-anchor="middle" x="2733" y="-12513.39" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2733" y="-12502.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-12491.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-12480.39" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer6_routing&#45;&gt;gpu4_layer6_expert_agg -->
<g id="edge1437" class="edge">
<title>gpu4_layer6_routing&#45;&gt;gpu4_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M2822.22,-12721.47C2895.96,-12694.32 2982.6,-12647.92 2943,-12588.39 2922.44,-12557.48 2888.7,-12537.4 2854.22,-12524.38"/>
<polygon fill="black" stroke="black" points="2855.08,-12520.97 2844.48,-12520.88 2852.71,-12527.55 2855.08,-12520.97"/>
</g>
<!-- gpu4_layer6_expert0&#45;&gt;gpu4_layer6_expert_agg -->
<g id="edge1433" class="edge">
<title>gpu4_layer6_expert0&#45;&gt;gpu4_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M2514.1,-12588.73C2550.98,-12573.85 2598.7,-12554.59 2640.16,-12537.86"/>
<polygon fill="black" stroke="black" points="2641.5,-12541.09 2649.46,-12534.11 2638.88,-12534.6 2641.5,-12541.09"/>
</g>
<!-- gpu4_layer6_expert1&#45;&gt;gpu4_layer6_expert_agg -->
<g id="edge1434" class="edge">
<title>gpu4_layer6_expert1&#45;&gt;gpu4_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M2624.07,-12588.31C2635.32,-12579.24 2648.53,-12568.57 2661.8,-12557.86"/>
<polygon fill="black" stroke="black" points="2664.02,-12560.57 2669.6,-12551.56 2659.62,-12555.12 2664.02,-12560.57"/>
</g>
<!-- gpu4_layer6_expert2&#45;&gt;gpu4_layer6_expert_agg -->
<g id="edge1435" class="edge">
<title>gpu4_layer6_expert2&#45;&gt;gpu4_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M2733,-12588.31C2733,-12580.39 2733,-12571.25 2733,-12561.93"/>
<polygon fill="black" stroke="black" points="2736.5,-12561.79 2733,-12551.79 2729.5,-12561.79 2736.5,-12561.79"/>
</g>
<!-- gpu4_layer6_expert3&#45;&gt;gpu4_layer6_expert_agg -->
<g id="edge1436" class="edge">
<title>gpu4_layer6_expert3&#45;&gt;gpu4_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M2841.93,-12588.31C2830.68,-12579.24 2817.47,-12568.57 2804.2,-12557.86"/>
<polygon fill="black" stroke="black" points="2806.38,-12555.12 2796.4,-12551.56 2801.98,-12560.57 2806.38,-12555.12"/>
</g>
<!-- gpu4_layer6_res2 -->
<g id="node1155" class="node">
<title>gpu4_layer6_res2</title>
<polygon fill="lightblue" stroke="black" points="2794,-12410.39 2672,-12410.39 2672,-12358.39 2794,-12358.39 2794,-12410.39"/>
<text text-anchor="middle" x="2733" y="-12398.39" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2733" y="-12387.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-12376.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-12365.39" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer6_expert_agg&#45;&gt;gpu4_layer6_res2 -->
<g id="edge1438" class="edge">
<title>gpu4_layer6_expert_agg&#45;&gt;gpu4_layer6_res2</title>
<path fill="none" stroke="black" d="M2733,-12447.18C2733,-12438.23 2733,-12429.1 2733,-12420.7"/>
<polygon fill="black" stroke="black" points="2736.5,-12420.52 2733,-12410.52 2729.5,-12420.52 2736.5,-12420.52"/>
</g>
<!-- gpu4_layer7_ln1 -->
<g id="node1156" class="node">
<title>gpu4_layer7_ln1</title>
<polygon fill="lightblue" stroke="black" points="2794,-12321.39 2672,-12321.39 2672,-12269.39 2794,-12269.39 2794,-12321.39"/>
<text text-anchor="middle" x="2733" y="-12309.39" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2733" y="-12298.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-12287.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-12276.39" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer6_res2&#45;&gt;gpu4_layer7_ln1 -->
<g id="edge1443" class="edge">
<title>gpu4_layer6_res2&#45;&gt;gpu4_layer7_ln1</title>
<path fill="none" stroke="black" d="M2733,-12358.23C2733,-12349.93 2733,-12340.55 2733,-12331.64"/>
<polygon fill="black" stroke="black" points="2736.5,-12331.5 2733,-12321.5 2729.5,-12331.5 2736.5,-12331.5"/>
</g>
<!-- gpu4_layer7_qkv -->
<g id="node1157" class="node">
<title>gpu4_layer7_qkv</title>
<polygon fill="lightblue" stroke="black" points="2794,-12232.39 2672,-12232.39 2672,-12180.39 2794,-12180.39 2794,-12232.39"/>
<text text-anchor="middle" x="2733" y="-12220.39" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2733" y="-12209.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-12198.39" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-12187.39" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer7_ln1&#45;&gt;gpu4_layer7_qkv -->
<g id="edge1444" class="edge">
<title>gpu4_layer7_ln1&#45;&gt;gpu4_layer7_qkv</title>
<path fill="none" stroke="black" d="M2733,-12269.23C2733,-12260.93 2733,-12251.55 2733,-12242.64"/>
<polygon fill="black" stroke="black" points="2736.5,-12242.5 2733,-12232.5 2729.5,-12242.5 2736.5,-12242.5"/>
</g>
<!-- gpu4_layer7_reshape -->
<g id="node1158" class="node">
<title>gpu4_layer7_reshape</title>
<polygon fill="lightblue" stroke="black" points="2797,-12143.39 2669,-12143.39 2669,-12091.39 2797,-12091.39 2797,-12143.39"/>
<text text-anchor="middle" x="2733" y="-12131.39" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2733" y="-12120.39" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-12109.39" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-12098.39" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer7_qkv&#45;&gt;gpu4_layer7_reshape -->
<g id="edge1445" class="edge">
<title>gpu4_layer7_qkv&#45;&gt;gpu4_layer7_reshape</title>
<path fill="none" stroke="black" d="M2733,-12180.23C2733,-12171.93 2733,-12162.55 2733,-12153.64"/>
<polygon fill="black" stroke="black" points="2736.5,-12153.5 2733,-12143.5 2729.5,-12153.5 2736.5,-12153.5"/>
</g>
<!-- gpu4_layer7_attn -->
<g id="node1159" class="node">
<title>gpu4_layer7_attn</title>
<polygon fill="lightblue" stroke="black" points="2797,-12054.39 2669,-12054.39 2669,-12002.39 2797,-12002.39 2797,-12054.39"/>
<text text-anchor="middle" x="2733" y="-12042.39" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2733" y="-12031.39" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-12020.39" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-12009.39" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer7_reshape&#45;&gt;gpu4_layer7_attn -->
<g id="edge1446" class="edge">
<title>gpu4_layer7_reshape&#45;&gt;gpu4_layer7_attn</title>
<path fill="none" stroke="black" d="M2733,-12091.23C2733,-12082.93 2733,-12073.55 2733,-12064.64"/>
<polygon fill="black" stroke="black" points="2736.5,-12064.5 2733,-12054.5 2729.5,-12064.5 2736.5,-12064.5"/>
</g>
<!-- gpu4_layer7_attn_reshape -->
<g id="node1161" class="node">
<title>gpu4_layer7_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2794,-11965.39 2672,-11965.39 2672,-11913.39 2794,-11913.39 2794,-11965.39"/>
<text text-anchor="middle" x="2733" y="-11953.39" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2733" y="-11942.39" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-11931.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-11920.39" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer7_attn&#45;&gt;gpu4_layer7_attn_reshape -->
<g id="edge1447" class="edge">
<title>gpu4_layer7_attn&#45;&gt;gpu4_layer7_attn_reshape</title>
<path fill="none" stroke="black" d="M2733,-12002.23C2733,-11993.93 2733,-11984.55 2733,-11975.64"/>
<polygon fill="black" stroke="black" points="2736.5,-11975.5 2733,-11965.5 2729.5,-11975.5 2736.5,-11975.5"/>
</g>
<!-- gpu4_layer7_attn_out -->
<g id="node1160" class="node">
<title>gpu4_layer7_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2794,-11876.39 2672,-11876.39 2672,-11824.39 2794,-11824.39 2794,-11876.39"/>
<text text-anchor="middle" x="2733" y="-11864.39" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2733" y="-11853.39" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-11842.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-11831.39" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer7_kv_update -->
<g id="node1162" class="node">
<title>gpu4_layer7_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2733" cy="-11750.62" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2733" y="-11764.62" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2733" y="-11753.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-11742.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-11731.62" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer7_attn_out&#45;&gt;gpu4_layer7_kv_update -->
<g id="edge1449" class="edge">
<title>gpu4_layer7_attn_out&#45;&gt;gpu4_layer7_kv_update</title>
<path fill="none" stroke="black" d="M2733,-11824.21C2733,-11816.07 2733,-11806.78 2733,-11797.62"/>
<polygon fill="black" stroke="black" points="2736.5,-11797.4 2733,-11787.4 2729.5,-11797.4 2736.5,-11797.4"/>
</g>
<!-- gpu4_layer7_attn_reshape&#45;&gt;gpu4_layer7_attn_out -->
<g id="edge1448" class="edge">
<title>gpu4_layer7_attn_reshape&#45;&gt;gpu4_layer7_attn_out</title>
<path fill="none" stroke="black" d="M2733,-11913.23C2733,-11904.93 2733,-11895.55 2733,-11886.64"/>
<polygon fill="black" stroke="black" points="2736.5,-11886.5 2733,-11876.5 2729.5,-11886.5 2736.5,-11886.5"/>
</g>
<!-- gpu4_layer7_res1 -->
<g id="node1163" class="node">
<title>gpu4_layer7_res1</title>
<polygon fill="lightblue" stroke="black" points="2794,-11676.85 2672,-11676.85 2672,-11624.85 2794,-11624.85 2794,-11676.85"/>
<text text-anchor="middle" x="2733" y="-11664.85" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2733" y="-11653.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-11642.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-11631.85" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer7_kv_update&#45;&gt;gpu4_layer7_res1 -->
<g id="edge1450" class="edge">
<title>gpu4_layer7_kv_update&#45;&gt;gpu4_layer7_res1</title>
<path fill="none" stroke="black" d="M2733,-11713.77C2733,-11705.09 2733,-11695.82 2733,-11687.17"/>
<polygon fill="black" stroke="black" points="2736.5,-11687 2733,-11677 2729.5,-11687 2736.5,-11687"/>
</g>
<!-- gpu4_layer7_ln2 -->
<g id="node1164" class="node">
<title>gpu4_layer7_ln2</title>
<polygon fill="lightblue" stroke="black" points="2794,-11587.85 2672,-11587.85 2672,-11535.85 2794,-11535.85 2794,-11587.85"/>
<text text-anchor="middle" x="2733" y="-11575.85" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2733" y="-11564.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-11553.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-11542.85" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer7_res1&#45;&gt;gpu4_layer7_ln2 -->
<g id="edge1451" class="edge">
<title>gpu4_layer7_res1&#45;&gt;gpu4_layer7_ln2</title>
<path fill="none" stroke="black" d="M2733,-11624.69C2733,-11616.39 2733,-11607.01 2733,-11598.1"/>
<polygon fill="black" stroke="black" points="2736.5,-11597.96 2733,-11587.96 2729.5,-11597.96 2736.5,-11597.96"/>
</g>
<!-- gpu4_layer7_routing -->
<g id="node1165" class="node">
<title>gpu4_layer7_routing</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-11498.85 2658.29,-11498.85 2606.53,-11372.85 2807.71,-11372.85 2859.47,-11498.85"/>
<text text-anchor="middle" x="2733" y="-11455.35" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2733" y="-11444.35" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-11433.35" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-11422.35" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2733" y="-11411.35" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer7_ln2&#45;&gt;gpu4_layer7_routing -->
<g id="edge1452" class="edge">
<title>gpu4_layer7_ln2&#45;&gt;gpu4_layer7_routing</title>
<path fill="none" stroke="black" d="M2733,-11535.76C2733,-11527.83 2733,-11518.63 2733,-11509.1"/>
<polygon fill="black" stroke="black" points="2736.5,-11509.09 2733,-11499.09 2729.5,-11509.09 2736.5,-11509.09"/>
</g>
<!-- gpu4_layer7_expert0 -->
<g id="node1166" class="node">
<title>gpu4_layer7_expert0</title>
<polygon fill="lightblue" stroke="black" points="2514,-11326.85 2392,-11326.85 2392,-11274.85 2514,-11274.85 2514,-11326.85"/>
<text text-anchor="middle" x="2453" y="-11314.85" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="2453" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer7_routing&#45;&gt;gpu4_layer7_expert0 -->
<g id="edge1439" class="edge">
<title>gpu4_layer7_routing&#45;&gt;gpu4_layer7_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2607.33,-11375.16C2575.34,-11359.96 2542.34,-11344.29 2515.11,-11331.35"/>
<polygon fill="black" stroke="black" points="2516.26,-11328.03 2505.73,-11326.9 2513.26,-11334.35 2516.26,-11328.03"/>
<text text-anchor="middle" x="2588.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer7_expert1 -->
<g id="node1167" class="node">
<title>gpu4_layer7_expert1</title>
<polygon fill="lightblue" stroke="black" points="2654,-11326.85 2532,-11326.85 2532,-11274.85 2654,-11274.85 2654,-11326.85"/>
<text text-anchor="middle" x="2593" y="-11314.85" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="2593" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer7_routing&#45;&gt;gpu4_layer7_expert1 -->
<g id="edge1440" class="edge">
<title>gpu4_layer7_routing&#45;&gt;gpu4_layer7_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2667.51,-11372.64C2653.48,-11359.31 2639.21,-11345.76 2626.97,-11334.12"/>
<polygon fill="black" stroke="black" points="2629.29,-11331.5 2619.63,-11327.15 2624.46,-11336.57 2629.29,-11331.5"/>
<text text-anchor="middle" x="2675.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer7_expert2 -->
<g id="node1168" class="node">
<title>gpu4_layer7_expert2</title>
<polygon fill="lightblue" stroke="black" points="2794,-11326.85 2672,-11326.85 2672,-11274.85 2794,-11274.85 2794,-11326.85"/>
<text text-anchor="middle" x="2733" y="-11314.85" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2733" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer7_routing&#45;&gt;gpu4_layer7_expert2 -->
<g id="edge1441" class="edge">
<title>gpu4_layer7_routing&#45;&gt;gpu4_layer7_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2733,-11372.64C2733,-11360.57 2733,-11348.31 2733,-11337.46"/>
<polygon fill="black" stroke="black" points="2736.5,-11337.15 2733,-11327.15 2729.5,-11337.15 2736.5,-11337.15"/>
<text text-anchor="middle" x="2762.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer7_expert3 -->
<g id="node1169" class="node">
<title>gpu4_layer7_expert3</title>
<polygon fill="lightblue" stroke="black" points="2934,-11326.85 2812,-11326.85 2812,-11274.85 2934,-11274.85 2934,-11326.85"/>
<text text-anchor="middle" x="2873" y="-11314.85" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2873" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer7_routing&#45;&gt;gpu4_layer7_expert3 -->
<g id="edge1442" class="edge">
<title>gpu4_layer7_routing&#45;&gt;gpu4_layer7_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2798.49,-11372.64C2812.52,-11359.31 2826.79,-11345.76 2839.03,-11334.12"/>
<polygon fill="black" stroke="black" points="2841.54,-11336.57 2846.37,-11327.15 2836.71,-11331.5 2841.54,-11336.57"/>
<text text-anchor="middle" x="2856.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer7_expert_agg -->
<g id="node1170" class="node">
<title>gpu4_layer7_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-11237.85 2658.29,-11237.85 2606.53,-11133.85 2807.71,-11133.85 2859.47,-11237.85"/>
<text text-anchor="middle" x="2733" y="-11199.85" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2733" y="-11188.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-11177.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-11166.85" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer7_routing&#45;&gt;gpu4_layer7_expert_agg -->
<g id="edge1457" class="edge">
<title>gpu4_layer7_routing&#45;&gt;gpu4_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M2822.22,-11407.94C2895.96,-11380.78 2982.6,-11334.39 2943,-11274.85 2922.44,-11243.94 2888.7,-11223.87 2854.22,-11210.84"/>
<polygon fill="black" stroke="black" points="2855.08,-11207.43 2844.48,-11207.35 2852.71,-11214.02 2855.08,-11207.43"/>
</g>
<!-- gpu4_layer7_expert0&#45;&gt;gpu4_layer7_expert_agg -->
<g id="edge1453" class="edge">
<title>gpu4_layer7_expert0&#45;&gt;gpu4_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M2514.1,-11275.19C2550.98,-11260.31 2598.7,-11241.05 2640.16,-11224.32"/>
<polygon fill="black" stroke="black" points="2641.5,-11227.56 2649.46,-11220.57 2638.88,-11221.06 2641.5,-11227.56"/>
</g>
<!-- gpu4_layer7_expert1&#45;&gt;gpu4_layer7_expert_agg -->
<g id="edge1454" class="edge">
<title>gpu4_layer7_expert1&#45;&gt;gpu4_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M2624.07,-11274.77C2635.32,-11265.7 2648.53,-11255.03 2661.8,-11244.32"/>
<polygon fill="black" stroke="black" points="2664.02,-11247.03 2669.6,-11238.02 2659.62,-11241.58 2664.02,-11247.03"/>
</g>
<!-- gpu4_layer7_expert2&#45;&gt;gpu4_layer7_expert_agg -->
<g id="edge1455" class="edge">
<title>gpu4_layer7_expert2&#45;&gt;gpu4_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M2733,-11274.77C2733,-11266.85 2733,-11257.71 2733,-11248.39"/>
<polygon fill="black" stroke="black" points="2736.5,-11248.25 2733,-11238.25 2729.5,-11248.25 2736.5,-11248.25"/>
</g>
<!-- gpu4_layer7_expert3&#45;&gt;gpu4_layer7_expert_agg -->
<g id="edge1456" class="edge">
<title>gpu4_layer7_expert3&#45;&gt;gpu4_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M2841.93,-11274.77C2830.68,-11265.7 2817.47,-11255.03 2804.2,-11244.32"/>
<polygon fill="black" stroke="black" points="2806.38,-11241.58 2796.4,-11238.02 2801.98,-11247.03 2806.38,-11241.58"/>
</g>
<!-- gpu4_layer7_res2 -->
<g id="node1171" class="node">
<title>gpu4_layer7_res2</title>
<polygon fill="lightblue" stroke="black" points="2794,-11096.85 2672,-11096.85 2672,-11044.85 2794,-11044.85 2794,-11096.85"/>
<text text-anchor="middle" x="2733" y="-11084.85" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2733" y="-11073.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-11062.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-11051.85" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer7_expert_agg&#45;&gt;gpu4_layer7_res2 -->
<g id="edge1458" class="edge">
<title>gpu4_layer7_expert_agg&#45;&gt;gpu4_layer7_res2</title>
<path fill="none" stroke="black" d="M2733,-11133.64C2733,-11124.69 2733,-11115.56 2733,-11107.16"/>
<polygon fill="black" stroke="black" points="2736.5,-11106.98 2733,-11096.98 2729.5,-11106.98 2736.5,-11106.98"/>
</g>
<!-- gpu4_layer8_ln1 -->
<g id="node1172" class="node">
<title>gpu4_layer8_ln1</title>
<polygon fill="lightblue" stroke="black" points="2794,-11007.85 2672,-11007.85 2672,-10955.85 2794,-10955.85 2794,-11007.85"/>
<text text-anchor="middle" x="2733" y="-10995.85" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2733" y="-10984.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-10973.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-10962.85" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer7_res2&#45;&gt;gpu4_layer8_ln1 -->
<g id="edge1463" class="edge">
<title>gpu4_layer7_res2&#45;&gt;gpu4_layer8_ln1</title>
<path fill="none" stroke="black" d="M2733,-11044.69C2733,-11036.39 2733,-11027.01 2733,-11018.1"/>
<polygon fill="black" stroke="black" points="2736.5,-11017.96 2733,-11007.96 2729.5,-11017.96 2736.5,-11017.96"/>
</g>
<!-- gpu4_layer8_qkv -->
<g id="node1173" class="node">
<title>gpu4_layer8_qkv</title>
<polygon fill="lightblue" stroke="black" points="2794,-10918.85 2672,-10918.85 2672,-10866.85 2794,-10866.85 2794,-10918.85"/>
<text text-anchor="middle" x="2733" y="-10906.85" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2733" y="-10895.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-10884.85" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-10873.85" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer8_ln1&#45;&gt;gpu4_layer8_qkv -->
<g id="edge1464" class="edge">
<title>gpu4_layer8_ln1&#45;&gt;gpu4_layer8_qkv</title>
<path fill="none" stroke="black" d="M2733,-10955.69C2733,-10947.39 2733,-10938.01 2733,-10929.1"/>
<polygon fill="black" stroke="black" points="2736.5,-10928.96 2733,-10918.96 2729.5,-10928.96 2736.5,-10928.96"/>
</g>
<!-- gpu4_layer8_reshape -->
<g id="node1174" class="node">
<title>gpu4_layer8_reshape</title>
<polygon fill="lightblue" stroke="black" points="2797,-10829.85 2669,-10829.85 2669,-10777.85 2797,-10777.85 2797,-10829.85"/>
<text text-anchor="middle" x="2733" y="-10817.85" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2733" y="-10806.85" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-10795.85" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-10784.85" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer8_qkv&#45;&gt;gpu4_layer8_reshape -->
<g id="edge1465" class="edge">
<title>gpu4_layer8_qkv&#45;&gt;gpu4_layer8_reshape</title>
<path fill="none" stroke="black" d="M2733,-10866.69C2733,-10858.39 2733,-10849.01 2733,-10840.1"/>
<polygon fill="black" stroke="black" points="2736.5,-10839.96 2733,-10829.96 2729.5,-10839.96 2736.5,-10839.96"/>
</g>
<!-- gpu4_layer8_attn -->
<g id="node1175" class="node">
<title>gpu4_layer8_attn</title>
<polygon fill="lightblue" stroke="black" points="2797,-10740.85 2669,-10740.85 2669,-10688.85 2797,-10688.85 2797,-10740.85"/>
<text text-anchor="middle" x="2733" y="-10728.85" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2733" y="-10717.85" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-10706.85" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-10695.85" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer8_reshape&#45;&gt;gpu4_layer8_attn -->
<g id="edge1466" class="edge">
<title>gpu4_layer8_reshape&#45;&gt;gpu4_layer8_attn</title>
<path fill="none" stroke="black" d="M2733,-10777.69C2733,-10769.39 2733,-10760.01 2733,-10751.1"/>
<polygon fill="black" stroke="black" points="2736.5,-10750.96 2733,-10740.96 2729.5,-10750.96 2736.5,-10750.96"/>
</g>
<!-- gpu4_layer8_attn_reshape -->
<g id="node1177" class="node">
<title>gpu4_layer8_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2794,-10651.85 2672,-10651.85 2672,-10599.85 2794,-10599.85 2794,-10651.85"/>
<text text-anchor="middle" x="2733" y="-10639.85" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2733" y="-10628.85" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-10617.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-10606.85" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer8_attn&#45;&gt;gpu4_layer8_attn_reshape -->
<g id="edge1467" class="edge">
<title>gpu4_layer8_attn&#45;&gt;gpu4_layer8_attn_reshape</title>
<path fill="none" stroke="black" d="M2733,-10688.69C2733,-10680.39 2733,-10671.01 2733,-10662.1"/>
<polygon fill="black" stroke="black" points="2736.5,-10661.96 2733,-10651.96 2729.5,-10661.96 2736.5,-10661.96"/>
</g>
<!-- gpu4_layer8_attn_out -->
<g id="node1176" class="node">
<title>gpu4_layer8_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2794,-10562.85 2672,-10562.85 2672,-10510.85 2794,-10510.85 2794,-10562.85"/>
<text text-anchor="middle" x="2733" y="-10550.85" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2733" y="-10539.85" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-10528.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-10517.85" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer8_kv_update -->
<g id="node1178" class="node">
<title>gpu4_layer8_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2733" cy="-10437.08" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2733" y="-10451.08" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2733" y="-10440.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-10429.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-10418.08" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer8_attn_out&#45;&gt;gpu4_layer8_kv_update -->
<g id="edge1469" class="edge">
<title>gpu4_layer8_attn_out&#45;&gt;gpu4_layer8_kv_update</title>
<path fill="none" stroke="black" d="M2733,-10510.67C2733,-10502.53 2733,-10493.24 2733,-10484.08"/>
<polygon fill="black" stroke="black" points="2736.5,-10483.86 2733,-10473.86 2729.5,-10483.86 2736.5,-10483.86"/>
</g>
<!-- gpu4_layer8_attn_reshape&#45;&gt;gpu4_layer8_attn_out -->
<g id="edge1468" class="edge">
<title>gpu4_layer8_attn_reshape&#45;&gt;gpu4_layer8_attn_out</title>
<path fill="none" stroke="black" d="M2733,-10599.69C2733,-10591.39 2733,-10582.01 2733,-10573.1"/>
<polygon fill="black" stroke="black" points="2736.5,-10572.96 2733,-10562.96 2729.5,-10572.96 2736.5,-10572.96"/>
</g>
<!-- gpu4_layer8_res1 -->
<g id="node1179" class="node">
<title>gpu4_layer8_res1</title>
<polygon fill="lightblue" stroke="black" points="2794,-10363.31 2672,-10363.31 2672,-10311.31 2794,-10311.31 2794,-10363.31"/>
<text text-anchor="middle" x="2733" y="-10351.31" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2733" y="-10340.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-10329.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-10318.31" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer8_kv_update&#45;&gt;gpu4_layer8_res1 -->
<g id="edge1470" class="edge">
<title>gpu4_layer8_kv_update&#45;&gt;gpu4_layer8_res1</title>
<path fill="none" stroke="black" d="M2733,-10400.23C2733,-10391.55 2733,-10382.28 2733,-10373.63"/>
<polygon fill="black" stroke="black" points="2736.5,-10373.46 2733,-10363.46 2729.5,-10373.46 2736.5,-10373.46"/>
</g>
<!-- gpu4_layer8_ln2 -->
<g id="node1180" class="node">
<title>gpu4_layer8_ln2</title>
<polygon fill="lightblue" stroke="black" points="2794,-10274.31 2672,-10274.31 2672,-10222.31 2794,-10222.31 2794,-10274.31"/>
<text text-anchor="middle" x="2733" y="-10262.31" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2733" y="-10251.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-10240.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-10229.31" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer8_res1&#45;&gt;gpu4_layer8_ln2 -->
<g id="edge1471" class="edge">
<title>gpu4_layer8_res1&#45;&gt;gpu4_layer8_ln2</title>
<path fill="none" stroke="black" d="M2733,-10311.15C2733,-10302.85 2733,-10293.47 2733,-10284.56"/>
<polygon fill="black" stroke="black" points="2736.5,-10284.42 2733,-10274.42 2729.5,-10284.42 2736.5,-10284.42"/>
</g>
<!-- gpu4_layer8_routing -->
<g id="node1181" class="node">
<title>gpu4_layer8_routing</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-10185.31 2658.29,-10185.31 2606.53,-10059.31 2807.71,-10059.31 2859.47,-10185.31"/>
<text text-anchor="middle" x="2733" y="-10141.81" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2733" y="-10130.81" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-10119.81" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-10108.81" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2733" y="-10097.81" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer8_ln2&#45;&gt;gpu4_layer8_routing -->
<g id="edge1472" class="edge">
<title>gpu4_layer8_ln2&#45;&gt;gpu4_layer8_routing</title>
<path fill="none" stroke="black" d="M2733,-10222.22C2733,-10214.29 2733,-10205.09 2733,-10195.56"/>
<polygon fill="black" stroke="black" points="2736.5,-10195.55 2733,-10185.55 2729.5,-10195.55 2736.5,-10195.55"/>
</g>
<!-- gpu4_layer8_expert0 -->
<g id="node1182" class="node">
<title>gpu4_layer8_expert0</title>
<polygon fill="lightblue" stroke="black" points="2514,-10013.31 2392,-10013.31 2392,-9961.31 2514,-9961.31 2514,-10013.31"/>
<text text-anchor="middle" x="2453" y="-10001.31" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="2453" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer8_routing&#45;&gt;gpu4_layer8_expert0 -->
<g id="edge1459" class="edge">
<title>gpu4_layer8_routing&#45;&gt;gpu4_layer8_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2607.33,-10061.62C2575.34,-10046.42 2542.34,-10030.75 2515.11,-10017.81"/>
<polygon fill="black" stroke="black" points="2516.26,-10014.49 2505.73,-10013.36 2513.26,-10020.81 2516.26,-10014.49"/>
<text text-anchor="middle" x="2588.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer8_expert1 -->
<g id="node1183" class="node">
<title>gpu4_layer8_expert1</title>
<polygon fill="lightblue" stroke="black" points="2654,-10013.31 2532,-10013.31 2532,-9961.31 2654,-9961.31 2654,-10013.31"/>
<text text-anchor="middle" x="2593" y="-10001.31" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="2593" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer8_routing&#45;&gt;gpu4_layer8_expert1 -->
<g id="edge1460" class="edge">
<title>gpu4_layer8_routing&#45;&gt;gpu4_layer8_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2667.51,-10059.1C2653.48,-10045.77 2639.21,-10032.22 2626.97,-10020.58"/>
<polygon fill="black" stroke="black" points="2629.29,-10017.96 2619.63,-10013.61 2624.46,-10023.03 2629.29,-10017.96"/>
<text text-anchor="middle" x="2675.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer8_expert2 -->
<g id="node1184" class="node">
<title>gpu4_layer8_expert2</title>
<polygon fill="lightblue" stroke="black" points="2794,-10013.31 2672,-10013.31 2672,-9961.31 2794,-9961.31 2794,-10013.31"/>
<text text-anchor="middle" x="2733" y="-10001.31" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2733" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer8_routing&#45;&gt;gpu4_layer8_expert2 -->
<g id="edge1461" class="edge">
<title>gpu4_layer8_routing&#45;&gt;gpu4_layer8_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2733,-10059.1C2733,-10047.03 2733,-10034.77 2733,-10023.92"/>
<polygon fill="black" stroke="black" points="2736.5,-10023.61 2733,-10013.61 2729.5,-10023.61 2736.5,-10023.61"/>
<text text-anchor="middle" x="2762.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer8_expert3 -->
<g id="node1185" class="node">
<title>gpu4_layer8_expert3</title>
<polygon fill="lightblue" stroke="black" points="2934,-10013.31 2812,-10013.31 2812,-9961.31 2934,-9961.31 2934,-10013.31"/>
<text text-anchor="middle" x="2873" y="-10001.31" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2873" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer8_routing&#45;&gt;gpu4_layer8_expert3 -->
<g id="edge1462" class="edge">
<title>gpu4_layer8_routing&#45;&gt;gpu4_layer8_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2798.49,-10059.1C2812.52,-10045.77 2826.79,-10032.22 2839.03,-10020.58"/>
<polygon fill="black" stroke="black" points="2841.54,-10023.03 2846.37,-10013.61 2836.71,-10017.96 2841.54,-10023.03"/>
<text text-anchor="middle" x="2856.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer8_expert_agg -->
<g id="node1186" class="node">
<title>gpu4_layer8_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-9924.31 2658.29,-9924.31 2606.53,-9820.31 2807.71,-9820.31 2859.47,-9924.31"/>
<text text-anchor="middle" x="2733" y="-9886.31" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2733" y="-9875.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-9864.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-9853.31" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer8_routing&#45;&gt;gpu4_layer8_expert_agg -->
<g id="edge1477" class="edge">
<title>gpu4_layer8_routing&#45;&gt;gpu4_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M2822.22,-10094.4C2895.96,-10067.24 2982.6,-10020.85 2943,-9961.31 2922.44,-9930.4 2888.7,-9910.33 2854.22,-9897.3"/>
<polygon fill="black" stroke="black" points="2855.08,-9893.89 2844.48,-9893.81 2852.71,-9900.48 2855.08,-9893.89"/>
</g>
<!-- gpu4_layer8_expert0&#45;&gt;gpu4_layer8_expert_agg -->
<g id="edge1473" class="edge">
<title>gpu4_layer8_expert0&#45;&gt;gpu4_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M2514.1,-9961.65C2550.98,-9946.77 2598.7,-9927.51 2640.16,-9910.78"/>
<polygon fill="black" stroke="black" points="2641.5,-9914.02 2649.46,-9907.03 2638.88,-9907.52 2641.5,-9914.02"/>
</g>
<!-- gpu4_layer8_expert1&#45;&gt;gpu4_layer8_expert_agg -->
<g id="edge1474" class="edge">
<title>gpu4_layer8_expert1&#45;&gt;gpu4_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M2624.07,-9961.23C2635.32,-9952.16 2648.53,-9941.49 2661.8,-9930.78"/>
<polygon fill="black" stroke="black" points="2664.02,-9933.49 2669.6,-9924.48 2659.62,-9928.04 2664.02,-9933.49"/>
</g>
<!-- gpu4_layer8_expert2&#45;&gt;gpu4_layer8_expert_agg -->
<g id="edge1475" class="edge">
<title>gpu4_layer8_expert2&#45;&gt;gpu4_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M2733,-9961.23C2733,-9953.31 2733,-9944.17 2733,-9934.85"/>
<polygon fill="black" stroke="black" points="2736.5,-9934.71 2733,-9924.71 2729.5,-9934.71 2736.5,-9934.71"/>
</g>
<!-- gpu4_layer8_expert3&#45;&gt;gpu4_layer8_expert_agg -->
<g id="edge1476" class="edge">
<title>gpu4_layer8_expert3&#45;&gt;gpu4_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M2841.93,-9961.23C2830.68,-9952.16 2817.47,-9941.49 2804.2,-9930.78"/>
<polygon fill="black" stroke="black" points="2806.38,-9928.04 2796.4,-9924.48 2801.98,-9933.49 2806.38,-9928.04"/>
</g>
<!-- gpu4_layer8_res2 -->
<g id="node1187" class="node">
<title>gpu4_layer8_res2</title>
<polygon fill="lightblue" stroke="black" points="2794,-9783.31 2672,-9783.31 2672,-9731.31 2794,-9731.31 2794,-9783.31"/>
<text text-anchor="middle" x="2733" y="-9771.31" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2733" y="-9760.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-9749.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-9738.31" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer8_expert_agg&#45;&gt;gpu4_layer8_res2 -->
<g id="edge1478" class="edge">
<title>gpu4_layer8_expert_agg&#45;&gt;gpu4_layer8_res2</title>
<path fill="none" stroke="black" d="M2733,-9820.1C2733,-9811.15 2733,-9802.02 2733,-9793.62"/>
<polygon fill="black" stroke="black" points="2736.5,-9793.44 2733,-9783.44 2729.5,-9793.44 2736.5,-9793.44"/>
</g>
<!-- gpu4_layer9_ln1 -->
<g id="node1188" class="node">
<title>gpu4_layer9_ln1</title>
<polygon fill="lightblue" stroke="black" points="2794,-9694.31 2672,-9694.31 2672,-9642.31 2794,-9642.31 2794,-9694.31"/>
<text text-anchor="middle" x="2733" y="-9682.31" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2733" y="-9671.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-9660.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-9649.31" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer8_res2&#45;&gt;gpu4_layer9_ln1 -->
<g id="edge1483" class="edge">
<title>gpu4_layer8_res2&#45;&gt;gpu4_layer9_ln1</title>
<path fill="none" stroke="black" d="M2733,-9731.15C2733,-9722.85 2733,-9713.47 2733,-9704.56"/>
<polygon fill="black" stroke="black" points="2736.5,-9704.42 2733,-9694.42 2729.5,-9704.42 2736.5,-9704.42"/>
</g>
<!-- gpu4_layer9_qkv -->
<g id="node1189" class="node">
<title>gpu4_layer9_qkv</title>
<polygon fill="lightblue" stroke="black" points="2794,-9605.31 2672,-9605.31 2672,-9553.31 2794,-9553.31 2794,-9605.31"/>
<text text-anchor="middle" x="2733" y="-9593.31" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2733" y="-9582.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-9571.31" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-9560.31" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer9_ln1&#45;&gt;gpu4_layer9_qkv -->
<g id="edge1484" class="edge">
<title>gpu4_layer9_ln1&#45;&gt;gpu4_layer9_qkv</title>
<path fill="none" stroke="black" d="M2733,-9642.15C2733,-9633.85 2733,-9624.47 2733,-9615.56"/>
<polygon fill="black" stroke="black" points="2736.5,-9615.42 2733,-9605.42 2729.5,-9615.42 2736.5,-9615.42"/>
</g>
<!-- gpu4_layer9_reshape -->
<g id="node1190" class="node">
<title>gpu4_layer9_reshape</title>
<polygon fill="lightblue" stroke="black" points="2797,-9516.31 2669,-9516.31 2669,-9464.31 2797,-9464.31 2797,-9516.31"/>
<text text-anchor="middle" x="2733" y="-9504.31" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2733" y="-9493.31" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-9482.31" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-9471.31" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer9_qkv&#45;&gt;gpu4_layer9_reshape -->
<g id="edge1485" class="edge">
<title>gpu4_layer9_qkv&#45;&gt;gpu4_layer9_reshape</title>
<path fill="none" stroke="black" d="M2733,-9553.15C2733,-9544.85 2733,-9535.47 2733,-9526.56"/>
<polygon fill="black" stroke="black" points="2736.5,-9526.42 2733,-9516.42 2729.5,-9526.42 2736.5,-9526.42"/>
</g>
<!-- gpu4_layer9_attn -->
<g id="node1191" class="node">
<title>gpu4_layer9_attn</title>
<polygon fill="lightblue" stroke="black" points="2797,-9427.31 2669,-9427.31 2669,-9375.31 2797,-9375.31 2797,-9427.31"/>
<text text-anchor="middle" x="2733" y="-9415.31" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2733" y="-9404.31" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-9393.31" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-9382.31" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer9_reshape&#45;&gt;gpu4_layer9_attn -->
<g id="edge1486" class="edge">
<title>gpu4_layer9_reshape&#45;&gt;gpu4_layer9_attn</title>
<path fill="none" stroke="black" d="M2733,-9464.15C2733,-9455.85 2733,-9446.47 2733,-9437.56"/>
<polygon fill="black" stroke="black" points="2736.5,-9437.42 2733,-9427.42 2729.5,-9437.42 2736.5,-9437.42"/>
</g>
<!-- gpu4_layer9_attn_reshape -->
<g id="node1193" class="node">
<title>gpu4_layer9_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2794,-9338.31 2672,-9338.31 2672,-9286.31 2794,-9286.31 2794,-9338.31"/>
<text text-anchor="middle" x="2733" y="-9326.31" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2733" y="-9315.31" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-9304.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-9293.31" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer9_attn&#45;&gt;gpu4_layer9_attn_reshape -->
<g id="edge1487" class="edge">
<title>gpu4_layer9_attn&#45;&gt;gpu4_layer9_attn_reshape</title>
<path fill="none" stroke="black" d="M2733,-9375.15C2733,-9366.85 2733,-9357.47 2733,-9348.56"/>
<polygon fill="black" stroke="black" points="2736.5,-9348.42 2733,-9338.42 2729.5,-9348.42 2736.5,-9348.42"/>
</g>
<!-- gpu4_layer9_attn_out -->
<g id="node1192" class="node">
<title>gpu4_layer9_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2794,-9249.31 2672,-9249.31 2672,-9197.31 2794,-9197.31 2794,-9249.31"/>
<text text-anchor="middle" x="2733" y="-9237.31" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2733" y="-9226.31" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-9215.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-9204.31" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer9_kv_update -->
<g id="node1194" class="node">
<title>gpu4_layer9_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2733" cy="-9123.54" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2733" y="-9137.54" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2733" y="-9126.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-9115.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-9104.54" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer9_attn_out&#45;&gt;gpu4_layer9_kv_update -->
<g id="edge1489" class="edge">
<title>gpu4_layer9_attn_out&#45;&gt;gpu4_layer9_kv_update</title>
<path fill="none" stroke="black" d="M2733,-9197.13C2733,-9189 2733,-9179.7 2733,-9170.54"/>
<polygon fill="black" stroke="black" points="2736.5,-9170.32 2733,-9160.32 2729.5,-9170.32 2736.5,-9170.32"/>
</g>
<!-- gpu4_layer9_attn_reshape&#45;&gt;gpu4_layer9_attn_out -->
<g id="edge1488" class="edge">
<title>gpu4_layer9_attn_reshape&#45;&gt;gpu4_layer9_attn_out</title>
<path fill="none" stroke="black" d="M2733,-9286.15C2733,-9277.85 2733,-9268.47 2733,-9259.56"/>
<polygon fill="black" stroke="black" points="2736.5,-9259.42 2733,-9249.42 2729.5,-9259.42 2736.5,-9259.42"/>
</g>
<!-- gpu4_layer9_res1 -->
<g id="node1195" class="node">
<title>gpu4_layer9_res1</title>
<polygon fill="lightblue" stroke="black" points="2794,-9049.77 2672,-9049.77 2672,-8997.77 2794,-8997.77 2794,-9049.77"/>
<text text-anchor="middle" x="2733" y="-9037.77" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2733" y="-9026.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-9015.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-9004.77" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer9_kv_update&#45;&gt;gpu4_layer9_res1 -->
<g id="edge1490" class="edge">
<title>gpu4_layer9_kv_update&#45;&gt;gpu4_layer9_res1</title>
<path fill="none" stroke="black" d="M2733,-9086.69C2733,-9078.01 2733,-9068.74 2733,-9060.09"/>
<polygon fill="black" stroke="black" points="2736.5,-9059.92 2733,-9049.92 2729.5,-9059.92 2736.5,-9059.92"/>
</g>
<!-- gpu4_layer9_ln2 -->
<g id="node1196" class="node">
<title>gpu4_layer9_ln2</title>
<polygon fill="lightblue" stroke="black" points="2794,-8960.77 2672,-8960.77 2672,-8908.77 2794,-8908.77 2794,-8960.77"/>
<text text-anchor="middle" x="2733" y="-8948.77" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2733" y="-8937.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-8926.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-8915.77" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer9_res1&#45;&gt;gpu4_layer9_ln2 -->
<g id="edge1491" class="edge">
<title>gpu4_layer9_res1&#45;&gt;gpu4_layer9_ln2</title>
<path fill="none" stroke="black" d="M2733,-8997.61C2733,-8989.31 2733,-8979.93 2733,-8971.02"/>
<polygon fill="black" stroke="black" points="2736.5,-8970.88 2733,-8960.88 2729.5,-8970.88 2736.5,-8970.88"/>
</g>
<!-- gpu4_layer9_routing -->
<g id="node1197" class="node">
<title>gpu4_layer9_routing</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-8871.77 2658.29,-8871.77 2606.53,-8745.77 2807.71,-8745.77 2859.47,-8871.77"/>
<text text-anchor="middle" x="2733" y="-8828.27" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2733" y="-8817.27" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-8806.27" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-8795.27" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2733" y="-8784.27" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer9_ln2&#45;&gt;gpu4_layer9_routing -->
<g id="edge1492" class="edge">
<title>gpu4_layer9_ln2&#45;&gt;gpu4_layer9_routing</title>
<path fill="none" stroke="black" d="M2733,-8908.68C2733,-8900.75 2733,-8891.55 2733,-8882.02"/>
<polygon fill="black" stroke="black" points="2736.5,-8882.01 2733,-8872.01 2729.5,-8882.01 2736.5,-8882.01"/>
</g>
<!-- gpu4_layer9_expert0 -->
<g id="node1198" class="node">
<title>gpu4_layer9_expert0</title>
<polygon fill="lightblue" stroke="black" points="2514,-8699.77 2392,-8699.77 2392,-8647.77 2514,-8647.77 2514,-8699.77"/>
<text text-anchor="middle" x="2453" y="-8687.77" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="2453" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer9_routing&#45;&gt;gpu4_layer9_expert0 -->
<g id="edge1479" class="edge">
<title>gpu4_layer9_routing&#45;&gt;gpu4_layer9_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2607.33,-8748.08C2575.34,-8732.89 2542.34,-8717.21 2515.11,-8704.27"/>
<polygon fill="black" stroke="black" points="2516.26,-8700.95 2505.73,-8699.82 2513.26,-8707.27 2516.26,-8700.95"/>
<text text-anchor="middle" x="2588.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer9_expert1 -->
<g id="node1199" class="node">
<title>gpu4_layer9_expert1</title>
<polygon fill="lightblue" stroke="black" points="2654,-8699.77 2532,-8699.77 2532,-8647.77 2654,-8647.77 2654,-8699.77"/>
<text text-anchor="middle" x="2593" y="-8687.77" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="2593" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer9_routing&#45;&gt;gpu4_layer9_expert1 -->
<g id="edge1480" class="edge">
<title>gpu4_layer9_routing&#45;&gt;gpu4_layer9_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2667.51,-8745.56C2653.48,-8732.23 2639.21,-8718.68 2626.97,-8707.04"/>
<polygon fill="black" stroke="black" points="2629.29,-8704.42 2619.63,-8700.07 2624.46,-8709.49 2629.29,-8704.42"/>
<text text-anchor="middle" x="2675.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer9_expert2 -->
<g id="node1200" class="node">
<title>gpu4_layer9_expert2</title>
<polygon fill="lightblue" stroke="black" points="2794,-8699.77 2672,-8699.77 2672,-8647.77 2794,-8647.77 2794,-8699.77"/>
<text text-anchor="middle" x="2733" y="-8687.77" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2733" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer9_routing&#45;&gt;gpu4_layer9_expert2 -->
<g id="edge1481" class="edge">
<title>gpu4_layer9_routing&#45;&gt;gpu4_layer9_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2733,-8745.56C2733,-8733.49 2733,-8721.23 2733,-8710.39"/>
<polygon fill="black" stroke="black" points="2736.5,-8710.07 2733,-8700.07 2729.5,-8710.07 2736.5,-8710.07"/>
<text text-anchor="middle" x="2762.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer9_expert3 -->
<g id="node1201" class="node">
<title>gpu4_layer9_expert3</title>
<polygon fill="lightblue" stroke="black" points="2934,-8699.77 2812,-8699.77 2812,-8647.77 2934,-8647.77 2934,-8699.77"/>
<text text-anchor="middle" x="2873" y="-8687.77" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2873" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer9_routing&#45;&gt;gpu4_layer9_expert3 -->
<g id="edge1482" class="edge">
<title>gpu4_layer9_routing&#45;&gt;gpu4_layer9_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2798.49,-8745.56C2812.52,-8732.23 2826.79,-8718.68 2839.03,-8707.04"/>
<polygon fill="black" stroke="black" points="2841.54,-8709.49 2846.37,-8700.07 2836.71,-8704.42 2841.54,-8709.49"/>
<text text-anchor="middle" x="2856.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer9_expert_agg -->
<g id="node1202" class="node">
<title>gpu4_layer9_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-8610.77 2658.29,-8610.77 2606.53,-8506.77 2807.71,-8506.77 2859.47,-8610.77"/>
<text text-anchor="middle" x="2733" y="-8572.77" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2733" y="-8561.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-8550.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-8539.77" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer9_routing&#45;&gt;gpu4_layer9_expert_agg -->
<g id="edge1497" class="edge">
<title>gpu4_layer9_routing&#45;&gt;gpu4_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M2822.22,-8780.86C2895.96,-8753.7 2982.6,-8707.31 2943,-8647.77 2922.44,-8616.86 2888.7,-8596.79 2854.22,-8583.76"/>
<polygon fill="black" stroke="black" points="2855.08,-8580.35 2844.48,-8580.27 2852.71,-8586.94 2855.08,-8580.35"/>
</g>
<!-- gpu4_layer9_expert0&#45;&gt;gpu4_layer9_expert_agg -->
<g id="edge1493" class="edge">
<title>gpu4_layer9_expert0&#45;&gt;gpu4_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M2514.1,-8648.12C2550.98,-8633.23 2598.7,-8613.97 2640.16,-8597.24"/>
<polygon fill="black" stroke="black" points="2641.5,-8600.48 2649.46,-8593.49 2638.88,-8593.99 2641.5,-8600.48"/>
</g>
<!-- gpu4_layer9_expert1&#45;&gt;gpu4_layer9_expert_agg -->
<g id="edge1494" class="edge">
<title>gpu4_layer9_expert1&#45;&gt;gpu4_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M2624.07,-8647.7C2635.32,-8638.62 2648.53,-8627.95 2661.8,-8617.24"/>
<polygon fill="black" stroke="black" points="2664.02,-8619.95 2669.6,-8610.95 2659.62,-8614.5 2664.02,-8619.95"/>
</g>
<!-- gpu4_layer9_expert2&#45;&gt;gpu4_layer9_expert_agg -->
<g id="edge1495" class="edge">
<title>gpu4_layer9_expert2&#45;&gt;gpu4_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M2733,-8647.7C2733,-8639.77 2733,-8630.63 2733,-8621.31"/>
<polygon fill="black" stroke="black" points="2736.5,-8621.17 2733,-8611.17 2729.5,-8621.17 2736.5,-8621.17"/>
</g>
<!-- gpu4_layer9_expert3&#45;&gt;gpu4_layer9_expert_agg -->
<g id="edge1496" class="edge">
<title>gpu4_layer9_expert3&#45;&gt;gpu4_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M2841.93,-8647.7C2830.68,-8638.62 2817.47,-8627.95 2804.2,-8617.24"/>
<polygon fill="black" stroke="black" points="2806.38,-8614.5 2796.4,-8610.95 2801.98,-8619.95 2806.38,-8614.5"/>
</g>
<!-- gpu4_layer9_res2 -->
<g id="node1203" class="node">
<title>gpu4_layer9_res2</title>
<polygon fill="lightblue" stroke="black" points="2794,-8469.77 2672,-8469.77 2672,-8417.77 2794,-8417.77 2794,-8469.77"/>
<text text-anchor="middle" x="2733" y="-8457.77" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2733" y="-8446.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-8435.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-8424.77" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer9_expert_agg&#45;&gt;gpu4_layer9_res2 -->
<g id="edge1498" class="edge">
<title>gpu4_layer9_expert_agg&#45;&gt;gpu4_layer9_res2</title>
<path fill="none" stroke="black" d="M2733,-8506.56C2733,-8497.61 2733,-8488.48 2733,-8480.08"/>
<polygon fill="black" stroke="black" points="2736.5,-8479.9 2733,-8469.9 2729.5,-8479.9 2736.5,-8479.9"/>
</g>
<!-- gpu4_layer10_ln1 -->
<g id="node1204" class="node">
<title>gpu4_layer10_ln1</title>
<polygon fill="lightblue" stroke="black" points="2794,-8380.77 2672,-8380.77 2672,-8328.77 2794,-8328.77 2794,-8380.77"/>
<text text-anchor="middle" x="2733" y="-8368.77" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2733" y="-8357.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-8346.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-8335.77" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer9_res2&#45;&gt;gpu4_layer10_ln1 -->
<g id="edge1503" class="edge">
<title>gpu4_layer9_res2&#45;&gt;gpu4_layer10_ln1</title>
<path fill="none" stroke="black" d="M2733,-8417.61C2733,-8409.31 2733,-8399.93 2733,-8391.02"/>
<polygon fill="black" stroke="black" points="2736.5,-8390.88 2733,-8380.88 2729.5,-8390.88 2736.5,-8390.88"/>
</g>
<!-- gpu4_layer10_qkv -->
<g id="node1205" class="node">
<title>gpu4_layer10_qkv</title>
<polygon fill="lightblue" stroke="black" points="2794,-8291.77 2672,-8291.77 2672,-8239.77 2794,-8239.77 2794,-8291.77"/>
<text text-anchor="middle" x="2733" y="-8279.77" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2733" y="-8268.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-8257.77" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-8246.77" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer10_ln1&#45;&gt;gpu4_layer10_qkv -->
<g id="edge1504" class="edge">
<title>gpu4_layer10_ln1&#45;&gt;gpu4_layer10_qkv</title>
<path fill="none" stroke="black" d="M2733,-8328.61C2733,-8320.31 2733,-8310.93 2733,-8302.02"/>
<polygon fill="black" stroke="black" points="2736.5,-8301.88 2733,-8291.88 2729.5,-8301.88 2736.5,-8301.88"/>
</g>
<!-- gpu4_layer10_reshape -->
<g id="node1206" class="node">
<title>gpu4_layer10_reshape</title>
<polygon fill="lightblue" stroke="black" points="2797,-8202.77 2669,-8202.77 2669,-8150.77 2797,-8150.77 2797,-8202.77"/>
<text text-anchor="middle" x="2733" y="-8190.77" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2733" y="-8179.77" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-8168.77" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-8157.77" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer10_qkv&#45;&gt;gpu4_layer10_reshape -->
<g id="edge1505" class="edge">
<title>gpu4_layer10_qkv&#45;&gt;gpu4_layer10_reshape</title>
<path fill="none" stroke="black" d="M2733,-8239.61C2733,-8231.31 2733,-8221.93 2733,-8213.02"/>
<polygon fill="black" stroke="black" points="2736.5,-8212.88 2733,-8202.88 2729.5,-8212.88 2736.5,-8212.88"/>
</g>
<!-- gpu4_layer10_attn -->
<g id="node1207" class="node">
<title>gpu4_layer10_attn</title>
<polygon fill="lightblue" stroke="black" points="2797,-8113.77 2669,-8113.77 2669,-8061.77 2797,-8061.77 2797,-8113.77"/>
<text text-anchor="middle" x="2733" y="-8101.77" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2733" y="-8090.77" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-8079.77" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-8068.77" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer10_reshape&#45;&gt;gpu4_layer10_attn -->
<g id="edge1506" class="edge">
<title>gpu4_layer10_reshape&#45;&gt;gpu4_layer10_attn</title>
<path fill="none" stroke="black" d="M2733,-8150.61C2733,-8142.31 2733,-8132.93 2733,-8124.02"/>
<polygon fill="black" stroke="black" points="2736.5,-8123.88 2733,-8113.88 2729.5,-8123.88 2736.5,-8123.88"/>
</g>
<!-- gpu4_layer10_attn_reshape -->
<g id="node1209" class="node">
<title>gpu4_layer10_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2794,-8024.77 2672,-8024.77 2672,-7972.77 2794,-7972.77 2794,-8024.77"/>
<text text-anchor="middle" x="2733" y="-8012.77" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2733" y="-8001.77" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-7990.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-7979.77" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer10_attn&#45;&gt;gpu4_layer10_attn_reshape -->
<g id="edge1507" class="edge">
<title>gpu4_layer10_attn&#45;&gt;gpu4_layer10_attn_reshape</title>
<path fill="none" stroke="black" d="M2733,-8061.61C2733,-8053.31 2733,-8043.93 2733,-8035.02"/>
<polygon fill="black" stroke="black" points="2736.5,-8034.88 2733,-8024.88 2729.5,-8034.88 2736.5,-8034.88"/>
</g>
<!-- gpu4_layer10_attn_out -->
<g id="node1208" class="node">
<title>gpu4_layer10_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2794,-7935.77 2672,-7935.77 2672,-7883.77 2794,-7883.77 2794,-7935.77"/>
<text text-anchor="middle" x="2733" y="-7923.77" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2733" y="-7912.77" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-7901.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-7890.77" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer10_kv_update -->
<g id="node1210" class="node">
<title>gpu4_layer10_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2733" cy="-7810" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2733" y="-7824" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2733" y="-7813" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-7802" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-7791" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer10_attn_out&#45;&gt;gpu4_layer10_kv_update -->
<g id="edge1509" class="edge">
<title>gpu4_layer10_attn_out&#45;&gt;gpu4_layer10_kv_update</title>
<path fill="none" stroke="black" d="M2733,-7883.6C2733,-7875.46 2733,-7866.16 2733,-7857"/>
<polygon fill="black" stroke="black" points="2736.5,-7856.78 2733,-7846.78 2729.5,-7856.78 2736.5,-7856.78"/>
</g>
<!-- gpu4_layer10_attn_reshape&#45;&gt;gpu4_layer10_attn_out -->
<g id="edge1508" class="edge">
<title>gpu4_layer10_attn_reshape&#45;&gt;gpu4_layer10_attn_out</title>
<path fill="none" stroke="black" d="M2733,-7972.61C2733,-7964.31 2733,-7954.93 2733,-7946.02"/>
<polygon fill="black" stroke="black" points="2736.5,-7945.88 2733,-7935.88 2729.5,-7945.88 2736.5,-7945.88"/>
</g>
<!-- gpu4_layer10_res1 -->
<g id="node1211" class="node">
<title>gpu4_layer10_res1</title>
<polygon fill="lightblue" stroke="black" points="2794,-7736.23 2672,-7736.23 2672,-7684.23 2794,-7684.23 2794,-7736.23"/>
<text text-anchor="middle" x="2733" y="-7724.23" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2733" y="-7713.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-7702.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-7691.23" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer10_kv_update&#45;&gt;gpu4_layer10_res1 -->
<g id="edge1510" class="edge">
<title>gpu4_layer10_kv_update&#45;&gt;gpu4_layer10_res1</title>
<path fill="none" stroke="black" d="M2733,-7773.15C2733,-7764.47 2733,-7755.2 2733,-7746.55"/>
<polygon fill="black" stroke="black" points="2736.5,-7746.38 2733,-7736.38 2729.5,-7746.38 2736.5,-7746.38"/>
</g>
<!-- gpu4_layer10_ln2 -->
<g id="node1212" class="node">
<title>gpu4_layer10_ln2</title>
<polygon fill="lightblue" stroke="black" points="2794,-7647.23 2672,-7647.23 2672,-7595.23 2794,-7595.23 2794,-7647.23"/>
<text text-anchor="middle" x="2733" y="-7635.23" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2733" y="-7624.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-7613.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-7602.23" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer10_res1&#45;&gt;gpu4_layer10_ln2 -->
<g id="edge1511" class="edge">
<title>gpu4_layer10_res1&#45;&gt;gpu4_layer10_ln2</title>
<path fill="none" stroke="black" d="M2733,-7684.07C2733,-7675.77 2733,-7666.39 2733,-7657.48"/>
<polygon fill="black" stroke="black" points="2736.5,-7657.34 2733,-7647.34 2729.5,-7657.34 2736.5,-7657.34"/>
</g>
<!-- gpu4_layer10_routing -->
<g id="node1213" class="node">
<title>gpu4_layer10_routing</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-7558.23 2658.29,-7558.23 2606.53,-7432.23 2807.71,-7432.23 2859.47,-7558.23"/>
<text text-anchor="middle" x="2733" y="-7514.73" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2733" y="-7503.73" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-7492.73" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-7481.73" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2733" y="-7470.73" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer10_ln2&#45;&gt;gpu4_layer10_routing -->
<g id="edge1512" class="edge">
<title>gpu4_layer10_ln2&#45;&gt;gpu4_layer10_routing</title>
<path fill="none" stroke="black" d="M2733,-7595.14C2733,-7587.21 2733,-7578.01 2733,-7568.48"/>
<polygon fill="black" stroke="black" points="2736.5,-7568.47 2733,-7558.47 2729.5,-7568.47 2736.5,-7568.47"/>
</g>
<!-- gpu4_layer10_expert0 -->
<g id="node1214" class="node">
<title>gpu4_layer10_expert0</title>
<polygon fill="lightblue" stroke="black" points="2514,-7386.23 2392,-7386.23 2392,-7334.23 2514,-7334.23 2514,-7386.23"/>
<text text-anchor="middle" x="2453" y="-7374.23" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="2453" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer10_routing&#45;&gt;gpu4_layer10_expert0 -->
<g id="edge1499" class="edge">
<title>gpu4_layer10_routing&#45;&gt;gpu4_layer10_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2607.33,-7434.54C2575.34,-7419.35 2542.34,-7403.67 2515.11,-7390.74"/>
<polygon fill="black" stroke="black" points="2516.26,-7387.41 2505.73,-7386.28 2513.26,-7393.73 2516.26,-7387.41"/>
<text text-anchor="middle" x="2588.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer10_expert1 -->
<g id="node1215" class="node">
<title>gpu4_layer10_expert1</title>
<polygon fill="lightblue" stroke="black" points="2654,-7386.23 2532,-7386.23 2532,-7334.23 2654,-7334.23 2654,-7386.23"/>
<text text-anchor="middle" x="2593" y="-7374.23" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="2593" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer10_routing&#45;&gt;gpu4_layer10_expert1 -->
<g id="edge1500" class="edge">
<title>gpu4_layer10_routing&#45;&gt;gpu4_layer10_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2667.51,-7432.02C2653.48,-7418.69 2639.21,-7405.14 2626.97,-7393.5"/>
<polygon fill="black" stroke="black" points="2629.29,-7390.88 2619.63,-7386.53 2624.46,-7395.95 2629.29,-7390.88"/>
<text text-anchor="middle" x="2675.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer10_expert2 -->
<g id="node1216" class="node">
<title>gpu4_layer10_expert2</title>
<polygon fill="lightblue" stroke="black" points="2794,-7386.23 2672,-7386.23 2672,-7334.23 2794,-7334.23 2794,-7386.23"/>
<text text-anchor="middle" x="2733" y="-7374.23" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2733" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer10_routing&#45;&gt;gpu4_layer10_expert2 -->
<g id="edge1501" class="edge">
<title>gpu4_layer10_routing&#45;&gt;gpu4_layer10_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2733,-7432.02C2733,-7419.95 2733,-7407.69 2733,-7396.85"/>
<polygon fill="black" stroke="black" points="2736.5,-7396.53 2733,-7386.53 2729.5,-7396.53 2736.5,-7396.53"/>
<text text-anchor="middle" x="2762.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer10_expert3 -->
<g id="node1217" class="node">
<title>gpu4_layer10_expert3</title>
<polygon fill="lightblue" stroke="black" points="2934,-7386.23 2812,-7386.23 2812,-7334.23 2934,-7334.23 2934,-7386.23"/>
<text text-anchor="middle" x="2873" y="-7374.23" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2873" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer10_routing&#45;&gt;gpu4_layer10_expert3 -->
<g id="edge1502" class="edge">
<title>gpu4_layer10_routing&#45;&gt;gpu4_layer10_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2798.49,-7432.02C2812.52,-7418.69 2826.79,-7405.14 2839.03,-7393.5"/>
<polygon fill="black" stroke="black" points="2841.54,-7395.95 2846.37,-7386.53 2836.71,-7390.88 2841.54,-7395.95"/>
<text text-anchor="middle" x="2856.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer10_expert_agg -->
<g id="node1218" class="node">
<title>gpu4_layer10_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-7297.23 2658.29,-7297.23 2606.53,-7193.23 2807.71,-7193.23 2859.47,-7297.23"/>
<text text-anchor="middle" x="2733" y="-7259.23" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2733" y="-7248.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-7237.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-7226.23" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer10_routing&#45;&gt;gpu4_layer10_expert_agg -->
<g id="edge1517" class="edge">
<title>gpu4_layer10_routing&#45;&gt;gpu4_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M2822.22,-7467.32C2895.96,-7440.16 2982.6,-7393.77 2943,-7334.23 2922.44,-7303.32 2888.7,-7283.25 2854.22,-7270.22"/>
<polygon fill="black" stroke="black" points="2855.08,-7266.81 2844.48,-7266.73 2852.71,-7273.4 2855.08,-7266.81"/>
</g>
<!-- gpu4_layer10_expert0&#45;&gt;gpu4_layer10_expert_agg -->
<g id="edge1513" class="edge">
<title>gpu4_layer10_expert0&#45;&gt;gpu4_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M2514.1,-7334.58C2550.98,-7319.69 2598.7,-7300.44 2640.16,-7283.7"/>
<polygon fill="black" stroke="black" points="2641.5,-7286.94 2649.46,-7279.95 2638.88,-7280.45 2641.5,-7286.94"/>
</g>
<!-- gpu4_layer10_expert1&#45;&gt;gpu4_layer10_expert_agg -->
<g id="edge1514" class="edge">
<title>gpu4_layer10_expert1&#45;&gt;gpu4_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M2624.07,-7334.16C2635.32,-7325.08 2648.53,-7314.42 2661.8,-7303.71"/>
<polygon fill="black" stroke="black" points="2664.02,-7306.41 2669.6,-7297.41 2659.62,-7300.96 2664.02,-7306.41"/>
</g>
<!-- gpu4_layer10_expert2&#45;&gt;gpu4_layer10_expert_agg -->
<g id="edge1515" class="edge">
<title>gpu4_layer10_expert2&#45;&gt;gpu4_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M2733,-7334.16C2733,-7326.23 2733,-7317.09 2733,-7307.77"/>
<polygon fill="black" stroke="black" points="2736.5,-7307.64 2733,-7297.64 2729.5,-7307.64 2736.5,-7307.64"/>
</g>
<!-- gpu4_layer10_expert3&#45;&gt;gpu4_layer10_expert_agg -->
<g id="edge1516" class="edge">
<title>gpu4_layer10_expert3&#45;&gt;gpu4_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M2841.93,-7334.16C2830.68,-7325.08 2817.47,-7314.42 2804.2,-7303.71"/>
<polygon fill="black" stroke="black" points="2806.38,-7300.96 2796.4,-7297.41 2801.98,-7306.41 2806.38,-7300.96"/>
</g>
<!-- gpu4_layer10_res2 -->
<g id="node1219" class="node">
<title>gpu4_layer10_res2</title>
<polygon fill="lightblue" stroke="black" points="2794,-7156.23 2672,-7156.23 2672,-7104.23 2794,-7104.23 2794,-7156.23"/>
<text text-anchor="middle" x="2733" y="-7144.23" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2733" y="-7133.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-7122.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-7111.23" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer10_expert_agg&#45;&gt;gpu4_layer10_res2 -->
<g id="edge1518" class="edge">
<title>gpu4_layer10_expert_agg&#45;&gt;gpu4_layer10_res2</title>
<path fill="none" stroke="black" d="M2733,-7193.02C2733,-7184.07 2733,-7174.94 2733,-7166.55"/>
<polygon fill="black" stroke="black" points="2736.5,-7166.37 2733,-7156.37 2729.5,-7166.37 2736.5,-7166.37"/>
</g>
<!-- gpu4_layer11_ln1 -->
<g id="node1220" class="node">
<title>gpu4_layer11_ln1</title>
<polygon fill="lightblue" stroke="black" points="2794,-7067.23 2672,-7067.23 2672,-7015.23 2794,-7015.23 2794,-7067.23"/>
<text text-anchor="middle" x="2733" y="-7055.23" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2733" y="-7044.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-7033.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-7022.23" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer10_res2&#45;&gt;gpu4_layer11_ln1 -->
<g id="edge1523" class="edge">
<title>gpu4_layer10_res2&#45;&gt;gpu4_layer11_ln1</title>
<path fill="none" stroke="black" d="M2733,-7104.07C2733,-7095.77 2733,-7086.39 2733,-7077.48"/>
<polygon fill="black" stroke="black" points="2736.5,-7077.34 2733,-7067.34 2729.5,-7077.34 2736.5,-7077.34"/>
</g>
<!-- gpu4_layer11_qkv -->
<g id="node1221" class="node">
<title>gpu4_layer11_qkv</title>
<polygon fill="lightblue" stroke="black" points="2794,-6978.23 2672,-6978.23 2672,-6926.23 2794,-6926.23 2794,-6978.23"/>
<text text-anchor="middle" x="2733" y="-6966.23" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2733" y="-6955.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-6944.23" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-6933.23" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer11_ln1&#45;&gt;gpu4_layer11_qkv -->
<g id="edge1524" class="edge">
<title>gpu4_layer11_ln1&#45;&gt;gpu4_layer11_qkv</title>
<path fill="none" stroke="black" d="M2733,-7015.07C2733,-7006.77 2733,-6997.39 2733,-6988.48"/>
<polygon fill="black" stroke="black" points="2736.5,-6988.34 2733,-6978.34 2729.5,-6988.34 2736.5,-6988.34"/>
</g>
<!-- gpu4_layer11_reshape -->
<g id="node1222" class="node">
<title>gpu4_layer11_reshape</title>
<polygon fill="lightblue" stroke="black" points="2797,-6889.23 2669,-6889.23 2669,-6837.23 2797,-6837.23 2797,-6889.23"/>
<text text-anchor="middle" x="2733" y="-6877.23" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2733" y="-6866.23" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-6855.23" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-6844.23" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer11_qkv&#45;&gt;gpu4_layer11_reshape -->
<g id="edge1525" class="edge">
<title>gpu4_layer11_qkv&#45;&gt;gpu4_layer11_reshape</title>
<path fill="none" stroke="black" d="M2733,-6926.07C2733,-6917.77 2733,-6908.39 2733,-6899.48"/>
<polygon fill="black" stroke="black" points="2736.5,-6899.34 2733,-6889.34 2729.5,-6899.34 2736.5,-6899.34"/>
</g>
<!-- gpu4_layer11_attn -->
<g id="node1223" class="node">
<title>gpu4_layer11_attn</title>
<polygon fill="lightblue" stroke="black" points="2797,-6800.23 2669,-6800.23 2669,-6748.23 2797,-6748.23 2797,-6800.23"/>
<text text-anchor="middle" x="2733" y="-6788.23" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2733" y="-6777.23" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-6766.23" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-6755.23" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer11_reshape&#45;&gt;gpu4_layer11_attn -->
<g id="edge1526" class="edge">
<title>gpu4_layer11_reshape&#45;&gt;gpu4_layer11_attn</title>
<path fill="none" stroke="black" d="M2733,-6837.07C2733,-6828.77 2733,-6819.39 2733,-6810.48"/>
<polygon fill="black" stroke="black" points="2736.5,-6810.34 2733,-6800.34 2729.5,-6810.34 2736.5,-6810.34"/>
</g>
<!-- gpu4_layer11_attn_reshape -->
<g id="node1225" class="node">
<title>gpu4_layer11_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2794,-6711.23 2672,-6711.23 2672,-6659.23 2794,-6659.23 2794,-6711.23"/>
<text text-anchor="middle" x="2733" y="-6699.23" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2733" y="-6688.23" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-6677.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-6666.23" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer11_attn&#45;&gt;gpu4_layer11_attn_reshape -->
<g id="edge1527" class="edge">
<title>gpu4_layer11_attn&#45;&gt;gpu4_layer11_attn_reshape</title>
<path fill="none" stroke="black" d="M2733,-6748.07C2733,-6739.77 2733,-6730.39 2733,-6721.48"/>
<polygon fill="black" stroke="black" points="2736.5,-6721.34 2733,-6711.34 2729.5,-6721.34 2736.5,-6721.34"/>
</g>
<!-- gpu4_layer11_attn_out -->
<g id="node1224" class="node">
<title>gpu4_layer11_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2794,-6622.23 2672,-6622.23 2672,-6570.23 2794,-6570.23 2794,-6622.23"/>
<text text-anchor="middle" x="2733" y="-6610.23" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2733" y="-6599.23" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-6588.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-6577.23" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer11_kv_update -->
<g id="node1226" class="node">
<title>gpu4_layer11_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2733" cy="-6496.47" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2733" y="-6510.47" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2733" y="-6499.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-6488.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-6477.47" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer11_attn_out&#45;&gt;gpu4_layer11_kv_update -->
<g id="edge1529" class="edge">
<title>gpu4_layer11_attn_out&#45;&gt;gpu4_layer11_kv_update</title>
<path fill="none" stroke="black" d="M2733,-6570.06C2733,-6561.92 2733,-6552.62 2733,-6543.46"/>
<polygon fill="black" stroke="black" points="2736.5,-6543.24 2733,-6533.24 2729.5,-6543.24 2736.5,-6543.24"/>
</g>
<!-- gpu4_layer11_attn_reshape&#45;&gt;gpu4_layer11_attn_out -->
<g id="edge1528" class="edge">
<title>gpu4_layer11_attn_reshape&#45;&gt;gpu4_layer11_attn_out</title>
<path fill="none" stroke="black" d="M2733,-6659.07C2733,-6650.77 2733,-6641.39 2733,-6632.48"/>
<polygon fill="black" stroke="black" points="2736.5,-6632.34 2733,-6622.34 2729.5,-6632.34 2736.5,-6632.34"/>
</g>
<!-- gpu4_layer11_res1 -->
<g id="node1227" class="node">
<title>gpu4_layer11_res1</title>
<polygon fill="lightblue" stroke="black" points="2794,-6422.7 2672,-6422.7 2672,-6370.7 2794,-6370.7 2794,-6422.7"/>
<text text-anchor="middle" x="2733" y="-6410.7" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2733" y="-6399.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-6388.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-6377.7" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer11_kv_update&#45;&gt;gpu4_layer11_res1 -->
<g id="edge1530" class="edge">
<title>gpu4_layer11_kv_update&#45;&gt;gpu4_layer11_res1</title>
<path fill="none" stroke="black" d="M2733,-6459.61C2733,-6450.94 2733,-6441.67 2733,-6433.01"/>
<polygon fill="black" stroke="black" points="2736.5,-6432.84 2733,-6422.84 2729.5,-6432.84 2736.5,-6432.84"/>
</g>
<!-- gpu4_layer11_ln2 -->
<g id="node1228" class="node">
<title>gpu4_layer11_ln2</title>
<polygon fill="lightblue" stroke="black" points="2794,-6333.7 2672,-6333.7 2672,-6281.7 2794,-6281.7 2794,-6333.7"/>
<text text-anchor="middle" x="2733" y="-6321.7" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2733" y="-6310.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-6299.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-6288.7" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer11_res1&#45;&gt;gpu4_layer11_ln2 -->
<g id="edge1531" class="edge">
<title>gpu4_layer11_res1&#45;&gt;gpu4_layer11_ln2</title>
<path fill="none" stroke="black" d="M2733,-6370.53C2733,-6362.24 2733,-6352.85 2733,-6343.94"/>
<polygon fill="black" stroke="black" points="2736.5,-6343.8 2733,-6333.8 2729.5,-6343.8 2736.5,-6343.8"/>
</g>
<!-- gpu4_layer11_routing -->
<g id="node1229" class="node">
<title>gpu4_layer11_routing</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-6244.7 2658.29,-6244.7 2606.53,-6118.7 2807.71,-6118.7 2859.47,-6244.7"/>
<text text-anchor="middle" x="2733" y="-6201.2" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2733" y="-6190.2" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-6179.2" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-6168.2" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2733" y="-6157.2" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer11_ln2&#45;&gt;gpu4_layer11_routing -->
<g id="edge1532" class="edge">
<title>gpu4_layer11_ln2&#45;&gt;gpu4_layer11_routing</title>
<path fill="none" stroke="black" d="M2733,-6281.6C2733,-6273.67 2733,-6264.47 2733,-6254.94"/>
<polygon fill="black" stroke="black" points="2736.5,-6254.93 2733,-6244.93 2729.5,-6254.93 2736.5,-6254.93"/>
</g>
<!-- gpu4_layer11_expert0 -->
<g id="node1230" class="node">
<title>gpu4_layer11_expert0</title>
<polygon fill="lightblue" stroke="black" points="2514,-6072.7 2392,-6072.7 2392,-6020.7 2514,-6020.7 2514,-6072.7"/>
<text text-anchor="middle" x="2453" y="-6060.7" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="2453" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer11_routing&#45;&gt;gpu4_layer11_expert0 -->
<g id="edge1519" class="edge">
<title>gpu4_layer11_routing&#45;&gt;gpu4_layer11_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2607.33,-6121C2575.34,-6105.81 2542.34,-6090.13 2515.11,-6077.2"/>
<polygon fill="black" stroke="black" points="2516.26,-6073.87 2505.73,-6072.74 2513.26,-6080.19 2516.26,-6073.87"/>
<text text-anchor="middle" x="2588.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer11_expert1 -->
<g id="node1231" class="node">
<title>gpu4_layer11_expert1</title>
<polygon fill="lightblue" stroke="black" points="2654,-6072.7 2532,-6072.7 2532,-6020.7 2654,-6020.7 2654,-6072.7"/>
<text text-anchor="middle" x="2593" y="-6060.7" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="2593" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer11_routing&#45;&gt;gpu4_layer11_expert1 -->
<g id="edge1520" class="edge">
<title>gpu4_layer11_routing&#45;&gt;gpu4_layer11_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2667.51,-6118.48C2653.48,-6105.15 2639.21,-6091.6 2626.97,-6079.97"/>
<polygon fill="black" stroke="black" points="2629.29,-6077.34 2619.63,-6072.99 2624.46,-6082.41 2629.29,-6077.34"/>
<text text-anchor="middle" x="2675.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer11_expert2 -->
<g id="node1232" class="node">
<title>gpu4_layer11_expert2</title>
<polygon fill="lightblue" stroke="black" points="2794,-6072.7 2672,-6072.7 2672,-6020.7 2794,-6020.7 2794,-6072.7"/>
<text text-anchor="middle" x="2733" y="-6060.7" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2733" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer11_routing&#45;&gt;gpu4_layer11_expert2 -->
<g id="edge1521" class="edge">
<title>gpu4_layer11_routing&#45;&gt;gpu4_layer11_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2733,-6118.48C2733,-6106.41 2733,-6094.15 2733,-6083.31"/>
<polygon fill="black" stroke="black" points="2736.5,-6082.99 2733,-6072.99 2729.5,-6082.99 2736.5,-6082.99"/>
<text text-anchor="middle" x="2762.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer11_expert3 -->
<g id="node1233" class="node">
<title>gpu4_layer11_expert3</title>
<polygon fill="lightblue" stroke="black" points="2934,-6072.7 2812,-6072.7 2812,-6020.7 2934,-6020.7 2934,-6072.7"/>
<text text-anchor="middle" x="2873" y="-6060.7" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2873" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer11_routing&#45;&gt;gpu4_layer11_expert3 -->
<g id="edge1522" class="edge">
<title>gpu4_layer11_routing&#45;&gt;gpu4_layer11_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2798.49,-6118.48C2812.52,-6105.15 2826.79,-6091.6 2839.03,-6079.97"/>
<polygon fill="black" stroke="black" points="2841.54,-6082.41 2846.37,-6072.99 2836.71,-6077.34 2841.54,-6082.41"/>
<text text-anchor="middle" x="2856.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer11_expert_agg -->
<g id="node1234" class="node">
<title>gpu4_layer11_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-5983.7 2658.29,-5983.7 2606.53,-5879.7 2807.71,-5879.7 2859.47,-5983.7"/>
<text text-anchor="middle" x="2733" y="-5945.7" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2733" y="-5934.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-5923.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-5912.7" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer11_routing&#45;&gt;gpu4_layer11_expert_agg -->
<g id="edge1537" class="edge">
<title>gpu4_layer11_routing&#45;&gt;gpu4_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M2822.22,-6153.78C2895.96,-6126.62 2982.6,-6080.23 2943,-6020.7 2922.44,-5989.78 2888.7,-5969.71 2854.22,-5956.68"/>
<polygon fill="black" stroke="black" points="2855.08,-5953.27 2844.48,-5953.19 2852.71,-5959.86 2855.08,-5953.27"/>
</g>
<!-- gpu4_layer11_expert0&#45;&gt;gpu4_layer11_expert_agg -->
<g id="edge1533" class="edge">
<title>gpu4_layer11_expert0&#45;&gt;gpu4_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M2514.1,-6021.04C2550.98,-6006.15 2598.7,-5986.9 2640.16,-5970.16"/>
<polygon fill="black" stroke="black" points="2641.5,-5973.4 2649.46,-5966.41 2638.88,-5966.91 2641.5,-5973.4"/>
</g>
<!-- gpu4_layer11_expert1&#45;&gt;gpu4_layer11_expert_agg -->
<g id="edge1534" class="edge">
<title>gpu4_layer11_expert1&#45;&gt;gpu4_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M2624.07,-6020.62C2635.32,-6011.54 2648.53,-6000.88 2661.8,-5990.17"/>
<polygon fill="black" stroke="black" points="2664.02,-5992.87 2669.6,-5983.87 2659.62,-5987.42 2664.02,-5992.87"/>
</g>
<!-- gpu4_layer11_expert2&#45;&gt;gpu4_layer11_expert_agg -->
<g id="edge1535" class="edge">
<title>gpu4_layer11_expert2&#45;&gt;gpu4_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M2733,-6020.62C2733,-6012.69 2733,-6003.55 2733,-5994.23"/>
<polygon fill="black" stroke="black" points="2736.5,-5994.1 2733,-5984.1 2729.5,-5994.1 2736.5,-5994.1"/>
</g>
<!-- gpu4_layer11_expert3&#45;&gt;gpu4_layer11_expert_agg -->
<g id="edge1536" class="edge">
<title>gpu4_layer11_expert3&#45;&gt;gpu4_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M2841.93,-6020.62C2830.68,-6011.54 2817.47,-6000.88 2804.2,-5990.17"/>
<polygon fill="black" stroke="black" points="2806.38,-5987.42 2796.4,-5983.87 2801.98,-5992.87 2806.38,-5987.42"/>
</g>
<!-- gpu4_layer11_res2 -->
<g id="node1235" class="node">
<title>gpu4_layer11_res2</title>
<polygon fill="lightblue" stroke="black" points="2794,-5842.7 2672,-5842.7 2672,-5790.7 2794,-5790.7 2794,-5842.7"/>
<text text-anchor="middle" x="2733" y="-5830.7" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2733" y="-5819.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-5808.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-5797.7" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer11_expert_agg&#45;&gt;gpu4_layer11_res2 -->
<g id="edge1538" class="edge">
<title>gpu4_layer11_expert_agg&#45;&gt;gpu4_layer11_res2</title>
<path fill="none" stroke="black" d="M2733,-5879.49C2733,-5870.53 2733,-5861.41 2733,-5853.01"/>
<polygon fill="black" stroke="black" points="2736.5,-5852.83 2733,-5842.83 2729.5,-5852.83 2736.5,-5852.83"/>
</g>
<!-- gpu4_layer12_ln1 -->
<g id="node1236" class="node">
<title>gpu4_layer12_ln1</title>
<polygon fill="lightblue" stroke="black" points="2794,-5753.7 2672,-5753.7 2672,-5701.7 2794,-5701.7 2794,-5753.7"/>
<text text-anchor="middle" x="2733" y="-5741.7" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2733" y="-5730.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-5719.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-5708.7" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer11_res2&#45;&gt;gpu4_layer12_ln1 -->
<g id="edge1543" class="edge">
<title>gpu4_layer11_res2&#45;&gt;gpu4_layer12_ln1</title>
<path fill="none" stroke="black" d="M2733,-5790.53C2733,-5782.24 2733,-5772.85 2733,-5763.94"/>
<polygon fill="black" stroke="black" points="2736.5,-5763.8 2733,-5753.8 2729.5,-5763.8 2736.5,-5763.8"/>
</g>
<!-- gpu4_layer12_qkv -->
<g id="node1237" class="node">
<title>gpu4_layer12_qkv</title>
<polygon fill="lightblue" stroke="black" points="2794,-5664.7 2672,-5664.7 2672,-5612.7 2794,-5612.7 2794,-5664.7"/>
<text text-anchor="middle" x="2733" y="-5652.7" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2733" y="-5641.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-5630.7" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-5619.7" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer12_ln1&#45;&gt;gpu4_layer12_qkv -->
<g id="edge1544" class="edge">
<title>gpu4_layer12_ln1&#45;&gt;gpu4_layer12_qkv</title>
<path fill="none" stroke="black" d="M2733,-5701.53C2733,-5693.24 2733,-5683.85 2733,-5674.94"/>
<polygon fill="black" stroke="black" points="2736.5,-5674.8 2733,-5664.8 2729.5,-5674.8 2736.5,-5674.8"/>
</g>
<!-- gpu4_layer12_reshape -->
<g id="node1238" class="node">
<title>gpu4_layer12_reshape</title>
<polygon fill="lightblue" stroke="black" points="2797,-5575.7 2669,-5575.7 2669,-5523.7 2797,-5523.7 2797,-5575.7"/>
<text text-anchor="middle" x="2733" y="-5563.7" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2733" y="-5552.7" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-5541.7" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-5530.7" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer12_qkv&#45;&gt;gpu4_layer12_reshape -->
<g id="edge1545" class="edge">
<title>gpu4_layer12_qkv&#45;&gt;gpu4_layer12_reshape</title>
<path fill="none" stroke="black" d="M2733,-5612.53C2733,-5604.24 2733,-5594.85 2733,-5585.94"/>
<polygon fill="black" stroke="black" points="2736.5,-5585.8 2733,-5575.8 2729.5,-5585.8 2736.5,-5585.8"/>
</g>
<!-- gpu4_layer12_attn -->
<g id="node1239" class="node">
<title>gpu4_layer12_attn</title>
<polygon fill="lightblue" stroke="black" points="2797,-5486.7 2669,-5486.7 2669,-5434.7 2797,-5434.7 2797,-5486.7"/>
<text text-anchor="middle" x="2733" y="-5474.7" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2733" y="-5463.7" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-5452.7" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-5441.7" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer12_reshape&#45;&gt;gpu4_layer12_attn -->
<g id="edge1546" class="edge">
<title>gpu4_layer12_reshape&#45;&gt;gpu4_layer12_attn</title>
<path fill="none" stroke="black" d="M2733,-5523.53C2733,-5515.24 2733,-5505.85 2733,-5496.94"/>
<polygon fill="black" stroke="black" points="2736.5,-5496.8 2733,-5486.8 2729.5,-5496.8 2736.5,-5496.8"/>
</g>
<!-- gpu4_layer12_attn_reshape -->
<g id="node1241" class="node">
<title>gpu4_layer12_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2794,-5397.7 2672,-5397.7 2672,-5345.7 2794,-5345.7 2794,-5397.7"/>
<text text-anchor="middle" x="2733" y="-5385.7" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2733" y="-5374.7" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-5363.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-5352.7" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer12_attn&#45;&gt;gpu4_layer12_attn_reshape -->
<g id="edge1547" class="edge">
<title>gpu4_layer12_attn&#45;&gt;gpu4_layer12_attn_reshape</title>
<path fill="none" stroke="black" d="M2733,-5434.53C2733,-5426.24 2733,-5416.85 2733,-5407.94"/>
<polygon fill="black" stroke="black" points="2736.5,-5407.8 2733,-5397.8 2729.5,-5407.8 2736.5,-5407.8"/>
</g>
<!-- gpu4_layer12_attn_out -->
<g id="node1240" class="node">
<title>gpu4_layer12_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2794,-5308.7 2672,-5308.7 2672,-5256.7 2794,-5256.7 2794,-5308.7"/>
<text text-anchor="middle" x="2733" y="-5296.7" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2733" y="-5285.7" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-5274.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-5263.7" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer12_kv_update -->
<g id="node1242" class="node">
<title>gpu4_layer12_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2733" cy="-5182.93" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2733" y="-5196.93" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2733" y="-5185.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-5174.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-5163.93" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer12_attn_out&#45;&gt;gpu4_layer12_kv_update -->
<g id="edge1549" class="edge">
<title>gpu4_layer12_attn_out&#45;&gt;gpu4_layer12_kv_update</title>
<path fill="none" stroke="black" d="M2733,-5256.52C2733,-5248.38 2733,-5239.08 2733,-5229.92"/>
<polygon fill="black" stroke="black" points="2736.5,-5229.71 2733,-5219.71 2729.5,-5229.71 2736.5,-5229.71"/>
</g>
<!-- gpu4_layer12_attn_reshape&#45;&gt;gpu4_layer12_attn_out -->
<g id="edge1548" class="edge">
<title>gpu4_layer12_attn_reshape&#45;&gt;gpu4_layer12_attn_out</title>
<path fill="none" stroke="black" d="M2733,-5345.53C2733,-5337.24 2733,-5327.85 2733,-5318.94"/>
<polygon fill="black" stroke="black" points="2736.5,-5318.8 2733,-5308.8 2729.5,-5318.8 2736.5,-5318.8"/>
</g>
<!-- gpu4_layer12_res1 -->
<g id="node1243" class="node">
<title>gpu4_layer12_res1</title>
<polygon fill="lightblue" stroke="black" points="2794,-5109.16 2672,-5109.16 2672,-5057.16 2794,-5057.16 2794,-5109.16"/>
<text text-anchor="middle" x="2733" y="-5097.16" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2733" y="-5086.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-5075.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-5064.16" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer12_kv_update&#45;&gt;gpu4_layer12_res1 -->
<g id="edge1550" class="edge">
<title>gpu4_layer12_kv_update&#45;&gt;gpu4_layer12_res1</title>
<path fill="none" stroke="black" d="M2733,-5146.08C2733,-5137.4 2733,-5128.13 2733,-5119.47"/>
<polygon fill="black" stroke="black" points="2736.5,-5119.3 2733,-5109.3 2729.5,-5119.3 2736.5,-5119.3"/>
</g>
<!-- gpu4_layer12_ln2 -->
<g id="node1244" class="node">
<title>gpu4_layer12_ln2</title>
<polygon fill="lightblue" stroke="black" points="2794,-5020.16 2672,-5020.16 2672,-4968.16 2794,-4968.16 2794,-5020.16"/>
<text text-anchor="middle" x="2733" y="-5008.16" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2733" y="-4997.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-4986.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-4975.16" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer12_res1&#45;&gt;gpu4_layer12_ln2 -->
<g id="edge1551" class="edge">
<title>gpu4_layer12_res1&#45;&gt;gpu4_layer12_ln2</title>
<path fill="none" stroke="black" d="M2733,-5056.99C2733,-5048.7 2733,-5039.31 2733,-5030.4"/>
<polygon fill="black" stroke="black" points="2736.5,-5030.26 2733,-5020.26 2729.5,-5030.26 2736.5,-5030.26"/>
</g>
<!-- gpu4_layer12_routing -->
<g id="node1245" class="node">
<title>gpu4_layer12_routing</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-4931.16 2658.29,-4931.16 2606.53,-4805.16 2807.71,-4805.16 2859.47,-4931.16"/>
<text text-anchor="middle" x="2733" y="-4887.66" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2733" y="-4876.66" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-4865.66" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-4854.66" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2733" y="-4843.66" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer12_ln2&#45;&gt;gpu4_layer12_routing -->
<g id="edge1552" class="edge">
<title>gpu4_layer12_ln2&#45;&gt;gpu4_layer12_routing</title>
<path fill="none" stroke="black" d="M2733,-4968.06C2733,-4960.13 2733,-4950.93 2733,-4941.4"/>
<polygon fill="black" stroke="black" points="2736.5,-4941.39 2733,-4931.39 2729.5,-4941.39 2736.5,-4941.39"/>
</g>
<!-- gpu4_layer12_expert0 -->
<g id="node1246" class="node">
<title>gpu4_layer12_expert0</title>
<polygon fill="lightblue" stroke="black" points="2514,-4759.16 2392,-4759.16 2392,-4707.16 2514,-4707.16 2514,-4759.16"/>
<text text-anchor="middle" x="2453" y="-4747.16" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="2453" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer12_routing&#45;&gt;gpu4_layer12_expert0 -->
<g id="edge1539" class="edge">
<title>gpu4_layer12_routing&#45;&gt;gpu4_layer12_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2607.33,-4807.46C2575.34,-4792.27 2542.34,-4776.59 2515.11,-4763.66"/>
<polygon fill="black" stroke="black" points="2516.26,-4760.33 2505.73,-4759.2 2513.26,-4766.65 2516.26,-4760.33"/>
<text text-anchor="middle" x="2588.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer12_expert1 -->
<g id="node1247" class="node">
<title>gpu4_layer12_expert1</title>
<polygon fill="lightblue" stroke="black" points="2654,-4759.16 2532,-4759.16 2532,-4707.16 2654,-4707.16 2654,-4759.16"/>
<text text-anchor="middle" x="2593" y="-4747.16" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="2593" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer12_routing&#45;&gt;gpu4_layer12_expert1 -->
<g id="edge1540" class="edge">
<title>gpu4_layer12_routing&#45;&gt;gpu4_layer12_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2667.51,-4804.94C2653.48,-4791.62 2639.21,-4778.06 2626.97,-4766.43"/>
<polygon fill="black" stroke="black" points="2629.29,-4763.8 2619.63,-4759.45 2624.46,-4768.88 2629.29,-4763.8"/>
<text text-anchor="middle" x="2675.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer12_expert2 -->
<g id="node1248" class="node">
<title>gpu4_layer12_expert2</title>
<polygon fill="lightblue" stroke="black" points="2794,-4759.16 2672,-4759.16 2672,-4707.16 2794,-4707.16 2794,-4759.16"/>
<text text-anchor="middle" x="2733" y="-4747.16" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2733" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer12_routing&#45;&gt;gpu4_layer12_expert2 -->
<g id="edge1541" class="edge">
<title>gpu4_layer12_routing&#45;&gt;gpu4_layer12_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2733,-4804.94C2733,-4792.87 2733,-4780.62 2733,-4769.77"/>
<polygon fill="black" stroke="black" points="2736.5,-4769.45 2733,-4759.45 2729.5,-4769.45 2736.5,-4769.45"/>
<text text-anchor="middle" x="2762.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer12_expert3 -->
<g id="node1249" class="node">
<title>gpu4_layer12_expert3</title>
<polygon fill="lightblue" stroke="black" points="2934,-4759.16 2812,-4759.16 2812,-4707.16 2934,-4707.16 2934,-4759.16"/>
<text text-anchor="middle" x="2873" y="-4747.16" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2873" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer12_routing&#45;&gt;gpu4_layer12_expert3 -->
<g id="edge1542" class="edge">
<title>gpu4_layer12_routing&#45;&gt;gpu4_layer12_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2798.49,-4804.94C2812.52,-4791.62 2826.79,-4778.06 2839.03,-4766.43"/>
<polygon fill="black" stroke="black" points="2841.54,-4768.88 2846.37,-4759.45 2836.71,-4763.8 2841.54,-4768.88"/>
<text text-anchor="middle" x="2856.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer12_expert_agg -->
<g id="node1250" class="node">
<title>gpu4_layer12_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-4670.16 2658.29,-4670.16 2606.53,-4566.16 2807.71,-4566.16 2859.47,-4670.16"/>
<text text-anchor="middle" x="2733" y="-4632.16" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2733" y="-4621.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-4610.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-4599.16" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer12_routing&#45;&gt;gpu4_layer12_expert_agg -->
<g id="edge1557" class="edge">
<title>gpu4_layer12_routing&#45;&gt;gpu4_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M2822.22,-4840.24C2895.96,-4813.08 2982.6,-4766.69 2943,-4707.16 2922.44,-4676.24 2888.7,-4656.17 2854.22,-4643.14"/>
<polygon fill="black" stroke="black" points="2855.08,-4639.73 2844.48,-4639.65 2852.71,-4646.32 2855.08,-4639.73"/>
</g>
<!-- gpu4_layer12_expert0&#45;&gt;gpu4_layer12_expert_agg -->
<g id="edge1553" class="edge">
<title>gpu4_layer12_expert0&#45;&gt;gpu4_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M2514.1,-4707.5C2550.98,-4692.62 2598.7,-4673.36 2640.16,-4656.62"/>
<polygon fill="black" stroke="black" points="2641.5,-4659.86 2649.46,-4652.87 2638.88,-4653.37 2641.5,-4659.86"/>
</g>
<!-- gpu4_layer12_expert1&#45;&gt;gpu4_layer12_expert_agg -->
<g id="edge1554" class="edge">
<title>gpu4_layer12_expert1&#45;&gt;gpu4_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M2624.07,-4707.08C2635.32,-4698 2648.53,-4687.34 2661.8,-4676.63"/>
<polygon fill="black" stroke="black" points="2664.02,-4679.33 2669.6,-4670.33 2659.62,-4673.89 2664.02,-4679.33"/>
</g>
<!-- gpu4_layer12_expert2&#45;&gt;gpu4_layer12_expert_agg -->
<g id="edge1555" class="edge">
<title>gpu4_layer12_expert2&#45;&gt;gpu4_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M2733,-4707.08C2733,-4699.15 2733,-4690.02 2733,-4680.69"/>
<polygon fill="black" stroke="black" points="2736.5,-4680.56 2733,-4670.56 2729.5,-4680.56 2736.5,-4680.56"/>
</g>
<!-- gpu4_layer12_expert3&#45;&gt;gpu4_layer12_expert_agg -->
<g id="edge1556" class="edge">
<title>gpu4_layer12_expert3&#45;&gt;gpu4_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M2841.93,-4707.08C2830.68,-4698 2817.47,-4687.34 2804.2,-4676.63"/>
<polygon fill="black" stroke="black" points="2806.38,-4673.89 2796.4,-4670.33 2801.98,-4679.33 2806.38,-4673.89"/>
</g>
<!-- gpu4_layer12_res2 -->
<g id="node1251" class="node">
<title>gpu4_layer12_res2</title>
<polygon fill="lightblue" stroke="black" points="2794,-4529.16 2672,-4529.16 2672,-4477.16 2794,-4477.16 2794,-4529.16"/>
<text text-anchor="middle" x="2733" y="-4517.16" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2733" y="-4506.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-4495.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-4484.16" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer12_expert_agg&#45;&gt;gpu4_layer12_res2 -->
<g id="edge1558" class="edge">
<title>gpu4_layer12_expert_agg&#45;&gt;gpu4_layer12_res2</title>
<path fill="none" stroke="black" d="M2733,-4565.95C2733,-4557 2733,-4547.87 2733,-4539.47"/>
<polygon fill="black" stroke="black" points="2736.5,-4539.29 2733,-4529.29 2729.5,-4539.29 2736.5,-4539.29"/>
</g>
<!-- gpu4_layer13_ln1 -->
<g id="node1252" class="node">
<title>gpu4_layer13_ln1</title>
<polygon fill="lightblue" stroke="black" points="2794,-4440.16 2672,-4440.16 2672,-4388.16 2794,-4388.16 2794,-4440.16"/>
<text text-anchor="middle" x="2733" y="-4428.16" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2733" y="-4417.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-4406.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-4395.16" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer12_res2&#45;&gt;gpu4_layer13_ln1 -->
<g id="edge1563" class="edge">
<title>gpu4_layer12_res2&#45;&gt;gpu4_layer13_ln1</title>
<path fill="none" stroke="black" d="M2733,-4476.99C2733,-4468.7 2733,-4459.31 2733,-4450.4"/>
<polygon fill="black" stroke="black" points="2736.5,-4450.26 2733,-4440.26 2729.5,-4450.26 2736.5,-4450.26"/>
</g>
<!-- gpu4_layer13_qkv -->
<g id="node1253" class="node">
<title>gpu4_layer13_qkv</title>
<polygon fill="lightblue" stroke="black" points="2794,-4351.16 2672,-4351.16 2672,-4299.16 2794,-4299.16 2794,-4351.16"/>
<text text-anchor="middle" x="2733" y="-4339.16" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2733" y="-4328.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-4317.16" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-4306.16" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer13_ln1&#45;&gt;gpu4_layer13_qkv -->
<g id="edge1564" class="edge">
<title>gpu4_layer13_ln1&#45;&gt;gpu4_layer13_qkv</title>
<path fill="none" stroke="black" d="M2733,-4387.99C2733,-4379.7 2733,-4370.31 2733,-4361.4"/>
<polygon fill="black" stroke="black" points="2736.5,-4361.26 2733,-4351.26 2729.5,-4361.26 2736.5,-4361.26"/>
</g>
<!-- gpu4_layer13_reshape -->
<g id="node1254" class="node">
<title>gpu4_layer13_reshape</title>
<polygon fill="lightblue" stroke="black" points="2797,-4262.16 2669,-4262.16 2669,-4210.16 2797,-4210.16 2797,-4262.16"/>
<text text-anchor="middle" x="2733" y="-4250.16" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2733" y="-4239.16" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-4228.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-4217.16" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer13_qkv&#45;&gt;gpu4_layer13_reshape -->
<g id="edge1565" class="edge">
<title>gpu4_layer13_qkv&#45;&gt;gpu4_layer13_reshape</title>
<path fill="none" stroke="black" d="M2733,-4298.99C2733,-4290.7 2733,-4281.31 2733,-4272.4"/>
<polygon fill="black" stroke="black" points="2736.5,-4272.26 2733,-4262.26 2729.5,-4272.26 2736.5,-4272.26"/>
</g>
<!-- gpu4_layer13_attn -->
<g id="node1255" class="node">
<title>gpu4_layer13_attn</title>
<polygon fill="lightblue" stroke="black" points="2797,-4173.16 2669,-4173.16 2669,-4121.16 2797,-4121.16 2797,-4173.16"/>
<text text-anchor="middle" x="2733" y="-4161.16" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2733" y="-4150.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-4139.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-4128.16" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer13_reshape&#45;&gt;gpu4_layer13_attn -->
<g id="edge1566" class="edge">
<title>gpu4_layer13_reshape&#45;&gt;gpu4_layer13_attn</title>
<path fill="none" stroke="black" d="M2733,-4209.99C2733,-4201.7 2733,-4192.31 2733,-4183.4"/>
<polygon fill="black" stroke="black" points="2736.5,-4183.26 2733,-4173.26 2729.5,-4183.26 2736.5,-4183.26"/>
</g>
<!-- gpu4_layer13_attn_reshape -->
<g id="node1257" class="node">
<title>gpu4_layer13_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2794,-4084.16 2672,-4084.16 2672,-4032.16 2794,-4032.16 2794,-4084.16"/>
<text text-anchor="middle" x="2733" y="-4072.16" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2733" y="-4061.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-4050.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-4039.16" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer13_attn&#45;&gt;gpu4_layer13_attn_reshape -->
<g id="edge1567" class="edge">
<title>gpu4_layer13_attn&#45;&gt;gpu4_layer13_attn_reshape</title>
<path fill="none" stroke="black" d="M2733,-4120.99C2733,-4112.7 2733,-4103.31 2733,-4094.4"/>
<polygon fill="black" stroke="black" points="2736.5,-4094.26 2733,-4084.26 2729.5,-4094.26 2736.5,-4094.26"/>
</g>
<!-- gpu4_layer13_attn_out -->
<g id="node1256" class="node">
<title>gpu4_layer13_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2794,-3995.16 2672,-3995.16 2672,-3943.16 2794,-3943.16 2794,-3995.16"/>
<text text-anchor="middle" x="2733" y="-3983.16" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2733" y="-3972.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-3961.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-3950.16" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer13_kv_update -->
<g id="node1258" class="node">
<title>gpu4_layer13_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2733" cy="-3869.39" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2733" y="-3883.39" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2733" y="-3872.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-3861.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-3850.39" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer13_attn_out&#45;&gt;gpu4_layer13_kv_update -->
<g id="edge1569" class="edge">
<title>gpu4_layer13_attn_out&#45;&gt;gpu4_layer13_kv_update</title>
<path fill="none" stroke="black" d="M2733,-3942.98C2733,-3934.84 2733,-3925.54 2733,-3916.38"/>
<polygon fill="black" stroke="black" points="2736.5,-3916.17 2733,-3906.17 2729.5,-3916.17 2736.5,-3916.17"/>
</g>
<!-- gpu4_layer13_attn_reshape&#45;&gt;gpu4_layer13_attn_out -->
<g id="edge1568" class="edge">
<title>gpu4_layer13_attn_reshape&#45;&gt;gpu4_layer13_attn_out</title>
<path fill="none" stroke="black" d="M2733,-4031.99C2733,-4023.7 2733,-4014.31 2733,-4005.4"/>
<polygon fill="black" stroke="black" points="2736.5,-4005.26 2733,-3995.26 2729.5,-4005.26 2736.5,-4005.26"/>
</g>
<!-- gpu4_layer13_res1 -->
<g id="node1259" class="node">
<title>gpu4_layer13_res1</title>
<polygon fill="lightblue" stroke="black" points="2794,-3795.62 2672,-3795.62 2672,-3743.62 2794,-3743.62 2794,-3795.62"/>
<text text-anchor="middle" x="2733" y="-3783.62" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2733" y="-3772.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-3761.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-3750.62" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer13_kv_update&#45;&gt;gpu4_layer13_res1 -->
<g id="edge1570" class="edge">
<title>gpu4_layer13_kv_update&#45;&gt;gpu4_layer13_res1</title>
<path fill="none" stroke="black" d="M2733,-3832.54C2733,-3823.86 2733,-3814.59 2733,-3805.93"/>
<polygon fill="black" stroke="black" points="2736.5,-3805.76 2733,-3795.76 2729.5,-3805.76 2736.5,-3805.76"/>
</g>
<!-- gpu4_layer13_ln2 -->
<g id="node1260" class="node">
<title>gpu4_layer13_ln2</title>
<polygon fill="lightblue" stroke="black" points="2794,-3706.62 2672,-3706.62 2672,-3654.62 2794,-3654.62 2794,-3706.62"/>
<text text-anchor="middle" x="2733" y="-3694.62" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2733" y="-3683.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-3672.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-3661.62" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer13_res1&#45;&gt;gpu4_layer13_ln2 -->
<g id="edge1571" class="edge">
<title>gpu4_layer13_res1&#45;&gt;gpu4_layer13_ln2</title>
<path fill="none" stroke="black" d="M2733,-3743.45C2733,-3735.16 2733,-3725.77 2733,-3716.87"/>
<polygon fill="black" stroke="black" points="2736.5,-3716.72 2733,-3706.72 2729.5,-3716.72 2736.5,-3716.72"/>
</g>
<!-- gpu4_layer13_routing -->
<g id="node1261" class="node">
<title>gpu4_layer13_routing</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-3617.62 2658.29,-3617.62 2606.53,-3491.62 2807.71,-3491.62 2859.47,-3617.62"/>
<text text-anchor="middle" x="2733" y="-3574.12" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2733" y="-3563.12" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-3552.12" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-3541.12" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2733" y="-3530.12" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer13_ln2&#45;&gt;gpu4_layer13_routing -->
<g id="edge1572" class="edge">
<title>gpu4_layer13_ln2&#45;&gt;gpu4_layer13_routing</title>
<path fill="none" stroke="black" d="M2733,-3654.52C2733,-3646.59 2733,-3637.4 2733,-3627.87"/>
<polygon fill="black" stroke="black" points="2736.5,-3627.85 2733,-3617.85 2729.5,-3627.85 2736.5,-3627.85"/>
</g>
<!-- gpu4_layer13_expert0 -->
<g id="node1262" class="node">
<title>gpu4_layer13_expert0</title>
<polygon fill="lightblue" stroke="black" points="2514,-3445.62 2392,-3445.62 2392,-3393.62 2514,-3393.62 2514,-3445.62"/>
<text text-anchor="middle" x="2453" y="-3433.62" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="2453" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer13_routing&#45;&gt;gpu4_layer13_expert0 -->
<g id="edge1559" class="edge">
<title>gpu4_layer13_routing&#45;&gt;gpu4_layer13_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2607.33,-3493.93C2575.34,-3478.73 2542.34,-3463.05 2515.11,-3450.12"/>
<polygon fill="black" stroke="black" points="2516.26,-3446.79 2505.73,-3445.66 2513.26,-3453.11 2516.26,-3446.79"/>
<text text-anchor="middle" x="2588.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer13_expert1 -->
<g id="node1263" class="node">
<title>gpu4_layer13_expert1</title>
<polygon fill="lightblue" stroke="black" points="2654,-3445.62 2532,-3445.62 2532,-3393.62 2654,-3393.62 2654,-3445.62"/>
<text text-anchor="middle" x="2593" y="-3433.62" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="2593" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer13_routing&#45;&gt;gpu4_layer13_expert1 -->
<g id="edge1560" class="edge">
<title>gpu4_layer13_routing&#45;&gt;gpu4_layer13_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2667.51,-3491.4C2653.48,-3478.08 2639.21,-3464.52 2626.97,-3452.89"/>
<polygon fill="black" stroke="black" points="2629.29,-3450.26 2619.63,-3445.91 2624.46,-3455.34 2629.29,-3450.26"/>
<text text-anchor="middle" x="2675.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer13_expert2 -->
<g id="node1264" class="node">
<title>gpu4_layer13_expert2</title>
<polygon fill="lightblue" stroke="black" points="2794,-3445.62 2672,-3445.62 2672,-3393.62 2794,-3393.62 2794,-3445.62"/>
<text text-anchor="middle" x="2733" y="-3433.62" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2733" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer13_routing&#45;&gt;gpu4_layer13_expert2 -->
<g id="edge1561" class="edge">
<title>gpu4_layer13_routing&#45;&gt;gpu4_layer13_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2733,-3491.4C2733,-3479.33 2733,-3467.08 2733,-3456.23"/>
<polygon fill="black" stroke="black" points="2736.5,-3455.91 2733,-3445.91 2729.5,-3455.91 2736.5,-3455.91"/>
<text text-anchor="middle" x="2762.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer13_expert3 -->
<g id="node1265" class="node">
<title>gpu4_layer13_expert3</title>
<polygon fill="lightblue" stroke="black" points="2934,-3445.62 2812,-3445.62 2812,-3393.62 2934,-3393.62 2934,-3445.62"/>
<text text-anchor="middle" x="2873" y="-3433.62" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2873" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer13_routing&#45;&gt;gpu4_layer13_expert3 -->
<g id="edge1562" class="edge">
<title>gpu4_layer13_routing&#45;&gt;gpu4_layer13_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2798.49,-3491.4C2812.52,-3478.08 2826.79,-3464.52 2839.03,-3452.89"/>
<polygon fill="black" stroke="black" points="2841.54,-3455.34 2846.37,-3445.91 2836.71,-3450.26 2841.54,-3455.34"/>
<text text-anchor="middle" x="2856.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer13_expert_agg -->
<g id="node1266" class="node">
<title>gpu4_layer13_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-3356.62 2658.29,-3356.62 2606.53,-3252.62 2807.71,-3252.62 2859.47,-3356.62"/>
<text text-anchor="middle" x="2733" y="-3318.62" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2733" y="-3307.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-3296.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-3285.62" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer13_routing&#45;&gt;gpu4_layer13_expert_agg -->
<g id="edge1577" class="edge">
<title>gpu4_layer13_routing&#45;&gt;gpu4_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M2822.22,-3526.7C2895.96,-3499.54 2982.6,-3453.15 2943,-3393.62 2922.44,-3362.71 2888.7,-3342.63 2854.22,-3329.6"/>
<polygon fill="black" stroke="black" points="2855.08,-3326.19 2844.48,-3326.11 2852.71,-3332.78 2855.08,-3326.19"/>
</g>
<!-- gpu4_layer13_expert0&#45;&gt;gpu4_layer13_expert_agg -->
<g id="edge1573" class="edge">
<title>gpu4_layer13_expert0&#45;&gt;gpu4_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M2514.1,-3393.96C2550.98,-3379.08 2598.7,-3359.82 2640.16,-3343.08"/>
<polygon fill="black" stroke="black" points="2641.5,-3346.32 2649.46,-3339.33 2638.88,-3339.83 2641.5,-3346.32"/>
</g>
<!-- gpu4_layer13_expert1&#45;&gt;gpu4_layer13_expert_agg -->
<g id="edge1574" class="edge">
<title>gpu4_layer13_expert1&#45;&gt;gpu4_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M2624.07,-3393.54C2635.32,-3384.46 2648.53,-3373.8 2661.8,-3363.09"/>
<polygon fill="black" stroke="black" points="2664.02,-3365.79 2669.6,-3356.79 2659.62,-3360.35 2664.02,-3365.79"/>
</g>
<!-- gpu4_layer13_expert2&#45;&gt;gpu4_layer13_expert_agg -->
<g id="edge1575" class="edge">
<title>gpu4_layer13_expert2&#45;&gt;gpu4_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M2733,-3393.54C2733,-3385.61 2733,-3376.48 2733,-3367.16"/>
<polygon fill="black" stroke="black" points="2736.5,-3367.02 2733,-3357.02 2729.5,-3367.02 2736.5,-3367.02"/>
</g>
<!-- gpu4_layer13_expert3&#45;&gt;gpu4_layer13_expert_agg -->
<g id="edge1576" class="edge">
<title>gpu4_layer13_expert3&#45;&gt;gpu4_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M2841.93,-3393.54C2830.68,-3384.46 2817.47,-3373.8 2804.2,-3363.09"/>
<polygon fill="black" stroke="black" points="2806.38,-3360.35 2796.4,-3356.79 2801.98,-3365.79 2806.38,-3360.35"/>
</g>
<!-- gpu4_layer13_res2 -->
<g id="node1267" class="node">
<title>gpu4_layer13_res2</title>
<polygon fill="lightblue" stroke="black" points="2794,-3215.62 2672,-3215.62 2672,-3163.62 2794,-3163.62 2794,-3215.62"/>
<text text-anchor="middle" x="2733" y="-3203.62" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2733" y="-3192.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-3181.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-3170.62" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer13_expert_agg&#45;&gt;gpu4_layer13_res2 -->
<g id="edge1578" class="edge">
<title>gpu4_layer13_expert_agg&#45;&gt;gpu4_layer13_res2</title>
<path fill="none" stroke="black" d="M2733,-3252.41C2733,-3243.46 2733,-3234.33 2733,-3225.93"/>
<polygon fill="black" stroke="black" points="2736.5,-3225.75 2733,-3215.75 2729.5,-3225.75 2736.5,-3225.75"/>
</g>
<!-- gpu4_layer14_ln1 -->
<g id="node1268" class="node">
<title>gpu4_layer14_ln1</title>
<polygon fill="lightblue" stroke="black" points="2794,-3126.62 2672,-3126.62 2672,-3074.62 2794,-3074.62 2794,-3126.62"/>
<text text-anchor="middle" x="2733" y="-3114.62" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2733" y="-3103.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-3092.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-3081.62" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer13_res2&#45;&gt;gpu4_layer14_ln1 -->
<g id="edge1583" class="edge">
<title>gpu4_layer13_res2&#45;&gt;gpu4_layer14_ln1</title>
<path fill="none" stroke="black" d="M2733,-3163.45C2733,-3155.16 2733,-3145.77 2733,-3136.87"/>
<polygon fill="black" stroke="black" points="2736.5,-3136.72 2733,-3126.72 2729.5,-3136.72 2736.5,-3136.72"/>
</g>
<!-- gpu4_layer14_qkv -->
<g id="node1269" class="node">
<title>gpu4_layer14_qkv</title>
<polygon fill="lightblue" stroke="black" points="2794,-3037.62 2672,-3037.62 2672,-2985.62 2794,-2985.62 2794,-3037.62"/>
<text text-anchor="middle" x="2733" y="-3025.62" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2733" y="-3014.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-3003.62" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-2992.62" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer14_ln1&#45;&gt;gpu4_layer14_qkv -->
<g id="edge1584" class="edge">
<title>gpu4_layer14_ln1&#45;&gt;gpu4_layer14_qkv</title>
<path fill="none" stroke="black" d="M2733,-3074.45C2733,-3066.16 2733,-3056.77 2733,-3047.87"/>
<polygon fill="black" stroke="black" points="2736.5,-3047.72 2733,-3037.72 2729.5,-3047.72 2736.5,-3047.72"/>
</g>
<!-- gpu4_layer14_reshape -->
<g id="node1270" class="node">
<title>gpu4_layer14_reshape</title>
<polygon fill="lightblue" stroke="black" points="2797,-2948.62 2669,-2948.62 2669,-2896.62 2797,-2896.62 2797,-2948.62"/>
<text text-anchor="middle" x="2733" y="-2936.62" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2733" y="-2925.62" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-2914.62" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-2903.62" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer14_qkv&#45;&gt;gpu4_layer14_reshape -->
<g id="edge1585" class="edge">
<title>gpu4_layer14_qkv&#45;&gt;gpu4_layer14_reshape</title>
<path fill="none" stroke="black" d="M2733,-2985.45C2733,-2977.16 2733,-2967.77 2733,-2958.87"/>
<polygon fill="black" stroke="black" points="2736.5,-2958.72 2733,-2948.72 2729.5,-2958.72 2736.5,-2958.72"/>
</g>
<!-- gpu4_layer14_attn -->
<g id="node1271" class="node">
<title>gpu4_layer14_attn</title>
<polygon fill="lightblue" stroke="black" points="2797,-2859.62 2669,-2859.62 2669,-2807.62 2797,-2807.62 2797,-2859.62"/>
<text text-anchor="middle" x="2733" y="-2847.62" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2733" y="-2836.62" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-2825.62" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-2814.62" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer14_reshape&#45;&gt;gpu4_layer14_attn -->
<g id="edge1586" class="edge">
<title>gpu4_layer14_reshape&#45;&gt;gpu4_layer14_attn</title>
<path fill="none" stroke="black" d="M2733,-2896.45C2733,-2888.16 2733,-2878.77 2733,-2869.87"/>
<polygon fill="black" stroke="black" points="2736.5,-2869.72 2733,-2859.72 2729.5,-2869.72 2736.5,-2869.72"/>
</g>
<!-- gpu4_layer14_attn_reshape -->
<g id="node1273" class="node">
<title>gpu4_layer14_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2794,-2770.62 2672,-2770.62 2672,-2718.62 2794,-2718.62 2794,-2770.62"/>
<text text-anchor="middle" x="2733" y="-2758.62" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2733" y="-2747.62" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-2736.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-2725.62" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer14_attn&#45;&gt;gpu4_layer14_attn_reshape -->
<g id="edge1587" class="edge">
<title>gpu4_layer14_attn&#45;&gt;gpu4_layer14_attn_reshape</title>
<path fill="none" stroke="black" d="M2733,-2807.45C2733,-2799.16 2733,-2789.77 2733,-2780.87"/>
<polygon fill="black" stroke="black" points="2736.5,-2780.72 2733,-2770.72 2729.5,-2780.72 2736.5,-2780.72"/>
</g>
<!-- gpu4_layer14_attn_out -->
<g id="node1272" class="node">
<title>gpu4_layer14_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2794,-2681.62 2672,-2681.62 2672,-2629.62 2794,-2629.62 2794,-2681.62"/>
<text text-anchor="middle" x="2733" y="-2669.62" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2733" y="-2658.62" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-2647.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-2636.62" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer14_kv_update -->
<g id="node1274" class="node">
<title>gpu4_layer14_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2733" cy="-2555.85" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2733" y="-2569.85" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2733" y="-2558.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-2547.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-2536.85" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer14_attn_out&#45;&gt;gpu4_layer14_kv_update -->
<g id="edge1589" class="edge">
<title>gpu4_layer14_attn_out&#45;&gt;gpu4_layer14_kv_update</title>
<path fill="none" stroke="black" d="M2733,-2629.44C2733,-2621.3 2733,-2612 2733,-2602.84"/>
<polygon fill="black" stroke="black" points="2736.5,-2602.63 2733,-2592.63 2729.5,-2602.63 2736.5,-2602.63"/>
</g>
<!-- gpu4_layer14_attn_reshape&#45;&gt;gpu4_layer14_attn_out -->
<g id="edge1588" class="edge">
<title>gpu4_layer14_attn_reshape&#45;&gt;gpu4_layer14_attn_out</title>
<path fill="none" stroke="black" d="M2733,-2718.45C2733,-2710.16 2733,-2700.77 2733,-2691.87"/>
<polygon fill="black" stroke="black" points="2736.5,-2691.72 2733,-2681.72 2729.5,-2691.72 2736.5,-2691.72"/>
</g>
<!-- gpu4_layer14_res1 -->
<g id="node1275" class="node">
<title>gpu4_layer14_res1</title>
<polygon fill="lightblue" stroke="black" points="2794,-2482.08 2672,-2482.08 2672,-2430.08 2794,-2430.08 2794,-2482.08"/>
<text text-anchor="middle" x="2733" y="-2470.08" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2733" y="-2459.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-2448.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-2437.08" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer14_kv_update&#45;&gt;gpu4_layer14_res1 -->
<g id="edge1590" class="edge">
<title>gpu4_layer14_kv_update&#45;&gt;gpu4_layer14_res1</title>
<path fill="none" stroke="black" d="M2733,-2519C2733,-2510.32 2733,-2501.05 2733,-2492.39"/>
<polygon fill="black" stroke="black" points="2736.5,-2492.22 2733,-2482.22 2729.5,-2492.22 2736.5,-2492.22"/>
</g>
<!-- gpu4_layer14_ln2 -->
<g id="node1276" class="node">
<title>gpu4_layer14_ln2</title>
<polygon fill="lightblue" stroke="black" points="2794,-2393.08 2672,-2393.08 2672,-2341.08 2794,-2341.08 2794,-2393.08"/>
<text text-anchor="middle" x="2733" y="-2381.08" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2733" y="-2370.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-2359.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-2348.08" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer14_res1&#45;&gt;gpu4_layer14_ln2 -->
<g id="edge1591" class="edge">
<title>gpu4_layer14_res1&#45;&gt;gpu4_layer14_ln2</title>
<path fill="none" stroke="black" d="M2733,-2429.91C2733,-2421.62 2733,-2412.23 2733,-2403.33"/>
<polygon fill="black" stroke="black" points="2736.5,-2403.19 2733,-2393.19 2729.5,-2403.19 2736.5,-2403.19"/>
</g>
<!-- gpu4_layer14_routing -->
<g id="node1277" class="node">
<title>gpu4_layer14_routing</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-2304.08 2658.29,-2304.08 2606.53,-2178.08 2807.71,-2178.08 2859.47,-2304.08"/>
<text text-anchor="middle" x="2733" y="-2260.58" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2733" y="-2249.58" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-2238.58" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-2227.58" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2733" y="-2216.58" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer14_ln2&#45;&gt;gpu4_layer14_routing -->
<g id="edge1592" class="edge">
<title>gpu4_layer14_ln2&#45;&gt;gpu4_layer14_routing</title>
<path fill="none" stroke="black" d="M2733,-2340.98C2733,-2333.05 2733,-2323.86 2733,-2314.33"/>
<polygon fill="black" stroke="black" points="2736.5,-2314.31 2733,-2304.31 2729.5,-2314.31 2736.5,-2314.31"/>
</g>
<!-- gpu4_layer14_expert0 -->
<g id="node1278" class="node">
<title>gpu4_layer14_expert0</title>
<polygon fill="lightblue" stroke="black" points="2514,-2132.08 2392,-2132.08 2392,-2080.08 2514,-2080.08 2514,-2132.08"/>
<text text-anchor="middle" x="2453" y="-2120.08" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="2453" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer14_routing&#45;&gt;gpu4_layer14_expert0 -->
<g id="edge1579" class="edge">
<title>gpu4_layer14_routing&#45;&gt;gpu4_layer14_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2607.33,-2180.39C2575.34,-2165.19 2542.34,-2149.51 2515.11,-2136.58"/>
<polygon fill="black" stroke="black" points="2516.26,-2133.25 2505.73,-2132.12 2513.26,-2139.58 2516.26,-2133.25"/>
<text text-anchor="middle" x="2588.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer14_expert1 -->
<g id="node1279" class="node">
<title>gpu4_layer14_expert1</title>
<polygon fill="lightblue" stroke="black" points="2654,-2132.08 2532,-2132.08 2532,-2080.08 2654,-2080.08 2654,-2132.08"/>
<text text-anchor="middle" x="2593" y="-2120.08" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="2593" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer14_routing&#45;&gt;gpu4_layer14_expert1 -->
<g id="edge1580" class="edge">
<title>gpu4_layer14_routing&#45;&gt;gpu4_layer14_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2667.51,-2177.86C2653.48,-2164.54 2639.21,-2150.98 2626.97,-2139.35"/>
<polygon fill="black" stroke="black" points="2629.29,-2136.72 2619.63,-2132.37 2624.46,-2141.8 2629.29,-2136.72"/>
<text text-anchor="middle" x="2675.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer14_expert2 -->
<g id="node1280" class="node">
<title>gpu4_layer14_expert2</title>
<polygon fill="lightblue" stroke="black" points="2794,-2132.08 2672,-2132.08 2672,-2080.08 2794,-2080.08 2794,-2132.08"/>
<text text-anchor="middle" x="2733" y="-2120.08" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2733" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer14_routing&#45;&gt;gpu4_layer14_expert2 -->
<g id="edge1581" class="edge">
<title>gpu4_layer14_routing&#45;&gt;gpu4_layer14_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2733,-2177.86C2733,-2165.79 2733,-2153.54 2733,-2142.69"/>
<polygon fill="black" stroke="black" points="2736.5,-2142.37 2733,-2132.37 2729.5,-2142.37 2736.5,-2142.37"/>
<text text-anchor="middle" x="2762.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer14_expert3 -->
<g id="node1281" class="node">
<title>gpu4_layer14_expert3</title>
<polygon fill="lightblue" stroke="black" points="2934,-2132.08 2812,-2132.08 2812,-2080.08 2934,-2080.08 2934,-2132.08"/>
<text text-anchor="middle" x="2873" y="-2120.08" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2873" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer14_routing&#45;&gt;gpu4_layer14_expert3 -->
<g id="edge1582" class="edge">
<title>gpu4_layer14_routing&#45;&gt;gpu4_layer14_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2798.49,-2177.86C2812.52,-2164.54 2826.79,-2150.98 2839.03,-2139.35"/>
<polygon fill="black" stroke="black" points="2841.54,-2141.8 2846.37,-2132.37 2836.71,-2136.72 2841.54,-2141.8"/>
<text text-anchor="middle" x="2856.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer14_expert_agg -->
<g id="node1282" class="node">
<title>gpu4_layer14_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-2043.08 2658.29,-2043.08 2606.53,-1939.08 2807.71,-1939.08 2859.47,-2043.08"/>
<text text-anchor="middle" x="2733" y="-2005.08" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2733" y="-1994.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-1983.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-1972.08" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer14_routing&#45;&gt;gpu4_layer14_expert_agg -->
<g id="edge1597" class="edge">
<title>gpu4_layer14_routing&#45;&gt;gpu4_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M2822.22,-2213.16C2895.96,-2186 2982.6,-2139.61 2943,-2080.08 2922.44,-2049.17 2888.7,-2029.09 2854.22,-2016.06"/>
<polygon fill="black" stroke="black" points="2855.08,-2012.65 2844.48,-2012.57 2852.71,-2019.24 2855.08,-2012.65"/>
</g>
<!-- gpu4_layer14_expert0&#45;&gt;gpu4_layer14_expert_agg -->
<g id="edge1593" class="edge">
<title>gpu4_layer14_expert0&#45;&gt;gpu4_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M2514.1,-2080.42C2550.98,-2065.54 2598.7,-2046.28 2640.16,-2029.54"/>
<polygon fill="black" stroke="black" points="2641.5,-2032.78 2649.46,-2025.79 2638.88,-2026.29 2641.5,-2032.78"/>
</g>
<!-- gpu4_layer14_expert1&#45;&gt;gpu4_layer14_expert_agg -->
<g id="edge1594" class="edge">
<title>gpu4_layer14_expert1&#45;&gt;gpu4_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M2624.07,-2080C2635.32,-2070.92 2648.53,-2060.26 2661.8,-2049.55"/>
<polygon fill="black" stroke="black" points="2664.02,-2052.25 2669.6,-2043.25 2659.62,-2046.81 2664.02,-2052.25"/>
</g>
<!-- gpu4_layer14_expert2&#45;&gt;gpu4_layer14_expert_agg -->
<g id="edge1595" class="edge">
<title>gpu4_layer14_expert2&#45;&gt;gpu4_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M2733,-2080C2733,-2072.07 2733,-2062.94 2733,-2053.62"/>
<polygon fill="black" stroke="black" points="2736.5,-2053.48 2733,-2043.48 2729.5,-2053.48 2736.5,-2053.48"/>
</g>
<!-- gpu4_layer14_expert3&#45;&gt;gpu4_layer14_expert_agg -->
<g id="edge1596" class="edge">
<title>gpu4_layer14_expert3&#45;&gt;gpu4_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M2841.93,-2080C2830.68,-2070.92 2817.47,-2060.26 2804.2,-2049.55"/>
<polygon fill="black" stroke="black" points="2806.38,-2046.81 2796.4,-2043.25 2801.98,-2052.25 2806.38,-2046.81"/>
</g>
<!-- gpu4_layer14_res2 -->
<g id="node1283" class="node">
<title>gpu4_layer14_res2</title>
<polygon fill="lightblue" stroke="black" points="2794,-1902.08 2672,-1902.08 2672,-1850.08 2794,-1850.08 2794,-1902.08"/>
<text text-anchor="middle" x="2733" y="-1890.08" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2733" y="-1879.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-1868.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-1857.08" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer14_expert_agg&#45;&gt;gpu4_layer14_res2 -->
<g id="edge1598" class="edge">
<title>gpu4_layer14_expert_agg&#45;&gt;gpu4_layer14_res2</title>
<path fill="none" stroke="black" d="M2733,-1938.87C2733,-1929.92 2733,-1920.79 2733,-1912.39"/>
<polygon fill="black" stroke="black" points="2736.5,-1912.21 2733,-1902.21 2729.5,-1912.21 2736.5,-1912.21"/>
</g>
<!-- gpu4_layer15_ln1 -->
<g id="node1284" class="node">
<title>gpu4_layer15_ln1</title>
<polygon fill="lightblue" stroke="black" points="2794,-1813.08 2672,-1813.08 2672,-1761.08 2794,-1761.08 2794,-1813.08"/>
<text text-anchor="middle" x="2733" y="-1801.08" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2733" y="-1790.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-1779.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-1768.08" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer14_res2&#45;&gt;gpu4_layer15_ln1 -->
<g id="edge1603" class="edge">
<title>gpu4_layer14_res2&#45;&gt;gpu4_layer15_ln1</title>
<path fill="none" stroke="black" d="M2733,-1849.91C2733,-1841.62 2733,-1832.23 2733,-1823.33"/>
<polygon fill="black" stroke="black" points="2736.5,-1823.19 2733,-1813.19 2729.5,-1823.19 2736.5,-1823.19"/>
</g>
<!-- gpu4_layer15_qkv -->
<g id="node1285" class="node">
<title>gpu4_layer15_qkv</title>
<polygon fill="lightblue" stroke="black" points="2794,-1724.08 2672,-1724.08 2672,-1672.08 2794,-1672.08 2794,-1724.08"/>
<text text-anchor="middle" x="2733" y="-1712.08" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2733" y="-1701.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-1690.08" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-1679.08" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer15_ln1&#45;&gt;gpu4_layer15_qkv -->
<g id="edge1604" class="edge">
<title>gpu4_layer15_ln1&#45;&gt;gpu4_layer15_qkv</title>
<path fill="none" stroke="black" d="M2733,-1760.91C2733,-1752.62 2733,-1743.23 2733,-1734.33"/>
<polygon fill="black" stroke="black" points="2736.5,-1734.19 2733,-1724.19 2729.5,-1734.19 2736.5,-1734.19"/>
</g>
<!-- gpu4_layer15_reshape -->
<g id="node1286" class="node">
<title>gpu4_layer15_reshape</title>
<polygon fill="lightblue" stroke="black" points="2797,-1635.08 2669,-1635.08 2669,-1583.08 2797,-1583.08 2797,-1635.08"/>
<text text-anchor="middle" x="2733" y="-1623.08" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2733" y="-1612.08" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2733" y="-1601.08" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-1590.08" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer15_qkv&#45;&gt;gpu4_layer15_reshape -->
<g id="edge1605" class="edge">
<title>gpu4_layer15_qkv&#45;&gt;gpu4_layer15_reshape</title>
<path fill="none" stroke="black" d="M2733,-1671.91C2733,-1663.62 2733,-1654.23 2733,-1645.33"/>
<polygon fill="black" stroke="black" points="2736.5,-1645.19 2733,-1635.19 2729.5,-1645.19 2736.5,-1645.19"/>
</g>
<!-- gpu4_layer15_attn -->
<g id="node1287" class="node">
<title>gpu4_layer15_attn</title>
<polygon fill="lightblue" stroke="black" points="2797,-1546.08 2669,-1546.08 2669,-1494.08 2797,-1494.08 2797,-1546.08"/>
<text text-anchor="middle" x="2733" y="-1534.08" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2733" y="-1523.08" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-1512.08" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-1501.08" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer15_reshape&#45;&gt;gpu4_layer15_attn -->
<g id="edge1606" class="edge">
<title>gpu4_layer15_reshape&#45;&gt;gpu4_layer15_attn</title>
<path fill="none" stroke="black" d="M2733,-1582.91C2733,-1574.62 2733,-1565.23 2733,-1556.33"/>
<polygon fill="black" stroke="black" points="2736.5,-1556.19 2733,-1546.19 2729.5,-1556.19 2736.5,-1556.19"/>
</g>
<!-- gpu4_layer15_attn_reshape -->
<g id="node1289" class="node">
<title>gpu4_layer15_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2794,-1457.08 2672,-1457.08 2672,-1405.08 2794,-1405.08 2794,-1457.08"/>
<text text-anchor="middle" x="2733" y="-1445.08" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2733" y="-1434.08" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-1423.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-1412.08" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer15_attn&#45;&gt;gpu4_layer15_attn_reshape -->
<g id="edge1607" class="edge">
<title>gpu4_layer15_attn&#45;&gt;gpu4_layer15_attn_reshape</title>
<path fill="none" stroke="black" d="M2733,-1493.91C2733,-1485.62 2733,-1476.23 2733,-1467.33"/>
<polygon fill="black" stroke="black" points="2736.5,-1467.19 2733,-1457.19 2729.5,-1467.19 2736.5,-1467.19"/>
</g>
<!-- gpu4_layer15_attn_out -->
<g id="node1288" class="node">
<title>gpu4_layer15_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2794,-1368.08 2672,-1368.08 2672,-1316.08 2794,-1316.08 2794,-1368.08"/>
<text text-anchor="middle" x="2733" y="-1356.08" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2733" y="-1345.08" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2733" y="-1334.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-1323.08" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer15_kv_update -->
<g id="node1290" class="node">
<title>gpu4_layer15_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2733" cy="-1242.31" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2733" y="-1256.31" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2733" y="-1245.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-1234.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-1223.31" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer15_attn_out&#45;&gt;gpu4_layer15_kv_update -->
<g id="edge1609" class="edge">
<title>gpu4_layer15_attn_out&#45;&gt;gpu4_layer15_kv_update</title>
<path fill="none" stroke="black" d="M2733,-1315.9C2733,-1307.76 2733,-1298.46 2733,-1289.3"/>
<polygon fill="black" stroke="black" points="2736.5,-1289.09 2733,-1279.09 2729.5,-1289.09 2736.5,-1289.09"/>
</g>
<!-- gpu4_layer15_attn_reshape&#45;&gt;gpu4_layer15_attn_out -->
<g id="edge1608" class="edge">
<title>gpu4_layer15_attn_reshape&#45;&gt;gpu4_layer15_attn_out</title>
<path fill="none" stroke="black" d="M2733,-1404.91C2733,-1396.62 2733,-1387.23 2733,-1378.33"/>
<polygon fill="black" stroke="black" points="2736.5,-1378.19 2733,-1368.19 2729.5,-1378.19 2736.5,-1378.19"/>
</g>
<!-- gpu4_layer15_res1 -->
<g id="node1291" class="node">
<title>gpu4_layer15_res1</title>
<polygon fill="lightblue" stroke="black" points="2794,-1168.54 2672,-1168.54 2672,-1116.54 2794,-1116.54 2794,-1168.54"/>
<text text-anchor="middle" x="2733" y="-1156.54" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2733" y="-1145.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-1134.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-1123.54" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer15_kv_update&#45;&gt;gpu4_layer15_res1 -->
<g id="edge1610" class="edge">
<title>gpu4_layer15_kv_update&#45;&gt;gpu4_layer15_res1</title>
<path fill="none" stroke="black" d="M2733,-1205.46C2733,-1196.78 2733,-1187.51 2733,-1178.85"/>
<polygon fill="black" stroke="black" points="2736.5,-1178.69 2733,-1168.69 2729.5,-1178.69 2736.5,-1178.69"/>
</g>
<!-- gpu4_layer15_ln2 -->
<g id="node1292" class="node">
<title>gpu4_layer15_ln2</title>
<polygon fill="lightblue" stroke="black" points="2794,-1079.54 2672,-1079.54 2672,-1027.54 2794,-1027.54 2794,-1079.54"/>
<text text-anchor="middle" x="2733" y="-1067.54" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="2733" y="-1056.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-1045.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-1034.54" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer15_res1&#45;&gt;gpu4_layer15_ln2 -->
<g id="edge1611" class="edge">
<title>gpu4_layer15_res1&#45;&gt;gpu4_layer15_ln2</title>
<path fill="none" stroke="black" d="M2733,-1116.38C2733,-1108.08 2733,-1098.69 2733,-1089.79"/>
<polygon fill="black" stroke="black" points="2736.5,-1089.65 2733,-1079.65 2729.5,-1089.65 2736.5,-1089.65"/>
</g>
<!-- gpu4_layer15_routing -->
<g id="node1293" class="node">
<title>gpu4_layer15_routing</title>
<polygon fill="lightyellow" stroke="black" points="2859.47,-990.54 2658.29,-990.54 2606.53,-864.54 2807.71,-864.54 2859.47,-990.54"/>
<text text-anchor="middle" x="2733" y="-947.04" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="2733" y="-936.04" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-925.04" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-914.04" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="2733" y="-903.04" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer15_ln2&#45;&gt;gpu4_layer15_routing -->
<g id="edge1612" class="edge">
<title>gpu4_layer15_ln2&#45;&gt;gpu4_layer15_routing</title>
<path fill="none" stroke="black" d="M2733,-1027.45C2733,-1019.51 2733,-1010.32 2733,-1000.79"/>
<polygon fill="black" stroke="black" points="2736.5,-1000.77 2733,-990.77 2729.5,-1000.77 2736.5,-1000.77"/>
</g>
<!-- gpu4_layer15_expert0 -->
<g id="node1294" class="node">
<title>gpu4_layer15_expert0</title>
<polygon fill="lightblue" stroke="black" points="2514,-818.54 2392,-818.54 2392,-766.54 2514,-766.54 2514,-818.54"/>
<text text-anchor="middle" x="2453" y="-806.54" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="2453" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2453" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer15_routing&#45;&gt;gpu4_layer15_expert0 -->
<g id="edge1599" class="edge">
<title>gpu4_layer15_routing&#45;&gt;gpu4_layer15_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2607.33,-866.85C2575.34,-851.65 2542.34,-835.98 2515.11,-823.04"/>
<polygon fill="black" stroke="black" points="2516.26,-819.71 2505.73,-818.58 2513.26,-826.04 2516.26,-819.71"/>
<text text-anchor="middle" x="2588.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer15_expert1 -->
<g id="node1295" class="node">
<title>gpu4_layer15_expert1</title>
<polygon fill="lightblue" stroke="black" points="2654,-818.54 2532,-818.54 2532,-766.54 2654,-766.54 2654,-818.54"/>
<text text-anchor="middle" x="2593" y="-806.54" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="2593" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2593" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer15_routing&#45;&gt;gpu4_layer15_expert1 -->
<g id="edge1600" class="edge">
<title>gpu4_layer15_routing&#45;&gt;gpu4_layer15_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2667.51,-864.32C2653.48,-851 2639.21,-837.44 2626.97,-825.81"/>
<polygon fill="black" stroke="black" points="2629.29,-823.18 2619.63,-818.83 2624.46,-828.26 2629.29,-823.18"/>
<text text-anchor="middle" x="2675.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer15_expert2 -->
<g id="node1296" class="node">
<title>gpu4_layer15_expert2</title>
<polygon fill="lightblue" stroke="black" points="2794,-818.54 2672,-818.54 2672,-766.54 2794,-766.54 2794,-818.54"/>
<text text-anchor="middle" x="2733" y="-806.54" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2733" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2733" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer15_routing&#45;&gt;gpu4_layer15_expert2 -->
<g id="edge1601" class="edge">
<title>gpu4_layer15_routing&#45;&gt;gpu4_layer15_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2733,-864.32C2733,-852.25 2733,-840 2733,-829.15"/>
<polygon fill="black" stroke="black" points="2736.5,-828.83 2733,-818.83 2729.5,-828.83 2736.5,-828.83"/>
<text text-anchor="middle" x="2762.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer15_expert3 -->
<g id="node1297" class="node">
<title>gpu4_layer15_expert3</title>
<polygon fill="lightblue" stroke="black" points="2934,-818.54 2812,-818.54 2812,-766.54 2934,-766.54 2934,-818.54"/>
<text text-anchor="middle" x="2873" y="-806.54" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2873" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2873" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer15_routing&#45;&gt;gpu4_layer15_expert3 -->
<g id="edge1602" class="edge">
<title>gpu4_layer15_routing&#45;&gt;gpu4_layer15_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2798.49,-864.32C2812.52,-851 2826.79,-837.44 2839.03,-825.81"/>
<polygon fill="black" stroke="black" points="2841.54,-828.26 2846.37,-818.83 2836.71,-823.18 2841.54,-828.26"/>
<text text-anchor="middle" x="2856.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu4_layer15_expert_agg -->
<g id="node1298" class="node">
<title>gpu4_layer15_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2838.47,-729.54 2637.29,-729.54 2585.53,-625.54 2786.71,-625.54 2838.47,-729.54"/>
<text text-anchor="middle" x="2712" y="-691.54" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2712" y="-680.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2712" y="-669.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2712" y="-658.54" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer15_routing&#45;&gt;gpu4_layer15_expert_agg -->
<g id="edge1617" class="edge">
<title>gpu4_layer15_routing&#45;&gt;gpu4_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M2822.31,-899.45C2896.44,-872.1 2983.64,-825.51 2943,-766.54 2917.08,-728.92 2872.77,-707.37 2829.85,-695.03"/>
<polygon fill="black" stroke="black" points="2830.72,-691.64 2820.15,-692.39 2828.88,-698.4 2830.72,-691.64"/>
</g>
<!-- gpu4_layer15_expert0&#45;&gt;gpu4_layer15_expert_agg -->
<g id="edge1613" class="edge">
<title>gpu4_layer15_expert0&#45;&gt;gpu4_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M2510.48,-766.46C2542.77,-752.37 2583.81,-734.47 2620.42,-718.5"/>
<polygon fill="black" stroke="black" points="2621.86,-721.69 2629.62,-714.48 2619.06,-715.27 2621.86,-721.69"/>
</g>
<!-- gpu4_layer15_expert1&#45;&gt;gpu4_layer15_expert_agg -->
<g id="edge1614" class="edge">
<title>gpu4_layer15_expert1&#45;&gt;gpu4_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M2619.41,-766.46C2628.65,-757.69 2639.44,-747.44 2650.33,-737.1"/>
<polygon fill="black" stroke="black" points="2653.03,-739.36 2657.87,-729.94 2648.21,-734.29 2653.03,-739.36"/>
</g>
<!-- gpu4_layer15_expert2&#45;&gt;gpu4_layer15_expert_agg -->
<g id="edge1615" class="edge">
<title>gpu4_layer15_expert2&#45;&gt;gpu4_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M2728.34,-766.46C2726.85,-758.45 2725.13,-749.2 2723.38,-739.78"/>
<polygon fill="black" stroke="black" points="2726.82,-739.13 2721.55,-729.94 2719.94,-740.41 2726.82,-739.13"/>
</g>
<!-- gpu4_layer15_expert3&#45;&gt;gpu4_layer15_expert_agg -->
<g id="edge1616" class="edge">
<title>gpu4_layer15_expert3&#45;&gt;gpu4_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M2837.27,-766.46C2824.22,-757.3 2808.86,-746.52 2793.46,-735.71"/>
<polygon fill="black" stroke="black" points="2795.1,-732.59 2784.91,-729.71 2791.08,-738.32 2795.1,-732.59"/>
</g>
<!-- gpu4_layer15_res2 -->
<g id="node1299" class="node">
<title>gpu4_layer15_res2</title>
<polygon fill="lightblue" stroke="black" points="2768,-588.54 2646,-588.54 2646,-536.54 2768,-536.54 2768,-588.54"/>
<text text-anchor="middle" x="2707" y="-576.54" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2707" y="-565.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2707" y="-554.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2707" y="-543.54" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer15_expert_agg&#45;&gt;gpu4_layer15_res2 -->
<g id="edge1618" class="edge">
<title>gpu4_layer15_expert_agg&#45;&gt;gpu4_layer15_res2</title>
<path fill="none" stroke="black" d="M2709.73,-625.33C2709.34,-616.38 2708.93,-607.25 2708.56,-598.85"/>
<polygon fill="black" stroke="black" points="2712.05,-598.51 2708.11,-588.67 2705.06,-598.82 2712.05,-598.51"/>
</g>
<!-- gpu4_final_ln -->
<g id="node1300" class="node">
<title>gpu4_final_ln</title>
<polygon fill="lightblue" stroke="black" points="2739,-499.54 2617,-499.54 2617,-447.54 2739,-447.54 2739,-499.54"/>
<text text-anchor="middle" x="2678" y="-487.54" font-family="Arial" font-size="10.00">Final LayerNorm</text>
<text text-anchor="middle" x="2678" y="-476.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2678" y="-465.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2678" y="-454.54" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_layer15_res2&#45;&gt;gpu4_final_ln -->
<g id="edge1619" class="edge">
<title>gpu4_layer15_res2&#45;&gt;gpu4_final_ln</title>
<path fill="none" stroke="black" d="M2698.61,-536.38C2695.79,-527.9 2692.58,-518.29 2689.56,-509.21"/>
<polygon fill="black" stroke="black" points="2692.85,-508.03 2686.37,-499.65 2686.21,-510.24 2692.85,-508.03"/>
</g>
<!-- gpu4_output_proj -->
<g id="node1301" class="node">
<title>gpu4_output_proj</title>
<polygon fill="lightblue" stroke="black" points="2709,-410.54 2581,-410.54 2581,-358.54 2709,-358.54 2709,-410.54"/>
<text text-anchor="middle" x="2645" y="-398.54" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="2645" y="-387.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2645" y="-376.54" font-family="Arial" font-size="10.00">Output: [256, 512, 32000]</text>
<text text-anchor="middle" x="2645" y="-365.54" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_final_ln&#45;&gt;gpu4_output_proj -->
<g id="edge1620" class="edge">
<title>gpu4_final_ln&#45;&gt;gpu4_output_proj</title>
<path fill="none" stroke="black" d="M2668.46,-447.38C2665.24,-438.9 2661.59,-429.29 2658.15,-420.21"/>
<polygon fill="black" stroke="black" points="2661.34,-418.76 2654.52,-410.65 2654.8,-421.24 2661.34,-418.76"/>
</g>
<!-- gpu4_softmax -->
<g id="node1302" class="node">
<title>gpu4_softmax</title>
<polygon fill="lightblue" stroke="black" points="2640,-321.54 2512,-321.54 2512,-269.54 2640,-269.54 2640,-321.54"/>
<text text-anchor="middle" x="2576" y="-309.54" font-family="Arial" font-size="10.00">Softmax</text>
<text text-anchor="middle" x="2576" y="-298.54" font-family="Arial" font-size="10.00">Input: [256, 512, 32000]</text>
<text text-anchor="middle" x="2576" y="-287.54" font-family="Arial" font-size="10.00">Output: [256, 512, 32000]</text>
<text text-anchor="middle" x="2576" y="-276.54" font-family="Arial" font-size="10.00">GPU: GPU4</text>
</g>
<!-- gpu4_output_proj&#45;&gt;gpu4_softmax -->
<g id="edge1621" class="edge">
<title>gpu4_output_proj&#45;&gt;gpu4_softmax</title>
<path fill="none" stroke="black" d="M2625.04,-358.38C2617.96,-349.45 2609.88,-339.26 2602.35,-329.76"/>
<polygon fill="black" stroke="black" points="2604.87,-327.31 2595.91,-321.65 2599.38,-331.66 2604.87,-327.31"/>
</g>
<!-- gpu4_softmax&#45;&gt;dp_aggregate -->
<g id="edge2598" class="edge">
<title>gpu4_softmax&#45;&gt;dp_aggregate</title>
<path fill="none" stroke="black" d="M2543.26,-269.26C2528.45,-257.82 2510.28,-243.79 2492.43,-230.01"/>
<polygon fill="black" stroke="black" points="2494.31,-227.04 2484.26,-223.7 2490.04,-232.58 2494.31,-227.04"/>
<text text-anchor="middle" x="2542.5" y="-244.34" font-family="Arial" font-size="9.00">GPU 4 output</text>
</g>
<!-- gpu5_layer0_ln1 -->
<g id="node1304" class="node">
<title>gpu5_layer0_ln1</title>
<polygon fill="lightblue" stroke="black" points="2598,-21516.16 2476,-21516.16 2476,-21464.16 2598,-21464.16 2598,-21516.16"/>
<text text-anchor="middle" x="2537" y="-21504.16" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2537" y="-21493.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2537" y="-21482.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2537" y="-21471.16" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_embed&#45;&gt;gpu5_layer0_ln1 -->
<g id="edge1627" class="edge">
<title>gpu5_embed&#45;&gt;gpu5_layer0_ln1</title>
<path fill="none" stroke="black" d="M2535.58,-21553C2535.77,-21544.7 2535.98,-21535.32 2536.19,-21526.41"/>
<polygon fill="black" stroke="black" points="2539.69,-21526.35 2536.42,-21516.27 2532.69,-21526.19 2539.69,-21526.35"/>
</g>
<!-- gpu5_layer0_qkv -->
<g id="node1305" class="node">
<title>gpu5_layer0_qkv</title>
<polygon fill="lightblue" stroke="black" points="2601,-21427.16 2479,-21427.16 2479,-21375.16 2601,-21375.16 2601,-21427.16"/>
<text text-anchor="middle" x="2540" y="-21415.16" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2540" y="-21404.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2540" y="-21393.16" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2540" y="-21382.16" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer0_ln1&#45;&gt;gpu5_layer0_qkv -->
<g id="edge1628" class="edge">
<title>gpu5_layer0_ln1&#45;&gt;gpu5_layer0_qkv</title>
<path fill="none" stroke="black" d="M2537.87,-21464C2538.15,-21455.7 2538.48,-21446.32 2538.78,-21437.41"/>
<polygon fill="black" stroke="black" points="2542.29,-21437.39 2539.13,-21427.27 2535.29,-21437.15 2542.29,-21437.39"/>
</g>
<!-- gpu5_layer0_reshape -->
<g id="node1306" class="node">
<title>gpu5_layer0_reshape</title>
<polygon fill="lightblue" stroke="black" points="2608,-21338.16 2480,-21338.16 2480,-21286.16 2608,-21286.16 2608,-21338.16"/>
<text text-anchor="middle" x="2544" y="-21326.16" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2544" y="-21315.16" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2544" y="-21304.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2544" y="-21293.16" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer0_qkv&#45;&gt;gpu5_layer0_reshape -->
<g id="edge1629" class="edge">
<title>gpu5_layer0_qkv&#45;&gt;gpu5_layer0_reshape</title>
<path fill="none" stroke="black" d="M2541.16,-21375C2541.54,-21366.7 2541.97,-21357.32 2542.38,-21348.41"/>
<polygon fill="black" stroke="black" points="2545.88,-21348.42 2542.85,-21338.27 2538.89,-21348.1 2545.88,-21348.42"/>
</g>
<!-- gpu5_layer0_attn -->
<g id="node1307" class="node">
<title>gpu5_layer0_attn</title>
<polygon fill="lightblue" stroke="black" points="2608,-21249.16 2480,-21249.16 2480,-21197.16 2608,-21197.16 2608,-21249.16"/>
<text text-anchor="middle" x="2544" y="-21237.16" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2544" y="-21226.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2544" y="-21215.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2544" y="-21204.16" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer0_reshape&#45;&gt;gpu5_layer0_attn -->
<g id="edge1630" class="edge">
<title>gpu5_layer0_reshape&#45;&gt;gpu5_layer0_attn</title>
<path fill="none" stroke="black" d="M2544,-21286C2544,-21277.7 2544,-21268.32 2544,-21259.41"/>
<polygon fill="black" stroke="black" points="2547.5,-21259.27 2544,-21249.27 2540.5,-21259.27 2547.5,-21259.27"/>
</g>
<!-- gpu5_layer0_attn_reshape -->
<g id="node1309" class="node">
<title>gpu5_layer0_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2699,-21160.16 2577,-21160.16 2577,-21108.16 2699,-21108.16 2699,-21160.16"/>
<text text-anchor="middle" x="2638" y="-21148.16" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2638" y="-21137.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2638" y="-21126.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2638" y="-21115.16" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer0_attn&#45;&gt;gpu5_layer0_attn_reshape -->
<g id="edge1631" class="edge">
<title>gpu5_layer0_attn&#45;&gt;gpu5_layer0_attn_reshape</title>
<path fill="none" stroke="black" d="M2571.19,-21197C2581.22,-21187.71 2592.73,-21177.06 2603.34,-21167.24"/>
<polygon fill="black" stroke="black" points="2605.91,-21169.63 2610.87,-21160.27 2601.16,-21164.5 2605.91,-21169.63"/>
</g>
<!-- gpu5_layer0_attn_out -->
<g id="node1308" class="node">
<title>gpu5_layer0_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2807,-21071.16 2685,-21071.16 2685,-21019.16 2807,-21019.16 2807,-21071.16"/>
<text text-anchor="middle" x="2746" y="-21059.16" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2746" y="-21048.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2746" y="-21037.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2746" y="-21026.16" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer0_kv_update -->
<g id="node1310" class="node">
<title>gpu5_layer0_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="2777" cy="-20945.4" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="2777" y="-20959.4" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="2777" y="-20948.4" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2777" y="-20937.4" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2777" y="-20926.4" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer0_attn_out&#45;&gt;gpu5_layer0_kv_update -->
<g id="edge1633" class="edge">
<title>gpu5_layer0_attn_out&#45;&gt;gpu5_layer0_kv_update</title>
<path fill="none" stroke="black" d="M2753.98,-21018.99C2756.62,-21010.67 2759.64,-21001.15 2762.6,-20991.8"/>
<polygon fill="black" stroke="black" points="2765.97,-20992.76 2765.66,-20982.17 2759.3,-20990.65 2765.97,-20992.76"/>
</g>
<!-- gpu5_layer0_attn_reshape&#45;&gt;gpu5_layer0_attn_out -->
<g id="edge1632" class="edge">
<title>gpu5_layer0_attn_reshape&#45;&gt;gpu5_layer0_attn_out</title>
<path fill="none" stroke="black" d="M2669.24,-21108C2680.99,-21098.53 2694.51,-21087.65 2706.89,-21077.67"/>
<polygon fill="black" stroke="black" points="2709.24,-21080.27 2714.83,-21071.27 2704.85,-21074.82 2709.24,-21080.27"/>
</g>
<!-- gpu5_layer0_res1 -->
<g id="node1311" class="node">
<title>gpu5_layer0_res1</title>
<polygon fill="lightblue" stroke="black" points="3003,-20871.63 2881,-20871.63 2881,-20819.63 3003,-20819.63 3003,-20871.63"/>
<text text-anchor="middle" x="2942" y="-20859.63" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="2942" y="-20848.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2942" y="-20837.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2942" y="-20826.63" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer0_kv_update&#45;&gt;gpu5_layer0_res1 -->
<g id="edge1634" class="edge">
<title>gpu5_layer0_kv_update&#45;&gt;gpu5_layer0_res1</title>
<path fill="none" stroke="black" d="M2826.51,-20915.06C2846.94,-20902.95 2870.6,-20888.93 2891.17,-20876.74"/>
<polygon fill="black" stroke="black" points="2892.96,-20879.75 2899.78,-20871.64 2889.39,-20873.73 2892.96,-20879.75"/>
</g>
<!-- gpu5_layer0_ln2 -->
<g id="node1312" class="node">
<title>gpu5_layer0_ln2</title>
<polygon fill="lightblue" stroke="black" points="3255,-20782.63 3133,-20782.63 3133,-20730.63 3255,-20730.63 3255,-20782.63"/>
<text text-anchor="middle" x="3194" y="-20770.63" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3194" y="-20759.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3194" y="-20748.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3194" y="-20737.63" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer0_res1&#45;&gt;gpu5_layer0_ln2 -->
<g id="edge1635" class="edge">
<title>gpu5_layer0_res1&#45;&gt;gpu5_layer0_ln2</title>
<path fill="none" stroke="black" d="M3003,-20823.57C3039.11,-20811.1 3085.01,-20795.25 3122.77,-20782.22"/>
<polygon fill="black" stroke="black" points="3124.38,-20785.37 3132.69,-20778.79 3122.09,-20778.75 3124.38,-20785.37"/>
</g>
<!-- gpu5_layer0_routing -->
<g id="node1313" class="node">
<title>gpu5_layer0_routing</title>
<polygon fill="lightyellow" stroke="black" points="3386.47,-20693.63 3185.29,-20693.63 3133.53,-20567.63 3334.71,-20567.63 3386.47,-20693.63"/>
<text text-anchor="middle" x="3260" y="-20650.13" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3260" y="-20639.13" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3260" y="-20628.13" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3260" y="-20617.13" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3260" y="-20606.13" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer0_ln2&#45;&gt;gpu5_layer0_routing -->
<g id="edge1636" class="edge">
<title>gpu5_layer0_ln2&#45;&gt;gpu5_layer0_routing</title>
<path fill="none" stroke="black" d="M3207.36,-20730.53C3211.71,-20722.35 3216.78,-20712.82 3222.03,-20702.97"/>
<polygon fill="black" stroke="black" points="3225.27,-20704.33 3226.87,-20693.86 3219.09,-20701.04 3225.27,-20704.33"/>
</g>
<!-- gpu5_layer0_expert0 -->
<g id="node1314" class="node">
<title>gpu5_layer0_expert0</title>
<polygon fill="lightblue" stroke="black" points="3112,-20521.63 2990,-20521.63 2990,-20469.63 3112,-20469.63 3112,-20521.63"/>
<text text-anchor="middle" x="3051" y="-20509.63" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3051" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer0_routing&#45;&gt;gpu5_layer0_expert0 -->
<g id="edge1623" class="edge">
<title>gpu5_layer0_routing&#45;&gt;gpu5_layer0_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3162.54,-20567.6C3140.39,-20553.51 3117.82,-20539.14 3098.82,-20527.06"/>
<polygon fill="black" stroke="black" points="3100.68,-20524.09 3090.37,-20521.68 3096.92,-20530 3100.68,-20524.09"/>
<text text-anchor="middle" x="3159.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer0_expert1 -->
<g id="node1315" class="node">
<title>gpu5_layer0_expert1</title>
<polygon fill="lightblue" stroke="black" points="3252,-20521.63 3130,-20521.63 3130,-20469.63 3252,-20469.63 3252,-20521.63"/>
<text text-anchor="middle" x="3191" y="-20509.63" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3191" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer0_routing&#45;&gt;gpu5_layer0_expert1 -->
<g id="edge1624" class="edge">
<title>gpu5_layer0_routing&#45;&gt;gpu5_layer0_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3227.72,-20567.41C3221.2,-20554.84 3214.57,-20542.06 3208.78,-20530.89"/>
<polygon fill="black" stroke="black" points="3211.83,-20529.18 3204.12,-20521.92 3205.62,-20532.41 3211.83,-20529.18"/>
<text text-anchor="middle" x="3246.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer0_expert2 -->
<g id="node1316" class="node">
<title>gpu5_layer0_expert2</title>
<polygon fill="lightblue" stroke="black" points="3392,-20521.63 3270,-20521.63 3270,-20469.63 3392,-20469.63 3392,-20521.63"/>
<text text-anchor="middle" x="3331" y="-20509.63" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3331" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer0_routing&#45;&gt;gpu5_layer0_expert2 -->
<g id="edge1625" class="edge">
<title>gpu5_layer0_routing&#45;&gt;gpu5_layer0_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3293.21,-20567.41C3299.92,-20554.84 3306.74,-20542.06 3312.71,-20530.89"/>
<polygon fill="black" stroke="black" points="3315.88,-20532.39 3317.5,-20521.92 3309.7,-20529.09 3315.88,-20532.39"/>
<text text-anchor="middle" x="3337.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer0_expert3 -->
<g id="node1317" class="node">
<title>gpu5_layer0_expert3</title>
<polygon fill="lightblue" stroke="black" points="3532,-20521.63 3410,-20521.63 3410,-20469.63 3532,-20469.63 3532,-20521.63"/>
<text text-anchor="middle" x="3471" y="-20509.63" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="3471" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer0_routing&#45;&gt;gpu5_layer0_expert3 -->
<g id="edge1626" class="edge">
<title>gpu5_layer0_routing&#45;&gt;gpu5_layer0_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3339.77,-20579.34C3367.63,-20561.79 3398.03,-20542.62 3422.55,-20527.16"/>
<polygon fill="black" stroke="black" points="3424.71,-20529.94 3431.3,-20521.65 3420.98,-20524.02 3424.71,-20529.94"/>
<text text-anchor="middle" x="3431.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer0_expert_agg -->
<g id="node1318" class="node">
<title>gpu5_layer0_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-20432.63 3256.29,-20432.63 3204.53,-20328.63 3405.71,-20328.63 3457.47,-20432.63"/>
<text text-anchor="middle" x="3331" y="-20394.63" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3331" y="-20383.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-20372.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-20361.63" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer0_routing&#45;&gt;gpu5_layer0_expert_agg -->
<g id="edge1641" class="edge">
<title>gpu5_layer0_routing&#45;&gt;gpu5_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3356.31,-20620.16C3420.27,-20608.29 3499.79,-20581.61 3541,-20521.63 3573.21,-20474.73 3518.74,-20439.4 3457.21,-20415.95"/>
<polygon fill="black" stroke="black" points="3458.29,-20412.62 3447.7,-20412.44 3455.86,-20419.18 3458.29,-20412.62"/>
</g>
<!-- gpu5_layer0_expert0&#45;&gt;gpu5_layer0_expert_agg -->
<g id="edge1637" class="edge">
<title>gpu5_layer0_expert0&#45;&gt;gpu5_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3112.1,-20469.97C3148.98,-20455.08 3196.7,-20435.83 3238.16,-20419.09"/>
<polygon fill="black" stroke="black" points="3239.5,-20422.33 3247.46,-20415.34 3236.88,-20415.84 3239.5,-20422.33"/>
</g>
<!-- gpu5_layer0_expert1&#45;&gt;gpu5_layer0_expert_agg -->
<g id="edge1638" class="edge">
<title>gpu5_layer0_expert1&#45;&gt;gpu5_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3222.07,-20469.55C3233.32,-20460.47 3246.53,-20449.81 3259.8,-20439.1"/>
<polygon fill="black" stroke="black" points="3262.02,-20441.8 3267.6,-20432.8 3257.62,-20436.35 3262.02,-20441.8"/>
</g>
<!-- gpu5_layer0_expert2&#45;&gt;gpu5_layer0_expert_agg -->
<g id="edge1639" class="edge">
<title>gpu5_layer0_expert2&#45;&gt;gpu5_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3331,-20469.55C3331,-20461.62 3331,-20452.48 3331,-20443.16"/>
<polygon fill="black" stroke="black" points="3334.5,-20443.03 3331,-20433.03 3327.5,-20443.03 3334.5,-20443.03"/>
</g>
<!-- gpu5_layer0_expert3&#45;&gt;gpu5_layer0_expert_agg -->
<g id="edge1640" class="edge">
<title>gpu5_layer0_expert3&#45;&gt;gpu5_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3439.93,-20469.55C3428.68,-20460.47 3415.47,-20449.81 3402.2,-20439.1"/>
<polygon fill="black" stroke="black" points="3404.38,-20436.35 3394.4,-20432.8 3399.98,-20441.8 3404.38,-20436.35"/>
</g>
<!-- gpu5_layer0_res2 -->
<g id="node1319" class="node">
<title>gpu5_layer0_res2</title>
<polygon fill="lightblue" stroke="black" points="3392,-20291.63 3270,-20291.63 3270,-20239.63 3392,-20239.63 3392,-20291.63"/>
<text text-anchor="middle" x="3331" y="-20279.63" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3331" y="-20268.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-20257.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-20246.63" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer0_expert_agg&#45;&gt;gpu5_layer0_res2 -->
<g id="edge1642" class="edge">
<title>gpu5_layer0_expert_agg&#45;&gt;gpu5_layer0_res2</title>
<path fill="none" stroke="black" d="M3331,-20328.42C3331,-20319.46 3331,-20310.34 3331,-20301.94"/>
<polygon fill="black" stroke="black" points="3334.5,-20301.76 3331,-20291.76 3327.5,-20301.76 3334.5,-20301.76"/>
</g>
<!-- gpu5_layer1_ln1 -->
<g id="node1320" class="node">
<title>gpu5_layer1_ln1</title>
<polygon fill="lightblue" stroke="black" points="3392,-20202.63 3270,-20202.63 3270,-20150.63 3392,-20150.63 3392,-20202.63"/>
<text text-anchor="middle" x="3331" y="-20190.63" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3331" y="-20179.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-20168.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-20157.63" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer0_res2&#45;&gt;gpu5_layer1_ln1 -->
<g id="edge1647" class="edge">
<title>gpu5_layer0_res2&#45;&gt;gpu5_layer1_ln1</title>
<path fill="none" stroke="black" d="M3331,-20239.46C3331,-20231.17 3331,-20221.78 3331,-20212.87"/>
<polygon fill="black" stroke="black" points="3334.5,-20212.73 3331,-20202.73 3327.5,-20212.73 3334.5,-20212.73"/>
</g>
<!-- gpu5_layer1_qkv -->
<g id="node1321" class="node">
<title>gpu5_layer1_qkv</title>
<polygon fill="lightblue" stroke="black" points="3392,-20113.63 3270,-20113.63 3270,-20061.63 3392,-20061.63 3392,-20113.63"/>
<text text-anchor="middle" x="3331" y="-20101.63" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3331" y="-20090.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-20079.63" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-20068.63" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer1_ln1&#45;&gt;gpu5_layer1_qkv -->
<g id="edge1648" class="edge">
<title>gpu5_layer1_ln1&#45;&gt;gpu5_layer1_qkv</title>
<path fill="none" stroke="black" d="M3331,-20150.46C3331,-20142.17 3331,-20132.78 3331,-20123.87"/>
<polygon fill="black" stroke="black" points="3334.5,-20123.73 3331,-20113.73 3327.5,-20123.73 3334.5,-20123.73"/>
</g>
<!-- gpu5_layer1_reshape -->
<g id="node1322" class="node">
<title>gpu5_layer1_reshape</title>
<polygon fill="lightblue" stroke="black" points="3395,-20024.63 3267,-20024.63 3267,-19972.63 3395,-19972.63 3395,-20024.63"/>
<text text-anchor="middle" x="3331" y="-20012.63" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3331" y="-20001.63" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-19990.63" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-19979.63" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer1_qkv&#45;&gt;gpu5_layer1_reshape -->
<g id="edge1649" class="edge">
<title>gpu5_layer1_qkv&#45;&gt;gpu5_layer1_reshape</title>
<path fill="none" stroke="black" d="M3331,-20061.46C3331,-20053.17 3331,-20043.78 3331,-20034.87"/>
<polygon fill="black" stroke="black" points="3334.5,-20034.73 3331,-20024.73 3327.5,-20034.73 3334.5,-20034.73"/>
</g>
<!-- gpu5_layer1_attn -->
<g id="node1323" class="node">
<title>gpu5_layer1_attn</title>
<polygon fill="lightblue" stroke="black" points="3395,-19935.63 3267,-19935.63 3267,-19883.63 3395,-19883.63 3395,-19935.63"/>
<text text-anchor="middle" x="3331" y="-19923.63" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3331" y="-19912.63" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-19901.63" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-19890.63" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer1_reshape&#45;&gt;gpu5_layer1_attn -->
<g id="edge1650" class="edge">
<title>gpu5_layer1_reshape&#45;&gt;gpu5_layer1_attn</title>
<path fill="none" stroke="black" d="M3331,-19972.46C3331,-19964.17 3331,-19954.78 3331,-19945.87"/>
<polygon fill="black" stroke="black" points="3334.5,-19945.73 3331,-19935.73 3327.5,-19945.73 3334.5,-19945.73"/>
</g>
<!-- gpu5_layer1_attn_reshape -->
<g id="node1325" class="node">
<title>gpu5_layer1_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3392,-19846.63 3270,-19846.63 3270,-19794.63 3392,-19794.63 3392,-19846.63"/>
<text text-anchor="middle" x="3331" y="-19834.63" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3331" y="-19823.63" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-19812.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-19801.63" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer1_attn&#45;&gt;gpu5_layer1_attn_reshape -->
<g id="edge1651" class="edge">
<title>gpu5_layer1_attn&#45;&gt;gpu5_layer1_attn_reshape</title>
<path fill="none" stroke="black" d="M3331,-19883.46C3331,-19875.17 3331,-19865.78 3331,-19856.87"/>
<polygon fill="black" stroke="black" points="3334.5,-19856.73 3331,-19846.73 3327.5,-19856.73 3334.5,-19856.73"/>
</g>
<!-- gpu5_layer1_attn_out -->
<g id="node1324" class="node">
<title>gpu5_layer1_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3392,-19757.63 3270,-19757.63 3270,-19705.63 3392,-19705.63 3392,-19757.63"/>
<text text-anchor="middle" x="3331" y="-19745.63" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3331" y="-19734.63" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-19723.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-19712.63" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer1_kv_update -->
<g id="node1326" class="node">
<title>gpu5_layer1_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3331" cy="-19631.86" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3331" y="-19645.86" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3331" y="-19634.86" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-19623.86" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-19612.86" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer1_attn_out&#45;&gt;gpu5_layer1_kv_update -->
<g id="edge1653" class="edge">
<title>gpu5_layer1_attn_out&#45;&gt;gpu5_layer1_kv_update</title>
<path fill="none" stroke="black" d="M3331,-19705.45C3331,-19697.31 3331,-19688.01 3331,-19678.85"/>
<polygon fill="black" stroke="black" points="3334.5,-19678.64 3331,-19668.64 3327.5,-19678.64 3334.5,-19678.64"/>
</g>
<!-- gpu5_layer1_attn_reshape&#45;&gt;gpu5_layer1_attn_out -->
<g id="edge1652" class="edge">
<title>gpu5_layer1_attn_reshape&#45;&gt;gpu5_layer1_attn_out</title>
<path fill="none" stroke="black" d="M3331,-19794.46C3331,-19786.17 3331,-19776.78 3331,-19767.87"/>
<polygon fill="black" stroke="black" points="3334.5,-19767.73 3331,-19757.73 3327.5,-19767.73 3334.5,-19767.73"/>
</g>
<!-- gpu5_layer1_res1 -->
<g id="node1327" class="node">
<title>gpu5_layer1_res1</title>
<polygon fill="lightblue" stroke="black" points="3392,-19558.09 3270,-19558.09 3270,-19506.09 3392,-19506.09 3392,-19558.09"/>
<text text-anchor="middle" x="3331" y="-19546.09" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3331" y="-19535.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-19524.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-19513.09" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer1_kv_update&#45;&gt;gpu5_layer1_res1 -->
<g id="edge1654" class="edge">
<title>gpu5_layer1_kv_update&#45;&gt;gpu5_layer1_res1</title>
<path fill="none" stroke="black" d="M3331,-19595.01C3331,-19586.33 3331,-19577.06 3331,-19568.4"/>
<polygon fill="black" stroke="black" points="3334.5,-19568.23 3331,-19558.23 3327.5,-19568.23 3334.5,-19568.23"/>
</g>
<!-- gpu5_layer1_ln2 -->
<g id="node1328" class="node">
<title>gpu5_layer1_ln2</title>
<polygon fill="lightblue" stroke="black" points="3392,-19469.09 3270,-19469.09 3270,-19417.09 3392,-19417.09 3392,-19469.09"/>
<text text-anchor="middle" x="3331" y="-19457.09" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3331" y="-19446.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-19435.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-19424.09" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer1_res1&#45;&gt;gpu5_layer1_ln2 -->
<g id="edge1655" class="edge">
<title>gpu5_layer1_res1&#45;&gt;gpu5_layer1_ln2</title>
<path fill="none" stroke="black" d="M3331,-19505.92C3331,-19497.63 3331,-19488.24 3331,-19479.34"/>
<polygon fill="black" stroke="black" points="3334.5,-19479.19 3331,-19469.19 3327.5,-19479.19 3334.5,-19479.19"/>
</g>
<!-- gpu5_layer1_routing -->
<g id="node1329" class="node">
<title>gpu5_layer1_routing</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-19380.09 3256.29,-19380.09 3204.53,-19254.09 3405.71,-19254.09 3457.47,-19380.09"/>
<text text-anchor="middle" x="3331" y="-19336.59" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3331" y="-19325.59" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-19314.59" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-19303.59" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3331" y="-19292.59" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer1_ln2&#45;&gt;gpu5_layer1_routing -->
<g id="edge1656" class="edge">
<title>gpu5_layer1_ln2&#45;&gt;gpu5_layer1_routing</title>
<path fill="none" stroke="black" d="M3331,-19416.99C3331,-19409.06 3331,-19399.86 3331,-19390.33"/>
<polygon fill="black" stroke="black" points="3334.5,-19390.32 3331,-19380.32 3327.5,-19390.32 3334.5,-19390.32"/>
</g>
<!-- gpu5_layer1_expert0 -->
<g id="node1330" class="node">
<title>gpu5_layer1_expert0</title>
<polygon fill="lightblue" stroke="black" points="3112,-19208.09 2990,-19208.09 2990,-19156.09 3112,-19156.09 3112,-19208.09"/>
<text text-anchor="middle" x="3051" y="-19196.09" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3051" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer1_routing&#45;&gt;gpu5_layer1_expert0 -->
<g id="edge1643" class="edge">
<title>gpu5_layer1_routing&#45;&gt;gpu5_layer1_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3205.33,-19256.39C3173.34,-19241.2 3140.34,-19225.52 3113.11,-19212.59"/>
<polygon fill="black" stroke="black" points="3114.26,-19209.26 3103.73,-19208.13 3111.26,-19215.58 3114.26,-19209.26"/>
<text text-anchor="middle" x="3186.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer1_expert1 -->
<g id="node1331" class="node">
<title>gpu5_layer1_expert1</title>
<polygon fill="lightblue" stroke="black" points="3252,-19208.09 3130,-19208.09 3130,-19156.09 3252,-19156.09 3252,-19208.09"/>
<text text-anchor="middle" x="3191" y="-19196.09" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3191" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer1_routing&#45;&gt;gpu5_layer1_expert1 -->
<g id="edge1644" class="edge">
<title>gpu5_layer1_routing&#45;&gt;gpu5_layer1_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3265.51,-19253.87C3251.48,-19240.55 3237.21,-19226.99 3224.97,-19215.36"/>
<polygon fill="black" stroke="black" points="3227.29,-19212.73 3217.63,-19208.38 3222.46,-19217.81 3227.29,-19212.73"/>
<text text-anchor="middle" x="3273.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer1_expert2 -->
<g id="node1332" class="node">
<title>gpu5_layer1_expert2</title>
<polygon fill="lightblue" stroke="black" points="3392,-19208.09 3270,-19208.09 3270,-19156.09 3392,-19156.09 3392,-19208.09"/>
<text text-anchor="middle" x="3331" y="-19196.09" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3331" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer1_routing&#45;&gt;gpu5_layer1_expert2 -->
<g id="edge1645" class="edge">
<title>gpu5_layer1_routing&#45;&gt;gpu5_layer1_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3331,-19253.87C3331,-19241.8 3331,-19229.55 3331,-19218.7"/>
<polygon fill="black" stroke="black" points="3334.5,-19218.38 3331,-19208.38 3327.5,-19218.38 3334.5,-19218.38"/>
<text text-anchor="middle" x="3360.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer1_expert3 -->
<g id="node1333" class="node">
<title>gpu5_layer1_expert3</title>
<polygon fill="lightblue" stroke="black" points="3532,-19208.09 3410,-19208.09 3410,-19156.09 3532,-19156.09 3532,-19208.09"/>
<text text-anchor="middle" x="3471" y="-19196.09" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="3471" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer1_routing&#45;&gt;gpu5_layer1_expert3 -->
<g id="edge1646" class="edge">
<title>gpu5_layer1_routing&#45;&gt;gpu5_layer1_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3396.49,-19253.87C3410.52,-19240.55 3424.79,-19226.99 3437.03,-19215.36"/>
<polygon fill="black" stroke="black" points="3439.54,-19217.81 3444.37,-19208.38 3434.71,-19212.73 3439.54,-19217.81"/>
<text text-anchor="middle" x="3454.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer1_expert_agg -->
<g id="node1334" class="node">
<title>gpu5_layer1_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-19119.09 3256.29,-19119.09 3204.53,-19015.09 3405.71,-19015.09 3457.47,-19119.09"/>
<text text-anchor="middle" x="3331" y="-19081.09" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3331" y="-19070.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-19059.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-19048.09" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer1_routing&#45;&gt;gpu5_layer1_expert_agg -->
<g id="edge1661" class="edge">
<title>gpu5_layer1_routing&#45;&gt;gpu5_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3420.22,-19289.17C3493.96,-19262.01 3580.6,-19215.62 3541,-19156.09 3520.44,-19125.17 3486.7,-19105.1 3452.22,-19092.07"/>
<polygon fill="black" stroke="black" points="3453.08,-19088.66 3442.48,-19088.58 3450.71,-19095.25 3453.08,-19088.66"/>
</g>
<!-- gpu5_layer1_expert0&#45;&gt;gpu5_layer1_expert_agg -->
<g id="edge1657" class="edge">
<title>gpu5_layer1_expert0&#45;&gt;gpu5_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3112.1,-19156.43C3148.98,-19141.55 3196.7,-19122.29 3238.16,-19105.55"/>
<polygon fill="black" stroke="black" points="3239.5,-19108.79 3247.46,-19101.8 3236.88,-19102.3 3239.5,-19108.79"/>
</g>
<!-- gpu5_layer1_expert1&#45;&gt;gpu5_layer1_expert_agg -->
<g id="edge1658" class="edge">
<title>gpu5_layer1_expert1&#45;&gt;gpu5_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3222.07,-19156.01C3233.32,-19146.93 3246.53,-19136.27 3259.8,-19125.56"/>
<polygon fill="black" stroke="black" points="3262.02,-19128.26 3267.6,-19119.26 3257.62,-19122.82 3262.02,-19128.26"/>
</g>
<!-- gpu5_layer1_expert2&#45;&gt;gpu5_layer1_expert_agg -->
<g id="edge1659" class="edge">
<title>gpu5_layer1_expert2&#45;&gt;gpu5_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3331,-19156.01C3331,-19148.08 3331,-19138.95 3331,-19129.62"/>
<polygon fill="black" stroke="black" points="3334.5,-19129.49 3331,-19119.49 3327.5,-19129.49 3334.5,-19129.49"/>
</g>
<!-- gpu5_layer1_expert3&#45;&gt;gpu5_layer1_expert_agg -->
<g id="edge1660" class="edge">
<title>gpu5_layer1_expert3&#45;&gt;gpu5_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3439.93,-19156.01C3428.68,-19146.93 3415.47,-19136.27 3402.2,-19125.56"/>
<polygon fill="black" stroke="black" points="3404.38,-19122.82 3394.4,-19119.26 3399.98,-19128.26 3404.38,-19122.82"/>
</g>
<!-- gpu5_layer1_res2 -->
<g id="node1335" class="node">
<title>gpu5_layer1_res2</title>
<polygon fill="lightblue" stroke="black" points="3392,-18978.09 3270,-18978.09 3270,-18926.09 3392,-18926.09 3392,-18978.09"/>
<text text-anchor="middle" x="3331" y="-18966.09" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3331" y="-18955.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-18944.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-18933.09" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer1_expert_agg&#45;&gt;gpu5_layer1_res2 -->
<g id="edge1662" class="edge">
<title>gpu5_layer1_expert_agg&#45;&gt;gpu5_layer1_res2</title>
<path fill="none" stroke="black" d="M3331,-19014.88C3331,-19005.93 3331,-18996.8 3331,-18988.4"/>
<polygon fill="black" stroke="black" points="3334.5,-18988.22 3331,-18978.22 3327.5,-18988.22 3334.5,-18988.22"/>
</g>
<!-- gpu5_layer2_ln1 -->
<g id="node1336" class="node">
<title>gpu5_layer2_ln1</title>
<polygon fill="lightblue" stroke="black" points="3392,-18889.09 3270,-18889.09 3270,-18837.09 3392,-18837.09 3392,-18889.09"/>
<text text-anchor="middle" x="3331" y="-18877.09" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3331" y="-18866.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-18855.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-18844.09" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer1_res2&#45;&gt;gpu5_layer2_ln1 -->
<g id="edge1667" class="edge">
<title>gpu5_layer1_res2&#45;&gt;gpu5_layer2_ln1</title>
<path fill="none" stroke="black" d="M3331,-18925.92C3331,-18917.63 3331,-18908.24 3331,-18899.34"/>
<polygon fill="black" stroke="black" points="3334.5,-18899.19 3331,-18889.19 3327.5,-18899.19 3334.5,-18899.19"/>
</g>
<!-- gpu5_layer2_qkv -->
<g id="node1337" class="node">
<title>gpu5_layer2_qkv</title>
<polygon fill="lightblue" stroke="black" points="3392,-18800.09 3270,-18800.09 3270,-18748.09 3392,-18748.09 3392,-18800.09"/>
<text text-anchor="middle" x="3331" y="-18788.09" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3331" y="-18777.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-18766.09" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-18755.09" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer2_ln1&#45;&gt;gpu5_layer2_qkv -->
<g id="edge1668" class="edge">
<title>gpu5_layer2_ln1&#45;&gt;gpu5_layer2_qkv</title>
<path fill="none" stroke="black" d="M3331,-18836.92C3331,-18828.63 3331,-18819.24 3331,-18810.34"/>
<polygon fill="black" stroke="black" points="3334.5,-18810.19 3331,-18800.19 3327.5,-18810.19 3334.5,-18810.19"/>
</g>
<!-- gpu5_layer2_reshape -->
<g id="node1338" class="node">
<title>gpu5_layer2_reshape</title>
<polygon fill="lightblue" stroke="black" points="3395,-18711.09 3267,-18711.09 3267,-18659.09 3395,-18659.09 3395,-18711.09"/>
<text text-anchor="middle" x="3331" y="-18699.09" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3331" y="-18688.09" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-18677.09" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-18666.09" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer2_qkv&#45;&gt;gpu5_layer2_reshape -->
<g id="edge1669" class="edge">
<title>gpu5_layer2_qkv&#45;&gt;gpu5_layer2_reshape</title>
<path fill="none" stroke="black" d="M3331,-18747.92C3331,-18739.63 3331,-18730.24 3331,-18721.34"/>
<polygon fill="black" stroke="black" points="3334.5,-18721.19 3331,-18711.19 3327.5,-18721.19 3334.5,-18721.19"/>
</g>
<!-- gpu5_layer2_attn -->
<g id="node1339" class="node">
<title>gpu5_layer2_attn</title>
<polygon fill="lightblue" stroke="black" points="3395,-18622.09 3267,-18622.09 3267,-18570.09 3395,-18570.09 3395,-18622.09"/>
<text text-anchor="middle" x="3331" y="-18610.09" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3331" y="-18599.09" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-18588.09" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-18577.09" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer2_reshape&#45;&gt;gpu5_layer2_attn -->
<g id="edge1670" class="edge">
<title>gpu5_layer2_reshape&#45;&gt;gpu5_layer2_attn</title>
<path fill="none" stroke="black" d="M3331,-18658.92C3331,-18650.63 3331,-18641.24 3331,-18632.34"/>
<polygon fill="black" stroke="black" points="3334.5,-18632.19 3331,-18622.19 3327.5,-18632.19 3334.5,-18632.19"/>
</g>
<!-- gpu5_layer2_attn_reshape -->
<g id="node1341" class="node">
<title>gpu5_layer2_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3392,-18533.09 3270,-18533.09 3270,-18481.09 3392,-18481.09 3392,-18533.09"/>
<text text-anchor="middle" x="3331" y="-18521.09" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3331" y="-18510.09" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-18499.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-18488.09" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer2_attn&#45;&gt;gpu5_layer2_attn_reshape -->
<g id="edge1671" class="edge">
<title>gpu5_layer2_attn&#45;&gt;gpu5_layer2_attn_reshape</title>
<path fill="none" stroke="black" d="M3331,-18569.92C3331,-18561.63 3331,-18552.24 3331,-18543.34"/>
<polygon fill="black" stroke="black" points="3334.5,-18543.19 3331,-18533.19 3327.5,-18543.19 3334.5,-18543.19"/>
</g>
<!-- gpu5_layer2_attn_out -->
<g id="node1340" class="node">
<title>gpu5_layer2_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3392,-18444.09 3270,-18444.09 3270,-18392.09 3392,-18392.09 3392,-18444.09"/>
<text text-anchor="middle" x="3331" y="-18432.09" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3331" y="-18421.09" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-18410.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-18399.09" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer2_kv_update -->
<g id="node1342" class="node">
<title>gpu5_layer2_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3331" cy="-18318.32" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3331" y="-18332.32" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3331" y="-18321.32" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-18310.32" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-18299.32" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer2_attn_out&#45;&gt;gpu5_layer2_kv_update -->
<g id="edge1673" class="edge">
<title>gpu5_layer2_attn_out&#45;&gt;gpu5_layer2_kv_update</title>
<path fill="none" stroke="black" d="M3331,-18391.91C3331,-18383.77 3331,-18374.47 3331,-18365.31"/>
<polygon fill="black" stroke="black" points="3334.5,-18365.1 3331,-18355.1 3327.5,-18365.1 3334.5,-18365.1"/>
</g>
<!-- gpu5_layer2_attn_reshape&#45;&gt;gpu5_layer2_attn_out -->
<g id="edge1672" class="edge">
<title>gpu5_layer2_attn_reshape&#45;&gt;gpu5_layer2_attn_out</title>
<path fill="none" stroke="black" d="M3331,-18480.92C3331,-18472.63 3331,-18463.24 3331,-18454.34"/>
<polygon fill="black" stroke="black" points="3334.5,-18454.19 3331,-18444.19 3327.5,-18454.19 3334.5,-18454.19"/>
</g>
<!-- gpu5_layer2_res1 -->
<g id="node1343" class="node">
<title>gpu5_layer2_res1</title>
<polygon fill="lightblue" stroke="black" points="3392,-18244.55 3270,-18244.55 3270,-18192.55 3392,-18192.55 3392,-18244.55"/>
<text text-anchor="middle" x="3331" y="-18232.55" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3331" y="-18221.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-18210.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-18199.55" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer2_kv_update&#45;&gt;gpu5_layer2_res1 -->
<g id="edge1674" class="edge">
<title>gpu5_layer2_kv_update&#45;&gt;gpu5_layer2_res1</title>
<path fill="none" stroke="black" d="M3331,-18281.47C3331,-18272.79 3331,-18263.52 3331,-18254.86"/>
<polygon fill="black" stroke="black" points="3334.5,-18254.69 3331,-18244.69 3327.5,-18254.69 3334.5,-18254.69"/>
</g>
<!-- gpu5_layer2_ln2 -->
<g id="node1344" class="node">
<title>gpu5_layer2_ln2</title>
<polygon fill="lightblue" stroke="black" points="3392,-18155.55 3270,-18155.55 3270,-18103.55 3392,-18103.55 3392,-18155.55"/>
<text text-anchor="middle" x="3331" y="-18143.55" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3331" y="-18132.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-18121.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-18110.55" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer2_res1&#45;&gt;gpu5_layer2_ln2 -->
<g id="edge1675" class="edge">
<title>gpu5_layer2_res1&#45;&gt;gpu5_layer2_ln2</title>
<path fill="none" stroke="black" d="M3331,-18192.38C3331,-18184.09 3331,-18174.7 3331,-18165.8"/>
<polygon fill="black" stroke="black" points="3334.5,-18165.65 3331,-18155.65 3327.5,-18165.65 3334.5,-18165.65"/>
</g>
<!-- gpu5_layer2_routing -->
<g id="node1345" class="node">
<title>gpu5_layer2_routing</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-18066.55 3256.29,-18066.55 3204.53,-17940.55 3405.71,-17940.55 3457.47,-18066.55"/>
<text text-anchor="middle" x="3331" y="-18023.05" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3331" y="-18012.05" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-18001.05" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-17990.05" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3331" y="-17979.05" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer2_ln2&#45;&gt;gpu5_layer2_routing -->
<g id="edge1676" class="edge">
<title>gpu5_layer2_ln2&#45;&gt;gpu5_layer2_routing</title>
<path fill="none" stroke="black" d="M3331,-18103.45C3331,-18095.52 3331,-18086.33 3331,-18076.8"/>
<polygon fill="black" stroke="black" points="3334.5,-18076.78 3331,-18066.78 3327.5,-18076.78 3334.5,-18076.78"/>
</g>
<!-- gpu5_layer2_expert0 -->
<g id="node1346" class="node">
<title>gpu5_layer2_expert0</title>
<polygon fill="lightblue" stroke="black" points="3112,-17894.55 2990,-17894.55 2990,-17842.55 3112,-17842.55 3112,-17894.55"/>
<text text-anchor="middle" x="3051" y="-17882.55" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3051" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer2_routing&#45;&gt;gpu5_layer2_expert0 -->
<g id="edge1663" class="edge">
<title>gpu5_layer2_routing&#45;&gt;gpu5_layer2_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3205.33,-17942.86C3173.34,-17927.66 3140.34,-17911.98 3113.11,-17899.05"/>
<polygon fill="black" stroke="black" points="3114.26,-17895.72 3103.73,-17894.59 3111.26,-17902.04 3114.26,-17895.72"/>
<text text-anchor="middle" x="3186.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer2_expert1 -->
<g id="node1347" class="node">
<title>gpu5_layer2_expert1</title>
<polygon fill="lightblue" stroke="black" points="3252,-17894.55 3130,-17894.55 3130,-17842.55 3252,-17842.55 3252,-17894.55"/>
<text text-anchor="middle" x="3191" y="-17882.55" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3191" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer2_routing&#45;&gt;gpu5_layer2_expert1 -->
<g id="edge1664" class="edge">
<title>gpu5_layer2_routing&#45;&gt;gpu5_layer2_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3265.51,-17940.33C3251.48,-17927.01 3237.21,-17913.45 3224.97,-17901.82"/>
<polygon fill="black" stroke="black" points="3227.29,-17899.19 3217.63,-17894.84 3222.46,-17904.27 3227.29,-17899.19"/>
<text text-anchor="middle" x="3273.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer2_expert2 -->
<g id="node1348" class="node">
<title>gpu5_layer2_expert2</title>
<polygon fill="lightblue" stroke="black" points="3392,-17894.55 3270,-17894.55 3270,-17842.55 3392,-17842.55 3392,-17894.55"/>
<text text-anchor="middle" x="3331" y="-17882.55" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3331" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer2_routing&#45;&gt;gpu5_layer2_expert2 -->
<g id="edge1665" class="edge">
<title>gpu5_layer2_routing&#45;&gt;gpu5_layer2_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3331,-17940.33C3331,-17928.26 3331,-17916.01 3331,-17905.16"/>
<polygon fill="black" stroke="black" points="3334.5,-17904.84 3331,-17894.84 3327.5,-17904.84 3334.5,-17904.84"/>
<text text-anchor="middle" x="3360.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer2_expert3 -->
<g id="node1349" class="node">
<title>gpu5_layer2_expert3</title>
<polygon fill="lightblue" stroke="black" points="3532,-17894.55 3410,-17894.55 3410,-17842.55 3532,-17842.55 3532,-17894.55"/>
<text text-anchor="middle" x="3471" y="-17882.55" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="3471" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer2_routing&#45;&gt;gpu5_layer2_expert3 -->
<g id="edge1666" class="edge">
<title>gpu5_layer2_routing&#45;&gt;gpu5_layer2_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3396.49,-17940.33C3410.52,-17927.01 3424.79,-17913.45 3437.03,-17901.82"/>
<polygon fill="black" stroke="black" points="3439.54,-17904.27 3444.37,-17894.84 3434.71,-17899.19 3439.54,-17904.27"/>
<text text-anchor="middle" x="3454.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer2_expert_agg -->
<g id="node1350" class="node">
<title>gpu5_layer2_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-17805.55 3256.29,-17805.55 3204.53,-17701.55 3405.71,-17701.55 3457.47,-17805.55"/>
<text text-anchor="middle" x="3331" y="-17767.55" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3331" y="-17756.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-17745.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-17734.55" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer2_routing&#45;&gt;gpu5_layer2_expert_agg -->
<g id="edge1681" class="edge">
<title>gpu5_layer2_routing&#45;&gt;gpu5_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M3420.22,-17975.63C3493.96,-17948.47 3580.6,-17902.08 3541,-17842.55 3520.44,-17811.64 3486.7,-17791.56 3452.22,-17778.53"/>
<polygon fill="black" stroke="black" points="3453.08,-17775.12 3442.48,-17775.04 3450.71,-17781.71 3453.08,-17775.12"/>
</g>
<!-- gpu5_layer2_expert0&#45;&gt;gpu5_layer2_expert_agg -->
<g id="edge1677" class="edge">
<title>gpu5_layer2_expert0&#45;&gt;gpu5_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M3112.1,-17842.89C3148.98,-17828.01 3196.7,-17808.75 3238.16,-17792.01"/>
<polygon fill="black" stroke="black" points="3239.5,-17795.25 3247.46,-17788.26 3236.88,-17788.76 3239.5,-17795.25"/>
</g>
<!-- gpu5_layer2_expert1&#45;&gt;gpu5_layer2_expert_agg -->
<g id="edge1678" class="edge">
<title>gpu5_layer2_expert1&#45;&gt;gpu5_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M3222.07,-17842.47C3233.32,-17833.39 3246.53,-17822.73 3259.8,-17812.02"/>
<polygon fill="black" stroke="black" points="3262.02,-17814.72 3267.6,-17805.72 3257.62,-17809.28 3262.02,-17814.72"/>
</g>
<!-- gpu5_layer2_expert2&#45;&gt;gpu5_layer2_expert_agg -->
<g id="edge1679" class="edge">
<title>gpu5_layer2_expert2&#45;&gt;gpu5_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M3331,-17842.47C3331,-17834.54 3331,-17825.41 3331,-17816.09"/>
<polygon fill="black" stroke="black" points="3334.5,-17815.95 3331,-17805.95 3327.5,-17815.95 3334.5,-17815.95"/>
</g>
<!-- gpu5_layer2_expert3&#45;&gt;gpu5_layer2_expert_agg -->
<g id="edge1680" class="edge">
<title>gpu5_layer2_expert3&#45;&gt;gpu5_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M3439.93,-17842.47C3428.68,-17833.39 3415.47,-17822.73 3402.2,-17812.02"/>
<polygon fill="black" stroke="black" points="3404.38,-17809.28 3394.4,-17805.72 3399.98,-17814.72 3404.38,-17809.28"/>
</g>
<!-- gpu5_layer2_res2 -->
<g id="node1351" class="node">
<title>gpu5_layer2_res2</title>
<polygon fill="lightblue" stroke="black" points="3392,-17664.55 3270,-17664.55 3270,-17612.55 3392,-17612.55 3392,-17664.55"/>
<text text-anchor="middle" x="3331" y="-17652.55" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3331" y="-17641.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-17630.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-17619.55" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer2_expert_agg&#45;&gt;gpu5_layer2_res2 -->
<g id="edge1682" class="edge">
<title>gpu5_layer2_expert_agg&#45;&gt;gpu5_layer2_res2</title>
<path fill="none" stroke="black" d="M3331,-17701.34C3331,-17692.39 3331,-17683.26 3331,-17674.86"/>
<polygon fill="black" stroke="black" points="3334.5,-17674.68 3331,-17664.68 3327.5,-17674.68 3334.5,-17674.68"/>
</g>
<!-- gpu5_layer3_ln1 -->
<g id="node1352" class="node">
<title>gpu5_layer3_ln1</title>
<polygon fill="lightblue" stroke="black" points="3392,-17575.55 3270,-17575.55 3270,-17523.55 3392,-17523.55 3392,-17575.55"/>
<text text-anchor="middle" x="3331" y="-17563.55" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3331" y="-17552.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-17541.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-17530.55" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer2_res2&#45;&gt;gpu5_layer3_ln1 -->
<g id="edge1687" class="edge">
<title>gpu5_layer2_res2&#45;&gt;gpu5_layer3_ln1</title>
<path fill="none" stroke="black" d="M3331,-17612.38C3331,-17604.09 3331,-17594.7 3331,-17585.8"/>
<polygon fill="black" stroke="black" points="3334.5,-17585.65 3331,-17575.65 3327.5,-17585.65 3334.5,-17585.65"/>
</g>
<!-- gpu5_layer3_qkv -->
<g id="node1353" class="node">
<title>gpu5_layer3_qkv</title>
<polygon fill="lightblue" stroke="black" points="3392,-17486.55 3270,-17486.55 3270,-17434.55 3392,-17434.55 3392,-17486.55"/>
<text text-anchor="middle" x="3331" y="-17474.55" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3331" y="-17463.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-17452.55" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-17441.55" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer3_ln1&#45;&gt;gpu5_layer3_qkv -->
<g id="edge1688" class="edge">
<title>gpu5_layer3_ln1&#45;&gt;gpu5_layer3_qkv</title>
<path fill="none" stroke="black" d="M3331,-17523.38C3331,-17515.09 3331,-17505.7 3331,-17496.8"/>
<polygon fill="black" stroke="black" points="3334.5,-17496.65 3331,-17486.65 3327.5,-17496.65 3334.5,-17496.65"/>
</g>
<!-- gpu5_layer3_reshape -->
<g id="node1354" class="node">
<title>gpu5_layer3_reshape</title>
<polygon fill="lightblue" stroke="black" points="3395,-17397.55 3267,-17397.55 3267,-17345.55 3395,-17345.55 3395,-17397.55"/>
<text text-anchor="middle" x="3331" y="-17385.55" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3331" y="-17374.55" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-17363.55" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-17352.55" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer3_qkv&#45;&gt;gpu5_layer3_reshape -->
<g id="edge1689" class="edge">
<title>gpu5_layer3_qkv&#45;&gt;gpu5_layer3_reshape</title>
<path fill="none" stroke="black" d="M3331,-17434.38C3331,-17426.09 3331,-17416.7 3331,-17407.8"/>
<polygon fill="black" stroke="black" points="3334.5,-17407.65 3331,-17397.65 3327.5,-17407.65 3334.5,-17407.65"/>
</g>
<!-- gpu5_layer3_attn -->
<g id="node1355" class="node">
<title>gpu5_layer3_attn</title>
<polygon fill="lightblue" stroke="black" points="3395,-17308.55 3267,-17308.55 3267,-17256.55 3395,-17256.55 3395,-17308.55"/>
<text text-anchor="middle" x="3331" y="-17296.55" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3331" y="-17285.55" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-17274.55" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-17263.55" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer3_reshape&#45;&gt;gpu5_layer3_attn -->
<g id="edge1690" class="edge">
<title>gpu5_layer3_reshape&#45;&gt;gpu5_layer3_attn</title>
<path fill="none" stroke="black" d="M3331,-17345.38C3331,-17337.09 3331,-17327.7 3331,-17318.8"/>
<polygon fill="black" stroke="black" points="3334.5,-17318.65 3331,-17308.65 3327.5,-17318.65 3334.5,-17318.65"/>
</g>
<!-- gpu5_layer3_attn_reshape -->
<g id="node1357" class="node">
<title>gpu5_layer3_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3392,-17219.55 3270,-17219.55 3270,-17167.55 3392,-17167.55 3392,-17219.55"/>
<text text-anchor="middle" x="3331" y="-17207.55" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3331" y="-17196.55" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-17185.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-17174.55" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer3_attn&#45;&gt;gpu5_layer3_attn_reshape -->
<g id="edge1691" class="edge">
<title>gpu5_layer3_attn&#45;&gt;gpu5_layer3_attn_reshape</title>
<path fill="none" stroke="black" d="M3331,-17256.38C3331,-17248.09 3331,-17238.7 3331,-17229.8"/>
<polygon fill="black" stroke="black" points="3334.5,-17229.65 3331,-17219.65 3327.5,-17229.65 3334.5,-17229.65"/>
</g>
<!-- gpu5_layer3_attn_out -->
<g id="node1356" class="node">
<title>gpu5_layer3_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3392,-17130.55 3270,-17130.55 3270,-17078.55 3392,-17078.55 3392,-17130.55"/>
<text text-anchor="middle" x="3331" y="-17118.55" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3331" y="-17107.55" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-17096.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-17085.55" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer3_kv_update -->
<g id="node1358" class="node">
<title>gpu5_layer3_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3331" cy="-17004.78" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3331" y="-17018.78" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3331" y="-17007.78" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-16996.78" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-16985.78" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer3_attn_out&#45;&gt;gpu5_layer3_kv_update -->
<g id="edge1693" class="edge">
<title>gpu5_layer3_attn_out&#45;&gt;gpu5_layer3_kv_update</title>
<path fill="none" stroke="black" d="M3331,-17078.37C3331,-17070.23 3331,-17060.93 3331,-17051.77"/>
<polygon fill="black" stroke="black" points="3334.5,-17051.56 3331,-17041.56 3327.5,-17051.56 3334.5,-17051.56"/>
</g>
<!-- gpu5_layer3_attn_reshape&#45;&gt;gpu5_layer3_attn_out -->
<g id="edge1692" class="edge">
<title>gpu5_layer3_attn_reshape&#45;&gt;gpu5_layer3_attn_out</title>
<path fill="none" stroke="black" d="M3331,-17167.38C3331,-17159.09 3331,-17149.7 3331,-17140.8"/>
<polygon fill="black" stroke="black" points="3334.5,-17140.65 3331,-17130.65 3327.5,-17140.65 3334.5,-17140.65"/>
</g>
<!-- gpu5_layer3_res1 -->
<g id="node1359" class="node">
<title>gpu5_layer3_res1</title>
<polygon fill="lightblue" stroke="black" points="3392,-16931.01 3270,-16931.01 3270,-16879.01 3392,-16879.01 3392,-16931.01"/>
<text text-anchor="middle" x="3331" y="-16919.01" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3331" y="-16908.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-16897.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-16886.01" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer3_kv_update&#45;&gt;gpu5_layer3_res1 -->
<g id="edge1694" class="edge">
<title>gpu5_layer3_kv_update&#45;&gt;gpu5_layer3_res1</title>
<path fill="none" stroke="black" d="M3331,-16967.93C3331,-16959.25 3331,-16949.98 3331,-16941.32"/>
<polygon fill="black" stroke="black" points="3334.5,-16941.15 3331,-16931.15 3327.5,-16941.15 3334.5,-16941.15"/>
</g>
<!-- gpu5_layer3_ln2 -->
<g id="node1360" class="node">
<title>gpu5_layer3_ln2</title>
<polygon fill="lightblue" stroke="black" points="3392,-16842.01 3270,-16842.01 3270,-16790.01 3392,-16790.01 3392,-16842.01"/>
<text text-anchor="middle" x="3331" y="-16830.01" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3331" y="-16819.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-16808.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-16797.01" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer3_res1&#45;&gt;gpu5_layer3_ln2 -->
<g id="edge1695" class="edge">
<title>gpu5_layer3_res1&#45;&gt;gpu5_layer3_ln2</title>
<path fill="none" stroke="black" d="M3331,-16878.84C3331,-16870.55 3331,-16861.16 3331,-16852.26"/>
<polygon fill="black" stroke="black" points="3334.5,-16852.12 3331,-16842.12 3327.5,-16852.12 3334.5,-16852.12"/>
</g>
<!-- gpu5_layer3_routing -->
<g id="node1361" class="node">
<title>gpu5_layer3_routing</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-16753.01 3256.29,-16753.01 3204.53,-16627.01 3405.71,-16627.01 3457.47,-16753.01"/>
<text text-anchor="middle" x="3331" y="-16709.51" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3331" y="-16698.51" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-16687.51" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-16676.51" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3331" y="-16665.51" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer3_ln2&#45;&gt;gpu5_layer3_routing -->
<g id="edge1696" class="edge">
<title>gpu5_layer3_ln2&#45;&gt;gpu5_layer3_routing</title>
<path fill="none" stroke="black" d="M3331,-16789.92C3331,-16781.98 3331,-16772.79 3331,-16763.26"/>
<polygon fill="black" stroke="black" points="3334.5,-16763.24 3331,-16753.24 3327.5,-16763.24 3334.5,-16763.24"/>
</g>
<!-- gpu5_layer3_expert0 -->
<g id="node1362" class="node">
<title>gpu5_layer3_expert0</title>
<polygon fill="lightblue" stroke="black" points="3112,-16581.01 2990,-16581.01 2990,-16529.01 3112,-16529.01 3112,-16581.01"/>
<text text-anchor="middle" x="3051" y="-16569.01" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3051" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer3_routing&#45;&gt;gpu5_layer3_expert0 -->
<g id="edge1683" class="edge">
<title>gpu5_layer3_routing&#45;&gt;gpu5_layer3_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3205.33,-16629.32C3173.34,-16614.12 3140.34,-16598.44 3113.11,-16585.51"/>
<polygon fill="black" stroke="black" points="3114.26,-16582.18 3103.73,-16581.05 3111.26,-16588.51 3114.26,-16582.18"/>
<text text-anchor="middle" x="3186.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer3_expert1 -->
<g id="node1363" class="node">
<title>gpu5_layer3_expert1</title>
<polygon fill="lightblue" stroke="black" points="3252,-16581.01 3130,-16581.01 3130,-16529.01 3252,-16529.01 3252,-16581.01"/>
<text text-anchor="middle" x="3191" y="-16569.01" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3191" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer3_routing&#45;&gt;gpu5_layer3_expert1 -->
<g id="edge1684" class="edge">
<title>gpu5_layer3_routing&#45;&gt;gpu5_layer3_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3265.51,-16626.79C3251.48,-16613.47 3237.21,-16599.91 3224.97,-16588.28"/>
<polygon fill="black" stroke="black" points="3227.29,-16585.65 3217.63,-16581.3 3222.46,-16590.73 3227.29,-16585.65"/>
<text text-anchor="middle" x="3273.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer3_expert2 -->
<g id="node1364" class="node">
<title>gpu5_layer3_expert2</title>
<polygon fill="lightblue" stroke="black" points="3392,-16581.01 3270,-16581.01 3270,-16529.01 3392,-16529.01 3392,-16581.01"/>
<text text-anchor="middle" x="3331" y="-16569.01" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3331" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer3_routing&#45;&gt;gpu5_layer3_expert2 -->
<g id="edge1685" class="edge">
<title>gpu5_layer3_routing&#45;&gt;gpu5_layer3_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3331,-16626.79C3331,-16614.72 3331,-16602.47 3331,-16591.62"/>
<polygon fill="black" stroke="black" points="3334.5,-16591.3 3331,-16581.3 3327.5,-16591.3 3334.5,-16591.3"/>
<text text-anchor="middle" x="3360.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer3_expert3 -->
<g id="node1365" class="node">
<title>gpu5_layer3_expert3</title>
<polygon fill="lightblue" stroke="black" points="3532,-16581.01 3410,-16581.01 3410,-16529.01 3532,-16529.01 3532,-16581.01"/>
<text text-anchor="middle" x="3471" y="-16569.01" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="3471" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer3_routing&#45;&gt;gpu5_layer3_expert3 -->
<g id="edge1686" class="edge">
<title>gpu5_layer3_routing&#45;&gt;gpu5_layer3_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3396.49,-16626.79C3410.52,-16613.47 3424.79,-16599.91 3437.03,-16588.28"/>
<polygon fill="black" stroke="black" points="3439.54,-16590.73 3444.37,-16581.3 3434.71,-16585.65 3439.54,-16590.73"/>
<text text-anchor="middle" x="3454.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer3_expert_agg -->
<g id="node1366" class="node">
<title>gpu5_layer3_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-16492.01 3256.29,-16492.01 3204.53,-16388.01 3405.71,-16388.01 3457.47,-16492.01"/>
<text text-anchor="middle" x="3331" y="-16454.01" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3331" y="-16443.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-16432.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-16421.01" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer3_routing&#45;&gt;gpu5_layer3_expert_agg -->
<g id="edge1701" class="edge">
<title>gpu5_layer3_routing&#45;&gt;gpu5_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M3420.22,-16662.09C3493.96,-16634.93 3580.6,-16588.54 3541,-16529.01 3520.44,-16498.1 3486.7,-16478.02 3452.22,-16464.99"/>
<polygon fill="black" stroke="black" points="3453.08,-16461.58 3442.48,-16461.5 3450.71,-16468.17 3453.08,-16461.58"/>
</g>
<!-- gpu5_layer3_expert0&#45;&gt;gpu5_layer3_expert_agg -->
<g id="edge1697" class="edge">
<title>gpu5_layer3_expert0&#45;&gt;gpu5_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M3112.1,-16529.35C3148.98,-16514.47 3196.7,-16495.21 3238.16,-16478.47"/>
<polygon fill="black" stroke="black" points="3239.5,-16481.71 3247.46,-16474.72 3236.88,-16475.22 3239.5,-16481.71"/>
</g>
<!-- gpu5_layer3_expert1&#45;&gt;gpu5_layer3_expert_agg -->
<g id="edge1698" class="edge">
<title>gpu5_layer3_expert1&#45;&gt;gpu5_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M3222.07,-16528.93C3233.32,-16519.85 3246.53,-16509.19 3259.8,-16498.48"/>
<polygon fill="black" stroke="black" points="3262.02,-16501.18 3267.6,-16492.18 3257.62,-16495.74 3262.02,-16501.18"/>
</g>
<!-- gpu5_layer3_expert2&#45;&gt;gpu5_layer3_expert_agg -->
<g id="edge1699" class="edge">
<title>gpu5_layer3_expert2&#45;&gt;gpu5_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M3331,-16528.93C3331,-16521 3331,-16511.87 3331,-16502.55"/>
<polygon fill="black" stroke="black" points="3334.5,-16502.41 3331,-16492.41 3327.5,-16502.41 3334.5,-16502.41"/>
</g>
<!-- gpu5_layer3_expert3&#45;&gt;gpu5_layer3_expert_agg -->
<g id="edge1700" class="edge">
<title>gpu5_layer3_expert3&#45;&gt;gpu5_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M3439.93,-16528.93C3428.68,-16519.85 3415.47,-16509.19 3402.2,-16498.48"/>
<polygon fill="black" stroke="black" points="3404.38,-16495.74 3394.4,-16492.18 3399.98,-16501.18 3404.38,-16495.74"/>
</g>
<!-- gpu5_layer3_res2 -->
<g id="node1367" class="node">
<title>gpu5_layer3_res2</title>
<polygon fill="lightblue" stroke="black" points="3392,-16351.01 3270,-16351.01 3270,-16299.01 3392,-16299.01 3392,-16351.01"/>
<text text-anchor="middle" x="3331" y="-16339.01" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3331" y="-16328.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-16317.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-16306.01" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer3_expert_agg&#45;&gt;gpu5_layer3_res2 -->
<g id="edge1702" class="edge">
<title>gpu5_layer3_expert_agg&#45;&gt;gpu5_layer3_res2</title>
<path fill="none" stroke="black" d="M3331,-16387.8C3331,-16378.85 3331,-16369.72 3331,-16361.32"/>
<polygon fill="black" stroke="black" points="3334.5,-16361.14 3331,-16351.14 3327.5,-16361.14 3334.5,-16361.14"/>
</g>
<!-- gpu5_layer4_ln1 -->
<g id="node1368" class="node">
<title>gpu5_layer4_ln1</title>
<polygon fill="lightblue" stroke="black" points="3392,-16262.01 3270,-16262.01 3270,-16210.01 3392,-16210.01 3392,-16262.01"/>
<text text-anchor="middle" x="3331" y="-16250.01" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3331" y="-16239.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-16228.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-16217.01" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer3_res2&#45;&gt;gpu5_layer4_ln1 -->
<g id="edge1707" class="edge">
<title>gpu5_layer3_res2&#45;&gt;gpu5_layer4_ln1</title>
<path fill="none" stroke="black" d="M3331,-16298.84C3331,-16290.55 3331,-16281.16 3331,-16272.26"/>
<polygon fill="black" stroke="black" points="3334.5,-16272.12 3331,-16262.12 3327.5,-16272.12 3334.5,-16272.12"/>
</g>
<!-- gpu5_layer4_qkv -->
<g id="node1369" class="node">
<title>gpu5_layer4_qkv</title>
<polygon fill="lightblue" stroke="black" points="3392,-16173.01 3270,-16173.01 3270,-16121.01 3392,-16121.01 3392,-16173.01"/>
<text text-anchor="middle" x="3331" y="-16161.01" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3331" y="-16150.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-16139.01" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-16128.01" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer4_ln1&#45;&gt;gpu5_layer4_qkv -->
<g id="edge1708" class="edge">
<title>gpu5_layer4_ln1&#45;&gt;gpu5_layer4_qkv</title>
<path fill="none" stroke="black" d="M3331,-16209.84C3331,-16201.55 3331,-16192.16 3331,-16183.26"/>
<polygon fill="black" stroke="black" points="3334.5,-16183.12 3331,-16173.12 3327.5,-16183.12 3334.5,-16183.12"/>
</g>
<!-- gpu5_layer4_reshape -->
<g id="node1370" class="node">
<title>gpu5_layer4_reshape</title>
<polygon fill="lightblue" stroke="black" points="3395,-16084.01 3267,-16084.01 3267,-16032.01 3395,-16032.01 3395,-16084.01"/>
<text text-anchor="middle" x="3331" y="-16072.01" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3331" y="-16061.01" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-16050.01" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-16039.01" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer4_qkv&#45;&gt;gpu5_layer4_reshape -->
<g id="edge1709" class="edge">
<title>gpu5_layer4_qkv&#45;&gt;gpu5_layer4_reshape</title>
<path fill="none" stroke="black" d="M3331,-16120.84C3331,-16112.55 3331,-16103.16 3331,-16094.26"/>
<polygon fill="black" stroke="black" points="3334.5,-16094.12 3331,-16084.12 3327.5,-16094.12 3334.5,-16094.12"/>
</g>
<!-- gpu5_layer4_attn -->
<g id="node1371" class="node">
<title>gpu5_layer4_attn</title>
<polygon fill="lightblue" stroke="black" points="3395,-15995.01 3267,-15995.01 3267,-15943.01 3395,-15943.01 3395,-15995.01"/>
<text text-anchor="middle" x="3331" y="-15983.01" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3331" y="-15972.01" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-15961.01" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-15950.01" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer4_reshape&#45;&gt;gpu5_layer4_attn -->
<g id="edge1710" class="edge">
<title>gpu5_layer4_reshape&#45;&gt;gpu5_layer4_attn</title>
<path fill="none" stroke="black" d="M3331,-16031.84C3331,-16023.55 3331,-16014.16 3331,-16005.26"/>
<polygon fill="black" stroke="black" points="3334.5,-16005.12 3331,-15995.12 3327.5,-16005.12 3334.5,-16005.12"/>
</g>
<!-- gpu5_layer4_attn_reshape -->
<g id="node1373" class="node">
<title>gpu5_layer4_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3392,-15906.01 3270,-15906.01 3270,-15854.01 3392,-15854.01 3392,-15906.01"/>
<text text-anchor="middle" x="3331" y="-15894.01" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3331" y="-15883.01" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-15872.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-15861.01" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer4_attn&#45;&gt;gpu5_layer4_attn_reshape -->
<g id="edge1711" class="edge">
<title>gpu5_layer4_attn&#45;&gt;gpu5_layer4_attn_reshape</title>
<path fill="none" stroke="black" d="M3331,-15942.84C3331,-15934.55 3331,-15925.16 3331,-15916.26"/>
<polygon fill="black" stroke="black" points="3334.5,-15916.12 3331,-15906.12 3327.5,-15916.12 3334.5,-15916.12"/>
</g>
<!-- gpu5_layer4_attn_out -->
<g id="node1372" class="node">
<title>gpu5_layer4_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3392,-15817.01 3270,-15817.01 3270,-15765.01 3392,-15765.01 3392,-15817.01"/>
<text text-anchor="middle" x="3331" y="-15805.01" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3331" y="-15794.01" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-15783.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-15772.01" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer4_kv_update -->
<g id="node1374" class="node">
<title>gpu5_layer4_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3331" cy="-15691.24" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3331" y="-15705.24" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3331" y="-15694.24" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-15683.24" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-15672.24" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer4_attn_out&#45;&gt;gpu5_layer4_kv_update -->
<g id="edge1713" class="edge">
<title>gpu5_layer4_attn_out&#45;&gt;gpu5_layer4_kv_update</title>
<path fill="none" stroke="black" d="M3331,-15764.83C3331,-15756.69 3331,-15747.39 3331,-15738.23"/>
<polygon fill="black" stroke="black" points="3334.5,-15738.02 3331,-15728.02 3327.5,-15738.02 3334.5,-15738.02"/>
</g>
<!-- gpu5_layer4_attn_reshape&#45;&gt;gpu5_layer4_attn_out -->
<g id="edge1712" class="edge">
<title>gpu5_layer4_attn_reshape&#45;&gt;gpu5_layer4_attn_out</title>
<path fill="none" stroke="black" d="M3331,-15853.84C3331,-15845.55 3331,-15836.16 3331,-15827.26"/>
<polygon fill="black" stroke="black" points="3334.5,-15827.12 3331,-15817.12 3327.5,-15827.12 3334.5,-15827.12"/>
</g>
<!-- gpu5_layer4_res1 -->
<g id="node1375" class="node">
<title>gpu5_layer4_res1</title>
<polygon fill="lightblue" stroke="black" points="3392,-15617.47 3270,-15617.47 3270,-15565.47 3392,-15565.47 3392,-15617.47"/>
<text text-anchor="middle" x="3331" y="-15605.47" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3331" y="-15594.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-15583.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-15572.47" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer4_kv_update&#45;&gt;gpu5_layer4_res1 -->
<g id="edge1714" class="edge">
<title>gpu5_layer4_kv_update&#45;&gt;gpu5_layer4_res1</title>
<path fill="none" stroke="black" d="M3331,-15654.39C3331,-15645.71 3331,-15636.44 3331,-15627.78"/>
<polygon fill="black" stroke="black" points="3334.5,-15627.62 3331,-15617.62 3327.5,-15627.62 3334.5,-15627.62"/>
</g>
<!-- gpu5_layer4_ln2 -->
<g id="node1376" class="node">
<title>gpu5_layer4_ln2</title>
<polygon fill="lightblue" stroke="black" points="3392,-15528.47 3270,-15528.47 3270,-15476.47 3392,-15476.47 3392,-15528.47"/>
<text text-anchor="middle" x="3331" y="-15516.47" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3331" y="-15505.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-15494.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-15483.47" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer4_res1&#45;&gt;gpu5_layer4_ln2 -->
<g id="edge1715" class="edge">
<title>gpu5_layer4_res1&#45;&gt;gpu5_layer4_ln2</title>
<path fill="none" stroke="black" d="M3331,-15565.31C3331,-15557.01 3331,-15547.62 3331,-15538.72"/>
<polygon fill="black" stroke="black" points="3334.5,-15538.58 3331,-15528.58 3327.5,-15538.58 3334.5,-15538.58"/>
</g>
<!-- gpu5_layer4_routing -->
<g id="node1377" class="node">
<title>gpu5_layer4_routing</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-15439.47 3256.29,-15439.47 3204.53,-15313.47 3405.71,-15313.47 3457.47,-15439.47"/>
<text text-anchor="middle" x="3331" y="-15395.97" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3331" y="-15384.97" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-15373.97" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-15362.97" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3331" y="-15351.97" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer4_ln2&#45;&gt;gpu5_layer4_routing -->
<g id="edge1716" class="edge">
<title>gpu5_layer4_ln2&#45;&gt;gpu5_layer4_routing</title>
<path fill="none" stroke="black" d="M3331,-15476.38C3331,-15468.45 3331,-15459.25 3331,-15449.72"/>
<polygon fill="black" stroke="black" points="3334.5,-15449.7 3331,-15439.7 3327.5,-15449.7 3334.5,-15449.7"/>
</g>
<!-- gpu5_layer4_expert0 -->
<g id="node1378" class="node">
<title>gpu5_layer4_expert0</title>
<polygon fill="lightblue" stroke="black" points="3112,-15267.47 2990,-15267.47 2990,-15215.47 3112,-15215.47 3112,-15267.47"/>
<text text-anchor="middle" x="3051" y="-15255.47" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3051" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer4_routing&#45;&gt;gpu5_layer4_expert0 -->
<g id="edge1703" class="edge">
<title>gpu5_layer4_routing&#45;&gt;gpu5_layer4_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3205.33,-15315.78C3173.34,-15300.58 3140.34,-15284.91 3113.11,-15271.97"/>
<polygon fill="black" stroke="black" points="3114.26,-15268.64 3103.73,-15267.51 3111.26,-15274.97 3114.26,-15268.64"/>
<text text-anchor="middle" x="3186.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer4_expert1 -->
<g id="node1379" class="node">
<title>gpu5_layer4_expert1</title>
<polygon fill="lightblue" stroke="black" points="3252,-15267.47 3130,-15267.47 3130,-15215.47 3252,-15215.47 3252,-15267.47"/>
<text text-anchor="middle" x="3191" y="-15255.47" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3191" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer4_routing&#45;&gt;gpu5_layer4_expert1 -->
<g id="edge1704" class="edge">
<title>gpu5_layer4_routing&#45;&gt;gpu5_layer4_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3265.51,-15313.25C3251.48,-15299.93 3237.21,-15286.37 3224.97,-15274.74"/>
<polygon fill="black" stroke="black" points="3227.29,-15272.11 3217.63,-15267.76 3222.46,-15277.19 3227.29,-15272.11"/>
<text text-anchor="middle" x="3273.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer4_expert2 -->
<g id="node1380" class="node">
<title>gpu5_layer4_expert2</title>
<polygon fill="lightblue" stroke="black" points="3392,-15267.47 3270,-15267.47 3270,-15215.47 3392,-15215.47 3392,-15267.47"/>
<text text-anchor="middle" x="3331" y="-15255.47" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3331" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer4_routing&#45;&gt;gpu5_layer4_expert2 -->
<g id="edge1705" class="edge">
<title>gpu5_layer4_routing&#45;&gt;gpu5_layer4_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3331,-15313.25C3331,-15301.18 3331,-15288.93 3331,-15278.08"/>
<polygon fill="black" stroke="black" points="3334.5,-15277.76 3331,-15267.76 3327.5,-15277.76 3334.5,-15277.76"/>
<text text-anchor="middle" x="3360.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer4_expert3 -->
<g id="node1381" class="node">
<title>gpu5_layer4_expert3</title>
<polygon fill="lightblue" stroke="black" points="3532,-15267.47 3410,-15267.47 3410,-15215.47 3532,-15215.47 3532,-15267.47"/>
<text text-anchor="middle" x="3471" y="-15255.47" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="3471" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer4_routing&#45;&gt;gpu5_layer4_expert3 -->
<g id="edge1706" class="edge">
<title>gpu5_layer4_routing&#45;&gt;gpu5_layer4_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3396.49,-15313.25C3410.52,-15299.93 3424.79,-15286.37 3437.03,-15274.74"/>
<polygon fill="black" stroke="black" points="3439.54,-15277.19 3444.37,-15267.76 3434.71,-15272.11 3439.54,-15277.19"/>
<text text-anchor="middle" x="3454.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer4_expert_agg -->
<g id="node1382" class="node">
<title>gpu5_layer4_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-15178.47 3256.29,-15178.47 3204.53,-15074.47 3405.71,-15074.47 3457.47,-15178.47"/>
<text text-anchor="middle" x="3331" y="-15140.47" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3331" y="-15129.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-15118.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-15107.47" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer4_routing&#45;&gt;gpu5_layer4_expert_agg -->
<g id="edge1721" class="edge">
<title>gpu5_layer4_routing&#45;&gt;gpu5_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M3420.22,-15348.55C3493.96,-15321.39 3580.6,-15275 3541,-15215.47 3520.44,-15184.56 3486.7,-15164.48 3452.22,-15151.45"/>
<polygon fill="black" stroke="black" points="3453.08,-15148.04 3442.48,-15147.96 3450.71,-15154.63 3453.08,-15148.04"/>
</g>
<!-- gpu5_layer4_expert0&#45;&gt;gpu5_layer4_expert_agg -->
<g id="edge1717" class="edge">
<title>gpu5_layer4_expert0&#45;&gt;gpu5_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M3112.1,-15215.81C3148.98,-15200.93 3196.7,-15181.67 3238.16,-15164.94"/>
<polygon fill="black" stroke="black" points="3239.5,-15168.17 3247.46,-15161.18 3236.88,-15161.68 3239.5,-15168.17"/>
</g>
<!-- gpu5_layer4_expert1&#45;&gt;gpu5_layer4_expert_agg -->
<g id="edge1718" class="edge">
<title>gpu5_layer4_expert1&#45;&gt;gpu5_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M3222.07,-15215.39C3233.32,-15206.31 3246.53,-15195.65 3259.8,-15184.94"/>
<polygon fill="black" stroke="black" points="3262.02,-15187.64 3267.6,-15178.64 3257.62,-15182.2 3262.02,-15187.64"/>
</g>
<!-- gpu5_layer4_expert2&#45;&gt;gpu5_layer4_expert_agg -->
<g id="edge1719" class="edge">
<title>gpu5_layer4_expert2&#45;&gt;gpu5_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M3331,-15215.39C3331,-15207.46 3331,-15198.33 3331,-15189.01"/>
<polygon fill="black" stroke="black" points="3334.5,-15188.87 3331,-15178.87 3327.5,-15188.87 3334.5,-15188.87"/>
</g>
<!-- gpu5_layer4_expert3&#45;&gt;gpu5_layer4_expert_agg -->
<g id="edge1720" class="edge">
<title>gpu5_layer4_expert3&#45;&gt;gpu5_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M3439.93,-15215.39C3428.68,-15206.31 3415.47,-15195.65 3402.2,-15184.94"/>
<polygon fill="black" stroke="black" points="3404.38,-15182.2 3394.4,-15178.64 3399.98,-15187.64 3404.38,-15182.2"/>
</g>
<!-- gpu5_layer4_res2 -->
<g id="node1383" class="node">
<title>gpu5_layer4_res2</title>
<polygon fill="lightblue" stroke="black" points="3392,-15037.47 3270,-15037.47 3270,-14985.47 3392,-14985.47 3392,-15037.47"/>
<text text-anchor="middle" x="3331" y="-15025.47" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3331" y="-15014.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-15003.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-14992.47" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer4_expert_agg&#45;&gt;gpu5_layer4_res2 -->
<g id="edge1722" class="edge">
<title>gpu5_layer4_expert_agg&#45;&gt;gpu5_layer4_res2</title>
<path fill="none" stroke="black" d="M3331,-15074.26C3331,-15065.31 3331,-15056.18 3331,-15047.78"/>
<polygon fill="black" stroke="black" points="3334.5,-15047.6 3331,-15037.6 3327.5,-15047.6 3334.5,-15047.6"/>
</g>
<!-- gpu5_layer5_ln1 -->
<g id="node1384" class="node">
<title>gpu5_layer5_ln1</title>
<polygon fill="lightblue" stroke="black" points="3392,-14948.47 3270,-14948.47 3270,-14896.47 3392,-14896.47 3392,-14948.47"/>
<text text-anchor="middle" x="3331" y="-14936.47" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3331" y="-14925.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-14914.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-14903.47" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer4_res2&#45;&gt;gpu5_layer5_ln1 -->
<g id="edge1727" class="edge">
<title>gpu5_layer4_res2&#45;&gt;gpu5_layer5_ln1</title>
<path fill="none" stroke="black" d="M3331,-14985.31C3331,-14977.01 3331,-14967.62 3331,-14958.72"/>
<polygon fill="black" stroke="black" points="3334.5,-14958.58 3331,-14948.58 3327.5,-14958.58 3334.5,-14958.58"/>
</g>
<!-- gpu5_layer5_qkv -->
<g id="node1385" class="node">
<title>gpu5_layer5_qkv</title>
<polygon fill="lightblue" stroke="black" points="3392,-14859.47 3270,-14859.47 3270,-14807.47 3392,-14807.47 3392,-14859.47"/>
<text text-anchor="middle" x="3331" y="-14847.47" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3331" y="-14836.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-14825.47" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-14814.47" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer5_ln1&#45;&gt;gpu5_layer5_qkv -->
<g id="edge1728" class="edge">
<title>gpu5_layer5_ln1&#45;&gt;gpu5_layer5_qkv</title>
<path fill="none" stroke="black" d="M3331,-14896.31C3331,-14888.01 3331,-14878.62 3331,-14869.72"/>
<polygon fill="black" stroke="black" points="3334.5,-14869.58 3331,-14859.58 3327.5,-14869.58 3334.5,-14869.58"/>
</g>
<!-- gpu5_layer5_reshape -->
<g id="node1386" class="node">
<title>gpu5_layer5_reshape</title>
<polygon fill="lightblue" stroke="black" points="3395,-14770.47 3267,-14770.47 3267,-14718.47 3395,-14718.47 3395,-14770.47"/>
<text text-anchor="middle" x="3331" y="-14758.47" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3331" y="-14747.47" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-14736.47" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-14725.47" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer5_qkv&#45;&gt;gpu5_layer5_reshape -->
<g id="edge1729" class="edge">
<title>gpu5_layer5_qkv&#45;&gt;gpu5_layer5_reshape</title>
<path fill="none" stroke="black" d="M3331,-14807.31C3331,-14799.01 3331,-14789.62 3331,-14780.72"/>
<polygon fill="black" stroke="black" points="3334.5,-14780.58 3331,-14770.58 3327.5,-14780.58 3334.5,-14780.58"/>
</g>
<!-- gpu5_layer5_attn -->
<g id="node1387" class="node">
<title>gpu5_layer5_attn</title>
<polygon fill="lightblue" stroke="black" points="3395,-14681.47 3267,-14681.47 3267,-14629.47 3395,-14629.47 3395,-14681.47"/>
<text text-anchor="middle" x="3331" y="-14669.47" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3331" y="-14658.47" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-14647.47" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-14636.47" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer5_reshape&#45;&gt;gpu5_layer5_attn -->
<g id="edge1730" class="edge">
<title>gpu5_layer5_reshape&#45;&gt;gpu5_layer5_attn</title>
<path fill="none" stroke="black" d="M3331,-14718.31C3331,-14710.01 3331,-14700.62 3331,-14691.72"/>
<polygon fill="black" stroke="black" points="3334.5,-14691.58 3331,-14681.58 3327.5,-14691.58 3334.5,-14691.58"/>
</g>
<!-- gpu5_layer5_attn_reshape -->
<g id="node1389" class="node">
<title>gpu5_layer5_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3392,-14592.47 3270,-14592.47 3270,-14540.47 3392,-14540.47 3392,-14592.47"/>
<text text-anchor="middle" x="3331" y="-14580.47" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3331" y="-14569.47" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-14558.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-14547.47" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer5_attn&#45;&gt;gpu5_layer5_attn_reshape -->
<g id="edge1731" class="edge">
<title>gpu5_layer5_attn&#45;&gt;gpu5_layer5_attn_reshape</title>
<path fill="none" stroke="black" d="M3331,-14629.31C3331,-14621.01 3331,-14611.62 3331,-14602.72"/>
<polygon fill="black" stroke="black" points="3334.5,-14602.58 3331,-14592.58 3327.5,-14602.58 3334.5,-14602.58"/>
</g>
<!-- gpu5_layer5_attn_out -->
<g id="node1388" class="node">
<title>gpu5_layer5_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3392,-14503.47 3270,-14503.47 3270,-14451.47 3392,-14451.47 3392,-14503.47"/>
<text text-anchor="middle" x="3331" y="-14491.47" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3331" y="-14480.47" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-14469.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-14458.47" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer5_kv_update -->
<g id="node1390" class="node">
<title>gpu5_layer5_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3331" cy="-14377.7" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3331" y="-14391.7" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3331" y="-14380.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-14369.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-14358.7" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer5_attn_out&#45;&gt;gpu5_layer5_kv_update -->
<g id="edge1733" class="edge">
<title>gpu5_layer5_attn_out&#45;&gt;gpu5_layer5_kv_update</title>
<path fill="none" stroke="black" d="M3331,-14451.29C3331,-14443.15 3331,-14433.86 3331,-14424.69"/>
<polygon fill="black" stroke="black" points="3334.5,-14424.48 3331,-14414.48 3327.5,-14424.48 3334.5,-14424.48"/>
</g>
<!-- gpu5_layer5_attn_reshape&#45;&gt;gpu5_layer5_attn_out -->
<g id="edge1732" class="edge">
<title>gpu5_layer5_attn_reshape&#45;&gt;gpu5_layer5_attn_out</title>
<path fill="none" stroke="black" d="M3331,-14540.31C3331,-14532.01 3331,-14522.62 3331,-14513.72"/>
<polygon fill="black" stroke="black" points="3334.5,-14513.58 3331,-14503.58 3327.5,-14513.58 3334.5,-14513.58"/>
</g>
<!-- gpu5_layer5_res1 -->
<g id="node1391" class="node">
<title>gpu5_layer5_res1</title>
<polygon fill="lightblue" stroke="black" points="3392,-14303.93 3270,-14303.93 3270,-14251.93 3392,-14251.93 3392,-14303.93"/>
<text text-anchor="middle" x="3331" y="-14291.93" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3331" y="-14280.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-14269.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-14258.93" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer5_kv_update&#45;&gt;gpu5_layer5_res1 -->
<g id="edge1734" class="edge">
<title>gpu5_layer5_kv_update&#45;&gt;gpu5_layer5_res1</title>
<path fill="none" stroke="black" d="M3331,-14340.85C3331,-14332.17 3331,-14322.9 3331,-14314.25"/>
<polygon fill="black" stroke="black" points="3334.5,-14314.08 3331,-14304.08 3327.5,-14314.08 3334.5,-14314.08"/>
</g>
<!-- gpu5_layer5_ln2 -->
<g id="node1392" class="node">
<title>gpu5_layer5_ln2</title>
<polygon fill="lightblue" stroke="black" points="3392,-14214.93 3270,-14214.93 3270,-14162.93 3392,-14162.93 3392,-14214.93"/>
<text text-anchor="middle" x="3331" y="-14202.93" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3331" y="-14191.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-14180.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-14169.93" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer5_res1&#45;&gt;gpu5_layer5_ln2 -->
<g id="edge1735" class="edge">
<title>gpu5_layer5_res1&#45;&gt;gpu5_layer5_ln2</title>
<path fill="none" stroke="black" d="M3331,-14251.77C3331,-14243.47 3331,-14234.08 3331,-14225.18"/>
<polygon fill="black" stroke="black" points="3334.5,-14225.04 3331,-14215.04 3327.5,-14225.04 3334.5,-14225.04"/>
</g>
<!-- gpu5_layer5_routing -->
<g id="node1393" class="node">
<title>gpu5_layer5_routing</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-14125.93 3256.29,-14125.93 3204.53,-13999.93 3405.71,-13999.93 3457.47,-14125.93"/>
<text text-anchor="middle" x="3331" y="-14082.43" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3331" y="-14071.43" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-14060.43" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-14049.43" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3331" y="-14038.43" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer5_ln2&#45;&gt;gpu5_layer5_routing -->
<g id="edge1736" class="edge">
<title>gpu5_layer5_ln2&#45;&gt;gpu5_layer5_routing</title>
<path fill="none" stroke="black" d="M3331,-14162.84C3331,-14154.91 3331,-14145.71 3331,-14136.18"/>
<polygon fill="black" stroke="black" points="3334.5,-14136.17 3331,-14126.17 3327.5,-14136.17 3334.5,-14136.17"/>
</g>
<!-- gpu5_layer5_expert0 -->
<g id="node1394" class="node">
<title>gpu5_layer5_expert0</title>
<polygon fill="lightblue" stroke="black" points="3112,-13953.93 2990,-13953.93 2990,-13901.93 3112,-13901.93 3112,-13953.93"/>
<text text-anchor="middle" x="3051" y="-13941.93" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3051" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer5_routing&#45;&gt;gpu5_layer5_expert0 -->
<g id="edge1723" class="edge">
<title>gpu5_layer5_routing&#45;&gt;gpu5_layer5_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3205.33,-14002.24C3173.34,-13987.04 3140.34,-13971.37 3113.11,-13958.43"/>
<polygon fill="black" stroke="black" points="3114.26,-13955.1 3103.73,-13953.98 3111.26,-13961.43 3114.26,-13955.1"/>
<text text-anchor="middle" x="3186.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer5_expert1 -->
<g id="node1395" class="node">
<title>gpu5_layer5_expert1</title>
<polygon fill="lightblue" stroke="black" points="3252,-13953.93 3130,-13953.93 3130,-13901.93 3252,-13901.93 3252,-13953.93"/>
<text text-anchor="middle" x="3191" y="-13941.93" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3191" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer5_routing&#45;&gt;gpu5_layer5_expert1 -->
<g id="edge1724" class="edge">
<title>gpu5_layer5_routing&#45;&gt;gpu5_layer5_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3265.51,-13999.71C3251.48,-13986.39 3237.21,-13972.83 3224.97,-13961.2"/>
<polygon fill="black" stroke="black" points="3227.29,-13958.57 3217.63,-13954.22 3222.46,-13963.65 3227.29,-13958.57"/>
<text text-anchor="middle" x="3273.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer5_expert2 -->
<g id="node1396" class="node">
<title>gpu5_layer5_expert2</title>
<polygon fill="lightblue" stroke="black" points="3392,-13953.93 3270,-13953.93 3270,-13901.93 3392,-13901.93 3392,-13953.93"/>
<text text-anchor="middle" x="3331" y="-13941.93" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3331" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer5_routing&#45;&gt;gpu5_layer5_expert2 -->
<g id="edge1725" class="edge">
<title>gpu5_layer5_routing&#45;&gt;gpu5_layer5_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3331,-13999.71C3331,-13987.65 3331,-13975.39 3331,-13964.54"/>
<polygon fill="black" stroke="black" points="3334.5,-13964.22 3331,-13954.22 3327.5,-13964.22 3334.5,-13964.22"/>
<text text-anchor="middle" x="3360.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer5_expert3 -->
<g id="node1397" class="node">
<title>gpu5_layer5_expert3</title>
<polygon fill="lightblue" stroke="black" points="3532,-13953.93 3410,-13953.93 3410,-13901.93 3532,-13901.93 3532,-13953.93"/>
<text text-anchor="middle" x="3471" y="-13941.93" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="3471" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer5_routing&#45;&gt;gpu5_layer5_expert3 -->
<g id="edge1726" class="edge">
<title>gpu5_layer5_routing&#45;&gt;gpu5_layer5_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3396.49,-13999.71C3410.52,-13986.39 3424.79,-13972.83 3437.03,-13961.2"/>
<polygon fill="black" stroke="black" points="3439.54,-13963.65 3444.37,-13954.22 3434.71,-13958.57 3439.54,-13963.65"/>
<text text-anchor="middle" x="3454.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer5_expert_agg -->
<g id="node1398" class="node">
<title>gpu5_layer5_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-13864.93 3256.29,-13864.93 3204.53,-13760.93 3405.71,-13760.93 3457.47,-13864.93"/>
<text text-anchor="middle" x="3331" y="-13826.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3331" y="-13815.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-13804.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-13793.93" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer5_routing&#45;&gt;gpu5_layer5_expert_agg -->
<g id="edge1741" class="edge">
<title>gpu5_layer5_routing&#45;&gt;gpu5_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M3420.22,-14035.01C3493.96,-14007.85 3580.6,-13961.46 3541,-13901.93 3520.44,-13871.02 3486.7,-13850.94 3452.22,-13837.91"/>
<polygon fill="black" stroke="black" points="3453.08,-13834.5 3442.48,-13834.42 3450.71,-13841.09 3453.08,-13834.5"/>
</g>
<!-- gpu5_layer5_expert0&#45;&gt;gpu5_layer5_expert_agg -->
<g id="edge1737" class="edge">
<title>gpu5_layer5_expert0&#45;&gt;gpu5_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M3112.1,-13902.27C3148.98,-13887.39 3196.7,-13868.13 3238.16,-13851.4"/>
<polygon fill="black" stroke="black" points="3239.5,-13854.63 3247.46,-13847.65 3236.88,-13848.14 3239.5,-13854.63"/>
</g>
<!-- gpu5_layer5_expert1&#45;&gt;gpu5_layer5_expert_agg -->
<g id="edge1738" class="edge">
<title>gpu5_layer5_expert1&#45;&gt;gpu5_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M3222.07,-13901.85C3233.32,-13892.77 3246.53,-13882.11 3259.8,-13871.4"/>
<polygon fill="black" stroke="black" points="3262.02,-13874.11 3267.6,-13865.1 3257.62,-13868.66 3262.02,-13874.11"/>
</g>
<!-- gpu5_layer5_expert2&#45;&gt;gpu5_layer5_expert_agg -->
<g id="edge1739" class="edge">
<title>gpu5_layer5_expert2&#45;&gt;gpu5_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M3331,-13901.85C3331,-13893.93 3331,-13884.79 3331,-13875.47"/>
<polygon fill="black" stroke="black" points="3334.5,-13875.33 3331,-13865.33 3327.5,-13875.33 3334.5,-13875.33"/>
</g>
<!-- gpu5_layer5_expert3&#45;&gt;gpu5_layer5_expert_agg -->
<g id="edge1740" class="edge">
<title>gpu5_layer5_expert3&#45;&gt;gpu5_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M3439.93,-13901.85C3428.68,-13892.77 3415.47,-13882.11 3402.2,-13871.4"/>
<polygon fill="black" stroke="black" points="3404.38,-13868.66 3394.4,-13865.1 3399.98,-13874.11 3404.38,-13868.66"/>
</g>
<!-- gpu5_layer5_res2 -->
<g id="node1399" class="node">
<title>gpu5_layer5_res2</title>
<polygon fill="lightblue" stroke="black" points="3392,-13723.93 3270,-13723.93 3270,-13671.93 3392,-13671.93 3392,-13723.93"/>
<text text-anchor="middle" x="3331" y="-13711.93" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3331" y="-13700.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-13689.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-13678.93" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer5_expert_agg&#45;&gt;gpu5_layer5_res2 -->
<g id="edge1742" class="edge">
<title>gpu5_layer5_expert_agg&#45;&gt;gpu5_layer5_res2</title>
<path fill="none" stroke="black" d="M3331,-13760.72C3331,-13751.77 3331,-13742.64 3331,-13734.24"/>
<polygon fill="black" stroke="black" points="3334.5,-13734.06 3331,-13724.06 3327.5,-13734.06 3334.5,-13734.06"/>
</g>
<!-- gpu5_layer6_ln1 -->
<g id="node1400" class="node">
<title>gpu5_layer6_ln1</title>
<polygon fill="lightblue" stroke="black" points="3392,-13634.93 3270,-13634.93 3270,-13582.93 3392,-13582.93 3392,-13634.93"/>
<text text-anchor="middle" x="3331" y="-13622.93" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3331" y="-13611.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-13600.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-13589.93" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer5_res2&#45;&gt;gpu5_layer6_ln1 -->
<g id="edge1747" class="edge">
<title>gpu5_layer5_res2&#45;&gt;gpu5_layer6_ln1</title>
<path fill="none" stroke="black" d="M3331,-13671.77C3331,-13663.47 3331,-13654.08 3331,-13645.18"/>
<polygon fill="black" stroke="black" points="3334.5,-13645.04 3331,-13635.04 3327.5,-13645.04 3334.5,-13645.04"/>
</g>
<!-- gpu5_layer6_qkv -->
<g id="node1401" class="node">
<title>gpu5_layer6_qkv</title>
<polygon fill="lightblue" stroke="black" points="3392,-13545.93 3270,-13545.93 3270,-13493.93 3392,-13493.93 3392,-13545.93"/>
<text text-anchor="middle" x="3331" y="-13533.93" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3331" y="-13522.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-13511.93" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-13500.93" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer6_ln1&#45;&gt;gpu5_layer6_qkv -->
<g id="edge1748" class="edge">
<title>gpu5_layer6_ln1&#45;&gt;gpu5_layer6_qkv</title>
<path fill="none" stroke="black" d="M3331,-13582.77C3331,-13574.47 3331,-13565.08 3331,-13556.18"/>
<polygon fill="black" stroke="black" points="3334.5,-13556.04 3331,-13546.04 3327.5,-13556.04 3334.5,-13556.04"/>
</g>
<!-- gpu5_layer6_reshape -->
<g id="node1402" class="node">
<title>gpu5_layer6_reshape</title>
<polygon fill="lightblue" stroke="black" points="3395,-13456.93 3267,-13456.93 3267,-13404.93 3395,-13404.93 3395,-13456.93"/>
<text text-anchor="middle" x="3331" y="-13444.93" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3331" y="-13433.93" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-13422.93" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-13411.93" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer6_qkv&#45;&gt;gpu5_layer6_reshape -->
<g id="edge1749" class="edge">
<title>gpu5_layer6_qkv&#45;&gt;gpu5_layer6_reshape</title>
<path fill="none" stroke="black" d="M3331,-13493.77C3331,-13485.47 3331,-13476.08 3331,-13467.18"/>
<polygon fill="black" stroke="black" points="3334.5,-13467.04 3331,-13457.04 3327.5,-13467.04 3334.5,-13467.04"/>
</g>
<!-- gpu5_layer6_attn -->
<g id="node1403" class="node">
<title>gpu5_layer6_attn</title>
<polygon fill="lightblue" stroke="black" points="3395,-13367.93 3267,-13367.93 3267,-13315.93 3395,-13315.93 3395,-13367.93"/>
<text text-anchor="middle" x="3331" y="-13355.93" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3331" y="-13344.93" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-13333.93" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-13322.93" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer6_reshape&#45;&gt;gpu5_layer6_attn -->
<g id="edge1750" class="edge">
<title>gpu5_layer6_reshape&#45;&gt;gpu5_layer6_attn</title>
<path fill="none" stroke="black" d="M3331,-13404.77C3331,-13396.47 3331,-13387.08 3331,-13378.18"/>
<polygon fill="black" stroke="black" points="3334.5,-13378.04 3331,-13368.04 3327.5,-13378.04 3334.5,-13378.04"/>
</g>
<!-- gpu5_layer6_attn_reshape -->
<g id="node1405" class="node">
<title>gpu5_layer6_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3392,-13278.93 3270,-13278.93 3270,-13226.93 3392,-13226.93 3392,-13278.93"/>
<text text-anchor="middle" x="3331" y="-13266.93" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3331" y="-13255.93" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-13244.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-13233.93" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer6_attn&#45;&gt;gpu5_layer6_attn_reshape -->
<g id="edge1751" class="edge">
<title>gpu5_layer6_attn&#45;&gt;gpu5_layer6_attn_reshape</title>
<path fill="none" stroke="black" d="M3331,-13315.77C3331,-13307.47 3331,-13298.08 3331,-13289.18"/>
<polygon fill="black" stroke="black" points="3334.5,-13289.04 3331,-13279.04 3327.5,-13289.04 3334.5,-13289.04"/>
</g>
<!-- gpu5_layer6_attn_out -->
<g id="node1404" class="node">
<title>gpu5_layer6_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3392,-13189.93 3270,-13189.93 3270,-13137.93 3392,-13137.93 3392,-13189.93"/>
<text text-anchor="middle" x="3331" y="-13177.93" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3331" y="-13166.93" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-13155.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-13144.93" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer6_kv_update -->
<g id="node1406" class="node">
<title>gpu5_layer6_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3331" cy="-13064.16" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3331" y="-13078.16" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3331" y="-13067.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-13056.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-13045.16" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer6_attn_out&#45;&gt;gpu5_layer6_kv_update -->
<g id="edge1753" class="edge">
<title>gpu5_layer6_attn_out&#45;&gt;gpu5_layer6_kv_update</title>
<path fill="none" stroke="black" d="M3331,-13137.75C3331,-13129.61 3331,-13120.32 3331,-13111.16"/>
<polygon fill="black" stroke="black" points="3334.5,-13110.94 3331,-13100.94 3327.5,-13110.94 3334.5,-13110.94"/>
</g>
<!-- gpu5_layer6_attn_reshape&#45;&gt;gpu5_layer6_attn_out -->
<g id="edge1752" class="edge">
<title>gpu5_layer6_attn_reshape&#45;&gt;gpu5_layer6_attn_out</title>
<path fill="none" stroke="black" d="M3331,-13226.77C3331,-13218.47 3331,-13209.08 3331,-13200.18"/>
<polygon fill="black" stroke="black" points="3334.5,-13200.04 3331,-13190.04 3327.5,-13200.04 3334.5,-13200.04"/>
</g>
<!-- gpu5_layer6_res1 -->
<g id="node1407" class="node">
<title>gpu5_layer6_res1</title>
<polygon fill="lightblue" stroke="black" points="3392,-12990.39 3270,-12990.39 3270,-12938.39 3392,-12938.39 3392,-12990.39"/>
<text text-anchor="middle" x="3331" y="-12978.39" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3331" y="-12967.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-12956.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-12945.39" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer6_kv_update&#45;&gt;gpu5_layer6_res1 -->
<g id="edge1754" class="edge">
<title>gpu5_layer6_kv_update&#45;&gt;gpu5_layer6_res1</title>
<path fill="none" stroke="black" d="M3331,-13027.31C3331,-13018.63 3331,-13009.36 3331,-13000.71"/>
<polygon fill="black" stroke="black" points="3334.5,-13000.54 3331,-12990.54 3327.5,-13000.54 3334.5,-13000.54"/>
</g>
<!-- gpu5_layer6_ln2 -->
<g id="node1408" class="node">
<title>gpu5_layer6_ln2</title>
<polygon fill="lightblue" stroke="black" points="3392,-12901.39 3270,-12901.39 3270,-12849.39 3392,-12849.39 3392,-12901.39"/>
<text text-anchor="middle" x="3331" y="-12889.39" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3331" y="-12878.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-12867.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-12856.39" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer6_res1&#45;&gt;gpu5_layer6_ln2 -->
<g id="edge1755" class="edge">
<title>gpu5_layer6_res1&#45;&gt;gpu5_layer6_ln2</title>
<path fill="none" stroke="black" d="M3331,-12938.23C3331,-12929.93 3331,-12920.55 3331,-12911.64"/>
<polygon fill="black" stroke="black" points="3334.5,-12911.5 3331,-12901.5 3327.5,-12911.5 3334.5,-12911.5"/>
</g>
<!-- gpu5_layer6_routing -->
<g id="node1409" class="node">
<title>gpu5_layer6_routing</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-12812.39 3256.29,-12812.39 3204.53,-12686.39 3405.71,-12686.39 3457.47,-12812.39"/>
<text text-anchor="middle" x="3331" y="-12768.89" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3331" y="-12757.89" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-12746.89" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-12735.89" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3331" y="-12724.89" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer6_ln2&#45;&gt;gpu5_layer6_routing -->
<g id="edge1756" class="edge">
<title>gpu5_layer6_ln2&#45;&gt;gpu5_layer6_routing</title>
<path fill="none" stroke="black" d="M3331,-12849.3C3331,-12841.37 3331,-12832.17 3331,-12822.64"/>
<polygon fill="black" stroke="black" points="3334.5,-12822.63 3331,-12812.63 3327.5,-12822.63 3334.5,-12822.63"/>
</g>
<!-- gpu5_layer6_expert0 -->
<g id="node1410" class="node">
<title>gpu5_layer6_expert0</title>
<polygon fill="lightblue" stroke="black" points="3112,-12640.39 2990,-12640.39 2990,-12588.39 3112,-12588.39 3112,-12640.39"/>
<text text-anchor="middle" x="3051" y="-12628.39" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3051" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer6_routing&#45;&gt;gpu5_layer6_expert0 -->
<g id="edge1743" class="edge">
<title>gpu5_layer6_routing&#45;&gt;gpu5_layer6_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3205.33,-12688.7C3173.34,-12673.5 3140.34,-12657.83 3113.11,-12644.89"/>
<polygon fill="black" stroke="black" points="3114.26,-12641.57 3103.73,-12640.44 3111.26,-12647.89 3114.26,-12641.57"/>
<text text-anchor="middle" x="3186.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer6_expert1 -->
<g id="node1411" class="node">
<title>gpu5_layer6_expert1</title>
<polygon fill="lightblue" stroke="black" points="3252,-12640.39 3130,-12640.39 3130,-12588.39 3252,-12588.39 3252,-12640.39"/>
<text text-anchor="middle" x="3191" y="-12628.39" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3191" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer6_routing&#45;&gt;gpu5_layer6_expert1 -->
<g id="edge1744" class="edge">
<title>gpu5_layer6_routing&#45;&gt;gpu5_layer6_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3265.51,-12686.17C3251.48,-12672.85 3237.21,-12659.29 3224.97,-12647.66"/>
<polygon fill="black" stroke="black" points="3227.29,-12645.03 3217.63,-12640.68 3222.46,-12650.11 3227.29,-12645.03"/>
<text text-anchor="middle" x="3273.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer6_expert2 -->
<g id="node1412" class="node">
<title>gpu5_layer6_expert2</title>
<polygon fill="lightblue" stroke="black" points="3392,-12640.39 3270,-12640.39 3270,-12588.39 3392,-12588.39 3392,-12640.39"/>
<text text-anchor="middle" x="3331" y="-12628.39" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3331" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer6_routing&#45;&gt;gpu5_layer6_expert2 -->
<g id="edge1745" class="edge">
<title>gpu5_layer6_routing&#45;&gt;gpu5_layer6_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3331,-12686.17C3331,-12674.11 3331,-12661.85 3331,-12651"/>
<polygon fill="black" stroke="black" points="3334.5,-12650.68 3331,-12640.68 3327.5,-12650.68 3334.5,-12650.68"/>
<text text-anchor="middle" x="3360.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer6_expert3 -->
<g id="node1413" class="node">
<title>gpu5_layer6_expert3</title>
<polygon fill="lightblue" stroke="black" points="3532,-12640.39 3410,-12640.39 3410,-12588.39 3532,-12588.39 3532,-12640.39"/>
<text text-anchor="middle" x="3471" y="-12628.39" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="3471" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer6_routing&#45;&gt;gpu5_layer6_expert3 -->
<g id="edge1746" class="edge">
<title>gpu5_layer6_routing&#45;&gt;gpu5_layer6_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3396.49,-12686.17C3410.52,-12672.85 3424.79,-12659.29 3437.03,-12647.66"/>
<polygon fill="black" stroke="black" points="3439.54,-12650.11 3444.37,-12640.68 3434.71,-12645.03 3439.54,-12650.11"/>
<text text-anchor="middle" x="3454.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer6_expert_agg -->
<g id="node1414" class="node">
<title>gpu5_layer6_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-12551.39 3256.29,-12551.39 3204.53,-12447.39 3405.71,-12447.39 3457.47,-12551.39"/>
<text text-anchor="middle" x="3331" y="-12513.39" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3331" y="-12502.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-12491.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-12480.39" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer6_routing&#45;&gt;gpu5_layer6_expert_agg -->
<g id="edge1761" class="edge">
<title>gpu5_layer6_routing&#45;&gt;gpu5_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M3420.22,-12721.47C3493.96,-12694.32 3580.6,-12647.92 3541,-12588.39 3520.44,-12557.48 3486.7,-12537.4 3452.22,-12524.38"/>
<polygon fill="black" stroke="black" points="3453.08,-12520.97 3442.48,-12520.88 3450.71,-12527.55 3453.08,-12520.97"/>
</g>
<!-- gpu5_layer6_expert0&#45;&gt;gpu5_layer6_expert_agg -->
<g id="edge1757" class="edge">
<title>gpu5_layer6_expert0&#45;&gt;gpu5_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M3112.1,-12588.73C3148.98,-12573.85 3196.7,-12554.59 3238.16,-12537.86"/>
<polygon fill="black" stroke="black" points="3239.5,-12541.09 3247.46,-12534.11 3236.88,-12534.6 3239.5,-12541.09"/>
</g>
<!-- gpu5_layer6_expert1&#45;&gt;gpu5_layer6_expert_agg -->
<g id="edge1758" class="edge">
<title>gpu5_layer6_expert1&#45;&gt;gpu5_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M3222.07,-12588.31C3233.32,-12579.24 3246.53,-12568.57 3259.8,-12557.86"/>
<polygon fill="black" stroke="black" points="3262.02,-12560.57 3267.6,-12551.56 3257.62,-12555.12 3262.02,-12560.57"/>
</g>
<!-- gpu5_layer6_expert2&#45;&gt;gpu5_layer6_expert_agg -->
<g id="edge1759" class="edge">
<title>gpu5_layer6_expert2&#45;&gt;gpu5_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M3331,-12588.31C3331,-12580.39 3331,-12571.25 3331,-12561.93"/>
<polygon fill="black" stroke="black" points="3334.5,-12561.79 3331,-12551.79 3327.5,-12561.79 3334.5,-12561.79"/>
</g>
<!-- gpu5_layer6_expert3&#45;&gt;gpu5_layer6_expert_agg -->
<g id="edge1760" class="edge">
<title>gpu5_layer6_expert3&#45;&gt;gpu5_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M3439.93,-12588.31C3428.68,-12579.24 3415.47,-12568.57 3402.2,-12557.86"/>
<polygon fill="black" stroke="black" points="3404.38,-12555.12 3394.4,-12551.56 3399.98,-12560.57 3404.38,-12555.12"/>
</g>
<!-- gpu5_layer6_res2 -->
<g id="node1415" class="node">
<title>gpu5_layer6_res2</title>
<polygon fill="lightblue" stroke="black" points="3392,-12410.39 3270,-12410.39 3270,-12358.39 3392,-12358.39 3392,-12410.39"/>
<text text-anchor="middle" x="3331" y="-12398.39" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3331" y="-12387.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-12376.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-12365.39" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer6_expert_agg&#45;&gt;gpu5_layer6_res2 -->
<g id="edge1762" class="edge">
<title>gpu5_layer6_expert_agg&#45;&gt;gpu5_layer6_res2</title>
<path fill="none" stroke="black" d="M3331,-12447.18C3331,-12438.23 3331,-12429.1 3331,-12420.7"/>
<polygon fill="black" stroke="black" points="3334.5,-12420.52 3331,-12410.52 3327.5,-12420.52 3334.5,-12420.52"/>
</g>
<!-- gpu5_layer7_ln1 -->
<g id="node1416" class="node">
<title>gpu5_layer7_ln1</title>
<polygon fill="lightblue" stroke="black" points="3392,-12321.39 3270,-12321.39 3270,-12269.39 3392,-12269.39 3392,-12321.39"/>
<text text-anchor="middle" x="3331" y="-12309.39" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3331" y="-12298.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-12287.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-12276.39" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer6_res2&#45;&gt;gpu5_layer7_ln1 -->
<g id="edge1767" class="edge">
<title>gpu5_layer6_res2&#45;&gt;gpu5_layer7_ln1</title>
<path fill="none" stroke="black" d="M3331,-12358.23C3331,-12349.93 3331,-12340.55 3331,-12331.64"/>
<polygon fill="black" stroke="black" points="3334.5,-12331.5 3331,-12321.5 3327.5,-12331.5 3334.5,-12331.5"/>
</g>
<!-- gpu5_layer7_qkv -->
<g id="node1417" class="node">
<title>gpu5_layer7_qkv</title>
<polygon fill="lightblue" stroke="black" points="3392,-12232.39 3270,-12232.39 3270,-12180.39 3392,-12180.39 3392,-12232.39"/>
<text text-anchor="middle" x="3331" y="-12220.39" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3331" y="-12209.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-12198.39" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-12187.39" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer7_ln1&#45;&gt;gpu5_layer7_qkv -->
<g id="edge1768" class="edge">
<title>gpu5_layer7_ln1&#45;&gt;gpu5_layer7_qkv</title>
<path fill="none" stroke="black" d="M3331,-12269.23C3331,-12260.93 3331,-12251.55 3331,-12242.64"/>
<polygon fill="black" stroke="black" points="3334.5,-12242.5 3331,-12232.5 3327.5,-12242.5 3334.5,-12242.5"/>
</g>
<!-- gpu5_layer7_reshape -->
<g id="node1418" class="node">
<title>gpu5_layer7_reshape</title>
<polygon fill="lightblue" stroke="black" points="3395,-12143.39 3267,-12143.39 3267,-12091.39 3395,-12091.39 3395,-12143.39"/>
<text text-anchor="middle" x="3331" y="-12131.39" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3331" y="-12120.39" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-12109.39" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-12098.39" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer7_qkv&#45;&gt;gpu5_layer7_reshape -->
<g id="edge1769" class="edge">
<title>gpu5_layer7_qkv&#45;&gt;gpu5_layer7_reshape</title>
<path fill="none" stroke="black" d="M3331,-12180.23C3331,-12171.93 3331,-12162.55 3331,-12153.64"/>
<polygon fill="black" stroke="black" points="3334.5,-12153.5 3331,-12143.5 3327.5,-12153.5 3334.5,-12153.5"/>
</g>
<!-- gpu5_layer7_attn -->
<g id="node1419" class="node">
<title>gpu5_layer7_attn</title>
<polygon fill="lightblue" stroke="black" points="3395,-12054.39 3267,-12054.39 3267,-12002.39 3395,-12002.39 3395,-12054.39"/>
<text text-anchor="middle" x="3331" y="-12042.39" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3331" y="-12031.39" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-12020.39" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-12009.39" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer7_reshape&#45;&gt;gpu5_layer7_attn -->
<g id="edge1770" class="edge">
<title>gpu5_layer7_reshape&#45;&gt;gpu5_layer7_attn</title>
<path fill="none" stroke="black" d="M3331,-12091.23C3331,-12082.93 3331,-12073.55 3331,-12064.64"/>
<polygon fill="black" stroke="black" points="3334.5,-12064.5 3331,-12054.5 3327.5,-12064.5 3334.5,-12064.5"/>
</g>
<!-- gpu5_layer7_attn_reshape -->
<g id="node1421" class="node">
<title>gpu5_layer7_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3392,-11965.39 3270,-11965.39 3270,-11913.39 3392,-11913.39 3392,-11965.39"/>
<text text-anchor="middle" x="3331" y="-11953.39" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3331" y="-11942.39" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-11931.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-11920.39" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer7_attn&#45;&gt;gpu5_layer7_attn_reshape -->
<g id="edge1771" class="edge">
<title>gpu5_layer7_attn&#45;&gt;gpu5_layer7_attn_reshape</title>
<path fill="none" stroke="black" d="M3331,-12002.23C3331,-11993.93 3331,-11984.55 3331,-11975.64"/>
<polygon fill="black" stroke="black" points="3334.5,-11975.5 3331,-11965.5 3327.5,-11975.5 3334.5,-11975.5"/>
</g>
<!-- gpu5_layer7_attn_out -->
<g id="node1420" class="node">
<title>gpu5_layer7_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3392,-11876.39 3270,-11876.39 3270,-11824.39 3392,-11824.39 3392,-11876.39"/>
<text text-anchor="middle" x="3331" y="-11864.39" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3331" y="-11853.39" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-11842.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-11831.39" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer7_kv_update -->
<g id="node1422" class="node">
<title>gpu5_layer7_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3331" cy="-11750.62" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3331" y="-11764.62" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3331" y="-11753.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-11742.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-11731.62" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer7_attn_out&#45;&gt;gpu5_layer7_kv_update -->
<g id="edge1773" class="edge">
<title>gpu5_layer7_attn_out&#45;&gt;gpu5_layer7_kv_update</title>
<path fill="none" stroke="black" d="M3331,-11824.21C3331,-11816.07 3331,-11806.78 3331,-11797.62"/>
<polygon fill="black" stroke="black" points="3334.5,-11797.4 3331,-11787.4 3327.5,-11797.4 3334.5,-11797.4"/>
</g>
<!-- gpu5_layer7_attn_reshape&#45;&gt;gpu5_layer7_attn_out -->
<g id="edge1772" class="edge">
<title>gpu5_layer7_attn_reshape&#45;&gt;gpu5_layer7_attn_out</title>
<path fill="none" stroke="black" d="M3331,-11913.23C3331,-11904.93 3331,-11895.55 3331,-11886.64"/>
<polygon fill="black" stroke="black" points="3334.5,-11886.5 3331,-11876.5 3327.5,-11886.5 3334.5,-11886.5"/>
</g>
<!-- gpu5_layer7_res1 -->
<g id="node1423" class="node">
<title>gpu5_layer7_res1</title>
<polygon fill="lightblue" stroke="black" points="3392,-11676.85 3270,-11676.85 3270,-11624.85 3392,-11624.85 3392,-11676.85"/>
<text text-anchor="middle" x="3331" y="-11664.85" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3331" y="-11653.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-11642.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-11631.85" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer7_kv_update&#45;&gt;gpu5_layer7_res1 -->
<g id="edge1774" class="edge">
<title>gpu5_layer7_kv_update&#45;&gt;gpu5_layer7_res1</title>
<path fill="none" stroke="black" d="M3331,-11713.77C3331,-11705.09 3331,-11695.82 3331,-11687.17"/>
<polygon fill="black" stroke="black" points="3334.5,-11687 3331,-11677 3327.5,-11687 3334.5,-11687"/>
</g>
<!-- gpu5_layer7_ln2 -->
<g id="node1424" class="node">
<title>gpu5_layer7_ln2</title>
<polygon fill="lightblue" stroke="black" points="3392,-11587.85 3270,-11587.85 3270,-11535.85 3392,-11535.85 3392,-11587.85"/>
<text text-anchor="middle" x="3331" y="-11575.85" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3331" y="-11564.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-11553.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-11542.85" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer7_res1&#45;&gt;gpu5_layer7_ln2 -->
<g id="edge1775" class="edge">
<title>gpu5_layer7_res1&#45;&gt;gpu5_layer7_ln2</title>
<path fill="none" stroke="black" d="M3331,-11624.69C3331,-11616.39 3331,-11607.01 3331,-11598.1"/>
<polygon fill="black" stroke="black" points="3334.5,-11597.96 3331,-11587.96 3327.5,-11597.96 3334.5,-11597.96"/>
</g>
<!-- gpu5_layer7_routing -->
<g id="node1425" class="node">
<title>gpu5_layer7_routing</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-11498.85 3256.29,-11498.85 3204.53,-11372.85 3405.71,-11372.85 3457.47,-11498.85"/>
<text text-anchor="middle" x="3331" y="-11455.35" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3331" y="-11444.35" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-11433.35" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-11422.35" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3331" y="-11411.35" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer7_ln2&#45;&gt;gpu5_layer7_routing -->
<g id="edge1776" class="edge">
<title>gpu5_layer7_ln2&#45;&gt;gpu5_layer7_routing</title>
<path fill="none" stroke="black" d="M3331,-11535.76C3331,-11527.83 3331,-11518.63 3331,-11509.1"/>
<polygon fill="black" stroke="black" points="3334.5,-11509.09 3331,-11499.09 3327.5,-11509.09 3334.5,-11509.09"/>
</g>
<!-- gpu5_layer7_expert0 -->
<g id="node1426" class="node">
<title>gpu5_layer7_expert0</title>
<polygon fill="lightblue" stroke="black" points="3112,-11326.85 2990,-11326.85 2990,-11274.85 3112,-11274.85 3112,-11326.85"/>
<text text-anchor="middle" x="3051" y="-11314.85" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3051" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer7_routing&#45;&gt;gpu5_layer7_expert0 -->
<g id="edge1763" class="edge">
<title>gpu5_layer7_routing&#45;&gt;gpu5_layer7_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3205.33,-11375.16C3173.34,-11359.96 3140.34,-11344.29 3113.11,-11331.35"/>
<polygon fill="black" stroke="black" points="3114.26,-11328.03 3103.73,-11326.9 3111.26,-11334.35 3114.26,-11328.03"/>
<text text-anchor="middle" x="3186.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer7_expert1 -->
<g id="node1427" class="node">
<title>gpu5_layer7_expert1</title>
<polygon fill="lightblue" stroke="black" points="3252,-11326.85 3130,-11326.85 3130,-11274.85 3252,-11274.85 3252,-11326.85"/>
<text text-anchor="middle" x="3191" y="-11314.85" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3191" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer7_routing&#45;&gt;gpu5_layer7_expert1 -->
<g id="edge1764" class="edge">
<title>gpu5_layer7_routing&#45;&gt;gpu5_layer7_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3265.51,-11372.64C3251.48,-11359.31 3237.21,-11345.76 3224.97,-11334.12"/>
<polygon fill="black" stroke="black" points="3227.29,-11331.5 3217.63,-11327.15 3222.46,-11336.57 3227.29,-11331.5"/>
<text text-anchor="middle" x="3273.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer7_expert2 -->
<g id="node1428" class="node">
<title>gpu5_layer7_expert2</title>
<polygon fill="lightblue" stroke="black" points="3392,-11326.85 3270,-11326.85 3270,-11274.85 3392,-11274.85 3392,-11326.85"/>
<text text-anchor="middle" x="3331" y="-11314.85" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3331" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer7_routing&#45;&gt;gpu5_layer7_expert2 -->
<g id="edge1765" class="edge">
<title>gpu5_layer7_routing&#45;&gt;gpu5_layer7_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3331,-11372.64C3331,-11360.57 3331,-11348.31 3331,-11337.46"/>
<polygon fill="black" stroke="black" points="3334.5,-11337.15 3331,-11327.15 3327.5,-11337.15 3334.5,-11337.15"/>
<text text-anchor="middle" x="3360.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer7_expert3 -->
<g id="node1429" class="node">
<title>gpu5_layer7_expert3</title>
<polygon fill="lightblue" stroke="black" points="3532,-11326.85 3410,-11326.85 3410,-11274.85 3532,-11274.85 3532,-11326.85"/>
<text text-anchor="middle" x="3471" y="-11314.85" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="3471" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer7_routing&#45;&gt;gpu5_layer7_expert3 -->
<g id="edge1766" class="edge">
<title>gpu5_layer7_routing&#45;&gt;gpu5_layer7_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3396.49,-11372.64C3410.52,-11359.31 3424.79,-11345.76 3437.03,-11334.12"/>
<polygon fill="black" stroke="black" points="3439.54,-11336.57 3444.37,-11327.15 3434.71,-11331.5 3439.54,-11336.57"/>
<text text-anchor="middle" x="3454.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer7_expert_agg -->
<g id="node1430" class="node">
<title>gpu5_layer7_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-11237.85 3256.29,-11237.85 3204.53,-11133.85 3405.71,-11133.85 3457.47,-11237.85"/>
<text text-anchor="middle" x="3331" y="-11199.85" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3331" y="-11188.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-11177.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-11166.85" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer7_routing&#45;&gt;gpu5_layer7_expert_agg -->
<g id="edge1781" class="edge">
<title>gpu5_layer7_routing&#45;&gt;gpu5_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M3420.22,-11407.94C3493.96,-11380.78 3580.6,-11334.39 3541,-11274.85 3520.44,-11243.94 3486.7,-11223.87 3452.22,-11210.84"/>
<polygon fill="black" stroke="black" points="3453.08,-11207.43 3442.48,-11207.35 3450.71,-11214.02 3453.08,-11207.43"/>
</g>
<!-- gpu5_layer7_expert0&#45;&gt;gpu5_layer7_expert_agg -->
<g id="edge1777" class="edge">
<title>gpu5_layer7_expert0&#45;&gt;gpu5_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M3112.1,-11275.19C3148.98,-11260.31 3196.7,-11241.05 3238.16,-11224.32"/>
<polygon fill="black" stroke="black" points="3239.5,-11227.56 3247.46,-11220.57 3236.88,-11221.06 3239.5,-11227.56"/>
</g>
<!-- gpu5_layer7_expert1&#45;&gt;gpu5_layer7_expert_agg -->
<g id="edge1778" class="edge">
<title>gpu5_layer7_expert1&#45;&gt;gpu5_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M3222.07,-11274.77C3233.32,-11265.7 3246.53,-11255.03 3259.8,-11244.32"/>
<polygon fill="black" stroke="black" points="3262.02,-11247.03 3267.6,-11238.02 3257.62,-11241.58 3262.02,-11247.03"/>
</g>
<!-- gpu5_layer7_expert2&#45;&gt;gpu5_layer7_expert_agg -->
<g id="edge1779" class="edge">
<title>gpu5_layer7_expert2&#45;&gt;gpu5_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M3331,-11274.77C3331,-11266.85 3331,-11257.71 3331,-11248.39"/>
<polygon fill="black" stroke="black" points="3334.5,-11248.25 3331,-11238.25 3327.5,-11248.25 3334.5,-11248.25"/>
</g>
<!-- gpu5_layer7_expert3&#45;&gt;gpu5_layer7_expert_agg -->
<g id="edge1780" class="edge">
<title>gpu5_layer7_expert3&#45;&gt;gpu5_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M3439.93,-11274.77C3428.68,-11265.7 3415.47,-11255.03 3402.2,-11244.32"/>
<polygon fill="black" stroke="black" points="3404.38,-11241.58 3394.4,-11238.02 3399.98,-11247.03 3404.38,-11241.58"/>
</g>
<!-- gpu5_layer7_res2 -->
<g id="node1431" class="node">
<title>gpu5_layer7_res2</title>
<polygon fill="lightblue" stroke="black" points="3392,-11096.85 3270,-11096.85 3270,-11044.85 3392,-11044.85 3392,-11096.85"/>
<text text-anchor="middle" x="3331" y="-11084.85" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3331" y="-11073.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-11062.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-11051.85" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer7_expert_agg&#45;&gt;gpu5_layer7_res2 -->
<g id="edge1782" class="edge">
<title>gpu5_layer7_expert_agg&#45;&gt;gpu5_layer7_res2</title>
<path fill="none" stroke="black" d="M3331,-11133.64C3331,-11124.69 3331,-11115.56 3331,-11107.16"/>
<polygon fill="black" stroke="black" points="3334.5,-11106.98 3331,-11096.98 3327.5,-11106.98 3334.5,-11106.98"/>
</g>
<!-- gpu5_layer8_ln1 -->
<g id="node1432" class="node">
<title>gpu5_layer8_ln1</title>
<polygon fill="lightblue" stroke="black" points="3392,-11007.85 3270,-11007.85 3270,-10955.85 3392,-10955.85 3392,-11007.85"/>
<text text-anchor="middle" x="3331" y="-10995.85" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3331" y="-10984.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-10973.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-10962.85" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer7_res2&#45;&gt;gpu5_layer8_ln1 -->
<g id="edge1787" class="edge">
<title>gpu5_layer7_res2&#45;&gt;gpu5_layer8_ln1</title>
<path fill="none" stroke="black" d="M3331,-11044.69C3331,-11036.39 3331,-11027.01 3331,-11018.1"/>
<polygon fill="black" stroke="black" points="3334.5,-11017.96 3331,-11007.96 3327.5,-11017.96 3334.5,-11017.96"/>
</g>
<!-- gpu5_layer8_qkv -->
<g id="node1433" class="node">
<title>gpu5_layer8_qkv</title>
<polygon fill="lightblue" stroke="black" points="3392,-10918.85 3270,-10918.85 3270,-10866.85 3392,-10866.85 3392,-10918.85"/>
<text text-anchor="middle" x="3331" y="-10906.85" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3331" y="-10895.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-10884.85" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-10873.85" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer8_ln1&#45;&gt;gpu5_layer8_qkv -->
<g id="edge1788" class="edge">
<title>gpu5_layer8_ln1&#45;&gt;gpu5_layer8_qkv</title>
<path fill="none" stroke="black" d="M3331,-10955.69C3331,-10947.39 3331,-10938.01 3331,-10929.1"/>
<polygon fill="black" stroke="black" points="3334.5,-10928.96 3331,-10918.96 3327.5,-10928.96 3334.5,-10928.96"/>
</g>
<!-- gpu5_layer8_reshape -->
<g id="node1434" class="node">
<title>gpu5_layer8_reshape</title>
<polygon fill="lightblue" stroke="black" points="3395,-10829.85 3267,-10829.85 3267,-10777.85 3395,-10777.85 3395,-10829.85"/>
<text text-anchor="middle" x="3331" y="-10817.85" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3331" y="-10806.85" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-10795.85" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-10784.85" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer8_qkv&#45;&gt;gpu5_layer8_reshape -->
<g id="edge1789" class="edge">
<title>gpu5_layer8_qkv&#45;&gt;gpu5_layer8_reshape</title>
<path fill="none" stroke="black" d="M3331,-10866.69C3331,-10858.39 3331,-10849.01 3331,-10840.1"/>
<polygon fill="black" stroke="black" points="3334.5,-10839.96 3331,-10829.96 3327.5,-10839.96 3334.5,-10839.96"/>
</g>
<!-- gpu5_layer8_attn -->
<g id="node1435" class="node">
<title>gpu5_layer8_attn</title>
<polygon fill="lightblue" stroke="black" points="3395,-10740.85 3267,-10740.85 3267,-10688.85 3395,-10688.85 3395,-10740.85"/>
<text text-anchor="middle" x="3331" y="-10728.85" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3331" y="-10717.85" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-10706.85" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-10695.85" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer8_reshape&#45;&gt;gpu5_layer8_attn -->
<g id="edge1790" class="edge">
<title>gpu5_layer8_reshape&#45;&gt;gpu5_layer8_attn</title>
<path fill="none" stroke="black" d="M3331,-10777.69C3331,-10769.39 3331,-10760.01 3331,-10751.1"/>
<polygon fill="black" stroke="black" points="3334.5,-10750.96 3331,-10740.96 3327.5,-10750.96 3334.5,-10750.96"/>
</g>
<!-- gpu5_layer8_attn_reshape -->
<g id="node1437" class="node">
<title>gpu5_layer8_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3392,-10651.85 3270,-10651.85 3270,-10599.85 3392,-10599.85 3392,-10651.85"/>
<text text-anchor="middle" x="3331" y="-10639.85" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3331" y="-10628.85" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-10617.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-10606.85" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer8_attn&#45;&gt;gpu5_layer8_attn_reshape -->
<g id="edge1791" class="edge">
<title>gpu5_layer8_attn&#45;&gt;gpu5_layer8_attn_reshape</title>
<path fill="none" stroke="black" d="M3331,-10688.69C3331,-10680.39 3331,-10671.01 3331,-10662.1"/>
<polygon fill="black" stroke="black" points="3334.5,-10661.96 3331,-10651.96 3327.5,-10661.96 3334.5,-10661.96"/>
</g>
<!-- gpu5_layer8_attn_out -->
<g id="node1436" class="node">
<title>gpu5_layer8_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3392,-10562.85 3270,-10562.85 3270,-10510.85 3392,-10510.85 3392,-10562.85"/>
<text text-anchor="middle" x="3331" y="-10550.85" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3331" y="-10539.85" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-10528.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-10517.85" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer8_kv_update -->
<g id="node1438" class="node">
<title>gpu5_layer8_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3331" cy="-10437.08" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3331" y="-10451.08" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3331" y="-10440.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-10429.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-10418.08" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer8_attn_out&#45;&gt;gpu5_layer8_kv_update -->
<g id="edge1793" class="edge">
<title>gpu5_layer8_attn_out&#45;&gt;gpu5_layer8_kv_update</title>
<path fill="none" stroke="black" d="M3331,-10510.67C3331,-10502.53 3331,-10493.24 3331,-10484.08"/>
<polygon fill="black" stroke="black" points="3334.5,-10483.86 3331,-10473.86 3327.5,-10483.86 3334.5,-10483.86"/>
</g>
<!-- gpu5_layer8_attn_reshape&#45;&gt;gpu5_layer8_attn_out -->
<g id="edge1792" class="edge">
<title>gpu5_layer8_attn_reshape&#45;&gt;gpu5_layer8_attn_out</title>
<path fill="none" stroke="black" d="M3331,-10599.69C3331,-10591.39 3331,-10582.01 3331,-10573.1"/>
<polygon fill="black" stroke="black" points="3334.5,-10572.96 3331,-10562.96 3327.5,-10572.96 3334.5,-10572.96"/>
</g>
<!-- gpu5_layer8_res1 -->
<g id="node1439" class="node">
<title>gpu5_layer8_res1</title>
<polygon fill="lightblue" stroke="black" points="3392,-10363.31 3270,-10363.31 3270,-10311.31 3392,-10311.31 3392,-10363.31"/>
<text text-anchor="middle" x="3331" y="-10351.31" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3331" y="-10340.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-10329.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-10318.31" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer8_kv_update&#45;&gt;gpu5_layer8_res1 -->
<g id="edge1794" class="edge">
<title>gpu5_layer8_kv_update&#45;&gt;gpu5_layer8_res1</title>
<path fill="none" stroke="black" d="M3331,-10400.23C3331,-10391.55 3331,-10382.28 3331,-10373.63"/>
<polygon fill="black" stroke="black" points="3334.5,-10373.46 3331,-10363.46 3327.5,-10373.46 3334.5,-10373.46"/>
</g>
<!-- gpu5_layer8_ln2 -->
<g id="node1440" class="node">
<title>gpu5_layer8_ln2</title>
<polygon fill="lightblue" stroke="black" points="3392,-10274.31 3270,-10274.31 3270,-10222.31 3392,-10222.31 3392,-10274.31"/>
<text text-anchor="middle" x="3331" y="-10262.31" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3331" y="-10251.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-10240.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-10229.31" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer8_res1&#45;&gt;gpu5_layer8_ln2 -->
<g id="edge1795" class="edge">
<title>gpu5_layer8_res1&#45;&gt;gpu5_layer8_ln2</title>
<path fill="none" stroke="black" d="M3331,-10311.15C3331,-10302.85 3331,-10293.47 3331,-10284.56"/>
<polygon fill="black" stroke="black" points="3334.5,-10284.42 3331,-10274.42 3327.5,-10284.42 3334.5,-10284.42"/>
</g>
<!-- gpu5_layer8_routing -->
<g id="node1441" class="node">
<title>gpu5_layer8_routing</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-10185.31 3256.29,-10185.31 3204.53,-10059.31 3405.71,-10059.31 3457.47,-10185.31"/>
<text text-anchor="middle" x="3331" y="-10141.81" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3331" y="-10130.81" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-10119.81" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-10108.81" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3331" y="-10097.81" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer8_ln2&#45;&gt;gpu5_layer8_routing -->
<g id="edge1796" class="edge">
<title>gpu5_layer8_ln2&#45;&gt;gpu5_layer8_routing</title>
<path fill="none" stroke="black" d="M3331,-10222.22C3331,-10214.29 3331,-10205.09 3331,-10195.56"/>
<polygon fill="black" stroke="black" points="3334.5,-10195.55 3331,-10185.55 3327.5,-10195.55 3334.5,-10195.55"/>
</g>
<!-- gpu5_layer8_expert0 -->
<g id="node1442" class="node">
<title>gpu5_layer8_expert0</title>
<polygon fill="lightblue" stroke="black" points="3112,-10013.31 2990,-10013.31 2990,-9961.31 3112,-9961.31 3112,-10013.31"/>
<text text-anchor="middle" x="3051" y="-10001.31" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3051" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer8_routing&#45;&gt;gpu5_layer8_expert0 -->
<g id="edge1783" class="edge">
<title>gpu5_layer8_routing&#45;&gt;gpu5_layer8_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3205.33,-10061.62C3173.34,-10046.42 3140.34,-10030.75 3113.11,-10017.81"/>
<polygon fill="black" stroke="black" points="3114.26,-10014.49 3103.73,-10013.36 3111.26,-10020.81 3114.26,-10014.49"/>
<text text-anchor="middle" x="3186.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer8_expert1 -->
<g id="node1443" class="node">
<title>gpu5_layer8_expert1</title>
<polygon fill="lightblue" stroke="black" points="3252,-10013.31 3130,-10013.31 3130,-9961.31 3252,-9961.31 3252,-10013.31"/>
<text text-anchor="middle" x="3191" y="-10001.31" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3191" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer8_routing&#45;&gt;gpu5_layer8_expert1 -->
<g id="edge1784" class="edge">
<title>gpu5_layer8_routing&#45;&gt;gpu5_layer8_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3265.51,-10059.1C3251.48,-10045.77 3237.21,-10032.22 3224.97,-10020.58"/>
<polygon fill="black" stroke="black" points="3227.29,-10017.96 3217.63,-10013.61 3222.46,-10023.03 3227.29,-10017.96"/>
<text text-anchor="middle" x="3273.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer8_expert2 -->
<g id="node1444" class="node">
<title>gpu5_layer8_expert2</title>
<polygon fill="lightblue" stroke="black" points="3392,-10013.31 3270,-10013.31 3270,-9961.31 3392,-9961.31 3392,-10013.31"/>
<text text-anchor="middle" x="3331" y="-10001.31" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3331" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer8_routing&#45;&gt;gpu5_layer8_expert2 -->
<g id="edge1785" class="edge">
<title>gpu5_layer8_routing&#45;&gt;gpu5_layer8_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3331,-10059.1C3331,-10047.03 3331,-10034.77 3331,-10023.92"/>
<polygon fill="black" stroke="black" points="3334.5,-10023.61 3331,-10013.61 3327.5,-10023.61 3334.5,-10023.61"/>
<text text-anchor="middle" x="3360.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer8_expert3 -->
<g id="node1445" class="node">
<title>gpu5_layer8_expert3</title>
<polygon fill="lightblue" stroke="black" points="3532,-10013.31 3410,-10013.31 3410,-9961.31 3532,-9961.31 3532,-10013.31"/>
<text text-anchor="middle" x="3471" y="-10001.31" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="3471" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer8_routing&#45;&gt;gpu5_layer8_expert3 -->
<g id="edge1786" class="edge">
<title>gpu5_layer8_routing&#45;&gt;gpu5_layer8_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3396.49,-10059.1C3410.52,-10045.77 3424.79,-10032.22 3437.03,-10020.58"/>
<polygon fill="black" stroke="black" points="3439.54,-10023.03 3444.37,-10013.61 3434.71,-10017.96 3439.54,-10023.03"/>
<text text-anchor="middle" x="3454.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer8_expert_agg -->
<g id="node1446" class="node">
<title>gpu5_layer8_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-9924.31 3256.29,-9924.31 3204.53,-9820.31 3405.71,-9820.31 3457.47,-9924.31"/>
<text text-anchor="middle" x="3331" y="-9886.31" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3331" y="-9875.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-9864.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-9853.31" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer8_routing&#45;&gt;gpu5_layer8_expert_agg -->
<g id="edge1801" class="edge">
<title>gpu5_layer8_routing&#45;&gt;gpu5_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M3420.22,-10094.4C3493.96,-10067.24 3580.6,-10020.85 3541,-9961.31 3520.44,-9930.4 3486.7,-9910.33 3452.22,-9897.3"/>
<polygon fill="black" stroke="black" points="3453.08,-9893.89 3442.48,-9893.81 3450.71,-9900.48 3453.08,-9893.89"/>
</g>
<!-- gpu5_layer8_expert0&#45;&gt;gpu5_layer8_expert_agg -->
<g id="edge1797" class="edge">
<title>gpu5_layer8_expert0&#45;&gt;gpu5_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M3112.1,-9961.65C3148.98,-9946.77 3196.7,-9927.51 3238.16,-9910.78"/>
<polygon fill="black" stroke="black" points="3239.5,-9914.02 3247.46,-9907.03 3236.88,-9907.52 3239.5,-9914.02"/>
</g>
<!-- gpu5_layer8_expert1&#45;&gt;gpu5_layer8_expert_agg -->
<g id="edge1798" class="edge">
<title>gpu5_layer8_expert1&#45;&gt;gpu5_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M3222.07,-9961.23C3233.32,-9952.16 3246.53,-9941.49 3259.8,-9930.78"/>
<polygon fill="black" stroke="black" points="3262.02,-9933.49 3267.6,-9924.48 3257.62,-9928.04 3262.02,-9933.49"/>
</g>
<!-- gpu5_layer8_expert2&#45;&gt;gpu5_layer8_expert_agg -->
<g id="edge1799" class="edge">
<title>gpu5_layer8_expert2&#45;&gt;gpu5_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M3331,-9961.23C3331,-9953.31 3331,-9944.17 3331,-9934.85"/>
<polygon fill="black" stroke="black" points="3334.5,-9934.71 3331,-9924.71 3327.5,-9934.71 3334.5,-9934.71"/>
</g>
<!-- gpu5_layer8_expert3&#45;&gt;gpu5_layer8_expert_agg -->
<g id="edge1800" class="edge">
<title>gpu5_layer8_expert3&#45;&gt;gpu5_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M3439.93,-9961.23C3428.68,-9952.16 3415.47,-9941.49 3402.2,-9930.78"/>
<polygon fill="black" stroke="black" points="3404.38,-9928.04 3394.4,-9924.48 3399.98,-9933.49 3404.38,-9928.04"/>
</g>
<!-- gpu5_layer8_res2 -->
<g id="node1447" class="node">
<title>gpu5_layer8_res2</title>
<polygon fill="lightblue" stroke="black" points="3392,-9783.31 3270,-9783.31 3270,-9731.31 3392,-9731.31 3392,-9783.31"/>
<text text-anchor="middle" x="3331" y="-9771.31" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3331" y="-9760.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-9749.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-9738.31" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer8_expert_agg&#45;&gt;gpu5_layer8_res2 -->
<g id="edge1802" class="edge">
<title>gpu5_layer8_expert_agg&#45;&gt;gpu5_layer8_res2</title>
<path fill="none" stroke="black" d="M3331,-9820.1C3331,-9811.15 3331,-9802.02 3331,-9793.62"/>
<polygon fill="black" stroke="black" points="3334.5,-9793.44 3331,-9783.44 3327.5,-9793.44 3334.5,-9793.44"/>
</g>
<!-- gpu5_layer9_ln1 -->
<g id="node1448" class="node">
<title>gpu5_layer9_ln1</title>
<polygon fill="lightblue" stroke="black" points="3392,-9694.31 3270,-9694.31 3270,-9642.31 3392,-9642.31 3392,-9694.31"/>
<text text-anchor="middle" x="3331" y="-9682.31" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3331" y="-9671.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-9660.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-9649.31" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer8_res2&#45;&gt;gpu5_layer9_ln1 -->
<g id="edge1807" class="edge">
<title>gpu5_layer8_res2&#45;&gt;gpu5_layer9_ln1</title>
<path fill="none" stroke="black" d="M3331,-9731.15C3331,-9722.85 3331,-9713.47 3331,-9704.56"/>
<polygon fill="black" stroke="black" points="3334.5,-9704.42 3331,-9694.42 3327.5,-9704.42 3334.5,-9704.42"/>
</g>
<!-- gpu5_layer9_qkv -->
<g id="node1449" class="node">
<title>gpu5_layer9_qkv</title>
<polygon fill="lightblue" stroke="black" points="3392,-9605.31 3270,-9605.31 3270,-9553.31 3392,-9553.31 3392,-9605.31"/>
<text text-anchor="middle" x="3331" y="-9593.31" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3331" y="-9582.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-9571.31" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-9560.31" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer9_ln1&#45;&gt;gpu5_layer9_qkv -->
<g id="edge1808" class="edge">
<title>gpu5_layer9_ln1&#45;&gt;gpu5_layer9_qkv</title>
<path fill="none" stroke="black" d="M3331,-9642.15C3331,-9633.85 3331,-9624.47 3331,-9615.56"/>
<polygon fill="black" stroke="black" points="3334.5,-9615.42 3331,-9605.42 3327.5,-9615.42 3334.5,-9615.42"/>
</g>
<!-- gpu5_layer9_reshape -->
<g id="node1450" class="node">
<title>gpu5_layer9_reshape</title>
<polygon fill="lightblue" stroke="black" points="3395,-9516.31 3267,-9516.31 3267,-9464.31 3395,-9464.31 3395,-9516.31"/>
<text text-anchor="middle" x="3331" y="-9504.31" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3331" y="-9493.31" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-9482.31" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-9471.31" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer9_qkv&#45;&gt;gpu5_layer9_reshape -->
<g id="edge1809" class="edge">
<title>gpu5_layer9_qkv&#45;&gt;gpu5_layer9_reshape</title>
<path fill="none" stroke="black" d="M3331,-9553.15C3331,-9544.85 3331,-9535.47 3331,-9526.56"/>
<polygon fill="black" stroke="black" points="3334.5,-9526.42 3331,-9516.42 3327.5,-9526.42 3334.5,-9526.42"/>
</g>
<!-- gpu5_layer9_attn -->
<g id="node1451" class="node">
<title>gpu5_layer9_attn</title>
<polygon fill="lightblue" stroke="black" points="3395,-9427.31 3267,-9427.31 3267,-9375.31 3395,-9375.31 3395,-9427.31"/>
<text text-anchor="middle" x="3331" y="-9415.31" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3331" y="-9404.31" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-9393.31" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-9382.31" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer9_reshape&#45;&gt;gpu5_layer9_attn -->
<g id="edge1810" class="edge">
<title>gpu5_layer9_reshape&#45;&gt;gpu5_layer9_attn</title>
<path fill="none" stroke="black" d="M3331,-9464.15C3331,-9455.85 3331,-9446.47 3331,-9437.56"/>
<polygon fill="black" stroke="black" points="3334.5,-9437.42 3331,-9427.42 3327.5,-9437.42 3334.5,-9437.42"/>
</g>
<!-- gpu5_layer9_attn_reshape -->
<g id="node1453" class="node">
<title>gpu5_layer9_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3392,-9338.31 3270,-9338.31 3270,-9286.31 3392,-9286.31 3392,-9338.31"/>
<text text-anchor="middle" x="3331" y="-9326.31" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3331" y="-9315.31" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-9304.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-9293.31" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer9_attn&#45;&gt;gpu5_layer9_attn_reshape -->
<g id="edge1811" class="edge">
<title>gpu5_layer9_attn&#45;&gt;gpu5_layer9_attn_reshape</title>
<path fill="none" stroke="black" d="M3331,-9375.15C3331,-9366.85 3331,-9357.47 3331,-9348.56"/>
<polygon fill="black" stroke="black" points="3334.5,-9348.42 3331,-9338.42 3327.5,-9348.42 3334.5,-9348.42"/>
</g>
<!-- gpu5_layer9_attn_out -->
<g id="node1452" class="node">
<title>gpu5_layer9_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3392,-9249.31 3270,-9249.31 3270,-9197.31 3392,-9197.31 3392,-9249.31"/>
<text text-anchor="middle" x="3331" y="-9237.31" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3331" y="-9226.31" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-9215.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-9204.31" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer9_kv_update -->
<g id="node1454" class="node">
<title>gpu5_layer9_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3331" cy="-9123.54" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3331" y="-9137.54" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3331" y="-9126.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-9115.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-9104.54" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer9_attn_out&#45;&gt;gpu5_layer9_kv_update -->
<g id="edge1813" class="edge">
<title>gpu5_layer9_attn_out&#45;&gt;gpu5_layer9_kv_update</title>
<path fill="none" stroke="black" d="M3331,-9197.13C3331,-9189 3331,-9179.7 3331,-9170.54"/>
<polygon fill="black" stroke="black" points="3334.5,-9170.32 3331,-9160.32 3327.5,-9170.32 3334.5,-9170.32"/>
</g>
<!-- gpu5_layer9_attn_reshape&#45;&gt;gpu5_layer9_attn_out -->
<g id="edge1812" class="edge">
<title>gpu5_layer9_attn_reshape&#45;&gt;gpu5_layer9_attn_out</title>
<path fill="none" stroke="black" d="M3331,-9286.15C3331,-9277.85 3331,-9268.47 3331,-9259.56"/>
<polygon fill="black" stroke="black" points="3334.5,-9259.42 3331,-9249.42 3327.5,-9259.42 3334.5,-9259.42"/>
</g>
<!-- gpu5_layer9_res1 -->
<g id="node1455" class="node">
<title>gpu5_layer9_res1</title>
<polygon fill="lightblue" stroke="black" points="3392,-9049.77 3270,-9049.77 3270,-8997.77 3392,-8997.77 3392,-9049.77"/>
<text text-anchor="middle" x="3331" y="-9037.77" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3331" y="-9026.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-9015.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-9004.77" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer9_kv_update&#45;&gt;gpu5_layer9_res1 -->
<g id="edge1814" class="edge">
<title>gpu5_layer9_kv_update&#45;&gt;gpu5_layer9_res1</title>
<path fill="none" stroke="black" d="M3331,-9086.69C3331,-9078.01 3331,-9068.74 3331,-9060.09"/>
<polygon fill="black" stroke="black" points="3334.5,-9059.92 3331,-9049.92 3327.5,-9059.92 3334.5,-9059.92"/>
</g>
<!-- gpu5_layer9_ln2 -->
<g id="node1456" class="node">
<title>gpu5_layer9_ln2</title>
<polygon fill="lightblue" stroke="black" points="3392,-8960.77 3270,-8960.77 3270,-8908.77 3392,-8908.77 3392,-8960.77"/>
<text text-anchor="middle" x="3331" y="-8948.77" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3331" y="-8937.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-8926.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-8915.77" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer9_res1&#45;&gt;gpu5_layer9_ln2 -->
<g id="edge1815" class="edge">
<title>gpu5_layer9_res1&#45;&gt;gpu5_layer9_ln2</title>
<path fill="none" stroke="black" d="M3331,-8997.61C3331,-8989.31 3331,-8979.93 3331,-8971.02"/>
<polygon fill="black" stroke="black" points="3334.5,-8970.88 3331,-8960.88 3327.5,-8970.88 3334.5,-8970.88"/>
</g>
<!-- gpu5_layer9_routing -->
<g id="node1457" class="node">
<title>gpu5_layer9_routing</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-8871.77 3256.29,-8871.77 3204.53,-8745.77 3405.71,-8745.77 3457.47,-8871.77"/>
<text text-anchor="middle" x="3331" y="-8828.27" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3331" y="-8817.27" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-8806.27" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-8795.27" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3331" y="-8784.27" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer9_ln2&#45;&gt;gpu5_layer9_routing -->
<g id="edge1816" class="edge">
<title>gpu5_layer9_ln2&#45;&gt;gpu5_layer9_routing</title>
<path fill="none" stroke="black" d="M3331,-8908.68C3331,-8900.75 3331,-8891.55 3331,-8882.02"/>
<polygon fill="black" stroke="black" points="3334.5,-8882.01 3331,-8872.01 3327.5,-8882.01 3334.5,-8882.01"/>
</g>
<!-- gpu5_layer9_expert0 -->
<g id="node1458" class="node">
<title>gpu5_layer9_expert0</title>
<polygon fill="lightblue" stroke="black" points="3112,-8699.77 2990,-8699.77 2990,-8647.77 3112,-8647.77 3112,-8699.77"/>
<text text-anchor="middle" x="3051" y="-8687.77" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3051" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer9_routing&#45;&gt;gpu5_layer9_expert0 -->
<g id="edge1803" class="edge">
<title>gpu5_layer9_routing&#45;&gt;gpu5_layer9_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3205.33,-8748.08C3173.34,-8732.89 3140.34,-8717.21 3113.11,-8704.27"/>
<polygon fill="black" stroke="black" points="3114.26,-8700.95 3103.73,-8699.82 3111.26,-8707.27 3114.26,-8700.95"/>
<text text-anchor="middle" x="3186.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer9_expert1 -->
<g id="node1459" class="node">
<title>gpu5_layer9_expert1</title>
<polygon fill="lightblue" stroke="black" points="3252,-8699.77 3130,-8699.77 3130,-8647.77 3252,-8647.77 3252,-8699.77"/>
<text text-anchor="middle" x="3191" y="-8687.77" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3191" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer9_routing&#45;&gt;gpu5_layer9_expert1 -->
<g id="edge1804" class="edge">
<title>gpu5_layer9_routing&#45;&gt;gpu5_layer9_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3265.51,-8745.56C3251.48,-8732.23 3237.21,-8718.68 3224.97,-8707.04"/>
<polygon fill="black" stroke="black" points="3227.29,-8704.42 3217.63,-8700.07 3222.46,-8709.49 3227.29,-8704.42"/>
<text text-anchor="middle" x="3273.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer9_expert2 -->
<g id="node1460" class="node">
<title>gpu5_layer9_expert2</title>
<polygon fill="lightblue" stroke="black" points="3392,-8699.77 3270,-8699.77 3270,-8647.77 3392,-8647.77 3392,-8699.77"/>
<text text-anchor="middle" x="3331" y="-8687.77" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3331" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer9_routing&#45;&gt;gpu5_layer9_expert2 -->
<g id="edge1805" class="edge">
<title>gpu5_layer9_routing&#45;&gt;gpu5_layer9_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3331,-8745.56C3331,-8733.49 3331,-8721.23 3331,-8710.39"/>
<polygon fill="black" stroke="black" points="3334.5,-8710.07 3331,-8700.07 3327.5,-8710.07 3334.5,-8710.07"/>
<text text-anchor="middle" x="3360.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer9_expert3 -->
<g id="node1461" class="node">
<title>gpu5_layer9_expert3</title>
<polygon fill="lightblue" stroke="black" points="3532,-8699.77 3410,-8699.77 3410,-8647.77 3532,-8647.77 3532,-8699.77"/>
<text text-anchor="middle" x="3471" y="-8687.77" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="3471" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer9_routing&#45;&gt;gpu5_layer9_expert3 -->
<g id="edge1806" class="edge">
<title>gpu5_layer9_routing&#45;&gt;gpu5_layer9_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3396.49,-8745.56C3410.52,-8732.23 3424.79,-8718.68 3437.03,-8707.04"/>
<polygon fill="black" stroke="black" points="3439.54,-8709.49 3444.37,-8700.07 3434.71,-8704.42 3439.54,-8709.49"/>
<text text-anchor="middle" x="3454.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer9_expert_agg -->
<g id="node1462" class="node">
<title>gpu5_layer9_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-8610.77 3256.29,-8610.77 3204.53,-8506.77 3405.71,-8506.77 3457.47,-8610.77"/>
<text text-anchor="middle" x="3331" y="-8572.77" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3331" y="-8561.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-8550.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-8539.77" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer9_routing&#45;&gt;gpu5_layer9_expert_agg -->
<g id="edge1821" class="edge">
<title>gpu5_layer9_routing&#45;&gt;gpu5_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M3420.22,-8780.86C3493.96,-8753.7 3580.6,-8707.31 3541,-8647.77 3520.44,-8616.86 3486.7,-8596.79 3452.22,-8583.76"/>
<polygon fill="black" stroke="black" points="3453.08,-8580.35 3442.48,-8580.27 3450.71,-8586.94 3453.08,-8580.35"/>
</g>
<!-- gpu5_layer9_expert0&#45;&gt;gpu5_layer9_expert_agg -->
<g id="edge1817" class="edge">
<title>gpu5_layer9_expert0&#45;&gt;gpu5_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M3112.1,-8648.12C3148.98,-8633.23 3196.7,-8613.97 3238.16,-8597.24"/>
<polygon fill="black" stroke="black" points="3239.5,-8600.48 3247.46,-8593.49 3236.88,-8593.99 3239.5,-8600.48"/>
</g>
<!-- gpu5_layer9_expert1&#45;&gt;gpu5_layer9_expert_agg -->
<g id="edge1818" class="edge">
<title>gpu5_layer9_expert1&#45;&gt;gpu5_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M3222.07,-8647.7C3233.32,-8638.62 3246.53,-8627.95 3259.8,-8617.24"/>
<polygon fill="black" stroke="black" points="3262.02,-8619.95 3267.6,-8610.95 3257.62,-8614.5 3262.02,-8619.95"/>
</g>
<!-- gpu5_layer9_expert2&#45;&gt;gpu5_layer9_expert_agg -->
<g id="edge1819" class="edge">
<title>gpu5_layer9_expert2&#45;&gt;gpu5_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M3331,-8647.7C3331,-8639.77 3331,-8630.63 3331,-8621.31"/>
<polygon fill="black" stroke="black" points="3334.5,-8621.17 3331,-8611.17 3327.5,-8621.17 3334.5,-8621.17"/>
</g>
<!-- gpu5_layer9_expert3&#45;&gt;gpu5_layer9_expert_agg -->
<g id="edge1820" class="edge">
<title>gpu5_layer9_expert3&#45;&gt;gpu5_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M3439.93,-8647.7C3428.68,-8638.62 3415.47,-8627.95 3402.2,-8617.24"/>
<polygon fill="black" stroke="black" points="3404.38,-8614.5 3394.4,-8610.95 3399.98,-8619.95 3404.38,-8614.5"/>
</g>
<!-- gpu5_layer9_res2 -->
<g id="node1463" class="node">
<title>gpu5_layer9_res2</title>
<polygon fill="lightblue" stroke="black" points="3392,-8469.77 3270,-8469.77 3270,-8417.77 3392,-8417.77 3392,-8469.77"/>
<text text-anchor="middle" x="3331" y="-8457.77" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3331" y="-8446.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-8435.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-8424.77" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer9_expert_agg&#45;&gt;gpu5_layer9_res2 -->
<g id="edge1822" class="edge">
<title>gpu5_layer9_expert_agg&#45;&gt;gpu5_layer9_res2</title>
<path fill="none" stroke="black" d="M3331,-8506.56C3331,-8497.61 3331,-8488.48 3331,-8480.08"/>
<polygon fill="black" stroke="black" points="3334.5,-8479.9 3331,-8469.9 3327.5,-8479.9 3334.5,-8479.9"/>
</g>
<!-- gpu5_layer10_ln1 -->
<g id="node1464" class="node">
<title>gpu5_layer10_ln1</title>
<polygon fill="lightblue" stroke="black" points="3392,-8380.77 3270,-8380.77 3270,-8328.77 3392,-8328.77 3392,-8380.77"/>
<text text-anchor="middle" x="3331" y="-8368.77" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3331" y="-8357.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-8346.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-8335.77" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer9_res2&#45;&gt;gpu5_layer10_ln1 -->
<g id="edge1827" class="edge">
<title>gpu5_layer9_res2&#45;&gt;gpu5_layer10_ln1</title>
<path fill="none" stroke="black" d="M3331,-8417.61C3331,-8409.31 3331,-8399.93 3331,-8391.02"/>
<polygon fill="black" stroke="black" points="3334.5,-8390.88 3331,-8380.88 3327.5,-8390.88 3334.5,-8390.88"/>
</g>
<!-- gpu5_layer10_qkv -->
<g id="node1465" class="node">
<title>gpu5_layer10_qkv</title>
<polygon fill="lightblue" stroke="black" points="3392,-8291.77 3270,-8291.77 3270,-8239.77 3392,-8239.77 3392,-8291.77"/>
<text text-anchor="middle" x="3331" y="-8279.77" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3331" y="-8268.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-8257.77" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-8246.77" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer10_ln1&#45;&gt;gpu5_layer10_qkv -->
<g id="edge1828" class="edge">
<title>gpu5_layer10_ln1&#45;&gt;gpu5_layer10_qkv</title>
<path fill="none" stroke="black" d="M3331,-8328.61C3331,-8320.31 3331,-8310.93 3331,-8302.02"/>
<polygon fill="black" stroke="black" points="3334.5,-8301.88 3331,-8291.88 3327.5,-8301.88 3334.5,-8301.88"/>
</g>
<!-- gpu5_layer10_reshape -->
<g id="node1466" class="node">
<title>gpu5_layer10_reshape</title>
<polygon fill="lightblue" stroke="black" points="3395,-8202.77 3267,-8202.77 3267,-8150.77 3395,-8150.77 3395,-8202.77"/>
<text text-anchor="middle" x="3331" y="-8190.77" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3331" y="-8179.77" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-8168.77" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-8157.77" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer10_qkv&#45;&gt;gpu5_layer10_reshape -->
<g id="edge1829" class="edge">
<title>gpu5_layer10_qkv&#45;&gt;gpu5_layer10_reshape</title>
<path fill="none" stroke="black" d="M3331,-8239.61C3331,-8231.31 3331,-8221.93 3331,-8213.02"/>
<polygon fill="black" stroke="black" points="3334.5,-8212.88 3331,-8202.88 3327.5,-8212.88 3334.5,-8212.88"/>
</g>
<!-- gpu5_layer10_attn -->
<g id="node1467" class="node">
<title>gpu5_layer10_attn</title>
<polygon fill="lightblue" stroke="black" points="3395,-8113.77 3267,-8113.77 3267,-8061.77 3395,-8061.77 3395,-8113.77"/>
<text text-anchor="middle" x="3331" y="-8101.77" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3331" y="-8090.77" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-8079.77" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-8068.77" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer10_reshape&#45;&gt;gpu5_layer10_attn -->
<g id="edge1830" class="edge">
<title>gpu5_layer10_reshape&#45;&gt;gpu5_layer10_attn</title>
<path fill="none" stroke="black" d="M3331,-8150.61C3331,-8142.31 3331,-8132.93 3331,-8124.02"/>
<polygon fill="black" stroke="black" points="3334.5,-8123.88 3331,-8113.88 3327.5,-8123.88 3334.5,-8123.88"/>
</g>
<!-- gpu5_layer10_attn_reshape -->
<g id="node1469" class="node">
<title>gpu5_layer10_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3392,-8024.77 3270,-8024.77 3270,-7972.77 3392,-7972.77 3392,-8024.77"/>
<text text-anchor="middle" x="3331" y="-8012.77" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3331" y="-8001.77" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-7990.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-7979.77" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer10_attn&#45;&gt;gpu5_layer10_attn_reshape -->
<g id="edge1831" class="edge">
<title>gpu5_layer10_attn&#45;&gt;gpu5_layer10_attn_reshape</title>
<path fill="none" stroke="black" d="M3331,-8061.61C3331,-8053.31 3331,-8043.93 3331,-8035.02"/>
<polygon fill="black" stroke="black" points="3334.5,-8034.88 3331,-8024.88 3327.5,-8034.88 3334.5,-8034.88"/>
</g>
<!-- gpu5_layer10_attn_out -->
<g id="node1468" class="node">
<title>gpu5_layer10_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3392,-7935.77 3270,-7935.77 3270,-7883.77 3392,-7883.77 3392,-7935.77"/>
<text text-anchor="middle" x="3331" y="-7923.77" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3331" y="-7912.77" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-7901.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-7890.77" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer10_kv_update -->
<g id="node1470" class="node">
<title>gpu5_layer10_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3331" cy="-7810" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3331" y="-7824" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3331" y="-7813" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-7802" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-7791" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer10_attn_out&#45;&gt;gpu5_layer10_kv_update -->
<g id="edge1833" class="edge">
<title>gpu5_layer10_attn_out&#45;&gt;gpu5_layer10_kv_update</title>
<path fill="none" stroke="black" d="M3331,-7883.6C3331,-7875.46 3331,-7866.16 3331,-7857"/>
<polygon fill="black" stroke="black" points="3334.5,-7856.78 3331,-7846.78 3327.5,-7856.78 3334.5,-7856.78"/>
</g>
<!-- gpu5_layer10_attn_reshape&#45;&gt;gpu5_layer10_attn_out -->
<g id="edge1832" class="edge">
<title>gpu5_layer10_attn_reshape&#45;&gt;gpu5_layer10_attn_out</title>
<path fill="none" stroke="black" d="M3331,-7972.61C3331,-7964.31 3331,-7954.93 3331,-7946.02"/>
<polygon fill="black" stroke="black" points="3334.5,-7945.88 3331,-7935.88 3327.5,-7945.88 3334.5,-7945.88"/>
</g>
<!-- gpu5_layer10_res1 -->
<g id="node1471" class="node">
<title>gpu5_layer10_res1</title>
<polygon fill="lightblue" stroke="black" points="3392,-7736.23 3270,-7736.23 3270,-7684.23 3392,-7684.23 3392,-7736.23"/>
<text text-anchor="middle" x="3331" y="-7724.23" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3331" y="-7713.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-7702.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-7691.23" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer10_kv_update&#45;&gt;gpu5_layer10_res1 -->
<g id="edge1834" class="edge">
<title>gpu5_layer10_kv_update&#45;&gt;gpu5_layer10_res1</title>
<path fill="none" stroke="black" d="M3331,-7773.15C3331,-7764.47 3331,-7755.2 3331,-7746.55"/>
<polygon fill="black" stroke="black" points="3334.5,-7746.38 3331,-7736.38 3327.5,-7746.38 3334.5,-7746.38"/>
</g>
<!-- gpu5_layer10_ln2 -->
<g id="node1472" class="node">
<title>gpu5_layer10_ln2</title>
<polygon fill="lightblue" stroke="black" points="3392,-7647.23 3270,-7647.23 3270,-7595.23 3392,-7595.23 3392,-7647.23"/>
<text text-anchor="middle" x="3331" y="-7635.23" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3331" y="-7624.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-7613.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-7602.23" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer10_res1&#45;&gt;gpu5_layer10_ln2 -->
<g id="edge1835" class="edge">
<title>gpu5_layer10_res1&#45;&gt;gpu5_layer10_ln2</title>
<path fill="none" stroke="black" d="M3331,-7684.07C3331,-7675.77 3331,-7666.39 3331,-7657.48"/>
<polygon fill="black" stroke="black" points="3334.5,-7657.34 3331,-7647.34 3327.5,-7657.34 3334.5,-7657.34"/>
</g>
<!-- gpu5_layer10_routing -->
<g id="node1473" class="node">
<title>gpu5_layer10_routing</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-7558.23 3256.29,-7558.23 3204.53,-7432.23 3405.71,-7432.23 3457.47,-7558.23"/>
<text text-anchor="middle" x="3331" y="-7514.73" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3331" y="-7503.73" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-7492.73" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-7481.73" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3331" y="-7470.73" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer10_ln2&#45;&gt;gpu5_layer10_routing -->
<g id="edge1836" class="edge">
<title>gpu5_layer10_ln2&#45;&gt;gpu5_layer10_routing</title>
<path fill="none" stroke="black" d="M3331,-7595.14C3331,-7587.21 3331,-7578.01 3331,-7568.48"/>
<polygon fill="black" stroke="black" points="3334.5,-7568.47 3331,-7558.47 3327.5,-7568.47 3334.5,-7568.47"/>
</g>
<!-- gpu5_layer10_expert0 -->
<g id="node1474" class="node">
<title>gpu5_layer10_expert0</title>
<polygon fill="lightblue" stroke="black" points="3112,-7386.23 2990,-7386.23 2990,-7334.23 3112,-7334.23 3112,-7386.23"/>
<text text-anchor="middle" x="3051" y="-7374.23" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3051" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer10_routing&#45;&gt;gpu5_layer10_expert0 -->
<g id="edge1823" class="edge">
<title>gpu5_layer10_routing&#45;&gt;gpu5_layer10_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3205.33,-7434.54C3173.34,-7419.35 3140.34,-7403.67 3113.11,-7390.74"/>
<polygon fill="black" stroke="black" points="3114.26,-7387.41 3103.73,-7386.28 3111.26,-7393.73 3114.26,-7387.41"/>
<text text-anchor="middle" x="3186.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer10_expert1 -->
<g id="node1475" class="node">
<title>gpu5_layer10_expert1</title>
<polygon fill="lightblue" stroke="black" points="3252,-7386.23 3130,-7386.23 3130,-7334.23 3252,-7334.23 3252,-7386.23"/>
<text text-anchor="middle" x="3191" y="-7374.23" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3191" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer10_routing&#45;&gt;gpu5_layer10_expert1 -->
<g id="edge1824" class="edge">
<title>gpu5_layer10_routing&#45;&gt;gpu5_layer10_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3265.51,-7432.02C3251.48,-7418.69 3237.21,-7405.14 3224.97,-7393.5"/>
<polygon fill="black" stroke="black" points="3227.29,-7390.88 3217.63,-7386.53 3222.46,-7395.95 3227.29,-7390.88"/>
<text text-anchor="middle" x="3273.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer10_expert2 -->
<g id="node1476" class="node">
<title>gpu5_layer10_expert2</title>
<polygon fill="lightblue" stroke="black" points="3392,-7386.23 3270,-7386.23 3270,-7334.23 3392,-7334.23 3392,-7386.23"/>
<text text-anchor="middle" x="3331" y="-7374.23" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3331" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer10_routing&#45;&gt;gpu5_layer10_expert2 -->
<g id="edge1825" class="edge">
<title>gpu5_layer10_routing&#45;&gt;gpu5_layer10_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3331,-7432.02C3331,-7419.95 3331,-7407.69 3331,-7396.85"/>
<polygon fill="black" stroke="black" points="3334.5,-7396.53 3331,-7386.53 3327.5,-7396.53 3334.5,-7396.53"/>
<text text-anchor="middle" x="3360.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer10_expert3 -->
<g id="node1477" class="node">
<title>gpu5_layer10_expert3</title>
<polygon fill="lightblue" stroke="black" points="3532,-7386.23 3410,-7386.23 3410,-7334.23 3532,-7334.23 3532,-7386.23"/>
<text text-anchor="middle" x="3471" y="-7374.23" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="3471" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer10_routing&#45;&gt;gpu5_layer10_expert3 -->
<g id="edge1826" class="edge">
<title>gpu5_layer10_routing&#45;&gt;gpu5_layer10_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3396.49,-7432.02C3410.52,-7418.69 3424.79,-7405.14 3437.03,-7393.5"/>
<polygon fill="black" stroke="black" points="3439.54,-7395.95 3444.37,-7386.53 3434.71,-7390.88 3439.54,-7395.95"/>
<text text-anchor="middle" x="3454.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer10_expert_agg -->
<g id="node1478" class="node">
<title>gpu5_layer10_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-7297.23 3256.29,-7297.23 3204.53,-7193.23 3405.71,-7193.23 3457.47,-7297.23"/>
<text text-anchor="middle" x="3331" y="-7259.23" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3331" y="-7248.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-7237.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-7226.23" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer10_routing&#45;&gt;gpu5_layer10_expert_agg -->
<g id="edge1841" class="edge">
<title>gpu5_layer10_routing&#45;&gt;gpu5_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M3420.22,-7467.32C3493.96,-7440.16 3580.6,-7393.77 3541,-7334.23 3520.44,-7303.32 3486.7,-7283.25 3452.22,-7270.22"/>
<polygon fill="black" stroke="black" points="3453.08,-7266.81 3442.48,-7266.73 3450.71,-7273.4 3453.08,-7266.81"/>
</g>
<!-- gpu5_layer10_expert0&#45;&gt;gpu5_layer10_expert_agg -->
<g id="edge1837" class="edge">
<title>gpu5_layer10_expert0&#45;&gt;gpu5_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M3112.1,-7334.58C3148.98,-7319.69 3196.7,-7300.44 3238.16,-7283.7"/>
<polygon fill="black" stroke="black" points="3239.5,-7286.94 3247.46,-7279.95 3236.88,-7280.45 3239.5,-7286.94"/>
</g>
<!-- gpu5_layer10_expert1&#45;&gt;gpu5_layer10_expert_agg -->
<g id="edge1838" class="edge">
<title>gpu5_layer10_expert1&#45;&gt;gpu5_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M3222.07,-7334.16C3233.32,-7325.08 3246.53,-7314.42 3259.8,-7303.71"/>
<polygon fill="black" stroke="black" points="3262.02,-7306.41 3267.6,-7297.41 3257.62,-7300.96 3262.02,-7306.41"/>
</g>
<!-- gpu5_layer10_expert2&#45;&gt;gpu5_layer10_expert_agg -->
<g id="edge1839" class="edge">
<title>gpu5_layer10_expert2&#45;&gt;gpu5_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M3331,-7334.16C3331,-7326.23 3331,-7317.09 3331,-7307.77"/>
<polygon fill="black" stroke="black" points="3334.5,-7307.64 3331,-7297.64 3327.5,-7307.64 3334.5,-7307.64"/>
</g>
<!-- gpu5_layer10_expert3&#45;&gt;gpu5_layer10_expert_agg -->
<g id="edge1840" class="edge">
<title>gpu5_layer10_expert3&#45;&gt;gpu5_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M3439.93,-7334.16C3428.68,-7325.08 3415.47,-7314.42 3402.2,-7303.71"/>
<polygon fill="black" stroke="black" points="3404.38,-7300.96 3394.4,-7297.41 3399.98,-7306.41 3404.38,-7300.96"/>
</g>
<!-- gpu5_layer10_res2 -->
<g id="node1479" class="node">
<title>gpu5_layer10_res2</title>
<polygon fill="lightblue" stroke="black" points="3392,-7156.23 3270,-7156.23 3270,-7104.23 3392,-7104.23 3392,-7156.23"/>
<text text-anchor="middle" x="3331" y="-7144.23" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3331" y="-7133.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-7122.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-7111.23" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer10_expert_agg&#45;&gt;gpu5_layer10_res2 -->
<g id="edge1842" class="edge">
<title>gpu5_layer10_expert_agg&#45;&gt;gpu5_layer10_res2</title>
<path fill="none" stroke="black" d="M3331,-7193.02C3331,-7184.07 3331,-7174.94 3331,-7166.55"/>
<polygon fill="black" stroke="black" points="3334.5,-7166.37 3331,-7156.37 3327.5,-7166.37 3334.5,-7166.37"/>
</g>
<!-- gpu5_layer11_ln1 -->
<g id="node1480" class="node">
<title>gpu5_layer11_ln1</title>
<polygon fill="lightblue" stroke="black" points="3392,-7067.23 3270,-7067.23 3270,-7015.23 3392,-7015.23 3392,-7067.23"/>
<text text-anchor="middle" x="3331" y="-7055.23" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3331" y="-7044.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-7033.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-7022.23" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer10_res2&#45;&gt;gpu5_layer11_ln1 -->
<g id="edge1847" class="edge">
<title>gpu5_layer10_res2&#45;&gt;gpu5_layer11_ln1</title>
<path fill="none" stroke="black" d="M3331,-7104.07C3331,-7095.77 3331,-7086.39 3331,-7077.48"/>
<polygon fill="black" stroke="black" points="3334.5,-7077.34 3331,-7067.34 3327.5,-7077.34 3334.5,-7077.34"/>
</g>
<!-- gpu5_layer11_qkv -->
<g id="node1481" class="node">
<title>gpu5_layer11_qkv</title>
<polygon fill="lightblue" stroke="black" points="3392,-6978.23 3270,-6978.23 3270,-6926.23 3392,-6926.23 3392,-6978.23"/>
<text text-anchor="middle" x="3331" y="-6966.23" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3331" y="-6955.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-6944.23" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-6933.23" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer11_ln1&#45;&gt;gpu5_layer11_qkv -->
<g id="edge1848" class="edge">
<title>gpu5_layer11_ln1&#45;&gt;gpu5_layer11_qkv</title>
<path fill="none" stroke="black" d="M3331,-7015.07C3331,-7006.77 3331,-6997.39 3331,-6988.48"/>
<polygon fill="black" stroke="black" points="3334.5,-6988.34 3331,-6978.34 3327.5,-6988.34 3334.5,-6988.34"/>
</g>
<!-- gpu5_layer11_reshape -->
<g id="node1482" class="node">
<title>gpu5_layer11_reshape</title>
<polygon fill="lightblue" stroke="black" points="3395,-6889.23 3267,-6889.23 3267,-6837.23 3395,-6837.23 3395,-6889.23"/>
<text text-anchor="middle" x="3331" y="-6877.23" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3331" y="-6866.23" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-6855.23" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-6844.23" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer11_qkv&#45;&gt;gpu5_layer11_reshape -->
<g id="edge1849" class="edge">
<title>gpu5_layer11_qkv&#45;&gt;gpu5_layer11_reshape</title>
<path fill="none" stroke="black" d="M3331,-6926.07C3331,-6917.77 3331,-6908.39 3331,-6899.48"/>
<polygon fill="black" stroke="black" points="3334.5,-6899.34 3331,-6889.34 3327.5,-6899.34 3334.5,-6899.34"/>
</g>
<!-- gpu5_layer11_attn -->
<g id="node1483" class="node">
<title>gpu5_layer11_attn</title>
<polygon fill="lightblue" stroke="black" points="3395,-6800.23 3267,-6800.23 3267,-6748.23 3395,-6748.23 3395,-6800.23"/>
<text text-anchor="middle" x="3331" y="-6788.23" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3331" y="-6777.23" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-6766.23" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-6755.23" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer11_reshape&#45;&gt;gpu5_layer11_attn -->
<g id="edge1850" class="edge">
<title>gpu5_layer11_reshape&#45;&gt;gpu5_layer11_attn</title>
<path fill="none" stroke="black" d="M3331,-6837.07C3331,-6828.77 3331,-6819.39 3331,-6810.48"/>
<polygon fill="black" stroke="black" points="3334.5,-6810.34 3331,-6800.34 3327.5,-6810.34 3334.5,-6810.34"/>
</g>
<!-- gpu5_layer11_attn_reshape -->
<g id="node1485" class="node">
<title>gpu5_layer11_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3392,-6711.23 3270,-6711.23 3270,-6659.23 3392,-6659.23 3392,-6711.23"/>
<text text-anchor="middle" x="3331" y="-6699.23" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3331" y="-6688.23" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-6677.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-6666.23" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer11_attn&#45;&gt;gpu5_layer11_attn_reshape -->
<g id="edge1851" class="edge">
<title>gpu5_layer11_attn&#45;&gt;gpu5_layer11_attn_reshape</title>
<path fill="none" stroke="black" d="M3331,-6748.07C3331,-6739.77 3331,-6730.39 3331,-6721.48"/>
<polygon fill="black" stroke="black" points="3334.5,-6721.34 3331,-6711.34 3327.5,-6721.34 3334.5,-6721.34"/>
</g>
<!-- gpu5_layer11_attn_out -->
<g id="node1484" class="node">
<title>gpu5_layer11_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3392,-6622.23 3270,-6622.23 3270,-6570.23 3392,-6570.23 3392,-6622.23"/>
<text text-anchor="middle" x="3331" y="-6610.23" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3331" y="-6599.23" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-6588.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-6577.23" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer11_kv_update -->
<g id="node1486" class="node">
<title>gpu5_layer11_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3331" cy="-6496.47" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3331" y="-6510.47" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3331" y="-6499.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-6488.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-6477.47" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer11_attn_out&#45;&gt;gpu5_layer11_kv_update -->
<g id="edge1853" class="edge">
<title>gpu5_layer11_attn_out&#45;&gt;gpu5_layer11_kv_update</title>
<path fill="none" stroke="black" d="M3331,-6570.06C3331,-6561.92 3331,-6552.62 3331,-6543.46"/>
<polygon fill="black" stroke="black" points="3334.5,-6543.24 3331,-6533.24 3327.5,-6543.24 3334.5,-6543.24"/>
</g>
<!-- gpu5_layer11_attn_reshape&#45;&gt;gpu5_layer11_attn_out -->
<g id="edge1852" class="edge">
<title>gpu5_layer11_attn_reshape&#45;&gt;gpu5_layer11_attn_out</title>
<path fill="none" stroke="black" d="M3331,-6659.07C3331,-6650.77 3331,-6641.39 3331,-6632.48"/>
<polygon fill="black" stroke="black" points="3334.5,-6632.34 3331,-6622.34 3327.5,-6632.34 3334.5,-6632.34"/>
</g>
<!-- gpu5_layer11_res1 -->
<g id="node1487" class="node">
<title>gpu5_layer11_res1</title>
<polygon fill="lightblue" stroke="black" points="3392,-6422.7 3270,-6422.7 3270,-6370.7 3392,-6370.7 3392,-6422.7"/>
<text text-anchor="middle" x="3331" y="-6410.7" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3331" y="-6399.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-6388.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-6377.7" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer11_kv_update&#45;&gt;gpu5_layer11_res1 -->
<g id="edge1854" class="edge">
<title>gpu5_layer11_kv_update&#45;&gt;gpu5_layer11_res1</title>
<path fill="none" stroke="black" d="M3331,-6459.61C3331,-6450.94 3331,-6441.67 3331,-6433.01"/>
<polygon fill="black" stroke="black" points="3334.5,-6432.84 3331,-6422.84 3327.5,-6432.84 3334.5,-6432.84"/>
</g>
<!-- gpu5_layer11_ln2 -->
<g id="node1488" class="node">
<title>gpu5_layer11_ln2</title>
<polygon fill="lightblue" stroke="black" points="3392,-6333.7 3270,-6333.7 3270,-6281.7 3392,-6281.7 3392,-6333.7"/>
<text text-anchor="middle" x="3331" y="-6321.7" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3331" y="-6310.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-6299.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-6288.7" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer11_res1&#45;&gt;gpu5_layer11_ln2 -->
<g id="edge1855" class="edge">
<title>gpu5_layer11_res1&#45;&gt;gpu5_layer11_ln2</title>
<path fill="none" stroke="black" d="M3331,-6370.53C3331,-6362.24 3331,-6352.85 3331,-6343.94"/>
<polygon fill="black" stroke="black" points="3334.5,-6343.8 3331,-6333.8 3327.5,-6343.8 3334.5,-6343.8"/>
</g>
<!-- gpu5_layer11_routing -->
<g id="node1489" class="node">
<title>gpu5_layer11_routing</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-6244.7 3256.29,-6244.7 3204.53,-6118.7 3405.71,-6118.7 3457.47,-6244.7"/>
<text text-anchor="middle" x="3331" y="-6201.2" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3331" y="-6190.2" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-6179.2" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-6168.2" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3331" y="-6157.2" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer11_ln2&#45;&gt;gpu5_layer11_routing -->
<g id="edge1856" class="edge">
<title>gpu5_layer11_ln2&#45;&gt;gpu5_layer11_routing</title>
<path fill="none" stroke="black" d="M3331,-6281.6C3331,-6273.67 3331,-6264.47 3331,-6254.94"/>
<polygon fill="black" stroke="black" points="3334.5,-6254.93 3331,-6244.93 3327.5,-6254.93 3334.5,-6254.93"/>
</g>
<!-- gpu5_layer11_expert0 -->
<g id="node1490" class="node">
<title>gpu5_layer11_expert0</title>
<polygon fill="lightblue" stroke="black" points="3112,-6072.7 2990,-6072.7 2990,-6020.7 3112,-6020.7 3112,-6072.7"/>
<text text-anchor="middle" x="3051" y="-6060.7" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3051" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer11_routing&#45;&gt;gpu5_layer11_expert0 -->
<g id="edge1843" class="edge">
<title>gpu5_layer11_routing&#45;&gt;gpu5_layer11_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3205.33,-6121C3173.34,-6105.81 3140.34,-6090.13 3113.11,-6077.2"/>
<polygon fill="black" stroke="black" points="3114.26,-6073.87 3103.73,-6072.74 3111.26,-6080.19 3114.26,-6073.87"/>
<text text-anchor="middle" x="3186.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer11_expert1 -->
<g id="node1491" class="node">
<title>gpu5_layer11_expert1</title>
<polygon fill="lightblue" stroke="black" points="3252,-6072.7 3130,-6072.7 3130,-6020.7 3252,-6020.7 3252,-6072.7"/>
<text text-anchor="middle" x="3191" y="-6060.7" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3191" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer11_routing&#45;&gt;gpu5_layer11_expert1 -->
<g id="edge1844" class="edge">
<title>gpu5_layer11_routing&#45;&gt;gpu5_layer11_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3265.51,-6118.48C3251.48,-6105.15 3237.21,-6091.6 3224.97,-6079.97"/>
<polygon fill="black" stroke="black" points="3227.29,-6077.34 3217.63,-6072.99 3222.46,-6082.41 3227.29,-6077.34"/>
<text text-anchor="middle" x="3273.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer11_expert2 -->
<g id="node1492" class="node">
<title>gpu5_layer11_expert2</title>
<polygon fill="lightblue" stroke="black" points="3392,-6072.7 3270,-6072.7 3270,-6020.7 3392,-6020.7 3392,-6072.7"/>
<text text-anchor="middle" x="3331" y="-6060.7" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3331" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer11_routing&#45;&gt;gpu5_layer11_expert2 -->
<g id="edge1845" class="edge">
<title>gpu5_layer11_routing&#45;&gt;gpu5_layer11_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3331,-6118.48C3331,-6106.41 3331,-6094.15 3331,-6083.31"/>
<polygon fill="black" stroke="black" points="3334.5,-6082.99 3331,-6072.99 3327.5,-6082.99 3334.5,-6082.99"/>
<text text-anchor="middle" x="3360.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer11_expert3 -->
<g id="node1493" class="node">
<title>gpu5_layer11_expert3</title>
<polygon fill="lightblue" stroke="black" points="3532,-6072.7 3410,-6072.7 3410,-6020.7 3532,-6020.7 3532,-6072.7"/>
<text text-anchor="middle" x="3471" y="-6060.7" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="3471" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer11_routing&#45;&gt;gpu5_layer11_expert3 -->
<g id="edge1846" class="edge">
<title>gpu5_layer11_routing&#45;&gt;gpu5_layer11_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3396.49,-6118.48C3410.52,-6105.15 3424.79,-6091.6 3437.03,-6079.97"/>
<polygon fill="black" stroke="black" points="3439.54,-6082.41 3444.37,-6072.99 3434.71,-6077.34 3439.54,-6082.41"/>
<text text-anchor="middle" x="3454.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer11_expert_agg -->
<g id="node1494" class="node">
<title>gpu5_layer11_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-5983.7 3256.29,-5983.7 3204.53,-5879.7 3405.71,-5879.7 3457.47,-5983.7"/>
<text text-anchor="middle" x="3331" y="-5945.7" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3331" y="-5934.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-5923.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-5912.7" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer11_routing&#45;&gt;gpu5_layer11_expert_agg -->
<g id="edge1861" class="edge">
<title>gpu5_layer11_routing&#45;&gt;gpu5_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M3420.22,-6153.78C3493.96,-6126.62 3580.6,-6080.23 3541,-6020.7 3520.44,-5989.78 3486.7,-5969.71 3452.22,-5956.68"/>
<polygon fill="black" stroke="black" points="3453.08,-5953.27 3442.48,-5953.19 3450.71,-5959.86 3453.08,-5953.27"/>
</g>
<!-- gpu5_layer11_expert0&#45;&gt;gpu5_layer11_expert_agg -->
<g id="edge1857" class="edge">
<title>gpu5_layer11_expert0&#45;&gt;gpu5_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M3112.1,-6021.04C3148.98,-6006.15 3196.7,-5986.9 3238.16,-5970.16"/>
<polygon fill="black" stroke="black" points="3239.5,-5973.4 3247.46,-5966.41 3236.88,-5966.91 3239.5,-5973.4"/>
</g>
<!-- gpu5_layer11_expert1&#45;&gt;gpu5_layer11_expert_agg -->
<g id="edge1858" class="edge">
<title>gpu5_layer11_expert1&#45;&gt;gpu5_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M3222.07,-6020.62C3233.32,-6011.54 3246.53,-6000.88 3259.8,-5990.17"/>
<polygon fill="black" stroke="black" points="3262.02,-5992.87 3267.6,-5983.87 3257.62,-5987.42 3262.02,-5992.87"/>
</g>
<!-- gpu5_layer11_expert2&#45;&gt;gpu5_layer11_expert_agg -->
<g id="edge1859" class="edge">
<title>gpu5_layer11_expert2&#45;&gt;gpu5_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M3331,-6020.62C3331,-6012.69 3331,-6003.55 3331,-5994.23"/>
<polygon fill="black" stroke="black" points="3334.5,-5994.1 3331,-5984.1 3327.5,-5994.1 3334.5,-5994.1"/>
</g>
<!-- gpu5_layer11_expert3&#45;&gt;gpu5_layer11_expert_agg -->
<g id="edge1860" class="edge">
<title>gpu5_layer11_expert3&#45;&gt;gpu5_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M3439.93,-6020.62C3428.68,-6011.54 3415.47,-6000.88 3402.2,-5990.17"/>
<polygon fill="black" stroke="black" points="3404.38,-5987.42 3394.4,-5983.87 3399.98,-5992.87 3404.38,-5987.42"/>
</g>
<!-- gpu5_layer11_res2 -->
<g id="node1495" class="node">
<title>gpu5_layer11_res2</title>
<polygon fill="lightblue" stroke="black" points="3392,-5842.7 3270,-5842.7 3270,-5790.7 3392,-5790.7 3392,-5842.7"/>
<text text-anchor="middle" x="3331" y="-5830.7" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3331" y="-5819.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-5808.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-5797.7" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer11_expert_agg&#45;&gt;gpu5_layer11_res2 -->
<g id="edge1862" class="edge">
<title>gpu5_layer11_expert_agg&#45;&gt;gpu5_layer11_res2</title>
<path fill="none" stroke="black" d="M3331,-5879.49C3331,-5870.53 3331,-5861.41 3331,-5853.01"/>
<polygon fill="black" stroke="black" points="3334.5,-5852.83 3331,-5842.83 3327.5,-5852.83 3334.5,-5852.83"/>
</g>
<!-- gpu5_layer12_ln1 -->
<g id="node1496" class="node">
<title>gpu5_layer12_ln1</title>
<polygon fill="lightblue" stroke="black" points="3392,-5753.7 3270,-5753.7 3270,-5701.7 3392,-5701.7 3392,-5753.7"/>
<text text-anchor="middle" x="3331" y="-5741.7" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3331" y="-5730.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-5719.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-5708.7" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer11_res2&#45;&gt;gpu5_layer12_ln1 -->
<g id="edge1867" class="edge">
<title>gpu5_layer11_res2&#45;&gt;gpu5_layer12_ln1</title>
<path fill="none" stroke="black" d="M3331,-5790.53C3331,-5782.24 3331,-5772.85 3331,-5763.94"/>
<polygon fill="black" stroke="black" points="3334.5,-5763.8 3331,-5753.8 3327.5,-5763.8 3334.5,-5763.8"/>
</g>
<!-- gpu5_layer12_qkv -->
<g id="node1497" class="node">
<title>gpu5_layer12_qkv</title>
<polygon fill="lightblue" stroke="black" points="3392,-5664.7 3270,-5664.7 3270,-5612.7 3392,-5612.7 3392,-5664.7"/>
<text text-anchor="middle" x="3331" y="-5652.7" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3331" y="-5641.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-5630.7" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-5619.7" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer12_ln1&#45;&gt;gpu5_layer12_qkv -->
<g id="edge1868" class="edge">
<title>gpu5_layer12_ln1&#45;&gt;gpu5_layer12_qkv</title>
<path fill="none" stroke="black" d="M3331,-5701.53C3331,-5693.24 3331,-5683.85 3331,-5674.94"/>
<polygon fill="black" stroke="black" points="3334.5,-5674.8 3331,-5664.8 3327.5,-5674.8 3334.5,-5674.8"/>
</g>
<!-- gpu5_layer12_reshape -->
<g id="node1498" class="node">
<title>gpu5_layer12_reshape</title>
<polygon fill="lightblue" stroke="black" points="3395,-5575.7 3267,-5575.7 3267,-5523.7 3395,-5523.7 3395,-5575.7"/>
<text text-anchor="middle" x="3331" y="-5563.7" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3331" y="-5552.7" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-5541.7" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-5530.7" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer12_qkv&#45;&gt;gpu5_layer12_reshape -->
<g id="edge1869" class="edge">
<title>gpu5_layer12_qkv&#45;&gt;gpu5_layer12_reshape</title>
<path fill="none" stroke="black" d="M3331,-5612.53C3331,-5604.24 3331,-5594.85 3331,-5585.94"/>
<polygon fill="black" stroke="black" points="3334.5,-5585.8 3331,-5575.8 3327.5,-5585.8 3334.5,-5585.8"/>
</g>
<!-- gpu5_layer12_attn -->
<g id="node1499" class="node">
<title>gpu5_layer12_attn</title>
<polygon fill="lightblue" stroke="black" points="3395,-5486.7 3267,-5486.7 3267,-5434.7 3395,-5434.7 3395,-5486.7"/>
<text text-anchor="middle" x="3331" y="-5474.7" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3331" y="-5463.7" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-5452.7" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-5441.7" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer12_reshape&#45;&gt;gpu5_layer12_attn -->
<g id="edge1870" class="edge">
<title>gpu5_layer12_reshape&#45;&gt;gpu5_layer12_attn</title>
<path fill="none" stroke="black" d="M3331,-5523.53C3331,-5515.24 3331,-5505.85 3331,-5496.94"/>
<polygon fill="black" stroke="black" points="3334.5,-5496.8 3331,-5486.8 3327.5,-5496.8 3334.5,-5496.8"/>
</g>
<!-- gpu5_layer12_attn_reshape -->
<g id="node1501" class="node">
<title>gpu5_layer12_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3392,-5397.7 3270,-5397.7 3270,-5345.7 3392,-5345.7 3392,-5397.7"/>
<text text-anchor="middle" x="3331" y="-5385.7" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3331" y="-5374.7" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-5363.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-5352.7" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer12_attn&#45;&gt;gpu5_layer12_attn_reshape -->
<g id="edge1871" class="edge">
<title>gpu5_layer12_attn&#45;&gt;gpu5_layer12_attn_reshape</title>
<path fill="none" stroke="black" d="M3331,-5434.53C3331,-5426.24 3331,-5416.85 3331,-5407.94"/>
<polygon fill="black" stroke="black" points="3334.5,-5407.8 3331,-5397.8 3327.5,-5407.8 3334.5,-5407.8"/>
</g>
<!-- gpu5_layer12_attn_out -->
<g id="node1500" class="node">
<title>gpu5_layer12_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3392,-5308.7 3270,-5308.7 3270,-5256.7 3392,-5256.7 3392,-5308.7"/>
<text text-anchor="middle" x="3331" y="-5296.7" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3331" y="-5285.7" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-5274.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-5263.7" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer12_kv_update -->
<g id="node1502" class="node">
<title>gpu5_layer12_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3331" cy="-5182.93" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3331" y="-5196.93" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3331" y="-5185.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-5174.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-5163.93" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer12_attn_out&#45;&gt;gpu5_layer12_kv_update -->
<g id="edge1873" class="edge">
<title>gpu5_layer12_attn_out&#45;&gt;gpu5_layer12_kv_update</title>
<path fill="none" stroke="black" d="M3331,-5256.52C3331,-5248.38 3331,-5239.08 3331,-5229.92"/>
<polygon fill="black" stroke="black" points="3334.5,-5229.71 3331,-5219.71 3327.5,-5229.71 3334.5,-5229.71"/>
</g>
<!-- gpu5_layer12_attn_reshape&#45;&gt;gpu5_layer12_attn_out -->
<g id="edge1872" class="edge">
<title>gpu5_layer12_attn_reshape&#45;&gt;gpu5_layer12_attn_out</title>
<path fill="none" stroke="black" d="M3331,-5345.53C3331,-5337.24 3331,-5327.85 3331,-5318.94"/>
<polygon fill="black" stroke="black" points="3334.5,-5318.8 3331,-5308.8 3327.5,-5318.8 3334.5,-5318.8"/>
</g>
<!-- gpu5_layer12_res1 -->
<g id="node1503" class="node">
<title>gpu5_layer12_res1</title>
<polygon fill="lightblue" stroke="black" points="3392,-5109.16 3270,-5109.16 3270,-5057.16 3392,-5057.16 3392,-5109.16"/>
<text text-anchor="middle" x="3331" y="-5097.16" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3331" y="-5086.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-5075.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-5064.16" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer12_kv_update&#45;&gt;gpu5_layer12_res1 -->
<g id="edge1874" class="edge">
<title>gpu5_layer12_kv_update&#45;&gt;gpu5_layer12_res1</title>
<path fill="none" stroke="black" d="M3331,-5146.08C3331,-5137.4 3331,-5128.13 3331,-5119.47"/>
<polygon fill="black" stroke="black" points="3334.5,-5119.3 3331,-5109.3 3327.5,-5119.3 3334.5,-5119.3"/>
</g>
<!-- gpu5_layer12_ln2 -->
<g id="node1504" class="node">
<title>gpu5_layer12_ln2</title>
<polygon fill="lightblue" stroke="black" points="3392,-5020.16 3270,-5020.16 3270,-4968.16 3392,-4968.16 3392,-5020.16"/>
<text text-anchor="middle" x="3331" y="-5008.16" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3331" y="-4997.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-4986.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-4975.16" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer12_res1&#45;&gt;gpu5_layer12_ln2 -->
<g id="edge1875" class="edge">
<title>gpu5_layer12_res1&#45;&gt;gpu5_layer12_ln2</title>
<path fill="none" stroke="black" d="M3331,-5056.99C3331,-5048.7 3331,-5039.31 3331,-5030.4"/>
<polygon fill="black" stroke="black" points="3334.5,-5030.26 3331,-5020.26 3327.5,-5030.26 3334.5,-5030.26"/>
</g>
<!-- gpu5_layer12_routing -->
<g id="node1505" class="node">
<title>gpu5_layer12_routing</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-4931.16 3256.29,-4931.16 3204.53,-4805.16 3405.71,-4805.16 3457.47,-4931.16"/>
<text text-anchor="middle" x="3331" y="-4887.66" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3331" y="-4876.66" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-4865.66" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-4854.66" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3331" y="-4843.66" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer12_ln2&#45;&gt;gpu5_layer12_routing -->
<g id="edge1876" class="edge">
<title>gpu5_layer12_ln2&#45;&gt;gpu5_layer12_routing</title>
<path fill="none" stroke="black" d="M3331,-4968.06C3331,-4960.13 3331,-4950.93 3331,-4941.4"/>
<polygon fill="black" stroke="black" points="3334.5,-4941.39 3331,-4931.39 3327.5,-4941.39 3334.5,-4941.39"/>
</g>
<!-- gpu5_layer12_expert0 -->
<g id="node1506" class="node">
<title>gpu5_layer12_expert0</title>
<polygon fill="lightblue" stroke="black" points="3112,-4759.16 2990,-4759.16 2990,-4707.16 3112,-4707.16 3112,-4759.16"/>
<text text-anchor="middle" x="3051" y="-4747.16" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3051" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer12_routing&#45;&gt;gpu5_layer12_expert0 -->
<g id="edge1863" class="edge">
<title>gpu5_layer12_routing&#45;&gt;gpu5_layer12_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3205.33,-4807.46C3173.34,-4792.27 3140.34,-4776.59 3113.11,-4763.66"/>
<polygon fill="black" stroke="black" points="3114.26,-4760.33 3103.73,-4759.2 3111.26,-4766.65 3114.26,-4760.33"/>
<text text-anchor="middle" x="3186.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer12_expert1 -->
<g id="node1507" class="node">
<title>gpu5_layer12_expert1</title>
<polygon fill="lightblue" stroke="black" points="3252,-4759.16 3130,-4759.16 3130,-4707.16 3252,-4707.16 3252,-4759.16"/>
<text text-anchor="middle" x="3191" y="-4747.16" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3191" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer12_routing&#45;&gt;gpu5_layer12_expert1 -->
<g id="edge1864" class="edge">
<title>gpu5_layer12_routing&#45;&gt;gpu5_layer12_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3265.51,-4804.94C3251.48,-4791.62 3237.21,-4778.06 3224.97,-4766.43"/>
<polygon fill="black" stroke="black" points="3227.29,-4763.8 3217.63,-4759.45 3222.46,-4768.88 3227.29,-4763.8"/>
<text text-anchor="middle" x="3273.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer12_expert2 -->
<g id="node1508" class="node">
<title>gpu5_layer12_expert2</title>
<polygon fill="lightblue" stroke="black" points="3392,-4759.16 3270,-4759.16 3270,-4707.16 3392,-4707.16 3392,-4759.16"/>
<text text-anchor="middle" x="3331" y="-4747.16" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3331" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer12_routing&#45;&gt;gpu5_layer12_expert2 -->
<g id="edge1865" class="edge">
<title>gpu5_layer12_routing&#45;&gt;gpu5_layer12_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3331,-4804.94C3331,-4792.87 3331,-4780.62 3331,-4769.77"/>
<polygon fill="black" stroke="black" points="3334.5,-4769.45 3331,-4759.45 3327.5,-4769.45 3334.5,-4769.45"/>
<text text-anchor="middle" x="3360.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer12_expert3 -->
<g id="node1509" class="node">
<title>gpu5_layer12_expert3</title>
<polygon fill="lightblue" stroke="black" points="3532,-4759.16 3410,-4759.16 3410,-4707.16 3532,-4707.16 3532,-4759.16"/>
<text text-anchor="middle" x="3471" y="-4747.16" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="3471" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer12_routing&#45;&gt;gpu5_layer12_expert3 -->
<g id="edge1866" class="edge">
<title>gpu5_layer12_routing&#45;&gt;gpu5_layer12_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3396.49,-4804.94C3410.52,-4791.62 3424.79,-4778.06 3437.03,-4766.43"/>
<polygon fill="black" stroke="black" points="3439.54,-4768.88 3444.37,-4759.45 3434.71,-4763.8 3439.54,-4768.88"/>
<text text-anchor="middle" x="3454.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer12_expert_agg -->
<g id="node1510" class="node">
<title>gpu5_layer12_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-4670.16 3256.29,-4670.16 3204.53,-4566.16 3405.71,-4566.16 3457.47,-4670.16"/>
<text text-anchor="middle" x="3331" y="-4632.16" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3331" y="-4621.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-4610.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-4599.16" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer12_routing&#45;&gt;gpu5_layer12_expert_agg -->
<g id="edge1881" class="edge">
<title>gpu5_layer12_routing&#45;&gt;gpu5_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M3420.22,-4840.24C3493.96,-4813.08 3580.6,-4766.69 3541,-4707.16 3520.44,-4676.24 3486.7,-4656.17 3452.22,-4643.14"/>
<polygon fill="black" stroke="black" points="3453.08,-4639.73 3442.48,-4639.65 3450.71,-4646.32 3453.08,-4639.73"/>
</g>
<!-- gpu5_layer12_expert0&#45;&gt;gpu5_layer12_expert_agg -->
<g id="edge1877" class="edge">
<title>gpu5_layer12_expert0&#45;&gt;gpu5_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M3112.1,-4707.5C3148.98,-4692.62 3196.7,-4673.36 3238.16,-4656.62"/>
<polygon fill="black" stroke="black" points="3239.5,-4659.86 3247.46,-4652.87 3236.88,-4653.37 3239.5,-4659.86"/>
</g>
<!-- gpu5_layer12_expert1&#45;&gt;gpu5_layer12_expert_agg -->
<g id="edge1878" class="edge">
<title>gpu5_layer12_expert1&#45;&gt;gpu5_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M3222.07,-4707.08C3233.32,-4698 3246.53,-4687.34 3259.8,-4676.63"/>
<polygon fill="black" stroke="black" points="3262.02,-4679.33 3267.6,-4670.33 3257.62,-4673.89 3262.02,-4679.33"/>
</g>
<!-- gpu5_layer12_expert2&#45;&gt;gpu5_layer12_expert_agg -->
<g id="edge1879" class="edge">
<title>gpu5_layer12_expert2&#45;&gt;gpu5_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M3331,-4707.08C3331,-4699.15 3331,-4690.02 3331,-4680.69"/>
<polygon fill="black" stroke="black" points="3334.5,-4680.56 3331,-4670.56 3327.5,-4680.56 3334.5,-4680.56"/>
</g>
<!-- gpu5_layer12_expert3&#45;&gt;gpu5_layer12_expert_agg -->
<g id="edge1880" class="edge">
<title>gpu5_layer12_expert3&#45;&gt;gpu5_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M3439.93,-4707.08C3428.68,-4698 3415.47,-4687.34 3402.2,-4676.63"/>
<polygon fill="black" stroke="black" points="3404.38,-4673.89 3394.4,-4670.33 3399.98,-4679.33 3404.38,-4673.89"/>
</g>
<!-- gpu5_layer12_res2 -->
<g id="node1511" class="node">
<title>gpu5_layer12_res2</title>
<polygon fill="lightblue" stroke="black" points="3392,-4529.16 3270,-4529.16 3270,-4477.16 3392,-4477.16 3392,-4529.16"/>
<text text-anchor="middle" x="3331" y="-4517.16" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3331" y="-4506.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-4495.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-4484.16" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer12_expert_agg&#45;&gt;gpu5_layer12_res2 -->
<g id="edge1882" class="edge">
<title>gpu5_layer12_expert_agg&#45;&gt;gpu5_layer12_res2</title>
<path fill="none" stroke="black" d="M3331,-4565.95C3331,-4557 3331,-4547.87 3331,-4539.47"/>
<polygon fill="black" stroke="black" points="3334.5,-4539.29 3331,-4529.29 3327.5,-4539.29 3334.5,-4539.29"/>
</g>
<!-- gpu5_layer13_ln1 -->
<g id="node1512" class="node">
<title>gpu5_layer13_ln1</title>
<polygon fill="lightblue" stroke="black" points="3392,-4440.16 3270,-4440.16 3270,-4388.16 3392,-4388.16 3392,-4440.16"/>
<text text-anchor="middle" x="3331" y="-4428.16" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3331" y="-4417.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-4406.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-4395.16" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer12_res2&#45;&gt;gpu5_layer13_ln1 -->
<g id="edge1887" class="edge">
<title>gpu5_layer12_res2&#45;&gt;gpu5_layer13_ln1</title>
<path fill="none" stroke="black" d="M3331,-4476.99C3331,-4468.7 3331,-4459.31 3331,-4450.4"/>
<polygon fill="black" stroke="black" points="3334.5,-4450.26 3331,-4440.26 3327.5,-4450.26 3334.5,-4450.26"/>
</g>
<!-- gpu5_layer13_qkv -->
<g id="node1513" class="node">
<title>gpu5_layer13_qkv</title>
<polygon fill="lightblue" stroke="black" points="3392,-4351.16 3270,-4351.16 3270,-4299.16 3392,-4299.16 3392,-4351.16"/>
<text text-anchor="middle" x="3331" y="-4339.16" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3331" y="-4328.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-4317.16" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-4306.16" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer13_ln1&#45;&gt;gpu5_layer13_qkv -->
<g id="edge1888" class="edge">
<title>gpu5_layer13_ln1&#45;&gt;gpu5_layer13_qkv</title>
<path fill="none" stroke="black" d="M3331,-4387.99C3331,-4379.7 3331,-4370.31 3331,-4361.4"/>
<polygon fill="black" stroke="black" points="3334.5,-4361.26 3331,-4351.26 3327.5,-4361.26 3334.5,-4361.26"/>
</g>
<!-- gpu5_layer13_reshape -->
<g id="node1514" class="node">
<title>gpu5_layer13_reshape</title>
<polygon fill="lightblue" stroke="black" points="3395,-4262.16 3267,-4262.16 3267,-4210.16 3395,-4210.16 3395,-4262.16"/>
<text text-anchor="middle" x="3331" y="-4250.16" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3331" y="-4239.16" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-4228.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-4217.16" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer13_qkv&#45;&gt;gpu5_layer13_reshape -->
<g id="edge1889" class="edge">
<title>gpu5_layer13_qkv&#45;&gt;gpu5_layer13_reshape</title>
<path fill="none" stroke="black" d="M3331,-4298.99C3331,-4290.7 3331,-4281.31 3331,-4272.4"/>
<polygon fill="black" stroke="black" points="3334.5,-4272.26 3331,-4262.26 3327.5,-4272.26 3334.5,-4272.26"/>
</g>
<!-- gpu5_layer13_attn -->
<g id="node1515" class="node">
<title>gpu5_layer13_attn</title>
<polygon fill="lightblue" stroke="black" points="3395,-4173.16 3267,-4173.16 3267,-4121.16 3395,-4121.16 3395,-4173.16"/>
<text text-anchor="middle" x="3331" y="-4161.16" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3331" y="-4150.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-4139.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-4128.16" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer13_reshape&#45;&gt;gpu5_layer13_attn -->
<g id="edge1890" class="edge">
<title>gpu5_layer13_reshape&#45;&gt;gpu5_layer13_attn</title>
<path fill="none" stroke="black" d="M3331,-4209.99C3331,-4201.7 3331,-4192.31 3331,-4183.4"/>
<polygon fill="black" stroke="black" points="3334.5,-4183.26 3331,-4173.26 3327.5,-4183.26 3334.5,-4183.26"/>
</g>
<!-- gpu5_layer13_attn_reshape -->
<g id="node1517" class="node">
<title>gpu5_layer13_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3392,-4084.16 3270,-4084.16 3270,-4032.16 3392,-4032.16 3392,-4084.16"/>
<text text-anchor="middle" x="3331" y="-4072.16" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3331" y="-4061.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-4050.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-4039.16" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer13_attn&#45;&gt;gpu5_layer13_attn_reshape -->
<g id="edge1891" class="edge">
<title>gpu5_layer13_attn&#45;&gt;gpu5_layer13_attn_reshape</title>
<path fill="none" stroke="black" d="M3331,-4120.99C3331,-4112.7 3331,-4103.31 3331,-4094.4"/>
<polygon fill="black" stroke="black" points="3334.5,-4094.26 3331,-4084.26 3327.5,-4094.26 3334.5,-4094.26"/>
</g>
<!-- gpu5_layer13_attn_out -->
<g id="node1516" class="node">
<title>gpu5_layer13_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3392,-3995.16 3270,-3995.16 3270,-3943.16 3392,-3943.16 3392,-3995.16"/>
<text text-anchor="middle" x="3331" y="-3983.16" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3331" y="-3972.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-3961.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-3950.16" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer13_kv_update -->
<g id="node1518" class="node">
<title>gpu5_layer13_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3331" cy="-3869.39" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3331" y="-3883.39" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3331" y="-3872.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-3861.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-3850.39" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer13_attn_out&#45;&gt;gpu5_layer13_kv_update -->
<g id="edge1893" class="edge">
<title>gpu5_layer13_attn_out&#45;&gt;gpu5_layer13_kv_update</title>
<path fill="none" stroke="black" d="M3331,-3942.98C3331,-3934.84 3331,-3925.54 3331,-3916.38"/>
<polygon fill="black" stroke="black" points="3334.5,-3916.17 3331,-3906.17 3327.5,-3916.17 3334.5,-3916.17"/>
</g>
<!-- gpu5_layer13_attn_reshape&#45;&gt;gpu5_layer13_attn_out -->
<g id="edge1892" class="edge">
<title>gpu5_layer13_attn_reshape&#45;&gt;gpu5_layer13_attn_out</title>
<path fill="none" stroke="black" d="M3331,-4031.99C3331,-4023.7 3331,-4014.31 3331,-4005.4"/>
<polygon fill="black" stroke="black" points="3334.5,-4005.26 3331,-3995.26 3327.5,-4005.26 3334.5,-4005.26"/>
</g>
<!-- gpu5_layer13_res1 -->
<g id="node1519" class="node">
<title>gpu5_layer13_res1</title>
<polygon fill="lightblue" stroke="black" points="3392,-3795.62 3270,-3795.62 3270,-3743.62 3392,-3743.62 3392,-3795.62"/>
<text text-anchor="middle" x="3331" y="-3783.62" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3331" y="-3772.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-3761.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-3750.62" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer13_kv_update&#45;&gt;gpu5_layer13_res1 -->
<g id="edge1894" class="edge">
<title>gpu5_layer13_kv_update&#45;&gt;gpu5_layer13_res1</title>
<path fill="none" stroke="black" d="M3331,-3832.54C3331,-3823.86 3331,-3814.59 3331,-3805.93"/>
<polygon fill="black" stroke="black" points="3334.5,-3805.76 3331,-3795.76 3327.5,-3805.76 3334.5,-3805.76"/>
</g>
<!-- gpu5_layer13_ln2 -->
<g id="node1520" class="node">
<title>gpu5_layer13_ln2</title>
<polygon fill="lightblue" stroke="black" points="3392,-3706.62 3270,-3706.62 3270,-3654.62 3392,-3654.62 3392,-3706.62"/>
<text text-anchor="middle" x="3331" y="-3694.62" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3331" y="-3683.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-3672.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-3661.62" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer13_res1&#45;&gt;gpu5_layer13_ln2 -->
<g id="edge1895" class="edge">
<title>gpu5_layer13_res1&#45;&gt;gpu5_layer13_ln2</title>
<path fill="none" stroke="black" d="M3331,-3743.45C3331,-3735.16 3331,-3725.77 3331,-3716.87"/>
<polygon fill="black" stroke="black" points="3334.5,-3716.72 3331,-3706.72 3327.5,-3716.72 3334.5,-3716.72"/>
</g>
<!-- gpu5_layer13_routing -->
<g id="node1521" class="node">
<title>gpu5_layer13_routing</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-3617.62 3256.29,-3617.62 3204.53,-3491.62 3405.71,-3491.62 3457.47,-3617.62"/>
<text text-anchor="middle" x="3331" y="-3574.12" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3331" y="-3563.12" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-3552.12" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-3541.12" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3331" y="-3530.12" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer13_ln2&#45;&gt;gpu5_layer13_routing -->
<g id="edge1896" class="edge">
<title>gpu5_layer13_ln2&#45;&gt;gpu5_layer13_routing</title>
<path fill="none" stroke="black" d="M3331,-3654.52C3331,-3646.59 3331,-3637.4 3331,-3627.87"/>
<polygon fill="black" stroke="black" points="3334.5,-3627.85 3331,-3617.85 3327.5,-3627.85 3334.5,-3627.85"/>
</g>
<!-- gpu5_layer13_expert0 -->
<g id="node1522" class="node">
<title>gpu5_layer13_expert0</title>
<polygon fill="lightblue" stroke="black" points="3112,-3445.62 2990,-3445.62 2990,-3393.62 3112,-3393.62 3112,-3445.62"/>
<text text-anchor="middle" x="3051" y="-3433.62" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3051" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer13_routing&#45;&gt;gpu5_layer13_expert0 -->
<g id="edge1883" class="edge">
<title>gpu5_layer13_routing&#45;&gt;gpu5_layer13_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3205.33,-3493.93C3173.34,-3478.73 3140.34,-3463.05 3113.11,-3450.12"/>
<polygon fill="black" stroke="black" points="3114.26,-3446.79 3103.73,-3445.66 3111.26,-3453.11 3114.26,-3446.79"/>
<text text-anchor="middle" x="3186.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer13_expert1 -->
<g id="node1523" class="node">
<title>gpu5_layer13_expert1</title>
<polygon fill="lightblue" stroke="black" points="3252,-3445.62 3130,-3445.62 3130,-3393.62 3252,-3393.62 3252,-3445.62"/>
<text text-anchor="middle" x="3191" y="-3433.62" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3191" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer13_routing&#45;&gt;gpu5_layer13_expert1 -->
<g id="edge1884" class="edge">
<title>gpu5_layer13_routing&#45;&gt;gpu5_layer13_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3265.51,-3491.4C3251.48,-3478.08 3237.21,-3464.52 3224.97,-3452.89"/>
<polygon fill="black" stroke="black" points="3227.29,-3450.26 3217.63,-3445.91 3222.46,-3455.34 3227.29,-3450.26"/>
<text text-anchor="middle" x="3273.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer13_expert2 -->
<g id="node1524" class="node">
<title>gpu5_layer13_expert2</title>
<polygon fill="lightblue" stroke="black" points="3392,-3445.62 3270,-3445.62 3270,-3393.62 3392,-3393.62 3392,-3445.62"/>
<text text-anchor="middle" x="3331" y="-3433.62" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3331" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer13_routing&#45;&gt;gpu5_layer13_expert2 -->
<g id="edge1885" class="edge">
<title>gpu5_layer13_routing&#45;&gt;gpu5_layer13_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3331,-3491.4C3331,-3479.33 3331,-3467.08 3331,-3456.23"/>
<polygon fill="black" stroke="black" points="3334.5,-3455.91 3331,-3445.91 3327.5,-3455.91 3334.5,-3455.91"/>
<text text-anchor="middle" x="3360.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer13_expert3 -->
<g id="node1525" class="node">
<title>gpu5_layer13_expert3</title>
<polygon fill="lightblue" stroke="black" points="3532,-3445.62 3410,-3445.62 3410,-3393.62 3532,-3393.62 3532,-3445.62"/>
<text text-anchor="middle" x="3471" y="-3433.62" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="3471" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer13_routing&#45;&gt;gpu5_layer13_expert3 -->
<g id="edge1886" class="edge">
<title>gpu5_layer13_routing&#45;&gt;gpu5_layer13_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3396.49,-3491.4C3410.52,-3478.08 3424.79,-3464.52 3437.03,-3452.89"/>
<polygon fill="black" stroke="black" points="3439.54,-3455.34 3444.37,-3445.91 3434.71,-3450.26 3439.54,-3455.34"/>
<text text-anchor="middle" x="3454.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer13_expert_agg -->
<g id="node1526" class="node">
<title>gpu5_layer13_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-3356.62 3256.29,-3356.62 3204.53,-3252.62 3405.71,-3252.62 3457.47,-3356.62"/>
<text text-anchor="middle" x="3331" y="-3318.62" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3331" y="-3307.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-3296.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-3285.62" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer13_routing&#45;&gt;gpu5_layer13_expert_agg -->
<g id="edge1901" class="edge">
<title>gpu5_layer13_routing&#45;&gt;gpu5_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M3420.22,-3526.7C3493.96,-3499.54 3580.6,-3453.15 3541,-3393.62 3520.44,-3362.71 3486.7,-3342.63 3452.22,-3329.6"/>
<polygon fill="black" stroke="black" points="3453.08,-3326.19 3442.48,-3326.11 3450.71,-3332.78 3453.08,-3326.19"/>
</g>
<!-- gpu5_layer13_expert0&#45;&gt;gpu5_layer13_expert_agg -->
<g id="edge1897" class="edge">
<title>gpu5_layer13_expert0&#45;&gt;gpu5_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M3112.1,-3393.96C3148.98,-3379.08 3196.7,-3359.82 3238.16,-3343.08"/>
<polygon fill="black" stroke="black" points="3239.5,-3346.32 3247.46,-3339.33 3236.88,-3339.83 3239.5,-3346.32"/>
</g>
<!-- gpu5_layer13_expert1&#45;&gt;gpu5_layer13_expert_agg -->
<g id="edge1898" class="edge">
<title>gpu5_layer13_expert1&#45;&gt;gpu5_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M3222.07,-3393.54C3233.32,-3384.46 3246.53,-3373.8 3259.8,-3363.09"/>
<polygon fill="black" stroke="black" points="3262.02,-3365.79 3267.6,-3356.79 3257.62,-3360.35 3262.02,-3365.79"/>
</g>
<!-- gpu5_layer13_expert2&#45;&gt;gpu5_layer13_expert_agg -->
<g id="edge1899" class="edge">
<title>gpu5_layer13_expert2&#45;&gt;gpu5_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M3331,-3393.54C3331,-3385.61 3331,-3376.48 3331,-3367.16"/>
<polygon fill="black" stroke="black" points="3334.5,-3367.02 3331,-3357.02 3327.5,-3367.02 3334.5,-3367.02"/>
</g>
<!-- gpu5_layer13_expert3&#45;&gt;gpu5_layer13_expert_agg -->
<g id="edge1900" class="edge">
<title>gpu5_layer13_expert3&#45;&gt;gpu5_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M3439.93,-3393.54C3428.68,-3384.46 3415.47,-3373.8 3402.2,-3363.09"/>
<polygon fill="black" stroke="black" points="3404.38,-3360.35 3394.4,-3356.79 3399.98,-3365.79 3404.38,-3360.35"/>
</g>
<!-- gpu5_layer13_res2 -->
<g id="node1527" class="node">
<title>gpu5_layer13_res2</title>
<polygon fill="lightblue" stroke="black" points="3392,-3215.62 3270,-3215.62 3270,-3163.62 3392,-3163.62 3392,-3215.62"/>
<text text-anchor="middle" x="3331" y="-3203.62" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3331" y="-3192.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-3181.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-3170.62" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer13_expert_agg&#45;&gt;gpu5_layer13_res2 -->
<g id="edge1902" class="edge">
<title>gpu5_layer13_expert_agg&#45;&gt;gpu5_layer13_res2</title>
<path fill="none" stroke="black" d="M3331,-3252.41C3331,-3243.46 3331,-3234.33 3331,-3225.93"/>
<polygon fill="black" stroke="black" points="3334.5,-3225.75 3331,-3215.75 3327.5,-3225.75 3334.5,-3225.75"/>
</g>
<!-- gpu5_layer14_ln1 -->
<g id="node1528" class="node">
<title>gpu5_layer14_ln1</title>
<polygon fill="lightblue" stroke="black" points="3392,-3126.62 3270,-3126.62 3270,-3074.62 3392,-3074.62 3392,-3126.62"/>
<text text-anchor="middle" x="3331" y="-3114.62" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3331" y="-3103.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-3092.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-3081.62" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer13_res2&#45;&gt;gpu5_layer14_ln1 -->
<g id="edge1907" class="edge">
<title>gpu5_layer13_res2&#45;&gt;gpu5_layer14_ln1</title>
<path fill="none" stroke="black" d="M3331,-3163.45C3331,-3155.16 3331,-3145.77 3331,-3136.87"/>
<polygon fill="black" stroke="black" points="3334.5,-3136.72 3331,-3126.72 3327.5,-3136.72 3334.5,-3136.72"/>
</g>
<!-- gpu5_layer14_qkv -->
<g id="node1529" class="node">
<title>gpu5_layer14_qkv</title>
<polygon fill="lightblue" stroke="black" points="3392,-3037.62 3270,-3037.62 3270,-2985.62 3392,-2985.62 3392,-3037.62"/>
<text text-anchor="middle" x="3331" y="-3025.62" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3331" y="-3014.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-3003.62" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-2992.62" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer14_ln1&#45;&gt;gpu5_layer14_qkv -->
<g id="edge1908" class="edge">
<title>gpu5_layer14_ln1&#45;&gt;gpu5_layer14_qkv</title>
<path fill="none" stroke="black" d="M3331,-3074.45C3331,-3066.16 3331,-3056.77 3331,-3047.87"/>
<polygon fill="black" stroke="black" points="3334.5,-3047.72 3331,-3037.72 3327.5,-3047.72 3334.5,-3047.72"/>
</g>
<!-- gpu5_layer14_reshape -->
<g id="node1530" class="node">
<title>gpu5_layer14_reshape</title>
<polygon fill="lightblue" stroke="black" points="3395,-2948.62 3267,-2948.62 3267,-2896.62 3395,-2896.62 3395,-2948.62"/>
<text text-anchor="middle" x="3331" y="-2936.62" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3331" y="-2925.62" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-2914.62" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-2903.62" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer14_qkv&#45;&gt;gpu5_layer14_reshape -->
<g id="edge1909" class="edge">
<title>gpu5_layer14_qkv&#45;&gt;gpu5_layer14_reshape</title>
<path fill="none" stroke="black" d="M3331,-2985.45C3331,-2977.16 3331,-2967.77 3331,-2958.87"/>
<polygon fill="black" stroke="black" points="3334.5,-2958.72 3331,-2948.72 3327.5,-2958.72 3334.5,-2958.72"/>
</g>
<!-- gpu5_layer14_attn -->
<g id="node1531" class="node">
<title>gpu5_layer14_attn</title>
<polygon fill="lightblue" stroke="black" points="3395,-2859.62 3267,-2859.62 3267,-2807.62 3395,-2807.62 3395,-2859.62"/>
<text text-anchor="middle" x="3331" y="-2847.62" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3331" y="-2836.62" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-2825.62" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-2814.62" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer14_reshape&#45;&gt;gpu5_layer14_attn -->
<g id="edge1910" class="edge">
<title>gpu5_layer14_reshape&#45;&gt;gpu5_layer14_attn</title>
<path fill="none" stroke="black" d="M3331,-2896.45C3331,-2888.16 3331,-2878.77 3331,-2869.87"/>
<polygon fill="black" stroke="black" points="3334.5,-2869.72 3331,-2859.72 3327.5,-2869.72 3334.5,-2869.72"/>
</g>
<!-- gpu5_layer14_attn_reshape -->
<g id="node1533" class="node">
<title>gpu5_layer14_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3392,-2770.62 3270,-2770.62 3270,-2718.62 3392,-2718.62 3392,-2770.62"/>
<text text-anchor="middle" x="3331" y="-2758.62" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3331" y="-2747.62" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-2736.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-2725.62" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer14_attn&#45;&gt;gpu5_layer14_attn_reshape -->
<g id="edge1911" class="edge">
<title>gpu5_layer14_attn&#45;&gt;gpu5_layer14_attn_reshape</title>
<path fill="none" stroke="black" d="M3331,-2807.45C3331,-2799.16 3331,-2789.77 3331,-2780.87"/>
<polygon fill="black" stroke="black" points="3334.5,-2780.72 3331,-2770.72 3327.5,-2780.72 3334.5,-2780.72"/>
</g>
<!-- gpu5_layer14_attn_out -->
<g id="node1532" class="node">
<title>gpu5_layer14_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3392,-2681.62 3270,-2681.62 3270,-2629.62 3392,-2629.62 3392,-2681.62"/>
<text text-anchor="middle" x="3331" y="-2669.62" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3331" y="-2658.62" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-2647.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-2636.62" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer14_kv_update -->
<g id="node1534" class="node">
<title>gpu5_layer14_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3331" cy="-2555.85" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3331" y="-2569.85" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3331" y="-2558.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-2547.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-2536.85" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer14_attn_out&#45;&gt;gpu5_layer14_kv_update -->
<g id="edge1913" class="edge">
<title>gpu5_layer14_attn_out&#45;&gt;gpu5_layer14_kv_update</title>
<path fill="none" stroke="black" d="M3331,-2629.44C3331,-2621.3 3331,-2612 3331,-2602.84"/>
<polygon fill="black" stroke="black" points="3334.5,-2602.63 3331,-2592.63 3327.5,-2602.63 3334.5,-2602.63"/>
</g>
<!-- gpu5_layer14_attn_reshape&#45;&gt;gpu5_layer14_attn_out -->
<g id="edge1912" class="edge">
<title>gpu5_layer14_attn_reshape&#45;&gt;gpu5_layer14_attn_out</title>
<path fill="none" stroke="black" d="M3331,-2718.45C3331,-2710.16 3331,-2700.77 3331,-2691.87"/>
<polygon fill="black" stroke="black" points="3334.5,-2691.72 3331,-2681.72 3327.5,-2691.72 3334.5,-2691.72"/>
</g>
<!-- gpu5_layer14_res1 -->
<g id="node1535" class="node">
<title>gpu5_layer14_res1</title>
<polygon fill="lightblue" stroke="black" points="3392,-2482.08 3270,-2482.08 3270,-2430.08 3392,-2430.08 3392,-2482.08"/>
<text text-anchor="middle" x="3331" y="-2470.08" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3331" y="-2459.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-2448.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-2437.08" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer14_kv_update&#45;&gt;gpu5_layer14_res1 -->
<g id="edge1914" class="edge">
<title>gpu5_layer14_kv_update&#45;&gt;gpu5_layer14_res1</title>
<path fill="none" stroke="black" d="M3331,-2519C3331,-2510.32 3331,-2501.05 3331,-2492.39"/>
<polygon fill="black" stroke="black" points="3334.5,-2492.22 3331,-2482.22 3327.5,-2492.22 3334.5,-2492.22"/>
</g>
<!-- gpu5_layer14_ln2 -->
<g id="node1536" class="node">
<title>gpu5_layer14_ln2</title>
<polygon fill="lightblue" stroke="black" points="3392,-2393.08 3270,-2393.08 3270,-2341.08 3392,-2341.08 3392,-2393.08"/>
<text text-anchor="middle" x="3331" y="-2381.08" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3331" y="-2370.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-2359.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-2348.08" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer14_res1&#45;&gt;gpu5_layer14_ln2 -->
<g id="edge1915" class="edge">
<title>gpu5_layer14_res1&#45;&gt;gpu5_layer14_ln2</title>
<path fill="none" stroke="black" d="M3331,-2429.91C3331,-2421.62 3331,-2412.23 3331,-2403.33"/>
<polygon fill="black" stroke="black" points="3334.5,-2403.19 3331,-2393.19 3327.5,-2403.19 3334.5,-2403.19"/>
</g>
<!-- gpu5_layer14_routing -->
<g id="node1537" class="node">
<title>gpu5_layer14_routing</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-2304.08 3256.29,-2304.08 3204.53,-2178.08 3405.71,-2178.08 3457.47,-2304.08"/>
<text text-anchor="middle" x="3331" y="-2260.58" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3331" y="-2249.58" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-2238.58" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-2227.58" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3331" y="-2216.58" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer14_ln2&#45;&gt;gpu5_layer14_routing -->
<g id="edge1916" class="edge">
<title>gpu5_layer14_ln2&#45;&gt;gpu5_layer14_routing</title>
<path fill="none" stroke="black" d="M3331,-2340.98C3331,-2333.05 3331,-2323.86 3331,-2314.33"/>
<polygon fill="black" stroke="black" points="3334.5,-2314.31 3331,-2304.31 3327.5,-2314.31 3334.5,-2314.31"/>
</g>
<!-- gpu5_layer14_expert0 -->
<g id="node1538" class="node">
<title>gpu5_layer14_expert0</title>
<polygon fill="lightblue" stroke="black" points="3112,-2132.08 2990,-2132.08 2990,-2080.08 3112,-2080.08 3112,-2132.08"/>
<text text-anchor="middle" x="3051" y="-2120.08" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3051" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer14_routing&#45;&gt;gpu5_layer14_expert0 -->
<g id="edge1903" class="edge">
<title>gpu5_layer14_routing&#45;&gt;gpu5_layer14_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3205.33,-2180.39C3173.34,-2165.19 3140.34,-2149.51 3113.11,-2136.58"/>
<polygon fill="black" stroke="black" points="3114.26,-2133.25 3103.73,-2132.12 3111.26,-2139.58 3114.26,-2133.25"/>
<text text-anchor="middle" x="3186.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer14_expert1 -->
<g id="node1539" class="node">
<title>gpu5_layer14_expert1</title>
<polygon fill="lightblue" stroke="black" points="3252,-2132.08 3130,-2132.08 3130,-2080.08 3252,-2080.08 3252,-2132.08"/>
<text text-anchor="middle" x="3191" y="-2120.08" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3191" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer14_routing&#45;&gt;gpu5_layer14_expert1 -->
<g id="edge1904" class="edge">
<title>gpu5_layer14_routing&#45;&gt;gpu5_layer14_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3265.51,-2177.86C3251.48,-2164.54 3237.21,-2150.98 3224.97,-2139.35"/>
<polygon fill="black" stroke="black" points="3227.29,-2136.72 3217.63,-2132.37 3222.46,-2141.8 3227.29,-2136.72"/>
<text text-anchor="middle" x="3273.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer14_expert2 -->
<g id="node1540" class="node">
<title>gpu5_layer14_expert2</title>
<polygon fill="lightblue" stroke="black" points="3392,-2132.08 3270,-2132.08 3270,-2080.08 3392,-2080.08 3392,-2132.08"/>
<text text-anchor="middle" x="3331" y="-2120.08" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3331" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer14_routing&#45;&gt;gpu5_layer14_expert2 -->
<g id="edge1905" class="edge">
<title>gpu5_layer14_routing&#45;&gt;gpu5_layer14_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3331,-2177.86C3331,-2165.79 3331,-2153.54 3331,-2142.69"/>
<polygon fill="black" stroke="black" points="3334.5,-2142.37 3331,-2132.37 3327.5,-2142.37 3334.5,-2142.37"/>
<text text-anchor="middle" x="3360.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer14_expert3 -->
<g id="node1541" class="node">
<title>gpu5_layer14_expert3</title>
<polygon fill="lightblue" stroke="black" points="3532,-2132.08 3410,-2132.08 3410,-2080.08 3532,-2080.08 3532,-2132.08"/>
<text text-anchor="middle" x="3471" y="-2120.08" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="3471" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer14_routing&#45;&gt;gpu5_layer14_expert3 -->
<g id="edge1906" class="edge">
<title>gpu5_layer14_routing&#45;&gt;gpu5_layer14_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3396.49,-2177.86C3410.52,-2164.54 3424.79,-2150.98 3437.03,-2139.35"/>
<polygon fill="black" stroke="black" points="3439.54,-2141.8 3444.37,-2132.37 3434.71,-2136.72 3439.54,-2141.8"/>
<text text-anchor="middle" x="3454.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer14_expert_agg -->
<g id="node1542" class="node">
<title>gpu5_layer14_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-2043.08 3256.29,-2043.08 3204.53,-1939.08 3405.71,-1939.08 3457.47,-2043.08"/>
<text text-anchor="middle" x="3331" y="-2005.08" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3331" y="-1994.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-1983.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-1972.08" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer14_routing&#45;&gt;gpu5_layer14_expert_agg -->
<g id="edge1921" class="edge">
<title>gpu5_layer14_routing&#45;&gt;gpu5_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M3420.22,-2213.16C3493.96,-2186 3580.6,-2139.61 3541,-2080.08 3520.44,-2049.17 3486.7,-2029.09 3452.22,-2016.06"/>
<polygon fill="black" stroke="black" points="3453.08,-2012.65 3442.48,-2012.57 3450.71,-2019.24 3453.08,-2012.65"/>
</g>
<!-- gpu5_layer14_expert0&#45;&gt;gpu5_layer14_expert_agg -->
<g id="edge1917" class="edge">
<title>gpu5_layer14_expert0&#45;&gt;gpu5_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M3112.1,-2080.42C3148.98,-2065.54 3196.7,-2046.28 3238.16,-2029.54"/>
<polygon fill="black" stroke="black" points="3239.5,-2032.78 3247.46,-2025.79 3236.88,-2026.29 3239.5,-2032.78"/>
</g>
<!-- gpu5_layer14_expert1&#45;&gt;gpu5_layer14_expert_agg -->
<g id="edge1918" class="edge">
<title>gpu5_layer14_expert1&#45;&gt;gpu5_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M3222.07,-2080C3233.32,-2070.92 3246.53,-2060.26 3259.8,-2049.55"/>
<polygon fill="black" stroke="black" points="3262.02,-2052.25 3267.6,-2043.25 3257.62,-2046.81 3262.02,-2052.25"/>
</g>
<!-- gpu5_layer14_expert2&#45;&gt;gpu5_layer14_expert_agg -->
<g id="edge1919" class="edge">
<title>gpu5_layer14_expert2&#45;&gt;gpu5_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M3331,-2080C3331,-2072.07 3331,-2062.94 3331,-2053.62"/>
<polygon fill="black" stroke="black" points="3334.5,-2053.48 3331,-2043.48 3327.5,-2053.48 3334.5,-2053.48"/>
</g>
<!-- gpu5_layer14_expert3&#45;&gt;gpu5_layer14_expert_agg -->
<g id="edge1920" class="edge">
<title>gpu5_layer14_expert3&#45;&gt;gpu5_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M3439.93,-2080C3428.68,-2070.92 3415.47,-2060.26 3402.2,-2049.55"/>
<polygon fill="black" stroke="black" points="3404.38,-2046.81 3394.4,-2043.25 3399.98,-2052.25 3404.38,-2046.81"/>
</g>
<!-- gpu5_layer14_res2 -->
<g id="node1543" class="node">
<title>gpu5_layer14_res2</title>
<polygon fill="lightblue" stroke="black" points="3392,-1902.08 3270,-1902.08 3270,-1850.08 3392,-1850.08 3392,-1902.08"/>
<text text-anchor="middle" x="3331" y="-1890.08" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3331" y="-1879.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-1868.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-1857.08" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer14_expert_agg&#45;&gt;gpu5_layer14_res2 -->
<g id="edge1922" class="edge">
<title>gpu5_layer14_expert_agg&#45;&gt;gpu5_layer14_res2</title>
<path fill="none" stroke="black" d="M3331,-1938.87C3331,-1929.92 3331,-1920.79 3331,-1912.39"/>
<polygon fill="black" stroke="black" points="3334.5,-1912.21 3331,-1902.21 3327.5,-1912.21 3334.5,-1912.21"/>
</g>
<!-- gpu5_layer15_ln1 -->
<g id="node1544" class="node">
<title>gpu5_layer15_ln1</title>
<polygon fill="lightblue" stroke="black" points="3392,-1813.08 3270,-1813.08 3270,-1761.08 3392,-1761.08 3392,-1813.08"/>
<text text-anchor="middle" x="3331" y="-1801.08" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3331" y="-1790.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-1779.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-1768.08" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer14_res2&#45;&gt;gpu5_layer15_ln1 -->
<g id="edge1927" class="edge">
<title>gpu5_layer14_res2&#45;&gt;gpu5_layer15_ln1</title>
<path fill="none" stroke="black" d="M3331,-1849.91C3331,-1841.62 3331,-1832.23 3331,-1823.33"/>
<polygon fill="black" stroke="black" points="3334.5,-1823.19 3331,-1813.19 3327.5,-1823.19 3334.5,-1823.19"/>
</g>
<!-- gpu5_layer15_qkv -->
<g id="node1545" class="node">
<title>gpu5_layer15_qkv</title>
<polygon fill="lightblue" stroke="black" points="3392,-1724.08 3270,-1724.08 3270,-1672.08 3392,-1672.08 3392,-1724.08"/>
<text text-anchor="middle" x="3331" y="-1712.08" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3331" y="-1701.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-1690.08" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-1679.08" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer15_ln1&#45;&gt;gpu5_layer15_qkv -->
<g id="edge1928" class="edge">
<title>gpu5_layer15_ln1&#45;&gt;gpu5_layer15_qkv</title>
<path fill="none" stroke="black" d="M3331,-1760.91C3331,-1752.62 3331,-1743.23 3331,-1734.33"/>
<polygon fill="black" stroke="black" points="3334.5,-1734.19 3331,-1724.19 3327.5,-1734.19 3334.5,-1734.19"/>
</g>
<!-- gpu5_layer15_reshape -->
<g id="node1546" class="node">
<title>gpu5_layer15_reshape</title>
<polygon fill="lightblue" stroke="black" points="3395,-1635.08 3267,-1635.08 3267,-1583.08 3395,-1583.08 3395,-1635.08"/>
<text text-anchor="middle" x="3331" y="-1623.08" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3331" y="-1612.08" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3331" y="-1601.08" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-1590.08" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer15_qkv&#45;&gt;gpu5_layer15_reshape -->
<g id="edge1929" class="edge">
<title>gpu5_layer15_qkv&#45;&gt;gpu5_layer15_reshape</title>
<path fill="none" stroke="black" d="M3331,-1671.91C3331,-1663.62 3331,-1654.23 3331,-1645.33"/>
<polygon fill="black" stroke="black" points="3334.5,-1645.19 3331,-1635.19 3327.5,-1645.19 3334.5,-1645.19"/>
</g>
<!-- gpu5_layer15_attn -->
<g id="node1547" class="node">
<title>gpu5_layer15_attn</title>
<polygon fill="lightblue" stroke="black" points="3395,-1546.08 3267,-1546.08 3267,-1494.08 3395,-1494.08 3395,-1546.08"/>
<text text-anchor="middle" x="3331" y="-1534.08" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3331" y="-1523.08" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-1512.08" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-1501.08" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer15_reshape&#45;&gt;gpu5_layer15_attn -->
<g id="edge1930" class="edge">
<title>gpu5_layer15_reshape&#45;&gt;gpu5_layer15_attn</title>
<path fill="none" stroke="black" d="M3331,-1582.91C3331,-1574.62 3331,-1565.23 3331,-1556.33"/>
<polygon fill="black" stroke="black" points="3334.5,-1556.19 3331,-1546.19 3327.5,-1556.19 3334.5,-1556.19"/>
</g>
<!-- gpu5_layer15_attn_reshape -->
<g id="node1549" class="node">
<title>gpu5_layer15_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3392,-1457.08 3270,-1457.08 3270,-1405.08 3392,-1405.08 3392,-1457.08"/>
<text text-anchor="middle" x="3331" y="-1445.08" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3331" y="-1434.08" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-1423.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-1412.08" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer15_attn&#45;&gt;gpu5_layer15_attn_reshape -->
<g id="edge1931" class="edge">
<title>gpu5_layer15_attn&#45;&gt;gpu5_layer15_attn_reshape</title>
<path fill="none" stroke="black" d="M3331,-1493.91C3331,-1485.62 3331,-1476.23 3331,-1467.33"/>
<polygon fill="black" stroke="black" points="3334.5,-1467.19 3331,-1457.19 3327.5,-1467.19 3334.5,-1467.19"/>
</g>
<!-- gpu5_layer15_attn_out -->
<g id="node1548" class="node">
<title>gpu5_layer15_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3392,-1368.08 3270,-1368.08 3270,-1316.08 3392,-1316.08 3392,-1368.08"/>
<text text-anchor="middle" x="3331" y="-1356.08" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3331" y="-1345.08" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3331" y="-1334.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-1323.08" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer15_kv_update -->
<g id="node1550" class="node">
<title>gpu5_layer15_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3331" cy="-1242.31" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3331" y="-1256.31" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3331" y="-1245.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-1234.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-1223.31" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer15_attn_out&#45;&gt;gpu5_layer15_kv_update -->
<g id="edge1933" class="edge">
<title>gpu5_layer15_attn_out&#45;&gt;gpu5_layer15_kv_update</title>
<path fill="none" stroke="black" d="M3331,-1315.9C3331,-1307.76 3331,-1298.46 3331,-1289.3"/>
<polygon fill="black" stroke="black" points="3334.5,-1289.09 3331,-1279.09 3327.5,-1289.09 3334.5,-1289.09"/>
</g>
<!-- gpu5_layer15_attn_reshape&#45;&gt;gpu5_layer15_attn_out -->
<g id="edge1932" class="edge">
<title>gpu5_layer15_attn_reshape&#45;&gt;gpu5_layer15_attn_out</title>
<path fill="none" stroke="black" d="M3331,-1404.91C3331,-1396.62 3331,-1387.23 3331,-1378.33"/>
<polygon fill="black" stroke="black" points="3334.5,-1378.19 3331,-1368.19 3327.5,-1378.19 3334.5,-1378.19"/>
</g>
<!-- gpu5_layer15_res1 -->
<g id="node1551" class="node">
<title>gpu5_layer15_res1</title>
<polygon fill="lightblue" stroke="black" points="3392,-1168.54 3270,-1168.54 3270,-1116.54 3392,-1116.54 3392,-1168.54"/>
<text text-anchor="middle" x="3331" y="-1156.54" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3331" y="-1145.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-1134.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-1123.54" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer15_kv_update&#45;&gt;gpu5_layer15_res1 -->
<g id="edge1934" class="edge">
<title>gpu5_layer15_kv_update&#45;&gt;gpu5_layer15_res1</title>
<path fill="none" stroke="black" d="M3331,-1205.46C3331,-1196.78 3331,-1187.51 3331,-1178.85"/>
<polygon fill="black" stroke="black" points="3334.5,-1178.69 3331,-1168.69 3327.5,-1178.69 3334.5,-1178.69"/>
</g>
<!-- gpu5_layer15_ln2 -->
<g id="node1552" class="node">
<title>gpu5_layer15_ln2</title>
<polygon fill="lightblue" stroke="black" points="3392,-1079.54 3270,-1079.54 3270,-1027.54 3392,-1027.54 3392,-1079.54"/>
<text text-anchor="middle" x="3331" y="-1067.54" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3331" y="-1056.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-1045.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-1034.54" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer15_res1&#45;&gt;gpu5_layer15_ln2 -->
<g id="edge1935" class="edge">
<title>gpu5_layer15_res1&#45;&gt;gpu5_layer15_ln2</title>
<path fill="none" stroke="black" d="M3331,-1116.38C3331,-1108.08 3331,-1098.69 3331,-1089.79"/>
<polygon fill="black" stroke="black" points="3334.5,-1089.65 3331,-1079.65 3327.5,-1089.65 3334.5,-1089.65"/>
</g>
<!-- gpu5_layer15_routing -->
<g id="node1553" class="node">
<title>gpu5_layer15_routing</title>
<polygon fill="lightyellow" stroke="black" points="3457.47,-990.54 3256.29,-990.54 3204.53,-864.54 3405.71,-864.54 3457.47,-990.54"/>
<text text-anchor="middle" x="3331" y="-947.04" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3331" y="-936.04" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-925.04" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-914.04" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3331" y="-903.04" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer15_ln2&#45;&gt;gpu5_layer15_routing -->
<g id="edge1936" class="edge">
<title>gpu5_layer15_ln2&#45;&gt;gpu5_layer15_routing</title>
<path fill="none" stroke="black" d="M3331,-1027.45C3331,-1019.51 3331,-1010.32 3331,-1000.79"/>
<polygon fill="black" stroke="black" points="3334.5,-1000.77 3331,-990.77 3327.5,-1000.77 3334.5,-1000.77"/>
</g>
<!-- gpu5_layer15_expert0 -->
<g id="node1554" class="node">
<title>gpu5_layer15_expert0</title>
<polygon fill="lightblue" stroke="black" points="3112,-818.54 2990,-818.54 2990,-766.54 3112,-766.54 3112,-818.54"/>
<text text-anchor="middle" x="3051" y="-806.54" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3051" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3051" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer15_routing&#45;&gt;gpu5_layer15_expert0 -->
<g id="edge1923" class="edge">
<title>gpu5_layer15_routing&#45;&gt;gpu5_layer15_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3205.33,-866.85C3173.34,-851.65 3140.34,-835.98 3113.11,-823.04"/>
<polygon fill="black" stroke="black" points="3114.26,-819.71 3103.73,-818.58 3111.26,-826.04 3114.26,-819.71"/>
<text text-anchor="middle" x="3186.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer15_expert1 -->
<g id="node1555" class="node">
<title>gpu5_layer15_expert1</title>
<polygon fill="lightblue" stroke="black" points="3252,-818.54 3130,-818.54 3130,-766.54 3252,-766.54 3252,-818.54"/>
<text text-anchor="middle" x="3191" y="-806.54" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3191" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3191" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer15_routing&#45;&gt;gpu5_layer15_expert1 -->
<g id="edge1924" class="edge">
<title>gpu5_layer15_routing&#45;&gt;gpu5_layer15_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3265.51,-864.32C3251.48,-851 3237.21,-837.44 3224.97,-825.81"/>
<polygon fill="black" stroke="black" points="3227.29,-823.18 3217.63,-818.83 3222.46,-828.26 3227.29,-823.18"/>
<text text-anchor="middle" x="3273.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer15_expert2 -->
<g id="node1556" class="node">
<title>gpu5_layer15_expert2</title>
<polygon fill="lightblue" stroke="black" points="3392,-818.54 3270,-818.54 3270,-766.54 3392,-766.54 3392,-818.54"/>
<text text-anchor="middle" x="3331" y="-806.54" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3331" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3331" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer15_routing&#45;&gt;gpu5_layer15_expert2 -->
<g id="edge1925" class="edge">
<title>gpu5_layer15_routing&#45;&gt;gpu5_layer15_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3331,-864.32C3331,-852.25 3331,-840 3331,-829.15"/>
<polygon fill="black" stroke="black" points="3334.5,-828.83 3331,-818.83 3327.5,-828.83 3334.5,-828.83"/>
<text text-anchor="middle" x="3360.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer15_expert3 -->
<g id="node1557" class="node">
<title>gpu5_layer15_expert3</title>
<polygon fill="lightblue" stroke="black" points="3532,-818.54 3410,-818.54 3410,-766.54 3532,-766.54 3532,-818.54"/>
<text text-anchor="middle" x="3471" y="-806.54" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="3471" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3471" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer15_routing&#45;&gt;gpu5_layer15_expert3 -->
<g id="edge1926" class="edge">
<title>gpu5_layer15_routing&#45;&gt;gpu5_layer15_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3396.49,-864.32C3410.52,-851 3424.79,-837.44 3437.03,-825.81"/>
<polygon fill="black" stroke="black" points="3439.54,-828.26 3444.37,-818.83 3434.71,-823.18 3439.54,-828.26"/>
<text text-anchor="middle" x="3454.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu5_layer15_expert_agg -->
<g id="node1558" class="node">
<title>gpu5_layer15_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="3387.47,-729.54 3186.29,-729.54 3134.53,-625.54 3335.71,-625.54 3387.47,-729.54"/>
<text text-anchor="middle" x="3261" y="-691.54" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3261" y="-680.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3261" y="-669.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3261" y="-658.54" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer15_routing&#45;&gt;gpu5_layer15_expert_agg -->
<g id="edge1941" class="edge">
<title>gpu5_layer15_routing&#45;&gt;gpu5_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M3420.03,-899.29C3494.95,-871.59 3583.58,-824.55 3541,-766.54 3521.36,-739.77 3449.16,-717.46 3383,-701.99"/>
<polygon fill="black" stroke="black" points="3383.4,-698.49 3372.87,-699.67 3381.83,-705.31 3383.4,-698.49"/>
</g>
<!-- gpu5_layer15_expert0&#45;&gt;gpu5_layer15_expert_agg -->
<g id="edge1937" class="edge">
<title>gpu5_layer15_expert0&#45;&gt;gpu5_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M3097.61,-766.46C3119.76,-754.54 3147.01,-739.88 3172.86,-725.97"/>
<polygon fill="black" stroke="black" points="3174.78,-728.91 3181.93,-721.09 3171.47,-722.74 3174.78,-728.91"/>
</g>
<!-- gpu5_layer15_expert1&#45;&gt;gpu5_layer15_expert_agg -->
<g id="edge1938" class="edge">
<title>gpu5_layer15_expert1&#45;&gt;gpu5_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M3206.54,-766.46C3211.71,-758.11 3217.71,-748.42 3223.8,-738.59"/>
<polygon fill="black" stroke="black" points="3226.87,-740.28 3229.16,-729.94 3220.92,-736.6 3226.87,-740.28"/>
</g>
<!-- gpu5_layer15_expert2&#45;&gt;gpu5_layer15_expert_agg -->
<g id="edge1939" class="edge">
<title>gpu5_layer15_expert2&#45;&gt;gpu5_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M3315.46,-766.46C3310.29,-758.11 3304.29,-748.42 3298.2,-738.59"/>
<polygon fill="black" stroke="black" points="3301.08,-736.6 3292.84,-729.94 3295.13,-740.28 3301.08,-736.6"/>
</g>
<!-- gpu5_layer15_expert3&#45;&gt;gpu5_layer15_expert_agg -->
<g id="edge1940" class="edge">
<title>gpu5_layer15_expert3&#45;&gt;gpu5_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M3424.39,-766.46C3406.74,-756.96 3385.85,-745.72 3365.01,-734.51"/>
<polygon fill="black" stroke="black" points="3366.56,-731.37 3356.1,-729.71 3363.24,-737.53 3366.56,-731.37"/>
</g>
<!-- gpu5_layer15_res2 -->
<g id="node1559" class="node">
<title>gpu5_layer15_res2</title>
<polygon fill="lightblue" stroke="black" points="2923,-588.54 2801,-588.54 2801,-536.54 2923,-536.54 2923,-588.54"/>
<text text-anchor="middle" x="2862" y="-576.54" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="2862" y="-565.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2862" y="-554.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2862" y="-543.54" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer15_expert_agg&#45;&gt;gpu5_layer15_res2 -->
<g id="edge1942" class="edge">
<title>gpu5_layer15_expert_agg&#45;&gt;gpu5_layer15_res2</title>
<path fill="none" stroke="black" d="M3143.18,-643.17C3074.95,-623.85 2991.33,-600.17 2933.09,-583.67"/>
<polygon fill="black" stroke="black" points="2933.82,-580.24 2923.25,-580.89 2931.92,-586.98 2933.82,-580.24"/>
</g>
<!-- gpu5_final_ln -->
<g id="node1560" class="node">
<title>gpu5_final_ln</title>
<polygon fill="lightblue" stroke="black" points="2903,-499.54 2781,-499.54 2781,-447.54 2903,-447.54 2903,-499.54"/>
<text text-anchor="middle" x="2842" y="-487.54" font-family="Arial" font-size="10.00">Final LayerNorm</text>
<text text-anchor="middle" x="2842" y="-476.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2842" y="-465.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2842" y="-454.54" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_layer15_res2&#45;&gt;gpu5_final_ln -->
<g id="edge1943" class="edge">
<title>gpu5_layer15_res2&#45;&gt;gpu5_final_ln</title>
<path fill="none" stroke="black" d="M2856.22,-536.38C2854.29,-527.99 2852.1,-518.49 2850.04,-509.5"/>
<polygon fill="black" stroke="black" points="2853.42,-508.61 2847.77,-499.65 2846.6,-510.18 2853.42,-508.61"/>
</g>
<!-- gpu5_output_proj -->
<g id="node1561" class="node">
<title>gpu5_output_proj</title>
<polygon fill="lightblue" stroke="black" points="2893,-410.54 2765,-410.54 2765,-358.54 2893,-358.54 2893,-410.54"/>
<text text-anchor="middle" x="2829" y="-398.54" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="2829" y="-387.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2829" y="-376.54" font-family="Arial" font-size="10.00">Output: [256, 512, 32000]</text>
<text text-anchor="middle" x="2829" y="-365.54" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_final_ln&#45;&gt;gpu5_output_proj -->
<g id="edge1944" class="edge">
<title>gpu5_final_ln&#45;&gt;gpu5_output_proj</title>
<path fill="none" stroke="black" d="M2838.24,-447.38C2837,-439.08 2835.6,-429.69 2834.27,-420.79"/>
<polygon fill="black" stroke="black" points="2837.69,-420.02 2832.75,-410.65 2830.77,-421.05 2837.69,-420.02"/>
</g>
<!-- gpu5_softmax -->
<g id="node1562" class="node">
<title>gpu5_softmax</title>
<polygon fill="lightblue" stroke="black" points="2816,-321.54 2688,-321.54 2688,-269.54 2816,-269.54 2816,-321.54"/>
<text text-anchor="middle" x="2752" y="-309.54" font-family="Arial" font-size="10.00">Softmax</text>
<text text-anchor="middle" x="2752" y="-298.54" font-family="Arial" font-size="10.00">Input: [256, 512, 32000]</text>
<text text-anchor="middle" x="2752" y="-287.54" font-family="Arial" font-size="10.00">Output: [256, 512, 32000]</text>
<text text-anchor="middle" x="2752" y="-276.54" font-family="Arial" font-size="10.00">GPU: GPU5</text>
</g>
<!-- gpu5_output_proj&#45;&gt;gpu5_softmax -->
<g id="edge1945" class="edge">
<title>gpu5_output_proj&#45;&gt;gpu5_softmax</title>
<path fill="none" stroke="black" d="M2806.73,-358.38C2798.67,-349.27 2789.45,-338.85 2780.9,-329.19"/>
<polygon fill="black" stroke="black" points="2783.47,-326.82 2774.22,-321.65 2778.23,-331.45 2783.47,-326.82"/>
</g>
<!-- gpu5_softmax&#45;&gt;dp_aggregate -->
<g id="edge2599" class="edge">
<title>gpu5_softmax&#45;&gt;dp_aggregate</title>
<path fill="none" stroke="black" d="M2688,-271.16C2653.66,-258.62 2609.79,-242.59 2567.44,-227.12"/>
<polygon fill="black" stroke="black" points="2568.45,-223.77 2557.86,-223.63 2566.05,-230.34 2568.45,-223.77"/>
<text text-anchor="middle" x="2651.5" y="-244.34" font-family="Arial" font-size="9.00">GPU 5 output</text>
</g>
<!-- gpu6_layer0_ln1 -->
<g id="node1564" class="node">
<title>gpu6_layer0_ln1</title>
<polygon fill="lightblue" stroke="black" points="2742,-21516.16 2620,-21516.16 2620,-21464.16 2742,-21464.16 2742,-21516.16"/>
<text text-anchor="middle" x="2681" y="-21504.16" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2681" y="-21493.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2681" y="-21482.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2681" y="-21471.16" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_embed&#45;&gt;gpu6_layer0_ln1 -->
<g id="edge1951" class="edge">
<title>gpu6_embed&#45;&gt;gpu6_layer0_ln1</title>
<path fill="none" stroke="black" d="M2678.87,-21553C2679.15,-21544.7 2679.48,-21535.32 2679.78,-21526.41"/>
<polygon fill="black" stroke="black" points="2683.29,-21526.39 2680.13,-21516.27 2676.29,-21526.15 2683.29,-21526.39"/>
</g>
<!-- gpu6_layer0_qkv -->
<g id="node1565" class="node">
<title>gpu6_layer0_qkv</title>
<polygon fill="lightblue" stroke="black" points="2746,-21427.16 2624,-21427.16 2624,-21375.16 2746,-21375.16 2746,-21427.16"/>
<text text-anchor="middle" x="2685" y="-21415.16" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2685" y="-21404.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2685" y="-21393.16" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2685" y="-21382.16" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer0_ln1&#45;&gt;gpu6_layer0_qkv -->
<g id="edge1952" class="edge">
<title>gpu6_layer0_ln1&#45;&gt;gpu6_layer0_qkv</title>
<path fill="none" stroke="black" d="M2682.16,-21464C2682.54,-21455.7 2682.97,-21446.32 2683.38,-21437.41"/>
<polygon fill="black" stroke="black" points="2686.88,-21437.42 2683.85,-21427.27 2679.89,-21437.1 2686.88,-21437.42"/>
</g>
<!-- gpu6_layer0_reshape -->
<g id="node1566" class="node">
<title>gpu6_layer0_reshape</title>
<polygon fill="lightblue" stroke="black" points="2754,-21338.16 2626,-21338.16 2626,-21286.16 2754,-21286.16 2754,-21338.16"/>
<text text-anchor="middle" x="2690" y="-21326.16" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2690" y="-21315.16" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2690" y="-21304.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2690" y="-21293.16" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer0_qkv&#45;&gt;gpu6_layer0_reshape -->
<g id="edge1953" class="edge">
<title>gpu6_layer0_qkv&#45;&gt;gpu6_layer0_reshape</title>
<path fill="none" stroke="black" d="M2686.45,-21375C2686.92,-21366.7 2687.46,-21357.32 2687.97,-21348.41"/>
<polygon fill="black" stroke="black" points="2691.48,-21348.46 2688.56,-21338.27 2684.49,-21348.05 2691.48,-21348.46"/>
</g>
<!-- gpu6_layer0_attn -->
<g id="node1567" class="node">
<title>gpu6_layer0_attn</title>
<polygon fill="lightblue" stroke="black" points="2754,-21249.16 2626,-21249.16 2626,-21197.16 2754,-21197.16 2754,-21249.16"/>
<text text-anchor="middle" x="2690" y="-21237.16" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2690" y="-21226.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2690" y="-21215.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2690" y="-21204.16" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer0_reshape&#45;&gt;gpu6_layer0_attn -->
<g id="edge1954" class="edge">
<title>gpu6_layer0_reshape&#45;&gt;gpu6_layer0_attn</title>
<path fill="none" stroke="black" d="M2690,-21286C2690,-21277.7 2690,-21268.32 2690,-21259.41"/>
<polygon fill="black" stroke="black" points="2693.5,-21259.27 2690,-21249.27 2686.5,-21259.27 2693.5,-21259.27"/>
</g>
<!-- gpu6_layer0_attn_reshape -->
<g id="node1569" class="node">
<title>gpu6_layer0_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="2855,-21160.16 2733,-21160.16 2733,-21108.16 2855,-21108.16 2855,-21160.16"/>
<text text-anchor="middle" x="2794" y="-21148.16" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2794" y="-21137.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2794" y="-21126.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2794" y="-21115.16" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer0_attn&#45;&gt;gpu6_layer0_attn_reshape -->
<g id="edge1955" class="edge">
<title>gpu6_layer0_attn&#45;&gt;gpu6_layer0_attn_reshape</title>
<path fill="none" stroke="black" d="M2720.08,-21197C2731.29,-21187.62 2744.17,-21176.85 2756,-21166.96"/>
<polygon fill="black" stroke="black" points="2758.56,-21169.37 2763.99,-21160.27 2754.07,-21164 2758.56,-21169.37"/>
</g>
<!-- gpu6_layer0_attn_out -->
<g id="node1568" class="node">
<title>gpu6_layer0_attn_out</title>
<polygon fill="lightblue" stroke="black" points="2967,-21071.16 2845,-21071.16 2845,-21019.16 2967,-21019.16 2967,-21071.16"/>
<text text-anchor="middle" x="2906" y="-21059.16" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="2906" y="-21048.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2906" y="-21037.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2906" y="-21026.16" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer0_kv_update -->
<g id="node1570" class="node">
<title>gpu6_layer0_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3041" cy="-20945.4" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3041" y="-20959.4" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3041" y="-20948.4" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3041" y="-20937.4" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3041" y="-20926.4" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer0_attn_out&#45;&gt;gpu6_layer0_kv_update -->
<g id="edge1957" class="edge">
<title>gpu6_layer0_attn_out&#45;&gt;gpu6_layer0_kv_update</title>
<path fill="none" stroke="black" d="M2940.77,-21018.99C2955.67,-21008.19 2973.38,-20995.37 2989.74,-20983.52"/>
<polygon fill="black" stroke="black" points="2992.1,-20986.13 2998.15,-20977.43 2987.99,-20980.46 2992.1,-20986.13"/>
</g>
<!-- gpu6_layer0_attn_reshape&#45;&gt;gpu6_layer0_attn_out -->
<g id="edge1956" class="edge">
<title>gpu6_layer0_attn_reshape&#45;&gt;gpu6_layer0_attn_out</title>
<path fill="none" stroke="black" d="M2826.4,-21108C2838.58,-21098.53 2852.6,-21087.65 2865.44,-21077.67"/>
<polygon fill="black" stroke="black" points="2867.93,-21080.17 2873.68,-21071.27 2863.63,-21074.64 2867.93,-21080.17"/>
</g>
<!-- gpu6_layer0_res1 -->
<g id="node1571" class="node">
<title>gpu6_layer0_res1</title>
<polygon fill="lightblue" stroke="black" points="3287,-20871.63 3165,-20871.63 3165,-20819.63 3287,-20819.63 3287,-20871.63"/>
<text text-anchor="middle" x="3226" y="-20859.63" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3226" y="-20848.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3226" y="-20837.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3226" y="-20826.63" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer0_kv_update&#45;&gt;gpu6_layer0_res1 -->
<g id="edge1958" class="edge">
<title>gpu6_layer0_kv_update&#45;&gt;gpu6_layer0_res1</title>
<path fill="none" stroke="black" d="M3094.01,-20916.38C3117.68,-20903.87 3145.6,-20889.12 3169.65,-20876.41"/>
<polygon fill="black" stroke="black" points="3171.45,-20879.41 3178.66,-20871.65 3168.18,-20873.22 3171.45,-20879.41"/>
</g>
<!-- gpu6_layer0_ln2 -->
<g id="node1572" class="node">
<title>gpu6_layer0_ln2</title>
<polygon fill="lightblue" stroke="black" points="3686,-20782.63 3564,-20782.63 3564,-20730.63 3686,-20730.63 3686,-20782.63"/>
<text text-anchor="middle" x="3625" y="-20770.63" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3625" y="-20759.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3625" y="-20748.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3625" y="-20737.63" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer0_res1&#45;&gt;gpu6_layer0_ln2 -->
<g id="edge1959" class="edge">
<title>gpu6_layer0_res1&#45;&gt;gpu6_layer0_ln2</title>
<path fill="none" stroke="black" d="M3287.2,-20827.98C3298.41,-20825.08 3310.04,-20822.18 3321,-20819.63 3400.38,-20801.1 3492.14,-20782.81 3553.9,-20770.96"/>
<polygon fill="black" stroke="black" points="3554.77,-20774.35 3563.93,-20769.04 3553.45,-20767.48 3554.77,-20774.35"/>
</g>
<!-- gpu6_layer0_routing -->
<g id="node1573" class="node">
<title>gpu6_layer0_routing</title>
<polygon fill="lightyellow" stroke="black" points="3984.47,-20693.63 3783.29,-20693.63 3731.53,-20567.63 3932.71,-20567.63 3984.47,-20693.63"/>
<text text-anchor="middle" x="3858" y="-20650.13" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3858" y="-20639.13" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3858" y="-20628.13" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3858" y="-20617.13" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3858" y="-20606.13" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer0_ln2&#45;&gt;gpu6_layer0_routing -->
<g id="edge1960" class="edge">
<title>gpu6_layer0_ln2&#45;&gt;gpu6_layer0_routing</title>
<path fill="none" stroke="black" d="M3672.15,-20730.53C3699.26,-20716.11 3734.24,-20697.49 3766.52,-20680.31"/>
<polygon fill="black" stroke="black" points="3768.37,-20683.29 3775.55,-20675.5 3765.08,-20677.11 3768.37,-20683.29"/>
</g>
<!-- gpu6_layer0_expert0 -->
<g id="node1574" class="node">
<title>gpu6_layer0_expert0</title>
<polygon fill="lightblue" stroke="black" points="3710,-20521.63 3588,-20521.63 3588,-20469.63 3710,-20469.63 3710,-20521.63"/>
<text text-anchor="middle" x="3649" y="-20509.63" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3649" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer0_routing&#45;&gt;gpu6_layer0_expert0 -->
<g id="edge1947" class="edge">
<title>gpu6_layer0_routing&#45;&gt;gpu6_layer0_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3760.54,-20567.6C3738.39,-20553.51 3715.82,-20539.14 3696.82,-20527.06"/>
<polygon fill="black" stroke="black" points="3698.68,-20524.09 3688.37,-20521.68 3694.92,-20530 3698.68,-20524.09"/>
<text text-anchor="middle" x="3757.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer0_expert1 -->
<g id="node1575" class="node">
<title>gpu6_layer0_expert1</title>
<polygon fill="lightblue" stroke="black" points="3850,-20521.63 3728,-20521.63 3728,-20469.63 3850,-20469.63 3850,-20521.63"/>
<text text-anchor="middle" x="3789" y="-20509.63" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3789" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer0_routing&#45;&gt;gpu6_layer0_expert1 -->
<g id="edge1948" class="edge">
<title>gpu6_layer0_routing&#45;&gt;gpu6_layer0_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3825.72,-20567.41C3819.2,-20554.84 3812.57,-20542.06 3806.78,-20530.89"/>
<polygon fill="black" stroke="black" points="3809.83,-20529.18 3802.12,-20521.92 3803.62,-20532.41 3809.83,-20529.18"/>
<text text-anchor="middle" x="3844.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer0_expert2 -->
<g id="node1576" class="node">
<title>gpu6_layer0_expert2</title>
<polygon fill="lightblue" stroke="black" points="3990,-20521.63 3868,-20521.63 3868,-20469.63 3990,-20469.63 3990,-20521.63"/>
<text text-anchor="middle" x="3929" y="-20509.63" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3929" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer0_routing&#45;&gt;gpu6_layer0_expert2 -->
<g id="edge1949" class="edge">
<title>gpu6_layer0_routing&#45;&gt;gpu6_layer0_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3891.21,-20567.41C3897.92,-20554.84 3904.74,-20542.06 3910.71,-20530.89"/>
<polygon fill="black" stroke="black" points="3913.88,-20532.39 3915.5,-20521.92 3907.7,-20529.09 3913.88,-20532.39"/>
<text text-anchor="middle" x="3935.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer0_expert3 -->
<g id="node1577" class="node">
<title>gpu6_layer0_expert3</title>
<polygon fill="lightblue" stroke="black" points="4130,-20521.63 4008,-20521.63 4008,-20469.63 4130,-20469.63 4130,-20521.63"/>
<text text-anchor="middle" x="4069" y="-20509.63" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4069" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer0_routing&#45;&gt;gpu6_layer0_expert3 -->
<g id="edge1950" class="edge">
<title>gpu6_layer0_routing&#45;&gt;gpu6_layer0_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3937.77,-20579.34C3965.63,-20561.79 3996.03,-20542.62 4020.55,-20527.16"/>
<polygon fill="black" stroke="black" points="4022.71,-20529.94 4029.3,-20521.65 4018.98,-20524.02 4022.71,-20529.94"/>
<text text-anchor="middle" x="4029.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer0_expert_agg -->
<g id="node1578" class="node">
<title>gpu6_layer0_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-20432.63 3854.29,-20432.63 3802.53,-20328.63 4003.71,-20328.63 4055.47,-20432.63"/>
<text text-anchor="middle" x="3929" y="-20394.63" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3929" y="-20383.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-20372.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-20361.63" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer0_routing&#45;&gt;gpu6_layer0_expert_agg -->
<g id="edge1965" class="edge">
<title>gpu6_layer0_routing&#45;&gt;gpu6_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3954.31,-20620.16C4018.27,-20608.29 4097.79,-20581.61 4139,-20521.63 4171.21,-20474.73 4116.74,-20439.4 4055.21,-20415.95"/>
<polygon fill="black" stroke="black" points="4056.29,-20412.62 4045.7,-20412.44 4053.86,-20419.18 4056.29,-20412.62"/>
</g>
<!-- gpu6_layer0_expert0&#45;&gt;gpu6_layer0_expert_agg -->
<g id="edge1961" class="edge">
<title>gpu6_layer0_expert0&#45;&gt;gpu6_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3710.1,-20469.97C3746.98,-20455.08 3794.7,-20435.83 3836.16,-20419.09"/>
<polygon fill="black" stroke="black" points="3837.5,-20422.33 3845.46,-20415.34 3834.88,-20415.84 3837.5,-20422.33"/>
</g>
<!-- gpu6_layer0_expert1&#45;&gt;gpu6_layer0_expert_agg -->
<g id="edge1962" class="edge">
<title>gpu6_layer0_expert1&#45;&gt;gpu6_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3820.07,-20469.55C3831.32,-20460.47 3844.53,-20449.81 3857.8,-20439.1"/>
<polygon fill="black" stroke="black" points="3860.02,-20441.8 3865.6,-20432.8 3855.62,-20436.35 3860.02,-20441.8"/>
</g>
<!-- gpu6_layer0_expert2&#45;&gt;gpu6_layer0_expert_agg -->
<g id="edge1963" class="edge">
<title>gpu6_layer0_expert2&#45;&gt;gpu6_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3929,-20469.55C3929,-20461.62 3929,-20452.48 3929,-20443.16"/>
<polygon fill="black" stroke="black" points="3932.5,-20443.03 3929,-20433.03 3925.5,-20443.03 3932.5,-20443.03"/>
</g>
<!-- gpu6_layer0_expert3&#45;&gt;gpu6_layer0_expert_agg -->
<g id="edge1964" class="edge">
<title>gpu6_layer0_expert3&#45;&gt;gpu6_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M4037.93,-20469.55C4026.68,-20460.47 4013.47,-20449.81 4000.2,-20439.1"/>
<polygon fill="black" stroke="black" points="4002.38,-20436.35 3992.4,-20432.8 3997.98,-20441.8 4002.38,-20436.35"/>
</g>
<!-- gpu6_layer0_res2 -->
<g id="node1579" class="node">
<title>gpu6_layer0_res2</title>
<polygon fill="lightblue" stroke="black" points="3990,-20291.63 3868,-20291.63 3868,-20239.63 3990,-20239.63 3990,-20291.63"/>
<text text-anchor="middle" x="3929" y="-20279.63" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3929" y="-20268.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-20257.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-20246.63" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer0_expert_agg&#45;&gt;gpu6_layer0_res2 -->
<g id="edge1966" class="edge">
<title>gpu6_layer0_expert_agg&#45;&gt;gpu6_layer0_res2</title>
<path fill="none" stroke="black" d="M3929,-20328.42C3929,-20319.46 3929,-20310.34 3929,-20301.94"/>
<polygon fill="black" stroke="black" points="3932.5,-20301.76 3929,-20291.76 3925.5,-20301.76 3932.5,-20301.76"/>
</g>
<!-- gpu6_layer1_ln1 -->
<g id="node1580" class="node">
<title>gpu6_layer1_ln1</title>
<polygon fill="lightblue" stroke="black" points="3990,-20202.63 3868,-20202.63 3868,-20150.63 3990,-20150.63 3990,-20202.63"/>
<text text-anchor="middle" x="3929" y="-20190.63" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3929" y="-20179.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-20168.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-20157.63" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer0_res2&#45;&gt;gpu6_layer1_ln1 -->
<g id="edge1971" class="edge">
<title>gpu6_layer0_res2&#45;&gt;gpu6_layer1_ln1</title>
<path fill="none" stroke="black" d="M3929,-20239.46C3929,-20231.17 3929,-20221.78 3929,-20212.87"/>
<polygon fill="black" stroke="black" points="3932.5,-20212.73 3929,-20202.73 3925.5,-20212.73 3932.5,-20212.73"/>
</g>
<!-- gpu6_layer1_qkv -->
<g id="node1581" class="node">
<title>gpu6_layer1_qkv</title>
<polygon fill="lightblue" stroke="black" points="3990,-20113.63 3868,-20113.63 3868,-20061.63 3990,-20061.63 3990,-20113.63"/>
<text text-anchor="middle" x="3929" y="-20101.63" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3929" y="-20090.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-20079.63" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-20068.63" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer1_ln1&#45;&gt;gpu6_layer1_qkv -->
<g id="edge1972" class="edge">
<title>gpu6_layer1_ln1&#45;&gt;gpu6_layer1_qkv</title>
<path fill="none" stroke="black" d="M3929,-20150.46C3929,-20142.17 3929,-20132.78 3929,-20123.87"/>
<polygon fill="black" stroke="black" points="3932.5,-20123.73 3929,-20113.73 3925.5,-20123.73 3932.5,-20123.73"/>
</g>
<!-- gpu6_layer1_reshape -->
<g id="node1582" class="node">
<title>gpu6_layer1_reshape</title>
<polygon fill="lightblue" stroke="black" points="3993,-20024.63 3865,-20024.63 3865,-19972.63 3993,-19972.63 3993,-20024.63"/>
<text text-anchor="middle" x="3929" y="-20012.63" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3929" y="-20001.63" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-19990.63" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-19979.63" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer1_qkv&#45;&gt;gpu6_layer1_reshape -->
<g id="edge1973" class="edge">
<title>gpu6_layer1_qkv&#45;&gt;gpu6_layer1_reshape</title>
<path fill="none" stroke="black" d="M3929,-20061.46C3929,-20053.17 3929,-20043.78 3929,-20034.87"/>
<polygon fill="black" stroke="black" points="3932.5,-20034.73 3929,-20024.73 3925.5,-20034.73 3932.5,-20034.73"/>
</g>
<!-- gpu6_layer1_attn -->
<g id="node1583" class="node">
<title>gpu6_layer1_attn</title>
<polygon fill="lightblue" stroke="black" points="3993,-19935.63 3865,-19935.63 3865,-19883.63 3993,-19883.63 3993,-19935.63"/>
<text text-anchor="middle" x="3929" y="-19923.63" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3929" y="-19912.63" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-19901.63" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-19890.63" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer1_reshape&#45;&gt;gpu6_layer1_attn -->
<g id="edge1974" class="edge">
<title>gpu6_layer1_reshape&#45;&gt;gpu6_layer1_attn</title>
<path fill="none" stroke="black" d="M3929,-19972.46C3929,-19964.17 3929,-19954.78 3929,-19945.87"/>
<polygon fill="black" stroke="black" points="3932.5,-19945.73 3929,-19935.73 3925.5,-19945.73 3932.5,-19945.73"/>
</g>
<!-- gpu6_layer1_attn_reshape -->
<g id="node1585" class="node">
<title>gpu6_layer1_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3990,-19846.63 3868,-19846.63 3868,-19794.63 3990,-19794.63 3990,-19846.63"/>
<text text-anchor="middle" x="3929" y="-19834.63" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3929" y="-19823.63" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-19812.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-19801.63" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer1_attn&#45;&gt;gpu6_layer1_attn_reshape -->
<g id="edge1975" class="edge">
<title>gpu6_layer1_attn&#45;&gt;gpu6_layer1_attn_reshape</title>
<path fill="none" stroke="black" d="M3929,-19883.46C3929,-19875.17 3929,-19865.78 3929,-19856.87"/>
<polygon fill="black" stroke="black" points="3932.5,-19856.73 3929,-19846.73 3925.5,-19856.73 3932.5,-19856.73"/>
</g>
<!-- gpu6_layer1_attn_out -->
<g id="node1584" class="node">
<title>gpu6_layer1_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3990,-19757.63 3868,-19757.63 3868,-19705.63 3990,-19705.63 3990,-19757.63"/>
<text text-anchor="middle" x="3929" y="-19745.63" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3929" y="-19734.63" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-19723.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-19712.63" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer1_kv_update -->
<g id="node1586" class="node">
<title>gpu6_layer1_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3929" cy="-19631.86" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3929" y="-19645.86" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3929" y="-19634.86" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-19623.86" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-19612.86" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer1_attn_out&#45;&gt;gpu6_layer1_kv_update -->
<g id="edge1977" class="edge">
<title>gpu6_layer1_attn_out&#45;&gt;gpu6_layer1_kv_update</title>
<path fill="none" stroke="black" d="M3929,-19705.45C3929,-19697.31 3929,-19688.01 3929,-19678.85"/>
<polygon fill="black" stroke="black" points="3932.5,-19678.64 3929,-19668.64 3925.5,-19678.64 3932.5,-19678.64"/>
</g>
<!-- gpu6_layer1_attn_reshape&#45;&gt;gpu6_layer1_attn_out -->
<g id="edge1976" class="edge">
<title>gpu6_layer1_attn_reshape&#45;&gt;gpu6_layer1_attn_out</title>
<path fill="none" stroke="black" d="M3929,-19794.46C3929,-19786.17 3929,-19776.78 3929,-19767.87"/>
<polygon fill="black" stroke="black" points="3932.5,-19767.73 3929,-19757.73 3925.5,-19767.73 3932.5,-19767.73"/>
</g>
<!-- gpu6_layer1_res1 -->
<g id="node1587" class="node">
<title>gpu6_layer1_res1</title>
<polygon fill="lightblue" stroke="black" points="3990,-19558.09 3868,-19558.09 3868,-19506.09 3990,-19506.09 3990,-19558.09"/>
<text text-anchor="middle" x="3929" y="-19546.09" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3929" y="-19535.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-19524.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-19513.09" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer1_kv_update&#45;&gt;gpu6_layer1_res1 -->
<g id="edge1978" class="edge">
<title>gpu6_layer1_kv_update&#45;&gt;gpu6_layer1_res1</title>
<path fill="none" stroke="black" d="M3929,-19595.01C3929,-19586.33 3929,-19577.06 3929,-19568.4"/>
<polygon fill="black" stroke="black" points="3932.5,-19568.23 3929,-19558.23 3925.5,-19568.23 3932.5,-19568.23"/>
</g>
<!-- gpu6_layer1_ln2 -->
<g id="node1588" class="node">
<title>gpu6_layer1_ln2</title>
<polygon fill="lightblue" stroke="black" points="3990,-19469.09 3868,-19469.09 3868,-19417.09 3990,-19417.09 3990,-19469.09"/>
<text text-anchor="middle" x="3929" y="-19457.09" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3929" y="-19446.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-19435.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-19424.09" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer1_res1&#45;&gt;gpu6_layer1_ln2 -->
<g id="edge1979" class="edge">
<title>gpu6_layer1_res1&#45;&gt;gpu6_layer1_ln2</title>
<path fill="none" stroke="black" d="M3929,-19505.92C3929,-19497.63 3929,-19488.24 3929,-19479.34"/>
<polygon fill="black" stroke="black" points="3932.5,-19479.19 3929,-19469.19 3925.5,-19479.19 3932.5,-19479.19"/>
</g>
<!-- gpu6_layer1_routing -->
<g id="node1589" class="node">
<title>gpu6_layer1_routing</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-19380.09 3854.29,-19380.09 3802.53,-19254.09 4003.71,-19254.09 4055.47,-19380.09"/>
<text text-anchor="middle" x="3929" y="-19336.59" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3929" y="-19325.59" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-19314.59" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-19303.59" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3929" y="-19292.59" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer1_ln2&#45;&gt;gpu6_layer1_routing -->
<g id="edge1980" class="edge">
<title>gpu6_layer1_ln2&#45;&gt;gpu6_layer1_routing</title>
<path fill="none" stroke="black" d="M3929,-19416.99C3929,-19409.06 3929,-19399.86 3929,-19390.33"/>
<polygon fill="black" stroke="black" points="3932.5,-19390.32 3929,-19380.32 3925.5,-19390.32 3932.5,-19390.32"/>
</g>
<!-- gpu6_layer1_expert0 -->
<g id="node1590" class="node">
<title>gpu6_layer1_expert0</title>
<polygon fill="lightblue" stroke="black" points="3710,-19208.09 3588,-19208.09 3588,-19156.09 3710,-19156.09 3710,-19208.09"/>
<text text-anchor="middle" x="3649" y="-19196.09" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3649" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer1_routing&#45;&gt;gpu6_layer1_expert0 -->
<g id="edge1967" class="edge">
<title>gpu6_layer1_routing&#45;&gt;gpu6_layer1_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3803.33,-19256.39C3771.34,-19241.2 3738.34,-19225.52 3711.11,-19212.59"/>
<polygon fill="black" stroke="black" points="3712.26,-19209.26 3701.73,-19208.13 3709.26,-19215.58 3712.26,-19209.26"/>
<text text-anchor="middle" x="3784.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer1_expert1 -->
<g id="node1591" class="node">
<title>gpu6_layer1_expert1</title>
<polygon fill="lightblue" stroke="black" points="3850,-19208.09 3728,-19208.09 3728,-19156.09 3850,-19156.09 3850,-19208.09"/>
<text text-anchor="middle" x="3789" y="-19196.09" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3789" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer1_routing&#45;&gt;gpu6_layer1_expert1 -->
<g id="edge1968" class="edge">
<title>gpu6_layer1_routing&#45;&gt;gpu6_layer1_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3863.51,-19253.87C3849.48,-19240.55 3835.21,-19226.99 3822.97,-19215.36"/>
<polygon fill="black" stroke="black" points="3825.29,-19212.73 3815.63,-19208.38 3820.46,-19217.81 3825.29,-19212.73"/>
<text text-anchor="middle" x="3871.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer1_expert2 -->
<g id="node1592" class="node">
<title>gpu6_layer1_expert2</title>
<polygon fill="lightblue" stroke="black" points="3990,-19208.09 3868,-19208.09 3868,-19156.09 3990,-19156.09 3990,-19208.09"/>
<text text-anchor="middle" x="3929" y="-19196.09" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3929" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer1_routing&#45;&gt;gpu6_layer1_expert2 -->
<g id="edge1969" class="edge">
<title>gpu6_layer1_routing&#45;&gt;gpu6_layer1_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3929,-19253.87C3929,-19241.8 3929,-19229.55 3929,-19218.7"/>
<polygon fill="black" stroke="black" points="3932.5,-19218.38 3929,-19208.38 3925.5,-19218.38 3932.5,-19218.38"/>
<text text-anchor="middle" x="3958.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer1_expert3 -->
<g id="node1593" class="node">
<title>gpu6_layer1_expert3</title>
<polygon fill="lightblue" stroke="black" points="4130,-19208.09 4008,-19208.09 4008,-19156.09 4130,-19156.09 4130,-19208.09"/>
<text text-anchor="middle" x="4069" y="-19196.09" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4069" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer1_routing&#45;&gt;gpu6_layer1_expert3 -->
<g id="edge1970" class="edge">
<title>gpu6_layer1_routing&#45;&gt;gpu6_layer1_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3994.49,-19253.87C4008.52,-19240.55 4022.79,-19226.99 4035.03,-19215.36"/>
<polygon fill="black" stroke="black" points="4037.54,-19217.81 4042.37,-19208.38 4032.71,-19212.73 4037.54,-19217.81"/>
<text text-anchor="middle" x="4052.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer1_expert_agg -->
<g id="node1594" class="node">
<title>gpu6_layer1_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-19119.09 3854.29,-19119.09 3802.53,-19015.09 4003.71,-19015.09 4055.47,-19119.09"/>
<text text-anchor="middle" x="3929" y="-19081.09" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3929" y="-19070.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-19059.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-19048.09" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer1_routing&#45;&gt;gpu6_layer1_expert_agg -->
<g id="edge1985" class="edge">
<title>gpu6_layer1_routing&#45;&gt;gpu6_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M4018.22,-19289.17C4091.96,-19262.01 4178.6,-19215.62 4139,-19156.09 4118.44,-19125.17 4084.7,-19105.1 4050.22,-19092.07"/>
<polygon fill="black" stroke="black" points="4051.08,-19088.66 4040.48,-19088.58 4048.71,-19095.25 4051.08,-19088.66"/>
</g>
<!-- gpu6_layer1_expert0&#45;&gt;gpu6_layer1_expert_agg -->
<g id="edge1981" class="edge">
<title>gpu6_layer1_expert0&#45;&gt;gpu6_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3710.1,-19156.43C3746.98,-19141.55 3794.7,-19122.29 3836.16,-19105.55"/>
<polygon fill="black" stroke="black" points="3837.5,-19108.79 3845.46,-19101.8 3834.88,-19102.3 3837.5,-19108.79"/>
</g>
<!-- gpu6_layer1_expert1&#45;&gt;gpu6_layer1_expert_agg -->
<g id="edge1982" class="edge">
<title>gpu6_layer1_expert1&#45;&gt;gpu6_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3820.07,-19156.01C3831.32,-19146.93 3844.53,-19136.27 3857.8,-19125.56"/>
<polygon fill="black" stroke="black" points="3860.02,-19128.26 3865.6,-19119.26 3855.62,-19122.82 3860.02,-19128.26"/>
</g>
<!-- gpu6_layer1_expert2&#45;&gt;gpu6_layer1_expert_agg -->
<g id="edge1983" class="edge">
<title>gpu6_layer1_expert2&#45;&gt;gpu6_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3929,-19156.01C3929,-19148.08 3929,-19138.95 3929,-19129.62"/>
<polygon fill="black" stroke="black" points="3932.5,-19129.49 3929,-19119.49 3925.5,-19129.49 3932.5,-19129.49"/>
</g>
<!-- gpu6_layer1_expert3&#45;&gt;gpu6_layer1_expert_agg -->
<g id="edge1984" class="edge">
<title>gpu6_layer1_expert3&#45;&gt;gpu6_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M4037.93,-19156.01C4026.68,-19146.93 4013.47,-19136.27 4000.2,-19125.56"/>
<polygon fill="black" stroke="black" points="4002.38,-19122.82 3992.4,-19119.26 3997.98,-19128.26 4002.38,-19122.82"/>
</g>
<!-- gpu6_layer1_res2 -->
<g id="node1595" class="node">
<title>gpu6_layer1_res2</title>
<polygon fill="lightblue" stroke="black" points="3990,-18978.09 3868,-18978.09 3868,-18926.09 3990,-18926.09 3990,-18978.09"/>
<text text-anchor="middle" x="3929" y="-18966.09" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3929" y="-18955.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-18944.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-18933.09" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer1_expert_agg&#45;&gt;gpu6_layer1_res2 -->
<g id="edge1986" class="edge">
<title>gpu6_layer1_expert_agg&#45;&gt;gpu6_layer1_res2</title>
<path fill="none" stroke="black" d="M3929,-19014.88C3929,-19005.93 3929,-18996.8 3929,-18988.4"/>
<polygon fill="black" stroke="black" points="3932.5,-18988.22 3929,-18978.22 3925.5,-18988.22 3932.5,-18988.22"/>
</g>
<!-- gpu6_layer2_ln1 -->
<g id="node1596" class="node">
<title>gpu6_layer2_ln1</title>
<polygon fill="lightblue" stroke="black" points="3990,-18889.09 3868,-18889.09 3868,-18837.09 3990,-18837.09 3990,-18889.09"/>
<text text-anchor="middle" x="3929" y="-18877.09" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3929" y="-18866.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-18855.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-18844.09" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer1_res2&#45;&gt;gpu6_layer2_ln1 -->
<g id="edge1991" class="edge">
<title>gpu6_layer1_res2&#45;&gt;gpu6_layer2_ln1</title>
<path fill="none" stroke="black" d="M3929,-18925.92C3929,-18917.63 3929,-18908.24 3929,-18899.34"/>
<polygon fill="black" stroke="black" points="3932.5,-18899.19 3929,-18889.19 3925.5,-18899.19 3932.5,-18899.19"/>
</g>
<!-- gpu6_layer2_qkv -->
<g id="node1597" class="node">
<title>gpu6_layer2_qkv</title>
<polygon fill="lightblue" stroke="black" points="3990,-18800.09 3868,-18800.09 3868,-18748.09 3990,-18748.09 3990,-18800.09"/>
<text text-anchor="middle" x="3929" y="-18788.09" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3929" y="-18777.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-18766.09" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-18755.09" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer2_ln1&#45;&gt;gpu6_layer2_qkv -->
<g id="edge1992" class="edge">
<title>gpu6_layer2_ln1&#45;&gt;gpu6_layer2_qkv</title>
<path fill="none" stroke="black" d="M3929,-18836.92C3929,-18828.63 3929,-18819.24 3929,-18810.34"/>
<polygon fill="black" stroke="black" points="3932.5,-18810.19 3929,-18800.19 3925.5,-18810.19 3932.5,-18810.19"/>
</g>
<!-- gpu6_layer2_reshape -->
<g id="node1598" class="node">
<title>gpu6_layer2_reshape</title>
<polygon fill="lightblue" stroke="black" points="3993,-18711.09 3865,-18711.09 3865,-18659.09 3993,-18659.09 3993,-18711.09"/>
<text text-anchor="middle" x="3929" y="-18699.09" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3929" y="-18688.09" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-18677.09" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-18666.09" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer2_qkv&#45;&gt;gpu6_layer2_reshape -->
<g id="edge1993" class="edge">
<title>gpu6_layer2_qkv&#45;&gt;gpu6_layer2_reshape</title>
<path fill="none" stroke="black" d="M3929,-18747.92C3929,-18739.63 3929,-18730.24 3929,-18721.34"/>
<polygon fill="black" stroke="black" points="3932.5,-18721.19 3929,-18711.19 3925.5,-18721.19 3932.5,-18721.19"/>
</g>
<!-- gpu6_layer2_attn -->
<g id="node1599" class="node">
<title>gpu6_layer2_attn</title>
<polygon fill="lightblue" stroke="black" points="3993,-18622.09 3865,-18622.09 3865,-18570.09 3993,-18570.09 3993,-18622.09"/>
<text text-anchor="middle" x="3929" y="-18610.09" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3929" y="-18599.09" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-18588.09" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-18577.09" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer2_reshape&#45;&gt;gpu6_layer2_attn -->
<g id="edge1994" class="edge">
<title>gpu6_layer2_reshape&#45;&gt;gpu6_layer2_attn</title>
<path fill="none" stroke="black" d="M3929,-18658.92C3929,-18650.63 3929,-18641.24 3929,-18632.34"/>
<polygon fill="black" stroke="black" points="3932.5,-18632.19 3929,-18622.19 3925.5,-18632.19 3932.5,-18632.19"/>
</g>
<!-- gpu6_layer2_attn_reshape -->
<g id="node1601" class="node">
<title>gpu6_layer2_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3990,-18533.09 3868,-18533.09 3868,-18481.09 3990,-18481.09 3990,-18533.09"/>
<text text-anchor="middle" x="3929" y="-18521.09" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3929" y="-18510.09" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-18499.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-18488.09" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer2_attn&#45;&gt;gpu6_layer2_attn_reshape -->
<g id="edge1995" class="edge">
<title>gpu6_layer2_attn&#45;&gt;gpu6_layer2_attn_reshape</title>
<path fill="none" stroke="black" d="M3929,-18569.92C3929,-18561.63 3929,-18552.24 3929,-18543.34"/>
<polygon fill="black" stroke="black" points="3932.5,-18543.19 3929,-18533.19 3925.5,-18543.19 3932.5,-18543.19"/>
</g>
<!-- gpu6_layer2_attn_out -->
<g id="node1600" class="node">
<title>gpu6_layer2_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3990,-18444.09 3868,-18444.09 3868,-18392.09 3990,-18392.09 3990,-18444.09"/>
<text text-anchor="middle" x="3929" y="-18432.09" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3929" y="-18421.09" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-18410.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-18399.09" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer2_kv_update -->
<g id="node1602" class="node">
<title>gpu6_layer2_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3929" cy="-18318.32" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3929" y="-18332.32" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3929" y="-18321.32" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-18310.32" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-18299.32" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer2_attn_out&#45;&gt;gpu6_layer2_kv_update -->
<g id="edge1997" class="edge">
<title>gpu6_layer2_attn_out&#45;&gt;gpu6_layer2_kv_update</title>
<path fill="none" stroke="black" d="M3929,-18391.91C3929,-18383.77 3929,-18374.47 3929,-18365.31"/>
<polygon fill="black" stroke="black" points="3932.5,-18365.1 3929,-18355.1 3925.5,-18365.1 3932.5,-18365.1"/>
</g>
<!-- gpu6_layer2_attn_reshape&#45;&gt;gpu6_layer2_attn_out -->
<g id="edge1996" class="edge">
<title>gpu6_layer2_attn_reshape&#45;&gt;gpu6_layer2_attn_out</title>
<path fill="none" stroke="black" d="M3929,-18480.92C3929,-18472.63 3929,-18463.24 3929,-18454.34"/>
<polygon fill="black" stroke="black" points="3932.5,-18454.19 3929,-18444.19 3925.5,-18454.19 3932.5,-18454.19"/>
</g>
<!-- gpu6_layer2_res1 -->
<g id="node1603" class="node">
<title>gpu6_layer2_res1</title>
<polygon fill="lightblue" stroke="black" points="3990,-18244.55 3868,-18244.55 3868,-18192.55 3990,-18192.55 3990,-18244.55"/>
<text text-anchor="middle" x="3929" y="-18232.55" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3929" y="-18221.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-18210.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-18199.55" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer2_kv_update&#45;&gt;gpu6_layer2_res1 -->
<g id="edge1998" class="edge">
<title>gpu6_layer2_kv_update&#45;&gt;gpu6_layer2_res1</title>
<path fill="none" stroke="black" d="M3929,-18281.47C3929,-18272.79 3929,-18263.52 3929,-18254.86"/>
<polygon fill="black" stroke="black" points="3932.5,-18254.69 3929,-18244.69 3925.5,-18254.69 3932.5,-18254.69"/>
</g>
<!-- gpu6_layer2_ln2 -->
<g id="node1604" class="node">
<title>gpu6_layer2_ln2</title>
<polygon fill="lightblue" stroke="black" points="3990,-18155.55 3868,-18155.55 3868,-18103.55 3990,-18103.55 3990,-18155.55"/>
<text text-anchor="middle" x="3929" y="-18143.55" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3929" y="-18132.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-18121.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-18110.55" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer2_res1&#45;&gt;gpu6_layer2_ln2 -->
<g id="edge1999" class="edge">
<title>gpu6_layer2_res1&#45;&gt;gpu6_layer2_ln2</title>
<path fill="none" stroke="black" d="M3929,-18192.38C3929,-18184.09 3929,-18174.7 3929,-18165.8"/>
<polygon fill="black" stroke="black" points="3932.5,-18165.65 3929,-18155.65 3925.5,-18165.65 3932.5,-18165.65"/>
</g>
<!-- gpu6_layer2_routing -->
<g id="node1605" class="node">
<title>gpu6_layer2_routing</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-18066.55 3854.29,-18066.55 3802.53,-17940.55 4003.71,-17940.55 4055.47,-18066.55"/>
<text text-anchor="middle" x="3929" y="-18023.05" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3929" y="-18012.05" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-18001.05" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-17990.05" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3929" y="-17979.05" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer2_ln2&#45;&gt;gpu6_layer2_routing -->
<g id="edge2000" class="edge">
<title>gpu6_layer2_ln2&#45;&gt;gpu6_layer2_routing</title>
<path fill="none" stroke="black" d="M3929,-18103.45C3929,-18095.52 3929,-18086.33 3929,-18076.8"/>
<polygon fill="black" stroke="black" points="3932.5,-18076.78 3929,-18066.78 3925.5,-18076.78 3932.5,-18076.78"/>
</g>
<!-- gpu6_layer2_expert0 -->
<g id="node1606" class="node">
<title>gpu6_layer2_expert0</title>
<polygon fill="lightblue" stroke="black" points="3710,-17894.55 3588,-17894.55 3588,-17842.55 3710,-17842.55 3710,-17894.55"/>
<text text-anchor="middle" x="3649" y="-17882.55" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3649" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer2_routing&#45;&gt;gpu6_layer2_expert0 -->
<g id="edge1987" class="edge">
<title>gpu6_layer2_routing&#45;&gt;gpu6_layer2_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3803.33,-17942.86C3771.34,-17927.66 3738.34,-17911.98 3711.11,-17899.05"/>
<polygon fill="black" stroke="black" points="3712.26,-17895.72 3701.73,-17894.59 3709.26,-17902.04 3712.26,-17895.72"/>
<text text-anchor="middle" x="3784.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer2_expert1 -->
<g id="node1607" class="node">
<title>gpu6_layer2_expert1</title>
<polygon fill="lightblue" stroke="black" points="3850,-17894.55 3728,-17894.55 3728,-17842.55 3850,-17842.55 3850,-17894.55"/>
<text text-anchor="middle" x="3789" y="-17882.55" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3789" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer2_routing&#45;&gt;gpu6_layer2_expert1 -->
<g id="edge1988" class="edge">
<title>gpu6_layer2_routing&#45;&gt;gpu6_layer2_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3863.51,-17940.33C3849.48,-17927.01 3835.21,-17913.45 3822.97,-17901.82"/>
<polygon fill="black" stroke="black" points="3825.29,-17899.19 3815.63,-17894.84 3820.46,-17904.27 3825.29,-17899.19"/>
<text text-anchor="middle" x="3871.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer2_expert2 -->
<g id="node1608" class="node">
<title>gpu6_layer2_expert2</title>
<polygon fill="lightblue" stroke="black" points="3990,-17894.55 3868,-17894.55 3868,-17842.55 3990,-17842.55 3990,-17894.55"/>
<text text-anchor="middle" x="3929" y="-17882.55" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3929" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer2_routing&#45;&gt;gpu6_layer2_expert2 -->
<g id="edge1989" class="edge">
<title>gpu6_layer2_routing&#45;&gt;gpu6_layer2_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3929,-17940.33C3929,-17928.26 3929,-17916.01 3929,-17905.16"/>
<polygon fill="black" stroke="black" points="3932.5,-17904.84 3929,-17894.84 3925.5,-17904.84 3932.5,-17904.84"/>
<text text-anchor="middle" x="3958.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer2_expert3 -->
<g id="node1609" class="node">
<title>gpu6_layer2_expert3</title>
<polygon fill="lightblue" stroke="black" points="4130,-17894.55 4008,-17894.55 4008,-17842.55 4130,-17842.55 4130,-17894.55"/>
<text text-anchor="middle" x="4069" y="-17882.55" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4069" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer2_routing&#45;&gt;gpu6_layer2_expert3 -->
<g id="edge1990" class="edge">
<title>gpu6_layer2_routing&#45;&gt;gpu6_layer2_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3994.49,-17940.33C4008.52,-17927.01 4022.79,-17913.45 4035.03,-17901.82"/>
<polygon fill="black" stroke="black" points="4037.54,-17904.27 4042.37,-17894.84 4032.71,-17899.19 4037.54,-17904.27"/>
<text text-anchor="middle" x="4052.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer2_expert_agg -->
<g id="node1610" class="node">
<title>gpu6_layer2_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-17805.55 3854.29,-17805.55 3802.53,-17701.55 4003.71,-17701.55 4055.47,-17805.55"/>
<text text-anchor="middle" x="3929" y="-17767.55" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3929" y="-17756.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-17745.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-17734.55" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer2_routing&#45;&gt;gpu6_layer2_expert_agg -->
<g id="edge2005" class="edge">
<title>gpu6_layer2_routing&#45;&gt;gpu6_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M4018.22,-17975.63C4091.96,-17948.47 4178.6,-17902.08 4139,-17842.55 4118.44,-17811.64 4084.7,-17791.56 4050.22,-17778.53"/>
<polygon fill="black" stroke="black" points="4051.08,-17775.12 4040.48,-17775.04 4048.71,-17781.71 4051.08,-17775.12"/>
</g>
<!-- gpu6_layer2_expert0&#45;&gt;gpu6_layer2_expert_agg -->
<g id="edge2001" class="edge">
<title>gpu6_layer2_expert0&#45;&gt;gpu6_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M3710.1,-17842.89C3746.98,-17828.01 3794.7,-17808.75 3836.16,-17792.01"/>
<polygon fill="black" stroke="black" points="3837.5,-17795.25 3845.46,-17788.26 3834.88,-17788.76 3837.5,-17795.25"/>
</g>
<!-- gpu6_layer2_expert1&#45;&gt;gpu6_layer2_expert_agg -->
<g id="edge2002" class="edge">
<title>gpu6_layer2_expert1&#45;&gt;gpu6_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M3820.07,-17842.47C3831.32,-17833.39 3844.53,-17822.73 3857.8,-17812.02"/>
<polygon fill="black" stroke="black" points="3860.02,-17814.72 3865.6,-17805.72 3855.62,-17809.28 3860.02,-17814.72"/>
</g>
<!-- gpu6_layer2_expert2&#45;&gt;gpu6_layer2_expert_agg -->
<g id="edge2003" class="edge">
<title>gpu6_layer2_expert2&#45;&gt;gpu6_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M3929,-17842.47C3929,-17834.54 3929,-17825.41 3929,-17816.09"/>
<polygon fill="black" stroke="black" points="3932.5,-17815.95 3929,-17805.95 3925.5,-17815.95 3932.5,-17815.95"/>
</g>
<!-- gpu6_layer2_expert3&#45;&gt;gpu6_layer2_expert_agg -->
<g id="edge2004" class="edge">
<title>gpu6_layer2_expert3&#45;&gt;gpu6_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M4037.93,-17842.47C4026.68,-17833.39 4013.47,-17822.73 4000.2,-17812.02"/>
<polygon fill="black" stroke="black" points="4002.38,-17809.28 3992.4,-17805.72 3997.98,-17814.72 4002.38,-17809.28"/>
</g>
<!-- gpu6_layer2_res2 -->
<g id="node1611" class="node">
<title>gpu6_layer2_res2</title>
<polygon fill="lightblue" stroke="black" points="3990,-17664.55 3868,-17664.55 3868,-17612.55 3990,-17612.55 3990,-17664.55"/>
<text text-anchor="middle" x="3929" y="-17652.55" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3929" y="-17641.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-17630.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-17619.55" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer2_expert_agg&#45;&gt;gpu6_layer2_res2 -->
<g id="edge2006" class="edge">
<title>gpu6_layer2_expert_agg&#45;&gt;gpu6_layer2_res2</title>
<path fill="none" stroke="black" d="M3929,-17701.34C3929,-17692.39 3929,-17683.26 3929,-17674.86"/>
<polygon fill="black" stroke="black" points="3932.5,-17674.68 3929,-17664.68 3925.5,-17674.68 3932.5,-17674.68"/>
</g>
<!-- gpu6_layer3_ln1 -->
<g id="node1612" class="node">
<title>gpu6_layer3_ln1</title>
<polygon fill="lightblue" stroke="black" points="3990,-17575.55 3868,-17575.55 3868,-17523.55 3990,-17523.55 3990,-17575.55"/>
<text text-anchor="middle" x="3929" y="-17563.55" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3929" y="-17552.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-17541.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-17530.55" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer2_res2&#45;&gt;gpu6_layer3_ln1 -->
<g id="edge2011" class="edge">
<title>gpu6_layer2_res2&#45;&gt;gpu6_layer3_ln1</title>
<path fill="none" stroke="black" d="M3929,-17612.38C3929,-17604.09 3929,-17594.7 3929,-17585.8"/>
<polygon fill="black" stroke="black" points="3932.5,-17585.65 3929,-17575.65 3925.5,-17585.65 3932.5,-17585.65"/>
</g>
<!-- gpu6_layer3_qkv -->
<g id="node1613" class="node">
<title>gpu6_layer3_qkv</title>
<polygon fill="lightblue" stroke="black" points="3990,-17486.55 3868,-17486.55 3868,-17434.55 3990,-17434.55 3990,-17486.55"/>
<text text-anchor="middle" x="3929" y="-17474.55" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3929" y="-17463.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-17452.55" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-17441.55" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer3_ln1&#45;&gt;gpu6_layer3_qkv -->
<g id="edge2012" class="edge">
<title>gpu6_layer3_ln1&#45;&gt;gpu6_layer3_qkv</title>
<path fill="none" stroke="black" d="M3929,-17523.38C3929,-17515.09 3929,-17505.7 3929,-17496.8"/>
<polygon fill="black" stroke="black" points="3932.5,-17496.65 3929,-17486.65 3925.5,-17496.65 3932.5,-17496.65"/>
</g>
<!-- gpu6_layer3_reshape -->
<g id="node1614" class="node">
<title>gpu6_layer3_reshape</title>
<polygon fill="lightblue" stroke="black" points="3993,-17397.55 3865,-17397.55 3865,-17345.55 3993,-17345.55 3993,-17397.55"/>
<text text-anchor="middle" x="3929" y="-17385.55" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3929" y="-17374.55" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-17363.55" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-17352.55" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer3_qkv&#45;&gt;gpu6_layer3_reshape -->
<g id="edge2013" class="edge">
<title>gpu6_layer3_qkv&#45;&gt;gpu6_layer3_reshape</title>
<path fill="none" stroke="black" d="M3929,-17434.38C3929,-17426.09 3929,-17416.7 3929,-17407.8"/>
<polygon fill="black" stroke="black" points="3932.5,-17407.65 3929,-17397.65 3925.5,-17407.65 3932.5,-17407.65"/>
</g>
<!-- gpu6_layer3_attn -->
<g id="node1615" class="node">
<title>gpu6_layer3_attn</title>
<polygon fill="lightblue" stroke="black" points="3993,-17308.55 3865,-17308.55 3865,-17256.55 3993,-17256.55 3993,-17308.55"/>
<text text-anchor="middle" x="3929" y="-17296.55" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3929" y="-17285.55" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-17274.55" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-17263.55" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer3_reshape&#45;&gt;gpu6_layer3_attn -->
<g id="edge2014" class="edge">
<title>gpu6_layer3_reshape&#45;&gt;gpu6_layer3_attn</title>
<path fill="none" stroke="black" d="M3929,-17345.38C3929,-17337.09 3929,-17327.7 3929,-17318.8"/>
<polygon fill="black" stroke="black" points="3932.5,-17318.65 3929,-17308.65 3925.5,-17318.65 3932.5,-17318.65"/>
</g>
<!-- gpu6_layer3_attn_reshape -->
<g id="node1617" class="node">
<title>gpu6_layer3_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3990,-17219.55 3868,-17219.55 3868,-17167.55 3990,-17167.55 3990,-17219.55"/>
<text text-anchor="middle" x="3929" y="-17207.55" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3929" y="-17196.55" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-17185.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-17174.55" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer3_attn&#45;&gt;gpu6_layer3_attn_reshape -->
<g id="edge2015" class="edge">
<title>gpu6_layer3_attn&#45;&gt;gpu6_layer3_attn_reshape</title>
<path fill="none" stroke="black" d="M3929,-17256.38C3929,-17248.09 3929,-17238.7 3929,-17229.8"/>
<polygon fill="black" stroke="black" points="3932.5,-17229.65 3929,-17219.65 3925.5,-17229.65 3932.5,-17229.65"/>
</g>
<!-- gpu6_layer3_attn_out -->
<g id="node1616" class="node">
<title>gpu6_layer3_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3990,-17130.55 3868,-17130.55 3868,-17078.55 3990,-17078.55 3990,-17130.55"/>
<text text-anchor="middle" x="3929" y="-17118.55" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3929" y="-17107.55" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-17096.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-17085.55" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer3_kv_update -->
<g id="node1618" class="node">
<title>gpu6_layer3_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3929" cy="-17004.78" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3929" y="-17018.78" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3929" y="-17007.78" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-16996.78" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-16985.78" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer3_attn_out&#45;&gt;gpu6_layer3_kv_update -->
<g id="edge2017" class="edge">
<title>gpu6_layer3_attn_out&#45;&gt;gpu6_layer3_kv_update</title>
<path fill="none" stroke="black" d="M3929,-17078.37C3929,-17070.23 3929,-17060.93 3929,-17051.77"/>
<polygon fill="black" stroke="black" points="3932.5,-17051.56 3929,-17041.56 3925.5,-17051.56 3932.5,-17051.56"/>
</g>
<!-- gpu6_layer3_attn_reshape&#45;&gt;gpu6_layer3_attn_out -->
<g id="edge2016" class="edge">
<title>gpu6_layer3_attn_reshape&#45;&gt;gpu6_layer3_attn_out</title>
<path fill="none" stroke="black" d="M3929,-17167.38C3929,-17159.09 3929,-17149.7 3929,-17140.8"/>
<polygon fill="black" stroke="black" points="3932.5,-17140.65 3929,-17130.65 3925.5,-17140.65 3932.5,-17140.65"/>
</g>
<!-- gpu6_layer3_res1 -->
<g id="node1619" class="node">
<title>gpu6_layer3_res1</title>
<polygon fill="lightblue" stroke="black" points="3990,-16931.01 3868,-16931.01 3868,-16879.01 3990,-16879.01 3990,-16931.01"/>
<text text-anchor="middle" x="3929" y="-16919.01" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3929" y="-16908.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-16897.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-16886.01" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer3_kv_update&#45;&gt;gpu6_layer3_res1 -->
<g id="edge2018" class="edge">
<title>gpu6_layer3_kv_update&#45;&gt;gpu6_layer3_res1</title>
<path fill="none" stroke="black" d="M3929,-16967.93C3929,-16959.25 3929,-16949.98 3929,-16941.32"/>
<polygon fill="black" stroke="black" points="3932.5,-16941.15 3929,-16931.15 3925.5,-16941.15 3932.5,-16941.15"/>
</g>
<!-- gpu6_layer3_ln2 -->
<g id="node1620" class="node">
<title>gpu6_layer3_ln2</title>
<polygon fill="lightblue" stroke="black" points="3990,-16842.01 3868,-16842.01 3868,-16790.01 3990,-16790.01 3990,-16842.01"/>
<text text-anchor="middle" x="3929" y="-16830.01" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3929" y="-16819.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-16808.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-16797.01" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer3_res1&#45;&gt;gpu6_layer3_ln2 -->
<g id="edge2019" class="edge">
<title>gpu6_layer3_res1&#45;&gt;gpu6_layer3_ln2</title>
<path fill="none" stroke="black" d="M3929,-16878.84C3929,-16870.55 3929,-16861.16 3929,-16852.26"/>
<polygon fill="black" stroke="black" points="3932.5,-16852.12 3929,-16842.12 3925.5,-16852.12 3932.5,-16852.12"/>
</g>
<!-- gpu6_layer3_routing -->
<g id="node1621" class="node">
<title>gpu6_layer3_routing</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-16753.01 3854.29,-16753.01 3802.53,-16627.01 4003.71,-16627.01 4055.47,-16753.01"/>
<text text-anchor="middle" x="3929" y="-16709.51" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3929" y="-16698.51" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-16687.51" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-16676.51" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3929" y="-16665.51" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer3_ln2&#45;&gt;gpu6_layer3_routing -->
<g id="edge2020" class="edge">
<title>gpu6_layer3_ln2&#45;&gt;gpu6_layer3_routing</title>
<path fill="none" stroke="black" d="M3929,-16789.92C3929,-16781.98 3929,-16772.79 3929,-16763.26"/>
<polygon fill="black" stroke="black" points="3932.5,-16763.24 3929,-16753.24 3925.5,-16763.24 3932.5,-16763.24"/>
</g>
<!-- gpu6_layer3_expert0 -->
<g id="node1622" class="node">
<title>gpu6_layer3_expert0</title>
<polygon fill="lightblue" stroke="black" points="3710,-16581.01 3588,-16581.01 3588,-16529.01 3710,-16529.01 3710,-16581.01"/>
<text text-anchor="middle" x="3649" y="-16569.01" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3649" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer3_routing&#45;&gt;gpu6_layer3_expert0 -->
<g id="edge2007" class="edge">
<title>gpu6_layer3_routing&#45;&gt;gpu6_layer3_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3803.33,-16629.32C3771.34,-16614.12 3738.34,-16598.44 3711.11,-16585.51"/>
<polygon fill="black" stroke="black" points="3712.26,-16582.18 3701.73,-16581.05 3709.26,-16588.51 3712.26,-16582.18"/>
<text text-anchor="middle" x="3784.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer3_expert1 -->
<g id="node1623" class="node">
<title>gpu6_layer3_expert1</title>
<polygon fill="lightblue" stroke="black" points="3850,-16581.01 3728,-16581.01 3728,-16529.01 3850,-16529.01 3850,-16581.01"/>
<text text-anchor="middle" x="3789" y="-16569.01" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3789" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer3_routing&#45;&gt;gpu6_layer3_expert1 -->
<g id="edge2008" class="edge">
<title>gpu6_layer3_routing&#45;&gt;gpu6_layer3_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3863.51,-16626.79C3849.48,-16613.47 3835.21,-16599.91 3822.97,-16588.28"/>
<polygon fill="black" stroke="black" points="3825.29,-16585.65 3815.63,-16581.3 3820.46,-16590.73 3825.29,-16585.65"/>
<text text-anchor="middle" x="3871.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer3_expert2 -->
<g id="node1624" class="node">
<title>gpu6_layer3_expert2</title>
<polygon fill="lightblue" stroke="black" points="3990,-16581.01 3868,-16581.01 3868,-16529.01 3990,-16529.01 3990,-16581.01"/>
<text text-anchor="middle" x="3929" y="-16569.01" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3929" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer3_routing&#45;&gt;gpu6_layer3_expert2 -->
<g id="edge2009" class="edge">
<title>gpu6_layer3_routing&#45;&gt;gpu6_layer3_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3929,-16626.79C3929,-16614.72 3929,-16602.47 3929,-16591.62"/>
<polygon fill="black" stroke="black" points="3932.5,-16591.3 3929,-16581.3 3925.5,-16591.3 3932.5,-16591.3"/>
<text text-anchor="middle" x="3958.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer3_expert3 -->
<g id="node1625" class="node">
<title>gpu6_layer3_expert3</title>
<polygon fill="lightblue" stroke="black" points="4130,-16581.01 4008,-16581.01 4008,-16529.01 4130,-16529.01 4130,-16581.01"/>
<text text-anchor="middle" x="4069" y="-16569.01" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4069" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer3_routing&#45;&gt;gpu6_layer3_expert3 -->
<g id="edge2010" class="edge">
<title>gpu6_layer3_routing&#45;&gt;gpu6_layer3_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3994.49,-16626.79C4008.52,-16613.47 4022.79,-16599.91 4035.03,-16588.28"/>
<polygon fill="black" stroke="black" points="4037.54,-16590.73 4042.37,-16581.3 4032.71,-16585.65 4037.54,-16590.73"/>
<text text-anchor="middle" x="4052.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer3_expert_agg -->
<g id="node1626" class="node">
<title>gpu6_layer3_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-16492.01 3854.29,-16492.01 3802.53,-16388.01 4003.71,-16388.01 4055.47,-16492.01"/>
<text text-anchor="middle" x="3929" y="-16454.01" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3929" y="-16443.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-16432.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-16421.01" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer3_routing&#45;&gt;gpu6_layer3_expert_agg -->
<g id="edge2025" class="edge">
<title>gpu6_layer3_routing&#45;&gt;gpu6_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M4018.22,-16662.09C4091.96,-16634.93 4178.6,-16588.54 4139,-16529.01 4118.44,-16498.1 4084.7,-16478.02 4050.22,-16464.99"/>
<polygon fill="black" stroke="black" points="4051.08,-16461.58 4040.48,-16461.5 4048.71,-16468.17 4051.08,-16461.58"/>
</g>
<!-- gpu6_layer3_expert0&#45;&gt;gpu6_layer3_expert_agg -->
<g id="edge2021" class="edge">
<title>gpu6_layer3_expert0&#45;&gt;gpu6_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M3710.1,-16529.35C3746.98,-16514.47 3794.7,-16495.21 3836.16,-16478.47"/>
<polygon fill="black" stroke="black" points="3837.5,-16481.71 3845.46,-16474.72 3834.88,-16475.22 3837.5,-16481.71"/>
</g>
<!-- gpu6_layer3_expert1&#45;&gt;gpu6_layer3_expert_agg -->
<g id="edge2022" class="edge">
<title>gpu6_layer3_expert1&#45;&gt;gpu6_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M3820.07,-16528.93C3831.32,-16519.85 3844.53,-16509.19 3857.8,-16498.48"/>
<polygon fill="black" stroke="black" points="3860.02,-16501.18 3865.6,-16492.18 3855.62,-16495.74 3860.02,-16501.18"/>
</g>
<!-- gpu6_layer3_expert2&#45;&gt;gpu6_layer3_expert_agg -->
<g id="edge2023" class="edge">
<title>gpu6_layer3_expert2&#45;&gt;gpu6_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M3929,-16528.93C3929,-16521 3929,-16511.87 3929,-16502.55"/>
<polygon fill="black" stroke="black" points="3932.5,-16502.41 3929,-16492.41 3925.5,-16502.41 3932.5,-16502.41"/>
</g>
<!-- gpu6_layer3_expert3&#45;&gt;gpu6_layer3_expert_agg -->
<g id="edge2024" class="edge">
<title>gpu6_layer3_expert3&#45;&gt;gpu6_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M4037.93,-16528.93C4026.68,-16519.85 4013.47,-16509.19 4000.2,-16498.48"/>
<polygon fill="black" stroke="black" points="4002.38,-16495.74 3992.4,-16492.18 3997.98,-16501.18 4002.38,-16495.74"/>
</g>
<!-- gpu6_layer3_res2 -->
<g id="node1627" class="node">
<title>gpu6_layer3_res2</title>
<polygon fill="lightblue" stroke="black" points="3990,-16351.01 3868,-16351.01 3868,-16299.01 3990,-16299.01 3990,-16351.01"/>
<text text-anchor="middle" x="3929" y="-16339.01" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3929" y="-16328.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-16317.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-16306.01" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer3_expert_agg&#45;&gt;gpu6_layer3_res2 -->
<g id="edge2026" class="edge">
<title>gpu6_layer3_expert_agg&#45;&gt;gpu6_layer3_res2</title>
<path fill="none" stroke="black" d="M3929,-16387.8C3929,-16378.85 3929,-16369.72 3929,-16361.32"/>
<polygon fill="black" stroke="black" points="3932.5,-16361.14 3929,-16351.14 3925.5,-16361.14 3932.5,-16361.14"/>
</g>
<!-- gpu6_layer4_ln1 -->
<g id="node1628" class="node">
<title>gpu6_layer4_ln1</title>
<polygon fill="lightblue" stroke="black" points="3990,-16262.01 3868,-16262.01 3868,-16210.01 3990,-16210.01 3990,-16262.01"/>
<text text-anchor="middle" x="3929" y="-16250.01" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3929" y="-16239.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-16228.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-16217.01" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer3_res2&#45;&gt;gpu6_layer4_ln1 -->
<g id="edge2031" class="edge">
<title>gpu6_layer3_res2&#45;&gt;gpu6_layer4_ln1</title>
<path fill="none" stroke="black" d="M3929,-16298.84C3929,-16290.55 3929,-16281.16 3929,-16272.26"/>
<polygon fill="black" stroke="black" points="3932.5,-16272.12 3929,-16262.12 3925.5,-16272.12 3932.5,-16272.12"/>
</g>
<!-- gpu6_layer4_qkv -->
<g id="node1629" class="node">
<title>gpu6_layer4_qkv</title>
<polygon fill="lightblue" stroke="black" points="3990,-16173.01 3868,-16173.01 3868,-16121.01 3990,-16121.01 3990,-16173.01"/>
<text text-anchor="middle" x="3929" y="-16161.01" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3929" y="-16150.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-16139.01" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-16128.01" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer4_ln1&#45;&gt;gpu6_layer4_qkv -->
<g id="edge2032" class="edge">
<title>gpu6_layer4_ln1&#45;&gt;gpu6_layer4_qkv</title>
<path fill="none" stroke="black" d="M3929,-16209.84C3929,-16201.55 3929,-16192.16 3929,-16183.26"/>
<polygon fill="black" stroke="black" points="3932.5,-16183.12 3929,-16173.12 3925.5,-16183.12 3932.5,-16183.12"/>
</g>
<!-- gpu6_layer4_reshape -->
<g id="node1630" class="node">
<title>gpu6_layer4_reshape</title>
<polygon fill="lightblue" stroke="black" points="3993,-16084.01 3865,-16084.01 3865,-16032.01 3993,-16032.01 3993,-16084.01"/>
<text text-anchor="middle" x="3929" y="-16072.01" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3929" y="-16061.01" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-16050.01" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-16039.01" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer4_qkv&#45;&gt;gpu6_layer4_reshape -->
<g id="edge2033" class="edge">
<title>gpu6_layer4_qkv&#45;&gt;gpu6_layer4_reshape</title>
<path fill="none" stroke="black" d="M3929,-16120.84C3929,-16112.55 3929,-16103.16 3929,-16094.26"/>
<polygon fill="black" stroke="black" points="3932.5,-16094.12 3929,-16084.12 3925.5,-16094.12 3932.5,-16094.12"/>
</g>
<!-- gpu6_layer4_attn -->
<g id="node1631" class="node">
<title>gpu6_layer4_attn</title>
<polygon fill="lightblue" stroke="black" points="3993,-15995.01 3865,-15995.01 3865,-15943.01 3993,-15943.01 3993,-15995.01"/>
<text text-anchor="middle" x="3929" y="-15983.01" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3929" y="-15972.01" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-15961.01" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-15950.01" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer4_reshape&#45;&gt;gpu6_layer4_attn -->
<g id="edge2034" class="edge">
<title>gpu6_layer4_reshape&#45;&gt;gpu6_layer4_attn</title>
<path fill="none" stroke="black" d="M3929,-16031.84C3929,-16023.55 3929,-16014.16 3929,-16005.26"/>
<polygon fill="black" stroke="black" points="3932.5,-16005.12 3929,-15995.12 3925.5,-16005.12 3932.5,-16005.12"/>
</g>
<!-- gpu6_layer4_attn_reshape -->
<g id="node1633" class="node">
<title>gpu6_layer4_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3990,-15906.01 3868,-15906.01 3868,-15854.01 3990,-15854.01 3990,-15906.01"/>
<text text-anchor="middle" x="3929" y="-15894.01" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3929" y="-15883.01" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-15872.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-15861.01" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer4_attn&#45;&gt;gpu6_layer4_attn_reshape -->
<g id="edge2035" class="edge">
<title>gpu6_layer4_attn&#45;&gt;gpu6_layer4_attn_reshape</title>
<path fill="none" stroke="black" d="M3929,-15942.84C3929,-15934.55 3929,-15925.16 3929,-15916.26"/>
<polygon fill="black" stroke="black" points="3932.5,-15916.12 3929,-15906.12 3925.5,-15916.12 3932.5,-15916.12"/>
</g>
<!-- gpu6_layer4_attn_out -->
<g id="node1632" class="node">
<title>gpu6_layer4_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3990,-15817.01 3868,-15817.01 3868,-15765.01 3990,-15765.01 3990,-15817.01"/>
<text text-anchor="middle" x="3929" y="-15805.01" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3929" y="-15794.01" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-15783.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-15772.01" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer4_kv_update -->
<g id="node1634" class="node">
<title>gpu6_layer4_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3929" cy="-15691.24" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3929" y="-15705.24" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3929" y="-15694.24" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-15683.24" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-15672.24" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer4_attn_out&#45;&gt;gpu6_layer4_kv_update -->
<g id="edge2037" class="edge">
<title>gpu6_layer4_attn_out&#45;&gt;gpu6_layer4_kv_update</title>
<path fill="none" stroke="black" d="M3929,-15764.83C3929,-15756.69 3929,-15747.39 3929,-15738.23"/>
<polygon fill="black" stroke="black" points="3932.5,-15738.02 3929,-15728.02 3925.5,-15738.02 3932.5,-15738.02"/>
</g>
<!-- gpu6_layer4_attn_reshape&#45;&gt;gpu6_layer4_attn_out -->
<g id="edge2036" class="edge">
<title>gpu6_layer4_attn_reshape&#45;&gt;gpu6_layer4_attn_out</title>
<path fill="none" stroke="black" d="M3929,-15853.84C3929,-15845.55 3929,-15836.16 3929,-15827.26"/>
<polygon fill="black" stroke="black" points="3932.5,-15827.12 3929,-15817.12 3925.5,-15827.12 3932.5,-15827.12"/>
</g>
<!-- gpu6_layer4_res1 -->
<g id="node1635" class="node">
<title>gpu6_layer4_res1</title>
<polygon fill="lightblue" stroke="black" points="3990,-15617.47 3868,-15617.47 3868,-15565.47 3990,-15565.47 3990,-15617.47"/>
<text text-anchor="middle" x="3929" y="-15605.47" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3929" y="-15594.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-15583.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-15572.47" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer4_kv_update&#45;&gt;gpu6_layer4_res1 -->
<g id="edge2038" class="edge">
<title>gpu6_layer4_kv_update&#45;&gt;gpu6_layer4_res1</title>
<path fill="none" stroke="black" d="M3929,-15654.39C3929,-15645.71 3929,-15636.44 3929,-15627.78"/>
<polygon fill="black" stroke="black" points="3932.5,-15627.62 3929,-15617.62 3925.5,-15627.62 3932.5,-15627.62"/>
</g>
<!-- gpu6_layer4_ln2 -->
<g id="node1636" class="node">
<title>gpu6_layer4_ln2</title>
<polygon fill="lightblue" stroke="black" points="3990,-15528.47 3868,-15528.47 3868,-15476.47 3990,-15476.47 3990,-15528.47"/>
<text text-anchor="middle" x="3929" y="-15516.47" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3929" y="-15505.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-15494.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-15483.47" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer4_res1&#45;&gt;gpu6_layer4_ln2 -->
<g id="edge2039" class="edge">
<title>gpu6_layer4_res1&#45;&gt;gpu6_layer4_ln2</title>
<path fill="none" stroke="black" d="M3929,-15565.31C3929,-15557.01 3929,-15547.62 3929,-15538.72"/>
<polygon fill="black" stroke="black" points="3932.5,-15538.58 3929,-15528.58 3925.5,-15538.58 3932.5,-15538.58"/>
</g>
<!-- gpu6_layer4_routing -->
<g id="node1637" class="node">
<title>gpu6_layer4_routing</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-15439.47 3854.29,-15439.47 3802.53,-15313.47 4003.71,-15313.47 4055.47,-15439.47"/>
<text text-anchor="middle" x="3929" y="-15395.97" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3929" y="-15384.97" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-15373.97" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-15362.97" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3929" y="-15351.97" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer4_ln2&#45;&gt;gpu6_layer4_routing -->
<g id="edge2040" class="edge">
<title>gpu6_layer4_ln2&#45;&gt;gpu6_layer4_routing</title>
<path fill="none" stroke="black" d="M3929,-15476.38C3929,-15468.45 3929,-15459.25 3929,-15449.72"/>
<polygon fill="black" stroke="black" points="3932.5,-15449.7 3929,-15439.7 3925.5,-15449.7 3932.5,-15449.7"/>
</g>
<!-- gpu6_layer4_expert0 -->
<g id="node1638" class="node">
<title>gpu6_layer4_expert0</title>
<polygon fill="lightblue" stroke="black" points="3710,-15267.47 3588,-15267.47 3588,-15215.47 3710,-15215.47 3710,-15267.47"/>
<text text-anchor="middle" x="3649" y="-15255.47" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3649" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer4_routing&#45;&gt;gpu6_layer4_expert0 -->
<g id="edge2027" class="edge">
<title>gpu6_layer4_routing&#45;&gt;gpu6_layer4_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3803.33,-15315.78C3771.34,-15300.58 3738.34,-15284.91 3711.11,-15271.97"/>
<polygon fill="black" stroke="black" points="3712.26,-15268.64 3701.73,-15267.51 3709.26,-15274.97 3712.26,-15268.64"/>
<text text-anchor="middle" x="3784.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer4_expert1 -->
<g id="node1639" class="node">
<title>gpu6_layer4_expert1</title>
<polygon fill="lightblue" stroke="black" points="3850,-15267.47 3728,-15267.47 3728,-15215.47 3850,-15215.47 3850,-15267.47"/>
<text text-anchor="middle" x="3789" y="-15255.47" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3789" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer4_routing&#45;&gt;gpu6_layer4_expert1 -->
<g id="edge2028" class="edge">
<title>gpu6_layer4_routing&#45;&gt;gpu6_layer4_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3863.51,-15313.25C3849.48,-15299.93 3835.21,-15286.37 3822.97,-15274.74"/>
<polygon fill="black" stroke="black" points="3825.29,-15272.11 3815.63,-15267.76 3820.46,-15277.19 3825.29,-15272.11"/>
<text text-anchor="middle" x="3871.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer4_expert2 -->
<g id="node1640" class="node">
<title>gpu6_layer4_expert2</title>
<polygon fill="lightblue" stroke="black" points="3990,-15267.47 3868,-15267.47 3868,-15215.47 3990,-15215.47 3990,-15267.47"/>
<text text-anchor="middle" x="3929" y="-15255.47" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3929" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer4_routing&#45;&gt;gpu6_layer4_expert2 -->
<g id="edge2029" class="edge">
<title>gpu6_layer4_routing&#45;&gt;gpu6_layer4_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3929,-15313.25C3929,-15301.18 3929,-15288.93 3929,-15278.08"/>
<polygon fill="black" stroke="black" points="3932.5,-15277.76 3929,-15267.76 3925.5,-15277.76 3932.5,-15277.76"/>
<text text-anchor="middle" x="3958.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer4_expert3 -->
<g id="node1641" class="node">
<title>gpu6_layer4_expert3</title>
<polygon fill="lightblue" stroke="black" points="4130,-15267.47 4008,-15267.47 4008,-15215.47 4130,-15215.47 4130,-15267.47"/>
<text text-anchor="middle" x="4069" y="-15255.47" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4069" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer4_routing&#45;&gt;gpu6_layer4_expert3 -->
<g id="edge2030" class="edge">
<title>gpu6_layer4_routing&#45;&gt;gpu6_layer4_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3994.49,-15313.25C4008.52,-15299.93 4022.79,-15286.37 4035.03,-15274.74"/>
<polygon fill="black" stroke="black" points="4037.54,-15277.19 4042.37,-15267.76 4032.71,-15272.11 4037.54,-15277.19"/>
<text text-anchor="middle" x="4052.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer4_expert_agg -->
<g id="node1642" class="node">
<title>gpu6_layer4_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-15178.47 3854.29,-15178.47 3802.53,-15074.47 4003.71,-15074.47 4055.47,-15178.47"/>
<text text-anchor="middle" x="3929" y="-15140.47" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3929" y="-15129.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-15118.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-15107.47" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer4_routing&#45;&gt;gpu6_layer4_expert_agg -->
<g id="edge2045" class="edge">
<title>gpu6_layer4_routing&#45;&gt;gpu6_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M4018.22,-15348.55C4091.96,-15321.39 4178.6,-15275 4139,-15215.47 4118.44,-15184.56 4084.7,-15164.48 4050.22,-15151.45"/>
<polygon fill="black" stroke="black" points="4051.08,-15148.04 4040.48,-15147.96 4048.71,-15154.63 4051.08,-15148.04"/>
</g>
<!-- gpu6_layer4_expert0&#45;&gt;gpu6_layer4_expert_agg -->
<g id="edge2041" class="edge">
<title>gpu6_layer4_expert0&#45;&gt;gpu6_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M3710.1,-15215.81C3746.98,-15200.93 3794.7,-15181.67 3836.16,-15164.94"/>
<polygon fill="black" stroke="black" points="3837.5,-15168.17 3845.46,-15161.18 3834.88,-15161.68 3837.5,-15168.17"/>
</g>
<!-- gpu6_layer4_expert1&#45;&gt;gpu6_layer4_expert_agg -->
<g id="edge2042" class="edge">
<title>gpu6_layer4_expert1&#45;&gt;gpu6_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M3820.07,-15215.39C3831.32,-15206.31 3844.53,-15195.65 3857.8,-15184.94"/>
<polygon fill="black" stroke="black" points="3860.02,-15187.64 3865.6,-15178.64 3855.62,-15182.2 3860.02,-15187.64"/>
</g>
<!-- gpu6_layer4_expert2&#45;&gt;gpu6_layer4_expert_agg -->
<g id="edge2043" class="edge">
<title>gpu6_layer4_expert2&#45;&gt;gpu6_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M3929,-15215.39C3929,-15207.46 3929,-15198.33 3929,-15189.01"/>
<polygon fill="black" stroke="black" points="3932.5,-15188.87 3929,-15178.87 3925.5,-15188.87 3932.5,-15188.87"/>
</g>
<!-- gpu6_layer4_expert3&#45;&gt;gpu6_layer4_expert_agg -->
<g id="edge2044" class="edge">
<title>gpu6_layer4_expert3&#45;&gt;gpu6_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M4037.93,-15215.39C4026.68,-15206.31 4013.47,-15195.65 4000.2,-15184.94"/>
<polygon fill="black" stroke="black" points="4002.38,-15182.2 3992.4,-15178.64 3997.98,-15187.64 4002.38,-15182.2"/>
</g>
<!-- gpu6_layer4_res2 -->
<g id="node1643" class="node">
<title>gpu6_layer4_res2</title>
<polygon fill="lightblue" stroke="black" points="3990,-15037.47 3868,-15037.47 3868,-14985.47 3990,-14985.47 3990,-15037.47"/>
<text text-anchor="middle" x="3929" y="-15025.47" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3929" y="-15014.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-15003.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-14992.47" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer4_expert_agg&#45;&gt;gpu6_layer4_res2 -->
<g id="edge2046" class="edge">
<title>gpu6_layer4_expert_agg&#45;&gt;gpu6_layer4_res2</title>
<path fill="none" stroke="black" d="M3929,-15074.26C3929,-15065.31 3929,-15056.18 3929,-15047.78"/>
<polygon fill="black" stroke="black" points="3932.5,-15047.6 3929,-15037.6 3925.5,-15047.6 3932.5,-15047.6"/>
</g>
<!-- gpu6_layer5_ln1 -->
<g id="node1644" class="node">
<title>gpu6_layer5_ln1</title>
<polygon fill="lightblue" stroke="black" points="3990,-14948.47 3868,-14948.47 3868,-14896.47 3990,-14896.47 3990,-14948.47"/>
<text text-anchor="middle" x="3929" y="-14936.47" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3929" y="-14925.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-14914.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-14903.47" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer4_res2&#45;&gt;gpu6_layer5_ln1 -->
<g id="edge2051" class="edge">
<title>gpu6_layer4_res2&#45;&gt;gpu6_layer5_ln1</title>
<path fill="none" stroke="black" d="M3929,-14985.31C3929,-14977.01 3929,-14967.62 3929,-14958.72"/>
<polygon fill="black" stroke="black" points="3932.5,-14958.58 3929,-14948.58 3925.5,-14958.58 3932.5,-14958.58"/>
</g>
<!-- gpu6_layer5_qkv -->
<g id="node1645" class="node">
<title>gpu6_layer5_qkv</title>
<polygon fill="lightblue" stroke="black" points="3990,-14859.47 3868,-14859.47 3868,-14807.47 3990,-14807.47 3990,-14859.47"/>
<text text-anchor="middle" x="3929" y="-14847.47" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3929" y="-14836.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-14825.47" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-14814.47" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer5_ln1&#45;&gt;gpu6_layer5_qkv -->
<g id="edge2052" class="edge">
<title>gpu6_layer5_ln1&#45;&gt;gpu6_layer5_qkv</title>
<path fill="none" stroke="black" d="M3929,-14896.31C3929,-14888.01 3929,-14878.62 3929,-14869.72"/>
<polygon fill="black" stroke="black" points="3932.5,-14869.58 3929,-14859.58 3925.5,-14869.58 3932.5,-14869.58"/>
</g>
<!-- gpu6_layer5_reshape -->
<g id="node1646" class="node">
<title>gpu6_layer5_reshape</title>
<polygon fill="lightblue" stroke="black" points="3993,-14770.47 3865,-14770.47 3865,-14718.47 3993,-14718.47 3993,-14770.47"/>
<text text-anchor="middle" x="3929" y="-14758.47" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3929" y="-14747.47" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-14736.47" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-14725.47" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer5_qkv&#45;&gt;gpu6_layer5_reshape -->
<g id="edge2053" class="edge">
<title>gpu6_layer5_qkv&#45;&gt;gpu6_layer5_reshape</title>
<path fill="none" stroke="black" d="M3929,-14807.31C3929,-14799.01 3929,-14789.62 3929,-14780.72"/>
<polygon fill="black" stroke="black" points="3932.5,-14780.58 3929,-14770.58 3925.5,-14780.58 3932.5,-14780.58"/>
</g>
<!-- gpu6_layer5_attn -->
<g id="node1647" class="node">
<title>gpu6_layer5_attn</title>
<polygon fill="lightblue" stroke="black" points="3993,-14681.47 3865,-14681.47 3865,-14629.47 3993,-14629.47 3993,-14681.47"/>
<text text-anchor="middle" x="3929" y="-14669.47" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3929" y="-14658.47" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-14647.47" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-14636.47" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer5_reshape&#45;&gt;gpu6_layer5_attn -->
<g id="edge2054" class="edge">
<title>gpu6_layer5_reshape&#45;&gt;gpu6_layer5_attn</title>
<path fill="none" stroke="black" d="M3929,-14718.31C3929,-14710.01 3929,-14700.62 3929,-14691.72"/>
<polygon fill="black" stroke="black" points="3932.5,-14691.58 3929,-14681.58 3925.5,-14691.58 3932.5,-14691.58"/>
</g>
<!-- gpu6_layer5_attn_reshape -->
<g id="node1649" class="node">
<title>gpu6_layer5_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3990,-14592.47 3868,-14592.47 3868,-14540.47 3990,-14540.47 3990,-14592.47"/>
<text text-anchor="middle" x="3929" y="-14580.47" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3929" y="-14569.47" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-14558.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-14547.47" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer5_attn&#45;&gt;gpu6_layer5_attn_reshape -->
<g id="edge2055" class="edge">
<title>gpu6_layer5_attn&#45;&gt;gpu6_layer5_attn_reshape</title>
<path fill="none" stroke="black" d="M3929,-14629.31C3929,-14621.01 3929,-14611.62 3929,-14602.72"/>
<polygon fill="black" stroke="black" points="3932.5,-14602.58 3929,-14592.58 3925.5,-14602.58 3932.5,-14602.58"/>
</g>
<!-- gpu6_layer5_attn_out -->
<g id="node1648" class="node">
<title>gpu6_layer5_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3990,-14503.47 3868,-14503.47 3868,-14451.47 3990,-14451.47 3990,-14503.47"/>
<text text-anchor="middle" x="3929" y="-14491.47" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3929" y="-14480.47" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-14469.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-14458.47" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer5_kv_update -->
<g id="node1650" class="node">
<title>gpu6_layer5_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3929" cy="-14377.7" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3929" y="-14391.7" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3929" y="-14380.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-14369.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-14358.7" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer5_attn_out&#45;&gt;gpu6_layer5_kv_update -->
<g id="edge2057" class="edge">
<title>gpu6_layer5_attn_out&#45;&gt;gpu6_layer5_kv_update</title>
<path fill="none" stroke="black" d="M3929,-14451.29C3929,-14443.15 3929,-14433.86 3929,-14424.69"/>
<polygon fill="black" stroke="black" points="3932.5,-14424.48 3929,-14414.48 3925.5,-14424.48 3932.5,-14424.48"/>
</g>
<!-- gpu6_layer5_attn_reshape&#45;&gt;gpu6_layer5_attn_out -->
<g id="edge2056" class="edge">
<title>gpu6_layer5_attn_reshape&#45;&gt;gpu6_layer5_attn_out</title>
<path fill="none" stroke="black" d="M3929,-14540.31C3929,-14532.01 3929,-14522.62 3929,-14513.72"/>
<polygon fill="black" stroke="black" points="3932.5,-14513.58 3929,-14503.58 3925.5,-14513.58 3932.5,-14513.58"/>
</g>
<!-- gpu6_layer5_res1 -->
<g id="node1651" class="node">
<title>gpu6_layer5_res1</title>
<polygon fill="lightblue" stroke="black" points="3990,-14303.93 3868,-14303.93 3868,-14251.93 3990,-14251.93 3990,-14303.93"/>
<text text-anchor="middle" x="3929" y="-14291.93" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3929" y="-14280.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-14269.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-14258.93" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer5_kv_update&#45;&gt;gpu6_layer5_res1 -->
<g id="edge2058" class="edge">
<title>gpu6_layer5_kv_update&#45;&gt;gpu6_layer5_res1</title>
<path fill="none" stroke="black" d="M3929,-14340.85C3929,-14332.17 3929,-14322.9 3929,-14314.25"/>
<polygon fill="black" stroke="black" points="3932.5,-14314.08 3929,-14304.08 3925.5,-14314.08 3932.5,-14314.08"/>
</g>
<!-- gpu6_layer5_ln2 -->
<g id="node1652" class="node">
<title>gpu6_layer5_ln2</title>
<polygon fill="lightblue" stroke="black" points="3990,-14214.93 3868,-14214.93 3868,-14162.93 3990,-14162.93 3990,-14214.93"/>
<text text-anchor="middle" x="3929" y="-14202.93" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3929" y="-14191.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-14180.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-14169.93" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer5_res1&#45;&gt;gpu6_layer5_ln2 -->
<g id="edge2059" class="edge">
<title>gpu6_layer5_res1&#45;&gt;gpu6_layer5_ln2</title>
<path fill="none" stroke="black" d="M3929,-14251.77C3929,-14243.47 3929,-14234.08 3929,-14225.18"/>
<polygon fill="black" stroke="black" points="3932.5,-14225.04 3929,-14215.04 3925.5,-14225.04 3932.5,-14225.04"/>
</g>
<!-- gpu6_layer5_routing -->
<g id="node1653" class="node">
<title>gpu6_layer5_routing</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-14125.93 3854.29,-14125.93 3802.53,-13999.93 4003.71,-13999.93 4055.47,-14125.93"/>
<text text-anchor="middle" x="3929" y="-14082.43" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3929" y="-14071.43" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-14060.43" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-14049.43" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3929" y="-14038.43" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer5_ln2&#45;&gt;gpu6_layer5_routing -->
<g id="edge2060" class="edge">
<title>gpu6_layer5_ln2&#45;&gt;gpu6_layer5_routing</title>
<path fill="none" stroke="black" d="M3929,-14162.84C3929,-14154.91 3929,-14145.71 3929,-14136.18"/>
<polygon fill="black" stroke="black" points="3932.5,-14136.17 3929,-14126.17 3925.5,-14136.17 3932.5,-14136.17"/>
</g>
<!-- gpu6_layer5_expert0 -->
<g id="node1654" class="node">
<title>gpu6_layer5_expert0</title>
<polygon fill="lightblue" stroke="black" points="3710,-13953.93 3588,-13953.93 3588,-13901.93 3710,-13901.93 3710,-13953.93"/>
<text text-anchor="middle" x="3649" y="-13941.93" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3649" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer5_routing&#45;&gt;gpu6_layer5_expert0 -->
<g id="edge2047" class="edge">
<title>gpu6_layer5_routing&#45;&gt;gpu6_layer5_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3803.33,-14002.24C3771.34,-13987.04 3738.34,-13971.37 3711.11,-13958.43"/>
<polygon fill="black" stroke="black" points="3712.26,-13955.1 3701.73,-13953.98 3709.26,-13961.43 3712.26,-13955.1"/>
<text text-anchor="middle" x="3784.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer5_expert1 -->
<g id="node1655" class="node">
<title>gpu6_layer5_expert1</title>
<polygon fill="lightblue" stroke="black" points="3850,-13953.93 3728,-13953.93 3728,-13901.93 3850,-13901.93 3850,-13953.93"/>
<text text-anchor="middle" x="3789" y="-13941.93" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3789" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer5_routing&#45;&gt;gpu6_layer5_expert1 -->
<g id="edge2048" class="edge">
<title>gpu6_layer5_routing&#45;&gt;gpu6_layer5_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3863.51,-13999.71C3849.48,-13986.39 3835.21,-13972.83 3822.97,-13961.2"/>
<polygon fill="black" stroke="black" points="3825.29,-13958.57 3815.63,-13954.22 3820.46,-13963.65 3825.29,-13958.57"/>
<text text-anchor="middle" x="3871.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer5_expert2 -->
<g id="node1656" class="node">
<title>gpu6_layer5_expert2</title>
<polygon fill="lightblue" stroke="black" points="3990,-13953.93 3868,-13953.93 3868,-13901.93 3990,-13901.93 3990,-13953.93"/>
<text text-anchor="middle" x="3929" y="-13941.93" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3929" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer5_routing&#45;&gt;gpu6_layer5_expert2 -->
<g id="edge2049" class="edge">
<title>gpu6_layer5_routing&#45;&gt;gpu6_layer5_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3929,-13999.71C3929,-13987.65 3929,-13975.39 3929,-13964.54"/>
<polygon fill="black" stroke="black" points="3932.5,-13964.22 3929,-13954.22 3925.5,-13964.22 3932.5,-13964.22"/>
<text text-anchor="middle" x="3958.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer5_expert3 -->
<g id="node1657" class="node">
<title>gpu6_layer5_expert3</title>
<polygon fill="lightblue" stroke="black" points="4130,-13953.93 4008,-13953.93 4008,-13901.93 4130,-13901.93 4130,-13953.93"/>
<text text-anchor="middle" x="4069" y="-13941.93" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4069" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer5_routing&#45;&gt;gpu6_layer5_expert3 -->
<g id="edge2050" class="edge">
<title>gpu6_layer5_routing&#45;&gt;gpu6_layer5_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3994.49,-13999.71C4008.52,-13986.39 4022.79,-13972.83 4035.03,-13961.2"/>
<polygon fill="black" stroke="black" points="4037.54,-13963.65 4042.37,-13954.22 4032.71,-13958.57 4037.54,-13963.65"/>
<text text-anchor="middle" x="4052.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer5_expert_agg -->
<g id="node1658" class="node">
<title>gpu6_layer5_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-13864.93 3854.29,-13864.93 3802.53,-13760.93 4003.71,-13760.93 4055.47,-13864.93"/>
<text text-anchor="middle" x="3929" y="-13826.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3929" y="-13815.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-13804.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-13793.93" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer5_routing&#45;&gt;gpu6_layer5_expert_agg -->
<g id="edge2065" class="edge">
<title>gpu6_layer5_routing&#45;&gt;gpu6_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M4018.22,-14035.01C4091.96,-14007.85 4178.6,-13961.46 4139,-13901.93 4118.44,-13871.02 4084.7,-13850.94 4050.22,-13837.91"/>
<polygon fill="black" stroke="black" points="4051.08,-13834.5 4040.48,-13834.42 4048.71,-13841.09 4051.08,-13834.5"/>
</g>
<!-- gpu6_layer5_expert0&#45;&gt;gpu6_layer5_expert_agg -->
<g id="edge2061" class="edge">
<title>gpu6_layer5_expert0&#45;&gt;gpu6_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M3710.1,-13902.27C3746.98,-13887.39 3794.7,-13868.13 3836.16,-13851.4"/>
<polygon fill="black" stroke="black" points="3837.5,-13854.63 3845.46,-13847.65 3834.88,-13848.14 3837.5,-13854.63"/>
</g>
<!-- gpu6_layer5_expert1&#45;&gt;gpu6_layer5_expert_agg -->
<g id="edge2062" class="edge">
<title>gpu6_layer5_expert1&#45;&gt;gpu6_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M3820.07,-13901.85C3831.32,-13892.77 3844.53,-13882.11 3857.8,-13871.4"/>
<polygon fill="black" stroke="black" points="3860.02,-13874.11 3865.6,-13865.1 3855.62,-13868.66 3860.02,-13874.11"/>
</g>
<!-- gpu6_layer5_expert2&#45;&gt;gpu6_layer5_expert_agg -->
<g id="edge2063" class="edge">
<title>gpu6_layer5_expert2&#45;&gt;gpu6_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M3929,-13901.85C3929,-13893.93 3929,-13884.79 3929,-13875.47"/>
<polygon fill="black" stroke="black" points="3932.5,-13875.33 3929,-13865.33 3925.5,-13875.33 3932.5,-13875.33"/>
</g>
<!-- gpu6_layer5_expert3&#45;&gt;gpu6_layer5_expert_agg -->
<g id="edge2064" class="edge">
<title>gpu6_layer5_expert3&#45;&gt;gpu6_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M4037.93,-13901.85C4026.68,-13892.77 4013.47,-13882.11 4000.2,-13871.4"/>
<polygon fill="black" stroke="black" points="4002.38,-13868.66 3992.4,-13865.1 3997.98,-13874.11 4002.38,-13868.66"/>
</g>
<!-- gpu6_layer5_res2 -->
<g id="node1659" class="node">
<title>gpu6_layer5_res2</title>
<polygon fill="lightblue" stroke="black" points="3990,-13723.93 3868,-13723.93 3868,-13671.93 3990,-13671.93 3990,-13723.93"/>
<text text-anchor="middle" x="3929" y="-13711.93" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3929" y="-13700.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-13689.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-13678.93" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer5_expert_agg&#45;&gt;gpu6_layer5_res2 -->
<g id="edge2066" class="edge">
<title>gpu6_layer5_expert_agg&#45;&gt;gpu6_layer5_res2</title>
<path fill="none" stroke="black" d="M3929,-13760.72C3929,-13751.77 3929,-13742.64 3929,-13734.24"/>
<polygon fill="black" stroke="black" points="3932.5,-13734.06 3929,-13724.06 3925.5,-13734.06 3932.5,-13734.06"/>
</g>
<!-- gpu6_layer6_ln1 -->
<g id="node1660" class="node">
<title>gpu6_layer6_ln1</title>
<polygon fill="lightblue" stroke="black" points="3990,-13634.93 3868,-13634.93 3868,-13582.93 3990,-13582.93 3990,-13634.93"/>
<text text-anchor="middle" x="3929" y="-13622.93" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3929" y="-13611.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-13600.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-13589.93" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer5_res2&#45;&gt;gpu6_layer6_ln1 -->
<g id="edge2071" class="edge">
<title>gpu6_layer5_res2&#45;&gt;gpu6_layer6_ln1</title>
<path fill="none" stroke="black" d="M3929,-13671.77C3929,-13663.47 3929,-13654.08 3929,-13645.18"/>
<polygon fill="black" stroke="black" points="3932.5,-13645.04 3929,-13635.04 3925.5,-13645.04 3932.5,-13645.04"/>
</g>
<!-- gpu6_layer6_qkv -->
<g id="node1661" class="node">
<title>gpu6_layer6_qkv</title>
<polygon fill="lightblue" stroke="black" points="3990,-13545.93 3868,-13545.93 3868,-13493.93 3990,-13493.93 3990,-13545.93"/>
<text text-anchor="middle" x="3929" y="-13533.93" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3929" y="-13522.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-13511.93" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-13500.93" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer6_ln1&#45;&gt;gpu6_layer6_qkv -->
<g id="edge2072" class="edge">
<title>gpu6_layer6_ln1&#45;&gt;gpu6_layer6_qkv</title>
<path fill="none" stroke="black" d="M3929,-13582.77C3929,-13574.47 3929,-13565.08 3929,-13556.18"/>
<polygon fill="black" stroke="black" points="3932.5,-13556.04 3929,-13546.04 3925.5,-13556.04 3932.5,-13556.04"/>
</g>
<!-- gpu6_layer6_reshape -->
<g id="node1662" class="node">
<title>gpu6_layer6_reshape</title>
<polygon fill="lightblue" stroke="black" points="3993,-13456.93 3865,-13456.93 3865,-13404.93 3993,-13404.93 3993,-13456.93"/>
<text text-anchor="middle" x="3929" y="-13444.93" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3929" y="-13433.93" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-13422.93" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-13411.93" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer6_qkv&#45;&gt;gpu6_layer6_reshape -->
<g id="edge2073" class="edge">
<title>gpu6_layer6_qkv&#45;&gt;gpu6_layer6_reshape</title>
<path fill="none" stroke="black" d="M3929,-13493.77C3929,-13485.47 3929,-13476.08 3929,-13467.18"/>
<polygon fill="black" stroke="black" points="3932.5,-13467.04 3929,-13457.04 3925.5,-13467.04 3932.5,-13467.04"/>
</g>
<!-- gpu6_layer6_attn -->
<g id="node1663" class="node">
<title>gpu6_layer6_attn</title>
<polygon fill="lightblue" stroke="black" points="3993,-13367.93 3865,-13367.93 3865,-13315.93 3993,-13315.93 3993,-13367.93"/>
<text text-anchor="middle" x="3929" y="-13355.93" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3929" y="-13344.93" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-13333.93" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-13322.93" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer6_reshape&#45;&gt;gpu6_layer6_attn -->
<g id="edge2074" class="edge">
<title>gpu6_layer6_reshape&#45;&gt;gpu6_layer6_attn</title>
<path fill="none" stroke="black" d="M3929,-13404.77C3929,-13396.47 3929,-13387.08 3929,-13378.18"/>
<polygon fill="black" stroke="black" points="3932.5,-13378.04 3929,-13368.04 3925.5,-13378.04 3932.5,-13378.04"/>
</g>
<!-- gpu6_layer6_attn_reshape -->
<g id="node1665" class="node">
<title>gpu6_layer6_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3990,-13278.93 3868,-13278.93 3868,-13226.93 3990,-13226.93 3990,-13278.93"/>
<text text-anchor="middle" x="3929" y="-13266.93" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3929" y="-13255.93" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-13244.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-13233.93" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer6_attn&#45;&gt;gpu6_layer6_attn_reshape -->
<g id="edge2075" class="edge">
<title>gpu6_layer6_attn&#45;&gt;gpu6_layer6_attn_reshape</title>
<path fill="none" stroke="black" d="M3929,-13315.77C3929,-13307.47 3929,-13298.08 3929,-13289.18"/>
<polygon fill="black" stroke="black" points="3932.5,-13289.04 3929,-13279.04 3925.5,-13289.04 3932.5,-13289.04"/>
</g>
<!-- gpu6_layer6_attn_out -->
<g id="node1664" class="node">
<title>gpu6_layer6_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3990,-13189.93 3868,-13189.93 3868,-13137.93 3990,-13137.93 3990,-13189.93"/>
<text text-anchor="middle" x="3929" y="-13177.93" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3929" y="-13166.93" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-13155.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-13144.93" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer6_kv_update -->
<g id="node1666" class="node">
<title>gpu6_layer6_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3929" cy="-13064.16" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3929" y="-13078.16" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3929" y="-13067.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-13056.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-13045.16" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer6_attn_out&#45;&gt;gpu6_layer6_kv_update -->
<g id="edge2077" class="edge">
<title>gpu6_layer6_attn_out&#45;&gt;gpu6_layer6_kv_update</title>
<path fill="none" stroke="black" d="M3929,-13137.75C3929,-13129.61 3929,-13120.32 3929,-13111.16"/>
<polygon fill="black" stroke="black" points="3932.5,-13110.94 3929,-13100.94 3925.5,-13110.94 3932.5,-13110.94"/>
</g>
<!-- gpu6_layer6_attn_reshape&#45;&gt;gpu6_layer6_attn_out -->
<g id="edge2076" class="edge">
<title>gpu6_layer6_attn_reshape&#45;&gt;gpu6_layer6_attn_out</title>
<path fill="none" stroke="black" d="M3929,-13226.77C3929,-13218.47 3929,-13209.08 3929,-13200.18"/>
<polygon fill="black" stroke="black" points="3932.5,-13200.04 3929,-13190.04 3925.5,-13200.04 3932.5,-13200.04"/>
</g>
<!-- gpu6_layer6_res1 -->
<g id="node1667" class="node">
<title>gpu6_layer6_res1</title>
<polygon fill="lightblue" stroke="black" points="3990,-12990.39 3868,-12990.39 3868,-12938.39 3990,-12938.39 3990,-12990.39"/>
<text text-anchor="middle" x="3929" y="-12978.39" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3929" y="-12967.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-12956.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-12945.39" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer6_kv_update&#45;&gt;gpu6_layer6_res1 -->
<g id="edge2078" class="edge">
<title>gpu6_layer6_kv_update&#45;&gt;gpu6_layer6_res1</title>
<path fill="none" stroke="black" d="M3929,-13027.31C3929,-13018.63 3929,-13009.36 3929,-13000.71"/>
<polygon fill="black" stroke="black" points="3932.5,-13000.54 3929,-12990.54 3925.5,-13000.54 3932.5,-13000.54"/>
</g>
<!-- gpu6_layer6_ln2 -->
<g id="node1668" class="node">
<title>gpu6_layer6_ln2</title>
<polygon fill="lightblue" stroke="black" points="3990,-12901.39 3868,-12901.39 3868,-12849.39 3990,-12849.39 3990,-12901.39"/>
<text text-anchor="middle" x="3929" y="-12889.39" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3929" y="-12878.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-12867.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-12856.39" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer6_res1&#45;&gt;gpu6_layer6_ln2 -->
<g id="edge2079" class="edge">
<title>gpu6_layer6_res1&#45;&gt;gpu6_layer6_ln2</title>
<path fill="none" stroke="black" d="M3929,-12938.23C3929,-12929.93 3929,-12920.55 3929,-12911.64"/>
<polygon fill="black" stroke="black" points="3932.5,-12911.5 3929,-12901.5 3925.5,-12911.5 3932.5,-12911.5"/>
</g>
<!-- gpu6_layer6_routing -->
<g id="node1669" class="node">
<title>gpu6_layer6_routing</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-12812.39 3854.29,-12812.39 3802.53,-12686.39 4003.71,-12686.39 4055.47,-12812.39"/>
<text text-anchor="middle" x="3929" y="-12768.89" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3929" y="-12757.89" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-12746.89" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-12735.89" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3929" y="-12724.89" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer6_ln2&#45;&gt;gpu6_layer6_routing -->
<g id="edge2080" class="edge">
<title>gpu6_layer6_ln2&#45;&gt;gpu6_layer6_routing</title>
<path fill="none" stroke="black" d="M3929,-12849.3C3929,-12841.37 3929,-12832.17 3929,-12822.64"/>
<polygon fill="black" stroke="black" points="3932.5,-12822.63 3929,-12812.63 3925.5,-12822.63 3932.5,-12822.63"/>
</g>
<!-- gpu6_layer6_expert0 -->
<g id="node1670" class="node">
<title>gpu6_layer6_expert0</title>
<polygon fill="lightblue" stroke="black" points="3710,-12640.39 3588,-12640.39 3588,-12588.39 3710,-12588.39 3710,-12640.39"/>
<text text-anchor="middle" x="3649" y="-12628.39" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3649" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer6_routing&#45;&gt;gpu6_layer6_expert0 -->
<g id="edge2067" class="edge">
<title>gpu6_layer6_routing&#45;&gt;gpu6_layer6_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3803.33,-12688.7C3771.34,-12673.5 3738.34,-12657.83 3711.11,-12644.89"/>
<polygon fill="black" stroke="black" points="3712.26,-12641.57 3701.73,-12640.44 3709.26,-12647.89 3712.26,-12641.57"/>
<text text-anchor="middle" x="3784.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer6_expert1 -->
<g id="node1671" class="node">
<title>gpu6_layer6_expert1</title>
<polygon fill="lightblue" stroke="black" points="3850,-12640.39 3728,-12640.39 3728,-12588.39 3850,-12588.39 3850,-12640.39"/>
<text text-anchor="middle" x="3789" y="-12628.39" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3789" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer6_routing&#45;&gt;gpu6_layer6_expert1 -->
<g id="edge2068" class="edge">
<title>gpu6_layer6_routing&#45;&gt;gpu6_layer6_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3863.51,-12686.17C3849.48,-12672.85 3835.21,-12659.29 3822.97,-12647.66"/>
<polygon fill="black" stroke="black" points="3825.29,-12645.03 3815.63,-12640.68 3820.46,-12650.11 3825.29,-12645.03"/>
<text text-anchor="middle" x="3871.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer6_expert2 -->
<g id="node1672" class="node">
<title>gpu6_layer6_expert2</title>
<polygon fill="lightblue" stroke="black" points="3990,-12640.39 3868,-12640.39 3868,-12588.39 3990,-12588.39 3990,-12640.39"/>
<text text-anchor="middle" x="3929" y="-12628.39" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3929" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer6_routing&#45;&gt;gpu6_layer6_expert2 -->
<g id="edge2069" class="edge">
<title>gpu6_layer6_routing&#45;&gt;gpu6_layer6_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3929,-12686.17C3929,-12674.11 3929,-12661.85 3929,-12651"/>
<polygon fill="black" stroke="black" points="3932.5,-12650.68 3929,-12640.68 3925.5,-12650.68 3932.5,-12650.68"/>
<text text-anchor="middle" x="3958.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer6_expert3 -->
<g id="node1673" class="node">
<title>gpu6_layer6_expert3</title>
<polygon fill="lightblue" stroke="black" points="4130,-12640.39 4008,-12640.39 4008,-12588.39 4130,-12588.39 4130,-12640.39"/>
<text text-anchor="middle" x="4069" y="-12628.39" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4069" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer6_routing&#45;&gt;gpu6_layer6_expert3 -->
<g id="edge2070" class="edge">
<title>gpu6_layer6_routing&#45;&gt;gpu6_layer6_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3994.49,-12686.17C4008.52,-12672.85 4022.79,-12659.29 4035.03,-12647.66"/>
<polygon fill="black" stroke="black" points="4037.54,-12650.11 4042.37,-12640.68 4032.71,-12645.03 4037.54,-12650.11"/>
<text text-anchor="middle" x="4052.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer6_expert_agg -->
<g id="node1674" class="node">
<title>gpu6_layer6_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-12551.39 3854.29,-12551.39 3802.53,-12447.39 4003.71,-12447.39 4055.47,-12551.39"/>
<text text-anchor="middle" x="3929" y="-12513.39" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3929" y="-12502.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-12491.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-12480.39" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer6_routing&#45;&gt;gpu6_layer6_expert_agg -->
<g id="edge2085" class="edge">
<title>gpu6_layer6_routing&#45;&gt;gpu6_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M4018.22,-12721.47C4091.96,-12694.32 4178.6,-12647.92 4139,-12588.39 4118.44,-12557.48 4084.7,-12537.4 4050.22,-12524.38"/>
<polygon fill="black" stroke="black" points="4051.08,-12520.97 4040.48,-12520.88 4048.71,-12527.55 4051.08,-12520.97"/>
</g>
<!-- gpu6_layer6_expert0&#45;&gt;gpu6_layer6_expert_agg -->
<g id="edge2081" class="edge">
<title>gpu6_layer6_expert0&#45;&gt;gpu6_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M3710.1,-12588.73C3746.98,-12573.85 3794.7,-12554.59 3836.16,-12537.86"/>
<polygon fill="black" stroke="black" points="3837.5,-12541.09 3845.46,-12534.11 3834.88,-12534.6 3837.5,-12541.09"/>
</g>
<!-- gpu6_layer6_expert1&#45;&gt;gpu6_layer6_expert_agg -->
<g id="edge2082" class="edge">
<title>gpu6_layer6_expert1&#45;&gt;gpu6_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M3820.07,-12588.31C3831.32,-12579.24 3844.53,-12568.57 3857.8,-12557.86"/>
<polygon fill="black" stroke="black" points="3860.02,-12560.57 3865.6,-12551.56 3855.62,-12555.12 3860.02,-12560.57"/>
</g>
<!-- gpu6_layer6_expert2&#45;&gt;gpu6_layer6_expert_agg -->
<g id="edge2083" class="edge">
<title>gpu6_layer6_expert2&#45;&gt;gpu6_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M3929,-12588.31C3929,-12580.39 3929,-12571.25 3929,-12561.93"/>
<polygon fill="black" stroke="black" points="3932.5,-12561.79 3929,-12551.79 3925.5,-12561.79 3932.5,-12561.79"/>
</g>
<!-- gpu6_layer6_expert3&#45;&gt;gpu6_layer6_expert_agg -->
<g id="edge2084" class="edge">
<title>gpu6_layer6_expert3&#45;&gt;gpu6_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M4037.93,-12588.31C4026.68,-12579.24 4013.47,-12568.57 4000.2,-12557.86"/>
<polygon fill="black" stroke="black" points="4002.38,-12555.12 3992.4,-12551.56 3997.98,-12560.57 4002.38,-12555.12"/>
</g>
<!-- gpu6_layer6_res2 -->
<g id="node1675" class="node">
<title>gpu6_layer6_res2</title>
<polygon fill="lightblue" stroke="black" points="3990,-12410.39 3868,-12410.39 3868,-12358.39 3990,-12358.39 3990,-12410.39"/>
<text text-anchor="middle" x="3929" y="-12398.39" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3929" y="-12387.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-12376.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-12365.39" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer6_expert_agg&#45;&gt;gpu6_layer6_res2 -->
<g id="edge2086" class="edge">
<title>gpu6_layer6_expert_agg&#45;&gt;gpu6_layer6_res2</title>
<path fill="none" stroke="black" d="M3929,-12447.18C3929,-12438.23 3929,-12429.1 3929,-12420.7"/>
<polygon fill="black" stroke="black" points="3932.5,-12420.52 3929,-12410.52 3925.5,-12420.52 3932.5,-12420.52"/>
</g>
<!-- gpu6_layer7_ln1 -->
<g id="node1676" class="node">
<title>gpu6_layer7_ln1</title>
<polygon fill="lightblue" stroke="black" points="3990,-12321.39 3868,-12321.39 3868,-12269.39 3990,-12269.39 3990,-12321.39"/>
<text text-anchor="middle" x="3929" y="-12309.39" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3929" y="-12298.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-12287.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-12276.39" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer6_res2&#45;&gt;gpu6_layer7_ln1 -->
<g id="edge2091" class="edge">
<title>gpu6_layer6_res2&#45;&gt;gpu6_layer7_ln1</title>
<path fill="none" stroke="black" d="M3929,-12358.23C3929,-12349.93 3929,-12340.55 3929,-12331.64"/>
<polygon fill="black" stroke="black" points="3932.5,-12331.5 3929,-12321.5 3925.5,-12331.5 3932.5,-12331.5"/>
</g>
<!-- gpu6_layer7_qkv -->
<g id="node1677" class="node">
<title>gpu6_layer7_qkv</title>
<polygon fill="lightblue" stroke="black" points="3990,-12232.39 3868,-12232.39 3868,-12180.39 3990,-12180.39 3990,-12232.39"/>
<text text-anchor="middle" x="3929" y="-12220.39" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3929" y="-12209.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-12198.39" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-12187.39" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer7_ln1&#45;&gt;gpu6_layer7_qkv -->
<g id="edge2092" class="edge">
<title>gpu6_layer7_ln1&#45;&gt;gpu6_layer7_qkv</title>
<path fill="none" stroke="black" d="M3929,-12269.23C3929,-12260.93 3929,-12251.55 3929,-12242.64"/>
<polygon fill="black" stroke="black" points="3932.5,-12242.5 3929,-12232.5 3925.5,-12242.5 3932.5,-12242.5"/>
</g>
<!-- gpu6_layer7_reshape -->
<g id="node1678" class="node">
<title>gpu6_layer7_reshape</title>
<polygon fill="lightblue" stroke="black" points="3993,-12143.39 3865,-12143.39 3865,-12091.39 3993,-12091.39 3993,-12143.39"/>
<text text-anchor="middle" x="3929" y="-12131.39" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3929" y="-12120.39" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-12109.39" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-12098.39" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer7_qkv&#45;&gt;gpu6_layer7_reshape -->
<g id="edge2093" class="edge">
<title>gpu6_layer7_qkv&#45;&gt;gpu6_layer7_reshape</title>
<path fill="none" stroke="black" d="M3929,-12180.23C3929,-12171.93 3929,-12162.55 3929,-12153.64"/>
<polygon fill="black" stroke="black" points="3932.5,-12153.5 3929,-12143.5 3925.5,-12153.5 3932.5,-12153.5"/>
</g>
<!-- gpu6_layer7_attn -->
<g id="node1679" class="node">
<title>gpu6_layer7_attn</title>
<polygon fill="lightblue" stroke="black" points="3993,-12054.39 3865,-12054.39 3865,-12002.39 3993,-12002.39 3993,-12054.39"/>
<text text-anchor="middle" x="3929" y="-12042.39" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3929" y="-12031.39" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-12020.39" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-12009.39" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer7_reshape&#45;&gt;gpu6_layer7_attn -->
<g id="edge2094" class="edge">
<title>gpu6_layer7_reshape&#45;&gt;gpu6_layer7_attn</title>
<path fill="none" stroke="black" d="M3929,-12091.23C3929,-12082.93 3929,-12073.55 3929,-12064.64"/>
<polygon fill="black" stroke="black" points="3932.5,-12064.5 3929,-12054.5 3925.5,-12064.5 3932.5,-12064.5"/>
</g>
<!-- gpu6_layer7_attn_reshape -->
<g id="node1681" class="node">
<title>gpu6_layer7_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3990,-11965.39 3868,-11965.39 3868,-11913.39 3990,-11913.39 3990,-11965.39"/>
<text text-anchor="middle" x="3929" y="-11953.39" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3929" y="-11942.39" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-11931.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-11920.39" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer7_attn&#45;&gt;gpu6_layer7_attn_reshape -->
<g id="edge2095" class="edge">
<title>gpu6_layer7_attn&#45;&gt;gpu6_layer7_attn_reshape</title>
<path fill="none" stroke="black" d="M3929,-12002.23C3929,-11993.93 3929,-11984.55 3929,-11975.64"/>
<polygon fill="black" stroke="black" points="3932.5,-11975.5 3929,-11965.5 3925.5,-11975.5 3932.5,-11975.5"/>
</g>
<!-- gpu6_layer7_attn_out -->
<g id="node1680" class="node">
<title>gpu6_layer7_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3990,-11876.39 3868,-11876.39 3868,-11824.39 3990,-11824.39 3990,-11876.39"/>
<text text-anchor="middle" x="3929" y="-11864.39" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3929" y="-11853.39" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-11842.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-11831.39" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer7_kv_update -->
<g id="node1682" class="node">
<title>gpu6_layer7_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3929" cy="-11750.62" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3929" y="-11764.62" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3929" y="-11753.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-11742.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-11731.62" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer7_attn_out&#45;&gt;gpu6_layer7_kv_update -->
<g id="edge2097" class="edge">
<title>gpu6_layer7_attn_out&#45;&gt;gpu6_layer7_kv_update</title>
<path fill="none" stroke="black" d="M3929,-11824.21C3929,-11816.07 3929,-11806.78 3929,-11797.62"/>
<polygon fill="black" stroke="black" points="3932.5,-11797.4 3929,-11787.4 3925.5,-11797.4 3932.5,-11797.4"/>
</g>
<!-- gpu6_layer7_attn_reshape&#45;&gt;gpu6_layer7_attn_out -->
<g id="edge2096" class="edge">
<title>gpu6_layer7_attn_reshape&#45;&gt;gpu6_layer7_attn_out</title>
<path fill="none" stroke="black" d="M3929,-11913.23C3929,-11904.93 3929,-11895.55 3929,-11886.64"/>
<polygon fill="black" stroke="black" points="3932.5,-11886.5 3929,-11876.5 3925.5,-11886.5 3932.5,-11886.5"/>
</g>
<!-- gpu6_layer7_res1 -->
<g id="node1683" class="node">
<title>gpu6_layer7_res1</title>
<polygon fill="lightblue" stroke="black" points="3990,-11676.85 3868,-11676.85 3868,-11624.85 3990,-11624.85 3990,-11676.85"/>
<text text-anchor="middle" x="3929" y="-11664.85" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3929" y="-11653.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-11642.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-11631.85" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer7_kv_update&#45;&gt;gpu6_layer7_res1 -->
<g id="edge2098" class="edge">
<title>gpu6_layer7_kv_update&#45;&gt;gpu6_layer7_res1</title>
<path fill="none" stroke="black" d="M3929,-11713.77C3929,-11705.09 3929,-11695.82 3929,-11687.17"/>
<polygon fill="black" stroke="black" points="3932.5,-11687 3929,-11677 3925.5,-11687 3932.5,-11687"/>
</g>
<!-- gpu6_layer7_ln2 -->
<g id="node1684" class="node">
<title>gpu6_layer7_ln2</title>
<polygon fill="lightblue" stroke="black" points="3990,-11587.85 3868,-11587.85 3868,-11535.85 3990,-11535.85 3990,-11587.85"/>
<text text-anchor="middle" x="3929" y="-11575.85" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3929" y="-11564.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-11553.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-11542.85" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer7_res1&#45;&gt;gpu6_layer7_ln2 -->
<g id="edge2099" class="edge">
<title>gpu6_layer7_res1&#45;&gt;gpu6_layer7_ln2</title>
<path fill="none" stroke="black" d="M3929,-11624.69C3929,-11616.39 3929,-11607.01 3929,-11598.1"/>
<polygon fill="black" stroke="black" points="3932.5,-11597.96 3929,-11587.96 3925.5,-11597.96 3932.5,-11597.96"/>
</g>
<!-- gpu6_layer7_routing -->
<g id="node1685" class="node">
<title>gpu6_layer7_routing</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-11498.85 3854.29,-11498.85 3802.53,-11372.85 4003.71,-11372.85 4055.47,-11498.85"/>
<text text-anchor="middle" x="3929" y="-11455.35" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3929" y="-11444.35" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-11433.35" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-11422.35" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3929" y="-11411.35" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer7_ln2&#45;&gt;gpu6_layer7_routing -->
<g id="edge2100" class="edge">
<title>gpu6_layer7_ln2&#45;&gt;gpu6_layer7_routing</title>
<path fill="none" stroke="black" d="M3929,-11535.76C3929,-11527.83 3929,-11518.63 3929,-11509.1"/>
<polygon fill="black" stroke="black" points="3932.5,-11509.09 3929,-11499.09 3925.5,-11509.09 3932.5,-11509.09"/>
</g>
<!-- gpu6_layer7_expert0 -->
<g id="node1686" class="node">
<title>gpu6_layer7_expert0</title>
<polygon fill="lightblue" stroke="black" points="3710,-11326.85 3588,-11326.85 3588,-11274.85 3710,-11274.85 3710,-11326.85"/>
<text text-anchor="middle" x="3649" y="-11314.85" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3649" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer7_routing&#45;&gt;gpu6_layer7_expert0 -->
<g id="edge2087" class="edge">
<title>gpu6_layer7_routing&#45;&gt;gpu6_layer7_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3803.33,-11375.16C3771.34,-11359.96 3738.34,-11344.29 3711.11,-11331.35"/>
<polygon fill="black" stroke="black" points="3712.26,-11328.03 3701.73,-11326.9 3709.26,-11334.35 3712.26,-11328.03"/>
<text text-anchor="middle" x="3784.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer7_expert1 -->
<g id="node1687" class="node">
<title>gpu6_layer7_expert1</title>
<polygon fill="lightblue" stroke="black" points="3850,-11326.85 3728,-11326.85 3728,-11274.85 3850,-11274.85 3850,-11326.85"/>
<text text-anchor="middle" x="3789" y="-11314.85" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3789" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer7_routing&#45;&gt;gpu6_layer7_expert1 -->
<g id="edge2088" class="edge">
<title>gpu6_layer7_routing&#45;&gt;gpu6_layer7_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3863.51,-11372.64C3849.48,-11359.31 3835.21,-11345.76 3822.97,-11334.12"/>
<polygon fill="black" stroke="black" points="3825.29,-11331.5 3815.63,-11327.15 3820.46,-11336.57 3825.29,-11331.5"/>
<text text-anchor="middle" x="3871.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer7_expert2 -->
<g id="node1688" class="node">
<title>gpu6_layer7_expert2</title>
<polygon fill="lightblue" stroke="black" points="3990,-11326.85 3868,-11326.85 3868,-11274.85 3990,-11274.85 3990,-11326.85"/>
<text text-anchor="middle" x="3929" y="-11314.85" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3929" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer7_routing&#45;&gt;gpu6_layer7_expert2 -->
<g id="edge2089" class="edge">
<title>gpu6_layer7_routing&#45;&gt;gpu6_layer7_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3929,-11372.64C3929,-11360.57 3929,-11348.31 3929,-11337.46"/>
<polygon fill="black" stroke="black" points="3932.5,-11337.15 3929,-11327.15 3925.5,-11337.15 3932.5,-11337.15"/>
<text text-anchor="middle" x="3958.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer7_expert3 -->
<g id="node1689" class="node">
<title>gpu6_layer7_expert3</title>
<polygon fill="lightblue" stroke="black" points="4130,-11326.85 4008,-11326.85 4008,-11274.85 4130,-11274.85 4130,-11326.85"/>
<text text-anchor="middle" x="4069" y="-11314.85" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4069" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer7_routing&#45;&gt;gpu6_layer7_expert3 -->
<g id="edge2090" class="edge">
<title>gpu6_layer7_routing&#45;&gt;gpu6_layer7_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3994.49,-11372.64C4008.52,-11359.31 4022.79,-11345.76 4035.03,-11334.12"/>
<polygon fill="black" stroke="black" points="4037.54,-11336.57 4042.37,-11327.15 4032.71,-11331.5 4037.54,-11336.57"/>
<text text-anchor="middle" x="4052.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer7_expert_agg -->
<g id="node1690" class="node">
<title>gpu6_layer7_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-11237.85 3854.29,-11237.85 3802.53,-11133.85 4003.71,-11133.85 4055.47,-11237.85"/>
<text text-anchor="middle" x="3929" y="-11199.85" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3929" y="-11188.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-11177.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-11166.85" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer7_routing&#45;&gt;gpu6_layer7_expert_agg -->
<g id="edge2105" class="edge">
<title>gpu6_layer7_routing&#45;&gt;gpu6_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M4018.22,-11407.94C4091.96,-11380.78 4178.6,-11334.39 4139,-11274.85 4118.44,-11243.94 4084.7,-11223.87 4050.22,-11210.84"/>
<polygon fill="black" stroke="black" points="4051.08,-11207.43 4040.48,-11207.35 4048.71,-11214.02 4051.08,-11207.43"/>
</g>
<!-- gpu6_layer7_expert0&#45;&gt;gpu6_layer7_expert_agg -->
<g id="edge2101" class="edge">
<title>gpu6_layer7_expert0&#45;&gt;gpu6_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M3710.1,-11275.19C3746.98,-11260.31 3794.7,-11241.05 3836.16,-11224.32"/>
<polygon fill="black" stroke="black" points="3837.5,-11227.56 3845.46,-11220.57 3834.88,-11221.06 3837.5,-11227.56"/>
</g>
<!-- gpu6_layer7_expert1&#45;&gt;gpu6_layer7_expert_agg -->
<g id="edge2102" class="edge">
<title>gpu6_layer7_expert1&#45;&gt;gpu6_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M3820.07,-11274.77C3831.32,-11265.7 3844.53,-11255.03 3857.8,-11244.32"/>
<polygon fill="black" stroke="black" points="3860.02,-11247.03 3865.6,-11238.02 3855.62,-11241.58 3860.02,-11247.03"/>
</g>
<!-- gpu6_layer7_expert2&#45;&gt;gpu6_layer7_expert_agg -->
<g id="edge2103" class="edge">
<title>gpu6_layer7_expert2&#45;&gt;gpu6_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M3929,-11274.77C3929,-11266.85 3929,-11257.71 3929,-11248.39"/>
<polygon fill="black" stroke="black" points="3932.5,-11248.25 3929,-11238.25 3925.5,-11248.25 3932.5,-11248.25"/>
</g>
<!-- gpu6_layer7_expert3&#45;&gt;gpu6_layer7_expert_agg -->
<g id="edge2104" class="edge">
<title>gpu6_layer7_expert3&#45;&gt;gpu6_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M4037.93,-11274.77C4026.68,-11265.7 4013.47,-11255.03 4000.2,-11244.32"/>
<polygon fill="black" stroke="black" points="4002.38,-11241.58 3992.4,-11238.02 3997.98,-11247.03 4002.38,-11241.58"/>
</g>
<!-- gpu6_layer7_res2 -->
<g id="node1691" class="node">
<title>gpu6_layer7_res2</title>
<polygon fill="lightblue" stroke="black" points="3990,-11096.85 3868,-11096.85 3868,-11044.85 3990,-11044.85 3990,-11096.85"/>
<text text-anchor="middle" x="3929" y="-11084.85" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3929" y="-11073.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-11062.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-11051.85" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer7_expert_agg&#45;&gt;gpu6_layer7_res2 -->
<g id="edge2106" class="edge">
<title>gpu6_layer7_expert_agg&#45;&gt;gpu6_layer7_res2</title>
<path fill="none" stroke="black" d="M3929,-11133.64C3929,-11124.69 3929,-11115.56 3929,-11107.16"/>
<polygon fill="black" stroke="black" points="3932.5,-11106.98 3929,-11096.98 3925.5,-11106.98 3932.5,-11106.98"/>
</g>
<!-- gpu6_layer8_ln1 -->
<g id="node1692" class="node">
<title>gpu6_layer8_ln1</title>
<polygon fill="lightblue" stroke="black" points="3990,-11007.85 3868,-11007.85 3868,-10955.85 3990,-10955.85 3990,-11007.85"/>
<text text-anchor="middle" x="3929" y="-10995.85" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3929" y="-10984.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-10973.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-10962.85" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer7_res2&#45;&gt;gpu6_layer8_ln1 -->
<g id="edge2111" class="edge">
<title>gpu6_layer7_res2&#45;&gt;gpu6_layer8_ln1</title>
<path fill="none" stroke="black" d="M3929,-11044.69C3929,-11036.39 3929,-11027.01 3929,-11018.1"/>
<polygon fill="black" stroke="black" points="3932.5,-11017.96 3929,-11007.96 3925.5,-11017.96 3932.5,-11017.96"/>
</g>
<!-- gpu6_layer8_qkv -->
<g id="node1693" class="node">
<title>gpu6_layer8_qkv</title>
<polygon fill="lightblue" stroke="black" points="3990,-10918.85 3868,-10918.85 3868,-10866.85 3990,-10866.85 3990,-10918.85"/>
<text text-anchor="middle" x="3929" y="-10906.85" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3929" y="-10895.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-10884.85" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-10873.85" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer8_ln1&#45;&gt;gpu6_layer8_qkv -->
<g id="edge2112" class="edge">
<title>gpu6_layer8_ln1&#45;&gt;gpu6_layer8_qkv</title>
<path fill="none" stroke="black" d="M3929,-10955.69C3929,-10947.39 3929,-10938.01 3929,-10929.1"/>
<polygon fill="black" stroke="black" points="3932.5,-10928.96 3929,-10918.96 3925.5,-10928.96 3932.5,-10928.96"/>
</g>
<!-- gpu6_layer8_reshape -->
<g id="node1694" class="node">
<title>gpu6_layer8_reshape</title>
<polygon fill="lightblue" stroke="black" points="3993,-10829.85 3865,-10829.85 3865,-10777.85 3993,-10777.85 3993,-10829.85"/>
<text text-anchor="middle" x="3929" y="-10817.85" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3929" y="-10806.85" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-10795.85" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-10784.85" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer8_qkv&#45;&gt;gpu6_layer8_reshape -->
<g id="edge2113" class="edge">
<title>gpu6_layer8_qkv&#45;&gt;gpu6_layer8_reshape</title>
<path fill="none" stroke="black" d="M3929,-10866.69C3929,-10858.39 3929,-10849.01 3929,-10840.1"/>
<polygon fill="black" stroke="black" points="3932.5,-10839.96 3929,-10829.96 3925.5,-10839.96 3932.5,-10839.96"/>
</g>
<!-- gpu6_layer8_attn -->
<g id="node1695" class="node">
<title>gpu6_layer8_attn</title>
<polygon fill="lightblue" stroke="black" points="3993,-10740.85 3865,-10740.85 3865,-10688.85 3993,-10688.85 3993,-10740.85"/>
<text text-anchor="middle" x="3929" y="-10728.85" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3929" y="-10717.85" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-10706.85" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-10695.85" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer8_reshape&#45;&gt;gpu6_layer8_attn -->
<g id="edge2114" class="edge">
<title>gpu6_layer8_reshape&#45;&gt;gpu6_layer8_attn</title>
<path fill="none" stroke="black" d="M3929,-10777.69C3929,-10769.39 3929,-10760.01 3929,-10751.1"/>
<polygon fill="black" stroke="black" points="3932.5,-10750.96 3929,-10740.96 3925.5,-10750.96 3932.5,-10750.96"/>
</g>
<!-- gpu6_layer8_attn_reshape -->
<g id="node1697" class="node">
<title>gpu6_layer8_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3990,-10651.85 3868,-10651.85 3868,-10599.85 3990,-10599.85 3990,-10651.85"/>
<text text-anchor="middle" x="3929" y="-10639.85" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3929" y="-10628.85" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-10617.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-10606.85" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer8_attn&#45;&gt;gpu6_layer8_attn_reshape -->
<g id="edge2115" class="edge">
<title>gpu6_layer8_attn&#45;&gt;gpu6_layer8_attn_reshape</title>
<path fill="none" stroke="black" d="M3929,-10688.69C3929,-10680.39 3929,-10671.01 3929,-10662.1"/>
<polygon fill="black" stroke="black" points="3932.5,-10661.96 3929,-10651.96 3925.5,-10661.96 3932.5,-10661.96"/>
</g>
<!-- gpu6_layer8_attn_out -->
<g id="node1696" class="node">
<title>gpu6_layer8_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3990,-10562.85 3868,-10562.85 3868,-10510.85 3990,-10510.85 3990,-10562.85"/>
<text text-anchor="middle" x="3929" y="-10550.85" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3929" y="-10539.85" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-10528.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-10517.85" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer8_kv_update -->
<g id="node1698" class="node">
<title>gpu6_layer8_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3929" cy="-10437.08" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3929" y="-10451.08" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3929" y="-10440.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-10429.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-10418.08" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer8_attn_out&#45;&gt;gpu6_layer8_kv_update -->
<g id="edge2117" class="edge">
<title>gpu6_layer8_attn_out&#45;&gt;gpu6_layer8_kv_update</title>
<path fill="none" stroke="black" d="M3929,-10510.67C3929,-10502.53 3929,-10493.24 3929,-10484.08"/>
<polygon fill="black" stroke="black" points="3932.5,-10483.86 3929,-10473.86 3925.5,-10483.86 3932.5,-10483.86"/>
</g>
<!-- gpu6_layer8_attn_reshape&#45;&gt;gpu6_layer8_attn_out -->
<g id="edge2116" class="edge">
<title>gpu6_layer8_attn_reshape&#45;&gt;gpu6_layer8_attn_out</title>
<path fill="none" stroke="black" d="M3929,-10599.69C3929,-10591.39 3929,-10582.01 3929,-10573.1"/>
<polygon fill="black" stroke="black" points="3932.5,-10572.96 3929,-10562.96 3925.5,-10572.96 3932.5,-10572.96"/>
</g>
<!-- gpu6_layer8_res1 -->
<g id="node1699" class="node">
<title>gpu6_layer8_res1</title>
<polygon fill="lightblue" stroke="black" points="3990,-10363.31 3868,-10363.31 3868,-10311.31 3990,-10311.31 3990,-10363.31"/>
<text text-anchor="middle" x="3929" y="-10351.31" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3929" y="-10340.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-10329.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-10318.31" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer8_kv_update&#45;&gt;gpu6_layer8_res1 -->
<g id="edge2118" class="edge">
<title>gpu6_layer8_kv_update&#45;&gt;gpu6_layer8_res1</title>
<path fill="none" stroke="black" d="M3929,-10400.23C3929,-10391.55 3929,-10382.28 3929,-10373.63"/>
<polygon fill="black" stroke="black" points="3932.5,-10373.46 3929,-10363.46 3925.5,-10373.46 3932.5,-10373.46"/>
</g>
<!-- gpu6_layer8_ln2 -->
<g id="node1700" class="node">
<title>gpu6_layer8_ln2</title>
<polygon fill="lightblue" stroke="black" points="3990,-10274.31 3868,-10274.31 3868,-10222.31 3990,-10222.31 3990,-10274.31"/>
<text text-anchor="middle" x="3929" y="-10262.31" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3929" y="-10251.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-10240.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-10229.31" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer8_res1&#45;&gt;gpu6_layer8_ln2 -->
<g id="edge2119" class="edge">
<title>gpu6_layer8_res1&#45;&gt;gpu6_layer8_ln2</title>
<path fill="none" stroke="black" d="M3929,-10311.15C3929,-10302.85 3929,-10293.47 3929,-10284.56"/>
<polygon fill="black" stroke="black" points="3932.5,-10284.42 3929,-10274.42 3925.5,-10284.42 3932.5,-10284.42"/>
</g>
<!-- gpu6_layer8_routing -->
<g id="node1701" class="node">
<title>gpu6_layer8_routing</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-10185.31 3854.29,-10185.31 3802.53,-10059.31 4003.71,-10059.31 4055.47,-10185.31"/>
<text text-anchor="middle" x="3929" y="-10141.81" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3929" y="-10130.81" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-10119.81" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-10108.81" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3929" y="-10097.81" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer8_ln2&#45;&gt;gpu6_layer8_routing -->
<g id="edge2120" class="edge">
<title>gpu6_layer8_ln2&#45;&gt;gpu6_layer8_routing</title>
<path fill="none" stroke="black" d="M3929,-10222.22C3929,-10214.29 3929,-10205.09 3929,-10195.56"/>
<polygon fill="black" stroke="black" points="3932.5,-10195.55 3929,-10185.55 3925.5,-10195.55 3932.5,-10195.55"/>
</g>
<!-- gpu6_layer8_expert0 -->
<g id="node1702" class="node">
<title>gpu6_layer8_expert0</title>
<polygon fill="lightblue" stroke="black" points="3710,-10013.31 3588,-10013.31 3588,-9961.31 3710,-9961.31 3710,-10013.31"/>
<text text-anchor="middle" x="3649" y="-10001.31" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3649" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer8_routing&#45;&gt;gpu6_layer8_expert0 -->
<g id="edge2107" class="edge">
<title>gpu6_layer8_routing&#45;&gt;gpu6_layer8_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3803.33,-10061.62C3771.34,-10046.42 3738.34,-10030.75 3711.11,-10017.81"/>
<polygon fill="black" stroke="black" points="3712.26,-10014.49 3701.73,-10013.36 3709.26,-10020.81 3712.26,-10014.49"/>
<text text-anchor="middle" x="3784.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer8_expert1 -->
<g id="node1703" class="node">
<title>gpu6_layer8_expert1</title>
<polygon fill="lightblue" stroke="black" points="3850,-10013.31 3728,-10013.31 3728,-9961.31 3850,-9961.31 3850,-10013.31"/>
<text text-anchor="middle" x="3789" y="-10001.31" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3789" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer8_routing&#45;&gt;gpu6_layer8_expert1 -->
<g id="edge2108" class="edge">
<title>gpu6_layer8_routing&#45;&gt;gpu6_layer8_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3863.51,-10059.1C3849.48,-10045.77 3835.21,-10032.22 3822.97,-10020.58"/>
<polygon fill="black" stroke="black" points="3825.29,-10017.96 3815.63,-10013.61 3820.46,-10023.03 3825.29,-10017.96"/>
<text text-anchor="middle" x="3871.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer8_expert2 -->
<g id="node1704" class="node">
<title>gpu6_layer8_expert2</title>
<polygon fill="lightblue" stroke="black" points="3990,-10013.31 3868,-10013.31 3868,-9961.31 3990,-9961.31 3990,-10013.31"/>
<text text-anchor="middle" x="3929" y="-10001.31" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3929" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer8_routing&#45;&gt;gpu6_layer8_expert2 -->
<g id="edge2109" class="edge">
<title>gpu6_layer8_routing&#45;&gt;gpu6_layer8_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3929,-10059.1C3929,-10047.03 3929,-10034.77 3929,-10023.92"/>
<polygon fill="black" stroke="black" points="3932.5,-10023.61 3929,-10013.61 3925.5,-10023.61 3932.5,-10023.61"/>
<text text-anchor="middle" x="3958.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer8_expert3 -->
<g id="node1705" class="node">
<title>gpu6_layer8_expert3</title>
<polygon fill="lightblue" stroke="black" points="4130,-10013.31 4008,-10013.31 4008,-9961.31 4130,-9961.31 4130,-10013.31"/>
<text text-anchor="middle" x="4069" y="-10001.31" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4069" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer8_routing&#45;&gt;gpu6_layer8_expert3 -->
<g id="edge2110" class="edge">
<title>gpu6_layer8_routing&#45;&gt;gpu6_layer8_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3994.49,-10059.1C4008.52,-10045.77 4022.79,-10032.22 4035.03,-10020.58"/>
<polygon fill="black" stroke="black" points="4037.54,-10023.03 4042.37,-10013.61 4032.71,-10017.96 4037.54,-10023.03"/>
<text text-anchor="middle" x="4052.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer8_expert_agg -->
<g id="node1706" class="node">
<title>gpu6_layer8_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-9924.31 3854.29,-9924.31 3802.53,-9820.31 4003.71,-9820.31 4055.47,-9924.31"/>
<text text-anchor="middle" x="3929" y="-9886.31" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3929" y="-9875.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-9864.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-9853.31" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer8_routing&#45;&gt;gpu6_layer8_expert_agg -->
<g id="edge2125" class="edge">
<title>gpu6_layer8_routing&#45;&gt;gpu6_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M4018.22,-10094.4C4091.96,-10067.24 4178.6,-10020.85 4139,-9961.31 4118.44,-9930.4 4084.7,-9910.33 4050.22,-9897.3"/>
<polygon fill="black" stroke="black" points="4051.08,-9893.89 4040.48,-9893.81 4048.71,-9900.48 4051.08,-9893.89"/>
</g>
<!-- gpu6_layer8_expert0&#45;&gt;gpu6_layer8_expert_agg -->
<g id="edge2121" class="edge">
<title>gpu6_layer8_expert0&#45;&gt;gpu6_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M3710.1,-9961.65C3746.98,-9946.77 3794.7,-9927.51 3836.16,-9910.78"/>
<polygon fill="black" stroke="black" points="3837.5,-9914.02 3845.46,-9907.03 3834.88,-9907.52 3837.5,-9914.02"/>
</g>
<!-- gpu6_layer8_expert1&#45;&gt;gpu6_layer8_expert_agg -->
<g id="edge2122" class="edge">
<title>gpu6_layer8_expert1&#45;&gt;gpu6_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M3820.07,-9961.23C3831.32,-9952.16 3844.53,-9941.49 3857.8,-9930.78"/>
<polygon fill="black" stroke="black" points="3860.02,-9933.49 3865.6,-9924.48 3855.62,-9928.04 3860.02,-9933.49"/>
</g>
<!-- gpu6_layer8_expert2&#45;&gt;gpu6_layer8_expert_agg -->
<g id="edge2123" class="edge">
<title>gpu6_layer8_expert2&#45;&gt;gpu6_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M3929,-9961.23C3929,-9953.31 3929,-9944.17 3929,-9934.85"/>
<polygon fill="black" stroke="black" points="3932.5,-9934.71 3929,-9924.71 3925.5,-9934.71 3932.5,-9934.71"/>
</g>
<!-- gpu6_layer8_expert3&#45;&gt;gpu6_layer8_expert_agg -->
<g id="edge2124" class="edge">
<title>gpu6_layer8_expert3&#45;&gt;gpu6_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M4037.93,-9961.23C4026.68,-9952.16 4013.47,-9941.49 4000.2,-9930.78"/>
<polygon fill="black" stroke="black" points="4002.38,-9928.04 3992.4,-9924.48 3997.98,-9933.49 4002.38,-9928.04"/>
</g>
<!-- gpu6_layer8_res2 -->
<g id="node1707" class="node">
<title>gpu6_layer8_res2</title>
<polygon fill="lightblue" stroke="black" points="3990,-9783.31 3868,-9783.31 3868,-9731.31 3990,-9731.31 3990,-9783.31"/>
<text text-anchor="middle" x="3929" y="-9771.31" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3929" y="-9760.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-9749.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-9738.31" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer8_expert_agg&#45;&gt;gpu6_layer8_res2 -->
<g id="edge2126" class="edge">
<title>gpu6_layer8_expert_agg&#45;&gt;gpu6_layer8_res2</title>
<path fill="none" stroke="black" d="M3929,-9820.1C3929,-9811.15 3929,-9802.02 3929,-9793.62"/>
<polygon fill="black" stroke="black" points="3932.5,-9793.44 3929,-9783.44 3925.5,-9793.44 3932.5,-9793.44"/>
</g>
<!-- gpu6_layer9_ln1 -->
<g id="node1708" class="node">
<title>gpu6_layer9_ln1</title>
<polygon fill="lightblue" stroke="black" points="3990,-9694.31 3868,-9694.31 3868,-9642.31 3990,-9642.31 3990,-9694.31"/>
<text text-anchor="middle" x="3929" y="-9682.31" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3929" y="-9671.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-9660.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-9649.31" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer8_res2&#45;&gt;gpu6_layer9_ln1 -->
<g id="edge2131" class="edge">
<title>gpu6_layer8_res2&#45;&gt;gpu6_layer9_ln1</title>
<path fill="none" stroke="black" d="M3929,-9731.15C3929,-9722.85 3929,-9713.47 3929,-9704.56"/>
<polygon fill="black" stroke="black" points="3932.5,-9704.42 3929,-9694.42 3925.5,-9704.42 3932.5,-9704.42"/>
</g>
<!-- gpu6_layer9_qkv -->
<g id="node1709" class="node">
<title>gpu6_layer9_qkv</title>
<polygon fill="lightblue" stroke="black" points="3990,-9605.31 3868,-9605.31 3868,-9553.31 3990,-9553.31 3990,-9605.31"/>
<text text-anchor="middle" x="3929" y="-9593.31" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3929" y="-9582.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-9571.31" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-9560.31" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer9_ln1&#45;&gt;gpu6_layer9_qkv -->
<g id="edge2132" class="edge">
<title>gpu6_layer9_ln1&#45;&gt;gpu6_layer9_qkv</title>
<path fill="none" stroke="black" d="M3929,-9642.15C3929,-9633.85 3929,-9624.47 3929,-9615.56"/>
<polygon fill="black" stroke="black" points="3932.5,-9615.42 3929,-9605.42 3925.5,-9615.42 3932.5,-9615.42"/>
</g>
<!-- gpu6_layer9_reshape -->
<g id="node1710" class="node">
<title>gpu6_layer9_reshape</title>
<polygon fill="lightblue" stroke="black" points="3993,-9516.31 3865,-9516.31 3865,-9464.31 3993,-9464.31 3993,-9516.31"/>
<text text-anchor="middle" x="3929" y="-9504.31" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3929" y="-9493.31" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-9482.31" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-9471.31" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer9_qkv&#45;&gt;gpu6_layer9_reshape -->
<g id="edge2133" class="edge">
<title>gpu6_layer9_qkv&#45;&gt;gpu6_layer9_reshape</title>
<path fill="none" stroke="black" d="M3929,-9553.15C3929,-9544.85 3929,-9535.47 3929,-9526.56"/>
<polygon fill="black" stroke="black" points="3932.5,-9526.42 3929,-9516.42 3925.5,-9526.42 3932.5,-9526.42"/>
</g>
<!-- gpu6_layer9_attn -->
<g id="node1711" class="node">
<title>gpu6_layer9_attn</title>
<polygon fill="lightblue" stroke="black" points="3993,-9427.31 3865,-9427.31 3865,-9375.31 3993,-9375.31 3993,-9427.31"/>
<text text-anchor="middle" x="3929" y="-9415.31" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3929" y="-9404.31" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-9393.31" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-9382.31" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer9_reshape&#45;&gt;gpu6_layer9_attn -->
<g id="edge2134" class="edge">
<title>gpu6_layer9_reshape&#45;&gt;gpu6_layer9_attn</title>
<path fill="none" stroke="black" d="M3929,-9464.15C3929,-9455.85 3929,-9446.47 3929,-9437.56"/>
<polygon fill="black" stroke="black" points="3932.5,-9437.42 3929,-9427.42 3925.5,-9437.42 3932.5,-9437.42"/>
</g>
<!-- gpu6_layer9_attn_reshape -->
<g id="node1713" class="node">
<title>gpu6_layer9_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3990,-9338.31 3868,-9338.31 3868,-9286.31 3990,-9286.31 3990,-9338.31"/>
<text text-anchor="middle" x="3929" y="-9326.31" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3929" y="-9315.31" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-9304.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-9293.31" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer9_attn&#45;&gt;gpu6_layer9_attn_reshape -->
<g id="edge2135" class="edge">
<title>gpu6_layer9_attn&#45;&gt;gpu6_layer9_attn_reshape</title>
<path fill="none" stroke="black" d="M3929,-9375.15C3929,-9366.85 3929,-9357.47 3929,-9348.56"/>
<polygon fill="black" stroke="black" points="3932.5,-9348.42 3929,-9338.42 3925.5,-9348.42 3932.5,-9348.42"/>
</g>
<!-- gpu6_layer9_attn_out -->
<g id="node1712" class="node">
<title>gpu6_layer9_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3990,-9249.31 3868,-9249.31 3868,-9197.31 3990,-9197.31 3990,-9249.31"/>
<text text-anchor="middle" x="3929" y="-9237.31" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3929" y="-9226.31" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-9215.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-9204.31" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer9_kv_update -->
<g id="node1714" class="node">
<title>gpu6_layer9_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3929" cy="-9123.54" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3929" y="-9137.54" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3929" y="-9126.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-9115.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-9104.54" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer9_attn_out&#45;&gt;gpu6_layer9_kv_update -->
<g id="edge2137" class="edge">
<title>gpu6_layer9_attn_out&#45;&gt;gpu6_layer9_kv_update</title>
<path fill="none" stroke="black" d="M3929,-9197.13C3929,-9189 3929,-9179.7 3929,-9170.54"/>
<polygon fill="black" stroke="black" points="3932.5,-9170.32 3929,-9160.32 3925.5,-9170.32 3932.5,-9170.32"/>
</g>
<!-- gpu6_layer9_attn_reshape&#45;&gt;gpu6_layer9_attn_out -->
<g id="edge2136" class="edge">
<title>gpu6_layer9_attn_reshape&#45;&gt;gpu6_layer9_attn_out</title>
<path fill="none" stroke="black" d="M3929,-9286.15C3929,-9277.85 3929,-9268.47 3929,-9259.56"/>
<polygon fill="black" stroke="black" points="3932.5,-9259.42 3929,-9249.42 3925.5,-9259.42 3932.5,-9259.42"/>
</g>
<!-- gpu6_layer9_res1 -->
<g id="node1715" class="node">
<title>gpu6_layer9_res1</title>
<polygon fill="lightblue" stroke="black" points="3990,-9049.77 3868,-9049.77 3868,-8997.77 3990,-8997.77 3990,-9049.77"/>
<text text-anchor="middle" x="3929" y="-9037.77" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3929" y="-9026.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-9015.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-9004.77" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer9_kv_update&#45;&gt;gpu6_layer9_res1 -->
<g id="edge2138" class="edge">
<title>gpu6_layer9_kv_update&#45;&gt;gpu6_layer9_res1</title>
<path fill="none" stroke="black" d="M3929,-9086.69C3929,-9078.01 3929,-9068.74 3929,-9060.09"/>
<polygon fill="black" stroke="black" points="3932.5,-9059.92 3929,-9049.92 3925.5,-9059.92 3932.5,-9059.92"/>
</g>
<!-- gpu6_layer9_ln2 -->
<g id="node1716" class="node">
<title>gpu6_layer9_ln2</title>
<polygon fill="lightblue" stroke="black" points="3990,-8960.77 3868,-8960.77 3868,-8908.77 3990,-8908.77 3990,-8960.77"/>
<text text-anchor="middle" x="3929" y="-8948.77" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3929" y="-8937.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-8926.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-8915.77" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer9_res1&#45;&gt;gpu6_layer9_ln2 -->
<g id="edge2139" class="edge">
<title>gpu6_layer9_res1&#45;&gt;gpu6_layer9_ln2</title>
<path fill="none" stroke="black" d="M3929,-8997.61C3929,-8989.31 3929,-8979.93 3929,-8971.02"/>
<polygon fill="black" stroke="black" points="3932.5,-8970.88 3929,-8960.88 3925.5,-8970.88 3932.5,-8970.88"/>
</g>
<!-- gpu6_layer9_routing -->
<g id="node1717" class="node">
<title>gpu6_layer9_routing</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-8871.77 3854.29,-8871.77 3802.53,-8745.77 4003.71,-8745.77 4055.47,-8871.77"/>
<text text-anchor="middle" x="3929" y="-8828.27" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3929" y="-8817.27" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-8806.27" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-8795.27" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3929" y="-8784.27" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer9_ln2&#45;&gt;gpu6_layer9_routing -->
<g id="edge2140" class="edge">
<title>gpu6_layer9_ln2&#45;&gt;gpu6_layer9_routing</title>
<path fill="none" stroke="black" d="M3929,-8908.68C3929,-8900.75 3929,-8891.55 3929,-8882.02"/>
<polygon fill="black" stroke="black" points="3932.5,-8882.01 3929,-8872.01 3925.5,-8882.01 3932.5,-8882.01"/>
</g>
<!-- gpu6_layer9_expert0 -->
<g id="node1718" class="node">
<title>gpu6_layer9_expert0</title>
<polygon fill="lightblue" stroke="black" points="3710,-8699.77 3588,-8699.77 3588,-8647.77 3710,-8647.77 3710,-8699.77"/>
<text text-anchor="middle" x="3649" y="-8687.77" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3649" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer9_routing&#45;&gt;gpu6_layer9_expert0 -->
<g id="edge2127" class="edge">
<title>gpu6_layer9_routing&#45;&gt;gpu6_layer9_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3803.33,-8748.08C3771.34,-8732.89 3738.34,-8717.21 3711.11,-8704.27"/>
<polygon fill="black" stroke="black" points="3712.26,-8700.95 3701.73,-8699.82 3709.26,-8707.27 3712.26,-8700.95"/>
<text text-anchor="middle" x="3784.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer9_expert1 -->
<g id="node1719" class="node">
<title>gpu6_layer9_expert1</title>
<polygon fill="lightblue" stroke="black" points="3850,-8699.77 3728,-8699.77 3728,-8647.77 3850,-8647.77 3850,-8699.77"/>
<text text-anchor="middle" x="3789" y="-8687.77" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3789" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer9_routing&#45;&gt;gpu6_layer9_expert1 -->
<g id="edge2128" class="edge">
<title>gpu6_layer9_routing&#45;&gt;gpu6_layer9_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3863.51,-8745.56C3849.48,-8732.23 3835.21,-8718.68 3822.97,-8707.04"/>
<polygon fill="black" stroke="black" points="3825.29,-8704.42 3815.63,-8700.07 3820.46,-8709.49 3825.29,-8704.42"/>
<text text-anchor="middle" x="3871.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer9_expert2 -->
<g id="node1720" class="node">
<title>gpu6_layer9_expert2</title>
<polygon fill="lightblue" stroke="black" points="3990,-8699.77 3868,-8699.77 3868,-8647.77 3990,-8647.77 3990,-8699.77"/>
<text text-anchor="middle" x="3929" y="-8687.77" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3929" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer9_routing&#45;&gt;gpu6_layer9_expert2 -->
<g id="edge2129" class="edge">
<title>gpu6_layer9_routing&#45;&gt;gpu6_layer9_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3929,-8745.56C3929,-8733.49 3929,-8721.23 3929,-8710.39"/>
<polygon fill="black" stroke="black" points="3932.5,-8710.07 3929,-8700.07 3925.5,-8710.07 3932.5,-8710.07"/>
<text text-anchor="middle" x="3958.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer9_expert3 -->
<g id="node1721" class="node">
<title>gpu6_layer9_expert3</title>
<polygon fill="lightblue" stroke="black" points="4130,-8699.77 4008,-8699.77 4008,-8647.77 4130,-8647.77 4130,-8699.77"/>
<text text-anchor="middle" x="4069" y="-8687.77" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4069" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer9_routing&#45;&gt;gpu6_layer9_expert3 -->
<g id="edge2130" class="edge">
<title>gpu6_layer9_routing&#45;&gt;gpu6_layer9_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3994.49,-8745.56C4008.52,-8732.23 4022.79,-8718.68 4035.03,-8707.04"/>
<polygon fill="black" stroke="black" points="4037.54,-8709.49 4042.37,-8700.07 4032.71,-8704.42 4037.54,-8709.49"/>
<text text-anchor="middle" x="4052.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer9_expert_agg -->
<g id="node1722" class="node">
<title>gpu6_layer9_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-8610.77 3854.29,-8610.77 3802.53,-8506.77 4003.71,-8506.77 4055.47,-8610.77"/>
<text text-anchor="middle" x="3929" y="-8572.77" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3929" y="-8561.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-8550.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-8539.77" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer9_routing&#45;&gt;gpu6_layer9_expert_agg -->
<g id="edge2145" class="edge">
<title>gpu6_layer9_routing&#45;&gt;gpu6_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M4018.22,-8780.86C4091.96,-8753.7 4178.6,-8707.31 4139,-8647.77 4118.44,-8616.86 4084.7,-8596.79 4050.22,-8583.76"/>
<polygon fill="black" stroke="black" points="4051.08,-8580.35 4040.48,-8580.27 4048.71,-8586.94 4051.08,-8580.35"/>
</g>
<!-- gpu6_layer9_expert0&#45;&gt;gpu6_layer9_expert_agg -->
<g id="edge2141" class="edge">
<title>gpu6_layer9_expert0&#45;&gt;gpu6_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M3710.1,-8648.12C3746.98,-8633.23 3794.7,-8613.97 3836.16,-8597.24"/>
<polygon fill="black" stroke="black" points="3837.5,-8600.48 3845.46,-8593.49 3834.88,-8593.99 3837.5,-8600.48"/>
</g>
<!-- gpu6_layer9_expert1&#45;&gt;gpu6_layer9_expert_agg -->
<g id="edge2142" class="edge">
<title>gpu6_layer9_expert1&#45;&gt;gpu6_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M3820.07,-8647.7C3831.32,-8638.62 3844.53,-8627.95 3857.8,-8617.24"/>
<polygon fill="black" stroke="black" points="3860.02,-8619.95 3865.6,-8610.95 3855.62,-8614.5 3860.02,-8619.95"/>
</g>
<!-- gpu6_layer9_expert2&#45;&gt;gpu6_layer9_expert_agg -->
<g id="edge2143" class="edge">
<title>gpu6_layer9_expert2&#45;&gt;gpu6_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M3929,-8647.7C3929,-8639.77 3929,-8630.63 3929,-8621.31"/>
<polygon fill="black" stroke="black" points="3932.5,-8621.17 3929,-8611.17 3925.5,-8621.17 3932.5,-8621.17"/>
</g>
<!-- gpu6_layer9_expert3&#45;&gt;gpu6_layer9_expert_agg -->
<g id="edge2144" class="edge">
<title>gpu6_layer9_expert3&#45;&gt;gpu6_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M4037.93,-8647.7C4026.68,-8638.62 4013.47,-8627.95 4000.2,-8617.24"/>
<polygon fill="black" stroke="black" points="4002.38,-8614.5 3992.4,-8610.95 3997.98,-8619.95 4002.38,-8614.5"/>
</g>
<!-- gpu6_layer9_res2 -->
<g id="node1723" class="node">
<title>gpu6_layer9_res2</title>
<polygon fill="lightblue" stroke="black" points="3990,-8469.77 3868,-8469.77 3868,-8417.77 3990,-8417.77 3990,-8469.77"/>
<text text-anchor="middle" x="3929" y="-8457.77" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3929" y="-8446.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-8435.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-8424.77" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer9_expert_agg&#45;&gt;gpu6_layer9_res2 -->
<g id="edge2146" class="edge">
<title>gpu6_layer9_expert_agg&#45;&gt;gpu6_layer9_res2</title>
<path fill="none" stroke="black" d="M3929,-8506.56C3929,-8497.61 3929,-8488.48 3929,-8480.08"/>
<polygon fill="black" stroke="black" points="3932.5,-8479.9 3929,-8469.9 3925.5,-8479.9 3932.5,-8479.9"/>
</g>
<!-- gpu6_layer10_ln1 -->
<g id="node1724" class="node">
<title>gpu6_layer10_ln1</title>
<polygon fill="lightblue" stroke="black" points="3990,-8380.77 3868,-8380.77 3868,-8328.77 3990,-8328.77 3990,-8380.77"/>
<text text-anchor="middle" x="3929" y="-8368.77" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3929" y="-8357.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-8346.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-8335.77" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer9_res2&#45;&gt;gpu6_layer10_ln1 -->
<g id="edge2151" class="edge">
<title>gpu6_layer9_res2&#45;&gt;gpu6_layer10_ln1</title>
<path fill="none" stroke="black" d="M3929,-8417.61C3929,-8409.31 3929,-8399.93 3929,-8391.02"/>
<polygon fill="black" stroke="black" points="3932.5,-8390.88 3929,-8380.88 3925.5,-8390.88 3932.5,-8390.88"/>
</g>
<!-- gpu6_layer10_qkv -->
<g id="node1725" class="node">
<title>gpu6_layer10_qkv</title>
<polygon fill="lightblue" stroke="black" points="3990,-8291.77 3868,-8291.77 3868,-8239.77 3990,-8239.77 3990,-8291.77"/>
<text text-anchor="middle" x="3929" y="-8279.77" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3929" y="-8268.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-8257.77" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-8246.77" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer10_ln1&#45;&gt;gpu6_layer10_qkv -->
<g id="edge2152" class="edge">
<title>gpu6_layer10_ln1&#45;&gt;gpu6_layer10_qkv</title>
<path fill="none" stroke="black" d="M3929,-8328.61C3929,-8320.31 3929,-8310.93 3929,-8302.02"/>
<polygon fill="black" stroke="black" points="3932.5,-8301.88 3929,-8291.88 3925.5,-8301.88 3932.5,-8301.88"/>
</g>
<!-- gpu6_layer10_reshape -->
<g id="node1726" class="node">
<title>gpu6_layer10_reshape</title>
<polygon fill="lightblue" stroke="black" points="3993,-8202.77 3865,-8202.77 3865,-8150.77 3993,-8150.77 3993,-8202.77"/>
<text text-anchor="middle" x="3929" y="-8190.77" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3929" y="-8179.77" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-8168.77" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-8157.77" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer10_qkv&#45;&gt;gpu6_layer10_reshape -->
<g id="edge2153" class="edge">
<title>gpu6_layer10_qkv&#45;&gt;gpu6_layer10_reshape</title>
<path fill="none" stroke="black" d="M3929,-8239.61C3929,-8231.31 3929,-8221.93 3929,-8213.02"/>
<polygon fill="black" stroke="black" points="3932.5,-8212.88 3929,-8202.88 3925.5,-8212.88 3932.5,-8212.88"/>
</g>
<!-- gpu6_layer10_attn -->
<g id="node1727" class="node">
<title>gpu6_layer10_attn</title>
<polygon fill="lightblue" stroke="black" points="3993,-8113.77 3865,-8113.77 3865,-8061.77 3993,-8061.77 3993,-8113.77"/>
<text text-anchor="middle" x="3929" y="-8101.77" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3929" y="-8090.77" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-8079.77" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-8068.77" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer10_reshape&#45;&gt;gpu6_layer10_attn -->
<g id="edge2154" class="edge">
<title>gpu6_layer10_reshape&#45;&gt;gpu6_layer10_attn</title>
<path fill="none" stroke="black" d="M3929,-8150.61C3929,-8142.31 3929,-8132.93 3929,-8124.02"/>
<polygon fill="black" stroke="black" points="3932.5,-8123.88 3929,-8113.88 3925.5,-8123.88 3932.5,-8123.88"/>
</g>
<!-- gpu6_layer10_attn_reshape -->
<g id="node1729" class="node">
<title>gpu6_layer10_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3990,-8024.77 3868,-8024.77 3868,-7972.77 3990,-7972.77 3990,-8024.77"/>
<text text-anchor="middle" x="3929" y="-8012.77" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3929" y="-8001.77" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-7990.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-7979.77" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer10_attn&#45;&gt;gpu6_layer10_attn_reshape -->
<g id="edge2155" class="edge">
<title>gpu6_layer10_attn&#45;&gt;gpu6_layer10_attn_reshape</title>
<path fill="none" stroke="black" d="M3929,-8061.61C3929,-8053.31 3929,-8043.93 3929,-8035.02"/>
<polygon fill="black" stroke="black" points="3932.5,-8034.88 3929,-8024.88 3925.5,-8034.88 3932.5,-8034.88"/>
</g>
<!-- gpu6_layer10_attn_out -->
<g id="node1728" class="node">
<title>gpu6_layer10_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3990,-7935.77 3868,-7935.77 3868,-7883.77 3990,-7883.77 3990,-7935.77"/>
<text text-anchor="middle" x="3929" y="-7923.77" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3929" y="-7912.77" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-7901.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-7890.77" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer10_kv_update -->
<g id="node1730" class="node">
<title>gpu6_layer10_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3929" cy="-7810" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3929" y="-7824" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3929" y="-7813" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-7802" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-7791" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer10_attn_out&#45;&gt;gpu6_layer10_kv_update -->
<g id="edge2157" class="edge">
<title>gpu6_layer10_attn_out&#45;&gt;gpu6_layer10_kv_update</title>
<path fill="none" stroke="black" d="M3929,-7883.6C3929,-7875.46 3929,-7866.16 3929,-7857"/>
<polygon fill="black" stroke="black" points="3932.5,-7856.78 3929,-7846.78 3925.5,-7856.78 3932.5,-7856.78"/>
</g>
<!-- gpu6_layer10_attn_reshape&#45;&gt;gpu6_layer10_attn_out -->
<g id="edge2156" class="edge">
<title>gpu6_layer10_attn_reshape&#45;&gt;gpu6_layer10_attn_out</title>
<path fill="none" stroke="black" d="M3929,-7972.61C3929,-7964.31 3929,-7954.93 3929,-7946.02"/>
<polygon fill="black" stroke="black" points="3932.5,-7945.88 3929,-7935.88 3925.5,-7945.88 3932.5,-7945.88"/>
</g>
<!-- gpu6_layer10_res1 -->
<g id="node1731" class="node">
<title>gpu6_layer10_res1</title>
<polygon fill="lightblue" stroke="black" points="3990,-7736.23 3868,-7736.23 3868,-7684.23 3990,-7684.23 3990,-7736.23"/>
<text text-anchor="middle" x="3929" y="-7724.23" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3929" y="-7713.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-7702.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-7691.23" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer10_kv_update&#45;&gt;gpu6_layer10_res1 -->
<g id="edge2158" class="edge">
<title>gpu6_layer10_kv_update&#45;&gt;gpu6_layer10_res1</title>
<path fill="none" stroke="black" d="M3929,-7773.15C3929,-7764.47 3929,-7755.2 3929,-7746.55"/>
<polygon fill="black" stroke="black" points="3932.5,-7746.38 3929,-7736.38 3925.5,-7746.38 3932.5,-7746.38"/>
</g>
<!-- gpu6_layer10_ln2 -->
<g id="node1732" class="node">
<title>gpu6_layer10_ln2</title>
<polygon fill="lightblue" stroke="black" points="3990,-7647.23 3868,-7647.23 3868,-7595.23 3990,-7595.23 3990,-7647.23"/>
<text text-anchor="middle" x="3929" y="-7635.23" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3929" y="-7624.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-7613.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-7602.23" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer10_res1&#45;&gt;gpu6_layer10_ln2 -->
<g id="edge2159" class="edge">
<title>gpu6_layer10_res1&#45;&gt;gpu6_layer10_ln2</title>
<path fill="none" stroke="black" d="M3929,-7684.07C3929,-7675.77 3929,-7666.39 3929,-7657.48"/>
<polygon fill="black" stroke="black" points="3932.5,-7657.34 3929,-7647.34 3925.5,-7657.34 3932.5,-7657.34"/>
</g>
<!-- gpu6_layer10_routing -->
<g id="node1733" class="node">
<title>gpu6_layer10_routing</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-7558.23 3854.29,-7558.23 3802.53,-7432.23 4003.71,-7432.23 4055.47,-7558.23"/>
<text text-anchor="middle" x="3929" y="-7514.73" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3929" y="-7503.73" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-7492.73" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-7481.73" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3929" y="-7470.73" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer10_ln2&#45;&gt;gpu6_layer10_routing -->
<g id="edge2160" class="edge">
<title>gpu6_layer10_ln2&#45;&gt;gpu6_layer10_routing</title>
<path fill="none" stroke="black" d="M3929,-7595.14C3929,-7587.21 3929,-7578.01 3929,-7568.48"/>
<polygon fill="black" stroke="black" points="3932.5,-7568.47 3929,-7558.47 3925.5,-7568.47 3932.5,-7568.47"/>
</g>
<!-- gpu6_layer10_expert0 -->
<g id="node1734" class="node">
<title>gpu6_layer10_expert0</title>
<polygon fill="lightblue" stroke="black" points="3710,-7386.23 3588,-7386.23 3588,-7334.23 3710,-7334.23 3710,-7386.23"/>
<text text-anchor="middle" x="3649" y="-7374.23" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3649" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer10_routing&#45;&gt;gpu6_layer10_expert0 -->
<g id="edge2147" class="edge">
<title>gpu6_layer10_routing&#45;&gt;gpu6_layer10_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3803.33,-7434.54C3771.34,-7419.35 3738.34,-7403.67 3711.11,-7390.74"/>
<polygon fill="black" stroke="black" points="3712.26,-7387.41 3701.73,-7386.28 3709.26,-7393.73 3712.26,-7387.41"/>
<text text-anchor="middle" x="3784.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer10_expert1 -->
<g id="node1735" class="node">
<title>gpu6_layer10_expert1</title>
<polygon fill="lightblue" stroke="black" points="3850,-7386.23 3728,-7386.23 3728,-7334.23 3850,-7334.23 3850,-7386.23"/>
<text text-anchor="middle" x="3789" y="-7374.23" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3789" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer10_routing&#45;&gt;gpu6_layer10_expert1 -->
<g id="edge2148" class="edge">
<title>gpu6_layer10_routing&#45;&gt;gpu6_layer10_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3863.51,-7432.02C3849.48,-7418.69 3835.21,-7405.14 3822.97,-7393.5"/>
<polygon fill="black" stroke="black" points="3825.29,-7390.88 3815.63,-7386.53 3820.46,-7395.95 3825.29,-7390.88"/>
<text text-anchor="middle" x="3871.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer10_expert2 -->
<g id="node1736" class="node">
<title>gpu6_layer10_expert2</title>
<polygon fill="lightblue" stroke="black" points="3990,-7386.23 3868,-7386.23 3868,-7334.23 3990,-7334.23 3990,-7386.23"/>
<text text-anchor="middle" x="3929" y="-7374.23" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3929" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer10_routing&#45;&gt;gpu6_layer10_expert2 -->
<g id="edge2149" class="edge">
<title>gpu6_layer10_routing&#45;&gt;gpu6_layer10_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3929,-7432.02C3929,-7419.95 3929,-7407.69 3929,-7396.85"/>
<polygon fill="black" stroke="black" points="3932.5,-7396.53 3929,-7386.53 3925.5,-7396.53 3932.5,-7396.53"/>
<text text-anchor="middle" x="3958.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer10_expert3 -->
<g id="node1737" class="node">
<title>gpu6_layer10_expert3</title>
<polygon fill="lightblue" stroke="black" points="4130,-7386.23 4008,-7386.23 4008,-7334.23 4130,-7334.23 4130,-7386.23"/>
<text text-anchor="middle" x="4069" y="-7374.23" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4069" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer10_routing&#45;&gt;gpu6_layer10_expert3 -->
<g id="edge2150" class="edge">
<title>gpu6_layer10_routing&#45;&gt;gpu6_layer10_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3994.49,-7432.02C4008.52,-7418.69 4022.79,-7405.14 4035.03,-7393.5"/>
<polygon fill="black" stroke="black" points="4037.54,-7395.95 4042.37,-7386.53 4032.71,-7390.88 4037.54,-7395.95"/>
<text text-anchor="middle" x="4052.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer10_expert_agg -->
<g id="node1738" class="node">
<title>gpu6_layer10_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-7297.23 3854.29,-7297.23 3802.53,-7193.23 4003.71,-7193.23 4055.47,-7297.23"/>
<text text-anchor="middle" x="3929" y="-7259.23" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3929" y="-7248.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-7237.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-7226.23" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer10_routing&#45;&gt;gpu6_layer10_expert_agg -->
<g id="edge2165" class="edge">
<title>gpu6_layer10_routing&#45;&gt;gpu6_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M4018.22,-7467.32C4091.96,-7440.16 4178.6,-7393.77 4139,-7334.23 4118.44,-7303.32 4084.7,-7283.25 4050.22,-7270.22"/>
<polygon fill="black" stroke="black" points="4051.08,-7266.81 4040.48,-7266.73 4048.71,-7273.4 4051.08,-7266.81"/>
</g>
<!-- gpu6_layer10_expert0&#45;&gt;gpu6_layer10_expert_agg -->
<g id="edge2161" class="edge">
<title>gpu6_layer10_expert0&#45;&gt;gpu6_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M3710.1,-7334.58C3746.98,-7319.69 3794.7,-7300.44 3836.16,-7283.7"/>
<polygon fill="black" stroke="black" points="3837.5,-7286.94 3845.46,-7279.95 3834.88,-7280.45 3837.5,-7286.94"/>
</g>
<!-- gpu6_layer10_expert1&#45;&gt;gpu6_layer10_expert_agg -->
<g id="edge2162" class="edge">
<title>gpu6_layer10_expert1&#45;&gt;gpu6_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M3820.07,-7334.16C3831.32,-7325.08 3844.53,-7314.42 3857.8,-7303.71"/>
<polygon fill="black" stroke="black" points="3860.02,-7306.41 3865.6,-7297.41 3855.62,-7300.96 3860.02,-7306.41"/>
</g>
<!-- gpu6_layer10_expert2&#45;&gt;gpu6_layer10_expert_agg -->
<g id="edge2163" class="edge">
<title>gpu6_layer10_expert2&#45;&gt;gpu6_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M3929,-7334.16C3929,-7326.23 3929,-7317.09 3929,-7307.77"/>
<polygon fill="black" stroke="black" points="3932.5,-7307.64 3929,-7297.64 3925.5,-7307.64 3932.5,-7307.64"/>
</g>
<!-- gpu6_layer10_expert3&#45;&gt;gpu6_layer10_expert_agg -->
<g id="edge2164" class="edge">
<title>gpu6_layer10_expert3&#45;&gt;gpu6_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M4037.93,-7334.16C4026.68,-7325.08 4013.47,-7314.42 4000.2,-7303.71"/>
<polygon fill="black" stroke="black" points="4002.38,-7300.96 3992.4,-7297.41 3997.98,-7306.41 4002.38,-7300.96"/>
</g>
<!-- gpu6_layer10_res2 -->
<g id="node1739" class="node">
<title>gpu6_layer10_res2</title>
<polygon fill="lightblue" stroke="black" points="3990,-7156.23 3868,-7156.23 3868,-7104.23 3990,-7104.23 3990,-7156.23"/>
<text text-anchor="middle" x="3929" y="-7144.23" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3929" y="-7133.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-7122.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-7111.23" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer10_expert_agg&#45;&gt;gpu6_layer10_res2 -->
<g id="edge2166" class="edge">
<title>gpu6_layer10_expert_agg&#45;&gt;gpu6_layer10_res2</title>
<path fill="none" stroke="black" d="M3929,-7193.02C3929,-7184.07 3929,-7174.94 3929,-7166.55"/>
<polygon fill="black" stroke="black" points="3932.5,-7166.37 3929,-7156.37 3925.5,-7166.37 3932.5,-7166.37"/>
</g>
<!-- gpu6_layer11_ln1 -->
<g id="node1740" class="node">
<title>gpu6_layer11_ln1</title>
<polygon fill="lightblue" stroke="black" points="3990,-7067.23 3868,-7067.23 3868,-7015.23 3990,-7015.23 3990,-7067.23"/>
<text text-anchor="middle" x="3929" y="-7055.23" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3929" y="-7044.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-7033.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-7022.23" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer10_res2&#45;&gt;gpu6_layer11_ln1 -->
<g id="edge2171" class="edge">
<title>gpu6_layer10_res2&#45;&gt;gpu6_layer11_ln1</title>
<path fill="none" stroke="black" d="M3929,-7104.07C3929,-7095.77 3929,-7086.39 3929,-7077.48"/>
<polygon fill="black" stroke="black" points="3932.5,-7077.34 3929,-7067.34 3925.5,-7077.34 3932.5,-7077.34"/>
</g>
<!-- gpu6_layer11_qkv -->
<g id="node1741" class="node">
<title>gpu6_layer11_qkv</title>
<polygon fill="lightblue" stroke="black" points="3990,-6978.23 3868,-6978.23 3868,-6926.23 3990,-6926.23 3990,-6978.23"/>
<text text-anchor="middle" x="3929" y="-6966.23" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3929" y="-6955.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-6944.23" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-6933.23" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer11_ln1&#45;&gt;gpu6_layer11_qkv -->
<g id="edge2172" class="edge">
<title>gpu6_layer11_ln1&#45;&gt;gpu6_layer11_qkv</title>
<path fill="none" stroke="black" d="M3929,-7015.07C3929,-7006.77 3929,-6997.39 3929,-6988.48"/>
<polygon fill="black" stroke="black" points="3932.5,-6988.34 3929,-6978.34 3925.5,-6988.34 3932.5,-6988.34"/>
</g>
<!-- gpu6_layer11_reshape -->
<g id="node1742" class="node">
<title>gpu6_layer11_reshape</title>
<polygon fill="lightblue" stroke="black" points="3993,-6889.23 3865,-6889.23 3865,-6837.23 3993,-6837.23 3993,-6889.23"/>
<text text-anchor="middle" x="3929" y="-6877.23" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3929" y="-6866.23" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-6855.23" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-6844.23" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer11_qkv&#45;&gt;gpu6_layer11_reshape -->
<g id="edge2173" class="edge">
<title>gpu6_layer11_qkv&#45;&gt;gpu6_layer11_reshape</title>
<path fill="none" stroke="black" d="M3929,-6926.07C3929,-6917.77 3929,-6908.39 3929,-6899.48"/>
<polygon fill="black" stroke="black" points="3932.5,-6899.34 3929,-6889.34 3925.5,-6899.34 3932.5,-6899.34"/>
</g>
<!-- gpu6_layer11_attn -->
<g id="node1743" class="node">
<title>gpu6_layer11_attn</title>
<polygon fill="lightblue" stroke="black" points="3993,-6800.23 3865,-6800.23 3865,-6748.23 3993,-6748.23 3993,-6800.23"/>
<text text-anchor="middle" x="3929" y="-6788.23" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3929" y="-6777.23" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-6766.23" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-6755.23" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer11_reshape&#45;&gt;gpu6_layer11_attn -->
<g id="edge2174" class="edge">
<title>gpu6_layer11_reshape&#45;&gt;gpu6_layer11_attn</title>
<path fill="none" stroke="black" d="M3929,-6837.07C3929,-6828.77 3929,-6819.39 3929,-6810.48"/>
<polygon fill="black" stroke="black" points="3932.5,-6810.34 3929,-6800.34 3925.5,-6810.34 3932.5,-6810.34"/>
</g>
<!-- gpu6_layer11_attn_reshape -->
<g id="node1745" class="node">
<title>gpu6_layer11_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3990,-6711.23 3868,-6711.23 3868,-6659.23 3990,-6659.23 3990,-6711.23"/>
<text text-anchor="middle" x="3929" y="-6699.23" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3929" y="-6688.23" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-6677.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-6666.23" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer11_attn&#45;&gt;gpu6_layer11_attn_reshape -->
<g id="edge2175" class="edge">
<title>gpu6_layer11_attn&#45;&gt;gpu6_layer11_attn_reshape</title>
<path fill="none" stroke="black" d="M3929,-6748.07C3929,-6739.77 3929,-6730.39 3929,-6721.48"/>
<polygon fill="black" stroke="black" points="3932.5,-6721.34 3929,-6711.34 3925.5,-6721.34 3932.5,-6721.34"/>
</g>
<!-- gpu6_layer11_attn_out -->
<g id="node1744" class="node">
<title>gpu6_layer11_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3990,-6622.23 3868,-6622.23 3868,-6570.23 3990,-6570.23 3990,-6622.23"/>
<text text-anchor="middle" x="3929" y="-6610.23" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3929" y="-6599.23" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-6588.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-6577.23" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer11_kv_update -->
<g id="node1746" class="node">
<title>gpu6_layer11_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3929" cy="-6496.47" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3929" y="-6510.47" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3929" y="-6499.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-6488.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-6477.47" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer11_attn_out&#45;&gt;gpu6_layer11_kv_update -->
<g id="edge2177" class="edge">
<title>gpu6_layer11_attn_out&#45;&gt;gpu6_layer11_kv_update</title>
<path fill="none" stroke="black" d="M3929,-6570.06C3929,-6561.92 3929,-6552.62 3929,-6543.46"/>
<polygon fill="black" stroke="black" points="3932.5,-6543.24 3929,-6533.24 3925.5,-6543.24 3932.5,-6543.24"/>
</g>
<!-- gpu6_layer11_attn_reshape&#45;&gt;gpu6_layer11_attn_out -->
<g id="edge2176" class="edge">
<title>gpu6_layer11_attn_reshape&#45;&gt;gpu6_layer11_attn_out</title>
<path fill="none" stroke="black" d="M3929,-6659.07C3929,-6650.77 3929,-6641.39 3929,-6632.48"/>
<polygon fill="black" stroke="black" points="3932.5,-6632.34 3929,-6622.34 3925.5,-6632.34 3932.5,-6632.34"/>
</g>
<!-- gpu6_layer11_res1 -->
<g id="node1747" class="node">
<title>gpu6_layer11_res1</title>
<polygon fill="lightblue" stroke="black" points="3990,-6422.7 3868,-6422.7 3868,-6370.7 3990,-6370.7 3990,-6422.7"/>
<text text-anchor="middle" x="3929" y="-6410.7" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3929" y="-6399.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-6388.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-6377.7" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer11_kv_update&#45;&gt;gpu6_layer11_res1 -->
<g id="edge2178" class="edge">
<title>gpu6_layer11_kv_update&#45;&gt;gpu6_layer11_res1</title>
<path fill="none" stroke="black" d="M3929,-6459.61C3929,-6450.94 3929,-6441.67 3929,-6433.01"/>
<polygon fill="black" stroke="black" points="3932.5,-6432.84 3929,-6422.84 3925.5,-6432.84 3932.5,-6432.84"/>
</g>
<!-- gpu6_layer11_ln2 -->
<g id="node1748" class="node">
<title>gpu6_layer11_ln2</title>
<polygon fill="lightblue" stroke="black" points="3990,-6333.7 3868,-6333.7 3868,-6281.7 3990,-6281.7 3990,-6333.7"/>
<text text-anchor="middle" x="3929" y="-6321.7" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3929" y="-6310.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-6299.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-6288.7" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer11_res1&#45;&gt;gpu6_layer11_ln2 -->
<g id="edge2179" class="edge">
<title>gpu6_layer11_res1&#45;&gt;gpu6_layer11_ln2</title>
<path fill="none" stroke="black" d="M3929,-6370.53C3929,-6362.24 3929,-6352.85 3929,-6343.94"/>
<polygon fill="black" stroke="black" points="3932.5,-6343.8 3929,-6333.8 3925.5,-6343.8 3932.5,-6343.8"/>
</g>
<!-- gpu6_layer11_routing -->
<g id="node1749" class="node">
<title>gpu6_layer11_routing</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-6244.7 3854.29,-6244.7 3802.53,-6118.7 4003.71,-6118.7 4055.47,-6244.7"/>
<text text-anchor="middle" x="3929" y="-6201.2" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3929" y="-6190.2" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-6179.2" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-6168.2" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3929" y="-6157.2" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer11_ln2&#45;&gt;gpu6_layer11_routing -->
<g id="edge2180" class="edge">
<title>gpu6_layer11_ln2&#45;&gt;gpu6_layer11_routing</title>
<path fill="none" stroke="black" d="M3929,-6281.6C3929,-6273.67 3929,-6264.47 3929,-6254.94"/>
<polygon fill="black" stroke="black" points="3932.5,-6254.93 3929,-6244.93 3925.5,-6254.93 3932.5,-6254.93"/>
</g>
<!-- gpu6_layer11_expert0 -->
<g id="node1750" class="node">
<title>gpu6_layer11_expert0</title>
<polygon fill="lightblue" stroke="black" points="3710,-6072.7 3588,-6072.7 3588,-6020.7 3710,-6020.7 3710,-6072.7"/>
<text text-anchor="middle" x="3649" y="-6060.7" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3649" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer11_routing&#45;&gt;gpu6_layer11_expert0 -->
<g id="edge2167" class="edge">
<title>gpu6_layer11_routing&#45;&gt;gpu6_layer11_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3803.33,-6121C3771.34,-6105.81 3738.34,-6090.13 3711.11,-6077.2"/>
<polygon fill="black" stroke="black" points="3712.26,-6073.87 3701.73,-6072.74 3709.26,-6080.19 3712.26,-6073.87"/>
<text text-anchor="middle" x="3784.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer11_expert1 -->
<g id="node1751" class="node">
<title>gpu6_layer11_expert1</title>
<polygon fill="lightblue" stroke="black" points="3850,-6072.7 3728,-6072.7 3728,-6020.7 3850,-6020.7 3850,-6072.7"/>
<text text-anchor="middle" x="3789" y="-6060.7" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3789" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer11_routing&#45;&gt;gpu6_layer11_expert1 -->
<g id="edge2168" class="edge">
<title>gpu6_layer11_routing&#45;&gt;gpu6_layer11_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3863.51,-6118.48C3849.48,-6105.15 3835.21,-6091.6 3822.97,-6079.97"/>
<polygon fill="black" stroke="black" points="3825.29,-6077.34 3815.63,-6072.99 3820.46,-6082.41 3825.29,-6077.34"/>
<text text-anchor="middle" x="3871.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer11_expert2 -->
<g id="node1752" class="node">
<title>gpu6_layer11_expert2</title>
<polygon fill="lightblue" stroke="black" points="3990,-6072.7 3868,-6072.7 3868,-6020.7 3990,-6020.7 3990,-6072.7"/>
<text text-anchor="middle" x="3929" y="-6060.7" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3929" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer11_routing&#45;&gt;gpu6_layer11_expert2 -->
<g id="edge2169" class="edge">
<title>gpu6_layer11_routing&#45;&gt;gpu6_layer11_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3929,-6118.48C3929,-6106.41 3929,-6094.15 3929,-6083.31"/>
<polygon fill="black" stroke="black" points="3932.5,-6082.99 3929,-6072.99 3925.5,-6082.99 3932.5,-6082.99"/>
<text text-anchor="middle" x="3958.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer11_expert3 -->
<g id="node1753" class="node">
<title>gpu6_layer11_expert3</title>
<polygon fill="lightblue" stroke="black" points="4130,-6072.7 4008,-6072.7 4008,-6020.7 4130,-6020.7 4130,-6072.7"/>
<text text-anchor="middle" x="4069" y="-6060.7" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4069" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer11_routing&#45;&gt;gpu6_layer11_expert3 -->
<g id="edge2170" class="edge">
<title>gpu6_layer11_routing&#45;&gt;gpu6_layer11_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3994.49,-6118.48C4008.52,-6105.15 4022.79,-6091.6 4035.03,-6079.97"/>
<polygon fill="black" stroke="black" points="4037.54,-6082.41 4042.37,-6072.99 4032.71,-6077.34 4037.54,-6082.41"/>
<text text-anchor="middle" x="4052.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer11_expert_agg -->
<g id="node1754" class="node">
<title>gpu6_layer11_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-5983.7 3854.29,-5983.7 3802.53,-5879.7 4003.71,-5879.7 4055.47,-5983.7"/>
<text text-anchor="middle" x="3929" y="-5945.7" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3929" y="-5934.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-5923.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-5912.7" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer11_routing&#45;&gt;gpu6_layer11_expert_agg -->
<g id="edge2185" class="edge">
<title>gpu6_layer11_routing&#45;&gt;gpu6_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M4018.22,-6153.78C4091.96,-6126.62 4178.6,-6080.23 4139,-6020.7 4118.44,-5989.78 4084.7,-5969.71 4050.22,-5956.68"/>
<polygon fill="black" stroke="black" points="4051.08,-5953.27 4040.48,-5953.19 4048.71,-5959.86 4051.08,-5953.27"/>
</g>
<!-- gpu6_layer11_expert0&#45;&gt;gpu6_layer11_expert_agg -->
<g id="edge2181" class="edge">
<title>gpu6_layer11_expert0&#45;&gt;gpu6_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M3710.1,-6021.04C3746.98,-6006.15 3794.7,-5986.9 3836.16,-5970.16"/>
<polygon fill="black" stroke="black" points="3837.5,-5973.4 3845.46,-5966.41 3834.88,-5966.91 3837.5,-5973.4"/>
</g>
<!-- gpu6_layer11_expert1&#45;&gt;gpu6_layer11_expert_agg -->
<g id="edge2182" class="edge">
<title>gpu6_layer11_expert1&#45;&gt;gpu6_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M3820.07,-6020.62C3831.32,-6011.54 3844.53,-6000.88 3857.8,-5990.17"/>
<polygon fill="black" stroke="black" points="3860.02,-5992.87 3865.6,-5983.87 3855.62,-5987.42 3860.02,-5992.87"/>
</g>
<!-- gpu6_layer11_expert2&#45;&gt;gpu6_layer11_expert_agg -->
<g id="edge2183" class="edge">
<title>gpu6_layer11_expert2&#45;&gt;gpu6_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M3929,-6020.62C3929,-6012.69 3929,-6003.55 3929,-5994.23"/>
<polygon fill="black" stroke="black" points="3932.5,-5994.1 3929,-5984.1 3925.5,-5994.1 3932.5,-5994.1"/>
</g>
<!-- gpu6_layer11_expert3&#45;&gt;gpu6_layer11_expert_agg -->
<g id="edge2184" class="edge">
<title>gpu6_layer11_expert3&#45;&gt;gpu6_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M4037.93,-6020.62C4026.68,-6011.54 4013.47,-6000.88 4000.2,-5990.17"/>
<polygon fill="black" stroke="black" points="4002.38,-5987.42 3992.4,-5983.87 3997.98,-5992.87 4002.38,-5987.42"/>
</g>
<!-- gpu6_layer11_res2 -->
<g id="node1755" class="node">
<title>gpu6_layer11_res2</title>
<polygon fill="lightblue" stroke="black" points="3990,-5842.7 3868,-5842.7 3868,-5790.7 3990,-5790.7 3990,-5842.7"/>
<text text-anchor="middle" x="3929" y="-5830.7" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3929" y="-5819.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-5808.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-5797.7" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer11_expert_agg&#45;&gt;gpu6_layer11_res2 -->
<g id="edge2186" class="edge">
<title>gpu6_layer11_expert_agg&#45;&gt;gpu6_layer11_res2</title>
<path fill="none" stroke="black" d="M3929,-5879.49C3929,-5870.53 3929,-5861.41 3929,-5853.01"/>
<polygon fill="black" stroke="black" points="3932.5,-5852.83 3929,-5842.83 3925.5,-5852.83 3932.5,-5852.83"/>
</g>
<!-- gpu6_layer12_ln1 -->
<g id="node1756" class="node">
<title>gpu6_layer12_ln1</title>
<polygon fill="lightblue" stroke="black" points="3990,-5753.7 3868,-5753.7 3868,-5701.7 3990,-5701.7 3990,-5753.7"/>
<text text-anchor="middle" x="3929" y="-5741.7" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3929" y="-5730.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-5719.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-5708.7" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer11_res2&#45;&gt;gpu6_layer12_ln1 -->
<g id="edge2191" class="edge">
<title>gpu6_layer11_res2&#45;&gt;gpu6_layer12_ln1</title>
<path fill="none" stroke="black" d="M3929,-5790.53C3929,-5782.24 3929,-5772.85 3929,-5763.94"/>
<polygon fill="black" stroke="black" points="3932.5,-5763.8 3929,-5753.8 3925.5,-5763.8 3932.5,-5763.8"/>
</g>
<!-- gpu6_layer12_qkv -->
<g id="node1757" class="node">
<title>gpu6_layer12_qkv</title>
<polygon fill="lightblue" stroke="black" points="3990,-5664.7 3868,-5664.7 3868,-5612.7 3990,-5612.7 3990,-5664.7"/>
<text text-anchor="middle" x="3929" y="-5652.7" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3929" y="-5641.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-5630.7" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-5619.7" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer12_ln1&#45;&gt;gpu6_layer12_qkv -->
<g id="edge2192" class="edge">
<title>gpu6_layer12_ln1&#45;&gt;gpu6_layer12_qkv</title>
<path fill="none" stroke="black" d="M3929,-5701.53C3929,-5693.24 3929,-5683.85 3929,-5674.94"/>
<polygon fill="black" stroke="black" points="3932.5,-5674.8 3929,-5664.8 3925.5,-5674.8 3932.5,-5674.8"/>
</g>
<!-- gpu6_layer12_reshape -->
<g id="node1758" class="node">
<title>gpu6_layer12_reshape</title>
<polygon fill="lightblue" stroke="black" points="3993,-5575.7 3865,-5575.7 3865,-5523.7 3993,-5523.7 3993,-5575.7"/>
<text text-anchor="middle" x="3929" y="-5563.7" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3929" y="-5552.7" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-5541.7" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-5530.7" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer12_qkv&#45;&gt;gpu6_layer12_reshape -->
<g id="edge2193" class="edge">
<title>gpu6_layer12_qkv&#45;&gt;gpu6_layer12_reshape</title>
<path fill="none" stroke="black" d="M3929,-5612.53C3929,-5604.24 3929,-5594.85 3929,-5585.94"/>
<polygon fill="black" stroke="black" points="3932.5,-5585.8 3929,-5575.8 3925.5,-5585.8 3932.5,-5585.8"/>
</g>
<!-- gpu6_layer12_attn -->
<g id="node1759" class="node">
<title>gpu6_layer12_attn</title>
<polygon fill="lightblue" stroke="black" points="3993,-5486.7 3865,-5486.7 3865,-5434.7 3993,-5434.7 3993,-5486.7"/>
<text text-anchor="middle" x="3929" y="-5474.7" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3929" y="-5463.7" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-5452.7" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-5441.7" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer12_reshape&#45;&gt;gpu6_layer12_attn -->
<g id="edge2194" class="edge">
<title>gpu6_layer12_reshape&#45;&gt;gpu6_layer12_attn</title>
<path fill="none" stroke="black" d="M3929,-5523.53C3929,-5515.24 3929,-5505.85 3929,-5496.94"/>
<polygon fill="black" stroke="black" points="3932.5,-5496.8 3929,-5486.8 3925.5,-5496.8 3932.5,-5496.8"/>
</g>
<!-- gpu6_layer12_attn_reshape -->
<g id="node1761" class="node">
<title>gpu6_layer12_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3990,-5397.7 3868,-5397.7 3868,-5345.7 3990,-5345.7 3990,-5397.7"/>
<text text-anchor="middle" x="3929" y="-5385.7" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3929" y="-5374.7" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-5363.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-5352.7" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer12_attn&#45;&gt;gpu6_layer12_attn_reshape -->
<g id="edge2195" class="edge">
<title>gpu6_layer12_attn&#45;&gt;gpu6_layer12_attn_reshape</title>
<path fill="none" stroke="black" d="M3929,-5434.53C3929,-5426.24 3929,-5416.85 3929,-5407.94"/>
<polygon fill="black" stroke="black" points="3932.5,-5407.8 3929,-5397.8 3925.5,-5407.8 3932.5,-5407.8"/>
</g>
<!-- gpu6_layer12_attn_out -->
<g id="node1760" class="node">
<title>gpu6_layer12_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3990,-5308.7 3868,-5308.7 3868,-5256.7 3990,-5256.7 3990,-5308.7"/>
<text text-anchor="middle" x="3929" y="-5296.7" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3929" y="-5285.7" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-5274.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-5263.7" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer12_kv_update -->
<g id="node1762" class="node">
<title>gpu6_layer12_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3929" cy="-5182.93" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3929" y="-5196.93" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3929" y="-5185.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-5174.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-5163.93" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer12_attn_out&#45;&gt;gpu6_layer12_kv_update -->
<g id="edge2197" class="edge">
<title>gpu6_layer12_attn_out&#45;&gt;gpu6_layer12_kv_update</title>
<path fill="none" stroke="black" d="M3929,-5256.52C3929,-5248.38 3929,-5239.08 3929,-5229.92"/>
<polygon fill="black" stroke="black" points="3932.5,-5229.71 3929,-5219.71 3925.5,-5229.71 3932.5,-5229.71"/>
</g>
<!-- gpu6_layer12_attn_reshape&#45;&gt;gpu6_layer12_attn_out -->
<g id="edge2196" class="edge">
<title>gpu6_layer12_attn_reshape&#45;&gt;gpu6_layer12_attn_out</title>
<path fill="none" stroke="black" d="M3929,-5345.53C3929,-5337.24 3929,-5327.85 3929,-5318.94"/>
<polygon fill="black" stroke="black" points="3932.5,-5318.8 3929,-5308.8 3925.5,-5318.8 3932.5,-5318.8"/>
</g>
<!-- gpu6_layer12_res1 -->
<g id="node1763" class="node">
<title>gpu6_layer12_res1</title>
<polygon fill="lightblue" stroke="black" points="3990,-5109.16 3868,-5109.16 3868,-5057.16 3990,-5057.16 3990,-5109.16"/>
<text text-anchor="middle" x="3929" y="-5097.16" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3929" y="-5086.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-5075.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-5064.16" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer12_kv_update&#45;&gt;gpu6_layer12_res1 -->
<g id="edge2198" class="edge">
<title>gpu6_layer12_kv_update&#45;&gt;gpu6_layer12_res1</title>
<path fill="none" stroke="black" d="M3929,-5146.08C3929,-5137.4 3929,-5128.13 3929,-5119.47"/>
<polygon fill="black" stroke="black" points="3932.5,-5119.3 3929,-5109.3 3925.5,-5119.3 3932.5,-5119.3"/>
</g>
<!-- gpu6_layer12_ln2 -->
<g id="node1764" class="node">
<title>gpu6_layer12_ln2</title>
<polygon fill="lightblue" stroke="black" points="3990,-5020.16 3868,-5020.16 3868,-4968.16 3990,-4968.16 3990,-5020.16"/>
<text text-anchor="middle" x="3929" y="-5008.16" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3929" y="-4997.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-4986.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-4975.16" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer12_res1&#45;&gt;gpu6_layer12_ln2 -->
<g id="edge2199" class="edge">
<title>gpu6_layer12_res1&#45;&gt;gpu6_layer12_ln2</title>
<path fill="none" stroke="black" d="M3929,-5056.99C3929,-5048.7 3929,-5039.31 3929,-5030.4"/>
<polygon fill="black" stroke="black" points="3932.5,-5030.26 3929,-5020.26 3925.5,-5030.26 3932.5,-5030.26"/>
</g>
<!-- gpu6_layer12_routing -->
<g id="node1765" class="node">
<title>gpu6_layer12_routing</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-4931.16 3854.29,-4931.16 3802.53,-4805.16 4003.71,-4805.16 4055.47,-4931.16"/>
<text text-anchor="middle" x="3929" y="-4887.66" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3929" y="-4876.66" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-4865.66" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-4854.66" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3929" y="-4843.66" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer12_ln2&#45;&gt;gpu6_layer12_routing -->
<g id="edge2200" class="edge">
<title>gpu6_layer12_ln2&#45;&gt;gpu6_layer12_routing</title>
<path fill="none" stroke="black" d="M3929,-4968.06C3929,-4960.13 3929,-4950.93 3929,-4941.4"/>
<polygon fill="black" stroke="black" points="3932.5,-4941.39 3929,-4931.39 3925.5,-4941.39 3932.5,-4941.39"/>
</g>
<!-- gpu6_layer12_expert0 -->
<g id="node1766" class="node">
<title>gpu6_layer12_expert0</title>
<polygon fill="lightblue" stroke="black" points="3710,-4759.16 3588,-4759.16 3588,-4707.16 3710,-4707.16 3710,-4759.16"/>
<text text-anchor="middle" x="3649" y="-4747.16" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3649" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer12_routing&#45;&gt;gpu6_layer12_expert0 -->
<g id="edge2187" class="edge">
<title>gpu6_layer12_routing&#45;&gt;gpu6_layer12_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3803.33,-4807.46C3771.34,-4792.27 3738.34,-4776.59 3711.11,-4763.66"/>
<polygon fill="black" stroke="black" points="3712.26,-4760.33 3701.73,-4759.2 3709.26,-4766.65 3712.26,-4760.33"/>
<text text-anchor="middle" x="3784.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer12_expert1 -->
<g id="node1767" class="node">
<title>gpu6_layer12_expert1</title>
<polygon fill="lightblue" stroke="black" points="3850,-4759.16 3728,-4759.16 3728,-4707.16 3850,-4707.16 3850,-4759.16"/>
<text text-anchor="middle" x="3789" y="-4747.16" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3789" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer12_routing&#45;&gt;gpu6_layer12_expert1 -->
<g id="edge2188" class="edge">
<title>gpu6_layer12_routing&#45;&gt;gpu6_layer12_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3863.51,-4804.94C3849.48,-4791.62 3835.21,-4778.06 3822.97,-4766.43"/>
<polygon fill="black" stroke="black" points="3825.29,-4763.8 3815.63,-4759.45 3820.46,-4768.88 3825.29,-4763.8"/>
<text text-anchor="middle" x="3871.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer12_expert2 -->
<g id="node1768" class="node">
<title>gpu6_layer12_expert2</title>
<polygon fill="lightblue" stroke="black" points="3990,-4759.16 3868,-4759.16 3868,-4707.16 3990,-4707.16 3990,-4759.16"/>
<text text-anchor="middle" x="3929" y="-4747.16" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3929" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer12_routing&#45;&gt;gpu6_layer12_expert2 -->
<g id="edge2189" class="edge">
<title>gpu6_layer12_routing&#45;&gt;gpu6_layer12_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3929,-4804.94C3929,-4792.87 3929,-4780.62 3929,-4769.77"/>
<polygon fill="black" stroke="black" points="3932.5,-4769.45 3929,-4759.45 3925.5,-4769.45 3932.5,-4769.45"/>
<text text-anchor="middle" x="3958.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer12_expert3 -->
<g id="node1769" class="node">
<title>gpu6_layer12_expert3</title>
<polygon fill="lightblue" stroke="black" points="4130,-4759.16 4008,-4759.16 4008,-4707.16 4130,-4707.16 4130,-4759.16"/>
<text text-anchor="middle" x="4069" y="-4747.16" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4069" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer12_routing&#45;&gt;gpu6_layer12_expert3 -->
<g id="edge2190" class="edge">
<title>gpu6_layer12_routing&#45;&gt;gpu6_layer12_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3994.49,-4804.94C4008.52,-4791.62 4022.79,-4778.06 4035.03,-4766.43"/>
<polygon fill="black" stroke="black" points="4037.54,-4768.88 4042.37,-4759.45 4032.71,-4763.8 4037.54,-4768.88"/>
<text text-anchor="middle" x="4052.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer12_expert_agg -->
<g id="node1770" class="node">
<title>gpu6_layer12_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-4670.16 3854.29,-4670.16 3802.53,-4566.16 4003.71,-4566.16 4055.47,-4670.16"/>
<text text-anchor="middle" x="3929" y="-4632.16" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3929" y="-4621.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-4610.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-4599.16" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer12_routing&#45;&gt;gpu6_layer12_expert_agg -->
<g id="edge2205" class="edge">
<title>gpu6_layer12_routing&#45;&gt;gpu6_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M4018.22,-4840.24C4091.96,-4813.08 4178.6,-4766.69 4139,-4707.16 4118.44,-4676.24 4084.7,-4656.17 4050.22,-4643.14"/>
<polygon fill="black" stroke="black" points="4051.08,-4639.73 4040.48,-4639.65 4048.71,-4646.32 4051.08,-4639.73"/>
</g>
<!-- gpu6_layer12_expert0&#45;&gt;gpu6_layer12_expert_agg -->
<g id="edge2201" class="edge">
<title>gpu6_layer12_expert0&#45;&gt;gpu6_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M3710.1,-4707.5C3746.98,-4692.62 3794.7,-4673.36 3836.16,-4656.62"/>
<polygon fill="black" stroke="black" points="3837.5,-4659.86 3845.46,-4652.87 3834.88,-4653.37 3837.5,-4659.86"/>
</g>
<!-- gpu6_layer12_expert1&#45;&gt;gpu6_layer12_expert_agg -->
<g id="edge2202" class="edge">
<title>gpu6_layer12_expert1&#45;&gt;gpu6_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M3820.07,-4707.08C3831.32,-4698 3844.53,-4687.34 3857.8,-4676.63"/>
<polygon fill="black" stroke="black" points="3860.02,-4679.33 3865.6,-4670.33 3855.62,-4673.89 3860.02,-4679.33"/>
</g>
<!-- gpu6_layer12_expert2&#45;&gt;gpu6_layer12_expert_agg -->
<g id="edge2203" class="edge">
<title>gpu6_layer12_expert2&#45;&gt;gpu6_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M3929,-4707.08C3929,-4699.15 3929,-4690.02 3929,-4680.69"/>
<polygon fill="black" stroke="black" points="3932.5,-4680.56 3929,-4670.56 3925.5,-4680.56 3932.5,-4680.56"/>
</g>
<!-- gpu6_layer12_expert3&#45;&gt;gpu6_layer12_expert_agg -->
<g id="edge2204" class="edge">
<title>gpu6_layer12_expert3&#45;&gt;gpu6_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M4037.93,-4707.08C4026.68,-4698 4013.47,-4687.34 4000.2,-4676.63"/>
<polygon fill="black" stroke="black" points="4002.38,-4673.89 3992.4,-4670.33 3997.98,-4679.33 4002.38,-4673.89"/>
</g>
<!-- gpu6_layer12_res2 -->
<g id="node1771" class="node">
<title>gpu6_layer12_res2</title>
<polygon fill="lightblue" stroke="black" points="3990,-4529.16 3868,-4529.16 3868,-4477.16 3990,-4477.16 3990,-4529.16"/>
<text text-anchor="middle" x="3929" y="-4517.16" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3929" y="-4506.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-4495.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-4484.16" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer12_expert_agg&#45;&gt;gpu6_layer12_res2 -->
<g id="edge2206" class="edge">
<title>gpu6_layer12_expert_agg&#45;&gt;gpu6_layer12_res2</title>
<path fill="none" stroke="black" d="M3929,-4565.95C3929,-4557 3929,-4547.87 3929,-4539.47"/>
<polygon fill="black" stroke="black" points="3932.5,-4539.29 3929,-4529.29 3925.5,-4539.29 3932.5,-4539.29"/>
</g>
<!-- gpu6_layer13_ln1 -->
<g id="node1772" class="node">
<title>gpu6_layer13_ln1</title>
<polygon fill="lightblue" stroke="black" points="3990,-4440.16 3868,-4440.16 3868,-4388.16 3990,-4388.16 3990,-4440.16"/>
<text text-anchor="middle" x="3929" y="-4428.16" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3929" y="-4417.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-4406.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-4395.16" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer12_res2&#45;&gt;gpu6_layer13_ln1 -->
<g id="edge2211" class="edge">
<title>gpu6_layer12_res2&#45;&gt;gpu6_layer13_ln1</title>
<path fill="none" stroke="black" d="M3929,-4476.99C3929,-4468.7 3929,-4459.31 3929,-4450.4"/>
<polygon fill="black" stroke="black" points="3932.5,-4450.26 3929,-4440.26 3925.5,-4450.26 3932.5,-4450.26"/>
</g>
<!-- gpu6_layer13_qkv -->
<g id="node1773" class="node">
<title>gpu6_layer13_qkv</title>
<polygon fill="lightblue" stroke="black" points="3990,-4351.16 3868,-4351.16 3868,-4299.16 3990,-4299.16 3990,-4351.16"/>
<text text-anchor="middle" x="3929" y="-4339.16" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3929" y="-4328.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-4317.16" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-4306.16" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer13_ln1&#45;&gt;gpu6_layer13_qkv -->
<g id="edge2212" class="edge">
<title>gpu6_layer13_ln1&#45;&gt;gpu6_layer13_qkv</title>
<path fill="none" stroke="black" d="M3929,-4387.99C3929,-4379.7 3929,-4370.31 3929,-4361.4"/>
<polygon fill="black" stroke="black" points="3932.5,-4361.26 3929,-4351.26 3925.5,-4361.26 3932.5,-4361.26"/>
</g>
<!-- gpu6_layer13_reshape -->
<g id="node1774" class="node">
<title>gpu6_layer13_reshape</title>
<polygon fill="lightblue" stroke="black" points="3993,-4262.16 3865,-4262.16 3865,-4210.16 3993,-4210.16 3993,-4262.16"/>
<text text-anchor="middle" x="3929" y="-4250.16" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3929" y="-4239.16" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-4228.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-4217.16" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer13_qkv&#45;&gt;gpu6_layer13_reshape -->
<g id="edge2213" class="edge">
<title>gpu6_layer13_qkv&#45;&gt;gpu6_layer13_reshape</title>
<path fill="none" stroke="black" d="M3929,-4298.99C3929,-4290.7 3929,-4281.31 3929,-4272.4"/>
<polygon fill="black" stroke="black" points="3932.5,-4272.26 3929,-4262.26 3925.5,-4272.26 3932.5,-4272.26"/>
</g>
<!-- gpu6_layer13_attn -->
<g id="node1775" class="node">
<title>gpu6_layer13_attn</title>
<polygon fill="lightblue" stroke="black" points="3993,-4173.16 3865,-4173.16 3865,-4121.16 3993,-4121.16 3993,-4173.16"/>
<text text-anchor="middle" x="3929" y="-4161.16" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3929" y="-4150.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-4139.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-4128.16" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer13_reshape&#45;&gt;gpu6_layer13_attn -->
<g id="edge2214" class="edge">
<title>gpu6_layer13_reshape&#45;&gt;gpu6_layer13_attn</title>
<path fill="none" stroke="black" d="M3929,-4209.99C3929,-4201.7 3929,-4192.31 3929,-4183.4"/>
<polygon fill="black" stroke="black" points="3932.5,-4183.26 3929,-4173.26 3925.5,-4183.26 3932.5,-4183.26"/>
</g>
<!-- gpu6_layer13_attn_reshape -->
<g id="node1777" class="node">
<title>gpu6_layer13_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3990,-4084.16 3868,-4084.16 3868,-4032.16 3990,-4032.16 3990,-4084.16"/>
<text text-anchor="middle" x="3929" y="-4072.16" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3929" y="-4061.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-4050.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-4039.16" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer13_attn&#45;&gt;gpu6_layer13_attn_reshape -->
<g id="edge2215" class="edge">
<title>gpu6_layer13_attn&#45;&gt;gpu6_layer13_attn_reshape</title>
<path fill="none" stroke="black" d="M3929,-4120.99C3929,-4112.7 3929,-4103.31 3929,-4094.4"/>
<polygon fill="black" stroke="black" points="3932.5,-4094.26 3929,-4084.26 3925.5,-4094.26 3932.5,-4094.26"/>
</g>
<!-- gpu6_layer13_attn_out -->
<g id="node1776" class="node">
<title>gpu6_layer13_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3990,-3995.16 3868,-3995.16 3868,-3943.16 3990,-3943.16 3990,-3995.16"/>
<text text-anchor="middle" x="3929" y="-3983.16" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3929" y="-3972.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-3961.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-3950.16" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer13_kv_update -->
<g id="node1778" class="node">
<title>gpu6_layer13_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3929" cy="-3869.39" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3929" y="-3883.39" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3929" y="-3872.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-3861.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-3850.39" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer13_attn_out&#45;&gt;gpu6_layer13_kv_update -->
<g id="edge2217" class="edge">
<title>gpu6_layer13_attn_out&#45;&gt;gpu6_layer13_kv_update</title>
<path fill="none" stroke="black" d="M3929,-3942.98C3929,-3934.84 3929,-3925.54 3929,-3916.38"/>
<polygon fill="black" stroke="black" points="3932.5,-3916.17 3929,-3906.17 3925.5,-3916.17 3932.5,-3916.17"/>
</g>
<!-- gpu6_layer13_attn_reshape&#45;&gt;gpu6_layer13_attn_out -->
<g id="edge2216" class="edge">
<title>gpu6_layer13_attn_reshape&#45;&gt;gpu6_layer13_attn_out</title>
<path fill="none" stroke="black" d="M3929,-4031.99C3929,-4023.7 3929,-4014.31 3929,-4005.4"/>
<polygon fill="black" stroke="black" points="3932.5,-4005.26 3929,-3995.26 3925.5,-4005.26 3932.5,-4005.26"/>
</g>
<!-- gpu6_layer13_res1 -->
<g id="node1779" class="node">
<title>gpu6_layer13_res1</title>
<polygon fill="lightblue" stroke="black" points="3990,-3795.62 3868,-3795.62 3868,-3743.62 3990,-3743.62 3990,-3795.62"/>
<text text-anchor="middle" x="3929" y="-3783.62" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3929" y="-3772.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-3761.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-3750.62" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer13_kv_update&#45;&gt;gpu6_layer13_res1 -->
<g id="edge2218" class="edge">
<title>gpu6_layer13_kv_update&#45;&gt;gpu6_layer13_res1</title>
<path fill="none" stroke="black" d="M3929,-3832.54C3929,-3823.86 3929,-3814.59 3929,-3805.93"/>
<polygon fill="black" stroke="black" points="3932.5,-3805.76 3929,-3795.76 3925.5,-3805.76 3932.5,-3805.76"/>
</g>
<!-- gpu6_layer13_ln2 -->
<g id="node1780" class="node">
<title>gpu6_layer13_ln2</title>
<polygon fill="lightblue" stroke="black" points="3990,-3706.62 3868,-3706.62 3868,-3654.62 3990,-3654.62 3990,-3706.62"/>
<text text-anchor="middle" x="3929" y="-3694.62" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3929" y="-3683.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-3672.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-3661.62" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer13_res1&#45;&gt;gpu6_layer13_ln2 -->
<g id="edge2219" class="edge">
<title>gpu6_layer13_res1&#45;&gt;gpu6_layer13_ln2</title>
<path fill="none" stroke="black" d="M3929,-3743.45C3929,-3735.16 3929,-3725.77 3929,-3716.87"/>
<polygon fill="black" stroke="black" points="3932.5,-3716.72 3929,-3706.72 3925.5,-3716.72 3932.5,-3716.72"/>
</g>
<!-- gpu6_layer13_routing -->
<g id="node1781" class="node">
<title>gpu6_layer13_routing</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-3617.62 3854.29,-3617.62 3802.53,-3491.62 4003.71,-3491.62 4055.47,-3617.62"/>
<text text-anchor="middle" x="3929" y="-3574.12" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3929" y="-3563.12" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-3552.12" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-3541.12" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3929" y="-3530.12" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer13_ln2&#45;&gt;gpu6_layer13_routing -->
<g id="edge2220" class="edge">
<title>gpu6_layer13_ln2&#45;&gt;gpu6_layer13_routing</title>
<path fill="none" stroke="black" d="M3929,-3654.52C3929,-3646.59 3929,-3637.4 3929,-3627.87"/>
<polygon fill="black" stroke="black" points="3932.5,-3627.85 3929,-3617.85 3925.5,-3627.85 3932.5,-3627.85"/>
</g>
<!-- gpu6_layer13_expert0 -->
<g id="node1782" class="node">
<title>gpu6_layer13_expert0</title>
<polygon fill="lightblue" stroke="black" points="3710,-3445.62 3588,-3445.62 3588,-3393.62 3710,-3393.62 3710,-3445.62"/>
<text text-anchor="middle" x="3649" y="-3433.62" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3649" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer13_routing&#45;&gt;gpu6_layer13_expert0 -->
<g id="edge2207" class="edge">
<title>gpu6_layer13_routing&#45;&gt;gpu6_layer13_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3803.33,-3493.93C3771.34,-3478.73 3738.34,-3463.05 3711.11,-3450.12"/>
<polygon fill="black" stroke="black" points="3712.26,-3446.79 3701.73,-3445.66 3709.26,-3453.11 3712.26,-3446.79"/>
<text text-anchor="middle" x="3784.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer13_expert1 -->
<g id="node1783" class="node">
<title>gpu6_layer13_expert1</title>
<polygon fill="lightblue" stroke="black" points="3850,-3445.62 3728,-3445.62 3728,-3393.62 3850,-3393.62 3850,-3445.62"/>
<text text-anchor="middle" x="3789" y="-3433.62" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3789" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer13_routing&#45;&gt;gpu6_layer13_expert1 -->
<g id="edge2208" class="edge">
<title>gpu6_layer13_routing&#45;&gt;gpu6_layer13_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3863.51,-3491.4C3849.48,-3478.08 3835.21,-3464.52 3822.97,-3452.89"/>
<polygon fill="black" stroke="black" points="3825.29,-3450.26 3815.63,-3445.91 3820.46,-3455.34 3825.29,-3450.26"/>
<text text-anchor="middle" x="3871.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer13_expert2 -->
<g id="node1784" class="node">
<title>gpu6_layer13_expert2</title>
<polygon fill="lightblue" stroke="black" points="3990,-3445.62 3868,-3445.62 3868,-3393.62 3990,-3393.62 3990,-3445.62"/>
<text text-anchor="middle" x="3929" y="-3433.62" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3929" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer13_routing&#45;&gt;gpu6_layer13_expert2 -->
<g id="edge2209" class="edge">
<title>gpu6_layer13_routing&#45;&gt;gpu6_layer13_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3929,-3491.4C3929,-3479.33 3929,-3467.08 3929,-3456.23"/>
<polygon fill="black" stroke="black" points="3932.5,-3455.91 3929,-3445.91 3925.5,-3455.91 3932.5,-3455.91"/>
<text text-anchor="middle" x="3958.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer13_expert3 -->
<g id="node1785" class="node">
<title>gpu6_layer13_expert3</title>
<polygon fill="lightblue" stroke="black" points="4130,-3445.62 4008,-3445.62 4008,-3393.62 4130,-3393.62 4130,-3445.62"/>
<text text-anchor="middle" x="4069" y="-3433.62" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4069" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer13_routing&#45;&gt;gpu6_layer13_expert3 -->
<g id="edge2210" class="edge">
<title>gpu6_layer13_routing&#45;&gt;gpu6_layer13_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3994.49,-3491.4C4008.52,-3478.08 4022.79,-3464.52 4035.03,-3452.89"/>
<polygon fill="black" stroke="black" points="4037.54,-3455.34 4042.37,-3445.91 4032.71,-3450.26 4037.54,-3455.34"/>
<text text-anchor="middle" x="4052.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer13_expert_agg -->
<g id="node1786" class="node">
<title>gpu6_layer13_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-3356.62 3854.29,-3356.62 3802.53,-3252.62 4003.71,-3252.62 4055.47,-3356.62"/>
<text text-anchor="middle" x="3929" y="-3318.62" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3929" y="-3307.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-3296.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-3285.62" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer13_routing&#45;&gt;gpu6_layer13_expert_agg -->
<g id="edge2225" class="edge">
<title>gpu6_layer13_routing&#45;&gt;gpu6_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M4018.22,-3526.7C4091.96,-3499.54 4178.6,-3453.15 4139,-3393.62 4118.44,-3362.71 4084.7,-3342.63 4050.22,-3329.6"/>
<polygon fill="black" stroke="black" points="4051.08,-3326.19 4040.48,-3326.11 4048.71,-3332.78 4051.08,-3326.19"/>
</g>
<!-- gpu6_layer13_expert0&#45;&gt;gpu6_layer13_expert_agg -->
<g id="edge2221" class="edge">
<title>gpu6_layer13_expert0&#45;&gt;gpu6_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M3710.1,-3393.96C3746.98,-3379.08 3794.7,-3359.82 3836.16,-3343.08"/>
<polygon fill="black" stroke="black" points="3837.5,-3346.32 3845.46,-3339.33 3834.88,-3339.83 3837.5,-3346.32"/>
</g>
<!-- gpu6_layer13_expert1&#45;&gt;gpu6_layer13_expert_agg -->
<g id="edge2222" class="edge">
<title>gpu6_layer13_expert1&#45;&gt;gpu6_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M3820.07,-3393.54C3831.32,-3384.46 3844.53,-3373.8 3857.8,-3363.09"/>
<polygon fill="black" stroke="black" points="3860.02,-3365.79 3865.6,-3356.79 3855.62,-3360.35 3860.02,-3365.79"/>
</g>
<!-- gpu6_layer13_expert2&#45;&gt;gpu6_layer13_expert_agg -->
<g id="edge2223" class="edge">
<title>gpu6_layer13_expert2&#45;&gt;gpu6_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M3929,-3393.54C3929,-3385.61 3929,-3376.48 3929,-3367.16"/>
<polygon fill="black" stroke="black" points="3932.5,-3367.02 3929,-3357.02 3925.5,-3367.02 3932.5,-3367.02"/>
</g>
<!-- gpu6_layer13_expert3&#45;&gt;gpu6_layer13_expert_agg -->
<g id="edge2224" class="edge">
<title>gpu6_layer13_expert3&#45;&gt;gpu6_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M4037.93,-3393.54C4026.68,-3384.46 4013.47,-3373.8 4000.2,-3363.09"/>
<polygon fill="black" stroke="black" points="4002.38,-3360.35 3992.4,-3356.79 3997.98,-3365.79 4002.38,-3360.35"/>
</g>
<!-- gpu6_layer13_res2 -->
<g id="node1787" class="node">
<title>gpu6_layer13_res2</title>
<polygon fill="lightblue" stroke="black" points="3990,-3215.62 3868,-3215.62 3868,-3163.62 3990,-3163.62 3990,-3215.62"/>
<text text-anchor="middle" x="3929" y="-3203.62" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3929" y="-3192.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-3181.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-3170.62" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer13_expert_agg&#45;&gt;gpu6_layer13_res2 -->
<g id="edge2226" class="edge">
<title>gpu6_layer13_expert_agg&#45;&gt;gpu6_layer13_res2</title>
<path fill="none" stroke="black" d="M3929,-3252.41C3929,-3243.46 3929,-3234.33 3929,-3225.93"/>
<polygon fill="black" stroke="black" points="3932.5,-3225.75 3929,-3215.75 3925.5,-3225.75 3932.5,-3225.75"/>
</g>
<!-- gpu6_layer14_ln1 -->
<g id="node1788" class="node">
<title>gpu6_layer14_ln1</title>
<polygon fill="lightblue" stroke="black" points="3990,-3126.62 3868,-3126.62 3868,-3074.62 3990,-3074.62 3990,-3126.62"/>
<text text-anchor="middle" x="3929" y="-3114.62" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3929" y="-3103.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-3092.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-3081.62" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer13_res2&#45;&gt;gpu6_layer14_ln1 -->
<g id="edge2231" class="edge">
<title>gpu6_layer13_res2&#45;&gt;gpu6_layer14_ln1</title>
<path fill="none" stroke="black" d="M3929,-3163.45C3929,-3155.16 3929,-3145.77 3929,-3136.87"/>
<polygon fill="black" stroke="black" points="3932.5,-3136.72 3929,-3126.72 3925.5,-3136.72 3932.5,-3136.72"/>
</g>
<!-- gpu6_layer14_qkv -->
<g id="node1789" class="node">
<title>gpu6_layer14_qkv</title>
<polygon fill="lightblue" stroke="black" points="3990,-3037.62 3868,-3037.62 3868,-2985.62 3990,-2985.62 3990,-3037.62"/>
<text text-anchor="middle" x="3929" y="-3025.62" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3929" y="-3014.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-3003.62" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-2992.62" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer14_ln1&#45;&gt;gpu6_layer14_qkv -->
<g id="edge2232" class="edge">
<title>gpu6_layer14_ln1&#45;&gt;gpu6_layer14_qkv</title>
<path fill="none" stroke="black" d="M3929,-3074.45C3929,-3066.16 3929,-3056.77 3929,-3047.87"/>
<polygon fill="black" stroke="black" points="3932.5,-3047.72 3929,-3037.72 3925.5,-3047.72 3932.5,-3047.72"/>
</g>
<!-- gpu6_layer14_reshape -->
<g id="node1790" class="node">
<title>gpu6_layer14_reshape</title>
<polygon fill="lightblue" stroke="black" points="3993,-2948.62 3865,-2948.62 3865,-2896.62 3993,-2896.62 3993,-2948.62"/>
<text text-anchor="middle" x="3929" y="-2936.62" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3929" y="-2925.62" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-2914.62" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-2903.62" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer14_qkv&#45;&gt;gpu6_layer14_reshape -->
<g id="edge2233" class="edge">
<title>gpu6_layer14_qkv&#45;&gt;gpu6_layer14_reshape</title>
<path fill="none" stroke="black" d="M3929,-2985.45C3929,-2977.16 3929,-2967.77 3929,-2958.87"/>
<polygon fill="black" stroke="black" points="3932.5,-2958.72 3929,-2948.72 3925.5,-2958.72 3932.5,-2958.72"/>
</g>
<!-- gpu6_layer14_attn -->
<g id="node1791" class="node">
<title>gpu6_layer14_attn</title>
<polygon fill="lightblue" stroke="black" points="3993,-2859.62 3865,-2859.62 3865,-2807.62 3993,-2807.62 3993,-2859.62"/>
<text text-anchor="middle" x="3929" y="-2847.62" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3929" y="-2836.62" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-2825.62" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-2814.62" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer14_reshape&#45;&gt;gpu6_layer14_attn -->
<g id="edge2234" class="edge">
<title>gpu6_layer14_reshape&#45;&gt;gpu6_layer14_attn</title>
<path fill="none" stroke="black" d="M3929,-2896.45C3929,-2888.16 3929,-2878.77 3929,-2869.87"/>
<polygon fill="black" stroke="black" points="3932.5,-2869.72 3929,-2859.72 3925.5,-2869.72 3932.5,-2869.72"/>
</g>
<!-- gpu6_layer14_attn_reshape -->
<g id="node1793" class="node">
<title>gpu6_layer14_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3990,-2770.62 3868,-2770.62 3868,-2718.62 3990,-2718.62 3990,-2770.62"/>
<text text-anchor="middle" x="3929" y="-2758.62" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3929" y="-2747.62" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-2736.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-2725.62" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer14_attn&#45;&gt;gpu6_layer14_attn_reshape -->
<g id="edge2235" class="edge">
<title>gpu6_layer14_attn&#45;&gt;gpu6_layer14_attn_reshape</title>
<path fill="none" stroke="black" d="M3929,-2807.45C3929,-2799.16 3929,-2789.77 3929,-2780.87"/>
<polygon fill="black" stroke="black" points="3932.5,-2780.72 3929,-2770.72 3925.5,-2780.72 3932.5,-2780.72"/>
</g>
<!-- gpu6_layer14_attn_out -->
<g id="node1792" class="node">
<title>gpu6_layer14_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3990,-2681.62 3868,-2681.62 3868,-2629.62 3990,-2629.62 3990,-2681.62"/>
<text text-anchor="middle" x="3929" y="-2669.62" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3929" y="-2658.62" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-2647.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-2636.62" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer14_kv_update -->
<g id="node1794" class="node">
<title>gpu6_layer14_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3929" cy="-2555.85" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3929" y="-2569.85" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3929" y="-2558.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-2547.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-2536.85" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer14_attn_out&#45;&gt;gpu6_layer14_kv_update -->
<g id="edge2237" class="edge">
<title>gpu6_layer14_attn_out&#45;&gt;gpu6_layer14_kv_update</title>
<path fill="none" stroke="black" d="M3929,-2629.44C3929,-2621.3 3929,-2612 3929,-2602.84"/>
<polygon fill="black" stroke="black" points="3932.5,-2602.63 3929,-2592.63 3925.5,-2602.63 3932.5,-2602.63"/>
</g>
<!-- gpu6_layer14_attn_reshape&#45;&gt;gpu6_layer14_attn_out -->
<g id="edge2236" class="edge">
<title>gpu6_layer14_attn_reshape&#45;&gt;gpu6_layer14_attn_out</title>
<path fill="none" stroke="black" d="M3929,-2718.45C3929,-2710.16 3929,-2700.77 3929,-2691.87"/>
<polygon fill="black" stroke="black" points="3932.5,-2691.72 3929,-2681.72 3925.5,-2691.72 3932.5,-2691.72"/>
</g>
<!-- gpu6_layer14_res1 -->
<g id="node1795" class="node">
<title>gpu6_layer14_res1</title>
<polygon fill="lightblue" stroke="black" points="3990,-2482.08 3868,-2482.08 3868,-2430.08 3990,-2430.08 3990,-2482.08"/>
<text text-anchor="middle" x="3929" y="-2470.08" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3929" y="-2459.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-2448.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-2437.08" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer14_kv_update&#45;&gt;gpu6_layer14_res1 -->
<g id="edge2238" class="edge">
<title>gpu6_layer14_kv_update&#45;&gt;gpu6_layer14_res1</title>
<path fill="none" stroke="black" d="M3929,-2519C3929,-2510.32 3929,-2501.05 3929,-2492.39"/>
<polygon fill="black" stroke="black" points="3932.5,-2492.22 3929,-2482.22 3925.5,-2492.22 3932.5,-2492.22"/>
</g>
<!-- gpu6_layer14_ln2 -->
<g id="node1796" class="node">
<title>gpu6_layer14_ln2</title>
<polygon fill="lightblue" stroke="black" points="3990,-2393.08 3868,-2393.08 3868,-2341.08 3990,-2341.08 3990,-2393.08"/>
<text text-anchor="middle" x="3929" y="-2381.08" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3929" y="-2370.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-2359.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-2348.08" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer14_res1&#45;&gt;gpu6_layer14_ln2 -->
<g id="edge2239" class="edge">
<title>gpu6_layer14_res1&#45;&gt;gpu6_layer14_ln2</title>
<path fill="none" stroke="black" d="M3929,-2429.91C3929,-2421.62 3929,-2412.23 3929,-2403.33"/>
<polygon fill="black" stroke="black" points="3932.5,-2403.19 3929,-2393.19 3925.5,-2403.19 3932.5,-2403.19"/>
</g>
<!-- gpu6_layer14_routing -->
<g id="node1797" class="node">
<title>gpu6_layer14_routing</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-2304.08 3854.29,-2304.08 3802.53,-2178.08 4003.71,-2178.08 4055.47,-2304.08"/>
<text text-anchor="middle" x="3929" y="-2260.58" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3929" y="-2249.58" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-2238.58" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-2227.58" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3929" y="-2216.58" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer14_ln2&#45;&gt;gpu6_layer14_routing -->
<g id="edge2240" class="edge">
<title>gpu6_layer14_ln2&#45;&gt;gpu6_layer14_routing</title>
<path fill="none" stroke="black" d="M3929,-2340.98C3929,-2333.05 3929,-2323.86 3929,-2314.33"/>
<polygon fill="black" stroke="black" points="3932.5,-2314.31 3929,-2304.31 3925.5,-2314.31 3932.5,-2314.31"/>
</g>
<!-- gpu6_layer14_expert0 -->
<g id="node1798" class="node">
<title>gpu6_layer14_expert0</title>
<polygon fill="lightblue" stroke="black" points="3710,-2132.08 3588,-2132.08 3588,-2080.08 3710,-2080.08 3710,-2132.08"/>
<text text-anchor="middle" x="3649" y="-2120.08" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3649" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer14_routing&#45;&gt;gpu6_layer14_expert0 -->
<g id="edge2227" class="edge">
<title>gpu6_layer14_routing&#45;&gt;gpu6_layer14_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3803.33,-2180.39C3771.34,-2165.19 3738.34,-2149.51 3711.11,-2136.58"/>
<polygon fill="black" stroke="black" points="3712.26,-2133.25 3701.73,-2132.12 3709.26,-2139.58 3712.26,-2133.25"/>
<text text-anchor="middle" x="3784.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer14_expert1 -->
<g id="node1799" class="node">
<title>gpu6_layer14_expert1</title>
<polygon fill="lightblue" stroke="black" points="3850,-2132.08 3728,-2132.08 3728,-2080.08 3850,-2080.08 3850,-2132.08"/>
<text text-anchor="middle" x="3789" y="-2120.08" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3789" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer14_routing&#45;&gt;gpu6_layer14_expert1 -->
<g id="edge2228" class="edge">
<title>gpu6_layer14_routing&#45;&gt;gpu6_layer14_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3863.51,-2177.86C3849.48,-2164.54 3835.21,-2150.98 3822.97,-2139.35"/>
<polygon fill="black" stroke="black" points="3825.29,-2136.72 3815.63,-2132.37 3820.46,-2141.8 3825.29,-2136.72"/>
<text text-anchor="middle" x="3871.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer14_expert2 -->
<g id="node1800" class="node">
<title>gpu6_layer14_expert2</title>
<polygon fill="lightblue" stroke="black" points="3990,-2132.08 3868,-2132.08 3868,-2080.08 3990,-2080.08 3990,-2132.08"/>
<text text-anchor="middle" x="3929" y="-2120.08" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3929" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer14_routing&#45;&gt;gpu6_layer14_expert2 -->
<g id="edge2229" class="edge">
<title>gpu6_layer14_routing&#45;&gt;gpu6_layer14_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3929,-2177.86C3929,-2165.79 3929,-2153.54 3929,-2142.69"/>
<polygon fill="black" stroke="black" points="3932.5,-2142.37 3929,-2132.37 3925.5,-2142.37 3932.5,-2142.37"/>
<text text-anchor="middle" x="3958.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer14_expert3 -->
<g id="node1801" class="node">
<title>gpu6_layer14_expert3</title>
<polygon fill="lightblue" stroke="black" points="4130,-2132.08 4008,-2132.08 4008,-2080.08 4130,-2080.08 4130,-2132.08"/>
<text text-anchor="middle" x="4069" y="-2120.08" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4069" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer14_routing&#45;&gt;gpu6_layer14_expert3 -->
<g id="edge2230" class="edge">
<title>gpu6_layer14_routing&#45;&gt;gpu6_layer14_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3994.49,-2177.86C4008.52,-2164.54 4022.79,-2150.98 4035.03,-2139.35"/>
<polygon fill="black" stroke="black" points="4037.54,-2141.8 4042.37,-2132.37 4032.71,-2136.72 4037.54,-2141.8"/>
<text text-anchor="middle" x="4052.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer14_expert_agg -->
<g id="node1802" class="node">
<title>gpu6_layer14_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-2043.08 3854.29,-2043.08 3802.53,-1939.08 4003.71,-1939.08 4055.47,-2043.08"/>
<text text-anchor="middle" x="3929" y="-2005.08" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3929" y="-1994.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-1983.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-1972.08" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer14_routing&#45;&gt;gpu6_layer14_expert_agg -->
<g id="edge2245" class="edge">
<title>gpu6_layer14_routing&#45;&gt;gpu6_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M4018.22,-2213.16C4091.96,-2186 4178.6,-2139.61 4139,-2080.08 4118.44,-2049.17 4084.7,-2029.09 4050.22,-2016.06"/>
<polygon fill="black" stroke="black" points="4051.08,-2012.65 4040.48,-2012.57 4048.71,-2019.24 4051.08,-2012.65"/>
</g>
<!-- gpu6_layer14_expert0&#45;&gt;gpu6_layer14_expert_agg -->
<g id="edge2241" class="edge">
<title>gpu6_layer14_expert0&#45;&gt;gpu6_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M3710.1,-2080.42C3746.98,-2065.54 3794.7,-2046.28 3836.16,-2029.54"/>
<polygon fill="black" stroke="black" points="3837.5,-2032.78 3845.46,-2025.79 3834.88,-2026.29 3837.5,-2032.78"/>
</g>
<!-- gpu6_layer14_expert1&#45;&gt;gpu6_layer14_expert_agg -->
<g id="edge2242" class="edge">
<title>gpu6_layer14_expert1&#45;&gt;gpu6_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M3820.07,-2080C3831.32,-2070.92 3844.53,-2060.26 3857.8,-2049.55"/>
<polygon fill="black" stroke="black" points="3860.02,-2052.25 3865.6,-2043.25 3855.62,-2046.81 3860.02,-2052.25"/>
</g>
<!-- gpu6_layer14_expert2&#45;&gt;gpu6_layer14_expert_agg -->
<g id="edge2243" class="edge">
<title>gpu6_layer14_expert2&#45;&gt;gpu6_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M3929,-2080C3929,-2072.07 3929,-2062.94 3929,-2053.62"/>
<polygon fill="black" stroke="black" points="3932.5,-2053.48 3929,-2043.48 3925.5,-2053.48 3932.5,-2053.48"/>
</g>
<!-- gpu6_layer14_expert3&#45;&gt;gpu6_layer14_expert_agg -->
<g id="edge2244" class="edge">
<title>gpu6_layer14_expert3&#45;&gt;gpu6_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M4037.93,-2080C4026.68,-2070.92 4013.47,-2060.26 4000.2,-2049.55"/>
<polygon fill="black" stroke="black" points="4002.38,-2046.81 3992.4,-2043.25 3997.98,-2052.25 4002.38,-2046.81"/>
</g>
<!-- gpu6_layer14_res2 -->
<g id="node1803" class="node">
<title>gpu6_layer14_res2</title>
<polygon fill="lightblue" stroke="black" points="3990,-1902.08 3868,-1902.08 3868,-1850.08 3990,-1850.08 3990,-1902.08"/>
<text text-anchor="middle" x="3929" y="-1890.08" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3929" y="-1879.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-1868.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-1857.08" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer14_expert_agg&#45;&gt;gpu6_layer14_res2 -->
<g id="edge2246" class="edge">
<title>gpu6_layer14_expert_agg&#45;&gt;gpu6_layer14_res2</title>
<path fill="none" stroke="black" d="M3929,-1938.87C3929,-1929.92 3929,-1920.79 3929,-1912.39"/>
<polygon fill="black" stroke="black" points="3932.5,-1912.21 3929,-1902.21 3925.5,-1912.21 3932.5,-1912.21"/>
</g>
<!-- gpu6_layer15_ln1 -->
<g id="node1804" class="node">
<title>gpu6_layer15_ln1</title>
<polygon fill="lightblue" stroke="black" points="3990,-1813.08 3868,-1813.08 3868,-1761.08 3990,-1761.08 3990,-1813.08"/>
<text text-anchor="middle" x="3929" y="-1801.08" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="3929" y="-1790.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-1779.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-1768.08" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer14_res2&#45;&gt;gpu6_layer15_ln1 -->
<g id="edge2251" class="edge">
<title>gpu6_layer14_res2&#45;&gt;gpu6_layer15_ln1</title>
<path fill="none" stroke="black" d="M3929,-1849.91C3929,-1841.62 3929,-1832.23 3929,-1823.33"/>
<polygon fill="black" stroke="black" points="3932.5,-1823.19 3929,-1813.19 3925.5,-1823.19 3932.5,-1823.19"/>
</g>
<!-- gpu6_layer15_qkv -->
<g id="node1805" class="node">
<title>gpu6_layer15_qkv</title>
<polygon fill="lightblue" stroke="black" points="3990,-1724.08 3868,-1724.08 3868,-1672.08 3990,-1672.08 3990,-1724.08"/>
<text text-anchor="middle" x="3929" y="-1712.08" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3929" y="-1701.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-1690.08" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-1679.08" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer15_ln1&#45;&gt;gpu6_layer15_qkv -->
<g id="edge2252" class="edge">
<title>gpu6_layer15_ln1&#45;&gt;gpu6_layer15_qkv</title>
<path fill="none" stroke="black" d="M3929,-1760.91C3929,-1752.62 3929,-1743.23 3929,-1734.33"/>
<polygon fill="black" stroke="black" points="3932.5,-1734.19 3929,-1724.19 3925.5,-1734.19 3932.5,-1734.19"/>
</g>
<!-- gpu6_layer15_reshape -->
<g id="node1806" class="node">
<title>gpu6_layer15_reshape</title>
<polygon fill="lightblue" stroke="black" points="3993,-1635.08 3865,-1635.08 3865,-1583.08 3993,-1583.08 3993,-1635.08"/>
<text text-anchor="middle" x="3929" y="-1623.08" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="3929" y="-1612.08" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="3929" y="-1601.08" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-1590.08" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer15_qkv&#45;&gt;gpu6_layer15_reshape -->
<g id="edge2253" class="edge">
<title>gpu6_layer15_qkv&#45;&gt;gpu6_layer15_reshape</title>
<path fill="none" stroke="black" d="M3929,-1671.91C3929,-1663.62 3929,-1654.23 3929,-1645.33"/>
<polygon fill="black" stroke="black" points="3932.5,-1645.19 3929,-1635.19 3925.5,-1645.19 3932.5,-1645.19"/>
</g>
<!-- gpu6_layer15_attn -->
<g id="node1807" class="node">
<title>gpu6_layer15_attn</title>
<polygon fill="lightblue" stroke="black" points="3993,-1546.08 3865,-1546.08 3865,-1494.08 3993,-1494.08 3993,-1546.08"/>
<text text-anchor="middle" x="3929" y="-1534.08" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3929" y="-1523.08" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-1512.08" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-1501.08" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer15_reshape&#45;&gt;gpu6_layer15_attn -->
<g id="edge2254" class="edge">
<title>gpu6_layer15_reshape&#45;&gt;gpu6_layer15_attn</title>
<path fill="none" stroke="black" d="M3929,-1582.91C3929,-1574.62 3929,-1565.23 3929,-1556.33"/>
<polygon fill="black" stroke="black" points="3932.5,-1556.19 3929,-1546.19 3925.5,-1556.19 3932.5,-1556.19"/>
</g>
<!-- gpu6_layer15_attn_reshape -->
<g id="node1809" class="node">
<title>gpu6_layer15_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3990,-1457.08 3868,-1457.08 3868,-1405.08 3990,-1405.08 3990,-1457.08"/>
<text text-anchor="middle" x="3929" y="-1445.08" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="3929" y="-1434.08" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-1423.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-1412.08" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer15_attn&#45;&gt;gpu6_layer15_attn_reshape -->
<g id="edge2255" class="edge">
<title>gpu6_layer15_attn&#45;&gt;gpu6_layer15_attn_reshape</title>
<path fill="none" stroke="black" d="M3929,-1493.91C3929,-1485.62 3929,-1476.23 3929,-1467.33"/>
<polygon fill="black" stroke="black" points="3932.5,-1467.19 3929,-1457.19 3925.5,-1467.19 3932.5,-1467.19"/>
</g>
<!-- gpu6_layer15_attn_out -->
<g id="node1808" class="node">
<title>gpu6_layer15_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3990,-1368.08 3868,-1368.08 3868,-1316.08 3990,-1316.08 3990,-1368.08"/>
<text text-anchor="middle" x="3929" y="-1356.08" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3929" y="-1345.08" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3929" y="-1334.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-1323.08" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer15_kv_update -->
<g id="node1810" class="node">
<title>gpu6_layer15_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3929" cy="-1242.31" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3929" y="-1256.31" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3929" y="-1245.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-1234.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-1223.31" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer15_attn_out&#45;&gt;gpu6_layer15_kv_update -->
<g id="edge2257" class="edge">
<title>gpu6_layer15_attn_out&#45;&gt;gpu6_layer15_kv_update</title>
<path fill="none" stroke="black" d="M3929,-1315.9C3929,-1307.76 3929,-1298.46 3929,-1289.3"/>
<polygon fill="black" stroke="black" points="3932.5,-1289.09 3929,-1279.09 3925.5,-1289.09 3932.5,-1289.09"/>
</g>
<!-- gpu6_layer15_attn_reshape&#45;&gt;gpu6_layer15_attn_out -->
<g id="edge2256" class="edge">
<title>gpu6_layer15_attn_reshape&#45;&gt;gpu6_layer15_attn_out</title>
<path fill="none" stroke="black" d="M3929,-1404.91C3929,-1396.62 3929,-1387.23 3929,-1378.33"/>
<polygon fill="black" stroke="black" points="3932.5,-1378.19 3929,-1368.19 3925.5,-1378.19 3932.5,-1378.19"/>
</g>
<!-- gpu6_layer15_res1 -->
<g id="node1811" class="node">
<title>gpu6_layer15_res1</title>
<polygon fill="lightblue" stroke="black" points="3990,-1168.54 3868,-1168.54 3868,-1116.54 3990,-1116.54 3990,-1168.54"/>
<text text-anchor="middle" x="3929" y="-1156.54" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3929" y="-1145.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-1134.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-1123.54" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer15_kv_update&#45;&gt;gpu6_layer15_res1 -->
<g id="edge2258" class="edge">
<title>gpu6_layer15_kv_update&#45;&gt;gpu6_layer15_res1</title>
<path fill="none" stroke="black" d="M3929,-1205.46C3929,-1196.78 3929,-1187.51 3929,-1178.85"/>
<polygon fill="black" stroke="black" points="3932.5,-1178.69 3929,-1168.69 3925.5,-1178.69 3932.5,-1178.69"/>
</g>
<!-- gpu6_layer15_ln2 -->
<g id="node1812" class="node">
<title>gpu6_layer15_ln2</title>
<polygon fill="lightblue" stroke="black" points="3990,-1079.54 3868,-1079.54 3868,-1027.54 3990,-1027.54 3990,-1079.54"/>
<text text-anchor="middle" x="3929" y="-1067.54" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3929" y="-1056.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-1045.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-1034.54" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer15_res1&#45;&gt;gpu6_layer15_ln2 -->
<g id="edge2259" class="edge">
<title>gpu6_layer15_res1&#45;&gt;gpu6_layer15_ln2</title>
<path fill="none" stroke="black" d="M3929,-1116.38C3929,-1108.08 3929,-1098.69 3929,-1089.79"/>
<polygon fill="black" stroke="black" points="3932.5,-1089.65 3929,-1079.65 3925.5,-1089.65 3932.5,-1089.65"/>
</g>
<!-- gpu6_layer15_routing -->
<g id="node1813" class="node">
<title>gpu6_layer15_routing</title>
<polygon fill="lightyellow" stroke="black" points="4055.47,-990.54 3854.29,-990.54 3802.53,-864.54 4003.71,-864.54 4055.47,-990.54"/>
<text text-anchor="middle" x="3929" y="-947.04" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="3929" y="-936.04" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-925.04" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-914.04" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="3929" y="-903.04" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer15_ln2&#45;&gt;gpu6_layer15_routing -->
<g id="edge2260" class="edge">
<title>gpu6_layer15_ln2&#45;&gt;gpu6_layer15_routing</title>
<path fill="none" stroke="black" d="M3929,-1027.45C3929,-1019.51 3929,-1010.32 3929,-1000.79"/>
<polygon fill="black" stroke="black" points="3932.5,-1000.77 3929,-990.77 3925.5,-1000.77 3932.5,-1000.77"/>
</g>
<!-- gpu6_layer15_expert0 -->
<g id="node1814" class="node">
<title>gpu6_layer15_expert0</title>
<polygon fill="lightblue" stroke="black" points="3710,-818.54 3588,-818.54 3588,-766.54 3710,-766.54 3710,-818.54"/>
<text text-anchor="middle" x="3649" y="-806.54" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3649" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3649" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer15_routing&#45;&gt;gpu6_layer15_expert0 -->
<g id="edge2247" class="edge">
<title>gpu6_layer15_routing&#45;&gt;gpu6_layer15_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3803.33,-866.85C3771.34,-851.65 3738.34,-835.98 3711.11,-823.04"/>
<polygon fill="black" stroke="black" points="3712.26,-819.71 3701.73,-818.58 3709.26,-826.04 3712.26,-819.71"/>
<text text-anchor="middle" x="3784.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer15_expert1 -->
<g id="node1815" class="node">
<title>gpu6_layer15_expert1</title>
<polygon fill="lightblue" stroke="black" points="3850,-818.54 3728,-818.54 3728,-766.54 3850,-766.54 3850,-818.54"/>
<text text-anchor="middle" x="3789" y="-806.54" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3789" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3789" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer15_routing&#45;&gt;gpu6_layer15_expert1 -->
<g id="edge2248" class="edge">
<title>gpu6_layer15_routing&#45;&gt;gpu6_layer15_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3863.51,-864.32C3849.48,-851 3835.21,-837.44 3822.97,-825.81"/>
<polygon fill="black" stroke="black" points="3825.29,-823.18 3815.63,-818.83 3820.46,-828.26 3825.29,-823.18"/>
<text text-anchor="middle" x="3871.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer15_expert2 -->
<g id="node1816" class="node">
<title>gpu6_layer15_expert2</title>
<polygon fill="lightblue" stroke="black" points="3990,-818.54 3868,-818.54 3868,-766.54 3990,-766.54 3990,-818.54"/>
<text text-anchor="middle" x="3929" y="-806.54" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3929" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3929" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer15_routing&#45;&gt;gpu6_layer15_expert2 -->
<g id="edge2249" class="edge">
<title>gpu6_layer15_routing&#45;&gt;gpu6_layer15_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3929,-864.32C3929,-852.25 3929,-840 3929,-829.15"/>
<polygon fill="black" stroke="black" points="3932.5,-828.83 3929,-818.83 3925.5,-828.83 3932.5,-828.83"/>
<text text-anchor="middle" x="3958.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer15_expert3 -->
<g id="node1817" class="node">
<title>gpu6_layer15_expert3</title>
<polygon fill="lightblue" stroke="black" points="4130,-818.54 4008,-818.54 4008,-766.54 4130,-766.54 4130,-818.54"/>
<text text-anchor="middle" x="4069" y="-806.54" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4069" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4069" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer15_routing&#45;&gt;gpu6_layer15_expert3 -->
<g id="edge2250" class="edge">
<title>gpu6_layer15_routing&#45;&gt;gpu6_layer15_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3994.49,-864.32C4008.52,-851 4022.79,-837.44 4035.03,-825.81"/>
<polygon fill="black" stroke="black" points="4037.54,-828.26 4042.37,-818.83 4032.71,-823.18 4037.54,-828.26"/>
<text text-anchor="middle" x="4052.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu6_layer15_expert_agg -->
<g id="node1818" class="node">
<title>gpu6_layer15_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="3982.47,-729.54 3781.29,-729.54 3729.53,-625.54 3930.71,-625.54 3982.47,-729.54"/>
<text text-anchor="middle" x="3856" y="-691.54" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3856" y="-680.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3856" y="-669.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3856" y="-658.54" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer15_routing&#45;&gt;gpu6_layer15_expert_agg -->
<g id="edge2265" class="edge">
<title>gpu6_layer15_routing&#45;&gt;gpu6_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M4018.07,-899.26C4093.02,-871.54 4181.67,-824.49 4139,-766.54 4118.94,-739.29 4044.78,-716.81 3977.42,-701.39"/>
<polygon fill="black" stroke="black" points="3978.06,-697.95 3967.54,-699.17 3976.52,-704.78 3978.06,-697.95"/>
</g>
<!-- gpu6_layer15_expert0&#45;&gt;gpu6_layer15_expert_agg -->
<g id="edge2261" class="edge">
<title>gpu6_layer15_expert0&#45;&gt;gpu6_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M3694.94,-766.46C3716.57,-754.65 3743.12,-740.16 3768.37,-726.38"/>
<polygon fill="black" stroke="black" points="3770.14,-729.4 3777.24,-721.53 3766.78,-723.25 3770.14,-729.4"/>
</g>
<!-- gpu6_layer15_expert1&#45;&gt;gpu6_layer15_expert_agg -->
<g id="edge2262" class="edge">
<title>gpu6_layer15_expert1&#45;&gt;gpu6_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M3803.87,-766.46C3808.82,-758.11 3814.56,-748.42 3820.4,-738.59"/>
<polygon fill="black" stroke="black" points="3823.43,-740.33 3825.52,-729.94 3817.41,-736.76 3823.43,-740.33"/>
</g>
<!-- gpu6_layer15_expert2&#45;&gt;gpu6_layer15_expert_agg -->
<g id="edge2263" class="edge">
<title>gpu6_layer15_expert2&#45;&gt;gpu6_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M3912.8,-766.46C3907.41,-758.11 3901.15,-748.42 3894.79,-738.59"/>
<polygon fill="black" stroke="black" points="3897.57,-736.44 3889.21,-729.94 3891.69,-740.24 3897.57,-736.44"/>
</g>
<!-- gpu6_layer15_expert3&#45;&gt;gpu6_layer15_expert_agg -->
<g id="edge2264" class="edge">
<title>gpu6_layer15_expert3&#45;&gt;gpu6_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M4021.73,-766.46C4003.82,-756.96 3982.63,-745.72 3961.5,-734.51"/>
<polygon fill="black" stroke="black" points="3962.93,-731.31 3952.46,-729.71 3959.65,-737.49 3962.93,-731.31"/>
</g>
<!-- gpu6_layer15_res2 -->
<g id="node1819" class="node">
<title>gpu6_layer15_res2</title>
<polygon fill="lightblue" stroke="black" points="3878,-588.54 3756,-588.54 3756,-536.54 3878,-536.54 3878,-588.54"/>
<text text-anchor="middle" x="3817" y="-576.54" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="3817" y="-565.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3817" y="-554.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3817" y="-543.54" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer15_expert_agg&#45;&gt;gpu6_layer15_res2 -->
<g id="edge2266" class="edge">
<title>gpu6_layer15_expert_agg&#45;&gt;gpu6_layer15_res2</title>
<path fill="none" stroke="black" d="M3838.33,-625.33C3835.17,-616.18 3831.95,-606.84 3828.99,-598.29"/>
<polygon fill="black" stroke="black" points="3832.24,-596.98 3825.67,-588.67 3825.63,-599.26 3832.24,-596.98"/>
</g>
<!-- gpu6_final_ln -->
<g id="node1820" class="node">
<title>gpu6_final_ln</title>
<polygon fill="lightblue" stroke="black" points="3638,-499.54 3516,-499.54 3516,-447.54 3638,-447.54 3638,-499.54"/>
<text text-anchor="middle" x="3577" y="-487.54" font-family="Arial" font-size="10.00">Final LayerNorm</text>
<text text-anchor="middle" x="3577" y="-476.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3577" y="-465.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3577" y="-454.54" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_layer15_res2&#45;&gt;gpu6_final_ln -->
<g id="edge2267" class="edge">
<title>gpu6_layer15_res2&#45;&gt;gpu6_final_ln</title>
<path fill="none" stroke="black" d="M3755.82,-539.36C3722.81,-527.4 3681.92,-512.57 3647.57,-500.12"/>
<polygon fill="black" stroke="black" points="3648.67,-496.8 3638.07,-496.68 3646.28,-503.38 3648.67,-496.8"/>
</g>
<!-- gpu6_output_proj -->
<g id="node1821" class="node">
<title>gpu6_output_proj</title>
<polygon fill="lightblue" stroke="black" points="3076,-410.54 2948,-410.54 2948,-358.54 3076,-358.54 3076,-410.54"/>
<text text-anchor="middle" x="3012" y="-398.54" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="3012" y="-387.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3012" y="-376.54" font-family="Arial" font-size="10.00">Output: [256, 512, 32000]</text>
<text text-anchor="middle" x="3012" y="-365.54" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_final_ln&#45;&gt;gpu6_output_proj -->
<g id="edge2268" class="edge">
<title>gpu6_final_ln&#45;&gt;gpu6_output_proj</title>
<path fill="none" stroke="black" d="M3516,-463.15C3411.57,-447.07 3198.95,-414.33 3086.14,-396.96"/>
<polygon fill="black" stroke="black" points="3086.62,-393.49 3076.2,-395.43 3085.55,-400.41 3086.62,-393.49"/>
</g>
<!-- gpu6_softmax -->
<g id="node1822" class="node">
<title>gpu6_softmax</title>
<polygon fill="lightblue" stroke="black" points="2977,-321.54 2849,-321.54 2849,-269.54 2977,-269.54 2977,-321.54"/>
<text text-anchor="middle" x="2913" y="-309.54" font-family="Arial" font-size="10.00">Softmax</text>
<text text-anchor="middle" x="2913" y="-298.54" font-family="Arial" font-size="10.00">Input: [256, 512, 32000]</text>
<text text-anchor="middle" x="2913" y="-287.54" font-family="Arial" font-size="10.00">Output: [256, 512, 32000]</text>
<text text-anchor="middle" x="2913" y="-276.54" font-family="Arial" font-size="10.00">GPU: GPU6</text>
</g>
<!-- gpu6_output_proj&#45;&gt;gpu6_softmax -->
<g id="edge2269" class="edge">
<title>gpu6_output_proj&#45;&gt;gpu6_softmax</title>
<path fill="none" stroke="black" d="M2983.37,-358.38C2972.69,-349 2960.44,-338.23 2949.18,-328.33"/>
<polygon fill="black" stroke="black" points="2951.39,-325.62 2941.57,-321.65 2946.77,-330.88 2951.39,-325.62"/>
</g>
<!-- gpu6_softmax&#45;&gt;dp_aggregate -->
<g id="edge2600" class="edge">
<title>gpu6_softmax&#45;&gt;dp_aggregate</title>
<path fill="none" stroke="black" d="M2848.69,-275.92C2840.72,-273.72 2832.68,-271.55 2825,-269.54 2748.98,-249.69 2664.54,-229.3 2592.37,-212.37"/>
<polygon fill="black" stroke="black" points="2592.81,-208.87 2582.27,-210 2591.21,-215.69 2592.81,-208.87"/>
<text text-anchor="middle" x="2774.5" y="-244.34" font-family="Arial" font-size="9.00">GPU 6 output</text>
</g>
<!-- gpu7_layer0_ln1 -->
<g id="node1824" class="node">
<title>gpu7_layer0_ln1</title>
<polygon fill="lightblue" stroke="black" points="2895,-21516.16 2773,-21516.16 2773,-21464.16 2895,-21464.16 2895,-21516.16"/>
<text text-anchor="middle" x="2834" y="-21504.16" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="2834" y="-21493.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2834" y="-21482.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2834" y="-21471.16" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_embed&#45;&gt;gpu7_layer0_ln1 -->
<g id="edge2275" class="edge">
<title>gpu7_embed&#45;&gt;gpu7_layer0_ln1</title>
<path fill="none" stroke="black" d="M2828.31,-21553C2829.08,-21544.7 2829.94,-21535.32 2830.76,-21526.41"/>
<polygon fill="black" stroke="black" points="2834.26,-21526.55 2831.69,-21516.27 2827.29,-21525.91 2834.26,-21526.55"/>
</g>
<!-- gpu7_layer0_qkv -->
<g id="node1825" class="node">
<title>gpu7_layer0_qkv</title>
<polygon fill="lightblue" stroke="black" points="2909,-21427.16 2787,-21427.16 2787,-21375.16 2909,-21375.16 2909,-21427.16"/>
<text text-anchor="middle" x="2848" y="-21415.16" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2848" y="-21404.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="2848" y="-21393.16" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="2848" y="-21382.16" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer0_ln1&#45;&gt;gpu7_layer0_qkv -->
<g id="edge2276" class="edge">
<title>gpu7_layer0_ln1&#45;&gt;gpu7_layer0_qkv</title>
<path fill="none" stroke="black" d="M2838.05,-21464C2839.38,-21455.7 2840.89,-21446.32 2842.33,-21437.41"/>
<polygon fill="black" stroke="black" points="2845.83,-21437.7 2843.96,-21427.27 2838.92,-21436.59 2845.83,-21437.7"/>
</g>
<!-- gpu7_layer0_reshape -->
<g id="node1826" class="node">
<title>gpu7_layer0_reshape</title>
<polygon fill="lightblue" stroke="black" points="2935,-21338.16 2807,-21338.16 2807,-21286.16 2935,-21286.16 2935,-21338.16"/>
<text text-anchor="middle" x="2871" y="-21326.16" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="2871" y="-21315.16" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="2871" y="-21304.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2871" y="-21293.16" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer0_qkv&#45;&gt;gpu7_layer0_reshape -->
<g id="edge2277" class="edge">
<title>gpu7_layer0_qkv&#45;&gt;gpu7_layer0_reshape</title>
<path fill="none" stroke="black" d="M2854.65,-21375C2856.87,-21366.61 2859.38,-21357.12 2861.76,-21348.12"/>
<polygon fill="black" stroke="black" points="2865.19,-21348.83 2864.36,-21338.27 2858.42,-21347.05 2865.19,-21348.83"/>
</g>
<!-- gpu7_layer0_attn -->
<g id="node1827" class="node">
<title>gpu7_layer0_attn</title>
<polygon fill="lightblue" stroke="black" points="3005,-21249.16 2877,-21249.16 2877,-21197.16 3005,-21197.16 3005,-21249.16"/>
<text text-anchor="middle" x="2941" y="-21237.16" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2941" y="-21226.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2941" y="-21215.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2941" y="-21204.16" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer0_reshape&#45;&gt;gpu7_layer0_attn -->
<g id="edge2278" class="edge">
<title>gpu7_layer0_reshape&#45;&gt;gpu7_layer0_attn</title>
<path fill="none" stroke="black" d="M2891.25,-21286C2898.5,-21276.98 2906.79,-21266.68 2914.5,-21257.1"/>
<polygon fill="black" stroke="black" points="2917.26,-21259.26 2920.8,-21249.27 2911.8,-21254.87 2917.26,-21259.26"/>
</g>
<!-- gpu7_layer0_attn_reshape -->
<g id="node1829" class="node">
<title>gpu7_layer0_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="3003,-21160.16 2881,-21160.16 2881,-21108.16 3003,-21108.16 3003,-21160.16"/>
<text text-anchor="middle" x="2942" y="-21148.16" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="2942" y="-21137.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="2942" y="-21126.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="2942" y="-21115.16" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer0_attn&#45;&gt;gpu7_layer0_attn_reshape -->
<g id="edge2279" class="edge">
<title>gpu7_layer0_attn&#45;&gt;gpu7_layer0_attn_reshape</title>
<path fill="none" stroke="black" d="M2941.29,-21197C2941.38,-21188.7 2941.49,-21179.32 2941.59,-21170.41"/>
<polygon fill="black" stroke="black" points="2945.1,-21170.31 2941.71,-21160.27 2938.1,-21170.23 2945.1,-21170.31"/>
</g>
<!-- gpu7_layer0_attn_out -->
<g id="node1828" class="node">
<title>gpu7_layer0_attn_out</title>
<polygon fill="lightblue" stroke="black" points="3117,-21071.16 2995,-21071.16 2995,-21019.16 3117,-21019.16 3117,-21071.16"/>
<text text-anchor="middle" x="3056" y="-21059.16" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="3056" y="-21048.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="3056" y="-21037.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3056" y="-21026.16" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer0_kv_update -->
<g id="node1830" class="node">
<title>gpu7_layer0_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="3303" cy="-20945.4" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="3303" y="-20959.4" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="3303" y="-20948.4" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3303" y="-20937.4" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3303" y="-20926.4" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer0_attn_out&#45;&gt;gpu7_layer0_kv_update -->
<g id="edge2281" class="edge">
<title>gpu7_layer0_attn_out&#45;&gt;gpu7_layer0_kv_update</title>
<path fill="none" stroke="black" d="M3117.06,-21020C3151.68,-21006.29 3195.18,-20989.07 3231.41,-20974.73"/>
<polygon fill="black" stroke="black" points="3232.92,-20977.9 3240.93,-20970.96 3230.34,-20971.39 3232.92,-20977.9"/>
</g>
<!-- gpu7_layer0_attn_reshape&#45;&gt;gpu7_layer0_attn_out -->
<g id="edge2280" class="edge">
<title>gpu7_layer0_attn_reshape&#45;&gt;gpu7_layer0_attn_out</title>
<path fill="none" stroke="black" d="M2974.97,-21108C2987.5,-21098.44 3001.92,-21087.44 3015.09,-21077.39"/>
<polygon fill="black" stroke="black" points="3017.27,-21080.12 3023.1,-21071.27 3013.03,-21074.56 3017.27,-21080.12"/>
</g>
<!-- gpu7_layer0_res1 -->
<g id="node1831" class="node">
<title>gpu7_layer0_res1</title>
<polygon fill="lightblue" stroke="black" points="3452,-20871.63 3330,-20871.63 3330,-20819.63 3452,-20819.63 3452,-20871.63"/>
<text text-anchor="middle" x="3391" y="-20859.63" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="3391" y="-20848.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3391" y="-20837.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3391" y="-20826.63" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer0_kv_update&#45;&gt;gpu7_layer0_res1 -->
<g id="edge2282" class="edge">
<title>gpu7_layer0_kv_update&#45;&gt;gpu7_layer0_res1</title>
<path fill="none" stroke="black" d="M3333.28,-20910.75C3342.48,-20900.54 3352.55,-20889.34 3361.68,-20879.2"/>
<polygon fill="black" stroke="black" points="3364.36,-20881.46 3368.44,-20871.68 3359.15,-20876.78 3364.36,-20881.46"/>
</g>
<!-- gpu7_layer0_ln2 -->
<g id="node1832" class="node">
<title>gpu7_layer0_ln2</title>
<polygon fill="lightblue" stroke="black" points="3972,-20782.63 3850,-20782.63 3850,-20730.63 3972,-20730.63 3972,-20782.63"/>
<text text-anchor="middle" x="3911" y="-20770.63" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="3911" y="-20759.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3911" y="-20748.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3911" y="-20737.63" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer0_res1&#45;&gt;gpu7_layer0_ln2 -->
<g id="edge2283" class="edge">
<title>gpu7_layer0_res1&#45;&gt;gpu7_layer0_ln2</title>
<path fill="none" stroke="black" d="M3452.18,-20834.39C3548.96,-20818.2 3736.92,-20786.75 3839.67,-20769.56"/>
<polygon fill="black" stroke="black" points="3840.37,-20772.99 3849.65,-20767.89 3839.21,-20766.09 3840.37,-20772.99"/>
</g>
<!-- gpu7_layer0_routing -->
<g id="node1833" class="node">
<title>gpu7_layer0_routing</title>
<polygon fill="lightyellow" stroke="black" points="4583.47,-20693.63 4382.29,-20693.63 4330.53,-20567.63 4531.71,-20567.63 4583.47,-20693.63"/>
<text text-anchor="middle" x="4457" y="-20650.13" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="4457" y="-20639.13" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4457" y="-20628.13" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4457" y="-20617.13" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="4457" y="-20606.13" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer0_ln2&#45;&gt;gpu7_layer0_routing -->
<g id="edge2284" class="edge">
<title>gpu7_layer0_ln2&#45;&gt;gpu7_layer0_routing</title>
<path fill="none" stroke="black" d="M3972.04,-20741.76C4064.83,-20720.69 4242.44,-20680.35 4355.04,-20654.78"/>
<polygon fill="black" stroke="black" points="4356.08,-20658.13 4365.06,-20652.51 4354.53,-20651.31 4356.08,-20658.13"/>
</g>
<!-- gpu7_layer0_expert0 -->
<g id="node1834" class="node">
<title>gpu7_layer0_expert0</title>
<polygon fill="lightblue" stroke="black" points="4308,-20521.63 4186,-20521.63 4186,-20469.63 4308,-20469.63 4308,-20521.63"/>
<text text-anchor="middle" x="4247" y="-20509.63" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="4247" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer0_routing&#45;&gt;gpu7_layer0_expert0 -->
<g id="edge2271" class="edge">
<title>gpu7_layer0_routing&#45;&gt;gpu7_layer0_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4359.07,-20567.6C4336.82,-20553.51 4314.14,-20539.14 4295.05,-20527.06"/>
<polygon fill="black" stroke="black" points="4296.87,-20524.07 4286.55,-20521.68 4293.13,-20529.98 4296.87,-20524.07"/>
<text text-anchor="middle" x="4356.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer0_expert1 -->
<g id="node1835" class="node">
<title>gpu7_layer0_expert1</title>
<polygon fill="lightblue" stroke="black" points="4448,-20521.63 4326,-20521.63 4326,-20469.63 4448,-20469.63 4448,-20521.63"/>
<text text-anchor="middle" x="4387" y="-20509.63" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="4387" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer0_routing&#45;&gt;gpu7_layer0_expert1 -->
<g id="edge2272" class="edge">
<title>gpu7_layer0_routing&#45;&gt;gpu7_layer0_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4424.25,-20567.41C4417.64,-20554.84 4410.91,-20542.06 4405.03,-20530.89"/>
<polygon fill="black" stroke="black" points="4408.07,-20529.14 4400.31,-20521.92 4401.87,-20532.4 4408.07,-20529.14"/>
<text text-anchor="middle" x="4442.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer0_expert2 -->
<g id="node1836" class="node">
<title>gpu7_layer0_expert2</title>
<polygon fill="lightblue" stroke="black" points="4588,-20521.63 4466,-20521.63 4466,-20469.63 4588,-20469.63 4588,-20521.63"/>
<text text-anchor="middle" x="4527" y="-20509.63" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="4527" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer0_routing&#45;&gt;gpu7_layer0_expert2 -->
<g id="edge2273" class="edge">
<title>gpu7_layer0_routing&#45;&gt;gpu7_layer0_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4489.75,-20567.41C4496.36,-20554.84 4503.09,-20542.06 4508.97,-20530.89"/>
<polygon fill="black" stroke="black" points="4512.13,-20532.4 4513.69,-20521.92 4505.93,-20529.14 4512.13,-20532.4"/>
<text text-anchor="middle" x="4533.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer0_expert3 -->
<g id="node1837" class="node">
<title>gpu7_layer0_expert3</title>
<polygon fill="lightblue" stroke="black" points="4728,-20521.63 4606,-20521.63 4606,-20469.63 4728,-20469.63 4728,-20521.63"/>
<text text-anchor="middle" x="4667" y="-20509.63" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4667" y="-20498.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-20487.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-20476.63" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer0_routing&#45;&gt;gpu7_layer0_expert3 -->
<g id="edge2274" class="edge">
<title>gpu7_layer0_routing&#45;&gt;gpu7_layer0_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4536.69,-20579.15C4564.28,-20561.68 4594.35,-20542.63 4618.65,-20527.25"/>
<polygon fill="black" stroke="black" points="4620.75,-20530.06 4627.32,-20521.75 4617,-20524.15 4620.75,-20530.06"/>
<text text-anchor="middle" x="4628.5" y="-20542.43" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer0_expert_agg -->
<g id="node1838" class="node">
<title>gpu7_layer0_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-20432.63 4452.29,-20432.63 4400.53,-20328.63 4601.71,-20328.63 4653.47,-20432.63"/>
<text text-anchor="middle" x="4527" y="-20394.63" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="4527" y="-20383.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-20372.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-20361.63" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer0_routing&#45;&gt;gpu7_layer0_expert_agg -->
<g id="edge2289" class="edge">
<title>gpu7_layer0_routing&#45;&gt;gpu7_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M4553.32,-20619.99C4617,-20608.05 4696.03,-20581.34 4737,-20521.63 4769.19,-20474.71 4714.71,-20439.38 4653.19,-20415.94"/>
<polygon fill="black" stroke="black" points="4654.27,-20412.6 4643.68,-20412.42 4651.84,-20419.17 4654.27,-20412.6"/>
</g>
<!-- gpu7_layer0_expert0&#45;&gt;gpu7_layer0_expert_agg -->
<g id="edge2285" class="edge">
<title>gpu7_layer0_expert0&#45;&gt;gpu7_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M4308.1,-20469.97C4344.98,-20455.08 4392.7,-20435.83 4434.16,-20419.09"/>
<polygon fill="black" stroke="black" points="4435.5,-20422.33 4443.46,-20415.34 4432.88,-20415.84 4435.5,-20422.33"/>
</g>
<!-- gpu7_layer0_expert1&#45;&gt;gpu7_layer0_expert_agg -->
<g id="edge2286" class="edge">
<title>gpu7_layer0_expert1&#45;&gt;gpu7_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M4418.07,-20469.55C4429.32,-20460.47 4442.53,-20449.81 4455.8,-20439.1"/>
<polygon fill="black" stroke="black" points="4458.02,-20441.8 4463.6,-20432.8 4453.62,-20436.35 4458.02,-20441.8"/>
</g>
<!-- gpu7_layer0_expert2&#45;&gt;gpu7_layer0_expert_agg -->
<g id="edge2287" class="edge">
<title>gpu7_layer0_expert2&#45;&gt;gpu7_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M4527,-20469.55C4527,-20461.62 4527,-20452.48 4527,-20443.16"/>
<polygon fill="black" stroke="black" points="4530.5,-20443.03 4527,-20433.03 4523.5,-20443.03 4530.5,-20443.03"/>
</g>
<!-- gpu7_layer0_expert3&#45;&gt;gpu7_layer0_expert_agg -->
<g id="edge2288" class="edge">
<title>gpu7_layer0_expert3&#45;&gt;gpu7_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M4635.93,-20469.55C4624.68,-20460.47 4611.47,-20449.81 4598.2,-20439.1"/>
<polygon fill="black" stroke="black" points="4600.38,-20436.35 4590.4,-20432.8 4595.98,-20441.8 4600.38,-20436.35"/>
</g>
<!-- gpu7_layer0_res2 -->
<g id="node1839" class="node">
<title>gpu7_layer0_res2</title>
<polygon fill="lightblue" stroke="black" points="4588,-20291.63 4466,-20291.63 4466,-20239.63 4588,-20239.63 4588,-20291.63"/>
<text text-anchor="middle" x="4527" y="-20279.63" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="4527" y="-20268.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-20257.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-20246.63" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer0_expert_agg&#45;&gt;gpu7_layer0_res2 -->
<g id="edge2290" class="edge">
<title>gpu7_layer0_expert_agg&#45;&gt;gpu7_layer0_res2</title>
<path fill="none" stroke="black" d="M4527,-20328.42C4527,-20319.46 4527,-20310.34 4527,-20301.94"/>
<polygon fill="black" stroke="black" points="4530.5,-20301.76 4527,-20291.76 4523.5,-20301.76 4530.5,-20301.76"/>
</g>
<!-- gpu7_layer1_ln1 -->
<g id="node1840" class="node">
<title>gpu7_layer1_ln1</title>
<polygon fill="lightblue" stroke="black" points="4588,-20202.63 4466,-20202.63 4466,-20150.63 4588,-20150.63 4588,-20202.63"/>
<text text-anchor="middle" x="4527" y="-20190.63" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="4527" y="-20179.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-20168.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-20157.63" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer0_res2&#45;&gt;gpu7_layer1_ln1 -->
<g id="edge2295" class="edge">
<title>gpu7_layer0_res2&#45;&gt;gpu7_layer1_ln1</title>
<path fill="none" stroke="black" d="M4527,-20239.46C4527,-20231.17 4527,-20221.78 4527,-20212.87"/>
<polygon fill="black" stroke="black" points="4530.5,-20212.73 4527,-20202.73 4523.5,-20212.73 4530.5,-20212.73"/>
</g>
<!-- gpu7_layer1_qkv -->
<g id="node1841" class="node">
<title>gpu7_layer1_qkv</title>
<polygon fill="lightblue" stroke="black" points="4588,-20113.63 4466,-20113.63 4466,-20061.63 4588,-20061.63 4588,-20113.63"/>
<text text-anchor="middle" x="4527" y="-20101.63" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4527" y="-20090.63" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-20079.63" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-20068.63" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer1_ln1&#45;&gt;gpu7_layer1_qkv -->
<g id="edge2296" class="edge">
<title>gpu7_layer1_ln1&#45;&gt;gpu7_layer1_qkv</title>
<path fill="none" stroke="black" d="M4527,-20150.46C4527,-20142.17 4527,-20132.78 4527,-20123.87"/>
<polygon fill="black" stroke="black" points="4530.5,-20123.73 4527,-20113.73 4523.5,-20123.73 4530.5,-20123.73"/>
</g>
<!-- gpu7_layer1_reshape -->
<g id="node1842" class="node">
<title>gpu7_layer1_reshape</title>
<polygon fill="lightblue" stroke="black" points="4591,-20024.63 4463,-20024.63 4463,-19972.63 4591,-19972.63 4591,-20024.63"/>
<text text-anchor="middle" x="4527" y="-20012.63" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="4527" y="-20001.63" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-19990.63" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-19979.63" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer1_qkv&#45;&gt;gpu7_layer1_reshape -->
<g id="edge2297" class="edge">
<title>gpu7_layer1_qkv&#45;&gt;gpu7_layer1_reshape</title>
<path fill="none" stroke="black" d="M4527,-20061.46C4527,-20053.17 4527,-20043.78 4527,-20034.87"/>
<polygon fill="black" stroke="black" points="4530.5,-20034.73 4527,-20024.73 4523.5,-20034.73 4530.5,-20034.73"/>
</g>
<!-- gpu7_layer1_attn -->
<g id="node1843" class="node">
<title>gpu7_layer1_attn</title>
<polygon fill="lightblue" stroke="black" points="4591,-19935.63 4463,-19935.63 4463,-19883.63 4591,-19883.63 4591,-19935.63"/>
<text text-anchor="middle" x="4527" y="-19923.63" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="4527" y="-19912.63" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-19901.63" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-19890.63" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer1_reshape&#45;&gt;gpu7_layer1_attn -->
<g id="edge2298" class="edge">
<title>gpu7_layer1_reshape&#45;&gt;gpu7_layer1_attn</title>
<path fill="none" stroke="black" d="M4527,-19972.46C4527,-19964.17 4527,-19954.78 4527,-19945.87"/>
<polygon fill="black" stroke="black" points="4530.5,-19945.73 4527,-19935.73 4523.5,-19945.73 4530.5,-19945.73"/>
</g>
<!-- gpu7_layer1_attn_reshape -->
<g id="node1845" class="node">
<title>gpu7_layer1_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="4588,-19846.63 4466,-19846.63 4466,-19794.63 4588,-19794.63 4588,-19846.63"/>
<text text-anchor="middle" x="4527" y="-19834.63" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="4527" y="-19823.63" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-19812.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-19801.63" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer1_attn&#45;&gt;gpu7_layer1_attn_reshape -->
<g id="edge2299" class="edge">
<title>gpu7_layer1_attn&#45;&gt;gpu7_layer1_attn_reshape</title>
<path fill="none" stroke="black" d="M4527,-19883.46C4527,-19875.17 4527,-19865.78 4527,-19856.87"/>
<polygon fill="black" stroke="black" points="4530.5,-19856.73 4527,-19846.73 4523.5,-19856.73 4530.5,-19856.73"/>
</g>
<!-- gpu7_layer1_attn_out -->
<g id="node1844" class="node">
<title>gpu7_layer1_attn_out</title>
<polygon fill="lightblue" stroke="black" points="4588,-19757.63 4466,-19757.63 4466,-19705.63 4588,-19705.63 4588,-19757.63"/>
<text text-anchor="middle" x="4527" y="-19745.63" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="4527" y="-19734.63" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-19723.63" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-19712.63" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer1_kv_update -->
<g id="node1846" class="node">
<title>gpu7_layer1_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="4527" cy="-19631.86" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="4527" y="-19645.86" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="4527" y="-19634.86" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-19623.86" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-19612.86" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer1_attn_out&#45;&gt;gpu7_layer1_kv_update -->
<g id="edge2301" class="edge">
<title>gpu7_layer1_attn_out&#45;&gt;gpu7_layer1_kv_update</title>
<path fill="none" stroke="black" d="M4527,-19705.45C4527,-19697.31 4527,-19688.01 4527,-19678.85"/>
<polygon fill="black" stroke="black" points="4530.5,-19678.64 4527,-19668.64 4523.5,-19678.64 4530.5,-19678.64"/>
</g>
<!-- gpu7_layer1_attn_reshape&#45;&gt;gpu7_layer1_attn_out -->
<g id="edge2300" class="edge">
<title>gpu7_layer1_attn_reshape&#45;&gt;gpu7_layer1_attn_out</title>
<path fill="none" stroke="black" d="M4527,-19794.46C4527,-19786.17 4527,-19776.78 4527,-19767.87"/>
<polygon fill="black" stroke="black" points="4530.5,-19767.73 4527,-19757.73 4523.5,-19767.73 4530.5,-19767.73"/>
</g>
<!-- gpu7_layer1_res1 -->
<g id="node1847" class="node">
<title>gpu7_layer1_res1</title>
<polygon fill="lightblue" stroke="black" points="4588,-19558.09 4466,-19558.09 4466,-19506.09 4588,-19506.09 4588,-19558.09"/>
<text text-anchor="middle" x="4527" y="-19546.09" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="4527" y="-19535.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-19524.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-19513.09" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer1_kv_update&#45;&gt;gpu7_layer1_res1 -->
<g id="edge2302" class="edge">
<title>gpu7_layer1_kv_update&#45;&gt;gpu7_layer1_res1</title>
<path fill="none" stroke="black" d="M4527,-19595.01C4527,-19586.33 4527,-19577.06 4527,-19568.4"/>
<polygon fill="black" stroke="black" points="4530.5,-19568.23 4527,-19558.23 4523.5,-19568.23 4530.5,-19568.23"/>
</g>
<!-- gpu7_layer1_ln2 -->
<g id="node1848" class="node">
<title>gpu7_layer1_ln2</title>
<polygon fill="lightblue" stroke="black" points="4588,-19469.09 4466,-19469.09 4466,-19417.09 4588,-19417.09 4588,-19469.09"/>
<text text-anchor="middle" x="4527" y="-19457.09" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="4527" y="-19446.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-19435.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-19424.09" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer1_res1&#45;&gt;gpu7_layer1_ln2 -->
<g id="edge2303" class="edge">
<title>gpu7_layer1_res1&#45;&gt;gpu7_layer1_ln2</title>
<path fill="none" stroke="black" d="M4527,-19505.92C4527,-19497.63 4527,-19488.24 4527,-19479.34"/>
<polygon fill="black" stroke="black" points="4530.5,-19479.19 4527,-19469.19 4523.5,-19479.19 4530.5,-19479.19"/>
</g>
<!-- gpu7_layer1_routing -->
<g id="node1849" class="node">
<title>gpu7_layer1_routing</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-19380.09 4452.29,-19380.09 4400.53,-19254.09 4601.71,-19254.09 4653.47,-19380.09"/>
<text text-anchor="middle" x="4527" y="-19336.59" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="4527" y="-19325.59" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-19314.59" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-19303.59" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="4527" y="-19292.59" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer1_ln2&#45;&gt;gpu7_layer1_routing -->
<g id="edge2304" class="edge">
<title>gpu7_layer1_ln2&#45;&gt;gpu7_layer1_routing</title>
<path fill="none" stroke="black" d="M4527,-19416.99C4527,-19409.06 4527,-19399.86 4527,-19390.33"/>
<polygon fill="black" stroke="black" points="4530.5,-19390.32 4527,-19380.32 4523.5,-19390.32 4530.5,-19390.32"/>
</g>
<!-- gpu7_layer1_expert0 -->
<g id="node1850" class="node">
<title>gpu7_layer1_expert0</title>
<polygon fill="lightblue" stroke="black" points="4308,-19208.09 4186,-19208.09 4186,-19156.09 4308,-19156.09 4308,-19208.09"/>
<text text-anchor="middle" x="4247" y="-19196.09" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="4247" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer1_routing&#45;&gt;gpu7_layer1_expert0 -->
<g id="edge2291" class="edge">
<title>gpu7_layer1_routing&#45;&gt;gpu7_layer1_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4401.33,-19256.39C4369.34,-19241.2 4336.34,-19225.52 4309.11,-19212.59"/>
<polygon fill="black" stroke="black" points="4310.26,-19209.26 4299.73,-19208.13 4307.26,-19215.58 4310.26,-19209.26"/>
<text text-anchor="middle" x="4382.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer1_expert1 -->
<g id="node1851" class="node">
<title>gpu7_layer1_expert1</title>
<polygon fill="lightblue" stroke="black" points="4448,-19208.09 4326,-19208.09 4326,-19156.09 4448,-19156.09 4448,-19208.09"/>
<text text-anchor="middle" x="4387" y="-19196.09" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="4387" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer1_routing&#45;&gt;gpu7_layer1_expert1 -->
<g id="edge2292" class="edge">
<title>gpu7_layer1_routing&#45;&gt;gpu7_layer1_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4461.51,-19253.87C4447.48,-19240.55 4433.21,-19226.99 4420.97,-19215.36"/>
<polygon fill="black" stroke="black" points="4423.29,-19212.73 4413.63,-19208.38 4418.46,-19217.81 4423.29,-19212.73"/>
<text text-anchor="middle" x="4469.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer1_expert2 -->
<g id="node1852" class="node">
<title>gpu7_layer1_expert2</title>
<polygon fill="lightblue" stroke="black" points="4588,-19208.09 4466,-19208.09 4466,-19156.09 4588,-19156.09 4588,-19208.09"/>
<text text-anchor="middle" x="4527" y="-19196.09" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="4527" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer1_routing&#45;&gt;gpu7_layer1_expert2 -->
<g id="edge2293" class="edge">
<title>gpu7_layer1_routing&#45;&gt;gpu7_layer1_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4527,-19253.87C4527,-19241.8 4527,-19229.55 4527,-19218.7"/>
<polygon fill="black" stroke="black" points="4530.5,-19218.38 4527,-19208.38 4523.5,-19218.38 4530.5,-19218.38"/>
<text text-anchor="middle" x="4556.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer1_expert3 -->
<g id="node1853" class="node">
<title>gpu7_layer1_expert3</title>
<polygon fill="lightblue" stroke="black" points="4728,-19208.09 4606,-19208.09 4606,-19156.09 4728,-19156.09 4728,-19208.09"/>
<text text-anchor="middle" x="4667" y="-19196.09" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4667" y="-19185.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-19174.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-19163.09" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer1_routing&#45;&gt;gpu7_layer1_expert3 -->
<g id="edge2294" class="edge">
<title>gpu7_layer1_routing&#45;&gt;gpu7_layer1_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4592.49,-19253.87C4606.52,-19240.55 4620.79,-19226.99 4633.03,-19215.36"/>
<polygon fill="black" stroke="black" points="4635.54,-19217.81 4640.37,-19208.38 4630.71,-19212.73 4635.54,-19217.81"/>
<text text-anchor="middle" x="4650.5" y="-19228.89" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer1_expert_agg -->
<g id="node1854" class="node">
<title>gpu7_layer1_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-19119.09 4452.29,-19119.09 4400.53,-19015.09 4601.71,-19015.09 4653.47,-19119.09"/>
<text text-anchor="middle" x="4527" y="-19081.09" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="4527" y="-19070.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-19059.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-19048.09" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer1_routing&#45;&gt;gpu7_layer1_expert_agg -->
<g id="edge2309" class="edge">
<title>gpu7_layer1_routing&#45;&gt;gpu7_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M4616.22,-19289.17C4689.96,-19262.01 4776.6,-19215.62 4737,-19156.09 4716.44,-19125.17 4682.7,-19105.1 4648.22,-19092.07"/>
<polygon fill="black" stroke="black" points="4649.08,-19088.66 4638.48,-19088.58 4646.71,-19095.25 4649.08,-19088.66"/>
</g>
<!-- gpu7_layer1_expert0&#45;&gt;gpu7_layer1_expert_agg -->
<g id="edge2305" class="edge">
<title>gpu7_layer1_expert0&#45;&gt;gpu7_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M4308.1,-19156.43C4344.98,-19141.55 4392.7,-19122.29 4434.16,-19105.55"/>
<polygon fill="black" stroke="black" points="4435.5,-19108.79 4443.46,-19101.8 4432.88,-19102.3 4435.5,-19108.79"/>
</g>
<!-- gpu7_layer1_expert1&#45;&gt;gpu7_layer1_expert_agg -->
<g id="edge2306" class="edge">
<title>gpu7_layer1_expert1&#45;&gt;gpu7_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M4418.07,-19156.01C4429.32,-19146.93 4442.53,-19136.27 4455.8,-19125.56"/>
<polygon fill="black" stroke="black" points="4458.02,-19128.26 4463.6,-19119.26 4453.62,-19122.82 4458.02,-19128.26"/>
</g>
<!-- gpu7_layer1_expert2&#45;&gt;gpu7_layer1_expert_agg -->
<g id="edge2307" class="edge">
<title>gpu7_layer1_expert2&#45;&gt;gpu7_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M4527,-19156.01C4527,-19148.08 4527,-19138.95 4527,-19129.62"/>
<polygon fill="black" stroke="black" points="4530.5,-19129.49 4527,-19119.49 4523.5,-19129.49 4530.5,-19129.49"/>
</g>
<!-- gpu7_layer1_expert3&#45;&gt;gpu7_layer1_expert_agg -->
<g id="edge2308" class="edge">
<title>gpu7_layer1_expert3&#45;&gt;gpu7_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M4635.93,-19156.01C4624.68,-19146.93 4611.47,-19136.27 4598.2,-19125.56"/>
<polygon fill="black" stroke="black" points="4600.38,-19122.82 4590.4,-19119.26 4595.98,-19128.26 4600.38,-19122.82"/>
</g>
<!-- gpu7_layer1_res2 -->
<g id="node1855" class="node">
<title>gpu7_layer1_res2</title>
<polygon fill="lightblue" stroke="black" points="4588,-18978.09 4466,-18978.09 4466,-18926.09 4588,-18926.09 4588,-18978.09"/>
<text text-anchor="middle" x="4527" y="-18966.09" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="4527" y="-18955.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-18944.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-18933.09" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer1_expert_agg&#45;&gt;gpu7_layer1_res2 -->
<g id="edge2310" class="edge">
<title>gpu7_layer1_expert_agg&#45;&gt;gpu7_layer1_res2</title>
<path fill="none" stroke="black" d="M4527,-19014.88C4527,-19005.93 4527,-18996.8 4527,-18988.4"/>
<polygon fill="black" stroke="black" points="4530.5,-18988.22 4527,-18978.22 4523.5,-18988.22 4530.5,-18988.22"/>
</g>
<!-- gpu7_layer2_ln1 -->
<g id="node1856" class="node">
<title>gpu7_layer2_ln1</title>
<polygon fill="lightblue" stroke="black" points="4588,-18889.09 4466,-18889.09 4466,-18837.09 4588,-18837.09 4588,-18889.09"/>
<text text-anchor="middle" x="4527" y="-18877.09" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="4527" y="-18866.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-18855.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-18844.09" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer1_res2&#45;&gt;gpu7_layer2_ln1 -->
<g id="edge2315" class="edge">
<title>gpu7_layer1_res2&#45;&gt;gpu7_layer2_ln1</title>
<path fill="none" stroke="black" d="M4527,-18925.92C4527,-18917.63 4527,-18908.24 4527,-18899.34"/>
<polygon fill="black" stroke="black" points="4530.5,-18899.19 4527,-18889.19 4523.5,-18899.19 4530.5,-18899.19"/>
</g>
<!-- gpu7_layer2_qkv -->
<g id="node1857" class="node">
<title>gpu7_layer2_qkv</title>
<polygon fill="lightblue" stroke="black" points="4588,-18800.09 4466,-18800.09 4466,-18748.09 4588,-18748.09 4588,-18800.09"/>
<text text-anchor="middle" x="4527" y="-18788.09" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4527" y="-18777.09" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-18766.09" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-18755.09" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer2_ln1&#45;&gt;gpu7_layer2_qkv -->
<g id="edge2316" class="edge">
<title>gpu7_layer2_ln1&#45;&gt;gpu7_layer2_qkv</title>
<path fill="none" stroke="black" d="M4527,-18836.92C4527,-18828.63 4527,-18819.24 4527,-18810.34"/>
<polygon fill="black" stroke="black" points="4530.5,-18810.19 4527,-18800.19 4523.5,-18810.19 4530.5,-18810.19"/>
</g>
<!-- gpu7_layer2_reshape -->
<g id="node1858" class="node">
<title>gpu7_layer2_reshape</title>
<polygon fill="lightblue" stroke="black" points="4591,-18711.09 4463,-18711.09 4463,-18659.09 4591,-18659.09 4591,-18711.09"/>
<text text-anchor="middle" x="4527" y="-18699.09" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="4527" y="-18688.09" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-18677.09" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-18666.09" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer2_qkv&#45;&gt;gpu7_layer2_reshape -->
<g id="edge2317" class="edge">
<title>gpu7_layer2_qkv&#45;&gt;gpu7_layer2_reshape</title>
<path fill="none" stroke="black" d="M4527,-18747.92C4527,-18739.63 4527,-18730.24 4527,-18721.34"/>
<polygon fill="black" stroke="black" points="4530.5,-18721.19 4527,-18711.19 4523.5,-18721.19 4530.5,-18721.19"/>
</g>
<!-- gpu7_layer2_attn -->
<g id="node1859" class="node">
<title>gpu7_layer2_attn</title>
<polygon fill="lightblue" stroke="black" points="4591,-18622.09 4463,-18622.09 4463,-18570.09 4591,-18570.09 4591,-18622.09"/>
<text text-anchor="middle" x="4527" y="-18610.09" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="4527" y="-18599.09" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-18588.09" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-18577.09" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer2_reshape&#45;&gt;gpu7_layer2_attn -->
<g id="edge2318" class="edge">
<title>gpu7_layer2_reshape&#45;&gt;gpu7_layer2_attn</title>
<path fill="none" stroke="black" d="M4527,-18658.92C4527,-18650.63 4527,-18641.24 4527,-18632.34"/>
<polygon fill="black" stroke="black" points="4530.5,-18632.19 4527,-18622.19 4523.5,-18632.19 4530.5,-18632.19"/>
</g>
<!-- gpu7_layer2_attn_reshape -->
<g id="node1861" class="node">
<title>gpu7_layer2_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="4588,-18533.09 4466,-18533.09 4466,-18481.09 4588,-18481.09 4588,-18533.09"/>
<text text-anchor="middle" x="4527" y="-18521.09" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="4527" y="-18510.09" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-18499.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-18488.09" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer2_attn&#45;&gt;gpu7_layer2_attn_reshape -->
<g id="edge2319" class="edge">
<title>gpu7_layer2_attn&#45;&gt;gpu7_layer2_attn_reshape</title>
<path fill="none" stroke="black" d="M4527,-18569.92C4527,-18561.63 4527,-18552.24 4527,-18543.34"/>
<polygon fill="black" stroke="black" points="4530.5,-18543.19 4527,-18533.19 4523.5,-18543.19 4530.5,-18543.19"/>
</g>
<!-- gpu7_layer2_attn_out -->
<g id="node1860" class="node">
<title>gpu7_layer2_attn_out</title>
<polygon fill="lightblue" stroke="black" points="4588,-18444.09 4466,-18444.09 4466,-18392.09 4588,-18392.09 4588,-18444.09"/>
<text text-anchor="middle" x="4527" y="-18432.09" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="4527" y="-18421.09" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-18410.09" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-18399.09" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer2_kv_update -->
<g id="node1862" class="node">
<title>gpu7_layer2_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="4527" cy="-18318.32" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="4527" y="-18332.32" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="4527" y="-18321.32" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-18310.32" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-18299.32" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer2_attn_out&#45;&gt;gpu7_layer2_kv_update -->
<g id="edge2321" class="edge">
<title>gpu7_layer2_attn_out&#45;&gt;gpu7_layer2_kv_update</title>
<path fill="none" stroke="black" d="M4527,-18391.91C4527,-18383.77 4527,-18374.47 4527,-18365.31"/>
<polygon fill="black" stroke="black" points="4530.5,-18365.1 4527,-18355.1 4523.5,-18365.1 4530.5,-18365.1"/>
</g>
<!-- gpu7_layer2_attn_reshape&#45;&gt;gpu7_layer2_attn_out -->
<g id="edge2320" class="edge">
<title>gpu7_layer2_attn_reshape&#45;&gt;gpu7_layer2_attn_out</title>
<path fill="none" stroke="black" d="M4527,-18480.92C4527,-18472.63 4527,-18463.24 4527,-18454.34"/>
<polygon fill="black" stroke="black" points="4530.5,-18454.19 4527,-18444.19 4523.5,-18454.19 4530.5,-18454.19"/>
</g>
<!-- gpu7_layer2_res1 -->
<g id="node1863" class="node">
<title>gpu7_layer2_res1</title>
<polygon fill="lightblue" stroke="black" points="4588,-18244.55 4466,-18244.55 4466,-18192.55 4588,-18192.55 4588,-18244.55"/>
<text text-anchor="middle" x="4527" y="-18232.55" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="4527" y="-18221.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-18210.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-18199.55" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer2_kv_update&#45;&gt;gpu7_layer2_res1 -->
<g id="edge2322" class="edge">
<title>gpu7_layer2_kv_update&#45;&gt;gpu7_layer2_res1</title>
<path fill="none" stroke="black" d="M4527,-18281.47C4527,-18272.79 4527,-18263.52 4527,-18254.86"/>
<polygon fill="black" stroke="black" points="4530.5,-18254.69 4527,-18244.69 4523.5,-18254.69 4530.5,-18254.69"/>
</g>
<!-- gpu7_layer2_ln2 -->
<g id="node1864" class="node">
<title>gpu7_layer2_ln2</title>
<polygon fill="lightblue" stroke="black" points="4588,-18155.55 4466,-18155.55 4466,-18103.55 4588,-18103.55 4588,-18155.55"/>
<text text-anchor="middle" x="4527" y="-18143.55" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="4527" y="-18132.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-18121.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-18110.55" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer2_res1&#45;&gt;gpu7_layer2_ln2 -->
<g id="edge2323" class="edge">
<title>gpu7_layer2_res1&#45;&gt;gpu7_layer2_ln2</title>
<path fill="none" stroke="black" d="M4527,-18192.38C4527,-18184.09 4527,-18174.7 4527,-18165.8"/>
<polygon fill="black" stroke="black" points="4530.5,-18165.65 4527,-18155.65 4523.5,-18165.65 4530.5,-18165.65"/>
</g>
<!-- gpu7_layer2_routing -->
<g id="node1865" class="node">
<title>gpu7_layer2_routing</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-18066.55 4452.29,-18066.55 4400.53,-17940.55 4601.71,-17940.55 4653.47,-18066.55"/>
<text text-anchor="middle" x="4527" y="-18023.05" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="4527" y="-18012.05" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-18001.05" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-17990.05" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="4527" y="-17979.05" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer2_ln2&#45;&gt;gpu7_layer2_routing -->
<g id="edge2324" class="edge">
<title>gpu7_layer2_ln2&#45;&gt;gpu7_layer2_routing</title>
<path fill="none" stroke="black" d="M4527,-18103.45C4527,-18095.52 4527,-18086.33 4527,-18076.8"/>
<polygon fill="black" stroke="black" points="4530.5,-18076.78 4527,-18066.78 4523.5,-18076.78 4530.5,-18076.78"/>
</g>
<!-- gpu7_layer2_expert0 -->
<g id="node1866" class="node">
<title>gpu7_layer2_expert0</title>
<polygon fill="lightblue" stroke="black" points="4308,-17894.55 4186,-17894.55 4186,-17842.55 4308,-17842.55 4308,-17894.55"/>
<text text-anchor="middle" x="4247" y="-17882.55" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="4247" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer2_routing&#45;&gt;gpu7_layer2_expert0 -->
<g id="edge2311" class="edge">
<title>gpu7_layer2_routing&#45;&gt;gpu7_layer2_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4401.33,-17942.86C4369.34,-17927.66 4336.34,-17911.98 4309.11,-17899.05"/>
<polygon fill="black" stroke="black" points="4310.26,-17895.72 4299.73,-17894.59 4307.26,-17902.04 4310.26,-17895.72"/>
<text text-anchor="middle" x="4382.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer2_expert1 -->
<g id="node1867" class="node">
<title>gpu7_layer2_expert1</title>
<polygon fill="lightblue" stroke="black" points="4448,-17894.55 4326,-17894.55 4326,-17842.55 4448,-17842.55 4448,-17894.55"/>
<text text-anchor="middle" x="4387" y="-17882.55" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="4387" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer2_routing&#45;&gt;gpu7_layer2_expert1 -->
<g id="edge2312" class="edge">
<title>gpu7_layer2_routing&#45;&gt;gpu7_layer2_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4461.51,-17940.33C4447.48,-17927.01 4433.21,-17913.45 4420.97,-17901.82"/>
<polygon fill="black" stroke="black" points="4423.29,-17899.19 4413.63,-17894.84 4418.46,-17904.27 4423.29,-17899.19"/>
<text text-anchor="middle" x="4469.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer2_expert2 -->
<g id="node1868" class="node">
<title>gpu7_layer2_expert2</title>
<polygon fill="lightblue" stroke="black" points="4588,-17894.55 4466,-17894.55 4466,-17842.55 4588,-17842.55 4588,-17894.55"/>
<text text-anchor="middle" x="4527" y="-17882.55" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="4527" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer2_routing&#45;&gt;gpu7_layer2_expert2 -->
<g id="edge2313" class="edge">
<title>gpu7_layer2_routing&#45;&gt;gpu7_layer2_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4527,-17940.33C4527,-17928.26 4527,-17916.01 4527,-17905.16"/>
<polygon fill="black" stroke="black" points="4530.5,-17904.84 4527,-17894.84 4523.5,-17904.84 4530.5,-17904.84"/>
<text text-anchor="middle" x="4556.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer2_expert3 -->
<g id="node1869" class="node">
<title>gpu7_layer2_expert3</title>
<polygon fill="lightblue" stroke="black" points="4728,-17894.55 4606,-17894.55 4606,-17842.55 4728,-17842.55 4728,-17894.55"/>
<text text-anchor="middle" x="4667" y="-17882.55" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4667" y="-17871.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-17860.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-17849.55" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer2_routing&#45;&gt;gpu7_layer2_expert3 -->
<g id="edge2314" class="edge">
<title>gpu7_layer2_routing&#45;&gt;gpu7_layer2_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4592.49,-17940.33C4606.52,-17927.01 4620.79,-17913.45 4633.03,-17901.82"/>
<polygon fill="black" stroke="black" points="4635.54,-17904.27 4640.37,-17894.84 4630.71,-17899.19 4635.54,-17904.27"/>
<text text-anchor="middle" x="4650.5" y="-17915.35" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer2_expert_agg -->
<g id="node1870" class="node">
<title>gpu7_layer2_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-17805.55 4452.29,-17805.55 4400.53,-17701.55 4601.71,-17701.55 4653.47,-17805.55"/>
<text text-anchor="middle" x="4527" y="-17767.55" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="4527" y="-17756.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-17745.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-17734.55" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer2_routing&#45;&gt;gpu7_layer2_expert_agg -->
<g id="edge2329" class="edge">
<title>gpu7_layer2_routing&#45;&gt;gpu7_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M4616.22,-17975.63C4689.96,-17948.47 4776.6,-17902.08 4737,-17842.55 4716.44,-17811.64 4682.7,-17791.56 4648.22,-17778.53"/>
<polygon fill="black" stroke="black" points="4649.08,-17775.12 4638.48,-17775.04 4646.71,-17781.71 4649.08,-17775.12"/>
</g>
<!-- gpu7_layer2_expert0&#45;&gt;gpu7_layer2_expert_agg -->
<g id="edge2325" class="edge">
<title>gpu7_layer2_expert0&#45;&gt;gpu7_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M4308.1,-17842.89C4344.98,-17828.01 4392.7,-17808.75 4434.16,-17792.01"/>
<polygon fill="black" stroke="black" points="4435.5,-17795.25 4443.46,-17788.26 4432.88,-17788.76 4435.5,-17795.25"/>
</g>
<!-- gpu7_layer2_expert1&#45;&gt;gpu7_layer2_expert_agg -->
<g id="edge2326" class="edge">
<title>gpu7_layer2_expert1&#45;&gt;gpu7_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M4418.07,-17842.47C4429.32,-17833.39 4442.53,-17822.73 4455.8,-17812.02"/>
<polygon fill="black" stroke="black" points="4458.02,-17814.72 4463.6,-17805.72 4453.62,-17809.28 4458.02,-17814.72"/>
</g>
<!-- gpu7_layer2_expert2&#45;&gt;gpu7_layer2_expert_agg -->
<g id="edge2327" class="edge">
<title>gpu7_layer2_expert2&#45;&gt;gpu7_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M4527,-17842.47C4527,-17834.54 4527,-17825.41 4527,-17816.09"/>
<polygon fill="black" stroke="black" points="4530.5,-17815.95 4527,-17805.95 4523.5,-17815.95 4530.5,-17815.95"/>
</g>
<!-- gpu7_layer2_expert3&#45;&gt;gpu7_layer2_expert_agg -->
<g id="edge2328" class="edge">
<title>gpu7_layer2_expert3&#45;&gt;gpu7_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M4635.93,-17842.47C4624.68,-17833.39 4611.47,-17822.73 4598.2,-17812.02"/>
<polygon fill="black" stroke="black" points="4600.38,-17809.28 4590.4,-17805.72 4595.98,-17814.72 4600.38,-17809.28"/>
</g>
<!-- gpu7_layer2_res2 -->
<g id="node1871" class="node">
<title>gpu7_layer2_res2</title>
<polygon fill="lightblue" stroke="black" points="4588,-17664.55 4466,-17664.55 4466,-17612.55 4588,-17612.55 4588,-17664.55"/>
<text text-anchor="middle" x="4527" y="-17652.55" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="4527" y="-17641.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-17630.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-17619.55" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer2_expert_agg&#45;&gt;gpu7_layer2_res2 -->
<g id="edge2330" class="edge">
<title>gpu7_layer2_expert_agg&#45;&gt;gpu7_layer2_res2</title>
<path fill="none" stroke="black" d="M4527,-17701.34C4527,-17692.39 4527,-17683.26 4527,-17674.86"/>
<polygon fill="black" stroke="black" points="4530.5,-17674.68 4527,-17664.68 4523.5,-17674.68 4530.5,-17674.68"/>
</g>
<!-- gpu7_layer3_ln1 -->
<g id="node1872" class="node">
<title>gpu7_layer3_ln1</title>
<polygon fill="lightblue" stroke="black" points="4588,-17575.55 4466,-17575.55 4466,-17523.55 4588,-17523.55 4588,-17575.55"/>
<text text-anchor="middle" x="4527" y="-17563.55" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="4527" y="-17552.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-17541.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-17530.55" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer2_res2&#45;&gt;gpu7_layer3_ln1 -->
<g id="edge2335" class="edge">
<title>gpu7_layer2_res2&#45;&gt;gpu7_layer3_ln1</title>
<path fill="none" stroke="black" d="M4527,-17612.38C4527,-17604.09 4527,-17594.7 4527,-17585.8"/>
<polygon fill="black" stroke="black" points="4530.5,-17585.65 4527,-17575.65 4523.5,-17585.65 4530.5,-17585.65"/>
</g>
<!-- gpu7_layer3_qkv -->
<g id="node1873" class="node">
<title>gpu7_layer3_qkv</title>
<polygon fill="lightblue" stroke="black" points="4588,-17486.55 4466,-17486.55 4466,-17434.55 4588,-17434.55 4588,-17486.55"/>
<text text-anchor="middle" x="4527" y="-17474.55" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4527" y="-17463.55" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-17452.55" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-17441.55" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer3_ln1&#45;&gt;gpu7_layer3_qkv -->
<g id="edge2336" class="edge">
<title>gpu7_layer3_ln1&#45;&gt;gpu7_layer3_qkv</title>
<path fill="none" stroke="black" d="M4527,-17523.38C4527,-17515.09 4527,-17505.7 4527,-17496.8"/>
<polygon fill="black" stroke="black" points="4530.5,-17496.65 4527,-17486.65 4523.5,-17496.65 4530.5,-17496.65"/>
</g>
<!-- gpu7_layer3_reshape -->
<g id="node1874" class="node">
<title>gpu7_layer3_reshape</title>
<polygon fill="lightblue" stroke="black" points="4591,-17397.55 4463,-17397.55 4463,-17345.55 4591,-17345.55 4591,-17397.55"/>
<text text-anchor="middle" x="4527" y="-17385.55" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="4527" y="-17374.55" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-17363.55" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-17352.55" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer3_qkv&#45;&gt;gpu7_layer3_reshape -->
<g id="edge2337" class="edge">
<title>gpu7_layer3_qkv&#45;&gt;gpu7_layer3_reshape</title>
<path fill="none" stroke="black" d="M4527,-17434.38C4527,-17426.09 4527,-17416.7 4527,-17407.8"/>
<polygon fill="black" stroke="black" points="4530.5,-17407.65 4527,-17397.65 4523.5,-17407.65 4530.5,-17407.65"/>
</g>
<!-- gpu7_layer3_attn -->
<g id="node1875" class="node">
<title>gpu7_layer3_attn</title>
<polygon fill="lightblue" stroke="black" points="4591,-17308.55 4463,-17308.55 4463,-17256.55 4591,-17256.55 4591,-17308.55"/>
<text text-anchor="middle" x="4527" y="-17296.55" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="4527" y="-17285.55" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-17274.55" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-17263.55" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer3_reshape&#45;&gt;gpu7_layer3_attn -->
<g id="edge2338" class="edge">
<title>gpu7_layer3_reshape&#45;&gt;gpu7_layer3_attn</title>
<path fill="none" stroke="black" d="M4527,-17345.38C4527,-17337.09 4527,-17327.7 4527,-17318.8"/>
<polygon fill="black" stroke="black" points="4530.5,-17318.65 4527,-17308.65 4523.5,-17318.65 4530.5,-17318.65"/>
</g>
<!-- gpu7_layer3_attn_reshape -->
<g id="node1877" class="node">
<title>gpu7_layer3_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="4588,-17219.55 4466,-17219.55 4466,-17167.55 4588,-17167.55 4588,-17219.55"/>
<text text-anchor="middle" x="4527" y="-17207.55" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="4527" y="-17196.55" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-17185.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-17174.55" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer3_attn&#45;&gt;gpu7_layer3_attn_reshape -->
<g id="edge2339" class="edge">
<title>gpu7_layer3_attn&#45;&gt;gpu7_layer3_attn_reshape</title>
<path fill="none" stroke="black" d="M4527,-17256.38C4527,-17248.09 4527,-17238.7 4527,-17229.8"/>
<polygon fill="black" stroke="black" points="4530.5,-17229.65 4527,-17219.65 4523.5,-17229.65 4530.5,-17229.65"/>
</g>
<!-- gpu7_layer3_attn_out -->
<g id="node1876" class="node">
<title>gpu7_layer3_attn_out</title>
<polygon fill="lightblue" stroke="black" points="4588,-17130.55 4466,-17130.55 4466,-17078.55 4588,-17078.55 4588,-17130.55"/>
<text text-anchor="middle" x="4527" y="-17118.55" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="4527" y="-17107.55" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-17096.55" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-17085.55" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer3_kv_update -->
<g id="node1878" class="node">
<title>gpu7_layer3_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="4527" cy="-17004.78" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="4527" y="-17018.78" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="4527" y="-17007.78" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-16996.78" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-16985.78" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer3_attn_out&#45;&gt;gpu7_layer3_kv_update -->
<g id="edge2341" class="edge">
<title>gpu7_layer3_attn_out&#45;&gt;gpu7_layer3_kv_update</title>
<path fill="none" stroke="black" d="M4527,-17078.37C4527,-17070.23 4527,-17060.93 4527,-17051.77"/>
<polygon fill="black" stroke="black" points="4530.5,-17051.56 4527,-17041.56 4523.5,-17051.56 4530.5,-17051.56"/>
</g>
<!-- gpu7_layer3_attn_reshape&#45;&gt;gpu7_layer3_attn_out -->
<g id="edge2340" class="edge">
<title>gpu7_layer3_attn_reshape&#45;&gt;gpu7_layer3_attn_out</title>
<path fill="none" stroke="black" d="M4527,-17167.38C4527,-17159.09 4527,-17149.7 4527,-17140.8"/>
<polygon fill="black" stroke="black" points="4530.5,-17140.65 4527,-17130.65 4523.5,-17140.65 4530.5,-17140.65"/>
</g>
<!-- gpu7_layer3_res1 -->
<g id="node1879" class="node">
<title>gpu7_layer3_res1</title>
<polygon fill="lightblue" stroke="black" points="4588,-16931.01 4466,-16931.01 4466,-16879.01 4588,-16879.01 4588,-16931.01"/>
<text text-anchor="middle" x="4527" y="-16919.01" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="4527" y="-16908.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-16897.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-16886.01" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer3_kv_update&#45;&gt;gpu7_layer3_res1 -->
<g id="edge2342" class="edge">
<title>gpu7_layer3_kv_update&#45;&gt;gpu7_layer3_res1</title>
<path fill="none" stroke="black" d="M4527,-16967.93C4527,-16959.25 4527,-16949.98 4527,-16941.32"/>
<polygon fill="black" stroke="black" points="4530.5,-16941.15 4527,-16931.15 4523.5,-16941.15 4530.5,-16941.15"/>
</g>
<!-- gpu7_layer3_ln2 -->
<g id="node1880" class="node">
<title>gpu7_layer3_ln2</title>
<polygon fill="lightblue" stroke="black" points="4588,-16842.01 4466,-16842.01 4466,-16790.01 4588,-16790.01 4588,-16842.01"/>
<text text-anchor="middle" x="4527" y="-16830.01" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="4527" y="-16819.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-16808.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-16797.01" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer3_res1&#45;&gt;gpu7_layer3_ln2 -->
<g id="edge2343" class="edge">
<title>gpu7_layer3_res1&#45;&gt;gpu7_layer3_ln2</title>
<path fill="none" stroke="black" d="M4527,-16878.84C4527,-16870.55 4527,-16861.16 4527,-16852.26"/>
<polygon fill="black" stroke="black" points="4530.5,-16852.12 4527,-16842.12 4523.5,-16852.12 4530.5,-16852.12"/>
</g>
<!-- gpu7_layer3_routing -->
<g id="node1881" class="node">
<title>gpu7_layer3_routing</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-16753.01 4452.29,-16753.01 4400.53,-16627.01 4601.71,-16627.01 4653.47,-16753.01"/>
<text text-anchor="middle" x="4527" y="-16709.51" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="4527" y="-16698.51" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-16687.51" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-16676.51" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="4527" y="-16665.51" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer3_ln2&#45;&gt;gpu7_layer3_routing -->
<g id="edge2344" class="edge">
<title>gpu7_layer3_ln2&#45;&gt;gpu7_layer3_routing</title>
<path fill="none" stroke="black" d="M4527,-16789.92C4527,-16781.98 4527,-16772.79 4527,-16763.26"/>
<polygon fill="black" stroke="black" points="4530.5,-16763.24 4527,-16753.24 4523.5,-16763.24 4530.5,-16763.24"/>
</g>
<!-- gpu7_layer3_expert0 -->
<g id="node1882" class="node">
<title>gpu7_layer3_expert0</title>
<polygon fill="lightblue" stroke="black" points="4308,-16581.01 4186,-16581.01 4186,-16529.01 4308,-16529.01 4308,-16581.01"/>
<text text-anchor="middle" x="4247" y="-16569.01" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="4247" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer3_routing&#45;&gt;gpu7_layer3_expert0 -->
<g id="edge2331" class="edge">
<title>gpu7_layer3_routing&#45;&gt;gpu7_layer3_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4401.33,-16629.32C4369.34,-16614.12 4336.34,-16598.44 4309.11,-16585.51"/>
<polygon fill="black" stroke="black" points="4310.26,-16582.18 4299.73,-16581.05 4307.26,-16588.51 4310.26,-16582.18"/>
<text text-anchor="middle" x="4382.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer3_expert1 -->
<g id="node1883" class="node">
<title>gpu7_layer3_expert1</title>
<polygon fill="lightblue" stroke="black" points="4448,-16581.01 4326,-16581.01 4326,-16529.01 4448,-16529.01 4448,-16581.01"/>
<text text-anchor="middle" x="4387" y="-16569.01" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="4387" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer3_routing&#45;&gt;gpu7_layer3_expert1 -->
<g id="edge2332" class="edge">
<title>gpu7_layer3_routing&#45;&gt;gpu7_layer3_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4461.51,-16626.79C4447.48,-16613.47 4433.21,-16599.91 4420.97,-16588.28"/>
<polygon fill="black" stroke="black" points="4423.29,-16585.65 4413.63,-16581.3 4418.46,-16590.73 4423.29,-16585.65"/>
<text text-anchor="middle" x="4469.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer3_expert2 -->
<g id="node1884" class="node">
<title>gpu7_layer3_expert2</title>
<polygon fill="lightblue" stroke="black" points="4588,-16581.01 4466,-16581.01 4466,-16529.01 4588,-16529.01 4588,-16581.01"/>
<text text-anchor="middle" x="4527" y="-16569.01" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="4527" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer3_routing&#45;&gt;gpu7_layer3_expert2 -->
<g id="edge2333" class="edge">
<title>gpu7_layer3_routing&#45;&gt;gpu7_layer3_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4527,-16626.79C4527,-16614.72 4527,-16602.47 4527,-16591.62"/>
<polygon fill="black" stroke="black" points="4530.5,-16591.3 4527,-16581.3 4523.5,-16591.3 4530.5,-16591.3"/>
<text text-anchor="middle" x="4556.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer3_expert3 -->
<g id="node1885" class="node">
<title>gpu7_layer3_expert3</title>
<polygon fill="lightblue" stroke="black" points="4728,-16581.01 4606,-16581.01 4606,-16529.01 4728,-16529.01 4728,-16581.01"/>
<text text-anchor="middle" x="4667" y="-16569.01" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4667" y="-16558.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-16547.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-16536.01" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer3_routing&#45;&gt;gpu7_layer3_expert3 -->
<g id="edge2334" class="edge">
<title>gpu7_layer3_routing&#45;&gt;gpu7_layer3_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4592.49,-16626.79C4606.52,-16613.47 4620.79,-16599.91 4633.03,-16588.28"/>
<polygon fill="black" stroke="black" points="4635.54,-16590.73 4640.37,-16581.3 4630.71,-16585.65 4635.54,-16590.73"/>
<text text-anchor="middle" x="4650.5" y="-16601.81" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer3_expert_agg -->
<g id="node1886" class="node">
<title>gpu7_layer3_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-16492.01 4452.29,-16492.01 4400.53,-16388.01 4601.71,-16388.01 4653.47,-16492.01"/>
<text text-anchor="middle" x="4527" y="-16454.01" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="4527" y="-16443.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-16432.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-16421.01" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer3_routing&#45;&gt;gpu7_layer3_expert_agg -->
<g id="edge2349" class="edge">
<title>gpu7_layer3_routing&#45;&gt;gpu7_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M4616.22,-16662.09C4689.96,-16634.93 4776.6,-16588.54 4737,-16529.01 4716.44,-16498.1 4682.7,-16478.02 4648.22,-16464.99"/>
<polygon fill="black" stroke="black" points="4649.08,-16461.58 4638.48,-16461.5 4646.71,-16468.17 4649.08,-16461.58"/>
</g>
<!-- gpu7_layer3_expert0&#45;&gt;gpu7_layer3_expert_agg -->
<g id="edge2345" class="edge">
<title>gpu7_layer3_expert0&#45;&gt;gpu7_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M4308.1,-16529.35C4344.98,-16514.47 4392.7,-16495.21 4434.16,-16478.47"/>
<polygon fill="black" stroke="black" points="4435.5,-16481.71 4443.46,-16474.72 4432.88,-16475.22 4435.5,-16481.71"/>
</g>
<!-- gpu7_layer3_expert1&#45;&gt;gpu7_layer3_expert_agg -->
<g id="edge2346" class="edge">
<title>gpu7_layer3_expert1&#45;&gt;gpu7_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M4418.07,-16528.93C4429.32,-16519.85 4442.53,-16509.19 4455.8,-16498.48"/>
<polygon fill="black" stroke="black" points="4458.02,-16501.18 4463.6,-16492.18 4453.62,-16495.74 4458.02,-16501.18"/>
</g>
<!-- gpu7_layer3_expert2&#45;&gt;gpu7_layer3_expert_agg -->
<g id="edge2347" class="edge">
<title>gpu7_layer3_expert2&#45;&gt;gpu7_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M4527,-16528.93C4527,-16521 4527,-16511.87 4527,-16502.55"/>
<polygon fill="black" stroke="black" points="4530.5,-16502.41 4527,-16492.41 4523.5,-16502.41 4530.5,-16502.41"/>
</g>
<!-- gpu7_layer3_expert3&#45;&gt;gpu7_layer3_expert_agg -->
<g id="edge2348" class="edge">
<title>gpu7_layer3_expert3&#45;&gt;gpu7_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M4635.93,-16528.93C4624.68,-16519.85 4611.47,-16509.19 4598.2,-16498.48"/>
<polygon fill="black" stroke="black" points="4600.38,-16495.74 4590.4,-16492.18 4595.98,-16501.18 4600.38,-16495.74"/>
</g>
<!-- gpu7_layer3_res2 -->
<g id="node1887" class="node">
<title>gpu7_layer3_res2</title>
<polygon fill="lightblue" stroke="black" points="4588,-16351.01 4466,-16351.01 4466,-16299.01 4588,-16299.01 4588,-16351.01"/>
<text text-anchor="middle" x="4527" y="-16339.01" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="4527" y="-16328.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-16317.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-16306.01" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer3_expert_agg&#45;&gt;gpu7_layer3_res2 -->
<g id="edge2350" class="edge">
<title>gpu7_layer3_expert_agg&#45;&gt;gpu7_layer3_res2</title>
<path fill="none" stroke="black" d="M4527,-16387.8C4527,-16378.85 4527,-16369.72 4527,-16361.32"/>
<polygon fill="black" stroke="black" points="4530.5,-16361.14 4527,-16351.14 4523.5,-16361.14 4530.5,-16361.14"/>
</g>
<!-- gpu7_layer4_ln1 -->
<g id="node1888" class="node">
<title>gpu7_layer4_ln1</title>
<polygon fill="lightblue" stroke="black" points="4588,-16262.01 4466,-16262.01 4466,-16210.01 4588,-16210.01 4588,-16262.01"/>
<text text-anchor="middle" x="4527" y="-16250.01" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="4527" y="-16239.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-16228.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-16217.01" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer3_res2&#45;&gt;gpu7_layer4_ln1 -->
<g id="edge2355" class="edge">
<title>gpu7_layer3_res2&#45;&gt;gpu7_layer4_ln1</title>
<path fill="none" stroke="black" d="M4527,-16298.84C4527,-16290.55 4527,-16281.16 4527,-16272.26"/>
<polygon fill="black" stroke="black" points="4530.5,-16272.12 4527,-16262.12 4523.5,-16272.12 4530.5,-16272.12"/>
</g>
<!-- gpu7_layer4_qkv -->
<g id="node1889" class="node">
<title>gpu7_layer4_qkv</title>
<polygon fill="lightblue" stroke="black" points="4588,-16173.01 4466,-16173.01 4466,-16121.01 4588,-16121.01 4588,-16173.01"/>
<text text-anchor="middle" x="4527" y="-16161.01" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4527" y="-16150.01" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-16139.01" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-16128.01" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer4_ln1&#45;&gt;gpu7_layer4_qkv -->
<g id="edge2356" class="edge">
<title>gpu7_layer4_ln1&#45;&gt;gpu7_layer4_qkv</title>
<path fill="none" stroke="black" d="M4527,-16209.84C4527,-16201.55 4527,-16192.16 4527,-16183.26"/>
<polygon fill="black" stroke="black" points="4530.5,-16183.12 4527,-16173.12 4523.5,-16183.12 4530.5,-16183.12"/>
</g>
<!-- gpu7_layer4_reshape -->
<g id="node1890" class="node">
<title>gpu7_layer4_reshape</title>
<polygon fill="lightblue" stroke="black" points="4591,-16084.01 4463,-16084.01 4463,-16032.01 4591,-16032.01 4591,-16084.01"/>
<text text-anchor="middle" x="4527" y="-16072.01" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="4527" y="-16061.01" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-16050.01" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-16039.01" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer4_qkv&#45;&gt;gpu7_layer4_reshape -->
<g id="edge2357" class="edge">
<title>gpu7_layer4_qkv&#45;&gt;gpu7_layer4_reshape</title>
<path fill="none" stroke="black" d="M4527,-16120.84C4527,-16112.55 4527,-16103.16 4527,-16094.26"/>
<polygon fill="black" stroke="black" points="4530.5,-16094.12 4527,-16084.12 4523.5,-16094.12 4530.5,-16094.12"/>
</g>
<!-- gpu7_layer4_attn -->
<g id="node1891" class="node">
<title>gpu7_layer4_attn</title>
<polygon fill="lightblue" stroke="black" points="4591,-15995.01 4463,-15995.01 4463,-15943.01 4591,-15943.01 4591,-15995.01"/>
<text text-anchor="middle" x="4527" y="-15983.01" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="4527" y="-15972.01" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-15961.01" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-15950.01" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer4_reshape&#45;&gt;gpu7_layer4_attn -->
<g id="edge2358" class="edge">
<title>gpu7_layer4_reshape&#45;&gt;gpu7_layer4_attn</title>
<path fill="none" stroke="black" d="M4527,-16031.84C4527,-16023.55 4527,-16014.16 4527,-16005.26"/>
<polygon fill="black" stroke="black" points="4530.5,-16005.12 4527,-15995.12 4523.5,-16005.12 4530.5,-16005.12"/>
</g>
<!-- gpu7_layer4_attn_reshape -->
<g id="node1893" class="node">
<title>gpu7_layer4_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="4588,-15906.01 4466,-15906.01 4466,-15854.01 4588,-15854.01 4588,-15906.01"/>
<text text-anchor="middle" x="4527" y="-15894.01" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="4527" y="-15883.01" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-15872.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-15861.01" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer4_attn&#45;&gt;gpu7_layer4_attn_reshape -->
<g id="edge2359" class="edge">
<title>gpu7_layer4_attn&#45;&gt;gpu7_layer4_attn_reshape</title>
<path fill="none" stroke="black" d="M4527,-15942.84C4527,-15934.55 4527,-15925.16 4527,-15916.26"/>
<polygon fill="black" stroke="black" points="4530.5,-15916.12 4527,-15906.12 4523.5,-15916.12 4530.5,-15916.12"/>
</g>
<!-- gpu7_layer4_attn_out -->
<g id="node1892" class="node">
<title>gpu7_layer4_attn_out</title>
<polygon fill="lightblue" stroke="black" points="4588,-15817.01 4466,-15817.01 4466,-15765.01 4588,-15765.01 4588,-15817.01"/>
<text text-anchor="middle" x="4527" y="-15805.01" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="4527" y="-15794.01" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-15783.01" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-15772.01" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer4_kv_update -->
<g id="node1894" class="node">
<title>gpu7_layer4_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="4527" cy="-15691.24" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="4527" y="-15705.24" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="4527" y="-15694.24" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-15683.24" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-15672.24" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer4_attn_out&#45;&gt;gpu7_layer4_kv_update -->
<g id="edge2361" class="edge">
<title>gpu7_layer4_attn_out&#45;&gt;gpu7_layer4_kv_update</title>
<path fill="none" stroke="black" d="M4527,-15764.83C4527,-15756.69 4527,-15747.39 4527,-15738.23"/>
<polygon fill="black" stroke="black" points="4530.5,-15738.02 4527,-15728.02 4523.5,-15738.02 4530.5,-15738.02"/>
</g>
<!-- gpu7_layer4_attn_reshape&#45;&gt;gpu7_layer4_attn_out -->
<g id="edge2360" class="edge">
<title>gpu7_layer4_attn_reshape&#45;&gt;gpu7_layer4_attn_out</title>
<path fill="none" stroke="black" d="M4527,-15853.84C4527,-15845.55 4527,-15836.16 4527,-15827.26"/>
<polygon fill="black" stroke="black" points="4530.5,-15827.12 4527,-15817.12 4523.5,-15827.12 4530.5,-15827.12"/>
</g>
<!-- gpu7_layer4_res1 -->
<g id="node1895" class="node">
<title>gpu7_layer4_res1</title>
<polygon fill="lightblue" stroke="black" points="4588,-15617.47 4466,-15617.47 4466,-15565.47 4588,-15565.47 4588,-15617.47"/>
<text text-anchor="middle" x="4527" y="-15605.47" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="4527" y="-15594.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-15583.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-15572.47" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer4_kv_update&#45;&gt;gpu7_layer4_res1 -->
<g id="edge2362" class="edge">
<title>gpu7_layer4_kv_update&#45;&gt;gpu7_layer4_res1</title>
<path fill="none" stroke="black" d="M4527,-15654.39C4527,-15645.71 4527,-15636.44 4527,-15627.78"/>
<polygon fill="black" stroke="black" points="4530.5,-15627.62 4527,-15617.62 4523.5,-15627.62 4530.5,-15627.62"/>
</g>
<!-- gpu7_layer4_ln2 -->
<g id="node1896" class="node">
<title>gpu7_layer4_ln2</title>
<polygon fill="lightblue" stroke="black" points="4588,-15528.47 4466,-15528.47 4466,-15476.47 4588,-15476.47 4588,-15528.47"/>
<text text-anchor="middle" x="4527" y="-15516.47" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="4527" y="-15505.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-15494.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-15483.47" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer4_res1&#45;&gt;gpu7_layer4_ln2 -->
<g id="edge2363" class="edge">
<title>gpu7_layer4_res1&#45;&gt;gpu7_layer4_ln2</title>
<path fill="none" stroke="black" d="M4527,-15565.31C4527,-15557.01 4527,-15547.62 4527,-15538.72"/>
<polygon fill="black" stroke="black" points="4530.5,-15538.58 4527,-15528.58 4523.5,-15538.58 4530.5,-15538.58"/>
</g>
<!-- gpu7_layer4_routing -->
<g id="node1897" class="node">
<title>gpu7_layer4_routing</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-15439.47 4452.29,-15439.47 4400.53,-15313.47 4601.71,-15313.47 4653.47,-15439.47"/>
<text text-anchor="middle" x="4527" y="-15395.97" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="4527" y="-15384.97" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-15373.97" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-15362.97" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="4527" y="-15351.97" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer4_ln2&#45;&gt;gpu7_layer4_routing -->
<g id="edge2364" class="edge">
<title>gpu7_layer4_ln2&#45;&gt;gpu7_layer4_routing</title>
<path fill="none" stroke="black" d="M4527,-15476.38C4527,-15468.45 4527,-15459.25 4527,-15449.72"/>
<polygon fill="black" stroke="black" points="4530.5,-15449.7 4527,-15439.7 4523.5,-15449.7 4530.5,-15449.7"/>
</g>
<!-- gpu7_layer4_expert0 -->
<g id="node1898" class="node">
<title>gpu7_layer4_expert0</title>
<polygon fill="lightblue" stroke="black" points="4308,-15267.47 4186,-15267.47 4186,-15215.47 4308,-15215.47 4308,-15267.47"/>
<text text-anchor="middle" x="4247" y="-15255.47" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="4247" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer4_routing&#45;&gt;gpu7_layer4_expert0 -->
<g id="edge2351" class="edge">
<title>gpu7_layer4_routing&#45;&gt;gpu7_layer4_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4401.33,-15315.78C4369.34,-15300.58 4336.34,-15284.91 4309.11,-15271.97"/>
<polygon fill="black" stroke="black" points="4310.26,-15268.64 4299.73,-15267.51 4307.26,-15274.97 4310.26,-15268.64"/>
<text text-anchor="middle" x="4382.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer4_expert1 -->
<g id="node1899" class="node">
<title>gpu7_layer4_expert1</title>
<polygon fill="lightblue" stroke="black" points="4448,-15267.47 4326,-15267.47 4326,-15215.47 4448,-15215.47 4448,-15267.47"/>
<text text-anchor="middle" x="4387" y="-15255.47" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="4387" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer4_routing&#45;&gt;gpu7_layer4_expert1 -->
<g id="edge2352" class="edge">
<title>gpu7_layer4_routing&#45;&gt;gpu7_layer4_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4461.51,-15313.25C4447.48,-15299.93 4433.21,-15286.37 4420.97,-15274.74"/>
<polygon fill="black" stroke="black" points="4423.29,-15272.11 4413.63,-15267.76 4418.46,-15277.19 4423.29,-15272.11"/>
<text text-anchor="middle" x="4469.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer4_expert2 -->
<g id="node1900" class="node">
<title>gpu7_layer4_expert2</title>
<polygon fill="lightblue" stroke="black" points="4588,-15267.47 4466,-15267.47 4466,-15215.47 4588,-15215.47 4588,-15267.47"/>
<text text-anchor="middle" x="4527" y="-15255.47" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="4527" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer4_routing&#45;&gt;gpu7_layer4_expert2 -->
<g id="edge2353" class="edge">
<title>gpu7_layer4_routing&#45;&gt;gpu7_layer4_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4527,-15313.25C4527,-15301.18 4527,-15288.93 4527,-15278.08"/>
<polygon fill="black" stroke="black" points="4530.5,-15277.76 4527,-15267.76 4523.5,-15277.76 4530.5,-15277.76"/>
<text text-anchor="middle" x="4556.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer4_expert3 -->
<g id="node1901" class="node">
<title>gpu7_layer4_expert3</title>
<polygon fill="lightblue" stroke="black" points="4728,-15267.47 4606,-15267.47 4606,-15215.47 4728,-15215.47 4728,-15267.47"/>
<text text-anchor="middle" x="4667" y="-15255.47" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4667" y="-15244.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-15233.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-15222.47" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer4_routing&#45;&gt;gpu7_layer4_expert3 -->
<g id="edge2354" class="edge">
<title>gpu7_layer4_routing&#45;&gt;gpu7_layer4_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4592.49,-15313.25C4606.52,-15299.93 4620.79,-15286.37 4633.03,-15274.74"/>
<polygon fill="black" stroke="black" points="4635.54,-15277.19 4640.37,-15267.76 4630.71,-15272.11 4635.54,-15277.19"/>
<text text-anchor="middle" x="4650.5" y="-15288.27" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer4_expert_agg -->
<g id="node1902" class="node">
<title>gpu7_layer4_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-15178.47 4452.29,-15178.47 4400.53,-15074.47 4601.71,-15074.47 4653.47,-15178.47"/>
<text text-anchor="middle" x="4527" y="-15140.47" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="4527" y="-15129.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-15118.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-15107.47" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer4_routing&#45;&gt;gpu7_layer4_expert_agg -->
<g id="edge2369" class="edge">
<title>gpu7_layer4_routing&#45;&gt;gpu7_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M4616.22,-15348.55C4689.96,-15321.39 4776.6,-15275 4737,-15215.47 4716.44,-15184.56 4682.7,-15164.48 4648.22,-15151.45"/>
<polygon fill="black" stroke="black" points="4649.08,-15148.04 4638.48,-15147.96 4646.71,-15154.63 4649.08,-15148.04"/>
</g>
<!-- gpu7_layer4_expert0&#45;&gt;gpu7_layer4_expert_agg -->
<g id="edge2365" class="edge">
<title>gpu7_layer4_expert0&#45;&gt;gpu7_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M4308.1,-15215.81C4344.98,-15200.93 4392.7,-15181.67 4434.16,-15164.94"/>
<polygon fill="black" stroke="black" points="4435.5,-15168.17 4443.46,-15161.18 4432.88,-15161.68 4435.5,-15168.17"/>
</g>
<!-- gpu7_layer4_expert1&#45;&gt;gpu7_layer4_expert_agg -->
<g id="edge2366" class="edge">
<title>gpu7_layer4_expert1&#45;&gt;gpu7_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M4418.07,-15215.39C4429.32,-15206.31 4442.53,-15195.65 4455.8,-15184.94"/>
<polygon fill="black" stroke="black" points="4458.02,-15187.64 4463.6,-15178.64 4453.62,-15182.2 4458.02,-15187.64"/>
</g>
<!-- gpu7_layer4_expert2&#45;&gt;gpu7_layer4_expert_agg -->
<g id="edge2367" class="edge">
<title>gpu7_layer4_expert2&#45;&gt;gpu7_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M4527,-15215.39C4527,-15207.46 4527,-15198.33 4527,-15189.01"/>
<polygon fill="black" stroke="black" points="4530.5,-15188.87 4527,-15178.87 4523.5,-15188.87 4530.5,-15188.87"/>
</g>
<!-- gpu7_layer4_expert3&#45;&gt;gpu7_layer4_expert_agg -->
<g id="edge2368" class="edge">
<title>gpu7_layer4_expert3&#45;&gt;gpu7_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M4635.93,-15215.39C4624.68,-15206.31 4611.47,-15195.65 4598.2,-15184.94"/>
<polygon fill="black" stroke="black" points="4600.38,-15182.2 4590.4,-15178.64 4595.98,-15187.64 4600.38,-15182.2"/>
</g>
<!-- gpu7_layer4_res2 -->
<g id="node1903" class="node">
<title>gpu7_layer4_res2</title>
<polygon fill="lightblue" stroke="black" points="4588,-15037.47 4466,-15037.47 4466,-14985.47 4588,-14985.47 4588,-15037.47"/>
<text text-anchor="middle" x="4527" y="-15025.47" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="4527" y="-15014.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-15003.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-14992.47" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer4_expert_agg&#45;&gt;gpu7_layer4_res2 -->
<g id="edge2370" class="edge">
<title>gpu7_layer4_expert_agg&#45;&gt;gpu7_layer4_res2</title>
<path fill="none" stroke="black" d="M4527,-15074.26C4527,-15065.31 4527,-15056.18 4527,-15047.78"/>
<polygon fill="black" stroke="black" points="4530.5,-15047.6 4527,-15037.6 4523.5,-15047.6 4530.5,-15047.6"/>
</g>
<!-- gpu7_layer5_ln1 -->
<g id="node1904" class="node">
<title>gpu7_layer5_ln1</title>
<polygon fill="lightblue" stroke="black" points="4588,-14948.47 4466,-14948.47 4466,-14896.47 4588,-14896.47 4588,-14948.47"/>
<text text-anchor="middle" x="4527" y="-14936.47" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="4527" y="-14925.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-14914.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-14903.47" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer4_res2&#45;&gt;gpu7_layer5_ln1 -->
<g id="edge2375" class="edge">
<title>gpu7_layer4_res2&#45;&gt;gpu7_layer5_ln1</title>
<path fill="none" stroke="black" d="M4527,-14985.31C4527,-14977.01 4527,-14967.62 4527,-14958.72"/>
<polygon fill="black" stroke="black" points="4530.5,-14958.58 4527,-14948.58 4523.5,-14958.58 4530.5,-14958.58"/>
</g>
<!-- gpu7_layer5_qkv -->
<g id="node1905" class="node">
<title>gpu7_layer5_qkv</title>
<polygon fill="lightblue" stroke="black" points="4588,-14859.47 4466,-14859.47 4466,-14807.47 4588,-14807.47 4588,-14859.47"/>
<text text-anchor="middle" x="4527" y="-14847.47" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4527" y="-14836.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-14825.47" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-14814.47" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer5_ln1&#45;&gt;gpu7_layer5_qkv -->
<g id="edge2376" class="edge">
<title>gpu7_layer5_ln1&#45;&gt;gpu7_layer5_qkv</title>
<path fill="none" stroke="black" d="M4527,-14896.31C4527,-14888.01 4527,-14878.62 4527,-14869.72"/>
<polygon fill="black" stroke="black" points="4530.5,-14869.58 4527,-14859.58 4523.5,-14869.58 4530.5,-14869.58"/>
</g>
<!-- gpu7_layer5_reshape -->
<g id="node1906" class="node">
<title>gpu7_layer5_reshape</title>
<polygon fill="lightblue" stroke="black" points="4591,-14770.47 4463,-14770.47 4463,-14718.47 4591,-14718.47 4591,-14770.47"/>
<text text-anchor="middle" x="4527" y="-14758.47" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="4527" y="-14747.47" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-14736.47" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-14725.47" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer5_qkv&#45;&gt;gpu7_layer5_reshape -->
<g id="edge2377" class="edge">
<title>gpu7_layer5_qkv&#45;&gt;gpu7_layer5_reshape</title>
<path fill="none" stroke="black" d="M4527,-14807.31C4527,-14799.01 4527,-14789.62 4527,-14780.72"/>
<polygon fill="black" stroke="black" points="4530.5,-14780.58 4527,-14770.58 4523.5,-14780.58 4530.5,-14780.58"/>
</g>
<!-- gpu7_layer5_attn -->
<g id="node1907" class="node">
<title>gpu7_layer5_attn</title>
<polygon fill="lightblue" stroke="black" points="4591,-14681.47 4463,-14681.47 4463,-14629.47 4591,-14629.47 4591,-14681.47"/>
<text text-anchor="middle" x="4527" y="-14669.47" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="4527" y="-14658.47" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-14647.47" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-14636.47" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer5_reshape&#45;&gt;gpu7_layer5_attn -->
<g id="edge2378" class="edge">
<title>gpu7_layer5_reshape&#45;&gt;gpu7_layer5_attn</title>
<path fill="none" stroke="black" d="M4527,-14718.31C4527,-14710.01 4527,-14700.62 4527,-14691.72"/>
<polygon fill="black" stroke="black" points="4530.5,-14691.58 4527,-14681.58 4523.5,-14691.58 4530.5,-14691.58"/>
</g>
<!-- gpu7_layer5_attn_reshape -->
<g id="node1909" class="node">
<title>gpu7_layer5_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="4588,-14592.47 4466,-14592.47 4466,-14540.47 4588,-14540.47 4588,-14592.47"/>
<text text-anchor="middle" x="4527" y="-14580.47" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="4527" y="-14569.47" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-14558.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-14547.47" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer5_attn&#45;&gt;gpu7_layer5_attn_reshape -->
<g id="edge2379" class="edge">
<title>gpu7_layer5_attn&#45;&gt;gpu7_layer5_attn_reshape</title>
<path fill="none" stroke="black" d="M4527,-14629.31C4527,-14621.01 4527,-14611.62 4527,-14602.72"/>
<polygon fill="black" stroke="black" points="4530.5,-14602.58 4527,-14592.58 4523.5,-14602.58 4530.5,-14602.58"/>
</g>
<!-- gpu7_layer5_attn_out -->
<g id="node1908" class="node">
<title>gpu7_layer5_attn_out</title>
<polygon fill="lightblue" stroke="black" points="4588,-14503.47 4466,-14503.47 4466,-14451.47 4588,-14451.47 4588,-14503.47"/>
<text text-anchor="middle" x="4527" y="-14491.47" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="4527" y="-14480.47" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-14469.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-14458.47" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer5_kv_update -->
<g id="node1910" class="node">
<title>gpu7_layer5_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="4527" cy="-14377.7" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="4527" y="-14391.7" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="4527" y="-14380.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-14369.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-14358.7" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer5_attn_out&#45;&gt;gpu7_layer5_kv_update -->
<g id="edge2381" class="edge">
<title>gpu7_layer5_attn_out&#45;&gt;gpu7_layer5_kv_update</title>
<path fill="none" stroke="black" d="M4527,-14451.29C4527,-14443.15 4527,-14433.86 4527,-14424.69"/>
<polygon fill="black" stroke="black" points="4530.5,-14424.48 4527,-14414.48 4523.5,-14424.48 4530.5,-14424.48"/>
</g>
<!-- gpu7_layer5_attn_reshape&#45;&gt;gpu7_layer5_attn_out -->
<g id="edge2380" class="edge">
<title>gpu7_layer5_attn_reshape&#45;&gt;gpu7_layer5_attn_out</title>
<path fill="none" stroke="black" d="M4527,-14540.31C4527,-14532.01 4527,-14522.62 4527,-14513.72"/>
<polygon fill="black" stroke="black" points="4530.5,-14513.58 4527,-14503.58 4523.5,-14513.58 4530.5,-14513.58"/>
</g>
<!-- gpu7_layer5_res1 -->
<g id="node1911" class="node">
<title>gpu7_layer5_res1</title>
<polygon fill="lightblue" stroke="black" points="4588,-14303.93 4466,-14303.93 4466,-14251.93 4588,-14251.93 4588,-14303.93"/>
<text text-anchor="middle" x="4527" y="-14291.93" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="4527" y="-14280.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-14269.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-14258.93" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer5_kv_update&#45;&gt;gpu7_layer5_res1 -->
<g id="edge2382" class="edge">
<title>gpu7_layer5_kv_update&#45;&gt;gpu7_layer5_res1</title>
<path fill="none" stroke="black" d="M4527,-14340.85C4527,-14332.17 4527,-14322.9 4527,-14314.25"/>
<polygon fill="black" stroke="black" points="4530.5,-14314.08 4527,-14304.08 4523.5,-14314.08 4530.5,-14314.08"/>
</g>
<!-- gpu7_layer5_ln2 -->
<g id="node1912" class="node">
<title>gpu7_layer5_ln2</title>
<polygon fill="lightblue" stroke="black" points="4588,-14214.93 4466,-14214.93 4466,-14162.93 4588,-14162.93 4588,-14214.93"/>
<text text-anchor="middle" x="4527" y="-14202.93" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="4527" y="-14191.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-14180.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-14169.93" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer5_res1&#45;&gt;gpu7_layer5_ln2 -->
<g id="edge2383" class="edge">
<title>gpu7_layer5_res1&#45;&gt;gpu7_layer5_ln2</title>
<path fill="none" stroke="black" d="M4527,-14251.77C4527,-14243.47 4527,-14234.08 4527,-14225.18"/>
<polygon fill="black" stroke="black" points="4530.5,-14225.04 4527,-14215.04 4523.5,-14225.04 4530.5,-14225.04"/>
</g>
<!-- gpu7_layer5_routing -->
<g id="node1913" class="node">
<title>gpu7_layer5_routing</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-14125.93 4452.29,-14125.93 4400.53,-13999.93 4601.71,-13999.93 4653.47,-14125.93"/>
<text text-anchor="middle" x="4527" y="-14082.43" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="4527" y="-14071.43" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-14060.43" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-14049.43" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="4527" y="-14038.43" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer5_ln2&#45;&gt;gpu7_layer5_routing -->
<g id="edge2384" class="edge">
<title>gpu7_layer5_ln2&#45;&gt;gpu7_layer5_routing</title>
<path fill="none" stroke="black" d="M4527,-14162.84C4527,-14154.91 4527,-14145.71 4527,-14136.18"/>
<polygon fill="black" stroke="black" points="4530.5,-14136.17 4527,-14126.17 4523.5,-14136.17 4530.5,-14136.17"/>
</g>
<!-- gpu7_layer5_expert0 -->
<g id="node1914" class="node">
<title>gpu7_layer5_expert0</title>
<polygon fill="lightblue" stroke="black" points="4308,-13953.93 4186,-13953.93 4186,-13901.93 4308,-13901.93 4308,-13953.93"/>
<text text-anchor="middle" x="4247" y="-13941.93" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="4247" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer5_routing&#45;&gt;gpu7_layer5_expert0 -->
<g id="edge2371" class="edge">
<title>gpu7_layer5_routing&#45;&gt;gpu7_layer5_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4401.33,-14002.24C4369.34,-13987.04 4336.34,-13971.37 4309.11,-13958.43"/>
<polygon fill="black" stroke="black" points="4310.26,-13955.1 4299.73,-13953.98 4307.26,-13961.43 4310.26,-13955.1"/>
<text text-anchor="middle" x="4382.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer5_expert1 -->
<g id="node1915" class="node">
<title>gpu7_layer5_expert1</title>
<polygon fill="lightblue" stroke="black" points="4448,-13953.93 4326,-13953.93 4326,-13901.93 4448,-13901.93 4448,-13953.93"/>
<text text-anchor="middle" x="4387" y="-13941.93" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="4387" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer5_routing&#45;&gt;gpu7_layer5_expert1 -->
<g id="edge2372" class="edge">
<title>gpu7_layer5_routing&#45;&gt;gpu7_layer5_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4461.51,-13999.71C4447.48,-13986.39 4433.21,-13972.83 4420.97,-13961.2"/>
<polygon fill="black" stroke="black" points="4423.29,-13958.57 4413.63,-13954.22 4418.46,-13963.65 4423.29,-13958.57"/>
<text text-anchor="middle" x="4469.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer5_expert2 -->
<g id="node1916" class="node">
<title>gpu7_layer5_expert2</title>
<polygon fill="lightblue" stroke="black" points="4588,-13953.93 4466,-13953.93 4466,-13901.93 4588,-13901.93 4588,-13953.93"/>
<text text-anchor="middle" x="4527" y="-13941.93" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="4527" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer5_routing&#45;&gt;gpu7_layer5_expert2 -->
<g id="edge2373" class="edge">
<title>gpu7_layer5_routing&#45;&gt;gpu7_layer5_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4527,-13999.71C4527,-13987.65 4527,-13975.39 4527,-13964.54"/>
<polygon fill="black" stroke="black" points="4530.5,-13964.22 4527,-13954.22 4523.5,-13964.22 4530.5,-13964.22"/>
<text text-anchor="middle" x="4556.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer5_expert3 -->
<g id="node1917" class="node">
<title>gpu7_layer5_expert3</title>
<polygon fill="lightblue" stroke="black" points="4728,-13953.93 4606,-13953.93 4606,-13901.93 4728,-13901.93 4728,-13953.93"/>
<text text-anchor="middle" x="4667" y="-13941.93" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4667" y="-13930.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-13919.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-13908.93" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer5_routing&#45;&gt;gpu7_layer5_expert3 -->
<g id="edge2374" class="edge">
<title>gpu7_layer5_routing&#45;&gt;gpu7_layer5_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4592.49,-13999.71C4606.52,-13986.39 4620.79,-13972.83 4633.03,-13961.2"/>
<polygon fill="black" stroke="black" points="4635.54,-13963.65 4640.37,-13954.22 4630.71,-13958.57 4635.54,-13963.65"/>
<text text-anchor="middle" x="4650.5" y="-13974.73" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer5_expert_agg -->
<g id="node1918" class="node">
<title>gpu7_layer5_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-13864.93 4452.29,-13864.93 4400.53,-13760.93 4601.71,-13760.93 4653.47,-13864.93"/>
<text text-anchor="middle" x="4527" y="-13826.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="4527" y="-13815.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-13804.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-13793.93" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer5_routing&#45;&gt;gpu7_layer5_expert_agg -->
<g id="edge2389" class="edge">
<title>gpu7_layer5_routing&#45;&gt;gpu7_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M4616.22,-14035.01C4689.96,-14007.85 4776.6,-13961.46 4737,-13901.93 4716.44,-13871.02 4682.7,-13850.94 4648.22,-13837.91"/>
<polygon fill="black" stroke="black" points="4649.08,-13834.5 4638.48,-13834.42 4646.71,-13841.09 4649.08,-13834.5"/>
</g>
<!-- gpu7_layer5_expert0&#45;&gt;gpu7_layer5_expert_agg -->
<g id="edge2385" class="edge">
<title>gpu7_layer5_expert0&#45;&gt;gpu7_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M4308.1,-13902.27C4344.98,-13887.39 4392.7,-13868.13 4434.16,-13851.4"/>
<polygon fill="black" stroke="black" points="4435.5,-13854.63 4443.46,-13847.65 4432.88,-13848.14 4435.5,-13854.63"/>
</g>
<!-- gpu7_layer5_expert1&#45;&gt;gpu7_layer5_expert_agg -->
<g id="edge2386" class="edge">
<title>gpu7_layer5_expert1&#45;&gt;gpu7_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M4418.07,-13901.85C4429.32,-13892.77 4442.53,-13882.11 4455.8,-13871.4"/>
<polygon fill="black" stroke="black" points="4458.02,-13874.11 4463.6,-13865.1 4453.62,-13868.66 4458.02,-13874.11"/>
</g>
<!-- gpu7_layer5_expert2&#45;&gt;gpu7_layer5_expert_agg -->
<g id="edge2387" class="edge">
<title>gpu7_layer5_expert2&#45;&gt;gpu7_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M4527,-13901.85C4527,-13893.93 4527,-13884.79 4527,-13875.47"/>
<polygon fill="black" stroke="black" points="4530.5,-13875.33 4527,-13865.33 4523.5,-13875.33 4530.5,-13875.33"/>
</g>
<!-- gpu7_layer5_expert3&#45;&gt;gpu7_layer5_expert_agg -->
<g id="edge2388" class="edge">
<title>gpu7_layer5_expert3&#45;&gt;gpu7_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M4635.93,-13901.85C4624.68,-13892.77 4611.47,-13882.11 4598.2,-13871.4"/>
<polygon fill="black" stroke="black" points="4600.38,-13868.66 4590.4,-13865.1 4595.98,-13874.11 4600.38,-13868.66"/>
</g>
<!-- gpu7_layer5_res2 -->
<g id="node1919" class="node">
<title>gpu7_layer5_res2</title>
<polygon fill="lightblue" stroke="black" points="4588,-13723.93 4466,-13723.93 4466,-13671.93 4588,-13671.93 4588,-13723.93"/>
<text text-anchor="middle" x="4527" y="-13711.93" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="4527" y="-13700.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-13689.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-13678.93" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer5_expert_agg&#45;&gt;gpu7_layer5_res2 -->
<g id="edge2390" class="edge">
<title>gpu7_layer5_expert_agg&#45;&gt;gpu7_layer5_res2</title>
<path fill="none" stroke="black" d="M4527,-13760.72C4527,-13751.77 4527,-13742.64 4527,-13734.24"/>
<polygon fill="black" stroke="black" points="4530.5,-13734.06 4527,-13724.06 4523.5,-13734.06 4530.5,-13734.06"/>
</g>
<!-- gpu7_layer6_ln1 -->
<g id="node1920" class="node">
<title>gpu7_layer6_ln1</title>
<polygon fill="lightblue" stroke="black" points="4588,-13634.93 4466,-13634.93 4466,-13582.93 4588,-13582.93 4588,-13634.93"/>
<text text-anchor="middle" x="4527" y="-13622.93" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="4527" y="-13611.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-13600.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-13589.93" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer5_res2&#45;&gt;gpu7_layer6_ln1 -->
<g id="edge2395" class="edge">
<title>gpu7_layer5_res2&#45;&gt;gpu7_layer6_ln1</title>
<path fill="none" stroke="black" d="M4527,-13671.77C4527,-13663.47 4527,-13654.08 4527,-13645.18"/>
<polygon fill="black" stroke="black" points="4530.5,-13645.04 4527,-13635.04 4523.5,-13645.04 4530.5,-13645.04"/>
</g>
<!-- gpu7_layer6_qkv -->
<g id="node1921" class="node">
<title>gpu7_layer6_qkv</title>
<polygon fill="lightblue" stroke="black" points="4588,-13545.93 4466,-13545.93 4466,-13493.93 4588,-13493.93 4588,-13545.93"/>
<text text-anchor="middle" x="4527" y="-13533.93" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4527" y="-13522.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-13511.93" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-13500.93" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer6_ln1&#45;&gt;gpu7_layer6_qkv -->
<g id="edge2396" class="edge">
<title>gpu7_layer6_ln1&#45;&gt;gpu7_layer6_qkv</title>
<path fill="none" stroke="black" d="M4527,-13582.77C4527,-13574.47 4527,-13565.08 4527,-13556.18"/>
<polygon fill="black" stroke="black" points="4530.5,-13556.04 4527,-13546.04 4523.5,-13556.04 4530.5,-13556.04"/>
</g>
<!-- gpu7_layer6_reshape -->
<g id="node1922" class="node">
<title>gpu7_layer6_reshape</title>
<polygon fill="lightblue" stroke="black" points="4591,-13456.93 4463,-13456.93 4463,-13404.93 4591,-13404.93 4591,-13456.93"/>
<text text-anchor="middle" x="4527" y="-13444.93" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="4527" y="-13433.93" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-13422.93" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-13411.93" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer6_qkv&#45;&gt;gpu7_layer6_reshape -->
<g id="edge2397" class="edge">
<title>gpu7_layer6_qkv&#45;&gt;gpu7_layer6_reshape</title>
<path fill="none" stroke="black" d="M4527,-13493.77C4527,-13485.47 4527,-13476.08 4527,-13467.18"/>
<polygon fill="black" stroke="black" points="4530.5,-13467.04 4527,-13457.04 4523.5,-13467.04 4530.5,-13467.04"/>
</g>
<!-- gpu7_layer6_attn -->
<g id="node1923" class="node">
<title>gpu7_layer6_attn</title>
<polygon fill="lightblue" stroke="black" points="4591,-13367.93 4463,-13367.93 4463,-13315.93 4591,-13315.93 4591,-13367.93"/>
<text text-anchor="middle" x="4527" y="-13355.93" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="4527" y="-13344.93" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-13333.93" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-13322.93" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer6_reshape&#45;&gt;gpu7_layer6_attn -->
<g id="edge2398" class="edge">
<title>gpu7_layer6_reshape&#45;&gt;gpu7_layer6_attn</title>
<path fill="none" stroke="black" d="M4527,-13404.77C4527,-13396.47 4527,-13387.08 4527,-13378.18"/>
<polygon fill="black" stroke="black" points="4530.5,-13378.04 4527,-13368.04 4523.5,-13378.04 4530.5,-13378.04"/>
</g>
<!-- gpu7_layer6_attn_reshape -->
<g id="node1925" class="node">
<title>gpu7_layer6_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="4588,-13278.93 4466,-13278.93 4466,-13226.93 4588,-13226.93 4588,-13278.93"/>
<text text-anchor="middle" x="4527" y="-13266.93" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="4527" y="-13255.93" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-13244.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-13233.93" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer6_attn&#45;&gt;gpu7_layer6_attn_reshape -->
<g id="edge2399" class="edge">
<title>gpu7_layer6_attn&#45;&gt;gpu7_layer6_attn_reshape</title>
<path fill="none" stroke="black" d="M4527,-13315.77C4527,-13307.47 4527,-13298.08 4527,-13289.18"/>
<polygon fill="black" stroke="black" points="4530.5,-13289.04 4527,-13279.04 4523.5,-13289.04 4530.5,-13289.04"/>
</g>
<!-- gpu7_layer6_attn_out -->
<g id="node1924" class="node">
<title>gpu7_layer6_attn_out</title>
<polygon fill="lightblue" stroke="black" points="4588,-13189.93 4466,-13189.93 4466,-13137.93 4588,-13137.93 4588,-13189.93"/>
<text text-anchor="middle" x="4527" y="-13177.93" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="4527" y="-13166.93" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-13155.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-13144.93" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer6_kv_update -->
<g id="node1926" class="node">
<title>gpu7_layer6_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="4527" cy="-13064.16" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="4527" y="-13078.16" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="4527" y="-13067.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-13056.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-13045.16" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer6_attn_out&#45;&gt;gpu7_layer6_kv_update -->
<g id="edge2401" class="edge">
<title>gpu7_layer6_attn_out&#45;&gt;gpu7_layer6_kv_update</title>
<path fill="none" stroke="black" d="M4527,-13137.75C4527,-13129.61 4527,-13120.32 4527,-13111.16"/>
<polygon fill="black" stroke="black" points="4530.5,-13110.94 4527,-13100.94 4523.5,-13110.94 4530.5,-13110.94"/>
</g>
<!-- gpu7_layer6_attn_reshape&#45;&gt;gpu7_layer6_attn_out -->
<g id="edge2400" class="edge">
<title>gpu7_layer6_attn_reshape&#45;&gt;gpu7_layer6_attn_out</title>
<path fill="none" stroke="black" d="M4527,-13226.77C4527,-13218.47 4527,-13209.08 4527,-13200.18"/>
<polygon fill="black" stroke="black" points="4530.5,-13200.04 4527,-13190.04 4523.5,-13200.04 4530.5,-13200.04"/>
</g>
<!-- gpu7_layer6_res1 -->
<g id="node1927" class="node">
<title>gpu7_layer6_res1</title>
<polygon fill="lightblue" stroke="black" points="4588,-12990.39 4466,-12990.39 4466,-12938.39 4588,-12938.39 4588,-12990.39"/>
<text text-anchor="middle" x="4527" y="-12978.39" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="4527" y="-12967.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-12956.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-12945.39" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer6_kv_update&#45;&gt;gpu7_layer6_res1 -->
<g id="edge2402" class="edge">
<title>gpu7_layer6_kv_update&#45;&gt;gpu7_layer6_res1</title>
<path fill="none" stroke="black" d="M4527,-13027.31C4527,-13018.63 4527,-13009.36 4527,-13000.71"/>
<polygon fill="black" stroke="black" points="4530.5,-13000.54 4527,-12990.54 4523.5,-13000.54 4530.5,-13000.54"/>
</g>
<!-- gpu7_layer6_ln2 -->
<g id="node1928" class="node">
<title>gpu7_layer6_ln2</title>
<polygon fill="lightblue" stroke="black" points="4588,-12901.39 4466,-12901.39 4466,-12849.39 4588,-12849.39 4588,-12901.39"/>
<text text-anchor="middle" x="4527" y="-12889.39" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="4527" y="-12878.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-12867.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-12856.39" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer6_res1&#45;&gt;gpu7_layer6_ln2 -->
<g id="edge2403" class="edge">
<title>gpu7_layer6_res1&#45;&gt;gpu7_layer6_ln2</title>
<path fill="none" stroke="black" d="M4527,-12938.23C4527,-12929.93 4527,-12920.55 4527,-12911.64"/>
<polygon fill="black" stroke="black" points="4530.5,-12911.5 4527,-12901.5 4523.5,-12911.5 4530.5,-12911.5"/>
</g>
<!-- gpu7_layer6_routing -->
<g id="node1929" class="node">
<title>gpu7_layer6_routing</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-12812.39 4452.29,-12812.39 4400.53,-12686.39 4601.71,-12686.39 4653.47,-12812.39"/>
<text text-anchor="middle" x="4527" y="-12768.89" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="4527" y="-12757.89" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-12746.89" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-12735.89" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="4527" y="-12724.89" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer6_ln2&#45;&gt;gpu7_layer6_routing -->
<g id="edge2404" class="edge">
<title>gpu7_layer6_ln2&#45;&gt;gpu7_layer6_routing</title>
<path fill="none" stroke="black" d="M4527,-12849.3C4527,-12841.37 4527,-12832.17 4527,-12822.64"/>
<polygon fill="black" stroke="black" points="4530.5,-12822.63 4527,-12812.63 4523.5,-12822.63 4530.5,-12822.63"/>
</g>
<!-- gpu7_layer6_expert0 -->
<g id="node1930" class="node">
<title>gpu7_layer6_expert0</title>
<polygon fill="lightblue" stroke="black" points="4308,-12640.39 4186,-12640.39 4186,-12588.39 4308,-12588.39 4308,-12640.39"/>
<text text-anchor="middle" x="4247" y="-12628.39" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="4247" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer6_routing&#45;&gt;gpu7_layer6_expert0 -->
<g id="edge2391" class="edge">
<title>gpu7_layer6_routing&#45;&gt;gpu7_layer6_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4401.33,-12688.7C4369.34,-12673.5 4336.34,-12657.83 4309.11,-12644.89"/>
<polygon fill="black" stroke="black" points="4310.26,-12641.57 4299.73,-12640.44 4307.26,-12647.89 4310.26,-12641.57"/>
<text text-anchor="middle" x="4382.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer6_expert1 -->
<g id="node1931" class="node">
<title>gpu7_layer6_expert1</title>
<polygon fill="lightblue" stroke="black" points="4448,-12640.39 4326,-12640.39 4326,-12588.39 4448,-12588.39 4448,-12640.39"/>
<text text-anchor="middle" x="4387" y="-12628.39" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="4387" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer6_routing&#45;&gt;gpu7_layer6_expert1 -->
<g id="edge2392" class="edge">
<title>gpu7_layer6_routing&#45;&gt;gpu7_layer6_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4461.51,-12686.17C4447.48,-12672.85 4433.21,-12659.29 4420.97,-12647.66"/>
<polygon fill="black" stroke="black" points="4423.29,-12645.03 4413.63,-12640.68 4418.46,-12650.11 4423.29,-12645.03"/>
<text text-anchor="middle" x="4469.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer6_expert2 -->
<g id="node1932" class="node">
<title>gpu7_layer6_expert2</title>
<polygon fill="lightblue" stroke="black" points="4588,-12640.39 4466,-12640.39 4466,-12588.39 4588,-12588.39 4588,-12640.39"/>
<text text-anchor="middle" x="4527" y="-12628.39" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="4527" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer6_routing&#45;&gt;gpu7_layer6_expert2 -->
<g id="edge2393" class="edge">
<title>gpu7_layer6_routing&#45;&gt;gpu7_layer6_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4527,-12686.17C4527,-12674.11 4527,-12661.85 4527,-12651"/>
<polygon fill="black" stroke="black" points="4530.5,-12650.68 4527,-12640.68 4523.5,-12650.68 4530.5,-12650.68"/>
<text text-anchor="middle" x="4556.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer6_expert3 -->
<g id="node1933" class="node">
<title>gpu7_layer6_expert3</title>
<polygon fill="lightblue" stroke="black" points="4728,-12640.39 4606,-12640.39 4606,-12588.39 4728,-12588.39 4728,-12640.39"/>
<text text-anchor="middle" x="4667" y="-12628.39" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4667" y="-12617.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-12606.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-12595.39" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer6_routing&#45;&gt;gpu7_layer6_expert3 -->
<g id="edge2394" class="edge">
<title>gpu7_layer6_routing&#45;&gt;gpu7_layer6_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4592.49,-12686.17C4606.52,-12672.85 4620.79,-12659.29 4633.03,-12647.66"/>
<polygon fill="black" stroke="black" points="4635.54,-12650.11 4640.37,-12640.68 4630.71,-12645.03 4635.54,-12650.11"/>
<text text-anchor="middle" x="4650.5" y="-12661.19" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer6_expert_agg -->
<g id="node1934" class="node">
<title>gpu7_layer6_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-12551.39 4452.29,-12551.39 4400.53,-12447.39 4601.71,-12447.39 4653.47,-12551.39"/>
<text text-anchor="middle" x="4527" y="-12513.39" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="4527" y="-12502.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-12491.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-12480.39" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer6_routing&#45;&gt;gpu7_layer6_expert_agg -->
<g id="edge2409" class="edge">
<title>gpu7_layer6_routing&#45;&gt;gpu7_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M4616.22,-12721.47C4689.96,-12694.32 4776.6,-12647.92 4737,-12588.39 4716.44,-12557.48 4682.7,-12537.4 4648.22,-12524.38"/>
<polygon fill="black" stroke="black" points="4649.08,-12520.97 4638.48,-12520.88 4646.71,-12527.55 4649.08,-12520.97"/>
</g>
<!-- gpu7_layer6_expert0&#45;&gt;gpu7_layer6_expert_agg -->
<g id="edge2405" class="edge">
<title>gpu7_layer6_expert0&#45;&gt;gpu7_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M4308.1,-12588.73C4344.98,-12573.85 4392.7,-12554.59 4434.16,-12537.86"/>
<polygon fill="black" stroke="black" points="4435.5,-12541.09 4443.46,-12534.11 4432.88,-12534.6 4435.5,-12541.09"/>
</g>
<!-- gpu7_layer6_expert1&#45;&gt;gpu7_layer6_expert_agg -->
<g id="edge2406" class="edge">
<title>gpu7_layer6_expert1&#45;&gt;gpu7_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M4418.07,-12588.31C4429.32,-12579.24 4442.53,-12568.57 4455.8,-12557.86"/>
<polygon fill="black" stroke="black" points="4458.02,-12560.57 4463.6,-12551.56 4453.62,-12555.12 4458.02,-12560.57"/>
</g>
<!-- gpu7_layer6_expert2&#45;&gt;gpu7_layer6_expert_agg -->
<g id="edge2407" class="edge">
<title>gpu7_layer6_expert2&#45;&gt;gpu7_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M4527,-12588.31C4527,-12580.39 4527,-12571.25 4527,-12561.93"/>
<polygon fill="black" stroke="black" points="4530.5,-12561.79 4527,-12551.79 4523.5,-12561.79 4530.5,-12561.79"/>
</g>
<!-- gpu7_layer6_expert3&#45;&gt;gpu7_layer6_expert_agg -->
<g id="edge2408" class="edge">
<title>gpu7_layer6_expert3&#45;&gt;gpu7_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M4635.93,-12588.31C4624.68,-12579.24 4611.47,-12568.57 4598.2,-12557.86"/>
<polygon fill="black" stroke="black" points="4600.38,-12555.12 4590.4,-12551.56 4595.98,-12560.57 4600.38,-12555.12"/>
</g>
<!-- gpu7_layer6_res2 -->
<g id="node1935" class="node">
<title>gpu7_layer6_res2</title>
<polygon fill="lightblue" stroke="black" points="4588,-12410.39 4466,-12410.39 4466,-12358.39 4588,-12358.39 4588,-12410.39"/>
<text text-anchor="middle" x="4527" y="-12398.39" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="4527" y="-12387.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-12376.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-12365.39" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer6_expert_agg&#45;&gt;gpu7_layer6_res2 -->
<g id="edge2410" class="edge">
<title>gpu7_layer6_expert_agg&#45;&gt;gpu7_layer6_res2</title>
<path fill="none" stroke="black" d="M4527,-12447.18C4527,-12438.23 4527,-12429.1 4527,-12420.7"/>
<polygon fill="black" stroke="black" points="4530.5,-12420.52 4527,-12410.52 4523.5,-12420.52 4530.5,-12420.52"/>
</g>
<!-- gpu7_layer7_ln1 -->
<g id="node1936" class="node">
<title>gpu7_layer7_ln1</title>
<polygon fill="lightblue" stroke="black" points="4588,-12321.39 4466,-12321.39 4466,-12269.39 4588,-12269.39 4588,-12321.39"/>
<text text-anchor="middle" x="4527" y="-12309.39" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="4527" y="-12298.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-12287.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-12276.39" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer6_res2&#45;&gt;gpu7_layer7_ln1 -->
<g id="edge2415" class="edge">
<title>gpu7_layer6_res2&#45;&gt;gpu7_layer7_ln1</title>
<path fill="none" stroke="black" d="M4527,-12358.23C4527,-12349.93 4527,-12340.55 4527,-12331.64"/>
<polygon fill="black" stroke="black" points="4530.5,-12331.5 4527,-12321.5 4523.5,-12331.5 4530.5,-12331.5"/>
</g>
<!-- gpu7_layer7_qkv -->
<g id="node1937" class="node">
<title>gpu7_layer7_qkv</title>
<polygon fill="lightblue" stroke="black" points="4588,-12232.39 4466,-12232.39 4466,-12180.39 4588,-12180.39 4588,-12232.39"/>
<text text-anchor="middle" x="4527" y="-12220.39" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4527" y="-12209.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-12198.39" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-12187.39" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer7_ln1&#45;&gt;gpu7_layer7_qkv -->
<g id="edge2416" class="edge">
<title>gpu7_layer7_ln1&#45;&gt;gpu7_layer7_qkv</title>
<path fill="none" stroke="black" d="M4527,-12269.23C4527,-12260.93 4527,-12251.55 4527,-12242.64"/>
<polygon fill="black" stroke="black" points="4530.5,-12242.5 4527,-12232.5 4523.5,-12242.5 4530.5,-12242.5"/>
</g>
<!-- gpu7_layer7_reshape -->
<g id="node1938" class="node">
<title>gpu7_layer7_reshape</title>
<polygon fill="lightblue" stroke="black" points="4591,-12143.39 4463,-12143.39 4463,-12091.39 4591,-12091.39 4591,-12143.39"/>
<text text-anchor="middle" x="4527" y="-12131.39" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="4527" y="-12120.39" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-12109.39" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-12098.39" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer7_qkv&#45;&gt;gpu7_layer7_reshape -->
<g id="edge2417" class="edge">
<title>gpu7_layer7_qkv&#45;&gt;gpu7_layer7_reshape</title>
<path fill="none" stroke="black" d="M4527,-12180.23C4527,-12171.93 4527,-12162.55 4527,-12153.64"/>
<polygon fill="black" stroke="black" points="4530.5,-12153.5 4527,-12143.5 4523.5,-12153.5 4530.5,-12153.5"/>
</g>
<!-- gpu7_layer7_attn -->
<g id="node1939" class="node">
<title>gpu7_layer7_attn</title>
<polygon fill="lightblue" stroke="black" points="4591,-12054.39 4463,-12054.39 4463,-12002.39 4591,-12002.39 4591,-12054.39"/>
<text text-anchor="middle" x="4527" y="-12042.39" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="4527" y="-12031.39" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-12020.39" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-12009.39" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer7_reshape&#45;&gt;gpu7_layer7_attn -->
<g id="edge2418" class="edge">
<title>gpu7_layer7_reshape&#45;&gt;gpu7_layer7_attn</title>
<path fill="none" stroke="black" d="M4527,-12091.23C4527,-12082.93 4527,-12073.55 4527,-12064.64"/>
<polygon fill="black" stroke="black" points="4530.5,-12064.5 4527,-12054.5 4523.5,-12064.5 4530.5,-12064.5"/>
</g>
<!-- gpu7_layer7_attn_reshape -->
<g id="node1941" class="node">
<title>gpu7_layer7_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="4588,-11965.39 4466,-11965.39 4466,-11913.39 4588,-11913.39 4588,-11965.39"/>
<text text-anchor="middle" x="4527" y="-11953.39" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="4527" y="-11942.39" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-11931.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-11920.39" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer7_attn&#45;&gt;gpu7_layer7_attn_reshape -->
<g id="edge2419" class="edge">
<title>gpu7_layer7_attn&#45;&gt;gpu7_layer7_attn_reshape</title>
<path fill="none" stroke="black" d="M4527,-12002.23C4527,-11993.93 4527,-11984.55 4527,-11975.64"/>
<polygon fill="black" stroke="black" points="4530.5,-11975.5 4527,-11965.5 4523.5,-11975.5 4530.5,-11975.5"/>
</g>
<!-- gpu7_layer7_attn_out -->
<g id="node1940" class="node">
<title>gpu7_layer7_attn_out</title>
<polygon fill="lightblue" stroke="black" points="4588,-11876.39 4466,-11876.39 4466,-11824.39 4588,-11824.39 4588,-11876.39"/>
<text text-anchor="middle" x="4527" y="-11864.39" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="4527" y="-11853.39" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-11842.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-11831.39" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer7_kv_update -->
<g id="node1942" class="node">
<title>gpu7_layer7_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="4527" cy="-11750.62" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="4527" y="-11764.62" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="4527" y="-11753.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-11742.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-11731.62" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer7_attn_out&#45;&gt;gpu7_layer7_kv_update -->
<g id="edge2421" class="edge">
<title>gpu7_layer7_attn_out&#45;&gt;gpu7_layer7_kv_update</title>
<path fill="none" stroke="black" d="M4527,-11824.21C4527,-11816.07 4527,-11806.78 4527,-11797.62"/>
<polygon fill="black" stroke="black" points="4530.5,-11797.4 4527,-11787.4 4523.5,-11797.4 4530.5,-11797.4"/>
</g>
<!-- gpu7_layer7_attn_reshape&#45;&gt;gpu7_layer7_attn_out -->
<g id="edge2420" class="edge">
<title>gpu7_layer7_attn_reshape&#45;&gt;gpu7_layer7_attn_out</title>
<path fill="none" stroke="black" d="M4527,-11913.23C4527,-11904.93 4527,-11895.55 4527,-11886.64"/>
<polygon fill="black" stroke="black" points="4530.5,-11886.5 4527,-11876.5 4523.5,-11886.5 4530.5,-11886.5"/>
</g>
<!-- gpu7_layer7_res1 -->
<g id="node1943" class="node">
<title>gpu7_layer7_res1</title>
<polygon fill="lightblue" stroke="black" points="4588,-11676.85 4466,-11676.85 4466,-11624.85 4588,-11624.85 4588,-11676.85"/>
<text text-anchor="middle" x="4527" y="-11664.85" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="4527" y="-11653.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-11642.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-11631.85" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer7_kv_update&#45;&gt;gpu7_layer7_res1 -->
<g id="edge2422" class="edge">
<title>gpu7_layer7_kv_update&#45;&gt;gpu7_layer7_res1</title>
<path fill="none" stroke="black" d="M4527,-11713.77C4527,-11705.09 4527,-11695.82 4527,-11687.17"/>
<polygon fill="black" stroke="black" points="4530.5,-11687 4527,-11677 4523.5,-11687 4530.5,-11687"/>
</g>
<!-- gpu7_layer7_ln2 -->
<g id="node1944" class="node">
<title>gpu7_layer7_ln2</title>
<polygon fill="lightblue" stroke="black" points="4588,-11587.85 4466,-11587.85 4466,-11535.85 4588,-11535.85 4588,-11587.85"/>
<text text-anchor="middle" x="4527" y="-11575.85" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="4527" y="-11564.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-11553.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-11542.85" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer7_res1&#45;&gt;gpu7_layer7_ln2 -->
<g id="edge2423" class="edge">
<title>gpu7_layer7_res1&#45;&gt;gpu7_layer7_ln2</title>
<path fill="none" stroke="black" d="M4527,-11624.69C4527,-11616.39 4527,-11607.01 4527,-11598.1"/>
<polygon fill="black" stroke="black" points="4530.5,-11597.96 4527,-11587.96 4523.5,-11597.96 4530.5,-11597.96"/>
</g>
<!-- gpu7_layer7_routing -->
<g id="node1945" class="node">
<title>gpu7_layer7_routing</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-11498.85 4452.29,-11498.85 4400.53,-11372.85 4601.71,-11372.85 4653.47,-11498.85"/>
<text text-anchor="middle" x="4527" y="-11455.35" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="4527" y="-11444.35" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-11433.35" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-11422.35" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="4527" y="-11411.35" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer7_ln2&#45;&gt;gpu7_layer7_routing -->
<g id="edge2424" class="edge">
<title>gpu7_layer7_ln2&#45;&gt;gpu7_layer7_routing</title>
<path fill="none" stroke="black" d="M4527,-11535.76C4527,-11527.83 4527,-11518.63 4527,-11509.1"/>
<polygon fill="black" stroke="black" points="4530.5,-11509.09 4527,-11499.09 4523.5,-11509.09 4530.5,-11509.09"/>
</g>
<!-- gpu7_layer7_expert0 -->
<g id="node1946" class="node">
<title>gpu7_layer7_expert0</title>
<polygon fill="lightblue" stroke="black" points="4308,-11326.85 4186,-11326.85 4186,-11274.85 4308,-11274.85 4308,-11326.85"/>
<text text-anchor="middle" x="4247" y="-11314.85" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="4247" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer7_routing&#45;&gt;gpu7_layer7_expert0 -->
<g id="edge2411" class="edge">
<title>gpu7_layer7_routing&#45;&gt;gpu7_layer7_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4401.33,-11375.16C4369.34,-11359.96 4336.34,-11344.29 4309.11,-11331.35"/>
<polygon fill="black" stroke="black" points="4310.26,-11328.03 4299.73,-11326.9 4307.26,-11334.35 4310.26,-11328.03"/>
<text text-anchor="middle" x="4382.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer7_expert1 -->
<g id="node1947" class="node">
<title>gpu7_layer7_expert1</title>
<polygon fill="lightblue" stroke="black" points="4448,-11326.85 4326,-11326.85 4326,-11274.85 4448,-11274.85 4448,-11326.85"/>
<text text-anchor="middle" x="4387" y="-11314.85" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="4387" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer7_routing&#45;&gt;gpu7_layer7_expert1 -->
<g id="edge2412" class="edge">
<title>gpu7_layer7_routing&#45;&gt;gpu7_layer7_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4461.51,-11372.64C4447.48,-11359.31 4433.21,-11345.76 4420.97,-11334.12"/>
<polygon fill="black" stroke="black" points="4423.29,-11331.5 4413.63,-11327.15 4418.46,-11336.57 4423.29,-11331.5"/>
<text text-anchor="middle" x="4469.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer7_expert2 -->
<g id="node1948" class="node">
<title>gpu7_layer7_expert2</title>
<polygon fill="lightblue" stroke="black" points="4588,-11326.85 4466,-11326.85 4466,-11274.85 4588,-11274.85 4588,-11326.85"/>
<text text-anchor="middle" x="4527" y="-11314.85" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="4527" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer7_routing&#45;&gt;gpu7_layer7_expert2 -->
<g id="edge2413" class="edge">
<title>gpu7_layer7_routing&#45;&gt;gpu7_layer7_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4527,-11372.64C4527,-11360.57 4527,-11348.31 4527,-11337.46"/>
<polygon fill="black" stroke="black" points="4530.5,-11337.15 4527,-11327.15 4523.5,-11337.15 4530.5,-11337.15"/>
<text text-anchor="middle" x="4556.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer7_expert3 -->
<g id="node1949" class="node">
<title>gpu7_layer7_expert3</title>
<polygon fill="lightblue" stroke="black" points="4728,-11326.85 4606,-11326.85 4606,-11274.85 4728,-11274.85 4728,-11326.85"/>
<text text-anchor="middle" x="4667" y="-11314.85" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4667" y="-11303.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-11292.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-11281.85" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer7_routing&#45;&gt;gpu7_layer7_expert3 -->
<g id="edge2414" class="edge">
<title>gpu7_layer7_routing&#45;&gt;gpu7_layer7_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4592.49,-11372.64C4606.52,-11359.31 4620.79,-11345.76 4633.03,-11334.12"/>
<polygon fill="black" stroke="black" points="4635.54,-11336.57 4640.37,-11327.15 4630.71,-11331.5 4635.54,-11336.57"/>
<text text-anchor="middle" x="4650.5" y="-11347.65" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer7_expert_agg -->
<g id="node1950" class="node">
<title>gpu7_layer7_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-11237.85 4452.29,-11237.85 4400.53,-11133.85 4601.71,-11133.85 4653.47,-11237.85"/>
<text text-anchor="middle" x="4527" y="-11199.85" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="4527" y="-11188.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-11177.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-11166.85" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer7_routing&#45;&gt;gpu7_layer7_expert_agg -->
<g id="edge2429" class="edge">
<title>gpu7_layer7_routing&#45;&gt;gpu7_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M4616.22,-11407.94C4689.96,-11380.78 4776.6,-11334.39 4737,-11274.85 4716.44,-11243.94 4682.7,-11223.87 4648.22,-11210.84"/>
<polygon fill="black" stroke="black" points="4649.08,-11207.43 4638.48,-11207.35 4646.71,-11214.02 4649.08,-11207.43"/>
</g>
<!-- gpu7_layer7_expert0&#45;&gt;gpu7_layer7_expert_agg -->
<g id="edge2425" class="edge">
<title>gpu7_layer7_expert0&#45;&gt;gpu7_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M4308.1,-11275.19C4344.98,-11260.31 4392.7,-11241.05 4434.16,-11224.32"/>
<polygon fill="black" stroke="black" points="4435.5,-11227.56 4443.46,-11220.57 4432.88,-11221.06 4435.5,-11227.56"/>
</g>
<!-- gpu7_layer7_expert1&#45;&gt;gpu7_layer7_expert_agg -->
<g id="edge2426" class="edge">
<title>gpu7_layer7_expert1&#45;&gt;gpu7_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M4418.07,-11274.77C4429.32,-11265.7 4442.53,-11255.03 4455.8,-11244.32"/>
<polygon fill="black" stroke="black" points="4458.02,-11247.03 4463.6,-11238.02 4453.62,-11241.58 4458.02,-11247.03"/>
</g>
<!-- gpu7_layer7_expert2&#45;&gt;gpu7_layer7_expert_agg -->
<g id="edge2427" class="edge">
<title>gpu7_layer7_expert2&#45;&gt;gpu7_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M4527,-11274.77C4527,-11266.85 4527,-11257.71 4527,-11248.39"/>
<polygon fill="black" stroke="black" points="4530.5,-11248.25 4527,-11238.25 4523.5,-11248.25 4530.5,-11248.25"/>
</g>
<!-- gpu7_layer7_expert3&#45;&gt;gpu7_layer7_expert_agg -->
<g id="edge2428" class="edge">
<title>gpu7_layer7_expert3&#45;&gt;gpu7_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M4635.93,-11274.77C4624.68,-11265.7 4611.47,-11255.03 4598.2,-11244.32"/>
<polygon fill="black" stroke="black" points="4600.38,-11241.58 4590.4,-11238.02 4595.98,-11247.03 4600.38,-11241.58"/>
</g>
<!-- gpu7_layer7_res2 -->
<g id="node1951" class="node">
<title>gpu7_layer7_res2</title>
<polygon fill="lightblue" stroke="black" points="4588,-11096.85 4466,-11096.85 4466,-11044.85 4588,-11044.85 4588,-11096.85"/>
<text text-anchor="middle" x="4527" y="-11084.85" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="4527" y="-11073.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-11062.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-11051.85" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer7_expert_agg&#45;&gt;gpu7_layer7_res2 -->
<g id="edge2430" class="edge">
<title>gpu7_layer7_expert_agg&#45;&gt;gpu7_layer7_res2</title>
<path fill="none" stroke="black" d="M4527,-11133.64C4527,-11124.69 4527,-11115.56 4527,-11107.16"/>
<polygon fill="black" stroke="black" points="4530.5,-11106.98 4527,-11096.98 4523.5,-11106.98 4530.5,-11106.98"/>
</g>
<!-- gpu7_layer8_ln1 -->
<g id="node1952" class="node">
<title>gpu7_layer8_ln1</title>
<polygon fill="lightblue" stroke="black" points="4588,-11007.85 4466,-11007.85 4466,-10955.85 4588,-10955.85 4588,-11007.85"/>
<text text-anchor="middle" x="4527" y="-10995.85" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="4527" y="-10984.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-10973.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-10962.85" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer7_res2&#45;&gt;gpu7_layer8_ln1 -->
<g id="edge2435" class="edge">
<title>gpu7_layer7_res2&#45;&gt;gpu7_layer8_ln1</title>
<path fill="none" stroke="black" d="M4527,-11044.69C4527,-11036.39 4527,-11027.01 4527,-11018.1"/>
<polygon fill="black" stroke="black" points="4530.5,-11017.96 4527,-11007.96 4523.5,-11017.96 4530.5,-11017.96"/>
</g>
<!-- gpu7_layer8_qkv -->
<g id="node1953" class="node">
<title>gpu7_layer8_qkv</title>
<polygon fill="lightblue" stroke="black" points="4588,-10918.85 4466,-10918.85 4466,-10866.85 4588,-10866.85 4588,-10918.85"/>
<text text-anchor="middle" x="4527" y="-10906.85" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4527" y="-10895.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-10884.85" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-10873.85" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer8_ln1&#45;&gt;gpu7_layer8_qkv -->
<g id="edge2436" class="edge">
<title>gpu7_layer8_ln1&#45;&gt;gpu7_layer8_qkv</title>
<path fill="none" stroke="black" d="M4527,-10955.69C4527,-10947.39 4527,-10938.01 4527,-10929.1"/>
<polygon fill="black" stroke="black" points="4530.5,-10928.96 4527,-10918.96 4523.5,-10928.96 4530.5,-10928.96"/>
</g>
<!-- gpu7_layer8_reshape -->
<g id="node1954" class="node">
<title>gpu7_layer8_reshape</title>
<polygon fill="lightblue" stroke="black" points="4591,-10829.85 4463,-10829.85 4463,-10777.85 4591,-10777.85 4591,-10829.85"/>
<text text-anchor="middle" x="4527" y="-10817.85" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="4527" y="-10806.85" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-10795.85" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-10784.85" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer8_qkv&#45;&gt;gpu7_layer8_reshape -->
<g id="edge2437" class="edge">
<title>gpu7_layer8_qkv&#45;&gt;gpu7_layer8_reshape</title>
<path fill="none" stroke="black" d="M4527,-10866.69C4527,-10858.39 4527,-10849.01 4527,-10840.1"/>
<polygon fill="black" stroke="black" points="4530.5,-10839.96 4527,-10829.96 4523.5,-10839.96 4530.5,-10839.96"/>
</g>
<!-- gpu7_layer8_attn -->
<g id="node1955" class="node">
<title>gpu7_layer8_attn</title>
<polygon fill="lightblue" stroke="black" points="4591,-10740.85 4463,-10740.85 4463,-10688.85 4591,-10688.85 4591,-10740.85"/>
<text text-anchor="middle" x="4527" y="-10728.85" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="4527" y="-10717.85" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-10706.85" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-10695.85" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer8_reshape&#45;&gt;gpu7_layer8_attn -->
<g id="edge2438" class="edge">
<title>gpu7_layer8_reshape&#45;&gt;gpu7_layer8_attn</title>
<path fill="none" stroke="black" d="M4527,-10777.69C4527,-10769.39 4527,-10760.01 4527,-10751.1"/>
<polygon fill="black" stroke="black" points="4530.5,-10750.96 4527,-10740.96 4523.5,-10750.96 4530.5,-10750.96"/>
</g>
<!-- gpu7_layer8_attn_reshape -->
<g id="node1957" class="node">
<title>gpu7_layer8_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="4588,-10651.85 4466,-10651.85 4466,-10599.85 4588,-10599.85 4588,-10651.85"/>
<text text-anchor="middle" x="4527" y="-10639.85" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="4527" y="-10628.85" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-10617.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-10606.85" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer8_attn&#45;&gt;gpu7_layer8_attn_reshape -->
<g id="edge2439" class="edge">
<title>gpu7_layer8_attn&#45;&gt;gpu7_layer8_attn_reshape</title>
<path fill="none" stroke="black" d="M4527,-10688.69C4527,-10680.39 4527,-10671.01 4527,-10662.1"/>
<polygon fill="black" stroke="black" points="4530.5,-10661.96 4527,-10651.96 4523.5,-10661.96 4530.5,-10661.96"/>
</g>
<!-- gpu7_layer8_attn_out -->
<g id="node1956" class="node">
<title>gpu7_layer8_attn_out</title>
<polygon fill="lightblue" stroke="black" points="4588,-10562.85 4466,-10562.85 4466,-10510.85 4588,-10510.85 4588,-10562.85"/>
<text text-anchor="middle" x="4527" y="-10550.85" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="4527" y="-10539.85" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-10528.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-10517.85" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer8_kv_update -->
<g id="node1958" class="node">
<title>gpu7_layer8_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="4527" cy="-10437.08" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="4527" y="-10451.08" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="4527" y="-10440.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-10429.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-10418.08" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer8_attn_out&#45;&gt;gpu7_layer8_kv_update -->
<g id="edge2441" class="edge">
<title>gpu7_layer8_attn_out&#45;&gt;gpu7_layer8_kv_update</title>
<path fill="none" stroke="black" d="M4527,-10510.67C4527,-10502.53 4527,-10493.24 4527,-10484.08"/>
<polygon fill="black" stroke="black" points="4530.5,-10483.86 4527,-10473.86 4523.5,-10483.86 4530.5,-10483.86"/>
</g>
<!-- gpu7_layer8_attn_reshape&#45;&gt;gpu7_layer8_attn_out -->
<g id="edge2440" class="edge">
<title>gpu7_layer8_attn_reshape&#45;&gt;gpu7_layer8_attn_out</title>
<path fill="none" stroke="black" d="M4527,-10599.69C4527,-10591.39 4527,-10582.01 4527,-10573.1"/>
<polygon fill="black" stroke="black" points="4530.5,-10572.96 4527,-10562.96 4523.5,-10572.96 4530.5,-10572.96"/>
</g>
<!-- gpu7_layer8_res1 -->
<g id="node1959" class="node">
<title>gpu7_layer8_res1</title>
<polygon fill="lightblue" stroke="black" points="4588,-10363.31 4466,-10363.31 4466,-10311.31 4588,-10311.31 4588,-10363.31"/>
<text text-anchor="middle" x="4527" y="-10351.31" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="4527" y="-10340.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-10329.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-10318.31" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer8_kv_update&#45;&gt;gpu7_layer8_res1 -->
<g id="edge2442" class="edge">
<title>gpu7_layer8_kv_update&#45;&gt;gpu7_layer8_res1</title>
<path fill="none" stroke="black" d="M4527,-10400.23C4527,-10391.55 4527,-10382.28 4527,-10373.63"/>
<polygon fill="black" stroke="black" points="4530.5,-10373.46 4527,-10363.46 4523.5,-10373.46 4530.5,-10373.46"/>
</g>
<!-- gpu7_layer8_ln2 -->
<g id="node1960" class="node">
<title>gpu7_layer8_ln2</title>
<polygon fill="lightblue" stroke="black" points="4588,-10274.31 4466,-10274.31 4466,-10222.31 4588,-10222.31 4588,-10274.31"/>
<text text-anchor="middle" x="4527" y="-10262.31" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="4527" y="-10251.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-10240.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-10229.31" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer8_res1&#45;&gt;gpu7_layer8_ln2 -->
<g id="edge2443" class="edge">
<title>gpu7_layer8_res1&#45;&gt;gpu7_layer8_ln2</title>
<path fill="none" stroke="black" d="M4527,-10311.15C4527,-10302.85 4527,-10293.47 4527,-10284.56"/>
<polygon fill="black" stroke="black" points="4530.5,-10284.42 4527,-10274.42 4523.5,-10284.42 4530.5,-10284.42"/>
</g>
<!-- gpu7_layer8_routing -->
<g id="node1961" class="node">
<title>gpu7_layer8_routing</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-10185.31 4452.29,-10185.31 4400.53,-10059.31 4601.71,-10059.31 4653.47,-10185.31"/>
<text text-anchor="middle" x="4527" y="-10141.81" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="4527" y="-10130.81" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-10119.81" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-10108.81" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="4527" y="-10097.81" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer8_ln2&#45;&gt;gpu7_layer8_routing -->
<g id="edge2444" class="edge">
<title>gpu7_layer8_ln2&#45;&gt;gpu7_layer8_routing</title>
<path fill="none" stroke="black" d="M4527,-10222.22C4527,-10214.29 4527,-10205.09 4527,-10195.56"/>
<polygon fill="black" stroke="black" points="4530.5,-10195.55 4527,-10185.55 4523.5,-10195.55 4530.5,-10195.55"/>
</g>
<!-- gpu7_layer8_expert0 -->
<g id="node1962" class="node">
<title>gpu7_layer8_expert0</title>
<polygon fill="lightblue" stroke="black" points="4308,-10013.31 4186,-10013.31 4186,-9961.31 4308,-9961.31 4308,-10013.31"/>
<text text-anchor="middle" x="4247" y="-10001.31" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="4247" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer8_routing&#45;&gt;gpu7_layer8_expert0 -->
<g id="edge2431" class="edge">
<title>gpu7_layer8_routing&#45;&gt;gpu7_layer8_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4401.33,-10061.62C4369.34,-10046.42 4336.34,-10030.75 4309.11,-10017.81"/>
<polygon fill="black" stroke="black" points="4310.26,-10014.49 4299.73,-10013.36 4307.26,-10020.81 4310.26,-10014.49"/>
<text text-anchor="middle" x="4382.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer8_expert1 -->
<g id="node1963" class="node">
<title>gpu7_layer8_expert1</title>
<polygon fill="lightblue" stroke="black" points="4448,-10013.31 4326,-10013.31 4326,-9961.31 4448,-9961.31 4448,-10013.31"/>
<text text-anchor="middle" x="4387" y="-10001.31" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="4387" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer8_routing&#45;&gt;gpu7_layer8_expert1 -->
<g id="edge2432" class="edge">
<title>gpu7_layer8_routing&#45;&gt;gpu7_layer8_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4461.51,-10059.1C4447.48,-10045.77 4433.21,-10032.22 4420.97,-10020.58"/>
<polygon fill="black" stroke="black" points="4423.29,-10017.96 4413.63,-10013.61 4418.46,-10023.03 4423.29,-10017.96"/>
<text text-anchor="middle" x="4469.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer8_expert2 -->
<g id="node1964" class="node">
<title>gpu7_layer8_expert2</title>
<polygon fill="lightblue" stroke="black" points="4588,-10013.31 4466,-10013.31 4466,-9961.31 4588,-9961.31 4588,-10013.31"/>
<text text-anchor="middle" x="4527" y="-10001.31" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="4527" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer8_routing&#45;&gt;gpu7_layer8_expert2 -->
<g id="edge2433" class="edge">
<title>gpu7_layer8_routing&#45;&gt;gpu7_layer8_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4527,-10059.1C4527,-10047.03 4527,-10034.77 4527,-10023.92"/>
<polygon fill="black" stroke="black" points="4530.5,-10023.61 4527,-10013.61 4523.5,-10023.61 4530.5,-10023.61"/>
<text text-anchor="middle" x="4556.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer8_expert3 -->
<g id="node1965" class="node">
<title>gpu7_layer8_expert3</title>
<polygon fill="lightblue" stroke="black" points="4728,-10013.31 4606,-10013.31 4606,-9961.31 4728,-9961.31 4728,-10013.31"/>
<text text-anchor="middle" x="4667" y="-10001.31" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4667" y="-9990.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-9979.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-9968.31" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer8_routing&#45;&gt;gpu7_layer8_expert3 -->
<g id="edge2434" class="edge">
<title>gpu7_layer8_routing&#45;&gt;gpu7_layer8_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4592.49,-10059.1C4606.52,-10045.77 4620.79,-10032.22 4633.03,-10020.58"/>
<polygon fill="black" stroke="black" points="4635.54,-10023.03 4640.37,-10013.61 4630.71,-10017.96 4635.54,-10023.03"/>
<text text-anchor="middle" x="4650.5" y="-10034.11" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer8_expert_agg -->
<g id="node1966" class="node">
<title>gpu7_layer8_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-9924.31 4452.29,-9924.31 4400.53,-9820.31 4601.71,-9820.31 4653.47,-9924.31"/>
<text text-anchor="middle" x="4527" y="-9886.31" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="4527" y="-9875.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-9864.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-9853.31" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer8_routing&#45;&gt;gpu7_layer8_expert_agg -->
<g id="edge2449" class="edge">
<title>gpu7_layer8_routing&#45;&gt;gpu7_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M4616.22,-10094.4C4689.96,-10067.24 4776.6,-10020.85 4737,-9961.31 4716.44,-9930.4 4682.7,-9910.33 4648.22,-9897.3"/>
<polygon fill="black" stroke="black" points="4649.08,-9893.89 4638.48,-9893.81 4646.71,-9900.48 4649.08,-9893.89"/>
</g>
<!-- gpu7_layer8_expert0&#45;&gt;gpu7_layer8_expert_agg -->
<g id="edge2445" class="edge">
<title>gpu7_layer8_expert0&#45;&gt;gpu7_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M4308.1,-9961.65C4344.98,-9946.77 4392.7,-9927.51 4434.16,-9910.78"/>
<polygon fill="black" stroke="black" points="4435.5,-9914.02 4443.46,-9907.03 4432.88,-9907.52 4435.5,-9914.02"/>
</g>
<!-- gpu7_layer8_expert1&#45;&gt;gpu7_layer8_expert_agg -->
<g id="edge2446" class="edge">
<title>gpu7_layer8_expert1&#45;&gt;gpu7_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M4418.07,-9961.23C4429.32,-9952.16 4442.53,-9941.49 4455.8,-9930.78"/>
<polygon fill="black" stroke="black" points="4458.02,-9933.49 4463.6,-9924.48 4453.62,-9928.04 4458.02,-9933.49"/>
</g>
<!-- gpu7_layer8_expert2&#45;&gt;gpu7_layer8_expert_agg -->
<g id="edge2447" class="edge">
<title>gpu7_layer8_expert2&#45;&gt;gpu7_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M4527,-9961.23C4527,-9953.31 4527,-9944.17 4527,-9934.85"/>
<polygon fill="black" stroke="black" points="4530.5,-9934.71 4527,-9924.71 4523.5,-9934.71 4530.5,-9934.71"/>
</g>
<!-- gpu7_layer8_expert3&#45;&gt;gpu7_layer8_expert_agg -->
<g id="edge2448" class="edge">
<title>gpu7_layer8_expert3&#45;&gt;gpu7_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M4635.93,-9961.23C4624.68,-9952.16 4611.47,-9941.49 4598.2,-9930.78"/>
<polygon fill="black" stroke="black" points="4600.38,-9928.04 4590.4,-9924.48 4595.98,-9933.49 4600.38,-9928.04"/>
</g>
<!-- gpu7_layer8_res2 -->
<g id="node1967" class="node">
<title>gpu7_layer8_res2</title>
<polygon fill="lightblue" stroke="black" points="4588,-9783.31 4466,-9783.31 4466,-9731.31 4588,-9731.31 4588,-9783.31"/>
<text text-anchor="middle" x="4527" y="-9771.31" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="4527" y="-9760.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-9749.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-9738.31" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer8_expert_agg&#45;&gt;gpu7_layer8_res2 -->
<g id="edge2450" class="edge">
<title>gpu7_layer8_expert_agg&#45;&gt;gpu7_layer8_res2</title>
<path fill="none" stroke="black" d="M4527,-9820.1C4527,-9811.15 4527,-9802.02 4527,-9793.62"/>
<polygon fill="black" stroke="black" points="4530.5,-9793.44 4527,-9783.44 4523.5,-9793.44 4530.5,-9793.44"/>
</g>
<!-- gpu7_layer9_ln1 -->
<g id="node1968" class="node">
<title>gpu7_layer9_ln1</title>
<polygon fill="lightblue" stroke="black" points="4588,-9694.31 4466,-9694.31 4466,-9642.31 4588,-9642.31 4588,-9694.31"/>
<text text-anchor="middle" x="4527" y="-9682.31" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="4527" y="-9671.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-9660.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-9649.31" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer8_res2&#45;&gt;gpu7_layer9_ln1 -->
<g id="edge2455" class="edge">
<title>gpu7_layer8_res2&#45;&gt;gpu7_layer9_ln1</title>
<path fill="none" stroke="black" d="M4527,-9731.15C4527,-9722.85 4527,-9713.47 4527,-9704.56"/>
<polygon fill="black" stroke="black" points="4530.5,-9704.42 4527,-9694.42 4523.5,-9704.42 4530.5,-9704.42"/>
</g>
<!-- gpu7_layer9_qkv -->
<g id="node1969" class="node">
<title>gpu7_layer9_qkv</title>
<polygon fill="lightblue" stroke="black" points="4588,-9605.31 4466,-9605.31 4466,-9553.31 4588,-9553.31 4588,-9605.31"/>
<text text-anchor="middle" x="4527" y="-9593.31" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4527" y="-9582.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-9571.31" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-9560.31" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer9_ln1&#45;&gt;gpu7_layer9_qkv -->
<g id="edge2456" class="edge">
<title>gpu7_layer9_ln1&#45;&gt;gpu7_layer9_qkv</title>
<path fill="none" stroke="black" d="M4527,-9642.15C4527,-9633.85 4527,-9624.47 4527,-9615.56"/>
<polygon fill="black" stroke="black" points="4530.5,-9615.42 4527,-9605.42 4523.5,-9615.42 4530.5,-9615.42"/>
</g>
<!-- gpu7_layer9_reshape -->
<g id="node1970" class="node">
<title>gpu7_layer9_reshape</title>
<polygon fill="lightblue" stroke="black" points="4591,-9516.31 4463,-9516.31 4463,-9464.31 4591,-9464.31 4591,-9516.31"/>
<text text-anchor="middle" x="4527" y="-9504.31" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="4527" y="-9493.31" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-9482.31" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-9471.31" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer9_qkv&#45;&gt;gpu7_layer9_reshape -->
<g id="edge2457" class="edge">
<title>gpu7_layer9_qkv&#45;&gt;gpu7_layer9_reshape</title>
<path fill="none" stroke="black" d="M4527,-9553.15C4527,-9544.85 4527,-9535.47 4527,-9526.56"/>
<polygon fill="black" stroke="black" points="4530.5,-9526.42 4527,-9516.42 4523.5,-9526.42 4530.5,-9526.42"/>
</g>
<!-- gpu7_layer9_attn -->
<g id="node1971" class="node">
<title>gpu7_layer9_attn</title>
<polygon fill="lightblue" stroke="black" points="4591,-9427.31 4463,-9427.31 4463,-9375.31 4591,-9375.31 4591,-9427.31"/>
<text text-anchor="middle" x="4527" y="-9415.31" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="4527" y="-9404.31" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-9393.31" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-9382.31" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer9_reshape&#45;&gt;gpu7_layer9_attn -->
<g id="edge2458" class="edge">
<title>gpu7_layer9_reshape&#45;&gt;gpu7_layer9_attn</title>
<path fill="none" stroke="black" d="M4527,-9464.15C4527,-9455.85 4527,-9446.47 4527,-9437.56"/>
<polygon fill="black" stroke="black" points="4530.5,-9437.42 4527,-9427.42 4523.5,-9437.42 4530.5,-9437.42"/>
</g>
<!-- gpu7_layer9_attn_reshape -->
<g id="node1973" class="node">
<title>gpu7_layer9_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="4588,-9338.31 4466,-9338.31 4466,-9286.31 4588,-9286.31 4588,-9338.31"/>
<text text-anchor="middle" x="4527" y="-9326.31" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="4527" y="-9315.31" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-9304.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-9293.31" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer9_attn&#45;&gt;gpu7_layer9_attn_reshape -->
<g id="edge2459" class="edge">
<title>gpu7_layer9_attn&#45;&gt;gpu7_layer9_attn_reshape</title>
<path fill="none" stroke="black" d="M4527,-9375.15C4527,-9366.85 4527,-9357.47 4527,-9348.56"/>
<polygon fill="black" stroke="black" points="4530.5,-9348.42 4527,-9338.42 4523.5,-9348.42 4530.5,-9348.42"/>
</g>
<!-- gpu7_layer9_attn_out -->
<g id="node1972" class="node">
<title>gpu7_layer9_attn_out</title>
<polygon fill="lightblue" stroke="black" points="4588,-9249.31 4466,-9249.31 4466,-9197.31 4588,-9197.31 4588,-9249.31"/>
<text text-anchor="middle" x="4527" y="-9237.31" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="4527" y="-9226.31" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-9215.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-9204.31" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer9_kv_update -->
<g id="node1974" class="node">
<title>gpu7_layer9_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="4527" cy="-9123.54" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="4527" y="-9137.54" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="4527" y="-9126.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-9115.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-9104.54" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer9_attn_out&#45;&gt;gpu7_layer9_kv_update -->
<g id="edge2461" class="edge">
<title>gpu7_layer9_attn_out&#45;&gt;gpu7_layer9_kv_update</title>
<path fill="none" stroke="black" d="M4527,-9197.13C4527,-9189 4527,-9179.7 4527,-9170.54"/>
<polygon fill="black" stroke="black" points="4530.5,-9170.32 4527,-9160.32 4523.5,-9170.32 4530.5,-9170.32"/>
</g>
<!-- gpu7_layer9_attn_reshape&#45;&gt;gpu7_layer9_attn_out -->
<g id="edge2460" class="edge">
<title>gpu7_layer9_attn_reshape&#45;&gt;gpu7_layer9_attn_out</title>
<path fill="none" stroke="black" d="M4527,-9286.15C4527,-9277.85 4527,-9268.47 4527,-9259.56"/>
<polygon fill="black" stroke="black" points="4530.5,-9259.42 4527,-9249.42 4523.5,-9259.42 4530.5,-9259.42"/>
</g>
<!-- gpu7_layer9_res1 -->
<g id="node1975" class="node">
<title>gpu7_layer9_res1</title>
<polygon fill="lightblue" stroke="black" points="4588,-9049.77 4466,-9049.77 4466,-8997.77 4588,-8997.77 4588,-9049.77"/>
<text text-anchor="middle" x="4527" y="-9037.77" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="4527" y="-9026.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-9015.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-9004.77" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer9_kv_update&#45;&gt;gpu7_layer9_res1 -->
<g id="edge2462" class="edge">
<title>gpu7_layer9_kv_update&#45;&gt;gpu7_layer9_res1</title>
<path fill="none" stroke="black" d="M4527,-9086.69C4527,-9078.01 4527,-9068.74 4527,-9060.09"/>
<polygon fill="black" stroke="black" points="4530.5,-9059.92 4527,-9049.92 4523.5,-9059.92 4530.5,-9059.92"/>
</g>
<!-- gpu7_layer9_ln2 -->
<g id="node1976" class="node">
<title>gpu7_layer9_ln2</title>
<polygon fill="lightblue" stroke="black" points="4588,-8960.77 4466,-8960.77 4466,-8908.77 4588,-8908.77 4588,-8960.77"/>
<text text-anchor="middle" x="4527" y="-8948.77" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="4527" y="-8937.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-8926.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-8915.77" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer9_res1&#45;&gt;gpu7_layer9_ln2 -->
<g id="edge2463" class="edge">
<title>gpu7_layer9_res1&#45;&gt;gpu7_layer9_ln2</title>
<path fill="none" stroke="black" d="M4527,-8997.61C4527,-8989.31 4527,-8979.93 4527,-8971.02"/>
<polygon fill="black" stroke="black" points="4530.5,-8970.88 4527,-8960.88 4523.5,-8970.88 4530.5,-8970.88"/>
</g>
<!-- gpu7_layer9_routing -->
<g id="node1977" class="node">
<title>gpu7_layer9_routing</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-8871.77 4452.29,-8871.77 4400.53,-8745.77 4601.71,-8745.77 4653.47,-8871.77"/>
<text text-anchor="middle" x="4527" y="-8828.27" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="4527" y="-8817.27" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-8806.27" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-8795.27" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="4527" y="-8784.27" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer9_ln2&#45;&gt;gpu7_layer9_routing -->
<g id="edge2464" class="edge">
<title>gpu7_layer9_ln2&#45;&gt;gpu7_layer9_routing</title>
<path fill="none" stroke="black" d="M4527,-8908.68C4527,-8900.75 4527,-8891.55 4527,-8882.02"/>
<polygon fill="black" stroke="black" points="4530.5,-8882.01 4527,-8872.01 4523.5,-8882.01 4530.5,-8882.01"/>
</g>
<!-- gpu7_layer9_expert0 -->
<g id="node1978" class="node">
<title>gpu7_layer9_expert0</title>
<polygon fill="lightblue" stroke="black" points="4308,-8699.77 4186,-8699.77 4186,-8647.77 4308,-8647.77 4308,-8699.77"/>
<text text-anchor="middle" x="4247" y="-8687.77" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="4247" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer9_routing&#45;&gt;gpu7_layer9_expert0 -->
<g id="edge2451" class="edge">
<title>gpu7_layer9_routing&#45;&gt;gpu7_layer9_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4401.33,-8748.08C4369.34,-8732.89 4336.34,-8717.21 4309.11,-8704.27"/>
<polygon fill="black" stroke="black" points="4310.26,-8700.95 4299.73,-8699.82 4307.26,-8707.27 4310.26,-8700.95"/>
<text text-anchor="middle" x="4382.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer9_expert1 -->
<g id="node1979" class="node">
<title>gpu7_layer9_expert1</title>
<polygon fill="lightblue" stroke="black" points="4448,-8699.77 4326,-8699.77 4326,-8647.77 4448,-8647.77 4448,-8699.77"/>
<text text-anchor="middle" x="4387" y="-8687.77" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="4387" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer9_routing&#45;&gt;gpu7_layer9_expert1 -->
<g id="edge2452" class="edge">
<title>gpu7_layer9_routing&#45;&gt;gpu7_layer9_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4461.51,-8745.56C4447.48,-8732.23 4433.21,-8718.68 4420.97,-8707.04"/>
<polygon fill="black" stroke="black" points="4423.29,-8704.42 4413.63,-8700.07 4418.46,-8709.49 4423.29,-8704.42"/>
<text text-anchor="middle" x="4469.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer9_expert2 -->
<g id="node1980" class="node">
<title>gpu7_layer9_expert2</title>
<polygon fill="lightblue" stroke="black" points="4588,-8699.77 4466,-8699.77 4466,-8647.77 4588,-8647.77 4588,-8699.77"/>
<text text-anchor="middle" x="4527" y="-8687.77" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="4527" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer9_routing&#45;&gt;gpu7_layer9_expert2 -->
<g id="edge2453" class="edge">
<title>gpu7_layer9_routing&#45;&gt;gpu7_layer9_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4527,-8745.56C4527,-8733.49 4527,-8721.23 4527,-8710.39"/>
<polygon fill="black" stroke="black" points="4530.5,-8710.07 4527,-8700.07 4523.5,-8710.07 4530.5,-8710.07"/>
<text text-anchor="middle" x="4556.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer9_expert3 -->
<g id="node1981" class="node">
<title>gpu7_layer9_expert3</title>
<polygon fill="lightblue" stroke="black" points="4728,-8699.77 4606,-8699.77 4606,-8647.77 4728,-8647.77 4728,-8699.77"/>
<text text-anchor="middle" x="4667" y="-8687.77" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4667" y="-8676.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-8665.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-8654.77" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer9_routing&#45;&gt;gpu7_layer9_expert3 -->
<g id="edge2454" class="edge">
<title>gpu7_layer9_routing&#45;&gt;gpu7_layer9_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4592.49,-8745.56C4606.52,-8732.23 4620.79,-8718.68 4633.03,-8707.04"/>
<polygon fill="black" stroke="black" points="4635.54,-8709.49 4640.37,-8700.07 4630.71,-8704.42 4635.54,-8709.49"/>
<text text-anchor="middle" x="4650.5" y="-8720.57" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer9_expert_agg -->
<g id="node1982" class="node">
<title>gpu7_layer9_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-8610.77 4452.29,-8610.77 4400.53,-8506.77 4601.71,-8506.77 4653.47,-8610.77"/>
<text text-anchor="middle" x="4527" y="-8572.77" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="4527" y="-8561.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-8550.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-8539.77" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer9_routing&#45;&gt;gpu7_layer9_expert_agg -->
<g id="edge2469" class="edge">
<title>gpu7_layer9_routing&#45;&gt;gpu7_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M4616.22,-8780.86C4689.96,-8753.7 4776.6,-8707.31 4737,-8647.77 4716.44,-8616.86 4682.7,-8596.79 4648.22,-8583.76"/>
<polygon fill="black" stroke="black" points="4649.08,-8580.35 4638.48,-8580.27 4646.71,-8586.94 4649.08,-8580.35"/>
</g>
<!-- gpu7_layer9_expert0&#45;&gt;gpu7_layer9_expert_agg -->
<g id="edge2465" class="edge">
<title>gpu7_layer9_expert0&#45;&gt;gpu7_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M4308.1,-8648.12C4344.98,-8633.23 4392.7,-8613.97 4434.16,-8597.24"/>
<polygon fill="black" stroke="black" points="4435.5,-8600.48 4443.46,-8593.49 4432.88,-8593.99 4435.5,-8600.48"/>
</g>
<!-- gpu7_layer9_expert1&#45;&gt;gpu7_layer9_expert_agg -->
<g id="edge2466" class="edge">
<title>gpu7_layer9_expert1&#45;&gt;gpu7_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M4418.07,-8647.7C4429.32,-8638.62 4442.53,-8627.95 4455.8,-8617.24"/>
<polygon fill="black" stroke="black" points="4458.02,-8619.95 4463.6,-8610.95 4453.62,-8614.5 4458.02,-8619.95"/>
</g>
<!-- gpu7_layer9_expert2&#45;&gt;gpu7_layer9_expert_agg -->
<g id="edge2467" class="edge">
<title>gpu7_layer9_expert2&#45;&gt;gpu7_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M4527,-8647.7C4527,-8639.77 4527,-8630.63 4527,-8621.31"/>
<polygon fill="black" stroke="black" points="4530.5,-8621.17 4527,-8611.17 4523.5,-8621.17 4530.5,-8621.17"/>
</g>
<!-- gpu7_layer9_expert3&#45;&gt;gpu7_layer9_expert_agg -->
<g id="edge2468" class="edge">
<title>gpu7_layer9_expert3&#45;&gt;gpu7_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M4635.93,-8647.7C4624.68,-8638.62 4611.47,-8627.95 4598.2,-8617.24"/>
<polygon fill="black" stroke="black" points="4600.38,-8614.5 4590.4,-8610.95 4595.98,-8619.95 4600.38,-8614.5"/>
</g>
<!-- gpu7_layer9_res2 -->
<g id="node1983" class="node">
<title>gpu7_layer9_res2</title>
<polygon fill="lightblue" stroke="black" points="4588,-8469.77 4466,-8469.77 4466,-8417.77 4588,-8417.77 4588,-8469.77"/>
<text text-anchor="middle" x="4527" y="-8457.77" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="4527" y="-8446.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-8435.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-8424.77" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer9_expert_agg&#45;&gt;gpu7_layer9_res2 -->
<g id="edge2470" class="edge">
<title>gpu7_layer9_expert_agg&#45;&gt;gpu7_layer9_res2</title>
<path fill="none" stroke="black" d="M4527,-8506.56C4527,-8497.61 4527,-8488.48 4527,-8480.08"/>
<polygon fill="black" stroke="black" points="4530.5,-8479.9 4527,-8469.9 4523.5,-8479.9 4530.5,-8479.9"/>
</g>
<!-- gpu7_layer10_ln1 -->
<g id="node1984" class="node">
<title>gpu7_layer10_ln1</title>
<polygon fill="lightblue" stroke="black" points="4588,-8380.77 4466,-8380.77 4466,-8328.77 4588,-8328.77 4588,-8380.77"/>
<text text-anchor="middle" x="4527" y="-8368.77" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="4527" y="-8357.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-8346.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-8335.77" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer9_res2&#45;&gt;gpu7_layer10_ln1 -->
<g id="edge2475" class="edge">
<title>gpu7_layer9_res2&#45;&gt;gpu7_layer10_ln1</title>
<path fill="none" stroke="black" d="M4527,-8417.61C4527,-8409.31 4527,-8399.93 4527,-8391.02"/>
<polygon fill="black" stroke="black" points="4530.5,-8390.88 4527,-8380.88 4523.5,-8390.88 4530.5,-8390.88"/>
</g>
<!-- gpu7_layer10_qkv -->
<g id="node1985" class="node">
<title>gpu7_layer10_qkv</title>
<polygon fill="lightblue" stroke="black" points="4588,-8291.77 4466,-8291.77 4466,-8239.77 4588,-8239.77 4588,-8291.77"/>
<text text-anchor="middle" x="4527" y="-8279.77" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4527" y="-8268.77" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-8257.77" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-8246.77" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer10_ln1&#45;&gt;gpu7_layer10_qkv -->
<g id="edge2476" class="edge">
<title>gpu7_layer10_ln1&#45;&gt;gpu7_layer10_qkv</title>
<path fill="none" stroke="black" d="M4527,-8328.61C4527,-8320.31 4527,-8310.93 4527,-8302.02"/>
<polygon fill="black" stroke="black" points="4530.5,-8301.88 4527,-8291.88 4523.5,-8301.88 4530.5,-8301.88"/>
</g>
<!-- gpu7_layer10_reshape -->
<g id="node1986" class="node">
<title>gpu7_layer10_reshape</title>
<polygon fill="lightblue" stroke="black" points="4591,-8202.77 4463,-8202.77 4463,-8150.77 4591,-8150.77 4591,-8202.77"/>
<text text-anchor="middle" x="4527" y="-8190.77" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="4527" y="-8179.77" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-8168.77" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-8157.77" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer10_qkv&#45;&gt;gpu7_layer10_reshape -->
<g id="edge2477" class="edge">
<title>gpu7_layer10_qkv&#45;&gt;gpu7_layer10_reshape</title>
<path fill="none" stroke="black" d="M4527,-8239.61C4527,-8231.31 4527,-8221.93 4527,-8213.02"/>
<polygon fill="black" stroke="black" points="4530.5,-8212.88 4527,-8202.88 4523.5,-8212.88 4530.5,-8212.88"/>
</g>
<!-- gpu7_layer10_attn -->
<g id="node1987" class="node">
<title>gpu7_layer10_attn</title>
<polygon fill="lightblue" stroke="black" points="4591,-8113.77 4463,-8113.77 4463,-8061.77 4591,-8061.77 4591,-8113.77"/>
<text text-anchor="middle" x="4527" y="-8101.77" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="4527" y="-8090.77" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-8079.77" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-8068.77" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer10_reshape&#45;&gt;gpu7_layer10_attn -->
<g id="edge2478" class="edge">
<title>gpu7_layer10_reshape&#45;&gt;gpu7_layer10_attn</title>
<path fill="none" stroke="black" d="M4527,-8150.61C4527,-8142.31 4527,-8132.93 4527,-8124.02"/>
<polygon fill="black" stroke="black" points="4530.5,-8123.88 4527,-8113.88 4523.5,-8123.88 4530.5,-8123.88"/>
</g>
<!-- gpu7_layer10_attn_reshape -->
<g id="node1989" class="node">
<title>gpu7_layer10_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="4588,-8024.77 4466,-8024.77 4466,-7972.77 4588,-7972.77 4588,-8024.77"/>
<text text-anchor="middle" x="4527" y="-8012.77" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="4527" y="-8001.77" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-7990.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-7979.77" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer10_attn&#45;&gt;gpu7_layer10_attn_reshape -->
<g id="edge2479" class="edge">
<title>gpu7_layer10_attn&#45;&gt;gpu7_layer10_attn_reshape</title>
<path fill="none" stroke="black" d="M4527,-8061.61C4527,-8053.31 4527,-8043.93 4527,-8035.02"/>
<polygon fill="black" stroke="black" points="4530.5,-8034.88 4527,-8024.88 4523.5,-8034.88 4530.5,-8034.88"/>
</g>
<!-- gpu7_layer10_attn_out -->
<g id="node1988" class="node">
<title>gpu7_layer10_attn_out</title>
<polygon fill="lightblue" stroke="black" points="4588,-7935.77 4466,-7935.77 4466,-7883.77 4588,-7883.77 4588,-7935.77"/>
<text text-anchor="middle" x="4527" y="-7923.77" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="4527" y="-7912.77" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-7901.77" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-7890.77" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer10_kv_update -->
<g id="node1990" class="node">
<title>gpu7_layer10_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="4527" cy="-7810" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="4527" y="-7824" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="4527" y="-7813" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-7802" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-7791" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer10_attn_out&#45;&gt;gpu7_layer10_kv_update -->
<g id="edge2481" class="edge">
<title>gpu7_layer10_attn_out&#45;&gt;gpu7_layer10_kv_update</title>
<path fill="none" stroke="black" d="M4527,-7883.6C4527,-7875.46 4527,-7866.16 4527,-7857"/>
<polygon fill="black" stroke="black" points="4530.5,-7856.78 4527,-7846.78 4523.5,-7856.78 4530.5,-7856.78"/>
</g>
<!-- gpu7_layer10_attn_reshape&#45;&gt;gpu7_layer10_attn_out -->
<g id="edge2480" class="edge">
<title>gpu7_layer10_attn_reshape&#45;&gt;gpu7_layer10_attn_out</title>
<path fill="none" stroke="black" d="M4527,-7972.61C4527,-7964.31 4527,-7954.93 4527,-7946.02"/>
<polygon fill="black" stroke="black" points="4530.5,-7945.88 4527,-7935.88 4523.5,-7945.88 4530.5,-7945.88"/>
</g>
<!-- gpu7_layer10_res1 -->
<g id="node1991" class="node">
<title>gpu7_layer10_res1</title>
<polygon fill="lightblue" stroke="black" points="4588,-7736.23 4466,-7736.23 4466,-7684.23 4588,-7684.23 4588,-7736.23"/>
<text text-anchor="middle" x="4527" y="-7724.23" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="4527" y="-7713.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-7702.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-7691.23" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer10_kv_update&#45;&gt;gpu7_layer10_res1 -->
<g id="edge2482" class="edge">
<title>gpu7_layer10_kv_update&#45;&gt;gpu7_layer10_res1</title>
<path fill="none" stroke="black" d="M4527,-7773.15C4527,-7764.47 4527,-7755.2 4527,-7746.55"/>
<polygon fill="black" stroke="black" points="4530.5,-7746.38 4527,-7736.38 4523.5,-7746.38 4530.5,-7746.38"/>
</g>
<!-- gpu7_layer10_ln2 -->
<g id="node1992" class="node">
<title>gpu7_layer10_ln2</title>
<polygon fill="lightblue" stroke="black" points="4588,-7647.23 4466,-7647.23 4466,-7595.23 4588,-7595.23 4588,-7647.23"/>
<text text-anchor="middle" x="4527" y="-7635.23" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="4527" y="-7624.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-7613.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-7602.23" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer10_res1&#45;&gt;gpu7_layer10_ln2 -->
<g id="edge2483" class="edge">
<title>gpu7_layer10_res1&#45;&gt;gpu7_layer10_ln2</title>
<path fill="none" stroke="black" d="M4527,-7684.07C4527,-7675.77 4527,-7666.39 4527,-7657.48"/>
<polygon fill="black" stroke="black" points="4530.5,-7657.34 4527,-7647.34 4523.5,-7657.34 4530.5,-7657.34"/>
</g>
<!-- gpu7_layer10_routing -->
<g id="node1993" class="node">
<title>gpu7_layer10_routing</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-7558.23 4452.29,-7558.23 4400.53,-7432.23 4601.71,-7432.23 4653.47,-7558.23"/>
<text text-anchor="middle" x="4527" y="-7514.73" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="4527" y="-7503.73" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-7492.73" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-7481.73" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="4527" y="-7470.73" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer10_ln2&#45;&gt;gpu7_layer10_routing -->
<g id="edge2484" class="edge">
<title>gpu7_layer10_ln2&#45;&gt;gpu7_layer10_routing</title>
<path fill="none" stroke="black" d="M4527,-7595.14C4527,-7587.21 4527,-7578.01 4527,-7568.48"/>
<polygon fill="black" stroke="black" points="4530.5,-7568.47 4527,-7558.47 4523.5,-7568.47 4530.5,-7568.47"/>
</g>
<!-- gpu7_layer10_expert0 -->
<g id="node1994" class="node">
<title>gpu7_layer10_expert0</title>
<polygon fill="lightblue" stroke="black" points="4308,-7386.23 4186,-7386.23 4186,-7334.23 4308,-7334.23 4308,-7386.23"/>
<text text-anchor="middle" x="4247" y="-7374.23" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="4247" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer10_routing&#45;&gt;gpu7_layer10_expert0 -->
<g id="edge2471" class="edge">
<title>gpu7_layer10_routing&#45;&gt;gpu7_layer10_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4401.33,-7434.54C4369.34,-7419.35 4336.34,-7403.67 4309.11,-7390.74"/>
<polygon fill="black" stroke="black" points="4310.26,-7387.41 4299.73,-7386.28 4307.26,-7393.73 4310.26,-7387.41"/>
<text text-anchor="middle" x="4382.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer10_expert1 -->
<g id="node1995" class="node">
<title>gpu7_layer10_expert1</title>
<polygon fill="lightblue" stroke="black" points="4448,-7386.23 4326,-7386.23 4326,-7334.23 4448,-7334.23 4448,-7386.23"/>
<text text-anchor="middle" x="4387" y="-7374.23" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="4387" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer10_routing&#45;&gt;gpu7_layer10_expert1 -->
<g id="edge2472" class="edge">
<title>gpu7_layer10_routing&#45;&gt;gpu7_layer10_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4461.51,-7432.02C4447.48,-7418.69 4433.21,-7405.14 4420.97,-7393.5"/>
<polygon fill="black" stroke="black" points="4423.29,-7390.88 4413.63,-7386.53 4418.46,-7395.95 4423.29,-7390.88"/>
<text text-anchor="middle" x="4469.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer10_expert2 -->
<g id="node1996" class="node">
<title>gpu7_layer10_expert2</title>
<polygon fill="lightblue" stroke="black" points="4588,-7386.23 4466,-7386.23 4466,-7334.23 4588,-7334.23 4588,-7386.23"/>
<text text-anchor="middle" x="4527" y="-7374.23" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="4527" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer10_routing&#45;&gt;gpu7_layer10_expert2 -->
<g id="edge2473" class="edge">
<title>gpu7_layer10_routing&#45;&gt;gpu7_layer10_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4527,-7432.02C4527,-7419.95 4527,-7407.69 4527,-7396.85"/>
<polygon fill="black" stroke="black" points="4530.5,-7396.53 4527,-7386.53 4523.5,-7396.53 4530.5,-7396.53"/>
<text text-anchor="middle" x="4556.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer10_expert3 -->
<g id="node1997" class="node">
<title>gpu7_layer10_expert3</title>
<polygon fill="lightblue" stroke="black" points="4728,-7386.23 4606,-7386.23 4606,-7334.23 4728,-7334.23 4728,-7386.23"/>
<text text-anchor="middle" x="4667" y="-7374.23" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4667" y="-7363.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-7352.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-7341.23" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer10_routing&#45;&gt;gpu7_layer10_expert3 -->
<g id="edge2474" class="edge">
<title>gpu7_layer10_routing&#45;&gt;gpu7_layer10_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4592.49,-7432.02C4606.52,-7418.69 4620.79,-7405.14 4633.03,-7393.5"/>
<polygon fill="black" stroke="black" points="4635.54,-7395.95 4640.37,-7386.53 4630.71,-7390.88 4635.54,-7395.95"/>
<text text-anchor="middle" x="4650.5" y="-7407.03" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer10_expert_agg -->
<g id="node1998" class="node">
<title>gpu7_layer10_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-7297.23 4452.29,-7297.23 4400.53,-7193.23 4601.71,-7193.23 4653.47,-7297.23"/>
<text text-anchor="middle" x="4527" y="-7259.23" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="4527" y="-7248.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-7237.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-7226.23" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer10_routing&#45;&gt;gpu7_layer10_expert_agg -->
<g id="edge2489" class="edge">
<title>gpu7_layer10_routing&#45;&gt;gpu7_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M4616.22,-7467.32C4689.96,-7440.16 4776.6,-7393.77 4737,-7334.23 4716.44,-7303.32 4682.7,-7283.25 4648.22,-7270.22"/>
<polygon fill="black" stroke="black" points="4649.08,-7266.81 4638.48,-7266.73 4646.71,-7273.4 4649.08,-7266.81"/>
</g>
<!-- gpu7_layer10_expert0&#45;&gt;gpu7_layer10_expert_agg -->
<g id="edge2485" class="edge">
<title>gpu7_layer10_expert0&#45;&gt;gpu7_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M4308.1,-7334.58C4344.98,-7319.69 4392.7,-7300.44 4434.16,-7283.7"/>
<polygon fill="black" stroke="black" points="4435.5,-7286.94 4443.46,-7279.95 4432.88,-7280.45 4435.5,-7286.94"/>
</g>
<!-- gpu7_layer10_expert1&#45;&gt;gpu7_layer10_expert_agg -->
<g id="edge2486" class="edge">
<title>gpu7_layer10_expert1&#45;&gt;gpu7_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M4418.07,-7334.16C4429.32,-7325.08 4442.53,-7314.42 4455.8,-7303.71"/>
<polygon fill="black" stroke="black" points="4458.02,-7306.41 4463.6,-7297.41 4453.62,-7300.96 4458.02,-7306.41"/>
</g>
<!-- gpu7_layer10_expert2&#45;&gt;gpu7_layer10_expert_agg -->
<g id="edge2487" class="edge">
<title>gpu7_layer10_expert2&#45;&gt;gpu7_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M4527,-7334.16C4527,-7326.23 4527,-7317.09 4527,-7307.77"/>
<polygon fill="black" stroke="black" points="4530.5,-7307.64 4527,-7297.64 4523.5,-7307.64 4530.5,-7307.64"/>
</g>
<!-- gpu7_layer10_expert3&#45;&gt;gpu7_layer10_expert_agg -->
<g id="edge2488" class="edge">
<title>gpu7_layer10_expert3&#45;&gt;gpu7_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M4635.93,-7334.16C4624.68,-7325.08 4611.47,-7314.42 4598.2,-7303.71"/>
<polygon fill="black" stroke="black" points="4600.38,-7300.96 4590.4,-7297.41 4595.98,-7306.41 4600.38,-7300.96"/>
</g>
<!-- gpu7_layer10_res2 -->
<g id="node1999" class="node">
<title>gpu7_layer10_res2</title>
<polygon fill="lightblue" stroke="black" points="4588,-7156.23 4466,-7156.23 4466,-7104.23 4588,-7104.23 4588,-7156.23"/>
<text text-anchor="middle" x="4527" y="-7144.23" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="4527" y="-7133.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-7122.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-7111.23" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer10_expert_agg&#45;&gt;gpu7_layer10_res2 -->
<g id="edge2490" class="edge">
<title>gpu7_layer10_expert_agg&#45;&gt;gpu7_layer10_res2</title>
<path fill="none" stroke="black" d="M4527,-7193.02C4527,-7184.07 4527,-7174.94 4527,-7166.55"/>
<polygon fill="black" stroke="black" points="4530.5,-7166.37 4527,-7156.37 4523.5,-7166.37 4530.5,-7166.37"/>
</g>
<!-- gpu7_layer11_ln1 -->
<g id="node2000" class="node">
<title>gpu7_layer11_ln1</title>
<polygon fill="lightblue" stroke="black" points="4588,-7067.23 4466,-7067.23 4466,-7015.23 4588,-7015.23 4588,-7067.23"/>
<text text-anchor="middle" x="4527" y="-7055.23" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="4527" y="-7044.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-7033.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-7022.23" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer10_res2&#45;&gt;gpu7_layer11_ln1 -->
<g id="edge2495" class="edge">
<title>gpu7_layer10_res2&#45;&gt;gpu7_layer11_ln1</title>
<path fill="none" stroke="black" d="M4527,-7104.07C4527,-7095.77 4527,-7086.39 4527,-7077.48"/>
<polygon fill="black" stroke="black" points="4530.5,-7077.34 4527,-7067.34 4523.5,-7077.34 4530.5,-7077.34"/>
</g>
<!-- gpu7_layer11_qkv -->
<g id="node2001" class="node">
<title>gpu7_layer11_qkv</title>
<polygon fill="lightblue" stroke="black" points="4588,-6978.23 4466,-6978.23 4466,-6926.23 4588,-6926.23 4588,-6978.23"/>
<text text-anchor="middle" x="4527" y="-6966.23" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4527" y="-6955.23" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-6944.23" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-6933.23" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer11_ln1&#45;&gt;gpu7_layer11_qkv -->
<g id="edge2496" class="edge">
<title>gpu7_layer11_ln1&#45;&gt;gpu7_layer11_qkv</title>
<path fill="none" stroke="black" d="M4527,-7015.07C4527,-7006.77 4527,-6997.39 4527,-6988.48"/>
<polygon fill="black" stroke="black" points="4530.5,-6988.34 4527,-6978.34 4523.5,-6988.34 4530.5,-6988.34"/>
</g>
<!-- gpu7_layer11_reshape -->
<g id="node2002" class="node">
<title>gpu7_layer11_reshape</title>
<polygon fill="lightblue" stroke="black" points="4591,-6889.23 4463,-6889.23 4463,-6837.23 4591,-6837.23 4591,-6889.23"/>
<text text-anchor="middle" x="4527" y="-6877.23" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="4527" y="-6866.23" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-6855.23" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-6844.23" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer11_qkv&#45;&gt;gpu7_layer11_reshape -->
<g id="edge2497" class="edge">
<title>gpu7_layer11_qkv&#45;&gt;gpu7_layer11_reshape</title>
<path fill="none" stroke="black" d="M4527,-6926.07C4527,-6917.77 4527,-6908.39 4527,-6899.48"/>
<polygon fill="black" stroke="black" points="4530.5,-6899.34 4527,-6889.34 4523.5,-6899.34 4530.5,-6899.34"/>
</g>
<!-- gpu7_layer11_attn -->
<g id="node2003" class="node">
<title>gpu7_layer11_attn</title>
<polygon fill="lightblue" stroke="black" points="4591,-6800.23 4463,-6800.23 4463,-6748.23 4591,-6748.23 4591,-6800.23"/>
<text text-anchor="middle" x="4527" y="-6788.23" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="4527" y="-6777.23" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-6766.23" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-6755.23" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer11_reshape&#45;&gt;gpu7_layer11_attn -->
<g id="edge2498" class="edge">
<title>gpu7_layer11_reshape&#45;&gt;gpu7_layer11_attn</title>
<path fill="none" stroke="black" d="M4527,-6837.07C4527,-6828.77 4527,-6819.39 4527,-6810.48"/>
<polygon fill="black" stroke="black" points="4530.5,-6810.34 4527,-6800.34 4523.5,-6810.34 4530.5,-6810.34"/>
</g>
<!-- gpu7_layer11_attn_reshape -->
<g id="node2005" class="node">
<title>gpu7_layer11_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="4588,-6711.23 4466,-6711.23 4466,-6659.23 4588,-6659.23 4588,-6711.23"/>
<text text-anchor="middle" x="4527" y="-6699.23" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="4527" y="-6688.23" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-6677.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-6666.23" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer11_attn&#45;&gt;gpu7_layer11_attn_reshape -->
<g id="edge2499" class="edge">
<title>gpu7_layer11_attn&#45;&gt;gpu7_layer11_attn_reshape</title>
<path fill="none" stroke="black" d="M4527,-6748.07C4527,-6739.77 4527,-6730.39 4527,-6721.48"/>
<polygon fill="black" stroke="black" points="4530.5,-6721.34 4527,-6711.34 4523.5,-6721.34 4530.5,-6721.34"/>
</g>
<!-- gpu7_layer11_attn_out -->
<g id="node2004" class="node">
<title>gpu7_layer11_attn_out</title>
<polygon fill="lightblue" stroke="black" points="4588,-6622.23 4466,-6622.23 4466,-6570.23 4588,-6570.23 4588,-6622.23"/>
<text text-anchor="middle" x="4527" y="-6610.23" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="4527" y="-6599.23" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-6588.23" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-6577.23" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer11_kv_update -->
<g id="node2006" class="node">
<title>gpu7_layer11_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="4527" cy="-6496.47" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="4527" y="-6510.47" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="4527" y="-6499.47" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-6488.47" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-6477.47" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer11_attn_out&#45;&gt;gpu7_layer11_kv_update -->
<g id="edge2501" class="edge">
<title>gpu7_layer11_attn_out&#45;&gt;gpu7_layer11_kv_update</title>
<path fill="none" stroke="black" d="M4527,-6570.06C4527,-6561.92 4527,-6552.62 4527,-6543.46"/>
<polygon fill="black" stroke="black" points="4530.5,-6543.24 4527,-6533.24 4523.5,-6543.24 4530.5,-6543.24"/>
</g>
<!-- gpu7_layer11_attn_reshape&#45;&gt;gpu7_layer11_attn_out -->
<g id="edge2500" class="edge">
<title>gpu7_layer11_attn_reshape&#45;&gt;gpu7_layer11_attn_out</title>
<path fill="none" stroke="black" d="M4527,-6659.07C4527,-6650.77 4527,-6641.39 4527,-6632.48"/>
<polygon fill="black" stroke="black" points="4530.5,-6632.34 4527,-6622.34 4523.5,-6632.34 4530.5,-6632.34"/>
</g>
<!-- gpu7_layer11_res1 -->
<g id="node2007" class="node">
<title>gpu7_layer11_res1</title>
<polygon fill="lightblue" stroke="black" points="4588,-6422.7 4466,-6422.7 4466,-6370.7 4588,-6370.7 4588,-6422.7"/>
<text text-anchor="middle" x="4527" y="-6410.7" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="4527" y="-6399.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-6388.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-6377.7" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer11_kv_update&#45;&gt;gpu7_layer11_res1 -->
<g id="edge2502" class="edge">
<title>gpu7_layer11_kv_update&#45;&gt;gpu7_layer11_res1</title>
<path fill="none" stroke="black" d="M4527,-6459.61C4527,-6450.94 4527,-6441.67 4527,-6433.01"/>
<polygon fill="black" stroke="black" points="4530.5,-6432.84 4527,-6422.84 4523.5,-6432.84 4530.5,-6432.84"/>
</g>
<!-- gpu7_layer11_ln2 -->
<g id="node2008" class="node">
<title>gpu7_layer11_ln2</title>
<polygon fill="lightblue" stroke="black" points="4588,-6333.7 4466,-6333.7 4466,-6281.7 4588,-6281.7 4588,-6333.7"/>
<text text-anchor="middle" x="4527" y="-6321.7" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="4527" y="-6310.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-6299.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-6288.7" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer11_res1&#45;&gt;gpu7_layer11_ln2 -->
<g id="edge2503" class="edge">
<title>gpu7_layer11_res1&#45;&gt;gpu7_layer11_ln2</title>
<path fill="none" stroke="black" d="M4527,-6370.53C4527,-6362.24 4527,-6352.85 4527,-6343.94"/>
<polygon fill="black" stroke="black" points="4530.5,-6343.8 4527,-6333.8 4523.5,-6343.8 4530.5,-6343.8"/>
</g>
<!-- gpu7_layer11_routing -->
<g id="node2009" class="node">
<title>gpu7_layer11_routing</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-6244.7 4452.29,-6244.7 4400.53,-6118.7 4601.71,-6118.7 4653.47,-6244.7"/>
<text text-anchor="middle" x="4527" y="-6201.2" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="4527" y="-6190.2" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-6179.2" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-6168.2" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="4527" y="-6157.2" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer11_ln2&#45;&gt;gpu7_layer11_routing -->
<g id="edge2504" class="edge">
<title>gpu7_layer11_ln2&#45;&gt;gpu7_layer11_routing</title>
<path fill="none" stroke="black" d="M4527,-6281.6C4527,-6273.67 4527,-6264.47 4527,-6254.94"/>
<polygon fill="black" stroke="black" points="4530.5,-6254.93 4527,-6244.93 4523.5,-6254.93 4530.5,-6254.93"/>
</g>
<!-- gpu7_layer11_expert0 -->
<g id="node2010" class="node">
<title>gpu7_layer11_expert0</title>
<polygon fill="lightblue" stroke="black" points="4308,-6072.7 4186,-6072.7 4186,-6020.7 4308,-6020.7 4308,-6072.7"/>
<text text-anchor="middle" x="4247" y="-6060.7" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="4247" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer11_routing&#45;&gt;gpu7_layer11_expert0 -->
<g id="edge2491" class="edge">
<title>gpu7_layer11_routing&#45;&gt;gpu7_layer11_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4401.33,-6121C4369.34,-6105.81 4336.34,-6090.13 4309.11,-6077.2"/>
<polygon fill="black" stroke="black" points="4310.26,-6073.87 4299.73,-6072.74 4307.26,-6080.19 4310.26,-6073.87"/>
<text text-anchor="middle" x="4382.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer11_expert1 -->
<g id="node2011" class="node">
<title>gpu7_layer11_expert1</title>
<polygon fill="lightblue" stroke="black" points="4448,-6072.7 4326,-6072.7 4326,-6020.7 4448,-6020.7 4448,-6072.7"/>
<text text-anchor="middle" x="4387" y="-6060.7" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="4387" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer11_routing&#45;&gt;gpu7_layer11_expert1 -->
<g id="edge2492" class="edge">
<title>gpu7_layer11_routing&#45;&gt;gpu7_layer11_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4461.51,-6118.48C4447.48,-6105.15 4433.21,-6091.6 4420.97,-6079.97"/>
<polygon fill="black" stroke="black" points="4423.29,-6077.34 4413.63,-6072.99 4418.46,-6082.41 4423.29,-6077.34"/>
<text text-anchor="middle" x="4469.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer11_expert2 -->
<g id="node2012" class="node">
<title>gpu7_layer11_expert2</title>
<polygon fill="lightblue" stroke="black" points="4588,-6072.7 4466,-6072.7 4466,-6020.7 4588,-6020.7 4588,-6072.7"/>
<text text-anchor="middle" x="4527" y="-6060.7" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="4527" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer11_routing&#45;&gt;gpu7_layer11_expert2 -->
<g id="edge2493" class="edge">
<title>gpu7_layer11_routing&#45;&gt;gpu7_layer11_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4527,-6118.48C4527,-6106.41 4527,-6094.15 4527,-6083.31"/>
<polygon fill="black" stroke="black" points="4530.5,-6082.99 4527,-6072.99 4523.5,-6082.99 4530.5,-6082.99"/>
<text text-anchor="middle" x="4556.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer11_expert3 -->
<g id="node2013" class="node">
<title>gpu7_layer11_expert3</title>
<polygon fill="lightblue" stroke="black" points="4728,-6072.7 4606,-6072.7 4606,-6020.7 4728,-6020.7 4728,-6072.7"/>
<text text-anchor="middle" x="4667" y="-6060.7" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4667" y="-6049.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-6038.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-6027.7" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer11_routing&#45;&gt;gpu7_layer11_expert3 -->
<g id="edge2494" class="edge">
<title>gpu7_layer11_routing&#45;&gt;gpu7_layer11_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4592.49,-6118.48C4606.52,-6105.15 4620.79,-6091.6 4633.03,-6079.97"/>
<polygon fill="black" stroke="black" points="4635.54,-6082.41 4640.37,-6072.99 4630.71,-6077.34 4635.54,-6082.41"/>
<text text-anchor="middle" x="4650.5" y="-6093.5" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer11_expert_agg -->
<g id="node2014" class="node">
<title>gpu7_layer11_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-5983.7 4452.29,-5983.7 4400.53,-5879.7 4601.71,-5879.7 4653.47,-5983.7"/>
<text text-anchor="middle" x="4527" y="-5945.7" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="4527" y="-5934.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-5923.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-5912.7" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer11_routing&#45;&gt;gpu7_layer11_expert_agg -->
<g id="edge2509" class="edge">
<title>gpu7_layer11_routing&#45;&gt;gpu7_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M4616.22,-6153.78C4689.96,-6126.62 4776.6,-6080.23 4737,-6020.7 4716.44,-5989.78 4682.7,-5969.71 4648.22,-5956.68"/>
<polygon fill="black" stroke="black" points="4649.08,-5953.27 4638.48,-5953.19 4646.71,-5959.86 4649.08,-5953.27"/>
</g>
<!-- gpu7_layer11_expert0&#45;&gt;gpu7_layer11_expert_agg -->
<g id="edge2505" class="edge">
<title>gpu7_layer11_expert0&#45;&gt;gpu7_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M4308.1,-6021.04C4344.98,-6006.15 4392.7,-5986.9 4434.16,-5970.16"/>
<polygon fill="black" stroke="black" points="4435.5,-5973.4 4443.46,-5966.41 4432.88,-5966.91 4435.5,-5973.4"/>
</g>
<!-- gpu7_layer11_expert1&#45;&gt;gpu7_layer11_expert_agg -->
<g id="edge2506" class="edge">
<title>gpu7_layer11_expert1&#45;&gt;gpu7_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M4418.07,-6020.62C4429.32,-6011.54 4442.53,-6000.88 4455.8,-5990.17"/>
<polygon fill="black" stroke="black" points="4458.02,-5992.87 4463.6,-5983.87 4453.62,-5987.42 4458.02,-5992.87"/>
</g>
<!-- gpu7_layer11_expert2&#45;&gt;gpu7_layer11_expert_agg -->
<g id="edge2507" class="edge">
<title>gpu7_layer11_expert2&#45;&gt;gpu7_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M4527,-6020.62C4527,-6012.69 4527,-6003.55 4527,-5994.23"/>
<polygon fill="black" stroke="black" points="4530.5,-5994.1 4527,-5984.1 4523.5,-5994.1 4530.5,-5994.1"/>
</g>
<!-- gpu7_layer11_expert3&#45;&gt;gpu7_layer11_expert_agg -->
<g id="edge2508" class="edge">
<title>gpu7_layer11_expert3&#45;&gt;gpu7_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M4635.93,-6020.62C4624.68,-6011.54 4611.47,-6000.88 4598.2,-5990.17"/>
<polygon fill="black" stroke="black" points="4600.38,-5987.42 4590.4,-5983.87 4595.98,-5992.87 4600.38,-5987.42"/>
</g>
<!-- gpu7_layer11_res2 -->
<g id="node2015" class="node">
<title>gpu7_layer11_res2</title>
<polygon fill="lightblue" stroke="black" points="4588,-5842.7 4466,-5842.7 4466,-5790.7 4588,-5790.7 4588,-5842.7"/>
<text text-anchor="middle" x="4527" y="-5830.7" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="4527" y="-5819.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-5808.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-5797.7" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer11_expert_agg&#45;&gt;gpu7_layer11_res2 -->
<g id="edge2510" class="edge">
<title>gpu7_layer11_expert_agg&#45;&gt;gpu7_layer11_res2</title>
<path fill="none" stroke="black" d="M4527,-5879.49C4527,-5870.53 4527,-5861.41 4527,-5853.01"/>
<polygon fill="black" stroke="black" points="4530.5,-5852.83 4527,-5842.83 4523.5,-5852.83 4530.5,-5852.83"/>
</g>
<!-- gpu7_layer12_ln1 -->
<g id="node2016" class="node">
<title>gpu7_layer12_ln1</title>
<polygon fill="lightblue" stroke="black" points="4588,-5753.7 4466,-5753.7 4466,-5701.7 4588,-5701.7 4588,-5753.7"/>
<text text-anchor="middle" x="4527" y="-5741.7" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="4527" y="-5730.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-5719.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-5708.7" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer11_res2&#45;&gt;gpu7_layer12_ln1 -->
<g id="edge2515" class="edge">
<title>gpu7_layer11_res2&#45;&gt;gpu7_layer12_ln1</title>
<path fill="none" stroke="black" d="M4527,-5790.53C4527,-5782.24 4527,-5772.85 4527,-5763.94"/>
<polygon fill="black" stroke="black" points="4530.5,-5763.8 4527,-5753.8 4523.5,-5763.8 4530.5,-5763.8"/>
</g>
<!-- gpu7_layer12_qkv -->
<g id="node2017" class="node">
<title>gpu7_layer12_qkv</title>
<polygon fill="lightblue" stroke="black" points="4588,-5664.7 4466,-5664.7 4466,-5612.7 4588,-5612.7 4588,-5664.7"/>
<text text-anchor="middle" x="4527" y="-5652.7" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4527" y="-5641.7" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-5630.7" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-5619.7" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer12_ln1&#45;&gt;gpu7_layer12_qkv -->
<g id="edge2516" class="edge">
<title>gpu7_layer12_ln1&#45;&gt;gpu7_layer12_qkv</title>
<path fill="none" stroke="black" d="M4527,-5701.53C4527,-5693.24 4527,-5683.85 4527,-5674.94"/>
<polygon fill="black" stroke="black" points="4530.5,-5674.8 4527,-5664.8 4523.5,-5674.8 4530.5,-5674.8"/>
</g>
<!-- gpu7_layer12_reshape -->
<g id="node2018" class="node">
<title>gpu7_layer12_reshape</title>
<polygon fill="lightblue" stroke="black" points="4591,-5575.7 4463,-5575.7 4463,-5523.7 4591,-5523.7 4591,-5575.7"/>
<text text-anchor="middle" x="4527" y="-5563.7" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="4527" y="-5552.7" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-5541.7" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-5530.7" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer12_qkv&#45;&gt;gpu7_layer12_reshape -->
<g id="edge2517" class="edge">
<title>gpu7_layer12_qkv&#45;&gt;gpu7_layer12_reshape</title>
<path fill="none" stroke="black" d="M4527,-5612.53C4527,-5604.24 4527,-5594.85 4527,-5585.94"/>
<polygon fill="black" stroke="black" points="4530.5,-5585.8 4527,-5575.8 4523.5,-5585.8 4530.5,-5585.8"/>
</g>
<!-- gpu7_layer12_attn -->
<g id="node2019" class="node">
<title>gpu7_layer12_attn</title>
<polygon fill="lightblue" stroke="black" points="4591,-5486.7 4463,-5486.7 4463,-5434.7 4591,-5434.7 4591,-5486.7"/>
<text text-anchor="middle" x="4527" y="-5474.7" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="4527" y="-5463.7" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-5452.7" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-5441.7" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer12_reshape&#45;&gt;gpu7_layer12_attn -->
<g id="edge2518" class="edge">
<title>gpu7_layer12_reshape&#45;&gt;gpu7_layer12_attn</title>
<path fill="none" stroke="black" d="M4527,-5523.53C4527,-5515.24 4527,-5505.85 4527,-5496.94"/>
<polygon fill="black" stroke="black" points="4530.5,-5496.8 4527,-5486.8 4523.5,-5496.8 4530.5,-5496.8"/>
</g>
<!-- gpu7_layer12_attn_reshape -->
<g id="node2021" class="node">
<title>gpu7_layer12_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="4588,-5397.7 4466,-5397.7 4466,-5345.7 4588,-5345.7 4588,-5397.7"/>
<text text-anchor="middle" x="4527" y="-5385.7" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="4527" y="-5374.7" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-5363.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-5352.7" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer12_attn&#45;&gt;gpu7_layer12_attn_reshape -->
<g id="edge2519" class="edge">
<title>gpu7_layer12_attn&#45;&gt;gpu7_layer12_attn_reshape</title>
<path fill="none" stroke="black" d="M4527,-5434.53C4527,-5426.24 4527,-5416.85 4527,-5407.94"/>
<polygon fill="black" stroke="black" points="4530.5,-5407.8 4527,-5397.8 4523.5,-5407.8 4530.5,-5407.8"/>
</g>
<!-- gpu7_layer12_attn_out -->
<g id="node2020" class="node">
<title>gpu7_layer12_attn_out</title>
<polygon fill="lightblue" stroke="black" points="4588,-5308.7 4466,-5308.7 4466,-5256.7 4588,-5256.7 4588,-5308.7"/>
<text text-anchor="middle" x="4527" y="-5296.7" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="4527" y="-5285.7" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-5274.7" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-5263.7" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer12_kv_update -->
<g id="node2022" class="node">
<title>gpu7_layer12_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="4527" cy="-5182.93" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="4527" y="-5196.93" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="4527" y="-5185.93" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-5174.93" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-5163.93" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer12_attn_out&#45;&gt;gpu7_layer12_kv_update -->
<g id="edge2521" class="edge">
<title>gpu7_layer12_attn_out&#45;&gt;gpu7_layer12_kv_update</title>
<path fill="none" stroke="black" d="M4527,-5256.52C4527,-5248.38 4527,-5239.08 4527,-5229.92"/>
<polygon fill="black" stroke="black" points="4530.5,-5229.71 4527,-5219.71 4523.5,-5229.71 4530.5,-5229.71"/>
</g>
<!-- gpu7_layer12_attn_reshape&#45;&gt;gpu7_layer12_attn_out -->
<g id="edge2520" class="edge">
<title>gpu7_layer12_attn_reshape&#45;&gt;gpu7_layer12_attn_out</title>
<path fill="none" stroke="black" d="M4527,-5345.53C4527,-5337.24 4527,-5327.85 4527,-5318.94"/>
<polygon fill="black" stroke="black" points="4530.5,-5318.8 4527,-5308.8 4523.5,-5318.8 4530.5,-5318.8"/>
</g>
<!-- gpu7_layer12_res1 -->
<g id="node2023" class="node">
<title>gpu7_layer12_res1</title>
<polygon fill="lightblue" stroke="black" points="4588,-5109.16 4466,-5109.16 4466,-5057.16 4588,-5057.16 4588,-5109.16"/>
<text text-anchor="middle" x="4527" y="-5097.16" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="4527" y="-5086.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-5075.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-5064.16" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer12_kv_update&#45;&gt;gpu7_layer12_res1 -->
<g id="edge2522" class="edge">
<title>gpu7_layer12_kv_update&#45;&gt;gpu7_layer12_res1</title>
<path fill="none" stroke="black" d="M4527,-5146.08C4527,-5137.4 4527,-5128.13 4527,-5119.47"/>
<polygon fill="black" stroke="black" points="4530.5,-5119.3 4527,-5109.3 4523.5,-5119.3 4530.5,-5119.3"/>
</g>
<!-- gpu7_layer12_ln2 -->
<g id="node2024" class="node">
<title>gpu7_layer12_ln2</title>
<polygon fill="lightblue" stroke="black" points="4588,-5020.16 4466,-5020.16 4466,-4968.16 4588,-4968.16 4588,-5020.16"/>
<text text-anchor="middle" x="4527" y="-5008.16" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="4527" y="-4997.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-4986.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-4975.16" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer12_res1&#45;&gt;gpu7_layer12_ln2 -->
<g id="edge2523" class="edge">
<title>gpu7_layer12_res1&#45;&gt;gpu7_layer12_ln2</title>
<path fill="none" stroke="black" d="M4527,-5056.99C4527,-5048.7 4527,-5039.31 4527,-5030.4"/>
<polygon fill="black" stroke="black" points="4530.5,-5030.26 4527,-5020.26 4523.5,-5030.26 4530.5,-5030.26"/>
</g>
<!-- gpu7_layer12_routing -->
<g id="node2025" class="node">
<title>gpu7_layer12_routing</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-4931.16 4452.29,-4931.16 4400.53,-4805.16 4601.71,-4805.16 4653.47,-4931.16"/>
<text text-anchor="middle" x="4527" y="-4887.66" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="4527" y="-4876.66" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-4865.66" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-4854.66" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="4527" y="-4843.66" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer12_ln2&#45;&gt;gpu7_layer12_routing -->
<g id="edge2524" class="edge">
<title>gpu7_layer12_ln2&#45;&gt;gpu7_layer12_routing</title>
<path fill="none" stroke="black" d="M4527,-4968.06C4527,-4960.13 4527,-4950.93 4527,-4941.4"/>
<polygon fill="black" stroke="black" points="4530.5,-4941.39 4527,-4931.39 4523.5,-4941.39 4530.5,-4941.39"/>
</g>
<!-- gpu7_layer12_expert0 -->
<g id="node2026" class="node">
<title>gpu7_layer12_expert0</title>
<polygon fill="lightblue" stroke="black" points="4308,-4759.16 4186,-4759.16 4186,-4707.16 4308,-4707.16 4308,-4759.16"/>
<text text-anchor="middle" x="4247" y="-4747.16" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="4247" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer12_routing&#45;&gt;gpu7_layer12_expert0 -->
<g id="edge2511" class="edge">
<title>gpu7_layer12_routing&#45;&gt;gpu7_layer12_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4401.33,-4807.46C4369.34,-4792.27 4336.34,-4776.59 4309.11,-4763.66"/>
<polygon fill="black" stroke="black" points="4310.26,-4760.33 4299.73,-4759.2 4307.26,-4766.65 4310.26,-4760.33"/>
<text text-anchor="middle" x="4382.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer12_expert1 -->
<g id="node2027" class="node">
<title>gpu7_layer12_expert1</title>
<polygon fill="lightblue" stroke="black" points="4448,-4759.16 4326,-4759.16 4326,-4707.16 4448,-4707.16 4448,-4759.16"/>
<text text-anchor="middle" x="4387" y="-4747.16" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="4387" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer12_routing&#45;&gt;gpu7_layer12_expert1 -->
<g id="edge2512" class="edge">
<title>gpu7_layer12_routing&#45;&gt;gpu7_layer12_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4461.51,-4804.94C4447.48,-4791.62 4433.21,-4778.06 4420.97,-4766.43"/>
<polygon fill="black" stroke="black" points="4423.29,-4763.8 4413.63,-4759.45 4418.46,-4768.88 4423.29,-4763.8"/>
<text text-anchor="middle" x="4469.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer12_expert2 -->
<g id="node2028" class="node">
<title>gpu7_layer12_expert2</title>
<polygon fill="lightblue" stroke="black" points="4588,-4759.16 4466,-4759.16 4466,-4707.16 4588,-4707.16 4588,-4759.16"/>
<text text-anchor="middle" x="4527" y="-4747.16" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="4527" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer12_routing&#45;&gt;gpu7_layer12_expert2 -->
<g id="edge2513" class="edge">
<title>gpu7_layer12_routing&#45;&gt;gpu7_layer12_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4527,-4804.94C4527,-4792.87 4527,-4780.62 4527,-4769.77"/>
<polygon fill="black" stroke="black" points="4530.5,-4769.45 4527,-4759.45 4523.5,-4769.45 4530.5,-4769.45"/>
<text text-anchor="middle" x="4556.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer12_expert3 -->
<g id="node2029" class="node">
<title>gpu7_layer12_expert3</title>
<polygon fill="lightblue" stroke="black" points="4728,-4759.16 4606,-4759.16 4606,-4707.16 4728,-4707.16 4728,-4759.16"/>
<text text-anchor="middle" x="4667" y="-4747.16" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4667" y="-4736.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-4725.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-4714.16" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer12_routing&#45;&gt;gpu7_layer12_expert3 -->
<g id="edge2514" class="edge">
<title>gpu7_layer12_routing&#45;&gt;gpu7_layer12_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4592.49,-4804.94C4606.52,-4791.62 4620.79,-4778.06 4633.03,-4766.43"/>
<polygon fill="black" stroke="black" points="4635.54,-4768.88 4640.37,-4759.45 4630.71,-4763.8 4635.54,-4768.88"/>
<text text-anchor="middle" x="4650.5" y="-4779.96" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer12_expert_agg -->
<g id="node2030" class="node">
<title>gpu7_layer12_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-4670.16 4452.29,-4670.16 4400.53,-4566.16 4601.71,-4566.16 4653.47,-4670.16"/>
<text text-anchor="middle" x="4527" y="-4632.16" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="4527" y="-4621.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-4610.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-4599.16" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer12_routing&#45;&gt;gpu7_layer12_expert_agg -->
<g id="edge2529" class="edge">
<title>gpu7_layer12_routing&#45;&gt;gpu7_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M4616.22,-4840.24C4689.96,-4813.08 4776.6,-4766.69 4737,-4707.16 4716.44,-4676.24 4682.7,-4656.17 4648.22,-4643.14"/>
<polygon fill="black" stroke="black" points="4649.08,-4639.73 4638.48,-4639.65 4646.71,-4646.32 4649.08,-4639.73"/>
</g>
<!-- gpu7_layer12_expert0&#45;&gt;gpu7_layer12_expert_agg -->
<g id="edge2525" class="edge">
<title>gpu7_layer12_expert0&#45;&gt;gpu7_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M4308.1,-4707.5C4344.98,-4692.62 4392.7,-4673.36 4434.16,-4656.62"/>
<polygon fill="black" stroke="black" points="4435.5,-4659.86 4443.46,-4652.87 4432.88,-4653.37 4435.5,-4659.86"/>
</g>
<!-- gpu7_layer12_expert1&#45;&gt;gpu7_layer12_expert_agg -->
<g id="edge2526" class="edge">
<title>gpu7_layer12_expert1&#45;&gt;gpu7_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M4418.07,-4707.08C4429.32,-4698 4442.53,-4687.34 4455.8,-4676.63"/>
<polygon fill="black" stroke="black" points="4458.02,-4679.33 4463.6,-4670.33 4453.62,-4673.89 4458.02,-4679.33"/>
</g>
<!-- gpu7_layer12_expert2&#45;&gt;gpu7_layer12_expert_agg -->
<g id="edge2527" class="edge">
<title>gpu7_layer12_expert2&#45;&gt;gpu7_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M4527,-4707.08C4527,-4699.15 4527,-4690.02 4527,-4680.69"/>
<polygon fill="black" stroke="black" points="4530.5,-4680.56 4527,-4670.56 4523.5,-4680.56 4530.5,-4680.56"/>
</g>
<!-- gpu7_layer12_expert3&#45;&gt;gpu7_layer12_expert_agg -->
<g id="edge2528" class="edge">
<title>gpu7_layer12_expert3&#45;&gt;gpu7_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M4635.93,-4707.08C4624.68,-4698 4611.47,-4687.34 4598.2,-4676.63"/>
<polygon fill="black" stroke="black" points="4600.38,-4673.89 4590.4,-4670.33 4595.98,-4679.33 4600.38,-4673.89"/>
</g>
<!-- gpu7_layer12_res2 -->
<g id="node2031" class="node">
<title>gpu7_layer12_res2</title>
<polygon fill="lightblue" stroke="black" points="4588,-4529.16 4466,-4529.16 4466,-4477.16 4588,-4477.16 4588,-4529.16"/>
<text text-anchor="middle" x="4527" y="-4517.16" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="4527" y="-4506.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-4495.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-4484.16" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer12_expert_agg&#45;&gt;gpu7_layer12_res2 -->
<g id="edge2530" class="edge">
<title>gpu7_layer12_expert_agg&#45;&gt;gpu7_layer12_res2</title>
<path fill="none" stroke="black" d="M4527,-4565.95C4527,-4557 4527,-4547.87 4527,-4539.47"/>
<polygon fill="black" stroke="black" points="4530.5,-4539.29 4527,-4529.29 4523.5,-4539.29 4530.5,-4539.29"/>
</g>
<!-- gpu7_layer13_ln1 -->
<g id="node2032" class="node">
<title>gpu7_layer13_ln1</title>
<polygon fill="lightblue" stroke="black" points="4588,-4440.16 4466,-4440.16 4466,-4388.16 4588,-4388.16 4588,-4440.16"/>
<text text-anchor="middle" x="4527" y="-4428.16" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="4527" y="-4417.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-4406.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-4395.16" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer12_res2&#45;&gt;gpu7_layer13_ln1 -->
<g id="edge2535" class="edge">
<title>gpu7_layer12_res2&#45;&gt;gpu7_layer13_ln1</title>
<path fill="none" stroke="black" d="M4527,-4476.99C4527,-4468.7 4527,-4459.31 4527,-4450.4"/>
<polygon fill="black" stroke="black" points="4530.5,-4450.26 4527,-4440.26 4523.5,-4450.26 4530.5,-4450.26"/>
</g>
<!-- gpu7_layer13_qkv -->
<g id="node2033" class="node">
<title>gpu7_layer13_qkv</title>
<polygon fill="lightblue" stroke="black" points="4588,-4351.16 4466,-4351.16 4466,-4299.16 4588,-4299.16 4588,-4351.16"/>
<text text-anchor="middle" x="4527" y="-4339.16" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4527" y="-4328.16" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-4317.16" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-4306.16" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer13_ln1&#45;&gt;gpu7_layer13_qkv -->
<g id="edge2536" class="edge">
<title>gpu7_layer13_ln1&#45;&gt;gpu7_layer13_qkv</title>
<path fill="none" stroke="black" d="M4527,-4387.99C4527,-4379.7 4527,-4370.31 4527,-4361.4"/>
<polygon fill="black" stroke="black" points="4530.5,-4361.26 4527,-4351.26 4523.5,-4361.26 4530.5,-4361.26"/>
</g>
<!-- gpu7_layer13_reshape -->
<g id="node2034" class="node">
<title>gpu7_layer13_reshape</title>
<polygon fill="lightblue" stroke="black" points="4591,-4262.16 4463,-4262.16 4463,-4210.16 4591,-4210.16 4591,-4262.16"/>
<text text-anchor="middle" x="4527" y="-4250.16" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="4527" y="-4239.16" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-4228.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-4217.16" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer13_qkv&#45;&gt;gpu7_layer13_reshape -->
<g id="edge2537" class="edge">
<title>gpu7_layer13_qkv&#45;&gt;gpu7_layer13_reshape</title>
<path fill="none" stroke="black" d="M4527,-4298.99C4527,-4290.7 4527,-4281.31 4527,-4272.4"/>
<polygon fill="black" stroke="black" points="4530.5,-4272.26 4527,-4262.26 4523.5,-4272.26 4530.5,-4272.26"/>
</g>
<!-- gpu7_layer13_attn -->
<g id="node2035" class="node">
<title>gpu7_layer13_attn</title>
<polygon fill="lightblue" stroke="black" points="4591,-4173.16 4463,-4173.16 4463,-4121.16 4591,-4121.16 4591,-4173.16"/>
<text text-anchor="middle" x="4527" y="-4161.16" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="4527" y="-4150.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-4139.16" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-4128.16" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer13_reshape&#45;&gt;gpu7_layer13_attn -->
<g id="edge2538" class="edge">
<title>gpu7_layer13_reshape&#45;&gt;gpu7_layer13_attn</title>
<path fill="none" stroke="black" d="M4527,-4209.99C4527,-4201.7 4527,-4192.31 4527,-4183.4"/>
<polygon fill="black" stroke="black" points="4530.5,-4183.26 4527,-4173.26 4523.5,-4183.26 4530.5,-4183.26"/>
</g>
<!-- gpu7_layer13_attn_reshape -->
<g id="node2037" class="node">
<title>gpu7_layer13_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="4588,-4084.16 4466,-4084.16 4466,-4032.16 4588,-4032.16 4588,-4084.16"/>
<text text-anchor="middle" x="4527" y="-4072.16" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="4527" y="-4061.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-4050.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-4039.16" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer13_attn&#45;&gt;gpu7_layer13_attn_reshape -->
<g id="edge2539" class="edge">
<title>gpu7_layer13_attn&#45;&gt;gpu7_layer13_attn_reshape</title>
<path fill="none" stroke="black" d="M4527,-4120.99C4527,-4112.7 4527,-4103.31 4527,-4094.4"/>
<polygon fill="black" stroke="black" points="4530.5,-4094.26 4527,-4084.26 4523.5,-4094.26 4530.5,-4094.26"/>
</g>
<!-- gpu7_layer13_attn_out -->
<g id="node2036" class="node">
<title>gpu7_layer13_attn_out</title>
<polygon fill="lightblue" stroke="black" points="4588,-3995.16 4466,-3995.16 4466,-3943.16 4588,-3943.16 4588,-3995.16"/>
<text text-anchor="middle" x="4527" y="-3983.16" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="4527" y="-3972.16" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-3961.16" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-3950.16" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer13_kv_update -->
<g id="node2038" class="node">
<title>gpu7_layer13_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="4527" cy="-3869.39" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="4527" y="-3883.39" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="4527" y="-3872.39" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-3861.39" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-3850.39" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer13_attn_out&#45;&gt;gpu7_layer13_kv_update -->
<g id="edge2541" class="edge">
<title>gpu7_layer13_attn_out&#45;&gt;gpu7_layer13_kv_update</title>
<path fill="none" stroke="black" d="M4527,-3942.98C4527,-3934.84 4527,-3925.54 4527,-3916.38"/>
<polygon fill="black" stroke="black" points="4530.5,-3916.17 4527,-3906.17 4523.5,-3916.17 4530.5,-3916.17"/>
</g>
<!-- gpu7_layer13_attn_reshape&#45;&gt;gpu7_layer13_attn_out -->
<g id="edge2540" class="edge">
<title>gpu7_layer13_attn_reshape&#45;&gt;gpu7_layer13_attn_out</title>
<path fill="none" stroke="black" d="M4527,-4031.99C4527,-4023.7 4527,-4014.31 4527,-4005.4"/>
<polygon fill="black" stroke="black" points="4530.5,-4005.26 4527,-3995.26 4523.5,-4005.26 4530.5,-4005.26"/>
</g>
<!-- gpu7_layer13_res1 -->
<g id="node2039" class="node">
<title>gpu7_layer13_res1</title>
<polygon fill="lightblue" stroke="black" points="4588,-3795.62 4466,-3795.62 4466,-3743.62 4588,-3743.62 4588,-3795.62"/>
<text text-anchor="middle" x="4527" y="-3783.62" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="4527" y="-3772.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-3761.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-3750.62" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer13_kv_update&#45;&gt;gpu7_layer13_res1 -->
<g id="edge2542" class="edge">
<title>gpu7_layer13_kv_update&#45;&gt;gpu7_layer13_res1</title>
<path fill="none" stroke="black" d="M4527,-3832.54C4527,-3823.86 4527,-3814.59 4527,-3805.93"/>
<polygon fill="black" stroke="black" points="4530.5,-3805.76 4527,-3795.76 4523.5,-3805.76 4530.5,-3805.76"/>
</g>
<!-- gpu7_layer13_ln2 -->
<g id="node2040" class="node">
<title>gpu7_layer13_ln2</title>
<polygon fill="lightblue" stroke="black" points="4588,-3706.62 4466,-3706.62 4466,-3654.62 4588,-3654.62 4588,-3706.62"/>
<text text-anchor="middle" x="4527" y="-3694.62" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="4527" y="-3683.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-3672.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-3661.62" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer13_res1&#45;&gt;gpu7_layer13_ln2 -->
<g id="edge2543" class="edge">
<title>gpu7_layer13_res1&#45;&gt;gpu7_layer13_ln2</title>
<path fill="none" stroke="black" d="M4527,-3743.45C4527,-3735.16 4527,-3725.77 4527,-3716.87"/>
<polygon fill="black" stroke="black" points="4530.5,-3716.72 4527,-3706.72 4523.5,-3716.72 4530.5,-3716.72"/>
</g>
<!-- gpu7_layer13_routing -->
<g id="node2041" class="node">
<title>gpu7_layer13_routing</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-3617.62 4452.29,-3617.62 4400.53,-3491.62 4601.71,-3491.62 4653.47,-3617.62"/>
<text text-anchor="middle" x="4527" y="-3574.12" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="4527" y="-3563.12" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-3552.12" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-3541.12" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="4527" y="-3530.12" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer13_ln2&#45;&gt;gpu7_layer13_routing -->
<g id="edge2544" class="edge">
<title>gpu7_layer13_ln2&#45;&gt;gpu7_layer13_routing</title>
<path fill="none" stroke="black" d="M4527,-3654.52C4527,-3646.59 4527,-3637.4 4527,-3627.87"/>
<polygon fill="black" stroke="black" points="4530.5,-3627.85 4527,-3617.85 4523.5,-3627.85 4530.5,-3627.85"/>
</g>
<!-- gpu7_layer13_expert0 -->
<g id="node2042" class="node">
<title>gpu7_layer13_expert0</title>
<polygon fill="lightblue" stroke="black" points="4308,-3445.62 4186,-3445.62 4186,-3393.62 4308,-3393.62 4308,-3445.62"/>
<text text-anchor="middle" x="4247" y="-3433.62" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="4247" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer13_routing&#45;&gt;gpu7_layer13_expert0 -->
<g id="edge2531" class="edge">
<title>gpu7_layer13_routing&#45;&gt;gpu7_layer13_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4401.33,-3493.93C4369.34,-3478.73 4336.34,-3463.05 4309.11,-3450.12"/>
<polygon fill="black" stroke="black" points="4310.26,-3446.79 4299.73,-3445.66 4307.26,-3453.11 4310.26,-3446.79"/>
<text text-anchor="middle" x="4382.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer13_expert1 -->
<g id="node2043" class="node">
<title>gpu7_layer13_expert1</title>
<polygon fill="lightblue" stroke="black" points="4448,-3445.62 4326,-3445.62 4326,-3393.62 4448,-3393.62 4448,-3445.62"/>
<text text-anchor="middle" x="4387" y="-3433.62" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="4387" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer13_routing&#45;&gt;gpu7_layer13_expert1 -->
<g id="edge2532" class="edge">
<title>gpu7_layer13_routing&#45;&gt;gpu7_layer13_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4461.51,-3491.4C4447.48,-3478.08 4433.21,-3464.52 4420.97,-3452.89"/>
<polygon fill="black" stroke="black" points="4423.29,-3450.26 4413.63,-3445.91 4418.46,-3455.34 4423.29,-3450.26"/>
<text text-anchor="middle" x="4469.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer13_expert2 -->
<g id="node2044" class="node">
<title>gpu7_layer13_expert2</title>
<polygon fill="lightblue" stroke="black" points="4588,-3445.62 4466,-3445.62 4466,-3393.62 4588,-3393.62 4588,-3445.62"/>
<text text-anchor="middle" x="4527" y="-3433.62" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="4527" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer13_routing&#45;&gt;gpu7_layer13_expert2 -->
<g id="edge2533" class="edge">
<title>gpu7_layer13_routing&#45;&gt;gpu7_layer13_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4527,-3491.4C4527,-3479.33 4527,-3467.08 4527,-3456.23"/>
<polygon fill="black" stroke="black" points="4530.5,-3455.91 4527,-3445.91 4523.5,-3455.91 4530.5,-3455.91"/>
<text text-anchor="middle" x="4556.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer13_expert3 -->
<g id="node2045" class="node">
<title>gpu7_layer13_expert3</title>
<polygon fill="lightblue" stroke="black" points="4728,-3445.62 4606,-3445.62 4606,-3393.62 4728,-3393.62 4728,-3445.62"/>
<text text-anchor="middle" x="4667" y="-3433.62" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4667" y="-3422.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-3411.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-3400.62" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer13_routing&#45;&gt;gpu7_layer13_expert3 -->
<g id="edge2534" class="edge">
<title>gpu7_layer13_routing&#45;&gt;gpu7_layer13_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4592.49,-3491.4C4606.52,-3478.08 4620.79,-3464.52 4633.03,-3452.89"/>
<polygon fill="black" stroke="black" points="4635.54,-3455.34 4640.37,-3445.91 4630.71,-3450.26 4635.54,-3455.34"/>
<text text-anchor="middle" x="4650.5" y="-3466.42" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer13_expert_agg -->
<g id="node2046" class="node">
<title>gpu7_layer13_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-3356.62 4452.29,-3356.62 4400.53,-3252.62 4601.71,-3252.62 4653.47,-3356.62"/>
<text text-anchor="middle" x="4527" y="-3318.62" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="4527" y="-3307.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-3296.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-3285.62" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer13_routing&#45;&gt;gpu7_layer13_expert_agg -->
<g id="edge2549" class="edge">
<title>gpu7_layer13_routing&#45;&gt;gpu7_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M4616.22,-3526.7C4689.96,-3499.54 4776.6,-3453.15 4737,-3393.62 4716.44,-3362.71 4682.7,-3342.63 4648.22,-3329.6"/>
<polygon fill="black" stroke="black" points="4649.08,-3326.19 4638.48,-3326.11 4646.71,-3332.78 4649.08,-3326.19"/>
</g>
<!-- gpu7_layer13_expert0&#45;&gt;gpu7_layer13_expert_agg -->
<g id="edge2545" class="edge">
<title>gpu7_layer13_expert0&#45;&gt;gpu7_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M4308.1,-3393.96C4344.98,-3379.08 4392.7,-3359.82 4434.16,-3343.08"/>
<polygon fill="black" stroke="black" points="4435.5,-3346.32 4443.46,-3339.33 4432.88,-3339.83 4435.5,-3346.32"/>
</g>
<!-- gpu7_layer13_expert1&#45;&gt;gpu7_layer13_expert_agg -->
<g id="edge2546" class="edge">
<title>gpu7_layer13_expert1&#45;&gt;gpu7_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M4418.07,-3393.54C4429.32,-3384.46 4442.53,-3373.8 4455.8,-3363.09"/>
<polygon fill="black" stroke="black" points="4458.02,-3365.79 4463.6,-3356.79 4453.62,-3360.35 4458.02,-3365.79"/>
</g>
<!-- gpu7_layer13_expert2&#45;&gt;gpu7_layer13_expert_agg -->
<g id="edge2547" class="edge">
<title>gpu7_layer13_expert2&#45;&gt;gpu7_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M4527,-3393.54C4527,-3385.61 4527,-3376.48 4527,-3367.16"/>
<polygon fill="black" stroke="black" points="4530.5,-3367.02 4527,-3357.02 4523.5,-3367.02 4530.5,-3367.02"/>
</g>
<!-- gpu7_layer13_expert3&#45;&gt;gpu7_layer13_expert_agg -->
<g id="edge2548" class="edge">
<title>gpu7_layer13_expert3&#45;&gt;gpu7_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M4635.93,-3393.54C4624.68,-3384.46 4611.47,-3373.8 4598.2,-3363.09"/>
<polygon fill="black" stroke="black" points="4600.38,-3360.35 4590.4,-3356.79 4595.98,-3365.79 4600.38,-3360.35"/>
</g>
<!-- gpu7_layer13_res2 -->
<g id="node2047" class="node">
<title>gpu7_layer13_res2</title>
<polygon fill="lightblue" stroke="black" points="4588,-3215.62 4466,-3215.62 4466,-3163.62 4588,-3163.62 4588,-3215.62"/>
<text text-anchor="middle" x="4527" y="-3203.62" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="4527" y="-3192.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-3181.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-3170.62" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer13_expert_agg&#45;&gt;gpu7_layer13_res2 -->
<g id="edge2550" class="edge">
<title>gpu7_layer13_expert_agg&#45;&gt;gpu7_layer13_res2</title>
<path fill="none" stroke="black" d="M4527,-3252.41C4527,-3243.46 4527,-3234.33 4527,-3225.93"/>
<polygon fill="black" stroke="black" points="4530.5,-3225.75 4527,-3215.75 4523.5,-3225.75 4530.5,-3225.75"/>
</g>
<!-- gpu7_layer14_ln1 -->
<g id="node2048" class="node">
<title>gpu7_layer14_ln1</title>
<polygon fill="lightblue" stroke="black" points="4588,-3126.62 4466,-3126.62 4466,-3074.62 4588,-3074.62 4588,-3126.62"/>
<text text-anchor="middle" x="4527" y="-3114.62" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="4527" y="-3103.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-3092.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-3081.62" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer13_res2&#45;&gt;gpu7_layer14_ln1 -->
<g id="edge2555" class="edge">
<title>gpu7_layer13_res2&#45;&gt;gpu7_layer14_ln1</title>
<path fill="none" stroke="black" d="M4527,-3163.45C4527,-3155.16 4527,-3145.77 4527,-3136.87"/>
<polygon fill="black" stroke="black" points="4530.5,-3136.72 4527,-3126.72 4523.5,-3136.72 4530.5,-3136.72"/>
</g>
<!-- gpu7_layer14_qkv -->
<g id="node2049" class="node">
<title>gpu7_layer14_qkv</title>
<polygon fill="lightblue" stroke="black" points="4588,-3037.62 4466,-3037.62 4466,-2985.62 4588,-2985.62 4588,-3037.62"/>
<text text-anchor="middle" x="4527" y="-3025.62" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4527" y="-3014.62" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-3003.62" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-2992.62" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer14_ln1&#45;&gt;gpu7_layer14_qkv -->
<g id="edge2556" class="edge">
<title>gpu7_layer14_ln1&#45;&gt;gpu7_layer14_qkv</title>
<path fill="none" stroke="black" d="M4527,-3074.45C4527,-3066.16 4527,-3056.77 4527,-3047.87"/>
<polygon fill="black" stroke="black" points="4530.5,-3047.72 4527,-3037.72 4523.5,-3047.72 4530.5,-3047.72"/>
</g>
<!-- gpu7_layer14_reshape -->
<g id="node2050" class="node">
<title>gpu7_layer14_reshape</title>
<polygon fill="lightblue" stroke="black" points="4591,-2948.62 4463,-2948.62 4463,-2896.62 4591,-2896.62 4591,-2948.62"/>
<text text-anchor="middle" x="4527" y="-2936.62" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="4527" y="-2925.62" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-2914.62" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-2903.62" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer14_qkv&#45;&gt;gpu7_layer14_reshape -->
<g id="edge2557" class="edge">
<title>gpu7_layer14_qkv&#45;&gt;gpu7_layer14_reshape</title>
<path fill="none" stroke="black" d="M4527,-2985.45C4527,-2977.16 4527,-2967.77 4527,-2958.87"/>
<polygon fill="black" stroke="black" points="4530.5,-2958.72 4527,-2948.72 4523.5,-2958.72 4530.5,-2958.72"/>
</g>
<!-- gpu7_layer14_attn -->
<g id="node2051" class="node">
<title>gpu7_layer14_attn</title>
<polygon fill="lightblue" stroke="black" points="4591,-2859.62 4463,-2859.62 4463,-2807.62 4591,-2807.62 4591,-2859.62"/>
<text text-anchor="middle" x="4527" y="-2847.62" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="4527" y="-2836.62" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-2825.62" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-2814.62" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer14_reshape&#45;&gt;gpu7_layer14_attn -->
<g id="edge2558" class="edge">
<title>gpu7_layer14_reshape&#45;&gt;gpu7_layer14_attn</title>
<path fill="none" stroke="black" d="M4527,-2896.45C4527,-2888.16 4527,-2878.77 4527,-2869.87"/>
<polygon fill="black" stroke="black" points="4530.5,-2869.72 4527,-2859.72 4523.5,-2869.72 4530.5,-2869.72"/>
</g>
<!-- gpu7_layer14_attn_reshape -->
<g id="node2053" class="node">
<title>gpu7_layer14_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="4588,-2770.62 4466,-2770.62 4466,-2718.62 4588,-2718.62 4588,-2770.62"/>
<text text-anchor="middle" x="4527" y="-2758.62" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="4527" y="-2747.62" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-2736.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-2725.62" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer14_attn&#45;&gt;gpu7_layer14_attn_reshape -->
<g id="edge2559" class="edge">
<title>gpu7_layer14_attn&#45;&gt;gpu7_layer14_attn_reshape</title>
<path fill="none" stroke="black" d="M4527,-2807.45C4527,-2799.16 4527,-2789.77 4527,-2780.87"/>
<polygon fill="black" stroke="black" points="4530.5,-2780.72 4527,-2770.72 4523.5,-2780.72 4530.5,-2780.72"/>
</g>
<!-- gpu7_layer14_attn_out -->
<g id="node2052" class="node">
<title>gpu7_layer14_attn_out</title>
<polygon fill="lightblue" stroke="black" points="4588,-2681.62 4466,-2681.62 4466,-2629.62 4588,-2629.62 4588,-2681.62"/>
<text text-anchor="middle" x="4527" y="-2669.62" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="4527" y="-2658.62" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-2647.62" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-2636.62" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer14_kv_update -->
<g id="node2054" class="node">
<title>gpu7_layer14_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="4527" cy="-2555.85" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="4527" y="-2569.85" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="4527" y="-2558.85" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-2547.85" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-2536.85" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer14_attn_out&#45;&gt;gpu7_layer14_kv_update -->
<g id="edge2561" class="edge">
<title>gpu7_layer14_attn_out&#45;&gt;gpu7_layer14_kv_update</title>
<path fill="none" stroke="black" d="M4527,-2629.44C4527,-2621.3 4527,-2612 4527,-2602.84"/>
<polygon fill="black" stroke="black" points="4530.5,-2602.63 4527,-2592.63 4523.5,-2602.63 4530.5,-2602.63"/>
</g>
<!-- gpu7_layer14_attn_reshape&#45;&gt;gpu7_layer14_attn_out -->
<g id="edge2560" class="edge">
<title>gpu7_layer14_attn_reshape&#45;&gt;gpu7_layer14_attn_out</title>
<path fill="none" stroke="black" d="M4527,-2718.45C4527,-2710.16 4527,-2700.77 4527,-2691.87"/>
<polygon fill="black" stroke="black" points="4530.5,-2691.72 4527,-2681.72 4523.5,-2691.72 4530.5,-2691.72"/>
</g>
<!-- gpu7_layer14_res1 -->
<g id="node2055" class="node">
<title>gpu7_layer14_res1</title>
<polygon fill="lightblue" stroke="black" points="4588,-2482.08 4466,-2482.08 4466,-2430.08 4588,-2430.08 4588,-2482.08"/>
<text text-anchor="middle" x="4527" y="-2470.08" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="4527" y="-2459.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-2448.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-2437.08" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer14_kv_update&#45;&gt;gpu7_layer14_res1 -->
<g id="edge2562" class="edge">
<title>gpu7_layer14_kv_update&#45;&gt;gpu7_layer14_res1</title>
<path fill="none" stroke="black" d="M4527,-2519C4527,-2510.32 4527,-2501.05 4527,-2492.39"/>
<polygon fill="black" stroke="black" points="4530.5,-2492.22 4527,-2482.22 4523.5,-2492.22 4530.5,-2492.22"/>
</g>
<!-- gpu7_layer14_ln2 -->
<g id="node2056" class="node">
<title>gpu7_layer14_ln2</title>
<polygon fill="lightblue" stroke="black" points="4588,-2393.08 4466,-2393.08 4466,-2341.08 4588,-2341.08 4588,-2393.08"/>
<text text-anchor="middle" x="4527" y="-2381.08" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="4527" y="-2370.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-2359.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-2348.08" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer14_res1&#45;&gt;gpu7_layer14_ln2 -->
<g id="edge2563" class="edge">
<title>gpu7_layer14_res1&#45;&gt;gpu7_layer14_ln2</title>
<path fill="none" stroke="black" d="M4527,-2429.91C4527,-2421.62 4527,-2412.23 4527,-2403.33"/>
<polygon fill="black" stroke="black" points="4530.5,-2403.19 4527,-2393.19 4523.5,-2403.19 4530.5,-2403.19"/>
</g>
<!-- gpu7_layer14_routing -->
<g id="node2057" class="node">
<title>gpu7_layer14_routing</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-2304.08 4452.29,-2304.08 4400.53,-2178.08 4601.71,-2178.08 4653.47,-2304.08"/>
<text text-anchor="middle" x="4527" y="-2260.58" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="4527" y="-2249.58" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-2238.58" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-2227.58" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="4527" y="-2216.58" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer14_ln2&#45;&gt;gpu7_layer14_routing -->
<g id="edge2564" class="edge">
<title>gpu7_layer14_ln2&#45;&gt;gpu7_layer14_routing</title>
<path fill="none" stroke="black" d="M4527,-2340.98C4527,-2333.05 4527,-2323.86 4527,-2314.33"/>
<polygon fill="black" stroke="black" points="4530.5,-2314.31 4527,-2304.31 4523.5,-2314.31 4530.5,-2314.31"/>
</g>
<!-- gpu7_layer14_expert0 -->
<g id="node2058" class="node">
<title>gpu7_layer14_expert0</title>
<polygon fill="lightblue" stroke="black" points="4308,-2132.08 4186,-2132.08 4186,-2080.08 4308,-2080.08 4308,-2132.08"/>
<text text-anchor="middle" x="4247" y="-2120.08" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="4247" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer14_routing&#45;&gt;gpu7_layer14_expert0 -->
<g id="edge2551" class="edge">
<title>gpu7_layer14_routing&#45;&gt;gpu7_layer14_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4401.33,-2180.39C4369.34,-2165.19 4336.34,-2149.51 4309.11,-2136.58"/>
<polygon fill="black" stroke="black" points="4310.26,-2133.25 4299.73,-2132.12 4307.26,-2139.58 4310.26,-2133.25"/>
<text text-anchor="middle" x="4382.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer14_expert1 -->
<g id="node2059" class="node">
<title>gpu7_layer14_expert1</title>
<polygon fill="lightblue" stroke="black" points="4448,-2132.08 4326,-2132.08 4326,-2080.08 4448,-2080.08 4448,-2132.08"/>
<text text-anchor="middle" x="4387" y="-2120.08" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="4387" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer14_routing&#45;&gt;gpu7_layer14_expert1 -->
<g id="edge2552" class="edge">
<title>gpu7_layer14_routing&#45;&gt;gpu7_layer14_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4461.51,-2177.86C4447.48,-2164.54 4433.21,-2150.98 4420.97,-2139.35"/>
<polygon fill="black" stroke="black" points="4423.29,-2136.72 4413.63,-2132.37 4418.46,-2141.8 4423.29,-2136.72"/>
<text text-anchor="middle" x="4469.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer14_expert2 -->
<g id="node2060" class="node">
<title>gpu7_layer14_expert2</title>
<polygon fill="lightblue" stroke="black" points="4588,-2132.08 4466,-2132.08 4466,-2080.08 4588,-2080.08 4588,-2132.08"/>
<text text-anchor="middle" x="4527" y="-2120.08" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="4527" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer14_routing&#45;&gt;gpu7_layer14_expert2 -->
<g id="edge2553" class="edge">
<title>gpu7_layer14_routing&#45;&gt;gpu7_layer14_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4527,-2177.86C4527,-2165.79 4527,-2153.54 4527,-2142.69"/>
<polygon fill="black" stroke="black" points="4530.5,-2142.37 4527,-2132.37 4523.5,-2142.37 4530.5,-2142.37"/>
<text text-anchor="middle" x="4556.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer14_expert3 -->
<g id="node2061" class="node">
<title>gpu7_layer14_expert3</title>
<polygon fill="lightblue" stroke="black" points="4728,-2132.08 4606,-2132.08 4606,-2080.08 4728,-2080.08 4728,-2132.08"/>
<text text-anchor="middle" x="4667" y="-2120.08" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4667" y="-2109.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-2098.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-2087.08" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer14_routing&#45;&gt;gpu7_layer14_expert3 -->
<g id="edge2554" class="edge">
<title>gpu7_layer14_routing&#45;&gt;gpu7_layer14_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4592.49,-2177.86C4606.52,-2164.54 4620.79,-2150.98 4633.03,-2139.35"/>
<polygon fill="black" stroke="black" points="4635.54,-2141.8 4640.37,-2132.37 4630.71,-2136.72 4635.54,-2141.8"/>
<text text-anchor="middle" x="4650.5" y="-2152.88" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer14_expert_agg -->
<g id="node2062" class="node">
<title>gpu7_layer14_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-2043.08 4452.29,-2043.08 4400.53,-1939.08 4601.71,-1939.08 4653.47,-2043.08"/>
<text text-anchor="middle" x="4527" y="-2005.08" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="4527" y="-1994.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-1983.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-1972.08" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer14_routing&#45;&gt;gpu7_layer14_expert_agg -->
<g id="edge2569" class="edge">
<title>gpu7_layer14_routing&#45;&gt;gpu7_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M4616.22,-2213.16C4689.96,-2186 4776.6,-2139.61 4737,-2080.08 4716.44,-2049.17 4682.7,-2029.09 4648.22,-2016.06"/>
<polygon fill="black" stroke="black" points="4649.08,-2012.65 4638.48,-2012.57 4646.71,-2019.24 4649.08,-2012.65"/>
</g>
<!-- gpu7_layer14_expert0&#45;&gt;gpu7_layer14_expert_agg -->
<g id="edge2565" class="edge">
<title>gpu7_layer14_expert0&#45;&gt;gpu7_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M4308.1,-2080.42C4344.98,-2065.54 4392.7,-2046.28 4434.16,-2029.54"/>
<polygon fill="black" stroke="black" points="4435.5,-2032.78 4443.46,-2025.79 4432.88,-2026.29 4435.5,-2032.78"/>
</g>
<!-- gpu7_layer14_expert1&#45;&gt;gpu7_layer14_expert_agg -->
<g id="edge2566" class="edge">
<title>gpu7_layer14_expert1&#45;&gt;gpu7_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M4418.07,-2080C4429.32,-2070.92 4442.53,-2060.26 4455.8,-2049.55"/>
<polygon fill="black" stroke="black" points="4458.02,-2052.25 4463.6,-2043.25 4453.62,-2046.81 4458.02,-2052.25"/>
</g>
<!-- gpu7_layer14_expert2&#45;&gt;gpu7_layer14_expert_agg -->
<g id="edge2567" class="edge">
<title>gpu7_layer14_expert2&#45;&gt;gpu7_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M4527,-2080C4527,-2072.07 4527,-2062.94 4527,-2053.62"/>
<polygon fill="black" stroke="black" points="4530.5,-2053.48 4527,-2043.48 4523.5,-2053.48 4530.5,-2053.48"/>
</g>
<!-- gpu7_layer14_expert3&#45;&gt;gpu7_layer14_expert_agg -->
<g id="edge2568" class="edge">
<title>gpu7_layer14_expert3&#45;&gt;gpu7_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M4635.93,-2080C4624.68,-2070.92 4611.47,-2060.26 4598.2,-2049.55"/>
<polygon fill="black" stroke="black" points="4600.38,-2046.81 4590.4,-2043.25 4595.98,-2052.25 4600.38,-2046.81"/>
</g>
<!-- gpu7_layer14_res2 -->
<g id="node2063" class="node">
<title>gpu7_layer14_res2</title>
<polygon fill="lightblue" stroke="black" points="4588,-1902.08 4466,-1902.08 4466,-1850.08 4588,-1850.08 4588,-1902.08"/>
<text text-anchor="middle" x="4527" y="-1890.08" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="4527" y="-1879.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-1868.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-1857.08" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer14_expert_agg&#45;&gt;gpu7_layer14_res2 -->
<g id="edge2570" class="edge">
<title>gpu7_layer14_expert_agg&#45;&gt;gpu7_layer14_res2</title>
<path fill="none" stroke="black" d="M4527,-1938.87C4527,-1929.92 4527,-1920.79 4527,-1912.39"/>
<polygon fill="black" stroke="black" points="4530.5,-1912.21 4527,-1902.21 4523.5,-1912.21 4530.5,-1912.21"/>
</g>
<!-- gpu7_layer15_ln1 -->
<g id="node2064" class="node">
<title>gpu7_layer15_ln1</title>
<polygon fill="lightblue" stroke="black" points="4588,-1813.08 4466,-1813.08 4466,-1761.08 4588,-1761.08 4588,-1813.08"/>
<text text-anchor="middle" x="4527" y="-1801.08" font-family="Arial" font-size="10.00">LayerNorm1</text>
<text text-anchor="middle" x="4527" y="-1790.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-1779.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-1768.08" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer14_res2&#45;&gt;gpu7_layer15_ln1 -->
<g id="edge2575" class="edge">
<title>gpu7_layer14_res2&#45;&gt;gpu7_layer15_ln1</title>
<path fill="none" stroke="black" d="M4527,-1849.91C4527,-1841.62 4527,-1832.23 4527,-1823.33"/>
<polygon fill="black" stroke="black" points="4530.5,-1823.19 4527,-1813.19 4523.5,-1823.19 4530.5,-1823.19"/>
</g>
<!-- gpu7_layer15_qkv -->
<g id="node2065" class="node">
<title>gpu7_layer15_qkv</title>
<polygon fill="lightblue" stroke="black" points="4588,-1724.08 4466,-1724.08 4466,-1672.08 4588,-1672.08 4588,-1724.08"/>
<text text-anchor="middle" x="4527" y="-1712.08" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4527" y="-1701.08" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-1690.08" font-family="Arial" font-size="10.00">Output: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-1679.08" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer15_ln1&#45;&gt;gpu7_layer15_qkv -->
<g id="edge2576" class="edge">
<title>gpu7_layer15_ln1&#45;&gt;gpu7_layer15_qkv</title>
<path fill="none" stroke="black" d="M4527,-1760.91C4527,-1752.62 4527,-1743.23 4527,-1734.33"/>
<polygon fill="black" stroke="black" points="4530.5,-1734.19 4527,-1724.19 4523.5,-1734.19 4530.5,-1734.19"/>
</g>
<!-- gpu7_layer15_reshape -->
<g id="node2066" class="node">
<title>gpu7_layer15_reshape</title>
<polygon fill="lightblue" stroke="black" points="4591,-1635.08 4463,-1635.08 4463,-1583.08 4591,-1583.08 4591,-1635.08"/>
<text text-anchor="middle" x="4527" y="-1623.08" font-family="Arial" font-size="10.00">Reshape QKV</text>
<text text-anchor="middle" x="4527" y="-1612.08" font-family="Arial" font-size="10.00">Input: [256, 512, 3072]</text>
<text text-anchor="middle" x="4527" y="-1601.08" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-1590.08" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer15_qkv&#45;&gt;gpu7_layer15_reshape -->
<g id="edge2577" class="edge">
<title>gpu7_layer15_qkv&#45;&gt;gpu7_layer15_reshape</title>
<path fill="none" stroke="black" d="M4527,-1671.91C4527,-1663.62 4527,-1654.23 4527,-1645.33"/>
<polygon fill="black" stroke="black" points="4530.5,-1645.19 4527,-1635.19 4523.5,-1645.19 4530.5,-1645.19"/>
</g>
<!-- gpu7_layer15_attn -->
<g id="node2067" class="node">
<title>gpu7_layer15_attn</title>
<polygon fill="lightblue" stroke="black" points="4591,-1546.08 4463,-1546.08 4463,-1494.08 4591,-1494.08 4591,-1546.08"/>
<text text-anchor="middle" x="4527" y="-1534.08" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="4527" y="-1523.08" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-1512.08" font-family="Arial" font-size="10.00">Output: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-1501.08" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer15_reshape&#45;&gt;gpu7_layer15_attn -->
<g id="edge2578" class="edge">
<title>gpu7_layer15_reshape&#45;&gt;gpu7_layer15_attn</title>
<path fill="none" stroke="black" d="M4527,-1582.91C4527,-1574.62 4527,-1565.23 4527,-1556.33"/>
<polygon fill="black" stroke="black" points="4530.5,-1556.19 4527,-1546.19 4523.5,-1556.19 4530.5,-1556.19"/>
</g>
<!-- gpu7_layer15_attn_reshape -->
<g id="node2069" class="node">
<title>gpu7_layer15_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="4588,-1457.08 4466,-1457.08 4466,-1405.08 4588,-1405.08 4588,-1457.08"/>
<text text-anchor="middle" x="4527" y="-1445.08" font-family="Arial" font-size="10.00">Reshape Back</text>
<text text-anchor="middle" x="4527" y="-1434.08" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-1423.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-1412.08" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer15_attn&#45;&gt;gpu7_layer15_attn_reshape -->
<g id="edge2579" class="edge">
<title>gpu7_layer15_attn&#45;&gt;gpu7_layer15_attn_reshape</title>
<path fill="none" stroke="black" d="M4527,-1493.91C4527,-1485.62 4527,-1476.23 4527,-1467.33"/>
<polygon fill="black" stroke="black" points="4530.5,-1467.19 4527,-1457.19 4523.5,-1467.19 4530.5,-1467.19"/>
</g>
<!-- gpu7_layer15_attn_out -->
<g id="node2068" class="node">
<title>gpu7_layer15_attn_out</title>
<polygon fill="lightblue" stroke="black" points="4588,-1368.08 4466,-1368.08 4466,-1316.08 4588,-1316.08 4588,-1368.08"/>
<text text-anchor="middle" x="4527" y="-1356.08" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="4527" y="-1345.08" font-family="Arial" font-size="10.00">Input: [256, 16, 512, 64]</text>
<text text-anchor="middle" x="4527" y="-1334.08" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-1323.08" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer15_kv_update -->
<g id="node2070" class="node">
<title>gpu7_layer15_kv_update</title>
<ellipse fill="lightgreen" stroke="black" cx="4527" cy="-1242.31" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="4527" y="-1256.31" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="4527" y="-1245.31" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-1234.31" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-1223.31" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer15_attn_out&#45;&gt;gpu7_layer15_kv_update -->
<g id="edge2581" class="edge">
<title>gpu7_layer15_attn_out&#45;&gt;gpu7_layer15_kv_update</title>
<path fill="none" stroke="black" d="M4527,-1315.9C4527,-1307.76 4527,-1298.46 4527,-1289.3"/>
<polygon fill="black" stroke="black" points="4530.5,-1289.09 4527,-1279.09 4523.5,-1289.09 4530.5,-1289.09"/>
</g>
<!-- gpu7_layer15_attn_reshape&#45;&gt;gpu7_layer15_attn_out -->
<g id="edge2580" class="edge">
<title>gpu7_layer15_attn_reshape&#45;&gt;gpu7_layer15_attn_out</title>
<path fill="none" stroke="black" d="M4527,-1404.91C4527,-1396.62 4527,-1387.23 4527,-1378.33"/>
<polygon fill="black" stroke="black" points="4530.5,-1378.19 4527,-1368.19 4523.5,-1378.19 4530.5,-1378.19"/>
</g>
<!-- gpu7_layer15_res1 -->
<g id="node2071" class="node">
<title>gpu7_layer15_res1</title>
<polygon fill="lightblue" stroke="black" points="4588,-1168.54 4466,-1168.54 4466,-1116.54 4588,-1116.54 4588,-1168.54"/>
<text text-anchor="middle" x="4527" y="-1156.54" font-family="Arial" font-size="10.00">Residual Add1</text>
<text text-anchor="middle" x="4527" y="-1145.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-1134.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-1123.54" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer15_kv_update&#45;&gt;gpu7_layer15_res1 -->
<g id="edge2582" class="edge">
<title>gpu7_layer15_kv_update&#45;&gt;gpu7_layer15_res1</title>
<path fill="none" stroke="black" d="M4527,-1205.46C4527,-1196.78 4527,-1187.51 4527,-1178.85"/>
<polygon fill="black" stroke="black" points="4530.5,-1178.69 4527,-1168.69 4523.5,-1178.69 4530.5,-1178.69"/>
</g>
<!-- gpu7_layer15_ln2 -->
<g id="node2072" class="node">
<title>gpu7_layer15_ln2</title>
<polygon fill="lightblue" stroke="black" points="4588,-1079.54 4466,-1079.54 4466,-1027.54 4588,-1027.54 4588,-1079.54"/>
<text text-anchor="middle" x="4527" y="-1067.54" font-family="Arial" font-size="10.00">LayerNorm2</text>
<text text-anchor="middle" x="4527" y="-1056.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-1045.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-1034.54" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer15_res1&#45;&gt;gpu7_layer15_ln2 -->
<g id="edge2583" class="edge">
<title>gpu7_layer15_res1&#45;&gt;gpu7_layer15_ln2</title>
<path fill="none" stroke="black" d="M4527,-1116.38C4527,-1108.08 4527,-1098.69 4527,-1089.79"/>
<polygon fill="black" stroke="black" points="4530.5,-1089.65 4527,-1079.65 4523.5,-1089.65 4530.5,-1089.65"/>
</g>
<!-- gpu7_layer15_routing -->
<g id="node2073" class="node">
<title>gpu7_layer15_routing</title>
<polygon fill="lightyellow" stroke="black" points="4653.47,-990.54 4452.29,-990.54 4400.53,-864.54 4601.71,-864.54 4653.47,-990.54"/>
<text text-anchor="middle" x="4527" y="-947.04" font-family="Arial" font-size="10.00">MoE Router</text>
<text text-anchor="middle" x="4527" y="-936.04" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-925.04" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-914.04" font-family="Arial" font-size="10.00">Experts: 64</text>
<text text-anchor="middle" x="4527" y="-903.04" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer15_ln2&#45;&gt;gpu7_layer15_routing -->
<g id="edge2584" class="edge">
<title>gpu7_layer15_ln2&#45;&gt;gpu7_layer15_routing</title>
<path fill="none" stroke="black" d="M4527,-1027.45C4527,-1019.51 4527,-1010.32 4527,-1000.79"/>
<polygon fill="black" stroke="black" points="4530.5,-1000.77 4527,-990.77 4523.5,-1000.77 4530.5,-1000.77"/>
</g>
<!-- gpu7_layer15_expert0 -->
<g id="node2074" class="node">
<title>gpu7_layer15_expert0</title>
<polygon fill="lightblue" stroke="black" points="4308,-818.54 4186,-818.54 4186,-766.54 4308,-766.54 4308,-818.54"/>
<text text-anchor="middle" x="4247" y="-806.54" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="4247" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4247" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer15_routing&#45;&gt;gpu7_layer15_expert0 -->
<g id="edge2571" class="edge">
<title>gpu7_layer15_routing&#45;&gt;gpu7_layer15_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4401.33,-866.85C4369.34,-851.65 4336.34,-835.98 4309.11,-823.04"/>
<polygon fill="black" stroke="black" points="4310.26,-819.71 4299.73,-818.58 4307.26,-826.04 4310.26,-819.71"/>
<text text-anchor="middle" x="4382.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer15_expert1 -->
<g id="node2075" class="node">
<title>gpu7_layer15_expert1</title>
<polygon fill="lightblue" stroke="black" points="4448,-818.54 4326,-818.54 4326,-766.54 4448,-766.54 4448,-818.54"/>
<text text-anchor="middle" x="4387" y="-806.54" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="4387" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4387" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer15_routing&#45;&gt;gpu7_layer15_expert1 -->
<g id="edge2572" class="edge">
<title>gpu7_layer15_routing&#45;&gt;gpu7_layer15_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4461.51,-864.32C4447.48,-851 4433.21,-837.44 4420.97,-825.81"/>
<polygon fill="black" stroke="black" points="4423.29,-823.18 4413.63,-818.83 4418.46,-828.26 4423.29,-823.18"/>
<text text-anchor="middle" x="4469.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer15_expert2 -->
<g id="node2076" class="node">
<title>gpu7_layer15_expert2</title>
<polygon fill="lightblue" stroke="black" points="4588,-818.54 4466,-818.54 4466,-766.54 4588,-766.54 4588,-818.54"/>
<text text-anchor="middle" x="4527" y="-806.54" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="4527" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4527" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer15_routing&#45;&gt;gpu7_layer15_expert2 -->
<g id="edge2573" class="edge">
<title>gpu7_layer15_routing&#45;&gt;gpu7_layer15_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4527,-864.32C4527,-852.25 4527,-840 4527,-829.15"/>
<polygon fill="black" stroke="black" points="4530.5,-828.83 4527,-818.83 4523.5,-828.83 4530.5,-828.83"/>
<text text-anchor="middle" x="4556.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer15_expert3 -->
<g id="node2077" class="node">
<title>gpu7_layer15_expert3</title>
<polygon fill="lightblue" stroke="black" points="4728,-818.54 4606,-818.54 4606,-766.54 4728,-766.54 4728,-818.54"/>
<text text-anchor="middle" x="4667" y="-806.54" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4667" y="-795.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-784.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4667" y="-773.54" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer15_routing&#45;&gt;gpu7_layer15_expert3 -->
<g id="edge2574" class="edge">
<title>gpu7_layer15_routing&#45;&gt;gpu7_layer15_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4592.49,-864.32C4606.52,-851 4620.79,-837.44 4633.03,-825.81"/>
<polygon fill="black" stroke="black" points="4635.54,-828.26 4640.37,-818.83 4630.71,-823.18 4635.54,-828.26"/>
<text text-anchor="middle" x="4650.5" y="-839.34" font-family="Arial" font-size="9.00">Gate selection</text>
</g>
<!-- gpu7_layer15_expert_agg -->
<g id="node2078" class="node">
<title>gpu7_layer15_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="4583.47,-729.54 4382.29,-729.54 4330.53,-625.54 4531.71,-625.54 4583.47,-729.54"/>
<text text-anchor="middle" x="4457" y="-691.54" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="4457" y="-680.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4457" y="-669.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4457" y="-658.54" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer15_routing&#45;&gt;gpu7_layer15_expert_agg -->
<g id="edge2589" class="edge">
<title>gpu7_layer15_routing&#45;&gt;gpu7_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M4616.03,-899.29C4690.95,-871.59 4779.58,-824.55 4737,-766.54 4717.36,-739.77 4645.16,-717.46 4579,-701.99"/>
<polygon fill="black" stroke="black" points="4579.4,-698.49 4568.87,-699.67 4577.83,-705.31 4579.4,-698.49"/>
</g>
<!-- gpu7_layer15_expert0&#45;&gt;gpu7_layer15_expert_agg -->
<g id="edge2585" class="edge">
<title>gpu7_layer15_expert0&#45;&gt;gpu7_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M4293.61,-766.46C4315.76,-754.54 4343.01,-739.88 4368.86,-725.97"/>
<polygon fill="black" stroke="black" points="4370.78,-728.91 4377.93,-721.09 4367.47,-722.74 4370.78,-728.91"/>
</g>
<!-- gpu7_layer15_expert1&#45;&gt;gpu7_layer15_expert_agg -->
<g id="edge2586" class="edge">
<title>gpu7_layer15_expert1&#45;&gt;gpu7_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M4402.54,-766.46C4407.71,-758.11 4413.71,-748.42 4419.8,-738.59"/>
<polygon fill="black" stroke="black" points="4422.87,-740.28 4425.16,-729.94 4416.92,-736.6 4422.87,-740.28"/>
</g>
<!-- gpu7_layer15_expert2&#45;&gt;gpu7_layer15_expert_agg -->
<g id="edge2587" class="edge">
<title>gpu7_layer15_expert2&#45;&gt;gpu7_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M4511.46,-766.46C4506.29,-758.11 4500.29,-748.42 4494.2,-738.59"/>
<polygon fill="black" stroke="black" points="4497.08,-736.6 4488.84,-729.94 4491.13,-740.28 4497.08,-736.6"/>
</g>
<!-- gpu7_layer15_expert3&#45;&gt;gpu7_layer15_expert_agg -->
<g id="edge2588" class="edge">
<title>gpu7_layer15_expert3&#45;&gt;gpu7_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M4620.39,-766.46C4602.74,-756.96 4581.85,-745.72 4561.01,-734.51"/>
<polygon fill="black" stroke="black" points="4562.56,-731.37 4552.1,-729.71 4559.24,-737.53 4562.56,-731.37"/>
</g>
<!-- gpu7_layer15_res2 -->
<g id="node2079" class="node">
<title>gpu7_layer15_res2</title>
<polygon fill="lightblue" stroke="black" points="4331,-588.54 4209,-588.54 4209,-536.54 4331,-536.54 4331,-588.54"/>
<text text-anchor="middle" x="4270" y="-576.54" font-family="Arial" font-size="10.00">Residual Add2</text>
<text text-anchor="middle" x="4270" y="-565.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="4270" y="-554.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="4270" y="-543.54" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer15_expert_agg&#45;&gt;gpu7_layer15_res2 -->
<g id="edge2590" class="edge">
<title>gpu7_layer15_expert_agg&#45;&gt;gpu7_layer15_res2</title>
<path fill="none" stroke="black" d="M4372.53,-625.49C4354.72,-614.74 4336.48,-603.71 4320.41,-594"/>
<polygon fill="black" stroke="black" points="4322.09,-590.93 4311.72,-588.75 4318.47,-596.92 4322.09,-590.93"/>
</g>
<!-- gpu7_final_ln -->
<g id="node2080" class="node">
<title>gpu7_final_ln</title>
<polygon fill="lightblue" stroke="black" points="3866,-499.54 3744,-499.54 3744,-447.54 3866,-447.54 3866,-499.54"/>
<text text-anchor="middle" x="3805" y="-487.54" font-family="Arial" font-size="10.00">Final LayerNorm</text>
<text text-anchor="middle" x="3805" y="-476.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3805" y="-465.54" font-family="Arial" font-size="10.00">Output: [256, 512, 2048]</text>
<text text-anchor="middle" x="3805" y="-454.54" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_layer15_res2&#45;&gt;gpu7_final_ln -->
<g id="edge2591" class="edge">
<title>gpu7_layer15_res2&#45;&gt;gpu7_final_ln</title>
<path fill="none" stroke="black" d="M4208.73,-550.08C4122.8,-534 3966.85,-504.82 3875.97,-487.82"/>
<polygon fill="black" stroke="black" points="3876.51,-484.36 3866.03,-485.96 3875.22,-491.24 3876.51,-484.36"/>
</g>
<!-- gpu7_output_proj -->
<g id="node2081" class="node">
<title>gpu7_output_proj</title>
<polygon fill="lightblue" stroke="black" points="3617,-410.54 3489,-410.54 3489,-358.54 3617,-358.54 3617,-410.54"/>
<text text-anchor="middle" x="3553" y="-398.54" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="3553" y="-387.54" font-family="Arial" font-size="10.00">Input: [256, 512, 2048]</text>
<text text-anchor="middle" x="3553" y="-376.54" font-family="Arial" font-size="10.00">Output: [256, 512, 32000]</text>
<text text-anchor="middle" x="3553" y="-365.54" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_final_ln&#45;&gt;gpu7_output_proj -->
<g id="edge2592" class="edge">
<title>gpu7_final_ln&#45;&gt;gpu7_output_proj</title>
<path fill="none" stroke="black" d="M3744,-451.48C3708.83,-439.34 3664.36,-423.99 3627.18,-411.15"/>
<polygon fill="black" stroke="black" points="3628,-407.73 3617.4,-407.77 3625.71,-414.34 3628,-407.73"/>
</g>
<!-- gpu7_softmax -->
<g id="node2082" class="node">
<title>gpu7_softmax</title>
<polygon fill="lightblue" stroke="black" points="3130,-321.54 3002,-321.54 3002,-269.54 3130,-269.54 3130,-321.54"/>
<text text-anchor="middle" x="3066" y="-309.54" font-family="Arial" font-size="10.00">Softmax</text>
<text text-anchor="middle" x="3066" y="-298.54" font-family="Arial" font-size="10.00">Input: [256, 512, 32000]</text>
<text text-anchor="middle" x="3066" y="-287.54" font-family="Arial" font-size="10.00">Output: [256, 512, 32000]</text>
<text text-anchor="middle" x="3066" y="-276.54" font-family="Arial" font-size="10.00">GPU: GPU7</text>
</g>
<!-- gpu7_output_proj&#45;&gt;gpu7_softmax -->
<g id="edge2593" class="edge">
<title>gpu7_output_proj&#45;&gt;gpu7_softmax</title>
<path fill="none" stroke="black" d="M3488.83,-372.08C3398.87,-356 3235.62,-326.84 3140.44,-309.84"/>
<polygon fill="black" stroke="black" points="3140.77,-306.34 3130.31,-308.03 3139.54,-313.23 3140.77,-306.34"/>
</g>
<!-- gpu7_softmax&#45;&gt;dp_aggregate -->
<g id="edge2601" class="edge">
<title>gpu7_softmax&#45;&gt;dp_aggregate</title>
<path fill="none" stroke="black" d="M3001.59,-273.6C2996.34,-272.14 2991.09,-270.76 2986,-269.54 2850.75,-237.01 2694.85,-211.2 2580.63,-194.41"/>
<polygon fill="black" stroke="black" points="2580.8,-190.9 2570.4,-192.91 2579.79,-197.82 2580.8,-190.9"/>
<text text-anchor="middle" x="2921.5" y="-244.34" font-family="Arial" font-size="9.00">GPU 7 output</text>
</g>
<!-- output -->
<g id="node2084" class="node">
<title>output</title>
<ellipse fill="lightgray" stroke="black" cx="2418" cy="-36.77" rx="84.29" ry="36.54"/>
<text text-anchor="middle" x="2418" y="-50.77" font-family="Arial" font-size="10.00">Final Output</text>
<text text-anchor="middle" x="2418" y="-39.77" font-family="Arial" font-size="10.00">Batch: 2048 sequences</text>
<text text-anchor="middle" x="2418" y="-28.77" font-family="Arial" font-size="10.00">Vocab: 32000</text>
<text text-anchor="middle" x="2418" y="-17.77" font-family="Arial" font-size="10.00">GPU: All</text>
</g>
<!-- dp_aggregate&#45;&gt;output -->
<g id="edge2602" class="edge">
<title>dp_aggregate&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2418,-119.21C2418,-107.59 2418,-95.32 2418,-83.92"/>
<polygon fill="black" stroke="black" points="2421.5,-83.75 2418,-73.75 2414.5,-83.75 2421.5,-83.75"/>
<text text-anchor="middle" x="2454.5" y="-94.34" font-family="Arial" font-size="9.00">Combined results</text>
</g>
<!-- legend_compute -->
<g id="node2085" class="node">
<title>legend_compute</title>
<polygon fill="lightblue" stroke="black" points="2972,-21853.93 2874,-21853.93 2874,-21817.93 2972,-21817.93 2972,-21853.93"/>
<text text-anchor="middle" x="2923" y="-21833.43" font-family="Arial" font-size="10.00">Computation Node</text>
</g>
<!-- legend_comm -->
<g id="node2086" class="node">
<title>legend_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="2791" cy="-21835.93" rx="65.18" ry="18"/>
<text text-anchor="middle" x="2791" y="-21833.43" font-family="Arial" font-size="10.00">Communication Node</text>
</g>
<!-- legend_routing -->
<g id="node2087" class="node">
<title>legend_routing</title>
<polygon fill="lightyellow" stroke="black" points="2707.75,-21853.93 2563.39,-21853.93 2526.25,-21817.93 2670.61,-21817.93 2707.75,-21853.93"/>
<text text-anchor="middle" x="2617" y="-21833.43" font-family="Arial" font-size="10.00">Routing/Aggregation</text>
</g>
<!-- legend_input -->
<g id="node2088" class="node">
<title>legend_input</title>
<ellipse fill="lightpink" stroke="black" cx="2467" cy="-21835.93" rx="41.59" ry="18"/>
<text text-anchor="middle" x="2467" y="-21833.43" font-family="Arial" font-size="10.00">Input/Output</text>
</g>
</g>
</svg>
