<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_moe_tp8_pp2 Pages: 1 -->
<svg width="145793pt" height="1637pt"
 viewBox="0.00 0.00 145792.78 1636.83" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1632.83)">
<title>baseline_moe_tp8_pp2</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1632.83 145788.78,-1632.83 145788.78,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="none" stroke="black" cx="320" cy="-1580.75" rx="317.48" ry="48.17"/>
<text text-anchor="middle" x="320" y="-1599.55" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="320" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="320" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="320" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- L0_S0_TP0_GPU0_qkv_linear -->
<g id="node2" class="node">
<title>L0_S0_TP0_GPU0_qkv_linear</title>
<polygon fill="none" stroke="black" points="1263,-1614.75 655,-1614.75 655,-1546.75 1263,-1546.75 1263,-1614.75"/>
<text text-anchor="middle" x="959" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="959" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="959" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="959" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L0_S0_TP0_GPU0_qkv_slice -->
<g id="node3" class="node">
<title>L0_S0_TP0_GPU0_qkv_slice</title>
<polygon fill="none" stroke="black" points="1257,-1496.67 661,-1496.67 661,-1428.67 1257,-1428.67 1257,-1496.67"/>
<text text-anchor="middle" x="959" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="959" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="959" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="959" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L0_S0_TP0_GPU0_qkv_linear&#45;&gt;L0_S0_TP0_GPU0_qkv_slice -->
<g id="edge1" class="edge">
<title>L0_S0_TP0_GPU0_qkv_linear&#45;&gt;L0_S0_TP0_GPU0_qkv_slice</title>
<path fill="none" stroke="black" d="M959,-1546.59C959,-1546.59 959,-1506.74 959,-1506.74"/>
<polygon fill="black" stroke="black" points="962.5,-1506.74 959,-1496.74 955.5,-1506.74 962.5,-1506.74"/>
</g>
<!-- L0_S0_TP0_GPU0_qk_matmul -->
<g id="node4" class="node">
<title>L0_S0_TP0_GPU0_qk_matmul</title>
<polygon fill="none" stroke="black" points="1739.5,-1392.67 804.5,-1392.67 804.5,-1324.67 1739.5,-1324.67 1739.5,-1392.67"/>
<text text-anchor="middle" x="1272" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="1272" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="1272" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="1272" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L0_S0_TP0_GPU0_qkv_slice&#45;&gt;L0_S0_TP0_GPU0_qk_matmul -->
<g id="edge2" class="edge">
<title>L0_S0_TP0_GPU0_qkv_slice&#45;&gt;L0_S0_TP0_GPU0_qk_matmul</title>
<path fill="none" stroke="black" d="M1030.75,-1428.61C1030.75,-1428.61 1030.75,-1402.8 1030.75,-1402.8"/>
<polygon fill="black" stroke="black" points="1034.25,-1402.8 1030.75,-1392.8 1027.25,-1402.8 1034.25,-1402.8"/>
</g>
<!-- L0_S0_TP0_GPU0_attn_v -->
<g id="node6" class="node">
<title>L0_S0_TP0_GPU0_attn_v</title>
<polygon fill="none" stroke="black" points="1738,-1184.67 800,-1184.67 800,-1116.67 1738,-1116.67 1738,-1184.67"/>
<text text-anchor="middle" x="1269" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="1269" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="1269" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="1269" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L0_S0_TP0_GPU0_qkv_slice&#45;&gt;L0_S0_TP0_GPU0_attn_v -->
<g id="edge5" class="edge">
<title>L0_S0_TP0_GPU0_qkv_slice&#45;&gt;L0_S0_TP0_GPU0_attn_v</title>
<path fill="none" stroke="black" d="M730.5,-1428.61C730.5,-1347.57 730.5,-1150 730.5,-1150 730.5,-1150 789.8,-1150 789.8,-1150"/>
<polygon fill="black" stroke="black" points="789.8,-1153.5 799.8,-1150 789.8,-1146.5 789.8,-1153.5"/>
</g>
<!-- L0_S0_TP0_GPU0_softmax -->
<g id="node5" class="node">
<title>L0_S0_TP0_GPU0_softmax</title>
<polygon fill="none" stroke="black" points="1525,-1288.67 1015,-1288.67 1015,-1220.67 1525,-1220.67 1525,-1288.67"/>
<text text-anchor="middle" x="1270" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="1270" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="1270" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="1270" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L0_S0_TP0_GPU0_qk_matmul&#45;&gt;L0_S0_TP0_GPU0_softmax -->
<g id="edge3" class="edge">
<title>L0_S0_TP0_GPU0_qk_matmul&#45;&gt;L0_S0_TP0_GPU0_softmax</title>
<path fill="none" stroke="black" d="M1270,-1324.61C1270,-1324.61 1270,-1298.8 1270,-1298.8"/>
<polygon fill="black" stroke="black" points="1273.5,-1298.8 1270,-1288.8 1266.5,-1298.8 1273.5,-1298.8"/>
</g>
<!-- L0_S0_TP0_GPU0_softmax&#45;&gt;L0_S0_TP0_GPU0_attn_v -->
<g id="edge4" class="edge">
<title>L0_S0_TP0_GPU0_softmax&#45;&gt;L0_S0_TP0_GPU0_attn_v</title>
<path fill="none" stroke="black" d="M1270,-1220.61C1270,-1220.61 1270,-1194.8 1270,-1194.8"/>
<polygon fill="black" stroke="black" points="1273.5,-1194.8 1270,-1184.8 1266.5,-1194.8 1273.5,-1194.8"/>
</g>
<!-- L0_S0_TP0_GPU0_mha_ar -->
<g id="node7" class="node">
<title>L0_S0_TP0_GPU0_mha_ar</title>
<ellipse fill="none" stroke="black" cx="1923" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="1923" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="1923" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="1923" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="1923" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP0_GPU0_attn_v&#45;&gt;L0_S0_TP0_GPU0_mha_ar -->
<g id="edge6" class="edge">
<title>L0_S0_TP0_GPU0_attn_v&#45;&gt;L0_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M1574.74,-1116.51C1574.74,-1116.51 1574.74,-1060.6 1574.74,-1060.6"/>
<polygon fill="black" stroke="black" points="1578.24,-1060.6 1574.74,-1050.6 1571.24,-1060.6 1578.24,-1060.6"/>
</g>
<!-- L0_S0_TP1_GPU1_mha_ar -->
<g id="node40" class="node">
<title>L0_S0_TP1_GPU1_mha_ar</title>
<ellipse fill="none" stroke="black" cx="2692" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="2692" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="2692" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="2692" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="2692" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP0_GPU0_attn_v&#45;&gt;L0_S0_TP1_GPU1_mha_ar -->
<g id="edge42" class="edge">
<title>L0_S0_TP0_GPU0_attn_v&#45;&gt;L0_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M1601.95,-1116.57C1601.95,-1098.5 1601.95,-1080 1601.95,-1080 1601.95,-1080 2363.71,-1080 2363.71,-1080 2363.71,-1080 2363.71,-1066.01 2363.71,-1066.01"/>
<polygon fill="black" stroke="black" points="2367.21,-1066.01 2363.71,-1056.01 2360.21,-1066.01 2367.21,-1066.01"/>
</g>
<!-- L0_S0_TP2_GPU2_mha_ar -->
<g id="node50" class="node">
<title>L0_S0_TP2_GPU2_mha_ar</title>
<ellipse fill="none" stroke="black" cx="3461" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="3461" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="3461" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="3461" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="3461" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP0_GPU0_attn_v&#45;&gt;L0_S0_TP2_GPU2_mha_ar -->
<g id="edge78" class="edge">
<title>L0_S0_TP0_GPU0_attn_v&#45;&gt;L0_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M1629.16,-1116.57C1629.16,-1098.5 1629.16,-1080 1629.16,-1080 1629.16,-1080 3156.09,-1080 3156.09,-1080 3156.09,-1080 3156.09,-1070.71 3156.09,-1070.71"/>
<polygon fill="black" stroke="black" points="3159.59,-1070.71 3156.09,-1060.71 3152.59,-1070.71 3159.59,-1070.71"/>
</g>
<!-- L0_S0_TP3_GPU3_mha_ar -->
<g id="node60" class="node">
<title>L0_S0_TP3_GPU3_mha_ar</title>
<ellipse fill="none" stroke="black" cx="4230" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="4230" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="4230" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="4230" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="4230" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP0_GPU0_attn_v&#45;&gt;L0_S0_TP3_GPU3_mha_ar -->
<g id="edge114" class="edge">
<title>L0_S0_TP0_GPU0_attn_v&#45;&gt;L0_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M1656.37,-1116.57C1656.37,-1098.5 1656.37,-1080 1656.37,-1080 1656.37,-1080 3961.8,-1080 3961.8,-1080 3961.8,-1080 3961.8,-1076.28 3961.8,-1076.28"/>
<polygon fill="black" stroke="black" points="3965.3,-1076.28 3961.8,-1066.28 3958.3,-1076.29 3965.3,-1076.28"/>
</g>
<!-- L0_S0_TP4_GPU4_mha_ar -->
<g id="node70" class="node">
<title>L0_S0_TP4_GPU4_mha_ar</title>
<ellipse fill="none" stroke="black" cx="4999" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="4999" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="4999" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="4999" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="4999" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP0_GPU0_attn_v&#45;&gt;L0_S0_TP4_GPU4_mha_ar -->
<g id="edge150" class="edge">
<title>L0_S0_TP0_GPU0_attn_v&#45;&gt;L0_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M1512.01,-1116.46C1512.01,-1058.92 1512.01,-949 1512.01,-949 1512.01,-949 4681.74,-949 4681.74,-949 4681.74,-949 4681.74,-996.59 4681.74,-996.59"/>
<polygon fill="black" stroke="black" points="4678.24,-996.59 4681.74,-1006.59 4685.24,-996.59 4678.24,-996.59"/>
</g>
<!-- L0_S0_TP5_GPU5_mha_ar -->
<g id="node80" class="node">
<title>L0_S0_TP5_GPU5_mha_ar</title>
<ellipse fill="none" stroke="black" cx="5768" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="5768" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="5768" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="5768" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="5768" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP0_GPU0_attn_v&#45;&gt;L0_S0_TP5_GPU5_mha_ar -->
<g id="edge186" class="edge">
<title>L0_S0_TP0_GPU0_attn_v&#45;&gt;L0_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M1631.5,-1184.94C1631.5,-1197.63 1631.5,-1209 1631.5,-1209 1631.5,-1209 5575.5,-1209 5575.5,-1209 5575.5,-1209 5575.5,-1083.94 5575.5,-1083.94"/>
<polygon fill="black" stroke="black" points="5579,-1083.94 5575.5,-1073.94 5572,-1083.94 5579,-1083.94"/>
</g>
<!-- L0_S0_TP6_GPU6_mha_ar -->
<g id="node90" class="node">
<title>L0_S0_TP6_GPU6_mha_ar</title>
<ellipse fill="none" stroke="black" cx="6537" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="6537" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="6537" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="6537" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="6537" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP0_GPU0_attn_v&#45;&gt;L0_S0_TP6_GPU6_mha_ar -->
<g id="edge222" class="edge">
<title>L0_S0_TP0_GPU0_attn_v&#45;&gt;L0_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M1683.58,-1116.54C1683.58,-1103.63 1683.58,-1092 1683.58,-1092 1683.58,-1092 6212.45,-1092 6212.45,-1092 6212.45,-1092 6212.45,-1067.09 6212.45,-1067.09"/>
<polygon fill="black" stroke="black" points="6215.95,-1067.09 6212.45,-1057.09 6208.95,-1067.09 6215.95,-1067.09"/>
</g>
<!-- L0_S0_TP7_GPU7_mha_ar -->
<g id="node100" class="node">
<title>L0_S0_TP7_GPU7_mha_ar</title>
<ellipse fill="none" stroke="black" cx="7306" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="7306" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="7306" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="7306" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="7306" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP0_GPU0_attn_v&#45;&gt;L0_S0_TP7_GPU7_mha_ar -->
<g id="edge258" class="edge">
<title>L0_S0_TP0_GPU0_attn_v&#45;&gt;L0_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M1710.79,-1116.54C1710.79,-1103.63 1710.79,-1092 1710.79,-1092 1710.79,-1092 6998.46,-1092 6998.46,-1092 6998.46,-1092 6998.46,-1070.2 6998.46,-1070.2"/>
<polygon fill="black" stroke="black" points="7001.96,-1070.2 6998.46,-1060.2 6994.96,-1070.2 7001.96,-1070.2"/>
</g>
<!-- L0_S0_TP0_GPU0_mha_res -->
<g id="node15" class="node">
<title>L0_S0_TP0_GPU0_mha_res</title>
<polygon fill="none" stroke="black" points="1285.5,-948.5 398.5,-948.5 398.5,-880.5 1285.5,-880.5 1285.5,-948.5"/>
<text text-anchor="middle" x="842" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="842" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="842" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="842" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP0_GPU0_mha_ar&#45;&gt;L0_S0_TP0_GPU0_mha_res -->
<g id="edge14" class="edge">
<title>L0_S0_TP0_GPU0_mha_ar&#45;&gt;L0_S0_TP0_GPU0_mha_res</title>
<path fill="none" stroke="black" d="M1547.46,-1032C1308.13,-1032 1042.75,-1032 1042.75,-1032 1042.75,-1032 1042.75,-958.8 1042.75,-958.8"/>
<polygon fill="black" stroke="black" points="1046.25,-958.8 1042.75,-948.8 1039.25,-958.8 1046.25,-958.8"/>
</g>
<!-- L0_S0_TP1_GPU1_attn_v -->
<g id="node8" class="node">
<title>L0_S0_TP1_GPU1_attn_v</title>
<polygon fill="none" stroke="black" points="2694,-1184.67 1756,-1184.67 1756,-1116.67 2694,-1116.67 2694,-1184.67"/>
<text text-anchor="middle" x="2225" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="2225" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="2225" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="2225" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L0_S0_TP1_GPU1_attn_v&#45;&gt;L0_S0_TP0_GPU0_mha_ar -->
<g id="edge7" class="edge">
<title>L0_S0_TP1_GPU1_attn_v&#45;&gt;L0_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M1823.81,-1116.51C1823.81,-1116.51 1823.81,-1088.96 1823.81,-1088.96"/>
<polygon fill="black" stroke="black" points="1827.31,-1088.96 1823.81,-1078.96 1820.31,-1088.96 1827.31,-1088.96"/>
</g>
<!-- L0_S0_TP1_GPU1_attn_v&#45;&gt;L0_S0_TP1_GPU1_mha_ar -->
<g id="edge43" class="edge">
<title>L0_S0_TP1_GPU1_attn_v&#45;&gt;L0_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M2410.89,-1116.51C2410.89,-1116.51 2410.89,-1074.64 2410.89,-1074.64"/>
<polygon fill="black" stroke="black" points="2414.39,-1074.64 2410.89,-1064.64 2407.39,-1074.64 2414.39,-1074.64"/>
</g>
<!-- L0_S0_TP1_GPU1_attn_v&#45;&gt;L0_S0_TP2_GPU2_mha_ar -->
<g id="edge79" class="edge">
<title>L0_S0_TP1_GPU1_attn_v&#45;&gt;L0_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M2458.08,-1116.57C2458.08,-1098.5 2458.08,-1080 2458.08,-1080 2458.08,-1080 3226.64,-1080 3226.64,-1080 3226.64,-1080 3226.64,-1079.04 3226.64,-1079.04"/>
<polygon fill="black" stroke="black" points="3230.14,-1080.4 3226.64,-1070.4 3223.14,-1080.4 3230.14,-1080.4"/>
</g>
<!-- L0_S0_TP1_GPU1_attn_v&#45;&gt;L0_S0_TP3_GPU3_mha_ar -->
<g id="edge115" class="edge">
<title>L0_S0_TP1_GPU1_attn_v&#45;&gt;L0_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M2505.26,-1116.57C2505.26,-1098.5 2505.26,-1080 2505.26,-1080 2505.26,-1080 4069.08,-1080 4069.08,-1080 4069.08,-1080 4069.08,-1079.63 4069.08,-1079.63"/>
<polygon fill="black" stroke="black" points="4072.58,-1086.28 4069.08,-1076.28 4065.58,-1086.28 4072.58,-1086.28"/>
</g>
<!-- L0_S0_TP1_GPU1_attn_v&#45;&gt;L0_S0_TP4_GPU4_mha_ar -->
<g id="edge151" class="edge">
<title>L0_S0_TP1_GPU1_attn_v&#45;&gt;L0_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M2307.5,-1116.46C2307.5,-1058.92 2307.5,-949 2307.5,-949 2307.5,-949 4652.98,-949 4652.98,-949 4652.98,-949 4652.98,-1003.62 4652.98,-1003.62"/>
<polygon fill="black" stroke="black" points="4649.48,-1003.62 4652.98,-1013.62 4656.48,-1003.62 4649.48,-1003.62"/>
</g>
<!-- L0_S0_TP1_GPU1_attn_v&#45;&gt;L0_S0_TP5_GPU5_mha_ar -->
<g id="edge187" class="edge">
<title>L0_S0_TP1_GPU1_attn_v&#45;&gt;L0_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M2552.45,-1116.54C2552.45,-1103.63 2552.45,-1092 2552.45,-1092 2552.45,-1092 5426.42,-1092 5426.42,-1092 5426.42,-1092 5426.42,-1062.7 5426.42,-1062.7"/>
<polygon fill="black" stroke="black" points="5429.92,-1062.7 5426.42,-1052.7 5422.92,-1062.7 5429.92,-1062.7"/>
</g>
<!-- L0_S0_TP1_GPU1_attn_v&#45;&gt;L0_S0_TP6_GPU6_mha_ar -->
<g id="edge223" class="edge">
<title>L0_S0_TP1_GPU1_attn_v&#45;&gt;L0_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M2599.63,-1116.54C2599.63,-1103.63 2599.63,-1092 2599.63,-1092 2599.63,-1092 6263.38,-1092 6263.38,-1092 6263.38,-1092 6263.38,-1075.77 6263.38,-1075.77"/>
<polygon fill="black" stroke="black" points="6266.88,-1075.77 6263.38,-1065.77 6259.88,-1075.77 6266.88,-1075.77"/>
</g>
<!-- L0_S0_TP1_GPU1_attn_v&#45;&gt;L0_S0_TP7_GPU7_mha_ar -->
<g id="edge259" class="edge">
<title>L0_S0_TP1_GPU1_attn_v&#45;&gt;L0_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M2646.82,-1116.54C2646.82,-1103.63 2646.82,-1092 2646.82,-1092 2646.82,-1092 7066.39,-1092 7066.39,-1092 7066.39,-1092 7066.39,-1079.88 7066.39,-1079.88"/>
<polygon fill="black" stroke="black" points="7069.89,-1079.88 7066.39,-1069.88 7062.89,-1079.88 7069.89,-1079.88"/>
</g>
<!-- L0_S0_TP2_GPU2_attn_v -->
<g id="node9" class="node">
<title>L0_S0_TP2_GPU2_attn_v</title>
<polygon fill="none" stroke="black" points="3650,-1184.67 2712,-1184.67 2712,-1116.67 3650,-1116.67 3650,-1184.67"/>
<text text-anchor="middle" x="3181" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="3181" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="3181" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="3181" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L0_S0_TP2_GPU2_attn_v&#45;&gt;L0_S0_TP0_GPU0_mha_ar -->
<g id="edge8" class="edge">
<title>L0_S0_TP2_GPU2_attn_v&#45;&gt;L0_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M2771.25,-1116.48C2771.25,-1114.32 2771.25,-1113 2771.25,-1113 2771.25,-1113 1891.62,-1113 1891.62,-1113 1891.62,-1113 1891.62,-1090.75 1891.62,-1090.75"/>
<polygon fill="black" stroke="black" points="1895.12,-1090.75 1891.62,-1080.75 1888.12,-1090.75 1895.12,-1090.75"/>
</g>
<!-- L0_S0_TP2_GPU2_attn_v&#45;&gt;L0_S0_TP1_GPU1_mha_ar -->
<g id="edge44" class="edge">
<title>L0_S0_TP2_GPU2_attn_v&#45;&gt;L0_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M2830.49,-1116.51C2830.49,-1116.51 2830.49,-1087.65 2830.49,-1087.65"/>
<polygon fill="black" stroke="black" points="2833.99,-1087.65 2830.49,-1077.65 2826.99,-1087.65 2833.99,-1087.65"/>
</g>
<!-- L0_S0_TP2_GPU2_attn_v&#45;&gt;L0_S0_TP2_GPU2_mha_ar -->
<g id="edge80" class="edge">
<title>L0_S0_TP2_GPU2_attn_v&#45;&gt;L0_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M3297.2,-1116.51C3297.2,-1116.51 3297.2,-1085.92 3297.2,-1085.92"/>
<polygon fill="black" stroke="black" points="3300.7,-1085.92 3297.2,-1075.92 3293.7,-1085.92 3300.7,-1085.92"/>
</g>
<!-- L0_S0_TP2_GPU2_attn_v&#45;&gt;L0_S0_TP3_GPU3_mha_ar -->
<g id="edge116" class="edge">
<title>L0_S0_TP2_GPU2_attn_v&#45;&gt;L0_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M3367.76,-1116.65C3367.76,-1098.97 3367.76,-1081 3367.76,-1081 3367.76,-1081 4176.36,-1081 4176.36,-1081 4176.36,-1081 4176.36,-1080.95 4176.36,-1080.95"/>
<polygon fill="black" stroke="black" points="4179.86,-1090.46 4176.36,-1080.46 4172.86,-1090.46 4179.86,-1090.46"/>
</g>
<!-- L0_S0_TP2_GPU2_attn_v&#45;&gt;L0_S0_TP4_GPU4_mha_ar -->
<g id="edge152" class="edge">
<title>L0_S0_TP2_GPU2_attn_v&#45;&gt;L0_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M3438.32,-1116.46C3438.32,-1104.04 3438.32,-1093 3438.32,-1093 3438.32,-1093 4838.42,-1093 4838.42,-1093 4838.42,-1093 4838.42,-1086.17 4838.42,-1086.17"/>
<polygon fill="black" stroke="black" points="4841.92,-1086.17 4838.42,-1076.17 4834.92,-1086.17 4841.92,-1086.17"/>
</g>
<!-- L0_S0_TP2_GPU2_attn_v&#45;&gt;L0_S0_TP5_GPU5_mha_ar -->
<g id="edge188" class="edge">
<title>L0_S0_TP2_GPU2_attn_v&#45;&gt;L0_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M3571,-1184.7C3571,-1194.69 3571,-1203 3571,-1203 3571,-1203 5571,-1203 5571,-1203 5571,-1203 5571,-1083.84 5571,-1083.84"/>
<polygon fill="black" stroke="black" points="5574.5,-1083.84 5571,-1073.84 5567.5,-1083.84 5574.5,-1083.84"/>
</g>
<!-- L0_S0_TP2_GPU2_attn_v&#45;&gt;L0_S0_TP6_GPU6_mha_ar -->
<g id="edge224" class="edge">
<title>L0_S0_TP2_GPU2_attn_v&#45;&gt;L0_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M3508.88,-1116.46C3508.88,-1104.04 3508.88,-1093 3508.88,-1093 3508.88,-1093 6314.3,-1093 6314.3,-1093 6314.3,-1093 6314.3,-1081.53 6314.3,-1081.53"/>
<polygon fill="black" stroke="black" points="6317.8,-1081.53 6314.3,-1071.53 6310.8,-1081.53 6317.8,-1081.53"/>
</g>
<!-- L0_S0_TP2_GPU2_attn_v&#45;&gt;L0_S0_TP7_GPU7_mha_ar -->
<g id="edge260" class="edge">
<title>L0_S0_TP2_GPU2_attn_v&#45;&gt;L0_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M3579.44,-1116.54C3579.44,-1103.63 3579.44,-1092 3579.44,-1092 3579.44,-1092 7134.33,-1092 7134.33,-1092 7134.33,-1092 7134.33,-1085.45 7134.33,-1085.45"/>
<polygon fill="black" stroke="black" points="7137.83,-1085.45 7134.33,-1075.45 7130.83,-1085.45 7137.83,-1085.45"/>
</g>
<!-- L0_S0_TP3_GPU3_attn_v -->
<g id="node10" class="node">
<title>L0_S0_TP3_GPU3_attn_v</title>
<polygon fill="none" stroke="black" points="4606,-1184.67 3668,-1184.67 3668,-1116.67 4606,-1116.67 4606,-1184.67"/>
<text text-anchor="middle" x="4137" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="4137" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="4137" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="4137" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L0_S0_TP3_GPU3_attn_v&#45;&gt;L0_S0_TP0_GPU0_mha_ar -->
<g id="edge9" class="edge">
<title>L0_S0_TP3_GPU3_attn_v&#45;&gt;L0_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M3696.08,-1116.48C3696.08,-1114.32 3696.08,-1113 3696.08,-1113 3696.08,-1113 1959.43,-1113 1959.43,-1113 1959.43,-1113 1959.43,-1090.75 1959.43,-1090.75"/>
<polygon fill="black" stroke="black" points="1962.93,-1090.75 1959.43,-1080.75 1955.93,-1090.75 1962.93,-1090.75"/>
</g>
<!-- L0_S0_TP3_GPU3_attn_v&#45;&gt;L0_S0_TP1_GPU1_mha_ar -->
<g id="edge45" class="edge">
<title>L0_S0_TP3_GPU3_attn_v&#45;&gt;L0_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M3724.16,-1116.48C3724.16,-1114.32 3724.16,-1113 3724.16,-1113 3724.16,-1113 2889.74,-1113 2889.74,-1113 2889.74,-1113 2889.74,-1083.73 2889.74,-1083.73"/>
<polygon fill="black" stroke="black" points="2893.24,-1083.73 2889.74,-1073.73 2886.24,-1083.73 2893.24,-1083.73"/>
</g>
<!-- L0_S0_TP3_GPU3_attn_v&#45;&gt;L0_S0_TP2_GPU2_mha_ar -->
<g id="edge81" class="edge">
<title>L0_S0_TP3_GPU3_attn_v&#45;&gt;L0_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M3752.24,-1116.51C3752.24,-1116.51 3752.24,-1073.04 3752.24,-1073.04"/>
<polygon fill="black" stroke="black" points="3755.74,-1073.04 3752.24,-1063.04 3748.74,-1073.04 3755.74,-1073.04"/>
</g>
<!-- L0_S0_TP3_GPU3_attn_v&#45;&gt;L0_S0_TP3_GPU3_mha_ar -->
<g id="edge117" class="edge">
<title>L0_S0_TP3_GPU3_attn_v&#45;&gt;L0_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M4283.64,-1116.51C4283.64,-1116.51 4283.64,-1090.27 4283.64,-1090.27"/>
<polygon fill="black" stroke="black" points="4287.14,-1090.27 4283.64,-1080.27 4280.14,-1090.27 4287.14,-1090.27"/>
</g>
<!-- L0_S0_TP3_GPU3_attn_v&#45;&gt;L0_S0_TP4_GPU4_mha_ar -->
<g id="edge153" class="edge">
<title>L0_S0_TP3_GPU3_attn_v&#45;&gt;L0_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M4606.26,-1161C4613.62,-1161 4617.67,-1161 4617.67,-1161 4617.67,-1161 4617.67,-1016 4617.67,-1016 4617.67,-1016 4636.33,-1016 4636.33,-1016"/>
<polygon fill="black" stroke="black" points="4636.33,-1019.5 4646.33,-1016 4636.33,-1012.5 4636.33,-1019.5"/>
</g>
<!-- L0_S0_TP3_GPU3_attn_v&#45;&gt;L0_S0_TP5_GPU5_mha_ar -->
<g id="edge189" class="edge">
<title>L0_S0_TP3_GPU3_attn_v&#45;&gt;L0_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M4606.13,-1184C4799.4,-1184 5566.5,-1184 5566.5,-1184 5566.5,-1184 5566.5,-1083.16 5566.5,-1083.16"/>
<polygon fill="black" stroke="black" points="5570,-1083.16 5566.5,-1073.16 5563,-1083.16 5570,-1083.16"/>
</g>
<!-- L0_S0_TP3_GPU3_attn_v&#45;&gt;L0_S0_TP6_GPU6_mha_ar -->
<g id="edge225" class="edge">
<title>L0_S0_TP3_GPU3_attn_v&#45;&gt;L0_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M4518.67,-1184.81C4518.67,-1190.18 4518.67,-1194 4518.67,-1194 4518.67,-1194 6527,-1194 6527,-1194 6527,-1194 6527,-1091.01 6527,-1091.01"/>
<polygon fill="black" stroke="black" points="6530.5,-1091.01 6527,-1081.01 6523.5,-1091.01 6530.5,-1091.01"/>
</g>
<!-- L0_S0_TP3_GPU3_attn_v&#45;&gt;L0_S0_TP7_GPU7_mha_ar -->
<g id="edge261" class="edge">
<title>L0_S0_TP3_GPU3_attn_v&#45;&gt;L0_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M4390.92,-1116.46C4390.92,-1104.04 4390.92,-1093 4390.92,-1093 4390.92,-1093 7202.26,-1093 7202.26,-1093 7202.26,-1093 7202.26,-1088.99 7202.26,-1088.99"/>
<polygon fill="black" stroke="black" points="7205.76,-1088.99 7202.26,-1078.99 7198.76,-1088.99 7205.76,-1088.99"/>
</g>
<!-- L0_S0_TP4_GPU4_attn_v -->
<g id="node11" class="node">
<title>L0_S0_TP4_GPU4_attn_v</title>
<polygon fill="none" stroke="black" points="5562,-1184.67 4624,-1184.67 4624,-1116.67 5562,-1116.67 5562,-1184.67"/>
<text text-anchor="middle" x="5093" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="5093" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="5093" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="5093" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L0_S0_TP4_GPU4_attn_v&#45;&gt;L0_S0_TP0_GPU0_mha_ar -->
<g id="edge10" class="edge">
<title>L0_S0_TP4_GPU4_attn_v&#45;&gt;L0_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M4731.21,-1116.46C4731.21,-1104.04 4731.21,-1093 4731.21,-1093 4731.21,-1093 2027.24,-1093 2027.24,-1093 2027.24,-1093 2027.24,-1088.99 2027.24,-1088.99"/>
<polygon fill="black" stroke="black" points="2030.74,-1088.99 2027.24,-1078.99 2023.74,-1088.99 2030.74,-1088.99"/>
</g>
<!-- L0_S0_TP4_GPU4_attn_v&#45;&gt;L0_S0_TP1_GPU1_mha_ar -->
<g id="edge46" class="edge">
<title>L0_S0_TP4_GPU4_attn_v&#45;&gt;L0_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M4721.67,-1184.81C4721.67,-1192.28 4721.67,-1198 4721.67,-1198 4721.67,-1198 2706,-1198 2706,-1198 2706,-1198 2706,-1090.87 2706,-1090.87"/>
<polygon fill="black" stroke="black" points="2709.5,-1090.87 2706,-1080.87 2702.5,-1090.87 2709.5,-1090.87"/>
</g>
<!-- L0_S0_TP4_GPU4_attn_v&#45;&gt;L0_S0_TP2_GPU2_mha_ar -->
<g id="edge82" class="edge">
<title>L0_S0_TP4_GPU4_attn_v&#45;&gt;L0_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M4672.83,-1184.9C4672.83,-1187.42 4672.83,-1189 4672.83,-1189 4672.83,-1189 3662,-1189 3662,-1189 3662,-1189 3662,-1083.27 3662,-1083.27"/>
<polygon fill="black" stroke="black" points="3665.5,-1083.27 3662,-1073.27 3658.5,-1083.27 3665.5,-1083.27"/>
</g>
<!-- L0_S0_TP4_GPU4_attn_v&#45;&gt;L0_S0_TP3_GPU3_mha_ar -->
<g id="edge118" class="edge">
<title>L0_S0_TP4_GPU4_attn_v&#45;&gt;L0_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M4623.61,-1139C4618.49,-1139 4615.72,-1139 4615.72,-1139 4615.72,-1139 4615.72,-1048 4615.72,-1048 4615.72,-1048 4595.78,-1048 4595.78,-1048"/>
<polygon fill="black" stroke="black" points="4595.78,-1044.5 4585.78,-1048 4595.78,-1051.5 4595.78,-1044.5"/>
</g>
<!-- L0_S0_TP4_GPU4_attn_v&#45;&gt;L0_S0_TP4_GPU4_mha_ar -->
<g id="edge154" class="edge">
<title>L0_S0_TP4_GPU4_attn_v&#45;&gt;L0_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M4945.63,-1116.51C4945.63,-1116.51 4945.63,-1090.27 4945.63,-1090.27"/>
<polygon fill="black" stroke="black" points="4949.13,-1090.27 4945.63,-1080.27 4942.13,-1090.27 4949.13,-1090.27"/>
</g>
<!-- L0_S0_TP4_GPU4_attn_v&#45;&gt;L0_S0_TP5_GPU5_mha_ar -->
<g id="edge190" class="edge">
<title>L0_S0_TP4_GPU4_attn_v&#45;&gt;L0_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M5460.32,-1116.51C5460.32,-1116.51 5460.32,-1070.31 5460.32,-1070.31"/>
<polygon fill="black" stroke="black" points="5463.82,-1070.31 5460.32,-1060.31 5456.82,-1070.31 5463.82,-1070.31"/>
</g>
<!-- L0_S0_TP4_GPU4_attn_v&#45;&gt;L0_S0_TP6_GPU6_mha_ar -->
<g id="edge226" class="edge">
<title>L0_S0_TP4_GPU4_attn_v&#45;&gt;L0_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M5494.21,-1116.46C5494.21,-1104.04 5494.21,-1093 5494.21,-1093 5494.21,-1093 6365.23,-1093 6365.23,-1093 6365.23,-1093 6365.23,-1085.52 6365.23,-1085.52"/>
<polygon fill="black" stroke="black" points="6368.73,-1085.52 6365.23,-1075.52 6361.73,-1085.52 6368.73,-1085.52"/>
</g>
<!-- L0_S0_TP4_GPU4_attn_v&#45;&gt;L0_S0_TP7_GPU7_mha_ar -->
<g id="edge262" class="edge">
<title>L0_S0_TP4_GPU4_attn_v&#45;&gt;L0_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M5528.11,-1116.46C5528.11,-1104.04 5528.11,-1093 5528.11,-1093 5528.11,-1093 7270.2,-1093 7270.2,-1093 7270.2,-1093 7270.2,-1090.48 7270.2,-1090.48"/>
<polygon fill="black" stroke="black" points="7273.7,-1090.48 7270.2,-1080.48 7266.7,-1090.48 7273.7,-1090.48"/>
</g>
<!-- L0_S0_TP5_GPU5_attn_v -->
<g id="node12" class="node">
<title>L0_S0_TP5_GPU5_attn_v</title>
<polygon fill="none" stroke="black" points="6518,-1184.67 5580,-1184.67 5580,-1116.67 6518,-1116.67 6518,-1184.67"/>
<text text-anchor="middle" x="6049" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="6049" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="6049" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="6049" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L0_S0_TP5_GPU5_attn_v&#45;&gt;L0_S0_TP0_GPU0_mha_ar -->
<g id="edge11" class="edge">
<title>L0_S0_TP5_GPU5_attn_v&#45;&gt;L0_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M5642.61,-1116.46C5642.61,-1104.04 5642.61,-1093 5642.61,-1093 5642.61,-1093 2095.05,-1093 2095.05,-1093 2095.05,-1093 2095.05,-1085.52 2095.05,-1085.52"/>
<polygon fill="black" stroke="black" points="2098.55,-1085.52 2095.05,-1075.52 2091.55,-1085.52 2098.55,-1085.52"/>
</g>
<!-- L0_S0_TP5_GPU5_attn_v&#45;&gt;L0_S0_TP1_GPU1_mha_ar -->
<g id="edge47" class="edge">
<title>L0_S0_TP5_GPU5_attn_v&#45;&gt;L0_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M5705.22,-1116.46C5705.22,-1104.04 5705.22,-1093 5705.22,-1093 5705.22,-1093 2948.98,-1093 2948.98,-1093 2948.98,-1093 2948.98,-1077.73 2948.98,-1077.73"/>
<polygon fill="black" stroke="black" points="2952.48,-1077.73 2948.98,-1067.73 2945.48,-1077.73 2952.48,-1077.73"/>
</g>
<!-- L0_S0_TP5_GPU5_attn_v&#45;&gt;L0_S0_TP2_GPU2_mha_ar -->
<g id="edge83" class="edge">
<title>L0_S0_TP5_GPU5_attn_v&#45;&gt;L0_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M5767.82,-1116.46C5767.82,-1104.04 5767.82,-1093 5767.82,-1093 5767.82,-1093 3780.32,-1093 3780.32,-1093 3780.32,-1093 3780.32,-1068.21 3780.32,-1068.21"/>
<polygon fill="black" stroke="black" points="3783.82,-1068.21 3780.32,-1058.21 3776.82,-1068.21 3783.82,-1068.21"/>
</g>
<!-- L0_S0_TP5_GPU5_attn_v&#45;&gt;L0_S0_TP3_GPU3_mha_ar -->
<g id="edge119" class="edge">
<title>L0_S0_TP5_GPU5_attn_v&#45;&gt;L0_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M5830.43,-1116.46C5830.43,-1104.04 5830.43,-1093 5830.43,-1093 5830.43,-1093 4498.2,-1093 4498.2,-1093 4498.2,-1093 4498.2,-1076.32 4498.2,-1076.32"/>
<polygon fill="black" stroke="black" points="4501.7,-1076.32 4498.2,-1066.32 4494.7,-1076.32 4501.7,-1076.32"/>
</g>
<!-- L0_S0_TP5_GPU5_attn_v&#45;&gt;L0_S0_TP4_GPU4_mha_ar -->
<g id="edge155" class="edge">
<title>L0_S0_TP5_GPU5_attn_v&#45;&gt;L0_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M5893.04,-1116.6C5893.04,-1101.46 5893.04,-1087 5893.04,-1087 5893.04,-1087 5052.84,-1087 5052.84,-1087 5052.84,-1087 5052.84,-1086.33 5052.84,-1086.33"/>
<polygon fill="black" stroke="black" points="5056.34,-1090.33 5052.84,-1080.33 5049.34,-1090.33 5056.34,-1090.33"/>
</g>
<!-- L0_S0_TP5_GPU5_attn_v&#45;&gt;L0_S0_TP5_GPU5_mha_ar -->
<g id="edge191" class="edge">
<title>L0_S0_TP5_GPU5_attn_v&#45;&gt;L0_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M5955.65,-1116.51C5955.65,-1116.51 5955.65,-1084.63 5955.65,-1084.63"/>
<polygon fill="black" stroke="black" points="5959.15,-1084.63 5955.65,-1074.63 5952.15,-1084.63 5959.15,-1084.63"/>
</g>
<!-- L0_S0_TP5_GPU5_attn_v&#45;&gt;L0_S0_TP6_GPU6_mha_ar -->
<g id="edge227" class="edge">
<title>L0_S0_TP5_GPU5_attn_v&#45;&gt;L0_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M6416.15,-1116.51C6416.15,-1116.51 6416.15,-1088.52 6416.15,-1088.52"/>
<polygon fill="black" stroke="black" points="6419.65,-1088.52 6416.15,-1078.52 6412.65,-1088.52 6419.65,-1088.52"/>
</g>
<!-- L0_S0_TP5_GPU5_attn_v&#45;&gt;L0_S0_TP7_GPU7_mha_ar -->
<g id="edge263" class="edge">
<title>L0_S0_TP5_GPU5_attn_v&#45;&gt;L0_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M6467.08,-1116.46C6467.08,-1104.04 6467.08,-1093 6467.08,-1093 6467.08,-1093 7338.13,-1093 7338.13,-1093 7338.13,-1093 7338.13,-1090.77 7338.13,-1090.77"/>
<polygon fill="black" stroke="black" points="7341.63,-1090.77 7338.13,-1080.77 7334.63,-1090.77 7341.63,-1090.77"/>
</g>
<!-- L0_S0_TP6_GPU6_attn_v -->
<g id="node13" class="node">
<title>L0_S0_TP6_GPU6_attn_v</title>
<polygon fill="none" stroke="black" points="7474,-1184.67 6536,-1184.67 6536,-1116.67 7474,-1116.67 7474,-1184.67"/>
<text text-anchor="middle" x="7005" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="7005" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="7005" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="7005" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L0_S0_TP6_GPU6_attn_v&#45;&gt;L0_S0_TP0_GPU0_mha_ar -->
<g id="edge12" class="edge">
<title>L0_S0_TP6_GPU6_attn_v&#45;&gt;L0_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M6583.06,-1116.46C6583.06,-1104.04 6583.06,-1093 6583.06,-1093 6583.06,-1093 2162.86,-1093 2162.86,-1093 2162.86,-1093 2162.86,-1079.81 2162.86,-1079.81"/>
<polygon fill="black" stroke="black" points="2166.36,-1079.81 2162.86,-1069.81 2159.36,-1079.81 2166.36,-1079.81"/>
</g>
<!-- L0_S0_TP6_GPU6_attn_v&#45;&gt;L0_S0_TP1_GPU1_mha_ar -->
<g id="edge48" class="edge">
<title>L0_S0_TP6_GPU6_attn_v&#45;&gt;L0_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M6630.12,-1116.46C6630.12,-1104.04 6630.12,-1093 6630.12,-1093 6630.12,-1093 3008.23,-1093 3008.23,-1093 3008.23,-1093 3008.23,-1068.56 3008.23,-1068.56"/>
<polygon fill="black" stroke="black" points="3011.73,-1068.56 3008.23,-1058.56 3004.73,-1068.56 3011.73,-1068.56"/>
</g>
<!-- L0_S0_TP6_GPU6_attn_v&#45;&gt;L0_S0_TP2_GPU2_mha_ar -->
<g id="edge84" class="edge">
<title>L0_S0_TP6_GPU6_attn_v&#45;&gt;L0_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M6677.18,-1116.46C6677.18,-1104.04 6677.18,-1093 6677.18,-1093 6677.18,-1093 3808.39,-1093 3808.39,-1093 3808.39,-1093 3808.39,-1061.04 3808.39,-1061.04"/>
<polygon fill="black" stroke="black" points="3811.89,-1061.04 3808.39,-1051.04 3804.89,-1061.04 3811.89,-1061.04"/>
</g>
<!-- L0_S0_TP6_GPU6_attn_v&#45;&gt;L0_S0_TP3_GPU3_mha_ar -->
<g id="edge120" class="edge">
<title>L0_S0_TP6_GPU6_attn_v&#45;&gt;L0_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M6921.5,-1116.61C6921.5,-1063.01 6921.5,-965 6921.5,-965 6921.5,-965 4576.82,-965 4576.82,-965 4576.82,-965 4576.82,-1004.12 4576.82,-1004.12"/>
<polygon fill="black" stroke="black" points="4573.32,-1004.12 4576.82,-1014.12 4580.32,-1004.12 4573.32,-1004.12"/>
</g>
<!-- L0_S0_TP6_GPU6_attn_v&#45;&gt;L0_S0_TP4_GPU4_mha_ar -->
<g id="edge156" class="edge">
<title>L0_S0_TP6_GPU6_attn_v&#45;&gt;L0_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M6724.24,-1116.44C6724.24,-1100.93 6724.24,-1086 6724.24,-1086 6724.24,-1086 5160.05,-1086 5160.05,-1086 5160.05,-1086 5160.05,-1085.02 5160.05,-1085.02"/>
<polygon fill="black" stroke="black" points="5163.55,-1086.2 5160.05,-1076.2 5156.55,-1086.2 5163.55,-1086.2"/>
</g>
<!-- L0_S0_TP6_GPU6_attn_v&#45;&gt;L0_S0_TP5_GPU5_mha_ar -->
<g id="edge192" class="edge">
<title>L0_S0_TP6_GPU6_attn_v&#45;&gt;L0_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M6771.3,-1116.44C6771.3,-1100.93 6771.3,-1086 6771.3,-1086 6771.3,-1086 6018.26,-1086 6018.26,-1086 6018.26,-1086 6018.26,-1078.51 6018.26,-1078.51"/>
<polygon fill="black" stroke="black" points="6021.76,-1078.51 6018.26,-1068.51 6014.76,-1078.51 6021.76,-1078.51"/>
</g>
<!-- L0_S0_TP6_GPU6_attn_v&#45;&gt;L0_S0_TP6_GPU6_mha_ar -->
<g id="edge228" class="edge">
<title>L0_S0_TP6_GPU6_attn_v&#45;&gt;L0_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M6818.36,-1116.51C6818.36,-1116.51 6818.36,-1074.64 6818.36,-1074.64"/>
<polygon fill="black" stroke="black" points="6821.86,-1074.64 6818.36,-1064.64 6814.86,-1074.64 6821.86,-1074.64"/>
</g>
<!-- L0_S0_TP6_GPU6_attn_v&#45;&gt;L0_S0_TP7_GPU7_mha_ar -->
<g id="edge264" class="edge">
<title>L0_S0_TP6_GPU6_attn_v&#45;&gt;L0_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M7406.07,-1116.51C7406.07,-1116.51 7406.07,-1088.96 7406.07,-1088.96"/>
<polygon fill="black" stroke="black" points="7409.57,-1088.96 7406.07,-1078.96 7402.57,-1088.96 7409.57,-1088.96"/>
</g>
<!-- L0_S0_TP7_GPU7_attn_v -->
<g id="node14" class="node">
<title>L0_S0_TP7_GPU7_attn_v</title>
<polygon fill="none" stroke="black" points="8430,-1184.67 7492,-1184.67 7492,-1116.67 8430,-1116.67 8430,-1184.67"/>
<text text-anchor="middle" x="7961" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="7961" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="7961" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="7961" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L0_S0_TP7_GPU7_attn_v&#45;&gt;L0_S0_TP0_GPU0_mha_ar -->
<g id="edge13" class="edge">
<title>L0_S0_TP7_GPU7_attn_v&#45;&gt;L0_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M7523.58,-1116.46C7523.58,-1104.04 7523.58,-1093 7523.58,-1093 7523.58,-1093 2230.66,-1093 2230.66,-1093 2230.66,-1093 2230.66,-1070.32 2230.66,-1070.32"/>
<polygon fill="black" stroke="black" points="2234.16,-1070.32 2230.66,-1060.32 2227.16,-1070.32 2234.16,-1070.32"/>
</g>
<!-- L0_S0_TP7_GPU7_attn_v&#45;&gt;L0_S0_TP1_GPU1_mha_ar -->
<g id="edge49" class="edge">
<title>L0_S0_TP7_GPU7_attn_v&#45;&gt;L0_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M7515.33,-1185C7515.33,-1201.18 7515.33,-1217 7515.33,-1217 7515.33,-1217 2700,-1217 2700,-1217 2700,-1217 2700,-1091.04 2700,-1091.04"/>
<polygon fill="black" stroke="black" points="2703.5,-1091.04 2700,-1081.04 2696.5,-1091.04 2703.5,-1091.04"/>
</g>
<!-- L0_S0_TP7_GPU7_attn_v&#45;&gt;L0_S0_TP2_GPU2_mha_ar -->
<g id="edge85" class="edge">
<title>L0_S0_TP7_GPU7_attn_v&#45;&gt;L0_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M7503.67,-1184.92C7503.67,-1198.97 7503.67,-1212 7503.67,-1212 7503.67,-1212 3656,-1212 3656,-1212 3656,-1212 3656,-1083.74 3656,-1083.74"/>
<polygon fill="black" stroke="black" points="3659.5,-1083.74 3656,-1073.74 3652.5,-1083.74 3659.5,-1083.74"/>
</g>
<!-- L0_S0_TP7_GPU7_attn_v&#45;&gt;L0_S0_TP3_GPU3_mha_ar -->
<g id="edge121" class="edge">
<title>L0_S0_TP7_GPU7_attn_v&#45;&gt;L0_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M7717.49,-1116.61C7717.49,-1063.01 7717.49,-965 7717.49,-965 7717.49,-965 4548.16,-965 4548.16,-965 4548.16,-965 4548.16,-997.03 4548.16,-997.03"/>
<polygon fill="black" stroke="black" points="4544.66,-997.03 4548.16,-1007.03 4551.66,-997.03 4544.66,-997.03"/>
</g>
<!-- L0_S0_TP7_GPU7_attn_v&#45;&gt;L0_S0_TP4_GPU4_mha_ar -->
<g id="edge157" class="edge">
<title>L0_S0_TP7_GPU7_attn_v&#45;&gt;L0_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M7555.16,-1116.44C7555.16,-1100.93 7555.16,-1086 7555.16,-1086 7555.16,-1086 5267.26,-1086 5267.26,-1086 5267.26,-1086 5267.26,-1076.41 5267.26,-1076.41"/>
<polygon fill="black" stroke="black" points="5270.76,-1076.41 5267.26,-1066.41 5263.76,-1076.41 5270.76,-1076.41"/>
</g>
<!-- L0_S0_TP7_GPU7_attn_v&#45;&gt;L0_S0_TP5_GPU5_mha_ar -->
<g id="edge193" class="edge">
<title>L0_S0_TP7_GPU7_attn_v&#45;&gt;L0_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M7586.74,-1116.44C7586.74,-1100.93 7586.74,-1086 7586.74,-1086 7586.74,-1086 6080.87,-1086 6080.87,-1086 6080.87,-1086 6080.87,-1069.29 6080.87,-1069.29"/>
<polygon fill="black" stroke="black" points="6084.37,-1069.29 6080.87,-1059.29 6077.37,-1069.29 6084.37,-1069.29"/>
</g>
<!-- L0_S0_TP7_GPU7_attn_v&#45;&gt;L0_S0_TP6_GPU6_mha_ar -->
<g id="edge229" class="edge">
<title>L0_S0_TP7_GPU7_attn_v&#45;&gt;L0_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M7618.32,-1116.44C7618.32,-1100.93 7618.32,-1086 7618.32,-1086 7618.32,-1086 6865.41,-1086 6865.41,-1086 6865.41,-1086 6865.41,-1066.17 6865.41,-1066.17"/>
<polygon fill="black" stroke="black" points="6868.91,-1066.17 6865.41,-1056.17 6861.91,-1066.17 6868.91,-1066.17"/>
</g>
<!-- L0_S0_TP7_GPU7_attn_v&#45;&gt;L0_S0_TP7_GPU7_mha_ar -->
<g id="edge265" class="edge">
<title>L0_S0_TP7_GPU7_attn_v&#45;&gt;L0_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M7649.89,-1116.51C7649.89,-1116.51 7649.89,-1061.95 7649.89,-1061.95"/>
<polygon fill="black" stroke="black" points="7653.39,-1061.95 7649.89,-1051.95 7646.39,-1061.95 7653.39,-1061.95"/>
</g>
<!-- L0_S0_TP0_GPU0_gate -->
<g id="node16" class="node">
<title>L0_S0_TP0_GPU0_gate</title>
<polygon fill="none" stroke="black" points="1371.56,-844.5 529.15,-844.5 312.44,-708.5 1154.85,-708.5 1371.56,-844.5"/>
<text text-anchor="middle" x="842" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="842" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="842" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="842" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L0_S0_TP0_GPU0_mha_res&#45;&gt;L0_S0_TP0_GPU0_gate -->
<g id="edge15" class="edge">
<title>L0_S0_TP0_GPU0_mha_res&#45;&gt;L0_S0_TP0_GPU0_gate</title>
<path fill="none" stroke="black" d="M842,-880.39C842,-880.39 842,-854.73 842,-854.73"/>
<polygon fill="black" stroke="black" points="845.5,-854.73 842,-844.73 838.5,-854.73 845.5,-854.73"/>
</g>
<!-- L0_S0_TP0_GPU0_moe_res -->
<g id="node34" class="node">
<title>L0_S0_TP0_GPU0_moe_res</title>
<polygon fill="none" stroke="black" points="820,-436.33 0,-436.33 0,-368.33 820,-368.33 820,-436.33"/>
<text text-anchor="middle" x="410" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="410" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="410" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="410" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP0_GPU0_mha_res&#45;&gt;L0_S0_TP0_GPU0_moe_res -->
<g id="edge35" class="edge">
<title>L0_S0_TP0_GPU0_mha_res&#45;&gt;L0_S0_TP0_GPU0_moe_res</title>
<path fill="none" stroke="black" d="M398.26,-914C266.85,-914 157.36,-914 157.36,-914 157.36,-914 157.36,-446.7 157.36,-446.7"/>
<polygon fill="black" stroke="black" points="160.86,-446.7 157.36,-436.7 153.86,-446.7 160.86,-446.7"/>
</g>
<!-- L0_S0_TP0_GPU0_expert0 -->
<g id="node17" class="node">
<title>L0_S0_TP0_GPU0_expert0</title>
<polygon fill="none" stroke="black" points="1336.5,-672.5 887.5,-672.5 887.5,-604.5 1336.5,-604.5 1336.5,-672.5"/>
<text text-anchor="middle" x="1112" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="1112" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="1112" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="1112" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L0_S0_TP0_GPU0_gate&#45;&gt;L0_S0_TP0_GPU0_expert0 -->
<g id="edge16" class="edge">
<title>L0_S0_TP0_GPU0_gate&#45;&gt;L0_S0_TP0_GPU0_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1112,-708.31C1112,-708.31 1112,-682.71 1112,-682.71"/>
<polygon fill="black" stroke="black" points="1115.5,-682.71 1112,-672.71 1108.5,-682.71 1115.5,-682.71"/>
</g>
<!-- L0_S0_TP0_GPU0_expert1 -->
<g id="node18" class="node">
<title>L0_S0_TP0_GPU0_expert1</title>
<polygon fill="none" stroke="black" points="1803.5,-672.5 1354.5,-672.5 1354.5,-604.5 1803.5,-604.5 1803.5,-672.5"/>
<text text-anchor="middle" x="1579" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="1579" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="1579" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="1579" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L0_S0_TP0_GPU0_gate&#45;&gt;L0_S0_TP0_GPU0_expert1 -->
<g id="edge17" class="edge">
<title>L0_S0_TP0_GPU0_gate&#45;&gt;L0_S0_TP0_GPU0_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1363.14,-776.4C1363.14,-776.4 1363.14,-682.74 1363.14,-682.74"/>
<polygon fill="black" stroke="black" points="1366.64,-682.74 1363.14,-672.74 1359.64,-682.74 1366.64,-682.74"/>
</g>
<!-- L0_S0_TP0_GPU0_moe_ar -->
<g id="node19" class="node">
<title>L0_S0_TP0_GPU0_moe_ar</title>
<ellipse fill="none" stroke="black" cx="2173" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="2173" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="2173" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="2173" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="2173" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP0_GPU0_expert0&#45;&gt;L0_S0_TP0_GPU0_moe_ar -->
<g id="edge18" class="edge">
<title>L0_S0_TP0_GPU0_expert0&#45;&gt;L0_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M1286.61,-604.22C1286.61,-569.23 1286.61,-520 1286.61,-520 1286.61,-520 1828.53,-520 1828.53,-520"/>
<polygon fill="black" stroke="black" points="1828.53,-523.5 1838.53,-520 1828.53,-516.5 1828.53,-523.5"/>
</g>
<!-- L0_S0_TP1_GPU1_moe_ar -->
<g id="node43" class="node">
<title>L0_S0_TP1_GPU1_moe_ar</title>
<ellipse fill="none" stroke="black" cx="2860" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="2860" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="2860" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="2860" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="2860" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP0_GPU0_expert0&#45;&gt;L0_S0_TP1_GPU1_moe_ar -->
<g id="edge54" class="edge">
<title>L0_S0_TP0_GPU0_expert0&#45;&gt;L0_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M1186.83,-604.23C1186.83,-598.83 1186.83,-595 1186.83,-595 1186.83,-595 2549.09,-595 2549.09,-595 2549.09,-595 2549.09,-548.47 2549.09,-548.47"/>
<polygon fill="black" stroke="black" points="2552.59,-548.47 2549.09,-538.47 2545.59,-548.47 2552.59,-548.47"/>
</g>
<!-- L0_S0_TP2_GPU2_moe_ar -->
<g id="node53" class="node">
<title>L0_S0_TP2_GPU2_moe_ar</title>
<ellipse fill="none" stroke="black" cx="3547" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="3547" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="3547" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="3547" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="3547" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP0_GPU0_expert0&#45;&gt;L0_S0_TP2_GPU2_moe_ar -->
<g id="edge90" class="edge">
<title>L0_S0_TP0_GPU0_expert0&#45;&gt;L0_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M1236.72,-604.19C1236.72,-599.36 1236.72,-596 1236.72,-596 1236.72,-596 3286.64,-596 3286.64,-596 3286.64,-596 3286.64,-560.72 3286.64,-560.72"/>
<polygon fill="black" stroke="black" points="3290.14,-560.72 3286.64,-550.72 3283.14,-560.72 3290.14,-560.72"/>
</g>
<!-- L0_S0_TP3_GPU3_moe_ar -->
<g id="node63" class="node">
<title>L0_S0_TP3_GPU3_moe_ar</title>
<ellipse fill="none" stroke="black" cx="4234" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4234" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="4234" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="4234" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4234" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP0_GPU0_expert0&#45;&gt;L0_S0_TP3_GPU3_moe_ar -->
<g id="edge126" class="edge">
<title>L0_S0_TP0_GPU0_expert0&#45;&gt;L0_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M1136.94,-604.4C1136.94,-555.17 1136.94,-470 1136.94,-470 1136.94,-470 4011.03,-470 4011.03,-470 4011.03,-470 4011.03,-474.31 4011.03,-474.31"/>
<polygon fill="black" stroke="black" points="4007.53,-474.31 4011.03,-484.31 4014.53,-474.31 4007.53,-474.31"/>
</g>
<!-- L0_S0_TP4_GPU4_moe_ar -->
<g id="node73" class="node">
<title>L0_S0_TP4_GPU4_moe_ar</title>
<ellipse fill="none" stroke="black" cx="4921" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="4921" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="4921" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="4921" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4921" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP0_GPU0_expert0&#45;&gt;L0_S0_TP4_GPU4_moe_ar -->
<g id="edge162" class="edge">
<title>L0_S0_TP0_GPU0_expert0&#45;&gt;L0_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M1087.06,-604.4C1087.06,-555.17 1087.06,-470 1087.06,-470 1087.06,-470 4921,-470 4921,-470 4921,-470 4921,-470.22 4921,-470.22"/>
<polygon fill="black" stroke="black" points="4917.5,-462.17 4921,-472.17 4924.5,-462.17 4917.5,-462.17"/>
</g>
<!-- L0_S0_TP5_GPU5_moe_ar -->
<g id="node83" class="node">
<title>L0_S0_TP5_GPU5_moe_ar</title>
<ellipse fill="none" stroke="black" cx="5608" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="5608" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="5608" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="5608" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5608" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP0_GPU0_expert0&#45;&gt;L0_S0_TP5_GPU5_moe_ar -->
<g id="edge198" class="edge">
<title>L0_S0_TP0_GPU0_expert0&#45;&gt;L0_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M1037.17,-604.17C1037.17,-551.31 1037.17,-456 1037.17,-456 1037.17,-456 5369.11,-456 5369.11,-456 5369.11,-456 5369.11,-476.7 5369.11,-476.7"/>
<polygon fill="black" stroke="black" points="5365.61,-476.7 5369.11,-486.7 5372.61,-476.7 5365.61,-476.7"/>
</g>
<!-- L0_S0_TP6_GPU6_moe_ar -->
<g id="node93" class="node">
<title>L0_S0_TP6_GPU6_moe_ar</title>
<ellipse fill="none" stroke="black" cx="6295" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6295" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="6295" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="6295" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6295" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP0_GPU0_expert0&#45;&gt;L0_S0_TP6_GPU6_moe_ar -->
<g id="edge234" class="edge">
<title>L0_S0_TP0_GPU0_expert0&#45;&gt;L0_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M987.28,-604.41C987.28,-551.35 987.28,-455 987.28,-455 987.28,-455 6128.85,-455 6128.85,-455 6128.85,-455 6128.85,-468.62 6128.85,-468.62"/>
<polygon fill="black" stroke="black" points="6125.35,-468.62 6128.85,-478.62 6132.35,-468.62 6125.35,-468.62"/>
</g>
<!-- L0_S0_TP7_GPU7_moe_ar -->
<g id="node103" class="node">
<title>L0_S0_TP7_GPU7_moe_ar</title>
<ellipse fill="none" stroke="black" cx="6982" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6982" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="6982" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="6982" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6982" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP0_GPU0_expert0&#45;&gt;L0_S0_TP7_GPU7_moe_ar -->
<g id="edge270" class="edge">
<title>L0_S0_TP0_GPU0_expert0&#45;&gt;L0_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M937.39,-604.41C937.39,-551.35 937.39,-455 937.39,-455 937.39,-455 6985.38,-455 6985.38,-455 6985.38,-455 6985.38,-462.19 6985.38,-462.19"/>
<polygon fill="black" stroke="black" points="6981.88,-462.19 6985.38,-472.19 6988.88,-462.19 6981.88,-462.19"/>
</g>
<!-- L0_S0_TP0_GPU0_expert1&#45;&gt;L0_S0_TP0_GPU0_moe_ar -->
<g id="edge19" class="edge">
<title>L0_S0_TP0_GPU0_expert1&#45;&gt;L0_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M1771.06,-604.38C1771.06,-577.31 1771.06,-544 1771.06,-544 1771.06,-544 1871.43,-544 1871.43,-544"/>
<polygon fill="black" stroke="black" points="1871.43,-547.5 1881.43,-544 1871.43,-540.5 1871.43,-547.5"/>
</g>
<!-- L0_S0_TP0_GPU0_expert1&#45;&gt;L0_S0_TP1_GPU1_moe_ar -->
<g id="edge55" class="edge">
<title>L0_S0_TP0_GPU0_expert1&#45;&gt;L0_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M1576.44,-604.23C1576.44,-598.83 1576.44,-595 1576.44,-595 1576.44,-595 2572.64,-595 2572.64,-595 2572.64,-595 2572.64,-555.25 2572.64,-555.25"/>
<polygon fill="black" stroke="black" points="2576.14,-555.25 2572.64,-545.25 2569.14,-555.25 2576.14,-555.25"/>
</g>
<!-- L0_S0_TP0_GPU0_expert1&#45;&gt;L0_S0_TP2_GPU2_moe_ar -->
<g id="edge91" class="edge">
<title>L0_S0_TP0_GPU0_expert1&#45;&gt;L0_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M1596.86,-672.77C1596.86,-685.99 1596.86,-698 1596.86,-698 1596.86,-698 3220.51,-698 3220.51,-698 3220.51,-698 3220.51,-540.99 3220.51,-540.99"/>
<polygon fill="black" stroke="black" points="3224.01,-540.99 3220.51,-530.99 3217.01,-540.99 3224.01,-540.99"/>
</g>
<!-- L0_S0_TP0_GPU0_expert1&#45;&gt;L0_S0_TP3_GPU3_moe_ar -->
<g id="edge127" class="edge">
<title>L0_S0_TP0_GPU0_expert1&#45;&gt;L0_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M1608.88,-604.23C1608.88,-598.83 1608.88,-595 1608.88,-595 1608.88,-595 3923.43,-595 3923.43,-595 3923.43,-595 3923.43,-548.47 3923.43,-548.47"/>
<polygon fill="black" stroke="black" points="3926.93,-548.47 3923.43,-538.47 3919.93,-548.47 3926.93,-548.47"/>
</g>
<!-- L0_S0_TP0_GPU0_expert1&#45;&gt;L0_S0_TP4_GPU4_moe_ar -->
<g id="edge163" class="edge">
<title>L0_S0_TP0_GPU0_expert1&#45;&gt;L0_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M1738.62,-604.4C1738.62,-555.69 1738.62,-472 1738.62,-472 1738.62,-472 4753.77,-472 4753.77,-472 4753.77,-472 4753.77,-472.67 4753.77,-472.67"/>
<polygon fill="black" stroke="black" points="4750.27,-468.73 4753.77,-478.73 4757.27,-468.73 4750.27,-468.73"/>
</g>
<!-- L0_S0_TP0_GPU0_expert1&#45;&gt;L0_S0_TP5_GPU5_moe_ar -->
<g id="edge199" class="edge">
<title>L0_S0_TP0_GPU0_expert1&#45;&gt;L0_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M1706.19,-604.17C1706.19,-551.31 1706.19,-456 1706.19,-456 1706.19,-456 5345.22,-456 5345.22,-456 5345.22,-456 5345.22,-480.47 5345.22,-480.47"/>
<polygon fill="black" stroke="black" points="5341.72,-480.47 5345.22,-490.47 5348.72,-480.47 5341.72,-480.47"/>
</g>
<!-- L0_S0_TP0_GPU0_expert1&#45;&gt;L0_S0_TP6_GPU6_moe_ar -->
<g id="edge235" class="edge">
<title>L0_S0_TP0_GPU0_expert1&#45;&gt;L0_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M1673.75,-604.17C1673.75,-551.31 1673.75,-456 1673.75,-456 1673.75,-456 6044.69,-456 6044.69,-456 6044.69,-456 6044.69,-478.21 6044.69,-478.21"/>
<polygon fill="black" stroke="black" points="6041.19,-478.21 6044.69,-488.21 6048.19,-478.21 6041.19,-478.21"/>
</g>
<!-- L0_S0_TP0_GPU0_expert1&#45;&gt;L0_S0_TP7_GPU7_moe_ar -->
<g id="edge271" class="edge">
<title>L0_S0_TP0_GPU0_expert1&#45;&gt;L0_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M1641.31,-604.39C1641.31,-604.13 1641.31,-604 1641.31,-604 1641.31,-604 6949.5,-604 6949.5,-604 6949.5,-604 6949.5,-578.55 6949.5,-578.55"/>
<polygon fill="black" stroke="black" points="6953,-578.55 6949.5,-568.55 6946,-578.55 6953,-578.55"/>
</g>
<!-- L0_S0_TP0_GPU0_moe_ar&#45;&gt;L0_S0_TP0_GPU0_moe_res -->
<g id="edge34" class="edge">
<title>L0_S0_TP0_GPU0_moe_ar&#45;&gt;L0_S0_TP0_GPU0_moe_res</title>
<path fill="none" stroke="black" d="M1884.79,-496C1422.38,-496 566.11,-496 566.11,-496 566.11,-496 566.11,-446.41 566.11,-446.41"/>
<polygon fill="black" stroke="black" points="569.61,-446.41 566.11,-436.41 562.61,-446.41 569.61,-446.41"/>
</g>
<!-- L0_S0_TP1_GPU1_expert0 -->
<g id="node20" class="node">
<title>L0_S0_TP1_GPU1_expert0</title>
<polygon fill="none" stroke="black" points="2270.5,-672.5 1821.5,-672.5 1821.5,-604.5 2270.5,-604.5 2270.5,-672.5"/>
<text text-anchor="middle" x="2046" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="2046" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="2046" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="2046" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L0_S0_TP1_GPU1_expert0&#45;&gt;L0_S0_TP0_GPU0_moe_ar -->
<g id="edge20" class="edge">
<title>L0_S0_TP1_GPU1_expert0&#45;&gt;L0_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M1924.93,-604.34C1924.93,-604.34 1924.93,-562.87 1924.93,-562.87"/>
<polygon fill="black" stroke="black" points="1928.43,-562.87 1924.93,-552.87 1921.43,-562.87 1928.43,-562.87"/>
</g>
<!-- L0_S0_TP1_GPU1_expert0&#45;&gt;L0_S0_TP1_GPU1_moe_ar -->
<g id="edge56" class="edge">
<title>L0_S0_TP1_GPU1_expert0&#45;&gt;L0_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M2011.32,-604.23C2011.32,-598.83 2011.32,-595 2011.32,-595 2011.32,-595 2596.19,-595 2596.19,-595 2596.19,-595 2596.19,-560.32 2596.19,-560.32"/>
<polygon fill="black" stroke="black" points="2599.69,-560.32 2596.19,-550.32 2592.69,-560.32 2599.69,-560.32"/>
</g>
<!-- L0_S0_TP1_GPU1_expert0&#45;&gt;L0_S0_TP2_GPU2_moe_ar -->
<g id="edge92" class="edge">
<title>L0_S0_TP1_GPU1_expert0&#45;&gt;L0_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M2195.67,-672.77C2195.67,-685.99 2195.67,-698 2195.67,-698 2195.67,-698 3218.52,-698 3218.52,-698 3218.52,-698 3218.52,-539.47 3218.52,-539.47"/>
<polygon fill="black" stroke="black" points="3222.02,-539.47 3218.52,-529.47 3215.02,-539.47 3222.02,-539.47"/>
</g>
<!-- L0_S0_TP1_GPU1_expert0&#45;&gt;L0_S0_TP3_GPU3_moe_ar -->
<g id="edge128" class="edge">
<title>L0_S0_TP1_GPU1_expert0&#45;&gt;L0_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M2097.72,-604.19C2097.72,-599.36 2097.72,-596 2097.72,-596 2097.72,-596 3947.33,-596 3947.33,-596 3947.33,-596 3947.33,-555.58 3947.33,-555.58"/>
<polygon fill="black" stroke="black" points="3950.83,-555.58 3947.33,-545.58 3943.83,-555.58 3950.83,-555.58"/>
</g>
<!-- L0_S0_TP1_GPU1_expert0&#45;&gt;L0_S0_TP4_GPU4_moe_ar -->
<g id="edge164" class="edge">
<title>L0_S0_TP1_GPU1_expert0&#45;&gt;L0_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M2120.83,-672.85C2120.83,-687.81 2120.83,-702 2120.83,-702 2120.83,-702 4613.78,-702 4613.78,-702 4613.78,-702 4613.78,-549.51 4613.78,-549.51"/>
<polygon fill="black" stroke="black" points="4617.28,-549.51 4613.78,-539.51 4610.28,-549.51 4617.28,-549.51"/>
</g>
<!-- L0_S0_TP1_GPU1_expert0&#45;&gt;L0_S0_TP5_GPU5_moe_ar -->
<g id="edge200" class="edge">
<title>L0_S0_TP1_GPU1_expert0&#45;&gt;L0_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M2046,-672.53C2046,-688.89 2046,-705 2046,-705 2046,-705 5548.5,-705 5548.5,-705 5548.5,-705 5548.5,-577.95 5548.5,-577.95"/>
<polygon fill="black" stroke="black" points="5552,-577.95 5548.5,-567.95 5545,-577.95 5552,-577.95"/>
</g>
<!-- L0_S0_TP1_GPU1_expert0&#45;&gt;L0_S0_TP6_GPU6_moe_ar -->
<g id="edge236" class="edge">
<title>L0_S0_TP1_GPU1_expert0&#45;&gt;L0_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M1971.17,-672.75C1971.17,-689.87 1971.17,-707 1971.17,-707 1971.17,-707 6020,-707 6020,-707 6020,-707 6020,-557.95 6020,-557.95"/>
<polygon fill="black" stroke="black" points="6023.5,-557.95 6020,-547.95 6016.5,-557.95 6023.5,-557.95"/>
</g>
<!-- L0_S0_TP1_GPU1_expert0&#45;&gt;L0_S0_TP7_GPU7_moe_ar -->
<g id="edge272" class="edge">
<title>L0_S0_TP1_GPU1_expert0&#45;&gt;L0_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M2184.11,-604.23C2184.11,-598.83 2184.11,-595 2184.11,-595 2184.11,-595 6674.17,-595 6674.17,-595 6674.17,-595 6674.17,-549.24 6674.17,-549.24"/>
<polygon fill="black" stroke="black" points="6677.67,-549.24 6674.17,-539.24 6670.67,-549.24 6677.67,-549.24"/>
</g>
<!-- L0_S0_TP1_GPU1_expert1 -->
<g id="node21" class="node">
<title>L0_S0_TP1_GPU1_expert1</title>
<polygon fill="none" stroke="black" points="2737.5,-672.5 2288.5,-672.5 2288.5,-604.5 2737.5,-604.5 2737.5,-672.5"/>
<text text-anchor="middle" x="2513" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="2513" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="2513" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="2513" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L0_S0_TP1_GPU1_expert1&#45;&gt;L0_S0_TP0_GPU0_moe_ar -->
<g id="edge21" class="edge">
<title>L0_S0_TP1_GPU1_expert1&#45;&gt;L0_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M2310.4,-604.34C2310.4,-604.34 2310.4,-574.62 2310.4,-574.62"/>
<polygon fill="black" stroke="black" points="2313.9,-574.62 2310.4,-564.62 2306.9,-574.62 2313.9,-574.62"/>
</g>
<!-- L0_S0_TP1_GPU1_expert1&#45;&gt;L0_S0_TP1_GPU1_moe_ar -->
<g id="edge57" class="edge">
<title>L0_S0_TP1_GPU1_expert1&#45;&gt;L0_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M2619.74,-604.34C2619.74,-604.34 2619.74,-564.09 2619.74,-564.09"/>
<polygon fill="black" stroke="black" points="2623.24,-564.09 2619.74,-554.09 2616.24,-564.09 2623.24,-564.09"/>
</g>
<!-- L0_S0_TP1_GPU1_expert1&#45;&gt;L0_S0_TP2_GPU2_moe_ar -->
<g id="edge93" class="edge">
<title>L0_S0_TP1_GPU1_expert1&#45;&gt;L0_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M2666.85,-604.23C2666.85,-598.83 2666.85,-595 2666.85,-595 2666.85,-595 3214.53,-595 3214.53,-595 3214.53,-595 3214.53,-535.78 3214.53,-535.78"/>
<polygon fill="black" stroke="black" points="3218.03,-535.78 3214.53,-525.78 3211.03,-535.78 3218.03,-535.78"/>
</g>
<!-- L0_S0_TP1_GPU1_expert1&#45;&gt;L0_S0_TP3_GPU3_moe_ar -->
<g id="edge129" class="edge">
<title>L0_S0_TP1_GPU1_expert1&#45;&gt;L0_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M2690.4,-604.19C2690.4,-599.36 2690.4,-596 2690.4,-596 2690.4,-596 3971.23,-596 3971.23,-596 3971.23,-596 3971.23,-560.29 3971.23,-560.29"/>
<polygon fill="black" stroke="black" points="3974.73,-560.29 3971.23,-550.29 3967.73,-560.29 3974.73,-560.29"/>
</g>
<!-- L0_S0_TP1_GPU1_expert1&#45;&gt;L0_S0_TP4_GPU4_moe_ar -->
<g id="edge165" class="edge">
<title>L0_S0_TP1_GPU1_expert1&#45;&gt;L0_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M2647.74,-672.64C2647.74,-686.36 2647.74,-699 2647.74,-699 2647.74,-699 4611.83,-699 4611.83,-699 4611.83,-699 4611.83,-548.86 4611.83,-548.86"/>
<polygon fill="black" stroke="black" points="4615.33,-548.86 4611.83,-538.86 4608.33,-548.86 4615.33,-548.86"/>
</g>
<!-- L0_S0_TP1_GPU1_expert1&#45;&gt;L0_S0_TP5_GPU5_moe_ar -->
<g id="edge201" class="edge">
<title>L0_S0_TP1_GPU1_expert1&#45;&gt;L0_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M2516.5,-604.17C2516.5,-551.31 2516.5,-456 2516.5,-456 2516.5,-456 5321.32,-456 5321.32,-456 5321.32,-456 5321.32,-485.33 5321.32,-485.33"/>
<polygon fill="black" stroke="black" points="5317.82,-485.33 5321.32,-495.33 5324.82,-485.33 5317.82,-485.33"/>
</g>
<!-- L0_S0_TP1_GPU1_expert1&#45;&gt;L0_S0_TP6_GPU6_moe_ar -->
<g id="edge237" class="edge">
<title>L0_S0_TP1_GPU1_expert1&#45;&gt;L0_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M2557.98,-672.65C2557.98,-689.39 2557.98,-706 2557.98,-706 2557.98,-706 6015.5,-706 6015.5,-706 6015.5,-706 6015.5,-557.01 6015.5,-557.01"/>
<polygon fill="black" stroke="black" points="6019,-557.01 6015.5,-547.01 6012,-557.01 6019,-557.01"/>
</g>
<!-- L0_S0_TP1_GPU1_expert1&#45;&gt;L0_S0_TP7_GPU7_moe_ar -->
<g id="edge273" class="edge">
<title>L0_S0_TP1_GPU1_expert1&#45;&gt;L0_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M2713.95,-604.23C2713.95,-598.83 2713.95,-595 2713.95,-595 2713.95,-595 6727.44,-595 6727.44,-595 6727.44,-595 6727.44,-561.61 6727.44,-561.61"/>
<polygon fill="black" stroke="black" points="6730.94,-561.61 6727.44,-551.61 6723.94,-561.61 6730.94,-561.61"/>
</g>
<!-- L0_S0_TP2_GPU2_expert0 -->
<g id="node22" class="node">
<title>L0_S0_TP2_GPU2_expert0</title>
<polygon fill="none" stroke="black" points="3204.5,-672.5 2755.5,-672.5 2755.5,-604.5 3204.5,-604.5 3204.5,-672.5"/>
<text text-anchor="middle" x="2980" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="2980" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="2980" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="2980" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L0_S0_TP2_GPU2_expert0&#45;&gt;L0_S0_TP0_GPU0_moe_ar -->
<g id="edge22" class="edge">
<title>L0_S0_TP2_GPU2_expert0&#45;&gt;L0_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M2799.4,-604.39C2799.4,-604.13 2799.4,-604 2799.4,-604 2799.4,-604 2332.29,-604 2332.29,-604 2332.29,-604 2332.29,-572.7 2332.29,-572.7"/>
<polygon fill="black" stroke="black" points="2335.79,-572.7 2332.29,-562.7 2328.79,-572.7 2335.79,-572.7"/>
</g>
<!-- L0_S0_TP2_GPU2_expert0&#45;&gt;L0_S0_TP1_GPU1_moe_ar -->
<g id="edge58" class="edge">
<title>L0_S0_TP2_GPU2_expert0&#45;&gt;L0_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M2843.29,-604.34C2843.29,-604.34 2843.29,-578.55 2843.29,-578.55"/>
<polygon fill="black" stroke="black" points="2846.79,-578.55 2843.29,-568.55 2839.79,-578.55 2846.79,-578.55"/>
</g>
<!-- L0_S0_TP2_GPU2_expert0&#45;&gt;L0_S0_TP2_GPU2_moe_ar -->
<g id="edge94" class="edge">
<title>L0_S0_TP2_GPU2_expert0&#45;&gt;L0_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M3204.79,-627C3212.23,-627 3216.52,-627 3216.52,-627 3216.52,-627 3216.52,-538.08 3216.52,-538.08"/>
<polygon fill="black" stroke="black" points="3220.02,-538.08 3216.52,-528.08 3213.02,-538.08 3220.02,-538.08"/>
</g>
<!-- L0_S0_TP2_GPU2_expert0&#45;&gt;L0_S0_TP3_GPU3_moe_ar -->
<g id="edge130" class="edge">
<title>L0_S0_TP2_GPU2_expert0&#45;&gt;L0_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M3201.15,-604.19C3201.15,-599.36 3201.15,-596 3201.15,-596 3201.15,-596 3995.12,-596 3995.12,-596 3995.12,-596 3995.12,-564.23 3995.12,-564.23"/>
<polygon fill="black" stroke="black" points="3998.62,-564.23 3995.12,-554.23 3991.62,-564.23 3998.62,-564.23"/>
</g>
<!-- L0_S0_TP2_GPU2_expert0&#45;&gt;L0_S0_TP4_GPU4_moe_ar -->
<g id="edge166" class="edge">
<title>L0_S0_TP2_GPU2_expert0&#45;&gt;L0_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M3054.83,-672.77C3054.83,-685.99 3054.83,-698 3054.83,-698 3054.83,-698 4609.89,-698 4609.89,-698 4609.89,-698 4609.89,-548.09 4609.89,-548.09"/>
<polygon fill="black" stroke="black" points="4613.39,-548.09 4609.89,-538.09 4606.39,-548.09 4613.39,-548.09"/>
</g>
<!-- L0_S0_TP2_GPU2_expert0&#45;&gt;L0_S0_TP5_GPU5_moe_ar -->
<g id="edge202" class="edge">
<title>L0_S0_TP2_GPU2_expert0&#45;&gt;L0_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M3197.81,-604.47C3197.81,-553.18 3197.81,-462 3197.81,-462 3197.81,-462 5297.43,-462 5297.43,-462 5297.43,-462 5297.43,-492.25 5297.43,-492.25"/>
<polygon fill="black" stroke="black" points="5293.93,-492.25 5297.43,-502.25 5300.93,-492.25 5293.93,-492.25"/>
</g>
<!-- L0_S0_TP2_GPU2_expert0&#45;&gt;L0_S0_TP6_GPU6_moe_ar -->
<g id="edge238" class="edge">
<title>L0_S0_TP2_GPU2_expert0&#45;&gt;L0_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M2887.19,-604.23C2887.19,-598.83 2887.19,-595 2887.19,-595 2887.19,-595 5966.28,-595 5966.28,-595 5966.28,-595 5966.28,-539.56 5966.28,-539.56"/>
<polygon fill="black" stroke="black" points="5969.78,-539.56 5966.28,-529.56 5962.78,-539.56 5969.78,-539.56"/>
</g>
<!-- L0_S0_TP2_GPU2_expert0&#45;&gt;L0_S0_TP7_GPU7_moe_ar -->
<g id="edge274" class="edge">
<title>L0_S0_TP2_GPU2_expert0&#45;&gt;L0_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M2931.08,-604.19C2931.08,-599.36 2931.08,-596 2931.08,-596 2931.08,-596 6754.07,-596 6754.07,-596 6754.07,-596 6754.07,-565.99 6754.07,-565.99"/>
<polygon fill="black" stroke="black" points="6757.57,-565.99 6754.07,-555.99 6750.57,-565.99 6757.57,-565.99"/>
</g>
<!-- L0_S0_TP2_GPU2_expert1 -->
<g id="node23" class="node">
<title>L0_S0_TP2_GPU2_expert1</title>
<polygon fill="none" stroke="black" points="3671.5,-672.5 3222.5,-672.5 3222.5,-604.5 3671.5,-604.5 3671.5,-672.5"/>
<text text-anchor="middle" x="3447" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="3447" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="3447" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="3447" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L0_S0_TP2_GPU2_expert1&#45;&gt;L0_S0_TP0_GPU0_moe_ar -->
<g id="edge23" class="edge">
<title>L0_S0_TP2_GPU2_expert1&#45;&gt;L0_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M3350.79,-604.19C3350.79,-599.36 3350.79,-596 3350.79,-596 3350.79,-596 2354.19,-596 2354.19,-596 2354.19,-596 2354.19,-570.86 2354.19,-570.86"/>
<polygon fill="black" stroke="black" points="2357.69,-570.86 2354.19,-560.86 2350.69,-570.86 2357.69,-570.86"/>
</g>
<!-- L0_S0_TP2_GPU2_expert1&#45;&gt;L0_S0_TP1_GPU1_moe_ar -->
<g id="edge59" class="edge">
<title>L0_S0_TP2_GPU2_expert1&#45;&gt;L0_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M3222.18,-649C3212.75,-649 3207.18,-649 3207.18,-649 3207.18,-649 3207.18,-520 3207.18,-520 3207.18,-520 3204.82,-520 3204.82,-520"/>
<polygon fill="black" stroke="black" points="3204.82,-516.5 3194.82,-520 3204.82,-523.5 3204.82,-516.5"/>
</g>
<!-- L0_S0_TP2_GPU2_expert1&#45;&gt;L0_S0_TP2_GPU2_moe_ar -->
<g id="edge95" class="edge">
<title>L0_S0_TP2_GPU2_expert1&#45;&gt;L0_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M3414.93,-604.34C3414.93,-604.34 3414.93,-574.62 3414.93,-574.62"/>
<polygon fill="black" stroke="black" points="3418.43,-574.62 3414.93,-564.62 3411.43,-574.62 3418.43,-574.62"/>
</g>
<!-- L0_S0_TP2_GPU2_expert1&#45;&gt;L0_S0_TP3_GPU3_moe_ar -->
<g id="edge131" class="edge">
<title>L0_S0_TP2_GPU2_expert1&#45;&gt;L0_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M3479.07,-604.19C3479.07,-599.36 3479.07,-596 3479.07,-596 3479.07,-596 4019.02,-596 4019.02,-596 4019.02,-596 4019.02,-567.32 4019.02,-567.32"/>
<polygon fill="black" stroke="black" points="4022.52,-567.32 4019.02,-557.32 4015.52,-567.32 4022.52,-567.32"/>
</g>
<!-- L0_S0_TP2_GPU2_expert1&#45;&gt;L0_S0_TP4_GPU4_moe_ar -->
<g id="edge167" class="edge">
<title>L0_S0_TP2_GPU2_expert1&#45;&gt;L0_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M3629.74,-672.77C3629.74,-685.99 3629.74,-698 3629.74,-698 3629.74,-698 4607.94,-698 4607.94,-698 4607.94,-698 4607.94,-547.44 4607.94,-547.44"/>
<polygon fill="black" stroke="black" points="4611.44,-547.44 4607.94,-537.44 4604.44,-547.44 4611.44,-547.44"/>
</g>
<!-- L0_S0_TP2_GPU2_expert1&#45;&gt;L0_S0_TP5_GPU5_moe_ar -->
<g id="edge203" class="edge">
<title>L0_S0_TP2_GPU2_expert1&#45;&gt;L0_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M3543.21,-604.19C3543.21,-599.36 3543.21,-596 3543.21,-596 3543.21,-596 5306.78,-596 5306.78,-596 5306.78,-596 5306.78,-551.47 5306.78,-551.47"/>
<polygon fill="black" stroke="black" points="5310.28,-551.47 5306.78,-541.47 5303.28,-551.47 5310.28,-551.47"/>
</g>
<!-- L0_S0_TP2_GPU2_expert1&#45;&gt;L0_S0_TP6_GPU6_moe_ar -->
<g id="edge239" class="edge">
<title>L0_S0_TP2_GPU2_expert1&#45;&gt;L0_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M3587.98,-672.85C3587.98,-687.81 3587.98,-702 3587.98,-702 3587.98,-702 6011,-702 6011,-702 6011,-702 6011,-556.05 6011,-556.05"/>
<polygon fill="black" stroke="black" points="6014.5,-556.05 6011,-546.05 6007.5,-556.05 6014.5,-556.05"/>
</g>
<!-- L0_S0_TP2_GPU2_expert1&#45;&gt;L0_S0_TP7_GPU7_moe_ar -->
<g id="edge275" class="edge">
<title>L0_S0_TP2_GPU2_expert1&#45;&gt;L0_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M3607.36,-604.42C3607.36,-601.71 3607.36,-600 3607.36,-600 3607.36,-600 6780.7,-600 6780.7,-600 6780.7,-600 6780.7,-569.28 6780.7,-569.28"/>
<polygon fill="black" stroke="black" points="6784.2,-569.28 6780.7,-559.28 6777.2,-569.28 6784.2,-569.28"/>
</g>
<!-- L0_S0_TP3_GPU3_expert0 -->
<g id="node24" class="node">
<title>L0_S0_TP3_GPU3_expert0</title>
<polygon fill="none" stroke="black" points="4138.5,-672.5 3689.5,-672.5 3689.5,-604.5 4138.5,-604.5 4138.5,-672.5"/>
<text text-anchor="middle" x="3914" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="3914" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="3914" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="3914" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L0_S0_TP3_GPU3_expert0&#45;&gt;L0_S0_TP0_GPU0_moe_ar -->
<g id="edge24" class="edge">
<title>L0_S0_TP3_GPU3_expert0&#45;&gt;L0_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M3710.83,-604.19C3710.83,-599.36 3710.83,-596 3710.83,-596 3710.83,-596 2376.08,-596 2376.08,-596 2376.08,-596 2376.08,-568.65 2376.08,-568.65"/>
<polygon fill="black" stroke="black" points="2379.58,-568.65 2376.08,-558.65 2372.58,-568.65 2379.58,-568.65"/>
</g>
<!-- L0_S0_TP3_GPU3_expert0&#45;&gt;L0_S0_TP1_GPU1_moe_ar -->
<g id="edge60" class="edge">
<title>L0_S0_TP3_GPU3_expert0&#45;&gt;L0_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M3732.16,-604.19C3732.16,-599.36 3732.16,-596 3732.16,-596 3732.16,-596 2974.98,-596 2974.98,-596 2974.98,-596 2974.98,-575.69 2974.98,-575.69"/>
<polygon fill="black" stroke="black" points="2978.48,-575.69 2974.98,-565.69 2971.48,-575.69 2978.48,-575.69"/>
</g>
<!-- L0_S0_TP3_GPU3_expert0&#45;&gt;L0_S0_TP2_GPU2_moe_ar -->
<g id="edge96" class="edge">
<title>L0_S0_TP3_GPU3_expert0&#45;&gt;L0_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M3753.49,-604.34C3753.49,-604.34 3753.49,-568.64 3753.49,-568.64"/>
<polygon fill="black" stroke="black" points="3756.99,-568.64 3753.49,-558.64 3749.99,-568.64 3756.99,-568.64"/>
</g>
<!-- L0_S0_TP3_GPU3_expert0&#45;&gt;L0_S0_TP3_GPU3_moe_ar -->
<g id="edge132" class="edge">
<title>L0_S0_TP3_GPU3_expert0&#45;&gt;L0_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M4042.92,-604.34C4042.92,-604.34 4042.92,-569.91 4042.92,-569.91"/>
<polygon fill="black" stroke="black" points="4046.42,-569.91 4042.92,-559.91 4039.42,-569.91 4046.42,-569.91"/>
</g>
<!-- L0_S0_TP3_GPU3_expert0&#45;&gt;L0_S0_TP4_GPU4_moe_ar -->
<g id="edge168" class="edge">
<title>L0_S0_TP3_GPU3_expert0&#45;&gt;L0_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M4066.81,-604.19C4066.81,-599.36 4066.81,-596 4066.81,-596 4066.81,-596 4591.28,-596 4591.28,-596 4591.28,-596 4591.28,-538.51 4591.28,-538.51"/>
<polygon fill="black" stroke="black" points="4594.78,-538.51 4591.28,-528.51 4587.78,-538.51 4594.78,-538.51"/>
</g>
<!-- L0_S0_TP3_GPU3_expert0&#45;&gt;L0_S0_TP5_GPU5_moe_ar -->
<g id="edge204" class="edge">
<title>L0_S0_TP3_GPU3_expert0&#45;&gt;L0_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M4090.71,-604.19C4090.71,-599.36 4090.71,-596 4090.71,-596 4090.71,-596 5340.03,-596 5340.03,-596 5340.03,-596 5340.03,-559.42 5340.03,-559.42"/>
<polygon fill="black" stroke="black" points="5343.53,-559.42 5340.03,-549.42 5336.53,-559.42 5343.53,-559.42"/>
</g>
<!-- L0_S0_TP3_GPU3_expert0&#45;&gt;L0_S0_TP6_GPU6_moe_ar -->
<g id="edge240" class="edge">
<title>L0_S0_TP3_GPU3_expert0&#45;&gt;L0_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M4114.6,-604.19C4114.6,-599.36 4114.6,-596 4114.6,-596 4114.6,-596 5972.03,-596 5972.03,-596 5972.03,-596 5972.03,-543.24 5972.03,-543.24"/>
<polygon fill="black" stroke="black" points="5975.53,-543.24 5972.03,-533.24 5968.53,-543.24 5975.53,-543.24"/>
</g>
<!-- L0_S0_TP3_GPU3_expert0&#45;&gt;L0_S0_TP7_GPU7_moe_ar -->
<g id="edge276" class="edge">
<title>L0_S0_TP3_GPU3_expert0&#45;&gt;L0_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M3890.5,-604.08C3890.5,-552.21 3890.5,-460 3890.5,-460 3890.5,-460 6872.77,-460 6872.77,-460 6872.77,-460 6872.77,-464.93 6872.77,-464.93"/>
<polygon fill="black" stroke="black" points="6869.27,-464.93 6872.77,-474.93 6876.27,-464.93 6869.27,-464.93"/>
</g>
<!-- L0_S0_TP3_GPU3_expert1 -->
<g id="node25" class="node">
<title>L0_S0_TP3_GPU3_expert1</title>
<polygon fill="none" stroke="black" points="4605.5,-672.5 4156.5,-672.5 4156.5,-604.5 4605.5,-604.5 4605.5,-672.5"/>
<text text-anchor="middle" x="4381" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="4381" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4381" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4381" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L0_S0_TP3_GPU3_expert1&#45;&gt;L0_S0_TP0_GPU0_moe_ar -->
<g id="edge25" class="edge">
<title>L0_S0_TP3_GPU3_expert1&#45;&gt;L0_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M4197.7,-604.19C4197.7,-599.36 4197.7,-596 4197.7,-596 4197.7,-596 2397.98,-596 2397.98,-596 2397.98,-596 2397.98,-566.44 2397.98,-566.44"/>
<polygon fill="black" stroke="black" points="2401.48,-566.44 2397.98,-556.44 2394.48,-566.44 2401.48,-566.44"/>
</g>
<!-- L0_S0_TP3_GPU3_expert1&#45;&gt;L0_S0_TP1_GPU1_moe_ar -->
<g id="edge61" class="edge">
<title>L0_S0_TP3_GPU3_expert1&#45;&gt;L0_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M4238.89,-604.19C4238.89,-599.36 4238.89,-596 4238.89,-596 4238.89,-596 3018.88,-596 3018.88,-596 3018.88,-596 3018.88,-573.07 3018.88,-573.07"/>
<polygon fill="black" stroke="black" points="3022.38,-573.07 3018.88,-563.07 3015.38,-573.07 3022.38,-573.07"/>
</g>
<!-- L0_S0_TP3_GPU3_expert1&#45;&gt;L0_S0_TP2_GPU2_moe_ar -->
<g id="edge97" class="edge">
<title>L0_S0_TP3_GPU3_expert1&#45;&gt;L0_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M4280.09,-604.23C4280.09,-598.83 4280.09,-595 4280.09,-595 4280.09,-595 3774.82,-595 3774.82,-595 3774.82,-595 3774.82,-565.96 3774.82,-565.96"/>
<polygon fill="black" stroke="black" points="3778.32,-565.96 3774.82,-555.96 3771.32,-565.96 3778.32,-565.96"/>
</g>
<!-- L0_S0_TP3_GPU3_expert1&#45;&gt;L0_S0_TP3_GPU3_moe_ar -->
<g id="edge133" class="edge">
<title>L0_S0_TP3_GPU3_expert1&#45;&gt;L0_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M4321.28,-604.34C4321.28,-604.34 4321.28,-577.23 4321.28,-577.23"/>
<polygon fill="black" stroke="black" points="4324.78,-577.23 4321.28,-567.23 4317.78,-577.23 4324.78,-577.23"/>
</g>
<!-- L0_S0_TP3_GPU3_expert1&#45;&gt;L0_S0_TP4_GPU4_moe_ar -->
<g id="edge169" class="edge">
<title>L0_S0_TP3_GPU3_expert1&#45;&gt;L0_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M4596.02,-604.34C4596.02,-604.34 4596.02,-542.01 4596.02,-542.01"/>
<polygon fill="black" stroke="black" points="4599.52,-542.01 4596.02,-532.01 4592.52,-542.01 4599.52,-542.01"/>
</g>
<!-- L0_S0_TP3_GPU3_expert1&#45;&gt;L0_S0_TP5_GPU5_moe_ar -->
<g id="edge205" class="edge">
<title>L0_S0_TP3_GPU3_expert1&#45;&gt;L0_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M4600.76,-604.42C4600.76,-601.71 4600.76,-600 4600.76,-600 4600.76,-600 5373.27,-600 5373.27,-600 5373.27,-600 5373.27,-565.09 5373.27,-565.09"/>
<polygon fill="black" stroke="black" points="5376.77,-565.09 5373.27,-555.09 5369.77,-565.09 5376.77,-565.09"/>
</g>
<!-- L0_S0_TP3_GPU3_expert1&#45;&gt;L0_S0_TP6_GPU6_moe_ar -->
<g id="edge241" class="edge">
<title>L0_S0_TP3_GPU3_expert1&#45;&gt;L0_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M4362.48,-604.19C4362.48,-599.36 4362.48,-596 4362.48,-596 4362.48,-596 5977.77,-596 5977.77,-596 5977.77,-596 5977.77,-545.71 5977.77,-545.71"/>
<polygon fill="black" stroke="black" points="5981.27,-545.71 5977.77,-535.71 5974.27,-545.71 5981.27,-545.71"/>
</g>
<!-- L0_S0_TP3_GPU3_expert1&#45;&gt;L0_S0_TP7_GPU7_moe_ar -->
<g id="edge277" class="edge">
<title>L0_S0_TP3_GPU3_expert1&#45;&gt;L0_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M4574.85,-604.28C4574.85,-552.7 4574.85,-461 4574.85,-461 4574.85,-461 6760.15,-461 6760.15,-461 6760.15,-461 6760.15,-474.14 6760.15,-474.14"/>
<polygon fill="black" stroke="black" points="6756.65,-474.14 6760.15,-484.14 6763.65,-474.14 6756.65,-474.14"/>
</g>
<!-- L0_S0_TP4_GPU4_expert0 -->
<g id="node26" class="node">
<title>L0_S0_TP4_GPU4_expert0</title>
<polygon fill="none" stroke="black" points="5072.5,-672.5 4623.5,-672.5 4623.5,-604.5 5072.5,-604.5 5072.5,-672.5"/>
<text text-anchor="middle" x="4848" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="4848" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4848" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4848" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L0_S0_TP4_GPU4_expert0&#45;&gt;L0_S0_TP0_GPU0_moe_ar -->
<g id="edge26" class="edge">
<title>L0_S0_TP4_GPU4_expert0&#45;&gt;L0_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M4773.65,-672.85C4773.65,-686.93 4773.65,-700 4773.65,-700 4773.65,-700 2284,-700 2284,-700 2284,-700 2284,-576.2 2284,-576.2"/>
<polygon fill="black" stroke="black" points="2287.5,-576.2 2284,-566.2 2280.5,-576.2 2287.5,-576.2"/>
</g>
<!-- L0_S0_TP4_GPU4_expert0&#45;&gt;L0_S0_TP1_GPU1_moe_ar -->
<g id="edge62" class="edge">
<title>L0_S0_TP4_GPU4_expert0&#45;&gt;L0_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M4679.62,-604.19C4679.62,-599.36 4679.62,-596 4679.62,-596 4679.62,-596 3062.77,-596 3062.77,-596 3062.77,-596 3062.77,-569.09 3062.77,-569.09"/>
<polygon fill="black" stroke="black" points="3066.27,-569.09 3062.77,-559.09 3059.27,-569.09 3066.27,-569.09"/>
</g>
<!-- L0_S0_TP4_GPU4_expert0&#45;&gt;L0_S0_TP2_GPU2_moe_ar -->
<g id="edge98" class="edge">
<title>L0_S0_TP4_GPU4_expert0&#45;&gt;L0_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M4735.75,-604.23C4735.75,-598.83 4735.75,-595 4735.75,-595 4735.75,-595 3796.15,-595 3796.15,-595 3796.15,-595 3796.15,-562.91 3796.15,-562.91"/>
<polygon fill="black" stroke="black" points="3799.65,-562.91 3796.15,-552.91 3792.65,-562.91 3799.65,-562.91"/>
</g>
<!-- L0_S0_TP4_GPU4_expert0&#45;&gt;L0_S0_TP3_GPU3_moe_ar -->
<g id="edge134" class="edge">
<title>L0_S0_TP4_GPU4_expert0&#45;&gt;L0_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M4791.88,-604.19C4791.88,-599.36 4791.88,-596 4791.88,-596 4791.88,-596 4403.68,-596 4403.68,-596 4403.68,-596 4403.68,-572.19 4403.68,-572.19"/>
<polygon fill="black" stroke="black" points="4407.18,-572.19 4403.68,-562.19 4400.18,-572.19 4407.18,-572.19"/>
</g>
<!-- L0_S0_TP4_GPU4_expert0&#45;&gt;L0_S0_TP4_GPU4_moe_ar -->
<g id="edge170" class="edge">
<title>L0_S0_TP4_GPU4_expert0&#45;&gt;L0_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M4848,-604.34C4848,-604.34 4848,-577.67 4848,-577.67"/>
<polygon fill="black" stroke="black" points="4851.5,-577.67 4848,-567.67 4844.5,-577.67 4851.5,-577.67"/>
</g>
<!-- L0_S0_TP4_GPU4_expert0&#45;&gt;L0_S0_TP5_GPU5_moe_ar -->
<g id="edge206" class="edge">
<title>L0_S0_TP4_GPU4_expert0&#45;&gt;L0_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M4904.12,-604.42C4904.12,-601.71 4904.12,-600 4904.12,-600 4904.12,-600 5406.52,-600 5406.52,-600 5406.52,-600 5406.52,-568.81 5406.52,-568.81"/>
<polygon fill="black" stroke="black" points="5410.02,-568.81 5406.52,-558.81 5403.02,-568.81 5410.02,-568.81"/>
</g>
<!-- L0_S0_TP4_GPU4_expert0&#45;&gt;L0_S0_TP6_GPU6_moe_ar -->
<g id="edge242" class="edge">
<title>L0_S0_TP4_GPU4_expert0&#45;&gt;L0_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M4960.25,-604.42C4960.25,-601.71 4960.25,-600 4960.25,-600 4960.25,-600 5983.52,-600 5983.52,-600 5983.52,-600 5983.52,-548.08 5983.52,-548.08"/>
<polygon fill="black" stroke="black" points="5987.02,-548.08 5983.52,-538.08 5980.02,-548.08 5987.02,-548.08"/>
</g>
<!-- L0_S0_TP4_GPU4_expert0&#45;&gt;L0_S0_TP7_GPU7_moe_ar -->
<g id="edge278" class="edge">
<title>L0_S0_TP4_GPU4_expert0&#45;&gt;L0_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M5016.38,-604.42C5016.38,-601.71 5016.38,-600 5016.38,-600 5016.38,-600 6807.34,-600 6807.34,-600 6807.34,-600 6807.34,-571.61 6807.34,-571.61"/>
<polygon fill="black" stroke="black" points="6810.84,-571.61 6807.34,-561.61 6803.84,-571.61 6810.84,-571.61"/>
</g>
<!-- L0_S0_TP4_GPU4_expert1 -->
<g id="node27" class="node">
<title>L0_S0_TP4_GPU4_expert1</title>
<polygon fill="none" stroke="black" points="5539.5,-672.5 5090.5,-672.5 5090.5,-604.5 5539.5,-604.5 5539.5,-672.5"/>
<text text-anchor="middle" x="5315" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="5315" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5315" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5315" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L0_S0_TP4_GPU4_expert1&#45;&gt;L0_S0_TP0_GPU0_moe_ar -->
<g id="edge27" class="edge">
<title>L0_S0_TP4_GPU4_expert1&#45;&gt;L0_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M5264.5,-604.17C5264.5,-551.31 5264.5,-456 5264.5,-456 5264.5,-456 2435.73,-456 2435.73,-456 2435.73,-456 2435.73,-480.47 2435.73,-480.47"/>
<polygon fill="black" stroke="black" points="2432.23,-480.47 2435.73,-490.47 2439.23,-480.47 2432.23,-480.47"/>
</g>
<!-- L0_S0_TP4_GPU4_expert1&#45;&gt;L0_S0_TP1_GPU1_moe_ar -->
<g id="edge63" class="edge">
<title>L0_S0_TP4_GPU4_expert1&#45;&gt;L0_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M5259.98,-604.17C5259.98,-551.31 5259.98,-456 5259.98,-456 5259.98,-456 3079.6,-456 3079.6,-456 3079.6,-456 3079.6,-474.07 3079.6,-474.07"/>
<polygon fill="black" stroke="black" points="3076.1,-474.07 3079.6,-484.07 3083.1,-474.07 3076.1,-474.07"/>
</g>
<!-- L0_S0_TP4_GPU4_expert1&#45;&gt;L0_S0_TP2_GPU2_moe_ar -->
<g id="edge99" class="edge">
<title>L0_S0_TP4_GPU4_expert1&#45;&gt;L0_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M5114.07,-604.23C5114.07,-598.83 5114.07,-595 5114.07,-595 5114.07,-595 3817.47,-595 3817.47,-595 3817.47,-595 3817.47,-559.04 3817.47,-559.04"/>
<polygon fill="black" stroke="black" points="3820.97,-559.04 3817.47,-549.04 3813.97,-559.04 3820.97,-559.04"/>
</g>
<!-- L0_S0_TP4_GPU4_expert1&#45;&gt;L0_S0_TP3_GPU3_moe_ar -->
<g id="edge135" class="edge">
<title>L0_S0_TP4_GPU4_expert1&#45;&gt;L0_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M5137.63,-604.19C5137.63,-599.36 5137.63,-596 5137.63,-596 5137.63,-596 4444.87,-596 4444.87,-596 4444.87,-596 4444.87,-567.77 4444.87,-567.77"/>
<polygon fill="black" stroke="black" points="4448.37,-567.77 4444.87,-557.77 4441.37,-567.77 4448.37,-567.77"/>
</g>
<!-- L0_S0_TP4_GPU4_expert1&#45;&gt;L0_S0_TP4_GPU4_moe_ar -->
<g id="edge171" class="edge">
<title>L0_S0_TP4_GPU4_expert1&#45;&gt;L0_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M5161.2,-604.34C5161.2,-604.34 5161.2,-564.09 5161.2,-564.09"/>
<polygon fill="black" stroke="black" points="5164.7,-564.09 5161.2,-554.09 5157.7,-564.09 5164.7,-564.09"/>
</g>
<!-- L0_S0_TP4_GPU4_expert1&#45;&gt;L0_S0_TP5_GPU5_moe_ar -->
<g id="edge207" class="edge">
<title>L0_S0_TP4_GPU4_expert1&#45;&gt;L0_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M5439.76,-604.34C5439.76,-604.34 5439.76,-572.04 5439.76,-572.04"/>
<polygon fill="black" stroke="black" points="5443.26,-572.04 5439.76,-562.04 5436.26,-572.04 5443.26,-572.04"/>
</g>
<!-- L0_S0_TP4_GPU4_expert1&#45;&gt;L0_S0_TP6_GPU6_moe_ar -->
<g id="edge243" class="edge">
<title>L0_S0_TP4_GPU4_expert1&#45;&gt;L0_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M5473.01,-604.42C5473.01,-601.71 5473.01,-600 5473.01,-600 5473.01,-600 5989.26,-600 5989.26,-600 5989.26,-600 5989.26,-550.09 5989.26,-550.09"/>
<polygon fill="black" stroke="black" points="5992.76,-550.09 5989.26,-540.09 5985.76,-550.09 5992.76,-550.09"/>
</g>
<!-- L0_S0_TP4_GPU4_expert1&#45;&gt;L0_S0_TP7_GPU7_moe_ar -->
<g id="edge279" class="edge">
<title>L0_S0_TP4_GPU4_expert1&#45;&gt;L0_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M5506.25,-604.42C5506.25,-601.71 5506.25,-600 5506.25,-600 5506.25,-600 6833.97,-600 6833.97,-600 6833.97,-600 6833.97,-573.93 6833.97,-573.93"/>
<polygon fill="black" stroke="black" points="6837.47,-573.93 6833.97,-563.93 6830.47,-573.93 6837.47,-573.93"/>
</g>
<!-- L0_S0_TP5_GPU5_expert0 -->
<g id="node28" class="node">
<title>L0_S0_TP5_GPU5_expert0</title>
<polygon fill="none" stroke="black" points="6006.5,-672.5 5557.5,-672.5 5557.5,-604.5 6006.5,-604.5 6006.5,-672.5"/>
<text text-anchor="middle" x="5782" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="5782" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5782" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5782" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L0_S0_TP5_GPU5_expert0&#45;&gt;L0_S0_TP0_GPU0_moe_ar -->
<g id="edge28" class="edge">
<title>L0_S0_TP5_GPU5_expert0&#45;&gt;L0_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M5641.69,-672.65C5641.69,-689.39 5641.69,-706 5641.69,-706 5641.69,-706 2279.5,-706 2279.5,-706 2279.5,-706 2279.5,-576.29 2279.5,-576.29"/>
<polygon fill="black" stroke="black" points="2283,-576.29 2279.5,-566.29 2276,-576.29 2283,-576.29"/>
</g>
<!-- L0_S0_TP5_GPU5_expert0&#45;&gt;L0_S0_TP1_GPU1_moe_ar -->
<g id="edge64" class="edge">
<title>L0_S0_TP5_GPU5_expert0&#45;&gt;L0_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M5599.59,-672.64C5599.59,-688.11 5599.59,-703 5599.59,-703 5599.59,-703 2746.5,-703 2746.5,-703 2746.5,-703 2746.5,-576.02 2746.5,-576.02"/>
<polygon fill="black" stroke="black" points="2750,-576.02 2746.5,-566.02 2743,-576.02 2750,-576.02"/>
</g>
<!-- L0_S0_TP5_GPU5_expert0&#45;&gt;L0_S0_TP2_GPU2_moe_ar -->
<g id="edge100" class="edge">
<title>L0_S0_TP5_GPU5_expert0&#45;&gt;L0_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M5600.27,-604.23C5600.27,-598.83 5600.27,-595 5600.27,-595 5600.27,-595 3838.8,-595 3838.8,-595 3838.8,-595 3838.8,-554.02 3838.8,-554.02"/>
<polygon fill="black" stroke="black" points="3842.3,-554.02 3838.8,-544.02 3835.3,-554.02 3842.3,-554.02"/>
</g>
<!-- L0_S0_TP5_GPU5_expert0&#45;&gt;L0_S0_TP3_GPU3_moe_ar -->
<g id="edge136" class="edge">
<title>L0_S0_TP5_GPU5_expert0&#45;&gt;L0_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M5643.05,-604.19C5643.05,-599.36 5643.05,-596 5643.05,-596 5643.05,-596 4486.07,-596 4486.07,-596 4486.07,-596 4486.07,-562.03 4486.07,-562.03"/>
<polygon fill="black" stroke="black" points="4489.57,-562.03 4486.07,-552.03 4482.57,-562.03 4489.57,-562.03"/>
</g>
<!-- L0_S0_TP5_GPU5_expert0&#45;&gt;L0_S0_TP4_GPU4_moe_ar -->
<g id="edge172" class="edge">
<title>L0_S0_TP5_GPU5_expert0&#45;&gt;L0_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M5685.82,-604.23C5685.82,-598.83 5685.82,-595 5685.82,-595 5685.82,-595 5184.76,-595 5184.76,-595 5184.76,-595 5184.76,-560.32 5184.76,-560.32"/>
<polygon fill="black" stroke="black" points="5188.26,-560.32 5184.76,-550.32 5181.26,-560.32 5188.26,-560.32"/>
</g>
<!-- L0_S0_TP5_GPU5_expert0&#45;&gt;L0_S0_TP5_GPU5_moe_ar -->
<g id="edge208" class="edge">
<title>L0_S0_TP5_GPU5_expert0&#45;&gt;L0_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M5728.59,-604.34C5728.59,-604.34 5728.59,-575.49 5728.59,-575.49"/>
<polygon fill="black" stroke="black" points="5732.09,-575.49 5728.59,-565.49 5725.09,-575.49 5732.09,-575.49"/>
</g>
<!-- L0_S0_TP5_GPU5_expert0&#45;&gt;L0_S0_TP6_GPU6_moe_ar -->
<g id="edge244" class="edge">
<title>L0_S0_TP5_GPU5_expert0&#45;&gt;L0_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M5995.01,-604.34C5995.01,-604.34 5995.01,-551.86 5995.01,-551.86"/>
<polygon fill="black" stroke="black" points="5998.51,-551.86 5995.01,-541.86 5991.51,-551.86 5998.51,-551.86"/>
</g>
<!-- L0_S0_TP5_GPU5_expert0&#45;&gt;L0_S0_TP7_GPU7_moe_ar -->
<g id="edge280" class="edge">
<title>L0_S0_TP5_GPU5_expert0&#45;&gt;L0_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M6000.75,-604.42C6000.75,-601.71 6000.75,-600 6000.75,-600 6000.75,-600 6860.6,-600 6860.6,-600 6860.6,-600 6860.6,-575.32 6860.6,-575.32"/>
<polygon fill="black" stroke="black" points="6864.1,-575.32 6860.6,-565.32 6857.1,-575.32 6864.1,-575.32"/>
</g>
<!-- L0_S0_TP5_GPU5_expert1 -->
<g id="node29" class="node">
<title>L0_S0_TP5_GPU5_expert1</title>
<polygon fill="none" stroke="black" points="6473.5,-672.5 6024.5,-672.5 6024.5,-604.5 6473.5,-604.5 6473.5,-672.5"/>
<text text-anchor="middle" x="6249" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="6249" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6249" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6249" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L0_S0_TP5_GPU5_expert1&#45;&gt;L0_S0_TP0_GPU0_moe_ar -->
<g id="edge29" class="edge">
<title>L0_S0_TP5_GPU5_expert1&#45;&gt;L0_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M6174.17,-672.75C6174.17,-689.87 6174.17,-707 6174.17,-707 6174.17,-707 2275,-707 2275,-707 2275,-707 2275,-576.54 2275,-576.54"/>
<polygon fill="black" stroke="black" points="2278.5,-576.54 2275,-566.54 2271.5,-576.54 2278.5,-576.54"/>
</g>
<!-- L0_S0_TP5_GPU5_expert1&#45;&gt;L0_S0_TP1_GPU1_moe_ar -->
<g id="edge65" class="edge">
<title>L0_S0_TP5_GPU5_expert1&#45;&gt;L0_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M6080.62,-604.19C6080.62,-599.36 6080.62,-596 6080.62,-596 6080.62,-596 3106.67,-596 3106.67,-596 3106.67,-596 3106.67,-562.91 3106.67,-562.91"/>
<polygon fill="black" stroke="black" points="3110.17,-562.91 3106.67,-552.91 3103.17,-562.91 3110.17,-562.91"/>
</g>
<!-- L0_S0_TP5_GPU5_expert1&#45;&gt;L0_S0_TP2_GPU2_moe_ar -->
<g id="edge101" class="edge">
<title>L0_S0_TP5_GPU5_expert1&#45;&gt;L0_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M6136.75,-604.23C6136.75,-598.83 6136.75,-595 6136.75,-595 6136.75,-595 3860.13,-595 3860.13,-595 3860.13,-595 3860.13,-547.34 3860.13,-547.34"/>
<polygon fill="black" stroke="black" points="3863.63,-547.34 3860.13,-537.34 3856.63,-547.34 3863.63,-547.34"/>
</g>
<!-- L0_S0_TP5_GPU5_expert1&#45;&gt;L0_S0_TP3_GPU3_moe_ar -->
<g id="edge137" class="edge">
<title>L0_S0_TP5_GPU5_expert1&#45;&gt;L0_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M6192.88,-604.23C6192.88,-598.83 6192.88,-595 6192.88,-595 6192.88,-595 4527.27,-595 4527.27,-595 4527.27,-595 4527.27,-553.61 4527.27,-553.61"/>
<polygon fill="black" stroke="black" points="4530.77,-553.61 4527.27,-543.61 4523.77,-553.61 4530.77,-553.61"/>
</g>
<!-- L0_S0_TP5_GPU5_expert1&#45;&gt;L0_S0_TP4_GPU4_moe_ar -->
<g id="edge173" class="edge">
<title>L0_S0_TP5_GPU5_expert1&#45;&gt;L0_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M6249,-604.23C6249,-598.83 6249,-595 6249,-595 6249,-595 5208.33,-595 5208.33,-595 5208.33,-595 5208.33,-555.25 5208.33,-555.25"/>
<polygon fill="black" stroke="black" points="5211.83,-555.25 5208.33,-545.25 5204.83,-555.25 5211.83,-555.25"/>
</g>
<!-- L0_S0_TP5_GPU5_expert1&#45;&gt;L0_S0_TP5_GPU5_moe_ar -->
<g id="edge209" class="edge">
<title>L0_S0_TP5_GPU5_expert1&#45;&gt;L0_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M6305.12,-604.23C6305.12,-598.83 6305.12,-595 6305.12,-595 6305.12,-595 5771.37,-595 5771.37,-595 5771.37,-595 5771.37,-572.5 5771.37,-572.5"/>
<polygon fill="black" stroke="black" points="5774.87,-572.5 5771.37,-562.5 5767.87,-572.5 5774.87,-572.5"/>
</g>
<!-- L0_S0_TP5_GPU5_expert1&#45;&gt;L0_S0_TP6_GPU6_moe_ar -->
<g id="edge245" class="edge">
<title>L0_S0_TP5_GPU5_expert1&#45;&gt;L0_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M6361.25,-604.34C6361.25,-604.34 6361.25,-577.67 6361.25,-577.67"/>
<polygon fill="black" stroke="black" points="6364.75,-577.67 6361.25,-567.67 6357.75,-577.67 6364.75,-577.67"/>
</g>
<!-- L0_S0_TP5_GPU5_expert1&#45;&gt;L0_S0_TP7_GPU7_moe_ar -->
<g id="edge281" class="edge">
<title>L0_S0_TP5_GPU5_expert1&#45;&gt;L0_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M6417.38,-604.42C6417.38,-601.71 6417.38,-600 6417.38,-600 6417.38,-600 6887.23,-600 6887.23,-600 6887.23,-600 6887.23,-576.71 6887.23,-576.71"/>
<polygon fill="black" stroke="black" points="6890.73,-576.71 6887.23,-566.71 6883.73,-576.71 6890.73,-576.71"/>
</g>
<!-- L0_S0_TP6_GPU6_expert0 -->
<g id="node30" class="node">
<title>L0_S0_TP6_GPU6_expert0</title>
<polygon fill="none" stroke="black" points="6940.5,-672.5 6491.5,-672.5 6491.5,-604.5 6940.5,-604.5 6940.5,-672.5"/>
<text text-anchor="middle" x="6716" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="6716" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6716" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6716" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L0_S0_TP6_GPU6_expert0&#45;&gt;L0_S0_TP0_GPU0_moe_ar -->
<g id="edge30" class="edge">
<title>L0_S0_TP6_GPU6_expert0&#45;&gt;L0_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M6700.8,-604.23C6700.8,-598.83 6700.8,-595 6700.8,-595 6700.8,-595 2419.88,-595 2419.88,-595 2419.88,-595 2419.88,-562.91 2419.88,-562.91"/>
<polygon fill="black" stroke="black" points="2423.38,-562.91 2419.88,-552.91 2416.38,-562.91 2423.38,-562.91"/>
</g>
<!-- L0_S0_TP6_GPU6_expert0&#45;&gt;L0_S0_TP1_GPU1_moe_ar -->
<g id="edge66" class="edge">
<title>L0_S0_TP6_GPU6_expert0&#45;&gt;L0_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M6508.75,-604.19C6508.75,-599.36 6508.75,-596 6508.75,-596 6508.75,-596 3150.57,-596 3150.57,-596 3150.57,-596 3150.57,-554.33 3150.57,-554.33"/>
<polygon fill="black" stroke="black" points="3154.07,-554.33 3150.57,-544.33 3147.07,-554.33 3154.07,-554.33"/>
</g>
<!-- L0_S0_TP6_GPU6_expert0&#45;&gt;L0_S0_TP2_GPU2_moe_ar -->
<g id="edge102" class="edge">
<title>L0_S0_TP6_GPU6_expert0&#45;&gt;L0_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M6638.5,-604.08C6638.5,-552.21 6638.5,-460 6638.5,-460 6638.5,-460 3854.97,-460 3854.97,-460 3854.97,-460 3854.97,-491.63 3854.97,-491.63"/>
<polygon fill="black" stroke="black" points="3851.47,-491.63 3854.97,-501.63 3858.47,-491.63 3851.47,-491.63"/>
</g>
<!-- L0_S0_TP6_GPU6_expert0&#45;&gt;L0_S0_TP3_GPU3_moe_ar -->
<g id="edge138" class="edge">
<title>L0_S0_TP6_GPU6_expert0&#45;&gt;L0_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M6633.98,-604.08C6633.98,-552.21 6633.98,-460 6633.98,-460 6633.98,-460 4456.97,-460 4456.97,-460 4456.97,-460 4456.97,-474.57 4456.97,-474.57"/>
<polygon fill="black" stroke="black" points="4453.47,-474.57 4456.97,-484.57 4460.47,-474.57 4453.47,-474.57"/>
</g>
<!-- L0_S0_TP6_GPU6_expert0&#45;&gt;L0_S0_TP4_GPU4_moe_ar -->
<g id="edge174" class="edge">
<title>L0_S0_TP6_GPU6_expert0&#45;&gt;L0_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M6525.99,-604.23C6525.99,-598.83 6525.99,-595 6525.99,-595 6525.99,-595 5231.9,-595 5231.9,-595 5231.9,-595 5231.9,-548.47 5231.9,-548.47"/>
<polygon fill="black" stroke="black" points="5235.4,-548.47 5231.9,-538.47 5228.4,-548.47 5235.4,-548.47"/>
</g>
<!-- L0_S0_TP6_GPU6_expert0&#45;&gt;L0_S0_TP5_GPU5_moe_ar -->
<g id="edge210" class="edge">
<title>L0_S0_TP6_GPU6_expert0&#45;&gt;L0_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M6543.24,-604.23C6543.24,-598.83 6543.24,-595 6543.24,-595 6543.24,-595 5814.14,-595 5814.14,-595 5814.14,-595 5814.14,-568.58 5814.14,-568.58"/>
<polygon fill="black" stroke="black" points="5817.64,-568.58 5814.14,-558.58 5810.64,-568.58 5817.64,-568.58"/>
</g>
<!-- L0_S0_TP6_GPU6_expert0&#45;&gt;L0_S0_TP6_GPU6_moe_ar -->
<g id="edge246" class="edge">
<title>L0_S0_TP6_GPU6_expert0&#45;&gt;L0_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M6560.48,-604.34C6560.48,-604.34 6560.48,-559.69 6560.48,-559.69"/>
<polygon fill="black" stroke="black" points="6563.98,-559.69 6560.48,-549.69 6556.98,-559.69 6563.98,-559.69"/>
</g>
<!-- L0_S0_TP6_GPU6_expert0&#45;&gt;L0_S0_TP7_GPU7_moe_ar -->
<g id="edge282" class="edge">
<title>L0_S0_TP6_GPU6_expert0&#45;&gt;L0_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M6913.87,-604.34C6913.87,-604.34 6913.87,-577.67 6913.87,-577.67"/>
<polygon fill="black" stroke="black" points="6917.37,-577.67 6913.87,-567.67 6910.37,-577.67 6917.37,-577.67"/>
</g>
<!-- L0_S0_TP6_GPU6_expert1 -->
<g id="node31" class="node">
<title>L0_S0_TP6_GPU6_expert1</title>
<polygon fill="none" stroke="black" points="7407.5,-672.5 6958.5,-672.5 6958.5,-604.5 7407.5,-604.5 7407.5,-672.5"/>
<text text-anchor="middle" x="7183" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="7183" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="7183" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="7183" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L0_S0_TP6_GPU6_expert1&#45;&gt;L0_S0_TP0_GPU0_moe_ar -->
<g id="edge31" class="edge">
<title>L0_S0_TP6_GPU6_expert1&#45;&gt;L0_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M7018.16,-604.23C7018.16,-598.83 7018.16,-595 7018.16,-595 7018.16,-595 2441.77,-595 2441.77,-595 2441.77,-595 2441.77,-559.04 2441.77,-559.04"/>
<polygon fill="black" stroke="black" points="2445.27,-559.04 2441.77,-549.04 2438.27,-559.04 2445.27,-559.04"/>
</g>
<!-- L0_S0_TP6_GPU6_expert1&#45;&gt;L0_S0_TP1_GPU1_moe_ar -->
<g id="edge67" class="edge">
<title>L0_S0_TP6_GPU6_expert1&#45;&gt;L0_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M7077.82,-604.23C7077.82,-598.83 7077.82,-595 7077.82,-595 7077.82,-595 2643.29,-595 2643.29,-595 2643.29,-595 2643.29,-567.27 2643.29,-567.27"/>
<polygon fill="black" stroke="black" points="2646.79,-567.27 2643.29,-557.27 2639.79,-567.27 2646.79,-567.27"/>
</g>
<!-- L0_S0_TP6_GPU6_expert1&#45;&gt;L0_S0_TP2_GPU2_moe_ar -->
<g id="edge103" class="edge">
<title>L0_S0_TP6_GPU6_expert1&#45;&gt;L0_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M7361.98,-604.08C7361.98,-552.21 7361.98,-460 7361.98,-460 7361.98,-460 3828.48,-460 3828.48,-460 3828.48,-460 3828.48,-484.44 3828.48,-484.44"/>
<polygon fill="black" stroke="black" points="3824.98,-484.44 3828.48,-494.44 3831.98,-484.44 3824.98,-484.44"/>
</g>
<!-- L0_S0_TP6_GPU6_expert1&#45;&gt;L0_S0_TP3_GPU3_moe_ar -->
<g id="edge139" class="edge">
<title>L0_S0_TP6_GPU6_expert1&#45;&gt;L0_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M7183,-672.64C7183,-688.11 7183,-703 7183,-703 7183,-703 4147.5,-703 4147.5,-703 4147.5,-703 4147.5,-576.96 4147.5,-576.96"/>
<polygon fill="black" stroke="black" points="4151,-576.96 4147.5,-566.96 4144,-576.96 4151,-576.96"/>
</g>
<!-- L0_S0_TP6_GPU6_expert1&#45;&gt;L0_S0_TP4_GPU4_moe_ar -->
<g id="edge175" class="edge">
<title>L0_S0_TP6_GPU6_expert1&#45;&gt;L0_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M7070.75,-672.77C7070.75,-685.99 7070.75,-698 7070.75,-698 7070.75,-698 5086,-698 5086,-698 5086,-698 5086,-572.5 5086,-572.5"/>
<polygon fill="black" stroke="black" points="5089.5,-572.5 5086,-562.5 5082.5,-572.5 5089.5,-572.5"/>
</g>
<!-- L0_S0_TP6_GPU6_expert1&#45;&gt;L0_S0_TP5_GPU5_moe_ar -->
<g id="edge211" class="edge">
<title>L0_S0_TP6_GPU6_expert1&#45;&gt;L0_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M7137.48,-604.23C7137.48,-598.83 7137.48,-595 7137.48,-595 7137.48,-595 5856.91,-595 5856.91,-595 5856.91,-595 5856.91,-562.91 5856.91,-562.91"/>
<polygon fill="black" stroke="black" points="5860.41,-562.91 5856.91,-552.91 5853.41,-562.91 5860.41,-562.91"/>
</g>
<!-- L0_S0_TP6_GPU6_expert1&#45;&gt;L0_S0_TP6_GPU6_moe_ar -->
<g id="edge247" class="edge">
<title>L0_S0_TP6_GPU6_expert1&#45;&gt;L0_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M7197.14,-604.23C7197.14,-598.83 7197.14,-595 7197.14,-595 7197.14,-595 6577.73,-595 6577.73,-595 6577.73,-595 6577.73,-556.5 6577.73,-556.5"/>
<polygon fill="black" stroke="black" points="6581.23,-556.5 6577.73,-546.5 6574.23,-556.5 6581.23,-556.5"/>
</g>
<!-- L0_S0_TP6_GPU6_expert1&#45;&gt;L0_S0_TP7_GPU7_moe_ar -->
<g id="edge283" class="edge">
<title>L0_S0_TP6_GPU6_expert1&#45;&gt;L0_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M7256.8,-604.34C7256.8,-604.34 7256.8,-558.14 7256.8,-558.14"/>
<polygon fill="black" stroke="black" points="7260.3,-558.14 7256.8,-548.14 7253.3,-558.14 7260.3,-558.14"/>
</g>
<!-- L0_S0_TP7_GPU7_expert0 -->
<g id="node32" class="node">
<title>L0_S0_TP7_GPU7_expert0</title>
<polygon fill="none" stroke="black" points="7874.5,-672.5 7425.5,-672.5 7425.5,-604.5 7874.5,-604.5 7874.5,-672.5"/>
<text text-anchor="middle" x="7650" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="7650" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="7650" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="7650" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L0_S0_TP7_GPU7_expert0&#45;&gt;L0_S0_TP0_GPU0_moe_ar -->
<g id="edge32" class="edge">
<title>L0_S0_TP7_GPU7_expert0&#45;&gt;L0_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M7437.19,-604.23C7437.19,-598.83 7437.19,-595 7437.19,-595 7437.19,-595 2463.67,-595 2463.67,-595 2463.67,-595 2463.67,-554.43 2463.67,-554.43"/>
<polygon fill="black" stroke="black" points="2467.17,-554.43 2463.67,-544.43 2460.17,-554.43 2467.17,-554.43"/>
</g>
<!-- L0_S0_TP7_GPU7_expert0&#45;&gt;L0_S0_TP1_GPU1_moe_ar -->
<g id="edge68" class="edge">
<title>L0_S0_TP7_GPU7_expert0&#45;&gt;L0_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M7507.31,-604.17C7507.31,-551.31 7507.31,-456 7507.31,-456 7507.31,-456 2964.73,-456 2964.73,-456 2964.73,-456 2964.73,-464.63 2964.73,-464.63"/>
<polygon fill="black" stroke="black" points="2961.23,-464.63 2964.73,-474.63 2968.23,-464.63 2961.23,-464.63"/>
</g>
<!-- L0_S0_TP7_GPU7_expert0&#45;&gt;L0_S0_TP2_GPU2_moe_ar -->
<g id="edge104" class="edge">
<title>L0_S0_TP7_GPU7_expert0&#45;&gt;L0_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M7495.62,-604.08C7495.62,-552.21 7495.62,-460 7495.62,-460 7495.62,-460 3801.98,-460 3801.98,-460 3801.98,-460 3801.98,-479.15 3801.98,-479.15"/>
<polygon fill="black" stroke="black" points="3798.48,-479.15 3801.98,-489.15 3805.48,-479.15 3798.48,-479.15"/>
</g>
<!-- L0_S0_TP7_GPU7_expert0&#45;&gt;L0_S0_TP3_GPU3_moe_ar -->
<g id="edge140" class="edge">
<title>L0_S0_TP7_GPU7_expert0&#45;&gt;L0_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M7483.94,-604.08C7483.94,-552.21 7483.94,-460 7483.94,-460 7483.94,-460 4345.49,-460 4345.49,-460 4345.49,-460 4345.49,-464.93 4345.49,-464.93"/>
<polygon fill="black" stroke="black" points="4341.99,-464.93 4345.49,-474.93 4348.99,-464.93 4341.99,-464.93"/>
</g>
<!-- L0_S0_TP7_GPU7_expert0&#45;&gt;L0_S0_TP4_GPU4_moe_ar -->
<g id="edge176" class="edge">
<title>L0_S0_TP7_GPU7_expert0&#45;&gt;L0_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M7632.64,-672.85C7632.64,-687.81 7632.64,-702 7632.64,-702 7632.64,-702 5081.5,-702 5081.5,-702 5081.5,-702 5081.5,-572.99 5081.5,-572.99"/>
<polygon fill="black" stroke="black" points="5085,-572.99 5081.5,-562.99 5078,-572.99 5085,-572.99"/>
</g>
<!-- L0_S0_TP7_GPU7_expert0&#45;&gt;L0_S0_TP5_GPU5_moe_ar -->
<g id="edge212" class="edge">
<title>L0_S0_TP7_GPU7_expert0&#45;&gt;L0_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M7448.88,-604.23C7448.88,-598.83 7448.88,-595 7448.88,-595 7448.88,-595 5899.69,-595 5899.69,-595 5899.69,-595 5899.69,-554.02 5899.69,-554.02"/>
<polygon fill="black" stroke="black" points="5903.19,-554.02 5899.69,-544.02 5896.19,-554.02 5903.19,-554.02"/>
</g>
<!-- L0_S0_TP7_GPU7_expert0&#45;&gt;L0_S0_TP6_GPU6_moe_ar -->
<g id="edge248" class="edge">
<title>L0_S0_TP7_GPU7_expert0&#45;&gt;L0_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M7460.56,-604.23C7460.56,-598.83 7460.56,-595 7460.56,-595 7460.56,-595 6594.97,-595 6594.97,-595 6594.97,-595 6594.97,-551.99 6594.97,-551.99"/>
<polygon fill="black" stroke="black" points="6598.47,-551.99 6594.97,-541.99 6591.47,-551.99 6598.47,-551.99"/>
</g>
<!-- L0_S0_TP7_GPU7_expert0&#45;&gt;L0_S0_TP7_GPU7_moe_ar -->
<g id="edge284" class="edge">
<title>L0_S0_TP7_GPU7_expert0&#45;&gt;L0_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M7472.25,-604.13C7472.25,-580.74 7472.25,-554 7472.25,-554 7472.25,-554 7231.38,-554 7231.38,-554"/>
<polygon fill="black" stroke="black" points="7231.38,-550.5 7221.38,-554 7231.38,-557.5 7231.38,-550.5"/>
</g>
<!-- L0_S0_TP7_GPU7_expert1 -->
<g id="node33" class="node">
<title>L0_S0_TP7_GPU7_expert1</title>
<polygon fill="none" stroke="black" points="8341.5,-672.5 7892.5,-672.5 7892.5,-604.5 8341.5,-604.5 8341.5,-672.5"/>
<text text-anchor="middle" x="8117" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="8117" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="8117" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="8117" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L0_S0_TP7_GPU7_expert1&#45;&gt;L0_S0_TP0_GPU0_moe_ar -->
<g id="edge33" class="edge">
<title>L0_S0_TP7_GPU7_expert1&#45;&gt;L0_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M7948.31,-604.23C7948.31,-598.83 7948.31,-595 7948.31,-595 7948.31,-595 2485.57,-595 2485.57,-595 2485.57,-595 2485.57,-547.71 2485.57,-547.71"/>
<polygon fill="black" stroke="black" points="2489.07,-547.71 2485.57,-537.71 2482.07,-547.71 2489.07,-547.71"/>
</g>
<!-- L0_S0_TP7_GPU7_expert1&#45;&gt;L0_S0_TP1_GPU1_moe_ar -->
<g id="edge69" class="edge">
<title>L0_S0_TP7_GPU7_expert1&#45;&gt;L0_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M8283.19,-604.17C8283.19,-551.31 8283.19,-456 8283.19,-456 8283.19,-456 2849.87,-456 2849.87,-456 2849.87,-456 2849.87,-462.25 2849.87,-462.25"/>
<polygon fill="black" stroke="black" points="2846.37,-462.25 2849.87,-472.25 2853.37,-462.25 2846.37,-462.25"/>
</g>
<!-- L0_S0_TP7_GPU7_expert1&#45;&gt;L0_S0_TP2_GPU2_moe_ar -->
<g id="edge105" class="edge">
<title>L0_S0_TP7_GPU7_expert1&#45;&gt;L0_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M8227.38,-604.08C8227.38,-552.21 8227.38,-460 8227.38,-460 8227.38,-460 3775.49,-460 3775.49,-460 3775.49,-460 3775.49,-475.27 3775.49,-475.27"/>
<polygon fill="black" stroke="black" points="3771.99,-475.27 3775.49,-485.27 3778.99,-475.27 3771.99,-475.27"/>
</g>
<!-- L0_S0_TP7_GPU7_expert1&#45;&gt;L0_S0_TP3_GPU3_moe_ar -->
<g id="edge141" class="edge">
<title>L0_S0_TP7_GPU7_expert1&#45;&gt;L0_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M8171.56,-604.08C8171.56,-552.21 8171.56,-460 8171.56,-460 8171.56,-460 4234,-460 4234,-460 4234,-460 4234,-462.23 4234,-462.23"/>
<polygon fill="black" stroke="black" points="4230.5,-462.23 4234,-472.23 4237.5,-462.23 4230.5,-462.23"/>
</g>
<!-- L0_S0_TP7_GPU7_expert1&#45;&gt;L0_S0_TP4_GPU4_moe_ar -->
<g id="edge177" class="edge">
<title>L0_S0_TP7_GPU7_expert1&#45;&gt;L0_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M8042.17,-672.78C8042.17,-688.63 8042.17,-704 8042.17,-704 8042.17,-704 5077,-704 5077,-704 5077,-704 5077,-573 5077,-573"/>
<polygon fill="black" stroke="black" points="5080.5,-573 5077,-563 5073.5,-573 5080.5,-573"/>
</g>
<!-- L0_S0_TP7_GPU7_expert1&#45;&gt;L0_S0_TP5_GPU5_moe_ar -->
<g id="edge213" class="edge">
<title>L0_S0_TP7_GPU7_expert1&#45;&gt;L0_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M8115.75,-604.28C8115.75,-552.7 8115.75,-461 8115.75,-461 8115.75,-461 5576.15,-461 5576.15,-461 5576.15,-461 5576.15,-462.46 5576.15,-462.46"/>
<polygon fill="black" stroke="black" points="5572.65,-462.46 5576.15,-472.46 5579.65,-462.46 5572.65,-462.46"/>
</g>
<!-- L0_S0_TP7_GPU7_expert1&#45;&gt;L0_S0_TP6_GPU6_moe_ar -->
<g id="edge249" class="edge">
<title>L0_S0_TP7_GPU7_expert1&#45;&gt;L0_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M8004.12,-604.32C8004.12,-598.35 8004.12,-594 8004.12,-594 8004.12,-594 6612.22,-594 6612.22,-594 6612.22,-594 6612.22,-545.66 6612.22,-545.66"/>
<polygon fill="black" stroke="black" points="6615.72,-545.66 6612.22,-535.66 6608.72,-545.66 6615.72,-545.66"/>
</g>
<!-- L0_S0_TP7_GPU7_expert1&#45;&gt;L0_S0_TP7_GPU7_moe_ar -->
<g id="edge285" class="edge">
<title>L0_S0_TP7_GPU7_expert1&#45;&gt;L0_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M8059.94,-604.4C8059.94,-576.28 8059.94,-541 8059.94,-541 8059.94,-541 7294.42,-541 7294.42,-541"/>
<polygon fill="black" stroke="black" points="7294.42,-537.5 7284.42,-541 7294.42,-544.5 7294.42,-537.5"/>
</g>
<!-- L0_S0_TP0_GPU0_norm -->
<g id="node35" class="node">
<title>L0_S0_TP0_GPU0_norm</title>
<polygon fill="none" stroke="black" points="634.5,-332.33 185.5,-332.33 185.5,-264.33 634.5,-264.33 634.5,-332.33"/>
<text text-anchor="middle" x="410" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="410" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="410" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="410" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP0_GPU0_moe_res&#45;&gt;L0_S0_TP0_GPU0_norm -->
<g id="edge36" class="edge">
<title>L0_S0_TP0_GPU0_moe_res&#45;&gt;L0_S0_TP0_GPU0_norm</title>
<path fill="none" stroke="black" d="M410,-368.28C410,-368.28 410,-342.46 410,-342.46"/>
<polygon fill="black" stroke="black" points="413.5,-342.46 410,-332.46 406.5,-342.46 413.5,-342.46"/>
</g>
<!-- L0_S0_TP1_GPU1_qkv_linear -->
<g id="node36" class="node">
<title>L0_S0_TP1_GPU1_qkv_linear</title>
<polygon fill="none" stroke="black" points="2324,-1614.75 1716,-1614.75 1716,-1546.75 2324,-1546.75 2324,-1614.75"/>
<text text-anchor="middle" x="2020" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="2020" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="2020" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="2020" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L0_S0_TP1_GPU1_qkv_slice -->
<g id="node37" class="node">
<title>L0_S0_TP1_GPU1_qkv_slice</title>
<polygon fill="none" stroke="black" points="2318,-1496.67 1722,-1496.67 1722,-1428.67 2318,-1428.67 2318,-1496.67"/>
<text text-anchor="middle" x="2020" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="2020" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="2020" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="2020" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L0_S0_TP1_GPU1_qkv_linear&#45;&gt;L0_S0_TP1_GPU1_qkv_slice -->
<g id="edge37" class="edge">
<title>L0_S0_TP1_GPU1_qkv_linear&#45;&gt;L0_S0_TP1_GPU1_qkv_slice</title>
<path fill="none" stroke="black" d="M2020,-1546.59C2020,-1546.59 2020,-1506.74 2020,-1506.74"/>
<polygon fill="black" stroke="black" points="2023.5,-1506.74 2020,-1496.74 2016.5,-1506.74 2023.5,-1506.74"/>
</g>
<!-- L0_S0_TP1_GPU1_qkv_slice&#45;&gt;L0_S0_TP1_GPU1_attn_v -->
<g id="edge41" class="edge">
<title>L0_S0_TP1_GPU1_qkv_slice&#45;&gt;L0_S0_TP1_GPU1_attn_v</title>
<path fill="none" stroke="black" d="M1778.25,-1428.38C1778.25,-1428.38 1778.25,-1195 1778.25,-1195"/>
<polygon fill="black" stroke="black" points="1781.75,-1195 1778.25,-1185 1774.75,-1195 1781.75,-1195"/>
</g>
<!-- L0_S0_TP1_GPU1_qk_matmul -->
<g id="node38" class="node">
<title>L0_S0_TP1_GPU1_qk_matmul</title>
<polygon fill="none" stroke="black" points="2735.5,-1392.67 1800.5,-1392.67 1800.5,-1324.67 2735.5,-1324.67 2735.5,-1392.67"/>
<text text-anchor="middle" x="2268" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="2268" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="2268" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="2268" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L0_S0_TP1_GPU1_qkv_slice&#45;&gt;L0_S0_TP1_GPU1_qk_matmul -->
<g id="edge38" class="edge">
<title>L0_S0_TP1_GPU1_qkv_slice&#45;&gt;L0_S0_TP1_GPU1_qk_matmul</title>
<path fill="none" stroke="black" d="M2059.25,-1428.61C2059.25,-1428.61 2059.25,-1402.8 2059.25,-1402.8"/>
<polygon fill="black" stroke="black" points="2062.75,-1402.8 2059.25,-1392.8 2055.75,-1402.8 2062.75,-1402.8"/>
</g>
<!-- L0_S0_TP1_GPU1_softmax -->
<g id="node39" class="node">
<title>L0_S0_TP1_GPU1_softmax</title>
<polygon fill="none" stroke="black" points="2501,-1288.67 1991,-1288.67 1991,-1220.67 2501,-1220.67 2501,-1288.67"/>
<text text-anchor="middle" x="2246" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="2246" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="2246" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="2246" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L0_S0_TP1_GPU1_qk_matmul&#45;&gt;L0_S0_TP1_GPU1_softmax -->
<g id="edge39" class="edge">
<title>L0_S0_TP1_GPU1_qk_matmul&#45;&gt;L0_S0_TP1_GPU1_softmax</title>
<path fill="none" stroke="black" d="M2246,-1324.61C2246,-1324.61 2246,-1298.8 2246,-1298.8"/>
<polygon fill="black" stroke="black" points="2249.5,-1298.8 2246,-1288.8 2242.5,-1298.8 2249.5,-1298.8"/>
</g>
<!-- L0_S0_TP1_GPU1_softmax&#45;&gt;L0_S0_TP1_GPU1_attn_v -->
<g id="edge40" class="edge">
<title>L0_S0_TP1_GPU1_softmax&#45;&gt;L0_S0_TP1_GPU1_attn_v</title>
<path fill="none" stroke="black" d="M2246,-1220.61C2246,-1220.61 2246,-1194.8 2246,-1194.8"/>
<polygon fill="black" stroke="black" points="2249.5,-1194.8 2246,-1184.8 2242.5,-1194.8 2249.5,-1194.8"/>
</g>
<!-- L0_S0_TP1_GPU1_mha_res -->
<g id="node41" class="node">
<title>L0_S0_TP1_GPU1_mha_res</title>
<polygon fill="none" stroke="black" points="2363.5,-948.5 1476.5,-948.5 1476.5,-880.5 2363.5,-880.5 2363.5,-948.5"/>
<text text-anchor="middle" x="1920" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="1920" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="1920" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="1920" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP1_GPU1_mha_ar&#45;&gt;L0_S0_TP1_GPU1_mha_res -->
<g id="edge50" class="edge">
<title>L0_S0_TP1_GPU1_mha_ar&#45;&gt;L0_S0_TP1_GPU1_mha_res</title>
<path fill="none" stroke="black" d="M2340.01,-1015.66C2340.01,-1015.66 2340.01,-958.91 2340.01,-958.91"/>
<polygon fill="black" stroke="black" points="2343.51,-958.91 2340.01,-948.91 2336.51,-958.91 2343.51,-958.91"/>
</g>
<!-- L0_S0_TP1_GPU1_gate -->
<g id="node42" class="node">
<title>L0_S0_TP1_GPU1_gate</title>
<polygon fill="none" stroke="black" points="2449.56,-844.5 1607.15,-844.5 1390.44,-708.5 2232.85,-708.5 2449.56,-844.5"/>
<text text-anchor="middle" x="1920" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="1920" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="1920" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="1920" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L0_S0_TP1_GPU1_mha_res&#45;&gt;L0_S0_TP1_GPU1_gate -->
<g id="edge51" class="edge">
<title>L0_S0_TP1_GPU1_mha_res&#45;&gt;L0_S0_TP1_GPU1_gate</title>
<path fill="none" stroke="black" d="M1920,-880.39C1920,-880.39 1920,-854.73 1920,-854.73"/>
<polygon fill="black" stroke="black" points="1923.5,-854.73 1920,-844.73 1916.5,-854.73 1923.5,-854.73"/>
</g>
<!-- L0_S0_TP1_GPU1_moe_res -->
<g id="node44" class="node">
<title>L0_S0_TP1_GPU1_moe_res</title>
<polygon fill="none" stroke="black" points="2364,-436.33 1544,-436.33 1544,-368.33 2364,-368.33 2364,-436.33"/>
<text text-anchor="middle" x="1954" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="1954" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="1954" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="1954" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP1_GPU1_mha_res&#45;&gt;L0_S0_TP1_GPU1_moe_res -->
<g id="edge71" class="edge">
<title>L0_S0_TP1_GPU1_mha_res&#45;&gt;L0_S0_TP1_GPU1_moe_res</title>
<path fill="none" stroke="black" d="M1476.43,-914C1419.73,-914 1381,-914 1381,-914 1381,-914 1381,-673 1381,-673 1381,-673 1812.5,-673 1812.5,-673 1812.5,-673 1812.5,-446.34 1812.5,-446.34"/>
<polygon fill="black" stroke="black" points="1816,-446.34 1812.5,-436.34 1809,-446.34 1816,-446.34"/>
</g>
<!-- L0_S0_TP1_GPU1_gate&#45;&gt;L0_S0_TP1_GPU1_expert0 -->
<g id="edge52" class="edge">
<title>L0_S0_TP1_GPU1_gate&#45;&gt;L0_S0_TP1_GPU1_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1896.33,-708.31C1896.33,-708.31 1896.33,-682.71 1896.33,-682.71"/>
<polygon fill="black" stroke="black" points="1899.83,-682.71 1896.33,-672.71 1892.83,-682.71 1899.83,-682.71"/>
</g>
<!-- L0_S0_TP1_GPU1_gate&#45;&gt;L0_S0_TP1_GPU1_expert1 -->
<g id="edge53" class="edge">
<title>L0_S0_TP1_GPU1_gate&#45;&gt;L0_S0_TP1_GPU1_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2369.14,-776.4C2369.14,-776.4 2369.14,-682.74 2369.14,-682.74"/>
<polygon fill="black" stroke="black" points="2372.64,-682.74 2369.14,-672.74 2365.64,-682.74 2372.64,-682.74"/>
</g>
<!-- L0_S0_TP1_GPU1_moe_ar&#45;&gt;L0_S0_TP1_GPU1_moe_res -->
<g id="edge70" class="edge">
<title>L0_S0_TP1_GPU1_moe_ar&#45;&gt;L0_S0_TP1_GPU1_moe_res</title>
<path fill="none" stroke="black" d="M2630.27,-485.21C2630.27,-450.3 2630.27,-402 2630.27,-402 2630.27,-402 2374.45,-402 2374.45,-402"/>
<polygon fill="black" stroke="black" points="2374.45,-398.5 2364.45,-402 2374.45,-405.5 2374.45,-398.5"/>
</g>
<!-- L0_S0_TP1_GPU1_norm -->
<g id="node45" class="node">
<title>L0_S0_TP1_GPU1_norm</title>
<polygon fill="none" stroke="black" points="2178.5,-332.33 1729.5,-332.33 1729.5,-264.33 2178.5,-264.33 2178.5,-332.33"/>
<text text-anchor="middle" x="1954" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="1954" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="1954" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="1954" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP1_GPU1_moe_res&#45;&gt;L0_S0_TP1_GPU1_norm -->
<g id="edge72" class="edge">
<title>L0_S0_TP1_GPU1_moe_res&#45;&gt;L0_S0_TP1_GPU1_norm</title>
<path fill="none" stroke="black" d="M1954,-368.28C1954,-368.28 1954,-342.46 1954,-342.46"/>
<polygon fill="black" stroke="black" points="1957.5,-342.46 1954,-332.46 1950.5,-342.46 1957.5,-342.46"/>
</g>
<!-- L0_S0_TP2_GPU2_qkv_linear -->
<g id="node46" class="node">
<title>L0_S0_TP2_GPU2_qkv_linear</title>
<polygon fill="none" stroke="black" points="3350,-1614.75 2742,-1614.75 2742,-1546.75 3350,-1546.75 3350,-1614.75"/>
<text text-anchor="middle" x="3046" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="3046" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="3046" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="3046" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L0_S0_TP2_GPU2_qkv_slice -->
<g id="node47" class="node">
<title>L0_S0_TP2_GPU2_qkv_slice</title>
<polygon fill="none" stroke="black" points="3344,-1496.67 2748,-1496.67 2748,-1428.67 3344,-1428.67 3344,-1496.67"/>
<text text-anchor="middle" x="3046" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="3046" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="3046" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="3046" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L0_S0_TP2_GPU2_qkv_linear&#45;&gt;L0_S0_TP2_GPU2_qkv_slice -->
<g id="edge73" class="edge">
<title>L0_S0_TP2_GPU2_qkv_linear&#45;&gt;L0_S0_TP2_GPU2_qkv_slice</title>
<path fill="none" stroke="black" d="M3046,-1546.59C3046,-1546.59 3046,-1506.74 3046,-1506.74"/>
<polygon fill="black" stroke="black" points="3049.5,-1506.74 3046,-1496.74 3042.5,-1506.74 3049.5,-1506.74"/>
</g>
<!-- L0_S0_TP2_GPU2_qkv_slice&#45;&gt;L0_S0_TP2_GPU2_attn_v -->
<g id="edge77" class="edge">
<title>L0_S0_TP2_GPU2_qkv_slice&#45;&gt;L0_S0_TP2_GPU2_attn_v</title>
<path fill="none" stroke="black" d="M2787.25,-1428.38C2787.25,-1428.38 2787.25,-1195 2787.25,-1195"/>
<polygon fill="black" stroke="black" points="2790.75,-1195 2787.25,-1185 2783.75,-1195 2790.75,-1195"/>
</g>
<!-- L0_S0_TP2_GPU2_qk_matmul -->
<g id="node48" class="node">
<title>L0_S0_TP2_GPU2_qk_matmul</title>
<polygon fill="none" stroke="black" points="3761.5,-1392.67 2826.5,-1392.67 2826.5,-1324.67 3761.5,-1324.67 3761.5,-1392.67"/>
<text text-anchor="middle" x="3294" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="3294" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="3294" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="3294" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L0_S0_TP2_GPU2_qkv_slice&#45;&gt;L0_S0_TP2_GPU2_qk_matmul -->
<g id="edge74" class="edge">
<title>L0_S0_TP2_GPU2_qkv_slice&#45;&gt;L0_S0_TP2_GPU2_qk_matmul</title>
<path fill="none" stroke="black" d="M3085.25,-1428.61C3085.25,-1428.61 3085.25,-1402.8 3085.25,-1402.8"/>
<polygon fill="black" stroke="black" points="3088.75,-1402.8 3085.25,-1392.8 3081.75,-1402.8 3088.75,-1402.8"/>
</g>
<!-- L0_S0_TP2_GPU2_softmax -->
<g id="node49" class="node">
<title>L0_S0_TP2_GPU2_softmax</title>
<polygon fill="none" stroke="black" points="3492,-1288.67 2982,-1288.67 2982,-1220.67 3492,-1220.67 3492,-1288.67"/>
<text text-anchor="middle" x="3237" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="3237" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="3237" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="3237" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L0_S0_TP2_GPU2_qk_matmul&#45;&gt;L0_S0_TP2_GPU2_softmax -->
<g id="edge75" class="edge">
<title>L0_S0_TP2_GPU2_qk_matmul&#45;&gt;L0_S0_TP2_GPU2_softmax</title>
<path fill="none" stroke="black" d="M3237,-1324.61C3237,-1324.61 3237,-1298.8 3237,-1298.8"/>
<polygon fill="black" stroke="black" points="3240.5,-1298.8 3237,-1288.8 3233.5,-1298.8 3240.5,-1298.8"/>
</g>
<!-- L0_S0_TP2_GPU2_softmax&#45;&gt;L0_S0_TP2_GPU2_attn_v -->
<g id="edge76" class="edge">
<title>L0_S0_TP2_GPU2_softmax&#45;&gt;L0_S0_TP2_GPU2_attn_v</title>
<path fill="none" stroke="black" d="M3237,-1220.61C3237,-1220.61 3237,-1194.8 3237,-1194.8"/>
<polygon fill="black" stroke="black" points="3240.5,-1194.8 3237,-1184.8 3233.5,-1194.8 3240.5,-1194.8"/>
</g>
<!-- L0_S0_TP2_GPU2_mha_res -->
<g id="node51" class="node">
<title>L0_S0_TP2_GPU2_mha_res</title>
<polygon fill="none" stroke="black" points="3441.5,-948.5 2554.5,-948.5 2554.5,-880.5 3441.5,-880.5 3441.5,-948.5"/>
<text text-anchor="middle" x="2998" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="2998" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="2998" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="2998" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP2_GPU2_mha_ar&#45;&gt;L0_S0_TP2_GPU2_mha_res -->
<g id="edge86" class="edge">
<title>L0_S0_TP2_GPU2_mha_ar&#45;&gt;L0_S0_TP2_GPU2_mha_res</title>
<path fill="none" stroke="black" d="M3263.51,-991.61C3263.51,-991.61 3263.51,-958.74 3263.51,-958.74"/>
<polygon fill="black" stroke="black" points="3267.01,-958.74 3263.51,-948.74 3260.01,-958.74 3267.01,-958.74"/>
</g>
<!-- L0_S0_TP2_GPU2_gate -->
<g id="node52" class="node">
<title>L0_S0_TP2_GPU2_gate</title>
<polygon fill="none" stroke="black" points="3527.56,-844.5 2685.15,-844.5 2468.44,-708.5 3310.85,-708.5 3527.56,-844.5"/>
<text text-anchor="middle" x="2998" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="2998" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="2998" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="2998" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L0_S0_TP2_GPU2_mha_res&#45;&gt;L0_S0_TP2_GPU2_gate -->
<g id="edge87" class="edge">
<title>L0_S0_TP2_GPU2_mha_res&#45;&gt;L0_S0_TP2_GPU2_gate</title>
<path fill="none" stroke="black" d="M2998,-880.39C2998,-880.39 2998,-854.73 2998,-854.73"/>
<polygon fill="black" stroke="black" points="3001.5,-854.73 2998,-844.73 2994.5,-854.73 3001.5,-854.73"/>
</g>
<!-- L0_S0_TP2_GPU2_moe_res -->
<g id="node54" class="node">
<title>L0_S0_TP2_GPU2_moe_res</title>
<polygon fill="none" stroke="black" points="3555,-436.33 2735,-436.33 2735,-368.33 3555,-368.33 3555,-436.33"/>
<text text-anchor="middle" x="3145" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="3145" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="3145" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="3145" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP2_GPU2_mha_res&#45;&gt;L0_S0_TP2_GPU2_moe_res -->
<g id="edge107" class="edge">
<title>L0_S0_TP2_GPU2_mha_res&#45;&gt;L0_S0_TP2_GPU2_moe_res</title>
<path fill="none" stroke="black" d="M3441.57,-914C3498.27,-914 3537,-914 3537,-914 3537,-914 3537,-680 3537,-680 3537,-680 3209.86,-680 3209.86,-680 3209.86,-680 3209.86,-446.38 3209.86,-446.38"/>
<polygon fill="black" stroke="black" points="3213.36,-446.38 3209.86,-436.38 3206.36,-446.38 3213.36,-446.38"/>
</g>
<!-- L0_S0_TP2_GPU2_gate&#45;&gt;L0_S0_TP2_GPU2_expert0 -->
<g id="edge88" class="edge">
<title>L0_S0_TP2_GPU2_gate&#45;&gt;L0_S0_TP2_GPU2_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2905.17,-708.31C2905.17,-708.31 2905.17,-682.71 2905.17,-682.71"/>
<polygon fill="black" stroke="black" points="2908.67,-682.71 2905.17,-672.71 2901.67,-682.71 2908.67,-682.71"/>
</g>
<!-- L0_S0_TP2_GPU2_gate&#45;&gt;L0_S0_TP2_GPU2_expert1 -->
<g id="edge89" class="edge">
<title>L0_S0_TP2_GPU2_gate&#45;&gt;L0_S0_TP2_GPU2_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3375.14,-748.57C3375.14,-748.57 3375.14,-682.74 3375.14,-682.74"/>
<polygon fill="black" stroke="black" points="3378.64,-682.74 3375.14,-672.74 3371.64,-682.74 3378.64,-682.74"/>
</g>
<!-- L0_S0_TP2_GPU2_moe_ar&#45;&gt;L0_S0_TP2_GPU2_moe_res -->
<g id="edge106" class="edge">
<title>L0_S0_TP2_GPU2_moe_ar&#45;&gt;L0_S0_TP2_GPU2_moe_res</title>
<path fill="none" stroke="black" d="M3383.77,-478.12C3383.77,-478.12 3383.77,-446.58 3383.77,-446.58"/>
<polygon fill="black" stroke="black" points="3387.27,-446.58 3383.77,-436.58 3380.27,-446.58 3387.27,-446.58"/>
</g>
<!-- L0_S0_TP2_GPU2_norm -->
<g id="node55" class="node">
<title>L0_S0_TP2_GPU2_norm</title>
<polygon fill="none" stroke="black" points="3369.5,-332.33 2920.5,-332.33 2920.5,-264.33 3369.5,-264.33 3369.5,-332.33"/>
<text text-anchor="middle" x="3145" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="3145" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="3145" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="3145" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP2_GPU2_moe_res&#45;&gt;L0_S0_TP2_GPU2_norm -->
<g id="edge108" class="edge">
<title>L0_S0_TP2_GPU2_moe_res&#45;&gt;L0_S0_TP2_GPU2_norm</title>
<path fill="none" stroke="black" d="M3145,-368.28C3145,-368.28 3145,-342.46 3145,-342.46"/>
<polygon fill="black" stroke="black" points="3148.5,-342.46 3145,-332.46 3141.5,-342.46 3148.5,-342.46"/>
</g>
<!-- L0_S0_TP3_GPU3_qkv_linear -->
<g id="node56" class="node">
<title>L0_S0_TP3_GPU3_qkv_linear</title>
<polygon fill="none" stroke="black" points="4359,-1614.75 3751,-1614.75 3751,-1546.75 4359,-1546.75 4359,-1614.75"/>
<text text-anchor="middle" x="4055" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="4055" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4055" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="4055" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L0_S0_TP3_GPU3_qkv_slice -->
<g id="node57" class="node">
<title>L0_S0_TP3_GPU3_qkv_slice</title>
<polygon fill="none" stroke="black" points="4353,-1496.67 3757,-1496.67 3757,-1428.67 4353,-1428.67 4353,-1496.67"/>
<text text-anchor="middle" x="4055" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="4055" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="4055" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="4055" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L0_S0_TP3_GPU3_qkv_linear&#45;&gt;L0_S0_TP3_GPU3_qkv_slice -->
<g id="edge109" class="edge">
<title>L0_S0_TP3_GPU3_qkv_linear&#45;&gt;L0_S0_TP3_GPU3_qkv_slice</title>
<path fill="none" stroke="black" d="M4055,-1546.59C4055,-1546.59 4055,-1506.74 4055,-1506.74"/>
<polygon fill="black" stroke="black" points="4058.5,-1506.74 4055,-1496.74 4051.5,-1506.74 4058.5,-1506.74"/>
</g>
<!-- L0_S0_TP3_GPU3_qkv_slice&#45;&gt;L0_S0_TP3_GPU3_attn_v -->
<g id="edge113" class="edge">
<title>L0_S0_TP3_GPU3_qkv_slice&#45;&gt;L0_S0_TP3_GPU3_attn_v</title>
<path fill="none" stroke="black" d="M3798.5,-1428.38C3798.5,-1428.38 3798.5,-1195 3798.5,-1195"/>
<polygon fill="black" stroke="black" points="3802,-1195 3798.5,-1185 3795,-1195 3802,-1195"/>
</g>
<!-- L0_S0_TP3_GPU3_qk_matmul -->
<g id="node58" class="node">
<title>L0_S0_TP3_GPU3_qk_matmul</title>
<polygon fill="none" stroke="black" points="4770.5,-1392.67 3835.5,-1392.67 3835.5,-1324.67 4770.5,-1324.67 4770.5,-1392.67"/>
<text text-anchor="middle" x="4303" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="4303" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="4303" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="4303" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L0_S0_TP3_GPU3_qkv_slice&#45;&gt;L0_S0_TP3_GPU3_qk_matmul -->
<g id="edge110" class="edge">
<title>L0_S0_TP3_GPU3_qkv_slice&#45;&gt;L0_S0_TP3_GPU3_qk_matmul</title>
<path fill="none" stroke="black" d="M4094.25,-1428.61C4094.25,-1428.61 4094.25,-1402.8 4094.25,-1402.8"/>
<polygon fill="black" stroke="black" points="4097.75,-1402.8 4094.25,-1392.8 4090.75,-1402.8 4097.75,-1402.8"/>
</g>
<!-- L0_S0_TP3_GPU3_softmax -->
<g id="node59" class="node">
<title>L0_S0_TP3_GPU3_softmax</title>
<polygon fill="none" stroke="black" points="4475,-1288.67 3965,-1288.67 3965,-1220.67 4475,-1220.67 4475,-1288.67"/>
<text text-anchor="middle" x="4220" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="4220" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="4220" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="4220" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L0_S0_TP3_GPU3_qk_matmul&#45;&gt;L0_S0_TP3_GPU3_softmax -->
<g id="edge111" class="edge">
<title>L0_S0_TP3_GPU3_qk_matmul&#45;&gt;L0_S0_TP3_GPU3_softmax</title>
<path fill="none" stroke="black" d="M4220,-1324.61C4220,-1324.61 4220,-1298.8 4220,-1298.8"/>
<polygon fill="black" stroke="black" points="4223.5,-1298.8 4220,-1288.8 4216.5,-1298.8 4223.5,-1298.8"/>
</g>
<!-- L0_S0_TP3_GPU3_softmax&#45;&gt;L0_S0_TP3_GPU3_attn_v -->
<g id="edge112" class="edge">
<title>L0_S0_TP3_GPU3_softmax&#45;&gt;L0_S0_TP3_GPU3_attn_v</title>
<path fill="none" stroke="black" d="M4220,-1220.61C4220,-1220.61 4220,-1194.8 4220,-1194.8"/>
<polygon fill="black" stroke="black" points="4223.5,-1194.8 4220,-1184.8 4216.5,-1194.8 4223.5,-1194.8"/>
</g>
<!-- L0_S0_TP3_GPU3_mha_res -->
<g id="node61" class="node">
<title>L0_S0_TP3_GPU3_mha_res</title>
<polygon fill="none" stroke="black" points="4519.5,-948.5 3632.5,-948.5 3632.5,-880.5 4519.5,-880.5 4519.5,-948.5"/>
<text text-anchor="middle" x="4076" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="4076" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4076" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4076" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP3_GPU3_mha_ar&#45;&gt;L0_S0_TP3_GPU3_mha_res -->
<g id="edge122" class="edge">
<title>L0_S0_TP3_GPU3_mha_ar&#45;&gt;L0_S0_TP3_GPU3_mha_res</title>
<path fill="none" stroke="black" d="M4187.01,-984.55C4187.01,-984.55 4187.01,-958.73 4187.01,-958.73"/>
<polygon fill="black" stroke="black" points="4190.51,-958.73 4187.01,-948.73 4183.51,-958.73 4190.51,-958.73"/>
</g>
<!-- L0_S0_TP3_GPU3_gate -->
<g id="node62" class="node">
<title>L0_S0_TP3_GPU3_gate</title>
<polygon fill="none" stroke="black" points="4605.56,-844.5 3763.15,-844.5 3546.44,-708.5 4388.85,-708.5 4605.56,-844.5"/>
<text text-anchor="middle" x="4076" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="4076" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4076" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="4076" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L0_S0_TP3_GPU3_mha_res&#45;&gt;L0_S0_TP3_GPU3_gate -->
<g id="edge123" class="edge">
<title>L0_S0_TP3_GPU3_mha_res&#45;&gt;L0_S0_TP3_GPU3_gate</title>
<path fill="none" stroke="black" d="M4076,-880.39C4076,-880.39 4076,-854.73 4076,-854.73"/>
<polygon fill="black" stroke="black" points="4079.5,-854.73 4076,-844.73 4072.5,-854.73 4079.5,-854.73"/>
</g>
<!-- L0_S0_TP3_GPU3_moe_res -->
<g id="node64" class="node">
<title>L0_S0_TP3_GPU3_moe_res</title>
<polygon fill="none" stroke="black" points="4569,-436.33 3749,-436.33 3749,-368.33 4569,-368.33 4569,-436.33"/>
<text text-anchor="middle" x="4159" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="4159" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4159" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4159" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP3_GPU3_mha_res&#45;&gt;L0_S0_TP3_GPU3_moe_res -->
<g id="edge143" class="edge">
<title>L0_S0_TP3_GPU3_mha_res&#45;&gt;L0_S0_TP3_GPU3_moe_res</title>
<path fill="none" stroke="black" d="M4519.59,-903C4578.82,-903 4619.61,-903 4619.61,-903 4619.61,-903 4619.61,-574 4619.61,-574 4619.61,-574 4580.69,-574 4580.69,-574 4580.69,-574 4580.69,-385 4580.69,-385 4580.69,-385 4579.41,-385 4579.41,-385"/>
<polygon fill="black" stroke="black" points="4579.41,-381.5 4569.41,-385 4579.41,-388.5 4579.41,-381.5"/>
</g>
<!-- L0_S0_TP3_GPU3_gate&#45;&gt;L0_S0_TP3_GPU3_expert0 -->
<g id="edge124" class="edge">
<title>L0_S0_TP3_GPU3_gate&#45;&gt;L0_S0_TP3_GPU3_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3914,-708.31C3914,-708.31 3914,-682.71 3914,-682.71"/>
<polygon fill="black" stroke="black" points="3917.5,-682.71 3914,-672.71 3910.5,-682.71 3917.5,-682.71"/>
</g>
<!-- L0_S0_TP3_GPU3_gate&#45;&gt;L0_S0_TP3_GPU3_expert1 -->
<g id="edge125" class="edge">
<title>L0_S0_TP3_GPU3_gate&#45;&gt;L0_S0_TP3_GPU3_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4381,-708.31C4381,-708.31 4381,-682.71 4381,-682.71"/>
<polygon fill="black" stroke="black" points="4384.5,-682.71 4381,-672.71 4377.5,-682.71 4384.5,-682.71"/>
</g>
<!-- L0_S0_TP3_GPU3_moe_ar&#45;&gt;L0_S0_TP3_GPU3_moe_res -->
<g id="edge142" class="edge">
<title>L0_S0_TP3_GPU3_moe_ar&#45;&gt;L0_S0_TP3_GPU3_moe_res</title>
<path fill="none" stroke="black" d="M4122.51,-474.76C4122.51,-474.76 4122.51,-446.51 4122.51,-446.51"/>
<polygon fill="black" stroke="black" points="4126.01,-446.51 4122.51,-436.51 4119.01,-446.51 4126.01,-446.51"/>
</g>
<!-- L0_S0_TP3_GPU3_norm -->
<g id="node65" class="node">
<title>L0_S0_TP3_GPU3_norm</title>
<polygon fill="none" stroke="black" points="4383.5,-332.33 3934.5,-332.33 3934.5,-264.33 4383.5,-264.33 4383.5,-332.33"/>
<text text-anchor="middle" x="4159" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="4159" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4159" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4159" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP3_GPU3_moe_res&#45;&gt;L0_S0_TP3_GPU3_norm -->
<g id="edge144" class="edge">
<title>L0_S0_TP3_GPU3_moe_res&#45;&gt;L0_S0_TP3_GPU3_norm</title>
<path fill="none" stroke="black" d="M4159,-368.28C4159,-368.28 4159,-342.46 4159,-342.46"/>
<polygon fill="black" stroke="black" points="4162.5,-342.46 4159,-332.46 4155.5,-342.46 4162.5,-342.46"/>
</g>
<!-- L0_S0_TP4_GPU4_qkv_linear -->
<g id="node66" class="node">
<title>L0_S0_TP4_GPU4_qkv_linear</title>
<polygon fill="none" stroke="black" points="5360,-1614.75 4752,-1614.75 4752,-1546.75 5360,-1546.75 5360,-1614.75"/>
<text text-anchor="middle" x="5056" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="5056" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5056" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="5056" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L0_S0_TP4_GPU4_qkv_slice -->
<g id="node67" class="node">
<title>L0_S0_TP4_GPU4_qkv_slice</title>
<polygon fill="none" stroke="black" points="5354,-1496.67 4758,-1496.67 4758,-1428.67 5354,-1428.67 5354,-1496.67"/>
<text text-anchor="middle" x="5056" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="5056" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="5056" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="5056" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L0_S0_TP4_GPU4_qkv_linear&#45;&gt;L0_S0_TP4_GPU4_qkv_slice -->
<g id="edge145" class="edge">
<title>L0_S0_TP4_GPU4_qkv_linear&#45;&gt;L0_S0_TP4_GPU4_qkv_slice</title>
<path fill="none" stroke="black" d="M5056,-1546.59C5056,-1546.59 5056,-1506.74 5056,-1506.74"/>
<polygon fill="black" stroke="black" points="5059.5,-1506.74 5056,-1496.74 5052.5,-1506.74 5059.5,-1506.74"/>
</g>
<!-- L0_S0_TP4_GPU4_qkv_slice&#45;&gt;L0_S0_TP4_GPU4_attn_v -->
<g id="edge149" class="edge">
<title>L0_S0_TP4_GPU4_qkv_slice&#45;&gt;L0_S0_TP4_GPU4_attn_v</title>
<path fill="none" stroke="black" d="M4803.5,-1428.38C4803.5,-1428.38 4803.5,-1195 4803.5,-1195"/>
<polygon fill="black" stroke="black" points="4807,-1195 4803.5,-1185 4800,-1195 4807,-1195"/>
</g>
<!-- L0_S0_TP4_GPU4_qk_matmul -->
<g id="node68" class="node">
<title>L0_S0_TP4_GPU4_qk_matmul</title>
<polygon fill="none" stroke="black" points="5771.5,-1392.67 4836.5,-1392.67 4836.5,-1324.67 5771.5,-1324.67 5771.5,-1392.67"/>
<text text-anchor="middle" x="5304" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="5304" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="5304" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="5304" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L0_S0_TP4_GPU4_qkv_slice&#45;&gt;L0_S0_TP4_GPU4_qk_matmul -->
<g id="edge146" class="edge">
<title>L0_S0_TP4_GPU4_qkv_slice&#45;&gt;L0_S0_TP4_GPU4_qk_matmul</title>
<path fill="none" stroke="black" d="M5095.25,-1428.61C5095.25,-1428.61 5095.25,-1402.8 5095.25,-1402.8"/>
<polygon fill="black" stroke="black" points="5098.75,-1402.8 5095.25,-1392.8 5091.75,-1402.8 5098.75,-1402.8"/>
</g>
<!-- L0_S0_TP4_GPU4_softmax -->
<g id="node69" class="node">
<title>L0_S0_TP4_GPU4_softmax</title>
<polygon fill="none" stroke="black" points="5453,-1288.67 4943,-1288.67 4943,-1220.67 5453,-1220.67 5453,-1288.67"/>
<text text-anchor="middle" x="5198" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="5198" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="5198" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="5198" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L0_S0_TP4_GPU4_qk_matmul&#45;&gt;L0_S0_TP4_GPU4_softmax -->
<g id="edge147" class="edge">
<title>L0_S0_TP4_GPU4_qk_matmul&#45;&gt;L0_S0_TP4_GPU4_softmax</title>
<path fill="none" stroke="black" d="M5198,-1324.61C5198,-1324.61 5198,-1298.8 5198,-1298.8"/>
<polygon fill="black" stroke="black" points="5201.5,-1298.8 5198,-1288.8 5194.5,-1298.8 5201.5,-1298.8"/>
</g>
<!-- L0_S0_TP4_GPU4_softmax&#45;&gt;L0_S0_TP4_GPU4_attn_v -->
<g id="edge148" class="edge">
<title>L0_S0_TP4_GPU4_softmax&#45;&gt;L0_S0_TP4_GPU4_attn_v</title>
<path fill="none" stroke="black" d="M5198,-1220.61C5198,-1220.61 5198,-1194.8 5198,-1194.8"/>
<polygon fill="black" stroke="black" points="5201.5,-1194.8 5198,-1184.8 5194.5,-1194.8 5201.5,-1194.8"/>
</g>
<!-- L0_S0_TP4_GPU4_mha_res -->
<g id="node71" class="node">
<title>L0_S0_TP4_GPU4_mha_res</title>
<polygon fill="none" stroke="black" points="5597.5,-948.5 4710.5,-948.5 4710.5,-880.5 5597.5,-880.5 5597.5,-948.5"/>
<text text-anchor="middle" x="5154" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="5154" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5154" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5154" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP4_GPU4_mha_ar&#45;&gt;L0_S0_TP4_GPU4_mha_res -->
<g id="edge158" class="edge">
<title>L0_S0_TP4_GPU4_mha_ar&#45;&gt;L0_S0_TP4_GPU4_mha_res</title>
<path fill="none" stroke="black" d="M5042.49,-984.55C5042.49,-984.55 5042.49,-958.73 5042.49,-958.73"/>
<polygon fill="black" stroke="black" points="5045.99,-958.73 5042.49,-948.73 5038.99,-958.73 5045.99,-958.73"/>
</g>
<!-- L0_S0_TP4_GPU4_gate -->
<g id="node72" class="node">
<title>L0_S0_TP4_GPU4_gate</title>
<polygon fill="none" stroke="black" points="5683.56,-844.5 4841.15,-844.5 4624.44,-708.5 5466.85,-708.5 5683.56,-844.5"/>
<text text-anchor="middle" x="5154" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="5154" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5154" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="5154" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L0_S0_TP4_GPU4_mha_res&#45;&gt;L0_S0_TP4_GPU4_gate -->
<g id="edge159" class="edge">
<title>L0_S0_TP4_GPU4_mha_res&#45;&gt;L0_S0_TP4_GPU4_gate</title>
<path fill="none" stroke="black" d="M5154,-880.39C5154,-880.39 5154,-854.73 5154,-854.73"/>
<polygon fill="black" stroke="black" points="5157.5,-854.73 5154,-844.73 5150.5,-854.73 5157.5,-854.73"/>
</g>
<!-- L0_S0_TP4_GPU4_moe_res -->
<g id="node74" class="node">
<title>L0_S0_TP4_GPU4_moe_res</title>
<polygon fill="none" stroke="black" points="6213,-436.33 5393,-436.33 5393,-368.33 6213,-368.33 6213,-436.33"/>
<text text-anchor="middle" x="5803" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="5803" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5803" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5803" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP4_GPU4_mha_res&#45;&gt;L0_S0_TP4_GPU4_moe_res -->
<g id="edge179" class="edge">
<title>L0_S0_TP4_GPU4_mha_res&#45;&gt;L0_S0_TP4_GPU4_moe_res</title>
<path fill="none" stroke="black" d="M4710.38,-925C4657.35,-925 4621.56,-925 4621.56,-925 4621.56,-925 4621.56,-600 4621.56,-600 4621.56,-600 5269.02,-600 5269.02,-600 5269.02,-600 5269.02,-419 5269.02,-419 5269.02,-419 5382.87,-419 5382.87,-419"/>
<polygon fill="black" stroke="black" points="5382.87,-422.5 5392.87,-419 5382.87,-415.5 5382.87,-422.5"/>
</g>
<!-- L0_S0_TP4_GPU4_gate&#45;&gt;L0_S0_TP4_GPU4_expert0 -->
<g id="edge160" class="edge">
<title>L0_S0_TP4_GPU4_gate&#45;&gt;L0_S0_TP4_GPU4_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4923.07,-708.31C4923.07,-708.31 4923.07,-682.71 4923.07,-682.71"/>
<polygon fill="black" stroke="black" points="4926.57,-682.71 4923.07,-672.71 4919.57,-682.71 4926.57,-682.71"/>
</g>
<!-- L0_S0_TP4_GPU4_gate&#45;&gt;L0_S0_TP4_GPU4_expert1 -->
<g id="edge161" class="edge">
<title>L0_S0_TP4_GPU4_gate&#45;&gt;L0_S0_TP4_GPU4_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5315,-708.31C5315,-708.31 5315,-682.71 5315,-682.71"/>
<polygon fill="black" stroke="black" points="5318.5,-682.71 5315,-672.71 5311.5,-682.71 5318.5,-682.71"/>
</g>
<!-- L0_S0_TP4_GPU4_moe_ar&#45;&gt;L0_S0_TP4_GPU4_moe_res -->
<g id="edge178" class="edge">
<title>L0_S0_TP4_GPU4_moe_ar&#45;&gt;L0_S0_TP4_GPU4_moe_res</title>
<path fill="none" stroke="black" d="M5088.23,-478.67C5088.23,-444.57 5088.23,-402 5088.23,-402 5088.23,-402 5382.91,-402 5382.91,-402"/>
<polygon fill="black" stroke="black" points="5382.91,-405.5 5392.91,-402 5382.91,-398.5 5382.91,-405.5"/>
</g>
<!-- L0_S0_TP4_GPU4_norm -->
<g id="node75" class="node">
<title>L0_S0_TP4_GPU4_norm</title>
<polygon fill="none" stroke="black" points="6027.5,-332.33 5578.5,-332.33 5578.5,-264.33 6027.5,-264.33 6027.5,-332.33"/>
<text text-anchor="middle" x="5803" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5803" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5803" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5803" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP4_GPU4_moe_res&#45;&gt;L0_S0_TP4_GPU4_norm -->
<g id="edge180" class="edge">
<title>L0_S0_TP4_GPU4_moe_res&#45;&gt;L0_S0_TP4_GPU4_norm</title>
<path fill="none" stroke="black" d="M5803,-368.28C5803,-368.28 5803,-342.46 5803,-342.46"/>
<polygon fill="black" stroke="black" points="5806.5,-342.46 5803,-332.46 5799.5,-342.46 5806.5,-342.46"/>
</g>
<!-- L0_S0_TP5_GPU5_qkv_linear -->
<g id="node76" class="node">
<title>L0_S0_TP5_GPU5_qkv_linear</title>
<polygon fill="none" stroke="black" points="6504,-1614.75 5896,-1614.75 5896,-1546.75 6504,-1546.75 6504,-1614.75"/>
<text text-anchor="middle" x="6200" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="6200" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6200" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="6200" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L0_S0_TP5_GPU5_qkv_slice -->
<g id="node77" class="node">
<title>L0_S0_TP5_GPU5_qkv_slice</title>
<polygon fill="none" stroke="black" points="6498,-1496.67 5902,-1496.67 5902,-1428.67 6498,-1428.67 6498,-1496.67"/>
<text text-anchor="middle" x="6200" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="6200" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="6200" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="6200" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L0_S0_TP5_GPU5_qkv_linear&#45;&gt;L0_S0_TP5_GPU5_qkv_slice -->
<g id="edge181" class="edge">
<title>L0_S0_TP5_GPU5_qkv_linear&#45;&gt;L0_S0_TP5_GPU5_qkv_slice</title>
<path fill="none" stroke="black" d="M6200,-1546.59C6200,-1546.59 6200,-1506.74 6200,-1506.74"/>
<polygon fill="black" stroke="black" points="6203.5,-1506.74 6200,-1496.74 6196.5,-1506.74 6203.5,-1506.74"/>
</g>
<!-- L0_S0_TP5_GPU5_qkv_slice&#45;&gt;L0_S0_TP5_GPU5_attn_v -->
<g id="edge185" class="edge">
<title>L0_S0_TP5_GPU5_qkv_slice&#45;&gt;L0_S0_TP5_GPU5_attn_v</title>
<path fill="none" stroke="black" d="M5901.79,-1462C5850.32,-1462 5813,-1462 5813,-1462 5813,-1462 5813,-1194.87 5813,-1194.87"/>
<polygon fill="black" stroke="black" points="5816.5,-1194.87 5813,-1184.87 5809.5,-1194.87 5816.5,-1194.87"/>
</g>
<!-- L0_S0_TP5_GPU5_qk_matmul -->
<g id="node78" class="node">
<title>L0_S0_TP5_GPU5_qk_matmul</title>
<polygon fill="none" stroke="black" points="6789.5,-1392.67 5854.5,-1392.67 5854.5,-1324.67 6789.5,-1324.67 6789.5,-1392.67"/>
<text text-anchor="middle" x="6322" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="6322" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="6322" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="6322" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L0_S0_TP5_GPU5_qkv_slice&#45;&gt;L0_S0_TP5_GPU5_qk_matmul -->
<g id="edge182" class="edge">
<title>L0_S0_TP5_GPU5_qkv_slice&#45;&gt;L0_S0_TP5_GPU5_qk_matmul</title>
<path fill="none" stroke="black" d="M6200,-1428.61C6200,-1428.61 6200,-1402.8 6200,-1402.8"/>
<polygon fill="black" stroke="black" points="6203.5,-1402.8 6200,-1392.8 6196.5,-1402.8 6203.5,-1402.8"/>
</g>
<!-- L0_S0_TP5_GPU5_softmax -->
<g id="node79" class="node">
<title>L0_S0_TP5_GPU5_softmax</title>
<polygon fill="none" stroke="black" points="6471,-1288.67 5961,-1288.67 5961,-1220.67 6471,-1220.67 6471,-1288.67"/>
<text text-anchor="middle" x="6216" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="6216" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="6216" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="6216" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L0_S0_TP5_GPU5_qk_matmul&#45;&gt;L0_S0_TP5_GPU5_softmax -->
<g id="edge183" class="edge">
<title>L0_S0_TP5_GPU5_qk_matmul&#45;&gt;L0_S0_TP5_GPU5_softmax</title>
<path fill="none" stroke="black" d="M6216,-1324.61C6216,-1324.61 6216,-1298.8 6216,-1298.8"/>
<polygon fill="black" stroke="black" points="6219.5,-1298.8 6216,-1288.8 6212.5,-1298.8 6219.5,-1298.8"/>
</g>
<!-- L0_S0_TP5_GPU5_softmax&#45;&gt;L0_S0_TP5_GPU5_attn_v -->
<g id="edge184" class="edge">
<title>L0_S0_TP5_GPU5_softmax&#45;&gt;L0_S0_TP5_GPU5_attn_v</title>
<path fill="none" stroke="black" d="M6216,-1220.61C6216,-1220.61 6216,-1194.8 6216,-1194.8"/>
<polygon fill="black" stroke="black" points="6219.5,-1194.8 6216,-1184.8 6212.5,-1194.8 6219.5,-1194.8"/>
</g>
<!-- L0_S0_TP5_GPU5_mha_res -->
<g id="node81" class="node">
<title>L0_S0_TP5_GPU5_mha_res</title>
<polygon fill="none" stroke="black" points="6675.5,-948.5 5788.5,-948.5 5788.5,-880.5 6675.5,-880.5 6675.5,-948.5"/>
<text text-anchor="middle" x="6232" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="6232" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6232" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6232" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP5_GPU5_mha_ar&#45;&gt;L0_S0_TP5_GPU5_mha_res -->
<g id="edge194" class="edge">
<title>L0_S0_TP5_GPU5_mha_ar&#45;&gt;L0_S0_TP5_GPU5_mha_res</title>
<path fill="none" stroke="black" d="M5965.99,-991.61C5965.99,-991.61 5965.99,-958.74 5965.99,-958.74"/>
<polygon fill="black" stroke="black" points="5969.49,-958.74 5965.99,-948.74 5962.49,-958.74 5969.49,-958.74"/>
</g>
<!-- L0_S0_TP5_GPU5_gate -->
<g id="node82" class="node">
<title>L0_S0_TP5_GPU5_gate</title>
<polygon fill="none" stroke="black" points="6761.56,-844.5 5919.15,-844.5 5702.44,-708.5 6544.85,-708.5 6761.56,-844.5"/>
<text text-anchor="middle" x="6232" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="6232" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6232" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="6232" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L0_S0_TP5_GPU5_mha_res&#45;&gt;L0_S0_TP5_GPU5_gate -->
<g id="edge195" class="edge">
<title>L0_S0_TP5_GPU5_mha_res&#45;&gt;L0_S0_TP5_GPU5_gate</title>
<path fill="none" stroke="black" d="M6232,-880.39C6232,-880.39 6232,-854.73 6232,-854.73"/>
<polygon fill="black" stroke="black" points="6235.5,-854.73 6232,-844.73 6228.5,-854.73 6235.5,-854.73"/>
</g>
<!-- L0_S0_TP5_GPU5_moe_res -->
<g id="node84" class="node">
<title>L0_S0_TP5_GPU5_moe_res</title>
<polygon fill="none" stroke="black" points="7098,-436.33 6278,-436.33 6278,-368.33 7098,-368.33 7098,-436.33"/>
<text text-anchor="middle" x="6688" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="6688" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6688" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6688" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP5_GPU5_mha_res&#45;&gt;L0_S0_TP5_GPU5_moe_res -->
<g id="edge215" class="edge">
<title>L0_S0_TP5_GPU5_mha_res&#45;&gt;L0_S0_TP5_GPU5_moe_res</title>
<path fill="none" stroke="black" d="M6675.57,-914C6732.27,-914 6771,-914 6771,-914 6771,-914 6771,-692 6771,-692 6771,-692 6482.5,-692 6482.5,-692 6482.5,-692 6482.5,-600 6482.5,-600 6482.5,-600 6643.02,-600 6643.02,-600 6643.02,-600 6643.02,-446.76 6643.02,-446.76"/>
<polygon fill="black" stroke="black" points="6646.52,-446.76 6643.02,-436.76 6639.52,-446.76 6646.52,-446.76"/>
</g>
<!-- L0_S0_TP5_GPU5_gate&#45;&gt;L0_S0_TP5_GPU5_expert0 -->
<g id="edge196" class="edge">
<title>L0_S0_TP5_GPU5_gate&#45;&gt;L0_S0_TP5_GPU5_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5854.36,-708.31C5854.36,-708.31 5854.36,-682.71 5854.36,-682.71"/>
<polygon fill="black" stroke="black" points="5857.86,-682.71 5854.36,-672.71 5850.86,-682.71 5857.86,-682.71"/>
</g>
<!-- L0_S0_TP5_GPU5_gate&#45;&gt;L0_S0_TP5_GPU5_expert1 -->
<g id="edge197" class="edge">
<title>L0_S0_TP5_GPU5_gate&#45;&gt;L0_S0_TP5_GPU5_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6323.83,-708.31C6323.83,-708.31 6323.83,-682.71 6323.83,-682.71"/>
<polygon fill="black" stroke="black" points="6327.33,-682.71 6323.83,-672.71 6320.33,-682.71 6327.33,-682.71"/>
</g>
<!-- L0_S0_TP5_GPU5_moe_ar&#45;&gt;L0_S0_TP5_GPU5_moe_res -->
<g id="edge214" class="edge">
<title>L0_S0_TP5_GPU5_moe_ar&#45;&gt;L0_S0_TP5_GPU5_moe_res</title>
<path fill="none" stroke="black" d="M5759.31,-477.22C5759.31,-456.45 5759.31,-436 5759.31,-436 5759.31,-436 6267.79,-436 6267.79,-436"/>
<polygon fill="black" stroke="black" points="6267.79,-439.5 6277.79,-436 6267.79,-432.5 6267.79,-439.5"/>
</g>
<!-- L0_S0_TP5_GPU5_norm -->
<g id="node85" class="node">
<title>L0_S0_TP5_GPU5_norm</title>
<polygon fill="none" stroke="black" points="6912.5,-332.33 6463.5,-332.33 6463.5,-264.33 6912.5,-264.33 6912.5,-332.33"/>
<text text-anchor="middle" x="6688" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="6688" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6688" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6688" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP5_GPU5_moe_res&#45;&gt;L0_S0_TP5_GPU5_norm -->
<g id="edge216" class="edge">
<title>L0_S0_TP5_GPU5_moe_res&#45;&gt;L0_S0_TP5_GPU5_norm</title>
<path fill="none" stroke="black" d="M6688,-368.28C6688,-368.28 6688,-342.46 6688,-342.46"/>
<polygon fill="black" stroke="black" points="6691.5,-342.46 6688,-332.46 6684.5,-342.46 6691.5,-342.46"/>
</g>
<!-- L0_S0_TP6_GPU6_qkv_linear -->
<g id="node86" class="node">
<title>L0_S0_TP6_GPU6_qkv_linear</title>
<polygon fill="none" stroke="black" points="7310,-1614.75 6702,-1614.75 6702,-1546.75 7310,-1546.75 7310,-1614.75"/>
<text text-anchor="middle" x="7006" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="7006" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="7006" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="7006" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L0_S0_TP6_GPU6_qkv_slice -->
<g id="node87" class="node">
<title>L0_S0_TP6_GPU6_qkv_slice</title>
<polygon fill="none" stroke="black" points="7304,-1496.67 6708,-1496.67 6708,-1428.67 7304,-1428.67 7304,-1496.67"/>
<text text-anchor="middle" x="7006" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="7006" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="7006" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="7006" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L0_S0_TP6_GPU6_qkv_linear&#45;&gt;L0_S0_TP6_GPU6_qkv_slice -->
<g id="edge217" class="edge">
<title>L0_S0_TP6_GPU6_qkv_linear&#45;&gt;L0_S0_TP6_GPU6_qkv_slice</title>
<path fill="none" stroke="black" d="M7006,-1546.59C7006,-1546.59 7006,-1506.74 7006,-1506.74"/>
<polygon fill="black" stroke="black" points="7009.5,-1506.74 7006,-1496.74 7002.5,-1506.74 7009.5,-1506.74"/>
</g>
<!-- L0_S0_TP6_GPU6_qkv_slice&#45;&gt;L0_S0_TP6_GPU6_attn_v -->
<g id="edge221" class="edge">
<title>L0_S0_TP6_GPU6_qkv_slice&#45;&gt;L0_S0_TP6_GPU6_attn_v</title>
<path fill="none" stroke="black" d="M6850.5,-1428.38C6850.5,-1428.38 6850.5,-1195 6850.5,-1195"/>
<polygon fill="black" stroke="black" points="6854,-1195 6850.5,-1185 6847,-1195 6854,-1195"/>
</g>
<!-- L0_S0_TP6_GPU6_qk_matmul -->
<g id="node88" class="node">
<title>L0_S0_TP6_GPU6_qk_matmul</title>
<polygon fill="none" stroke="black" points="7846.5,-1392.67 6911.5,-1392.67 6911.5,-1324.67 7846.5,-1324.67 7846.5,-1392.67"/>
<text text-anchor="middle" x="7379" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="7379" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="7379" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="7379" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L0_S0_TP6_GPU6_qkv_slice&#45;&gt;L0_S0_TP6_GPU6_qk_matmul -->
<g id="edge218" class="edge">
<title>L0_S0_TP6_GPU6_qkv_slice&#45;&gt;L0_S0_TP6_GPU6_qk_matmul</title>
<path fill="none" stroke="black" d="M7107.75,-1428.61C7107.75,-1428.61 7107.75,-1402.8 7107.75,-1402.8"/>
<polygon fill="black" stroke="black" points="7111.25,-1402.8 7107.75,-1392.8 7104.25,-1402.8 7111.25,-1402.8"/>
</g>
<!-- L0_S0_TP6_GPU6_softmax -->
<g id="node89" class="node">
<title>L0_S0_TP6_GPU6_softmax</title>
<polygon fill="none" stroke="black" points="7527,-1288.67 7017,-1288.67 7017,-1220.67 7527,-1220.67 7527,-1288.67"/>
<text text-anchor="middle" x="7272" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="7272" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="7272" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="7272" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L0_S0_TP6_GPU6_qk_matmul&#45;&gt;L0_S0_TP6_GPU6_softmax -->
<g id="edge219" class="edge">
<title>L0_S0_TP6_GPU6_qk_matmul&#45;&gt;L0_S0_TP6_GPU6_softmax</title>
<path fill="none" stroke="black" d="M7272,-1324.61C7272,-1324.61 7272,-1298.8 7272,-1298.8"/>
<polygon fill="black" stroke="black" points="7275.5,-1298.8 7272,-1288.8 7268.5,-1298.8 7275.5,-1298.8"/>
</g>
<!-- L0_S0_TP6_GPU6_softmax&#45;&gt;L0_S0_TP6_GPU6_attn_v -->
<g id="edge220" class="edge">
<title>L0_S0_TP6_GPU6_softmax&#45;&gt;L0_S0_TP6_GPU6_attn_v</title>
<path fill="none" stroke="black" d="M7245.5,-1220.61C7245.5,-1220.61 7245.5,-1194.8 7245.5,-1194.8"/>
<polygon fill="black" stroke="black" points="7249,-1194.8 7245.5,-1184.8 7242,-1194.8 7249,-1194.8"/>
</g>
<!-- L0_S0_TP6_GPU6_mha_res -->
<g id="node91" class="node">
<title>L0_S0_TP6_GPU6_mha_res</title>
<polygon fill="none" stroke="black" points="7753.5,-948.5 6866.5,-948.5 6866.5,-880.5 7753.5,-880.5 7753.5,-948.5"/>
<text text-anchor="middle" x="7310" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="7310" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="7310" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="7310" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP6_GPU6_mha_ar&#45;&gt;L0_S0_TP6_GPU6_mha_res -->
<g id="edge230" class="edge">
<title>L0_S0_TP6_GPU6_mha_ar&#45;&gt;L0_S0_TP6_GPU6_mha_res</title>
<path fill="none" stroke="black" d="M6889.49,-1015.91C6889.49,-1015.91 6889.49,-958.58 6889.49,-958.58"/>
<polygon fill="black" stroke="black" points="6892.99,-958.58 6889.49,-948.58 6885.99,-958.58 6892.99,-958.58"/>
</g>
<!-- L0_S0_TP6_GPU6_gate -->
<g id="node92" class="node">
<title>L0_S0_TP6_GPU6_gate</title>
<polygon fill="none" stroke="black" points="7839.56,-844.5 6997.15,-844.5 6780.44,-708.5 7622.85,-708.5 7839.56,-844.5"/>
<text text-anchor="middle" x="7310" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="7310" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="7310" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="7310" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L0_S0_TP6_GPU6_mha_res&#45;&gt;L0_S0_TP6_GPU6_gate -->
<g id="edge231" class="edge">
<title>L0_S0_TP6_GPU6_mha_res&#45;&gt;L0_S0_TP6_GPU6_gate</title>
<path fill="none" stroke="black" d="M7310,-880.39C7310,-880.39 7310,-854.73 7310,-854.73"/>
<polygon fill="black" stroke="black" points="7313.5,-854.73 7310,-844.73 7306.5,-854.73 7313.5,-854.73"/>
</g>
<!-- L0_S0_TP6_GPU6_moe_res -->
<g id="node94" class="node">
<title>L0_S0_TP6_GPU6_moe_res</title>
<polygon fill="none" stroke="black" points="8339,-436.33 7519,-436.33 7519,-368.33 8339,-368.33 8339,-436.33"/>
<text text-anchor="middle" x="7929" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="7929" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="7929" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="7929" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP6_GPU6_mha_res&#45;&gt;L0_S0_TP6_GPU6_moe_res -->
<g id="edge251" class="edge">
<title>L0_S0_TP6_GPU6_mha_res&#45;&gt;L0_S0_TP6_GPU6_moe_res</title>
<path fill="none" stroke="black" d="M7753.57,-914C7810.27,-914 7849,-914 7849,-914 7849,-914 7849,-695 7849,-695 7849,-695 7883.5,-695 7883.5,-695 7883.5,-695 7883.5,-446.48 7883.5,-446.48"/>
<polygon fill="black" stroke="black" points="7887,-446.48 7883.5,-436.48 7880,-446.48 7887,-446.48"/>
</g>
<!-- L0_S0_TP6_GPU6_gate&#45;&gt;L0_S0_TP6_GPU6_expert0 -->
<g id="edge232" class="edge">
<title>L0_S0_TP6_GPU6_gate&#45;&gt;L0_S0_TP6_GPU6_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6860.36,-708.31C6860.36,-708.31 6860.36,-682.71 6860.36,-682.71"/>
<polygon fill="black" stroke="black" points="6863.86,-682.71 6860.36,-672.71 6856.86,-682.71 6863.86,-682.71"/>
</g>
<!-- L0_S0_TP6_GPU6_gate&#45;&gt;L0_S0_TP6_GPU6_expert1 -->
<g id="edge233" class="edge">
<title>L0_S0_TP6_GPU6_gate&#45;&gt;L0_S0_TP6_GPU6_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7295.25,-708.31C7295.25,-708.31 7295.25,-682.71 7295.25,-682.71"/>
<polygon fill="black" stroke="black" points="7298.75,-682.71 7295.25,-672.71 7291.75,-682.71 7298.75,-682.71"/>
</g>
<!-- L0_S0_TP6_GPU6_moe_ar&#45;&gt;L0_S0_TP6_GPU6_moe_res -->
<g id="edge250" class="edge">
<title>L0_S0_TP6_GPU6_moe_ar&#45;&gt;L0_S0_TP6_GPU6_moe_res</title>
<path fill="none" stroke="black" d="M6512.31,-483.55C6512.31,-461.6 6512.31,-438 6512.31,-438 6512.31,-438 7696.75,-438 7696.75,-438 7696.75,-438 7696.75,-437.85 7696.75,-437.85"/>
<polygon fill="black" stroke="black" points="7700.25,-446.47 7696.75,-436.47 7693.25,-446.47 7700.25,-446.47"/>
</g>
<!-- L0_S0_TP6_GPU6_norm -->
<g id="node95" class="node">
<title>L0_S0_TP6_GPU6_norm</title>
<polygon fill="none" stroke="black" points="8153.5,-332.33 7704.5,-332.33 7704.5,-264.33 8153.5,-264.33 8153.5,-332.33"/>
<text text-anchor="middle" x="7929" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="7929" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="7929" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="7929" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP6_GPU6_moe_res&#45;&gt;L0_S0_TP6_GPU6_norm -->
<g id="edge252" class="edge">
<title>L0_S0_TP6_GPU6_moe_res&#45;&gt;L0_S0_TP6_GPU6_norm</title>
<path fill="none" stroke="black" d="M7929,-368.28C7929,-368.28 7929,-342.46 7929,-342.46"/>
<polygon fill="black" stroke="black" points="7932.5,-342.46 7929,-332.46 7925.5,-342.46 7932.5,-342.46"/>
</g>
<!-- L0_S0_TP7_GPU7_qkv_linear -->
<g id="node96" class="node">
<title>L0_S0_TP7_GPU7_qkv_linear</title>
<polygon fill="none" stroke="black" points="8486,-1614.75 7878,-1614.75 7878,-1546.75 8486,-1546.75 8486,-1614.75"/>
<text text-anchor="middle" x="8182" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="8182" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="8182" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="8182" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L0_S0_TP7_GPU7_qkv_slice -->
<g id="node97" class="node">
<title>L0_S0_TP7_GPU7_qkv_slice</title>
<polygon fill="none" stroke="black" points="8480,-1496.67 7884,-1496.67 7884,-1428.67 8480,-1428.67 8480,-1496.67"/>
<text text-anchor="middle" x="8182" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="8182" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="8182" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="8182" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L0_S0_TP7_GPU7_qkv_linear&#45;&gt;L0_S0_TP7_GPU7_qkv_slice -->
<g id="edge253" class="edge">
<title>L0_S0_TP7_GPU7_qkv_linear&#45;&gt;L0_S0_TP7_GPU7_qkv_slice</title>
<path fill="none" stroke="black" d="M8182,-1546.59C8182,-1546.59 8182,-1506.74 8182,-1506.74"/>
<polygon fill="black" stroke="black" points="8185.5,-1506.74 8182,-1496.74 8178.5,-1506.74 8185.5,-1506.74"/>
</g>
<!-- L0_S0_TP7_GPU7_qkv_slice&#45;&gt;L0_S0_TP7_GPU7_attn_v -->
<g id="edge257" class="edge">
<title>L0_S0_TP7_GPU7_qkv_slice&#45;&gt;L0_S0_TP7_GPU7_attn_v</title>
<path fill="none" stroke="black" d="M7923.25,-1428.38C7923.25,-1428.38 7923.25,-1195 7923.25,-1195"/>
<polygon fill="black" stroke="black" points="7926.75,-1195 7923.25,-1185 7919.75,-1195 7926.75,-1195"/>
</g>
<!-- L0_S0_TP7_GPU7_qk_matmul -->
<g id="node98" class="node">
<title>L0_S0_TP7_GPU7_qk_matmul</title>
<polygon fill="none" stroke="black" points="8897.5,-1392.67 7962.5,-1392.67 7962.5,-1324.67 8897.5,-1324.67 8897.5,-1392.67"/>
<text text-anchor="middle" x="8430" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="8430" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="8430" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="8430" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L0_S0_TP7_GPU7_qkv_slice&#45;&gt;L0_S0_TP7_GPU7_qk_matmul -->
<g id="edge254" class="edge">
<title>L0_S0_TP7_GPU7_qkv_slice&#45;&gt;L0_S0_TP7_GPU7_qk_matmul</title>
<path fill="none" stroke="black" d="M8221.25,-1428.61C8221.25,-1428.61 8221.25,-1402.8 8221.25,-1402.8"/>
<polygon fill="black" stroke="black" points="8224.75,-1402.8 8221.25,-1392.8 8217.75,-1402.8 8224.75,-1402.8"/>
</g>
<!-- L0_S0_TP7_GPU7_softmax -->
<g id="node99" class="node">
<title>L0_S0_TP7_GPU7_softmax</title>
<polygon fill="none" stroke="black" points="8578,-1288.67 8068,-1288.67 8068,-1220.67 8578,-1220.67 8578,-1288.67"/>
<text text-anchor="middle" x="8323" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="8323" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="8323" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="8323" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L0_S0_TP7_GPU7_qk_matmul&#45;&gt;L0_S0_TP7_GPU7_softmax -->
<g id="edge255" class="edge">
<title>L0_S0_TP7_GPU7_qk_matmul&#45;&gt;L0_S0_TP7_GPU7_softmax</title>
<path fill="none" stroke="black" d="M8323,-1324.61C8323,-1324.61 8323,-1298.8 8323,-1298.8"/>
<polygon fill="black" stroke="black" points="8326.5,-1298.8 8323,-1288.8 8319.5,-1298.8 8326.5,-1298.8"/>
</g>
<!-- L0_S0_TP7_GPU7_softmax&#45;&gt;L0_S0_TP7_GPU7_attn_v -->
<g id="edge256" class="edge">
<title>L0_S0_TP7_GPU7_softmax&#45;&gt;L0_S0_TP7_GPU7_attn_v</title>
<path fill="none" stroke="black" d="M8249,-1220.61C8249,-1220.61 8249,-1194.8 8249,-1194.8"/>
<polygon fill="black" stroke="black" points="8252.5,-1194.8 8249,-1184.8 8245.5,-1194.8 8252.5,-1194.8"/>
</g>
<!-- L0_S0_TP7_GPU7_mha_res -->
<g id="node101" class="node">
<title>L0_S0_TP7_GPU7_mha_res</title>
<polygon fill="none" stroke="black" points="8831.5,-948.5 7944.5,-948.5 7944.5,-880.5 8831.5,-880.5 8831.5,-948.5"/>
<text text-anchor="middle" x="8388" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="8388" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="8388" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="8388" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP7_GPU7_mha_ar&#45;&gt;L0_S0_TP7_GPU7_mha_res -->
<g id="edge266" class="edge">
<title>L0_S0_TP7_GPU7_mha_ar&#45;&gt;L0_S0_TP7_GPU7_mha_res</title>
<path fill="none" stroke="black" d="M7658.73,-1016C7904.04,-1016 8187.25,-1016 8187.25,-1016 8187.25,-1016 8187.25,-958.58 8187.25,-958.58"/>
<polygon fill="black" stroke="black" points="8190.75,-958.58 8187.25,-948.58 8183.75,-958.58 8190.75,-958.58"/>
</g>
<!-- L0_S0_TP7_GPU7_gate -->
<g id="node102" class="node">
<title>L0_S0_TP7_GPU7_gate</title>
<polygon fill="none" stroke="black" points="8917.56,-844.5 8075.15,-844.5 7858.44,-708.5 8700.85,-708.5 8917.56,-844.5"/>
<text text-anchor="middle" x="8388" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="8388" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="8388" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="8388" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L0_S0_TP7_GPU7_mha_res&#45;&gt;L0_S0_TP7_GPU7_gate -->
<g id="edge267" class="edge">
<title>L0_S0_TP7_GPU7_mha_res&#45;&gt;L0_S0_TP7_GPU7_gate</title>
<path fill="none" stroke="black" d="M8388,-880.39C8388,-880.39 8388,-854.73 8388,-854.73"/>
<polygon fill="black" stroke="black" points="8391.5,-854.73 8388,-844.73 8384.5,-854.73 8391.5,-854.73"/>
</g>
<!-- L0_S0_TP7_GPU7_moe_res -->
<g id="node104" class="node">
<title>L0_S0_TP7_GPU7_moe_res</title>
<polygon fill="none" stroke="black" points="9378,-436.33 8558,-436.33 8558,-368.33 9378,-368.33 9378,-436.33"/>
<text text-anchor="middle" x="8968" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="8968" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="8968" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="8968" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP7_GPU7_mha_res&#45;&gt;L0_S0_TP7_GPU7_moe_res -->
<g id="edge287" class="edge">
<title>L0_S0_TP7_GPU7_mha_res&#45;&gt;L0_S0_TP7_GPU7_moe_res</title>
<path fill="none" stroke="black" d="M8831.97,-914C8966.32,-914 9079,-914 9079,-914 9079,-914 9079,-446.7 9079,-446.7"/>
<polygon fill="black" stroke="black" points="9082.5,-446.7 9079,-436.7 9075.5,-446.7 9082.5,-446.7"/>
</g>
<!-- L0_S0_TP7_GPU7_gate&#45;&gt;L0_S0_TP7_GPU7_expert0 -->
<g id="edge268" class="edge">
<title>L0_S0_TP7_GPU7_gate&#45;&gt;L0_S0_TP7_GPU7_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7866.36,-776.4C7866.36,-776.4 7866.36,-682.74 7866.36,-682.74"/>
<polygon fill="black" stroke="black" points="7869.86,-682.74 7866.36,-672.74 7862.86,-682.74 7869.86,-682.74"/>
</g>
<!-- L0_S0_TP7_GPU7_gate&#45;&gt;L0_S0_TP7_GPU7_expert1 -->
<g id="edge269" class="edge">
<title>L0_S0_TP7_GPU7_gate&#45;&gt;L0_S0_TP7_GPU7_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8191.83,-708.31C8191.83,-708.31 8191.83,-682.71 8191.83,-682.71"/>
<polygon fill="black" stroke="black" points="8195.33,-682.71 8191.83,-672.71 8188.33,-682.71 8195.33,-682.71"/>
</g>
<!-- L0_S0_TP7_GPU7_moe_ar&#45;&gt;L0_S0_TP7_GPU7_moe_res -->
<g id="edge286" class="edge">
<title>L0_S0_TP7_GPU7_moe_ar&#45;&gt;L0_S0_TP7_GPU7_moe_res</title>
<path fill="none" stroke="black" d="M7313.56,-527C7822.46,-527 8737.89,-527 8737.89,-527 8737.89,-527 8737.89,-446.4 8737.89,-446.4"/>
<polygon fill="black" stroke="black" points="8741.39,-446.4 8737.89,-436.4 8734.39,-446.4 8741.39,-446.4"/>
</g>
<!-- L0_S0_TP7_GPU7_norm -->
<g id="node105" class="node">
<title>L0_S0_TP7_GPU7_norm</title>
<polygon fill="none" stroke="black" points="9192.5,-332.33 8743.5,-332.33 8743.5,-264.33 9192.5,-264.33 9192.5,-332.33"/>
<text text-anchor="middle" x="8968" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="8968" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="8968" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="8968" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L0_S0_TP7_GPU7_moe_res&#45;&gt;L0_S0_TP7_GPU7_norm -->
<g id="edge288" class="edge">
<title>L0_S0_TP7_GPU7_moe_res&#45;&gt;L0_S0_TP7_GPU7_norm</title>
<path fill="none" stroke="black" d="M8968,-368.28C8968,-368.28 8968,-342.46 8968,-342.46"/>
<polygon fill="black" stroke="black" points="8971.5,-342.46 8968,-332.46 8964.5,-342.46 8971.5,-342.46"/>
</g>
<!-- L1_S0_TP0_GPU0_qkv_linear -->
<g id="node106" class="node">
<title>L1_S0_TP0_GPU0_qkv_linear</title>
<polygon fill="none" stroke="black" points="10352,-1614.75 9744,-1614.75 9744,-1546.75 10352,-1546.75 10352,-1614.75"/>
<text text-anchor="middle" x="10048" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="10048" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="10048" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="10048" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L1_S0_TP0_GPU0_qkv_slice -->
<g id="node107" class="node">
<title>L1_S0_TP0_GPU0_qkv_slice</title>
<polygon fill="none" stroke="black" points="10346,-1496.67 9750,-1496.67 9750,-1428.67 10346,-1428.67 10346,-1496.67"/>
<text text-anchor="middle" x="10048" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="10048" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="10048" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="10048" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L1_S0_TP0_GPU0_qkv_linear&#45;&gt;L1_S0_TP0_GPU0_qkv_slice -->
<g id="edge289" class="edge">
<title>L1_S0_TP0_GPU0_qkv_linear&#45;&gt;L1_S0_TP0_GPU0_qkv_slice</title>
<path fill="none" stroke="black" d="M10048,-1546.59C10048,-1546.59 10048,-1506.74 10048,-1506.74"/>
<polygon fill="black" stroke="black" points="10051.5,-1506.74 10048,-1496.74 10044.5,-1506.74 10051.5,-1506.74"/>
</g>
<!-- L1_S0_TP0_GPU0_qk_matmul -->
<g id="node108" class="node">
<title>L1_S0_TP0_GPU0_qk_matmul</title>
<polygon fill="none" stroke="black" points="10668.5,-1392.67 9733.5,-1392.67 9733.5,-1324.67 10668.5,-1324.67 10668.5,-1392.67"/>
<text text-anchor="middle" x="10201" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="10201" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="10201" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="10201" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L1_S0_TP0_GPU0_qkv_slice&#45;&gt;L1_S0_TP0_GPU0_qk_matmul -->
<g id="edge290" class="edge">
<title>L1_S0_TP0_GPU0_qkv_slice&#45;&gt;L1_S0_TP0_GPU0_qk_matmul</title>
<path fill="none" stroke="black" d="M10048,-1428.61C10048,-1428.61 10048,-1402.8 10048,-1402.8"/>
<polygon fill="black" stroke="black" points="10051.5,-1402.8 10048,-1392.8 10044.5,-1402.8 10051.5,-1402.8"/>
</g>
<!-- L1_S0_TP0_GPU0_attn_v -->
<g id="node110" class="node">
<title>L1_S0_TP0_GPU0_attn_v</title>
<polygon fill="none" stroke="black" points="10667,-1184.67 9729,-1184.67 9729,-1116.67 10667,-1116.67 10667,-1184.67"/>
<text text-anchor="middle" x="10198" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="10198" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="10198" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="10198" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L1_S0_TP0_GPU0_qkv_slice&#45;&gt;L1_S0_TP0_GPU0_attn_v -->
<g id="edge293" class="edge">
<title>L1_S0_TP0_GPU0_qkv_slice&#45;&gt;L1_S0_TP0_GPU0_attn_v</title>
<path fill="none" stroke="black" d="M9749.89,-1462C9633.65,-1462 9527.75,-1462 9527.75,-1462 9527.75,-1462 9527.75,-1150 9527.75,-1150 9527.75,-1150 9718.85,-1150 9718.85,-1150"/>
<polygon fill="black" stroke="black" points="9718.85,-1153.5 9728.85,-1150 9718.85,-1146.5 9718.85,-1153.5"/>
</g>
<!-- L1_S0_TP0_GPU0_softmax -->
<g id="node109" class="node">
<title>L1_S0_TP0_GPU0_softmax</title>
<polygon fill="none" stroke="black" points="10454,-1288.67 9944,-1288.67 9944,-1220.67 10454,-1220.67 10454,-1288.67"/>
<text text-anchor="middle" x="10199" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="10199" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="10199" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="10199" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L1_S0_TP0_GPU0_qk_matmul&#45;&gt;L1_S0_TP0_GPU0_softmax -->
<g id="edge291" class="edge">
<title>L1_S0_TP0_GPU0_qk_matmul&#45;&gt;L1_S0_TP0_GPU0_softmax</title>
<path fill="none" stroke="black" d="M10199,-1324.61C10199,-1324.61 10199,-1298.8 10199,-1298.8"/>
<polygon fill="black" stroke="black" points="10202.5,-1298.8 10199,-1288.8 10195.5,-1298.8 10202.5,-1298.8"/>
</g>
<!-- L1_S0_TP0_GPU0_softmax&#45;&gt;L1_S0_TP0_GPU0_attn_v -->
<g id="edge292" class="edge">
<title>L1_S0_TP0_GPU0_softmax&#45;&gt;L1_S0_TP0_GPU0_attn_v</title>
<path fill="none" stroke="black" d="M10199,-1220.61C10199,-1220.61 10199,-1194.8 10199,-1194.8"/>
<polygon fill="black" stroke="black" points="10202.5,-1194.8 10199,-1184.8 10195.5,-1194.8 10202.5,-1194.8"/>
</g>
<!-- L1_S0_TP0_GPU0_mha_ar -->
<g id="node111" class="node">
<title>L1_S0_TP0_GPU0_mha_ar</title>
<ellipse fill="none" stroke="black" cx="10852" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="10852" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="10852" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="10852" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="10852" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP0_GPU0_attn_v&#45;&gt;L1_S0_TP0_GPU0_mha_ar -->
<g id="edge294" class="edge">
<title>L1_S0_TP0_GPU0_attn_v&#45;&gt;L1_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M10503.74,-1116.51C10503.74,-1116.51 10503.74,-1060.6 10503.74,-1060.6"/>
<polygon fill="black" stroke="black" points="10507.24,-1060.6 10503.74,-1050.6 10500.24,-1060.6 10507.24,-1060.6"/>
</g>
<!-- L1_S0_TP1_GPU1_mha_ar -->
<g id="node144" class="node">
<title>L1_S0_TP1_GPU1_mha_ar</title>
<ellipse fill="none" stroke="black" cx="11621" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="11621" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="11621" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="11621" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="11621" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP0_GPU0_attn_v&#45;&gt;L1_S0_TP1_GPU1_mha_ar -->
<g id="edge330" class="edge">
<title>L1_S0_TP0_GPU0_attn_v&#45;&gt;L1_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M10530.95,-1116.65C10530.95,-1098.97 10530.95,-1081 10530.95,-1081 10530.95,-1081 11292.71,-1081 11292.71,-1081 11292.71,-1081 11292.71,-1065.94 11292.71,-1065.94"/>
<polygon fill="black" stroke="black" points="11296.21,-1065.94 11292.71,-1055.94 11289.21,-1065.94 11296.21,-1065.94"/>
</g>
<!-- L1_S0_TP2_GPU2_mha_ar -->
<g id="node154" class="node">
<title>L1_S0_TP2_GPU2_mha_ar</title>
<ellipse fill="none" stroke="black" cx="12390" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="12390" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="12390" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="12390" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="12390" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP0_GPU0_attn_v&#45;&gt;L1_S0_TP2_GPU2_mha_ar -->
<g id="edge366" class="edge">
<title>L1_S0_TP0_GPU0_attn_v&#45;&gt;L1_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M10558.16,-1116.65C10558.16,-1098.97 10558.16,-1081 10558.16,-1081 10558.16,-1081 12085.09,-1081 12085.09,-1081 12085.09,-1081 12085.09,-1070.75 12085.09,-1070.75"/>
<polygon fill="black" stroke="black" points="12088.59,-1070.75 12085.09,-1060.75 12081.59,-1070.75 12088.59,-1070.75"/>
</g>
<!-- L1_S0_TP3_GPU3_mha_ar -->
<g id="node164" class="node">
<title>L1_S0_TP3_GPU3_mha_ar</title>
<ellipse fill="none" stroke="black" cx="13159" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="13159" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="13159" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="13159" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="13159" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP0_GPU0_attn_v&#45;&gt;L1_S0_TP3_GPU3_mha_ar -->
<g id="edge402" class="edge">
<title>L1_S0_TP0_GPU0_attn_v&#45;&gt;L1_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M10585.37,-1116.65C10585.37,-1098.97 10585.37,-1081 10585.37,-1081 10585.37,-1081 12890.8,-1081 12890.8,-1081 12890.8,-1081 12890.8,-1076.47 12890.8,-1076.47"/>
<polygon fill="black" stroke="black" points="12894.3,-1076.47 12890.8,-1066.47 12887.3,-1076.47 12894.3,-1076.47"/>
</g>
<!-- L1_S0_TP4_GPU4_mha_ar -->
<g id="node174" class="node">
<title>L1_S0_TP4_GPU4_mha_ar</title>
<ellipse fill="none" stroke="black" cx="13928" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="13928" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="13928" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="13928" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="13928" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP0_GPU0_attn_v&#45;&gt;L1_S0_TP4_GPU4_mha_ar -->
<g id="edge438" class="edge">
<title>L1_S0_TP0_GPU0_attn_v&#45;&gt;L1_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M10440.51,-1116.63C10440.51,-1059.37 10440.51,-950 10440.51,-950 10440.51,-950 13609.84,-950 13609.84,-950 13609.84,-950 13609.84,-996.91 13609.84,-996.91"/>
<polygon fill="black" stroke="black" points="13606.34,-996.91 13609.84,-1006.91 13613.34,-996.91 13606.34,-996.91"/>
</g>
<!-- L1_S0_TP5_GPU5_mha_ar -->
<g id="node184" class="node">
<title>L1_S0_TP5_GPU5_mha_ar</title>
<ellipse fill="none" stroke="black" cx="14697" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="14697" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="14697" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="14697" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="14697" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP0_GPU0_attn_v&#45;&gt;L1_S0_TP5_GPU5_mha_ar -->
<g id="edge474" class="edge">
<title>L1_S0_TP0_GPU0_attn_v&#45;&gt;L1_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M10560.5,-1184.94C10560.5,-1197.63 10560.5,-1209 10560.5,-1209 10560.5,-1209 14504.5,-1209 14504.5,-1209 14504.5,-1209 14504.5,-1083.94 14504.5,-1083.94"/>
<polygon fill="black" stroke="black" points="14508,-1083.94 14504.5,-1073.94 14501,-1083.94 14508,-1083.94"/>
</g>
<!-- L1_S0_TP6_GPU6_mha_ar -->
<g id="node194" class="node">
<title>L1_S0_TP6_GPU6_mha_ar</title>
<ellipse fill="none" stroke="black" cx="15466" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="15466" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="15466" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="15466" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="15466" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP0_GPU0_attn_v&#45;&gt;L1_S0_TP6_GPU6_mha_ar -->
<g id="edge510" class="edge">
<title>L1_S0_TP0_GPU0_attn_v&#45;&gt;L1_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M10612.58,-1116.4C10612.58,-1104.46 10612.58,-1094 10612.58,-1094 10612.58,-1094 15141.45,-1094 15141.45,-1094 15141.45,-1094 15141.45,-1066.86 15141.45,-1066.86"/>
<polygon fill="black" stroke="black" points="15144.95,-1066.86 15141.45,-1056.86 15137.95,-1066.86 15144.95,-1066.86"/>
</g>
<!-- L1_S0_TP7_GPU7_mha_ar -->
<g id="node204" class="node">
<title>L1_S0_TP7_GPU7_mha_ar</title>
<ellipse fill="none" stroke="black" cx="16235" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="16235" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="16235" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="16235" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="16235" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP0_GPU0_attn_v&#45;&gt;L1_S0_TP7_GPU7_mha_ar -->
<g id="edge546" class="edge">
<title>L1_S0_TP0_GPU0_attn_v&#45;&gt;L1_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M10639.79,-1116.4C10639.79,-1104.46 10639.79,-1094 10639.79,-1094 10639.79,-1094 15927.46,-1094 15927.46,-1094 15927.46,-1094 15927.46,-1070.42 15927.46,-1070.42"/>
<polygon fill="black" stroke="black" points="15930.96,-1070.42 15927.46,-1060.42 15923.96,-1070.42 15930.96,-1070.42"/>
</g>
<!-- L1_S0_TP0_GPU0_mha_res -->
<g id="node119" class="node">
<title>L1_S0_TP0_GPU0_mha_res</title>
<polygon fill="none" stroke="black" points="10213.5,-948.5 9326.5,-948.5 9326.5,-880.5 10213.5,-880.5 10213.5,-948.5"/>
<text text-anchor="middle" x="9770" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="9770" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="9770" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="9770" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP0_GPU0_mha_ar&#45;&gt;L1_S0_TP0_GPU0_mha_res -->
<g id="edge302" class="edge">
<title>L1_S0_TP0_GPU0_mha_ar&#45;&gt;L1_S0_TP0_GPU0_mha_res</title>
<path fill="none" stroke="black" d="M10496.3,-1048C10251.86,-1048 9971.25,-1048 9971.25,-1048 9971.25,-1048 9971.25,-958.53 9971.25,-958.53"/>
<polygon fill="black" stroke="black" points="9974.75,-958.53 9971.25,-948.53 9967.75,-958.53 9974.75,-958.53"/>
</g>
<!-- L1_S0_TP1_GPU1_attn_v -->
<g id="node112" class="node">
<title>L1_S0_TP1_GPU1_attn_v</title>
<polygon fill="none" stroke="black" points="11623,-1184.67 10685,-1184.67 10685,-1116.67 11623,-1116.67 11623,-1184.67"/>
<text text-anchor="middle" x="11154" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="11154" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="11154" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="11154" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L1_S0_TP1_GPU1_attn_v&#45;&gt;L1_S0_TP0_GPU0_mha_ar -->
<g id="edge295" class="edge">
<title>L1_S0_TP1_GPU1_attn_v&#45;&gt;L1_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M10752.81,-1116.51C10752.81,-1116.51 10752.81,-1088.96 10752.81,-1088.96"/>
<polygon fill="black" stroke="black" points="10756.31,-1088.96 10752.81,-1078.96 10749.31,-1088.96 10756.31,-1088.96"/>
</g>
<!-- L1_S0_TP1_GPU1_attn_v&#45;&gt;L1_S0_TP1_GPU1_mha_ar -->
<g id="edge331" class="edge">
<title>L1_S0_TP1_GPU1_attn_v&#45;&gt;L1_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M11339.89,-1116.51C11339.89,-1116.51 11339.89,-1074.64 11339.89,-1074.64"/>
<polygon fill="black" stroke="black" points="11343.39,-1074.64 11339.89,-1064.64 11336.39,-1074.64 11343.39,-1074.64"/>
</g>
<!-- L1_S0_TP1_GPU1_attn_v&#45;&gt;L1_S0_TP2_GPU2_mha_ar -->
<g id="edge367" class="edge">
<title>L1_S0_TP1_GPU1_attn_v&#45;&gt;L1_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M11387.08,-1116.65C11387.08,-1098.97 11387.08,-1081 11387.08,-1081 11387.08,-1081 12155.64,-1081 12155.64,-1081 12155.64,-1081 12155.64,-1079.93 12155.64,-1079.93"/>
<polygon fill="black" stroke="black" points="12159.14,-1080.25 12155.64,-1070.25 12152.14,-1080.25 12159.14,-1080.25"/>
</g>
<!-- L1_S0_TP1_GPU1_attn_v&#45;&gt;L1_S0_TP3_GPU3_mha_ar -->
<g id="edge403" class="edge">
<title>L1_S0_TP1_GPU1_attn_v&#45;&gt;L1_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M11434.26,-1116.65C11434.26,-1098.97 11434.26,-1081 11434.26,-1081 11434.26,-1081 12998.08,-1081 12998.08,-1081 12998.08,-1081 12998.08,-1080.52 12998.08,-1080.52"/>
<polygon fill="black" stroke="black" points="13001.58,-1086.18 12998.08,-1076.18 12994.58,-1086.18 13001.58,-1086.18"/>
</g>
<!-- L1_S0_TP1_GPU1_attn_v&#45;&gt;L1_S0_TP4_GPU4_mha_ar -->
<g id="edge439" class="edge">
<title>L1_S0_TP1_GPU1_attn_v&#45;&gt;L1_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M11236.5,-1116.63C11236.5,-1059.37 11236.5,-950 11236.5,-950 11236.5,-950 13581.18,-950 13581.18,-950 13581.18,-950 13581.18,-1003.84 13581.18,-1003.84"/>
<polygon fill="black" stroke="black" points="13577.68,-1003.84 13581.18,-1013.84 13584.68,-1003.84 13577.68,-1003.84"/>
</g>
<!-- L1_S0_TP1_GPU1_attn_v&#45;&gt;L1_S0_TP5_GPU5_mha_ar -->
<g id="edge475" class="edge">
<title>L1_S0_TP1_GPU1_attn_v&#45;&gt;L1_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M11481.45,-1116.46C11481.45,-1104.04 11481.45,-1093 11481.45,-1093 11481.45,-1093 14355.42,-1093 14355.42,-1093 14355.42,-1093 14355.42,-1062.7 14355.42,-1062.7"/>
<polygon fill="black" stroke="black" points="14358.92,-1062.7 14355.42,-1052.7 14351.92,-1062.7 14358.92,-1062.7"/>
</g>
<!-- L1_S0_TP1_GPU1_attn_v&#45;&gt;L1_S0_TP6_GPU6_mha_ar -->
<g id="edge511" class="edge">
<title>L1_S0_TP1_GPU1_attn_v&#45;&gt;L1_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M11528.63,-1116.4C11528.63,-1104.46 11528.63,-1094 11528.63,-1094 11528.63,-1094 15192.38,-1094 15192.38,-1094 15192.38,-1094 15192.38,-1075.81 15192.38,-1075.81"/>
<polygon fill="black" stroke="black" points="15195.88,-1075.81 15192.38,-1065.81 15188.88,-1075.81 15195.88,-1075.81"/>
</g>
<!-- L1_S0_TP1_GPU1_attn_v&#45;&gt;L1_S0_TP7_GPU7_mha_ar -->
<g id="edge547" class="edge">
<title>L1_S0_TP1_GPU1_attn_v&#45;&gt;L1_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M11575.82,-1116.4C11575.82,-1104.46 11575.82,-1094 11575.82,-1094 11575.82,-1094 15995.39,-1094 15995.39,-1094 15995.39,-1094 15995.39,-1079.73 15995.39,-1079.73"/>
<polygon fill="black" stroke="black" points="15998.89,-1079.73 15995.39,-1069.73 15991.89,-1079.73 15998.89,-1079.73"/>
</g>
<!-- L1_S0_TP2_GPU2_attn_v -->
<g id="node113" class="node">
<title>L1_S0_TP2_GPU2_attn_v</title>
<polygon fill="none" stroke="black" points="12579,-1184.67 11641,-1184.67 11641,-1116.67 12579,-1116.67 12579,-1184.67"/>
<text text-anchor="middle" x="12110" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="12110" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="12110" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="12110" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L1_S0_TP2_GPU2_attn_v&#45;&gt;L1_S0_TP0_GPU0_mha_ar -->
<g id="edge296" class="edge">
<title>L1_S0_TP2_GPU2_attn_v&#45;&gt;L1_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M11700.25,-1116.48C11700.25,-1114.32 11700.25,-1113 11700.25,-1113 11700.25,-1113 10820.62,-1113 10820.62,-1113 10820.62,-1113 10820.62,-1090.75 10820.62,-1090.75"/>
<polygon fill="black" stroke="black" points="10824.12,-1090.75 10820.62,-1080.75 10817.12,-1090.75 10824.12,-1090.75"/>
</g>
<!-- L1_S0_TP2_GPU2_attn_v&#45;&gt;L1_S0_TP1_GPU1_mha_ar -->
<g id="edge332" class="edge">
<title>L1_S0_TP2_GPU2_attn_v&#45;&gt;L1_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M11759.49,-1116.51C11759.49,-1116.51 11759.49,-1087.65 11759.49,-1087.65"/>
<polygon fill="black" stroke="black" points="11762.99,-1087.65 11759.49,-1077.65 11755.99,-1087.65 11762.99,-1087.65"/>
</g>
<!-- L1_S0_TP2_GPU2_attn_v&#45;&gt;L1_S0_TP2_GPU2_mha_ar -->
<g id="edge368" class="edge">
<title>L1_S0_TP2_GPU2_attn_v&#45;&gt;L1_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M12226.2,-1116.51C12226.2,-1116.51 12226.2,-1085.92 12226.2,-1085.92"/>
<polygon fill="black" stroke="black" points="12229.7,-1085.92 12226.2,-1075.92 12222.7,-1085.92 12229.7,-1085.92"/>
</g>
<!-- L1_S0_TP2_GPU2_attn_v&#45;&gt;L1_S0_TP3_GPU3_mha_ar -->
<g id="edge404" class="edge">
<title>L1_S0_TP2_GPU2_attn_v&#45;&gt;L1_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M12296.76,-1116.65C12296.76,-1098.97 12296.76,-1081 12296.76,-1081 12296.76,-1081 13105.36,-1081 13105.36,-1081 13105.36,-1081 13105.36,-1080.95 13105.36,-1080.95"/>
<polygon fill="black" stroke="black" points="13108.86,-1090.46 13105.36,-1080.46 13101.86,-1090.46 13108.86,-1090.46"/>
</g>
<!-- L1_S0_TP2_GPU2_attn_v&#45;&gt;L1_S0_TP4_GPU4_mha_ar -->
<g id="edge440" class="edge">
<title>L1_S0_TP2_GPU2_attn_v&#45;&gt;L1_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M12367.32,-1116.4C12367.32,-1104.46 12367.32,-1094 12367.32,-1094 12367.32,-1094 13767.42,-1094 13767.42,-1094 13767.42,-1094 13767.42,-1086.24 13767.42,-1086.24"/>
<polygon fill="black" stroke="black" points="13770.92,-1086.24 13767.42,-1076.24 13763.92,-1086.24 13770.92,-1086.24"/>
</g>
<!-- L1_S0_TP2_GPU2_attn_v&#45;&gt;L1_S0_TP5_GPU5_mha_ar -->
<g id="edge476" class="edge">
<title>L1_S0_TP2_GPU2_attn_v&#45;&gt;L1_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M12496.5,-1184.7C12496.5,-1194.69 12496.5,-1203 12496.5,-1203 12496.5,-1203 14500,-1203 14500,-1203 14500,-1203 14500,-1083.84 14500,-1083.84"/>
<polygon fill="black" stroke="black" points="14503.5,-1083.84 14500,-1073.84 14496.5,-1083.84 14503.5,-1083.84"/>
</g>
<!-- L1_S0_TP2_GPU2_attn_v&#45;&gt;L1_S0_TP6_GPU6_mha_ar -->
<g id="edge512" class="edge">
<title>L1_S0_TP2_GPU2_attn_v&#45;&gt;L1_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M12437.88,-1116.36C12437.88,-1104.91 12437.88,-1095 12437.88,-1095 12437.88,-1095 15243.3,-1095 15243.3,-1095 15243.3,-1095 15243.3,-1081.4 15243.3,-1081.4"/>
<polygon fill="black" stroke="black" points="15246.8,-1081.4 15243.3,-1071.4 15239.8,-1081.4 15246.8,-1081.4"/>
</g>
<!-- L1_S0_TP2_GPU2_attn_v&#45;&gt;L1_S0_TP7_GPU7_mha_ar -->
<g id="edge548" class="edge">
<title>L1_S0_TP2_GPU2_attn_v&#45;&gt;L1_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M12508.44,-1116.4C12508.44,-1104.46 12508.44,-1094 12508.44,-1094 12508.44,-1094 16063.33,-1094 16063.33,-1094 16063.33,-1094 16063.33,-1085.57 16063.33,-1085.57"/>
<polygon fill="black" stroke="black" points="16066.83,-1085.57 16063.33,-1075.57 16059.83,-1085.57 16066.83,-1085.57"/>
</g>
<!-- L1_S0_TP3_GPU3_attn_v -->
<g id="node114" class="node">
<title>L1_S0_TP3_GPU3_attn_v</title>
<polygon fill="none" stroke="black" points="13535,-1184.67 12597,-1184.67 12597,-1116.67 13535,-1116.67 13535,-1184.67"/>
<text text-anchor="middle" x="13066" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="13066" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="13066" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="13066" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L1_S0_TP3_GPU3_attn_v&#45;&gt;L1_S0_TP0_GPU0_mha_ar -->
<g id="edge297" class="edge">
<title>L1_S0_TP3_GPU3_attn_v&#45;&gt;L1_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M12625.08,-1116.48C12625.08,-1114.32 12625.08,-1113 12625.08,-1113 12625.08,-1113 10888.43,-1113 10888.43,-1113 10888.43,-1113 10888.43,-1090.75 10888.43,-1090.75"/>
<polygon fill="black" stroke="black" points="10891.93,-1090.75 10888.43,-1080.75 10884.93,-1090.75 10891.93,-1090.75"/>
</g>
<!-- L1_S0_TP3_GPU3_attn_v&#45;&gt;L1_S0_TP1_GPU1_mha_ar -->
<g id="edge333" class="edge">
<title>L1_S0_TP3_GPU3_attn_v&#45;&gt;L1_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M12653.16,-1116.48C12653.16,-1114.32 12653.16,-1113 12653.16,-1113 12653.16,-1113 11818.74,-1113 11818.74,-1113 11818.74,-1113 11818.74,-1083.73 11818.74,-1083.73"/>
<polygon fill="black" stroke="black" points="11822.24,-1083.73 11818.74,-1073.73 11815.24,-1083.73 11822.24,-1083.73"/>
</g>
<!-- L1_S0_TP3_GPU3_attn_v&#45;&gt;L1_S0_TP2_GPU2_mha_ar -->
<g id="edge369" class="edge">
<title>L1_S0_TP3_GPU3_attn_v&#45;&gt;L1_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M12681.24,-1116.51C12681.24,-1116.51 12681.24,-1073.04 12681.24,-1073.04"/>
<polygon fill="black" stroke="black" points="12684.74,-1073.04 12681.24,-1063.04 12677.74,-1073.04 12684.74,-1073.04"/>
</g>
<!-- L1_S0_TP3_GPU3_attn_v&#45;&gt;L1_S0_TP3_GPU3_mha_ar -->
<g id="edge405" class="edge">
<title>L1_S0_TP3_GPU3_attn_v&#45;&gt;L1_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M13212.64,-1116.51C13212.64,-1116.51 13212.64,-1090.27 13212.64,-1090.27"/>
<polygon fill="black" stroke="black" points="13216.14,-1090.27 13212.64,-1080.27 13209.14,-1090.27 13216.14,-1090.27"/>
</g>
<!-- L1_S0_TP3_GPU3_attn_v&#45;&gt;L1_S0_TP4_GPU4_mha_ar -->
<g id="edge441" class="edge">
<title>L1_S0_TP3_GPU3_attn_v&#45;&gt;L1_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M13535.03,-1161C13538.09,-1161 13539.71,-1161 13539.71,-1161 13539.71,-1161 13539.71,-1016 13539.71,-1016 13539.71,-1016 13565.55,-1016 13565.55,-1016"/>
<polygon fill="black" stroke="black" points="13565.55,-1019.5 13575.55,-1016 13565.55,-1012.5 13565.55,-1019.5"/>
</g>
<!-- L1_S0_TP3_GPU3_attn_v&#45;&gt;L1_S0_TP5_GPU5_mha_ar -->
<g id="edge477" class="edge">
<title>L1_S0_TP3_GPU3_attn_v&#45;&gt;L1_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M13486.67,-1184.9C13486.67,-1184.97 13486.67,-1185 13486.67,-1185 13486.67,-1185 14495.5,-1185 14495.5,-1185 14495.5,-1185 14495.5,-1083.43 14495.5,-1083.43"/>
<polygon fill="black" stroke="black" points="14499,-1083.43 14495.5,-1073.43 14492,-1083.43 14499,-1083.43"/>
</g>
<!-- L1_S0_TP3_GPU3_attn_v&#45;&gt;L1_S0_TP6_GPU6_mha_ar -->
<g id="edge513" class="edge">
<title>L1_S0_TP3_GPU3_attn_v&#45;&gt;L1_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M13438.33,-1184.81C13438.33,-1190.18 13438.33,-1194 13438.33,-1194 13438.33,-1194 15456,-1194 15456,-1194 15456,-1194 15456,-1091.01 15456,-1091.01"/>
<polygon fill="black" stroke="black" points="15459.5,-1091.01 15456,-1081.01 15452.5,-1091.01 15459.5,-1091.01"/>
</g>
<!-- L1_S0_TP3_GPU3_attn_v&#45;&gt;L1_S0_TP7_GPU7_mha_ar -->
<g id="edge549" class="edge">
<title>L1_S0_TP3_GPU3_attn_v&#45;&gt;L1_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M13319.92,-1116.4C13319.92,-1104.46 13319.92,-1094 13319.92,-1094 13319.92,-1094 16131.26,-1094 16131.26,-1094 16131.26,-1094 16131.26,-1088.82 16131.26,-1088.82"/>
<polygon fill="black" stroke="black" points="16134.76,-1088.82 16131.26,-1078.82 16127.76,-1088.82 16134.76,-1088.82"/>
</g>
<!-- L1_S0_TP4_GPU4_attn_v -->
<g id="node115" class="node">
<title>L1_S0_TP4_GPU4_attn_v</title>
<polygon fill="none" stroke="black" points="14491,-1184.67 13553,-1184.67 13553,-1116.67 14491,-1116.67 14491,-1184.67"/>
<text text-anchor="middle" x="14022" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="14022" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="14022" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="14022" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L1_S0_TP4_GPU4_attn_v&#45;&gt;L1_S0_TP0_GPU0_mha_ar -->
<g id="edge298" class="edge">
<title>L1_S0_TP4_GPU4_attn_v&#45;&gt;L1_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M13660.21,-1116.4C13660.21,-1104.46 13660.21,-1094 13660.21,-1094 13660.21,-1094 10956.24,-1094 10956.24,-1094 10956.24,-1094 10956.24,-1088.82 10956.24,-1088.82"/>
<polygon fill="black" stroke="black" points="10959.74,-1088.82 10956.24,-1078.82 10952.74,-1088.82 10959.74,-1088.82"/>
</g>
<!-- L1_S0_TP4_GPU4_attn_v&#45;&gt;L1_S0_TP1_GPU1_mha_ar -->
<g id="edge334" class="edge">
<title>L1_S0_TP4_GPU4_attn_v&#45;&gt;L1_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M13632.67,-1184.76C13632.67,-1192.76 13632.67,-1199 13632.67,-1199 13632.67,-1199 11632,-1199 11632,-1199 11632,-1199 11632,-1090.72 11632,-1090.72"/>
<polygon fill="black" stroke="black" points="11635.5,-1090.72 11632,-1080.72 11628.5,-1090.72 11635.5,-1090.72"/>
</g>
<!-- L1_S0_TP4_GPU4_attn_v&#45;&gt;L1_S0_TP2_GPU2_mha_ar -->
<g id="edge370" class="edge">
<title>L1_S0_TP4_GPU4_attn_v&#45;&gt;L1_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M13592.83,-1184.9C13592.83,-1187.42 13592.83,-1189 13592.83,-1189 13592.83,-1189 12591,-1189 12591,-1189 12591,-1189 12591,-1083.27 12591,-1083.27"/>
<polygon fill="black" stroke="black" points="12594.5,-1083.27 12591,-1073.27 12587.5,-1083.27 12594.5,-1083.27"/>
</g>
<!-- L1_S0_TP4_GPU4_attn_v&#45;&gt;L1_S0_TP3_GPU3_mha_ar -->
<g id="edge406" class="edge">
<title>L1_S0_TP4_GPU4_attn_v&#45;&gt;L1_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M13552.93,-1139C13542.95,-1139 13537.36,-1139 13537.36,-1139 13537.36,-1139 13537.36,-1048 13537.36,-1048 13537.36,-1048 13524.82,-1048 13524.82,-1048"/>
<polygon fill="black" stroke="black" points="13524.82,-1044.5 13514.82,-1048 13524.82,-1051.5 13524.82,-1044.5"/>
</g>
<!-- L1_S0_TP4_GPU4_attn_v&#45;&gt;L1_S0_TP4_GPU4_mha_ar -->
<g id="edge442" class="edge">
<title>L1_S0_TP4_GPU4_attn_v&#45;&gt;L1_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M13874.63,-1116.51C13874.63,-1116.51 13874.63,-1090.27 13874.63,-1090.27"/>
<polygon fill="black" stroke="black" points="13878.13,-1090.27 13874.63,-1080.27 13871.13,-1090.27 13878.13,-1090.27"/>
</g>
<!-- L1_S0_TP4_GPU4_attn_v&#45;&gt;L1_S0_TP5_GPU5_mha_ar -->
<g id="edge478" class="edge">
<title>L1_S0_TP4_GPU4_attn_v&#45;&gt;L1_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M14389.32,-1116.51C14389.32,-1116.51 14389.32,-1070.31 14389.32,-1070.31"/>
<polygon fill="black" stroke="black" points="14392.82,-1070.31 14389.32,-1060.31 14385.82,-1070.31 14392.82,-1070.31"/>
</g>
<!-- L1_S0_TP4_GPU4_attn_v&#45;&gt;L1_S0_TP6_GPU6_mha_ar -->
<g id="edge514" class="edge">
<title>L1_S0_TP4_GPU4_attn_v&#45;&gt;L1_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M14423.21,-1116.36C14423.21,-1104.91 14423.21,-1095 14423.21,-1095 14423.21,-1095 15294.23,-1095 15294.23,-1095 15294.23,-1095 15294.23,-1085.59 15294.23,-1085.59"/>
<polygon fill="black" stroke="black" points="15297.73,-1085.59 15294.23,-1075.59 15290.73,-1085.59 15297.73,-1085.59"/>
</g>
<!-- L1_S0_TP4_GPU4_attn_v&#45;&gt;L1_S0_TP7_GPU7_mha_ar -->
<g id="edge550" class="edge">
<title>L1_S0_TP4_GPU4_attn_v&#45;&gt;L1_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M14457.11,-1116.36C14457.11,-1104.91 14457.11,-1095 14457.11,-1095 14457.11,-1095 16199.2,-1095 16199.2,-1095 16199.2,-1095 16199.2,-1090.52 16199.2,-1090.52"/>
<polygon fill="black" stroke="black" points="16202.7,-1090.52 16199.2,-1080.52 16195.7,-1090.52 16202.7,-1090.52"/>
</g>
<!-- L1_S0_TP5_GPU5_attn_v -->
<g id="node116" class="node">
<title>L1_S0_TP5_GPU5_attn_v</title>
<polygon fill="none" stroke="black" points="15447,-1184.67 14509,-1184.67 14509,-1116.67 15447,-1116.67 15447,-1184.67"/>
<text text-anchor="middle" x="14978" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="14978" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="14978" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="14978" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L1_S0_TP5_GPU5_attn_v&#45;&gt;L1_S0_TP0_GPU0_mha_ar -->
<g id="edge299" class="edge">
<title>L1_S0_TP5_GPU5_attn_v&#45;&gt;L1_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M14571.61,-1116.4C14571.61,-1104.46 14571.61,-1094 14571.61,-1094 14571.61,-1094 11024.05,-1094 11024.05,-1094 11024.05,-1094 11024.05,-1085.57 11024.05,-1085.57"/>
<polygon fill="black" stroke="black" points="11027.55,-1085.57 11024.05,-1075.57 11020.55,-1085.57 11027.55,-1085.57"/>
</g>
<!-- L1_S0_TP5_GPU5_attn_v&#45;&gt;L1_S0_TP1_GPU1_mha_ar -->
<g id="edge335" class="edge">
<title>L1_S0_TP5_GPU5_attn_v&#45;&gt;L1_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M14634.22,-1116.4C14634.22,-1104.46 14634.22,-1094 14634.22,-1094 14634.22,-1094 11877.98,-1094 11877.98,-1094 11877.98,-1094 11877.98,-1077.95 11877.98,-1077.95"/>
<polygon fill="black" stroke="black" points="11881.48,-1077.95 11877.98,-1067.95 11874.48,-1077.95 11881.48,-1077.95"/>
</g>
<!-- L1_S0_TP5_GPU5_attn_v&#45;&gt;L1_S0_TP2_GPU2_mha_ar -->
<g id="edge371" class="edge">
<title>L1_S0_TP5_GPU5_attn_v&#45;&gt;L1_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M14696.82,-1116.4C14696.82,-1104.46 14696.82,-1094 14696.82,-1094 14696.82,-1094 12709.32,-1094 12709.32,-1094 12709.32,-1094 12709.32,-1067.92 12709.32,-1067.92"/>
<polygon fill="black" stroke="black" points="12712.82,-1067.92 12709.32,-1057.92 12705.82,-1067.92 12712.82,-1067.92"/>
</g>
<!-- L1_S0_TP5_GPU5_attn_v&#45;&gt;L1_S0_TP3_GPU3_mha_ar -->
<g id="edge407" class="edge">
<title>L1_S0_TP5_GPU5_attn_v&#45;&gt;L1_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M14759.43,-1116.4C14759.43,-1104.46 14759.43,-1094 14759.43,-1094 14759.43,-1094 13427.2,-1094 13427.2,-1094 13427.2,-1094 13427.2,-1076.52 13427.2,-1076.52"/>
<polygon fill="black" stroke="black" points="13430.7,-1076.52 13427.2,-1066.52 13423.7,-1076.52 13430.7,-1076.52"/>
</g>
<!-- L1_S0_TP5_GPU5_attn_v&#45;&gt;L1_S0_TP4_GPU4_mha_ar -->
<g id="edge443" class="edge">
<title>L1_S0_TP5_GPU5_attn_v&#45;&gt;L1_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M14822.04,-1116.6C14822.04,-1101.46 14822.04,-1087 14822.04,-1087 14822.04,-1087 13981.84,-1087 13981.84,-1087 13981.84,-1087 13981.84,-1086.33 13981.84,-1086.33"/>
<polygon fill="black" stroke="black" points="13985.34,-1090.33 13981.84,-1080.33 13978.34,-1090.33 13985.34,-1090.33"/>
</g>
<!-- L1_S0_TP5_GPU5_attn_v&#45;&gt;L1_S0_TP5_GPU5_mha_ar -->
<g id="edge479" class="edge">
<title>L1_S0_TP5_GPU5_attn_v&#45;&gt;L1_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M14884.65,-1116.51C14884.65,-1116.51 14884.65,-1084.63 14884.65,-1084.63"/>
<polygon fill="black" stroke="black" points="14888.15,-1084.63 14884.65,-1074.63 14881.15,-1084.63 14888.15,-1084.63"/>
</g>
<!-- L1_S0_TP5_GPU5_attn_v&#45;&gt;L1_S0_TP6_GPU6_mha_ar -->
<g id="edge515" class="edge">
<title>L1_S0_TP5_GPU5_attn_v&#45;&gt;L1_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M15345.15,-1116.51C15345.15,-1116.51 15345.15,-1088.52 15345.15,-1088.52"/>
<polygon fill="black" stroke="black" points="15348.65,-1088.52 15345.15,-1078.52 15341.65,-1088.52 15348.65,-1088.52"/>
</g>
<!-- L1_S0_TP5_GPU5_attn_v&#45;&gt;L1_S0_TP7_GPU7_mha_ar -->
<g id="edge551" class="edge">
<title>L1_S0_TP5_GPU5_attn_v&#45;&gt;L1_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M15396.08,-1116.36C15396.08,-1104.91 15396.08,-1095 15396.08,-1095 15396.08,-1095 16267.13,-1095 16267.13,-1095 16267.13,-1095 16267.13,-1090.52 16267.13,-1090.52"/>
<polygon fill="black" stroke="black" points="16270.63,-1090.52 16267.13,-1080.52 16263.63,-1090.52 16270.63,-1090.52"/>
</g>
<!-- L1_S0_TP6_GPU6_attn_v -->
<g id="node117" class="node">
<title>L1_S0_TP6_GPU6_attn_v</title>
<polygon fill="none" stroke="black" points="16403,-1184.67 15465,-1184.67 15465,-1116.67 16403,-1116.67 16403,-1184.67"/>
<text text-anchor="middle" x="15934" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="15934" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="15934" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="15934" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L1_S0_TP6_GPU6_attn_v&#45;&gt;L1_S0_TP0_GPU0_mha_ar -->
<g id="edge300" class="edge">
<title>L1_S0_TP6_GPU6_attn_v&#45;&gt;L1_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M15512.06,-1116.4C15512.06,-1104.46 15512.06,-1094 15512.06,-1094 15512.06,-1094 11091.86,-1094 11091.86,-1094 11091.86,-1094 11091.86,-1079.73 11091.86,-1079.73"/>
<polygon fill="black" stroke="black" points="11095.36,-1079.73 11091.86,-1069.73 11088.36,-1079.73 11095.36,-1079.73"/>
</g>
<!-- L1_S0_TP6_GPU6_attn_v&#45;&gt;L1_S0_TP1_GPU1_mha_ar -->
<g id="edge336" class="edge">
<title>L1_S0_TP6_GPU6_attn_v&#45;&gt;L1_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M15559.12,-1116.4C15559.12,-1104.46 15559.12,-1094 15559.12,-1094 15559.12,-1094 11937.23,-1094 11937.23,-1094 11937.23,-1094 11937.23,-1068.63 11937.23,-1068.63"/>
<polygon fill="black" stroke="black" points="11940.73,-1068.63 11937.23,-1058.63 11933.73,-1068.63 11940.73,-1068.63"/>
</g>
<!-- L1_S0_TP6_GPU6_attn_v&#45;&gt;L1_S0_TP2_GPU2_mha_ar -->
<g id="edge372" class="edge">
<title>L1_S0_TP6_GPU6_attn_v&#45;&gt;L1_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M15606.18,-1116.4C15606.18,-1104.46 15606.18,-1094 15606.18,-1094 15606.18,-1094 12737.39,-1094 12737.39,-1094 12737.39,-1094 12737.39,-1061.01 12737.39,-1061.01"/>
<polygon fill="black" stroke="black" points="12740.89,-1061.01 12737.39,-1051.01 12733.89,-1061.01 12740.89,-1061.01"/>
</g>
<!-- L1_S0_TP6_GPU6_attn_v&#45;&gt;L1_S0_TP3_GPU3_mha_ar -->
<g id="edge408" class="edge">
<title>L1_S0_TP6_GPU6_attn_v&#45;&gt;L1_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M15850.5,-1116.55C15850.5,-1063.44 15850.5,-967 15850.5,-967 15850.5,-967 13505.02,-967 13505.02,-967 13505.02,-967 13505.02,-1003.61 13505.02,-1003.61"/>
<polygon fill="black" stroke="black" points="13501.52,-1003.61 13505.02,-1013.61 13508.52,-1003.61 13501.52,-1003.61"/>
</g>
<!-- L1_S0_TP6_GPU6_attn_v&#45;&gt;L1_S0_TP4_GPU4_mha_ar -->
<g id="edge444" class="edge">
<title>L1_S0_TP6_GPU6_attn_v&#45;&gt;L1_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M15653.24,-1116.6C15653.24,-1101.46 15653.24,-1087 15653.24,-1087 15653.24,-1087 14089.05,-1087 14089.05,-1087 14089.05,-1087 14089.05,-1085.92 14089.05,-1085.92"/>
<polygon fill="black" stroke="black" points="14092.55,-1086.25 14089.05,-1076.25 14085.55,-1086.25 14092.55,-1086.25"/>
</g>
<!-- L1_S0_TP6_GPU6_attn_v&#45;&gt;L1_S0_TP5_GPU5_mha_ar -->
<g id="edge480" class="edge">
<title>L1_S0_TP6_GPU6_attn_v&#45;&gt;L1_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M15700.3,-1116.6C15700.3,-1101.46 15700.3,-1087 15700.3,-1087 15700.3,-1087 14947.26,-1087 14947.26,-1087 14947.26,-1087 14947.26,-1078.58 14947.26,-1078.58"/>
<polygon fill="black" stroke="black" points="14950.76,-1078.58 14947.26,-1068.58 14943.76,-1078.58 14950.76,-1078.58"/>
</g>
<!-- L1_S0_TP6_GPU6_attn_v&#45;&gt;L1_S0_TP6_GPU6_mha_ar -->
<g id="edge516" class="edge">
<title>L1_S0_TP6_GPU6_attn_v&#45;&gt;L1_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M15747.36,-1116.51C15747.36,-1116.51 15747.36,-1074.64 15747.36,-1074.64"/>
<polygon fill="black" stroke="black" points="15750.86,-1074.64 15747.36,-1064.64 15743.86,-1074.64 15750.86,-1074.64"/>
</g>
<!-- L1_S0_TP6_GPU6_attn_v&#45;&gt;L1_S0_TP7_GPU7_mha_ar -->
<g id="edge552" class="edge">
<title>L1_S0_TP6_GPU6_attn_v&#45;&gt;L1_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M16335.07,-1116.51C16335.07,-1116.51 16335.07,-1088.96 16335.07,-1088.96"/>
<polygon fill="black" stroke="black" points="16338.57,-1088.96 16335.07,-1078.96 16331.57,-1088.96 16338.57,-1088.96"/>
</g>
<!-- L1_S0_TP7_GPU7_attn_v -->
<g id="node118" class="node">
<title>L1_S0_TP7_GPU7_attn_v</title>
<polygon fill="none" stroke="black" points="17359,-1184.67 16421,-1184.67 16421,-1116.67 17359,-1116.67 17359,-1184.67"/>
<text text-anchor="middle" x="16890" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="16890" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="16890" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="16890" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L1_S0_TP7_GPU7_attn_v&#45;&gt;L1_S0_TP0_GPU0_mha_ar -->
<g id="edge301" class="edge">
<title>L1_S0_TP7_GPU7_attn_v&#45;&gt;L1_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M16452.58,-1116.4C16452.58,-1104.46 16452.58,-1094 16452.58,-1094 16452.58,-1094 11159.66,-1094 11159.66,-1094 11159.66,-1094 11159.66,-1070.42 11159.66,-1070.42"/>
<polygon fill="black" stroke="black" points="11163.16,-1070.42 11159.66,-1060.42 11156.16,-1070.42 11163.16,-1070.42"/>
</g>
<!-- L1_S0_TP7_GPU7_attn_v&#45;&gt;L1_S0_TP1_GPU1_mha_ar -->
<g id="edge337" class="edge">
<title>L1_S0_TP7_GPU7_attn_v&#45;&gt;L1_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M16657.82,-1116.36C16657.82,-1062.96 16657.82,-966 16657.82,-966 16657.82,-966 11739.49,-966 11739.49,-966 11739.49,-966 11739.49,-976.7 11739.49,-976.7"/>
<polygon fill="black" stroke="black" points="11735.99,-976.7 11739.49,-986.7 11742.99,-976.7 11735.99,-976.7"/>
</g>
<!-- L1_S0_TP7_GPU7_attn_v&#45;&gt;L1_S0_TP2_GPU2_mha_ar -->
<g id="edge373" class="edge">
<title>L1_S0_TP7_GPU7_attn_v&#45;&gt;L1_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M16560.75,-1184.92C16560.75,-1198.97 16560.75,-1212 16560.75,-1212 16560.75,-1212 12585,-1212 12585,-1212 12585,-1212 12585,-1083.74 12585,-1083.74"/>
<polygon fill="black" stroke="black" points="12588.5,-1083.74 12585,-1073.74 12581.5,-1083.74 12588.5,-1083.74"/>
</g>
<!-- L1_S0_TP7_GPU7_attn_v&#45;&gt;L1_S0_TP3_GPU3_mha_ar -->
<g id="edge409" class="edge">
<title>L1_S0_TP7_GPU7_attn_v&#45;&gt;L1_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M16634.15,-1116.55C16634.15,-1063.44 16634.15,-967 16634.15,-967 16634.15,-967 13476.26,-967 13476.26,-967 13476.26,-967 13476.26,-996.66 13476.26,-996.66"/>
<polygon fill="black" stroke="black" points="13472.76,-996.66 13476.26,-1006.66 13479.76,-996.66 13472.76,-996.66"/>
</g>
<!-- L1_S0_TP7_GPU7_attn_v&#45;&gt;L1_S0_TP4_GPU4_mha_ar -->
<g id="edge445" class="edge">
<title>L1_S0_TP7_GPU7_attn_v&#45;&gt;L1_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M16484.16,-1116.6C16484.16,-1101.46 16484.16,-1087 16484.16,-1087 16484.16,-1087 14196.26,-1087 14196.26,-1087 14196.26,-1087 14196.26,-1076.43 14196.26,-1076.43"/>
<polygon fill="black" stroke="black" points="14199.76,-1076.43 14196.26,-1066.43 14192.76,-1076.43 14199.76,-1076.43"/>
</g>
<!-- L1_S0_TP7_GPU7_attn_v&#45;&gt;L1_S0_TP5_GPU5_mha_ar -->
<g id="edge481" class="edge">
<title>L1_S0_TP7_GPU7_attn_v&#45;&gt;L1_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M16515.74,-1116.6C16515.74,-1101.46 16515.74,-1087 16515.74,-1087 16515.74,-1087 15009.87,-1087 15009.87,-1087 15009.87,-1087 15009.87,-1069.47 15009.87,-1069.47"/>
<polygon fill="black" stroke="black" points="15013.37,-1069.47 15009.87,-1059.47 15006.37,-1069.47 15013.37,-1069.47"/>
</g>
<!-- L1_S0_TP7_GPU7_attn_v&#45;&gt;L1_S0_TP6_GPU6_mha_ar -->
<g id="edge517" class="edge">
<title>L1_S0_TP7_GPU7_attn_v&#45;&gt;L1_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M16547.32,-1116.6C16547.32,-1101.46 16547.32,-1087 16547.32,-1087 16547.32,-1087 15794.41,-1087 15794.41,-1087 15794.41,-1087 15794.41,-1065.98 15794.41,-1065.98"/>
<polygon fill="black" stroke="black" points="15797.91,-1065.98 15794.41,-1055.98 15790.91,-1065.98 15797.91,-1065.98"/>
</g>
<!-- L1_S0_TP7_GPU7_attn_v&#45;&gt;L1_S0_TP7_GPU7_mha_ar -->
<g id="edge553" class="edge">
<title>L1_S0_TP7_GPU7_attn_v&#45;&gt;L1_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M16578.89,-1116.51C16578.89,-1116.51 16578.89,-1061.95 16578.89,-1061.95"/>
<polygon fill="black" stroke="black" points="16582.39,-1061.95 16578.89,-1051.95 16575.39,-1061.95 16582.39,-1061.95"/>
</g>
<!-- L1_S0_TP0_GPU0_gate -->
<g id="node120" class="node">
<title>L1_S0_TP0_GPU0_gate</title>
<polygon fill="none" stroke="black" points="10299.56,-844.5 9457.15,-844.5 9240.44,-708.5 10082.85,-708.5 10299.56,-844.5"/>
<text text-anchor="middle" x="9770" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="9770" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="9770" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="9770" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L1_S0_TP0_GPU0_mha_res&#45;&gt;L1_S0_TP0_GPU0_gate -->
<g id="edge303" class="edge">
<title>L1_S0_TP0_GPU0_mha_res&#45;&gt;L1_S0_TP0_GPU0_gate</title>
<path fill="none" stroke="black" d="M9770,-880.39C9770,-880.39 9770,-854.73 9770,-854.73"/>
<polygon fill="black" stroke="black" points="9773.5,-854.73 9770,-844.73 9766.5,-854.73 9773.5,-854.73"/>
</g>
<!-- L1_S0_TP0_GPU0_moe_res -->
<g id="node138" class="node">
<title>L1_S0_TP0_GPU0_moe_res</title>
<polygon fill="none" stroke="black" points="10405,-436.33 9585,-436.33 9585,-368.33 10405,-368.33 10405,-436.33"/>
<text text-anchor="middle" x="9995" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="9995" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="9995" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="9995" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP0_GPU0_mha_res&#45;&gt;L1_S0_TP0_GPU0_moe_res -->
<g id="edge323" class="edge">
<title>L1_S0_TP0_GPU0_mha_res&#45;&gt;L1_S0_TP0_GPU0_moe_res</title>
<path fill="none" stroke="black" d="M10213.8,-903C10268.67,-903 10305.93,-903 10305.93,-903 10305.93,-903 10305.93,-682 10305.93,-682 10305.93,-682 10273.5,-682 10273.5,-682 10273.5,-682 10273.5,-446.35 10273.5,-446.35"/>
<polygon fill="black" stroke="black" points="10277,-446.35 10273.5,-436.35 10270,-446.35 10277,-446.35"/>
</g>
<!-- L1_S0_TP0_GPU0_expert0 -->
<g id="node121" class="node">
<title>L1_S0_TP0_GPU0_expert0</title>
<polygon fill="none" stroke="black" points="10264.5,-672.5 9815.5,-672.5 9815.5,-604.5 10264.5,-604.5 10264.5,-672.5"/>
<text text-anchor="middle" x="10040" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="10040" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="10040" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="10040" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L1_S0_TP0_GPU0_gate&#45;&gt;L1_S0_TP0_GPU0_expert0 -->
<g id="edge304" class="edge">
<title>L1_S0_TP0_GPU0_gate&#45;&gt;L1_S0_TP0_GPU0_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10040,-708.31C10040,-708.31 10040,-682.71 10040,-682.71"/>
<polygon fill="black" stroke="black" points="10043.5,-682.71 10040,-672.71 10036.5,-682.71 10043.5,-682.71"/>
</g>
<!-- L1_S0_TP0_GPU0_expert1 -->
<g id="node122" class="node">
<title>L1_S0_TP0_GPU0_expert1</title>
<polygon fill="none" stroke="black" points="10731.5,-672.5 10282.5,-672.5 10282.5,-604.5 10731.5,-604.5 10731.5,-672.5"/>
<text text-anchor="middle" x="10507" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="10507" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="10507" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="10507" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L1_S0_TP0_GPU0_gate&#45;&gt;L1_S0_TP0_GPU0_expert1 -->
<g id="edge305" class="edge">
<title>L1_S0_TP0_GPU0_gate&#45;&gt;L1_S0_TP0_GPU0_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10291.14,-776.4C10291.14,-776.4 10291.14,-682.74 10291.14,-682.74"/>
<polygon fill="black" stroke="black" points="10294.64,-682.74 10291.14,-672.74 10287.64,-682.74 10294.64,-682.74"/>
</g>
<!-- L1_S0_TP0_GPU0_moe_ar -->
<g id="node123" class="node">
<title>L1_S0_TP0_GPU0_moe_ar</title>
<ellipse fill="none" stroke="black" cx="11138" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="11138" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="11138" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="11138" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11138" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP0_GPU0_expert0&#45;&gt;L1_S0_TP0_GPU0_moe_ar -->
<g id="edge306" class="edge">
<title>L1_S0_TP0_GPU0_expert0&#45;&gt;L1_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M10214.61,-604.37C10214.61,-563.08 10214.61,-499 10214.61,-499 10214.61,-499 10828.52,-499 10828.52,-499"/>
<polygon fill="black" stroke="black" points="10828.52,-502.5 10838.52,-499 10828.52,-495.5 10828.52,-502.5"/>
</g>
<!-- L1_S0_TP1_GPU1_moe_ar -->
<g id="node147" class="node">
<title>L1_S0_TP1_GPU1_moe_ar</title>
<ellipse fill="none" stroke="black" cx="11825" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="11825" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="11825" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="11825" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11825" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP0_GPU0_expert0&#45;&gt;L1_S0_TP1_GPU1_moe_ar -->
<g id="edge342" class="edge">
<title>L1_S0_TP0_GPU0_expert0&#45;&gt;L1_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M10164.72,-604.22C10164.72,-597.25 10164.72,-592 10164.72,-592 10164.72,-592 11509.98,-592 11509.98,-592 11509.98,-592 11509.98,-546.66 11509.98,-546.66"/>
<polygon fill="black" stroke="black" points="11513.48,-546.66 11509.98,-536.66 11506.48,-546.66 11513.48,-546.66"/>
</g>
<!-- L1_S0_TP2_GPU2_moe_ar -->
<g id="node157" class="node">
<title>L1_S0_TP2_GPU2_moe_ar</title>
<ellipse fill="none" stroke="black" cx="12512" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="12512" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="12512" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="12512" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="12512" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP0_GPU0_expert0&#45;&gt;L1_S0_TP2_GPU2_moe_ar -->
<g id="edge378" class="edge">
<title>L1_S0_TP0_GPU0_expert0&#45;&gt;L1_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M10114.83,-604.36C10114.83,-551.78 10114.83,-457 10114.83,-457 10114.83,-457 12317.03,-457 12317.03,-457 12317.03,-457 12317.03,-471.34 12317.03,-471.34"/>
<polygon fill="black" stroke="black" points="12313.53,-471.34 12317.03,-481.34 12320.53,-471.34 12313.53,-471.34"/>
</g>
<!-- L1_S0_TP3_GPU3_moe_ar -->
<g id="node167" class="node">
<title>L1_S0_TP3_GPU3_moe_ar</title>
<ellipse fill="none" stroke="black" cx="13199" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="13199" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="13199" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="13199" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13199" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP0_GPU0_expert0&#45;&gt;L1_S0_TP3_GPU3_moe_ar -->
<g id="edge414" class="edge">
<title>L1_S0_TP0_GPU0_expert0&#45;&gt;L1_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M10064.94,-604.36C10064.94,-551.78 10064.94,-457 10064.94,-457 10064.94,-457 13028.4,-457 13028.4,-457 13028.4,-457 13028.4,-468.82 13028.4,-468.82"/>
<polygon fill="black" stroke="black" points="13024.9,-468.82 13028.4,-478.82 13031.9,-468.82 13024.9,-468.82"/>
</g>
<!-- L1_S0_TP4_GPU4_moe_ar -->
<g id="node177" class="node">
<title>L1_S0_TP4_GPU4_moe_ar</title>
<ellipse fill="none" stroke="black" cx="13886" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="13886" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="13886" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="13886" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13886" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP0_GPU0_expert0&#45;&gt;L1_S0_TP4_GPU4_moe_ar -->
<g id="edge450" class="edge">
<title>L1_S0_TP0_GPU0_expert0&#45;&gt;L1_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M10015.06,-604.36C10015.06,-551.78 10015.06,-457 10015.06,-457 10015.06,-457 13606.63,-457 13606.63,-457 13606.63,-457 13606.63,-483.89 13606.63,-483.89"/>
<polygon fill="black" stroke="black" points="13603.13,-483.89 13606.63,-493.89 13610.13,-483.89 13603.13,-483.89"/>
</g>
<!-- L1_S0_TP5_GPU5_moe_ar -->
<g id="node187" class="node">
<title>L1_S0_TP5_GPU5_moe_ar</title>
<ellipse fill="none" stroke="black" cx="14573" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="14573" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="14573" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="14573" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14573" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP0_GPU0_expert0&#45;&gt;L1_S0_TP5_GPU5_moe_ar -->
<g id="edge486" class="edge">
<title>L1_S0_TP0_GPU0_expert0&#45;&gt;L1_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M9965.17,-604.36C9965.17,-551.78 9965.17,-457 9965.17,-457 9965.17,-457 14403.71,-457 14403.71,-457 14403.71,-457 14403.71,-468.82 14403.71,-468.82"/>
<polygon fill="black" stroke="black" points="14400.21,-468.82 14403.71,-478.82 14407.21,-468.82 14400.21,-468.82"/>
</g>
<!-- L1_S0_TP6_GPU6_moe_ar -->
<g id="node197" class="node">
<title>L1_S0_TP6_GPU6_moe_ar</title>
<ellipse fill="none" stroke="black" cx="15260" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="15260" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="15260" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="15260" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="15260" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP0_GPU0_expert0&#45;&gt;L1_S0_TP6_GPU6_moe_ar -->
<g id="edge522" class="edge">
<title>L1_S0_TP0_GPU0_expert0&#45;&gt;L1_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M9915.28,-604.36C9915.28,-551.78 9915.28,-457 9915.28,-457 9915.28,-457 15154.63,-457 15154.63,-457 15154.63,-457 15154.63,-464.66 15154.63,-464.66"/>
<polygon fill="black" stroke="black" points="15151.13,-464.66 15154.63,-474.66 15158.13,-464.67 15151.13,-464.66"/>
</g>
<!-- L1_S0_TP7_GPU7_moe_ar -->
<g id="node207" class="node">
<title>L1_S0_TP7_GPU7_moe_ar</title>
<ellipse fill="none" stroke="black" cx="15947" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="15947" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="15947" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="15947" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="15947" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP0_GPU0_expert0&#45;&gt;L1_S0_TP7_GPU7_moe_ar -->
<g id="edge558" class="edge">
<title>L1_S0_TP0_GPU0_expert0&#45;&gt;L1_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M9865.39,-604.17C9865.39,-548.34 9865.39,-444 9865.39,-444 9865.39,-444 15904.85,-444 15904.85,-444 15904.85,-444 15904.85,-462.45 15904.85,-462.45"/>
<polygon fill="black" stroke="black" points="15901.35,-462.45 15904.85,-472.45 15908.35,-462.45 15901.35,-462.45"/>
</g>
<!-- L1_S0_TP0_GPU0_expert1&#45;&gt;L1_S0_TP0_GPU0_moe_ar -->
<g id="edge307" class="edge">
<title>L1_S0_TP0_GPU0_expert1&#45;&gt;L1_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M10690.69,-604.21C10690.69,-567.05 10690.69,-513 10690.69,-513 10690.69,-513 10797.34,-513 10797.34,-513"/>
<polygon fill="black" stroke="black" points="10797.34,-516.5 10807.34,-513 10797.34,-509.5 10797.34,-516.5"/>
</g>
<!-- L1_S0_TP0_GPU0_expert1&#45;&gt;L1_S0_TP1_GPU1_moe_ar -->
<g id="edge343" class="edge">
<title>L1_S0_TP0_GPU0_expert1&#45;&gt;L1_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M10445.81,-604.22C10445.81,-597.25 10445.81,-592 10445.81,-592 10445.81,-592 11529.42,-592 11529.42,-592 11529.42,-592 11529.42,-553.07 11529.42,-553.07"/>
<polygon fill="black" stroke="black" points="11532.92,-553.07 11529.42,-543.07 11525.92,-553.07 11532.92,-553.07"/>
</g>
<!-- L1_S0_TP0_GPU0_expert1&#45;&gt;L1_S0_TP2_GPU2_moe_ar -->
<g id="edge379" class="edge">
<title>L1_S0_TP0_GPU0_expert1&#45;&gt;L1_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M10486.62,-604.22C10486.62,-597.25 10486.62,-592 10486.62,-592 10486.62,-592 12224.42,-592 12224.42,-592 12224.42,-592 12224.42,-555.05 12224.42,-555.05"/>
<polygon fill="black" stroke="black" points="12227.92,-555.05 12224.42,-545.05 12220.92,-555.05 12227.92,-555.05"/>
</g>
<!-- L1_S0_TP0_GPU0_expert1&#45;&gt;L1_S0_TP3_GPU3_moe_ar -->
<g id="edge415" class="edge">
<title>L1_S0_TP0_GPU0_expert1&#45;&gt;L1_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M10524.86,-672.68C10524.86,-687.27 10524.86,-701 10524.86,-701 10524.86,-701 13075.5,-701 13075.5,-701 13075.5,-701 13075.5,-575.52 13075.5,-575.52"/>
<polygon fill="black" stroke="black" points="13079,-575.52 13075.5,-565.52 13072,-575.52 13079,-575.52"/>
</g>
<!-- L1_S0_TP0_GPU0_expert1&#45;&gt;L1_S0_TP4_GPU4_moe_ar -->
<g id="edge451" class="edge">
<title>L1_S0_TP0_GPU0_expert1&#45;&gt;L1_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M10649.88,-604.44C10649.88,-553.66 10649.88,-464 10649.88,-464 10649.88,-464 13588.27,-464 13588.27,-464 13588.27,-464 13588.27,-488.44 13588.27,-488.44"/>
<polygon fill="black" stroke="black" points="13584.77,-488.44 13588.27,-498.44 13591.77,-488.44 13584.77,-488.44"/>
</g>
<!-- L1_S0_TP0_GPU0_expert1&#45;&gt;L1_S0_TP5_GPU5_moe_ar -->
<g id="edge487" class="edge">
<title>L1_S0_TP0_GPU0_expert1&#45;&gt;L1_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M10609.06,-604.44C10609.06,-553.66 10609.06,-464 10609.06,-464 10609.06,-464 14362.42,-464 14362.42,-464 14362.42,-464 14362.42,-472.79 14362.42,-472.79"/>
<polygon fill="black" stroke="black" points="14358.92,-472.79 14362.42,-482.79 14365.92,-472.79 14358.92,-472.79"/>
</g>
<!-- L1_S0_TP0_GPU0_expert1&#45;&gt;L1_S0_TP6_GPU6_moe_ar -->
<g id="edge523" class="edge">
<title>L1_S0_TP0_GPU0_expert1&#45;&gt;L1_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M10568.25,-604.44C10568.25,-553.66 10568.25,-464 10568.25,-464 10568.25,-464 15078.27,-464 15078.27,-464 15078.27,-464 15078.27,-470.02 15078.27,-470.02"/>
<polygon fill="black" stroke="black" points="15074.77,-470.02 15078.27,-480.02 15081.77,-470.02 15074.77,-470.02"/>
</g>
<!-- L1_S0_TP0_GPU0_expert1&#45;&gt;L1_S0_TP7_GPU7_moe_ar -->
<g id="edge559" class="edge">
<title>L1_S0_TP0_GPU0_expert1&#45;&gt;L1_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M10527.44,-604.46C10527.44,-602.32 10527.44,-601 10527.44,-601 10527.44,-601 15640.98,-601 15640.98,-601 15640.98,-601 15640.98,-549.92 15640.98,-549.92"/>
<polygon fill="black" stroke="black" points="15644.48,-549.92 15640.98,-539.92 15637.48,-549.92 15644.48,-549.92"/>
</g>
<!-- L1_S0_TP0_GPU0_moe_ar&#45;&gt;L1_S0_TP0_GPU0_moe_res -->
<g id="edge322" class="edge">
<title>L1_S0_TP0_GPU0_moe_ar&#45;&gt;L1_S0_TP0_GPU0_moe_res</title>
<path fill="none" stroke="black" d="M10904.26,-486C10669.96,-486 10343.75,-486 10343.75,-486 10343.75,-486 10343.75,-446.36 10343.75,-446.36"/>
<polygon fill="black" stroke="black" points="10347.25,-446.36 10343.75,-436.36 10340.25,-446.36 10347.25,-446.36"/>
</g>
<!-- L1_S0_TP1_GPU1_expert0 -->
<g id="node124" class="node">
<title>L1_S0_TP1_GPU1_expert0</title>
<polygon fill="none" stroke="black" points="11198.5,-672.5 10749.5,-672.5 10749.5,-604.5 11198.5,-604.5 11198.5,-672.5"/>
<text text-anchor="middle" x="10974" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="10974" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="10974" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="10974" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L1_S0_TP1_GPU1_expert0&#45;&gt;L1_S0_TP0_GPU0_moe_ar -->
<g id="edge308" class="edge">
<title>L1_S0_TP1_GPU1_expert0&#45;&gt;L1_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M10869.37,-604.34C10869.37,-604.34 10869.37,-559.3 10869.37,-559.3"/>
<polygon fill="black" stroke="black" points="10872.87,-559.3 10869.37,-549.3 10865.87,-559.3 10872.87,-559.3"/>
</g>
<!-- L1_S0_TP1_GPU1_expert0&#45;&gt;L1_S0_TP1_GPU1_moe_ar -->
<g id="edge344" class="edge">
<title>L1_S0_TP1_GPU1_expert0&#45;&gt;L1_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M10935.19,-604.22C10935.19,-597.25 10935.19,-592 10935.19,-592 10935.19,-592 11548.86,-592 11548.86,-592 11548.86,-592 11548.86,-557.89 11548.86,-557.89"/>
<polygon fill="black" stroke="black" points="11552.36,-557.89 11548.86,-547.89 11545.36,-557.89 11552.36,-557.89"/>
</g>
<!-- L1_S0_TP1_GPU1_expert0&#45;&gt;L1_S0_TP2_GPU2_moe_ar -->
<g id="edge380" class="edge">
<title>L1_S0_TP1_GPU1_expert0&#45;&gt;L1_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M11001.02,-604.22C11001.02,-597.25 11001.02,-592 11001.02,-592 11001.02,-592 12271.31,-592 12271.31,-592 12271.31,-592 12271.31,-564.11 12271.31,-564.11"/>
<polygon fill="black" stroke="black" points="12274.81,-564.11 12271.31,-554.11 12267.81,-564.11 12274.81,-564.11"/>
</g>
<!-- L1_S0_TP1_GPU1_expert0&#45;&gt;L1_S0_TP3_GPU3_moe_ar -->
<g id="edge416" class="edge">
<title>L1_S0_TP1_GPU1_expert0&#45;&gt;L1_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M11066.85,-604.22C11066.85,-597.25 11066.85,-592 11066.85,-592 11066.85,-592 12889.78,-592 12889.78,-592 12889.78,-592 12889.78,-548.85 12889.78,-548.85"/>
<polygon fill="black" stroke="black" points="12893.28,-548.85 12889.78,-538.85 12886.28,-548.85 12893.28,-548.85"/>
</g>
<!-- L1_S0_TP1_GPU1_expert0&#45;&gt;L1_S0_TP4_GPU4_moe_ar -->
<g id="edge452" class="edge">
<title>L1_S0_TP1_GPU1_expert0&#45;&gt;L1_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M10794.15,-604.22C10794.15,-553.66 10794.15,-465 10794.15,-465 10794.15,-465 13569.9,-465 13569.9,-465 13569.9,-465 13569.9,-494.68 13569.9,-494.68"/>
<polygon fill="black" stroke="black" points="13566.4,-494.68 13569.9,-504.68 13573.4,-494.68 13566.4,-494.68"/>
</g>
<!-- L1_S0_TP1_GPU1_expert0&#45;&gt;L1_S0_TP5_GPU5_moe_ar -->
<g id="edge488" class="edge">
<title>L1_S0_TP1_GPU1_expert0&#45;&gt;L1_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M10784.77,-604.22C10784.77,-553.66 10784.77,-465 10784.77,-465 10784.77,-465 14321.12,-465 14321.12,-465 14321.12,-465 14321.12,-478.5 14321.12,-478.5"/>
<polygon fill="black" stroke="black" points="14317.62,-478.5 14321.12,-488.5 14324.62,-478.5 14317.62,-478.5"/>
</g>
<!-- L1_S0_TP1_GPU1_expert0&#45;&gt;L1_S0_TP6_GPU6_moe_ar -->
<g id="edge524" class="edge">
<title>L1_S0_TP1_GPU1_expert0&#45;&gt;L1_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M10775.38,-604.22C10775.38,-553.66 10775.38,-465 10775.38,-465 10775.38,-465 15001.9,-465 15001.9,-465 15001.9,-465 15001.9,-479.79 15001.9,-479.79"/>
<polygon fill="black" stroke="black" points="14998.4,-479.79 15001.9,-489.79 15005.4,-479.79 14998.4,-479.79"/>
</g>
<!-- L1_S0_TP1_GPU1_expert0&#45;&gt;L1_S0_TP7_GPU7_moe_ar -->
<g id="edge560" class="edge">
<title>L1_S0_TP1_GPU1_expert0&#45;&gt;L1_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M11132.67,-604.46C11132.67,-602.32 11132.67,-601 11132.67,-601 11132.67,-601 15669.42,-601 15669.42,-601 15669.42,-601 15669.42,-557.25 15669.42,-557.25"/>
<polygon fill="black" stroke="black" points="15672.92,-557.25 15669.42,-547.25 15665.92,-557.25 15672.92,-557.25"/>
</g>
<!-- L1_S0_TP1_GPU1_expert1 -->
<g id="node125" class="node">
<title>L1_S0_TP1_GPU1_expert1</title>
<polygon fill="none" stroke="black" points="11665.5,-672.5 11216.5,-672.5 11216.5,-604.5 11665.5,-604.5 11665.5,-672.5"/>
<text text-anchor="middle" x="11441" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="11441" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11441" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11441" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L1_S0_TP1_GPU1_expert1&#45;&gt;L1_S0_TP0_GPU0_moe_ar -->
<g id="edge309" class="edge">
<title>L1_S0_TP1_GPU1_expert1&#45;&gt;L1_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M11242.1,-604.34C11242.1,-604.34 11242.1,-576.36 11242.1,-576.36"/>
<polygon fill="black" stroke="black" points="11245.6,-576.36 11242.1,-566.36 11238.6,-576.36 11245.6,-576.36"/>
</g>
<!-- L1_S0_TP1_GPU1_expert1&#45;&gt;L1_S0_TP1_GPU1_moe_ar -->
<g id="edge345" class="edge">
<title>L1_S0_TP1_GPU1_expert1&#45;&gt;L1_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M11568.3,-604.34C11568.3,-604.34 11568.3,-561.27 11568.3,-561.27"/>
<polygon fill="black" stroke="black" points="11571.8,-561.27 11568.3,-551.27 11564.8,-561.27 11571.8,-561.27"/>
</g>
<!-- L1_S0_TP1_GPU1_expert1&#45;&gt;L1_S0_TP2_GPU2_moe_ar -->
<g id="edge381" class="edge">
<title>L1_S0_TP1_GPU1_expert1&#45;&gt;L1_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M11587.74,-604.22C11587.74,-597.25 11587.74,-592 11587.74,-592 11587.74,-592 12318.19,-592 12318.19,-592 12318.19,-592 12318.19,-569.98 12318.19,-569.98"/>
<polygon fill="black" stroke="black" points="12321.69,-569.98 12318.19,-559.98 12314.69,-569.98 12321.69,-569.98"/>
</g>
<!-- L1_S0_TP1_GPU1_expert1&#45;&gt;L1_S0_TP3_GPU3_moe_ar -->
<g id="edge417" class="edge">
<title>L1_S0_TP1_GPU1_expert1&#45;&gt;L1_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M11607.18,-604.22C11607.18,-597.25 11607.18,-592 11607.18,-592 11607.18,-592 12915.03,-592 12915.03,-592 12915.03,-592 12915.03,-555.86 12915.03,-555.86"/>
<polygon fill="black" stroke="black" points="12918.53,-555.86 12915.03,-545.86 12911.53,-555.86 12918.53,-555.86"/>
</g>
<!-- L1_S0_TP1_GPU1_expert1&#45;&gt;L1_S0_TP4_GPU4_moe_ar -->
<g id="edge453" class="edge">
<title>L1_S0_TP1_GPU1_expert1&#45;&gt;L1_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M11626.62,-604.48C11626.62,-597.9 11626.62,-593 11626.62,-593 11626.62,-593 13596.43,-593 13596.43,-593 13596.43,-593 13596.43,-554.59 13596.43,-554.59"/>
<polygon fill="black" stroke="black" points="13599.93,-554.59 13596.43,-544.59 13592.93,-554.59 13599.93,-554.59"/>
</g>
<!-- L1_S0_TP1_GPU1_expert1&#45;&gt;L1_S0_TP5_GPU5_moe_ar -->
<g id="edge489" class="edge">
<title>L1_S0_TP1_GPU1_expert1&#45;&gt;L1_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M11481.5,-604.4C11481.5,-555.17 11481.5,-470 11481.5,-470 11481.5,-470 14279.83,-470 14279.83,-470 14279.83,-470 14279.83,-486.98 14279.83,-486.98"/>
<polygon fill="black" stroke="black" points="14276.33,-486.98 14279.83,-496.98 14283.33,-486.98 14276.33,-486.98"/>
</g>
<!-- L1_S0_TP1_GPU1_expert1&#45;&gt;L1_S0_TP6_GPU6_moe_ar -->
<g id="edge525" class="edge">
<title>L1_S0_TP1_GPU1_expert1&#45;&gt;L1_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M11530.86,-672.65C11530.86,-689.39 11530.86,-706 11530.86,-706 11530.86,-706 14949.93,-706 14949.93,-706 14949.93,-706 14949.93,-548.55 14949.93,-548.55"/>
<polygon fill="black" stroke="black" points="14953.43,-548.55 14949.93,-538.55 14946.43,-548.55 14953.43,-548.55"/>
</g>
<!-- L1_S0_TP1_GPU1_expert1&#45;&gt;L1_S0_TP7_GPU7_moe_ar -->
<g id="edge561" class="edge">
<title>L1_S0_TP1_GPU1_expert1&#45;&gt;L1_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M11646.06,-604.46C11646.06,-602.32 11646.06,-601 11646.06,-601 11646.06,-601 15697.86,-601 15697.86,-601 15697.86,-601 15697.86,-562.73 15697.86,-562.73"/>
<polygon fill="black" stroke="black" points="15701.36,-562.73 15697.86,-552.73 15694.36,-562.73 15701.36,-562.73"/>
</g>
<!-- L1_S0_TP2_GPU2_expert0 -->
<g id="node126" class="node">
<title>L1_S0_TP2_GPU2_expert0</title>
<polygon fill="none" stroke="black" points="12132.5,-672.5 11683.5,-672.5 11683.5,-604.5 12132.5,-604.5 12132.5,-672.5"/>
<text text-anchor="middle" x="11908" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="11908" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11908" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11908" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L1_S0_TP2_GPU2_expert0&#45;&gt;L1_S0_TP0_GPU0_moe_ar -->
<g id="edge310" class="edge">
<title>L1_S0_TP2_GPU2_expert0&#45;&gt;L1_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M11733.39,-604.46C11733.39,-602.32 11733.39,-601 11733.39,-601 11733.39,-601 11267.69,-601 11267.69,-601 11267.69,-601 11267.69,-574.95 11267.69,-574.95"/>
<polygon fill="black" stroke="black" points="11271.19,-574.95 11267.69,-564.95 11264.19,-574.95 11271.19,-574.95"/>
</g>
<!-- L1_S0_TP2_GPU2_expert0&#45;&gt;L1_S0_TP1_GPU1_moe_ar -->
<g id="edge346" class="edge">
<title>L1_S0_TP2_GPU2_expert0&#45;&gt;L1_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M11783.28,-604.34C11783.28,-604.34 11783.28,-578.55 11783.28,-578.55"/>
<polygon fill="black" stroke="black" points="11786.78,-578.55 11783.28,-568.55 11779.78,-578.55 11786.78,-578.55"/>
</g>
<!-- L1_S0_TP2_GPU2_expert0&#45;&gt;L1_S0_TP2_GPU2_moe_ar -->
<g id="edge382" class="edge">
<title>L1_S0_TP2_GPU2_expert0&#45;&gt;L1_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M11932.94,-604.22C11932.94,-597.25 11932.94,-592 11932.94,-592 11932.94,-592 12365.08,-592 12365.08,-592 12365.08,-592 12365.08,-573.71 12365.08,-573.71"/>
<polygon fill="black" stroke="black" points="12368.58,-573.71 12365.08,-563.71 12361.58,-573.71 12368.58,-573.71"/>
</g>
<!-- L1_S0_TP2_GPU2_expert0&#45;&gt;L1_S0_TP3_GPU3_moe_ar -->
<g id="edge418" class="edge">
<title>L1_S0_TP2_GPU2_expert0&#45;&gt;L1_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M11982.83,-604.22C11982.83,-597.25 11982.83,-592 11982.83,-592 11982.83,-592 12940.27,-592 12940.27,-592 12940.27,-592 12940.27,-561.19 12940.27,-561.19"/>
<polygon fill="black" stroke="black" points="12943.77,-561.19 12940.27,-551.19 12936.77,-561.19 12943.77,-561.19"/>
</g>
<!-- L1_S0_TP2_GPU2_expert0&#45;&gt;L1_S0_TP4_GPU4_moe_ar -->
<g id="edge454" class="edge">
<title>L1_S0_TP2_GPU2_expert0&#45;&gt;L1_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M12032.72,-604.48C12032.72,-597.9 12032.72,-593 12032.72,-593 12032.72,-593 13641.33,-593 13641.33,-593 13641.33,-593 13641.33,-563.31 13641.33,-563.31"/>
<polygon fill="black" stroke="black" points="13644.83,-563.31 13641.33,-553.31 13637.83,-563.31 13644.83,-563.31"/>
</g>
<!-- L1_S0_TP2_GPU2_expert0&#45;&gt;L1_S0_TP5_GPU5_moe_ar -->
<g id="edge490" class="edge">
<title>L1_S0_TP2_GPU2_expert0&#45;&gt;L1_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M12082.61,-604.48C12082.61,-597.9 12082.61,-593 12082.61,-593 12082.61,-593 14263.98,-593 14263.98,-593 14263.98,-593 14263.98,-549.11 14263.98,-549.11"/>
<polygon fill="black" stroke="black" points="14267.48,-549.11 14263.98,-539.11 14260.48,-549.11 14267.48,-549.11"/>
</g>
<!-- L1_S0_TP2_GPU2_expert0&#45;&gt;L1_S0_TP6_GPU6_moe_ar -->
<g id="edge526" class="edge">
<title>L1_S0_TP2_GPU2_expert0&#45;&gt;L1_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M12020.25,-672.71C12020.25,-683.66 12020.25,-693 12020.25,-693 12020.25,-693 14947.36,-693 14947.36,-693 14947.36,-693 14947.36,-547.6 14947.36,-547.6"/>
<polygon fill="black" stroke="black" points="14950.86,-547.6 14947.36,-537.6 14943.86,-547.6 14950.86,-547.6"/>
</g>
<!-- L1_S0_TP2_GPU2_expert0&#45;&gt;L1_S0_TP7_GPU7_moe_ar -->
<g id="edge562" class="edge">
<title>L1_S0_TP2_GPU2_expert0&#45;&gt;L1_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M11908,-672.71C11908,-683.66 11908,-693 11908,-693 11908,-693 15882.9,-693 15882.9,-693 15882.9,-693 15882.9,-578.03 15882.9,-578.03"/>
<polygon fill="black" stroke="black" points="15886.4,-578.03 15882.9,-568.03 15879.4,-578.03 15886.4,-578.03"/>
</g>
<!-- L1_S0_TP2_GPU2_expert1 -->
<g id="node127" class="node">
<title>L1_S0_TP2_GPU2_expert1</title>
<polygon fill="none" stroke="black" points="12599.5,-672.5 12150.5,-672.5 12150.5,-604.5 12599.5,-604.5 12599.5,-672.5"/>
<text text-anchor="middle" x="12375" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="12375" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="12375" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="12375" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L1_S0_TP2_GPU2_expert1&#45;&gt;L1_S0_TP0_GPU0_moe_ar -->
<g id="edge311" class="edge">
<title>L1_S0_TP2_GPU2_expert1&#45;&gt;L1_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M12165.49,-604.48C12165.49,-597.9 12165.49,-593 12165.49,-593 12165.49,-593 11293.29,-593 11293.29,-593 11293.29,-593 11293.29,-573.06 11293.29,-573.06"/>
<polygon fill="black" stroke="black" points="11296.79,-573.06 11293.29,-563.06 11289.79,-573.06 11296.79,-573.06"/>
</g>
<!-- L1_S0_TP2_GPU2_expert1&#45;&gt;L1_S0_TP1_GPU1_moe_ar -->
<g id="edge347" class="edge">
<title>L1_S0_TP2_GPU2_expert1&#45;&gt;L1_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M12154.98,-604.34C12154.98,-604.34 12154.98,-538.63 12154.98,-538.63"/>
<polygon fill="black" stroke="black" points="12158.48,-538.63 12154.98,-528.63 12151.48,-538.63 12158.48,-538.63"/>
</g>
<!-- L1_S0_TP2_GPU2_expert1&#45;&gt;L1_S0_TP2_GPU2_moe_ar -->
<g id="edge383" class="edge">
<title>L1_S0_TP2_GPU2_expert1&#45;&gt;L1_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M12411.96,-604.34C12411.96,-604.34 12411.96,-576.36 12411.96,-576.36"/>
<polygon fill="black" stroke="black" points="12415.46,-576.36 12411.96,-566.36 12408.46,-576.36 12415.46,-576.36"/>
</g>
<!-- L1_S0_TP2_GPU2_expert1&#45;&gt;L1_S0_TP3_GPU3_moe_ar -->
<g id="edge419" class="edge">
<title>L1_S0_TP2_GPU2_expert1&#45;&gt;L1_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M12458.85,-604.22C12458.85,-597.25 12458.85,-592 12458.85,-592 12458.85,-592 12965.52,-592 12965.52,-592 12965.52,-592 12965.52,-564.95 12965.52,-564.95"/>
<polygon fill="black" stroke="black" points="12969.02,-564.95 12965.52,-554.95 12962.02,-564.95 12969.02,-564.95"/>
</g>
<!-- L1_S0_TP2_GPU2_expert1&#45;&gt;L1_S0_TP4_GPU4_moe_ar -->
<g id="edge455" class="edge">
<title>L1_S0_TP2_GPU2_expert1&#45;&gt;L1_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M12505.73,-604.48C12505.73,-597.9 12505.73,-593 12505.73,-593 12505.73,-593 13686.23,-593 13686.23,-593 13686.23,-593 13686.23,-569.26 13686.23,-569.26"/>
<polygon fill="black" stroke="black" points="13689.73,-569.26 13686.23,-559.26 13682.73,-569.26 13689.73,-569.26"/>
</g>
<!-- L1_S0_TP2_GPU2_expert1&#45;&gt;L1_S0_TP5_GPU5_moe_ar -->
<g id="edge491" class="edge">
<title>L1_S0_TP2_GPU2_expert1&#45;&gt;L1_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M12552.62,-604.48C12552.62,-597.9 12552.62,-593 12552.62,-593 12552.62,-593 14289.42,-593 14289.42,-593 14289.42,-593 14289.42,-556.21 14289.42,-556.21"/>
<polygon fill="black" stroke="black" points="14292.92,-556.21 14289.42,-546.21 14285.92,-556.21 14292.92,-556.21"/>
</g>
<!-- L1_S0_TP2_GPU2_expert1&#45;&gt;L1_S0_TP6_GPU6_moe_ar -->
<g id="edge527" class="edge">
<title>L1_S0_TP2_GPU2_expert1&#45;&gt;L1_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M12557.74,-672.71C12557.74,-683.66 12557.74,-693 12557.74,-693 12557.74,-693 14944.79,-693 14944.79,-693 14944.79,-693 14944.79,-546.65 14944.79,-546.65"/>
<polygon fill="black" stroke="black" points="14948.29,-546.65 14944.79,-536.65 14941.29,-546.65 14948.29,-546.65"/>
</g>
<!-- L1_S0_TP2_GPU2_expert1&#45;&gt;L1_S0_TP7_GPU7_moe_ar -->
<g id="edge563" class="edge">
<title>L1_S0_TP2_GPU2_expert1&#45;&gt;L1_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M12515.98,-672.71C12515.98,-683.66 12515.98,-693 12515.98,-693 12515.98,-693 15879.3,-693 15879.3,-693 15879.3,-693 15879.3,-577.58 15879.3,-577.58"/>
<polygon fill="black" stroke="black" points="15882.8,-577.58 15879.3,-567.58 15875.8,-577.58 15882.8,-577.58"/>
</g>
<!-- L1_S0_TP3_GPU3_expert0 -->
<g id="node128" class="node">
<title>L1_S0_TP3_GPU3_expert0</title>
<polygon fill="none" stroke="black" points="13066.5,-672.5 12617.5,-672.5 12617.5,-604.5 13066.5,-604.5 13066.5,-672.5"/>
<text text-anchor="middle" x="12842" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="12842" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="12842" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="12842" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L1_S0_TP3_GPU3_expert0&#45;&gt;L1_S0_TP0_GPU0_moe_ar -->
<g id="edge312" class="edge">
<title>L1_S0_TP3_GPU3_expert0&#45;&gt;L1_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M12646.12,-604.48C12646.12,-597.9 12646.12,-593 12646.12,-593 12646.12,-593 11318.88,-593 11318.88,-593 11318.88,-593 11318.88,-570.95 11318.88,-570.95"/>
<polygon fill="black" stroke="black" points="11322.38,-570.95 11318.88,-560.95 11315.38,-570.95 11322.38,-570.95"/>
</g>
<!-- L1_S0_TP3_GPU3_expert0&#45;&gt;L1_S0_TP1_GPU1_moe_ar -->
<g id="edge348" class="edge">
<title>L1_S0_TP3_GPU3_expert0&#45;&gt;L1_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M12674.74,-604.48C12674.74,-597.9 12674.74,-593 12674.74,-593 12674.74,-593 12145.36,-593 12145.36,-593 12145.36,-593 12145.36,-544.41 12145.36,-544.41"/>
<polygon fill="black" stroke="black" points="12148.86,-544.41 12145.36,-534.41 12141.86,-544.41 12148.86,-544.41"/>
</g>
<!-- L1_S0_TP3_GPU3_expert0&#45;&gt;L1_S0_TP2_GPU2_moe_ar -->
<g id="edge384" class="edge">
<title>L1_S0_TP3_GPU3_expert0&#45;&gt;L1_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M12703.36,-604.34C12703.36,-604.34 12703.36,-569.91 12703.36,-569.91"/>
<polygon fill="black" stroke="black" points="12706.86,-569.91 12703.36,-559.91 12699.86,-569.91 12706.86,-569.91"/>
</g>
<!-- L1_S0_TP3_GPU3_expert0&#45;&gt;L1_S0_TP3_GPU3_moe_ar -->
<g id="edge420" class="edge">
<title>L1_S0_TP3_GPU3_expert0&#45;&gt;L1_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M12990.76,-604.34C12990.76,-604.34 12990.76,-568.22 12990.76,-568.22"/>
<polygon fill="black" stroke="black" points="12994.26,-568.22 12990.76,-558.22 12987.26,-568.22 12994.26,-568.22"/>
</g>
<!-- L1_S0_TP3_GPU3_expert0&#45;&gt;L1_S0_TP4_GPU4_moe_ar -->
<g id="edge456" class="edge">
<title>L1_S0_TP3_GPU3_expert0&#45;&gt;L1_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M13016.01,-604.48C13016.01,-597.9 13016.01,-593 13016.01,-593 13016.01,-593 13776.02,-593 13776.02,-593 13776.02,-593 13776.02,-575.97 13776.02,-575.97"/>
<polygon fill="black" stroke="black" points="13779.52,-575.97 13776.02,-565.97 13772.52,-575.97 13779.52,-575.97"/>
</g>
<!-- L1_S0_TP3_GPU3_expert0&#45;&gt;L1_S0_TP5_GPU5_moe_ar -->
<g id="edge492" class="edge">
<title>L1_S0_TP3_GPU3_expert0&#45;&gt;L1_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M13041.25,-604.48C13041.25,-597.9 13041.25,-593 13041.25,-593 13041.25,-593 14314.86,-593 14314.86,-593 14314.86,-593 14314.86,-561.2 14314.86,-561.2"/>
<polygon fill="black" stroke="black" points="14318.36,-561.2 14314.86,-551.2 14311.36,-561.2 14318.36,-561.2"/>
</g>
<!-- L1_S0_TP3_GPU3_expert0&#45;&gt;L1_S0_TP6_GPU6_moe_ar -->
<g id="edge528" class="edge">
<title>L1_S0_TP3_GPU3_expert0&#45;&gt;L1_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M12916.83,-672.69C12916.83,-683.17 12916.83,-692 12916.83,-692 12916.83,-692 14942.21,-692 14942.21,-692 14942.21,-692 14942.21,-545.64 14942.21,-545.64"/>
<polygon fill="black" stroke="black" points="14945.71,-545.64 14942.21,-535.64 14938.71,-545.64 14945.71,-545.64"/>
</g>
<!-- L1_S0_TP3_GPU3_expert0&#45;&gt;L1_S0_TP7_GPU7_moe_ar -->
<g id="edge564" class="edge">
<title>L1_S0_TP3_GPU3_expert0&#45;&gt;L1_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M12855.5,-604.17C12855.5,-548.34 12855.5,-444 12855.5,-444 12855.5,-444 15758.69,-444 15758.69,-444 15758.69,-444 15758.69,-470.42 15758.69,-470.42"/>
<polygon fill="black" stroke="black" points="15755.19,-470.42 15758.69,-480.42 15762.19,-470.42 15755.19,-470.42"/>
</g>
<!-- L1_S0_TP3_GPU3_expert1 -->
<g id="node129" class="node">
<title>L1_S0_TP3_GPU3_expert1</title>
<polygon fill="none" stroke="black" points="13533.5,-672.5 13084.5,-672.5 13084.5,-604.5 13533.5,-604.5 13533.5,-672.5"/>
<text text-anchor="middle" x="13309" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="13309" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13309" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13309" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L1_S0_TP3_GPU3_expert1&#45;&gt;L1_S0_TP0_GPU0_moe_ar -->
<g id="edge313" class="edge">
<title>L1_S0_TP3_GPU3_expert1&#45;&gt;L1_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M13134.38,-604.48C13134.38,-597.9 13134.38,-593 13134.38,-593 13134.38,-593 11344.48,-593 11344.48,-593 11344.48,-593 11344.48,-568.41 11344.48,-568.41"/>
<polygon fill="black" stroke="black" points="11347.98,-568.41 11344.48,-558.41 11340.98,-568.41 11347.98,-568.41"/>
</g>
<!-- L1_S0_TP3_GPU3_expert1&#45;&gt;L1_S0_TP1_GPU1_moe_ar -->
<g id="edge349" class="edge">
<title>L1_S0_TP3_GPU3_expert1&#45;&gt;L1_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M13184.27,-604.48C13184.27,-597.9 13184.27,-593 13184.27,-593 13184.27,-593 12147.93,-593 12147.93,-593 12147.93,-593 12147.93,-543.06 12147.93,-543.06"/>
<polygon fill="black" stroke="black" points="12151.43,-543.06 12147.93,-533.06 12144.43,-543.06 12151.43,-543.06"/>
</g>
<!-- L1_S0_TP3_GPU3_expert1&#45;&gt;L1_S0_TP2_GPU2_moe_ar -->
<g id="edge385" class="edge">
<title>L1_S0_TP3_GPU3_expert1&#45;&gt;L1_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M13234.15,-604.48C13234.15,-597.9 13234.15,-593 13234.15,-593 13234.15,-593 12731.98,-593 12731.98,-593 12731.98,-593 12731.98,-566.71 12731.98,-566.71"/>
<polygon fill="black" stroke="black" points="12735.48,-566.71 12731.98,-556.71 12728.48,-566.71 12735.48,-566.71"/>
</g>
<!-- L1_S0_TP3_GPU3_expert1&#45;&gt;L1_S0_TP3_GPU3_moe_ar -->
<g id="edge421" class="edge">
<title>L1_S0_TP3_GPU3_expert1&#45;&gt;L1_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M13284.04,-604.34C13284.04,-604.34 13284.04,-577.23 13284.04,-577.23"/>
<polygon fill="black" stroke="black" points="13287.54,-577.23 13284.04,-567.23 13280.54,-577.23 13287.54,-577.23"/>
</g>
<!-- L1_S0_TP3_GPU3_expert1&#45;&gt;L1_S0_TP4_GPU4_moe_ar -->
<g id="edge457" class="edge">
<title>L1_S0_TP3_GPU3_expert1&#45;&gt;L1_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M13533.7,-627C13540.52,-627 13544.43,-627 13544.43,-627 13544.43,-627 13544.43,-504 13544.43,-504 13544.43,-504 13561.52,-504 13561.52,-504"/>
<polygon fill="black" stroke="black" points="13561.52,-507.5 13571.52,-504 13561.52,-500.5 13561.52,-507.5"/>
</g>
<!-- L1_S0_TP3_GPU3_expert1&#45;&gt;L1_S0_TP5_GPU5_moe_ar -->
<g id="edge493" class="edge">
<title>L1_S0_TP3_GPU3_expert1&#45;&gt;L1_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M13333.92,-604.48C13333.92,-597.9 13333.92,-593 13333.92,-593 13333.92,-593 14340.3,-593 14340.3,-593 14340.3,-593 14340.3,-565.01 14340.3,-565.01"/>
<polygon fill="black" stroke="black" points="14343.8,-565.01 14340.3,-555.01 14336.8,-565.01 14343.8,-565.01"/>
</g>
<!-- L1_S0_TP3_GPU3_expert1&#45;&gt;L1_S0_TP6_GPU6_moe_ar -->
<g id="edge529" class="edge">
<title>L1_S0_TP3_GPU3_expert1&#45;&gt;L1_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M13421.25,-672.69C13421.25,-683.17 13421.25,-692 13421.25,-692 13421.25,-692 14939.64,-692 14939.64,-692 14939.64,-692 14939.64,-544.46 14939.64,-544.46"/>
<polygon fill="black" stroke="black" points="14943.14,-544.46 14939.64,-534.46 14936.14,-544.46 14943.14,-544.46"/>
</g>
<!-- L1_S0_TP3_GPU3_expert1&#45;&gt;L1_S0_TP7_GPU7_moe_ar -->
<g id="edge565" class="edge">
<title>L1_S0_TP3_GPU3_expert1&#45;&gt;L1_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M13309,-672.69C13309,-683.17 13309,-692 13309,-692 13309,-692 15875.7,-692 15875.7,-692 15875.7,-692 15875.7,-577.76 15875.7,-577.76"/>
<polygon fill="black" stroke="black" points="15879.2,-577.76 15875.7,-567.76 15872.2,-577.76 15879.2,-577.76"/>
</g>
<!-- L1_S0_TP4_GPU4_expert0 -->
<g id="node130" class="node">
<title>L1_S0_TP4_GPU4_expert0</title>
<polygon fill="none" stroke="black" points="14000.5,-672.5 13551.5,-672.5 13551.5,-604.5 14000.5,-604.5 14000.5,-672.5"/>
<text text-anchor="middle" x="13776" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="13776" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13776" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13776" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L1_S0_TP4_GPU4_expert0&#45;&gt;L1_S0_TP0_GPU0_moe_ar -->
<g id="edge314" class="edge">
<title>L1_S0_TP4_GPU4_expert0&#45;&gt;L1_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M13776.36,-672.64C13776.36,-686.36 13776.36,-699 13776.36,-699 13776.36,-699 11212.9,-699 11212.9,-699 11212.9,-699 11212.9,-577.34 11212.9,-577.34"/>
<polygon fill="black" stroke="black" points="11216.4,-577.34 11212.9,-567.34 11209.4,-577.34 11216.4,-577.34"/>
</g>
<!-- L1_S0_TP4_GPU4_expert0&#45;&gt;L1_S0_TP1_GPU1_moe_ar -->
<g id="edge350" class="edge">
<title>L1_S0_TP4_GPU4_expert0&#45;&gt;L1_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M13664.29,-672.77C13664.29,-678.17 13664.29,-682 13664.29,-682 13664.29,-682 12140.21,-682 12140.21,-682 12140.21,-682 12140.21,-546.5 12140.21,-546.5"/>
<polygon fill="black" stroke="black" points="12143.71,-546.5 12140.21,-536.5 12136.71,-546.5 12143.71,-546.5"/>
</g>
<!-- L1_S0_TP4_GPU4_expert0&#45;&gt;L1_S0_TP2_GPU2_moe_ar -->
<g id="edge386" class="edge">
<title>L1_S0_TP4_GPU4_expert0&#45;&gt;L1_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M13731.12,-604.48C13731.12,-597.9 13731.12,-593 13731.12,-593 13731.12,-593 12760.6,-593 12760.6,-593 12760.6,-593 12760.6,-562.89 12760.6,-562.89"/>
<polygon fill="black" stroke="black" points="12764.1,-562.89 12760.6,-552.89 12757.1,-562.89 12764.1,-562.89"/>
</g>
<!-- L1_S0_TP4_GPU4_expert0&#45;&gt;L1_S0_TP3_GPU3_moe_ar -->
<g id="edge422" class="edge">
<title>L1_S0_TP4_GPU4_expert0&#45;&gt;L1_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M13551.24,-649C13545.39,-649 13542.07,-649 13542.07,-649 13542.07,-649 13542.07,-536 13542.07,-536 13542.07,-536 13525.44,-536 13525.44,-536"/>
<polygon fill="black" stroke="black" points="13525.44,-532.5 13515.44,-536 13525.44,-539.5 13525.44,-532.5"/>
</g>
<!-- L1_S0_TP4_GPU4_expert0&#45;&gt;L1_S0_TP4_GPU4_moe_ar -->
<g id="edge458" class="edge">
<title>L1_S0_TP4_GPU4_expert0&#45;&gt;L1_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M13820.92,-604.34C13820.92,-604.34 13820.92,-577.67 13820.92,-577.67"/>
<polygon fill="black" stroke="black" points="13824.42,-577.67 13820.92,-567.67 13817.42,-577.67 13824.42,-577.67"/>
</g>
<!-- L1_S0_TP4_GPU4_expert0&#45;&gt;L1_S0_TP5_GPU5_moe_ar -->
<g id="edge494" class="edge">
<title>L1_S0_TP4_GPU4_expert0&#45;&gt;L1_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M13865.81,-604.46C13865.81,-602.32 13865.81,-601 13865.81,-601 13865.81,-601 14365.74,-601 14365.74,-601 14365.74,-601 14365.74,-568.35 14365.74,-568.35"/>
<polygon fill="black" stroke="black" points="14369.24,-568.35 14365.74,-558.35 14362.24,-568.35 14369.24,-568.35"/>
</g>
<!-- L1_S0_TP4_GPU4_expert0&#45;&gt;L1_S0_TP6_GPU6_moe_ar -->
<g id="edge530" class="edge">
<title>L1_S0_TP4_GPU4_expert0&#45;&gt;L1_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M13910.71,-604.46C13910.71,-602.32 13910.71,-601 13910.71,-601 13910.71,-601 14937.07,-601 14937.07,-601 14937.07,-601 14937.07,-543.01 14937.07,-543.01"/>
<polygon fill="black" stroke="black" points="14940.57,-543.01 14937.07,-533.01 14933.57,-543.01 14940.57,-543.01"/>
</g>
<!-- L1_S0_TP4_GPU4_expert0&#45;&gt;L1_S0_TP7_GPU7_moe_ar -->
<g id="edge566" class="edge">
<title>L1_S0_TP4_GPU4_expert0&#45;&gt;L1_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M13955.6,-604.46C13955.6,-602.32 13955.6,-601 13955.6,-601 13955.6,-601 15726.3,-601 15726.3,-601 15726.3,-601 15726.3,-566.94 15726.3,-566.94"/>
<polygon fill="black" stroke="black" points="15729.8,-566.94 15726.3,-556.94 15722.8,-566.94 15729.8,-566.94"/>
</g>
<!-- L1_S0_TP4_GPU4_expert1 -->
<g id="node131" class="node">
<title>L1_S0_TP4_GPU4_expert1</title>
<polygon fill="none" stroke="black" points="14467.5,-672.5 14018.5,-672.5 14018.5,-604.5 14467.5,-604.5 14467.5,-672.5"/>
<text text-anchor="middle" x="14243" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="14243" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14243" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14243" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L1_S0_TP4_GPU4_expert1&#45;&gt;L1_S0_TP0_GPU0_moe_ar -->
<g id="edge315" class="edge">
<title>L1_S0_TP4_GPU4_expert1&#45;&gt;L1_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M14243,-672.64C14243,-688.11 14243,-703 14243,-703 14243,-703 11209.3,-703 11209.3,-703 11209.3,-703 11209.3,-577.44 11209.3,-577.44"/>
<polygon fill="black" stroke="black" points="11212.8,-577.44 11209.3,-567.44 11205.8,-577.44 11212.8,-577.44"/>
</g>
<!-- L1_S0_TP4_GPU4_expert1&#45;&gt;L1_S0_TP1_GPU1_moe_ar -->
<g id="edge351" class="edge">
<title>L1_S0_TP4_GPU4_expert1&#45;&gt;L1_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M14130.75,-672.77C14130.75,-678.17 14130.75,-682 14130.75,-682 14130.75,-682 12137.64,-682 12137.64,-682 12137.64,-682 12137.64,-547.71 12137.64,-547.71"/>
<polygon fill="black" stroke="black" points="12141.14,-547.71 12137.64,-537.71 12134.14,-547.71 12141.14,-547.71"/>
</g>
<!-- L1_S0_TP4_GPU4_expert1&#45;&gt;L1_S0_TP2_GPU2_moe_ar -->
<g id="edge387" class="edge">
<title>L1_S0_TP4_GPU4_expert1&#45;&gt;L1_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M14043.75,-604.48C14043.75,-597.9 14043.75,-593 14043.75,-593 14043.75,-593 12789.22,-593 12789.22,-593 12789.22,-593 12789.22,-557.44 12789.22,-557.44"/>
<polygon fill="black" stroke="black" points="12792.72,-557.44 12789.22,-547.44 12785.72,-557.44 12792.72,-557.44"/>
</g>
<!-- L1_S0_TP4_GPU4_expert1&#45;&gt;L1_S0_TP3_GPU3_moe_ar -->
<g id="edge423" class="edge">
<title>L1_S0_TP4_GPU4_expert1&#45;&gt;L1_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M14068.99,-604.48C14068.99,-597.9 14068.99,-593 14068.99,-593 14068.99,-593 13383.81,-593 13383.81,-593 13383.81,-593 13383.81,-570.53 13383.81,-570.53"/>
<polygon fill="black" stroke="black" points="13387.31,-570.53 13383.81,-560.53 13380.31,-570.53 13387.31,-570.53"/>
</g>
<!-- L1_S0_TP4_GPU4_expert1&#45;&gt;L1_S0_TP4_GPU4_moe_ar -->
<g id="edge459" class="edge">
<title>L1_S0_TP4_GPU4_expert1&#45;&gt;L1_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M14094.24,-604.34C14094.24,-604.34 14094.24,-568.22 14094.24,-568.22"/>
<polygon fill="black" stroke="black" points="14097.74,-568.22 14094.24,-558.22 14090.74,-568.22 14097.74,-568.22"/>
</g>
<!-- L1_S0_TP4_GPU4_expert1&#45;&gt;L1_S0_TP5_GPU5_moe_ar -->
<g id="edge495" class="edge">
<title>L1_S0_TP4_GPU4_expert1&#45;&gt;L1_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M14391.18,-604.34C14391.18,-604.34 14391.18,-571.18 14391.18,-571.18"/>
<polygon fill="black" stroke="black" points="14394.68,-571.18 14391.18,-561.18 14387.68,-571.18 14394.68,-571.18"/>
</g>
<!-- L1_S0_TP4_GPU4_expert1&#45;&gt;L1_S0_TP6_GPU6_moe_ar -->
<g id="edge531" class="edge">
<title>L1_S0_TP4_GPU4_expert1&#45;&gt;L1_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M14416.62,-604.46C14416.62,-602.32 14416.62,-601 14416.62,-601 14416.62,-601 14928.53,-601 14928.53,-601 14928.53,-601 14928.53,-537.01 14928.53,-537.01"/>
<polygon fill="black" stroke="black" points="14932.03,-537.01 14928.53,-527.01 14925.03,-537.01 14932.03,-537.01"/>
</g>
<!-- L1_S0_TP4_GPU4_expert1&#45;&gt;L1_S0_TP7_GPU7_moe_ar -->
<g id="edge567" class="edge">
<title>L1_S0_TP4_GPU4_expert1&#45;&gt;L1_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M14442.06,-604.46C14442.06,-602.32 14442.06,-601 14442.06,-601 14442.06,-601 15754.74,-601 15754.74,-601 15754.74,-601 15754.74,-569.76 15754.74,-569.76"/>
<polygon fill="black" stroke="black" points="15758.24,-569.76 15754.74,-559.76 15751.24,-569.76 15758.24,-569.76"/>
</g>
<!-- L1_S0_TP5_GPU5_expert0 -->
<g id="node132" class="node">
<title>L1_S0_TP5_GPU5_expert0</title>
<polygon fill="none" stroke="black" points="14934.5,-672.5 14485.5,-672.5 14485.5,-604.5 14934.5,-604.5 14934.5,-672.5"/>
<text text-anchor="middle" x="14710" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="14710" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14710" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14710" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L1_S0_TP5_GPU5_expert0&#45;&gt;L1_S0_TP0_GPU0_moe_ar -->
<g id="edge316" class="edge">
<title>L1_S0_TP5_GPU5_expert0&#45;&gt;L1_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M14569.69,-672.53C14569.69,-688.89 14569.69,-705 14569.69,-705 14569.69,-705 11205.7,-705 11205.7,-705 11205.7,-705 11205.7,-577.95 11205.7,-577.95"/>
<polygon fill="black" stroke="black" points="11209.2,-577.95 11205.7,-567.95 11202.2,-577.95 11209.2,-577.95"/>
</g>
<!-- L1_S0_TP5_GPU5_expert0&#45;&gt;L1_S0_TP1_GPU1_moe_ar -->
<g id="edge352" class="edge">
<title>L1_S0_TP5_GPU5_expert0&#45;&gt;L1_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M14527.59,-672.77C14527.59,-678.17 14527.59,-682 14527.59,-682 14527.59,-682 12135.07,-682 12135.07,-682 12135.07,-682 12135.07,-548.64 12135.07,-548.64"/>
<polygon fill="black" stroke="black" points="12138.57,-548.64 12135.07,-538.64 12131.57,-548.64 12138.57,-548.64"/>
</g>
<!-- L1_S0_TP5_GPU5_expert0&#45;&gt;L1_S0_TP2_GPU2_moe_ar -->
<g id="edge388" class="edge">
<title>L1_S0_TP5_GPU5_expert0&#45;&gt;L1_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M14527.7,-604.48C14527.7,-597.9 14527.7,-593 14527.7,-593 14527.7,-593 12817.84,-593 12817.84,-593 12817.84,-593 12817.84,-550.25 12817.84,-550.25"/>
<polygon fill="black" stroke="black" points="12821.34,-550.25 12817.84,-540.25 12814.34,-550.25 12821.34,-550.25"/>
</g>
<!-- L1_S0_TP5_GPU5_expert0&#45;&gt;L1_S0_TP3_GPU3_moe_ar -->
<g id="edge424" class="edge">
<title>L1_S0_TP5_GPU5_expert0&#45;&gt;L1_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M14569.89,-604.22C14569.89,-597.25 14569.89,-592 14569.89,-592 14569.89,-592 13433.69,-592 13433.69,-592 13433.69,-592 13433.69,-564.95 13433.69,-564.95"/>
<polygon fill="black" stroke="black" points="13437.19,-564.95 13433.69,-554.95 13430.19,-564.95 13437.19,-564.95"/>
</g>
<!-- L1_S0_TP5_GPU5_expert0&#45;&gt;L1_S0_TP4_GPU4_moe_ar -->
<g id="edge460" class="edge">
<title>L1_S0_TP5_GPU5_expert0&#45;&gt;L1_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M14612.09,-604.22C14612.09,-597.25 14612.09,-592 14612.09,-592 14612.09,-592 14119.48,-592 14119.48,-592 14119.48,-592 14119.48,-564.95 14119.48,-564.95"/>
<polygon fill="black" stroke="black" points="14122.98,-564.95 14119.48,-554.95 14115.98,-564.95 14122.98,-564.95"/>
</g>
<!-- L1_S0_TP5_GPU5_expert0&#45;&gt;L1_S0_TP5_GPU5_moe_ar -->
<g id="edge496" class="edge">
<title>L1_S0_TP5_GPU5_expert0&#45;&gt;L1_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M14654.28,-604.34C14654.28,-604.34 14654.28,-577.23 14654.28,-577.23"/>
<polygon fill="black" stroke="black" points="14657.78,-577.23 14654.28,-567.23 14650.78,-577.23 14657.78,-577.23"/>
</g>
<!-- L1_S0_TP5_GPU5_expert0&#45;&gt;L1_S0_TP6_GPU6_moe_ar -->
<g id="edge532" class="edge">
<title>L1_S0_TP5_GPU5_expert0&#45;&gt;L1_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M14931.51,-604.34C14931.51,-604.34 14931.51,-539.61 14931.51,-539.61"/>
<polygon fill="black" stroke="black" points="14935.01,-539.61 14931.51,-529.61 14928.01,-539.61 14935.01,-539.61"/>
</g>
<!-- L1_S0_TP5_GPU5_expert0&#45;&gt;L1_S0_TP7_GPU7_moe_ar -->
<g id="edge568" class="edge">
<title>L1_S0_TP5_GPU5_expert0&#45;&gt;L1_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M14916.5,-604.46C14916.5,-602.32 14916.5,-601 14916.5,-601 14916.5,-601 15783.18,-601 15783.18,-601 15783.18,-601 15783.18,-572.6 15783.18,-572.6"/>
<polygon fill="black" stroke="black" points="15786.68,-572.6 15783.18,-562.6 15779.68,-572.6 15786.68,-572.6"/>
</g>
<!-- L1_S0_TP5_GPU5_expert1 -->
<g id="node133" class="node">
<title>L1_S0_TP5_GPU5_expert1</title>
<polygon fill="none" stroke="black" points="15401.5,-672.5 14952.5,-672.5 14952.5,-604.5 15401.5,-604.5 15401.5,-672.5"/>
<text text-anchor="middle" x="15177" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="15177" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="15177" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="15177" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L1_S0_TP5_GPU5_expert1&#45;&gt;L1_S0_TP0_GPU0_moe_ar -->
<g id="edge317" class="edge">
<title>L1_S0_TP5_GPU5_expert1&#45;&gt;L1_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M15008.62,-604.48C15008.62,-597.9 15008.62,-593 15008.62,-593 15008.62,-593 11370.08,-593 11370.08,-593 11370.08,-593 11370.08,-565.43 11370.08,-565.43"/>
<polygon fill="black" stroke="black" points="11373.58,-565.43 11370.08,-555.43 11366.58,-565.43 11373.58,-565.43"/>
</g>
<!-- L1_S0_TP5_GPU5_expert1&#45;&gt;L1_S0_TP1_GPU1_moe_ar -->
<g id="edge353" class="edge">
<title>L1_S0_TP5_GPU5_expert1&#45;&gt;L1_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M15064.75,-604.48C15064.75,-597.9 15064.75,-593 15064.75,-593 15064.75,-593 11833.17,-593 11833.17,-593 11833.17,-593 11833.17,-578.83 11833.17,-578.83"/>
<polygon fill="black" stroke="black" points="11836.67,-578.83 11833.17,-568.83 11829.67,-578.83 11836.67,-578.83"/>
</g>
<!-- L1_S0_TP5_GPU5_expert1&#45;&gt;L1_S0_TP2_GPU2_moe_ar -->
<g id="edge389" class="edge">
<title>L1_S0_TP5_GPU5_expert1&#45;&gt;L1_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M15102.17,-672.71C15102.17,-683.66 15102.17,-693 15102.17,-693 15102.17,-693 12608.5,-693 12608.5,-693 12608.5,-693 12608.5,-576.67 12608.5,-576.67"/>
<polygon fill="black" stroke="black" points="12612,-576.67 12608.5,-566.67 12605,-576.67 12612,-576.67"/>
</g>
<!-- L1_S0_TP5_GPU5_expert1&#45;&gt;L1_S0_TP3_GPU3_moe_ar -->
<g id="edge425" class="edge">
<title>L1_S0_TP5_GPU5_expert1&#45;&gt;L1_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M15120.88,-604.22C15120.88,-597.25 15120.88,-592 15120.88,-592 15120.88,-592 13483.58,-592 13483.58,-592 13483.58,-592 13483.58,-555.86 13483.58,-555.86"/>
<polygon fill="black" stroke="black" points="13487.08,-555.86 13483.58,-545.86 13480.08,-555.86 13487.08,-555.86"/>
</g>
<!-- L1_S0_TP5_GPU5_expert1&#45;&gt;L1_S0_TP4_GPU4_moe_ar -->
<g id="edge461" class="edge">
<title>L1_S0_TP5_GPU5_expert1&#45;&gt;L1_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M15177,-604.22C15177,-597.25 15177,-592 15177,-592 15177,-592 14144.73,-592 14144.73,-592 14144.73,-592 14144.73,-561.19 14144.73,-561.19"/>
<polygon fill="black" stroke="black" points="14148.23,-561.19 14144.73,-551.19 14141.23,-561.19 14148.23,-561.19"/>
</g>
<!-- L1_S0_TP5_GPU5_expert1&#45;&gt;L1_S0_TP5_GPU5_moe_ar -->
<g id="edge497" class="edge">
<title>L1_S0_TP5_GPU5_expert1&#45;&gt;L1_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M15233.12,-604.22C15233.12,-597.25 15233.12,-592 15233.12,-592 15233.12,-592 14696.48,-592 14696.48,-592 14696.48,-592 14696.48,-575.34 14696.48,-575.34"/>
<polygon fill="black" stroke="black" points="14699.98,-575.34 14696.48,-565.34 14692.98,-575.34 14699.98,-575.34"/>
</g>
<!-- L1_S0_TP5_GPU5_expert1&#45;&gt;L1_S0_TP6_GPU6_moe_ar -->
<g id="edge533" class="edge">
<title>L1_S0_TP5_GPU5_expert1&#45;&gt;L1_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M15289.25,-604.34C15289.25,-604.34 15289.25,-578.55 15289.25,-578.55"/>
<polygon fill="black" stroke="black" points="15292.75,-578.55 15289.25,-568.55 15285.75,-578.55 15292.75,-578.55"/>
</g>
<!-- L1_S0_TP5_GPU5_expert1&#45;&gt;L1_S0_TP7_GPU7_moe_ar -->
<g id="edge569" class="edge">
<title>L1_S0_TP5_GPU5_expert1&#45;&gt;L1_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M15345.38,-604.46C15345.38,-602.32 15345.38,-601 15345.38,-601 15345.38,-601 15811.62,-601 15811.62,-601 15811.62,-601 15811.62,-574.48 15811.62,-574.48"/>
<polygon fill="black" stroke="black" points="15815.12,-574.48 15811.62,-564.48 15808.12,-574.48 15815.12,-574.48"/>
</g>
<!-- L1_S0_TP6_GPU6_expert0 -->
<g id="node134" class="node">
<title>L1_S0_TP6_GPU6_expert0</title>
<polygon fill="none" stroke="black" points="15868.5,-672.5 15419.5,-672.5 15419.5,-604.5 15868.5,-604.5 15868.5,-672.5"/>
<text text-anchor="middle" x="15644" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="15644" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="15644" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="15644" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L1_S0_TP6_GPU6_expert0&#45;&gt;L1_S0_TP0_GPU0_moe_ar -->
<g id="edge318" class="edge">
<title>L1_S0_TP6_GPU6_expert0&#45;&gt;L1_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M15438.94,-604.48C15438.94,-597.9 15438.94,-593 15438.94,-593 15438.94,-593 11395.67,-593 11395.67,-593 11395.67,-593 11395.67,-561.2 11395.67,-561.2"/>
<polygon fill="black" stroke="black" points="11399.17,-561.2 11395.67,-551.2 11392.17,-561.2 11399.17,-561.2"/>
</g>
<!-- L1_S0_TP6_GPU6_expert0&#45;&gt;L1_S0_TP1_GPU1_moe_ar -->
<g id="edge354" class="edge">
<title>L1_S0_TP6_GPU6_expert0&#45;&gt;L1_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M15458.38,-604.48C15458.38,-597.9 15458.38,-593 15458.38,-593 15458.38,-593 11883.06,-593 11883.06,-593 11883.06,-593 11883.06,-578.02 11883.06,-578.02"/>
<polygon fill="black" stroke="black" points="11886.56,-578.02 11883.06,-568.02 11879.56,-578.02 11886.56,-578.02"/>
</g>
<!-- L1_S0_TP6_GPU6_expert0&#45;&gt;L1_S0_TP2_GPU2_moe_ar -->
<g id="edge390" class="edge">
<title>L1_S0_TP6_GPU6_expert0&#45;&gt;L1_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M15603.5,-604.17C15603.5,-548.34 15603.5,-444 15603.5,-444 15603.5,-444 12817.17,-444 12817.17,-444 12817.17,-444 12817.17,-490.74 12817.17,-490.74"/>
<polygon fill="black" stroke="black" points="12813.67,-490.74 12817.17,-500.74 12820.67,-490.74 12813.67,-490.74"/>
</g>
<!-- L1_S0_TP6_GPU6_expert0&#45;&gt;L1_S0_TP3_GPU3_moe_ar -->
<g id="edge426" class="edge">
<title>L1_S0_TP6_GPU6_expert0&#45;&gt;L1_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M15598.98,-604.17C15598.98,-548.34 15598.98,-444 15598.98,-444 15598.98,-444 13530.1,-444 13530.1,-444 13530.1,-444 13530.1,-503.36 13530.1,-503.36"/>
<polygon fill="black" stroke="black" points="13526.6,-503.36 13530.1,-513.36 13533.6,-503.36 13526.6,-503.36"/>
</g>
<!-- L1_S0_TP6_GPU6_expert0&#45;&gt;L1_S0_TP4_GPU4_moe_ar -->
<g id="edge462" class="edge">
<title>L1_S0_TP6_GPU6_expert0&#45;&gt;L1_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M15477.82,-604.22C15477.82,-597.25 15477.82,-592 15477.82,-592 15477.82,-592 14169.97,-592 14169.97,-592 14169.97,-592 14169.97,-555.86 14169.97,-555.86"/>
<polygon fill="black" stroke="black" points="14173.47,-555.86 14169.97,-545.86 14166.47,-555.86 14173.47,-555.86"/>
</g>
<!-- L1_S0_TP6_GPU6_expert0&#45;&gt;L1_S0_TP5_GPU5_moe_ar -->
<g id="edge498" class="edge">
<title>L1_S0_TP6_GPU6_expert0&#45;&gt;L1_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M15497.26,-604.22C15497.26,-597.25 15497.26,-592 15497.26,-592 15497.26,-592 14738.68,-592 14738.68,-592 14738.68,-592 14738.68,-572.47 14738.68,-572.47"/>
<polygon fill="black" stroke="black" points="14742.18,-572.47 14738.68,-562.47 14735.18,-572.47 14742.18,-572.47"/>
</g>
<!-- L1_S0_TP6_GPU6_expert0&#45;&gt;L1_S0_TP6_GPU6_moe_ar -->
<g id="edge534" class="edge">
<title>L1_S0_TP6_GPU6_expert0&#45;&gt;L1_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M15516.7,-604.34C15516.7,-604.34 15516.7,-561.27 15516.7,-561.27"/>
<polygon fill="black" stroke="black" points="15520.2,-561.27 15516.7,-551.27 15513.2,-561.27 15520.2,-561.27"/>
</g>
<!-- L1_S0_TP6_GPU6_expert0&#45;&gt;L1_S0_TP7_GPU7_moe_ar -->
<g id="edge570" class="edge">
<title>L1_S0_TP6_GPU6_expert0&#45;&gt;L1_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M15840.06,-604.34C15840.06,-604.34 15840.06,-576.36 15840.06,-576.36"/>
<polygon fill="black" stroke="black" points="15843.56,-576.36 15840.06,-566.36 15836.56,-576.36 15843.56,-576.36"/>
</g>
<!-- L1_S0_TP6_GPU6_expert1 -->
<g id="node135" class="node">
<title>L1_S0_TP6_GPU6_expert1</title>
<polygon fill="none" stroke="black" points="16335.5,-672.5 15886.5,-672.5 15886.5,-604.5 16335.5,-604.5 16335.5,-672.5"/>
<text text-anchor="middle" x="16111" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="16111" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="16111" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="16111" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L1_S0_TP6_GPU6_expert1&#45;&gt;L1_S0_TP0_GPU0_moe_ar -->
<g id="edge319" class="edge">
<title>L1_S0_TP6_GPU6_expert1&#45;&gt;L1_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M15952.33,-604.48C15952.33,-597.9 15952.33,-593 15952.33,-593 15952.33,-593 11421.27,-593 11421.27,-593 11421.27,-593 11421.27,-556.21 11421.27,-556.21"/>
<polygon fill="black" stroke="black" points="11424.77,-556.21 11421.27,-546.21 11417.77,-556.21 11424.77,-556.21"/>
</g>
<!-- L1_S0_TP6_GPU6_expert1&#45;&gt;L1_S0_TP1_GPU1_moe_ar -->
<g id="edge355" class="edge">
<title>L1_S0_TP6_GPU6_expert1&#45;&gt;L1_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M16321.99,-604.45C16321.99,-548.43 16321.99,-443 16321.99,-443 16321.99,-443 12063.6,-443 12063.6,-443 12063.6,-443 12063.6,-476.69 12063.6,-476.69"/>
<polygon fill="black" stroke="black" points="12060.1,-476.69 12063.6,-486.69 12067.1,-476.69 12060.1,-476.69"/>
</g>
<!-- L1_S0_TP6_GPU6_expert1&#45;&gt;L1_S0_TP2_GPU2_moe_ar -->
<g id="edge391" class="edge">
<title>L1_S0_TP6_GPU6_expert1&#45;&gt;L1_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M16308.48,-604.17C16308.48,-548.34 16308.48,-444 16308.48,-444 16308.48,-444 12787.88,-444 12787.88,-444 12787.88,-444 12787.88,-482.83 12787.88,-482.83"/>
<polygon fill="black" stroke="black" points="12784.38,-482.83 12787.88,-492.83 12791.38,-482.83 12784.38,-482.83"/>
</g>
<!-- L1_S0_TP6_GPU6_expert1&#45;&gt;L1_S0_TP3_GPU3_moe_ar -->
<g id="edge427" class="edge">
<title>L1_S0_TP6_GPU6_expert1&#45;&gt;L1_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M16294.97,-604.17C16294.97,-548.34 16294.97,-444 16294.97,-444 16294.97,-444 13526.73,-444 13526.73,-444 13526.73,-444 13526.73,-500.74 13526.73,-500.74"/>
<polygon fill="black" stroke="black" points="13523.23,-500.74 13526.73,-510.74 13530.23,-500.74 13523.23,-500.74"/>
</g>
<!-- L1_S0_TP6_GPU6_expert1&#45;&gt;L1_S0_TP4_GPU4_moe_ar -->
<g id="edge463" class="edge">
<title>L1_S0_TP6_GPU6_expert1&#45;&gt;L1_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M16018.15,-604.22C16018.15,-597.25 16018.15,-592 16018.15,-592 16018.15,-592 14195.22,-592 14195.22,-592 14195.22,-592 14195.22,-548.85 14195.22,-548.85"/>
<polygon fill="black" stroke="black" points="14198.72,-548.85 14195.22,-538.85 14191.72,-548.85 14198.72,-548.85"/>
</g>
<!-- L1_S0_TP6_GPU6_expert1&#45;&gt;L1_S0_TP5_GPU5_moe_ar -->
<g id="edge499" class="edge">
<title>L1_S0_TP6_GPU6_expert1&#45;&gt;L1_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M16083.98,-604.22C16083.98,-597.25 16083.98,-592 16083.98,-592 16083.98,-592 14780.87,-592 14780.87,-592 14780.87,-592 14780.87,-568.3 14780.87,-568.3"/>
<polygon fill="black" stroke="black" points="14784.37,-568.3 14780.87,-558.3 14777.37,-568.3 14784.37,-568.3"/>
</g>
<!-- L1_S0_TP6_GPU6_expert1&#45;&gt;L1_S0_TP6_GPU6_moe_ar -->
<g id="edge535" class="edge">
<title>L1_S0_TP6_GPU6_expert1&#45;&gt;L1_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M16149.81,-604.22C16149.81,-597.25 16149.81,-592 16149.81,-592 16149.81,-592 15536.14,-592 15536.14,-592 15536.14,-592 15536.14,-557.89 15536.14,-557.89"/>
<polygon fill="black" stroke="black" points="15539.64,-557.89 15536.14,-547.89 15532.64,-557.89 15539.64,-557.89"/>
</g>
<!-- L1_S0_TP6_GPU6_expert1&#45;&gt;L1_S0_TP7_GPU7_moe_ar -->
<g id="edge571" class="edge">
<title>L1_S0_TP6_GPU6_expert1&#45;&gt;L1_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M16215.63,-604.34C16215.63,-604.34 16215.63,-559.3 16215.63,-559.3"/>
<polygon fill="black" stroke="black" points="16219.13,-559.3 16215.63,-549.3 16212.13,-559.3 16219.13,-559.3"/>
</g>
<!-- L1_S0_TP7_GPU7_expert0 -->
<g id="node136" class="node">
<title>L1_S0_TP7_GPU7_expert0</title>
<polygon fill="none" stroke="black" points="16802.5,-672.5 16353.5,-672.5 16353.5,-604.5 16802.5,-604.5 16802.5,-672.5"/>
<text text-anchor="middle" x="16578" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="16578" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="16578" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="16578" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L1_S0_TP7_GPU7_expert0&#45;&gt;L1_S0_TP0_GPU0_moe_ar -->
<g id="edge320" class="edge">
<title>L1_S0_TP7_GPU7_expert0&#45;&gt;L1_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M16364.56,-604.48C16364.56,-597.9 16364.56,-593 16364.56,-593 16364.56,-593 11446.87,-593 11446.87,-593 11446.87,-593 11446.87,-549.11 11446.87,-549.11"/>
<polygon fill="black" stroke="black" points="11450.37,-549.11 11446.87,-539.11 11443.37,-549.11 11450.37,-549.11"/>
</g>
<!-- L1_S0_TP7_GPU7_expert0&#45;&gt;L1_S0_TP1_GPU1_moe_ar -->
<g id="edge356" class="edge">
<title>L1_S0_TP7_GPU7_expert0&#45;&gt;L1_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M16430.89,-604.45C16430.89,-548.43 16430.89,-443 16430.89,-443 16430.89,-443 11967.73,-443 11967.73,-443 11967.73,-443 11967.73,-466.73 11967.73,-466.73"/>
<polygon fill="black" stroke="black" points="11964.23,-466.73 11967.73,-476.73 11971.23,-466.73 11964.23,-466.73"/>
</g>
<!-- L1_S0_TP7_GPU7_expert0&#45;&gt;L1_S0_TP2_GPU2_moe_ar -->
<g id="edge392" class="edge">
<title>L1_S0_TP7_GPU7_expert0&#45;&gt;L1_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M16419.83,-604.45C16419.83,-548.43 16419.83,-443 16419.83,-443 16419.83,-443 12758.58,-443 12758.58,-443 12758.58,-443 12758.58,-477.58 12758.58,-477.58"/>
<polygon fill="black" stroke="black" points="12755.08,-477.58 12758.58,-487.58 12762.08,-477.58 12755.08,-477.58"/>
</g>
<!-- L1_S0_TP7_GPU7_expert0&#45;&gt;L1_S0_TP3_GPU3_moe_ar -->
<g id="edge428" class="edge">
<title>L1_S0_TP7_GPU7_expert0&#45;&gt;L1_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M16441.94,-604.23C16441.94,-529.59 16441.94,-359 16441.94,-359 16441.94,-359 13523.37,-359 13523.37,-359 13523.37,-359 13523.37,-498.55 13523.37,-498.55"/>
<polygon fill="black" stroke="black" points="13519.87,-498.55 13523.37,-508.55 13526.87,-498.55 13519.87,-498.55"/>
</g>
<!-- L1_S0_TP7_GPU7_expert0&#45;&gt;L1_S0_TP4_GPU4_moe_ar -->
<g id="edge464" class="edge">
<title>L1_S0_TP7_GPU7_expert0&#45;&gt;L1_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M16408.78,-604.47C16408.78,-553.18 16408.78,-462 16408.78,-462 16408.78,-462 14071.6,-462 14071.6,-462 14071.6,-462 14071.6,-470.16 14071.6,-470.16"/>
<polygon fill="black" stroke="black" points="14068.1,-470.16 14071.6,-480.16 14075.1,-470.16 14068.1,-470.16"/>
</g>
<!-- L1_S0_TP7_GPU7_expert0&#45;&gt;L1_S0_TP5_GPU5_moe_ar -->
<g id="edge500" class="edge">
<title>L1_S0_TP7_GPU7_expert0&#45;&gt;L1_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M16375.61,-604.22C16375.61,-597.25 16375.61,-592 16375.61,-592 16375.61,-592 14823.07,-592 14823.07,-592 14823.07,-592 14823.07,-562.44 14823.07,-562.44"/>
<polygon fill="black" stroke="black" points="14826.57,-562.44 14823.07,-552.44 14819.57,-562.44 14826.57,-562.44"/>
</g>
<!-- L1_S0_TP7_GPU7_expert0&#45;&gt;L1_S0_TP6_GPU6_moe_ar -->
<g id="edge536" class="edge">
<title>L1_S0_TP7_GPU7_expert0&#45;&gt;L1_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M16386.67,-604.22C16386.67,-597.25 16386.67,-592 16386.67,-592 16386.67,-592 15555.58,-592 15555.58,-592 15555.58,-592 15555.58,-553.07 15555.58,-553.07"/>
<polygon fill="black" stroke="black" points="15559.08,-553.07 15555.58,-543.07 15552.08,-553.07 15559.08,-553.07"/>
</g>
<!-- L1_S0_TP7_GPU7_expert0&#45;&gt;L1_S0_TP7_GPU7_moe_ar -->
<g id="edge572" class="edge">
<title>L1_S0_TP7_GPU7_expert0&#45;&gt;L1_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M16397.72,-604.21C16397.72,-567.05 16397.72,-513 16397.72,-513 16397.72,-513 16287.53,-513 16287.53,-513"/>
<polygon fill="black" stroke="black" points="16287.53,-509.5 16277.53,-513 16287.53,-516.5 16287.53,-509.5"/>
</g>
<!-- L1_S0_TP7_GPU7_expert1 -->
<g id="node137" class="node">
<title>L1_S0_TP7_GPU7_expert1</title>
<polygon fill="none" stroke="black" points="17269.5,-672.5 16820.5,-672.5 16820.5,-604.5 17269.5,-604.5 17269.5,-672.5"/>
<text text-anchor="middle" x="17045" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="17045" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="17045" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="17045" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L1_S0_TP7_GPU7_expert1&#45;&gt;L1_S0_TP0_GPU0_moe_ar -->
<g id="edge321" class="edge">
<title>L1_S0_TP7_GPU7_expert1&#45;&gt;L1_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M16970.17,-672.84C16970.17,-690.35 16970.17,-708 16970.17,-708 16970.17,-708 11202.1,-708 11202.1,-708 11202.1,-708 11202.1,-577.75 11202.1,-577.75"/>
<polygon fill="black" stroke="black" points="11205.6,-577.75 11202.1,-567.75 11198.6,-577.75 11205.6,-577.75"/>
</g>
<!-- L1_S0_TP7_GPU7_expert1&#45;&gt;L1_S0_TP1_GPU1_moe_ar -->
<g id="edge357" class="edge">
<title>L1_S0_TP7_GPU7_expert1&#45;&gt;L1_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M17213.38,-604.45C17213.38,-548.43 17213.38,-443 17213.38,-443 17213.38,-443 11871.87,-443 11871.87,-443 11871.87,-443 11871.87,-462.71 11871.87,-462.71"/>
<polygon fill="black" stroke="black" points="11868.37,-462.71 11871.87,-472.71 11875.37,-462.71 11868.37,-462.71"/>
</g>
<!-- L1_S0_TP7_GPU7_expert1&#45;&gt;L1_S0_TP2_GPU2_moe_ar -->
<g id="edge393" class="edge">
<title>L1_S0_TP7_GPU7_expert1&#45;&gt;L1_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M17157.25,-604.45C17157.25,-548.43 17157.25,-443 17157.25,-443 17157.25,-443 12729.29,-443 12729.29,-443 12729.29,-443 12729.29,-473.52 12729.29,-473.52"/>
<polygon fill="black" stroke="black" points="12725.79,-473.52 12729.29,-483.52 12732.79,-473.52 12725.79,-473.52"/>
</g>
<!-- L1_S0_TP7_GPU7_expert1&#45;&gt;L1_S0_TP3_GPU3_moe_ar -->
<g id="edge429" class="edge">
<title>L1_S0_TP7_GPU7_expert1&#45;&gt;L1_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M17101.12,-604.17C17101.12,-548.34 17101.12,-444 17101.12,-444 17101.12,-444 13356.13,-444 13356.13,-444 13356.13,-444 13356.13,-467.74 13356.13,-467.74"/>
<polygon fill="black" stroke="black" points="13352.63,-467.74 13356.13,-477.74 13359.63,-467.74 13352.63,-467.74"/>
</g>
<!-- L1_S0_TP7_GPU7_expert1&#45;&gt;L1_S0_TP4_GPU4_moe_ar -->
<g id="edge465" class="edge">
<title>L1_S0_TP7_GPU7_expert1&#45;&gt;L1_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M17045,-604.47C17045,-553.18 17045,-462 17045,-462 17045,-462 13922.73,-462 13922.73,-462 13922.73,-462 13922.73,-463.04 13922.73,-463.04"/>
<polygon fill="black" stroke="black" points="13919.23,-462.44 13922.73,-472.44 13926.23,-462.44 13919.23,-462.44"/>
</g>
<!-- L1_S0_TP7_GPU7_expert1&#45;&gt;L1_S0_TP5_GPU5_moe_ar -->
<g id="edge501" class="edge">
<title>L1_S0_TP7_GPU7_expert1&#45;&gt;L1_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M16876.62,-604.22C16876.62,-597.25 16876.62,-592 16876.62,-592 16876.62,-592 14865.27,-592 14865.27,-592 14865.27,-592 14865.27,-553.86 14865.27,-553.86"/>
<polygon fill="black" stroke="black" points="14868.77,-553.86 14865.27,-543.86 14861.77,-553.86 14868.77,-553.86"/>
</g>
<!-- L1_S0_TP7_GPU7_expert1&#45;&gt;L1_S0_TP6_GPU6_moe_ar -->
<g id="edge537" class="edge">
<title>L1_S0_TP7_GPU7_expert1&#45;&gt;L1_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M16932.75,-604.22C16932.75,-597.25 16932.75,-592 16932.75,-592 16932.75,-592 15575.02,-592 15575.02,-592 15575.02,-592 15575.02,-546.66 15575.02,-546.66"/>
<polygon fill="black" stroke="black" points="15578.52,-546.66 15575.02,-536.66 15571.52,-546.66 15578.52,-546.66"/>
</g>
<!-- L1_S0_TP7_GPU7_expert1&#45;&gt;L1_S0_TP7_GPU7_moe_ar -->
<g id="edge573" class="edge">
<title>L1_S0_TP7_GPU7_expert1&#45;&gt;L1_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M16988.88,-604.37C16988.88,-563.08 16988.88,-499 16988.88,-499 16988.88,-499 16256.61,-499 16256.61,-499"/>
<polygon fill="black" stroke="black" points="16256.61,-495.5 16246.61,-499 16256.61,-502.5 16256.61,-495.5"/>
</g>
<!-- L1_S0_TP0_GPU0_norm -->
<g id="node139" class="node">
<title>L1_S0_TP0_GPU0_norm</title>
<polygon fill="none" stroke="black" points="10219.5,-332.33 9770.5,-332.33 9770.5,-264.33 10219.5,-264.33 10219.5,-332.33"/>
<text text-anchor="middle" x="9995" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="9995" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="9995" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="9995" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP0_GPU0_moe_res&#45;&gt;L1_S0_TP0_GPU0_norm -->
<g id="edge324" class="edge">
<title>L1_S0_TP0_GPU0_moe_res&#45;&gt;L1_S0_TP0_GPU0_norm</title>
<path fill="none" stroke="black" d="M9995,-368.28C9995,-368.28 9995,-342.46 9995,-342.46"/>
<polygon fill="black" stroke="black" points="9998.5,-342.46 9995,-332.46 9991.5,-342.46 9998.5,-342.46"/>
</g>
<!-- L1_S0_TP1_GPU1_qkv_linear -->
<g id="node140" class="node">
<title>L1_S0_TP1_GPU1_qkv_linear</title>
<polygon fill="none" stroke="black" points="11169,-1614.75 10561,-1614.75 10561,-1546.75 11169,-1546.75 11169,-1614.75"/>
<text text-anchor="middle" x="10865" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="10865" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="10865" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="10865" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L1_S0_TP1_GPU1_qkv_slice -->
<g id="node141" class="node">
<title>L1_S0_TP1_GPU1_qkv_slice</title>
<polygon fill="none" stroke="black" points="11163,-1496.67 10567,-1496.67 10567,-1428.67 11163,-1428.67 11163,-1496.67"/>
<text text-anchor="middle" x="10865" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="10865" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="10865" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="10865" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L1_S0_TP1_GPU1_qkv_linear&#45;&gt;L1_S0_TP1_GPU1_qkv_slice -->
<g id="edge325" class="edge">
<title>L1_S0_TP1_GPU1_qkv_linear&#45;&gt;L1_S0_TP1_GPU1_qkv_slice</title>
<path fill="none" stroke="black" d="M10865,-1546.59C10865,-1546.59 10865,-1506.74 10865,-1506.74"/>
<polygon fill="black" stroke="black" points="10868.5,-1506.74 10865,-1496.74 10861.5,-1506.74 10868.5,-1506.74"/>
</g>
<!-- L1_S0_TP1_GPU1_qkv_slice&#45;&gt;L1_S0_TP1_GPU1_attn_v -->
<g id="edge329" class="edge">
<title>L1_S0_TP1_GPU1_qkv_slice&#45;&gt;L1_S0_TP1_GPU1_attn_v</title>
<path fill="none" stroke="black" d="M10713.25,-1428.38C10713.25,-1428.38 10713.25,-1195 10713.25,-1195"/>
<polygon fill="black" stroke="black" points="10716.75,-1195 10713.25,-1185 10709.75,-1195 10716.75,-1195"/>
</g>
<!-- L1_S0_TP1_GPU1_qk_matmul -->
<g id="node142" class="node">
<title>L1_S0_TP1_GPU1_qk_matmul</title>
<polygon fill="none" stroke="black" points="11676.5,-1392.67 10741.5,-1392.67 10741.5,-1324.67 11676.5,-1324.67 11676.5,-1392.67"/>
<text text-anchor="middle" x="11209" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="11209" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="11209" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="11209" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L1_S0_TP1_GPU1_qkv_slice&#45;&gt;L1_S0_TP1_GPU1_qk_matmul -->
<g id="edge326" class="edge">
<title>L1_S0_TP1_GPU1_qkv_slice&#45;&gt;L1_S0_TP1_GPU1_qk_matmul</title>
<path fill="none" stroke="black" d="M10952.25,-1428.61C10952.25,-1428.61 10952.25,-1402.8 10952.25,-1402.8"/>
<polygon fill="black" stroke="black" points="10955.75,-1402.8 10952.25,-1392.8 10948.75,-1402.8 10955.75,-1402.8"/>
</g>
<!-- L1_S0_TP1_GPU1_softmax -->
<g id="node143" class="node">
<title>L1_S0_TP1_GPU1_softmax</title>
<polygon fill="none" stroke="black" points="11436,-1288.67 10926,-1288.67 10926,-1220.67 11436,-1220.67 11436,-1288.67"/>
<text text-anchor="middle" x="11181" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="11181" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="11181" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="11181" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L1_S0_TP1_GPU1_qk_matmul&#45;&gt;L1_S0_TP1_GPU1_softmax -->
<g id="edge327" class="edge">
<title>L1_S0_TP1_GPU1_qk_matmul&#45;&gt;L1_S0_TP1_GPU1_softmax</title>
<path fill="none" stroke="black" d="M11181,-1324.61C11181,-1324.61 11181,-1298.8 11181,-1298.8"/>
<polygon fill="black" stroke="black" points="11184.5,-1298.8 11181,-1288.8 11177.5,-1298.8 11184.5,-1298.8"/>
</g>
<!-- L1_S0_TP1_GPU1_softmax&#45;&gt;L1_S0_TP1_GPU1_attn_v -->
<g id="edge328" class="edge">
<title>L1_S0_TP1_GPU1_softmax&#45;&gt;L1_S0_TP1_GPU1_attn_v</title>
<path fill="none" stroke="black" d="M11181,-1220.61C11181,-1220.61 11181,-1194.8 11181,-1194.8"/>
<polygon fill="black" stroke="black" points="11184.5,-1194.8 11181,-1184.8 11177.5,-1194.8 11184.5,-1194.8"/>
</g>
<!-- L1_S0_TP1_GPU1_mha_res -->
<g id="node145" class="node">
<title>L1_S0_TP1_GPU1_mha_res</title>
<polygon fill="none" stroke="black" points="11291.5,-948.5 10404.5,-948.5 10404.5,-880.5 11291.5,-880.5 11291.5,-948.5"/>
<text text-anchor="middle" x="10848" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="10848" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="10848" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="10848" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP1_GPU1_mha_ar&#45;&gt;L1_S0_TP1_GPU1_mha_res -->
<g id="edge338" class="edge">
<title>L1_S0_TP1_GPU1_mha_ar&#45;&gt;L1_S0_TP1_GPU1_mha_res</title>
<path fill="none" stroke="black" d="M11268.51,-1015.91C11268.51,-1015.91 11268.51,-958.58 11268.51,-958.58"/>
<polygon fill="black" stroke="black" points="11272.01,-958.58 11268.51,-948.58 11265.01,-958.58 11272.01,-958.58"/>
</g>
<!-- L1_S0_TP1_GPU1_gate -->
<g id="node146" class="node">
<title>L1_S0_TP1_GPU1_gate</title>
<polygon fill="none" stroke="black" points="11377.56,-844.5 10535.15,-844.5 10318.44,-708.5 11160.85,-708.5 11377.56,-844.5"/>
<text text-anchor="middle" x="10848" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="10848" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="10848" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="10848" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L1_S0_TP1_GPU1_mha_res&#45;&gt;L1_S0_TP1_GPU1_gate -->
<g id="edge339" class="edge">
<title>L1_S0_TP1_GPU1_mha_res&#45;&gt;L1_S0_TP1_GPU1_gate</title>
<path fill="none" stroke="black" d="M10848,-880.39C10848,-880.39 10848,-854.73 10848,-854.73"/>
<polygon fill="black" stroke="black" points="10851.5,-854.73 10848,-844.73 10844.5,-854.73 10851.5,-854.73"/>
</g>
<!-- L1_S0_TP1_GPU1_moe_res -->
<g id="node148" class="node">
<title>L1_S0_TP1_GPU1_moe_res</title>
<polygon fill="none" stroke="black" points="11586,-436.33 10766,-436.33 10766,-368.33 11586,-368.33 11586,-436.33"/>
<text text-anchor="middle" x="11176" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="11176" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11176" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11176" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP1_GPU1_mha_res&#45;&gt;L1_S0_TP1_GPU1_moe_res -->
<g id="edge359" class="edge">
<title>L1_S0_TP1_GPU1_mha_res&#45;&gt;L1_S0_TP1_GPU1_moe_res</title>
<path fill="none" stroke="black" d="M10404.2,-925C10349.33,-925 10312.07,-925 10312.07,-925 10312.07,-925 10312.07,-683 10312.07,-683 10312.07,-683 10740.5,-683 10740.5,-683 10740.5,-683 10740.5,-402 10740.5,-402 10740.5,-402 10755.8,-402 10755.8,-402"/>
<polygon fill="black" stroke="black" points="10755.8,-405.5 10765.8,-402 10755.8,-398.5 10755.8,-405.5"/>
</g>
<!-- L1_S0_TP1_GPU1_gate&#45;&gt;L1_S0_TP1_GPU1_expert0 -->
<g id="edge340" class="edge">
<title>L1_S0_TP1_GPU1_gate&#45;&gt;L1_S0_TP1_GPU1_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10974,-708.31C10974,-708.31 10974,-682.71 10974,-682.71"/>
<polygon fill="black" stroke="black" points="10977.5,-682.71 10974,-672.71 10970.5,-682.71 10977.5,-682.71"/>
</g>
<!-- L1_S0_TP1_GPU1_gate&#45;&gt;L1_S0_TP1_GPU1_expert1 -->
<g id="edge341" class="edge">
<title>L1_S0_TP1_GPU1_gate&#45;&gt;L1_S0_TP1_GPU1_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11297.14,-776.4C11297.14,-776.4 11297.14,-682.74 11297.14,-682.74"/>
<polygon fill="black" stroke="black" points="11300.64,-682.74 11297.14,-672.74 11293.64,-682.74 11300.64,-682.74"/>
</g>
<!-- L1_S0_TP1_GPU1_moe_ar&#45;&gt;L1_S0_TP1_GPU1_moe_res -->
<g id="edge358" class="edge">
<title>L1_S0_TP1_GPU1_moe_ar&#45;&gt;L1_S0_TP1_GPU1_moe_res</title>
<path fill="none" stroke="black" d="M11538.27,-495.37C11538.27,-495.37 11538.27,-446.75 11538.27,-446.75"/>
<polygon fill="black" stroke="black" points="11541.77,-446.75 11538.27,-436.75 11534.77,-446.75 11541.77,-446.75"/>
</g>
<!-- L1_S0_TP1_GPU1_norm -->
<g id="node149" class="node">
<title>L1_S0_TP1_GPU1_norm</title>
<polygon fill="none" stroke="black" points="11400.5,-332.33 10951.5,-332.33 10951.5,-264.33 11400.5,-264.33 11400.5,-332.33"/>
<text text-anchor="middle" x="11176" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="11176" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11176" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11176" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP1_GPU1_moe_res&#45;&gt;L1_S0_TP1_GPU1_norm -->
<g id="edge360" class="edge">
<title>L1_S0_TP1_GPU1_moe_res&#45;&gt;L1_S0_TP1_GPU1_norm</title>
<path fill="none" stroke="black" d="M11176,-368.28C11176,-368.28 11176,-342.46 11176,-342.46"/>
<polygon fill="black" stroke="black" points="11179.5,-342.46 11176,-332.46 11172.5,-342.46 11179.5,-342.46"/>
</g>
<!-- L1_S0_TP2_GPU2_qkv_linear -->
<g id="node150" class="node">
<title>L1_S0_TP2_GPU2_qkv_linear</title>
<polygon fill="none" stroke="black" points="12265,-1614.75 11657,-1614.75 11657,-1546.75 12265,-1546.75 12265,-1614.75"/>
<text text-anchor="middle" x="11961" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="11961" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11961" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="11961" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L1_S0_TP2_GPU2_qkv_slice -->
<g id="node151" class="node">
<title>L1_S0_TP2_GPU2_qkv_slice</title>
<polygon fill="none" stroke="black" points="12259,-1496.67 11663,-1496.67 11663,-1428.67 12259,-1428.67 12259,-1496.67"/>
<text text-anchor="middle" x="11961" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="11961" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="11961" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="11961" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L1_S0_TP2_GPU2_qkv_linear&#45;&gt;L1_S0_TP2_GPU2_qkv_slice -->
<g id="edge361" class="edge">
<title>L1_S0_TP2_GPU2_qkv_linear&#45;&gt;L1_S0_TP2_GPU2_qkv_slice</title>
<path fill="none" stroke="black" d="M11961,-1546.59C11961,-1546.59 11961,-1506.74 11961,-1506.74"/>
<polygon fill="black" stroke="black" points="11964.5,-1506.74 11961,-1496.74 11957.5,-1506.74 11964.5,-1506.74"/>
</g>
<!-- L1_S0_TP2_GPU2_qkv_slice&#45;&gt;L1_S0_TP2_GPU2_attn_v -->
<g id="edge365" class="edge">
<title>L1_S0_TP2_GPU2_qkv_slice&#45;&gt;L1_S0_TP2_GPU2_attn_v</title>
<path fill="none" stroke="black" d="M11709,-1428.38C11709,-1428.38 11709,-1195 11709,-1195"/>
<polygon fill="black" stroke="black" points="11712.5,-1195 11709,-1185 11705.5,-1195 11712.5,-1195"/>
</g>
<!-- L1_S0_TP2_GPU2_qk_matmul -->
<g id="node152" class="node">
<title>L1_S0_TP2_GPU2_qk_matmul</title>
<polygon fill="none" stroke="black" points="12676.5,-1392.67 11741.5,-1392.67 11741.5,-1324.67 12676.5,-1324.67 12676.5,-1392.67"/>
<text text-anchor="middle" x="12209" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="12209" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="12209" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="12209" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L1_S0_TP2_GPU2_qkv_slice&#45;&gt;L1_S0_TP2_GPU2_qk_matmul -->
<g id="edge362" class="edge">
<title>L1_S0_TP2_GPU2_qkv_slice&#45;&gt;L1_S0_TP2_GPU2_qk_matmul</title>
<path fill="none" stroke="black" d="M12000.25,-1428.61C12000.25,-1428.61 12000.25,-1402.8 12000.25,-1402.8"/>
<polygon fill="black" stroke="black" points="12003.75,-1402.8 12000.25,-1392.8 11996.75,-1402.8 12003.75,-1402.8"/>
</g>
<!-- L1_S0_TP2_GPU2_softmax -->
<g id="node153" class="node">
<title>L1_S0_TP2_GPU2_softmax</title>
<polygon fill="none" stroke="black" points="12414,-1288.67 11904,-1288.67 11904,-1220.67 12414,-1220.67 12414,-1288.67"/>
<text text-anchor="middle" x="12159" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="12159" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="12159" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="12159" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L1_S0_TP2_GPU2_qk_matmul&#45;&gt;L1_S0_TP2_GPU2_softmax -->
<g id="edge363" class="edge">
<title>L1_S0_TP2_GPU2_qk_matmul&#45;&gt;L1_S0_TP2_GPU2_softmax</title>
<path fill="none" stroke="black" d="M12159,-1324.61C12159,-1324.61 12159,-1298.8 12159,-1298.8"/>
<polygon fill="black" stroke="black" points="12162.5,-1298.8 12159,-1288.8 12155.5,-1298.8 12162.5,-1298.8"/>
</g>
<!-- L1_S0_TP2_GPU2_softmax&#45;&gt;L1_S0_TP2_GPU2_attn_v -->
<g id="edge364" class="edge">
<title>L1_S0_TP2_GPU2_softmax&#45;&gt;L1_S0_TP2_GPU2_attn_v</title>
<path fill="none" stroke="black" d="M12159,-1220.61C12159,-1220.61 12159,-1194.8 12159,-1194.8"/>
<polygon fill="black" stroke="black" points="12162.5,-1194.8 12159,-1184.8 12155.5,-1194.8 12162.5,-1194.8"/>
</g>
<!-- L1_S0_TP2_GPU2_mha_res -->
<g id="node155" class="node">
<title>L1_S0_TP2_GPU2_mha_res</title>
<polygon fill="none" stroke="black" points="12369.5,-948.5 11482.5,-948.5 11482.5,-880.5 12369.5,-880.5 12369.5,-948.5"/>
<text text-anchor="middle" x="11926" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="11926" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11926" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11926" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP2_GPU2_mha_ar&#45;&gt;L1_S0_TP2_GPU2_mha_res -->
<g id="edge374" class="edge">
<title>L1_S0_TP2_GPU2_mha_ar&#45;&gt;L1_S0_TP2_GPU2_mha_res</title>
<path fill="none" stroke="black" d="M12192.01,-991.61C12192.01,-991.61 12192.01,-958.74 12192.01,-958.74"/>
<polygon fill="black" stroke="black" points="12195.51,-958.74 12192.01,-948.74 12188.51,-958.74 12195.51,-958.74"/>
</g>
<!-- L1_S0_TP2_GPU2_gate -->
<g id="node156" class="node">
<title>L1_S0_TP2_GPU2_gate</title>
<polygon fill="none" stroke="black" points="12455.56,-844.5 11613.15,-844.5 11396.44,-708.5 12238.85,-708.5 12455.56,-844.5"/>
<text text-anchor="middle" x="11926" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="11926" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11926" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="11926" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L1_S0_TP2_GPU2_mha_res&#45;&gt;L1_S0_TP2_GPU2_gate -->
<g id="edge375" class="edge">
<title>L1_S0_TP2_GPU2_mha_res&#45;&gt;L1_S0_TP2_GPU2_gate</title>
<path fill="none" stroke="black" d="M11926,-880.39C11926,-880.39 11926,-854.73 11926,-854.73"/>
<polygon fill="black" stroke="black" points="11929.5,-854.73 11926,-844.73 11922.5,-854.73 11929.5,-854.73"/>
</g>
<!-- L1_S0_TP2_GPU2_moe_res -->
<g id="node158" class="node">
<title>L1_S0_TP2_GPU2_moe_res</title>
<polygon fill="none" stroke="black" points="12596,-436.33 11776,-436.33 11776,-368.33 12596,-368.33 12596,-436.33"/>
<text text-anchor="middle" x="12186" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="12186" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="12186" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="12186" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP2_GPU2_mha_res&#45;&gt;L1_S0_TP2_GPU2_moe_res -->
<g id="edge395" class="edge">
<title>L1_S0_TP2_GPU2_mha_res&#45;&gt;L1_S0_TP2_GPU2_moe_res</title>
<path fill="none" stroke="black" d="M12369.57,-914C12426.27,-914 12465,-914 12465,-914 12465,-914 12465,-682 12465,-682 12465,-682 12142.79,-682 12142.79,-682 12142.79,-682 12142.79,-593 12142.79,-593 12142.79,-593 12171.51,-593 12171.51,-593 12171.51,-593 12171.51,-446.42 12171.51,-446.42"/>
<polygon fill="black" stroke="black" points="12175.01,-446.42 12171.51,-436.42 12168.01,-446.42 12175.01,-446.42"/>
</g>
<!-- L1_S0_TP2_GPU2_gate&#45;&gt;L1_S0_TP2_GPU2_expert0 -->
<g id="edge376" class="edge">
<title>L1_S0_TP2_GPU2_gate&#45;&gt;L1_S0_TP2_GPU2_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11795.75,-708.31C11795.75,-708.31 11795.75,-682.71 11795.75,-682.71"/>
<polygon fill="black" stroke="black" points="11799.25,-682.71 11795.75,-672.71 11792.25,-682.71 11799.25,-682.71"/>
</g>
<!-- L1_S0_TP2_GPU2_gate&#45;&gt;L1_S0_TP2_GPU2_expert1 -->
<g id="edge377" class="edge">
<title>L1_S0_TP2_GPU2_gate&#45;&gt;L1_S0_TP2_GPU2_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12303.14,-748.57C12303.14,-748.57 12303.14,-682.74 12303.14,-682.74"/>
<polygon fill="black" stroke="black" points="12306.64,-682.74 12303.14,-672.74 12299.64,-682.74 12306.64,-682.74"/>
</g>
<!-- L1_S0_TP2_GPU2_moe_ar&#45;&gt;L1_S0_TP2_GPU2_moe_res -->
<g id="edge394" class="edge">
<title>L1_S0_TP2_GPU2_moe_ar&#45;&gt;L1_S0_TP2_GPU2_moe_res</title>
<path fill="none" stroke="black" d="M12456.51,-472.73C12456.51,-472.73 12456.51,-446.41 12456.51,-446.41"/>
<polygon fill="black" stroke="black" points="12460.01,-446.41 12456.51,-436.41 12453.01,-446.41 12460.01,-446.41"/>
</g>
<!-- L1_S0_TP2_GPU2_norm -->
<g id="node159" class="node">
<title>L1_S0_TP2_GPU2_norm</title>
<polygon fill="none" stroke="black" points="12410.5,-332.33 11961.5,-332.33 11961.5,-264.33 12410.5,-264.33 12410.5,-332.33"/>
<text text-anchor="middle" x="12186" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="12186" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="12186" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="12186" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP2_GPU2_moe_res&#45;&gt;L1_S0_TP2_GPU2_norm -->
<g id="edge396" class="edge">
<title>L1_S0_TP2_GPU2_moe_res&#45;&gt;L1_S0_TP2_GPU2_norm</title>
<path fill="none" stroke="black" d="M12186,-368.28C12186,-368.28 12186,-342.46 12186,-342.46"/>
<polygon fill="black" stroke="black" points="12189.5,-342.46 12186,-332.46 12182.5,-342.46 12189.5,-342.46"/>
</g>
<!-- L1_S0_TP3_GPU3_qkv_linear -->
<g id="node160" class="node">
<title>L1_S0_TP3_GPU3_qkv_linear</title>
<polygon fill="none" stroke="black" points="13261,-1614.75 12653,-1614.75 12653,-1546.75 13261,-1546.75 13261,-1614.75"/>
<text text-anchor="middle" x="12957" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="12957" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="12957" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="12957" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L1_S0_TP3_GPU3_qkv_slice -->
<g id="node161" class="node">
<title>L1_S0_TP3_GPU3_qkv_slice</title>
<polygon fill="none" stroke="black" points="13255,-1496.67 12659,-1496.67 12659,-1428.67 13255,-1428.67 13255,-1496.67"/>
<text text-anchor="middle" x="12957" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="12957" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="12957" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="12957" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L1_S0_TP3_GPU3_qkv_linear&#45;&gt;L1_S0_TP3_GPU3_qkv_slice -->
<g id="edge397" class="edge">
<title>L1_S0_TP3_GPU3_qkv_linear&#45;&gt;L1_S0_TP3_GPU3_qkv_slice</title>
<path fill="none" stroke="black" d="M12957,-1546.59C12957,-1546.59 12957,-1506.74 12957,-1506.74"/>
<polygon fill="black" stroke="black" points="12960.5,-1506.74 12957,-1496.74 12953.5,-1506.74 12960.5,-1506.74"/>
</g>
<!-- L1_S0_TP3_GPU3_qkv_slice&#45;&gt;L1_S0_TP3_GPU3_attn_v -->
<g id="edge401" class="edge">
<title>L1_S0_TP3_GPU3_qkv_slice&#45;&gt;L1_S0_TP3_GPU3_attn_v</title>
<path fill="none" stroke="black" d="M12707,-1428.38C12707,-1428.38 12707,-1195 12707,-1195"/>
<polygon fill="black" stroke="black" points="12710.5,-1195 12707,-1185 12703.5,-1195 12710.5,-1195"/>
</g>
<!-- L1_S0_TP3_GPU3_qk_matmul -->
<g id="node162" class="node">
<title>L1_S0_TP3_GPU3_qk_matmul</title>
<polygon fill="none" stroke="black" points="13672.5,-1392.67 12737.5,-1392.67 12737.5,-1324.67 13672.5,-1324.67 13672.5,-1392.67"/>
<text text-anchor="middle" x="13205" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="13205" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="13205" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="13205" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L1_S0_TP3_GPU3_qkv_slice&#45;&gt;L1_S0_TP3_GPU3_qk_matmul -->
<g id="edge398" class="edge">
<title>L1_S0_TP3_GPU3_qkv_slice&#45;&gt;L1_S0_TP3_GPU3_qk_matmul</title>
<path fill="none" stroke="black" d="M12996.25,-1428.61C12996.25,-1428.61 12996.25,-1402.8 12996.25,-1402.8"/>
<polygon fill="black" stroke="black" points="12999.75,-1402.8 12996.25,-1392.8 12992.75,-1402.8 12999.75,-1402.8"/>
</g>
<!-- L1_S0_TP3_GPU3_softmax -->
<g id="node163" class="node">
<title>L1_S0_TP3_GPU3_softmax</title>
<polygon fill="none" stroke="black" points="13390,-1288.67 12880,-1288.67 12880,-1220.67 13390,-1220.67 13390,-1288.67"/>
<text text-anchor="middle" x="13135" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="13135" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="13135" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="13135" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L1_S0_TP3_GPU3_qk_matmul&#45;&gt;L1_S0_TP3_GPU3_softmax -->
<g id="edge399" class="edge">
<title>L1_S0_TP3_GPU3_qk_matmul&#45;&gt;L1_S0_TP3_GPU3_softmax</title>
<path fill="none" stroke="black" d="M13135,-1324.61C13135,-1324.61 13135,-1298.8 13135,-1298.8"/>
<polygon fill="black" stroke="black" points="13138.5,-1298.8 13135,-1288.8 13131.5,-1298.8 13138.5,-1298.8"/>
</g>
<!-- L1_S0_TP3_GPU3_softmax&#45;&gt;L1_S0_TP3_GPU3_attn_v -->
<g id="edge400" class="edge">
<title>L1_S0_TP3_GPU3_softmax&#45;&gt;L1_S0_TP3_GPU3_attn_v</title>
<path fill="none" stroke="black" d="M13135,-1220.61C13135,-1220.61 13135,-1194.8 13135,-1194.8"/>
<polygon fill="black" stroke="black" points="13138.5,-1194.8 13135,-1184.8 13131.5,-1194.8 13138.5,-1194.8"/>
</g>
<!-- L1_S0_TP3_GPU3_mha_res -->
<g id="node165" class="node">
<title>L1_S0_TP3_GPU3_mha_res</title>
<polygon fill="none" stroke="black" points="13447.5,-948.5 12560.5,-948.5 12560.5,-880.5 13447.5,-880.5 13447.5,-948.5"/>
<text text-anchor="middle" x="13004" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="13004" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13004" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13004" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP3_GPU3_mha_ar&#45;&gt;L1_S0_TP3_GPU3_mha_res -->
<g id="edge410" class="edge">
<title>L1_S0_TP3_GPU3_mha_ar&#45;&gt;L1_S0_TP3_GPU3_mha_res</title>
<path fill="none" stroke="black" d="M13115.51,-984.55C13115.51,-984.55 13115.51,-958.73 13115.51,-958.73"/>
<polygon fill="black" stroke="black" points="13119.01,-958.73 13115.51,-948.73 13112.01,-958.73 13119.01,-958.73"/>
</g>
<!-- L1_S0_TP3_GPU3_gate -->
<g id="node166" class="node">
<title>L1_S0_TP3_GPU3_gate</title>
<polygon fill="none" stroke="black" points="13533.56,-844.5 12691.15,-844.5 12474.44,-708.5 13316.85,-708.5 13533.56,-844.5"/>
<text text-anchor="middle" x="13004" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="13004" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13004" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="13004" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L1_S0_TP3_GPU3_mha_res&#45;&gt;L1_S0_TP3_GPU3_gate -->
<g id="edge411" class="edge">
<title>L1_S0_TP3_GPU3_mha_res&#45;&gt;L1_S0_TP3_GPU3_gate</title>
<path fill="none" stroke="black" d="M13004,-880.39C13004,-880.39 13004,-854.73 13004,-854.73"/>
<polygon fill="black" stroke="black" points="13007.5,-854.73 13004,-844.73 13000.5,-854.73 13007.5,-854.73"/>
</g>
<!-- L1_S0_TP3_GPU3_moe_res -->
<g id="node168" class="node">
<title>L1_S0_TP3_GPU3_moe_res</title>
<polygon fill="none" stroke="black" points="13520,-436.33 12700,-436.33 12700,-368.33 13520,-368.33 13520,-436.33"/>
<text text-anchor="middle" x="13110" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="13110" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13110" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13110" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP3_GPU3_mha_res&#45;&gt;L1_S0_TP3_GPU3_moe_res -->
<g id="edge431" class="edge">
<title>L1_S0_TP3_GPU3_mha_res&#45;&gt;L1_S0_TP3_GPU3_moe_res</title>
<path fill="none" stroke="black" d="M13447.55,-925C13506.35,-925 13546.79,-925 13546.79,-925 13546.79,-925 13546.79,-413 13546.79,-413 13546.79,-413 13530.12,-413 13530.12,-413"/>
<polygon fill="black" stroke="black" points="13530.12,-409.5 13520.12,-413 13530.12,-416.5 13530.12,-409.5"/>
</g>
<!-- L1_S0_TP3_GPU3_gate&#45;&gt;L1_S0_TP3_GPU3_expert0 -->
<g id="edge412" class="edge">
<title>L1_S0_TP3_GPU3_gate&#45;&gt;L1_S0_TP3_GPU3_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12767.17,-708.31C12767.17,-708.31 12767.17,-682.71 12767.17,-682.71"/>
<polygon fill="black" stroke="black" points="12770.67,-682.71 12767.17,-672.71 12763.67,-682.71 12770.67,-682.71"/>
</g>
<!-- L1_S0_TP3_GPU3_gate&#45;&gt;L1_S0_TP3_GPU3_expert1 -->
<g id="edge413" class="edge">
<title>L1_S0_TP3_GPU3_gate&#45;&gt;L1_S0_TP3_GPU3_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13196.75,-708.31C13196.75,-708.31 13196.75,-682.71 13196.75,-682.71"/>
<polygon fill="black" stroke="black" points="13200.25,-682.71 13196.75,-672.71 13193.25,-682.71 13200.25,-682.71"/>
</g>
<!-- L1_S0_TP3_GPU3_moe_ar&#45;&gt;L1_S0_TP3_GPU3_moe_res -->
<g id="edge430" class="edge">
<title>L1_S0_TP3_GPU3_moe_ar&#45;&gt;L1_S0_TP3_GPU3_moe_res</title>
<path fill="none" stroke="black" d="M13192.27,-472.05C13192.27,-472.05 13192.27,-446.37 13192.27,-446.37"/>
<polygon fill="black" stroke="black" points="13195.77,-446.37 13192.27,-436.37 13188.77,-446.37 13195.77,-446.37"/>
</g>
<!-- L1_S0_TP3_GPU3_norm -->
<g id="node169" class="node">
<title>L1_S0_TP3_GPU3_norm</title>
<polygon fill="none" stroke="black" points="13334.5,-332.33 12885.5,-332.33 12885.5,-264.33 13334.5,-264.33 13334.5,-332.33"/>
<text text-anchor="middle" x="13110" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13110" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13110" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13110" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP3_GPU3_moe_res&#45;&gt;L1_S0_TP3_GPU3_norm -->
<g id="edge432" class="edge">
<title>L1_S0_TP3_GPU3_moe_res&#45;&gt;L1_S0_TP3_GPU3_norm</title>
<path fill="none" stroke="black" d="M13110,-368.28C13110,-368.28 13110,-342.46 13110,-342.46"/>
<polygon fill="black" stroke="black" points="13113.5,-342.46 13110,-332.46 13106.5,-342.46 13113.5,-342.46"/>
</g>
<!-- L1_S0_TP4_GPU4_qkv_linear -->
<g id="node170" class="node">
<title>L1_S0_TP4_GPU4_qkv_linear</title>
<polygon fill="none" stroke="black" points="14278,-1614.75 13670,-1614.75 13670,-1546.75 14278,-1546.75 14278,-1614.75"/>
<text text-anchor="middle" x="13974" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="13974" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13974" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="13974" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L1_S0_TP4_GPU4_qkv_slice -->
<g id="node171" class="node">
<title>L1_S0_TP4_GPU4_qkv_slice</title>
<polygon fill="none" stroke="black" points="14272,-1496.67 13676,-1496.67 13676,-1428.67 14272,-1428.67 14272,-1496.67"/>
<text text-anchor="middle" x="13974" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="13974" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="13974" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="13974" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L1_S0_TP4_GPU4_qkv_linear&#45;&gt;L1_S0_TP4_GPU4_qkv_slice -->
<g id="edge433" class="edge">
<title>L1_S0_TP4_GPU4_qkv_linear&#45;&gt;L1_S0_TP4_GPU4_qkv_slice</title>
<path fill="none" stroke="black" d="M13974,-1546.59C13974,-1546.59 13974,-1506.74 13974,-1506.74"/>
<polygon fill="black" stroke="black" points="13977.5,-1506.74 13974,-1496.74 13970.5,-1506.74 13977.5,-1506.74"/>
</g>
<!-- L1_S0_TP4_GPU4_qkv_slice&#45;&gt;L1_S0_TP4_GPU4_attn_v -->
<g id="edge437" class="edge">
<title>L1_S0_TP4_GPU4_qkv_slice&#45;&gt;L1_S0_TP4_GPU4_attn_v</title>
<path fill="none" stroke="black" d="M13715.25,-1428.38C13715.25,-1428.38 13715.25,-1195 13715.25,-1195"/>
<polygon fill="black" stroke="black" points="13718.75,-1195 13715.25,-1185 13711.75,-1195 13718.75,-1195"/>
</g>
<!-- L1_S0_TP4_GPU4_qk_matmul -->
<g id="node172" class="node">
<title>L1_S0_TP4_GPU4_qk_matmul</title>
<polygon fill="none" stroke="black" points="14689.5,-1392.67 13754.5,-1392.67 13754.5,-1324.67 14689.5,-1324.67 14689.5,-1392.67"/>
<text text-anchor="middle" x="14222" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="14222" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="14222" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="14222" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L1_S0_TP4_GPU4_qkv_slice&#45;&gt;L1_S0_TP4_GPU4_qk_matmul -->
<g id="edge434" class="edge">
<title>L1_S0_TP4_GPU4_qkv_slice&#45;&gt;L1_S0_TP4_GPU4_qk_matmul</title>
<path fill="none" stroke="black" d="M14013.25,-1428.61C14013.25,-1428.61 14013.25,-1402.8 14013.25,-1402.8"/>
<polygon fill="black" stroke="black" points="14016.75,-1402.8 14013.25,-1392.8 14009.75,-1402.8 14016.75,-1402.8"/>
</g>
<!-- L1_S0_TP4_GPU4_softmax -->
<g id="node173" class="node">
<title>L1_S0_TP4_GPU4_softmax</title>
<polygon fill="none" stroke="black" points="14364,-1288.67 13854,-1288.67 13854,-1220.67 14364,-1220.67 14364,-1288.67"/>
<text text-anchor="middle" x="14109" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="14109" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="14109" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="14109" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L1_S0_TP4_GPU4_qk_matmul&#45;&gt;L1_S0_TP4_GPU4_softmax -->
<g id="edge435" class="edge">
<title>L1_S0_TP4_GPU4_qk_matmul&#45;&gt;L1_S0_TP4_GPU4_softmax</title>
<path fill="none" stroke="black" d="M14109,-1324.61C14109,-1324.61 14109,-1298.8 14109,-1298.8"/>
<polygon fill="black" stroke="black" points="14112.5,-1298.8 14109,-1288.8 14105.5,-1298.8 14112.5,-1298.8"/>
</g>
<!-- L1_S0_TP4_GPU4_softmax&#45;&gt;L1_S0_TP4_GPU4_attn_v -->
<g id="edge436" class="edge">
<title>L1_S0_TP4_GPU4_softmax&#45;&gt;L1_S0_TP4_GPU4_attn_v</title>
<path fill="none" stroke="black" d="M14109,-1220.61C14109,-1220.61 14109,-1194.8 14109,-1194.8"/>
<polygon fill="black" stroke="black" points="14112.5,-1194.8 14109,-1184.8 14105.5,-1194.8 14112.5,-1194.8"/>
</g>
<!-- L1_S0_TP4_GPU4_mha_res -->
<g id="node175" class="node">
<title>L1_S0_TP4_GPU4_mha_res</title>
<polygon fill="none" stroke="black" points="14525.5,-948.5 13638.5,-948.5 13638.5,-880.5 14525.5,-880.5 14525.5,-948.5"/>
<text text-anchor="middle" x="14082" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="14082" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14082" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14082" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP4_GPU4_mha_ar&#45;&gt;L1_S0_TP4_GPU4_mha_res -->
<g id="edge446" class="edge">
<title>L1_S0_TP4_GPU4_mha_ar&#45;&gt;L1_S0_TP4_GPU4_mha_res</title>
<path fill="none" stroke="black" d="M13970.99,-984.55C13970.99,-984.55 13970.99,-958.73 13970.99,-958.73"/>
<polygon fill="black" stroke="black" points="13974.49,-958.73 13970.99,-948.73 13967.49,-958.73 13974.49,-958.73"/>
</g>
<!-- L1_S0_TP4_GPU4_gate -->
<g id="node176" class="node">
<title>L1_S0_TP4_GPU4_gate</title>
<polygon fill="none" stroke="black" points="14611.56,-844.5 13769.15,-844.5 13552.44,-708.5 14394.85,-708.5 14611.56,-844.5"/>
<text text-anchor="middle" x="14082" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="14082" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14082" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="14082" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L1_S0_TP4_GPU4_mha_res&#45;&gt;L1_S0_TP4_GPU4_gate -->
<g id="edge447" class="edge">
<title>L1_S0_TP4_GPU4_mha_res&#45;&gt;L1_S0_TP4_GPU4_gate</title>
<path fill="none" stroke="black" d="M14082,-880.39C14082,-880.39 14082,-854.73 14082,-854.73"/>
<polygon fill="black" stroke="black" points="14085.5,-854.73 14082,-844.73 14078.5,-854.73 14085.5,-854.73"/>
</g>
<!-- L1_S0_TP4_GPU4_moe_res -->
<g id="node178" class="node">
<title>L1_S0_TP4_GPU4_moe_res</title>
<polygon fill="none" stroke="black" points="14445,-436.33 13625,-436.33 13625,-368.33 14445,-368.33 14445,-436.33"/>
<text text-anchor="middle" x="14035" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="14035" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14035" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14035" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP4_GPU4_mha_res&#45;&gt;L1_S0_TP4_GPU4_moe_res -->
<g id="edge467" class="edge">
<title>L1_S0_TP4_GPU4_mha_res&#45;&gt;L1_S0_TP4_GPU4_moe_res</title>
<path fill="none" stroke="black" d="M13638.33,-903C13585.1,-903 13549.14,-903 13549.14,-903 13549.14,-903 13549.14,-390 13549.14,-390 13549.14,-390 13614.79,-390 13614.79,-390"/>
<polygon fill="black" stroke="black" points="13614.79,-393.5 13624.79,-390 13614.79,-386.5 13614.79,-393.5"/>
</g>
<!-- L1_S0_TP4_GPU4_gate&#45;&gt;L1_S0_TP4_GPU4_expert0 -->
<g id="edge448" class="edge">
<title>L1_S0_TP4_GPU4_gate&#45;&gt;L1_S0_TP4_GPU4_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13888.43,-708.31C13888.43,-708.31 13888.43,-682.71 13888.43,-682.71"/>
<polygon fill="black" stroke="black" points="13891.93,-682.71 13888.43,-672.71 13884.93,-682.71 13891.93,-682.71"/>
</g>
<!-- L1_S0_TP4_GPU4_gate&#45;&gt;L1_S0_TP4_GPU4_expert1 -->
<g id="edge449" class="edge">
<title>L1_S0_TP4_GPU4_gate&#45;&gt;L1_S0_TP4_GPU4_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14355.25,-708.31C14355.25,-708.31 14355.25,-682.71 14355.25,-682.71"/>
<polygon fill="black" stroke="black" points="14358.75,-682.71 14355.25,-672.71 14351.75,-682.71 14358.75,-682.71"/>
</g>
<!-- L1_S0_TP4_GPU4_moe_ar&#45;&gt;L1_S0_TP4_GPU4_moe_res -->
<g id="edge466" class="edge">
<title>L1_S0_TP4_GPU4_moe_ar&#45;&gt;L1_S0_TP4_GPU4_moe_res</title>
<path fill="none" stroke="black" d="M13773.87,-475.1C13773.87,-475.1 13773.87,-446.34 13773.87,-446.34"/>
<polygon fill="black" stroke="black" points="13777.37,-446.34 13773.87,-436.34 13770.37,-446.34 13777.37,-446.34"/>
</g>
<!-- L1_S0_TP4_GPU4_norm -->
<g id="node179" class="node">
<title>L1_S0_TP4_GPU4_norm</title>
<polygon fill="none" stroke="black" points="14259.5,-332.33 13810.5,-332.33 13810.5,-264.33 14259.5,-264.33 14259.5,-332.33"/>
<text text-anchor="middle" x="14035" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14035" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14035" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14035" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP4_GPU4_moe_res&#45;&gt;L1_S0_TP4_GPU4_norm -->
<g id="edge468" class="edge">
<title>L1_S0_TP4_GPU4_moe_res&#45;&gt;L1_S0_TP4_GPU4_norm</title>
<path fill="none" stroke="black" d="M14035,-368.28C14035,-368.28 14035,-342.46 14035,-342.46"/>
<polygon fill="black" stroke="black" points="14038.5,-342.46 14035,-332.46 14031.5,-342.46 14038.5,-342.46"/>
</g>
<!-- L1_S0_TP5_GPU5_qkv_linear -->
<g id="node180" class="node">
<title>L1_S0_TP5_GPU5_qkv_linear</title>
<polygon fill="none" stroke="black" points="15271,-1614.75 14663,-1614.75 14663,-1546.75 15271,-1546.75 15271,-1614.75"/>
<text text-anchor="middle" x="14967" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="14967" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14967" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="14967" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L1_S0_TP5_GPU5_qkv_slice -->
<g id="node181" class="node">
<title>L1_S0_TP5_GPU5_qkv_slice</title>
<polygon fill="none" stroke="black" points="15265,-1496.67 14669,-1496.67 14669,-1428.67 15265,-1428.67 15265,-1496.67"/>
<text text-anchor="middle" x="14967" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="14967" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="14967" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="14967" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L1_S0_TP5_GPU5_qkv_linear&#45;&gt;L1_S0_TP5_GPU5_qkv_slice -->
<g id="edge469" class="edge">
<title>L1_S0_TP5_GPU5_qkv_linear&#45;&gt;L1_S0_TP5_GPU5_qkv_slice</title>
<path fill="none" stroke="black" d="M14967,-1546.59C14967,-1546.59 14967,-1506.74 14967,-1506.74"/>
<polygon fill="black" stroke="black" points="14970.5,-1506.74 14967,-1496.74 14963.5,-1506.74 14970.5,-1506.74"/>
</g>
<!-- L1_S0_TP5_GPU5_qkv_slice&#45;&gt;L1_S0_TP5_GPU5_attn_v -->
<g id="edge473" class="edge">
<title>L1_S0_TP5_GPU5_qkv_slice&#45;&gt;L1_S0_TP5_GPU5_attn_v</title>
<path fill="none" stroke="black" d="M14718.5,-1428.38C14718.5,-1428.38 14718.5,-1195 14718.5,-1195"/>
<polygon fill="black" stroke="black" points="14722,-1195 14718.5,-1185 14715,-1195 14722,-1195"/>
</g>
<!-- L1_S0_TP5_GPU5_qk_matmul -->
<g id="node182" class="node">
<title>L1_S0_TP5_GPU5_qk_matmul</title>
<polygon fill="none" stroke="black" points="15682.5,-1392.67 14747.5,-1392.67 14747.5,-1324.67 15682.5,-1324.67 15682.5,-1392.67"/>
<text text-anchor="middle" x="15215" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="15215" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="15215" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="15215" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L1_S0_TP5_GPU5_qkv_slice&#45;&gt;L1_S0_TP5_GPU5_qk_matmul -->
<g id="edge470" class="edge">
<title>L1_S0_TP5_GPU5_qkv_slice&#45;&gt;L1_S0_TP5_GPU5_qk_matmul</title>
<path fill="none" stroke="black" d="M15006.25,-1428.61C15006.25,-1428.61 15006.25,-1402.8 15006.25,-1402.8"/>
<polygon fill="black" stroke="black" points="15009.75,-1402.8 15006.25,-1392.8 15002.75,-1402.8 15009.75,-1402.8"/>
</g>
<!-- L1_S0_TP5_GPU5_softmax -->
<g id="node183" class="node">
<title>L1_S0_TP5_GPU5_softmax</title>
<polygon fill="none" stroke="black" points="15339,-1288.67 14829,-1288.67 14829,-1220.67 15339,-1220.67 15339,-1288.67"/>
<text text-anchor="middle" x="15084" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="15084" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="15084" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="15084" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L1_S0_TP5_GPU5_qk_matmul&#45;&gt;L1_S0_TP5_GPU5_softmax -->
<g id="edge471" class="edge">
<title>L1_S0_TP5_GPU5_qk_matmul&#45;&gt;L1_S0_TP5_GPU5_softmax</title>
<path fill="none" stroke="black" d="M15084,-1324.61C15084,-1324.61 15084,-1298.8 15084,-1298.8"/>
<polygon fill="black" stroke="black" points="15087.5,-1298.8 15084,-1288.8 15080.5,-1298.8 15087.5,-1298.8"/>
</g>
<!-- L1_S0_TP5_GPU5_softmax&#45;&gt;L1_S0_TP5_GPU5_attn_v -->
<g id="edge472" class="edge">
<title>L1_S0_TP5_GPU5_softmax&#45;&gt;L1_S0_TP5_GPU5_attn_v</title>
<path fill="none" stroke="black" d="M15084,-1220.61C15084,-1220.61 15084,-1194.8 15084,-1194.8"/>
<polygon fill="black" stroke="black" points="15087.5,-1194.8 15084,-1184.8 15080.5,-1194.8 15087.5,-1194.8"/>
</g>
<!-- L1_S0_TP5_GPU5_mha_res -->
<g id="node185" class="node">
<title>L1_S0_TP5_GPU5_mha_res</title>
<polygon fill="none" stroke="black" points="15603.5,-948.5 14716.5,-948.5 14716.5,-880.5 15603.5,-880.5 15603.5,-948.5"/>
<text text-anchor="middle" x="15160" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="15160" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="15160" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="15160" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP5_GPU5_mha_ar&#45;&gt;L1_S0_TP5_GPU5_mha_res -->
<g id="edge482" class="edge">
<title>L1_S0_TP5_GPU5_mha_ar&#45;&gt;L1_S0_TP5_GPU5_mha_res</title>
<path fill="none" stroke="black" d="M14894.49,-991.61C14894.49,-991.61 14894.49,-958.74 14894.49,-958.74"/>
<polygon fill="black" stroke="black" points="14897.99,-958.74 14894.49,-948.74 14890.99,-958.74 14897.99,-958.74"/>
</g>
<!-- L1_S0_TP5_GPU5_gate -->
<g id="node186" class="node">
<title>L1_S0_TP5_GPU5_gate</title>
<polygon fill="none" stroke="black" points="15689.56,-844.5 14847.15,-844.5 14630.44,-708.5 15472.85,-708.5 15689.56,-844.5"/>
<text text-anchor="middle" x="15160" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="15160" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="15160" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="15160" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L1_S0_TP5_GPU5_mha_res&#45;&gt;L1_S0_TP5_GPU5_gate -->
<g id="edge483" class="edge">
<title>L1_S0_TP5_GPU5_mha_res&#45;&gt;L1_S0_TP5_GPU5_gate</title>
<path fill="none" stroke="black" d="M15160,-880.39C15160,-880.39 15160,-854.73 15160,-854.73"/>
<polygon fill="black" stroke="black" points="15163.5,-854.73 15160,-844.73 15156.5,-854.73 15163.5,-854.73"/>
</g>
<!-- L1_S0_TP5_GPU5_moe_res -->
<g id="node188" class="node">
<title>L1_S0_TP5_GPU5_moe_res</title>
<polygon fill="none" stroke="black" points="16051,-436.33 15231,-436.33 15231,-368.33 16051,-368.33 16051,-436.33"/>
<text text-anchor="middle" x="15641" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="15641" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="15641" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="15641" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP5_GPU5_mha_res&#45;&gt;L1_S0_TP5_GPU5_moe_res -->
<g id="edge503" class="edge">
<title>L1_S0_TP5_GPU5_mha_res&#45;&gt;L1_S0_TP5_GPU5_moe_res</title>
<path fill="none" stroke="black" d="M15603.57,-914C15660.27,-914 15699,-914 15699,-914 15699,-914 15699,-693 15699,-693 15699,-693 15872.1,-693 15872.1,-693 15872.1,-693 15872.1,-600 15872.1,-600 15872.1,-600 15608.02,-600 15608.02,-600 15608.02,-600 15608.02,-446.76 15608.02,-446.76"/>
<polygon fill="black" stroke="black" points="15611.52,-446.76 15608.02,-436.76 15604.52,-446.76 15611.52,-446.76"/>
</g>
<!-- L1_S0_TP5_GPU5_gate&#45;&gt;L1_S0_TP5_GPU5_expert0 -->
<g id="edge484" class="edge">
<title>L1_S0_TP5_GPU5_gate&#45;&gt;L1_S0_TP5_GPU5_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14782.36,-708.31C14782.36,-708.31 14782.36,-682.71 14782.36,-682.71"/>
<polygon fill="black" stroke="black" points="14785.86,-682.71 14782.36,-672.71 14778.86,-682.71 14785.86,-682.71"/>
</g>
<!-- L1_S0_TP5_GPU5_gate&#45;&gt;L1_S0_TP5_GPU5_expert1 -->
<g id="edge485" class="edge">
<title>L1_S0_TP5_GPU5_gate&#45;&gt;L1_S0_TP5_GPU5_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15251.83,-708.31C15251.83,-708.31 15251.83,-682.71 15251.83,-682.71"/>
<polygon fill="black" stroke="black" points="15255.33,-682.71 15251.83,-672.71 15248.33,-682.71 15255.33,-682.71"/>
</g>
<!-- L1_S0_TP5_GPU5_moe_ar&#45;&gt;L1_S0_TP5_GPU5_moe_res -->
<g id="edge502" class="edge">
<title>L1_S0_TP5_GPU5_moe_ar&#45;&gt;L1_S0_TP5_GPU5_moe_res</title>
<path fill="none" stroke="black" d="M14676.23,-474.63C14676.23,-441.31 14676.23,-402 14676.23,-402 14676.23,-402 15220.8,-402 15220.8,-402"/>
<polygon fill="black" stroke="black" points="15220.8,-405.5 15230.8,-402 15220.8,-398.5 15220.8,-405.5"/>
</g>
<!-- L1_S0_TP5_GPU5_norm -->
<g id="node189" class="node">
<title>L1_S0_TP5_GPU5_norm</title>
<polygon fill="none" stroke="black" points="15865.5,-332.33 15416.5,-332.33 15416.5,-264.33 15865.5,-264.33 15865.5,-332.33"/>
<text text-anchor="middle" x="15641" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15641" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="15641" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="15641" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP5_GPU5_moe_res&#45;&gt;L1_S0_TP5_GPU5_norm -->
<g id="edge504" class="edge">
<title>L1_S0_TP5_GPU5_moe_res&#45;&gt;L1_S0_TP5_GPU5_norm</title>
<path fill="none" stroke="black" d="M15641,-368.28C15641,-368.28 15641,-342.46 15641,-342.46"/>
<polygon fill="black" stroke="black" points="15644.5,-342.46 15641,-332.46 15637.5,-342.46 15644.5,-342.46"/>
</g>
<!-- L1_S0_TP6_GPU6_qkv_linear -->
<g id="node190" class="node">
<title>L1_S0_TP6_GPU6_qkv_linear</title>
<polygon fill="none" stroke="black" points="16289,-1614.75 15681,-1614.75 15681,-1546.75 16289,-1546.75 16289,-1614.75"/>
<text text-anchor="middle" x="15985" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="15985" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="15985" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="15985" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L1_S0_TP6_GPU6_qkv_slice -->
<g id="node191" class="node">
<title>L1_S0_TP6_GPU6_qkv_slice</title>
<polygon fill="none" stroke="black" points="16283,-1496.67 15687,-1496.67 15687,-1428.67 16283,-1428.67 16283,-1496.67"/>
<text text-anchor="middle" x="15985" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="15985" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="15985" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="15985" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L1_S0_TP6_GPU6_qkv_linear&#45;&gt;L1_S0_TP6_GPU6_qkv_slice -->
<g id="edge505" class="edge">
<title>L1_S0_TP6_GPU6_qkv_linear&#45;&gt;L1_S0_TP6_GPU6_qkv_slice</title>
<path fill="none" stroke="black" d="M15985,-1546.59C15985,-1546.59 15985,-1506.74 15985,-1506.74"/>
<polygon fill="black" stroke="black" points="15988.5,-1506.74 15985,-1496.74 15981.5,-1506.74 15988.5,-1506.74"/>
</g>
<!-- L1_S0_TP6_GPU6_qkv_slice&#45;&gt;L1_S0_TP6_GPU6_attn_v -->
<g id="edge509" class="edge">
<title>L1_S0_TP6_GPU6_qkv_slice&#45;&gt;L1_S0_TP6_GPU6_attn_v</title>
<path fill="none" stroke="black" d="M15726.25,-1428.38C15726.25,-1428.38 15726.25,-1195 15726.25,-1195"/>
<polygon fill="black" stroke="black" points="15729.75,-1195 15726.25,-1185 15722.75,-1195 15729.75,-1195"/>
</g>
<!-- L1_S0_TP6_GPU6_qk_matmul -->
<g id="node192" class="node">
<title>L1_S0_TP6_GPU6_qk_matmul</title>
<polygon fill="none" stroke="black" points="16700.5,-1392.67 15765.5,-1392.67 15765.5,-1324.67 16700.5,-1324.67 16700.5,-1392.67"/>
<text text-anchor="middle" x="16233" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="16233" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="16233" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="16233" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L1_S0_TP6_GPU6_qkv_slice&#45;&gt;L1_S0_TP6_GPU6_qk_matmul -->
<g id="edge506" class="edge">
<title>L1_S0_TP6_GPU6_qkv_slice&#45;&gt;L1_S0_TP6_GPU6_qk_matmul</title>
<path fill="none" stroke="black" d="M16024.25,-1428.61C16024.25,-1428.61 16024.25,-1402.8 16024.25,-1402.8"/>
<polygon fill="black" stroke="black" points="16027.75,-1402.8 16024.25,-1392.8 16020.75,-1402.8 16027.75,-1402.8"/>
</g>
<!-- L1_S0_TP6_GPU6_softmax -->
<g id="node193" class="node">
<title>L1_S0_TP6_GPU6_softmax</title>
<polygon fill="none" stroke="black" points="16381,-1288.67 15871,-1288.67 15871,-1220.67 16381,-1220.67 16381,-1288.67"/>
<text text-anchor="middle" x="16126" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="16126" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="16126" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="16126" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L1_S0_TP6_GPU6_qk_matmul&#45;&gt;L1_S0_TP6_GPU6_softmax -->
<g id="edge507" class="edge">
<title>L1_S0_TP6_GPU6_qk_matmul&#45;&gt;L1_S0_TP6_GPU6_softmax</title>
<path fill="none" stroke="black" d="M16126,-1324.61C16126,-1324.61 16126,-1298.8 16126,-1298.8"/>
<polygon fill="black" stroke="black" points="16129.5,-1298.8 16126,-1288.8 16122.5,-1298.8 16129.5,-1298.8"/>
</g>
<!-- L1_S0_TP6_GPU6_softmax&#45;&gt;L1_S0_TP6_GPU6_attn_v -->
<g id="edge508" class="edge">
<title>L1_S0_TP6_GPU6_softmax&#45;&gt;L1_S0_TP6_GPU6_attn_v</title>
<path fill="none" stroke="black" d="M16126,-1220.61C16126,-1220.61 16126,-1194.8 16126,-1194.8"/>
<polygon fill="black" stroke="black" points="16129.5,-1194.8 16126,-1184.8 16122.5,-1194.8 16129.5,-1194.8"/>
</g>
<!-- L1_S0_TP6_GPU6_mha_res -->
<g id="node195" class="node">
<title>L1_S0_TP6_GPU6_mha_res</title>
<polygon fill="none" stroke="black" points="16681.5,-948.5 15794.5,-948.5 15794.5,-880.5 16681.5,-880.5 16681.5,-948.5"/>
<text text-anchor="middle" x="16238" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="16238" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="16238" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="16238" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP6_GPU6_mha_ar&#45;&gt;L1_S0_TP6_GPU6_mha_res -->
<g id="edge518" class="edge">
<title>L1_S0_TP6_GPU6_mha_ar&#45;&gt;L1_S0_TP6_GPU6_mha_res</title>
<path fill="none" stroke="black" d="M15817.99,-1015.66C15817.99,-1015.66 15817.99,-958.91 15817.99,-958.91"/>
<polygon fill="black" stroke="black" points="15821.49,-958.91 15817.99,-948.91 15814.49,-958.91 15821.49,-958.91"/>
</g>
<!-- L1_S0_TP6_GPU6_gate -->
<g id="node196" class="node">
<title>L1_S0_TP6_GPU6_gate</title>
<polygon fill="none" stroke="black" points="16767.56,-844.5 15925.15,-844.5 15708.44,-708.5 16550.85,-708.5 16767.56,-844.5"/>
<text text-anchor="middle" x="16238" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="16238" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="16238" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="16238" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L1_S0_TP6_GPU6_mha_res&#45;&gt;L1_S0_TP6_GPU6_gate -->
<g id="edge519" class="edge">
<title>L1_S0_TP6_GPU6_mha_res&#45;&gt;L1_S0_TP6_GPU6_gate</title>
<path fill="none" stroke="black" d="M16238,-880.39C16238,-880.39 16238,-854.73 16238,-854.73"/>
<polygon fill="black" stroke="black" points="16241.5,-854.73 16238,-844.73 16234.5,-854.73 16241.5,-854.73"/>
</g>
<!-- L1_S0_TP6_GPU6_moe_res -->
<g id="node198" class="node">
<title>L1_S0_TP6_GPU6_moe_res</title>
<polygon fill="none" stroke="black" points="17273,-436.33 16453,-436.33 16453,-368.33 17273,-368.33 17273,-436.33"/>
<text text-anchor="middle" x="16863" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="16863" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="16863" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="16863" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP6_GPU6_mha_res&#45;&gt;L1_S0_TP6_GPU6_moe_res -->
<g id="edge539" class="edge">
<title>L1_S0_TP6_GPU6_mha_res&#45;&gt;L1_S0_TP6_GPU6_moe_res</title>
<path fill="none" stroke="black" d="M16681.57,-914C16738.27,-914 16777,-914 16777,-914 16777,-914 16777,-695 16777,-695 16777,-695 16811.5,-695 16811.5,-695 16811.5,-695 16811.5,-446.48 16811.5,-446.48"/>
<polygon fill="black" stroke="black" points="16815,-446.48 16811.5,-436.48 16808,-446.48 16815,-446.48"/>
</g>
<!-- L1_S0_TP6_GPU6_gate&#45;&gt;L1_S0_TP6_GPU6_expert0 -->
<g id="edge520" class="edge">
<title>L1_S0_TP6_GPU6_gate&#45;&gt;L1_S0_TP6_GPU6_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15788.36,-708.31C15788.36,-708.31 15788.36,-682.71 15788.36,-682.71"/>
<polygon fill="black" stroke="black" points="15791.86,-682.71 15788.36,-672.71 15784.86,-682.71 15791.86,-682.71"/>
</g>
<!-- L1_S0_TP6_GPU6_gate&#45;&gt;L1_S0_TP6_GPU6_expert1 -->
<g id="edge521" class="edge">
<title>L1_S0_TP6_GPU6_gate&#45;&gt;L1_S0_TP6_GPU6_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16111,-708.31C16111,-708.31 16111,-682.71 16111,-682.71"/>
<polygon fill="black" stroke="black" points="16114.5,-682.71 16111,-672.71 16107.5,-682.71 16114.5,-682.71"/>
</g>
<!-- L1_S0_TP6_GPU6_moe_ar&#45;&gt;L1_S0_TP6_GPU6_moe_res -->
<g id="edge538" class="edge">
<title>L1_S0_TP6_GPU6_moe_ar&#45;&gt;L1_S0_TP6_GPU6_moe_res</title>
<path fill="none" stroke="black" d="M15412.73,-477.28C15412.73,-457.34 15412.73,-438 15412.73,-438 15412.73,-438 16627.75,-438 16627.75,-438 16627.75,-438 16627.75,-437.85 16627.75,-437.85"/>
<polygon fill="black" stroke="black" points="16631.25,-446.47 16627.75,-436.47 16624.25,-446.47 16631.25,-446.47"/>
</g>
<!-- L1_S0_TP6_GPU6_norm -->
<g id="node199" class="node">
<title>L1_S0_TP6_GPU6_norm</title>
<polygon fill="none" stroke="black" points="17087.5,-332.33 16638.5,-332.33 16638.5,-264.33 17087.5,-264.33 17087.5,-332.33"/>
<text text-anchor="middle" x="16863" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16863" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="16863" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="16863" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP6_GPU6_moe_res&#45;&gt;L1_S0_TP6_GPU6_norm -->
<g id="edge540" class="edge">
<title>L1_S0_TP6_GPU6_moe_res&#45;&gt;L1_S0_TP6_GPU6_norm</title>
<path fill="none" stroke="black" d="M16863,-368.28C16863,-368.28 16863,-342.46 16863,-342.46"/>
<polygon fill="black" stroke="black" points="16866.5,-342.46 16863,-332.46 16859.5,-342.46 16866.5,-342.46"/>
</g>
<!-- L1_S0_TP7_GPU7_qkv_linear -->
<g id="node200" class="node">
<title>L1_S0_TP7_GPU7_qkv_linear</title>
<polygon fill="none" stroke="black" points="17391,-1614.75 16783,-1614.75 16783,-1546.75 17391,-1546.75 17391,-1614.75"/>
<text text-anchor="middle" x="17087" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="17087" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="17087" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="17087" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L1_S0_TP7_GPU7_qkv_slice -->
<g id="node201" class="node">
<title>L1_S0_TP7_GPU7_qkv_slice</title>
<polygon fill="none" stroke="black" points="17385,-1496.67 16789,-1496.67 16789,-1428.67 17385,-1428.67 17385,-1496.67"/>
<text text-anchor="middle" x="17087" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="17087" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="17087" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="17087" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L1_S0_TP7_GPU7_qkv_linear&#45;&gt;L1_S0_TP7_GPU7_qkv_slice -->
<g id="edge541" class="edge">
<title>L1_S0_TP7_GPU7_qkv_linear&#45;&gt;L1_S0_TP7_GPU7_qkv_slice</title>
<path fill="none" stroke="black" d="M17087,-1546.59C17087,-1546.59 17087,-1506.74 17087,-1506.74"/>
<polygon fill="black" stroke="black" points="17090.5,-1506.74 17087,-1496.74 17083.5,-1506.74 17090.5,-1506.74"/>
</g>
<!-- L1_S0_TP7_GPU7_qkv_slice&#45;&gt;L1_S0_TP7_GPU7_attn_v -->
<g id="edge545" class="edge">
<title>L1_S0_TP7_GPU7_qkv_slice&#45;&gt;L1_S0_TP7_GPU7_attn_v</title>
<path fill="none" stroke="black" d="M16828.25,-1428.38C16828.25,-1428.38 16828.25,-1195 16828.25,-1195"/>
<polygon fill="black" stroke="black" points="16831.75,-1195 16828.25,-1185 16824.75,-1195 16831.75,-1195"/>
</g>
<!-- L1_S0_TP7_GPU7_qk_matmul -->
<g id="node202" class="node">
<title>L1_S0_TP7_GPU7_qk_matmul</title>
<polygon fill="none" stroke="black" points="17802.5,-1392.67 16867.5,-1392.67 16867.5,-1324.67 17802.5,-1324.67 17802.5,-1392.67"/>
<text text-anchor="middle" x="17335" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="17335" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="17335" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="17335" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L1_S0_TP7_GPU7_qkv_slice&#45;&gt;L1_S0_TP7_GPU7_qk_matmul -->
<g id="edge542" class="edge">
<title>L1_S0_TP7_GPU7_qkv_slice&#45;&gt;L1_S0_TP7_GPU7_qk_matmul</title>
<path fill="none" stroke="black" d="M17126.25,-1428.61C17126.25,-1428.61 17126.25,-1402.8 17126.25,-1402.8"/>
<polygon fill="black" stroke="black" points="17129.75,-1402.8 17126.25,-1392.8 17122.75,-1402.8 17129.75,-1402.8"/>
</g>
<!-- L1_S0_TP7_GPU7_softmax -->
<g id="node203" class="node">
<title>L1_S0_TP7_GPU7_softmax</title>
<polygon fill="none" stroke="black" points="17483,-1288.67 16973,-1288.67 16973,-1220.67 17483,-1220.67 17483,-1288.67"/>
<text text-anchor="middle" x="17228" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="17228" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="17228" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="17228" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L1_S0_TP7_GPU7_qk_matmul&#45;&gt;L1_S0_TP7_GPU7_softmax -->
<g id="edge543" class="edge">
<title>L1_S0_TP7_GPU7_qk_matmul&#45;&gt;L1_S0_TP7_GPU7_softmax</title>
<path fill="none" stroke="black" d="M17228,-1324.61C17228,-1324.61 17228,-1298.8 17228,-1298.8"/>
<polygon fill="black" stroke="black" points="17231.5,-1298.8 17228,-1288.8 17224.5,-1298.8 17231.5,-1298.8"/>
</g>
<!-- L1_S0_TP7_GPU7_softmax&#45;&gt;L1_S0_TP7_GPU7_attn_v -->
<g id="edge544" class="edge">
<title>L1_S0_TP7_GPU7_softmax&#45;&gt;L1_S0_TP7_GPU7_attn_v</title>
<path fill="none" stroke="black" d="M17166,-1220.61C17166,-1220.61 17166,-1194.8 17166,-1194.8"/>
<polygon fill="black" stroke="black" points="17169.5,-1194.8 17166,-1184.8 17162.5,-1194.8 17169.5,-1194.8"/>
</g>
<!-- L1_S0_TP7_GPU7_mha_res -->
<g id="node205" class="node">
<title>L1_S0_TP7_GPU7_mha_res</title>
<polygon fill="none" stroke="black" points="17759.5,-948.5 16872.5,-948.5 16872.5,-880.5 17759.5,-880.5 17759.5,-948.5"/>
<text text-anchor="middle" x="17316" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="17316" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="17316" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="17316" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP7_GPU7_mha_ar&#45;&gt;L1_S0_TP7_GPU7_mha_res -->
<g id="edge554" class="edge">
<title>L1_S0_TP7_GPU7_mha_ar&#45;&gt;L1_S0_TP7_GPU7_mha_res</title>
<path fill="none" stroke="black" d="M16587.53,-1016C16832.7,-1016 17115.75,-1016 17115.75,-1016 17115.75,-1016 17115.75,-958.58 17115.75,-958.58"/>
<polygon fill="black" stroke="black" points="17119.25,-958.58 17115.75,-948.58 17112.25,-958.58 17119.25,-958.58"/>
</g>
<!-- L1_S0_TP7_GPU7_gate -->
<g id="node206" class="node">
<title>L1_S0_TP7_GPU7_gate</title>
<polygon fill="none" stroke="black" points="17845.56,-844.5 17003.15,-844.5 16786.44,-708.5 17628.85,-708.5 17845.56,-844.5"/>
<text text-anchor="middle" x="17316" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="17316" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="17316" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="17316" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L1_S0_TP7_GPU7_mha_res&#45;&gt;L1_S0_TP7_GPU7_gate -->
<g id="edge555" class="edge">
<title>L1_S0_TP7_GPU7_mha_res&#45;&gt;L1_S0_TP7_GPU7_gate</title>
<path fill="none" stroke="black" d="M17316,-880.39C17316,-880.39 17316,-854.73 17316,-854.73"/>
<polygon fill="black" stroke="black" points="17319.5,-854.73 17316,-844.73 17312.5,-854.73 17319.5,-854.73"/>
</g>
<!-- L1_S0_TP7_GPU7_moe_res -->
<g id="node208" class="node">
<title>L1_S0_TP7_GPU7_moe_res</title>
<polygon fill="none" stroke="black" points="18198,-436.33 17378,-436.33 17378,-368.33 18198,-368.33 18198,-436.33"/>
<text text-anchor="middle" x="17788" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="17788" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="17788" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="17788" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP7_GPU7_mha_res&#45;&gt;L1_S0_TP7_GPU7_moe_res -->
<g id="edge575" class="edge">
<title>L1_S0_TP7_GPU7_mha_res&#45;&gt;L1_S0_TP7_GPU7_moe_res</title>
<path fill="none" stroke="black" d="M17759.54,-925C17901.15,-925 18021.89,-925 18021.89,-925 18021.89,-925 18021.89,-446.63 18021.89,-446.63"/>
<polygon fill="black" stroke="black" points="18025.39,-446.63 18021.89,-436.63 18018.39,-446.63 18025.39,-446.63"/>
</g>
<!-- L1_S0_TP7_GPU7_gate&#45;&gt;L1_S0_TP7_GPU7_expert0 -->
<g id="edge556" class="edge">
<title>L1_S0_TP7_GPU7_gate&#45;&gt;L1_S0_TP7_GPU7_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16794.36,-776.4C16794.36,-776.4 16794.36,-682.74 16794.36,-682.74"/>
<polygon fill="black" stroke="black" points="16797.86,-682.74 16794.36,-672.74 16790.86,-682.74 16797.86,-682.74"/>
</g>
<!-- L1_S0_TP7_GPU7_gate&#45;&gt;L1_S0_TP7_GPU7_expert1 -->
<g id="edge557" class="edge">
<title>L1_S0_TP7_GPU7_gate&#45;&gt;L1_S0_TP7_GPU7_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17119.83,-708.31C17119.83,-708.31 17119.83,-682.71 17119.83,-682.71"/>
<polygon fill="black" stroke="black" points="17123.33,-682.71 17119.83,-672.71 17116.33,-682.71 17123.33,-682.71"/>
</g>
<!-- L1_S0_TP7_GPU7_moe_ar&#45;&gt;L1_S0_TP7_GPU7_moe_res -->
<g id="edge574" class="edge">
<title>L1_S0_TP7_GPU7_moe_ar&#45;&gt;L1_S0_TP7_GPU7_moe_res</title>
<path fill="none" stroke="black" d="M16180.69,-486C16639.07,-486 17611.89,-486 17611.89,-486 17611.89,-486 17611.89,-446.36 17611.89,-446.36"/>
<polygon fill="black" stroke="black" points="17615.39,-446.36 17611.89,-436.36 17608.39,-446.36 17615.39,-446.36"/>
</g>
<!-- L1_S0_TP7_GPU7_norm -->
<g id="node209" class="node">
<title>L1_S0_TP7_GPU7_norm</title>
<polygon fill="none" stroke="black" points="18012.5,-332.33 17563.5,-332.33 17563.5,-264.33 18012.5,-264.33 18012.5,-332.33"/>
<text text-anchor="middle" x="17788" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17788" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="17788" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="17788" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L1_S0_TP7_GPU7_moe_res&#45;&gt;L1_S0_TP7_GPU7_norm -->
<g id="edge576" class="edge">
<title>L1_S0_TP7_GPU7_moe_res&#45;&gt;L1_S0_TP7_GPU7_norm</title>
<path fill="none" stroke="black" d="M17788,-368.28C17788,-368.28 17788,-342.46 17788,-342.46"/>
<polygon fill="black" stroke="black" points="17791.5,-342.46 17788,-332.46 17784.5,-342.46 17791.5,-342.46"/>
</g>
<!-- L2_S0_TP0_GPU0_qkv_linear -->
<g id="node210" class="node">
<title>L2_S0_TP0_GPU0_qkv_linear</title>
<polygon fill="none" stroke="black" points="19520,-1614.75 18912,-1614.75 18912,-1546.75 19520,-1546.75 19520,-1614.75"/>
<text text-anchor="middle" x="19216" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="19216" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="19216" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="19216" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L2_S0_TP0_GPU0_qkv_slice -->
<g id="node211" class="node">
<title>L2_S0_TP0_GPU0_qkv_slice</title>
<polygon fill="none" stroke="black" points="19514,-1496.67 18918,-1496.67 18918,-1428.67 19514,-1428.67 19514,-1496.67"/>
<text text-anchor="middle" x="19216" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="19216" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="19216" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="19216" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L2_S0_TP0_GPU0_qkv_linear&#45;&gt;L2_S0_TP0_GPU0_qkv_slice -->
<g id="edge577" class="edge">
<title>L2_S0_TP0_GPU0_qkv_linear&#45;&gt;L2_S0_TP0_GPU0_qkv_slice</title>
<path fill="none" stroke="black" d="M19216,-1546.59C19216,-1546.59 19216,-1506.74 19216,-1506.74"/>
<polygon fill="black" stroke="black" points="19219.5,-1506.74 19216,-1496.74 19212.5,-1506.74 19219.5,-1506.74"/>
</g>
<!-- L2_S0_TP0_GPU0_qk_matmul -->
<g id="node212" class="node">
<title>L2_S0_TP0_GPU0_qk_matmul</title>
<polygon fill="none" stroke="black" points="19996.5,-1392.67 19061.5,-1392.67 19061.5,-1324.67 19996.5,-1324.67 19996.5,-1392.67"/>
<text text-anchor="middle" x="19529" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="19529" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="19529" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="19529" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L2_S0_TP0_GPU0_qkv_slice&#45;&gt;L2_S0_TP0_GPU0_qk_matmul -->
<g id="edge578" class="edge">
<title>L2_S0_TP0_GPU0_qkv_slice&#45;&gt;L2_S0_TP0_GPU0_qk_matmul</title>
<path fill="none" stroke="black" d="M19287.75,-1428.61C19287.75,-1428.61 19287.75,-1402.8 19287.75,-1402.8"/>
<polygon fill="black" stroke="black" points="19291.25,-1402.8 19287.75,-1392.8 19284.25,-1402.8 19291.25,-1402.8"/>
</g>
<!-- L2_S0_TP0_GPU0_attn_v -->
<g id="node214" class="node">
<title>L2_S0_TP0_GPU0_attn_v</title>
<polygon fill="none" stroke="black" points="19993,-1184.67 19055,-1184.67 19055,-1116.67 19993,-1116.67 19993,-1184.67"/>
<text text-anchor="middle" x="19524" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="19524" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="19524" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="19524" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L2_S0_TP0_GPU0_qkv_slice&#45;&gt;L2_S0_TP0_GPU0_attn_v -->
<g id="edge581" class="edge">
<title>L2_S0_TP0_GPU0_qkv_slice&#45;&gt;L2_S0_TP0_GPU0_attn_v</title>
<path fill="none" stroke="black" d="M18986.5,-1428.61C18986.5,-1347.57 18986.5,-1150 18986.5,-1150 18986.5,-1150 19044.85,-1150 19044.85,-1150"/>
<polygon fill="black" stroke="black" points="19044.85,-1153.5 19054.85,-1150 19044.85,-1146.5 19044.85,-1153.5"/>
</g>
<!-- L2_S0_TP0_GPU0_softmax -->
<g id="node213" class="node">
<title>L2_S0_TP0_GPU0_softmax</title>
<polygon fill="none" stroke="black" points="19780,-1288.67 19270,-1288.67 19270,-1220.67 19780,-1220.67 19780,-1288.67"/>
<text text-anchor="middle" x="19525" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="19525" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="19525" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="19525" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L2_S0_TP0_GPU0_qk_matmul&#45;&gt;L2_S0_TP0_GPU0_softmax -->
<g id="edge579" class="edge">
<title>L2_S0_TP0_GPU0_qk_matmul&#45;&gt;L2_S0_TP0_GPU0_softmax</title>
<path fill="none" stroke="black" d="M19525,-1324.61C19525,-1324.61 19525,-1298.8 19525,-1298.8"/>
<polygon fill="black" stroke="black" points="19528.5,-1298.8 19525,-1288.8 19521.5,-1298.8 19528.5,-1298.8"/>
</g>
<!-- L2_S0_TP0_GPU0_softmax&#45;&gt;L2_S0_TP0_GPU0_attn_v -->
<g id="edge580" class="edge">
<title>L2_S0_TP0_GPU0_softmax&#45;&gt;L2_S0_TP0_GPU0_attn_v</title>
<path fill="none" stroke="black" d="M19525,-1220.61C19525,-1220.61 19525,-1194.8 19525,-1194.8"/>
<polygon fill="black" stroke="black" points="19528.5,-1194.8 19525,-1184.8 19521.5,-1194.8 19528.5,-1194.8"/>
</g>
<!-- L2_S0_TP0_GPU0_mha_ar -->
<g id="node215" class="node">
<title>L2_S0_TP0_GPU0_mha_ar</title>
<ellipse fill="none" stroke="black" cx="20179" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="20179" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="20179" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="20179" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="20179" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP0_GPU0_attn_v&#45;&gt;L2_S0_TP0_GPU0_mha_ar -->
<g id="edge582" class="edge">
<title>L2_S0_TP0_GPU0_attn_v&#45;&gt;L2_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M19835.11,-1116.51C19835.11,-1116.51 19835.11,-1061.95 19835.11,-1061.95"/>
<polygon fill="black" stroke="black" points="19838.61,-1061.95 19835.11,-1051.95 19831.61,-1061.95 19838.61,-1061.95"/>
</g>
<!-- L2_S0_TP1_GPU1_mha_ar -->
<g id="node248" class="node">
<title>L2_S0_TP1_GPU1_mha_ar</title>
<ellipse fill="none" stroke="black" cx="20948" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="20948" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="20948" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="20948" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="20948" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP0_GPU0_attn_v&#45;&gt;L2_S0_TP1_GPU1_mha_ar -->
<g id="edge618" class="edge">
<title>L2_S0_TP0_GPU0_attn_v&#45;&gt;L2_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M19866.68,-1116.6C19866.68,-1101.46 19866.68,-1087 19866.68,-1087 19866.68,-1087 20619.59,-1087 20619.59,-1087 20619.59,-1087 20619.59,-1065.98 20619.59,-1065.98"/>
<polygon fill="black" stroke="black" points="20623.09,-1065.98 20619.59,-1055.98 20616.09,-1065.98 20623.09,-1065.98"/>
</g>
<!-- L2_S0_TP2_GPU2_mha_ar -->
<g id="node258" class="node">
<title>L2_S0_TP2_GPU2_mha_ar</title>
<ellipse fill="none" stroke="black" cx="21717" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="21717" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="21717" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="21717" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="21717" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP0_GPU0_attn_v&#45;&gt;L2_S0_TP2_GPU2_mha_ar -->
<g id="edge654" class="edge">
<title>L2_S0_TP0_GPU0_attn_v&#45;&gt;L2_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M19898.26,-1116.6C19898.26,-1101.46 19898.26,-1087 19898.26,-1087 19898.26,-1087 21411.96,-1087 21411.96,-1087 21411.96,-1087 21411.96,-1070.75 21411.96,-1070.75"/>
<polygon fill="black" stroke="black" points="21415.46,-1070.75 21411.96,-1060.75 21408.46,-1070.75 21415.46,-1070.75"/>
</g>
<!-- L2_S0_TP3_GPU3_mha_ar -->
<g id="node268" class="node">
<title>L2_S0_TP3_GPU3_mha_ar</title>
<ellipse fill="none" stroke="black" cx="22486" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="22486" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="22486" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="22486" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="22486" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP0_GPU0_attn_v&#45;&gt;L2_S0_TP3_GPU3_mha_ar -->
<g id="edge690" class="edge">
<title>L2_S0_TP0_GPU0_attn_v&#45;&gt;L2_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M19929.84,-1116.6C19929.84,-1101.46 19929.84,-1087 19929.84,-1087 19929.84,-1087 22217.74,-1087 22217.74,-1087 22217.74,-1087 22217.74,-1076.43 22217.74,-1076.43"/>
<polygon fill="black" stroke="black" points="22221.24,-1076.43 22217.74,-1066.43 22214.24,-1076.43 22221.24,-1076.43"/>
</g>
<!-- L2_S0_TP4_GPU4_mha_ar -->
<g id="node278" class="node">
<title>L2_S0_TP4_GPU4_mha_ar</title>
<ellipse fill="none" stroke="black" cx="23255" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="23255" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="23255" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="23255" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="23255" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP0_GPU0_attn_v&#45;&gt;L2_S0_TP4_GPU4_mha_ar -->
<g id="edge726" class="edge">
<title>L2_S0_TP0_GPU0_attn_v&#45;&gt;L2_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M19768.01,-1116.31C19768.01,-1063.39 19768.01,-968 19768.01,-968 19768.01,-968 22937.74,-968 22937.74,-968 22937.74,-968 22937.74,-996.69 22937.74,-996.69"/>
<polygon fill="black" stroke="black" points="22934.24,-996.69 22937.74,-1006.69 22941.24,-996.69 22934.24,-996.69"/>
</g>
<!-- L2_S0_TP5_GPU5_mha_ar -->
<g id="node288" class="node">
<title>L2_S0_TP5_GPU5_mha_ar</title>
<ellipse fill="none" stroke="black" cx="24024" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="24024" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="24024" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="24024" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="24024" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP0_GPU0_attn_v&#45;&gt;L2_S0_TP5_GPU5_mha_ar -->
<g id="edge762" class="edge">
<title>L2_S0_TP0_GPU0_attn_v&#45;&gt;L2_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M19922,-1184.75C19922,-1199.3 19922,-1213 19922,-1213 19922,-1213 23830.5,-1213 23830.5,-1213 23830.5,-1213 23830.5,-1083.97 23830.5,-1083.97"/>
<polygon fill="black" stroke="black" points="23834,-1083.97 23830.5,-1073.97 23827,-1083.97 23834,-1083.97"/>
</g>
<!-- L2_S0_TP6_GPU6_mha_ar -->
<g id="node298" class="node">
<title>L2_S0_TP6_GPU6_mha_ar</title>
<ellipse fill="none" stroke="black" cx="24793" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="24793" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="24793" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="24793" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="24793" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP0_GPU0_attn_v&#45;&gt;L2_S0_TP6_GPU6_mha_ar -->
<g id="edge798" class="edge">
<title>L2_S0_TP0_GPU0_attn_v&#45;&gt;L2_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M19851,-1185C19851,-1201.18 19851,-1217 19851,-1217 19851,-1217 24785,-1217 24785,-1217 24785,-1217 24785,-1091.04 24785,-1091.04"/>
<polygon fill="black" stroke="black" points="24788.5,-1091.04 24785,-1081.04 24781.5,-1091.04 24788.5,-1091.04"/>
</g>
<!-- L2_S0_TP7_GPU7_mha_ar -->
<g id="node308" class="node">
<title>L2_S0_TP7_GPU7_mha_ar</title>
<ellipse fill="none" stroke="black" cx="25562" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="25562" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="25562" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="25562" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="25562" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP0_GPU0_attn_v&#45;&gt;L2_S0_TP7_GPU7_mha_ar -->
<g id="edge834" class="edge">
<title>L2_S0_TP0_GPU0_attn_v&#45;&gt;L2_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M19961.42,-1116.36C19961.42,-1105.37 19961.42,-1096 19961.42,-1096 19961.42,-1096 25254.34,-1096 25254.34,-1096 25254.34,-1096 25254.34,-1070.21 25254.34,-1070.21"/>
<polygon fill="black" stroke="black" points="25257.84,-1070.21 25254.34,-1060.21 25250.84,-1070.21 25257.84,-1070.21"/>
</g>
<!-- L2_S0_TP0_GPU0_mha_res -->
<g id="node223" class="node">
<title>L2_S0_TP0_GPU0_mha_res</title>
<polygon fill="none" stroke="black" points="19541.5,-948.5 18654.5,-948.5 18654.5,-880.5 19541.5,-880.5 19541.5,-948.5"/>
<text text-anchor="middle" x="19098" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="19098" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="19098" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="19098" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP0_GPU0_mha_ar&#45;&gt;L2_S0_TP0_GPU0_mha_res -->
<g id="edge590" class="edge">
<title>L2_S0_TP0_GPU0_mha_ar&#45;&gt;L2_S0_TP0_GPU0_mha_res</title>
<path fill="none" stroke="black" d="M19823.3,-1048C19578.86,-1048 19298.25,-1048 19298.25,-1048 19298.25,-1048 19298.25,-958.53 19298.25,-958.53"/>
<polygon fill="black" stroke="black" points="19301.75,-958.53 19298.25,-948.53 19294.75,-958.53 19301.75,-958.53"/>
</g>
<!-- L2_S0_TP1_GPU1_attn_v -->
<g id="node216" class="node">
<title>L2_S0_TP1_GPU1_attn_v</title>
<polygon fill="none" stroke="black" points="20949,-1184.67 20011,-1184.67 20011,-1116.67 20949,-1116.67 20949,-1184.67"/>
<text text-anchor="middle" x="20480" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="20480" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="20480" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="20480" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L2_S0_TP1_GPU1_attn_v&#45;&gt;L2_S0_TP0_GPU0_mha_ar -->
<g id="edge583" class="edge">
<title>L2_S0_TP1_GPU1_attn_v&#45;&gt;L2_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M20078.93,-1116.51C20078.93,-1116.51 20078.93,-1088.96 20078.93,-1088.96"/>
<polygon fill="black" stroke="black" points="20082.43,-1088.96 20078.93,-1078.96 20075.43,-1088.96 20082.43,-1088.96"/>
</g>
<!-- L2_S0_TP1_GPU1_attn_v&#45;&gt;L2_S0_TP1_GPU1_mha_ar -->
<g id="edge619" class="edge">
<title>L2_S0_TP1_GPU1_attn_v&#45;&gt;L2_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M20666.64,-1116.51C20666.64,-1116.51 20666.64,-1074.64 20666.64,-1074.64"/>
<polygon fill="black" stroke="black" points="20670.14,-1074.64 20666.64,-1064.64 20663.14,-1074.64 20670.14,-1074.64"/>
</g>
<!-- L2_S0_TP1_GPU1_attn_v&#45;&gt;L2_S0_TP2_GPU2_mha_ar -->
<g id="edge655" class="edge">
<title>L2_S0_TP1_GPU1_attn_v&#45;&gt;L2_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M20713.7,-1116.6C20713.7,-1101.46 20713.7,-1087 20713.7,-1087 20713.7,-1087 21482.39,-1087 21482.39,-1087 21482.39,-1087 21482.39,-1080.38 21482.39,-1080.38"/>
<polygon fill="black" stroke="black" points="21485.89,-1080.38 21482.39,-1070.38 21478.89,-1080.38 21485.89,-1080.38"/>
</g>
<!-- L2_S0_TP1_GPU1_attn_v&#45;&gt;L2_S0_TP3_GPU3_mha_ar -->
<g id="edge691" class="edge">
<title>L2_S0_TP1_GPU1_attn_v&#45;&gt;L2_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M20760.76,-1116.6C20760.76,-1101.46 20760.76,-1087 20760.76,-1087 20760.76,-1087 22324.95,-1087 22324.95,-1087 22324.95,-1087 22324.95,-1085.92 22324.95,-1085.92"/>
<polygon fill="black" stroke="black" points="22328.45,-1086.25 22324.95,-1076.25 22321.45,-1086.25 22328.45,-1086.25"/>
</g>
<!-- L2_S0_TP1_GPU1_attn_v&#45;&gt;L2_S0_TP4_GPU4_mha_ar -->
<g id="edge727" class="edge">
<title>L2_S0_TP1_GPU1_attn_v&#45;&gt;L2_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M20563.5,-1116.31C20563.5,-1063.39 20563.5,-968 20563.5,-968 20563.5,-968 22908.98,-968 22908.98,-968 22908.98,-968 22908.98,-1003.9 22908.98,-1003.9"/>
<polygon fill="black" stroke="black" points="22905.48,-1003.9 22908.98,-1013.9 22912.48,-1003.9 22905.48,-1003.9"/>
</g>
<!-- L2_S0_TP1_GPU1_attn_v&#45;&gt;L2_S0_TP5_GPU5_mha_ar -->
<g id="edge763" class="edge">
<title>L2_S0_TP1_GPU1_attn_v&#45;&gt;L2_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M20807.82,-1116.36C20807.82,-1104.91 20807.82,-1095 20807.82,-1095 20807.82,-1095 23682.22,-1095 23682.22,-1095 23682.22,-1095 23682.22,-1062.68 23682.22,-1062.68"/>
<polygon fill="black" stroke="black" points="23685.72,-1062.68 23682.22,-1052.68 23678.72,-1062.68 23685.72,-1062.68"/>
</g>
<!-- L2_S0_TP1_GPU1_attn_v&#45;&gt;L2_S0_TP6_GPU6_mha_ar -->
<g id="edge799" class="edge">
<title>L2_S0_TP1_GPU1_attn_v&#45;&gt;L2_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M20854.88,-1116.36C20854.88,-1104.91 20854.88,-1095 20854.88,-1095 20854.88,-1095 24476.77,-1095 24476.77,-1095 24476.77,-1095 24476.77,-1068.69 24476.77,-1068.69"/>
<polygon fill="black" stroke="black" points="24480.27,-1068.69 24476.77,-1058.69 24473.27,-1068.69 24480.27,-1068.69"/>
</g>
<!-- L2_S0_TP1_GPU1_attn_v&#45;&gt;L2_S0_TP7_GPU7_mha_ar -->
<g id="edge835" class="edge">
<title>L2_S0_TP1_GPU1_attn_v&#45;&gt;L2_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M20901.94,-1116.36C20901.94,-1105.37 20901.94,-1096 20901.94,-1096 20901.94,-1096 25322.14,-1096 25322.14,-1096 25322.14,-1096 25322.14,-1079.84 25322.14,-1079.84"/>
<polygon fill="black" stroke="black" points="25325.64,-1079.84 25322.14,-1069.84 25318.64,-1079.84 25325.64,-1079.84"/>
</g>
<!-- L2_S0_TP2_GPU2_attn_v -->
<g id="node217" class="node">
<title>L2_S0_TP2_GPU2_attn_v</title>
<polygon fill="none" stroke="black" points="21905,-1184.67 20967,-1184.67 20967,-1116.67 21905,-1116.67 21905,-1184.67"/>
<text text-anchor="middle" x="21436" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="21436" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="21436" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="21436" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L2_S0_TP2_GPU2_attn_v&#45;&gt;L2_S0_TP0_GPU0_mha_ar -->
<g id="edge584" class="edge">
<title>L2_S0_TP2_GPU2_attn_v&#45;&gt;L2_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M21017.92,-1116.36C21017.92,-1105.37 21017.92,-1096 21017.92,-1096 21017.92,-1096 20146.87,-1096 20146.87,-1096 20146.87,-1096 20146.87,-1090.65 20146.87,-1090.65"/>
<polygon fill="black" stroke="black" points="20150.37,-1090.65 20146.87,-1080.65 20143.37,-1090.65 20150.37,-1090.65"/>
</g>
<!-- L2_S0_TP2_GPU2_attn_v&#45;&gt;L2_S0_TP1_GPU1_mha_ar -->
<g id="edge620" class="edge">
<title>L2_S0_TP2_GPU2_attn_v&#45;&gt;L2_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M21068.85,-1116.51C21068.85,-1116.51 21068.85,-1088.52 21068.85,-1088.52"/>
<polygon fill="black" stroke="black" points="21072.35,-1088.52 21068.85,-1078.52 21065.35,-1088.52 21072.35,-1088.52"/>
</g>
<!-- L2_S0_TP2_GPU2_attn_v&#45;&gt;L2_S0_TP2_GPU2_mha_ar -->
<g id="edge656" class="edge">
<title>L2_S0_TP2_GPU2_attn_v&#45;&gt;L2_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M21552.83,-1116.51C21552.83,-1116.51 21552.83,-1085.92 21552.83,-1085.92"/>
<polygon fill="black" stroke="black" points="21556.33,-1085.92 21552.83,-1075.92 21549.33,-1085.92 21556.33,-1085.92"/>
</g>
<!-- L2_S0_TP2_GPU2_attn_v&#45;&gt;L2_S0_TP3_GPU3_mha_ar -->
<g id="edge692" class="edge">
<title>L2_S0_TP2_GPU2_attn_v&#45;&gt;L2_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M21623.26,-1116.6C21623.26,-1101.46 21623.26,-1087 21623.26,-1087 21623.26,-1087 22432.16,-1087 22432.16,-1087 22432.16,-1087 22432.16,-1086.33 22432.16,-1086.33"/>
<polygon fill="black" stroke="black" points="22435.66,-1090.33 22432.16,-1080.33 22428.66,-1090.33 22435.66,-1090.33"/>
</g>
<!-- L2_S0_TP2_GPU2_attn_v&#45;&gt;L2_S0_TP4_GPU4_mha_ar -->
<g id="edge728" class="edge">
<title>L2_S0_TP2_GPU2_attn_v&#45;&gt;L2_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M21693.7,-1116.36C21693.7,-1104.91 21693.7,-1095 21693.7,-1095 21693.7,-1095 23094.08,-1095 23094.08,-1095 23094.08,-1095 23094.08,-1086.27 23094.08,-1086.27"/>
<polygon fill="black" stroke="black" points="23097.58,-1086.27 23094.08,-1076.27 23090.58,-1086.27 23097.58,-1086.27"/>
</g>
<!-- L2_S0_TP2_GPU2_attn_v&#45;&gt;L2_S0_TP5_GPU5_mha_ar -->
<g id="edge764" class="edge">
<title>L2_S0_TP2_GPU2_attn_v&#45;&gt;L2_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M21821.5,-1184.76C21821.5,-1196.15 21821.5,-1206 21821.5,-1206 21821.5,-1206 23826,-1206 23826,-1206 23826,-1206 23826,-1083.68 23826,-1083.68"/>
<polygon fill="black" stroke="black" points="23829.5,-1083.68 23826,-1073.68 23822.5,-1083.68 23829.5,-1083.68"/>
</g>
<!-- L2_S0_TP2_GPU2_attn_v&#45;&gt;L2_S0_TP6_GPU6_mha_ar -->
<g id="edge800" class="edge">
<title>L2_S0_TP2_GPU2_attn_v&#45;&gt;L2_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M21764.13,-1116.36C21764.13,-1104.91 21764.13,-1095 21764.13,-1095 21764.13,-1095 24536.02,-1095 24536.02,-1095 24536.02,-1095 24536.02,-1077.8 24536.02,-1077.8"/>
<polygon fill="black" stroke="black" points="24539.52,-1077.8 24536.02,-1067.8 24532.52,-1077.8 24539.52,-1077.8"/>
</g>
<!-- L2_S0_TP2_GPU2_attn_v&#45;&gt;L2_S0_TP7_GPU7_mha_ar -->
<g id="edge836" class="edge">
<title>L2_S0_TP2_GPU2_attn_v&#45;&gt;L2_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M21834.57,-1116.36C21834.57,-1105.37 21834.57,-1096 21834.57,-1096 21834.57,-1096 25389.95,-1096 25389.95,-1096 25389.95,-1096 25389.95,-1085.59 25389.95,-1085.59"/>
<polygon fill="black" stroke="black" points="25393.45,-1085.59 25389.95,-1075.59 25386.45,-1085.59 25393.45,-1085.59"/>
</g>
<!-- L2_S0_TP3_GPU3_attn_v -->
<g id="node218" class="node">
<title>L2_S0_TP3_GPU3_attn_v</title>
<polygon fill="none" stroke="black" points="22861,-1184.67 21923,-1184.67 21923,-1116.67 22861,-1116.67 22861,-1184.67"/>
<text text-anchor="middle" x="22392" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="22392" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="22392" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="22392" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L2_S0_TP3_GPU3_attn_v&#45;&gt;L2_S0_TP0_GPU0_mha_ar -->
<g id="edge585" class="edge">
<title>L2_S0_TP3_GPU3_attn_v&#45;&gt;L2_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M21951.25,-1116.36C21951.25,-1105.37 21951.25,-1096 21951.25,-1096 21951.25,-1096 20214.8,-1096 20214.8,-1096 20214.8,-1096 20214.8,-1090.65 20214.8,-1090.65"/>
<polygon fill="black" stroke="black" points="20218.3,-1090.65 20214.8,-1080.65 20211.3,-1090.65 20218.3,-1090.65"/>
</g>
<!-- L2_S0_TP3_GPU3_attn_v&#45;&gt;L2_S0_TP1_GPU1_mha_ar -->
<g id="edge621" class="edge">
<title>L2_S0_TP3_GPU3_attn_v&#45;&gt;L2_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M21979.49,-1116.36C21979.49,-1105.37 21979.49,-1096 21979.49,-1096 21979.49,-1096 21119.77,-1096 21119.77,-1096 21119.77,-1096 21119.77,-1085.59 21119.77,-1085.59"/>
<polygon fill="black" stroke="black" points="21123.27,-1085.59 21119.77,-1075.59 21116.27,-1085.59 21123.27,-1085.59"/>
</g>
<!-- L2_S0_TP3_GPU3_attn_v&#45;&gt;L2_S0_TP2_GPU2_mha_ar -->
<g id="edge657" class="edge">
<title>L2_S0_TP3_GPU3_attn_v&#45;&gt;L2_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M22007.74,-1116.51C22007.74,-1116.51 22007.74,-1073.04 22007.74,-1073.04"/>
<polygon fill="black" stroke="black" points="22011.24,-1073.04 22007.74,-1063.04 22004.24,-1073.04 22011.24,-1073.04"/>
</g>
<!-- L2_S0_TP3_GPU3_attn_v&#45;&gt;L2_S0_TP3_GPU3_mha_ar -->
<g id="edge693" class="edge">
<title>L2_S0_TP3_GPU3_attn_v&#45;&gt;L2_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M22539.37,-1116.51C22539.37,-1116.51 22539.37,-1090.27 22539.37,-1090.27"/>
<polygon fill="black" stroke="black" points="22542.87,-1090.27 22539.37,-1080.27 22535.87,-1090.27 22542.87,-1090.27"/>
</g>
<!-- L2_S0_TP3_GPU3_attn_v&#45;&gt;L2_S0_TP4_GPU4_mha_ar -->
<g id="edge729" class="edge">
<title>L2_S0_TP3_GPU3_attn_v&#45;&gt;L2_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M22861.05,-1161C22863.54,-1161 22864.86,-1161 22864.86,-1161 22864.86,-1161 22864.86,-1048 22864.86,-1048 22864.86,-1048 22889.14,-1048 22889.14,-1048"/>
<polygon fill="black" stroke="black" points="22889.14,-1051.5 22899.14,-1048 22889.14,-1044.5 22889.14,-1051.5"/>
</g>
<!-- L2_S0_TP3_GPU3_attn_v&#45;&gt;L2_S0_TP5_GPU5_mha_ar -->
<g id="edge765" class="edge">
<title>L2_S0_TP3_GPU3_attn_v&#45;&gt;L2_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M22811.33,-1184.86C22811.33,-1187.98 22811.33,-1190 22811.33,-1190 22811.33,-1190 23821.5,-1190 23821.5,-1190 23821.5,-1190 23821.5,-1083.12 23821.5,-1083.12"/>
<polygon fill="black" stroke="black" points="23825,-1083.12 23821.5,-1073.12 23818,-1083.12 23825,-1083.12"/>
</g>
<!-- L2_S0_TP3_GPU3_attn_v&#45;&gt;L2_S0_TP6_GPU6_mha_ar -->
<g id="edge801" class="edge">
<title>L2_S0_TP3_GPU3_attn_v&#45;&gt;L2_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M22761.67,-1184.76C22761.67,-1192.76 22761.67,-1199 22761.67,-1199 22761.67,-1199 24779,-1199 24779,-1199 24779,-1199 24779,-1090.72 24779,-1090.72"/>
<polygon fill="black" stroke="black" points="24782.5,-1090.72 24779,-1080.72 24775.5,-1090.72 24782.5,-1090.72"/>
</g>
<!-- L2_S0_TP3_GPU3_attn_v&#45;&gt;L2_S0_TP7_GPU7_mha_ar -->
<g id="edge837" class="edge">
<title>L2_S0_TP3_GPU3_attn_v&#45;&gt;L2_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M22646.58,-1116.36C22646.58,-1105.37 22646.58,-1096 22646.58,-1096 22646.58,-1096 25457.76,-1096 25457.76,-1096 25457.76,-1096 25457.76,-1089.01 25457.76,-1089.01"/>
<polygon fill="black" stroke="black" points="25461.26,-1089.01 25457.76,-1079.01 25454.26,-1089.01 25461.26,-1089.01"/>
</g>
<!-- L2_S0_TP4_GPU4_attn_v -->
<g id="node219" class="node">
<title>L2_S0_TP4_GPU4_attn_v</title>
<polygon fill="none" stroke="black" points="23817,-1184.67 22879,-1184.67 22879,-1116.67 23817,-1116.67 23817,-1184.67"/>
<text text-anchor="middle" x="23348" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="23348" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="23348" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="23348" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L2_S0_TP4_GPU4_attn_v&#45;&gt;L2_S0_TP0_GPU0_mha_ar -->
<g id="edge586" class="edge">
<title>L2_S0_TP4_GPU4_attn_v&#45;&gt;L2_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M22986.8,-1116.36C22986.8,-1104.91 22986.8,-1095 22986.8,-1095 22986.8,-1095 20282.74,-1095 20282.74,-1095 20282.74,-1095 20282.74,-1088.93 20282.74,-1088.93"/>
<polygon fill="black" stroke="black" points="20286.24,-1088.93 20282.74,-1078.93 20279.24,-1088.93 20286.24,-1088.93"/>
</g>
<!-- L2_S0_TP4_GPU4_attn_v&#45;&gt;L2_S0_TP1_GPU1_mha_ar -->
<g id="edge622" class="edge">
<title>L2_S0_TP4_GPU4_attn_v&#45;&gt;L2_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M22952.67,-1184.81C22952.67,-1190.18 22952.67,-1194 22952.67,-1194 22952.67,-1194 20958,-1194 20958,-1194 20958,-1194 20958,-1091.01 20958,-1091.01"/>
<polygon fill="black" stroke="black" points="20961.5,-1091.01 20958,-1081.01 20954.5,-1091.01 20961.5,-1091.01"/>
</g>
<!-- L2_S0_TP4_GPU4_attn_v&#45;&gt;L2_S0_TP2_GPU2_mha_ar -->
<g id="edge658" class="edge">
<title>L2_S0_TP4_GPU4_attn_v&#45;&gt;L2_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M22915.83,-1184.9C22915.83,-1184.97 22915.83,-1185 22915.83,-1185 22915.83,-1185 21917,-1185 21917,-1185 21917,-1185 21917,-1083.43 21917,-1083.43"/>
<polygon fill="black" stroke="black" points="21920.5,-1083.43 21917,-1073.43 21913.5,-1083.43 21920.5,-1083.43"/>
</g>
<!-- L2_S0_TP4_GPU4_attn_v&#45;&gt;L2_S0_TP3_GPU3_mha_ar -->
<g id="edge694" class="edge">
<title>L2_S0_TP4_GPU4_attn_v&#45;&gt;L2_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M22878.62,-1139C22871.27,-1139 22867.21,-1139 22867.21,-1139 22867.21,-1139 22867.21,-1016 22867.21,-1016 22867.21,-1016 22848.56,-1016 22848.56,-1016"/>
<polygon fill="black" stroke="black" points="22848.56,-1012.5 22838.56,-1016 22848.56,-1019.5 22848.56,-1012.5"/>
</g>
<!-- L2_S0_TP4_GPU4_attn_v&#45;&gt;L2_S0_TP4_GPU4_mha_ar -->
<g id="edge730" class="edge">
<title>L2_S0_TP4_GPU4_attn_v&#45;&gt;L2_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M23201.36,-1116.51C23201.36,-1116.51 23201.36,-1090.27 23201.36,-1090.27"/>
<polygon fill="black" stroke="black" points="23204.86,-1090.27 23201.36,-1080.27 23197.86,-1090.27 23204.86,-1090.27"/>
</g>
<!-- L2_S0_TP4_GPU4_attn_v&#45;&gt;L2_S0_TP5_GPU5_mha_ar -->
<g id="edge766" class="edge">
<title>L2_S0_TP4_GPU4_attn_v&#45;&gt;L2_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M23715.92,-1116.51C23715.92,-1116.51 23715.92,-1070.31 23715.92,-1070.31"/>
<polygon fill="black" stroke="black" points="23719.42,-1070.31 23715.92,-1060.31 23712.42,-1070.31 23719.42,-1070.31"/>
</g>
<!-- L2_S0_TP4_GPU4_attn_v&#45;&gt;L2_S0_TP6_GPU6_mha_ar -->
<g id="edge802" class="edge">
<title>L2_S0_TP4_GPU4_attn_v&#45;&gt;L2_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M23749.61,-1116.41C23749.61,-1114.9 23749.61,-1114 23749.61,-1114 23749.61,-1114 24595.26,-1114 24595.26,-1114 24595.26,-1114 24595.26,-1083.77 24595.26,-1083.77"/>
<polygon fill="black" stroke="black" points="24598.76,-1083.77 24595.26,-1073.77 24591.76,-1083.77 24598.76,-1083.77"/>
</g>
<!-- L2_S0_TP4_GPU4_attn_v&#45;&gt;L2_S0_TP7_GPU7_mha_ar -->
<g id="edge838" class="edge">
<title>L2_S0_TP4_GPU4_attn_v&#45;&gt;L2_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M23783.31,-1116.41C23783.31,-1114.9 23783.31,-1114 23783.31,-1114 23783.31,-1114 25525.57,-1114 25525.57,-1114 25525.57,-1114 25525.57,-1090.88 25525.57,-1090.88"/>
<polygon fill="black" stroke="black" points="25529.07,-1090.88 25525.57,-1080.88 25522.07,-1090.88 25529.07,-1090.88"/>
</g>
<!-- L2_S0_TP5_GPU5_attn_v -->
<g id="node220" class="node">
<title>L2_S0_TP5_GPU5_attn_v</title>
<polygon fill="none" stroke="black" points="24773,-1184.67 23835,-1184.67 23835,-1116.67 24773,-1116.67 24773,-1184.67"/>
<text text-anchor="middle" x="24304" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="24304" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="24304" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="24304" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L2_S0_TP5_GPU5_attn_v&#45;&gt;L2_S0_TP0_GPU0_mha_ar -->
<g id="edge587" class="edge">
<title>L2_S0_TP5_GPU5_attn_v&#45;&gt;L2_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M23905.56,-1116.36C23905.56,-1104.91 23905.56,-1095 23905.56,-1095 23905.56,-1095 20350.67,-1095 20350.67,-1095 20350.67,-1095 20350.67,-1085.59 20350.67,-1085.59"/>
<polygon fill="black" stroke="black" points="20354.17,-1085.59 20350.67,-1075.59 20347.17,-1085.59 20354.17,-1085.59"/>
</g>
<!-- L2_S0_TP5_GPU5_attn_v&#45;&gt;L2_S0_TP1_GPU1_mha_ar -->
<g id="edge623" class="edge">
<title>L2_S0_TP5_GPU5_attn_v&#45;&gt;L2_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M23976.12,-1116.36C23976.12,-1105.37 23976.12,-1096 23976.12,-1096 23976.12,-1096 21170.7,-1096 21170.7,-1096 21170.7,-1096 21170.7,-1081.3 21170.7,-1081.3"/>
<polygon fill="black" stroke="black" points="21174.2,-1081.3 21170.7,-1071.3 21167.2,-1081.3 21174.2,-1081.3"/>
</g>
<!-- L2_S0_TP5_GPU5_attn_v&#45;&gt;L2_S0_TP2_GPU2_mha_ar -->
<g id="edge659" class="edge">
<title>L2_S0_TP5_GPU5_attn_v&#45;&gt;L2_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M23909.25,-1184.7C23909.25,-1194.69 23909.25,-1203 23909.25,-1203 23909.25,-1203 21911,-1203 21911,-1203 21911,-1203 21911,-1083.84 21911,-1083.84"/>
<polygon fill="black" stroke="black" points="21914.5,-1083.84 21911,-1073.84 21907.5,-1083.84 21914.5,-1083.84"/>
</g>
<!-- L2_S0_TP5_GPU5_attn_v&#45;&gt;L2_S0_TP3_GPU3_mha_ar -->
<g id="edge695" class="edge">
<title>L2_S0_TP5_GPU5_attn_v&#45;&gt;L2_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M24046.68,-1116.36C24046.68,-1105.37 24046.68,-1096 24046.68,-1096 24046.68,-1096 22753.79,-1096 22753.79,-1096 22753.79,-1096 22753.79,-1076.52 22753.79,-1076.52"/>
<polygon fill="black" stroke="black" points="22757.29,-1076.52 22753.79,-1066.52 22750.29,-1076.52 22757.29,-1076.52"/>
</g>
<!-- L2_S0_TP5_GPU5_attn_v&#45;&gt;L2_S0_TP4_GPU4_mha_ar -->
<g id="edge731" class="edge">
<title>L2_S0_TP5_GPU5_attn_v&#45;&gt;L2_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M24117.24,-1116.65C24117.24,-1098.97 24117.24,-1081 24117.24,-1081 24117.24,-1081 23308.64,-1081 23308.64,-1081 23308.64,-1081 23308.64,-1080.95 23308.64,-1080.95"/>
<polygon fill="black" stroke="black" points="23312.14,-1090.46 23308.64,-1080.46 23305.14,-1090.46 23312.14,-1090.46"/>
</g>
<!-- L2_S0_TP5_GPU5_attn_v&#45;&gt;L2_S0_TP5_GPU5_mha_ar -->
<g id="edge767" class="edge">
<title>L2_S0_TP5_GPU5_attn_v&#45;&gt;L2_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M24187.8,-1116.51C24187.8,-1116.51 24187.8,-1085.92 24187.8,-1085.92"/>
<polygon fill="black" stroke="black" points="24191.3,-1085.92 24187.8,-1075.92 24184.3,-1085.92 24191.3,-1085.92"/>
</g>
<!-- L2_S0_TP5_GPU5_attn_v&#45;&gt;L2_S0_TP6_GPU6_mha_ar -->
<g id="edge803" class="edge">
<title>L2_S0_TP5_GPU5_attn_v&#45;&gt;L2_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M24654.51,-1116.51C24654.51,-1116.51 24654.51,-1087.65 24654.51,-1087.65"/>
<polygon fill="black" stroke="black" points="24658.01,-1087.65 24654.51,-1077.65 24651.01,-1087.65 24658.01,-1087.65"/>
</g>
<!-- L2_S0_TP5_GPU5_attn_v&#45;&gt;L2_S0_TP7_GPU7_mha_ar -->
<g id="edge839" class="edge">
<title>L2_S0_TP5_GPU5_attn_v&#45;&gt;L2_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M24713.75,-1116.41C24713.75,-1114.9 24713.75,-1114 24713.75,-1114 24713.75,-1114 25593.38,-1114 25593.38,-1114 25593.38,-1114 25593.38,-1090.88 25593.38,-1090.88"/>
<polygon fill="black" stroke="black" points="25596.88,-1090.88 25593.38,-1080.88 25589.88,-1090.88 25596.88,-1090.88"/>
</g>
<!-- L2_S0_TP6_GPU6_attn_v -->
<g id="node221" class="node">
<title>L2_S0_TP6_GPU6_attn_v</title>
<polygon fill="none" stroke="black" points="25729,-1184.67 24791,-1184.67 24791,-1116.67 25729,-1116.67 25729,-1184.67"/>
<text text-anchor="middle" x="25260" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="25260" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="25260" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="25260" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L2_S0_TP6_GPU6_attn_v&#45;&gt;L2_S0_TP0_GPU0_mha_ar -->
<g id="edge588" class="edge">
<title>L2_S0_TP6_GPU6_attn_v&#45;&gt;L2_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M24838.18,-1116.36C24838.18,-1104.91 24838.18,-1095 24838.18,-1095 24838.18,-1095 20418.61,-1095 20418.61,-1095 20418.61,-1095 20418.61,-1079.61 20418.61,-1079.61"/>
<polygon fill="black" stroke="black" points="20422.11,-1079.61 20418.61,-1069.61 20415.11,-1079.61 20422.11,-1079.61"/>
</g>
<!-- L2_S0_TP6_GPU6_attn_v&#45;&gt;L2_S0_TP1_GPU1_mha_ar -->
<g id="edge624" class="edge">
<title>L2_S0_TP6_GPU6_attn_v&#45;&gt;L2_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M24885.37,-1116.36C24885.37,-1104.91 24885.37,-1095 24885.37,-1095 24885.37,-1095 21221.62,-1095 21221.62,-1095 21221.62,-1095 21221.62,-1075.62 21221.62,-1075.62"/>
<polygon fill="black" stroke="black" points="21225.12,-1075.62 21221.62,-1065.62 21218.12,-1075.62 21225.12,-1075.62"/>
</g>
<!-- L2_S0_TP6_GPU6_attn_v&#45;&gt;L2_S0_TP2_GPU2_mha_ar -->
<g id="edge660" class="edge">
<title>L2_S0_TP6_GPU6_attn_v&#45;&gt;L2_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M24932.55,-1116.36C24932.55,-1104.91 24932.55,-1095 24932.55,-1095 24932.55,-1095 22035.98,-1095 22035.98,-1095 22035.98,-1095 22035.98,-1067.97 22035.98,-1067.97"/>
<polygon fill="black" stroke="black" points="22039.48,-1067.97 22035.98,-1057.97 22032.48,-1067.97 22039.48,-1067.97"/>
</g>
<!-- L2_S0_TP6_GPU6_attn_v&#45;&gt;L2_S0_TP3_GPU3_mha_ar -->
<g id="edge696" class="edge">
<title>L2_S0_TP6_GPU6_attn_v&#45;&gt;L2_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M25177.5,-1116.34C25177.5,-1059.25 25177.5,-951 25177.5,-951 25177.5,-951 22832.82,-951 22832.82,-951 22832.82,-951 22832.82,-1004.07 22832.82,-1004.07"/>
<polygon fill="black" stroke="black" points="22829.32,-1004.07 22832.82,-1014.07 22836.32,-1004.07 22829.32,-1004.07"/>
</g>
<!-- L2_S0_TP6_GPU6_attn_v&#45;&gt;L2_S0_TP4_GPU4_mha_ar -->
<g id="edge732" class="edge">
<title>L2_S0_TP6_GPU6_attn_v&#45;&gt;L2_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M24979.74,-1116.65C24979.74,-1098.97 24979.74,-1081 24979.74,-1081 24979.74,-1081 23415.92,-1081 23415.92,-1081 23415.92,-1081 23415.92,-1080.52 23415.92,-1080.52"/>
<polygon fill="black" stroke="black" points="23419.42,-1086.18 23415.92,-1076.18 23412.42,-1086.18 23419.42,-1086.18"/>
</g>
<!-- L2_S0_TP6_GPU6_attn_v&#45;&gt;L2_S0_TP5_GPU5_mha_ar -->
<g id="edge768" class="edge">
<title>L2_S0_TP6_GPU6_attn_v&#45;&gt;L2_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M25026.92,-1116.65C25026.92,-1098.97 25026.92,-1081 25026.92,-1081 25026.92,-1081 24258.36,-1081 24258.36,-1081 24258.36,-1081 24258.36,-1079.93 24258.36,-1079.93"/>
<polygon fill="black" stroke="black" points="24261.86,-1080.25 24258.36,-1070.25 24254.86,-1080.25 24261.86,-1080.25"/>
</g>
<!-- L2_S0_TP6_GPU6_attn_v&#45;&gt;L2_S0_TP6_GPU6_mha_ar -->
<g id="edge804" class="edge">
<title>L2_S0_TP6_GPU6_attn_v&#45;&gt;L2_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M25074.11,-1116.51C25074.11,-1116.51 25074.11,-1074.64 25074.11,-1074.64"/>
<polygon fill="black" stroke="black" points="25077.61,-1074.64 25074.11,-1064.64 25070.61,-1074.64 25077.61,-1074.64"/>
</g>
<!-- L2_S0_TP6_GPU6_attn_v&#45;&gt;L2_S0_TP7_GPU7_mha_ar -->
<g id="edge840" class="edge">
<title>L2_S0_TP6_GPU6_attn_v&#45;&gt;L2_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M25661.19,-1116.51C25661.19,-1116.51 25661.19,-1088.96 25661.19,-1088.96"/>
<polygon fill="black" stroke="black" points="25664.69,-1088.96 25661.19,-1078.96 25657.69,-1088.96 25664.69,-1088.96"/>
</g>
<!-- L2_S0_TP7_GPU7_attn_v -->
<g id="node222" class="node">
<title>L2_S0_TP7_GPU7_attn_v</title>
<polygon fill="none" stroke="black" points="26685,-1184.67 25747,-1184.67 25747,-1116.67 26685,-1116.67 26685,-1184.67"/>
<text text-anchor="middle" x="26216" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="26216" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="26216" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="26216" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L2_S0_TP7_GPU7_attn_v&#45;&gt;L2_S0_TP0_GPU0_mha_ar -->
<g id="edge589" class="edge">
<title>L2_S0_TP7_GPU7_attn_v&#45;&gt;L2_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M25770.81,-1116.36C25770.81,-1104.91 25770.81,-1095 25770.81,-1095 25770.81,-1095 20486.54,-1095 20486.54,-1095 20486.54,-1095 20486.54,-1070.51 20486.54,-1070.51"/>
<polygon fill="black" stroke="black" points="20490.04,-1070.51 20486.54,-1060.51 20483.04,-1070.51 20490.04,-1070.51"/>
</g>
<!-- L2_S0_TP7_GPU7_attn_v&#45;&gt;L2_S0_TP1_GPU1_mha_ar -->
<g id="edge625" class="edge">
<title>L2_S0_TP7_GPU7_attn_v&#45;&gt;L2_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M25794.62,-1116.36C25794.62,-1104.91 25794.62,-1095 25794.62,-1095 25794.62,-1095 21272.55,-1095 21272.55,-1095 21272.55,-1095 21272.55,-1066.89 21272.55,-1066.89"/>
<polygon fill="black" stroke="black" points="21276.05,-1066.89 21272.55,-1056.89 21269.05,-1066.89 21276.05,-1066.89"/>
</g>
<!-- L2_S0_TP7_GPU7_attn_v&#45;&gt;L2_S0_TP2_GPU2_mha_ar -->
<g id="edge661" class="edge">
<title>L2_S0_TP7_GPU7_attn_v&#45;&gt;L2_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M25818.43,-1116.36C25818.43,-1104.91 25818.43,-1095 25818.43,-1095 25818.43,-1095 22064.23,-1095 22064.23,-1095 22064.23,-1095 22064.23,-1060.97 22064.23,-1060.97"/>
<polygon fill="black" stroke="black" points="22067.73,-1060.97 22064.23,-1050.97 22060.73,-1060.97 22067.73,-1060.97"/>
</g>
<!-- L2_S0_TP7_GPU7_attn_v&#45;&gt;L2_S0_TP3_GPU3_mha_ar -->
<g id="edge697" class="edge">
<title>L2_S0_TP7_GPU7_attn_v&#45;&gt;L2_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M25973.49,-1116.34C25973.49,-1059.25 25973.49,-951 25973.49,-951 25973.49,-951 22804.16,-951 22804.16,-951 22804.16,-951 22804.16,-996.77 22804.16,-996.77"/>
<polygon fill="black" stroke="black" points="22800.66,-996.77 22804.16,-1006.77 22807.66,-996.77 22800.66,-996.77"/>
</g>
<!-- L2_S0_TP7_GPU7_attn_v&#45;&gt;L2_S0_TP4_GPU4_mha_ar -->
<g id="edge733" class="edge">
<title>L2_S0_TP7_GPU7_attn_v&#45;&gt;L2_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M25842.24,-1116.65C25842.24,-1098.97 25842.24,-1081 25842.24,-1081 25842.24,-1081 23523.2,-1081 23523.2,-1081 23523.2,-1081 23523.2,-1076.47 23523.2,-1076.47"/>
<polygon fill="black" stroke="black" points="23526.7,-1076.47 23523.2,-1066.47 23519.7,-1076.47 23526.7,-1076.47"/>
</g>
<!-- L2_S0_TP7_GPU7_attn_v&#45;&gt;L2_S0_TP5_GPU5_mha_ar -->
<g id="edge769" class="edge">
<title>L2_S0_TP7_GPU7_attn_v&#45;&gt;L2_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M25866.05,-1116.65C25866.05,-1098.97 25866.05,-1081 25866.05,-1081 25866.05,-1081 24328.91,-1081 24328.91,-1081 24328.91,-1081 24328.91,-1070.75 24328.91,-1070.75"/>
<polygon fill="black" stroke="black" points="24332.41,-1070.75 24328.91,-1060.75 24325.41,-1070.75 24332.41,-1070.75"/>
</g>
<!-- L2_S0_TP7_GPU7_attn_v&#45;&gt;L2_S0_TP6_GPU6_mha_ar -->
<g id="edge805" class="edge">
<title>L2_S0_TP7_GPU7_attn_v&#45;&gt;L2_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M25889.86,-1116.65C25889.86,-1098.97 25889.86,-1081 25889.86,-1081 25889.86,-1081 25121.29,-1081 25121.29,-1081 25121.29,-1081 25121.29,-1065.94 25121.29,-1065.94"/>
<polygon fill="black" stroke="black" points="25124.79,-1065.94 25121.29,-1055.94 25117.79,-1065.94 25124.79,-1065.94"/>
</g>
<!-- L2_S0_TP7_GPU7_attn_v&#45;&gt;L2_S0_TP7_GPU7_mha_ar -->
<g id="edge841" class="edge">
<title>L2_S0_TP7_GPU7_attn_v&#45;&gt;L2_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M25913.66,-1116.51C25913.66,-1116.51 25913.66,-1059.62 25913.66,-1059.62"/>
<polygon fill="black" stroke="black" points="25917.16,-1059.62 25913.66,-1049.62 25910.16,-1059.62 25917.16,-1059.62"/>
</g>
<!-- L2_S0_TP0_GPU0_gate -->
<g id="node224" class="node">
<title>L2_S0_TP0_GPU0_gate</title>
<polygon fill="none" stroke="black" points="19627.56,-844.5 18785.15,-844.5 18568.44,-708.5 19410.85,-708.5 19627.56,-844.5"/>
<text text-anchor="middle" x="19098" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="19098" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="19098" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="19098" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L2_S0_TP0_GPU0_mha_res&#45;&gt;L2_S0_TP0_GPU0_gate -->
<g id="edge591" class="edge">
<title>L2_S0_TP0_GPU0_mha_res&#45;&gt;L2_S0_TP0_GPU0_gate</title>
<path fill="none" stroke="black" d="M19098,-880.39C19098,-880.39 19098,-854.73 19098,-854.73"/>
<polygon fill="black" stroke="black" points="19101.5,-854.73 19098,-844.73 19094.5,-854.73 19101.5,-854.73"/>
</g>
<!-- L2_S0_TP0_GPU0_moe_res -->
<g id="node242" class="node">
<title>L2_S0_TP0_GPU0_moe_res</title>
<polygon fill="none" stroke="black" points="19516,-436.33 18696,-436.33 18696,-368.33 19516,-368.33 19516,-436.33"/>
<text text-anchor="middle" x="19106" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="19106" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="19106" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="19106" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP0_GPU0_mha_res&#45;&gt;L2_S0_TP0_GPU0_moe_res -->
<g id="edge611" class="edge">
<title>L2_S0_TP0_GPU0_mha_res&#45;&gt;L2_S0_TP0_GPU0_moe_res</title>
<path fill="none" stroke="black" d="M18654.4,-903C18508.58,-903 18383.11,-903 18383.11,-903 18383.11,-903 18383.11,-402 18383.11,-402 18383.11,-402 18685.98,-402 18685.98,-402"/>
<polygon fill="black" stroke="black" points="18685.98,-405.5 18695.98,-402 18685.98,-398.5 18685.98,-405.5"/>
</g>
<!-- L2_S0_TP0_GPU0_expert0 -->
<g id="node225" class="node">
<title>L2_S0_TP0_GPU0_expert0</title>
<polygon fill="none" stroke="black" points="19593.5,-672.5 19144.5,-672.5 19144.5,-604.5 19593.5,-604.5 19593.5,-672.5"/>
<text text-anchor="middle" x="19369" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="19369" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="19369" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="19369" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L2_S0_TP0_GPU0_gate&#45;&gt;L2_S0_TP0_GPU0_expert0 -->
<g id="edge592" class="edge">
<title>L2_S0_TP0_GPU0_gate&#45;&gt;L2_S0_TP0_GPU0_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19369,-708.31C19369,-708.31 19369,-682.71 19369,-682.71"/>
<polygon fill="black" stroke="black" points="19372.5,-682.71 19369,-672.71 19365.5,-682.71 19372.5,-682.71"/>
</g>
<!-- L2_S0_TP0_GPU0_expert1 -->
<g id="node226" class="node">
<title>L2_S0_TP0_GPU0_expert1</title>
<polygon fill="none" stroke="black" points="20060.5,-672.5 19611.5,-672.5 19611.5,-604.5 20060.5,-604.5 20060.5,-672.5"/>
<text text-anchor="middle" x="19836" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="19836" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="19836" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="19836" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L2_S0_TP0_GPU0_gate&#45;&gt;L2_S0_TP0_GPU0_expert1 -->
<g id="edge593" class="edge">
<title>L2_S0_TP0_GPU0_gate&#45;&gt;L2_S0_TP0_GPU0_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19619.64,-776.4C19619.64,-776.4 19619.64,-682.74 19619.64,-682.74"/>
<polygon fill="black" stroke="black" points="19623.14,-682.74 19619.64,-672.74 19616.14,-682.74 19623.14,-682.74"/>
</g>
<!-- L2_S0_TP0_GPU0_moe_ar -->
<g id="node227" class="node">
<title>L2_S0_TP0_GPU0_moe_ar</title>
<ellipse fill="none" stroke="black" cx="20467" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="20467" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="20467" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="20467" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="20467" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP0_GPU0_expert0&#45;&gt;L2_S0_TP0_GPU0_moe_ar -->
<g id="edge594" class="edge">
<title>L2_S0_TP0_GPU0_expert0&#45;&gt;L2_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M19584.89,-604.4C19584.89,-576.28 19584.89,-541 19584.89,-541 19584.89,-541 20154.66,-541 20154.66,-541"/>
<polygon fill="black" stroke="black" points="20154.66,-544.5 20164.66,-541 20154.66,-537.5 20154.66,-544.5"/>
</g>
<!-- L2_S0_TP1_GPU1_moe_ar -->
<g id="node251" class="node">
<title>L2_S0_TP1_GPU1_moe_ar</title>
<ellipse fill="none" stroke="black" cx="21154" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="21154" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="21154" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="21154" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="21154" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP0_GPU0_expert0&#45;&gt;L2_S0_TP1_GPU1_moe_ar -->
<g id="edge630" class="edge">
<title>L2_S0_TP0_GPU0_expert0&#45;&gt;L2_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M19576.28,-604.36C19576.28,-588.89 19576.28,-574 19576.28,-574 19576.28,-574 20837.03,-574 20837.03,-574 20837.03,-574 20837.03,-545.91 20837.03,-545.91"/>
<polygon fill="black" stroke="black" points="20840.53,-545.91 20837.03,-535.91 20833.53,-545.91 20840.53,-545.91"/>
</g>
<!-- L2_S0_TP2_GPU2_moe_ar -->
<g id="node261" class="node">
<title>L2_S0_TP2_GPU2_moe_ar</title>
<ellipse fill="none" stroke="black" cx="21841" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="21841" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="21841" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="21841" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="21841" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP0_GPU0_expert0&#45;&gt;L2_S0_TP2_GPU2_moe_ar -->
<g id="edge666" class="edge">
<title>L2_S0_TP0_GPU0_expert0&#45;&gt;L2_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M19567.67,-604.12C19567.67,-551.75 19567.67,-458 19567.67,-458 19567.67,-458 21587.03,-458 21587.03,-458 21587.03,-458 21587.03,-478.84 21587.03,-478.84"/>
<polygon fill="black" stroke="black" points="21583.53,-478.84 21587.03,-488.84 21590.53,-478.84 21583.53,-478.84"/>
</g>
<!-- L2_S0_TP3_GPU3_moe_ar -->
<g id="node271" class="node">
<title>L2_S0_TP3_GPU3_moe_ar</title>
<ellipse fill="none" stroke="black" cx="22528" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="22528" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="22528" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="22528" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="22528" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP0_GPU0_expert0&#45;&gt;L2_S0_TP3_GPU3_moe_ar -->
<g id="edge702" class="edge">
<title>L2_S0_TP0_GPU0_expert0&#45;&gt;L2_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M19559.06,-604.12C19559.06,-551.75 19559.06,-458 19559.06,-458 19559.06,-458 22361.69,-458 22361.69,-458 22361.69,-458 22361.69,-468.44 22361.69,-468.44"/>
<polygon fill="black" stroke="black" points="22358.19,-468.44 22361.69,-478.44 22365.19,-468.44 22358.19,-468.44"/>
</g>
<!-- L2_S0_TP4_GPU4_moe_ar -->
<g id="node281" class="node">
<title>L2_S0_TP4_GPU4_moe_ar</title>
<ellipse fill="none" stroke="black" cx="23215" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="23215" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="23215" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="23215" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="23215" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP0_GPU0_expert0&#45;&gt;L2_S0_TP4_GPU4_moe_ar -->
<g id="edge738" class="edge">
<title>L2_S0_TP0_GPU0_expert0&#45;&gt;L2_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M19550.44,-604.12C19550.44,-551.75 19550.44,-458 19550.44,-458 19550.44,-458 23271.51,-458 23271.51,-458 23271.51,-458 23271.51,-462.79 23271.51,-462.79"/>
<polygon fill="black" stroke="black" points="23268.01,-462.79 23271.51,-472.79 23275.01,-462.79 23268.01,-462.79"/>
</g>
<!-- L2_S0_TP5_GPU5_moe_ar -->
<g id="node291" class="node">
<title>L2_S0_TP5_GPU5_moe_ar</title>
<ellipse fill="none" stroke="black" cx="23902" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="23902" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="23902" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="23902" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="23902" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP0_GPU0_expert0&#45;&gt;L2_S0_TP5_GPU5_moe_ar -->
<g id="edge774" class="edge">
<title>L2_S0_TP0_GPU0_expert0&#45;&gt;L2_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M19541.83,-604.36C19541.83,-551.78 19541.83,-457 19541.83,-457 19541.83,-457 23968.89,-457 23968.89,-457 23968.89,-457 23968.89,-463 23968.89,-463"/>
<polygon fill="black" stroke="black" points="23965.39,-463 23968.89,-473 23972.39,-463 23965.39,-463"/>
</g>
<!-- L2_S0_TP6_GPU6_moe_ar -->
<g id="node301" class="node">
<title>L2_S0_TP6_GPU6_moe_ar</title>
<ellipse fill="none" stroke="black" cx="24589" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="24589" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="24589" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="24589" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="24589" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP0_GPU0_expert0&#45;&gt;L2_S0_TP6_GPU6_moe_ar -->
<g id="edge810" class="edge">
<title>L2_S0_TP0_GPU0_expert0&#45;&gt;L2_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M19533.22,-604.36C19533.22,-551.78 19533.22,-457 19533.22,-457 19533.22,-457 24366,-457 24366,-457 24366,-457 24366,-474.26 24366,-474.26"/>
<polygon fill="black" stroke="black" points="24362.5,-474.26 24366,-484.26 24369.5,-474.26 24362.5,-474.26"/>
</g>
<!-- L2_S0_TP7_GPU7_moe_ar -->
<g id="node311" class="node">
<title>L2_S0_TP7_GPU7_moe_ar</title>
<ellipse fill="none" stroke="black" cx="25276" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="25276" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="25276" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="25276" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="25276" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP0_GPU0_expert0&#45;&gt;L2_S0_TP7_GPU7_moe_ar -->
<g id="edge846" class="edge">
<title>L2_S0_TP0_GPU0_expert0&#45;&gt;L2_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M19524.61,-604.35C19524.61,-548.8 19524.61,-445 19524.61,-445 19524.61,-445 25184.13,-445 25184.13,-445 25184.13,-445 25184.13,-463.94 25184.13,-463.94"/>
<polygon fill="black" stroke="black" points="25180.63,-463.94 25184.13,-473.94 25187.63,-463.94 25180.63,-463.94"/>
</g>
<!-- L2_S0_TP0_GPU0_expert1&#45;&gt;L2_S0_TP0_GPU0_moe_ar -->
<g id="edge595" class="edge">
<title>L2_S0_TP0_GPU0_expert1&#45;&gt;L2_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M20019.06,-604.13C20019.06,-580.74 20019.06,-554 20019.06,-554 20019.06,-554 20217.62,-554 20217.62,-554"/>
<polygon fill="black" stroke="black" points="20217.62,-557.5 20227.62,-554 20217.62,-550.5 20217.62,-557.5"/>
</g>
<!-- L2_S0_TP0_GPU0_expert1&#45;&gt;L2_S0_TP1_GPU1_moe_ar -->
<g id="edge631" class="edge">
<title>L2_S0_TP0_GPU0_expert1&#45;&gt;L2_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M19936.19,-604.15C19936.19,-589.19 19936.19,-575 19936.19,-575 19936.19,-575 20854.53,-575 20854.53,-575 20854.53,-575 20854.53,-551.99 20854.53,-551.99"/>
<polygon fill="black" stroke="black" points="20858.03,-551.99 20854.53,-541.99 20851.03,-551.99 20858.03,-551.99"/>
</g>
<!-- L2_S0_TP0_GPU0_expert1&#45;&gt;L2_S0_TP2_GPU2_moe_ar -->
<g id="edge667" class="edge">
<title>L2_S0_TP0_GPU0_expert1&#45;&gt;L2_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M19977.62,-604.15C19977.62,-589.19 19977.62,-575 19977.62,-575 19977.62,-575 21553.42,-575 21553.42,-575 21553.42,-575 21553.42,-555.15 21553.42,-555.15"/>
<polygon fill="black" stroke="black" points="21556.92,-555.15 21553.42,-545.15 21549.92,-555.15 21556.92,-555.15"/>
</g>
<!-- L2_S0_TP0_GPU0_expert1&#45;&gt;L2_S0_TP3_GPU3_moe_ar -->
<g id="edge703" class="edge">
<title>L2_S0_TP0_GPU0_expert1&#45;&gt;L2_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M19853.36,-672.68C19853.36,-687.27 19853.36,-701 19853.36,-701 19853.36,-701 22404.5,-701 22404.5,-701 22404.5,-701 22404.5,-575.52 22404.5,-575.52"/>
<polygon fill="black" stroke="black" points="22408,-575.52 22404.5,-565.52 22401,-575.52 22408,-575.52"/>
</g>
<!-- L2_S0_TP0_GPU0_expert1&#45;&gt;L2_S0_TP4_GPU4_moe_ar -->
<g id="edge739" class="edge">
<title>L2_S0_TP0_GPU0_expert1&#45;&gt;L2_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M19894.75,-604.4C19894.75,-555.69 19894.75,-472 19894.75,-472 19894.75,-472 23076.03,-472 23076.03,-472 23076.03,-472 23076.03,-472.45 23076.03,-472.45"/>
<polygon fill="black" stroke="black" points="23072.53,-466.47 23076.03,-476.47 23079.53,-466.47 23072.53,-466.47"/>
</g>
<!-- L2_S0_TP0_GPU0_expert1&#45;&gt;L2_S0_TP5_GPU5_moe_ar -->
<g id="edge775" class="edge">
<title>L2_S0_TP0_GPU0_expert1&#45;&gt;L2_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M19853.31,-604.41C19853.31,-554.65 19853.31,-468 19853.31,-468 19853.31,-468 23835.11,-468 23835.11,-468 23835.11,-468 23835.11,-468.52 23835.11,-468.52"/>
<polygon fill="black" stroke="black" points="23831.61,-463.22 23835.11,-473.22 23838.61,-463.22 23831.61,-463.22"/>
</g>
<!-- L2_S0_TP0_GPU0_expert1&#45;&gt;L2_S0_TP6_GPU6_moe_ar -->
<g id="edge811" class="edge">
<title>L2_S0_TP0_GPU0_expert1&#45;&gt;L2_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M19811.88,-604.41C19811.88,-554.65 19811.88,-468 19811.88,-468 19811.88,-468 24276.18,-468 24276.18,-468 24276.18,-468 24276.18,-493.25 24276.18,-493.25"/>
<polygon fill="black" stroke="black" points="24272.68,-493.25 24276.18,-503.25 24279.68,-493.25 24272.68,-493.25"/>
</g>
<!-- L2_S0_TP0_GPU0_expert1&#45;&gt;L2_S0_TP7_GPU7_moe_ar -->
<g id="edge847" class="edge">
<title>L2_S0_TP0_GPU0_expert1&#45;&gt;L2_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M19770.44,-604.35C19770.44,-548.8 19770.44,-445 19770.44,-445 19770.44,-445 25103.27,-445 25103.27,-445 25103.27,-445 25103.27,-469.18 25103.27,-469.18"/>
<polygon fill="black" stroke="black" points="25099.77,-469.18 25103.27,-479.18 25106.77,-469.18 25099.77,-469.18"/>
</g>
<!-- L2_S0_TP0_GPU0_moe_ar&#45;&gt;L2_S0_TP0_GPU0_moe_res -->
<g id="edge610" class="edge">
<title>L2_S0_TP0_GPU0_moe_ar&#45;&gt;L2_S0_TP0_GPU0_moe_res</title>
<path fill="none" stroke="black" d="M20135.53,-527C19799.98,-527 19330.25,-527 19330.25,-527 19330.25,-527 19330.25,-446.4 19330.25,-446.4"/>
<polygon fill="black" stroke="black" points="19333.75,-446.4 19330.25,-436.4 19326.75,-446.4 19333.75,-446.4"/>
</g>
<!-- L2_S0_TP1_GPU1_expert0 -->
<g id="node228" class="node">
<title>L2_S0_TP1_GPU1_expert0</title>
<polygon fill="none" stroke="black" points="20527.5,-672.5 20078.5,-672.5 20078.5,-604.5 20527.5,-604.5 20527.5,-672.5"/>
<text text-anchor="middle" x="20303" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="20303" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="20303" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="20303" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L2_S0_TP1_GPU1_expert0&#45;&gt;L2_S0_TP0_GPU0_moe_ar -->
<g id="edge596" class="edge">
<title>L2_S0_TP1_GPU1_expert0&#45;&gt;L2_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M20198.37,-604.34C20198.37,-604.34 20198.37,-559.3 20198.37,-559.3"/>
<polygon fill="black" stroke="black" points="20201.87,-559.3 20198.37,-549.3 20194.87,-559.3 20201.87,-559.3"/>
</g>
<!-- L2_S0_TP1_GPU1_expert0&#45;&gt;L2_S0_TP1_GPU1_moe_ar -->
<g id="edge632" class="edge">
<title>L2_S0_TP1_GPU1_expert0&#45;&gt;L2_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M20264.19,-604.15C20264.19,-589.19 20264.19,-575 20264.19,-575 20264.19,-575 20872.03,-575 20872.03,-575 20872.03,-575 20872.03,-556.43 20872.03,-556.43"/>
<polygon fill="black" stroke="black" points="20875.53,-556.43 20872.03,-546.43 20868.53,-556.43 20875.53,-556.43"/>
</g>
<!-- L2_S0_TP1_GPU1_expert0&#45;&gt;L2_S0_TP2_GPU2_moe_ar -->
<g id="edge668" class="edge">
<title>L2_S0_TP1_GPU1_expert0&#45;&gt;L2_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M20330.02,-604.15C20330.02,-589.19 20330.02,-575 20330.02,-575 20330.02,-575 21600.31,-575 21600.31,-575 21600.31,-575 21600.31,-564.05 21600.31,-564.05"/>
<polygon fill="black" stroke="black" points="21603.81,-564.05 21600.31,-554.05 21596.81,-564.05 21603.81,-564.05"/>
</g>
<!-- L2_S0_TP1_GPU1_expert0&#45;&gt;L2_S0_TP3_GPU3_moe_ar -->
<g id="edge704" class="edge">
<title>L2_S0_TP1_GPU1_expert0&#45;&gt;L2_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M20395.85,-604.15C20395.85,-589.19 20395.85,-575 20395.85,-575 20395.85,-575 22218.78,-575 22218.78,-575 22218.78,-575 22218.78,-548.9 22218.78,-548.9"/>
<polygon fill="black" stroke="black" points="22222.28,-548.9 22218.78,-538.9 22215.28,-548.9 22222.28,-548.9"/>
</g>
<!-- L2_S0_TP1_GPU1_expert0&#45;&gt;L2_S0_TP4_GPU4_moe_ar -->
<g id="edge740" class="edge">
<title>L2_S0_TP1_GPU1_expert0&#45;&gt;L2_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M20377.83,-672.64C20377.83,-688.11 20377.83,-703 20377.83,-703 20377.83,-703 23338.5,-703 23338.5,-703 23338.5,-703 23338.5,-575.55 23338.5,-575.55"/>
<polygon fill="black" stroke="black" points="23342,-575.55 23338.5,-565.55 23335,-575.55 23342,-575.55"/>
</g>
<!-- L2_S0_TP1_GPU1_expert0&#45;&gt;L2_S0_TP5_GPU5_moe_ar -->
<g id="edge776" class="edge">
<title>L2_S0_TP1_GPU1_expert0&#45;&gt;L2_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M20114.53,-604.41C20114.53,-554.65 20114.53,-468 20114.53,-468 20114.53,-468 23701.32,-468 23701.32,-468 23701.32,-468 23701.32,-471.77 23701.32,-471.77"/>
<polygon fill="black" stroke="black" points="23697.82,-471.77 23701.32,-481.77 23704.82,-471.77 23697.82,-471.77"/>
</g>
<!-- L2_S0_TP1_GPU1_expert0&#45;&gt;L2_S0_TP6_GPU6_moe_ar -->
<g id="edge812" class="edge">
<title>L2_S0_TP1_GPU1_expert0&#45;&gt;L2_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M20096.51,-604.41C20096.51,-554.65 20096.51,-468 20096.51,-468 20096.51,-468 24265.36,-468 24265.36,-468 24265.36,-468 24265.36,-498.26 24265.36,-498.26"/>
<polygon fill="black" stroke="black" points="24261.86,-498.26 24265.36,-508.26 24268.86,-498.26 24261.86,-498.26"/>
</g>
<!-- L2_S0_TP1_GPU1_expert0&#45;&gt;L2_S0_TP7_GPU7_moe_ar -->
<g id="edge848" class="edge">
<title>L2_S0_TP1_GPU1_expert0&#45;&gt;L2_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M20461.67,-604.32C20461.67,-589.73 20461.67,-576 20461.67,-576 20461.67,-576 24969.98,-576 24969.98,-576 24969.98,-576 24969.98,-549.86 24969.98,-549.86"/>
<polygon fill="black" stroke="black" points="24973.48,-549.86 24969.98,-539.86 24966.48,-549.86 24973.48,-549.86"/>
</g>
<!-- L2_S0_TP1_GPU1_expert1 -->
<g id="node229" class="node">
<title>L2_S0_TP1_GPU1_expert1</title>
<polygon fill="none" stroke="black" points="20994.5,-672.5 20545.5,-672.5 20545.5,-604.5 20994.5,-604.5 20994.5,-672.5"/>
<text text-anchor="middle" x="20770" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="20770" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="20770" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="20770" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L2_S0_TP1_GPU1_expert1&#45;&gt;L2_S0_TP0_GPU0_moe_ar -->
<g id="edge597" class="edge">
<title>L2_S0_TP1_GPU1_expert1&#45;&gt;L2_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M20568.77,-604.34C20568.77,-604.34 20568.77,-576.36 20568.77,-576.36"/>
<polygon fill="black" stroke="black" points="20572.27,-576.36 20568.77,-566.36 20565.27,-576.36 20572.27,-576.36"/>
</g>
<!-- L2_S0_TP1_GPU1_expert1&#45;&gt;L2_S0_TP1_GPU1_moe_ar -->
<g id="edge633" class="edge">
<title>L2_S0_TP1_GPU1_expert1&#45;&gt;L2_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M20889.52,-604.34C20889.52,-604.34 20889.52,-560.09 20889.52,-560.09"/>
<polygon fill="black" stroke="black" points="20893.02,-560.09 20889.52,-550.09 20886.02,-560.09 20893.02,-560.09"/>
</g>
<!-- L2_S0_TP1_GPU1_expert1&#45;&gt;L2_S0_TP2_GPU2_moe_ar -->
<g id="edge669" class="edge">
<title>L2_S0_TP1_GPU1_expert1&#45;&gt;L2_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M20924.52,-604.15C20924.52,-589.19 20924.52,-575 20924.52,-575 20924.52,-575 21647.19,-575 21647.19,-575 21647.19,-575 21647.19,-569.8 21647.19,-569.8"/>
<polygon fill="black" stroke="black" points="21650.69,-569.8 21647.19,-559.8 21643.69,-569.8 21650.69,-569.8"/>
</g>
<!-- L2_S0_TP1_GPU1_expert1&#45;&gt;L2_S0_TP3_GPU3_moe_ar -->
<g id="edge705" class="edge">
<title>L2_S0_TP1_GPU1_expert1&#45;&gt;L2_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M20942.01,-604.15C20942.01,-589.19 20942.01,-575 20942.01,-575 20942.01,-575 22244.03,-575 22244.03,-575 22244.03,-575 22244.03,-556.11 22244.03,-556.11"/>
<polygon fill="black" stroke="black" points="22247.53,-556.11 22244.03,-546.11 22240.53,-556.11 22247.53,-556.11"/>
</g>
<!-- L2_S0_TP1_GPU1_expert1&#45;&gt;L2_S0_TP4_GPU4_moe_ar -->
<g id="edge741" class="edge">
<title>L2_S0_TP1_GPU1_expert1&#45;&gt;L2_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M20959.51,-604.15C20959.51,-589.19 20959.51,-575 20959.51,-575 20959.51,-575 22925.43,-575 22925.43,-575 22925.43,-575 22925.43,-554.52 22925.43,-554.52"/>
<polygon fill="black" stroke="black" points="22928.93,-554.52 22925.43,-544.52 22921.93,-554.52 22928.93,-554.52"/>
</g>
<!-- L2_S0_TP1_GPU1_expert1&#45;&gt;L2_S0_TP5_GPU5_moe_ar -->
<g id="edge777" class="edge">
<title>L2_S0_TP1_GPU1_expert1&#45;&gt;L2_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M20904.41,-672.78C20904.41,-688.63 20904.41,-704 20904.41,-704 20904.41,-704 23805.5,-704 23805.5,-704 23805.5,-704 23805.5,-576.74 23805.5,-576.74"/>
<polygon fill="black" stroke="black" points="23809,-576.74 23805.5,-566.74 23802,-576.74 23809,-576.74"/>
</g>
<!-- L2_S0_TP1_GPU1_expert1&#45;&gt;L2_S0_TP6_GPU6_moe_ar -->
<g id="edge813" class="edge">
<title>L2_S0_TP1_GPU1_expert1&#45;&gt;L2_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M20814.31,-672.65C20814.31,-689.39 20814.31,-706 20814.31,-706 20814.31,-706 24278.93,-706 24278.93,-706 24278.93,-706 24278.93,-548.55 24278.93,-548.55"/>
<polygon fill="black" stroke="black" points="24282.43,-548.55 24278.93,-538.55 24275.43,-548.55 24282.43,-548.55"/>
</g>
<!-- L2_S0_TP1_GPU1_expert1&#45;&gt;L2_S0_TP7_GPU7_moe_ar -->
<g id="edge849" class="edge">
<title>L2_S0_TP1_GPU1_expert1&#45;&gt;L2_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M20977,-604.32C20977,-589.73 20977,-576 20977,-576 20977,-576 25026.86,-576 25026.86,-576 25026.86,-576 25026.86,-562.75 25026.86,-562.75"/>
<polygon fill="black" stroke="black" points="25030.36,-562.75 25026.86,-552.75 25023.36,-562.75 25030.36,-562.75"/>
</g>
<!-- L2_S0_TP2_GPU2_expert0 -->
<g id="node230" class="node">
<title>L2_S0_TP2_GPU2_expert0</title>
<polygon fill="none" stroke="black" points="21461.5,-672.5 21012.5,-672.5 21012.5,-604.5 21461.5,-604.5 21461.5,-672.5"/>
<text text-anchor="middle" x="21237" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="21237" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="21237" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="21237" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L2_S0_TP2_GPU2_expert0&#45;&gt;L2_S0_TP0_GPU0_moe_ar -->
<g id="edge598" class="edge">
<title>L2_S0_TP2_GPU2_expert0&#45;&gt;L2_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M21062.39,-604.46C21062.39,-602.32 21062.39,-601 21062.39,-601 21062.39,-601 20592.04,-601 20592.04,-601 20592.04,-601 20592.04,-575.42 20592.04,-575.42"/>
<polygon fill="black" stroke="black" points="20595.54,-575.42 20592.04,-565.42 20588.54,-575.42 20595.54,-575.42"/>
</g>
<!-- L2_S0_TP2_GPU2_expert0&#45;&gt;L2_S0_TP1_GPU1_moe_ar -->
<g id="edge634" class="edge">
<title>L2_S0_TP2_GPU2_expert0&#45;&gt;L2_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M21112.28,-604.34C21112.28,-604.34 21112.28,-578.55 21112.28,-578.55"/>
<polygon fill="black" stroke="black" points="21115.78,-578.55 21112.28,-568.55 21108.78,-578.55 21115.78,-578.55"/>
</g>
<!-- L2_S0_TP2_GPU2_expert0&#45;&gt;L2_S0_TP2_GPU2_moe_ar -->
<g id="edge670" class="edge">
<title>L2_S0_TP2_GPU2_expert0&#45;&gt;L2_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M21261.94,-604.15C21261.94,-589.19 21261.94,-575 21261.94,-575 21261.94,-575 21694.08,-575 21694.08,-575 21694.08,-575 21694.08,-573.69 21694.08,-573.69"/>
<polygon fill="black" stroke="black" points="21697.58,-573.69 21694.08,-563.69 21690.58,-573.69 21697.58,-573.69"/>
</g>
<!-- L2_S0_TP2_GPU2_expert0&#45;&gt;L2_S0_TP3_GPU3_moe_ar -->
<g id="edge706" class="edge">
<title>L2_S0_TP2_GPU2_expert0&#45;&gt;L2_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M21311.83,-604.15C21311.83,-589.19 21311.83,-575 21311.83,-575 21311.83,-575 22269.27,-575 22269.27,-575 22269.27,-575 22269.27,-560.9 22269.27,-560.9"/>
<polygon fill="black" stroke="black" points="22272.77,-560.9 22269.27,-550.9 22265.77,-560.9 22272.77,-560.9"/>
</g>
<!-- L2_S0_TP2_GPU2_expert0&#45;&gt;L2_S0_TP4_GPU4_moe_ar -->
<g id="edge742" class="edge">
<title>L2_S0_TP2_GPU2_expert0&#45;&gt;L2_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M21361.72,-604.15C21361.72,-589.19 21361.72,-575 21361.72,-575 21361.72,-575 22970.33,-575 22970.33,-575 22970.33,-575 22970.33,-563.43 22970.33,-563.43"/>
<polygon fill="black" stroke="black" points="22973.83,-563.43 22970.33,-553.43 22966.83,-563.43 22973.83,-563.43"/>
</g>
<!-- L2_S0_TP2_GPU2_expert0&#45;&gt;L2_S0_TP5_GPU5_moe_ar -->
<g id="edge778" class="edge">
<title>L2_S0_TP2_GPU2_expert0&#45;&gt;L2_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M21411.61,-604.15C21411.61,-589.19 21411.61,-575 21411.61,-575 21411.61,-575 23592.98,-575 23592.98,-575 23592.98,-575 23592.98,-548.9 23592.98,-548.9"/>
<polygon fill="black" stroke="black" points="23596.48,-548.9 23592.98,-538.9 23589.48,-548.9 23596.48,-548.9"/>
</g>
<!-- L2_S0_TP2_GPU2_expert0&#45;&gt;L2_S0_TP6_GPU6_moe_ar -->
<g id="edge814" class="edge">
<title>L2_S0_TP2_GPU2_expert0&#45;&gt;L2_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M21349.25,-672.52C21349.25,-680.13 21349.25,-686 21349.25,-686 21349.25,-686 24276.36,-686 24276.36,-686 24276.36,-686 24276.36,-547.51 24276.36,-547.51"/>
<polygon fill="black" stroke="black" points="24279.86,-547.51 24276.36,-537.51 24272.86,-547.51 24279.86,-547.51"/>
</g>
<!-- L2_S0_TP2_GPU2_expert0&#45;&gt;L2_S0_TP7_GPU7_moe_ar -->
<g id="edge850" class="edge">
<title>L2_S0_TP2_GPU2_expert0&#45;&gt;L2_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M21237,-672.52C21237,-680.13 21237,-686 21237,-686 21237,-686 25211.9,-686 25211.9,-686 25211.9,-686 25211.9,-577.87 25211.9,-577.87"/>
<polygon fill="black" stroke="black" points="25215.4,-577.87 25211.9,-567.87 25208.4,-577.87 25215.4,-577.87"/>
</g>
<!-- L2_S0_TP2_GPU2_expert1 -->
<g id="node231" class="node">
<title>L2_S0_TP2_GPU2_expert1</title>
<polygon fill="none" stroke="black" points="21928.5,-672.5 21479.5,-672.5 21479.5,-604.5 21928.5,-604.5 21928.5,-672.5"/>
<text text-anchor="middle" x="21704" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="21704" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="21704" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="21704" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L2_S0_TP2_GPU2_expert1&#45;&gt;L2_S0_TP0_GPU0_moe_ar -->
<g id="edge599" class="edge">
<title>L2_S0_TP2_GPU2_expert1&#45;&gt;L2_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M21494.49,-604.32C21494.49,-589.73 21494.49,-576 21494.49,-576 21494.49,-576 20615.31,-576 20615.31,-576 20615.31,-576 20615.31,-573.66 20615.31,-573.66"/>
<polygon fill="black" stroke="black" points="20618.81,-573.66 20615.31,-563.66 20611.81,-573.66 20618.81,-573.66"/>
</g>
<!-- L2_S0_TP2_GPU2_expert1&#45;&gt;L2_S0_TP1_GPU1_moe_ar -->
<g id="edge635" class="edge">
<title>L2_S0_TP2_GPU2_expert1&#45;&gt;L2_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M21483.98,-604.34C21483.98,-604.34 21483.98,-538.63 21483.98,-538.63"/>
<polygon fill="black" stroke="black" points="21487.48,-538.63 21483.98,-528.63 21480.48,-538.63 21487.48,-538.63"/>
</g>
<!-- L2_S0_TP2_GPU2_expert1&#45;&gt;L2_S0_TP2_GPU2_moe_ar -->
<g id="edge671" class="edge">
<title>L2_S0_TP2_GPU2_expert1&#45;&gt;L2_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M21740.96,-604.34C21740.96,-604.34 21740.96,-576.36 21740.96,-576.36"/>
<polygon fill="black" stroke="black" points="21744.46,-576.36 21740.96,-566.36 21737.46,-576.36 21744.46,-576.36"/>
</g>
<!-- L2_S0_TP2_GPU2_expert1&#45;&gt;L2_S0_TP3_GPU3_moe_ar -->
<g id="edge707" class="edge">
<title>L2_S0_TP2_GPU2_expert1&#45;&gt;L2_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M21787.85,-604.15C21787.85,-589.19 21787.85,-575 21787.85,-575 21787.85,-575 22294.52,-575 22294.52,-575 22294.52,-575 22294.52,-564.98 22294.52,-564.98"/>
<polygon fill="black" stroke="black" points="22298.02,-564.98 22294.52,-554.98 22291.02,-564.99 22298.02,-564.98"/>
</g>
<!-- L2_S0_TP2_GPU2_expert1&#45;&gt;L2_S0_TP4_GPU4_moe_ar -->
<g id="edge743" class="edge">
<title>L2_S0_TP2_GPU2_expert1&#45;&gt;L2_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M21834.73,-604.15C21834.73,-589.19 21834.73,-575 21834.73,-575 21834.73,-575 23015.23,-575 23015.23,-575 23015.23,-575 23015.23,-569.21 23015.23,-569.21"/>
<polygon fill="black" stroke="black" points="23018.73,-569.21 23015.23,-559.21 23011.73,-569.21 23018.73,-569.21"/>
</g>
<!-- L2_S0_TP2_GPU2_expert1&#45;&gt;L2_S0_TP5_GPU5_moe_ar -->
<g id="edge779" class="edge">
<title>L2_S0_TP2_GPU2_expert1&#45;&gt;L2_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M21881.62,-604.15C21881.62,-589.19 21881.62,-575 21881.62,-575 21881.62,-575 23618.42,-575 23618.42,-575 23618.42,-575 23618.42,-556.11 23618.42,-556.11"/>
<polygon fill="black" stroke="black" points="23621.92,-556.11 23618.42,-546.11 23614.92,-556.11 23621.92,-556.11"/>
</g>
<!-- L2_S0_TP2_GPU2_expert1&#45;&gt;L2_S0_TP6_GPU6_moe_ar -->
<g id="edge815" class="edge">
<title>L2_S0_TP2_GPU2_expert1&#45;&gt;L2_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M21886.41,-672.52C21886.41,-680.13 21886.41,-686 21886.41,-686 21886.41,-686 24273.79,-686 24273.79,-686 24273.79,-686 24273.79,-546.59 24273.79,-546.59"/>
<polygon fill="black" stroke="black" points="24277.29,-546.59 24273.79,-536.59 24270.29,-546.59 24277.29,-546.59"/>
</g>
<!-- L2_S0_TP2_GPU2_expert1&#45;&gt;L2_S0_TP7_GPU7_moe_ar -->
<g id="edge851" class="edge">
<title>L2_S0_TP2_GPU2_expert1&#45;&gt;L2_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M21844.31,-672.52C21844.31,-680.13 21844.31,-686 21844.31,-686 21844.31,-686 25208.3,-686 25208.3,-686 25208.3,-686 25208.3,-577.87 25208.3,-577.87"/>
<polygon fill="black" stroke="black" points="25211.8,-577.87 25208.3,-567.87 25204.8,-577.87 25211.8,-577.87"/>
</g>
<!-- L2_S0_TP3_GPU3_expert0 -->
<g id="node232" class="node">
<title>L2_S0_TP3_GPU3_expert0</title>
<polygon fill="none" stroke="black" points="22395.5,-672.5 21946.5,-672.5 21946.5,-604.5 22395.5,-604.5 22395.5,-672.5"/>
<text text-anchor="middle" x="22171" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="22171" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="22171" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="22171" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L2_S0_TP3_GPU3_expert0&#45;&gt;L2_S0_TP0_GPU0_moe_ar -->
<g id="edge600" class="edge">
<title>L2_S0_TP3_GPU3_expert0&#45;&gt;L2_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M21975.12,-604.32C21975.12,-589.73 21975.12,-576 21975.12,-576 21975.12,-576 20638.58,-576 20638.58,-576 20638.58,-576 20638.58,-571.97 20638.58,-571.97"/>
<polygon fill="black" stroke="black" points="20642.08,-571.97 20638.58,-561.97 20635.08,-571.97 20642.08,-571.97"/>
</g>
<!-- L2_S0_TP3_GPU3_expert0&#45;&gt;L2_S0_TP1_GPU1_moe_ar -->
<g id="edge636" class="edge">
<title>L2_S0_TP3_GPU3_expert0&#45;&gt;L2_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M22003.74,-604.15C22003.74,-589.19 22003.74,-575 22003.74,-575 22003.74,-575 21474.36,-575 21474.36,-575 21474.36,-575 21474.36,-544.47 21474.36,-544.47"/>
<polygon fill="black" stroke="black" points="21477.86,-544.47 21474.36,-534.47 21470.86,-544.47 21477.86,-544.47"/>
</g>
<!-- L2_S0_TP3_GPU3_expert0&#45;&gt;L2_S0_TP2_GPU2_moe_ar -->
<g id="edge672" class="edge">
<title>L2_S0_TP3_GPU3_expert0&#45;&gt;L2_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M22032.36,-604.34C22032.36,-604.34 22032.36,-569.91 22032.36,-569.91"/>
<polygon fill="black" stroke="black" points="22035.86,-569.91 22032.36,-559.91 22028.86,-569.91 22035.86,-569.91"/>
</g>
<!-- L2_S0_TP3_GPU3_expert0&#45;&gt;L2_S0_TP3_GPU3_moe_ar -->
<g id="edge708" class="edge">
<title>L2_S0_TP3_GPU3_expert0&#45;&gt;L2_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M22319.76,-604.34C22319.76,-604.34 22319.76,-568.22 22319.76,-568.22"/>
<polygon fill="black" stroke="black" points="22323.26,-568.22 22319.76,-558.22 22316.26,-568.22 22323.26,-568.22"/>
</g>
<!-- L2_S0_TP3_GPU3_expert0&#45;&gt;L2_S0_TP4_GPU4_moe_ar -->
<g id="edge744" class="edge">
<title>L2_S0_TP3_GPU3_expert0&#45;&gt;L2_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M22345.01,-604.15C22345.01,-589.19 22345.01,-575 22345.01,-575 22345.01,-575 23105.02,-575 23105.02,-575 23105.02,-575 23105.02,-574.1 23105.02,-574.1"/>
<polygon fill="black" stroke="black" points="23108.52,-575.99 23105.02,-565.99 23101.52,-575.99 23108.52,-575.99"/>
</g>
<!-- L2_S0_TP3_GPU3_expert0&#45;&gt;L2_S0_TP5_GPU5_moe_ar -->
<g id="edge780" class="edge">
<title>L2_S0_TP3_GPU3_expert0&#45;&gt;L2_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M22370.25,-604.15C22370.25,-589.19 22370.25,-575 22370.25,-575 22370.25,-575 23643.86,-575 23643.86,-575 23643.86,-575 23643.86,-561.22 23643.86,-561.22"/>
<polygon fill="black" stroke="black" points="23647.36,-561.22 23643.86,-551.22 23640.36,-561.22 23647.36,-561.22"/>
</g>
<!-- L2_S0_TP3_GPU3_expert0&#45;&gt;L2_S0_TP6_GPU6_moe_ar -->
<g id="edge816" class="edge">
<title>L2_S0_TP3_GPU3_expert0&#45;&gt;L2_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M22245.83,-672.52C22245.83,-680.13 22245.83,-686 22245.83,-686 22245.83,-686 24271.21,-686 24271.21,-686 24271.21,-686 24271.21,-545.7 24271.21,-545.7"/>
<polygon fill="black" stroke="black" points="24274.71,-545.7 24271.21,-535.7 24267.71,-545.7 24274.71,-545.7"/>
</g>
<!-- L2_S0_TP3_GPU3_expert0&#45;&gt;L2_S0_TP7_GPU7_moe_ar -->
<g id="edge852" class="edge">
<title>L2_S0_TP3_GPU3_expert0&#45;&gt;L2_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M22184.5,-604.35C22184.5,-548.8 22184.5,-445 22184.5,-445 22184.5,-445 25022.4,-445 25022.4,-445 25022.4,-445 25022.4,-478.87 25022.4,-478.87"/>
<polygon fill="black" stroke="black" points="25018.9,-478.87 25022.4,-488.87 25025.9,-478.87 25018.9,-478.87"/>
</g>
<!-- L2_S0_TP3_GPU3_expert1 -->
<g id="node233" class="node">
<title>L2_S0_TP3_GPU3_expert1</title>
<polygon fill="none" stroke="black" points="22862.5,-672.5 22413.5,-672.5 22413.5,-604.5 22862.5,-604.5 22862.5,-672.5"/>
<text text-anchor="middle" x="22638" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="22638" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="22638" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="22638" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L2_S0_TP3_GPU3_expert1&#45;&gt;L2_S0_TP0_GPU0_moe_ar -->
<g id="edge601" class="edge">
<title>L2_S0_TP3_GPU3_expert1&#45;&gt;L2_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M22463.38,-604.32C22463.38,-589.73 22463.38,-576 22463.38,-576 22463.38,-576 20661.85,-576 20661.85,-576 20661.85,-576 20661.85,-569.62 20661.85,-569.62"/>
<polygon fill="black" stroke="black" points="20665.35,-569.62 20661.85,-559.62 20658.35,-569.62 20665.35,-569.62"/>
</g>
<!-- L2_S0_TP3_GPU3_expert1&#45;&gt;L2_S0_TP1_GPU1_moe_ar -->
<g id="edge637" class="edge">
<title>L2_S0_TP3_GPU3_expert1&#45;&gt;L2_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M22513.27,-604.15C22513.27,-589.19 22513.27,-575 22513.27,-575 22513.27,-575 21476.93,-575 21476.93,-575 21476.93,-575 21476.93,-543.08 21476.93,-543.08"/>
<polygon fill="black" stroke="black" points="21480.43,-543.08 21476.93,-533.08 21473.43,-543.08 21480.43,-543.08"/>
</g>
<!-- L2_S0_TP3_GPU3_expert1&#45;&gt;L2_S0_TP2_GPU2_moe_ar -->
<g id="edge673" class="edge">
<title>L2_S0_TP3_GPU3_expert1&#45;&gt;L2_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M22563.15,-604.15C22563.15,-589.19 22563.15,-575 22563.15,-575 22563.15,-575 22060.98,-575 22060.98,-575 22060.98,-575 22060.98,-566.82 22060.98,-566.82"/>
<polygon fill="black" stroke="black" points="22064.48,-566.82 22060.98,-556.82 22057.48,-566.82 22064.48,-566.82"/>
</g>
<!-- L2_S0_TP3_GPU3_expert1&#45;&gt;L2_S0_TP3_GPU3_moe_ar -->
<g id="edge709" class="edge">
<title>L2_S0_TP3_GPU3_expert1&#45;&gt;L2_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M22613.04,-604.34C22613.04,-604.34 22613.04,-577.23 22613.04,-577.23"/>
<polygon fill="black" stroke="black" points="22616.54,-577.23 22613.04,-567.23 22609.54,-577.23 22616.54,-577.23"/>
</g>
<!-- L2_S0_TP3_GPU3_expert1&#45;&gt;L2_S0_TP4_GPU4_moe_ar -->
<g id="edge745" class="edge">
<title>L2_S0_TP3_GPU3_expert1&#45;&gt;L2_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M22862.76,-649C22868.61,-649 22871.93,-649 22871.93,-649 22871.93,-649 22871.93,-504 22871.93,-504 22871.93,-504 22890.59,-504 22890.59,-504"/>
<polygon fill="black" stroke="black" points="22890.59,-507.5 22900.59,-504 22890.59,-500.5 22890.59,-507.5"/>
</g>
<!-- L2_S0_TP3_GPU3_expert1&#45;&gt;L2_S0_TP5_GPU5_moe_ar -->
<g id="edge781" class="edge">
<title>L2_S0_TP3_GPU3_expert1&#45;&gt;L2_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M22662.92,-604.15C22662.92,-589.19 22662.92,-575 22662.92,-575 22662.92,-575 23669.3,-575 23669.3,-575 23669.3,-575 23669.3,-564.98 23669.3,-564.98"/>
<polygon fill="black" stroke="black" points="23672.8,-564.98 23669.3,-554.98 23665.8,-564.99 23672.8,-564.98"/>
</g>
<!-- L2_S0_TP3_GPU3_expert1&#45;&gt;L2_S0_TP6_GPU6_moe_ar -->
<g id="edge817" class="edge">
<title>L2_S0_TP3_GPU3_expert1&#45;&gt;L2_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M22749.71,-672.78C22749.71,-679.75 22749.71,-685 22749.71,-685 22749.71,-685 24268.64,-685 24268.64,-685 24268.64,-685 24268.64,-544.45 24268.64,-544.45"/>
<polygon fill="black" stroke="black" points="24272.14,-544.45 24268.64,-534.45 24265.14,-544.45 24272.14,-544.45"/>
</g>
<!-- L2_S0_TP3_GPU3_expert1&#45;&gt;L2_S0_TP7_GPU7_moe_ar -->
<g id="edge853" class="edge">
<title>L2_S0_TP3_GPU3_expert1&#45;&gt;L2_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M22637.64,-672.52C22637.64,-680.13 22637.64,-686 22637.64,-686 22637.64,-686 25204.7,-686 25204.7,-686 25204.7,-686 25204.7,-577.42 25204.7,-577.42"/>
<polygon fill="black" stroke="black" points="25208.2,-577.42 25204.7,-567.42 25201.2,-577.42 25208.2,-577.42"/>
</g>
<!-- L2_S0_TP4_GPU4_expert0 -->
<g id="node234" class="node">
<title>L2_S0_TP4_GPU4_expert0</title>
<polygon fill="none" stroke="black" points="23329.5,-672.5 22880.5,-672.5 22880.5,-604.5 23329.5,-604.5 23329.5,-672.5"/>
<text text-anchor="middle" x="23105" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="23105" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="23105" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="23105" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L2_S0_TP4_GPU4_expert0&#45;&gt;L2_S0_TP0_GPU0_moe_ar -->
<g id="edge602" class="edge">
<title>L2_S0_TP4_GPU4_expert0&#45;&gt;L2_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M23105,-672.64C23105,-686.36 23105,-699 23105,-699 23105,-699 20539.5,-699 20539.5,-699 20539.5,-699 20539.5,-577.8 20539.5,-577.8"/>
<polygon fill="black" stroke="black" points="20543,-577.8 20539.5,-567.8 20536,-577.8 20543,-577.8"/>
</g>
<!-- L2_S0_TP4_GPU4_expert0&#45;&gt;L2_S0_TP1_GPU1_moe_ar -->
<g id="edge638" class="edge">
<title>L2_S0_TP4_GPU4_expert0&#45;&gt;L2_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M22992.75,-672.61C22992.75,-674.11 22992.75,-675 22992.75,-675 22992.75,-675 21469.21,-675 21469.21,-675 21469.21,-675 21469.21,-546.67 21469.21,-546.67"/>
<polygon fill="black" stroke="black" points="21472.71,-546.67 21469.21,-536.67 21465.71,-546.67 21472.71,-546.67"/>
</g>
<!-- L2_S0_TP4_GPU4_expert0&#45;&gt;L2_S0_TP2_GPU2_moe_ar -->
<g id="edge674" class="edge">
<title>L2_S0_TP4_GPU4_expert0&#45;&gt;L2_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M23060.12,-604.15C23060.12,-589.19 23060.12,-575 23060.12,-575 23060.12,-575 22089.6,-575 22089.6,-575 22089.6,-575 22089.6,-562.8 22089.6,-562.8"/>
<polygon fill="black" stroke="black" points="22093.1,-562.8 22089.6,-552.8 22086.1,-562.8 22093.1,-562.8"/>
</g>
<!-- L2_S0_TP4_GPU4_expert0&#45;&gt;L2_S0_TP3_GPU3_moe_ar -->
<g id="edge710" class="edge">
<title>L2_S0_TP4_GPU4_expert0&#45;&gt;L2_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M22880.3,-627C22873.48,-627 22869.57,-627 22869.57,-627 22869.57,-627 22869.57,-536 22869.57,-536 22869.57,-536 22854.45,-536 22854.45,-536"/>
<polygon fill="black" stroke="black" points="22854.45,-532.5 22844.45,-536 22854.45,-539.5 22854.45,-532.5"/>
</g>
<!-- L2_S0_TP4_GPU4_expert0&#45;&gt;L2_S0_TP4_GPU4_moe_ar -->
<g id="edge746" class="edge">
<title>L2_S0_TP4_GPU4_expert0&#45;&gt;L2_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M23149.92,-604.34C23149.92,-604.34 23149.92,-577.67 23149.92,-577.67"/>
<polygon fill="black" stroke="black" points="23153.42,-577.67 23149.92,-567.67 23146.42,-577.67 23153.42,-577.67"/>
</g>
<!-- L2_S0_TP4_GPU4_expert0&#45;&gt;L2_S0_TP5_GPU5_moe_ar -->
<g id="edge782" class="edge">
<title>L2_S0_TP4_GPU4_expert0&#45;&gt;L2_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M23194.81,-604.46C23194.81,-602.32 23194.81,-601 23194.81,-601 23194.81,-601 23694.74,-601 23694.74,-601 23694.74,-601 23694.74,-568.35 23694.74,-568.35"/>
<polygon fill="black" stroke="black" points="23698.24,-568.35 23694.74,-558.35 23691.24,-568.35 23698.24,-568.35"/>
</g>
<!-- L2_S0_TP4_GPU4_expert0&#45;&gt;L2_S0_TP6_GPU6_moe_ar -->
<g id="edge818" class="edge">
<title>L2_S0_TP4_GPU4_expert0&#45;&gt;L2_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M23239.71,-604.39C23239.71,-602.89 23239.71,-602 23239.71,-602 23239.71,-602 24266.07,-602 24266.07,-602 24266.07,-602 24266.07,-543.16 24266.07,-543.16"/>
<polygon fill="black" stroke="black" points="24269.57,-543.16 24266.07,-533.16 24262.57,-543.16 24269.57,-543.16"/>
</g>
<!-- L2_S0_TP4_GPU4_expert0&#45;&gt;L2_S0_TP7_GPU7_moe_ar -->
<g id="edge854" class="edge">
<title>L2_S0_TP4_GPU4_expert0&#45;&gt;L2_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M23284.6,-604.39C23284.6,-602.89 23284.6,-602 23284.6,-602 23284.6,-602 25055.3,-602 25055.3,-602 25055.3,-602 25055.3,-566.91 25055.3,-566.91"/>
<polygon fill="black" stroke="black" points="25058.8,-566.91 25055.3,-556.91 25051.8,-566.91 25058.8,-566.91"/>
</g>
<!-- L2_S0_TP4_GPU4_expert1 -->
<g id="node235" class="node">
<title>L2_S0_TP4_GPU4_expert1</title>
<polygon fill="none" stroke="black" points="23796.5,-672.5 23347.5,-672.5 23347.5,-604.5 23796.5,-604.5 23796.5,-672.5"/>
<text text-anchor="middle" x="23572" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="23572" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="23572" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="23572" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L2_S0_TP4_GPU4_expert1&#45;&gt;L2_S0_TP0_GPU0_moe_ar -->
<g id="edge603" class="edge">
<title>L2_S0_TP4_GPU4_expert1&#45;&gt;L2_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M23558.5,-604.41C23558.5,-554.65 23558.5,-468 23558.5,-468 23558.5,-468 20675.23,-468 20675.23,-468 20675.23,-468 20675.23,-472.6 20675.23,-472.6"/>
<polygon fill="black" stroke="black" points="20671.73,-472.6 20675.23,-482.6 20678.73,-472.6 20671.73,-472.6"/>
</g>
<!-- L2_S0_TP4_GPU4_expert1&#45;&gt;L2_S0_TP1_GPU1_moe_ar -->
<g id="edge639" class="edge">
<title>L2_S0_TP4_GPU4_expert1&#45;&gt;L2_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M23497.17,-672.61C23497.17,-674.11 23497.17,-675 23497.17,-675 23497.17,-675 21466.64,-675 21466.64,-675 21466.64,-675 21466.64,-547.55 21466.64,-547.55"/>
<polygon fill="black" stroke="black" points="21470.14,-547.55 21466.64,-537.55 21463.14,-547.55 21470.14,-547.55"/>
</g>
<!-- L2_S0_TP4_GPU4_expert1&#45;&gt;L2_S0_TP2_GPU2_moe_ar -->
<g id="edge675" class="edge">
<title>L2_S0_TP4_GPU4_expert1&#45;&gt;L2_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M23372.75,-604.15C23372.75,-589.19 23372.75,-575 23372.75,-575 23372.75,-575 22118.22,-575 22118.22,-575 22118.22,-575 22118.22,-557.39 22118.22,-557.39"/>
<polygon fill="black" stroke="black" points="22121.72,-557.39 22118.22,-547.39 22114.72,-557.39 22121.72,-557.39"/>
</g>
<!-- L2_S0_TP4_GPU4_expert1&#45;&gt;L2_S0_TP3_GPU3_moe_ar -->
<g id="edge711" class="edge">
<title>L2_S0_TP4_GPU4_expert1&#45;&gt;L2_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M23397.99,-604.15C23397.99,-589.19 23397.99,-575 23397.99,-575 23397.99,-575 22712.81,-575 22712.81,-575 22712.81,-575 22712.81,-570.66 22712.81,-570.66"/>
<polygon fill="black" stroke="black" points="22716.31,-570.66 22712.81,-560.66 22709.31,-570.66 22716.31,-570.66"/>
</g>
<!-- L2_S0_TP4_GPU4_expert1&#45;&gt;L2_S0_TP4_GPU4_moe_ar -->
<g id="edge747" class="edge">
<title>L2_S0_TP4_GPU4_expert1&#45;&gt;L2_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M23423.24,-604.34C23423.24,-604.34 23423.24,-568.22 23423.24,-568.22"/>
<polygon fill="black" stroke="black" points="23426.74,-568.22 23423.24,-558.22 23419.74,-568.22 23426.74,-568.22"/>
</g>
<!-- L2_S0_TP4_GPU4_expert1&#45;&gt;L2_S0_TP5_GPU5_moe_ar -->
<g id="edge783" class="edge">
<title>L2_S0_TP4_GPU4_expert1&#45;&gt;L2_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M23720.18,-604.34C23720.18,-604.34 23720.18,-571.18 23720.18,-571.18"/>
<polygon fill="black" stroke="black" points="23723.68,-571.18 23720.18,-561.18 23716.68,-571.18 23723.68,-571.18"/>
</g>
<!-- L2_S0_TP4_GPU4_expert1&#45;&gt;L2_S0_TP6_GPU6_moe_ar -->
<g id="edge819" class="edge">
<title>L2_S0_TP4_GPU4_expert1&#45;&gt;L2_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M23745.62,-604.39C23745.62,-602.89 23745.62,-602 23745.62,-602 23745.62,-602 24257.53,-602 24257.53,-602 24257.53,-602 24257.53,-537.09 24257.53,-537.09"/>
<polygon fill="black" stroke="black" points="24261.03,-537.09 24257.53,-527.09 24254.03,-537.09 24261.03,-537.09"/>
</g>
<!-- L2_S0_TP4_GPU4_expert1&#45;&gt;L2_S0_TP7_GPU7_moe_ar -->
<g id="edge855" class="edge">
<title>L2_S0_TP4_GPU4_expert1&#45;&gt;L2_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M23771.06,-604.39C23771.06,-602.89 23771.06,-602 23771.06,-602 23771.06,-602 25083.74,-602 25083.74,-602 25083.74,-602 25083.74,-569.77 25083.74,-569.77"/>
<polygon fill="black" stroke="black" points="25087.24,-569.77 25083.74,-559.77 25080.24,-569.77 25087.24,-569.77"/>
</g>
<!-- L2_S0_TP5_GPU5_expert0 -->
<g id="node236" class="node">
<title>L2_S0_TP5_GPU5_expert0</title>
<polygon fill="none" stroke="black" points="24263.5,-672.5 23814.5,-672.5 23814.5,-604.5 24263.5,-604.5 24263.5,-672.5"/>
<text text-anchor="middle" x="24039" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="24039" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="24039" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="24039" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L2_S0_TP5_GPU5_expert0&#45;&gt;L2_S0_TP0_GPU0_moe_ar -->
<g id="edge604" class="edge">
<title>L2_S0_TP5_GPU5_expert0&#45;&gt;L2_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M23898.02,-672.53C23898.02,-688.89 23898.02,-705 23898.02,-705 23898.02,-705 20533.5,-705 20533.5,-705 20533.5,-705 20533.5,-577.95 20533.5,-577.95"/>
<polygon fill="black" stroke="black" points="20537,-577.95 20533.5,-567.95 20530,-577.95 20537,-577.95"/>
</g>
<!-- L2_S0_TP5_GPU5_expert0&#45;&gt;L2_S0_TP1_GPU1_moe_ar -->
<g id="edge640" class="edge">
<title>L2_S0_TP5_GPU5_expert0&#45;&gt;L2_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M23856.26,-672.61C23856.26,-674.11 23856.26,-675 23856.26,-675 23856.26,-675 21464.07,-675 21464.07,-675 21464.07,-675 21464.07,-548.45 21464.07,-548.45"/>
<polygon fill="black" stroke="black" points="21467.57,-548.45 21464.07,-538.45 21460.57,-548.45 21467.57,-548.45"/>
</g>
<!-- L2_S0_TP5_GPU5_expert0&#45;&gt;L2_S0_TP2_GPU2_moe_ar -->
<g id="edge676" class="edge">
<title>L2_S0_TP5_GPU5_expert0&#45;&gt;L2_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M23856.7,-604.15C23856.7,-589.19 23856.7,-575 23856.7,-575 23856.7,-575 22146.84,-575 22146.84,-575 22146.84,-575 22146.84,-550.12 22146.84,-550.12"/>
<polygon fill="black" stroke="black" points="22150.34,-550.12 22146.84,-540.12 22143.34,-550.12 22150.34,-550.12"/>
</g>
<!-- L2_S0_TP5_GPU5_expert0&#45;&gt;L2_S0_TP3_GPU3_moe_ar -->
<g id="edge712" class="edge">
<title>L2_S0_TP5_GPU5_expert0&#45;&gt;L2_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M23898.89,-604.15C23898.89,-589.19 23898.89,-575 23898.89,-575 23898.89,-575 22762.69,-575 22762.69,-575 22762.69,-575 22762.69,-564.68 22762.69,-564.68"/>
<polygon fill="black" stroke="black" points="22766.19,-564.68 22762.69,-554.68 22759.19,-564.68 22766.19,-564.68"/>
</g>
<!-- L2_S0_TP5_GPU5_expert0&#45;&gt;L2_S0_TP4_GPU4_moe_ar -->
<g id="edge748" class="edge">
<title>L2_S0_TP5_GPU5_expert0&#45;&gt;L2_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M23941.09,-604.36C23941.09,-588.89 23941.09,-574 23941.09,-574 23941.09,-574 23448.48,-574 23448.48,-574 23448.48,-574 23448.48,-564.96 23448.48,-564.96"/>
<polygon fill="black" stroke="black" points="23451.98,-564.96 23448.48,-554.96 23444.98,-564.96 23451.98,-564.96"/>
</g>
<!-- L2_S0_TP5_GPU5_expert0&#45;&gt;L2_S0_TP5_GPU5_moe_ar -->
<g id="edge784" class="edge">
<title>L2_S0_TP5_GPU5_expert0&#45;&gt;L2_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M23983.28,-604.34C23983.28,-604.34 23983.28,-577.23 23983.28,-577.23"/>
<polygon fill="black" stroke="black" points="23986.78,-577.23 23983.28,-567.23 23979.78,-577.23 23986.78,-577.23"/>
</g>
<!-- L2_S0_TP5_GPU5_expert0&#45;&gt;L2_S0_TP6_GPU6_moe_ar -->
<g id="edge820" class="edge">
<title>L2_S0_TP5_GPU5_expert0&#45;&gt;L2_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M24260.51,-604.34C24260.51,-604.34 24260.51,-539.61 24260.51,-539.61"/>
<polygon fill="black" stroke="black" points="24264.01,-539.61 24260.51,-529.61 24257.01,-539.61 24264.01,-539.61"/>
</g>
<!-- L2_S0_TP5_GPU5_expert0&#45;&gt;L2_S0_TP7_GPU7_moe_ar -->
<g id="edge856" class="edge">
<title>L2_S0_TP5_GPU5_expert0&#45;&gt;L2_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M24245.5,-604.39C24245.5,-602.89 24245.5,-602 24245.5,-602 24245.5,-602 25112.18,-602 25112.18,-602 25112.18,-602 25112.18,-572.64 25112.18,-572.64"/>
<polygon fill="black" stroke="black" points="25115.68,-572.64 25112.18,-562.64 25108.68,-572.64 25115.68,-572.64"/>
</g>
<!-- L2_S0_TP5_GPU5_expert1 -->
<g id="node237" class="node">
<title>L2_S0_TP5_GPU5_expert1</title>
<polygon fill="none" stroke="black" points="24730.5,-672.5 24281.5,-672.5 24281.5,-604.5 24730.5,-604.5 24730.5,-672.5"/>
<text text-anchor="middle" x="24506" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="24506" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="24506" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="24506" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L2_S0_TP5_GPU5_expert1&#45;&gt;L2_S0_TP0_GPU0_moe_ar -->
<g id="edge605" class="edge">
<title>L2_S0_TP5_GPU5_expert1&#45;&gt;L2_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M24337.62,-604.32C24337.62,-589.73 24337.62,-576 24337.62,-576 24337.62,-576 20685.12,-576 20685.12,-576 20685.12,-576 20685.12,-566.87 20685.12,-566.87"/>
<polygon fill="black" stroke="black" points="20688.62,-566.87 20685.12,-556.87 20681.62,-566.87 20688.62,-566.87"/>
</g>
<!-- L2_S0_TP5_GPU5_expert1&#45;&gt;L2_S0_TP1_GPU1_moe_ar -->
<g id="edge641" class="edge">
<title>L2_S0_TP5_GPU5_expert1&#45;&gt;L2_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M24393.75,-604.32C24393.75,-589.73 24393.75,-576 24393.75,-576 24393.75,-576 21162.17,-576 21162.17,-576 21162.17,-576 21162.17,-575.27 21162.17,-575.27"/>
<polygon fill="black" stroke="black" points="21165.67,-578.73 21162.17,-568.73 21158.67,-578.73 21165.67,-578.73"/>
</g>
<!-- L2_S0_TP5_GPU5_expert1&#45;&gt;L2_S0_TP2_GPU2_moe_ar -->
<g id="edge677" class="edge">
<title>L2_S0_TP5_GPU5_expert1&#45;&gt;L2_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M24431.17,-672.52C24431.17,-680.13 24431.17,-686 24431.17,-686 24431.17,-686 21937.5,-686 21937.5,-686 21937.5,-686 21937.5,-576.54 21937.5,-576.54"/>
<polygon fill="black" stroke="black" points="21941,-576.54 21937.5,-566.54 21934,-576.54 21941,-576.54"/>
</g>
<!-- L2_S0_TP5_GPU5_expert1&#45;&gt;L2_S0_TP3_GPU3_moe_ar -->
<g id="edge713" class="edge">
<title>L2_S0_TP5_GPU5_expert1&#45;&gt;L2_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M24449.88,-604.15C24449.88,-589.19 24449.88,-575 24449.88,-575 24449.88,-575 22812.58,-575 22812.58,-575 22812.58,-575 22812.58,-555.79 22812.58,-555.79"/>
<polygon fill="black" stroke="black" points="22816.08,-555.79 22812.58,-545.79 22809.08,-555.79 22816.08,-555.79"/>
</g>
<!-- L2_S0_TP5_GPU5_expert1&#45;&gt;L2_S0_TP4_GPU4_moe_ar -->
<g id="edge749" class="edge">
<title>L2_S0_TP5_GPU5_expert1&#45;&gt;L2_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M24506,-604.36C24506,-588.89 24506,-574 24506,-574 24506,-574 23473.73,-574 23473.73,-574 23473.73,-574 23473.73,-560.96 23473.73,-560.96"/>
<polygon fill="black" stroke="black" points="23477.23,-560.96 23473.73,-550.96 23470.23,-560.96 23477.23,-560.96"/>
</g>
<!-- L2_S0_TP5_GPU5_expert1&#45;&gt;L2_S0_TP5_GPU5_moe_ar -->
<g id="edge785" class="edge">
<title>L2_S0_TP5_GPU5_expert1&#45;&gt;L2_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M24562.12,-604.36C24562.12,-588.89 24562.12,-574 24562.12,-574 24562.12,-574 24025.48,-574 24025.48,-574 24025.48,-574 24025.48,-573.12 24025.48,-573.12"/>
<polygon fill="black" stroke="black" points="24028.98,-575.15 24025.48,-565.15 24021.98,-575.15 24028.98,-575.15"/>
</g>
<!-- L2_S0_TP5_GPU5_expert1&#45;&gt;L2_S0_TP6_GPU6_moe_ar -->
<g id="edge821" class="edge">
<title>L2_S0_TP5_GPU5_expert1&#45;&gt;L2_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M24618.25,-604.34C24618.25,-604.34 24618.25,-578.55 24618.25,-578.55"/>
<polygon fill="black" stroke="black" points="24621.75,-578.55 24618.25,-568.55 24614.75,-578.55 24621.75,-578.55"/>
</g>
<!-- L2_S0_TP5_GPU5_expert1&#45;&gt;L2_S0_TP7_GPU7_moe_ar -->
<g id="edge857" class="edge">
<title>L2_S0_TP5_GPU5_expert1&#45;&gt;L2_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M24674.38,-604.39C24674.38,-602.89 24674.38,-602 24674.38,-602 24674.38,-602 25140.62,-602 25140.62,-602 25140.62,-602 25140.62,-574.55 25140.62,-574.55"/>
<polygon fill="black" stroke="black" points="25144.12,-574.55 25140.62,-564.55 25137.12,-574.55 25144.12,-574.55"/>
</g>
<!-- L2_S0_TP6_GPU6_expert0 -->
<g id="node238" class="node">
<title>L2_S0_TP6_GPU6_expert0</title>
<polygon fill="none" stroke="black" points="25197.5,-672.5 24748.5,-672.5 24748.5,-604.5 25197.5,-604.5 25197.5,-672.5"/>
<text text-anchor="middle" x="24973" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="24973" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="24973" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="24973" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L2_S0_TP6_GPU6_expert0&#45;&gt;L2_S0_TP0_GPU0_moe_ar -->
<g id="edge606" class="edge">
<title>L2_S0_TP6_GPU6_expert0&#45;&gt;L2_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M24998.42,-604.32C24998.42,-589.73 24998.42,-576 24998.42,-576 24998.42,-576 20708.38,-576 20708.38,-576 20708.38,-576 20708.38,-563.71 20708.38,-563.71"/>
<polygon fill="black" stroke="black" points="20711.88,-563.71 20708.38,-553.71 20704.88,-563.71 20711.88,-563.71"/>
</g>
<!-- L2_S0_TP6_GPU6_expert0&#45;&gt;L2_S0_TP1_GPU1_moe_ar -->
<g id="edge642" class="edge">
<title>L2_S0_TP6_GPU6_expert0&#45;&gt;L2_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M24770.37,-604.15C24770.37,-589.19 24770.37,-575 24770.37,-575 24770.37,-575 21212.06,-575 21212.06,-575 21212.06,-575 21212.06,-574.29 21212.06,-574.29"/>
<polygon fill="black" stroke="black" points="21215.56,-577.86 21212.06,-567.86 21208.56,-577.86 21215.56,-577.86"/>
</g>
<!-- L2_S0_TP6_GPU6_expert0&#45;&gt;L2_S0_TP2_GPU2_moe_ar -->
<g id="edge678" class="edge">
<title>L2_S0_TP6_GPU6_expert0&#45;&gt;L2_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M24932.5,-604.35C24932.5,-548.8 24932.5,-445 24932.5,-445 24932.5,-445 22115.97,-445 22115.97,-445 22115.97,-445 22115.97,-482.76 22115.97,-482.76"/>
<polygon fill="black" stroke="black" points="22112.47,-482.76 22115.97,-492.76 22119.47,-482.76 22112.47,-482.76"/>
</g>
<!-- L2_S0_TP6_GPU6_expert0&#45;&gt;L2_S0_TP3_GPU3_moe_ar -->
<g id="edge714" class="edge">
<title>L2_S0_TP6_GPU6_expert0&#45;&gt;L2_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M24927.98,-604.35C24927.98,-548.8 24927.98,-445 24927.98,-445 24927.98,-445 22829.57,-445 22829.57,-445 22829.57,-445 22829.57,-489.41 22829.57,-489.41"/>
<polygon fill="black" stroke="black" points="22826.07,-489.41 22829.57,-499.41 22833.07,-489.41 22826.07,-489.41"/>
</g>
<!-- L2_S0_TP6_GPU6_expert0&#45;&gt;L2_S0_TP4_GPU4_moe_ar -->
<g id="edge750" class="edge">
<title>L2_S0_TP6_GPU6_expert0&#45;&gt;L2_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M24792.24,-604.36C24792.24,-588.89 24792.24,-574 24792.24,-574 24792.24,-574 23498.97,-574 23498.97,-574 23498.97,-574 23498.97,-555.95 23498.97,-555.95"/>
<polygon fill="black" stroke="black" points="23502.47,-555.95 23498.97,-545.95 23495.47,-555.95 23502.47,-555.95"/>
</g>
<!-- L2_S0_TP6_GPU6_expert0&#45;&gt;L2_S0_TP5_GPU5_moe_ar -->
<g id="edge786" class="edge">
<title>L2_S0_TP6_GPU6_expert0&#45;&gt;L2_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M24814.11,-604.36C24814.11,-588.89 24814.11,-574 24814.11,-574 24814.11,-574 24067.68,-574 24067.68,-574 24067.68,-574 24067.68,-572.37 24067.68,-572.37"/>
<polygon fill="black" stroke="black" points="24071.18,-572.37 24067.68,-562.37 24064.18,-572.37 24071.18,-572.37"/>
</g>
<!-- L2_S0_TP6_GPU6_expert0&#45;&gt;L2_S0_TP6_GPU6_moe_ar -->
<g id="edge822" class="edge">
<title>L2_S0_TP6_GPU6_expert0&#45;&gt;L2_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M24835.98,-604.34C24835.98,-604.34 24835.98,-562.87 24835.98,-562.87"/>
<polygon fill="black" stroke="black" points="24839.48,-562.87 24835.98,-552.87 24832.48,-562.87 24839.48,-562.87"/>
</g>
<!-- L2_S0_TP6_GPU6_expert0&#45;&gt;L2_S0_TP7_GPU7_moe_ar -->
<g id="edge858" class="edge">
<title>L2_S0_TP6_GPU6_expert0&#45;&gt;L2_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M25169.06,-604.34C25169.06,-604.34 25169.06,-576.36 25169.06,-576.36"/>
<polygon fill="black" stroke="black" points="25172.56,-576.36 25169.06,-566.36 25165.56,-576.36 25172.56,-576.36"/>
</g>
<!-- L2_S0_TP6_GPU6_expert1 -->
<g id="node239" class="node">
<title>L2_S0_TP6_GPU6_expert1</title>
<polygon fill="none" stroke="black" points="25664.5,-672.5 25215.5,-672.5 25215.5,-604.5 25664.5,-604.5 25664.5,-672.5"/>
<text text-anchor="middle" x="25440" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="25440" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="25440" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="25440" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L2_S0_TP6_GPU6_expert1&#45;&gt;L2_S0_TP0_GPU0_moe_ar -->
<g id="edge607" class="edge">
<title>L2_S0_TP6_GPU6_expert1&#45;&gt;L2_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M25271.92,-604.32C25271.92,-589.73 25271.92,-576 25271.92,-576 25271.92,-576 20731.65,-576 20731.65,-576 20731.65,-576 20731.65,-559.84 20731.65,-559.84"/>
<polygon fill="black" stroke="black" points="20735.15,-559.84 20731.65,-549.84 20728.15,-559.84 20735.15,-559.84"/>
</g>
<!-- L2_S0_TP6_GPU6_expert1&#45;&gt;L2_S0_TP1_GPU1_moe_ar -->
<g id="edge643" class="edge">
<title>L2_S0_TP6_GPU6_expert1&#45;&gt;L2_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M25328.35,-604.32C25328.35,-589.73 25328.35,-576 25328.35,-576 25328.35,-576 20907.02,-576 20907.02,-576 20907.02,-576 20907.02,-563.07 20907.02,-563.07"/>
<polygon fill="black" stroke="black" points="20910.52,-563.07 20907.02,-553.07 20903.52,-563.07 20910.52,-563.07"/>
</g>
<!-- L2_S0_TP6_GPU6_expert1&#45;&gt;L2_S0_TP2_GPU2_moe_ar -->
<g id="edge679" class="edge">
<title>L2_S0_TP6_GPU6_expert1&#45;&gt;L2_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M25646.49,-604.35C25646.49,-548.8 25646.49,-445 25646.49,-445 25646.49,-445 22056.48,-445 22056.48,-445 22056.48,-445 22056.48,-473.59 22056.48,-473.59"/>
<polygon fill="black" stroke="black" points="22052.98,-473.59 22056.48,-483.59 22059.98,-473.59 22052.98,-473.59"/>
</g>
<!-- L2_S0_TP6_GPU6_expert1&#45;&gt;L2_S0_TP3_GPU3_moe_ar -->
<g id="edge715" class="edge">
<title>L2_S0_TP6_GPU6_expert1&#45;&gt;L2_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M25628.47,-604.35C25628.47,-548.8 25628.47,-445 25628.47,-445 25628.47,-445 22796.68,-445 22796.68,-445 22796.68,-445 22796.68,-481.47 22796.68,-481.47"/>
<polygon fill="black" stroke="black" points="22793.18,-481.47 22796.68,-491.47 22800.18,-481.47 22793.18,-481.47"/>
</g>
<!-- L2_S0_TP6_GPU6_expert1&#45;&gt;L2_S0_TP4_GPU4_moe_ar -->
<g id="edge751" class="edge">
<title>L2_S0_TP6_GPU6_expert1&#45;&gt;L2_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M25384.77,-604.36C25384.77,-588.89 25384.77,-574 25384.77,-574 25384.77,-574 23524.22,-574 23524.22,-574 23524.22,-574 23524.22,-548.86 23524.22,-548.86"/>
<polygon fill="black" stroke="black" points="23527.72,-548.86 23524.22,-538.86 23520.72,-548.86 23527.72,-548.86"/>
</g>
<!-- L2_S0_TP6_GPU6_expert1&#45;&gt;L2_S0_TP5_GPU5_moe_ar -->
<g id="edge787" class="edge">
<title>L2_S0_TP6_GPU6_expert1&#45;&gt;L2_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M25441.19,-604.36C25441.19,-588.89 25441.19,-574 25441.19,-574 25441.19,-574 24109.87,-574 24109.87,-574 24109.87,-574 24109.87,-568.21 24109.87,-568.21"/>
<polygon fill="black" stroke="black" points="24113.37,-568.21 24109.87,-558.21 24106.37,-568.21 24113.37,-568.21"/>
</g>
<!-- L2_S0_TP6_GPU6_expert1&#45;&gt;L2_S0_TP6_GPU6_moe_ar -->
<g id="edge823" class="edge">
<title>L2_S0_TP6_GPU6_expert1&#45;&gt;L2_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M25497.62,-604.36C25497.62,-588.89 25497.62,-574 25497.62,-574 25497.62,-574 24857.85,-574 24857.85,-574 24857.85,-574 24857.85,-559.09 24857.85,-559.09"/>
<polygon fill="black" stroke="black" points="24861.35,-559.09 24857.85,-549.09 24854.35,-559.09 24861.35,-559.09"/>
</g>
<!-- L2_S0_TP6_GPU6_expert1&#45;&gt;L2_S0_TP7_GPU7_moe_ar -->
<g id="edge859" class="edge">
<title>L2_S0_TP6_GPU6_expert1&#45;&gt;L2_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M25554.04,-604.34C25554.04,-604.34 25554.04,-557.38 25554.04,-557.38"/>
<polygon fill="black" stroke="black" points="25557.54,-557.38 25554.04,-547.38 25550.54,-557.38 25557.54,-557.38"/>
</g>
<!-- L2_S0_TP7_GPU7_expert0 -->
<g id="node240" class="node">
<title>L2_S0_TP7_GPU7_expert0</title>
<polygon fill="none" stroke="black" points="26131.5,-672.5 25682.5,-672.5 25682.5,-604.5 26131.5,-604.5 26131.5,-672.5"/>
<text text-anchor="middle" x="25907" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="25907" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="25907" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="25907" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L2_S0_TP7_GPU7_expert0&#45;&gt;L2_S0_TP0_GPU0_moe_ar -->
<g id="edge608" class="edge">
<title>L2_S0_TP7_GPU7_expert0&#45;&gt;L2_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M25732.39,-604.32C25732.39,-589.73 25732.39,-576 25732.39,-576 25732.39,-576 20754.92,-576 20754.92,-576 20754.92,-576 20754.92,-554.96 20754.92,-554.96"/>
<polygon fill="black" stroke="black" points="20758.42,-554.96 20754.92,-544.96 20751.42,-554.96 20758.42,-554.96"/>
</g>
<!-- L2_S0_TP7_GPU7_expert0&#45;&gt;L2_S0_TP1_GPU1_moe_ar -->
<g id="edge644" class="edge">
<title>L2_S0_TP7_GPU7_expert0&#45;&gt;L2_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M26081.61,-604.17C26081.61,-548.34 26081.61,-444 26081.61,-444 26081.61,-444 21301.64,-444 21301.64,-444 21301.64,-444 21301.64,-466.85 21301.64,-466.85"/>
<polygon fill="black" stroke="black" points="21298.14,-466.85 21301.64,-476.85 21305.14,-466.85 21298.14,-466.85"/>
</g>
<!-- L2_S0_TP7_GPU7_expert0&#45;&gt;L2_S0_TP2_GPU2_moe_ar -->
<g id="edge680" class="edge">
<title>L2_S0_TP7_GPU7_expert0&#45;&gt;L2_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M26031.72,-604.17C26031.72,-548.34 26031.72,-444 26031.72,-444 26031.72,-444 21996.98,-444 21996.98,-444 21996.98,-444 21996.98,-467.74 21996.98,-467.74"/>
<polygon fill="black" stroke="black" points="21993.48,-467.74 21996.98,-477.74 22000.48,-467.74 21993.48,-467.74"/>
</g>
<!-- L2_S0_TP7_GPU7_expert0&#45;&gt;L2_S0_TP3_GPU3_moe_ar -->
<g id="edge716" class="edge">
<title>L2_S0_TP7_GPU7_expert0&#45;&gt;L2_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M25981.83,-604.17C25981.83,-548.34 25981.83,-444 25981.83,-444 25981.83,-444 22763.78,-444 22763.78,-444 22763.78,-444 22763.78,-476.23 22763.78,-476.23"/>
<polygon fill="black" stroke="black" points="22760.28,-476.23 22763.78,-486.23 22767.28,-476.23 22760.28,-476.23"/>
</g>
<!-- L2_S0_TP7_GPU7_expert0&#45;&gt;L2_S0_TP4_GPU4_moe_ar -->
<g id="edge752" class="edge">
<title>L2_S0_TP7_GPU7_expert0&#45;&gt;L2_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M25931.94,-604.47C25931.94,-553.18 25931.94,-462 25931.94,-462 25931.94,-462 23528.85,-462 23528.85,-462 23528.85,-462 23528.85,-493.52 23528.85,-493.52"/>
<polygon fill="black" stroke="black" points="23525.35,-493.52 23528.85,-503.52 23532.35,-493.52 23525.35,-493.52"/>
</g>
<!-- L2_S0_TP7_GPU7_expert0&#45;&gt;L2_S0_TP5_GPU5_moe_ar -->
<g id="edge788" class="edge">
<title>L2_S0_TP7_GPU7_expert0&#45;&gt;L2_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M25782.28,-604.36C25782.28,-588.89 25782.28,-574 25782.28,-574 25782.28,-574 24152.07,-574 24152.07,-574 24152.07,-574 24152.07,-562.51 24152.07,-562.51"/>
<polygon fill="black" stroke="black" points="24155.57,-562.51 24152.07,-552.51 24148.57,-562.51 24155.57,-562.51"/>
</g>
<!-- L2_S0_TP7_GPU7_expert0&#45;&gt;L2_S0_TP6_GPU6_moe_ar -->
<g id="edge824" class="edge">
<title>L2_S0_TP7_GPU7_expert0&#45;&gt;L2_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M25832.17,-604.36C25832.17,-588.89 25832.17,-574 25832.17,-574 25832.17,-574 24879.72,-574 24879.72,-574 24879.72,-574 24879.72,-554.39 24879.72,-554.39"/>
<polygon fill="black" stroke="black" points="24883.22,-554.39 24879.72,-544.39 24876.22,-554.39 24883.22,-554.39"/>
</g>
<!-- L2_S0_TP7_GPU7_expert0&#45;&gt;L2_S0_TP7_GPU7_moe_ar -->
<g id="edge860" class="edge">
<title>L2_S0_TP7_GPU7_expert0&#45;&gt;L2_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M25882.06,-604.13C25882.06,-580.74 25882.06,-554 25882.06,-554 25882.06,-554 25525.53,-554 25525.53,-554"/>
<polygon fill="black" stroke="black" points="25525.53,-550.5 25515.53,-554 25525.53,-557.5 25525.53,-550.5"/>
</g>
<!-- L2_S0_TP7_GPU7_expert1 -->
<g id="node241" class="node">
<title>L2_S0_TP7_GPU7_expert1</title>
<polygon fill="none" stroke="black" points="26598.5,-672.5 26149.5,-672.5 26149.5,-604.5 26598.5,-604.5 26598.5,-672.5"/>
<text text-anchor="middle" x="26374" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="26374" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="26374" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="26374" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L2_S0_TP7_GPU7_expert1&#45;&gt;L2_S0_TP0_GPU0_moe_ar -->
<g id="edge609" class="edge">
<title>L2_S0_TP7_GPU7_expert1&#45;&gt;L2_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M26165.22,-604.32C26165.22,-589.73 26165.22,-576 26165.22,-576 26165.22,-576 20778.19,-576 20778.19,-576 20778.19,-576 20778.19,-548.31 20778.19,-548.31"/>
<polygon fill="black" stroke="black" points="20781.69,-548.31 20778.19,-538.31 20774.69,-548.31 20781.69,-548.31"/>
</g>
<!-- L2_S0_TP7_GPU7_expert1&#45;&gt;L2_S0_TP1_GPU1_moe_ar -->
<g id="edge645" class="edge">
<title>L2_S0_TP7_GPU7_expert1&#45;&gt;L2_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M26275.28,-604.17C26275.28,-548.34 26275.28,-444 26275.28,-444 26275.28,-444 21114.82,-444 21114.82,-444 21114.82,-444 21114.82,-462.45 21114.82,-462.45"/>
<polygon fill="black" stroke="black" points="21111.32,-462.45 21114.82,-472.45 21118.32,-462.45 21111.32,-462.45"/>
</g>
<!-- L2_S0_TP7_GPU7_expert1&#45;&gt;L2_S0_TP2_GPU2_moe_ar -->
<g id="edge681" class="edge">
<title>L2_S0_TP7_GPU7_expert1&#45;&gt;L2_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M26259.56,-604.17C26259.56,-548.34 26259.56,-444 26259.56,-444 26259.56,-444 21937.49,-444 21937.49,-444 21937.49,-444 21937.49,-464.2 21937.49,-464.2"/>
<polygon fill="black" stroke="black" points="21933.99,-464.2 21937.49,-474.2 21940.99,-464.2 21933.99,-464.2"/>
</g>
<!-- L2_S0_TP7_GPU7_expert1&#45;&gt;L2_S0_TP3_GPU3_moe_ar -->
<g id="edge717" class="edge">
<title>L2_S0_TP7_GPU7_expert1&#45;&gt;L2_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M26243.83,-604.17C26243.83,-548.34 26243.83,-444 26243.83,-444 26243.83,-444 22730.89,-444 22730.89,-444 22730.89,-444 22730.89,-471.76 22730.89,-471.76"/>
<polygon fill="black" stroke="black" points="22727.39,-471.76 22730.89,-481.76 22734.39,-471.76 22727.39,-471.76"/>
</g>
<!-- L2_S0_TP7_GPU7_expert1&#45;&gt;L2_S0_TP4_GPU4_moe_ar -->
<g id="edge753" class="edge">
<title>L2_S0_TP7_GPU7_expert1&#45;&gt;L2_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M26228.11,-604.47C26228.11,-553.18 26228.11,-462 26228.11,-462 26228.11,-462 23508.23,-462 23508.23,-462 23508.23,-462 23508.23,-486.99 23508.23,-486.99"/>
<polygon fill="black" stroke="black" points="23504.73,-486.99 23508.23,-496.99 23511.73,-486.99 23504.73,-486.99"/>
</g>
<!-- L2_S0_TP7_GPU7_expert1&#45;&gt;L2_S0_TP5_GPU5_moe_ar -->
<g id="edge789" class="edge">
<title>L2_S0_TP7_GPU7_expert1&#45;&gt;L2_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M26180.94,-604.36C26180.94,-588.89 26180.94,-574 26180.94,-574 26180.94,-574 24194.27,-574 24194.27,-574 24194.27,-574 24194.27,-554.07 24194.27,-554.07"/>
<polygon fill="black" stroke="black" points="24197.77,-554.07 24194.27,-544.07 24190.77,-554.07 24197.77,-554.07"/>
</g>
<!-- L2_S0_TP7_GPU7_expert1&#45;&gt;L2_S0_TP6_GPU6_moe_ar -->
<g id="edge825" class="edge">
<title>L2_S0_TP7_GPU7_expert1&#45;&gt;L2_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M26196.67,-604.36C26196.67,-588.89 26196.67,-574 26196.67,-574 26196.67,-574 24901.59,-574 24901.59,-574 24901.59,-574 24901.59,-547.67 24901.59,-547.67"/>
<polygon fill="black" stroke="black" points="24905.09,-547.67 24901.59,-537.67 24898.09,-547.67 24905.09,-547.67"/>
</g>
<!-- L2_S0_TP7_GPU7_expert1&#45;&gt;L2_S0_TP7_GPU7_moe_ar -->
<g id="edge861" class="edge">
<title>L2_S0_TP7_GPU7_expert1&#45;&gt;L2_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M26212.39,-604.4C26212.39,-576.28 26212.39,-541 26212.39,-541 26212.39,-541 25588.4,-541 25588.4,-541"/>
<polygon fill="black" stroke="black" points="25588.4,-537.5 25578.4,-541 25588.4,-544.5 25588.4,-537.5"/>
</g>
<!-- L2_S0_TP0_GPU0_norm -->
<g id="node243" class="node">
<title>L2_S0_TP0_GPU0_norm</title>
<polygon fill="none" stroke="black" points="19330.5,-332.33 18881.5,-332.33 18881.5,-264.33 19330.5,-264.33 19330.5,-332.33"/>
<text text-anchor="middle" x="19106" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="19106" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="19106" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="19106" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP0_GPU0_moe_res&#45;&gt;L2_S0_TP0_GPU0_norm -->
<g id="edge612" class="edge">
<title>L2_S0_TP0_GPU0_moe_res&#45;&gt;L2_S0_TP0_GPU0_norm</title>
<path fill="none" stroke="black" d="M19106,-368.28C19106,-368.28 19106,-342.46 19106,-342.46"/>
<polygon fill="black" stroke="black" points="19109.5,-342.46 19106,-332.46 19102.5,-342.46 19109.5,-342.46"/>
</g>
<!-- L2_S0_TP1_GPU1_qkv_linear -->
<g id="node244" class="node">
<title>L2_S0_TP1_GPU1_qkv_linear</title>
<polygon fill="none" stroke="black" points="20578,-1614.75 19970,-1614.75 19970,-1546.75 20578,-1546.75 20578,-1614.75"/>
<text text-anchor="middle" x="20274" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="20274" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="20274" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="20274" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L2_S0_TP1_GPU1_qkv_slice -->
<g id="node245" class="node">
<title>L2_S0_TP1_GPU1_qkv_slice</title>
<polygon fill="none" stroke="black" points="20572,-1496.67 19976,-1496.67 19976,-1428.67 20572,-1428.67 20572,-1496.67"/>
<text text-anchor="middle" x="20274" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="20274" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="20274" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="20274" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L2_S0_TP1_GPU1_qkv_linear&#45;&gt;L2_S0_TP1_GPU1_qkv_slice -->
<g id="edge613" class="edge">
<title>L2_S0_TP1_GPU1_qkv_linear&#45;&gt;L2_S0_TP1_GPU1_qkv_slice</title>
<path fill="none" stroke="black" d="M20274,-1546.59C20274,-1546.59 20274,-1506.74 20274,-1506.74"/>
<polygon fill="black" stroke="black" points="20277.5,-1506.74 20274,-1496.74 20270.5,-1506.74 20277.5,-1506.74"/>
</g>
<!-- L2_S0_TP1_GPU1_qkv_slice&#45;&gt;L2_S0_TP1_GPU1_attn_v -->
<g id="edge617" class="edge">
<title>L2_S0_TP1_GPU1_qkv_slice&#45;&gt;L2_S0_TP1_GPU1_attn_v</title>
<path fill="none" stroke="black" d="M20032.75,-1428.38C20032.75,-1428.38 20032.75,-1195 20032.75,-1195"/>
<polygon fill="black" stroke="black" points="20036.25,-1195 20032.75,-1185 20029.25,-1195 20036.25,-1195"/>
</g>
<!-- L2_S0_TP1_GPU1_qk_matmul -->
<g id="node246" class="node">
<title>L2_S0_TP1_GPU1_qk_matmul</title>
<polygon fill="none" stroke="black" points="20989.5,-1392.67 20054.5,-1392.67 20054.5,-1324.67 20989.5,-1324.67 20989.5,-1392.67"/>
<text text-anchor="middle" x="20522" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="20522" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="20522" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="20522" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L2_S0_TP1_GPU1_qkv_slice&#45;&gt;L2_S0_TP1_GPU1_qk_matmul -->
<g id="edge614" class="edge">
<title>L2_S0_TP1_GPU1_qkv_slice&#45;&gt;L2_S0_TP1_GPU1_qk_matmul</title>
<path fill="none" stroke="black" d="M20313.25,-1428.61C20313.25,-1428.61 20313.25,-1402.8 20313.25,-1402.8"/>
<polygon fill="black" stroke="black" points="20316.75,-1402.8 20313.25,-1392.8 20309.75,-1402.8 20316.75,-1402.8"/>
</g>
<!-- L2_S0_TP1_GPU1_softmax -->
<g id="node247" class="node">
<title>L2_S0_TP1_GPU1_softmax</title>
<polygon fill="none" stroke="black" points="20756,-1288.67 20246,-1288.67 20246,-1220.67 20756,-1220.67 20756,-1288.67"/>
<text text-anchor="middle" x="20501" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="20501" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="20501" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="20501" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L2_S0_TP1_GPU1_qk_matmul&#45;&gt;L2_S0_TP1_GPU1_softmax -->
<g id="edge615" class="edge">
<title>L2_S0_TP1_GPU1_qk_matmul&#45;&gt;L2_S0_TP1_GPU1_softmax</title>
<path fill="none" stroke="black" d="M20501,-1324.61C20501,-1324.61 20501,-1298.8 20501,-1298.8"/>
<polygon fill="black" stroke="black" points="20504.5,-1298.8 20501,-1288.8 20497.5,-1298.8 20504.5,-1298.8"/>
</g>
<!-- L2_S0_TP1_GPU1_softmax&#45;&gt;L2_S0_TP1_GPU1_attn_v -->
<g id="edge616" class="edge">
<title>L2_S0_TP1_GPU1_softmax&#45;&gt;L2_S0_TP1_GPU1_attn_v</title>
<path fill="none" stroke="black" d="M20501,-1220.61C20501,-1220.61 20501,-1194.8 20501,-1194.8"/>
<polygon fill="black" stroke="black" points="20504.5,-1194.8 20501,-1184.8 20497.5,-1194.8 20504.5,-1194.8"/>
</g>
<!-- L2_S0_TP1_GPU1_mha_res -->
<g id="node249" class="node">
<title>L2_S0_TP1_GPU1_mha_res</title>
<polygon fill="none" stroke="black" points="20619.5,-948.5 19732.5,-948.5 19732.5,-880.5 20619.5,-880.5 20619.5,-948.5"/>
<text text-anchor="middle" x="20176" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="20176" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="20176" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="20176" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP1_GPU1_mha_ar&#45;&gt;L2_S0_TP1_GPU1_mha_res -->
<g id="edge626" class="edge">
<title>L2_S0_TP1_GPU1_mha_ar&#45;&gt;L2_S0_TP1_GPU1_mha_res</title>
<path fill="none" stroke="black" d="M20596.01,-1015.66C20596.01,-1015.66 20596.01,-958.91 20596.01,-958.91"/>
<polygon fill="black" stroke="black" points="20599.51,-958.91 20596.01,-948.91 20592.51,-958.91 20599.51,-958.91"/>
</g>
<!-- L2_S0_TP1_GPU1_gate -->
<g id="node250" class="node">
<title>L2_S0_TP1_GPU1_gate</title>
<polygon fill="none" stroke="black" points="20705.56,-844.5 19863.15,-844.5 19646.44,-708.5 20488.85,-708.5 20705.56,-844.5"/>
<text text-anchor="middle" x="20176" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="20176" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="20176" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="20176" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L2_S0_TP1_GPU1_mha_res&#45;&gt;L2_S0_TP1_GPU1_gate -->
<g id="edge627" class="edge">
<title>L2_S0_TP1_GPU1_mha_res&#45;&gt;L2_S0_TP1_GPU1_gate</title>
<path fill="none" stroke="black" d="M20176,-880.39C20176,-880.39 20176,-854.73 20176,-854.73"/>
<polygon fill="black" stroke="black" points="20179.5,-854.73 20176,-844.73 20172.5,-854.73 20179.5,-854.73"/>
</g>
<!-- L2_S0_TP1_GPU1_moe_res -->
<g id="node252" class="node">
<title>L2_S0_TP1_GPU1_moe_res</title>
<polygon fill="none" stroke="black" points="20549,-436.33 19729,-436.33 19729,-368.33 20549,-368.33 20549,-436.33"/>
<text text-anchor="middle" x="20139" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="20139" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="20139" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="20139" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP1_GPU1_mha_res&#45;&gt;L2_S0_TP1_GPU1_moe_res -->
<g id="edge647" class="edge">
<title>L2_S0_TP1_GPU1_mha_res&#45;&gt;L2_S0_TP1_GPU1_moe_res</title>
<path fill="none" stroke="black" d="M19732.43,-914C19675.73,-914 19637,-914 19637,-914 19637,-914 19637,-673 19637,-673 19637,-673 20069.5,-673 20069.5,-673 20069.5,-673 20069.5,-446.34 20069.5,-446.34"/>
<polygon fill="black" stroke="black" points="20073,-446.34 20069.5,-436.34 20066,-446.34 20073,-446.34"/>
</g>
<!-- L2_S0_TP1_GPU1_gate&#45;&gt;L2_S0_TP1_GPU1_expert0 -->
<g id="edge628" class="edge">
<title>L2_S0_TP1_GPU1_gate&#45;&gt;L2_S0_TP1_GPU1_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20228.17,-708.31C20228.17,-708.31 20228.17,-682.71 20228.17,-682.71"/>
<polygon fill="black" stroke="black" points="20231.67,-682.71 20228.17,-672.71 20224.67,-682.71 20231.67,-682.71"/>
</g>
<!-- L2_S0_TP1_GPU1_gate&#45;&gt;L2_S0_TP1_GPU1_expert1 -->
<g id="edge629" class="edge">
<title>L2_S0_TP1_GPU1_gate&#45;&gt;L2_S0_TP1_GPU1_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20625.64,-776.4C20625.64,-776.4 20625.64,-682.74 20625.64,-682.74"/>
<polygon fill="black" stroke="black" points="20629.14,-682.74 20625.64,-672.74 20622.14,-682.74 20629.14,-682.74"/>
</g>
<!-- L2_S0_TP1_GPU1_moe_ar&#45;&gt;L2_S0_TP1_GPU1_moe_res -->
<g id="edge646" class="edge">
<title>L2_S0_TP1_GPU1_moe_ar&#45;&gt;L2_S0_TP1_GPU1_moe_res</title>
<path fill="none" stroke="black" d="M20873.77,-494.14C20873.77,-459.25 20873.77,-402 20873.77,-402 20873.77,-402 20559.08,-402 20559.08,-402"/>
<polygon fill="black" stroke="black" points="20559.08,-398.5 20549.08,-402 20559.08,-405.5 20559.08,-398.5"/>
</g>
<!-- L2_S0_TP1_GPU1_norm -->
<g id="node253" class="node">
<title>L2_S0_TP1_GPU1_norm</title>
<polygon fill="none" stroke="black" points="20363.5,-332.33 19914.5,-332.33 19914.5,-264.33 20363.5,-264.33 20363.5,-332.33"/>
<text text-anchor="middle" x="20139" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="20139" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="20139" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="20139" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP1_GPU1_moe_res&#45;&gt;L2_S0_TP1_GPU1_norm -->
<g id="edge648" class="edge">
<title>L2_S0_TP1_GPU1_moe_res&#45;&gt;L2_S0_TP1_GPU1_norm</title>
<path fill="none" stroke="black" d="M20139,-368.28C20139,-368.28 20139,-342.46 20139,-342.46"/>
<polygon fill="black" stroke="black" points="20142.5,-342.46 20139,-332.46 20135.5,-342.46 20142.5,-342.46"/>
</g>
<!-- L2_S0_TP2_GPU2_qkv_linear -->
<g id="node254" class="node">
<title>L2_S0_TP2_GPU2_qkv_linear</title>
<polygon fill="none" stroke="black" points="21586,-1614.75 20978,-1614.75 20978,-1546.75 21586,-1546.75 21586,-1614.75"/>
<text text-anchor="middle" x="21282" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="21282" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="21282" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="21282" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L2_S0_TP2_GPU2_qkv_slice -->
<g id="node255" class="node">
<title>L2_S0_TP2_GPU2_qkv_slice</title>
<polygon fill="none" stroke="black" points="21580,-1496.67 20984,-1496.67 20984,-1428.67 21580,-1428.67 21580,-1496.67"/>
<text text-anchor="middle" x="21282" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="21282" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="21282" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="21282" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L2_S0_TP2_GPU2_qkv_linear&#45;&gt;L2_S0_TP2_GPU2_qkv_slice -->
<g id="edge649" class="edge">
<title>L2_S0_TP2_GPU2_qkv_linear&#45;&gt;L2_S0_TP2_GPU2_qkv_slice</title>
<path fill="none" stroke="black" d="M21282,-1546.59C21282,-1546.59 21282,-1506.74 21282,-1506.74"/>
<polygon fill="black" stroke="black" points="21285.5,-1506.74 21282,-1496.74 21278.5,-1506.74 21285.5,-1506.74"/>
</g>
<!-- L2_S0_TP2_GPU2_qkv_slice&#45;&gt;L2_S0_TP2_GPU2_attn_v -->
<g id="edge653" class="edge">
<title>L2_S0_TP2_GPU2_qkv_slice&#45;&gt;L2_S0_TP2_GPU2_attn_v</title>
<path fill="none" stroke="black" d="M21026,-1428.38C21026,-1428.38 21026,-1195 21026,-1195"/>
<polygon fill="black" stroke="black" points="21029.5,-1195 21026,-1185 21022.5,-1195 21029.5,-1195"/>
</g>
<!-- L2_S0_TP2_GPU2_qk_matmul -->
<g id="node256" class="node">
<title>L2_S0_TP2_GPU2_qk_matmul</title>
<polygon fill="none" stroke="black" points="21997.5,-1392.67 21062.5,-1392.67 21062.5,-1324.67 21997.5,-1324.67 21997.5,-1392.67"/>
<text text-anchor="middle" x="21530" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="21530" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="21530" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="21530" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L2_S0_TP2_GPU2_qkv_slice&#45;&gt;L2_S0_TP2_GPU2_qk_matmul -->
<g id="edge650" class="edge">
<title>L2_S0_TP2_GPU2_qkv_slice&#45;&gt;L2_S0_TP2_GPU2_qk_matmul</title>
<path fill="none" stroke="black" d="M21321.25,-1428.61C21321.25,-1428.61 21321.25,-1402.8 21321.25,-1402.8"/>
<polygon fill="black" stroke="black" points="21324.75,-1402.8 21321.25,-1392.8 21317.75,-1402.8 21324.75,-1402.8"/>
</g>
<!-- L2_S0_TP2_GPU2_softmax -->
<g id="node257" class="node">
<title>L2_S0_TP2_GPU2_softmax</title>
<polygon fill="none" stroke="black" points="21738,-1288.67 21228,-1288.67 21228,-1220.67 21738,-1220.67 21738,-1288.67"/>
<text text-anchor="middle" x="21483" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="21483" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="21483" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="21483" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L2_S0_TP2_GPU2_qk_matmul&#45;&gt;L2_S0_TP2_GPU2_softmax -->
<g id="edge651" class="edge">
<title>L2_S0_TP2_GPU2_qk_matmul&#45;&gt;L2_S0_TP2_GPU2_softmax</title>
<path fill="none" stroke="black" d="M21483,-1324.61C21483,-1324.61 21483,-1298.8 21483,-1298.8"/>
<polygon fill="black" stroke="black" points="21486.5,-1298.8 21483,-1288.8 21479.5,-1298.8 21486.5,-1298.8"/>
</g>
<!-- L2_S0_TP2_GPU2_softmax&#45;&gt;L2_S0_TP2_GPU2_attn_v -->
<g id="edge652" class="edge">
<title>L2_S0_TP2_GPU2_softmax&#45;&gt;L2_S0_TP2_GPU2_attn_v</title>
<path fill="none" stroke="black" d="M21483,-1220.61C21483,-1220.61 21483,-1194.8 21483,-1194.8"/>
<polygon fill="black" stroke="black" points="21486.5,-1194.8 21483,-1184.8 21479.5,-1194.8 21486.5,-1194.8"/>
</g>
<!-- L2_S0_TP2_GPU2_mha_res -->
<g id="node259" class="node">
<title>L2_S0_TP2_GPU2_mha_res</title>
<polygon fill="none" stroke="black" points="21697.5,-948.5 20810.5,-948.5 20810.5,-880.5 21697.5,-880.5 21697.5,-948.5"/>
<text text-anchor="middle" x="21254" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="21254" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="21254" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="21254" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP2_GPU2_mha_ar&#45;&gt;L2_S0_TP2_GPU2_mha_res -->
<g id="edge662" class="edge">
<title>L2_S0_TP2_GPU2_mha_ar&#45;&gt;L2_S0_TP2_GPU2_mha_res</title>
<path fill="none" stroke="black" d="M21519.51,-991.61C21519.51,-991.61 21519.51,-958.74 21519.51,-958.74"/>
<polygon fill="black" stroke="black" points="21523.01,-958.74 21519.51,-948.74 21516.01,-958.74 21523.01,-958.74"/>
</g>
<!-- L2_S0_TP2_GPU2_gate -->
<g id="node260" class="node">
<title>L2_S0_TP2_GPU2_gate</title>
<polygon fill="none" stroke="black" points="21783.56,-844.5 20941.15,-844.5 20724.44,-708.5 21566.85,-708.5 21783.56,-844.5"/>
<text text-anchor="middle" x="21254" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="21254" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="21254" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="21254" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L2_S0_TP2_GPU2_mha_res&#45;&gt;L2_S0_TP2_GPU2_gate -->
<g id="edge663" class="edge">
<title>L2_S0_TP2_GPU2_mha_res&#45;&gt;L2_S0_TP2_GPU2_gate</title>
<path fill="none" stroke="black" d="M21254,-880.39C21254,-880.39 21254,-854.73 21254,-854.73"/>
<polygon fill="black" stroke="black" points="21257.5,-854.73 21254,-844.73 21250.5,-854.73 21257.5,-854.73"/>
</g>
<!-- L2_S0_TP2_GPU2_moe_res -->
<g id="node262" class="node">
<title>L2_S0_TP2_GPU2_moe_res</title>
<polygon fill="none" stroke="black" points="21748,-436.33 20928,-436.33 20928,-368.33 21748,-368.33 21748,-436.33"/>
<text text-anchor="middle" x="21338" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="21338" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="21338" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="21338" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP2_GPU2_mha_res&#45;&gt;L2_S0_TP2_GPU2_moe_res -->
<g id="edge683" class="edge">
<title>L2_S0_TP2_GPU2_mha_res&#45;&gt;L2_S0_TP2_GPU2_moe_res</title>
<path fill="none" stroke="black" d="M21697.57,-914C21754.27,-914 21793,-914 21793,-914 21793,-914 21793,-675 21793,-675 21793,-675 21471.79,-675 21471.79,-675 21471.79,-675 21471.79,-576 21471.79,-576 21471.79,-576 21500.51,-576 21500.51,-576 21500.51,-576 21500.51,-446.64 21500.51,-446.64"/>
<polygon fill="black" stroke="black" points="21504.01,-446.64 21500.51,-436.64 21497.01,-446.64 21504.01,-446.64"/>
</g>
<!-- L2_S0_TP2_GPU2_gate&#45;&gt;L2_S0_TP2_GPU2_expert0 -->
<g id="edge664" class="edge">
<title>L2_S0_TP2_GPU2_gate&#45;&gt;L2_S0_TP2_GPU2_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M21124.75,-708.31C21124.75,-708.31 21124.75,-682.71 21124.75,-682.71"/>
<polygon fill="black" stroke="black" points="21128.25,-682.71 21124.75,-672.71 21121.25,-682.71 21128.25,-682.71"/>
</g>
<!-- L2_S0_TP2_GPU2_gate&#45;&gt;L2_S0_TP2_GPU2_expert1 -->
<g id="edge665" class="edge">
<title>L2_S0_TP2_GPU2_gate&#45;&gt;L2_S0_TP2_GPU2_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M21631.64,-748.9C21631.64,-748.9 21631.64,-682.65 21631.64,-682.65"/>
<polygon fill="black" stroke="black" points="21635.14,-682.65 21631.64,-672.65 21628.14,-682.65 21635.14,-682.65"/>
</g>
<!-- L2_S0_TP2_GPU2_moe_ar&#45;&gt;L2_S0_TP2_GPU2_moe_res -->
<g id="edge682" class="edge">
<title>L2_S0_TP2_GPU2_moe_ar&#45;&gt;L2_S0_TP2_GPU2_moe_res</title>
<path fill="none" stroke="black" d="M21667.51,-479.12C21667.51,-479.12 21667.51,-446.38 21667.51,-446.38"/>
<polygon fill="black" stroke="black" points="21671.01,-446.38 21667.51,-436.38 21664.01,-446.38 21671.01,-446.38"/>
</g>
<!-- L2_S0_TP2_GPU2_norm -->
<g id="node263" class="node">
<title>L2_S0_TP2_GPU2_norm</title>
<polygon fill="none" stroke="black" points="21562.5,-332.33 21113.5,-332.33 21113.5,-264.33 21562.5,-264.33 21562.5,-332.33"/>
<text text-anchor="middle" x="21338" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="21338" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="21338" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="21338" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP2_GPU2_moe_res&#45;&gt;L2_S0_TP2_GPU2_norm -->
<g id="edge684" class="edge">
<title>L2_S0_TP2_GPU2_moe_res&#45;&gt;L2_S0_TP2_GPU2_norm</title>
<path fill="none" stroke="black" d="M21338,-368.28C21338,-368.28 21338,-342.46 21338,-342.46"/>
<polygon fill="black" stroke="black" points="21341.5,-342.46 21338,-332.46 21334.5,-342.46 21341.5,-342.46"/>
</g>
<!-- L2_S0_TP3_GPU3_qkv_linear -->
<g id="node264" class="node">
<title>L2_S0_TP3_GPU3_qkv_linear</title>
<polygon fill="none" stroke="black" points="22578,-1614.75 21970,-1614.75 21970,-1546.75 22578,-1546.75 22578,-1614.75"/>
<text text-anchor="middle" x="22274" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="22274" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="22274" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="22274" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L2_S0_TP3_GPU3_qkv_slice -->
<g id="node265" class="node">
<title>L2_S0_TP3_GPU3_qkv_slice</title>
<polygon fill="none" stroke="black" points="22572,-1496.67 21976,-1496.67 21976,-1428.67 22572,-1428.67 22572,-1496.67"/>
<text text-anchor="middle" x="22274" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="22274" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="22274" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="22274" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L2_S0_TP3_GPU3_qkv_linear&#45;&gt;L2_S0_TP3_GPU3_qkv_slice -->
<g id="edge685" class="edge">
<title>L2_S0_TP3_GPU3_qkv_linear&#45;&gt;L2_S0_TP3_GPU3_qkv_slice</title>
<path fill="none" stroke="black" d="M22274,-1546.59C22274,-1546.59 22274,-1506.74 22274,-1506.74"/>
<polygon fill="black" stroke="black" points="22277.5,-1506.74 22274,-1496.74 22270.5,-1506.74 22277.5,-1506.74"/>
</g>
<!-- L2_S0_TP3_GPU3_qkv_slice&#45;&gt;L2_S0_TP3_GPU3_attn_v -->
<g id="edge689" class="edge">
<title>L2_S0_TP3_GPU3_qkv_slice&#45;&gt;L2_S0_TP3_GPU3_attn_v</title>
<path fill="none" stroke="black" d="M22026,-1428.38C22026,-1428.38 22026,-1195 22026,-1195"/>
<polygon fill="black" stroke="black" points="22029.5,-1195 22026,-1185 22022.5,-1195 22029.5,-1195"/>
</g>
<!-- L2_S0_TP3_GPU3_qk_matmul -->
<g id="node266" class="node">
<title>L2_S0_TP3_GPU3_qk_matmul</title>
<polygon fill="none" stroke="black" points="22989.5,-1392.67 22054.5,-1392.67 22054.5,-1324.67 22989.5,-1324.67 22989.5,-1392.67"/>
<text text-anchor="middle" x="22522" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="22522" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="22522" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="22522" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L2_S0_TP3_GPU3_qkv_slice&#45;&gt;L2_S0_TP3_GPU3_qk_matmul -->
<g id="edge686" class="edge">
<title>L2_S0_TP3_GPU3_qkv_slice&#45;&gt;L2_S0_TP3_GPU3_qk_matmul</title>
<path fill="none" stroke="black" d="M22313.25,-1428.61C22313.25,-1428.61 22313.25,-1402.8 22313.25,-1402.8"/>
<polygon fill="black" stroke="black" points="22316.75,-1402.8 22313.25,-1392.8 22309.75,-1402.8 22316.75,-1402.8"/>
</g>
<!-- L2_S0_TP3_GPU3_softmax -->
<g id="node267" class="node">
<title>L2_S0_TP3_GPU3_softmax</title>
<polygon fill="none" stroke="black" points="22712,-1288.67 22202,-1288.67 22202,-1220.67 22712,-1220.67 22712,-1288.67"/>
<text text-anchor="middle" x="22457" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="22457" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="22457" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="22457" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L2_S0_TP3_GPU3_qk_matmul&#45;&gt;L2_S0_TP3_GPU3_softmax -->
<g id="edge687" class="edge">
<title>L2_S0_TP3_GPU3_qk_matmul&#45;&gt;L2_S0_TP3_GPU3_softmax</title>
<path fill="none" stroke="black" d="M22457,-1324.61C22457,-1324.61 22457,-1298.8 22457,-1298.8"/>
<polygon fill="black" stroke="black" points="22460.5,-1298.8 22457,-1288.8 22453.5,-1298.8 22460.5,-1298.8"/>
</g>
<!-- L2_S0_TP3_GPU3_softmax&#45;&gt;L2_S0_TP3_GPU3_attn_v -->
<g id="edge688" class="edge">
<title>L2_S0_TP3_GPU3_softmax&#45;&gt;L2_S0_TP3_GPU3_attn_v</title>
<path fill="none" stroke="black" d="M22457,-1220.61C22457,-1220.61 22457,-1194.8 22457,-1194.8"/>
<polygon fill="black" stroke="black" points="22460.5,-1194.8 22457,-1184.8 22453.5,-1194.8 22460.5,-1194.8"/>
</g>
<!-- L2_S0_TP3_GPU3_mha_res -->
<g id="node269" class="node">
<title>L2_S0_TP3_GPU3_mha_res</title>
<polygon fill="none" stroke="black" points="22775.5,-948.5 21888.5,-948.5 21888.5,-880.5 22775.5,-880.5 22775.5,-948.5"/>
<text text-anchor="middle" x="22332" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="22332" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="22332" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="22332" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP3_GPU3_mha_ar&#45;&gt;L2_S0_TP3_GPU3_mha_res -->
<g id="edge698" class="edge">
<title>L2_S0_TP3_GPU3_mha_ar&#45;&gt;L2_S0_TP3_GPU3_mha_res</title>
<path fill="none" stroke="black" d="M22443.01,-984.55C22443.01,-984.55 22443.01,-958.73 22443.01,-958.73"/>
<polygon fill="black" stroke="black" points="22446.51,-958.73 22443.01,-948.73 22439.51,-958.73 22446.51,-958.73"/>
</g>
<!-- L2_S0_TP3_GPU3_gate -->
<g id="node270" class="node">
<title>L2_S0_TP3_GPU3_gate</title>
<polygon fill="none" stroke="black" points="22861.56,-844.5 22019.15,-844.5 21802.44,-708.5 22644.85,-708.5 22861.56,-844.5"/>
<text text-anchor="middle" x="22332" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="22332" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="22332" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="22332" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L2_S0_TP3_GPU3_mha_res&#45;&gt;L2_S0_TP3_GPU3_gate -->
<g id="edge699" class="edge">
<title>L2_S0_TP3_GPU3_mha_res&#45;&gt;L2_S0_TP3_GPU3_gate</title>
<path fill="none" stroke="black" d="M22332,-880.39C22332,-880.39 22332,-854.73 22332,-854.73"/>
<polygon fill="black" stroke="black" points="22335.5,-854.73 22332,-844.73 22328.5,-854.73 22335.5,-854.73"/>
</g>
<!-- L2_S0_TP3_GPU3_moe_res -->
<g id="node272" class="node">
<title>L2_S0_TP3_GPU3_moe_res</title>
<polygon fill="none" stroke="black" points="22698,-436.33 21878,-436.33 21878,-368.33 22698,-368.33 22698,-436.33"/>
<text text-anchor="middle" x="22288" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="22288" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="22288" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="22288" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP3_GPU3_mha_res&#45;&gt;L2_S0_TP3_GPU3_moe_res -->
<g id="edge719" class="edge">
<title>L2_S0_TP3_GPU3_mha_res&#45;&gt;L2_S0_TP3_GPU3_moe_res</title>
<path fill="none" stroke="black" d="M22775.77,-903C22834.17,-903 22874.29,-903 22874.29,-903 22874.29,-903 22874.29,-390 22874.29,-390 22874.29,-390 22708.38,-390 22708.38,-390"/>
<polygon fill="black" stroke="black" points="22708.38,-386.5 22698.38,-390 22708.38,-393.5 22708.38,-386.5"/>
</g>
<!-- L2_S0_TP3_GPU3_gate&#45;&gt;L2_S0_TP3_GPU3_expert0 -->
<g id="edge700" class="edge">
<title>L2_S0_TP3_GPU3_gate&#45;&gt;L2_S0_TP3_GPU3_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22096.17,-708.31C22096.17,-708.31 22096.17,-682.71 22096.17,-682.71"/>
<polygon fill="black" stroke="black" points="22099.67,-682.71 22096.17,-672.71 22092.67,-682.71 22099.67,-682.71"/>
</g>
<!-- L2_S0_TP3_GPU3_gate&#45;&gt;L2_S0_TP3_GPU3_expert1 -->
<g id="edge701" class="edge">
<title>L2_S0_TP3_GPU3_gate&#45;&gt;L2_S0_TP3_GPU3_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22525.57,-708.31C22525.57,-708.31 22525.57,-682.71 22525.57,-682.71"/>
<polygon fill="black" stroke="black" points="22529.07,-682.71 22525.57,-672.71 22522.07,-682.71 22529.07,-682.71"/>
</g>
<!-- L2_S0_TP3_GPU3_moe_ar&#45;&gt;L2_S0_TP3_GPU3_moe_res -->
<g id="edge718" class="edge">
<title>L2_S0_TP3_GPU3_moe_ar&#45;&gt;L2_S0_TP3_GPU3_moe_res</title>
<path fill="none" stroke="black" d="M22529.85,-472.05C22529.85,-472.05 22529.85,-446.37 22529.85,-446.37"/>
<polygon fill="black" stroke="black" points="22533.35,-446.37 22529.85,-436.37 22526.35,-446.37 22533.35,-446.37"/>
</g>
<!-- L2_S0_TP3_GPU3_norm -->
<g id="node273" class="node">
<title>L2_S0_TP3_GPU3_norm</title>
<polygon fill="none" stroke="black" points="22512.5,-332.33 22063.5,-332.33 22063.5,-264.33 22512.5,-264.33 22512.5,-332.33"/>
<text text-anchor="middle" x="22288" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="22288" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="22288" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="22288" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP3_GPU3_moe_res&#45;&gt;L2_S0_TP3_GPU3_norm -->
<g id="edge720" class="edge">
<title>L2_S0_TP3_GPU3_moe_res&#45;&gt;L2_S0_TP3_GPU3_norm</title>
<path fill="none" stroke="black" d="M22288,-368.28C22288,-368.28 22288,-342.46 22288,-342.46"/>
<polygon fill="black" stroke="black" points="22291.5,-342.46 22288,-332.46 22284.5,-342.46 22291.5,-342.46"/>
</g>
<!-- L2_S0_TP4_GPU4_qkv_linear -->
<g id="node274" class="node">
<title>L2_S0_TP4_GPU4_qkv_linear</title>
<polygon fill="none" stroke="black" points="23572,-1614.75 22964,-1614.75 22964,-1546.75 23572,-1546.75 23572,-1614.75"/>
<text text-anchor="middle" x="23268" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="23268" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="23268" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="23268" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L2_S0_TP4_GPU4_qkv_slice -->
<g id="node275" class="node">
<title>L2_S0_TP4_GPU4_qkv_slice</title>
<polygon fill="none" stroke="black" points="23566,-1496.67 22970,-1496.67 22970,-1428.67 23566,-1428.67 23566,-1496.67"/>
<text text-anchor="middle" x="23268" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="23268" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="23268" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="23268" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L2_S0_TP4_GPU4_qkv_linear&#45;&gt;L2_S0_TP4_GPU4_qkv_slice -->
<g id="edge721" class="edge">
<title>L2_S0_TP4_GPU4_qkv_linear&#45;&gt;L2_S0_TP4_GPU4_qkv_slice</title>
<path fill="none" stroke="black" d="M23268,-1546.59C23268,-1546.59 23268,-1506.74 23268,-1506.74"/>
<polygon fill="black" stroke="black" points="23271.5,-1506.74 23268,-1496.74 23264.5,-1506.74 23271.5,-1506.74"/>
</g>
<!-- L2_S0_TP4_GPU4_qkv_slice&#45;&gt;L2_S0_TP4_GPU4_attn_v -->
<g id="edge725" class="edge">
<title>L2_S0_TP4_GPU4_qkv_slice&#45;&gt;L2_S0_TP4_GPU4_attn_v</title>
<path fill="none" stroke="black" d="M23019,-1428.38C23019,-1428.38 23019,-1195 23019,-1195"/>
<polygon fill="black" stroke="black" points="23022.5,-1195 23019,-1185 23015.5,-1195 23022.5,-1195"/>
</g>
<!-- L2_S0_TP4_GPU4_qk_matmul -->
<g id="node276" class="node">
<title>L2_S0_TP4_GPU4_qk_matmul</title>
<polygon fill="none" stroke="black" points="23983.5,-1392.67 23048.5,-1392.67 23048.5,-1324.67 23983.5,-1324.67 23983.5,-1392.67"/>
<text text-anchor="middle" x="23516" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="23516" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="23516" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="23516" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L2_S0_TP4_GPU4_qkv_slice&#45;&gt;L2_S0_TP4_GPU4_qk_matmul -->
<g id="edge722" class="edge">
<title>L2_S0_TP4_GPU4_qkv_slice&#45;&gt;L2_S0_TP4_GPU4_qk_matmul</title>
<path fill="none" stroke="black" d="M23307.25,-1428.61C23307.25,-1428.61 23307.25,-1402.8 23307.25,-1402.8"/>
<polygon fill="black" stroke="black" points="23310.75,-1402.8 23307.25,-1392.8 23303.75,-1402.8 23310.75,-1402.8"/>
</g>
<!-- L2_S0_TP4_GPU4_softmax -->
<g id="node277" class="node">
<title>L2_S0_TP4_GPU4_softmax</title>
<polygon fill="none" stroke="black" points="23687,-1288.67 23177,-1288.67 23177,-1220.67 23687,-1220.67 23687,-1288.67"/>
<text text-anchor="middle" x="23432" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="23432" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="23432" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="23432" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L2_S0_TP4_GPU4_qk_matmul&#45;&gt;L2_S0_TP4_GPU4_softmax -->
<g id="edge723" class="edge">
<title>L2_S0_TP4_GPU4_qk_matmul&#45;&gt;L2_S0_TP4_GPU4_softmax</title>
<path fill="none" stroke="black" d="M23432,-1324.61C23432,-1324.61 23432,-1298.8 23432,-1298.8"/>
<polygon fill="black" stroke="black" points="23435.5,-1298.8 23432,-1288.8 23428.5,-1298.8 23435.5,-1298.8"/>
</g>
<!-- L2_S0_TP4_GPU4_softmax&#45;&gt;L2_S0_TP4_GPU4_attn_v -->
<g id="edge724" class="edge">
<title>L2_S0_TP4_GPU4_softmax&#45;&gt;L2_S0_TP4_GPU4_attn_v</title>
<path fill="none" stroke="black" d="M23432,-1220.61C23432,-1220.61 23432,-1194.8 23432,-1194.8"/>
<polygon fill="black" stroke="black" points="23435.5,-1194.8 23432,-1184.8 23428.5,-1194.8 23435.5,-1194.8"/>
</g>
<!-- L2_S0_TP4_GPU4_mha_res -->
<g id="node279" class="node">
<title>L2_S0_TP4_GPU4_mha_res</title>
<polygon fill="none" stroke="black" points="23853.5,-948.5 22966.5,-948.5 22966.5,-880.5 23853.5,-880.5 23853.5,-948.5"/>
<text text-anchor="middle" x="23410" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="23410" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="23410" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="23410" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP4_GPU4_mha_ar&#45;&gt;L2_S0_TP4_GPU4_mha_res -->
<g id="edge734" class="edge">
<title>L2_S0_TP4_GPU4_mha_ar&#45;&gt;L2_S0_TP4_GPU4_mha_res</title>
<path fill="none" stroke="black" d="M23298.49,-984.55C23298.49,-984.55 23298.49,-958.73 23298.49,-958.73"/>
<polygon fill="black" stroke="black" points="23301.99,-958.73 23298.49,-948.73 23294.99,-958.73 23301.99,-958.73"/>
</g>
<!-- L2_S0_TP4_GPU4_gate -->
<g id="node280" class="node">
<title>L2_S0_TP4_GPU4_gate</title>
<polygon fill="none" stroke="black" points="23939.56,-844.5 23097.15,-844.5 22880.44,-708.5 23722.85,-708.5 23939.56,-844.5"/>
<text text-anchor="middle" x="23410" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="23410" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="23410" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="23410" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L2_S0_TP4_GPU4_mha_res&#45;&gt;L2_S0_TP4_GPU4_gate -->
<g id="edge735" class="edge">
<title>L2_S0_TP4_GPU4_mha_res&#45;&gt;L2_S0_TP4_GPU4_gate</title>
<path fill="none" stroke="black" d="M23410,-880.39C23410,-880.39 23410,-854.73 23410,-854.73"/>
<polygon fill="black" stroke="black" points="23413.5,-854.73 23410,-844.73 23406.5,-854.73 23413.5,-854.73"/>
</g>
<!-- L2_S0_TP4_GPU4_moe_res -->
<g id="node282" class="node">
<title>L2_S0_TP4_GPU4_moe_res</title>
<polygon fill="none" stroke="black" points="24287,-436.33 23467,-436.33 23467,-368.33 24287,-368.33 24287,-436.33"/>
<text text-anchor="middle" x="23877" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="23877" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="23877" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="23877" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP4_GPU4_mha_res&#45;&gt;L2_S0_TP4_GPU4_moe_res -->
<g id="edge755" class="edge">
<title>L2_S0_TP4_GPU4_mha_res&#45;&gt;L2_S0_TP4_GPU4_moe_res</title>
<path fill="none" stroke="black" d="M22966.22,-925C22912.77,-925 22876.64,-925 22876.64,-925 22876.64,-925 22876.64,-413 22876.64,-413 22876.64,-413 23456.87,-413 23456.87,-413"/>
<polygon fill="black" stroke="black" points="23456.87,-416.5 23466.87,-413 23456.87,-409.5 23456.87,-416.5"/>
</g>
<!-- L2_S0_TP4_GPU4_gate&#45;&gt;L2_S0_TP4_GPU4_expert0 -->
<g id="edge736" class="edge">
<title>L2_S0_TP4_GPU4_gate&#45;&gt;L2_S0_TP4_GPU4_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23217.25,-708.31C23217.25,-708.31 23217.25,-682.71 23217.25,-682.71"/>
<polygon fill="black" stroke="black" points="23220.75,-682.71 23217.25,-672.71 23213.75,-682.71 23220.75,-682.71"/>
</g>
<!-- L2_S0_TP4_GPU4_gate&#45;&gt;L2_S0_TP4_GPU4_expert1 -->
<g id="edge737" class="edge">
<title>L2_S0_TP4_GPU4_gate&#45;&gt;L2_S0_TP4_GPU4_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23646.83,-708.31C23646.83,-708.31 23646.83,-682.71 23646.83,-682.71"/>
<polygon fill="black" stroke="black" points="23650.33,-682.71 23646.83,-672.71 23643.33,-682.71 23650.33,-682.71"/>
</g>
<!-- L2_S0_TP4_GPU4_moe_ar&#45;&gt;L2_S0_TP4_GPU4_moe_res -->
<g id="edge754" class="edge">
<title>L2_S0_TP4_GPU4_moe_ar&#45;&gt;L2_S0_TP4_GPU4_moe_res</title>
<path fill="none" stroke="black" d="M23487.62,-492.43C23487.62,-492.43 23487.62,-446.44 23487.62,-446.44"/>
<polygon fill="black" stroke="black" points="23491.12,-446.44 23487.62,-436.44 23484.12,-446.44 23491.12,-446.44"/>
</g>
<!-- L2_S0_TP4_GPU4_norm -->
<g id="node283" class="node">
<title>L2_S0_TP4_GPU4_norm</title>
<polygon fill="none" stroke="black" points="24101.5,-332.33 23652.5,-332.33 23652.5,-264.33 24101.5,-264.33 24101.5,-332.33"/>
<text text-anchor="middle" x="23877" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="23877" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="23877" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="23877" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP4_GPU4_moe_res&#45;&gt;L2_S0_TP4_GPU4_norm -->
<g id="edge756" class="edge">
<title>L2_S0_TP4_GPU4_moe_res&#45;&gt;L2_S0_TP4_GPU4_norm</title>
<path fill="none" stroke="black" d="M23877,-368.28C23877,-368.28 23877,-342.46 23877,-342.46"/>
<polygon fill="black" stroke="black" points="23880.5,-342.46 23877,-332.46 23873.5,-342.46 23880.5,-342.46"/>
</g>
<!-- L2_S0_TP5_GPU5_qkv_linear -->
<g id="node284" class="node">
<title>L2_S0_TP5_GPU5_qkv_linear</title>
<polygon fill="none" stroke="black" points="24572,-1614.75 23964,-1614.75 23964,-1546.75 24572,-1546.75 24572,-1614.75"/>
<text text-anchor="middle" x="24268" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="24268" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="24268" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="24268" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L2_S0_TP5_GPU5_qkv_slice -->
<g id="node285" class="node">
<title>L2_S0_TP5_GPU5_qkv_slice</title>
<polygon fill="none" stroke="black" points="24566,-1496.67 23970,-1496.67 23970,-1428.67 24566,-1428.67 24566,-1496.67"/>
<text text-anchor="middle" x="24268" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="24268" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="24268" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="24268" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L2_S0_TP5_GPU5_qkv_linear&#45;&gt;L2_S0_TP5_GPU5_qkv_slice -->
<g id="edge757" class="edge">
<title>L2_S0_TP5_GPU5_qkv_linear&#45;&gt;L2_S0_TP5_GPU5_qkv_slice</title>
<path fill="none" stroke="black" d="M24268,-1546.59C24268,-1546.59 24268,-1506.74 24268,-1506.74"/>
<polygon fill="black" stroke="black" points="24271.5,-1506.74 24268,-1496.74 24264.5,-1506.74 24271.5,-1506.74"/>
</g>
<!-- L2_S0_TP5_GPU5_qkv_slice&#45;&gt;L2_S0_TP5_GPU5_attn_v -->
<g id="edge761" class="edge">
<title>L2_S0_TP5_GPU5_qkv_slice&#45;&gt;L2_S0_TP5_GPU5_attn_v</title>
<path fill="none" stroke="black" d="M24016,-1428.38C24016,-1428.38 24016,-1195 24016,-1195"/>
<polygon fill="black" stroke="black" points="24019.5,-1195 24016,-1185 24012.5,-1195 24019.5,-1195"/>
</g>
<!-- L2_S0_TP5_GPU5_qk_matmul -->
<g id="node286" class="node">
<title>L2_S0_TP5_GPU5_qk_matmul</title>
<polygon fill="none" stroke="black" points="24983.5,-1392.67 24048.5,-1392.67 24048.5,-1324.67 24983.5,-1324.67 24983.5,-1392.67"/>
<text text-anchor="middle" x="24516" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="24516" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="24516" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="24516" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L2_S0_TP5_GPU5_qkv_slice&#45;&gt;L2_S0_TP5_GPU5_qk_matmul -->
<g id="edge758" class="edge">
<title>L2_S0_TP5_GPU5_qkv_slice&#45;&gt;L2_S0_TP5_GPU5_qk_matmul</title>
<path fill="none" stroke="black" d="M24307.25,-1428.61C24307.25,-1428.61 24307.25,-1402.8 24307.25,-1402.8"/>
<polygon fill="black" stroke="black" points="24310.75,-1402.8 24307.25,-1392.8 24303.75,-1402.8 24310.75,-1402.8"/>
</g>
<!-- L2_S0_TP5_GPU5_softmax -->
<g id="node287" class="node">
<title>L2_S0_TP5_GPU5_softmax</title>
<polygon fill="none" stroke="black" points="24665,-1288.67 24155,-1288.67 24155,-1220.67 24665,-1220.67 24665,-1288.67"/>
<text text-anchor="middle" x="24410" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="24410" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="24410" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="24410" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L2_S0_TP5_GPU5_qk_matmul&#45;&gt;L2_S0_TP5_GPU5_softmax -->
<g id="edge759" class="edge">
<title>L2_S0_TP5_GPU5_qk_matmul&#45;&gt;L2_S0_TP5_GPU5_softmax</title>
<path fill="none" stroke="black" d="M24410,-1324.61C24410,-1324.61 24410,-1298.8 24410,-1298.8"/>
<polygon fill="black" stroke="black" points="24413.5,-1298.8 24410,-1288.8 24406.5,-1298.8 24413.5,-1298.8"/>
</g>
<!-- L2_S0_TP5_GPU5_softmax&#45;&gt;L2_S0_TP5_GPU5_attn_v -->
<g id="edge760" class="edge">
<title>L2_S0_TP5_GPU5_softmax&#45;&gt;L2_S0_TP5_GPU5_attn_v</title>
<path fill="none" stroke="black" d="M24410,-1220.61C24410,-1220.61 24410,-1194.8 24410,-1194.8"/>
<polygon fill="black" stroke="black" points="24413.5,-1194.8 24410,-1184.8 24406.5,-1194.8 24413.5,-1194.8"/>
</g>
<!-- L2_S0_TP5_GPU5_mha_res -->
<g id="node289" class="node">
<title>L2_S0_TP5_GPU5_mha_res</title>
<polygon fill="none" stroke="black" points="24931.5,-948.5 24044.5,-948.5 24044.5,-880.5 24931.5,-880.5 24931.5,-948.5"/>
<text text-anchor="middle" x="24488" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="24488" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="24488" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="24488" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP5_GPU5_mha_ar&#45;&gt;L2_S0_TP5_GPU5_mha_res -->
<g id="edge770" class="edge">
<title>L2_S0_TP5_GPU5_mha_ar&#45;&gt;L2_S0_TP5_GPU5_mha_res</title>
<path fill="none" stroke="black" d="M24221.99,-991.61C24221.99,-991.61 24221.99,-958.74 24221.99,-958.74"/>
<polygon fill="black" stroke="black" points="24225.49,-958.74 24221.99,-948.74 24218.49,-958.74 24225.49,-958.74"/>
</g>
<!-- L2_S0_TP5_GPU5_gate -->
<g id="node290" class="node">
<title>L2_S0_TP5_GPU5_gate</title>
<polygon fill="none" stroke="black" points="25017.56,-844.5 24175.15,-844.5 23958.44,-708.5 24800.85,-708.5 25017.56,-844.5"/>
<text text-anchor="middle" x="24488" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="24488" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="24488" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="24488" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L2_S0_TP5_GPU5_mha_res&#45;&gt;L2_S0_TP5_GPU5_gate -->
<g id="edge771" class="edge">
<title>L2_S0_TP5_GPU5_mha_res&#45;&gt;L2_S0_TP5_GPU5_gate</title>
<path fill="none" stroke="black" d="M24488,-880.39C24488,-880.39 24488,-854.73 24488,-854.73"/>
<polygon fill="black" stroke="black" points="24491.5,-854.73 24488,-844.73 24484.5,-854.73 24491.5,-854.73"/>
</g>
<!-- L2_S0_TP5_GPU5_moe_res -->
<g id="node292" class="node">
<title>L2_S0_TP5_GPU5_moe_res</title>
<polygon fill="none" stroke="black" points="25265,-436.33 24445,-436.33 24445,-368.33 25265,-368.33 25265,-436.33"/>
<text text-anchor="middle" x="24855" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="24855" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="24855" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="24855" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP5_GPU5_mha_res&#45;&gt;L2_S0_TP5_GPU5_moe_res -->
<g id="edge791" class="edge">
<title>L2_S0_TP5_GPU5_mha_res&#45;&gt;L2_S0_TP5_GPU5_moe_res</title>
<path fill="none" stroke="black" d="M24931.57,-914C24988.27,-914 25027,-914 25027,-914 25027,-914 25027,-686 25027,-686 25027,-686 25201.1,-686 25201.1,-686 25201.1,-686 25201.1,-576 25201.1,-576 25201.1,-576 24937.02,-576 24937.02,-576 24937.02,-576 24937.02,-446.64 24937.02,-446.64"/>
<polygon fill="black" stroke="black" points="24940.52,-446.64 24937.02,-436.64 24933.52,-446.64 24940.52,-446.64"/>
</g>
<!-- L2_S0_TP5_GPU5_gate&#45;&gt;L2_S0_TP5_GPU5_expert0 -->
<g id="edge772" class="edge">
<title>L2_S0_TP5_GPU5_gate&#45;&gt;L2_S0_TP5_GPU5_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24110.86,-708.31C24110.86,-708.31 24110.86,-682.71 24110.86,-682.71"/>
<polygon fill="black" stroke="black" points="24114.36,-682.71 24110.86,-672.71 24107.36,-682.71 24114.36,-682.71"/>
</g>
<!-- L2_S0_TP5_GPU5_gate&#45;&gt;L2_S0_TP5_GPU5_expert1 -->
<g id="edge773" class="edge">
<title>L2_S0_TP5_GPU5_gate&#45;&gt;L2_S0_TP5_GPU5_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24580.83,-708.31C24580.83,-708.31 24580.83,-682.71 24580.83,-682.71"/>
<polygon fill="black" stroke="black" points="24584.33,-682.71 24580.83,-672.71 24577.33,-682.71 24584.33,-682.71"/>
</g>
<!-- L2_S0_TP5_GPU5_moe_ar&#45;&gt;L2_S0_TP5_GPU5_moe_res -->
<g id="edge790" class="edge">
<title>L2_S0_TP5_GPU5_moe_ar&#45;&gt;L2_S0_TP5_GPU5_moe_res</title>
<path fill="none" stroke="black" d="M24102.68,-481.67C24102.68,-459.48 24102.68,-436 24102.68,-436 24102.68,-436 24434.68,-436 24434.68,-436"/>
<polygon fill="black" stroke="black" points="24434.68,-439.5 24444.68,-436 24434.68,-432.5 24434.68,-439.5"/>
</g>
<!-- L2_S0_TP5_GPU5_norm -->
<g id="node293" class="node">
<title>L2_S0_TP5_GPU5_norm</title>
<polygon fill="none" stroke="black" points="25079.5,-332.33 24630.5,-332.33 24630.5,-264.33 25079.5,-264.33 25079.5,-332.33"/>
<text text-anchor="middle" x="24855" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="24855" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="24855" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="24855" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP5_GPU5_moe_res&#45;&gt;L2_S0_TP5_GPU5_norm -->
<g id="edge792" class="edge">
<title>L2_S0_TP5_GPU5_moe_res&#45;&gt;L2_S0_TP5_GPU5_norm</title>
<path fill="none" stroke="black" d="M24855,-368.28C24855,-368.28 24855,-342.46 24855,-342.46"/>
<polygon fill="black" stroke="black" points="24858.5,-342.46 24855,-332.46 24851.5,-342.46 24858.5,-342.46"/>
</g>
<!-- L2_S0_TP6_GPU6_qkv_linear -->
<g id="node294" class="node">
<title>L2_S0_TP6_GPU6_qkv_linear</title>
<polygon fill="none" stroke="black" points="25674,-1614.75 25066,-1614.75 25066,-1546.75 25674,-1546.75 25674,-1614.75"/>
<text text-anchor="middle" x="25370" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="25370" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="25370" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="25370" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L2_S0_TP6_GPU6_qkv_slice -->
<g id="node295" class="node">
<title>L2_S0_TP6_GPU6_qkv_slice</title>
<polygon fill="none" stroke="black" points="25668,-1496.67 25072,-1496.67 25072,-1428.67 25668,-1428.67 25668,-1496.67"/>
<text text-anchor="middle" x="25370" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="25370" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="25370" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="25370" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L2_S0_TP6_GPU6_qkv_linear&#45;&gt;L2_S0_TP6_GPU6_qkv_slice -->
<g id="edge793" class="edge">
<title>L2_S0_TP6_GPU6_qkv_linear&#45;&gt;L2_S0_TP6_GPU6_qkv_slice</title>
<path fill="none" stroke="black" d="M25370,-1546.59C25370,-1546.59 25370,-1506.74 25370,-1506.74"/>
<polygon fill="black" stroke="black" points="25373.5,-1506.74 25370,-1496.74 25366.5,-1506.74 25373.5,-1506.74"/>
</g>
<!-- L2_S0_TP6_GPU6_qkv_slice&#45;&gt;L2_S0_TP6_GPU6_attn_v -->
<g id="edge797" class="edge">
<title>L2_S0_TP6_GPU6_qkv_slice&#45;&gt;L2_S0_TP6_GPU6_attn_v</title>
<path fill="none" stroke="black" d="M25111.25,-1428.38C25111.25,-1428.38 25111.25,-1195 25111.25,-1195"/>
<polygon fill="black" stroke="black" points="25114.75,-1195 25111.25,-1185 25107.75,-1195 25114.75,-1195"/>
</g>
<!-- L2_S0_TP6_GPU6_qk_matmul -->
<g id="node296" class="node">
<title>L2_S0_TP6_GPU6_qk_matmul</title>
<polygon fill="none" stroke="black" points="26085.5,-1392.67 25150.5,-1392.67 25150.5,-1324.67 26085.5,-1324.67 26085.5,-1392.67"/>
<text text-anchor="middle" x="25618" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="25618" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="25618" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="25618" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L2_S0_TP6_GPU6_qkv_slice&#45;&gt;L2_S0_TP6_GPU6_qk_matmul -->
<g id="edge794" class="edge">
<title>L2_S0_TP6_GPU6_qkv_slice&#45;&gt;L2_S0_TP6_GPU6_qk_matmul</title>
<path fill="none" stroke="black" d="M25409.25,-1428.61C25409.25,-1428.61 25409.25,-1402.8 25409.25,-1402.8"/>
<polygon fill="black" stroke="black" points="25412.75,-1402.8 25409.25,-1392.8 25405.75,-1402.8 25412.75,-1402.8"/>
</g>
<!-- L2_S0_TP6_GPU6_softmax -->
<g id="node297" class="node">
<title>L2_S0_TP6_GPU6_softmax</title>
<polygon fill="none" stroke="black" points="25766,-1288.67 25256,-1288.67 25256,-1220.67 25766,-1220.67 25766,-1288.67"/>
<text text-anchor="middle" x="25511" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="25511" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="25511" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="25511" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L2_S0_TP6_GPU6_qk_matmul&#45;&gt;L2_S0_TP6_GPU6_softmax -->
<g id="edge795" class="edge">
<title>L2_S0_TP6_GPU6_qk_matmul&#45;&gt;L2_S0_TP6_GPU6_softmax</title>
<path fill="none" stroke="black" d="M25511,-1324.61C25511,-1324.61 25511,-1298.8 25511,-1298.8"/>
<polygon fill="black" stroke="black" points="25514.5,-1298.8 25511,-1288.8 25507.5,-1298.8 25514.5,-1298.8"/>
</g>
<!-- L2_S0_TP6_GPU6_softmax&#45;&gt;L2_S0_TP6_GPU6_attn_v -->
<g id="edge796" class="edge">
<title>L2_S0_TP6_GPU6_softmax&#45;&gt;L2_S0_TP6_GPU6_attn_v</title>
<path fill="none" stroke="black" d="M25492.5,-1220.61C25492.5,-1220.61 25492.5,-1194.8 25492.5,-1194.8"/>
<polygon fill="black" stroke="black" points="25496,-1194.8 25492.5,-1184.8 25489,-1194.8 25496,-1194.8"/>
</g>
<!-- L2_S0_TP6_GPU6_mha_res -->
<g id="node299" class="node">
<title>L2_S0_TP6_GPU6_mha_res</title>
<polygon fill="none" stroke="black" points="26009.5,-948.5 25122.5,-948.5 25122.5,-880.5 26009.5,-880.5 26009.5,-948.5"/>
<text text-anchor="middle" x="25566" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="25566" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="25566" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="25566" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP6_GPU6_mha_ar&#45;&gt;L2_S0_TP6_GPU6_mha_res -->
<g id="edge806" class="edge">
<title>L2_S0_TP6_GPU6_mha_ar&#45;&gt;L2_S0_TP6_GPU6_mha_res</title>
<path fill="none" stroke="black" d="M25145.49,-1015.91C25145.49,-1015.91 25145.49,-958.58 25145.49,-958.58"/>
<polygon fill="black" stroke="black" points="25148.99,-958.58 25145.49,-948.58 25141.99,-958.58 25148.99,-958.58"/>
</g>
<!-- L2_S0_TP6_GPU6_gate -->
<g id="node300" class="node">
<title>L2_S0_TP6_GPU6_gate</title>
<polygon fill="none" stroke="black" points="26095.56,-844.5 25253.15,-844.5 25036.44,-708.5 25878.85,-708.5 26095.56,-844.5"/>
<text text-anchor="middle" x="25566" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="25566" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="25566" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="25566" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L2_S0_TP6_GPU6_mha_res&#45;&gt;L2_S0_TP6_GPU6_gate -->
<g id="edge807" class="edge">
<title>L2_S0_TP6_GPU6_mha_res&#45;&gt;L2_S0_TP6_GPU6_gate</title>
<path fill="none" stroke="black" d="M25566,-880.39C25566,-880.39 25566,-854.73 25566,-854.73"/>
<polygon fill="black" stroke="black" points="25569.5,-854.73 25566,-844.73 25562.5,-854.73 25569.5,-854.73"/>
</g>
<!-- L2_S0_TP6_GPU6_moe_res -->
<g id="node302" class="node">
<title>L2_S0_TP6_GPU6_moe_res</title>
<polygon fill="none" stroke="black" points="26291,-436.33 25471,-436.33 25471,-368.33 26291,-368.33 26291,-436.33"/>
<text text-anchor="middle" x="25881" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="25881" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="25881" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="25881" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP6_GPU6_mha_res&#45;&gt;L2_S0_TP6_GPU6_moe_res -->
<g id="edge827" class="edge">
<title>L2_S0_TP6_GPU6_mha_res&#45;&gt;L2_S0_TP6_GPU6_moe_res</title>
<path fill="none" stroke="black" d="M26009.57,-914C26066.27,-914 26105,-914 26105,-914 26105,-914 26105,-683 26105,-683 26105,-683 26140.5,-683 26140.5,-683 26140.5,-683 26140.5,-446.47 26140.5,-446.47"/>
<polygon fill="black" stroke="black" points="26144,-446.47 26140.5,-436.47 26137,-446.47 26144,-446.47"/>
</g>
<!-- L2_S0_TP6_GPU6_gate&#45;&gt;L2_S0_TP6_GPU6_expert0 -->
<g id="edge808" class="edge">
<title>L2_S0_TP6_GPU6_gate&#45;&gt;L2_S0_TP6_GPU6_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M25116.86,-708.31C25116.86,-708.31 25116.86,-682.71 25116.86,-682.71"/>
<polygon fill="black" stroke="black" points="25120.36,-682.71 25116.86,-672.71 25113.36,-682.71 25120.36,-682.71"/>
</g>
<!-- L2_S0_TP6_GPU6_gate&#45;&gt;L2_S0_TP6_GPU6_expert1 -->
<g id="edge809" class="edge">
<title>L2_S0_TP6_GPU6_gate&#45;&gt;L2_S0_TP6_GPU6_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M25440,-708.31C25440,-708.31 25440,-682.71 25440,-682.71"/>
<polygon fill="black" stroke="black" points="25443.5,-682.71 25440,-672.71 25436.5,-682.71 25443.5,-682.71"/>
</g>
<!-- L2_S0_TP6_GPU6_moe_ar&#45;&gt;L2_S0_TP6_GPU6_moe_res -->
<g id="edge826" class="edge">
<title>L2_S0_TP6_GPU6_moe_ar&#45;&gt;L2_S0_TP6_GPU6_moe_res</title>
<path fill="none" stroke="black" d="M24763.97,-479.2C24763.97,-458.18 24763.97,-437 24763.97,-437 24763.97,-437 25540.73,-437 25540.73,-437 25540.73,-437 25540.73,-436.96 25540.73,-436.96"/>
<polygon fill="black" stroke="black" points="25544.23,-446.61 25540.73,-436.61 25537.23,-446.61 25544.23,-446.61"/>
</g>
<!-- L2_S0_TP6_GPU6_norm -->
<g id="node303" class="node">
<title>L2_S0_TP6_GPU6_norm</title>
<polygon fill="none" stroke="black" points="26105.5,-332.33 25656.5,-332.33 25656.5,-264.33 26105.5,-264.33 26105.5,-332.33"/>
<text text-anchor="middle" x="25881" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="25881" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="25881" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="25881" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP6_GPU6_moe_res&#45;&gt;L2_S0_TP6_GPU6_norm -->
<g id="edge828" class="edge">
<title>L2_S0_TP6_GPU6_moe_res&#45;&gt;L2_S0_TP6_GPU6_norm</title>
<path fill="none" stroke="black" d="M25881,-368.28C25881,-368.28 25881,-342.46 25881,-342.46"/>
<polygon fill="black" stroke="black" points="25884.5,-342.46 25881,-332.46 25877.5,-342.46 25884.5,-342.46"/>
</g>
<!-- L2_S0_TP7_GPU7_qkv_linear -->
<g id="node304" class="node">
<title>L2_S0_TP7_GPU7_qkv_linear</title>
<polygon fill="none" stroke="black" points="26721,-1614.75 26113,-1614.75 26113,-1546.75 26721,-1546.75 26721,-1614.75"/>
<text text-anchor="middle" x="26417" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="26417" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="26417" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="26417" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L2_S0_TP7_GPU7_qkv_slice -->
<g id="node305" class="node">
<title>L2_S0_TP7_GPU7_qkv_slice</title>
<polygon fill="none" stroke="black" points="26715,-1496.67 26119,-1496.67 26119,-1428.67 26715,-1428.67 26715,-1496.67"/>
<text text-anchor="middle" x="26417" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="26417" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="26417" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="26417" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L2_S0_TP7_GPU7_qkv_linear&#45;&gt;L2_S0_TP7_GPU7_qkv_slice -->
<g id="edge829" class="edge">
<title>L2_S0_TP7_GPU7_qkv_linear&#45;&gt;L2_S0_TP7_GPU7_qkv_slice</title>
<path fill="none" stroke="black" d="M26417,-1546.59C26417,-1546.59 26417,-1506.74 26417,-1506.74"/>
<polygon fill="black" stroke="black" points="26420.5,-1506.74 26417,-1496.74 26413.5,-1506.74 26420.5,-1506.74"/>
</g>
<!-- L2_S0_TP7_GPU7_qkv_slice&#45;&gt;L2_S0_TP7_GPU7_attn_v -->
<g id="edge833" class="edge">
<title>L2_S0_TP7_GPU7_qkv_slice&#45;&gt;L2_S0_TP7_GPU7_attn_v</title>
<path fill="none" stroke="black" d="M26158.25,-1428.38C26158.25,-1428.38 26158.25,-1195 26158.25,-1195"/>
<polygon fill="black" stroke="black" points="26161.75,-1195 26158.25,-1185 26154.75,-1195 26161.75,-1195"/>
</g>
<!-- L2_S0_TP7_GPU7_qk_matmul -->
<g id="node306" class="node">
<title>L2_S0_TP7_GPU7_qk_matmul</title>
<polygon fill="none" stroke="black" points="27132.5,-1392.67 26197.5,-1392.67 26197.5,-1324.67 27132.5,-1324.67 27132.5,-1392.67"/>
<text text-anchor="middle" x="26665" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="26665" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="26665" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="26665" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L2_S0_TP7_GPU7_qkv_slice&#45;&gt;L2_S0_TP7_GPU7_qk_matmul -->
<g id="edge830" class="edge">
<title>L2_S0_TP7_GPU7_qkv_slice&#45;&gt;L2_S0_TP7_GPU7_qk_matmul</title>
<path fill="none" stroke="black" d="M26456.25,-1428.61C26456.25,-1428.61 26456.25,-1402.8 26456.25,-1402.8"/>
<polygon fill="black" stroke="black" points="26459.75,-1402.8 26456.25,-1392.8 26452.75,-1402.8 26459.75,-1402.8"/>
</g>
<!-- L2_S0_TP7_GPU7_softmax -->
<g id="node307" class="node">
<title>L2_S0_TP7_GPU7_softmax</title>
<polygon fill="none" stroke="black" points="26813,-1288.67 26303,-1288.67 26303,-1220.67 26813,-1220.67 26813,-1288.67"/>
<text text-anchor="middle" x="26558" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="26558" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="26558" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="26558" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L2_S0_TP7_GPU7_qk_matmul&#45;&gt;L2_S0_TP7_GPU7_softmax -->
<g id="edge831" class="edge">
<title>L2_S0_TP7_GPU7_qk_matmul&#45;&gt;L2_S0_TP7_GPU7_softmax</title>
<path fill="none" stroke="black" d="M26558,-1324.61C26558,-1324.61 26558,-1298.8 26558,-1298.8"/>
<polygon fill="black" stroke="black" points="26561.5,-1298.8 26558,-1288.8 26554.5,-1298.8 26561.5,-1298.8"/>
</g>
<!-- L2_S0_TP7_GPU7_softmax&#45;&gt;L2_S0_TP7_GPU7_attn_v -->
<g id="edge832" class="edge">
<title>L2_S0_TP7_GPU7_softmax&#45;&gt;L2_S0_TP7_GPU7_attn_v</title>
<path fill="none" stroke="black" d="M26494,-1220.61C26494,-1220.61 26494,-1194.8 26494,-1194.8"/>
<polygon fill="black" stroke="black" points="26497.5,-1194.8 26494,-1184.8 26490.5,-1194.8 26497.5,-1194.8"/>
</g>
<!-- L2_S0_TP7_GPU7_mha_res -->
<g id="node309" class="node">
<title>L2_S0_TP7_GPU7_mha_res</title>
<polygon fill="none" stroke="black" points="27087.5,-948.5 26200.5,-948.5 26200.5,-880.5 27087.5,-880.5 27087.5,-948.5"/>
<text text-anchor="middle" x="26644" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="26644" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="26644" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="26644" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP7_GPU7_mha_ar&#45;&gt;L2_S0_TP7_GPU7_mha_res -->
<g id="edge842" class="edge">
<title>L2_S0_TP7_GPU7_mha_ar&#45;&gt;L2_S0_TP7_GPU7_mha_res</title>
<path fill="none" stroke="black" d="M25917.7,-1048C26162.14,-1048 26442.75,-1048 26442.75,-1048 26442.75,-1048 26442.75,-958.53 26442.75,-958.53"/>
<polygon fill="black" stroke="black" points="26446.25,-958.53 26442.75,-948.53 26439.25,-958.53 26446.25,-958.53"/>
</g>
<!-- L2_S0_TP7_GPU7_gate -->
<g id="node310" class="node">
<title>L2_S0_TP7_GPU7_gate</title>
<polygon fill="none" stroke="black" points="27173.56,-844.5 26331.15,-844.5 26114.44,-708.5 26956.85,-708.5 27173.56,-844.5"/>
<text text-anchor="middle" x="26644" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="26644" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="26644" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="26644" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L2_S0_TP7_GPU7_mha_res&#45;&gt;L2_S0_TP7_GPU7_gate -->
<g id="edge843" class="edge">
<title>L2_S0_TP7_GPU7_mha_res&#45;&gt;L2_S0_TP7_GPU7_gate</title>
<path fill="none" stroke="black" d="M26644,-880.39C26644,-880.39 26644,-854.73 26644,-854.73"/>
<polygon fill="black" stroke="black" points="26647.5,-854.73 26644,-844.73 26640.5,-854.73 26647.5,-854.73"/>
</g>
<!-- L2_S0_TP7_GPU7_moe_res -->
<g id="node312" class="node">
<title>L2_S0_TP7_GPU7_moe_res</title>
<polygon fill="none" stroke="black" points="27504,-436.33 26684,-436.33 26684,-368.33 27504,-368.33 27504,-436.33"/>
<text text-anchor="middle" x="27094" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="27094" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="27094" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="27094" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP7_GPU7_mha_res&#45;&gt;L2_S0_TP7_GPU7_moe_res -->
<g id="edge863" class="edge">
<title>L2_S0_TP7_GPU7_mha_res&#45;&gt;L2_S0_TP7_GPU7_moe_res</title>
<path fill="none" stroke="black" d="M27087.97,-914C27222.32,-914 27335,-914 27335,-914 27335,-914 27335,-446.7 27335,-446.7"/>
<polygon fill="black" stroke="black" points="27338.5,-446.7 27335,-436.7 27331.5,-446.7 27338.5,-446.7"/>
</g>
<!-- L2_S0_TP7_GPU7_gate&#45;&gt;L2_S0_TP7_GPU7_expert0 -->
<g id="edge844" class="edge">
<title>L2_S0_TP7_GPU7_gate&#45;&gt;L2_S0_TP7_GPU7_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26122.86,-776.4C26122.86,-776.4 26122.86,-682.74 26122.86,-682.74"/>
<polygon fill="black" stroke="black" points="26126.36,-682.74 26122.86,-672.74 26119.36,-682.74 26126.36,-682.74"/>
</g>
<!-- L2_S0_TP7_GPU7_gate&#45;&gt;L2_S0_TP7_GPU7_expert1 -->
<g id="edge845" class="edge">
<title>L2_S0_TP7_GPU7_gate&#45;&gt;L2_S0_TP7_GPU7_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26374,-708.31C26374,-708.31 26374,-682.71 26374,-682.71"/>
<polygon fill="black" stroke="black" points="26377.5,-682.71 26374,-672.71 26370.5,-682.71 26377.5,-682.71"/>
</g>
<!-- L2_S0_TP7_GPU7_moe_ar&#45;&gt;L2_S0_TP7_GPU7_moe_res -->
<g id="edge862" class="edge">
<title>L2_S0_TP7_GPU7_moe_ar&#45;&gt;L2_S0_TP7_GPU7_moe_res</title>
<path fill="none" stroke="black" d="M25607.51,-527C26090.02,-527 26928.89,-527 26928.89,-527 26928.89,-527 26928.89,-446.4 26928.89,-446.4"/>
<polygon fill="black" stroke="black" points="26932.39,-446.4 26928.89,-436.4 26925.39,-446.4 26932.39,-446.4"/>
</g>
<!-- L2_S0_TP7_GPU7_norm -->
<g id="node313" class="node">
<title>L2_S0_TP7_GPU7_norm</title>
<polygon fill="none" stroke="black" points="27318.5,-332.33 26869.5,-332.33 26869.5,-264.33 27318.5,-264.33 27318.5,-332.33"/>
<text text-anchor="middle" x="27094" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="27094" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="27094" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="27094" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L2_S0_TP7_GPU7_moe_res&#45;&gt;L2_S0_TP7_GPU7_norm -->
<g id="edge864" class="edge">
<title>L2_S0_TP7_GPU7_moe_res&#45;&gt;L2_S0_TP7_GPU7_norm</title>
<path fill="none" stroke="black" d="M27094,-368.28C27094,-368.28 27094,-342.46 27094,-342.46"/>
<polygon fill="black" stroke="black" points="27097.5,-342.46 27094,-332.46 27090.5,-342.46 27097.5,-342.46"/>
</g>
<!-- L3_S0_TP0_GPU0_qkv_linear -->
<g id="node314" class="node">
<title>L3_S0_TP0_GPU0_qkv_linear</title>
<polygon fill="none" stroke="black" points="28446,-1614.75 27838,-1614.75 27838,-1546.75 28446,-1546.75 28446,-1614.75"/>
<text text-anchor="middle" x="28142" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="28142" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="28142" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="28142" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L3_S0_TP0_GPU0_qkv_slice -->
<g id="node315" class="node">
<title>L3_S0_TP0_GPU0_qkv_slice</title>
<polygon fill="none" stroke="black" points="28440,-1496.67 27844,-1496.67 27844,-1428.67 28440,-1428.67 28440,-1496.67"/>
<text text-anchor="middle" x="28142" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="28142" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="28142" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="28142" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L3_S0_TP0_GPU0_qkv_linear&#45;&gt;L3_S0_TP0_GPU0_qkv_slice -->
<g id="edge865" class="edge">
<title>L3_S0_TP0_GPU0_qkv_linear&#45;&gt;L3_S0_TP0_GPU0_qkv_slice</title>
<path fill="none" stroke="black" d="M28142,-1546.59C28142,-1546.59 28142,-1506.74 28142,-1506.74"/>
<polygon fill="black" stroke="black" points="28145.5,-1506.74 28142,-1496.74 28138.5,-1506.74 28145.5,-1506.74"/>
</g>
<!-- L3_S0_TP0_GPU0_qk_matmul -->
<g id="node316" class="node">
<title>L3_S0_TP0_GPU0_qk_matmul</title>
<polygon fill="none" stroke="black" points="28922.5,-1392.67 27987.5,-1392.67 27987.5,-1324.67 28922.5,-1324.67 28922.5,-1392.67"/>
<text text-anchor="middle" x="28455" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="28455" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="28455" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="28455" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L3_S0_TP0_GPU0_qkv_slice&#45;&gt;L3_S0_TP0_GPU0_qk_matmul -->
<g id="edge866" class="edge">
<title>L3_S0_TP0_GPU0_qkv_slice&#45;&gt;L3_S0_TP0_GPU0_qk_matmul</title>
<path fill="none" stroke="black" d="M28213.75,-1428.61C28213.75,-1428.61 28213.75,-1402.8 28213.75,-1402.8"/>
<polygon fill="black" stroke="black" points="28217.25,-1402.8 28213.75,-1392.8 28210.25,-1402.8 28217.25,-1402.8"/>
</g>
<!-- L3_S0_TP0_GPU0_attn_v -->
<g id="node318" class="node">
<title>L3_S0_TP0_GPU0_attn_v</title>
<polygon fill="none" stroke="black" points="28922,-1184.67 27984,-1184.67 27984,-1116.67 28922,-1116.67 28922,-1184.67"/>
<text text-anchor="middle" x="28453" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="28453" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="28453" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="28453" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L3_S0_TP0_GPU0_qkv_slice&#45;&gt;L3_S0_TP0_GPU0_attn_v -->
<g id="edge869" class="edge">
<title>L3_S0_TP0_GPU0_qkv_slice&#45;&gt;L3_S0_TP0_GPU0_attn_v</title>
<path fill="none" stroke="black" d="M27914,-1428.61C27914,-1347.57 27914,-1150 27914,-1150 27914,-1150 27973.91,-1150 27973.91,-1150"/>
<polygon fill="black" stroke="black" points="27973.91,-1153.5 27983.91,-1150 27973.91,-1146.5 27973.91,-1153.5"/>
</g>
<!-- L3_S0_TP0_GPU0_softmax -->
<g id="node317" class="node">
<title>L3_S0_TP0_GPU0_softmax</title>
<polygon fill="none" stroke="black" points="28709,-1288.67 28199,-1288.67 28199,-1220.67 28709,-1220.67 28709,-1288.67"/>
<text text-anchor="middle" x="28454" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="28454" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="28454" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="28454" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L3_S0_TP0_GPU0_qk_matmul&#45;&gt;L3_S0_TP0_GPU0_softmax -->
<g id="edge867" class="edge">
<title>L3_S0_TP0_GPU0_qk_matmul&#45;&gt;L3_S0_TP0_GPU0_softmax</title>
<path fill="none" stroke="black" d="M28454,-1324.61C28454,-1324.61 28454,-1298.8 28454,-1298.8"/>
<polygon fill="black" stroke="black" points="28457.5,-1298.8 28454,-1288.8 28450.5,-1298.8 28457.5,-1298.8"/>
</g>
<!-- L3_S0_TP0_GPU0_softmax&#45;&gt;L3_S0_TP0_GPU0_attn_v -->
<g id="edge868" class="edge">
<title>L3_S0_TP0_GPU0_softmax&#45;&gt;L3_S0_TP0_GPU0_attn_v</title>
<path fill="none" stroke="black" d="M28454,-1220.61C28454,-1220.61 28454,-1194.8 28454,-1194.8"/>
<polygon fill="black" stroke="black" points="28457.5,-1194.8 28454,-1184.8 28450.5,-1194.8 28457.5,-1194.8"/>
</g>
<!-- L3_S0_TP0_GPU0_mha_ar -->
<g id="node319" class="node">
<title>L3_S0_TP0_GPU0_mha_ar</title>
<ellipse fill="none" stroke="black" cx="29107" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="29107" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="29107" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="29107" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="29107" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP0_GPU0_attn_v&#45;&gt;L3_S0_TP0_GPU0_mha_ar -->
<g id="edge870" class="edge">
<title>L3_S0_TP0_GPU0_attn_v&#45;&gt;L3_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M28758.74,-1116.51C28758.74,-1116.51 28758.74,-1060.6 28758.74,-1060.6"/>
<polygon fill="black" stroke="black" points="28762.24,-1060.6 28758.74,-1050.6 28755.24,-1060.6 28762.24,-1060.6"/>
</g>
<!-- L3_S0_TP1_GPU1_mha_ar -->
<g id="node352" class="node">
<title>L3_S0_TP1_GPU1_mha_ar</title>
<ellipse fill="none" stroke="black" cx="29876" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="29876" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="29876" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="29876" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="29876" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP0_GPU0_attn_v&#45;&gt;L3_S0_TP1_GPU1_mha_ar -->
<g id="edge906" class="edge">
<title>L3_S0_TP0_GPU0_attn_v&#45;&gt;L3_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M28785.95,-1116.65C28785.95,-1098.97 28785.95,-1081 28785.95,-1081 28785.95,-1081 29547.71,-1081 29547.71,-1081 29547.71,-1081 29547.71,-1065.94 29547.71,-1065.94"/>
<polygon fill="black" stroke="black" points="29551.21,-1065.94 29547.71,-1055.94 29544.21,-1065.94 29551.21,-1065.94"/>
</g>
<!-- L3_S0_TP2_GPU2_mha_ar -->
<g id="node362" class="node">
<title>L3_S0_TP2_GPU2_mha_ar</title>
<ellipse fill="none" stroke="black" cx="30645" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="30645" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="30645" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="30645" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="30645" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP0_GPU0_attn_v&#45;&gt;L3_S0_TP2_GPU2_mha_ar -->
<g id="edge942" class="edge">
<title>L3_S0_TP0_GPU0_attn_v&#45;&gt;L3_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M28813.16,-1116.65C28813.16,-1098.97 28813.16,-1081 28813.16,-1081 28813.16,-1081 30332.25,-1081 30332.25,-1081 30332.25,-1081 30332.25,-1069.34 30332.25,-1069.34"/>
<polygon fill="black" stroke="black" points="30335.75,-1069.34 30332.25,-1059.34 30328.75,-1069.34 30335.75,-1069.34"/>
</g>
<!-- L3_S0_TP3_GPU3_mha_ar -->
<g id="node372" class="node">
<title>L3_S0_TP3_GPU3_mha_ar</title>
<ellipse fill="none" stroke="black" cx="31414" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="31414" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="31414" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="31414" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="31414" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP0_GPU0_attn_v&#45;&gt;L3_S0_TP3_GPU3_mha_ar -->
<g id="edge978" class="edge">
<title>L3_S0_TP0_GPU0_attn_v&#45;&gt;L3_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M28840.37,-1116.33C28840.37,-1099.17 28840.37,-1082 28840.37,-1082 28840.37,-1082 31145.8,-1082 31145.8,-1082 31145.8,-1082 31145.8,-1076.36 31145.8,-1076.36"/>
<polygon fill="black" stroke="black" points="31149.3,-1076.36 31145.8,-1066.36 31142.3,-1076.36 31149.3,-1076.36"/>
</g>
<!-- L3_S0_TP4_GPU4_mha_ar -->
<g id="node382" class="node">
<title>L3_S0_TP4_GPU4_mha_ar</title>
<ellipse fill="none" stroke="black" cx="32183" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="32183" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="32183" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="32183" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="32183" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP0_GPU0_attn_v&#45;&gt;L3_S0_TP4_GPU4_mha_ar -->
<g id="edge1014" class="edge">
<title>L3_S0_TP0_GPU0_attn_v&#45;&gt;L3_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M28696.01,-1116.51C28696.01,-1059.71 28696.01,-952 28696.01,-952 28696.01,-952 31865.74,-952 31865.74,-952 31865.74,-952 31865.74,-996.64 31865.74,-996.64"/>
<polygon fill="black" stroke="black" points="31862.24,-996.64 31865.74,-1006.64 31869.24,-996.64 31862.24,-996.64"/>
</g>
<!-- L3_S0_TP5_GPU5_mha_ar -->
<g id="node392" class="node">
<title>L3_S0_TP5_GPU5_mha_ar</title>
<ellipse fill="none" stroke="black" cx="32952" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="32952" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="32952" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="32952" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="32952" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP0_GPU0_attn_v&#45;&gt;L3_S0_TP5_GPU5_mha_ar -->
<g id="edge1050" class="edge">
<title>L3_S0_TP0_GPU0_attn_v&#45;&gt;L3_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M28815.5,-1184.94C28815.5,-1197.63 28815.5,-1209 28815.5,-1209 28815.5,-1209 32758,-1209 32758,-1209 32758,-1209 32758,-1083.94 32758,-1083.94"/>
<polygon fill="black" stroke="black" points="32761.5,-1083.94 32758,-1073.94 32754.5,-1083.94 32761.5,-1083.94"/>
</g>
<!-- L3_S0_TP6_GPU6_mha_ar -->
<g id="node402" class="node">
<title>L3_S0_TP6_GPU6_mha_ar</title>
<ellipse fill="none" stroke="black" cx="33721" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="33721" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="33721" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="33721" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="33721" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP0_GPU0_attn_v&#45;&gt;L3_S0_TP6_GPU6_mha_ar -->
<g id="edge1086" class="edge">
<title>L3_S0_TP0_GPU0_attn_v&#45;&gt;L3_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M28867.58,-1116.36C28867.58,-1105.37 28867.58,-1096 28867.58,-1096 28867.58,-1096 33396.45,-1096 33396.45,-1096 33396.45,-1096 33396.45,-1066.92 33396.45,-1066.92"/>
<polygon fill="black" stroke="black" points="33399.95,-1066.92 33396.45,-1056.92 33392.95,-1066.92 33399.95,-1066.92"/>
</g>
<!-- L3_S0_TP7_GPU7_mha_ar -->
<g id="node412" class="node">
<title>L3_S0_TP7_GPU7_mha_ar</title>
<ellipse fill="none" stroke="black" cx="34490" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="34490" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="34490" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="34490" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="34490" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP0_GPU0_attn_v&#45;&gt;L3_S0_TP7_GPU7_mha_ar -->
<g id="edge1122" class="edge">
<title>L3_S0_TP0_GPU0_attn_v&#45;&gt;L3_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M28894.79,-1116.36C28894.79,-1105.37 28894.79,-1096 28894.79,-1096 28894.79,-1096 34182.46,-1096 34182.46,-1096 34182.46,-1096 34182.46,-1070.21 34182.46,-1070.21"/>
<polygon fill="black" stroke="black" points="34185.96,-1070.21 34182.46,-1060.21 34178.96,-1070.21 34185.96,-1070.21"/>
</g>
<!-- L3_S0_TP0_GPU0_mha_res -->
<g id="node327" class="node">
<title>L3_S0_TP0_GPU0_mha_res</title>
<polygon fill="none" stroke="black" points="28469.5,-948.5 27582.5,-948.5 27582.5,-880.5 28469.5,-880.5 28469.5,-948.5"/>
<text text-anchor="middle" x="28026" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="28026" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="28026" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="28026" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP0_GPU0_mha_ar&#45;&gt;L3_S0_TP0_GPU0_mha_res -->
<g id="edge878" class="edge">
<title>L3_S0_TP0_GPU0_mha_ar&#45;&gt;L3_S0_TP0_GPU0_mha_res</title>
<path fill="none" stroke="black" d="M28754.36,-1016C28509.39,-1016 28226.75,-1016 28226.75,-1016 28226.75,-1016 28226.75,-958.58 28226.75,-958.58"/>
<polygon fill="black" stroke="black" points="28230.25,-958.58 28226.75,-948.58 28223.25,-958.58 28230.25,-958.58"/>
</g>
<!-- L3_S0_TP1_GPU1_attn_v -->
<g id="node320" class="node">
<title>L3_S0_TP1_GPU1_attn_v</title>
<polygon fill="none" stroke="black" points="29878,-1184.67 28940,-1184.67 28940,-1116.67 29878,-1116.67 29878,-1184.67"/>
<text text-anchor="middle" x="29409" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="29409" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="29409" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="29409" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L3_S0_TP1_GPU1_attn_v&#45;&gt;L3_S0_TP0_GPU0_mha_ar -->
<g id="edge871" class="edge">
<title>L3_S0_TP1_GPU1_attn_v&#45;&gt;L3_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M29007.81,-1116.51C29007.81,-1116.51 29007.81,-1088.96 29007.81,-1088.96"/>
<polygon fill="black" stroke="black" points="29011.31,-1088.96 29007.81,-1078.96 29004.31,-1088.96 29011.31,-1088.96"/>
</g>
<!-- L3_S0_TP1_GPU1_attn_v&#45;&gt;L3_S0_TP1_GPU1_mha_ar -->
<g id="edge907" class="edge">
<title>L3_S0_TP1_GPU1_attn_v&#45;&gt;L3_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M29594.89,-1116.51C29594.89,-1116.51 29594.89,-1074.64 29594.89,-1074.64"/>
<polygon fill="black" stroke="black" points="29598.39,-1074.64 29594.89,-1064.64 29591.39,-1074.64 29598.39,-1074.64"/>
</g>
<!-- L3_S0_TP1_GPU1_attn_v&#45;&gt;L3_S0_TP2_GPU2_mha_ar -->
<g id="edge943" class="edge">
<title>L3_S0_TP1_GPU1_attn_v&#45;&gt;L3_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M29642.08,-1116.65C29642.08,-1098.97 29642.08,-1081 29642.08,-1081 29642.08,-1081 30394.96,-1081 30394.96,-1081 30394.96,-1081 30394.96,-1078.53 30394.96,-1078.53"/>
<polygon fill="black" stroke="black" points="30398.46,-1078.53 30394.96,-1068.53 30391.46,-1078.53 30398.46,-1078.53"/>
</g>
<!-- L3_S0_TP1_GPU1_attn_v&#45;&gt;L3_S0_TP3_GPU3_mha_ar -->
<g id="edge979" class="edge">
<title>L3_S0_TP1_GPU1_attn_v&#45;&gt;L3_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M29689.26,-1116.33C29689.26,-1099.17 29689.26,-1082 29689.26,-1082 29689.26,-1082 31253.08,-1082 31253.08,-1082 31253.08,-1082 31253.08,-1081.43 31253.08,-1081.43"/>
<polygon fill="black" stroke="black" points="31256.58,-1086.33 31253.08,-1076.33 31249.58,-1086.33 31256.58,-1086.33"/>
</g>
<!-- L3_S0_TP1_GPU1_attn_v&#45;&gt;L3_S0_TP4_GPU4_mha_ar -->
<g id="edge1015" class="edge">
<title>L3_S0_TP1_GPU1_attn_v&#45;&gt;L3_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M29491.5,-1116.51C29491.5,-1059.71 29491.5,-952 29491.5,-952 29491.5,-952 31836.98,-952 31836.98,-952 31836.98,-952 31836.98,-1003.89 31836.98,-1003.89"/>
<polygon fill="black" stroke="black" points="31833.48,-1003.89 31836.98,-1013.89 31840.48,-1003.89 31833.48,-1003.89"/>
</g>
<!-- L3_S0_TP1_GPU1_attn_v&#45;&gt;L3_S0_TP5_GPU5_mha_ar -->
<g id="edge1051" class="edge">
<title>L3_S0_TP1_GPU1_attn_v&#45;&gt;L3_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M29736.45,-1116.36C29736.45,-1105.37 29736.45,-1096 29736.45,-1096 29736.45,-1096 32604.77,-1096 32604.77,-1096 32604.77,-1096 32604.77,-1060.93 32604.77,-1060.93"/>
<polygon fill="black" stroke="black" points="32608.27,-1060.93 32604.77,-1050.93 32601.27,-1060.93 32608.27,-1060.93"/>
</g>
<!-- L3_S0_TP1_GPU1_attn_v&#45;&gt;L3_S0_TP6_GPU6_mha_ar -->
<g id="edge1087" class="edge">
<title>L3_S0_TP1_GPU1_attn_v&#45;&gt;L3_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M29783.63,-1116.36C29783.63,-1105.37 29783.63,-1096 29783.63,-1096 29783.63,-1096 33447.38,-1096 33447.38,-1096 33447.38,-1096 33447.38,-1075.78 33447.38,-1075.78"/>
<polygon fill="black" stroke="black" points="33450.88,-1075.78 33447.38,-1065.78 33443.88,-1075.78 33450.88,-1075.78"/>
</g>
<!-- L3_S0_TP1_GPU1_attn_v&#45;&gt;L3_S0_TP7_GPU7_mha_ar -->
<g id="edge1123" class="edge">
<title>L3_S0_TP1_GPU1_attn_v&#45;&gt;L3_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M29830.82,-1116.36C29830.82,-1105.37 29830.82,-1096 29830.82,-1096 29830.82,-1096 34250.39,-1096 34250.39,-1096 34250.39,-1096 34250.39,-1079.84 34250.39,-1079.84"/>
<polygon fill="black" stroke="black" points="34253.89,-1079.84 34250.39,-1069.84 34246.89,-1079.84 34253.89,-1079.84"/>
</g>
<!-- L3_S0_TP2_GPU2_attn_v -->
<g id="node321" class="node">
<title>L3_S0_TP2_GPU2_attn_v</title>
<polygon fill="none" stroke="black" points="30834,-1184.67 29896,-1184.67 29896,-1116.67 30834,-1116.67 30834,-1184.67"/>
<text text-anchor="middle" x="30365" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="30365" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="30365" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="30365" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L3_S0_TP2_GPU2_attn_v&#45;&gt;L3_S0_TP0_GPU0_mha_ar -->
<g id="edge872" class="edge">
<title>L3_S0_TP2_GPU2_attn_v&#45;&gt;L3_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M29955.25,-1116.41C29955.25,-1114.9 29955.25,-1114 29955.25,-1114 29955.25,-1114 29075.62,-1114 29075.62,-1114 29075.62,-1114 29075.62,-1090.88 29075.62,-1090.88"/>
<polygon fill="black" stroke="black" points="29079.12,-1090.88 29075.62,-1080.88 29072.12,-1090.88 29079.12,-1090.88"/>
</g>
<!-- L3_S0_TP2_GPU2_attn_v&#45;&gt;L3_S0_TP1_GPU1_mha_ar -->
<g id="edge908" class="edge">
<title>L3_S0_TP2_GPU2_attn_v&#45;&gt;L3_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M30014.49,-1116.51C30014.49,-1116.51 30014.49,-1087.65 30014.49,-1087.65"/>
<polygon fill="black" stroke="black" points="30017.99,-1087.65 30014.49,-1077.65 30010.99,-1087.65 30017.99,-1087.65"/>
</g>
<!-- L3_S0_TP2_GPU2_attn_v&#45;&gt;L3_S0_TP2_GPU2_mha_ar -->
<g id="edge944" class="edge">
<title>L3_S0_TP2_GPU2_attn_v&#45;&gt;L3_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M30457.68,-1116.51C30457.68,-1116.51 30457.68,-1084.63 30457.68,-1084.63"/>
<polygon fill="black" stroke="black" points="30461.18,-1084.63 30457.68,-1074.63 30454.18,-1084.63 30461.18,-1084.63"/>
</g>
<!-- L3_S0_TP2_GPU2_attn_v&#45;&gt;L3_S0_TP3_GPU3_mha_ar -->
<g id="edge980" class="edge">
<title>L3_S0_TP2_GPU2_attn_v&#45;&gt;L3_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M30520.4,-1116.33C30520.4,-1099.17 30520.4,-1082 30520.4,-1082 30520.4,-1082 31360.36,-1082 31360.36,-1082 31360.36,-1082 31360.36,-1081.84 31360.36,-1081.84"/>
<polygon fill="black" stroke="black" points="31363.86,-1090.36 31360.36,-1080.36 31356.86,-1090.36 31363.86,-1090.36"/>
</g>
<!-- L3_S0_TP2_GPU2_attn_v&#45;&gt;L3_S0_TP4_GPU4_mha_ar -->
<g id="edge1016" class="edge">
<title>L3_S0_TP2_GPU2_attn_v&#45;&gt;L3_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M30583.12,-1116.37C30583.12,-1105.86 30583.12,-1097 30583.12,-1097 30583.12,-1097 32022.42,-1097 32022.42,-1097 32022.42,-1097 32022.42,-1086.26 32022.42,-1086.26"/>
<polygon fill="black" stroke="black" points="32025.92,-1086.26 32022.42,-1076.26 32018.92,-1086.26 32025.92,-1086.26"/>
</g>
<!-- L3_S0_TP2_GPU2_attn_v&#45;&gt;L3_S0_TP5_GPU5_mha_ar -->
<g id="edge1052" class="edge">
<title>L3_S0_TP2_GPU2_attn_v&#45;&gt;L3_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M30645.84,-1116.37C30645.84,-1105.86 30645.84,-1097 30645.84,-1097 30645.84,-1097 32633.02,-1097 32633.02,-1097 32633.02,-1097 32633.02,-1068.04 32633.02,-1068.04"/>
<polygon fill="black" stroke="black" points="32636.52,-1068.04 32633.02,-1058.04 32629.52,-1068.04 32636.52,-1068.04"/>
</g>
<!-- L3_S0_TP2_GPU2_attn_v&#45;&gt;L3_S0_TP6_GPU6_mha_ar -->
<g id="edge1088" class="edge">
<title>L3_S0_TP2_GPU2_attn_v&#45;&gt;L3_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M30708.56,-1116.36C30708.56,-1105.37 30708.56,-1096 30708.56,-1096 30708.56,-1096 33498.3,-1096 33498.3,-1096 33498.3,-1096 33498.3,-1081.3 33498.3,-1081.3"/>
<polygon fill="black" stroke="black" points="33501.8,-1081.3 33498.3,-1071.3 33494.8,-1081.3 33501.8,-1081.3"/>
</g>
<!-- L3_S0_TP2_GPU2_attn_v&#45;&gt;L3_S0_TP7_GPU7_mha_ar -->
<g id="edge1124" class="edge">
<title>L3_S0_TP2_GPU2_attn_v&#45;&gt;L3_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M30771.28,-1116.36C30771.28,-1105.37 30771.28,-1096 30771.28,-1096 30771.28,-1096 34318.33,-1096 34318.33,-1096 34318.33,-1096 34318.33,-1085.59 34318.33,-1085.59"/>
<polygon fill="black" stroke="black" points="34321.83,-1085.59 34318.33,-1075.59 34314.83,-1085.59 34321.83,-1085.59"/>
</g>
<!-- L3_S0_TP3_GPU3_attn_v -->
<g id="node322" class="node">
<title>L3_S0_TP3_GPU3_attn_v</title>
<polygon fill="none" stroke="black" points="31790,-1184.67 30852,-1184.67 30852,-1116.67 31790,-1116.67 31790,-1184.67"/>
<text text-anchor="middle" x="31321" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="31321" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="31321" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="31321" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L3_S0_TP3_GPU3_attn_v&#45;&gt;L3_S0_TP0_GPU0_mha_ar -->
<g id="edge873" class="edge">
<title>L3_S0_TP3_GPU3_attn_v&#45;&gt;L3_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M30885.69,-1116.41C30885.69,-1114.9 30885.69,-1114 30885.69,-1114 30885.69,-1114 29143.43,-1114 29143.43,-1114 29143.43,-1114 29143.43,-1090.88 29143.43,-1090.88"/>
<polygon fill="black" stroke="black" points="29146.93,-1090.88 29143.43,-1080.88 29139.93,-1090.88 29146.93,-1090.88"/>
</g>
<!-- L3_S0_TP3_GPU3_attn_v&#45;&gt;L3_S0_TP1_GPU1_mha_ar -->
<g id="edge909" class="edge">
<title>L3_S0_TP3_GPU3_attn_v&#45;&gt;L3_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M30919.39,-1116.41C30919.39,-1114.9 30919.39,-1114 30919.39,-1114 30919.39,-1114 30073.74,-1114 30073.74,-1114 30073.74,-1114 30073.74,-1083.77 30073.74,-1083.77"/>
<polygon fill="black" stroke="black" points="30077.24,-1083.77 30073.74,-1073.77 30070.24,-1083.77 30077.24,-1083.77"/>
</g>
<!-- L3_S0_TP3_GPU3_attn_v&#45;&gt;L3_S0_TP2_GPU2_mha_ar -->
<g id="edge945" class="edge">
<title>L3_S0_TP3_GPU3_attn_v&#45;&gt;L3_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M30953.08,-1116.51C30953.08,-1116.51 30953.08,-1070.31 30953.08,-1070.31"/>
<polygon fill="black" stroke="black" points="30956.58,-1070.31 30953.08,-1060.31 30949.58,-1070.31 30956.58,-1070.31"/>
</g>
<!-- L3_S0_TP3_GPU3_attn_v&#45;&gt;L3_S0_TP3_GPU3_mha_ar -->
<g id="edge981" class="edge">
<title>L3_S0_TP3_GPU3_attn_v&#45;&gt;L3_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M31467.64,-1116.51C31467.64,-1116.51 31467.64,-1090.27 31467.64,-1090.27"/>
<polygon fill="black" stroke="black" points="31471.14,-1090.27 31467.64,-1080.27 31464.14,-1090.27 31471.14,-1090.27"/>
</g>
<!-- L3_S0_TP3_GPU3_attn_v&#45;&gt;L3_S0_TP4_GPU4_mha_ar -->
<g id="edge1017" class="edge">
<title>L3_S0_TP3_GPU3_attn_v&#45;&gt;L3_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M31790.04,-1161C31793.1,-1161 31794.73,-1161 31794.73,-1161 31794.73,-1161 31794.73,-1016 31794.73,-1016 31794.73,-1016 31820.56,-1016 31820.56,-1016"/>
<polygon fill="black" stroke="black" points="31820.56,-1019.5 31830.56,-1016 31820.56,-1012.5 31820.56,-1019.5"/>
</g>
<!-- L3_S0_TP3_GPU3_attn_v&#45;&gt;L3_S0_TP5_GPU5_mha_ar -->
<g id="edge1053" class="edge">
<title>L3_S0_TP3_GPU3_attn_v&#45;&gt;L3_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M31741,-1184.9C31741,-1184.97 31741,-1185 31741,-1185 31741,-1185 32752,-1185 32752,-1185 32752,-1185 32752,-1083.43 32752,-1083.43"/>
<polygon fill="black" stroke="black" points="32755.5,-1083.43 32752,-1073.43 32748.5,-1083.43 32755.5,-1083.43"/>
</g>
<!-- L3_S0_TP3_GPU3_attn_v&#45;&gt;L3_S0_TP6_GPU6_mha_ar -->
<g id="edge1089" class="edge">
<title>L3_S0_TP3_GPU3_attn_v&#45;&gt;L3_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M31692,-1184.72C31692,-1190.67 31692,-1195 31692,-1195 31692,-1195 33711,-1195 33711,-1195 33711,-1195 33711,-1090.87 33711,-1090.87"/>
<polygon fill="black" stroke="black" points="33714.5,-1090.87 33711,-1080.87 33707.5,-1090.87 33714.5,-1090.87"/>
</g>
<!-- L3_S0_TP3_GPU3_attn_v&#45;&gt;L3_S0_TP7_GPU7_mha_ar -->
<g id="edge1125" class="edge">
<title>L3_S0_TP3_GPU3_attn_v&#45;&gt;L3_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M31574.92,-1116.37C31574.92,-1105.86 31574.92,-1097 31574.92,-1097 31574.92,-1097 34386.26,-1097 34386.26,-1097 34386.26,-1097 34386.26,-1089.06 34386.26,-1089.06"/>
<polygon fill="black" stroke="black" points="34389.76,-1089.06 34386.26,-1079.06 34382.76,-1089.06 34389.76,-1089.06"/>
</g>
<!-- L3_S0_TP4_GPU4_attn_v -->
<g id="node323" class="node">
<title>L3_S0_TP4_GPU4_attn_v</title>
<polygon fill="none" stroke="black" points="32746,-1184.67 31808,-1184.67 31808,-1116.67 32746,-1116.67 32746,-1184.67"/>
<text text-anchor="middle" x="32277" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="32277" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="32277" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="32277" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L3_S0_TP4_GPU4_attn_v&#45;&gt;L3_S0_TP0_GPU0_mha_ar -->
<g id="edge874" class="edge">
<title>L3_S0_TP4_GPU4_attn_v&#45;&gt;L3_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M31915.21,-1116.37C31915.21,-1105.86 31915.21,-1097 31915.21,-1097 31915.21,-1097 29211.24,-1097 29211.24,-1097 29211.24,-1097 29211.24,-1089.06 29211.24,-1089.06"/>
<polygon fill="black" stroke="black" points="29214.74,-1089.06 29211.24,-1079.06 29207.74,-1089.06 29214.74,-1089.06"/>
</g>
<!-- L3_S0_TP4_GPU4_attn_v&#45;&gt;L3_S0_TP1_GPU1_mha_ar -->
<g id="edge910" class="edge">
<title>L3_S0_TP4_GPU4_attn_v&#45;&gt;L3_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M31884.33,-1184.76C31884.33,-1192.76 31884.33,-1199 31884.33,-1199 31884.33,-1199 29890,-1199 29890,-1199 29890,-1199 29890,-1090.72 29890,-1090.72"/>
<polygon fill="black" stroke="black" points="29893.5,-1090.72 29890,-1080.72 29886.5,-1090.72 29893.5,-1090.72"/>
</g>
<!-- L3_S0_TP4_GPU4_attn_v&#45;&gt;L3_S0_TP2_GPU2_mha_ar -->
<g id="edge946" class="edge">
<title>L3_S0_TP4_GPU4_attn_v&#45;&gt;L3_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M31846.17,-1184.86C31846.17,-1187.98 31846.17,-1190 31846.17,-1190 31846.17,-1190 30847.5,-1190 30847.5,-1190 30847.5,-1190 30847.5,-1083.12 30847.5,-1083.12"/>
<polygon fill="black" stroke="black" points="30851,-1083.12 30847.5,-1073.12 30844,-1083.12 30851,-1083.12"/>
</g>
<!-- L3_S0_TP4_GPU4_attn_v&#45;&gt;L3_S0_TP3_GPU3_mha_ar -->
<g id="edge982" class="edge">
<title>L3_S0_TP4_GPU4_attn_v&#45;&gt;L3_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M31807.94,-1139C31797.96,-1139 31792.36,-1139 31792.36,-1139 31792.36,-1139 31792.36,-1048 31792.36,-1048 31792.36,-1048 31779.83,-1048 31779.83,-1048"/>
<polygon fill="black" stroke="black" points="31779.83,-1044.5 31769.83,-1048 31779.83,-1051.5 31779.83,-1044.5"/>
</g>
<!-- L3_S0_TP4_GPU4_attn_v&#45;&gt;L3_S0_TP4_GPU4_mha_ar -->
<g id="edge1018" class="edge">
<title>L3_S0_TP4_GPU4_attn_v&#45;&gt;L3_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M32129.63,-1116.51C32129.63,-1116.51 32129.63,-1090.27 32129.63,-1090.27"/>
<polygon fill="black" stroke="black" points="32133.13,-1090.27 32129.63,-1080.27 32126.13,-1090.27 32133.13,-1090.27"/>
</g>
<!-- L3_S0_TP4_GPU4_attn_v&#45;&gt;L3_S0_TP5_GPU5_mha_ar -->
<g id="edge1054" class="edge">
<title>L3_S0_TP4_GPU4_attn_v&#45;&gt;L3_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M32661.26,-1116.51C32661.26,-1116.51 32661.26,-1073.04 32661.26,-1073.04"/>
<polygon fill="black" stroke="black" points="32664.76,-1073.04 32661.26,-1063.04 32657.76,-1073.04 32664.76,-1073.04"/>
</g>
<!-- L3_S0_TP4_GPU4_attn_v&#45;&gt;L3_S0_TP6_GPU6_mha_ar -->
<g id="edge1090" class="edge">
<title>L3_S0_TP4_GPU4_attn_v&#45;&gt;L3_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M32689.51,-1116.37C32689.51,-1105.86 32689.51,-1097 32689.51,-1097 32689.51,-1097 33549.23,-1097 33549.23,-1097 33549.23,-1097 33549.23,-1085.55 33549.23,-1085.55"/>
<polygon fill="black" stroke="black" points="33552.73,-1085.55 33549.23,-1075.55 33545.73,-1085.55 33552.73,-1085.55"/>
</g>
<!-- L3_S0_TP4_GPU4_attn_v&#45;&gt;L3_S0_TP7_GPU7_mha_ar -->
<g id="edge1126" class="edge">
<title>L3_S0_TP4_GPU4_attn_v&#45;&gt;L3_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M32717.75,-1116.37C32717.75,-1105.86 32717.75,-1097 32717.75,-1097 32717.75,-1097 34454.2,-1097 34454.2,-1097 34454.2,-1097 34454.2,-1090.74 34454.2,-1090.74"/>
<polygon fill="black" stroke="black" points="34457.7,-1090.74 34454.2,-1080.74 34450.7,-1090.74 34457.7,-1090.74"/>
</g>
<!-- L3_S0_TP5_GPU5_attn_v -->
<g id="node324" class="node">
<title>L3_S0_TP5_GPU5_attn_v</title>
<polygon fill="none" stroke="black" points="33702,-1184.67 32764,-1184.67 32764,-1116.67 33702,-1116.67 33702,-1184.67"/>
<text text-anchor="middle" x="33233" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="33233" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="33233" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="33233" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L3_S0_TP5_GPU5_attn_v&#45;&gt;L3_S0_TP0_GPU0_mha_ar -->
<g id="edge875" class="edge">
<title>L3_S0_TP5_GPU5_attn_v&#45;&gt;L3_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M32834.43,-1116.37C32834.43,-1105.86 32834.43,-1097 32834.43,-1097 32834.43,-1097 29279.05,-1097 29279.05,-1097 29279.05,-1097 29279.05,-1085.55 29279.05,-1085.55"/>
<polygon fill="black" stroke="black" points="29282.55,-1085.55 29279.05,-1075.55 29275.55,-1085.55 29282.55,-1085.55"/>
</g>
<!-- L3_S0_TP5_GPU5_attn_v&#45;&gt;L3_S0_TP1_GPU1_mha_ar -->
<g id="edge911" class="edge">
<title>L3_S0_TP5_GPU5_attn_v&#45;&gt;L3_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M32904.87,-1116.37C32904.87,-1105.86 32904.87,-1097 32904.87,-1097 32904.87,-1097 30132.98,-1097 30132.98,-1097 30132.98,-1097 30132.98,-1077.81 30132.98,-1077.81"/>
<polygon fill="black" stroke="black" points="30136.48,-1077.81 30132.98,-1067.81 30129.48,-1077.81 30136.48,-1077.81"/>
</g>
<!-- L3_S0_TP5_GPU5_attn_v&#45;&gt;L3_S0_TP2_GPU2_mha_ar -->
<g id="edge947" class="edge">
<title>L3_S0_TP5_GPU5_attn_v&#45;&gt;L3_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M32841.25,-1184.76C32841.25,-1196.15 32841.25,-1206 32841.25,-1206 32841.25,-1206 30843,-1206 30843,-1206 30843,-1206 30843,-1083.68 30843,-1083.68"/>
<polygon fill="black" stroke="black" points="30846.5,-1083.68 30843,-1073.68 30839.5,-1083.68 30846.5,-1083.68"/>
</g>
<!-- L3_S0_TP5_GPU5_attn_v&#45;&gt;L3_S0_TP3_GPU3_mha_ar -->
<g id="edge983" class="edge">
<title>L3_S0_TP5_GPU5_attn_v&#45;&gt;L3_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M32975.3,-1116.37C32975.3,-1105.86 32975.3,-1097 32975.3,-1097 32975.3,-1097 31682.2,-1097 31682.2,-1097 31682.2,-1097 31682.2,-1076.3 31682.2,-1076.3"/>
<polygon fill="black" stroke="black" points="31685.7,-1076.3 31682.2,-1066.3 31678.7,-1076.3 31685.7,-1076.3"/>
</g>
<!-- L3_S0_TP5_GPU5_attn_v&#45;&gt;L3_S0_TP4_GPU4_mha_ar -->
<g id="edge1019" class="edge">
<title>L3_S0_TP5_GPU5_attn_v&#45;&gt;L3_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M33045.74,-1116.4C33045.74,-1101.77 33045.74,-1088 33045.74,-1088 33045.74,-1088 32236.84,-1088 32236.84,-1088 32236.84,-1088 32236.84,-1087.23 32236.84,-1087.23"/>
<polygon fill="black" stroke="black" points="32240.34,-1090.29 32236.84,-1080.29 32233.34,-1090.29 32240.34,-1090.29"/>
</g>
<!-- L3_S0_TP5_GPU5_attn_v&#45;&gt;L3_S0_TP5_GPU5_mha_ar -->
<g id="edge1055" class="edge">
<title>L3_S0_TP5_GPU5_attn_v&#45;&gt;L3_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M33116.17,-1116.51C33116.17,-1116.51 33116.17,-1085.92 33116.17,-1085.92"/>
<polygon fill="black" stroke="black" points="33119.67,-1085.92 33116.17,-1075.92 33112.67,-1085.92 33119.67,-1085.92"/>
</g>
<!-- L3_S0_TP5_GPU5_attn_v&#45;&gt;L3_S0_TP6_GPU6_mha_ar -->
<g id="edge1091" class="edge">
<title>L3_S0_TP5_GPU5_attn_v&#45;&gt;L3_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M33600.15,-1116.51C33600.15,-1116.51 33600.15,-1088.52 33600.15,-1088.52"/>
<polygon fill="black" stroke="black" points="33603.65,-1088.52 33600.15,-1078.52 33596.65,-1088.52 33603.65,-1088.52"/>
</g>
<!-- L3_S0_TP5_GPU5_attn_v&#45;&gt;L3_S0_TP7_GPU7_mha_ar -->
<g id="edge1127" class="edge">
<title>L3_S0_TP5_GPU5_attn_v&#45;&gt;L3_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M33651.08,-1116.37C33651.08,-1105.86 33651.08,-1097 33651.08,-1097 33651.08,-1097 34522.13,-1097 34522.13,-1097 34522.13,-1097 34522.13,-1090.74 34522.13,-1090.74"/>
<polygon fill="black" stroke="black" points="34525.63,-1090.74 34522.13,-1080.74 34518.63,-1090.74 34525.63,-1090.74"/>
</g>
<!-- L3_S0_TP6_GPU6_attn_v -->
<g id="node325" class="node">
<title>L3_S0_TP6_GPU6_attn_v</title>
<polygon fill="none" stroke="black" points="34658,-1184.67 33720,-1184.67 33720,-1116.67 34658,-1116.67 34658,-1184.67"/>
<text text-anchor="middle" x="34189" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="34189" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="34189" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="34189" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L3_S0_TP6_GPU6_attn_v&#45;&gt;L3_S0_TP0_GPU0_mha_ar -->
<g id="edge876" class="edge">
<title>L3_S0_TP6_GPU6_attn_v&#45;&gt;L3_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M33767.06,-1116.37C33767.06,-1105.86 33767.06,-1097 33767.06,-1097 33767.06,-1097 29346.86,-1097 29346.86,-1097 29346.86,-1097 29346.86,-1079.68 29346.86,-1079.68"/>
<polygon fill="black" stroke="black" points="29350.36,-1079.68 29346.86,-1069.68 29343.36,-1079.68 29350.36,-1079.68"/>
</g>
<!-- L3_S0_TP6_GPU6_attn_v&#45;&gt;L3_S0_TP1_GPU1_mha_ar -->
<g id="edge912" class="edge">
<title>L3_S0_TP6_GPU6_attn_v&#45;&gt;L3_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M33814.12,-1116.37C33814.12,-1105.86 33814.12,-1097 33814.12,-1097 33814.12,-1097 30192.23,-1097 30192.23,-1097 30192.23,-1097 30192.23,-1068.78 30192.23,-1068.78"/>
<polygon fill="black" stroke="black" points="30195.73,-1068.78 30192.23,-1058.78 30188.73,-1068.78 30195.73,-1068.78"/>
</g>
<!-- L3_S0_TP6_GPU6_attn_v&#45;&gt;L3_S0_TP2_GPU2_mha_ar -->
<g id="edge948" class="edge">
<title>L3_S0_TP6_GPU6_attn_v&#45;&gt;L3_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M33861.18,-1116.37C33861.18,-1105.86 33861.18,-1097 33861.18,-1097 33861.18,-1097 30986.78,-1097 30986.78,-1097 30986.78,-1097 30986.78,-1062.61 30986.78,-1062.61"/>
<polygon fill="black" stroke="black" points="30990.28,-1062.61 30986.78,-1052.61 30983.28,-1062.61 30990.28,-1062.61"/>
</g>
<!-- L3_S0_TP6_GPU6_attn_v&#45;&gt;L3_S0_TP3_GPU3_mha_ar -->
<g id="edge984" class="edge">
<title>L3_S0_TP6_GPU6_attn_v&#45;&gt;L3_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M34105.5,-1116.5C34105.5,-1063.87 34105.5,-969 34105.5,-969 34105.5,-969 31760.82,-969 31760.82,-969 31760.82,-969 31760.82,-1003.85 31760.82,-1003.85"/>
<polygon fill="black" stroke="black" points="31757.32,-1003.85 31760.82,-1013.85 31764.32,-1003.85 31757.32,-1003.85"/>
</g>
<!-- L3_S0_TP6_GPU6_attn_v&#45;&gt;L3_S0_TP4_GPU4_mha_ar -->
<g id="edge1020" class="edge">
<title>L3_S0_TP6_GPU6_attn_v&#45;&gt;L3_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M33908.24,-1116.4C33908.24,-1101.77 33908.24,-1088 33908.24,-1088 33908.24,-1088 32344.05,-1088 32344.05,-1088 32344.05,-1088 32344.05,-1086.25 32344.05,-1086.25"/>
<polygon fill="black" stroke="black" points="32347.55,-1086.25 32344.05,-1076.25 32340.55,-1086.25 32347.55,-1086.25"/>
</g>
<!-- L3_S0_TP6_GPU6_attn_v&#45;&gt;L3_S0_TP5_GPU5_mha_ar -->
<g id="edge1056" class="edge">
<title>L3_S0_TP6_GPU6_attn_v&#45;&gt;L3_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M33955.3,-1116.6C33955.3,-1101.46 33955.3,-1087 33955.3,-1087 33955.3,-1087 33186.61,-1087 33186.61,-1087 33186.61,-1087 33186.61,-1080.38 33186.61,-1080.38"/>
<polygon fill="black" stroke="black" points="33190.11,-1080.38 33186.61,-1070.38 33183.11,-1080.38 33190.11,-1080.38"/>
</g>
<!-- L3_S0_TP6_GPU6_attn_v&#45;&gt;L3_S0_TP6_GPU6_mha_ar -->
<g id="edge1092" class="edge">
<title>L3_S0_TP6_GPU6_attn_v&#45;&gt;L3_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M34002.36,-1116.51C34002.36,-1116.51 34002.36,-1074.64 34002.36,-1074.64"/>
<polygon fill="black" stroke="black" points="34005.86,-1074.64 34002.36,-1064.64 33998.86,-1074.64 34005.86,-1074.64"/>
</g>
<!-- L3_S0_TP6_GPU6_attn_v&#45;&gt;L3_S0_TP7_GPU7_mha_ar -->
<g id="edge1128" class="edge">
<title>L3_S0_TP6_GPU6_attn_v&#45;&gt;L3_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M34590.07,-1116.51C34590.07,-1116.51 34590.07,-1088.96 34590.07,-1088.96"/>
<polygon fill="black" stroke="black" points="34593.57,-1088.96 34590.07,-1078.96 34586.57,-1088.96 34593.57,-1088.96"/>
</g>
<!-- L3_S0_TP7_GPU7_attn_v -->
<g id="node326" class="node">
<title>L3_S0_TP7_GPU7_attn_v</title>
<polygon fill="none" stroke="black" points="35614,-1184.67 34676,-1184.67 34676,-1116.67 35614,-1116.67 35614,-1184.67"/>
<text text-anchor="middle" x="35145" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="35145" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="35145" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="35145" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L3_S0_TP7_GPU7_attn_v&#45;&gt;L3_S0_TP0_GPU0_mha_ar -->
<g id="edge877" class="edge">
<title>L3_S0_TP7_GPU7_attn_v&#45;&gt;L3_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M34707.58,-1116.37C34707.58,-1105.86 34707.58,-1097 34707.58,-1097 34707.58,-1097 29414.66,-1097 29414.66,-1097 29414.66,-1097 29414.66,-1070.28 29414.66,-1070.28"/>
<polygon fill="black" stroke="black" points="29418.16,-1070.28 29414.66,-1060.28 29411.16,-1070.28 29418.16,-1070.28"/>
</g>
<!-- L3_S0_TP7_GPU7_attn_v&#45;&gt;L3_S0_TP1_GPU1_mha_ar -->
<g id="edge913" class="edge">
<title>L3_S0_TP7_GPU7_attn_v&#45;&gt;L3_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M34687.33,-1184.73C34687.33,-1201.43 34687.33,-1218 34687.33,-1218 34687.33,-1218 29884,-1218 29884,-1218 29884,-1218 29884,-1090.81 29884,-1090.81"/>
<polygon fill="black" stroke="black" points="29887.5,-1090.81 29884,-1080.81 29880.5,-1090.82 29887.5,-1090.81"/>
</g>
<!-- L3_S0_TP7_GPU7_attn_v&#45;&gt;L3_S0_TP2_GPU2_mha_ar -->
<g id="edge949" class="edge">
<title>L3_S0_TP7_GPU7_attn_v&#45;&gt;L3_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M34681.67,-1184.75C34681.67,-1199.3 34681.67,-1213 34681.67,-1213 34681.67,-1213 30838.5,-1213 30838.5,-1213 30838.5,-1213 30838.5,-1083.97 30838.5,-1083.97"/>
<polygon fill="black" stroke="black" points="30842,-1083.97 30838.5,-1073.97 30835,-1083.97 30842,-1083.97"/>
</g>
<!-- L3_S0_TP7_GPU7_attn_v&#45;&gt;L3_S0_TP3_GPU3_mha_ar -->
<g id="edge985" class="edge">
<title>L3_S0_TP7_GPU7_attn_v&#45;&gt;L3_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M34901.49,-1116.5C34901.49,-1063.87 34901.49,-969 34901.49,-969 34901.49,-969 31732.16,-969 31732.16,-969 31732.16,-969 31732.16,-996.72 31732.16,-996.72"/>
<polygon fill="black" stroke="black" points="31728.66,-996.72 31732.16,-1006.72 31735.66,-996.72 31728.66,-996.72"/>
</g>
<!-- L3_S0_TP7_GPU7_attn_v&#45;&gt;L3_S0_TP4_GPU4_mha_ar -->
<g id="edge1021" class="edge">
<title>L3_S0_TP7_GPU7_attn_v&#45;&gt;L3_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M34739.16,-1116.4C34739.16,-1101.77 34739.16,-1088 34739.16,-1088 34739.16,-1088 32451.26,-1088 32451.26,-1088 32451.26,-1088 32451.26,-1076.42 32451.26,-1076.42"/>
<polygon fill="black" stroke="black" points="32454.76,-1076.42 32451.26,-1066.42 32447.76,-1076.42 32454.76,-1076.42"/>
</g>
<!-- L3_S0_TP7_GPU7_attn_v&#45;&gt;L3_S0_TP5_GPU5_mha_ar -->
<g id="edge1057" class="edge">
<title>L3_S0_TP7_GPU7_attn_v&#45;&gt;L3_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M34770.74,-1116.6C34770.74,-1101.46 34770.74,-1087 34770.74,-1087 34770.74,-1087 33257.04,-1087 33257.04,-1087 33257.04,-1087 33257.04,-1070.75 33257.04,-1070.75"/>
<polygon fill="black" stroke="black" points="33260.54,-1070.75 33257.04,-1060.75 33253.54,-1070.75 33260.54,-1070.75"/>
</g>
<!-- L3_S0_TP7_GPU7_attn_v&#45;&gt;L3_S0_TP6_GPU6_mha_ar -->
<g id="edge1093" class="edge">
<title>L3_S0_TP7_GPU7_attn_v&#45;&gt;L3_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M34802.32,-1116.6C34802.32,-1101.46 34802.32,-1087 34802.32,-1087 34802.32,-1087 34049.41,-1087 34049.41,-1087 34049.41,-1087 34049.41,-1065.98 34049.41,-1065.98"/>
<polygon fill="black" stroke="black" points="34052.91,-1065.98 34049.41,-1055.98 34045.91,-1065.98 34052.91,-1065.98"/>
</g>
<!-- L3_S0_TP7_GPU7_attn_v&#45;&gt;L3_S0_TP7_GPU7_mha_ar -->
<g id="edge1129" class="edge">
<title>L3_S0_TP7_GPU7_attn_v&#45;&gt;L3_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M34833.89,-1116.51C34833.89,-1116.51 34833.89,-1061.95 34833.89,-1061.95"/>
<polygon fill="black" stroke="black" points="34837.39,-1061.95 34833.89,-1051.95 34830.39,-1061.95 34837.39,-1061.95"/>
</g>
<!-- L3_S0_TP0_GPU0_gate -->
<g id="node328" class="node">
<title>L3_S0_TP0_GPU0_gate</title>
<polygon fill="none" stroke="black" points="28555.56,-844.5 27713.15,-844.5 27496.44,-708.5 28338.85,-708.5 28555.56,-844.5"/>
<text text-anchor="middle" x="28026" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="28026" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="28026" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="28026" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L3_S0_TP0_GPU0_mha_res&#45;&gt;L3_S0_TP0_GPU0_gate -->
<g id="edge879" class="edge">
<title>L3_S0_TP0_GPU0_mha_res&#45;&gt;L3_S0_TP0_GPU0_gate</title>
<path fill="none" stroke="black" d="M28026,-880.39C28026,-880.39 28026,-854.73 28026,-854.73"/>
<polygon fill="black" stroke="black" points="28029.5,-854.73 28026,-844.73 28022.5,-854.73 28029.5,-854.73"/>
</g>
<!-- L3_S0_TP0_GPU0_moe_res -->
<g id="node346" class="node">
<title>L3_S0_TP0_GPU0_moe_res</title>
<polygon fill="none" stroke="black" points="28595,-436.33 27775,-436.33 27775,-368.33 28595,-368.33 28595,-436.33"/>
<text text-anchor="middle" x="28185" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="28185" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="28185" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="28185" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP0_GPU0_mha_res&#45;&gt;L3_S0_TP0_GPU0_moe_res -->
<g id="edge899" class="edge">
<title>L3_S0_TP0_GPU0_mha_res&#45;&gt;L3_S0_TP0_GPU0_moe_res</title>
<path fill="none" stroke="black" d="M28469.8,-925C28524.67,-925 28561.93,-925 28561.93,-925 28561.93,-925 28561.93,-681 28561.93,-681 28561.93,-681 28529.5,-681 28529.5,-681 28529.5,-681 28529.5,-446.5 28529.5,-446.5"/>
<polygon fill="black" stroke="black" points="28533,-446.5 28529.5,-436.5 28526,-446.5 28533,-446.5"/>
</g>
<!-- L3_S0_TP0_GPU0_expert0 -->
<g id="node329" class="node">
<title>L3_S0_TP0_GPU0_expert0</title>
<polygon fill="none" stroke="black" points="28520.5,-672.5 28071.5,-672.5 28071.5,-604.5 28520.5,-604.5 28520.5,-672.5"/>
<text text-anchor="middle" x="28296" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="28296" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="28296" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="28296" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L3_S0_TP0_GPU0_gate&#45;&gt;L3_S0_TP0_GPU0_expert0 -->
<g id="edge880" class="edge">
<title>L3_S0_TP0_GPU0_gate&#45;&gt;L3_S0_TP0_GPU0_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M28296,-708.31C28296,-708.31 28296,-682.71 28296,-682.71"/>
<polygon fill="black" stroke="black" points="28299.5,-682.71 28296,-672.71 28292.5,-682.71 28299.5,-682.71"/>
</g>
<!-- L3_S0_TP0_GPU0_expert1 -->
<g id="node330" class="node">
<title>L3_S0_TP0_GPU0_expert1</title>
<polygon fill="none" stroke="black" points="28987.5,-672.5 28538.5,-672.5 28538.5,-604.5 28987.5,-604.5 28987.5,-672.5"/>
<text text-anchor="middle" x="28763" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="28763" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="28763" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="28763" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L3_S0_TP0_GPU0_gate&#45;&gt;L3_S0_TP0_GPU0_expert1 -->
<g id="edge881" class="edge">
<title>L3_S0_TP0_GPU0_gate&#45;&gt;L3_S0_TP0_GPU0_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M28547.14,-776.4C28547.14,-776.4 28547.14,-682.74 28547.14,-682.74"/>
<polygon fill="black" stroke="black" points="28550.64,-682.74 28547.14,-672.74 28543.64,-682.74 28550.64,-682.74"/>
</g>
<!-- L3_S0_TP0_GPU0_moe_ar -->
<g id="node331" class="node">
<title>L3_S0_TP0_GPU0_moe_ar</title>
<ellipse fill="none" stroke="black" cx="29393" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="29393" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="29393" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="29393" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="29393" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP0_GPU0_expert0&#45;&gt;L3_S0_TP0_GPU0_moe_ar -->
<g id="edge882" class="edge">
<title>L3_S0_TP0_GPU0_expert0&#45;&gt;L3_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M28470.61,-604.37C28470.61,-563.08 28470.61,-499 28470.61,-499 28470.61,-499 29083.53,-499 29083.53,-499"/>
<polygon fill="black" stroke="black" points="29083.53,-502.5 29093.53,-499 29083.53,-495.5 29083.53,-502.5"/>
</g>
<!-- L3_S0_TP1_GPU1_moe_ar -->
<g id="node355" class="node">
<title>L3_S0_TP1_GPU1_moe_ar</title>
<ellipse fill="none" stroke="black" cx="30080" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="30080" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="30080" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="30080" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="30080" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP0_GPU0_expert0&#45;&gt;L3_S0_TP1_GPU1_moe_ar -->
<g id="edge918" class="edge">
<title>L3_S0_TP0_GPU0_expert0&#45;&gt;L3_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M28420.72,-604.36C28420.72,-594.33 28420.72,-586 28420.72,-586 28420.72,-586 29765.09,-586 29765.09,-586 29765.09,-586 29765.09,-546.63 29765.09,-546.63"/>
<polygon fill="black" stroke="black" points="29768.59,-546.63 29765.09,-536.63 29761.59,-546.63 29768.59,-546.63"/>
</g>
<!-- L3_S0_TP2_GPU2_moe_ar -->
<g id="node365" class="node">
<title>L3_S0_TP2_GPU2_moe_ar</title>
<ellipse fill="none" stroke="black" cx="30767" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="30767" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="30767" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="30767" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="30767" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP0_GPU0_expert0&#45;&gt;L3_S0_TP2_GPU2_moe_ar -->
<g id="edge954" class="edge">
<title>L3_S0_TP0_GPU0_expert0&#45;&gt;L3_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M28370.83,-604.36C28370.83,-551.78 28370.83,-457 28370.83,-457 28370.83,-457 30521.69,-457 30521.69,-457 30521.69,-457 30521.69,-477.59 30521.69,-477.59"/>
<polygon fill="black" stroke="black" points="30518.19,-477.59 30521.69,-487.59 30525.19,-477.59 30518.19,-477.59"/>
</g>
<!-- L3_S0_TP3_GPU3_moe_ar -->
<g id="node375" class="node">
<title>L3_S0_TP3_GPU3_moe_ar</title>
<ellipse fill="none" stroke="black" cx="31454" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="31454" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="31454" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="31454" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="31454" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP0_GPU0_expert0&#45;&gt;L3_S0_TP3_GPU3_moe_ar -->
<g id="edge990" class="edge">
<title>L3_S0_TP0_GPU0_expert0&#45;&gt;L3_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M28320.94,-604.17C28320.94,-551.31 28320.94,-456 28320.94,-456 28320.94,-456 31316.36,-456 31316.36,-456 31316.36,-456 31316.36,-466.38 31316.36,-466.38"/>
<polygon fill="black" stroke="black" points="31312.86,-466.38 31316.36,-476.38 31319.86,-466.38 31312.86,-466.38"/>
</g>
<!-- L3_S0_TP4_GPU4_moe_ar -->
<g id="node385" class="node">
<title>L3_S0_TP4_GPU4_moe_ar</title>
<ellipse fill="none" stroke="black" cx="32141" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="32141" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="32141" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="32141" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="32141" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP0_GPU0_expert0&#45;&gt;L3_S0_TP4_GPU4_moe_ar -->
<g id="edge1026" class="edge">
<title>L3_S0_TP0_GPU0_expert0&#45;&gt;L3_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M28271.06,-604.17C28271.06,-551.31 28271.06,-456 28271.06,-456 28271.06,-456 32144.23,-456 32144.23,-456 32144.23,-456 32144.23,-462.25 32144.23,-462.25"/>
<polygon fill="black" stroke="black" points="32140.73,-462.25 32144.23,-472.25 32147.73,-462.25 32140.73,-462.25"/>
</g>
<!-- L3_S0_TP5_GPU5_moe_ar -->
<g id="node395" class="node">
<title>L3_S0_TP5_GPU5_moe_ar</title>
<ellipse fill="none" stroke="black" cx="32828" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="32828" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="32828" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="32828" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="32828" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP0_GPU0_expert0&#45;&gt;L3_S0_TP5_GPU5_moe_ar -->
<g id="edge1062" class="edge">
<title>L3_S0_TP0_GPU0_expert0&#45;&gt;L3_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M28221.17,-604.17C28221.17,-551.31 28221.17,-456 28221.17,-456 28221.17,-456 32605.11,-456 32605.11,-456 32605.11,-456 32605.11,-474.44 32605.11,-474.44"/>
<polygon fill="black" stroke="black" points="32601.61,-474.44 32605.11,-484.44 32608.61,-474.44 32601.61,-474.44"/>
</g>
<!-- L3_S0_TP6_GPU6_moe_ar -->
<g id="node405" class="node">
<title>L3_S0_TP6_GPU6_moe_ar</title>
<ellipse fill="none" stroke="black" cx="33515" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="33515" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="33515" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="33515" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="33515" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP0_GPU0_expert0&#45;&gt;L3_S0_TP6_GPU6_moe_ar -->
<g id="edge1098" class="edge">
<title>L3_S0_TP0_GPU0_expert0&#45;&gt;L3_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M28171.28,-604.17C28171.28,-551.31 28171.28,-456 28171.28,-456 28171.28,-456 33502.18,-456 33502.18,-456 33502.18,-456 33502.18,-462.25 33502.18,-462.25"/>
<polygon fill="black" stroke="black" points="33498.68,-462.25 33502.18,-472.25 33505.68,-462.25 33498.68,-462.25"/>
</g>
<!-- L3_S0_TP7_GPU7_moe_ar -->
<g id="node415" class="node">
<title>L3_S0_TP7_GPU7_moe_ar</title>
<ellipse fill="none" stroke="black" cx="34202" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="34202" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="34202" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="34202" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="34202" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP0_GPU0_expert0&#45;&gt;L3_S0_TP7_GPU7_moe_ar -->
<g id="edge1134" class="edge">
<title>L3_S0_TP0_GPU0_expert0&#45;&gt;L3_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M28121.39,-604.48C28121.39,-550.92 28121.39,-453 28121.39,-453 28121.39,-453 33999.18,-453 33999.18,-453 33999.18,-453 33999.18,-471.98 33999.18,-471.98"/>
<polygon fill="black" stroke="black" points="33995.68,-471.98 33999.18,-481.98 34002.68,-471.98 33995.68,-471.98"/>
</g>
<!-- L3_S0_TP0_GPU0_expert1&#45;&gt;L3_S0_TP0_GPU0_moe_ar -->
<g id="edge883" class="edge">
<title>L3_S0_TP0_GPU0_expert1&#45;&gt;L3_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M28951.44,-604.21C28951.44,-567.05 28951.44,-513 28951.44,-513 28951.44,-513 29052.29,-513 29052.29,-513"/>
<polygon fill="black" stroke="black" points="29052.29,-516.5 29062.29,-513 29052.29,-509.5 29052.29,-516.5"/>
</g>
<!-- L3_S0_TP0_GPU0_expert1&#45;&gt;L3_S0_TP1_GPU1_moe_ar -->
<g id="edge919" class="edge">
<title>L3_S0_TP0_GPU0_expert1&#45;&gt;L3_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M28735.06,-604.36C28735.06,-594.33 28735.06,-586 28735.06,-586 28735.06,-586 29784.64,-586 29784.64,-586 29784.64,-586 29784.64,-552.99 29784.64,-552.99"/>
<polygon fill="black" stroke="black" points="29788.14,-552.99 29784.64,-542.99 29781.14,-552.99 29788.14,-552.99"/>
</g>
<!-- L3_S0_TP0_GPU0_expert1&#45;&gt;L3_S0_TP2_GPU2_moe_ar -->
<g id="edge955" class="edge">
<title>L3_S0_TP0_GPU0_expert1&#45;&gt;L3_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M28771.12,-604.36C28771.12,-594.33 28771.12,-586 28771.12,-586 28771.12,-586 30479.53,-586 30479.53,-586 30479.53,-586 30479.53,-555.21 30479.53,-555.21"/>
<polygon fill="black" stroke="black" points="30483.03,-555.21 30479.53,-545.21 30476.03,-555.21 30483.03,-555.21"/>
</g>
<!-- L3_S0_TP0_GPU0_expert1&#45;&gt;L3_S0_TP3_GPU3_moe_ar -->
<g id="edge991" class="edge">
<title>L3_S0_TP0_GPU0_expert1&#45;&gt;L3_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M28780.86,-672.85C28780.86,-686.93 28780.86,-700 28780.86,-700 28780.86,-700 31331.5,-700 31331.5,-700 31331.5,-700 31331.5,-575.27 31331.5,-575.27"/>
<polygon fill="black" stroke="black" points="31335,-575.27 31331.5,-565.27 31328,-575.27 31335,-575.27"/>
</g>
<!-- L3_S0_TP0_GPU0_expert1&#45;&gt;L3_S0_TP4_GPU4_moe_ar -->
<g id="edge1027" class="edge">
<title>L3_S0_TP0_GPU0_expert1&#45;&gt;L3_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M28915.38,-604.44C28915.38,-553.66 28915.38,-464 28915.38,-464 28915.38,-464 32033.82,-464 32033.82,-464 32033.82,-464 32033.82,-465.06 32033.82,-465.06"/>
<polygon fill="black" stroke="black" points="32030.32,-464.61 32033.82,-474.61 32037.32,-464.61 32030.32,-464.61"/>
</g>
<!-- L3_S0_TP0_GPU0_expert1&#45;&gt;L3_S0_TP5_GPU5_moe_ar -->
<g id="edge1063" class="edge">
<title>L3_S0_TP0_GPU0_expert1&#45;&gt;L3_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M28879.31,-604.44C28879.31,-553.66 28879.31,-464 28879.31,-464 28879.31,-464 32577.22,-464 32577.22,-464 32577.22,-464 32577.22,-478.58 32577.22,-478.58"/>
<polygon fill="black" stroke="black" points="32573.72,-478.58 32577.22,-488.58 32580.72,-478.58 32573.72,-478.58"/>
</g>
<!-- L3_S0_TP0_GPU0_expert1&#45;&gt;L3_S0_TP6_GPU6_moe_ar -->
<g id="edge1099" class="edge">
<title>L3_S0_TP0_GPU0_expert1&#45;&gt;L3_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M28843.25,-604.44C28843.25,-553.66 28843.25,-464 28843.25,-464 28843.25,-464 33341.36,-464 33341.36,-464 33341.36,-464 33341.36,-469.12 33341.36,-469.12"/>
<polygon fill="black" stroke="black" points="33337.86,-469.12 33341.36,-479.12 33344.86,-469.12 33337.86,-469.12"/>
</g>
<!-- L3_S0_TP0_GPU0_expert1&#45;&gt;L3_S0_TP7_GPU7_moe_ar -->
<g id="edge1135" class="edge">
<title>L3_S0_TP0_GPU0_expert1&#45;&gt;L3_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M28807.19,-604.44C28807.19,-594.86 28807.19,-587 28807.19,-587 28807.19,-587 33893.23,-587 33893.23,-587 33893.23,-587 33893.23,-548.96 33893.23,-548.96"/>
<polygon fill="black" stroke="black" points="33896.73,-548.96 33893.23,-538.96 33889.73,-548.96 33896.73,-548.96"/>
</g>
<!-- L3_S0_TP0_GPU0_moe_ar&#45;&gt;L3_S0_TP0_GPU0_moe_res -->
<g id="edge898" class="edge">
<title>L3_S0_TP0_GPU0_moe_ar&#45;&gt;L3_S0_TP0_GPU0_moe_res</title>
<path fill="none" stroke="black" d="M29159.27,-486C28914.95,-486 28566.75,-486 28566.75,-486 28566.75,-486 28566.75,-446.36 28566.75,-446.36"/>
<polygon fill="black" stroke="black" points="28570.25,-446.36 28566.75,-436.36 28563.25,-446.36 28570.25,-446.36"/>
</g>
<!-- L3_S0_TP1_GPU1_expert0 -->
<g id="node332" class="node">
<title>L3_S0_TP1_GPU1_expert0</title>
<polygon fill="none" stroke="black" points="29454.5,-672.5 29005.5,-672.5 29005.5,-604.5 29454.5,-604.5 29454.5,-672.5"/>
<text text-anchor="middle" x="29230" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="29230" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="29230" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="29230" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L3_S0_TP1_GPU1_expert0&#45;&gt;L3_S0_TP0_GPU0_moe_ar -->
<g id="edge884" class="edge">
<title>L3_S0_TP1_GPU1_expert0&#45;&gt;L3_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M29115.1,-604.34C29115.1,-604.34 29115.1,-557.38 29115.1,-557.38"/>
<polygon fill="black" stroke="black" points="29118.6,-557.38 29115.1,-547.38 29111.6,-557.38 29118.6,-557.38"/>
</g>
<!-- L3_S0_TP1_GPU1_expert0&#45;&gt;L3_S0_TP1_GPU1_moe_ar -->
<g id="edge920" class="edge">
<title>L3_S0_TP1_GPU1_expert0&#45;&gt;L3_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M29171.67,-604.36C29171.67,-594.33 29171.67,-586 29171.67,-586 29171.67,-586 29804.19,-586 29804.19,-586 29804.19,-586 29804.19,-557.85 29804.19,-557.85"/>
<polygon fill="black" stroke="black" points="29807.69,-557.85 29804.19,-547.85 29800.69,-557.85 29807.69,-557.85"/>
</g>
<!-- L3_S0_TP1_GPU1_expert0&#45;&gt;L3_S0_TP2_GPU2_moe_ar -->
<g id="edge956" class="edge">
<title>L3_S0_TP1_GPU1_expert0&#45;&gt;L3_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M29228.24,-604.36C29228.24,-594.33 29228.24,-586 29228.24,-586 29228.24,-586 30526.53,-586 30526.53,-586 30526.53,-586 30526.53,-563.98 30526.53,-563.98"/>
<polygon fill="black" stroke="black" points="30530.03,-563.98 30526.53,-553.98 30523.03,-563.98 30530.03,-563.98"/>
</g>
<!-- L3_S0_TP1_GPU1_expert0&#45;&gt;L3_S0_TP3_GPU3_moe_ar -->
<g id="edge992" class="edge">
<title>L3_S0_TP1_GPU1_expert0&#45;&gt;L3_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M29284.8,-604.36C29284.8,-594.33 29284.8,-586 29284.8,-586 29284.8,-586 31144.91,-586 31144.91,-586 31144.91,-586 31144.91,-549.03 31144.91,-549.03"/>
<polygon fill="black" stroke="black" points="31148.41,-549.03 31144.91,-539.03 31141.41,-549.03 31148.41,-549.03"/>
</g>
<!-- L3_S0_TP1_GPU1_expert0&#45;&gt;L3_S0_TP4_GPU4_moe_ar -->
<g id="edge1028" class="edge">
<title>L3_S0_TP1_GPU1_expert0&#45;&gt;L3_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M29040.86,-604.44C29040.86,-553.66 29040.86,-464 29040.86,-464 29040.86,-464 31923.41,-464 31923.41,-464 31923.41,-464 31923.41,-473.73 31923.41,-473.73"/>
<polygon fill="black" stroke="black" points="31919.91,-473.73 31923.41,-483.73 31926.91,-473.73 31919.91,-473.73"/>
</g>
<!-- L3_S0_TP1_GPU1_expert0&#45;&gt;L3_S0_TP5_GPU5_moe_ar -->
<g id="edge1064" class="edge">
<title>L3_S0_TP1_GPU1_expert0&#45;&gt;L3_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M29023.18,-604.44C29023.18,-553.66 29023.18,-464 29023.18,-464 29023.18,-464 32549.32,-464 32549.32,-464 32549.32,-464 32549.32,-483.53 32549.32,-483.53"/>
<polygon fill="black" stroke="black" points="32545.82,-483.53 32549.32,-493.53 32552.82,-483.53 32545.82,-483.53"/>
</g>
<!-- L3_S0_TP1_GPU1_expert0&#45;&gt;L3_S0_TP6_GPU6_moe_ar -->
<g id="edge1100" class="edge">
<title>L3_S0_TP1_GPU1_expert0&#45;&gt;L3_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M29341.37,-604.44C29341.37,-594.86 29341.37,-587 29341.37,-587 29341.37,-587 33694.83,-587 33694.83,-587 33694.83,-587 33694.83,-571.07 33694.83,-571.07"/>
<polygon fill="black" stroke="black" points="33698.33,-571.07 33694.83,-561.07 33691.33,-571.07 33698.33,-571.07"/>
</g>
<!-- L3_S0_TP1_GPU1_expert0&#45;&gt;L3_S0_TP7_GPU7_moe_ar -->
<g id="edge1136" class="edge">
<title>L3_S0_TP1_GPU1_expert0&#45;&gt;L3_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M29397.93,-604.44C29397.93,-594.86 29397.93,-587 29397.93,-587 29397.93,-587 33918.93,-587 33918.93,-587 33918.93,-587 33918.93,-556.35 33918.93,-556.35"/>
<polygon fill="black" stroke="black" points="33922.43,-556.35 33918.93,-546.35 33915.43,-556.35 33922.43,-556.35"/>
</g>
<!-- L3_S0_TP1_GPU1_expert1 -->
<g id="node333" class="node">
<title>L3_S0_TP1_GPU1_expert1</title>
<polygon fill="none" stroke="black" points="29921.5,-672.5 29472.5,-672.5 29472.5,-604.5 29921.5,-604.5 29921.5,-672.5"/>
<text text-anchor="middle" x="29697" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="29697" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="29697" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="29697" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L3_S0_TP1_GPU1_expert1&#45;&gt;L3_S0_TP0_GPU0_moe_ar -->
<g id="edge885" class="edge">
<title>L3_S0_TP1_GPU1_expert1&#45;&gt;L3_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M29498,-604.34C29498,-604.34 29498,-576.36 29498,-576.36"/>
<polygon fill="black" stroke="black" points="29501.5,-576.36 29498,-566.36 29494.5,-576.36 29501.5,-576.36"/>
</g>
<!-- L3_S0_TP1_GPU1_expert1&#45;&gt;L3_S0_TP1_GPU1_moe_ar -->
<g id="edge921" class="edge">
<title>L3_S0_TP1_GPU1_expert1&#45;&gt;L3_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M29823.74,-604.34C29823.74,-604.34 29823.74,-561.67 29823.74,-561.67"/>
<polygon fill="black" stroke="black" points="29827.24,-561.67 29823.74,-551.67 29820.24,-561.67 29827.24,-561.67"/>
</g>
<!-- L3_S0_TP1_GPU1_expert1&#45;&gt;L3_S0_TP2_GPU2_moe_ar -->
<g id="edge957" class="edge">
<title>L3_S0_TP1_GPU1_expert1&#45;&gt;L3_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M29843.29,-604.36C29843.29,-594.33 29843.29,-586 29843.29,-586 29843.29,-586 30573.53,-586 30573.53,-586 30573.53,-586 30573.53,-569.7 30573.53,-569.7"/>
<polygon fill="black" stroke="black" points="30577.03,-569.7 30573.53,-559.7 30570.03,-569.7 30577.03,-569.7"/>
</g>
<!-- L3_S0_TP1_GPU1_expert1&#45;&gt;L3_S0_TP3_GPU3_moe_ar -->
<g id="edge993" class="edge">
<title>L3_S0_TP1_GPU1_expert1&#45;&gt;L3_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M29862.85,-604.36C29862.85,-594.33 29862.85,-586 29862.85,-586 29862.85,-586 31170.28,-586 31170.28,-586 31170.28,-586 31170.28,-555.96 31170.28,-555.96"/>
<polygon fill="black" stroke="black" points="31173.78,-555.96 31170.28,-545.96 31166.78,-555.96 31173.78,-555.96"/>
</g>
<!-- L3_S0_TP1_GPU1_expert1&#45;&gt;L3_S0_TP4_GPU4_moe_ar -->
<g id="edge1029" class="edge">
<title>L3_S0_TP1_GPU1_expert1&#45;&gt;L3_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M29882.4,-604.36C29882.4,-594.33 29882.4,-586 29882.4,-586 29882.4,-586 31852.4,-586 31852.4,-586 31852.4,-586 31852.4,-554.84 31852.4,-554.84"/>
<polygon fill="black" stroke="black" points="31855.9,-554.84 31852.4,-544.84 31848.9,-554.84 31855.9,-554.84"/>
</g>
<!-- L3_S0_TP1_GPU1_expert1&#45;&gt;L3_S0_TP5_GPU5_moe_ar -->
<g id="edge1065" class="edge">
<title>L3_S0_TP1_GPU1_expert1&#45;&gt;L3_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M29736.5,-604.4C29736.5,-555.17 29736.5,-470 29736.5,-470 29736.5,-470 32521.43,-470 32521.43,-470 32521.43,-470 32521.43,-491.07 32521.43,-491.07"/>
<polygon fill="black" stroke="black" points="32517.93,-491.07 32521.43,-501.07 32524.93,-491.07 32517.93,-491.07"/>
</g>
<!-- L3_S0_TP1_GPU1_expert1&#45;&gt;L3_S0_TP6_GPU6_moe_ar -->
<g id="edge1101" class="edge">
<title>L3_S0_TP1_GPU1_expert1&#45;&gt;L3_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M29901.95,-604.39C29901.95,-595.82 29901.95,-589 29901.95,-589 29901.95,-589 33320.75,-589 33320.75,-589 33320.75,-589 33320.75,-569.91 33320.75,-569.91"/>
<polygon fill="black" stroke="black" points="33324.25,-569.91 33320.75,-559.91 33317.25,-569.91 33324.25,-569.91"/>
</g>
<!-- L3_S0_TP1_GPU1_expert1&#45;&gt;L3_S0_TP7_GPU7_moe_ar -->
<g id="edge1137" class="edge">
<title>L3_S0_TP1_GPU1_expert1&#45;&gt;L3_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M29523.49,-604.44C29523.49,-594.86 29523.49,-587 29523.49,-587 29523.49,-587 33970.32,-587 33970.32,-587 33970.32,-587 33970.32,-565.27 33970.32,-565.27"/>
<polygon fill="black" stroke="black" points="33973.82,-565.27 33970.32,-555.27 33966.82,-565.27 33973.82,-565.27"/>
</g>
<!-- L3_S0_TP2_GPU2_expert0 -->
<g id="node334" class="node">
<title>L3_S0_TP2_GPU2_expert0</title>
<polygon fill="none" stroke="black" points="30388.5,-672.5 29939.5,-672.5 29939.5,-604.5 30388.5,-604.5 30388.5,-672.5"/>
<text text-anchor="middle" x="30164" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="30164" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="30164" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="30164" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L3_S0_TP2_GPU2_expert0&#45;&gt;L3_S0_TP0_GPU0_moe_ar -->
<g id="edge886" class="edge">
<title>L3_S0_TP2_GPU2_expert0&#45;&gt;L3_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M29995.62,-603.88C29995.62,-603.31 29995.62,-603 29995.62,-603 29995.62,-603 29548.99,-603 29548.99,-603 29548.99,-603 29548.99,-573.16 29548.99,-573.16"/>
<polygon fill="black" stroke="black" points="29552.49,-573.16 29548.99,-563.16 29545.49,-573.16 29552.49,-573.16"/>
</g>
<!-- L3_S0_TP2_GPU2_expert0&#45;&gt;L3_S0_TP1_GPU1_moe_ar -->
<g id="edge922" class="edge">
<title>L3_S0_TP2_GPU2_expert0&#45;&gt;L3_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M30051.75,-604.34C30051.75,-604.34 30051.75,-578.55 30051.75,-578.55"/>
<polygon fill="black" stroke="black" points="30055.25,-578.55 30051.75,-568.55 30048.25,-578.55 30055.25,-578.55"/>
</g>
<!-- L3_S0_TP2_GPU2_expert0&#45;&gt;L3_S0_TP2_GPU2_moe_ar -->
<g id="edge958" class="edge">
<title>L3_S0_TP2_GPU2_expert0&#45;&gt;L3_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M30164,-604.36C30164,-594.33 30164,-586 30164,-586 30164,-586 30620.52,-586 30620.52,-586 30620.52,-586 30620.52,-573.8 30620.52,-573.8"/>
<polygon fill="black" stroke="black" points="30624.02,-573.8 30620.52,-563.8 30617.02,-573.8 30624.02,-573.8"/>
</g>
<!-- L3_S0_TP2_GPU2_expert0&#45;&gt;L3_S0_TP3_GPU3_moe_ar -->
<g id="edge994" class="edge">
<title>L3_S0_TP2_GPU2_expert0&#45;&gt;L3_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M30220.12,-604.36C30220.12,-594.33 30220.12,-586 30220.12,-586 30220.12,-586 31195.65,-586 31195.65,-586 31195.65,-586 31195.65,-561.29 31195.65,-561.29"/>
<polygon fill="black" stroke="black" points="31199.15,-561.29 31195.65,-551.29 31192.15,-561.29 31199.15,-561.29"/>
</g>
<!-- L3_S0_TP2_GPU2_expert0&#45;&gt;L3_S0_TP4_GPU4_moe_ar -->
<g id="edge1030" class="edge">
<title>L3_S0_TP2_GPU2_expert0&#45;&gt;L3_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M30276.25,-604.44C30276.25,-594.86 30276.25,-587 30276.25,-587 30276.25,-587 31897.3,-587 31897.3,-587 31897.3,-587 31897.3,-563.71 31897.3,-563.71"/>
<polygon fill="black" stroke="black" points="31900.8,-563.71 31897.3,-553.71 31893.8,-563.71 31900.8,-563.71"/>
</g>
<!-- L3_S0_TP2_GPU2_expert0&#45;&gt;L3_S0_TP5_GPU5_moe_ar -->
<g id="edge1066" class="edge">
<title>L3_S0_TP2_GPU2_expert0&#45;&gt;L3_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M30332.38,-604.44C30332.38,-594.86 30332.38,-587 30332.38,-587 30332.38,-587 32519.09,-587 32519.09,-587 32519.09,-587 32519.09,-548.96 32519.09,-548.96"/>
<polygon fill="black" stroke="black" points="32522.59,-548.96 32519.09,-538.96 32515.59,-548.96 32522.59,-548.96"/>
</g>
<!-- L3_S0_TP2_GPU2_expert0&#45;&gt;L3_S0_TP6_GPU6_moe_ar -->
<g id="edge1102" class="edge">
<title>L3_S0_TP2_GPU2_expert0&#45;&gt;L3_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M30276.25,-672.81C30276.25,-677.64 30276.25,-681 30276.25,-681 30276.25,-681 33205.93,-681 33205.93,-681 33205.93,-681 33205.93,-548.84 33205.93,-548.84"/>
<polygon fill="black" stroke="black" points="33209.43,-548.84 33205.93,-538.84 33202.43,-548.84 33209.43,-548.84"/>
</g>
<!-- L3_S0_TP2_GPU2_expert0&#45;&gt;L3_S0_TP7_GPU7_moe_ar -->
<g id="edge1138" class="edge">
<title>L3_S0_TP2_GPU2_expert0&#45;&gt;L3_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M30164,-672.75C30164,-689.87 30164,-707 30164,-707 30164,-707 34138,-707 34138,-707 34138,-707 34138,-577.98 34138,-577.98"/>
<polygon fill="black" stroke="black" points="34141.5,-577.98 34138,-567.98 34134.5,-577.98 34141.5,-577.98"/>
</g>
<!-- L3_S0_TP2_GPU2_expert1 -->
<g id="node335" class="node">
<title>L3_S0_TP2_GPU2_expert1</title>
<polygon fill="none" stroke="black" points="30855.5,-672.5 30406.5,-672.5 30406.5,-604.5 30855.5,-604.5 30855.5,-672.5"/>
<text text-anchor="middle" x="30631" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="30631" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="30631" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="30631" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L3_S0_TP2_GPU2_expert1&#45;&gt;L3_S0_TP0_GPU0_moe_ar -->
<g id="edge887" class="edge">
<title>L3_S0_TP2_GPU2_expert1&#45;&gt;L3_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M30420.49,-604.44C30420.49,-594.86 30420.49,-587 30420.49,-587 30420.49,-587 29574.48,-587 29574.48,-587 29574.48,-587 29574.48,-571.07 29574.48,-571.07"/>
<polygon fill="black" stroke="black" points="29577.98,-571.07 29574.48,-561.07 29570.98,-571.07 29577.98,-571.07"/>
</g>
<!-- L3_S0_TP2_GPU2_expert1&#45;&gt;L3_S0_TP1_GPU1_moe_ar -->
<g id="edge923" class="edge">
<title>L3_S0_TP2_GPU2_expert1&#45;&gt;L3_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M30410.48,-604.34C30410.48,-604.34 30410.48,-538.15 30410.48,-538.15"/>
<polygon fill="black" stroke="black" points="30413.98,-538.15 30410.48,-528.15 30406.98,-538.15 30413.98,-538.15"/>
</g>
<!-- L3_S0_TP2_GPU2_expert1&#45;&gt;L3_S0_TP2_GPU2_moe_ar -->
<g id="edge959" class="edge">
<title>L3_S0_TP2_GPU2_expert1&#45;&gt;L3_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M30667.52,-604.34C30667.52,-604.34 30667.52,-576.36 30667.52,-576.36"/>
<polygon fill="black" stroke="black" points="30671.02,-576.36 30667.52,-566.36 30664.02,-576.36 30671.02,-576.36"/>
</g>
<!-- L3_S0_TP2_GPU2_expert1&#45;&gt;L3_S0_TP3_GPU3_moe_ar -->
<g id="edge995" class="edge">
<title>L3_S0_TP2_GPU2_expert1&#45;&gt;L3_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M30714.51,-604.36C30714.51,-594.33 30714.51,-586 30714.51,-586 30714.51,-586 31221.02,-586 31221.02,-586 31221.02,-586 31221.02,-565.13 31221.02,-565.13"/>
<polygon fill="black" stroke="black" points="31224.52,-565.13 31221.02,-555.13 31217.52,-565.13 31224.52,-565.13"/>
</g>
<!-- L3_S0_TP2_GPU2_expert1&#45;&gt;L3_S0_TP4_GPU4_moe_ar -->
<g id="edge1031" class="edge">
<title>L3_S0_TP2_GPU2_expert1&#45;&gt;L3_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M30761.51,-604.44C30761.51,-594.86 30761.51,-587 30761.51,-587 30761.51,-587 31942.2,-587 31942.2,-587 31942.2,-587 31942.2,-569.15 31942.2,-569.15"/>
<polygon fill="black" stroke="black" points="31945.7,-569.15 31942.2,-559.15 31938.7,-569.15 31945.7,-569.15"/>
</g>
<!-- L3_S0_TP2_GPU2_expert1&#45;&gt;L3_S0_TP5_GPU5_moe_ar -->
<g id="edge1067" class="edge">
<title>L3_S0_TP2_GPU2_expert1&#45;&gt;L3_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M30808.5,-604.44C30808.5,-594.86 30808.5,-587 30808.5,-587 30808.5,-587 32544.64,-587 32544.64,-587 32544.64,-587 32544.64,-555.97 32544.64,-555.97"/>
<polygon fill="black" stroke="black" points="32548.14,-555.97 32544.64,-545.97 32541.14,-555.97 32548.14,-555.97"/>
</g>
<!-- L3_S0_TP2_GPU2_expert1&#45;&gt;L3_S0_TP6_GPU6_moe_ar -->
<g id="edge1103" class="edge">
<title>L3_S0_TP2_GPU2_expert1&#45;&gt;L3_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M30813.74,-672.67C30813.74,-676.47 30813.74,-679 30813.74,-679 30813.74,-679 33203.36,-679 33203.36,-679 33203.36,-679 33203.36,-547.99 33203.36,-547.99"/>
<polygon fill="black" stroke="black" points="33206.86,-547.99 33203.36,-537.99 33199.86,-547.99 33206.86,-547.99"/>
</g>
<!-- L3_S0_TP2_GPU2_expert1&#45;&gt;L3_S0_TP7_GPU7_moe_ar -->
<g id="edge1139" class="edge">
<title>L3_S0_TP2_GPU2_expert1&#45;&gt;L3_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M30771.98,-672.53C30771.98,-688.89 30771.98,-705 30771.98,-705 30771.98,-705 34133.5,-705 34133.5,-705 34133.5,-705 34133.5,-577.95 34133.5,-577.95"/>
<polygon fill="black" stroke="black" points="34137,-577.95 34133.5,-567.95 34130,-577.95 34137,-577.95"/>
</g>
<!-- L3_S0_TP3_GPU3_expert0 -->
<g id="node336" class="node">
<title>L3_S0_TP3_GPU3_expert0</title>
<polygon fill="none" stroke="black" points="31322.5,-672.5 30873.5,-672.5 30873.5,-604.5 31322.5,-604.5 31322.5,-672.5"/>
<text text-anchor="middle" x="31098" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="31098" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="31098" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="31098" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L3_S0_TP3_GPU3_expert0&#45;&gt;L3_S0_TP0_GPU0_moe_ar -->
<g id="edge888" class="edge">
<title>L3_S0_TP3_GPU3_expert0&#45;&gt;L3_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M30902,-604.44C30902,-594.86 30902,-587 30902,-587 30902,-587 29599.98,-587 29599.98,-587 29599.98,-587 29599.98,-568.38 29599.98,-568.38"/>
<polygon fill="black" stroke="black" points="29603.48,-568.38 29599.98,-558.38 29596.48,-568.38 29603.48,-568.38"/>
</g>
<!-- L3_S0_TP3_GPU3_expert0&#45;&gt;L3_S0_TP1_GPU1_moe_ar -->
<g id="edge924" class="edge">
<title>L3_S0_TP3_GPU3_expert0&#45;&gt;L3_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M30930.49,-604.44C30930.49,-594.86 30930.49,-587 30930.49,-587 30930.49,-587 30402,-587 30402,-587 30402,-587 30402,-543.57 30402,-543.57"/>
<polygon fill="black" stroke="black" points="30405.5,-543.57 30402,-533.57 30398.5,-543.57 30405.5,-543.57"/>
</g>
<!-- L3_S0_TP3_GPU3_expert0&#45;&gt;L3_S0_TP2_GPU2_moe_ar -->
<g id="edge960" class="edge">
<title>L3_S0_TP3_GPU3_expert0&#45;&gt;L3_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M30958.99,-604.34C30958.99,-604.34 30958.99,-569.91 30958.99,-569.91"/>
<polygon fill="black" stroke="black" points="30962.49,-569.91 30958.99,-559.91 30955.49,-569.91 30962.49,-569.91"/>
</g>
<!-- L3_S0_TP3_GPU3_expert0&#45;&gt;L3_S0_TP3_GPU3_moe_ar -->
<g id="edge996" class="edge">
<title>L3_S0_TP3_GPU3_expert0&#45;&gt;L3_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M31246.39,-604.34C31246.39,-604.34 31246.39,-568.22 31246.39,-568.22"/>
<polygon fill="black" stroke="black" points="31249.89,-568.22 31246.39,-558.22 31242.89,-568.22 31249.89,-568.22"/>
</g>
<!-- L3_S0_TP3_GPU3_expert0&#45;&gt;L3_S0_TP4_GPU4_moe_ar -->
<g id="edge1032" class="edge">
<title>L3_S0_TP3_GPU3_expert0&#45;&gt;L3_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M31271.76,-604.44C31271.76,-594.86 31271.76,-587 31271.76,-587 31271.76,-587 32032,-587 32032,-587 32032,-587 32032,-575.93 32032,-575.93"/>
<polygon fill="black" stroke="black" points="32035.5,-575.93 32032,-565.93 32028.5,-575.93 32035.5,-575.93"/>
</g>
<!-- L3_S0_TP3_GPU3_expert0&#45;&gt;L3_S0_TP5_GPU5_moe_ar -->
<g id="edge1068" class="edge">
<title>L3_S0_TP3_GPU3_expert0&#45;&gt;L3_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M31297.13,-604.44C31297.13,-594.86 31297.13,-587 31297.13,-587 31297.13,-587 32570.19,-587 32570.19,-587 32570.19,-587 32570.19,-561.37 32570.19,-561.37"/>
<polygon fill="black" stroke="black" points="32573.69,-561.37 32570.19,-551.37 32566.69,-561.37 32573.69,-561.37"/>
</g>
<!-- L3_S0_TP3_GPU3_expert0&#45;&gt;L3_S0_TP6_GPU6_moe_ar -->
<g id="edge1104" class="edge">
<title>L3_S0_TP3_GPU3_expert0&#45;&gt;L3_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M31172.83,-672.51C31172.83,-675.83 31172.83,-678 31172.83,-678 31172.83,-678 33200.79,-678 33200.79,-678 33200.79,-678 33200.79,-546.98 33200.79,-546.98"/>
<polygon fill="black" stroke="black" points="33204.29,-546.98 33200.79,-536.98 33197.29,-546.98 33204.29,-546.98"/>
</g>
<!-- L3_S0_TP3_GPU3_expert0&#45;&gt;L3_S0_TP7_GPU7_moe_ar -->
<g id="edge1140" class="edge">
<title>L3_S0_TP3_GPU3_expert0&#45;&gt;L3_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M31110.5,-604.48C31110.5,-550.92 31110.5,-453 31110.5,-453 31110.5,-453 33933.36,-453 33933.36,-453 33933.36,-453 33933.36,-481.43 33933.36,-481.43"/>
<polygon fill="black" stroke="black" points="33929.86,-481.43 33933.36,-491.43 33936.86,-481.43 33929.86,-481.43"/>
</g>
<!-- L3_S0_TP3_GPU3_expert1 -->
<g id="node337" class="node">
<title>L3_S0_TP3_GPU3_expert1</title>
<polygon fill="none" stroke="black" points="31789.5,-672.5 31340.5,-672.5 31340.5,-604.5 31789.5,-604.5 31789.5,-672.5"/>
<text text-anchor="middle" x="31565" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="31565" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="31565" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="31565" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L3_S0_TP3_GPU3_expert1&#45;&gt;L3_S0_TP0_GPU0_moe_ar -->
<g id="edge889" class="edge">
<title>L3_S0_TP3_GPU3_expert1&#45;&gt;L3_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M31390.27,-604.44C31390.27,-594.86 31390.27,-587 31390.27,-587 31390.27,-587 29625.48,-587 29625.48,-587 29625.48,-587 29625.48,-565.27 29625.48,-565.27"/>
<polygon fill="black" stroke="black" points="29628.98,-565.27 29625.48,-555.27 29621.98,-565.27 29628.98,-565.27"/>
</g>
<!-- L3_S0_TP3_GPU3_expert1&#45;&gt;L3_S0_TP1_GPU1_moe_ar -->
<g id="edge925" class="edge">
<title>L3_S0_TP3_GPU3_expert1&#45;&gt;L3_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M31440.05,-604.44C31440.05,-594.86 31440.05,-587 31440.05,-587 31440.05,-587 30404.25,-587 30404.25,-587 30404.25,-587 30404.25,-542.32 30404.25,-542.32"/>
<polygon fill="black" stroke="black" points="30407.75,-542.32 30404.25,-532.32 30400.75,-542.32 30407.75,-542.32"/>
</g>
<!-- L3_S0_TP3_GPU3_expert1&#45;&gt;L3_S0_TP2_GPU2_moe_ar -->
<g id="edge961" class="edge">
<title>L3_S0_TP3_GPU3_expert1&#45;&gt;L3_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M31489.82,-604.44C31489.82,-594.86 31489.82,-587 31489.82,-587 31489.82,-587 30987.48,-587 30987.48,-587 30987.48,-587 30987.48,-566.83 30987.48,-566.83"/>
<polygon fill="black" stroke="black" points="30990.98,-566.83 30987.48,-556.83 30983.98,-566.83 30990.98,-566.83"/>
</g>
<!-- L3_S0_TP3_GPU3_expert1&#45;&gt;L3_S0_TP3_GPU3_moe_ar -->
<g id="edge997" class="edge">
<title>L3_S0_TP3_GPU3_expert1&#45;&gt;L3_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M31539.59,-604.34C31539.59,-604.34 31539.59,-577.23 31539.59,-577.23"/>
<polygon fill="black" stroke="black" points="31543.09,-577.23 31539.59,-567.23 31536.09,-577.23 31543.09,-577.23"/>
</g>
<!-- L3_S0_TP3_GPU3_expert1&#45;&gt;L3_S0_TP4_GPU4_moe_ar -->
<g id="edge1033" class="edge">
<title>L3_S0_TP3_GPU3_expert1&#45;&gt;L3_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M31789.68,-627C31795.9,-627 31799.45,-627 31799.45,-627 31799.45,-627 31799.45,-504 31799.45,-504 31799.45,-504 31816.54,-504 31816.54,-504"/>
<polygon fill="black" stroke="black" points="31816.54,-507.5 31826.54,-504 31816.54,-500.5 31816.54,-507.5"/>
</g>
<!-- L3_S0_TP3_GPU3_expert1&#45;&gt;L3_S0_TP5_GPU5_moe_ar -->
<g id="edge1069" class="edge">
<title>L3_S0_TP3_GPU3_expert1&#45;&gt;L3_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M31589.37,-604.44C31589.37,-594.86 31589.37,-587 31589.37,-587 31589.37,-587 32595.74,-587 32595.74,-587 32595.74,-587 32595.74,-565.27 32595.74,-565.27"/>
<polygon fill="black" stroke="black" points="32599.24,-565.27 32595.74,-555.27 32592.24,-565.27 32599.24,-565.27"/>
</g>
<!-- L3_S0_TP3_GPU3_expert1&#45;&gt;L3_S0_TP6_GPU6_moe_ar -->
<g id="edge1105" class="edge">
<title>L3_S0_TP3_GPU3_expert1&#45;&gt;L3_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M31677.25,-672.51C31677.25,-675.83 31677.25,-678 31677.25,-678 31677.25,-678 33198.21,-678 33198.21,-678 33198.21,-678 33198.21,-546.1 33198.21,-546.1"/>
<polygon fill="black" stroke="black" points="33201.71,-546.1 33198.21,-536.1 33194.71,-546.1 33201.71,-546.1"/>
</g>
<!-- L3_S0_TP3_GPU3_expert1&#45;&gt;L3_S0_TP7_GPU7_moe_ar -->
<g id="edge1141" class="edge">
<title>L3_S0_TP3_GPU3_expert1&#45;&gt;L3_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M31565,-672.64C31565,-686.36 31565,-699 31565,-699 31565,-699 34129,-699 34129,-699 34129,-699 34129,-577.8 34129,-577.8"/>
<polygon fill="black" stroke="black" points="34132.5,-577.8 34129,-567.8 34125.5,-577.8 34132.5,-577.8"/>
</g>
<!-- L3_S0_TP4_GPU4_expert0 -->
<g id="node338" class="node">
<title>L3_S0_TP4_GPU4_expert0</title>
<polygon fill="none" stroke="black" points="32256.5,-672.5 31807.5,-672.5 31807.5,-604.5 32256.5,-604.5 32256.5,-672.5"/>
<text text-anchor="middle" x="32032" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="32032" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="32032" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="32032" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L3_S0_TP4_GPU4_expert0&#45;&gt;L3_S0_TP0_GPU0_moe_ar -->
<g id="edge890" class="edge">
<title>L3_S0_TP4_GPU4_expert0&#45;&gt;L3_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M32032.36,-672.64C32032.36,-686.36 32032.36,-699 32032.36,-699 32032.36,-699 29466.5,-699 29466.5,-699 29466.5,-699 29466.5,-577.34 29466.5,-577.34"/>
<polygon fill="black" stroke="black" points="29470,-577.34 29466.5,-567.34 29463,-577.34 29470,-577.34"/>
</g>
<!-- L3_S0_TP4_GPU4_expert0&#45;&gt;L3_S0_TP1_GPU1_moe_ar -->
<g id="edge926" class="edge">
<title>L3_S0_TP4_GPU4_expert0&#45;&gt;L3_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M31920.29,-672.51C31920.29,-675.83 31920.29,-678 31920.29,-678 31920.29,-678 30397.5,-678 30397.5,-678 30397.5,-678 30397.5,-545.81 30397.5,-545.81"/>
<polygon fill="black" stroke="black" points="30401,-545.81 30397.5,-535.81 30394,-545.81 30401,-545.81"/>
</g>
<!-- L3_S0_TP4_GPU4_expert0&#45;&gt;L3_S0_TP2_GPU2_moe_ar -->
<g id="edge962" class="edge">
<title>L3_S0_TP4_GPU4_expert0&#45;&gt;L3_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M31987.1,-604.36C31987.1,-594.33 31987.1,-586 31987.1,-586 31987.1,-586 31015.98,-586 31015.98,-586 31015.98,-586 31015.98,-562.82 31015.98,-562.82"/>
<polygon fill="black" stroke="black" points="31019.48,-562.82 31015.98,-552.82 31012.48,-562.82 31019.48,-562.82"/>
</g>
<!-- L3_S0_TP4_GPU4_expert0&#45;&gt;L3_S0_TP3_GPU3_moe_ar -->
<g id="edge998" class="edge">
<title>L3_S0_TP4_GPU4_expert0&#45;&gt;L3_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M31807.48,-649C31800.87,-649 31797.09,-649 31797.09,-649 31797.09,-649 31797.09,-536 31797.09,-536 31797.09,-536 31780.45,-536 31780.45,-536"/>
<polygon fill="black" stroke="black" points="31780.45,-532.5 31770.45,-536 31780.45,-539.5 31780.45,-532.5"/>
</g>
<!-- L3_S0_TP4_GPU4_expert0&#45;&gt;L3_S0_TP4_GPU4_moe_ar -->
<g id="edge1034" class="edge">
<title>L3_S0_TP4_GPU4_expert0&#45;&gt;L3_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M32076.9,-604.34C32076.9,-604.34 32076.9,-577.67 32076.9,-577.67"/>
<polygon fill="black" stroke="black" points="32080.4,-577.67 32076.9,-567.67 32073.4,-577.67 32080.4,-577.67"/>
</g>
<!-- L3_S0_TP4_GPU4_expert0&#45;&gt;L3_S0_TP5_GPU5_moe_ar -->
<g id="edge1070" class="edge">
<title>L3_S0_TP4_GPU4_expert0&#45;&gt;L3_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M32121.8,-604.39C32121.8,-595.82 32121.8,-589 32121.8,-589 32121.8,-589 32621.29,-589 32621.29,-589 32621.29,-589 32621.29,-568.32 32621.29,-568.32"/>
<polygon fill="black" stroke="black" points="32624.79,-568.32 32621.29,-558.32 32617.79,-568.32 32624.79,-568.32"/>
</g>
<!-- L3_S0_TP4_GPU4_expert0&#45;&gt;L3_S0_TP6_GPU6_moe_ar -->
<g id="edge1106" class="edge">
<title>L3_S0_TP4_GPU4_expert0&#45;&gt;L3_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M32166.7,-604.39C32166.7,-595.82 32166.7,-589 32166.7,-589 32166.7,-589 33193.07,-589 33193.07,-589 33193.07,-589 33193.07,-543.64 33193.07,-543.64"/>
<polygon fill="black" stroke="black" points="33196.57,-543.64 33193.07,-533.64 33189.57,-543.64 33196.57,-543.64"/>
</g>
<!-- L3_S0_TP4_GPU4_expert0&#45;&gt;L3_S0_TP7_GPU7_moe_ar -->
<g id="edge1142" class="edge">
<title>L3_S0_TP4_GPU4_expert0&#45;&gt;L3_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M32211.6,-604.39C32211.6,-595.82 32211.6,-589 32211.6,-589 32211.6,-589 33996.02,-589 33996.02,-589 33996.02,-589 33996.02,-568.32 33996.02,-568.32"/>
<polygon fill="black" stroke="black" points="33999.52,-568.32 33996.02,-558.32 33992.52,-568.32 33999.52,-568.32"/>
</g>
<!-- L3_S0_TP4_GPU4_expert1 -->
<g id="node339" class="node">
<title>L3_S0_TP4_GPU4_expert1</title>
<polygon fill="none" stroke="black" points="32723.5,-672.5 32274.5,-672.5 32274.5,-604.5 32723.5,-604.5 32723.5,-672.5"/>
<text text-anchor="middle" x="32499" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="32499" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="32499" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="32499" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L3_S0_TP4_GPU4_expert1&#45;&gt;L3_S0_TP0_GPU0_moe_ar -->
<g id="edge891" class="edge">
<title>L3_S0_TP4_GPU4_expert1&#45;&gt;L3_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M32484.5,-604.2C32484.5,-554.67 32484.5,-469 32484.5,-469 32484.5,-469 29675.35,-469 29675.35,-469 29675.35,-469 29675.35,-484.41 29675.35,-484.41"/>
<polygon fill="black" stroke="black" points="29671.85,-484.41 29675.35,-494.41 29678.85,-484.41 29671.85,-484.41"/>
</g>
<!-- L3_S0_TP4_GPU4_expert1&#45;&gt;L3_S0_TP1_GPU1_moe_ar -->
<g id="edge927" class="edge">
<title>L3_S0_TP4_GPU4_expert1&#45;&gt;L3_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M32424.17,-672.51C32424.17,-675.83 32424.17,-678 32424.17,-678 32424.17,-678 30395.25,-678 30395.25,-678 30395.25,-678 30395.25,-546.69 30395.25,-546.69"/>
<polygon fill="black" stroke="black" points="30398.75,-546.69 30395.25,-536.69 30391.75,-546.69 30398.75,-546.69"/>
</g>
<!-- L3_S0_TP4_GPU4_expert1&#45;&gt;L3_S0_TP2_GPU2_moe_ar -->
<g id="edge963" class="edge">
<title>L3_S0_TP4_GPU4_expert1&#45;&gt;L3_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M32299.62,-604.36C32299.62,-594.33 32299.62,-586 32299.62,-586 32299.62,-586 31044.47,-586 31044.47,-586 31044.47,-586 31044.47,-557.47 31044.47,-557.47"/>
<polygon fill="black" stroke="black" points="31047.97,-557.47 31044.47,-547.47 31040.97,-557.47 31047.97,-557.47"/>
</g>
<!-- L3_S0_TP4_GPU4_expert1&#45;&gt;L3_S0_TP3_GPU3_moe_ar -->
<g id="edge999" class="edge">
<title>L3_S0_TP4_GPU4_expert1&#45;&gt;L3_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M32324.74,-604.44C32324.74,-594.86 32324.74,-587 32324.74,-587 32324.74,-587 31639.14,-587 31639.14,-587 31639.14,-587 31639.14,-570.68 31639.14,-570.68"/>
<polygon fill="black" stroke="black" points="31642.64,-570.68 31639.14,-560.68 31635.64,-570.68 31642.64,-570.68"/>
</g>
<!-- L3_S0_TP4_GPU4_expert1&#45;&gt;L3_S0_TP4_GPU4_moe_ar -->
<g id="edge1035" class="edge">
<title>L3_S0_TP4_GPU4_expert1&#45;&gt;L3_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M32349.86,-604.34C32349.86,-604.34 32349.86,-568.22 32349.86,-568.22"/>
<polygon fill="black" stroke="black" points="32353.36,-568.22 32349.86,-558.22 32346.36,-568.22 32353.36,-568.22"/>
</g>
<!-- L3_S0_TP4_GPU4_expert1&#45;&gt;L3_S0_TP5_GPU5_moe_ar -->
<g id="edge1071" class="edge">
<title>L3_S0_TP4_GPU4_expert1&#45;&gt;L3_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M32646.85,-604.34C32646.85,-604.34 32646.85,-571.18 32646.85,-571.18"/>
<polygon fill="black" stroke="black" points="32650.35,-571.18 32646.85,-561.18 32643.35,-571.18 32650.35,-571.18"/>
</g>
<!-- L3_S0_TP4_GPU4_expert1&#45;&gt;L3_S0_TP6_GPU6_moe_ar -->
<g id="edge1107" class="edge">
<title>L3_S0_TP4_GPU4_expert1&#45;&gt;L3_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M32672.4,-604.39C32672.4,-595.82 32672.4,-589 32672.4,-589 32672.4,-589 33183.86,-589 33183.86,-589 33183.86,-589 33183.86,-537.24 33183.86,-537.24"/>
<polygon fill="black" stroke="black" points="33187.36,-537.24 33183.86,-527.24 33180.36,-537.24 33187.36,-537.24"/>
</g>
<!-- L3_S0_TP4_GPU4_expert1&#45;&gt;L3_S0_TP7_GPU7_moe_ar -->
<g id="edge1143" class="edge">
<title>L3_S0_TP4_GPU4_expert1&#45;&gt;L3_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M32697.95,-604.29C32697.95,-596.26 32697.95,-590 32697.95,-590 32697.95,-590 34021.72,-590 34021.72,-590 34021.72,-590 34021.72,-571.3 34021.72,-571.3"/>
<polygon fill="black" stroke="black" points="34025.22,-571.3 34021.72,-561.3 34018.22,-571.3 34025.22,-571.3"/>
</g>
<!-- L3_S0_TP5_GPU5_expert0 -->
<g id="node340" class="node">
<title>L3_S0_TP5_GPU5_expert0</title>
<polygon fill="none" stroke="black" points="33190.5,-672.5 32741.5,-672.5 32741.5,-604.5 33190.5,-604.5 33190.5,-672.5"/>
<text text-anchor="middle" x="32966" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="32966" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="32966" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="32966" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L3_S0_TP5_GPU5_expert0&#45;&gt;L3_S0_TP0_GPU0_moe_ar -->
<g id="edge892" class="edge">
<title>L3_S0_TP5_GPU5_expert0&#45;&gt;L3_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M32825.69,-672.65C32825.69,-689.39 32825.69,-706 32825.69,-706 32825.69,-706 29460.5,-706 29460.5,-706 29460.5,-706 29460.5,-577.73 29460.5,-577.73"/>
<polygon fill="black" stroke="black" points="29464,-577.73 29460.5,-567.73 29457,-577.73 29464,-577.73"/>
</g>
<!-- L3_S0_TP5_GPU5_expert0&#45;&gt;L3_S0_TP1_GPU1_moe_ar -->
<g id="edge928" class="edge">
<title>L3_S0_TP5_GPU5_expert0&#45;&gt;L3_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M32783.59,-672.51C32783.59,-675.83 32783.59,-678 32783.59,-678 32783.59,-678 30393,-678 30393,-678 30393,-678 30393,-547.58 30393,-547.58"/>
<polygon fill="black" stroke="black" points="30396.5,-547.58 30393,-537.58 30389.5,-547.58 30396.5,-547.58"/>
</g>
<!-- L3_S0_TP5_GPU5_expert0&#45;&gt;L3_S0_TP2_GPU2_moe_ar -->
<g id="edge964" class="edge">
<title>L3_S0_TP5_GPU5_expert0&#45;&gt;L3_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M32783.6,-604.36C32783.6,-594.33 32783.6,-586 32783.6,-586 32783.6,-586 31072.97,-586 31072.97,-586 31072.97,-586 31072.97,-550.09 31072.97,-550.09"/>
<polygon fill="black" stroke="black" points="31076.47,-550.09 31072.97,-540.09 31069.47,-550.09 31076.47,-550.09"/>
</g>
<!-- L3_S0_TP5_GPU5_expert0&#45;&gt;L3_S0_TP3_GPU3_moe_ar -->
<g id="edge1000" class="edge">
<title>L3_S0_TP5_GPU5_expert0&#45;&gt;L3_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M32825.69,-604.36C32825.69,-594.33 32825.69,-586 32825.69,-586 32825.69,-586 31688.91,-586 31688.91,-586 31688.91,-586 31688.91,-564.74 31688.91,-564.74"/>
<polygon fill="black" stroke="black" points="31692.41,-564.74 31688.91,-554.74 31685.41,-564.74 31692.41,-564.74"/>
</g>
<!-- L3_S0_TP5_GPU5_expert0&#45;&gt;L3_S0_TP4_GPU4_moe_ar -->
<g id="edge1036" class="edge">
<title>L3_S0_TP5_GPU5_expert0&#45;&gt;L3_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M32867.79,-604.36C32867.79,-594.33 32867.79,-586 32867.79,-586 32867.79,-586 32374.98,-586 32374.98,-586 32374.98,-586 32374.98,-565.13 32374.98,-565.13"/>
<polygon fill="black" stroke="black" points="32378.48,-565.13 32374.98,-555.13 32371.48,-565.13 32378.48,-565.13"/>
</g>
<!-- L3_S0_TP5_GPU5_expert0&#45;&gt;L3_S0_TP5_GPU5_moe_ar -->
<g id="edge1072" class="edge">
<title>L3_S0_TP5_GPU5_expert0&#45;&gt;L3_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M32909.88,-604.34C32909.88,-604.34 32909.88,-577.23 32909.88,-577.23"/>
<polygon fill="black" stroke="black" points="32913.38,-577.23 32909.88,-567.23 32906.38,-577.23 32913.38,-577.23"/>
</g>
<!-- L3_S0_TP5_GPU5_expert0&#45;&gt;L3_S0_TP6_GPU6_moe_ar -->
<g id="edge1108" class="edge">
<title>L3_S0_TP5_GPU5_expert0&#45;&gt;L3_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M33187.18,-604.34C33187.18,-604.34 33187.18,-540.13 33187.18,-540.13"/>
<polygon fill="black" stroke="black" points="33190.68,-540.13 33187.18,-530.13 33183.68,-540.13 33190.68,-540.13"/>
</g>
<!-- L3_S0_TP5_GPU5_expert0&#45;&gt;L3_S0_TP7_GPU7_moe_ar -->
<g id="edge1144" class="edge">
<title>L3_S0_TP5_GPU5_expert0&#45;&gt;L3_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M33168.49,-604.29C33168.49,-596.26 33168.49,-590 33168.49,-590 33168.49,-590 34047.41,-590 34047.41,-590 34047.41,-590 34047.41,-573.3 34047.41,-573.3"/>
<polygon fill="black" stroke="black" points="34050.91,-573.3 34047.41,-563.3 34043.91,-573.3 34050.91,-573.3"/>
</g>
<!-- L3_S0_TP5_GPU5_expert1 -->
<g id="node341" class="node">
<title>L3_S0_TP5_GPU5_expert1</title>
<polygon fill="none" stroke="black" points="33657.5,-672.5 33208.5,-672.5 33208.5,-604.5 33657.5,-604.5 33657.5,-672.5"/>
<text text-anchor="middle" x="33433" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="33433" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="33433" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="33433" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L3_S0_TP5_GPU5_expert1&#45;&gt;L3_S0_TP0_GPU0_moe_ar -->
<g id="edge893" class="edge">
<title>L3_S0_TP5_GPU5_expert1&#45;&gt;L3_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M33264.62,-604.44C33264.62,-594.86 33264.62,-587 33264.62,-587 33264.62,-587 29650.97,-587 29650.97,-587 29650.97,-587 29650.97,-561.37 29650.97,-561.37"/>
<polygon fill="black" stroke="black" points="29654.47,-561.37 29650.97,-551.37 29647.47,-561.37 29654.47,-561.37"/>
</g>
<!-- L3_S0_TP5_GPU5_expert1&#45;&gt;L3_S0_TP1_GPU1_moe_ar -->
<g id="edge929" class="edge">
<title>L3_S0_TP5_GPU5_expert1&#45;&gt;L3_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M33433,-672.67C33433,-676.47 33433,-679 33433,-679 33433,-679 30390.75,-679 30390.75,-679 30390.75,-679 30390.75,-548.3 30390.75,-548.3"/>
<polygon fill="black" stroke="black" points="30394.25,-548.3 30390.75,-538.3 30387.25,-548.3 30394.25,-548.3"/>
</g>
<!-- L3_S0_TP5_GPU5_expert1&#45;&gt;L3_S0_TP2_GPU2_moe_ar -->
<g id="edge965" class="edge">
<title>L3_S0_TP5_GPU5_expert1&#45;&gt;L3_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M33320.75,-672.51C33320.75,-675.83 33320.75,-678 33320.75,-678 33320.75,-678 30864.5,-678 30864.5,-678 30864.5,-678 30864.5,-576.42 30864.5,-576.42"/>
<polygon fill="black" stroke="black" points="30868,-576.42 30864.5,-566.42 30861,-576.42 30868,-576.42"/>
</g>
<!-- L3_S0_TP5_GPU5_expert1&#45;&gt;L3_S0_TP3_GPU3_moe_ar -->
<g id="edge1001" class="edge">
<title>L3_S0_TP5_GPU5_expert1&#45;&gt;L3_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M33376.88,-604.36C33376.88,-594.33 33376.88,-586 33376.88,-586 33376.88,-586 31738.69,-586 31738.69,-586 31738.69,-586 31738.69,-555.96 31738.69,-555.96"/>
<polygon fill="black" stroke="black" points="31742.19,-555.96 31738.69,-545.96 31735.19,-555.96 31742.19,-555.96"/>
</g>
<!-- L3_S0_TP5_GPU5_expert1&#45;&gt;L3_S0_TP4_GPU4_moe_ar -->
<g id="edge1037" class="edge">
<title>L3_S0_TP5_GPU5_expert1&#45;&gt;L3_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M33433,-604.36C33433,-594.33 33433,-586 33433,-586 33433,-586 32400.1,-586 32400.1,-586 32400.1,-586 32400.1,-560.9 32400.1,-560.9"/>
<polygon fill="black" stroke="black" points="32403.6,-560.9 32400.1,-550.9 32396.6,-560.9 32403.6,-560.9"/>
</g>
<!-- L3_S0_TP5_GPU5_expert1&#45;&gt;L3_S0_TP5_GPU5_moe_ar -->
<g id="edge1073" class="edge">
<title>L3_S0_TP5_GPU5_expert1&#45;&gt;L3_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M33489.12,-604.36C33489.12,-594.33 33489.12,-586 33489.12,-586 33489.12,-586 32951.98,-586 32951.98,-586 32951.98,-586 32951.98,-575.25 32951.98,-575.25"/>
<polygon fill="black" stroke="black" points="32955.48,-575.25 32951.98,-565.25 32948.48,-575.25 32955.48,-575.25"/>
</g>
<!-- L3_S0_TP5_GPU5_expert1&#45;&gt;L3_S0_TP6_GPU6_moe_ar -->
<g id="edge1109" class="edge">
<title>L3_S0_TP5_GPU5_expert1&#45;&gt;L3_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M33545.25,-604.34C33545.25,-604.34 33545.25,-578.55 33545.25,-578.55"/>
<polygon fill="black" stroke="black" points="33548.75,-578.55 33545.25,-568.55 33541.75,-578.55 33548.75,-578.55"/>
</g>
<!-- L3_S0_TP5_GPU5_expert1&#45;&gt;L3_S0_TP7_GPU7_moe_ar -->
<g id="edge1145" class="edge">
<title>L3_S0_TP5_GPU5_expert1&#45;&gt;L3_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M33601.38,-604.42C33601.38,-601.71 33601.38,-600 33601.38,-600 33601.38,-600 34073.11,-600 34073.11,-600 34073.11,-600 34073.11,-574.86 34073.11,-574.86"/>
<polygon fill="black" stroke="black" points="34076.61,-574.86 34073.11,-564.86 34069.61,-574.86 34076.61,-574.86"/>
</g>
<!-- L3_S0_TP6_GPU6_expert0 -->
<g id="node342" class="node">
<title>L3_S0_TP6_GPU6_expert0</title>
<polygon fill="none" stroke="black" points="34124.5,-672.5 33675.5,-672.5 33675.5,-604.5 34124.5,-604.5 34124.5,-672.5"/>
<text text-anchor="middle" x="33900" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="33900" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="33900" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="33900" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L3_S0_TP6_GPU6_expert0&#45;&gt;L3_S0_TP0_GPU0_moe_ar -->
<g id="edge894" class="edge">
<title>L3_S0_TP6_GPU6_expert0&#45;&gt;L3_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M33944.63,-604.44C33944.63,-594.86 33944.63,-587 33944.63,-587 33944.63,-587 29676.47,-587 29676.47,-587 29676.47,-587 29676.47,-555.97 29676.47,-555.97"/>
<polygon fill="black" stroke="black" points="29679.97,-555.97 29676.47,-545.97 29672.97,-555.97 29679.97,-555.97"/>
</g>
<!-- L3_S0_TP6_GPU6_expert0&#45;&gt;L3_S0_TP1_GPU1_moe_ar -->
<g id="edge930" class="edge">
<title>L3_S0_TP6_GPU6_expert0&#45;&gt;L3_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M33714.16,-604.44C33714.16,-594.86 33714.16,-587 33714.16,-587 33714.16,-587 30107.88,-587 30107.88,-587 30107.88,-587 30107.88,-578.45 30107.88,-578.45"/>
<polygon fill="black" stroke="black" points="30111.38,-578.45 30107.88,-568.45 30104.38,-578.45 30111.38,-578.45"/>
</g>
<!-- L3_S0_TP6_GPU6_expert0&#45;&gt;L3_S0_TP2_GPU2_moe_ar -->
<g id="edge966" class="edge">
<title>L3_S0_TP6_GPU6_expert0&#45;&gt;L3_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M33861.51,-604.48C33861.51,-550.92 33861.51,-453 33861.51,-453 33861.51,-453 31059.17,-453 31059.17,-453 31059.17,-453 31059.17,-486.84 31059.17,-486.84"/>
<polygon fill="black" stroke="black" points="31055.67,-486.84 31059.17,-496.84 31062.67,-486.84 31055.67,-486.84"/>
</g>
<!-- L3_S0_TP6_GPU6_expert0&#45;&gt;L3_S0_TP3_GPU3_moe_ar -->
<g id="edge1002" class="edge">
<title>L3_S0_TP6_GPU6_expert0&#45;&gt;L3_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M33855.49,-604.48C33855.49,-550.92 33855.49,-453 33855.49,-453 33855.49,-453 31772.77,-453 31772.77,-453 31772.77,-453 31772.77,-495.79 31772.77,-495.79"/>
<polygon fill="black" stroke="black" points="31769.27,-495.79 31772.77,-505.79 31776.27,-495.79 31769.27,-495.79"/>
</g>
<!-- L3_S0_TP6_GPU6_expert0&#45;&gt;L3_S0_TP4_GPU4_moe_ar -->
<g id="edge1038" class="edge">
<title>L3_S0_TP6_GPU6_expert0&#45;&gt;L3_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M33733.49,-604.36C33733.49,-594.33 33733.49,-586 33733.49,-586 33733.49,-586 32425.22,-586 32425.22,-586 32425.22,-586 32425.22,-555.96 32425.22,-555.96"/>
<polygon fill="black" stroke="black" points="32428.72,-555.96 32425.22,-545.96 32421.72,-555.96 32428.72,-555.96"/>
</g>
<!-- L3_S0_TP6_GPU6_expert0&#45;&gt;L3_S0_TP5_GPU5_moe_ar -->
<g id="edge1074" class="edge">
<title>L3_S0_TP6_GPU6_expert0&#45;&gt;L3_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M33752.82,-604.36C33752.82,-594.33 33752.82,-586 33752.82,-586 33752.82,-586 32994.08,-586 32994.08,-586 32994.08,-586 32994.08,-572.32 32994.08,-572.32"/>
<polygon fill="black" stroke="black" points="32997.58,-572.32 32994.08,-562.32 32990.58,-572.32 32997.58,-572.32"/>
</g>
<!-- L3_S0_TP6_GPU6_expert0&#45;&gt;L3_S0_TP6_GPU6_moe_ar -->
<g id="edge1110" class="edge">
<title>L3_S0_TP6_GPU6_expert0&#45;&gt;L3_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M33772.15,-604.34C33772.15,-604.34 33772.15,-561.27 33772.15,-561.27"/>
<polygon fill="black" stroke="black" points="33775.65,-561.27 33772.15,-551.27 33768.65,-561.27 33775.65,-561.27"/>
</g>
<!-- L3_S0_TP6_GPU6_expert0&#45;&gt;L3_S0_TP7_GPU7_moe_ar -->
<g id="edge1146" class="edge">
<title>L3_S0_TP6_GPU6_expert0&#45;&gt;L3_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M34098.8,-604.34C34098.8,-604.34 34098.8,-576.36 34098.8,-576.36"/>
<polygon fill="black" stroke="black" points="34102.3,-576.36 34098.8,-566.36 34095.3,-576.36 34102.3,-576.36"/>
</g>
<!-- L3_S0_TP6_GPU6_expert1 -->
<g id="node343" class="node">
<title>L3_S0_TP6_GPU6_expert1</title>
<polygon fill="none" stroke="black" points="34591.5,-672.5 34142.5,-672.5 34142.5,-604.5 34591.5,-604.5 34591.5,-672.5"/>
<text text-anchor="middle" x="34367" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="34367" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="34367" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="34367" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L3_S0_TP6_GPU6_expert1&#45;&gt;L3_S0_TP0_GPU0_moe_ar -->
<g id="edge895" class="edge">
<title>L3_S0_TP6_GPU6_expert1&#45;&gt;L3_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M34208.16,-604.44C34208.16,-594.86 34208.16,-587 34208.16,-587 34208.16,-587 29701.97,-587 29701.97,-587 29701.97,-587 29701.97,-548.96 29701.97,-548.96"/>
<polygon fill="black" stroke="black" points="29705.47,-548.96 29701.97,-538.96 29698.47,-548.96 29705.47,-548.96"/>
</g>
<!-- L3_S0_TP6_GPU6_expert1&#45;&gt;L3_S0_TP1_GPU1_moe_ar -->
<g id="edge931" class="edge">
<title>L3_S0_TP6_GPU6_expert1&#45;&gt;L3_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M34292.17,-672.75C34292.17,-689.87 34292.17,-707 34292.17,-707 34292.17,-707 29930.5,-707 29930.5,-707 29930.5,-707 29930.5,-573.69 29930.5,-573.69"/>
<polygon fill="black" stroke="black" points="29934,-573.69 29930.5,-563.69 29927,-573.69 29934,-573.69"/>
</g>
<!-- L3_S0_TP6_GPU6_expert1&#45;&gt;L3_S0_TP2_GPU2_moe_ar -->
<g id="edge967" class="edge">
<title>L3_S0_TP6_GPU6_expert1&#45;&gt;L3_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M34573.15,-604.48C34573.15,-550.92 34573.15,-453 34573.15,-453 34573.15,-453 31016.88,-453 31016.88,-453 31016.88,-453 31016.88,-478.29 31016.88,-478.29"/>
<polygon fill="black" stroke="black" points="31013.38,-478.29 31016.88,-488.29 31020.38,-478.29 31013.38,-478.29"/>
</g>
<!-- L3_S0_TP6_GPU6_expert1&#45;&gt;L3_S0_TP3_GPU3_moe_ar -->
<g id="edge1003" class="edge">
<title>L3_S0_TP6_GPU6_expert1&#45;&gt;L3_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M34554.81,-604.48C34554.81,-550.92 34554.81,-453 34554.81,-453 34554.81,-453 31757.08,-453 31757.08,-453 31757.08,-453 31757.08,-489.82 31757.08,-489.82"/>
<polygon fill="black" stroke="black" points="31753.58,-489.82 31757.08,-499.82 31760.58,-489.82 31753.58,-489.82"/>
</g>
<!-- L3_S0_TP6_GPU6_expert1&#45;&gt;L3_S0_TP4_GPU4_moe_ar -->
<g id="edge1039" class="edge">
<title>L3_S0_TP6_GPU6_expert1&#45;&gt;L3_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M34273.82,-604.36C34273.82,-594.33 34273.82,-586 34273.82,-586 34273.82,-586 32450.34,-586 32450.34,-586 32450.34,-586 32450.34,-549.03 32450.34,-549.03"/>
<polygon fill="black" stroke="black" points="32453.84,-549.03 32450.34,-539.03 32446.84,-549.03 32453.84,-549.03"/>
</g>
<!-- L3_S0_TP6_GPU6_expert1&#45;&gt;L3_S0_TP5_GPU5_moe_ar -->
<g id="edge1075" class="edge">
<title>L3_S0_TP6_GPU6_expert1&#45;&gt;L3_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M34339.48,-604.36C34339.48,-594.33 34339.48,-586 34339.48,-586 34339.48,-586 33036.17,-586 33036.17,-586 33036.17,-586 33036.17,-568.19 33036.17,-568.19"/>
<polygon fill="black" stroke="black" points="33039.67,-568.19 33036.17,-558.19 33032.67,-568.19 33039.67,-568.19"/>
</g>
<!-- L3_S0_TP6_GPU6_expert1&#45;&gt;L3_S0_TP6_GPU6_moe_ar -->
<g id="edge1111" class="edge">
<title>L3_S0_TP6_GPU6_expert1&#45;&gt;L3_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M34405.14,-604.36C34405.14,-594.33 34405.14,-586 34405.14,-586 34405.14,-586 33791.47,-586 33791.47,-586 33791.47,-586 33791.47,-557.85 33791.47,-557.85"/>
<polygon fill="black" stroke="black" points="33794.97,-557.85 33791.47,-547.85 33787.97,-557.85 33794.97,-557.85"/>
</g>
<!-- L3_S0_TP6_GPU6_expert1&#45;&gt;L3_S0_TP7_GPU7_moe_ar -->
<g id="edge1147" class="edge">
<title>L3_S0_TP6_GPU6_expert1&#45;&gt;L3_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M34470.8,-604.34C34470.8,-604.34 34470.8,-559.3 34470.8,-559.3"/>
<polygon fill="black" stroke="black" points="34474.3,-559.3 34470.8,-549.3 34467.3,-559.3 34474.3,-559.3"/>
</g>
<!-- L3_S0_TP7_GPU7_expert0 -->
<g id="node344" class="node">
<title>L3_S0_TP7_GPU7_expert0</title>
<polygon fill="none" stroke="black" points="35058.5,-672.5 34609.5,-672.5 34609.5,-604.5 35058.5,-604.5 35058.5,-672.5"/>
<text text-anchor="middle" x="34834" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="34834" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="34834" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="34834" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L3_S0_TP7_GPU7_expert0&#45;&gt;L3_S0_TP0_GPU0_moe_ar -->
<g id="edge896" class="edge">
<title>L3_S0_TP7_GPU7_expert0&#45;&gt;L3_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M34850.56,-604.48C34850.56,-550.92 34850.56,-453 34850.56,-453 34850.56,-453 29623.23,-453 29623.23,-453 29623.23,-453 29623.23,-475.52 29623.23,-475.52"/>
<polygon fill="black" stroke="black" points="29619.73,-475.52 29623.23,-485.52 29626.73,-475.52 29619.73,-475.52"/>
</g>
<!-- L3_S0_TP7_GPU7_expert0&#45;&gt;L3_S0_TP1_GPU1_moe_ar -->
<g id="edge932" class="edge">
<title>L3_S0_TP7_GPU7_expert0&#45;&gt;L3_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M34816.12,-604.48C34816.12,-550.92 34816.12,-453 34816.12,-453 34816.12,-453 30236.31,-453 30236.31,-453 30236.31,-453 30236.31,-467.72 30236.31,-467.72"/>
<polygon fill="black" stroke="black" points="30232.81,-467.72 30236.31,-477.72 30239.81,-467.72 30232.81,-467.72"/>
</g>
<!-- L3_S0_TP7_GPU7_expert0&#45;&gt;L3_S0_TP2_GPU2_moe_ar -->
<g id="edge968" class="edge">
<title>L3_S0_TP7_GPU7_expert0&#45;&gt;L3_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M34781.69,-604.48C34781.69,-550.92 34781.69,-453 34781.69,-453 34781.69,-453 30974.58,-453 30974.58,-453 30974.58,-453 30974.58,-472.37 30974.58,-472.37"/>
<polygon fill="black" stroke="black" points="30971.08,-472.37 30974.58,-482.37 30978.08,-472.37 30971.08,-472.37"/>
</g>
<!-- L3_S0_TP7_GPU7_expert0&#45;&gt;L3_S0_TP3_GPU3_moe_ar -->
<g id="edge1004" class="edge">
<title>L3_S0_TP7_GPU7_expert0&#45;&gt;L3_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M34747.25,-604.48C34747.25,-550.92 34747.25,-453 34747.25,-453 34747.25,-453 31741.38,-453 31741.38,-453 31741.38,-453 31741.38,-485.7 31741.38,-485.7"/>
<polygon fill="black" stroke="black" points="31737.88,-485.7 31741.38,-495.7 31744.88,-485.7 31737.88,-485.7"/>
</g>
<!-- L3_S0_TP7_GPU7_expert0&#45;&gt;L3_S0_TP4_GPU4_moe_ar -->
<g id="edge1040" class="edge">
<title>L3_S0_TP7_GPU7_expert0&#45;&gt;L3_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M34816.64,-672.85C34816.64,-687.81 34816.64,-702 34816.64,-702 34816.64,-702 32265.5,-702 32265.5,-702 32265.5,-702 32265.5,-575.3 32265.5,-575.3"/>
<polygon fill="black" stroke="black" points="32269,-575.3 32265.5,-565.3 32262,-575.3 32269,-575.3"/>
</g>
<!-- L3_S0_TP7_GPU7_expert0&#45;&gt;L3_S0_TP5_GPU5_moe_ar -->
<g id="edge1076" class="edge">
<title>L3_S0_TP7_GPU7_expert0&#45;&gt;L3_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M34643.94,-604.36C34643.94,-594.33 34643.94,-586 34643.94,-586 34643.94,-586 33078.27,-586 33078.27,-586 33078.27,-586 33078.27,-562.44 33078.27,-562.44"/>
<polygon fill="black" stroke="black" points="33081.77,-562.44 33078.27,-552.44 33074.77,-562.44 33081.77,-562.44"/>
</g>
<!-- L3_S0_TP7_GPU7_expert0&#45;&gt;L3_S0_TP6_GPU6_moe_ar -->
<g id="edge1112" class="edge">
<title>L3_S0_TP7_GPU7_expert0&#45;&gt;L3_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M34678.38,-604.36C34678.38,-594.33 34678.38,-586 34678.38,-586 34678.38,-586 33810.8,-586 33810.8,-586 33810.8,-586 33810.8,-552.99 33810.8,-552.99"/>
<polygon fill="black" stroke="black" points="33814.3,-552.99 33810.8,-542.99 33807.3,-552.99 33814.3,-552.99"/>
</g>
<!-- L3_S0_TP7_GPU7_expert0&#45;&gt;L3_S0_TP7_GPU7_moe_ar -->
<g id="edge1148" class="edge">
<title>L3_S0_TP7_GPU7_expert0&#45;&gt;L3_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M34712.81,-604.13C34712.81,-580.74 34712.81,-554 34712.81,-554 34712.81,-554 34451.7,-554 34451.7,-554"/>
<polygon fill="black" stroke="black" points="34451.7,-550.5 34441.7,-554 34451.7,-557.5 34451.7,-550.5"/>
</g>
<!-- L3_S0_TP7_GPU7_expert1 -->
<g id="node345" class="node">
<title>L3_S0_TP7_GPU7_expert1</title>
<polygon fill="none" stroke="black" points="35525.5,-672.5 35076.5,-672.5 35076.5,-604.5 35525.5,-604.5 35525.5,-672.5"/>
<text text-anchor="middle" x="35301" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="35301" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="35301" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="35301" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L3_S0_TP7_GPU7_expert1&#45;&gt;L3_S0_TP0_GPU0_moe_ar -->
<g id="edge897" class="edge">
<title>L3_S0_TP7_GPU7_expert1&#45;&gt;L3_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M35475.61,-604.29C35475.61,-550.45 35475.61,-452 35475.61,-452 35475.61,-452 29571.12,-452 29571.12,-452 29571.12,-452 29571.12,-469.43 29571.12,-469.43"/>
<polygon fill="black" stroke="black" points="29567.62,-469.43 29571.12,-479.43 29574.62,-469.43 29567.62,-469.43"/>
</g>
<!-- L3_S0_TP7_GPU7_expert1&#45;&gt;L3_S0_TP1_GPU1_moe_ar -->
<g id="edge933" class="edge">
<title>L3_S0_TP7_GPU7_expert1&#45;&gt;L3_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M35425.72,-604.29C35425.72,-550.45 35425.72,-452 35425.72,-452 35425.72,-452 30058.15,-452 30058.15,-452 30058.15,-452 30058.15,-462.16 30058.15,-462.16"/>
<polygon fill="black" stroke="black" points="30054.65,-462.16 30058.15,-472.16 30061.65,-462.16 30054.65,-462.16"/>
</g>
<!-- L3_S0_TP7_GPU7_expert1&#45;&gt;L3_S0_TP2_GPU2_moe_ar -->
<g id="edge969" class="edge">
<title>L3_S0_TP7_GPU7_expert1&#45;&gt;L3_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M35375.83,-604.29C35375.83,-550.45 35375.83,-452 35375.83,-452 35375.83,-452 30932.29,-452 30932.29,-452 30932.29,-452 30932.29,-468.26 30932.29,-468.26"/>
<polygon fill="black" stroke="black" points="30928.79,-468.26 30932.29,-478.26 30935.79,-468.26 30928.79,-468.26"/>
</g>
<!-- L3_S0_TP7_GPU7_expert1&#45;&gt;L3_S0_TP3_GPU3_moe_ar -->
<g id="edge1005" class="edge">
<title>L3_S0_TP7_GPU7_expert1&#45;&gt;L3_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M35325.94,-604.29C35325.94,-550.45 35325.94,-452 35325.94,-452 35325.94,-452 31725.69,-452 31725.69,-452 31725.69,-452 31725.69,-482.19 31725.69,-482.19"/>
<polygon fill="black" stroke="black" points="31722.19,-482.19 31725.69,-492.19 31729.19,-482.19 31722.19,-482.19"/>
</g>
<!-- L3_S0_TP7_GPU7_expert1&#45;&gt;L3_S0_TP4_GPU4_moe_ar -->
<g id="edge1041" class="edge">
<title>L3_S0_TP7_GPU7_expert1&#45;&gt;L3_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M35276.06,-604.2C35276.06,-555.2 35276.06,-471 35276.06,-471 35276.06,-471 32365.05,-471 32365.05,-471 32365.05,-471 32365.05,-474.5 32365.05,-474.5"/>
<polygon fill="black" stroke="black" points="32361.55,-474.5 32365.05,-484.5 32368.55,-474.5 32361.55,-474.5"/>
</g>
<!-- L3_S0_TP7_GPU7_expert1&#45;&gt;L3_S0_TP5_GPU5_moe_ar -->
<g id="edge1077" class="edge">
<title>L3_S0_TP7_GPU7_expert1&#45;&gt;L3_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M35126.39,-604.36C35126.39,-594.33 35126.39,-586 35126.39,-586 35126.39,-586 33120.37,-586 33120.37,-586 33120.37,-586 33120.37,-554.09 33120.37,-554.09"/>
<polygon fill="black" stroke="black" points="33123.87,-554.09 33120.37,-544.09 33116.87,-554.09 33123.87,-554.09"/>
</g>
<!-- L3_S0_TP7_GPU7_expert1&#45;&gt;L3_S0_TP6_GPU6_moe_ar -->
<g id="edge1113" class="edge">
<title>L3_S0_TP7_GPU7_expert1&#45;&gt;L3_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M35176.28,-604.31C35176.28,-593.83 35176.28,-585 35176.28,-585 35176.28,-585 33830.13,-585 33830.13,-585 33830.13,-585 33830.13,-546.71 33830.13,-546.71"/>
<polygon fill="black" stroke="black" points="33833.63,-546.71 33830.13,-536.71 33826.63,-546.71 33833.63,-546.71"/>
</g>
<!-- L3_S0_TP7_GPU7_expert1&#45;&gt;L3_S0_TP7_GPU7_moe_ar -->
<g id="edge1149" class="edge">
<title>L3_S0_TP7_GPU7_expert1&#45;&gt;L3_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M35226.17,-604.4C35226.17,-576.28 35226.17,-541 35226.17,-541 35226.17,-541 34514.44,-541 34514.44,-541"/>
<polygon fill="black" stroke="black" points="34514.44,-537.5 34504.44,-541 34514.44,-544.5 34514.44,-537.5"/>
</g>
<!-- L3_S0_TP0_GPU0_norm -->
<g id="node347" class="node">
<title>L3_S0_TP0_GPU0_norm</title>
<polygon fill="none" stroke="black" points="28409.5,-332.33 27960.5,-332.33 27960.5,-264.33 28409.5,-264.33 28409.5,-332.33"/>
<text text-anchor="middle" x="28185" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="28185" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="28185" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="28185" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP0_GPU0_moe_res&#45;&gt;L3_S0_TP0_GPU0_norm -->
<g id="edge900" class="edge">
<title>L3_S0_TP0_GPU0_moe_res&#45;&gt;L3_S0_TP0_GPU0_norm</title>
<path fill="none" stroke="black" d="M28185,-368.28C28185,-368.28 28185,-342.46 28185,-342.46"/>
<polygon fill="black" stroke="black" points="28188.5,-342.46 28185,-332.46 28181.5,-342.46 28188.5,-342.46"/>
</g>
<!-- L3_S0_TP1_GPU1_qkv_linear -->
<g id="node348" class="node">
<title>L3_S0_TP1_GPU1_qkv_linear</title>
<polygon fill="none" stroke="black" points="29503,-1614.75 28895,-1614.75 28895,-1546.75 29503,-1546.75 29503,-1614.75"/>
<text text-anchor="middle" x="29199" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="29199" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="29199" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="29199" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L3_S0_TP1_GPU1_qkv_slice -->
<g id="node349" class="node">
<title>L3_S0_TP1_GPU1_qkv_slice</title>
<polygon fill="none" stroke="black" points="29497,-1496.67 28901,-1496.67 28901,-1428.67 29497,-1428.67 29497,-1496.67"/>
<text text-anchor="middle" x="29199" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="29199" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="29199" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="29199" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L3_S0_TP1_GPU1_qkv_linear&#45;&gt;L3_S0_TP1_GPU1_qkv_slice -->
<g id="edge901" class="edge">
<title>L3_S0_TP1_GPU1_qkv_linear&#45;&gt;L3_S0_TP1_GPU1_qkv_slice</title>
<path fill="none" stroke="black" d="M29199,-1546.59C29199,-1546.59 29199,-1506.74 29199,-1506.74"/>
<polygon fill="black" stroke="black" points="29202.5,-1506.74 29199,-1496.74 29195.5,-1506.74 29202.5,-1506.74"/>
</g>
<!-- L3_S0_TP1_GPU1_qkv_slice&#45;&gt;L3_S0_TP1_GPU1_attn_v -->
<g id="edge905" class="edge">
<title>L3_S0_TP1_GPU1_qkv_slice&#45;&gt;L3_S0_TP1_GPU1_attn_v</title>
<path fill="none" stroke="black" d="M28959.75,-1428.38C28959.75,-1428.38 28959.75,-1195 28959.75,-1195"/>
<polygon fill="black" stroke="black" points="28963.25,-1195 28959.75,-1185 28956.25,-1195 28963.25,-1195"/>
</g>
<!-- L3_S0_TP1_GPU1_qk_matmul -->
<g id="node350" class="node">
<title>L3_S0_TP1_GPU1_qk_matmul</title>
<polygon fill="none" stroke="black" points="29914.5,-1392.67 28979.5,-1392.67 28979.5,-1324.67 29914.5,-1324.67 29914.5,-1392.67"/>
<text text-anchor="middle" x="29447" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="29447" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="29447" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="29447" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L3_S0_TP1_GPU1_qkv_slice&#45;&gt;L3_S0_TP1_GPU1_qk_matmul -->
<g id="edge902" class="edge">
<title>L3_S0_TP1_GPU1_qkv_slice&#45;&gt;L3_S0_TP1_GPU1_qk_matmul</title>
<path fill="none" stroke="black" d="M29238.25,-1428.61C29238.25,-1428.61 29238.25,-1402.8 29238.25,-1402.8"/>
<polygon fill="black" stroke="black" points="29241.75,-1402.8 29238.25,-1392.8 29234.75,-1402.8 29241.75,-1402.8"/>
</g>
<!-- L3_S0_TP1_GPU1_softmax -->
<g id="node351" class="node">
<title>L3_S0_TP1_GPU1_softmax</title>
<polygon fill="none" stroke="black" points="29683,-1288.67 29173,-1288.67 29173,-1220.67 29683,-1220.67 29683,-1288.67"/>
<text text-anchor="middle" x="29428" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="29428" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="29428" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="29428" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L3_S0_TP1_GPU1_qk_matmul&#45;&gt;L3_S0_TP1_GPU1_softmax -->
<g id="edge903" class="edge">
<title>L3_S0_TP1_GPU1_qk_matmul&#45;&gt;L3_S0_TP1_GPU1_softmax</title>
<path fill="none" stroke="black" d="M29428,-1324.61C29428,-1324.61 29428,-1298.8 29428,-1298.8"/>
<polygon fill="black" stroke="black" points="29431.5,-1298.8 29428,-1288.8 29424.5,-1298.8 29431.5,-1298.8"/>
</g>
<!-- L3_S0_TP1_GPU1_softmax&#45;&gt;L3_S0_TP1_GPU1_attn_v -->
<g id="edge904" class="edge">
<title>L3_S0_TP1_GPU1_softmax&#45;&gt;L3_S0_TP1_GPU1_attn_v</title>
<path fill="none" stroke="black" d="M29428,-1220.61C29428,-1220.61 29428,-1194.8 29428,-1194.8"/>
<polygon fill="black" stroke="black" points="29431.5,-1194.8 29428,-1184.8 29424.5,-1194.8 29431.5,-1194.8"/>
</g>
<!-- L3_S0_TP1_GPU1_mha_res -->
<g id="node353" class="node">
<title>L3_S0_TP1_GPU1_mha_res</title>
<polygon fill="none" stroke="black" points="29547.5,-948.5 28660.5,-948.5 28660.5,-880.5 29547.5,-880.5 29547.5,-948.5"/>
<text text-anchor="middle" x="29104" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="29104" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="29104" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="29104" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP1_GPU1_mha_ar&#45;&gt;L3_S0_TP1_GPU1_mha_res -->
<g id="edge914" class="edge">
<title>L3_S0_TP1_GPU1_mha_ar&#45;&gt;L3_S0_TP1_GPU1_mha_res</title>
<path fill="none" stroke="black" d="M29524.01,-1015.66C29524.01,-1015.66 29524.01,-958.91 29524.01,-958.91"/>
<polygon fill="black" stroke="black" points="29527.51,-958.91 29524.01,-948.91 29520.51,-958.91 29527.51,-958.91"/>
</g>
<!-- L3_S0_TP1_GPU1_gate -->
<g id="node354" class="node">
<title>L3_S0_TP1_GPU1_gate</title>
<polygon fill="none" stroke="black" points="29633.56,-844.5 28791.15,-844.5 28574.44,-708.5 29416.85,-708.5 29633.56,-844.5"/>
<text text-anchor="middle" x="29104" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="29104" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="29104" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="29104" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L3_S0_TP1_GPU1_mha_res&#45;&gt;L3_S0_TP1_GPU1_gate -->
<g id="edge915" class="edge">
<title>L3_S0_TP1_GPU1_mha_res&#45;&gt;L3_S0_TP1_GPU1_gate</title>
<path fill="none" stroke="black" d="M29104,-880.39C29104,-880.39 29104,-854.73 29104,-854.73"/>
<polygon fill="black" stroke="black" points="29107.5,-854.73 29104,-844.73 29100.5,-854.73 29107.5,-854.73"/>
</g>
<!-- L3_S0_TP1_GPU1_moe_res -->
<g id="node356" class="node">
<title>L3_S0_TP1_GPU1_moe_res</title>
<polygon fill="none" stroke="black" points="29519,-436.33 28699,-436.33 28699,-368.33 29519,-368.33 29519,-436.33"/>
<text text-anchor="middle" x="29109" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="29109" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="29109" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="29109" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP1_GPU1_mha_res&#45;&gt;L3_S0_TP1_GPU1_moe_res -->
<g id="edge935" class="edge">
<title>L3_S0_TP1_GPU1_mha_res&#45;&gt;L3_S0_TP1_GPU1_moe_res</title>
<path fill="none" stroke="black" d="M28660.2,-903C28605.33,-903 28568.07,-903 28568.07,-903 28568.07,-903 28568.07,-672 28568.07,-672 28568.07,-672 28996.5,-672 28996.5,-672 28996.5,-672 28996.5,-446.49 28996.5,-446.49"/>
<polygon fill="black" stroke="black" points="29000,-446.49 28996.5,-436.49 28993,-446.49 29000,-446.49"/>
</g>
<!-- L3_S0_TP1_GPU1_gate&#45;&gt;L3_S0_TP1_GPU1_expert0 -->
<g id="edge916" class="edge">
<title>L3_S0_TP1_GPU1_gate&#45;&gt;L3_S0_TP1_GPU1_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29230,-708.31C29230,-708.31 29230,-682.71 29230,-682.71"/>
<polygon fill="black" stroke="black" points="29233.5,-682.71 29230,-672.71 29226.5,-682.71 29233.5,-682.71"/>
</g>
<!-- L3_S0_TP1_GPU1_gate&#45;&gt;L3_S0_TP1_GPU1_expert1 -->
<g id="edge917" class="edge">
<title>L3_S0_TP1_GPU1_gate&#45;&gt;L3_S0_TP1_GPU1_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29553.14,-776.4C29553.14,-776.4 29553.14,-682.74 29553.14,-682.74"/>
<polygon fill="black" stroke="black" points="29556.64,-682.74 29553.14,-672.74 29549.64,-682.74 29556.64,-682.74"/>
</g>
<!-- L3_S0_TP1_GPU1_moe_ar&#45;&gt;L3_S0_TP1_GPU1_moe_res -->
<g id="edge934" class="edge">
<title>L3_S0_TP1_GPU1_moe_ar&#45;&gt;L3_S0_TP1_GPU1_moe_res</title>
<path fill="none" stroke="black" d="M29812.77,-491.45C29812.77,-456.39 29812.77,-402 29812.77,-402 29812.77,-402 29529.15,-402 29529.15,-402"/>
<polygon fill="black" stroke="black" points="29529.15,-398.5 29519.15,-402 29529.15,-405.5 29529.15,-398.5"/>
</g>
<!-- L3_S0_TP1_GPU1_norm -->
<g id="node357" class="node">
<title>L3_S0_TP1_GPU1_norm</title>
<polygon fill="none" stroke="black" points="29333.5,-332.33 28884.5,-332.33 28884.5,-264.33 29333.5,-264.33 29333.5,-332.33"/>
<text text-anchor="middle" x="29109" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="29109" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="29109" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="29109" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP1_GPU1_moe_res&#45;&gt;L3_S0_TP1_GPU1_norm -->
<g id="edge936" class="edge">
<title>L3_S0_TP1_GPU1_moe_res&#45;&gt;L3_S0_TP1_GPU1_norm</title>
<path fill="none" stroke="black" d="M29109,-368.28C29109,-368.28 29109,-342.46 29109,-342.46"/>
<polygon fill="black" stroke="black" points="29112.5,-342.46 29109,-332.46 29105.5,-342.46 29112.5,-342.46"/>
</g>
<!-- L3_S0_TP2_GPU2_qkv_linear -->
<g id="node358" class="node">
<title>L3_S0_TP2_GPU2_qkv_linear</title>
<polygon fill="none" stroke="black" points="30511,-1614.75 29903,-1614.75 29903,-1546.75 30511,-1546.75 30511,-1614.75"/>
<text text-anchor="middle" x="30207" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="30207" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="30207" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="30207" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L3_S0_TP2_GPU2_qkv_slice -->
<g id="node359" class="node">
<title>L3_S0_TP2_GPU2_qkv_slice</title>
<polygon fill="none" stroke="black" points="30505,-1496.67 29909,-1496.67 29909,-1428.67 30505,-1428.67 30505,-1496.67"/>
<text text-anchor="middle" x="30207" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="30207" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="30207" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="30207" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L3_S0_TP2_GPU2_qkv_linear&#45;&gt;L3_S0_TP2_GPU2_qkv_slice -->
<g id="edge937" class="edge">
<title>L3_S0_TP2_GPU2_qkv_linear&#45;&gt;L3_S0_TP2_GPU2_qkv_slice</title>
<path fill="none" stroke="black" d="M30207,-1546.59C30207,-1546.59 30207,-1506.74 30207,-1506.74"/>
<polygon fill="black" stroke="black" points="30210.5,-1506.74 30207,-1496.74 30203.5,-1506.74 30210.5,-1506.74"/>
</g>
<!-- L3_S0_TP2_GPU2_qkv_slice&#45;&gt;L3_S0_TP2_GPU2_attn_v -->
<g id="edge941" class="edge">
<title>L3_S0_TP2_GPU2_qkv_slice&#45;&gt;L3_S0_TP2_GPU2_attn_v</title>
<path fill="none" stroke="black" d="M29951,-1428.38C29951,-1428.38 29951,-1195 29951,-1195"/>
<polygon fill="black" stroke="black" points="29954.5,-1195 29951,-1185 29947.5,-1195 29954.5,-1195"/>
</g>
<!-- L3_S0_TP2_GPU2_qk_matmul -->
<g id="node360" class="node">
<title>L3_S0_TP2_GPU2_qk_matmul</title>
<polygon fill="none" stroke="black" points="30922.5,-1392.67 29987.5,-1392.67 29987.5,-1324.67 30922.5,-1324.67 30922.5,-1392.67"/>
<text text-anchor="middle" x="30455" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="30455" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="30455" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="30455" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L3_S0_TP2_GPU2_qkv_slice&#45;&gt;L3_S0_TP2_GPU2_qk_matmul -->
<g id="edge938" class="edge">
<title>L3_S0_TP2_GPU2_qkv_slice&#45;&gt;L3_S0_TP2_GPU2_qk_matmul</title>
<path fill="none" stroke="black" d="M30246.25,-1428.61C30246.25,-1428.61 30246.25,-1402.8 30246.25,-1402.8"/>
<polygon fill="black" stroke="black" points="30249.75,-1402.8 30246.25,-1392.8 30242.75,-1402.8 30249.75,-1402.8"/>
</g>
<!-- L3_S0_TP2_GPU2_softmax -->
<g id="node361" class="node">
<title>L3_S0_TP2_GPU2_softmax</title>
<polygon fill="none" stroke="black" points="30665,-1288.67 30155,-1288.67 30155,-1220.67 30665,-1220.67 30665,-1288.67"/>
<text text-anchor="middle" x="30410" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="30410" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="30410" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="30410" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L3_S0_TP2_GPU2_qk_matmul&#45;&gt;L3_S0_TP2_GPU2_softmax -->
<g id="edge939" class="edge">
<title>L3_S0_TP2_GPU2_qk_matmul&#45;&gt;L3_S0_TP2_GPU2_softmax</title>
<path fill="none" stroke="black" d="M30410,-1324.61C30410,-1324.61 30410,-1298.8 30410,-1298.8"/>
<polygon fill="black" stroke="black" points="30413.5,-1298.8 30410,-1288.8 30406.5,-1298.8 30413.5,-1298.8"/>
</g>
<!-- L3_S0_TP2_GPU2_softmax&#45;&gt;L3_S0_TP2_GPU2_attn_v -->
<g id="edge940" class="edge">
<title>L3_S0_TP2_GPU2_softmax&#45;&gt;L3_S0_TP2_GPU2_attn_v</title>
<path fill="none" stroke="black" d="M30410,-1220.61C30410,-1220.61 30410,-1194.8 30410,-1194.8"/>
<polygon fill="black" stroke="black" points="30413.5,-1194.8 30410,-1184.8 30406.5,-1194.8 30413.5,-1194.8"/>
</g>
<!-- L3_S0_TP2_GPU2_mha_res -->
<g id="node363" class="node">
<title>L3_S0_TP2_GPU2_mha_res</title>
<polygon fill="none" stroke="black" points="30625.5,-948.5 29738.5,-948.5 29738.5,-880.5 30625.5,-880.5 30625.5,-948.5"/>
<text text-anchor="middle" x="30182" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="30182" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="30182" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="30182" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP2_GPU2_mha_ar&#45;&gt;L3_S0_TP2_GPU2_mha_res -->
<g id="edge950" class="edge">
<title>L3_S0_TP2_GPU2_mha_ar&#45;&gt;L3_S0_TP2_GPU2_mha_res</title>
<path fill="none" stroke="black" d="M30447.51,-991.61C30447.51,-991.61 30447.51,-958.74 30447.51,-958.74"/>
<polygon fill="black" stroke="black" points="30451.01,-958.74 30447.51,-948.74 30444.01,-958.74 30451.01,-958.74"/>
</g>
<!-- L3_S0_TP2_GPU2_gate -->
<g id="node364" class="node">
<title>L3_S0_TP2_GPU2_gate</title>
<polygon fill="none" stroke="black" points="30711.56,-844.5 29869.15,-844.5 29652.44,-708.5 30494.85,-708.5 30711.56,-844.5"/>
<text text-anchor="middle" x="30182" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="30182" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="30182" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="30182" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L3_S0_TP2_GPU2_mha_res&#45;&gt;L3_S0_TP2_GPU2_gate -->
<g id="edge951" class="edge">
<title>L3_S0_TP2_GPU2_mha_res&#45;&gt;L3_S0_TP2_GPU2_gate</title>
<path fill="none" stroke="black" d="M30182,-880.39C30182,-880.39 30182,-854.73 30182,-854.73"/>
<polygon fill="black" stroke="black" points="30185.5,-854.73 30182,-844.73 30178.5,-854.73 30185.5,-854.73"/>
</g>
<!-- L3_S0_TP2_GPU2_moe_res -->
<g id="node366" class="node">
<title>L3_S0_TP2_GPU2_moe_res</title>
<polygon fill="none" stroke="black" points="30700,-436.33 29880,-436.33 29880,-368.33 30700,-368.33 30700,-436.33"/>
<text text-anchor="middle" x="30290" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="30290" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="30290" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="30290" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP2_GPU2_mha_res&#45;&gt;L3_S0_TP2_GPU2_moe_res -->
<g id="edge971" class="edge">
<title>L3_S0_TP2_GPU2_mha_res&#45;&gt;L3_S0_TP2_GPU2_moe_res</title>
<path fill="none" stroke="black" d="M30625.57,-914C30682.27,-914 30721,-914 30721,-914 30721,-914 30721,-679 30721,-679 30721,-679 30399.75,-679 30399.75,-679 30399.75,-679 30399.75,-587 30399.75,-587 30399.75,-587 30426.51,-587 30426.51,-587 30426.51,-587 30426.51,-446.63 30426.51,-446.63"/>
<polygon fill="black" stroke="black" points="30430.01,-446.63 30426.51,-436.63 30423.01,-446.63 30430.01,-446.63"/>
</g>
<!-- L3_S0_TP2_GPU2_gate&#45;&gt;L3_S0_TP2_GPU2_expert0 -->
<g id="edge952" class="edge">
<title>L3_S0_TP2_GPU2_gate&#45;&gt;L3_S0_TP2_GPU2_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30051.75,-708.31C30051.75,-708.31 30051.75,-682.71 30051.75,-682.71"/>
<polygon fill="black" stroke="black" points="30055.25,-682.71 30051.75,-672.71 30048.25,-682.71 30055.25,-682.71"/>
</g>
<!-- L3_S0_TP2_GPU2_gate&#45;&gt;L3_S0_TP2_GPU2_expert1 -->
<g id="edge953" class="edge">
<title>L3_S0_TP2_GPU2_gate&#45;&gt;L3_S0_TP2_GPU2_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30559.14,-748.57C30559.14,-748.57 30559.14,-682.74 30559.14,-682.74"/>
<polygon fill="black" stroke="black" points="30562.64,-682.74 30559.14,-672.74 30555.64,-682.74 30562.64,-682.74"/>
</g>
<!-- L3_S0_TP2_GPU2_moe_ar&#45;&gt;L3_S0_TP2_GPU2_moe_res -->
<g id="edge970" class="edge">
<title>L3_S0_TP2_GPU2_moe_ar&#45;&gt;L3_S0_TP2_GPU2_moe_res</title>
<path fill="none" stroke="black" d="M30610.85,-477.79C30610.85,-477.79 30610.85,-446.39 30610.85,-446.39"/>
<polygon fill="black" stroke="black" points="30614.35,-446.39 30610.85,-436.39 30607.35,-446.39 30614.35,-446.39"/>
</g>
<!-- L3_S0_TP2_GPU2_norm -->
<g id="node367" class="node">
<title>L3_S0_TP2_GPU2_norm</title>
<polygon fill="none" stroke="black" points="30514.5,-332.33 30065.5,-332.33 30065.5,-264.33 30514.5,-264.33 30514.5,-332.33"/>
<text text-anchor="middle" x="30290" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="30290" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="30290" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="30290" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP2_GPU2_moe_res&#45;&gt;L3_S0_TP2_GPU2_norm -->
<g id="edge972" class="edge">
<title>L3_S0_TP2_GPU2_moe_res&#45;&gt;L3_S0_TP2_GPU2_norm</title>
<path fill="none" stroke="black" d="M30290,-368.28C30290,-368.28 30290,-342.46 30290,-342.46"/>
<polygon fill="black" stroke="black" points="30293.5,-342.46 30290,-332.46 30286.5,-342.46 30293.5,-342.46"/>
</g>
<!-- L3_S0_TP3_GPU3_qkv_linear -->
<g id="node368" class="node">
<title>L3_S0_TP3_GPU3_qkv_linear</title>
<polygon fill="none" stroke="black" points="31511,-1614.75 30903,-1614.75 30903,-1546.75 31511,-1546.75 31511,-1614.75"/>
<text text-anchor="middle" x="31207" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="31207" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="31207" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="31207" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L3_S0_TP3_GPU3_qkv_slice -->
<g id="node369" class="node">
<title>L3_S0_TP3_GPU3_qkv_slice</title>
<polygon fill="none" stroke="black" points="31505,-1496.67 30909,-1496.67 30909,-1428.67 31505,-1428.67 31505,-1496.67"/>
<text text-anchor="middle" x="31207" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="31207" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="31207" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="31207" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L3_S0_TP3_GPU3_qkv_linear&#45;&gt;L3_S0_TP3_GPU3_qkv_slice -->
<g id="edge973" class="edge">
<title>L3_S0_TP3_GPU3_qkv_linear&#45;&gt;L3_S0_TP3_GPU3_qkv_slice</title>
<path fill="none" stroke="black" d="M31207,-1546.59C31207,-1546.59 31207,-1506.74 31207,-1506.74"/>
<polygon fill="black" stroke="black" points="31210.5,-1506.74 31207,-1496.74 31203.5,-1506.74 31210.5,-1506.74"/>
</g>
<!-- L3_S0_TP3_GPU3_qkv_slice&#45;&gt;L3_S0_TP3_GPU3_attn_v -->
<g id="edge977" class="edge">
<title>L3_S0_TP3_GPU3_qkv_slice&#45;&gt;L3_S0_TP3_GPU3_attn_v</title>
<path fill="none" stroke="black" d="M30955,-1428.38C30955,-1428.38 30955,-1195 30955,-1195"/>
<polygon fill="black" stroke="black" points="30958.5,-1195 30955,-1185 30951.5,-1195 30958.5,-1195"/>
</g>
<!-- L3_S0_TP3_GPU3_qk_matmul -->
<g id="node370" class="node">
<title>L3_S0_TP3_GPU3_qk_matmul</title>
<polygon fill="none" stroke="black" points="31922.5,-1392.67 30987.5,-1392.67 30987.5,-1324.67 31922.5,-1324.67 31922.5,-1392.67"/>
<text text-anchor="middle" x="31455" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="31455" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="31455" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="31455" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L3_S0_TP3_GPU3_qkv_slice&#45;&gt;L3_S0_TP3_GPU3_qk_matmul -->
<g id="edge974" class="edge">
<title>L3_S0_TP3_GPU3_qkv_slice&#45;&gt;L3_S0_TP3_GPU3_qk_matmul</title>
<path fill="none" stroke="black" d="M31246.25,-1428.61C31246.25,-1428.61 31246.25,-1402.8 31246.25,-1402.8"/>
<polygon fill="black" stroke="black" points="31249.75,-1402.8 31246.25,-1392.8 31242.75,-1402.8 31249.75,-1402.8"/>
</g>
<!-- L3_S0_TP3_GPU3_softmax -->
<g id="node371" class="node">
<title>L3_S0_TP3_GPU3_softmax</title>
<polygon fill="none" stroke="black" points="31643,-1288.67 31133,-1288.67 31133,-1220.67 31643,-1220.67 31643,-1288.67"/>
<text text-anchor="middle" x="31388" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="31388" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="31388" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="31388" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L3_S0_TP3_GPU3_qk_matmul&#45;&gt;L3_S0_TP3_GPU3_softmax -->
<g id="edge975" class="edge">
<title>L3_S0_TP3_GPU3_qk_matmul&#45;&gt;L3_S0_TP3_GPU3_softmax</title>
<path fill="none" stroke="black" d="M31388,-1324.61C31388,-1324.61 31388,-1298.8 31388,-1298.8"/>
<polygon fill="black" stroke="black" points="31391.5,-1298.8 31388,-1288.8 31384.5,-1298.8 31391.5,-1298.8"/>
</g>
<!-- L3_S0_TP3_GPU3_softmax&#45;&gt;L3_S0_TP3_GPU3_attn_v -->
<g id="edge976" class="edge">
<title>L3_S0_TP3_GPU3_softmax&#45;&gt;L3_S0_TP3_GPU3_attn_v</title>
<path fill="none" stroke="black" d="M31388,-1220.61C31388,-1220.61 31388,-1194.8 31388,-1194.8"/>
<polygon fill="black" stroke="black" points="31391.5,-1194.8 31388,-1184.8 31384.5,-1194.8 31391.5,-1194.8"/>
</g>
<!-- L3_S0_TP3_GPU3_mha_res -->
<g id="node373" class="node">
<title>L3_S0_TP3_GPU3_mha_res</title>
<polygon fill="none" stroke="black" points="31703.5,-948.5 30816.5,-948.5 30816.5,-880.5 31703.5,-880.5 31703.5,-948.5"/>
<text text-anchor="middle" x="31260" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="31260" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="31260" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="31260" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP3_GPU3_mha_ar&#45;&gt;L3_S0_TP3_GPU3_mha_res -->
<g id="edge986" class="edge">
<title>L3_S0_TP3_GPU3_mha_ar&#45;&gt;L3_S0_TP3_GPU3_mha_res</title>
<path fill="none" stroke="black" d="M31371.01,-984.55C31371.01,-984.55 31371.01,-958.73 31371.01,-958.73"/>
<polygon fill="black" stroke="black" points="31374.51,-958.73 31371.01,-948.73 31367.51,-958.73 31374.51,-958.73"/>
</g>
<!-- L3_S0_TP3_GPU3_gate -->
<g id="node374" class="node">
<title>L3_S0_TP3_GPU3_gate</title>
<polygon fill="none" stroke="black" points="31789.56,-844.5 30947.15,-844.5 30730.44,-708.5 31572.85,-708.5 31789.56,-844.5"/>
<text text-anchor="middle" x="31260" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="31260" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="31260" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="31260" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L3_S0_TP3_GPU3_mha_res&#45;&gt;L3_S0_TP3_GPU3_gate -->
<g id="edge987" class="edge">
<title>L3_S0_TP3_GPU3_mha_res&#45;&gt;L3_S0_TP3_GPU3_gate</title>
<path fill="none" stroke="black" d="M31260,-880.39C31260,-880.39 31260,-854.73 31260,-854.73"/>
<polygon fill="black" stroke="black" points="31263.5,-854.73 31260,-844.73 31256.5,-854.73 31263.5,-854.73"/>
</g>
<!-- L3_S0_TP3_GPU3_moe_res -->
<g id="node376" class="node">
<title>L3_S0_TP3_GPU3_moe_res</title>
<polygon fill="none" stroke="black" points="31710,-436.33 30890,-436.33 30890,-368.33 31710,-368.33 31710,-436.33"/>
<text text-anchor="middle" x="31300" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="31300" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="31300" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="31300" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP3_GPU3_mha_res&#45;&gt;L3_S0_TP3_GPU3_moe_res -->
<g id="edge1007" class="edge">
<title>L3_S0_TP3_GPU3_mha_res&#45;&gt;L3_S0_TP3_GPU3_moe_res</title>
<path fill="none" stroke="black" d="M31703.69,-903C31761.88,-903 31801.81,-903 31801.81,-903 31801.81,-903 31801.81,-390 31801.81,-390 31801.81,-390 31720.06,-390 31720.06,-390"/>
<polygon fill="black" stroke="black" points="31720.06,-386.5 31710.06,-390 31720.06,-393.5 31720.06,-386.5"/>
</g>
<!-- L3_S0_TP3_GPU3_gate&#45;&gt;L3_S0_TP3_GPU3_expert0 -->
<g id="edge988" class="edge">
<title>L3_S0_TP3_GPU3_gate&#45;&gt;L3_S0_TP3_GPU3_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M31023.17,-708.31C31023.17,-708.31 31023.17,-682.71 31023.17,-682.71"/>
<polygon fill="black" stroke="black" points="31026.67,-682.71 31023.17,-672.71 31019.67,-682.71 31026.67,-682.71"/>
</g>
<!-- L3_S0_TP3_GPU3_gate&#45;&gt;L3_S0_TP3_GPU3_expert1 -->
<g id="edge989" class="edge">
<title>L3_S0_TP3_GPU3_gate&#45;&gt;L3_S0_TP3_GPU3_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M31452.75,-708.31C31452.75,-708.31 31452.75,-682.71 31452.75,-682.71"/>
<polygon fill="black" stroke="black" points="31456.25,-682.71 31452.75,-672.71 31449.25,-682.71 31456.25,-682.71"/>
</g>
<!-- L3_S0_TP3_GPU3_moe_ar&#45;&gt;L3_S0_TP3_GPU3_moe_res -->
<g id="edge1006" class="edge">
<title>L3_S0_TP3_GPU3_moe_ar&#45;&gt;L3_S0_TP3_GPU3_moe_res</title>
<path fill="none" stroke="black" d="M31513.18,-473.07C31513.18,-473.07 31513.18,-446.61 31513.18,-446.61"/>
<polygon fill="black" stroke="black" points="31516.68,-446.61 31513.18,-436.61 31509.68,-446.61 31516.68,-446.61"/>
</g>
<!-- L3_S0_TP3_GPU3_norm -->
<g id="node377" class="node">
<title>L3_S0_TP3_GPU3_norm</title>
<polygon fill="none" stroke="black" points="31524.5,-332.33 31075.5,-332.33 31075.5,-264.33 31524.5,-264.33 31524.5,-332.33"/>
<text text-anchor="middle" x="31300" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="31300" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="31300" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="31300" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP3_GPU3_moe_res&#45;&gt;L3_S0_TP3_GPU3_norm -->
<g id="edge1008" class="edge">
<title>L3_S0_TP3_GPU3_moe_res&#45;&gt;L3_S0_TP3_GPU3_norm</title>
<path fill="none" stroke="black" d="M31300,-368.28C31300,-368.28 31300,-342.46 31300,-342.46"/>
<polygon fill="black" stroke="black" points="31303.5,-342.46 31300,-332.46 31296.5,-342.46 31303.5,-342.46"/>
</g>
<!-- L3_S0_TP4_GPU4_qkv_linear -->
<g id="node378" class="node">
<title>L3_S0_TP4_GPU4_qkv_linear</title>
<polygon fill="none" stroke="black" points="32507,-1614.75 31899,-1614.75 31899,-1546.75 32507,-1546.75 32507,-1614.75"/>
<text text-anchor="middle" x="32203" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="32203" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="32203" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="32203" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L3_S0_TP4_GPU4_qkv_slice -->
<g id="node379" class="node">
<title>L3_S0_TP4_GPU4_qkv_slice</title>
<polygon fill="none" stroke="black" points="32501,-1496.67 31905,-1496.67 31905,-1428.67 32501,-1428.67 32501,-1496.67"/>
<text text-anchor="middle" x="32203" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="32203" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="32203" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="32203" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L3_S0_TP4_GPU4_qkv_linear&#45;&gt;L3_S0_TP4_GPU4_qkv_slice -->
<g id="edge1009" class="edge">
<title>L3_S0_TP4_GPU4_qkv_linear&#45;&gt;L3_S0_TP4_GPU4_qkv_slice</title>
<path fill="none" stroke="black" d="M32203,-1546.59C32203,-1546.59 32203,-1506.74 32203,-1506.74"/>
<polygon fill="black" stroke="black" points="32206.5,-1506.74 32203,-1496.74 32199.5,-1506.74 32206.5,-1506.74"/>
</g>
<!-- L3_S0_TP4_GPU4_qkv_slice&#45;&gt;L3_S0_TP4_GPU4_attn_v -->
<g id="edge1013" class="edge">
<title>L3_S0_TP4_GPU4_qkv_slice&#45;&gt;L3_S0_TP4_GPU4_attn_v</title>
<path fill="none" stroke="black" d="M31953,-1428.38C31953,-1428.38 31953,-1195 31953,-1195"/>
<polygon fill="black" stroke="black" points="31956.5,-1195 31953,-1185 31949.5,-1195 31956.5,-1195"/>
</g>
<!-- L3_S0_TP4_GPU4_qk_matmul -->
<g id="node380" class="node">
<title>L3_S0_TP4_GPU4_qk_matmul</title>
<polygon fill="none" stroke="black" points="32918.5,-1392.67 31983.5,-1392.67 31983.5,-1324.67 32918.5,-1324.67 32918.5,-1392.67"/>
<text text-anchor="middle" x="32451" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="32451" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="32451" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="32451" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L3_S0_TP4_GPU4_qkv_slice&#45;&gt;L3_S0_TP4_GPU4_qk_matmul -->
<g id="edge1010" class="edge">
<title>L3_S0_TP4_GPU4_qkv_slice&#45;&gt;L3_S0_TP4_GPU4_qk_matmul</title>
<path fill="none" stroke="black" d="M32242.25,-1428.61C32242.25,-1428.61 32242.25,-1402.8 32242.25,-1402.8"/>
<polygon fill="black" stroke="black" points="32245.75,-1402.8 32242.25,-1392.8 32238.75,-1402.8 32245.75,-1402.8"/>
</g>
<!-- L3_S0_TP4_GPU4_softmax -->
<g id="node381" class="node">
<title>L3_S0_TP4_GPU4_softmax</title>
<polygon fill="none" stroke="black" points="32619,-1288.67 32109,-1288.67 32109,-1220.67 32619,-1220.67 32619,-1288.67"/>
<text text-anchor="middle" x="32364" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="32364" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="32364" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="32364" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L3_S0_TP4_GPU4_qk_matmul&#45;&gt;L3_S0_TP4_GPU4_softmax -->
<g id="edge1011" class="edge">
<title>L3_S0_TP4_GPU4_qk_matmul&#45;&gt;L3_S0_TP4_GPU4_softmax</title>
<path fill="none" stroke="black" d="M32364,-1324.61C32364,-1324.61 32364,-1298.8 32364,-1298.8"/>
<polygon fill="black" stroke="black" points="32367.5,-1298.8 32364,-1288.8 32360.5,-1298.8 32367.5,-1298.8"/>
</g>
<!-- L3_S0_TP4_GPU4_softmax&#45;&gt;L3_S0_TP4_GPU4_attn_v -->
<g id="edge1012" class="edge">
<title>L3_S0_TP4_GPU4_softmax&#45;&gt;L3_S0_TP4_GPU4_attn_v</title>
<path fill="none" stroke="black" d="M32364,-1220.61C32364,-1220.61 32364,-1194.8 32364,-1194.8"/>
<polygon fill="black" stroke="black" points="32367.5,-1194.8 32364,-1184.8 32360.5,-1194.8 32367.5,-1194.8"/>
</g>
<!-- L3_S0_TP4_GPU4_mha_res -->
<g id="node383" class="node">
<title>L3_S0_TP4_GPU4_mha_res</title>
<polygon fill="none" stroke="black" points="32781.5,-948.5 31894.5,-948.5 31894.5,-880.5 32781.5,-880.5 32781.5,-948.5"/>
<text text-anchor="middle" x="32338" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="32338" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="32338" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="32338" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP4_GPU4_mha_ar&#45;&gt;L3_S0_TP4_GPU4_mha_res -->
<g id="edge1022" class="edge">
<title>L3_S0_TP4_GPU4_mha_ar&#45;&gt;L3_S0_TP4_GPU4_mha_res</title>
<path fill="none" stroke="black" d="M32226.49,-984.55C32226.49,-984.55 32226.49,-958.73 32226.49,-958.73"/>
<polygon fill="black" stroke="black" points="32229.99,-958.73 32226.49,-948.73 32222.99,-958.73 32229.99,-958.73"/>
</g>
<!-- L3_S0_TP4_GPU4_gate -->
<g id="node384" class="node">
<title>L3_S0_TP4_GPU4_gate</title>
<polygon fill="none" stroke="black" points="32867.56,-844.5 32025.15,-844.5 31808.44,-708.5 32650.85,-708.5 32867.56,-844.5"/>
<text text-anchor="middle" x="32338" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="32338" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="32338" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="32338" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L3_S0_TP4_GPU4_mha_res&#45;&gt;L3_S0_TP4_GPU4_gate -->
<g id="edge1023" class="edge">
<title>L3_S0_TP4_GPU4_mha_res&#45;&gt;L3_S0_TP4_GPU4_gate</title>
<path fill="none" stroke="black" d="M32338,-880.39C32338,-880.39 32338,-854.73 32338,-854.73"/>
<polygon fill="black" stroke="black" points="32341.5,-854.73 32338,-844.73 32334.5,-854.73 32341.5,-854.73"/>
</g>
<!-- L3_S0_TP4_GPU4_moe_res -->
<g id="node386" class="node">
<title>L3_S0_TP4_GPU4_moe_res</title>
<polygon fill="none" stroke="black" points="32633,-436.33 31813,-436.33 31813,-368.33 32633,-368.33 32633,-436.33"/>
<text text-anchor="middle" x="32223" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="32223" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="32223" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="32223" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP4_GPU4_mha_res&#45;&gt;L3_S0_TP4_GPU4_moe_res -->
<g id="edge1043" class="edge">
<title>L3_S0_TP4_GPU4_mha_res&#45;&gt;L3_S0_TP4_GPU4_moe_res</title>
<path fill="none" stroke="black" d="M31894.43,-925C31840.6,-925 31804.18,-925 31804.18,-925 31804.18,-925 31804.18,-413 31804.18,-413 31804.18,-413 31805.05,-413 31805.05,-413"/>
<polygon fill="black" stroke="black" points="31802.92,-416.5 31812.92,-413 31802.92,-409.5 31802.92,-416.5"/>
</g>
<!-- L3_S0_TP4_GPU4_gate&#45;&gt;L3_S0_TP4_GPU4_expert0 -->
<g id="edge1024" class="edge">
<title>L3_S0_TP4_GPU4_gate&#45;&gt;L3_S0_TP4_GPU4_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32144.43,-708.31C32144.43,-708.31 32144.43,-682.71 32144.43,-682.71"/>
<polygon fill="black" stroke="black" points="32147.93,-682.71 32144.43,-672.71 32140.93,-682.71 32147.93,-682.71"/>
</g>
<!-- L3_S0_TP4_GPU4_gate&#45;&gt;L3_S0_TP4_GPU4_expert1 -->
<g id="edge1025" class="edge">
<title>L3_S0_TP4_GPU4_gate&#45;&gt;L3_S0_TP4_GPU4_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32573.83,-708.31C32573.83,-708.31 32573.83,-682.71 32573.83,-682.71"/>
<polygon fill="black" stroke="black" points="32577.33,-682.71 32573.83,-672.71 32570.33,-682.71 32577.33,-682.71"/>
</g>
<!-- L3_S0_TP4_GPU4_moe_ar&#45;&gt;L3_S0_TP4_GPU4_moe_res -->
<g id="edge1042" class="edge">
<title>L3_S0_TP4_GPU4_moe_ar&#45;&gt;L3_S0_TP4_GPU4_moe_res</title>
<path fill="none" stroke="black" d="M32254.64,-475.1C32254.64,-475.1 32254.64,-446.34 32254.64,-446.34"/>
<polygon fill="black" stroke="black" points="32258.14,-446.34 32254.64,-436.34 32251.14,-446.34 32258.14,-446.34"/>
</g>
<!-- L3_S0_TP4_GPU4_norm -->
<g id="node387" class="node">
<title>L3_S0_TP4_GPU4_norm</title>
<polygon fill="none" stroke="black" points="32447.5,-332.33 31998.5,-332.33 31998.5,-264.33 32447.5,-264.33 32447.5,-332.33"/>
<text text-anchor="middle" x="32223" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="32223" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="32223" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="32223" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP4_GPU4_moe_res&#45;&gt;L3_S0_TP4_GPU4_norm -->
<g id="edge1044" class="edge">
<title>L3_S0_TP4_GPU4_moe_res&#45;&gt;L3_S0_TP4_GPU4_norm</title>
<path fill="none" stroke="black" d="M32223,-368.28C32223,-368.28 32223,-342.46 32223,-342.46"/>
<polygon fill="black" stroke="black" points="32226.5,-342.46 32223,-332.46 32219.5,-342.46 32226.5,-342.46"/>
</g>
<!-- L3_S0_TP5_GPU5_qkv_linear -->
<g id="node388" class="node">
<title>L3_S0_TP5_GPU5_qkv_linear</title>
<polygon fill="none" stroke="black" points="33501,-1614.75 32893,-1614.75 32893,-1546.75 33501,-1546.75 33501,-1614.75"/>
<text text-anchor="middle" x="33197" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="33197" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="33197" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="33197" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L3_S0_TP5_GPU5_qkv_slice -->
<g id="node389" class="node">
<title>L3_S0_TP5_GPU5_qkv_slice</title>
<polygon fill="none" stroke="black" points="33495,-1496.67 32899,-1496.67 32899,-1428.67 33495,-1428.67 33495,-1496.67"/>
<text text-anchor="middle" x="33197" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="33197" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="33197" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="33197" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L3_S0_TP5_GPU5_qkv_linear&#45;&gt;L3_S0_TP5_GPU5_qkv_slice -->
<g id="edge1045" class="edge">
<title>L3_S0_TP5_GPU5_qkv_linear&#45;&gt;L3_S0_TP5_GPU5_qkv_slice</title>
<path fill="none" stroke="black" d="M33197,-1546.59C33197,-1546.59 33197,-1506.74 33197,-1506.74"/>
<polygon fill="black" stroke="black" points="33200.5,-1506.74 33197,-1496.74 33193.5,-1506.74 33200.5,-1506.74"/>
</g>
<!-- L3_S0_TP5_GPU5_qkv_slice&#45;&gt;L3_S0_TP5_GPU5_attn_v -->
<g id="edge1049" class="edge">
<title>L3_S0_TP5_GPU5_qkv_slice&#45;&gt;L3_S0_TP5_GPU5_attn_v</title>
<path fill="none" stroke="black" d="M32948,-1428.38C32948,-1428.38 32948,-1195 32948,-1195"/>
<polygon fill="black" stroke="black" points="32951.5,-1195 32948,-1185 32944.5,-1195 32951.5,-1195"/>
</g>
<!-- L3_S0_TP5_GPU5_qk_matmul -->
<g id="node390" class="node">
<title>L3_S0_TP5_GPU5_qk_matmul</title>
<polygon fill="none" stroke="black" points="33912.5,-1392.67 32977.5,-1392.67 32977.5,-1324.67 33912.5,-1324.67 33912.5,-1392.67"/>
<text text-anchor="middle" x="33445" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="33445" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="33445" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="33445" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L3_S0_TP5_GPU5_qkv_slice&#45;&gt;L3_S0_TP5_GPU5_qk_matmul -->
<g id="edge1046" class="edge">
<title>L3_S0_TP5_GPU5_qkv_slice&#45;&gt;L3_S0_TP5_GPU5_qk_matmul</title>
<path fill="none" stroke="black" d="M33236.25,-1428.61C33236.25,-1428.61 33236.25,-1402.8 33236.25,-1402.8"/>
<polygon fill="black" stroke="black" points="33239.75,-1402.8 33236.25,-1392.8 33232.75,-1402.8 33239.75,-1402.8"/>
</g>
<!-- L3_S0_TP5_GPU5_softmax -->
<g id="node391" class="node">
<title>L3_S0_TP5_GPU5_softmax</title>
<polygon fill="none" stroke="black" points="33594,-1288.67 33084,-1288.67 33084,-1220.67 33594,-1220.67 33594,-1288.67"/>
<text text-anchor="middle" x="33339" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="33339" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="33339" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="33339" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L3_S0_TP5_GPU5_qk_matmul&#45;&gt;L3_S0_TP5_GPU5_softmax -->
<g id="edge1047" class="edge">
<title>L3_S0_TP5_GPU5_qk_matmul&#45;&gt;L3_S0_TP5_GPU5_softmax</title>
<path fill="none" stroke="black" d="M33339,-1324.61C33339,-1324.61 33339,-1298.8 33339,-1298.8"/>
<polygon fill="black" stroke="black" points="33342.5,-1298.8 33339,-1288.8 33335.5,-1298.8 33342.5,-1298.8"/>
</g>
<!-- L3_S0_TP5_GPU5_softmax&#45;&gt;L3_S0_TP5_GPU5_attn_v -->
<g id="edge1048" class="edge">
<title>L3_S0_TP5_GPU5_softmax&#45;&gt;L3_S0_TP5_GPU5_attn_v</title>
<path fill="none" stroke="black" d="M33339,-1220.61C33339,-1220.61 33339,-1194.8 33339,-1194.8"/>
<polygon fill="black" stroke="black" points="33342.5,-1194.8 33339,-1184.8 33335.5,-1194.8 33342.5,-1194.8"/>
</g>
<!-- L3_S0_TP5_GPU5_mha_res -->
<g id="node393" class="node">
<title>L3_S0_TP5_GPU5_mha_res</title>
<polygon fill="none" stroke="black" points="33859.5,-948.5 32972.5,-948.5 32972.5,-880.5 33859.5,-880.5 33859.5,-948.5"/>
<text text-anchor="middle" x="33416" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="33416" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="33416" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="33416" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP5_GPU5_mha_ar&#45;&gt;L3_S0_TP5_GPU5_mha_res -->
<g id="edge1058" class="edge">
<title>L3_S0_TP5_GPU5_mha_ar&#45;&gt;L3_S0_TP5_GPU5_mha_res</title>
<path fill="none" stroke="black" d="M33149.99,-991.61C33149.99,-991.61 33149.99,-958.74 33149.99,-958.74"/>
<polygon fill="black" stroke="black" points="33153.49,-958.74 33149.99,-948.74 33146.49,-958.74 33153.49,-958.74"/>
</g>
<!-- L3_S0_TP5_GPU5_gate -->
<g id="node394" class="node">
<title>L3_S0_TP5_GPU5_gate</title>
<polygon fill="none" stroke="black" points="33945.56,-844.5 33103.15,-844.5 32886.44,-708.5 33728.85,-708.5 33945.56,-844.5"/>
<text text-anchor="middle" x="33416" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="33416" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="33416" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="33416" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L3_S0_TP5_GPU5_mha_res&#45;&gt;L3_S0_TP5_GPU5_gate -->
<g id="edge1059" class="edge">
<title>L3_S0_TP5_GPU5_mha_res&#45;&gt;L3_S0_TP5_GPU5_gate</title>
<path fill="none" stroke="black" d="M33416,-880.39C33416,-880.39 33416,-854.73 33416,-854.73"/>
<polygon fill="black" stroke="black" points="33419.5,-854.73 33416,-844.73 33412.5,-854.73 33419.5,-854.73"/>
</g>
<!-- L3_S0_TP5_GPU5_moe_res -->
<g id="node396" class="node">
<title>L3_S0_TP5_GPU5_moe_res</title>
<polygon fill="none" stroke="black" points="33663,-436.33 32843,-436.33 32843,-368.33 33663,-368.33 33663,-436.33"/>
<text text-anchor="middle" x="33253" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="33253" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="33253" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="33253" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP5_GPU5_mha_res&#45;&gt;L3_S0_TP5_GPU5_moe_res -->
<g id="edge1079" class="edge">
<title>L3_S0_TP5_GPU5_mha_res&#45;&gt;L3_S0_TP5_GPU5_moe_res</title>
<path fill="none" stroke="black" d="M32972.43,-914C32915.73,-914 32877,-914 32877,-914 32877,-914 32877,-681 32877,-681 32877,-681 33195.64,-681 33195.64,-681 33195.64,-681 33195.64,-590 33195.64,-590 33195.64,-590 33174.51,-590 33174.51,-590 33174.51,-590 33174.51,-446.75 33174.51,-446.75"/>
<polygon fill="black" stroke="black" points="33178.01,-446.75 33174.51,-436.75 33171.01,-446.75 33178.01,-446.75"/>
</g>
<!-- L3_S0_TP5_GPU5_gate&#45;&gt;L3_S0_TP5_GPU5_expert0 -->
<g id="edge1060" class="edge">
<title>L3_S0_TP5_GPU5_gate&#45;&gt;L3_S0_TP5_GPU5_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33038.36,-708.31C33038.36,-708.31 33038.36,-682.71 33038.36,-682.71"/>
<polygon fill="black" stroke="black" points="33041.86,-682.71 33038.36,-672.71 33034.86,-682.71 33041.86,-682.71"/>
</g>
<!-- L3_S0_TP5_GPU5_gate&#45;&gt;L3_S0_TP5_GPU5_expert1 -->
<g id="edge1061" class="edge">
<title>L3_S0_TP5_GPU5_gate&#45;&gt;L3_S0_TP5_GPU5_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33545.25,-708.31C33545.25,-708.31 33545.25,-682.71 33545.25,-682.71"/>
<polygon fill="black" stroke="black" points="33548.75,-682.71 33545.25,-672.71 33541.75,-682.71 33548.75,-682.71"/>
</g>
<!-- L3_S0_TP5_GPU5_moe_ar&#45;&gt;L3_S0_TP5_GPU5_moe_res -->
<g id="edge1078" class="edge">
<title>L3_S0_TP5_GPU5_moe_ar&#45;&gt;L3_S0_TP5_GPU5_moe_res</title>
<path fill="none" stroke="black" d="M33002.73,-479.12C33002.73,-479.12 33002.73,-446.38 33002.73,-446.38"/>
<polygon fill="black" stroke="black" points="33006.23,-446.38 33002.73,-436.38 32999.23,-446.38 33006.23,-446.38"/>
</g>
<!-- L3_S0_TP5_GPU5_norm -->
<g id="node397" class="node">
<title>L3_S0_TP5_GPU5_norm</title>
<polygon fill="none" stroke="black" points="33477.5,-332.33 33028.5,-332.33 33028.5,-264.33 33477.5,-264.33 33477.5,-332.33"/>
<text text-anchor="middle" x="33253" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="33253" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="33253" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="33253" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP5_GPU5_moe_res&#45;&gt;L3_S0_TP5_GPU5_norm -->
<g id="edge1080" class="edge">
<title>L3_S0_TP5_GPU5_moe_res&#45;&gt;L3_S0_TP5_GPU5_norm</title>
<path fill="none" stroke="black" d="M33253,-368.28C33253,-368.28 33253,-342.46 33253,-342.46"/>
<polygon fill="black" stroke="black" points="33256.5,-342.46 33253,-332.46 33249.5,-342.46 33256.5,-342.46"/>
</g>
<!-- L3_S0_TP6_GPU6_qkv_linear -->
<g id="node398" class="node">
<title>L3_S0_TP6_GPU6_qkv_linear</title>
<polygon fill="none" stroke="black" points="34601,-1614.75 33993,-1614.75 33993,-1546.75 34601,-1546.75 34601,-1614.75"/>
<text text-anchor="middle" x="34297" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="34297" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="34297" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="34297" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L3_S0_TP6_GPU6_qkv_slice -->
<g id="node399" class="node">
<title>L3_S0_TP6_GPU6_qkv_slice</title>
<polygon fill="none" stroke="black" points="34595,-1496.67 33999,-1496.67 33999,-1428.67 34595,-1428.67 34595,-1496.67"/>
<text text-anchor="middle" x="34297" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="34297" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="34297" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="34297" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L3_S0_TP6_GPU6_qkv_linear&#45;&gt;L3_S0_TP6_GPU6_qkv_slice -->
<g id="edge1081" class="edge">
<title>L3_S0_TP6_GPU6_qkv_linear&#45;&gt;L3_S0_TP6_GPU6_qkv_slice</title>
<path fill="none" stroke="black" d="M34297,-1546.59C34297,-1546.59 34297,-1506.74 34297,-1506.74"/>
<polygon fill="black" stroke="black" points="34300.5,-1506.74 34297,-1496.74 34293.5,-1506.74 34300.5,-1506.74"/>
</g>
<!-- L3_S0_TP6_GPU6_qkv_slice&#45;&gt;L3_S0_TP6_GPU6_attn_v -->
<g id="edge1085" class="edge">
<title>L3_S0_TP6_GPU6_qkv_slice&#45;&gt;L3_S0_TP6_GPU6_attn_v</title>
<path fill="none" stroke="black" d="M34038.25,-1428.38C34038.25,-1428.38 34038.25,-1195 34038.25,-1195"/>
<polygon fill="black" stroke="black" points="34041.75,-1195 34038.25,-1185 34034.75,-1195 34041.75,-1195"/>
</g>
<!-- L3_S0_TP6_GPU6_qk_matmul -->
<g id="node400" class="node">
<title>L3_S0_TP6_GPU6_qk_matmul</title>
<polygon fill="none" stroke="black" points="35012.5,-1392.67 34077.5,-1392.67 34077.5,-1324.67 35012.5,-1324.67 35012.5,-1392.67"/>
<text text-anchor="middle" x="34545" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="34545" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="34545" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="34545" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L3_S0_TP6_GPU6_qkv_slice&#45;&gt;L3_S0_TP6_GPU6_qk_matmul -->
<g id="edge1082" class="edge">
<title>L3_S0_TP6_GPU6_qkv_slice&#45;&gt;L3_S0_TP6_GPU6_qk_matmul</title>
<path fill="none" stroke="black" d="M34336.25,-1428.61C34336.25,-1428.61 34336.25,-1402.8 34336.25,-1402.8"/>
<polygon fill="black" stroke="black" points="34339.75,-1402.8 34336.25,-1392.8 34332.75,-1402.8 34339.75,-1402.8"/>
</g>
<!-- L3_S0_TP6_GPU6_softmax -->
<g id="node401" class="node">
<title>L3_S0_TP6_GPU6_softmax</title>
<polygon fill="none" stroke="black" points="34693,-1288.67 34183,-1288.67 34183,-1220.67 34693,-1220.67 34693,-1288.67"/>
<text text-anchor="middle" x="34438" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="34438" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="34438" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="34438" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L3_S0_TP6_GPU6_qk_matmul&#45;&gt;L3_S0_TP6_GPU6_softmax -->
<g id="edge1083" class="edge">
<title>L3_S0_TP6_GPU6_qk_matmul&#45;&gt;L3_S0_TP6_GPU6_softmax</title>
<path fill="none" stroke="black" d="M34438,-1324.61C34438,-1324.61 34438,-1298.8 34438,-1298.8"/>
<polygon fill="black" stroke="black" points="34441.5,-1298.8 34438,-1288.8 34434.5,-1298.8 34441.5,-1298.8"/>
</g>
<!-- L3_S0_TP6_GPU6_softmax&#45;&gt;L3_S0_TP6_GPU6_attn_v -->
<g id="edge1084" class="edge">
<title>L3_S0_TP6_GPU6_softmax&#45;&gt;L3_S0_TP6_GPU6_attn_v</title>
<path fill="none" stroke="black" d="M34420.5,-1220.61C34420.5,-1220.61 34420.5,-1194.8 34420.5,-1194.8"/>
<polygon fill="black" stroke="black" points="34424,-1194.8 34420.5,-1184.8 34417,-1194.8 34424,-1194.8"/>
</g>
<!-- L3_S0_TP6_GPU6_mha_res -->
<g id="node403" class="node">
<title>L3_S0_TP6_GPU6_mha_res</title>
<polygon fill="none" stroke="black" points="34937.5,-948.5 34050.5,-948.5 34050.5,-880.5 34937.5,-880.5 34937.5,-948.5"/>
<text text-anchor="middle" x="34494" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="34494" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="34494" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="34494" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP6_GPU6_mha_ar&#45;&gt;L3_S0_TP6_GPU6_mha_res -->
<g id="edge1094" class="edge">
<title>L3_S0_TP6_GPU6_mha_ar&#45;&gt;L3_S0_TP6_GPU6_mha_res</title>
<path fill="none" stroke="black" d="M34073.49,-1015.91C34073.49,-1015.91 34073.49,-958.58 34073.49,-958.58"/>
<polygon fill="black" stroke="black" points="34076.99,-958.58 34073.49,-948.58 34069.99,-958.58 34076.99,-958.58"/>
</g>
<!-- L3_S0_TP6_GPU6_gate -->
<g id="node404" class="node">
<title>L3_S0_TP6_GPU6_gate</title>
<polygon fill="none" stroke="black" points="35023.56,-844.5 34181.15,-844.5 33964.44,-708.5 34806.85,-708.5 35023.56,-844.5"/>
<text text-anchor="middle" x="34494" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="34494" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="34494" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="34494" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L3_S0_TP6_GPU6_mha_res&#45;&gt;L3_S0_TP6_GPU6_gate -->
<g id="edge1095" class="edge">
<title>L3_S0_TP6_GPU6_mha_res&#45;&gt;L3_S0_TP6_GPU6_gate</title>
<path fill="none" stroke="black" d="M34494,-880.39C34494,-880.39 34494,-854.73 34494,-854.73"/>
<polygon fill="black" stroke="black" points="34497.5,-854.73 34494,-844.73 34490.5,-854.73 34497.5,-854.73"/>
</g>
<!-- L3_S0_TP6_GPU6_moe_res -->
<g id="node406" class="node">
<title>L3_S0_TP6_GPU6_moe_res</title>
<polygon fill="none" stroke="black" points="34885,-436.33 34065,-436.33 34065,-368.33 34885,-368.33 34885,-436.33"/>
<text text-anchor="middle" x="34475" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="34475" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="34475" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="34475" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP6_GPU6_mha_res&#45;&gt;L3_S0_TP6_GPU6_moe_res -->
<g id="edge1115" class="edge">
<title>L3_S0_TP6_GPU6_mha_res&#45;&gt;L3_S0_TP6_GPU6_moe_res</title>
<path fill="none" stroke="black" d="M34937.57,-914C34994.27,-914 35033,-914 35033,-914 35033,-914 35033,-673 35033,-673 35033,-673 34600.5,-673 34600.5,-673 34600.5,-673 34600.5,-446.34 34600.5,-446.34"/>
<polygon fill="black" stroke="black" points="34604,-446.34 34600.5,-436.34 34597,-446.34 34604,-446.34"/>
</g>
<!-- L3_S0_TP6_GPU6_gate&#45;&gt;L3_S0_TP6_GPU6_expert0 -->
<g id="edge1096" class="edge">
<title>L3_S0_TP6_GPU6_gate&#45;&gt;L3_S0_TP6_GPU6_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34044.36,-708.31C34044.36,-708.31 34044.36,-682.71 34044.36,-682.71"/>
<polygon fill="black" stroke="black" points="34047.86,-682.71 34044.36,-672.71 34040.86,-682.71 34047.86,-682.71"/>
</g>
<!-- L3_S0_TP6_GPU6_gate&#45;&gt;L3_S0_TP6_GPU6_expert1 -->
<g id="edge1097" class="edge">
<title>L3_S0_TP6_GPU6_gate&#45;&gt;L3_S0_TP6_GPU6_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34441.83,-708.31C34441.83,-708.31 34441.83,-682.71 34441.83,-682.71"/>
<polygon fill="black" stroke="black" points="34445.33,-682.71 34441.83,-672.71 34438.33,-682.71 34445.33,-682.71"/>
</g>
<!-- L3_S0_TP6_GPU6_moe_ar&#45;&gt;L3_S0_TP6_GPU6_moe_res -->
<g id="edge1114" class="edge">
<title>L3_S0_TP6_GPU6_moe_ar&#45;&gt;L3_S0_TP6_GPU6_moe_res</title>
<path fill="none" stroke="black" d="M33756.23,-486.8C33756.23,-451.79 33756.23,-402 33756.23,-402 33756.23,-402 34054.96,-402 34054.96,-402"/>
<polygon fill="black" stroke="black" points="34054.96,-405.5 34064.96,-402 34054.96,-398.5 34054.96,-405.5"/>
</g>
<!-- L3_S0_TP6_GPU6_norm -->
<g id="node407" class="node">
<title>L3_S0_TP6_GPU6_norm</title>
<polygon fill="none" stroke="black" points="34699.5,-332.33 34250.5,-332.33 34250.5,-264.33 34699.5,-264.33 34699.5,-332.33"/>
<text text-anchor="middle" x="34475" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="34475" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="34475" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="34475" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP6_GPU6_moe_res&#45;&gt;L3_S0_TP6_GPU6_norm -->
<g id="edge1116" class="edge">
<title>L3_S0_TP6_GPU6_moe_res&#45;&gt;L3_S0_TP6_GPU6_norm</title>
<path fill="none" stroke="black" d="M34475,-368.28C34475,-368.28 34475,-342.46 34475,-342.46"/>
<polygon fill="black" stroke="black" points="34478.5,-342.46 34475,-332.46 34471.5,-342.46 34478.5,-342.46"/>
</g>
<!-- L3_S0_TP7_GPU7_qkv_linear -->
<g id="node408" class="node">
<title>L3_S0_TP7_GPU7_qkv_linear</title>
<polygon fill="none" stroke="black" points="35647,-1614.75 35039,-1614.75 35039,-1546.75 35647,-1546.75 35647,-1614.75"/>
<text text-anchor="middle" x="35343" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="35343" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="35343" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="35343" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L3_S0_TP7_GPU7_qkv_slice -->
<g id="node409" class="node">
<title>L3_S0_TP7_GPU7_qkv_slice</title>
<polygon fill="none" stroke="black" points="35641,-1496.67 35045,-1496.67 35045,-1428.67 35641,-1428.67 35641,-1496.67"/>
<text text-anchor="middle" x="35343" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="35343" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="35343" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="35343" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L3_S0_TP7_GPU7_qkv_linear&#45;&gt;L3_S0_TP7_GPU7_qkv_slice -->
<g id="edge1117" class="edge">
<title>L3_S0_TP7_GPU7_qkv_linear&#45;&gt;L3_S0_TP7_GPU7_qkv_slice</title>
<path fill="none" stroke="black" d="M35343,-1546.59C35343,-1546.59 35343,-1506.74 35343,-1506.74"/>
<polygon fill="black" stroke="black" points="35346.5,-1506.74 35343,-1496.74 35339.5,-1506.74 35346.5,-1506.74"/>
</g>
<!-- L3_S0_TP7_GPU7_qkv_slice&#45;&gt;L3_S0_TP7_GPU7_attn_v -->
<g id="edge1121" class="edge">
<title>L3_S0_TP7_GPU7_qkv_slice&#45;&gt;L3_S0_TP7_GPU7_attn_v</title>
<path fill="none" stroke="black" d="M35084.25,-1428.38C35084.25,-1428.38 35084.25,-1195 35084.25,-1195"/>
<polygon fill="black" stroke="black" points="35087.75,-1195 35084.25,-1185 35080.75,-1195 35087.75,-1195"/>
</g>
<!-- L3_S0_TP7_GPU7_qk_matmul -->
<g id="node410" class="node">
<title>L3_S0_TP7_GPU7_qk_matmul</title>
<polygon fill="none" stroke="black" points="36058.5,-1392.67 35123.5,-1392.67 35123.5,-1324.67 36058.5,-1324.67 36058.5,-1392.67"/>
<text text-anchor="middle" x="35591" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="35591" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="35591" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="35591" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L3_S0_TP7_GPU7_qkv_slice&#45;&gt;L3_S0_TP7_GPU7_qk_matmul -->
<g id="edge1118" class="edge">
<title>L3_S0_TP7_GPU7_qkv_slice&#45;&gt;L3_S0_TP7_GPU7_qk_matmul</title>
<path fill="none" stroke="black" d="M35382.25,-1428.61C35382.25,-1428.61 35382.25,-1402.8 35382.25,-1402.8"/>
<polygon fill="black" stroke="black" points="35385.75,-1402.8 35382.25,-1392.8 35378.75,-1402.8 35385.75,-1402.8"/>
</g>
<!-- L3_S0_TP7_GPU7_softmax -->
<g id="node411" class="node">
<title>L3_S0_TP7_GPU7_softmax</title>
<polygon fill="none" stroke="black" points="35739,-1288.67 35229,-1288.67 35229,-1220.67 35739,-1220.67 35739,-1288.67"/>
<text text-anchor="middle" x="35484" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="35484" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="35484" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="35484" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L3_S0_TP7_GPU7_qk_matmul&#45;&gt;L3_S0_TP7_GPU7_softmax -->
<g id="edge1119" class="edge">
<title>L3_S0_TP7_GPU7_qk_matmul&#45;&gt;L3_S0_TP7_GPU7_softmax</title>
<path fill="none" stroke="black" d="M35484,-1324.61C35484,-1324.61 35484,-1298.8 35484,-1298.8"/>
<polygon fill="black" stroke="black" points="35487.5,-1298.8 35484,-1288.8 35480.5,-1298.8 35487.5,-1298.8"/>
</g>
<!-- L3_S0_TP7_GPU7_softmax&#45;&gt;L3_S0_TP7_GPU7_attn_v -->
<g id="edge1120" class="edge">
<title>L3_S0_TP7_GPU7_softmax&#45;&gt;L3_S0_TP7_GPU7_attn_v</title>
<path fill="none" stroke="black" d="M35421.5,-1220.61C35421.5,-1220.61 35421.5,-1194.8 35421.5,-1194.8"/>
<polygon fill="black" stroke="black" points="35425,-1194.8 35421.5,-1184.8 35418,-1194.8 35425,-1194.8"/>
</g>
<!-- L3_S0_TP7_GPU7_mha_res -->
<g id="node413" class="node">
<title>L3_S0_TP7_GPU7_mha_res</title>
<polygon fill="none" stroke="black" points="36015.5,-948.5 35128.5,-948.5 35128.5,-880.5 36015.5,-880.5 36015.5,-948.5"/>
<text text-anchor="middle" x="35572" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="35572" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="35572" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="35572" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP7_GPU7_mha_ar&#45;&gt;L3_S0_TP7_GPU7_mha_res -->
<g id="edge1130" class="edge">
<title>L3_S0_TP7_GPU7_mha_ar&#45;&gt;L3_S0_TP7_GPU7_mha_res</title>
<path fill="none" stroke="black" d="M34842.73,-1016C35088.04,-1016 35371.25,-1016 35371.25,-1016 35371.25,-1016 35371.25,-958.58 35371.25,-958.58"/>
<polygon fill="black" stroke="black" points="35374.75,-958.58 35371.25,-948.58 35367.75,-958.58 35374.75,-958.58"/>
</g>
<!-- L3_S0_TP7_GPU7_gate -->
<g id="node414" class="node">
<title>L3_S0_TP7_GPU7_gate</title>
<polygon fill="none" stroke="black" points="36101.56,-844.5 35259.15,-844.5 35042.44,-708.5 35884.85,-708.5 36101.56,-844.5"/>
<text text-anchor="middle" x="35572" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="35572" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="35572" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="35572" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L3_S0_TP7_GPU7_mha_res&#45;&gt;L3_S0_TP7_GPU7_gate -->
<g id="edge1131" class="edge">
<title>L3_S0_TP7_GPU7_mha_res&#45;&gt;L3_S0_TP7_GPU7_gate</title>
<path fill="none" stroke="black" d="M35572,-880.39C35572,-880.39 35572,-854.73 35572,-854.73"/>
<polygon fill="black" stroke="black" points="35575.5,-854.73 35572,-844.73 35568.5,-854.73 35575.5,-854.73"/>
</g>
<!-- L3_S0_TP7_GPU7_moe_res -->
<g id="node416" class="node">
<title>L3_S0_TP7_GPU7_moe_res</title>
<polygon fill="none" stroke="black" points="36491,-436.33 35671,-436.33 35671,-368.33 36491,-368.33 36491,-436.33"/>
<text text-anchor="middle" x="36081" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="36081" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="36081" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="36081" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP7_GPU7_mha_res&#45;&gt;L3_S0_TP7_GPU7_moe_res -->
<g id="edge1151" class="edge">
<title>L3_S0_TP7_GPU7_mha_res&#45;&gt;L3_S0_TP7_GPU7_moe_res</title>
<path fill="none" stroke="black" d="M36015.54,-925C36165.82,-925 36296.39,-925 36296.39,-925 36296.39,-925 36296.39,-446.63 36296.39,-446.63"/>
<polygon fill="black" stroke="black" points="36299.89,-446.63 36296.39,-436.63 36292.89,-446.63 36299.89,-446.63"/>
</g>
<!-- L3_S0_TP7_GPU7_gate&#45;&gt;L3_S0_TP7_GPU7_expert0 -->
<g id="edge1132" class="edge">
<title>L3_S0_TP7_GPU7_gate&#45;&gt;L3_S0_TP7_GPU7_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35050.36,-776.4C35050.36,-776.4 35050.36,-682.74 35050.36,-682.74"/>
<polygon fill="black" stroke="black" points="35053.86,-682.74 35050.36,-672.74 35046.86,-682.74 35053.86,-682.74"/>
</g>
<!-- L3_S0_TP7_GPU7_gate&#45;&gt;L3_S0_TP7_GPU7_expert1 -->
<g id="edge1133" class="edge">
<title>L3_S0_TP7_GPU7_gate&#45;&gt;L3_S0_TP7_GPU7_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35301,-708.31C35301,-708.31 35301,-682.71 35301,-682.71"/>
<polygon fill="black" stroke="black" points="35304.5,-682.71 35301,-672.71 35297.5,-682.71 35304.5,-682.71"/>
</g>
<!-- L3_S0_TP7_GPU7_moe_ar&#45;&gt;L3_S0_TP7_GPU7_moe_res -->
<g id="edge1150" class="edge">
<title>L3_S0_TP7_GPU7_moe_ar&#45;&gt;L3_S0_TP7_GPU7_moe_res</title>
<path fill="none" stroke="black" d="M34533.52,-527C35024.19,-527 35886.39,-527 35886.39,-527 35886.39,-527 35886.39,-446.4 35886.39,-446.4"/>
<polygon fill="black" stroke="black" points="35889.89,-446.4 35886.39,-436.4 35882.89,-446.4 35889.89,-446.4"/>
</g>
<!-- L3_S0_TP7_GPU7_norm -->
<g id="node417" class="node">
<title>L3_S0_TP7_GPU7_norm</title>
<polygon fill="none" stroke="black" points="36305.5,-332.33 35856.5,-332.33 35856.5,-264.33 36305.5,-264.33 36305.5,-332.33"/>
<text text-anchor="middle" x="36081" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="36081" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="36081" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="36081" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L3_S0_TP7_GPU7_moe_res&#45;&gt;L3_S0_TP7_GPU7_norm -->
<g id="edge1152" class="edge">
<title>L3_S0_TP7_GPU7_moe_res&#45;&gt;L3_S0_TP7_GPU7_norm</title>
<path fill="none" stroke="black" d="M36081,-368.28C36081,-368.28 36081,-342.46 36081,-342.46"/>
<polygon fill="black" stroke="black" points="36084.5,-342.46 36081,-332.46 36077.5,-342.46 36084.5,-342.46"/>
</g>
<!-- L4_S0_TP0_GPU0_qkv_linear -->
<g id="node418" class="node">
<title>L4_S0_TP0_GPU0_qkv_linear</title>
<polygon fill="none" stroke="black" points="37819,-1614.75 37211,-1614.75 37211,-1546.75 37819,-1546.75 37819,-1614.75"/>
<text text-anchor="middle" x="37515" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="37515" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="37515" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="37515" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L4_S0_TP0_GPU0_qkv_slice -->
<g id="node419" class="node">
<title>L4_S0_TP0_GPU0_qkv_slice</title>
<polygon fill="none" stroke="black" points="37813,-1496.67 37217,-1496.67 37217,-1428.67 37813,-1428.67 37813,-1496.67"/>
<text text-anchor="middle" x="37515" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="37515" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="37515" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="37515" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L4_S0_TP0_GPU0_qkv_linear&#45;&gt;L4_S0_TP0_GPU0_qkv_slice -->
<g id="edge1153" class="edge">
<title>L4_S0_TP0_GPU0_qkv_linear&#45;&gt;L4_S0_TP0_GPU0_qkv_slice</title>
<path fill="none" stroke="black" d="M37515,-1546.59C37515,-1546.59 37515,-1506.74 37515,-1506.74"/>
<polygon fill="black" stroke="black" points="37518.5,-1506.74 37515,-1496.74 37511.5,-1506.74 37518.5,-1506.74"/>
</g>
<!-- L4_S0_TP0_GPU0_qk_matmul -->
<g id="node420" class="node">
<title>L4_S0_TP0_GPU0_qk_matmul</title>
<polygon fill="none" stroke="black" points="38269.5,-1392.67 37334.5,-1392.67 37334.5,-1324.67 38269.5,-1324.67 38269.5,-1392.67"/>
<text text-anchor="middle" x="37802" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="37802" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="37802" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="37802" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L4_S0_TP0_GPU0_qkv_slice&#45;&gt;L4_S0_TP0_GPU0_qk_matmul -->
<g id="edge1154" class="edge">
<title>L4_S0_TP0_GPU0_qkv_slice&#45;&gt;L4_S0_TP0_GPU0_qk_matmul</title>
<path fill="none" stroke="black" d="M37573.75,-1428.61C37573.75,-1428.61 37573.75,-1402.8 37573.75,-1402.8"/>
<polygon fill="black" stroke="black" points="37577.25,-1402.8 37573.75,-1392.8 37570.25,-1402.8 37577.25,-1402.8"/>
</g>
<!-- L4_S0_TP0_GPU0_attn_v -->
<g id="node422" class="node">
<title>L4_S0_TP0_GPU0_attn_v</title>
<polygon fill="none" stroke="black" points="38251,-1184.67 37313,-1184.67 37313,-1116.67 38251,-1116.67 38251,-1184.67"/>
<text text-anchor="middle" x="37782" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="37782" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="37782" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="37782" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L4_S0_TP0_GPU0_qkv_slice&#45;&gt;L4_S0_TP0_GPU0_attn_v -->
<g id="edge1157" class="edge">
<title>L4_S0_TP0_GPU0_qkv_slice&#45;&gt;L4_S0_TP0_GPU0_attn_v</title>
<path fill="none" stroke="black" d="M37323.75,-1428.38C37323.75,-1428.38 37323.75,-1195 37323.75,-1195"/>
<polygon fill="black" stroke="black" points="37327.25,-1195 37323.75,-1185 37320.25,-1195 37327.25,-1195"/>
</g>
<!-- L4_S0_TP0_GPU0_softmax -->
<g id="node421" class="node">
<title>L4_S0_TP0_GPU0_softmax</title>
<polygon fill="none" stroke="black" points="38044,-1288.67 37534,-1288.67 37534,-1220.67 38044,-1220.67 38044,-1288.67"/>
<text text-anchor="middle" x="37789" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="37789" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="37789" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="37789" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L4_S0_TP0_GPU0_qk_matmul&#45;&gt;L4_S0_TP0_GPU0_softmax -->
<g id="edge1155" class="edge">
<title>L4_S0_TP0_GPU0_qk_matmul&#45;&gt;L4_S0_TP0_GPU0_softmax</title>
<path fill="none" stroke="black" d="M37789,-1324.61C37789,-1324.61 37789,-1298.8 37789,-1298.8"/>
<polygon fill="black" stroke="black" points="37792.5,-1298.8 37789,-1288.8 37785.5,-1298.8 37792.5,-1298.8"/>
</g>
<!-- L4_S0_TP0_GPU0_softmax&#45;&gt;L4_S0_TP0_GPU0_attn_v -->
<g id="edge1156" class="edge">
<title>L4_S0_TP0_GPU0_softmax&#45;&gt;L4_S0_TP0_GPU0_attn_v</title>
<path fill="none" stroke="black" d="M37789,-1220.61C37789,-1220.61 37789,-1194.8 37789,-1194.8"/>
<polygon fill="black" stroke="black" points="37792.5,-1194.8 37789,-1184.8 37785.5,-1194.8 37792.5,-1194.8"/>
</g>
<!-- L4_S0_TP0_GPU0_mha_ar -->
<g id="node423" class="node">
<title>L4_S0_TP0_GPU0_mha_ar</title>
<ellipse fill="none" stroke="black" cx="38436" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="38436" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="38436" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="38436" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="38436" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP0_GPU0_attn_v&#45;&gt;L4_S0_TP0_GPU0_mha_ar -->
<g id="edge1158" class="edge">
<title>L4_S0_TP0_GPU0_attn_v&#45;&gt;L4_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M38092.27,-1116.51C38092.27,-1116.51 38092.27,-1061.95 38092.27,-1061.95"/>
<polygon fill="black" stroke="black" points="38095.77,-1061.95 38092.27,-1051.95 38088.77,-1061.95 38095.77,-1061.95"/>
</g>
<!-- L4_S0_TP1_GPU1_mha_ar -->
<g id="node456" class="node">
<title>L4_S0_TP1_GPU1_mha_ar</title>
<ellipse fill="none" stroke="black" cx="39205" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="39205" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="39205" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="39205" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="39205" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP0_GPU0_attn_v&#45;&gt;L4_S0_TP1_GPU1_mha_ar -->
<g id="edge1194" class="edge">
<title>L4_S0_TP0_GPU0_attn_v&#45;&gt;L4_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M38124.02,-1116.33C38124.02,-1099.17 38124.02,-1082 38124.02,-1082 38124.02,-1082 38876.71,-1082 38876.71,-1082 38876.71,-1082 38876.71,-1066.13 38876.71,-1066.13"/>
<polygon fill="black" stroke="black" points="38880.21,-1066.13 38876.71,-1056.13 38873.21,-1066.13 38880.21,-1066.13"/>
</g>
<!-- L4_S0_TP2_GPU2_mha_ar -->
<g id="node466" class="node">
<title>L4_S0_TP2_GPU2_mha_ar</title>
<ellipse fill="none" stroke="black" cx="39974" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="39974" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="39974" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="39974" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="39974" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP0_GPU0_attn_v&#45;&gt;L4_S0_TP2_GPU2_mha_ar -->
<g id="edge1230" class="edge">
<title>L4_S0_TP0_GPU0_attn_v&#45;&gt;L4_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M38155.76,-1116.33C38155.76,-1099.17 38155.76,-1082 38155.76,-1082 38155.76,-1082 39669.09,-1082 39669.09,-1082 39669.09,-1082 39669.09,-1070.76 39669.09,-1070.76"/>
<polygon fill="black" stroke="black" points="39672.59,-1070.76 39669.09,-1060.76 39665.59,-1070.76 39672.59,-1070.76"/>
</g>
<!-- L4_S0_TP3_GPU3_mha_ar -->
<g id="node476" class="node">
<title>L4_S0_TP3_GPU3_mha_ar</title>
<ellipse fill="none" stroke="black" cx="40743" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="40743" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="40743" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="40743" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="40743" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP0_GPU0_attn_v&#45;&gt;L4_S0_TP3_GPU3_mha_ar -->
<g id="edge1266" class="edge">
<title>L4_S0_TP0_GPU0_attn_v&#45;&gt;L4_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M38187.51,-1116.33C38187.51,-1099.17 38187.51,-1082 38187.51,-1082 38187.51,-1082 40461.39,-1082 40461.39,-1082 40461.39,-1082 40461.39,-1074.44 40461.39,-1074.44"/>
<polygon fill="black" stroke="black" points="40464.89,-1074.44 40461.39,-1064.44 40457.89,-1074.44 40464.89,-1074.44"/>
</g>
<!-- L4_S0_TP4_GPU4_mha_ar -->
<g id="node486" class="node">
<title>L4_S0_TP4_GPU4_mha_ar</title>
<ellipse fill="none" stroke="black" cx="41512" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="41512" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="41512" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="41512" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="41512" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP0_GPU0_attn_v&#45;&gt;L4_S0_TP4_GPU4_mha_ar -->
<g id="edge1302" class="edge">
<title>L4_S0_TP0_GPU0_attn_v&#45;&gt;L4_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M38024.51,-1116.24C38024.51,-1059.6 38024.51,-953 38024.51,-953 38024.51,-953 41193.84,-953 41193.84,-953 41193.84,-953 41193.84,-996.96 41193.84,-996.96"/>
<polygon fill="black" stroke="black" points="41190.34,-996.96 41193.84,-1006.96 41197.34,-996.96 41190.34,-996.96"/>
</g>
<!-- L4_S0_TP5_GPU5_mha_ar -->
<g id="node496" class="node">
<title>L4_S0_TP5_GPU5_mha_ar</title>
<ellipse fill="none" stroke="black" cx="42281" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="42281" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="42281" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="42281" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="42281" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP0_GPU0_attn_v&#45;&gt;L4_S0_TP5_GPU5_mha_ar -->
<g id="edge1338" class="edge">
<title>L4_S0_TP0_GPU0_attn_v&#45;&gt;L4_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M38182,-1184.84C38182,-1198.03 38182,-1210 38182,-1210 38182,-1210 42089.5,-1210 42089.5,-1210 42089.5,-1210 42089.5,-1084.18 42089.5,-1084.18"/>
<polygon fill="black" stroke="black" points="42093,-1084.18 42089.5,-1074.18 42086,-1084.18 42093,-1084.18"/>
</g>
<!-- L4_S0_TP6_GPU6_mha_ar -->
<g id="node506" class="node">
<title>L4_S0_TP6_GPU6_mha_ar</title>
<ellipse fill="none" stroke="black" cx="43050" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="43050" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="43050" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="43050" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="43050" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP0_GPU0_attn_v&#45;&gt;L4_S0_TP6_GPU6_mha_ar -->
<g id="edge1374" class="edge">
<title>L4_S0_TP0_GPU0_attn_v&#45;&gt;L4_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M38113,-1185C38113,-1201.18 38113,-1217 38113,-1217 38113,-1217 43040,-1217 43040,-1217 43040,-1217 43040,-1091.04 43040,-1091.04"/>
<polygon fill="black" stroke="black" points="43043.5,-1091.04 43040,-1081.04 43036.5,-1091.04 43043.5,-1091.04"/>
</g>
<!-- L4_S0_TP7_GPU7_mha_ar -->
<g id="node516" class="node">
<title>L4_S0_TP7_GPU7_mha_ar</title>
<ellipse fill="none" stroke="black" cx="43819" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="43819" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="43819" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="43819" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="43819" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP0_GPU0_attn_v&#45;&gt;L4_S0_TP7_GPU7_mha_ar -->
<g id="edge1410" class="edge">
<title>L4_S0_TP0_GPU0_attn_v&#45;&gt;L4_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M38219.25,-1116.42C38219.25,-1106.36 38219.25,-1098 38219.25,-1098 38219.25,-1098 43511.46,-1098 43511.46,-1098 43511.46,-1098 43511.46,-1070.33 43511.46,-1070.33"/>
<polygon fill="black" stroke="black" points="43514.96,-1070.33 43511.46,-1060.33 43507.96,-1070.33 43514.96,-1070.33"/>
</g>
<!-- L4_S0_TP0_GPU0_mha_res -->
<g id="node431" class="node">
<title>L4_S0_TP0_GPU0_mha_res</title>
<polygon fill="none" stroke="black" points="37797.5,-948.5 36910.5,-948.5 36910.5,-880.5 37797.5,-880.5 37797.5,-948.5"/>
<text text-anchor="middle" x="37354" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="37354" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="37354" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="37354" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP0_GPU0_mha_ar&#45;&gt;L4_S0_TP0_GPU0_mha_res -->
<g id="edge1166" class="edge">
<title>L4_S0_TP0_GPU0_mha_ar&#45;&gt;L4_S0_TP0_GPU0_mha_res</title>
<path fill="none" stroke="black" d="M38080.3,-1048C37835.86,-1048 37555.25,-1048 37555.25,-1048 37555.25,-1048 37555.25,-958.53 37555.25,-958.53"/>
<polygon fill="black" stroke="black" points="37558.75,-958.53 37555.25,-948.53 37551.75,-958.53 37558.75,-958.53"/>
</g>
<!-- L4_S0_TP1_GPU1_attn_v -->
<g id="node424" class="node">
<title>L4_S0_TP1_GPU1_attn_v</title>
<polygon fill="none" stroke="black" points="39207,-1184.67 38269,-1184.67 38269,-1116.67 39207,-1116.67 39207,-1184.67"/>
<text text-anchor="middle" x="38738" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="38738" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="38738" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="38738" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L4_S0_TP1_GPU1_attn_v&#45;&gt;L4_S0_TP0_GPU0_mha_ar -->
<g id="edge1159" class="edge">
<title>L4_S0_TP1_GPU1_attn_v&#45;&gt;L4_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M38336.81,-1116.51C38336.81,-1116.51 38336.81,-1088.96 38336.81,-1088.96"/>
<polygon fill="black" stroke="black" points="38340.31,-1088.96 38336.81,-1078.96 38333.31,-1088.96 38340.31,-1088.96"/>
</g>
<!-- L4_S0_TP1_GPU1_attn_v&#45;&gt;L4_S0_TP1_GPU1_mha_ar -->
<g id="edge1195" class="edge">
<title>L4_S0_TP1_GPU1_attn_v&#45;&gt;L4_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M38923.89,-1116.51C38923.89,-1116.51 38923.89,-1074.64 38923.89,-1074.64"/>
<polygon fill="black" stroke="black" points="38927.39,-1074.64 38923.89,-1064.64 38920.39,-1074.64 38927.39,-1074.64"/>
</g>
<!-- L4_S0_TP1_GPU1_attn_v&#45;&gt;L4_S0_TP2_GPU2_mha_ar -->
<g id="edge1231" class="edge">
<title>L4_S0_TP1_GPU1_attn_v&#45;&gt;L4_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M38971.08,-1116.33C38971.08,-1099.17 38971.08,-1082 38971.08,-1082 38971.08,-1082 39739.64,-1082 39739.64,-1082 39739.64,-1082 39739.64,-1080.29 39739.64,-1080.29"/>
<polygon fill="black" stroke="black" points="39743.14,-1080.29 39739.64,-1070.29 39736.14,-1080.29 39743.14,-1080.29"/>
</g>
<!-- L4_S0_TP1_GPU1_attn_v&#45;&gt;L4_S0_TP3_GPU3_mha_ar -->
<g id="edge1267" class="edge">
<title>L4_S0_TP1_GPU1_attn_v&#45;&gt;L4_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M39018.26,-1116.33C39018.26,-1099.17 39018.26,-1082 39018.26,-1082 39018.26,-1082 40555.26,-1082 40555.26,-1082 40555.26,-1082 40555.26,-1081.23 40555.26,-1081.23"/>
<polygon fill="black" stroke="black" points="40558.76,-1084.28 40555.26,-1074.28 40551.76,-1084.28 40558.76,-1084.28"/>
</g>
<!-- L4_S0_TP1_GPU1_attn_v&#45;&gt;L4_S0_TP4_GPU4_mha_ar -->
<g id="edge1303" class="edge">
<title>L4_S0_TP1_GPU1_attn_v&#45;&gt;L4_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M38820.5,-1116.24C38820.5,-1059.6 38820.5,-953 38820.5,-953 38820.5,-953 41165.18,-953 41165.18,-953 41165.18,-953 41165.18,-1004.12 41165.18,-1004.12"/>
<polygon fill="black" stroke="black" points="41161.68,-1004.12 41165.18,-1014.12 41168.68,-1004.12 41161.68,-1004.12"/>
</g>
<!-- L4_S0_TP1_GPU1_attn_v&#45;&gt;L4_S0_TP5_GPU5_mha_ar -->
<g id="edge1339" class="edge">
<title>L4_S0_TP1_GPU1_attn_v&#45;&gt;L4_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M39065.45,-1116.37C39065.45,-1105.86 39065.45,-1097 39065.45,-1097 39065.45,-1097 41939.42,-1097 41939.42,-1097 41939.42,-1097 41939.42,-1062.61 41939.42,-1062.61"/>
<polygon fill="black" stroke="black" points="41942.92,-1062.61 41939.42,-1052.61 41935.92,-1062.61 41942.92,-1062.61"/>
</g>
<!-- L4_S0_TP1_GPU1_attn_v&#45;&gt;L4_S0_TP6_GPU6_mha_ar -->
<g id="edge1375" class="edge">
<title>L4_S0_TP1_GPU1_attn_v&#45;&gt;L4_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M39112.63,-1116.37C39112.63,-1105.86 39112.63,-1097 39112.63,-1097 39112.63,-1097 42725.45,-1097 42725.45,-1097 42725.45,-1097 42725.45,-1066.94 42725.45,-1066.94"/>
<polygon fill="black" stroke="black" points="42728.95,-1066.94 42725.45,-1056.94 42721.95,-1066.94 42728.95,-1066.94"/>
</g>
<!-- L4_S0_TP1_GPU1_attn_v&#45;&gt;L4_S0_TP7_GPU7_mha_ar -->
<g id="edge1411" class="edge">
<title>L4_S0_TP1_GPU1_attn_v&#45;&gt;L4_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M39159.82,-1116.42C39159.82,-1106.36 39159.82,-1098 39159.82,-1098 39159.82,-1098 43579.39,-1098 43579.39,-1098 43579.39,-1098 43579.39,-1079.88 43579.39,-1079.88"/>
<polygon fill="black" stroke="black" points="43582.89,-1079.88 43579.39,-1069.88 43575.89,-1079.88 43582.89,-1079.88"/>
</g>
<!-- L4_S0_TP2_GPU2_attn_v -->
<g id="node425" class="node">
<title>L4_S0_TP2_GPU2_attn_v</title>
<polygon fill="none" stroke="black" points="40163,-1184.67 39225,-1184.67 39225,-1116.67 40163,-1116.67 40163,-1184.67"/>
<text text-anchor="middle" x="39694" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="39694" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="39694" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="39694" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L4_S0_TP2_GPU2_attn_v&#45;&gt;L4_S0_TP0_GPU0_mha_ar -->
<g id="edge1160" class="edge">
<title>L4_S0_TP2_GPU2_attn_v&#45;&gt;L4_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M39275.78,-1116.41C39275.78,-1114.9 39275.78,-1114 39275.78,-1114 39275.78,-1114 38404.62,-1114 38404.62,-1114 38404.62,-1114 38404.62,-1090.88 38404.62,-1090.88"/>
<polygon fill="black" stroke="black" points="38408.12,-1090.88 38404.62,-1080.88 38401.12,-1090.88 38408.12,-1090.88"/>
</g>
<!-- L4_S0_TP2_GPU2_attn_v&#45;&gt;L4_S0_TP1_GPU1_mha_ar -->
<g id="edge1196" class="edge">
<title>L4_S0_TP2_GPU2_attn_v&#45;&gt;L4_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M39326.56,-1116.51C39326.56,-1116.51 39326.56,-1088.09 39326.56,-1088.09"/>
<polygon fill="black" stroke="black" points="39330.06,-1088.09 39326.56,-1078.09 39323.06,-1088.09 39330.06,-1088.09"/>
</g>
<!-- L4_S0_TP2_GPU2_attn_v&#45;&gt;L4_S0_TP2_GPU2_mha_ar -->
<g id="edge1232" class="edge">
<title>L4_S0_TP2_GPU2_attn_v&#45;&gt;L4_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M39810.2,-1116.51C39810.2,-1116.51 39810.2,-1085.92 39810.2,-1085.92"/>
<polygon fill="black" stroke="black" points="39813.7,-1085.92 39810.2,-1075.92 39806.7,-1085.92 39813.7,-1085.92"/>
</g>
<!-- L4_S0_TP2_GPU2_attn_v&#45;&gt;L4_S0_TP3_GPU3_mha_ar -->
<g id="edge1268" class="edge">
<title>L4_S0_TP2_GPU2_attn_v&#45;&gt;L4_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M39880.76,-1116.33C39880.76,-1099.17 39880.76,-1082 39880.76,-1082 39880.76,-1082 40649.13,-1082 40649.13,-1082 40649.13,-1082 40649.13,-1081.73 40649.13,-1081.73"/>
<polygon fill="black" stroke="black" points="40652.63,-1089.34 40649.13,-1079.34 40645.63,-1089.34 40652.63,-1089.34"/>
</g>
<!-- L4_S0_TP2_GPU2_attn_v&#45;&gt;L4_S0_TP4_GPU4_mha_ar -->
<g id="edge1304" class="edge">
<title>L4_S0_TP2_GPU2_attn_v&#45;&gt;L4_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M39951.32,-1116.42C39951.32,-1106.36 39951.32,-1098 39951.32,-1098 39951.32,-1098 41418.43,-1098 41418.43,-1098 41418.43,-1098 41418.43,-1089.43 41418.43,-1089.43"/>
<polygon fill="black" stroke="black" points="41421.93,-1089.43 41418.43,-1079.43 41414.93,-1089.43 41421.93,-1089.43"/>
</g>
<!-- L4_S0_TP2_GPU2_attn_v&#45;&gt;L4_S0_TP5_GPU5_mha_ar -->
<g id="edge1340" class="edge">
<title>L4_S0_TP2_GPU2_attn_v&#45;&gt;L4_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M40095.5,-1184.7C40095.5,-1194.69 40095.5,-1203 40095.5,-1203 40095.5,-1203 42086,-1203 42086,-1203 42086,-1203 42086,-1083.84 42086,-1083.84"/>
<polygon fill="black" stroke="black" points="42089.5,-1083.84 42086,-1073.84 42082.5,-1083.84 42089.5,-1083.84"/>
</g>
<!-- L4_S0_TP2_GPU2_attn_v&#45;&gt;L4_S0_TP6_GPU6_mha_ar -->
<g id="edge1376" class="edge">
<title>L4_S0_TP2_GPU2_attn_v&#45;&gt;L4_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M40021.88,-1116.42C40021.88,-1106.36 40021.88,-1098 40021.88,-1098 40021.88,-1098 42776.38,-1098 42776.38,-1098 42776.38,-1098 42776.38,-1075.67 42776.38,-1075.67"/>
<polygon fill="black" stroke="black" points="42779.88,-1075.67 42776.38,-1065.67 42772.88,-1075.67 42779.88,-1075.67"/>
</g>
<!-- L4_S0_TP2_GPU2_attn_v&#45;&gt;L4_S0_TP7_GPU7_mha_ar -->
<g id="edge1412" class="edge">
<title>L4_S0_TP2_GPU2_attn_v&#45;&gt;L4_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M40092.44,-1116.42C40092.44,-1106.36 40092.44,-1098 40092.44,-1098 40092.44,-1098 43647.33,-1098 43647.33,-1098 43647.33,-1098 43647.33,-1085.49 43647.33,-1085.49"/>
<polygon fill="black" stroke="black" points="43650.83,-1085.49 43647.33,-1075.49 43643.83,-1085.49 43650.83,-1085.49"/>
</g>
<!-- L4_S0_TP3_GPU3_attn_v -->
<g id="node426" class="node">
<title>L4_S0_TP3_GPU3_attn_v</title>
<polygon fill="none" stroke="black" points="41119,-1184.67 40181,-1184.67 40181,-1116.67 41119,-1116.67 41119,-1184.67"/>
<text text-anchor="middle" x="40650" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="40650" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="40650" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="40650" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L4_S0_TP3_GPU3_attn_v&#45;&gt;L4_S0_TP0_GPU0_mha_ar -->
<g id="edge1161" class="edge">
<title>L4_S0_TP3_GPU3_attn_v&#45;&gt;L4_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M40209.08,-1116.41C40209.08,-1114.9 40209.08,-1114 40209.08,-1114 40209.08,-1114 38472.43,-1114 38472.43,-1114 38472.43,-1114 38472.43,-1090.88 38472.43,-1090.88"/>
<polygon fill="black" stroke="black" points="38475.93,-1090.88 38472.43,-1080.88 38468.93,-1090.88 38475.93,-1090.88"/>
</g>
<!-- L4_S0_TP3_GPU3_attn_v&#45;&gt;L4_S0_TP1_GPU1_mha_ar -->
<g id="edge1197" class="edge">
<title>L4_S0_TP3_GPU3_attn_v&#45;&gt;L4_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M40237.16,-1116.41C40237.16,-1114.9 40237.16,-1114 40237.16,-1114 40237.16,-1114 39377.35,-1114 39377.35,-1114 39377.35,-1114 39377.35,-1085.68 39377.35,-1085.68"/>
<polygon fill="black" stroke="black" points="39380.85,-1085.68 39377.35,-1075.68 39373.85,-1085.68 39380.85,-1085.68"/>
</g>
<!-- L4_S0_TP3_GPU3_attn_v&#45;&gt;L4_S0_TP2_GPU2_mha_ar -->
<g id="edge1233" class="edge">
<title>L4_S0_TP3_GPU3_attn_v&#45;&gt;L4_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M40265.24,-1116.51C40265.24,-1116.51 40265.24,-1073.04 40265.24,-1073.04"/>
<polygon fill="black" stroke="black" points="40268.74,-1073.04 40265.24,-1063.04 40261.74,-1073.04 40268.74,-1073.04"/>
</g>
<!-- L4_S0_TP3_GPU3_attn_v&#45;&gt;L4_S0_TP3_GPU3_mha_ar -->
<g id="edge1269" class="edge">
<title>L4_S0_TP3_GPU3_attn_v&#45;&gt;L4_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M40743,-1116.51C40743,-1116.51 40743,-1090.71 40743,-1090.71"/>
<polygon fill="black" stroke="black" points="40746.5,-1090.71 40743,-1080.71 40739.5,-1090.71 40746.5,-1090.71"/>
</g>
<!-- L4_S0_TP3_GPU3_attn_v&#45;&gt;L4_S0_TP4_GPU4_mha_ar -->
<g id="edge1305" class="edge">
<title>L4_S0_TP3_GPU3_attn_v&#45;&gt;L4_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M41119.23,-1161C41122.29,-1161 41123.92,-1161 41123.92,-1161 41123.92,-1161 41123.92,-1016 41123.92,-1016 41123.92,-1016 41149.39,-1016 41149.39,-1016"/>
<polygon fill="black" stroke="black" points="41149.39,-1019.5 41159.39,-1016 41149.39,-1012.5 41149.39,-1019.5"/>
</g>
<!-- L4_S0_TP3_GPU3_attn_v&#45;&gt;L4_S0_TP5_GPU5_mha_ar -->
<g id="edge1341" class="edge">
<title>L4_S0_TP3_GPU3_attn_v&#45;&gt;L4_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M41017,-1185.13C41017,-1185.69 41017,-1186 41017,-1186 41017,-1186 42082.5,-1186 42082.5,-1186 42082.5,-1186 42082.5,-1083.7 42082.5,-1083.7"/>
<polygon fill="black" stroke="black" points="42086,-1083.7 42082.5,-1073.7 42079,-1083.7 42086,-1083.7"/>
</g>
<!-- L4_S0_TP3_GPU3_attn_v&#45;&gt;L4_S0_TP6_GPU6_mha_ar -->
<g id="edge1377" class="edge">
<title>L4_S0_TP3_GPU3_attn_v&#45;&gt;L4_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M40836.87,-1116.49C40836.87,-1106.88 40836.87,-1099 40836.87,-1099 40836.87,-1099 42827.3,-1099 42827.3,-1099 42827.3,-1099 42827.3,-1081.6 42827.3,-1081.6"/>
<polygon fill="black" stroke="black" points="42830.8,-1081.6 42827.3,-1071.6 42823.8,-1081.6 42830.8,-1081.6"/>
</g>
<!-- L4_S0_TP3_GPU3_attn_v&#45;&gt;L4_S0_TP7_GPU7_mha_ar -->
<g id="edge1413" class="edge">
<title>L4_S0_TP3_GPU3_attn_v&#45;&gt;L4_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M40930.74,-1116.42C40930.74,-1106.36 40930.74,-1098 40930.74,-1098 40930.74,-1098 43715.26,-1098 43715.26,-1098 43715.26,-1098 43715.26,-1089.08 43715.26,-1089.08"/>
<polygon fill="black" stroke="black" points="43718.76,-1089.08 43715.26,-1079.08 43711.76,-1089.08 43718.76,-1089.08"/>
</g>
<!-- L4_S0_TP4_GPU4_attn_v -->
<g id="node427" class="node">
<title>L4_S0_TP4_GPU4_attn_v</title>
<polygon fill="none" stroke="black" points="42075,-1184.67 41137,-1184.67 41137,-1116.67 42075,-1116.67 42075,-1184.67"/>
<text text-anchor="middle" x="41606" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="41606" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="41606" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="41606" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L4_S0_TP4_GPU4_attn_v&#45;&gt;L4_S0_TP0_GPU0_mha_ar -->
<g id="edge1162" class="edge">
<title>L4_S0_TP4_GPU4_attn_v&#45;&gt;L4_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M41230.81,-1116.42C41230.81,-1106.36 41230.81,-1098 41230.81,-1098 41230.81,-1098 38540.24,-1098 38540.24,-1098 38540.24,-1098 38540.24,-1089.08 38540.24,-1089.08"/>
<polygon fill="black" stroke="black" points="38543.74,-1089.08 38540.24,-1079.08 38536.74,-1089.08 38543.74,-1089.08"/>
</g>
<!-- L4_S0_TP4_GPU4_attn_v&#45;&gt;L4_S0_TP1_GPU1_mha_ar -->
<g id="edge1198" class="edge">
<title>L4_S0_TP4_GPU4_attn_v&#45;&gt;L4_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M41324.62,-1116.42C41324.62,-1106.36 41324.62,-1098 41324.62,-1098 41324.62,-1098 39428.13,-1098 39428.13,-1098 39428.13,-1098 39428.13,-1081.39 39428.13,-1081.39"/>
<polygon fill="black" stroke="black" points="39431.63,-1081.39 39428.13,-1071.39 39424.63,-1081.39 39431.63,-1081.39"/>
</g>
<!-- L4_S0_TP4_GPU4_attn_v&#45;&gt;L4_S0_TP2_GPU2_mha_ar -->
<g id="edge1234" class="edge">
<title>L4_S0_TP4_GPU4_attn_v&#45;&gt;L4_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M41237.25,-1184.86C41237.25,-1187.98 41237.25,-1190 41237.25,-1190 41237.25,-1190 40175,-1190 40175,-1190 40175,-1190 40175,-1083.53 40175,-1083.53"/>
<polygon fill="black" stroke="black" points="40178.5,-1083.53 40175,-1073.53 40171.5,-1083.53 40178.5,-1083.53"/>
</g>
<!-- L4_S0_TP4_GPU4_attn_v&#45;&gt;L4_S0_TP3_GPU3_mha_ar -->
<g id="edge1270" class="edge">
<title>L4_S0_TP4_GPU4_attn_v&#45;&gt;L4_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M41136.76,-1139C41126.95,-1139 41121.46,-1139 41121.46,-1139 41121.46,-1139 41121.46,-1048 41121.46,-1048 41121.46,-1048 41108.92,-1048 41108.92,-1048"/>
<polygon fill="black" stroke="black" points="41108.92,-1044.5 41098.92,-1048 41108.92,-1051.5 41108.92,-1044.5"/>
</g>
<!-- L4_S0_TP4_GPU4_attn_v&#45;&gt;L4_S0_TP4_GPU4_mha_ar -->
<g id="edge1306" class="edge">
<title>L4_S0_TP4_GPU4_attn_v&#45;&gt;L4_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M41512.24,-1116.51C41512.24,-1116.51 41512.24,-1090.71 41512.24,-1090.71"/>
<polygon fill="black" stroke="black" points="41515.74,-1090.71 41512.24,-1080.71 41508.74,-1090.71 41515.74,-1090.71"/>
</g>
<!-- L4_S0_TP4_GPU4_attn_v&#45;&gt;L4_S0_TP5_GPU5_mha_ar -->
<g id="edge1342" class="edge">
<title>L4_S0_TP4_GPU4_attn_v&#45;&gt;L4_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M41973.32,-1116.51C41973.32,-1116.51 41973.32,-1070.31 41973.32,-1070.31"/>
<polygon fill="black" stroke="black" points="41976.82,-1070.31 41973.32,-1060.31 41969.82,-1070.31 41976.82,-1070.31"/>
</g>
<!-- L4_S0_TP4_GPU4_attn_v&#45;&gt;L4_S0_TP6_GPU6_mha_ar -->
<g id="edge1378" class="edge">
<title>L4_S0_TP4_GPU4_attn_v&#45;&gt;L4_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M42007.21,-1116.49C42007.21,-1106.88 42007.21,-1099 42007.21,-1099 42007.21,-1099 42878.23,-1099 42878.23,-1099 42878.23,-1099 42878.23,-1085.4 42878.23,-1085.4"/>
<polygon fill="black" stroke="black" points="42881.73,-1085.4 42878.23,-1075.4 42874.73,-1085.4 42881.73,-1085.4"/>
</g>
<!-- L4_S0_TP4_GPU4_attn_v&#45;&gt;L4_S0_TP7_GPU7_mha_ar -->
<g id="edge1414" class="edge">
<title>L4_S0_TP4_GPU4_attn_v&#45;&gt;L4_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M42041.11,-1116.49C42041.11,-1106.88 42041.11,-1099 42041.11,-1099 42041.11,-1099 43783.2,-1099 43783.2,-1099 43783.2,-1099 43783.2,-1090.5 43783.2,-1090.5"/>
<polygon fill="black" stroke="black" points="43786.7,-1090.5 43783.2,-1080.5 43779.7,-1090.5 43786.7,-1090.5"/>
</g>
<!-- L4_S0_TP5_GPU5_attn_v -->
<g id="node428" class="node">
<title>L4_S0_TP5_GPU5_attn_v</title>
<polygon fill="none" stroke="black" points="43031,-1184.67 42093,-1184.67 42093,-1116.67 43031,-1116.67 43031,-1184.67"/>
<text text-anchor="middle" x="42562" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="42562" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="42562" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="42562" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L4_S0_TP5_GPU5_attn_v&#45;&gt;L4_S0_TP0_GPU0_mha_ar -->
<g id="edge1163" class="edge">
<title>L4_S0_TP5_GPU5_attn_v&#45;&gt;L4_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M42155.61,-1116.42C42155.61,-1106.36 42155.61,-1098 42155.61,-1098 42155.61,-1098 38608.05,-1098 38608.05,-1098 38608.05,-1098 38608.05,-1085.49 38608.05,-1085.49"/>
<polygon fill="black" stroke="black" points="38611.55,-1085.49 38608.05,-1075.49 38604.55,-1085.49 38611.55,-1085.49"/>
</g>
<!-- L4_S0_TP5_GPU5_attn_v&#45;&gt;L4_S0_TP1_GPU1_mha_ar -->
<g id="edge1199" class="edge">
<title>L4_S0_TP5_GPU5_attn_v&#45;&gt;L4_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M42218.22,-1116.42C42218.22,-1106.36 42218.22,-1098 42218.22,-1098 42218.22,-1098 39478.91,-1098 39478.91,-1098 39478.91,-1098 39478.91,-1075.67 39478.91,-1075.67"/>
<polygon fill="black" stroke="black" points="39482.41,-1075.67 39478.91,-1065.67 39475.41,-1075.67 39482.41,-1075.67"/>
</g>
<!-- L4_S0_TP5_GPU5_attn_v&#45;&gt;L4_S0_TP2_GPU2_mha_ar -->
<g id="edge1235" class="edge">
<title>L4_S0_TP5_GPU5_attn_v&#45;&gt;L4_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M42280.82,-1116.42C42280.82,-1106.36 42280.82,-1098 42280.82,-1098 42280.82,-1098 40293.32,-1098 40293.32,-1098 40293.32,-1098 40293.32,-1068.06 40293.32,-1068.06"/>
<polygon fill="black" stroke="black" points="40296.82,-1068.06 40293.32,-1058.06 40289.82,-1068.06 40296.82,-1068.06"/>
</g>
<!-- L4_S0_TP5_GPU5_attn_v&#45;&gt;L4_S0_TP3_GPU3_mha_ar -->
<g id="edge1271" class="edge">
<title>L4_S0_TP5_GPU5_attn_v&#45;&gt;L4_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M42343.43,-1116.42C42343.43,-1106.36 42343.43,-1098 42343.43,-1098 42343.43,-1098 41024.61,-1098 41024.61,-1098 41024.61,-1098 41024.61,-1074.52 41024.61,-1074.52"/>
<polygon fill="black" stroke="black" points="41028.11,-1074.52 41024.61,-1064.52 41021.11,-1074.52 41028.11,-1074.52"/>
</g>
<!-- L4_S0_TP5_GPU5_attn_v&#45;&gt;L4_S0_TP4_GPU4_mha_ar -->
<g id="edge1307" class="edge">
<title>L4_S0_TP5_GPU5_attn_v&#45;&gt;L4_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M42406.04,-1116.4C42406.04,-1101.77 42406.04,-1088 42406.04,-1088 42406.04,-1088 41606.05,-1088 41606.05,-1088 41606.05,-1088 41606.05,-1087.13 41606.05,-1087.13"/>
<polygon fill="black" stroke="black" points="41609.55,-1089.34 41606.05,-1079.34 41602.55,-1089.34 41609.55,-1089.34"/>
</g>
<!-- L4_S0_TP5_GPU5_attn_v&#45;&gt;L4_S0_TP5_GPU5_mha_ar -->
<g id="edge1343" class="edge">
<title>L4_S0_TP5_GPU5_attn_v&#45;&gt;L4_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M42468.65,-1116.51C42468.65,-1116.51 42468.65,-1084.63 42468.65,-1084.63"/>
<polygon fill="black" stroke="black" points="42472.15,-1084.63 42468.65,-1074.63 42465.15,-1084.63 42472.15,-1084.63"/>
</g>
<!-- L4_S0_TP5_GPU5_attn_v&#45;&gt;L4_S0_TP6_GPU6_mha_ar -->
<g id="edge1379" class="edge">
<title>L4_S0_TP5_GPU5_attn_v&#45;&gt;L4_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M42929.15,-1116.51C42929.15,-1116.51 42929.15,-1088.52 42929.15,-1088.52"/>
<polygon fill="black" stroke="black" points="42932.65,-1088.52 42929.15,-1078.52 42925.65,-1088.52 42932.65,-1088.52"/>
</g>
<!-- L4_S0_TP5_GPU5_attn_v&#45;&gt;L4_S0_TP7_GPU7_mha_ar -->
<g id="edge1415" class="edge">
<title>L4_S0_TP5_GPU5_attn_v&#45;&gt;L4_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M42980.08,-1116.49C42980.08,-1106.88 42980.08,-1099 42980.08,-1099 42980.08,-1099 43851.13,-1099 43851.13,-1099 43851.13,-1099 43851.13,-1090.5 43851.13,-1090.5"/>
<polygon fill="black" stroke="black" points="43854.63,-1090.5 43851.13,-1080.5 43847.63,-1090.5 43854.63,-1090.5"/>
</g>
<!-- L4_S0_TP6_GPU6_attn_v -->
<g id="node429" class="node">
<title>L4_S0_TP6_GPU6_attn_v</title>
<polygon fill="none" stroke="black" points="43987,-1184.67 43049,-1184.67 43049,-1116.67 43987,-1116.67 43987,-1184.67"/>
<text text-anchor="middle" x="43518" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="43518" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="43518" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="43518" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L4_S0_TP6_GPU6_attn_v&#45;&gt;L4_S0_TP0_GPU0_mha_ar -->
<g id="edge1164" class="edge">
<title>L4_S0_TP6_GPU6_attn_v&#45;&gt;L4_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M43096.06,-1116.42C43096.06,-1106.36 43096.06,-1098 43096.06,-1098 43096.06,-1098 38675.86,-1098 38675.86,-1098 38675.86,-1098 38675.86,-1079.88 38675.86,-1079.88"/>
<polygon fill="black" stroke="black" points="38679.36,-1079.88 38675.86,-1069.88 38672.36,-1079.88 38679.36,-1079.88"/>
</g>
<!-- L4_S0_TP6_GPU6_attn_v&#45;&gt;L4_S0_TP1_GPU1_mha_ar -->
<g id="edge1200" class="edge">
<title>L4_S0_TP6_GPU6_attn_v&#45;&gt;L4_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M43143.12,-1116.42C43143.12,-1106.36 43143.12,-1098 43143.12,-1098 43143.12,-1098 39529.69,-1098 39529.69,-1098 39529.69,-1098 39529.69,-1066.94 39529.69,-1066.94"/>
<polygon fill="black" stroke="black" points="39533.19,-1066.94 39529.69,-1056.94 39526.19,-1066.94 39533.19,-1066.94"/>
</g>
<!-- L4_S0_TP6_GPU6_attn_v&#45;&gt;L4_S0_TP2_GPU2_mha_ar -->
<g id="edge1236" class="edge">
<title>L4_S0_TP6_GPU6_attn_v&#45;&gt;L4_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M43190.18,-1116.42C43190.18,-1106.36 43190.18,-1098 43190.18,-1098 43190.18,-1098 40321.39,-1098 40321.39,-1098 40321.39,-1098 40321.39,-1061.15 40321.39,-1061.15"/>
<polygon fill="black" stroke="black" points="40324.89,-1061.15 40321.39,-1051.15 40317.89,-1061.15 40324.89,-1061.15"/>
</g>
<!-- L4_S0_TP6_GPU6_attn_v&#45;&gt;L4_S0_TP3_GPU3_mha_ar -->
<g id="edge1272" class="edge">
<title>L4_S0_TP6_GPU6_attn_v&#45;&gt;L4_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M43434.5,-1116.26C43434.5,-1063.84 43434.5,-970 43434.5,-970 43434.5,-970 41089.02,-970 41089.02,-970 41089.02,-970 41089.02,-1003.81 41089.02,-1003.81"/>
<polygon fill="black" stroke="black" points="41085.52,-1003.81 41089.02,-1013.81 41092.52,-1003.81 41085.52,-1003.81"/>
</g>
<!-- L4_S0_TP6_GPU6_attn_v&#45;&gt;L4_S0_TP4_GPU4_mha_ar -->
<g id="edge1308" class="edge">
<title>L4_S0_TP6_GPU6_attn_v&#45;&gt;L4_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M43237.24,-1116.4C43237.24,-1101.77 43237.24,-1088 43237.24,-1088 43237.24,-1088 41699.86,-1088 41699.86,-1088 41699.86,-1088 41699.86,-1084.3 41699.86,-1084.3"/>
<polygon fill="black" stroke="black" points="41703.36,-1084.3 41699.86,-1074.3 41696.36,-1084.3 41703.36,-1084.3"/>
</g>
<!-- L4_S0_TP6_GPU6_attn_v&#45;&gt;L4_S0_TP5_GPU5_mha_ar -->
<g id="edge1344" class="edge">
<title>L4_S0_TP6_GPU6_attn_v&#45;&gt;L4_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M43284.3,-1116.4C43284.3,-1101.77 43284.3,-1088 43284.3,-1088 43284.3,-1088 42531.26,-1088 42531.26,-1088 42531.26,-1088 42531.26,-1078.62 42531.26,-1078.62"/>
<polygon fill="black" stroke="black" points="42534.76,-1078.62 42531.26,-1068.62 42527.76,-1078.62 42534.76,-1078.62"/>
</g>
<!-- L4_S0_TP6_GPU6_attn_v&#45;&gt;L4_S0_TP6_GPU6_mha_ar -->
<g id="edge1380" class="edge">
<title>L4_S0_TP6_GPU6_attn_v&#45;&gt;L4_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M43331.36,-1116.51C43331.36,-1116.51 43331.36,-1074.64 43331.36,-1074.64"/>
<polygon fill="black" stroke="black" points="43334.86,-1074.64 43331.36,-1064.64 43327.86,-1074.64 43334.86,-1074.64"/>
</g>
<!-- L4_S0_TP6_GPU6_attn_v&#45;&gt;L4_S0_TP7_GPU7_mha_ar -->
<g id="edge1416" class="edge">
<title>L4_S0_TP6_GPU6_attn_v&#45;&gt;L4_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M43919.07,-1116.51C43919.07,-1116.51 43919.07,-1088.96 43919.07,-1088.96"/>
<polygon fill="black" stroke="black" points="43922.57,-1088.96 43919.07,-1078.96 43915.57,-1088.96 43922.57,-1088.96"/>
</g>
<!-- L4_S0_TP7_GPU7_attn_v -->
<g id="node430" class="node">
<title>L4_S0_TP7_GPU7_attn_v</title>
<polygon fill="none" stroke="black" points="44943,-1184.67 44005,-1184.67 44005,-1116.67 44943,-1116.67 44943,-1184.67"/>
<text text-anchor="middle" x="44474" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="44474" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="44474" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="44474" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L4_S0_TP7_GPU7_attn_v&#45;&gt;L4_S0_TP0_GPU0_mha_ar -->
<g id="edge1165" class="edge">
<title>L4_S0_TP7_GPU7_attn_v&#45;&gt;L4_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M44036.58,-1116.42C44036.58,-1106.36 44036.58,-1098 44036.58,-1098 44036.58,-1098 38743.66,-1098 38743.66,-1098 38743.66,-1098 38743.66,-1070.33 38743.66,-1070.33"/>
<polygon fill="black" stroke="black" points="38747.16,-1070.33 38743.66,-1060.33 38740.16,-1070.33 38747.16,-1070.33"/>
</g>
<!-- L4_S0_TP7_GPU7_attn_v&#45;&gt;L4_S0_TP1_GPU1_mha_ar -->
<g id="edge1201" class="edge">
<title>L4_S0_TP7_GPU7_attn_v&#45;&gt;L4_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M44071,-1184.73C44071,-1201.43 44071,-1218 44071,-1218 44071,-1218 39216,-1218 39216,-1218 39216,-1218 39216,-1090.81 39216,-1090.81"/>
<polygon fill="black" stroke="black" points="39219.5,-1090.81 39216,-1080.81 39212.5,-1090.82 39219.5,-1090.81"/>
</g>
<!-- L4_S0_TP7_GPU7_attn_v&#45;&gt;L4_S0_TP2_GPU2_mha_ar -->
<g id="edge1237" class="edge">
<title>L4_S0_TP7_GPU7_attn_v&#45;&gt;L4_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M44038,-1184.75C44038,-1199.3 44038,-1213 44038,-1213 44038,-1213 40169,-1213 40169,-1213 40169,-1213 40169,-1083.97 40169,-1083.97"/>
<polygon fill="black" stroke="black" points="40172.5,-1083.97 40169,-1073.97 40165.5,-1083.97 40172.5,-1083.97"/>
</g>
<!-- L4_S0_TP7_GPU7_attn_v&#45;&gt;L4_S0_TP3_GPU3_mha_ar -->
<g id="edge1273" class="edge">
<title>L4_S0_TP7_GPU7_attn_v&#45;&gt;L4_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M44229.99,-1116.26C44229.99,-1063.84 44229.99,-970 44229.99,-970 44229.99,-970 41060.26,-970 41060.26,-970 41060.26,-970 41060.26,-996.77 41060.26,-996.77"/>
<polygon fill="black" stroke="black" points="41056.76,-996.77 41060.26,-1006.77 41063.76,-996.77 41056.76,-996.77"/>
</g>
<!-- L4_S0_TP7_GPU7_attn_v&#45;&gt;L4_S0_TP4_GPU4_mha_ar -->
<g id="edge1309" class="edge">
<title>L4_S0_TP7_GPU7_attn_v&#45;&gt;L4_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M44068.16,-1116.4C44068.16,-1101.77 44068.16,-1088 44068.16,-1088 44068.16,-1088 41793.66,-1088 41793.66,-1088 41793.66,-1088 41793.66,-1074.5 41793.66,-1074.5"/>
<polygon fill="black" stroke="black" points="41797.16,-1074.5 41793.66,-1064.5 41790.16,-1074.5 41797.16,-1074.5"/>
</g>
<!-- L4_S0_TP7_GPU7_attn_v&#45;&gt;L4_S0_TP5_GPU5_mha_ar -->
<g id="edge1345" class="edge">
<title>L4_S0_TP7_GPU7_attn_v&#45;&gt;L4_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M44099.74,-1116.4C44099.74,-1101.77 44099.74,-1088 44099.74,-1088 44099.74,-1088 42593.87,-1088 42593.87,-1088 42593.87,-1088 42593.87,-1069.32 42593.87,-1069.32"/>
<polygon fill="black" stroke="black" points="42597.37,-1069.32 42593.87,-1059.32 42590.37,-1069.32 42597.37,-1069.32"/>
</g>
<!-- L4_S0_TP7_GPU7_attn_v&#45;&gt;L4_S0_TP6_GPU6_mha_ar -->
<g id="edge1381" class="edge">
<title>L4_S0_TP7_GPU7_attn_v&#45;&gt;L4_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M44131.32,-1116.4C44131.32,-1101.77 44131.32,-1088 44131.32,-1088 44131.32,-1088 43378.41,-1088 43378.41,-1088 43378.41,-1088 43378.41,-1066.08 43378.41,-1066.08"/>
<polygon fill="black" stroke="black" points="43381.91,-1066.08 43378.41,-1056.08 43374.91,-1066.08 43381.91,-1066.08"/>
</g>
<!-- L4_S0_TP7_GPU7_attn_v&#45;&gt;L4_S0_TP7_GPU7_mha_ar -->
<g id="edge1417" class="edge">
<title>L4_S0_TP7_GPU7_attn_v&#45;&gt;L4_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M44162.89,-1116.51C44162.89,-1116.51 44162.89,-1061.95 44162.89,-1061.95"/>
<polygon fill="black" stroke="black" points="44166.39,-1061.95 44162.89,-1051.95 44159.39,-1061.95 44166.39,-1061.95"/>
</g>
<!-- L4_S0_TP0_GPU0_gate -->
<g id="node432" class="node">
<title>L4_S0_TP0_GPU0_gate</title>
<polygon fill="none" stroke="black" points="37883.56,-844.5 37041.15,-844.5 36824.44,-708.5 37666.85,-708.5 37883.56,-844.5"/>
<text text-anchor="middle" x="37354" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="37354" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="37354" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="37354" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L4_S0_TP0_GPU0_mha_res&#45;&gt;L4_S0_TP0_GPU0_gate -->
<g id="edge1167" class="edge">
<title>L4_S0_TP0_GPU0_mha_res&#45;&gt;L4_S0_TP0_GPU0_gate</title>
<path fill="none" stroke="black" d="M37354,-880.39C37354,-880.39 37354,-854.73 37354,-854.73"/>
<polygon fill="black" stroke="black" points="37357.5,-854.73 37354,-844.73 37350.5,-854.73 37357.5,-854.73"/>
</g>
<!-- L4_S0_TP0_GPU0_moe_res -->
<g id="node450" class="node">
<title>L4_S0_TP0_GPU0_moe_res</title>
<polygon fill="none" stroke="black" points="37650,-436.33 36830,-436.33 36830,-368.33 37650,-368.33 37650,-436.33"/>
<text text-anchor="middle" x="37240" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="37240" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="37240" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="37240" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP0_GPU0_mha_res&#45;&gt;L4_S0_TP0_GPU0_moe_res -->
<g id="edge1187" class="edge">
<title>L4_S0_TP0_GPU0_mha_res&#45;&gt;L4_S0_TP0_GPU0_moe_res</title>
<path fill="none" stroke="black" d="M36910.5,-903C36773.37,-903 36657.61,-903 36657.61,-903 36657.61,-903 36657.61,-402 36657.61,-402 36657.61,-402 36819.98,-402 36819.98,-402"/>
<polygon fill="black" stroke="black" points="36819.98,-405.5 36829.98,-402 36819.98,-398.5 36819.98,-405.5"/>
</g>
<!-- L4_S0_TP0_GPU0_expert0 -->
<g id="node433" class="node">
<title>L4_S0_TP0_GPU0_expert0</title>
<polygon fill="none" stroke="black" points="37849.5,-672.5 37400.5,-672.5 37400.5,-604.5 37849.5,-604.5 37849.5,-672.5"/>
<text text-anchor="middle" x="37625" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="37625" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="37625" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="37625" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L4_S0_TP0_GPU0_gate&#45;&gt;L4_S0_TP0_GPU0_expert0 -->
<g id="edge1168" class="edge">
<title>L4_S0_TP0_GPU0_gate&#45;&gt;L4_S0_TP0_GPU0_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37625,-708.31C37625,-708.31 37625,-682.71 37625,-682.71"/>
<polygon fill="black" stroke="black" points="37628.5,-682.71 37625,-672.71 37621.5,-682.71 37628.5,-682.71"/>
</g>
<!-- L4_S0_TP0_GPU0_expert1 -->
<g id="node434" class="node">
<title>L4_S0_TP0_GPU0_expert1</title>
<polygon fill="none" stroke="black" points="38316.5,-672.5 37867.5,-672.5 37867.5,-604.5 38316.5,-604.5 38316.5,-672.5"/>
<text text-anchor="middle" x="38092" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="38092" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="38092" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="38092" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L4_S0_TP0_GPU0_gate&#45;&gt;L4_S0_TP0_GPU0_expert1 -->
<g id="edge1169" class="edge">
<title>L4_S0_TP0_GPU0_gate&#45;&gt;L4_S0_TP0_GPU0_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37875.64,-776.4C37875.64,-776.4 37875.64,-682.74 37875.64,-682.74"/>
<polygon fill="black" stroke="black" points="37879.14,-682.74 37875.64,-672.74 37872.14,-682.74 37879.14,-682.74"/>
</g>
<!-- L4_S0_TP0_GPU0_moe_ar -->
<g id="node435" class="node">
<title>L4_S0_TP0_GPU0_moe_ar</title>
<ellipse fill="none" stroke="black" cx="38723" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="38723" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="38723" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="38723" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="38723" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP0_GPU0_expert0&#45;&gt;L4_S0_TP0_GPU0_moe_ar -->
<g id="edge1170" class="edge">
<title>L4_S0_TP0_GPU0_expert0&#45;&gt;L4_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M37827.33,-604.37C37827.33,-563.08 37827.33,-499 37827.33,-499 37827.33,-499 38413.51,-499 38413.51,-499"/>
<polygon fill="black" stroke="black" points="38413.51,-502.5 38423.51,-499 38413.51,-495.5 38413.51,-502.5"/>
</g>
<!-- L4_S0_TP1_GPU1_moe_ar -->
<g id="node459" class="node">
<title>L4_S0_TP1_GPU1_moe_ar</title>
<ellipse fill="none" stroke="black" cx="39410" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="39410" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="39410" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="39410" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="39410" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP0_GPU0_expert0&#45;&gt;L4_S0_TP1_GPU1_moe_ar -->
<g id="edge1206" class="edge">
<title>L4_S0_TP0_GPU0_expert0&#45;&gt;L4_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M37805.17,-604.29C37805.17,-596.26 37805.17,-590 37805.17,-590 37805.17,-590 39091.44,-590 39091.44,-590 39091.44,-590 39091.44,-545.17 39091.44,-545.17"/>
<polygon fill="black" stroke="black" points="39094.94,-545.17 39091.44,-535.17 39087.94,-545.17 39094.94,-545.17"/>
</g>
<!-- L4_S0_TP2_GPU2_moe_ar -->
<g id="node469" class="node">
<title>L4_S0_TP2_GPU2_moe_ar</title>
<ellipse fill="none" stroke="black" cx="40097" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="40097" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="40097" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="40097" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="40097" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP0_GPU0_expert0&#45;&gt;L4_S0_TP2_GPU2_moe_ar -->
<g id="edge1242" class="edge">
<title>L4_S0_TP0_GPU0_expert0&#45;&gt;L4_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M37783,-604.12C37783,-551.75 37783,-458 37783,-458 37783,-458 39880.03,-458 39880.03,-458 39880.03,-458 39880.03,-473.75 39880.03,-473.75"/>
<polygon fill="black" stroke="black" points="39876.53,-473.75 39880.03,-483.75 39883.53,-473.75 39876.53,-473.75"/>
</g>
<!-- L4_S0_TP3_GPU3_moe_ar -->
<g id="node479" class="node">
<title>L4_S0_TP3_GPU3_moe_ar</title>
<ellipse fill="none" stroke="black" cx="40784" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="40784" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="40784" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="40784" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="40784" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP0_GPU0_expert0&#45;&gt;L4_S0_TP3_GPU3_moe_ar -->
<g id="edge1278" class="edge">
<title>L4_S0_TP0_GPU0_expert0&#45;&gt;L4_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M37760.83,-604.12C37760.83,-551.75 37760.83,-458 37760.83,-458 37760.83,-458 40644.03,-458 40644.03,-458 40644.03,-458 40644.03,-466.73 40644.03,-466.73"/>
<polygon fill="black" stroke="black" points="40640.53,-466.73 40644.03,-476.73 40647.53,-466.73 40640.53,-466.73"/>
</g>
<!-- L4_S0_TP4_GPU4_moe_ar -->
<g id="node489" class="node">
<title>L4_S0_TP4_GPU4_moe_ar</title>
<ellipse fill="none" stroke="black" cx="41471" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="41471" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="41471" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="41471" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="41471" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP0_GPU0_expert0&#45;&gt;L4_S0_TP4_GPU4_moe_ar -->
<g id="edge1314" class="edge">
<title>L4_S0_TP0_GPU0_expert0&#45;&gt;L4_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M37738.67,-604.12C37738.67,-551.75 37738.67,-458 37738.67,-458 37738.67,-458 41535.82,-458 41535.82,-458 41535.82,-458 41535.82,-463.11 41535.82,-463.11"/>
<polygon fill="black" stroke="black" points="41532.32,-463.11 41535.82,-473.11 41539.32,-463.11 41532.32,-463.11"/>
</g>
<!-- L4_S0_TP5_GPU5_moe_ar -->
<g id="node499" class="node">
<title>L4_S0_TP5_GPU5_moe_ar</title>
<ellipse fill="none" stroke="black" cx="42158" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="42158" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="42158" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="42158" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="42158" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP0_GPU0_expert0&#45;&gt;L4_S0_TP5_GPU5_moe_ar -->
<g id="edge1350" class="edge">
<title>L4_S0_TP0_GPU0_expert0&#45;&gt;L4_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M37716.5,-604.12C37716.5,-551.75 37716.5,-458 37716.5,-458 37716.5,-458 42224.89,-458 42224.89,-458 42224.89,-458 42224.89,-463.11 42224.89,-463.11"/>
<polygon fill="black" stroke="black" points="42221.39,-463.11 42224.89,-473.11 42228.39,-463.11 42221.39,-463.11"/>
</g>
<!-- L4_S0_TP6_GPU6_moe_ar -->
<g id="node509" class="node">
<title>L4_S0_TP6_GPU6_moe_ar</title>
<ellipse fill="none" stroke="black" cx="42845" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="42845" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="42845" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="42845" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="42845" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP0_GPU0_expert0&#45;&gt;L4_S0_TP6_GPU6_moe_ar -->
<g id="edge1386" class="edge">
<title>L4_S0_TP0_GPU0_expert0&#45;&gt;L4_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M37694.33,-604.12C37694.33,-551.75 37694.33,-458 37694.33,-458 37694.33,-458 42594.13,-458 42594.13,-458 42594.13,-458 42594.13,-478.48 42594.13,-478.48"/>
<polygon fill="black" stroke="black" points="42590.63,-478.48 42594.13,-488.48 42597.63,-478.48 42590.63,-478.48"/>
</g>
<!-- L4_S0_TP7_GPU7_moe_ar -->
<g id="node519" class="node">
<title>L4_S0_TP7_GPU7_moe_ar</title>
<ellipse fill="none" stroke="black" cx="43532" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="43532" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="43532" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="43532" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="43532" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP0_GPU0_expert0&#45;&gt;L4_S0_TP7_GPU7_moe_ar -->
<g id="edge1422" class="edge">
<title>L4_S0_TP0_GPU0_expert0&#45;&gt;L4_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M37672.17,-604.08C37672.17,-548.71 37672.17,-446 37672.17,-446 37672.17,-446 43469.38,-446 43469.38,-446 43469.38,-446 43469.38,-462.87 43469.38,-462.87"/>
<polygon fill="black" stroke="black" points="43465.88,-462.87 43469.38,-472.87 43472.88,-462.87 43465.88,-462.87"/>
</g>
<!-- L4_S0_TP0_GPU0_expert1&#45;&gt;L4_S0_TP0_GPU0_moe_ar -->
<g id="edge1171" class="edge">
<title>L4_S0_TP0_GPU0_expert1&#45;&gt;L4_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M38254.69,-604.21C38254.69,-567.05 38254.69,-513 38254.69,-513 38254.69,-513 38382.35,-513 38382.35,-513"/>
<polygon fill="black" stroke="black" points="38382.35,-516.5 38392.35,-513 38382.35,-509.5 38382.35,-516.5"/>
</g>
<!-- L4_S0_TP0_GPU0_expert1&#45;&gt;L4_S0_TP1_GPU1_moe_ar -->
<g id="edge1207" class="edge">
<title>L4_S0_TP0_GPU0_expert1&#45;&gt;L4_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M38144.06,-604.29C38144.06,-596.26 38144.06,-590 38144.06,-590 38144.06,-590 39107.35,-590 39107.35,-590 39107.35,-590 39107.35,-550.92 39107.35,-550.92"/>
<polygon fill="black" stroke="black" points="39110.85,-550.92 39107.35,-540.92 39103.85,-550.92 39110.85,-550.92"/>
</g>
<!-- L4_S0_TP0_GPU0_expert1&#45;&gt;L4_S0_TP2_GPU2_moe_ar -->
<g id="edge1243" class="edge">
<title>L4_S0_TP0_GPU0_expert1&#45;&gt;L4_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M38199.38,-604.29C38199.38,-596.26 38199.38,-590 38199.38,-590 38199.38,-590 39809.42,-590 39809.42,-590 39809.42,-590 39809.42,-555.14 39809.42,-555.14"/>
<polygon fill="black" stroke="black" points="39812.92,-555.14 39809.42,-545.14 39805.92,-555.14 39812.92,-555.14"/>
</g>
<!-- L4_S0_TP0_GPU0_expert1&#45;&gt;L4_S0_TP3_GPU3_moe_ar -->
<g id="edge1279" class="edge">
<title>L4_S0_TP0_GPU0_expert1&#45;&gt;L4_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M38109.36,-672.68C38109.36,-687.27 38109.36,-701 38109.36,-701 38109.36,-701 40660.5,-701 40660.5,-701 40660.5,-701 40660.5,-575.52 40660.5,-575.52"/>
<polygon fill="black" stroke="black" points="40664,-575.52 40660.5,-565.52 40657,-575.52 40664,-575.52"/>
</g>
<!-- L4_S0_TP0_GPU0_expert1&#45;&gt;L4_S0_TP4_GPU4_moe_ar -->
<g id="edge1315" class="edge">
<title>L4_S0_TP0_GPU0_expert1&#45;&gt;L4_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M38088.75,-604.22C38088.75,-553.66 38088.75,-465 38088.75,-465 38088.75,-465 41402.72,-465 41402.72,-465 41402.72,-465 41402.72,-465.82 41402.72,-465.82"/>
<polygon fill="black" stroke="black" points="41399.22,-463.18 41402.72,-473.18 41406.22,-463.18 41399.22,-463.18"/>
</g>
<!-- L4_S0_TP0_GPU0_expert1&#45;&gt;L4_S0_TP5_GPU5_moe_ar -->
<g id="edge1351" class="edge">
<title>L4_S0_TP0_GPU0_expert1&#45;&gt;L4_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M38033.44,-604.22C38033.44,-553.66 38033.44,-465 38033.44,-465 38033.44,-465 42091.11,-465 42091.11,-465 42091.11,-465 42091.11,-465.82 42091.11,-465.82"/>
<polygon fill="black" stroke="black" points="42087.61,-463.18 42091.11,-473.18 42094.61,-463.18 42087.61,-463.18"/>
</g>
<!-- L4_S0_TP0_GPU0_expert1&#45;&gt;L4_S0_TP6_GPU6_moe_ar -->
<g id="edge1387" class="edge">
<title>L4_S0_TP0_GPU0_expert1&#45;&gt;L4_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M37978.12,-604.22C37978.12,-553.66 37978.12,-465 37978.12,-465 37978.12,-465 42566.27,-465 42566.27,-465 42566.27,-465 42566.27,-483.68 42566.27,-483.68"/>
<polygon fill="black" stroke="black" points="42562.77,-483.68 42566.27,-493.68 42569.77,-483.68 42562.77,-483.68"/>
</g>
<!-- L4_S0_TP0_GPU0_expert1&#45;&gt;L4_S0_TP7_GPU7_moe_ar -->
<g id="edge1423" class="edge">
<title>L4_S0_TP0_GPU0_expert1&#45;&gt;L4_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M37922.81,-604.08C37922.81,-548.71 37922.81,-446 37922.81,-446 37922.81,-446 43378.77,-446 43378.77,-446 43378.77,-446 43378.77,-467.56 43378.77,-467.56"/>
<polygon fill="black" stroke="black" points="43375.27,-467.56 43378.77,-477.56 43382.27,-467.56 43375.27,-467.56"/>
</g>
<!-- L4_S0_TP0_GPU0_moe_ar&#45;&gt;L4_S0_TP0_GPU0_moe_res -->
<g id="edge1186" class="edge">
<title>L4_S0_TP0_GPU0_moe_ar&#45;&gt;L4_S0_TP0_GPU0_moe_res</title>
<path fill="none" stroke="black" d="M38489.22,-486C38140.65,-486 37525.25,-486 37525.25,-486 37525.25,-486 37525.25,-446.36 37525.25,-446.36"/>
<polygon fill="black" stroke="black" points="37528.75,-446.36 37525.25,-436.36 37521.75,-446.36 37528.75,-446.36"/>
</g>
<!-- L4_S0_TP1_GPU1_expert0 -->
<g id="node436" class="node">
<title>L4_S0_TP1_GPU1_expert0</title>
<polygon fill="none" stroke="black" points="38783.5,-672.5 38334.5,-672.5 38334.5,-604.5 38783.5,-604.5 38783.5,-672.5"/>
<text text-anchor="middle" x="38559" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="38559" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="38559" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="38559" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L4_S0_TP1_GPU1_expert0&#45;&gt;L4_S0_TP0_GPU0_moe_ar -->
<g id="edge1172" class="edge">
<title>L4_S0_TP1_GPU1_expert0&#45;&gt;L4_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M38454.37,-604.34C38454.37,-604.34 38454.37,-559.3 38454.37,-559.3"/>
<polygon fill="black" stroke="black" points="38457.87,-559.3 38454.37,-549.3 38450.87,-559.3 38457.87,-559.3"/>
</g>
<!-- L4_S0_TP1_GPU1_expert0&#45;&gt;L4_S0_TP1_GPU1_moe_ar -->
<g id="edge1208" class="edge">
<title>L4_S0_TP1_GPU1_expert0&#45;&gt;L4_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M38520.19,-604.29C38520.19,-596.26 38520.19,-590 38520.19,-590 38520.19,-590 39123.26,-590 39123.26,-590 39123.26,-590 39123.26,-555.54 39123.26,-555.54"/>
<polygon fill="black" stroke="black" points="39126.76,-555.54 39123.26,-545.54 39119.76,-555.54 39126.76,-555.54"/>
</g>
<!-- L4_S0_TP1_GPU1_expert0&#45;&gt;L4_S0_TP2_GPU2_moe_ar -->
<g id="edge1244" class="edge">
<title>L4_S0_TP1_GPU1_expert0&#45;&gt;L4_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M38586.02,-604.29C38586.02,-596.26 38586.02,-590 38586.02,-590 38586.02,-590 39856.31,-590 39856.31,-590 39856.31,-590 39856.31,-563.99 39856.31,-563.99"/>
<polygon fill="black" stroke="black" points="39859.81,-563.99 39856.31,-553.99 39852.81,-563.99 39859.81,-563.99"/>
</g>
<!-- L4_S0_TP1_GPU1_expert0&#45;&gt;L4_S0_TP3_GPU3_moe_ar -->
<g id="edge1280" class="edge">
<title>L4_S0_TP1_GPU1_expert0&#45;&gt;L4_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M38651.85,-604.29C38651.85,-596.26 38651.85,-590 38651.85,-590 38651.85,-590 40474.78,-590 40474.78,-590 40474.78,-590 40474.78,-549.06 40474.78,-549.06"/>
<polygon fill="black" stroke="black" points="40478.28,-549.06 40474.78,-539.06 40471.28,-549.06 40478.28,-549.06"/>
</g>
<!-- L4_S0_TP1_GPU1_expert0&#45;&gt;L4_S0_TP4_GPU4_moe_ar -->
<g id="edge1316" class="edge">
<title>L4_S0_TP1_GPU1_expert0&#45;&gt;L4_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M38375.03,-604.22C38375.03,-553.66 38375.03,-465 38375.03,-465 38375.03,-465 41269.63,-465 41269.63,-465 41269.63,-465 41269.63,-471.93 41269.63,-471.93"/>
<polygon fill="black" stroke="black" points="41266.13,-471.93 41269.63,-481.93 41273.13,-471.93 41266.13,-471.93"/>
</g>
<!-- L4_S0_TP1_GPU1_expert0&#45;&gt;L4_S0_TP5_GPU5_moe_ar -->
<g id="edge1352" class="edge">
<title>L4_S0_TP1_GPU1_expert0&#45;&gt;L4_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M38361.52,-604.22C38361.52,-553.66 38361.52,-465 38361.52,-465 38361.52,-465 41957.32,-465 41957.32,-465 41957.32,-465 41957.32,-471.93 41957.32,-471.93"/>
<polygon fill="black" stroke="black" points="41953.82,-471.93 41957.32,-481.93 41960.82,-471.93 41953.82,-471.93"/>
</g>
<!-- L4_S0_TP1_GPU1_expert0&#45;&gt;L4_S0_TP6_GPU6_moe_ar -->
<g id="edge1388" class="edge">
<title>L4_S0_TP1_GPU1_expert0&#45;&gt;L4_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M38348.01,-604.22C38348.01,-553.66 38348.01,-465 38348.01,-465 38348.01,-465 42538.4,-465 42538.4,-465 42538.4,-465 42538.4,-491.03 42538.4,-491.03"/>
<polygon fill="black" stroke="black" points="42534.9,-491.03 42538.4,-501.03 42541.9,-491.03 42534.9,-491.03"/>
</g>
<!-- L4_S0_TP1_GPU1_expert0&#45;&gt;L4_S0_TP7_GPU7_moe_ar -->
<g id="edge1424" class="edge">
<title>L4_S0_TP1_GPU1_expert0&#45;&gt;L4_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M38717.67,-604.48C38717.67,-596.87 38717.67,-591 38717.67,-591 38717.67,-591 43225.98,-591 43225.98,-591 43225.98,-591 43225.98,-550.08 43225.98,-550.08"/>
<polygon fill="black" stroke="black" points="43229.48,-550.08 43225.98,-540.08 43222.48,-550.08 43229.48,-550.08"/>
</g>
<!-- L4_S0_TP1_GPU1_expert1 -->
<g id="node437" class="node">
<title>L4_S0_TP1_GPU1_expert1</title>
<polygon fill="none" stroke="black" points="39250.5,-672.5 38801.5,-672.5 38801.5,-604.5 39250.5,-604.5 39250.5,-672.5"/>
<text text-anchor="middle" x="39026" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="39026" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="39026" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="39026" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L4_S0_TP1_GPU1_expert1&#45;&gt;L4_S0_TP0_GPU0_moe_ar -->
<g id="edge1173" class="edge">
<title>L4_S0_TP1_GPU1_expert1&#45;&gt;L4_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M38824.77,-604.34C38824.77,-604.34 38824.77,-576.36 38824.77,-576.36"/>
<polygon fill="black" stroke="black" points="38828.27,-576.36 38824.77,-566.36 38821.27,-576.36 38828.27,-576.36"/>
</g>
<!-- L4_S0_TP1_GPU1_expert1&#45;&gt;L4_S0_TP1_GPU1_moe_ar -->
<g id="edge1209" class="edge">
<title>L4_S0_TP1_GPU1_expert1&#45;&gt;L4_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M39139.16,-604.34C39139.16,-604.34 39139.16,-558.91 39139.16,-558.91"/>
<polygon fill="black" stroke="black" points="39142.66,-558.91 39139.16,-548.91 39135.66,-558.91 39142.66,-558.91"/>
</g>
<!-- L4_S0_TP1_GPU1_expert1&#45;&gt;L4_S0_TP2_GPU2_moe_ar -->
<g id="edge1245" class="edge">
<title>L4_S0_TP1_GPU1_expert1&#45;&gt;L4_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M39186.88,-604.29C39186.88,-596.26 39186.88,-590 39186.88,-590 39186.88,-590 39903.19,-590 39903.19,-590 39903.19,-590 39903.19,-569.68 39903.19,-569.68"/>
<polygon fill="black" stroke="black" points="39906.69,-569.68 39903.19,-559.68 39899.69,-569.68 39906.69,-569.68"/>
</g>
<!-- L4_S0_TP1_GPU1_expert1&#45;&gt;L4_S0_TP3_GPU3_moe_ar -->
<g id="edge1281" class="edge">
<title>L4_S0_TP1_GPU1_expert1&#45;&gt;L4_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M39202.78,-604.29C39202.78,-596.26 39202.78,-590 39202.78,-590 39202.78,-590 40500.03,-590 40500.03,-590 40500.03,-590 40500.03,-555.93 40500.03,-555.93"/>
<polygon fill="black" stroke="black" points="40503.53,-555.93 40500.03,-545.93 40496.53,-555.93 40503.53,-555.93"/>
</g>
<!-- L4_S0_TP1_GPU1_expert1&#45;&gt;L4_S0_TP4_GPU4_moe_ar -->
<g id="edge1317" class="edge">
<title>L4_S0_TP1_GPU1_expert1&#45;&gt;L4_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M39218.69,-604.48C39218.69,-596.87 39218.69,-591 39218.69,-591 39218.69,-591 41181.43,-591 41181.43,-591 41181.43,-591 41181.43,-554.71 41181.43,-554.71"/>
<polygon fill="black" stroke="black" points="41184.93,-554.71 41181.43,-544.71 41177.93,-554.71 41184.93,-554.71"/>
</g>
<!-- L4_S0_TP1_GPU1_expert1&#45;&gt;L4_S0_TP5_GPU5_moe_ar -->
<g id="edge1353" class="edge">
<title>L4_S0_TP1_GPU1_expert1&#45;&gt;L4_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M39115.36,-672.78C39115.36,-688.63 39115.36,-704 39115.36,-704 39115.36,-704 42061.5,-704 42061.5,-704 42061.5,-704 42061.5,-576.74 42061.5,-576.74"/>
<polygon fill="black" stroke="black" points="42065,-576.74 42061.5,-566.74 42058,-576.74 42065,-576.74"/>
</g>
<!-- L4_S0_TP1_GPU1_expert1&#45;&gt;L4_S0_TP6_GPU6_moe_ar -->
<g id="edge1389" class="edge">
<title>L4_S0_TP1_GPU1_expert1&#45;&gt;L4_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M39234.59,-604.48C39234.59,-596.87 39234.59,-591 39234.59,-591 39234.59,-591 42593.62,-591 42593.62,-591 42593.62,-591 42593.62,-562.4 42593.62,-562.4"/>
<polygon fill="black" stroke="black" points="42597.13,-562.4 42593.62,-552.4 42590.13,-562.4 42597.13,-562.4"/>
</g>
<!-- L4_S0_TP1_GPU1_expert1&#45;&gt;L4_S0_TP7_GPU7_moe_ar -->
<g id="edge1425" class="edge">
<title>L4_S0_TP1_GPU1_expert1&#45;&gt;L4_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M38848.04,-604.48C38848.04,-596.87 38848.04,-591 38848.04,-591 38848.04,-591 43282.86,-591 43282.86,-591 43282.86,-591 43282.86,-562.82 43282.86,-562.82"/>
<polygon fill="black" stroke="black" points="43286.36,-562.82 43282.86,-552.82 43279.36,-562.82 43286.36,-562.82"/>
</g>
<!-- L4_S0_TP2_GPU2_expert0 -->
<g id="node438" class="node">
<title>L4_S0_TP2_GPU2_expert0</title>
<polygon fill="none" stroke="black" points="39717.5,-672.5 39268.5,-672.5 39268.5,-604.5 39717.5,-604.5 39717.5,-672.5"/>
<text text-anchor="middle" x="39493" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="39493" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="39493" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="39493" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L4_S0_TP2_GPU2_expert0&#45;&gt;L4_S0_TP0_GPU0_moe_ar -->
<g id="edge1174" class="edge">
<title>L4_S0_TP2_GPU2_expert0&#45;&gt;L4_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M39324.62,-604.39C39324.62,-602.89 39324.62,-602 39324.62,-602 39324.62,-602 38871.31,-602 38871.31,-602 38871.31,-602 38871.31,-573.6 38871.31,-573.6"/>
<polygon fill="black" stroke="black" points="38874.81,-573.6 38871.31,-563.6 38867.81,-573.6 38874.81,-573.6"/>
</g>
<!-- L4_S0_TP2_GPU2_expert0&#45;&gt;L4_S0_TP1_GPU1_moe_ar -->
<g id="edge1210" class="edge">
<title>L4_S0_TP2_GPU2_expert0&#45;&gt;L4_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M39380.75,-604.34C39380.75,-604.34 39380.75,-578.55 39380.75,-578.55"/>
<polygon fill="black" stroke="black" points="39384.25,-578.55 39380.75,-568.55 39377.25,-578.55 39384.25,-578.55"/>
</g>
<!-- L4_S0_TP2_GPU2_expert0&#45;&gt;L4_S0_TP2_GPU2_moe_ar -->
<g id="edge1246" class="edge">
<title>L4_S0_TP2_GPU2_expert0&#45;&gt;L4_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M39493,-604.29C39493,-596.26 39493,-590 39493,-590 39493,-590 39950.08,-590 39950.08,-590 39950.08,-590 39950.08,-573.69 39950.08,-573.69"/>
<polygon fill="black" stroke="black" points="39953.58,-573.69 39950.08,-563.69 39946.58,-573.69 39953.58,-573.69"/>
</g>
<!-- L4_S0_TP2_GPU2_expert0&#45;&gt;L4_S0_TP3_GPU3_moe_ar -->
<g id="edge1282" class="edge">
<title>L4_S0_TP2_GPU2_expert0&#45;&gt;L4_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M39549.12,-604.29C39549.12,-596.26 39549.12,-590 39549.12,-590 39549.12,-590 40525.27,-590 40525.27,-590 40525.27,-590 40525.27,-561.14 40525.27,-561.14"/>
<polygon fill="black" stroke="black" points="40528.77,-561.14 40525.27,-551.14 40521.77,-561.14 40528.77,-561.14"/>
</g>
<!-- L4_S0_TP2_GPU2_expert0&#45;&gt;L4_S0_TP4_GPU4_moe_ar -->
<g id="edge1318" class="edge">
<title>L4_S0_TP2_GPU2_expert0&#45;&gt;L4_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M39605.25,-604.48C39605.25,-596.87 39605.25,-591 39605.25,-591 39605.25,-591 41226.33,-591 41226.33,-591 41226.33,-591 41226.33,-563.23 41226.33,-563.23"/>
<polygon fill="black" stroke="black" points="41229.83,-563.23 41226.33,-553.23 41222.83,-563.23 41229.83,-563.23"/>
</g>
<!-- L4_S0_TP2_GPU2_expert0&#45;&gt;L4_S0_TP5_GPU5_moe_ar -->
<g id="edge1354" class="edge">
<title>L4_S0_TP2_GPU2_expert0&#45;&gt;L4_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M39661.38,-604.48C39661.38,-596.87 39661.38,-591 39661.38,-591 39661.38,-591 41848.98,-591 41848.98,-591 41848.98,-591 41848.98,-548.96 41848.98,-548.96"/>
<polygon fill="black" stroke="black" points="41852.48,-548.96 41848.98,-538.96 41845.48,-548.96 41852.48,-548.96"/>
</g>
<!-- L4_S0_TP2_GPU2_expert0&#45;&gt;L4_S0_TP6_GPU6_moe_ar -->
<g id="edge1390" class="edge">
<title>L4_S0_TP2_GPU2_expert0&#45;&gt;L4_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M39605.25,-672.71C39605.25,-680.74 39605.25,-687 39605.25,-687 39605.25,-687 42534.5,-687 42534.5,-687 42534.5,-687 42534.5,-548.56 42534.5,-548.56"/>
<polygon fill="black" stroke="black" points="42538,-548.56 42534.5,-538.56 42531,-548.56 42538,-548.56"/>
</g>
<!-- L4_S0_TP2_GPU2_expert0&#45;&gt;L4_S0_TP7_GPU7_moe_ar -->
<g id="edge1426" class="edge">
<title>L4_S0_TP2_GPU2_expert0&#45;&gt;L4_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M39493,-672.71C39493,-680.74 39493,-687 39493,-687 39493,-687 43467.9,-687 43467.9,-687 43467.9,-687 43467.9,-577.71 43467.9,-577.71"/>
<polygon fill="black" stroke="black" points="43471.4,-577.71 43467.9,-567.71 43464.4,-577.71 43471.4,-577.71"/>
</g>
<!-- L4_S0_TP2_GPU2_expert1 -->
<g id="node439" class="node">
<title>L4_S0_TP2_GPU2_expert1</title>
<polygon fill="none" stroke="black" points="40184.5,-672.5 39735.5,-672.5 39735.5,-604.5 40184.5,-604.5 40184.5,-672.5"/>
<text text-anchor="middle" x="39960" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="39960" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="39960" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="39960" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L4_S0_TP2_GPU2_expert1&#45;&gt;L4_S0_TP0_GPU0_moe_ar -->
<g id="edge1175" class="edge">
<title>L4_S0_TP2_GPU2_expert1&#45;&gt;L4_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M39750.49,-604.22C39750.49,-597.25 39750.49,-592 39750.49,-592 39750.49,-592 38894.58,-592 38894.58,-592 38894.58,-592 38894.58,-572.06 38894.58,-572.06"/>
<polygon fill="black" stroke="black" points="38898.08,-572.06 38894.58,-562.06 38891.08,-572.06 38898.08,-572.06"/>
</g>
<!-- L4_S0_TP2_GPU2_expert1&#45;&gt;L4_S0_TP1_GPU1_moe_ar -->
<g id="edge1211" class="edge">
<title>L4_S0_TP2_GPU2_expert1&#45;&gt;L4_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M39739.98,-604.34C39739.98,-604.34 39739.98,-538.63 39739.98,-538.63"/>
<polygon fill="black" stroke="black" points="39743.48,-538.63 39739.98,-528.63 39736.48,-538.63 39743.48,-538.63"/>
</g>
<!-- L4_S0_TP2_GPU2_expert1&#45;&gt;L4_S0_TP2_GPU2_moe_ar -->
<g id="edge1247" class="edge">
<title>L4_S0_TP2_GPU2_expert1&#45;&gt;L4_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M39996.96,-604.34C39996.96,-604.34 39996.96,-576.36 39996.96,-576.36"/>
<polygon fill="black" stroke="black" points="40000.46,-576.36 39996.96,-566.36 39993.46,-576.36 40000.46,-576.36"/>
</g>
<!-- L4_S0_TP2_GPU2_expert1&#45;&gt;L4_S0_TP3_GPU3_moe_ar -->
<g id="edge1283" class="edge">
<title>L4_S0_TP2_GPU2_expert1&#45;&gt;L4_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M40043.85,-604.29C40043.85,-596.26 40043.85,-590 40043.85,-590 40043.85,-590 40550.52,-590 40550.52,-590 40550.52,-590 40550.52,-565.21 40550.52,-565.21"/>
<polygon fill="black" stroke="black" points="40554.02,-565.21 40550.52,-555.21 40547.02,-565.21 40554.02,-565.21"/>
</g>
<!-- L4_S0_TP2_GPU2_expert1&#45;&gt;L4_S0_TP4_GPU4_moe_ar -->
<g id="edge1319" class="edge">
<title>L4_S0_TP2_GPU2_expert1&#45;&gt;L4_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M40090.73,-604.48C40090.73,-596.87 40090.73,-591 40090.73,-591 40090.73,-591 41271.23,-591 41271.23,-591 41271.23,-591 41271.23,-569.01 41271.23,-569.01"/>
<polygon fill="black" stroke="black" points="41274.73,-569.01 41271.23,-559.01 41267.73,-569.01 41274.73,-569.01"/>
</g>
<!-- L4_S0_TP2_GPU2_expert1&#45;&gt;L4_S0_TP5_GPU5_moe_ar -->
<g id="edge1355" class="edge">
<title>L4_S0_TP2_GPU2_expert1&#45;&gt;L4_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M40137.62,-604.48C40137.62,-596.87 40137.62,-591 40137.62,-591 40137.62,-591 41874.42,-591 41874.42,-591 41874.42,-591 41874.42,-556.3 41874.42,-556.3"/>
<polygon fill="black" stroke="black" points="41877.92,-556.3 41874.42,-546.3 41870.92,-556.3 41877.92,-556.3"/>
</g>
<!-- L4_S0_TP2_GPU2_expert1&#45;&gt;L4_S0_TP6_GPU6_moe_ar -->
<g id="edge1391" class="edge">
<title>L4_S0_TP2_GPU2_expert1&#45;&gt;L4_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M40142.41,-672.71C40142.41,-680.74 40142.41,-687 40142.41,-687 40142.41,-687 42531.5,-687 42531.5,-687 42531.5,-687 42531.5,-547.31 42531.5,-547.31"/>
<polygon fill="black" stroke="black" points="42535,-547.31 42531.5,-537.31 42528,-547.31 42535,-547.31"/>
</g>
<!-- L4_S0_TP2_GPU2_expert1&#45;&gt;L4_S0_TP7_GPU7_moe_ar -->
<g id="edge1427" class="edge">
<title>L4_S0_TP2_GPU2_expert1&#45;&gt;L4_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M40100.31,-672.71C40100.31,-680.74 40100.31,-687 40100.31,-687 40100.31,-687 43464.3,-687 43464.3,-687 43464.3,-687 43464.3,-577.71 43464.3,-577.71"/>
<polygon fill="black" stroke="black" points="43467.8,-577.71 43464.3,-567.71 43460.8,-577.71 43467.8,-577.71"/>
</g>
<!-- L4_S0_TP3_GPU3_expert0 -->
<g id="node440" class="node">
<title>L4_S0_TP3_GPU3_expert0</title>
<polygon fill="none" stroke="black" points="40651.5,-672.5 40202.5,-672.5 40202.5,-604.5 40651.5,-604.5 40651.5,-672.5"/>
<text text-anchor="middle" x="40427" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="40427" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="40427" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="40427" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L4_S0_TP3_GPU3_expert0&#45;&gt;L4_S0_TP0_GPU0_moe_ar -->
<g id="edge1176" class="edge">
<title>L4_S0_TP3_GPU3_expert0&#45;&gt;L4_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M40231.12,-604.48C40231.12,-596.87 40231.12,-591 40231.12,-591 40231.12,-591 38917.85,-591 38917.85,-591 38917.85,-591 38917.85,-569.84 38917.85,-569.84"/>
<polygon fill="black" stroke="black" points="38921.35,-569.84 38917.85,-559.84 38914.35,-569.84 38921.35,-569.84"/>
</g>
<!-- L4_S0_TP3_GPU3_expert0&#45;&gt;L4_S0_TP1_GPU1_moe_ar -->
<g id="edge1212" class="edge">
<title>L4_S0_TP3_GPU3_expert0&#45;&gt;L4_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M40259.74,-604.48C40259.74,-596.87 40259.74,-591 40259.74,-591 40259.74,-591 39730.36,-591 39730.36,-591 39730.36,-591 39730.36,-544.36 39730.36,-544.36"/>
<polygon fill="black" stroke="black" points="39733.86,-544.36 39730.36,-534.36 39726.86,-544.36 39733.86,-544.36"/>
</g>
<!-- L4_S0_TP3_GPU3_expert0&#45;&gt;L4_S0_TP2_GPU2_moe_ar -->
<g id="edge1248" class="edge">
<title>L4_S0_TP3_GPU3_expert0&#45;&gt;L4_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M40288.36,-604.34C40288.36,-604.34 40288.36,-569.91 40288.36,-569.91"/>
<polygon fill="black" stroke="black" points="40291.86,-569.91 40288.36,-559.91 40284.86,-569.91 40291.86,-569.91"/>
</g>
<!-- L4_S0_TP3_GPU3_expert0&#45;&gt;L4_S0_TP3_GPU3_moe_ar -->
<g id="edge1284" class="edge">
<title>L4_S0_TP3_GPU3_expert0&#45;&gt;L4_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M40575.76,-604.34C40575.76,-604.34 40575.76,-568.22 40575.76,-568.22"/>
<polygon fill="black" stroke="black" points="40579.26,-568.22 40575.76,-558.22 40572.26,-568.22 40579.26,-568.22"/>
</g>
<!-- L4_S0_TP3_GPU3_expert0&#45;&gt;L4_S0_TP4_GPU4_moe_ar -->
<g id="edge1320" class="edge">
<title>L4_S0_TP3_GPU3_expert0&#45;&gt;L4_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M40601.01,-604.48C40601.01,-596.87 40601.01,-591 40601.01,-591 40601.01,-591 41361.02,-591 41361.02,-591 41361.02,-591 41361.02,-575.92 41361.02,-575.92"/>
<polygon fill="black" stroke="black" points="41364.52,-575.92 41361.02,-565.92 41357.52,-575.92 41364.52,-575.92"/>
</g>
<!-- L4_S0_TP3_GPU3_expert0&#45;&gt;L4_S0_TP5_GPU5_moe_ar -->
<g id="edge1356" class="edge">
<title>L4_S0_TP3_GPU3_expert0&#45;&gt;L4_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M40626.25,-604.48C40626.25,-596.87 40626.25,-591 40626.25,-591 40626.25,-591 41899.86,-591 41899.86,-591 41899.86,-591 41899.86,-561.17 41899.86,-561.17"/>
<polygon fill="black" stroke="black" points="41903.36,-561.17 41899.86,-551.17 41896.36,-561.17 41903.36,-561.17"/>
</g>
<!-- L4_S0_TP3_GPU3_expert0&#45;&gt;L4_S0_TP6_GPU6_moe_ar -->
<g id="edge1392" class="edge">
<title>L4_S0_TP3_GPU3_expert0&#45;&gt;L4_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M40501.83,-672.71C40501.83,-680.74 40501.83,-687 40501.83,-687 40501.83,-687 42528.5,-687 42528.5,-687 42528.5,-687 42528.5,-546.09 42528.5,-546.09"/>
<polygon fill="black" stroke="black" points="42532,-546.09 42528.5,-536.09 42525,-546.09 42532,-546.09"/>
</g>
<!-- L4_S0_TP3_GPU3_expert0&#45;&gt;L4_S0_TP7_GPU7_moe_ar -->
<g id="edge1428" class="edge">
<title>L4_S0_TP3_GPU3_expert0&#45;&gt;L4_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M40440.5,-604.08C40440.5,-548.71 40440.5,-446 40440.5,-446 40440.5,-446 43288.15,-446 43288.15,-446 43288.15,-446 43288.15,-477.13 43288.15,-477.13"/>
<polygon fill="black" stroke="black" points="43284.65,-477.13 43288.15,-487.13 43291.65,-477.13 43284.65,-477.13"/>
</g>
<!-- L4_S0_TP3_GPU3_expert1 -->
<g id="node441" class="node">
<title>L4_S0_TP3_GPU3_expert1</title>
<polygon fill="none" stroke="black" points="41118.5,-672.5 40669.5,-672.5 40669.5,-604.5 41118.5,-604.5 41118.5,-672.5"/>
<text text-anchor="middle" x="40894" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="40894" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="40894" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="40894" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L4_S0_TP3_GPU3_expert1&#45;&gt;L4_S0_TP0_GPU0_moe_ar -->
<g id="edge1177" class="edge">
<title>L4_S0_TP3_GPU3_expert1&#45;&gt;L4_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M40719.38,-604.48C40719.38,-596.87 40719.38,-591 40719.38,-591 40719.38,-591 38941.12,-591 38941.12,-591 38941.12,-591 38941.12,-566.95 38941.12,-566.95"/>
<polygon fill="black" stroke="black" points="38944.62,-566.95 38941.12,-556.95 38937.62,-566.95 38944.62,-566.95"/>
</g>
<!-- L4_S0_TP3_GPU3_expert1&#45;&gt;L4_S0_TP1_GPU1_moe_ar -->
<g id="edge1213" class="edge">
<title>L4_S0_TP3_GPU3_expert1&#45;&gt;L4_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M40769.27,-604.48C40769.27,-596.87 40769.27,-591 40769.27,-591 40769.27,-591 39732.93,-591 39732.93,-591 39732.93,-591 39732.93,-543.04 39732.93,-543.04"/>
<polygon fill="black" stroke="black" points="39736.43,-543.04 39732.93,-533.04 39729.43,-543.04 39736.43,-543.04"/>
</g>
<!-- L4_S0_TP3_GPU3_expert1&#45;&gt;L4_S0_TP2_GPU2_moe_ar -->
<g id="edge1249" class="edge">
<title>L4_S0_TP3_GPU3_expert1&#45;&gt;L4_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M40819.15,-604.48C40819.15,-596.87 40819.15,-591 40819.15,-591 40819.15,-591 40316.98,-591 40316.98,-591 40316.98,-591 40316.98,-566.95 40316.98,-566.95"/>
<polygon fill="black" stroke="black" points="40320.48,-566.95 40316.98,-556.95 40313.48,-566.95 40320.48,-566.95"/>
</g>
<!-- L4_S0_TP3_GPU3_expert1&#45;&gt;L4_S0_TP3_GPU3_moe_ar -->
<g id="edge1285" class="edge">
<title>L4_S0_TP3_GPU3_expert1&#45;&gt;L4_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M40869.04,-604.34C40869.04,-604.34 40869.04,-577.23 40869.04,-577.23"/>
<polygon fill="black" stroke="black" points="40872.54,-577.23 40869.04,-567.23 40865.54,-577.23 40872.54,-577.23"/>
</g>
<!-- L4_S0_TP3_GPU3_expert1&#45;&gt;L4_S0_TP4_GPU4_moe_ar -->
<g id="edge1321" class="edge">
<title>L4_S0_TP3_GPU3_expert1&#45;&gt;L4_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M41118.75,-627C41125.17,-627 41128.84,-627 41128.84,-627 41128.84,-627 41128.84,-504 41128.84,-504 41128.84,-504 41146.55,-504 41146.55,-504"/>
<polygon fill="black" stroke="black" points="41146.55,-507.5 41156.55,-504 41146.55,-500.5 41146.55,-507.5"/>
</g>
<!-- L4_S0_TP3_GPU3_expert1&#45;&gt;L4_S0_TP5_GPU5_moe_ar -->
<g id="edge1357" class="edge">
<title>L4_S0_TP3_GPU3_expert1&#45;&gt;L4_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M40918.92,-604.48C40918.92,-596.87 40918.92,-591 40918.92,-591 40918.92,-591 41925.3,-591 41925.3,-591 41925.3,-591 41925.3,-565.29 41925.3,-565.29"/>
<polygon fill="black" stroke="black" points="41928.8,-565.29 41925.3,-555.29 41921.8,-565.29 41928.8,-565.29"/>
</g>
<!-- L4_S0_TP3_GPU3_expert1&#45;&gt;L4_S0_TP6_GPU6_moe_ar -->
<g id="edge1393" class="edge">
<title>L4_S0_TP3_GPU3_expert1&#45;&gt;L4_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M41005.71,-672.71C41005.71,-680.74 41005.71,-687 41005.71,-687 41005.71,-687 42525.5,-687 42525.5,-687 42525.5,-687 42525.5,-544.91 42525.5,-544.91"/>
<polygon fill="black" stroke="black" points="42529,-544.91 42525.5,-534.91 42522,-544.91 42529,-544.91"/>
</g>
<!-- L4_S0_TP3_GPU3_expert1&#45;&gt;L4_S0_TP7_GPU7_moe_ar -->
<g id="edge1429" class="edge">
<title>L4_S0_TP3_GPU3_expert1&#45;&gt;L4_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M40893.64,-672.71C40893.64,-680.74 40893.64,-687 40893.64,-687 40893.64,-687 43460.7,-687 43460.7,-687 43460.7,-687 43460.7,-577.71 43460.7,-577.71"/>
<polygon fill="black" stroke="black" points="43464.2,-577.71 43460.7,-567.71 43457.2,-577.71 43464.2,-577.71"/>
</g>
<!-- L4_S0_TP4_GPU4_expert0 -->
<g id="node442" class="node">
<title>L4_S0_TP4_GPU4_expert0</title>
<polygon fill="none" stroke="black" points="41585.5,-672.5 41136.5,-672.5 41136.5,-604.5 41585.5,-604.5 41585.5,-672.5"/>
<text text-anchor="middle" x="41361" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="41361" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="41361" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="41361" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L4_S0_TP4_GPU4_expert0&#45;&gt;L4_S0_TP0_GPU0_moe_ar -->
<g id="edge1178" class="edge">
<title>L4_S0_TP4_GPU4_expert0&#45;&gt;L4_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M41361,-672.64C41361,-686.36 41361,-699 41361,-699 41361,-699 38797.9,-699 38797.9,-699 38797.9,-699 38797.9,-577.34 38797.9,-577.34"/>
<polygon fill="black" stroke="black" points="38801.4,-577.34 38797.9,-567.34 38794.4,-577.34 38801.4,-577.34"/>
</g>
<!-- L4_S0_TP4_GPU4_expert0&#45;&gt;L4_S0_TP1_GPU1_moe_ar -->
<g id="edge1214" class="edge">
<title>L4_S0_TP4_GPU4_expert0&#45;&gt;L4_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M41248.75,-672.77C41248.75,-678.17 41248.75,-682 41248.75,-682 41248.75,-682 39725.21,-682 39725.21,-682 39725.21,-682 39725.21,-546.5 39725.21,-546.5"/>
<polygon fill="black" stroke="black" points="39728.71,-546.5 39725.21,-536.5 39721.71,-546.5 39728.71,-546.5"/>
</g>
<!-- L4_S0_TP4_GPU4_expert0&#45;&gt;L4_S0_TP2_GPU2_moe_ar -->
<g id="edge1250" class="edge">
<title>L4_S0_TP4_GPU4_expert0&#45;&gt;L4_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M41316.12,-604.48C41316.12,-596.87 41316.12,-591 41316.12,-591 41316.12,-591 40345.6,-591 40345.6,-591 40345.6,-591 40345.6,-562.82 40345.6,-562.82"/>
<polygon fill="black" stroke="black" points="40349.1,-562.82 40345.6,-552.82 40342.1,-562.82 40349.1,-562.82"/>
</g>
<!-- L4_S0_TP4_GPU4_expert0&#45;&gt;L4_S0_TP3_GPU3_moe_ar -->
<g id="edge1286" class="edge">
<title>L4_S0_TP4_GPU4_expert0&#45;&gt;L4_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M41136.46,-649C41130.05,-649 41126.38,-649 41126.38,-649 41126.38,-649 41126.38,-536 41126.38,-536 41126.38,-536 41110.65,-536 41110.65,-536"/>
<polygon fill="black" stroke="black" points="41110.65,-532.5 41100.65,-536 41110.65,-539.5 41110.65,-532.5"/>
</g>
<!-- L4_S0_TP4_GPU4_expert0&#45;&gt;L4_S0_TP4_GPU4_moe_ar -->
<g id="edge1322" class="edge">
<title>L4_S0_TP4_GPU4_expert0&#45;&gt;L4_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M41405.92,-604.34C41405.92,-604.34 41405.92,-577.67 41405.92,-577.67"/>
<polygon fill="black" stroke="black" points="41409.42,-577.67 41405.92,-567.67 41402.42,-577.67 41409.42,-577.67"/>
</g>
<!-- L4_S0_TP4_GPU4_expert0&#45;&gt;L4_S0_TP5_GPU5_moe_ar -->
<g id="edge1358" class="edge">
<title>L4_S0_TP4_GPU4_expert0&#45;&gt;L4_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M41450.81,-604.39C41450.81,-602.89 41450.81,-602 41450.81,-602 41450.81,-602 41950.74,-602 41950.74,-602 41950.74,-602 41950.74,-568.34 41950.74,-568.34"/>
<polygon fill="black" stroke="black" points="41954.24,-568.34 41950.74,-558.34 41947.24,-568.34 41954.24,-568.34"/>
</g>
<!-- L4_S0_TP4_GPU4_expert0&#45;&gt;L4_S0_TP6_GPU6_moe_ar -->
<g id="edge1394" class="edge">
<title>L4_S0_TP4_GPU4_expert0&#45;&gt;L4_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M41495.71,-604.39C41495.71,-602.89 41495.71,-602 41495.71,-602 41495.71,-602 42522.5,-602 42522.5,-602 42522.5,-602 42522.5,-543.16 42522.5,-543.16"/>
<polygon fill="black" stroke="black" points="42526,-543.16 42522.5,-533.16 42519,-543.16 42526,-543.16"/>
</g>
<!-- L4_S0_TP4_GPU4_expert0&#45;&gt;L4_S0_TP7_GPU7_moe_ar -->
<g id="edge1430" class="edge">
<title>L4_S0_TP4_GPU4_expert0&#45;&gt;L4_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M41540.6,-604.39C41540.6,-602.89 41540.6,-602 41540.6,-602 41540.6,-602 43311.3,-602 43311.3,-602 43311.3,-602 43311.3,-566.91 43311.3,-566.91"/>
<polygon fill="black" stroke="black" points="43314.8,-566.91 43311.3,-556.91 43307.8,-566.91 43314.8,-566.91"/>
</g>
<!-- L4_S0_TP4_GPU4_expert1 -->
<g id="node443" class="node">
<title>L4_S0_TP4_GPU4_expert1</title>
<polygon fill="none" stroke="black" points="42052.5,-672.5 41603.5,-672.5 41603.5,-604.5 42052.5,-604.5 42052.5,-672.5"/>
<text text-anchor="middle" x="41828" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="41828" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="41828" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="41828" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L4_S0_TP4_GPU4_expert1&#45;&gt;L4_S0_TP0_GPU0_moe_ar -->
<g id="edge1179" class="edge">
<title>L4_S0_TP4_GPU4_expert1&#45;&gt;L4_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M41828,-672.78C41828,-688.63 41828,-704 41828,-704 41828,-704 38794.3,-704 38794.3,-704 38794.3,-704 38794.3,-577.69 38794.3,-577.69"/>
<polygon fill="black" stroke="black" points="38797.8,-577.69 38794.3,-567.69 38790.8,-577.69 38797.8,-577.69"/>
</g>
<!-- L4_S0_TP4_GPU4_expert1&#45;&gt;L4_S0_TP1_GPU1_moe_ar -->
<g id="edge1215" class="edge">
<title>L4_S0_TP4_GPU4_expert1&#45;&gt;L4_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M41715.75,-672.77C41715.75,-678.17 41715.75,-682 41715.75,-682 41715.75,-682 39722.64,-682 39722.64,-682 39722.64,-682 39722.64,-547.71 39722.64,-547.71"/>
<polygon fill="black" stroke="black" points="39726.14,-547.71 39722.64,-537.71 39719.14,-547.71 39726.14,-547.71"/>
</g>
<!-- L4_S0_TP4_GPU4_expert1&#45;&gt;L4_S0_TP2_GPU2_moe_ar -->
<g id="edge1251" class="edge">
<title>L4_S0_TP4_GPU4_expert1&#45;&gt;L4_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M41628.75,-604.48C41628.75,-596.87 41628.75,-591 41628.75,-591 41628.75,-591 40374.22,-591 40374.22,-591 40374.22,-591 40374.22,-557.5 40374.22,-557.5"/>
<polygon fill="black" stroke="black" points="40377.72,-557.5 40374.22,-547.5 40370.72,-557.5 40377.72,-557.5"/>
</g>
<!-- L4_S0_TP4_GPU4_expert1&#45;&gt;L4_S0_TP3_GPU3_moe_ar -->
<g id="edge1287" class="edge">
<title>L4_S0_TP4_GPU4_expert1&#45;&gt;L4_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M41653.99,-604.48C41653.99,-596.87 41653.99,-591 41653.99,-591 41653.99,-591 40968.81,-591 40968.81,-591 40968.81,-591 40968.81,-570.66 40968.81,-570.66"/>
<polygon fill="black" stroke="black" points="40972.31,-570.66 40968.81,-560.66 40965.31,-570.66 40972.31,-570.66"/>
</g>
<!-- L4_S0_TP4_GPU4_expert1&#45;&gt;L4_S0_TP4_GPU4_moe_ar -->
<g id="edge1323" class="edge">
<title>L4_S0_TP4_GPU4_expert1&#45;&gt;L4_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M41679.24,-604.34C41679.24,-604.34 41679.24,-568.22 41679.24,-568.22"/>
<polygon fill="black" stroke="black" points="41682.74,-568.22 41679.24,-558.22 41675.74,-568.22 41682.74,-568.22"/>
</g>
<!-- L4_S0_TP4_GPU4_expert1&#45;&gt;L4_S0_TP5_GPU5_moe_ar -->
<g id="edge1359" class="edge">
<title>L4_S0_TP4_GPU4_expert1&#45;&gt;L4_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M41976.18,-604.34C41976.18,-604.34 41976.18,-571.18 41976.18,-571.18"/>
<polygon fill="black" stroke="black" points="41979.68,-571.18 41976.18,-561.18 41972.68,-571.18 41979.68,-571.18"/>
</g>
<!-- L4_S0_TP4_GPU4_expert1&#45;&gt;L4_S0_TP6_GPU6_moe_ar -->
<g id="edge1395" class="edge">
<title>L4_S0_TP4_GPU4_expert1&#45;&gt;L4_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M42001.62,-604.39C42001.62,-602.89 42001.62,-602 42001.62,-602 42001.62,-602 42513.53,-602 42513.53,-602 42513.53,-602 42513.53,-537.09 42513.53,-537.09"/>
<polygon fill="black" stroke="black" points="42517.03,-537.09 42513.53,-527.09 42510.03,-537.09 42517.03,-537.09"/>
</g>
<!-- L4_S0_TP4_GPU4_expert1&#45;&gt;L4_S0_TP7_GPU7_moe_ar -->
<g id="edge1431" class="edge">
<title>L4_S0_TP4_GPU4_expert1&#45;&gt;L4_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M42027.06,-604.39C42027.06,-602.89 42027.06,-602 42027.06,-602 42027.06,-602 43339.74,-602 43339.74,-602 43339.74,-602 43339.74,-569.77 43339.74,-569.77"/>
<polygon fill="black" stroke="black" points="43343.24,-569.77 43339.74,-559.77 43336.24,-569.77 43343.24,-569.77"/>
</g>
<!-- L4_S0_TP5_GPU5_expert0 -->
<g id="node444" class="node">
<title>L4_S0_TP5_GPU5_expert0</title>
<polygon fill="none" stroke="black" points="42519.5,-672.5 42070.5,-672.5 42070.5,-604.5 42519.5,-604.5 42519.5,-672.5"/>
<text text-anchor="middle" x="42295" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="42295" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="42295" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="42295" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L4_S0_TP5_GPU5_expert0&#45;&gt;L4_S0_TP0_GPU0_moe_ar -->
<g id="edge1180" class="edge">
<title>L4_S0_TP5_GPU5_expert0&#45;&gt;L4_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M42154.02,-672.53C42154.02,-688.89 42154.02,-705 42154.02,-705 42154.02,-705 38790.7,-705 38790.7,-705 38790.7,-705 38790.7,-577.95 38790.7,-577.95"/>
<polygon fill="black" stroke="black" points="38794.2,-577.95 38790.7,-567.95 38787.2,-577.95 38794.2,-577.95"/>
</g>
<!-- L4_S0_TP5_GPU5_expert0&#45;&gt;L4_S0_TP1_GPU1_moe_ar -->
<g id="edge1216" class="edge">
<title>L4_S0_TP5_GPU5_expert0&#45;&gt;L4_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M42112.26,-672.77C42112.26,-678.17 42112.26,-682 42112.26,-682 42112.26,-682 39720.07,-682 39720.07,-682 39720.07,-682 39720.07,-548.64 39720.07,-548.64"/>
<polygon fill="black" stroke="black" points="39723.57,-548.64 39720.07,-538.64 39716.57,-548.64 39723.57,-548.64"/>
</g>
<!-- L4_S0_TP5_GPU5_expert0&#45;&gt;L4_S0_TP2_GPU2_moe_ar -->
<g id="edge1252" class="edge">
<title>L4_S0_TP5_GPU5_expert0&#45;&gt;L4_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M42112.7,-604.48C42112.7,-596.87 42112.7,-591 42112.7,-591 42112.7,-591 40402.84,-591 40402.84,-591 40402.84,-591 40402.84,-550.08 40402.84,-550.08"/>
<polygon fill="black" stroke="black" points="40406.34,-550.08 40402.84,-540.08 40399.34,-550.08 40406.34,-550.08"/>
</g>
<!-- L4_S0_TP5_GPU5_expert0&#45;&gt;L4_S0_TP3_GPU3_moe_ar -->
<g id="edge1288" class="edge">
<title>L4_S0_TP5_GPU5_expert0&#45;&gt;L4_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M42154.89,-604.29C42154.89,-596.26 42154.89,-590 42154.89,-590 42154.89,-590 41018.69,-590 41018.69,-590 41018.69,-590 41018.69,-564.8 41018.69,-564.8"/>
<polygon fill="black" stroke="black" points="41022.19,-564.8 41018.69,-554.8 41015.19,-564.8 41022.19,-564.8"/>
</g>
<!-- L4_S0_TP5_GPU5_expert0&#45;&gt;L4_S0_TP4_GPU4_moe_ar -->
<g id="edge1324" class="edge">
<title>L4_S0_TP5_GPU5_expert0&#45;&gt;L4_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M42197.09,-604.29C42197.09,-596.26 42197.09,-590 42197.09,-590 42197.09,-590 41704.48,-590 41704.48,-590 41704.48,-590 41704.48,-565.21 41704.48,-565.21"/>
<polygon fill="black" stroke="black" points="41707.98,-565.21 41704.48,-555.21 41700.98,-565.21 41707.98,-565.21"/>
</g>
<!-- L4_S0_TP5_GPU5_expert0&#45;&gt;L4_S0_TP5_GPU5_moe_ar -->
<g id="edge1360" class="edge">
<title>L4_S0_TP5_GPU5_expert0&#45;&gt;L4_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M42239.28,-604.34C42239.28,-604.34 42239.28,-577.23 42239.28,-577.23"/>
<polygon fill="black" stroke="black" points="42242.78,-577.23 42239.28,-567.23 42235.78,-577.23 42242.78,-577.23"/>
</g>
<!-- L4_S0_TP5_GPU5_expert0&#45;&gt;L4_S0_TP6_GPU6_moe_ar -->
<g id="edge1396" class="edge">
<title>L4_S0_TP5_GPU5_expert0&#45;&gt;L4_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M42516.51,-604.34C42516.51,-604.34 42516.51,-539.61 42516.51,-539.61"/>
<polygon fill="black" stroke="black" points="42520.01,-539.61 42516.51,-529.61 42513.01,-539.61 42520.01,-539.61"/>
</g>
<!-- L4_S0_TP5_GPU5_expert0&#45;&gt;L4_S0_TP7_GPU7_moe_ar -->
<g id="edge1432" class="edge">
<title>L4_S0_TP5_GPU5_expert0&#45;&gt;L4_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M42501.5,-604.39C42501.5,-602.89 42501.5,-602 42501.5,-602 42501.5,-602 43368.18,-602 43368.18,-602 43368.18,-602 43368.18,-572.64 43368.18,-572.64"/>
<polygon fill="black" stroke="black" points="43371.68,-572.64 43368.18,-562.64 43364.68,-572.64 43371.68,-572.64"/>
</g>
<!-- L4_S0_TP5_GPU5_expert1 -->
<g id="node445" class="node">
<title>L4_S0_TP5_GPU5_expert1</title>
<polygon fill="none" stroke="black" points="42986.5,-672.5 42537.5,-672.5 42537.5,-604.5 42986.5,-604.5 42986.5,-672.5"/>
<text text-anchor="middle" x="42762" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="42762" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="42762" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="42762" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L4_S0_TP5_GPU5_expert1&#45;&gt;L4_S0_TP0_GPU0_moe_ar -->
<g id="edge1181" class="edge">
<title>L4_S0_TP5_GPU5_expert1&#45;&gt;L4_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M42762,-672.75C42762,-689.87 42762,-707 42762,-707 42762,-707 38787.1,-707 38787.1,-707 38787.1,-707 38787.1,-577.98 38787.1,-577.98"/>
<polygon fill="black" stroke="black" points="38790.6,-577.98 38787.1,-567.98 38783.6,-577.98 38790.6,-577.98"/>
</g>
<!-- L4_S0_TP5_GPU5_expert1&#45;&gt;L4_S0_TP1_GPU1_moe_ar -->
<g id="edge1217" class="edge">
<title>L4_S0_TP5_GPU5_expert1&#45;&gt;L4_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M42649.75,-604.48C42649.75,-596.87 42649.75,-591 42649.75,-591 42649.75,-591 39436.88,-591 39436.88,-591 39436.88,-591 39436.88,-578.67 39436.88,-578.67"/>
<polygon fill="black" stroke="black" points="39440.38,-578.67 39436.88,-568.67 39433.38,-578.67 39440.38,-578.67"/>
</g>
<!-- L4_S0_TP5_GPU5_expert1&#45;&gt;L4_S0_TP2_GPU2_moe_ar -->
<g id="edge1253" class="edge">
<title>L4_S0_TP5_GPU5_expert1&#45;&gt;L4_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M42649.75,-672.71C42649.75,-680.74 42649.75,-687 42649.75,-687 42649.75,-687 40193.5,-687 40193.5,-687 40193.5,-687 40193.5,-576.82 40193.5,-576.82"/>
<polygon fill="black" stroke="black" points="40197,-576.82 40193.5,-566.82 40190,-576.82 40197,-576.82"/>
</g>
<!-- L4_S0_TP5_GPU5_expert1&#45;&gt;L4_S0_TP3_GPU3_moe_ar -->
<g id="edge1289" class="edge">
<title>L4_S0_TP5_GPU5_expert1&#45;&gt;L4_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M42705.88,-604.29C42705.88,-596.26 42705.88,-590 42705.88,-590 42705.88,-590 41068.58,-590 41068.58,-590 41068.58,-590 41068.58,-555.93 41068.58,-555.93"/>
<polygon fill="black" stroke="black" points="41072.08,-555.93 41068.58,-545.93 41065.08,-555.93 41072.08,-555.93"/>
</g>
<!-- L4_S0_TP5_GPU5_expert1&#45;&gt;L4_S0_TP4_GPU4_moe_ar -->
<g id="edge1325" class="edge">
<title>L4_S0_TP5_GPU5_expert1&#45;&gt;L4_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M42762,-604.29C42762,-596.26 42762,-590 42762,-590 42762,-590 41729.73,-590 41729.73,-590 41729.73,-590 41729.73,-561.14 41729.73,-561.14"/>
<polygon fill="black" stroke="black" points="41733.23,-561.14 41729.73,-551.14 41726.23,-561.14 41733.23,-561.14"/>
</g>
<!-- L4_S0_TP5_GPU5_expert1&#45;&gt;L4_S0_TP5_GPU5_moe_ar -->
<g id="edge1361" class="edge">
<title>L4_S0_TP5_GPU5_expert1&#45;&gt;L4_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M42818.12,-604.29C42818.12,-596.26 42818.12,-590 42818.12,-590 42818.12,-590 42281.48,-590 42281.48,-590 42281.48,-590 42281.48,-575.27 42281.48,-575.27"/>
<polygon fill="black" stroke="black" points="42284.98,-575.27 42281.48,-565.27 42277.98,-575.27 42284.98,-575.27"/>
</g>
<!-- L4_S0_TP5_GPU5_expert1&#45;&gt;L4_S0_TP6_GPU6_moe_ar -->
<g id="edge1397" class="edge">
<title>L4_S0_TP5_GPU5_expert1&#45;&gt;L4_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M42874.25,-604.34C42874.25,-604.34 42874.25,-578.55 42874.25,-578.55"/>
<polygon fill="black" stroke="black" points="42877.75,-578.55 42874.25,-568.55 42870.75,-578.55 42877.75,-578.55"/>
</g>
<!-- L4_S0_TP5_GPU5_expert1&#45;&gt;L4_S0_TP7_GPU7_moe_ar -->
<g id="edge1433" class="edge">
<title>L4_S0_TP5_GPU5_expert1&#45;&gt;L4_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M42930.38,-604.39C42930.38,-602.89 42930.38,-602 42930.38,-602 42930.38,-602 43396.62,-602 43396.62,-602 43396.62,-602 43396.62,-574.55 43396.62,-574.55"/>
<polygon fill="black" stroke="black" points="43400.12,-574.55 43396.62,-564.55 43393.12,-574.55 43400.12,-574.55"/>
</g>
<!-- L4_S0_TP6_GPU6_expert0 -->
<g id="node446" class="node">
<title>L4_S0_TP6_GPU6_expert0</title>
<polygon fill="none" stroke="black" points="43453.5,-672.5 43004.5,-672.5 43004.5,-604.5 43453.5,-604.5 43453.5,-672.5"/>
<text text-anchor="middle" x="43229" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="43229" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="43229" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="43229" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L4_S0_TP6_GPU6_expert0&#45;&gt;L4_S0_TP0_GPU0_moe_ar -->
<g id="edge1182" class="edge">
<title>L4_S0_TP6_GPU6_expert0&#45;&gt;L4_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M43254.42,-604.48C43254.42,-596.87 43254.42,-591 43254.42,-591 43254.42,-591 38964.38,-591 38964.38,-591 38964.38,-591 38964.38,-564.05 38964.38,-564.05"/>
<polygon fill="black" stroke="black" points="38967.88,-564.05 38964.38,-554.05 38960.88,-564.05 38967.88,-564.05"/>
</g>
<!-- L4_S0_TP6_GPU6_expert0&#45;&gt;L4_S0_TP1_GPU1_moe_ar -->
<g id="edge1218" class="edge">
<title>L4_S0_TP6_GPU6_expert0&#45;&gt;L4_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M43026.37,-604.48C43026.37,-596.87 43026.37,-591 43026.37,-591 43026.37,-591 39155.07,-591 39155.07,-591 39155.07,-591 39155.07,-561.58 39155.07,-561.58"/>
<polygon fill="black" stroke="black" points="39158.57,-561.58 39155.07,-551.58 39151.57,-561.58 39158.57,-561.58"/>
</g>
<!-- L4_S0_TP6_GPU6_expert0&#45;&gt;L4_S0_TP2_GPU2_moe_ar -->
<g id="edge1254" class="edge">
<title>L4_S0_TP6_GPU6_expert0&#45;&gt;L4_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M43188.5,-604.08C43188.5,-548.71 43188.5,-446 43188.5,-446 43188.5,-446 40387.77,-446 40387.77,-446 40387.77,-446 40387.77,-486.46 40387.77,-486.46"/>
<polygon fill="black" stroke="black" points="40384.27,-486.46 40387.77,-496.46 40391.27,-486.46 40384.27,-486.46"/>
</g>
<!-- L4_S0_TP6_GPU6_expert0&#45;&gt;L4_S0_TP3_GPU3_moe_ar -->
<g id="edge1290" class="edge">
<title>L4_S0_TP6_GPU6_expert0&#45;&gt;L4_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M43183.98,-604.08C43183.98,-548.71 43183.98,-446 43183.98,-446 43183.98,-446 41101.37,-446 41101.37,-446 41101.37,-446 41101.37,-495 41101.37,-495"/>
<polygon fill="black" stroke="black" points="41097.87,-495 41101.37,-505 41104.87,-495 41097.87,-495"/>
</g>
<!-- L4_S0_TP6_GPU6_expert0&#45;&gt;L4_S0_TP4_GPU4_moe_ar -->
<g id="edge1326" class="edge">
<title>L4_S0_TP6_GPU6_expert0&#45;&gt;L4_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M43048.24,-604.29C43048.24,-596.26 43048.24,-590 43048.24,-590 43048.24,-590 41754.97,-590 41754.97,-590 41754.97,-590 41754.97,-555.93 41754.97,-555.93"/>
<polygon fill="black" stroke="black" points="41758.47,-555.93 41754.97,-545.93 41751.47,-555.93 41758.47,-555.93"/>
</g>
<!-- L4_S0_TP6_GPU6_expert0&#45;&gt;L4_S0_TP5_GPU5_moe_ar -->
<g id="edge1362" class="edge">
<title>L4_S0_TP6_GPU6_expert0&#45;&gt;L4_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M43070.11,-604.29C43070.11,-596.26 43070.11,-590 43070.11,-590 43070.11,-590 42323.68,-590 42323.68,-590 42323.68,-590 42323.68,-572.5 42323.68,-572.5"/>
<polygon fill="black" stroke="black" points="42327.18,-572.5 42323.68,-562.5 42320.18,-572.5 42327.18,-572.5"/>
</g>
<!-- L4_S0_TP6_GPU6_expert0&#45;&gt;L4_S0_TP6_GPU6_moe_ar -->
<g id="edge1398" class="edge">
<title>L4_S0_TP6_GPU6_expert0&#45;&gt;L4_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M43091.98,-604.34C43091.98,-604.34 43091.98,-562.87 43091.98,-562.87"/>
<polygon fill="black" stroke="black" points="43095.48,-562.87 43091.98,-552.87 43088.48,-562.87 43095.48,-562.87"/>
</g>
<!-- L4_S0_TP6_GPU6_expert0&#45;&gt;L4_S0_TP7_GPU7_moe_ar -->
<g id="edge1434" class="edge">
<title>L4_S0_TP6_GPU6_expert0&#45;&gt;L4_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M43425.06,-604.34C43425.06,-604.34 43425.06,-576.36 43425.06,-576.36"/>
<polygon fill="black" stroke="black" points="43428.56,-576.36 43425.06,-566.36 43421.56,-576.36 43428.56,-576.36"/>
</g>
<!-- L4_S0_TP6_GPU6_expert1 -->
<g id="node447" class="node">
<title>L4_S0_TP6_GPU6_expert1</title>
<polygon fill="none" stroke="black" points="43920.5,-672.5 43471.5,-672.5 43471.5,-604.5 43920.5,-604.5 43920.5,-672.5"/>
<text text-anchor="middle" x="43696" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="43696" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="43696" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="43696" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L4_S0_TP6_GPU6_expert1&#45;&gt;L4_S0_TP0_GPU0_moe_ar -->
<g id="edge1183" class="edge">
<title>L4_S0_TP6_GPU6_expert1&#45;&gt;L4_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M43527.92,-604.48C43527.92,-596.87 43527.92,-591 43527.92,-591 43527.92,-591 38987.65,-591 38987.65,-591 38987.65,-591 38987.65,-559.94 38987.65,-559.94"/>
<polygon fill="black" stroke="black" points="38991.15,-559.94 38987.65,-549.94 38984.15,-559.94 38991.15,-559.94"/>
</g>
<!-- L4_S0_TP6_GPU6_expert1&#45;&gt;L4_S0_TP1_GPU1_moe_ar -->
<g id="edge1219" class="edge">
<title>L4_S0_TP6_GPU6_expert1&#45;&gt;L4_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M43584.35,-604.48C43584.35,-596.87 43584.35,-591 43584.35,-591 43584.35,-591 39170.97,-591 39170.97,-591 39170.97,-591 39170.97,-564.05 39170.97,-564.05"/>
<polygon fill="black" stroke="black" points="39174.47,-564.05 39170.97,-554.05 39167.47,-564.05 39174.47,-564.05"/>
</g>
<!-- L4_S0_TP6_GPU6_expert1&#45;&gt;L4_S0_TP2_GPU2_moe_ar -->
<g id="edge1255" class="edge">
<title>L4_S0_TP6_GPU6_expert1&#45;&gt;L4_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M43902.49,-604.08C43902.49,-548.71 43902.49,-446 43902.49,-446 43902.49,-446 40344.08,-446 40344.08,-446 40344.08,-446 40344.08,-477.99 40344.08,-477.99"/>
<polygon fill="black" stroke="black" points="40340.58,-477.99 40344.08,-487.99 40347.58,-477.99 40340.58,-477.99"/>
</g>
<!-- L4_S0_TP6_GPU6_expert1&#45;&gt;L4_S0_TP3_GPU3_moe_ar -->
<g id="edge1291" class="edge">
<title>L4_S0_TP6_GPU6_expert1&#45;&gt;L4_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M43884.47,-604.08C43884.47,-548.71 43884.47,-446 43884.47,-446 43884.47,-446 41084.28,-446 41084.28,-446 41084.28,-446 41084.28,-488.89 41084.28,-488.89"/>
<polygon fill="black" stroke="black" points="41080.78,-488.89 41084.28,-498.89 41087.78,-488.89 41080.78,-488.89"/>
</g>
<!-- L4_S0_TP6_GPU6_expert1&#45;&gt;L4_S0_TP4_GPU4_moe_ar -->
<g id="edge1327" class="edge">
<title>L4_S0_TP6_GPU6_expert1&#45;&gt;L4_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M43640.77,-604.29C43640.77,-596.26 43640.77,-590 43640.77,-590 43640.77,-590 41780.22,-590 41780.22,-590 41780.22,-590 41780.22,-549.06 41780.22,-549.06"/>
<polygon fill="black" stroke="black" points="41783.72,-549.06 41780.22,-539.06 41776.72,-549.06 41783.72,-549.06"/>
</g>
<!-- L4_S0_TP6_GPU6_expert1&#45;&gt;L4_S0_TP5_GPU5_moe_ar -->
<g id="edge1363" class="edge">
<title>L4_S0_TP6_GPU6_expert1&#45;&gt;L4_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M43697.19,-604.29C43697.19,-596.26 43697.19,-590 43697.19,-590 43697.19,-590 42365.87,-590 42365.87,-590 42365.87,-590 42365.87,-568.47 42365.87,-568.47"/>
<polygon fill="black" stroke="black" points="42369.37,-568.47 42365.87,-558.47 42362.37,-568.47 42369.37,-568.47"/>
</g>
<!-- L4_S0_TP6_GPU6_expert1&#45;&gt;L4_S0_TP6_GPU6_moe_ar -->
<g id="edge1399" class="edge">
<title>L4_S0_TP6_GPU6_expert1&#45;&gt;L4_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M43753.62,-604.29C43753.62,-596.26 43753.62,-590 43753.62,-590 43753.62,-590 43113.85,-590 43113.85,-590 43113.85,-590 43113.85,-559.12 43113.85,-559.12"/>
<polygon fill="black" stroke="black" points="43117.35,-559.12 43113.85,-549.12 43110.35,-559.12 43117.35,-559.12"/>
</g>
<!-- L4_S0_TP6_GPU6_expert1&#45;&gt;L4_S0_TP7_GPU7_moe_ar -->
<g id="edge1435" class="edge">
<title>L4_S0_TP6_GPU6_expert1&#45;&gt;L4_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M43810.04,-604.34C43810.04,-604.34 43810.04,-557.38 43810.04,-557.38"/>
<polygon fill="black" stroke="black" points="43813.54,-557.38 43810.04,-547.38 43806.54,-557.38 43813.54,-557.38"/>
</g>
<!-- L4_S0_TP7_GPU7_expert0 -->
<g id="node448" class="node">
<title>L4_S0_TP7_GPU7_expert0</title>
<polygon fill="none" stroke="black" points="44387.5,-672.5 43938.5,-672.5 43938.5,-604.5 44387.5,-604.5 44387.5,-672.5"/>
<text text-anchor="middle" x="44163" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="44163" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="44163" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="44163" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L4_S0_TP7_GPU7_expert0&#45;&gt;L4_S0_TP0_GPU0_moe_ar -->
<g id="edge1184" class="edge">
<title>L4_S0_TP7_GPU7_expert0&#45;&gt;L4_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M43994.62,-604.48C43994.62,-596.87 43994.62,-591 43994.62,-591 43994.62,-591 39010.92,-591 39010.92,-591 39010.92,-591 39010.92,-555.1 39010.92,-555.1"/>
<polygon fill="black" stroke="black" points="39014.42,-555.1 39010.92,-545.1 39007.42,-555.1 39014.42,-555.1"/>
</g>
<!-- L4_S0_TP7_GPU7_expert0&#45;&gt;L4_S0_TP1_GPU1_moe_ar -->
<g id="edge1220" class="edge">
<title>L4_S0_TP7_GPU7_expert0&#45;&gt;L4_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M44331.38,-604.35C44331.38,-548.8 44331.38,-445 44331.38,-445 44331.38,-445 39594.64,-445 39594.64,-445 39594.64,-445 39594.64,-470.06 39594.64,-470.06"/>
<polygon fill="black" stroke="black" points="39591.14,-470.06 39594.64,-480.06 39598.14,-470.06 39591.14,-470.06"/>
</g>
<!-- L4_S0_TP7_GPU7_expert0&#45;&gt;L4_S0_TP2_GPU2_moe_ar -->
<g id="edge1256" class="edge">
<title>L4_S0_TP7_GPU7_expert0&#45;&gt;L4_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M44275.25,-604.35C44275.25,-548.8 44275.25,-445 44275.25,-445 44275.25,-445 40300.38,-445 40300.38,-445 40300.38,-445 40300.38,-471.82 40300.38,-471.82"/>
<polygon fill="black" stroke="black" points="40296.88,-471.82 40300.38,-481.82 40303.88,-471.82 40296.88,-471.82"/>
</g>
<!-- L4_S0_TP7_GPU7_expert0&#45;&gt;L4_S0_TP3_GPU3_moe_ar -->
<g id="edge1292" class="edge">
<title>L4_S0_TP7_GPU7_expert0&#45;&gt;L4_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M44219.12,-604.08C44219.12,-548.71 44219.12,-446 44219.12,-446 44219.12,-446 41067.18,-446 41067.18,-446 41067.18,-446 41067.18,-484.81 41067.18,-484.81"/>
<polygon fill="black" stroke="black" points="41063.68,-484.81 41067.18,-494.81 41070.68,-484.81 41063.68,-484.81"/>
</g>
<!-- L4_S0_TP7_GPU7_expert0&#45;&gt;L4_S0_TP4_GPU4_moe_ar -->
<g id="edge1328" class="edge">
<title>L4_S0_TP7_GPU7_expert0&#45;&gt;L4_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M44145.14,-672.68C44145.14,-687.27 44145.14,-701 44145.14,-701 44145.14,-701 41594.5,-701 41594.5,-701 41594.5,-701 41594.5,-575.52 41594.5,-575.52"/>
<polygon fill="black" stroke="black" points="41598,-575.52 41594.5,-565.52 41591,-575.52 41598,-575.52"/>
</g>
<!-- L4_S0_TP7_GPU7_expert0&#45;&gt;L4_S0_TP5_GPU5_moe_ar -->
<g id="edge1364" class="edge">
<title>L4_S0_TP7_GPU7_expert0&#45;&gt;L4_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M44050.75,-604.29C44050.75,-596.26 44050.75,-590 44050.75,-590 44050.75,-590 42408.07,-590 42408.07,-590 42408.07,-590 42408.07,-562.36 42408.07,-562.36"/>
<polygon fill="black" stroke="black" points="42411.57,-562.36 42408.07,-552.36 42404.57,-562.36 42411.57,-562.36"/>
</g>
<!-- L4_S0_TP7_GPU7_expert0&#45;&gt;L4_S0_TP6_GPU6_moe_ar -->
<g id="edge1400" class="edge">
<title>L4_S0_TP7_GPU7_expert0&#45;&gt;L4_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M44106.88,-604.29C44106.88,-596.26 44106.88,-590 44106.88,-590 44106.88,-590 43135.72,-590 43135.72,-590 43135.72,-590 43135.72,-554.36 43135.72,-554.36"/>
<polygon fill="black" stroke="black" points="43139.22,-554.36 43135.72,-544.36 43132.22,-554.36 43139.22,-554.36"/>
</g>
<!-- L4_S0_TP7_GPU7_expert0&#45;&gt;L4_S0_TP7_GPU7_moe_ar -->
<g id="edge1436" class="edge">
<title>L4_S0_TP7_GPU7_expert0&#45;&gt;L4_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M44163,-604.21C44163,-567.05 44163,-513 44163,-513 44163,-513 43872.75,-513 43872.75,-513"/>
<polygon fill="black" stroke="black" points="43872.75,-509.5 43862.75,-513 43872.75,-516.5 43872.75,-509.5"/>
</g>
<!-- L4_S0_TP7_GPU7_expert1 -->
<g id="node449" class="node">
<title>L4_S0_TP7_GPU7_expert1</title>
<polygon fill="none" stroke="black" points="44854.5,-672.5 44405.5,-672.5 44405.5,-604.5 44854.5,-604.5 44854.5,-672.5"/>
<text text-anchor="middle" x="44630" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="44630" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="44630" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="44630" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L4_S0_TP7_GPU7_expert1&#45;&gt;L4_S0_TP0_GPU0_moe_ar -->
<g id="edge1185" class="edge">
<title>L4_S0_TP7_GPU7_expert1&#45;&gt;L4_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M44425.56,-604.48C44425.56,-596.87 44425.56,-591 44425.56,-591 44425.56,-591 39034.19,-591 39034.19,-591 39034.19,-591 39034.19,-548.23 39034.19,-548.23"/>
<polygon fill="black" stroke="black" points="39037.69,-548.23 39034.19,-538.23 39030.69,-548.23 39037.69,-548.23"/>
</g>
<!-- L4_S0_TP7_GPU7_expert1&#45;&gt;L4_S0_TP1_GPU1_moe_ar -->
<g id="edge1221" class="edge">
<title>L4_S0_TP7_GPU7_expert1&#45;&gt;L4_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M44565.94,-604.35C44565.94,-548.8 44565.94,-445 44565.94,-445 44565.94,-445 39444.82,-445 39444.82,-445 39444.82,-445 39444.82,-462.23 39444.82,-462.23"/>
<polygon fill="black" stroke="black" points="39441.32,-462.23 39444.82,-472.23 39448.32,-462.23 39441.32,-462.23"/>
</g>
<!-- L4_S0_TP7_GPU7_expert1&#45;&gt;L4_S0_TP2_GPU2_moe_ar -->
<g id="edge1257" class="edge">
<title>L4_S0_TP7_GPU7_expert1&#45;&gt;L4_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M44545.89,-604.35C44545.89,-548.8 44545.89,-445 44545.89,-445 44545.89,-445 40256.69,-445 40256.69,-445 40256.69,-445 40256.69,-467.86 40256.69,-467.86"/>
<polygon fill="black" stroke="black" points="40253.19,-467.86 40256.69,-477.86 40260.19,-467.86 40253.19,-467.86"/>
</g>
<!-- L4_S0_TP7_GPU7_expert1&#45;&gt;L4_S0_TP3_GPU3_moe_ar -->
<g id="edge1293" class="edge">
<title>L4_S0_TP7_GPU7_expert1&#45;&gt;L4_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M44525.83,-604.35C44525.83,-548.8 44525.83,-445 44525.83,-445 44525.83,-445 41050.09,-445 41050.09,-445 41050.09,-445 41050.09,-481.04 41050.09,-481.04"/>
<polygon fill="black" stroke="black" points="41046.59,-481.04 41050.09,-491.04 41053.59,-481.04 41046.59,-481.04"/>
</g>
<!-- L4_S0_TP7_GPU7_expert1&#45;&gt;L4_S0_TP4_GPU4_moe_ar -->
<g id="edge1329" class="edge">
<title>L4_S0_TP7_GPU7_expert1&#45;&gt;L4_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M44505.78,-604.2C44505.78,-555.2 44505.78,-471 44505.78,-471 44505.78,-471 41668.91,-471 41668.91,-471 41668.91,-471 41668.91,-472.05 41668.91,-472.05"/>
<polygon fill="black" stroke="black" points="41665.41,-471.48 41668.91,-481.48 41672.41,-471.48 41665.41,-471.48"/>
</g>
<!-- L4_S0_TP7_GPU7_expert1&#45;&gt;L4_S0_TP5_GPU5_moe_ar -->
<g id="edge1365" class="edge">
<title>L4_S0_TP7_GPU7_expert1&#45;&gt;L4_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M44445.61,-604.29C44445.61,-596.26 44445.61,-590 44445.61,-590 44445.61,-590 42450.27,-590 42450.27,-590 42450.27,-590 42450.27,-553.97 42450.27,-553.97"/>
<polygon fill="black" stroke="black" points="42453.77,-553.97 42450.27,-543.97 42446.77,-553.97 42453.77,-553.97"/>
</g>
<!-- L4_S0_TP7_GPU7_expert1&#45;&gt;L4_S0_TP6_GPU6_moe_ar -->
<g id="edge1401" class="edge">
<title>L4_S0_TP7_GPU7_expert1&#45;&gt;L4_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M44465.67,-604.29C44465.67,-596.26 44465.67,-590 44465.67,-590 44465.67,-590 43157.59,-590 43157.59,-590 43157.59,-590 43157.59,-547.62 43157.59,-547.62"/>
<polygon fill="black" stroke="black" points="43161.09,-547.62 43157.59,-537.62 43154.09,-547.62 43161.09,-547.62"/>
</g>
<!-- L4_S0_TP7_GPU7_expert1&#45;&gt;L4_S0_TP7_GPU7_moe_ar -->
<g id="edge1437" class="edge">
<title>L4_S0_TP7_GPU7_expert1&#45;&gt;L4_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M44485.72,-604.37C44485.72,-563.08 44485.72,-499 44485.72,-499 44485.72,-499 43841.47,-499 43841.47,-499"/>
<polygon fill="black" stroke="black" points="43841.47,-495.5 43831.47,-499 43841.47,-502.5 43841.47,-495.5"/>
</g>
<!-- L4_S0_TP0_GPU0_norm -->
<g id="node451" class="node">
<title>L4_S0_TP0_GPU0_norm</title>
<polygon fill="none" stroke="black" points="37464.5,-332.33 37015.5,-332.33 37015.5,-264.33 37464.5,-264.33 37464.5,-332.33"/>
<text text-anchor="middle" x="37240" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="37240" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="37240" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="37240" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP0_GPU0_moe_res&#45;&gt;L4_S0_TP0_GPU0_norm -->
<g id="edge1188" class="edge">
<title>L4_S0_TP0_GPU0_moe_res&#45;&gt;L4_S0_TP0_GPU0_norm</title>
<path fill="none" stroke="black" d="M37240,-368.28C37240,-368.28 37240,-342.46 37240,-342.46"/>
<polygon fill="black" stroke="black" points="37243.5,-342.46 37240,-332.46 37236.5,-342.46 37243.5,-342.46"/>
</g>
<!-- L4_S0_TP1_GPU1_qkv_linear -->
<g id="node452" class="node">
<title>L4_S0_TP1_GPU1_qkv_linear</title>
<polygon fill="none" stroke="black" points="38902,-1614.75 38294,-1614.75 38294,-1546.75 38902,-1546.75 38902,-1614.75"/>
<text text-anchor="middle" x="38598" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="38598" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="38598" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="38598" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L4_S0_TP1_GPU1_qkv_slice -->
<g id="node453" class="node">
<title>L4_S0_TP1_GPU1_qkv_slice</title>
<polygon fill="none" stroke="black" points="38896,-1496.67 38300,-1496.67 38300,-1428.67 38896,-1428.67 38896,-1496.67"/>
<text text-anchor="middle" x="38598" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="38598" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="38598" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="38598" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L4_S0_TP1_GPU1_qkv_linear&#45;&gt;L4_S0_TP1_GPU1_qkv_slice -->
<g id="edge1189" class="edge">
<title>L4_S0_TP1_GPU1_qkv_linear&#45;&gt;L4_S0_TP1_GPU1_qkv_slice</title>
<path fill="none" stroke="black" d="M38598,-1546.59C38598,-1546.59 38598,-1506.74 38598,-1506.74"/>
<polygon fill="black" stroke="black" points="38601.5,-1506.74 38598,-1496.74 38594.5,-1506.74 38601.5,-1506.74"/>
</g>
<!-- L4_S0_TP1_GPU1_qkv_slice&#45;&gt;L4_S0_TP1_GPU1_attn_v -->
<g id="edge1193" class="edge">
<title>L4_S0_TP1_GPU1_qkv_slice&#45;&gt;L4_S0_TP1_GPU1_attn_v</title>
<path fill="none" stroke="black" d="M38339.25,-1428.38C38339.25,-1428.38 38339.25,-1195 38339.25,-1195"/>
<polygon fill="black" stroke="black" points="38342.75,-1195 38339.25,-1185 38335.75,-1195 38342.75,-1195"/>
</g>
<!-- L4_S0_TP1_GPU1_qk_matmul -->
<g id="node454" class="node">
<title>L4_S0_TP1_GPU1_qk_matmul</title>
<polygon fill="none" stroke="black" points="39313.5,-1392.67 38378.5,-1392.67 38378.5,-1324.67 39313.5,-1324.67 39313.5,-1392.67"/>
<text text-anchor="middle" x="38846" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="38846" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="38846" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="38846" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L4_S0_TP1_GPU1_qkv_slice&#45;&gt;L4_S0_TP1_GPU1_qk_matmul -->
<g id="edge1190" class="edge">
<title>L4_S0_TP1_GPU1_qkv_slice&#45;&gt;L4_S0_TP1_GPU1_qk_matmul</title>
<path fill="none" stroke="black" d="M38637.25,-1428.61C38637.25,-1428.61 38637.25,-1402.8 38637.25,-1402.8"/>
<polygon fill="black" stroke="black" points="38640.75,-1402.8 38637.25,-1392.8 38633.75,-1402.8 38640.75,-1402.8"/>
</g>
<!-- L4_S0_TP1_GPU1_softmax -->
<g id="node455" class="node">
<title>L4_S0_TP1_GPU1_softmax</title>
<polygon fill="none" stroke="black" points="39057,-1288.67 38547,-1288.67 38547,-1220.67 39057,-1220.67 39057,-1288.67"/>
<text text-anchor="middle" x="38802" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="38802" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="38802" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="38802" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L4_S0_TP1_GPU1_qk_matmul&#45;&gt;L4_S0_TP1_GPU1_softmax -->
<g id="edge1191" class="edge">
<title>L4_S0_TP1_GPU1_qk_matmul&#45;&gt;L4_S0_TP1_GPU1_softmax</title>
<path fill="none" stroke="black" d="M38802,-1324.61C38802,-1324.61 38802,-1298.8 38802,-1298.8"/>
<polygon fill="black" stroke="black" points="38805.5,-1298.8 38802,-1288.8 38798.5,-1298.8 38805.5,-1298.8"/>
</g>
<!-- L4_S0_TP1_GPU1_softmax&#45;&gt;L4_S0_TP1_GPU1_attn_v -->
<g id="edge1192" class="edge">
<title>L4_S0_TP1_GPU1_softmax&#45;&gt;L4_S0_TP1_GPU1_attn_v</title>
<path fill="none" stroke="black" d="M38802,-1220.61C38802,-1220.61 38802,-1194.8 38802,-1194.8"/>
<polygon fill="black" stroke="black" points="38805.5,-1194.8 38802,-1184.8 38798.5,-1194.8 38805.5,-1194.8"/>
</g>
<!-- L4_S0_TP1_GPU1_mha_res -->
<g id="node457" class="node">
<title>L4_S0_TP1_GPU1_mha_res</title>
<polygon fill="none" stroke="black" points="38875.5,-948.5 37988.5,-948.5 37988.5,-880.5 38875.5,-880.5 38875.5,-948.5"/>
<text text-anchor="middle" x="38432" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="38432" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="38432" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="38432" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP1_GPU1_mha_ar&#45;&gt;L4_S0_TP1_GPU1_mha_res -->
<g id="edge1202" class="edge">
<title>L4_S0_TP1_GPU1_mha_ar&#45;&gt;L4_S0_TP1_GPU1_mha_res</title>
<path fill="none" stroke="black" d="M38852.51,-1015.91C38852.51,-1015.91 38852.51,-958.58 38852.51,-958.58"/>
<polygon fill="black" stroke="black" points="38856.01,-958.58 38852.51,-948.58 38849.01,-958.58 38856.01,-958.58"/>
</g>
<!-- L4_S0_TP1_GPU1_gate -->
<g id="node458" class="node">
<title>L4_S0_TP1_GPU1_gate</title>
<polygon fill="none" stroke="black" points="38961.56,-844.5 38119.15,-844.5 37902.44,-708.5 38744.85,-708.5 38961.56,-844.5"/>
<text text-anchor="middle" x="38432" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="38432" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="38432" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="38432" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L4_S0_TP1_GPU1_mha_res&#45;&gt;L4_S0_TP1_GPU1_gate -->
<g id="edge1203" class="edge">
<title>L4_S0_TP1_GPU1_mha_res&#45;&gt;L4_S0_TP1_GPU1_gate</title>
<path fill="none" stroke="black" d="M38432,-880.39C38432,-880.39 38432,-854.73 38432,-854.73"/>
<polygon fill="black" stroke="black" points="38435.5,-854.73 38432,-844.73 38428.5,-854.73 38435.5,-854.73"/>
</g>
<!-- L4_S0_TP1_GPU1_moe_res -->
<g id="node460" class="node">
<title>L4_S0_TP1_GPU1_moe_res</title>
<polygon fill="none" stroke="black" points="39130,-436.33 38310,-436.33 38310,-368.33 39130,-368.33 39130,-436.33"/>
<text text-anchor="middle" x="38720" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="38720" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="38720" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="38720" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP1_GPU1_mha_res&#45;&gt;L4_S0_TP1_GPU1_moe_res -->
<g id="edge1223" class="edge">
<title>L4_S0_TP1_GPU1_mha_res&#45;&gt;L4_S0_TP1_GPU1_moe_res</title>
<path fill="none" stroke="black" d="M37988.43,-914C37931.73,-914 37893,-914 37893,-914 37893,-914 37893,-683 37893,-683 37893,-683 38325.5,-683 38325.5,-683 38325.5,-683 38325.5,-446.47 38325.5,-446.47"/>
<polygon fill="black" stroke="black" points="38329,-446.47 38325.5,-436.47 38322,-446.47 38329,-446.47"/>
</g>
<!-- L4_S0_TP1_GPU1_gate&#45;&gt;L4_S0_TP1_GPU1_expert0 -->
<g id="edge1204" class="edge">
<title>L4_S0_TP1_GPU1_gate&#45;&gt;L4_S0_TP1_GPU1_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38559,-708.31C38559,-708.31 38559,-682.71 38559,-682.71"/>
<polygon fill="black" stroke="black" points="38562.5,-682.71 38559,-672.71 38555.5,-682.71 38562.5,-682.71"/>
</g>
<!-- L4_S0_TP1_GPU1_gate&#45;&gt;L4_S0_TP1_GPU1_expert1 -->
<g id="edge1205" class="edge">
<title>L4_S0_TP1_GPU1_gate&#45;&gt;L4_S0_TP1_GPU1_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38881.64,-776.4C38881.64,-776.4 38881.64,-682.74 38881.64,-682.74"/>
<polygon fill="black" stroke="black" points="38885.14,-682.74 38881.64,-672.74 38878.14,-682.74 38885.14,-682.74"/>
</g>
<!-- L4_S0_TP1_GPU1_moe_ar&#45;&gt;L4_S0_TP1_GPU1_moe_res -->
<g id="edge1222" class="edge">
<title>L4_S0_TP1_GPU1_moe_ar&#45;&gt;L4_S0_TP1_GPU1_moe_res</title>
<path fill="none" stroke="black" d="M39102.77,-501.18C39102.77,-501.18 39102.77,-446.35 39102.77,-446.35"/>
<polygon fill="black" stroke="black" points="39106.27,-446.35 39102.77,-436.35 39099.27,-446.35 39106.27,-446.35"/>
</g>
<!-- L4_S0_TP1_GPU1_norm -->
<g id="node461" class="node">
<title>L4_S0_TP1_GPU1_norm</title>
<polygon fill="none" stroke="black" points="38944.5,-332.33 38495.5,-332.33 38495.5,-264.33 38944.5,-264.33 38944.5,-332.33"/>
<text text-anchor="middle" x="38720" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="38720" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="38720" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="38720" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP1_GPU1_moe_res&#45;&gt;L4_S0_TP1_GPU1_norm -->
<g id="edge1224" class="edge">
<title>L4_S0_TP1_GPU1_moe_res&#45;&gt;L4_S0_TP1_GPU1_norm</title>
<path fill="none" stroke="black" d="M38720,-368.28C38720,-368.28 38720,-342.46 38720,-342.46"/>
<polygon fill="black" stroke="black" points="38723.5,-342.46 38720,-332.46 38716.5,-342.46 38723.5,-342.46"/>
</g>
<!-- L4_S0_TP2_GPU2_qkv_linear -->
<g id="node462" class="node">
<title>L4_S0_TP2_GPU2_qkv_linear</title>
<polygon fill="none" stroke="black" points="39908,-1614.75 39300,-1614.75 39300,-1546.75 39908,-1546.75 39908,-1614.75"/>
<text text-anchor="middle" x="39604" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="39604" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="39604" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="39604" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L4_S0_TP2_GPU2_qkv_slice -->
<g id="node463" class="node">
<title>L4_S0_TP2_GPU2_qkv_slice</title>
<polygon fill="none" stroke="black" points="39902,-1496.67 39306,-1496.67 39306,-1428.67 39902,-1428.67 39902,-1496.67"/>
<text text-anchor="middle" x="39604" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="39604" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="39604" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="39604" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L4_S0_TP2_GPU2_qkv_linear&#45;&gt;L4_S0_TP2_GPU2_qkv_slice -->
<g id="edge1225" class="edge">
<title>L4_S0_TP2_GPU2_qkv_linear&#45;&gt;L4_S0_TP2_GPU2_qkv_slice</title>
<path fill="none" stroke="black" d="M39604,-1546.59C39604,-1546.59 39604,-1506.74 39604,-1506.74"/>
<polygon fill="black" stroke="black" points="39607.5,-1506.74 39604,-1496.74 39600.5,-1506.74 39607.5,-1506.74"/>
</g>
<!-- L4_S0_TP2_GPU2_qkv_slice&#45;&gt;L4_S0_TP2_GPU2_attn_v -->
<g id="edge1229" class="edge">
<title>L4_S0_TP2_GPU2_qkv_slice&#45;&gt;L4_S0_TP2_GPU2_attn_v</title>
<path fill="none" stroke="black" d="M39349,-1428.38C39349,-1428.38 39349,-1195 39349,-1195"/>
<polygon fill="black" stroke="black" points="39352.5,-1195 39349,-1185 39345.5,-1195 39352.5,-1195"/>
</g>
<!-- L4_S0_TP2_GPU2_qk_matmul -->
<g id="node464" class="node">
<title>L4_S0_TP2_GPU2_qk_matmul</title>
<polygon fill="none" stroke="black" points="40319.5,-1392.67 39384.5,-1392.67 39384.5,-1324.67 40319.5,-1324.67 40319.5,-1392.67"/>
<text text-anchor="middle" x="39852" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="39852" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="39852" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="39852" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L4_S0_TP2_GPU2_qkv_slice&#45;&gt;L4_S0_TP2_GPU2_qk_matmul -->
<g id="edge1226" class="edge">
<title>L4_S0_TP2_GPU2_qkv_slice&#45;&gt;L4_S0_TP2_GPU2_qk_matmul</title>
<path fill="none" stroke="black" d="M39643.25,-1428.61C39643.25,-1428.61 39643.25,-1402.8 39643.25,-1402.8"/>
<polygon fill="black" stroke="black" points="39646.75,-1402.8 39643.25,-1392.8 39639.75,-1402.8 39646.75,-1402.8"/>
</g>
<!-- L4_S0_TP2_GPU2_softmax -->
<g id="node465" class="node">
<title>L4_S0_TP2_GPU2_softmax</title>
<polygon fill="none" stroke="black" points="40028,-1288.67 39518,-1288.67 39518,-1220.67 40028,-1220.67 40028,-1288.67"/>
<text text-anchor="middle" x="39773" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="39773" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="39773" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="39773" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L4_S0_TP2_GPU2_qk_matmul&#45;&gt;L4_S0_TP2_GPU2_softmax -->
<g id="edge1227" class="edge">
<title>L4_S0_TP2_GPU2_qk_matmul&#45;&gt;L4_S0_TP2_GPU2_softmax</title>
<path fill="none" stroke="black" d="M39773,-1324.61C39773,-1324.61 39773,-1298.8 39773,-1298.8"/>
<polygon fill="black" stroke="black" points="39776.5,-1298.8 39773,-1288.8 39769.5,-1298.8 39776.5,-1298.8"/>
</g>
<!-- L4_S0_TP2_GPU2_softmax&#45;&gt;L4_S0_TP2_GPU2_attn_v -->
<g id="edge1228" class="edge">
<title>L4_S0_TP2_GPU2_softmax&#45;&gt;L4_S0_TP2_GPU2_attn_v</title>
<path fill="none" stroke="black" d="M39773,-1220.61C39773,-1220.61 39773,-1194.8 39773,-1194.8"/>
<polygon fill="black" stroke="black" points="39776.5,-1194.8 39773,-1184.8 39769.5,-1194.8 39776.5,-1194.8"/>
</g>
<!-- L4_S0_TP2_GPU2_mha_res -->
<g id="node467" class="node">
<title>L4_S0_TP2_GPU2_mha_res</title>
<polygon fill="none" stroke="black" points="39953.5,-948.5 39066.5,-948.5 39066.5,-880.5 39953.5,-880.5 39953.5,-948.5"/>
<text text-anchor="middle" x="39510" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="39510" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="39510" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="39510" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP2_GPU2_mha_ar&#45;&gt;L4_S0_TP2_GPU2_mha_res -->
<g id="edge1238" class="edge">
<title>L4_S0_TP2_GPU2_mha_ar&#45;&gt;L4_S0_TP2_GPU2_mha_res</title>
<path fill="none" stroke="black" d="M39776.01,-991.61C39776.01,-991.61 39776.01,-958.74 39776.01,-958.74"/>
<polygon fill="black" stroke="black" points="39779.51,-958.74 39776.01,-948.74 39772.51,-958.74 39779.51,-958.74"/>
</g>
<!-- L4_S0_TP2_GPU2_gate -->
<g id="node468" class="node">
<title>L4_S0_TP2_GPU2_gate</title>
<polygon fill="none" stroke="black" points="40039.56,-844.5 39197.15,-844.5 38980.44,-708.5 39822.85,-708.5 40039.56,-844.5"/>
<text text-anchor="middle" x="39510" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="39510" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="39510" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="39510" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L4_S0_TP2_GPU2_mha_res&#45;&gt;L4_S0_TP2_GPU2_gate -->
<g id="edge1239" class="edge">
<title>L4_S0_TP2_GPU2_mha_res&#45;&gt;L4_S0_TP2_GPU2_gate</title>
<path fill="none" stroke="black" d="M39510,-880.39C39510,-880.39 39510,-854.73 39510,-854.73"/>
<polygon fill="black" stroke="black" points="39513.5,-854.73 39510,-844.73 39506.5,-854.73 39513.5,-854.73"/>
</g>
<!-- L4_S0_TP2_GPU2_moe_res -->
<g id="node470" class="node">
<title>L4_S0_TP2_GPU2_moe_res</title>
<polygon fill="none" stroke="black" points="40115,-436.33 39295,-436.33 39295,-368.33 40115,-368.33 40115,-436.33"/>
<text text-anchor="middle" x="39705" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="39705" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="39705" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="39705" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP2_GPU2_mha_res&#45;&gt;L4_S0_TP2_GPU2_moe_res -->
<g id="edge1259" class="edge">
<title>L4_S0_TP2_GPU2_mha_res&#45;&gt;L4_S0_TP2_GPU2_moe_res</title>
<path fill="none" stroke="black" d="M39953.57,-914C40010.27,-914 40049,-914 40049,-914 40049,-914 40049,-682 40049,-682 40049,-682 39727.79,-682 39727.79,-682 39727.79,-682 39727.79,-592 39727.79,-592 39727.79,-592 39756.51,-592 39756.51,-592 39756.51,-592 39756.51,-446.68 39756.51,-446.68"/>
<polygon fill="black" stroke="black" points="39760.01,-446.68 39756.51,-436.68 39753.01,-446.68 39760.01,-446.68"/>
</g>
<!-- L4_S0_TP2_GPU2_gate&#45;&gt;L4_S0_TP2_GPU2_expert0 -->
<g id="edge1240" class="edge">
<title>L4_S0_TP2_GPU2_gate&#45;&gt;L4_S0_TP2_GPU2_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39380.75,-708.31C39380.75,-708.31 39380.75,-682.71 39380.75,-682.71"/>
<polygon fill="black" stroke="black" points="39384.25,-682.71 39380.75,-672.71 39377.25,-682.71 39384.25,-682.71"/>
</g>
<!-- L4_S0_TP2_GPU2_gate&#45;&gt;L4_S0_TP2_GPU2_expert1 -->
<g id="edge1241" class="edge">
<title>L4_S0_TP2_GPU2_gate&#45;&gt;L4_S0_TP2_GPU2_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39887.64,-748.9C39887.64,-748.9 39887.64,-682.65 39887.64,-682.65"/>
<polygon fill="black" stroke="black" points="39891.14,-682.65 39887.64,-672.65 39884.14,-682.65 39891.14,-682.65"/>
</g>
<!-- L4_S0_TP2_GPU2_moe_ar&#45;&gt;L4_S0_TP2_GPU2_moe_res -->
<g id="edge1258" class="edge">
<title>L4_S0_TP2_GPU2_moe_ar&#45;&gt;L4_S0_TP2_GPU2_moe_res</title>
<path fill="none" stroke="black" d="M39997.51,-474.42C39997.51,-474.42 39997.51,-446.68 39997.51,-446.68"/>
<polygon fill="black" stroke="black" points="40001.01,-446.68 39997.51,-436.68 39994.01,-446.68 40001.01,-446.68"/>
</g>
<!-- L4_S0_TP2_GPU2_norm -->
<g id="node471" class="node">
<title>L4_S0_TP2_GPU2_norm</title>
<polygon fill="none" stroke="black" points="39929.5,-332.33 39480.5,-332.33 39480.5,-264.33 39929.5,-264.33 39929.5,-332.33"/>
<text text-anchor="middle" x="39705" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="39705" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="39705" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="39705" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP2_GPU2_moe_res&#45;&gt;L4_S0_TP2_GPU2_norm -->
<g id="edge1260" class="edge">
<title>L4_S0_TP2_GPU2_moe_res&#45;&gt;L4_S0_TP2_GPU2_norm</title>
<path fill="none" stroke="black" d="M39705,-368.28C39705,-368.28 39705,-342.46 39705,-342.46"/>
<polygon fill="black" stroke="black" points="39708.5,-342.46 39705,-332.46 39701.5,-342.46 39708.5,-342.46"/>
</g>
<!-- L4_S0_TP3_GPU3_qkv_linear -->
<g id="node472" class="node">
<title>L4_S0_TP3_GPU3_qkv_linear</title>
<polygon fill="none" stroke="black" points="40926,-1614.75 40318,-1614.75 40318,-1546.75 40926,-1546.75 40926,-1614.75"/>
<text text-anchor="middle" x="40622" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="40622" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="40622" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="40622" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L4_S0_TP3_GPU3_qkv_slice -->
<g id="node473" class="node">
<title>L4_S0_TP3_GPU3_qkv_slice</title>
<polygon fill="none" stroke="black" points="40920,-1496.67 40324,-1496.67 40324,-1428.67 40920,-1428.67 40920,-1496.67"/>
<text text-anchor="middle" x="40622" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="40622" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="40622" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="40622" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L4_S0_TP3_GPU3_qkv_linear&#45;&gt;L4_S0_TP3_GPU3_qkv_slice -->
<g id="edge1261" class="edge">
<title>L4_S0_TP3_GPU3_qkv_linear&#45;&gt;L4_S0_TP3_GPU3_qkv_slice</title>
<path fill="none" stroke="black" d="M40622,-1546.59C40622,-1546.59 40622,-1506.74 40622,-1506.74"/>
<polygon fill="black" stroke="black" points="40625.5,-1506.74 40622,-1496.74 40618.5,-1506.74 40625.5,-1506.74"/>
</g>
<!-- L4_S0_TP3_GPU3_qkv_slice&#45;&gt;L4_S0_TP3_GPU3_attn_v -->
<g id="edge1265" class="edge">
<title>L4_S0_TP3_GPU3_qkv_slice&#45;&gt;L4_S0_TP3_GPU3_attn_v</title>
<path fill="none" stroke="black" d="M40363.25,-1428.38C40363.25,-1428.38 40363.25,-1195 40363.25,-1195"/>
<polygon fill="black" stroke="black" points="40366.75,-1195 40363.25,-1185 40359.75,-1195 40366.75,-1195"/>
</g>
<!-- L4_S0_TP3_GPU3_qk_matmul -->
<g id="node474" class="node">
<title>L4_S0_TP3_GPU3_qk_matmul</title>
<polygon fill="none" stroke="black" points="41337.5,-1392.67 40402.5,-1392.67 40402.5,-1324.67 41337.5,-1324.67 41337.5,-1392.67"/>
<text text-anchor="middle" x="40870" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="40870" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="40870" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="40870" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L4_S0_TP3_GPU3_qkv_slice&#45;&gt;L4_S0_TP3_GPU3_qk_matmul -->
<g id="edge1262" class="edge">
<title>L4_S0_TP3_GPU3_qkv_slice&#45;&gt;L4_S0_TP3_GPU3_qk_matmul</title>
<path fill="none" stroke="black" d="M40661.25,-1428.61C40661.25,-1428.61 40661.25,-1402.8 40661.25,-1402.8"/>
<polygon fill="black" stroke="black" points="40664.75,-1402.8 40661.25,-1392.8 40657.75,-1402.8 40664.75,-1402.8"/>
</g>
<!-- L4_S0_TP3_GPU3_softmax -->
<g id="node475" class="node">
<title>L4_S0_TP3_GPU3_softmax</title>
<polygon fill="none" stroke="black" points="40915,-1288.67 40405,-1288.67 40405,-1220.67 40915,-1220.67 40915,-1288.67"/>
<text text-anchor="middle" x="40660" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="40660" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="40660" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="40660" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L4_S0_TP3_GPU3_qk_matmul&#45;&gt;L4_S0_TP3_GPU3_softmax -->
<g id="edge1263" class="edge">
<title>L4_S0_TP3_GPU3_qk_matmul&#45;&gt;L4_S0_TP3_GPU3_softmax</title>
<path fill="none" stroke="black" d="M40660,-1324.61C40660,-1324.61 40660,-1298.8 40660,-1298.8"/>
<polygon fill="black" stroke="black" points="40663.5,-1298.8 40660,-1288.8 40656.5,-1298.8 40663.5,-1298.8"/>
</g>
<!-- L4_S0_TP3_GPU3_softmax&#45;&gt;L4_S0_TP3_GPU3_attn_v -->
<g id="edge1264" class="edge">
<title>L4_S0_TP3_GPU3_softmax&#45;&gt;L4_S0_TP3_GPU3_attn_v</title>
<path fill="none" stroke="black" d="M40660,-1220.61C40660,-1220.61 40660,-1194.8 40660,-1194.8"/>
<polygon fill="black" stroke="black" points="40663.5,-1194.8 40660,-1184.8 40656.5,-1194.8 40663.5,-1194.8"/>
</g>
<!-- L4_S0_TP3_GPU3_mha_res -->
<g id="node477" class="node">
<title>L4_S0_TP3_GPU3_mha_res</title>
<polygon fill="none" stroke="black" points="41031.5,-948.5 40144.5,-948.5 40144.5,-880.5 41031.5,-880.5 41031.5,-948.5"/>
<text text-anchor="middle" x="40588" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="40588" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="40588" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="40588" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP3_GPU3_mha_ar&#45;&gt;L4_S0_TP3_GPU3_mha_res -->
<g id="edge1274" class="edge">
<title>L4_S0_TP3_GPU3_mha_ar&#45;&gt;L4_S0_TP3_GPU3_mha_res</title>
<path fill="none" stroke="black" d="M40699.51,-984.55C40699.51,-984.55 40699.51,-958.73 40699.51,-958.73"/>
<polygon fill="black" stroke="black" points="40703.01,-958.73 40699.51,-948.73 40696.01,-958.73 40703.01,-958.73"/>
</g>
<!-- L4_S0_TP3_GPU3_gate -->
<g id="node478" class="node">
<title>L4_S0_TP3_GPU3_gate</title>
<polygon fill="none" stroke="black" points="41117.56,-844.5 40275.15,-844.5 40058.44,-708.5 40900.85,-708.5 41117.56,-844.5"/>
<text text-anchor="middle" x="40588" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="40588" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="40588" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="40588" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L4_S0_TP3_GPU3_mha_res&#45;&gt;L4_S0_TP3_GPU3_gate -->
<g id="edge1275" class="edge">
<title>L4_S0_TP3_GPU3_mha_res&#45;&gt;L4_S0_TP3_GPU3_gate</title>
<path fill="none" stroke="black" d="M40588,-880.39C40588,-880.39 40588,-854.73 40588,-854.73"/>
<polygon fill="black" stroke="black" points="40591.5,-854.73 40588,-844.73 40584.5,-854.73 40591.5,-854.73"/>
</g>
<!-- L4_S0_TP3_GPU3_moe_res -->
<g id="node480" class="node">
<title>L4_S0_TP3_GPU3_moe_res</title>
<polygon fill="none" stroke="black" points="41033,-436.33 40213,-436.33 40213,-368.33 41033,-368.33 41033,-436.33"/>
<text text-anchor="middle" x="40623" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="40623" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="40623" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="40623" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP3_GPU3_mha_res&#45;&gt;L4_S0_TP3_GPU3_moe_res -->
<g id="edge1295" class="edge">
<title>L4_S0_TP3_GPU3_mha_res&#45;&gt;L4_S0_TP3_GPU3_moe_res</title>
<path fill="none" stroke="black" d="M41031.65,-903C41090.68,-903 41131.3,-903 41131.3,-903 41131.3,-903 41131.3,-390 41131.3,-390 41131.3,-390 41043.29,-390 41043.29,-390"/>
<polygon fill="black" stroke="black" points="41043.29,-386.5 41033.29,-390 41043.29,-393.5 41043.29,-386.5"/>
</g>
<!-- L4_S0_TP3_GPU3_gate&#45;&gt;L4_S0_TP3_GPU3_expert0 -->
<g id="edge1276" class="edge">
<title>L4_S0_TP3_GPU3_gate&#45;&gt;L4_S0_TP3_GPU3_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40352.17,-708.31C40352.17,-708.31 40352.17,-682.71 40352.17,-682.71"/>
<polygon fill="black" stroke="black" points="40355.67,-682.71 40352.17,-672.71 40348.67,-682.71 40355.67,-682.71"/>
</g>
<!-- L4_S0_TP3_GPU3_gate&#45;&gt;L4_S0_TP3_GPU3_expert1 -->
<g id="edge1277" class="edge">
<title>L4_S0_TP3_GPU3_gate&#45;&gt;L4_S0_TP3_GPU3_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40781.57,-708.31C40781.57,-708.31 40781.57,-682.71 40781.57,-682.71"/>
<polygon fill="black" stroke="black" points="40785.07,-682.71 40781.57,-672.71 40778.07,-682.71 40785.07,-682.71"/>
</g>
<!-- L4_S0_TP3_GPU3_moe_ar&#45;&gt;L4_S0_TP3_GPU3_moe_res -->
<g id="edge1294" class="edge">
<title>L4_S0_TP3_GPU3_moe_ar&#45;&gt;L4_S0_TP3_GPU3_moe_res</title>
<path fill="none" stroke="black" d="M40838.51,-472.73C40838.51,-472.73 40838.51,-446.41 40838.51,-446.41"/>
<polygon fill="black" stroke="black" points="40842.01,-446.41 40838.51,-436.41 40835.01,-446.41 40842.01,-446.41"/>
</g>
<!-- L4_S0_TP3_GPU3_norm -->
<g id="node481" class="node">
<title>L4_S0_TP3_GPU3_norm</title>
<polygon fill="none" stroke="black" points="40847.5,-332.33 40398.5,-332.33 40398.5,-264.33 40847.5,-264.33 40847.5,-332.33"/>
<text text-anchor="middle" x="40623" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="40623" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="40623" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="40623" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP3_GPU3_moe_res&#45;&gt;L4_S0_TP3_GPU3_norm -->
<g id="edge1296" class="edge">
<title>L4_S0_TP3_GPU3_moe_res&#45;&gt;L4_S0_TP3_GPU3_norm</title>
<path fill="none" stroke="black" d="M40623,-368.28C40623,-368.28 40623,-342.46 40623,-342.46"/>
<polygon fill="black" stroke="black" points="40626.5,-342.46 40623,-332.46 40619.5,-342.46 40626.5,-342.46"/>
</g>
<!-- L4_S0_TP4_GPU4_qkv_linear -->
<g id="node482" class="node">
<title>L4_S0_TP4_GPU4_qkv_linear</title>
<polygon fill="none" stroke="black" points="41987,-1614.75 41379,-1614.75 41379,-1546.75 41987,-1546.75 41987,-1614.75"/>
<text text-anchor="middle" x="41683" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="41683" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="41683" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="41683" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L4_S0_TP4_GPU4_qkv_slice -->
<g id="node483" class="node">
<title>L4_S0_TP4_GPU4_qkv_slice</title>
<polygon fill="none" stroke="black" points="41981,-1496.67 41385,-1496.67 41385,-1428.67 41981,-1428.67 41981,-1496.67"/>
<text text-anchor="middle" x="41683" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="41683" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="41683" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="41683" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L4_S0_TP4_GPU4_qkv_linear&#45;&gt;L4_S0_TP4_GPU4_qkv_slice -->
<g id="edge1297" class="edge">
<title>L4_S0_TP4_GPU4_qkv_linear&#45;&gt;L4_S0_TP4_GPU4_qkv_slice</title>
<path fill="none" stroke="black" d="M41683,-1546.59C41683,-1546.59 41683,-1506.74 41683,-1506.74"/>
<polygon fill="black" stroke="black" points="41686.5,-1506.74 41683,-1496.74 41679.5,-1506.74 41686.5,-1506.74"/>
</g>
<!-- L4_S0_TP4_GPU4_qkv_slice&#45;&gt;L4_S0_TP4_GPU4_attn_v -->
<g id="edge1301" class="edge">
<title>L4_S0_TP4_GPU4_qkv_slice&#45;&gt;L4_S0_TP4_GPU4_attn_v</title>
<path fill="none" stroke="black" d="M41424.25,-1428.38C41424.25,-1428.38 41424.25,-1195 41424.25,-1195"/>
<polygon fill="black" stroke="black" points="41427.75,-1195 41424.25,-1185 41420.75,-1195 41427.75,-1195"/>
</g>
<!-- L4_S0_TP4_GPU4_qk_matmul -->
<g id="node484" class="node">
<title>L4_S0_TP4_GPU4_qk_matmul</title>
<polygon fill="none" stroke="black" points="42398.5,-1392.67 41463.5,-1392.67 41463.5,-1324.67 42398.5,-1324.67 42398.5,-1392.67"/>
<text text-anchor="middle" x="41931" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="41931" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="41931" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="41931" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L4_S0_TP4_GPU4_qkv_slice&#45;&gt;L4_S0_TP4_GPU4_qk_matmul -->
<g id="edge1298" class="edge">
<title>L4_S0_TP4_GPU4_qkv_slice&#45;&gt;L4_S0_TP4_GPU4_qk_matmul</title>
<path fill="none" stroke="black" d="M41722.25,-1428.61C41722.25,-1428.61 41722.25,-1402.8 41722.25,-1402.8"/>
<polygon fill="black" stroke="black" points="41725.75,-1402.8 41722.25,-1392.8 41718.75,-1402.8 41725.75,-1402.8"/>
</g>
<!-- L4_S0_TP4_GPU4_softmax -->
<g id="node485" class="node">
<title>L4_S0_TP4_GPU4_softmax</title>
<polygon fill="none" stroke="black" points="42079,-1288.67 41569,-1288.67 41569,-1220.67 42079,-1220.67 42079,-1288.67"/>
<text text-anchor="middle" x="41824" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="41824" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="41824" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="41824" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L4_S0_TP4_GPU4_qk_matmul&#45;&gt;L4_S0_TP4_GPU4_softmax -->
<g id="edge1299" class="edge">
<title>L4_S0_TP4_GPU4_qk_matmul&#45;&gt;L4_S0_TP4_GPU4_softmax</title>
<path fill="none" stroke="black" d="M41824,-1324.61C41824,-1324.61 41824,-1298.8 41824,-1298.8"/>
<polygon fill="black" stroke="black" points="41827.5,-1298.8 41824,-1288.8 41820.5,-1298.8 41827.5,-1298.8"/>
</g>
<!-- L4_S0_TP4_GPU4_softmax&#45;&gt;L4_S0_TP4_GPU4_attn_v -->
<g id="edge1300" class="edge">
<title>L4_S0_TP4_GPU4_softmax&#45;&gt;L4_S0_TP4_GPU4_attn_v</title>
<path fill="none" stroke="black" d="M41822,-1220.61C41822,-1220.61 41822,-1194.8 41822,-1194.8"/>
<polygon fill="black" stroke="black" points="41825.5,-1194.8 41822,-1184.8 41818.5,-1194.8 41825.5,-1194.8"/>
</g>
<!-- L4_S0_TP4_GPU4_mha_res -->
<g id="node487" class="node">
<title>L4_S0_TP4_GPU4_mha_res</title>
<polygon fill="none" stroke="black" points="42109.5,-948.5 41222.5,-948.5 41222.5,-880.5 42109.5,-880.5 42109.5,-948.5"/>
<text text-anchor="middle" x="41666" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="41666" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="41666" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="41666" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP4_GPU4_mha_ar&#45;&gt;L4_S0_TP4_GPU4_mha_res -->
<g id="edge1310" class="edge">
<title>L4_S0_TP4_GPU4_mha_ar&#45;&gt;L4_S0_TP4_GPU4_mha_res</title>
<path fill="none" stroke="black" d="M41554.99,-984.55C41554.99,-984.55 41554.99,-958.73 41554.99,-958.73"/>
<polygon fill="black" stroke="black" points="41558.49,-958.73 41554.99,-948.73 41551.49,-958.73 41558.49,-958.73"/>
</g>
<!-- L4_S0_TP4_GPU4_gate -->
<g id="node488" class="node">
<title>L4_S0_TP4_GPU4_gate</title>
<polygon fill="none" stroke="black" points="42195.56,-844.5 41353.15,-844.5 41136.44,-708.5 41978.85,-708.5 42195.56,-844.5"/>
<text text-anchor="middle" x="41666" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="41666" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="41666" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="41666" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L4_S0_TP4_GPU4_mha_res&#45;&gt;L4_S0_TP4_GPU4_gate -->
<g id="edge1311" class="edge">
<title>L4_S0_TP4_GPU4_mha_res&#45;&gt;L4_S0_TP4_GPU4_gate</title>
<path fill="none" stroke="black" d="M41666,-880.39C41666,-880.39 41666,-854.73 41666,-854.73"/>
<polygon fill="black" stroke="black" points="41669.5,-854.73 41666,-844.73 41662.5,-854.73 41669.5,-854.73"/>
</g>
<!-- L4_S0_TP4_GPU4_moe_res -->
<g id="node490" class="node">
<title>L4_S0_TP4_GPU4_moe_res</title>
<polygon fill="none" stroke="black" points="42622,-436.33 41802,-436.33 41802,-368.33 42622,-368.33 42622,-436.33"/>
<text text-anchor="middle" x="42212" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="42212" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="42212" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="42212" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP4_GPU4_mha_res&#45;&gt;L4_S0_TP4_GPU4_moe_res -->
<g id="edge1331" class="edge">
<title>L4_S0_TP4_GPU4_mha_res&#45;&gt;L4_S0_TP4_GPU4_moe_res</title>
<path fill="none" stroke="black" d="M41222.25,-925C41169.4,-925 41133.76,-925 41133.76,-925 41133.76,-925 41133.76,-413 41133.76,-413 41133.76,-413 41791.67,-413 41791.67,-413"/>
<polygon fill="black" stroke="black" points="41791.67,-416.5 41801.67,-413 41791.67,-409.5 41791.67,-416.5"/>
</g>
<!-- L4_S0_TP4_GPU4_gate&#45;&gt;L4_S0_TP4_GPU4_expert0 -->
<g id="edge1312" class="edge">
<title>L4_S0_TP4_GPU4_gate&#45;&gt;L4_S0_TP4_GPU4_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M41473.25,-708.31C41473.25,-708.31 41473.25,-682.71 41473.25,-682.71"/>
<polygon fill="black" stroke="black" points="41476.75,-682.71 41473.25,-672.71 41469.75,-682.71 41476.75,-682.71"/>
</g>
<!-- L4_S0_TP4_GPU4_gate&#45;&gt;L4_S0_TP4_GPU4_expert1 -->
<g id="edge1313" class="edge">
<title>L4_S0_TP4_GPU4_gate&#45;&gt;L4_S0_TP4_GPU4_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M41940.25,-708.31C41940.25,-708.31 41940.25,-682.71 41940.25,-682.71"/>
<polygon fill="black" stroke="black" points="41943.75,-682.71 41940.25,-672.71 41936.75,-682.71 41943.75,-682.71"/>
</g>
<!-- L4_S0_TP4_GPU4_moe_ar&#45;&gt;L4_S0_TP4_GPU4_moe_res -->
<g id="edge1330" class="edge">
<title>L4_S0_TP4_GPU4_moe_ar&#45;&gt;L4_S0_TP4_GPU4_moe_res</title>
<path fill="none" stroke="black" d="M41805.66,-520C41811.35,-520 41814.5,-520 41814.5,-520 41814.5,-520 41814.5,-446.37 41814.5,-446.37"/>
<polygon fill="black" stroke="black" points="41818,-446.37 41814.5,-436.37 41811,-446.37 41818,-446.37"/>
</g>
<!-- L4_S0_TP4_GPU4_norm -->
<g id="node491" class="node">
<title>L4_S0_TP4_GPU4_norm</title>
<polygon fill="none" stroke="black" points="42436.5,-332.33 41987.5,-332.33 41987.5,-264.33 42436.5,-264.33 42436.5,-332.33"/>
<text text-anchor="middle" x="42212" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="42212" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="42212" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="42212" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP4_GPU4_moe_res&#45;&gt;L4_S0_TP4_GPU4_norm -->
<g id="edge1332" class="edge">
<title>L4_S0_TP4_GPU4_moe_res&#45;&gt;L4_S0_TP4_GPU4_norm</title>
<path fill="none" stroke="black" d="M42212,-368.28C42212,-368.28 42212,-342.46 42212,-342.46"/>
<polygon fill="black" stroke="black" points="42215.5,-342.46 42212,-332.46 42208.5,-342.46 42215.5,-342.46"/>
</g>
<!-- L4_S0_TP5_GPU5_qkv_linear -->
<g id="node492" class="node">
<title>L4_S0_TP5_GPU5_qkv_linear</title>
<polygon fill="none" stroke="black" points="42985,-1614.75 42377,-1614.75 42377,-1546.75 42985,-1546.75 42985,-1614.75"/>
<text text-anchor="middle" x="42681" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="42681" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="42681" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="42681" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L4_S0_TP5_GPU5_qkv_slice -->
<g id="node493" class="node">
<title>L4_S0_TP5_GPU5_qkv_slice</title>
<polygon fill="none" stroke="black" points="42979,-1496.67 42383,-1496.67 42383,-1428.67 42979,-1428.67 42979,-1496.67"/>
<text text-anchor="middle" x="42681" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="42681" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="42681" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="42681" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L4_S0_TP5_GPU5_qkv_linear&#45;&gt;L4_S0_TP5_GPU5_qkv_slice -->
<g id="edge1333" class="edge">
<title>L4_S0_TP5_GPU5_qkv_linear&#45;&gt;L4_S0_TP5_GPU5_qkv_slice</title>
<path fill="none" stroke="black" d="M42681,-1546.59C42681,-1546.59 42681,-1506.74 42681,-1506.74"/>
<polygon fill="black" stroke="black" points="42684.5,-1506.74 42681,-1496.74 42677.5,-1506.74 42684.5,-1506.74"/>
</g>
<!-- L4_S0_TP5_GPU5_qkv_slice&#45;&gt;L4_S0_TP5_GPU5_attn_v -->
<g id="edge1337" class="edge">
<title>L4_S0_TP5_GPU5_qkv_slice&#45;&gt;L4_S0_TP5_GPU5_attn_v</title>
<path fill="none" stroke="black" d="M42430,-1428.38C42430,-1428.38 42430,-1195 42430,-1195"/>
<polygon fill="black" stroke="black" points="42433.5,-1195 42430,-1185 42426.5,-1195 42433.5,-1195"/>
</g>
<!-- L4_S0_TP5_GPU5_qk_matmul -->
<g id="node494" class="node">
<title>L4_S0_TP5_GPU5_qk_matmul</title>
<polygon fill="none" stroke="black" points="43396.5,-1392.67 42461.5,-1392.67 42461.5,-1324.67 43396.5,-1324.67 43396.5,-1392.67"/>
<text text-anchor="middle" x="42929" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="42929" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="42929" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="42929" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L4_S0_TP5_GPU5_qkv_slice&#45;&gt;L4_S0_TP5_GPU5_qk_matmul -->
<g id="edge1334" class="edge">
<title>L4_S0_TP5_GPU5_qkv_slice&#45;&gt;L4_S0_TP5_GPU5_qk_matmul</title>
<path fill="none" stroke="black" d="M42720.25,-1428.61C42720.25,-1428.61 42720.25,-1402.8 42720.25,-1402.8"/>
<polygon fill="black" stroke="black" points="42723.75,-1402.8 42720.25,-1392.8 42716.75,-1402.8 42723.75,-1402.8"/>
</g>
<!-- L4_S0_TP5_GPU5_softmax -->
<g id="node495" class="node">
<title>L4_S0_TP5_GPU5_softmax</title>
<polygon fill="none" stroke="black" points="43077,-1288.67 42567,-1288.67 42567,-1220.67 43077,-1220.67 43077,-1288.67"/>
<text text-anchor="middle" x="42822" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="42822" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="42822" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="42822" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L4_S0_TP5_GPU5_qk_matmul&#45;&gt;L4_S0_TP5_GPU5_softmax -->
<g id="edge1335" class="edge">
<title>L4_S0_TP5_GPU5_qk_matmul&#45;&gt;L4_S0_TP5_GPU5_softmax</title>
<path fill="none" stroke="black" d="M42822,-1324.61C42822,-1324.61 42822,-1298.8 42822,-1298.8"/>
<polygon fill="black" stroke="black" points="42825.5,-1298.8 42822,-1288.8 42818.5,-1298.8 42825.5,-1298.8"/>
</g>
<!-- L4_S0_TP5_GPU5_softmax&#45;&gt;L4_S0_TP5_GPU5_attn_v -->
<g id="edge1336" class="edge">
<title>L4_S0_TP5_GPU5_softmax&#45;&gt;L4_S0_TP5_GPU5_attn_v</title>
<path fill="none" stroke="black" d="M42799,-1220.61C42799,-1220.61 42799,-1194.8 42799,-1194.8"/>
<polygon fill="black" stroke="black" points="42802.5,-1194.8 42799,-1184.8 42795.5,-1194.8 42802.5,-1194.8"/>
</g>
<!-- L4_S0_TP5_GPU5_mha_res -->
<g id="node497" class="node">
<title>L4_S0_TP5_GPU5_mha_res</title>
<polygon fill="none" stroke="black" points="43187.5,-948.5 42300.5,-948.5 42300.5,-880.5 43187.5,-880.5 43187.5,-948.5"/>
<text text-anchor="middle" x="42744" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="42744" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="42744" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="42744" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP5_GPU5_mha_ar&#45;&gt;L4_S0_TP5_GPU5_mha_res -->
<g id="edge1346" class="edge">
<title>L4_S0_TP5_GPU5_mha_ar&#45;&gt;L4_S0_TP5_GPU5_mha_res</title>
<path fill="none" stroke="black" d="M42478.49,-991.61C42478.49,-991.61 42478.49,-958.74 42478.49,-958.74"/>
<polygon fill="black" stroke="black" points="42481.99,-958.74 42478.49,-948.74 42474.99,-958.74 42481.99,-958.74"/>
</g>
<!-- L4_S0_TP5_GPU5_gate -->
<g id="node498" class="node">
<title>L4_S0_TP5_GPU5_gate</title>
<polygon fill="none" stroke="black" points="43273.56,-844.5 42431.15,-844.5 42214.44,-708.5 43056.85,-708.5 43273.56,-844.5"/>
<text text-anchor="middle" x="42744" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="42744" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="42744" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="42744" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L4_S0_TP5_GPU5_mha_res&#45;&gt;L4_S0_TP5_GPU5_gate -->
<g id="edge1347" class="edge">
<title>L4_S0_TP5_GPU5_mha_res&#45;&gt;L4_S0_TP5_GPU5_gate</title>
<path fill="none" stroke="black" d="M42744,-880.39C42744,-880.39 42744,-854.73 42744,-854.73"/>
<polygon fill="black" stroke="black" points="42747.5,-854.73 42744,-844.73 42740.5,-854.73 42747.5,-854.73"/>
</g>
<!-- L4_S0_TP5_GPU5_moe_res -->
<g id="node500" class="node">
<title>L4_S0_TP5_GPU5_moe_res</title>
<polygon fill="none" stroke="black" points="43560,-436.33 42740,-436.33 42740,-368.33 43560,-368.33 43560,-436.33"/>
<text text-anchor="middle" x="43150" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="43150" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="43150" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="43150" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP5_GPU5_mha_res&#45;&gt;L4_S0_TP5_GPU5_moe_res -->
<g id="edge1367" class="edge">
<title>L4_S0_TP5_GPU5_mha_res&#45;&gt;L4_S0_TP5_GPU5_moe_res</title>
<path fill="none" stroke="black" d="M43187.57,-914C43244.27,-914 43283,-914 43283,-914 43283,-914 43283,-687 43283,-687 43283,-687 43457.1,-687 43457.1,-687 43457.1,-687 43457.1,-591 43457.1,-591 43457.1,-591 43193.02,-591 43193.02,-591 43193.02,-591 43193.02,-446.5 43193.02,-446.5"/>
<polygon fill="black" stroke="black" points="43196.52,-446.5 43193.02,-436.5 43189.52,-446.5 43196.52,-446.5"/>
</g>
<!-- L4_S0_TP5_GPU5_gate&#45;&gt;L4_S0_TP5_GPU5_expert0 -->
<g id="edge1348" class="edge">
<title>L4_S0_TP5_GPU5_gate&#45;&gt;L4_S0_TP5_GPU5_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42366.86,-708.31C42366.86,-708.31 42366.86,-682.71 42366.86,-682.71"/>
<polygon fill="black" stroke="black" points="42370.36,-682.71 42366.86,-672.71 42363.36,-682.71 42370.36,-682.71"/>
</g>
<!-- L4_S0_TP5_GPU5_gate&#45;&gt;L4_S0_TP5_GPU5_expert1 -->
<g id="edge1349" class="edge">
<title>L4_S0_TP5_GPU5_gate&#45;&gt;L4_S0_TP5_GPU5_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42874.25,-708.31C42874.25,-708.31 42874.25,-682.71 42874.25,-682.71"/>
<polygon fill="black" stroke="black" points="42877.75,-682.71 42874.25,-672.71 42870.75,-682.71 42877.75,-682.71"/>
</g>
<!-- L4_S0_TP5_GPU5_moe_ar&#45;&gt;L4_S0_TP5_GPU5_moe_res -->
<g id="edge1366" class="edge">
<title>L4_S0_TP5_GPU5_moe_ar&#45;&gt;L4_S0_TP5_GPU5_moe_res</title>
<path fill="none" stroke="black" d="M42358.68,-481.67C42358.68,-459.48 42358.68,-436 42358.68,-436 42358.68,-436 42729.81,-436 42729.81,-436"/>
<polygon fill="black" stroke="black" points="42729.81,-439.5 42739.81,-436 42729.81,-432.5 42729.81,-439.5"/>
</g>
<!-- L4_S0_TP5_GPU5_norm -->
<g id="node501" class="node">
<title>L4_S0_TP5_GPU5_norm</title>
<polygon fill="none" stroke="black" points="43374.5,-332.33 42925.5,-332.33 42925.5,-264.33 43374.5,-264.33 43374.5,-332.33"/>
<text text-anchor="middle" x="43150" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="43150" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="43150" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="43150" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP5_GPU5_moe_res&#45;&gt;L4_S0_TP5_GPU5_norm -->
<g id="edge1368" class="edge">
<title>L4_S0_TP5_GPU5_moe_res&#45;&gt;L4_S0_TP5_GPU5_norm</title>
<path fill="none" stroke="black" d="M43150,-368.28C43150,-368.28 43150,-342.46 43150,-342.46"/>
<polygon fill="black" stroke="black" points="43153.5,-342.46 43150,-332.46 43146.5,-342.46 43153.5,-342.46"/>
</g>
<!-- L4_S0_TP6_GPU6_qkv_linear -->
<g id="node502" class="node">
<title>L4_S0_TP6_GPU6_qkv_linear</title>
<polygon fill="none" stroke="black" points="44012,-1614.75 43404,-1614.75 43404,-1546.75 44012,-1546.75 44012,-1614.75"/>
<text text-anchor="middle" x="43708" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="43708" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="43708" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="43708" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L4_S0_TP6_GPU6_qkv_slice -->
<g id="node503" class="node">
<title>L4_S0_TP6_GPU6_qkv_slice</title>
<polygon fill="none" stroke="black" points="44006,-1496.67 43410,-1496.67 43410,-1428.67 44006,-1428.67 44006,-1496.67"/>
<text text-anchor="middle" x="43708" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="43708" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="43708" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="43708" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L4_S0_TP6_GPU6_qkv_linear&#45;&gt;L4_S0_TP6_GPU6_qkv_slice -->
<g id="edge1369" class="edge">
<title>L4_S0_TP6_GPU6_qkv_linear&#45;&gt;L4_S0_TP6_GPU6_qkv_slice</title>
<path fill="none" stroke="black" d="M43708,-1546.59C43708,-1546.59 43708,-1506.74 43708,-1506.74"/>
<polygon fill="black" stroke="black" points="43711.5,-1506.74 43708,-1496.74 43704.5,-1506.74 43711.5,-1506.74"/>
</g>
<!-- L4_S0_TP6_GPU6_qkv_slice&#45;&gt;L4_S0_TP6_GPU6_attn_v -->
<g id="edge1373" class="edge">
<title>L4_S0_TP6_GPU6_qkv_slice&#45;&gt;L4_S0_TP6_GPU6_attn_v</title>
<path fill="none" stroke="black" d="M43449.25,-1428.38C43449.25,-1428.38 43449.25,-1195 43449.25,-1195"/>
<polygon fill="black" stroke="black" points="43452.75,-1195 43449.25,-1185 43445.75,-1195 43452.75,-1195"/>
</g>
<!-- L4_S0_TP6_GPU6_qk_matmul -->
<g id="node504" class="node">
<title>L4_S0_TP6_GPU6_qk_matmul</title>
<polygon fill="none" stroke="black" points="44423.5,-1392.67 43488.5,-1392.67 43488.5,-1324.67 44423.5,-1324.67 44423.5,-1392.67"/>
<text text-anchor="middle" x="43956" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="43956" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="43956" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="43956" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L4_S0_TP6_GPU6_qkv_slice&#45;&gt;L4_S0_TP6_GPU6_qk_matmul -->
<g id="edge1370" class="edge">
<title>L4_S0_TP6_GPU6_qkv_slice&#45;&gt;L4_S0_TP6_GPU6_qk_matmul</title>
<path fill="none" stroke="black" d="M43747.25,-1428.61C43747.25,-1428.61 43747.25,-1402.8 43747.25,-1402.8"/>
<polygon fill="black" stroke="black" points="43750.75,-1402.8 43747.25,-1392.8 43743.75,-1402.8 43750.75,-1402.8"/>
</g>
<!-- L4_S0_TP6_GPU6_softmax -->
<g id="node505" class="node">
<title>L4_S0_TP6_GPU6_softmax</title>
<polygon fill="none" stroke="black" points="44104,-1288.67 43594,-1288.67 43594,-1220.67 44104,-1220.67 44104,-1288.67"/>
<text text-anchor="middle" x="43849" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="43849" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="43849" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="43849" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L4_S0_TP6_GPU6_qk_matmul&#45;&gt;L4_S0_TP6_GPU6_softmax -->
<g id="edge1371" class="edge">
<title>L4_S0_TP6_GPU6_qk_matmul&#45;&gt;L4_S0_TP6_GPU6_softmax</title>
<path fill="none" stroke="black" d="M43849,-1324.61C43849,-1324.61 43849,-1298.8 43849,-1298.8"/>
<polygon fill="black" stroke="black" points="43852.5,-1298.8 43849,-1288.8 43845.5,-1298.8 43852.5,-1298.8"/>
</g>
<!-- L4_S0_TP6_GPU6_softmax&#45;&gt;L4_S0_TP6_GPU6_attn_v -->
<g id="edge1372" class="edge">
<title>L4_S0_TP6_GPU6_softmax&#45;&gt;L4_S0_TP6_GPU6_attn_v</title>
<path fill="none" stroke="black" d="M43790.5,-1220.61C43790.5,-1220.61 43790.5,-1194.8 43790.5,-1194.8"/>
<polygon fill="black" stroke="black" points="43794,-1194.8 43790.5,-1184.8 43787,-1194.8 43794,-1194.8"/>
</g>
<!-- L4_S0_TP6_GPU6_mha_res -->
<g id="node507" class="node">
<title>L4_S0_TP6_GPU6_mha_res</title>
<polygon fill="none" stroke="black" points="44265.5,-948.5 43378.5,-948.5 43378.5,-880.5 44265.5,-880.5 44265.5,-948.5"/>
<text text-anchor="middle" x="43822" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="43822" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="43822" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="43822" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP6_GPU6_mha_ar&#45;&gt;L4_S0_TP6_GPU6_mha_res -->
<g id="edge1382" class="edge">
<title>L4_S0_TP6_GPU6_mha_ar&#45;&gt;L4_S0_TP6_GPU6_mha_res</title>
<path fill="none" stroke="black" d="M43401.99,-1015.66C43401.99,-1015.66 43401.99,-958.91 43401.99,-958.91"/>
<polygon fill="black" stroke="black" points="43405.49,-958.91 43401.99,-948.91 43398.49,-958.91 43405.49,-958.91"/>
</g>
<!-- L4_S0_TP6_GPU6_gate -->
<g id="node508" class="node">
<title>L4_S0_TP6_GPU6_gate</title>
<polygon fill="none" stroke="black" points="44351.56,-844.5 43509.15,-844.5 43292.44,-708.5 44134.85,-708.5 44351.56,-844.5"/>
<text text-anchor="middle" x="43822" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="43822" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="43822" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="43822" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L4_S0_TP6_GPU6_mha_res&#45;&gt;L4_S0_TP6_GPU6_gate -->
<g id="edge1383" class="edge">
<title>L4_S0_TP6_GPU6_mha_res&#45;&gt;L4_S0_TP6_GPU6_gate</title>
<path fill="none" stroke="black" d="M43822,-880.39C43822,-880.39 43822,-854.73 43822,-854.73"/>
<polygon fill="black" stroke="black" points="43825.5,-854.73 43822,-844.73 43818.5,-854.73 43825.5,-854.73"/>
</g>
<!-- L4_S0_TP6_GPU6_moe_res -->
<g id="node510" class="node">
<title>L4_S0_TP6_GPU6_moe_res</title>
<polygon fill="none" stroke="black" points="44586,-436.33 43766,-436.33 43766,-368.33 44586,-368.33 44586,-436.33"/>
<text text-anchor="middle" x="44176" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="44176" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="44176" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="44176" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP6_GPU6_mha_res&#45;&gt;L4_S0_TP6_GPU6_moe_res -->
<g id="edge1403" class="edge">
<title>L4_S0_TP6_GPU6_mha_res&#45;&gt;L4_S0_TP6_GPU6_moe_res</title>
<path fill="none" stroke="black" d="M44265.57,-914C44322.27,-914 44361,-914 44361,-914 44361,-914 44361,-683 44361,-683 44361,-683 44396.5,-683 44396.5,-683 44396.5,-683 44396.5,-446.47 44396.5,-446.47"/>
<polygon fill="black" stroke="black" points="44400,-446.47 44396.5,-436.47 44393,-446.47 44400,-446.47"/>
</g>
<!-- L4_S0_TP6_GPU6_gate&#45;&gt;L4_S0_TP6_GPU6_expert0 -->
<g id="edge1384" class="edge">
<title>L4_S0_TP6_GPU6_gate&#45;&gt;L4_S0_TP6_GPU6_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43372.86,-708.31C43372.86,-708.31 43372.86,-682.71 43372.86,-682.71"/>
<polygon fill="black" stroke="black" points="43376.36,-682.71 43372.86,-672.71 43369.36,-682.71 43376.36,-682.71"/>
</g>
<!-- L4_S0_TP6_GPU6_gate&#45;&gt;L4_S0_TP6_GPU6_expert1 -->
<g id="edge1385" class="edge">
<title>L4_S0_TP6_GPU6_gate&#45;&gt;L4_S0_TP6_GPU6_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43696,-708.31C43696,-708.31 43696,-682.71 43696,-682.71"/>
<polygon fill="black" stroke="black" points="43699.5,-682.71 43696,-672.71 43692.5,-682.71 43699.5,-682.71"/>
</g>
<!-- L4_S0_TP6_GPU6_moe_ar&#45;&gt;L4_S0_TP6_GPU6_moe_res -->
<g id="edge1402" class="edge">
<title>L4_S0_TP6_GPU6_moe_ar&#45;&gt;L4_S0_TP6_GPU6_moe_res</title>
<path fill="none" stroke="black" d="M43032.97,-480.17C43032.97,-458.84 43032.97,-437 43032.97,-437 43032.97,-437 43816.23,-437 43816.23,-437 43816.23,-437 43816.23,-436.96 43816.23,-436.96"/>
<polygon fill="black" stroke="black" points="43819.73,-446.61 43816.23,-436.61 43812.73,-446.61 43819.73,-446.61"/>
</g>
<!-- L4_S0_TP6_GPU6_norm -->
<g id="node511" class="node">
<title>L4_S0_TP6_GPU6_norm</title>
<polygon fill="none" stroke="black" points="44400.5,-332.33 43951.5,-332.33 43951.5,-264.33 44400.5,-264.33 44400.5,-332.33"/>
<text text-anchor="middle" x="44176" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="44176" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="44176" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="44176" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP6_GPU6_moe_res&#45;&gt;L4_S0_TP6_GPU6_norm -->
<g id="edge1404" class="edge">
<title>L4_S0_TP6_GPU6_moe_res&#45;&gt;L4_S0_TP6_GPU6_norm</title>
<path fill="none" stroke="black" d="M44176,-368.28C44176,-368.28 44176,-342.46 44176,-342.46"/>
<polygon fill="black" stroke="black" points="44179.5,-342.46 44176,-332.46 44172.5,-342.46 44179.5,-342.46"/>
</g>
<!-- L4_S0_TP7_GPU7_qkv_linear -->
<g id="node512" class="node">
<title>L4_S0_TP7_GPU7_qkv_linear</title>
<polygon fill="none" stroke="black" points="45021,-1614.75 44413,-1614.75 44413,-1546.75 45021,-1546.75 45021,-1614.75"/>
<text text-anchor="middle" x="44717" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="44717" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="44717" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="44717" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L4_S0_TP7_GPU7_qkv_slice -->
<g id="node513" class="node">
<title>L4_S0_TP7_GPU7_qkv_slice</title>
<polygon fill="none" stroke="black" points="45015,-1496.67 44419,-1496.67 44419,-1428.67 45015,-1428.67 45015,-1496.67"/>
<text text-anchor="middle" x="44717" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="44717" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="44717" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="44717" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L4_S0_TP7_GPU7_qkv_linear&#45;&gt;L4_S0_TP7_GPU7_qkv_slice -->
<g id="edge1405" class="edge">
<title>L4_S0_TP7_GPU7_qkv_linear&#45;&gt;L4_S0_TP7_GPU7_qkv_slice</title>
<path fill="none" stroke="black" d="M44717,-1546.59C44717,-1546.59 44717,-1506.74 44717,-1506.74"/>
<polygon fill="black" stroke="black" points="44720.5,-1506.74 44717,-1496.74 44713.5,-1506.74 44720.5,-1506.74"/>
</g>
<!-- L4_S0_TP7_GPU7_qkv_slice&#45;&gt;L4_S0_TP7_GPU7_attn_v -->
<g id="edge1409" class="edge">
<title>L4_S0_TP7_GPU7_qkv_slice&#45;&gt;L4_S0_TP7_GPU7_attn_v</title>
<path fill="none" stroke="black" d="M44460.5,-1428.38C44460.5,-1428.38 44460.5,-1195 44460.5,-1195"/>
<polygon fill="black" stroke="black" points="44464,-1195 44460.5,-1185 44457,-1195 44464,-1195"/>
</g>
<!-- L4_S0_TP7_GPU7_qk_matmul -->
<g id="node514" class="node">
<title>L4_S0_TP7_GPU7_qk_matmul</title>
<polygon fill="none" stroke="black" points="45432.5,-1392.67 44497.5,-1392.67 44497.5,-1324.67 45432.5,-1324.67 45432.5,-1392.67"/>
<text text-anchor="middle" x="44965" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="44965" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="44965" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="44965" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L4_S0_TP7_GPU7_qkv_slice&#45;&gt;L4_S0_TP7_GPU7_qk_matmul -->
<g id="edge1406" class="edge">
<title>L4_S0_TP7_GPU7_qkv_slice&#45;&gt;L4_S0_TP7_GPU7_qk_matmul</title>
<path fill="none" stroke="black" d="M44756.25,-1428.61C44756.25,-1428.61 44756.25,-1402.8 44756.25,-1402.8"/>
<polygon fill="black" stroke="black" points="44759.75,-1402.8 44756.25,-1392.8 44752.75,-1402.8 44759.75,-1402.8"/>
</g>
<!-- L4_S0_TP7_GPU7_softmax -->
<g id="node515" class="node">
<title>L4_S0_TP7_GPU7_softmax</title>
<polygon fill="none" stroke="black" points="45113,-1288.67 44603,-1288.67 44603,-1220.67 45113,-1220.67 45113,-1288.67"/>
<text text-anchor="middle" x="44858" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="44858" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="44858" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="44858" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L4_S0_TP7_GPU7_qk_matmul&#45;&gt;L4_S0_TP7_GPU7_softmax -->
<g id="edge1407" class="edge">
<title>L4_S0_TP7_GPU7_qk_matmul&#45;&gt;L4_S0_TP7_GPU7_softmax</title>
<path fill="none" stroke="black" d="M44858,-1324.61C44858,-1324.61 44858,-1298.8 44858,-1298.8"/>
<polygon fill="black" stroke="black" points="44861.5,-1298.8 44858,-1288.8 44854.5,-1298.8 44861.5,-1298.8"/>
</g>
<!-- L4_S0_TP7_GPU7_softmax&#45;&gt;L4_S0_TP7_GPU7_attn_v -->
<g id="edge1408" class="edge">
<title>L4_S0_TP7_GPU7_softmax&#45;&gt;L4_S0_TP7_GPU7_attn_v</title>
<path fill="none" stroke="black" d="M44773,-1220.61C44773,-1220.61 44773,-1194.8 44773,-1194.8"/>
<polygon fill="black" stroke="black" points="44776.5,-1194.8 44773,-1184.8 44769.5,-1194.8 44776.5,-1194.8"/>
</g>
<!-- L4_S0_TP7_GPU7_mha_res -->
<g id="node517" class="node">
<title>L4_S0_TP7_GPU7_mha_res</title>
<polygon fill="none" stroke="black" points="45343.5,-948.5 44456.5,-948.5 44456.5,-880.5 45343.5,-880.5 45343.5,-948.5"/>
<text text-anchor="middle" x="44900" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="44900" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="44900" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="44900" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP7_GPU7_mha_ar&#45;&gt;L4_S0_TP7_GPU7_mha_res -->
<g id="edge1418" class="edge">
<title>L4_S0_TP7_GPU7_mha_ar&#45;&gt;L4_S0_TP7_GPU7_mha_res</title>
<path fill="none" stroke="black" d="M44171.53,-1016C44416.7,-1016 44699.75,-1016 44699.75,-1016 44699.75,-1016 44699.75,-958.58 44699.75,-958.58"/>
<polygon fill="black" stroke="black" points="44703.25,-958.58 44699.75,-948.58 44696.25,-958.58 44703.25,-958.58"/>
</g>
<!-- L4_S0_TP7_GPU7_gate -->
<g id="node518" class="node">
<title>L4_S0_TP7_GPU7_gate</title>
<polygon fill="none" stroke="black" points="45429.56,-844.5 44587.15,-844.5 44370.44,-708.5 45212.85,-708.5 45429.56,-844.5"/>
<text text-anchor="middle" x="44900" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="44900" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="44900" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="44900" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L4_S0_TP7_GPU7_mha_res&#45;&gt;L4_S0_TP7_GPU7_gate -->
<g id="edge1419" class="edge">
<title>L4_S0_TP7_GPU7_mha_res&#45;&gt;L4_S0_TP7_GPU7_gate</title>
<path fill="none" stroke="black" d="M44900,-880.39C44900,-880.39 44900,-854.73 44900,-854.73"/>
<polygon fill="black" stroke="black" points="44903.5,-854.73 44900,-844.73 44896.5,-854.73 44903.5,-854.73"/>
</g>
<!-- L4_S0_TP7_GPU7_moe_res -->
<g id="node520" class="node">
<title>L4_S0_TP7_GPU7_moe_res</title>
<polygon fill="none" stroke="black" points="45799,-436.33 44979,-436.33 44979,-368.33 45799,-368.33 45799,-436.33"/>
<text text-anchor="middle" x="45389" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="45389" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="45389" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="45389" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP7_GPU7_mha_res&#45;&gt;L4_S0_TP7_GPU7_moe_res -->
<g id="edge1439" class="edge">
<title>L4_S0_TP7_GPU7_mha_res&#45;&gt;L4_S0_TP7_GPU7_moe_res</title>
<path fill="none" stroke="black" d="M45343.62,-925C45489.83,-925 45615.75,-925 45615.75,-925 45615.75,-925 45615.75,-446.63 45615.75,-446.63"/>
<polygon fill="black" stroke="black" points="45619.25,-446.63 45615.75,-436.63 45612.25,-446.63 45619.25,-446.63"/>
</g>
<!-- L4_S0_TP7_GPU7_gate&#45;&gt;L4_S0_TP7_GPU7_expert0 -->
<g id="edge1420" class="edge">
<title>L4_S0_TP7_GPU7_gate&#45;&gt;L4_S0_TP7_GPU7_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M44378.86,-776.4C44378.86,-776.4 44378.86,-682.74 44378.86,-682.74"/>
<polygon fill="black" stroke="black" points="44382.36,-682.74 44378.86,-672.74 44375.36,-682.74 44382.36,-682.74"/>
</g>
<!-- L4_S0_TP7_GPU7_gate&#45;&gt;L4_S0_TP7_GPU7_expert1 -->
<g id="edge1421" class="edge">
<title>L4_S0_TP7_GPU7_gate&#45;&gt;L4_S0_TP7_GPU7_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M44630,-708.31C44630,-708.31 44630,-682.71 44630,-682.71"/>
<polygon fill="black" stroke="black" points="44633.5,-682.71 44630,-672.71 44626.5,-682.71 44633.5,-682.71"/>
</g>
<!-- L4_S0_TP7_GPU7_moe_ar&#45;&gt;L4_S0_TP7_GPU7_moe_res -->
<g id="edge1438" class="edge">
<title>L4_S0_TP7_GPU7_moe_ar&#45;&gt;L4_S0_TP7_GPU7_moe_res</title>
<path fill="none" stroke="black" d="M43765.86,-486C44225.94,-486 45204.39,-486 45204.39,-486 45204.39,-486 45204.39,-446.36 45204.39,-446.36"/>
<polygon fill="black" stroke="black" points="45207.89,-446.36 45204.39,-436.36 45200.89,-446.36 45207.89,-446.36"/>
</g>
<!-- L4_S0_TP7_GPU7_norm -->
<g id="node521" class="node">
<title>L4_S0_TP7_GPU7_norm</title>
<polygon fill="none" stroke="black" points="45613.5,-332.33 45164.5,-332.33 45164.5,-264.33 45613.5,-264.33 45613.5,-332.33"/>
<text text-anchor="middle" x="45389" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="45389" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="45389" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="45389" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L4_S0_TP7_GPU7_moe_res&#45;&gt;L4_S0_TP7_GPU7_norm -->
<g id="edge1440" class="edge">
<title>L4_S0_TP7_GPU7_moe_res&#45;&gt;L4_S0_TP7_GPU7_norm</title>
<path fill="none" stroke="black" d="M45389,-368.28C45389,-368.28 45389,-342.46 45389,-342.46"/>
<polygon fill="black" stroke="black" points="45392.5,-342.46 45389,-332.46 45385.5,-342.46 45392.5,-342.46"/>
</g>
<!-- L5_S0_TP0_GPU0_qkv_linear -->
<g id="node522" class="node">
<title>L5_S0_TP0_GPU0_qkv_linear</title>
<polygon fill="none" stroke="black" points="47102,-1614.75 46494,-1614.75 46494,-1546.75 47102,-1546.75 47102,-1614.75"/>
<text text-anchor="middle" x="46798" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="46798" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="46798" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="46798" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L5_S0_TP0_GPU0_qkv_slice -->
<g id="node523" class="node">
<title>L5_S0_TP0_GPU0_qkv_slice</title>
<polygon fill="none" stroke="black" points="47096,-1496.67 46500,-1496.67 46500,-1428.67 47096,-1428.67 47096,-1496.67"/>
<text text-anchor="middle" x="46798" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="46798" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="46798" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="46798" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L5_S0_TP0_GPU0_qkv_linear&#45;&gt;L5_S0_TP0_GPU0_qkv_slice -->
<g id="edge1441" class="edge">
<title>L5_S0_TP0_GPU0_qkv_linear&#45;&gt;L5_S0_TP0_GPU0_qkv_slice</title>
<path fill="none" stroke="black" d="M46798,-1546.59C46798,-1546.59 46798,-1506.74 46798,-1506.74"/>
<polygon fill="black" stroke="black" points="46801.5,-1506.74 46798,-1496.74 46794.5,-1506.74 46801.5,-1506.74"/>
</g>
<!-- L5_S0_TP0_GPU0_qk_matmul -->
<g id="node524" class="node">
<title>L5_S0_TP0_GPU0_qk_matmul</title>
<polygon fill="none" stroke="black" points="47570.5,-1392.67 46635.5,-1392.67 46635.5,-1324.67 47570.5,-1324.67 47570.5,-1392.67"/>
<text text-anchor="middle" x="47103" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="47103" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="47103" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="47103" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L5_S0_TP0_GPU0_qkv_slice&#45;&gt;L5_S0_TP0_GPU0_qk_matmul -->
<g id="edge1442" class="edge">
<title>L5_S0_TP0_GPU0_qkv_slice&#45;&gt;L5_S0_TP0_GPU0_qk_matmul</title>
<path fill="none" stroke="black" d="M46865.75,-1428.61C46865.75,-1428.61 46865.75,-1402.8 46865.75,-1402.8"/>
<polygon fill="black" stroke="black" points="46869.25,-1402.8 46865.75,-1392.8 46862.25,-1402.8 46869.25,-1402.8"/>
</g>
<!-- L5_S0_TP0_GPU0_attn_v -->
<g id="node526" class="node">
<title>L5_S0_TP0_GPU0_attn_v</title>
<polygon fill="none" stroke="black" points="47571,-1184.67 46633,-1184.67 46633,-1116.67 47571,-1116.67 47571,-1184.67"/>
<text text-anchor="middle" x="47102" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="47102" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="47102" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="47102" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L5_S0_TP0_GPU0_qkv_slice&#45;&gt;L5_S0_TP0_GPU0_attn_v -->
<g id="edge1445" class="edge">
<title>L5_S0_TP0_GPU0_qkv_slice&#45;&gt;L5_S0_TP0_GPU0_attn_v</title>
<path fill="none" stroke="black" d="M46566.5,-1428.61C46566.5,-1347.57 46566.5,-1150 46566.5,-1150 46566.5,-1150 46622.97,-1150 46622.97,-1150"/>
<polygon fill="black" stroke="black" points="46622.97,-1153.5 46632.97,-1150 46622.97,-1146.5 46622.97,-1153.5"/>
</g>
<!-- L5_S0_TP0_GPU0_softmax -->
<g id="node525" class="node">
<title>L5_S0_TP0_GPU0_softmax</title>
<polygon fill="none" stroke="black" points="47357,-1288.67 46847,-1288.67 46847,-1220.67 47357,-1220.67 47357,-1288.67"/>
<text text-anchor="middle" x="47102" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="47102" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="47102" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="47102" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L5_S0_TP0_GPU0_qk_matmul&#45;&gt;L5_S0_TP0_GPU0_softmax -->
<g id="edge1443" class="edge">
<title>L5_S0_TP0_GPU0_qk_matmul&#45;&gt;L5_S0_TP0_GPU0_softmax</title>
<path fill="none" stroke="black" d="M47102,-1324.61C47102,-1324.61 47102,-1298.8 47102,-1298.8"/>
<polygon fill="black" stroke="black" points="47105.5,-1298.8 47102,-1288.8 47098.5,-1298.8 47105.5,-1298.8"/>
</g>
<!-- L5_S0_TP0_GPU0_softmax&#45;&gt;L5_S0_TP0_GPU0_attn_v -->
<g id="edge1444" class="edge">
<title>L5_S0_TP0_GPU0_softmax&#45;&gt;L5_S0_TP0_GPU0_attn_v</title>
<path fill="none" stroke="black" d="M47102,-1220.61C47102,-1220.61 47102,-1194.8 47102,-1194.8"/>
<polygon fill="black" stroke="black" points="47105.5,-1194.8 47102,-1184.8 47098.5,-1194.8 47105.5,-1194.8"/>
</g>
<!-- L5_S0_TP0_GPU0_mha_ar -->
<g id="node527" class="node">
<title>L5_S0_TP0_GPU0_mha_ar</title>
<ellipse fill="none" stroke="black" cx="47757" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="47757" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="47757" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="47757" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="47757" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP0_GPU0_attn_v&#45;&gt;L5_S0_TP0_GPU0_mha_ar -->
<g id="edge1446" class="edge">
<title>L5_S0_TP0_GPU0_attn_v&#45;&gt;L5_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M47413.11,-1116.51C47413.11,-1116.51 47413.11,-1061.95 47413.11,-1061.95"/>
<polygon fill="black" stroke="black" points="47416.61,-1061.95 47413.11,-1051.95 47409.61,-1061.95 47416.61,-1061.95"/>
</g>
<!-- L5_S0_TP1_GPU1_mha_ar -->
<g id="node560" class="node">
<title>L5_S0_TP1_GPU1_mha_ar</title>
<ellipse fill="none" stroke="black" cx="48526" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="48526" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="48526" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="48526" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="48526" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP0_GPU0_attn_v&#45;&gt;L5_S0_TP1_GPU1_mha_ar -->
<g id="edge1482" class="edge">
<title>L5_S0_TP0_GPU0_attn_v&#45;&gt;L5_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M47444.68,-1116.4C47444.68,-1101.77 47444.68,-1088 47444.68,-1088 47444.68,-1088 48197.59,-1088 48197.59,-1088 48197.59,-1088 48197.59,-1066.08 48197.59,-1066.08"/>
<polygon fill="black" stroke="black" points="48201.09,-1066.08 48197.59,-1056.08 48194.09,-1066.08 48201.09,-1066.08"/>
</g>
<!-- L5_S0_TP2_GPU2_mha_ar -->
<g id="node570" class="node">
<title>L5_S0_TP2_GPU2_mha_ar</title>
<ellipse fill="none" stroke="black" cx="49295" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="49295" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="49295" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="49295" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="49295" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP0_GPU0_attn_v&#45;&gt;L5_S0_TP2_GPU2_mha_ar -->
<g id="edge1518" class="edge">
<title>L5_S0_TP0_GPU0_attn_v&#45;&gt;L5_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M47476.26,-1116.4C47476.26,-1101.77 47476.26,-1088 47476.26,-1088 47476.26,-1088 48989.96,-1088 48989.96,-1088 48989.96,-1088 48989.96,-1070.94 48989.96,-1070.94"/>
<polygon fill="black" stroke="black" points="48993.46,-1070.94 48989.96,-1060.94 48986.46,-1070.94 48993.46,-1070.94"/>
</g>
<!-- L5_S0_TP3_GPU3_mha_ar -->
<g id="node580" class="node">
<title>L5_S0_TP3_GPU3_mha_ar</title>
<ellipse fill="none" stroke="black" cx="50064" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="50064" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="50064" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="50064" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="50064" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP0_GPU0_attn_v&#45;&gt;L5_S0_TP3_GPU3_mha_ar -->
<g id="edge1554" class="edge">
<title>L5_S0_TP0_GPU0_attn_v&#45;&gt;L5_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M47507.84,-1116.4C47507.84,-1101.77 47507.84,-1088 47507.84,-1088 47507.84,-1088 49795.74,-1088 49795.74,-1088 49795.74,-1088 49795.74,-1076.42 49795.74,-1076.42"/>
<polygon fill="black" stroke="black" points="49799.24,-1076.42 49795.74,-1066.42 49792.24,-1076.42 49799.24,-1076.42"/>
</g>
<!-- L5_S0_TP4_GPU4_mha_ar -->
<g id="node590" class="node">
<title>L5_S0_TP4_GPU4_mha_ar</title>
<ellipse fill="none" stroke="black" cx="50833" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="50833" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="50833" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="50833" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="50833" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP0_GPU0_attn_v&#45;&gt;L5_S0_TP4_GPU4_mha_ar -->
<g id="edge1590" class="edge">
<title>L5_S0_TP0_GPU0_attn_v&#45;&gt;L5_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M47346.01,-1116.45C47346.01,-1064.32 47346.01,-971 47346.01,-971 47346.01,-971 50515.74,-971 50515.74,-971 50515.74,-971 50515.74,-996.82 50515.74,-996.82"/>
<polygon fill="black" stroke="black" points="50512.24,-996.82 50515.74,-1006.82 50519.24,-996.82 50512.24,-996.82"/>
</g>
<!-- L5_S0_TP5_GPU5_mha_ar -->
<g id="node600" class="node">
<title>L5_S0_TP5_GPU5_mha_ar</title>
<ellipse fill="none" stroke="black" cx="51602" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="51602" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="51602" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="51602" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="51602" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP0_GPU0_attn_v&#45;&gt;L5_S0_TP5_GPU5_mha_ar -->
<g id="edge1626" class="edge">
<title>L5_S0_TP0_GPU0_attn_v&#45;&gt;L5_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M47499.33,-1184.75C47499.33,-1199.3 47499.33,-1213 47499.33,-1213 47499.33,-1213 51408.5,-1213 51408.5,-1213 51408.5,-1213 51408.5,-1083.97 51408.5,-1083.97"/>
<polygon fill="black" stroke="black" points="51412,-1083.97 51408.5,-1073.97 51405,-1083.97 51412,-1083.97"/>
</g>
<!-- L5_S0_TP6_GPU6_mha_ar -->
<g id="node610" class="node">
<title>L5_S0_TP6_GPU6_mha_ar</title>
<ellipse fill="none" stroke="black" cx="52371" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="52371" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="52371" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="52371" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="52371" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP0_GPU0_attn_v&#45;&gt;L5_S0_TP6_GPU6_mha_ar -->
<g id="edge1662" class="edge">
<title>L5_S0_TP0_GPU0_attn_v&#45;&gt;L5_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M47428.17,-1184.73C47428.17,-1201.43 47428.17,-1218 47428.17,-1218 47428.17,-1218 52363,-1218 52363,-1218 52363,-1218 52363,-1090.81 52363,-1090.81"/>
<polygon fill="black" stroke="black" points="52366.5,-1090.81 52363,-1080.81 52359.5,-1090.82 52366.5,-1090.81"/>
</g>
<!-- L5_S0_TP7_GPU7_mha_ar -->
<g id="node620" class="node">
<title>L5_S0_TP7_GPU7_mha_ar</title>
<ellipse fill="none" stroke="black" cx="53140" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="53140" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="53140" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="53140" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="53140" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP0_GPU0_attn_v&#45;&gt;L5_S0_TP7_GPU7_mha_ar -->
<g id="edge1698" class="edge">
<title>L5_S0_TP0_GPU0_attn_v&#45;&gt;L5_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M47539.42,-1116.59C47539.42,-1107.42 47539.42,-1100 47539.42,-1100 47539.42,-1100 52832.34,-1100 52832.34,-1100 52832.34,-1100 52832.34,-1070.39 52832.34,-1070.39"/>
<polygon fill="black" stroke="black" points="52835.84,-1070.39 52832.34,-1060.39 52828.84,-1070.39 52835.84,-1070.39"/>
</g>
<!-- L5_S0_TP0_GPU0_mha_res -->
<g id="node535" class="node">
<title>L5_S0_TP0_GPU0_mha_res</title>
<polygon fill="none" stroke="black" points="47119.5,-948.5 46232.5,-948.5 46232.5,-880.5 47119.5,-880.5 47119.5,-948.5"/>
<text text-anchor="middle" x="46676" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="46676" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="46676" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="46676" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP0_GPU0_mha_ar&#45;&gt;L5_S0_TP0_GPU0_mha_res -->
<g id="edge1454" class="edge">
<title>L5_S0_TP0_GPU0_mha_ar&#45;&gt;L5_S0_TP0_GPU0_mha_res</title>
<path fill="none" stroke="black" d="M47401.3,-1048C47156.86,-1048 46876.25,-1048 46876.25,-1048 46876.25,-1048 46876.25,-958.53 46876.25,-958.53"/>
<polygon fill="black" stroke="black" points="46879.75,-958.53 46876.25,-948.53 46872.75,-958.53 46879.75,-958.53"/>
</g>
<!-- L5_S0_TP1_GPU1_attn_v -->
<g id="node528" class="node">
<title>L5_S0_TP1_GPU1_attn_v</title>
<polygon fill="none" stroke="black" points="48527,-1184.67 47589,-1184.67 47589,-1116.67 48527,-1116.67 48527,-1184.67"/>
<text text-anchor="middle" x="48058" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="48058" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="48058" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="48058" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L5_S0_TP1_GPU1_attn_v&#45;&gt;L5_S0_TP0_GPU0_mha_ar -->
<g id="edge1447" class="edge">
<title>L5_S0_TP1_GPU1_attn_v&#45;&gt;L5_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M47656.93,-1116.51C47656.93,-1116.51 47656.93,-1088.96 47656.93,-1088.96"/>
<polygon fill="black" stroke="black" points="47660.43,-1088.96 47656.93,-1078.96 47653.43,-1088.96 47660.43,-1088.96"/>
</g>
<!-- L5_S0_TP1_GPU1_attn_v&#45;&gt;L5_S0_TP1_GPU1_mha_ar -->
<g id="edge1483" class="edge">
<title>L5_S0_TP1_GPU1_attn_v&#45;&gt;L5_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M48244.64,-1116.51C48244.64,-1116.51 48244.64,-1074.64 48244.64,-1074.64"/>
<polygon fill="black" stroke="black" points="48248.14,-1074.64 48244.64,-1064.64 48241.14,-1074.64 48248.14,-1074.64"/>
</g>
<!-- L5_S0_TP1_GPU1_attn_v&#45;&gt;L5_S0_TP2_GPU2_mha_ar -->
<g id="edge1519" class="edge">
<title>L5_S0_TP1_GPU1_attn_v&#45;&gt;L5_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M48291.7,-1116.4C48291.7,-1101.77 48291.7,-1088 48291.7,-1088 48291.7,-1088 49060.39,-1088 49060.39,-1088 49060.39,-1088 49060.39,-1080.16 49060.39,-1080.16"/>
<polygon fill="black" stroke="black" points="49063.89,-1080.16 49060.39,-1070.16 49056.89,-1080.16 49063.89,-1080.16"/>
</g>
<!-- L5_S0_TP1_GPU1_attn_v&#45;&gt;L5_S0_TP3_GPU3_mha_ar -->
<g id="edge1555" class="edge">
<title>L5_S0_TP1_GPU1_attn_v&#45;&gt;L5_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M48338.76,-1116.4C48338.76,-1101.77 48338.76,-1088 48338.76,-1088 48338.76,-1088 49902.95,-1088 49902.95,-1088 49902.95,-1088 49902.95,-1086.25 49902.95,-1086.25"/>
<polygon fill="black" stroke="black" points="49906.45,-1086.25 49902.95,-1076.25 49899.45,-1086.25 49906.45,-1086.25"/>
</g>
<!-- L5_S0_TP1_GPU1_attn_v&#45;&gt;L5_S0_TP4_GPU4_mha_ar -->
<g id="edge1591" class="edge">
<title>L5_S0_TP1_GPU1_attn_v&#45;&gt;L5_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M48141.5,-1116.45C48141.5,-1064.32 48141.5,-971 48141.5,-971 48141.5,-971 50486.98,-971 50486.98,-971 50486.98,-971 50486.98,-1003.77 50486.98,-1003.77"/>
<polygon fill="black" stroke="black" points="50483.48,-1003.77 50486.98,-1013.77 50490.48,-1003.77 50483.48,-1003.77"/>
</g>
<!-- L5_S0_TP1_GPU1_attn_v&#45;&gt;L5_S0_TP5_GPU5_mha_ar -->
<g id="edge1627" class="edge">
<title>L5_S0_TP1_GPU1_attn_v&#45;&gt;L5_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M48385.82,-1116.49C48385.82,-1106.88 48385.82,-1099 48385.82,-1099 48385.82,-1099 51260.22,-1099 51260.22,-1099 51260.22,-1099 51260.22,-1062.51 51260.22,-1062.51"/>
<polygon fill="black" stroke="black" points="51263.72,-1062.51 51260.22,-1052.51 51256.72,-1062.51 51263.72,-1062.51"/>
</g>
<!-- L5_S0_TP1_GPU1_attn_v&#45;&gt;L5_S0_TP6_GPU6_mha_ar -->
<g id="edge1663" class="edge">
<title>L5_S0_TP1_GPU1_attn_v&#45;&gt;L5_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M48432.88,-1116.49C48432.88,-1106.88 48432.88,-1099 48432.88,-1099 48432.88,-1099 52054.77,-1099 52054.77,-1099 52054.77,-1099 52054.77,-1068.83 52054.77,-1068.83"/>
<polygon fill="black" stroke="black" points="52058.27,-1068.83 52054.77,-1058.83 52051.27,-1068.83 52058.27,-1068.83"/>
</g>
<!-- L5_S0_TP1_GPU1_attn_v&#45;&gt;L5_S0_TP7_GPU7_mha_ar -->
<g id="edge1699" class="edge">
<title>L5_S0_TP1_GPU1_attn_v&#45;&gt;L5_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M48479.94,-1116.59C48479.94,-1107.42 48479.94,-1100 48479.94,-1100 48479.94,-1100 52900.14,-1100 52900.14,-1100 52900.14,-1100 52900.14,-1079.84 52900.14,-1079.84"/>
<polygon fill="black" stroke="black" points="52903.64,-1079.84 52900.14,-1069.84 52896.64,-1079.84 52903.64,-1079.84"/>
</g>
<!-- L5_S0_TP2_GPU2_attn_v -->
<g id="node529" class="node">
<title>L5_S0_TP2_GPU2_attn_v</title>
<polygon fill="none" stroke="black" points="49483,-1184.67 48545,-1184.67 48545,-1116.67 49483,-1116.67 49483,-1184.67"/>
<text text-anchor="middle" x="49014" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="49014" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="49014" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="49014" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L5_S0_TP2_GPU2_attn_v&#45;&gt;L5_S0_TP0_GPU0_mha_ar -->
<g id="edge1448" class="edge">
<title>L5_S0_TP2_GPU2_attn_v&#45;&gt;L5_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M48595.92,-1116.59C48595.92,-1107.42 48595.92,-1100 48595.92,-1100 48595.92,-1100 47724.87,-1100 47724.87,-1100 47724.87,-1100 47724.87,-1090.5 47724.87,-1090.5"/>
<polygon fill="black" stroke="black" points="47728.37,-1090.5 47724.87,-1080.5 47721.37,-1090.5 47728.37,-1090.5"/>
</g>
<!-- L5_S0_TP2_GPU2_attn_v&#45;&gt;L5_S0_TP1_GPU1_mha_ar -->
<g id="edge1484" class="edge">
<title>L5_S0_TP2_GPU2_attn_v&#45;&gt;L5_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M48646.85,-1116.51C48646.85,-1116.51 48646.85,-1088.52 48646.85,-1088.52"/>
<polygon fill="black" stroke="black" points="48650.35,-1088.52 48646.85,-1078.52 48643.35,-1088.52 48650.35,-1088.52"/>
</g>
<!-- L5_S0_TP2_GPU2_attn_v&#45;&gt;L5_S0_TP2_GPU2_mha_ar -->
<g id="edge1520" class="edge">
<title>L5_S0_TP2_GPU2_attn_v&#45;&gt;L5_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M49130.83,-1116.51C49130.83,-1116.51 49130.83,-1085.92 49130.83,-1085.92"/>
<polygon fill="black" stroke="black" points="49134.33,-1085.92 49130.83,-1075.92 49127.33,-1085.92 49134.33,-1085.92"/>
</g>
<!-- L5_S0_TP2_GPU2_attn_v&#45;&gt;L5_S0_TP3_GPU3_mha_ar -->
<g id="edge1556" class="edge">
<title>L5_S0_TP2_GPU2_attn_v&#45;&gt;L5_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M49201.26,-1116.4C49201.26,-1101.77 49201.26,-1088 49201.26,-1088 49201.26,-1088 50010.16,-1088 50010.16,-1088 50010.16,-1088 50010.16,-1087.23 50010.16,-1087.23"/>
<polygon fill="black" stroke="black" points="50013.66,-1090.29 50010.16,-1080.29 50006.66,-1090.29 50013.66,-1090.29"/>
</g>
<!-- L5_S0_TP2_GPU2_attn_v&#45;&gt;L5_S0_TP4_GPU4_mha_ar -->
<g id="edge1592" class="edge">
<title>L5_S0_TP2_GPU2_attn_v&#45;&gt;L5_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M49271.7,-1116.49C49271.7,-1106.88 49271.7,-1099 49271.7,-1099 49271.7,-1099 50672.08,-1099 50672.08,-1099 50672.08,-1099 50672.08,-1086.14 50672.08,-1086.14"/>
<polygon fill="black" stroke="black" points="50675.58,-1086.14 50672.08,-1076.14 50668.58,-1086.14 50675.58,-1086.14"/>
</g>
<!-- L5_S0_TP2_GPU2_attn_v&#45;&gt;L5_S0_TP5_GPU5_mha_ar -->
<g id="edge1628" class="edge">
<title>L5_S0_TP2_GPU2_attn_v&#45;&gt;L5_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M49400,-1184.76C49400,-1196.15 49400,-1206 49400,-1206 49400,-1206 51404,-1206 51404,-1206 51404,-1206 51404,-1083.68 51404,-1083.68"/>
<polygon fill="black" stroke="black" points="51407.5,-1083.68 51404,-1073.68 51400.5,-1083.68 51407.5,-1083.68"/>
</g>
<!-- L5_S0_TP2_GPU2_attn_v&#45;&gt;L5_S0_TP6_GPU6_mha_ar -->
<g id="edge1664" class="edge">
<title>L5_S0_TP2_GPU2_attn_v&#45;&gt;L5_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M49342.13,-1116.49C49342.13,-1106.88 49342.13,-1099 49342.13,-1099 49342.13,-1099 52114.02,-1099 52114.02,-1099 52114.02,-1099 52114.02,-1077.74 52114.02,-1077.74"/>
<polygon fill="black" stroke="black" points="52117.52,-1077.74 52114.02,-1067.74 52110.52,-1077.74 52117.52,-1077.74"/>
</g>
<!-- L5_S0_TP2_GPU2_attn_v&#45;&gt;L5_S0_TP7_GPU7_mha_ar -->
<g id="edge1700" class="edge">
<title>L5_S0_TP2_GPU2_attn_v&#45;&gt;L5_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M49412.57,-1116.59C49412.57,-1107.42 49412.57,-1100 49412.57,-1100 49412.57,-1100 52967.95,-1100 52967.95,-1100 52967.95,-1100 52967.95,-1085.66 52967.95,-1085.66"/>
<polygon fill="black" stroke="black" points="52971.45,-1085.66 52967.95,-1075.66 52964.45,-1085.66 52971.45,-1085.66"/>
</g>
<!-- L5_S0_TP3_GPU3_attn_v -->
<g id="node530" class="node">
<title>L5_S0_TP3_GPU3_attn_v</title>
<polygon fill="none" stroke="black" points="50439,-1184.67 49501,-1184.67 49501,-1116.67 50439,-1116.67 50439,-1184.67"/>
<text text-anchor="middle" x="49970" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="49970" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="49970" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="49970" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L5_S0_TP3_GPU3_attn_v&#45;&gt;L5_S0_TP0_GPU0_mha_ar -->
<g id="edge1449" class="edge">
<title>L5_S0_TP3_GPU3_attn_v&#45;&gt;L5_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M49529.25,-1116.59C49529.25,-1107.42 49529.25,-1100 49529.25,-1100 49529.25,-1100 47792.8,-1100 47792.8,-1100 47792.8,-1100 47792.8,-1090.5 47792.8,-1090.5"/>
<polygon fill="black" stroke="black" points="47796.3,-1090.5 47792.8,-1080.5 47789.3,-1090.5 47796.3,-1090.5"/>
</g>
<!-- L5_S0_TP3_GPU3_attn_v&#45;&gt;L5_S0_TP1_GPU1_mha_ar -->
<g id="edge1485" class="edge">
<title>L5_S0_TP3_GPU3_attn_v&#45;&gt;L5_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M49557.49,-1116.59C49557.49,-1107.42 49557.49,-1100 49557.49,-1100 49557.49,-1100 48697.77,-1100 48697.77,-1100 48697.77,-1100 48697.77,-1085.66 48697.77,-1085.66"/>
<polygon fill="black" stroke="black" points="48701.27,-1085.66 48697.77,-1075.66 48694.27,-1085.66 48701.27,-1085.66"/>
</g>
<!-- L5_S0_TP3_GPU3_attn_v&#45;&gt;L5_S0_TP2_GPU2_mha_ar -->
<g id="edge1521" class="edge">
<title>L5_S0_TP3_GPU3_attn_v&#45;&gt;L5_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M49585.74,-1116.51C49585.74,-1116.51 49585.74,-1073.04 49585.74,-1073.04"/>
<polygon fill="black" stroke="black" points="49589.24,-1073.04 49585.74,-1063.04 49582.24,-1073.04 49589.24,-1073.04"/>
</g>
<!-- L5_S0_TP3_GPU3_attn_v&#45;&gt;L5_S0_TP3_GPU3_mha_ar -->
<g id="edge1557" class="edge">
<title>L5_S0_TP3_GPU3_attn_v&#45;&gt;L5_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M50117.37,-1116.51C50117.37,-1116.51 50117.37,-1090.27 50117.37,-1090.27"/>
<polygon fill="black" stroke="black" points="50120.87,-1090.27 50117.37,-1080.27 50113.87,-1090.27 50120.87,-1090.27"/>
</g>
<!-- L5_S0_TP3_GPU3_attn_v&#45;&gt;L5_S0_TP4_GPU4_mha_ar -->
<g id="edge1593" class="edge">
<title>L5_S0_TP3_GPU3_attn_v&#45;&gt;L5_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M50439.23,-1161C50441.2,-1161 50442.24,-1161 50442.24,-1161 50442.24,-1161 50442.24,-1048 50442.24,-1048 50442.24,-1048 50467.26,-1048 50467.26,-1048"/>
<polygon fill="black" stroke="black" points="50467.26,-1051.5 50477.26,-1048 50467.26,-1044.5 50467.26,-1051.5"/>
</g>
<!-- L5_S0_TP3_GPU3_attn_v&#45;&gt;L5_S0_TP5_GPU5_mha_ar -->
<g id="edge1629" class="edge">
<title>L5_S0_TP3_GPU3_attn_v&#45;&gt;L5_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M50390.33,-1184.7C50390.33,-1188.48 50390.33,-1191 50390.33,-1191 50390.33,-1191 51399.5,-1191 51399.5,-1191 51399.5,-1191 51399.5,-1083.38 51399.5,-1083.38"/>
<polygon fill="black" stroke="black" points="51403,-1083.38 51399.5,-1073.38 51396,-1083.38 51403,-1083.38"/>
</g>
<!-- L5_S0_TP3_GPU3_attn_v&#45;&gt;L5_S0_TP6_GPU6_mha_ar -->
<g id="edge1665" class="edge">
<title>L5_S0_TP3_GPU3_attn_v&#45;&gt;L5_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M50341.67,-1184.76C50341.67,-1192.76 50341.67,-1199 50341.67,-1199 50341.67,-1199 52357,-1199 52357,-1199 52357,-1199 52357,-1090.72 52357,-1090.72"/>
<polygon fill="black" stroke="black" points="52360.5,-1090.72 52357,-1080.72 52353.5,-1090.72 52360.5,-1090.72"/>
</g>
<!-- L5_S0_TP3_GPU3_attn_v&#45;&gt;L5_S0_TP7_GPU7_mha_ar -->
<g id="edge1701" class="edge">
<title>L5_S0_TP3_GPU3_attn_v&#45;&gt;L5_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M50224.58,-1116.59C50224.58,-1107.42 50224.58,-1100 50224.58,-1100 50224.58,-1100 53035.76,-1100 53035.76,-1100 53035.76,-1100 53035.76,-1089.04 53035.76,-1089.04"/>
<polygon fill="black" stroke="black" points="53039.26,-1089.04 53035.76,-1079.04 53032.26,-1089.04 53039.26,-1089.04"/>
</g>
<!-- L5_S0_TP4_GPU4_attn_v -->
<g id="node531" class="node">
<title>L5_S0_TP4_GPU4_attn_v</title>
<polygon fill="none" stroke="black" points="51395,-1184.67 50457,-1184.67 50457,-1116.67 51395,-1116.67 51395,-1184.67"/>
<text text-anchor="middle" x="50926" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="50926" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="50926" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="50926" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L5_S0_TP4_GPU4_attn_v&#45;&gt;L5_S0_TP0_GPU0_mha_ar -->
<g id="edge1450" class="edge">
<title>L5_S0_TP4_GPU4_attn_v&#45;&gt;L5_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M50564.8,-1116.49C50564.8,-1106.88 50564.8,-1099 50564.8,-1099 50564.8,-1099 47860.74,-1099 47860.74,-1099 47860.74,-1099 47860.74,-1089.07 47860.74,-1089.07"/>
<polygon fill="black" stroke="black" points="47864.24,-1089.07 47860.74,-1079.07 47857.24,-1089.07 47864.24,-1089.07"/>
</g>
<!-- L5_S0_TP4_GPU4_attn_v&#45;&gt;L5_S0_TP1_GPU1_mha_ar -->
<g id="edge1486" class="edge">
<title>L5_S0_TP4_GPU4_attn_v&#45;&gt;L5_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M50535.33,-1184.72C50535.33,-1190.67 50535.33,-1195 50535.33,-1195 50535.33,-1195 48536,-1195 48536,-1195 48536,-1195 48536,-1090.87 48536,-1090.87"/>
<polygon fill="black" stroke="black" points="48539.5,-1090.87 48536,-1080.87 48532.5,-1090.87 48539.5,-1090.87"/>
</g>
<!-- L5_S0_TP4_GPU4_attn_v&#45;&gt;L5_S0_TP2_GPU2_mha_ar -->
<g id="edge1522" class="edge">
<title>L5_S0_TP4_GPU4_attn_v&#45;&gt;L5_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M50496.17,-1185.13C50496.17,-1185.69 50496.17,-1186 50496.17,-1186 50496.17,-1186 49495,-1186 49495,-1186 49495,-1186 49495,-1083.29 49495,-1083.29"/>
<polygon fill="black" stroke="black" points="49498.5,-1083.29 49495,-1073.29 49491.5,-1083.29 49498.5,-1083.29"/>
</g>
<!-- L5_S0_TP4_GPU4_attn_v&#45;&gt;L5_S0_TP3_GPU3_mha_ar -->
<g id="edge1558" class="edge">
<title>L5_S0_TP4_GPU4_attn_v&#45;&gt;L5_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M50456.6,-1139C50448.93,-1139 50444.7,-1139 50444.7,-1139 50444.7,-1139 50444.7,-1016 50444.7,-1016 50444.7,-1016 50426.71,-1016 50426.71,-1016"/>
<polygon fill="black" stroke="black" points="50426.71,-1012.5 50416.71,-1016 50426.71,-1019.5 50426.71,-1012.5"/>
</g>
<!-- L5_S0_TP4_GPU4_attn_v&#45;&gt;L5_S0_TP4_GPU4_mha_ar -->
<g id="edge1594" class="edge">
<title>L5_S0_TP4_GPU4_attn_v&#45;&gt;L5_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M50779.36,-1116.51C50779.36,-1116.51 50779.36,-1090.27 50779.36,-1090.27"/>
<polygon fill="black" stroke="black" points="50782.86,-1090.27 50779.36,-1080.27 50775.86,-1090.27 50782.86,-1090.27"/>
</g>
<!-- L5_S0_TP4_GPU4_attn_v&#45;&gt;L5_S0_TP5_GPU5_mha_ar -->
<g id="edge1630" class="edge">
<title>L5_S0_TP4_GPU4_attn_v&#45;&gt;L5_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M51293.92,-1116.51C51293.92,-1116.51 51293.92,-1070.31 51293.92,-1070.31"/>
<polygon fill="black" stroke="black" points="51297.42,-1070.31 51293.92,-1060.31 51290.42,-1070.31 51297.42,-1070.31"/>
</g>
<!-- L5_S0_TP4_GPU4_attn_v&#45;&gt;L5_S0_TP6_GPU6_mha_ar -->
<g id="edge1666" class="edge">
<title>L5_S0_TP4_GPU4_attn_v&#45;&gt;L5_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M51327.61,-1116.41C51327.61,-1114.9 51327.61,-1114 51327.61,-1114 51327.61,-1114 52173.26,-1114 52173.26,-1114 52173.26,-1114 52173.26,-1083.77 52173.26,-1083.77"/>
<polygon fill="black" stroke="black" points="52176.76,-1083.77 52173.26,-1073.77 52169.76,-1083.77 52176.76,-1083.77"/>
</g>
<!-- L5_S0_TP4_GPU4_attn_v&#45;&gt;L5_S0_TP7_GPU7_mha_ar -->
<g id="edge1702" class="edge">
<title>L5_S0_TP4_GPU4_attn_v&#45;&gt;L5_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M51361.31,-1116.41C51361.31,-1114.9 51361.31,-1114 51361.31,-1114 51361.31,-1114 53103.57,-1114 53103.57,-1114 53103.57,-1114 53103.57,-1090.88 53103.57,-1090.88"/>
<polygon fill="black" stroke="black" points="53107.07,-1090.88 53103.57,-1080.88 53100.07,-1090.88 53107.07,-1090.88"/>
</g>
<!-- L5_S0_TP5_GPU5_attn_v -->
<g id="node532" class="node">
<title>L5_S0_TP5_GPU5_attn_v</title>
<polygon fill="none" stroke="black" points="52351,-1184.67 51413,-1184.67 51413,-1116.67 52351,-1116.67 52351,-1184.67"/>
<text text-anchor="middle" x="51882" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="51882" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="51882" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="51882" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L5_S0_TP5_GPU5_attn_v&#45;&gt;L5_S0_TP0_GPU0_mha_ar -->
<g id="edge1451" class="edge">
<title>L5_S0_TP5_GPU5_attn_v&#45;&gt;L5_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M51483.56,-1116.49C51483.56,-1106.88 51483.56,-1099 51483.56,-1099 51483.56,-1099 47928.67,-1099 47928.67,-1099 47928.67,-1099 47928.67,-1085.4 47928.67,-1085.4"/>
<polygon fill="black" stroke="black" points="47932.17,-1085.4 47928.67,-1075.4 47925.17,-1085.4 47932.17,-1085.4"/>
</g>
<!-- L5_S0_TP5_GPU5_attn_v&#45;&gt;L5_S0_TP1_GPU1_mha_ar -->
<g id="edge1487" class="edge">
<title>L5_S0_TP5_GPU5_attn_v&#45;&gt;L5_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M51554.12,-1116.59C51554.12,-1107.42 51554.12,-1100 51554.12,-1100 51554.12,-1100 48748.7,-1100 48748.7,-1100 48748.7,-1100 48748.7,-1081.41 48748.7,-1081.41"/>
<polygon fill="black" stroke="black" points="48752.2,-1081.41 48748.7,-1071.41 48745.2,-1081.41 48752.2,-1081.41"/>
</g>
<!-- L5_S0_TP5_GPU5_attn_v&#45;&gt;L5_S0_TP2_GPU2_mha_ar -->
<g id="edge1523" class="edge">
<title>L5_S0_TP5_GPU5_attn_v&#45;&gt;L5_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M51490.75,-1184.75C51490.75,-1195.2 51490.75,-1204 51490.75,-1204 51490.75,-1204 49489,-1204 49489,-1204 49489,-1204 49489,-1084.08 49489,-1084.08"/>
<polygon fill="black" stroke="black" points="49492.5,-1084.08 49489,-1074.08 49485.5,-1084.08 49492.5,-1084.08"/>
</g>
<!-- L5_S0_TP5_GPU5_attn_v&#45;&gt;L5_S0_TP3_GPU3_mha_ar -->
<g id="edge1559" class="edge">
<title>L5_S0_TP5_GPU5_attn_v&#45;&gt;L5_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M51624.68,-1116.59C51624.68,-1107.42 51624.68,-1100 51624.68,-1100 51624.68,-1100 50331.79,-1100 50331.79,-1100 50331.79,-1100 50331.79,-1076.29 50331.79,-1076.29"/>
<polygon fill="black" stroke="black" points="50335.29,-1076.29 50331.79,-1066.29 50328.29,-1076.29 50335.29,-1076.29"/>
</g>
<!-- L5_S0_TP5_GPU5_attn_v&#45;&gt;L5_S0_TP4_GPU4_mha_ar -->
<g id="edge1595" class="edge">
<title>L5_S0_TP5_GPU5_attn_v&#45;&gt;L5_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M51695.24,-1116.33C51695.24,-1099.17 51695.24,-1082 51695.24,-1082 51695.24,-1082 50886.64,-1082 50886.64,-1082 50886.64,-1082 50886.64,-1081.84 50886.64,-1081.84"/>
<polygon fill="black" stroke="black" points="50890.14,-1090.36 50886.64,-1080.36 50883.14,-1090.36 50890.14,-1090.36"/>
</g>
<!-- L5_S0_TP5_GPU5_attn_v&#45;&gt;L5_S0_TP5_GPU5_mha_ar -->
<g id="edge1631" class="edge">
<title>L5_S0_TP5_GPU5_attn_v&#45;&gt;L5_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M51765.8,-1116.51C51765.8,-1116.51 51765.8,-1085.92 51765.8,-1085.92"/>
<polygon fill="black" stroke="black" points="51769.3,-1085.92 51765.8,-1075.92 51762.3,-1085.92 51769.3,-1085.92"/>
</g>
<!-- L5_S0_TP5_GPU5_attn_v&#45;&gt;L5_S0_TP6_GPU6_mha_ar -->
<g id="edge1667" class="edge">
<title>L5_S0_TP5_GPU5_attn_v&#45;&gt;L5_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M52232.51,-1116.51C52232.51,-1116.51 52232.51,-1087.65 52232.51,-1087.65"/>
<polygon fill="black" stroke="black" points="52236.01,-1087.65 52232.51,-1077.65 52229.01,-1087.65 52236.01,-1087.65"/>
</g>
<!-- L5_S0_TP5_GPU5_attn_v&#45;&gt;L5_S0_TP7_GPU7_mha_ar -->
<g id="edge1703" class="edge">
<title>L5_S0_TP5_GPU5_attn_v&#45;&gt;L5_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M52291.75,-1116.41C52291.75,-1114.9 52291.75,-1114 52291.75,-1114 52291.75,-1114 53171.38,-1114 53171.38,-1114 53171.38,-1114 53171.38,-1090.88 53171.38,-1090.88"/>
<polygon fill="black" stroke="black" points="53174.88,-1090.88 53171.38,-1080.88 53167.88,-1090.88 53174.88,-1090.88"/>
</g>
<!-- L5_S0_TP6_GPU6_attn_v -->
<g id="node533" class="node">
<title>L5_S0_TP6_GPU6_attn_v</title>
<polygon fill="none" stroke="black" points="53307,-1184.67 52369,-1184.67 52369,-1116.67 53307,-1116.67 53307,-1184.67"/>
<text text-anchor="middle" x="52838" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="52838" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="52838" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="52838" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L5_S0_TP6_GPU6_attn_v&#45;&gt;L5_S0_TP0_GPU0_mha_ar -->
<g id="edge1452" class="edge">
<title>L5_S0_TP6_GPU6_attn_v&#45;&gt;L5_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M52416.18,-1116.49C52416.18,-1106.88 52416.18,-1099 52416.18,-1099 52416.18,-1099 47996.61,-1099 47996.61,-1099 47996.61,-1099 47996.61,-1079.68 47996.61,-1079.68"/>
<polygon fill="black" stroke="black" points="48000.11,-1079.68 47996.61,-1069.68 47993.11,-1079.68 48000.11,-1079.68"/>
</g>
<!-- L5_S0_TP6_GPU6_attn_v&#45;&gt;L5_S0_TP1_GPU1_mha_ar -->
<g id="edge1488" class="edge">
<title>L5_S0_TP6_GPU6_attn_v&#45;&gt;L5_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M52463.37,-1116.49C52463.37,-1106.88 52463.37,-1099 52463.37,-1099 52463.37,-1099 48799.62,-1099 48799.62,-1099 48799.62,-1099 48799.62,-1075.79 48799.62,-1075.79"/>
<polygon fill="black" stroke="black" points="48803.12,-1075.79 48799.62,-1065.79 48796.12,-1075.79 48803.12,-1075.79"/>
</g>
<!-- L5_S0_TP6_GPU6_attn_v&#45;&gt;L5_S0_TP2_GPU2_mha_ar -->
<g id="edge1524" class="edge">
<title>L5_S0_TP6_GPU6_attn_v&#45;&gt;L5_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M52510.55,-1116.49C52510.55,-1106.88 52510.55,-1099 52510.55,-1099 52510.55,-1099 49613.98,-1099 49613.98,-1099 49613.98,-1099 49613.98,-1068.07 49613.98,-1068.07"/>
<polygon fill="black" stroke="black" points="49617.48,-1068.07 49613.98,-1058.07 49610.48,-1068.07 49617.48,-1068.07"/>
</g>
<!-- L5_S0_TP6_GPU6_attn_v&#45;&gt;L5_S0_TP3_GPU3_mha_ar -->
<g id="edge1560" class="edge">
<title>L5_S0_TP6_GPU6_attn_v&#45;&gt;L5_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M52755.5,-1116.41C52755.5,-1060.06 52755.5,-954 52755.5,-954 52755.5,-954 50410.82,-954 50410.82,-954 50410.82,-954 50410.82,-1003.96 50410.82,-1003.96"/>
<polygon fill="black" stroke="black" points="50407.32,-1003.96 50410.82,-1013.96 50414.32,-1003.96 50407.32,-1003.96"/>
</g>
<!-- L5_S0_TP6_GPU6_attn_v&#45;&gt;L5_S0_TP4_GPU4_mha_ar -->
<g id="edge1596" class="edge">
<title>L5_S0_TP6_GPU6_attn_v&#45;&gt;L5_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M52557.74,-1116.33C52557.74,-1099.17 52557.74,-1082 52557.74,-1082 52557.74,-1082 50993.92,-1082 50993.92,-1082 50993.92,-1082 50993.92,-1081.43 50993.92,-1081.43"/>
<polygon fill="black" stroke="black" points="50997.42,-1086.33 50993.92,-1076.33 50990.42,-1086.33 50997.42,-1086.33"/>
</g>
<!-- L5_S0_TP6_GPU6_attn_v&#45;&gt;L5_S0_TP5_GPU5_mha_ar -->
<g id="edge1632" class="edge">
<title>L5_S0_TP6_GPU6_attn_v&#45;&gt;L5_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M52604.92,-1116.33C52604.92,-1099.17 52604.92,-1082 52604.92,-1082 52604.92,-1082 51836.36,-1082 51836.36,-1082 51836.36,-1082 51836.36,-1080.29 51836.36,-1080.29"/>
<polygon fill="black" stroke="black" points="51839.86,-1080.29 51836.36,-1070.29 51832.86,-1080.29 51839.86,-1080.29"/>
</g>
<!-- L5_S0_TP6_GPU6_attn_v&#45;&gt;L5_S0_TP6_GPU6_mha_ar -->
<g id="edge1668" class="edge">
<title>L5_S0_TP6_GPU6_attn_v&#45;&gt;L5_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M52652.11,-1116.51C52652.11,-1116.51 52652.11,-1074.64 52652.11,-1074.64"/>
<polygon fill="black" stroke="black" points="52655.61,-1074.64 52652.11,-1064.64 52648.61,-1074.64 52655.61,-1074.64"/>
</g>
<!-- L5_S0_TP6_GPU6_attn_v&#45;&gt;L5_S0_TP7_GPU7_mha_ar -->
<g id="edge1704" class="edge">
<title>L5_S0_TP6_GPU6_attn_v&#45;&gt;L5_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M53239.19,-1116.51C53239.19,-1116.51 53239.19,-1088.96 53239.19,-1088.96"/>
<polygon fill="black" stroke="black" points="53242.69,-1088.96 53239.19,-1078.96 53235.69,-1088.96 53242.69,-1088.96"/>
</g>
<!-- L5_S0_TP7_GPU7_attn_v -->
<g id="node534" class="node">
<title>L5_S0_TP7_GPU7_attn_v</title>
<polygon fill="none" stroke="black" points="54263,-1184.67 53325,-1184.67 53325,-1116.67 54263,-1116.67 54263,-1184.67"/>
<text text-anchor="middle" x="53794" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="53794" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="53794" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="53794" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L5_S0_TP7_GPU7_attn_v&#45;&gt;L5_S0_TP0_GPU0_mha_ar -->
<g id="edge1453" class="edge">
<title>L5_S0_TP7_GPU7_attn_v&#45;&gt;L5_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M53348.81,-1116.49C53348.81,-1106.88 53348.81,-1099 53348.81,-1099 53348.81,-1099 48064.54,-1099 48064.54,-1099 48064.54,-1099 48064.54,-1070.36 48064.54,-1070.36"/>
<polygon fill="black" stroke="black" points="48068.04,-1070.36 48064.54,-1060.36 48061.04,-1070.36 48068.04,-1070.36"/>
</g>
<!-- L5_S0_TP7_GPU7_attn_v&#45;&gt;L5_S0_TP1_GPU1_mha_ar -->
<g id="edge1489" class="edge">
<title>L5_S0_TP7_GPU7_attn_v&#45;&gt;L5_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M53372.62,-1116.49C53372.62,-1106.88 53372.62,-1099 53372.62,-1099 53372.62,-1099 48850.55,-1099 48850.55,-1099 48850.55,-1099 48850.55,-1066.94 48850.55,-1066.94"/>
<polygon fill="black" stroke="black" points="48854.05,-1066.94 48850.55,-1056.94 48847.05,-1066.94 48854.05,-1066.94"/>
</g>
<!-- L5_S0_TP7_GPU7_attn_v&#45;&gt;L5_S0_TP2_GPU2_mha_ar -->
<g id="edge1525" class="edge">
<title>L5_S0_TP7_GPU7_attn_v&#45;&gt;L5_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M53396.43,-1116.49C53396.43,-1106.88 53396.43,-1099 53396.43,-1099 53396.43,-1099 49642.23,-1099 49642.23,-1099 49642.23,-1099 49642.23,-1061.08 49642.23,-1061.08"/>
<polygon fill="black" stroke="black" points="49645.73,-1061.08 49642.23,-1051.08 49638.73,-1061.08 49645.73,-1061.08"/>
</g>
<!-- L5_S0_TP7_GPU7_attn_v&#45;&gt;L5_S0_TP3_GPU3_mha_ar -->
<g id="edge1561" class="edge">
<title>L5_S0_TP7_GPU7_attn_v&#45;&gt;L5_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M53551.49,-1116.41C53551.49,-1060.06 53551.49,-954 53551.49,-954 53551.49,-954 50382.16,-954 50382.16,-954 50382.16,-954 50382.16,-996.85 50382.16,-996.85"/>
<polygon fill="black" stroke="black" points="50378.66,-996.85 50382.16,-1006.85 50385.66,-996.85 50378.66,-996.85"/>
</g>
<!-- L5_S0_TP7_GPU7_attn_v&#45;&gt;L5_S0_TP4_GPU4_mha_ar -->
<g id="edge1597" class="edge">
<title>L5_S0_TP7_GPU7_attn_v&#45;&gt;L5_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M53420.24,-1116.33C53420.24,-1099.17 53420.24,-1082 53420.24,-1082 53420.24,-1082 51101.2,-1082 51101.2,-1082 51101.2,-1082 51101.2,-1076.36 51101.2,-1076.36"/>
<polygon fill="black" stroke="black" points="51104.7,-1076.36 51101.2,-1066.36 51097.7,-1076.36 51104.7,-1076.36"/>
</g>
<!-- L5_S0_TP7_GPU7_attn_v&#45;&gt;L5_S0_TP5_GPU5_mha_ar -->
<g id="edge1633" class="edge">
<title>L5_S0_TP7_GPU7_attn_v&#45;&gt;L5_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M53444.05,-1116.33C53444.05,-1099.17 53444.05,-1082 53444.05,-1082 53444.05,-1082 51906.91,-1082 51906.91,-1082 51906.91,-1082 51906.91,-1070.76 51906.91,-1070.76"/>
<polygon fill="black" stroke="black" points="51910.41,-1070.76 51906.91,-1060.76 51903.41,-1070.76 51910.41,-1070.76"/>
</g>
<!-- L5_S0_TP7_GPU7_attn_v&#45;&gt;L5_S0_TP6_GPU6_mha_ar -->
<g id="edge1669" class="edge">
<title>L5_S0_TP7_GPU7_attn_v&#45;&gt;L5_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M53467.86,-1116.33C53467.86,-1099.17 53467.86,-1082 53467.86,-1082 53467.86,-1082 52699.29,-1082 52699.29,-1082 52699.29,-1082 52699.29,-1066.13 52699.29,-1066.13"/>
<polygon fill="black" stroke="black" points="52702.79,-1066.13 52699.29,-1056.13 52695.79,-1066.13 52702.79,-1066.13"/>
</g>
<!-- L5_S0_TP7_GPU7_attn_v&#45;&gt;L5_S0_TP7_GPU7_mha_ar -->
<g id="edge1705" class="edge">
<title>L5_S0_TP7_GPU7_attn_v&#45;&gt;L5_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M53491.66,-1116.51C53491.66,-1116.51 53491.66,-1059.62 53491.66,-1059.62"/>
<polygon fill="black" stroke="black" points="53495.16,-1059.62 53491.66,-1049.62 53488.16,-1059.62 53495.16,-1059.62"/>
</g>
<!-- L5_S0_TP0_GPU0_gate -->
<g id="node536" class="node">
<title>L5_S0_TP0_GPU0_gate</title>
<polygon fill="none" stroke="black" points="47205.56,-844.5 46363.15,-844.5 46146.44,-708.5 46988.85,-708.5 47205.56,-844.5"/>
<text text-anchor="middle" x="46676" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="46676" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="46676" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="46676" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L5_S0_TP0_GPU0_mha_res&#45;&gt;L5_S0_TP0_GPU0_gate -->
<g id="edge1455" class="edge">
<title>L5_S0_TP0_GPU0_mha_res&#45;&gt;L5_S0_TP0_GPU0_gate</title>
<path fill="none" stroke="black" d="M46676,-880.39C46676,-880.39 46676,-854.73 46676,-854.73"/>
<polygon fill="black" stroke="black" points="46679.5,-854.73 46676,-844.73 46672.5,-854.73 46679.5,-854.73"/>
</g>
<!-- L5_S0_TP0_GPU0_moe_res -->
<g id="node554" class="node">
<title>L5_S0_TP0_GPU0_moe_res</title>
<polygon fill="none" stroke="black" points="46809,-436.33 45989,-436.33 45989,-368.33 46809,-368.33 46809,-436.33"/>
<text text-anchor="middle" x="46399" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="46399" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="46399" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="46399" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP0_GPU0_mha_res&#45;&gt;L5_S0_TP0_GPU0_moe_res -->
<g id="edge1475" class="edge">
<title>L5_S0_TP0_GPU0_mha_res&#45;&gt;L5_S0_TP0_GPU0_moe_res</title>
<path fill="none" stroke="black" d="M46232.25,-903C46138.68,-903 46067.61,-903 46067.61,-903 46067.61,-903 46067.61,-446.35 46067.61,-446.35"/>
<polygon fill="black" stroke="black" points="46071.11,-446.35 46067.61,-436.35 46064.11,-446.35 46071.11,-446.35"/>
</g>
<!-- L5_S0_TP0_GPU0_expert0 -->
<g id="node537" class="node">
<title>L5_S0_TP0_GPU0_expert0</title>
<polygon fill="none" stroke="black" points="47170.5,-672.5 46721.5,-672.5 46721.5,-604.5 47170.5,-604.5 47170.5,-672.5"/>
<text text-anchor="middle" x="46946" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="46946" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="46946" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="46946" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L5_S0_TP0_GPU0_gate&#45;&gt;L5_S0_TP0_GPU0_expert0 -->
<g id="edge1456" class="edge">
<title>L5_S0_TP0_GPU0_gate&#45;&gt;L5_S0_TP0_GPU0_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M46871.17,-708.31C46871.17,-708.31 46871.17,-682.71 46871.17,-682.71"/>
<polygon fill="black" stroke="black" points="46874.67,-682.71 46871.17,-672.71 46867.67,-682.71 46874.67,-682.71"/>
</g>
<!-- L5_S0_TP0_GPU0_expert1 -->
<g id="node538" class="node">
<title>L5_S0_TP0_GPU0_expert1</title>
<polygon fill="none" stroke="black" points="47637.5,-672.5 47188.5,-672.5 47188.5,-604.5 47637.5,-604.5 47637.5,-672.5"/>
<text text-anchor="middle" x="47413" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="47413" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="47413" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="47413" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L5_S0_TP0_GPU0_gate&#45;&gt;L5_S0_TP0_GPU0_expert1 -->
<g id="edge1457" class="edge">
<title>L5_S0_TP0_GPU0_gate&#45;&gt;L5_S0_TP0_GPU0_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M47197.14,-776.4C47197.14,-776.4 47197.14,-682.74 47197.14,-682.74"/>
<polygon fill="black" stroke="black" points="47200.64,-682.74 47197.14,-672.74 47193.64,-682.74 47200.64,-682.74"/>
</g>
<!-- L5_S0_TP0_GPU0_moe_ar -->
<g id="node539" class="node">
<title>L5_S0_TP0_GPU0_moe_ar</title>
<ellipse fill="none" stroke="black" cx="48044" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="48044" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="48044" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="48044" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="48044" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP0_GPU0_expert0&#45;&gt;L5_S0_TP0_GPU0_moe_ar -->
<g id="edge1458" class="edge">
<title>L5_S0_TP0_GPU0_expert0&#45;&gt;L5_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M47125.31,-604.4C47125.31,-576.28 47125.31,-541 47125.31,-541 47125.31,-541 47731.6,-541 47731.6,-541"/>
<polygon fill="black" stroke="black" points="47731.6,-544.5 47741.6,-541 47731.6,-537.5 47731.6,-544.5"/>
</g>
<!-- L5_S0_TP1_GPU1_moe_ar -->
<g id="node563" class="node">
<title>L5_S0_TP1_GPU1_moe_ar</title>
<ellipse fill="none" stroke="black" cx="48731" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="48731" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="48731" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="48731" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="48731" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP0_GPU0_expert0&#45;&gt;L5_S0_TP1_GPU1_moe_ar -->
<g id="edge1494" class="edge">
<title>L5_S0_TP0_GPU0_expert0&#45;&gt;L5_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M47080.12,-604.47C47080.12,-591.6 47080.12,-580 47080.12,-580 47080.12,-580 48412.44,-580 48412.44,-580 48412.44,-580 48412.44,-545.14 48412.44,-545.14"/>
<polygon fill="black" stroke="black" points="48415.94,-545.14 48412.44,-535.14 48408.94,-545.14 48415.94,-545.14"/>
</g>
<!-- L5_S0_TP2_GPU2_moe_ar -->
<g id="node573" class="node">
<title>L5_S0_TP2_GPU2_moe_ar</title>
<ellipse fill="none" stroke="black" cx="49418" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="49418" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="49418" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="49418" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="49418" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP0_GPU0_expert0&#45;&gt;L5_S0_TP2_GPU2_moe_ar -->
<g id="edge1530" class="edge">
<title>L5_S0_TP0_GPU0_expert0&#45;&gt;L5_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M47034.94,-604.38C47034.94,-547.62 47034.94,-440 47034.94,-440 47034.94,-440 49115.27,-440 49115.27,-440 49115.27,-440 49115.27,-489.71 49115.27,-489.71"/>
<polygon fill="black" stroke="black" points="49111.77,-489.71 49115.27,-499.71 49118.77,-489.71 49111.77,-489.71"/>
</g>
<!-- L5_S0_TP3_GPU3_moe_ar -->
<g id="node583" class="node">
<title>L5_S0_TP3_GPU3_moe_ar</title>
<ellipse fill="none" stroke="black" cx="50105" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="50105" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="50105" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="50105" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="50105" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP0_GPU0_expert0&#45;&gt;L5_S0_TP3_GPU3_moe_ar -->
<g id="edge1566" class="edge">
<title>L5_S0_TP0_GPU0_expert0&#45;&gt;L5_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M46989.75,-604.38C46989.75,-547.62 46989.75,-440 46989.75,-440 46989.75,-440 49956.36,-440 49956.36,-440 49956.36,-440 49956.36,-466.91 49956.36,-466.91"/>
<polygon fill="black" stroke="black" points="49952.86,-466.91 49956.36,-476.91 49959.86,-466.91 49952.86,-466.91"/>
</g>
<!-- L5_S0_TP4_GPU4_moe_ar -->
<g id="node593" class="node">
<title>L5_S0_TP4_GPU4_moe_ar</title>
<ellipse fill="none" stroke="black" cx="50792" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="50792" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="50792" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="50792" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="50792" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP0_GPU0_expert0&#45;&gt;L5_S0_TP4_GPU4_moe_ar -->
<g id="edge1602" class="edge">
<title>L5_S0_TP0_GPU0_expert0&#45;&gt;L5_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M46944.56,-604.38C46944.56,-547.62 46944.56,-440 46944.56,-440 46944.56,-440 50785.77,-440 50785.77,-440 50785.77,-440 50785.77,-462.25 50785.77,-462.25"/>
<polygon fill="black" stroke="black" points="50782.27,-462.24 50785.77,-472.25 50789.27,-462.25 50782.27,-462.24"/>
</g>
<!-- L5_S0_TP5_GPU5_moe_ar -->
<g id="node603" class="node">
<title>L5_S0_TP5_GPU5_moe_ar</title>
<ellipse fill="none" stroke="black" cx="51479" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="51479" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="51479" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="51479" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="51479" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP0_GPU0_expert0&#45;&gt;L5_S0_TP5_GPU5_moe_ar -->
<g id="edge1638" class="edge">
<title>L5_S0_TP0_GPU0_expert0&#45;&gt;L5_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M46899.38,-604.38C46899.38,-547.62 46899.38,-440 46899.38,-440 46899.38,-440 51545.89,-440 51545.89,-440 51545.89,-440 51545.89,-463.17 51545.89,-463.17"/>
<polygon fill="black" stroke="black" points="51542.39,-463.17 51545.89,-473.17 51549.39,-463.17 51542.39,-463.17"/>
</g>
<!-- L5_S0_TP6_GPU6_moe_ar -->
<g id="node613" class="node">
<title>L5_S0_TP6_GPU6_moe_ar</title>
<ellipse fill="none" stroke="black" cx="52166" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="52166" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="52166" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="52166" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="52166" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP0_GPU0_expert0&#45;&gt;L5_S0_TP6_GPU6_moe_ar -->
<g id="edge1674" class="edge">
<title>L5_S0_TP0_GPU0_expert0&#45;&gt;L5_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M46854.19,-604.38C46854.19,-547.62 46854.19,-440 46854.19,-440 46854.19,-440 51908.38,-440 51908.38,-440 51908.38,-440 51908.38,-479.56 51908.38,-479.56"/>
<polygon fill="black" stroke="black" points="51904.88,-479.56 51908.38,-489.56 51911.88,-479.56 51904.88,-479.56"/>
</g>
<!-- L5_S0_TP7_GPU7_moe_ar -->
<g id="node623" class="node">
<title>L5_S0_TP7_GPU7_moe_ar</title>
<ellipse fill="none" stroke="black" cx="52853" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="52853" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="52853" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="52853" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="52853" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP0_GPU0_expert0&#45;&gt;L5_S0_TP7_GPU7_moe_ar -->
<g id="edge1710" class="edge">
<title>L5_S0_TP0_GPU0_expert0&#45;&gt;L5_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M47020.83,-672.53C47020.83,-685.4 47020.83,-697 47020.83,-697 47020.83,-697 52789.93,-697 52789.93,-697 52789.93,-697 52789.93,-577.74 52789.93,-577.74"/>
<polygon fill="black" stroke="black" points="52793.43,-577.74 52789.93,-567.74 52786.43,-577.74 52793.43,-577.74"/>
</g>
<!-- L5_S0_TP0_GPU0_expert1&#45;&gt;L5_S0_TP0_GPU0_moe_ar -->
<g id="edge1459" class="edge">
<title>L5_S0_TP0_GPU0_expert1&#45;&gt;L5_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M47575.14,-604.13C47575.14,-580.74 47575.14,-554 47575.14,-554 47575.14,-554 47794.42,-554 47794.42,-554"/>
<polygon fill="black" stroke="black" points="47794.42,-557.5 47804.42,-554 47794.42,-550.5 47794.42,-557.5"/>
</g>
<!-- L5_S0_TP0_GPU0_expert1&#45;&gt;L5_S0_TP1_GPU1_moe_ar -->
<g id="edge1495" class="edge">
<title>L5_S0_TP0_GPU0_expert1&#45;&gt;L5_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M47512.79,-604.47C47512.79,-591.6 47512.79,-580 47512.79,-580 47512.79,-580 48428.35,-580 48428.35,-580 48428.35,-580 48428.35,-550.92 48428.35,-550.92"/>
<polygon fill="black" stroke="black" points="48431.85,-550.92 48428.35,-540.92 48424.85,-550.92 48431.85,-550.92"/>
</g>
<!-- L5_S0_TP0_GPU0_expert1&#45;&gt;L5_S0_TP2_GPU2_moe_ar -->
<g id="edge1531" class="edge">
<title>L5_S0_TP0_GPU0_expert1&#45;&gt;L5_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M47450.43,-604.38C47450.43,-547.62 47450.43,-440 47450.43,-440 47450.43,-440 49099.4,-440 49099.4,-440 49099.4,-440 49099.4,-495.67 49099.4,-495.67"/>
<polygon fill="black" stroke="black" points="49095.9,-495.67 49099.4,-505.67 49102.9,-495.67 49095.9,-495.67"/>
</g>
<!-- L5_S0_TP0_GPU0_expert1&#45;&gt;L5_S0_TP3_GPU3_moe_ar -->
<g id="edge1567" class="edge">
<title>L5_S0_TP0_GPU0_expert1&#45;&gt;L5_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M47499.74,-672.61C47499.74,-684.99 47499.74,-696 47499.74,-696 47499.74,-696 49981.5,-696 49981.5,-696 49981.5,-696 49981.5,-575.18 49981.5,-575.18"/>
<polygon fill="black" stroke="black" points="49985,-575.18 49981.5,-565.18 49978,-575.18 49985,-575.18"/>
</g>
<!-- L5_S0_TP0_GPU0_expert1&#45;&gt;L5_S0_TP4_GPU4_moe_ar -->
<g id="edge1603" class="edge">
<title>L5_S0_TP0_GPU0_expert1&#45;&gt;L5_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M47388.07,-604.38C47388.07,-547.62 47388.07,-440 47388.07,-440 47388.07,-440 50621.65,-440 50621.65,-440 50621.65,-440 50621.65,-468.79 50621.65,-468.79"/>
<polygon fill="black" stroke="black" points="50618.15,-468.79 50621.65,-478.79 50625.15,-468.79 50618.15,-468.79"/>
</g>
<!-- L5_S0_TP0_GPU0_expert1&#45;&gt;L5_S0_TP5_GPU5_moe_ar -->
<g id="edge1639" class="edge">
<title>L5_S0_TP0_GPU0_expert1&#45;&gt;L5_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M47325.71,-604.38C47325.71,-547.62 47325.71,-440 47325.71,-440 47325.71,-440 51412.11,-440 51412.11,-440 51412.11,-440 51412.11,-463.17 51412.11,-463.17"/>
<polygon fill="black" stroke="black" points="51408.61,-463.17 51412.11,-473.17 51415.61,-463.17 51408.61,-463.17"/>
</g>
<!-- L5_S0_TP0_GPU0_expert1&#45;&gt;L5_S0_TP6_GPU6_moe_ar -->
<g id="edge1675" class="edge">
<title>L5_S0_TP0_GPU0_expert1&#45;&gt;L5_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M47263.36,-604.38C47263.36,-547.62 47263.36,-440 47263.36,-440 47263.36,-440 51882.77,-440 51882.77,-440 51882.77,-440 51882.77,-484.53 51882.77,-484.53"/>
<polygon fill="black" stroke="black" points="51879.27,-484.53 51882.77,-494.53 51886.27,-484.53 51879.27,-484.53"/>
</g>
<!-- L5_S0_TP0_GPU0_expert1&#45;&gt;L5_S0_TP7_GPU7_moe_ar -->
<g id="edge1711" class="edge">
<title>L5_S0_TP0_GPU0_expert1&#45;&gt;L5_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M47361.98,-672.53C47361.98,-685.4 47361.98,-697 47361.98,-697 47361.98,-697 52787.36,-697 52787.36,-697 52787.36,-697 52787.36,-577.74 52787.36,-577.74"/>
<polygon fill="black" stroke="black" points="52790.86,-577.74 52787.36,-567.74 52783.86,-577.74 52790.86,-577.74"/>
</g>
<!-- L5_S0_TP0_GPU0_moe_ar&#45;&gt;L5_S0_TP0_GPU0_moe_res -->
<g id="edge1474" class="edge">
<title>L5_S0_TP0_GPU0_moe_ar&#45;&gt;L5_S0_TP0_GPU0_moe_res</title>
<path fill="none" stroke="black" d="M47712.61,-527C47333.72,-527 46765.25,-527 46765.25,-527 46765.25,-527 46765.25,-446.4 46765.25,-446.4"/>
<polygon fill="black" stroke="black" points="46768.75,-446.4 46765.25,-436.4 46761.75,-446.4 46768.75,-446.4"/>
</g>
<!-- L5_S0_TP1_GPU1_expert0 -->
<g id="node540" class="node">
<title>L5_S0_TP1_GPU1_expert0</title>
<polygon fill="none" stroke="black" points="48104.5,-672.5 47655.5,-672.5 47655.5,-604.5 48104.5,-604.5 48104.5,-672.5"/>
<text text-anchor="middle" x="47880" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="47880" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="47880" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="47880" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L5_S0_TP1_GPU1_expert0&#45;&gt;L5_S0_TP0_GPU0_moe_ar -->
<g id="edge1460" class="edge">
<title>L5_S0_TP1_GPU1_expert0&#45;&gt;L5_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M47775.37,-604.34C47775.37,-604.34 47775.37,-559.3 47775.37,-559.3"/>
<polygon fill="black" stroke="black" points="47778.87,-559.3 47775.37,-549.3 47771.87,-559.3 47778.87,-559.3"/>
</g>
<!-- L5_S0_TP1_GPU1_expert0&#45;&gt;L5_S0_TP1_GPU1_moe_ar -->
<g id="edge1496" class="edge">
<title>L5_S0_TP1_GPU1_expert0&#45;&gt;L5_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M47841.19,-604.47C47841.19,-591.6 47841.19,-580 47841.19,-580 47841.19,-580 48444.26,-580 48444.26,-580 48444.26,-580 48444.26,-555.34 48444.26,-555.34"/>
<polygon fill="black" stroke="black" points="48447.76,-555.34 48444.26,-545.34 48440.76,-555.34 48447.76,-555.34"/>
</g>
<!-- L5_S0_TP1_GPU1_expert0&#45;&gt;L5_S0_TP2_GPU2_moe_ar -->
<g id="edge1532" class="edge">
<title>L5_S0_TP1_GPU1_expert0&#45;&gt;L5_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M47907.02,-604.47C47907.02,-591.6 47907.02,-580 47907.02,-580 47907.02,-580 49136.28,-580 49136.28,-580 49136.28,-580 49136.28,-556.38 49136.28,-556.38"/>
<polygon fill="black" stroke="black" points="49139.78,-556.38 49136.28,-546.38 49132.78,-556.38 49139.78,-556.38"/>
</g>
<!-- L5_S0_TP1_GPU1_expert0&#45;&gt;L5_S0_TP3_GPU3_moe_ar -->
<g id="edge1568" class="edge">
<title>L5_S0_TP1_GPU1_expert0&#45;&gt;L5_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M47972.85,-604.47C47972.85,-591.6 47972.85,-580 47972.85,-580 47972.85,-580 49795.78,-580 49795.78,-580 49795.78,-580 49795.78,-548.94 49795.78,-548.94"/>
<polygon fill="black" stroke="black" points="49799.28,-548.94 49795.78,-538.94 49792.28,-548.94 49799.28,-548.94"/>
</g>
<!-- L5_S0_TP1_GPU1_expert0&#45;&gt;L5_S0_TP4_GPU4_moe_ar -->
<g id="edge1604" class="edge">
<title>L5_S0_TP1_GPU1_expert0&#45;&gt;L5_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M47954.83,-672.53C47954.83,-685.4 47954.83,-697 47954.83,-697 47954.83,-697 50915.5,-697 50915.5,-697 50915.5,-697 50915.5,-575.43 50915.5,-575.43"/>
<polygon fill="black" stroke="black" points="50919,-575.43 50915.5,-565.43 50912,-575.43 50919,-575.43"/>
</g>
<!-- L5_S0_TP1_GPU1_expert0&#45;&gt;L5_S0_TP5_GPU5_moe_ar -->
<g id="edge1640" class="edge">
<title>L5_S0_TP1_GPU1_expert0&#45;&gt;L5_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M47691.53,-604.41C47691.53,-554.65 47691.53,-468 47691.53,-468 47691.53,-468 51278.32,-468 51278.32,-468 51278.32,-468 51278.32,-471.77 51278.32,-471.77"/>
<polygon fill="black" stroke="black" points="51274.82,-471.77 51278.32,-481.77 51281.82,-471.77 51274.82,-471.77"/>
</g>
<!-- L5_S0_TP1_GPU1_expert0&#45;&gt;L5_S0_TP6_GPU6_moe_ar -->
<g id="edge1676" class="edge">
<title>L5_S0_TP1_GPU1_expert0&#45;&gt;L5_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M47673.51,-604.41C47673.51,-554.65 47673.51,-468 47673.51,-468 47673.51,-468 51857.15,-468 51857.15,-468 51857.15,-468 51857.15,-491.79 51857.15,-491.79"/>
<polygon fill="black" stroke="black" points="51853.65,-491.79 51857.15,-501.79 51860.65,-491.79 51853.65,-491.79"/>
</g>
<!-- L5_S0_TP1_GPU1_expert0&#45;&gt;L5_S0_TP7_GPU7_moe_ar -->
<g id="edge1712" class="edge">
<title>L5_S0_TP1_GPU1_expert0&#45;&gt;L5_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M48038.67,-604.39C48038.67,-592.01 48038.67,-581 48038.67,-581 48038.67,-581 52546.98,-581 52546.98,-581 52546.98,-581 52546.98,-549.92 52546.98,-549.92"/>
<polygon fill="black" stroke="black" points="52550.48,-549.92 52546.98,-539.92 52543.48,-549.92 52550.48,-549.92"/>
</g>
<!-- L5_S0_TP1_GPU1_expert1 -->
<g id="node541" class="node">
<title>L5_S0_TP1_GPU1_expert1</title>
<polygon fill="none" stroke="black" points="48571.5,-672.5 48122.5,-672.5 48122.5,-604.5 48571.5,-604.5 48571.5,-672.5"/>
<text text-anchor="middle" x="48347" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="48347" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="48347" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="48347" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L5_S0_TP1_GPU1_expert1&#45;&gt;L5_S0_TP0_GPU0_moe_ar -->
<g id="edge1461" class="edge">
<title>L5_S0_TP1_GPU1_expert1&#45;&gt;L5_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M48148.1,-604.34C48148.1,-604.34 48148.1,-576.36 48148.1,-576.36"/>
<polygon fill="black" stroke="black" points="48151.6,-576.36 48148.1,-566.36 48144.6,-576.36 48151.6,-576.36"/>
</g>
<!-- L5_S0_TP1_GPU1_expert1&#45;&gt;L5_S0_TP1_GPU1_moe_ar -->
<g id="edge1497" class="edge">
<title>L5_S0_TP1_GPU1_expert1&#45;&gt;L5_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M48460.16,-604.34C48460.16,-604.34 48460.16,-558.91 48460.16,-558.91"/>
<polygon fill="black" stroke="black" points="48463.66,-558.91 48460.16,-548.91 48456.66,-558.91 48463.66,-558.91"/>
</g>
<!-- L5_S0_TP1_GPU1_expert1&#45;&gt;L5_S0_TP2_GPU2_moe_ar -->
<g id="edge1533" class="edge">
<title>L5_S0_TP1_GPU1_expert1&#45;&gt;L5_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M48491.97,-604.47C48491.97,-591.6 48491.97,-580 48491.97,-580 48491.97,-580 49189.03,-580 49189.03,-580 49189.03,-580 49189.03,-565.77 49189.03,-565.77"/>
<polygon fill="black" stroke="black" points="49192.53,-565.76 49189.03,-555.77 49185.53,-565.77 49192.53,-565.76"/>
</g>
<!-- L5_S0_TP1_GPU1_expert1&#45;&gt;L5_S0_TP3_GPU3_moe_ar -->
<g id="edge1569" class="edge">
<title>L5_S0_TP1_GPU1_expert1&#45;&gt;L5_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M48507.88,-604.47C48507.88,-591.6 48507.88,-580 48507.88,-580 48507.88,-580 49821.03,-580 49821.03,-580 49821.03,-580 49821.03,-556.03 49821.03,-556.03"/>
<polygon fill="black" stroke="black" points="49824.53,-556.03 49821.03,-546.03 49817.53,-556.03 49824.53,-556.03"/>
</g>
<!-- L5_S0_TP1_GPU1_expert1&#45;&gt;L5_S0_TP4_GPU4_moe_ar -->
<g id="edge1605" class="edge">
<title>L5_S0_TP1_GPU1_expert1&#45;&gt;L5_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M48523.78,-604.39C48523.78,-592.01 48523.78,-581 48523.78,-581 48523.78,-581 50502.43,-581 50502.43,-581 50502.43,-581 50502.43,-554.71 50502.43,-554.71"/>
<polygon fill="black" stroke="black" points="50505.93,-554.71 50502.43,-544.71 50498.93,-554.71 50505.93,-554.71"/>
</g>
<!-- L5_S0_TP1_GPU1_expert1&#45;&gt;L5_S0_TP5_GPU5_moe_ar -->
<g id="edge1641" class="edge">
<title>L5_S0_TP1_GPU1_expert1&#45;&gt;L5_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M48436.86,-672.53C48436.86,-685.4 48436.86,-697 48436.86,-697 48436.86,-697 51382.5,-697 51382.5,-697 51382.5,-697 51382.5,-576.81 51382.5,-576.81"/>
<polygon fill="black" stroke="black" points="51386,-576.81 51382.5,-566.81 51379,-576.81 51386,-576.81"/>
</g>
<!-- L5_S0_TP1_GPU1_expert1&#45;&gt;L5_S0_TP6_GPU6_moe_ar -->
<g id="edge1677" class="edge">
<title>L5_S0_TP1_GPU1_expert1&#45;&gt;L5_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M48539.69,-604.39C48539.69,-592.01 48539.69,-581 48539.69,-581 48539.69,-581 51914.62,-581 51914.62,-581 51914.62,-581 51914.62,-562.48 51914.62,-562.48"/>
<polygon fill="black" stroke="black" points="51918.13,-562.48 51914.62,-552.48 51911.13,-562.48 51918.13,-562.48"/>
</g>
<!-- L5_S0_TP1_GPU1_expert1&#45;&gt;L5_S0_TP7_GPU7_moe_ar -->
<g id="edge1713" class="edge">
<title>L5_S0_TP1_GPU1_expert1&#45;&gt;L5_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M48555.59,-604.39C48555.59,-592.01 48555.59,-581 48555.59,-581 48555.59,-581 52603.86,-581 52603.86,-581 52603.86,-581 52603.86,-562.84 52603.86,-562.84"/>
<polygon fill="black" stroke="black" points="52607.36,-562.84 52603.86,-552.84 52600.36,-562.84 52607.36,-562.84"/>
</g>
<!-- L5_S0_TP2_GPU2_expert0 -->
<g id="node542" class="node">
<title>L5_S0_TP2_GPU2_expert0</title>
<polygon fill="none" stroke="black" points="49038.5,-672.5 48589.5,-672.5 48589.5,-604.5 49038.5,-604.5 49038.5,-672.5"/>
<text text-anchor="middle" x="48814" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="48814" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="48814" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="48814" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L5_S0_TP2_GPU2_expert0&#45;&gt;L5_S0_TP0_GPU0_moe_ar -->
<g id="edge1462" class="edge">
<title>L5_S0_TP2_GPU2_expert0&#45;&gt;L5_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M48639.39,-604.39C48639.39,-602.89 48639.39,-602 48639.39,-602 48639.39,-602 48173.69,-602 48173.69,-602 48173.69,-602 48173.69,-575.03 48173.69,-575.03"/>
<polygon fill="black" stroke="black" points="48177.19,-575.03 48173.69,-565.03 48170.19,-575.03 48177.19,-575.03"/>
</g>
<!-- L5_S0_TP2_GPU2_expert0&#45;&gt;L5_S0_TP1_GPU1_moe_ar -->
<g id="edge1498" class="edge">
<title>L5_S0_TP2_GPU2_expert0&#45;&gt;L5_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M48689.28,-604.34C48689.28,-604.34 48689.28,-578.55 48689.28,-578.55"/>
<polygon fill="black" stroke="black" points="48692.78,-578.55 48689.28,-568.55 48685.78,-578.55 48692.78,-578.55"/>
</g>
<!-- L5_S0_TP2_GPU2_expert0&#45;&gt;L5_S0_TP2_GPU2_moe_ar -->
<g id="edge1534" class="edge">
<title>L5_S0_TP2_GPU2_expert0&#45;&gt;L5_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M48838.94,-604.47C48838.94,-591.6 48838.94,-580 48838.94,-580 48838.94,-580 49241.77,-580 49241.77,-580 49241.77,-580 49241.77,-571.47 49241.77,-571.47"/>
<polygon fill="black" stroke="black" points="49245.27,-571.47 49241.77,-561.47 49238.27,-571.47 49245.27,-571.47"/>
</g>
<!-- L5_S0_TP2_GPU2_expert0&#45;&gt;L5_S0_TP3_GPU3_moe_ar -->
<g id="edge1570" class="edge">
<title>L5_S0_TP2_GPU2_expert0&#45;&gt;L5_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M48888.83,-604.47C48888.83,-591.6 48888.83,-580 48888.83,-580 48888.83,-580 49846.27,-580 49846.27,-580 49846.27,-580 49846.27,-560.91 49846.27,-560.91"/>
<polygon fill="black" stroke="black" points="49849.77,-560.91 49846.27,-550.91 49842.77,-560.91 49849.77,-560.91"/>
</g>
<!-- L5_S0_TP2_GPU2_expert0&#45;&gt;L5_S0_TP4_GPU4_moe_ar -->
<g id="edge1606" class="edge">
<title>L5_S0_TP2_GPU2_expert0&#45;&gt;L5_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M48938.72,-604.39C48938.72,-592.01 48938.72,-581 48938.72,-581 48938.72,-581 50547.33,-581 50547.33,-581 50547.33,-581 50547.33,-563.54 50547.33,-563.54"/>
<polygon fill="black" stroke="black" points="50550.83,-563.54 50547.33,-553.54 50543.83,-563.54 50550.83,-563.54"/>
</g>
<!-- L5_S0_TP2_GPU2_expert0&#45;&gt;L5_S0_TP5_GPU5_moe_ar -->
<g id="edge1642" class="edge">
<title>L5_S0_TP2_GPU2_expert0&#45;&gt;L5_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M48988.61,-604.39C48988.61,-592.01 48988.61,-581 48988.61,-581 48988.61,-581 51169.98,-581 51169.98,-581 51169.98,-581 51169.98,-548.92 51169.98,-548.92"/>
<polygon fill="black" stroke="black" points="51173.48,-548.92 51169.98,-538.92 51166.48,-548.92 51173.48,-548.92"/>
</g>
<!-- L5_S0_TP2_GPU2_expert0&#45;&gt;L5_S0_TP6_GPU6_moe_ar -->
<g id="edge1678" class="edge">
<title>L5_S0_TP2_GPU2_expert0&#45;&gt;L5_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M48926.25,-672.61C48926.25,-684.99 48926.25,-696 48926.25,-696 48926.25,-696 51855.5,-696 51855.5,-696 51855.5,-696 51855.5,-548.55 51855.5,-548.55"/>
<polygon fill="black" stroke="black" points="51859,-548.55 51855.5,-538.55 51852,-548.55 51859,-548.55"/>
</g>
<!-- L5_S0_TP2_GPU2_expert0&#45;&gt;L5_S0_TP7_GPU7_moe_ar -->
<g id="edge1714" class="edge">
<title>L5_S0_TP2_GPU2_expert0&#45;&gt;L5_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M48814,-672.61C48814,-684.99 48814,-696 48814,-696 48814,-696 52784.79,-696 52784.79,-696 52784.79,-696 52784.79,-577.93 52784.79,-577.93"/>
<polygon fill="black" stroke="black" points="52788.29,-577.93 52784.79,-567.93 52781.29,-577.93 52788.29,-577.93"/>
</g>
<!-- L5_S0_TP2_GPU2_expert1 -->
<g id="node543" class="node">
<title>L5_S0_TP2_GPU2_expert1</title>
<polygon fill="none" stroke="black" points="49505.5,-672.5 49056.5,-672.5 49056.5,-604.5 49505.5,-604.5 49505.5,-672.5"/>
<text text-anchor="middle" x="49281" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="49281" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="49281" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="49281" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L5_S0_TP2_GPU2_expert1&#45;&gt;L5_S0_TP0_GPU0_moe_ar -->
<g id="edge1463" class="edge">
<title>L5_S0_TP2_GPU2_expert1&#45;&gt;L5_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M49071.49,-604.39C49071.49,-592.01 49071.49,-581 49071.49,-581 49071.49,-581 48199.29,-581 48199.29,-581 48199.29,-581 48199.29,-573.15 48199.29,-573.15"/>
<polygon fill="black" stroke="black" points="48202.79,-573.15 48199.29,-563.15 48195.79,-573.15 48202.79,-573.15"/>
</g>
<!-- L5_S0_TP2_GPU2_expert1&#45;&gt;L5_S0_TP1_GPU1_moe_ar -->
<g id="edge1499" class="edge">
<title>L5_S0_TP2_GPU2_expert1&#45;&gt;L5_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M49060.98,-604.34C49060.98,-604.34 49060.98,-538.63 49060.98,-538.63"/>
<polygon fill="black" stroke="black" points="49064.48,-538.63 49060.98,-528.63 49057.48,-538.63 49064.48,-538.63"/>
</g>
<!-- L5_S0_TP2_GPU2_expert1&#45;&gt;L5_S0_TP2_GPU2_moe_ar -->
<g id="edge1535" class="edge">
<title>L5_S0_TP2_GPU2_expert1&#45;&gt;L5_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M49294.52,-604.34C49294.52,-604.34 49294.52,-575.49 49294.52,-575.49"/>
<polygon fill="black" stroke="black" points="49298.02,-575.49 49294.52,-565.49 49291.02,-575.49 49298.02,-575.49"/>
</g>
<!-- L5_S0_TP2_GPU2_expert1&#45;&gt;L5_S0_TP3_GPU3_moe_ar -->
<g id="edge1571" class="edge">
<title>L5_S0_TP2_GPU2_expert1&#45;&gt;L5_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M49347.26,-604.47C49347.26,-591.6 49347.26,-580 49347.26,-580 49347.26,-580 49871.52,-580 49871.52,-580 49871.52,-580 49871.52,-565.08 49871.52,-565.08"/>
<polygon fill="black" stroke="black" points="49875.02,-565.08 49871.52,-555.08 49868.02,-565.08 49875.02,-565.08"/>
</g>
<!-- L5_S0_TP2_GPU2_expert1&#45;&gt;L5_S0_TP4_GPU4_moe_ar -->
<g id="edge1607" class="edge">
<title>L5_S0_TP2_GPU2_expert1&#45;&gt;L5_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M49400.01,-604.39C49400.01,-592.01 49400.01,-581 49400.01,-581 49400.01,-581 50592.23,-581 50592.23,-581 50592.23,-581 50592.23,-569.13 50592.23,-569.13"/>
<polygon fill="black" stroke="black" points="50595.73,-569.13 50592.23,-559.13 50588.73,-569.13 50595.73,-569.13"/>
</g>
<!-- L5_S0_TP2_GPU2_expert1&#45;&gt;L5_S0_TP5_GPU5_moe_ar -->
<g id="edge1643" class="edge">
<title>L5_S0_TP2_GPU2_expert1&#45;&gt;L5_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M49452.75,-604.39C49452.75,-592.01 49452.75,-581 49452.75,-581 49452.75,-581 51195.42,-581 51195.42,-581 51195.42,-581 51195.42,-556.11 51195.42,-556.11"/>
<polygon fill="black" stroke="black" points="51198.92,-556.11 51195.42,-546.11 51191.92,-556.11 51198.92,-556.11"/>
</g>
<!-- L5_S0_TP2_GPU2_expert1&#45;&gt;L5_S0_TP6_GPU6_moe_ar -->
<g id="edge1679" class="edge">
<title>L5_S0_TP2_GPU2_expert1&#45;&gt;L5_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M49463.74,-672.61C49463.74,-684.99 49463.74,-696 49463.74,-696 49463.74,-696 51852.5,-696 51852.5,-696 51852.5,-696 51852.5,-547.25 51852.5,-547.25"/>
<polygon fill="black" stroke="black" points="51856,-547.25 51852.5,-537.25 51849,-547.25 51856,-547.25"/>
</g>
<!-- L5_S0_TP2_GPU2_expert1&#45;&gt;L5_S0_TP7_GPU7_moe_ar -->
<g id="edge1715" class="edge">
<title>L5_S0_TP2_GPU2_expert1&#45;&gt;L5_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M49421.98,-672.61C49421.98,-684.99 49421.98,-696 49421.98,-696 49421.98,-696 52782.21,-696 52782.21,-696 52782.21,-696 52782.21,-577.47 52782.21,-577.47"/>
<polygon fill="black" stroke="black" points="52785.71,-577.47 52782.21,-567.47 52778.71,-577.47 52785.71,-577.47"/>
</g>
<!-- L5_S0_TP3_GPU3_expert0 -->
<g id="node544" class="node">
<title>L5_S0_TP3_GPU3_expert0</title>
<polygon fill="none" stroke="black" points="49972.5,-672.5 49523.5,-672.5 49523.5,-604.5 49972.5,-604.5 49972.5,-672.5"/>
<text text-anchor="middle" x="49748" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="49748" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="49748" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="49748" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L5_S0_TP3_GPU3_expert0&#45;&gt;L5_S0_TP0_GPU0_moe_ar -->
<g id="edge1464" class="edge">
<title>L5_S0_TP3_GPU3_expert0&#45;&gt;L5_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M49552.12,-604.39C49552.12,-592.01 49552.12,-581 49552.12,-581 49552.12,-581 48224.88,-581 48224.88,-581 48224.88,-581 48224.88,-571.16 48224.88,-571.16"/>
<polygon fill="black" stroke="black" points="48228.38,-571.16 48224.88,-561.16 48221.38,-571.16 48228.38,-571.16"/>
</g>
<!-- L5_S0_TP3_GPU3_expert0&#45;&gt;L5_S0_TP1_GPU1_moe_ar -->
<g id="edge1500" class="edge">
<title>L5_S0_TP3_GPU3_expert0&#45;&gt;L5_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M49580.74,-604.39C49580.74,-592.01 49580.74,-581 49580.74,-581 49580.74,-581 49051.36,-581 49051.36,-581 49051.36,-581 49051.36,-544.47 49051.36,-544.47"/>
<polygon fill="black" stroke="black" points="49054.86,-544.47 49051.36,-534.47 49047.86,-544.47 49054.86,-544.47"/>
</g>
<!-- L5_S0_TP3_GPU3_expert0&#45;&gt;L5_S0_TP2_GPU2_moe_ar -->
<g id="edge1536" class="edge">
<title>L5_S0_TP3_GPU3_expert0&#45;&gt;L5_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M49609.36,-604.34C49609.36,-604.34 49609.36,-569.91 49609.36,-569.91"/>
<polygon fill="black" stroke="black" points="49612.86,-569.91 49609.36,-559.91 49605.86,-569.91 49612.86,-569.91"/>
</g>
<!-- L5_S0_TP3_GPU3_expert0&#45;&gt;L5_S0_TP3_GPU3_moe_ar -->
<g id="edge1572" class="edge">
<title>L5_S0_TP3_GPU3_expert0&#45;&gt;L5_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M49896.76,-604.34C49896.76,-604.34 49896.76,-568.22 49896.76,-568.22"/>
<polygon fill="black" stroke="black" points="49900.26,-568.22 49896.76,-558.22 49893.26,-568.22 49900.26,-568.22"/>
</g>
<!-- L5_S0_TP3_GPU3_expert0&#45;&gt;L5_S0_TP4_GPU4_moe_ar -->
<g id="edge1608" class="edge">
<title>L5_S0_TP3_GPU3_expert0&#45;&gt;L5_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M49922.01,-604.39C49922.01,-592.01 49922.01,-581 49922.01,-581 49922.01,-581 50682.02,-581 50682.02,-581 50682.02,-581 50682.02,-576.02 50682.02,-576.02"/>
<polygon fill="black" stroke="black" points="50685.52,-576.02 50682.02,-566.02 50678.52,-576.02 50685.52,-576.02"/>
</g>
<!-- L5_S0_TP3_GPU3_expert0&#45;&gt;L5_S0_TP5_GPU5_moe_ar -->
<g id="edge1644" class="edge">
<title>L5_S0_TP3_GPU3_expert0&#45;&gt;L5_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M49947.25,-604.39C49947.25,-592.01 49947.25,-581 49947.25,-581 49947.25,-581 51220.86,-581 51220.86,-581 51220.86,-581 51220.86,-561.06 51220.86,-561.06"/>
<polygon fill="black" stroke="black" points="51224.36,-561.06 51220.86,-551.06 51217.36,-561.06 51224.36,-561.06"/>
</g>
<!-- L5_S0_TP3_GPU3_expert0&#45;&gt;L5_S0_TP6_GPU6_moe_ar -->
<g id="edge1680" class="edge">
<title>L5_S0_TP3_GPU3_expert0&#45;&gt;L5_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M49860.25,-672.61C49860.25,-684.99 49860.25,-696 49860.25,-696 49860.25,-696 51849.5,-696 51849.5,-696 51849.5,-696 51849.5,-546 51849.5,-546"/>
<polygon fill="black" stroke="black" points="51853,-546 51849.5,-536 51846,-546 51853,-546"/>
</g>
<!-- L5_S0_TP3_GPU3_expert0&#45;&gt;L5_S0_TP7_GPU7_moe_ar -->
<g id="edge1716" class="edge">
<title>L5_S0_TP3_GPU3_expert0&#45;&gt;L5_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M49748,-672.61C49748,-684.99 49748,-696 49748,-696 49748,-696 52779.64,-696 52779.64,-696 52779.64,-696 52779.64,-577.47 52779.64,-577.47"/>
<polygon fill="black" stroke="black" points="52783.14,-577.47 52779.64,-567.47 52776.14,-577.47 52783.14,-577.47"/>
</g>
<!-- L5_S0_TP3_GPU3_expert1 -->
<g id="node545" class="node">
<title>L5_S0_TP3_GPU3_expert1</title>
<polygon fill="none" stroke="black" points="50439.5,-672.5 49990.5,-672.5 49990.5,-604.5 50439.5,-604.5 50439.5,-672.5"/>
<text text-anchor="middle" x="50215" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="50215" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="50215" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="50215" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L5_S0_TP3_GPU3_expert1&#45;&gt;L5_S0_TP0_GPU0_moe_ar -->
<g id="edge1465" class="edge">
<title>L5_S0_TP3_GPU3_expert1&#45;&gt;L5_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M50040.38,-604.39C50040.38,-592.01 50040.38,-581 50040.38,-581 50040.38,-581 48250.48,-581 48250.48,-581 48250.48,-581 48250.48,-568.44 48250.48,-568.44"/>
<polygon fill="black" stroke="black" points="48253.98,-568.44 48250.48,-558.44 48246.98,-568.44 48253.98,-568.44"/>
</g>
<!-- L5_S0_TP3_GPU3_expert1&#45;&gt;L5_S0_TP1_GPU1_moe_ar -->
<g id="edge1501" class="edge">
<title>L5_S0_TP3_GPU3_expert1&#45;&gt;L5_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M50090.27,-604.39C50090.27,-592.01 50090.27,-581 50090.27,-581 50090.27,-581 49053.93,-581 49053.93,-581 49053.93,-581 49053.93,-542.97 49053.93,-542.97"/>
<polygon fill="black" stroke="black" points="49057.43,-542.97 49053.93,-532.97 49050.43,-542.97 49057.43,-542.97"/>
</g>
<!-- L5_S0_TP3_GPU3_expert1&#45;&gt;L5_S0_TP2_GPU2_moe_ar -->
<g id="edge1537" class="edge">
<title>L5_S0_TP3_GPU3_expert1&#45;&gt;L5_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M50140.15,-604.39C50140.15,-592.01 50140.15,-581 50140.15,-581 50140.15,-581 49637.98,-581 49637.98,-581 49637.98,-581 49637.98,-566.71 49637.98,-566.71"/>
<polygon fill="black" stroke="black" points="49641.48,-566.71 49637.98,-556.71 49634.48,-566.71 49641.48,-566.71"/>
</g>
<!-- L5_S0_TP3_GPU3_expert1&#45;&gt;L5_S0_TP3_GPU3_moe_ar -->
<g id="edge1573" class="edge">
<title>L5_S0_TP3_GPU3_expert1&#45;&gt;L5_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M50190.04,-604.34C50190.04,-604.34 50190.04,-577.23 50190.04,-577.23"/>
<polygon fill="black" stroke="black" points="50193.54,-577.23 50190.04,-567.23 50186.54,-577.23 50193.54,-577.23"/>
</g>
<!-- L5_S0_TP3_GPU3_expert1&#45;&gt;L5_S0_TP4_GPU4_moe_ar -->
<g id="edge1609" class="edge">
<title>L5_S0_TP3_GPU3_expert1&#45;&gt;L5_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M50439.54,-627C50445.95,-627 50449.62,-627 50449.62,-627 50449.62,-627 50449.62,-504 50449.62,-504 50449.62,-504 50467.35,-504 50467.35,-504"/>
<polygon fill="black" stroke="black" points="50467.35,-507.5 50477.35,-504 50467.35,-500.5 50467.35,-507.5"/>
</g>
<!-- L5_S0_TP3_GPU3_expert1&#45;&gt;L5_S0_TP5_GPU5_moe_ar -->
<g id="edge1645" class="edge">
<title>L5_S0_TP3_GPU3_expert1&#45;&gt;L5_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M50239.92,-604.39C50239.92,-592.01 50239.92,-581 50239.92,-581 50239.92,-581 51246.3,-581 51246.3,-581 51246.3,-581 51246.3,-564.96 51246.3,-564.96"/>
<polygon fill="black" stroke="black" points="51249.8,-564.96 51246.3,-554.96 51242.8,-564.96 51249.8,-564.96"/>
</g>
<!-- L5_S0_TP3_GPU3_expert1&#45;&gt;L5_S0_TP6_GPU6_moe_ar -->
<g id="edge1681" class="edge">
<title>L5_S0_TP3_GPU3_expert1&#45;&gt;L5_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M50327.25,-672.67C50327.25,-684.57 50327.25,-695 50327.25,-695 50327.25,-695 51846.5,-695 51846.5,-695 51846.5,-695 51846.5,-544.7 51846.5,-544.7"/>
<polygon fill="black" stroke="black" points="51850,-544.7 51846.5,-534.7 51843,-544.7 51850,-544.7"/>
</g>
<!-- L5_S0_TP3_GPU3_expert1&#45;&gt;L5_S0_TP7_GPU7_moe_ar -->
<g id="edge1717" class="edge">
<title>L5_S0_TP3_GPU3_expert1&#45;&gt;L5_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M50215,-672.61C50215,-684.99 50215,-696 50215,-696 50215,-696 52777.07,-696 52777.07,-696 52777.07,-696 52777.07,-577.47 52777.07,-577.47"/>
<polygon fill="black" stroke="black" points="52780.57,-577.47 52777.07,-567.47 52773.57,-577.47 52780.57,-577.47"/>
</g>
<!-- L5_S0_TP4_GPU4_expert0 -->
<g id="node546" class="node">
<title>L5_S0_TP4_GPU4_expert0</title>
<polygon fill="none" stroke="black" points="50906.5,-672.5 50457.5,-672.5 50457.5,-604.5 50906.5,-604.5 50906.5,-672.5"/>
<text text-anchor="middle" x="50682" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="50682" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="50682" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="50682" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L5_S0_TP4_GPU4_expert0&#45;&gt;L5_S0_TP0_GPU0_moe_ar -->
<g id="edge1466" class="edge">
<title>L5_S0_TP4_GPU4_expert0&#45;&gt;L5_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M50682.36,-672.61C50682.36,-684.99 50682.36,-696 50682.36,-696 50682.36,-696 48118,-696 48118,-696 48118,-696 48118,-577.47 48118,-577.47"/>
<polygon fill="black" stroke="black" points="48121.5,-577.47 48118,-567.47 48114.5,-577.47 48121.5,-577.47"/>
</g>
<!-- L5_S0_TP4_GPU4_expert0&#45;&gt;L5_S0_TP1_GPU1_moe_ar -->
<g id="edge1502" class="edge">
<title>L5_S0_TP4_GPU4_expert0&#45;&gt;L5_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M50570.29,-672.54C50570.29,-674.68 50570.29,-676 50570.29,-676 50570.29,-676 49046.21,-676 49046.21,-676 49046.21,-676 49046.21,-546.77 49046.21,-546.77"/>
<polygon fill="black" stroke="black" points="49049.71,-546.77 49046.21,-536.77 49042.71,-546.77 49049.71,-546.77"/>
</g>
<!-- L5_S0_TP4_GPU4_expert0&#45;&gt;L5_S0_TP2_GPU2_moe_ar -->
<g id="edge1538" class="edge">
<title>L5_S0_TP4_GPU4_expert0&#45;&gt;L5_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M50637.12,-604.39C50637.12,-592.01 50637.12,-581 50637.12,-581 50637.12,-581 49666.6,-581 49666.6,-581 49666.6,-581 49666.6,-562.84 49666.6,-562.84"/>
<polygon fill="black" stroke="black" points="49670.1,-562.84 49666.6,-552.84 49663.1,-562.84 49670.1,-562.84"/>
</g>
<!-- L5_S0_TP4_GPU4_expert0&#45;&gt;L5_S0_TP3_GPU3_moe_ar -->
<g id="edge1574" class="edge">
<title>L5_S0_TP4_GPU4_expert0&#45;&gt;L5_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M50457.25,-649C50450.83,-649 50447.16,-649 50447.16,-649 50447.16,-649 50447.16,-536 50447.16,-536 50447.16,-536 50431.44,-536 50431.44,-536"/>
<polygon fill="black" stroke="black" points="50431.44,-532.5 50421.44,-536 50431.44,-539.5 50431.44,-532.5"/>
</g>
<!-- L5_S0_TP4_GPU4_expert0&#45;&gt;L5_S0_TP4_GPU4_moe_ar -->
<g id="edge1610" class="edge">
<title>L5_S0_TP4_GPU4_expert0&#45;&gt;L5_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M50726.92,-604.34C50726.92,-604.34 50726.92,-577.67 50726.92,-577.67"/>
<polygon fill="black" stroke="black" points="50730.42,-577.67 50726.92,-567.67 50723.42,-577.67 50730.42,-577.67"/>
</g>
<!-- L5_S0_TP4_GPU4_expert0&#45;&gt;L5_S0_TP5_GPU5_moe_ar -->
<g id="edge1646" class="edge">
<title>L5_S0_TP4_GPU4_expert0&#45;&gt;L5_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M50771.81,-604.39C50771.81,-602.89 50771.81,-602 50771.81,-602 50771.81,-602 51271.74,-602 51271.74,-602 51271.74,-602 51271.74,-568.34 51271.74,-568.34"/>
<polygon fill="black" stroke="black" points="51275.24,-568.34 51271.74,-558.34 51268.24,-568.34 51275.24,-568.34"/>
</g>
<!-- L5_S0_TP4_GPU4_expert0&#45;&gt;L5_S0_TP6_GPU6_moe_ar -->
<g id="edge1682" class="edge">
<title>L5_S0_TP4_GPU4_expert0&#45;&gt;L5_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M50816.71,-604.39C50816.71,-602.89 50816.71,-602 50816.71,-602 50816.71,-602 51843.5,-602 51843.5,-602 51843.5,-602 51843.5,-543.16 51843.5,-543.16"/>
<polygon fill="black" stroke="black" points="51847,-543.16 51843.5,-533.16 51840,-543.16 51847,-543.16"/>
</g>
<!-- L5_S0_TP4_GPU4_expert0&#45;&gt;L5_S0_TP7_GPU7_moe_ar -->
<g id="edge1718" class="edge">
<title>L5_S0_TP4_GPU4_expert0&#45;&gt;L5_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M50861.6,-604.39C50861.6,-602.89 50861.6,-602 50861.6,-602 50861.6,-602 52632.3,-602 52632.3,-602 52632.3,-602 52632.3,-566.91 52632.3,-566.91"/>
<polygon fill="black" stroke="black" points="52635.8,-566.91 52632.3,-556.91 52628.8,-566.91 52635.8,-566.91"/>
</g>
<!-- L5_S0_TP4_GPU4_expert1 -->
<g id="node547" class="node">
<title>L5_S0_TP4_GPU4_expert1</title>
<polygon fill="none" stroke="black" points="51373.5,-672.5 50924.5,-672.5 50924.5,-604.5 51373.5,-604.5 51373.5,-672.5"/>
<text text-anchor="middle" x="51149" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="51149" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="51149" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="51149" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L5_S0_TP4_GPU4_expert1&#45;&gt;L5_S0_TP0_GPU0_moe_ar -->
<g id="edge1467" class="edge">
<title>L5_S0_TP4_GPU4_expert1&#45;&gt;L5_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M51135.5,-604.2C51135.5,-554.67 51135.5,-469 51135.5,-469 51135.5,-469 48352.73,-469 48352.73,-469 48352.73,-469 48352.73,-491.85 48352.73,-491.85"/>
<polygon fill="black" stroke="black" points="48349.23,-491.85 48352.73,-501.85 48356.23,-491.85 48349.23,-491.85"/>
</g>
<!-- L5_S0_TP4_GPU4_expert1&#45;&gt;L5_S0_TP1_GPU1_moe_ar -->
<g id="edge1503" class="edge">
<title>L5_S0_TP4_GPU4_expert1&#45;&gt;L5_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M51074.17,-672.54C51074.17,-674.68 51074.17,-676 51074.17,-676 51074.17,-676 49043.64,-676 49043.64,-676 49043.64,-676 49043.64,-547.66 49043.64,-547.66"/>
<polygon fill="black" stroke="black" points="49047.14,-547.66 49043.64,-537.66 49040.14,-547.66 49047.14,-547.66"/>
</g>
<!-- L5_S0_TP4_GPU4_expert1&#45;&gt;L5_S0_TP2_GPU2_moe_ar -->
<g id="edge1539" class="edge">
<title>L5_S0_TP4_GPU4_expert1&#45;&gt;L5_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M50949.75,-604.39C50949.75,-592.01 50949.75,-581 50949.75,-581 50949.75,-581 49695.22,-581 49695.22,-581 49695.22,-581 49695.22,-557.52 49695.22,-557.52"/>
<polygon fill="black" stroke="black" points="49698.72,-557.52 49695.22,-547.52 49691.72,-557.52 49698.72,-557.52"/>
</g>
<!-- L5_S0_TP4_GPU4_expert1&#45;&gt;L5_S0_TP3_GPU3_moe_ar -->
<g id="edge1575" class="edge">
<title>L5_S0_TP4_GPU4_expert1&#45;&gt;L5_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M50974.99,-604.39C50974.99,-592.01 50974.99,-581 50974.99,-581 50974.99,-581 50289.81,-581 50289.81,-581 50289.81,-581 50289.81,-570.83 50289.81,-570.83"/>
<polygon fill="black" stroke="black" points="50293.31,-570.83 50289.81,-560.83 50286.31,-570.83 50293.31,-570.83"/>
</g>
<!-- L5_S0_TP4_GPU4_expert1&#45;&gt;L5_S0_TP4_GPU4_moe_ar -->
<g id="edge1611" class="edge">
<title>L5_S0_TP4_GPU4_expert1&#45;&gt;L5_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M51000.24,-604.34C51000.24,-604.34 51000.24,-568.22 51000.24,-568.22"/>
<polygon fill="black" stroke="black" points="51003.74,-568.22 51000.24,-558.22 50996.74,-568.22 51003.74,-568.22"/>
</g>
<!-- L5_S0_TP4_GPU4_expert1&#45;&gt;L5_S0_TP5_GPU5_moe_ar -->
<g id="edge1647" class="edge">
<title>L5_S0_TP4_GPU4_expert1&#45;&gt;L5_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M51297.18,-604.34C51297.18,-604.34 51297.18,-571.18 51297.18,-571.18"/>
<polygon fill="black" stroke="black" points="51300.68,-571.18 51297.18,-561.18 51293.68,-571.18 51300.68,-571.18"/>
</g>
<!-- L5_S0_TP4_GPU4_expert1&#45;&gt;L5_S0_TP6_GPU6_moe_ar -->
<g id="edge1683" class="edge">
<title>L5_S0_TP4_GPU4_expert1&#45;&gt;L5_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M51322.62,-604.39C51322.62,-602.89 51322.62,-602 51322.62,-602 51322.62,-602 51834.53,-602 51834.53,-602 51834.53,-602 51834.53,-537.09 51834.53,-537.09"/>
<polygon fill="black" stroke="black" points="51838.03,-537.09 51834.53,-527.09 51831.03,-537.09 51838.03,-537.09"/>
</g>
<!-- L5_S0_TP4_GPU4_expert1&#45;&gt;L5_S0_TP7_GPU7_moe_ar -->
<g id="edge1719" class="edge">
<title>L5_S0_TP4_GPU4_expert1&#45;&gt;L5_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M51348.06,-604.39C51348.06,-602.89 51348.06,-602 51348.06,-602 51348.06,-602 52660.74,-602 52660.74,-602 52660.74,-602 52660.74,-569.77 52660.74,-569.77"/>
<polygon fill="black" stroke="black" points="52664.24,-569.77 52660.74,-559.77 52657.24,-569.77 52664.24,-569.77"/>
</g>
<!-- L5_S0_TP5_GPU5_expert0 -->
<g id="node548" class="node">
<title>L5_S0_TP5_GPU5_expert0</title>
<polygon fill="none" stroke="black" points="51840.5,-672.5 51391.5,-672.5 51391.5,-604.5 51840.5,-604.5 51840.5,-672.5"/>
<text text-anchor="middle" x="51616" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="51616" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="51616" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="51616" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L5_S0_TP5_GPU5_expert0&#45;&gt;L5_S0_TP0_GPU0_moe_ar -->
<g id="edge1468" class="edge">
<title>L5_S0_TP5_GPU5_expert0&#45;&gt;L5_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M51475.69,-672.53C51475.69,-685.4 51475.69,-697 51475.69,-697 51475.69,-697 48113.5,-697 48113.5,-697 48113.5,-697 48113.5,-577.74 48113.5,-577.74"/>
<polygon fill="black" stroke="black" points="48117,-577.74 48113.5,-567.74 48110,-577.74 48117,-577.74"/>
</g>
<!-- L5_S0_TP5_GPU5_expert0&#45;&gt;L5_S0_TP1_GPU1_moe_ar -->
<g id="edge1504" class="edge">
<title>L5_S0_TP5_GPU5_expert0&#45;&gt;L5_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M51433.59,-672.54C51433.59,-674.68 51433.59,-676 51433.59,-676 51433.59,-676 49041.07,-676 49041.07,-676 49041.07,-676 49041.07,-548.57 49041.07,-548.57"/>
<polygon fill="black" stroke="black" points="49044.57,-548.57 49041.07,-538.57 49037.57,-548.57 49044.57,-548.57"/>
</g>
<!-- L5_S0_TP5_GPU5_expert0&#45;&gt;L5_S0_TP2_GPU2_moe_ar -->
<g id="edge1540" class="edge">
<title>L5_S0_TP5_GPU5_expert0&#45;&gt;L5_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M51433.7,-604.39C51433.7,-592.01 51433.7,-581 51433.7,-581 51433.7,-581 49723.84,-581 49723.84,-581 49723.84,-581 49723.84,-549.92 49723.84,-549.92"/>
<polygon fill="black" stroke="black" points="49727.34,-549.92 49723.84,-539.92 49720.34,-549.92 49727.34,-549.92"/>
</g>
<!-- L5_S0_TP5_GPU5_expert0&#45;&gt;L5_S0_TP3_GPU3_moe_ar -->
<g id="edge1576" class="edge">
<title>L5_S0_TP5_GPU5_expert0&#45;&gt;L5_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M51475.89,-604.47C51475.89,-591.6 51475.89,-580 51475.89,-580 51475.89,-580 50339.69,-580 50339.69,-580 50339.69,-580 50339.69,-564.73 50339.69,-564.73"/>
<polygon fill="black" stroke="black" points="50343.19,-564.73 50339.69,-554.73 50336.19,-564.73 50343.19,-564.73"/>
</g>
<!-- L5_S0_TP5_GPU5_expert0&#45;&gt;L5_S0_TP4_GPU4_moe_ar -->
<g id="edge1612" class="edge">
<title>L5_S0_TP5_GPU5_expert0&#45;&gt;L5_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M51518.09,-604.47C51518.09,-591.6 51518.09,-580 51518.09,-580 51518.09,-580 51025.48,-580 51025.48,-580 51025.48,-580 51025.48,-565.08 51025.48,-565.08"/>
<polygon fill="black" stroke="black" points="51028.98,-565.08 51025.48,-555.08 51021.98,-565.08 51028.98,-565.08"/>
</g>
<!-- L5_S0_TP5_GPU5_expert0&#45;&gt;L5_S0_TP5_GPU5_moe_ar -->
<g id="edge1648" class="edge">
<title>L5_S0_TP5_GPU5_expert0&#45;&gt;L5_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M51560.28,-604.34C51560.28,-604.34 51560.28,-577.23 51560.28,-577.23"/>
<polygon fill="black" stroke="black" points="51563.78,-577.23 51560.28,-567.23 51556.78,-577.23 51563.78,-577.23"/>
</g>
<!-- L5_S0_TP5_GPU5_expert0&#45;&gt;L5_S0_TP6_GPU6_moe_ar -->
<g id="edge1684" class="edge">
<title>L5_S0_TP5_GPU5_expert0&#45;&gt;L5_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M51837.51,-604.34C51837.51,-604.34 51837.51,-539.61 51837.51,-539.61"/>
<polygon fill="black" stroke="black" points="51841.01,-539.61 51837.51,-529.61 51834.01,-539.61 51841.01,-539.61"/>
</g>
<!-- L5_S0_TP5_GPU5_expert0&#45;&gt;L5_S0_TP7_GPU7_moe_ar -->
<g id="edge1720" class="edge">
<title>L5_S0_TP5_GPU5_expert0&#45;&gt;L5_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M51822.5,-604.39C51822.5,-602.89 51822.5,-602 51822.5,-602 51822.5,-602 52689.18,-602 52689.18,-602 52689.18,-602 52689.18,-572.64 52689.18,-572.64"/>
<polygon fill="black" stroke="black" points="52692.68,-572.64 52689.18,-562.64 52685.68,-572.64 52692.68,-572.64"/>
</g>
<!-- L5_S0_TP5_GPU5_expert1 -->
<g id="node549" class="node">
<title>L5_S0_TP5_GPU5_expert1</title>
<polygon fill="none" stroke="black" points="52307.5,-672.5 51858.5,-672.5 51858.5,-604.5 52307.5,-604.5 52307.5,-672.5"/>
<text text-anchor="middle" x="52083" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="52083" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="52083" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="52083" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L5_S0_TP5_GPU5_expert1&#45;&gt;L5_S0_TP0_GPU0_moe_ar -->
<g id="edge1469" class="edge">
<title>L5_S0_TP5_GPU5_expert1&#45;&gt;L5_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M52083,-672.53C52083,-685.4 52083,-697 52083,-697 52083,-697 48109,-697 48109,-697 48109,-697 48109,-577.74 48109,-577.74"/>
<polygon fill="black" stroke="black" points="48112.5,-577.74 48109,-567.74 48105.5,-577.74 48112.5,-577.74"/>
</g>
<!-- L5_S0_TP5_GPU5_expert1&#45;&gt;L5_S0_TP1_GPU1_moe_ar -->
<g id="edge1505" class="edge">
<title>L5_S0_TP5_GPU5_expert1&#45;&gt;L5_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M51970.75,-604.39C51970.75,-592.01 51970.75,-581 51970.75,-581 51970.75,-581 48739.17,-581 48739.17,-581 48739.17,-581 48739.17,-578.74 48739.17,-578.74"/>
<polygon fill="black" stroke="black" points="48742.67,-578.74 48739.17,-568.74 48735.67,-578.74 48742.67,-578.74"/>
</g>
<!-- L5_S0_TP5_GPU5_expert1&#45;&gt;L5_S0_TP2_GPU2_moe_ar -->
<g id="edge1541" class="edge">
<title>L5_S0_TP5_GPU5_expert1&#45;&gt;L5_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M51970.75,-672.61C51970.75,-684.99 51970.75,-696 51970.75,-696 51970.75,-696 49514.5,-696 49514.5,-696 49514.5,-696 49514.5,-576.55 49514.5,-576.55"/>
<polygon fill="black" stroke="black" points="49518,-576.55 49514.5,-566.55 49511,-576.55 49518,-576.55"/>
</g>
<!-- L5_S0_TP5_GPU5_expert1&#45;&gt;L5_S0_TP3_GPU3_moe_ar -->
<g id="edge1577" class="edge">
<title>L5_S0_TP5_GPU5_expert1&#45;&gt;L5_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M52026.88,-604.47C52026.88,-591.6 52026.88,-580 52026.88,-580 52026.88,-580 50389.58,-580 50389.58,-580 50389.58,-580 50389.58,-555.69 50389.58,-555.69"/>
<polygon fill="black" stroke="black" points="50393.08,-555.69 50389.58,-545.69 50386.08,-555.69 50393.08,-555.69"/>
</g>
<!-- L5_S0_TP5_GPU5_expert1&#45;&gt;L5_S0_TP4_GPU4_moe_ar -->
<g id="edge1613" class="edge">
<title>L5_S0_TP5_GPU5_expert1&#45;&gt;L5_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M52083,-604.47C52083,-591.6 52083,-580 52083,-580 52083,-580 51050.73,-580 51050.73,-580 51050.73,-580 51050.73,-560.91 51050.73,-560.91"/>
<polygon fill="black" stroke="black" points="51054.23,-560.91 51050.73,-550.91 51047.23,-560.91 51054.23,-560.91"/>
</g>
<!-- L5_S0_TP5_GPU5_expert1&#45;&gt;L5_S0_TP5_GPU5_moe_ar -->
<g id="edge1649" class="edge">
<title>L5_S0_TP5_GPU5_expert1&#45;&gt;L5_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M52139.12,-604.47C52139.12,-591.6 52139.12,-580 52139.12,-580 52139.12,-580 51602.48,-580 51602.48,-580 51602.48,-580 51602.48,-575.27 51602.48,-575.27"/>
<polygon fill="black" stroke="black" points="51605.98,-575.27 51602.48,-565.27 51598.98,-575.27 51605.98,-575.27"/>
</g>
<!-- L5_S0_TP5_GPU5_expert1&#45;&gt;L5_S0_TP6_GPU6_moe_ar -->
<g id="edge1685" class="edge">
<title>L5_S0_TP5_GPU5_expert1&#45;&gt;L5_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M52195.25,-604.34C52195.25,-604.34 52195.25,-578.55 52195.25,-578.55"/>
<polygon fill="black" stroke="black" points="52198.75,-578.55 52195.25,-568.55 52191.75,-578.55 52198.75,-578.55"/>
</g>
<!-- L5_S0_TP5_GPU5_expert1&#45;&gt;L5_S0_TP7_GPU7_moe_ar -->
<g id="edge1721" class="edge">
<title>L5_S0_TP5_GPU5_expert1&#45;&gt;L5_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M52251.38,-604.39C52251.38,-602.89 52251.38,-602 52251.38,-602 52251.38,-602 52717.62,-602 52717.62,-602 52717.62,-602 52717.62,-574.55 52717.62,-574.55"/>
<polygon fill="black" stroke="black" points="52721.12,-574.55 52717.62,-564.55 52714.12,-574.55 52721.12,-574.55"/>
</g>
<!-- L5_S0_TP6_GPU6_expert0 -->
<g id="node550" class="node">
<title>L5_S0_TP6_GPU6_expert0</title>
<polygon fill="none" stroke="black" points="52774.5,-672.5 52325.5,-672.5 52325.5,-604.5 52774.5,-604.5 52774.5,-672.5"/>
<text text-anchor="middle" x="52550" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="52550" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="52550" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="52550" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L5_S0_TP6_GPU6_expert0&#45;&gt;L5_S0_TP0_GPU0_moe_ar -->
<g id="edge1470" class="edge">
<title>L5_S0_TP6_GPU6_expert0&#45;&gt;L5_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M52575.42,-604.39C52575.42,-592.01 52575.42,-581 52575.42,-581 52575.42,-581 48276.08,-581 48276.08,-581 48276.08,-581 48276.08,-565.31 48276.08,-565.31"/>
<polygon fill="black" stroke="black" points="48279.58,-565.31 48276.08,-555.31 48272.58,-565.31 48279.58,-565.31"/>
</g>
<!-- L5_S0_TP6_GPU6_expert0&#45;&gt;L5_S0_TP1_GPU1_moe_ar -->
<g id="edge1506" class="edge">
<title>L5_S0_TP6_GPU6_expert0&#45;&gt;L5_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M52347.37,-604.39C52347.37,-592.01 52347.37,-581 52347.37,-581 52347.37,-581 48789.06,-581 48789.06,-581 48789.06,-581 48789.06,-577.85 48789.06,-577.85"/>
<polygon fill="black" stroke="black" points="48792.56,-577.85 48789.06,-567.85 48785.56,-577.85 48792.56,-577.85"/>
</g>
<!-- L5_S0_TP6_GPU6_expert0&#45;&gt;L5_S0_TP2_GPU2_moe_ar -->
<g id="edge1542" class="edge">
<title>L5_S0_TP6_GPU6_expert0&#45;&gt;L5_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M52512.51,-604.08C52512.51,-548.71 52512.51,-446 52512.51,-446 52512.51,-446 49703.57,-446 49703.57,-446 49703.57,-446 49703.57,-485.22 49703.57,-485.22"/>
<polygon fill="black" stroke="black" points="49700.07,-485.22 49703.57,-495.22 49707.07,-485.22 49700.07,-485.22"/>
</g>
<!-- L5_S0_TP6_GPU6_expert0&#45;&gt;L5_S0_TP3_GPU3_moe_ar -->
<g id="edge1578" class="edge">
<title>L5_S0_TP6_GPU6_expert0&#45;&gt;L5_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M52506.49,-604.26C52506.49,-549.18 52506.49,-447 52506.49,-447 52506.49,-447 50417.17,-447 50417.17,-447 50417.17,-447 50417.17,-493.02 50417.17,-493.02"/>
<polygon fill="black" stroke="black" points="50413.67,-493.02 50417.17,-503.02 50420.67,-493.02 50413.67,-493.02"/>
</g>
<!-- L5_S0_TP6_GPU6_expert0&#45;&gt;L5_S0_TP4_GPU4_moe_ar -->
<g id="edge1614" class="edge">
<title>L5_S0_TP6_GPU6_expert0&#45;&gt;L5_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M52369.24,-604.47C52369.24,-591.6 52369.24,-580 52369.24,-580 52369.24,-580 51075.97,-580 51075.97,-580 51075.97,-580 51075.97,-556.03 51075.97,-556.03"/>
<polygon fill="black" stroke="black" points="51079.47,-556.03 51075.97,-546.03 51072.47,-556.03 51079.47,-556.03"/>
</g>
<!-- L5_S0_TP6_GPU6_expert0&#45;&gt;L5_S0_TP5_GPU5_moe_ar -->
<g id="edge1650" class="edge">
<title>L5_S0_TP6_GPU6_expert0&#45;&gt;L5_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M52391.11,-604.47C52391.11,-591.6 52391.11,-580 52391.11,-580 52391.11,-580 51644.68,-580 51644.68,-580 51644.68,-580 51644.68,-572.45 51644.68,-572.45"/>
<polygon fill="black" stroke="black" points="51648.18,-572.45 51644.68,-562.45 51641.18,-572.45 51648.18,-572.45"/>
</g>
<!-- L5_S0_TP6_GPU6_expert0&#45;&gt;L5_S0_TP6_GPU6_moe_ar -->
<g id="edge1686" class="edge">
<title>L5_S0_TP6_GPU6_expert0&#45;&gt;L5_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M52412.98,-604.34C52412.98,-604.34 52412.98,-562.87 52412.98,-562.87"/>
<polygon fill="black" stroke="black" points="52416.48,-562.87 52412.98,-552.87 52409.48,-562.87 52416.48,-562.87"/>
</g>
<!-- L5_S0_TP6_GPU6_expert0&#45;&gt;L5_S0_TP7_GPU7_moe_ar -->
<g id="edge1722" class="edge">
<title>L5_S0_TP6_GPU6_expert0&#45;&gt;L5_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M52746.06,-604.34C52746.06,-604.34 52746.06,-576.36 52746.06,-576.36"/>
<polygon fill="black" stroke="black" points="52749.56,-576.36 52746.06,-566.36 52742.56,-576.36 52749.56,-576.36"/>
</g>
<!-- L5_S0_TP6_GPU6_expert1 -->
<g id="node551" class="node">
<title>L5_S0_TP6_GPU6_expert1</title>
<polygon fill="none" stroke="black" points="53241.5,-672.5 52792.5,-672.5 52792.5,-604.5 53241.5,-604.5 53241.5,-672.5"/>
<text text-anchor="middle" x="53017" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="53017" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="53017" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="53017" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L5_S0_TP6_GPU6_expert1&#45;&gt;L5_S0_TP0_GPU0_moe_ar -->
<g id="edge1471" class="edge">
<title>L5_S0_TP6_GPU6_expert1&#45;&gt;L5_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M52848.92,-604.39C52848.92,-592.01 52848.92,-581 52848.92,-581 52848.92,-581 48301.67,-581 48301.67,-581 48301.67,-581 48301.67,-561.42 48301.67,-561.42"/>
<polygon fill="black" stroke="black" points="48305.17,-561.42 48301.67,-551.42 48298.17,-561.42 48305.17,-561.42"/>
</g>
<!-- L5_S0_TP6_GPU6_expert1&#45;&gt;L5_S0_TP1_GPU1_moe_ar -->
<g id="edge1507" class="edge">
<title>L5_S0_TP6_GPU6_expert1&#45;&gt;L5_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M52905.35,-604.39C52905.35,-592.01 52905.35,-581 52905.35,-581 52905.35,-581 48476.07,-581 48476.07,-581 48476.07,-581 48476.07,-561.77 48476.07,-561.77"/>
<polygon fill="black" stroke="black" points="48479.57,-561.77 48476.07,-551.77 48472.57,-561.77 48479.57,-561.77"/>
</g>
<!-- L5_S0_TP6_GPU6_expert1&#45;&gt;L5_S0_TP2_GPU2_moe_ar -->
<g id="edge1543" class="edge">
<title>L5_S0_TP6_GPU6_expert1&#45;&gt;L5_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M53223.49,-604.08C53223.49,-548.71 53223.49,-446 53223.49,-446 53223.49,-446 49654.68,-446 49654.68,-446 49654.68,-446 49654.68,-476.26 49654.68,-476.26"/>
<polygon fill="black" stroke="black" points="49651.18,-476.26 49654.68,-486.26 49658.18,-476.26 49651.18,-476.26"/>
</g>
<!-- L5_S0_TP6_GPU6_expert1&#45;&gt;L5_S0_TP3_GPU3_moe_ar -->
<g id="edge1579" class="edge">
<title>L5_S0_TP6_GPU6_expert1&#45;&gt;L5_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M53205.47,-604.08C53205.47,-548.71 53205.47,-446 53205.47,-446 53205.47,-446 50394.88,-446 50394.88,-446 50394.88,-446 50394.88,-486.05 50394.88,-486.05"/>
<polygon fill="black" stroke="black" points="50391.38,-486.05 50394.88,-496.05 50398.38,-486.05 50391.38,-486.05"/>
</g>
<!-- L5_S0_TP6_GPU6_expert1&#45;&gt;L5_S0_TP4_GPU4_moe_ar -->
<g id="edge1615" class="edge">
<title>L5_S0_TP6_GPU6_expert1&#45;&gt;L5_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M52961.77,-604.47C52961.77,-591.6 52961.77,-580 52961.77,-580 52961.77,-580 51101.22,-580 51101.22,-580 51101.22,-580 51101.22,-548.94 51101.22,-548.94"/>
<polygon fill="black" stroke="black" points="51104.72,-548.94 51101.22,-538.94 51097.72,-548.94 51104.72,-548.94"/>
</g>
<!-- L5_S0_TP6_GPU6_expert1&#45;&gt;L5_S0_TP5_GPU5_moe_ar -->
<g id="edge1651" class="edge">
<title>L5_S0_TP6_GPU6_expert1&#45;&gt;L5_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M53018.19,-604.47C53018.19,-591.6 53018.19,-580 53018.19,-580 53018.19,-580 51686.87,-580 51686.87,-580 51686.87,-580 51686.87,-568.15 51686.87,-568.15"/>
<polygon fill="black" stroke="black" points="51690.37,-568.15 51686.87,-558.15 51683.37,-568.15 51690.37,-568.15"/>
</g>
<!-- L5_S0_TP6_GPU6_expert1&#45;&gt;L5_S0_TP6_GPU6_moe_ar -->
<g id="edge1687" class="edge">
<title>L5_S0_TP6_GPU6_expert1&#45;&gt;L5_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M53074.62,-604.47C53074.62,-591.6 53074.62,-580 53074.62,-580 53074.62,-580 52434.85,-580 52434.85,-580 52434.85,-580 52434.85,-559.16 52434.85,-559.16"/>
<polygon fill="black" stroke="black" points="52438.35,-559.16 52434.85,-549.16 52431.35,-559.16 52438.35,-559.16"/>
</g>
<!-- L5_S0_TP6_GPU6_expert1&#45;&gt;L5_S0_TP7_GPU7_moe_ar -->
<g id="edge1723" class="edge">
<title>L5_S0_TP6_GPU6_expert1&#45;&gt;L5_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M53131.04,-604.34C53131.04,-604.34 53131.04,-557.38 53131.04,-557.38"/>
<polygon fill="black" stroke="black" points="53134.54,-557.38 53131.04,-547.38 53127.54,-557.38 53134.54,-557.38"/>
</g>
<!-- L5_S0_TP7_GPU7_expert0 -->
<g id="node552" class="node">
<title>L5_S0_TP7_GPU7_expert0</title>
<polygon fill="none" stroke="black" points="53708.5,-672.5 53259.5,-672.5 53259.5,-604.5 53708.5,-604.5 53708.5,-672.5"/>
<text text-anchor="middle" x="53484" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="53484" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="53484" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="53484" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L5_S0_TP7_GPU7_expert0&#45;&gt;L5_S0_TP0_GPU0_moe_ar -->
<g id="edge1472" class="edge">
<title>L5_S0_TP7_GPU7_expert0&#45;&gt;L5_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M53359.3,-604.39C53359.3,-592.01 53359.3,-581 53359.3,-581 53359.3,-581 48327.27,-581 48327.27,-581 48327.27,-581 48327.27,-556.11 48327.27,-556.11"/>
<polygon fill="black" stroke="black" points="48330.77,-556.11 48327.27,-546.11 48323.77,-556.11 48330.77,-556.11"/>
</g>
<!-- L5_S0_TP7_GPU7_expert0&#45;&gt;L5_S0_TP1_GPU1_moe_ar -->
<g id="edge1508" class="edge">
<title>L5_S0_TP7_GPU7_expert0&#45;&gt;L5_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M53621.2,-604.32C53621.2,-546.83 53621.2,-437 53621.2,-437 53621.2,-437 48898.23,-437 48898.23,-437 48898.23,-437 48898.23,-468.71 48898.23,-468.71"/>
<polygon fill="black" stroke="black" points="48894.73,-468.71 48898.23,-478.71 48901.73,-468.71 48894.73,-468.71"/>
</g>
<!-- L5_S0_TP7_GPU7_expert0&#45;&gt;L5_S0_TP2_GPU2_moe_ar -->
<g id="edge1544" class="edge">
<title>L5_S0_TP7_GPU7_expert0&#45;&gt;L5_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M53533.9,-604.32C53533.9,-546.83 53533.9,-437 53533.9,-437 53533.9,-437 49605.78,-437 49605.78,-437 49605.78,-437 49605.78,-470.17 49605.78,-470.17"/>
<polygon fill="black" stroke="black" points="49602.28,-470.17 49605.78,-480.17 49609.28,-470.17 49602.28,-470.17"/>
</g>
<!-- L5_S0_TP7_GPU7_expert0&#45;&gt;L5_S0_TP3_GPU3_moe_ar -->
<g id="edge1580" class="edge">
<title>L5_S0_TP7_GPU7_expert0&#45;&gt;L5_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M53269.92,-604.08C53269.92,-548.71 53269.92,-446 53269.92,-446 53269.92,-446 50372.58,-446 50372.58,-446 50372.58,-446 50372.58,-481.43 50372.58,-481.43"/>
<polygon fill="black" stroke="black" points="50369.08,-481.43 50372.58,-491.43 50376.08,-481.43 50369.08,-481.43"/>
</g>
<!-- L5_S0_TP7_GPU7_expert0&#45;&gt;L5_S0_TP4_GPU4_moe_ar -->
<g id="edge1616" class="edge">
<title>L5_S0_TP7_GPU7_expert0&#45;&gt;L5_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M53267.83,-604.47C53267.83,-553.18 53267.83,-462 53267.83,-462 53267.83,-462 51122.31,-462 51122.31,-462 51122.31,-462 51122.31,-502.78 51122.31,-502.78"/>
<polygon fill="black" stroke="black" points="51118.81,-502.78 51122.31,-512.78 51125.81,-502.78 51118.81,-502.78"/>
</g>
<!-- L5_S0_TP7_GPU7_expert0&#45;&gt;L5_S0_TP5_GPU5_moe_ar -->
<g id="edge1652" class="edge">
<title>L5_S0_TP7_GPU7_expert0&#45;&gt;L5_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M53261.58,-604.47C53261.58,-591.6 53261.58,-580 53261.58,-580 53261.58,-580 51729.07,-580 51729.07,-580 51729.07,-580 51729.07,-562.65 51729.07,-562.65"/>
<polygon fill="black" stroke="black" points="51732.57,-562.65 51729.07,-552.65 51725.57,-562.65 51732.57,-562.65"/>
</g>
<!-- L5_S0_TP7_GPU7_expert0&#45;&gt;L5_S0_TP6_GPU6_moe_ar -->
<g id="edge1688" class="edge">
<title>L5_S0_TP7_GPU7_expert0&#45;&gt;L5_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M53263.67,-604.47C53263.67,-591.6 53263.67,-580 53263.67,-580 53263.67,-580 52456.72,-580 52456.72,-580 52456.72,-580 52456.72,-554.31 52456.72,-554.31"/>
<polygon fill="black" stroke="black" points="52460.22,-554.31 52456.72,-544.31 52453.22,-554.31 52460.22,-554.31"/>
</g>
<!-- L5_S0_TP7_GPU7_expert0&#45;&gt;L5_S0_TP7_GPU7_moe_ar -->
<g id="edge1724" class="edge">
<title>L5_S0_TP7_GPU7_expert0&#45;&gt;L5_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M53265.75,-604.13C53265.75,-580.74 53265.75,-554 53265.75,-554 53265.75,-554 53102.5,-554 53102.5,-554"/>
<polygon fill="black" stroke="black" points="53102.5,-550.5 53092.5,-554 53102.5,-557.5 53102.5,-550.5"/>
</g>
<!-- L5_S0_TP7_GPU7_expert1 -->
<g id="node553" class="node">
<title>L5_S0_TP7_GPU7_expert1</title>
<polygon fill="none" stroke="black" points="54175.5,-672.5 53726.5,-672.5 53726.5,-604.5 54175.5,-604.5 54175.5,-672.5"/>
<text text-anchor="middle" x="53951" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="53951" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="53951" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="53951" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L5_S0_TP7_GPU7_expert1&#45;&gt;L5_S0_TP0_GPU0_moe_ar -->
<g id="edge1473" class="edge">
<title>L5_S0_TP7_GPU7_expert1&#45;&gt;L5_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M53767.11,-604.39C53767.11,-592.01 53767.11,-581 53767.11,-581 53767.11,-581 48352.87,-581 48352.87,-581 48352.87,-581 48352.87,-548.92 48352.87,-548.92"/>
<polygon fill="black" stroke="black" points="48356.37,-548.92 48352.87,-538.92 48349.37,-548.92 48356.37,-548.92"/>
</g>
<!-- L5_S0_TP7_GPU7_expert1&#45;&gt;L5_S0_TP1_GPU1_moe_ar -->
<g id="edge1509" class="edge">
<title>L5_S0_TP7_GPU7_expert1&#45;&gt;L5_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M54051.39,-604.32C54051.39,-546.83 54051.39,-437 54051.39,-437 54051.39,-437 48731,-437 48731,-437 48731,-437 48731,-461.89 48731,-461.89"/>
<polygon fill="black" stroke="black" points="48727.5,-461.89 48731,-471.89 48734.5,-461.89 48727.5,-461.89"/>
</g>
<!-- L5_S0_TP7_GPU7_expert1&#45;&gt;L5_S0_TP2_GPU2_moe_ar -->
<g id="edge1545" class="edge">
<title>L5_S0_TP7_GPU7_expert1&#45;&gt;L5_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M54010.78,-604.32C54010.78,-546.83 54010.78,-437 54010.78,-437 54010.78,-437 49556.89,-437 49556.89,-437 49556.89,-437 49556.89,-466.27 49556.89,-466.27"/>
<polygon fill="black" stroke="black" points="49553.39,-466.27 49556.89,-476.27 49560.39,-466.27 49553.39,-466.27"/>
</g>
<!-- L5_S0_TP7_GPU7_expert1&#45;&gt;L5_S0_TP3_GPU3_moe_ar -->
<g id="edge1581" class="edge">
<title>L5_S0_TP7_GPU7_expert1&#45;&gt;L5_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M53970.17,-604.08C53970.17,-548.71 53970.17,-446 53970.17,-446 53970.17,-446 50350.29,-446 50350.29,-446 50350.29,-446 50350.29,-477.56 50350.29,-477.56"/>
<polygon fill="black" stroke="black" points="50346.79,-477.56 50350.29,-487.56 50353.79,-477.56 50346.79,-477.56"/>
</g>
<!-- L5_S0_TP7_GPU7_expert1&#45;&gt;L5_S0_TP4_GPU4_moe_ar -->
<g id="edge1617" class="edge">
<title>L5_S0_TP7_GPU7_expert1&#45;&gt;L5_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M53929.56,-604.47C53929.56,-553.18 53929.56,-462 53929.56,-462 53929.56,-462 50949.88,-462 50949.88,-462 50949.88,-462 50949.88,-467.96 50949.88,-467.96"/>
<polygon fill="black" stroke="black" points="50946.38,-467.96 50949.88,-477.96 50953.38,-467.96 50946.38,-467.96"/>
</g>
<!-- L5_S0_TP7_GPU7_expert1&#45;&gt;L5_S0_TP5_GPU5_moe_ar -->
<g id="edge1653" class="edge">
<title>L5_S0_TP7_GPU7_expert1&#45;&gt;L5_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M53807.72,-604.47C53807.72,-591.6 53807.72,-580 53807.72,-580 53807.72,-580 51771.27,-580 51771.27,-580 51771.27,-580 51771.27,-553.97 51771.27,-553.97"/>
<polygon fill="black" stroke="black" points="51774.77,-553.97 51771.27,-543.97 51767.77,-553.97 51774.77,-553.97"/>
</g>
<!-- L5_S0_TP7_GPU7_expert1&#45;&gt;L5_S0_TP6_GPU6_moe_ar -->
<g id="edge1689" class="edge">
<title>L5_S0_TP7_GPU7_expert1&#45;&gt;L5_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M53848.33,-604.47C53848.33,-591.6 53848.33,-580 53848.33,-580 53848.33,-580 52478.59,-580 52478.59,-580 52478.59,-580 52478.59,-547.65 52478.59,-547.65"/>
<polygon fill="black" stroke="black" points="52482.09,-547.65 52478.59,-537.65 52475.09,-547.65 52482.09,-547.65"/>
</g>
<!-- L5_S0_TP7_GPU7_expert1&#45;&gt;L5_S0_TP7_GPU7_moe_ar -->
<g id="edge1725" class="edge">
<title>L5_S0_TP7_GPU7_expert1&#45;&gt;L5_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M53888.94,-604.4C53888.94,-576.28 53888.94,-541 53888.94,-541 53888.94,-541 53165.42,-541 53165.42,-541"/>
<polygon fill="black" stroke="black" points="53165.42,-537.5 53155.42,-541 53165.42,-544.5 53165.42,-537.5"/>
</g>
<!-- L5_S0_TP0_GPU0_norm -->
<g id="node555" class="node">
<title>L5_S0_TP0_GPU0_norm</title>
<polygon fill="none" stroke="black" points="46623.5,-332.33 46174.5,-332.33 46174.5,-264.33 46623.5,-264.33 46623.5,-332.33"/>
<text text-anchor="middle" x="46399" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="46399" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="46399" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="46399" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP0_GPU0_moe_res&#45;&gt;L5_S0_TP0_GPU0_norm -->
<g id="edge1476" class="edge">
<title>L5_S0_TP0_GPU0_moe_res&#45;&gt;L5_S0_TP0_GPU0_norm</title>
<path fill="none" stroke="black" d="M46399,-368.28C46399,-368.28 46399,-342.46 46399,-342.46"/>
<polygon fill="black" stroke="black" points="46402.5,-342.46 46399,-332.46 46395.5,-342.46 46402.5,-342.46"/>
</g>
<!-- L5_S0_TP1_GPU1_qkv_linear -->
<g id="node556" class="node">
<title>L5_S0_TP1_GPU1_qkv_linear</title>
<polygon fill="none" stroke="black" points="48167,-1614.75 47559,-1614.75 47559,-1546.75 48167,-1546.75 48167,-1614.75"/>
<text text-anchor="middle" x="47863" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="47863" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="47863" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="47863" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L5_S0_TP1_GPU1_qkv_slice -->
<g id="node557" class="node">
<title>L5_S0_TP1_GPU1_qkv_slice</title>
<polygon fill="none" stroke="black" points="48161,-1496.67 47565,-1496.67 47565,-1428.67 48161,-1428.67 48161,-1496.67"/>
<text text-anchor="middle" x="47863" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="47863" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="47863" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="47863" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L5_S0_TP1_GPU1_qkv_linear&#45;&gt;L5_S0_TP1_GPU1_qkv_slice -->
<g id="edge1477" class="edge">
<title>L5_S0_TP1_GPU1_qkv_linear&#45;&gt;L5_S0_TP1_GPU1_qkv_slice</title>
<path fill="none" stroke="black" d="M47863,-1546.59C47863,-1546.59 47863,-1506.74 47863,-1506.74"/>
<polygon fill="black" stroke="black" points="47866.5,-1506.74 47863,-1496.74 47859.5,-1506.74 47866.5,-1506.74"/>
</g>
<!-- L5_S0_TP1_GPU1_qkv_slice&#45;&gt;L5_S0_TP1_GPU1_attn_v -->
<g id="edge1481" class="edge">
<title>L5_S0_TP1_GPU1_qkv_slice&#45;&gt;L5_S0_TP1_GPU1_attn_v</title>
<path fill="none" stroke="black" d="M47616.25,-1428.38C47616.25,-1428.38 47616.25,-1195 47616.25,-1195"/>
<polygon fill="black" stroke="black" points="47619.75,-1195 47616.25,-1185 47612.75,-1195 47619.75,-1195"/>
</g>
<!-- L5_S0_TP1_GPU1_qk_matmul -->
<g id="node558" class="node">
<title>L5_S0_TP1_GPU1_qk_matmul</title>
<polygon fill="none" stroke="black" points="48578.5,-1392.67 47643.5,-1392.67 47643.5,-1324.67 48578.5,-1324.67 48578.5,-1392.67"/>
<text text-anchor="middle" x="48111" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="48111" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="48111" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="48111" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L5_S0_TP1_GPU1_qkv_slice&#45;&gt;L5_S0_TP1_GPU1_qk_matmul -->
<g id="edge1478" class="edge">
<title>L5_S0_TP1_GPU1_qkv_slice&#45;&gt;L5_S0_TP1_GPU1_qk_matmul</title>
<path fill="none" stroke="black" d="M47902.25,-1428.61C47902.25,-1428.61 47902.25,-1402.8 47902.25,-1402.8"/>
<polygon fill="black" stroke="black" points="47905.75,-1402.8 47902.25,-1392.8 47898.75,-1402.8 47905.75,-1402.8"/>
</g>
<!-- L5_S0_TP1_GPU1_softmax -->
<g id="node559" class="node">
<title>L5_S0_TP1_GPU1_softmax</title>
<polygon fill="none" stroke="black" points="48339,-1288.67 47829,-1288.67 47829,-1220.67 48339,-1220.67 48339,-1288.67"/>
<text text-anchor="middle" x="48084" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="48084" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="48084" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="48084" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L5_S0_TP1_GPU1_qk_matmul&#45;&gt;L5_S0_TP1_GPU1_softmax -->
<g id="edge1479" class="edge">
<title>L5_S0_TP1_GPU1_qk_matmul&#45;&gt;L5_S0_TP1_GPU1_softmax</title>
<path fill="none" stroke="black" d="M48084,-1324.61C48084,-1324.61 48084,-1298.8 48084,-1298.8"/>
<polygon fill="black" stroke="black" points="48087.5,-1298.8 48084,-1288.8 48080.5,-1298.8 48087.5,-1298.8"/>
</g>
<!-- L5_S0_TP1_GPU1_softmax&#45;&gt;L5_S0_TP1_GPU1_attn_v -->
<g id="edge1480" class="edge">
<title>L5_S0_TP1_GPU1_softmax&#45;&gt;L5_S0_TP1_GPU1_attn_v</title>
<path fill="none" stroke="black" d="M48084,-1220.61C48084,-1220.61 48084,-1194.8 48084,-1194.8"/>
<polygon fill="black" stroke="black" points="48087.5,-1194.8 48084,-1184.8 48080.5,-1194.8 48087.5,-1194.8"/>
</g>
<!-- L5_S0_TP1_GPU1_mha_res -->
<g id="node561" class="node">
<title>L5_S0_TP1_GPU1_mha_res</title>
<polygon fill="none" stroke="black" points="48197.5,-948.5 47310.5,-948.5 47310.5,-880.5 48197.5,-880.5 48197.5,-948.5"/>
<text text-anchor="middle" x="47754" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="47754" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="47754" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="47754" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP1_GPU1_mha_ar&#45;&gt;L5_S0_TP1_GPU1_mha_res -->
<g id="edge1490" class="edge">
<title>L5_S0_TP1_GPU1_mha_ar&#45;&gt;L5_S0_TP1_GPU1_mha_res</title>
<path fill="none" stroke="black" d="M48174.01,-1015.66C48174.01,-1015.66 48174.01,-958.91 48174.01,-958.91"/>
<polygon fill="black" stroke="black" points="48177.51,-958.91 48174.01,-948.91 48170.51,-958.91 48177.51,-958.91"/>
</g>
<!-- L5_S0_TP1_GPU1_gate -->
<g id="node562" class="node">
<title>L5_S0_TP1_GPU1_gate</title>
<polygon fill="none" stroke="black" points="48283.56,-844.5 47441.15,-844.5 47224.44,-708.5 48066.85,-708.5 48283.56,-844.5"/>
<text text-anchor="middle" x="47754" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="47754" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="47754" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="47754" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L5_S0_TP1_GPU1_mha_res&#45;&gt;L5_S0_TP1_GPU1_gate -->
<g id="edge1491" class="edge">
<title>L5_S0_TP1_GPU1_mha_res&#45;&gt;L5_S0_TP1_GPU1_gate</title>
<path fill="none" stroke="black" d="M47754,-880.39C47754,-880.39 47754,-854.73 47754,-854.73"/>
<polygon fill="black" stroke="black" points="47757.5,-854.73 47754,-844.73 47750.5,-854.73 47757.5,-854.73"/>
</g>
<!-- L5_S0_TP1_GPU1_moe_res -->
<g id="node564" class="node">
<title>L5_S0_TP1_GPU1_moe_res</title>
<polygon fill="none" stroke="black" points="48021,-436.33 47201,-436.33 47201,-368.33 48021,-368.33 48021,-436.33"/>
<text text-anchor="middle" x="47611" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="47611" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="47611" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="47611" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP1_GPU1_mha_res&#45;&gt;L5_S0_TP1_GPU1_moe_res -->
<g id="edge1511" class="edge">
<title>L5_S0_TP1_GPU1_mha_res&#45;&gt;L5_S0_TP1_GPU1_moe_res</title>
<path fill="none" stroke="black" d="M47310.43,-914C47253.73,-914 47215,-914 47215,-914 47215,-914 47215,-680 47215,-680 47215,-680 47646.5,-680 47646.5,-680 47646.5,-680 47646.5,-446.38 47646.5,-446.38"/>
<polygon fill="black" stroke="black" points="47650,-446.38 47646.5,-436.38 47643,-446.38 47650,-446.38"/>
</g>
<!-- L5_S0_TP1_GPU1_gate&#45;&gt;L5_S0_TP1_GPU1_expert0 -->
<g id="edge1492" class="edge">
<title>L5_S0_TP1_GPU1_gate&#45;&gt;L5_S0_TP1_GPU1_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M47805.17,-708.31C47805.17,-708.31 47805.17,-682.71 47805.17,-682.71"/>
<polygon fill="black" stroke="black" points="47808.67,-682.71 47805.17,-672.71 47801.67,-682.71 47808.67,-682.71"/>
</g>
<!-- L5_S0_TP1_GPU1_gate&#45;&gt;L5_S0_TP1_GPU1_expert1 -->
<g id="edge1493" class="edge">
<title>L5_S0_TP1_GPU1_gate&#45;&gt;L5_S0_TP1_GPU1_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M48203.14,-776.4C48203.14,-776.4 48203.14,-682.74 48203.14,-682.74"/>
<polygon fill="black" stroke="black" points="48206.64,-682.74 48203.14,-672.74 48199.64,-682.74 48206.64,-682.74"/>
</g>
<!-- L5_S0_TP1_GPU1_moe_ar&#45;&gt;L5_S0_TP1_GPU1_moe_res -->
<g id="edge1510" class="edge">
<title>L5_S0_TP1_GPU1_moe_ar&#45;&gt;L5_S0_TP1_GPU1_moe_res</title>
<path fill="none" stroke="black" d="M48563.77,-478.7C48563.77,-457.44 48563.77,-436 48563.77,-436 48563.77,-436 48031.16,-436 48031.16,-436"/>
<polygon fill="black" stroke="black" points="48031.16,-432.5 48021.16,-436 48031.16,-439.5 48031.16,-432.5"/>
</g>
<!-- L5_S0_TP1_GPU1_norm -->
<g id="node565" class="node">
<title>L5_S0_TP1_GPU1_norm</title>
<polygon fill="none" stroke="black" points="47835.5,-332.33 47386.5,-332.33 47386.5,-264.33 47835.5,-264.33 47835.5,-332.33"/>
<text text-anchor="middle" x="47611" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="47611" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="47611" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="47611" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP1_GPU1_moe_res&#45;&gt;L5_S0_TP1_GPU1_norm -->
<g id="edge1512" class="edge">
<title>L5_S0_TP1_GPU1_moe_res&#45;&gt;L5_S0_TP1_GPU1_norm</title>
<path fill="none" stroke="black" d="M47611,-368.28C47611,-368.28 47611,-342.46 47611,-342.46"/>
<polygon fill="black" stroke="black" points="47614.5,-342.46 47611,-332.46 47607.5,-342.46 47614.5,-342.46"/>
</g>
<!-- L5_S0_TP2_GPU2_qkv_linear -->
<g id="node566" class="node">
<title>L5_S0_TP2_GPU2_qkv_linear</title>
<polygon fill="none" stroke="black" points="49167,-1614.75 48559,-1614.75 48559,-1546.75 49167,-1546.75 49167,-1614.75"/>
<text text-anchor="middle" x="48863" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="48863" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="48863" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="48863" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L5_S0_TP2_GPU2_qkv_slice -->
<g id="node567" class="node">
<title>L5_S0_TP2_GPU2_qkv_slice</title>
<polygon fill="none" stroke="black" points="49161,-1496.67 48565,-1496.67 48565,-1428.67 49161,-1428.67 49161,-1496.67"/>
<text text-anchor="middle" x="48863" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="48863" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="48863" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="48863" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L5_S0_TP2_GPU2_qkv_linear&#45;&gt;L5_S0_TP2_GPU2_qkv_slice -->
<g id="edge1513" class="edge">
<title>L5_S0_TP2_GPU2_qkv_linear&#45;&gt;L5_S0_TP2_GPU2_qkv_slice</title>
<path fill="none" stroke="black" d="M48863,-1546.59C48863,-1546.59 48863,-1506.74 48863,-1506.74"/>
<polygon fill="black" stroke="black" points="48866.5,-1506.74 48863,-1496.74 48859.5,-1506.74 48866.5,-1506.74"/>
</g>
<!-- L5_S0_TP2_GPU2_qkv_slice&#45;&gt;L5_S0_TP2_GPU2_attn_v -->
<g id="edge1517" class="edge">
<title>L5_S0_TP2_GPU2_qkv_slice&#45;&gt;L5_S0_TP2_GPU2_attn_v</title>
<path fill="none" stroke="black" d="M48611,-1428.38C48611,-1428.38 48611,-1195 48611,-1195"/>
<polygon fill="black" stroke="black" points="48614.5,-1195 48611,-1185 48607.5,-1195 48614.5,-1195"/>
</g>
<!-- L5_S0_TP2_GPU2_qk_matmul -->
<g id="node568" class="node">
<title>L5_S0_TP2_GPU2_qk_matmul</title>
<polygon fill="none" stroke="black" points="49578.5,-1392.67 48643.5,-1392.67 48643.5,-1324.67 49578.5,-1324.67 49578.5,-1392.67"/>
<text text-anchor="middle" x="49111" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="49111" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="49111" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="49111" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L5_S0_TP2_GPU2_qkv_slice&#45;&gt;L5_S0_TP2_GPU2_qk_matmul -->
<g id="edge1514" class="edge">
<title>L5_S0_TP2_GPU2_qkv_slice&#45;&gt;L5_S0_TP2_GPU2_qk_matmul</title>
<path fill="none" stroke="black" d="M48902.25,-1428.61C48902.25,-1428.61 48902.25,-1402.8 48902.25,-1402.8"/>
<polygon fill="black" stroke="black" points="48905.75,-1402.8 48902.25,-1392.8 48898.75,-1402.8 48905.75,-1402.8"/>
</g>
<!-- L5_S0_TP2_GPU2_softmax -->
<g id="node569" class="node">
<title>L5_S0_TP2_GPU2_softmax</title>
<polygon fill="none" stroke="black" points="49317,-1288.67 48807,-1288.67 48807,-1220.67 49317,-1220.67 49317,-1288.67"/>
<text text-anchor="middle" x="49062" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="49062" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="49062" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="49062" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L5_S0_TP2_GPU2_qk_matmul&#45;&gt;L5_S0_TP2_GPU2_softmax -->
<g id="edge1515" class="edge">
<title>L5_S0_TP2_GPU2_qk_matmul&#45;&gt;L5_S0_TP2_GPU2_softmax</title>
<path fill="none" stroke="black" d="M49062,-1324.61C49062,-1324.61 49062,-1298.8 49062,-1298.8"/>
<polygon fill="black" stroke="black" points="49065.5,-1298.8 49062,-1288.8 49058.5,-1298.8 49065.5,-1298.8"/>
</g>
<!-- L5_S0_TP2_GPU2_softmax&#45;&gt;L5_S0_TP2_GPU2_attn_v -->
<g id="edge1516" class="edge">
<title>L5_S0_TP2_GPU2_softmax&#45;&gt;L5_S0_TP2_GPU2_attn_v</title>
<path fill="none" stroke="black" d="M49062,-1220.61C49062,-1220.61 49062,-1194.8 49062,-1194.8"/>
<polygon fill="black" stroke="black" points="49065.5,-1194.8 49062,-1184.8 49058.5,-1194.8 49065.5,-1194.8"/>
</g>
<!-- L5_S0_TP2_GPU2_mha_res -->
<g id="node571" class="node">
<title>L5_S0_TP2_GPU2_mha_res</title>
<polygon fill="none" stroke="black" points="49275.5,-948.5 48388.5,-948.5 48388.5,-880.5 49275.5,-880.5 49275.5,-948.5"/>
<text text-anchor="middle" x="48832" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="48832" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="48832" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="48832" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP2_GPU2_mha_ar&#45;&gt;L5_S0_TP2_GPU2_mha_res -->
<g id="edge1526" class="edge">
<title>L5_S0_TP2_GPU2_mha_ar&#45;&gt;L5_S0_TP2_GPU2_mha_res</title>
<path fill="none" stroke="black" d="M49097.51,-991.61C49097.51,-991.61 49097.51,-958.74 49097.51,-958.74"/>
<polygon fill="black" stroke="black" points="49101.01,-958.74 49097.51,-948.74 49094.01,-958.74 49101.01,-958.74"/>
</g>
<!-- L5_S0_TP2_GPU2_gate -->
<g id="node572" class="node">
<title>L5_S0_TP2_GPU2_gate</title>
<polygon fill="none" stroke="black" points="49361.56,-844.5 48519.15,-844.5 48302.44,-708.5 49144.85,-708.5 49361.56,-844.5"/>
<text text-anchor="middle" x="48832" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="48832" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="48832" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="48832" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L5_S0_TP2_GPU2_mha_res&#45;&gt;L5_S0_TP2_GPU2_gate -->
<g id="edge1527" class="edge">
<title>L5_S0_TP2_GPU2_mha_res&#45;&gt;L5_S0_TP2_GPU2_gate</title>
<path fill="none" stroke="black" d="M48832,-880.39C48832,-880.39 48832,-854.73 48832,-854.73"/>
<polygon fill="black" stroke="black" points="48835.5,-854.73 48832,-844.73 48828.5,-854.73 48835.5,-854.73"/>
</g>
<!-- L5_S0_TP2_GPU2_moe_res -->
<g id="node574" class="node">
<title>L5_S0_TP2_GPU2_moe_res</title>
<polygon fill="none" stroke="black" points="49147,-436.33 48327,-436.33 48327,-368.33 49147,-368.33 49147,-436.33"/>
<text text-anchor="middle" x="48737" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="48737" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="48737" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="48737" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP2_GPU2_mha_res&#45;&gt;L5_S0_TP2_GPU2_moe_res -->
<g id="edge1547" class="edge">
<title>L5_S0_TP2_GPU2_mha_res&#45;&gt;L5_S0_TP2_GPU2_moe_res</title>
<path fill="none" stroke="black" d="M49275.57,-914C49332.27,-914 49371,-914 49371,-914 49371,-914 49371,-676 49371,-676 49371,-676 49048.79,-676 49048.79,-676 49048.79,-676 49048.79,-582 49048.79,-582 49048.79,-582 49077.51,-582 49077.51,-582 49077.51,-582 49077.51,-446.55 49077.51,-446.55"/>
<polygon fill="black" stroke="black" points="49081.01,-446.55 49077.51,-436.55 49074.01,-446.55 49081.01,-446.55"/>
</g>
<!-- L5_S0_TP2_GPU2_gate&#45;&gt;L5_S0_TP2_GPU2_expert0 -->
<g id="edge1528" class="edge">
<title>L5_S0_TP2_GPU2_gate&#45;&gt;L5_S0_TP2_GPU2_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M48701.75,-708.31C48701.75,-708.31 48701.75,-682.71 48701.75,-682.71"/>
<polygon fill="black" stroke="black" points="48705.25,-682.71 48701.75,-672.71 48698.25,-682.71 48705.25,-682.71"/>
</g>
<!-- L5_S0_TP2_GPU2_gate&#45;&gt;L5_S0_TP2_GPU2_expert1 -->
<g id="edge1529" class="edge">
<title>L5_S0_TP2_GPU2_gate&#45;&gt;L5_S0_TP2_GPU2_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49209.14,-748.57C49209.14,-748.57 49209.14,-682.74 49209.14,-682.74"/>
<polygon fill="black" stroke="black" points="49212.64,-682.74 49209.14,-672.74 49205.64,-682.74 49212.64,-682.74"/>
</g>
<!-- L5_S0_TP2_GPU2_moe_ar&#45;&gt;L5_S0_TP2_GPU2_moe_res -->
<g id="edge1546" class="edge">
<title>L5_S0_TP2_GPU2_moe_ar&#45;&gt;L5_S0_TP2_GPU2_moe_res</title>
<path fill="none" stroke="black" d="M49131.13,-495.66C49131.13,-495.66 49131.13,-446.46 49131.13,-446.46"/>
<polygon fill="black" stroke="black" points="49134.63,-446.46 49131.13,-436.46 49127.63,-446.46 49134.63,-446.46"/>
</g>
<!-- L5_S0_TP2_GPU2_norm -->
<g id="node575" class="node">
<title>L5_S0_TP2_GPU2_norm</title>
<polygon fill="none" stroke="black" points="48961.5,-332.33 48512.5,-332.33 48512.5,-264.33 48961.5,-264.33 48961.5,-332.33"/>
<text text-anchor="middle" x="48737" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="48737" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="48737" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="48737" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP2_GPU2_moe_res&#45;&gt;L5_S0_TP2_GPU2_norm -->
<g id="edge1548" class="edge">
<title>L5_S0_TP2_GPU2_moe_res&#45;&gt;L5_S0_TP2_GPU2_norm</title>
<path fill="none" stroke="black" d="M48737,-368.28C48737,-368.28 48737,-342.46 48737,-342.46"/>
<polygon fill="black" stroke="black" points="48740.5,-342.46 48737,-332.46 48733.5,-342.46 48740.5,-342.46"/>
</g>
<!-- L5_S0_TP3_GPU3_qkv_linear -->
<g id="node576" class="node">
<title>L5_S0_TP3_GPU3_qkv_linear</title>
<polygon fill="none" stroke="black" points="50163,-1614.75 49555,-1614.75 49555,-1546.75 50163,-1546.75 50163,-1614.75"/>
<text text-anchor="middle" x="49859" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="49859" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="49859" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="49859" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L5_S0_TP3_GPU3_qkv_slice -->
<g id="node577" class="node">
<title>L5_S0_TP3_GPU3_qkv_slice</title>
<polygon fill="none" stroke="black" points="50157,-1496.67 49561,-1496.67 49561,-1428.67 50157,-1428.67 50157,-1496.67"/>
<text text-anchor="middle" x="49859" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="49859" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="49859" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="49859" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L5_S0_TP3_GPU3_qkv_linear&#45;&gt;L5_S0_TP3_GPU3_qkv_slice -->
<g id="edge1549" class="edge">
<title>L5_S0_TP3_GPU3_qkv_linear&#45;&gt;L5_S0_TP3_GPU3_qkv_slice</title>
<path fill="none" stroke="black" d="M49859,-1546.59C49859,-1546.59 49859,-1506.74 49859,-1506.74"/>
<polygon fill="black" stroke="black" points="49862.5,-1506.74 49859,-1496.74 49855.5,-1506.74 49862.5,-1506.74"/>
</g>
<!-- L5_S0_TP3_GPU3_qkv_slice&#45;&gt;L5_S0_TP3_GPU3_attn_v -->
<g id="edge1553" class="edge">
<title>L5_S0_TP3_GPU3_qkv_slice&#45;&gt;L5_S0_TP3_GPU3_attn_v</title>
<path fill="none" stroke="black" d="M49609,-1428.38C49609,-1428.38 49609,-1195 49609,-1195"/>
<polygon fill="black" stroke="black" points="49612.5,-1195 49609,-1185 49605.5,-1195 49612.5,-1195"/>
</g>
<!-- L5_S0_TP3_GPU3_qk_matmul -->
<g id="node578" class="node">
<title>L5_S0_TP3_GPU3_qk_matmul</title>
<polygon fill="none" stroke="black" points="50574.5,-1392.67 49639.5,-1392.67 49639.5,-1324.67 50574.5,-1324.67 50574.5,-1392.67"/>
<text text-anchor="middle" x="50107" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="50107" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="50107" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="50107" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L5_S0_TP3_GPU3_qkv_slice&#45;&gt;L5_S0_TP3_GPU3_qk_matmul -->
<g id="edge1550" class="edge">
<title>L5_S0_TP3_GPU3_qkv_slice&#45;&gt;L5_S0_TP3_GPU3_qk_matmul</title>
<path fill="none" stroke="black" d="M49898.25,-1428.61C49898.25,-1428.61 49898.25,-1402.8 49898.25,-1402.8"/>
<polygon fill="black" stroke="black" points="49901.75,-1402.8 49898.25,-1392.8 49894.75,-1402.8 49901.75,-1402.8"/>
</g>
<!-- L5_S0_TP3_GPU3_softmax -->
<g id="node579" class="node">
<title>L5_S0_TP3_GPU3_softmax</title>
<polygon fill="none" stroke="black" points="50293,-1288.67 49783,-1288.67 49783,-1220.67 50293,-1220.67 50293,-1288.67"/>
<text text-anchor="middle" x="50038" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="50038" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="50038" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="50038" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L5_S0_TP3_GPU3_qk_matmul&#45;&gt;L5_S0_TP3_GPU3_softmax -->
<g id="edge1551" class="edge">
<title>L5_S0_TP3_GPU3_qk_matmul&#45;&gt;L5_S0_TP3_GPU3_softmax</title>
<path fill="none" stroke="black" d="M50038,-1324.61C50038,-1324.61 50038,-1298.8 50038,-1298.8"/>
<polygon fill="black" stroke="black" points="50041.5,-1298.8 50038,-1288.8 50034.5,-1298.8 50041.5,-1298.8"/>
</g>
<!-- L5_S0_TP3_GPU3_softmax&#45;&gt;L5_S0_TP3_GPU3_attn_v -->
<g id="edge1552" class="edge">
<title>L5_S0_TP3_GPU3_softmax&#45;&gt;L5_S0_TP3_GPU3_attn_v</title>
<path fill="none" stroke="black" d="M50038,-1220.61C50038,-1220.61 50038,-1194.8 50038,-1194.8"/>
<polygon fill="black" stroke="black" points="50041.5,-1194.8 50038,-1184.8 50034.5,-1194.8 50041.5,-1194.8"/>
</g>
<!-- L5_S0_TP3_GPU3_mha_res -->
<g id="node581" class="node">
<title>L5_S0_TP3_GPU3_mha_res</title>
<polygon fill="none" stroke="black" points="50353.5,-948.5 49466.5,-948.5 49466.5,-880.5 50353.5,-880.5 50353.5,-948.5"/>
<text text-anchor="middle" x="49910" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="49910" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="49910" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="49910" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP3_GPU3_mha_ar&#45;&gt;L5_S0_TP3_GPU3_mha_res -->
<g id="edge1562" class="edge">
<title>L5_S0_TP3_GPU3_mha_ar&#45;&gt;L5_S0_TP3_GPU3_mha_res</title>
<path fill="none" stroke="black" d="M50021.01,-984.55C50021.01,-984.55 50021.01,-958.73 50021.01,-958.73"/>
<polygon fill="black" stroke="black" points="50024.51,-958.73 50021.01,-948.73 50017.51,-958.73 50024.51,-958.73"/>
</g>
<!-- L5_S0_TP3_GPU3_gate -->
<g id="node582" class="node">
<title>L5_S0_TP3_GPU3_gate</title>
<polygon fill="none" stroke="black" points="50439.56,-844.5 49597.15,-844.5 49380.44,-708.5 50222.85,-708.5 50439.56,-844.5"/>
<text text-anchor="middle" x="49910" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="49910" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="49910" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="49910" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L5_S0_TP3_GPU3_mha_res&#45;&gt;L5_S0_TP3_GPU3_gate -->
<g id="edge1563" class="edge">
<title>L5_S0_TP3_GPU3_mha_res&#45;&gt;L5_S0_TP3_GPU3_gate</title>
<path fill="none" stroke="black" d="M49910,-880.39C49910,-880.39 49910,-854.73 49910,-854.73"/>
<polygon fill="black" stroke="black" points="49913.5,-854.73 49910,-844.73 49906.5,-854.73 49913.5,-854.73"/>
</g>
<!-- L5_S0_TP3_GPU3_moe_res -->
<g id="node584" class="node">
<title>L5_S0_TP3_GPU3_moe_res</title>
<polygon fill="none" stroke="black" points="50328,-436.33 49508,-436.33 49508,-368.33 50328,-368.33 50328,-436.33"/>
<text text-anchor="middle" x="49918" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="49918" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="49918" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="49918" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP3_GPU3_mha_res&#45;&gt;L5_S0_TP3_GPU3_moe_res -->
<g id="edge1583" class="edge">
<title>L5_S0_TP3_GPU3_mha_res&#45;&gt;L5_S0_TP3_GPU3_moe_res</title>
<path fill="none" stroke="black" d="M50353.6,-903C50411.98,-903 50452.08,-903 50452.08,-903 50452.08,-903 50452.08,-390 50452.08,-390 50452.08,-390 50338.21,-390 50338.21,-390"/>
<polygon fill="black" stroke="black" points="50338.21,-386.5 50328.21,-390 50338.21,-393.5 50338.21,-386.5"/>
</g>
<!-- L5_S0_TP3_GPU3_gate&#45;&gt;L5_S0_TP3_GPU3_expert0 -->
<g id="edge1564" class="edge">
<title>L5_S0_TP3_GPU3_gate&#45;&gt;L5_S0_TP3_GPU3_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49635.75,-708.31C49635.75,-708.31 49635.75,-682.71 49635.75,-682.71"/>
<polygon fill="black" stroke="black" points="49639.25,-682.71 49635.75,-672.71 49632.25,-682.71 49639.25,-682.71"/>
</g>
<!-- L5_S0_TP3_GPU3_gate&#45;&gt;L5_S0_TP3_GPU3_expert1 -->
<g id="edge1565" class="edge">
<title>L5_S0_TP3_GPU3_gate&#45;&gt;L5_S0_TP3_GPU3_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M50102.75,-708.31C50102.75,-708.31 50102.75,-682.71 50102.75,-682.71"/>
<polygon fill="black" stroke="black" points="50106.25,-682.71 50102.75,-672.71 50099.25,-682.71 50106.25,-682.71"/>
</g>
<!-- L5_S0_TP3_GPU3_moe_ar&#45;&gt;L5_S0_TP3_GPU3_moe_res -->
<g id="edge1582" class="edge">
<title>L5_S0_TP3_GPU3_moe_ar&#45;&gt;L5_S0_TP3_GPU3_moe_res</title>
<path fill="none" stroke="black" d="M50142.18,-472.39C50142.18,-472.39 50142.18,-446.57 50142.18,-446.57"/>
<polygon fill="black" stroke="black" points="50145.68,-446.57 50142.18,-436.57 50138.68,-446.57 50145.68,-446.57"/>
</g>
<!-- L5_S0_TP3_GPU3_norm -->
<g id="node585" class="node">
<title>L5_S0_TP3_GPU3_norm</title>
<polygon fill="none" stroke="black" points="50142.5,-332.33 49693.5,-332.33 49693.5,-264.33 50142.5,-264.33 50142.5,-332.33"/>
<text text-anchor="middle" x="49918" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="49918" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="49918" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="49918" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP3_GPU3_moe_res&#45;&gt;L5_S0_TP3_GPU3_norm -->
<g id="edge1584" class="edge">
<title>L5_S0_TP3_GPU3_moe_res&#45;&gt;L5_S0_TP3_GPU3_norm</title>
<path fill="none" stroke="black" d="M49918,-368.28C49918,-368.28 49918,-342.46 49918,-342.46"/>
<polygon fill="black" stroke="black" points="49921.5,-342.46 49918,-332.46 49914.5,-342.46 49921.5,-342.46"/>
</g>
<!-- L5_S0_TP4_GPU4_qkv_linear -->
<g id="node586" class="node">
<title>L5_S0_TP4_GPU4_qkv_linear</title>
<polygon fill="none" stroke="black" points="51157,-1614.75 50549,-1614.75 50549,-1546.75 51157,-1546.75 51157,-1614.75"/>
<text text-anchor="middle" x="50853" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="50853" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="50853" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="50853" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L5_S0_TP4_GPU4_qkv_slice -->
<g id="node587" class="node">
<title>L5_S0_TP4_GPU4_qkv_slice</title>
<polygon fill="none" stroke="black" points="51151,-1496.67 50555,-1496.67 50555,-1428.67 51151,-1428.67 51151,-1496.67"/>
<text text-anchor="middle" x="50853" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="50853" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="50853" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="50853" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L5_S0_TP4_GPU4_qkv_linear&#45;&gt;L5_S0_TP4_GPU4_qkv_slice -->
<g id="edge1585" class="edge">
<title>L5_S0_TP4_GPU4_qkv_linear&#45;&gt;L5_S0_TP4_GPU4_qkv_slice</title>
<path fill="none" stroke="black" d="M50853,-1546.59C50853,-1546.59 50853,-1506.74 50853,-1506.74"/>
<polygon fill="black" stroke="black" points="50856.5,-1506.74 50853,-1496.74 50849.5,-1506.74 50856.5,-1506.74"/>
</g>
<!-- L5_S0_TP4_GPU4_qkv_slice&#45;&gt;L5_S0_TP4_GPU4_attn_v -->
<g id="edge1589" class="edge">
<title>L5_S0_TP4_GPU4_qkv_slice&#45;&gt;L5_S0_TP4_GPU4_attn_v</title>
<path fill="none" stroke="black" d="M50604,-1428.38C50604,-1428.38 50604,-1195 50604,-1195"/>
<polygon fill="black" stroke="black" points="50607.5,-1195 50604,-1185 50600.5,-1195 50607.5,-1195"/>
</g>
<!-- L5_S0_TP4_GPU4_qk_matmul -->
<g id="node588" class="node">
<title>L5_S0_TP4_GPU4_qk_matmul</title>
<polygon fill="none" stroke="black" points="51568.5,-1392.67 50633.5,-1392.67 50633.5,-1324.67 51568.5,-1324.67 51568.5,-1392.67"/>
<text text-anchor="middle" x="51101" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="51101" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="51101" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="51101" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L5_S0_TP4_GPU4_qkv_slice&#45;&gt;L5_S0_TP4_GPU4_qk_matmul -->
<g id="edge1586" class="edge">
<title>L5_S0_TP4_GPU4_qkv_slice&#45;&gt;L5_S0_TP4_GPU4_qk_matmul</title>
<path fill="none" stroke="black" d="M50892.25,-1428.61C50892.25,-1428.61 50892.25,-1402.8 50892.25,-1402.8"/>
<polygon fill="black" stroke="black" points="50895.75,-1402.8 50892.25,-1392.8 50888.75,-1402.8 50895.75,-1402.8"/>
</g>
<!-- L5_S0_TP4_GPU4_softmax -->
<g id="node589" class="node">
<title>L5_S0_TP4_GPU4_softmax</title>
<polygon fill="none" stroke="black" points="51268,-1288.67 50758,-1288.67 50758,-1220.67 51268,-1220.67 51268,-1288.67"/>
<text text-anchor="middle" x="51013" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="51013" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="51013" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="51013" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L5_S0_TP4_GPU4_qk_matmul&#45;&gt;L5_S0_TP4_GPU4_softmax -->
<g id="edge1587" class="edge">
<title>L5_S0_TP4_GPU4_qk_matmul&#45;&gt;L5_S0_TP4_GPU4_softmax</title>
<path fill="none" stroke="black" d="M51013,-1324.61C51013,-1324.61 51013,-1298.8 51013,-1298.8"/>
<polygon fill="black" stroke="black" points="51016.5,-1298.8 51013,-1288.8 51009.5,-1298.8 51016.5,-1298.8"/>
</g>
<!-- L5_S0_TP4_GPU4_softmax&#45;&gt;L5_S0_TP4_GPU4_attn_v -->
<g id="edge1588" class="edge">
<title>L5_S0_TP4_GPU4_softmax&#45;&gt;L5_S0_TP4_GPU4_attn_v</title>
<path fill="none" stroke="black" d="M51013,-1220.61C51013,-1220.61 51013,-1194.8 51013,-1194.8"/>
<polygon fill="black" stroke="black" points="51016.5,-1194.8 51013,-1184.8 51009.5,-1194.8 51016.5,-1194.8"/>
</g>
<!-- L5_S0_TP4_GPU4_mha_res -->
<g id="node591" class="node">
<title>L5_S0_TP4_GPU4_mha_res</title>
<polygon fill="none" stroke="black" points="51431.5,-948.5 50544.5,-948.5 50544.5,-880.5 51431.5,-880.5 51431.5,-948.5"/>
<text text-anchor="middle" x="50988" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="50988" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="50988" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="50988" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP4_GPU4_mha_ar&#45;&gt;L5_S0_TP4_GPU4_mha_res -->
<g id="edge1598" class="edge">
<title>L5_S0_TP4_GPU4_mha_ar&#45;&gt;L5_S0_TP4_GPU4_mha_res</title>
<path fill="none" stroke="black" d="M50876.49,-984.55C50876.49,-984.55 50876.49,-958.73 50876.49,-958.73"/>
<polygon fill="black" stroke="black" points="50879.99,-958.73 50876.49,-948.73 50872.99,-958.73 50879.99,-958.73"/>
</g>
<!-- L5_S0_TP4_GPU4_gate -->
<g id="node592" class="node">
<title>L5_S0_TP4_GPU4_gate</title>
<polygon fill="none" stroke="black" points="51517.56,-844.5 50675.15,-844.5 50458.44,-708.5 51300.85,-708.5 51517.56,-844.5"/>
<text text-anchor="middle" x="50988" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="50988" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="50988" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="50988" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L5_S0_TP4_GPU4_mha_res&#45;&gt;L5_S0_TP4_GPU4_gate -->
<g id="edge1599" class="edge">
<title>L5_S0_TP4_GPU4_mha_res&#45;&gt;L5_S0_TP4_GPU4_gate</title>
<path fill="none" stroke="black" d="M50988,-880.39C50988,-880.39 50988,-854.73 50988,-854.73"/>
<polygon fill="black" stroke="black" points="50991.5,-854.73 50988,-844.73 50984.5,-854.73 50991.5,-854.73"/>
</g>
<!-- L5_S0_TP4_GPU4_moe_res -->
<g id="node594" class="node">
<title>L5_S0_TP4_GPU4_moe_res</title>
<polygon fill="none" stroke="black" points="51934,-436.33 51114,-436.33 51114,-368.33 51934,-368.33 51934,-436.33"/>
<text text-anchor="middle" x="51524" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="51524" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="51524" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="51524" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP4_GPU4_mha_res&#45;&gt;L5_S0_TP4_GPU4_moe_res -->
<g id="edge1619" class="edge">
<title>L5_S0_TP4_GPU4_mha_res&#45;&gt;L5_S0_TP4_GPU4_moe_res</title>
<path fill="none" stroke="black" d="M50544.43,-925C50490.81,-925 50454.54,-925 50454.54,-925 50454.54,-925 50454.54,-413 50454.54,-413 50454.54,-413 51103.96,-413 51103.96,-413"/>
<polygon fill="black" stroke="black" points="51103.96,-416.5 51113.96,-413 51103.96,-409.5 51103.96,-416.5"/>
</g>
<!-- L5_S0_TP4_GPU4_gate&#45;&gt;L5_S0_TP4_GPU4_expert0 -->
<g id="edge1600" class="edge">
<title>L5_S0_TP4_GPU4_gate&#45;&gt;L5_S0_TP4_GPU4_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M50794.43,-708.31C50794.43,-708.31 50794.43,-682.71 50794.43,-682.71"/>
<polygon fill="black" stroke="black" points="50797.93,-682.71 50794.43,-672.71 50790.93,-682.71 50797.93,-682.71"/>
</g>
<!-- L5_S0_TP4_GPU4_gate&#45;&gt;L5_S0_TP4_GPU4_expert1 -->
<g id="edge1601" class="edge">
<title>L5_S0_TP4_GPU4_gate&#45;&gt;L5_S0_TP4_GPU4_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M51223.83,-708.31C51223.83,-708.31 51223.83,-682.71 51223.83,-682.71"/>
<polygon fill="black" stroke="black" points="51227.33,-682.71 51223.83,-672.71 51220.33,-682.71 51227.33,-682.71"/>
</g>
<!-- L5_S0_TP4_GPU4_moe_ar&#45;&gt;L5_S0_TP4_GPU4_moe_res -->
<g id="edge1618" class="edge">
<title>L5_S0_TP4_GPU4_moe_ar&#45;&gt;L5_S0_TP4_GPU4_moe_res</title>
<path fill="none" stroke="black" d="M51118.15,-509.52C51118.15,-509.52 51118.15,-446.49 51118.15,-446.49"/>
<polygon fill="black" stroke="black" points="51121.65,-446.49 51118.15,-436.49 51114.65,-446.49 51121.65,-446.49"/>
</g>
<!-- L5_S0_TP4_GPU4_norm -->
<g id="node595" class="node">
<title>L5_S0_TP4_GPU4_norm</title>
<polygon fill="none" stroke="black" points="51748.5,-332.33 51299.5,-332.33 51299.5,-264.33 51748.5,-264.33 51748.5,-332.33"/>
<text text-anchor="middle" x="51524" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="51524" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="51524" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="51524" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP4_GPU4_moe_res&#45;&gt;L5_S0_TP4_GPU4_norm -->
<g id="edge1620" class="edge">
<title>L5_S0_TP4_GPU4_moe_res&#45;&gt;L5_S0_TP4_GPU4_norm</title>
<path fill="none" stroke="black" d="M51524,-368.28C51524,-368.28 51524,-342.46 51524,-342.46"/>
<polygon fill="black" stroke="black" points="51527.5,-342.46 51524,-332.46 51520.5,-342.46 51527.5,-342.46"/>
</g>
<!-- L5_S0_TP5_GPU5_qkv_linear -->
<g id="node596" class="node">
<title>L5_S0_TP5_GPU5_qkv_linear</title>
<polygon fill="none" stroke="black" points="52150,-1614.75 51542,-1614.75 51542,-1546.75 52150,-1546.75 52150,-1614.75"/>
<text text-anchor="middle" x="51846" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="51846" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="51846" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="51846" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L5_S0_TP5_GPU5_qkv_slice -->
<g id="node597" class="node">
<title>L5_S0_TP5_GPU5_qkv_slice</title>
<polygon fill="none" stroke="black" points="52144,-1496.67 51548,-1496.67 51548,-1428.67 52144,-1428.67 52144,-1496.67"/>
<text text-anchor="middle" x="51846" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="51846" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="51846" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="51846" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L5_S0_TP5_GPU5_qkv_linear&#45;&gt;L5_S0_TP5_GPU5_qkv_slice -->
<g id="edge1621" class="edge">
<title>L5_S0_TP5_GPU5_qkv_linear&#45;&gt;L5_S0_TP5_GPU5_qkv_slice</title>
<path fill="none" stroke="black" d="M51846,-1546.59C51846,-1546.59 51846,-1506.74 51846,-1506.74"/>
<polygon fill="black" stroke="black" points="51849.5,-1506.74 51846,-1496.74 51842.5,-1506.74 51849.5,-1506.74"/>
</g>
<!-- L5_S0_TP5_GPU5_qkv_slice&#45;&gt;L5_S0_TP5_GPU5_attn_v -->
<g id="edge1625" class="edge">
<title>L5_S0_TP5_GPU5_qkv_slice&#45;&gt;L5_S0_TP5_GPU5_attn_v</title>
<path fill="none" stroke="black" d="M51597.5,-1428.38C51597.5,-1428.38 51597.5,-1195 51597.5,-1195"/>
<polygon fill="black" stroke="black" points="51601,-1195 51597.5,-1185 51594,-1195 51601,-1195"/>
</g>
<!-- L5_S0_TP5_GPU5_qk_matmul -->
<g id="node598" class="node">
<title>L5_S0_TP5_GPU5_qk_matmul</title>
<polygon fill="none" stroke="black" points="52561.5,-1392.67 51626.5,-1392.67 51626.5,-1324.67 52561.5,-1324.67 52561.5,-1392.67"/>
<text text-anchor="middle" x="52094" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="52094" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="52094" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="52094" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L5_S0_TP5_GPU5_qkv_slice&#45;&gt;L5_S0_TP5_GPU5_qk_matmul -->
<g id="edge1622" class="edge">
<title>L5_S0_TP5_GPU5_qkv_slice&#45;&gt;L5_S0_TP5_GPU5_qk_matmul</title>
<path fill="none" stroke="black" d="M51885.25,-1428.61C51885.25,-1428.61 51885.25,-1402.8 51885.25,-1402.8"/>
<polygon fill="black" stroke="black" points="51888.75,-1402.8 51885.25,-1392.8 51881.75,-1402.8 51888.75,-1402.8"/>
</g>
<!-- L5_S0_TP5_GPU5_softmax -->
<g id="node599" class="node">
<title>L5_S0_TP5_GPU5_softmax</title>
<polygon fill="none" stroke="black" points="52243,-1288.67 51733,-1288.67 51733,-1220.67 52243,-1220.67 52243,-1288.67"/>
<text text-anchor="middle" x="51988" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="51988" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="51988" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="51988" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L5_S0_TP5_GPU5_qk_matmul&#45;&gt;L5_S0_TP5_GPU5_softmax -->
<g id="edge1623" class="edge">
<title>L5_S0_TP5_GPU5_qk_matmul&#45;&gt;L5_S0_TP5_GPU5_softmax</title>
<path fill="none" stroke="black" d="M51988,-1324.61C51988,-1324.61 51988,-1298.8 51988,-1298.8"/>
<polygon fill="black" stroke="black" points="51991.5,-1298.8 51988,-1288.8 51984.5,-1298.8 51991.5,-1298.8"/>
</g>
<!-- L5_S0_TP5_GPU5_softmax&#45;&gt;L5_S0_TP5_GPU5_attn_v -->
<g id="edge1624" class="edge">
<title>L5_S0_TP5_GPU5_softmax&#45;&gt;L5_S0_TP5_GPU5_attn_v</title>
<path fill="none" stroke="black" d="M51988,-1220.61C51988,-1220.61 51988,-1194.8 51988,-1194.8"/>
<polygon fill="black" stroke="black" points="51991.5,-1194.8 51988,-1184.8 51984.5,-1194.8 51991.5,-1194.8"/>
</g>
<!-- L5_S0_TP5_GPU5_mha_res -->
<g id="node601" class="node">
<title>L5_S0_TP5_GPU5_mha_res</title>
<polygon fill="none" stroke="black" points="52509.5,-948.5 51622.5,-948.5 51622.5,-880.5 52509.5,-880.5 52509.5,-948.5"/>
<text text-anchor="middle" x="52066" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="52066" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="52066" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="52066" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP5_GPU5_mha_ar&#45;&gt;L5_S0_TP5_GPU5_mha_res -->
<g id="edge1634" class="edge">
<title>L5_S0_TP5_GPU5_mha_ar&#45;&gt;L5_S0_TP5_GPU5_mha_res</title>
<path fill="none" stroke="black" d="M51799.99,-991.61C51799.99,-991.61 51799.99,-958.74 51799.99,-958.74"/>
<polygon fill="black" stroke="black" points="51803.49,-958.74 51799.99,-948.74 51796.49,-958.74 51803.49,-958.74"/>
</g>
<!-- L5_S0_TP5_GPU5_gate -->
<g id="node602" class="node">
<title>L5_S0_TP5_GPU5_gate</title>
<polygon fill="none" stroke="black" points="52595.56,-844.5 51753.15,-844.5 51536.44,-708.5 52378.85,-708.5 52595.56,-844.5"/>
<text text-anchor="middle" x="52066" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="52066" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="52066" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="52066" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L5_S0_TP5_GPU5_mha_res&#45;&gt;L5_S0_TP5_GPU5_gate -->
<g id="edge1635" class="edge">
<title>L5_S0_TP5_GPU5_mha_res&#45;&gt;L5_S0_TP5_GPU5_gate</title>
<path fill="none" stroke="black" d="M52066,-880.39C52066,-880.39 52066,-854.73 52066,-854.73"/>
<polygon fill="black" stroke="black" points="52069.5,-854.73 52066,-844.73 52062.5,-854.73 52069.5,-854.73"/>
</g>
<!-- L5_S0_TP5_GPU5_moe_res -->
<g id="node604" class="node">
<title>L5_S0_TP5_GPU5_moe_res</title>
<polygon fill="none" stroke="black" points="53156,-436.33 52336,-436.33 52336,-368.33 53156,-368.33 53156,-436.33"/>
<text text-anchor="middle" x="52746" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="52746" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="52746" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="52746" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP5_GPU5_mha_res&#45;&gt;L5_S0_TP5_GPU5_moe_res -->
<g id="edge1655" class="edge">
<title>L5_S0_TP5_GPU5_mha_res&#45;&gt;L5_S0_TP5_GPU5_moe_res</title>
<path fill="none" stroke="black" d="M52509.57,-914C52566.27,-914 52605,-914 52605,-914 52605,-914 52605,-697 52605,-697 52605,-697 53250.5,-697 53250.5,-697 53250.5,-697 53250.5,-402 53250.5,-402 53250.5,-402 53166.2,-402 53166.2,-402"/>
<polygon fill="black" stroke="black" points="53166.2,-398.5 53156.2,-402 53166.2,-405.5 53166.2,-398.5"/>
</g>
<!-- L5_S0_TP5_GPU5_gate&#45;&gt;L5_S0_TP5_GPU5_expert0 -->
<g id="edge1636" class="edge">
<title>L5_S0_TP5_GPU5_gate&#45;&gt;L5_S0_TP5_GPU5_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M51688.36,-708.31C51688.36,-708.31 51688.36,-682.71 51688.36,-682.71"/>
<polygon fill="black" stroke="black" points="51691.86,-682.71 51688.36,-672.71 51684.86,-682.71 51691.86,-682.71"/>
</g>
<!-- L5_S0_TP5_GPU5_gate&#45;&gt;L5_S0_TP5_GPU5_expert1 -->
<g id="edge1637" class="edge">
<title>L5_S0_TP5_GPU5_gate&#45;&gt;L5_S0_TP5_GPU5_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52195.25,-708.31C52195.25,-708.31 52195.25,-682.71 52195.25,-682.71"/>
<polygon fill="black" stroke="black" points="52198.75,-682.71 52195.25,-672.71 52191.75,-682.71 52198.75,-682.71"/>
</g>
<!-- L5_S0_TP5_GPU5_moe_ar&#45;&gt;L5_S0_TP5_GPU5_moe_res -->
<g id="edge1654" class="edge">
<title>L5_S0_TP5_GPU5_moe_ar&#45;&gt;L5_S0_TP5_GPU5_moe_res</title>
<path fill="none" stroke="black" d="M51679.68,-481.67C51679.68,-459.48 51679.68,-436 51679.68,-436 51679.68,-436 52325.9,-436 52325.9,-436"/>
<polygon fill="black" stroke="black" points="52325.9,-439.5 52335.9,-436 52325.9,-432.5 52325.9,-439.5"/>
</g>
<!-- L5_S0_TP5_GPU5_norm -->
<g id="node605" class="node">
<title>L5_S0_TP5_GPU5_norm</title>
<polygon fill="none" stroke="black" points="52970.5,-332.33 52521.5,-332.33 52521.5,-264.33 52970.5,-264.33 52970.5,-332.33"/>
<text text-anchor="middle" x="52746" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="52746" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="52746" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="52746" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP5_GPU5_moe_res&#45;&gt;L5_S0_TP5_GPU5_norm -->
<g id="edge1656" class="edge">
<title>L5_S0_TP5_GPU5_moe_res&#45;&gt;L5_S0_TP5_GPU5_norm</title>
<path fill="none" stroke="black" d="M52746,-368.28C52746,-368.28 52746,-342.46 52746,-342.46"/>
<polygon fill="black" stroke="black" points="52749.5,-342.46 52746,-332.46 52742.5,-342.46 52749.5,-342.46"/>
</g>
<!-- L5_S0_TP6_GPU6_qkv_linear -->
<g id="node606" class="node">
<title>L5_S0_TP6_GPU6_qkv_linear</title>
<polygon fill="none" stroke="black" points="53248,-1614.75 52640,-1614.75 52640,-1546.75 53248,-1546.75 53248,-1614.75"/>
<text text-anchor="middle" x="52944" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="52944" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="52944" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="52944" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L5_S0_TP6_GPU6_qkv_slice -->
<g id="node607" class="node">
<title>L5_S0_TP6_GPU6_qkv_slice</title>
<polygon fill="none" stroke="black" points="53242,-1496.67 52646,-1496.67 52646,-1428.67 53242,-1428.67 53242,-1496.67"/>
<text text-anchor="middle" x="52944" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="52944" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="52944" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="52944" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L5_S0_TP6_GPU6_qkv_linear&#45;&gt;L5_S0_TP6_GPU6_qkv_slice -->
<g id="edge1657" class="edge">
<title>L5_S0_TP6_GPU6_qkv_linear&#45;&gt;L5_S0_TP6_GPU6_qkv_slice</title>
<path fill="none" stroke="black" d="M52944,-1546.59C52944,-1546.59 52944,-1506.74 52944,-1506.74"/>
<polygon fill="black" stroke="black" points="52947.5,-1506.74 52944,-1496.74 52940.5,-1506.74 52947.5,-1506.74"/>
</g>
<!-- L5_S0_TP6_GPU6_qkv_slice&#45;&gt;L5_S0_TP6_GPU6_attn_v -->
<g id="edge1661" class="edge">
<title>L5_S0_TP6_GPU6_qkv_slice&#45;&gt;L5_S0_TP6_GPU6_attn_v</title>
<path fill="none" stroke="black" d="M52685.25,-1428.38C52685.25,-1428.38 52685.25,-1195 52685.25,-1195"/>
<polygon fill="black" stroke="black" points="52688.75,-1195 52685.25,-1185 52681.75,-1195 52688.75,-1195"/>
</g>
<!-- L5_S0_TP6_GPU6_qk_matmul -->
<g id="node608" class="node">
<title>L5_S0_TP6_GPU6_qk_matmul</title>
<polygon fill="none" stroke="black" points="53659.5,-1392.67 52724.5,-1392.67 52724.5,-1324.67 53659.5,-1324.67 53659.5,-1392.67"/>
<text text-anchor="middle" x="53192" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="53192" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="53192" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="53192" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L5_S0_TP6_GPU6_qkv_slice&#45;&gt;L5_S0_TP6_GPU6_qk_matmul -->
<g id="edge1658" class="edge">
<title>L5_S0_TP6_GPU6_qkv_slice&#45;&gt;L5_S0_TP6_GPU6_qk_matmul</title>
<path fill="none" stroke="black" d="M52983.25,-1428.61C52983.25,-1428.61 52983.25,-1402.8 52983.25,-1402.8"/>
<polygon fill="black" stroke="black" points="52986.75,-1402.8 52983.25,-1392.8 52979.75,-1402.8 52986.75,-1402.8"/>
</g>
<!-- L5_S0_TP6_GPU6_softmax -->
<g id="node609" class="node">
<title>L5_S0_TP6_GPU6_softmax</title>
<polygon fill="none" stroke="black" points="53340,-1288.67 52830,-1288.67 52830,-1220.67 53340,-1220.67 53340,-1288.67"/>
<text text-anchor="middle" x="53085" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="53085" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="53085" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="53085" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L5_S0_TP6_GPU6_qk_matmul&#45;&gt;L5_S0_TP6_GPU6_softmax -->
<g id="edge1659" class="edge">
<title>L5_S0_TP6_GPU6_qk_matmul&#45;&gt;L5_S0_TP6_GPU6_softmax</title>
<path fill="none" stroke="black" d="M53085,-1324.61C53085,-1324.61 53085,-1298.8 53085,-1298.8"/>
<polygon fill="black" stroke="black" points="53088.5,-1298.8 53085,-1288.8 53081.5,-1298.8 53088.5,-1298.8"/>
</g>
<!-- L5_S0_TP6_GPU6_softmax&#45;&gt;L5_S0_TP6_GPU6_attn_v -->
<g id="edge1660" class="edge">
<title>L5_S0_TP6_GPU6_softmax&#45;&gt;L5_S0_TP6_GPU6_attn_v</title>
<path fill="none" stroke="black" d="M53068.5,-1220.61C53068.5,-1220.61 53068.5,-1194.8 53068.5,-1194.8"/>
<polygon fill="black" stroke="black" points="53072,-1194.8 53068.5,-1184.8 53065,-1194.8 53072,-1194.8"/>
</g>
<!-- L5_S0_TP6_GPU6_mha_res -->
<g id="node611" class="node">
<title>L5_S0_TP6_GPU6_mha_res</title>
<polygon fill="none" stroke="black" points="53587.5,-948.5 52700.5,-948.5 52700.5,-880.5 53587.5,-880.5 53587.5,-948.5"/>
<text text-anchor="middle" x="53144" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="53144" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="53144" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="53144" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP6_GPU6_mha_ar&#45;&gt;L5_S0_TP6_GPU6_mha_res -->
<g id="edge1670" class="edge">
<title>L5_S0_TP6_GPU6_mha_ar&#45;&gt;L5_S0_TP6_GPU6_mha_res</title>
<path fill="none" stroke="black" d="M52723.49,-1015.91C52723.49,-1015.91 52723.49,-958.58 52723.49,-958.58"/>
<polygon fill="black" stroke="black" points="52726.99,-958.58 52723.49,-948.58 52719.99,-958.58 52726.99,-958.58"/>
</g>
<!-- L5_S0_TP6_GPU6_gate -->
<g id="node612" class="node">
<title>L5_S0_TP6_GPU6_gate</title>
<polygon fill="none" stroke="black" points="53673.56,-844.5 52831.15,-844.5 52614.44,-708.5 53456.85,-708.5 53673.56,-844.5"/>
<text text-anchor="middle" x="53144" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="53144" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="53144" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="53144" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L5_S0_TP6_GPU6_mha_res&#45;&gt;L5_S0_TP6_GPU6_gate -->
<g id="edge1671" class="edge">
<title>L5_S0_TP6_GPU6_mha_res&#45;&gt;L5_S0_TP6_GPU6_gate</title>
<path fill="none" stroke="black" d="M53144,-880.39C53144,-880.39 53144,-854.73 53144,-854.73"/>
<polygon fill="black" stroke="black" points="53147.5,-854.73 53144,-844.73 53140.5,-854.73 53147.5,-854.73"/>
</g>
<!-- L5_S0_TP6_GPU6_moe_res -->
<g id="node614" class="node">
<title>L5_S0_TP6_GPU6_moe_res</title>
<polygon fill="none" stroke="black" points="54092,-436.33 53272,-436.33 53272,-368.33 54092,-368.33 54092,-436.33"/>
<text text-anchor="middle" x="53682" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="53682" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="53682" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="53682" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP6_GPU6_mha_res&#45;&gt;L5_S0_TP6_GPU6_moe_res -->
<g id="edge1691" class="edge">
<title>L5_S0_TP6_GPU6_mha_res&#45;&gt;L5_S0_TP6_GPU6_moe_res</title>
<path fill="none" stroke="black" d="M53587.57,-914C53644.27,-914 53683,-914 53683,-914 53683,-914 53683,-693 53683,-693 53683,-693 53717.5,-693 53717.5,-693 53717.5,-693 53717.5,-446.53 53717.5,-446.53"/>
<polygon fill="black" stroke="black" points="53721,-446.53 53717.5,-436.53 53714,-446.53 53721,-446.53"/>
</g>
<!-- L5_S0_TP6_GPU6_gate&#45;&gt;L5_S0_TP6_GPU6_expert0 -->
<g id="edge1672" class="edge">
<title>L5_S0_TP6_GPU6_gate&#45;&gt;L5_S0_TP6_GPU6_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52694.36,-708.31C52694.36,-708.31 52694.36,-682.71 52694.36,-682.71"/>
<polygon fill="black" stroke="black" points="52697.86,-682.71 52694.36,-672.71 52690.86,-682.71 52697.86,-682.71"/>
</g>
<!-- L5_S0_TP6_GPU6_gate&#45;&gt;L5_S0_TP6_GPU6_expert1 -->
<g id="edge1673" class="edge">
<title>L5_S0_TP6_GPU6_gate&#45;&gt;L5_S0_TP6_GPU6_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53017,-708.31C53017,-708.31 53017,-682.71 53017,-682.71"/>
<polygon fill="black" stroke="black" points="53020.5,-682.71 53017,-672.71 53013.5,-682.71 53020.5,-682.71"/>
</g>
<!-- L5_S0_TP6_GPU6_moe_ar&#45;&gt;L5_S0_TP6_GPU6_moe_res -->
<g id="edge1690" class="edge">
<title>L5_S0_TP6_GPU6_moe_ar&#45;&gt;L5_S0_TP6_GPU6_moe_res</title>
<path fill="none" stroke="black" d="M52445.64,-494.02C52445.64,-469.58 52445.64,-437 52445.64,-437 52445.64,-437 53446.6,-437 53446.6,-437 53446.6,-437 53446.6,-436.96 53446.6,-436.96"/>
<polygon fill="black" stroke="black" points="53450.1,-446.61 53446.6,-436.61 53443.1,-446.61 53450.1,-446.61"/>
</g>
<!-- L5_S0_TP6_GPU6_norm -->
<g id="node615" class="node">
<title>L5_S0_TP6_GPU6_norm</title>
<polygon fill="none" stroke="black" points="53906.5,-332.33 53457.5,-332.33 53457.5,-264.33 53906.5,-264.33 53906.5,-332.33"/>
<text text-anchor="middle" x="53682" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="53682" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="53682" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="53682" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP6_GPU6_moe_res&#45;&gt;L5_S0_TP6_GPU6_norm -->
<g id="edge1692" class="edge">
<title>L5_S0_TP6_GPU6_moe_res&#45;&gt;L5_S0_TP6_GPU6_norm</title>
<path fill="none" stroke="black" d="M53682,-368.28C53682,-368.28 53682,-342.46 53682,-342.46"/>
<polygon fill="black" stroke="black" points="53685.5,-342.46 53682,-332.46 53678.5,-342.46 53685.5,-342.46"/>
</g>
<!-- L5_S0_TP7_GPU7_qkv_linear -->
<g id="node616" class="node">
<title>L5_S0_TP7_GPU7_qkv_linear</title>
<polygon fill="none" stroke="black" points="54293,-1614.75 53685,-1614.75 53685,-1546.75 54293,-1546.75 54293,-1614.75"/>
<text text-anchor="middle" x="53989" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="53989" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="53989" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="53989" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L5_S0_TP7_GPU7_qkv_slice -->
<g id="node617" class="node">
<title>L5_S0_TP7_GPU7_qkv_slice</title>
<polygon fill="none" stroke="black" points="54287,-1496.67 53691,-1496.67 53691,-1428.67 54287,-1428.67 54287,-1496.67"/>
<text text-anchor="middle" x="53989" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="53989" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="53989" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="53989" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L5_S0_TP7_GPU7_qkv_linear&#45;&gt;L5_S0_TP7_GPU7_qkv_slice -->
<g id="edge1693" class="edge">
<title>L5_S0_TP7_GPU7_qkv_linear&#45;&gt;L5_S0_TP7_GPU7_qkv_slice</title>
<path fill="none" stroke="black" d="M53989,-1546.59C53989,-1546.59 53989,-1506.74 53989,-1506.74"/>
<polygon fill="black" stroke="black" points="53992.5,-1506.74 53989,-1496.74 53985.5,-1506.74 53992.5,-1506.74"/>
</g>
<!-- L5_S0_TP7_GPU7_qkv_slice&#45;&gt;L5_S0_TP7_GPU7_attn_v -->
<g id="edge1697" class="edge">
<title>L5_S0_TP7_GPU7_qkv_slice&#45;&gt;L5_S0_TP7_GPU7_attn_v</title>
<path fill="none" stroke="black" d="M53730.25,-1428.38C53730.25,-1428.38 53730.25,-1195 53730.25,-1195"/>
<polygon fill="black" stroke="black" points="53733.75,-1195 53730.25,-1185 53726.75,-1195 53733.75,-1195"/>
</g>
<!-- L5_S0_TP7_GPU7_qk_matmul -->
<g id="node618" class="node">
<title>L5_S0_TP7_GPU7_qk_matmul</title>
<polygon fill="none" stroke="black" points="54704.5,-1392.67 53769.5,-1392.67 53769.5,-1324.67 54704.5,-1324.67 54704.5,-1392.67"/>
<text text-anchor="middle" x="54237" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="54237" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="54237" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="54237" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L5_S0_TP7_GPU7_qkv_slice&#45;&gt;L5_S0_TP7_GPU7_qk_matmul -->
<g id="edge1694" class="edge">
<title>L5_S0_TP7_GPU7_qkv_slice&#45;&gt;L5_S0_TP7_GPU7_qk_matmul</title>
<path fill="none" stroke="black" d="M54028.25,-1428.61C54028.25,-1428.61 54028.25,-1402.8 54028.25,-1402.8"/>
<polygon fill="black" stroke="black" points="54031.75,-1402.8 54028.25,-1392.8 54024.75,-1402.8 54031.75,-1402.8"/>
</g>
<!-- L5_S0_TP7_GPU7_softmax -->
<g id="node619" class="node">
<title>L5_S0_TP7_GPU7_softmax</title>
<polygon fill="none" stroke="black" points="54385,-1288.67 53875,-1288.67 53875,-1220.67 54385,-1220.67 54385,-1288.67"/>
<text text-anchor="middle" x="54130" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="54130" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="54130" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="54130" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L5_S0_TP7_GPU7_qk_matmul&#45;&gt;L5_S0_TP7_GPU7_softmax -->
<g id="edge1695" class="edge">
<title>L5_S0_TP7_GPU7_qk_matmul&#45;&gt;L5_S0_TP7_GPU7_softmax</title>
<path fill="none" stroke="black" d="M54130,-1324.61C54130,-1324.61 54130,-1298.8 54130,-1298.8"/>
<polygon fill="black" stroke="black" points="54133.5,-1298.8 54130,-1288.8 54126.5,-1298.8 54133.5,-1298.8"/>
</g>
<!-- L5_S0_TP7_GPU7_softmax&#45;&gt;L5_S0_TP7_GPU7_attn_v -->
<g id="edge1696" class="edge">
<title>L5_S0_TP7_GPU7_softmax&#45;&gt;L5_S0_TP7_GPU7_attn_v</title>
<path fill="none" stroke="black" d="M54069,-1220.61C54069,-1220.61 54069,-1194.8 54069,-1194.8"/>
<polygon fill="black" stroke="black" points="54072.5,-1194.8 54069,-1184.8 54065.5,-1194.8 54072.5,-1194.8"/>
</g>
<!-- L5_S0_TP7_GPU7_mha_res -->
<g id="node621" class="node">
<title>L5_S0_TP7_GPU7_mha_res</title>
<polygon fill="none" stroke="black" points="54665.5,-948.5 53778.5,-948.5 53778.5,-880.5 54665.5,-880.5 54665.5,-948.5"/>
<text text-anchor="middle" x="54222" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="54222" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="54222" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="54222" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP7_GPU7_mha_ar&#45;&gt;L5_S0_TP7_GPU7_mha_res -->
<g id="edge1706" class="edge">
<title>L5_S0_TP7_GPU7_mha_ar&#45;&gt;L5_S0_TP7_GPU7_mha_res</title>
<path fill="none" stroke="black" d="M53495.7,-1048C53740.14,-1048 54020.75,-1048 54020.75,-1048 54020.75,-1048 54020.75,-958.53 54020.75,-958.53"/>
<polygon fill="black" stroke="black" points="54024.25,-958.53 54020.75,-948.53 54017.25,-958.53 54024.25,-958.53"/>
</g>
<!-- L5_S0_TP7_GPU7_gate -->
<g id="node622" class="node">
<title>L5_S0_TP7_GPU7_gate</title>
<polygon fill="none" stroke="black" points="54751.56,-844.5 53909.15,-844.5 53692.44,-708.5 54534.85,-708.5 54751.56,-844.5"/>
<text text-anchor="middle" x="54222" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="54222" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="54222" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="54222" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L5_S0_TP7_GPU7_mha_res&#45;&gt;L5_S0_TP7_GPU7_gate -->
<g id="edge1707" class="edge">
<title>L5_S0_TP7_GPU7_mha_res&#45;&gt;L5_S0_TP7_GPU7_gate</title>
<path fill="none" stroke="black" d="M54222,-880.39C54222,-880.39 54222,-854.73 54222,-854.73"/>
<polygon fill="black" stroke="black" points="54225.5,-854.73 54222,-844.73 54218.5,-854.73 54225.5,-854.73"/>
</g>
<!-- L5_S0_TP7_GPU7_moe_res -->
<g id="node624" class="node">
<title>L5_S0_TP7_GPU7_moe_res</title>
<polygon fill="none" stroke="black" points="55027,-436.33 54207,-436.33 54207,-368.33 55027,-368.33 55027,-436.33"/>
<text text-anchor="middle" x="54617" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="54617" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="54617" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="54617" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP7_GPU7_mha_res&#45;&gt;L5_S0_TP7_GPU7_moe_res -->
<g id="edge1727" class="edge">
<title>L5_S0_TP7_GPU7_mha_res&#45;&gt;L5_S0_TP7_GPU7_moe_res</title>
<path fill="none" stroke="black" d="M54665.77,-925C54788.82,-925 54889.39,-925 54889.39,-925 54889.39,-925 54889.39,-446.63 54889.39,-446.63"/>
<polygon fill="black" stroke="black" points="54892.89,-446.63 54889.39,-436.63 54885.89,-446.63 54892.89,-446.63"/>
</g>
<!-- L5_S0_TP7_GPU7_gate&#45;&gt;L5_S0_TP7_GPU7_expert0 -->
<g id="edge1708" class="edge">
<title>L5_S0_TP7_GPU7_gate&#45;&gt;L5_S0_TP7_GPU7_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53700.36,-776.4C53700.36,-776.4 53700.36,-682.74 53700.36,-682.74"/>
<polygon fill="black" stroke="black" points="53703.86,-682.74 53700.36,-672.74 53696.86,-682.74 53703.86,-682.74"/>
</g>
<!-- L5_S0_TP7_GPU7_gate&#45;&gt;L5_S0_TP7_GPU7_expert1 -->
<g id="edge1709" class="edge">
<title>L5_S0_TP7_GPU7_gate&#45;&gt;L5_S0_TP7_GPU7_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53951,-708.31C53951,-708.31 53951,-682.71 53951,-682.71"/>
<polygon fill="black" stroke="black" points="53954.5,-682.71 53951,-672.71 53947.5,-682.71 53954.5,-682.71"/>
</g>
<!-- L5_S0_TP7_GPU7_moe_ar&#45;&gt;L5_S0_TP7_GPU7_moe_res -->
<g id="edge1726" class="edge">
<title>L5_S0_TP7_GPU7_moe_ar&#45;&gt;L5_S0_TP7_GPU7_moe_res</title>
<path fill="none" stroke="black" d="M53184.58,-527C53660.18,-527 54479.39,-527 54479.39,-527 54479.39,-527 54479.39,-446.4 54479.39,-446.4"/>
<polygon fill="black" stroke="black" points="54482.89,-446.4 54479.39,-436.4 54475.89,-446.4 54482.89,-446.4"/>
</g>
<!-- L5_S0_TP7_GPU7_norm -->
<g id="node625" class="node">
<title>L5_S0_TP7_GPU7_norm</title>
<polygon fill="none" stroke="black" points="54841.5,-332.33 54392.5,-332.33 54392.5,-264.33 54841.5,-264.33 54841.5,-332.33"/>
<text text-anchor="middle" x="54617" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="54617" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="54617" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="54617" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L5_S0_TP7_GPU7_moe_res&#45;&gt;L5_S0_TP7_GPU7_norm -->
<g id="edge1728" class="edge">
<title>L5_S0_TP7_GPU7_moe_res&#45;&gt;L5_S0_TP7_GPU7_norm</title>
<path fill="none" stroke="black" d="M54617,-368.28C54617,-368.28 54617,-342.46 54617,-342.46"/>
<polygon fill="black" stroke="black" points="54620.5,-342.46 54617,-332.46 54613.5,-342.46 54620.5,-342.46"/>
</g>
<!-- L6_S0_TP0_GPU0_qkv_linear -->
<g id="node626" class="node">
<title>L6_S0_TP0_GPU0_qkv_linear</title>
<polygon fill="none" stroke="black" points="56427,-1614.75 55819,-1614.75 55819,-1546.75 56427,-1546.75 56427,-1614.75"/>
<text text-anchor="middle" x="56123" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="56123" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="56123" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="56123" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L6_S0_TP0_GPU0_qkv_slice -->
<g id="node627" class="node">
<title>L6_S0_TP0_GPU0_qkv_slice</title>
<polygon fill="none" stroke="black" points="56421,-1496.67 55825,-1496.67 55825,-1428.67 56421,-1428.67 56421,-1496.67"/>
<text text-anchor="middle" x="56123" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="56123" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="56123" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="56123" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L6_S0_TP0_GPU0_qkv_linear&#45;&gt;L6_S0_TP0_GPU0_qkv_slice -->
<g id="edge1729" class="edge">
<title>L6_S0_TP0_GPU0_qkv_linear&#45;&gt;L6_S0_TP0_GPU0_qkv_slice</title>
<path fill="none" stroke="black" d="M56123,-1546.59C56123,-1546.59 56123,-1506.74 56123,-1506.74"/>
<polygon fill="black" stroke="black" points="56126.5,-1506.74 56123,-1496.74 56119.5,-1506.74 56126.5,-1506.74"/>
</g>
<!-- L6_S0_TP0_GPU0_qk_matmul -->
<g id="node628" class="node">
<title>L6_S0_TP0_GPU0_qk_matmul</title>
<polygon fill="none" stroke="black" points="56838.5,-1392.67 55903.5,-1392.67 55903.5,-1324.67 56838.5,-1324.67 56838.5,-1392.67"/>
<text text-anchor="middle" x="56371" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="56371" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="56371" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="56371" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L6_S0_TP0_GPU0_qkv_slice&#45;&gt;L6_S0_TP0_GPU0_qk_matmul -->
<g id="edge1730" class="edge">
<title>L6_S0_TP0_GPU0_qkv_slice&#45;&gt;L6_S0_TP0_GPU0_qk_matmul</title>
<path fill="none" stroke="black" d="M56162.25,-1428.61C56162.25,-1428.61 56162.25,-1402.8 56162.25,-1402.8"/>
<polygon fill="black" stroke="black" points="56165.75,-1402.8 56162.25,-1392.8 56158.75,-1402.8 56165.75,-1402.8"/>
</g>
<!-- L6_S0_TP0_GPU0_attn_v -->
<g id="node630" class="node">
<title>L6_S0_TP0_GPU0_attn_v</title>
<polygon fill="none" stroke="black" points="56839,-1184.67 55901,-1184.67 55901,-1116.67 56839,-1116.67 56839,-1184.67"/>
<text text-anchor="middle" x="56370" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="56370" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="56370" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="56370" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L6_S0_TP0_GPU0_qkv_slice&#45;&gt;L6_S0_TP0_GPU0_attn_v -->
<g id="edge1733" class="edge">
<title>L6_S0_TP0_GPU0_qkv_slice&#45;&gt;L6_S0_TP0_GPU0_attn_v</title>
<path fill="none" stroke="black" d="M55863,-1428.61C55863,-1347.57 55863,-1150 55863,-1150 55863,-1150 55890.69,-1150 55890.69,-1150"/>
<polygon fill="black" stroke="black" points="55890.69,-1153.5 55900.69,-1150 55890.69,-1146.5 55890.69,-1153.5"/>
</g>
<!-- L6_S0_TP0_GPU0_softmax -->
<g id="node629" class="node">
<title>L6_S0_TP0_GPU0_softmax</title>
<polygon fill="none" stroke="black" points="56625,-1288.67 56115,-1288.67 56115,-1220.67 56625,-1220.67 56625,-1288.67"/>
<text text-anchor="middle" x="56370" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="56370" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="56370" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="56370" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L6_S0_TP0_GPU0_qk_matmul&#45;&gt;L6_S0_TP0_GPU0_softmax -->
<g id="edge1731" class="edge">
<title>L6_S0_TP0_GPU0_qk_matmul&#45;&gt;L6_S0_TP0_GPU0_softmax</title>
<path fill="none" stroke="black" d="M56370,-1324.61C56370,-1324.61 56370,-1298.8 56370,-1298.8"/>
<polygon fill="black" stroke="black" points="56373.5,-1298.8 56370,-1288.8 56366.5,-1298.8 56373.5,-1298.8"/>
</g>
<!-- L6_S0_TP0_GPU0_softmax&#45;&gt;L6_S0_TP0_GPU0_attn_v -->
<g id="edge1732" class="edge">
<title>L6_S0_TP0_GPU0_softmax&#45;&gt;L6_S0_TP0_GPU0_attn_v</title>
<path fill="none" stroke="black" d="M56370,-1220.61C56370,-1220.61 56370,-1194.8 56370,-1194.8"/>
<polygon fill="black" stroke="black" points="56373.5,-1194.8 56370,-1184.8 56366.5,-1194.8 56373.5,-1194.8"/>
</g>
<!-- L6_S0_TP0_GPU0_mha_ar -->
<g id="node631" class="node">
<title>L6_S0_TP0_GPU0_mha_ar</title>
<ellipse fill="none" stroke="black" cx="57024" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="57024" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="57024" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="57024" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="57024" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP0_GPU0_attn_v&#45;&gt;L6_S0_TP0_GPU0_mha_ar -->
<g id="edge1734" class="edge">
<title>L6_S0_TP0_GPU0_attn_v&#45;&gt;L6_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M56672.34,-1116.51C56672.34,-1116.51 56672.34,-1059.62 56672.34,-1059.62"/>
<polygon fill="black" stroke="black" points="56675.84,-1059.62 56672.34,-1049.62 56668.84,-1059.62 56675.84,-1059.62"/>
</g>
<!-- L6_S0_TP1_GPU1_mha_ar -->
<g id="node664" class="node">
<title>L6_S0_TP1_GPU1_mha_ar</title>
<ellipse fill="none" stroke="black" cx="57793" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="57793" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="57793" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="57793" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="57793" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP0_GPU0_attn_v&#45;&gt;L6_S0_TP1_GPU1_mha_ar -->
<g id="edge1770" class="edge">
<title>L6_S0_TP0_GPU0_attn_v&#45;&gt;L6_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M56696.14,-1116.33C56696.14,-1099.17 56696.14,-1082 56696.14,-1082 56696.14,-1082 57464.71,-1082 57464.71,-1082 57464.71,-1082 57464.71,-1066.13 57464.71,-1066.13"/>
<polygon fill="black" stroke="black" points="57468.21,-1066.13 57464.71,-1056.13 57461.21,-1066.13 57468.21,-1066.13"/>
</g>
<!-- L6_S0_TP2_GPU2_mha_ar -->
<g id="node674" class="node">
<title>L6_S0_TP2_GPU2_mha_ar</title>
<ellipse fill="none" stroke="black" cx="58562" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="58562" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="58562" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="58562" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="58562" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP0_GPU0_attn_v&#45;&gt;L6_S0_TP2_GPU2_mha_ar -->
<g id="edge1806" class="edge">
<title>L6_S0_TP0_GPU0_attn_v&#45;&gt;L6_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M56719.95,-1116.44C56719.95,-1099.65 56719.95,-1083 56719.95,-1083 56719.95,-1083 58257.09,-1083 58257.09,-1083 58257.09,-1083 58257.09,-1070.74 58257.09,-1070.74"/>
<polygon fill="black" stroke="black" points="58260.59,-1070.74 58257.09,-1060.74 58253.59,-1070.74 58260.59,-1070.74"/>
</g>
<!-- L6_S0_TP3_GPU3_mha_ar -->
<g id="node684" class="node">
<title>L6_S0_TP3_GPU3_mha_ar</title>
<ellipse fill="none" stroke="black" cx="59331" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="59331" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="59331" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="59331" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="59331" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP0_GPU0_attn_v&#45;&gt;L6_S0_TP3_GPU3_mha_ar -->
<g id="edge1842" class="edge">
<title>L6_S0_TP0_GPU0_attn_v&#45;&gt;L6_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M56743.76,-1116.44C56743.76,-1099.65 56743.76,-1083 56743.76,-1083 56743.76,-1083 59062.8,-1083 59062.8,-1083 59062.8,-1083 59062.8,-1076.49 59062.8,-1076.49"/>
<polygon fill="black" stroke="black" points="59066.3,-1076.49 59062.8,-1066.49 59059.3,-1076.49 59066.3,-1076.49"/>
</g>
<!-- L6_S0_TP4_GPU4_mha_ar -->
<g id="node694" class="node">
<title>L6_S0_TP4_GPU4_mha_ar</title>
<ellipse fill="none" stroke="black" cx="60100" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="60100" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="60100" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="60100" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="60100" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP0_GPU0_attn_v&#45;&gt;L6_S0_TP4_GPU4_mha_ar -->
<g id="edge1878" class="edge">
<title>L6_S0_TP0_GPU0_attn_v&#45;&gt;L6_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M56613.01,-1116.58C56613.01,-1060.52 56613.01,-955 56613.01,-955 56613.01,-955 59782.74,-955 59782.74,-955 59782.74,-955 59782.74,-996.75 59782.74,-996.75"/>
<polygon fill="black" stroke="black" points="59779.24,-996.75 59782.74,-1006.75 59786.24,-996.75 59779.24,-996.75"/>
</g>
<!-- L6_S0_TP5_GPU5_mha_ar -->
<g id="node704" class="node">
<title>L6_S0_TP5_GPU5_mha_ar</title>
<ellipse fill="none" stroke="black" cx="60869" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="60869" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="60869" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="60869" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="60869" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP0_GPU0_attn_v&#45;&gt;L6_S0_TP5_GPU5_mha_ar -->
<g id="edge1914" class="edge">
<title>L6_S0_TP0_GPU0_attn_v&#45;&gt;L6_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M56767.57,-1116.59C56767.57,-1107.42 56767.57,-1100 56767.57,-1100 56767.57,-1100 60521.77,-1100 60521.77,-1100 60521.77,-1100 60521.77,-1061 60521.77,-1061"/>
<polygon fill="black" stroke="black" points="60525.27,-1061 60521.77,-1051 60518.27,-1061 60525.27,-1061"/>
</g>
<!-- L6_S0_TP6_GPU6_mha_ar -->
<g id="node714" class="node">
<title>L6_S0_TP6_GPU6_mha_ar</title>
<ellipse fill="none" stroke="black" cx="61638" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="61638" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="61638" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="61638" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="61638" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP0_GPU0_attn_v&#45;&gt;L6_S0_TP6_GPU6_mha_ar -->
<g id="edge1950" class="edge">
<title>L6_S0_TP0_GPU0_attn_v&#45;&gt;L6_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M56791.38,-1116.59C56791.38,-1107.42 56791.38,-1100 56791.38,-1100 56791.38,-1100 61313.45,-1100 61313.45,-1100 61313.45,-1100 61313.45,-1066.92 61313.45,-1066.92"/>
<polygon fill="black" stroke="black" points="61316.95,-1066.92 61313.45,-1056.92 61309.95,-1066.92 61316.95,-1066.92"/>
</g>
<!-- L6_S0_TP7_GPU7_mha_ar -->
<g id="node724" class="node">
<title>L6_S0_TP7_GPU7_mha_ar</title>
<ellipse fill="none" stroke="black" cx="62407" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="62407" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="62407" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="62407" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="62407" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP0_GPU0_attn_v&#45;&gt;L6_S0_TP7_GPU7_mha_ar -->
<g id="edge1986" class="edge">
<title>L6_S0_TP0_GPU0_attn_v&#45;&gt;L6_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M56815.19,-1116.59C56815.19,-1107.42 56815.19,-1100 56815.19,-1100 56815.19,-1100 62099.46,-1100 62099.46,-1100 62099.46,-1100 62099.46,-1070.39 62099.46,-1070.39"/>
<polygon fill="black" stroke="black" points="62102.96,-1070.39 62099.46,-1060.39 62095.96,-1070.39 62102.96,-1070.39"/>
</g>
<!-- L6_S0_TP0_GPU0_mha_res -->
<g id="node639" class="node">
<title>L6_S0_TP0_GPU0_mha_res</title>
<polygon fill="none" stroke="black" points="56386.5,-948.5 55499.5,-948.5 55499.5,-880.5 56386.5,-880.5 56386.5,-948.5"/>
<text text-anchor="middle" x="55943" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="55943" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="55943" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="55943" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP0_GPU0_mha_ar&#45;&gt;L6_S0_TP0_GPU0_mha_res -->
<g id="edge1742" class="edge">
<title>L6_S0_TP0_GPU0_mha_ar&#45;&gt;L6_S0_TP0_GPU0_mha_res</title>
<path fill="none" stroke="black" d="M56671.36,-1016C56426.39,-1016 56143.75,-1016 56143.75,-1016 56143.75,-1016 56143.75,-958.58 56143.75,-958.58"/>
<polygon fill="black" stroke="black" points="56147.25,-958.58 56143.75,-948.58 56140.25,-958.58 56147.25,-958.58"/>
</g>
<!-- L6_S0_TP1_GPU1_attn_v -->
<g id="node632" class="node">
<title>L6_S0_TP1_GPU1_attn_v</title>
<polygon fill="none" stroke="black" points="57795,-1184.67 56857,-1184.67 56857,-1116.67 57795,-1116.67 57795,-1184.67"/>
<text text-anchor="middle" x="57326" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="57326" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="57326" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="57326" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L6_S0_TP1_GPU1_attn_v&#45;&gt;L6_S0_TP0_GPU0_mha_ar -->
<g id="edge1735" class="edge">
<title>L6_S0_TP1_GPU1_attn_v&#45;&gt;L6_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M56924.81,-1116.51C56924.81,-1116.51 56924.81,-1088.96 56924.81,-1088.96"/>
<polygon fill="black" stroke="black" points="56928.31,-1088.96 56924.81,-1078.96 56921.31,-1088.96 56928.31,-1088.96"/>
</g>
<!-- L6_S0_TP1_GPU1_attn_v&#45;&gt;L6_S0_TP1_GPU1_mha_ar -->
<g id="edge1771" class="edge">
<title>L6_S0_TP1_GPU1_attn_v&#45;&gt;L6_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M57511.89,-1116.51C57511.89,-1116.51 57511.89,-1074.64 57511.89,-1074.64"/>
<polygon fill="black" stroke="black" points="57515.39,-1074.64 57511.89,-1064.64 57508.39,-1074.64 57515.39,-1074.64"/>
</g>
<!-- L6_S0_TP1_GPU1_attn_v&#45;&gt;L6_S0_TP2_GPU2_mha_ar -->
<g id="edge1807" class="edge">
<title>L6_S0_TP1_GPU1_attn_v&#45;&gt;L6_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M57559.08,-1116.44C57559.08,-1099.65 57559.08,-1083 57559.08,-1083 57559.08,-1083 58327.64,-1083 58327.64,-1083 58327.64,-1083 58327.64,-1080.28 58327.64,-1080.28"/>
<polygon fill="black" stroke="black" points="58331.14,-1080.28 58327.64,-1070.28 58324.14,-1080.28 58331.14,-1080.28"/>
</g>
<!-- L6_S0_TP1_GPU1_attn_v&#45;&gt;L6_S0_TP3_GPU3_mha_ar -->
<g id="edge1843" class="edge">
<title>L6_S0_TP1_GPU1_attn_v&#45;&gt;L6_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M57606.26,-1116.44C57606.26,-1099.65 57606.26,-1083 57606.26,-1083 57606.26,-1083 59170.08,-1083 59170.08,-1083 59170.08,-1083 59170.08,-1082.34 59170.08,-1082.34"/>
<polygon fill="black" stroke="black" points="59173.58,-1086.41 59170.08,-1076.41 59166.58,-1086.41 59173.58,-1086.41"/>
</g>
<!-- L6_S0_TP1_GPU1_attn_v&#45;&gt;L6_S0_TP4_GPU4_mha_ar -->
<g id="edge1879" class="edge">
<title>L6_S0_TP1_GPU1_attn_v&#45;&gt;L6_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M57408.5,-1116.58C57408.5,-1060.52 57408.5,-955 57408.5,-955 57408.5,-955 59753.98,-955 59753.98,-955 59753.98,-955 59753.98,-1003.8 59753.98,-1003.8"/>
<polygon fill="black" stroke="black" points="59750.48,-1003.8 59753.98,-1013.8 59757.48,-1003.8 59750.48,-1003.8"/>
</g>
<!-- L6_S0_TP1_GPU1_attn_v&#45;&gt;L6_S0_TP5_GPU5_mha_ar -->
<g id="edge1915" class="edge">
<title>L6_S0_TP1_GPU1_attn_v&#45;&gt;L6_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M57653.45,-1116.59C57653.45,-1107.42 57653.45,-1100 57653.45,-1100 57653.45,-1100 60550.02,-1100 60550.02,-1100 60550.02,-1100 60550.02,-1068.07 60550.02,-1068.07"/>
<polygon fill="black" stroke="black" points="60553.52,-1068.07 60550.02,-1058.07 60546.52,-1068.07 60553.52,-1068.07"/>
</g>
<!-- L6_S0_TP1_GPU1_attn_v&#45;&gt;L6_S0_TP6_GPU6_mha_ar -->
<g id="edge1951" class="edge">
<title>L6_S0_TP1_GPU1_attn_v&#45;&gt;L6_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M57700.63,-1116.59C57700.63,-1107.42 57700.63,-1100 57700.63,-1100 57700.63,-1100 61364.38,-1100 61364.38,-1100 61364.38,-1100 61364.38,-1075.9 61364.38,-1075.9"/>
<polygon fill="black" stroke="black" points="61367.88,-1075.9 61364.38,-1065.9 61360.88,-1075.9 61367.88,-1075.9"/>
</g>
<!-- L6_S0_TP1_GPU1_attn_v&#45;&gt;L6_S0_TP7_GPU7_mha_ar -->
<g id="edge1987" class="edge">
<title>L6_S0_TP1_GPU1_attn_v&#45;&gt;L6_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M57747.82,-1116.59C57747.82,-1107.42 57747.82,-1100 57747.82,-1100 57747.82,-1100 62167.39,-1100 62167.39,-1100 62167.39,-1100 62167.39,-1079.84 62167.39,-1079.84"/>
<polygon fill="black" stroke="black" points="62170.89,-1079.84 62167.39,-1069.84 62163.89,-1079.84 62170.89,-1079.84"/>
</g>
<!-- L6_S0_TP2_GPU2_attn_v -->
<g id="node633" class="node">
<title>L6_S0_TP2_GPU2_attn_v</title>
<polygon fill="none" stroke="black" points="58751,-1184.67 57813,-1184.67 57813,-1116.67 58751,-1116.67 58751,-1184.67"/>
<text text-anchor="middle" x="58282" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="58282" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="58282" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="58282" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L6_S0_TP2_GPU2_attn_v&#45;&gt;L6_S0_TP0_GPU0_mha_ar -->
<g id="edge1736" class="edge">
<title>L6_S0_TP2_GPU2_attn_v&#45;&gt;L6_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M57872.25,-1116.41C57872.25,-1114.9 57872.25,-1114 57872.25,-1114 57872.25,-1114 56992.62,-1114 56992.62,-1114 56992.62,-1114 56992.62,-1090.88 56992.62,-1090.88"/>
<polygon fill="black" stroke="black" points="56996.12,-1090.88 56992.62,-1080.88 56989.12,-1090.88 56996.12,-1090.88"/>
</g>
<!-- L6_S0_TP2_GPU2_attn_v&#45;&gt;L6_S0_TP1_GPU1_mha_ar -->
<g id="edge1772" class="edge">
<title>L6_S0_TP2_GPU2_attn_v&#45;&gt;L6_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M57931.49,-1116.51C57931.49,-1116.51 57931.49,-1087.65 57931.49,-1087.65"/>
<polygon fill="black" stroke="black" points="57934.99,-1087.65 57931.49,-1077.65 57927.99,-1087.65 57934.99,-1087.65"/>
</g>
<!-- L6_S0_TP2_GPU2_attn_v&#45;&gt;L6_S0_TP2_GPU2_mha_ar -->
<g id="edge1808" class="edge">
<title>L6_S0_TP2_GPU2_attn_v&#45;&gt;L6_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M58398.2,-1116.51C58398.2,-1116.51 58398.2,-1085.92 58398.2,-1085.92"/>
<polygon fill="black" stroke="black" points="58401.7,-1085.92 58398.2,-1075.92 58394.7,-1085.92 58401.7,-1085.92"/>
</g>
<!-- L6_S0_TP2_GPU2_attn_v&#45;&gt;L6_S0_TP3_GPU3_mha_ar -->
<g id="edge1844" class="edge">
<title>L6_S0_TP2_GPU2_attn_v&#45;&gt;L6_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M58468.76,-1116.44C58468.76,-1099.65 58468.76,-1083 58468.76,-1083 58468.76,-1083 59277.36,-1083 59277.36,-1083 59277.36,-1083 59277.36,-1082.73 59277.36,-1082.73"/>
<polygon fill="black" stroke="black" points="59280.86,-1090.29 59277.36,-1080.29 59273.86,-1090.29 59280.86,-1090.29"/>
</g>
<!-- L6_S0_TP2_GPU2_attn_v&#45;&gt;L6_S0_TP4_GPU4_mha_ar -->
<g id="edge1880" class="edge">
<title>L6_S0_TP2_GPU2_attn_v&#45;&gt;L6_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M58539.32,-1116.44C58539.32,-1107.84 58539.32,-1101 58539.32,-1101 58539.32,-1101 59939.42,-1101 59939.42,-1101 59939.42,-1101 59939.42,-1086.3 59939.42,-1086.3"/>
<polygon fill="black" stroke="black" points="59942.92,-1086.3 59939.42,-1076.3 59935.92,-1086.3 59942.92,-1086.3"/>
</g>
<!-- L6_S0_TP2_GPU2_attn_v&#45;&gt;L6_S0_TP5_GPU5_mha_ar -->
<g id="edge1916" class="edge">
<title>L6_S0_TP2_GPU2_attn_v&#45;&gt;L6_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M58668,-1184.75C58668,-1195.2 58668,-1204 58668,-1204 58668,-1204 60675,-1204 60675,-1204 60675,-1204 60675,-1084.08 60675,-1084.08"/>
<polygon fill="black" stroke="black" points="60678.5,-1084.08 60675,-1074.08 60671.5,-1084.08 60678.5,-1084.08"/>
</g>
<!-- L6_S0_TP2_GPU2_attn_v&#45;&gt;L6_S0_TP6_GPU6_mha_ar -->
<g id="edge1952" class="edge">
<title>L6_S0_TP2_GPU2_attn_v&#45;&gt;L6_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M58609.88,-1116.44C58609.88,-1107.84 58609.88,-1101 58609.88,-1101 58609.88,-1101 61415.3,-1101 61415.3,-1101 61415.3,-1101 61415.3,-1081.59 61415.3,-1081.59"/>
<polygon fill="black" stroke="black" points="61418.8,-1081.59 61415.3,-1071.59 61411.8,-1081.59 61418.8,-1081.59"/>
</g>
<!-- L6_S0_TP2_GPU2_attn_v&#45;&gt;L6_S0_TP7_GPU7_mha_ar -->
<g id="edge1988" class="edge">
<title>L6_S0_TP2_GPU2_attn_v&#45;&gt;L6_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M58680.44,-1116.59C58680.44,-1107.42 58680.44,-1100 58680.44,-1100 58680.44,-1100 62235.33,-1100 62235.33,-1100 62235.33,-1100 62235.33,-1085.66 62235.33,-1085.66"/>
<polygon fill="black" stroke="black" points="62238.83,-1085.66 62235.33,-1075.66 62231.83,-1085.66 62238.83,-1085.66"/>
</g>
<!-- L6_S0_TP3_GPU3_attn_v -->
<g id="node634" class="node">
<title>L6_S0_TP3_GPU3_attn_v</title>
<polygon fill="none" stroke="black" points="59707,-1184.67 58769,-1184.67 58769,-1116.67 59707,-1116.67 59707,-1184.67"/>
<text text-anchor="middle" x="59238" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="59238" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="59238" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="59238" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L6_S0_TP3_GPU3_attn_v&#45;&gt;L6_S0_TP0_GPU0_mha_ar -->
<g id="edge1737" class="edge">
<title>L6_S0_TP3_GPU3_attn_v&#45;&gt;L6_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M58802.69,-1116.41C58802.69,-1114.9 58802.69,-1114 58802.69,-1114 58802.69,-1114 57060.43,-1114 57060.43,-1114 57060.43,-1114 57060.43,-1090.88 57060.43,-1090.88"/>
<polygon fill="black" stroke="black" points="57063.93,-1090.88 57060.43,-1080.88 57056.93,-1090.88 57063.93,-1090.88"/>
</g>
<!-- L6_S0_TP3_GPU3_attn_v&#45;&gt;L6_S0_TP1_GPU1_mha_ar -->
<g id="edge1773" class="edge">
<title>L6_S0_TP3_GPU3_attn_v&#45;&gt;L6_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M58836.39,-1116.41C58836.39,-1114.9 58836.39,-1114 58836.39,-1114 58836.39,-1114 57990.74,-1114 57990.74,-1114 57990.74,-1114 57990.74,-1083.77 57990.74,-1083.77"/>
<polygon fill="black" stroke="black" points="57994.24,-1083.77 57990.74,-1073.77 57987.24,-1083.77 57994.24,-1083.77"/>
</g>
<!-- L6_S0_TP3_GPU3_attn_v&#45;&gt;L6_S0_TP2_GPU2_mha_ar -->
<g id="edge1809" class="edge">
<title>L6_S0_TP3_GPU3_attn_v&#45;&gt;L6_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M58870.08,-1116.51C58870.08,-1116.51 58870.08,-1070.31 58870.08,-1070.31"/>
<polygon fill="black" stroke="black" points="58873.58,-1070.31 58870.08,-1060.31 58866.58,-1070.31 58873.58,-1070.31"/>
</g>
<!-- L6_S0_TP3_GPU3_attn_v&#45;&gt;L6_S0_TP3_GPU3_mha_ar -->
<g id="edge1845" class="edge">
<title>L6_S0_TP3_GPU3_attn_v&#45;&gt;L6_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M59384.64,-1116.51C59384.64,-1116.51 59384.64,-1090.27 59384.64,-1090.27"/>
<polygon fill="black" stroke="black" points="59388.14,-1090.27 59384.64,-1080.27 59381.14,-1090.27 59388.14,-1090.27"/>
</g>
<!-- L6_S0_TP3_GPU3_attn_v&#45;&gt;L6_S0_TP4_GPU4_mha_ar -->
<g id="edge1881" class="edge">
<title>L6_S0_TP3_GPU3_attn_v&#45;&gt;L6_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M59707.24,-1161C59710.51,-1161 59712.25,-1161 59712.25,-1161 59712.25,-1161 59712.25,-1016 59712.25,-1016 59712.25,-1016 59737.34,-1016 59737.34,-1016"/>
<polygon fill="black" stroke="black" points="59737.34,-1019.5 59747.34,-1016 59737.34,-1012.5 59737.34,-1019.5"/>
</g>
<!-- L6_S0_TP3_GPU3_attn_v&#45;&gt;L6_S0_TP5_GPU5_mha_ar -->
<g id="edge1917" class="edge">
<title>L6_S0_TP3_GPU3_attn_v&#45;&gt;L6_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M59658.33,-1185.13C59658.33,-1185.69 59658.33,-1186 59658.33,-1186 59658.33,-1186 60669,-1186 60669,-1186 60669,-1186 60669,-1083.29 60669,-1083.29"/>
<polygon fill="black" stroke="black" points="60672.5,-1083.29 60669,-1073.29 60665.5,-1083.29 60672.5,-1083.29"/>
</g>
<!-- L6_S0_TP3_GPU3_attn_v&#45;&gt;L6_S0_TP6_GPU6_mha_ar -->
<g id="edge1953" class="edge">
<title>L6_S0_TP3_GPU3_attn_v&#45;&gt;L6_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M59609.67,-1184.72C59609.67,-1190.67 59609.67,-1195 59609.67,-1195 59609.67,-1195 61628,-1195 61628,-1195 61628,-1195 61628,-1090.87 61628,-1090.87"/>
<polygon fill="black" stroke="black" points="61631.5,-1090.87 61628,-1080.87 61624.5,-1090.87 61631.5,-1090.87"/>
</g>
<!-- L6_S0_TP3_GPU3_attn_v&#45;&gt;L6_S0_TP7_GPU7_mha_ar -->
<g id="edge1989" class="edge">
<title>L6_S0_TP3_GPU3_attn_v&#45;&gt;L6_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M59491.92,-1116.44C59491.92,-1107.84 59491.92,-1101 59491.92,-1101 59491.92,-1101 62303.26,-1101 62303.26,-1101 62303.26,-1101 62303.26,-1088.98 62303.26,-1088.98"/>
<polygon fill="black" stroke="black" points="62306.76,-1088.98 62303.26,-1078.98 62299.76,-1088.98 62306.76,-1088.98"/>
</g>
<!-- L6_S0_TP4_GPU4_attn_v -->
<g id="node635" class="node">
<title>L6_S0_TP4_GPU4_attn_v</title>
<polygon fill="none" stroke="black" points="60663,-1184.67 59725,-1184.67 59725,-1116.67 60663,-1116.67 60663,-1184.67"/>
<text text-anchor="middle" x="60194" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="60194" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="60194" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="60194" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L6_S0_TP4_GPU4_attn_v&#45;&gt;L6_S0_TP0_GPU0_mha_ar -->
<g id="edge1738" class="edge">
<title>L6_S0_TP4_GPU4_attn_v&#45;&gt;L6_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M59832.21,-1116.44C59832.21,-1107.84 59832.21,-1101 59832.21,-1101 59832.21,-1101 57128.24,-1101 57128.24,-1101 57128.24,-1101 57128.24,-1088.98 57128.24,-1088.98"/>
<polygon fill="black" stroke="black" points="57131.74,-1088.98 57128.24,-1078.98 57124.74,-1088.98 57131.74,-1088.98"/>
</g>
<!-- L6_S0_TP4_GPU4_attn_v&#45;&gt;L6_S0_TP1_GPU1_mha_ar -->
<g id="edge1774" class="edge">
<title>L6_S0_TP4_GPU4_attn_v&#45;&gt;L6_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M59803.33,-1184.93C59803.33,-1193.35 59803.33,-1200 59803.33,-1200 59803.33,-1200 57804,-1200 57804,-1200 57804,-1200 57804,-1091.01 57804,-1091.01"/>
<polygon fill="black" stroke="black" points="57807.5,-1091.01 57804,-1081.01 57800.5,-1091.01 57807.5,-1091.01"/>
</g>
<!-- L6_S0_TP4_GPU4_attn_v&#45;&gt;L6_S0_TP2_GPU2_mha_ar -->
<g id="edge1810" class="edge">
<title>L6_S0_TP4_GPU4_attn_v&#45;&gt;L6_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M59764.17,-1184.7C59764.17,-1188.48 59764.17,-1191 59764.17,-1191 59764.17,-1191 58764.5,-1191 58764.5,-1191 58764.5,-1191 58764.5,-1083.38 58764.5,-1083.38"/>
<polygon fill="black" stroke="black" points="58768,-1083.38 58764.5,-1073.38 58761,-1083.38 58768,-1083.38"/>
</g>
<!-- L6_S0_TP4_GPU4_attn_v&#45;&gt;L6_S0_TP3_GPU3_mha_ar -->
<g id="edge1846" class="edge">
<title>L6_S0_TP4_GPU4_attn_v&#45;&gt;L6_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M59724.97,-1139C59715.68,-1139 59710.5,-1139 59710.5,-1139 59710.5,-1139 59710.5,-1048 59710.5,-1048 59710.5,-1048 59696.76,-1048 59696.76,-1048"/>
<polygon fill="black" stroke="black" points="59696.76,-1044.5 59686.76,-1048 59696.76,-1051.5 59696.76,-1044.5"/>
</g>
<!-- L6_S0_TP4_GPU4_attn_v&#45;&gt;L6_S0_TP4_GPU4_mha_ar -->
<g id="edge1882" class="edge">
<title>L6_S0_TP4_GPU4_attn_v&#45;&gt;L6_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M60046.63,-1116.51C60046.63,-1116.51 60046.63,-1090.27 60046.63,-1090.27"/>
<polygon fill="black" stroke="black" points="60050.13,-1090.27 60046.63,-1080.27 60043.13,-1090.27 60050.13,-1090.27"/>
</g>
<!-- L6_S0_TP4_GPU4_attn_v&#45;&gt;L6_S0_TP5_GPU5_mha_ar -->
<g id="edge1918" class="edge">
<title>L6_S0_TP4_GPU4_attn_v&#45;&gt;L6_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M60578.26,-1116.51C60578.26,-1116.51 60578.26,-1073.04 60578.26,-1073.04"/>
<polygon fill="black" stroke="black" points="60581.76,-1073.04 60578.26,-1063.04 60574.76,-1073.04 60581.76,-1073.04"/>
</g>
<!-- L6_S0_TP4_GPU4_attn_v&#45;&gt;L6_S0_TP6_GPU6_mha_ar -->
<g id="edge1954" class="edge">
<title>L6_S0_TP4_GPU4_attn_v&#45;&gt;L6_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M60606.51,-1116.44C60606.51,-1107.84 60606.51,-1101 60606.51,-1101 60606.51,-1101 61466.23,-1101 61466.23,-1101 61466.23,-1101 61466.23,-1085.52 61466.23,-1085.52"/>
<polygon fill="black" stroke="black" points="61469.73,-1085.52 61466.23,-1075.52 61462.73,-1085.52 61469.73,-1085.52"/>
</g>
<!-- L6_S0_TP4_GPU4_attn_v&#45;&gt;L6_S0_TP7_GPU7_mha_ar -->
<g id="edge1990" class="edge">
<title>L6_S0_TP4_GPU4_attn_v&#45;&gt;L6_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M60634.75,-1116.44C60634.75,-1107.84 60634.75,-1101 60634.75,-1101 60634.75,-1101 62371.2,-1101 62371.2,-1101 62371.2,-1101 62371.2,-1090.47 62371.2,-1090.47"/>
<polygon fill="black" stroke="black" points="62374.7,-1090.47 62371.2,-1080.47 62367.7,-1090.47 62374.7,-1090.47"/>
</g>
<!-- L6_S0_TP5_GPU5_attn_v -->
<g id="node636" class="node">
<title>L6_S0_TP5_GPU5_attn_v</title>
<polygon fill="none" stroke="black" points="61619,-1184.67 60681,-1184.67 60681,-1116.67 61619,-1116.67 61619,-1184.67"/>
<text text-anchor="middle" x="61150" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="61150" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="61150" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="61150" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L6_S0_TP5_GPU5_attn_v&#45;&gt;L6_S0_TP0_GPU0_mha_ar -->
<g id="edge1739" class="edge">
<title>L6_S0_TP5_GPU5_attn_v&#45;&gt;L6_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M60751.43,-1116.44C60751.43,-1107.84 60751.43,-1101 60751.43,-1101 60751.43,-1101 57196.05,-1101 57196.05,-1101 57196.05,-1101 57196.05,-1085.52 57196.05,-1085.52"/>
<polygon fill="black" stroke="black" points="57199.55,-1085.52 57196.05,-1075.52 57192.55,-1085.52 57199.55,-1085.52"/>
</g>
<!-- L6_S0_TP5_GPU5_attn_v&#45;&gt;L6_S0_TP1_GPU1_mha_ar -->
<g id="edge1775" class="edge">
<title>L6_S0_TP5_GPU5_attn_v&#45;&gt;L6_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M60821.87,-1116.44C60821.87,-1107.84 60821.87,-1101 60821.87,-1101 60821.87,-1101 58049.98,-1101 58049.98,-1101 58049.98,-1101 58049.98,-1077.99 58049.98,-1077.99"/>
<polygon fill="black" stroke="black" points="58053.48,-1077.99 58049.98,-1067.99 58046.48,-1077.99 58053.48,-1077.99"/>
</g>
<!-- L6_S0_TP5_GPU5_attn_v&#45;&gt;L6_S0_TP2_GPU2_mha_ar -->
<g id="edge1811" class="edge">
<title>L6_S0_TP5_GPU5_attn_v&#45;&gt;L6_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M60758.75,-1184.76C60758.75,-1196.15 60758.75,-1206 60758.75,-1206 60758.75,-1206 58760,-1206 58760,-1206 58760,-1206 58760,-1083.68 58760,-1083.68"/>
<polygon fill="black" stroke="black" points="58763.5,-1083.68 58760,-1073.68 58756.5,-1083.68 58763.5,-1083.68"/>
</g>
<!-- L6_S0_TP5_GPU5_attn_v&#45;&gt;L6_S0_TP3_GPU3_mha_ar -->
<g id="edge1847" class="edge">
<title>L6_S0_TP5_GPU5_attn_v&#45;&gt;L6_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M60892.3,-1116.44C60892.3,-1107.84 60892.3,-1101 60892.3,-1101 60892.3,-1101 59599.2,-1101 59599.2,-1101 59599.2,-1101 59599.2,-1076.39 59599.2,-1076.39"/>
<polygon fill="black" stroke="black" points="59602.7,-1076.39 59599.2,-1066.39 59595.7,-1076.39 59602.7,-1076.39"/>
</g>
<!-- L6_S0_TP5_GPU5_attn_v&#45;&gt;L6_S0_TP4_GPU4_mha_ar -->
<g id="edge1883" class="edge">
<title>L6_S0_TP5_GPU5_attn_v&#45;&gt;L6_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M60962.74,-1116.59C60962.74,-1102.32 60962.74,-1089 60962.74,-1089 60962.74,-1089 60153.84,-1089 60153.84,-1089 60153.84,-1089 60153.84,-1088.12 60153.84,-1088.12"/>
<polygon fill="black" stroke="black" points="60157.34,-1090.18 60153.84,-1080.18 60150.34,-1090.18 60157.34,-1090.18"/>
</g>
<!-- L6_S0_TP5_GPU5_attn_v&#45;&gt;L6_S0_TP5_GPU5_mha_ar -->
<g id="edge1919" class="edge">
<title>L6_S0_TP5_GPU5_attn_v&#45;&gt;L6_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M61033.17,-1116.51C61033.17,-1116.51 61033.17,-1085.92 61033.17,-1085.92"/>
<polygon fill="black" stroke="black" points="61036.67,-1085.92 61033.17,-1075.92 61029.67,-1085.92 61036.67,-1085.92"/>
</g>
<!-- L6_S0_TP5_GPU5_attn_v&#45;&gt;L6_S0_TP6_GPU6_mha_ar -->
<g id="edge1955" class="edge">
<title>L6_S0_TP5_GPU5_attn_v&#45;&gt;L6_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M61517.15,-1116.51C61517.15,-1116.51 61517.15,-1088.52 61517.15,-1088.52"/>
<polygon fill="black" stroke="black" points="61520.65,-1088.52 61517.15,-1078.52 61513.65,-1088.52 61520.65,-1088.52"/>
</g>
<!-- L6_S0_TP5_GPU5_attn_v&#45;&gt;L6_S0_TP7_GPU7_mha_ar -->
<g id="edge1991" class="edge">
<title>L6_S0_TP5_GPU5_attn_v&#45;&gt;L6_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M61568.08,-1116.44C61568.08,-1107.84 61568.08,-1101 61568.08,-1101 61568.08,-1101 62439.13,-1101 62439.13,-1101 62439.13,-1101 62439.13,-1090.84 62439.13,-1090.84"/>
<polygon fill="black" stroke="black" points="62442.63,-1090.84 62439.13,-1080.84 62435.63,-1090.84 62442.63,-1090.84"/>
</g>
<!-- L6_S0_TP6_GPU6_attn_v -->
<g id="node637" class="node">
<title>L6_S0_TP6_GPU6_attn_v</title>
<polygon fill="none" stroke="black" points="62575,-1184.67 61637,-1184.67 61637,-1116.67 62575,-1116.67 62575,-1184.67"/>
<text text-anchor="middle" x="62106" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="62106" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="62106" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="62106" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L6_S0_TP6_GPU6_attn_v&#45;&gt;L6_S0_TP0_GPU0_mha_ar -->
<g id="edge1740" class="edge">
<title>L6_S0_TP6_GPU6_attn_v&#45;&gt;L6_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M61684.06,-1116.44C61684.06,-1107.84 61684.06,-1101 61684.06,-1101 61684.06,-1101 57263.86,-1101 57263.86,-1101 57263.86,-1101 57263.86,-1079.59 57263.86,-1079.59"/>
<polygon fill="black" stroke="black" points="57267.36,-1079.59 57263.86,-1069.59 57260.36,-1079.59 57267.36,-1079.59"/>
</g>
<!-- L6_S0_TP6_GPU6_attn_v&#45;&gt;L6_S0_TP1_GPU1_mha_ar -->
<g id="edge1776" class="edge">
<title>L6_S0_TP6_GPU6_attn_v&#45;&gt;L6_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M61731.12,-1116.44C61731.12,-1107.84 61731.12,-1101 61731.12,-1101 61731.12,-1101 58109.23,-1101 58109.23,-1101 58109.23,-1101 58109.23,-1068.84 58109.23,-1068.84"/>
<polygon fill="black" stroke="black" points="58112.73,-1068.84 58109.23,-1058.84 58105.73,-1068.84 58112.73,-1068.84"/>
</g>
<!-- L6_S0_TP6_GPU6_attn_v&#45;&gt;L6_S0_TP2_GPU2_mha_ar -->
<g id="edge1812" class="edge">
<title>L6_S0_TP6_GPU6_attn_v&#45;&gt;L6_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M61778.18,-1116.44C61778.18,-1107.84 61778.18,-1101 61778.18,-1101 61778.18,-1101 58903.78,-1101 58903.78,-1101 58903.78,-1101 58903.78,-1062.74 58903.78,-1062.74"/>
<polygon fill="black" stroke="black" points="58907.28,-1062.74 58903.78,-1052.74 58900.28,-1062.74 58907.28,-1062.74"/>
</g>
<!-- L6_S0_TP6_GPU6_attn_v&#45;&gt;L6_S0_TP3_GPU3_mha_ar -->
<g id="edge1848" class="edge">
<title>L6_S0_TP6_GPU6_attn_v&#45;&gt;L6_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M62022.5,-1116.41C62022.5,-1064.78 62022.5,-973 62022.5,-973 62022.5,-973 59677.82,-973 59677.82,-973 59677.82,-973 59677.82,-1004.06 59677.82,-1004.06"/>
<polygon fill="black" stroke="black" points="59674.32,-1004.06 59677.82,-1014.06 59681.32,-1004.06 59674.32,-1004.06"/>
</g>
<!-- L6_S0_TP6_GPU6_attn_v&#45;&gt;L6_S0_TP4_GPU4_mha_ar -->
<g id="edge1884" class="edge">
<title>L6_S0_TP6_GPU6_attn_v&#45;&gt;L6_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M61825.24,-1116.59C61825.24,-1102.32 61825.24,-1089 61825.24,-1089 61825.24,-1089 60261.05,-1089 60261.05,-1089 60261.05,-1089 60261.05,-1086.2 60261.05,-1086.2"/>
<polygon fill="black" stroke="black" points="60264.55,-1086.2 60261.05,-1076.2 60257.55,-1086.2 60264.55,-1086.2"/>
</g>
<!-- L6_S0_TP6_GPU6_attn_v&#45;&gt;L6_S0_TP5_GPU5_mha_ar -->
<g id="edge1920" class="edge">
<title>L6_S0_TP6_GPU6_attn_v&#45;&gt;L6_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M61872.3,-1116.59C61872.3,-1102.32 61872.3,-1089 61872.3,-1089 61872.3,-1089 61103.61,-1089 61103.61,-1089 61103.61,-1089 61103.61,-1080.21 61103.61,-1080.21"/>
<polygon fill="black" stroke="black" points="61107.11,-1080.21 61103.61,-1070.21 61100.11,-1080.21 61107.11,-1080.21"/>
</g>
<!-- L6_S0_TP6_GPU6_attn_v&#45;&gt;L6_S0_TP6_GPU6_mha_ar -->
<g id="edge1956" class="edge">
<title>L6_S0_TP6_GPU6_attn_v&#45;&gt;L6_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M61919.36,-1116.51C61919.36,-1116.51 61919.36,-1074.64 61919.36,-1074.64"/>
<polygon fill="black" stroke="black" points="61922.86,-1074.64 61919.36,-1064.64 61915.86,-1074.64 61922.86,-1074.64"/>
</g>
<!-- L6_S0_TP6_GPU6_attn_v&#45;&gt;L6_S0_TP7_GPU7_mha_ar -->
<g id="edge1992" class="edge">
<title>L6_S0_TP6_GPU6_attn_v&#45;&gt;L6_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M62507.07,-1116.51C62507.07,-1116.51 62507.07,-1088.96 62507.07,-1088.96"/>
<polygon fill="black" stroke="black" points="62510.57,-1088.96 62507.07,-1078.96 62503.57,-1088.96 62510.57,-1088.96"/>
</g>
<!-- L6_S0_TP7_GPU7_attn_v -->
<g id="node638" class="node">
<title>L6_S0_TP7_GPU7_attn_v</title>
<polygon fill="none" stroke="black" points="63531,-1184.67 62593,-1184.67 62593,-1116.67 63531,-1116.67 63531,-1184.67"/>
<text text-anchor="middle" x="63062" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="63062" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="63062" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="63062" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L6_S0_TP7_GPU7_attn_v&#45;&gt;L6_S0_TP0_GPU0_mha_ar -->
<g id="edge1741" class="edge">
<title>L6_S0_TP7_GPU7_attn_v&#45;&gt;L6_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M62624.58,-1116.44C62624.58,-1107.84 62624.58,-1101 62624.58,-1101 62624.58,-1101 57331.66,-1101 57331.66,-1101 57331.66,-1101 57331.66,-1070.41 57331.66,-1070.41"/>
<polygon fill="black" stroke="black" points="57335.16,-1070.41 57331.66,-1060.41 57328.16,-1070.41 57335.16,-1070.41"/>
</g>
<!-- L6_S0_TP7_GPU7_attn_v&#45;&gt;L6_S0_TP1_GPU1_mha_ar -->
<g id="edge1777" class="edge">
<title>L6_S0_TP7_GPU7_attn_v&#45;&gt;L6_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M62830.49,-1116.64C62830.49,-1064.8 62830.49,-972 62830.49,-972 62830.49,-972 57911.99,-972 57911.99,-972 57911.99,-972 57911.99,-976.98 57911.99,-976.98"/>
<polygon fill="black" stroke="black" points="57908.49,-976.98 57911.99,-986.98 57915.49,-976.98 57908.49,-976.98"/>
</g>
<!-- L6_S0_TP7_GPU7_attn_v&#45;&gt;L6_S0_TP2_GPU2_mha_ar -->
<g id="edge1813" class="edge">
<title>L6_S0_TP7_GPU7_attn_v&#45;&gt;L6_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M62733.75,-1184.93C62733.75,-1199.85 62733.75,-1214 62733.75,-1214 62733.75,-1214 58755.5,-1214 58755.5,-1214 58755.5,-1214 58755.5,-1084.2 58755.5,-1084.2"/>
<polygon fill="black" stroke="black" points="58759,-1084.2 58755.5,-1074.2 58752,-1084.2 58759,-1084.2"/>
</g>
<!-- L6_S0_TP7_GPU7_attn_v&#45;&gt;L6_S0_TP3_GPU3_mha_ar -->
<g id="edge1849" class="edge">
<title>L6_S0_TP7_GPU7_attn_v&#45;&gt;L6_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M62806.48,-1116.64C62806.48,-1064.8 62806.48,-972 62806.48,-972 62806.48,-972 59649.16,-972 59649.16,-972 59649.16,-972 59649.16,-996.89 59649.16,-996.89"/>
<polygon fill="black" stroke="black" points="59645.66,-996.89 59649.16,-1006.89 59652.66,-996.89 59645.66,-996.89"/>
</g>
<!-- L6_S0_TP7_GPU7_attn_v&#45;&gt;L6_S0_TP4_GPU4_mha_ar -->
<g id="edge1885" class="edge">
<title>L6_S0_TP7_GPU7_attn_v&#45;&gt;L6_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M62656.16,-1116.59C62656.16,-1102.32 62656.16,-1089 62656.16,-1089 62656.16,-1089 60368.26,-1089 60368.26,-1089 60368.26,-1089 60368.26,-1076.38 60368.26,-1076.38"/>
<polygon fill="black" stroke="black" points="60371.76,-1076.38 60368.26,-1066.38 60364.76,-1076.38 60371.76,-1076.38"/>
</g>
<!-- L6_S0_TP7_GPU7_attn_v&#45;&gt;L6_S0_TP5_GPU5_mha_ar -->
<g id="edge1921" class="edge">
<title>L6_S0_TP7_GPU7_attn_v&#45;&gt;L6_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M62687.74,-1116.59C62687.74,-1102.32 62687.74,-1089 62687.74,-1089 62687.74,-1089 61174.04,-1089 61174.04,-1089 61174.04,-1089 61174.04,-1070.79 61174.04,-1070.79"/>
<polygon fill="black" stroke="black" points="61177.54,-1070.79 61174.04,-1060.79 61170.54,-1070.79 61177.54,-1070.79"/>
</g>
<!-- L6_S0_TP7_GPU7_attn_v&#45;&gt;L6_S0_TP6_GPU6_mha_ar -->
<g id="edge1957" class="edge">
<title>L6_S0_TP7_GPU7_attn_v&#45;&gt;L6_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M62719.32,-1116.4C62719.32,-1101.77 62719.32,-1088 62719.32,-1088 62719.32,-1088 61966.41,-1088 61966.41,-1088 61966.41,-1088 61966.41,-1066.08 61966.41,-1066.08"/>
<polygon fill="black" stroke="black" points="61969.91,-1066.08 61966.41,-1056.08 61962.91,-1066.08 61969.91,-1066.08"/>
</g>
<!-- L6_S0_TP7_GPU7_attn_v&#45;&gt;L6_S0_TP7_GPU7_mha_ar -->
<g id="edge1993" class="edge">
<title>L6_S0_TP7_GPU7_attn_v&#45;&gt;L6_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M62750.89,-1116.51C62750.89,-1116.51 62750.89,-1061.95 62750.89,-1061.95"/>
<polygon fill="black" stroke="black" points="62754.39,-1061.95 62750.89,-1051.95 62747.39,-1061.95 62754.39,-1061.95"/>
</g>
<!-- L6_S0_TP0_GPU0_gate -->
<g id="node640" class="node">
<title>L6_S0_TP0_GPU0_gate</title>
<polygon fill="none" stroke="black" points="56472.56,-844.5 55630.15,-844.5 55413.44,-708.5 56255.85,-708.5 56472.56,-844.5"/>
<text text-anchor="middle" x="55943" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="55943" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="55943" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="55943" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L6_S0_TP0_GPU0_mha_res&#45;&gt;L6_S0_TP0_GPU0_gate -->
<g id="edge1743" class="edge">
<title>L6_S0_TP0_GPU0_mha_res&#45;&gt;L6_S0_TP0_GPU0_gate</title>
<path fill="none" stroke="black" d="M55943,-880.39C55943,-880.39 55943,-854.73 55943,-854.73"/>
<polygon fill="black" stroke="black" points="55946.5,-854.73 55943,-844.73 55939.5,-854.73 55946.5,-854.73"/>
</g>
<!-- L6_S0_TP0_GPU0_moe_res -->
<g id="node658" class="node">
<title>L6_S0_TP0_GPU0_moe_res</title>
<polygon fill="none" stroke="black" points="56020,-436.33 55200,-436.33 55200,-368.33 56020,-368.33 56020,-436.33"/>
<text text-anchor="middle" x="55610" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="55610" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="55610" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="55610" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP0_GPU0_mha_res&#45;&gt;L6_S0_TP0_GPU0_moe_res -->
<g id="edge1763" class="edge">
<title>L6_S0_TP0_GPU0_mha_res&#45;&gt;L6_S0_TP0_GPU0_moe_res</title>
<path fill="none" stroke="black" d="M55499.27,-903C55391.5,-903 55306.61,-903 55306.61,-903 55306.61,-903 55306.61,-446.35 55306.61,-446.35"/>
<polygon fill="black" stroke="black" points="55310.11,-446.35 55306.61,-436.35 55303.11,-446.35 55310.11,-446.35"/>
</g>
<!-- L6_S0_TP0_GPU0_expert0 -->
<g id="node641" class="node">
<title>L6_S0_TP0_GPU0_expert0</title>
<polygon fill="none" stroke="black" points="56437.5,-672.5 55988.5,-672.5 55988.5,-604.5 56437.5,-604.5 56437.5,-672.5"/>
<text text-anchor="middle" x="56213" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="56213" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="56213" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="56213" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L6_S0_TP0_GPU0_gate&#45;&gt;L6_S0_TP0_GPU0_expert0 -->
<g id="edge1744" class="edge">
<title>L6_S0_TP0_GPU0_gate&#45;&gt;L6_S0_TP0_GPU0_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M56213,-708.31C56213,-708.31 56213,-682.71 56213,-682.71"/>
<polygon fill="black" stroke="black" points="56216.5,-682.71 56213,-672.71 56209.5,-682.71 56216.5,-682.71"/>
</g>
<!-- L6_S0_TP0_GPU0_expert1 -->
<g id="node642" class="node">
<title>L6_S0_TP0_GPU0_expert1</title>
<polygon fill="none" stroke="black" points="56904.5,-672.5 56455.5,-672.5 56455.5,-604.5 56904.5,-604.5 56904.5,-672.5"/>
<text text-anchor="middle" x="56680" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="56680" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="56680" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="56680" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L6_S0_TP0_GPU0_gate&#45;&gt;L6_S0_TP0_GPU0_expert1 -->
<g id="edge1745" class="edge">
<title>L6_S0_TP0_GPU0_gate&#45;&gt;L6_S0_TP0_GPU0_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M56464.14,-776.4C56464.14,-776.4 56464.14,-682.74 56464.14,-682.74"/>
<polygon fill="black" stroke="black" points="56467.64,-682.74 56464.14,-672.74 56460.64,-682.74 56467.64,-682.74"/>
</g>
<!-- L6_S0_TP0_GPU0_moe_ar -->
<g id="node643" class="node">
<title>L6_S0_TP0_GPU0_moe_ar</title>
<ellipse fill="none" stroke="black" cx="57291" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="57291" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="57291" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="57291" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="57291" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP0_GPU0_expert0&#45;&gt;L6_S0_TP0_GPU0_moe_ar -->
<g id="edge1746" class="edge">
<title>L6_S0_TP0_GPU0_expert0&#45;&gt;L6_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M56427.56,-604.37C56427.56,-563.08 56427.56,-499 56427.56,-499 56427.56,-499 56981.43,-499 56981.43,-499"/>
<polygon fill="black" stroke="black" points="56981.43,-502.5 56991.43,-499 56981.43,-495.5 56981.43,-502.5"/>
</g>
<!-- L6_S0_TP1_GPU1_moe_ar -->
<g id="node667" class="node">
<title>L6_S0_TP1_GPU1_moe_ar</title>
<ellipse fill="none" stroke="black" cx="57978" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="57978" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="57978" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="57978" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="57978" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP0_GPU0_expert0&#45;&gt;L6_S0_TP1_GPU1_moe_ar -->
<g id="edge1782" class="edge">
<title>L6_S0_TP0_GPU0_expert0&#45;&gt;L6_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M56407.67,-604.47C56407.67,-588.11 56407.67,-572 56407.67,-572 56407.67,-572 57665.2,-572 57665.2,-572 57665.2,-572 57665.2,-547.59 57665.2,-547.59"/>
<polygon fill="black" stroke="black" points="57668.7,-547.59 57665.2,-537.59 57661.7,-547.59 57668.7,-547.59"/>
</g>
<!-- L6_S0_TP2_GPU2_moe_ar -->
<g id="node677" class="node">
<title>L6_S0_TP2_GPU2_moe_ar</title>
<ellipse fill="none" stroke="black" cx="58665" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="58665" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="58665" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="58665" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="58665" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP0_GPU0_expert0&#45;&gt;L6_S0_TP2_GPU2_moe_ar -->
<g id="edge1818" class="edge">
<title>L6_S0_TP0_GPU0_expert0&#45;&gt;L6_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M56417.61,-604.22C56417.61,-588.37 56417.61,-573 56417.61,-573 56417.61,-573 58379.65,-573 58379.65,-573 58379.65,-573 58379.65,-555.78 58379.65,-555.78"/>
<polygon fill="black" stroke="black" points="58383.15,-555.78 58379.65,-545.78 58376.15,-555.78 58383.15,-555.78"/>
</g>
<!-- L6_S0_TP3_GPU3_moe_ar -->
<g id="node687" class="node">
<title>L6_S0_TP3_GPU3_moe_ar</title>
<ellipse fill="none" stroke="black" cx="59352" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="59352" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="59352" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="59352" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="59352" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP0_GPU0_expert0&#45;&gt;L6_S0_TP3_GPU3_moe_ar -->
<g id="edge1854" class="edge">
<title>L6_S0_TP0_GPU0_expert0&#45;&gt;L6_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M56397.72,-604.2C56397.72,-555.2 56397.72,-471 56397.72,-471 56397.72,-471 59128.62,-471 59128.62,-471 59128.62,-471 59128.62,-474.5 59128.62,-474.5"/>
<polygon fill="black" stroke="black" points="59125.12,-474.5 59128.62,-484.5 59132.12,-474.5 59125.12,-474.5"/>
</g>
<!-- L6_S0_TP4_GPU4_moe_ar -->
<g id="node697" class="node">
<title>L6_S0_TP4_GPU4_moe_ar</title>
<ellipse fill="none" stroke="black" cx="60039" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="60039" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="60039" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="60039" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="60039" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP0_GPU0_expert0&#45;&gt;L6_S0_TP4_GPU4_moe_ar -->
<g id="edge1890" class="edge">
<title>L6_S0_TP0_GPU0_expert0&#45;&gt;L6_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M56387.78,-604.24C56387.78,-553.17 56387.78,-463 56387.78,-463 56387.78,-463 59750.63,-463 59750.63,-463 59750.63,-463 59750.63,-485.73 59750.63,-485.73"/>
<polygon fill="black" stroke="black" points="59747.13,-485.73 59750.63,-495.73 59754.13,-485.73 59747.13,-485.73"/>
</g>
<!-- L6_S0_TP5_GPU5_moe_ar -->
<g id="node707" class="node">
<title>L6_S0_TP5_GPU5_moe_ar</title>
<ellipse fill="none" stroke="black" cx="60726" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="60726" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="60726" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="60726" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="60726" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP0_GPU0_expert0&#45;&gt;L6_S0_TP5_GPU5_moe_ar -->
<g id="edge1926" class="edge">
<title>L6_S0_TP0_GPU0_expert0&#45;&gt;L6_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M56377.83,-604.27C56377.83,-547.97 56377.83,-442 56377.83,-442 56377.83,-442 60547.11,-442 60547.11,-442 60547.11,-442 60547.11,-469.37 60547.11,-469.37"/>
<polygon fill="black" stroke="black" points="60543.61,-469.37 60547.11,-479.37 60550.61,-469.37 60543.61,-469.37"/>
</g>
<!-- L6_S0_TP6_GPU6_moe_ar -->
<g id="node717" class="node">
<title>L6_S0_TP6_GPU6_moe_ar</title>
<ellipse fill="none" stroke="black" cx="61413" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="61413" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="61413" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="61413" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="61413" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP0_GPU0_expert0&#45;&gt;L6_S0_TP6_GPU6_moe_ar -->
<g id="edge1962" class="edge">
<title>L6_S0_TP0_GPU0_expert0&#45;&gt;L6_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M56367.89,-604.27C56367.89,-547.97 56367.89,-442 56367.89,-442 56367.89,-442 61298.63,-442 61298.63,-442 61298.63,-442 61298.63,-464.8 61298.63,-464.8"/>
<polygon fill="black" stroke="black" points="61295.13,-464.8 61298.63,-474.8 61302.13,-464.8 61295.13,-464.8"/>
</g>
<!-- L6_S0_TP7_GPU7_moe_ar -->
<g id="node727" class="node">
<title>L6_S0_TP7_GPU7_moe_ar</title>
<ellipse fill="none" stroke="black" cx="62100" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="62100" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="62100" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="62100" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="62100" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP0_GPU0_expert0&#45;&gt;L6_S0_TP7_GPU7_moe_ar -->
<g id="edge1998" class="edge">
<title>L6_S0_TP0_GPU0_expert0&#45;&gt;L6_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M56357.94,-604.27C56357.94,-547.97 56357.94,-442 56357.94,-442 56357.94,-442 62085.38,-442 62085.38,-442 62085.38,-442 62085.38,-462.09 62085.38,-462.09"/>
<polygon fill="black" stroke="black" points="62081.88,-462.09 62085.38,-472.09 62088.88,-462.09 62081.88,-462.09"/>
</g>
<!-- L6_S0_TP0_GPU0_expert1&#45;&gt;L6_S0_TP0_GPU0_moe_ar -->
<g id="edge1747" class="edge">
<title>L6_S0_TP0_GPU0_expert1&#45;&gt;L6_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M56854.61,-604.21C56854.61,-567.05 56854.61,-513 56854.61,-513 56854.61,-513 56950.53,-513 56950.53,-513"/>
<polygon fill="black" stroke="black" points="56950.53,-516.5 56960.53,-513 56950.53,-509.5 56950.53,-516.5"/>
</g>
<!-- L6_S0_TP0_GPU0_expert1&#45;&gt;L6_S0_TP1_GPU1_moe_ar -->
<g id="edge1783" class="edge">
<title>L6_S0_TP0_GPU0_expert1&#45;&gt;L6_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M56505.39,-604.47C56505.39,-588.11 56505.39,-572 56505.39,-572 56505.39,-572 57686.86,-572 57686.86,-572 57686.86,-572 57686.86,-554.09 57686.86,-554.09"/>
<polygon fill="black" stroke="black" points="57690.36,-554.09 57686.86,-544.09 57683.36,-554.09 57690.36,-554.09"/>
</g>
<!-- L6_S0_TP0_GPU0_expert1&#45;&gt;L6_S0_TP2_GPU2_moe_ar -->
<g id="edge1819" class="edge">
<title>L6_S0_TP0_GPU0_expert1&#45;&gt;L6_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M56555.28,-604.22C56555.28,-588.37 56555.28,-573 56555.28,-573 56555.28,-573 58428.75,-573 58428.75,-573 58428.75,-573 58428.75,-564.61 58428.75,-564.61"/>
<polygon fill="black" stroke="black" points="58432.25,-564.61 58428.75,-554.61 58425.25,-564.61 58432.25,-564.61"/>
</g>
<!-- L6_S0_TP0_GPU0_expert1&#45;&gt;L6_S0_TP3_GPU3_moe_ar -->
<g id="edge1855" class="edge">
<title>L6_S0_TP0_GPU0_expert1&#45;&gt;L6_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M56605.17,-604.22C56605.17,-588.37 56605.17,-573 56605.17,-573 56605.17,-573 59042.2,-573 59042.2,-573 59042.2,-573 59042.2,-548.81 59042.2,-548.81"/>
<polygon fill="black" stroke="black" points="59045.7,-548.81 59042.2,-538.81 59038.7,-548.81 59045.7,-548.81"/>
</g>
<!-- L6_S0_TP0_GPU0_expert1&#45;&gt;L6_S0_TP4_GPU4_moe_ar -->
<g id="edge1891" class="edge">
<title>L6_S0_TP0_GPU0_expert1&#45;&gt;L6_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M56804.72,-604.24C56804.72,-553.17 56804.72,-463 56804.72,-463 56804.72,-463 59735.27,-463 59735.27,-463 59735.27,-463 59735.27,-490.01 59735.27,-490.01"/>
<polygon fill="black" stroke="black" points="59731.77,-490.01 59735.27,-500.01 59738.77,-490.01 59731.77,-490.01"/>
</g>
<!-- L6_S0_TP0_GPU0_expert1&#45;&gt;L6_S0_TP5_GPU5_moe_ar -->
<g id="edge1927" class="edge">
<title>L6_S0_TP0_GPU0_expert1&#45;&gt;L6_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M56754.83,-604.27C56754.83,-547.97 56754.83,-442 56754.83,-442 56754.83,-442 60508.22,-442 60508.22,-442 60508.22,-442 60508.22,-473.5 60508.22,-473.5"/>
<polygon fill="black" stroke="black" points="60504.72,-473.5 60508.22,-483.5 60511.72,-473.5 60504.72,-473.5"/>
</g>
<!-- L6_S0_TP0_GPU0_expert1&#45;&gt;L6_S0_TP6_GPU6_moe_ar -->
<g id="edge1963" class="edge">
<title>L6_S0_TP0_GPU0_expert1&#45;&gt;L6_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M56704.94,-604.27C56704.94,-547.97 56704.94,-442 56704.94,-442 56704.94,-442 61225.27,-442 61225.27,-442 61225.27,-442 61225.27,-470.29 61225.27,-470.29"/>
<polygon fill="black" stroke="black" points="61221.77,-470.29 61225.27,-480.29 61228.77,-470.29 61221.77,-470.29"/>
</g>
<!-- L6_S0_TP0_GPU0_expert1&#45;&gt;L6_S0_TP7_GPU7_moe_ar -->
<g id="edge1999" class="edge">
<title>L6_S0_TP0_GPU0_expert1&#45;&gt;L6_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M56655.06,-604.36C56655.06,-588.89 56655.06,-574 56655.06,-574 56655.06,-574 61793.13,-574 61793.13,-574 61793.13,-574 61793.13,-549.76 61793.13,-549.76"/>
<polygon fill="black" stroke="black" points="61796.63,-549.76 61793.13,-539.76 61789.63,-549.76 61796.63,-549.76"/>
</g>
<!-- L6_S0_TP0_GPU0_moe_ar&#45;&gt;L6_S0_TP0_GPU0_moe_res -->
<g id="edge1762" class="edge">
<title>L6_S0_TP0_GPU0_moe_ar&#45;&gt;L6_S0_TP0_GPU0_moe_res</title>
<path fill="none" stroke="black" d="M57057.23,-486C56686.26,-486 56004.25,-486 56004.25,-486 56004.25,-486 56004.25,-446.36 56004.25,-446.36"/>
<polygon fill="black" stroke="black" points="56007.75,-446.36 56004.25,-436.36 56000.75,-446.36 56007.75,-446.36"/>
</g>
<!-- L6_S0_TP1_GPU1_expert0 -->
<g id="node644" class="node">
<title>L6_S0_TP1_GPU1_expert0</title>
<polygon fill="none" stroke="black" points="57371.5,-672.5 56922.5,-672.5 56922.5,-604.5 57371.5,-604.5 57371.5,-672.5"/>
<text text-anchor="middle" x="57147" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="57147" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="57147" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="57147" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L6_S0_TP1_GPU1_expert0&#45;&gt;L6_S0_TP0_GPU0_moe_ar -->
<g id="edge1748" class="edge">
<title>L6_S0_TP1_GPU1_expert0&#45;&gt;L6_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M57025.7,-604.34C57025.7,-604.34 57025.7,-560.09 57025.7,-560.09"/>
<polygon fill="black" stroke="black" points="57029.2,-560.09 57025.7,-550.09 57022.2,-560.09 57029.2,-560.09"/>
</g>
<!-- L6_S0_TP1_GPU1_expert0&#45;&gt;L6_S0_TP1_GPU1_moe_ar -->
<g id="edge1784" class="edge">
<title>L6_S0_TP1_GPU1_expert0&#45;&gt;L6_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M57094.86,-604.47C57094.86,-588.11 57094.86,-572 57094.86,-572 57094.86,-572 57708.53,-572 57708.53,-572 57708.53,-572 57708.53,-558.92 57708.53,-558.92"/>
<polygon fill="black" stroke="black" points="57712.03,-558.92 57708.53,-548.92 57705.03,-558.92 57712.03,-558.92"/>
</g>
<!-- L6_S0_TP1_GPU1_expert0&#45;&gt;L6_S0_TP2_GPU2_moe_ar -->
<g id="edge1820" class="edge">
<title>L6_S0_TP1_GPU1_expert0&#45;&gt;L6_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M57164.02,-604.22C57164.02,-588.37 57164.02,-573 57164.02,-573 57164.02,-573 58477.86,-573 58477.86,-573 58477.86,-573 58477.86,-570.27 58477.86,-570.27"/>
<polygon fill="black" stroke="black" points="58481.36,-570.27 58477.86,-560.27 58474.36,-570.27 58481.36,-570.27"/>
</g>
<!-- L6_S0_TP1_GPU1_expert0&#45;&gt;L6_S0_TP3_GPU3_moe_ar -->
<g id="edge1856" class="edge">
<title>L6_S0_TP1_GPU1_expert0&#45;&gt;L6_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M57233.18,-604.22C57233.18,-588.37 57233.18,-573 57233.18,-573 57233.18,-573 59066.86,-573 59066.86,-573 59066.86,-573 59066.86,-555.78 59066.86,-555.78"/>
<polygon fill="black" stroke="black" points="59070.36,-555.78 59066.86,-545.78 59063.36,-555.78 59070.36,-555.78"/>
</g>
<!-- L6_S0_TP1_GPU1_expert0&#45;&gt;L6_S0_TP4_GPU4_moe_ar -->
<g id="edge1892" class="edge">
<title>L6_S0_TP1_GPU1_expert0&#45;&gt;L6_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M56948.03,-604.24C56948.03,-553.17 56948.03,-463 56948.03,-463 56948.03,-463 59719.9,-463 59719.9,-463 59719.9,-463 59719.9,-495.93 59719.9,-495.93"/>
<polygon fill="black" stroke="black" points="59716.4,-495.93 59719.9,-505.93 59723.4,-495.93 59716.4,-495.93"/>
</g>
<!-- L6_S0_TP1_GPU1_expert0&#45;&gt;L6_S0_TP5_GPU5_moe_ar -->
<g id="edge1928" class="edge">
<title>L6_S0_TP1_GPU1_expert0&#45;&gt;L6_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M56939.52,-604.45C56939.52,-548.43 56939.52,-443 56939.52,-443 56939.52,-443 60469.32,-443 60469.32,-443 60469.32,-443 60469.32,-479.37 60469.32,-479.37"/>
<polygon fill="black" stroke="black" points="60465.82,-479.37 60469.32,-489.37 60472.82,-479.37 60465.82,-479.37"/>
</g>
<!-- L6_S0_TP1_GPU1_expert0&#45;&gt;L6_S0_TP6_GPU6_moe_ar -->
<g id="edge1964" class="edge">
<title>L6_S0_TP1_GPU1_expert0&#45;&gt;L6_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M56931.01,-604.27C56931.01,-547.97 56931.01,-442 56931.01,-442 56931.01,-442 61151.9,-442 61151.9,-442 61151.9,-442 61151.9,-480.32 61151.9,-480.32"/>
<polygon fill="black" stroke="black" points="61148.4,-480.32 61151.9,-490.32 61155.4,-480.32 61148.4,-480.32"/>
</g>
<!-- L6_S0_TP1_GPU1_expert0&#45;&gt;L6_S0_TP7_GPU7_moe_ar -->
<g id="edge2000" class="edge">
<title>L6_S0_TP1_GPU1_expert0&#45;&gt;L6_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M57302.34,-604.36C57302.34,-588.89 57302.34,-574 57302.34,-574 57302.34,-574 61820.73,-574 61820.73,-574 61820.73,-574 61820.73,-556.89 61820.73,-556.89"/>
<polygon fill="black" stroke="black" points="61824.23,-556.89 61820.73,-546.89 61817.23,-556.89 61824.23,-556.89"/>
</g>
<!-- L6_S0_TP1_GPU1_expert1 -->
<g id="node645" class="node">
<title>L6_S0_TP1_GPU1_expert1</title>
<polygon fill="none" stroke="black" points="57838.5,-672.5 57389.5,-672.5 57389.5,-604.5 57838.5,-604.5 57838.5,-672.5"/>
<text text-anchor="middle" x="57614" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="57614" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="57614" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="57614" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L6_S0_TP1_GPU1_expert1&#45;&gt;L6_S0_TP0_GPU0_moe_ar -->
<g id="edge1749" class="edge">
<title>L6_S0_TP1_GPU1_expert1&#45;&gt;L6_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M57415.72,-604.34C57415.72,-604.34 57415.72,-575.05 57415.72,-575.05"/>
<polygon fill="black" stroke="black" points="57419.22,-575.05 57415.72,-565.05 57412.22,-575.05 57419.22,-575.05"/>
</g>
<!-- L6_S0_TP1_GPU1_expert1&#45;&gt;L6_S0_TP1_GPU1_moe_ar -->
<g id="edge1785" class="edge">
<title>L6_S0_TP1_GPU1_expert1&#45;&gt;L6_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M57730.19,-604.34C57730.19,-604.34 57730.19,-562.87 57730.19,-562.87"/>
<polygon fill="black" stroke="black" points="57733.69,-562.87 57730.19,-552.87 57726.69,-562.87 57733.69,-562.87"/>
</g>
<!-- L6_S0_TP1_GPU1_expert1&#45;&gt;L6_S0_TP2_GPU2_moe_ar -->
<g id="edge1821" class="edge">
<title>L6_S0_TP1_GPU1_expert1&#45;&gt;L6_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M57795.18,-604.36C57795.18,-588.89 57795.18,-574 57795.18,-574 57795.18,-574 58576.07,-574 58576.07,-574 58576.07,-574 58576.07,-573.3 58576.07,-573.3"/>
<polygon fill="black" stroke="black" points="58579.57,-576.99 58576.07,-566.99 58572.57,-576.99 58579.57,-576.99"/>
</g>
<!-- L6_S0_TP1_GPU1_expert1&#45;&gt;L6_S0_TP3_GPU3_moe_ar -->
<g id="edge1857" class="edge">
<title>L6_S0_TP1_GPU1_expert1&#45;&gt;L6_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M57816.84,-604.22C57816.84,-588.37 57816.84,-573 57816.84,-573 57816.84,-573 59091.53,-573 59091.53,-573 59091.53,-573 59091.53,-560.7 59091.53,-560.7"/>
<polygon fill="black" stroke="black" points="59095.03,-560.7 59091.53,-550.7 59088.03,-560.7 59095.03,-560.7"/>
</g>
<!-- L6_S0_TP1_GPU1_expert1&#45;&gt;L6_S0_TP4_GPU4_moe_ar -->
<g id="edge1893" class="edge">
<title>L6_S0_TP1_GPU1_expert1&#45;&gt;L6_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M57748.74,-672.64C57748.74,-686.36 57748.74,-699 57748.74,-699 57748.74,-699 59719.25,-699 59719.25,-699 59719.25,-699 59719.25,-544.73 59719.25,-544.73"/>
<polygon fill="black" stroke="black" points="59722.75,-544.73 59719.25,-534.73 59715.75,-544.73 59722.75,-544.73"/>
</g>
<!-- L6_S0_TP1_GPU1_expert1&#45;&gt;L6_S0_TP5_GPU5_moe_ar -->
<g id="edge1929" class="edge">
<title>L6_S0_TP1_GPU1_expert1&#45;&gt;L6_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M57634.5,-604.45C57634.5,-548.43 57634.5,-443 57634.5,-443 57634.5,-443 60430.43,-443 60430.43,-443 60430.43,-443 60430.43,-487.61 60430.43,-487.61"/>
<polygon fill="black" stroke="black" points="60426.93,-487.61 60430.43,-497.61 60433.93,-487.61 60426.93,-487.61"/>
</g>
<!-- L6_S0_TP1_GPU1_expert1&#45;&gt;L6_S0_TP6_GPU6_moe_ar -->
<g id="edge1965" class="edge">
<title>L6_S0_TP1_GPU1_expert1&#45;&gt;L6_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M57658.98,-672.65C57658.98,-689.39 57658.98,-706 57658.98,-706 57658.98,-706 61121.9,-706 61121.9,-706 61121.9,-706 61121.9,-554.3 61121.9,-554.3"/>
<polygon fill="black" stroke="black" points="61125.4,-554.3 61121.9,-544.3 61118.4,-554.3 61125.4,-554.3"/>
</g>
<!-- L6_S0_TP1_GPU1_expert1&#45;&gt;L6_S0_TP7_GPU7_moe_ar -->
<g id="edge2001" class="edge">
<title>L6_S0_TP1_GPU1_expert1&#45;&gt;L6_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M57441.94,-604.36C57441.94,-588.89 57441.94,-574 57441.94,-574 57441.94,-574 61875.92,-574 61875.92,-574 61875.92,-574 61875.92,-566.16 61875.92,-566.16"/>
<polygon fill="black" stroke="black" points="61879.42,-566.16 61875.92,-556.16 61872.42,-566.16 61879.42,-566.16"/>
</g>
<!-- L6_S0_TP2_GPU2_expert0 -->
<g id="node646" class="node">
<title>L6_S0_TP2_GPU2_expert0</title>
<polygon fill="none" stroke="black" points="58305.5,-672.5 57856.5,-672.5 57856.5,-604.5 58305.5,-604.5 58305.5,-672.5"/>
<text text-anchor="middle" x="58081" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="58081" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="58081" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="58081" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L6_S0_TP2_GPU2_expert0&#45;&gt;L6_S0_TP0_GPU0_moe_ar -->
<g id="edge1750" class="edge">
<title>L6_S0_TP2_GPU2_expert0&#45;&gt;L6_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M57912.62,-604.39C57912.62,-604.13 57912.62,-604 57912.62,-604 57912.62,-604 57468.15,-604 57468.15,-604 57468.15,-604 57468.15,-571.23 57468.15,-571.23"/>
<polygon fill="black" stroke="black" points="57471.65,-571.23 57468.15,-561.23 57464.65,-571.23 57471.65,-571.23"/>
</g>
<!-- L6_S0_TP2_GPU2_expert0&#45;&gt;L6_S0_TP1_GPU1_moe_ar -->
<g id="edge1786" class="edge">
<title>L6_S0_TP2_GPU2_expert0&#45;&gt;L6_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M57968.75,-604.34C57968.75,-604.34 57968.75,-578.55 57968.75,-578.55"/>
<polygon fill="black" stroke="black" points="57972.25,-578.55 57968.75,-568.55 57965.25,-578.55 57972.25,-578.55"/>
</g>
<!-- L6_S0_TP2_GPU2_expert0&#45;&gt;L6_S0_TP2_GPU2_moe_ar -->
<g id="edge1822" class="edge">
<title>L6_S0_TP2_GPU2_expert0&#45;&gt;L6_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M58305.73,-638C58312.35,-638 58316.14,-638 58316.14,-638 58316.14,-638 58316.14,-536 58316.14,-536 58316.14,-536 58338.34,-536 58338.34,-536"/>
<polygon fill="black" stroke="black" points="58338.34,-539.5 58348.34,-536 58338.34,-532.5 58338.34,-539.5"/>
</g>
<!-- L6_S0_TP2_GPU2_expert0&#45;&gt;L6_S0_TP3_GPU3_moe_ar -->
<g id="edge1858" class="edge">
<title>L6_S0_TP2_GPU2_expert0&#45;&gt;L6_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M58024.88,-604.22C58024.88,-588.37 58024.88,-573 58024.88,-573 58024.88,-573 59116.19,-573 59116.19,-573 59116.19,-573 59116.19,-564.61 59116.19,-564.61"/>
<polygon fill="black" stroke="black" points="59119.69,-564.61 59116.19,-554.61 59112.69,-564.61 59119.69,-564.61"/>
</g>
<!-- L6_S0_TP2_GPU2_expert0&#45;&gt;L6_S0_TP4_GPU4_moe_ar -->
<g id="edge1894" class="edge">
<title>L6_S0_TP2_GPU2_expert0&#45;&gt;L6_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M58230.67,-672.77C58230.67,-685.99 58230.67,-698 58230.67,-698 58230.67,-698 59717.5,-698 59717.5,-698 59717.5,-698 59717.5,-543.76 59717.5,-543.76"/>
<polygon fill="black" stroke="black" points="59721,-543.76 59717.5,-533.76 59714,-543.76 59721,-543.76"/>
</g>
<!-- L6_S0_TP2_GPU2_expert0&#45;&gt;L6_S0_TP5_GPU5_moe_ar -->
<g id="edge1930" class="edge">
<title>L6_S0_TP2_GPU2_expert0&#45;&gt;L6_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M58155.83,-672.85C58155.83,-686.93 58155.83,-700 58155.83,-700 58155.83,-700 60649.5,-700 60649.5,-700 60649.5,-700 60649.5,-577.6 60649.5,-577.6"/>
<polygon fill="black" stroke="black" points="60653,-577.6 60649.5,-567.6 60646,-577.6 60653,-577.6"/>
</g>
<!-- L6_S0_TP2_GPU2_expert0&#45;&gt;L6_S0_TP6_GPU6_moe_ar -->
<g id="edge1966" class="edge">
<title>L6_S0_TP2_GPU2_expert0&#45;&gt;L6_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M58081,-672.78C58081,-688.63 58081,-704 58081,-704 58081,-704 61118.3,-704 61118.3,-704 61118.3,-704 61118.3,-553.3 61118.3,-553.3"/>
<polygon fill="black" stroke="black" points="61121.8,-553.3 61118.3,-543.3 61114.8,-553.3 61121.8,-553.3"/>
</g>
<!-- L6_S0_TP2_GPU2_expert0&#45;&gt;L6_S0_TP7_GPU7_moe_ar -->
<g id="edge2002" class="edge">
<title>L6_S0_TP2_GPU2_expert0&#45;&gt;L6_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M58006.17,-672.75C58006.17,-689.87 58006.17,-707 58006.17,-707 58006.17,-707 62053.5,-707 62053.5,-707 62053.5,-707 62053.5,-578.47 62053.5,-578.47"/>
<polygon fill="black" stroke="black" points="62057,-578.47 62053.5,-568.47 62050,-578.47 62057,-578.47"/>
</g>
<!-- L6_S0_TP2_GPU2_expert1 -->
<g id="node647" class="node">
<title>L6_S0_TP2_GPU2_expert1</title>
<polygon fill="none" stroke="black" points="58772.5,-672.5 58323.5,-672.5 58323.5,-604.5 58772.5,-604.5 58772.5,-672.5"/>
<text text-anchor="middle" x="58548" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="58548" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="58548" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="58548" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L6_S0_TP2_GPU2_expert1&#45;&gt;L6_S0_TP0_GPU0_moe_ar -->
<g id="edge1751" class="edge">
<title>L6_S0_TP2_GPU2_expert1&#45;&gt;L6_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M58526.97,-604.36C58526.97,-588.89 58526.97,-574 58526.97,-574 58526.97,-574 57494.37,-574 57494.37,-574 57494.37,-574 57494.37,-568.79 57494.37,-568.79"/>
<polygon fill="black" stroke="black" points="57497.87,-568.79 57494.37,-558.79 57490.87,-568.79 57497.87,-568.79"/>
</g>
<!-- L6_S0_TP2_GPU2_expert1&#45;&gt;L6_S0_TP1_GPU1_moe_ar -->
<g id="edge1787" class="edge">
<title>L6_S0_TP2_GPU2_expert1&#45;&gt;L6_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M58327.02,-604.21C58327.02,-564.36 58327.02,-504 58327.02,-504 58327.02,-504 58302.6,-504 58302.6,-504"/>
<polygon fill="black" stroke="black" points="58302.6,-500.5 58292.6,-504 58302.6,-507.5 58302.6,-500.5"/>
</g>
<!-- L6_S0_TP2_GPU2_expert1&#45;&gt;L6_S0_TP2_GPU2_moe_ar -->
<g id="edge1823" class="edge">
<title>L6_S0_TP2_GPU2_expert1&#45;&gt;L6_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M58625.18,-604.34C58625.18,-604.34 58625.18,-578.55 58625.18,-578.55"/>
<polygon fill="black" stroke="black" points="58628.68,-578.55 58625.18,-568.55 58621.68,-578.55 58628.68,-578.55"/>
</g>
<!-- L6_S0_TP2_GPU2_expert1&#45;&gt;L6_S0_TP3_GPU3_moe_ar -->
<g id="edge1859" class="edge">
<title>L6_S0_TP2_GPU2_expert1&#45;&gt;L6_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M58674.29,-604.36C58674.29,-588.89 58674.29,-574 58674.29,-574 58674.29,-574 59140.85,-574 59140.85,-574 59140.85,-574 59140.85,-567.92 59140.85,-567.92"/>
<polygon fill="black" stroke="black" points="59144.35,-567.92 59140.85,-557.92 59137.35,-567.92 59144.35,-567.92"/>
</g>
<!-- L6_S0_TP2_GPU2_expert1&#45;&gt;L6_S0_TP4_GPU4_moe_ar -->
<g id="edge1895" class="edge">
<title>L6_S0_TP2_GPU2_expert1&#45;&gt;L6_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M58741.18,-672.77C58741.18,-685.99 58741.18,-698 58741.18,-698 58741.18,-698 59715.75,-698 59715.75,-698 59715.75,-698 59715.75,-542.9 59715.75,-542.9"/>
<polygon fill="black" stroke="black" points="59719.25,-542.9 59715.75,-532.9 59712.25,-542.9 59719.25,-542.9"/>
</g>
<!-- L6_S0_TP2_GPU2_expert1&#45;&gt;L6_S0_TP5_GPU5_moe_ar -->
<g id="edge1931" class="edge">
<title>L6_S0_TP2_GPU2_expert1&#45;&gt;L6_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M58723.39,-604.22C58723.39,-588.37 58723.39,-573 58723.39,-573 58723.39,-573 60422.66,-573 60422.66,-573 60422.66,-573 60422.66,-550.9 60422.66,-550.9"/>
<polygon fill="black" stroke="black" points="60426.16,-550.9 60422.66,-540.9 60419.16,-550.9 60426.16,-550.9"/>
</g>
<!-- L6_S0_TP2_GPU2_expert1&#45;&gt;L6_S0_TP6_GPU6_moe_ar -->
<g id="edge1967" class="edge">
<title>L6_S0_TP2_GPU2_expert1&#45;&gt;L6_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M58709.86,-672.85C58709.86,-687.81 58709.86,-702 58709.86,-702 58709.86,-702 61114.7,-702 61114.7,-702 61114.7,-702 61114.7,-552.32 61114.7,-552.32"/>
<polygon fill="black" stroke="black" points="61118.2,-552.32 61114.7,-542.32 61111.2,-552.32 61118.2,-552.32"/>
</g>
<!-- L6_S0_TP2_GPU2_expert1&#45;&gt;L6_S0_TP7_GPU7_moe_ar -->
<g id="edge2003" class="edge">
<title>L6_S0_TP2_GPU2_expert1&#45;&gt;L6_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M58678.54,-672.78C58678.54,-688.63 58678.54,-704 58678.54,-704 58678.54,-704 62047.5,-704 62047.5,-704 62047.5,-704 62047.5,-578.17 62047.5,-578.17"/>
<polygon fill="black" stroke="black" points="62051,-578.17 62047.5,-568.17 62044,-578.17 62051,-578.17"/>
</g>
<!-- L6_S0_TP3_GPU3_expert0 -->
<g id="node648" class="node">
<title>L6_S0_TP3_GPU3_expert0</title>
<polygon fill="none" stroke="black" points="59239.5,-672.5 58790.5,-672.5 58790.5,-604.5 59239.5,-604.5 59239.5,-672.5"/>
<text text-anchor="middle" x="59015" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="59015" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="59015" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="59015" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L6_S0_TP3_GPU3_expert0&#45;&gt;L6_S0_TP0_GPU0_moe_ar -->
<g id="edge1752" class="edge">
<title>L6_S0_TP3_GPU3_expert0&#45;&gt;L6_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M58813.72,-604.36C58813.72,-588.89 58813.72,-574 58813.72,-574 58813.72,-574 57520.59,-574 57520.59,-574 57520.59,-574 57520.59,-565.56 57520.59,-565.56"/>
<polygon fill="black" stroke="black" points="57524.09,-565.56 57520.59,-555.56 57517.09,-565.56 57524.09,-565.56"/>
</g>
<!-- L6_S0_TP3_GPU3_expert0&#45;&gt;L6_S0_TP1_GPU1_moe_ar -->
<g id="edge1788" class="edge">
<title>L6_S0_TP3_GPU3_expert0&#45;&gt;L6_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M58836.94,-604.22C58836.94,-588.37 58836.94,-573 58836.94,-573 58836.94,-573 58081,-573 58081,-573 58081,-573 58081,-572.36 58081,-572.36"/>
<polygon fill="black" stroke="black" points="58084.5,-576.55 58081,-566.55 58077.5,-576.55 58084.5,-576.55"/>
</g>
<!-- L6_S0_TP3_GPU3_expert0&#45;&gt;L6_S0_TP2_GPU2_moe_ar -->
<g id="edge1824" class="edge">
<title>L6_S0_TP3_GPU3_expert0&#45;&gt;L6_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M58860.15,-604.34C58860.15,-604.34 58860.15,-569.48 58860.15,-569.48"/>
<polygon fill="black" stroke="black" points="58863.65,-569.48 58860.15,-559.48 58856.65,-569.48 58863.65,-569.48"/>
</g>
<!-- L6_S0_TP3_GPU3_expert0&#45;&gt;L6_S0_TP3_GPU3_moe_ar -->
<g id="edge1860" class="edge">
<title>L6_S0_TP3_GPU3_expert0&#45;&gt;L6_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M59165.51,-604.34C59165.51,-604.34 59165.51,-570.75 59165.51,-570.75"/>
<polygon fill="black" stroke="black" points="59169.01,-570.75 59165.51,-560.75 59162.01,-570.75 59169.01,-570.75"/>
</g>
<!-- L6_S0_TP3_GPU3_expert0&#45;&gt;L6_S0_TP4_GPU4_moe_ar -->
<g id="edge1896" class="edge">
<title>L6_S0_TP3_GPU3_expert0&#45;&gt;L6_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M59190.18,-604.36C59190.18,-588.89 59190.18,-574 59190.18,-574 59190.18,-574 59708.75,-574 59708.75,-574 59708.75,-574 59708.75,-538.32 59708.75,-538.32"/>
<polygon fill="black" stroke="black" points="59712.25,-538.32 59708.75,-528.32 59705.25,-538.32 59712.25,-538.32"/>
</g>
<!-- L6_S0_TP3_GPU3_expert0&#45;&gt;L6_S0_TP5_GPU5_moe_ar -->
<g id="edge1932" class="edge">
<title>L6_S0_TP3_GPU3_expert0&#45;&gt;L6_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M59214.84,-604.22C59214.84,-588.37 59214.84,-573 59214.84,-573 59214.84,-573 60453.78,-573 60453.78,-573 60453.78,-573 60453.78,-558.56 60453.78,-558.56"/>
<polygon fill="black" stroke="black" points="60457.28,-558.56 60453.78,-548.56 60450.28,-558.56 60457.28,-558.56"/>
</g>
<!-- L6_S0_TP3_GPU3_expert0&#45;&gt;L6_S0_TP6_GPU6_moe_ar -->
<g id="edge1968" class="edge">
<title>L6_S0_TP3_GPU3_expert0&#45;&gt;L6_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M59089.83,-672.77C59089.83,-685.99 59089.83,-698 59089.83,-698 59089.83,-698 61111.1,-698 61111.1,-698 61111.1,-698 61111.1,-551.13 61111.1,-551.13"/>
<polygon fill="black" stroke="black" points="61114.6,-551.13 61111.1,-541.13 61107.6,-551.13 61114.6,-551.13"/>
</g>
<!-- L6_S0_TP3_GPU3_expert0&#45;&gt;L6_S0_TP7_GPU7_moe_ar -->
<g id="edge2004" class="edge">
<title>L6_S0_TP3_GPU3_expert0&#45;&gt;L6_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M59008.5,-604.47C59008.5,-553.18 59008.5,-462 59008.5,-462 59008.5,-462 61978.77,-462 61978.77,-462 61978.77,-462 61978.77,-465.55 61978.77,-465.55"/>
<polygon fill="black" stroke="black" points="61975.27,-465.55 61978.77,-475.55 61982.27,-465.55 61975.27,-465.55"/>
</g>
<!-- L6_S0_TP3_GPU3_expert1 -->
<g id="node649" class="node">
<title>L6_S0_TP3_GPU3_expert1</title>
<polygon fill="none" stroke="black" points="59706.5,-672.5 59257.5,-672.5 59257.5,-604.5 59706.5,-604.5 59706.5,-672.5"/>
<text text-anchor="middle" x="59482" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="59482" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="59482" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="59482" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L6_S0_TP3_GPU3_expert1&#45;&gt;L6_S0_TP0_GPU0_moe_ar -->
<g id="edge1753" class="edge">
<title>L6_S0_TP3_GPU3_expert1&#45;&gt;L6_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M59296.5,-604.36C59296.5,-588.89 59296.5,-574 59296.5,-574 59296.5,-574 57546.81,-574 57546.81,-574 57546.81,-574 57546.81,-561.59 57546.81,-561.59"/>
<polygon fill="black" stroke="black" points="57550.31,-561.59 57546.81,-551.59 57543.31,-561.59 57550.31,-561.59"/>
</g>
<!-- L6_S0_TP3_GPU3_expert1&#45;&gt;L6_S0_TP1_GPU1_moe_ar -->
<g id="edge1789" class="edge">
<title>L6_S0_TP3_GPU3_expert1&#45;&gt;L6_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M59335.49,-604.22C59335.49,-588.37 59335.49,-573 59335.49,-573 59335.49,-573 58137.12,-573 58137.12,-573 58137.12,-573 58137.12,-571.99 58137.12,-571.99"/>
<polygon fill="black" stroke="black" points="58140.63,-572.86 58137.12,-562.86 58133.63,-572.86 58140.63,-572.86"/>
</g>
<!-- L6_S0_TP3_GPU3_expert1&#45;&gt;L6_S0_TP2_GPU2_moe_ar -->
<g id="edge1825" class="edge">
<title>L6_S0_TP3_GPU3_expert1&#45;&gt;L6_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M59374.49,-604.22C59374.49,-588.37 59374.49,-573 59374.49,-573 59374.49,-573 58883.37,-573 58883.37,-573 58883.37,-573 58883.37,-566.94 58883.37,-566.94"/>
<polygon fill="black" stroke="black" points="58886.87,-566.94 58883.37,-556.94 58879.87,-566.94 58886.87,-566.94"/>
</g>
<!-- L6_S0_TP3_GPU3_expert1&#45;&gt;L6_S0_TP3_GPU3_moe_ar -->
<g id="edge1861" class="edge">
<title>L6_S0_TP3_GPU3_expert1&#45;&gt;L6_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M59413.49,-604.34C59413.49,-604.34 59413.49,-578.11 59413.49,-578.11"/>
<polygon fill="black" stroke="black" points="59416.99,-578.11 59413.49,-568.11 59409.99,-578.11 59416.99,-578.11"/>
</g>
<!-- L6_S0_TP3_GPU3_expert1&#45;&gt;L6_S0_TP4_GPU4_moe_ar -->
<g id="edge1897" class="edge">
<title>L6_S0_TP3_GPU3_expert1&#45;&gt;L6_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M59706.54,-638C59711.32,-638 59714,-638 59714,-638 59714,-638 59714,-542.12 59714,-542.12"/>
<polygon fill="black" stroke="black" points="59717.5,-542.12 59714,-532.12 59710.5,-542.12 59717.5,-542.12"/>
</g>
<!-- L6_S0_TP3_GPU3_expert1&#45;&gt;L6_S0_TP5_GPU5_moe_ar -->
<g id="edge1933" class="edge">
<title>L6_S0_TP3_GPU3_expert1&#45;&gt;L6_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M59693.69,-604.36C59693.69,-588.89 59693.69,-574 59693.69,-574 59693.69,-574 60484.9,-574 60484.9,-574 60484.9,-574 60484.9,-563.74 60484.9,-563.74"/>
<polygon fill="black" stroke="black" points="60488.4,-563.74 60484.9,-553.74 60481.4,-563.74 60488.4,-563.74"/>
</g>
<!-- L6_S0_TP3_GPU3_expert1&#45;&gt;L6_S0_TP6_GPU6_moe_ar -->
<g id="edge1969" class="edge">
<title>L6_S0_TP3_GPU3_expert1&#45;&gt;L6_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M59452.48,-604.22C59452.48,-588.37 59452.48,-573 59452.48,-573 59452.48,-573 61083.37,-573 61083.37,-573 61083.37,-573 61083.37,-538.63 61083.37,-538.63"/>
<polygon fill="black" stroke="black" points="61086.87,-538.63 61083.37,-528.63 61079.87,-538.63 61086.87,-538.63"/>
</g>
<!-- L6_S0_TP3_GPU3_expert1&#45;&gt;L6_S0_TP7_GPU7_moe_ar -->
<g id="edge2005" class="edge">
<title>L6_S0_TP3_GPU3_expert1&#45;&gt;L6_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M59690.08,-604.47C59690.08,-553.18 59690.08,-462 59690.08,-462 59690.08,-462 61872.15,-462 61872.15,-462 61872.15,-462 61872.15,-475.09 61872.15,-475.09"/>
<polygon fill="black" stroke="black" points="61868.65,-475.09 61872.15,-485.09 61875.65,-475.09 61868.65,-475.09"/>
</g>
<!-- L6_S0_TP4_GPU4_expert0 -->
<g id="node650" class="node">
<title>L6_S0_TP4_GPU4_expert0</title>
<polygon fill="none" stroke="black" points="60173.5,-672.5 59724.5,-672.5 59724.5,-604.5 60173.5,-604.5 60173.5,-672.5"/>
<text text-anchor="middle" x="59949" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="59949" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="59949" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="59949" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L6_S0_TP4_GPU4_expert0&#45;&gt;L6_S0_TP0_GPU0_moe_ar -->
<g id="edge1754" class="edge">
<title>L6_S0_TP4_GPU4_expert0&#45;&gt;L6_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M59874.65,-672.85C59874.65,-686.93 59874.65,-700 59874.65,-700 59874.65,-700 57385.9,-700 57385.9,-700 57385.9,-700 57385.9,-576.66 57385.9,-576.66"/>
<polygon fill="black" stroke="black" points="57389.4,-576.66 57385.9,-566.66 57382.4,-576.66 57389.4,-576.66"/>
</g>
<!-- L6_S0_TP4_GPU4_expert0&#45;&gt;L6_S0_TP1_GPU1_moe_ar -->
<g id="edge1790" class="edge">
<title>L6_S0_TP4_GPU4_expert0&#45;&gt;L6_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M59780.62,-604.22C59780.62,-588.37 59780.62,-573 59780.62,-573 59780.62,-573 58193.25,-573 58193.25,-573 58193.25,-573 58193.25,-567.22 58193.25,-567.22"/>
<polygon fill="black" stroke="black" points="58196.75,-567.22 58193.25,-557.22 58189.75,-567.22 58196.75,-567.22"/>
</g>
<!-- L6_S0_TP4_GPU4_expert0&#45;&gt;L6_S0_TP2_GPU2_moe_ar -->
<g id="edge1826" class="edge">
<title>L6_S0_TP4_GPU4_expert0&#45;&gt;L6_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M59836.75,-604.22C59836.75,-588.37 59836.75,-573 59836.75,-573 59836.75,-573 58906.59,-573 58906.59,-573 58906.59,-573 58906.59,-563.72 58906.59,-563.72"/>
<polygon fill="black" stroke="black" points="58910.09,-563.72 58906.59,-553.72 58903.09,-563.72 58910.09,-563.72"/>
</g>
<!-- L6_S0_TP4_GPU4_expert0&#45;&gt;L6_S0_TP3_GPU3_moe_ar -->
<g id="edge1862" class="edge">
<title>L6_S0_TP4_GPU4_expert0&#45;&gt;L6_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M59892.88,-604.22C59892.88,-588.37 59892.88,-573 59892.88,-573 59892.88,-573 59491.48,-573 59491.48,-573 59491.48,-573 59491.48,-572.13 59491.48,-572.13"/>
<polygon fill="black" stroke="black" points="59494.98,-574.32 59491.48,-564.32 59487.98,-574.32 59494.98,-574.32"/>
</g>
<!-- L6_S0_TP4_GPU4_expert0&#45;&gt;L6_S0_TP4_GPU4_moe_ar -->
<g id="edge1898" class="edge">
<title>L6_S0_TP4_GPU4_expert0&#45;&gt;L6_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M59949,-604.34C59949,-604.34 59949,-576.79 59949,-576.79"/>
<polygon fill="black" stroke="black" points="59952.5,-576.79 59949,-566.79 59945.5,-576.79 59952.5,-576.79"/>
</g>
<!-- L6_S0_TP4_GPU4_expert0&#45;&gt;L6_S0_TP5_GPU5_moe_ar -->
<g id="edge1934" class="edge">
<title>L6_S0_TP4_GPU4_expert0&#45;&gt;L6_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M60005.12,-604.42C60005.12,-601.71 60005.12,-600 60005.12,-600 60005.12,-600 60516.02,-600 60516.02,-600 60516.02,-600 60516.02,-567.88 60516.02,-567.88"/>
<polygon fill="black" stroke="black" points="60519.52,-567.88 60516.02,-557.88 60512.52,-567.88 60519.52,-567.88"/>
</g>
<!-- L6_S0_TP4_GPU4_expert0&#45;&gt;L6_S0_TP6_GPU6_moe_ar -->
<g id="edge1970" class="edge">
<title>L6_S0_TP4_GPU4_expert0&#45;&gt;L6_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M60061.25,-604.42C60061.25,-601.71 60061.25,-600 60061.25,-600 60061.25,-600 61088.19,-600 61088.19,-600 61088.19,-600 61088.19,-542.16 61088.19,-542.16"/>
<polygon fill="black" stroke="black" points="61091.69,-542.16 61088.19,-532.16 61084.69,-542.16 61091.69,-542.16"/>
</g>
<!-- L6_S0_TP4_GPU4_expert0&#45;&gt;L6_S0_TP7_GPU7_moe_ar -->
<g id="edge2006" class="edge">
<title>L6_S0_TP4_GPU4_expert0&#45;&gt;L6_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M60117.38,-604.42C60117.38,-601.71 60117.38,-600 60117.38,-600 60117.38,-600 61903.52,-600 61903.52,-600 61903.52,-600 61903.52,-569.74 61903.52,-569.74"/>
<polygon fill="black" stroke="black" points="61907.02,-569.74 61903.52,-559.74 61900.02,-569.74 61907.02,-569.74"/>
</g>
<!-- L6_S0_TP4_GPU4_expert1 -->
<g id="node651" class="node">
<title>L6_S0_TP4_GPU4_expert1</title>
<polygon fill="none" stroke="black" points="60640.5,-672.5 60191.5,-672.5 60191.5,-604.5 60640.5,-604.5 60640.5,-672.5"/>
<text text-anchor="middle" x="60416" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="60416" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="60416" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="60416" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L6_S0_TP4_GPU4_expert1&#45;&gt;L6_S0_TP0_GPU0_moe_ar -->
<g id="edge1755" class="edge">
<title>L6_S0_TP4_GPU4_expert1&#45;&gt;L6_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M60385.51,-604.45C60385.51,-548.43 60385.51,-443 60385.51,-443 60385.51,-443 57472.97,-443 57472.97,-443 57472.97,-443 57472.97,-469.89 57472.97,-469.89"/>
<polygon fill="black" stroke="black" points="57469.47,-469.89 57472.97,-479.89 57476.47,-469.89 57469.47,-469.89"/>
</g>
<!-- L6_S0_TP4_GPU4_expert1&#45;&gt;L6_S0_TP1_GPU1_moe_ar -->
<g id="edge1791" class="edge">
<title>L6_S0_TP4_GPU4_expert1&#45;&gt;L6_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M60379.49,-604.45C60379.49,-548.43 60379.49,-443 60379.49,-443 60379.49,-443 58155.1,-443 58155.1,-443 58155.1,-443 58155.1,-469.44 58155.1,-469.44"/>
<polygon fill="black" stroke="black" points="58151.6,-469.44 58155.1,-479.44 58158.6,-469.44 58151.6,-469.44"/>
</g>
<!-- L6_S0_TP4_GPU4_expert1&#45;&gt;L6_S0_TP2_GPU2_moe_ar -->
<g id="edge1827" class="edge">
<title>L6_S0_TP4_GPU4_expert1&#45;&gt;L6_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M60214.25,-604.22C60214.25,-588.37 60214.25,-573 60214.25,-573 60214.25,-573 58929.81,-573 58929.81,-573 58929.81,-573 58929.81,-560.09 58929.81,-560.09"/>
<polygon fill="black" stroke="black" points="58933.31,-560.09 58929.81,-550.09 58926.31,-560.09 58933.31,-560.09"/>
</g>
<!-- L6_S0_TP4_GPU4_expert1&#45;&gt;L6_S0_TP3_GPU3_moe_ar -->
<g id="edge1863" class="edge">
<title>L6_S0_TP4_GPU4_expert1&#45;&gt;L6_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M60236.99,-604.22C60236.99,-588.37 60236.99,-573 60236.99,-573 60236.99,-573 59530.48,-573 59530.48,-573 59530.48,-573 59530.48,-571.33 59530.48,-571.33"/>
<polygon fill="black" stroke="black" points="59533.98,-571.33 59530.48,-561.33 59526.98,-571.33 59533.98,-571.33"/>
</g>
<!-- L6_S0_TP4_GPU4_expert1&#45;&gt;L6_S0_TP4_GPU4_moe_ar -->
<g id="edge1899" class="edge">
<title>L6_S0_TP4_GPU4_expert1&#45;&gt;L6_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M60259.74,-604.34C60259.74,-604.34 60259.74,-566.55 60259.74,-566.55"/>
<polygon fill="black" stroke="black" points="60263.24,-566.55 60259.74,-556.55 60256.24,-566.55 60263.24,-566.55"/>
</g>
<!-- L6_S0_TP4_GPU4_expert1&#45;&gt;L6_S0_TP5_GPU5_moe_ar -->
<g id="edge1935" class="edge">
<title>L6_S0_TP4_GPU4_expert1&#45;&gt;L6_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M60547.14,-604.34C60547.14,-604.34 60547.14,-571.18 60547.14,-571.18"/>
<polygon fill="black" stroke="black" points="60550.64,-571.18 60547.14,-561.18 60543.64,-571.18 60550.64,-571.18"/>
</g>
<!-- L6_S0_TP4_GPU4_expert1&#45;&gt;L6_S0_TP6_GPU6_moe_ar -->
<g id="edge1971" class="edge">
<title>L6_S0_TP4_GPU4_expert1&#45;&gt;L6_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M60578.26,-604.42C60578.26,-601.71 60578.26,-600 60578.26,-600 60578.26,-600 61093.02,-600 61093.02,-600 61093.02,-600 61093.02,-544.64 61093.02,-544.64"/>
<polygon fill="black" stroke="black" points="61096.52,-544.64 61093.02,-534.64 61089.52,-544.64 61096.52,-544.64"/>
</g>
<!-- L6_S0_TP4_GPU4_expert1&#45;&gt;L6_S0_TP7_GPU7_moe_ar -->
<g id="edge2007" class="edge">
<title>L6_S0_TP4_GPU4_expert1&#45;&gt;L6_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M60609.38,-604.42C60609.38,-601.71 60609.38,-600 60609.38,-600 60609.38,-600 61931.12,-600 61931.12,-600 61931.12,-600 61931.12,-572.07 61931.12,-572.07"/>
<polygon fill="black" stroke="black" points="61934.62,-572.07 61931.12,-562.07 61927.62,-572.07 61934.62,-572.07"/>
</g>
<!-- L6_S0_TP5_GPU5_expert0 -->
<g id="node652" class="node">
<title>L6_S0_TP5_GPU5_expert0</title>
<polygon fill="none" stroke="black" points="61107.5,-672.5 60658.5,-672.5 60658.5,-604.5 61107.5,-604.5 61107.5,-672.5"/>
<text text-anchor="middle" x="60883" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="60883" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="60883" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="60883" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L6_S0_TP5_GPU5_expert0&#45;&gt;L6_S0_TP0_GPU0_moe_ar -->
<g id="edge1756" class="edge">
<title>L6_S0_TP5_GPU5_expert0&#45;&gt;L6_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M60742.69,-672.65C60742.69,-689.39 60742.69,-706 60742.69,-706 60742.69,-706 57382.3,-706 57382.3,-706 57382.3,-706 57382.3,-576.77 57382.3,-576.77"/>
<polygon fill="black" stroke="black" points="57385.8,-576.77 57382.3,-566.77 57378.8,-576.77 57385.8,-576.77"/>
</g>
<!-- L6_S0_TP5_GPU5_expert0&#45;&gt;L6_S0_TP1_GPU1_moe_ar -->
<g id="edge1792" class="edge">
<title>L6_S0_TP5_GPU5_expert0&#45;&gt;L6_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M60700.59,-672.64C60700.59,-688.11 60700.59,-703 60700.59,-703 60700.59,-703 57847.5,-703 57847.5,-703 57847.5,-703 57847.5,-575.08 57847.5,-575.08"/>
<polygon fill="black" stroke="black" points="57851,-575.08 57847.5,-565.08 57844,-575.08 57851,-575.08"/>
</g>
<!-- L6_S0_TP5_GPU5_expert0&#45;&gt;L6_S0_TP2_GPU2_moe_ar -->
<g id="edge1828" class="edge">
<title>L6_S0_TP5_GPU5_expert0&#45;&gt;L6_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M60703.16,-604.22C60703.16,-588.37 60703.16,-573 60703.16,-573 60703.16,-573 58953.03,-573 58953.03,-573 58953.03,-573 58953.03,-554.86 58953.03,-554.86"/>
<polygon fill="black" stroke="black" points="58956.53,-554.86 58953.03,-544.86 58949.53,-554.86 58956.53,-554.86"/>
</g>
<!-- L6_S0_TP5_GPU5_expert0&#45;&gt;L6_S0_TP3_GPU3_moe_ar -->
<g id="edge1864" class="edge">
<title>L6_S0_TP5_GPU5_expert0&#45;&gt;L6_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M60747.82,-604.22C60747.82,-588.37 60747.82,-573 60747.82,-573 60747.82,-573 59569.47,-573 59569.47,-573 59569.47,-573 59569.47,-567.22 59569.47,-567.22"/>
<polygon fill="black" stroke="black" points="59572.97,-567.22 59569.47,-557.22 59565.97,-567.22 59572.97,-567.22"/>
</g>
<!-- L6_S0_TP5_GPU5_expert0&#45;&gt;L6_S0_TP4_GPU4_moe_ar -->
<g id="edge1900" class="edge">
<title>L6_S0_TP5_GPU5_expert0&#45;&gt;L6_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M60792.49,-604.22C60792.49,-588.37 60792.49,-573 60792.49,-573 60792.49,-573 60282.48,-573 60282.48,-573 60282.48,-573 60282.48,-563.42 60282.48,-563.42"/>
<polygon fill="black" stroke="black" points="60285.98,-563.42 60282.48,-553.42 60278.98,-563.42 60285.98,-563.42"/>
</g>
<!-- L6_S0_TP5_GPU5_expert0&#45;&gt;L6_S0_TP5_GPU5_moe_ar -->
<g id="edge1936" class="edge">
<title>L6_S0_TP5_GPU5_expert0&#45;&gt;L6_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M60837.15,-604.34C60837.15,-604.34 60837.15,-575.92 60837.15,-575.92"/>
<polygon fill="black" stroke="black" points="60840.65,-575.92 60837.15,-565.92 60833.65,-575.92 60840.65,-575.92"/>
</g>
<!-- L6_S0_TP5_GPU5_expert0&#45;&gt;L6_S0_TP6_GPU6_moe_ar -->
<g id="edge1972" class="edge">
<title>L6_S0_TP5_GPU5_expert0&#45;&gt;L6_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M61097.85,-604.34C61097.85,-604.34 61097.85,-546.81 61097.85,-546.81"/>
<polygon fill="black" stroke="black" points="61101.35,-546.81 61097.85,-536.81 61094.35,-546.81 61101.35,-546.81"/>
</g>
<!-- L6_S0_TP5_GPU5_expert0&#45;&gt;L6_S0_TP7_GPU7_moe_ar -->
<g id="edge2008" class="edge">
<title>L6_S0_TP5_GPU5_expert0&#45;&gt;L6_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M61102.67,-604.42C61102.67,-601.71 61102.67,-600 61102.67,-600 61102.67,-600 61958.71,-600 61958.71,-600 61958.71,-600 61958.71,-574.4 61958.71,-574.4"/>
<polygon fill="black" stroke="black" points="61962.21,-574.4 61958.71,-564.4 61955.21,-574.4 61962.21,-574.4"/>
</g>
<!-- L6_S0_TP5_GPU5_expert1 -->
<g id="node653" class="node">
<title>L6_S0_TP5_GPU5_expert1</title>
<polygon fill="none" stroke="black" points="61574.5,-672.5 61125.5,-672.5 61125.5,-604.5 61574.5,-604.5 61574.5,-672.5"/>
<text text-anchor="middle" x="61350" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="61350" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="61350" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="61350" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L6_S0_TP5_GPU5_expert1&#45;&gt;L6_S0_TP0_GPU0_moe_ar -->
<g id="edge1757" class="edge">
<title>L6_S0_TP5_GPU5_expert1&#45;&gt;L6_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M61275.17,-672.75C61275.17,-689.87 61275.17,-707 61275.17,-707 61275.17,-707 57378.7,-707 57378.7,-707 57378.7,-707 57378.7,-577.02 57378.7,-577.02"/>
<polygon fill="black" stroke="black" points="57382.2,-577.02 57378.7,-567.02 57375.2,-577.02 57382.2,-577.02"/>
</g>
<!-- L6_S0_TP5_GPU5_expert1&#45;&gt;L6_S0_TP1_GPU1_moe_ar -->
<g id="edge1793" class="edge">
<title>L6_S0_TP5_GPU5_expert1&#45;&gt;L6_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M61181.62,-604.22C61181.62,-588.37 61181.62,-573 61181.62,-573 61181.62,-573 58249.38,-573 58249.38,-573 58249.38,-573 58249.38,-558.56 58249.38,-558.56"/>
<polygon fill="black" stroke="black" points="58252.88,-558.56 58249.38,-548.56 58245.88,-558.56 58252.88,-558.56"/>
</g>
<!-- L6_S0_TP5_GPU5_expert1&#45;&gt;L6_S0_TP2_GPU2_moe_ar -->
<g id="edge1829" class="edge">
<title>L6_S0_TP5_GPU5_expert1&#45;&gt;L6_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M61237.75,-604.22C61237.75,-588.37 61237.75,-573 61237.75,-573 61237.75,-573 58976.24,-573 58976.24,-573 58976.24,-573 58976.24,-548.22 58976.24,-548.22"/>
<polygon fill="black" stroke="black" points="58979.74,-548.22 58976.24,-538.22 58972.74,-548.22 58979.74,-548.22"/>
</g>
<!-- L6_S0_TP5_GPU5_expert1&#45;&gt;L6_S0_TP3_GPU3_moe_ar -->
<g id="edge1865" class="edge">
<title>L6_S0_TP5_GPU5_expert1&#45;&gt;L6_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M61293.88,-604.22C61293.88,-588.37 61293.88,-573 61293.88,-573 61293.88,-573 59608.47,-573 59608.47,-573 59608.47,-573 59608.47,-561.31 59608.47,-561.31"/>
<polygon fill="black" stroke="black" points="59611.97,-561.31 59608.47,-551.31 59604.97,-561.31 59611.97,-561.31"/>
</g>
<!-- L6_S0_TP5_GPU5_expert1&#45;&gt;L6_S0_TP4_GPU4_moe_ar -->
<g id="edge1901" class="edge">
<title>L6_S0_TP5_GPU5_expert1&#45;&gt;L6_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M61350,-604.22C61350,-588.37 61350,-573 61350,-573 61350,-573 60305.23,-573 60305.23,-573 60305.23,-573 60305.23,-559.78 60305.23,-559.78"/>
<polygon fill="black" stroke="black" points="60308.73,-559.78 60305.23,-549.78 60301.73,-559.78 60308.73,-559.78"/>
</g>
<!-- L6_S0_TP5_GPU5_expert1&#45;&gt;L6_S0_TP5_GPU5_moe_ar -->
<g id="edge1937" class="edge">
<title>L6_S0_TP5_GPU5_expert1&#45;&gt;L6_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M61406.12,-604.47C61406.12,-588.11 61406.12,-572 61406.12,-572 61406.12,-572 60881.81,-572 60881.81,-572 60881.81,-572 60881.81,-571.1 60881.81,-571.1"/>
<polygon fill="black" stroke="black" points="60885.31,-573.01 60881.81,-563.01 60878.31,-573.01 60885.31,-573.01"/>
</g>
<!-- L6_S0_TP5_GPU5_expert1&#45;&gt;L6_S0_TP6_GPU6_moe_ar -->
<g id="edge1973" class="edge">
<title>L6_S0_TP5_GPU5_expert1&#45;&gt;L6_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M61462.25,-604.34C61462.25,-604.34 61462.25,-578.11 61462.25,-578.11"/>
<polygon fill="black" stroke="black" points="61465.75,-578.11 61462.25,-568.11 61458.75,-578.11 61465.75,-578.11"/>
</g>
<!-- L6_S0_TP5_GPU5_expert1&#45;&gt;L6_S0_TP7_GPU7_moe_ar -->
<g id="edge2009" class="edge">
<title>L6_S0_TP5_GPU5_expert1&#45;&gt;L6_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M61518.38,-604.42C61518.38,-601.71 61518.38,-600 61518.38,-600 61518.38,-600 61986.31,-600 61986.31,-600 61986.31,-600 61986.31,-575.79 61986.31,-575.79"/>
<polygon fill="black" stroke="black" points="61989.81,-575.79 61986.31,-565.79 61982.81,-575.79 61989.81,-575.79"/>
</g>
<!-- L6_S0_TP6_GPU6_expert0 -->
<g id="node654" class="node">
<title>L6_S0_TP6_GPU6_expert0</title>
<polygon fill="none" stroke="black" points="62041.5,-672.5 61592.5,-672.5 61592.5,-604.5 62041.5,-604.5 62041.5,-672.5"/>
<text text-anchor="middle" x="61817" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="61817" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="61817" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="61817" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L6_S0_TP6_GPU6_expert0&#45;&gt;L6_S0_TP0_GPU0_moe_ar -->
<g id="edge1758" class="edge">
<title>L6_S0_TP6_GPU6_expert0&#45;&gt;L6_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M61848.33,-604.36C61848.33,-588.89 61848.33,-574 61848.33,-574 61848.33,-574 57573.03,-574 57573.03,-574 57573.03,-574 57573.03,-556.27 57573.03,-556.27"/>
<polygon fill="black" stroke="black" points="57576.53,-556.27 57573.03,-546.27 57569.53,-556.27 57576.53,-556.27"/>
</g>
<!-- L6_S0_TP6_GPU6_expert0&#45;&gt;L6_S0_TP1_GPU1_moe_ar -->
<g id="edge1794" class="edge">
<title>L6_S0_TP6_GPU6_expert0&#45;&gt;L6_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M61609.72,-604.36C61609.72,-588.89 61609.72,-574 61609.72,-574 61609.72,-574 57751.85,-574 57751.85,-574 57751.85,-574 57751.85,-565.86 57751.85,-565.86"/>
<polygon fill="black" stroke="black" points="57755.35,-565.86 57751.85,-555.86 57748.35,-565.86 57755.35,-565.86"/>
</g>
<!-- L6_S0_TP6_GPU6_expert0&#45;&gt;L6_S0_TP2_GPU2_moe_ar -->
<g id="edge1830" class="edge">
<title>L6_S0_TP6_GPU6_expert0&#45;&gt;L6_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M61753.49,-604.2C61753.49,-555.2 61753.49,-471 61753.49,-471 61753.49,-471 58972.37,-471 58972.37,-471 58972.37,-471 58972.37,-491.45 58972.37,-491.45"/>
<polygon fill="black" stroke="black" points="58968.87,-491.45 58972.37,-501.45 58975.87,-491.45 58968.87,-491.45"/>
</g>
<!-- L6_S0_TP6_GPU6_expert0&#45;&gt;L6_S0_TP3_GPU3_moe_ar -->
<g id="edge1866" class="edge">
<title>L6_S0_TP6_GPU6_expert0&#45;&gt;L6_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M61626.94,-604.22C61626.94,-588.37 61626.94,-573 61626.94,-573 61626.94,-573 59647.47,-573 59647.47,-573 59647.47,-573 59647.47,-553.02 59647.47,-553.02"/>
<polygon fill="black" stroke="black" points="59650.97,-553.02 59647.47,-543.02 59643.97,-553.02 59650.97,-553.02"/>
</g>
<!-- L6_S0_TP6_GPU6_expert0&#45;&gt;L6_S0_TP4_GPU4_moe_ar -->
<g id="edge1902" class="edge">
<title>L6_S0_TP6_GPU6_expert0&#45;&gt;L6_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M61644.15,-604.22C61644.15,-588.37 61644.15,-573 61644.15,-573 61644.15,-573 60327.97,-573 60327.97,-573 60327.97,-573 60327.97,-554.86 60327.97,-554.86"/>
<polygon fill="black" stroke="black" points="60331.47,-554.86 60327.97,-544.86 60324.47,-554.86 60331.47,-554.86"/>
</g>
<!-- L6_S0_TP6_GPU6_expert0&#45;&gt;L6_S0_TP5_GPU5_moe_ar -->
<g id="edge1938" class="edge">
<title>L6_S0_TP6_GPU6_expert0&#45;&gt;L6_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M61661.37,-604.47C61661.37,-588.11 61661.37,-572 61661.37,-572 61661.37,-572 60926.47,-572 60926.47,-572 60926.47,-572 60926.47,-568.98 60926.47,-568.98"/>
<polygon fill="black" stroke="black" points="60929.97,-568.98 60926.47,-558.98 60922.97,-568.98 60929.97,-568.98"/>
</g>
<!-- L6_S0_TP6_GPU6_expert0&#45;&gt;L6_S0_TP6_GPU6_moe_ar -->
<g id="edge1974" class="edge">
<title>L6_S0_TP6_GPU6_expert0&#45;&gt;L6_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M61678.59,-604.34C61678.59,-604.34 61678.59,-559.69 61678.59,-559.69"/>
<polygon fill="black" stroke="black" points="61682.09,-559.69 61678.59,-549.69 61675.09,-559.69 61682.09,-559.69"/>
</g>
<!-- L6_S0_TP6_GPU6_expert0&#45;&gt;L6_S0_TP7_GPU7_moe_ar -->
<g id="edge2010" class="edge">
<title>L6_S0_TP6_GPU6_expert0&#45;&gt;L6_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M62013.9,-604.34C62013.9,-604.34 62013.9,-577.23 62013.9,-577.23"/>
<polygon fill="black" stroke="black" points="62017.4,-577.23 62013.9,-567.23 62010.4,-577.23 62017.4,-577.23"/>
</g>
<!-- L6_S0_TP6_GPU6_expert1 -->
<g id="node655" class="node">
<title>L6_S0_TP6_GPU6_expert1</title>
<polygon fill="none" stroke="black" points="62508.5,-672.5 62059.5,-672.5 62059.5,-604.5 62508.5,-604.5 62508.5,-672.5"/>
<text text-anchor="middle" x="62284" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="62284" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="62284" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="62284" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L6_S0_TP6_GPU6_expert1&#45;&gt;L6_S0_TP0_GPU0_moe_ar -->
<g id="edge1759" class="edge">
<title>L6_S0_TP6_GPU6_expert1&#45;&gt;L6_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M62113.07,-604.36C62113.07,-588.89 62113.07,-574 62113.07,-574 62113.07,-574 57599.24,-574 57599.24,-574 57599.24,-574 57599.24,-549.16 57599.24,-549.16"/>
<polygon fill="black" stroke="black" points="57602.74,-549.16 57599.24,-539.16 57595.74,-549.16 57602.74,-549.16"/>
</g>
<!-- L6_S0_TP6_GPU6_expert1&#45;&gt;L6_S0_TP1_GPU1_moe_ar -->
<g id="edge1795" class="edge">
<title>L6_S0_TP6_GPU6_expert1&#45;&gt;L6_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M62166.63,-604.22C62166.63,-588.37 62166.63,-573 62166.63,-573 62166.63,-573 57773.51,-573 57773.51,-573 57773.51,-573 57773.51,-568.63 57773.51,-568.63"/>
<polygon fill="black" stroke="black" points="57777.01,-568.63 57773.51,-558.63 57770.01,-568.63 57777.01,-568.63"/>
</g>
<!-- L6_S0_TP6_GPU6_expert1&#45;&gt;L6_S0_TP2_GPU2_moe_ar -->
<g id="edge1831" class="edge">
<title>L6_S0_TP6_GPU6_expert1&#45;&gt;L6_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M62483.82,-604.28C62483.82,-552.7 62483.82,-461 62483.82,-461 62483.82,-461 58945.28,-461 58945.28,-461 58945.28,-461 58945.28,-483.84 58945.28,-483.84"/>
<polygon fill="black" stroke="black" points="58941.78,-483.84 58945.28,-493.84 58948.78,-483.84 58941.78,-483.84"/>
</g>
<!-- L6_S0_TP6_GPU6_expert1&#45;&gt;L6_S0_TP3_GPU3_moe_ar -->
<g id="edge1867" class="edge">
<title>L6_S0_TP6_GPU6_expert1&#45;&gt;L6_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M62459.14,-604.28C62459.14,-552.7 62459.14,-461 62459.14,-461 62459.14,-461 59572.92,-461 59572.92,-461 59572.92,-461 59572.92,-474.14 59572.92,-474.14"/>
<polygon fill="black" stroke="black" points="59569.42,-474.14 59572.92,-484.14 59576.42,-474.14 59569.42,-474.14"/>
</g>
<!-- L6_S0_TP6_GPU6_expert1&#45;&gt;L6_S0_TP4_GPU4_moe_ar -->
<g id="edge1903" class="edge">
<title>L6_S0_TP6_GPU6_expert1&#45;&gt;L6_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M62220.2,-604.47C62220.2,-588.11 62220.2,-572 62220.2,-572 62220.2,-572 60350.72,-572 60350.72,-572 60350.72,-572 60350.72,-547.88 60350.72,-547.88"/>
<polygon fill="black" stroke="black" points="60354.22,-547.88 60350.72,-537.88 60347.22,-547.88 60354.22,-547.88"/>
</g>
<!-- L6_S0_TP6_GPU6_expert1&#45;&gt;L6_S0_TP5_GPU5_moe_ar -->
<g id="edge1939" class="edge">
<title>L6_S0_TP6_GPU6_expert1&#45;&gt;L6_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M62273.76,-604.47C62273.76,-588.11 62273.76,-572 62273.76,-572 62273.76,-572 60971.14,-572 60971.14,-572 60971.14,-572 60971.14,-563.38 60971.14,-563.38"/>
<polygon fill="black" stroke="black" points="60974.64,-563.38 60971.14,-553.38 60967.64,-563.38 60974.64,-563.38"/>
</g>
<!-- L6_S0_TP6_GPU6_expert1&#45;&gt;L6_S0_TP6_GPU6_moe_ar -->
<g id="edge1975" class="edge">
<title>L6_S0_TP6_GPU6_expert1&#45;&gt;L6_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M62327.33,-604.47C62327.33,-588.11 62327.33,-572 62327.33,-572 62327.33,-572 61695.81,-572 61695.81,-572 61695.81,-572 61695.81,-556.21 61695.81,-556.21"/>
<polygon fill="black" stroke="black" points="61699.31,-556.21 61695.81,-546.21 61692.31,-556.21 61699.31,-556.21"/>
</g>
<!-- L6_S0_TP6_GPU6_expert1&#45;&gt;L6_S0_TP7_GPU7_moe_ar -->
<g id="edge2011" class="edge">
<title>L6_S0_TP6_GPU6_expert1&#45;&gt;L6_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M62380.9,-604.34C62380.9,-604.34 62380.9,-556.62 62380.9,-556.62"/>
<polygon fill="black" stroke="black" points="62384.4,-556.62 62380.9,-546.62 62377.4,-556.62 62384.4,-556.62"/>
</g>
<!-- L6_S0_TP7_GPU7_expert0 -->
<g id="node656" class="node">
<title>L6_S0_TP7_GPU7_expert0</title>
<polygon fill="none" stroke="black" points="62975.5,-672.5 62526.5,-672.5 62526.5,-604.5 62975.5,-604.5 62975.5,-672.5"/>
<text text-anchor="middle" x="62751" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="62751" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="62751" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="62751" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L6_S0_TP7_GPU7_expert0&#45;&gt;L6_S0_TP0_GPU0_moe_ar -->
<g id="edge1760" class="edge">
<title>L6_S0_TP7_GPU7_expert0&#45;&gt;L6_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M62802.69,-672.84C62802.69,-690.35 62802.69,-708 62802.69,-708 62802.69,-708 57375.1,-708 57375.1,-708 57375.1,-708 57375.1,-577.27 57375.1,-577.27"/>
<polygon fill="black" stroke="black" points="57378.6,-577.27 57375.1,-567.27 57371.6,-577.27 57378.6,-577.27"/>
</g>
<!-- L6_S0_TP7_GPU7_expert0&#45;&gt;L6_S0_TP1_GPU1_moe_ar -->
<g id="edge1796" class="edge">
<title>L6_S0_TP7_GPU7_expert0&#45;&gt;L6_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M62911.36,-604.45C62911.36,-548.43 62911.36,-443 62911.36,-443 62911.36,-443 57997.73,-443 57997.73,-443 57997.73,-443 57997.73,-462.27 57997.73,-462.27"/>
<polygon fill="black" stroke="black" points="57994.23,-462.27 57997.73,-472.27 58001.23,-462.27 57994.23,-462.27"/>
</g>
<!-- L6_S0_TP7_GPU7_expert0&#45;&gt;L6_S0_TP2_GPU2_moe_ar -->
<g id="edge1832" class="edge">
<title>L6_S0_TP7_GPU7_expert0&#45;&gt;L6_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M62847.21,-604.28C62847.21,-552.7 62847.21,-461 62847.21,-461 62847.21,-461 58918.18,-461 58918.18,-461 58918.18,-461 58918.18,-478.97 58918.18,-478.97"/>
<polygon fill="black" stroke="black" points="58914.68,-478.97 58918.18,-488.97 58921.68,-478.97 58914.68,-478.97"/>
</g>
<!-- L6_S0_TP7_GPU7_expert0&#45;&gt;L6_S0_TP3_GPU3_moe_ar -->
<g id="edge1868" class="edge">
<title>L6_S0_TP7_GPU7_expert0&#45;&gt;L6_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M62783.07,-604.28C62783.07,-552.7 62783.07,-461 62783.07,-461 62783.07,-461 59461.85,-461 59461.85,-461 59461.85,-461 59461.85,-464.78 59461.85,-464.78"/>
<polygon fill="black" stroke="black" points="59458.35,-464.78 59461.85,-474.78 59465.35,-464.78 59458.35,-464.78"/>
</g>
<!-- L6_S0_TP7_GPU7_expert0&#45;&gt;L6_S0_TP4_GPU4_moe_ar -->
<g id="edge1904" class="edge">
<title>L6_S0_TP7_GPU7_expert0&#45;&gt;L6_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M62664.59,-672.85C62664.59,-687.81 62664.59,-702 62664.59,-702 62664.59,-702 60185.5,-702 60185.5,-702 60185.5,-702 60185.5,-573.91 60185.5,-573.91"/>
<polygon fill="black" stroke="black" points="60189,-573.91 60185.5,-563.91 60182,-573.91 60189,-573.91"/>
</g>
<!-- L6_S0_TP7_GPU7_expert0&#45;&gt;L6_S0_TP5_GPU5_moe_ar -->
<g id="edge1940" class="edge">
<title>L6_S0_TP7_GPU7_expert0&#45;&gt;L6_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M62590.64,-604.47C62590.64,-588.11 62590.64,-572 62590.64,-572 62590.64,-572 61015.8,-572 61015.8,-572 61015.8,-572 61015.8,-554.7 61015.8,-554.7"/>
<polygon fill="black" stroke="black" points="61019.3,-554.7 61015.8,-544.7 61012.3,-554.7 61019.3,-554.7"/>
</g>
<!-- L6_S0_TP7_GPU7_expert0&#45;&gt;L6_S0_TP6_GPU6_moe_ar -->
<g id="edge1976" class="edge">
<title>L6_S0_TP7_GPU7_expert0&#45;&gt;L6_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M62654.79,-604.47C62654.79,-588.11 62654.79,-572 62654.79,-572 62654.79,-572 61713.03,-572 61713.03,-572 61713.03,-572 61713.03,-551.7 61713.03,-551.7"/>
<polygon fill="black" stroke="black" points="61716.53,-551.7 61713.03,-541.7 61709.53,-551.7 61716.53,-551.7"/>
</g>
<!-- L6_S0_TP7_GPU7_expert0&#45;&gt;L6_S0_TP7_GPU7_moe_ar -->
<g id="edge2012" class="edge">
<title>L6_S0_TP7_GPU7_expert0&#45;&gt;L6_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M62718.93,-604.31C62718.93,-580.13 62718.93,-552 62718.93,-552 62718.93,-552 62362.63,-552 62362.63,-552"/>
<polygon fill="black" stroke="black" points="62362.63,-548.5 62352.63,-552 62362.63,-555.5 62362.63,-548.5"/>
</g>
<!-- L6_S0_TP7_GPU7_expert1 -->
<g id="node657" class="node">
<title>L6_S0_TP7_GPU7_expert1</title>
<polygon fill="none" stroke="black" points="63442.5,-672.5 62993.5,-672.5 62993.5,-604.5 63442.5,-604.5 63442.5,-672.5"/>
<text text-anchor="middle" x="63218" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="63218" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="63218" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="63218" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L6_S0_TP7_GPU7_expert1&#45;&gt;L6_S0_TP0_GPU0_moe_ar -->
<g id="edge1761" class="edge">
<title>L6_S0_TP7_GPU7_expert1&#45;&gt;L6_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M63193.44,-604.45C63193.44,-548.43 63193.44,-443 63193.44,-443 63193.44,-443 57320.49,-443 57320.49,-443 57320.49,-443 57320.49,-462.27 57320.49,-462.27"/>
<polygon fill="black" stroke="black" points="57316.99,-462.27 57320.49,-472.27 57323.99,-462.27 57316.99,-462.27"/>
</g>
<!-- L6_S0_TP7_GPU7_expert1&#45;&gt;L6_S0_TP1_GPU1_moe_ar -->
<g id="edge1797" class="edge">
<title>L6_S0_TP7_GPU7_expert1&#45;&gt;L6_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M63164.88,-604.45C63164.88,-548.43 63164.88,-443 63164.88,-443 63164.88,-443 57840.37,-443 57840.37,-443 57840.37,-443 57840.37,-466.28 57840.37,-466.28"/>
<polygon fill="black" stroke="black" points="57836.87,-466.28 57840.37,-476.28 57843.87,-466.28 57836.87,-466.28"/>
</g>
<!-- L6_S0_TP7_GPU7_expert1&#45;&gt;L6_S0_TP2_GPU2_moe_ar -->
<g id="edge1833" class="edge">
<title>L6_S0_TP7_GPU7_expert1&#45;&gt;L6_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M63136.31,-604.28C63136.31,-552.7 63136.31,-461 63136.31,-461 63136.31,-461 58891.09,-461 58891.09,-461 58891.09,-461 58891.09,-474.82 58891.09,-474.82"/>
<polygon fill="black" stroke="black" points="58887.59,-474.82 58891.09,-484.82 58894.59,-474.82 58887.59,-474.82"/>
</g>
<!-- L6_S0_TP7_GPU7_expert1&#45;&gt;L6_S0_TP3_GPU3_moe_ar -->
<g id="edge1869" class="edge">
<title>L6_S0_TP7_GPU7_expert1&#45;&gt;L6_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M63107.75,-604.28C63107.75,-552.7 63107.75,-461 63107.75,-461 63107.75,-461 59350.77,-461 59350.77,-461 59350.77,-461 59350.77,-462.18 59350.77,-462.18"/>
<polygon fill="black" stroke="black" points="59347.27,-462.18 59350.77,-472.18 59354.27,-462.18 59347.27,-462.18"/>
</g>
<!-- L6_S0_TP7_GPU7_expert1&#45;&gt;L6_S0_TP4_GPU4_moe_ar -->
<g id="edge1905" class="edge">
<title>L6_S0_TP7_GPU7_expert1&#45;&gt;L6_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M63143.17,-672.78C63143.17,-688.63 63143.17,-704 63143.17,-704 63143.17,-704 60179.5,-704 60179.5,-704 60179.5,-704 60179.5,-574.39 60179.5,-574.39"/>
<polygon fill="black" stroke="black" points="60183,-574.39 60179.5,-564.39 60176,-574.39 60183,-574.39"/>
</g>
<!-- L6_S0_TP7_GPU7_expert1&#45;&gt;L6_S0_TP5_GPU5_moe_ar -->
<g id="edge1941" class="edge">
<title>L6_S0_TP7_GPU7_expert1&#45;&gt;L6_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M63079.19,-604.28C63079.19,-552.7 63079.19,-461 63079.19,-461 63079.19,-461 60744.15,-461 60744.15,-461 60744.15,-461 60744.15,-462.18 60744.15,-462.18"/>
<polygon fill="black" stroke="black" points="60740.65,-462.18 60744.15,-472.18 60747.65,-462.18 60740.65,-462.18"/>
</g>
<!-- L6_S0_TP7_GPU7_expert1&#45;&gt;L6_S0_TP6_GPU6_moe_ar -->
<g id="edge1977" class="edge">
<title>L6_S0_TP7_GPU7_expert1&#45;&gt;L6_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M63022.06,-604.47C63022.06,-588.11 63022.06,-572 63022.06,-572 63022.06,-572 61730.24,-572 61730.24,-572 61730.24,-572 61730.24,-545.89 61730.24,-545.89"/>
<polygon fill="black" stroke="black" points="61733.74,-545.89 61730.24,-535.89 61726.74,-545.89 61733.74,-545.89"/>
</g>
<!-- L6_S0_TP7_GPU7_expert1&#45;&gt;L6_S0_TP7_GPU7_moe_ar -->
<g id="edge2013" class="edge">
<title>L6_S0_TP7_GPU7_expert1&#45;&gt;L6_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M63050.62,-604.37C63050.62,-574.55 63050.62,-536 63050.62,-536 63050.62,-536 62426.54,-536 62426.54,-536"/>
<polygon fill="black" stroke="black" points="62426.54,-532.5 62416.54,-536 62426.54,-539.5 62426.54,-532.5"/>
</g>
<!-- L6_S0_TP0_GPU0_norm -->
<g id="node659" class="node">
<title>L6_S0_TP0_GPU0_norm</title>
<polygon fill="none" stroke="black" points="55834.5,-332.33 55385.5,-332.33 55385.5,-264.33 55834.5,-264.33 55834.5,-332.33"/>
<text text-anchor="middle" x="55610" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="55610" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="55610" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="55610" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP0_GPU0_moe_res&#45;&gt;L6_S0_TP0_GPU0_norm -->
<g id="edge1764" class="edge">
<title>L6_S0_TP0_GPU0_moe_res&#45;&gt;L6_S0_TP0_GPU0_norm</title>
<path fill="none" stroke="black" d="M55610,-368.28C55610,-368.28 55610,-342.46 55610,-342.46"/>
<polygon fill="black" stroke="black" points="55613.5,-342.46 55610,-332.46 55606.5,-342.46 55613.5,-342.46"/>
</g>
<!-- L6_S0_TP1_GPU1_qkv_linear -->
<g id="node660" class="node">
<title>L6_S0_TP1_GPU1_qkv_linear</title>
<polygon fill="none" stroke="black" points="57528,-1614.75 56920,-1614.75 56920,-1546.75 57528,-1546.75 57528,-1614.75"/>
<text text-anchor="middle" x="57224" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="57224" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="57224" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="57224" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L6_S0_TP1_GPU1_qkv_slice -->
<g id="node661" class="node">
<title>L6_S0_TP1_GPU1_qkv_slice</title>
<polygon fill="none" stroke="black" points="57522,-1496.67 56926,-1496.67 56926,-1428.67 57522,-1428.67 57522,-1496.67"/>
<text text-anchor="middle" x="57224" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="57224" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="57224" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="57224" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L6_S0_TP1_GPU1_qkv_linear&#45;&gt;L6_S0_TP1_GPU1_qkv_slice -->
<g id="edge1765" class="edge">
<title>L6_S0_TP1_GPU1_qkv_linear&#45;&gt;L6_S0_TP1_GPU1_qkv_slice</title>
<path fill="none" stroke="black" d="M57224,-1546.59C57224,-1546.59 57224,-1506.74 57224,-1506.74"/>
<polygon fill="black" stroke="black" points="57227.5,-1506.74 57224,-1496.74 57220.5,-1506.74 57227.5,-1506.74"/>
</g>
<!-- L6_S0_TP1_GPU1_qkv_slice&#45;&gt;L6_S0_TP1_GPU1_attn_v -->
<g id="edge1769" class="edge">
<title>L6_S0_TP1_GPU1_qkv_slice&#45;&gt;L6_S0_TP1_GPU1_attn_v</title>
<path fill="none" stroke="black" d="M56925.91,-1462C56900.51,-1462 56884.25,-1462 56884.25,-1462 56884.25,-1462 56884.25,-1194.87 56884.25,-1194.87"/>
<polygon fill="black" stroke="black" points="56887.75,-1194.87 56884.25,-1184.87 56880.75,-1194.87 56887.75,-1194.87"/>
</g>
<!-- L6_S0_TP1_GPU1_qk_matmul -->
<g id="node662" class="node">
<title>L6_S0_TP1_GPU1_qk_matmul</title>
<polygon fill="none" stroke="black" points="57846.5,-1392.67 56911.5,-1392.67 56911.5,-1324.67 57846.5,-1324.67 57846.5,-1392.67"/>
<text text-anchor="middle" x="57379" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="57379" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="57379" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="57379" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L6_S0_TP1_GPU1_qkv_slice&#45;&gt;L6_S0_TP1_GPU1_qk_matmul -->
<g id="edge1766" class="edge">
<title>L6_S0_TP1_GPU1_qkv_slice&#45;&gt;L6_S0_TP1_GPU1_qk_matmul</title>
<path fill="none" stroke="black" d="M57224,-1428.61C57224,-1428.61 57224,-1402.8 57224,-1402.8"/>
<polygon fill="black" stroke="black" points="57227.5,-1402.8 57224,-1392.8 57220.5,-1402.8 57227.5,-1402.8"/>
</g>
<!-- L6_S0_TP1_GPU1_softmax -->
<g id="node663" class="node">
<title>L6_S0_TP1_GPU1_softmax</title>
<polygon fill="none" stroke="black" points="57607,-1288.67 57097,-1288.67 57097,-1220.67 57607,-1220.67 57607,-1288.67"/>
<text text-anchor="middle" x="57352" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="57352" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="57352" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="57352" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L6_S0_TP1_GPU1_qk_matmul&#45;&gt;L6_S0_TP1_GPU1_softmax -->
<g id="edge1767" class="edge">
<title>L6_S0_TP1_GPU1_qk_matmul&#45;&gt;L6_S0_TP1_GPU1_softmax</title>
<path fill="none" stroke="black" d="M57352,-1324.61C57352,-1324.61 57352,-1298.8 57352,-1298.8"/>
<polygon fill="black" stroke="black" points="57355.5,-1298.8 57352,-1288.8 57348.5,-1298.8 57355.5,-1298.8"/>
</g>
<!-- L6_S0_TP1_GPU1_softmax&#45;&gt;L6_S0_TP1_GPU1_attn_v -->
<g id="edge1768" class="edge">
<title>L6_S0_TP1_GPU1_softmax&#45;&gt;L6_S0_TP1_GPU1_attn_v</title>
<path fill="none" stroke="black" d="M57352,-1220.61C57352,-1220.61 57352,-1194.8 57352,-1194.8"/>
<polygon fill="black" stroke="black" points="57355.5,-1194.8 57352,-1184.8 57348.5,-1194.8 57355.5,-1194.8"/>
</g>
<!-- L6_S0_TP1_GPU1_mha_res -->
<g id="node665" class="node">
<title>L6_S0_TP1_GPU1_mha_res</title>
<polygon fill="none" stroke="black" points="57464.5,-948.5 56577.5,-948.5 56577.5,-880.5 57464.5,-880.5 57464.5,-948.5"/>
<text text-anchor="middle" x="57021" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="57021" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="57021" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="57021" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP1_GPU1_mha_ar&#45;&gt;L6_S0_TP1_GPU1_mha_res -->
<g id="edge1778" class="edge">
<title>L6_S0_TP1_GPU1_mha_ar&#45;&gt;L6_S0_TP1_GPU1_mha_res</title>
<path fill="none" stroke="black" d="M57441.01,-1015.66C57441.01,-1015.66 57441.01,-958.91 57441.01,-958.91"/>
<polygon fill="black" stroke="black" points="57444.51,-958.91 57441.01,-948.91 57437.51,-958.91 57444.51,-958.91"/>
</g>
<!-- L6_S0_TP1_GPU1_gate -->
<g id="node666" class="node">
<title>L6_S0_TP1_GPU1_gate</title>
<polygon fill="none" stroke="black" points="57550.56,-844.5 56708.15,-844.5 56491.44,-708.5 57333.85,-708.5 57550.56,-844.5"/>
<text text-anchor="middle" x="57021" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="57021" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="57021" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="57021" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L6_S0_TP1_GPU1_mha_res&#45;&gt;L6_S0_TP1_GPU1_gate -->
<g id="edge1779" class="edge">
<title>L6_S0_TP1_GPU1_mha_res&#45;&gt;L6_S0_TP1_GPU1_gate</title>
<path fill="none" stroke="black" d="M57021,-880.39C57021,-880.39 57021,-854.73 57021,-854.73"/>
<polygon fill="black" stroke="black" points="57024.5,-854.73 57021,-844.73 57017.5,-854.73 57024.5,-854.73"/>
</g>
<!-- L6_S0_TP1_GPU1_moe_res -->
<g id="node668" class="node">
<title>L6_S0_TP1_GPU1_moe_res</title>
<polygon fill="none" stroke="black" points="57168,-436.33 56348,-436.33 56348,-368.33 57168,-368.33 57168,-436.33"/>
<text text-anchor="middle" x="56758" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="56758" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="56758" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="56758" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP1_GPU1_mha_res&#45;&gt;L6_S0_TP1_GPU1_moe_res -->
<g id="edge1799" class="edge">
<title>L6_S0_TP1_GPU1_mha_res&#45;&gt;L6_S0_TP1_GPU1_moe_res</title>
<path fill="none" stroke="black" d="M56577.43,-914C56520.73,-914 56482,-914 56482,-914 56482,-914 56482,-682 56482,-682 56482,-682 56446.5,-682 56446.5,-682 56446.5,-682 56446.5,-446.35 56446.5,-446.35"/>
<polygon fill="black" stroke="black" points="56450,-446.35 56446.5,-436.35 56443,-446.35 56450,-446.35"/>
</g>
<!-- L6_S0_TP1_GPU1_gate&#45;&gt;L6_S0_TP1_GPU1_expert0 -->
<g id="edge1780" class="edge">
<title>L6_S0_TP1_GPU1_gate&#45;&gt;L6_S0_TP1_GPU1_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M57147,-708.31C57147,-708.31 57147,-682.71 57147,-682.71"/>
<polygon fill="black" stroke="black" points="57150.5,-682.71 57147,-672.71 57143.5,-682.71 57150.5,-682.71"/>
</g>
<!-- L6_S0_TP1_GPU1_gate&#45;&gt;L6_S0_TP1_GPU1_expert1 -->
<g id="edge1781" class="edge">
<title>L6_S0_TP1_GPU1_gate&#45;&gt;L6_S0_TP1_GPU1_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M57470.14,-776.4C57470.14,-776.4 57470.14,-682.74 57470.14,-682.74"/>
<polygon fill="black" stroke="black" points="57473.64,-682.74 57470.14,-672.74 57466.64,-682.74 57473.64,-682.74"/>
</g>
<!-- L6_S0_TP1_GPU1_moe_ar&#45;&gt;L6_S0_TP1_GPU1_moe_res -->
<g id="edge1798" class="edge">
<title>L6_S0_TP1_GPU1_moe_ar&#45;&gt;L6_S0_TP1_GPU1_moe_res</title>
<path fill="none" stroke="black" d="M57663.27,-503.95C57663.27,-471.41 57663.27,-402 57663.27,-402 57663.27,-402 57178.26,-402 57178.26,-402"/>
<polygon fill="black" stroke="black" points="57178.26,-398.5 57168.26,-402 57178.26,-405.5 57178.26,-398.5"/>
</g>
<!-- L6_S0_TP1_GPU1_norm -->
<g id="node669" class="node">
<title>L6_S0_TP1_GPU1_norm</title>
<polygon fill="none" stroke="black" points="56982.5,-332.33 56533.5,-332.33 56533.5,-264.33 56982.5,-264.33 56982.5,-332.33"/>
<text text-anchor="middle" x="56758" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="56758" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="56758" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="56758" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP1_GPU1_moe_res&#45;&gt;L6_S0_TP1_GPU1_norm -->
<g id="edge1800" class="edge">
<title>L6_S0_TP1_GPU1_moe_res&#45;&gt;L6_S0_TP1_GPU1_norm</title>
<path fill="none" stroke="black" d="M56758,-368.28C56758,-368.28 56758,-342.46 56758,-342.46"/>
<polygon fill="black" stroke="black" points="56761.5,-342.46 56758,-332.46 56754.5,-342.46 56761.5,-342.46"/>
</g>
<!-- L6_S0_TP2_GPU2_qkv_linear -->
<g id="node670" class="node">
<title>L6_S0_TP2_GPU2_qkv_linear</title>
<polygon fill="none" stroke="black" points="58341,-1614.75 57733,-1614.75 57733,-1546.75 58341,-1546.75 58341,-1614.75"/>
<text text-anchor="middle" x="58037" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="58037" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="58037" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="58037" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L6_S0_TP2_GPU2_qkv_slice -->
<g id="node671" class="node">
<title>L6_S0_TP2_GPU2_qkv_slice</title>
<polygon fill="none" stroke="black" points="58335,-1496.67 57739,-1496.67 57739,-1428.67 58335,-1428.67 58335,-1496.67"/>
<text text-anchor="middle" x="58037" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="58037" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="58037" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="58037" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L6_S0_TP2_GPU2_qkv_linear&#45;&gt;L6_S0_TP2_GPU2_qkv_slice -->
<g id="edge1801" class="edge">
<title>L6_S0_TP2_GPU2_qkv_linear&#45;&gt;L6_S0_TP2_GPU2_qkv_slice</title>
<path fill="none" stroke="black" d="M58037,-1546.59C58037,-1546.59 58037,-1506.74 58037,-1506.74"/>
<polygon fill="black" stroke="black" points="58040.5,-1506.74 58037,-1496.74 58033.5,-1506.74 58040.5,-1506.74"/>
</g>
<!-- L6_S0_TP2_GPU2_qkv_slice&#45;&gt;L6_S0_TP2_GPU2_attn_v -->
<g id="edge1805" class="edge">
<title>L6_S0_TP2_GPU2_qkv_slice&#45;&gt;L6_S0_TP2_GPU2_attn_v</title>
<path fill="none" stroke="black" d="M57879,-1428.38C57879,-1428.38 57879,-1195 57879,-1195"/>
<polygon fill="black" stroke="black" points="57882.5,-1195 57879,-1185 57875.5,-1195 57882.5,-1195"/>
</g>
<!-- L6_S0_TP2_GPU2_qk_matmul -->
<g id="node672" class="node">
<title>L6_S0_TP2_GPU2_qk_matmul</title>
<polygon fill="none" stroke="black" points="58846.5,-1392.67 57911.5,-1392.67 57911.5,-1324.67 58846.5,-1324.67 58846.5,-1392.67"/>
<text text-anchor="middle" x="58379" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="58379" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="58379" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="58379" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L6_S0_TP2_GPU2_qkv_slice&#45;&gt;L6_S0_TP2_GPU2_qk_matmul -->
<g id="edge1802" class="edge">
<title>L6_S0_TP2_GPU2_qkv_slice&#45;&gt;L6_S0_TP2_GPU2_qk_matmul</title>
<path fill="none" stroke="black" d="M58123.25,-1428.61C58123.25,-1428.61 58123.25,-1402.8 58123.25,-1402.8"/>
<polygon fill="black" stroke="black" points="58126.75,-1402.8 58123.25,-1392.8 58119.75,-1402.8 58126.75,-1402.8"/>
</g>
<!-- L6_S0_TP2_GPU2_softmax -->
<g id="node673" class="node">
<title>L6_S0_TP2_GPU2_softmax</title>
<polygon fill="none" stroke="black" points="58585,-1288.67 58075,-1288.67 58075,-1220.67 58585,-1220.67 58585,-1288.67"/>
<text text-anchor="middle" x="58330" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="58330" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="58330" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="58330" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L6_S0_TP2_GPU2_qk_matmul&#45;&gt;L6_S0_TP2_GPU2_softmax -->
<g id="edge1803" class="edge">
<title>L6_S0_TP2_GPU2_qk_matmul&#45;&gt;L6_S0_TP2_GPU2_softmax</title>
<path fill="none" stroke="black" d="M58330,-1324.61C58330,-1324.61 58330,-1298.8 58330,-1298.8"/>
<polygon fill="black" stroke="black" points="58333.5,-1298.8 58330,-1288.8 58326.5,-1298.8 58333.5,-1298.8"/>
</g>
<!-- L6_S0_TP2_GPU2_softmax&#45;&gt;L6_S0_TP2_GPU2_attn_v -->
<g id="edge1804" class="edge">
<title>L6_S0_TP2_GPU2_softmax&#45;&gt;L6_S0_TP2_GPU2_attn_v</title>
<path fill="none" stroke="black" d="M58330,-1220.61C58330,-1220.61 58330,-1194.8 58330,-1194.8"/>
<polygon fill="black" stroke="black" points="58333.5,-1194.8 58330,-1184.8 58326.5,-1194.8 58333.5,-1194.8"/>
</g>
<!-- L6_S0_TP2_GPU2_mha_res -->
<g id="node675" class="node">
<title>L6_S0_TP2_GPU2_mha_res</title>
<polygon fill="none" stroke="black" points="58542.5,-948.5 57655.5,-948.5 57655.5,-880.5 58542.5,-880.5 58542.5,-948.5"/>
<text text-anchor="middle" x="58099" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="58099" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="58099" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="58099" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP2_GPU2_mha_ar&#45;&gt;L6_S0_TP2_GPU2_mha_res -->
<g id="edge1814" class="edge">
<title>L6_S0_TP2_GPU2_mha_ar&#45;&gt;L6_S0_TP2_GPU2_mha_res</title>
<path fill="none" stroke="black" d="M58364.51,-991.61C58364.51,-991.61 58364.51,-958.74 58364.51,-958.74"/>
<polygon fill="black" stroke="black" points="58368.01,-958.74 58364.51,-948.74 58361.01,-958.74 58368.01,-958.74"/>
</g>
<!-- L6_S0_TP2_GPU2_gate -->
<g id="node676" class="node">
<title>L6_S0_TP2_GPU2_gate</title>
<polygon fill="none" stroke="black" points="58628.56,-844.5 57786.15,-844.5 57569.44,-708.5 58411.85,-708.5 58628.56,-844.5"/>
<text text-anchor="middle" x="58099" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="58099" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="58099" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="58099" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L6_S0_TP2_GPU2_mha_res&#45;&gt;L6_S0_TP2_GPU2_gate -->
<g id="edge1815" class="edge">
<title>L6_S0_TP2_GPU2_mha_res&#45;&gt;L6_S0_TP2_GPU2_gate</title>
<path fill="none" stroke="black" d="M58099,-880.39C58099,-880.39 58099,-854.73 58099,-854.73"/>
<polygon fill="black" stroke="black" points="58102.5,-854.73 58099,-844.73 58095.5,-854.73 58102.5,-854.73"/>
</g>
<!-- L6_S0_TP2_GPU2_moe_res -->
<g id="node678" class="node">
<title>L6_S0_TP2_GPU2_moe_res</title>
<polygon fill="none" stroke="black" points="58503,-436.33 57683,-436.33 57683,-368.33 58503,-368.33 58503,-436.33"/>
<text text-anchor="middle" x="58093" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="58093" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="58093" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="58093" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP2_GPU2_mha_res&#45;&gt;L6_S0_TP2_GPU2_moe_res -->
<g id="edge1835" class="edge">
<title>L6_S0_TP2_GPU2_mha_res&#45;&gt;L6_S0_TP2_GPU2_moe_res</title>
<path fill="none" stroke="black" d="M58542.57,-914C58599.27,-914 58638,-914 58638,-914 58638,-914 58638,-672 58638,-672 58638,-672 58319.82,-672 58319.82,-672 58319.82,-672 58319.82,-446.49 58319.82,-446.49"/>
<polygon fill="black" stroke="black" points="58323.32,-446.49 58319.82,-436.49 58316.32,-446.49 58323.32,-446.49"/>
</g>
<!-- L6_S0_TP2_GPU2_gate&#45;&gt;L6_S0_TP2_GPU2_expert0 -->
<g id="edge1816" class="edge">
<title>L6_S0_TP2_GPU2_gate&#45;&gt;L6_S0_TP2_GPU2_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M57931.33,-708.31C57931.33,-708.31 57931.33,-682.71 57931.33,-682.71"/>
<polygon fill="black" stroke="black" points="57934.83,-682.71 57931.33,-672.71 57927.83,-682.71 57934.83,-682.71"/>
</g>
<!-- L6_S0_TP2_GPU2_gate&#45;&gt;L6_S0_TP2_GPU2_expert1 -->
<g id="edge1817" class="edge">
<title>L6_S0_TP2_GPU2_gate&#45;&gt;L6_S0_TP2_GPU2_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58476.14,-748.57C58476.14,-748.57 58476.14,-682.74 58476.14,-682.74"/>
<polygon fill="black" stroke="black" points="58479.64,-682.74 58476.14,-672.74 58472.64,-682.74 58479.64,-682.74"/>
</g>
<!-- L6_S0_TP2_GPU2_moe_ar&#45;&gt;L6_S0_TP2_GPU2_moe_res -->
<g id="edge1834" class="edge">
<title>L6_S0_TP2_GPU2_moe_ar&#45;&gt;L6_S0_TP2_GPU2_moe_res</title>
<path fill="none" stroke="black" d="M58416.77,-488.15C58416.77,-488.15 58416.77,-446.63 58416.77,-446.63"/>
<polygon fill="black" stroke="black" points="58420.27,-446.63 58416.77,-436.63 58413.27,-446.63 58420.27,-446.63"/>
</g>
<!-- L6_S0_TP2_GPU2_norm -->
<g id="node679" class="node">
<title>L6_S0_TP2_GPU2_norm</title>
<polygon fill="none" stroke="black" points="58317.5,-332.33 57868.5,-332.33 57868.5,-264.33 58317.5,-264.33 58317.5,-332.33"/>
<text text-anchor="middle" x="58093" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="58093" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="58093" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="58093" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP2_GPU2_moe_res&#45;&gt;L6_S0_TP2_GPU2_norm -->
<g id="edge1836" class="edge">
<title>L6_S0_TP2_GPU2_moe_res&#45;&gt;L6_S0_TP2_GPU2_norm</title>
<path fill="none" stroke="black" d="M58093,-368.28C58093,-368.28 58093,-342.46 58093,-342.46"/>
<polygon fill="black" stroke="black" points="58096.5,-342.46 58093,-332.46 58089.5,-342.46 58096.5,-342.46"/>
</g>
<!-- L6_S0_TP3_GPU3_qkv_linear -->
<g id="node680" class="node">
<title>L6_S0_TP3_GPU3_qkv_linear</title>
<polygon fill="none" stroke="black" points="59431,-1614.75 58823,-1614.75 58823,-1546.75 59431,-1546.75 59431,-1614.75"/>
<text text-anchor="middle" x="59127" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="59127" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="59127" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="59127" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L6_S0_TP3_GPU3_qkv_slice -->
<g id="node681" class="node">
<title>L6_S0_TP3_GPU3_qkv_slice</title>
<polygon fill="none" stroke="black" points="59425,-1496.67 58829,-1496.67 58829,-1428.67 59425,-1428.67 59425,-1496.67"/>
<text text-anchor="middle" x="59127" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="59127" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="59127" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="59127" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L6_S0_TP3_GPU3_qkv_linear&#45;&gt;L6_S0_TP3_GPU3_qkv_slice -->
<g id="edge1837" class="edge">
<title>L6_S0_TP3_GPU3_qkv_linear&#45;&gt;L6_S0_TP3_GPU3_qkv_slice</title>
<path fill="none" stroke="black" d="M59127,-1546.59C59127,-1546.59 59127,-1506.74 59127,-1506.74"/>
<polygon fill="black" stroke="black" points="59130.5,-1506.74 59127,-1496.74 59123.5,-1506.74 59130.5,-1506.74"/>
</g>
<!-- L6_S0_TP3_GPU3_qkv_slice&#45;&gt;L6_S0_TP3_GPU3_attn_v -->
<g id="edge1841" class="edge">
<title>L6_S0_TP3_GPU3_qkv_slice&#45;&gt;L6_S0_TP3_GPU3_attn_v</title>
<path fill="none" stroke="black" d="M58877,-1428.38C58877,-1428.38 58877,-1195 58877,-1195"/>
<polygon fill="black" stroke="black" points="58880.5,-1195 58877,-1185 58873.5,-1195 58880.5,-1195"/>
</g>
<!-- L6_S0_TP3_GPU3_qk_matmul -->
<g id="node682" class="node">
<title>L6_S0_TP3_GPU3_qk_matmul</title>
<polygon fill="none" stroke="black" points="59842.5,-1392.67 58907.5,-1392.67 58907.5,-1324.67 59842.5,-1324.67 59842.5,-1392.67"/>
<text text-anchor="middle" x="59375" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="59375" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="59375" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="59375" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L6_S0_TP3_GPU3_qkv_slice&#45;&gt;L6_S0_TP3_GPU3_qk_matmul -->
<g id="edge1838" class="edge">
<title>L6_S0_TP3_GPU3_qkv_slice&#45;&gt;L6_S0_TP3_GPU3_qk_matmul</title>
<path fill="none" stroke="black" d="M59166.25,-1428.61C59166.25,-1428.61 59166.25,-1402.8 59166.25,-1402.8"/>
<polygon fill="black" stroke="black" points="59169.75,-1402.8 59166.25,-1392.8 59162.75,-1402.8 59169.75,-1402.8"/>
</g>
<!-- L6_S0_TP3_GPU3_softmax -->
<g id="node683" class="node">
<title>L6_S0_TP3_GPU3_softmax</title>
<polygon fill="none" stroke="black" points="59561,-1288.67 59051,-1288.67 59051,-1220.67 59561,-1220.67 59561,-1288.67"/>
<text text-anchor="middle" x="59306" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="59306" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="59306" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="59306" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L6_S0_TP3_GPU3_qk_matmul&#45;&gt;L6_S0_TP3_GPU3_softmax -->
<g id="edge1839" class="edge">
<title>L6_S0_TP3_GPU3_qk_matmul&#45;&gt;L6_S0_TP3_GPU3_softmax</title>
<path fill="none" stroke="black" d="M59306,-1324.61C59306,-1324.61 59306,-1298.8 59306,-1298.8"/>
<polygon fill="black" stroke="black" points="59309.5,-1298.8 59306,-1288.8 59302.5,-1298.8 59309.5,-1298.8"/>
</g>
<!-- L6_S0_TP3_GPU3_softmax&#45;&gt;L6_S0_TP3_GPU3_attn_v -->
<g id="edge1840" class="edge">
<title>L6_S0_TP3_GPU3_softmax&#45;&gt;L6_S0_TP3_GPU3_attn_v</title>
<path fill="none" stroke="black" d="M59306,-1220.61C59306,-1220.61 59306,-1194.8 59306,-1194.8"/>
<polygon fill="black" stroke="black" points="59309.5,-1194.8 59306,-1184.8 59302.5,-1194.8 59309.5,-1194.8"/>
</g>
<!-- L6_S0_TP3_GPU3_mha_res -->
<g id="node685" class="node">
<title>L6_S0_TP3_GPU3_mha_res</title>
<polygon fill="none" stroke="black" points="59620.5,-948.5 58733.5,-948.5 58733.5,-880.5 59620.5,-880.5 59620.5,-948.5"/>
<text text-anchor="middle" x="59177" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="59177" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="59177" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="59177" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP3_GPU3_mha_ar&#45;&gt;L6_S0_TP3_GPU3_mha_res -->
<g id="edge1850" class="edge">
<title>L6_S0_TP3_GPU3_mha_ar&#45;&gt;L6_S0_TP3_GPU3_mha_res</title>
<path fill="none" stroke="black" d="M59288.01,-984.55C59288.01,-984.55 59288.01,-958.73 59288.01,-958.73"/>
<polygon fill="black" stroke="black" points="59291.51,-958.73 59288.01,-948.73 59284.51,-958.73 59291.51,-958.73"/>
</g>
<!-- L6_S0_TP3_GPU3_gate -->
<g id="node686" class="node">
<title>L6_S0_TP3_GPU3_gate</title>
<polygon fill="none" stroke="black" points="59706.56,-844.5 58864.15,-844.5 58647.44,-708.5 59489.85,-708.5 59706.56,-844.5"/>
<text text-anchor="middle" x="59177" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="59177" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="59177" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="59177" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L6_S0_TP3_GPU3_mha_res&#45;&gt;L6_S0_TP3_GPU3_gate -->
<g id="edge1851" class="edge">
<title>L6_S0_TP3_GPU3_mha_res&#45;&gt;L6_S0_TP3_GPU3_gate</title>
<path fill="none" stroke="black" d="M59177,-880.39C59177,-880.39 59177,-854.73 59177,-854.73"/>
<polygon fill="black" stroke="black" points="59180.5,-854.73 59177,-844.73 59173.5,-854.73 59180.5,-854.73"/>
</g>
<!-- L6_S0_TP3_GPU3_moe_res -->
<g id="node688" class="node">
<title>L6_S0_TP3_GPU3_moe_res</title>
<polygon fill="none" stroke="black" points="59684,-436.33 58864,-436.33 58864,-368.33 59684,-368.33 59684,-436.33"/>
<text text-anchor="middle" x="59274" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="59274" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="59274" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="59274" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP3_GPU3_mha_res&#45;&gt;L6_S0_TP3_GPU3_moe_res -->
<g id="edge1871" class="edge">
<title>L6_S0_TP3_GPU3_mha_res&#45;&gt;L6_S0_TP3_GPU3_moe_res</title>
<path fill="none" stroke="black" d="M59620.59,-925C59680.04,-925 59721,-925 59721,-925 59721,-925 59721,-572 59721,-572 59721,-572 59697.31,-572 59697.31,-572 59697.31,-572 59697.31,-413 59697.31,-413 59697.31,-413 59694.17,-413 59694.17,-413"/>
<polygon fill="black" stroke="black" points="59694.17,-409.5 59684.17,-413 59694.17,-416.5 59694.17,-409.5"/>
</g>
<!-- L6_S0_TP3_GPU3_gate&#45;&gt;L6_S0_TP3_GPU3_expert0 -->
<g id="edge1852" class="edge">
<title>L6_S0_TP3_GPU3_gate&#45;&gt;L6_S0_TP3_GPU3_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58940.17,-708.31C58940.17,-708.31 58940.17,-682.71 58940.17,-682.71"/>
<polygon fill="black" stroke="black" points="58943.67,-682.71 58940.17,-672.71 58936.67,-682.71 58943.67,-682.71"/>
</g>
<!-- L6_S0_TP3_GPU3_gate&#45;&gt;L6_S0_TP3_GPU3_expert1 -->
<g id="edge1853" class="edge">
<title>L6_S0_TP3_GPU3_gate&#45;&gt;L6_S0_TP3_GPU3_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M59482,-708.31C59482,-708.31 59482,-682.71 59482,-682.71"/>
<polygon fill="black" stroke="black" points="59485.5,-682.71 59482,-672.71 59478.5,-682.71 59485.5,-682.71"/>
</g>
<!-- L6_S0_TP3_GPU3_moe_ar&#45;&gt;L6_S0_TP3_GPU3_moe_res -->
<g id="edge1870" class="edge">
<title>L6_S0_TP3_GPU3_moe_ar&#45;&gt;L6_S0_TP3_GPU3_moe_res</title>
<path fill="none" stroke="black" d="M59239.69,-475.1C59239.69,-475.1 59239.69,-446.34 59239.69,-446.34"/>
<polygon fill="black" stroke="black" points="59243.19,-446.34 59239.69,-436.34 59236.19,-446.34 59243.19,-446.34"/>
</g>
<!-- L6_S0_TP3_GPU3_norm -->
<g id="node689" class="node">
<title>L6_S0_TP3_GPU3_norm</title>
<polygon fill="none" stroke="black" points="59498.5,-332.33 59049.5,-332.33 59049.5,-264.33 59498.5,-264.33 59498.5,-332.33"/>
<text text-anchor="middle" x="59274" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="59274" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="59274" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="59274" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP3_GPU3_moe_res&#45;&gt;L6_S0_TP3_GPU3_norm -->
<g id="edge1872" class="edge">
<title>L6_S0_TP3_GPU3_moe_res&#45;&gt;L6_S0_TP3_GPU3_norm</title>
<path fill="none" stroke="black" d="M59274,-368.28C59274,-368.28 59274,-342.46 59274,-342.46"/>
<polygon fill="black" stroke="black" points="59277.5,-342.46 59274,-332.46 59270.5,-342.46 59277.5,-342.46"/>
</g>
<!-- L6_S0_TP4_GPU4_qkv_linear -->
<g id="node690" class="node">
<title>L6_S0_TP4_GPU4_qkv_linear</title>
<polygon fill="none" stroke="black" points="60425,-1614.75 59817,-1614.75 59817,-1546.75 60425,-1546.75 60425,-1614.75"/>
<text text-anchor="middle" x="60121" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="60121" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="60121" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="60121" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L6_S0_TP4_GPU4_qkv_slice -->
<g id="node691" class="node">
<title>L6_S0_TP4_GPU4_qkv_slice</title>
<polygon fill="none" stroke="black" points="60419,-1496.67 59823,-1496.67 59823,-1428.67 60419,-1428.67 60419,-1496.67"/>
<text text-anchor="middle" x="60121" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="60121" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="60121" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="60121" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L6_S0_TP4_GPU4_qkv_linear&#45;&gt;L6_S0_TP4_GPU4_qkv_slice -->
<g id="edge1873" class="edge">
<title>L6_S0_TP4_GPU4_qkv_linear&#45;&gt;L6_S0_TP4_GPU4_qkv_slice</title>
<path fill="none" stroke="black" d="M60121,-1546.59C60121,-1546.59 60121,-1506.74 60121,-1506.74"/>
<polygon fill="black" stroke="black" points="60124.5,-1506.74 60121,-1496.74 60117.5,-1506.74 60124.5,-1506.74"/>
</g>
<!-- L6_S0_TP4_GPU4_qkv_slice&#45;&gt;L6_S0_TP4_GPU4_attn_v -->
<g id="edge1877" class="edge">
<title>L6_S0_TP4_GPU4_qkv_slice&#45;&gt;L6_S0_TP4_GPU4_attn_v</title>
<path fill="none" stroke="black" d="M59872,-1428.38C59872,-1428.38 59872,-1195 59872,-1195"/>
<polygon fill="black" stroke="black" points="59875.5,-1195 59872,-1185 59868.5,-1195 59875.5,-1195"/>
</g>
<!-- L6_S0_TP4_GPU4_qk_matmul -->
<g id="node692" class="node">
<title>L6_S0_TP4_GPU4_qk_matmul</title>
<polygon fill="none" stroke="black" points="60836.5,-1392.67 59901.5,-1392.67 59901.5,-1324.67 60836.5,-1324.67 60836.5,-1392.67"/>
<text text-anchor="middle" x="60369" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="60369" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="60369" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="60369" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L6_S0_TP4_GPU4_qkv_slice&#45;&gt;L6_S0_TP4_GPU4_qk_matmul -->
<g id="edge1874" class="edge">
<title>L6_S0_TP4_GPU4_qkv_slice&#45;&gt;L6_S0_TP4_GPU4_qk_matmul</title>
<path fill="none" stroke="black" d="M60160.25,-1428.61C60160.25,-1428.61 60160.25,-1402.8 60160.25,-1402.8"/>
<polygon fill="black" stroke="black" points="60163.75,-1402.8 60160.25,-1392.8 60156.75,-1402.8 60163.75,-1402.8"/>
</g>
<!-- L6_S0_TP4_GPU4_softmax -->
<g id="node693" class="node">
<title>L6_S0_TP4_GPU4_softmax</title>
<polygon fill="none" stroke="black" points="60536,-1288.67 60026,-1288.67 60026,-1220.67 60536,-1220.67 60536,-1288.67"/>
<text text-anchor="middle" x="60281" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="60281" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="60281" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="60281" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L6_S0_TP4_GPU4_qk_matmul&#45;&gt;L6_S0_TP4_GPU4_softmax -->
<g id="edge1875" class="edge">
<title>L6_S0_TP4_GPU4_qk_matmul&#45;&gt;L6_S0_TP4_GPU4_softmax</title>
<path fill="none" stroke="black" d="M60281,-1324.61C60281,-1324.61 60281,-1298.8 60281,-1298.8"/>
<polygon fill="black" stroke="black" points="60284.5,-1298.8 60281,-1288.8 60277.5,-1298.8 60284.5,-1298.8"/>
</g>
<!-- L6_S0_TP4_GPU4_softmax&#45;&gt;L6_S0_TP4_GPU4_attn_v -->
<g id="edge1876" class="edge">
<title>L6_S0_TP4_GPU4_softmax&#45;&gt;L6_S0_TP4_GPU4_attn_v</title>
<path fill="none" stroke="black" d="M60281,-1220.61C60281,-1220.61 60281,-1194.8 60281,-1194.8"/>
<polygon fill="black" stroke="black" points="60284.5,-1194.8 60281,-1184.8 60277.5,-1194.8 60284.5,-1194.8"/>
</g>
<!-- L6_S0_TP4_GPU4_mha_res -->
<g id="node695" class="node">
<title>L6_S0_TP4_GPU4_mha_res</title>
<polygon fill="none" stroke="black" points="60698.5,-948.5 59811.5,-948.5 59811.5,-880.5 60698.5,-880.5 60698.5,-948.5"/>
<text text-anchor="middle" x="60255" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="60255" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="60255" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="60255" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP4_GPU4_mha_ar&#45;&gt;L6_S0_TP4_GPU4_mha_res -->
<g id="edge1886" class="edge">
<title>L6_S0_TP4_GPU4_mha_ar&#45;&gt;L6_S0_TP4_GPU4_mha_res</title>
<path fill="none" stroke="black" d="M60143.49,-984.55C60143.49,-984.55 60143.49,-958.73 60143.49,-958.73"/>
<polygon fill="black" stroke="black" points="60146.99,-958.73 60143.49,-948.73 60139.99,-958.73 60146.99,-958.73"/>
</g>
<!-- L6_S0_TP4_GPU4_gate -->
<g id="node696" class="node">
<title>L6_S0_TP4_GPU4_gate</title>
<polygon fill="none" stroke="black" points="60784.56,-844.5 59942.15,-844.5 59725.44,-708.5 60567.85,-708.5 60784.56,-844.5"/>
<text text-anchor="middle" x="60255" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="60255" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="60255" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="60255" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L6_S0_TP4_GPU4_mha_res&#45;&gt;L6_S0_TP4_GPU4_gate -->
<g id="edge1887" class="edge">
<title>L6_S0_TP4_GPU4_mha_res&#45;&gt;L6_S0_TP4_GPU4_gate</title>
<path fill="none" stroke="black" d="M60255,-880.39C60255,-880.39 60255,-854.73 60255,-854.73"/>
<polygon fill="black" stroke="black" points="60258.5,-854.73 60255,-844.73 60251.5,-854.73 60258.5,-854.73"/>
</g>
<!-- L6_S0_TP4_GPU4_moe_res -->
<g id="node698" class="node">
<title>L6_S0_TP4_GPU4_moe_res</title>
<polygon fill="none" stroke="black" points="60586,-436.33 59766,-436.33 59766,-368.33 60586,-368.33 60586,-436.33"/>
<text text-anchor="middle" x="60176" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="60176" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="60176" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="60176" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP4_GPU4_mha_res&#45;&gt;L6_S0_TP4_GPU4_moe_res -->
<g id="edge1907" class="edge">
<title>L6_S0_TP4_GPU4_mha_res&#45;&gt;L6_S0_TP4_GPU4_moe_res</title>
<path fill="none" stroke="black" d="M59811.24,-903C59758.4,-903 59722.75,-903 59722.75,-903 59722.75,-903 59722.75,-574 59722.75,-574 59722.75,-574 59700.92,-574 59700.92,-574 59700.92,-574 59700.92,-390 59700.92,-390 59700.92,-390 59755.98,-390 59755.98,-390"/>
<polygon fill="black" stroke="black" points="59755.98,-393.5 59765.98,-390 59755.98,-386.5 59755.98,-393.5"/>
</g>
<!-- L6_S0_TP4_GPU4_gate&#45;&gt;L6_S0_TP4_GPU4_expert0 -->
<g id="edge1888" class="edge">
<title>L6_S0_TP4_GPU4_gate&#45;&gt;L6_S0_TP4_GPU4_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M60024.07,-708.31C60024.07,-708.31 60024.07,-682.71 60024.07,-682.71"/>
<polygon fill="black" stroke="black" points="60027.57,-682.71 60024.07,-672.71 60020.57,-682.71 60027.57,-682.71"/>
</g>
<!-- L6_S0_TP4_GPU4_gate&#45;&gt;L6_S0_TP4_GPU4_expert1 -->
<g id="edge1889" class="edge">
<title>L6_S0_TP4_GPU4_gate&#45;&gt;L6_S0_TP4_GPU4_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M60416,-708.31C60416,-708.31 60416,-682.71 60416,-682.71"/>
<polygon fill="black" stroke="black" points="60419.5,-682.71 60416,-672.71 60412.5,-682.71 60419.5,-682.71"/>
</g>
<!-- L6_S0_TP4_GPU4_moe_ar&#45;&gt;L6_S0_TP4_GPU4_moe_res -->
<g id="edge1906" class="edge">
<title>L6_S0_TP4_GPU4_moe_ar&#45;&gt;L6_S0_TP4_GPU4_moe_res</title>
<path fill="none" stroke="black" d="M60069.73,-472.39C60069.73,-472.39 60069.73,-446.57 60069.73,-446.57"/>
<polygon fill="black" stroke="black" points="60073.23,-446.57 60069.73,-436.57 60066.23,-446.57 60073.23,-446.57"/>
</g>
<!-- L6_S0_TP4_GPU4_norm -->
<g id="node699" class="node">
<title>L6_S0_TP4_GPU4_norm</title>
<polygon fill="none" stroke="black" points="60400.5,-332.33 59951.5,-332.33 59951.5,-264.33 60400.5,-264.33 60400.5,-332.33"/>
<text text-anchor="middle" x="60176" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="60176" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="60176" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="60176" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP4_GPU4_moe_res&#45;&gt;L6_S0_TP4_GPU4_norm -->
<g id="edge1908" class="edge">
<title>L6_S0_TP4_GPU4_moe_res&#45;&gt;L6_S0_TP4_GPU4_norm</title>
<path fill="none" stroke="black" d="M60176,-368.28C60176,-368.28 60176,-342.46 60176,-342.46"/>
<polygon fill="black" stroke="black" points="60179.5,-342.46 60176,-332.46 60172.5,-342.46 60179.5,-342.46"/>
</g>
<!-- L6_S0_TP5_GPU5_qkv_linear -->
<g id="node700" class="node">
<title>L6_S0_TP5_GPU5_qkv_linear</title>
<polygon fill="none" stroke="black" points="61418,-1614.75 60810,-1614.75 60810,-1546.75 61418,-1546.75 61418,-1614.75"/>
<text text-anchor="middle" x="61114" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="61114" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="61114" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="61114" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L6_S0_TP5_GPU5_qkv_slice -->
<g id="node701" class="node">
<title>L6_S0_TP5_GPU5_qkv_slice</title>
<polygon fill="none" stroke="black" points="61412,-1496.67 60816,-1496.67 60816,-1428.67 61412,-1428.67 61412,-1496.67"/>
<text text-anchor="middle" x="61114" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="61114" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="61114" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="61114" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L6_S0_TP5_GPU5_qkv_linear&#45;&gt;L6_S0_TP5_GPU5_qkv_slice -->
<g id="edge1909" class="edge">
<title>L6_S0_TP5_GPU5_qkv_linear&#45;&gt;L6_S0_TP5_GPU5_qkv_slice</title>
<path fill="none" stroke="black" d="M61114,-1546.59C61114,-1546.59 61114,-1506.74 61114,-1506.74"/>
<polygon fill="black" stroke="black" points="61117.5,-1506.74 61114,-1496.74 61110.5,-1506.74 61117.5,-1506.74"/>
</g>
<!-- L6_S0_TP5_GPU5_qkv_slice&#45;&gt;L6_S0_TP5_GPU5_attn_v -->
<g id="edge1913" class="edge">
<title>L6_S0_TP5_GPU5_qkv_slice&#45;&gt;L6_S0_TP5_GPU5_attn_v</title>
<path fill="none" stroke="black" d="M60865.5,-1428.38C60865.5,-1428.38 60865.5,-1195 60865.5,-1195"/>
<polygon fill="black" stroke="black" points="60869,-1195 60865.5,-1185 60862,-1195 60869,-1195"/>
</g>
<!-- L6_S0_TP5_GPU5_qk_matmul -->
<g id="node702" class="node">
<title>L6_S0_TP5_GPU5_qk_matmul</title>
<polygon fill="none" stroke="black" points="61829.5,-1392.67 60894.5,-1392.67 60894.5,-1324.67 61829.5,-1324.67 61829.5,-1392.67"/>
<text text-anchor="middle" x="61362" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="61362" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="61362" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="61362" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L6_S0_TP5_GPU5_qkv_slice&#45;&gt;L6_S0_TP5_GPU5_qk_matmul -->
<g id="edge1910" class="edge">
<title>L6_S0_TP5_GPU5_qkv_slice&#45;&gt;L6_S0_TP5_GPU5_qk_matmul</title>
<path fill="none" stroke="black" d="M61153.25,-1428.61C61153.25,-1428.61 61153.25,-1402.8 61153.25,-1402.8"/>
<polygon fill="black" stroke="black" points="61156.75,-1402.8 61153.25,-1392.8 61149.75,-1402.8 61156.75,-1402.8"/>
</g>
<!-- L6_S0_TP5_GPU5_softmax -->
<g id="node703" class="node">
<title>L6_S0_TP5_GPU5_softmax</title>
<polygon fill="none" stroke="black" points="61511,-1288.67 61001,-1288.67 61001,-1220.67 61511,-1220.67 61511,-1288.67"/>
<text text-anchor="middle" x="61256" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="61256" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="61256" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="61256" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L6_S0_TP5_GPU5_qk_matmul&#45;&gt;L6_S0_TP5_GPU5_softmax -->
<g id="edge1911" class="edge">
<title>L6_S0_TP5_GPU5_qk_matmul&#45;&gt;L6_S0_TP5_GPU5_softmax</title>
<path fill="none" stroke="black" d="M61256,-1324.61C61256,-1324.61 61256,-1298.8 61256,-1298.8"/>
<polygon fill="black" stroke="black" points="61259.5,-1298.8 61256,-1288.8 61252.5,-1298.8 61259.5,-1298.8"/>
</g>
<!-- L6_S0_TP5_GPU5_softmax&#45;&gt;L6_S0_TP5_GPU5_attn_v -->
<g id="edge1912" class="edge">
<title>L6_S0_TP5_GPU5_softmax&#45;&gt;L6_S0_TP5_GPU5_attn_v</title>
<path fill="none" stroke="black" d="M61256,-1220.61C61256,-1220.61 61256,-1194.8 61256,-1194.8"/>
<polygon fill="black" stroke="black" points="61259.5,-1194.8 61256,-1184.8 61252.5,-1194.8 61259.5,-1194.8"/>
</g>
<!-- L6_S0_TP5_GPU5_mha_res -->
<g id="node705" class="node">
<title>L6_S0_TP5_GPU5_mha_res</title>
<polygon fill="none" stroke="black" points="61776.5,-948.5 60889.5,-948.5 60889.5,-880.5 61776.5,-880.5 61776.5,-948.5"/>
<text text-anchor="middle" x="61333" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="61333" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="61333" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="61333" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP5_GPU5_mha_ar&#45;&gt;L6_S0_TP5_GPU5_mha_res -->
<g id="edge1922" class="edge">
<title>L6_S0_TP5_GPU5_mha_ar&#45;&gt;L6_S0_TP5_GPU5_mha_res</title>
<path fill="none" stroke="black" d="M61066.99,-991.61C61066.99,-991.61 61066.99,-958.74 61066.99,-958.74"/>
<polygon fill="black" stroke="black" points="61070.49,-958.74 61066.99,-948.74 61063.49,-958.74 61070.49,-958.74"/>
</g>
<!-- L6_S0_TP5_GPU5_gate -->
<g id="node706" class="node">
<title>L6_S0_TP5_GPU5_gate</title>
<polygon fill="none" stroke="black" points="61862.56,-844.5 61020.15,-844.5 60803.44,-708.5 61645.85,-708.5 61862.56,-844.5"/>
<text text-anchor="middle" x="61333" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="61333" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="61333" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="61333" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L6_S0_TP5_GPU5_mha_res&#45;&gt;L6_S0_TP5_GPU5_gate -->
<g id="edge1923" class="edge">
<title>L6_S0_TP5_GPU5_mha_res&#45;&gt;L6_S0_TP5_GPU5_gate</title>
<path fill="none" stroke="black" d="M61333,-880.39C61333,-880.39 61333,-854.73 61333,-854.73"/>
<polygon fill="black" stroke="black" points="61336.5,-854.73 61333,-844.73 61329.5,-854.73 61336.5,-854.73"/>
</g>
<!-- L6_S0_TP5_GPU5_moe_res -->
<g id="node708" class="node">
<title>L6_S0_TP5_GPU5_moe_res</title>
<polygon fill="none" stroke="black" points="62192,-436.33 61372,-436.33 61372,-368.33 62192,-368.33 62192,-436.33"/>
<text text-anchor="middle" x="61782" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="61782" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="61782" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="61782" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP5_GPU5_mha_res&#45;&gt;L6_S0_TP5_GPU5_moe_res -->
<g id="edge1943" class="edge">
<title>L6_S0_TP5_GPU5_mha_res&#45;&gt;L6_S0_TP5_GPU5_moe_res</title>
<path fill="none" stroke="black" d="M61776.57,-914C61833.27,-914 61872,-914 61872,-914 61872,-914 61872,-691 61872,-691 61872,-691 61583.5,-691 61583.5,-691 61583.5,-691 61583.5,-599 61583.5,-599 61583.5,-599 61759.51,-599 61759.51,-599 61759.51,-599 61759.51,-446.59 61759.51,-446.59"/>
<polygon fill="black" stroke="black" points="61763.01,-446.59 61759.51,-436.59 61756.01,-446.59 61763.01,-446.59"/>
</g>
<!-- L6_S0_TP5_GPU5_gate&#45;&gt;L6_S0_TP5_GPU5_expert0 -->
<g id="edge1924" class="edge">
<title>L6_S0_TP5_GPU5_gate&#45;&gt;L6_S0_TP5_GPU5_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M60955.36,-708.31C60955.36,-708.31 60955.36,-682.71 60955.36,-682.71"/>
<polygon fill="black" stroke="black" points="60958.86,-682.71 60955.36,-672.71 60951.86,-682.71 60958.86,-682.71"/>
</g>
<!-- L6_S0_TP5_GPU5_gate&#45;&gt;L6_S0_TP5_GPU5_expert1 -->
<g id="edge1925" class="edge">
<title>L6_S0_TP5_GPU5_gate&#45;&gt;L6_S0_TP5_GPU5_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61424.83,-708.31C61424.83,-708.31 61424.83,-682.71 61424.83,-682.71"/>
<polygon fill="black" stroke="black" points="61428.33,-682.71 61424.83,-672.71 61421.33,-682.71 61428.33,-682.71"/>
</g>
<!-- L6_S0_TP5_GPU5_moe_ar&#45;&gt;L6_S0_TP5_GPU5_moe_res -->
<g id="edge1942" class="edge">
<title>L6_S0_TP5_GPU5_moe_ar&#45;&gt;L6_S0_TP5_GPU5_moe_res</title>
<path fill="none" stroke="black" d="M60902.31,-479.33C60902.31,-445.13 60902.31,-402 60902.31,-402 60902.31,-402 61361.77,-402 61361.77,-402"/>
<polygon fill="black" stroke="black" points="61361.77,-405.5 61371.77,-402 61361.77,-398.5 61361.77,-405.5"/>
</g>
<!-- L6_S0_TP5_GPU5_norm -->
<g id="node709" class="node">
<title>L6_S0_TP5_GPU5_norm</title>
<polygon fill="none" stroke="black" points="62006.5,-332.33 61557.5,-332.33 61557.5,-264.33 62006.5,-264.33 62006.5,-332.33"/>
<text text-anchor="middle" x="61782" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="61782" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="61782" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="61782" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP5_GPU5_moe_res&#45;&gt;L6_S0_TP5_GPU5_norm -->
<g id="edge1944" class="edge">
<title>L6_S0_TP5_GPU5_moe_res&#45;&gt;L6_S0_TP5_GPU5_norm</title>
<path fill="none" stroke="black" d="M61782,-368.28C61782,-368.28 61782,-342.46 61782,-342.46"/>
<polygon fill="black" stroke="black" points="61785.5,-342.46 61782,-332.46 61778.5,-342.46 61785.5,-342.46"/>
</g>
<!-- L6_S0_TP6_GPU6_qkv_linear -->
<g id="node710" class="node">
<title>L6_S0_TP6_GPU6_qkv_linear</title>
<polygon fill="none" stroke="black" points="62463,-1614.75 61855,-1614.75 61855,-1546.75 62463,-1546.75 62463,-1614.75"/>
<text text-anchor="middle" x="62159" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="62159" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="62159" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="62159" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L6_S0_TP6_GPU6_qkv_slice -->
<g id="node711" class="node">
<title>L6_S0_TP6_GPU6_qkv_slice</title>
<polygon fill="none" stroke="black" points="62457,-1496.67 61861,-1496.67 61861,-1428.67 62457,-1428.67 62457,-1496.67"/>
<text text-anchor="middle" x="62159" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="62159" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="62159" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="62159" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L6_S0_TP6_GPU6_qkv_linear&#45;&gt;L6_S0_TP6_GPU6_qkv_slice -->
<g id="edge1945" class="edge">
<title>L6_S0_TP6_GPU6_qkv_linear&#45;&gt;L6_S0_TP6_GPU6_qkv_slice</title>
<path fill="none" stroke="black" d="M62159,-1546.59C62159,-1546.59 62159,-1506.74 62159,-1506.74"/>
<polygon fill="black" stroke="black" points="62162.5,-1506.74 62159,-1496.74 62155.5,-1506.74 62162.5,-1506.74"/>
</g>
<!-- L6_S0_TP6_GPU6_qkv_slice&#45;&gt;L6_S0_TP6_GPU6_attn_v -->
<g id="edge1949" class="edge">
<title>L6_S0_TP6_GPU6_qkv_slice&#45;&gt;L6_S0_TP6_GPU6_attn_v</title>
<path fill="none" stroke="black" d="M61900.25,-1428.38C61900.25,-1428.38 61900.25,-1195 61900.25,-1195"/>
<polygon fill="black" stroke="black" points="61903.75,-1195 61900.25,-1185 61896.75,-1195 61903.75,-1195"/>
</g>
<!-- L6_S0_TP6_GPU6_qk_matmul -->
<g id="node712" class="node">
<title>L6_S0_TP6_GPU6_qk_matmul</title>
<polygon fill="none" stroke="black" points="62874.5,-1392.67 61939.5,-1392.67 61939.5,-1324.67 62874.5,-1324.67 62874.5,-1392.67"/>
<text text-anchor="middle" x="62407" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="62407" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="62407" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="62407" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L6_S0_TP6_GPU6_qkv_slice&#45;&gt;L6_S0_TP6_GPU6_qk_matmul -->
<g id="edge1946" class="edge">
<title>L6_S0_TP6_GPU6_qkv_slice&#45;&gt;L6_S0_TP6_GPU6_qk_matmul</title>
<path fill="none" stroke="black" d="M62198.25,-1428.61C62198.25,-1428.61 62198.25,-1402.8 62198.25,-1402.8"/>
<polygon fill="black" stroke="black" points="62201.75,-1402.8 62198.25,-1392.8 62194.75,-1402.8 62201.75,-1402.8"/>
</g>
<!-- L6_S0_TP6_GPU6_softmax -->
<g id="node713" class="node">
<title>L6_S0_TP6_GPU6_softmax</title>
<polygon fill="none" stroke="black" points="62555,-1288.67 62045,-1288.67 62045,-1220.67 62555,-1220.67 62555,-1288.67"/>
<text text-anchor="middle" x="62300" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="62300" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="62300" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="62300" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L6_S0_TP6_GPU6_qk_matmul&#45;&gt;L6_S0_TP6_GPU6_softmax -->
<g id="edge1947" class="edge">
<title>L6_S0_TP6_GPU6_qk_matmul&#45;&gt;L6_S0_TP6_GPU6_softmax</title>
<path fill="none" stroke="black" d="M62300,-1324.61C62300,-1324.61 62300,-1298.8 62300,-1298.8"/>
<polygon fill="black" stroke="black" points="62303.5,-1298.8 62300,-1288.8 62296.5,-1298.8 62303.5,-1298.8"/>
</g>
<!-- L6_S0_TP6_GPU6_softmax&#45;&gt;L6_S0_TP6_GPU6_attn_v -->
<g id="edge1948" class="edge">
<title>L6_S0_TP6_GPU6_softmax&#45;&gt;L6_S0_TP6_GPU6_attn_v</title>
<path fill="none" stroke="black" d="M62300,-1220.61C62300,-1220.61 62300,-1194.8 62300,-1194.8"/>
<polygon fill="black" stroke="black" points="62303.5,-1194.8 62300,-1184.8 62296.5,-1194.8 62303.5,-1194.8"/>
</g>
<!-- L6_S0_TP6_GPU6_mha_res -->
<g id="node715" class="node">
<title>L6_S0_TP6_GPU6_mha_res</title>
<polygon fill="none" stroke="black" points="62854.5,-948.5 61967.5,-948.5 61967.5,-880.5 62854.5,-880.5 62854.5,-948.5"/>
<text text-anchor="middle" x="62411" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="62411" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="62411" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="62411" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP6_GPU6_mha_ar&#45;&gt;L6_S0_TP6_GPU6_mha_res -->
<g id="edge1958" class="edge">
<title>L6_S0_TP6_GPU6_mha_ar&#45;&gt;L6_S0_TP6_GPU6_mha_res</title>
<path fill="none" stroke="black" d="M61990.49,-1015.91C61990.49,-1015.91 61990.49,-958.58 61990.49,-958.58"/>
<polygon fill="black" stroke="black" points="61993.99,-958.58 61990.49,-948.58 61986.99,-958.58 61993.99,-958.58"/>
</g>
<!-- L6_S0_TP6_GPU6_gate -->
<g id="node716" class="node">
<title>L6_S0_TP6_GPU6_gate</title>
<polygon fill="none" stroke="black" points="62940.56,-844.5 62098.15,-844.5 61881.44,-708.5 62723.85,-708.5 62940.56,-844.5"/>
<text text-anchor="middle" x="62411" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="62411" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="62411" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="62411" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L6_S0_TP6_GPU6_mha_res&#45;&gt;L6_S0_TP6_GPU6_gate -->
<g id="edge1959" class="edge">
<title>L6_S0_TP6_GPU6_mha_res&#45;&gt;L6_S0_TP6_GPU6_gate</title>
<path fill="none" stroke="black" d="M62411,-880.39C62411,-880.39 62411,-854.73 62411,-854.73"/>
<polygon fill="black" stroke="black" points="62414.5,-854.73 62411,-844.73 62407.5,-854.73 62414.5,-854.73"/>
</g>
<!-- L6_S0_TP6_GPU6_moe_res -->
<g id="node718" class="node">
<title>L6_S0_TP6_GPU6_moe_res</title>
<polygon fill="none" stroke="black" points="63222,-436.33 62402,-436.33 62402,-368.33 63222,-368.33 63222,-436.33"/>
<text text-anchor="middle" x="62812" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="62812" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="62812" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="62812" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP6_GPU6_mha_res&#45;&gt;L6_S0_TP6_GPU6_moe_res -->
<g id="edge1979" class="edge">
<title>L6_S0_TP6_GPU6_mha_res&#45;&gt;L6_S0_TP6_GPU6_moe_res</title>
<path fill="none" stroke="black" d="M62854.57,-914C62911.27,-914 62950,-914 62950,-914 62950,-914 62950,-687 62950,-687 62950,-687 62984.5,-687 62984.5,-687 62984.5,-687 62984.5,-446.39 62984.5,-446.39"/>
<polygon fill="black" stroke="black" points="62988,-446.39 62984.5,-436.39 62981,-446.39 62988,-446.39"/>
</g>
<!-- L6_S0_TP6_GPU6_gate&#45;&gt;L6_S0_TP6_GPU6_expert0 -->
<g id="edge1960" class="edge">
<title>L6_S0_TP6_GPU6_gate&#45;&gt;L6_S0_TP6_GPU6_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61961.36,-708.31C61961.36,-708.31 61961.36,-682.71 61961.36,-682.71"/>
<polygon fill="black" stroke="black" points="61964.86,-682.71 61961.36,-672.71 61957.86,-682.71 61964.86,-682.71"/>
</g>
<!-- L6_S0_TP6_GPU6_gate&#45;&gt;L6_S0_TP6_GPU6_expert1 -->
<g id="edge1961" class="edge">
<title>L6_S0_TP6_GPU6_gate&#45;&gt;L6_S0_TP6_GPU6_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62284,-708.31C62284,-708.31 62284,-682.71 62284,-682.71"/>
<polygon fill="black" stroke="black" points="62287.5,-682.71 62284,-672.71 62280.5,-682.71 62287.5,-682.71"/>
</g>
<!-- L6_S0_TP6_GPU6_moe_ar&#45;&gt;L6_S0_TP6_GPU6_moe_res -->
<g id="edge1978" class="edge">
<title>L6_S0_TP6_GPU6_moe_ar&#45;&gt;L6_S0_TP6_GPU6_moe_res</title>
<path fill="none" stroke="black" d="M61559.73,-476.75C61559.73,-456.57 61559.73,-437 61559.73,-437 61559.73,-437 62418.23,-437 62418.23,-437 62418.23,-437 62418.23,-436.96 62418.23,-436.96"/>
<polygon fill="black" stroke="black" points="62421.73,-446.61 62418.23,-436.61 62414.73,-446.61 62421.73,-446.61"/>
</g>
<!-- L6_S0_TP6_GPU6_norm -->
<g id="node719" class="node">
<title>L6_S0_TP6_GPU6_norm</title>
<polygon fill="none" stroke="black" points="63036.5,-332.33 62587.5,-332.33 62587.5,-264.33 63036.5,-264.33 63036.5,-332.33"/>
<text text-anchor="middle" x="62812" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="62812" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="62812" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="62812" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP6_GPU6_moe_res&#45;&gt;L6_S0_TP6_GPU6_norm -->
<g id="edge1980" class="edge">
<title>L6_S0_TP6_GPU6_moe_res&#45;&gt;L6_S0_TP6_GPU6_norm</title>
<path fill="none" stroke="black" d="M62812,-368.28C62812,-368.28 62812,-342.46 62812,-342.46"/>
<polygon fill="black" stroke="black" points="62815.5,-342.46 62812,-332.46 62808.5,-342.46 62815.5,-342.46"/>
</g>
<!-- L6_S0_TP7_GPU7_qkv_linear -->
<g id="node720" class="node">
<title>L6_S0_TP7_GPU7_qkv_linear</title>
<polygon fill="none" stroke="black" points="63508,-1614.75 62900,-1614.75 62900,-1546.75 63508,-1546.75 63508,-1614.75"/>
<text text-anchor="middle" x="63204" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="63204" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="63204" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="63204" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L6_S0_TP7_GPU7_qkv_slice -->
<g id="node721" class="node">
<title>L6_S0_TP7_GPU7_qkv_slice</title>
<polygon fill="none" stroke="black" points="63502,-1496.67 62906,-1496.67 62906,-1428.67 63502,-1428.67 63502,-1496.67"/>
<text text-anchor="middle" x="63204" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="63204" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="63204" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="63204" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L6_S0_TP7_GPU7_qkv_linear&#45;&gt;L6_S0_TP7_GPU7_qkv_slice -->
<g id="edge1981" class="edge">
<title>L6_S0_TP7_GPU7_qkv_linear&#45;&gt;L6_S0_TP7_GPU7_qkv_slice</title>
<path fill="none" stroke="black" d="M63204,-1546.59C63204,-1546.59 63204,-1506.74 63204,-1506.74"/>
<polygon fill="black" stroke="black" points="63207.5,-1506.74 63204,-1496.74 63200.5,-1506.74 63207.5,-1506.74"/>
</g>
<!-- L6_S0_TP7_GPU7_qkv_slice&#45;&gt;L6_S0_TP7_GPU7_attn_v -->
<g id="edge1985" class="edge">
<title>L6_S0_TP7_GPU7_qkv_slice&#45;&gt;L6_S0_TP7_GPU7_attn_v</title>
<path fill="none" stroke="black" d="M62945.25,-1428.38C62945.25,-1428.38 62945.25,-1195 62945.25,-1195"/>
<polygon fill="black" stroke="black" points="62948.75,-1195 62945.25,-1185 62941.75,-1195 62948.75,-1195"/>
</g>
<!-- L6_S0_TP7_GPU7_qk_matmul -->
<g id="node722" class="node">
<title>L6_S0_TP7_GPU7_qk_matmul</title>
<polygon fill="none" stroke="black" points="63919.5,-1392.67 62984.5,-1392.67 62984.5,-1324.67 63919.5,-1324.67 63919.5,-1392.67"/>
<text text-anchor="middle" x="63452" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="63452" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="63452" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="63452" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L6_S0_TP7_GPU7_qkv_slice&#45;&gt;L6_S0_TP7_GPU7_qk_matmul -->
<g id="edge1982" class="edge">
<title>L6_S0_TP7_GPU7_qkv_slice&#45;&gt;L6_S0_TP7_GPU7_qk_matmul</title>
<path fill="none" stroke="black" d="M63243.25,-1428.61C63243.25,-1428.61 63243.25,-1402.8 63243.25,-1402.8"/>
<polygon fill="black" stroke="black" points="63246.75,-1402.8 63243.25,-1392.8 63239.75,-1402.8 63246.75,-1402.8"/>
</g>
<!-- L6_S0_TP7_GPU7_softmax -->
<g id="node723" class="node">
<title>L6_S0_TP7_GPU7_softmax</title>
<polygon fill="none" stroke="black" points="63600,-1288.67 63090,-1288.67 63090,-1220.67 63600,-1220.67 63600,-1288.67"/>
<text text-anchor="middle" x="63345" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="63345" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="63345" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="63345" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L6_S0_TP7_GPU7_qk_matmul&#45;&gt;L6_S0_TP7_GPU7_softmax -->
<g id="edge1983" class="edge">
<title>L6_S0_TP7_GPU7_qk_matmul&#45;&gt;L6_S0_TP7_GPU7_softmax</title>
<path fill="none" stroke="black" d="M63345,-1324.61C63345,-1324.61 63345,-1298.8 63345,-1298.8"/>
<polygon fill="black" stroke="black" points="63348.5,-1298.8 63345,-1288.8 63341.5,-1298.8 63348.5,-1298.8"/>
</g>
<!-- L6_S0_TP7_GPU7_softmax&#45;&gt;L6_S0_TP7_GPU7_attn_v -->
<g id="edge1984" class="edge">
<title>L6_S0_TP7_GPU7_softmax&#45;&gt;L6_S0_TP7_GPU7_attn_v</title>
<path fill="none" stroke="black" d="M63310.5,-1220.61C63310.5,-1220.61 63310.5,-1194.8 63310.5,-1194.8"/>
<polygon fill="black" stroke="black" points="63314,-1194.8 63310.5,-1184.8 63307,-1194.8 63314,-1194.8"/>
</g>
<!-- L6_S0_TP7_GPU7_mha_res -->
<g id="node725" class="node">
<title>L6_S0_TP7_GPU7_mha_res</title>
<polygon fill="none" stroke="black" points="63932.5,-948.5 63045.5,-948.5 63045.5,-880.5 63932.5,-880.5 63932.5,-948.5"/>
<text text-anchor="middle" x="63489" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="63489" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="63489" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="63489" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP7_GPU7_mha_ar&#45;&gt;L6_S0_TP7_GPU7_mha_res -->
<g id="edge1994" class="edge">
<title>L6_S0_TP7_GPU7_mha_ar&#45;&gt;L6_S0_TP7_GPU7_mha_res</title>
<path fill="none" stroke="black" d="M62762.9,-1048C63007.48,-1048 63288.25,-1048 63288.25,-1048 63288.25,-1048 63288.25,-958.53 63288.25,-958.53"/>
<polygon fill="black" stroke="black" points="63291.75,-958.53 63288.25,-948.53 63284.75,-958.53 63291.75,-958.53"/>
</g>
<!-- L6_S0_TP7_GPU7_gate -->
<g id="node726" class="node">
<title>L6_S0_TP7_GPU7_gate</title>
<polygon fill="none" stroke="black" points="64018.56,-844.5 63176.15,-844.5 62959.44,-708.5 63801.85,-708.5 64018.56,-844.5"/>
<text text-anchor="middle" x="63489" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="63489" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="63489" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="63489" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L6_S0_TP7_GPU7_mha_res&#45;&gt;L6_S0_TP7_GPU7_gate -->
<g id="edge1995" class="edge">
<title>L6_S0_TP7_GPU7_mha_res&#45;&gt;L6_S0_TP7_GPU7_gate</title>
<path fill="none" stroke="black" d="M63489,-880.39C63489,-880.39 63489,-854.73 63489,-854.73"/>
<polygon fill="black" stroke="black" points="63492.5,-854.73 63489,-844.73 63485.5,-854.73 63492.5,-854.73"/>
</g>
<!-- L6_S0_TP7_GPU7_moe_res -->
<g id="node728" class="node">
<title>L6_S0_TP7_GPU7_moe_res</title>
<polygon fill="none" stroke="black" points="64444,-436.33 63624,-436.33 63624,-368.33 64444,-368.33 64444,-436.33"/>
<text text-anchor="middle" x="64034" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="64034" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="64034" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="64034" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP7_GPU7_mha_res&#45;&gt;L6_S0_TP7_GPU7_moe_res -->
<g id="edge2015" class="edge">
<title>L6_S0_TP7_GPU7_mha_res&#45;&gt;L6_S0_TP7_GPU7_moe_res</title>
<path fill="none" stroke="black" d="M63932.97,-914C64067.32,-914 64180,-914 64180,-914 64180,-914 64180,-446.7 64180,-446.7"/>
<polygon fill="black" stroke="black" points="64183.5,-446.7 64180,-436.7 64176.5,-446.7 64183.5,-446.7"/>
</g>
<!-- L6_S0_TP7_GPU7_gate&#45;&gt;L6_S0_TP7_GPU7_expert0 -->
<g id="edge1996" class="edge">
<title>L6_S0_TP7_GPU7_gate&#45;&gt;L6_S0_TP7_GPU7_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62967.36,-776.4C62967.36,-776.4 62967.36,-682.74 62967.36,-682.74"/>
<polygon fill="black" stroke="black" points="62970.86,-682.74 62967.36,-672.74 62963.86,-682.74 62970.86,-682.74"/>
</g>
<!-- L6_S0_TP7_GPU7_gate&#45;&gt;L6_S0_TP7_GPU7_expert1 -->
<g id="edge1997" class="edge">
<title>L6_S0_TP7_GPU7_gate&#45;&gt;L6_S0_TP7_GPU7_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M63292.83,-708.31C63292.83,-708.31 63292.83,-682.71 63292.83,-682.71"/>
<polygon fill="black" stroke="black" points="63296.33,-682.71 63292.83,-672.71 63289.33,-682.71 63296.33,-682.71"/>
</g>
<!-- L6_S0_TP7_GPU7_moe_ar&#45;&gt;L6_S0_TP7_GPU7_moe_res -->
<g id="edge2014" class="edge">
<title>L6_S0_TP7_GPU7_moe_ar&#45;&gt;L6_S0_TP7_GPU7_moe_res</title>
<path fill="none" stroke="black" d="M62434.45,-520C62935.14,-520 63821.39,-520 63821.39,-520 63821.39,-520 63821.39,-446.37 63821.39,-446.37"/>
<polygon fill="black" stroke="black" points="63824.89,-446.37 63821.39,-436.37 63817.89,-446.37 63824.89,-446.37"/>
</g>
<!-- L6_S0_TP7_GPU7_norm -->
<g id="node729" class="node">
<title>L6_S0_TP7_GPU7_norm</title>
<polygon fill="none" stroke="black" points="64258.5,-332.33 63809.5,-332.33 63809.5,-264.33 64258.5,-264.33 64258.5,-332.33"/>
<text text-anchor="middle" x="64034" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="64034" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="64034" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="64034" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L6_S0_TP7_GPU7_moe_res&#45;&gt;L6_S0_TP7_GPU7_norm -->
<g id="edge2016" class="edge">
<title>L6_S0_TP7_GPU7_moe_res&#45;&gt;L6_S0_TP7_GPU7_norm</title>
<path fill="none" stroke="black" d="M64034,-368.28C64034,-368.28 64034,-342.46 64034,-342.46"/>
<polygon fill="black" stroke="black" points="64037.5,-342.46 64034,-332.46 64030.5,-342.46 64037.5,-342.46"/>
</g>
<!-- L7_S0_TP0_GPU0_qkv_linear -->
<g id="node730" class="node">
<title>L7_S0_TP0_GPU0_qkv_linear</title>
<polygon fill="none" stroke="black" points="65299,-1614.75 64691,-1614.75 64691,-1546.75 65299,-1546.75 65299,-1614.75"/>
<text text-anchor="middle" x="64995" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="64995" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="64995" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="64995" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L7_S0_TP0_GPU0_qkv_slice -->
<g id="node731" class="node">
<title>L7_S0_TP0_GPU0_qkv_slice</title>
<polygon fill="none" stroke="black" points="65293,-1496.67 64697,-1496.67 64697,-1428.67 65293,-1428.67 65293,-1496.67"/>
<text text-anchor="middle" x="64995" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="64995" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="64995" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="64995" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L7_S0_TP0_GPU0_qkv_linear&#45;&gt;L7_S0_TP0_GPU0_qkv_slice -->
<g id="edge2017" class="edge">
<title>L7_S0_TP0_GPU0_qkv_linear&#45;&gt;L7_S0_TP0_GPU0_qkv_slice</title>
<path fill="none" stroke="black" d="M64995,-1546.59C64995,-1546.59 64995,-1506.74 64995,-1506.74"/>
<polygon fill="black" stroke="black" points="64998.5,-1506.74 64995,-1496.74 64991.5,-1506.74 64998.5,-1506.74"/>
</g>
<!-- L7_S0_TP0_GPU0_qk_matmul -->
<g id="node732" class="node">
<title>L7_S0_TP0_GPU0_qk_matmul</title>
<polygon fill="none" stroke="black" points="65767.5,-1392.67 64832.5,-1392.67 64832.5,-1324.67 65767.5,-1324.67 65767.5,-1392.67"/>
<text text-anchor="middle" x="65300" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="65300" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="65300" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="65300" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L7_S0_TP0_GPU0_qkv_slice&#45;&gt;L7_S0_TP0_GPU0_qk_matmul -->
<g id="edge2018" class="edge">
<title>L7_S0_TP0_GPU0_qkv_slice&#45;&gt;L7_S0_TP0_GPU0_qk_matmul</title>
<path fill="none" stroke="black" d="M65062.75,-1428.61C65062.75,-1428.61 65062.75,-1402.8 65062.75,-1402.8"/>
<polygon fill="black" stroke="black" points="65066.25,-1402.8 65062.75,-1392.8 65059.25,-1402.8 65066.25,-1402.8"/>
</g>
<!-- L7_S0_TP0_GPU0_attn_v -->
<g id="node734" class="node">
<title>L7_S0_TP0_GPU0_attn_v</title>
<polygon fill="none" stroke="black" points="65767,-1184.67 64829,-1184.67 64829,-1116.67 65767,-1116.67 65767,-1184.67"/>
<text text-anchor="middle" x="65298" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="65298" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="65298" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="65298" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L7_S0_TP0_GPU0_qkv_slice&#45;&gt;L7_S0_TP0_GPU0_attn_v -->
<g id="edge2021" class="edge">
<title>L7_S0_TP0_GPU0_qkv_slice&#45;&gt;L7_S0_TP0_GPU0_attn_v</title>
<path fill="none" stroke="black" d="M64763,-1428.61C64763,-1347.57 64763,-1150 64763,-1150 64763,-1150 64818.87,-1150 64818.87,-1150"/>
<polygon fill="black" stroke="black" points="64818.87,-1153.5 64828.87,-1150 64818.87,-1146.5 64818.87,-1153.5"/>
</g>
<!-- L7_S0_TP0_GPU0_softmax -->
<g id="node733" class="node">
<title>L7_S0_TP0_GPU0_softmax</title>
<polygon fill="none" stroke="black" points="65554,-1288.67 65044,-1288.67 65044,-1220.67 65554,-1220.67 65554,-1288.67"/>
<text text-anchor="middle" x="65299" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="65299" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="65299" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="65299" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L7_S0_TP0_GPU0_qk_matmul&#45;&gt;L7_S0_TP0_GPU0_softmax -->
<g id="edge2019" class="edge">
<title>L7_S0_TP0_GPU0_qk_matmul&#45;&gt;L7_S0_TP0_GPU0_softmax</title>
<path fill="none" stroke="black" d="M65299,-1324.61C65299,-1324.61 65299,-1298.8 65299,-1298.8"/>
<polygon fill="black" stroke="black" points="65302.5,-1298.8 65299,-1288.8 65295.5,-1298.8 65302.5,-1298.8"/>
</g>
<!-- L7_S0_TP0_GPU0_softmax&#45;&gt;L7_S0_TP0_GPU0_attn_v -->
<g id="edge2020" class="edge">
<title>L7_S0_TP0_GPU0_softmax&#45;&gt;L7_S0_TP0_GPU0_attn_v</title>
<path fill="none" stroke="black" d="M65299,-1220.61C65299,-1220.61 65299,-1194.8 65299,-1194.8"/>
<polygon fill="black" stroke="black" points="65302.5,-1194.8 65299,-1184.8 65295.5,-1194.8 65302.5,-1194.8"/>
</g>
<!-- L7_S0_TP0_GPU0_mha_ar -->
<g id="node735" class="node">
<title>L7_S0_TP0_GPU0_mha_ar</title>
<ellipse fill="none" stroke="black" cx="65952" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="65952" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="65952" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="65952" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="65952" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP0_GPU0_attn_v&#45;&gt;L7_S0_TP0_GPU0_mha_ar -->
<g id="edge2022" class="edge">
<title>L7_S0_TP0_GPU0_attn_v&#45;&gt;L7_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M65603.74,-1116.51C65603.74,-1116.51 65603.74,-1060.6 65603.74,-1060.6"/>
<polygon fill="black" stroke="black" points="65607.24,-1060.6 65603.74,-1050.6 65600.24,-1060.6 65607.24,-1060.6"/>
</g>
<!-- L7_S0_TP1_GPU1_mha_ar -->
<g id="node784" class="node">
<title>L7_S0_TP1_GPU1_mha_ar</title>
<ellipse fill="none" stroke="black" cx="66721" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="66721" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="66721" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="66721" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="66721" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP0_GPU0_attn_v&#45;&gt;L7_S0_TP1_GPU1_mha_ar -->
<g id="edge2074" class="edge">
<title>L7_S0_TP0_GPU0_attn_v&#45;&gt;L7_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M65630.95,-1116.44C65630.95,-1099.65 65630.95,-1083 65630.95,-1083 65630.95,-1083 66392.71,-1083 66392.71,-1083 66392.71,-1083 66392.71,-1066.02 66392.71,-1066.02"/>
<polygon fill="black" stroke="black" points="66396.21,-1066.02 66392.71,-1056.02 66389.21,-1066.02 66396.21,-1066.02"/>
</g>
<!-- L7_S0_TP2_GPU2_mha_ar -->
<g id="node793" class="node">
<title>L7_S0_TP2_GPU2_mha_ar</title>
<ellipse fill="none" stroke="black" cx="67490" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="67490" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="67490" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="67490" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="67490" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP0_GPU0_attn_v&#45;&gt;L7_S0_TP2_GPU2_mha_ar -->
<g id="edge2126" class="edge">
<title>L7_S0_TP0_GPU0_attn_v&#45;&gt;L7_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M65658.16,-1116.44C65658.16,-1099.65 65658.16,-1083 65658.16,-1083 65658.16,-1083 67177.25,-1083 67177.25,-1083 67177.25,-1083 67177.25,-1069.27 67177.25,-1069.27"/>
<polygon fill="black" stroke="black" points="67180.75,-1069.27 67177.25,-1059.27 67173.75,-1069.27 67180.75,-1069.27"/>
</g>
<!-- L7_S0_TP3_GPU3_mha_ar -->
<g id="node802" class="node">
<title>L7_S0_TP3_GPU3_mha_ar</title>
<ellipse fill="none" stroke="black" cx="68259" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="68259" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="68259" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="68259" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="68259" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP0_GPU0_attn_v&#45;&gt;L7_S0_TP3_GPU3_mha_ar -->
<g id="edge2178" class="edge">
<title>L7_S0_TP0_GPU0_attn_v&#45;&gt;L7_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M65685.37,-1116.44C65685.37,-1099.65 65685.37,-1083 65685.37,-1083 65685.37,-1083 67990.8,-1083 67990.8,-1083 67990.8,-1083 67990.8,-1076.49 67990.8,-1076.49"/>
<polygon fill="black" stroke="black" points="67994.3,-1076.49 67990.8,-1066.49 67987.3,-1076.49 67994.3,-1076.49"/>
</g>
<!-- L7_S0_TP4_GPU4_mha_ar -->
<g id="node811" class="node">
<title>L7_S0_TP4_GPU4_mha_ar</title>
<ellipse fill="none" stroke="black" cx="69028" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="69028" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="69028" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="69028" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="69028" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP0_GPU0_attn_v&#45;&gt;L7_S0_TP4_GPU4_mha_ar -->
<g id="edge2230" class="edge">
<title>L7_S0_TP0_GPU0_attn_v&#45;&gt;L7_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M65541.01,-1116.31C65541.01,-1060.43 65541.01,-956 65541.01,-956 65541.01,-956 68710.74,-956 68710.74,-956 68710.74,-956 68710.74,-996.66 68710.74,-996.66"/>
<polygon fill="black" stroke="black" points="68707.24,-996.66 68710.74,-1006.66 68714.24,-996.66 68707.24,-996.66"/>
</g>
<!-- L7_S0_TP5_GPU5_mha_ar -->
<g id="node820" class="node">
<title>L7_S0_TP5_GPU5_mha_ar</title>
<ellipse fill="none" stroke="black" cx="69797" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="69797" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="69797" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="69797" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="69797" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP0_GPU0_attn_v&#45;&gt;L7_S0_TP5_GPU5_mha_ar -->
<g id="edge2282" class="edge">
<title>L7_S0_TP0_GPU0_attn_v&#45;&gt;L7_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M65660.5,-1184.84C65660.5,-1198.03 65660.5,-1210 65660.5,-1210 65660.5,-1210 69603,-1210 69603,-1210 69603,-1210 69603,-1084.18 69603,-1084.18"/>
<polygon fill="black" stroke="black" points="69606.5,-1084.18 69603,-1074.18 69599.5,-1084.18 69606.5,-1084.18"/>
</g>
<!-- L7_S0_TP6_GPU6_mha_ar -->
<g id="node829" class="node">
<title>L7_S0_TP6_GPU6_mha_ar</title>
<ellipse fill="none" stroke="black" cx="70566" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="70566" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="70566" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="70566" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="70566" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP0_GPU0_attn_v&#45;&gt;L7_S0_TP6_GPU6_mha_ar -->
<g id="edge2334" class="edge">
<title>L7_S0_TP0_GPU0_attn_v&#45;&gt;L7_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M65712.58,-1116.44C65712.58,-1107.84 65712.58,-1101 65712.58,-1101 65712.58,-1101 70241.45,-1101 70241.45,-1101 70241.45,-1101 70241.45,-1066.9 70241.45,-1066.9"/>
<polygon fill="black" stroke="black" points="70244.95,-1066.9 70241.45,-1056.9 70237.95,-1066.9 70244.95,-1066.9"/>
</g>
<!-- L7_S0_TP7_GPU7_mha_ar -->
<g id="node838" class="node">
<title>L7_S0_TP7_GPU7_mha_ar</title>
<ellipse fill="none" stroke="black" cx="71335" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="71335" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="71335" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="71335" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="71335" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP0_GPU0_attn_v&#45;&gt;L7_S0_TP7_GPU7_mha_ar -->
<g id="edge2386" class="edge">
<title>L7_S0_TP0_GPU0_attn_v&#45;&gt;L7_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M65739.79,-1116.6C65739.79,-1108.42 65739.79,-1102 65739.79,-1102 65739.79,-1102 71027.46,-1102 71027.46,-1102 71027.46,-1102 71027.46,-1070.42 71027.46,-1070.42"/>
<polygon fill="black" stroke="black" points="71030.96,-1070.42 71027.46,-1060.42 71023.96,-1070.42 71030.96,-1070.42"/>
</g>
<!-- L7_S0_TP0_GPU0_mha_res -->
<g id="node743" class="node">
<title>L7_S0_TP0_GPU0_mha_res</title>
<polygon fill="none" stroke="black" points="65314.5,-948.5 64427.5,-948.5 64427.5,-880.5 65314.5,-880.5 65314.5,-948.5"/>
<text text-anchor="middle" x="64871" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="64871" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="64871" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="64871" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP0_GPU0_mha_ar&#45;&gt;L7_S0_TP0_GPU0_mha_res -->
<g id="edge2030" class="edge">
<title>L7_S0_TP0_GPU0_mha_ar&#45;&gt;L7_S0_TP0_GPU0_mha_res</title>
<path fill="none" stroke="black" d="M65599.36,-1016C65354.39,-1016 65071.75,-1016 65071.75,-1016 65071.75,-1016 65071.75,-958.58 65071.75,-958.58"/>
<polygon fill="black" stroke="black" points="65075.25,-958.58 65071.75,-948.58 65068.25,-958.58 65075.25,-958.58"/>
</g>
<!-- L7_S0_TP1_GPU1_attn_v -->
<g id="node736" class="node">
<title>L7_S0_TP1_GPU1_attn_v</title>
<polygon fill="none" stroke="black" points="66723,-1184.67 65785,-1184.67 65785,-1116.67 66723,-1116.67 66723,-1184.67"/>
<text text-anchor="middle" x="66254" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="66254" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="66254" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="66254" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L7_S0_TP1_GPU1_attn_v&#45;&gt;L7_S0_TP0_GPU0_mha_ar -->
<g id="edge2023" class="edge">
<title>L7_S0_TP1_GPU1_attn_v&#45;&gt;L7_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M65852.81,-1116.51C65852.81,-1116.51 65852.81,-1088.96 65852.81,-1088.96"/>
<polygon fill="black" stroke="black" points="65856.31,-1088.96 65852.81,-1078.96 65849.31,-1088.96 65856.31,-1088.96"/>
</g>
<!-- L7_S0_TP1_GPU1_attn_v&#45;&gt;L7_S0_TP1_GPU1_mha_ar -->
<g id="edge2075" class="edge">
<title>L7_S0_TP1_GPU1_attn_v&#45;&gt;L7_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M66439.89,-1116.51C66439.89,-1116.51 66439.89,-1074.64 66439.89,-1074.64"/>
<polygon fill="black" stroke="black" points="66443.39,-1074.64 66439.89,-1064.64 66436.39,-1074.64 66443.39,-1074.64"/>
</g>
<!-- L7_S0_TP1_GPU1_attn_v&#45;&gt;L7_S0_TP2_GPU2_mha_ar -->
<g id="edge2127" class="edge">
<title>L7_S0_TP1_GPU1_attn_v&#45;&gt;L7_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M66487.08,-1116.44C66487.08,-1099.65 66487.08,-1083 66487.08,-1083 66487.08,-1083 67239.96,-1083 67239.96,-1083 67239.96,-1083 67239.96,-1078.69 67239.96,-1078.69"/>
<polygon fill="black" stroke="black" points="67243.46,-1078.69 67239.96,-1068.69 67236.46,-1078.69 67243.46,-1078.69"/>
</g>
<!-- L7_S0_TP1_GPU1_attn_v&#45;&gt;L7_S0_TP3_GPU3_mha_ar -->
<g id="edge2179" class="edge">
<title>L7_S0_TP1_GPU1_attn_v&#45;&gt;L7_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M66534.26,-1116.44C66534.26,-1099.65 66534.26,-1083 66534.26,-1083 66534.26,-1083 68098.08,-1083 68098.08,-1083 68098.08,-1083 68098.08,-1082.34 68098.08,-1082.34"/>
<polygon fill="black" stroke="black" points="68101.58,-1086.41 68098.08,-1076.41 68094.58,-1086.41 68101.58,-1086.41"/>
</g>
<!-- L7_S0_TP1_GPU1_attn_v&#45;&gt;L7_S0_TP4_GPU4_mha_ar -->
<g id="edge2231" class="edge">
<title>L7_S0_TP1_GPU1_attn_v&#45;&gt;L7_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M66336.5,-1116.31C66336.5,-1060.43 66336.5,-956 66336.5,-956 66336.5,-956 68681.98,-956 68681.98,-956 68681.98,-956 68681.98,-1003.65 68681.98,-1003.65"/>
<polygon fill="black" stroke="black" points="68678.48,-1003.65 68681.98,-1013.65 68685.48,-1003.65 68678.48,-1003.65"/>
</g>
<!-- L7_S0_TP1_GPU1_attn_v&#45;&gt;L7_S0_TP5_GPU5_mha_ar -->
<g id="edge2283" class="edge">
<title>L7_S0_TP1_GPU1_attn_v&#45;&gt;L7_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M66581.45,-1116.44C66581.45,-1107.84 66581.45,-1101 66581.45,-1101 66581.45,-1101 69449.77,-1101 69449.77,-1101 69449.77,-1101 69449.77,-1060.92 69449.77,-1060.92"/>
<polygon fill="black" stroke="black" points="69453.27,-1060.92 69449.77,-1050.92 69446.27,-1060.92 69453.27,-1060.92"/>
</g>
<!-- L7_S0_TP1_GPU1_attn_v&#45;&gt;L7_S0_TP6_GPU6_mha_ar -->
<g id="edge2335" class="edge">
<title>L7_S0_TP1_GPU1_attn_v&#45;&gt;L7_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M66628.63,-1116.6C66628.63,-1108.42 66628.63,-1102 66628.63,-1102 66628.63,-1102 70292.38,-1102 70292.38,-1102 70292.38,-1102 70292.38,-1075.66 70292.38,-1075.66"/>
<polygon fill="black" stroke="black" points="70295.88,-1075.66 70292.38,-1065.66 70288.88,-1075.67 70295.88,-1075.66"/>
</g>
<!-- L7_S0_TP1_GPU1_attn_v&#45;&gt;L7_S0_TP7_GPU7_mha_ar -->
<g id="edge2387" class="edge">
<title>L7_S0_TP1_GPU1_attn_v&#45;&gt;L7_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M66675.82,-1116.6C66675.82,-1108.42 66675.82,-1102 66675.82,-1102 66675.82,-1102 71095.39,-1102 71095.39,-1102 71095.39,-1102 71095.39,-1079.73 71095.39,-1079.73"/>
<polygon fill="black" stroke="black" points="71098.89,-1079.73 71095.39,-1069.73 71091.89,-1079.73 71098.89,-1079.73"/>
</g>
<!-- L7_S0_TP2_GPU2_attn_v -->
<g id="node737" class="node">
<title>L7_S0_TP2_GPU2_attn_v</title>
<polygon fill="none" stroke="black" points="67679,-1184.67 66741,-1184.67 66741,-1116.67 67679,-1116.67 67679,-1184.67"/>
<text text-anchor="middle" x="67210" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="67210" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="67210" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="67210" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L7_S0_TP2_GPU2_attn_v&#45;&gt;L7_S0_TP0_GPU0_mha_ar -->
<g id="edge2024" class="edge">
<title>L7_S0_TP2_GPU2_attn_v&#45;&gt;L7_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M66800.25,-1116.53C66800.25,-1115.56 66800.25,-1115 66800.25,-1115 66800.25,-1115 65920.62,-1115 65920.62,-1115 65920.62,-1115 65920.62,-1090.53 65920.62,-1090.53"/>
<polygon fill="black" stroke="black" points="65924.12,-1090.53 65920.62,-1080.53 65917.12,-1090.53 65924.12,-1090.53"/>
</g>
<!-- L7_S0_TP2_GPU2_attn_v&#45;&gt;L7_S0_TP1_GPU1_mha_ar -->
<g id="edge2076" class="edge">
<title>L7_S0_TP2_GPU2_attn_v&#45;&gt;L7_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M66859.49,-1116.51C66859.49,-1116.51 66859.49,-1087.65 66859.49,-1087.65"/>
<polygon fill="black" stroke="black" points="66862.99,-1087.65 66859.49,-1077.65 66855.99,-1087.65 66862.99,-1087.65"/>
</g>
<!-- L7_S0_TP2_GPU2_attn_v&#45;&gt;L7_S0_TP2_GPU2_mha_ar -->
<g id="edge2128" class="edge">
<title>L7_S0_TP2_GPU2_attn_v&#45;&gt;L7_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M67302.68,-1116.51C67302.68,-1116.51 67302.68,-1084.63 67302.68,-1084.63"/>
<polygon fill="black" stroke="black" points="67306.18,-1084.63 67302.68,-1074.63 67299.18,-1084.63 67306.18,-1084.63"/>
</g>
<!-- L7_S0_TP2_GPU2_attn_v&#45;&gt;L7_S0_TP3_GPU3_mha_ar -->
<g id="edge2180" class="edge">
<title>L7_S0_TP2_GPU2_attn_v&#45;&gt;L7_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M67365.4,-1116.44C67365.4,-1099.65 67365.4,-1083 67365.4,-1083 67365.4,-1083 68205.36,-1083 68205.36,-1083 68205.36,-1083 68205.36,-1082.73 68205.36,-1082.73"/>
<polygon fill="black" stroke="black" points="68208.86,-1090.29 68205.36,-1080.29 68201.86,-1090.29 68208.86,-1090.29"/>
</g>
<!-- L7_S0_TP2_GPU2_attn_v&#45;&gt;L7_S0_TP4_GPU4_mha_ar -->
<g id="edge2232" class="edge">
<title>L7_S0_TP2_GPU2_attn_v&#45;&gt;L7_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M67428.12,-1116.6C67428.12,-1108.42 67428.12,-1102 67428.12,-1102 67428.12,-1102 68867.42,-1102 68867.42,-1102 68867.42,-1102 68867.42,-1086.15 68867.42,-1086.15"/>
<polygon fill="black" stroke="black" points="68870.92,-1086.15 68867.42,-1076.15 68863.92,-1086.15 68870.92,-1086.15"/>
</g>
<!-- L7_S0_TP2_GPU2_attn_v&#45;&gt;L7_S0_TP5_GPU5_mha_ar -->
<g id="edge2284" class="edge">
<title>L7_S0_TP2_GPU2_attn_v&#45;&gt;L7_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M67490.84,-1116.6C67490.84,-1108.42 67490.84,-1102 67490.84,-1102 67490.84,-1102 69478.02,-1102 69478.02,-1102 69478.02,-1102 69478.02,-1068.04 69478.02,-1068.04"/>
<polygon fill="black" stroke="black" points="69481.52,-1068.04 69478.02,-1058.04 69474.52,-1068.04 69481.52,-1068.04"/>
</g>
<!-- L7_S0_TP2_GPU2_attn_v&#45;&gt;L7_S0_TP6_GPU6_mha_ar -->
<g id="edge2336" class="edge">
<title>L7_S0_TP2_GPU2_attn_v&#45;&gt;L7_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M67553.56,-1116.6C67553.56,-1108.42 67553.56,-1102 67553.56,-1102 67553.56,-1102 70343.3,-1102 70343.3,-1102 70343.3,-1102 70343.3,-1081.35 70343.3,-1081.35"/>
<polygon fill="black" stroke="black" points="70346.8,-1081.35 70343.3,-1071.35 70339.8,-1081.35 70346.8,-1081.35"/>
</g>
<!-- L7_S0_TP2_GPU2_attn_v&#45;&gt;L7_S0_TP7_GPU7_mha_ar -->
<g id="edge2388" class="edge">
<title>L7_S0_TP2_GPU2_attn_v&#45;&gt;L7_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M67616.28,-1116.6C67616.28,-1108.42 67616.28,-1102 67616.28,-1102 67616.28,-1102 71163.33,-1102 71163.33,-1102 71163.33,-1102 71163.33,-1085.36 71163.33,-1085.36"/>
<polygon fill="black" stroke="black" points="71166.83,-1085.36 71163.33,-1075.36 71159.83,-1085.36 71166.83,-1085.36"/>
</g>
<!-- L7_S0_TP3_GPU3_attn_v -->
<g id="node738" class="node">
<title>L7_S0_TP3_GPU3_attn_v</title>
<polygon fill="none" stroke="black" points="68635,-1184.67 67697,-1184.67 67697,-1116.67 68635,-1116.67 68635,-1184.67"/>
<text text-anchor="middle" x="68166" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="68166" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="68166" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="68166" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L7_S0_TP3_GPU3_attn_v&#45;&gt;L7_S0_TP0_GPU0_mha_ar -->
<g id="edge2025" class="edge">
<title>L7_S0_TP3_GPU3_attn_v&#45;&gt;L7_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M67730.69,-1116.53C67730.69,-1115.56 67730.69,-1115 67730.69,-1115 67730.69,-1115 65988.43,-1115 65988.43,-1115 65988.43,-1115 65988.43,-1090.53 65988.43,-1090.53"/>
<polygon fill="black" stroke="black" points="65991.93,-1090.53 65988.43,-1080.53 65984.93,-1090.53 65991.93,-1090.53"/>
</g>
<!-- L7_S0_TP3_GPU3_attn_v&#45;&gt;L7_S0_TP1_GPU1_mha_ar -->
<g id="edge2077" class="edge">
<title>L7_S0_TP3_GPU3_attn_v&#45;&gt;L7_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M67764.39,-1116.41C67764.39,-1114.9 67764.39,-1114 67764.39,-1114 67764.39,-1114 66918.74,-1114 66918.74,-1114 66918.74,-1114 66918.74,-1083.77 66918.74,-1083.77"/>
<polygon fill="black" stroke="black" points="66922.24,-1083.77 66918.74,-1073.77 66915.24,-1083.77 66922.24,-1083.77"/>
</g>
<!-- L7_S0_TP3_GPU3_attn_v&#45;&gt;L7_S0_TP2_GPU2_mha_ar -->
<g id="edge2129" class="edge">
<title>L7_S0_TP3_GPU3_attn_v&#45;&gt;L7_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M67798.08,-1116.51C67798.08,-1116.51 67798.08,-1070.31 67798.08,-1070.31"/>
<polygon fill="black" stroke="black" points="67801.58,-1070.31 67798.08,-1060.31 67794.58,-1070.31 67801.58,-1070.31"/>
</g>
<!-- L7_S0_TP3_GPU3_attn_v&#45;&gt;L7_S0_TP3_GPU3_mha_ar -->
<g id="edge2181" class="edge">
<title>L7_S0_TP3_GPU3_attn_v&#45;&gt;L7_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M68312.64,-1116.51C68312.64,-1116.51 68312.64,-1090.27 68312.64,-1090.27"/>
<polygon fill="black" stroke="black" points="68316.14,-1090.27 68312.64,-1080.27 68309.14,-1090.27 68316.14,-1090.27"/>
</g>
<!-- L7_S0_TP3_GPU3_attn_v&#45;&gt;L7_S0_TP4_GPU4_mha_ar -->
<g id="edge2233" class="edge">
<title>L7_S0_TP3_GPU3_attn_v&#45;&gt;L7_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M68635.06,-1139C68638.75,-1139 68640.72,-1139 68640.72,-1139 68640.72,-1139 68640.72,-1016 68640.72,-1016 68640.72,-1016 68665.43,-1016 68665.43,-1016"/>
<polygon fill="black" stroke="black" points="68665.43,-1019.5 68675.43,-1016 68665.43,-1012.5 68665.43,-1019.5"/>
</g>
<!-- L7_S0_TP3_GPU3_attn_v&#45;&gt;L7_S0_TP5_GPU5_mha_ar -->
<g id="edge2285" class="edge">
<title>L7_S0_TP3_GPU3_attn_v&#45;&gt;L7_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M68586,-1185.05C68586,-1186.28 68586,-1187 68586,-1187 68586,-1187 69597,-1187 69597,-1187 69597,-1187 69597,-1083.56 69597,-1083.56"/>
<polygon fill="black" stroke="black" points="69600.5,-1083.56 69597,-1073.56 69593.5,-1083.56 69600.5,-1083.56"/>
</g>
<!-- L7_S0_TP3_GPU3_attn_v&#45;&gt;L7_S0_TP6_GPU6_mha_ar -->
<g id="edge2337" class="edge">
<title>L7_S0_TP3_GPU3_attn_v&#45;&gt;L7_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M68537,-1185.03C68537,-1191.35 68537,-1196 68537,-1196 68537,-1196 70556,-1196 70556,-1196 70556,-1196 70556,-1090.73 70556,-1090.73"/>
<polygon fill="black" stroke="black" points="70559.5,-1090.73 70556,-1080.73 70552.5,-1090.73 70559.5,-1090.73"/>
</g>
<!-- L7_S0_TP3_GPU3_attn_v&#45;&gt;L7_S0_TP7_GPU7_mha_ar -->
<g id="edge2389" class="edge">
<title>L7_S0_TP3_GPU3_attn_v&#45;&gt;L7_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M68419.92,-1116.6C68419.92,-1108.42 68419.92,-1102 68419.92,-1102 68419.92,-1102 71231.26,-1102 71231.26,-1102 71231.26,-1102 71231.26,-1088.89 71231.26,-1088.89"/>
<polygon fill="black" stroke="black" points="71234.76,-1088.89 71231.26,-1078.89 71227.76,-1088.89 71234.76,-1088.89"/>
</g>
<!-- L7_S0_TP4_GPU4_attn_v -->
<g id="node739" class="node">
<title>L7_S0_TP4_GPU4_attn_v</title>
<polygon fill="none" stroke="black" points="69591,-1184.67 68653,-1184.67 68653,-1116.67 69591,-1116.67 69591,-1184.67"/>
<text text-anchor="middle" x="69122" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="69122" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="69122" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="69122" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L7_S0_TP4_GPU4_attn_v&#45;&gt;L7_S0_TP0_GPU0_mha_ar -->
<g id="edge2026" class="edge">
<title>L7_S0_TP4_GPU4_attn_v&#45;&gt;L7_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M68760.21,-1116.6C68760.21,-1108.42 68760.21,-1102 68760.21,-1102 68760.21,-1102 66056.24,-1102 66056.24,-1102 66056.24,-1102 66056.24,-1088.89 66056.24,-1088.89"/>
<polygon fill="black" stroke="black" points="66059.74,-1088.89 66056.24,-1078.89 66052.74,-1088.89 66059.74,-1088.89"/>
</g>
<!-- L7_S0_TP4_GPU4_attn_v&#45;&gt;L7_S0_TP1_GPU1_mha_ar -->
<g id="edge2078" class="edge">
<title>L7_S0_TP4_GPU4_attn_v&#45;&gt;L7_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M68729.33,-1184.93C68729.33,-1193.35 68729.33,-1200 68729.33,-1200 68729.33,-1200 66732,-1200 66732,-1200 66732,-1200 66732,-1091.01 66732,-1091.01"/>
<polygon fill="black" stroke="black" points="66735.5,-1091.01 66732,-1081.01 66728.5,-1091.01 66735.5,-1091.01"/>
</g>
<!-- L7_S0_TP4_GPU4_attn_v&#45;&gt;L7_S0_TP2_GPU2_mha_ar -->
<g id="edge2130" class="edge">
<title>L7_S0_TP4_GPU4_attn_v&#45;&gt;L7_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M68691.17,-1184.7C68691.17,-1188.48 68691.17,-1191 68691.17,-1191 68691.17,-1191 67692.5,-1191 67692.5,-1191 67692.5,-1191 67692.5,-1083.38 67692.5,-1083.38"/>
<polygon fill="black" stroke="black" points="67696,-1083.38 67692.5,-1073.38 67689,-1083.38 67696,-1083.38"/>
</g>
<!-- L7_S0_TP4_GPU4_attn_v&#45;&gt;L7_S0_TP3_GPU3_mha_ar -->
<g id="edge2182" class="edge">
<title>L7_S0_TP4_GPU4_attn_v&#45;&gt;L7_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M68652.84,-1161C68643.54,-1161 68638.36,-1161 68638.36,-1161 68638.36,-1161 68638.36,-1048 68638.36,-1048 68638.36,-1048 68624.92,-1048 68624.92,-1048"/>
<polygon fill="black" stroke="black" points="68624.92,-1044.5 68614.92,-1048 68624.92,-1051.5 68624.92,-1044.5"/>
</g>
<!-- L7_S0_TP4_GPU4_attn_v&#45;&gt;L7_S0_TP4_GPU4_mha_ar -->
<g id="edge2234" class="edge">
<title>L7_S0_TP4_GPU4_attn_v&#45;&gt;L7_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M68974.63,-1116.51C68974.63,-1116.51 68974.63,-1090.27 68974.63,-1090.27"/>
<polygon fill="black" stroke="black" points="68978.13,-1090.27 68974.63,-1080.27 68971.13,-1090.27 68978.13,-1090.27"/>
</g>
<!-- L7_S0_TP4_GPU4_attn_v&#45;&gt;L7_S0_TP5_GPU5_mha_ar -->
<g id="edge2286" class="edge">
<title>L7_S0_TP4_GPU4_attn_v&#45;&gt;L7_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M69506.26,-1116.51C69506.26,-1116.51 69506.26,-1073.04 69506.26,-1073.04"/>
<polygon fill="black" stroke="black" points="69509.76,-1073.04 69506.26,-1063.04 69502.76,-1073.04 69509.76,-1073.04"/>
</g>
<!-- L7_S0_TP4_GPU4_attn_v&#45;&gt;L7_S0_TP6_GPU6_mha_ar -->
<g id="edge2338" class="edge">
<title>L7_S0_TP4_GPU4_attn_v&#45;&gt;L7_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M69534.51,-1116.53C69534.51,-1108.89 69534.51,-1103 69534.51,-1103 69534.51,-1103 70394.23,-1103 70394.23,-1103 70394.23,-1103 70394.23,-1085.57 70394.23,-1085.57"/>
<polygon fill="black" stroke="black" points="70397.73,-1085.57 70394.23,-1075.57 70390.73,-1085.57 70397.73,-1085.57"/>
</g>
<!-- L7_S0_TP4_GPU4_attn_v&#45;&gt;L7_S0_TP7_GPU7_mha_ar -->
<g id="edge2390" class="edge">
<title>L7_S0_TP4_GPU4_attn_v&#45;&gt;L7_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M69562.75,-1116.53C69562.75,-1108.89 69562.75,-1103 69562.75,-1103 69562.75,-1103 71299.2,-1103 71299.2,-1103 71299.2,-1103 71299.2,-1090.72 71299.2,-1090.72"/>
<polygon fill="black" stroke="black" points="71302.7,-1090.72 71299.2,-1080.72 71295.7,-1090.72 71302.7,-1090.72"/>
</g>
<!-- L7_S0_TP5_GPU5_attn_v -->
<g id="node740" class="node">
<title>L7_S0_TP5_GPU5_attn_v</title>
<polygon fill="none" stroke="black" points="70547,-1184.67 69609,-1184.67 69609,-1116.67 70547,-1116.67 70547,-1184.67"/>
<text text-anchor="middle" x="70078" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="70078" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="70078" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="70078" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L7_S0_TP5_GPU5_attn_v&#45;&gt;L7_S0_TP0_GPU0_mha_ar -->
<g id="edge2027" class="edge">
<title>L7_S0_TP5_GPU5_attn_v&#45;&gt;L7_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M69679.43,-1116.6C69679.43,-1108.42 69679.43,-1102 69679.43,-1102 69679.43,-1102 66124.05,-1102 66124.05,-1102 66124.05,-1102 66124.05,-1085.36 66124.05,-1085.36"/>
<polygon fill="black" stroke="black" points="66127.55,-1085.36 66124.05,-1075.36 66120.55,-1085.36 66127.55,-1085.36"/>
</g>
<!-- L7_S0_TP5_GPU5_attn_v&#45;&gt;L7_S0_TP1_GPU1_mha_ar -->
<g id="edge2079" class="edge">
<title>L7_S0_TP5_GPU5_attn_v&#45;&gt;L7_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M69749.87,-1116.6C69749.87,-1108.42 69749.87,-1102 69749.87,-1102 69749.87,-1102 66977.98,-1102 66977.98,-1102 66977.98,-1102 66977.98,-1077.7 66977.98,-1077.7"/>
<polygon fill="black" stroke="black" points="66981.48,-1077.7 66977.98,-1067.7 66974.48,-1077.7 66981.48,-1077.7"/>
</g>
<!-- L7_S0_TP5_GPU5_attn_v&#45;&gt;L7_S0_TP2_GPU2_mha_ar -->
<g id="edge2131" class="edge">
<title>L7_S0_TP5_GPU5_attn_v&#45;&gt;L7_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M69686.25,-1184.74C69686.25,-1196.6 69686.25,-1207 69686.25,-1207 69686.25,-1207 67688,-1207 67688,-1207 67688,-1207 67688,-1083.48 67688,-1083.48"/>
<polygon fill="black" stroke="black" points="67691.5,-1083.48 67688,-1073.48 67684.5,-1083.48 67691.5,-1083.48"/>
</g>
<!-- L7_S0_TP5_GPU5_attn_v&#45;&gt;L7_S0_TP3_GPU3_mha_ar -->
<g id="edge2183" class="edge">
<title>L7_S0_TP5_GPU5_attn_v&#45;&gt;L7_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M69820.3,-1116.6C69820.3,-1108.42 69820.3,-1102 69820.3,-1102 69820.3,-1102 68527.2,-1102 68527.2,-1102 68527.2,-1102 68527.2,-1076.48 68527.2,-1076.48"/>
<polygon fill="black" stroke="black" points="68530.7,-1076.48 68527.2,-1066.48 68523.7,-1076.48 68530.7,-1076.48"/>
</g>
<!-- L7_S0_TP5_GPU5_attn_v&#45;&gt;L7_S0_TP4_GPU4_mha_ar -->
<g id="edge2235" class="edge">
<title>L7_S0_TP5_GPU5_attn_v&#45;&gt;L7_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M69890.74,-1116.59C69890.74,-1102.32 69890.74,-1089 69890.74,-1089 69890.74,-1089 69081.84,-1089 69081.84,-1089 69081.84,-1089 69081.84,-1088.12 69081.84,-1088.12"/>
<polygon fill="black" stroke="black" points="69085.34,-1090.18 69081.84,-1080.18 69078.34,-1090.18 69085.34,-1090.18"/>
</g>
<!-- L7_S0_TP5_GPU5_attn_v&#45;&gt;L7_S0_TP5_GPU5_mha_ar -->
<g id="edge2287" class="edge">
<title>L7_S0_TP5_GPU5_attn_v&#45;&gt;L7_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M69961.17,-1116.51C69961.17,-1116.51 69961.17,-1085.92 69961.17,-1085.92"/>
<polygon fill="black" stroke="black" points="69964.67,-1085.92 69961.17,-1075.92 69957.67,-1085.92 69964.67,-1085.92"/>
</g>
<!-- L7_S0_TP5_GPU5_attn_v&#45;&gt;L7_S0_TP6_GPU6_mha_ar -->
<g id="edge2339" class="edge">
<title>L7_S0_TP5_GPU5_attn_v&#45;&gt;L7_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M70445.15,-1116.51C70445.15,-1116.51 70445.15,-1088.52 70445.15,-1088.52"/>
<polygon fill="black" stroke="black" points="70448.65,-1088.52 70445.15,-1078.52 70441.65,-1088.52 70448.65,-1088.52"/>
</g>
<!-- L7_S0_TP5_GPU5_attn_v&#45;&gt;L7_S0_TP7_GPU7_mha_ar -->
<g id="edge2391" class="edge">
<title>L7_S0_TP5_GPU5_attn_v&#45;&gt;L7_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M70496.08,-1116.53C70496.08,-1108.89 70496.08,-1103 70496.08,-1103 70496.08,-1103 71367.13,-1103 71367.13,-1103 71367.13,-1103 71367.13,-1090.72 71367.13,-1090.72"/>
<polygon fill="black" stroke="black" points="71370.63,-1090.72 71367.13,-1080.72 71363.63,-1090.72 71370.63,-1090.72"/>
</g>
<!-- L7_S0_TP6_GPU6_attn_v -->
<g id="node741" class="node">
<title>L7_S0_TP6_GPU6_attn_v</title>
<polygon fill="none" stroke="black" points="71503,-1184.67 70565,-1184.67 70565,-1116.67 71503,-1116.67 71503,-1184.67"/>
<text text-anchor="middle" x="71034" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="71034" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="71034" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="71034" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L7_S0_TP6_GPU6_attn_v&#45;&gt;L7_S0_TP0_GPU0_mha_ar -->
<g id="edge2028" class="edge">
<title>L7_S0_TP6_GPU6_attn_v&#45;&gt;L7_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M70612.06,-1116.6C70612.06,-1108.42 70612.06,-1102 70612.06,-1102 70612.06,-1102 66191.86,-1102 66191.86,-1102 66191.86,-1102 66191.86,-1079.73 66191.86,-1079.73"/>
<polygon fill="black" stroke="black" points="66195.36,-1079.73 66191.86,-1069.73 66188.36,-1079.73 66195.36,-1079.73"/>
</g>
<!-- L7_S0_TP6_GPU6_attn_v&#45;&gt;L7_S0_TP1_GPU1_mha_ar -->
<g id="edge2080" class="edge">
<title>L7_S0_TP6_GPU6_attn_v&#45;&gt;L7_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M70659.12,-1116.6C70659.12,-1108.42 70659.12,-1102 70659.12,-1102 70659.12,-1102 67037.23,-1102 67037.23,-1102 67037.23,-1102 67037.23,-1068.83 67037.23,-1068.83"/>
<polygon fill="black" stroke="black" points="67040.73,-1068.83 67037.23,-1058.83 67033.73,-1068.83 67040.73,-1068.83"/>
</g>
<!-- L7_S0_TP6_GPU6_attn_v&#45;&gt;L7_S0_TP2_GPU2_mha_ar -->
<g id="edge2132" class="edge">
<title>L7_S0_TP6_GPU6_attn_v&#45;&gt;L7_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M70706.18,-1116.6C70706.18,-1108.42 70706.18,-1102 70706.18,-1102 70706.18,-1102 67831.78,-1102 67831.78,-1102 67831.78,-1102 67831.78,-1062.66 67831.78,-1062.66"/>
<polygon fill="black" stroke="black" points="67835.28,-1062.66 67831.78,-1052.66 67828.28,-1062.66 67835.28,-1062.66"/>
</g>
<!-- L7_S0_TP6_GPU6_attn_v&#45;&gt;L7_S0_TP3_GPU3_mha_ar -->
<g id="edge2184" class="edge">
<title>L7_S0_TP6_GPU6_attn_v&#45;&gt;L7_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M70950.5,-1116.6C70950.5,-1065.27 70950.5,-974 70950.5,-974 70950.5,-974 68605.82,-974 68605.82,-974 68605.82,-974 68605.82,-1004.05 68605.82,-1004.05"/>
<polygon fill="black" stroke="black" points="68602.32,-1004.05 68605.82,-1014.05 68609.32,-1004.05 68602.32,-1004.05"/>
</g>
<!-- L7_S0_TP6_GPU6_attn_v&#45;&gt;L7_S0_TP4_GPU4_mha_ar -->
<g id="edge2236" class="edge">
<title>L7_S0_TP6_GPU6_attn_v&#45;&gt;L7_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M70753.24,-1116.59C70753.24,-1102.32 70753.24,-1089 70753.24,-1089 70753.24,-1089 69189.05,-1089 69189.05,-1089 69189.05,-1089 69189.05,-1086.2 69189.05,-1086.2"/>
<polygon fill="black" stroke="black" points="69192.55,-1086.2 69189.05,-1076.2 69185.55,-1086.2 69192.55,-1086.2"/>
</g>
<!-- L7_S0_TP6_GPU6_attn_v&#45;&gt;L7_S0_TP5_GPU5_mha_ar -->
<g id="edge2288" class="edge">
<title>L7_S0_TP6_GPU6_attn_v&#45;&gt;L7_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M70800.3,-1116.59C70800.3,-1102.32 70800.3,-1089 70800.3,-1089 70800.3,-1089 70031.61,-1089 70031.61,-1089 70031.61,-1089 70031.61,-1080.21 70031.61,-1080.21"/>
<polygon fill="black" stroke="black" points="70035.11,-1080.21 70031.61,-1070.21 70028.11,-1080.21 70035.11,-1080.21"/>
</g>
<!-- L7_S0_TP6_GPU6_attn_v&#45;&gt;L7_S0_TP6_GPU6_mha_ar -->
<g id="edge2340" class="edge">
<title>L7_S0_TP6_GPU6_attn_v&#45;&gt;L7_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M70847.36,-1116.51C70847.36,-1116.51 70847.36,-1074.64 70847.36,-1074.64"/>
<polygon fill="black" stroke="black" points="70850.86,-1074.64 70847.36,-1064.64 70843.86,-1074.64 70850.86,-1074.64"/>
</g>
<!-- L7_S0_TP6_GPU6_attn_v&#45;&gt;L7_S0_TP7_GPU7_mha_ar -->
<g id="edge2392" class="edge">
<title>L7_S0_TP6_GPU6_attn_v&#45;&gt;L7_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M71435.07,-1116.51C71435.07,-1116.51 71435.07,-1088.96 71435.07,-1088.96"/>
<polygon fill="black" stroke="black" points="71438.57,-1088.96 71435.07,-1078.96 71431.57,-1088.96 71438.57,-1088.96"/>
</g>
<!-- L7_S0_TP7_GPU7_attn_v -->
<g id="node742" class="node">
<title>L7_S0_TP7_GPU7_attn_v</title>
<polygon fill="none" stroke="black" points="72459,-1184.67 71521,-1184.67 71521,-1116.67 72459,-1116.67 72459,-1184.67"/>
<text text-anchor="middle" x="71990" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="71990" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="71990" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="71990" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L7_S0_TP7_GPU7_attn_v&#45;&gt;L7_S0_TP0_GPU0_mha_ar -->
<g id="edge2029" class="edge">
<title>L7_S0_TP7_GPU7_attn_v&#45;&gt;L7_S0_TP0_GPU0_mha_ar</title>
<path fill="none" stroke="black" d="M71552.58,-1116.6C71552.58,-1108.42 71552.58,-1102 71552.58,-1102 71552.58,-1102 66259.66,-1102 66259.66,-1102 66259.66,-1102 66259.66,-1070.42 66259.66,-1070.42"/>
<polygon fill="black" stroke="black" points="66263.16,-1070.42 66259.66,-1060.42 66256.16,-1070.42 66263.16,-1070.42"/>
</g>
<!-- L7_S0_TP7_GPU7_attn_v&#45;&gt;L7_S0_TP1_GPU1_mha_ar -->
<g id="edge2081" class="edge">
<title>L7_S0_TP7_GPU7_attn_v&#45;&gt;L7_S0_TP1_GPU1_mha_ar</title>
<path fill="none" stroke="black" d="M71758.49,-1116.41C71758.49,-1064.78 71758.49,-973 71758.49,-973 71758.49,-973 66839.99,-973 66839.99,-973 66839.99,-973 66839.99,-976.82 66839.99,-976.82"/>
<polygon fill="black" stroke="black" points="66836.49,-976.82 66839.99,-986.82 66843.49,-976.82 66836.49,-976.82"/>
</g>
<!-- L7_S0_TP7_GPU7_attn_v&#45;&gt;L7_S0_TP2_GPU2_mha_ar -->
<g id="edge2133" class="edge">
<title>L7_S0_TP7_GPU7_attn_v&#45;&gt;L7_S0_TP2_GPU2_mha_ar</title>
<path fill="none" stroke="black" d="M71661.25,-1184.93C71661.25,-1199.85 71661.25,-1214 71661.25,-1214 71661.25,-1214 67683.5,-1214 67683.5,-1214 67683.5,-1214 67683.5,-1084.2 67683.5,-1084.2"/>
<polygon fill="black" stroke="black" points="67687,-1084.2 67683.5,-1074.2 67680,-1084.2 67687,-1084.2"/>
</g>
<!-- L7_S0_TP7_GPU7_attn_v&#45;&gt;L7_S0_TP3_GPU3_mha_ar -->
<g id="edge2185" class="edge">
<title>L7_S0_TP7_GPU7_attn_v&#45;&gt;L7_S0_TP3_GPU3_mha_ar</title>
<path fill="none" stroke="black" d="M71734.48,-1116.6C71734.48,-1065.27 71734.48,-974 71734.48,-974 71734.48,-974 68577.16,-974 68577.16,-974 68577.16,-974 68577.16,-996.72 68577.16,-996.72"/>
<polygon fill="black" stroke="black" points="68573.66,-996.72 68577.16,-1006.72 68580.66,-996.72 68573.66,-996.72"/>
</g>
<!-- L7_S0_TP7_GPU7_attn_v&#45;&gt;L7_S0_TP4_GPU4_mha_ar -->
<g id="edge2237" class="edge">
<title>L7_S0_TP7_GPU7_attn_v&#45;&gt;L7_S0_TP4_GPU4_mha_ar</title>
<path fill="none" stroke="black" d="M71584.16,-1116.59C71584.16,-1102.32 71584.16,-1089 71584.16,-1089 71584.16,-1089 69296.26,-1089 69296.26,-1089 69296.26,-1089 69296.26,-1076.38 69296.26,-1076.38"/>
<polygon fill="black" stroke="black" points="69299.76,-1076.38 69296.26,-1066.38 69292.76,-1076.38 69299.76,-1076.38"/>
</g>
<!-- L7_S0_TP7_GPU7_attn_v&#45;&gt;L7_S0_TP5_GPU5_mha_ar -->
<g id="edge2289" class="edge">
<title>L7_S0_TP7_GPU7_attn_v&#45;&gt;L7_S0_TP5_GPU5_mha_ar</title>
<path fill="none" stroke="black" d="M71615.74,-1116.59C71615.74,-1102.32 71615.74,-1089 71615.74,-1089 71615.74,-1089 70102.04,-1089 70102.04,-1089 70102.04,-1089 70102.04,-1070.79 70102.04,-1070.79"/>
<polygon fill="black" stroke="black" points="70105.54,-1070.79 70102.04,-1060.79 70098.54,-1070.79 70105.54,-1070.79"/>
</g>
<!-- L7_S0_TP7_GPU7_attn_v&#45;&gt;L7_S0_TP6_GPU6_mha_ar -->
<g id="edge2341" class="edge">
<title>L7_S0_TP7_GPU7_attn_v&#45;&gt;L7_S0_TP6_GPU6_mha_ar</title>
<path fill="none" stroke="black" d="M71647.32,-1116.59C71647.32,-1102.32 71647.32,-1089 71647.32,-1089 71647.32,-1089 70894.41,-1089 70894.41,-1089 70894.41,-1089 70894.41,-1066.18 70894.41,-1066.18"/>
<polygon fill="black" stroke="black" points="70897.91,-1066.18 70894.41,-1056.18 70890.91,-1066.18 70897.91,-1066.18"/>
</g>
<!-- L7_S0_TP7_GPU7_attn_v&#45;&gt;L7_S0_TP7_GPU7_mha_ar -->
<g id="edge2393" class="edge">
<title>L7_S0_TP7_GPU7_attn_v&#45;&gt;L7_S0_TP7_GPU7_mha_ar</title>
<path fill="none" stroke="black" d="M71678.89,-1116.51C71678.89,-1116.51 71678.89,-1061.95 71678.89,-1061.95"/>
<polygon fill="black" stroke="black" points="71682.39,-1061.95 71678.89,-1051.95 71675.39,-1061.95 71682.39,-1061.95"/>
</g>
<!-- L7_S0_TP0_GPU0_gate -->
<g id="node744" class="node">
<title>L7_S0_TP0_GPU0_gate</title>
<polygon fill="none" stroke="black" points="65400.56,-844.5 64558.15,-844.5 64341.44,-708.5 65183.85,-708.5 65400.56,-844.5"/>
<text text-anchor="middle" x="64871" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="64871" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="64871" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="64871" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L7_S0_TP0_GPU0_mha_res&#45;&gt;L7_S0_TP0_GPU0_gate -->
<g id="edge2031" class="edge">
<title>L7_S0_TP0_GPU0_mha_res&#45;&gt;L7_S0_TP0_GPU0_gate</title>
<path fill="none" stroke="black" d="M64871,-880.39C64871,-880.39 64871,-854.73 64871,-854.73"/>
<polygon fill="black" stroke="black" points="64874.5,-854.73 64871,-844.73 64867.5,-854.73 64874.5,-854.73"/>
</g>
<!-- L7_S0_TP0_GPU0_moe_res -->
<g id="node762" class="node">
<title>L7_S0_TP0_GPU0_moe_res</title>
<polygon fill="none" stroke="black" points="66122,-436.33 65302,-436.33 65302,-368.33 66122,-368.33 66122,-436.33"/>
<text text-anchor="middle" x="65712" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="65712" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="65712" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="65712" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP0_GPU0_mha_res&#45;&gt;L7_S0_TP0_GPU0_moe_res -->
<g id="edge2051" class="edge">
<title>L7_S0_TP0_GPU0_mha_res&#45;&gt;L7_S0_TP0_GPU0_moe_res</title>
<path fill="none" stroke="black" d="M65314.57,-914C65371.27,-914 65410,-914 65410,-914 65410,-914 65410,-698 65410,-698 65410,-698 65375.5,-698 65375.5,-698 65375.5,-698 65375.5,-446.54 65375.5,-446.54"/>
<polygon fill="black" stroke="black" points="65379,-446.54 65375.5,-436.54 65372,-446.54 65379,-446.54"/>
</g>
<!-- L7_S0_TP0_GPU0_expert0 -->
<g id="node745" class="node">
<title>L7_S0_TP0_GPU0_expert0</title>
<polygon fill="none" stroke="black" points="65366.5,-672.5 64917.5,-672.5 64917.5,-604.5 65366.5,-604.5 65366.5,-672.5"/>
<text text-anchor="middle" x="65142" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="65142" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="65142" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="65142" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L7_S0_TP0_GPU0_gate&#45;&gt;L7_S0_TP0_GPU0_expert0 -->
<g id="edge2032" class="edge">
<title>L7_S0_TP0_GPU0_gate&#45;&gt;L7_S0_TP0_GPU0_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M65142,-708.31C65142,-708.31 65142,-682.71 65142,-682.71"/>
<polygon fill="black" stroke="black" points="65145.5,-682.71 65142,-672.71 65138.5,-682.71 65145.5,-682.71"/>
</g>
<!-- L7_S0_TP0_GPU0_expert1 -->
<g id="node746" class="node">
<title>L7_S0_TP0_GPU0_expert1</title>
<polygon fill="none" stroke="black" points="65833.5,-672.5 65384.5,-672.5 65384.5,-604.5 65833.5,-604.5 65833.5,-672.5"/>
<text text-anchor="middle" x="65609" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="65609" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="65609" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="65609" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- L7_S0_TP0_GPU0_gate&#45;&gt;L7_S0_TP0_GPU0_expert1 -->
<g id="edge2033" class="edge">
<title>L7_S0_TP0_GPU0_gate&#45;&gt;L7_S0_TP0_GPU0_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M65392.64,-776.4C65392.64,-776.4 65392.64,-682.74 65392.64,-682.74"/>
<polygon fill="black" stroke="black" points="65396.14,-682.74 65392.64,-672.74 65389.14,-682.74 65396.14,-682.74"/>
</g>
<!-- L7_S0_TP0_GPU0_moe_ar -->
<g id="node747" class="node">
<title>L7_S0_TP0_GPU0_moe_ar</title>
<ellipse fill="none" stroke="black" cx="66240" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="66240" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="66240" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="66240" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="66240" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP0_GPU0_expert0&#45;&gt;L7_S0_TP0_GPU0_moe_ar -->
<g id="edge2034" class="edge">
<title>L7_S0_TP0_GPU0_expert0&#45;&gt;L7_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M65359.33,-604.35C65359.33,-559.95 65359.33,-488 65359.33,-488 65359.33,-488 65982.93,-488 65982.93,-488"/>
<polygon fill="black" stroke="black" points="65982.93,-491.5 65992.93,-488 65982.93,-484.5 65982.93,-491.5"/>
</g>
<!-- L7_S0_TP1_GPU1_moe_ar -->
<g id="node787" class="node">
<title>L7_S0_TP1_GPU1_moe_ar</title>
<ellipse fill="none" stroke="black" cx="66927" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="66927" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="66927" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="66927" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="66927" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP0_GPU0_expert0&#45;&gt;L7_S0_TP1_GPU1_moe_ar -->
<g id="edge2086" class="edge">
<title>L7_S0_TP0_GPU0_expert0&#45;&gt;L7_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M65352.17,-604.48C65352.17,-597.9 65352.17,-593 65352.17,-593 65352.17,-593 66610.03,-593 66610.03,-593 66610.03,-593 66610.03,-545.81 66610.03,-545.81"/>
<polygon fill="black" stroke="black" points="66613.53,-545.81 66610.03,-535.81 66606.53,-545.81 66613.53,-545.81"/>
</g>
<!-- L7_S0_TP2_GPU2_moe_ar -->
<g id="node796" class="node">
<title>L7_S0_TP2_GPU2_moe_ar</title>
<ellipse fill="none" stroke="black" cx="67614" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="67614" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="67614" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="67614" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="67614" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP0_GPU0_expert0&#45;&gt;L7_S0_TP2_GPU2_moe_ar -->
<g id="edge2138" class="edge">
<title>L7_S0_TP0_GPU0_expert0&#45;&gt;L7_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M65345,-604.31C65345,-552.23 65345,-459 65345,-459 65345,-459 67452.36,-459 67452.36,-459 67452.36,-459 67452.36,-468.1 67452.36,-468.1"/>
<polygon fill="black" stroke="black" points="67448.86,-468.1 67452.36,-478.1 67455.86,-468.1 67448.86,-468.1"/>
</g>
<!-- L7_S0_TP3_GPU3_moe_ar -->
<g id="node805" class="node">
<title>L7_S0_TP3_GPU3_moe_ar</title>
<ellipse fill="none" stroke="black" cx="68301" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="68301" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="68301" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="68301" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="68301" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP0_GPU0_expert0&#45;&gt;L7_S0_TP3_GPU3_moe_ar -->
<g id="edge2190" class="edge">
<title>L7_S0_TP0_GPU0_expert0&#45;&gt;L7_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M65337.83,-604.12C65337.83,-551.75 65337.83,-458 65337.83,-458 65337.83,-458 68062.1,-458 68062.1,-458 68062.1,-458 68062.1,-476.65 68062.1,-476.65"/>
<polygon fill="black" stroke="black" points="68058.6,-476.65 68062.1,-486.65 68065.6,-476.65 68058.6,-476.65"/>
</g>
<!-- L7_S0_TP4_GPU4_moe_ar -->
<g id="node814" class="node">
<title>L7_S0_TP4_GPU4_moe_ar</title>
<ellipse fill="none" stroke="black" cx="68988" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="68988" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="68988" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="68988" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="68988" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP0_GPU0_expert0&#45;&gt;L7_S0_TP4_GPU4_moe_ar -->
<g id="edge2242" class="edge">
<title>L7_S0_TP0_GPU0_expert0&#45;&gt;L7_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M65330.67,-604.12C65330.67,-551.75 65330.67,-458 65330.67,-458 65330.67,-458 68988.23,-458 68988.23,-458 68988.23,-458 68988.23,-462.16 68988.23,-462.16"/>
<polygon fill="black" stroke="black" points="68984.73,-462.16 68988.23,-472.16 68991.73,-462.16 68984.73,-462.16"/>
</g>
<!-- L7_S0_TP5_GPU5_moe_ar -->
<g id="node823" class="node">
<title>L7_S0_TP5_GPU5_moe_ar</title>
<ellipse fill="none" stroke="black" cx="69675" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="69675" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="69675" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="69675" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="69675" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP0_GPU0_expert0&#45;&gt;L7_S0_TP5_GPU5_moe_ar -->
<g id="edge2294" class="edge">
<title>L7_S0_TP0_GPU0_expert0&#45;&gt;L7_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M65323.5,-604.12C65323.5,-551.75 65323.5,-458 65323.5,-458 65323.5,-458 69447.31,-458 69447.31,-458 69447.31,-458 69447.31,-475.2 69447.31,-475.2"/>
<polygon fill="black" stroke="black" points="69443.81,-475.2 69447.31,-485.2 69450.81,-475.2 69443.81,-475.2"/>
</g>
<!-- L7_S0_TP6_GPU6_moe_ar -->
<g id="node832" class="node">
<title>L7_S0_TP6_GPU6_moe_ar</title>
<ellipse fill="none" stroke="black" cx="70362" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="70362" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="70362" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="70362" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="70362" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP0_GPU0_expert0&#45;&gt;L7_S0_TP6_GPU6_moe_ar -->
<g id="edge2346" class="edge">
<title>L7_S0_TP0_GPU0_expert0&#45;&gt;L7_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M65316.33,-604.12C65316.33,-551.75 65316.33,-458 65316.33,-458 65316.33,-458 70240.88,-458 70240.88,-458 70240.88,-458 70240.88,-465.39 70240.88,-465.39"/>
<polygon fill="black" stroke="black" points="70237.38,-465.39 70240.88,-475.39 70244.38,-465.39 70237.38,-465.39"/>
</g>
<!-- L7_S0_TP7_GPU7_moe_ar -->
<g id="node841" class="node">
<title>L7_S0_TP7_GPU7_moe_ar</title>
<ellipse fill="none" stroke="black" cx="71049" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="71049" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="71049" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="71049" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="71049" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP0_GPU0_expert0&#45;&gt;L7_S0_TP7_GPU7_moe_ar -->
<g id="edge2398" class="edge">
<title>L7_S0_TP0_GPU0_expert0&#45;&gt;L7_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M65309.17,-604.44C65309.17,-549.65 65309.17,-448 65309.17,-448 65309.17,-448 71004.85,-448 71004.85,-448 71004.85,-448 71004.85,-462.52 71004.85,-462.52"/>
<polygon fill="black" stroke="black" points="71001.35,-462.52 71004.85,-472.52 71008.35,-462.52 71001.35,-462.52"/>
</g>
<!-- L7_S0_TP0_GPU0_expert1&#45;&gt;L7_S0_TP0_GPU0_moe_ar -->
<g id="edge2035" class="edge">
<title>L7_S0_TP0_GPU0_expert1&#45;&gt;L7_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M65777.38,-604.21C65777.38,-564.36 65777.38,-504 65777.38,-504 65777.38,-504 65915.34,-504 65915.34,-504"/>
<polygon fill="black" stroke="black" points="65915.34,-507.5 65925.34,-504 65915.34,-500.5 65915.34,-507.5"/>
</g>
<!-- L7_S0_TP0_GPU0_expert1&#45;&gt;L7_S0_TP1_GPU1_moe_ar -->
<g id="edge2087" class="edge">
<title>L7_S0_TP0_GPU0_expert1&#45;&gt;L7_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M65440.62,-604.48C65440.62,-597.9 65440.62,-593 65440.62,-593 65440.62,-593 66627.53,-593 66627.53,-593 66627.53,-593 66627.53,-552.19 66627.53,-552.19"/>
<polygon fill="black" stroke="black" points="66631.03,-552.19 66627.53,-542.19 66624.03,-552.19 66631.03,-552.19"/>
</g>
<!-- L7_S0_TP0_GPU0_expert1&#45;&gt;L7_S0_TP2_GPU2_moe_ar -->
<g id="edge2139" class="edge">
<title>L7_S0_TP0_GPU0_expert1&#45;&gt;L7_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M65496.75,-604.32C65496.75,-598.35 65496.75,-594 65496.75,-594 65496.75,-594 67326.42,-594 67326.42,-594 67326.42,-594 67326.42,-555.33 67326.42,-555.33"/>
<polygon fill="black" stroke="black" points="67329.92,-555.33 67326.42,-545.33 67322.92,-555.33 67329.92,-555.33"/>
</g>
<!-- L7_S0_TP0_GPU0_expert1&#45;&gt;L7_S0_TP3_GPU3_moe_ar -->
<g id="edge2191" class="edge">
<title>L7_S0_TP0_GPU0_expert1&#45;&gt;L7_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M65626.36,-672.68C65626.36,-687.27 65626.36,-701 65626.36,-701 65626.36,-701 68177.5,-701 68177.5,-701 68177.5,-701 68177.5,-575.52 68177.5,-575.52"/>
<polygon fill="black" stroke="black" points="68181,-575.52 68177.5,-565.52 68174,-575.52 68181,-575.52"/>
</g>
<!-- L7_S0_TP0_GPU0_expert1&#45;&gt;L7_S0_TP4_GPU4_moe_ar -->
<g id="edge2243" class="edge">
<title>L7_S0_TP0_GPU0_expert1&#45;&gt;L7_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M65721.25,-604.22C65721.25,-553.66 65721.25,-465 65721.25,-465 65721.25,-465 68876.82,-465 68876.82,-465 68876.82,-465 68876.82,-465.99 68876.82,-465.99"/>
<polygon fill="black" stroke="black" points="68873.32,-464.91 68876.82,-474.91 68880.32,-464.91 68873.32,-464.91"/>
</g>
<!-- L7_S0_TP0_GPU0_expert1&#45;&gt;L7_S0_TP5_GPU5_moe_ar -->
<g id="edge2295" class="edge">
<title>L7_S0_TP0_GPU0_expert1&#45;&gt;L7_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M65665.12,-604.22C65665.12,-553.66 65665.12,-465 65665.12,-465 65665.12,-465 69420.62,-465 69420.62,-465 69420.62,-465 69420.62,-479.15 69420.62,-479.15"/>
<polygon fill="black" stroke="black" points="69417.12,-479.15 69420.62,-489.15 69424.12,-479.15 69417.12,-479.15"/>
</g>
<!-- L7_S0_TP0_GPU0_expert1&#45;&gt;L7_S0_TP6_GPU6_moe_ar -->
<g id="edge2347" class="edge">
<title>L7_S0_TP0_GPU0_expert1&#45;&gt;L7_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M65609,-604.22C65609,-553.66 65609,-465 65609,-465 65609,-465 70169.77,-465 70169.77,-465 70169.77,-465 70169.77,-471.03 70169.77,-471.03"/>
<polygon fill="black" stroke="black" points="70166.27,-471.03 70169.77,-481.03 70173.27,-471.03 70166.27,-471.03"/>
</g>
<!-- L7_S0_TP0_GPU0_expert1&#45;&gt;L7_S0_TP7_GPU7_moe_ar -->
<g id="edge2399" class="edge">
<title>L7_S0_TP0_GPU0_expert1&#45;&gt;L7_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M65552.88,-604.23C65552.88,-599.93 65552.88,-597 65552.88,-597 65552.88,-597 70742.98,-597 70742.98,-597 70742.98,-597 70742.98,-550.14 70742.98,-550.14"/>
<polygon fill="black" stroke="black" points="70746.48,-550.14 70742.98,-540.14 70739.48,-550.14 70746.48,-550.14"/>
</g>
<!-- L7_S0_TP0_GPU0_moe_ar&#45;&gt;L7_S0_TP0_GPU0_moe_res -->
<g id="edge2050" class="edge">
<title>L7_S0_TP0_GPU0_moe_ar&#45;&gt;L7_S0_TP0_GPU0_moe_res</title>
<path fill="none" stroke="black" d="M66013.77,-484.99C66013.77,-484.99 66013.77,-446.52 66013.77,-446.52"/>
<polygon fill="black" stroke="black" points="66017.27,-446.52 66013.77,-436.52 66010.27,-446.52 66017.27,-446.52"/>
</g>
<!-- L7_S0_TP1_GPU1_expert0 -->
<g id="node748" class="node">
<title>L7_S0_TP1_GPU1_expert0</title>
<polygon fill="none" stroke="black" points="66300.5,-672.5 65851.5,-672.5 65851.5,-604.5 66300.5,-604.5 66300.5,-672.5"/>
<text text-anchor="middle" x="66076" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="66076" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="66076" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="66076" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L7_S0_TP1_GPU1_expert0&#45;&gt;L7_S0_TP0_GPU0_moe_ar -->
<g id="edge2036" class="edge">
<title>L7_S0_TP1_GPU1_expert0&#45;&gt;L7_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M65971.37,-604.34C65971.37,-604.34 65971.37,-559.3 65971.37,-559.3"/>
<polygon fill="black" stroke="black" points="65974.87,-559.3 65971.37,-549.3 65967.87,-559.3 65974.87,-559.3"/>
</g>
<!-- L7_S0_TP1_GPU1_expert0&#45;&gt;L7_S0_TP1_GPU1_moe_ar -->
<g id="edge2088" class="edge">
<title>L7_S0_TP1_GPU1_expert0&#45;&gt;L7_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M66037.19,-604.48C66037.19,-597.9 66037.19,-593 66037.19,-593 66037.19,-593 66645.03,-593 66645.03,-593 66645.03,-593 66645.03,-556.62 66645.03,-556.62"/>
<polygon fill="black" stroke="black" points="66648.53,-556.62 66645.03,-546.62 66641.53,-556.62 66648.53,-556.62"/>
</g>
<!-- L7_S0_TP1_GPU1_expert0&#45;&gt;L7_S0_TP2_GPU2_moe_ar -->
<g id="edge2140" class="edge">
<title>L7_S0_TP1_GPU1_expert0&#45;&gt;L7_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M66103.02,-604.32C66103.02,-598.35 66103.02,-594 66103.02,-594 66103.02,-594 67373.31,-594 67373.31,-594 67373.31,-594 67373.31,-564.19 67373.31,-564.19"/>
<polygon fill="black" stroke="black" points="67376.81,-564.19 67373.31,-554.19 67369.81,-564.19 67376.81,-564.19"/>
</g>
<!-- L7_S0_TP1_GPU1_expert0&#45;&gt;L7_S0_TP3_GPU3_moe_ar -->
<g id="edge2192" class="edge">
<title>L7_S0_TP1_GPU1_expert0&#45;&gt;L7_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M66168.85,-604.19C66168.85,-599.36 66168.85,-596 66168.85,-596 66168.85,-596 67991.78,-596 67991.78,-596 67991.78,-596 67991.78,-549.1 67991.78,-549.1"/>
<polygon fill="black" stroke="black" points="67995.28,-549.1 67991.78,-539.1 67988.28,-549.1 67995.28,-549.1"/>
</g>
<!-- L7_S0_TP1_GPU1_expert0&#45;&gt;L7_S0_TP4_GPU4_moe_ar -->
<g id="edge2244" class="edge">
<title>L7_S0_TP1_GPU1_expert0&#45;&gt;L7_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M65892.03,-604.42C65892.03,-554.15 65892.03,-466 65892.03,-466 65892.03,-466 68765.41,-466 68765.41,-466 68765.41,-466 68765.41,-474.42 68765.41,-474.42"/>
<polygon fill="black" stroke="black" points="68761.91,-474.42 68765.41,-484.42 68768.91,-474.42 68761.91,-474.42"/>
</g>
<!-- L7_S0_TP1_GPU1_expert0&#45;&gt;L7_S0_TP5_GPU5_moe_ar -->
<g id="edge2296" class="edge">
<title>L7_S0_TP1_GPU1_expert0&#45;&gt;L7_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M65878.52,-604.42C65878.52,-554.15 65878.52,-466 65878.52,-466 65878.52,-466 69393.92,-466 69393.92,-466 69393.92,-466 69393.92,-484.16 69393.92,-484.16"/>
<polygon fill="black" stroke="black" points="69390.42,-484.16 69393.92,-494.16 69397.42,-484.16 69390.42,-484.16"/>
</g>
<!-- L7_S0_TP1_GPU1_expert0&#45;&gt;L7_S0_TP6_GPU6_moe_ar -->
<g id="edge2348" class="edge">
<title>L7_S0_TP1_GPU1_expert0&#45;&gt;L7_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M65865.01,-604.22C65865.01,-553.66 65865.01,-465 65865.01,-465 65865.01,-465 70098.65,-465 70098.65,-465 70098.65,-465 70098.65,-480.76 70098.65,-480.76"/>
<polygon fill="black" stroke="black" points="70095.15,-480.76 70098.65,-490.76 70102.15,-480.76 70095.15,-480.76"/>
</g>
<!-- L7_S0_TP1_GPU1_expert0&#45;&gt;L7_S0_TP7_GPU7_moe_ar -->
<g id="edge2400" class="edge">
<title>L7_S0_TP1_GPU1_expert0&#45;&gt;L7_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M66234.67,-604.23C66234.67,-599.93 66234.67,-597 66234.67,-597 66234.67,-597 70771.42,-597 70771.42,-597 70771.42,-597 70771.42,-557.63 70771.42,-557.63"/>
<polygon fill="black" stroke="black" points="70774.92,-557.63 70771.42,-547.63 70767.92,-557.63 70774.92,-557.63"/>
</g>
<!-- L7_S0_TP1_GPU1_expert1 -->
<g id="node749" class="node">
<title>L7_S0_TP1_GPU1_expert1</title>
<polygon fill="none" stroke="black" points="66767.5,-672.5 66318.5,-672.5 66318.5,-604.5 66767.5,-604.5 66767.5,-672.5"/>
<text text-anchor="middle" x="66543" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="66543" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="66543" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="66543" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L7_S0_TP1_GPU1_expert1&#45;&gt;L7_S0_TP0_GPU0_moe_ar -->
<g id="edge2037" class="edge">
<title>L7_S0_TP1_GPU1_expert1&#45;&gt;L7_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M66346.94,-604.34C66346.94,-604.34 66346.94,-576.36 66346.94,-576.36"/>
<polygon fill="black" stroke="black" points="66350.44,-576.36 66346.94,-566.36 66343.44,-576.36 66350.44,-576.36"/>
</g>
<!-- L7_S0_TP1_GPU1_expert1&#45;&gt;L7_S0_TP1_GPU1_moe_ar -->
<g id="edge2089" class="edge">
<title>L7_S0_TP1_GPU1_expert1&#45;&gt;L7_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M66662.52,-604.34C66662.52,-604.34 66662.52,-560.09 66662.52,-560.09"/>
<polygon fill="black" stroke="black" points="66666.02,-560.09 66662.52,-550.09 66659.02,-560.09 66666.02,-560.09"/>
</g>
<!-- L7_S0_TP1_GPU1_expert1&#45;&gt;L7_S0_TP2_GPU2_moe_ar -->
<g id="edge2141" class="edge">
<title>L7_S0_TP1_GPU1_expert1&#45;&gt;L7_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M66680.02,-604.32C66680.02,-598.35 66680.02,-594 66680.02,-594 66680.02,-594 67420.19,-594 67420.19,-594 67420.19,-594 67420.19,-569.79 67420.19,-569.79"/>
<polygon fill="black" stroke="black" points="67423.69,-569.79 67420.19,-559.79 67416.69,-569.79 67423.69,-569.79"/>
</g>
<!-- L7_S0_TP1_GPU1_expert1&#45;&gt;L7_S0_TP3_GPU3_moe_ar -->
<g id="edge2193" class="edge">
<title>L7_S0_TP1_GPU1_expert1&#45;&gt;L7_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M66697.52,-604.19C66697.52,-599.36 66697.52,-596 66697.52,-596 66697.52,-596 68017.03,-596 68017.03,-596 68017.03,-596 68017.03,-556.01 68017.03,-556.01"/>
<polygon fill="black" stroke="black" points="68020.53,-556.01 68017.03,-546.01 68013.53,-556.01 68020.53,-556.01"/>
</g>
<!-- L7_S0_TP1_GPU1_expert1&#45;&gt;L7_S0_TP4_GPU4_moe_ar -->
<g id="edge2245" class="edge">
<title>L7_S0_TP1_GPU1_expert1&#45;&gt;L7_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M66715.01,-604.23C66715.01,-599.93 66715.01,-597 66715.01,-597 66715.01,-597 68698.43,-597 68698.43,-597 68698.43,-597 68698.43,-554.65 68698.43,-554.65"/>
<polygon fill="black" stroke="black" points="68701.93,-554.65 68698.43,-544.65 68694.93,-554.65 68701.93,-554.65"/>
</g>
<!-- L7_S0_TP1_GPU1_expert1&#45;&gt;L7_S0_TP5_GPU5_moe_ar -->
<g id="edge2297" class="edge">
<title>L7_S0_TP1_GPU1_expert1&#45;&gt;L7_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M66586.51,-604.2C66586.51,-555.2 66586.51,-471 66586.51,-471 66586.51,-471 69367.23,-471 69367.23,-471 69367.23,-471 69367.23,-491.45 69367.23,-491.45"/>
<polygon fill="black" stroke="black" points="69363.73,-491.45 69367.23,-501.45 69370.73,-491.45 69363.73,-491.45"/>
</g>
<!-- L7_S0_TP1_GPU1_expert1&#45;&gt;L7_S0_TP6_GPU6_moe_ar -->
<g id="edge2349" class="edge">
<title>L7_S0_TP1_GPU1_expert1&#45;&gt;L7_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M66732.51,-604.23C66732.51,-599.93 66732.51,-597 66732.51,-597 66732.51,-597 70166.75,-597 70166.75,-597 70166.75,-597 70166.75,-569.61 70166.75,-569.61"/>
<polygon fill="black" stroke="black" points="70170.25,-569.61 70166.75,-559.61 70163.25,-569.61 70170.25,-569.61"/>
</g>
<!-- L7_S0_TP1_GPU1_expert1&#45;&gt;L7_S0_TP7_GPU7_moe_ar -->
<g id="edge2401" class="edge">
<title>L7_S0_TP1_GPU1_expert1&#45;&gt;L7_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M66750,-604.23C66750,-599.93 66750,-597 66750,-597 66750,-597 70799.86,-597 70799.86,-597 70799.86,-597 70799.86,-562.89 70799.86,-562.89"/>
<polygon fill="black" stroke="black" points="70803.36,-562.89 70799.86,-552.89 70796.36,-562.89 70803.36,-562.89"/>
</g>
<!-- L7_S0_TP2_GPU2_expert0 -->
<g id="node750" class="node">
<title>L7_S0_TP2_GPU2_expert0</title>
<polygon fill="none" stroke="black" points="67234.5,-672.5 66785.5,-672.5 66785.5,-604.5 67234.5,-604.5 67234.5,-672.5"/>
<text text-anchor="middle" x="67010" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="67010" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="67010" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="67010" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L7_S0_TP2_GPU2_expert0&#45;&gt;L7_S0_TP0_GPU0_moe_ar -->
<g id="edge2038" class="edge">
<title>L7_S0_TP2_GPU2_expert0&#45;&gt;L7_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M66841.62,-604.39C66841.62,-602.89 66841.62,-602 66841.62,-602 66841.62,-602 66375.38,-602 66375.38,-602 66375.38,-602 66375.38,-574.55 66375.38,-574.55"/>
<polygon fill="black" stroke="black" points="66378.88,-574.55 66375.38,-564.55 66371.88,-574.55 66378.88,-574.55"/>
</g>
<!-- L7_S0_TP2_GPU2_expert0&#45;&gt;L7_S0_TP1_GPU1_moe_ar -->
<g id="edge2090" class="edge">
<title>L7_S0_TP2_GPU2_expert0&#45;&gt;L7_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M66897.75,-604.34C66897.75,-604.34 66897.75,-578.55 66897.75,-578.55"/>
<polygon fill="black" stroke="black" points="66901.25,-578.55 66897.75,-568.55 66894.25,-578.55 66901.25,-578.55"/>
</g>
<!-- L7_S0_TP2_GPU2_expert0&#45;&gt;L7_S0_TP2_GPU2_moe_ar -->
<g id="edge2142" class="edge">
<title>L7_S0_TP2_GPU2_expert0&#45;&gt;L7_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M67010,-604.32C67010,-598.35 67010,-594 67010,-594 67010,-594 67467.08,-594 67467.08,-594 67467.08,-594 67467.08,-573.65 67467.08,-573.65"/>
<polygon fill="black" stroke="black" points="67470.58,-573.65 67467.08,-563.65 67463.58,-573.65 67470.58,-573.65"/>
</g>
<!-- L7_S0_TP2_GPU2_expert0&#45;&gt;L7_S0_TP3_GPU3_moe_ar -->
<g id="edge2194" class="edge">
<title>L7_S0_TP2_GPU2_expert0&#45;&gt;L7_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M67066.12,-604.19C67066.12,-599.36 67066.12,-596 67066.12,-596 67066.12,-596 68042.27,-596 68042.27,-596 68042.27,-596 68042.27,-561.16 68042.27,-561.16"/>
<polygon fill="black" stroke="black" points="68045.77,-561.16 68042.27,-551.16 68038.77,-561.16 68045.77,-561.16"/>
</g>
<!-- L7_S0_TP2_GPU2_expert0&#45;&gt;L7_S0_TP4_GPU4_moe_ar -->
<g id="edge2246" class="edge">
<title>L7_S0_TP2_GPU2_expert0&#45;&gt;L7_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M67122.25,-604.23C67122.25,-599.93 67122.25,-597 67122.25,-597 67122.25,-597 68743.33,-597 68743.33,-597 68743.33,-597 68743.33,-563.34 68743.33,-563.34"/>
<polygon fill="black" stroke="black" points="68746.83,-563.34 68743.33,-553.34 68739.83,-563.34 68746.83,-563.34"/>
</g>
<!-- L7_S0_TP2_GPU2_expert0&#45;&gt;L7_S0_TP5_GPU5_moe_ar -->
<g id="edge2298" class="edge">
<title>L7_S0_TP2_GPU2_expert0&#45;&gt;L7_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M67178.38,-604.23C67178.38,-599.93 67178.38,-597 67178.38,-597 67178.38,-597 69365.98,-597 69365.98,-597 69365.98,-597 69365.98,-548.96 69365.98,-548.96"/>
<polygon fill="black" stroke="black" points="69369.48,-548.96 69365.98,-538.96 69362.48,-548.96 69369.48,-548.96"/>
</g>
<!-- L7_S0_TP2_GPU2_expert0&#45;&gt;L7_S0_TP6_GPU6_moe_ar -->
<g id="edge2350" class="edge">
<title>L7_S0_TP2_GPU2_expert0&#45;&gt;L7_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M67122.25,-672.52C67122.25,-679.1 67122.25,-684 67122.25,-684 67122.25,-684 70052.25,-684 70052.25,-684 70052.25,-684 70052.25,-548.86 70052.25,-548.86"/>
<polygon fill="black" stroke="black" points="70055.75,-548.86 70052.25,-538.86 70048.75,-548.86 70055.75,-548.86"/>
</g>
<!-- L7_S0_TP2_GPU2_expert0&#45;&gt;L7_S0_TP7_GPU7_moe_ar -->
<g id="edge2402" class="edge">
<title>L7_S0_TP2_GPU2_expert0&#45;&gt;L7_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M67010,-672.7C67010,-684.12 67010,-694 67010,-694 67010,-694 70984.9,-694 70984.9,-694 70984.9,-694 70984.9,-577.85 70984.9,-577.85"/>
<polygon fill="black" stroke="black" points="70988.4,-577.85 70984.9,-567.85 70981.4,-577.85 70988.4,-577.85"/>
</g>
<!-- L7_S0_TP2_GPU2_expert1 -->
<g id="node751" class="node">
<title>L7_S0_TP2_GPU2_expert1</title>
<polygon fill="none" stroke="black" points="67701.5,-672.5 67252.5,-672.5 67252.5,-604.5 67701.5,-604.5 67701.5,-672.5"/>
<text text-anchor="middle" x="67477" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="67477" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="67477" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="67477" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L7_S0_TP2_GPU2_expert1&#45;&gt;L7_S0_TP0_GPU0_moe_ar -->
<g id="edge2039" class="edge">
<title>L7_S0_TP2_GPU2_expert1&#45;&gt;L7_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M67267.49,-604.49C67267.49,-601.17 67267.49,-599 67267.49,-599 67267.49,-599 66403.82,-599 66403.82,-599 66403.82,-599 66403.82,-572.47 66403.82,-572.47"/>
<polygon fill="black" stroke="black" points="66407.32,-572.47 66403.82,-562.47 66400.32,-572.47 66407.32,-572.47"/>
</g>
<!-- L7_S0_TP2_GPU2_expert1&#45;&gt;L7_S0_TP1_GPU1_moe_ar -->
<g id="edge2091" class="edge">
<title>L7_S0_TP2_GPU2_expert1&#45;&gt;L7_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M67256.98,-604.34C67256.98,-604.34 67256.98,-538.63 67256.98,-538.63"/>
<polygon fill="black" stroke="black" points="67260.48,-538.63 67256.98,-528.63 67253.48,-538.63 67260.48,-538.63"/>
</g>
<!-- L7_S0_TP2_GPU2_expert1&#45;&gt;L7_S0_TP2_GPU2_moe_ar -->
<g id="edge2143" class="edge">
<title>L7_S0_TP2_GPU2_expert1&#45;&gt;L7_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M67513.96,-604.34C67513.96,-604.34 67513.96,-576.36 67513.96,-576.36"/>
<polygon fill="black" stroke="black" points="67517.46,-576.36 67513.96,-566.36 67510.46,-576.36 67517.46,-576.36"/>
</g>
<!-- L7_S0_TP2_GPU2_expert1&#45;&gt;L7_S0_TP3_GPU3_moe_ar -->
<g id="edge2195" class="edge">
<title>L7_S0_TP2_GPU2_expert1&#45;&gt;L7_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M67560.85,-604.19C67560.85,-599.36 67560.85,-596 67560.85,-596 67560.85,-596 68067.52,-596 68067.52,-596 68067.52,-596 68067.52,-565.11 68067.52,-565.11"/>
<polygon fill="black" stroke="black" points="68071.02,-565.11 68067.52,-555.11 68064.02,-565.11 68071.02,-565.11"/>
</g>
<!-- L7_S0_TP2_GPU2_expert1&#45;&gt;L7_S0_TP4_GPU4_moe_ar -->
<g id="edge2247" class="edge">
<title>L7_S0_TP2_GPU2_expert1&#45;&gt;L7_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M67607.73,-604.23C67607.73,-599.93 67607.73,-597 67607.73,-597 67607.73,-597 68788.23,-597 68788.23,-597 68788.23,-597 68788.23,-569.16 68788.23,-569.16"/>
<polygon fill="black" stroke="black" points="68791.73,-569.16 68788.23,-559.16 68784.73,-569.16 68791.73,-569.16"/>
</g>
<!-- L7_S0_TP2_GPU2_expert1&#45;&gt;L7_S0_TP5_GPU5_moe_ar -->
<g id="edge2299" class="edge">
<title>L7_S0_TP2_GPU2_expert1&#45;&gt;L7_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M67654.62,-604.23C67654.62,-599.93 67654.62,-597 67654.62,-597 67654.62,-597 69391.42,-597 69391.42,-597 69391.42,-597 69391.42,-555.92 69391.42,-555.92"/>
<polygon fill="black" stroke="black" points="69394.92,-555.92 69391.42,-545.92 69387.92,-555.92 69394.92,-555.92"/>
</g>
<!-- L7_S0_TP2_GPU2_expert1&#45;&gt;L7_S0_TP6_GPU6_moe_ar -->
<g id="edge2351" class="edge">
<title>L7_S0_TP2_GPU2_expert1&#45;&gt;L7_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M67659.41,-672.68C67659.41,-678.65 67659.41,-683 67659.41,-683 67659.41,-683 70050,-683 70050,-683 70050,-683 70050,-547.82 70050,-547.82"/>
<polygon fill="black" stroke="black" points="70053.5,-547.82 70050,-537.82 70046.5,-547.82 70053.5,-547.82"/>
</g>
<!-- L7_S0_TP2_GPU2_expert1&#45;&gt;L7_S0_TP7_GPU7_moe_ar -->
<g id="edge2403" class="edge">
<title>L7_S0_TP2_GPU2_expert1&#45;&gt;L7_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M67617.31,-672.7C67617.31,-684.12 67617.31,-694 67617.31,-694 67617.31,-694 70981.3,-694 70981.3,-694 70981.3,-694 70981.3,-577.85 70981.3,-577.85"/>
<polygon fill="black" stroke="black" points="70984.8,-577.85 70981.3,-567.85 70977.8,-577.85 70984.8,-577.85"/>
</g>
<!-- L7_S0_TP3_GPU3_expert0 -->
<g id="node752" class="node">
<title>L7_S0_TP3_GPU3_expert0</title>
<polygon fill="none" stroke="black" points="68168.5,-672.5 67719.5,-672.5 67719.5,-604.5 68168.5,-604.5 68168.5,-672.5"/>
<text text-anchor="middle" x="67944" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="67944" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="67944" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="67944" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L7_S0_TP3_GPU3_expert0&#45;&gt;L7_S0_TP0_GPU0_moe_ar -->
<g id="edge2040" class="edge">
<title>L7_S0_TP3_GPU3_expert0&#45;&gt;L7_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M67748.12,-604.49C67748.12,-601.17 67748.12,-599 67748.12,-599 67748.12,-599 66432.26,-599 66432.26,-599 66432.26,-599 66432.26,-570.17 66432.26,-570.17"/>
<polygon fill="black" stroke="black" points="66435.76,-570.17 66432.26,-560.17 66428.76,-570.17 66435.76,-570.17"/>
</g>
<!-- L7_S0_TP3_GPU3_expert0&#45;&gt;L7_S0_TP1_GPU1_moe_ar -->
<g id="edge2092" class="edge">
<title>L7_S0_TP3_GPU3_expert0&#45;&gt;L7_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M67776.74,-604.49C67776.74,-601.17 67776.74,-599 67776.74,-599 67776.74,-599 67248,-599 67248,-599 67248,-599 67248,-544.1 67248,-544.1"/>
<polygon fill="black" stroke="black" points="67251.5,-544.1 67248,-534.1 67244.5,-544.1 67251.5,-544.1"/>
</g>
<!-- L7_S0_TP3_GPU3_expert0&#45;&gt;L7_S0_TP2_GPU2_moe_ar -->
<g id="edge2144" class="edge">
<title>L7_S0_TP3_GPU3_expert0&#45;&gt;L7_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M67805.36,-604.34C67805.36,-604.34 67805.36,-569.91 67805.36,-569.91"/>
<polygon fill="black" stroke="black" points="67808.86,-569.91 67805.36,-559.91 67801.86,-569.91 67808.86,-569.91"/>
</g>
<!-- L7_S0_TP3_GPU3_expert0&#45;&gt;L7_S0_TP3_GPU3_moe_ar -->
<g id="edge2196" class="edge">
<title>L7_S0_TP3_GPU3_expert0&#45;&gt;L7_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M68092.76,-604.34C68092.76,-604.34 68092.76,-568.22 68092.76,-568.22"/>
<polygon fill="black" stroke="black" points="68096.26,-568.22 68092.76,-558.22 68089.26,-568.22 68096.26,-568.22"/>
</g>
<!-- L7_S0_TP3_GPU3_expert0&#45;&gt;L7_S0_TP4_GPU4_moe_ar -->
<g id="edge2248" class="edge">
<title>L7_S0_TP3_GPU3_expert0&#45;&gt;L7_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M68118.01,-604.23C68118.01,-599.93 68118.01,-597 68118.01,-597 68118.01,-597 68878.02,-597 68878.02,-597 68878.02,-597 68878.02,-575.85 68878.02,-575.85"/>
<polygon fill="black" stroke="black" points="68881.52,-575.85 68878.02,-565.85 68874.52,-575.85 68881.52,-575.85"/>
</g>
<!-- L7_S0_TP3_GPU3_expert0&#45;&gt;L7_S0_TP5_GPU5_moe_ar -->
<g id="edge2300" class="edge">
<title>L7_S0_TP3_GPU3_expert0&#45;&gt;L7_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M68143.25,-604.23C68143.25,-599.93 68143.25,-597 68143.25,-597 68143.25,-597 69416.86,-597 69416.86,-597 69416.86,-597 69416.86,-561.12 69416.86,-561.12"/>
<polygon fill="black" stroke="black" points="69420.36,-561.12 69416.86,-551.12 69413.36,-561.12 69420.36,-561.12"/>
</g>
<!-- L7_S0_TP3_GPU3_expert0&#45;&gt;L7_S0_TP6_GPU6_moe_ar -->
<g id="edge2352" class="edge">
<title>L7_S0_TP3_GPU3_expert0&#45;&gt;L7_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M68018.83,-672.68C68018.83,-678.65 68018.83,-683 68018.83,-683 68018.83,-683 70047.75,-683 70047.75,-683 70047.75,-683 70047.75,-546.9 70047.75,-546.9"/>
<polygon fill="black" stroke="black" points="70051.25,-546.9 70047.75,-536.9 70044.25,-546.9 70051.25,-546.9"/>
</g>
<!-- L7_S0_TP3_GPU3_expert0&#45;&gt;L7_S0_TP7_GPU7_moe_ar -->
<g id="edge2404" class="edge">
<title>L7_S0_TP3_GPU3_expert0&#45;&gt;L7_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M67957.5,-604.44C67957.5,-549.65 67957.5,-448 67957.5,-448 67957.5,-448 70859.69,-448 70859.69,-448 70859.69,-448 70859.69,-470.4 70859.69,-470.4"/>
<polygon fill="black" stroke="black" points="70856.19,-470.4 70859.69,-480.4 70863.19,-470.4 70856.19,-470.4"/>
</g>
<!-- L7_S0_TP3_GPU3_expert1 -->
<g id="node753" class="node">
<title>L7_S0_TP3_GPU3_expert1</title>
<polygon fill="none" stroke="black" points="68635.5,-672.5 68186.5,-672.5 68186.5,-604.5 68635.5,-604.5 68635.5,-672.5"/>
<text text-anchor="middle" x="68411" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="68411" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="68411" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="68411" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L7_S0_TP3_GPU3_expert1&#45;&gt;L7_S0_TP0_GPU0_moe_ar -->
<g id="edge2041" class="edge">
<title>L7_S0_TP3_GPU3_expert1&#45;&gt;L7_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M68236.38,-604.49C68236.38,-601.17 68236.38,-599 68236.38,-599 68236.38,-599 66460.7,-599 66460.7,-599 66460.7,-599 66460.7,-566.95 66460.7,-566.95"/>
<polygon fill="black" stroke="black" points="66464.2,-566.95 66460.7,-556.95 66457.2,-566.95 66464.2,-566.95"/>
</g>
<!-- L7_S0_TP3_GPU3_expert1&#45;&gt;L7_S0_TP1_GPU1_moe_ar -->
<g id="edge2093" class="edge">
<title>L7_S0_TP3_GPU3_expert1&#45;&gt;L7_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M68286.27,-604.49C68286.27,-601.17 68286.27,-599 68286.27,-599 68286.27,-599 67250.25,-599 67250.25,-599 67250.25,-599 67250.25,-543.04 67250.25,-543.04"/>
<polygon fill="black" stroke="black" points="67253.75,-543.04 67250.25,-533.04 67246.75,-543.04 67253.75,-543.04"/>
</g>
<!-- L7_S0_TP3_GPU3_expert1&#45;&gt;L7_S0_TP2_GPU2_moe_ar -->
<g id="edge2145" class="edge">
<title>L7_S0_TP3_GPU3_expert1&#45;&gt;L7_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M68336.15,-604.49C68336.15,-601.17 68336.15,-599 68336.15,-599 68336.15,-599 67833.98,-599 67833.98,-599 67833.98,-599 67833.98,-566.95 67833.98,-566.95"/>
<polygon fill="black" stroke="black" points="67837.48,-566.95 67833.98,-556.95 67830.48,-566.95 67837.48,-566.95"/>
</g>
<!-- L7_S0_TP3_GPU3_expert1&#45;&gt;L7_S0_TP3_GPU3_moe_ar -->
<g id="edge2197" class="edge">
<title>L7_S0_TP3_GPU3_expert1&#45;&gt;L7_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M68386.04,-604.34C68386.04,-604.34 68386.04,-577.23 68386.04,-577.23"/>
<polygon fill="black" stroke="black" points="68389.54,-577.23 68386.04,-567.23 68382.54,-577.23 68389.54,-577.23"/>
</g>
<!-- L7_S0_TP3_GPU3_expert1&#45;&gt;L7_S0_TP4_GPU4_moe_ar -->
<g id="edge2249" class="edge">
<title>L7_S0_TP3_GPU3_expert1&#45;&gt;L7_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M68635.67,-627C68641.89,-627 68645.44,-627 68645.44,-627 68645.44,-627 68645.44,-504 68645.44,-504 68645.44,-504 68663.48,-504 68663.48,-504"/>
<polygon fill="black" stroke="black" points="68663.48,-507.5 68673.48,-504 68663.48,-500.5 68663.48,-507.5"/>
</g>
<!-- L7_S0_TP3_GPU3_expert1&#45;&gt;L7_S0_TP5_GPU5_moe_ar -->
<g id="edge2301" class="edge">
<title>L7_S0_TP3_GPU3_expert1&#45;&gt;L7_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M68435.92,-604.23C68435.92,-599.93 68435.92,-597 68435.92,-597 68435.92,-597 69442.3,-597 69442.3,-597 69442.3,-597 69442.3,-565.12 69442.3,-565.12"/>
<polygon fill="black" stroke="black" points="69445.8,-565.12 69442.3,-555.12 69438.8,-565.12 69445.8,-565.12"/>
</g>
<!-- L7_S0_TP3_GPU3_expert1&#45;&gt;L7_S0_TP6_GPU6_moe_ar -->
<g id="edge2353" class="edge">
<title>L7_S0_TP3_GPU3_expert1&#45;&gt;L7_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M68522.71,-672.68C68522.71,-678.65 68522.71,-683 68522.71,-683 68522.71,-683 70045.5,-683 70045.5,-683 70045.5,-683 70045.5,-546.01 70045.5,-546.01"/>
<polygon fill="black" stroke="black" points="70049,-546.01 70045.5,-536.01 70042,-546.01 70049,-546.01"/>
</g>
<!-- L7_S0_TP3_GPU3_expert1&#45;&gt;L7_S0_TP7_GPU7_moe_ar -->
<g id="edge2405" class="edge">
<title>L7_S0_TP3_GPU3_expert1&#45;&gt;L7_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M68410.64,-672.7C68410.64,-684.12 68410.64,-694 68410.64,-694 68410.64,-694 70977.7,-694 70977.7,-694 70977.7,-694 70977.7,-577.85 70977.7,-577.85"/>
<polygon fill="black" stroke="black" points="70981.2,-577.85 70977.7,-567.85 70974.2,-577.85 70981.2,-577.85"/>
</g>
<!-- L7_S0_TP4_GPU4_expert0 -->
<g id="node754" class="node">
<title>L7_S0_TP4_GPU4_expert0</title>
<polygon fill="none" stroke="black" points="69102.5,-672.5 68653.5,-672.5 68653.5,-604.5 69102.5,-604.5 69102.5,-672.5"/>
<text text-anchor="middle" x="68878" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="68878" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="68878" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="68878" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L7_S0_TP4_GPU4_expert0&#45;&gt;L7_S0_TP0_GPU0_moe_ar -->
<g id="edge2042" class="edge">
<title>L7_S0_TP4_GPU4_expert0&#45;&gt;L7_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M68878,-672.67C68878,-684.57 68878,-695 68878,-695 68878,-695 66309.5,-695 66309.5,-695 66309.5,-695 66309.5,-577.66 66309.5,-577.66"/>
<polygon fill="black" stroke="black" points="66313,-577.66 66309.5,-567.66 66306,-577.66 66313,-577.66"/>
</g>
<!-- L7_S0_TP4_GPU4_expert0&#45;&gt;L7_S0_TP1_GPU1_moe_ar -->
<g id="edge2094" class="edge">
<title>L7_S0_TP4_GPU4_expert0&#45;&gt;L7_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M68765.75,-672.68C68765.75,-678.65 68765.75,-683 68765.75,-683 68765.75,-683 67243.5,-683 67243.5,-683 67243.5,-683 67243.5,-546.01 67243.5,-546.01"/>
<polygon fill="black" stroke="black" points="67247,-546.01 67243.5,-536.01 67240,-546.01 67247,-546.01"/>
</g>
<!-- L7_S0_TP4_GPU4_expert0&#45;&gt;L7_S0_TP2_GPU2_moe_ar -->
<g id="edge2146" class="edge">
<title>L7_S0_TP4_GPU4_expert0&#45;&gt;L7_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M68833.12,-604.23C68833.12,-599.93 68833.12,-597 68833.12,-597 68833.12,-597 67862.6,-597 67862.6,-597 67862.6,-597 67862.6,-562.89 67862.6,-562.89"/>
<polygon fill="black" stroke="black" points="67866.1,-562.89 67862.6,-552.89 67859.1,-562.89 67866.1,-562.89"/>
</g>
<!-- L7_S0_TP4_GPU4_expert0&#45;&gt;L7_S0_TP3_GPU3_moe_ar -->
<g id="edge2198" class="edge">
<title>L7_S0_TP4_GPU4_expert0&#45;&gt;L7_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M68653.48,-649C68646.87,-649 68643.08,-649 68643.08,-649 68643.08,-649 68643.08,-536 68643.08,-536 68643.08,-536 68627.65,-536 68627.65,-536"/>
<polygon fill="black" stroke="black" points="68627.65,-532.5 68617.65,-536 68627.65,-539.5 68627.65,-532.5"/>
</g>
<!-- L7_S0_TP4_GPU4_expert0&#45;&gt;L7_S0_TP4_GPU4_moe_ar -->
<g id="edge2250" class="edge">
<title>L7_S0_TP4_GPU4_expert0&#45;&gt;L7_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M68922.92,-604.34C68922.92,-604.34 68922.92,-577.67 68922.92,-577.67"/>
<polygon fill="black" stroke="black" points="68926.42,-577.67 68922.92,-567.67 68919.42,-577.67 68926.42,-577.67"/>
</g>
<!-- L7_S0_TP4_GPU4_expert0&#45;&gt;L7_S0_TP5_GPU5_moe_ar -->
<g id="edge2302" class="edge">
<title>L7_S0_TP4_GPU4_expert0&#45;&gt;L7_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M68967.81,-604.23C68967.81,-599.93 68967.81,-597 68967.81,-597 68967.81,-597 69467.74,-597 69467.74,-597 69467.74,-597 69467.74,-568.26 69467.74,-568.26"/>
<polygon fill="black" stroke="black" points="69471.24,-568.26 69467.74,-558.26 69464.24,-568.26 69471.24,-568.26"/>
</g>
<!-- L7_S0_TP4_GPU4_expert0&#45;&gt;L7_S0_TP6_GPU6_moe_ar -->
<g id="edge2354" class="edge">
<title>L7_S0_TP4_GPU4_expert0&#45;&gt;L7_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M69012.71,-604.23C69012.71,-599.93 69012.71,-597 69012.71,-597 69012.71,-597 70038.75,-597 70038.75,-597 70038.75,-597 70038.75,-543.06 70038.75,-543.06"/>
<polygon fill="black" stroke="black" points="70042.25,-543.06 70038.75,-533.06 70035.25,-543.06 70042.25,-543.06"/>
</g>
<!-- L7_S0_TP4_GPU4_expert0&#45;&gt;L7_S0_TP7_GPU7_moe_ar -->
<g id="edge2406" class="edge">
<title>L7_S0_TP4_GPU4_expert0&#45;&gt;L7_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M69057.6,-604.33C69057.6,-600.53 69057.6,-598 69057.6,-598 69057.6,-598 70828.3,-598 70828.3,-598 70828.3,-598 70828.3,-566.94 70828.3,-566.94"/>
<polygon fill="black" stroke="black" points="70831.8,-566.94 70828.3,-556.94 70824.8,-566.94 70831.8,-566.94"/>
</g>
<!-- L7_S0_TP4_GPU4_expert1 -->
<g id="node755" class="node">
<title>L7_S0_TP4_GPU4_expert1</title>
<polygon fill="none" stroke="black" points="69569.5,-672.5 69120.5,-672.5 69120.5,-604.5 69569.5,-604.5 69569.5,-672.5"/>
<text text-anchor="middle" x="69345" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="69345" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="69345" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="69345" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L7_S0_TP4_GPU4_expert1&#45;&gt;L7_S0_TP0_GPU0_moe_ar -->
<g id="edge2043" class="edge">
<title>L7_S0_TP4_GPU4_expert1&#45;&gt;L7_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M69331.5,-604.2C69331.5,-554.67 69331.5,-469 69331.5,-469 69331.5,-469 66465.85,-469 66465.85,-469 66465.85,-469 66465.85,-474.71 66465.85,-474.71"/>
<polygon fill="black" stroke="black" points="66462.35,-474.71 66465.85,-484.71 66469.35,-474.71 66462.35,-474.71"/>
</g>
<!-- L7_S0_TP4_GPU4_expert1&#45;&gt;L7_S0_TP1_GPU1_moe_ar -->
<g id="edge2095" class="edge">
<title>L7_S0_TP4_GPU4_expert1&#45;&gt;L7_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M69270.17,-672.52C69270.17,-679.1 69270.17,-684 69270.17,-684 69270.17,-684 67241.25,-684 67241.25,-684 67241.25,-684 67241.25,-547 67241.25,-547"/>
<polygon fill="black" stroke="black" points="67244.75,-547 67241.25,-537 67237.75,-547 67244.75,-547"/>
</g>
<!-- L7_S0_TP4_GPU4_expert1&#45;&gt;L7_S0_TP2_GPU2_moe_ar -->
<g id="edge2147" class="edge">
<title>L7_S0_TP4_GPU4_expert1&#45;&gt;L7_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M69145.75,-604.23C69145.75,-599.93 69145.75,-597 69145.75,-597 69145.75,-597 67891.22,-597 67891.22,-597 67891.22,-597 67891.22,-557.63 67891.22,-557.63"/>
<polygon fill="black" stroke="black" points="67894.72,-557.63 67891.22,-547.63 67887.72,-557.63 67894.72,-557.63"/>
</g>
<!-- L7_S0_TP4_GPU4_expert1&#45;&gt;L7_S0_TP3_GPU3_moe_ar -->
<g id="edge2199" class="edge">
<title>L7_S0_TP4_GPU4_expert1&#45;&gt;L7_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M69170.99,-604.23C69170.99,-599.93 69170.99,-597 69170.99,-597 69170.99,-597 68485.81,-597 68485.81,-597 68485.81,-597 68485.81,-570.5 68485.81,-570.5"/>
<polygon fill="black" stroke="black" points="68489.31,-570.5 68485.81,-560.5 68482.31,-570.5 68489.31,-570.5"/>
</g>
<!-- L7_S0_TP4_GPU4_expert1&#45;&gt;L7_S0_TP4_GPU4_moe_ar -->
<g id="edge2251" class="edge">
<title>L7_S0_TP4_GPU4_expert1&#45;&gt;L7_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M69196.24,-604.34C69196.24,-604.34 69196.24,-568.22 69196.24,-568.22"/>
<polygon fill="black" stroke="black" points="69199.74,-568.22 69196.24,-558.22 69192.74,-568.22 69199.74,-568.22"/>
</g>
<!-- L7_S0_TP4_GPU4_expert1&#45;&gt;L7_S0_TP5_GPU5_moe_ar -->
<g id="edge2303" class="edge">
<title>L7_S0_TP4_GPU4_expert1&#45;&gt;L7_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M69493.18,-604.34C69493.18,-604.34 69493.18,-571.18 69493.18,-571.18"/>
<polygon fill="black" stroke="black" points="69496.68,-571.18 69493.18,-561.18 69489.68,-571.18 69496.68,-571.18"/>
</g>
<!-- L7_S0_TP4_GPU4_expert1&#45;&gt;L7_S0_TP6_GPU6_moe_ar -->
<g id="edge2355" class="edge">
<title>L7_S0_TP4_GPU4_expert1&#45;&gt;L7_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M69518.62,-604.23C69518.62,-599.93 69518.62,-597 69518.62,-597 69518.62,-597 70041,-597 70041,-597 70041,-597 70041,-544.11 70041,-544.11"/>
<polygon fill="black" stroke="black" points="70044.5,-544.11 70041,-534.11 70037.5,-544.11 70044.5,-544.11"/>
</g>
<!-- L7_S0_TP4_GPU4_expert1&#45;&gt;L7_S0_TP7_GPU7_moe_ar -->
<g id="edge2407" class="edge">
<title>L7_S0_TP4_GPU4_expert1&#45;&gt;L7_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M69544.06,-604.33C69544.06,-600.53 69544.06,-598 69544.06,-598 69544.06,-598 70856.74,-598 70856.74,-598 70856.74,-598 70856.74,-570.12 70856.74,-570.12"/>
<polygon fill="black" stroke="black" points="70860.24,-570.12 70856.74,-560.12 70853.24,-570.12 70860.24,-570.12"/>
</g>
<!-- L7_S0_TP5_GPU5_expert0 -->
<g id="node756" class="node">
<title>L7_S0_TP5_GPU5_expert0</title>
<polygon fill="none" stroke="black" points="70036.5,-672.5 69587.5,-672.5 69587.5,-604.5 70036.5,-604.5 70036.5,-672.5"/>
<text text-anchor="middle" x="69812" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="69812" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="69812" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="69812" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L7_S0_TP5_GPU5_expert0&#45;&gt;L7_S0_TP0_GPU0_moe_ar -->
<g id="edge2044" class="edge">
<title>L7_S0_TP5_GPU5_expert0&#45;&gt;L7_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M69671.02,-672.67C69671.02,-684.57 69671.02,-695 69671.02,-695 69671.02,-695 66305,-695 66305,-695 66305,-695 66305,-577.66 66305,-577.66"/>
<polygon fill="black" stroke="black" points="66308.5,-577.66 66305,-567.66 66301.5,-577.66 66308.5,-577.66"/>
</g>
<!-- L7_S0_TP5_GPU5_expert0&#45;&gt;L7_S0_TP1_GPU1_moe_ar -->
<g id="edge2096" class="edge">
<title>L7_S0_TP5_GPU5_expert0&#45;&gt;L7_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M69629.26,-672.52C69629.26,-679.1 69629.26,-684 69629.26,-684 69629.26,-684 67239,-684 67239,-684 67239,-684 67239,-547.92 67239,-547.92"/>
<polygon fill="black" stroke="black" points="67242.5,-547.92 67239,-537.92 67235.5,-547.92 67242.5,-547.92"/>
</g>
<!-- L7_S0_TP5_GPU5_expert0&#45;&gt;L7_S0_TP2_GPU2_moe_ar -->
<g id="edge2148" class="edge">
<title>L7_S0_TP5_GPU5_expert0&#45;&gt;L7_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M69629.7,-604.23C69629.7,-599.93 69629.7,-597 69629.7,-597 69629.7,-597 67919.84,-597 67919.84,-597 67919.84,-597 67919.84,-550.14 67919.84,-550.14"/>
<polygon fill="black" stroke="black" points="67923.34,-550.14 67919.84,-540.14 67916.34,-550.14 67923.34,-550.14"/>
</g>
<!-- L7_S0_TP5_GPU5_expert0&#45;&gt;L7_S0_TP3_GPU3_moe_ar -->
<g id="edge2200" class="edge">
<title>L7_S0_TP5_GPU5_expert0&#45;&gt;L7_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M69671.89,-604.23C69671.89,-599.93 69671.89,-597 69671.89,-597 69671.89,-597 68535.69,-597 68535.69,-597 68535.69,-597 68535.69,-564.68 68535.69,-564.68"/>
<polygon fill="black" stroke="black" points="68539.19,-564.68 68535.69,-554.68 68532.19,-564.68 68539.19,-564.68"/>
</g>
<!-- L7_S0_TP5_GPU5_expert0&#45;&gt;L7_S0_TP4_GPU4_moe_ar -->
<g id="edge2252" class="edge">
<title>L7_S0_TP5_GPU5_expert0&#45;&gt;L7_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M69714.09,-604.23C69714.09,-599.93 69714.09,-597 69714.09,-597 69714.09,-597 69221.48,-597 69221.48,-597 69221.48,-597 69221.48,-565.12 69221.48,-565.12"/>
<polygon fill="black" stroke="black" points="69224.98,-565.12 69221.48,-555.12 69217.98,-565.12 69224.98,-565.12"/>
</g>
<!-- L7_S0_TP5_GPU5_expert0&#45;&gt;L7_S0_TP5_GPU5_moe_ar -->
<g id="edge2304" class="edge">
<title>L7_S0_TP5_GPU5_expert0&#45;&gt;L7_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M69756.28,-604.34C69756.28,-604.34 69756.28,-577.23 69756.28,-577.23"/>
<polygon fill="black" stroke="black" points="69759.78,-577.23 69756.28,-567.23 69752.78,-577.23 69759.78,-577.23"/>
</g>
<!-- L7_S0_TP5_GPU5_expert0&#45;&gt;L7_S0_TP6_GPU6_moe_ar -->
<g id="edge2356" class="edge">
<title>L7_S0_TP5_GPU5_expert0&#45;&gt;L7_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M70032.02,-604.34C70032.02,-604.34 70032.02,-538.63 70032.02,-538.63"/>
<polygon fill="black" stroke="black" points="70035.52,-538.63 70032.02,-528.63 70028.52,-538.63 70035.52,-538.63"/>
</g>
<!-- L7_S0_TP5_GPU5_expert0&#45;&gt;L7_S0_TP7_GPU7_moe_ar -->
<g id="edge2408" class="edge">
<title>L7_S0_TP5_GPU5_expert0&#45;&gt;L7_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M70015.49,-604.33C70015.49,-600.53 70015.49,-598 70015.49,-598 70015.49,-598 70885.18,-598 70885.18,-598 70885.18,-598 70885.18,-572.39 70885.18,-572.39"/>
<polygon fill="black" stroke="black" points="70888.68,-572.39 70885.18,-562.39 70881.68,-572.39 70888.68,-572.39"/>
</g>
<!-- L7_S0_TP5_GPU5_expert1 -->
<g id="node757" class="node">
<title>L7_S0_TP5_GPU5_expert1</title>
<polygon fill="none" stroke="black" points="70503.5,-672.5 70054.5,-672.5 70054.5,-604.5 70503.5,-604.5 70503.5,-672.5"/>
<text text-anchor="middle" x="70279" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="70279" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="70279" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="70279" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L7_S0_TP5_GPU5_expert1&#45;&gt;L7_S0_TP0_GPU0_moe_ar -->
<g id="edge2045" class="edge">
<title>L7_S0_TP5_GPU5_expert1&#45;&gt;L7_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M70110.62,-604.23C70110.62,-599.93 70110.62,-597 70110.62,-597 70110.62,-597 66489.14,-597 66489.14,-597 66489.14,-597 66489.14,-562.89 66489.14,-562.89"/>
<polygon fill="black" stroke="black" points="66492.64,-562.89 66489.14,-552.89 66485.64,-562.89 66492.64,-562.89"/>
</g>
<!-- L7_S0_TP5_GPU5_expert1&#45;&gt;L7_S0_TP1_GPU1_moe_ar -->
<g id="edge2097" class="edge">
<title>L7_S0_TP5_GPU5_expert1&#45;&gt;L7_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M70279,-672.78C70279,-679.75 70279,-685 70279,-685 70279,-685 67236.75,-685 67236.75,-685 67236.75,-685 67236.75,-548.66 67236.75,-548.66"/>
<polygon fill="black" stroke="black" points="67240.25,-548.66 67236.75,-538.66 67233.25,-548.66 67240.25,-548.66"/>
</g>
<!-- L7_S0_TP5_GPU5_expert1&#45;&gt;L7_S0_TP2_GPU2_moe_ar -->
<g id="edge2149" class="edge">
<title>L7_S0_TP5_GPU5_expert1&#45;&gt;L7_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M70166.75,-672.78C70166.75,-679.75 70166.75,-685 70166.75,-685 70166.75,-685 67710.5,-685 67710.5,-685 67710.5,-685 67710.5,-576.7 67710.5,-576.7"/>
<polygon fill="black" stroke="black" points="67714,-576.7 67710.5,-566.7 67707,-576.7 67714,-576.7"/>
</g>
<!-- L7_S0_TP5_GPU5_expert1&#45;&gt;L7_S0_TP3_GPU3_moe_ar -->
<g id="edge2201" class="edge">
<title>L7_S0_TP5_GPU5_expert1&#45;&gt;L7_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M70222.88,-604.23C70222.88,-599.93 70222.88,-597 70222.88,-597 70222.88,-597 68585.58,-597 68585.58,-597 68585.58,-597 68585.58,-555.92 68585.58,-555.92"/>
<polygon fill="black" stroke="black" points="68589.08,-555.92 68585.58,-545.92 68582.08,-555.92 68589.08,-555.92"/>
</g>
<!-- L7_S0_TP5_GPU5_expert1&#45;&gt;L7_S0_TP4_GPU4_moe_ar -->
<g id="edge2253" class="edge">
<title>L7_S0_TP5_GPU5_expert1&#45;&gt;L7_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M70279,-604.23C70279,-599.93 70279,-597 70279,-597 70279,-597 69246.73,-597 69246.73,-597 69246.73,-597 69246.73,-561.12 69246.73,-561.12"/>
<polygon fill="black" stroke="black" points="69250.23,-561.12 69246.73,-551.12 69243.23,-561.12 69250.23,-561.12"/>
</g>
<!-- L7_S0_TP5_GPU5_expert1&#45;&gt;L7_S0_TP5_GPU5_moe_ar -->
<g id="edge2305" class="edge">
<title>L7_S0_TP5_GPU5_expert1&#45;&gt;L7_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M70335.12,-604.32C70335.12,-598.35 70335.12,-594 70335.12,-594 70335.12,-594 69798.48,-594 69798.48,-594 69798.48,-594 69798.48,-575.34 69798.48,-575.34"/>
<polygon fill="black" stroke="black" points="69801.98,-575.34 69798.48,-565.34 69794.98,-575.34 69801.98,-575.34"/>
</g>
<!-- L7_S0_TP5_GPU5_expert1&#45;&gt;L7_S0_TP6_GPU6_moe_ar -->
<g id="edge2357" class="edge">
<title>L7_S0_TP5_GPU5_expert1&#45;&gt;L7_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M70391.25,-604.34C70391.25,-604.34 70391.25,-578.55 70391.25,-578.55"/>
<polygon fill="black" stroke="black" points="70394.75,-578.55 70391.25,-568.55 70387.75,-578.55 70394.75,-578.55"/>
</g>
<!-- L7_S0_TP5_GPU5_expert1&#45;&gt;L7_S0_TP7_GPU7_moe_ar -->
<g id="edge2409" class="edge">
<title>L7_S0_TP5_GPU5_expert1&#45;&gt;L7_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M70447.38,-604.39C70447.38,-602.89 70447.38,-602 70447.38,-602 70447.38,-602 70913.62,-602 70913.62,-602 70913.62,-602 70913.62,-574.55 70913.62,-574.55"/>
<polygon fill="black" stroke="black" points="70917.12,-574.55 70913.62,-564.55 70910.12,-574.55 70917.12,-574.55"/>
</g>
<!-- L7_S0_TP6_GPU6_expert0 -->
<g id="node758" class="node">
<title>L7_S0_TP6_GPU6_expert0</title>
<polygon fill="none" stroke="black" points="70970.5,-672.5 70521.5,-672.5 70521.5,-604.5 70970.5,-604.5 70970.5,-672.5"/>
<text text-anchor="middle" x="70746" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="70746" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="70746" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="70746" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L7_S0_TP6_GPU6_expert0&#45;&gt;L7_S0_TP0_GPU0_moe_ar -->
<g id="edge2046" class="edge">
<title>L7_S0_TP6_GPU6_expert0&#45;&gt;L7_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M70540.94,-604.23C70540.94,-599.93 70540.94,-597 70540.94,-597 70540.94,-597 66517.58,-597 66517.58,-597 66517.58,-597 66517.58,-557.63 66517.58,-557.63"/>
<polygon fill="black" stroke="black" points="66521.08,-557.63 66517.58,-547.63 66514.08,-557.63 66521.08,-557.63"/>
</g>
<!-- L7_S0_TP6_GPU6_expert0&#45;&gt;L7_S0_TP1_GPU1_moe_ar -->
<g id="edge2098" class="edge">
<title>L7_S0_TP6_GPU6_expert0&#45;&gt;L7_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M70560.38,-604.23C70560.38,-599.93 70560.38,-597 70560.38,-597 70560.38,-597 66953.88,-597 66953.88,-597 66953.88,-597 66953.88,-578.48 66953.88,-578.48"/>
<polygon fill="black" stroke="black" points="66957.38,-578.48 66953.88,-568.48 66950.38,-578.48 66957.38,-578.48"/>
</g>
<!-- L7_S0_TP6_GPU6_expert0&#45;&gt;L7_S0_TP2_GPU2_moe_ar -->
<g id="edge2150" class="edge">
<title>L7_S0_TP6_GPU6_expert0&#45;&gt;L7_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M70705.5,-604.44C70705.5,-549.65 70705.5,-448 70705.5,-448 70705.5,-448 67921.97,-448 67921.97,-448 67921.97,-448 67921.97,-491.39 67921.97,-491.39"/>
<polygon fill="black" stroke="black" points="67918.47,-491.39 67921.97,-501.39 67925.47,-491.39 67918.47,-491.39"/>
</g>
<!-- L7_S0_TP6_GPU6_expert0&#45;&gt;L7_S0_TP3_GPU3_moe_ar -->
<g id="edge2202" class="edge">
<title>L7_S0_TP6_GPU6_expert0&#45;&gt;L7_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M70700.98,-604.44C70700.98,-549.65 70700.98,-448 70700.98,-448 70700.98,-448 68539.9,-448 68539.9,-448 68539.9,-448 68539.9,-476.75 68539.9,-476.75"/>
<polygon fill="black" stroke="black" points="68536.4,-476.75 68539.9,-486.75 68543.4,-476.75 68536.4,-476.75"/>
</g>
<!-- L7_S0_TP6_GPU6_expert0&#45;&gt;L7_S0_TP4_GPU4_moe_ar -->
<g id="edge2254" class="edge">
<title>L7_S0_TP6_GPU6_expert0&#45;&gt;L7_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M70579.82,-604.23C70579.82,-599.93 70579.82,-597 70579.82,-597 70579.82,-597 69271.97,-597 69271.97,-597 69271.97,-597 69271.97,-555.92 69271.97,-555.92"/>
<polygon fill="black" stroke="black" points="69275.47,-555.92 69271.97,-545.92 69268.47,-555.92 69275.47,-555.92"/>
</g>
<!-- L7_S0_TP6_GPU6_expert0&#45;&gt;L7_S0_TP5_GPU5_moe_ar -->
<g id="edge2306" class="edge">
<title>L7_S0_TP6_GPU6_expert0&#45;&gt;L7_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M70599.26,-604.32C70599.26,-598.35 70599.26,-594 70599.26,-594 70599.26,-594 69840.68,-594 69840.68,-594 69840.68,-594 69840.68,-572.37 69840.68,-572.37"/>
<polygon fill="black" stroke="black" points="69844.18,-572.37 69840.68,-562.37 69837.18,-572.37 69844.18,-572.37"/>
</g>
<!-- L7_S0_TP6_GPU6_expert0&#45;&gt;L7_S0_TP6_GPU6_moe_ar -->
<g id="edge2358" class="edge">
<title>L7_S0_TP6_GPU6_expert0&#45;&gt;L7_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M70618.7,-604.34C70618.7,-604.34 70618.7,-561.27 70618.7,-561.27"/>
<polygon fill="black" stroke="black" points="70622.2,-561.27 70618.7,-551.27 70615.2,-561.27 70622.2,-561.27"/>
</g>
<!-- L7_S0_TP6_GPU6_expert0&#45;&gt;L7_S0_TP7_GPU7_moe_ar -->
<g id="edge2410" class="edge">
<title>L7_S0_TP6_GPU6_expert0&#45;&gt;L7_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M70942.06,-604.34C70942.06,-604.34 70942.06,-576.36 70942.06,-576.36"/>
<polygon fill="black" stroke="black" points="70945.56,-576.36 70942.06,-566.36 70938.56,-576.36 70945.56,-576.36"/>
</g>
<!-- L7_S0_TP6_GPU6_expert1 -->
<g id="node759" class="node">
<title>L7_S0_TP6_GPU6_expert1</title>
<polygon fill="none" stroke="black" points="71437.5,-672.5 70988.5,-672.5 70988.5,-604.5 71437.5,-604.5 71437.5,-672.5"/>
<text text-anchor="middle" x="71213" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="71213" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="71213" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="71213" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L7_S0_TP6_GPU6_expert1&#45;&gt;L7_S0_TP0_GPU0_moe_ar -->
<g id="edge2047" class="edge">
<title>L7_S0_TP6_GPU6_expert1&#45;&gt;L7_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M71054.33,-604.23C71054.33,-599.93 71054.33,-597 71054.33,-597 71054.33,-597 66546.02,-597 66546.02,-597 66546.02,-597 66546.02,-550.14 66546.02,-550.14"/>
<polygon fill="black" stroke="black" points="66549.52,-550.14 66546.02,-540.14 66542.52,-550.14 66549.52,-550.14"/>
</g>
<!-- L7_S0_TP6_GPU6_expert1&#45;&gt;L7_S0_TP1_GPU1_moe_ar -->
<g id="edge2099" class="edge">
<title>L7_S0_TP6_GPU6_expert1&#45;&gt;L7_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M71423.99,-604.26C71423.99,-549.18 71423.99,-447 71423.99,-447 71423.99,-447 67190.6,-447 67190.6,-447 67190.6,-447 67190.6,-480.56 67190.6,-480.56"/>
<polygon fill="black" stroke="black" points="67187.1,-480.56 67190.6,-490.56 67194.1,-480.56 67187.1,-480.56"/>
</g>
<!-- L7_S0_TP6_GPU6_expert1&#45;&gt;L7_S0_TP2_GPU2_moe_ar -->
<g id="edge2151" class="edge">
<title>L7_S0_TP6_GPU6_expert1&#45;&gt;L7_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M71410.48,-604.26C71410.48,-549.18 71410.48,-447 71410.48,-447 71410.48,-447 67895.48,-447 67895.48,-447 67895.48,-447 67895.48,-484.33 67895.48,-484.33"/>
<polygon fill="black" stroke="black" points="67891.98,-484.33 67895.48,-494.33 67898.98,-484.33 67891.98,-484.33"/>
</g>
<!-- L7_S0_TP6_GPU6_expert1&#45;&gt;L7_S0_TP3_GPU3_moe_ar -->
<g id="edge2203" class="edge">
<title>L7_S0_TP6_GPU6_expert1&#45;&gt;L7_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M71396.97,-604.26C71396.97,-549.18 71396.97,-447 71396.97,-447 71396.97,-447 68444.34,-447 68444.34,-447 68444.34,-447 68444.34,-466.86 68444.34,-466.86"/>
<polygon fill="black" stroke="black" points="68440.84,-466.86 68444.34,-476.86 68447.84,-466.86 68440.84,-466.86"/>
</g>
<!-- L7_S0_TP6_GPU6_expert1&#45;&gt;L7_S0_TP4_GPU4_moe_ar -->
<g id="edge2255" class="edge">
<title>L7_S0_TP6_GPU6_expert1&#45;&gt;L7_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M71120.15,-604.19C71120.15,-599.36 71120.15,-596 71120.15,-596 71120.15,-596 69297.22,-596 69297.22,-596 69297.22,-596 69297.22,-549.1 69297.22,-549.1"/>
<polygon fill="black" stroke="black" points="69300.72,-549.1 69297.22,-539.1 69293.72,-549.1 69300.72,-549.1"/>
</g>
<!-- L7_S0_TP6_GPU6_expert1&#45;&gt;L7_S0_TP5_GPU5_moe_ar -->
<g id="edge2307" class="edge">
<title>L7_S0_TP6_GPU6_expert1&#45;&gt;L7_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M71185.98,-604.32C71185.98,-598.35 71185.98,-594 71185.98,-594 71185.98,-594 69882.87,-594 69882.87,-594 69882.87,-594 69882.87,-568.5 69882.87,-568.5"/>
<polygon fill="black" stroke="black" points="69886.37,-568.5 69882.87,-558.5 69879.37,-568.5 69886.37,-568.5"/>
</g>
<!-- L7_S0_TP6_GPU6_expert1&#45;&gt;L7_S0_TP6_GPU6_moe_ar -->
<g id="edge2359" class="edge">
<title>L7_S0_TP6_GPU6_expert1&#45;&gt;L7_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M71251.81,-604.32C71251.81,-598.35 71251.81,-594 71251.81,-594 71251.81,-594 70638.14,-594 70638.14,-594 70638.14,-594 70638.14,-557.82 70638.14,-557.82"/>
<polygon fill="black" stroke="black" points="70641.64,-557.82 70638.14,-547.82 70634.64,-557.82 70641.64,-557.82"/>
</g>
<!-- L7_S0_TP6_GPU6_expert1&#45;&gt;L7_S0_TP7_GPU7_moe_ar -->
<g id="edge2411" class="edge">
<title>L7_S0_TP6_GPU6_expert1&#45;&gt;L7_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M71317.63,-604.34C71317.63,-604.34 71317.63,-559.3 71317.63,-559.3"/>
<polygon fill="black" stroke="black" points="71321.13,-559.3 71317.63,-549.3 71314.13,-559.3 71321.13,-559.3"/>
</g>
<!-- L7_S0_TP7_GPU7_expert0 -->
<g id="node760" class="node">
<title>L7_S0_TP7_GPU7_expert0</title>
<polygon fill="none" stroke="black" points="71904.5,-672.5 71455.5,-672.5 71455.5,-604.5 71904.5,-604.5 71904.5,-672.5"/>
<text text-anchor="middle" x="71680" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="71680" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="71680" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="71680" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L7_S0_TP7_GPU7_expert0&#45;&gt;L7_S0_TP0_GPU0_moe_ar -->
<g id="edge2048" class="edge">
<title>L7_S0_TP7_GPU7_expert0&#45;&gt;L7_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M71848.38,-604.26C71848.38,-549.18 71848.38,-447 71848.38,-447 71848.38,-447 66357.23,-447 66357.23,-447 66357.23,-447 66357.23,-465.17 66357.23,-465.17"/>
<polygon fill="black" stroke="black" points="66353.73,-465.17 66357.23,-475.17 66360.73,-465.17 66353.73,-465.17"/>
</g>
<!-- L7_S0_TP7_GPU7_expert0&#45;&gt;L7_S0_TP1_GPU1_moe_ar -->
<g id="edge2100" class="edge">
<title>L7_S0_TP7_GPU7_expert0&#45;&gt;L7_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M71792.25,-604.26C71792.25,-549.18 71792.25,-447 71792.25,-447 71792.25,-447 67119.73,-447 67119.73,-447 67119.73,-447 67119.73,-470.7 67119.73,-470.7"/>
<polygon fill="black" stroke="black" points="67116.23,-470.7 67119.73,-480.7 67123.23,-470.7 67116.23,-470.7"/>
</g>
<!-- L7_S0_TP7_GPU7_expert0&#45;&gt;L7_S0_TP2_GPU2_moe_ar -->
<g id="edge2152" class="edge">
<title>L7_S0_TP7_GPU7_expert0&#45;&gt;L7_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M71736.12,-604.26C71736.12,-549.18 71736.12,-447 71736.12,-447 71736.12,-447 67868.98,-447 67868.98,-447 67868.98,-447 67868.98,-479.28 67868.98,-479.28"/>
<polygon fill="black" stroke="black" points="67865.48,-479.28 67868.98,-489.28 67872.48,-479.28 67865.48,-479.28"/>
</g>
<!-- L7_S0_TP7_GPU7_expert0&#45;&gt;L7_S0_TP3_GPU3_moe_ar -->
<g id="edge2204" class="edge">
<title>L7_S0_TP7_GPU7_expert0&#45;&gt;L7_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M71680,-604.26C71680,-549.18 71680,-447 71680,-447 71680,-447 68348.78,-447 68348.78,-447 68348.78,-447 68348.78,-462.68 68348.78,-462.68"/>
<polygon fill="black" stroke="black" points="68345.28,-462.68 68348.78,-472.68 68352.28,-462.68 68345.28,-462.68"/>
</g>
<!-- L7_S0_TP7_GPU7_expert0&#45;&gt;L7_S0_TP4_GPU4_moe_ar -->
<g id="edge2256" class="edge">
<title>L7_S0_TP7_GPU7_expert0&#45;&gt;L7_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M71662.14,-672.68C71662.14,-687.27 71662.14,-701 71662.14,-701 71662.14,-701 69111.5,-701 69111.5,-701 69111.5,-701 69111.5,-575.52 69111.5,-575.52"/>
<polygon fill="black" stroke="black" points="69115,-575.52 69111.5,-565.52 69108,-575.52 69115,-575.52"/>
</g>
<!-- L7_S0_TP7_GPU7_expert0&#45;&gt;L7_S0_TP5_GPU5_moe_ar -->
<g id="edge2308" class="edge">
<title>L7_S0_TP7_GPU7_expert0&#45;&gt;L7_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M71511.62,-604.32C71511.62,-598.35 71511.62,-594 71511.62,-594 71511.62,-594 69925.07,-594 69925.07,-594 69925.07,-594 69925.07,-562.48 69925.07,-562.48"/>
<polygon fill="black" stroke="black" points="69928.57,-562.48 69925.07,-552.48 69921.57,-562.48 69928.57,-562.48"/>
</g>
<!-- L7_S0_TP7_GPU7_expert0&#45;&gt;L7_S0_TP6_GPU6_moe_ar -->
<g id="edge2360" class="edge">
<title>L7_S0_TP7_GPU7_expert0&#45;&gt;L7_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M71567.75,-604.32C71567.75,-598.35 71567.75,-594 71567.75,-594 71567.75,-594 70657.58,-594 70657.58,-594 70657.58,-594 70657.58,-553.3 70657.58,-553.3"/>
<polygon fill="black" stroke="black" points="70661.08,-553.3 70657.58,-543.3 70654.08,-553.3 70661.08,-553.3"/>
</g>
<!-- L7_S0_TP7_GPU7_expert0&#45;&gt;L7_S0_TP7_GPU7_moe_ar -->
<g id="edge2412" class="edge">
<title>L7_S0_TP7_GPU7_expert0&#45;&gt;L7_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M71623.88,-604.31C71623.88,-580.13 71623.88,-552 71623.88,-552 71623.88,-552 71311.57,-552 71311.57,-552"/>
<polygon fill="black" stroke="black" points="71311.57,-548.5 71301.57,-552 71311.57,-555.5 71311.57,-548.5"/>
</g>
<!-- L7_S0_TP7_GPU7_expert1 -->
<g id="node761" class="node">
<title>L7_S0_TP7_GPU7_expert1</title>
<polygon fill="none" stroke="black" points="72371.5,-672.5 71922.5,-672.5 71922.5,-604.5 72371.5,-604.5 72371.5,-672.5"/>
<text text-anchor="middle" x="72147" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="72147" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="72147" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="72147" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L7_S0_TP7_GPU7_expert1&#45;&gt;L7_S0_TP0_GPU0_moe_ar -->
<g id="edge2049" class="edge">
<title>L7_S0_TP7_GPU7_expert1&#45;&gt;L7_S0_TP0_GPU0_moe_ar</title>
<path fill="none" stroke="black" d="M71980.72,-604.26C71980.72,-549.18 71980.72,-447 71980.72,-447 71980.72,-447 66248.62,-447 66248.62,-447 66248.62,-447 66248.62,-462.27 66248.62,-462.27"/>
<polygon fill="black" stroke="black" points="66245.12,-462.27 66248.62,-472.27 66252.12,-462.27 66245.12,-462.27"/>
</g>
<!-- L7_S0_TP7_GPU7_expert1&#45;&gt;L7_S0_TP1_GPU1_moe_ar -->
<g id="edge2101" class="edge">
<title>L7_S0_TP7_GPU7_expert1&#45;&gt;L7_S0_TP1_GPU1_moe_ar</title>
<path fill="none" stroke="black" d="M71973.44,-604.26C71973.44,-549.18 71973.44,-447 71973.44,-447 71973.44,-447 67048.87,-447 67048.87,-447 67048.87,-447 67048.87,-465.59 67048.87,-465.59"/>
<polygon fill="black" stroke="black" points="67045.37,-465.59 67048.87,-475.59 67052.37,-465.59 67045.37,-465.59"/>
</g>
<!-- L7_S0_TP7_GPU7_expert1&#45;&gt;L7_S0_TP2_GPU2_moe_ar -->
<g id="edge2153" class="edge">
<title>L7_S0_TP7_GPU7_expert1&#45;&gt;L7_S0_TP2_GPU2_moe_ar</title>
<path fill="none" stroke="black" d="M71966.17,-604.26C71966.17,-549.18 71966.17,-447 71966.17,-447 71966.17,-447 67842.49,-447 67842.49,-447 67842.49,-447 67842.49,-475 67842.49,-475"/>
<polygon fill="black" stroke="black" points="67838.99,-475 67842.49,-485 67845.99,-475 67838.99,-475"/>
</g>
<!-- L7_S0_TP7_GPU7_expert1&#45;&gt;L7_S0_TP3_GPU3_moe_ar -->
<g id="edge2205" class="edge">
<title>L7_S0_TP7_GPU7_expert1&#45;&gt;L7_S0_TP3_GPU3_moe_ar</title>
<path fill="none" stroke="black" d="M71958.89,-604.26C71958.89,-549.18 71958.89,-447 71958.89,-447 71958.89,-447 68253.22,-447 68253.22,-447 68253.22,-447 68253.22,-462.68 68253.22,-462.68"/>
<polygon fill="black" stroke="black" points="68249.72,-462.68 68253.22,-472.68 68256.72,-462.68 68249.72,-462.68"/>
</g>
<!-- L7_S0_TP7_GPU7_expert1&#45;&gt;L7_S0_TP4_GPU4_moe_ar -->
<g id="edge2257" class="edge">
<title>L7_S0_TP7_GPU7_expert1&#45;&gt;L7_S0_TP4_GPU4_moe_ar</title>
<path fill="none" stroke="black" d="M71951.61,-604.2C71951.61,-555.2 71951.61,-471 71951.61,-471 71951.61,-471 69211.05,-471 69211.05,-471 69211.05,-471 69211.05,-474.5 69211.05,-474.5"/>
<polygon fill="black" stroke="black" points="69207.55,-474.5 69211.05,-484.5 69214.55,-474.5 69207.55,-474.5"/>
</g>
<!-- L7_S0_TP7_GPU7_expert1&#45;&gt;L7_S0_TP5_GPU5_moe_ar -->
<g id="edge2309" class="edge">
<title>L7_S0_TP7_GPU7_expert1&#45;&gt;L7_S0_TP5_GPU5_moe_ar</title>
<path fill="none" stroke="black" d="M71929.78,-604.32C71929.78,-598.35 71929.78,-594 71929.78,-594 71929.78,-594 69967.27,-594 69967.27,-594 69967.27,-594 69967.27,-554.1 69967.27,-554.1"/>
<polygon fill="black" stroke="black" points="69970.77,-554.1 69967.27,-544.1 69963.77,-554.1 69970.77,-554.1"/>
</g>
<!-- L7_S0_TP7_GPU7_expert1&#45;&gt;L7_S0_TP6_GPU6_moe_ar -->
<g id="edge2361" class="edge">
<title>L7_S0_TP7_GPU7_expert1&#45;&gt;L7_S0_TP6_GPU6_moe_ar</title>
<path fill="none" stroke="black" d="M71937.06,-604.32C71937.06,-598.35 71937.06,-594 71937.06,-594 71937.06,-594 70677.02,-594 70677.02,-594 70677.02,-594 70677.02,-546.75 70677.02,-546.75"/>
<polygon fill="black" stroke="black" points="70680.52,-546.75 70677.02,-536.75 70673.52,-546.75 70680.52,-546.75"/>
</g>
<!-- L7_S0_TP7_GPU7_expert1&#45;&gt;L7_S0_TP7_GPU7_moe_ar -->
<g id="edge2413" class="edge">
<title>L7_S0_TP7_GPU7_expert1&#45;&gt;L7_S0_TP7_GPU7_moe_ar</title>
<path fill="none" stroke="black" d="M71944.33,-604.37C71944.33,-574.55 71944.33,-536 71944.33,-536 71944.33,-536 71375.61,-536 71375.61,-536"/>
<polygon fill="black" stroke="black" points="71375.61,-532.5 71365.61,-536 71375.61,-539.5 71375.61,-532.5"/>
</g>
<!-- L7_S0_TP0_GPU0_norm -->
<g id="node763" class="node">
<title>L7_S0_TP0_GPU0_norm</title>
<polygon fill="none" stroke="black" points="67234.5,-332.33 66785.5,-332.33 66785.5,-264.33 67234.5,-264.33 67234.5,-332.33"/>
<text text-anchor="middle" x="67010" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="67010" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="67010" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="67010" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP0_GPU0_moe_res&#45;&gt;L7_S0_TP0_GPU0_norm -->
<g id="edge2052" class="edge">
<title>L7_S0_TP0_GPU0_moe_res&#45;&gt;L7_S0_TP0_GPU0_norm</title>
<path fill="none" stroke="black" d="M66081.75,-368.17C66081.75,-337.74 66081.75,-298 66081.75,-298 66081.75,-298 66775.3,-298 66775.3,-298"/>
<polygon fill="black" stroke="black" points="66775.3,-301.5 66785.3,-298 66775.3,-294.5 66775.3,-301.5"/>
</g>
<!-- L7_send_stage1 -->
<g id="node764" class="node">
<title>L7_send_stage1</title>
<ellipse fill="none" stroke="black" cx="68644" cy="-180.25" rx="317.48" ry="48.17"/>
<text text-anchor="middle" x="68644" y="-199.05" font-family="Times,serif" font-size="14.00">Send to Stage1</text>
<text text-anchor="middle" x="68644" y="-184.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="68644" y="-169.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="68644" y="-154.05" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP0_GPU0_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2053" class="edge">
<title>L7_S0_TP0_GPU0_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M67184.61,-264.17C67184.61,-233.74 67184.61,-194 67184.61,-194 67184.61,-194 68329.4,-194 68329.4,-194"/>
<polygon fill="black" stroke="black" points="68329.4,-197.5 68339.4,-194 68329.4,-190.5 68329.4,-197.5"/>
</g>
<!-- L7_S0_TP0_GPU0_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2105" class="edge">
<title>L7_S0_TP0_GPU0_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M67134.72,-264.13C67134.72,-233.38 67134.72,-193 67134.72,-193 67134.72,-193 68327.67,-193 68327.67,-193"/>
<polygon fill="black" stroke="black" points="68327.67,-196.5 68337.67,-193 68327.67,-189.5 68327.67,-196.5"/>
</g>
<!-- L7_S0_TP0_GPU0_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2157" class="edge">
<title>L7_S0_TP0_GPU0_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M67084.83,-264.08C67084.83,-232.67 67084.83,-191 67084.83,-191 67084.83,-191 68324.09,-191 68324.09,-191"/>
<polygon fill="black" stroke="black" points="68324.09,-194.5 68334.09,-191 68324.09,-187.5 68324.09,-194.5"/>
</g>
<!-- L7_S0_TP0_GPU0_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2209" class="edge">
<title>L7_S0_TP0_GPU0_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M67034.94,-264.04C67034.94,-231.98 67034.94,-189 67034.94,-189 67034.94,-189 68321.37,-189 68321.37,-189"/>
<polygon fill="black" stroke="black" points="68321.37,-192.5 68331.37,-189 68321.37,-185.5 68321.37,-192.5"/>
</g>
<!-- L7_S0_TP0_GPU0_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2261" class="edge">
<title>L7_S0_TP0_GPU0_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M66985.06,-264.32C66985.06,-231.58 66985.06,-187 66985.06,-187 66985.06,-187 68319.53,-187 68319.53,-187"/>
<polygon fill="black" stroke="black" points="68319.53,-190.5 68329.53,-187 68319.53,-183.5 68319.53,-190.5"/>
</g>
<!-- L7_S0_TP0_GPU0_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2313" class="edge">
<title>L7_S0_TP0_GPU0_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M66935.17,-264.33C66935.17,-230.95 66935.17,-185 66935.17,-185 66935.17,-185 68317.58,-185 68317.58,-185"/>
<polygon fill="black" stroke="black" points="68317.58,-188.5 68327.58,-185 68317.58,-181.5 68317.58,-188.5"/>
</g>
<!-- L7_S0_TP0_GPU0_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2365" class="edge">
<title>L7_S0_TP0_GPU0_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M66885.28,-264.04C66885.28,-230.04 66885.28,-183 66885.28,-183 66885.28,-183 68316.78,-183 68316.78,-183"/>
<polygon fill="black" stroke="black" points="68316.78,-186.5 68326.78,-183 68316.78,-179.5 68316.78,-186.5"/>
</g>
<!-- L7_S0_TP0_GPU0_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2417" class="edge">
<title>L7_S0_TP0_GPU0_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M66835.39,-264.08C66835.39,-229.45 66835.39,-181 66835.39,-181 66835.39,-181 68316.38,-181 68316.38,-181"/>
<polygon fill="black" stroke="black" points="68316.38,-184.5 68326.38,-181 68316.38,-177.5 68316.38,-184.5"/>
</g>
<!-- L8_recv_from_stage0_TP0 -->
<g id="node772" class="node">
<title>L8_recv_from_stage0_TP0</title>
<ellipse fill="none" stroke="black" cx="66359" cy="-48.08" rx="317.48" ry="48.17"/>
<text text-anchor="middle" x="66359" y="-66.88" font-family="Times,serif" font-size="14.00">Recv from Stage0</text>
<text text-anchor="middle" x="66359" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="66359" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="66359" y="-21.88" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP0 -->
<g id="edge2061" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP0</title>
<path fill="none" stroke="black" d="M68326.32,-179C67664.63,-179 66199.61,-179 66199.61,-179 66199.61,-179 66199.61,-99.87 66199.61,-99.87"/>
<polygon fill="black" stroke="black" points="66203.11,-99.87 66199.61,-89.87 66196.11,-99.87 66203.11,-99.87"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP0 -->
<g id="edge2113" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP0</title>
<path fill="none" stroke="black" d="M68327.01,-177C67678.16,-177 66259.22,-177 66259.22,-177 66259.22,-177 66259.22,-103.9 66259.22,-103.9"/>
<polygon fill="black" stroke="black" points="66262.72,-103.9 66259.22,-93.9 66255.72,-103.9 66262.72,-103.9"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP0 -->
<g id="edge2165" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP0</title>
<path fill="none" stroke="black" d="M68328.3,-175C67692.69,-175 66318.83,-175 66318.83,-175 66318.83,-175 66318.83,-106.07 66318.83,-106.07"/>
<polygon fill="black" stroke="black" points="66322.33,-106.07 66318.83,-96.07 66315.33,-106.07 66322.33,-106.07"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP0 -->
<g id="edge2217" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP0</title>
<path fill="none" stroke="black" d="M68329.88,-173C67707.74,-173 66378.44,-173 66378.44,-173 66378.44,-173 66378.44,-106.38 66378.44,-106.38"/>
<polygon fill="black" stroke="black" points="66381.94,-106.38 66378.44,-96.38 66374.94,-106.38 66381.94,-106.38"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP0 -->
<g id="edge2269" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP0</title>
<path fill="none" stroke="black" d="M68332.33,-171C67724.14,-171 66438.05,-171 66438.05,-171 66438.05,-171 66438.05,-104.9 66438.05,-104.9"/>
<polygon fill="black" stroke="black" points="66441.55,-104.9 66438.05,-94.9 66434.55,-104.9 66441.55,-104.9"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP0 -->
<g id="edge2321" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP0</title>
<path fill="none" stroke="black" d="M68335.05,-169C67741,-169 66497.66,-169 66497.66,-169 66497.66,-169 66497.66,-101.4 66497.66,-101.4"/>
<polygon fill="black" stroke="black" points="66501.16,-101.4 66497.66,-91.4 66494.16,-101.4 66501.16,-101.4"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP0 -->
<g id="edge2373" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP0</title>
<path fill="none" stroke="black" d="M68338.62,-167C67759.11,-167 66557.27,-167 66557.27,-167 66557.27,-167 66557.27,-95.71 66557.27,-95.71"/>
<polygon fill="black" stroke="black" points="66560.77,-95.71 66557.27,-85.71 66553.77,-95.71 66560.77,-95.71"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP0 -->
<g id="edge2425" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP0</title>
<path fill="none" stroke="black" d="M68342.71,-165C67778.02,-165 66616.88,-165 66616.88,-165 66616.88,-165 66616.88,-86.39 66616.88,-86.39"/>
<polygon fill="black" stroke="black" points="66620.38,-86.39 66616.88,-76.39 66613.38,-86.39 66620.38,-86.39"/>
</g>
<!-- L8_recv_from_stage0_TP1 -->
<g id="node773" class="node">
<title>L8_recv_from_stage0_TP1</title>
<ellipse fill="none" stroke="black" cx="67012" cy="-48.08" rx="317.48" ry="48.17"/>
<text text-anchor="middle" x="67012" y="-66.88" font-family="Times,serif" font-size="14.00">Recv from Stage0</text>
<text text-anchor="middle" x="67012" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="67012" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="67012" y="-21.88" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP1 -->
<g id="edge2062" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP1</title>
<path fill="none" stroke="black" d="M68347.32,-163C67940.97,-163 67261.05,-163 67261.05,-163 67261.05,-163 67261.05,-87.98 67261.05,-87.98"/>
<polygon fill="black" stroke="black" points="67264.55,-87.98 67261.05,-77.98 67257.55,-87.98 67264.55,-87.98"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP1 -->
<g id="edge2114" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP1</title>
<path fill="none" stroke="black" d="M68352.95,-161C67949.56,-161 67269.61,-161 67269.61,-161 67269.61,-161 67269.61,-86.29 67269.61,-86.29"/>
<polygon fill="black" stroke="black" points="67273.11,-86.29 67269.61,-76.29 67266.11,-86.29 67273.11,-86.29"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP1 -->
<g id="edge2166" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP1</title>
<path fill="none" stroke="black" d="M68358.92,-159C67958.58,-159 67278.16,-159 67278.16,-159 67278.16,-159 67278.16,-84.37 67278.16,-84.37"/>
<polygon fill="black" stroke="black" points="67281.66,-84.37 67278.16,-74.37 67274.66,-84.37 67281.66,-84.37"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP1 -->
<g id="edge2218" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP1</title>
<path fill="none" stroke="black" d="M68366.06,-157C67968.97,-157 67286.72,-157 67286.72,-157 67286.72,-157 67286.72,-82.26 67286.72,-82.26"/>
<polygon fill="black" stroke="black" points="67290.22,-82.26 67286.72,-72.26 67283.22,-82.26 67290.22,-82.26"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP1 -->
<g id="edge2270" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP1</title>
<path fill="none" stroke="black" d="M68373.5,-155C67979.77,-155 67295.27,-155 67295.27,-155 67295.27,-155 67295.27,-79.98 67295.27,-79.98"/>
<polygon fill="black" stroke="black" points="67298.77,-79.98 67295.27,-69.98 67291.77,-79.98 67298.77,-79.98"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP1 -->
<g id="edge2322" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP1</title>
<path fill="none" stroke="black" d="M68382.02,-153C67991.94,-153 67303.83,-153 67303.83,-153 67303.83,-153 67303.83,-77.33 67303.83,-77.33"/>
<polygon fill="black" stroke="black" points="67307.33,-77.33 67303.83,-67.33 67300.33,-77.33 67307.33,-77.33"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP1 -->
<g id="edge2374" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP1</title>
<path fill="none" stroke="black" d="M68391.97,-151C68005.92,-151 67312.38,-151 67312.38,-151 67312.38,-151 67312.38,-73.71 67312.38,-73.71"/>
<polygon fill="black" stroke="black" points="67315.88,-73.71 67312.38,-63.71 67308.88,-73.71 67315.88,-73.71"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP1 -->
<g id="edge2426" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP1</title>
<path fill="none" stroke="black" d="M68402.48,-149C68020.78,-149 67320.94,-149 67320.94,-149 67320.94,-149 67320.94,-69.27 67320.94,-69.27"/>
<polygon fill="black" stroke="black" points="67324.44,-69.27 67320.94,-59.27 67317.44,-69.27 67324.44,-69.27"/>
</g>
<!-- L8_recv_from_stage0_TP2 -->
<g id="node774" class="node">
<title>L8_recv_from_stage0_TP2</title>
<ellipse fill="none" stroke="black" cx="67665" cy="-48.08" rx="317.48" ry="48.17"/>
<text text-anchor="middle" x="67665" y="-66.88" font-family="Times,serif" font-size="14.00">Recv from Stage0</text>
<text text-anchor="middle" x="67665" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="67665" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="67665" y="-21.88" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP2 -->
<g id="edge2063" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP2</title>
<path fill="none" stroke="black" d="M68414.61,-147C68149.35,-147 67748.72,-147 67748.72,-147 67748.72,-147 67748.72,-104.65 67748.72,-104.65"/>
<polygon fill="black" stroke="black" points="67752.22,-104.65 67748.72,-94.65 67745.22,-104.65 67752.22,-104.65"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP2 -->
<g id="edge2115" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP2</title>
<path fill="none" stroke="black" d="M68427.97,-145C68171.46,-145 67777.94,-145 67777.94,-145 67777.94,-145 67777.94,-103.14 67777.94,-103.14"/>
<polygon fill="black" stroke="black" points="67781.44,-103.14 67777.94,-93.14 67774.44,-103.14 67781.44,-103.14"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP2 -->
<g id="edge2167" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP2</title>
<path fill="none" stroke="black" d="M68443.02,-143C68195.43,-143 67807.16,-143 67807.16,-143 67807.16,-143 67807.16,-101.1 67807.16,-101.1"/>
<polygon fill="black" stroke="black" points="67810.66,-101.1 67807.16,-91.1 67803.66,-101.1 67810.66,-101.1"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP2 -->
<g id="edge2219" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP2</title>
<path fill="none" stroke="black" d="M68460.49,-141C68222.19,-141 67836.38,-141 67836.38,-141 67836.38,-141 67836.38,-98.57 67836.38,-98.57"/>
<polygon fill="black" stroke="black" points="67839.88,-98.57 67836.38,-88.57 67832.88,-98.57 67839.88,-98.57"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP2 -->
<g id="edge2271" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP2</title>
<path fill="none" stroke="black" d="M68470.28,-140C68240.87,-140 67865.61,-140 67865.61,-140 67865.61,-140 67865.61,-95.47 67865.61,-95.47"/>
<polygon fill="black" stroke="black" points="67869.11,-95.47 67865.61,-85.47 67862.11,-95.47 67869.11,-95.47"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP2 -->
<g id="edge2323" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP2</title>
<path fill="none" stroke="black" d="M68492.39,-138C68273.48,-138 67894.83,-138 67894.83,-138 67894.83,-138 67894.83,-91.31 67894.83,-91.31"/>
<polygon fill="black" stroke="black" points="67898.33,-91.31 67894.83,-81.31 67891.33,-91.31 67898.33,-91.31"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP2 -->
<g id="edge2375" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP2</title>
<path fill="none" stroke="black" d="M68519.42,-136C68313.36,-136 67924.05,-136 67924.05,-136 67924.05,-136 67924.05,-85.9 67924.05,-85.9"/>
<polygon fill="black" stroke="black" points="67927.55,-85.9 67924.05,-75.9 67920.55,-85.9 67927.55,-85.9"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP2 -->
<g id="edge2427" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP2</title>
<path fill="none" stroke="black" d="M68556.87,-134C68371.18,-134 67953.27,-134 67953.27,-134 67953.27,-134 67953.27,-78.44 67953.27,-78.44"/>
<polygon fill="black" stroke="black" points="67956.77,-78.44 67953.27,-68.44 67949.77,-78.44 67956.77,-78.44"/>
</g>
<!-- L8_recv_from_stage0_TP3 -->
<g id="node775" class="node">
<title>L8_recv_from_stage0_TP3</title>
<ellipse fill="none" stroke="black" cx="68318" cy="-48.08" rx="317.48" ry="48.17"/>
<text text-anchor="middle" x="68318" y="-66.88" font-family="Times,serif" font-size="14.00">Recv from Stage0</text>
<text text-anchor="middle" x="68318" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="68318" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="68318" y="-21.88" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP3 -->
<g id="edge2064" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP3</title>
<path fill="none" stroke="black" d="M68360.84,-158.43C68360.84,-158.43 68360.84,-105.73 68360.84,-105.73"/>
<polygon fill="black" stroke="black" points="68364.34,-105.73 68360.84,-95.73 68357.34,-105.73 68364.34,-105.73"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP3 -->
<g id="edge2116" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP3</title>
<path fill="none" stroke="black" d="M68395.17,-150.26C68395.17,-150.26 68395.17,-104.81 68395.17,-104.81"/>
<polygon fill="black" stroke="black" points="68398.67,-104.81 68395.17,-94.81 68391.67,-104.81 68398.67,-104.81"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP3 -->
<g id="edge2168" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP3</title>
<path fill="none" stroke="black" d="M68429.5,-144.48C68429.5,-144.48 68429.5,-103.35 68429.5,-103.35"/>
<polygon fill="black" stroke="black" points="68433,-103.35 68429.5,-93.35 68426,-103.35 68433,-103.35"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP3 -->
<g id="edge2220" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP3</title>
<path fill="none" stroke="black" d="M68463.83,-140.6C68463.83,-140.6 68463.83,-100.93 68463.83,-100.93"/>
<polygon fill="black" stroke="black" points="68467.33,-100.93 68463.83,-90.93 68460.33,-100.93 68467.33,-100.93"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP3 -->
<g id="edge2272" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP3</title>
<path fill="none" stroke="black" d="M68498.17,-137.34C68498.17,-137.34 68498.17,-98.09 68498.17,-98.09"/>
<polygon fill="black" stroke="black" points="68501.67,-98.09 68498.17,-88.09 68494.67,-98.09 68501.67,-98.09"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP3 -->
<g id="edge2324" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP3</title>
<path fill="none" stroke="black" d="M68532.5,-135.14C68532.5,-135.14 68532.5,-93.83 68532.5,-93.83"/>
<polygon fill="black" stroke="black" points="68536,-93.83 68532.5,-83.83 68529,-93.83 68536,-93.83"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP3 -->
<g id="edge2376" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP3</title>
<path fill="none" stroke="black" d="M68566.83,-133.28C68566.83,-133.28 68566.83,-88 68566.83,-88"/>
<polygon fill="black" stroke="black" points="68570.33,-88 68566.83,-78 68563.33,-88 68570.33,-88"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP3 -->
<g id="edge2428" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP3</title>
<path fill="none" stroke="black" d="M68601.16,-132.53C68601.16,-132.53 68601.16,-79.85 68601.16,-79.85"/>
<polygon fill="black" stroke="black" points="68604.66,-79.85 68601.16,-69.85 68597.66,-79.85 68604.66,-79.85"/>
</g>
<!-- L8_recv_from_stage0_TP4 -->
<g id="node776" class="node">
<title>L8_recv_from_stage0_TP4</title>
<ellipse fill="none" stroke="black" cx="68971" cy="-48.08" rx="317.48" ry="48.17"/>
<text text-anchor="middle" x="68971" y="-66.88" font-family="Times,serif" font-size="14.00">Recv from Stage0</text>
<text text-anchor="middle" x="68971" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="68971" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="68971" y="-21.88" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP4 -->
<g id="edge2065" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP4</title>
<path fill="none" stroke="black" d="M68687.73,-132.53C68687.73,-132.53 68687.73,-79.85 68687.73,-79.85"/>
<polygon fill="black" stroke="black" points="68691.23,-79.85 68687.73,-69.85 68684.23,-79.85 68691.23,-79.85"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP4 -->
<g id="edge2117" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP4</title>
<path fill="none" stroke="black" d="M68721.95,-133.28C68721.95,-133.28 68721.95,-88 68721.95,-88"/>
<polygon fill="black" stroke="black" points="68725.45,-88 68721.95,-78 68718.45,-88 68725.45,-88"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP4 -->
<g id="edge2169" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP4</title>
<path fill="none" stroke="black" d="M68756.17,-135.14C68756.17,-135.14 68756.17,-93.83 68756.17,-93.83"/>
<polygon fill="black" stroke="black" points="68759.67,-93.83 68756.17,-83.83 68752.67,-93.83 68759.67,-93.83"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP4 -->
<g id="edge2221" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP4</title>
<path fill="none" stroke="black" d="M68790.39,-137.34C68790.39,-137.34 68790.39,-97.65 68790.39,-97.65"/>
<polygon fill="black" stroke="black" points="68793.89,-97.65 68790.39,-87.65 68786.89,-97.65 68793.89,-97.65"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP4 -->
<g id="edge2273" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP4</title>
<path fill="none" stroke="black" d="M68824.61,-140.6C68824.61,-140.6 68824.61,-100.93 68824.61,-100.93"/>
<polygon fill="black" stroke="black" points="68828.11,-100.93 68824.61,-90.93 68821.11,-100.93 68828.11,-100.93"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP4 -->
<g id="edge2325" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP4</title>
<path fill="none" stroke="black" d="M68858.83,-144.83C68858.83,-144.83 68858.83,-103.08 68858.83,-103.08"/>
<polygon fill="black" stroke="black" points="68862.33,-103.08 68858.83,-93.08 68855.33,-103.08 68862.33,-103.08"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP4 -->
<g id="edge2377" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP4</title>
<path fill="none" stroke="black" d="M68893.05,-150.26C68893.05,-150.26 68893.05,-104.81 68893.05,-104.81"/>
<polygon fill="black" stroke="black" points="68896.55,-104.81 68893.05,-94.81 68889.55,-104.81 68896.55,-104.81"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP4 -->
<g id="edge2429" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP4</title>
<path fill="none" stroke="black" d="M68927.27,-158.43C68927.27,-158.43 68927.27,-105.73 68927.27,-105.73"/>
<polygon fill="black" stroke="black" points="68930.77,-105.73 68927.27,-95.73 68923.77,-105.73 68930.77,-105.73"/>
</g>
<!-- L8_recv_from_stage0_TP5 -->
<g id="node777" class="node">
<title>L8_recv_from_stage0_TP5</title>
<ellipse fill="none" stroke="black" cx="69624" cy="-48.08" rx="317.48" ry="48.17"/>
<text text-anchor="middle" x="69624" y="-66.88" font-family="Times,serif" font-size="14.00">Recv from Stage0</text>
<text text-anchor="middle" x="69624" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="69624" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="69624" y="-21.88" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP5 -->
<g id="edge2066" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP5</title>
<path fill="none" stroke="black" d="M68866.99,-146C69132.44,-146 69540.28,-146 69540.28,-146 69540.28,-146 69540.28,-104.75 69540.28,-104.75"/>
<polygon fill="black" stroke="black" points="69543.78,-104.75 69540.28,-94.75 69536.78,-104.75 69543.78,-104.75"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP5 -->
<g id="edge2118" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP5</title>
<path fill="none" stroke="black" d="M68860,-145C69116.8,-145 69511.06,-145 69511.06,-145 69511.06,-145 69511.06,-103.14 69511.06,-103.14"/>
<polygon fill="black" stroke="black" points="69514.56,-103.14 69511.06,-93.14 69507.56,-103.14 69514.56,-103.14"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP5 -->
<g id="edge2170" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP5</title>
<path fill="none" stroke="black" d="M68844.95,-143C69092.83,-143 69481.84,-143 69481.84,-143 69481.84,-143 69481.84,-101.1 69481.84,-101.1"/>
<polygon fill="black" stroke="black" points="69485.34,-101.1 69481.84,-91.1 69478.34,-101.1 69485.34,-101.1"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP5 -->
<g id="edge2222" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP5</title>
<path fill="none" stroke="black" d="M68827.49,-141C69066.06,-141 69452.62,-141 69452.62,-141 69452.62,-141 69452.62,-98.57 69452.62,-98.57"/>
<polygon fill="black" stroke="black" points="69456.12,-98.57 69452.62,-88.57 69449.12,-98.57 69456.12,-98.57"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP5 -->
<g id="edge2274" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP5</title>
<path fill="none" stroke="black" d="M68807.39,-139C69035.93,-139 69423.39,-139 69423.39,-139 69423.39,-139 69423.39,-95.59 69423.39,-95.59"/>
<polygon fill="black" stroke="black" points="69426.89,-95.59 69423.39,-85.59 69419.89,-95.59 69426.89,-95.59"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP5 -->
<g id="edge2326" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP5</title>
<path fill="none" stroke="black" d="M68782.91,-137C68999.76,-137 69394.17,-137 69394.17,-137 69394.17,-137 69394.17,-91.45 69394.17,-91.45"/>
<polygon fill="black" stroke="black" points="69397.67,-91.45 69394.17,-81.45 69390.67,-91.45 69397.67,-91.45"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP5 -->
<g id="edge2378" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP5</title>
<path fill="none" stroke="black" d="M68751.54,-135C68952.52,-135 69364.95,-135 69364.95,-135 69364.95,-135 69364.95,-86.06 69364.95,-86.06"/>
<polygon fill="black" stroke="black" points="69368.45,-86.06 69364.95,-76.06 69361.45,-86.06 69368.45,-86.06"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP5 -->
<g id="edge2430" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP5</title>
<path fill="none" stroke="black" d="M68730.91,-134C68916.69,-134 69335.73,-134 69335.73,-134 69335.73,-134 69335.73,-78.44 69335.73,-78.44"/>
<polygon fill="black" stroke="black" points="69339.23,-78.44 69335.73,-68.44 69332.23,-78.44 69339.23,-78.44"/>
</g>
<!-- L8_recv_from_stage0_TP6 -->
<g id="node778" class="node">
<title>L8_recv_from_stage0_TP6</title>
<ellipse fill="none" stroke="black" cx="70277" cy="-48.08" rx="317.48" ry="48.17"/>
<text text-anchor="middle" x="70277" y="-66.88" font-family="Times,serif" font-size="14.00">Recv from Stage0</text>
<text text-anchor="middle" x="70277" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="70277" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="70277" y="-21.88" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP6 -->
<g id="edge2067" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP6</title>
<path fill="none" stroke="black" d="M68934.96,-161C69340.89,-161 70027.95,-161 70027.95,-161 70027.95,-161 70027.95,-88.05 70027.95,-88.05"/>
<polygon fill="black" stroke="black" points="70031.45,-88.05 70027.95,-78.05 70024.45,-88.05 70031.45,-88.05"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP6 -->
<g id="edge2119" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP6</title>
<path fill="none" stroke="black" d="M68928.98,-159C69331.84,-159 70019.39,-159 70019.39,-159 70019.39,-159 70019.39,-86.36 70019.39,-86.36"/>
<polygon fill="black" stroke="black" points="70022.89,-86.36 70019.39,-76.36 70015.89,-86.36 70022.89,-86.36"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP6 -->
<g id="edge2171" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP6</title>
<path fill="none" stroke="black" d="M68925.55,-158C69325.68,-158 70010.84,-158 70010.84,-158 70010.84,-158 70010.84,-84.41 70010.84,-84.41"/>
<polygon fill="black" stroke="black" points="70014.34,-84.41 70010.84,-74.41 70007.34,-84.41 70014.34,-84.41"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP6 -->
<g id="edge2223" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP6</title>
<path fill="none" stroke="black" d="M68918.46,-156C69315.29,-156 70002.28,-156 70002.28,-156 70002.28,-156 70002.28,-82.3 70002.28,-82.3"/>
<polygon fill="black" stroke="black" points="70005.78,-82.3 70002.28,-72.3 69998.78,-82.3 70005.78,-82.3"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP6 -->
<g id="edge2275" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP6</title>
<path fill="none" stroke="black" d="M68910.26,-154C69303.54,-154 69993.73,-154 69993.73,-154 69993.73,-154 69993.73,-80.03 69993.73,-80.03"/>
<polygon fill="black" stroke="black" points="69997.23,-80.03 69993.73,-70.03 69990.23,-80.03 69997.23,-80.03"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP6 -->
<g id="edge2327" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP6</title>
<path fill="none" stroke="black" d="M68901,-152C69290.44,-152 69985.17,-152 69985.17,-152 69985.17,-152 69985.17,-77.14 69985.17,-77.14"/>
<polygon fill="black" stroke="black" points="69988.67,-77.14 69985.17,-67.14 69981.67,-77.14 69988.67,-77.14"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP6 -->
<g id="edge2379" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP6</title>
<path fill="none" stroke="black" d="M68891.14,-150C69276.44,-150 69976.62,-150 69976.62,-150 69976.62,-150 69976.62,-74.01 69976.62,-74.01"/>
<polygon fill="black" stroke="black" points="69980.12,-74.01 69976.62,-64.01 69973.12,-74.01 69980.12,-74.01"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP6 -->
<g id="edge2431" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP6</title>
<path fill="none" stroke="black" d="M68879.57,-148C69260.15,-148 69968.06,-148 69968.06,-148 69968.06,-148 69968.06,-69.54 69968.06,-69.54"/>
<polygon fill="black" stroke="black" points="69971.56,-69.54 69968.06,-59.54 69964.56,-69.55 69971.56,-69.54"/>
</g>
<!-- L8_recv_from_stage0_TP7 -->
<g id="node779" class="node">
<title>L8_recv_from_stage0_TP7</title>
<ellipse fill="none" stroke="black" cx="70930" cy="-48.08" rx="317.48" ry="48.17"/>
<text text-anchor="middle" x="70930" y="-66.88" font-family="Times,serif" font-size="14.00">Recv from Stage0</text>
<text text-anchor="middle" x="70930" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="70930" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="70930" y="-21.88" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP7 -->
<g id="edge2068" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP7</title>
<path fill="none" stroke="black" d="M68960.36,-176C69621.82,-176 71090.28,-176 71090.28,-176 71090.28,-176 71090.28,-99.61 71090.28,-99.61"/>
<polygon fill="black" stroke="black" points="71093.78,-99.61 71090.28,-89.61 71086.78,-99.61 71093.78,-99.61"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP7 -->
<g id="edge2120" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP7</title>
<path fill="none" stroke="black" d="M68959.07,-174C69607.41,-174 71030.56,-174 71030.56,-174 71030.56,-174 71030.56,-103.9 71030.56,-103.9"/>
<polygon fill="black" stroke="black" points="71034.06,-103.9 71030.56,-93.9 71027.06,-103.9 71034.06,-103.9"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP7 -->
<g id="edge2172" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP7</title>
<path fill="none" stroke="black" d="M68956.9,-172C69591.62,-172 70970.84,-172 70970.84,-172 70970.84,-172 70970.84,-105.99 70970.84,-105.99"/>
<polygon fill="black" stroke="black" points="70974.34,-105.99 70970.84,-95.99 70967.34,-105.99 70974.34,-105.99"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP7 -->
<g id="edge2224" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP7</title>
<path fill="none" stroke="black" d="M68955.66,-171C69577.08,-171 70911.12,-171 70911.12,-171 70911.12,-171 70911.12,-106.31 70911.12,-106.31"/>
<polygon fill="black" stroke="black" points="70914.62,-106.31 70911.12,-96.31 70907.62,-106.31 70914.62,-106.31"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP7 -->
<g id="edge2276" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP7</title>
<path fill="none" stroke="black" d="M68952.96,-169C69560.35,-169 70851.39,-169 70851.39,-169 70851.39,-169 70851.39,-104.83 70851.39,-104.83"/>
<polygon fill="black" stroke="black" points="70854.89,-104.83 70851.39,-94.83 70847.89,-104.83 70854.89,-104.83"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP7 -->
<g id="edge2328" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP7</title>
<path fill="none" stroke="black" d="M68949.43,-167C69542.36,-167 70791.67,-167 70791.67,-167 70791.67,-167 70791.67,-101.69 70791.67,-101.69"/>
<polygon fill="black" stroke="black" points="70795.17,-101.69 70791.67,-91.69 70788.17,-101.69 70795.17,-101.69"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP7 -->
<g id="edge2380" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP7</title>
<path fill="none" stroke="black" d="M68945.38,-165C69523.59,-165 70731.95,-165 70731.95,-165 70731.95,-165 70731.95,-95.72 70731.95,-95.72"/>
<polygon fill="black" stroke="black" points="70735.45,-95.72 70731.95,-85.72 70728.45,-95.72 70735.45,-95.72"/>
</g>
<!-- L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP7 -->
<g id="edge2432" class="edge">
<title>L7_send_stage1&#45;&gt;L8_recv_from_stage0_TP7</title>
<path fill="none" stroke="black" d="M68940.55,-163C69503.7,-163 70672.23,-163 70672.23,-163 70672.23,-163 70672.23,-86.2 70672.23,-86.2"/>
<polygon fill="black" stroke="black" points="70675.73,-86.2 70672.23,-76.2 70668.73,-86.2 70675.73,-86.2"/>
</g>
<!-- L7_S0_TP1_GPU1_norm -->
<g id="node765" class="node">
<title>L7_S0_TP1_GPU1_norm</title>
<polygon fill="none" stroke="black" points="67701.5,-332.33 67252.5,-332.33 67252.5,-264.33 67701.5,-264.33 67701.5,-332.33"/>
<text text-anchor="middle" x="67477" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="67477" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="67477" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="67477" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP1_GPU1_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2054" class="edge">
<title>L7_S0_TP1_GPU1_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M67662.17,-264.18C67662.17,-239.32 67662.17,-210 67662.17,-210 67662.17,-210 68384.34,-210 68384.34,-210"/>
<polygon fill="black" stroke="black" points="68384.34,-213.5 68394.34,-210 68384.34,-206.5 68384.34,-213.5"/>
</g>
<!-- L7_S0_TP1_GPU1_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2106" class="edge">
<title>L7_S0_TP1_GPU1_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M67622.84,-264.18C67622.84,-238.6 67622.84,-208 67622.84,-208 67622.84,-208 68374.67,-208 68374.67,-208"/>
<polygon fill="black" stroke="black" points="68374.67,-211.5 68384.67,-208 68374.67,-204.5 68374.67,-211.5"/>
</g>
<!-- L7_S0_TP1_GPU1_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2158" class="edge">
<title>L7_S0_TP1_GPU1_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M67583.5,-264.21C67583.5,-237.91 67583.5,-206 67583.5,-206 67583.5,-206 68365.71,-206 68365.71,-206"/>
<polygon fill="black" stroke="black" points="68365.71,-209.5 68375.71,-206 68365.71,-202.5 68365.71,-209.5"/>
</g>
<!-- L7_S0_TP1_GPU1_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2210" class="edge">
<title>L7_S0_TP1_GPU1_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M67544.17,-264.28C67544.17,-237.26 67544.17,-204 67544.17,-204 67544.17,-204 68357.89,-204 68357.89,-204"/>
<polygon fill="black" stroke="black" points="68357.89,-207.5 68367.89,-204 68357.89,-200.5 68357.89,-207.5"/>
</g>
<!-- L7_S0_TP1_GPU1_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2262" class="edge">
<title>L7_S0_TP1_GPU1_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M67504.84,-264.1C67504.84,-236.41 67504.84,-202 67504.84,-202 67504.84,-202 68350.58,-202 68350.58,-202"/>
<polygon fill="black" stroke="black" points="68350.58,-205.5 68360.58,-202 68350.58,-198.5 68350.58,-205.5"/>
</g>
<!-- L7_S0_TP1_GPU1_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2314" class="edge">
<title>L7_S0_TP1_GPU1_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M67465.51,-264.22C67465.51,-235.82 67465.51,-200 67465.51,-200 67465.51,-200 68344.2,-200 68344.2,-200"/>
<polygon fill="black" stroke="black" points="68344.2,-203.5 68354.2,-200 68344.2,-196.5 68344.2,-203.5"/>
</g>
<!-- L7_S0_TP1_GPU1_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2366" class="edge">
<title>L7_S0_TP1_GPU1_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M67426.17,-264.08C67426.17,-235.02 67426.17,-198 67426.17,-198 67426.17,-198 68338.81,-198 68338.81,-198"/>
<polygon fill="black" stroke="black" points="68338.81,-201.5 68348.81,-198 68338.81,-194.5 68338.81,-201.5"/>
</g>
<!-- L7_S0_TP1_GPU1_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2418" class="edge">
<title>L7_S0_TP1_GPU1_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M67386.84,-264.26C67386.84,-234.49 67386.84,-196 67386.84,-196 67386.84,-196 68333.68,-196 68333.68,-196"/>
<polygon fill="black" stroke="black" points="68333.68,-199.5 68343.68,-196 68333.68,-192.5 68333.68,-199.5"/>
</g>
<!-- L7_S0_TP2_GPU2_norm -->
<g id="node766" class="node">
<title>L7_S0_TP2_GPU2_norm</title>
<polygon fill="none" stroke="black" points="68168.5,-332.33 67719.5,-332.33 67719.5,-264.33 68168.5,-264.33 68168.5,-332.33"/>
<text text-anchor="middle" x="67944" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="67944" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="67944" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="67944" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP2_GPU2_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2055" class="edge">
<title>L7_S0_TP2_GPU2_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M68149.83,-264.28C68149.83,-245.52 68149.83,-226 68149.83,-226 68149.83,-226 68536.07,-226 68536.07,-226"/>
<polygon fill="black" stroke="black" points="68536.07,-229.5 68546.07,-226 68536.07,-222.5 68536.07,-229.5"/>
</g>
<!-- L7_S0_TP2_GPU2_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2107" class="edge">
<title>L7_S0_TP2_GPU2_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M68131.17,-264.21C68131.17,-244.67 68131.17,-224 68131.17,-224 68131.17,-224 68502.27,-224 68502.27,-224"/>
<polygon fill="black" stroke="black" points="68502.27,-227.5 68512.27,-224 68502.27,-220.5 68502.27,-227.5"/>
</g>
<!-- L7_S0_TP2_GPU2_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2159" class="edge">
<title>L7_S0_TP2_GPU2_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M68112.5,-264.19C68112.5,-243.86 68112.5,-222 68112.5,-222 68112.5,-222 68476.33,-222 68476.33,-222"/>
<polygon fill="black" stroke="black" points="68476.33,-225.5 68486.33,-222 68476.33,-218.5 68476.33,-225.5"/>
</g>
<!-- L7_S0_TP2_GPU2_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2211" class="edge">
<title>L7_S0_TP2_GPU2_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M68093.84,-264.2C68093.84,-243.09 68093.84,-220 68093.84,-220 68093.84,-220 68455,-220 68455,-220"/>
<polygon fill="black" stroke="black" points="68455,-223.5 68465,-220 68455,-216.5 68455,-223.5"/>
</g>
<!-- L7_S0_TP2_GPU2_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2263" class="edge">
<title>L7_S0_TP2_GPU2_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M68075.17,-264.26C68075.17,-242.37 68075.17,-218 68075.17,-218 68075.17,-218 68437.05,-218 68437.05,-218"/>
<polygon fill="black" stroke="black" points="68437.05,-221.5 68447.05,-218 68437.05,-214.5 68437.05,-221.5"/>
</g>
<!-- L7_S0_TP2_GPU2_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2315" class="edge">
<title>L7_S0_TP2_GPU2_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M68056.51,-263.89C68056.51,-241.33 68056.51,-216 68056.51,-216 68056.51,-216 68421.49,-216 68421.49,-216"/>
<polygon fill="black" stroke="black" points="68421.49,-219.5 68431.49,-216 68421.49,-212.5 68421.49,-219.5"/>
</g>
<!-- L7_S0_TP2_GPU2_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2367" class="edge">
<title>L7_S0_TP2_GPU2_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M68037.84,-264.03C68037.84,-240.68 68037.84,-214 68037.84,-214 68037.84,-214 68407.86,-214 68407.86,-214"/>
<polygon fill="black" stroke="black" points="68407.86,-217.5 68417.86,-214 68407.86,-210.5 68407.86,-217.5"/>
</g>
<!-- L7_S0_TP2_GPU2_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2419" class="edge">
<title>L7_S0_TP2_GPU2_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M68019.17,-264.21C68019.17,-240.08 68019.17,-212 68019.17,-212 68019.17,-212 68395.55,-212 68395.55,-212"/>
<polygon fill="black" stroke="black" points="68395.55,-215.5 68405.55,-212 68395.55,-208.5 68395.55,-215.5"/>
</g>
<!-- L7_S0_TP3_GPU3_norm -->
<g id="node767" class="node">
<title>L7_S0_TP3_GPU3_norm</title>
<polygon fill="none" stroke="black" points="68635.5,-332.33 68186.5,-332.33 68186.5,-264.33 68635.5,-264.33 68635.5,-332.33"/>
<text text-anchor="middle" x="68411" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="68411" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="68411" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="68411" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP3_GPU3_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2056" class="edge">
<title>L7_S0_TP3_GPU3_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M68360.84,-264.18C68360.84,-264.18 68360.84,-212.05 68360.84,-212.05"/>
<polygon fill="black" stroke="black" points="68364.34,-212.05 68360.84,-202.05 68357.34,-212.05 68364.34,-212.05"/>
</g>
<!-- L7_S0_TP3_GPU3_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2108" class="edge">
<title>L7_S0_TP3_GPU3_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M68395.17,-264.18C68395.17,-264.18 68395.17,-220.31 68395.17,-220.31"/>
<polygon fill="black" stroke="black" points="68398.67,-220.31 68395.17,-210.31 68391.67,-220.31 68398.67,-220.31"/>
</g>
<!-- L7_S0_TP3_GPU3_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2160" class="edge">
<title>L7_S0_TP3_GPU3_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M68429.51,-264.18C68429.51,-264.18 68429.51,-225.97 68429.51,-225.97"/>
<polygon fill="black" stroke="black" points="68433.01,-225.97 68429.51,-215.97 68426.01,-225.97 68433.01,-225.97"/>
</g>
<!-- L7_S0_TP3_GPU3_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2212" class="edge">
<title>L7_S0_TP3_GPU3_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M68463.84,-264.18C68463.84,-264.18 68463.84,-230.16 68463.84,-230.16"/>
<polygon fill="black" stroke="black" points="68467.34,-230.16 68463.84,-220.16 68460.34,-230.16 68467.34,-230.16"/>
</g>
<!-- L7_S0_TP3_GPU3_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2264" class="edge">
<title>L7_S0_TP3_GPU3_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M68498.17,-264.18C68498.17,-264.18 68498.17,-233.16 68498.17,-233.16"/>
<polygon fill="black" stroke="black" points="68501.67,-233.16 68498.17,-223.16 68494.67,-233.16 68501.67,-233.16"/>
</g>
<!-- L7_S0_TP3_GPU3_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2316" class="edge">
<title>L7_S0_TP3_GPU3_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M68532.5,-264.18C68532.5,-264.18 68532.5,-235.32 68532.5,-235.32"/>
<polygon fill="black" stroke="black" points="68536,-235.32 68532.5,-225.32 68529,-235.32 68536,-235.32"/>
</g>
<!-- L7_S0_TP3_GPU3_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2368" class="edge">
<title>L7_S0_TP3_GPU3_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M68566.84,-264.18C68566.84,-264.18 68566.84,-237.07 68566.84,-237.07"/>
<polygon fill="black" stroke="black" points="68570.34,-237.07 68566.84,-227.07 68563.34,-237.07 68570.34,-237.07"/>
</g>
<!-- L7_S0_TP3_GPU3_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2420" class="edge">
<title>L7_S0_TP3_GPU3_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M68601.17,-264.18C68601.17,-264.18 68601.17,-237.94 68601.17,-237.94"/>
<polygon fill="black" stroke="black" points="68604.67,-237.94 68601.17,-227.94 68597.67,-237.94 68604.67,-237.94"/>
</g>
<!-- L7_S0_TP4_GPU4_norm -->
<g id="node768" class="node">
<title>L7_S0_TP4_GPU4_norm</title>
<polygon fill="none" stroke="black" points="69102.5,-332.33 68653.5,-332.33 68653.5,-264.33 69102.5,-264.33 69102.5,-332.33"/>
<text text-anchor="middle" x="68878" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="68878" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="68878" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="68878" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP4_GPU4_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2057" class="edge">
<title>L7_S0_TP4_GPU4_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M68687.72,-264.18C68687.72,-264.18 68687.72,-237.94 68687.72,-237.94"/>
<polygon fill="black" stroke="black" points="68691.22,-237.94 68687.72,-227.94 68684.22,-237.94 68691.22,-237.94"/>
</g>
<!-- L7_S0_TP4_GPU4_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2109" class="edge">
<title>L7_S0_TP4_GPU4_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M68721.94,-264.18C68721.94,-264.18 68721.94,-237.07 68721.94,-237.07"/>
<polygon fill="black" stroke="black" points="68725.44,-237.07 68721.94,-227.07 68718.44,-237.07 68725.44,-237.07"/>
</g>
<!-- L7_S0_TP4_GPU4_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2161" class="edge">
<title>L7_S0_TP4_GPU4_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M68756.16,-264.18C68756.16,-264.18 68756.16,-235.32 68756.16,-235.32"/>
<polygon fill="black" stroke="black" points="68759.66,-235.32 68756.16,-225.32 68752.66,-235.32 68759.66,-235.32"/>
</g>
<!-- L7_S0_TP4_GPU4_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2213" class="edge">
<title>L7_S0_TP4_GPU4_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M68790.38,-264.18C68790.38,-264.18 68790.38,-233.16 68790.38,-233.16"/>
<polygon fill="black" stroke="black" points="68793.88,-233.16 68790.38,-223.16 68786.88,-233.16 68793.88,-233.16"/>
</g>
<!-- L7_S0_TP4_GPU4_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2265" class="edge">
<title>L7_S0_TP4_GPU4_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M68824.61,-264.18C68824.61,-264.18 68824.61,-230.16 68824.61,-230.16"/>
<polygon fill="black" stroke="black" points="68828.11,-230.16 68824.61,-220.16 68821.11,-230.16 68828.11,-230.16"/>
</g>
<!-- L7_S0_TP4_GPU4_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2317" class="edge">
<title>L7_S0_TP4_GPU4_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M68858.83,-264.18C68858.83,-264.18 68858.83,-225.97 68858.83,-225.97"/>
<polygon fill="black" stroke="black" points="68862.33,-225.97 68858.83,-215.97 68855.33,-225.97 68862.33,-225.97"/>
</g>
<!-- L7_S0_TP4_GPU4_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2369" class="edge">
<title>L7_S0_TP4_GPU4_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M68893.05,-264.18C68893.05,-264.18 68893.05,-220.31 68893.05,-220.31"/>
<polygon fill="black" stroke="black" points="68896.55,-220.31 68893.05,-210.31 68889.55,-220.31 68896.55,-220.31"/>
</g>
<!-- L7_S0_TP4_GPU4_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2421" class="edge">
<title>L7_S0_TP4_GPU4_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M68927.27,-264.18C68927.27,-264.18 68927.27,-212.05 68927.27,-212.05"/>
<polygon fill="black" stroke="black" points="68930.77,-212.05 68927.27,-202.05 68923.77,-212.05 68930.77,-212.05"/>
</g>
<!-- L7_S0_TP5_GPU5_norm -->
<g id="node769" class="node">
<title>L7_S0_TP5_GPU5_norm</title>
<polygon fill="none" stroke="black" points="69569.5,-332.33 69120.5,-332.33 69120.5,-264.33 69569.5,-264.33 69569.5,-332.33"/>
<text text-anchor="middle" x="69345" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="69345" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="69345" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="69345" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP5_GPU5_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2058" class="edge">
<title>L7_S0_TP5_GPU5_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M69139.17,-264.2C69139.17,-243.09 69139.17,-220 69139.17,-220 69139.17,-220 68832.77,-220 68832.77,-220"/>
<polygon fill="black" stroke="black" points="68832.77,-216.5 68822.77,-220 68832.77,-223.5 68832.77,-216.5"/>
</g>
<!-- L7_S0_TP5_GPU5_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2110" class="edge">
<title>L7_S0_TP5_GPU5_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M69157.83,-264.23C69157.83,-242.73 69157.83,-219 69157.83,-219 69157.83,-219 68842.05,-219 68842.05,-219"/>
<polygon fill="black" stroke="black" points="68842.05,-215.5 68832.05,-219 68842.05,-222.5 68842.05,-215.5"/>
</g>
<!-- L7_S0_TP5_GPU5_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2162" class="edge">
<title>L7_S0_TP5_GPU5_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M69176.5,-264.31C69176.5,-242.02 69176.5,-217 69176.5,-217 69176.5,-217 68859.12,-217 68859.12,-217"/>
<polygon fill="black" stroke="black" points="68859.12,-213.5 68849.12,-217 68859.12,-220.5 68859.12,-213.5"/>
</g>
<!-- L7_S0_TP5_GPU5_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2214" class="edge">
<title>L7_S0_TP5_GPU5_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M69195.16,-263.96C69195.16,-241 69195.16,-215 69195.16,-215 69195.16,-215 68873.81,-215 68873.81,-215"/>
<polygon fill="black" stroke="black" points="68873.81,-211.5 68863.81,-215 68873.81,-218.5 68873.81,-211.5"/>
</g>
<!-- L7_S0_TP5_GPU5_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2266" class="edge">
<title>L7_S0_TP5_GPU5_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M69213.83,-264.12C69213.83,-240.38 69213.83,-213 69213.83,-213 69213.83,-213 68886.59,-213 68886.59,-213"/>
<polygon fill="black" stroke="black" points="68886.59,-209.5 68876.59,-213 68886.59,-216.5 68886.59,-209.5"/>
</g>
<!-- L7_S0_TP5_GPU5_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2318" class="edge">
<title>L7_S0_TP5_GPU5_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M69232.49,-264.32C69232.49,-239.8 69232.49,-211 69232.49,-211 69232.49,-211 68898.46,-211 68898.46,-211"/>
<polygon fill="black" stroke="black" points="68898.46,-207.5 68888.46,-211 68898.46,-214.5 68898.46,-207.5"/>
</g>
<!-- L7_S0_TP5_GPU5_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2370" class="edge">
<title>L7_S0_TP5_GPU5_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M69251.16,-264.31C69251.16,-239.06 69251.16,-209 69251.16,-209 69251.16,-209 68908.85,-209 68908.85,-209"/>
<polygon fill="black" stroke="black" points="68908.85,-205.5 68898.85,-209 68908.85,-212.5 68908.85,-205.5"/>
</g>
<!-- L7_S0_TP5_GPU5_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2422" class="edge">
<title>L7_S0_TP5_GPU5_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M69269.83,-264.32C69269.83,-238.36 69269.83,-207 69269.83,-207 69269.83,-207 68918.05,-207 68918.05,-207"/>
<polygon fill="black" stroke="black" points="68918.05,-203.5 68908.05,-207 68918.05,-210.5 68918.05,-203.5"/>
</g>
<!-- L7_S0_TP6_GPU6_norm -->
<g id="node770" class="node">
<title>L7_S0_TP6_GPU6_norm</title>
<polygon fill="none" stroke="black" points="70036.5,-332.33 69587.5,-332.33 69587.5,-264.33 70036.5,-264.33 70036.5,-332.33"/>
<text text-anchor="middle" x="69812" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="69812" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="69812" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="69812" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP6_GPU6_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2059" class="edge">
<title>L7_S0_TP6_GPU6_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M69626.83,-264.21C69626.83,-237.91 69626.83,-206 69626.83,-206 69626.83,-206 68922.24,-206 68922.24,-206"/>
<polygon fill="black" stroke="black" points="68922.24,-202.5 68912.24,-206 68922.24,-209.5 68922.24,-202.5"/>
</g>
<!-- L7_S0_TP6_GPU6_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2111" class="edge">
<title>L7_S0_TP6_GPU6_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M69666.16,-264.28C69666.16,-237.26 69666.16,-204 69666.16,-204 69666.16,-204 68930.28,-204 68930.28,-204"/>
<polygon fill="black" stroke="black" points="68930.28,-200.5 68920.28,-204 68930.28,-207.5 68930.28,-200.5"/>
</g>
<!-- L7_S0_TP6_GPU6_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2163" class="edge">
<title>L7_S0_TP6_GPU6_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M69705.5,-264.1C69705.5,-236.41 69705.5,-202 69705.5,-202 69705.5,-202 68937.42,-202 68937.42,-202"/>
<polygon fill="black" stroke="black" points="68937.42,-198.5 68927.42,-202 68937.42,-205.5 68937.42,-198.5"/>
</g>
<!-- L7_S0_TP6_GPU6_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2215" class="edge">
<title>L7_S0_TP6_GPU6_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M69744.83,-264.22C69744.83,-235.82 69744.83,-200 69744.83,-200 69744.83,-200 68943.59,-200 68943.59,-200"/>
<polygon fill="black" stroke="black" points="68943.59,-196.5 68933.59,-200 68943.59,-203.5 68943.59,-196.5"/>
</g>
<!-- L7_S0_TP6_GPU6_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2267" class="edge">
<title>L7_S0_TP6_GPU6_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M69784.16,-264.08C69784.16,-235.02 69784.16,-198 69784.16,-198 69784.16,-198 68949.1,-198 68949.1,-198"/>
<polygon fill="black" stroke="black" points="68949.1,-194.5 68939.1,-198 68949.1,-201.5 68949.1,-194.5"/>
</g>
<!-- L7_S0_TP6_GPU6_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2319" class="edge">
<title>L7_S0_TP6_GPU6_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M69823.49,-264.26C69823.49,-234.49 69823.49,-196 69823.49,-196 69823.49,-196 68954.31,-196 68954.31,-196"/>
<polygon fill="black" stroke="black" points="68954.31,-192.5 68944.31,-196 68954.31,-199.5 68954.31,-192.5"/>
</g>
<!-- L7_S0_TP6_GPU6_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2371" class="edge">
<title>L7_S0_TP6_GPU6_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M69862.83,-264.21C69862.83,-234.11 69862.83,-195 69862.83,-195 69862.83,-195 68956.46,-195 68956.46,-195"/>
<polygon fill="black" stroke="black" points="68956.46,-191.5 68946.46,-195 68956.46,-198.5 68956.46,-191.5"/>
</g>
<!-- L7_S0_TP6_GPU6_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2423" class="edge">
<title>L7_S0_TP6_GPU6_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M69902.16,-264.13C69902.16,-233.38 69902.16,-193 69902.16,-193 69902.16,-193 68960.17,-193 68960.17,-193"/>
<polygon fill="black" stroke="black" points="68960.17,-189.5 68950.17,-193 68960.17,-196.5 68960.17,-189.5"/>
</g>
<!-- L7_S0_TP7_GPU7_norm -->
<g id="node771" class="node">
<title>L7_S0_TP7_GPU7_norm</title>
<polygon fill="none" stroke="black" points="70503.5,-332.33 70054.5,-332.33 70054.5,-264.33 70503.5,-264.33 70503.5,-332.33"/>
<text text-anchor="middle" x="70279" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="70279" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="70279" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="70279" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP7_GPU7_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2060" class="edge">
<title>L7_S0_TP7_GPU7_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M70104.39,-264.08C70104.39,-232.67 70104.39,-191 70104.39,-191 70104.39,-191 68963.71,-191 68963.71,-191"/>
<polygon fill="black" stroke="black" points="68963.71,-187.5 68953.71,-191 68963.71,-194.5 68963.71,-187.5"/>
</g>
<!-- L7_S0_TP7_GPU7_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2112" class="edge">
<title>L7_S0_TP7_GPU7_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M70154.28,-264.04C70154.28,-231.98 70154.28,-189 70154.28,-189 70154.28,-189 68966.47,-189 68966.47,-189"/>
<polygon fill="black" stroke="black" points="68966.47,-185.5 68956.47,-189 68966.47,-192.5 68966.47,-185.5"/>
</g>
<!-- L7_S0_TP7_GPU7_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2164" class="edge">
<title>L7_S0_TP7_GPU7_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M70204.17,-264.32C70204.17,-231.58 70204.17,-187 70204.17,-187 70204.17,-187 68968.78,-187 68968.78,-187"/>
<polygon fill="black" stroke="black" points="68968.78,-183.5 68958.78,-187 68968.78,-190.5 68968.78,-183.5"/>
</g>
<!-- L7_S0_TP7_GPU7_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2216" class="edge">
<title>L7_S0_TP7_GPU7_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M70254.06,-264.33C70254.06,-230.95 70254.06,-185 70254.06,-185 70254.06,-185 68970.17,-185 68970.17,-185"/>
<polygon fill="black" stroke="black" points="68970.17,-181.5 68960.17,-185 68970.17,-188.5 68970.17,-181.5"/>
</g>
<!-- L7_S0_TP7_GPU7_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2268" class="edge">
<title>L7_S0_TP7_GPU7_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M70303.94,-264.04C70303.94,-230.04 70303.94,-183 70303.94,-183 70303.94,-183 68971.11,-183 68971.11,-183"/>
<polygon fill="black" stroke="black" points="68971.11,-179.5 68961.11,-183 68971.11,-186.5 68971.11,-179.5"/>
</g>
<!-- L7_S0_TP7_GPU7_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2320" class="edge">
<title>L7_S0_TP7_GPU7_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M70353.83,-264.06C70353.83,-229.74 70353.83,-182 70353.83,-182 70353.83,-182 68971.6,-182 68971.6,-182"/>
<polygon fill="black" stroke="black" points="68971.6,-178.5 68961.6,-182 68971.6,-185.5 68971.6,-178.5"/>
</g>
<!-- L7_S0_TP7_GPU7_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2372" class="edge">
<title>L7_S0_TP7_GPU7_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M70403.72,-264.11C70403.72,-229.16 70403.72,-180 70403.72,-180 70403.72,-180 68971.65,-180 68971.65,-180"/>
<polygon fill="black" stroke="black" points="68971.65,-176.5 68961.65,-180 68971.65,-183.5 68971.65,-176.5"/>
</g>
<!-- L7_S0_TP7_GPU7_norm&#45;&gt;L7_send_stage1 -->
<g id="edge2424" class="edge">
<title>L7_S0_TP7_GPU7_norm&#45;&gt;L7_send_stage1</title>
<path fill="none" stroke="black" d="M70453.61,-264.17C70453.61,-228.6 70453.61,-178 70453.61,-178 70453.61,-178 68971.28,-178 68971.28,-178"/>
<polygon fill="black" stroke="black" points="68971.28,-174.5 68961.28,-178 68971.28,-181.5 68971.28,-174.5"/>
</g>
<!-- L7_S0_TP1_GPU1_qkv_linear -->
<g id="node780" class="node">
<title>L7_S0_TP1_GPU1_qkv_linear</title>
<polygon fill="none" stroke="black" points="66364,-1614.75 65756,-1614.75 65756,-1546.75 66364,-1546.75 66364,-1614.75"/>
<text text-anchor="middle" x="66060" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="66060" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="66060" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="66060" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L7_S0_TP1_GPU1_qkv_slice -->
<g id="node781" class="node">
<title>L7_S0_TP1_GPU1_qkv_slice</title>
<polygon fill="none" stroke="black" points="66358,-1496.67 65762,-1496.67 65762,-1428.67 66358,-1428.67 66358,-1496.67"/>
<text text-anchor="middle" x="66060" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="66060" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="66060" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="66060" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L7_S0_TP1_GPU1_qkv_linear&#45;&gt;L7_S0_TP1_GPU1_qkv_slice -->
<g id="edge2069" class="edge">
<title>L7_S0_TP1_GPU1_qkv_linear&#45;&gt;L7_S0_TP1_GPU1_qkv_slice</title>
<path fill="none" stroke="black" d="M66060,-1546.59C66060,-1546.59 66060,-1506.74 66060,-1506.74"/>
<polygon fill="black" stroke="black" points="66063.5,-1506.74 66060,-1496.74 66056.5,-1506.74 66063.5,-1506.74"/>
</g>
<!-- L7_S0_TP1_GPU1_qkv_slice&#45;&gt;L7_S0_TP1_GPU1_attn_v -->
<g id="edge2073" class="edge">
<title>L7_S0_TP1_GPU1_qkv_slice&#45;&gt;L7_S0_TP1_GPU1_attn_v</title>
<path fill="none" stroke="black" d="M65812.75,-1428.38C65812.75,-1428.38 65812.75,-1195 65812.75,-1195"/>
<polygon fill="black" stroke="black" points="65816.25,-1195 65812.75,-1185 65809.25,-1195 65816.25,-1195"/>
</g>
<!-- L7_S0_TP1_GPU1_qk_matmul -->
<g id="node782" class="node">
<title>L7_S0_TP1_GPU1_qk_matmul</title>
<polygon fill="none" stroke="black" points="66775.5,-1392.67 65840.5,-1392.67 65840.5,-1324.67 66775.5,-1324.67 66775.5,-1392.67"/>
<text text-anchor="middle" x="66308" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="66308" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="66308" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="66308" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L7_S0_TP1_GPU1_qkv_slice&#45;&gt;L7_S0_TP1_GPU1_qk_matmul -->
<g id="edge2070" class="edge">
<title>L7_S0_TP1_GPU1_qkv_slice&#45;&gt;L7_S0_TP1_GPU1_qk_matmul</title>
<path fill="none" stroke="black" d="M66099.25,-1428.61C66099.25,-1428.61 66099.25,-1402.8 66099.25,-1402.8"/>
<polygon fill="black" stroke="black" points="66102.75,-1402.8 66099.25,-1392.8 66095.75,-1402.8 66102.75,-1402.8"/>
</g>
<!-- L7_S0_TP1_GPU1_softmax -->
<g id="node783" class="node">
<title>L7_S0_TP1_GPU1_softmax</title>
<polygon fill="none" stroke="black" points="66536,-1288.67 66026,-1288.67 66026,-1220.67 66536,-1220.67 66536,-1288.67"/>
<text text-anchor="middle" x="66281" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="66281" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="66281" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="66281" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L7_S0_TP1_GPU1_qk_matmul&#45;&gt;L7_S0_TP1_GPU1_softmax -->
<g id="edge2071" class="edge">
<title>L7_S0_TP1_GPU1_qk_matmul&#45;&gt;L7_S0_TP1_GPU1_softmax</title>
<path fill="none" stroke="black" d="M66281,-1324.61C66281,-1324.61 66281,-1298.8 66281,-1298.8"/>
<polygon fill="black" stroke="black" points="66284.5,-1298.8 66281,-1288.8 66277.5,-1298.8 66284.5,-1298.8"/>
</g>
<!-- L7_S0_TP1_GPU1_softmax&#45;&gt;L7_S0_TP1_GPU1_attn_v -->
<g id="edge2072" class="edge">
<title>L7_S0_TP1_GPU1_softmax&#45;&gt;L7_S0_TP1_GPU1_attn_v</title>
<path fill="none" stroke="black" d="M66281,-1220.61C66281,-1220.61 66281,-1194.8 66281,-1194.8"/>
<polygon fill="black" stroke="black" points="66284.5,-1194.8 66281,-1184.8 66277.5,-1194.8 66284.5,-1194.8"/>
</g>
<!-- L7_S0_TP1_GPU1_mha_res -->
<g id="node785" class="node">
<title>L7_S0_TP1_GPU1_mha_res</title>
<polygon fill="none" stroke="black" points="66392.5,-948.5 65505.5,-948.5 65505.5,-880.5 66392.5,-880.5 66392.5,-948.5"/>
<text text-anchor="middle" x="65949" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="65949" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="65949" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="65949" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP1_GPU1_mha_ar&#45;&gt;L7_S0_TP1_GPU1_mha_res -->
<g id="edge2082" class="edge">
<title>L7_S0_TP1_GPU1_mha_ar&#45;&gt;L7_S0_TP1_GPU1_mha_res</title>
<path fill="none" stroke="black" d="M66369.01,-1015.66C66369.01,-1015.66 66369.01,-958.91 66369.01,-958.91"/>
<polygon fill="black" stroke="black" points="66372.51,-958.91 66369.01,-948.91 66365.51,-958.91 66372.51,-958.91"/>
</g>
<!-- L7_S0_TP1_GPU1_gate -->
<g id="node786" class="node">
<title>L7_S0_TP1_GPU1_gate</title>
<polygon fill="none" stroke="black" points="66478.56,-844.5 65636.15,-844.5 65419.44,-708.5 66261.85,-708.5 66478.56,-844.5"/>
<text text-anchor="middle" x="65949" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="65949" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="65949" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="65949" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- L7_S0_TP1_GPU1_mha_res&#45;&gt;L7_S0_TP1_GPU1_gate -->
<g id="edge2083" class="edge">
<title>L7_S0_TP1_GPU1_mha_res&#45;&gt;L7_S0_TP1_GPU1_gate</title>
<path fill="none" stroke="black" d="M65949,-880.39C65949,-880.39 65949,-854.73 65949,-854.73"/>
<polygon fill="black" stroke="black" points="65952.5,-854.73 65949,-844.73 65945.5,-854.73 65952.5,-854.73"/>
</g>
<!-- L7_S0_TP1_GPU1_moe_res -->
<g id="node788" class="node">
<title>L7_S0_TP1_GPU1_moe_res</title>
<polygon fill="none" stroke="black" points="66960,-436.33 66140,-436.33 66140,-368.33 66960,-368.33 66960,-436.33"/>
<text text-anchor="middle" x="66550" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="66550" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="66550" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="66550" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP1_GPU1_mha_res&#45;&gt;L7_S0_TP1_GPU1_moe_res -->
<g id="edge2103" class="edge">
<title>L7_S0_TP1_GPU1_mha_res&#45;&gt;L7_S0_TP1_GPU1_moe_res</title>
<path fill="none" stroke="black" d="M66392.57,-914C66449.27,-914 66488,-914 66488,-914 66488,-914 66488,-695 66488,-695 66488,-695 66314,-695 66314,-695 66314,-695 66314,-604 66314,-604 66314,-604 66580.49,-604 66580.49,-604 66580.49,-604 66580.49,-446.54 66580.49,-446.54"/>
<polygon fill="black" stroke="black" points="66583.99,-446.54 66580.49,-436.54 66576.99,-446.54 66583.99,-446.54"/>
</g>
<!-- L7_S0_TP1_GPU1_gate&#45;&gt;L7_S0_TP1_GPU1_expert0 -->
<g id="edge2084" class="edge">
<title>L7_S0_TP1_GPU1_gate&#45;&gt;L7_S0_TP1_GPU1_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M66076,-708.31C66076,-708.31 66076,-682.71 66076,-682.71"/>
<polygon fill="black" stroke="black" points="66079.5,-682.71 66076,-672.71 66072.5,-682.71 66079.5,-682.71"/>
</g>
<!-- L7_S0_TP1_GPU1_gate&#45;&gt;L7_S0_TP1_GPU1_expert1 -->
<g id="edge2085" class="edge">
<title>L7_S0_TP1_GPU1_gate&#45;&gt;L7_S0_TP1_GPU1_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M66398.64,-776.4C66398.64,-776.4 66398.64,-682.74 66398.64,-682.74"/>
<polygon fill="black" stroke="black" points="66402.14,-682.74 66398.64,-672.74 66395.14,-682.74 66402.14,-682.74"/>
</g>
<!-- L7_S0_TP1_GPU1_moe_ar&#45;&gt;L7_S0_TP1_GPU1_moe_res -->
<g id="edge2102" class="edge">
<title>L7_S0_TP1_GPU1_moe_ar&#45;&gt;L7_S0_TP1_GPU1_moe_res</title>
<path fill="none" stroke="black" d="M66776.27,-477.45C66776.27,-477.45 66776.27,-446.57 66776.27,-446.57"/>
<polygon fill="black" stroke="black" points="66779.77,-446.57 66776.27,-436.57 66772.77,-446.57 66779.77,-446.57"/>
</g>
<!-- L7_S0_TP1_GPU1_moe_res&#45;&gt;L7_S0_TP1_GPU1_norm -->
<g id="edge2104" class="edge">
<title>L7_S0_TP1_GPU1_moe_res&#45;&gt;L7_S0_TP1_GPU1_norm</title>
<path fill="none" stroke="black" d="M66872.75,-368.08C66872.75,-354.03 66872.75,-341 66872.75,-341 66872.75,-341 67477,-341 67477,-341 67477,-341 67477,-340.14 67477,-340.14"/>
<polygon fill="black" stroke="black" points="67480.5,-342.37 67477,-332.37 67473.5,-342.37 67480.5,-342.37"/>
</g>
<!-- L7_S0_TP2_GPU2_qkv_linear -->
<g id="node789" class="node">
<title>L7_S0_TP2_GPU2_qkv_linear</title>
<polygon fill="none" stroke="black" points="67356,-1614.75 66748,-1614.75 66748,-1546.75 67356,-1546.75 67356,-1614.75"/>
<text text-anchor="middle" x="67052" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="67052" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="67052" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="67052" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L7_S0_TP2_GPU2_qkv_slice -->
<g id="node790" class="node">
<title>L7_S0_TP2_GPU2_qkv_slice</title>
<polygon fill="none" stroke="black" points="67350,-1496.67 66754,-1496.67 66754,-1428.67 67350,-1428.67 67350,-1496.67"/>
<text text-anchor="middle" x="67052" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="67052" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="67052" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="67052" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L7_S0_TP2_GPU2_qkv_linear&#45;&gt;L7_S0_TP2_GPU2_qkv_slice -->
<g id="edge2121" class="edge">
<title>L7_S0_TP2_GPU2_qkv_linear&#45;&gt;L7_S0_TP2_GPU2_qkv_slice</title>
<path fill="none" stroke="black" d="M67052,-1546.59C67052,-1546.59 67052,-1506.74 67052,-1506.74"/>
<polygon fill="black" stroke="black" points="67055.5,-1506.74 67052,-1496.74 67048.5,-1506.74 67055.5,-1506.74"/>
</g>
<!-- L7_S0_TP2_GPU2_qkv_slice&#45;&gt;L7_S0_TP2_GPU2_attn_v -->
<g id="edge2125" class="edge">
<title>L7_S0_TP2_GPU2_qkv_slice&#45;&gt;L7_S0_TP2_GPU2_attn_v</title>
<path fill="none" stroke="black" d="M66804,-1428.38C66804,-1428.38 66804,-1195 66804,-1195"/>
<polygon fill="black" stroke="black" points="66807.5,-1195 66804,-1185 66800.5,-1195 66807.5,-1195"/>
</g>
<!-- L7_S0_TP2_GPU2_qk_matmul -->
<g id="node791" class="node">
<title>L7_S0_TP2_GPU2_qk_matmul</title>
<polygon fill="none" stroke="black" points="67767.5,-1392.67 66832.5,-1392.67 66832.5,-1324.67 67767.5,-1324.67 67767.5,-1392.67"/>
<text text-anchor="middle" x="67300" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="67300" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="67300" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="67300" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L7_S0_TP2_GPU2_qkv_slice&#45;&gt;L7_S0_TP2_GPU2_qk_matmul -->
<g id="edge2122" class="edge">
<title>L7_S0_TP2_GPU2_qkv_slice&#45;&gt;L7_S0_TP2_GPU2_qk_matmul</title>
<path fill="none" stroke="black" d="M67091.25,-1428.61C67091.25,-1428.61 67091.25,-1402.8 67091.25,-1402.8"/>
<polygon fill="black" stroke="black" points="67094.75,-1402.8 67091.25,-1392.8 67087.75,-1402.8 67094.75,-1402.8"/>
</g>
<!-- L7_S0_TP2_GPU2_softmax -->
<g id="node792" class="node">
<title>L7_S0_TP2_GPU2_softmax</title>
<polygon fill="none" stroke="black" points="67510,-1288.67 67000,-1288.67 67000,-1220.67 67510,-1220.67 67510,-1288.67"/>
<text text-anchor="middle" x="67255" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="67255" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="67255" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="67255" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L7_S0_TP2_GPU2_qk_matmul&#45;&gt;L7_S0_TP2_GPU2_softmax -->
<g id="edge2123" class="edge">
<title>L7_S0_TP2_GPU2_qk_matmul&#45;&gt;L7_S0_TP2_GPU2_softmax</title>
<path fill="none" stroke="black" d="M67255,-1324.61C67255,-1324.61 67255,-1298.8 67255,-1298.8"/>
<polygon fill="black" stroke="black" points="67258.5,-1298.8 67255,-1288.8 67251.5,-1298.8 67258.5,-1298.8"/>
</g>
<!-- L7_S0_TP2_GPU2_softmax&#45;&gt;L7_S0_TP2_GPU2_attn_v -->
<g id="edge2124" class="edge">
<title>L7_S0_TP2_GPU2_softmax&#45;&gt;L7_S0_TP2_GPU2_attn_v</title>
<path fill="none" stroke="black" d="M67255,-1220.61C67255,-1220.61 67255,-1194.8 67255,-1194.8"/>
<polygon fill="black" stroke="black" points="67258.5,-1194.8 67255,-1184.8 67251.5,-1194.8 67258.5,-1194.8"/>
</g>
<!-- L7_S0_TP2_GPU2_mha_res -->
<g id="node794" class="node">
<title>L7_S0_TP2_GPU2_mha_res</title>
<polygon fill="none" stroke="black" points="67470.5,-948.5 66583.5,-948.5 66583.5,-880.5 67470.5,-880.5 67470.5,-948.5"/>
<text text-anchor="middle" x="67027" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="67027" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="67027" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="67027" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP2_GPU2_mha_ar&#45;&gt;L7_S0_TP2_GPU2_mha_res -->
<g id="edge2134" class="edge">
<title>L7_S0_TP2_GPU2_mha_ar&#45;&gt;L7_S0_TP2_GPU2_mha_res</title>
<path fill="none" stroke="black" d="M67292.51,-991.61C67292.51,-991.61 67292.51,-958.74 67292.51,-958.74"/>
<polygon fill="black" stroke="black" points="67296.01,-958.74 67292.51,-948.74 67289.01,-958.74 67296.01,-958.74"/>
</g>
<!-- L7_S0_TP2_GPU2_gate -->
<g id="node795" class="node">
<title>L7_S0_TP2_GPU2_gate</title>
<polygon fill="none" stroke="black" points="67556.56,-844.5 66714.15,-844.5 66497.44,-708.5 67339.85,-708.5 67556.56,-844.5"/>
<text text-anchor="middle" x="67027" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="67027" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="67027" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="67027" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- L7_S0_TP2_GPU2_mha_res&#45;&gt;L7_S0_TP2_GPU2_gate -->
<g id="edge2135" class="edge">
<title>L7_S0_TP2_GPU2_mha_res&#45;&gt;L7_S0_TP2_GPU2_gate</title>
<path fill="none" stroke="black" d="M67027,-880.39C67027,-880.39 67027,-854.73 67027,-854.73"/>
<polygon fill="black" stroke="black" points="67030.5,-854.73 67027,-844.73 67023.5,-854.73 67030.5,-854.73"/>
</g>
<!-- L7_S0_TP2_GPU2_moe_res -->
<g id="node797" class="node">
<title>L7_S0_TP2_GPU2_moe_res</title>
<polygon fill="none" stroke="black" points="67798,-436.33 66978,-436.33 66978,-368.33 67798,-368.33 67798,-436.33"/>
<text text-anchor="middle" x="67388" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="67388" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="67388" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="67388" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP2_GPU2_mha_res&#45;&gt;L7_S0_TP2_GPU2_moe_res -->
<g id="edge2155" class="edge">
<title>L7_S0_TP2_GPU2_mha_res&#45;&gt;L7_S0_TP2_GPU2_moe_res</title>
<path fill="none" stroke="black" d="M67470.57,-914C67527.27,-914 67566,-914 67566,-914 67566,-914 67566,-685 67566,-685 67566,-685 67245.75,-685 67245.75,-685 67245.75,-685 67245.75,-599 67245.75,-599 67245.75,-599 67273.51,-599 67273.51,-599 67273.51,-599 67273.51,-446.59 67273.51,-446.59"/>
<polygon fill="black" stroke="black" points="67277.01,-446.59 67273.51,-436.59 67270.01,-446.59 67277.01,-446.59"/>
</g>
<!-- L7_S0_TP2_GPU2_gate&#45;&gt;L7_S0_TP2_GPU2_expert0 -->
<g id="edge2136" class="edge">
<title>L7_S0_TP2_GPU2_gate&#45;&gt;L7_S0_TP2_GPU2_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M66897.75,-708.31C66897.75,-708.31 66897.75,-682.71 66897.75,-682.71"/>
<polygon fill="black" stroke="black" points="66901.25,-682.71 66897.75,-672.71 66894.25,-682.71 66901.25,-682.71"/>
</g>
<!-- L7_S0_TP2_GPU2_gate&#45;&gt;L7_S0_TP2_GPU2_expert1 -->
<g id="edge2137" class="edge">
<title>L7_S0_TP2_GPU2_gate&#45;&gt;L7_S0_TP2_GPU2_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67404.64,-748.9C67404.64,-748.9 67404.64,-682.65 67404.64,-682.65"/>
<polygon fill="black" stroke="black" points="67408.14,-682.65 67404.64,-672.65 67401.14,-682.65 67408.14,-682.65"/>
</g>
<!-- L7_S0_TP2_GPU2_moe_ar&#45;&gt;L7_S0_TP2_GPU2_moe_res -->
<g id="edge2154" class="edge">
<title>L7_S0_TP2_GPU2_moe_ar&#45;&gt;L7_S0_TP2_GPU2_moe_res</title>
<path fill="none" stroke="black" d="M67625.18,-472.05C67625.18,-472.05 67625.18,-446.37 67625.18,-446.37"/>
<polygon fill="black" stroke="black" points="67628.68,-446.37 67625.18,-436.37 67621.68,-446.37 67628.68,-446.37"/>
</g>
<!-- L7_S0_TP2_GPU2_moe_res&#45;&gt;L7_S0_TP2_GPU2_norm -->
<g id="edge2156" class="edge">
<title>L7_S0_TP2_GPU2_moe_res&#45;&gt;L7_S0_TP2_GPU2_norm</title>
<path fill="none" stroke="black" d="M67758.75,-368.28C67758.75,-368.28 67758.75,-342.46 67758.75,-342.46"/>
<polygon fill="black" stroke="black" points="67762.25,-342.46 67758.75,-332.46 67755.25,-342.46 67762.25,-342.46"/>
</g>
<!-- L7_S0_TP3_GPU3_qkv_linear -->
<g id="node798" class="node">
<title>L7_S0_TP3_GPU3_qkv_linear</title>
<polygon fill="none" stroke="black" points="68448,-1614.75 67840,-1614.75 67840,-1546.75 68448,-1546.75 68448,-1614.75"/>
<text text-anchor="middle" x="68144" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="68144" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="68144" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="68144" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L7_S0_TP3_GPU3_qkv_slice -->
<g id="node799" class="node">
<title>L7_S0_TP3_GPU3_qkv_slice</title>
<polygon fill="none" stroke="black" points="68442,-1496.67 67846,-1496.67 67846,-1428.67 68442,-1428.67 68442,-1496.67"/>
<text text-anchor="middle" x="68144" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="68144" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="68144" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="68144" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L7_S0_TP3_GPU3_qkv_linear&#45;&gt;L7_S0_TP3_GPU3_qkv_slice -->
<g id="edge2173" class="edge">
<title>L7_S0_TP3_GPU3_qkv_linear&#45;&gt;L7_S0_TP3_GPU3_qkv_slice</title>
<path fill="none" stroke="black" d="M68144,-1546.59C68144,-1546.59 68144,-1506.74 68144,-1506.74"/>
<polygon fill="black" stroke="black" points="68147.5,-1506.74 68144,-1496.74 68140.5,-1506.74 68147.5,-1506.74"/>
</g>
<!-- L7_S0_TP3_GPU3_qkv_slice&#45;&gt;L7_S0_TP3_GPU3_attn_v -->
<g id="edge2177" class="edge">
<title>L7_S0_TP3_GPU3_qkv_slice&#45;&gt;L7_S0_TP3_GPU3_attn_v</title>
<path fill="none" stroke="black" d="M67845.68,-1462C67817.96,-1462 67800,-1462 67800,-1462 67800,-1462 67800,-1194.87 67800,-1194.87"/>
<polygon fill="black" stroke="black" points="67803.5,-1194.87 67800,-1184.87 67796.5,-1194.87 67803.5,-1194.87"/>
</g>
<!-- L7_S0_TP3_GPU3_qk_matmul -->
<g id="node800" class="node">
<title>L7_S0_TP3_GPU3_qk_matmul</title>
<polygon fill="none" stroke="black" points="68767.5,-1392.67 67832.5,-1392.67 67832.5,-1324.67 68767.5,-1324.67 68767.5,-1392.67"/>
<text text-anchor="middle" x="68300" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="68300" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="68300" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="68300" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L7_S0_TP3_GPU3_qkv_slice&#45;&gt;L7_S0_TP3_GPU3_qk_matmul -->
<g id="edge2174" class="edge">
<title>L7_S0_TP3_GPU3_qkv_slice&#45;&gt;L7_S0_TP3_GPU3_qk_matmul</title>
<path fill="none" stroke="black" d="M68144,-1428.61C68144,-1428.61 68144,-1402.8 68144,-1402.8"/>
<polygon fill="black" stroke="black" points="68147.5,-1402.8 68144,-1392.8 68140.5,-1402.8 68147.5,-1402.8"/>
</g>
<!-- L7_S0_TP3_GPU3_softmax -->
<g id="node801" class="node">
<title>L7_S0_TP3_GPU3_softmax</title>
<polygon fill="none" stroke="black" points="68488,-1288.67 67978,-1288.67 67978,-1220.67 68488,-1220.67 68488,-1288.67"/>
<text text-anchor="middle" x="68233" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="68233" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="68233" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="68233" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L7_S0_TP3_GPU3_qk_matmul&#45;&gt;L7_S0_TP3_GPU3_softmax -->
<g id="edge2175" class="edge">
<title>L7_S0_TP3_GPU3_qk_matmul&#45;&gt;L7_S0_TP3_GPU3_softmax</title>
<path fill="none" stroke="black" d="M68233,-1324.61C68233,-1324.61 68233,-1298.8 68233,-1298.8"/>
<polygon fill="black" stroke="black" points="68236.5,-1298.8 68233,-1288.8 68229.5,-1298.8 68236.5,-1298.8"/>
</g>
<!-- L7_S0_TP3_GPU3_softmax&#45;&gt;L7_S0_TP3_GPU3_attn_v -->
<g id="edge2176" class="edge">
<title>L7_S0_TP3_GPU3_softmax&#45;&gt;L7_S0_TP3_GPU3_attn_v</title>
<path fill="none" stroke="black" d="M68233,-1220.61C68233,-1220.61 68233,-1194.8 68233,-1194.8"/>
<polygon fill="black" stroke="black" points="68236.5,-1194.8 68233,-1184.8 68229.5,-1194.8 68236.5,-1194.8"/>
</g>
<!-- L7_S0_TP3_GPU3_mha_res -->
<g id="node803" class="node">
<title>L7_S0_TP3_GPU3_mha_res</title>
<polygon fill="none" stroke="black" points="68548.5,-948.5 67661.5,-948.5 67661.5,-880.5 68548.5,-880.5 68548.5,-948.5"/>
<text text-anchor="middle" x="68105" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="68105" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="68105" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="68105" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP3_GPU3_mha_ar&#45;&gt;L7_S0_TP3_GPU3_mha_res -->
<g id="edge2186" class="edge">
<title>L7_S0_TP3_GPU3_mha_ar&#45;&gt;L7_S0_TP3_GPU3_mha_res</title>
<path fill="none" stroke="black" d="M68216.01,-984.55C68216.01,-984.55 68216.01,-958.73 68216.01,-958.73"/>
<polygon fill="black" stroke="black" points="68219.51,-958.73 68216.01,-948.73 68212.51,-958.73 68219.51,-958.73"/>
</g>
<!-- L7_S0_TP3_GPU3_gate -->
<g id="node804" class="node">
<title>L7_S0_TP3_GPU3_gate</title>
<polygon fill="none" stroke="black" points="68634.56,-844.5 67792.15,-844.5 67575.44,-708.5 68417.85,-708.5 68634.56,-844.5"/>
<text text-anchor="middle" x="68105" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="68105" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="68105" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="68105" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- L7_S0_TP3_GPU3_mha_res&#45;&gt;L7_S0_TP3_GPU3_gate -->
<g id="edge2187" class="edge">
<title>L7_S0_TP3_GPU3_mha_res&#45;&gt;L7_S0_TP3_GPU3_gate</title>
<path fill="none" stroke="black" d="M68105,-880.39C68105,-880.39 68105,-854.73 68105,-854.73"/>
<polygon fill="black" stroke="black" points="68108.5,-854.73 68105,-844.73 68101.5,-854.73 68108.5,-854.73"/>
</g>
<!-- L7_S0_TP3_GPU3_moe_res -->
<g id="node806" class="node">
<title>L7_S0_TP3_GPU3_moe_res</title>
<polygon fill="none" stroke="black" points="68636,-436.33 67816,-436.33 67816,-368.33 68636,-368.33 68636,-436.33"/>
<text text-anchor="middle" x="68226" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="68226" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="68226" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="68226" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP3_GPU3_mha_res&#45;&gt;L7_S0_TP3_GPU3_moe_res -->
<g id="edge2207" class="edge">
<title>L7_S0_TP3_GPU3_mha_res&#45;&gt;L7_S0_TP3_GPU3_moe_res</title>
<path fill="none" stroke="black" d="M68548.56,-925C68607.36,-925 68647.8,-925 68647.8,-925 68647.8,-925 68647.8,-413 68647.8,-413 68647.8,-413 68646.08,-413 68646.08,-413"/>
<polygon fill="black" stroke="black" points="68646.08,-409.5 68636.08,-413 68646.08,-416.5 68646.08,-409.5"/>
</g>
<!-- L7_S0_TP3_GPU3_gate&#45;&gt;L7_S0_TP3_GPU3_expert0 -->
<g id="edge2188" class="edge">
<title>L7_S0_TP3_GPU3_gate&#45;&gt;L7_S0_TP3_GPU3_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67869.17,-708.31C67869.17,-708.31 67869.17,-682.71 67869.17,-682.71"/>
<polygon fill="black" stroke="black" points="67872.67,-682.71 67869.17,-672.71 67865.67,-682.71 67872.67,-682.71"/>
</g>
<!-- L7_S0_TP3_GPU3_gate&#45;&gt;L7_S0_TP3_GPU3_expert1 -->
<g id="edge2189" class="edge">
<title>L7_S0_TP3_GPU3_gate&#45;&gt;L7_S0_TP3_GPU3_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M68298.57,-708.31C68298.57,-708.31 68298.57,-682.71 68298.57,-682.71"/>
<polygon fill="black" stroke="black" points="68302.07,-682.71 68298.57,-672.71 68295.07,-682.71 68302.07,-682.71"/>
</g>
<!-- L7_S0_TP3_GPU3_moe_ar&#45;&gt;L7_S0_TP3_GPU3_moe_res -->
<g id="edge2206" class="edge">
<title>L7_S0_TP3_GPU3_moe_ar&#45;&gt;L7_S0_TP3_GPU3_moe_res</title>
<path fill="none" stroke="black" d="M68157.66,-476.78C68157.66,-476.78 68157.66,-446.57 68157.66,-446.57"/>
<polygon fill="black" stroke="black" points="68161.16,-446.57 68157.66,-436.57 68154.16,-446.57 68161.16,-446.57"/>
</g>
<!-- L7_S0_TP3_GPU3_moe_res&#45;&gt;L7_S0_TP3_GPU3_norm -->
<g id="edge2208" class="edge">
<title>L7_S0_TP3_GPU3_moe_res&#45;&gt;L7_S0_TP3_GPU3_norm</title>
<path fill="none" stroke="black" d="M68411,-368.28C68411,-368.28 68411,-342.46 68411,-342.46"/>
<polygon fill="black" stroke="black" points="68414.5,-342.46 68411,-332.46 68407.5,-342.46 68414.5,-342.46"/>
</g>
<!-- L7_S0_TP4_GPU4_qkv_linear -->
<g id="node807" class="node">
<title>L7_S0_TP4_GPU4_qkv_linear</title>
<polygon fill="none" stroke="black" points="69259,-1614.75 68651,-1614.75 68651,-1546.75 69259,-1546.75 69259,-1614.75"/>
<text text-anchor="middle" x="68955" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="68955" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="68955" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="68955" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L7_S0_TP4_GPU4_qkv_slice -->
<g id="node808" class="node">
<title>L7_S0_TP4_GPU4_qkv_slice</title>
<polygon fill="none" stroke="black" points="69253,-1496.67 68657,-1496.67 68657,-1428.67 69253,-1428.67 69253,-1496.67"/>
<text text-anchor="middle" x="68955" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="68955" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="68955" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="68955" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L7_S0_TP4_GPU4_qkv_linear&#45;&gt;L7_S0_TP4_GPU4_qkv_slice -->
<g id="edge2225" class="edge">
<title>L7_S0_TP4_GPU4_qkv_linear&#45;&gt;L7_S0_TP4_GPU4_qkv_slice</title>
<path fill="none" stroke="black" d="M68955,-1546.59C68955,-1546.59 68955,-1506.74 68955,-1506.74"/>
<polygon fill="black" stroke="black" points="68958.5,-1506.74 68955,-1496.74 68951.5,-1506.74 68958.5,-1506.74"/>
</g>
<!-- L7_S0_TP4_GPU4_qkv_slice&#45;&gt;L7_S0_TP4_GPU4_attn_v -->
<g id="edge2229" class="edge">
<title>L7_S0_TP4_GPU4_qkv_slice&#45;&gt;L7_S0_TP4_GPU4_attn_v</title>
<path fill="none" stroke="black" d="M68798,-1428.38C68798,-1428.38 68798,-1195 68798,-1195"/>
<polygon fill="black" stroke="black" points="68801.5,-1195 68798,-1185 68794.5,-1195 68801.5,-1195"/>
</g>
<!-- L7_S0_TP4_GPU4_qk_matmul -->
<g id="node809" class="node">
<title>L7_S0_TP4_GPU4_qk_matmul</title>
<polygon fill="none" stroke="black" points="69763.5,-1392.67 68828.5,-1392.67 68828.5,-1324.67 69763.5,-1324.67 69763.5,-1392.67"/>
<text text-anchor="middle" x="69296" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="69296" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="69296" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="69296" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L7_S0_TP4_GPU4_qkv_slice&#45;&gt;L7_S0_TP4_GPU4_qk_matmul -->
<g id="edge2226" class="edge">
<title>L7_S0_TP4_GPU4_qkv_slice&#45;&gt;L7_S0_TP4_GPU4_qk_matmul</title>
<path fill="none" stroke="black" d="M69040.75,-1428.61C69040.75,-1428.61 69040.75,-1402.8 69040.75,-1402.8"/>
<polygon fill="black" stroke="black" points="69044.25,-1402.8 69040.75,-1392.8 69037.25,-1402.8 69044.25,-1402.8"/>
</g>
<!-- L7_S0_TP4_GPU4_softmax -->
<g id="node810" class="node">
<title>L7_S0_TP4_GPU4_softmax</title>
<polygon fill="none" stroke="black" points="69464,-1288.67 68954,-1288.67 68954,-1220.67 69464,-1220.67 69464,-1288.67"/>
<text text-anchor="middle" x="69209" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="69209" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="69209" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="69209" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L7_S0_TP4_GPU4_qk_matmul&#45;&gt;L7_S0_TP4_GPU4_softmax -->
<g id="edge2227" class="edge">
<title>L7_S0_TP4_GPU4_qk_matmul&#45;&gt;L7_S0_TP4_GPU4_softmax</title>
<path fill="none" stroke="black" d="M69209,-1324.61C69209,-1324.61 69209,-1298.8 69209,-1298.8"/>
<polygon fill="black" stroke="black" points="69212.5,-1298.8 69209,-1288.8 69205.5,-1298.8 69212.5,-1298.8"/>
</g>
<!-- L7_S0_TP4_GPU4_softmax&#45;&gt;L7_S0_TP4_GPU4_attn_v -->
<g id="edge2228" class="edge">
<title>L7_S0_TP4_GPU4_softmax&#45;&gt;L7_S0_TP4_GPU4_attn_v</title>
<path fill="none" stroke="black" d="M69209,-1220.61C69209,-1220.61 69209,-1194.8 69209,-1194.8"/>
<polygon fill="black" stroke="black" points="69212.5,-1194.8 69209,-1184.8 69205.5,-1194.8 69212.5,-1194.8"/>
</g>
<!-- L7_S0_TP4_GPU4_mha_res -->
<g id="node812" class="node">
<title>L7_S0_TP4_GPU4_mha_res</title>
<polygon fill="none" stroke="black" points="69626.5,-948.5 68739.5,-948.5 68739.5,-880.5 69626.5,-880.5 69626.5,-948.5"/>
<text text-anchor="middle" x="69183" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="69183" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="69183" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="69183" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP4_GPU4_mha_ar&#45;&gt;L7_S0_TP4_GPU4_mha_res -->
<g id="edge2238" class="edge">
<title>L7_S0_TP4_GPU4_mha_ar&#45;&gt;L7_S0_TP4_GPU4_mha_res</title>
<path fill="none" stroke="black" d="M69071.49,-984.55C69071.49,-984.55 69071.49,-958.73 69071.49,-958.73"/>
<polygon fill="black" stroke="black" points="69074.99,-958.73 69071.49,-948.73 69067.99,-958.73 69074.99,-958.73"/>
</g>
<!-- L7_S0_TP4_GPU4_gate -->
<g id="node813" class="node">
<title>L7_S0_TP4_GPU4_gate</title>
<polygon fill="none" stroke="black" points="69712.56,-844.5 68870.15,-844.5 68653.44,-708.5 69495.85,-708.5 69712.56,-844.5"/>
<text text-anchor="middle" x="69183" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="69183" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="69183" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="69183" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- L7_S0_TP4_GPU4_mha_res&#45;&gt;L7_S0_TP4_GPU4_gate -->
<g id="edge2239" class="edge">
<title>L7_S0_TP4_GPU4_mha_res&#45;&gt;L7_S0_TP4_GPU4_gate</title>
<path fill="none" stroke="black" d="M69183,-880.39C69183,-880.39 69183,-854.73 69183,-854.73"/>
<polygon fill="black" stroke="black" points="69186.5,-854.73 69183,-844.73 69179.5,-854.73 69186.5,-854.73"/>
</g>
<!-- L7_S0_TP4_GPU4_moe_res -->
<g id="node815" class="node">
<title>L7_S0_TP4_GPU4_moe_res</title>
<polygon fill="none" stroke="black" points="69474,-436.33 68654,-436.33 68654,-368.33 69474,-368.33 69474,-436.33"/>
<text text-anchor="middle" x="69064" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="69064" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="69064" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="69064" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP4_GPU4_mha_res&#45;&gt;L7_S0_TP4_GPU4_moe_res -->
<g id="edge2259" class="edge">
<title>L7_S0_TP4_GPU4_mha_res&#45;&gt;L7_S0_TP4_GPU4_moe_res</title>
<path fill="none" stroke="black" d="M68739.35,-903C68686.12,-903 68650.17,-903 68650.17,-903 68650.17,-903 68650.17,-390 68650.17,-390 68650.17,-390 68650.55,-390 68650.55,-390"/>
<polygon fill="black" stroke="black" points="68644,-393.5 68654,-390 68644,-386.5 68644,-393.5"/>
</g>
<!-- L7_S0_TP4_GPU4_gate&#45;&gt;L7_S0_TP4_GPU4_expert0 -->
<g id="edge2240" class="edge">
<title>L7_S0_TP4_GPU4_gate&#45;&gt;L7_S0_TP4_GPU4_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M68990.25,-708.31C68990.25,-708.31 68990.25,-682.71 68990.25,-682.71"/>
<polygon fill="black" stroke="black" points="68993.75,-682.71 68990.25,-672.71 68986.75,-682.71 68993.75,-682.71"/>
</g>
<!-- L7_S0_TP4_GPU4_gate&#45;&gt;L7_S0_TP4_GPU4_expert1 -->
<g id="edge2241" class="edge">
<title>L7_S0_TP4_GPU4_gate&#45;&gt;L7_S0_TP4_GPU4_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M69419.83,-708.31C69419.83,-708.31 69419.83,-682.71 69419.83,-682.71"/>
<polygon fill="black" stroke="black" points="69423.33,-682.71 69419.83,-672.71 69416.33,-682.71 69423.33,-682.71"/>
</g>
<!-- L7_S0_TP4_GPU4_moe_ar&#45;&gt;L7_S0_TP4_GPU4_moe_res -->
<g id="edge2258" class="edge">
<title>L7_S0_TP4_GPU4_moe_ar&#45;&gt;L7_S0_TP4_GPU4_moe_res</title>
<path fill="none" stroke="black" d="M69099.64,-474.76C69099.64,-474.76 69099.64,-446.51 69099.64,-446.51"/>
<polygon fill="black" stroke="black" points="69103.14,-446.51 69099.64,-436.51 69096.14,-446.51 69103.14,-446.51"/>
</g>
<!-- L7_S0_TP4_GPU4_moe_res&#45;&gt;L7_S0_TP4_GPU4_norm -->
<g id="edge2260" class="edge">
<title>L7_S0_TP4_GPU4_moe_res&#45;&gt;L7_S0_TP4_GPU4_norm</title>
<path fill="none" stroke="black" d="M68878.25,-368.28C68878.25,-368.28 68878.25,-342.46 68878.25,-342.46"/>
<polygon fill="black" stroke="black" points="68881.75,-342.46 68878.25,-332.46 68874.75,-342.46 68881.75,-342.46"/>
</g>
<!-- L7_S0_TP5_GPU5_qkv_linear -->
<g id="node816" class="node">
<title>L7_S0_TP5_GPU5_qkv_linear</title>
<polygon fill="none" stroke="black" points="70346,-1614.75 69738,-1614.75 69738,-1546.75 70346,-1546.75 70346,-1614.75"/>
<text text-anchor="middle" x="70042" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="70042" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="70042" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="70042" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L7_S0_TP5_GPU5_qkv_slice -->
<g id="node817" class="node">
<title>L7_S0_TP5_GPU5_qkv_slice</title>
<polygon fill="none" stroke="black" points="70340,-1496.67 69744,-1496.67 69744,-1428.67 70340,-1428.67 70340,-1496.67"/>
<text text-anchor="middle" x="70042" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="70042" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="70042" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="70042" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L7_S0_TP5_GPU5_qkv_linear&#45;&gt;L7_S0_TP5_GPU5_qkv_slice -->
<g id="edge2277" class="edge">
<title>L7_S0_TP5_GPU5_qkv_linear&#45;&gt;L7_S0_TP5_GPU5_qkv_slice</title>
<path fill="none" stroke="black" d="M70042,-1546.59C70042,-1546.59 70042,-1506.74 70042,-1506.74"/>
<polygon fill="black" stroke="black" points="70045.5,-1506.74 70042,-1496.74 70038.5,-1506.74 70045.5,-1506.74"/>
</g>
<!-- L7_S0_TP5_GPU5_qkv_slice&#45;&gt;L7_S0_TP5_GPU5_attn_v -->
<g id="edge2281" class="edge">
<title>L7_S0_TP5_GPU5_qkv_slice&#45;&gt;L7_S0_TP5_GPU5_attn_v</title>
<path fill="none" stroke="black" d="M69793,-1428.38C69793,-1428.38 69793,-1195 69793,-1195"/>
<polygon fill="black" stroke="black" points="69796.5,-1195 69793,-1185 69789.5,-1195 69796.5,-1195"/>
</g>
<!-- L7_S0_TP5_GPU5_qk_matmul -->
<g id="node818" class="node">
<title>L7_S0_TP5_GPU5_qk_matmul</title>
<polygon fill="none" stroke="black" points="70757.5,-1392.67 69822.5,-1392.67 69822.5,-1324.67 70757.5,-1324.67 70757.5,-1392.67"/>
<text text-anchor="middle" x="70290" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="70290" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="70290" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="70290" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L7_S0_TP5_GPU5_qkv_slice&#45;&gt;L7_S0_TP5_GPU5_qk_matmul -->
<g id="edge2278" class="edge">
<title>L7_S0_TP5_GPU5_qkv_slice&#45;&gt;L7_S0_TP5_GPU5_qk_matmul</title>
<path fill="none" stroke="black" d="M70081.25,-1428.61C70081.25,-1428.61 70081.25,-1402.8 70081.25,-1402.8"/>
<polygon fill="black" stroke="black" points="70084.75,-1402.8 70081.25,-1392.8 70077.75,-1402.8 70084.75,-1402.8"/>
</g>
<!-- L7_S0_TP5_GPU5_softmax -->
<g id="node819" class="node">
<title>L7_S0_TP5_GPU5_softmax</title>
<polygon fill="none" stroke="black" points="70439,-1288.67 69929,-1288.67 69929,-1220.67 70439,-1220.67 70439,-1288.67"/>
<text text-anchor="middle" x="70184" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="70184" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="70184" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="70184" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L7_S0_TP5_GPU5_qk_matmul&#45;&gt;L7_S0_TP5_GPU5_softmax -->
<g id="edge2279" class="edge">
<title>L7_S0_TP5_GPU5_qk_matmul&#45;&gt;L7_S0_TP5_GPU5_softmax</title>
<path fill="none" stroke="black" d="M70184,-1324.61C70184,-1324.61 70184,-1298.8 70184,-1298.8"/>
<polygon fill="black" stroke="black" points="70187.5,-1298.8 70184,-1288.8 70180.5,-1298.8 70187.5,-1298.8"/>
</g>
<!-- L7_S0_TP5_GPU5_softmax&#45;&gt;L7_S0_TP5_GPU5_attn_v -->
<g id="edge2280" class="edge">
<title>L7_S0_TP5_GPU5_softmax&#45;&gt;L7_S0_TP5_GPU5_attn_v</title>
<path fill="none" stroke="black" d="M70184,-1220.61C70184,-1220.61 70184,-1194.8 70184,-1194.8"/>
<polygon fill="black" stroke="black" points="70187.5,-1194.8 70184,-1184.8 70180.5,-1194.8 70187.5,-1194.8"/>
</g>
<!-- L7_S0_TP5_GPU5_mha_res -->
<g id="node821" class="node">
<title>L7_S0_TP5_GPU5_mha_res</title>
<polygon fill="none" stroke="black" points="70704.5,-948.5 69817.5,-948.5 69817.5,-880.5 70704.5,-880.5 70704.5,-948.5"/>
<text text-anchor="middle" x="70261" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="70261" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="70261" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="70261" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP5_GPU5_mha_ar&#45;&gt;L7_S0_TP5_GPU5_mha_res -->
<g id="edge2290" class="edge">
<title>L7_S0_TP5_GPU5_mha_ar&#45;&gt;L7_S0_TP5_GPU5_mha_res</title>
<path fill="none" stroke="black" d="M69994.99,-991.61C69994.99,-991.61 69994.99,-958.74 69994.99,-958.74"/>
<polygon fill="black" stroke="black" points="69998.49,-958.74 69994.99,-948.74 69991.49,-958.74 69998.49,-958.74"/>
</g>
<!-- L7_S0_TP5_GPU5_gate -->
<g id="node822" class="node">
<title>L7_S0_TP5_GPU5_gate</title>
<polygon fill="none" stroke="black" points="70790.56,-844.5 69948.15,-844.5 69731.44,-708.5 70573.85,-708.5 70790.56,-844.5"/>
<text text-anchor="middle" x="70261" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="70261" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="70261" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="70261" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- L7_S0_TP5_GPU5_mha_res&#45;&gt;L7_S0_TP5_GPU5_gate -->
<g id="edge2291" class="edge">
<title>L7_S0_TP5_GPU5_mha_res&#45;&gt;L7_S0_TP5_GPU5_gate</title>
<path fill="none" stroke="black" d="M70261,-880.39C70261,-880.39 70261,-854.73 70261,-854.73"/>
<polygon fill="black" stroke="black" points="70264.5,-854.73 70261,-844.73 70257.5,-854.73 70264.5,-854.73"/>
</g>
<!-- L7_S0_TP5_GPU5_moe_res -->
<g id="node824" class="node">
<title>L7_S0_TP5_GPU5_moe_res</title>
<polygon fill="none" stroke="black" points="70312,-436.33 69492,-436.33 69492,-368.33 70312,-368.33 70312,-436.33"/>
<text text-anchor="middle" x="69902" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="69902" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="69902" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="69902" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP5_GPU5_mha_res&#45;&gt;L7_S0_TP5_GPU5_moe_res -->
<g id="edge2311" class="edge">
<title>L7_S0_TP5_GPU5_mha_res&#45;&gt;L7_S0_TP5_GPU5_moe_res</title>
<path fill="none" stroke="black" d="M69817.43,-914C69760.73,-914 69722,-914 69722,-914 69722,-914 69722,-684 69722,-684 69722,-684 70043.25,-684 70043.25,-684 70043.25,-684 70043.25,-598 70043.25,-598 70043.25,-598 70021.51,-598 70021.51,-598 70021.51,-598 70021.51,-446.42 70021.51,-446.42"/>
<polygon fill="black" stroke="black" points="70025.01,-446.42 70021.51,-436.42 70018.01,-446.42 70025.01,-446.42"/>
</g>
<!-- L7_S0_TP5_GPU5_gate&#45;&gt;L7_S0_TP5_GPU5_expert0 -->
<g id="edge2292" class="edge">
<title>L7_S0_TP5_GPU5_gate&#45;&gt;L7_S0_TP5_GPU5_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M69883.86,-708.31C69883.86,-708.31 69883.86,-682.71 69883.86,-682.71"/>
<polygon fill="black" stroke="black" points="69887.36,-682.71 69883.86,-672.71 69880.36,-682.71 69887.36,-682.71"/>
</g>
<!-- L7_S0_TP5_GPU5_gate&#45;&gt;L7_S0_TP5_GPU5_expert1 -->
<g id="edge2293" class="edge">
<title>L7_S0_TP5_GPU5_gate&#45;&gt;L7_S0_TP5_GPU5_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M70391.25,-708.31C70391.25,-708.31 70391.25,-682.71 70391.25,-682.71"/>
<polygon fill="black" stroke="black" points="70394.75,-682.71 70391.25,-672.71 70387.75,-682.71 70394.75,-682.71"/>
</g>
<!-- L7_S0_TP5_GPU5_moe_ar&#45;&gt;L7_S0_TP5_GPU5_moe_res -->
<g id="edge2310" class="edge">
<title>L7_S0_TP5_GPU5_moe_ar&#45;&gt;L7_S0_TP5_GPU5_moe_res</title>
<path fill="none" stroke="black" d="M69750.73,-473.41C69750.73,-473.41 69750.73,-446.45 69750.73,-446.45"/>
<polygon fill="black" stroke="black" points="69754.23,-446.45 69750.73,-436.45 69747.23,-446.45 69754.23,-446.45"/>
</g>
<!-- L7_S0_TP5_GPU5_moe_res&#45;&gt;L7_S0_TP5_GPU5_norm -->
<g id="edge2312" class="edge">
<title>L7_S0_TP5_GPU5_moe_res&#45;&gt;L7_S0_TP5_GPU5_norm</title>
<path fill="none" stroke="black" d="M69530.75,-368.28C69530.75,-368.28 69530.75,-342.46 69530.75,-342.46"/>
<polygon fill="black" stroke="black" points="69534.25,-342.46 69530.75,-332.46 69527.25,-342.46 69534.25,-342.46"/>
</g>
<!-- L7_S0_TP6_GPU6_qkv_linear -->
<g id="node825" class="node">
<title>L7_S0_TP6_GPU6_qkv_linear</title>
<polygon fill="none" stroke="black" points="71390,-1614.75 70782,-1614.75 70782,-1546.75 71390,-1546.75 71390,-1614.75"/>
<text text-anchor="middle" x="71086" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="71086" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="71086" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="71086" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L7_S0_TP6_GPU6_qkv_slice -->
<g id="node826" class="node">
<title>L7_S0_TP6_GPU6_qkv_slice</title>
<polygon fill="none" stroke="black" points="71384,-1496.67 70788,-1496.67 70788,-1428.67 71384,-1428.67 71384,-1496.67"/>
<text text-anchor="middle" x="71086" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="71086" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="71086" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="71086" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L7_S0_TP6_GPU6_qkv_linear&#45;&gt;L7_S0_TP6_GPU6_qkv_slice -->
<g id="edge2329" class="edge">
<title>L7_S0_TP6_GPU6_qkv_linear&#45;&gt;L7_S0_TP6_GPU6_qkv_slice</title>
<path fill="none" stroke="black" d="M71086,-1546.59C71086,-1546.59 71086,-1506.74 71086,-1506.74"/>
<polygon fill="black" stroke="black" points="71089.5,-1506.74 71086,-1496.74 71082.5,-1506.74 71089.5,-1506.74"/>
</g>
<!-- L7_S0_TP6_GPU6_qkv_slice&#45;&gt;L7_S0_TP6_GPU6_attn_v -->
<g id="edge2333" class="edge">
<title>L7_S0_TP6_GPU6_qkv_slice&#45;&gt;L7_S0_TP6_GPU6_attn_v</title>
<path fill="none" stroke="black" d="M70827.25,-1428.38C70827.25,-1428.38 70827.25,-1195 70827.25,-1195"/>
<polygon fill="black" stroke="black" points="70830.75,-1195 70827.25,-1185 70823.75,-1195 70830.75,-1195"/>
</g>
<!-- L7_S0_TP6_GPU6_qk_matmul -->
<g id="node827" class="node">
<title>L7_S0_TP6_GPU6_qk_matmul</title>
<polygon fill="none" stroke="black" points="71801.5,-1392.67 70866.5,-1392.67 70866.5,-1324.67 71801.5,-1324.67 71801.5,-1392.67"/>
<text text-anchor="middle" x="71334" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="71334" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="71334" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="71334" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L7_S0_TP6_GPU6_qkv_slice&#45;&gt;L7_S0_TP6_GPU6_qk_matmul -->
<g id="edge2330" class="edge">
<title>L7_S0_TP6_GPU6_qkv_slice&#45;&gt;L7_S0_TP6_GPU6_qk_matmul</title>
<path fill="none" stroke="black" d="M71125.25,-1428.61C71125.25,-1428.61 71125.25,-1402.8 71125.25,-1402.8"/>
<polygon fill="black" stroke="black" points="71128.75,-1402.8 71125.25,-1392.8 71121.75,-1402.8 71128.75,-1402.8"/>
</g>
<!-- L7_S0_TP6_GPU6_softmax -->
<g id="node828" class="node">
<title>L7_S0_TP6_GPU6_softmax</title>
<polygon fill="none" stroke="black" points="71482,-1288.67 70972,-1288.67 70972,-1220.67 71482,-1220.67 71482,-1288.67"/>
<text text-anchor="middle" x="71227" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="71227" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="71227" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="71227" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L7_S0_TP6_GPU6_qk_matmul&#45;&gt;L7_S0_TP6_GPU6_softmax -->
<g id="edge2331" class="edge">
<title>L7_S0_TP6_GPU6_qk_matmul&#45;&gt;L7_S0_TP6_GPU6_softmax</title>
<path fill="none" stroke="black" d="M71227,-1324.61C71227,-1324.61 71227,-1298.8 71227,-1298.8"/>
<polygon fill="black" stroke="black" points="71230.5,-1298.8 71227,-1288.8 71223.5,-1298.8 71230.5,-1298.8"/>
</g>
<!-- L7_S0_TP6_GPU6_softmax&#45;&gt;L7_S0_TP6_GPU6_attn_v -->
<g id="edge2332" class="edge">
<title>L7_S0_TP6_GPU6_softmax&#45;&gt;L7_S0_TP6_GPU6_attn_v</title>
<path fill="none" stroke="black" d="M71227,-1220.61C71227,-1220.61 71227,-1194.8 71227,-1194.8"/>
<polygon fill="black" stroke="black" points="71230.5,-1194.8 71227,-1184.8 71223.5,-1194.8 71230.5,-1194.8"/>
</g>
<!-- L7_S0_TP6_GPU6_mha_res -->
<g id="node830" class="node">
<title>L7_S0_TP6_GPU6_mha_res</title>
<polygon fill="none" stroke="black" points="71782.5,-948.5 70895.5,-948.5 70895.5,-880.5 71782.5,-880.5 71782.5,-948.5"/>
<text text-anchor="middle" x="71339" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="71339" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="71339" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="71339" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP6_GPU6_mha_ar&#45;&gt;L7_S0_TP6_GPU6_mha_res -->
<g id="edge2342" class="edge">
<title>L7_S0_TP6_GPU6_mha_ar&#45;&gt;L7_S0_TP6_GPU6_mha_res</title>
<path fill="none" stroke="black" d="M70918.49,-1015.91C70918.49,-1015.91 70918.49,-958.58 70918.49,-958.58"/>
<polygon fill="black" stroke="black" points="70921.99,-958.58 70918.49,-948.58 70914.99,-958.58 70921.99,-958.58"/>
</g>
<!-- L7_S0_TP6_GPU6_gate -->
<g id="node831" class="node">
<title>L7_S0_TP6_GPU6_gate</title>
<polygon fill="none" stroke="black" points="71868.56,-844.5 71026.15,-844.5 70809.44,-708.5 71651.85,-708.5 71868.56,-844.5"/>
<text text-anchor="middle" x="71339" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="71339" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="71339" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="71339" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- L7_S0_TP6_GPU6_mha_res&#45;&gt;L7_S0_TP6_GPU6_gate -->
<g id="edge2343" class="edge">
<title>L7_S0_TP6_GPU6_mha_res&#45;&gt;L7_S0_TP6_GPU6_gate</title>
<path fill="none" stroke="black" d="M71339,-880.39C71339,-880.39 71339,-854.73 71339,-854.73"/>
<polygon fill="black" stroke="black" points="71342.5,-854.73 71339,-844.73 71335.5,-854.73 71342.5,-854.73"/>
</g>
<!-- L7_S0_TP6_GPU6_moe_res -->
<g id="node833" class="node">
<title>L7_S0_TP6_GPU6_moe_res</title>
<polygon fill="none" stroke="black" points="71150,-436.33 70330,-436.33 70330,-368.33 71150,-368.33 71150,-436.33"/>
<text text-anchor="middle" x="70740" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="70740" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="70740" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="70740" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP6_GPU6_mha_res&#45;&gt;L7_S0_TP6_GPU6_moe_res -->
<g id="edge2363" class="edge">
<title>L7_S0_TP6_GPU6_mha_res&#45;&gt;L7_S0_TP6_GPU6_moe_res</title>
<path fill="none" stroke="black" d="M70895.43,-914C70838.73,-914 70800,-914 70800,-914 70800,-914 70800,-694 70800,-694 70800,-694 70974.1,-694 70974.1,-694 70974.1,-694 70974.1,-603 70974.1,-603 70974.1,-603 70710.02,-603 70710.02,-603 70710.02,-603 70710.02,-446.37 70710.02,-446.37"/>
<polygon fill="black" stroke="black" points="70713.52,-446.37 70710.02,-436.37 70706.52,-446.37 70713.52,-446.37"/>
</g>
<!-- L7_S0_TP6_GPU6_gate&#45;&gt;L7_S0_TP6_GPU6_expert0 -->
<g id="edge2344" class="edge">
<title>L7_S0_TP6_GPU6_gate&#45;&gt;L7_S0_TP6_GPU6_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M70889.86,-708.31C70889.86,-708.31 70889.86,-682.71 70889.86,-682.71"/>
<polygon fill="black" stroke="black" points="70893.36,-682.71 70889.86,-672.71 70886.36,-682.71 70893.36,-682.71"/>
</g>
<!-- L7_S0_TP6_GPU6_gate&#45;&gt;L7_S0_TP6_GPU6_expert1 -->
<g id="edge2345" class="edge">
<title>L7_S0_TP6_GPU6_gate&#45;&gt;L7_S0_TP6_GPU6_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M71213,-708.31C71213,-708.31 71213,-682.71 71213,-682.71"/>
<polygon fill="black" stroke="black" points="71216.5,-682.71 71213,-672.71 71209.5,-682.71 71216.5,-682.71"/>
</g>
<!-- L7_S0_TP6_GPU6_moe_ar&#45;&gt;L7_S0_TP6_GPU6_moe_res -->
<g id="edge2362" class="edge">
<title>L7_S0_TP6_GPU6_moe_ar&#45;&gt;L7_S0_TP6_GPU6_moe_res</title>
<path fill="none" stroke="black" d="M70513.23,-477.45C70513.23,-477.45 70513.23,-446.57 70513.23,-446.57"/>
<polygon fill="black" stroke="black" points="70516.73,-446.57 70513.23,-436.57 70509.73,-446.57 70516.73,-446.57"/>
</g>
<!-- L7_S0_TP6_GPU6_moe_res&#45;&gt;L7_S0_TP6_GPU6_norm -->
<g id="edge2364" class="edge">
<title>L7_S0_TP6_GPU6_moe_res&#45;&gt;L7_S0_TP6_GPU6_norm</title>
<path fill="none" stroke="black" d="M70416.75,-368.3C70416.75,-358.31 70416.75,-350 70416.75,-350 70416.75,-350 69812,-350 69812,-350 69812,-350 69812,-342.51 69812,-342.51"/>
<polygon fill="black" stroke="black" points="69815.5,-342.51 69812,-332.51 69808.5,-342.51 69815.5,-342.51"/>
</g>
<!-- L7_S0_TP7_GPU7_qkv_linear -->
<g id="node834" class="node">
<title>L7_S0_TP7_GPU7_qkv_linear</title>
<polygon fill="none" stroke="black" points="72489,-1614.75 71881,-1614.75 71881,-1546.75 72489,-1546.75 72489,-1614.75"/>
<text text-anchor="middle" x="72185" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="72185" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="72185" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="72185" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L7_S0_TP7_GPU7_qkv_slice -->
<g id="node835" class="node">
<title>L7_S0_TP7_GPU7_qkv_slice</title>
<polygon fill="none" stroke="black" points="72483,-1496.67 71887,-1496.67 71887,-1428.67 72483,-1428.67 72483,-1496.67"/>
<text text-anchor="middle" x="72185" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="72185" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="72185" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="72185" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L7_S0_TP7_GPU7_qkv_linear&#45;&gt;L7_S0_TP7_GPU7_qkv_slice -->
<g id="edge2381" class="edge">
<title>L7_S0_TP7_GPU7_qkv_linear&#45;&gt;L7_S0_TP7_GPU7_qkv_slice</title>
<path fill="none" stroke="black" d="M72185,-1546.59C72185,-1546.59 72185,-1506.74 72185,-1506.74"/>
<polygon fill="black" stroke="black" points="72188.5,-1506.74 72185,-1496.74 72181.5,-1506.74 72188.5,-1506.74"/>
</g>
<!-- L7_S0_TP7_GPU7_qkv_slice&#45;&gt;L7_S0_TP7_GPU7_attn_v -->
<g id="edge2385" class="edge">
<title>L7_S0_TP7_GPU7_qkv_slice&#45;&gt;L7_S0_TP7_GPU7_attn_v</title>
<path fill="none" stroke="black" d="M71926.25,-1428.38C71926.25,-1428.38 71926.25,-1195 71926.25,-1195"/>
<polygon fill="black" stroke="black" points="71929.75,-1195 71926.25,-1185 71922.75,-1195 71929.75,-1195"/>
</g>
<!-- L7_S0_TP7_GPU7_qk_matmul -->
<g id="node836" class="node">
<title>L7_S0_TP7_GPU7_qk_matmul</title>
<polygon fill="none" stroke="black" points="72900.5,-1392.67 71965.5,-1392.67 71965.5,-1324.67 72900.5,-1324.67 72900.5,-1392.67"/>
<text text-anchor="middle" x="72433" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="72433" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="72433" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="72433" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L7_S0_TP7_GPU7_qkv_slice&#45;&gt;L7_S0_TP7_GPU7_qk_matmul -->
<g id="edge2382" class="edge">
<title>L7_S0_TP7_GPU7_qkv_slice&#45;&gt;L7_S0_TP7_GPU7_qk_matmul</title>
<path fill="none" stroke="black" d="M72224.25,-1428.61C72224.25,-1428.61 72224.25,-1402.8 72224.25,-1402.8"/>
<polygon fill="black" stroke="black" points="72227.75,-1402.8 72224.25,-1392.8 72220.75,-1402.8 72227.75,-1402.8"/>
</g>
<!-- L7_S0_TP7_GPU7_softmax -->
<g id="node837" class="node">
<title>L7_S0_TP7_GPU7_softmax</title>
<polygon fill="none" stroke="black" points="72581,-1288.67 72071,-1288.67 72071,-1220.67 72581,-1220.67 72581,-1288.67"/>
<text text-anchor="middle" x="72326" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="72326" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="72326" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="72326" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L7_S0_TP7_GPU7_qk_matmul&#45;&gt;L7_S0_TP7_GPU7_softmax -->
<g id="edge2383" class="edge">
<title>L7_S0_TP7_GPU7_qk_matmul&#45;&gt;L7_S0_TP7_GPU7_softmax</title>
<path fill="none" stroke="black" d="M72326,-1324.61C72326,-1324.61 72326,-1298.8 72326,-1298.8"/>
<polygon fill="black" stroke="black" points="72329.5,-1298.8 72326,-1288.8 72322.5,-1298.8 72329.5,-1298.8"/>
</g>
<!-- L7_S0_TP7_GPU7_softmax&#45;&gt;L7_S0_TP7_GPU7_attn_v -->
<g id="edge2384" class="edge">
<title>L7_S0_TP7_GPU7_softmax&#45;&gt;L7_S0_TP7_GPU7_attn_v</title>
<path fill="none" stroke="black" d="M72265,-1220.61C72265,-1220.61 72265,-1194.8 72265,-1194.8"/>
<polygon fill="black" stroke="black" points="72268.5,-1194.8 72265,-1184.8 72261.5,-1194.8 72268.5,-1194.8"/>
</g>
<!-- L7_S0_TP7_GPU7_mha_res -->
<g id="node839" class="node">
<title>L7_S0_TP7_GPU7_mha_res</title>
<polygon fill="none" stroke="black" points="72860.5,-948.5 71973.5,-948.5 71973.5,-880.5 72860.5,-880.5 72860.5,-948.5"/>
<text text-anchor="middle" x="72417" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="72417" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="72417" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="72417" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP7_GPU7_mha_ar&#45;&gt;L7_S0_TP7_GPU7_mha_res -->
<g id="edge2394" class="edge">
<title>L7_S0_TP7_GPU7_mha_ar&#45;&gt;L7_S0_TP7_GPU7_mha_res</title>
<path fill="none" stroke="black" d="M71687.73,-1016C71933.04,-1016 72216.25,-1016 72216.25,-1016 72216.25,-1016 72216.25,-958.58 72216.25,-958.58"/>
<polygon fill="black" stroke="black" points="72219.75,-958.58 72216.25,-948.58 72212.75,-958.58 72219.75,-958.58"/>
</g>
<!-- L7_S0_TP7_GPU7_gate -->
<g id="node840" class="node">
<title>L7_S0_TP7_GPU7_gate</title>
<polygon fill="none" stroke="black" points="72946.56,-844.5 72104.15,-844.5 71887.44,-708.5 72729.85,-708.5 72946.56,-844.5"/>
<text text-anchor="middle" x="72417" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="72417" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="72417" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="72417" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- L7_S0_TP7_GPU7_mha_res&#45;&gt;L7_S0_TP7_GPU7_gate -->
<g id="edge2395" class="edge">
<title>L7_S0_TP7_GPU7_mha_res&#45;&gt;L7_S0_TP7_GPU7_gate</title>
<path fill="none" stroke="black" d="M72417,-880.39C72417,-880.39 72417,-854.73 72417,-854.73"/>
<polygon fill="black" stroke="black" points="72420.5,-854.73 72417,-844.73 72413.5,-854.73 72420.5,-854.73"/>
</g>
<!-- L7_S0_TP7_GPU7_moe_res -->
<g id="node842" class="node">
<title>L7_S0_TP7_GPU7_moe_res</title>
<polygon fill="none" stroke="black" points="71988,-436.33 71168,-436.33 71168,-368.33 71988,-368.33 71988,-436.33"/>
<text text-anchor="middle" x="71578" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="71578" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="71578" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="71578" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 0</text>
</g>
<!-- L7_S0_TP7_GPU7_mha_res&#45;&gt;L7_S0_TP7_GPU7_moe_res -->
<g id="edge2415" class="edge">
<title>L7_S0_TP7_GPU7_mha_res&#45;&gt;L7_S0_TP7_GPU7_moe_res</title>
<path fill="none" stroke="black" d="M71973.43,-914C71916.73,-914 71878,-914 71878,-914 71878,-914 71878,-697 71878,-697 71878,-697 71913.5,-697 71913.5,-697 71913.5,-697 71913.5,-446.42 71913.5,-446.42"/>
<polygon fill="black" stroke="black" points="71917,-446.42 71913.5,-436.42 71910,-446.42 71917,-446.42"/>
</g>
<!-- L7_S0_TP7_GPU7_gate&#45;&gt;L7_S0_TP7_GPU7_expert0 -->
<g id="edge2396" class="edge">
<title>L7_S0_TP7_GPU7_gate&#45;&gt;L7_S0_TP7_GPU7_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M71895.86,-776.4C71895.86,-776.4 71895.86,-682.74 71895.86,-682.74"/>
<polygon fill="black" stroke="black" points="71899.36,-682.74 71895.86,-672.74 71892.36,-682.74 71899.36,-682.74"/>
</g>
<!-- L7_S0_TP7_GPU7_gate&#45;&gt;L7_S0_TP7_GPU7_expert1 -->
<g id="edge2397" class="edge">
<title>L7_S0_TP7_GPU7_gate&#45;&gt;L7_S0_TP7_GPU7_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M72147,-708.31C72147,-708.31 72147,-682.71 72147,-682.71"/>
<polygon fill="black" stroke="black" points="72150.5,-682.71 72147,-672.71 72143.5,-682.71 72150.5,-682.71"/>
</g>
<!-- L7_S0_TP7_GPU7_moe_ar&#45;&gt;L7_S0_TP7_GPU7_moe_res -->
<g id="edge2414" class="edge">
<title>L7_S0_TP7_GPU7_moe_ar&#45;&gt;L7_S0_TP7_GPU7_moe_res</title>
<path fill="none" stroke="black" d="M71275.73,-484.99C71275.73,-484.99 71275.73,-446.52 71275.73,-446.52"/>
<polygon fill="black" stroke="black" points="71279.23,-446.52 71275.73,-436.52 71272.23,-446.52 71279.23,-446.52"/>
</g>
<!-- L7_S0_TP7_GPU7_moe_res&#45;&gt;L7_S0_TP7_GPU7_norm -->
<g id="edge2416" class="edge">
<title>L7_S0_TP7_GPU7_moe_res&#45;&gt;L7_S0_TP7_GPU7_norm</title>
<path fill="none" stroke="black" d="M71207.75,-368.17C71207.75,-337.74 71207.75,-298 71207.75,-298 71207.75,-298 70513.53,-298 70513.53,-298"/>
<polygon fill="black" stroke="black" points="70513.53,-294.5 70503.53,-298 70513.53,-301.5 70513.53,-294.5"/>
</g>
<!-- L8_S1_TP0_GPU8_qkv_linear -->
<g id="node843" class="node">
<title>L8_S1_TP0_GPU8_qkv_linear</title>
<polygon fill="none" stroke="black" points="74228,-1614.75 73620,-1614.75 73620,-1546.75 74228,-1546.75 74228,-1614.75"/>
<text text-anchor="middle" x="73924" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="73924" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="73924" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="73924" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L8_S1_TP0_GPU8_qkv_slice -->
<g id="node844" class="node">
<title>L8_S1_TP0_GPU8_qkv_slice</title>
<polygon fill="none" stroke="black" points="74222,-1496.67 73626,-1496.67 73626,-1428.67 74222,-1428.67 74222,-1496.67"/>
<text text-anchor="middle" x="73924" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="73924" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="73924" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="73924" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L8_S1_TP0_GPU8_qkv_linear&#45;&gt;L8_S1_TP0_GPU8_qkv_slice -->
<g id="edge2433" class="edge">
<title>L8_S1_TP0_GPU8_qkv_linear&#45;&gt;L8_S1_TP0_GPU8_qkv_slice</title>
<path fill="none" stroke="black" d="M73924,-1546.59C73924,-1546.59 73924,-1506.74 73924,-1506.74"/>
<polygon fill="black" stroke="black" points="73927.5,-1506.74 73924,-1496.74 73920.5,-1506.74 73927.5,-1506.74"/>
</g>
<!-- L8_S1_TP0_GPU8_qk_matmul -->
<g id="node845" class="node">
<title>L8_S1_TP0_GPU8_qk_matmul</title>
<polygon fill="none" stroke="black" points="74696.5,-1392.67 73761.5,-1392.67 73761.5,-1324.67 74696.5,-1324.67 74696.5,-1392.67"/>
<text text-anchor="middle" x="74229" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="74229" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="74229" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="74229" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L8_S1_TP0_GPU8_qkv_slice&#45;&gt;L8_S1_TP0_GPU8_qk_matmul -->
<g id="edge2434" class="edge">
<title>L8_S1_TP0_GPU8_qkv_slice&#45;&gt;L8_S1_TP0_GPU8_qk_matmul</title>
<path fill="none" stroke="black" d="M73991.75,-1428.61C73991.75,-1428.61 73991.75,-1402.8 73991.75,-1402.8"/>
<polygon fill="black" stroke="black" points="73995.25,-1402.8 73991.75,-1392.8 73988.25,-1402.8 73995.25,-1402.8"/>
</g>
<!-- L8_S1_TP0_GPU8_attn_v -->
<g id="node847" class="node">
<title>L8_S1_TP0_GPU8_attn_v</title>
<polygon fill="none" stroke="black" points="74696,-1184.67 73758,-1184.67 73758,-1116.67 74696,-1116.67 74696,-1184.67"/>
<text text-anchor="middle" x="74227" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="74227" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="74227" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="74227" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L8_S1_TP0_GPU8_qkv_slice&#45;&gt;L8_S1_TP0_GPU8_attn_v -->
<g id="edge2437" class="edge">
<title>L8_S1_TP0_GPU8_qkv_slice&#45;&gt;L8_S1_TP0_GPU8_attn_v</title>
<path fill="none" stroke="black" d="M73692,-1428.61C73692,-1347.57 73692,-1150 73692,-1150 73692,-1150 73747.87,-1150 73747.87,-1150"/>
<polygon fill="black" stroke="black" points="73747.87,-1153.5 73757.87,-1150 73747.87,-1146.5 73747.87,-1153.5"/>
</g>
<!-- L8_S1_TP0_GPU8_softmax -->
<g id="node846" class="node">
<title>L8_S1_TP0_GPU8_softmax</title>
<polygon fill="none" stroke="black" points="74483,-1288.67 73973,-1288.67 73973,-1220.67 74483,-1220.67 74483,-1288.67"/>
<text text-anchor="middle" x="74228" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="74228" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="74228" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="74228" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L8_S1_TP0_GPU8_qk_matmul&#45;&gt;L8_S1_TP0_GPU8_softmax -->
<g id="edge2435" class="edge">
<title>L8_S1_TP0_GPU8_qk_matmul&#45;&gt;L8_S1_TP0_GPU8_softmax</title>
<path fill="none" stroke="black" d="M74228,-1324.61C74228,-1324.61 74228,-1298.8 74228,-1298.8"/>
<polygon fill="black" stroke="black" points="74231.5,-1298.8 74228,-1288.8 74224.5,-1298.8 74231.5,-1298.8"/>
</g>
<!-- L8_S1_TP0_GPU8_softmax&#45;&gt;L8_S1_TP0_GPU8_attn_v -->
<g id="edge2436" class="edge">
<title>L8_S1_TP0_GPU8_softmax&#45;&gt;L8_S1_TP0_GPU8_attn_v</title>
<path fill="none" stroke="black" d="M74228,-1220.61C74228,-1220.61 74228,-1194.8 74228,-1194.8"/>
<polygon fill="black" stroke="black" points="74231.5,-1194.8 74228,-1184.8 74224.5,-1194.8 74231.5,-1194.8"/>
</g>
<!-- L8_S1_TP0_GPU8_mha_ar -->
<g id="node848" class="node">
<title>L8_S1_TP0_GPU8_mha_ar</title>
<ellipse fill="none" stroke="black" cx="74881" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="74881" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="74881" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="74881" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="74881" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP0_GPU8_attn_v&#45;&gt;L8_S1_TP0_GPU8_mha_ar -->
<g id="edge2438" class="edge">
<title>L8_S1_TP0_GPU8_attn_v&#45;&gt;L8_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M74532.74,-1116.51C74532.74,-1116.51 74532.74,-1060.6 74532.74,-1060.6"/>
<polygon fill="black" stroke="black" points="74536.24,-1060.6 74532.74,-1050.6 74529.24,-1060.6 74536.24,-1060.6"/>
</g>
<!-- L8_S1_TP1_GPU9_mha_ar -->
<g id="node881" class="node">
<title>L8_S1_TP1_GPU9_mha_ar</title>
<ellipse fill="none" stroke="black" cx="75650" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="75650" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="75650" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="75650" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="75650" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP0_GPU8_attn_v&#45;&gt;L8_S1_TP1_GPU9_mha_ar -->
<g id="edge2474" class="edge">
<title>L8_S1_TP0_GPU8_attn_v&#45;&gt;L8_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M74559.95,-1116.44C74559.95,-1099.65 74559.95,-1083 74559.95,-1083 74559.95,-1083 75321.71,-1083 75321.71,-1083 75321.71,-1083 75321.71,-1066.02 75321.71,-1066.02"/>
<polygon fill="black" stroke="black" points="75325.21,-1066.02 75321.71,-1056.02 75318.21,-1066.02 75325.21,-1066.02"/>
</g>
<!-- L8_S1_TP2_GPU10_mha_ar -->
<g id="node891" class="node">
<title>L8_S1_TP2_GPU10_mha_ar</title>
<ellipse fill="none" stroke="black" cx="76419" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="76419" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="76419" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="76419" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="76419" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP0_GPU8_attn_v&#45;&gt;L8_S1_TP2_GPU10_mha_ar -->
<g id="edge2510" class="edge">
<title>L8_S1_TP0_GPU8_attn_v&#45;&gt;L8_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M74587.16,-1116.44C74587.16,-1099.65 74587.16,-1083 74587.16,-1083 74587.16,-1083 76106.25,-1083 76106.25,-1083 76106.25,-1083 76106.25,-1069.27 76106.25,-1069.27"/>
<polygon fill="black" stroke="black" points="76109.75,-1069.27 76106.25,-1059.27 76102.75,-1069.27 76109.75,-1069.27"/>
</g>
<!-- L8_S1_TP3_GPU11_mha_ar -->
<g id="node901" class="node">
<title>L8_S1_TP3_GPU11_mha_ar</title>
<ellipse fill="none" stroke="black" cx="77188" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="77188" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="77188" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="77188" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="77188" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP0_GPU8_attn_v&#45;&gt;L8_S1_TP3_GPU11_mha_ar -->
<g id="edge2546" class="edge">
<title>L8_S1_TP0_GPU8_attn_v&#45;&gt;L8_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M74614.37,-1116.44C74614.37,-1099.65 74614.37,-1083 74614.37,-1083 74614.37,-1083 76919.8,-1083 76919.8,-1083 76919.8,-1083 76919.8,-1076.49 76919.8,-1076.49"/>
<polygon fill="black" stroke="black" points="76923.3,-1076.49 76919.8,-1066.49 76916.3,-1076.49 76923.3,-1076.49"/>
</g>
<!-- L8_S1_TP4_GPU12_mha_ar -->
<g id="node911" class="node">
<title>L8_S1_TP4_GPU12_mha_ar</title>
<ellipse fill="none" stroke="black" cx="77957" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="77957" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="77957" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="77957" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="77957" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP0_GPU8_attn_v&#45;&gt;L8_S1_TP4_GPU12_mha_ar -->
<g id="edge2582" class="edge">
<title>L8_S1_TP0_GPU8_attn_v&#45;&gt;L8_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M74469.51,-1116.49C74469.51,-1060.89 74469.51,-957 74469.51,-957 74469.51,-957 77638.84,-957 77638.84,-957 77638.84,-957 77638.84,-996.99 77638.84,-996.99"/>
<polygon fill="black" stroke="black" points="77635.34,-996.99 77638.84,-1006.99 77642.34,-996.99 77635.34,-996.99"/>
</g>
<!-- L8_S1_TP5_GPU13_mha_ar -->
<g id="node921" class="node">
<title>L8_S1_TP5_GPU13_mha_ar</title>
<ellipse fill="none" stroke="black" cx="78726" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="78726" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="78726" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="78726" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="78726" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP0_GPU8_attn_v&#45;&gt;L8_S1_TP5_GPU13_mha_ar -->
<g id="edge2618" class="edge">
<title>L8_S1_TP0_GPU8_attn_v&#45;&gt;L8_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M74589.5,-1184.84C74589.5,-1198.03 74589.5,-1210 74589.5,-1210 74589.5,-1210 78532,-1210 78532,-1210 78532,-1210 78532,-1084.18 78532,-1084.18"/>
<polygon fill="black" stroke="black" points="78535.5,-1084.18 78532,-1074.18 78528.5,-1084.18 78535.5,-1084.18"/>
</g>
<!-- L8_S1_TP6_GPU14_mha_ar -->
<g id="node931" class="node">
<title>L8_S1_TP6_GPU14_mha_ar</title>
<ellipse fill="none" stroke="black" cx="79495" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="79495" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="79495" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="79495" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="79495" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP0_GPU8_attn_v&#45;&gt;L8_S1_TP6_GPU14_mha_ar -->
<g id="edge2654" class="edge">
<title>L8_S1_TP0_GPU8_attn_v&#45;&gt;L8_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M74641.58,-1116.53C74641.58,-1108.89 74641.58,-1103 74641.58,-1103 74641.58,-1103 79170.45,-1103 79170.45,-1103 79170.45,-1103 79170.45,-1066.82 79170.45,-1066.82"/>
<polygon fill="black" stroke="black" points="79173.95,-1066.82 79170.45,-1056.82 79166.95,-1066.82 79173.95,-1066.82"/>
</g>
<!-- L8_S1_TP7_GPU15_mha_ar -->
<g id="node941" class="node">
<title>L8_S1_TP7_GPU15_mha_ar</title>
<ellipse fill="none" stroke="black" cx="80264" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="80264" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="80264" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="80264" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="80264" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP0_GPU8_attn_v&#45;&gt;L8_S1_TP7_GPU15_mha_ar -->
<g id="edge2690" class="edge">
<title>L8_S1_TP0_GPU8_attn_v&#45;&gt;L8_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M74668.79,-1116.53C74668.79,-1108.89 74668.79,-1103 74668.79,-1103 74668.79,-1103 79956.46,-1103 79956.46,-1103 79956.46,-1103 79956.46,-1070.41 79956.46,-1070.41"/>
<polygon fill="black" stroke="black" points="79959.96,-1070.41 79956.46,-1060.41 79952.96,-1070.41 79959.96,-1070.41"/>
</g>
<!-- L8_S1_TP0_GPU8_mha_res -->
<g id="node856" class="node">
<title>L8_S1_TP0_GPU8_mha_res</title>
<polygon fill="none" stroke="black" points="74242.5,-948.5 73355.5,-948.5 73355.5,-880.5 74242.5,-880.5 74242.5,-948.5"/>
<text text-anchor="middle" x="73799" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="73799" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="73799" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="73799" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP0_GPU8_mha_ar&#45;&gt;L8_S1_TP0_GPU8_mha_res -->
<g id="edge2446" class="edge">
<title>L8_S1_TP0_GPU8_mha_ar&#45;&gt;L8_S1_TP0_GPU8_mha_res</title>
<path fill="none" stroke="black" d="M74525.3,-1048C74280.86,-1048 74000.25,-1048 74000.25,-1048 74000.25,-1048 74000.25,-958.53 74000.25,-958.53"/>
<polygon fill="black" stroke="black" points="74003.75,-958.53 74000.25,-948.53 73996.75,-958.53 74003.75,-958.53"/>
</g>
<!-- L8_S1_TP1_GPU9_attn_v -->
<g id="node849" class="node">
<title>L8_S1_TP1_GPU9_attn_v</title>
<polygon fill="none" stroke="black" points="75652,-1184.67 74714,-1184.67 74714,-1116.67 75652,-1116.67 75652,-1184.67"/>
<text text-anchor="middle" x="75183" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="75183" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="75183" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="75183" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L8_S1_TP1_GPU9_attn_v&#45;&gt;L8_S1_TP0_GPU8_mha_ar -->
<g id="edge2439" class="edge">
<title>L8_S1_TP1_GPU9_attn_v&#45;&gt;L8_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M74781.81,-1116.51C74781.81,-1116.51 74781.81,-1088.96 74781.81,-1088.96"/>
<polygon fill="black" stroke="black" points="74785.31,-1088.96 74781.81,-1078.96 74778.31,-1088.96 74785.31,-1088.96"/>
</g>
<!-- L8_S1_TP1_GPU9_attn_v&#45;&gt;L8_S1_TP1_GPU9_mha_ar -->
<g id="edge2475" class="edge">
<title>L8_S1_TP1_GPU9_attn_v&#45;&gt;L8_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M75368.89,-1116.51C75368.89,-1116.51 75368.89,-1074.64 75368.89,-1074.64"/>
<polygon fill="black" stroke="black" points="75372.39,-1074.64 75368.89,-1064.64 75365.39,-1074.64 75372.39,-1074.64"/>
</g>
<!-- L8_S1_TP1_GPU9_attn_v&#45;&gt;L8_S1_TP2_GPU10_mha_ar -->
<g id="edge2511" class="edge">
<title>L8_S1_TP1_GPU9_attn_v&#45;&gt;L8_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M75416.08,-1116.44C75416.08,-1099.65 75416.08,-1083 75416.08,-1083 75416.08,-1083 76168.96,-1083 76168.96,-1083 76168.96,-1083 76168.96,-1078.69 76168.96,-1078.69"/>
<polygon fill="black" stroke="black" points="76172.46,-1078.69 76168.96,-1068.69 76165.46,-1078.69 76172.46,-1078.69"/>
</g>
<!-- L8_S1_TP1_GPU9_attn_v&#45;&gt;L8_S1_TP3_GPU11_mha_ar -->
<g id="edge2547" class="edge">
<title>L8_S1_TP1_GPU9_attn_v&#45;&gt;L8_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M75463.26,-1116.44C75463.26,-1099.65 75463.26,-1083 75463.26,-1083 75463.26,-1083 77027.08,-1083 77027.08,-1083 77027.08,-1083 77027.08,-1082.34 77027.08,-1082.34"/>
<polygon fill="black" stroke="black" points="77030.58,-1086.41 77027.08,-1076.41 77023.58,-1086.41 77030.58,-1086.41"/>
</g>
<!-- L8_S1_TP1_GPU9_attn_v&#45;&gt;L8_S1_TP4_GPU12_mha_ar -->
<g id="edge2583" class="edge">
<title>L8_S1_TP1_GPU9_attn_v&#45;&gt;L8_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M75265.5,-1116.49C75265.5,-1060.89 75265.5,-957 75265.5,-957 75265.5,-957 77610.18,-957 77610.18,-957 77610.18,-957 77610.18,-1003.9 77610.18,-1003.9"/>
<polygon fill="black" stroke="black" points="77606.68,-1003.9 77610.18,-1013.9 77613.68,-1003.9 77606.68,-1003.9"/>
</g>
<!-- L8_S1_TP1_GPU9_attn_v&#45;&gt;L8_S1_TP5_GPU13_mha_ar -->
<g id="edge2619" class="edge">
<title>L8_S1_TP1_GPU9_attn_v&#45;&gt;L8_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M75510.45,-1116.53C75510.45,-1108.89 75510.45,-1103 75510.45,-1103 75510.45,-1103 78378.77,-1103 78378.77,-1103 78378.77,-1103 78378.77,-1061.08 78378.77,-1061.08"/>
<polygon fill="black" stroke="black" points="78382.27,-1061.08 78378.77,-1051.08 78375.27,-1061.08 78382.27,-1061.08"/>
</g>
<!-- L8_S1_TP1_GPU9_attn_v&#45;&gt;L8_S1_TP6_GPU14_mha_ar -->
<g id="edge2655" class="edge">
<title>L8_S1_TP1_GPU9_attn_v&#45;&gt;L8_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M75557.63,-1116.53C75557.63,-1108.89 75557.63,-1103 75557.63,-1103 75557.63,-1103 79221.38,-1103 79221.38,-1103 79221.38,-1103 79221.38,-1075.73 79221.38,-1075.73"/>
<polygon fill="black" stroke="black" points="79224.88,-1075.73 79221.38,-1065.73 79217.88,-1075.73 79224.88,-1075.73"/>
</g>
<!-- L8_S1_TP1_GPU9_attn_v&#45;&gt;L8_S1_TP7_GPU15_mha_ar -->
<g id="edge2691" class="edge">
<title>L8_S1_TP1_GPU9_attn_v&#45;&gt;L8_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M75604.82,-1116.53C75604.82,-1108.89 75604.82,-1103 75604.82,-1103 75604.82,-1103 80024.39,-1103 80024.39,-1103 80024.39,-1103 80024.39,-1079.85 80024.39,-1079.85"/>
<polygon fill="black" stroke="black" points="80027.89,-1079.85 80024.39,-1069.85 80020.89,-1079.85 80027.89,-1079.85"/>
</g>
<!-- L8_S1_TP2_GPU10_attn_v -->
<g id="node850" class="node">
<title>L8_S1_TP2_GPU10_attn_v</title>
<polygon fill="none" stroke="black" points="76608,-1184.67 75670,-1184.67 75670,-1116.67 76608,-1116.67 76608,-1184.67"/>
<text text-anchor="middle" x="76139" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="76139" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="76139" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="76139" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L8_S1_TP2_GPU10_attn_v&#45;&gt;L8_S1_TP0_GPU8_mha_ar -->
<g id="edge2440" class="edge">
<title>L8_S1_TP2_GPU10_attn_v&#45;&gt;L8_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M75729.25,-1116.53C75729.25,-1115.56 75729.25,-1115 75729.25,-1115 75729.25,-1115 74849.62,-1115 74849.62,-1115 74849.62,-1115 74849.62,-1090.53 74849.62,-1090.53"/>
<polygon fill="black" stroke="black" points="74853.12,-1090.53 74849.62,-1080.53 74846.12,-1090.53 74853.12,-1090.53"/>
</g>
<!-- L8_S1_TP2_GPU10_attn_v&#45;&gt;L8_S1_TP1_GPU9_mha_ar -->
<g id="edge2476" class="edge">
<title>L8_S1_TP2_GPU10_attn_v&#45;&gt;L8_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M75788.49,-1116.51C75788.49,-1116.51 75788.49,-1087.65 75788.49,-1087.65"/>
<polygon fill="black" stroke="black" points="75791.99,-1087.65 75788.49,-1077.65 75784.99,-1087.65 75791.99,-1087.65"/>
</g>
<!-- L8_S1_TP2_GPU10_attn_v&#45;&gt;L8_S1_TP2_GPU10_mha_ar -->
<g id="edge2512" class="edge">
<title>L8_S1_TP2_GPU10_attn_v&#45;&gt;L8_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M76231.68,-1116.51C76231.68,-1116.51 76231.68,-1084.63 76231.68,-1084.63"/>
<polygon fill="black" stroke="black" points="76235.18,-1084.63 76231.68,-1074.63 76228.18,-1084.63 76235.18,-1084.63"/>
</g>
<!-- L8_S1_TP2_GPU10_attn_v&#45;&gt;L8_S1_TP3_GPU11_mha_ar -->
<g id="edge2548" class="edge">
<title>L8_S1_TP2_GPU10_attn_v&#45;&gt;L8_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M76294.4,-1116.55C76294.4,-1100.15 76294.4,-1084 76294.4,-1084 76294.4,-1084 77134.36,-1084 77134.36,-1084 77134.36,-1084 77134.36,-1083.63 77134.36,-1083.63"/>
<polygon fill="black" stroke="black" points="77137.86,-1090.3 77134.36,-1080.3 77130.86,-1090.3 77137.86,-1090.3"/>
</g>
<!-- L8_S1_TP2_GPU10_attn_v&#45;&gt;L8_S1_TP4_GPU12_mha_ar -->
<g id="edge2584" class="edge">
<title>L8_S1_TP2_GPU10_attn_v&#45;&gt;L8_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M76357.12,-1116.26C76357.12,-1109.27 76357.12,-1104 76357.12,-1104 76357.12,-1104 77796.42,-1104 77796.42,-1104 77796.42,-1104 77796.42,-1086.18 77796.42,-1086.18"/>
<polygon fill="black" stroke="black" points="77799.92,-1086.18 77796.42,-1076.18 77792.92,-1086.18 77799.92,-1086.18"/>
</g>
<!-- L8_S1_TP2_GPU10_attn_v&#45;&gt;L8_S1_TP5_GPU13_mha_ar -->
<g id="edge2620" class="edge">
<title>L8_S1_TP2_GPU10_attn_v&#45;&gt;L8_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M76419.84,-1116.26C76419.84,-1109.27 76419.84,-1104 76419.84,-1104 76419.84,-1104 78407.02,-1104 78407.02,-1104 78407.02,-1104 78407.02,-1067.96 78407.02,-1067.96"/>
<polygon fill="black" stroke="black" points="78410.52,-1067.96 78407.02,-1057.96 78403.52,-1067.96 78410.52,-1067.96"/>
</g>
<!-- L8_S1_TP2_GPU10_attn_v&#45;&gt;L8_S1_TP6_GPU14_mha_ar -->
<g id="edge2656" class="edge">
<title>L8_S1_TP2_GPU10_attn_v&#45;&gt;L8_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M76482.56,-1116.53C76482.56,-1108.89 76482.56,-1103 76482.56,-1103 76482.56,-1103 79272.3,-1103 79272.3,-1103 79272.3,-1103 79272.3,-1081.5 79272.3,-1081.5"/>
<polygon fill="black" stroke="black" points="79275.8,-1081.5 79272.3,-1071.5 79268.8,-1081.5 79275.8,-1081.5"/>
</g>
<!-- L8_S1_TP2_GPU10_attn_v&#45;&gt;L8_S1_TP7_GPU15_mha_ar -->
<g id="edge2692" class="edge">
<title>L8_S1_TP2_GPU10_attn_v&#45;&gt;L8_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M76545.28,-1116.53C76545.28,-1108.89 76545.28,-1103 76545.28,-1103 76545.28,-1103 80092.33,-1103 80092.33,-1103 80092.33,-1103 80092.33,-1085.57 80092.33,-1085.57"/>
<polygon fill="black" stroke="black" points="80095.83,-1085.57 80092.33,-1075.57 80088.83,-1085.57 80095.83,-1085.57"/>
</g>
<!-- L8_S1_TP3_GPU11_attn_v -->
<g id="node851" class="node">
<title>L8_S1_TP3_GPU11_attn_v</title>
<polygon fill="none" stroke="black" points="77564,-1184.67 76626,-1184.67 76626,-1116.67 77564,-1116.67 77564,-1184.67"/>
<text text-anchor="middle" x="77095" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="77095" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="77095" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="77095" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L8_S1_TP3_GPU11_attn_v&#45;&gt;L8_S1_TP0_GPU8_mha_ar -->
<g id="edge2441" class="edge">
<title>L8_S1_TP3_GPU11_attn_v&#45;&gt;L8_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M76659.69,-1116.53C76659.69,-1115.56 76659.69,-1115 76659.69,-1115 76659.69,-1115 74917.43,-1115 74917.43,-1115 74917.43,-1115 74917.43,-1090.53 74917.43,-1090.53"/>
<polygon fill="black" stroke="black" points="74920.93,-1090.53 74917.43,-1080.53 74913.93,-1090.53 74920.93,-1090.53"/>
</g>
<!-- L8_S1_TP3_GPU11_attn_v&#45;&gt;L8_S1_TP1_GPU9_mha_ar -->
<g id="edge2477" class="edge">
<title>L8_S1_TP3_GPU11_attn_v&#45;&gt;L8_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M76693.39,-1116.53C76693.39,-1115.56 76693.39,-1115 76693.39,-1115 76693.39,-1115 75847.74,-1115 75847.74,-1115 75847.74,-1115 75847.74,-1083.79 75847.74,-1083.79"/>
<polygon fill="black" stroke="black" points="75851.24,-1083.79 75847.74,-1073.79 75844.24,-1083.79 75851.24,-1083.79"/>
</g>
<!-- L8_S1_TP3_GPU11_attn_v&#45;&gt;L8_S1_TP2_GPU10_mha_ar -->
<g id="edge2513" class="edge">
<title>L8_S1_TP3_GPU11_attn_v&#45;&gt;L8_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M76727.08,-1116.51C76727.08,-1116.51 76727.08,-1070.31 76727.08,-1070.31"/>
<polygon fill="black" stroke="black" points="76730.58,-1070.31 76727.08,-1060.31 76723.58,-1070.31 76730.58,-1070.31"/>
</g>
<!-- L8_S1_TP3_GPU11_attn_v&#45;&gt;L8_S1_TP3_GPU11_mha_ar -->
<g id="edge2549" class="edge">
<title>L8_S1_TP3_GPU11_attn_v&#45;&gt;L8_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M77241.64,-1116.51C77241.64,-1116.51 77241.64,-1090.27 77241.64,-1090.27"/>
<polygon fill="black" stroke="black" points="77245.14,-1090.27 77241.64,-1080.27 77238.14,-1090.27 77245.14,-1090.27"/>
</g>
<!-- L8_S1_TP3_GPU11_attn_v&#45;&gt;L8_S1_TP4_GPU12_mha_ar -->
<g id="edge2585" class="edge">
<title>L8_S1_TP3_GPU11_attn_v&#45;&gt;L8_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M77564.2,-1139C77567.89,-1139 77569.86,-1139 77569.86,-1139 77569.86,-1139 77569.86,-1016 77569.86,-1016 77569.86,-1016 77594.56,-1016 77594.56,-1016"/>
<polygon fill="black" stroke="black" points="77594.56,-1019.5 77604.56,-1016 77594.56,-1012.5 77594.56,-1019.5"/>
</g>
<!-- L8_S1_TP3_GPU11_attn_v&#45;&gt;L8_S1_TP5_GPU13_mha_ar -->
<g id="edge2621" class="edge">
<title>L8_S1_TP3_GPU11_attn_v&#45;&gt;L8_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M77515,-1185.05C77515,-1186.28 77515,-1187 77515,-1187 77515,-1187 78526,-1187 78526,-1187 78526,-1187 78526,-1083.56 78526,-1083.56"/>
<polygon fill="black" stroke="black" points="78529.5,-1083.56 78526,-1073.56 78522.5,-1083.56 78529.5,-1083.56"/>
</g>
<!-- L8_S1_TP3_GPU11_attn_v&#45;&gt;L8_S1_TP6_GPU14_mha_ar -->
<g id="edge2657" class="edge">
<title>L8_S1_TP3_GPU11_attn_v&#45;&gt;L8_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M77466,-1185.03C77466,-1191.35 77466,-1196 77466,-1196 77466,-1196 79485,-1196 79485,-1196 79485,-1196 79485,-1090.73 79485,-1090.73"/>
<polygon fill="black" stroke="black" points="79488.5,-1090.73 79485,-1080.73 79481.5,-1090.73 79488.5,-1090.73"/>
</g>
<!-- L8_S1_TP3_GPU11_attn_v&#45;&gt;L8_S1_TP7_GPU15_mha_ar -->
<g id="edge2693" class="edge">
<title>L8_S1_TP3_GPU11_attn_v&#45;&gt;L8_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M77348.92,-1116.53C77348.92,-1108.89 77348.92,-1103 77348.92,-1103 77348.92,-1103 80160.26,-1103 80160.26,-1103 80160.26,-1103 80160.26,-1089.16 80160.26,-1089.16"/>
<polygon fill="black" stroke="black" points="80163.76,-1089.16 80160.26,-1079.16 80156.76,-1089.16 80163.76,-1089.16"/>
</g>
<!-- L8_S1_TP4_GPU12_attn_v -->
<g id="node852" class="node">
<title>L8_S1_TP4_GPU12_attn_v</title>
<polygon fill="none" stroke="black" points="78520,-1184.67 77582,-1184.67 77582,-1116.67 78520,-1116.67 78520,-1184.67"/>
<text text-anchor="middle" x="78051" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="78051" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="78051" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="78051" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L8_S1_TP4_GPU12_attn_v&#45;&gt;L8_S1_TP0_GPU8_mha_ar -->
<g id="edge2442" class="edge">
<title>L8_S1_TP4_GPU12_attn_v&#45;&gt;L8_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M77689.21,-1116.26C77689.21,-1109.27 77689.21,-1104 77689.21,-1104 77689.21,-1104 74985.24,-1104 74985.24,-1104 74985.24,-1104 74985.24,-1089.02 74985.24,-1089.02"/>
<polygon fill="black" stroke="black" points="74988.74,-1089.02 74985.24,-1079.02 74981.74,-1089.02 74988.74,-1089.02"/>
</g>
<!-- L8_S1_TP4_GPU12_attn_v&#45;&gt;L8_S1_TP1_GPU9_mha_ar -->
<g id="edge2478" class="edge">
<title>L8_S1_TP4_GPU12_attn_v&#45;&gt;L8_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M77658.33,-1184.93C77658.33,-1193.35 77658.33,-1200 77658.33,-1200 77658.33,-1200 75661,-1200 75661,-1200 75661,-1200 75661,-1091.01 75661,-1091.01"/>
<polygon fill="black" stroke="black" points="75664.5,-1091.01 75661,-1081.01 75657.5,-1091.01 75664.5,-1091.01"/>
</g>
<!-- L8_S1_TP4_GPU12_attn_v&#45;&gt;L8_S1_TP2_GPU10_mha_ar -->
<g id="edge2514" class="edge">
<title>L8_S1_TP4_GPU12_attn_v&#45;&gt;L8_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M77620.17,-1184.7C77620.17,-1188.48 77620.17,-1191 77620.17,-1191 77620.17,-1191 76621.5,-1191 76621.5,-1191 76621.5,-1191 76621.5,-1083.38 76621.5,-1083.38"/>
<polygon fill="black" stroke="black" points="76625,-1083.38 76621.5,-1073.38 76618,-1083.38 76625,-1083.38"/>
</g>
<!-- L8_S1_TP4_GPU12_attn_v&#45;&gt;L8_S1_TP3_GPU11_mha_ar -->
<g id="edge2550" class="edge">
<title>L8_S1_TP4_GPU12_attn_v&#45;&gt;L8_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M77581.76,-1161C77572.97,-1161 77568.09,-1161 77568.09,-1161 77568.09,-1161 77568.09,-1048 77568.09,-1048 77568.09,-1048 77553.73,-1048 77553.73,-1048"/>
<polygon fill="black" stroke="black" points="77553.73,-1044.5 77543.73,-1048 77553.73,-1051.5 77553.73,-1044.5"/>
</g>
<!-- L8_S1_TP4_GPU12_attn_v&#45;&gt;L8_S1_TP4_GPU12_mha_ar -->
<g id="edge2586" class="edge">
<title>L8_S1_TP4_GPU12_attn_v&#45;&gt;L8_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M77903.63,-1116.51C77903.63,-1116.51 77903.63,-1090.27 77903.63,-1090.27"/>
<polygon fill="black" stroke="black" points="77907.13,-1090.27 77903.63,-1080.27 77900.13,-1090.27 77907.13,-1090.27"/>
</g>
<!-- L8_S1_TP4_GPU12_attn_v&#45;&gt;L8_S1_TP5_GPU13_mha_ar -->
<g id="edge2622" class="edge">
<title>L8_S1_TP4_GPU12_attn_v&#45;&gt;L8_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M78435.26,-1116.51C78435.26,-1116.51 78435.26,-1073.04 78435.26,-1073.04"/>
<polygon fill="black" stroke="black" points="78438.76,-1073.04 78435.26,-1063.04 78431.76,-1073.04 78438.76,-1073.04"/>
</g>
<!-- L8_S1_TP4_GPU12_attn_v&#45;&gt;L8_S1_TP6_GPU14_mha_ar -->
<g id="edge2658" class="edge">
<title>L8_S1_TP4_GPU12_attn_v&#45;&gt;L8_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M78463.51,-1116.26C78463.51,-1109.27 78463.51,-1104 78463.51,-1104 78463.51,-1104 79323.23,-1104 79323.23,-1104 79323.23,-1104 79323.23,-1085.36 79323.23,-1085.36"/>
<polygon fill="black" stroke="black" points="79326.73,-1085.36 79323.23,-1075.36 79319.73,-1085.36 79326.73,-1085.36"/>
</g>
<!-- L8_S1_TP4_GPU12_attn_v&#45;&gt;L8_S1_TP7_GPU15_mha_ar -->
<g id="edge2694" class="edge">
<title>L8_S1_TP4_GPU12_attn_v&#45;&gt;L8_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M78491.75,-1116.26C78491.75,-1109.27 78491.75,-1104 78491.75,-1104 78491.75,-1104 80228.2,-1104 80228.2,-1104 80228.2,-1104 80228.2,-1090.62 80228.2,-1090.62"/>
<polygon fill="black" stroke="black" points="80231.7,-1090.62 80228.2,-1080.62 80224.7,-1090.62 80231.7,-1090.62"/>
</g>
<!-- L8_S1_TP5_GPU13_attn_v -->
<g id="node853" class="node">
<title>L8_S1_TP5_GPU13_attn_v</title>
<polygon fill="none" stroke="black" points="79476,-1184.67 78538,-1184.67 78538,-1116.67 79476,-1116.67 79476,-1184.67"/>
<text text-anchor="middle" x="79007" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="79007" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="79007" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="79007" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L8_S1_TP5_GPU13_attn_v&#45;&gt;L8_S1_TP0_GPU8_mha_ar -->
<g id="edge2443" class="edge">
<title>L8_S1_TP5_GPU13_attn_v&#45;&gt;L8_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M78608.43,-1116.26C78608.43,-1109.27 78608.43,-1104 78608.43,-1104 78608.43,-1104 75053.05,-1104 75053.05,-1104 75053.05,-1104 75053.05,-1085.36 75053.05,-1085.36"/>
<polygon fill="black" stroke="black" points="75056.55,-1085.36 75053.05,-1075.36 75049.55,-1085.36 75056.55,-1085.36"/>
</g>
<!-- L8_S1_TP5_GPU13_attn_v&#45;&gt;L8_S1_TP1_GPU9_mha_ar -->
<g id="edge2479" class="edge">
<title>L8_S1_TP5_GPU13_attn_v&#45;&gt;L8_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M78678.87,-1116.53C78678.87,-1108.89 78678.87,-1103 78678.87,-1103 78678.87,-1103 75906.98,-1103 75906.98,-1103 75906.98,-1103 75906.98,-1077.79 75906.98,-1077.79"/>
<polygon fill="black" stroke="black" points="75910.48,-1077.79 75906.98,-1067.79 75903.48,-1077.79 75910.48,-1077.79"/>
</g>
<!-- L8_S1_TP5_GPU13_attn_v&#45;&gt;L8_S1_TP2_GPU10_mha_ar -->
<g id="edge2515" class="edge">
<title>L8_S1_TP5_GPU13_attn_v&#45;&gt;L8_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M78615.25,-1184.74C78615.25,-1196.6 78615.25,-1207 78615.25,-1207 78615.25,-1207 76617,-1207 76617,-1207 76617,-1207 76617,-1083.48 76617,-1083.48"/>
<polygon fill="black" stroke="black" points="76620.5,-1083.48 76617,-1073.48 76613.5,-1083.48 76620.5,-1083.48"/>
</g>
<!-- L8_S1_TP5_GPU13_attn_v&#45;&gt;L8_S1_TP3_GPU11_mha_ar -->
<g id="edge2551" class="edge">
<title>L8_S1_TP5_GPU13_attn_v&#45;&gt;L8_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M78749.3,-1116.53C78749.3,-1108.89 78749.3,-1103 78749.3,-1103 78749.3,-1103 77456.2,-1103 77456.2,-1103 77456.2,-1103 77456.2,-1076.55 77456.2,-1076.55"/>
<polygon fill="black" stroke="black" points="77459.7,-1076.55 77456.2,-1066.55 77452.7,-1076.55 77459.7,-1076.55"/>
</g>
<!-- L8_S1_TP5_GPU13_attn_v&#45;&gt;L8_S1_TP4_GPU12_mha_ar -->
<g id="edge2587" class="edge">
<title>L8_S1_TP5_GPU13_attn_v&#45;&gt;L8_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M78819.74,-1116.43C78819.74,-1102.67 78819.74,-1090 78819.74,-1090 78819.74,-1090 78010.84,-1090 78010.84,-1090 78010.84,-1090 78010.84,-1089.03 78010.84,-1089.03"/>
<polygon fill="black" stroke="black" points="78014.34,-1090.26 78010.84,-1080.26 78007.34,-1090.26 78014.34,-1090.26"/>
</g>
<!-- L8_S1_TP5_GPU13_attn_v&#45;&gt;L8_S1_TP5_GPU13_mha_ar -->
<g id="edge2623" class="edge">
<title>L8_S1_TP5_GPU13_attn_v&#45;&gt;L8_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M78890.17,-1116.51C78890.17,-1116.51 78890.17,-1085.92 78890.17,-1085.92"/>
<polygon fill="black" stroke="black" points="78893.67,-1085.92 78890.17,-1075.92 78886.67,-1085.92 78893.67,-1085.92"/>
</g>
<!-- L8_S1_TP5_GPU13_attn_v&#45;&gt;L8_S1_TP6_GPU14_mha_ar -->
<g id="edge2659" class="edge">
<title>L8_S1_TP5_GPU13_attn_v&#45;&gt;L8_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M79374.15,-1116.51C79374.15,-1116.51 79374.15,-1088.52 79374.15,-1088.52"/>
<polygon fill="black" stroke="black" points="79377.65,-1088.52 79374.15,-1078.52 79370.65,-1088.52 79377.65,-1088.52"/>
</g>
<!-- L8_S1_TP5_GPU13_attn_v&#45;&gt;L8_S1_TP7_GPU15_mha_ar -->
<g id="edge2695" class="edge">
<title>L8_S1_TP5_GPU13_attn_v&#45;&gt;L8_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M79425.08,-1116.26C79425.08,-1109.27 79425.08,-1104 79425.08,-1104 79425.08,-1104 80296.13,-1104 80296.13,-1104 80296.13,-1104 80296.13,-1090.62 80296.13,-1090.62"/>
<polygon fill="black" stroke="black" points="80299.63,-1090.62 80296.13,-1080.62 80292.63,-1090.62 80299.63,-1090.62"/>
</g>
<!-- L8_S1_TP6_GPU14_attn_v -->
<g id="node854" class="node">
<title>L8_S1_TP6_GPU14_attn_v</title>
<polygon fill="none" stroke="black" points="80432,-1184.67 79494,-1184.67 79494,-1116.67 80432,-1116.67 80432,-1184.67"/>
<text text-anchor="middle" x="79963" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="79963" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="79963" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="79963" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L8_S1_TP6_GPU14_attn_v&#45;&gt;L8_S1_TP0_GPU8_mha_ar -->
<g id="edge2444" class="edge">
<title>L8_S1_TP6_GPU14_attn_v&#45;&gt;L8_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M79541.06,-1116.26C79541.06,-1109.27 79541.06,-1104 79541.06,-1104 79541.06,-1104 75120.86,-1104 75120.86,-1104 75120.86,-1104 75120.86,-1079.96 75120.86,-1079.96"/>
<polygon fill="black" stroke="black" points="75124.36,-1079.96 75120.86,-1069.96 75117.36,-1079.96 75124.36,-1079.96"/>
</g>
<!-- L8_S1_TP6_GPU14_attn_v&#45;&gt;L8_S1_TP1_GPU9_mha_ar -->
<g id="edge2480" class="edge">
<title>L8_S1_TP6_GPU14_attn_v&#45;&gt;L8_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M79588.12,-1116.53C79588.12,-1108.89 79588.12,-1103 79588.12,-1103 79588.12,-1103 75966.23,-1103 75966.23,-1103 75966.23,-1103 75966.23,-1068.8 75966.23,-1068.8"/>
<polygon fill="black" stroke="black" points="75969.73,-1068.8 75966.23,-1058.8 75962.73,-1068.8 75969.73,-1068.8"/>
</g>
<!-- L8_S1_TP6_GPU14_attn_v&#45;&gt;L8_S1_TP2_GPU10_mha_ar -->
<g id="edge2516" class="edge">
<title>L8_S1_TP6_GPU14_attn_v&#45;&gt;L8_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M79635.18,-1116.53C79635.18,-1108.89 79635.18,-1103 79635.18,-1103 79635.18,-1103 76760.78,-1103 76760.78,-1103 76760.78,-1103 76760.78,-1062.57 76760.78,-1062.57"/>
<polygon fill="black" stroke="black" points="76764.28,-1062.57 76760.78,-1052.57 76757.28,-1062.57 76764.28,-1062.57"/>
</g>
<!-- L8_S1_TP6_GPU14_attn_v&#45;&gt;L8_S1_TP3_GPU11_mha_ar -->
<g id="edge2552" class="edge">
<title>L8_S1_TP6_GPU14_attn_v&#45;&gt;L8_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M79879.5,-1116.57C79879.5,-1065.74 79879.5,-976 79879.5,-976 79879.5,-976 77534.02,-976 77534.02,-976 77534.02,-976 77534.02,-1003.74 77534.02,-1003.74"/>
<polygon fill="black" stroke="black" points="77530.52,-1003.74 77534.02,-1013.74 77537.52,-1003.74 77530.52,-1003.74"/>
</g>
<!-- L8_S1_TP6_GPU14_attn_v&#45;&gt;L8_S1_TP4_GPU12_mha_ar -->
<g id="edge2588" class="edge">
<title>L8_S1_TP6_GPU14_attn_v&#45;&gt;L8_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M79682.24,-1116.59C79682.24,-1102.32 79682.24,-1089 79682.24,-1089 79682.24,-1089 78118.05,-1089 78118.05,-1089 78118.05,-1089 78118.05,-1086.2 78118.05,-1086.2"/>
<polygon fill="black" stroke="black" points="78121.55,-1086.2 78118.05,-1076.2 78114.55,-1086.2 78121.55,-1086.2"/>
</g>
<!-- L8_S1_TP6_GPU14_attn_v&#45;&gt;L8_S1_TP5_GPU13_mha_ar -->
<g id="edge2624" class="edge">
<title>L8_S1_TP6_GPU14_attn_v&#45;&gt;L8_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M79729.3,-1116.59C79729.3,-1102.32 79729.3,-1089 79729.3,-1089 79729.3,-1089 78960.61,-1089 78960.61,-1089 78960.61,-1089 78960.61,-1080.21 78960.61,-1080.21"/>
<polygon fill="black" stroke="black" points="78964.11,-1080.21 78960.61,-1070.21 78957.11,-1080.21 78964.11,-1080.21"/>
</g>
<!-- L8_S1_TP6_GPU14_attn_v&#45;&gt;L8_S1_TP6_GPU14_mha_ar -->
<g id="edge2660" class="edge">
<title>L8_S1_TP6_GPU14_attn_v&#45;&gt;L8_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M79776.36,-1116.51C79776.36,-1116.51 79776.36,-1074.64 79776.36,-1074.64"/>
<polygon fill="black" stroke="black" points="79779.86,-1074.64 79776.36,-1064.64 79772.86,-1074.64 79779.86,-1074.64"/>
</g>
<!-- L8_S1_TP6_GPU14_attn_v&#45;&gt;L8_S1_TP7_GPU15_mha_ar -->
<g id="edge2696" class="edge">
<title>L8_S1_TP6_GPU14_attn_v&#45;&gt;L8_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M80364.07,-1116.51C80364.07,-1116.51 80364.07,-1088.96 80364.07,-1088.96"/>
<polygon fill="black" stroke="black" points="80367.57,-1088.96 80364.07,-1078.96 80360.57,-1088.96 80367.57,-1088.96"/>
</g>
<!-- L8_S1_TP7_GPU15_attn_v -->
<g id="node855" class="node">
<title>L8_S1_TP7_GPU15_attn_v</title>
<polygon fill="none" stroke="black" points="81388,-1184.67 80450,-1184.67 80450,-1116.67 81388,-1116.67 81388,-1184.67"/>
<text text-anchor="middle" x="80919" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="80919" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="80919" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="80919" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L8_S1_TP7_GPU15_attn_v&#45;&gt;L8_S1_TP0_GPU8_mha_ar -->
<g id="edge2445" class="edge">
<title>L8_S1_TP7_GPU15_attn_v&#45;&gt;L8_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M80481.58,-1116.53C80481.58,-1108.89 80481.58,-1103 80481.58,-1103 80481.58,-1103 75188.66,-1103 75188.66,-1103 75188.66,-1103 75188.66,-1070.41 75188.66,-1070.41"/>
<polygon fill="black" stroke="black" points="75192.16,-1070.41 75188.66,-1060.41 75185.16,-1070.41 75192.16,-1070.41"/>
</g>
<!-- L8_S1_TP7_GPU15_attn_v&#45;&gt;L8_S1_TP1_GPU9_mha_ar -->
<g id="edge2481" class="edge">
<title>L8_S1_TP7_GPU15_attn_v&#45;&gt;L8_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M80686.82,-1116.38C80686.82,-1065.26 80686.82,-975 80686.82,-975 80686.82,-975 75768.49,-975 75768.49,-975 75768.49,-975 75768.49,-976.93 75768.49,-976.93"/>
<polygon fill="black" stroke="black" points="75764.99,-976.93 75768.49,-986.93 75771.99,-976.93 75764.99,-976.93"/>
</g>
<!-- L8_S1_TP7_GPU15_attn_v&#45;&gt;L8_S1_TP2_GPU10_mha_ar -->
<g id="edge2517" class="edge">
<title>L8_S1_TP7_GPU15_attn_v&#45;&gt;L8_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M80591.25,-1184.93C80591.25,-1199.85 80591.25,-1214 80591.25,-1214 80591.25,-1214 76612.5,-1214 76612.5,-1214 76612.5,-1214 76612.5,-1084.2 76612.5,-1084.2"/>
<polygon fill="black" stroke="black" points="76616,-1084.2 76612.5,-1074.2 76609,-1084.2 76616,-1084.2"/>
</g>
<!-- L8_S1_TP7_GPU15_attn_v&#45;&gt;L8_S1_TP3_GPU11_mha_ar -->
<g id="edge2553" class="edge">
<title>L8_S1_TP7_GPU15_attn_v&#45;&gt;L8_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M80663.15,-1116.38C80663.15,-1065.26 80663.15,-975 80663.15,-975 80663.15,-975 77505.26,-975 77505.26,-975 77505.26,-975 77505.26,-996.82 77505.26,-996.82"/>
<polygon fill="black" stroke="black" points="77501.76,-996.82 77505.26,-1006.82 77508.76,-996.82 77501.76,-996.82"/>
</g>
<!-- L8_S1_TP7_GPU15_attn_v&#45;&gt;L8_S1_TP4_GPU12_mha_ar -->
<g id="edge2589" class="edge">
<title>L8_S1_TP7_GPU15_attn_v&#45;&gt;L8_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M80513.16,-1116.59C80513.16,-1102.32 80513.16,-1089 80513.16,-1089 80513.16,-1089 78225.26,-1089 78225.26,-1089 78225.26,-1089 78225.26,-1076.38 78225.26,-1076.38"/>
<polygon fill="black" stroke="black" points="78228.76,-1076.38 78225.26,-1066.38 78221.76,-1076.38 78228.76,-1076.38"/>
</g>
<!-- L8_S1_TP7_GPU15_attn_v&#45;&gt;L8_S1_TP5_GPU13_mha_ar -->
<g id="edge2625" class="edge">
<title>L8_S1_TP7_GPU15_attn_v&#45;&gt;L8_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M80544.74,-1116.59C80544.74,-1102.32 80544.74,-1089 80544.74,-1089 80544.74,-1089 79031.04,-1089 79031.04,-1089 79031.04,-1089 79031.04,-1070.79 79031.04,-1070.79"/>
<polygon fill="black" stroke="black" points="79034.54,-1070.79 79031.04,-1060.79 79027.54,-1070.79 79034.54,-1070.79"/>
</g>
<!-- L8_S1_TP7_GPU15_attn_v&#45;&gt;L8_S1_TP6_GPU14_mha_ar -->
<g id="edge2661" class="edge">
<title>L8_S1_TP7_GPU15_attn_v&#45;&gt;L8_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M80576.32,-1116.59C80576.32,-1102.32 80576.32,-1089 80576.32,-1089 80576.32,-1089 79823.41,-1089 79823.41,-1089 79823.41,-1089 79823.41,-1066.18 79823.41,-1066.18"/>
<polygon fill="black" stroke="black" points="79826.91,-1066.18 79823.41,-1056.18 79819.91,-1066.18 79826.91,-1066.18"/>
</g>
<!-- L8_S1_TP7_GPU15_attn_v&#45;&gt;L8_S1_TP7_GPU15_mha_ar -->
<g id="edge2697" class="edge">
<title>L8_S1_TP7_GPU15_attn_v&#45;&gt;L8_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M80607.89,-1116.51C80607.89,-1116.51 80607.89,-1061.95 80607.89,-1061.95"/>
<polygon fill="black" stroke="black" points="80611.39,-1061.95 80607.89,-1051.95 80604.39,-1061.95 80611.39,-1061.95"/>
</g>
<!-- L8_S1_TP0_GPU8_gate -->
<g id="node857" class="node">
<title>L8_S1_TP0_GPU8_gate</title>
<polygon fill="none" stroke="black" points="74328.56,-844.5 73486.15,-844.5 73269.44,-708.5 74111.85,-708.5 74328.56,-844.5"/>
<text text-anchor="middle" x="73799" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="73799" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="73799" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="73799" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L8_S1_TP0_GPU8_mha_res&#45;&gt;L8_S1_TP0_GPU8_gate -->
<g id="edge2447" class="edge">
<title>L8_S1_TP0_GPU8_mha_res&#45;&gt;L8_S1_TP0_GPU8_gate</title>
<path fill="none" stroke="black" d="M73799,-880.39C73799,-880.39 73799,-854.73 73799,-854.73"/>
<polygon fill="black" stroke="black" points="73802.5,-854.73 73799,-844.73 73795.5,-854.73 73802.5,-854.73"/>
</g>
<!-- L8_S1_TP0_GPU8_moe_res -->
<g id="node875" class="node">
<title>L8_S1_TP0_GPU8_moe_res</title>
<polygon fill="none" stroke="black" points="73909,-436.33 73089,-436.33 73089,-368.33 73909,-368.33 73909,-436.33"/>
<text text-anchor="middle" x="73499" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="73499" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="73499" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="73499" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP0_GPU8_mha_res&#45;&gt;L8_S1_TP0_GPU8_moe_res -->
<g id="edge2467" class="edge">
<title>L8_S1_TP0_GPU8_mha_res&#45;&gt;L8_S1_TP0_GPU8_moe_res</title>
<path fill="none" stroke="black" d="M73355.09,-914C73255.73,-914 73179.11,-914 73179.11,-914 73179.11,-914 73179.11,-446.7 73179.11,-446.7"/>
<polygon fill="black" stroke="black" points="73182.61,-446.7 73179.11,-436.7 73175.61,-446.7 73182.61,-446.7"/>
</g>
<!-- L8_S1_TP0_GPU8_expert0 -->
<g id="node858" class="node">
<title>L8_S1_TP0_GPU8_expert0</title>
<polygon fill="none" stroke="black" points="74293.5,-672.5 73844.5,-672.5 73844.5,-604.5 74293.5,-604.5 74293.5,-672.5"/>
<text text-anchor="middle" x="74069" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="74069" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="74069" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="74069" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L8_S1_TP0_GPU8_gate&#45;&gt;L8_S1_TP0_GPU8_expert0 -->
<g id="edge2448" class="edge">
<title>L8_S1_TP0_GPU8_gate&#45;&gt;L8_S1_TP0_GPU8_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M74069,-708.31C74069,-708.31 74069,-682.71 74069,-682.71"/>
<polygon fill="black" stroke="black" points="74072.5,-682.71 74069,-672.71 74065.5,-682.71 74072.5,-682.71"/>
</g>
<!-- L8_S1_TP0_GPU8_expert1 -->
<g id="node859" class="node">
<title>L8_S1_TP0_GPU8_expert1</title>
<polygon fill="none" stroke="black" points="74760.5,-672.5 74311.5,-672.5 74311.5,-604.5 74760.5,-604.5 74760.5,-672.5"/>
<text text-anchor="middle" x="74536" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="74536" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="74536" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="74536" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L8_S1_TP0_GPU8_gate&#45;&gt;L8_S1_TP0_GPU8_expert1 -->
<g id="edge2449" class="edge">
<title>L8_S1_TP0_GPU8_gate&#45;&gt;L8_S1_TP0_GPU8_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M74320.14,-776.4C74320.14,-776.4 74320.14,-682.74 74320.14,-682.74"/>
<polygon fill="black" stroke="black" points="74323.64,-682.74 74320.14,-672.74 74316.64,-682.74 74323.64,-682.74"/>
</g>
<!-- L8_S1_TP0_GPU8_moe_ar -->
<g id="node860" class="node">
<title>L8_S1_TP0_GPU8_moe_ar</title>
<ellipse fill="none" stroke="black" cx="75151" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="75151" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="75151" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="75151" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="75151" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP0_GPU8_expert0&#45;&gt;L8_S1_TP0_GPU8_moe_ar -->
<g id="edge2450" class="edge">
<title>L8_S1_TP0_GPU8_expert0&#45;&gt;L8_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M74273.44,-604.21C74273.44,-564.36 74273.44,-504 74273.44,-504 74273.44,-504 74826.35,-504 74826.35,-504"/>
<polygon fill="black" stroke="black" points="74826.35,-507.5 74836.35,-504 74826.35,-500.5 74826.35,-507.5"/>
</g>
<!-- L8_S1_TP1_GPU9_moe_ar -->
<g id="node884" class="node">
<title>L8_S1_TP1_GPU9_moe_ar</title>
<ellipse fill="none" stroke="black" cx="75838" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="75838" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="75838" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="75838" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="75838" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP0_GPU8_expert0&#45;&gt;L8_S1_TP1_GPU9_moe_ar -->
<g id="edge2486" class="edge">
<title>L8_S1_TP0_GPU8_expert0&#45;&gt;L8_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M74133.06,-604.36C74133.06,-590.64 74133.06,-578 74133.06,-578 74133.06,-578 75527.41,-578 75527.41,-578 75527.41,-578 75527.41,-548.32 75527.41,-548.32"/>
<polygon fill="black" stroke="black" points="75530.91,-548.32 75527.41,-538.32 75523.91,-548.32 75530.91,-548.32"/>
</g>
<!-- L8_S1_TP2_GPU10_moe_ar -->
<g id="node894" class="node">
<title>L8_S1_TP2_GPU10_moe_ar</title>
<ellipse fill="none" stroke="black" cx="76525" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="76525" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="76525" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="76525" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="76525" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP0_GPU8_expert0&#45;&gt;L8_S1_TP2_GPU10_moe_ar -->
<g id="edge2522" class="edge">
<title>L8_S1_TP0_GPU8_expert0&#45;&gt;L8_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M74153.11,-604.36C74153.11,-590.64 74153.11,-578 74153.11,-578 74153.11,-578 76245.28,-578 76245.28,-578 76245.28,-578 76245.28,-556.85 76245.28,-556.85"/>
<polygon fill="black" stroke="black" points="76248.78,-556.85 76245.28,-546.85 76241.78,-556.85 76248.78,-556.85"/>
</g>
<!-- L8_S1_TP3_GPU11_moe_ar -->
<g id="node904" class="node">
<title>L8_S1_TP3_GPU11_moe_ar</title>
<ellipse fill="none" stroke="black" cx="77212" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="77212" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="77212" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="77212" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="77212" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP0_GPU8_expert0&#45;&gt;L8_S1_TP3_GPU11_moe_ar -->
<g id="edge2558" class="edge">
<title>L8_S1_TP0_GPU8_expert0&#45;&gt;L8_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M74253.39,-604.2C74253.39,-555.2 74253.39,-471 74253.39,-471 74253.39,-471 77040.4,-471 77040.4,-471 77040.4,-471 77040.4,-471.77 77040.4,-471.77"/>
<polygon fill="black" stroke="black" points="77036.9,-468.72 77040.4,-478.72 77043.9,-468.72 77036.9,-468.72"/>
</g>
<!-- L8_S1_TP4_GPU12_moe_ar -->
<g id="node914" class="node">
<title>L8_S1_TP4_GPU12_moe_ar</title>
<ellipse fill="none" stroke="black" cx="77899" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="77899" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="77899" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="77899" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="77899" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP0_GPU8_expert0&#45;&gt;L8_S1_TP4_GPU12_moe_ar -->
<g id="edge2594" class="edge">
<title>L8_S1_TP0_GPU8_expert0&#45;&gt;L8_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M74233.33,-604.24C74233.33,-553.17 74233.33,-463 74233.33,-463 74233.33,-463 77602.38,-463 77602.38,-463 77602.38,-463 77602.38,-488.05 77602.38,-488.05"/>
<polygon fill="black" stroke="black" points="77598.88,-488.05 77602.38,-498.05 77605.88,-488.05 77598.88,-488.05"/>
</g>
<!-- L8_S1_TP5_GPU13_moe_ar -->
<g id="node924" class="node">
<title>L8_S1_TP5_GPU13_moe_ar</title>
<ellipse fill="none" stroke="black" cx="78586" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="78586" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="78586" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="78586" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="78586" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP0_GPU8_expert0&#45;&gt;L8_S1_TP5_GPU13_moe_ar -->
<g id="edge2630" class="edge">
<title>L8_S1_TP0_GPU8_expert0&#45;&gt;L8_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M74213.28,-604.24C74213.28,-553.17 74213.28,-463 74213.28,-463 74213.28,-463 78398.31,-463 78398.31,-463 78398.31,-463 78398.31,-470.54 78398.31,-470.54"/>
<polygon fill="black" stroke="black" points="78394.81,-470.54 78398.31,-480.54 78401.81,-470.54 78394.81,-470.54"/>
</g>
<!-- L8_S1_TP6_GPU14_moe_ar -->
<g id="node934" class="node">
<title>L8_S1_TP6_GPU14_moe_ar</title>
<ellipse fill="none" stroke="black" cx="79273" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="79273" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="79273" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="79273" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="79273" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP0_GPU8_expert0&#45;&gt;L8_S1_TP6_GPU14_moe_ar -->
<g id="edge2666" class="edge">
<title>L8_S1_TP0_GPU8_expert0&#45;&gt;L8_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M74193.22,-604.24C74193.22,-553.17 74193.22,-463 74193.22,-463 74193.22,-463 79333.38,-463 79333.38,-463 79333.38,-463 79333.38,-464 79333.38,-464"/>
<polygon fill="black" stroke="black" points="79329.88,-463 79333.38,-473 79336.88,-463 79329.88,-463"/>
</g>
<!-- L8_S1_TP7_GPU15_moe_ar -->
<g id="node944" class="node">
<title>L8_S1_TP7_GPU15_moe_ar</title>
<ellipse fill="none" stroke="black" cx="79960" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="79960" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="79960" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="79960" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="79960" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP0_GPU8_expert0&#45;&gt;L8_S1_TP7_GPU15_moe_ar -->
<g id="edge2702" class="edge">
<title>L8_S1_TP0_GPU8_expert0&#45;&gt;L8_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M74173.17,-604.23C74173.17,-591.01 74173.17,-579 74173.17,-579 74173.17,-579 79648.2,-579 79648.2,-579 79648.2,-579 79648.2,-547.99 79648.2,-547.99"/>
<polygon fill="black" stroke="black" points="79651.7,-547.99 79648.2,-537.99 79644.7,-547.99 79651.7,-547.99"/>
</g>
<!-- L8_S1_TP0_GPU8_expert1&#45;&gt;L8_S1_TP0_GPU8_moe_ar -->
<g id="edge2451" class="edge">
<title>L8_S1_TP0_GPU8_expert1&#45;&gt;L8_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M74710.61,-604.22C74710.61,-569.23 74710.61,-520 74710.61,-520 74710.61,-520 74806.38,-520 74806.38,-520"/>
<polygon fill="black" stroke="black" points="74806.38,-523.5 74816.38,-520 74806.38,-516.5 74806.38,-523.5"/>
</g>
<!-- L8_S1_TP0_GPU8_expert1&#45;&gt;L8_S1_TP1_GPU9_moe_ar -->
<g id="edge2487" class="edge">
<title>L8_S1_TP0_GPU8_expert1&#45;&gt;L8_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M74361.39,-604.36C74361.39,-590.64 74361.39,-578 74361.39,-578 74361.39,-578 75551.28,-578 75551.28,-578 75551.28,-578 75551.28,-555.51 75551.28,-555.51"/>
<polygon fill="black" stroke="black" points="75554.78,-555.51 75551.28,-545.51 75547.78,-555.51 75554.78,-555.51"/>
</g>
<!-- L8_S1_TP0_GPU8_expert1&#45;&gt;L8_S1_TP2_GPU10_moe_ar -->
<g id="edge2523" class="edge">
<title>L8_S1_TP0_GPU8_expert1&#45;&gt;L8_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M74411.28,-604.36C74411.28,-590.64 74411.28,-578 74411.28,-578 74411.28,-578 76300.03,-578 76300.03,-578 76300.03,-578 76300.03,-566.23 76300.03,-566.23"/>
<polygon fill="black" stroke="black" points="76303.53,-566.23 76300.03,-556.23 76296.53,-566.23 76303.53,-566.23"/>
</g>
<!-- L8_S1_TP0_GPU8_expert1&#45;&gt;L8_S1_TP3_GPU11_moe_ar -->
<g id="edge2559" class="edge">
<title>L8_S1_TP0_GPU8_expert1&#45;&gt;L8_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M74461.17,-604.36C74461.17,-590.64 74461.17,-578 74461.17,-578 74461.17,-578 76901.76,-578 76901.76,-578 76901.76,-578 76901.76,-548.64 76901.76,-548.64"/>
<polygon fill="black" stroke="black" points="76905.26,-548.64 76901.76,-538.64 76898.26,-548.64 76905.26,-548.64"/>
</g>
<!-- L8_S1_TP0_GPU8_expert1&#45;&gt;L8_S1_TP4_GPU12_moe_ar -->
<g id="edge2595" class="edge">
<title>L8_S1_TP0_GPU8_expert1&#45;&gt;L8_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M74660.72,-604.24C74660.72,-553.17 74660.72,-463 74660.72,-463 74660.72,-463 77589.77,-463 77589.77,-463 77589.77,-463 77589.77,-491.93 77589.77,-491.93"/>
<polygon fill="black" stroke="black" points="77586.27,-491.93 77589.77,-501.93 77593.27,-491.93 77586.27,-491.93"/>
</g>
<!-- L8_S1_TP0_GPU8_expert1&#45;&gt;L8_S1_TP5_GPU13_moe_ar -->
<g id="edge2631" class="edge">
<title>L8_S1_TP0_GPU8_expert1&#45;&gt;L8_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M74610.83,-604.24C74610.83,-553.17 74610.83,-463 74610.83,-463 74610.83,-463 78361.62,-463 78361.62,-463 78361.62,-463 78361.62,-474.71 78361.62,-474.71"/>
<polygon fill="black" stroke="black" points="78358.12,-474.71 78361.62,-484.71 78365.12,-474.71 78358.12,-474.71"/>
</g>
<!-- L8_S1_TP0_GPU8_expert1&#45;&gt;L8_S1_TP6_GPU14_moe_ar -->
<g id="edge2667" class="edge">
<title>L8_S1_TP0_GPU8_expert1&#45;&gt;L8_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M74560.94,-604.24C74560.94,-553.17 74560.94,-463 74560.94,-463 74560.94,-463 79201.77,-463 79201.77,-463 79201.77,-463 79201.77,-464.03 79201.77,-464.03"/>
<polygon fill="black" stroke="black" points="79198.27,-463.26 79201.77,-473.26 79205.27,-463.26 79198.27,-463.26"/>
</g>
<!-- L8_S1_TP0_GPU8_expert1&#45;&gt;L8_S1_TP7_GPU15_moe_ar -->
<g id="edge2703" class="edge">
<title>L8_S1_TP0_GPU8_expert1&#45;&gt;L8_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M74511.06,-604.23C74511.06,-591.01 74511.06,-579 74511.06,-579 74511.06,-579 79670.87,-579 79670.87,-579 79670.87,-579 79670.87,-554.92 79670.87,-554.92"/>
<polygon fill="black" stroke="black" points="79674.37,-554.92 79670.87,-544.92 79667.37,-554.92 79674.37,-554.92"/>
</g>
<!-- L8_S1_TP0_GPU8_moe_ar&#45;&gt;L8_S1_TP0_GPU8_moe_res -->
<g id="edge2466" class="edge">
<title>L8_S1_TP0_GPU8_moe_ar&#45;&gt;L8_S1_TP0_GPU8_moe_res</title>
<path fill="none" stroke="black" d="M74903.8,-488C74533.24,-488 73876.75,-488 73876.75,-488 73876.75,-488 73876.75,-446.68 73876.75,-446.68"/>
<polygon fill="black" stroke="black" points="73880.25,-446.68 73876.75,-436.68 73873.25,-446.68 73880.25,-446.68"/>
</g>
<!-- L8_S1_TP1_GPU9_expert0 -->
<g id="node861" class="node">
<title>L8_S1_TP1_GPU9_expert0</title>
<polygon fill="none" stroke="black" points="75227.5,-672.5 74778.5,-672.5 74778.5,-604.5 75227.5,-604.5 75227.5,-672.5"/>
<text text-anchor="middle" x="75003" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="75003" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="75003" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="75003" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L8_S1_TP1_GPU9_expert0&#45;&gt;L8_S1_TP0_GPU8_moe_ar -->
<g id="edge2452" class="edge">
<title>L8_S1_TP1_GPU9_expert0&#45;&gt;L8_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M74875.25,-604.34C74875.25,-604.34 74875.25,-557.76 74875.25,-557.76"/>
<polygon fill="black" stroke="black" points="74878.75,-557.76 74875.25,-547.76 74871.75,-557.76 74878.75,-557.76"/>
</g>
<!-- L8_S1_TP1_GPU9_expert0&#45;&gt;L8_S1_TP1_GPU9_moe_ar -->
<g id="edge2488" class="edge">
<title>L8_S1_TP1_GPU9_expert0&#45;&gt;L8_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M74933.96,-604.36C74933.96,-590.64 74933.96,-578 74933.96,-578 74933.96,-578 75575.15,-578 75575.15,-578 75575.15,-578 75575.15,-560.22 75575.15,-560.22"/>
<polygon fill="black" stroke="black" points="75578.65,-560.22 75575.15,-550.22 75571.65,-560.22 75578.65,-560.22"/>
</g>
<!-- L8_S1_TP1_GPU9_expert0&#45;&gt;L8_S1_TP2_GPU10_moe_ar -->
<g id="edge2524" class="edge">
<title>L8_S1_TP1_GPU9_expert0&#45;&gt;L8_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M74992.66,-604.36C74992.66,-590.64 74992.66,-578 74992.66,-578 74992.66,-578 76354.77,-578 76354.77,-578 76354.77,-578 76354.77,-571.96 76354.77,-571.96"/>
<polygon fill="black" stroke="black" points="76358.27,-571.96 76354.77,-561.96 76351.27,-571.96 76358.27,-571.96"/>
</g>
<!-- L8_S1_TP1_GPU9_expert0&#45;&gt;L8_S1_TP3_GPU11_moe_ar -->
<g id="edge2560" class="edge">
<title>L8_S1_TP1_GPU9_expert0&#45;&gt;L8_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M75051.37,-604.36C75051.37,-590.64 75051.37,-578 75051.37,-578 75051.37,-578 76925.97,-578 76925.97,-578 76925.97,-578 76925.97,-555.51 76925.97,-555.51"/>
<polygon fill="black" stroke="black" points="76929.47,-555.51 76925.97,-545.51 76922.47,-555.51 76929.47,-555.51"/>
</g>
<!-- L8_S1_TP1_GPU9_expert0&#45;&gt;L8_S1_TP4_GPU12_moe_ar -->
<g id="edge2596" class="edge">
<title>L8_S1_TP1_GPU9_expert0&#45;&gt;L8_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M74803.86,-604.44C74803.86,-553.66 74803.86,-464 74803.86,-464 74803.86,-464 77577.15,-464 77577.15,-464 77577.15,-464 77577.15,-497.33 77577.15,-497.33"/>
<polygon fill="black" stroke="black" points="77573.65,-497.33 77577.15,-507.33 77580.65,-497.33 77573.65,-497.33"/>
</g>
<!-- L8_S1_TP1_GPU9_expert0&#45;&gt;L8_S1_TP5_GPU13_moe_ar -->
<g id="edge2632" class="edge">
<title>L8_S1_TP1_GPU9_expert0&#45;&gt;L8_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M74791.18,-604.24C74791.18,-553.17 74791.18,-463 74791.18,-463 74791.18,-463 78324.92,-463 78324.92,-463 78324.92,-463 78324.92,-480.03 78324.92,-480.03"/>
<polygon fill="black" stroke="black" points="78321.42,-480.03 78324.92,-490.03 78328.42,-480.03 78321.42,-480.03"/>
</g>
<!-- L8_S1_TP1_GPU9_expert0&#45;&gt;L8_S1_TP6_GPU14_moe_ar -->
<g id="edge2668" class="edge">
<title>L8_S1_TP1_GPU9_expert0&#45;&gt;L8_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M75110.08,-604.23C75110.08,-591.01 75110.08,-579 75110.08,-579 75110.08,-579 79464.4,-579 79464.4,-579 79464.4,-579 79464.4,-570.14 79464.4,-570.14"/>
<polygon fill="black" stroke="black" points="79467.9,-570.14 79464.4,-560.14 79460.9,-570.14 79467.9,-570.14"/>
</g>
<!-- L8_S1_TP1_GPU9_expert0&#45;&gt;L8_S1_TP7_GPU15_moe_ar -->
<g id="edge2704" class="edge">
<title>L8_S1_TP1_GPU9_expert0&#45;&gt;L8_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M75168.79,-604.23C75168.79,-591.01 75168.79,-579 75168.79,-579 75168.79,-579 79693.53,-579 79693.53,-579 79693.53,-579 79693.53,-559.71 79693.53,-559.71"/>
<polygon fill="black" stroke="black" points="79697.03,-559.71 79693.53,-549.71 79690.03,-559.71 79697.03,-559.71"/>
</g>
<!-- L8_S1_TP1_GPU9_expert1 -->
<g id="node862" class="node">
<title>L8_S1_TP1_GPU9_expert1</title>
<polygon fill="none" stroke="black" points="75694.5,-672.5 75245.5,-672.5 75245.5,-604.5 75694.5,-604.5 75694.5,-672.5"/>
<text text-anchor="middle" x="75470" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="75470" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="75470" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="75470" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L8_S1_TP1_GPU9_expert1&#45;&gt;L8_S1_TP0_GPU8_moe_ar -->
<g id="edge2453" class="edge">
<title>L8_S1_TP1_GPU9_expert1&#45;&gt;L8_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M75275.5,-604.34C75275.5,-604.34 75275.5,-575.05 75275.5,-575.05"/>
<polygon fill="black" stroke="black" points="75279,-575.05 75275.5,-565.05 75272,-575.05 75279,-575.05"/>
</g>
<!-- L8_S1_TP1_GPU9_expert1&#45;&gt;L8_S1_TP1_GPU9_moe_ar -->
<g id="edge2489" class="edge">
<title>L8_S1_TP1_GPU9_expert1&#45;&gt;L8_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M75599.02,-604.34C75599.02,-604.34 75599.02,-564.09 75599.02,-564.09"/>
<polygon fill="black" stroke="black" points="75602.52,-564.09 75599.02,-554.09 75595.52,-564.09 75602.52,-564.09"/>
</g>
<!-- L8_S1_TP1_GPU9_expert1&#45;&gt;L8_S1_TP2_GPU10_moe_ar -->
<g id="edge2525" class="edge">
<title>L8_S1_TP1_GPU9_expert1&#45;&gt;L8_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M75622.89,-604.36C75622.89,-590.64 75622.89,-578 75622.89,-578 75622.89,-578 76409.52,-578 76409.52,-578 76409.52,-578 76409.52,-575.79 76409.52,-575.79"/>
<polygon fill="black" stroke="black" points="76413.02,-575.79 76409.52,-565.79 76406.02,-575.79 76413.02,-575.79"/>
</g>
<!-- L8_S1_TP1_GPU9_expert1&#45;&gt;L8_S1_TP3_GPU11_moe_ar -->
<g id="edge2561" class="edge">
<title>L8_S1_TP1_GPU9_expert1&#45;&gt;L8_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M75646.76,-604.36C75646.76,-590.64 75646.76,-578 75646.76,-578 75646.76,-578 76950.19,-578 76950.19,-578 76950.19,-578 76950.19,-560.56 76950.19,-560.56"/>
<polygon fill="black" stroke="black" points="76953.69,-560.56 76950.19,-550.56 76946.69,-560.56 76953.69,-560.56"/>
</g>
<!-- L8_S1_TP1_GPU9_expert1&#45;&gt;L8_S1_TP4_GPU12_moe_ar -->
<g id="edge2597" class="edge">
<title>L8_S1_TP1_GPU9_expert1&#45;&gt;L8_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M75670.63,-604.23C75670.63,-591.01 75670.63,-579 75670.63,-579 75670.63,-579 77636.62,-579 77636.62,-579 77636.62,-579 77636.62,-560.39 77636.62,-560.39"/>
<polygon fill="black" stroke="black" points="77640.13,-560.39 77636.62,-550.39 77633.13,-560.39 77640.13,-560.39"/>
</g>
<!-- L8_S1_TP1_GPU9_expert1&#45;&gt;L8_S1_TP5_GPU13_moe_ar -->
<g id="edge2633" class="edge">
<title>L8_S1_TP1_GPU9_expert1&#45;&gt;L8_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M75497.51,-604.4C75497.51,-555.17 75497.51,-470 75497.51,-470 75497.51,-470 78288.23,-470 78288.23,-470 78288.23,-470 78288.23,-488.45 78288.23,-488.45"/>
<polygon fill="black" stroke="black" points="78284.73,-488.45 78288.23,-498.45 78291.73,-488.45 78284.73,-488.45"/>
</g>
<!-- L8_S1_TP1_GPU9_expert1&#45;&gt;L8_S1_TP6_GPU14_moe_ar -->
<g id="edge2669" class="edge">
<title>L8_S1_TP1_GPU9_expert1&#45;&gt;L8_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M75491.49,-604.4C75491.49,-555.17 75491.49,-470 75491.49,-470 75491.49,-470 79070.15,-470 79070.15,-470 79070.15,-470 79070.15,-471.95 79070.15,-471.95"/>
<polygon fill="black" stroke="black" points="79066.65,-471.95 79070.15,-481.95 79073.65,-471.95 79066.65,-471.95"/>
</g>
<!-- L8_S1_TP1_GPU9_expert1&#45;&gt;L8_S1_TP7_GPU15_moe_ar -->
<g id="edge2705" class="edge">
<title>L8_S1_TP1_GPU9_expert1&#45;&gt;L8_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M75305.49,-604.23C75305.49,-591.01 75305.49,-579 75305.49,-579 75305.49,-579 79738.86,-579 79738.86,-579 79738.86,-579 79738.86,-566.52 79738.86,-566.52"/>
<polygon fill="black" stroke="black" points="79742.36,-566.52 79738.86,-556.52 79735.36,-566.52 79742.36,-566.52"/>
</g>
<!-- L8_S1_TP2_GPU10_expert0 -->
<g id="node863" class="node">
<title>L8_S1_TP2_GPU10_expert0</title>
<polygon fill="none" stroke="black" points="76161.5,-672.5 75712.5,-672.5 75712.5,-604.5 76161.5,-604.5 76161.5,-672.5"/>
<text text-anchor="middle" x="75937" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="75937" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="75937" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="75937" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L8_S1_TP2_GPU10_expert0&#45;&gt;L8_S1_TP0_GPU8_moe_ar -->
<g id="edge2454" class="edge">
<title>L8_S1_TP2_GPU10_expert0&#45;&gt;L8_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M75776.64,-604.39C75776.64,-604.13 75776.64,-604 75776.64,-604 75776.64,-604 75335.49,-604 75335.49,-604 75335.49,-604 75335.49,-570.74 75335.49,-570.74"/>
<polygon fill="black" stroke="black" points="75338.99,-570.74 75335.49,-560.74 75331.99,-570.74 75338.99,-570.74"/>
</g>
<!-- L8_S1_TP2_GPU10_expert0&#45;&gt;L8_S1_TP1_GPU9_moe_ar -->
<g id="edge2490" class="edge">
<title>L8_S1_TP2_GPU10_expert0&#45;&gt;L8_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M75840.79,-604.34C75840.79,-604.34 75840.79,-578.55 75840.79,-578.55"/>
<polygon fill="black" stroke="black" points="75844.29,-578.55 75840.79,-568.55 75837.29,-578.55 75844.29,-578.55"/>
</g>
<!-- L8_S1_TP2_GPU10_expert0&#45;&gt;L8_S1_TP2_GPU10_moe_ar -->
<g id="edge2526" class="edge">
<title>L8_S1_TP2_GPU10_expert0&#45;&gt;L8_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M76161.77,-649C76171.44,-649 76177.15,-649 76177.15,-649 76177.15,-649 76177.15,-520 76177.15,-520 76177.15,-520 76180.37,-520 76180.37,-520"/>
<polygon fill="black" stroke="black" points="76180.37,-523.5 76190.37,-520 76180.37,-516.5 76180.37,-523.5"/>
</g>
<!-- L8_S1_TP2_GPU10_expert0&#45;&gt;L8_S1_TP3_GPU11_moe_ar -->
<g id="edge2562" class="edge">
<title>L8_S1_TP2_GPU10_expert0&#45;&gt;L8_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M76097.36,-604.36C76097.36,-590.64 76097.36,-578 76097.36,-578 76097.36,-578 76974.41,-578 76974.41,-578 76974.41,-578 76974.41,-564.58 76974.41,-564.58"/>
<polygon fill="black" stroke="black" points="76977.91,-564.58 76974.41,-554.58 76970.91,-564.58 76977.91,-564.58"/>
</g>
<!-- L8_S1_TP2_GPU10_expert0&#45;&gt;L8_S1_TP4_GPU12_moe_ar -->
<g id="edge2598" class="edge">
<title>L8_S1_TP2_GPU10_expert0&#45;&gt;L8_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M76086.67,-672.67C76086.67,-676.47 76086.67,-679 76086.67,-679 76086.67,-679 77575.18,-679 77575.18,-679 77575.18,-679 77575.18,-542.6 77575.18,-542.6"/>
<polygon fill="black" stroke="black" points="77578.68,-542.6 77575.18,-532.6 77571.68,-542.6 77578.68,-542.6"/>
</g>
<!-- L8_S1_TP2_GPU10_expert0&#45;&gt;L8_S1_TP5_GPU13_moe_ar -->
<g id="edge2634" class="edge">
<title>L8_S1_TP2_GPU10_expert0&#45;&gt;L8_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M76011.83,-672.77C76011.83,-677.07 76011.83,-680 76011.83,-680 76011.83,-680 78505.5,-680 78505.5,-680 78505.5,-680 78505.5,-577.43 78505.5,-577.43"/>
<polygon fill="black" stroke="black" points="78509,-577.43 78505.5,-567.43 78502,-577.43 78509,-577.43"/>
</g>
<!-- L8_S1_TP2_GPU10_expert0&#45;&gt;L8_S1_TP6_GPU14_moe_ar -->
<g id="edge2670" class="edge">
<title>L8_S1_TP2_GPU10_expert0&#45;&gt;L8_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M75937,-672.77C75937,-677.07 75937,-680 75937,-680 75937,-680 78978.5,-680 78978.5,-680 78978.5,-680 78978.5,-553.28 78978.5,-553.28"/>
<polygon fill="black" stroke="black" points="78982,-553.28 78978.5,-543.28 78975,-553.28 78982,-553.28"/>
</g>
<!-- L8_S1_TP2_GPU10_expert0&#45;&gt;L8_S1_TP7_GPU15_moe_ar -->
<g id="edge2706" class="edge">
<title>L8_S1_TP2_GPU10_expert0&#45;&gt;L8_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M75862.17,-672.75C75862.17,-689.87 75862.17,-707 75862.17,-707 75862.17,-707 79911,-707 79911,-707 79911,-707 79911,-577.98 79911,-577.98"/>
<polygon fill="black" stroke="black" points="79914.5,-577.98 79911,-567.98 79907.5,-577.98 79914.5,-577.98"/>
</g>
<!-- L8_S1_TP2_GPU10_expert1 -->
<g id="node864" class="node">
<title>L8_S1_TP2_GPU10_expert1</title>
<polygon fill="none" stroke="black" points="76628.5,-672.5 76179.5,-672.5 76179.5,-604.5 76628.5,-604.5 76628.5,-672.5"/>
<text text-anchor="middle" x="76404" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="76404" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="76404" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="76404" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L8_S1_TP2_GPU10_expert1&#45;&gt;L8_S1_TP0_GPU8_moe_ar -->
<g id="edge2455" class="edge">
<title>L8_S1_TP2_GPU10_expert1&#45;&gt;L8_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M76185.02,-604.39C76185.02,-604.13 76185.02,-604 76185.02,-604 76185.02,-604 75365.48,-604 75365.48,-604 75365.48,-604 75365.48,-567.32 75365.48,-567.32"/>
<polygon fill="black" stroke="black" points="75368.98,-567.32 75365.48,-557.32 75361.98,-567.32 75368.98,-567.32"/>
</g>
<!-- L8_S1_TP2_GPU10_expert1&#45;&gt;L8_S1_TP1_GPU9_moe_ar -->
<g id="edge2491" class="edge">
<title>L8_S1_TP2_GPU10_expert1&#45;&gt;L8_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M76179.46,-627C76172.24,-627 76168.08,-627 76168.08,-627 76168.08,-627 76168.08,-538.43 76168.08,-538.43"/>
<polygon fill="black" stroke="black" points="76171.58,-538.43 76168.08,-528.43 76164.58,-538.43 76171.58,-538.43"/>
</g>
<!-- L8_S1_TP2_GPU10_expert1&#45;&gt;L8_S1_TP2_GPU10_moe_ar -->
<g id="edge2527" class="edge">
<title>L8_S1_TP2_GPU10_expert1&#45;&gt;L8_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M76464.26,-604.34C76464.26,-604.34 76464.26,-578.11 76464.26,-578.11"/>
<polygon fill="black" stroke="black" points="76467.76,-578.11 76464.26,-568.11 76460.76,-578.11 76467.76,-578.11"/>
</g>
<!-- L8_S1_TP2_GPU10_expert1&#45;&gt;L8_S1_TP3_GPU11_moe_ar -->
<g id="edge2563" class="edge">
<title>L8_S1_TP2_GPU10_expert1&#45;&gt;L8_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M76519.01,-604.36C76519.01,-590.64 76519.01,-578 76519.01,-578 76519.01,-578 76998.63,-578 76998.63,-578 76998.63,-578 76998.63,-567.54 76998.63,-567.54"/>
<polygon fill="black" stroke="black" points="77002.13,-567.54 76998.63,-557.54 76995.13,-567.54 77002.13,-567.54"/>
</g>
<!-- L8_S1_TP2_GPU10_expert1&#45;&gt;L8_S1_TP4_GPU12_moe_ar -->
<g id="edge2599" class="edge">
<title>L8_S1_TP2_GPU10_expert1&#45;&gt;L8_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M76597.18,-672.67C76597.18,-676.47 76597.18,-679 76597.18,-679 76597.18,-679 77573.41,-679 77573.41,-679 77573.41,-679 77573.41,-541.57 77573.41,-541.57"/>
<polygon fill="black" stroke="black" points="77576.91,-541.57 77573.41,-531.57 77569.91,-541.57 77576.91,-541.57"/>
</g>
<!-- L8_S1_TP2_GPU10_expert1&#45;&gt;L8_S1_TP5_GPU13_moe_ar -->
<g id="edge2635" class="edge">
<title>L8_S1_TP2_GPU10_expert1&#45;&gt;L8_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M76573.75,-604.23C76573.75,-591.01 76573.75,-579 76573.75,-579 76573.75,-579 78282.16,-579 78282.16,-579 78282.16,-579 78282.16,-550.58 78282.16,-550.58"/>
<polygon fill="black" stroke="black" points="78285.66,-550.58 78282.16,-540.58 78278.66,-550.58 78285.66,-550.58"/>
</g>
<!-- L8_S1_TP2_GPU10_expert1&#45;&gt;L8_S1_TP6_GPU14_moe_ar -->
<g id="edge2671" class="edge">
<title>L8_S1_TP2_GPU10_expert1&#45;&gt;L8_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M76565.86,-672.67C76565.86,-676.47 76565.86,-679 76565.86,-679 76565.86,-679 78975.5,-679 78975.5,-679 78975.5,-679 78975.5,-552.47 78975.5,-552.47"/>
<polygon fill="black" stroke="black" points="78979,-552.47 78975.5,-542.47 78972,-552.47 78979,-552.47"/>
</g>
<!-- L8_S1_TP2_GPU10_expert1&#45;&gt;L8_S1_TP7_GPU15_moe_ar -->
<g id="edge2707" class="edge">
<title>L8_S1_TP2_GPU10_expert1&#45;&gt;L8_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M76534.54,-672.53C76534.54,-688.89 76534.54,-705 76534.54,-705 76534.54,-705 79906.5,-705 79906.5,-705 79906.5,-705 79906.5,-577.95 79906.5,-577.95"/>
<polygon fill="black" stroke="black" points="79910,-577.95 79906.5,-567.95 79903,-577.95 79910,-577.95"/>
</g>
<!-- L8_S1_TP3_GPU11_expert0 -->
<g id="node865" class="node">
<title>L8_S1_TP3_GPU11_expert0</title>
<polygon fill="none" stroke="black" points="77095.5,-672.5 76646.5,-672.5 76646.5,-604.5 77095.5,-604.5 77095.5,-672.5"/>
<text text-anchor="middle" x="76871" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="76871" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="76871" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="76871" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L8_S1_TP3_GPU11_expert0&#45;&gt;L8_S1_TP0_GPU8_moe_ar -->
<g id="edge2456" class="edge">
<title>L8_S1_TP3_GPU11_expert0&#45;&gt;L8_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M76670.16,-604.39C76670.16,-604.13 76670.16,-604 76670.16,-604 76670.16,-604 75395.48,-604 75395.48,-604 75395.48,-604 75395.48,-563.45 75395.48,-563.45"/>
<polygon fill="black" stroke="black" points="75398.98,-563.45 75395.48,-553.45 75391.98,-563.45 75398.98,-563.45"/>
</g>
<!-- L8_S1_TP3_GPU11_expert0&#45;&gt;L8_S1_TP1_GPU9_moe_ar -->
<g id="edge2492" class="edge">
<title>L8_S1_TP3_GPU11_expert0&#45;&gt;L8_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M76693.82,-604.39C76693.82,-604.13 76693.82,-604 76693.82,-604 76693.82,-604 76170.27,-604 76170.27,-604 76170.27,-604 76170.27,-536.16 76170.27,-536.16"/>
<polygon fill="black" stroke="black" points="76173.77,-536.16 76170.27,-526.16 76166.77,-536.16 76173.77,-536.16"/>
</g>
<!-- L8_S1_TP3_GPU11_expert0&#45;&gt;L8_S1_TP2_GPU10_moe_ar -->
<g id="edge2528" class="edge">
<title>L8_S1_TP3_GPU11_expert0&#45;&gt;L8_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M76717.49,-604.34C76717.49,-604.34 76717.49,-569.91 76717.49,-569.91"/>
<polygon fill="black" stroke="black" points="76720.99,-569.91 76717.49,-559.91 76713.99,-569.91 76720.99,-569.91"/>
</g>
<!-- L8_S1_TP3_GPU11_expert0&#45;&gt;L8_S1_TP3_GPU11_moe_ar -->
<g id="edge2564" class="edge">
<title>L8_S1_TP3_GPU11_expert0&#45;&gt;L8_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M77022.85,-604.34C77022.85,-604.34 77022.85,-570.33 77022.85,-570.33"/>
<polygon fill="black" stroke="black" points="77026.35,-570.33 77022.85,-560.33 77019.35,-570.33 77026.35,-570.33"/>
</g>
<!-- L8_S1_TP3_GPU11_expert0&#45;&gt;L8_S1_TP4_GPU12_moe_ar -->
<g id="edge2600" class="edge">
<title>L8_S1_TP3_GPU11_expert0&#45;&gt;L8_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M77047.06,-604.36C77047.06,-590.64 77047.06,-578 77047.06,-578 77047.06,-578 77566.31,-578 77566.31,-578 77566.31,-578 77566.31,-535.73 77566.31,-535.73"/>
<polygon fill="black" stroke="black" points="77569.81,-535.73 77566.31,-525.73 77562.81,-535.73 77569.81,-535.73"/>
</g>
<!-- L8_S1_TP3_GPU11_expert0&#45;&gt;L8_S1_TP5_GPU13_moe_ar -->
<g id="edge2636" class="edge">
<title>L8_S1_TP3_GPU11_expert0&#45;&gt;L8_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M77071.28,-604.23C77071.28,-591.01 77071.28,-579 77071.28,-579 77071.28,-579 78312.78,-579 78312.78,-579 78312.78,-579 78312.78,-558.34 78312.78,-558.34"/>
<polygon fill="black" stroke="black" points="78316.28,-558.34 78312.78,-548.34 78309.28,-558.34 78316.28,-558.34"/>
</g>
<!-- L8_S1_TP3_GPU11_expert0&#45;&gt;L8_S1_TP6_GPU14_moe_ar -->
<g id="edge2672" class="edge">
<title>L8_S1_TP3_GPU11_expert0&#45;&gt;L8_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M76983.25,-672.67C76983.25,-676.47 76983.25,-679 76983.25,-679 76983.25,-679 78972.5,-679 78972.5,-679 78972.5,-679 78972.5,-551.8 78972.5,-551.8"/>
<polygon fill="black" stroke="black" points="78976,-551.8 78972.5,-541.8 78969,-551.8 78976,-551.8"/>
</g>
<!-- L8_S1_TP3_GPU11_expert0&#45;&gt;L8_S1_TP7_GPU15_moe_ar -->
<g id="edge2708" class="edge">
<title>L8_S1_TP3_GPU11_expert0&#45;&gt;L8_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M76871,-672.64C76871,-688.11 76871,-703 76871,-703 76871,-703 79902,-703 79902,-703 79902,-703 79902,-577.91 79902,-577.91"/>
<polygon fill="black" stroke="black" points="79905.5,-577.91 79902,-567.91 79898.5,-577.91 79905.5,-577.91"/>
</g>
<!-- L8_S1_TP3_GPU11_expert1 -->
<g id="node866" class="node">
<title>L8_S1_TP3_GPU11_expert1</title>
<polygon fill="none" stroke="black" points="77562.5,-672.5 77113.5,-672.5 77113.5,-604.5 77562.5,-604.5 77562.5,-672.5"/>
<text text-anchor="middle" x="77338" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="77338" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="77338" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="77338" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L8_S1_TP3_GPU11_expert1&#45;&gt;L8_S1_TP0_GPU8_moe_ar -->
<g id="edge2457" class="edge">
<title>L8_S1_TP3_GPU11_expert1&#45;&gt;L8_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M77156.8,-604.39C77156.8,-604.13 77156.8,-604 77156.8,-604 77156.8,-604 75425.47,-604 75425.47,-604 75425.47,-604 75425.47,-558.25 75425.47,-558.25"/>
<polygon fill="black" stroke="black" points="75428.97,-558.25 75425.47,-548.25 75421.97,-558.25 75428.97,-558.25"/>
</g>
<!-- L8_S1_TP3_GPU11_expert1&#45;&gt;L8_S1_TP1_GPU9_moe_ar -->
<g id="edge2493" class="edge">
<title>L8_S1_TP3_GPU11_expert1&#45;&gt;L8_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M77225.75,-672.67C77225.75,-676.47 77225.75,-679 77225.75,-679 77225.75,-679 76165.88,-679 76165.88,-679 76165.88,-679 76165.88,-540.34 76165.88,-540.34"/>
<polygon fill="black" stroke="black" points="76169.38,-540.34 76165.88,-530.34 76162.38,-540.34 76169.38,-540.34"/>
</g>
<!-- L8_S1_TP3_GPU11_expert1&#45;&gt;L8_S1_TP2_GPU10_moe_ar -->
<g id="edge2529" class="edge">
<title>L8_S1_TP3_GPU11_expert1&#45;&gt;L8_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M77200.09,-604.39C77200.09,-604.13 77200.09,-604 77200.09,-604 77200.09,-604 76741.15,-604 76741.15,-604 76741.15,-604 76741.15,-567.32 76741.15,-567.32"/>
<polygon fill="black" stroke="black" points="76744.65,-567.32 76741.15,-557.32 76737.65,-567.32 76744.65,-567.32"/>
</g>
<!-- L8_S1_TP3_GPU11_expert1&#45;&gt;L8_S1_TP3_GPU11_moe_ar -->
<g id="edge2565" class="edge">
<title>L8_S1_TP3_GPU11_expert1&#45;&gt;L8_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M77243.39,-604.34C77243.39,-604.34 77243.39,-578.55 77243.39,-578.55"/>
<polygon fill="black" stroke="black" points="77246.89,-578.55 77243.39,-568.55 77239.89,-578.55 77246.89,-578.55"/>
</g>
<!-- L8_S1_TP3_GPU11_expert1&#45;&gt;L8_S1_TP4_GPU12_moe_ar -->
<g id="edge2601" class="edge">
<title>L8_S1_TP3_GPU11_expert1&#45;&gt;L8_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M77562.76,-638C77568.42,-638 77571.63,-638 77571.63,-638 77571.63,-638 77571.63,-540.44 77571.63,-540.44"/>
<polygon fill="black" stroke="black" points="77575.13,-540.44 77571.63,-530.44 77568.13,-540.44 77575.13,-540.44"/>
</g>
<!-- L8_S1_TP3_GPU11_expert1&#45;&gt;L8_S1_TP5_GPU13_moe_ar -->
<g id="edge2637" class="edge">
<title>L8_S1_TP3_GPU11_expert1&#45;&gt;L8_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M77550.47,-604.47C77550.47,-591.6 77550.47,-580 77550.47,-580 77550.47,-580 78343.4,-580 78343.4,-580 78343.4,-580 78343.4,-563.69 78343.4,-563.69"/>
<polygon fill="black" stroke="black" points="78346.9,-563.69 78343.4,-553.69 78339.9,-563.69 78346.9,-563.69"/>
</g>
<!-- L8_S1_TP3_GPU11_expert1&#45;&gt;L8_S1_TP6_GPU14_moe_ar -->
<g id="edge2673" class="edge">
<title>L8_S1_TP3_GPU11_expert1&#45;&gt;L8_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M77450.25,-672.67C77450.25,-676.47 77450.25,-679 77450.25,-679 77450.25,-679 78969.5,-679 78969.5,-679 78969.5,-679 78969.5,-550.82 78969.5,-550.82"/>
<polygon fill="black" stroke="black" points="78973,-550.82 78969.5,-540.82 78966,-550.82 78973,-550.82"/>
</g>
<!-- L8_S1_TP3_GPU11_expert1&#45;&gt;L8_S1_TP7_GPU15_moe_ar -->
<g id="edge2709" class="edge">
<title>L8_S1_TP3_GPU11_expert1&#45;&gt;L8_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M77286.68,-604.23C77286.68,-591.01 77286.68,-579 77286.68,-579 77286.68,-579 79761.52,-579 79761.52,-579 79761.52,-579 79761.52,-569.17 79761.52,-569.17"/>
<polygon fill="black" stroke="black" points="79765.02,-569.17 79761.52,-559.17 79758.02,-569.17 79765.02,-569.17"/>
</g>
<!-- L8_S1_TP4_GPU12_expert0 -->
<g id="node867" class="node">
<title>L8_S1_TP4_GPU12_expert0</title>
<polygon fill="none" stroke="black" points="78029.5,-672.5 77580.5,-672.5 77580.5,-604.5 78029.5,-604.5 78029.5,-672.5"/>
<text text-anchor="middle" x="77805" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="77805" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="77805" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="77805" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L8_S1_TP4_GPU12_expert0&#45;&gt;L8_S1_TP0_GPU8_moe_ar -->
<g id="edge2458" class="edge">
<title>L8_S1_TP4_GPU12_expert0&#45;&gt;L8_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M77805.36,-672.85C77805.36,-686.93 77805.36,-700 77805.36,-700 77805.36,-700 75241.9,-700 75241.9,-700 75241.9,-700 75241.9,-577.13 75241.9,-577.13"/>
<polygon fill="black" stroke="black" points="75245.4,-577.13 75241.9,-567.13 75238.4,-577.13 75245.4,-577.13"/>
</g>
<!-- L8_S1_TP4_GPU12_expert0&#45;&gt;L8_S1_TP1_GPU9_moe_ar -->
<g id="edge2494" class="edge">
<title>L8_S1_TP4_GPU12_expert0&#45;&gt;L8_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M77693.29,-672.67C77693.29,-676.47 77693.29,-679 77693.29,-679 77693.29,-679 76163.69,-679 76163.69,-679 76163.69,-679 76163.69,-541.57 76163.69,-541.57"/>
<polygon fill="black" stroke="black" points="76167.19,-541.57 76163.69,-531.57 76160.19,-541.57 76167.19,-541.57"/>
</g>
<!-- L8_S1_TP4_GPU12_expert0&#45;&gt;L8_S1_TP2_GPU10_moe_ar -->
<g id="edge2530" class="edge">
<title>L8_S1_TP4_GPU12_expert0&#45;&gt;L8_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M77692.75,-604.23C77692.75,-591.01 77692.75,-579 77692.75,-579 77692.75,-579 76764.81,-579 76764.81,-579 76764.81,-579 76764.81,-564.16 76764.81,-564.16"/>
<polygon fill="black" stroke="black" points="76768.31,-564.16 76764.81,-554.16 76761.31,-564.16 76768.31,-564.16"/>
</g>
<!-- L8_S1_TP4_GPU12_expert0&#45;&gt;L8_S1_TP3_GPU11_moe_ar -->
<g id="edge2566" class="edge">
<title>L8_S1_TP4_GPU12_expert0&#45;&gt;L8_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M77748.88,-604.23C77748.88,-591.01 77748.88,-579 77748.88,-579 77748.88,-579 77329.98,-579 77329.98,-579 77329.98,-579 77329.98,-575.41 77329.98,-575.41"/>
<polygon fill="black" stroke="black" points="77333.48,-575.41 77329.98,-565.41 77326.48,-575.41 77333.48,-575.41"/>
</g>
<!-- L8_S1_TP4_GPU12_expert0&#45;&gt;L8_S1_TP4_GPU12_moe_ar -->
<g id="edge2602" class="edge">
<title>L8_S1_TP4_GPU12_expert0&#45;&gt;L8_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M77805,-604.34C77805,-604.34 77805,-576.79 77805,-576.79"/>
<polygon fill="black" stroke="black" points="77808.5,-576.79 77805,-566.79 77801.5,-576.79 77808.5,-576.79"/>
</g>
<!-- L8_S1_TP4_GPU12_expert0&#45;&gt;L8_S1_TP5_GPU13_moe_ar -->
<g id="edge2638" class="edge">
<title>L8_S1_TP4_GPU12_expert0&#45;&gt;L8_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M77861.12,-604.42C77861.12,-601.71 77861.12,-600 77861.12,-600 77861.12,-600 78374.02,-600 78374.02,-600 78374.02,-600 78374.02,-567.88 78374.02,-567.88"/>
<polygon fill="black" stroke="black" points="78377.52,-567.88 78374.02,-557.88 78370.52,-567.88 78377.52,-567.88"/>
</g>
<!-- L8_S1_TP4_GPU12_expert0&#45;&gt;L8_S1_TP6_GPU14_moe_ar -->
<g id="edge2674" class="edge">
<title>L8_S1_TP4_GPU12_expert0&#45;&gt;L8_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M77917.25,-604.42C77917.25,-601.71 77917.25,-600 77917.25,-600 77917.25,-600 78943.53,-600 78943.53,-600 78943.53,-600 78943.53,-538.93 78943.53,-538.93"/>
<polygon fill="black" stroke="black" points="78947.03,-538.93 78943.53,-528.93 78940.03,-538.93 78947.03,-538.93"/>
</g>
<!-- L8_S1_TP4_GPU12_expert0&#45;&gt;L8_S1_TP7_GPU15_moe_ar -->
<g id="edge2710" class="edge">
<title>L8_S1_TP4_GPU12_expert0&#45;&gt;L8_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M77973.38,-604.42C77973.38,-601.71 77973.38,-600 77973.38,-600 77973.38,-600 79784.18,-600 79784.18,-600 79784.18,-600 79784.18,-571.61 79784.18,-571.61"/>
<polygon fill="black" stroke="black" points="79787.68,-571.61 79784.18,-561.61 79780.68,-571.61 79787.68,-571.61"/>
</g>
<!-- L8_S1_TP4_GPU12_expert1 -->
<g id="node868" class="node">
<title>L8_S1_TP4_GPU12_expert1</title>
<polygon fill="none" stroke="black" points="78496.5,-672.5 78047.5,-672.5 78047.5,-604.5 78496.5,-604.5 78496.5,-672.5"/>
<text text-anchor="middle" x="78272" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="78272" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="78272" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="78272" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L8_S1_TP4_GPU12_expert1&#45;&gt;L8_S1_TP0_GPU8_moe_ar -->
<g id="edge2459" class="edge">
<title>L8_S1_TP4_GPU12_expert1&#45;&gt;L8_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M78242.5,-604.4C78242.5,-555.17 78242.5,-470 78242.5,-470 78242.5,-470 75396.1,-470 75396.1,-470 75396.1,-470 75396.1,-477.63 75396.1,-477.63"/>
<polygon fill="black" stroke="black" points="75392.6,-477.63 75396.1,-487.63 75399.6,-477.63 75392.6,-477.63"/>
</g>
<!-- L8_S1_TP4_GPU12_expert1&#45;&gt;L8_S1_TP1_GPU9_moe_ar -->
<g id="edge2495" class="edge">
<title>L8_S1_TP4_GPU12_expert1&#45;&gt;L8_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M78068.16,-604.39C78068.16,-604.13 78068.16,-604 78068.16,-604 78068.16,-604 75904.93,-604 75904.93,-604 75904.93,-604 75904.93,-577.58 75904.93,-577.58"/>
<polygon fill="black" stroke="black" points="75908.43,-577.58 75904.93,-567.58 75901.43,-577.58 75908.43,-577.58"/>
</g>
<!-- L8_S1_TP4_GPU12_expert1&#45;&gt;L8_S1_TP2_GPU10_moe_ar -->
<g id="edge2531" class="edge">
<title>L8_S1_TP4_GPU12_expert1&#45;&gt;L8_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M78088.82,-604.23C78088.82,-591.01 78088.82,-579 78088.82,-579 78088.82,-579 76788.47,-579 76788.47,-579 76788.47,-579 76788.47,-560.05 76788.47,-560.05"/>
<polygon fill="black" stroke="black" points="76791.97,-560.05 76788.47,-550.05 76784.97,-560.05 76791.97,-560.05"/>
</g>
<!-- L8_S1_TP4_GPU12_expert1&#45;&gt;L8_S1_TP3_GPU11_moe_ar -->
<g id="edge2567" class="edge">
<title>L8_S1_TP4_GPU12_expert1&#45;&gt;L8_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M78109.49,-604.23C78109.49,-591.01 78109.49,-579 78109.49,-579 78109.49,-579 77373.28,-579 77373.28,-579 77373.28,-579 77373.28,-572.68 77373.28,-572.68"/>
<polygon fill="black" stroke="black" points="77376.78,-572.68 77373.28,-562.68 77369.78,-572.68 77376.78,-572.68"/>
</g>
<!-- L8_S1_TP4_GPU12_expert1&#45;&gt;L8_S1_TP4_GPU12_moe_ar -->
<g id="edge2603" class="edge">
<title>L8_S1_TP4_GPU12_expert1&#45;&gt;L8_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M78130.15,-604.34C78130.15,-604.34 78130.15,-565.31 78130.15,-565.31"/>
<polygon fill="black" stroke="black" points="78133.65,-565.31 78130.15,-555.31 78126.65,-565.31 78133.65,-565.31"/>
</g>
<!-- L8_S1_TP4_GPU12_expert1&#45;&gt;L8_S1_TP5_GPU13_moe_ar -->
<g id="edge2639" class="edge">
<title>L8_S1_TP4_GPU12_expert1&#45;&gt;L8_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M78404.64,-604.34C78404.64,-604.34 78404.64,-571.18 78404.64,-571.18"/>
<polygon fill="black" stroke="black" points="78408.14,-571.18 78404.64,-561.18 78401.14,-571.18 78408.14,-571.18"/>
</g>
<!-- L8_S1_TP4_GPU12_expert1&#45;&gt;L8_S1_TP6_GPU14_moe_ar -->
<g id="edge2675" class="edge">
<title>L8_S1_TP4_GPU12_expert1&#45;&gt;L8_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M78435.26,-604.42C78435.26,-601.71 78435.26,-600 78435.26,-600 78435.26,-600 78948.52,-600 78948.52,-600 78948.52,-600 78948.52,-542.16 78948.52,-542.16"/>
<polygon fill="black" stroke="black" points="78952.02,-542.16 78948.52,-532.16 78945.02,-542.16 78952.02,-542.16"/>
</g>
<!-- L8_S1_TP4_GPU12_expert1&#45;&gt;L8_S1_TP7_GPU15_moe_ar -->
<g id="edge2711" class="edge">
<title>L8_S1_TP4_GPU12_expert1&#45;&gt;L8_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M78465.88,-604.42C78465.88,-601.71 78465.88,-600 78465.88,-600 78465.88,-600 79806.85,-600 79806.85,-600 79806.85,-600 79806.85,-573.47 79806.85,-573.47"/>
<polygon fill="black" stroke="black" points="79810.35,-573.47 79806.85,-563.47 79803.35,-573.47 79810.35,-573.47"/>
</g>
<!-- L8_S1_TP5_GPU13_expert0 -->
<g id="node869" class="node">
<title>L8_S1_TP5_GPU13_expert0</title>
<polygon fill="none" stroke="black" points="78963.5,-672.5 78514.5,-672.5 78514.5,-604.5 78963.5,-604.5 78963.5,-672.5"/>
<text text-anchor="middle" x="78739" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="78739" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="78739" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="78739" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L8_S1_TP5_GPU13_expert0&#45;&gt;L8_S1_TP0_GPU8_moe_ar -->
<g id="edge2460" class="edge">
<title>L8_S1_TP5_GPU13_expert0&#45;&gt;L8_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M78598.69,-672.65C78598.69,-689.39 78598.69,-706 78598.69,-706 78598.69,-706 75238.3,-706 75238.3,-706 75238.3,-706 75238.3,-577.25 75238.3,-577.25"/>
<polygon fill="black" stroke="black" points="75241.8,-577.25 75238.3,-567.25 75234.8,-577.25 75241.8,-577.25"/>
</g>
<!-- L8_S1_TP5_GPU13_expert0&#45;&gt;L8_S1_TP1_GPU9_moe_ar -->
<g id="edge2496" class="edge">
<title>L8_S1_TP5_GPU13_expert0&#45;&gt;L8_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M78556.59,-672.64C78556.59,-688.11 78556.59,-703 78556.59,-703 78556.59,-703 75703.5,-703 75703.5,-703 75703.5,-703 75703.5,-574.61 75703.5,-574.61"/>
<polygon fill="black" stroke="black" points="75707,-574.61 75703.5,-564.61 75700,-574.61 75707,-574.61"/>
</g>
<!-- L8_S1_TP5_GPU13_expert0&#45;&gt;L8_S1_TP2_GPU10_moe_ar -->
<g id="edge2532" class="edge">
<title>L8_S1_TP5_GPU13_expert0&#45;&gt;L8_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M78559.61,-604.23C78559.61,-591.01 78559.61,-579 78559.61,-579 78559.61,-579 76812.14,-579 76812.14,-579 76812.14,-579 76812.14,-555.26 76812.14,-555.26"/>
<polygon fill="black" stroke="black" points="76815.64,-555.26 76812.14,-545.26 76808.64,-555.26 76815.64,-555.26"/>
</g>
<!-- L8_S1_TP5_GPU13_expert0&#45;&gt;L8_S1_TP3_GPU11_moe_ar -->
<g id="edge2568" class="edge">
<title>L8_S1_TP5_GPU13_expert0&#45;&gt;L8_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M78604.71,-604.23C78604.71,-591.01 78604.71,-579 78604.71,-579 78604.71,-579 77416.57,-579 77416.57,-579 77416.57,-579 77416.57,-568.51 77416.57,-568.51"/>
<polygon fill="black" stroke="black" points="77420.07,-568.51 77416.57,-558.51 77413.07,-568.51 77420.07,-568.51"/>
</g>
<!-- L8_S1_TP5_GPU13_expert0&#45;&gt;L8_S1_TP4_GPU12_moe_ar -->
<g id="edge2604" class="edge">
<title>L8_S1_TP5_GPU13_expert0&#45;&gt;L8_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M78649.82,-604.23C78649.82,-591.01 78649.82,-579 78649.82,-579 78649.82,-579 78150.81,-579 78150.81,-579 78150.81,-579 78150.81,-562.11 78150.81,-562.11"/>
<polygon fill="black" stroke="black" points="78154.31,-562.11 78150.81,-552.11 78147.31,-562.11 78154.31,-562.11"/>
</g>
<!-- L8_S1_TP5_GPU13_expert0&#45;&gt;L8_S1_TP5_GPU13_moe_ar -->
<g id="edge2640" class="edge">
<title>L8_S1_TP5_GPU13_expert0&#45;&gt;L8_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M78694.93,-604.34C78694.93,-604.34 78694.93,-575.92 78694.93,-575.92"/>
<polygon fill="black" stroke="black" points="78698.43,-575.92 78694.93,-565.92 78691.43,-575.92 78698.43,-575.92"/>
</g>
<!-- L8_S1_TP5_GPU13_expert0&#45;&gt;L8_S1_TP6_GPU14_moe_ar -->
<g id="edge2676" class="edge">
<title>L8_S1_TP5_GPU13_expert0&#45;&gt;L8_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M78953.52,-604.34C78953.52,-604.34 78953.52,-544.93 78953.52,-544.93"/>
<polygon fill="black" stroke="black" points="78957.02,-544.93 78953.52,-534.93 78950.02,-544.93 78957.02,-544.93"/>
</g>
<!-- L8_S1_TP5_GPU13_expert0&#45;&gt;L8_S1_TP7_GPU15_moe_ar -->
<g id="edge2712" class="edge">
<title>L8_S1_TP5_GPU13_expert0&#45;&gt;L8_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M78958.51,-604.42C78958.51,-601.71 78958.51,-600 78958.51,-600 78958.51,-600 79829.51,-600 79829.51,-600 79829.51,-600 79829.51,-574.86 79829.51,-574.86"/>
<polygon fill="black" stroke="black" points="79833.01,-574.86 79829.51,-564.86 79826.01,-574.86 79833.01,-574.86"/>
</g>
<!-- L8_S1_TP5_GPU13_expert1 -->
<g id="node870" class="node">
<title>L8_S1_TP5_GPU13_expert1</title>
<polygon fill="none" stroke="black" points="79430.5,-672.5 78981.5,-672.5 78981.5,-604.5 79430.5,-604.5 79430.5,-672.5"/>
<text text-anchor="middle" x="79206" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="79206" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="79206" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="79206" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L8_S1_TP5_GPU13_expert1&#45;&gt;L8_S1_TP0_GPU8_moe_ar -->
<g id="edge2461" class="edge">
<title>L8_S1_TP5_GPU13_expert1&#45;&gt;L8_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M79131.17,-672.75C79131.17,-689.87 79131.17,-707 79131.17,-707 79131.17,-707 75234.7,-707 75234.7,-707 75234.7,-707 75234.7,-577.02 75234.7,-577.02"/>
<polygon fill="black" stroke="black" points="75238.2,-577.02 75234.7,-567.02 75231.2,-577.02 75238.2,-577.02"/>
</g>
<!-- L8_S1_TP5_GPU13_expert1&#45;&gt;L8_S1_TP1_GPU9_moe_ar -->
<g id="edge2497" class="edge">
<title>L8_S1_TP5_GPU13_expert1&#45;&gt;L8_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M79037.62,-604.39C79037.62,-604.13 79037.62,-604 79037.62,-604 79037.62,-604 75969.07,-604 75969.07,-604 75969.07,-604 75969.07,-574.66 75969.07,-574.66"/>
<polygon fill="black" stroke="black" points="75972.57,-574.66 75969.07,-564.66 75965.57,-574.66 75972.57,-574.66"/>
</g>
<!-- L8_S1_TP5_GPU13_expert1&#45;&gt;L8_S1_TP2_GPU10_moe_ar -->
<g id="edge2533" class="edge">
<title>L8_S1_TP5_GPU13_expert1&#45;&gt;L8_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M79093.75,-604.23C79093.75,-591.01 79093.75,-579 79093.75,-579 79093.75,-579 76835.8,-579 76835.8,-579 76835.8,-579 76835.8,-548.31 76835.8,-548.31"/>
<polygon fill="black" stroke="black" points="76839.3,-548.31 76835.8,-538.31 76832.3,-548.31 76839.3,-548.31"/>
</g>
<!-- L8_S1_TP5_GPU13_expert1&#45;&gt;L8_S1_TP3_GPU11_moe_ar -->
<g id="edge2569" class="edge">
<title>L8_S1_TP5_GPU13_expert1&#45;&gt;L8_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M79149.88,-604.23C79149.88,-591.01 79149.88,-579 79149.88,-579 79149.88,-579 77459.87,-579 77459.87,-579 77459.87,-579 77459.87,-562.79 77459.87,-562.79"/>
<polygon fill="black" stroke="black" points="77463.37,-562.79 77459.87,-552.79 77456.37,-562.79 77463.37,-562.79"/>
</g>
<!-- L8_S1_TP5_GPU13_expert1&#45;&gt;L8_S1_TP4_GPU12_moe_ar -->
<g id="edge2605" class="edge">
<title>L8_S1_TP5_GPU13_expert1&#45;&gt;L8_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M79206,-604.23C79206,-591.01 79206,-579 79206,-579 79206,-579 78171.47,-579 78171.47,-579 78171.47,-579 78171.47,-558.34 78171.47,-558.34"/>
<polygon fill="black" stroke="black" points="78174.97,-558.34 78171.47,-548.34 78167.97,-558.34 78174.97,-558.34"/>
</g>
<!-- L8_S1_TP5_GPU13_expert1&#45;&gt;L8_S1_TP5_GPU13_moe_ar -->
<g id="edge2641" class="edge">
<title>L8_S1_TP5_GPU13_expert1&#45;&gt;L8_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M79262.12,-604.23C79262.12,-591.01 79262.12,-579 79262.12,-579 79262.12,-579 78740.03,-579 78740.03,-579 78740.03,-579 78740.03,-573.3 78740.03,-573.3"/>
<polygon fill="black" stroke="black" points="78743.53,-573.3 78740.03,-563.3 78736.53,-573.3 78743.53,-573.3"/>
</g>
<!-- L8_S1_TP5_GPU13_expert1&#45;&gt;L8_S1_TP6_GPU14_moe_ar -->
<g id="edge2677" class="edge">
<title>L8_S1_TP5_GPU13_expert1&#45;&gt;L8_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M79318.25,-604.34C79318.25,-604.34 79318.25,-578.11 79318.25,-578.11"/>
<polygon fill="black" stroke="black" points="79321.75,-578.11 79318.25,-568.11 79314.75,-578.11 79321.75,-578.11"/>
</g>
<!-- L8_S1_TP5_GPU13_expert1&#45;&gt;L8_S1_TP7_GPU15_moe_ar -->
<g id="edge2713" class="edge">
<title>L8_S1_TP5_GPU13_expert1&#45;&gt;L8_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M79374.38,-604.42C79374.38,-601.71 79374.38,-600 79374.38,-600 79374.38,-600 79852.17,-600 79852.17,-600 79852.17,-600 79852.17,-576.25 79852.17,-576.25"/>
<polygon fill="black" stroke="black" points="79855.67,-576.25 79852.17,-566.25 79848.67,-576.25 79855.67,-576.25"/>
</g>
<!-- L8_S1_TP6_GPU14_expert0 -->
<g id="node871" class="node">
<title>L8_S1_TP6_GPU14_expert0</title>
<polygon fill="none" stroke="black" points="79897.5,-672.5 79448.5,-672.5 79448.5,-604.5 79897.5,-604.5 79897.5,-672.5"/>
<text text-anchor="middle" x="79673" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="79673" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="79673" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="79673" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L8_S1_TP6_GPU14_expert0&#45;&gt;L8_S1_TP0_GPU8_moe_ar -->
<g id="edge2462" class="edge">
<title>L8_S1_TP6_GPU14_expert0&#45;&gt;L8_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M79716.19,-604.23C79716.19,-591.01 79716.19,-579 79716.19,-579 79716.19,-579 75455.47,-579 75455.47,-579 75455.47,-579 75455.47,-550.58 75455.47,-550.58"/>
<polygon fill="black" stroke="black" points="75458.97,-550.58 75455.47,-540.58 75451.97,-550.58 75458.97,-550.58"/>
</g>
<!-- L8_S1_TP6_GPU14_expert0&#45;&gt;L8_S1_TP1_GPU9_moe_ar -->
<g id="edge2498" class="edge">
<title>L8_S1_TP6_GPU14_expert0&#45;&gt;L8_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M79480.29,-604.23C79480.29,-591.01 79480.29,-579 79480.29,-579 79480.29,-579 76033.21,-579 76033.21,-579 76033.21,-579 76033.21,-569.49 76033.21,-569.49"/>
<polygon fill="black" stroke="black" points="76036.71,-569.49 76033.21,-559.49 76029.71,-569.49 76036.71,-569.49"/>
</g>
<!-- L8_S1_TP6_GPU14_expert0&#45;&gt;L8_S1_TP2_GPU10_moe_ar -->
<g id="edge2534" class="edge">
<title>L8_S1_TP6_GPU14_expert0&#45;&gt;L8_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M79616.5,-604.2C79616.5,-555.2 79616.5,-471 79616.5,-471 79616.5,-471 76829.37,-471 76829.37,-471 76829.37,-471 76829.37,-490.32 76829.37,-490.32"/>
<polygon fill="black" stroke="black" points="76825.87,-490.32 76829.37,-500.32 76832.87,-490.32 76825.87,-490.32"/>
</g>
<!-- L8_S1_TP6_GPU14_expert0&#45;&gt;L8_S1_TP3_GPU11_moe_ar -->
<g id="edge2570" class="edge">
<title>L8_S1_TP6_GPU14_expert0&#45;&gt;L8_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M79496.19,-604.23C79496.19,-591.01 79496.19,-579 79496.19,-579 79496.19,-579 77503.17,-579 77503.17,-579 77503.17,-579 77503.17,-554.24 77503.17,-554.24"/>
<polygon fill="black" stroke="black" points="77506.67,-554.24 77503.17,-544.24 77499.67,-554.24 77506.67,-554.24"/>
</g>
<!-- L8_S1_TP6_GPU14_expert0&#45;&gt;L8_S1_TP4_GPU12_moe_ar -->
<g id="edge2606" class="edge">
<title>L8_S1_TP6_GPU14_expert0&#45;&gt;L8_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M79512.08,-604.23C79512.08,-591.01 79512.08,-579 79512.08,-579 79512.08,-579 78192.14,-579 78192.14,-579 78192.14,-579 78192.14,-553.57 78192.14,-553.57"/>
<polygon fill="black" stroke="black" points="78195.64,-553.57 78192.14,-543.57 78188.64,-553.57 78195.64,-553.57"/>
</g>
<!-- L8_S1_TP6_GPU14_expert0&#45;&gt;L8_S1_TP5_GPU13_moe_ar -->
<g id="edge2642" class="edge">
<title>L8_S1_TP6_GPU14_expert0&#45;&gt;L8_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M79527.98,-604.23C79527.98,-591.01 79527.98,-579 79527.98,-579 79527.98,-579 78785.14,-579 78785.14,-579 78785.14,-579 78785.14,-569.17 78785.14,-569.17"/>
<polygon fill="black" stroke="black" points="78788.64,-569.17 78785.14,-559.17 78781.64,-569.17 78788.64,-569.17"/>
</g>
<!-- L8_S1_TP6_GPU14_expert0&#45;&gt;L8_S1_TP6_GPU14_moe_ar -->
<g id="edge2678" class="edge">
<title>L8_S1_TP6_GPU14_expert0&#45;&gt;L8_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M79543.88,-604.34C79543.88,-604.34 79543.88,-558.91 79543.88,-558.91"/>
<polygon fill="black" stroke="black" points="79547.38,-558.91 79543.88,-548.91 79540.38,-558.91 79547.38,-558.91"/>
</g>
<!-- L8_S1_TP6_GPU14_expert0&#45;&gt;L8_S1_TP7_GPU15_moe_ar -->
<g id="edge2714" class="edge">
<title>L8_S1_TP6_GPU14_expert0&#45;&gt;L8_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M79874.84,-604.34C79874.84,-604.34 79874.84,-577.23 79874.84,-577.23"/>
<polygon fill="black" stroke="black" points="79878.34,-577.23 79874.84,-567.23 79871.34,-577.23 79878.34,-577.23"/>
</g>
<!-- L8_S1_TP6_GPU14_expert1 -->
<g id="node872" class="node">
<title>L8_S1_TP6_GPU14_expert1</title>
<polygon fill="none" stroke="black" points="80364.5,-672.5 79915.5,-672.5 79915.5,-604.5 80364.5,-604.5 80364.5,-672.5"/>
<text text-anchor="middle" x="80140" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="80140" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="80140" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="80140" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L8_S1_TP6_GPU14_expert1&#45;&gt;L8_S1_TP0_GPU8_moe_ar -->
<g id="edge2463" class="edge">
<title>L8_S1_TP6_GPU14_expert1&#45;&gt;L8_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M80065.17,-672.84C80065.17,-690.35 80065.17,-708 80065.17,-708 80065.17,-708 75231.1,-708 75231.1,-708 75231.1,-708 75231.1,-577.27 75231.1,-577.27"/>
<polygon fill="black" stroke="black" points="75234.6,-577.27 75231.1,-567.27 75227.6,-577.27 75234.6,-577.27"/>
</g>
<!-- L8_S1_TP6_GPU14_expert1&#45;&gt;L8_S1_TP1_GPU9_moe_ar -->
<g id="edge2499" class="edge">
<title>L8_S1_TP6_GPU14_expert1&#45;&gt;L8_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M80346.99,-604.41C80346.99,-554.65 80346.99,-468 80346.99,-468 80346.99,-468 76116.35,-468 76116.35,-468 76116.35,-468 76116.35,-483.59 76116.35,-483.59"/>
<polygon fill="black" stroke="black" points="76112.85,-483.59 76116.35,-493.59 76119.85,-483.59 76112.85,-483.59"/>
</g>
<!-- L8_S1_TP6_GPU14_expert1&#45;&gt;L8_S1_TP2_GPU10_moe_ar -->
<g id="edge2535" class="edge">
<title>L8_S1_TP6_GPU14_expert1&#45;&gt;L8_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M80329.48,-604.41C80329.48,-554.65 80329.48,-468 80329.48,-468 80329.48,-468 76799.28,-468 76799.28,-468 76799.28,-468 76799.28,-482.67 76799.28,-482.67"/>
<polygon fill="black" stroke="black" points="76795.78,-482.67 76799.28,-492.67 76802.78,-482.67 76795.78,-482.67"/>
</g>
<!-- L8_S1_TP6_GPU14_expert1&#45;&gt;L8_S1_TP3_GPU11_moe_ar -->
<g id="edge2571" class="edge">
<title>L8_S1_TP6_GPU14_expert1&#45;&gt;L8_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M80311.97,-604.41C80311.97,-554.65 80311.97,-468 80311.97,-468 80311.97,-468 77540.64,-468 77540.64,-468 77540.64,-468 77540.64,-501.29 77540.64,-501.29"/>
<polygon fill="black" stroke="black" points="77537.14,-501.29 77540.64,-511.29 77544.14,-501.29 77537.14,-501.29"/>
</g>
<!-- L8_S1_TP6_GPU14_expert1&#45;&gt;L8_S1_TP4_GPU12_moe_ar -->
<g id="edge2607" class="edge">
<title>L8_S1_TP6_GPU14_expert1&#45;&gt;L8_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M79991.29,-604.23C79991.29,-591.01 79991.29,-579 79991.29,-579 79991.29,-579 78212.8,-579 78212.8,-579 78212.8,-579 78212.8,-547.36 78212.8,-547.36"/>
<polygon fill="black" stroke="black" points="78216.3,-547.36 78212.8,-537.36 78209.3,-547.36 78216.3,-547.36"/>
</g>
<!-- L8_S1_TP6_GPU14_expert1&#45;&gt;L8_S1_TP5_GPU13_moe_ar -->
<g id="edge2643" class="edge">
<title>L8_S1_TP6_GPU14_expert1&#45;&gt;L8_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M80067.08,-604.23C80067.08,-591.01 80067.08,-579 80067.08,-579 80067.08,-579 78830.25,-579 78830.25,-579 78830.25,-579 78830.25,-563.47 78830.25,-563.47"/>
<polygon fill="black" stroke="black" points="78833.75,-563.47 78830.25,-553.47 78826.75,-563.47 78833.75,-563.47"/>
</g>
<!-- L8_S1_TP6_GPU14_expert1&#45;&gt;L8_S1_TP6_GPU14_moe_ar -->
<g id="edge2679" class="edge">
<title>L8_S1_TP6_GPU14_expert1&#45;&gt;L8_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M80142.88,-604.36C80142.88,-590.64 80142.88,-578 80142.88,-578 80142.88,-578 79559.77,-578 79559.77,-578 79559.77,-578 79559.77,-555.17 79559.77,-555.17"/>
<polygon fill="black" stroke="black" points="79563.27,-555.17 79559.77,-545.17 79556.27,-555.17 79563.27,-555.17"/>
</g>
<!-- L8_S1_TP6_GPU14_expert1&#45;&gt;L8_S1_TP7_GPU15_moe_ar -->
<g id="edge2715" class="edge">
<title>L8_S1_TP6_GPU14_expert1&#45;&gt;L8_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M80218.67,-604.34C80218.67,-604.34 80218.67,-561.27 80218.67,-561.27"/>
<polygon fill="black" stroke="black" points="80222.17,-561.27 80218.67,-551.27 80215.17,-561.27 80222.17,-561.27"/>
</g>
<!-- L8_S1_TP7_GPU15_expert0 -->
<g id="node873" class="node">
<title>L8_S1_TP7_GPU15_expert0</title>
<polygon fill="none" stroke="black" points="80831.5,-672.5 80382.5,-672.5 80382.5,-604.5 80831.5,-604.5 80831.5,-672.5"/>
<text text-anchor="middle" x="80607" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="80607" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="80607" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="80607" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L8_S1_TP7_GPU15_expert0&#45;&gt;L8_S1_TP0_GPU8_moe_ar -->
<g id="edge2464" class="edge">
<title>L8_S1_TP7_GPU15_expert0&#45;&gt;L8_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M80775.38,-604.21C80775.38,-554.16 80775.38,-467 80775.38,-467 80775.38,-467 75306.73,-467 75306.73,-467 75306.73,-467 75306.73,-468.08 75306.73,-468.08"/>
<polygon fill="black" stroke="black" points="75303.23,-467.81 75306.73,-477.81 75310.23,-467.81 75303.23,-467.81"/>
</g>
<!-- L8_S1_TP7_GPU15_expert0&#45;&gt;L8_S1_TP1_GPU9_moe_ar -->
<g id="edge2500" class="edge">
<title>L8_S1_TP7_GPU15_expert0&#45;&gt;L8_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M80719.25,-604.41C80719.25,-554.65 80719.25,-468 80719.25,-468 80719.25,-468 76060.23,-468 76060.23,-468 76060.23,-468 76060.23,-474.3 76060.23,-474.3"/>
<polygon fill="black" stroke="black" points="76056.73,-474.3 76060.23,-484.3 76063.73,-474.3 76056.73,-474.3"/>
</g>
<!-- L8_S1_TP7_GPU15_expert0&#45;&gt;L8_S1_TP2_GPU10_moe_ar -->
<g id="edge2536" class="edge">
<title>L8_S1_TP7_GPU15_expert0&#45;&gt;L8_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M80663.12,-604.41C80663.12,-554.65 80663.12,-468 80663.12,-468 80663.12,-468 76769.18,-468 76769.18,-468 76769.18,-468 76769.18,-477.52 76769.18,-477.52"/>
<polygon fill="black" stroke="black" points="76765.68,-477.52 76769.18,-487.52 76772.68,-477.52 76765.68,-477.52"/>
</g>
<!-- L8_S1_TP7_GPU15_expert0&#45;&gt;L8_S1_TP3_GPU11_moe_ar -->
<g id="edge2572" class="edge">
<title>L8_S1_TP7_GPU15_expert0&#45;&gt;L8_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M80607,-604.41C80607,-554.65 80607,-468 80607,-468 80607,-468 77534.82,-468 77534.82,-468 77534.82,-468 77534.82,-497.73 77534.82,-497.73"/>
<polygon fill="black" stroke="black" points="77531.32,-497.73 77534.82,-507.73 77538.32,-497.73 77531.32,-497.73"/>
</g>
<!-- L8_S1_TP7_GPU15_expert0&#45;&gt;L8_S1_TP4_GPU12_moe_ar -->
<g id="edge2608" class="edge">
<title>L8_S1_TP7_GPU15_expert0&#45;&gt;L8_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M80589.64,-672.85C80589.64,-687.81 80589.64,-702 80589.64,-702 80589.64,-702 78041.5,-702 78041.5,-702 78041.5,-702 78041.5,-574.37 78041.5,-574.37"/>
<polygon fill="black" stroke="black" points="78045,-574.37 78041.5,-564.37 78038,-574.37 78045,-574.37"/>
</g>
<!-- L8_S1_TP7_GPU15_expert0&#45;&gt;L8_S1_TP5_GPU13_moe_ar -->
<g id="edge2644" class="edge">
<title>L8_S1_TP7_GPU15_expert0&#45;&gt;L8_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M80438.62,-604.23C80438.62,-591.01 80438.62,-579 80438.62,-579 80438.62,-579 78875.35,-579 78875.35,-579 78875.35,-579 78875.35,-554.58 78875.35,-554.58"/>
<polygon fill="black" stroke="black" points="78878.85,-554.58 78875.35,-544.58 78871.85,-554.58 78878.85,-554.58"/>
</g>
<!-- L8_S1_TP7_GPU15_expert0&#45;&gt;L8_S1_TP6_GPU14_moe_ar -->
<g id="edge2680" class="edge">
<title>L8_S1_TP7_GPU15_expert0&#45;&gt;L8_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M80494.75,-604.36C80494.75,-590.64 80494.75,-578 80494.75,-578 80494.75,-578 79575.67,-578 79575.67,-578 79575.67,-578 79575.67,-550.88 79575.67,-550.88"/>
<polygon fill="black" stroke="black" points="79579.17,-550.88 79575.67,-540.88 79572.17,-550.88 79579.17,-550.88"/>
</g>
<!-- L8_S1_TP7_GPU15_expert0&#45;&gt;L8_S1_TP7_GPU15_moe_ar -->
<g id="edge2716" class="edge">
<title>L8_S1_TP7_GPU15_expert0&#45;&gt;L8_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M80550.88,-604.13C80550.88,-580.74 80550.88,-554 80550.88,-554 80550.88,-554 80209.48,-554 80209.48,-554"/>
<polygon fill="black" stroke="black" points="80209.48,-550.5 80199.48,-554 80209.48,-557.5 80209.48,-550.5"/>
</g>
<!-- L8_S1_TP7_GPU15_expert1 -->
<g id="node874" class="node">
<title>L8_S1_TP7_GPU15_expert1</title>
<polygon fill="none" stroke="black" points="81298.5,-672.5 80849.5,-672.5 80849.5,-604.5 81298.5,-604.5 81298.5,-672.5"/>
<text text-anchor="middle" x="81074" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="81074" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="81074" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="81074" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L8_S1_TP7_GPU15_expert1&#45;&gt;L8_S1_TP0_GPU8_moe_ar -->
<g id="edge2465" class="edge">
<title>L8_S1_TP7_GPU15_expert1&#45;&gt;L8_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M81043.31,-604.08C81043.31,-552.21 81043.31,-460 81043.31,-460 81043.31,-460 75217.37,-460 75217.37,-460 75217.37,-460 75217.37,-463.11 75217.37,-463.11"/>
<polygon fill="black" stroke="black" points="75213.87,-463.11 75217.37,-473.11 75220.87,-463.11 75213.87,-463.11"/>
</g>
<!-- L8_S1_TP7_GPU15_expert1&#45;&gt;L8_S1_TP1_GPU9_moe_ar -->
<g id="edge2501" class="edge">
<title>L8_S1_TP7_GPU15_expert1&#45;&gt;L8_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M81015.62,-604.28C81015.62,-552.7 81015.62,-461 81015.62,-461 81015.62,-461 76004.12,-461 76004.12,-461 76004.12,-461 76004.12,-468.51 76004.12,-468.51"/>
<polygon fill="black" stroke="black" points="76000.62,-468.51 76004.12,-478.51 76007.62,-468.51 76000.62,-468.51"/>
</g>
<!-- L8_S1_TP7_GPU15_expert1&#45;&gt;L8_S1_TP2_GPU10_moe_ar -->
<g id="edge2537" class="edge">
<title>L8_S1_TP7_GPU15_expert1&#45;&gt;L8_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M80987.94,-604.28C80987.94,-552.7 80987.94,-461 80987.94,-461 80987.94,-461 76739.09,-461 76739.09,-461 76739.09,-461 76739.09,-473.46 76739.09,-473.46"/>
<polygon fill="black" stroke="black" points="76735.59,-473.46 76739.09,-483.46 76742.59,-473.46 76735.59,-473.46"/>
</g>
<!-- L8_S1_TP7_GPU15_expert1&#45;&gt;L8_S1_TP3_GPU11_moe_ar -->
<g id="edge2573" class="edge">
<title>L8_S1_TP7_GPU15_expert1&#45;&gt;L8_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M80960.25,-604.28C80960.25,-552.7 80960.25,-461 80960.25,-461 80960.25,-461 77366.13,-461 77366.13,-461 77366.13,-461 77366.13,-467.55 77366.13,-467.55"/>
<polygon fill="black" stroke="black" points="77362.63,-467.55 77366.13,-477.55 77369.63,-467.55 77362.63,-467.55"/>
</g>
<!-- L8_S1_TP7_GPU15_expert1&#45;&gt;L8_S1_TP4_GPU12_moe_ar -->
<g id="edge2609" class="edge">
<title>L8_S1_TP7_GPU15_expert1&#45;&gt;L8_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M80999.17,-672.78C80999.17,-688.63 80999.17,-704 80999.17,-704 80999.17,-704 78035.5,-704 78035.5,-704 78035.5,-704 78035.5,-574.39 78035.5,-574.39"/>
<polygon fill="black" stroke="black" points="78039,-574.39 78035.5,-564.39 78032,-574.39 78039,-574.39"/>
</g>
<!-- L8_S1_TP7_GPU15_expert1&#45;&gt;L8_S1_TP5_GPU13_moe_ar -->
<g id="edge2645" class="edge">
<title>L8_S1_TP7_GPU15_expert1&#45;&gt;L8_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M80932.56,-604.28C80932.56,-552.7 80932.56,-461 80932.56,-461 80932.56,-461 78828.64,-461 78828.64,-461 78828.64,-461 78828.64,-477.23 78828.64,-477.23"/>
<polygon fill="black" stroke="black" points="78825.14,-477.23 78828.64,-487.23 78832.14,-477.23 78825.14,-477.23"/>
</g>
<!-- L8_S1_TP7_GPU15_expert1&#45;&gt;L8_S1_TP6_GPU14_moe_ar -->
<g id="edge2681" class="edge">
<title>L8_S1_TP7_GPU15_expert1&#45;&gt;L8_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M80877.19,-604.36C80877.19,-590.64 80877.19,-578 80877.19,-578 80877.19,-578 79591.57,-578 79591.57,-578 79591.57,-578 79591.57,-545.25 79591.57,-545.25"/>
<polygon fill="black" stroke="black" points="79595.07,-545.25 79591.57,-535.25 79588.07,-545.25 79595.07,-545.25"/>
</g>
<!-- L8_S1_TP7_GPU15_expert1&#45;&gt;L8_S1_TP7_GPU15_moe_ar -->
<g id="edge2717" class="edge">
<title>L8_S1_TP7_GPU15_expert1&#45;&gt;L8_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M80904.88,-604.4C80904.88,-576.28 80904.88,-541 80904.88,-541 80904.88,-541 80272.54,-541 80272.54,-541"/>
<polygon fill="black" stroke="black" points="80272.54,-537.5 80262.54,-541 80272.54,-544.5 80272.54,-537.5"/>
</g>
<!-- L8_S1_TP0_GPU8_norm -->
<g id="node876" class="node">
<title>L8_S1_TP0_GPU8_norm</title>
<polygon fill="none" stroke="black" points="73723.5,-332.33 73274.5,-332.33 73274.5,-264.33 73723.5,-264.33 73723.5,-332.33"/>
<text text-anchor="middle" x="73499" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="73499" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="73499" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="73499" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP0_GPU8_moe_res&#45;&gt;L8_S1_TP0_GPU8_norm -->
<g id="edge2468" class="edge">
<title>L8_S1_TP0_GPU8_moe_res&#45;&gt;L8_S1_TP0_GPU8_norm</title>
<path fill="none" stroke="black" d="M73499,-368.28C73499,-368.28 73499,-342.46 73499,-342.46"/>
<polygon fill="black" stroke="black" points="73502.5,-342.46 73499,-332.46 73495.5,-342.46 73502.5,-342.46"/>
</g>
<!-- L8_S1_TP1_GPU9_qkv_linear -->
<g id="node877" class="node">
<title>L8_S1_TP1_GPU9_qkv_linear</title>
<polygon fill="none" stroke="black" points="75293,-1614.75 74685,-1614.75 74685,-1546.75 75293,-1546.75 75293,-1614.75"/>
<text text-anchor="middle" x="74989" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="74989" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="74989" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="74989" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L8_S1_TP1_GPU9_qkv_slice -->
<g id="node878" class="node">
<title>L8_S1_TP1_GPU9_qkv_slice</title>
<polygon fill="none" stroke="black" points="75287,-1496.67 74691,-1496.67 74691,-1428.67 75287,-1428.67 75287,-1496.67"/>
<text text-anchor="middle" x="74989" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="74989" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="74989" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="74989" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L8_S1_TP1_GPU9_qkv_linear&#45;&gt;L8_S1_TP1_GPU9_qkv_slice -->
<g id="edge2469" class="edge">
<title>L8_S1_TP1_GPU9_qkv_linear&#45;&gt;L8_S1_TP1_GPU9_qkv_slice</title>
<path fill="none" stroke="black" d="M74989,-1546.59C74989,-1546.59 74989,-1506.74 74989,-1506.74"/>
<polygon fill="black" stroke="black" points="74992.5,-1506.74 74989,-1496.74 74985.5,-1506.74 74992.5,-1506.74"/>
</g>
<!-- L8_S1_TP1_GPU9_qkv_slice&#45;&gt;L8_S1_TP1_GPU9_attn_v -->
<g id="edge2473" class="edge">
<title>L8_S1_TP1_GPU9_qkv_slice&#45;&gt;L8_S1_TP1_GPU9_attn_v</title>
<path fill="none" stroke="black" d="M74741.75,-1428.38C74741.75,-1428.38 74741.75,-1195 74741.75,-1195"/>
<polygon fill="black" stroke="black" points="74745.25,-1195 74741.75,-1185 74738.25,-1195 74745.25,-1195"/>
</g>
<!-- L8_S1_TP1_GPU9_qk_matmul -->
<g id="node879" class="node">
<title>L8_S1_TP1_GPU9_qk_matmul</title>
<polygon fill="none" stroke="black" points="75704.5,-1392.67 74769.5,-1392.67 74769.5,-1324.67 75704.5,-1324.67 75704.5,-1392.67"/>
<text text-anchor="middle" x="75237" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="75237" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="75237" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="75237" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L8_S1_TP1_GPU9_qkv_slice&#45;&gt;L8_S1_TP1_GPU9_qk_matmul -->
<g id="edge2470" class="edge">
<title>L8_S1_TP1_GPU9_qkv_slice&#45;&gt;L8_S1_TP1_GPU9_qk_matmul</title>
<path fill="none" stroke="black" d="M75028.25,-1428.61C75028.25,-1428.61 75028.25,-1402.8 75028.25,-1402.8"/>
<polygon fill="black" stroke="black" points="75031.75,-1402.8 75028.25,-1392.8 75024.75,-1402.8 75031.75,-1402.8"/>
</g>
<!-- L8_S1_TP1_GPU9_softmax -->
<g id="node880" class="node">
<title>L8_S1_TP1_GPU9_softmax</title>
<polygon fill="none" stroke="black" points="75465,-1288.67 74955,-1288.67 74955,-1220.67 75465,-1220.67 75465,-1288.67"/>
<text text-anchor="middle" x="75210" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="75210" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="75210" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="75210" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L8_S1_TP1_GPU9_qk_matmul&#45;&gt;L8_S1_TP1_GPU9_softmax -->
<g id="edge2471" class="edge">
<title>L8_S1_TP1_GPU9_qk_matmul&#45;&gt;L8_S1_TP1_GPU9_softmax</title>
<path fill="none" stroke="black" d="M75210,-1324.61C75210,-1324.61 75210,-1298.8 75210,-1298.8"/>
<polygon fill="black" stroke="black" points="75213.5,-1298.8 75210,-1288.8 75206.5,-1298.8 75213.5,-1298.8"/>
</g>
<!-- L8_S1_TP1_GPU9_softmax&#45;&gt;L8_S1_TP1_GPU9_attn_v -->
<g id="edge2472" class="edge">
<title>L8_S1_TP1_GPU9_softmax&#45;&gt;L8_S1_TP1_GPU9_attn_v</title>
<path fill="none" stroke="black" d="M75210,-1220.61C75210,-1220.61 75210,-1194.8 75210,-1194.8"/>
<polygon fill="black" stroke="black" points="75213.5,-1194.8 75210,-1184.8 75206.5,-1194.8 75213.5,-1194.8"/>
</g>
<!-- L8_S1_TP1_GPU9_mha_res -->
<g id="node882" class="node">
<title>L8_S1_TP1_GPU9_mha_res</title>
<polygon fill="none" stroke="black" points="75320.5,-948.5 74433.5,-948.5 74433.5,-880.5 75320.5,-880.5 75320.5,-948.5"/>
<text text-anchor="middle" x="74877" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="74877" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="74877" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="74877" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP1_GPU9_mha_ar&#45;&gt;L8_S1_TP1_GPU9_mha_res -->
<g id="edge2482" class="edge">
<title>L8_S1_TP1_GPU9_mha_ar&#45;&gt;L8_S1_TP1_GPU9_mha_res</title>
<path fill="none" stroke="black" d="M75297.51,-1015.91C75297.51,-1015.91 75297.51,-958.58 75297.51,-958.58"/>
<polygon fill="black" stroke="black" points="75301.01,-958.58 75297.51,-948.58 75294.01,-958.58 75301.01,-958.58"/>
</g>
<!-- L8_S1_TP1_GPU9_gate -->
<g id="node883" class="node">
<title>L8_S1_TP1_GPU9_gate</title>
<polygon fill="none" stroke="black" points="75406.56,-844.5 74564.15,-844.5 74347.44,-708.5 75189.85,-708.5 75406.56,-844.5"/>
<text text-anchor="middle" x="74877" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="74877" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="74877" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="74877" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L8_S1_TP1_GPU9_mha_res&#45;&gt;L8_S1_TP1_GPU9_gate -->
<g id="edge2483" class="edge">
<title>L8_S1_TP1_GPU9_mha_res&#45;&gt;L8_S1_TP1_GPU9_gate</title>
<path fill="none" stroke="black" d="M74877,-880.39C74877,-880.39 74877,-854.73 74877,-854.73"/>
<polygon fill="black" stroke="black" points="74880.5,-854.73 74877,-844.73 74873.5,-854.73 74880.5,-854.73"/>
</g>
<!-- L8_S1_TP1_GPU9_moe_res -->
<g id="node885" class="node">
<title>L8_S1_TP1_GPU9_moe_res</title>
<polygon fill="none" stroke="black" points="74933,-436.33 74113,-436.33 74113,-368.33 74933,-368.33 74933,-436.33"/>
<text text-anchor="middle" x="74523" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="74523" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="74523" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="74523" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP1_GPU9_mha_res&#45;&gt;L8_S1_TP1_GPU9_moe_res -->
<g id="edge2503" class="edge">
<title>L8_S1_TP1_GPU9_mha_res&#45;&gt;L8_S1_TP1_GPU9_moe_res</title>
<path fill="none" stroke="black" d="M74433.43,-914C74376.73,-914 74338,-914 74338,-914 74338,-914 74338,-683 74338,-683 74338,-683 74302.5,-683 74302.5,-683 74302.5,-683 74302.5,-446.47 74302.5,-446.47"/>
<polygon fill="black" stroke="black" points="74306,-446.47 74302.5,-436.47 74299,-446.47 74306,-446.47"/>
</g>
<!-- L8_S1_TP1_GPU9_gate&#45;&gt;L8_S1_TP1_GPU9_expert0 -->
<g id="edge2484" class="edge">
<title>L8_S1_TP1_GPU9_gate&#45;&gt;L8_S1_TP1_GPU9_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M75003,-708.31C75003,-708.31 75003,-682.71 75003,-682.71"/>
<polygon fill="black" stroke="black" points="75006.5,-682.71 75003,-672.71 74999.5,-682.71 75006.5,-682.71"/>
</g>
<!-- L8_S1_TP1_GPU9_gate&#45;&gt;L8_S1_TP1_GPU9_expert1 -->
<g id="edge2485" class="edge">
<title>L8_S1_TP1_GPU9_gate&#45;&gt;L8_S1_TP1_GPU9_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M75326.14,-776.4C75326.14,-776.4 75326.14,-682.74 75326.14,-682.74"/>
<polygon fill="black" stroke="black" points="75329.64,-682.74 75326.14,-672.74 75322.64,-682.74 75329.64,-682.74"/>
</g>
<!-- L8_S1_TP1_GPU9_moe_ar&#45;&gt;L8_S1_TP1_GPU9_moe_res -->
<g id="edge2502" class="edge">
<title>L8_S1_TP1_GPU9_moe_ar&#45;&gt;L8_S1_TP1_GPU9_moe_res</title>
<path fill="none" stroke="black" d="M75725.77,-474.8C75725.77,-455.33 75725.77,-437 75725.77,-437 75725.77,-437 74874.77,-437 74874.77,-437 74874.77,-437 74874.77,-436.96 74874.77,-436.96"/>
<polygon fill="black" stroke="black" points="74878.27,-446.61 74874.77,-436.61 74871.27,-446.61 74878.27,-446.61"/>
</g>
<!-- L8_S1_TP1_GPU9_norm -->
<g id="node886" class="node">
<title>L8_S1_TP1_GPU9_norm</title>
<polygon fill="none" stroke="black" points="74747.5,-332.33 74298.5,-332.33 74298.5,-264.33 74747.5,-264.33 74747.5,-332.33"/>
<text text-anchor="middle" x="74523" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="74523" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="74523" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="74523" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP1_GPU9_moe_res&#45;&gt;L8_S1_TP1_GPU9_norm -->
<g id="edge2504" class="edge">
<title>L8_S1_TP1_GPU9_moe_res&#45;&gt;L8_S1_TP1_GPU9_norm</title>
<path fill="none" stroke="black" d="M74523,-368.28C74523,-368.28 74523,-342.46 74523,-342.46"/>
<polygon fill="black" stroke="black" points="74526.5,-342.46 74523,-332.46 74519.5,-342.46 74526.5,-342.46"/>
</g>
<!-- L8_S1_TP2_GPU10_qkv_linear -->
<g id="node887" class="node">
<title>L8_S1_TP2_GPU10_qkv_linear</title>
<polygon fill="none" stroke="black" points="76285,-1614.75 75677,-1614.75 75677,-1546.75 76285,-1546.75 76285,-1614.75"/>
<text text-anchor="middle" x="75981" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="75981" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="75981" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="75981" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L8_S1_TP2_GPU10_qkv_slice -->
<g id="node888" class="node">
<title>L8_S1_TP2_GPU10_qkv_slice</title>
<polygon fill="none" stroke="black" points="76279,-1496.67 75683,-1496.67 75683,-1428.67 76279,-1428.67 76279,-1496.67"/>
<text text-anchor="middle" x="75981" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="75981" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="75981" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="75981" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L8_S1_TP2_GPU10_qkv_linear&#45;&gt;L8_S1_TP2_GPU10_qkv_slice -->
<g id="edge2505" class="edge">
<title>L8_S1_TP2_GPU10_qkv_linear&#45;&gt;L8_S1_TP2_GPU10_qkv_slice</title>
<path fill="none" stroke="black" d="M75981,-1546.59C75981,-1546.59 75981,-1506.74 75981,-1506.74"/>
<polygon fill="black" stroke="black" points="75984.5,-1506.74 75981,-1496.74 75977.5,-1506.74 75984.5,-1506.74"/>
</g>
<!-- L8_S1_TP2_GPU10_qkv_slice&#45;&gt;L8_S1_TP2_GPU10_attn_v -->
<g id="edge2509" class="edge">
<title>L8_S1_TP2_GPU10_qkv_slice&#45;&gt;L8_S1_TP2_GPU10_attn_v</title>
<path fill="none" stroke="black" d="M75733,-1428.38C75733,-1428.38 75733,-1195 75733,-1195"/>
<polygon fill="black" stroke="black" points="75736.5,-1195 75733,-1185 75729.5,-1195 75736.5,-1195"/>
</g>
<!-- L8_S1_TP2_GPU10_qk_matmul -->
<g id="node889" class="node">
<title>L8_S1_TP2_GPU10_qk_matmul</title>
<polygon fill="none" stroke="black" points="76696.5,-1392.67 75761.5,-1392.67 75761.5,-1324.67 76696.5,-1324.67 76696.5,-1392.67"/>
<text text-anchor="middle" x="76229" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="76229" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="76229" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="76229" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L8_S1_TP2_GPU10_qkv_slice&#45;&gt;L8_S1_TP2_GPU10_qk_matmul -->
<g id="edge2506" class="edge">
<title>L8_S1_TP2_GPU10_qkv_slice&#45;&gt;L8_S1_TP2_GPU10_qk_matmul</title>
<path fill="none" stroke="black" d="M76020.25,-1428.61C76020.25,-1428.61 76020.25,-1402.8 76020.25,-1402.8"/>
<polygon fill="black" stroke="black" points="76023.75,-1402.8 76020.25,-1392.8 76016.75,-1402.8 76023.75,-1402.8"/>
</g>
<!-- L8_S1_TP2_GPU10_softmax -->
<g id="node890" class="node">
<title>L8_S1_TP2_GPU10_softmax</title>
<polygon fill="none" stroke="black" points="76439,-1288.67 75929,-1288.67 75929,-1220.67 76439,-1220.67 76439,-1288.67"/>
<text text-anchor="middle" x="76184" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="76184" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="76184" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="76184" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L8_S1_TP2_GPU10_qk_matmul&#45;&gt;L8_S1_TP2_GPU10_softmax -->
<g id="edge2507" class="edge">
<title>L8_S1_TP2_GPU10_qk_matmul&#45;&gt;L8_S1_TP2_GPU10_softmax</title>
<path fill="none" stroke="black" d="M76184,-1324.61C76184,-1324.61 76184,-1298.8 76184,-1298.8"/>
<polygon fill="black" stroke="black" points="76187.5,-1298.8 76184,-1288.8 76180.5,-1298.8 76187.5,-1298.8"/>
</g>
<!-- L8_S1_TP2_GPU10_softmax&#45;&gt;L8_S1_TP2_GPU10_attn_v -->
<g id="edge2508" class="edge">
<title>L8_S1_TP2_GPU10_softmax&#45;&gt;L8_S1_TP2_GPU10_attn_v</title>
<path fill="none" stroke="black" d="M76184,-1220.61C76184,-1220.61 76184,-1194.8 76184,-1194.8"/>
<polygon fill="black" stroke="black" points="76187.5,-1194.8 76184,-1184.8 76180.5,-1194.8 76187.5,-1194.8"/>
</g>
<!-- L8_S1_TP2_GPU10_mha_res -->
<g id="node892" class="node">
<title>L8_S1_TP2_GPU10_mha_res</title>
<polygon fill="none" stroke="black" points="76398.5,-948.5 75511.5,-948.5 75511.5,-880.5 76398.5,-880.5 76398.5,-948.5"/>
<text text-anchor="middle" x="75955" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="75955" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="75955" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="75955" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP2_GPU10_mha_ar&#45;&gt;L8_S1_TP2_GPU10_mha_res -->
<g id="edge2518" class="edge">
<title>L8_S1_TP2_GPU10_mha_ar&#45;&gt;L8_S1_TP2_GPU10_mha_res</title>
<path fill="none" stroke="black" d="M76221.01,-991.61C76221.01,-991.61 76221.01,-958.74 76221.01,-958.74"/>
<polygon fill="black" stroke="black" points="76224.51,-958.74 76221.01,-948.74 76217.51,-958.74 76224.51,-958.74"/>
</g>
<!-- L8_S1_TP2_GPU10_gate -->
<g id="node893" class="node">
<title>L8_S1_TP2_GPU10_gate</title>
<polygon fill="none" stroke="black" points="76484.56,-844.5 75642.15,-844.5 75425.44,-708.5 76267.85,-708.5 76484.56,-844.5"/>
<text text-anchor="middle" x="75955" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="75955" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="75955" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="75955" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L8_S1_TP2_GPU10_mha_res&#45;&gt;L8_S1_TP2_GPU10_gate -->
<g id="edge2519" class="edge">
<title>L8_S1_TP2_GPU10_mha_res&#45;&gt;L8_S1_TP2_GPU10_gate</title>
<path fill="none" stroke="black" d="M75955,-880.39C75955,-880.39 75955,-854.73 75955,-854.73"/>
<polygon fill="black" stroke="black" points="75958.5,-854.73 75955,-844.73 75951.5,-854.73 75958.5,-854.73"/>
</g>
<!-- L8_S1_TP2_GPU10_moe_res -->
<g id="node895" class="node">
<title>L8_S1_TP2_GPU10_moe_res</title>
<polygon fill="none" stroke="black" points="75948,-436.33 75128,-436.33 75128,-368.33 75948,-368.33 75948,-436.33"/>
<text text-anchor="middle" x="75538" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="75538" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="75538" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="75538" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP2_GPU10_mha_res&#45;&gt;L8_S1_TP2_GPU10_moe_res -->
<g id="edge2539" class="edge">
<title>L8_S1_TP2_GPU10_mha_res&#45;&gt;L8_S1_TP2_GPU10_moe_res</title>
<path fill="none" stroke="black" d="M76398.57,-914C76455.27,-914 76494,-914 76494,-914 76494,-914 76494,-689 76494,-689 76494,-689 76174.81,-689 76174.81,-689 76174.81,-689 76174.81,-413 76174.81,-413 76174.81,-413 75958.05,-413 75958.05,-413"/>
<polygon fill="black" stroke="black" points="75958.05,-409.5 75948.05,-413 75958.05,-416.5 75958.05,-409.5"/>
</g>
<!-- L8_S1_TP2_GPU10_gate&#45;&gt;L8_S1_TP2_GPU10_expert0 -->
<g id="edge2520" class="edge">
<title>L8_S1_TP2_GPU10_gate&#45;&gt;L8_S1_TP2_GPU10_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M75787.33,-708.31C75787.33,-708.31 75787.33,-682.71 75787.33,-682.71"/>
<polygon fill="black" stroke="black" points="75790.83,-682.71 75787.33,-672.71 75783.83,-682.71 75790.83,-682.71"/>
</g>
<!-- L8_S1_TP2_GPU10_gate&#45;&gt;L8_S1_TP2_GPU10_expert1 -->
<g id="edge2521" class="edge">
<title>L8_S1_TP2_GPU10_gate&#45;&gt;L8_S1_TP2_GPU10_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M76332.14,-748.57C76332.14,-748.57 76332.14,-682.74 76332.14,-682.74"/>
<polygon fill="black" stroke="black" points="76335.64,-682.74 76332.14,-672.74 76328.64,-682.74 76335.64,-682.74"/>
</g>
<!-- L8_S1_TP2_GPU10_moe_ar&#45;&gt;L8_S1_TP2_GPU10_moe_res -->
<g id="edge2538" class="edge">
<title>L8_S1_TP2_GPU10_moe_ar&#45;&gt;L8_S1_TP2_GPU10_moe_res</title>
<path fill="none" stroke="black" d="M76449.77,-473.33C76449.77,-435.98 76449.77,-390 76449.77,-390 76449.77,-390 75958.21,-390 75958.21,-390"/>
<polygon fill="black" stroke="black" points="75958.21,-386.5 75948.21,-390 75958.21,-393.5 75958.21,-386.5"/>
</g>
<!-- L8_S1_TP2_GPU10_norm -->
<g id="node896" class="node">
<title>L8_S1_TP2_GPU10_norm</title>
<polygon fill="none" stroke="black" points="75762.5,-332.33 75313.5,-332.33 75313.5,-264.33 75762.5,-264.33 75762.5,-332.33"/>
<text text-anchor="middle" x="75538" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="75538" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="75538" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="75538" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP2_GPU10_moe_res&#45;&gt;L8_S1_TP2_GPU10_norm -->
<g id="edge2540" class="edge">
<title>L8_S1_TP2_GPU10_moe_res&#45;&gt;L8_S1_TP2_GPU10_norm</title>
<path fill="none" stroke="black" d="M75538,-368.28C75538,-368.28 75538,-342.46 75538,-342.46"/>
<polygon fill="black" stroke="black" points="75541.5,-342.46 75538,-332.46 75534.5,-342.46 75541.5,-342.46"/>
</g>
<!-- L8_S1_TP3_GPU11_qkv_linear -->
<g id="node897" class="node">
<title>L8_S1_TP3_GPU11_qkv_linear</title>
<polygon fill="none" stroke="black" points="77285,-1614.75 76677,-1614.75 76677,-1546.75 77285,-1546.75 77285,-1614.75"/>
<text text-anchor="middle" x="76981" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="76981" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="76981" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="76981" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L8_S1_TP3_GPU11_qkv_slice -->
<g id="node898" class="node">
<title>L8_S1_TP3_GPU11_qkv_slice</title>
<polygon fill="none" stroke="black" points="77279,-1496.67 76683,-1496.67 76683,-1428.67 77279,-1428.67 77279,-1496.67"/>
<text text-anchor="middle" x="76981" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="76981" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="76981" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="76981" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L8_S1_TP3_GPU11_qkv_linear&#45;&gt;L8_S1_TP3_GPU11_qkv_slice -->
<g id="edge2541" class="edge">
<title>L8_S1_TP3_GPU11_qkv_linear&#45;&gt;L8_S1_TP3_GPU11_qkv_slice</title>
<path fill="none" stroke="black" d="M76981,-1546.59C76981,-1546.59 76981,-1506.74 76981,-1506.74"/>
<polygon fill="black" stroke="black" points="76984.5,-1506.74 76981,-1496.74 76977.5,-1506.74 76984.5,-1506.74"/>
</g>
<!-- L8_S1_TP3_GPU11_qkv_slice&#45;&gt;L8_S1_TP3_GPU11_attn_v -->
<g id="edge2545" class="edge">
<title>L8_S1_TP3_GPU11_qkv_slice&#45;&gt;L8_S1_TP3_GPU11_attn_v</title>
<path fill="none" stroke="black" d="M76729,-1428.38C76729,-1428.38 76729,-1195 76729,-1195"/>
<polygon fill="black" stroke="black" points="76732.5,-1195 76729,-1185 76725.5,-1195 76732.5,-1195"/>
</g>
<!-- L8_S1_TP3_GPU11_qk_matmul -->
<g id="node899" class="node">
<title>L8_S1_TP3_GPU11_qk_matmul</title>
<polygon fill="none" stroke="black" points="77696.5,-1392.67 76761.5,-1392.67 76761.5,-1324.67 77696.5,-1324.67 77696.5,-1392.67"/>
<text text-anchor="middle" x="77229" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="77229" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="77229" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="77229" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L8_S1_TP3_GPU11_qkv_slice&#45;&gt;L8_S1_TP3_GPU11_qk_matmul -->
<g id="edge2542" class="edge">
<title>L8_S1_TP3_GPU11_qkv_slice&#45;&gt;L8_S1_TP3_GPU11_qk_matmul</title>
<path fill="none" stroke="black" d="M77020.25,-1428.61C77020.25,-1428.61 77020.25,-1402.8 77020.25,-1402.8"/>
<polygon fill="black" stroke="black" points="77023.75,-1402.8 77020.25,-1392.8 77016.75,-1402.8 77023.75,-1402.8"/>
</g>
<!-- L8_S1_TP3_GPU11_softmax -->
<g id="node900" class="node">
<title>L8_S1_TP3_GPU11_softmax</title>
<polygon fill="none" stroke="black" points="77417,-1288.67 76907,-1288.67 76907,-1220.67 77417,-1220.67 77417,-1288.67"/>
<text text-anchor="middle" x="77162" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="77162" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="77162" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="77162" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L8_S1_TP3_GPU11_qk_matmul&#45;&gt;L8_S1_TP3_GPU11_softmax -->
<g id="edge2543" class="edge">
<title>L8_S1_TP3_GPU11_qk_matmul&#45;&gt;L8_S1_TP3_GPU11_softmax</title>
<path fill="none" stroke="black" d="M77162,-1324.61C77162,-1324.61 77162,-1298.8 77162,-1298.8"/>
<polygon fill="black" stroke="black" points="77165.5,-1298.8 77162,-1288.8 77158.5,-1298.8 77165.5,-1298.8"/>
</g>
<!-- L8_S1_TP3_GPU11_softmax&#45;&gt;L8_S1_TP3_GPU11_attn_v -->
<g id="edge2544" class="edge">
<title>L8_S1_TP3_GPU11_softmax&#45;&gt;L8_S1_TP3_GPU11_attn_v</title>
<path fill="none" stroke="black" d="M77162,-1220.61C77162,-1220.61 77162,-1194.8 77162,-1194.8"/>
<polygon fill="black" stroke="black" points="77165.5,-1194.8 77162,-1184.8 77158.5,-1194.8 77165.5,-1194.8"/>
</g>
<!-- L8_S1_TP3_GPU11_mha_res -->
<g id="node902" class="node">
<title>L8_S1_TP3_GPU11_mha_res</title>
<polygon fill="none" stroke="black" points="77476.5,-948.5 76589.5,-948.5 76589.5,-880.5 77476.5,-880.5 77476.5,-948.5"/>
<text text-anchor="middle" x="77033" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="77033" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="77033" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="77033" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP3_GPU11_mha_ar&#45;&gt;L8_S1_TP3_GPU11_mha_res -->
<g id="edge2554" class="edge">
<title>L8_S1_TP3_GPU11_mha_ar&#45;&gt;L8_S1_TP3_GPU11_mha_res</title>
<path fill="none" stroke="black" d="M77144.51,-984.55C77144.51,-984.55 77144.51,-958.73 77144.51,-958.73"/>
<polygon fill="black" stroke="black" points="77148.01,-958.73 77144.51,-948.73 77141.01,-958.73 77148.01,-958.73"/>
</g>
<!-- L8_S1_TP3_GPU11_gate -->
<g id="node903" class="node">
<title>L8_S1_TP3_GPU11_gate</title>
<polygon fill="none" stroke="black" points="77562.56,-844.5 76720.15,-844.5 76503.44,-708.5 77345.85,-708.5 77562.56,-844.5"/>
<text text-anchor="middle" x="77033" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="77033" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="77033" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="77033" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L8_S1_TP3_GPU11_mha_res&#45;&gt;L8_S1_TP3_GPU11_gate -->
<g id="edge2555" class="edge">
<title>L8_S1_TP3_GPU11_mha_res&#45;&gt;L8_S1_TP3_GPU11_gate</title>
<path fill="none" stroke="black" d="M77033,-880.39C77033,-880.39 77033,-854.73 77033,-854.73"/>
<polygon fill="black" stroke="black" points="77036.5,-854.73 77033,-844.73 77029.5,-854.73 77036.5,-854.73"/>
</g>
<!-- L8_S1_TP3_GPU11_moe_res -->
<g id="node905" class="node">
<title>L8_S1_TP3_GPU11_moe_res</title>
<polygon fill="none" stroke="black" points="77529,-436.33 76709,-436.33 76709,-368.33 77529,-368.33 77529,-436.33"/>
<text text-anchor="middle" x="77119" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="77119" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="77119" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="77119" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP3_GPU11_mha_res&#45;&gt;L8_S1_TP3_GPU11_moe_res -->
<g id="edge2575" class="edge">
<title>L8_S1_TP3_GPU11_mha_res&#45;&gt;L8_S1_TP3_GPU11_moe_res</title>
<path fill="none" stroke="black" d="M77476.55,-903C77535.99,-903 77576.95,-903 77576.95,-903 77576.95,-903 77576.95,-580 77576.95,-580 77576.95,-580 77554.48,-580 77554.48,-580 77554.48,-580 77554.48,-390 77554.48,-390 77554.48,-390 77539.19,-390 77539.19,-390"/>
<polygon fill="black" stroke="black" points="77539.19,-386.5 77529.19,-390 77539.19,-393.5 77539.19,-386.5"/>
</g>
<!-- L8_S1_TP3_GPU11_gate&#45;&gt;L8_S1_TP3_GPU11_expert0 -->
<g id="edge2556" class="edge">
<title>L8_S1_TP3_GPU11_gate&#45;&gt;L8_S1_TP3_GPU11_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M76758.75,-708.31C76758.75,-708.31 76758.75,-682.71 76758.75,-682.71"/>
<polygon fill="black" stroke="black" points="76762.25,-682.71 76758.75,-672.71 76755.25,-682.71 76762.25,-682.71"/>
</g>
<!-- L8_S1_TP3_GPU11_gate&#45;&gt;L8_S1_TP3_GPU11_expert1 -->
<g id="edge2557" class="edge">
<title>L8_S1_TP3_GPU11_gate&#45;&gt;L8_S1_TP3_GPU11_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M77338,-708.31C77338,-708.31 77338,-682.71 77338,-682.71"/>
<polygon fill="black" stroke="black" points="77341.5,-682.71 77338,-672.71 77334.5,-682.71 77341.5,-682.71"/>
</g>
<!-- L8_S1_TP3_GPU11_moe_ar&#45;&gt;L8_S1_TP3_GPU11_moe_res -->
<g id="edge2574" class="edge">
<title>L8_S1_TP3_GPU11_moe_ar&#45;&gt;L8_S1_TP3_GPU11_moe_res</title>
<path fill="none" stroke="black" d="M77203.27,-472.05C77203.27,-472.05 77203.27,-446.37 77203.27,-446.37"/>
<polygon fill="black" stroke="black" points="77206.77,-446.37 77203.27,-436.37 77199.77,-446.37 77206.77,-446.37"/>
</g>
<!-- L8_S1_TP3_GPU11_norm -->
<g id="node906" class="node">
<title>L8_S1_TP3_GPU11_norm</title>
<polygon fill="none" stroke="black" points="77343.5,-332.33 76894.5,-332.33 76894.5,-264.33 77343.5,-264.33 77343.5,-332.33"/>
<text text-anchor="middle" x="77119" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="77119" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="77119" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="77119" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP3_GPU11_moe_res&#45;&gt;L8_S1_TP3_GPU11_norm -->
<g id="edge2576" class="edge">
<title>L8_S1_TP3_GPU11_moe_res&#45;&gt;L8_S1_TP3_GPU11_norm</title>
<path fill="none" stroke="black" d="M77119,-368.28C77119,-368.28 77119,-342.46 77119,-342.46"/>
<polygon fill="black" stroke="black" points="77122.5,-342.46 77119,-332.46 77115.5,-342.46 77122.5,-342.46"/>
</g>
<!-- L8_S1_TP4_GPU12_qkv_linear -->
<g id="node907" class="node">
<title>L8_S1_TP4_GPU12_qkv_linear</title>
<polygon fill="none" stroke="black" points="78281,-1614.75 77673,-1614.75 77673,-1546.75 78281,-1546.75 78281,-1614.75"/>
<text text-anchor="middle" x="77977" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="77977" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="77977" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="77977" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L8_S1_TP4_GPU12_qkv_slice -->
<g id="node908" class="node">
<title>L8_S1_TP4_GPU12_qkv_slice</title>
<polygon fill="none" stroke="black" points="78275,-1496.67 77679,-1496.67 77679,-1428.67 78275,-1428.67 78275,-1496.67"/>
<text text-anchor="middle" x="77977" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="77977" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="77977" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="77977" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L8_S1_TP4_GPU12_qkv_linear&#45;&gt;L8_S1_TP4_GPU12_qkv_slice -->
<g id="edge2577" class="edge">
<title>L8_S1_TP4_GPU12_qkv_linear&#45;&gt;L8_S1_TP4_GPU12_qkv_slice</title>
<path fill="none" stroke="black" d="M77977,-1546.59C77977,-1546.59 77977,-1506.74 77977,-1506.74"/>
<polygon fill="black" stroke="black" points="77980.5,-1506.74 77977,-1496.74 77973.5,-1506.74 77980.5,-1506.74"/>
</g>
<!-- L8_S1_TP4_GPU12_qkv_slice&#45;&gt;L8_S1_TP4_GPU12_attn_v -->
<g id="edge2581" class="edge">
<title>L8_S1_TP4_GPU12_qkv_slice&#45;&gt;L8_S1_TP4_GPU12_attn_v</title>
<path fill="none" stroke="black" d="M77727,-1428.38C77727,-1428.38 77727,-1195 77727,-1195"/>
<polygon fill="black" stroke="black" points="77730.5,-1195 77727,-1185 77723.5,-1195 77730.5,-1195"/>
</g>
<!-- L8_S1_TP4_GPU12_qk_matmul -->
<g id="node909" class="node">
<title>L8_S1_TP4_GPU12_qk_matmul</title>
<polygon fill="none" stroke="black" points="78692.5,-1392.67 77757.5,-1392.67 77757.5,-1324.67 78692.5,-1324.67 78692.5,-1392.67"/>
<text text-anchor="middle" x="78225" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="78225" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="78225" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="78225" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L8_S1_TP4_GPU12_qkv_slice&#45;&gt;L8_S1_TP4_GPU12_qk_matmul -->
<g id="edge2578" class="edge">
<title>L8_S1_TP4_GPU12_qkv_slice&#45;&gt;L8_S1_TP4_GPU12_qk_matmul</title>
<path fill="none" stroke="black" d="M78016.25,-1428.61C78016.25,-1428.61 78016.25,-1402.8 78016.25,-1402.8"/>
<polygon fill="black" stroke="black" points="78019.75,-1402.8 78016.25,-1392.8 78012.75,-1402.8 78019.75,-1402.8"/>
</g>
<!-- L8_S1_TP4_GPU12_softmax -->
<g id="node910" class="node">
<title>L8_S1_TP4_GPU12_softmax</title>
<polygon fill="none" stroke="black" points="78393,-1288.67 77883,-1288.67 77883,-1220.67 78393,-1220.67 78393,-1288.67"/>
<text text-anchor="middle" x="78138" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="78138" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="78138" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="78138" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L8_S1_TP4_GPU12_qk_matmul&#45;&gt;L8_S1_TP4_GPU12_softmax -->
<g id="edge2579" class="edge">
<title>L8_S1_TP4_GPU12_qk_matmul&#45;&gt;L8_S1_TP4_GPU12_softmax</title>
<path fill="none" stroke="black" d="M78138,-1324.61C78138,-1324.61 78138,-1298.8 78138,-1298.8"/>
<polygon fill="black" stroke="black" points="78141.5,-1298.8 78138,-1288.8 78134.5,-1298.8 78141.5,-1298.8"/>
</g>
<!-- L8_S1_TP4_GPU12_softmax&#45;&gt;L8_S1_TP4_GPU12_attn_v -->
<g id="edge2580" class="edge">
<title>L8_S1_TP4_GPU12_softmax&#45;&gt;L8_S1_TP4_GPU12_attn_v</title>
<path fill="none" stroke="black" d="M78138,-1220.61C78138,-1220.61 78138,-1194.8 78138,-1194.8"/>
<polygon fill="black" stroke="black" points="78141.5,-1194.8 78138,-1184.8 78134.5,-1194.8 78141.5,-1194.8"/>
</g>
<!-- L8_S1_TP4_GPU12_mha_res -->
<g id="node912" class="node">
<title>L8_S1_TP4_GPU12_mha_res</title>
<polygon fill="none" stroke="black" points="78554.5,-948.5 77667.5,-948.5 77667.5,-880.5 78554.5,-880.5 78554.5,-948.5"/>
<text text-anchor="middle" x="78111" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="78111" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="78111" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="78111" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP4_GPU12_mha_ar&#45;&gt;L8_S1_TP4_GPU12_mha_res -->
<g id="edge2590" class="edge">
<title>L8_S1_TP4_GPU12_mha_ar&#45;&gt;L8_S1_TP4_GPU12_mha_res</title>
<path fill="none" stroke="black" d="M77999.99,-984.55C77999.99,-984.55 77999.99,-958.73 77999.99,-958.73"/>
<polygon fill="black" stroke="black" points="78003.49,-958.73 77999.99,-948.73 77996.49,-958.73 78003.49,-958.73"/>
</g>
<!-- L8_S1_TP4_GPU12_gate -->
<g id="node913" class="node">
<title>L8_S1_TP4_GPU12_gate</title>
<polygon fill="none" stroke="black" points="78640.56,-844.5 77798.15,-844.5 77581.44,-708.5 78423.85,-708.5 78640.56,-844.5"/>
<text text-anchor="middle" x="78111" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="78111" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="78111" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="78111" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L8_S1_TP4_GPU12_mha_res&#45;&gt;L8_S1_TP4_GPU12_gate -->
<g id="edge2591" class="edge">
<title>L8_S1_TP4_GPU12_mha_res&#45;&gt;L8_S1_TP4_GPU12_gate</title>
<path fill="none" stroke="black" d="M78111,-880.39C78111,-880.39 78111,-854.73 78111,-854.73"/>
<polygon fill="black" stroke="black" points="78114.5,-854.73 78111,-844.73 78107.5,-854.73 78114.5,-854.73"/>
</g>
<!-- L8_S1_TP4_GPU12_moe_res -->
<g id="node915" class="node">
<title>L8_S1_TP4_GPU12_moe_res</title>
<polygon fill="none" stroke="black" points="78435,-436.33 77615,-436.33 77615,-368.33 78435,-368.33 78435,-436.33"/>
<text text-anchor="middle" x="78025" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="78025" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="78025" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="78025" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP4_GPU12_mha_res&#45;&gt;L8_S1_TP4_GPU12_moe_res -->
<g id="edge2611" class="edge">
<title>L8_S1_TP4_GPU12_mha_res&#45;&gt;L8_S1_TP4_GPU12_moe_res</title>
<path fill="none" stroke="black" d="M77667.22,-925C77614.37,-925 77578.73,-925 77578.73,-925 77578.73,-925 77578.73,-580 77578.73,-580 77578.73,-580 77558.49,-580 77558.49,-580 77558.49,-580 77558.49,-413 77558.49,-413 77558.49,-413 77604.76,-413 77604.76,-413"/>
<polygon fill="black" stroke="black" points="77604.76,-416.5 77614.76,-413 77604.76,-409.5 77604.76,-416.5"/>
</g>
<!-- L8_S1_TP4_GPU12_gate&#45;&gt;L8_S1_TP4_GPU12_expert0 -->
<g id="edge2592" class="edge">
<title>L8_S1_TP4_GPU12_gate&#45;&gt;L8_S1_TP4_GPU12_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M77917.43,-708.31C77917.43,-708.31 77917.43,-682.71 77917.43,-682.71"/>
<polygon fill="black" stroke="black" points="77920.93,-682.71 77917.43,-672.71 77913.93,-682.71 77920.93,-682.71"/>
</g>
<!-- L8_S1_TP4_GPU12_gate&#45;&gt;L8_S1_TP4_GPU12_expert1 -->
<g id="edge2593" class="edge">
<title>L8_S1_TP4_GPU12_gate&#45;&gt;L8_S1_TP4_GPU12_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M78272,-708.31C78272,-708.31 78272,-682.71 78272,-682.71"/>
<polygon fill="black" stroke="black" points="78275.5,-682.71 78272,-672.71 78268.5,-682.71 78275.5,-682.71"/>
</g>
<!-- L8_S1_TP4_GPU12_moe_ar&#45;&gt;L8_S1_TP4_GPU12_moe_res -->
<g id="edge2610" class="edge">
<title>L8_S1_TP4_GPU12_moe_ar&#45;&gt;L8_S1_TP4_GPU12_moe_res</title>
<path fill="none" stroke="black" d="M77924.23,-472.39C77924.23,-472.39 77924.23,-446.57 77924.23,-446.57"/>
<polygon fill="black" stroke="black" points="77927.73,-446.57 77924.23,-436.57 77920.73,-446.57 77927.73,-446.57"/>
</g>
<!-- L8_S1_TP4_GPU12_norm -->
<g id="node916" class="node">
<title>L8_S1_TP4_GPU12_norm</title>
<polygon fill="none" stroke="black" points="78249.5,-332.33 77800.5,-332.33 77800.5,-264.33 78249.5,-264.33 78249.5,-332.33"/>
<text text-anchor="middle" x="78025" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="78025" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="78025" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="78025" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP4_GPU12_moe_res&#45;&gt;L8_S1_TP4_GPU12_norm -->
<g id="edge2612" class="edge">
<title>L8_S1_TP4_GPU12_moe_res&#45;&gt;L8_S1_TP4_GPU12_norm</title>
<path fill="none" stroke="black" d="M78025,-368.28C78025,-368.28 78025,-342.46 78025,-342.46"/>
<polygon fill="black" stroke="black" points="78028.5,-342.46 78025,-332.46 78021.5,-342.46 78028.5,-342.46"/>
</g>
<!-- L8_S1_TP5_GPU13_qkv_linear -->
<g id="node917" class="node">
<title>L8_S1_TP5_GPU13_qkv_linear</title>
<polygon fill="none" stroke="black" points="79301,-1614.75 78693,-1614.75 78693,-1546.75 79301,-1546.75 79301,-1614.75"/>
<text text-anchor="middle" x="78997" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="78997" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="78997" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="78997" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L8_S1_TP5_GPU13_qkv_slice -->
<g id="node918" class="node">
<title>L8_S1_TP5_GPU13_qkv_slice</title>
<polygon fill="none" stroke="black" points="79295,-1496.67 78699,-1496.67 78699,-1428.67 79295,-1428.67 79295,-1496.67"/>
<text text-anchor="middle" x="78997" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="78997" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="78997" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="78997" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L8_S1_TP5_GPU13_qkv_linear&#45;&gt;L8_S1_TP5_GPU13_qkv_slice -->
<g id="edge2613" class="edge">
<title>L8_S1_TP5_GPU13_qkv_linear&#45;&gt;L8_S1_TP5_GPU13_qkv_slice</title>
<path fill="none" stroke="black" d="M78997,-1546.59C78997,-1546.59 78997,-1506.74 78997,-1506.74"/>
<polygon fill="black" stroke="black" points="79000.5,-1506.74 78997,-1496.74 78993.5,-1506.74 79000.5,-1506.74"/>
</g>
<!-- L8_S1_TP5_GPU13_qkv_slice&#45;&gt;L8_S1_TP5_GPU13_attn_v -->
<g id="edge2617" class="edge">
<title>L8_S1_TP5_GPU13_qkv_slice&#45;&gt;L8_S1_TP5_GPU13_attn_v</title>
<path fill="none" stroke="black" d="M78738.25,-1428.38C78738.25,-1428.38 78738.25,-1195 78738.25,-1195"/>
<polygon fill="black" stroke="black" points="78741.75,-1195 78738.25,-1185 78734.75,-1195 78741.75,-1195"/>
</g>
<!-- L8_S1_TP5_GPU13_qk_matmul -->
<g id="node919" class="node">
<title>L8_S1_TP5_GPU13_qk_matmul</title>
<polygon fill="none" stroke="black" points="79712.5,-1392.67 78777.5,-1392.67 78777.5,-1324.67 79712.5,-1324.67 79712.5,-1392.67"/>
<text text-anchor="middle" x="79245" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="79245" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="79245" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="79245" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L8_S1_TP5_GPU13_qkv_slice&#45;&gt;L8_S1_TP5_GPU13_qk_matmul -->
<g id="edge2614" class="edge">
<title>L8_S1_TP5_GPU13_qkv_slice&#45;&gt;L8_S1_TP5_GPU13_qk_matmul</title>
<path fill="none" stroke="black" d="M79036.25,-1428.61C79036.25,-1428.61 79036.25,-1402.8 79036.25,-1402.8"/>
<polygon fill="black" stroke="black" points="79039.75,-1402.8 79036.25,-1392.8 79032.75,-1402.8 79039.75,-1402.8"/>
</g>
<!-- L8_S1_TP5_GPU13_softmax -->
<g id="node920" class="node">
<title>L8_S1_TP5_GPU13_softmax</title>
<polygon fill="none" stroke="black" points="79289,-1288.67 78779,-1288.67 78779,-1220.67 79289,-1220.67 79289,-1288.67"/>
<text text-anchor="middle" x="79034" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="79034" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="79034" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="79034" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L8_S1_TP5_GPU13_qk_matmul&#45;&gt;L8_S1_TP5_GPU13_softmax -->
<g id="edge2615" class="edge">
<title>L8_S1_TP5_GPU13_qk_matmul&#45;&gt;L8_S1_TP5_GPU13_softmax</title>
<path fill="none" stroke="black" d="M79034,-1324.61C79034,-1324.61 79034,-1298.8 79034,-1298.8"/>
<polygon fill="black" stroke="black" points="79037.5,-1298.8 79034,-1288.8 79030.5,-1298.8 79037.5,-1298.8"/>
</g>
<!-- L8_S1_TP5_GPU13_softmax&#45;&gt;L8_S1_TP5_GPU13_attn_v -->
<g id="edge2616" class="edge">
<title>L8_S1_TP5_GPU13_softmax&#45;&gt;L8_S1_TP5_GPU13_attn_v</title>
<path fill="none" stroke="black" d="M79034,-1220.61C79034,-1220.61 79034,-1194.8 79034,-1194.8"/>
<polygon fill="black" stroke="black" points="79037.5,-1194.8 79034,-1184.8 79030.5,-1194.8 79037.5,-1194.8"/>
</g>
<!-- L8_S1_TP5_GPU13_mha_res -->
<g id="node922" class="node">
<title>L8_S1_TP5_GPU13_mha_res</title>
<polygon fill="none" stroke="black" points="79632.5,-948.5 78745.5,-948.5 78745.5,-880.5 79632.5,-880.5 79632.5,-948.5"/>
<text text-anchor="middle" x="79189" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="79189" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="79189" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="79189" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP5_GPU13_mha_ar&#45;&gt;L8_S1_TP5_GPU13_mha_res -->
<g id="edge2626" class="edge">
<title>L8_S1_TP5_GPU13_mha_ar&#45;&gt;L8_S1_TP5_GPU13_mha_res</title>
<path fill="none" stroke="black" d="M78923.49,-991.61C78923.49,-991.61 78923.49,-958.74 78923.49,-958.74"/>
<polygon fill="black" stroke="black" points="78926.99,-958.74 78923.49,-948.74 78919.99,-958.74 78926.99,-958.74"/>
</g>
<!-- L8_S1_TP5_GPU13_gate -->
<g id="node923" class="node">
<title>L8_S1_TP5_GPU13_gate</title>
<polygon fill="none" stroke="black" points="79718.56,-844.5 78876.15,-844.5 78659.44,-708.5 79501.85,-708.5 79718.56,-844.5"/>
<text text-anchor="middle" x="79189" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="79189" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="79189" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="79189" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L8_S1_TP5_GPU13_mha_res&#45;&gt;L8_S1_TP5_GPU13_gate -->
<g id="edge2627" class="edge">
<title>L8_S1_TP5_GPU13_mha_res&#45;&gt;L8_S1_TP5_GPU13_gate</title>
<path fill="none" stroke="black" d="M79189,-880.39C79189,-880.39 79189,-854.73 79189,-854.73"/>
<polygon fill="black" stroke="black" points="79192.5,-854.73 79189,-844.73 79185.5,-854.73 79192.5,-854.73"/>
</g>
<!-- L8_S1_TP5_GPU13_moe_res -->
<g id="node925" class="node">
<title>L8_S1_TP5_GPU13_moe_res</title>
<polygon fill="none" stroke="black" points="79465,-436.33 78645,-436.33 78645,-368.33 79465,-368.33 79465,-436.33"/>
<text text-anchor="middle" x="79055" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="79055" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="79055" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="79055" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP5_GPU13_mha_res&#45;&gt;L8_S1_TP5_GPU13_moe_res -->
<g id="edge2647" class="edge">
<title>L8_S1_TP5_GPU13_mha_res&#45;&gt;L8_S1_TP5_GPU13_moe_res</title>
<path fill="none" stroke="black" d="M78745.43,-914C78688.73,-914 78650,-914 78650,-914 78650,-914 78650,-680 78650,-680 78650,-680 78966.5,-680 78966.5,-680 78966.5,-680 78966.5,-587 78966.5,-587 78966.5,-587 78929.5,-587 78929.5,-587 78929.5,-587 78929.5,-446.63 78929.5,-446.63"/>
<polygon fill="black" stroke="black" points="78933,-446.63 78929.5,-436.63 78926,-446.63 78933,-446.63"/>
</g>
<!-- L8_S1_TP5_GPU13_gate&#45;&gt;L8_S1_TP5_GPU13_expert0 -->
<g id="edge2628" class="edge">
<title>L8_S1_TP5_GPU13_gate&#45;&gt;L8_S1_TP5_GPU13_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M78811.36,-708.31C78811.36,-708.31 78811.36,-682.71 78811.36,-682.71"/>
<polygon fill="black" stroke="black" points="78814.86,-682.71 78811.36,-672.71 78807.86,-682.71 78814.86,-682.71"/>
</g>
<!-- L8_S1_TP5_GPU13_gate&#45;&gt;L8_S1_TP5_GPU13_expert1 -->
<g id="edge2629" class="edge">
<title>L8_S1_TP5_GPU13_gate&#45;&gt;L8_S1_TP5_GPU13_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M79280.83,-708.31C79280.83,-708.31 79280.83,-682.71 79280.83,-682.71"/>
<polygon fill="black" stroke="black" points="79284.33,-682.71 79280.83,-672.71 79277.33,-682.71 79284.33,-682.71"/>
</g>
<!-- L8_S1_TP5_GPU13_moe_ar&#45;&gt;L8_S1_TP5_GPU13_moe_res -->
<g id="edge2646" class="edge">
<title>L8_S1_TP5_GPU13_moe_ar&#45;&gt;L8_S1_TP5_GPU13_moe_res</title>
<path fill="none" stroke="black" d="M78736.82,-477.45C78736.82,-477.45 78736.82,-446.57 78736.82,-446.57"/>
<polygon fill="black" stroke="black" points="78740.32,-446.57 78736.82,-436.57 78733.32,-446.57 78740.32,-446.57"/>
</g>
<!-- L8_S1_TP5_GPU13_norm -->
<g id="node926" class="node">
<title>L8_S1_TP5_GPU13_norm</title>
<polygon fill="none" stroke="black" points="79279.5,-332.33 78830.5,-332.33 78830.5,-264.33 79279.5,-264.33 79279.5,-332.33"/>
<text text-anchor="middle" x="79055" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="79055" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="79055" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="79055" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP5_GPU13_moe_res&#45;&gt;L8_S1_TP5_GPU13_norm -->
<g id="edge2648" class="edge">
<title>L8_S1_TP5_GPU13_moe_res&#45;&gt;L8_S1_TP5_GPU13_norm</title>
<path fill="none" stroke="black" d="M79055,-368.28C79055,-368.28 79055,-342.46 79055,-342.46"/>
<polygon fill="black" stroke="black" points="79058.5,-342.46 79055,-332.46 79051.5,-342.46 79058.5,-342.46"/>
</g>
<!-- L8_S1_TP6_GPU14_qkv_linear -->
<g id="node927" class="node">
<title>L8_S1_TP6_GPU14_qkv_linear</title>
<polygon fill="none" stroke="black" points="80321,-1614.75 79713,-1614.75 79713,-1546.75 80321,-1546.75 80321,-1614.75"/>
<text text-anchor="middle" x="80017" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="80017" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="80017" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="80017" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L8_S1_TP6_GPU14_qkv_slice -->
<g id="node928" class="node">
<title>L8_S1_TP6_GPU14_qkv_slice</title>
<polygon fill="none" stroke="black" points="80315,-1496.67 79719,-1496.67 79719,-1428.67 80315,-1428.67 80315,-1496.67"/>
<text text-anchor="middle" x="80017" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="80017" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="80017" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="80017" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L8_S1_TP6_GPU14_qkv_linear&#45;&gt;L8_S1_TP6_GPU14_qkv_slice -->
<g id="edge2649" class="edge">
<title>L8_S1_TP6_GPU14_qkv_linear&#45;&gt;L8_S1_TP6_GPU14_qkv_slice</title>
<path fill="none" stroke="black" d="M80017,-1546.59C80017,-1546.59 80017,-1506.74 80017,-1506.74"/>
<polygon fill="black" stroke="black" points="80020.5,-1506.74 80017,-1496.74 80013.5,-1506.74 80020.5,-1506.74"/>
</g>
<!-- L8_S1_TP6_GPU14_qkv_slice&#45;&gt;L8_S1_TP6_GPU14_attn_v -->
<g id="edge2653" class="edge">
<title>L8_S1_TP6_GPU14_qkv_slice&#45;&gt;L8_S1_TP6_GPU14_attn_v</title>
<path fill="none" stroke="black" d="M79758.25,-1428.38C79758.25,-1428.38 79758.25,-1195 79758.25,-1195"/>
<polygon fill="black" stroke="black" points="79761.75,-1195 79758.25,-1185 79754.75,-1195 79761.75,-1195"/>
</g>
<!-- L8_S1_TP6_GPU14_qk_matmul -->
<g id="node929" class="node">
<title>L8_S1_TP6_GPU14_qk_matmul</title>
<polygon fill="none" stroke="black" points="80732.5,-1392.67 79797.5,-1392.67 79797.5,-1324.67 80732.5,-1324.67 80732.5,-1392.67"/>
<text text-anchor="middle" x="80265" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="80265" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="80265" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="80265" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L8_S1_TP6_GPU14_qkv_slice&#45;&gt;L8_S1_TP6_GPU14_qk_matmul -->
<g id="edge2650" class="edge">
<title>L8_S1_TP6_GPU14_qkv_slice&#45;&gt;L8_S1_TP6_GPU14_qk_matmul</title>
<path fill="none" stroke="black" d="M80056.25,-1428.61C80056.25,-1428.61 80056.25,-1402.8 80056.25,-1402.8"/>
<polygon fill="black" stroke="black" points="80059.75,-1402.8 80056.25,-1392.8 80052.75,-1402.8 80059.75,-1402.8"/>
</g>
<!-- L8_S1_TP6_GPU14_softmax -->
<g id="node930" class="node">
<title>L8_S1_TP6_GPU14_softmax</title>
<polygon fill="none" stroke="black" points="80413,-1288.67 79903,-1288.67 79903,-1220.67 80413,-1220.67 80413,-1288.67"/>
<text text-anchor="middle" x="80158" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="80158" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="80158" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="80158" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L8_S1_TP6_GPU14_qk_matmul&#45;&gt;L8_S1_TP6_GPU14_softmax -->
<g id="edge2651" class="edge">
<title>L8_S1_TP6_GPU14_qk_matmul&#45;&gt;L8_S1_TP6_GPU14_softmax</title>
<path fill="none" stroke="black" d="M80158,-1324.61C80158,-1324.61 80158,-1298.8 80158,-1298.8"/>
<polygon fill="black" stroke="black" points="80161.5,-1298.8 80158,-1288.8 80154.5,-1298.8 80161.5,-1298.8"/>
</g>
<!-- L8_S1_TP6_GPU14_softmax&#45;&gt;L8_S1_TP6_GPU14_attn_v -->
<g id="edge2652" class="edge">
<title>L8_S1_TP6_GPU14_softmax&#45;&gt;L8_S1_TP6_GPU14_attn_v</title>
<path fill="none" stroke="black" d="M80158,-1220.61C80158,-1220.61 80158,-1194.8 80158,-1194.8"/>
<polygon fill="black" stroke="black" points="80161.5,-1194.8 80158,-1184.8 80154.5,-1194.8 80161.5,-1194.8"/>
</g>
<!-- L8_S1_TP6_GPU14_mha_res -->
<g id="node932" class="node">
<title>L8_S1_TP6_GPU14_mha_res</title>
<polygon fill="none" stroke="black" points="80710.5,-948.5 79823.5,-948.5 79823.5,-880.5 80710.5,-880.5 80710.5,-948.5"/>
<text text-anchor="middle" x="80267" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="80267" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="80267" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="80267" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP6_GPU14_mha_ar&#45;&gt;L8_S1_TP6_GPU14_mha_res -->
<g id="edge2662" class="edge">
<title>L8_S1_TP6_GPU14_mha_ar&#45;&gt;L8_S1_TP6_GPU14_mha_res</title>
<path fill="none" stroke="black" d="M79846.99,-1015.66C79846.99,-1015.66 79846.99,-958.91 79846.99,-958.91"/>
<polygon fill="black" stroke="black" points="79850.49,-958.91 79846.99,-948.91 79843.49,-958.91 79850.49,-958.91"/>
</g>
<!-- L8_S1_TP6_GPU14_gate -->
<g id="node933" class="node">
<title>L8_S1_TP6_GPU14_gate</title>
<polygon fill="none" stroke="black" points="80796.56,-844.5 79954.15,-844.5 79737.44,-708.5 80579.85,-708.5 80796.56,-844.5"/>
<text text-anchor="middle" x="80267" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="80267" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="80267" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="80267" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L8_S1_TP6_GPU14_mha_res&#45;&gt;L8_S1_TP6_GPU14_gate -->
<g id="edge2663" class="edge">
<title>L8_S1_TP6_GPU14_mha_res&#45;&gt;L8_S1_TP6_GPU14_gate</title>
<path fill="none" stroke="black" d="M80267,-880.39C80267,-880.39 80267,-854.73 80267,-854.73"/>
<polygon fill="black" stroke="black" points="80270.5,-854.73 80267,-844.73 80263.5,-854.73 80270.5,-854.73"/>
</g>
<!-- L8_S1_TP6_GPU14_moe_res -->
<g id="node935" class="node">
<title>L8_S1_TP6_GPU14_moe_res</title>
<polygon fill="none" stroke="black" points="81071,-436.33 80251,-436.33 80251,-368.33 81071,-368.33 81071,-436.33"/>
<text text-anchor="middle" x="80661" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="80661" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="80661" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="80661" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP6_GPU14_mha_res&#45;&gt;L8_S1_TP6_GPU14_moe_res -->
<g id="edge2683" class="edge">
<title>L8_S1_TP6_GPU14_mha_res&#45;&gt;L8_S1_TP6_GPU14_moe_res</title>
<path fill="none" stroke="black" d="M80710.57,-914C80767.27,-914 80806,-914 80806,-914 80806,-914 80806,-686 80806,-686 80806,-686 80840.5,-686 80840.5,-686 80840.5,-686 80840.5,-446.55 80840.5,-446.55"/>
<polygon fill="black" stroke="black" points="80844,-446.55 80840.5,-436.55 80837,-446.55 80844,-446.55"/>
</g>
<!-- L8_S1_TP6_GPU14_gate&#45;&gt;L8_S1_TP6_GPU14_expert0 -->
<g id="edge2664" class="edge">
<title>L8_S1_TP6_GPU14_gate&#45;&gt;L8_S1_TP6_GPU14_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M79817.36,-708.31C79817.36,-708.31 79817.36,-682.71 79817.36,-682.71"/>
<polygon fill="black" stroke="black" points="79820.86,-682.71 79817.36,-672.71 79813.86,-682.71 79820.86,-682.71"/>
</g>
<!-- L8_S1_TP6_GPU14_gate&#45;&gt;L8_S1_TP6_GPU14_expert1 -->
<g id="edge2665" class="edge">
<title>L8_S1_TP6_GPU14_gate&#45;&gt;L8_S1_TP6_GPU14_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M80214.83,-708.31C80214.83,-708.31 80214.83,-682.71 80214.83,-682.71"/>
<polygon fill="black" stroke="black" points="80218.33,-682.71 80214.83,-672.71 80211.33,-682.71 80218.33,-682.71"/>
</g>
<!-- L8_S1_TP6_GPU14_moe_ar&#45;&gt;L8_S1_TP6_GPU14_moe_res -->
<g id="edge2682" class="edge">
<title>L8_S1_TP6_GPU14_moe_ar&#45;&gt;L8_S1_TP6_GPU14_moe_res</title>
<path fill="none" stroke="black" d="M79536.23,-490.53C79536.23,-455.46 79536.23,-402 79536.23,-402 79536.23,-402 80240.95,-402 80240.95,-402"/>
<polygon fill="black" stroke="black" points="80240.95,-405.5 80250.95,-402 80240.95,-398.5 80240.95,-405.5"/>
</g>
<!-- L8_S1_TP6_GPU14_norm -->
<g id="node936" class="node">
<title>L8_S1_TP6_GPU14_norm</title>
<polygon fill="none" stroke="black" points="80885.5,-332.33 80436.5,-332.33 80436.5,-264.33 80885.5,-264.33 80885.5,-332.33"/>
<text text-anchor="middle" x="80661" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="80661" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="80661" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="80661" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP6_GPU14_moe_res&#45;&gt;L8_S1_TP6_GPU14_norm -->
<g id="edge2684" class="edge">
<title>L8_S1_TP6_GPU14_moe_res&#45;&gt;L8_S1_TP6_GPU14_norm</title>
<path fill="none" stroke="black" d="M80661,-368.28C80661,-368.28 80661,-342.46 80661,-342.46"/>
<polygon fill="black" stroke="black" points="80664.5,-342.46 80661,-332.46 80657.5,-342.46 80664.5,-342.46"/>
</g>
<!-- L8_S1_TP7_GPU15_qkv_linear -->
<g id="node937" class="node">
<title>L8_S1_TP7_GPU15_qkv_linear</title>
<polygon fill="none" stroke="black" points="81366,-1614.75 80758,-1614.75 80758,-1546.75 81366,-1546.75 81366,-1614.75"/>
<text text-anchor="middle" x="81062" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="81062" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="81062" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="81062" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L8_S1_TP7_GPU15_qkv_slice -->
<g id="node938" class="node">
<title>L8_S1_TP7_GPU15_qkv_slice</title>
<polygon fill="none" stroke="black" points="81360,-1496.67 80764,-1496.67 80764,-1428.67 81360,-1428.67 81360,-1496.67"/>
<text text-anchor="middle" x="81062" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="81062" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="81062" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="81062" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L8_S1_TP7_GPU15_qkv_linear&#45;&gt;L8_S1_TP7_GPU15_qkv_slice -->
<g id="edge2685" class="edge">
<title>L8_S1_TP7_GPU15_qkv_linear&#45;&gt;L8_S1_TP7_GPU15_qkv_slice</title>
<path fill="none" stroke="black" d="M81062,-1546.59C81062,-1546.59 81062,-1506.74 81062,-1506.74"/>
<polygon fill="black" stroke="black" points="81065.5,-1506.74 81062,-1496.74 81058.5,-1506.74 81065.5,-1506.74"/>
</g>
<!-- L8_S1_TP7_GPU15_qkv_slice&#45;&gt;L8_S1_TP7_GPU15_attn_v -->
<g id="edge2689" class="edge">
<title>L8_S1_TP7_GPU15_qkv_slice&#45;&gt;L8_S1_TP7_GPU15_attn_v</title>
<path fill="none" stroke="black" d="M80803.25,-1428.38C80803.25,-1428.38 80803.25,-1195 80803.25,-1195"/>
<polygon fill="black" stroke="black" points="80806.75,-1195 80803.25,-1185 80799.75,-1195 80806.75,-1195"/>
</g>
<!-- L8_S1_TP7_GPU15_qk_matmul -->
<g id="node939" class="node">
<title>L8_S1_TP7_GPU15_qk_matmul</title>
<polygon fill="none" stroke="black" points="81777.5,-1392.67 80842.5,-1392.67 80842.5,-1324.67 81777.5,-1324.67 81777.5,-1392.67"/>
<text text-anchor="middle" x="81310" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="81310" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="81310" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="81310" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L8_S1_TP7_GPU15_qkv_slice&#45;&gt;L8_S1_TP7_GPU15_qk_matmul -->
<g id="edge2686" class="edge">
<title>L8_S1_TP7_GPU15_qkv_slice&#45;&gt;L8_S1_TP7_GPU15_qk_matmul</title>
<path fill="none" stroke="black" d="M81101.25,-1428.61C81101.25,-1428.61 81101.25,-1402.8 81101.25,-1402.8"/>
<polygon fill="black" stroke="black" points="81104.75,-1402.8 81101.25,-1392.8 81097.75,-1402.8 81104.75,-1402.8"/>
</g>
<!-- L8_S1_TP7_GPU15_softmax -->
<g id="node940" class="node">
<title>L8_S1_TP7_GPU15_softmax</title>
<polygon fill="none" stroke="black" points="81458,-1288.67 80948,-1288.67 80948,-1220.67 81458,-1220.67 81458,-1288.67"/>
<text text-anchor="middle" x="81203" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="81203" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="81203" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="81203" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L8_S1_TP7_GPU15_qk_matmul&#45;&gt;L8_S1_TP7_GPU15_softmax -->
<g id="edge2687" class="edge">
<title>L8_S1_TP7_GPU15_qk_matmul&#45;&gt;L8_S1_TP7_GPU15_softmax</title>
<path fill="none" stroke="black" d="M81203,-1324.61C81203,-1324.61 81203,-1298.8 81203,-1298.8"/>
<polygon fill="black" stroke="black" points="81206.5,-1298.8 81203,-1288.8 81199.5,-1298.8 81206.5,-1298.8"/>
</g>
<!-- L8_S1_TP7_GPU15_softmax&#45;&gt;L8_S1_TP7_GPU15_attn_v -->
<g id="edge2688" class="edge">
<title>L8_S1_TP7_GPU15_softmax&#45;&gt;L8_S1_TP7_GPU15_attn_v</title>
<path fill="none" stroke="black" d="M81168,-1220.61C81168,-1220.61 81168,-1194.8 81168,-1194.8"/>
<polygon fill="black" stroke="black" points="81171.5,-1194.8 81168,-1184.8 81164.5,-1194.8 81171.5,-1194.8"/>
</g>
<!-- L8_S1_TP7_GPU15_mha_res -->
<g id="node942" class="node">
<title>L8_S1_TP7_GPU15_mha_res</title>
<polygon fill="none" stroke="black" points="81788.5,-948.5 80901.5,-948.5 80901.5,-880.5 81788.5,-880.5 81788.5,-948.5"/>
<text text-anchor="middle" x="81345" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="81345" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="81345" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="81345" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP7_GPU15_mha_ar&#45;&gt;L8_S1_TP7_GPU15_mha_res -->
<g id="edge2698" class="edge">
<title>L8_S1_TP7_GPU15_mha_ar&#45;&gt;L8_S1_TP7_GPU15_mha_res</title>
<path fill="none" stroke="black" d="M80616.53,-1016C80861.7,-1016 81144.75,-1016 81144.75,-1016 81144.75,-1016 81144.75,-958.58 81144.75,-958.58"/>
<polygon fill="black" stroke="black" points="81148.25,-958.58 81144.75,-948.58 81141.25,-958.58 81148.25,-958.58"/>
</g>
<!-- L8_S1_TP7_GPU15_gate -->
<g id="node943" class="node">
<title>L8_S1_TP7_GPU15_gate</title>
<polygon fill="none" stroke="black" points="81874.56,-844.5 81032.15,-844.5 80815.44,-708.5 81657.85,-708.5 81874.56,-844.5"/>
<text text-anchor="middle" x="81345" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="81345" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="81345" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="81345" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L8_S1_TP7_GPU15_mha_res&#45;&gt;L8_S1_TP7_GPU15_gate -->
<g id="edge2699" class="edge">
<title>L8_S1_TP7_GPU15_mha_res&#45;&gt;L8_S1_TP7_GPU15_gate</title>
<path fill="none" stroke="black" d="M81345,-880.39C81345,-880.39 81345,-854.73 81345,-854.73"/>
<polygon fill="black" stroke="black" points="81348.5,-854.73 81345,-844.73 81341.5,-854.73 81348.5,-854.73"/>
</g>
<!-- L8_S1_TP7_GPU15_moe_res -->
<g id="node945" class="node">
<title>L8_S1_TP7_GPU15_moe_res</title>
<polygon fill="none" stroke="black" points="82293,-436.33 81473,-436.33 81473,-368.33 82293,-368.33 82293,-436.33"/>
<text text-anchor="middle" x="81883" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="81883" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="81883" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="81883" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP7_GPU15_mha_res&#45;&gt;L8_S1_TP7_GPU15_moe_res -->
<g id="edge2719" class="edge">
<title>L8_S1_TP7_GPU15_mha_res&#45;&gt;L8_S1_TP7_GPU15_moe_res</title>
<path fill="none" stroke="black" d="M81788.68,-925C81945.6,-925 82083.89,-925 82083.89,-925 82083.89,-925 82083.89,-446.63 82083.89,-446.63"/>
<polygon fill="black" stroke="black" points="82087.39,-446.63 82083.89,-436.63 82080.39,-446.63 82087.39,-446.63"/>
</g>
<!-- L8_S1_TP7_GPU15_gate&#45;&gt;L8_S1_TP7_GPU15_expert0 -->
<g id="edge2700" class="edge">
<title>L8_S1_TP7_GPU15_gate&#45;&gt;L8_S1_TP7_GPU15_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M80823.36,-776.4C80823.36,-776.4 80823.36,-682.74 80823.36,-682.74"/>
<polygon fill="black" stroke="black" points="80826.86,-682.74 80823.36,-672.74 80819.86,-682.74 80826.86,-682.74"/>
</g>
<!-- L8_S1_TP7_GPU15_gate&#45;&gt;L8_S1_TP7_GPU15_expert1 -->
<g id="edge2701" class="edge">
<title>L8_S1_TP7_GPU15_gate&#45;&gt;L8_S1_TP7_GPU15_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M81148.83,-708.31C81148.83,-708.31 81148.83,-682.71 81148.83,-682.71"/>
<polygon fill="black" stroke="black" points="81152.33,-682.71 81148.83,-672.71 81145.33,-682.71 81152.33,-682.71"/>
</g>
<!-- L8_S1_TP7_GPU15_moe_ar&#45;&gt;L8_S1_TP7_GPU15_moe_res -->
<g id="edge2718" class="edge">
<title>L8_S1_TP7_GPU15_moe_ar&#45;&gt;L8_S1_TP7_GPU15_moe_res</title>
<path fill="none" stroke="black" d="M80291.47,-527C80789.69,-527 81673.89,-527 81673.89,-527 81673.89,-527 81673.89,-446.4 81673.89,-446.4"/>
<polygon fill="black" stroke="black" points="81677.39,-446.4 81673.89,-436.4 81670.39,-446.4 81677.39,-446.4"/>
</g>
<!-- L8_S1_TP7_GPU15_norm -->
<g id="node946" class="node">
<title>L8_S1_TP7_GPU15_norm</title>
<polygon fill="none" stroke="black" points="82107.5,-332.33 81658.5,-332.33 81658.5,-264.33 82107.5,-264.33 82107.5,-332.33"/>
<text text-anchor="middle" x="81883" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="81883" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="81883" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="81883" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L8_S1_TP7_GPU15_moe_res&#45;&gt;L8_S1_TP7_GPU15_norm -->
<g id="edge2720" class="edge">
<title>L8_S1_TP7_GPU15_moe_res&#45;&gt;L8_S1_TP7_GPU15_norm</title>
<path fill="none" stroke="black" d="M81883,-368.28C81883,-368.28 81883,-342.46 81883,-342.46"/>
<polygon fill="black" stroke="black" points="81886.5,-342.46 81883,-332.46 81879.5,-342.46 81886.5,-342.46"/>
</g>
<!-- L9_S1_TP0_GPU8_qkv_linear -->
<g id="node947" class="node">
<title>L9_S1_TP0_GPU8_qkv_linear</title>
<polygon fill="none" stroke="black" points="83553,-1614.75 82945,-1614.75 82945,-1546.75 83553,-1546.75 83553,-1614.75"/>
<text text-anchor="middle" x="83249" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="83249" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="83249" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="83249" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L9_S1_TP0_GPU8_qkv_slice -->
<g id="node948" class="node">
<title>L9_S1_TP0_GPU8_qkv_slice</title>
<polygon fill="none" stroke="black" points="83547,-1496.67 82951,-1496.67 82951,-1428.67 83547,-1428.67 83547,-1496.67"/>
<text text-anchor="middle" x="83249" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="83249" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="83249" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="83249" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L9_S1_TP0_GPU8_qkv_linear&#45;&gt;L9_S1_TP0_GPU8_qkv_slice -->
<g id="edge2721" class="edge">
<title>L9_S1_TP0_GPU8_qkv_linear&#45;&gt;L9_S1_TP0_GPU8_qkv_slice</title>
<path fill="none" stroke="black" d="M83249,-1546.59C83249,-1546.59 83249,-1506.74 83249,-1506.74"/>
<polygon fill="black" stroke="black" points="83252.5,-1506.74 83249,-1496.74 83245.5,-1506.74 83252.5,-1506.74"/>
</g>
<!-- L9_S1_TP0_GPU8_qk_matmul -->
<g id="node949" class="node">
<title>L9_S1_TP0_GPU8_qk_matmul</title>
<polygon fill="none" stroke="black" points="84021.5,-1392.67 83086.5,-1392.67 83086.5,-1324.67 84021.5,-1324.67 84021.5,-1392.67"/>
<text text-anchor="middle" x="83554" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="83554" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="83554" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="83554" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L9_S1_TP0_GPU8_qkv_slice&#45;&gt;L9_S1_TP0_GPU8_qk_matmul -->
<g id="edge2722" class="edge">
<title>L9_S1_TP0_GPU8_qkv_slice&#45;&gt;L9_S1_TP0_GPU8_qk_matmul</title>
<path fill="none" stroke="black" d="M83316.75,-1428.61C83316.75,-1428.61 83316.75,-1402.8 83316.75,-1402.8"/>
<polygon fill="black" stroke="black" points="83320.25,-1402.8 83316.75,-1392.8 83313.25,-1402.8 83320.25,-1402.8"/>
</g>
<!-- L9_S1_TP0_GPU8_attn_v -->
<g id="node951" class="node">
<title>L9_S1_TP0_GPU8_attn_v</title>
<polygon fill="none" stroke="black" points="84022,-1184.67 83084,-1184.67 83084,-1116.67 84022,-1116.67 84022,-1184.67"/>
<text text-anchor="middle" x="83553" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="83553" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="83553" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="83553" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L9_S1_TP0_GPU8_qkv_slice&#45;&gt;L9_S1_TP0_GPU8_attn_v -->
<g id="edge2725" class="edge">
<title>L9_S1_TP0_GPU8_qkv_slice&#45;&gt;L9_S1_TP0_GPU8_attn_v</title>
<path fill="none" stroke="black" d="M83017.5,-1428.61C83017.5,-1347.57 83017.5,-1150 83017.5,-1150 83017.5,-1150 83073.97,-1150 83073.97,-1150"/>
<polygon fill="black" stroke="black" points="83073.97,-1153.5 83083.97,-1150 83073.97,-1146.5 83073.97,-1153.5"/>
</g>
<!-- L9_S1_TP0_GPU8_softmax -->
<g id="node950" class="node">
<title>L9_S1_TP0_GPU8_softmax</title>
<polygon fill="none" stroke="black" points="83808,-1288.67 83298,-1288.67 83298,-1220.67 83808,-1220.67 83808,-1288.67"/>
<text text-anchor="middle" x="83553" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="83553" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="83553" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="83553" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L9_S1_TP0_GPU8_qk_matmul&#45;&gt;L9_S1_TP0_GPU8_softmax -->
<g id="edge2723" class="edge">
<title>L9_S1_TP0_GPU8_qk_matmul&#45;&gt;L9_S1_TP0_GPU8_softmax</title>
<path fill="none" stroke="black" d="M83553,-1324.61C83553,-1324.61 83553,-1298.8 83553,-1298.8"/>
<polygon fill="black" stroke="black" points="83556.5,-1298.8 83553,-1288.8 83549.5,-1298.8 83556.5,-1298.8"/>
</g>
<!-- L9_S1_TP0_GPU8_softmax&#45;&gt;L9_S1_TP0_GPU8_attn_v -->
<g id="edge2724" class="edge">
<title>L9_S1_TP0_GPU8_softmax&#45;&gt;L9_S1_TP0_GPU8_attn_v</title>
<path fill="none" stroke="black" d="M83553,-1220.61C83553,-1220.61 83553,-1194.8 83553,-1194.8"/>
<polygon fill="black" stroke="black" points="83556.5,-1194.8 83553,-1184.8 83549.5,-1194.8 83556.5,-1194.8"/>
</g>
<!-- L9_S1_TP0_GPU8_mha_ar -->
<g id="node952" class="node">
<title>L9_S1_TP0_GPU8_mha_ar</title>
<ellipse fill="none" stroke="black" cx="84208" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="84208" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="84208" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="84208" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="84208" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP0_GPU8_attn_v&#45;&gt;L9_S1_TP0_GPU8_mha_ar -->
<g id="edge2726" class="edge">
<title>L9_S1_TP0_GPU8_attn_v&#45;&gt;L9_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M83864.11,-1116.51C83864.11,-1116.51 83864.11,-1061.95 83864.11,-1061.95"/>
<polygon fill="black" stroke="black" points="83867.61,-1061.95 83864.11,-1051.95 83860.61,-1061.95 83867.61,-1061.95"/>
</g>
<!-- L9_S1_TP1_GPU9_mha_ar -->
<g id="node985" class="node">
<title>L9_S1_TP1_GPU9_mha_ar</title>
<ellipse fill="none" stroke="black" cx="84977" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="84977" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="84977" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="84977" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="84977" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP0_GPU8_attn_v&#45;&gt;L9_S1_TP1_GPU9_mha_ar -->
<g id="edge2762" class="edge">
<title>L9_S1_TP0_GPU8_attn_v&#45;&gt;L9_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M83895.68,-1116.43C83895.68,-1102.67 83895.68,-1090 83895.68,-1090 83895.68,-1090 84648.59,-1090 84648.59,-1090 84648.59,-1090 84648.59,-1065.94 84648.59,-1065.94"/>
<polygon fill="black" stroke="black" points="84652.09,-1065.94 84648.59,-1055.94 84645.09,-1065.94 84652.09,-1065.94"/>
</g>
<!-- L9_S1_TP2_GPU10_mha_ar -->
<g id="node995" class="node">
<title>L9_S1_TP2_GPU10_mha_ar</title>
<ellipse fill="none" stroke="black" cx="85746" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="85746" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="85746" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="85746" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="85746" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP0_GPU8_attn_v&#45;&gt;L9_S1_TP2_GPU10_mha_ar -->
<g id="edge2798" class="edge">
<title>L9_S1_TP0_GPU8_attn_v&#45;&gt;L9_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M83927.26,-1116.43C83927.26,-1102.67 83927.26,-1090 83927.26,-1090 83927.26,-1090 85440.96,-1090 85440.96,-1090 85440.96,-1090 85440.96,-1070.95 85440.96,-1070.95"/>
<polygon fill="black" stroke="black" points="85444.46,-1070.95 85440.96,-1060.95 85437.46,-1070.96 85444.46,-1070.95"/>
</g>
<!-- L9_S1_TP3_GPU11_mha_ar -->
<g id="node1005" class="node">
<title>L9_S1_TP3_GPU11_mha_ar</title>
<ellipse fill="none" stroke="black" cx="86515" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="86515" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="86515" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="86515" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="86515" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP0_GPU8_attn_v&#45;&gt;L9_S1_TP3_GPU11_mha_ar -->
<g id="edge2834" class="edge">
<title>L9_S1_TP0_GPU8_attn_v&#45;&gt;L9_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M83958.84,-1116.43C83958.84,-1102.67 83958.84,-1090 83958.84,-1090 83958.84,-1090 86246.74,-1090 86246.74,-1090 86246.74,-1090 86246.74,-1076.31 86246.74,-1076.31"/>
<polygon fill="black" stroke="black" points="86250.24,-1076.31 86246.74,-1066.31 86243.24,-1076.31 86250.24,-1076.31"/>
</g>
<!-- L9_S1_TP4_GPU12_mha_ar -->
<g id="node1015" class="node">
<title>L9_S1_TP4_GPU12_mha_ar</title>
<ellipse fill="none" stroke="black" cx="87284" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="87284" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="87284" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="87284" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="87284" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP0_GPU8_attn_v&#45;&gt;L9_S1_TP4_GPU12_mha_ar -->
<g id="edge2870" class="edge">
<title>L9_S1_TP0_GPU8_attn_v&#45;&gt;L9_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M83797.01,-1116.57C83797.01,-1065.74 83797.01,-976 83797.01,-976 83797.01,-976 86966.74,-976 86966.74,-976 86966.74,-976 86966.74,-996.61 86966.74,-996.61"/>
<polygon fill="black" stroke="black" points="86963.24,-996.61 86966.74,-1006.61 86970.24,-996.61 86963.24,-996.61"/>
</g>
<!-- L9_S1_TP5_GPU13_mha_ar -->
<g id="node1025" class="node">
<title>L9_S1_TP5_GPU13_mha_ar</title>
<ellipse fill="none" stroke="black" cx="88053" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="88053" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="88053" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="88053" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="88053" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP0_GPU8_attn_v&#45;&gt;L9_S1_TP5_GPU13_mha_ar -->
<g id="edge2906" class="edge">
<title>L9_S1_TP0_GPU8_attn_v&#45;&gt;L9_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M83950.33,-1184.72C83950.33,-1200.15 83950.33,-1215 83950.33,-1215 83950.33,-1215 87859.5,-1215 87859.5,-1215 87859.5,-1215 87859.5,-1083.98 87859.5,-1083.98"/>
<polygon fill="black" stroke="black" points="87863,-1083.98 87859.5,-1073.98 87856,-1083.98 87863,-1083.98"/>
</g>
<!-- L9_S1_TP6_GPU14_mha_ar -->
<g id="node1035" class="node">
<title>L9_S1_TP6_GPU14_mha_ar</title>
<ellipse fill="none" stroke="black" cx="88822" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="88822" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="88822" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="88822" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="88822" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP0_GPU8_attn_v&#45;&gt;L9_S1_TP6_GPU14_mha_ar -->
<g id="edge2942" class="edge">
<title>L9_S1_TP0_GPU8_attn_v&#45;&gt;L9_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M83879.17,-1184.73C83879.17,-1201.43 83879.17,-1218 83879.17,-1218 83879.17,-1218 88814,-1218 88814,-1218 88814,-1218 88814,-1090.81 88814,-1090.81"/>
<polygon fill="black" stroke="black" points="88817.5,-1090.81 88814,-1080.81 88810.5,-1090.82 88817.5,-1090.81"/>
</g>
<!-- L9_S1_TP7_GPU15_mha_ar -->
<g id="node1045" class="node">
<title>L9_S1_TP7_GPU15_mha_ar</title>
<ellipse fill="none" stroke="black" cx="89591" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="89591" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="89591" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="89591" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="89591" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP0_GPU8_attn_v&#45;&gt;L9_S1_TP7_GPU15_mha_ar -->
<g id="edge2978" class="edge">
<title>L9_S1_TP0_GPU8_attn_v&#45;&gt;L9_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M83990.42,-1116.52C83990.42,-1109.92 83990.42,-1105 83990.42,-1105 83990.42,-1105 89283.34,-1105 89283.34,-1105 89283.34,-1105 89283.34,-1070.37 89283.34,-1070.37"/>
<polygon fill="black" stroke="black" points="89286.84,-1070.37 89283.34,-1060.37 89279.84,-1070.37 89286.84,-1070.37"/>
</g>
<!-- L9_S1_TP0_GPU8_mha_res -->
<g id="node960" class="node">
<title>L9_S1_TP0_GPU8_mha_res</title>
<polygon fill="none" stroke="black" points="83570.5,-948.5 82683.5,-948.5 82683.5,-880.5 83570.5,-880.5 83570.5,-948.5"/>
<text text-anchor="middle" x="83127" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="83127" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="83127" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="83127" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP0_GPU8_mha_ar&#45;&gt;L9_S1_TP0_GPU8_mha_res -->
<g id="edge2734" class="edge">
<title>L9_S1_TP0_GPU8_mha_ar&#45;&gt;L9_S1_TP0_GPU8_mha_res</title>
<path fill="none" stroke="black" d="M83852.3,-1048C83607.86,-1048 83327.25,-1048 83327.25,-1048 83327.25,-1048 83327.25,-958.53 83327.25,-958.53"/>
<polygon fill="black" stroke="black" points="83330.75,-958.53 83327.25,-948.53 83323.75,-958.53 83330.75,-958.53"/>
</g>
<!-- L9_S1_TP1_GPU9_attn_v -->
<g id="node953" class="node">
<title>L9_S1_TP1_GPU9_attn_v</title>
<polygon fill="none" stroke="black" points="84978,-1184.67 84040,-1184.67 84040,-1116.67 84978,-1116.67 84978,-1184.67"/>
<text text-anchor="middle" x="84509" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="84509" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="84509" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="84509" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L9_S1_TP1_GPU9_attn_v&#45;&gt;L9_S1_TP0_GPU8_mha_ar -->
<g id="edge2727" class="edge">
<title>L9_S1_TP1_GPU9_attn_v&#45;&gt;L9_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M84107.93,-1116.51C84107.93,-1116.51 84107.93,-1088.96 84107.93,-1088.96"/>
<polygon fill="black" stroke="black" points="84111.43,-1088.96 84107.93,-1078.96 84104.43,-1088.96 84111.43,-1088.96"/>
</g>
<!-- L9_S1_TP1_GPU9_attn_v&#45;&gt;L9_S1_TP1_GPU9_mha_ar -->
<g id="edge2763" class="edge">
<title>L9_S1_TP1_GPU9_attn_v&#45;&gt;L9_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M84695.64,-1116.51C84695.64,-1116.51 84695.64,-1074.64 84695.64,-1074.64"/>
<polygon fill="black" stroke="black" points="84699.14,-1074.64 84695.64,-1064.64 84692.14,-1074.64 84699.14,-1074.64"/>
</g>
<!-- L9_S1_TP1_GPU9_attn_v&#45;&gt;L9_S1_TP2_GPU10_mha_ar -->
<g id="edge2799" class="edge">
<title>L9_S1_TP1_GPU9_attn_v&#45;&gt;L9_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M84742.7,-1116.43C84742.7,-1102.67 84742.7,-1090 84742.7,-1090 84742.7,-1090 85511.39,-1090 85511.39,-1090 85511.39,-1090 85511.39,-1080.24 85511.39,-1080.24"/>
<polygon fill="black" stroke="black" points="85514.89,-1080.24 85511.39,-1070.24 85507.89,-1080.24 85514.89,-1080.24"/>
</g>
<!-- L9_S1_TP1_GPU9_attn_v&#45;&gt;L9_S1_TP3_GPU11_mha_ar -->
<g id="edge2835" class="edge">
<title>L9_S1_TP1_GPU9_attn_v&#45;&gt;L9_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M84789.76,-1116.43C84789.76,-1102.67 84789.76,-1090 84789.76,-1090 84789.76,-1090 86353.95,-1090 86353.95,-1090 86353.95,-1090 86353.95,-1086.1 86353.95,-1086.1"/>
<polygon fill="black" stroke="black" points="86357.45,-1086.1 86353.95,-1076.1 86350.45,-1086.1 86357.45,-1086.1"/>
</g>
<!-- L9_S1_TP1_GPU9_attn_v&#45;&gt;L9_S1_TP4_GPU12_mha_ar -->
<g id="edge2871" class="edge">
<title>L9_S1_TP1_GPU9_attn_v&#45;&gt;L9_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M84592.5,-1116.36C84592.5,-1065.74 84592.5,-977 84592.5,-977 84592.5,-977 86937.98,-977 86937.98,-977 86937.98,-977 86937.98,-1003.77 86937.98,-1003.77"/>
<polygon fill="black" stroke="black" points="86934.48,-1003.76 86937.98,-1013.77 86941.48,-1003.77 86934.48,-1003.76"/>
</g>
<!-- L9_S1_TP1_GPU9_attn_v&#45;&gt;L9_S1_TP5_GPU13_mha_ar -->
<g id="edge2907" class="edge">
<title>L9_S1_TP1_GPU9_attn_v&#45;&gt;L9_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M84836.82,-1116.52C84836.82,-1109.92 84836.82,-1105 84836.82,-1105 84836.82,-1105 87711.22,-1105 87711.22,-1105 87711.22,-1105 87711.22,-1062.76 87711.22,-1062.76"/>
<polygon fill="black" stroke="black" points="87714.72,-1062.76 87711.22,-1052.76 87707.72,-1062.76 87714.72,-1062.76"/>
</g>
<!-- L9_S1_TP1_GPU9_attn_v&#45;&gt;L9_S1_TP6_GPU14_mha_ar -->
<g id="edge2943" class="edge">
<title>L9_S1_TP1_GPU9_attn_v&#45;&gt;L9_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M84883.88,-1116.52C84883.88,-1109.92 84883.88,-1105 84883.88,-1105 84883.88,-1105 88505.77,-1105 88505.77,-1105 88505.77,-1105 88505.77,-1068.73 88505.77,-1068.73"/>
<polygon fill="black" stroke="black" points="88509.27,-1068.73 88505.77,-1058.73 88502.27,-1068.73 88509.27,-1068.73"/>
</g>
<!-- L9_S1_TP1_GPU9_attn_v&#45;&gt;L9_S1_TP7_GPU15_mha_ar -->
<g id="edge2979" class="edge">
<title>L9_S1_TP1_GPU9_attn_v&#45;&gt;L9_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M84930.94,-1116.52C84930.94,-1109.92 84930.94,-1105 84930.94,-1105 84930.94,-1105 89351.14,-1105 89351.14,-1105 89351.14,-1105 89351.14,-1079.64 89351.14,-1079.64"/>
<polygon fill="black" stroke="black" points="89354.64,-1079.64 89351.14,-1069.64 89347.64,-1079.64 89354.64,-1079.64"/>
</g>
<!-- L9_S1_TP2_GPU10_attn_v -->
<g id="node954" class="node">
<title>L9_S1_TP2_GPU10_attn_v</title>
<polygon fill="none" stroke="black" points="85934,-1184.67 84996,-1184.67 84996,-1116.67 85934,-1116.67 85934,-1184.67"/>
<text text-anchor="middle" x="85465" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="85465" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="85465" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="85465" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L9_S1_TP2_GPU10_attn_v&#45;&gt;L9_S1_TP0_GPU8_mha_ar -->
<g id="edge2728" class="edge">
<title>L9_S1_TP2_GPU10_attn_v&#45;&gt;L9_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M85046.92,-1116.52C85046.92,-1109.92 85046.92,-1105 85046.92,-1105 85046.92,-1105 84175.87,-1105 84175.87,-1105 84175.87,-1105 84175.87,-1090.89 84175.87,-1090.89"/>
<polygon fill="black" stroke="black" points="84179.37,-1090.89 84175.87,-1080.89 84172.37,-1090.89 84179.37,-1090.89"/>
</g>
<!-- L9_S1_TP2_GPU10_attn_v&#45;&gt;L9_S1_TP1_GPU9_mha_ar -->
<g id="edge2764" class="edge">
<title>L9_S1_TP2_GPU10_attn_v&#45;&gt;L9_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M85097.85,-1116.51C85097.85,-1116.51 85097.85,-1088.52 85097.85,-1088.52"/>
<polygon fill="black" stroke="black" points="85101.35,-1088.52 85097.85,-1078.52 85094.35,-1088.52 85101.35,-1088.52"/>
</g>
<!-- L9_S1_TP2_GPU10_attn_v&#45;&gt;L9_S1_TP2_GPU10_mha_ar -->
<g id="edge2800" class="edge">
<title>L9_S1_TP2_GPU10_attn_v&#45;&gt;L9_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M85581.83,-1116.51C85581.83,-1116.51 85581.83,-1085.92 85581.83,-1085.92"/>
<polygon fill="black" stroke="black" points="85585.33,-1085.92 85581.83,-1075.92 85578.33,-1085.92 85585.33,-1085.92"/>
</g>
<!-- L9_S1_TP2_GPU10_attn_v&#45;&gt;L9_S1_TP3_GPU11_mha_ar -->
<g id="edge2836" class="edge">
<title>L9_S1_TP2_GPU10_attn_v&#45;&gt;L9_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M85652.26,-1116.43C85652.26,-1102.67 85652.26,-1090 85652.26,-1090 85652.26,-1090 86461.16,-1090 86461.16,-1090 86461.16,-1090 86461.16,-1089.03 86461.16,-1089.03"/>
<polygon fill="black" stroke="black" points="86464.66,-1090.26 86461.16,-1080.26 86457.66,-1090.26 86464.66,-1090.26"/>
</g>
<!-- L9_S1_TP2_GPU10_attn_v&#45;&gt;L9_S1_TP4_GPU12_mha_ar -->
<g id="edge2872" class="edge">
<title>L9_S1_TP2_GPU10_attn_v&#45;&gt;L9_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M85722.7,-1116.52C85722.7,-1109.92 85722.7,-1105 85722.7,-1105 85722.7,-1105 87123.08,-1105 87123.08,-1105 87123.08,-1105 87123.08,-1086.38 87123.08,-1086.38"/>
<polygon fill="black" stroke="black" points="87126.58,-1086.38 87123.08,-1076.38 87119.58,-1086.38 87126.58,-1086.38"/>
</g>
<!-- L9_S1_TP2_GPU10_attn_v&#45;&gt;L9_S1_TP5_GPU13_mha_ar -->
<g id="edge2908" class="edge">
<title>L9_S1_TP2_GPU10_attn_v&#45;&gt;L9_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M85851,-1184.74C85851,-1196.6 85851,-1207 85851,-1207 85851,-1207 87855,-1207 87855,-1207 87855,-1207 87855,-1083.48 87855,-1083.48"/>
<polygon fill="black" stroke="black" points="87858.5,-1083.48 87855,-1073.48 87851.5,-1083.48 87858.5,-1083.48"/>
</g>
<!-- L9_S1_TP2_GPU10_attn_v&#45;&gt;L9_S1_TP6_GPU14_mha_ar -->
<g id="edge2944" class="edge">
<title>L9_S1_TP2_GPU10_attn_v&#45;&gt;L9_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M85793.13,-1116.52C85793.13,-1109.92 85793.13,-1105 85793.13,-1105 85793.13,-1105 88565.02,-1105 88565.02,-1105 88565.02,-1105 88565.02,-1077.94 88565.02,-1077.94"/>
<polygon fill="black" stroke="black" points="88568.52,-1077.94 88565.02,-1067.94 88561.52,-1077.94 88568.52,-1077.94"/>
</g>
<!-- L9_S1_TP2_GPU10_attn_v&#45;&gt;L9_S1_TP7_GPU15_mha_ar -->
<g id="edge2980" class="edge">
<title>L9_S1_TP2_GPU10_attn_v&#45;&gt;L9_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M85863.57,-1116.52C85863.57,-1109.92 85863.57,-1105 85863.57,-1105 85863.57,-1105 89418.95,-1105 89418.95,-1105 89418.95,-1105 89418.95,-1085.55 89418.95,-1085.55"/>
<polygon fill="black" stroke="black" points="89422.45,-1085.55 89418.95,-1075.55 89415.45,-1085.55 89422.45,-1085.55"/>
</g>
<!-- L9_S1_TP3_GPU11_attn_v -->
<g id="node955" class="node">
<title>L9_S1_TP3_GPU11_attn_v</title>
<polygon fill="none" stroke="black" points="86890,-1184.67 85952,-1184.67 85952,-1116.67 86890,-1116.67 86890,-1184.67"/>
<text text-anchor="middle" x="86421" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="86421" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="86421" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="86421" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L9_S1_TP3_GPU11_attn_v&#45;&gt;L9_S1_TP0_GPU8_mha_ar -->
<g id="edge2729" class="edge">
<title>L9_S1_TP3_GPU11_attn_v&#45;&gt;L9_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M85980.25,-1116.52C85980.25,-1109.92 85980.25,-1105 85980.25,-1105 85980.25,-1105 84243.8,-1105 84243.8,-1105 84243.8,-1105 84243.8,-1090.48 84243.8,-1090.48"/>
<polygon fill="black" stroke="black" points="84247.3,-1090.48 84243.8,-1080.48 84240.3,-1090.48 84247.3,-1090.48"/>
</g>
<!-- L9_S1_TP3_GPU11_attn_v&#45;&gt;L9_S1_TP1_GPU9_mha_ar -->
<g id="edge2765" class="edge">
<title>L9_S1_TP3_GPU11_attn_v&#45;&gt;L9_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M86008.49,-1116.52C86008.49,-1109.92 86008.49,-1105 86008.49,-1105 86008.49,-1105 85148.77,-1105 85148.77,-1105 85148.77,-1105 85148.77,-1085.55 85148.77,-1085.55"/>
<polygon fill="black" stroke="black" points="85152.27,-1085.55 85148.77,-1075.55 85145.27,-1085.55 85152.27,-1085.55"/>
</g>
<!-- L9_S1_TP3_GPU11_attn_v&#45;&gt;L9_S1_TP2_GPU10_mha_ar -->
<g id="edge2801" class="edge">
<title>L9_S1_TP3_GPU11_attn_v&#45;&gt;L9_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M86036.74,-1116.51C86036.74,-1116.51 86036.74,-1073.04 86036.74,-1073.04"/>
<polygon fill="black" stroke="black" points="86040.24,-1073.04 86036.74,-1063.04 86033.24,-1073.04 86040.24,-1073.04"/>
</g>
<!-- L9_S1_TP3_GPU11_attn_v&#45;&gt;L9_S1_TP3_GPU11_mha_ar -->
<g id="edge2837" class="edge">
<title>L9_S1_TP3_GPU11_attn_v&#45;&gt;L9_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M86568.37,-1116.51C86568.37,-1116.51 86568.37,-1090.27 86568.37,-1090.27"/>
<polygon fill="black" stroke="black" points="86571.87,-1090.27 86568.37,-1080.27 86564.87,-1090.27 86571.87,-1090.27"/>
</g>
<!-- L9_S1_TP3_GPU11_attn_v&#45;&gt;L9_S1_TP4_GPU12_mha_ar -->
<g id="edge2873" class="edge">
<title>L9_S1_TP3_GPU11_attn_v&#45;&gt;L9_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M86890.05,-1161C86892.54,-1161 86893.86,-1161 86893.86,-1161 86893.86,-1161 86893.86,-1048 86893.86,-1048 86893.86,-1048 86918.14,-1048 86918.14,-1048"/>
<polygon fill="black" stroke="black" points="86918.14,-1051.5 86928.14,-1048 86918.14,-1044.5 86918.14,-1051.5"/>
</g>
<!-- L9_S1_TP3_GPU11_attn_v&#45;&gt;L9_S1_TP5_GPU13_mha_ar -->
<g id="edge2909" class="edge">
<title>L9_S1_TP3_GPU11_attn_v&#45;&gt;L9_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M86841,-1184.8C86841,-1189.08 86841,-1192 86841,-1192 86841,-1192 87850.5,-1192 87850.5,-1192 87850.5,-1192 87850.5,-1083.22 87850.5,-1083.22"/>
<polygon fill="black" stroke="black" points="87854,-1083.22 87850.5,-1073.22 87847,-1083.22 87854,-1083.22"/>
</g>
<!-- L9_S1_TP3_GPU11_attn_v&#45;&gt;L9_S1_TP6_GPU14_mha_ar -->
<g id="edge2945" class="edge">
<title>L9_S1_TP3_GPU11_attn_v&#45;&gt;L9_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M86792,-1184.8C86792,-1193.77 86792,-1201 86792,-1201 86792,-1201 88808,-1201 88808,-1201 88808,-1201 88808,-1090.84 88808,-1090.84"/>
<polygon fill="black" stroke="black" points="88811.5,-1090.84 88808,-1080.84 88804.5,-1090.84 88811.5,-1090.84"/>
</g>
<!-- L9_S1_TP3_GPU11_attn_v&#45;&gt;L9_S1_TP7_GPU15_mha_ar -->
<g id="edge2981" class="edge">
<title>L9_S1_TP3_GPU11_attn_v&#45;&gt;L9_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M86675.58,-1116.52C86675.58,-1109.92 86675.58,-1105 86675.58,-1105 86675.58,-1105 89486.76,-1105 89486.76,-1105 89486.76,-1105 89486.76,-1088.86 89486.76,-1088.86"/>
<polygon fill="black" stroke="black" points="89490.26,-1088.86 89486.76,-1078.86 89483.26,-1088.86 89490.26,-1088.86"/>
</g>
<!-- L9_S1_TP4_GPU12_attn_v -->
<g id="node956" class="node">
<title>L9_S1_TP4_GPU12_attn_v</title>
<polygon fill="none" stroke="black" points="87846,-1184.67 86908,-1184.67 86908,-1116.67 87846,-1116.67 87846,-1184.67"/>
<text text-anchor="middle" x="87377" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="87377" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="87377" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="87377" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L9_S1_TP4_GPU12_attn_v&#45;&gt;L9_S1_TP0_GPU8_mha_ar -->
<g id="edge2730" class="edge">
<title>L9_S1_TP4_GPU12_attn_v&#45;&gt;L9_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M87015.8,-1116.26C87015.8,-1109.27 87015.8,-1104 87015.8,-1104 87015.8,-1104 84311.74,-1104 84311.74,-1104 84311.74,-1104 84311.74,-1089.02 84311.74,-1089.02"/>
<polygon fill="black" stroke="black" points="84315.24,-1089.02 84311.74,-1079.02 84308.24,-1089.02 84315.24,-1089.02"/>
</g>
<!-- L9_S1_TP4_GPU12_attn_v&#45;&gt;L9_S1_TP1_GPU9_mha_ar -->
<g id="edge2766" class="edge">
<title>L9_S1_TP4_GPU12_attn_v&#45;&gt;L9_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M86984.33,-1185.03C86984.33,-1191.35 86984.33,-1196 86984.33,-1196 86984.33,-1196 84987,-1196 84987,-1196 84987,-1196 84987,-1090.73 84987,-1090.73"/>
<polygon fill="black" stroke="black" points="84990.5,-1090.73 84987,-1080.73 84983.5,-1090.73 84990.5,-1090.73"/>
</g>
<!-- L9_S1_TP4_GPU12_attn_v&#45;&gt;L9_S1_TP2_GPU10_mha_ar -->
<g id="edge2802" class="edge">
<title>L9_S1_TP4_GPU12_attn_v&#45;&gt;L9_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M86946.17,-1185.05C86946.17,-1186.28 86946.17,-1187 86946.17,-1187 86946.17,-1187 85946,-1187 85946,-1187 85946,-1187 85946,-1083.56 85946,-1083.56"/>
<polygon fill="black" stroke="black" points="85949.5,-1083.56 85946,-1073.56 85942.5,-1083.56 85949.5,-1083.56"/>
</g>
<!-- L9_S1_TP4_GPU12_attn_v&#45;&gt;L9_S1_TP3_GPU11_mha_ar -->
<g id="edge2838" class="edge">
<title>L9_S1_TP4_GPU12_attn_v&#45;&gt;L9_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M86907.62,-1139C86900.27,-1139 86896.21,-1139 86896.21,-1139 86896.21,-1139 86896.21,-1016 86896.21,-1016 86896.21,-1016 86877.56,-1016 86877.56,-1016"/>
<polygon fill="black" stroke="black" points="86877.56,-1012.5 86867.56,-1016 86877.56,-1019.5 86877.56,-1012.5"/>
</g>
<!-- L9_S1_TP4_GPU12_attn_v&#45;&gt;L9_S1_TP4_GPU12_mha_ar -->
<g id="edge2874" class="edge">
<title>L9_S1_TP4_GPU12_attn_v&#45;&gt;L9_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M87230.36,-1116.51C87230.36,-1116.51 87230.36,-1090.27 87230.36,-1090.27"/>
<polygon fill="black" stroke="black" points="87233.86,-1090.27 87230.36,-1080.27 87226.86,-1090.27 87233.86,-1090.27"/>
</g>
<!-- L9_S1_TP4_GPU12_attn_v&#45;&gt;L9_S1_TP5_GPU13_mha_ar -->
<g id="edge2910" class="edge">
<title>L9_S1_TP4_GPU12_attn_v&#45;&gt;L9_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M87744.92,-1116.51C87744.92,-1116.51 87744.92,-1070.31 87744.92,-1070.31"/>
<polygon fill="black" stroke="black" points="87748.42,-1070.31 87744.92,-1060.31 87741.42,-1070.31 87748.42,-1070.31"/>
</g>
<!-- L9_S1_TP4_GPU12_attn_v&#45;&gt;L9_S1_TP6_GPU14_mha_ar -->
<g id="edge2946" class="edge">
<title>L9_S1_TP4_GPU12_attn_v&#45;&gt;L9_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M87778.61,-1116.53C87778.61,-1115.56 87778.61,-1115 87778.61,-1115 87778.61,-1115 88624.26,-1115 88624.26,-1115 88624.26,-1115 88624.26,-1083.79 88624.26,-1083.79"/>
<polygon fill="black" stroke="black" points="88627.76,-1083.79 88624.26,-1073.79 88620.76,-1083.79 88627.76,-1083.79"/>
</g>
<!-- L9_S1_TP4_GPU12_attn_v&#45;&gt;L9_S1_TP7_GPU15_mha_ar -->
<g id="edge2982" class="edge">
<title>L9_S1_TP4_GPU12_attn_v&#45;&gt;L9_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M87812.31,-1116.53C87812.31,-1115.56 87812.31,-1115 87812.31,-1115 87812.31,-1115 89554.57,-1115 89554.57,-1115 89554.57,-1115 89554.57,-1090.53 89554.57,-1090.53"/>
<polygon fill="black" stroke="black" points="89558.07,-1090.53 89554.57,-1080.53 89551.07,-1090.53 89558.07,-1090.53"/>
</g>
<!-- L9_S1_TP5_GPU13_attn_v -->
<g id="node957" class="node">
<title>L9_S1_TP5_GPU13_attn_v</title>
<polygon fill="none" stroke="black" points="88802,-1184.67 87864,-1184.67 87864,-1116.67 88802,-1116.67 88802,-1184.67"/>
<text text-anchor="middle" x="88333" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="88333" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="88333" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="88333" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L9_S1_TP5_GPU13_attn_v&#45;&gt;L9_S1_TP0_GPU8_mha_ar -->
<g id="edge2731" class="edge">
<title>L9_S1_TP5_GPU13_attn_v&#45;&gt;L9_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M87934.56,-1116.26C87934.56,-1109.27 87934.56,-1104 87934.56,-1104 87934.56,-1104 84379.67,-1104 84379.67,-1104 84379.67,-1104 84379.67,-1085.36 84379.67,-1085.36"/>
<polygon fill="black" stroke="black" points="84383.17,-1085.36 84379.67,-1075.36 84376.17,-1085.36 84383.17,-1085.36"/>
</g>
<!-- L9_S1_TP5_GPU13_attn_v&#45;&gt;L9_S1_TP1_GPU9_mha_ar -->
<g id="edge2767" class="edge">
<title>L9_S1_TP5_GPU13_attn_v&#45;&gt;L9_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M88005.12,-1116.52C88005.12,-1109.92 88005.12,-1105 88005.12,-1105 88005.12,-1105 85199.7,-1105 85199.7,-1105 85199.7,-1105 85199.7,-1081.34 85199.7,-1081.34"/>
<polygon fill="black" stroke="black" points="85203.2,-1081.34 85199.7,-1071.34 85196.2,-1081.34 85203.2,-1081.34"/>
</g>
<!-- L9_S1_TP5_GPU13_attn_v&#45;&gt;L9_S1_TP2_GPU10_mha_ar -->
<g id="edge2803" class="edge">
<title>L9_S1_TP5_GPU13_attn_v&#45;&gt;L9_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M87941.25,-1184.75C87941.25,-1195.2 87941.25,-1204 87941.25,-1204 87941.25,-1204 85940,-1204 85940,-1204 85940,-1204 85940,-1084.08 85940,-1084.08"/>
<polygon fill="black" stroke="black" points="85943.5,-1084.08 85940,-1074.08 85936.5,-1084.08 85943.5,-1084.08"/>
</g>
<!-- L9_S1_TP5_GPU13_attn_v&#45;&gt;L9_S1_TP3_GPU11_mha_ar -->
<g id="edge2839" class="edge">
<title>L9_S1_TP5_GPU13_attn_v&#45;&gt;L9_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M88075.68,-1116.52C88075.68,-1109.92 88075.68,-1105 88075.68,-1105 88075.68,-1105 86782.79,-1105 86782.79,-1105 86782.79,-1105 86782.79,-1076.67 86782.79,-1076.67"/>
<polygon fill="black" stroke="black" points="86786.29,-1076.67 86782.79,-1066.67 86779.29,-1076.67 86786.29,-1076.67"/>
</g>
<!-- L9_S1_TP5_GPU13_attn_v&#45;&gt;L9_S1_TP4_GPU12_mha_ar -->
<g id="edge2875" class="edge">
<title>L9_S1_TP5_GPU13_attn_v&#45;&gt;L9_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M88146.24,-1116.55C88146.24,-1100.15 88146.24,-1084 88146.24,-1084 88146.24,-1084 87337.64,-1084 87337.64,-1084 87337.64,-1084 87337.64,-1083.63 87337.64,-1083.63"/>
<polygon fill="black" stroke="black" points="87341.14,-1090.3 87337.64,-1080.3 87334.14,-1090.3 87341.14,-1090.3"/>
</g>
<!-- L9_S1_TP5_GPU13_attn_v&#45;&gt;L9_S1_TP5_GPU13_mha_ar -->
<g id="edge2911" class="edge">
<title>L9_S1_TP5_GPU13_attn_v&#45;&gt;L9_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M88216.8,-1116.51C88216.8,-1116.51 88216.8,-1085.92 88216.8,-1085.92"/>
<polygon fill="black" stroke="black" points="88220.3,-1085.92 88216.8,-1075.92 88213.3,-1085.92 88220.3,-1085.92"/>
</g>
<!-- L9_S1_TP5_GPU13_attn_v&#45;&gt;L9_S1_TP6_GPU14_mha_ar -->
<g id="edge2947" class="edge">
<title>L9_S1_TP5_GPU13_attn_v&#45;&gt;L9_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M88683.51,-1116.51C88683.51,-1116.51 88683.51,-1087.65 88683.51,-1087.65"/>
<polygon fill="black" stroke="black" points="88687.01,-1087.65 88683.51,-1077.65 88680.01,-1087.65 88687.01,-1087.65"/>
</g>
<!-- L9_S1_TP5_GPU13_attn_v&#45;&gt;L9_S1_TP7_GPU15_mha_ar -->
<g id="edge2983" class="edge">
<title>L9_S1_TP5_GPU13_attn_v&#45;&gt;L9_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M88742.75,-1116.53C88742.75,-1115.56 88742.75,-1115 88742.75,-1115 88742.75,-1115 89622.38,-1115 89622.38,-1115 89622.38,-1115 89622.38,-1090.53 89622.38,-1090.53"/>
<polygon fill="black" stroke="black" points="89625.88,-1090.53 89622.38,-1080.53 89618.88,-1090.53 89625.88,-1090.53"/>
</g>
<!-- L9_S1_TP6_GPU14_attn_v -->
<g id="node958" class="node">
<title>L9_S1_TP6_GPU14_attn_v</title>
<polygon fill="none" stroke="black" points="89758,-1184.67 88820,-1184.67 88820,-1116.67 89758,-1116.67 89758,-1184.67"/>
<text text-anchor="middle" x="89289" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="89289" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="89289" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="89289" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L9_S1_TP6_GPU14_attn_v&#45;&gt;L9_S1_TP0_GPU8_mha_ar -->
<g id="edge2732" class="edge">
<title>L9_S1_TP6_GPU14_attn_v&#45;&gt;L9_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M88867.18,-1116.26C88867.18,-1109.27 88867.18,-1104 88867.18,-1104 88867.18,-1104 84447.61,-1104 84447.61,-1104 84447.61,-1104 84447.61,-1079.96 84447.61,-1079.96"/>
<polygon fill="black" stroke="black" points="84451.11,-1079.96 84447.61,-1069.96 84444.11,-1079.96 84451.11,-1079.96"/>
</g>
<!-- L9_S1_TP6_GPU14_attn_v&#45;&gt;L9_S1_TP1_GPU9_mha_ar -->
<g id="edge2768" class="edge">
<title>L9_S1_TP6_GPU14_attn_v&#45;&gt;L9_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M88914.37,-1116.26C88914.37,-1109.27 88914.37,-1104 88914.37,-1104 88914.37,-1104 85250.62,-1104 85250.62,-1104 85250.62,-1104 85250.62,-1075.78 85250.62,-1075.78"/>
<polygon fill="black" stroke="black" points="85254.12,-1075.78 85250.62,-1065.78 85247.12,-1075.78 85254.12,-1075.78"/>
</g>
<!-- L9_S1_TP6_GPU14_attn_v&#45;&gt;L9_S1_TP2_GPU10_mha_ar -->
<g id="edge2804" class="edge">
<title>L9_S1_TP6_GPU14_attn_v&#45;&gt;L9_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M88961.55,-1116.26C88961.55,-1109.27 88961.55,-1104 88961.55,-1104 88961.55,-1104 86064.98,-1104 86064.98,-1104 86064.98,-1104 86064.98,-1067.96 86064.98,-1067.96"/>
<polygon fill="black" stroke="black" points="86068.48,-1067.96 86064.98,-1057.96 86061.48,-1067.96 86068.48,-1067.96"/>
</g>
<!-- L9_S1_TP6_GPU14_attn_v&#45;&gt;L9_S1_TP3_GPU11_mha_ar -->
<g id="edge2840" class="edge">
<title>L9_S1_TP6_GPU14_attn_v&#45;&gt;L9_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M89206.5,-1116.66C89206.5,-1061.35 89206.5,-958 89206.5,-958 89206.5,-958 86861.82,-958 86861.82,-958 86861.82,-958 86861.82,-1004.15 86861.82,-1004.15"/>
<polygon fill="black" stroke="black" points="86858.32,-1004.15 86861.82,-1014.15 86865.32,-1004.15 86858.32,-1004.15"/>
</g>
<!-- L9_S1_TP6_GPU14_attn_v&#45;&gt;L9_S1_TP4_GPU12_mha_ar -->
<g id="edge2876" class="edge">
<title>L9_S1_TP6_GPU14_attn_v&#45;&gt;L9_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M89008.74,-1116.55C89008.74,-1100.15 89008.74,-1084 89008.74,-1084 89008.74,-1084 87444.92,-1084 87444.92,-1084 87444.92,-1084 87444.92,-1083.24 87444.92,-1083.24"/>
<polygon fill="black" stroke="black" points="87448.42,-1086.41 87444.92,-1076.41 87441.42,-1086.41 87448.42,-1086.41"/>
</g>
<!-- L9_S1_TP6_GPU14_attn_v&#45;&gt;L9_S1_TP5_GPU13_mha_ar -->
<g id="edge2912" class="edge">
<title>L9_S1_TP6_GPU14_attn_v&#45;&gt;L9_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M89055.92,-1116.55C89055.92,-1100.15 89055.92,-1084 89055.92,-1084 89055.92,-1084 88287.36,-1084 88287.36,-1084 88287.36,-1084 88287.36,-1080.22 88287.36,-1080.22"/>
<polygon fill="black" stroke="black" points="88290.86,-1080.22 88287.36,-1070.22 88283.86,-1080.22 88290.86,-1080.22"/>
</g>
<!-- L9_S1_TP6_GPU14_attn_v&#45;&gt;L9_S1_TP6_GPU14_mha_ar -->
<g id="edge2948" class="edge">
<title>L9_S1_TP6_GPU14_attn_v&#45;&gt;L9_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M89103.11,-1116.51C89103.11,-1116.51 89103.11,-1074.64 89103.11,-1074.64"/>
<polygon fill="black" stroke="black" points="89106.61,-1074.64 89103.11,-1064.64 89099.61,-1074.64 89106.61,-1074.64"/>
</g>
<!-- L9_S1_TP6_GPU14_attn_v&#45;&gt;L9_S1_TP7_GPU15_mha_ar -->
<g id="edge2984" class="edge">
<title>L9_S1_TP6_GPU14_attn_v&#45;&gt;L9_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M89690.19,-1116.51C89690.19,-1116.51 89690.19,-1088.96 89690.19,-1088.96"/>
<polygon fill="black" stroke="black" points="89693.69,-1088.96 89690.19,-1078.96 89686.69,-1088.96 89693.69,-1088.96"/>
</g>
<!-- L9_S1_TP7_GPU15_attn_v -->
<g id="node959" class="node">
<title>L9_S1_TP7_GPU15_attn_v</title>
<polygon fill="none" stroke="black" points="90714,-1184.67 89776,-1184.67 89776,-1116.67 90714,-1116.67 90714,-1184.67"/>
<text text-anchor="middle" x="90245" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="90245" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="90245" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="90245" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L9_S1_TP7_GPU15_attn_v&#45;&gt;L9_S1_TP0_GPU8_mha_ar -->
<g id="edge2733" class="edge">
<title>L9_S1_TP7_GPU15_attn_v&#45;&gt;L9_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M89799.81,-1116.26C89799.81,-1109.27 89799.81,-1104 89799.81,-1104 89799.81,-1104 84515.54,-1104 84515.54,-1104 84515.54,-1104 84515.54,-1070.4 84515.54,-1070.4"/>
<polygon fill="black" stroke="black" points="84519.04,-1070.4 84515.54,-1060.4 84512.04,-1070.4 84519.04,-1070.4"/>
</g>
<!-- L9_S1_TP7_GPU15_attn_v&#45;&gt;L9_S1_TP1_GPU9_mha_ar -->
<g id="edge2769" class="edge">
<title>L9_S1_TP7_GPU15_attn_v&#45;&gt;L9_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M89823.62,-1116.26C89823.62,-1109.27 89823.62,-1104 89823.62,-1104 89823.62,-1104 85301.55,-1104 85301.55,-1104 85301.55,-1104 85301.55,-1067.16 85301.55,-1067.16"/>
<polygon fill="black" stroke="black" points="85305.05,-1067.16 85301.55,-1057.16 85298.05,-1067.16 85305.05,-1067.16"/>
</g>
<!-- L9_S1_TP7_GPU15_attn_v&#45;&gt;L9_S1_TP2_GPU10_mha_ar -->
<g id="edge2805" class="edge">
<title>L9_S1_TP7_GPU15_attn_v&#45;&gt;L9_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M89847.43,-1116.26C89847.43,-1109.27 89847.43,-1104 89847.43,-1104 89847.43,-1104 86093.23,-1104 86093.23,-1104 86093.23,-1104 86093.23,-1060.97 86093.23,-1060.97"/>
<polygon fill="black" stroke="black" points="86096.73,-1060.97 86093.23,-1050.97 86089.73,-1060.97 86096.73,-1060.97"/>
</g>
<!-- L9_S1_TP7_GPU15_attn_v&#45;&gt;L9_S1_TP3_GPU11_mha_ar -->
<g id="edge2841" class="edge">
<title>L9_S1_TP7_GPU15_attn_v&#45;&gt;L9_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M90002.49,-1116.66C90002.49,-1061.35 90002.49,-958 90002.49,-958 90002.49,-958 86833.16,-958 86833.16,-958 86833.16,-958 86833.16,-996.92 86833.16,-996.92"/>
<polygon fill="black" stroke="black" points="86829.66,-996.92 86833.16,-1006.92 86836.66,-996.92 86829.66,-996.92"/>
</g>
<!-- L9_S1_TP7_GPU15_attn_v&#45;&gt;L9_S1_TP4_GPU12_mha_ar -->
<g id="edge2877" class="edge">
<title>L9_S1_TP7_GPU15_attn_v&#45;&gt;L9_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M89871.24,-1116.55C89871.24,-1100.15 89871.24,-1084 89871.24,-1084 89871.24,-1084 87552.2,-1084 87552.2,-1084 87552.2,-1084 87552.2,-1076.31 87552.2,-1076.31"/>
<polygon fill="black" stroke="black" points="87555.7,-1076.31 87552.2,-1066.31 87548.7,-1076.31 87555.7,-1076.31"/>
</g>
<!-- L9_S1_TP7_GPU15_attn_v&#45;&gt;L9_S1_TP5_GPU13_mha_ar -->
<g id="edge2913" class="edge">
<title>L9_S1_TP7_GPU15_attn_v&#45;&gt;L9_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M89895.05,-1116.55C89895.05,-1100.15 89895.05,-1084 89895.05,-1084 89895.05,-1084 88357.91,-1084 88357.91,-1084 88357.91,-1084 88357.91,-1070.7 88357.91,-1070.7"/>
<polygon fill="black" stroke="black" points="88361.41,-1070.7 88357.91,-1060.7 88354.41,-1070.7 88361.41,-1070.7"/>
</g>
<!-- L9_S1_TP7_GPU15_attn_v&#45;&gt;L9_S1_TP6_GPU14_mha_ar -->
<g id="edge2949" class="edge">
<title>L9_S1_TP7_GPU15_attn_v&#45;&gt;L9_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M89918.86,-1116.55C89918.86,-1100.15 89918.86,-1084 89918.86,-1084 89918.86,-1084 89150.29,-1084 89150.29,-1084 89150.29,-1084 89150.29,-1066.18 89150.29,-1066.18"/>
<polygon fill="black" stroke="black" points="89153.79,-1066.18 89150.29,-1056.18 89146.79,-1066.18 89153.79,-1066.18"/>
</g>
<!-- L9_S1_TP7_GPU15_attn_v&#45;&gt;L9_S1_TP7_GPU15_mha_ar -->
<g id="edge2985" class="edge">
<title>L9_S1_TP7_GPU15_attn_v&#45;&gt;L9_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M89942.66,-1116.51C89942.66,-1116.51 89942.66,-1059.62 89942.66,-1059.62"/>
<polygon fill="black" stroke="black" points="89946.16,-1059.62 89942.66,-1049.62 89939.16,-1059.62 89946.16,-1059.62"/>
</g>
<!-- L9_S1_TP0_GPU8_gate -->
<g id="node961" class="node">
<title>L9_S1_TP0_GPU8_gate</title>
<polygon fill="none" stroke="black" points="83656.56,-844.5 82814.15,-844.5 82597.44,-708.5 83439.85,-708.5 83656.56,-844.5"/>
<text text-anchor="middle" x="83127" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="83127" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="83127" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="83127" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L9_S1_TP0_GPU8_mha_res&#45;&gt;L9_S1_TP0_GPU8_gate -->
<g id="edge2735" class="edge">
<title>L9_S1_TP0_GPU8_mha_res&#45;&gt;L9_S1_TP0_GPU8_gate</title>
<path fill="none" stroke="black" d="M83127,-880.39C83127,-880.39 83127,-854.73 83127,-854.73"/>
<polygon fill="black" stroke="black" points="83130.5,-854.73 83127,-844.73 83123.5,-854.73 83130.5,-854.73"/>
</g>
<!-- L9_S1_TP0_GPU8_moe_res -->
<g id="node979" class="node">
<title>L9_S1_TP0_GPU8_moe_res</title>
<polygon fill="none" stroke="black" points="83355,-436.33 82535,-436.33 82535,-368.33 83355,-368.33 83355,-436.33"/>
<text text-anchor="middle" x="82945" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="82945" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="82945" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="82945" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP0_GPU8_mha_res&#45;&gt;L9_S1_TP0_GPU8_moe_res -->
<g id="edge2755" class="edge">
<title>L9_S1_TP0_GPU8_mha_res&#45;&gt;L9_S1_TP0_GPU8_moe_res</title>
<path fill="none" stroke="black" d="M82683.35,-903C82614.73,-903 82566.11,-903 82566.11,-903 82566.11,-903 82566.11,-446.35 82566.11,-446.35"/>
<polygon fill="black" stroke="black" points="82569.61,-446.35 82566.11,-436.35 82562.61,-446.35 82569.61,-446.35"/>
</g>
<!-- L9_S1_TP0_GPU8_expert0 -->
<g id="node962" class="node">
<title>L9_S1_TP0_GPU8_expert0</title>
<polygon fill="none" stroke="black" points="83622.5,-672.5 83173.5,-672.5 83173.5,-604.5 83622.5,-604.5 83622.5,-672.5"/>
<text text-anchor="middle" x="83398" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="83398" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="83398" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="83398" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L9_S1_TP0_GPU8_gate&#45;&gt;L9_S1_TP0_GPU8_expert0 -->
<g id="edge2736" class="edge">
<title>L9_S1_TP0_GPU8_gate&#45;&gt;L9_S1_TP0_GPU8_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M83398,-708.31C83398,-708.31 83398,-682.71 83398,-682.71"/>
<polygon fill="black" stroke="black" points="83401.5,-682.71 83398,-672.71 83394.5,-682.71 83401.5,-682.71"/>
</g>
<!-- L9_S1_TP0_GPU8_expert1 -->
<g id="node963" class="node">
<title>L9_S1_TP0_GPU8_expert1</title>
<polygon fill="none" stroke="black" points="84089.5,-672.5 83640.5,-672.5 83640.5,-604.5 84089.5,-604.5 84089.5,-672.5"/>
<text text-anchor="middle" x="83865" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="83865" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="83865" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="83865" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L9_S1_TP0_GPU8_gate&#45;&gt;L9_S1_TP0_GPU8_expert1 -->
<g id="edge2737" class="edge">
<title>L9_S1_TP0_GPU8_gate&#45;&gt;L9_S1_TP0_GPU8_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M83648.64,-776.4C83648.64,-776.4 83648.64,-682.74 83648.64,-682.74"/>
<polygon fill="black" stroke="black" points="83652.14,-682.74 83648.64,-672.74 83645.14,-682.74 83652.14,-682.74"/>
</g>
<!-- L9_S1_TP0_GPU8_moe_ar -->
<g id="node964" class="node">
<title>L9_S1_TP0_GPU8_moe_ar</title>
<ellipse fill="none" stroke="black" cx="84496" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="84496" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="84496" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="84496" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="84496" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP0_GPU8_expert0&#45;&gt;L9_S1_TP0_GPU8_moe_ar -->
<g id="edge2738" class="edge">
<title>L9_S1_TP0_GPU8_expert0&#45;&gt;L9_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M83592.78,-604.37C83592.78,-563.08 83592.78,-499 83592.78,-499 83592.78,-499 84186.49,-499 84186.49,-499"/>
<polygon fill="black" stroke="black" points="84186.49,-502.5 84196.49,-499 84186.49,-495.5 84186.49,-502.5"/>
</g>
<!-- L9_S1_TP1_GPU9_moe_ar -->
<g id="node988" class="node">
<title>L9_S1_TP1_GPU9_moe_ar</title>
<ellipse fill="none" stroke="black" cx="85183" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="85183" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="85183" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="85183" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="85183" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP0_GPU8_expert0&#45;&gt;L9_S1_TP1_GPU9_moe_ar -->
<g id="edge2774" class="edge">
<title>L9_S1_TP0_GPU8_expert0&#45;&gt;L9_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M83563.06,-604.25C83563.06,-587.12 83563.06,-570 83563.06,-570 83563.06,-570 84866.03,-570 84866.03,-570 84866.03,-570 84866.03,-545.83 84866.03,-545.83"/>
<polygon fill="black" stroke="black" points="84869.53,-545.83 84866.03,-535.83 84862.53,-545.83 84869.53,-545.83"/>
</g>
<!-- L9_S1_TP2_GPU10_moe_ar -->
<g id="node998" class="node">
<title>L9_S1_TP2_GPU10_moe_ar</title>
<ellipse fill="none" stroke="black" cx="85870" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="85870" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="85870" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="85870" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="85870" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP0_GPU8_expert0&#45;&gt;L9_S1_TP2_GPU10_moe_ar -->
<g id="edge2810" class="edge">
<title>L9_S1_TP0_GPU8_expert0&#45;&gt;L9_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M83533.33,-604.1C83533.33,-547.51 83533.33,-441 83533.33,-441 83533.33,-441 85595.77,-441 85595.77,-441 85595.77,-441 85595.77,-482.64 85595.77,-482.64"/>
<polygon fill="black" stroke="black" points="85592.27,-482.64 85595.77,-492.64 85599.27,-482.64 85592.27,-482.64"/>
</g>
<!-- L9_S1_TP3_GPU11_moe_ar -->
<g id="node1008" class="node">
<title>L9_S1_TP3_GPU11_moe_ar</title>
<ellipse fill="none" stroke="black" cx="86557" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="86557" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="86557" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="86557" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="86557" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP0_GPU8_expert0&#45;&gt;L9_S1_TP3_GPU11_moe_ar -->
<g id="edge2846" class="edge">
<title>L9_S1_TP0_GPU8_expert0&#45;&gt;L9_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M83503.61,-604.1C83503.61,-547.51 83503.61,-441 83503.61,-441 83503.61,-441 86433.36,-441 86433.36,-441 86433.36,-441 86433.36,-465.6 86433.36,-465.6"/>
<polygon fill="black" stroke="black" points="86429.86,-465.6 86433.36,-475.6 86436.86,-465.6 86429.86,-465.6"/>
</g>
<!-- L9_S1_TP4_GPU12_moe_ar -->
<g id="node1018" class="node">
<title>L9_S1_TP4_GPU12_moe_ar</title>
<ellipse fill="none" stroke="black" cx="87244" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="87244" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="87244" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="87244" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="87244" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP0_GPU8_expert0&#45;&gt;L9_S1_TP4_GPU12_moe_ar -->
<g id="edge2882" class="edge">
<title>L9_S1_TP0_GPU8_expert0&#45;&gt;L9_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M83473.89,-604.38C83473.89,-547.62 83473.89,-440 83473.89,-440 83473.89,-440 86945.88,-440 86945.88,-440 86945.88,-440 86945.88,-488.44 86945.88,-488.44"/>
<polygon fill="black" stroke="black" points="86942.38,-488.44 86945.88,-498.44 86949.38,-488.44 86942.38,-488.44"/>
</g>
<!-- L9_S1_TP5_GPU13_moe_ar -->
<g id="node1028" class="node">
<title>L9_S1_TP5_GPU13_moe_ar</title>
<ellipse fill="none" stroke="black" cx="87931" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="87931" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="87931" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="87931" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="87931" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP0_GPU8_expert0&#45;&gt;L9_S1_TP5_GPU13_moe_ar -->
<g id="edge2918" class="edge">
<title>L9_S1_TP0_GPU8_expert0&#45;&gt;L9_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M83444.17,-604.38C83444.17,-547.62 83444.17,-440 83444.17,-440 83444.17,-440 87732.63,-440 87732.63,-440 87732.63,-440 87732.63,-471.62 87732.63,-471.62"/>
<polygon fill="black" stroke="black" points="87729.13,-471.62 87732.63,-481.62 87736.13,-471.62 87729.13,-471.62"/>
</g>
<!-- L9_S1_TP6_GPU14_moe_ar -->
<g id="node1038" class="node">
<title>L9_S1_TP6_GPU14_moe_ar</title>
<ellipse fill="none" stroke="black" cx="88618" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="88618" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="88618" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="88618" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="88618" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP0_GPU8_expert0&#45;&gt;L9_S1_TP6_GPU14_moe_ar -->
<g id="edge2954" class="edge">
<title>L9_S1_TP0_GPU8_expert0&#45;&gt;L9_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M83414.44,-604.38C83414.44,-547.62 83414.44,-440 83414.44,-440 83414.44,-440 88481.13,-440 88481.13,-440 88481.13,-440 88481.13,-466.44 88481.13,-466.44"/>
<polygon fill="black" stroke="black" points="88477.63,-466.44 88481.13,-476.44 88484.63,-466.44 88477.63,-466.44"/>
</g>
<!-- L9_S1_TP7_GPU15_moe_ar -->
<g id="node1048" class="node">
<title>L9_S1_TP7_GPU15_moe_ar</title>
<ellipse fill="none" stroke="black" cx="89305" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="89305" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="89305" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="89305" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="89305" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP0_GPU8_expert0&#45;&gt;L9_S1_TP7_GPU15_moe_ar -->
<g id="edge2990" class="edge">
<title>L9_S1_TP0_GPU8_expert0&#45;&gt;L9_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M83384.72,-604.38C83384.72,-547.62 83384.72,-440 83384.72,-440 83384.72,-440 89267.88,-440 89267.88,-440 89267.88,-440 89267.88,-462.25 89267.88,-462.25"/>
<polygon fill="black" stroke="black" points="89264.38,-462.24 89267.88,-472.25 89271.38,-462.25 89264.38,-462.24"/>
</g>
<!-- L9_S1_TP0_GPU8_expert1&#45;&gt;L9_S1_TP0_GPU8_moe_ar -->
<g id="edge2739" class="edge">
<title>L9_S1_TP0_GPU8_expert1&#45;&gt;L9_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M84055.81,-604.21C84055.81,-567.05 84055.81,-513 84055.81,-513 84055.81,-513 84155.47,-513 84155.47,-513"/>
<polygon fill="black" stroke="black" points="84155.47,-516.5 84165.47,-513 84155.47,-509.5 84155.47,-516.5"/>
</g>
<!-- L9_S1_TP0_GPU8_expert1&#45;&gt;L9_S1_TP1_GPU9_moe_ar -->
<g id="edge2775" class="edge">
<title>L9_S1_TP0_GPU8_expert1&#45;&gt;L9_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M84022.12,-604.25C84022.12,-587.12 84022.12,-570 84022.12,-570 84022.12,-570 84883.53,-570 84883.53,-570 84883.53,-570 84883.53,-552.02 84883.53,-552.02"/>
<polygon fill="black" stroke="black" points="84887.03,-552.02 84883.53,-542.02 84880.03,-552.02 84887.03,-552.02"/>
</g>
<!-- L9_S1_TP0_GPU8_expert1&#45;&gt;L9_S1_TP2_GPU10_moe_ar -->
<g id="edge2811" class="edge">
<title>L9_S1_TP0_GPU8_expert1&#45;&gt;L9_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M83988.44,-604.1C83988.44,-547.51 83988.44,-441 83988.44,-441 83988.44,-441 85565.65,-441 85565.65,-441 85565.65,-441 85565.65,-490.38 85565.65,-490.38"/>
<polygon fill="black" stroke="black" points="85562.15,-490.38 85565.65,-500.38 85569.15,-490.38 85562.15,-490.38"/>
</g>
<!-- L9_S1_TP0_GPU8_expert1&#45;&gt;L9_S1_TP3_GPU11_moe_ar -->
<g id="edge2847" class="edge">
<title>L9_S1_TP0_GPU8_expert1&#45;&gt;L9_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M83882.36,-672.68C83882.36,-687.27 83882.36,-701 83882.36,-701 83882.36,-701 86433.5,-701 86433.5,-701 86433.5,-701 86433.5,-575.52 86433.5,-575.52"/>
<polygon fill="black" stroke="black" points="86437,-575.52 86433.5,-565.52 86430,-575.52 86437,-575.52"/>
</g>
<!-- L9_S1_TP0_GPU8_expert1&#45;&gt;L9_S1_TP4_GPU12_moe_ar -->
<g id="edge2883" class="edge">
<title>L9_S1_TP0_GPU8_expert1&#45;&gt;L9_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M83954.75,-604.1C83954.75,-547.51 83954.75,-441 83954.75,-441 83954.75,-441 86933.77,-441 86933.77,-441 86933.77,-441 86933.77,-492.4 86933.77,-492.4"/>
<polygon fill="black" stroke="black" points="86930.27,-492.4 86933.77,-502.4 86937.27,-492.4 86930.27,-492.4"/>
</g>
<!-- L9_S1_TP0_GPU8_expert1&#45;&gt;L9_S1_TP5_GPU13_moe_ar -->
<g id="edge2919" class="edge">
<title>L9_S1_TP0_GPU8_expert1&#45;&gt;L9_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M83921.06,-604.1C83921.06,-547.51 83921.06,-441 83921.06,-441 83921.06,-441 87687.27,-441 87687.27,-441 87687.27,-441 87687.27,-477.2 87687.27,-477.2"/>
<polygon fill="black" stroke="black" points="87683.77,-477.2 87687.27,-487.2 87690.77,-477.2 87683.77,-477.2"/>
</g>
<!-- L9_S1_TP0_GPU8_expert1&#45;&gt;L9_S1_TP6_GPU14_moe_ar -->
<g id="edge2955" class="edge">
<title>L9_S1_TP0_GPU8_expert1&#45;&gt;L9_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M83887.38,-604.1C83887.38,-547.51 83887.38,-441 83887.38,-441 83887.38,-441 88415.27,-441 88415.27,-441 88415.27,-441 88415.27,-472.1 88415.27,-472.1"/>
<polygon fill="black" stroke="black" points="88411.77,-472.1 88415.27,-482.1 88418.77,-472.1 88411.77,-472.1"/>
</g>
<!-- L9_S1_TP0_GPU8_expert1&#45;&gt;L9_S1_TP7_GPU15_moe_ar -->
<g id="edge2991" class="edge">
<title>L9_S1_TP0_GPU8_expert1&#45;&gt;L9_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M83853.69,-604.1C83853.69,-547.51 83853.69,-441 83853.69,-441 83853.69,-441 89168.77,-441 89168.77,-441 89168.77,-441 89168.77,-466.06 89168.77,-466.06"/>
<polygon fill="black" stroke="black" points="89165.27,-466.06 89168.77,-476.06 89172.27,-466.06 89165.27,-466.06"/>
</g>
<!-- L9_S1_TP0_GPU8_moe_ar&#45;&gt;L9_S1_TP0_GPU8_moe_res -->
<g id="edge2754" class="edge">
<title>L9_S1_TP0_GPU8_moe_ar&#45;&gt;L9_S1_TP0_GPU8_moe_res</title>
<path fill="none" stroke="black" d="M84262.14,-486C83904.9,-486 83264.25,-486 83264.25,-486 83264.25,-486 83264.25,-446.36 83264.25,-446.36"/>
<polygon fill="black" stroke="black" points="83267.75,-446.36 83264.25,-436.36 83260.75,-446.36 83267.75,-446.36"/>
</g>
<!-- L9_S1_TP1_GPU9_expert0 -->
<g id="node965" class="node">
<title>L9_S1_TP1_GPU9_expert0</title>
<polygon fill="none" stroke="black" points="84556.5,-672.5 84107.5,-672.5 84107.5,-604.5 84556.5,-604.5 84556.5,-672.5"/>
<text text-anchor="middle" x="84332" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="84332" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="84332" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="84332" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L9_S1_TP1_GPU9_expert0&#45;&gt;L9_S1_TP0_GPU8_moe_ar -->
<g id="edge2740" class="edge">
<title>L9_S1_TP1_GPU9_expert0&#45;&gt;L9_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M84240.53,-604.34C84240.53,-604.34 84240.53,-561.67 84240.53,-561.67"/>
<polygon fill="black" stroke="black" points="84244.03,-561.67 84240.53,-551.67 84237.03,-561.67 84244.03,-561.67"/>
</g>
<!-- L9_S1_TP1_GPU9_expert0&#45;&gt;L9_S1_TP1_GPU9_moe_ar -->
<g id="edge2776" class="edge">
<title>L9_S1_TP1_GPU9_expert0&#45;&gt;L9_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M84319.52,-604.25C84319.52,-587.12 84319.52,-570 84319.52,-570 84319.52,-570 84901.03,-570 84901.03,-570 84901.03,-570 84901.03,-556.37 84901.03,-556.37"/>
<polygon fill="black" stroke="black" points="84904.53,-556.37 84901.03,-546.37 84897.53,-556.37 84904.53,-556.37"/>
</g>
<!-- L9_S1_TP1_GPU9_expert0&#45;&gt;L9_S1_TP2_GPU10_moe_ar -->
<g id="edge2812" class="edge">
<title>L9_S1_TP1_GPU9_expert0&#45;&gt;L9_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M84398.52,-604.25C84398.52,-587.12 84398.52,-570 84398.52,-570 84398.52,-570 85588.28,-570 85588.28,-570 85588.28,-570 85588.28,-556.37 85588.28,-556.37"/>
<polygon fill="black" stroke="black" points="85591.78,-556.37 85588.28,-546.37 85584.78,-556.37 85591.78,-556.37"/>
</g>
<!-- L9_S1_TP1_GPU9_expert0&#45;&gt;L9_S1_TP3_GPU11_moe_ar -->
<g id="edge2848" class="edge">
<title>L9_S1_TP1_GPU9_expert0&#45;&gt;L9_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M84477.51,-604.35C84477.51,-587.61 84477.51,-571 84477.51,-571 84477.51,-571 86247.78,-571 86247.78,-571 86247.78,-571 86247.78,-548.96 86247.78,-548.96"/>
<polygon fill="black" stroke="black" points="86251.28,-548.96 86247.78,-538.96 86244.28,-548.96 86251.28,-548.96"/>
</g>
<!-- L9_S1_TP1_GPU9_expert0&#45;&gt;L9_S1_TP4_GPU12_moe_ar -->
<g id="edge2884" class="edge">
<title>L9_S1_TP1_GPU9_expert0&#45;&gt;L9_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M84148.03,-604.42C84148.03,-554.15 84148.03,-466 84148.03,-466 84148.03,-466 86921.65,-466 86921.65,-466 86921.65,-466 86921.65,-497.52 86921.65,-497.52"/>
<polygon fill="black" stroke="black" points="86918.15,-497.52 86921.65,-507.52 86925.15,-497.52 86918.15,-497.52"/>
</g>
<!-- L9_S1_TP1_GPU9_expert0&#45;&gt;L9_S1_TP5_GPU13_moe_ar -->
<g id="edge2920" class="edge">
<title>L9_S1_TP1_GPU9_expert0&#45;&gt;L9_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M84134.52,-604.42C84134.52,-554.15 84134.52,-466 84134.52,-466 84134.52,-466 87641.9,-466 87641.9,-466 87641.9,-466 87641.9,-486.07 87641.9,-486.07"/>
<polygon fill="black" stroke="black" points="87638.4,-486.07 87641.9,-496.07 87645.4,-486.07 87638.4,-486.07"/>
</g>
<!-- L9_S1_TP1_GPU9_expert0&#45;&gt;L9_S1_TP6_GPU14_moe_ar -->
<g id="edge2956" class="edge">
<title>L9_S1_TP1_GPU9_expert0&#45;&gt;L9_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M84121.01,-604.42C84121.01,-554.15 84121.01,-466 84121.01,-466 84121.01,-466 88349.4,-466 88349.4,-466 88349.4,-466 88349.4,-481.61 88349.4,-481.61"/>
<polygon fill="black" stroke="black" points="88345.9,-481.61 88349.4,-491.61 88352.9,-481.61 88345.9,-481.61"/>
</g>
<!-- L9_S1_TP1_GPU9_expert0&#45;&gt;L9_S1_TP7_GPU15_moe_ar -->
<g id="edge2992" class="edge">
<title>L9_S1_TP1_GPU9_expert0&#45;&gt;L9_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M84406.83,-672.64C84406.83,-682.67 84406.83,-691 84406.83,-691 84406.83,-691 89240.9,-691 89240.9,-691 89240.9,-691 89240.9,-577.93 89240.9,-577.93"/>
<polygon fill="black" stroke="black" points="89244.4,-577.93 89240.9,-567.93 89237.4,-577.93 89244.4,-577.93"/>
</g>
<!-- L9_S1_TP1_GPU9_expert1 -->
<g id="node966" class="node">
<title>L9_S1_TP1_GPU9_expert1</title>
<polygon fill="none" stroke="black" points="85023.5,-672.5 84574.5,-672.5 84574.5,-604.5 85023.5,-604.5 85023.5,-672.5"/>
<text text-anchor="middle" x="84799" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="84799" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="84799" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="84799" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L9_S1_TP1_GPU9_expert1&#45;&gt;L9_S1_TP0_GPU8_moe_ar -->
<g id="edge2741" class="edge">
<title>L9_S1_TP1_GPU9_expert1&#45;&gt;L9_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M84600.1,-604.34C84600.1,-604.34 84600.1,-576.36 84600.1,-576.36"/>
<polygon fill="black" stroke="black" points="84603.6,-576.36 84600.1,-566.36 84596.6,-576.36 84603.6,-576.36"/>
</g>
<!-- L9_S1_TP1_GPU9_expert1&#45;&gt;L9_S1_TP1_GPU9_moe_ar -->
<g id="edge2777" class="edge">
<title>L9_S1_TP1_GPU9_expert1&#45;&gt;L9_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M84918.52,-604.34C84918.52,-604.34 84918.52,-560.09 84918.52,-560.09"/>
<polygon fill="black" stroke="black" points="84922.02,-560.09 84918.52,-550.09 84915.02,-560.09 84922.02,-560.09"/>
</g>
<!-- L9_S1_TP1_GPU9_expert1&#45;&gt;L9_S1_TP2_GPU10_moe_ar -->
<g id="edge2813" class="edge">
<title>L9_S1_TP1_GPU9_expert1&#45;&gt;L9_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M84953.52,-604.25C84953.52,-587.12 84953.52,-570 84953.52,-570 84953.52,-570 85641.03,-570 85641.03,-570 85641.03,-570 85641.03,-565.66 85641.03,-565.66"/>
<polygon fill="black" stroke="black" points="85644.53,-565.66 85641.03,-555.66 85637.53,-565.66 85644.53,-565.66"/>
</g>
<!-- L9_S1_TP1_GPU9_expert1&#45;&gt;L9_S1_TP3_GPU11_moe_ar -->
<g id="edge2849" class="edge">
<title>L9_S1_TP1_GPU9_expert1&#45;&gt;L9_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M84971.01,-604.35C84971.01,-587.61 84971.01,-571 84971.01,-571 84971.01,-571 86273.03,-571 86273.03,-571 86273.03,-571 86273.03,-556 86273.03,-556"/>
<polygon fill="black" stroke="black" points="86276.53,-556 86273.03,-546 86269.53,-556 86276.53,-556"/>
</g>
<!-- L9_S1_TP1_GPU9_expert1&#45;&gt;L9_S1_TP4_GPU12_moe_ar -->
<g id="edge2885" class="edge">
<title>L9_S1_TP1_GPU9_expert1&#45;&gt;L9_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M84988.51,-604.35C84988.51,-587.61 84988.51,-571 84988.51,-571 84988.51,-571 86954.43,-571 86954.43,-571 86954.43,-571 86954.43,-554.52 86954.43,-554.52"/>
<polygon fill="black" stroke="black" points="86957.93,-554.52 86954.43,-544.52 86950.93,-554.52 86957.93,-554.52"/>
</g>
<!-- L9_S1_TP1_GPU9_expert1&#45;&gt;L9_S1_TP5_GPU13_moe_ar -->
<g id="edge2921" class="edge">
<title>L9_S1_TP1_GPU9_expert1&#45;&gt;L9_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M84933.41,-672.56C84933.41,-682.14 84933.41,-690 84933.41,-690 84933.41,-690 87834.5,-690 87834.5,-690 87834.5,-690 87834.5,-576.76 87834.5,-576.76"/>
<polygon fill="black" stroke="black" points="87838,-576.76 87834.5,-566.76 87831,-576.76 87838,-576.76"/>
</g>
<!-- L9_S1_TP1_GPU9_expert1&#45;&gt;L9_S1_TP6_GPU14_moe_ar -->
<g id="edge2957" class="edge">
<title>L9_S1_TP1_GPU9_expert1&#45;&gt;L9_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M84843.31,-672.64C84843.31,-682.67 84843.31,-691 84843.31,-691 84843.31,-691 88307.93,-691 88307.93,-691 88307.93,-691 88307.93,-548.67 88307.93,-548.67"/>
<polygon fill="black" stroke="black" points="88311.43,-548.67 88307.93,-538.67 88304.43,-548.67 88311.43,-548.67"/>
</g>
<!-- L9_S1_TP1_GPU9_expert1&#45;&gt;L9_S1_TP7_GPU15_moe_ar -->
<g id="edge2993" class="edge">
<title>L9_S1_TP1_GPU9_expert1&#45;&gt;L9_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M85006,-604.35C85006,-587.61 85006,-571 85006,-571 85006,-571 89027.42,-571 89027.42,-571 89027.42,-571 89027.42,-557.49 89027.42,-557.49"/>
<polygon fill="black" stroke="black" points="89030.92,-557.49 89027.42,-547.49 89023.92,-557.49 89030.92,-557.49"/>
</g>
<!-- L9_S1_TP2_GPU10_expert0 -->
<g id="node967" class="node">
<title>L9_S1_TP2_GPU10_expert0</title>
<polygon fill="none" stroke="black" points="85490.5,-672.5 85041.5,-672.5 85041.5,-604.5 85490.5,-604.5 85490.5,-672.5"/>
<text text-anchor="middle" x="85266" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="85266" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="85266" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="85266" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L9_S1_TP2_GPU10_expert0&#45;&gt;L9_S1_TP0_GPU8_moe_ar -->
<g id="edge2742" class="edge">
<title>L9_S1_TP2_GPU10_expert0&#45;&gt;L9_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M85086.4,-604.39C85086.4,-602.89 85086.4,-602 85086.4,-602 85086.4,-602 84625.69,-602 84625.69,-602 84625.69,-602 84625.69,-575.03 84625.69,-575.03"/>
<polygon fill="black" stroke="black" points="84629.19,-575.03 84625.69,-565.03 84622.19,-575.03 84629.19,-575.03"/>
</g>
<!-- L9_S1_TP2_GPU10_expert0&#45;&gt;L9_S1_TP1_GPU9_moe_ar -->
<g id="edge2778" class="edge">
<title>L9_S1_TP2_GPU10_expert0&#45;&gt;L9_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M85131.3,-604.34C85131.3,-604.34 85131.3,-578.11 85131.3,-578.11"/>
<polygon fill="black" stroke="black" points="85134.8,-578.11 85131.3,-568.11 85127.8,-578.11 85134.8,-578.11"/>
</g>
<!-- L9_S1_TP2_GPU10_expert0&#45;&gt;L9_S1_TP2_GPU10_moe_ar -->
<g id="edge2814" class="edge">
<title>L9_S1_TP2_GPU10_expert0&#45;&gt;L9_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M85266,-604.25C85266,-587.12 85266,-570 85266,-570 85266,-570 85693.77,-570 85693.77,-570 85693.77,-570 85693.77,-569.14 85693.77,-569.14"/>
<polygon fill="black" stroke="black" points="85697.27,-571.36 85693.77,-561.36 85690.27,-571.36 85697.27,-571.36"/>
</g>
<!-- L9_S1_TP2_GPU10_expert0&#45;&gt;L9_S1_TP3_GPU11_moe_ar -->
<g id="edge2850" class="edge">
<title>L9_S1_TP2_GPU10_expert0&#45;&gt;L9_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M85310.9,-604.35C85310.9,-587.61 85310.9,-571 85310.9,-571 85310.9,-571 86298.27,-571 86298.27,-571 86298.27,-571 86298.27,-561.01 86298.27,-561.01"/>
<polygon fill="black" stroke="black" points="86301.77,-561.01 86298.27,-551.01 86294.77,-561.01 86301.77,-561.01"/>
</g>
<!-- L9_S1_TP2_GPU10_expert0&#45;&gt;L9_S1_TP4_GPU12_moe_ar -->
<g id="edge2886" class="edge">
<title>L9_S1_TP2_GPU10_expert0&#45;&gt;L9_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M85355.8,-604.35C85355.8,-587.61 85355.8,-571 85355.8,-571 85355.8,-571 86999.33,-571 86999.33,-571 86999.33,-571 86999.33,-563.31 86999.33,-563.31"/>
<polygon fill="black" stroke="black" points="87002.83,-563.31 86999.33,-553.31 86995.83,-563.31 87002.83,-563.31"/>
</g>
<!-- L9_S1_TP2_GPU10_expert0&#45;&gt;L9_S1_TP5_GPU13_moe_ar -->
<g id="edge2922" class="edge">
<title>L9_S1_TP2_GPU10_expert0&#45;&gt;L9_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M85400.7,-604.35C85400.7,-587.61 85400.7,-571 85400.7,-571 85400.7,-571 87621.98,-571 87621.98,-571 87621.98,-571 87621.98,-548.96 87621.98,-548.96"/>
<polygon fill="black" stroke="black" points="87625.48,-548.96 87621.98,-538.96 87618.48,-548.96 87625.48,-548.96"/>
</g>
<!-- L9_S1_TP2_GPU10_expert0&#45;&gt;L9_S1_TP6_GPU14_moe_ar -->
<g id="edge2958" class="edge">
<title>L9_S1_TP2_GPU10_expert0&#45;&gt;L9_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M85340.83,-672.56C85340.83,-682.14 85340.83,-690 85340.83,-690 85340.83,-690 88305.36,-690 88305.36,-690 88305.36,-690 88305.36,-547.61 88305.36,-547.61"/>
<polygon fill="black" stroke="black" points="88308.86,-547.61 88305.36,-537.61 88301.86,-547.61 88308.86,-547.61"/>
</g>
<!-- L9_S1_TP2_GPU10_expert0&#45;&gt;L9_S1_TP7_GPU15_moe_ar -->
<g id="edge2994" class="edge">
<title>L9_S1_TP2_GPU10_expert0&#45;&gt;L9_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M85445.6,-604.47C85445.6,-588.11 85445.6,-572 85445.6,-572 85445.6,-572 89055.86,-572 89055.86,-572 89055.86,-572 89055.86,-562.5 89055.86,-562.5"/>
<polygon fill="black" stroke="black" points="89059.36,-562.5 89055.86,-552.5 89052.36,-562.5 89059.36,-562.5"/>
</g>
<!-- L9_S1_TP2_GPU10_expert1 -->
<g id="node968" class="node">
<title>L9_S1_TP2_GPU10_expert1</title>
<polygon fill="none" stroke="black" points="85957.5,-672.5 85508.5,-672.5 85508.5,-604.5 85957.5,-604.5 85957.5,-672.5"/>
<text text-anchor="middle" x="85733" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="85733" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="85733" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="85733" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L9_S1_TP2_GPU10_expert1&#45;&gt;L9_S1_TP0_GPU8_moe_ar -->
<g id="edge2743" class="edge">
<title>L9_S1_TP2_GPU10_expert1&#45;&gt;L9_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M85523.49,-604.47C85523.49,-588.11 85523.49,-572 85523.49,-572 85523.49,-572 84651.29,-572 84651.29,-572 84651.29,-572 84651.29,-571.1 84651.29,-571.1"/>
<polygon fill="black" stroke="black" points="84654.79,-573.01 84651.29,-563.01 84647.79,-573.01 84654.79,-573.01"/>
</g>
<!-- L9_S1_TP2_GPU10_expert1&#45;&gt;L9_S1_TP1_GPU9_moe_ar -->
<g id="edge2779" class="edge">
<title>L9_S1_TP2_GPU10_expert1&#45;&gt;L9_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M85512.98,-604.34C85512.98,-604.34 85512.98,-538.63 85512.98,-538.63"/>
<polygon fill="black" stroke="black" points="85516.48,-538.63 85512.98,-528.63 85509.48,-538.63 85516.48,-538.63"/>
</g>
<!-- L9_S1_TP2_GPU10_expert1&#45;&gt;L9_S1_TP2_GPU10_moe_ar -->
<g id="edge2815" class="edge">
<title>L9_S1_TP2_GPU10_expert1&#45;&gt;L9_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M85746.52,-604.34C85746.52,-604.34 85746.52,-575.49 85746.52,-575.49"/>
<polygon fill="black" stroke="black" points="85750.02,-575.49 85746.52,-565.49 85743.02,-575.49 85750.02,-575.49"/>
</g>
<!-- L9_S1_TP2_GPU10_expert1&#45;&gt;L9_S1_TP3_GPU11_moe_ar -->
<g id="edge2851" class="edge">
<title>L9_S1_TP2_GPU10_expert1&#45;&gt;L9_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M85799.26,-604.35C85799.26,-587.61 85799.26,-571 85799.26,-571 85799.26,-571 86323.52,-571 86323.52,-571 86323.52,-571 86323.52,-565 86323.52,-565"/>
<polygon fill="black" stroke="black" points="86327.02,-564.99 86323.52,-555 86320.02,-565 86327.02,-564.99"/>
</g>
<!-- L9_S1_TP2_GPU10_expert1&#45;&gt;L9_S1_TP4_GPU12_moe_ar -->
<g id="edge2887" class="edge">
<title>L9_S1_TP2_GPU10_expert1&#45;&gt;L9_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M85852.01,-604.35C85852.01,-587.61 85852.01,-571 85852.01,-571 85852.01,-571 87044.23,-571 87044.23,-571 87044.23,-571 87044.23,-569.01 87044.23,-569.01"/>
<polygon fill="black" stroke="black" points="87047.73,-569.01 87044.23,-559.01 87040.73,-569.01 87047.73,-569.01"/>
</g>
<!-- L9_S1_TP2_GPU10_expert1&#45;&gt;L9_S1_TP5_GPU13_moe_ar -->
<g id="edge2923" class="edge">
<title>L9_S1_TP2_GPU10_expert1&#45;&gt;L9_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M85904.75,-604.35C85904.75,-587.61 85904.75,-571 85904.75,-571 85904.75,-571 87647.42,-571 87647.42,-571 87647.42,-571 87647.42,-556 87647.42,-556"/>
<polygon fill="black" stroke="black" points="87650.92,-556 87647.42,-546 87643.92,-556 87650.92,-556"/>
</g>
<!-- L9_S1_TP2_GPU10_expert1&#45;&gt;L9_S1_TP6_GPU14_moe_ar -->
<g id="edge2959" class="edge">
<title>L9_S1_TP2_GPU10_expert1&#45;&gt;L9_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M85915.41,-672.56C85915.41,-682.14 85915.41,-690 85915.41,-690 85915.41,-690 88302.79,-690 88302.79,-690 88302.79,-690 88302.79,-546.68 88302.79,-546.68"/>
<polygon fill="black" stroke="black" points="88306.29,-546.68 88302.79,-536.68 88299.29,-546.68 88306.29,-546.68"/>
</g>
<!-- L9_S1_TP2_GPU10_expert1&#45;&gt;L9_S1_TP7_GPU15_moe_ar -->
<g id="edge2995" class="edge">
<title>L9_S1_TP2_GPU10_expert1&#45;&gt;L9_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M85873.31,-672.56C85873.31,-682.14 85873.31,-690 85873.31,-690 85873.31,-690 89237.3,-690 89237.3,-690 89237.3,-690 89237.3,-577.65 89237.3,-577.65"/>
<polygon fill="black" stroke="black" points="89240.8,-577.65 89237.3,-567.65 89233.8,-577.65 89240.8,-577.65"/>
</g>
<!-- L9_S1_TP3_GPU11_expert0 -->
<g id="node969" class="node">
<title>L9_S1_TP3_GPU11_expert0</title>
<polygon fill="none" stroke="black" points="86424.5,-672.5 85975.5,-672.5 85975.5,-604.5 86424.5,-604.5 86424.5,-672.5"/>
<text text-anchor="middle" x="86200" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="86200" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="86200" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="86200" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L9_S1_TP3_GPU11_expert0&#45;&gt;L9_S1_TP0_GPU8_moe_ar -->
<g id="edge2744" class="edge">
<title>L9_S1_TP3_GPU11_expert0&#45;&gt;L9_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M86004.12,-604.47C86004.12,-588.11 86004.12,-572 86004.12,-572 86004.12,-572 84676.88,-572 84676.88,-572 84676.88,-572 84676.88,-570.91 84676.88,-570.91"/>
<polygon fill="black" stroke="black" points="84680.38,-571.06 84676.88,-561.06 84673.38,-571.06 84680.38,-571.06"/>
</g>
<!-- L9_S1_TP3_GPU11_expert0&#45;&gt;L9_S1_TP1_GPU9_moe_ar -->
<g id="edge2780" class="edge">
<title>L9_S1_TP3_GPU11_expert0&#45;&gt;L9_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M86032.74,-604.35C86032.74,-587.61 86032.74,-571 86032.74,-571 86032.74,-571 85503.36,-571 85503.36,-571 85503.36,-571 85503.36,-544.24 85503.36,-544.24"/>
<polygon fill="black" stroke="black" points="85506.86,-544.24 85503.36,-534.24 85499.86,-544.24 85506.86,-544.24"/>
</g>
<!-- L9_S1_TP3_GPU11_expert0&#45;&gt;L9_S1_TP2_GPU10_moe_ar -->
<g id="edge2816" class="edge">
<title>L9_S1_TP3_GPU11_expert0&#45;&gt;L9_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M86061.36,-604.34C86061.36,-604.34 86061.36,-569.91 86061.36,-569.91"/>
<polygon fill="black" stroke="black" points="86064.86,-569.91 86061.36,-559.91 86057.86,-569.91 86064.86,-569.91"/>
</g>
<!-- L9_S1_TP3_GPU11_expert0&#45;&gt;L9_S1_TP3_GPU11_moe_ar -->
<g id="edge2852" class="edge">
<title>L9_S1_TP3_GPU11_expert0&#45;&gt;L9_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M86348.76,-604.34C86348.76,-604.34 86348.76,-568.22 86348.76,-568.22"/>
<polygon fill="black" stroke="black" points="86352.26,-568.22 86348.76,-558.22 86345.26,-568.22 86352.26,-568.22"/>
</g>
<!-- L9_S1_TP3_GPU11_expert0&#45;&gt;L9_S1_TP4_GPU12_moe_ar -->
<g id="edge2888" class="edge">
<title>L9_S1_TP3_GPU11_expert0&#45;&gt;L9_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M86374.01,-604.35C86374.01,-587.61 86374.01,-571 86374.01,-571 86374.01,-571 87134.02,-571 87134.02,-571 87134.02,-571 87134.02,-570.5 87134.02,-570.5"/>
<polygon fill="black" stroke="black" points="87137.52,-575.96 87134.02,-565.96 87130.52,-575.96 87137.52,-575.96"/>
</g>
<!-- L9_S1_TP3_GPU11_expert0&#45;&gt;L9_S1_TP5_GPU13_moe_ar -->
<g id="edge2924" class="edge">
<title>L9_S1_TP3_GPU11_expert0&#45;&gt;L9_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M86399.25,-604.35C86399.25,-587.61 86399.25,-571 86399.25,-571 86399.25,-571 87672.86,-571 87672.86,-571 87672.86,-571 87672.86,-561.01 87672.86,-561.01"/>
<polygon fill="black" stroke="black" points="87676.36,-561.01 87672.86,-551.01 87669.36,-561.01 87676.36,-561.01"/>
</g>
<!-- L9_S1_TP3_GPU11_expert0&#45;&gt;L9_S1_TP6_GPU14_moe_ar -->
<g id="edge2960" class="edge">
<title>L9_S1_TP3_GPU11_expert0&#45;&gt;L9_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M86274.83,-672.56C86274.83,-682.14 86274.83,-690 86274.83,-690 86274.83,-690 88300.21,-690 88300.21,-690 88300.21,-690 88300.21,-545.47 88300.21,-545.47"/>
<polygon fill="black" stroke="black" points="88303.71,-545.47 88300.21,-535.47 88296.71,-545.47 88303.71,-545.47"/>
</g>
<!-- L9_S1_TP3_GPU11_expert0&#45;&gt;L9_S1_TP7_GPU15_moe_ar -->
<g id="edge2996" class="edge">
<title>L9_S1_TP3_GPU11_expert0&#45;&gt;L9_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M86213.5,-604.18C86213.5,-549.57 86213.5,-449 86213.5,-449 86213.5,-449 89069.65,-449 89069.65,-449 89069.65,-449 89069.65,-475.96 89069.65,-475.96"/>
<polygon fill="black" stroke="black" points="89066.15,-475.96 89069.65,-485.96 89073.15,-475.96 89066.15,-475.96"/>
</g>
<!-- L9_S1_TP3_GPU11_expert1 -->
<g id="node970" class="node">
<title>L9_S1_TP3_GPU11_expert1</title>
<polygon fill="none" stroke="black" points="86891.5,-672.5 86442.5,-672.5 86442.5,-604.5 86891.5,-604.5 86891.5,-672.5"/>
<text text-anchor="middle" x="86667" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="86667" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="86667" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="86667" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L9_S1_TP3_GPU11_expert1&#45;&gt;L9_S1_TP0_GPU8_moe_ar -->
<g id="edge2745" class="edge">
<title>L9_S1_TP3_GPU11_expert1&#45;&gt;L9_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M86492.38,-604.47C86492.38,-588.11 86492.38,-572 86492.38,-572 86492.38,-572 84702.48,-572 84702.48,-572 84702.48,-572 84702.48,-568.45 84702.48,-568.45"/>
<polygon fill="black" stroke="black" points="84705.98,-568.45 84702.48,-558.45 84698.98,-568.45 84705.98,-568.45"/>
</g>
<!-- L9_S1_TP3_GPU11_expert1&#45;&gt;L9_S1_TP1_GPU9_moe_ar -->
<g id="edge2781" class="edge">
<title>L9_S1_TP3_GPU11_expert1&#45;&gt;L9_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M86542.27,-604.35C86542.27,-587.61 86542.27,-571 86542.27,-571 86542.27,-571 85505.93,-571 85505.93,-571 85505.93,-571 85505.93,-543.18 85505.93,-543.18"/>
<polygon fill="black" stroke="black" points="85509.43,-543.18 85505.93,-533.18 85502.43,-543.18 85509.43,-543.18"/>
</g>
<!-- L9_S1_TP3_GPU11_expert1&#45;&gt;L9_S1_TP2_GPU10_moe_ar -->
<g id="edge2817" class="edge">
<title>L9_S1_TP3_GPU11_expert1&#45;&gt;L9_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M86592.15,-604.35C86592.15,-587.61 86592.15,-571 86592.15,-571 86592.15,-571 86089.98,-571 86089.98,-571 86089.98,-571 86089.98,-566.64 86089.98,-566.64"/>
<polygon fill="black" stroke="black" points="86093.48,-566.64 86089.98,-556.64 86086.48,-566.64 86093.48,-566.64"/>
</g>
<!-- L9_S1_TP3_GPU11_expert1&#45;&gt;L9_S1_TP3_GPU11_moe_ar -->
<g id="edge2853" class="edge">
<title>L9_S1_TP3_GPU11_expert1&#45;&gt;L9_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M86642.04,-604.34C86642.04,-604.34 86642.04,-577.23 86642.04,-577.23"/>
<polygon fill="black" stroke="black" points="86645.54,-577.23 86642.04,-567.23 86638.54,-577.23 86645.54,-577.23"/>
</g>
<!-- L9_S1_TP3_GPU11_expert1&#45;&gt;L9_S1_TP4_GPU12_moe_ar -->
<g id="edge2889" class="edge">
<title>L9_S1_TP3_GPU11_expert1&#45;&gt;L9_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M86891.76,-649C86897.61,-649 86900.93,-649 86900.93,-649 86900.93,-649 86900.93,-504 86900.93,-504 86900.93,-504 86919.59,-504 86919.59,-504"/>
<polygon fill="black" stroke="black" points="86919.59,-507.5 86929.59,-504 86919.59,-500.5 86919.59,-507.5"/>
</g>
<!-- L9_S1_TP3_GPU11_expert1&#45;&gt;L9_S1_TP5_GPU13_moe_ar -->
<g id="edge2925" class="edge">
<title>L9_S1_TP3_GPU11_expert1&#45;&gt;L9_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M86691.92,-604.35C86691.92,-587.61 86691.92,-571 86691.92,-571 86691.92,-571 87698.3,-571 87698.3,-571 87698.3,-571 87698.3,-565 87698.3,-565"/>
<polygon fill="black" stroke="black" points="87701.8,-564.99 87698.3,-555 87694.8,-565 87701.8,-564.99"/>
</g>
<!-- L9_S1_TP3_GPU11_expert1&#45;&gt;L9_S1_TP6_GPU14_moe_ar -->
<g id="edge2961" class="edge">
<title>L9_S1_TP3_GPU11_expert1&#45;&gt;L9_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M86778.71,-672.56C86778.71,-682.14 86778.71,-690 86778.71,-690 86778.71,-690 88297.64,-690 88297.64,-690 88297.64,-690 88297.64,-544.29 88297.64,-544.29"/>
<polygon fill="black" stroke="black" points="88301.14,-544.29 88297.64,-534.29 88294.14,-544.29 88301.14,-544.29"/>
</g>
<!-- L9_S1_TP3_GPU11_expert1&#45;&gt;L9_S1_TP7_GPU15_moe_ar -->
<g id="edge2997" class="edge">
<title>L9_S1_TP3_GPU11_expert1&#45;&gt;L9_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M86666.64,-672.56C86666.64,-682.14 86666.64,-690 86666.64,-690 86666.64,-690 89233.7,-690 89233.7,-690 89233.7,-690 89233.7,-577.65 89233.7,-577.65"/>
<polygon fill="black" stroke="black" points="89237.2,-577.65 89233.7,-567.65 89230.2,-577.65 89237.2,-577.65"/>
</g>
<!-- L9_S1_TP4_GPU12_expert0 -->
<g id="node971" class="node">
<title>L9_S1_TP4_GPU12_expert0</title>
<polygon fill="none" stroke="black" points="87358.5,-672.5 86909.5,-672.5 86909.5,-604.5 87358.5,-604.5 87358.5,-672.5"/>
<text text-anchor="middle" x="87134" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="87134" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="87134" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="87134" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L9_S1_TP4_GPU12_expert0&#45;&gt;L9_S1_TP0_GPU8_moe_ar -->
<g id="edge2746" class="edge">
<title>L9_S1_TP4_GPU12_expert0&#45;&gt;L9_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M87134,-672.56C87134,-682.14 87134,-690 87134,-690 87134,-690 84570,-690 84570,-690 84570,-690 84570,-577.65 84570,-577.65"/>
<polygon fill="black" stroke="black" points="84573.5,-577.65 84570,-567.65 84566.5,-577.65 84573.5,-577.65"/>
</g>
<!-- L9_S1_TP4_GPU12_expert0&#45;&gt;L9_S1_TP1_GPU9_moe_ar -->
<g id="edge2782" class="edge">
<title>L9_S1_TP4_GPU12_expert0&#45;&gt;L9_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M87021.75,-672.61C87021.75,-672.87 87021.75,-673 87021.75,-673 87021.75,-673 85498.21,-673 85498.21,-673 85498.21,-673 85498.21,-546.75 85498.21,-546.75"/>
<polygon fill="black" stroke="black" points="85501.71,-546.75 85498.21,-536.75 85494.71,-546.75 85501.71,-546.75"/>
</g>
<!-- L9_S1_TP4_GPU12_expert0&#45;&gt;L9_S1_TP2_GPU10_moe_ar -->
<g id="edge2818" class="edge">
<title>L9_S1_TP4_GPU12_expert0&#45;&gt;L9_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M87089.12,-604.35C87089.12,-587.61 87089.12,-571 87089.12,-571 87089.12,-571 86118.6,-571 86118.6,-571 86118.6,-571 86118.6,-562.74 86118.6,-562.74"/>
<polygon fill="black" stroke="black" points="86122.1,-562.74 86118.6,-552.74 86115.1,-562.74 86122.1,-562.74"/>
</g>
<!-- L9_S1_TP4_GPU12_expert0&#45;&gt;L9_S1_TP3_GPU11_moe_ar -->
<g id="edge2854" class="edge">
<title>L9_S1_TP4_GPU12_expert0&#45;&gt;L9_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M86909.3,-627C86902.48,-627 86898.57,-627 86898.57,-627 86898.57,-627 86898.57,-536 86898.57,-536 86898.57,-536 86883.45,-536 86883.45,-536"/>
<polygon fill="black" stroke="black" points="86883.45,-532.5 86873.45,-536 86883.45,-539.5 86883.45,-532.5"/>
</g>
<!-- L9_S1_TP4_GPU12_expert0&#45;&gt;L9_S1_TP4_GPU12_moe_ar -->
<g id="edge2890" class="edge">
<title>L9_S1_TP4_GPU12_expert0&#45;&gt;L9_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M87178.92,-604.34C87178.92,-604.34 87178.92,-577.67 87178.92,-577.67"/>
<polygon fill="black" stroke="black" points="87182.42,-577.67 87178.92,-567.67 87175.42,-577.67 87182.42,-577.67"/>
</g>
<!-- L9_S1_TP4_GPU12_expert0&#45;&gt;L9_S1_TP5_GPU13_moe_ar -->
<g id="edge2926" class="edge">
<title>L9_S1_TP4_GPU12_expert0&#45;&gt;L9_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M87223.81,-604.39C87223.81,-602.89 87223.81,-602 87223.81,-602 87223.81,-602 87723.74,-602 87723.74,-602 87723.74,-602 87723.74,-568.34 87723.74,-568.34"/>
<polygon fill="black" stroke="black" points="87727.24,-568.34 87723.74,-558.34 87720.24,-568.34 87727.24,-568.34"/>
</g>
<!-- L9_S1_TP4_GPU12_expert0&#45;&gt;L9_S1_TP6_GPU14_moe_ar -->
<g id="edge2962" class="edge">
<title>L9_S1_TP4_GPU12_expert0&#45;&gt;L9_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M87268.71,-604.39C87268.71,-602.89 87268.71,-602 87268.71,-602 87268.71,-602 88295.07,-602 88295.07,-602 88295.07,-602 88295.07,-543.16 88295.07,-543.16"/>
<polygon fill="black" stroke="black" points="88298.57,-543.16 88295.07,-533.16 88291.57,-543.16 88298.57,-543.16"/>
</g>
<!-- L9_S1_TP4_GPU12_expert0&#45;&gt;L9_S1_TP7_GPU15_moe_ar -->
<g id="edge2998" class="edge">
<title>L9_S1_TP4_GPU12_expert0&#45;&gt;L9_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M87313.6,-603.88C87313.6,-603.31 87313.6,-603 87313.6,-603 87313.6,-603 89084.3,-603 89084.3,-603 89084.3,-603 89084.3,-566.88 89084.3,-566.88"/>
<polygon fill="black" stroke="black" points="89087.8,-566.88 89084.3,-556.88 89080.8,-566.88 89087.8,-566.88"/>
</g>
<!-- L9_S1_TP4_GPU12_expert1 -->
<g id="node972" class="node">
<title>L9_S1_TP4_GPU12_expert1</title>
<polygon fill="none" stroke="black" points="87825.5,-672.5 87376.5,-672.5 87376.5,-604.5 87825.5,-604.5 87825.5,-672.5"/>
<text text-anchor="middle" x="87601" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="87601" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="87601" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="87601" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L9_S1_TP4_GPU12_expert1&#45;&gt;L9_S1_TP0_GPU8_moe_ar -->
<g id="edge2747" class="edge">
<title>L9_S1_TP4_GPU12_expert1&#45;&gt;L9_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M87587.5,-604.2C87587.5,-554.67 87587.5,-469 87587.5,-469 87587.5,-469 84735.23,-469 84735.23,-469 84735.23,-469 84735.23,-476.69 84735.23,-476.69"/>
<polygon fill="black" stroke="black" points="84731.73,-476.69 84735.23,-486.69 84738.73,-476.69 84731.73,-476.69"/>
</g>
<!-- L9_S1_TP4_GPU12_expert1&#45;&gt;L9_S1_TP1_GPU9_moe_ar -->
<g id="edge2783" class="edge">
<title>L9_S1_TP4_GPU12_expert1&#45;&gt;L9_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M87526.17,-673.12C87526.17,-673.69 87526.17,-674 87526.17,-674 87526.17,-674 85495.64,-674 85495.64,-674 85495.64,-674 85495.64,-547.74 85495.64,-547.74"/>
<polygon fill="black" stroke="black" points="85499.14,-547.74 85495.64,-537.74 85492.14,-547.74 85499.14,-547.74"/>
</g>
<!-- L9_S1_TP4_GPU12_expert1&#45;&gt;L9_S1_TP2_GPU10_moe_ar -->
<g id="edge2819" class="edge">
<title>L9_S1_TP4_GPU12_expert1&#45;&gt;L9_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M87401.75,-604.35C87401.75,-587.61 87401.75,-571 87401.75,-571 87401.75,-571 86147.22,-571 86147.22,-571 86147.22,-571 86147.22,-557.49 86147.22,-557.49"/>
<polygon fill="black" stroke="black" points="86150.72,-557.49 86147.22,-547.49 86143.72,-557.49 86150.72,-557.49"/>
</g>
<!-- L9_S1_TP4_GPU12_expert1&#45;&gt;L9_S1_TP3_GPU11_moe_ar -->
<g id="edge2855" class="edge">
<title>L9_S1_TP4_GPU12_expert1&#45;&gt;L9_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M87426.99,-604.35C87426.99,-587.61 87426.99,-571 87426.99,-571 87426.99,-571 86741.81,-571 86741.81,-571 86741.81,-571 86741.81,-569.98 86741.81,-569.98"/>
<polygon fill="black" stroke="black" points="86745.31,-570.76 86741.81,-560.76 86738.31,-570.76 86745.31,-570.76"/>
</g>
<!-- L9_S1_TP4_GPU12_expert1&#45;&gt;L9_S1_TP4_GPU12_moe_ar -->
<g id="edge2891" class="edge">
<title>L9_S1_TP4_GPU12_expert1&#45;&gt;L9_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M87452.24,-604.34C87452.24,-604.34 87452.24,-568.22 87452.24,-568.22"/>
<polygon fill="black" stroke="black" points="87455.74,-568.22 87452.24,-558.22 87448.74,-568.22 87455.74,-568.22"/>
</g>
<!-- L9_S1_TP4_GPU12_expert1&#45;&gt;L9_S1_TP5_GPU13_moe_ar -->
<g id="edge2927" class="edge">
<title>L9_S1_TP4_GPU12_expert1&#45;&gt;L9_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M87749.18,-604.34C87749.18,-604.34 87749.18,-571.18 87749.18,-571.18"/>
<polygon fill="black" stroke="black" points="87752.68,-571.18 87749.18,-561.18 87745.68,-571.18 87752.68,-571.18"/>
</g>
<!-- L9_S1_TP4_GPU12_expert1&#45;&gt;L9_S1_TP6_GPU14_moe_ar -->
<g id="edge2963" class="edge">
<title>L9_S1_TP4_GPU12_expert1&#45;&gt;L9_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M87774.62,-604.39C87774.62,-602.89 87774.62,-602 87774.62,-602 87774.62,-602 88286.53,-602 88286.53,-602 88286.53,-602 88286.53,-537.09 88286.53,-537.09"/>
<polygon fill="black" stroke="black" points="88290.03,-537.09 88286.53,-527.09 88283.03,-537.09 88290.03,-537.09"/>
</g>
<!-- L9_S1_TP4_GPU12_expert1&#45;&gt;L9_S1_TP7_GPU15_moe_ar -->
<g id="edge2999" class="edge">
<title>L9_S1_TP4_GPU12_expert1&#45;&gt;L9_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M87800.06,-603.88C87800.06,-603.31 87800.06,-603 87800.06,-603 87800.06,-603 89112.74,-603 89112.74,-603 89112.74,-603 89112.74,-569.77 89112.74,-569.77"/>
<polygon fill="black" stroke="black" points="89116.24,-569.77 89112.74,-559.77 89109.24,-569.77 89116.24,-569.77"/>
</g>
<!-- L9_S1_TP5_GPU13_expert0 -->
<g id="node973" class="node">
<title>L9_S1_TP5_GPU13_expert0</title>
<polygon fill="none" stroke="black" points="88292.5,-672.5 87843.5,-672.5 87843.5,-604.5 88292.5,-604.5 88292.5,-672.5"/>
<text text-anchor="middle" x="88068" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="88068" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="88068" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="88068" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L9_S1_TP5_GPU13_expert0&#45;&gt;L9_S1_TP0_GPU8_moe_ar -->
<g id="edge2748" class="edge">
<title>L9_S1_TP5_GPU13_expert0&#45;&gt;L9_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M87927.02,-672.56C87927.02,-682.14 87927.02,-690 87927.02,-690 87927.02,-690 84565.5,-690 84565.5,-690 84565.5,-690 84565.5,-577.65 84565.5,-577.65"/>
<polygon fill="black" stroke="black" points="84569,-577.65 84565.5,-567.65 84562,-577.65 84569,-577.65"/>
</g>
<!-- L9_S1_TP5_GPU13_expert0&#45;&gt;L9_S1_TP1_GPU9_moe_ar -->
<g id="edge2784" class="edge">
<title>L9_S1_TP5_GPU13_expert0&#45;&gt;L9_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M87885.26,-673.12C87885.26,-673.69 87885.26,-674 87885.26,-674 87885.26,-674 85493.07,-674 85493.07,-674 85493.07,-674 85493.07,-548.64 85493.07,-548.64"/>
<polygon fill="black" stroke="black" points="85496.57,-548.64 85493.07,-538.64 85489.57,-548.64 85496.57,-548.64"/>
</g>
<!-- L9_S1_TP5_GPU13_expert0&#45;&gt;L9_S1_TP2_GPU10_moe_ar -->
<g id="edge2820" class="edge">
<title>L9_S1_TP5_GPU13_expert0&#45;&gt;L9_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M87885.7,-604.35C87885.7,-587.61 87885.7,-571 87885.7,-571 87885.7,-571 86175.84,-571 86175.84,-571 86175.84,-571 86175.84,-550.12 86175.84,-550.12"/>
<polygon fill="black" stroke="black" points="86179.34,-550.12 86175.84,-540.12 86172.34,-550.12 86179.34,-550.12"/>
</g>
<!-- L9_S1_TP5_GPU13_expert0&#45;&gt;L9_S1_TP3_GPU11_moe_ar -->
<g id="edge2856" class="edge">
<title>L9_S1_TP5_GPU13_expert0&#45;&gt;L9_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M87927.89,-604.35C87927.89,-587.61 87927.89,-571 87927.89,-571 87927.89,-571 86791.69,-571 86791.69,-571 86791.69,-571 86791.69,-564.72 86791.69,-564.72"/>
<polygon fill="black" stroke="black" points="86795.19,-564.72 86791.69,-554.72 86788.19,-564.72 86795.19,-564.72"/>
</g>
<!-- L9_S1_TP5_GPU13_expert0&#45;&gt;L9_S1_TP4_GPU12_moe_ar -->
<g id="edge2892" class="edge">
<title>L9_S1_TP5_GPU13_expert0&#45;&gt;L9_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M87970.09,-604.25C87970.09,-587.12 87970.09,-570 87970.09,-570 87970.09,-570 87477.48,-570 87477.48,-570 87477.48,-570 87477.48,-564.85 87477.48,-564.85"/>
<polygon fill="black" stroke="black" points="87480.98,-564.85 87477.48,-554.85 87473.98,-564.85 87480.98,-564.85"/>
</g>
<!-- L9_S1_TP5_GPU13_expert0&#45;&gt;L9_S1_TP5_GPU13_moe_ar -->
<g id="edge2928" class="edge">
<title>L9_S1_TP5_GPU13_expert0&#45;&gt;L9_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M88012.28,-604.34C88012.28,-604.34 88012.28,-577.23 88012.28,-577.23"/>
<polygon fill="black" stroke="black" points="88015.78,-577.23 88012.28,-567.23 88008.78,-577.23 88015.78,-577.23"/>
</g>
<!-- L9_S1_TP5_GPU13_expert0&#45;&gt;L9_S1_TP6_GPU14_moe_ar -->
<g id="edge2964" class="edge">
<title>L9_S1_TP5_GPU13_expert0&#45;&gt;L9_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M88289.51,-604.34C88289.51,-604.34 88289.51,-539.61 88289.51,-539.61"/>
<polygon fill="black" stroke="black" points="88293.01,-539.61 88289.51,-529.61 88286.01,-539.61 88293.01,-539.61"/>
</g>
<!-- L9_S1_TP5_GPU13_expert0&#45;&gt;L9_S1_TP7_GPU15_moe_ar -->
<g id="edge3000" class="edge">
<title>L9_S1_TP5_GPU13_expert0&#45;&gt;L9_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M88274.5,-603.88C88274.5,-603.31 88274.5,-603 88274.5,-603 88274.5,-603 89141.18,-603 89141.18,-603 89141.18,-603 89141.18,-572.68 89141.18,-572.68"/>
<polygon fill="black" stroke="black" points="89144.68,-572.68 89141.18,-562.68 89137.68,-572.68 89144.68,-572.68"/>
</g>
<!-- L9_S1_TP5_GPU13_expert1 -->
<g id="node974" class="node">
<title>L9_S1_TP5_GPU13_expert1</title>
<polygon fill="none" stroke="black" points="88759.5,-672.5 88310.5,-672.5 88310.5,-604.5 88759.5,-604.5 88759.5,-672.5"/>
<text text-anchor="middle" x="88535" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="88535" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="88535" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="88535" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L9_S1_TP5_GPU13_expert1&#45;&gt;L9_S1_TP0_GPU8_moe_ar -->
<g id="edge2749" class="edge">
<title>L9_S1_TP5_GPU13_expert1&#45;&gt;L9_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M88535,-672.64C88535,-682.67 88535,-691 88535,-691 88535,-691 84561,-691 84561,-691 84561,-691 84561,-577.93 84561,-577.93"/>
<polygon fill="black" stroke="black" points="84564.5,-577.93 84561,-567.93 84557.5,-577.93 84564.5,-577.93"/>
</g>
<!-- L9_S1_TP5_GPU13_expert1&#45;&gt;L9_S1_TP1_GPU9_moe_ar -->
<g id="edge2785" class="edge">
<title>L9_S1_TP5_GPU13_expert1&#45;&gt;L9_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M88374.64,-604.47C88374.64,-588.11 88374.64,-572 88374.64,-572 88374.64,-572 85176.2,-572 85176.2,-572 85176.2,-572 85176.2,-571.66 85176.2,-571.66"/>
<polygon fill="black" stroke="black" points="85179.7,-578.62 85176.2,-568.62 85172.7,-578.62 85179.7,-578.62"/>
</g>
<!-- L9_S1_TP5_GPU13_expert1&#45;&gt;L9_S1_TP2_GPU10_moe_ar -->
<g id="edge2821" class="edge">
<title>L9_S1_TP5_GPU13_expert1&#45;&gt;L9_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M88422.75,-672.56C88422.75,-682.14 88422.75,-690 88422.75,-690 88422.75,-690 85966.5,-690 85966.5,-690 85966.5,-690 85966.5,-576.76 85966.5,-576.76"/>
<polygon fill="black" stroke="black" points="85970,-576.76 85966.5,-566.76 85963,-576.76 85970,-576.76"/>
</g>
<!-- L9_S1_TP5_GPU13_expert1&#45;&gt;L9_S1_TP3_GPU11_moe_ar -->
<g id="edge2857" class="edge">
<title>L9_S1_TP5_GPU13_expert1&#45;&gt;L9_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M88438.79,-604.35C88438.79,-587.61 88438.79,-571 88438.79,-571 88438.79,-571 86841.58,-571 86841.58,-571 86841.58,-571 86841.58,-555.71 86841.58,-555.71"/>
<polygon fill="black" stroke="black" points="86845.08,-555.71 86841.58,-545.71 86838.08,-555.71 86845.08,-555.71"/>
</g>
<!-- L9_S1_TP5_GPU13_expert1&#45;&gt;L9_S1_TP4_GPU12_moe_ar -->
<g id="edge2893" class="edge">
<title>L9_S1_TP5_GPU13_expert1&#45;&gt;L9_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M88502.93,-604.25C88502.93,-587.12 88502.93,-570 88502.93,-570 88502.93,-570 87502.73,-570 87502.73,-570 87502.73,-570 87502.73,-560.97 87502.73,-560.97"/>
<polygon fill="black" stroke="black" points="87506.23,-560.97 87502.73,-550.97 87499.23,-560.97 87506.23,-560.97"/>
</g>
<!-- L9_S1_TP5_GPU13_expert1&#45;&gt;L9_S1_TP5_GPU13_moe_ar -->
<g id="edge2929" class="edge">
<title>L9_S1_TP5_GPU13_expert1&#45;&gt;L9_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M88567.07,-604.25C88567.07,-587.12 88567.07,-570 88567.07,-570 88567.07,-570 88054.48,-570 88054.48,-570 88054.48,-570 88054.48,-569.54 88054.48,-569.54"/>
<polygon fill="black" stroke="black" points="88057.98,-575.42 88054.48,-565.42 88050.98,-575.42 88057.98,-575.42"/>
</g>
<!-- L9_S1_TP5_GPU13_expert1&#45;&gt;L9_S1_TP6_GPU14_moe_ar -->
<g id="edge2965" class="edge">
<title>L9_S1_TP5_GPU13_expert1&#45;&gt;L9_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M88631.21,-604.34C88631.21,-604.34 88631.21,-578.55 88631.21,-578.55"/>
<polygon fill="black" stroke="black" points="88634.71,-578.55 88631.21,-568.55 88627.71,-578.55 88634.71,-578.55"/>
</g>
<!-- L9_S1_TP5_GPU13_expert1&#45;&gt;L9_S1_TP7_GPU15_moe_ar -->
<g id="edge3001" class="edge">
<title>L9_S1_TP5_GPU13_expert1&#45;&gt;L9_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M88695.36,-603.88C88695.36,-603.31 88695.36,-603 88695.36,-603 88695.36,-603 89169.62,-603 89169.62,-603 89169.62,-603 89169.62,-574.61 89169.62,-574.61"/>
<polygon fill="black" stroke="black" points="89173.12,-574.61 89169.62,-564.61 89166.12,-574.61 89173.12,-574.61"/>
</g>
<!-- L9_S1_TP6_GPU14_expert0 -->
<g id="node975" class="node">
<title>L9_S1_TP6_GPU14_expert0</title>
<polygon fill="none" stroke="black" points="89226.5,-672.5 88777.5,-672.5 88777.5,-604.5 89226.5,-604.5 89226.5,-672.5"/>
<text text-anchor="middle" x="89002" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="89002" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="89002" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="89002" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L9_S1_TP6_GPU14_expert0&#45;&gt;L9_S1_TP0_GPU8_moe_ar -->
<g id="edge2750" class="edge">
<title>L9_S1_TP6_GPU14_expert0&#45;&gt;L9_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M88998.98,-604.35C88998.98,-587.61 88998.98,-571 88998.98,-571 88998.98,-571 84728.08,-571 84728.08,-571 84728.08,-571 84728.08,-565.27 84728.08,-565.27"/>
<polygon fill="black" stroke="black" points="84731.58,-565.27 84728.08,-555.27 84724.58,-565.27 84731.58,-565.27"/>
</g>
<!-- L9_S1_TP6_GPU14_expert0&#45;&gt;L9_S1_TP1_GPU9_moe_ar -->
<g id="edge2786" class="edge">
<title>L9_S1_TP6_GPU14_expert0&#45;&gt;L9_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M88799.37,-604.47C88799.37,-588.11 88799.37,-572 88799.37,-572 88799.37,-572 85221.1,-572 85221.1,-572 85221.1,-572 85221.1,-571.63 85221.1,-571.63"/>
<polygon fill="black" stroke="black" points="85224.6,-578.29 85221.1,-568.29 85217.6,-578.29 85224.6,-578.29"/>
</g>
<!-- L9_S1_TP6_GPU14_expert0&#45;&gt;L9_S1_TP2_GPU10_moe_ar -->
<g id="edge2822" class="edge">
<title>L9_S1_TP6_GPU14_expert0&#45;&gt;L9_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M88961.5,-604.18C88961.5,-549.57 88961.5,-449 88961.5,-449 88961.5,-449 86170.57,-449 86170.57,-449 86170.57,-449 86170.57,-488.99 86170.57,-488.99"/>
<polygon fill="black" stroke="black" points="86167.07,-488.99 86170.57,-498.99 86174.07,-488.99 86167.07,-488.99"/>
</g>
<!-- L9_S1_TP6_GPU14_expert0&#45;&gt;L9_S1_TP3_GPU11_moe_ar -->
<g id="edge2858" class="edge">
<title>L9_S1_TP6_GPU14_expert0&#45;&gt;L9_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M88956.98,-604.18C88956.98,-549.57 88956.98,-449 88956.98,-449 88956.98,-449 86884.17,-449 86884.17,-449 86884.17,-449 86884.17,-500.18 86884.17,-500.18"/>
<polygon fill="black" stroke="black" points="86880.67,-500.18 86884.17,-510.18 86887.67,-500.18 86880.67,-500.18"/>
</g>
<!-- L9_S1_TP6_GPU14_expert0&#45;&gt;L9_S1_TP4_GPU12_moe_ar -->
<g id="edge2894" class="edge">
<title>L9_S1_TP6_GPU14_expert0&#45;&gt;L9_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M88821.24,-604.25C88821.24,-587.12 88821.24,-570 88821.24,-570 88821.24,-570 87527.97,-570 87527.97,-570 87527.97,-570 87527.97,-556.08 87527.97,-556.08"/>
<polygon fill="black" stroke="black" points="87531.47,-556.08 87527.97,-546.08 87524.47,-556.08 87531.47,-556.08"/>
</g>
<!-- L9_S1_TP6_GPU14_expert0&#45;&gt;L9_S1_TP5_GPU13_moe_ar -->
<g id="edge2930" class="edge">
<title>L9_S1_TP6_GPU14_expert0&#45;&gt;L9_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M88843.11,-604.25C88843.11,-587.12 88843.11,-570 88843.11,-570 88843.11,-570 88096.68,-570 88096.68,-570 88096.68,-570 88096.68,-569.23 88096.68,-569.23"/>
<polygon fill="black" stroke="black" points="88100.18,-572.25 88096.68,-562.25 88093.18,-572.25 88100.18,-572.25"/>
</g>
<!-- L9_S1_TP6_GPU14_expert0&#45;&gt;L9_S1_TP6_GPU14_moe_ar -->
<g id="edge2966" class="edge">
<title>L9_S1_TP6_GPU14_expert0&#45;&gt;L9_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M88864.98,-604.34C88864.98,-604.34 88864.98,-562.87 88864.98,-562.87"/>
<polygon fill="black" stroke="black" points="88868.48,-562.87 88864.98,-552.87 88861.48,-562.87 88868.48,-562.87"/>
</g>
<!-- L9_S1_TP6_GPU14_expert0&#45;&gt;L9_S1_TP7_GPU15_moe_ar -->
<g id="edge3002" class="edge">
<title>L9_S1_TP6_GPU14_expert0&#45;&gt;L9_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M89198.06,-604.34C89198.06,-604.34 89198.06,-576.36 89198.06,-576.36"/>
<polygon fill="black" stroke="black" points="89201.56,-576.36 89198.06,-566.36 89194.56,-576.36 89201.56,-576.36"/>
</g>
<!-- L9_S1_TP6_GPU14_expert1 -->
<g id="node976" class="node">
<title>L9_S1_TP6_GPU14_expert1</title>
<polygon fill="none" stroke="black" points="89693.5,-672.5 89244.5,-672.5 89244.5,-604.5 89693.5,-604.5 89693.5,-672.5"/>
<text text-anchor="middle" x="89469" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="89469" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="89469" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="89469" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L9_S1_TP6_GPU14_expert1&#45;&gt;L9_S1_TP0_GPU8_moe_ar -->
<g id="edge2751" class="edge">
<title>L9_S1_TP6_GPU14_expert1&#45;&gt;L9_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M89300.92,-604.35C89300.92,-587.61 89300.92,-571 89300.92,-571 89300.92,-571 84753.67,-571 84753.67,-571 84753.67,-571 84753.67,-561.3 84753.67,-561.3"/>
<polygon fill="black" stroke="black" points="84757.17,-561.3 84753.67,-551.3 84750.17,-561.3 84757.17,-561.3"/>
</g>
<!-- L9_S1_TP6_GPU14_expert1&#45;&gt;L9_S1_TP1_GPU9_moe_ar -->
<g id="edge2787" class="edge">
<title>L9_S1_TP6_GPU14_expert1&#45;&gt;L9_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M89357.35,-604.35C89357.35,-587.61 89357.35,-571 89357.35,-571 89357.35,-571 84936.02,-571 84936.02,-571 84936.02,-571 84936.02,-563.02 84936.02,-563.02"/>
<polygon fill="black" stroke="black" points="84939.52,-563.02 84936.02,-553.02 84932.52,-563.02 84939.52,-563.02"/>
</g>
<!-- L9_S1_TP6_GPU14_expert1&#45;&gt;L9_S1_TP2_GPU10_moe_ar -->
<g id="edge2823" class="edge">
<title>L9_S1_TP6_GPU14_expert1&#45;&gt;L9_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M89675.49,-604.44C89675.49,-549.65 89675.49,-448 89675.49,-448 89675.49,-448 86136.68,-448 86136.68,-448 86136.68,-448 86136.68,-481.38 86136.68,-481.38"/>
<polygon fill="black" stroke="black" points="86133.18,-481.38 86136.68,-491.38 86140.18,-481.38 86133.18,-481.38"/>
</g>
<!-- L9_S1_TP6_GPU14_expert1&#45;&gt;L9_S1_TP3_GPU11_moe_ar -->
<g id="edge2859" class="edge">
<title>L9_S1_TP6_GPU14_expert1&#45;&gt;L9_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M89657.47,-604.44C89657.47,-549.65 89657.47,-448 89657.47,-448 89657.47,-448 86876.88,-448 86876.88,-448 86876.88,-448 86876.88,-496.11 86876.88,-496.11"/>
<polygon fill="black" stroke="black" points="86873.38,-496.11 86876.88,-506.11 86880.38,-496.11 86873.38,-496.11"/>
</g>
<!-- L9_S1_TP6_GPU14_expert1&#45;&gt;L9_S1_TP4_GPU12_moe_ar -->
<g id="edge2895" class="edge">
<title>L9_S1_TP6_GPU14_expert1&#45;&gt;L9_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M89413.77,-604.25C89413.77,-587.12 89413.77,-570 89413.77,-570 89413.77,-570 87553.22,-570 87553.22,-570 87553.22,-570 87553.22,-548.88 87553.22,-548.88"/>
<polygon fill="black" stroke="black" points="87556.72,-548.88 87553.22,-538.88 87549.72,-548.88 87556.72,-548.88"/>
</g>
<!-- L9_S1_TP6_GPU14_expert1&#45;&gt;L9_S1_TP5_GPU13_moe_ar -->
<g id="edge2931" class="edge">
<title>L9_S1_TP6_GPU14_expert1&#45;&gt;L9_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M89470.19,-604.25C89470.19,-587.12 89470.19,-570 89470.19,-570 89470.19,-570 88138.87,-570 88138.87,-570 88138.87,-570 88138.87,-568.25 88138.87,-568.25"/>
<polygon fill="black" stroke="black" points="88142.37,-568.25 88138.87,-558.25 88135.37,-568.25 88142.37,-568.25"/>
</g>
<!-- L9_S1_TP6_GPU14_expert1&#45;&gt;L9_S1_TP6_GPU14_moe_ar -->
<g id="edge2967" class="edge">
<title>L9_S1_TP6_GPU14_expert1&#45;&gt;L9_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M89526.62,-604.25C89526.62,-587.12 89526.62,-570 89526.62,-570 89526.62,-570 88886.85,-570 88886.85,-570 88886.85,-570 88886.85,-559.26 88886.85,-559.26"/>
<polygon fill="black" stroke="black" points="88890.35,-559.26 88886.85,-549.26 88883.35,-559.26 88890.35,-559.26"/>
</g>
<!-- L9_S1_TP6_GPU14_expert1&#45;&gt;L9_S1_TP7_GPU15_moe_ar -->
<g id="edge3003" class="edge">
<title>L9_S1_TP6_GPU14_expert1&#45;&gt;L9_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M89583.04,-604.34C89583.04,-604.34 89583.04,-557.38 89583.04,-557.38"/>
<polygon fill="black" stroke="black" points="89586.54,-557.38 89583.04,-547.38 89579.54,-557.38 89586.54,-557.38"/>
</g>
<!-- L9_S1_TP7_GPU15_expert0 -->
<g id="node977" class="node">
<title>L9_S1_TP7_GPU15_expert0</title>
<polygon fill="none" stroke="black" points="90160.5,-672.5 89711.5,-672.5 89711.5,-604.5 90160.5,-604.5 90160.5,-672.5"/>
<text text-anchor="middle" x="89936" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="89936" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="89936" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="89936" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L9_S1_TP7_GPU15_expert0&#45;&gt;L9_S1_TP0_GPU8_moe_ar -->
<g id="edge2752" class="edge">
<title>L9_S1_TP7_GPU15_expert0&#45;&gt;L9_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M89716.89,-604.35C89716.89,-587.61 89716.89,-571 89716.89,-571 89716.89,-571 84779.27,-571 84779.27,-571 84779.27,-571 84779.27,-556 84779.27,-556"/>
<polygon fill="black" stroke="black" points="84782.77,-556 84779.27,-546 84775.77,-556 84782.77,-556"/>
</g>
<!-- L9_S1_TP7_GPU15_expert0&#45;&gt;L9_S1_TP1_GPU9_moe_ar -->
<g id="edge2788" class="edge">
<title>L9_S1_TP7_GPU15_expert0&#45;&gt;L9_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M89754.61,-604.44C89754.61,-549.65 89754.61,-448 89754.61,-448 89754.61,-448 85350.23,-448 85350.23,-448 85350.23,-448 85350.23,-468.71 85350.23,-468.71"/>
<polygon fill="black" stroke="black" points="85346.73,-468.71 85350.23,-478.71 85353.73,-468.71 85346.73,-468.71"/>
</g>
<!-- L9_S1_TP7_GPU15_expert0&#45;&gt;L9_S1_TP2_GPU10_moe_ar -->
<g id="edge2824" class="edge">
<title>L9_S1_TP7_GPU15_expert0&#45;&gt;L9_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M89749.22,-604.44C89749.22,-549.65 89749.22,-448 89749.22,-448 89749.22,-448 86102.78,-448 86102.78,-448 86102.78,-448 86102.78,-475.48 86102.78,-475.48"/>
<polygon fill="black" stroke="black" points="86099.28,-475.48 86102.78,-485.48 86106.28,-475.48 86099.28,-475.48"/>
</g>
<!-- L9_S1_TP7_GPU15_expert0&#45;&gt;L9_S1_TP3_GPU11_moe_ar -->
<g id="edge2860" class="edge">
<title>L9_S1_TP7_GPU15_expert0&#45;&gt;L9_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M89743.83,-604.44C89743.83,-549.65 89743.83,-448 89743.83,-448 89743.83,-448 86869.58,-448 86869.58,-448 86869.58,-448 86869.58,-493.25 86869.58,-493.25"/>
<polygon fill="black" stroke="black" points="86866.08,-493.25 86869.58,-503.25 86873.08,-493.25 86866.08,-493.25"/>
</g>
<!-- L9_S1_TP7_GPU15_expert0&#45;&gt;L9_S1_TP4_GPU12_moe_ar -->
<g id="edge2896" class="edge">
<title>L9_S1_TP7_GPU15_expert0&#45;&gt;L9_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M89738.44,-604.47C89738.44,-553.18 89738.44,-462 89738.44,-462 89738.44,-462 87423.35,-462 87423.35,-462 87423.35,-462 87423.35,-469.53 87423.35,-469.53"/>
<polygon fill="black" stroke="black" points="87419.85,-469.53 87423.35,-479.53 87426.85,-469.53 87419.85,-469.53"/>
</g>
<!-- L9_S1_TP7_GPU15_expert0&#45;&gt;L9_S1_TP5_GPU13_moe_ar -->
<g id="edge2932" class="edge">
<title>L9_S1_TP7_GPU15_expert0&#45;&gt;L9_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M89722.28,-604.25C89722.28,-587.12 89722.28,-570 89722.28,-570 89722.28,-570 88181.07,-570 88181.07,-570 88181.07,-570 88181.07,-562.38 88181.07,-562.38"/>
<polygon fill="black" stroke="black" points="88184.57,-562.38 88181.07,-552.38 88177.57,-562.38 88184.57,-562.38"/>
</g>
<!-- L9_S1_TP7_GPU15_expert0&#45;&gt;L9_S1_TP6_GPU14_moe_ar -->
<g id="edge2968" class="edge">
<title>L9_S1_TP7_GPU15_expert0&#45;&gt;L9_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M89727.67,-604.25C89727.67,-587.12 89727.67,-570 89727.67,-570 89727.67,-570 88908.72,-570 88908.72,-570 88908.72,-570 88908.72,-554.34 88908.72,-554.34"/>
<polygon fill="black" stroke="black" points="88912.22,-554.34 88908.72,-544.34 88905.22,-554.34 88912.22,-554.34"/>
</g>
<!-- L9_S1_TP7_GPU15_expert0&#45;&gt;L9_S1_TP7_GPU15_moe_ar -->
<g id="edge3004" class="edge">
<title>L9_S1_TP7_GPU15_expert0&#45;&gt;L9_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M89733.06,-604.21C89733.06,-567.05 89733.06,-513 89733.06,-513 89733.06,-513 89645.66,-513 89645.66,-513"/>
<polygon fill="black" stroke="black" points="89645.66,-509.5 89635.66,-513 89645.66,-516.5 89645.66,-509.5"/>
</g>
<!-- L9_S1_TP7_GPU15_expert1 -->
<g id="node978" class="node">
<title>L9_S1_TP7_GPU15_expert1</title>
<polygon fill="none" stroke="black" points="90627.5,-672.5 90178.5,-672.5 90178.5,-604.5 90627.5,-604.5 90627.5,-672.5"/>
<text text-anchor="middle" x="90403" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="90403" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="90403" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="90403" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L9_S1_TP7_GPU15_expert1&#45;&gt;L9_S1_TP0_GPU8_moe_ar -->
<g id="edge2753" class="edge">
<title>L9_S1_TP7_GPU15_expert1&#45;&gt;L9_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M90223.11,-604.35C90223.11,-587.61 90223.11,-571 90223.11,-571 90223.11,-571 84804.87,-571 84804.87,-571 84804.87,-571 84804.87,-548.96 84804.87,-548.96"/>
<polygon fill="black" stroke="black" points="84808.37,-548.96 84804.87,-538.96 84801.37,-548.96 84808.37,-548.96"/>
</g>
<!-- L9_S1_TP7_GPU15_expert1&#45;&gt;L9_S1_TP1_GPU9_moe_ar -->
<g id="edge2789" class="edge">
<title>L9_S1_TP7_GPU15_expert1&#45;&gt;L9_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M90535.39,-604.44C90535.39,-549.65 90535.39,-448 90535.39,-448 90535.39,-448 85183,-448 85183,-448 85183,-448 85183,-462.11 85183,-462.11"/>
<polygon fill="black" stroke="black" points="85179.5,-462.11 85183,-472.11 85186.5,-462.11 85179.5,-462.11"/>
</g>
<!-- L9_S1_TP7_GPU15_expert1&#45;&gt;L9_S1_TP2_GPU10_moe_ar -->
<g id="edge2825" class="edge">
<title>L9_S1_TP7_GPU15_expert1&#45;&gt;L9_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M90490.78,-604.44C90490.78,-549.65 90490.78,-448 90490.78,-448 90490.78,-448 86068.89,-448 86068.89,-448 86068.89,-448 86068.89,-471.66 86068.89,-471.66"/>
<polygon fill="black" stroke="black" points="86065.39,-471.66 86068.89,-481.66 86072.39,-471.66 86065.39,-471.66"/>
</g>
<!-- L9_S1_TP7_GPU15_expert1&#45;&gt;L9_S1_TP3_GPU11_moe_ar -->
<g id="edge2861" class="edge">
<title>L9_S1_TP7_GPU15_expert1&#45;&gt;L9_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M90446.17,-604.44C90446.17,-549.65 90446.17,-448 90446.17,-448 90446.17,-448 86862.29,-448 86862.29,-448 86862.29,-448 86862.29,-490.63 86862.29,-490.63"/>
<polygon fill="black" stroke="black" points="86858.79,-490.63 86862.29,-500.63 86865.79,-490.63 86858.79,-490.63"/>
</g>
<!-- L9_S1_TP7_GPU15_expert1&#45;&gt;L9_S1_TP4_GPU12_moe_ar -->
<g id="edge2897" class="edge">
<title>L9_S1_TP7_GPU15_expert1&#45;&gt;L9_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M90401.56,-604.47C90401.56,-553.18 90401.56,-462 90401.56,-462 90401.56,-462 87268.23,-462 87268.23,-462 87268.23,-462 87268.23,-463.04 87268.23,-463.04"/>
<polygon fill="black" stroke="black" points="87264.73,-462.44 87268.23,-472.44 87271.73,-462.44 87264.73,-462.44"/>
</g>
<!-- L9_S1_TP7_GPU15_expert1&#45;&gt;L9_S1_TP5_GPU13_moe_ar -->
<g id="edge2933" class="edge">
<title>L9_S1_TP7_GPU15_expert1&#45;&gt;L9_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M90267.72,-604.25C90267.72,-587.12 90267.72,-570 90267.72,-570 90267.72,-570 88223.27,-570 88223.27,-570 88223.27,-570 88223.27,-554.05 88223.27,-554.05"/>
<polygon fill="black" stroke="black" points="88226.77,-554.05 88223.27,-544.05 88219.77,-554.05 88226.77,-554.05"/>
</g>
<!-- L9_S1_TP7_GPU15_expert1&#45;&gt;L9_S1_TP6_GPU14_moe_ar -->
<g id="edge2969" class="edge">
<title>L9_S1_TP7_GPU15_expert1&#45;&gt;L9_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M90312.33,-604.25C90312.33,-587.12 90312.33,-570 90312.33,-570 90312.33,-570 88930.59,-570 88930.59,-570 88930.59,-570 88930.59,-547.76 88930.59,-547.76"/>
<polygon fill="black" stroke="black" points="88934.09,-547.76 88930.59,-537.76 88927.09,-547.76 88934.09,-547.76"/>
</g>
<!-- L9_S1_TP7_GPU15_expert1&#45;&gt;L9_S1_TP7_GPU15_moe_ar -->
<g id="edge3005" class="edge">
<title>L9_S1_TP7_GPU15_expert1&#45;&gt;L9_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M90356.94,-604.37C90356.94,-563.08 90356.94,-499 90356.94,-499 90356.94,-499 89614.69,-499 89614.69,-499"/>
<polygon fill="black" stroke="black" points="89614.69,-495.5 89604.69,-499 89614.69,-502.5 89614.69,-495.5"/>
</g>
<!-- L9_S1_TP0_GPU8_norm -->
<g id="node980" class="node">
<title>L9_S1_TP0_GPU8_norm</title>
<polygon fill="none" stroke="black" points="83169.5,-332.33 82720.5,-332.33 82720.5,-264.33 83169.5,-264.33 83169.5,-332.33"/>
<text text-anchor="middle" x="82945" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="82945" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="82945" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="82945" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP0_GPU8_moe_res&#45;&gt;L9_S1_TP0_GPU8_norm -->
<g id="edge2756" class="edge">
<title>L9_S1_TP0_GPU8_moe_res&#45;&gt;L9_S1_TP0_GPU8_norm</title>
<path fill="none" stroke="black" d="M82945,-368.28C82945,-368.28 82945,-342.46 82945,-342.46"/>
<polygon fill="black" stroke="black" points="82948.5,-342.46 82945,-332.46 82941.5,-342.46 82948.5,-342.46"/>
</g>
<!-- L9_S1_TP1_GPU9_qkv_linear -->
<g id="node981" class="node">
<title>L9_S1_TP1_GPU9_qkv_linear</title>
<polygon fill="none" stroke="black" points="84618,-1614.75 84010,-1614.75 84010,-1546.75 84618,-1546.75 84618,-1614.75"/>
<text text-anchor="middle" x="84314" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="84314" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="84314" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="84314" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L9_S1_TP1_GPU9_qkv_slice -->
<g id="node982" class="node">
<title>L9_S1_TP1_GPU9_qkv_slice</title>
<polygon fill="none" stroke="black" points="84612,-1496.67 84016,-1496.67 84016,-1428.67 84612,-1428.67 84612,-1496.67"/>
<text text-anchor="middle" x="84314" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="84314" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="84314" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="84314" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L9_S1_TP1_GPU9_qkv_linear&#45;&gt;L9_S1_TP1_GPU9_qkv_slice -->
<g id="edge2757" class="edge">
<title>L9_S1_TP1_GPU9_qkv_linear&#45;&gt;L9_S1_TP1_GPU9_qkv_slice</title>
<path fill="none" stroke="black" d="M84314,-1546.59C84314,-1546.59 84314,-1506.74 84314,-1506.74"/>
<polygon fill="black" stroke="black" points="84317.5,-1506.74 84314,-1496.74 84310.5,-1506.74 84317.5,-1506.74"/>
</g>
<!-- L9_S1_TP1_GPU9_qkv_slice&#45;&gt;L9_S1_TP1_GPU9_attn_v -->
<g id="edge2761" class="edge">
<title>L9_S1_TP1_GPU9_qkv_slice&#45;&gt;L9_S1_TP1_GPU9_attn_v</title>
<path fill="none" stroke="black" d="M84067.25,-1428.38C84067.25,-1428.38 84067.25,-1195 84067.25,-1195"/>
<polygon fill="black" stroke="black" points="84070.75,-1195 84067.25,-1185 84063.75,-1195 84070.75,-1195"/>
</g>
<!-- L9_S1_TP1_GPU9_qk_matmul -->
<g id="node983" class="node">
<title>L9_S1_TP1_GPU9_qk_matmul</title>
<polygon fill="none" stroke="black" points="85029.5,-1392.67 84094.5,-1392.67 84094.5,-1324.67 85029.5,-1324.67 85029.5,-1392.67"/>
<text text-anchor="middle" x="84562" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="84562" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="84562" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="84562" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L9_S1_TP1_GPU9_qkv_slice&#45;&gt;L9_S1_TP1_GPU9_qk_matmul -->
<g id="edge2758" class="edge">
<title>L9_S1_TP1_GPU9_qkv_slice&#45;&gt;L9_S1_TP1_GPU9_qk_matmul</title>
<path fill="none" stroke="black" d="M84353.25,-1428.61C84353.25,-1428.61 84353.25,-1402.8 84353.25,-1402.8"/>
<polygon fill="black" stroke="black" points="84356.75,-1402.8 84353.25,-1392.8 84349.75,-1402.8 84356.75,-1402.8"/>
</g>
<!-- L9_S1_TP1_GPU9_softmax -->
<g id="node984" class="node">
<title>L9_S1_TP1_GPU9_softmax</title>
<polygon fill="none" stroke="black" points="84790,-1288.67 84280,-1288.67 84280,-1220.67 84790,-1220.67 84790,-1288.67"/>
<text text-anchor="middle" x="84535" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="84535" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="84535" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="84535" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L9_S1_TP1_GPU9_qk_matmul&#45;&gt;L9_S1_TP1_GPU9_softmax -->
<g id="edge2759" class="edge">
<title>L9_S1_TP1_GPU9_qk_matmul&#45;&gt;L9_S1_TP1_GPU9_softmax</title>
<path fill="none" stroke="black" d="M84535,-1324.61C84535,-1324.61 84535,-1298.8 84535,-1298.8"/>
<polygon fill="black" stroke="black" points="84538.5,-1298.8 84535,-1288.8 84531.5,-1298.8 84538.5,-1298.8"/>
</g>
<!-- L9_S1_TP1_GPU9_softmax&#45;&gt;L9_S1_TP1_GPU9_attn_v -->
<g id="edge2760" class="edge">
<title>L9_S1_TP1_GPU9_softmax&#45;&gt;L9_S1_TP1_GPU9_attn_v</title>
<path fill="none" stroke="black" d="M84535,-1220.61C84535,-1220.61 84535,-1194.8 84535,-1194.8"/>
<polygon fill="black" stroke="black" points="84538.5,-1194.8 84535,-1184.8 84531.5,-1194.8 84538.5,-1194.8"/>
</g>
<!-- L9_S1_TP1_GPU9_mha_res -->
<g id="node986" class="node">
<title>L9_S1_TP1_GPU9_mha_res</title>
<polygon fill="none" stroke="black" points="84648.5,-948.5 83761.5,-948.5 83761.5,-880.5 84648.5,-880.5 84648.5,-948.5"/>
<text text-anchor="middle" x="84205" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="84205" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="84205" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="84205" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP1_GPU9_mha_ar&#45;&gt;L9_S1_TP1_GPU9_mha_res -->
<g id="edge2770" class="edge">
<title>L9_S1_TP1_GPU9_mha_ar&#45;&gt;L9_S1_TP1_GPU9_mha_res</title>
<path fill="none" stroke="black" d="M84625.01,-1015.66C84625.01,-1015.66 84625.01,-958.91 84625.01,-958.91"/>
<polygon fill="black" stroke="black" points="84628.51,-958.91 84625.01,-948.91 84621.51,-958.91 84628.51,-958.91"/>
</g>
<!-- L9_S1_TP1_GPU9_gate -->
<g id="node987" class="node">
<title>L9_S1_TP1_GPU9_gate</title>
<polygon fill="none" stroke="black" points="84734.56,-844.5 83892.15,-844.5 83675.44,-708.5 84517.85,-708.5 84734.56,-844.5"/>
<text text-anchor="middle" x="84205" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="84205" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="84205" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="84205" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L9_S1_TP1_GPU9_mha_res&#45;&gt;L9_S1_TP1_GPU9_gate -->
<g id="edge2771" class="edge">
<title>L9_S1_TP1_GPU9_mha_res&#45;&gt;L9_S1_TP1_GPU9_gate</title>
<path fill="none" stroke="black" d="M84205,-880.39C84205,-880.39 84205,-854.73 84205,-854.73"/>
<polygon fill="black" stroke="black" points="84208.5,-854.73 84205,-844.73 84201.5,-854.73 84208.5,-854.73"/>
</g>
<!-- L9_S1_TP1_GPU9_moe_res -->
<g id="node989" class="node">
<title>L9_S1_TP1_GPU9_moe_res</title>
<polygon fill="none" stroke="black" points="84640,-436.33 83820,-436.33 83820,-368.33 84640,-368.33 84640,-436.33"/>
<text text-anchor="middle" x="84230" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="84230" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="84230" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="84230" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP1_GPU9_mha_res&#45;&gt;L9_S1_TP1_GPU9_moe_res -->
<g id="edge2791" class="edge">
<title>L9_S1_TP1_GPU9_mha_res&#45;&gt;L9_S1_TP1_GPU9_moe_res</title>
<path fill="none" stroke="black" d="M83761.43,-914C83704.73,-914 83666,-914 83666,-914 83666,-914 83666,-673 83666,-673 83666,-673 84098.5,-673 84098.5,-673 84098.5,-673 84098.5,-446.34 84098.5,-446.34"/>
<polygon fill="black" stroke="black" points="84102,-446.34 84098.5,-436.34 84095,-446.34 84102,-446.34"/>
</g>
<!-- L9_S1_TP1_GPU9_gate&#45;&gt;L9_S1_TP1_GPU9_expert0 -->
<g id="edge2772" class="edge">
<title>L9_S1_TP1_GPU9_gate&#45;&gt;L9_S1_TP1_GPU9_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M84257.17,-708.31C84257.17,-708.31 84257.17,-682.71 84257.17,-682.71"/>
<polygon fill="black" stroke="black" points="84260.67,-682.71 84257.17,-672.71 84253.67,-682.71 84260.67,-682.71"/>
</g>
<!-- L9_S1_TP1_GPU9_gate&#45;&gt;L9_S1_TP1_GPU9_expert1 -->
<g id="edge2773" class="edge">
<title>L9_S1_TP1_GPU9_gate&#45;&gt;L9_S1_TP1_GPU9_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M84654.64,-776.4C84654.64,-776.4 84654.64,-682.74 84654.64,-682.74"/>
<polygon fill="black" stroke="black" points="84658.14,-682.74 84654.64,-672.74 84651.14,-682.74 84658.14,-682.74"/>
</g>
<!-- L9_S1_TP1_GPU9_moe_ar&#45;&gt;L9_S1_TP1_GPU9_moe_res -->
<g id="edge2790" class="edge">
<title>L9_S1_TP1_GPU9_moe_ar&#45;&gt;L9_S1_TP1_GPU9_moe_res</title>
<path fill="none" stroke="black" d="M85015.77,-478.7C85015.77,-457.44 85015.77,-436 85015.77,-436 85015.77,-436 84650.31,-436 84650.31,-436"/>
<polygon fill="black" stroke="black" points="84650.31,-432.5 84640.31,-436 84650.31,-439.5 84650.31,-432.5"/>
</g>
<!-- L9_S1_TP1_GPU9_norm -->
<g id="node990" class="node">
<title>L9_S1_TP1_GPU9_norm</title>
<polygon fill="none" stroke="black" points="84454.5,-332.33 84005.5,-332.33 84005.5,-264.33 84454.5,-264.33 84454.5,-332.33"/>
<text text-anchor="middle" x="84230" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="84230" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="84230" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="84230" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP1_GPU9_moe_res&#45;&gt;L9_S1_TP1_GPU9_norm -->
<g id="edge2792" class="edge">
<title>L9_S1_TP1_GPU9_moe_res&#45;&gt;L9_S1_TP1_GPU9_norm</title>
<path fill="none" stroke="black" d="M84230,-368.28C84230,-368.28 84230,-342.46 84230,-342.46"/>
<polygon fill="black" stroke="black" points="84233.5,-342.46 84230,-332.46 84226.5,-342.46 84233.5,-342.46"/>
</g>
<!-- L9_S1_TP2_GPU10_qkv_linear -->
<g id="node991" class="node">
<title>L9_S1_TP2_GPU10_qkv_linear</title>
<polygon fill="none" stroke="black" points="85618,-1614.75 85010,-1614.75 85010,-1546.75 85618,-1546.75 85618,-1614.75"/>
<text text-anchor="middle" x="85314" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="85314" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="85314" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="85314" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L9_S1_TP2_GPU10_qkv_slice -->
<g id="node992" class="node">
<title>L9_S1_TP2_GPU10_qkv_slice</title>
<polygon fill="none" stroke="black" points="85612,-1496.67 85016,-1496.67 85016,-1428.67 85612,-1428.67 85612,-1496.67"/>
<text text-anchor="middle" x="85314" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="85314" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="85314" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="85314" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L9_S1_TP2_GPU10_qkv_linear&#45;&gt;L9_S1_TP2_GPU10_qkv_slice -->
<g id="edge2793" class="edge">
<title>L9_S1_TP2_GPU10_qkv_linear&#45;&gt;L9_S1_TP2_GPU10_qkv_slice</title>
<path fill="none" stroke="black" d="M85314,-1546.59C85314,-1546.59 85314,-1506.74 85314,-1506.74"/>
<polygon fill="black" stroke="black" points="85317.5,-1506.74 85314,-1496.74 85310.5,-1506.74 85317.5,-1506.74"/>
</g>
<!-- L9_S1_TP2_GPU10_qkv_slice&#45;&gt;L9_S1_TP2_GPU10_attn_v -->
<g id="edge2797" class="edge">
<title>L9_S1_TP2_GPU10_qkv_slice&#45;&gt;L9_S1_TP2_GPU10_attn_v</title>
<path fill="none" stroke="black" d="M85062,-1428.38C85062,-1428.38 85062,-1195 85062,-1195"/>
<polygon fill="black" stroke="black" points="85065.5,-1195 85062,-1185 85058.5,-1195 85065.5,-1195"/>
</g>
<!-- L9_S1_TP2_GPU10_qk_matmul -->
<g id="node993" class="node">
<title>L9_S1_TP2_GPU10_qk_matmul</title>
<polygon fill="none" stroke="black" points="86029.5,-1392.67 85094.5,-1392.67 85094.5,-1324.67 86029.5,-1324.67 86029.5,-1392.67"/>
<text text-anchor="middle" x="85562" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="85562" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="85562" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="85562" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L9_S1_TP2_GPU10_qkv_slice&#45;&gt;L9_S1_TP2_GPU10_qk_matmul -->
<g id="edge2794" class="edge">
<title>L9_S1_TP2_GPU10_qkv_slice&#45;&gt;L9_S1_TP2_GPU10_qk_matmul</title>
<path fill="none" stroke="black" d="M85353.25,-1428.61C85353.25,-1428.61 85353.25,-1402.8 85353.25,-1402.8"/>
<polygon fill="black" stroke="black" points="85356.75,-1402.8 85353.25,-1392.8 85349.75,-1402.8 85356.75,-1402.8"/>
</g>
<!-- L9_S1_TP2_GPU10_softmax -->
<g id="node994" class="node">
<title>L9_S1_TP2_GPU10_softmax</title>
<polygon fill="none" stroke="black" points="85768,-1288.67 85258,-1288.67 85258,-1220.67 85768,-1220.67 85768,-1288.67"/>
<text text-anchor="middle" x="85513" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="85513" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="85513" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="85513" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L9_S1_TP2_GPU10_qk_matmul&#45;&gt;L9_S1_TP2_GPU10_softmax -->
<g id="edge2795" class="edge">
<title>L9_S1_TP2_GPU10_qk_matmul&#45;&gt;L9_S1_TP2_GPU10_softmax</title>
<path fill="none" stroke="black" d="M85513,-1324.61C85513,-1324.61 85513,-1298.8 85513,-1298.8"/>
<polygon fill="black" stroke="black" points="85516.5,-1298.8 85513,-1288.8 85509.5,-1298.8 85516.5,-1298.8"/>
</g>
<!-- L9_S1_TP2_GPU10_softmax&#45;&gt;L9_S1_TP2_GPU10_attn_v -->
<g id="edge2796" class="edge">
<title>L9_S1_TP2_GPU10_softmax&#45;&gt;L9_S1_TP2_GPU10_attn_v</title>
<path fill="none" stroke="black" d="M85513,-1220.61C85513,-1220.61 85513,-1194.8 85513,-1194.8"/>
<polygon fill="black" stroke="black" points="85516.5,-1194.8 85513,-1184.8 85509.5,-1194.8 85516.5,-1194.8"/>
</g>
<!-- L9_S1_TP2_GPU10_mha_res -->
<g id="node996" class="node">
<title>L9_S1_TP2_GPU10_mha_res</title>
<polygon fill="none" stroke="black" points="85726.5,-948.5 84839.5,-948.5 84839.5,-880.5 85726.5,-880.5 85726.5,-948.5"/>
<text text-anchor="middle" x="85283" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="85283" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="85283" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="85283" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP2_GPU10_mha_ar&#45;&gt;L9_S1_TP2_GPU10_mha_res -->
<g id="edge2806" class="edge">
<title>L9_S1_TP2_GPU10_mha_ar&#45;&gt;L9_S1_TP2_GPU10_mha_res</title>
<path fill="none" stroke="black" d="M85548.51,-991.61C85548.51,-991.61 85548.51,-958.74 85548.51,-958.74"/>
<polygon fill="black" stroke="black" points="85552.01,-958.74 85548.51,-948.74 85545.01,-958.74 85552.01,-958.74"/>
</g>
<!-- L9_S1_TP2_GPU10_gate -->
<g id="node997" class="node">
<title>L9_S1_TP2_GPU10_gate</title>
<polygon fill="none" stroke="black" points="85812.56,-844.5 84970.15,-844.5 84753.44,-708.5 85595.85,-708.5 85812.56,-844.5"/>
<text text-anchor="middle" x="85283" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="85283" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="85283" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="85283" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L9_S1_TP2_GPU10_mha_res&#45;&gt;L9_S1_TP2_GPU10_gate -->
<g id="edge2807" class="edge">
<title>L9_S1_TP2_GPU10_mha_res&#45;&gt;L9_S1_TP2_GPU10_gate</title>
<path fill="none" stroke="black" d="M85283,-880.39C85283,-880.39 85283,-854.73 85283,-854.73"/>
<polygon fill="black" stroke="black" points="85286.5,-854.73 85283,-844.73 85279.5,-854.73 85286.5,-854.73"/>
</g>
<!-- L9_S1_TP2_GPU10_moe_res -->
<g id="node999" class="node">
<title>L9_S1_TP2_GPU10_moe_res</title>
<polygon fill="none" stroke="black" points="85656,-436.33 84836,-436.33 84836,-368.33 85656,-368.33 85656,-436.33"/>
<text text-anchor="middle" x="85246" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="85246" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="85246" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="85246" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP2_GPU10_mha_res&#45;&gt;L9_S1_TP2_GPU10_moe_res -->
<g id="edge2827" class="edge">
<title>L9_S1_TP2_GPU10_mha_res&#45;&gt;L9_S1_TP2_GPU10_moe_res</title>
<path fill="none" stroke="black" d="M85726.57,-914C85783.27,-914 85822,-914 85822,-914 85822,-914 85822,-674 85822,-674 85822,-674 85500.79,-674 85500.79,-674 85500.79,-674 85500.79,-572 85500.79,-572 85500.79,-572 85529.51,-572 85529.51,-572 85529.51,-572 85529.51,-446.67 85529.51,-446.67"/>
<polygon fill="black" stroke="black" points="85533.01,-446.67 85529.51,-436.67 85526.01,-446.67 85533.01,-446.67"/>
</g>
<!-- L9_S1_TP2_GPU10_gate&#45;&gt;L9_S1_TP2_GPU10_expert0 -->
<g id="edge2808" class="edge">
<title>L9_S1_TP2_GPU10_gate&#45;&gt;L9_S1_TP2_GPU10_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M85191.17,-708.31C85191.17,-708.31 85191.17,-682.71 85191.17,-682.71"/>
<polygon fill="black" stroke="black" points="85194.67,-682.71 85191.17,-672.71 85187.67,-682.71 85194.67,-682.71"/>
</g>
<!-- L9_S1_TP2_GPU10_gate&#45;&gt;L9_S1_TP2_GPU10_expert1 -->
<g id="edge2809" class="edge">
<title>L9_S1_TP2_GPU10_gate&#45;&gt;L9_S1_TP2_GPU10_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M85660.64,-748.9C85660.64,-748.9 85660.64,-682.65 85660.64,-682.65"/>
<polygon fill="black" stroke="black" points="85664.14,-682.65 85660.64,-672.65 85657.14,-682.65 85664.14,-682.65"/>
</g>
<!-- L9_S1_TP2_GPU10_moe_ar&#45;&gt;L9_S1_TP2_GPU10_moe_res -->
<g id="edge2826" class="edge">
<title>L9_S1_TP2_GPU10_moe_ar&#45;&gt;L9_S1_TP2_GPU10_moe_res</title>
<path fill="none" stroke="black" d="M85625.88,-487.52C85625.88,-487.52 85625.88,-446.7 85625.88,-446.7"/>
<polygon fill="black" stroke="black" points="85629.38,-446.7 85625.88,-436.7 85622.38,-446.7 85629.38,-446.7"/>
</g>
<!-- L9_S1_TP2_GPU10_norm -->
<g id="node1000" class="node">
<title>L9_S1_TP2_GPU10_norm</title>
<polygon fill="none" stroke="black" points="85470.5,-332.33 85021.5,-332.33 85021.5,-264.33 85470.5,-264.33 85470.5,-332.33"/>
<text text-anchor="middle" x="85246" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="85246" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="85246" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="85246" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP2_GPU10_moe_res&#45;&gt;L9_S1_TP2_GPU10_norm -->
<g id="edge2828" class="edge">
<title>L9_S1_TP2_GPU10_moe_res&#45;&gt;L9_S1_TP2_GPU10_norm</title>
<path fill="none" stroke="black" d="M85246,-368.28C85246,-368.28 85246,-342.46 85246,-342.46"/>
<polygon fill="black" stroke="black" points="85249.5,-342.46 85246,-332.46 85242.5,-342.46 85249.5,-342.46"/>
</g>
<!-- L9_S1_TP3_GPU11_qkv_linear -->
<g id="node1001" class="node">
<title>L9_S1_TP3_GPU11_qkv_linear</title>
<polygon fill="none" stroke="black" points="86611,-1614.75 86003,-1614.75 86003,-1546.75 86611,-1546.75 86611,-1614.75"/>
<text text-anchor="middle" x="86307" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="86307" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="86307" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="86307" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L9_S1_TP3_GPU11_qkv_slice -->
<g id="node1002" class="node">
<title>L9_S1_TP3_GPU11_qkv_slice</title>
<polygon fill="none" stroke="black" points="86605,-1496.67 86009,-1496.67 86009,-1428.67 86605,-1428.67 86605,-1496.67"/>
<text text-anchor="middle" x="86307" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="86307" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="86307" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="86307" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L9_S1_TP3_GPU11_qkv_linear&#45;&gt;L9_S1_TP3_GPU11_qkv_slice -->
<g id="edge2829" class="edge">
<title>L9_S1_TP3_GPU11_qkv_linear&#45;&gt;L9_S1_TP3_GPU11_qkv_slice</title>
<path fill="none" stroke="black" d="M86307,-1546.59C86307,-1546.59 86307,-1506.74 86307,-1506.74"/>
<polygon fill="black" stroke="black" points="86310.5,-1506.74 86307,-1496.74 86303.5,-1506.74 86310.5,-1506.74"/>
</g>
<!-- L9_S1_TP3_GPU11_qkv_slice&#45;&gt;L9_S1_TP3_GPU11_attn_v -->
<g id="edge2833" class="edge">
<title>L9_S1_TP3_GPU11_qkv_slice&#45;&gt;L9_S1_TP3_GPU11_attn_v</title>
<path fill="none" stroke="black" d="M86058.5,-1428.38C86058.5,-1428.38 86058.5,-1195 86058.5,-1195"/>
<polygon fill="black" stroke="black" points="86062,-1195 86058.5,-1185 86055,-1195 86062,-1195"/>
</g>
<!-- L9_S1_TP3_GPU11_qk_matmul -->
<g id="node1003" class="node">
<title>L9_S1_TP3_GPU11_qk_matmul</title>
<polygon fill="none" stroke="black" points="87022.5,-1392.67 86087.5,-1392.67 86087.5,-1324.67 87022.5,-1324.67 87022.5,-1392.67"/>
<text text-anchor="middle" x="86555" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="86555" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="86555" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="86555" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L9_S1_TP3_GPU11_qkv_slice&#45;&gt;L9_S1_TP3_GPU11_qk_matmul -->
<g id="edge2830" class="edge">
<title>L9_S1_TP3_GPU11_qkv_slice&#45;&gt;L9_S1_TP3_GPU11_qk_matmul</title>
<path fill="none" stroke="black" d="M86346.25,-1428.61C86346.25,-1428.61 86346.25,-1402.8 86346.25,-1402.8"/>
<polygon fill="black" stroke="black" points="86349.75,-1402.8 86346.25,-1392.8 86342.75,-1402.8 86349.75,-1402.8"/>
</g>
<!-- L9_S1_TP3_GPU11_softmax -->
<g id="node1004" class="node">
<title>L9_S1_TP3_GPU11_softmax</title>
<polygon fill="none" stroke="black" points="86743,-1288.67 86233,-1288.67 86233,-1220.67 86743,-1220.67 86743,-1288.67"/>
<text text-anchor="middle" x="86488" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="86488" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="86488" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="86488" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L9_S1_TP3_GPU11_qk_matmul&#45;&gt;L9_S1_TP3_GPU11_softmax -->
<g id="edge2831" class="edge">
<title>L9_S1_TP3_GPU11_qk_matmul&#45;&gt;L9_S1_TP3_GPU11_softmax</title>
<path fill="none" stroke="black" d="M86488,-1324.61C86488,-1324.61 86488,-1298.8 86488,-1298.8"/>
<polygon fill="black" stroke="black" points="86491.5,-1298.8 86488,-1288.8 86484.5,-1298.8 86491.5,-1298.8"/>
</g>
<!-- L9_S1_TP3_GPU11_softmax&#45;&gt;L9_S1_TP3_GPU11_attn_v -->
<g id="edge2832" class="edge">
<title>L9_S1_TP3_GPU11_softmax&#45;&gt;L9_S1_TP3_GPU11_attn_v</title>
<path fill="none" stroke="black" d="M86488,-1220.61C86488,-1220.61 86488,-1194.8 86488,-1194.8"/>
<polygon fill="black" stroke="black" points="86491.5,-1194.8 86488,-1184.8 86484.5,-1194.8 86491.5,-1194.8"/>
</g>
<!-- L9_S1_TP3_GPU11_mha_res -->
<g id="node1006" class="node">
<title>L9_S1_TP3_GPU11_mha_res</title>
<polygon fill="none" stroke="black" points="86804.5,-948.5 85917.5,-948.5 85917.5,-880.5 86804.5,-880.5 86804.5,-948.5"/>
<text text-anchor="middle" x="86361" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="86361" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="86361" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="86361" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP3_GPU11_mha_ar&#45;&gt;L9_S1_TP3_GPU11_mha_res -->
<g id="edge2842" class="edge">
<title>L9_S1_TP3_GPU11_mha_ar&#45;&gt;L9_S1_TP3_GPU11_mha_res</title>
<path fill="none" stroke="black" d="M86472.01,-984.55C86472.01,-984.55 86472.01,-958.73 86472.01,-958.73"/>
<polygon fill="black" stroke="black" points="86475.51,-958.73 86472.01,-948.73 86468.51,-958.73 86475.51,-958.73"/>
</g>
<!-- L9_S1_TP3_GPU11_gate -->
<g id="node1007" class="node">
<title>L9_S1_TP3_GPU11_gate</title>
<polygon fill="none" stroke="black" points="86890.56,-844.5 86048.15,-844.5 85831.44,-708.5 86673.85,-708.5 86890.56,-844.5"/>
<text text-anchor="middle" x="86361" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="86361" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="86361" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="86361" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L9_S1_TP3_GPU11_mha_res&#45;&gt;L9_S1_TP3_GPU11_gate -->
<g id="edge2843" class="edge">
<title>L9_S1_TP3_GPU11_mha_res&#45;&gt;L9_S1_TP3_GPU11_gate</title>
<path fill="none" stroke="black" d="M86361,-880.39C86361,-880.39 86361,-854.73 86361,-854.73"/>
<polygon fill="black" stroke="black" points="86364.5,-854.73 86361,-844.73 86357.5,-854.73 86364.5,-854.73"/>
</g>
<!-- L9_S1_TP3_GPU11_moe_res -->
<g id="node1009" class="node">
<title>L9_S1_TP3_GPU11_moe_res</title>
<polygon fill="none" stroke="black" points="86855,-436.33 86035,-436.33 86035,-368.33 86855,-368.33 86855,-436.33"/>
<text text-anchor="middle" x="86445" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="86445" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="86445" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="86445" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP3_GPU11_mha_res&#45;&gt;L9_S1_TP3_GPU11_moe_res -->
<g id="edge2863" class="edge">
<title>L9_S1_TP3_GPU11_mha_res&#45;&gt;L9_S1_TP3_GPU11_moe_res</title>
<path fill="none" stroke="black" d="M86804.77,-925C86863.17,-925 86903.29,-925 86903.29,-925 86903.29,-925 86903.29,-413 86903.29,-413 86903.29,-413 86865.11,-413 86865.11,-413"/>
<polygon fill="black" stroke="black" points="86865.11,-409.5 86855.11,-413 86865.11,-416.5 86865.11,-409.5"/>
</g>
<!-- L9_S1_TP3_GPU11_gate&#45;&gt;L9_S1_TP3_GPU11_expert0 -->
<g id="edge2844" class="edge">
<title>L9_S1_TP3_GPU11_gate&#45;&gt;L9_S1_TP3_GPU11_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M86125.17,-708.31C86125.17,-708.31 86125.17,-682.71 86125.17,-682.71"/>
<polygon fill="black" stroke="black" points="86128.67,-682.71 86125.17,-672.71 86121.67,-682.71 86128.67,-682.71"/>
</g>
<!-- L9_S1_TP3_GPU11_gate&#45;&gt;L9_S1_TP3_GPU11_expert1 -->
<g id="edge2845" class="edge">
<title>L9_S1_TP3_GPU11_gate&#45;&gt;L9_S1_TP3_GPU11_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M86554.57,-708.31C86554.57,-708.31 86554.57,-682.71 86554.57,-682.71"/>
<polygon fill="black" stroke="black" points="86558.07,-682.71 86554.57,-672.71 86551.07,-682.71 86558.07,-682.71"/>
</g>
<!-- L9_S1_TP3_GPU11_moe_ar&#45;&gt;L9_S1_TP3_GPU11_moe_res -->
<g id="edge2862" class="edge">
<title>L9_S1_TP3_GPU11_moe_ar&#45;&gt;L9_S1_TP3_GPU11_moe_res</title>
<path fill="none" stroke="black" d="M86644.18,-473.75C86644.18,-473.75 86644.18,-446.65 86644.18,-446.65"/>
<polygon fill="black" stroke="black" points="86647.68,-446.65 86644.18,-436.65 86640.68,-446.65 86647.68,-446.65"/>
</g>
<!-- L9_S1_TP3_GPU11_norm -->
<g id="node1010" class="node">
<title>L9_S1_TP3_GPU11_norm</title>
<polygon fill="none" stroke="black" points="86669.5,-332.33 86220.5,-332.33 86220.5,-264.33 86669.5,-264.33 86669.5,-332.33"/>
<text text-anchor="middle" x="86445" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="86445" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="86445" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="86445" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP3_GPU11_moe_res&#45;&gt;L9_S1_TP3_GPU11_norm -->
<g id="edge2864" class="edge">
<title>L9_S1_TP3_GPU11_moe_res&#45;&gt;L9_S1_TP3_GPU11_norm</title>
<path fill="none" stroke="black" d="M86445,-368.28C86445,-368.28 86445,-342.46 86445,-342.46"/>
<polygon fill="black" stroke="black" points="86448.5,-342.46 86445,-332.46 86441.5,-342.46 86448.5,-342.46"/>
</g>
<!-- L9_S1_TP4_GPU12_qkv_linear -->
<g id="node1011" class="node">
<title>L9_S1_TP4_GPU12_qkv_linear</title>
<polygon fill="none" stroke="black" points="87607,-1614.75 86999,-1614.75 86999,-1546.75 87607,-1546.75 87607,-1614.75"/>
<text text-anchor="middle" x="87303" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="87303" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="87303" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="87303" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L9_S1_TP4_GPU12_qkv_slice -->
<g id="node1012" class="node">
<title>L9_S1_TP4_GPU12_qkv_slice</title>
<polygon fill="none" stroke="black" points="87601,-1496.67 87005,-1496.67 87005,-1428.67 87601,-1428.67 87601,-1496.67"/>
<text text-anchor="middle" x="87303" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="87303" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="87303" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="87303" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L9_S1_TP4_GPU12_qkv_linear&#45;&gt;L9_S1_TP4_GPU12_qkv_slice -->
<g id="edge2865" class="edge">
<title>L9_S1_TP4_GPU12_qkv_linear&#45;&gt;L9_S1_TP4_GPU12_qkv_slice</title>
<path fill="none" stroke="black" d="M87303,-1546.59C87303,-1546.59 87303,-1506.74 87303,-1506.74"/>
<polygon fill="black" stroke="black" points="87306.5,-1506.74 87303,-1496.74 87299.5,-1506.74 87306.5,-1506.74"/>
</g>
<!-- L9_S1_TP4_GPU12_qkv_slice&#45;&gt;L9_S1_TP4_GPU12_attn_v -->
<g id="edge2869" class="edge">
<title>L9_S1_TP4_GPU12_qkv_slice&#45;&gt;L9_S1_TP4_GPU12_attn_v</title>
<path fill="none" stroke="black" d="M87053,-1428.38C87053,-1428.38 87053,-1195 87053,-1195"/>
<polygon fill="black" stroke="black" points="87056.5,-1195 87053,-1185 87049.5,-1195 87056.5,-1195"/>
</g>
<!-- L9_S1_TP4_GPU12_qk_matmul -->
<g id="node1013" class="node">
<title>L9_S1_TP4_GPU12_qk_matmul</title>
<polygon fill="none" stroke="black" points="88018.5,-1392.67 87083.5,-1392.67 87083.5,-1324.67 88018.5,-1324.67 88018.5,-1392.67"/>
<text text-anchor="middle" x="87551" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="87551" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="87551" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="87551" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L9_S1_TP4_GPU12_qkv_slice&#45;&gt;L9_S1_TP4_GPU12_qk_matmul -->
<g id="edge2866" class="edge">
<title>L9_S1_TP4_GPU12_qkv_slice&#45;&gt;L9_S1_TP4_GPU12_qk_matmul</title>
<path fill="none" stroke="black" d="M87342.25,-1428.61C87342.25,-1428.61 87342.25,-1402.8 87342.25,-1402.8"/>
<polygon fill="black" stroke="black" points="87345.75,-1402.8 87342.25,-1392.8 87338.75,-1402.8 87345.75,-1402.8"/>
</g>
<!-- L9_S1_TP4_GPU12_softmax -->
<g id="node1014" class="node">
<title>L9_S1_TP4_GPU12_softmax</title>
<polygon fill="none" stroke="black" points="87719,-1288.67 87209,-1288.67 87209,-1220.67 87719,-1220.67 87719,-1288.67"/>
<text text-anchor="middle" x="87464" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="87464" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="87464" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="87464" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L9_S1_TP4_GPU12_qk_matmul&#45;&gt;L9_S1_TP4_GPU12_softmax -->
<g id="edge2867" class="edge">
<title>L9_S1_TP4_GPU12_qk_matmul&#45;&gt;L9_S1_TP4_GPU12_softmax</title>
<path fill="none" stroke="black" d="M87464,-1324.61C87464,-1324.61 87464,-1298.8 87464,-1298.8"/>
<polygon fill="black" stroke="black" points="87467.5,-1298.8 87464,-1288.8 87460.5,-1298.8 87467.5,-1298.8"/>
</g>
<!-- L9_S1_TP4_GPU12_softmax&#45;&gt;L9_S1_TP4_GPU12_attn_v -->
<g id="edge2868" class="edge">
<title>L9_S1_TP4_GPU12_softmax&#45;&gt;L9_S1_TP4_GPU12_attn_v</title>
<path fill="none" stroke="black" d="M87464,-1220.61C87464,-1220.61 87464,-1194.8 87464,-1194.8"/>
<polygon fill="black" stroke="black" points="87467.5,-1194.8 87464,-1184.8 87460.5,-1194.8 87467.5,-1194.8"/>
</g>
<!-- L9_S1_TP4_GPU12_mha_res -->
<g id="node1016" class="node">
<title>L9_S1_TP4_GPU12_mha_res</title>
<polygon fill="none" stroke="black" points="87882.5,-948.5 86995.5,-948.5 86995.5,-880.5 87882.5,-880.5 87882.5,-948.5"/>
<text text-anchor="middle" x="87439" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="87439" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="87439" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="87439" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP4_GPU12_mha_ar&#45;&gt;L9_S1_TP4_GPU12_mha_res -->
<g id="edge2878" class="edge">
<title>L9_S1_TP4_GPU12_mha_ar&#45;&gt;L9_S1_TP4_GPU12_mha_res</title>
<path fill="none" stroke="black" d="M87327.49,-984.55C87327.49,-984.55 87327.49,-958.73 87327.49,-958.73"/>
<polygon fill="black" stroke="black" points="87330.99,-958.73 87327.49,-948.73 87323.99,-958.73 87330.99,-958.73"/>
</g>
<!-- L9_S1_TP4_GPU12_gate -->
<g id="node1017" class="node">
<title>L9_S1_TP4_GPU12_gate</title>
<polygon fill="none" stroke="black" points="87968.56,-844.5 87126.15,-844.5 86909.44,-708.5 87751.85,-708.5 87968.56,-844.5"/>
<text text-anchor="middle" x="87439" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="87439" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="87439" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="87439" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L9_S1_TP4_GPU12_mha_res&#45;&gt;L9_S1_TP4_GPU12_gate -->
<g id="edge2879" class="edge">
<title>L9_S1_TP4_GPU12_mha_res&#45;&gt;L9_S1_TP4_GPU12_gate</title>
<path fill="none" stroke="black" d="M87439,-880.39C87439,-880.39 87439,-854.73 87439,-854.73"/>
<polygon fill="black" stroke="black" points="87442.5,-854.73 87439,-844.73 87435.5,-854.73 87442.5,-854.73"/>
</g>
<!-- L9_S1_TP4_GPU12_moe_res -->
<g id="node1019" class="node">
<title>L9_S1_TP4_GPU12_moe_res</title>
<polygon fill="none" stroke="black" points="87778,-436.33 86958,-436.33 86958,-368.33 87778,-368.33 87778,-436.33"/>
<text text-anchor="middle" x="87368" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="87368" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="87368" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="87368" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP4_GPU12_mha_res&#45;&gt;L9_S1_TP4_GPU12_moe_res -->
<g id="edge2899" class="edge">
<title>L9_S1_TP4_GPU12_mha_res&#45;&gt;L9_S1_TP4_GPU12_moe_res</title>
<path fill="none" stroke="black" d="M86995.22,-903C86941.77,-903 86905.64,-903 86905.64,-903 86905.64,-903 86905.64,-390 86905.64,-390 86905.64,-390 86947.78,-390 86947.78,-390"/>
<polygon fill="black" stroke="black" points="86947.78,-393.5 86957.78,-390 86947.78,-386.5 86947.78,-393.5"/>
</g>
<!-- L9_S1_TP4_GPU12_gate&#45;&gt;L9_S1_TP4_GPU12_expert0 -->
<g id="edge2880" class="edge">
<title>L9_S1_TP4_GPU12_gate&#45;&gt;L9_S1_TP4_GPU12_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M87246.25,-708.31C87246.25,-708.31 87246.25,-682.71 87246.25,-682.71"/>
<polygon fill="black" stroke="black" points="87249.75,-682.71 87246.25,-672.71 87242.75,-682.71 87249.75,-682.71"/>
</g>
<!-- L9_S1_TP4_GPU12_gate&#45;&gt;L9_S1_TP4_GPU12_expert1 -->
<g id="edge2881" class="edge">
<title>L9_S1_TP4_GPU12_gate&#45;&gt;L9_S1_TP4_GPU12_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M87675.83,-708.31C87675.83,-708.31 87675.83,-682.71 87675.83,-682.71"/>
<polygon fill="black" stroke="black" points="87679.33,-682.71 87675.83,-672.71 87672.33,-682.71 87679.33,-682.71"/>
</g>
<!-- L9_S1_TP4_GPU12_moe_ar&#45;&gt;L9_S1_TP4_GPU12_moe_res -->
<g id="edge2898" class="edge">
<title>L9_S1_TP4_GPU12_moe_ar&#45;&gt;L9_S1_TP4_GPU12_moe_res</title>
<path fill="none" stroke="black" d="M87113.12,-476.11C87113.12,-476.11 87113.12,-446.55 87113.12,-446.55"/>
<polygon fill="black" stroke="black" points="87116.62,-446.55 87113.12,-436.55 87109.62,-446.55 87116.62,-446.55"/>
</g>
<!-- L9_S1_TP4_GPU12_norm -->
<g id="node1020" class="node">
<title>L9_S1_TP4_GPU12_norm</title>
<polygon fill="none" stroke="black" points="87592.5,-332.33 87143.5,-332.33 87143.5,-264.33 87592.5,-264.33 87592.5,-332.33"/>
<text text-anchor="middle" x="87368" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="87368" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="87368" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="87368" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP4_GPU12_moe_res&#45;&gt;L9_S1_TP4_GPU12_norm -->
<g id="edge2900" class="edge">
<title>L9_S1_TP4_GPU12_moe_res&#45;&gt;L9_S1_TP4_GPU12_norm</title>
<path fill="none" stroke="black" d="M87368,-368.28C87368,-368.28 87368,-342.46 87368,-342.46"/>
<polygon fill="black" stroke="black" points="87371.5,-342.46 87368,-332.46 87364.5,-342.46 87371.5,-342.46"/>
</g>
<!-- L9_S1_TP5_GPU13_qkv_linear -->
<g id="node1021" class="node">
<title>L9_S1_TP5_GPU13_qkv_linear</title>
<polygon fill="none" stroke="black" points="88601,-1614.75 87993,-1614.75 87993,-1546.75 88601,-1546.75 88601,-1614.75"/>
<text text-anchor="middle" x="88297" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="88297" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="88297" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="88297" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L9_S1_TP5_GPU13_qkv_slice -->
<g id="node1022" class="node">
<title>L9_S1_TP5_GPU13_qkv_slice</title>
<polygon fill="none" stroke="black" points="88595,-1496.67 87999,-1496.67 87999,-1428.67 88595,-1428.67 88595,-1496.67"/>
<text text-anchor="middle" x="88297" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="88297" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="88297" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="88297" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L9_S1_TP5_GPU13_qkv_linear&#45;&gt;L9_S1_TP5_GPU13_qkv_slice -->
<g id="edge2901" class="edge">
<title>L9_S1_TP5_GPU13_qkv_linear&#45;&gt;L9_S1_TP5_GPU13_qkv_slice</title>
<path fill="none" stroke="black" d="M88297,-1546.59C88297,-1546.59 88297,-1506.74 88297,-1506.74"/>
<polygon fill="black" stroke="black" points="88300.5,-1506.74 88297,-1496.74 88293.5,-1506.74 88300.5,-1506.74"/>
</g>
<!-- L9_S1_TP5_GPU13_qkv_slice&#45;&gt;L9_S1_TP5_GPU13_attn_v -->
<g id="edge2905" class="edge">
<title>L9_S1_TP5_GPU13_qkv_slice&#45;&gt;L9_S1_TP5_GPU13_attn_v</title>
<path fill="none" stroke="black" d="M88048,-1428.38C88048,-1428.38 88048,-1195 88048,-1195"/>
<polygon fill="black" stroke="black" points="88051.5,-1195 88048,-1185 88044.5,-1195 88051.5,-1195"/>
</g>
<!-- L9_S1_TP5_GPU13_qk_matmul -->
<g id="node1023" class="node">
<title>L9_S1_TP5_GPU13_qk_matmul</title>
<polygon fill="none" stroke="black" points="89012.5,-1392.67 88077.5,-1392.67 88077.5,-1324.67 89012.5,-1324.67 89012.5,-1392.67"/>
<text text-anchor="middle" x="88545" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="88545" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="88545" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="88545" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L9_S1_TP5_GPU13_qkv_slice&#45;&gt;L9_S1_TP5_GPU13_qk_matmul -->
<g id="edge2902" class="edge">
<title>L9_S1_TP5_GPU13_qkv_slice&#45;&gt;L9_S1_TP5_GPU13_qk_matmul</title>
<path fill="none" stroke="black" d="M88336.25,-1428.61C88336.25,-1428.61 88336.25,-1402.8 88336.25,-1402.8"/>
<polygon fill="black" stroke="black" points="88339.75,-1402.8 88336.25,-1392.8 88332.75,-1402.8 88339.75,-1402.8"/>
</g>
<!-- L9_S1_TP5_GPU13_softmax -->
<g id="node1024" class="node">
<title>L9_S1_TP5_GPU13_softmax</title>
<polygon fill="none" stroke="black" points="88694,-1288.67 88184,-1288.67 88184,-1220.67 88694,-1220.67 88694,-1288.67"/>
<text text-anchor="middle" x="88439" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="88439" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="88439" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="88439" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L9_S1_TP5_GPU13_qk_matmul&#45;&gt;L9_S1_TP5_GPU13_softmax -->
<g id="edge2903" class="edge">
<title>L9_S1_TP5_GPU13_qk_matmul&#45;&gt;L9_S1_TP5_GPU13_softmax</title>
<path fill="none" stroke="black" d="M88439,-1324.61C88439,-1324.61 88439,-1298.8 88439,-1298.8"/>
<polygon fill="black" stroke="black" points="88442.5,-1298.8 88439,-1288.8 88435.5,-1298.8 88442.5,-1298.8"/>
</g>
<!-- L9_S1_TP5_GPU13_softmax&#45;&gt;L9_S1_TP5_GPU13_attn_v -->
<g id="edge2904" class="edge">
<title>L9_S1_TP5_GPU13_softmax&#45;&gt;L9_S1_TP5_GPU13_attn_v</title>
<path fill="none" stroke="black" d="M88439,-1220.61C88439,-1220.61 88439,-1194.8 88439,-1194.8"/>
<polygon fill="black" stroke="black" points="88442.5,-1194.8 88439,-1184.8 88435.5,-1194.8 88442.5,-1194.8"/>
</g>
<!-- L9_S1_TP5_GPU13_mha_res -->
<g id="node1026" class="node">
<title>L9_S1_TP5_GPU13_mha_res</title>
<polygon fill="none" stroke="black" points="88960.5,-948.5 88073.5,-948.5 88073.5,-880.5 88960.5,-880.5 88960.5,-948.5"/>
<text text-anchor="middle" x="88517" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="88517" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="88517" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="88517" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP5_GPU13_mha_ar&#45;&gt;L9_S1_TP5_GPU13_mha_res -->
<g id="edge2914" class="edge">
<title>L9_S1_TP5_GPU13_mha_ar&#45;&gt;L9_S1_TP5_GPU13_mha_res</title>
<path fill="none" stroke="black" d="M88250.99,-991.61C88250.99,-991.61 88250.99,-958.74 88250.99,-958.74"/>
<polygon fill="black" stroke="black" points="88254.49,-958.74 88250.99,-948.74 88247.49,-958.74 88254.49,-958.74"/>
</g>
<!-- L9_S1_TP5_GPU13_gate -->
<g id="node1027" class="node">
<title>L9_S1_TP5_GPU13_gate</title>
<polygon fill="none" stroke="black" points="89046.56,-844.5 88204.15,-844.5 87987.44,-708.5 88829.85,-708.5 89046.56,-844.5"/>
<text text-anchor="middle" x="88517" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="88517" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="88517" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="88517" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L9_S1_TP5_GPU13_mha_res&#45;&gt;L9_S1_TP5_GPU13_gate -->
<g id="edge2915" class="edge">
<title>L9_S1_TP5_GPU13_mha_res&#45;&gt;L9_S1_TP5_GPU13_gate</title>
<path fill="none" stroke="black" d="M88517,-880.39C88517,-880.39 88517,-854.73 88517,-854.73"/>
<polygon fill="black" stroke="black" points="88520.5,-854.73 88517,-844.73 88513.5,-854.73 88520.5,-854.73"/>
</g>
<!-- L9_S1_TP5_GPU13_moe_res -->
<g id="node1029" class="node">
<title>L9_S1_TP5_GPU13_moe_res</title>
<polygon fill="none" stroke="black" points="89367,-436.33 88547,-436.33 88547,-368.33 89367,-368.33 89367,-436.33"/>
<text text-anchor="middle" x="88957" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="88957" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="88957" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="88957" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP5_GPU13_mha_res&#45;&gt;L9_S1_TP5_GPU13_moe_res -->
<g id="edge2935" class="edge">
<title>L9_S1_TP5_GPU13_mha_res&#45;&gt;L9_S1_TP5_GPU13_moe_res</title>
<path fill="none" stroke="black" d="M88960.57,-914C89017.27,-914 89056,-914 89056,-914 89056,-914 89056,-691 89056,-691 89056,-691 89230.1,-691 89230.1,-691 89230.1,-691 89230.1,-571 89230.1,-571 89230.1,-571 88966.02,-571 88966.02,-571 88966.02,-571 88966.02,-446.47 88966.02,-446.47"/>
<polygon fill="black" stroke="black" points="88969.52,-446.47 88966.02,-436.47 88962.52,-446.47 88969.52,-446.47"/>
</g>
<!-- L9_S1_TP5_GPU13_gate&#45;&gt;L9_S1_TP5_GPU13_expert0 -->
<g id="edge2916" class="edge">
<title>L9_S1_TP5_GPU13_gate&#45;&gt;L9_S1_TP5_GPU13_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M88139.86,-708.31C88139.86,-708.31 88139.86,-682.71 88139.86,-682.71"/>
<polygon fill="black" stroke="black" points="88143.36,-682.71 88139.86,-672.71 88136.36,-682.71 88143.36,-682.71"/>
</g>
<!-- L9_S1_TP5_GPU13_gate&#45;&gt;L9_S1_TP5_GPU13_expert1 -->
<g id="edge2917" class="edge">
<title>L9_S1_TP5_GPU13_gate&#45;&gt;L9_S1_TP5_GPU13_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M88647.25,-708.31C88647.25,-708.31 88647.25,-682.71 88647.25,-682.71"/>
<polygon fill="black" stroke="black" points="88650.75,-682.71 88647.25,-672.71 88643.75,-682.71 88650.75,-682.71"/>
</g>
<!-- L9_S1_TP5_GPU13_moe_ar&#45;&gt;L9_S1_TP5_GPU13_moe_res -->
<g id="edge2934" class="edge">
<title>L9_S1_TP5_GPU13_moe_ar&#45;&gt;L9_S1_TP5_GPU13_moe_res</title>
<path fill="none" stroke="black" d="M88021.73,-473.95C88021.73,-440.78 88021.73,-402 88021.73,-402 88021.73,-402 88536.78,-402 88536.78,-402"/>
<polygon fill="black" stroke="black" points="88536.78,-405.5 88546.78,-402 88536.78,-398.5 88536.78,-405.5"/>
</g>
<!-- L9_S1_TP5_GPU13_norm -->
<g id="node1030" class="node">
<title>L9_S1_TP5_GPU13_norm</title>
<polygon fill="none" stroke="black" points="89181.5,-332.33 88732.5,-332.33 88732.5,-264.33 89181.5,-264.33 89181.5,-332.33"/>
<text text-anchor="middle" x="88957" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="88957" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="88957" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="88957" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP5_GPU13_moe_res&#45;&gt;L9_S1_TP5_GPU13_norm -->
<g id="edge2936" class="edge">
<title>L9_S1_TP5_GPU13_moe_res&#45;&gt;L9_S1_TP5_GPU13_norm</title>
<path fill="none" stroke="black" d="M88957,-368.28C88957,-368.28 88957,-342.46 88957,-342.46"/>
<polygon fill="black" stroke="black" points="88960.5,-342.46 88957,-332.46 88953.5,-342.46 88960.5,-342.46"/>
</g>
<!-- L9_S1_TP6_GPU14_qkv_linear -->
<g id="node1031" class="node">
<title>L9_S1_TP6_GPU14_qkv_linear</title>
<polygon fill="none" stroke="black" points="89700,-1614.75 89092,-1614.75 89092,-1546.75 89700,-1546.75 89700,-1614.75"/>
<text text-anchor="middle" x="89396" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="89396" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="89396" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="89396" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L9_S1_TP6_GPU14_qkv_slice -->
<g id="node1032" class="node">
<title>L9_S1_TP6_GPU14_qkv_slice</title>
<polygon fill="none" stroke="black" points="89694,-1496.67 89098,-1496.67 89098,-1428.67 89694,-1428.67 89694,-1496.67"/>
<text text-anchor="middle" x="89396" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="89396" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="89396" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="89396" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L9_S1_TP6_GPU14_qkv_linear&#45;&gt;L9_S1_TP6_GPU14_qkv_slice -->
<g id="edge2937" class="edge">
<title>L9_S1_TP6_GPU14_qkv_linear&#45;&gt;L9_S1_TP6_GPU14_qkv_slice</title>
<path fill="none" stroke="black" d="M89396,-1546.59C89396,-1546.59 89396,-1506.74 89396,-1506.74"/>
<polygon fill="black" stroke="black" points="89399.5,-1506.74 89396,-1496.74 89392.5,-1506.74 89399.5,-1506.74"/>
</g>
<!-- L9_S1_TP6_GPU14_qkv_slice&#45;&gt;L9_S1_TP6_GPU14_attn_v -->
<g id="edge2941" class="edge">
<title>L9_S1_TP6_GPU14_qkv_slice&#45;&gt;L9_S1_TP6_GPU14_attn_v</title>
<path fill="none" stroke="black" d="M89137.25,-1428.38C89137.25,-1428.38 89137.25,-1195 89137.25,-1195"/>
<polygon fill="black" stroke="black" points="89140.75,-1195 89137.25,-1185 89133.75,-1195 89140.75,-1195"/>
</g>
<!-- L9_S1_TP6_GPU14_qk_matmul -->
<g id="node1033" class="node">
<title>L9_S1_TP6_GPU14_qk_matmul</title>
<polygon fill="none" stroke="black" points="90111.5,-1392.67 89176.5,-1392.67 89176.5,-1324.67 90111.5,-1324.67 90111.5,-1392.67"/>
<text text-anchor="middle" x="89644" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="89644" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="89644" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="89644" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L9_S1_TP6_GPU14_qkv_slice&#45;&gt;L9_S1_TP6_GPU14_qk_matmul -->
<g id="edge2938" class="edge">
<title>L9_S1_TP6_GPU14_qkv_slice&#45;&gt;L9_S1_TP6_GPU14_qk_matmul</title>
<path fill="none" stroke="black" d="M89435.25,-1428.61C89435.25,-1428.61 89435.25,-1402.8 89435.25,-1402.8"/>
<polygon fill="black" stroke="black" points="89438.75,-1402.8 89435.25,-1392.8 89431.75,-1402.8 89438.75,-1402.8"/>
</g>
<!-- L9_S1_TP6_GPU14_softmax -->
<g id="node1034" class="node">
<title>L9_S1_TP6_GPU14_softmax</title>
<polygon fill="none" stroke="black" points="89792,-1288.67 89282,-1288.67 89282,-1220.67 89792,-1220.67 89792,-1288.67"/>
<text text-anchor="middle" x="89537" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="89537" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="89537" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="89537" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L9_S1_TP6_GPU14_qk_matmul&#45;&gt;L9_S1_TP6_GPU14_softmax -->
<g id="edge2939" class="edge">
<title>L9_S1_TP6_GPU14_qk_matmul&#45;&gt;L9_S1_TP6_GPU14_softmax</title>
<path fill="none" stroke="black" d="M89537,-1324.61C89537,-1324.61 89537,-1298.8 89537,-1298.8"/>
<polygon fill="black" stroke="black" points="89540.5,-1298.8 89537,-1288.8 89533.5,-1298.8 89540.5,-1298.8"/>
</g>
<!-- L9_S1_TP6_GPU14_softmax&#45;&gt;L9_S1_TP6_GPU14_attn_v -->
<g id="edge2940" class="edge">
<title>L9_S1_TP6_GPU14_softmax&#45;&gt;L9_S1_TP6_GPU14_attn_v</title>
<path fill="none" stroke="black" d="M89520,-1220.61C89520,-1220.61 89520,-1194.8 89520,-1194.8"/>
<polygon fill="black" stroke="black" points="89523.5,-1194.8 89520,-1184.8 89516.5,-1194.8 89523.5,-1194.8"/>
</g>
<!-- L9_S1_TP6_GPU14_mha_res -->
<g id="node1036" class="node">
<title>L9_S1_TP6_GPU14_mha_res</title>
<polygon fill="none" stroke="black" points="90038.5,-948.5 89151.5,-948.5 89151.5,-880.5 90038.5,-880.5 90038.5,-948.5"/>
<text text-anchor="middle" x="89595" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="89595" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="89595" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="89595" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP6_GPU14_mha_ar&#45;&gt;L9_S1_TP6_GPU14_mha_res -->
<g id="edge2950" class="edge">
<title>L9_S1_TP6_GPU14_mha_ar&#45;&gt;L9_S1_TP6_GPU14_mha_res</title>
<path fill="none" stroke="black" d="M89174.49,-1015.91C89174.49,-1015.91 89174.49,-958.58 89174.49,-958.58"/>
<polygon fill="black" stroke="black" points="89177.99,-958.58 89174.49,-948.58 89170.99,-958.58 89177.99,-958.58"/>
</g>
<!-- L9_S1_TP6_GPU14_gate -->
<g id="node1037" class="node">
<title>L9_S1_TP6_GPU14_gate</title>
<polygon fill="none" stroke="black" points="90124.56,-844.5 89282.15,-844.5 89065.44,-708.5 89907.85,-708.5 90124.56,-844.5"/>
<text text-anchor="middle" x="89595" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="89595" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="89595" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="89595" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L9_S1_TP6_GPU14_mha_res&#45;&gt;L9_S1_TP6_GPU14_gate -->
<g id="edge2951" class="edge">
<title>L9_S1_TP6_GPU14_mha_res&#45;&gt;L9_S1_TP6_GPU14_gate</title>
<path fill="none" stroke="black" d="M89595,-880.39C89595,-880.39 89595,-854.73 89595,-854.73"/>
<polygon fill="black" stroke="black" points="89598.5,-854.73 89595,-844.73 89591.5,-854.73 89598.5,-854.73"/>
</g>
<!-- L9_S1_TP6_GPU14_moe_res -->
<g id="node1039" class="node">
<title>L9_S1_TP6_GPU14_moe_res</title>
<polygon fill="none" stroke="black" points="90580,-436.33 89760,-436.33 89760,-368.33 90580,-368.33 90580,-436.33"/>
<text text-anchor="middle" x="90170" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="90170" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="90170" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="90170" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP6_GPU14_mha_res&#45;&gt;L9_S1_TP6_GPU14_moe_res -->
<g id="edge2971" class="edge">
<title>L9_S1_TP6_GPU14_mha_res&#45;&gt;L9_S1_TP6_GPU14_moe_res</title>
<path fill="none" stroke="black" d="M90038.57,-914C90095.27,-914 90134,-914 90134,-914 90134,-914 90134,-693 90134,-693 90134,-693 90169.5,-693 90169.5,-693 90169.5,-693 90169.5,-446.53 90169.5,-446.53"/>
<polygon fill="black" stroke="black" points="90173,-446.53 90169.5,-436.53 90166,-446.53 90173,-446.53"/>
</g>
<!-- L9_S1_TP6_GPU14_gate&#45;&gt;L9_S1_TP6_GPU14_expert0 -->
<g id="edge2952" class="edge">
<title>L9_S1_TP6_GPU14_gate&#45;&gt;L9_S1_TP6_GPU14_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89145.86,-708.31C89145.86,-708.31 89145.86,-682.71 89145.86,-682.71"/>
<polygon fill="black" stroke="black" points="89149.36,-682.71 89145.86,-672.71 89142.36,-682.71 89149.36,-682.71"/>
</g>
<!-- L9_S1_TP6_GPU14_gate&#45;&gt;L9_S1_TP6_GPU14_expert1 -->
<g id="edge2953" class="edge">
<title>L9_S1_TP6_GPU14_gate&#45;&gt;L9_S1_TP6_GPU14_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89469,-708.31C89469,-708.31 89469,-682.71 89469,-682.71"/>
<polygon fill="black" stroke="black" points="89472.5,-682.71 89469,-672.71 89465.5,-682.71 89472.5,-682.71"/>
</g>
<!-- L9_S1_TP6_GPU14_moe_ar&#45;&gt;L9_S1_TP6_GPU14_moe_res -->
<g id="edge2970" class="edge">
<title>L9_S1_TP6_GPU14_moe_ar&#45;&gt;L9_S1_TP6_GPU14_moe_res</title>
<path fill="none" stroke="black" d="M88749.73,-475.78C88749.73,-455.94 88749.73,-437 88749.73,-437 88749.73,-437 89960.25,-437 89960.25,-437 89960.25,-437 89960.25,-436.96 89960.25,-436.96"/>
<polygon fill="black" stroke="black" points="89963.75,-446.61 89960.25,-436.61 89956.75,-446.61 89963.75,-446.61"/>
</g>
<!-- L9_S1_TP6_GPU14_norm -->
<g id="node1040" class="node">
<title>L9_S1_TP6_GPU14_norm</title>
<polygon fill="none" stroke="black" points="90394.5,-332.33 89945.5,-332.33 89945.5,-264.33 90394.5,-264.33 90394.5,-332.33"/>
<text text-anchor="middle" x="90170" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="90170" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="90170" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="90170" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP6_GPU14_moe_res&#45;&gt;L9_S1_TP6_GPU14_norm -->
<g id="edge2972" class="edge">
<title>L9_S1_TP6_GPU14_moe_res&#45;&gt;L9_S1_TP6_GPU14_norm</title>
<path fill="none" stroke="black" d="M90170,-368.28C90170,-368.28 90170,-342.46 90170,-342.46"/>
<polygon fill="black" stroke="black" points="90173.5,-342.46 90170,-332.46 90166.5,-342.46 90173.5,-342.46"/>
</g>
<!-- L9_S1_TP7_GPU15_qkv_linear -->
<g id="node1041" class="node">
<title>L9_S1_TP7_GPU15_qkv_linear</title>
<polygon fill="none" stroke="black" points="90745,-1614.75 90137,-1614.75 90137,-1546.75 90745,-1546.75 90745,-1614.75"/>
<text text-anchor="middle" x="90441" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="90441" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="90441" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="90441" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L9_S1_TP7_GPU15_qkv_slice -->
<g id="node1042" class="node">
<title>L9_S1_TP7_GPU15_qkv_slice</title>
<polygon fill="none" stroke="black" points="90739,-1496.67 90143,-1496.67 90143,-1428.67 90739,-1428.67 90739,-1496.67"/>
<text text-anchor="middle" x="90441" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="90441" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="90441" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="90441" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L9_S1_TP7_GPU15_qkv_linear&#45;&gt;L9_S1_TP7_GPU15_qkv_slice -->
<g id="edge2973" class="edge">
<title>L9_S1_TP7_GPU15_qkv_linear&#45;&gt;L9_S1_TP7_GPU15_qkv_slice</title>
<path fill="none" stroke="black" d="M90441,-1546.59C90441,-1546.59 90441,-1506.74 90441,-1506.74"/>
<polygon fill="black" stroke="black" points="90444.5,-1506.74 90441,-1496.74 90437.5,-1506.74 90444.5,-1506.74"/>
</g>
<!-- L9_S1_TP7_GPU15_qkv_slice&#45;&gt;L9_S1_TP7_GPU15_attn_v -->
<g id="edge2977" class="edge">
<title>L9_S1_TP7_GPU15_qkv_slice&#45;&gt;L9_S1_TP7_GPU15_attn_v</title>
<path fill="none" stroke="black" d="M90182.25,-1428.38C90182.25,-1428.38 90182.25,-1195 90182.25,-1195"/>
<polygon fill="black" stroke="black" points="90185.75,-1195 90182.25,-1185 90178.75,-1195 90185.75,-1195"/>
</g>
<!-- L9_S1_TP7_GPU15_qk_matmul -->
<g id="node1043" class="node">
<title>L9_S1_TP7_GPU15_qk_matmul</title>
<polygon fill="none" stroke="black" points="91156.5,-1392.67 90221.5,-1392.67 90221.5,-1324.67 91156.5,-1324.67 91156.5,-1392.67"/>
<text text-anchor="middle" x="90689" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="90689" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="90689" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="90689" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L9_S1_TP7_GPU15_qkv_slice&#45;&gt;L9_S1_TP7_GPU15_qk_matmul -->
<g id="edge2974" class="edge">
<title>L9_S1_TP7_GPU15_qkv_slice&#45;&gt;L9_S1_TP7_GPU15_qk_matmul</title>
<path fill="none" stroke="black" d="M90480.25,-1428.61C90480.25,-1428.61 90480.25,-1402.8 90480.25,-1402.8"/>
<polygon fill="black" stroke="black" points="90483.75,-1402.8 90480.25,-1392.8 90476.75,-1402.8 90483.75,-1402.8"/>
</g>
<!-- L9_S1_TP7_GPU15_softmax -->
<g id="node1044" class="node">
<title>L9_S1_TP7_GPU15_softmax</title>
<polygon fill="none" stroke="black" points="90837,-1288.67 90327,-1288.67 90327,-1220.67 90837,-1220.67 90837,-1288.67"/>
<text text-anchor="middle" x="90582" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="90582" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="90582" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="90582" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L9_S1_TP7_GPU15_qk_matmul&#45;&gt;L9_S1_TP7_GPU15_softmax -->
<g id="edge2975" class="edge">
<title>L9_S1_TP7_GPU15_qk_matmul&#45;&gt;L9_S1_TP7_GPU15_softmax</title>
<path fill="none" stroke="black" d="M90582,-1324.61C90582,-1324.61 90582,-1298.8 90582,-1298.8"/>
<polygon fill="black" stroke="black" points="90585.5,-1298.8 90582,-1288.8 90578.5,-1298.8 90585.5,-1298.8"/>
</g>
<!-- L9_S1_TP7_GPU15_softmax&#45;&gt;L9_S1_TP7_GPU15_attn_v -->
<g id="edge2976" class="edge">
<title>L9_S1_TP7_GPU15_softmax&#45;&gt;L9_S1_TP7_GPU15_attn_v</title>
<path fill="none" stroke="black" d="M90520.5,-1220.61C90520.5,-1220.61 90520.5,-1194.8 90520.5,-1194.8"/>
<polygon fill="black" stroke="black" points="90524,-1194.8 90520.5,-1184.8 90517,-1194.8 90524,-1194.8"/>
</g>
<!-- L9_S1_TP7_GPU15_mha_res -->
<g id="node1046" class="node">
<title>L9_S1_TP7_GPU15_mha_res</title>
<polygon fill="none" stroke="black" points="91116.5,-948.5 90229.5,-948.5 90229.5,-880.5 91116.5,-880.5 91116.5,-948.5"/>
<text text-anchor="middle" x="90673" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="90673" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="90673" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="90673" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP7_GPU15_mha_ar&#45;&gt;L9_S1_TP7_GPU15_mha_res -->
<g id="edge2986" class="edge">
<title>L9_S1_TP7_GPU15_mha_ar&#45;&gt;L9_S1_TP7_GPU15_mha_res</title>
<path fill="none" stroke="black" d="M89943.53,-1016C90188.7,-1016 90471.75,-1016 90471.75,-1016 90471.75,-1016 90471.75,-958.58 90471.75,-958.58"/>
<polygon fill="black" stroke="black" points="90475.25,-958.58 90471.75,-948.58 90468.25,-958.58 90475.25,-958.58"/>
</g>
<!-- L9_S1_TP7_GPU15_gate -->
<g id="node1047" class="node">
<title>L9_S1_TP7_GPU15_gate</title>
<polygon fill="none" stroke="black" points="91202.56,-844.5 90360.15,-844.5 90143.44,-708.5 90985.85,-708.5 91202.56,-844.5"/>
<text text-anchor="middle" x="90673" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="90673" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="90673" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="90673" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L9_S1_TP7_GPU15_mha_res&#45;&gt;L9_S1_TP7_GPU15_gate -->
<g id="edge2987" class="edge">
<title>L9_S1_TP7_GPU15_mha_res&#45;&gt;L9_S1_TP7_GPU15_gate</title>
<path fill="none" stroke="black" d="M90673,-880.39C90673,-880.39 90673,-854.73 90673,-854.73"/>
<polygon fill="black" stroke="black" points="90676.5,-854.73 90673,-844.73 90669.5,-854.73 90676.5,-854.73"/>
</g>
<!-- L9_S1_TP7_GPU15_moe_res -->
<g id="node1049" class="node">
<title>L9_S1_TP7_GPU15_moe_res</title>
<polygon fill="none" stroke="black" points="91503,-436.33 90683,-436.33 90683,-368.33 91503,-368.33 91503,-436.33"/>
<text text-anchor="middle" x="91093" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="91093" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="91093" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="91093" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP7_GPU15_mha_res&#45;&gt;L9_S1_TP7_GPU15_moe_res -->
<g id="edge3007" class="edge">
<title>L9_S1_TP7_GPU15_mha_res&#45;&gt;L9_S1_TP7_GPU15_moe_res</title>
<path fill="none" stroke="black" d="M91116.53,-925C91245.75,-925 91352.89,-925 91352.89,-925 91352.89,-925 91352.89,-446.63 91352.89,-446.63"/>
<polygon fill="black" stroke="black" points="91356.39,-446.63 91352.89,-436.63 91349.39,-446.63 91356.39,-446.63"/>
</g>
<!-- L9_S1_TP7_GPU15_gate&#45;&gt;L9_S1_TP7_GPU15_expert0 -->
<g id="edge2988" class="edge">
<title>L9_S1_TP7_GPU15_gate&#45;&gt;L9_S1_TP7_GPU15_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M90151.86,-776.4C90151.86,-776.4 90151.86,-682.74 90151.86,-682.74"/>
<polygon fill="black" stroke="black" points="90155.36,-682.74 90151.86,-672.74 90148.36,-682.74 90155.36,-682.74"/>
</g>
<!-- L9_S1_TP7_GPU15_gate&#45;&gt;L9_S1_TP7_GPU15_expert1 -->
<g id="edge2989" class="edge">
<title>L9_S1_TP7_GPU15_gate&#45;&gt;L9_S1_TP7_GPU15_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M90403,-708.31C90403,-708.31 90403,-682.71 90403,-682.71"/>
<polygon fill="black" stroke="black" points="90406.5,-682.71 90403,-672.71 90399.5,-682.71 90406.5,-682.71"/>
</g>
<!-- L9_S1_TP7_GPU15_moe_ar&#45;&gt;L9_S1_TP7_GPU15_moe_res -->
<g id="edge3006" class="edge">
<title>L9_S1_TP7_GPU15_moe_ar&#45;&gt;L9_S1_TP7_GPU15_moe_res</title>
<path fill="none" stroke="black" d="M89538.8,-486C89991.34,-486 90942.89,-486 90942.89,-486 90942.89,-486 90942.89,-446.36 90942.89,-446.36"/>
<polygon fill="black" stroke="black" points="90946.39,-446.36 90942.89,-436.36 90939.39,-446.36 90946.39,-446.36"/>
</g>
<!-- L9_S1_TP7_GPU15_norm -->
<g id="node1050" class="node">
<title>L9_S1_TP7_GPU15_norm</title>
<polygon fill="none" stroke="black" points="91317.5,-332.33 90868.5,-332.33 90868.5,-264.33 91317.5,-264.33 91317.5,-332.33"/>
<text text-anchor="middle" x="91093" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="91093" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="91093" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="91093" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L9_S1_TP7_GPU15_moe_res&#45;&gt;L9_S1_TP7_GPU15_norm -->
<g id="edge3008" class="edge">
<title>L9_S1_TP7_GPU15_moe_res&#45;&gt;L9_S1_TP7_GPU15_norm</title>
<path fill="none" stroke="black" d="M91093,-368.28C91093,-368.28 91093,-342.46 91093,-342.46"/>
<polygon fill="black" stroke="black" points="91096.5,-342.46 91093,-332.46 91089.5,-342.46 91096.5,-342.46"/>
</g>
<!-- L10_S1_TP0_GPU8_qkv_linear -->
<g id="node1051" class="node">
<title>L10_S1_TP0_GPU8_qkv_linear</title>
<polygon fill="none" stroke="black" points="92484,-1614.75 91876,-1614.75 91876,-1546.75 92484,-1546.75 92484,-1614.75"/>
<text text-anchor="middle" x="92180" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="92180" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="92180" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="92180" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L10_S1_TP0_GPU8_qkv_slice -->
<g id="node1052" class="node">
<title>L10_S1_TP0_GPU8_qkv_slice</title>
<polygon fill="none" stroke="black" points="92478,-1496.67 91882,-1496.67 91882,-1428.67 92478,-1428.67 92478,-1496.67"/>
<text text-anchor="middle" x="92180" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="92180" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="92180" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="92180" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L10_S1_TP0_GPU8_qkv_linear&#45;&gt;L10_S1_TP0_GPU8_qkv_slice -->
<g id="edge3009" class="edge">
<title>L10_S1_TP0_GPU8_qkv_linear&#45;&gt;L10_S1_TP0_GPU8_qkv_slice</title>
<path fill="none" stroke="black" d="M92180,-1546.59C92180,-1546.59 92180,-1506.74 92180,-1506.74"/>
<polygon fill="black" stroke="black" points="92183.5,-1506.74 92180,-1496.74 92176.5,-1506.74 92183.5,-1506.74"/>
</g>
<!-- L10_S1_TP0_GPU8_qk_matmul -->
<g id="node1053" class="node">
<title>L10_S1_TP0_GPU8_qk_matmul</title>
<polygon fill="none" stroke="black" points="92952.5,-1392.67 92017.5,-1392.67 92017.5,-1324.67 92952.5,-1324.67 92952.5,-1392.67"/>
<text text-anchor="middle" x="92485" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="92485" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="92485" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="92485" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L10_S1_TP0_GPU8_qkv_slice&#45;&gt;L10_S1_TP0_GPU8_qk_matmul -->
<g id="edge3010" class="edge">
<title>L10_S1_TP0_GPU8_qkv_slice&#45;&gt;L10_S1_TP0_GPU8_qk_matmul</title>
<path fill="none" stroke="black" d="M92247.75,-1428.61C92247.75,-1428.61 92247.75,-1402.8 92247.75,-1402.8"/>
<polygon fill="black" stroke="black" points="92251.25,-1402.8 92247.75,-1392.8 92244.25,-1402.8 92251.25,-1402.8"/>
</g>
<!-- L10_S1_TP0_GPU8_attn_v -->
<g id="node1055" class="node">
<title>L10_S1_TP0_GPU8_attn_v</title>
<polygon fill="none" stroke="black" points="92952,-1184.67 92014,-1184.67 92014,-1116.67 92952,-1116.67 92952,-1184.67"/>
<text text-anchor="middle" x="92483" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="92483" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="92483" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="92483" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L10_S1_TP0_GPU8_qkv_slice&#45;&gt;L10_S1_TP0_GPU8_attn_v -->
<g id="edge3013" class="edge">
<title>L10_S1_TP0_GPU8_qkv_slice&#45;&gt;L10_S1_TP0_GPU8_attn_v</title>
<path fill="none" stroke="black" d="M91948,-1428.61C91948,-1347.57 91948,-1150 91948,-1150 91948,-1150 92003.87,-1150 92003.87,-1150"/>
<polygon fill="black" stroke="black" points="92003.87,-1153.5 92013.87,-1150 92003.87,-1146.5 92003.87,-1153.5"/>
</g>
<!-- L10_S1_TP0_GPU8_softmax -->
<g id="node1054" class="node">
<title>L10_S1_TP0_GPU8_softmax</title>
<polygon fill="none" stroke="black" points="92739,-1288.67 92229,-1288.67 92229,-1220.67 92739,-1220.67 92739,-1288.67"/>
<text text-anchor="middle" x="92484" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="92484" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="92484" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="92484" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L10_S1_TP0_GPU8_qk_matmul&#45;&gt;L10_S1_TP0_GPU8_softmax -->
<g id="edge3011" class="edge">
<title>L10_S1_TP0_GPU8_qk_matmul&#45;&gt;L10_S1_TP0_GPU8_softmax</title>
<path fill="none" stroke="black" d="M92484,-1324.61C92484,-1324.61 92484,-1298.8 92484,-1298.8"/>
<polygon fill="black" stroke="black" points="92487.5,-1298.8 92484,-1288.8 92480.5,-1298.8 92487.5,-1298.8"/>
</g>
<!-- L10_S1_TP0_GPU8_softmax&#45;&gt;L10_S1_TP0_GPU8_attn_v -->
<g id="edge3012" class="edge">
<title>L10_S1_TP0_GPU8_softmax&#45;&gt;L10_S1_TP0_GPU8_attn_v</title>
<path fill="none" stroke="black" d="M92484,-1220.61C92484,-1220.61 92484,-1194.8 92484,-1194.8"/>
<polygon fill="black" stroke="black" points="92487.5,-1194.8 92484,-1184.8 92480.5,-1194.8 92487.5,-1194.8"/>
</g>
<!-- L10_S1_TP0_GPU8_mha_ar -->
<g id="node1056" class="node">
<title>L10_S1_TP0_GPU8_mha_ar</title>
<ellipse fill="none" stroke="black" cx="93137" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="93137" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="93137" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="93137" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="93137" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP0_GPU8_attn_v&#45;&gt;L10_S1_TP0_GPU8_mha_ar -->
<g id="edge3014" class="edge">
<title>L10_S1_TP0_GPU8_attn_v&#45;&gt;L10_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M92788.74,-1116.51C92788.74,-1116.51 92788.74,-1060.6 92788.74,-1060.6"/>
<polygon fill="black" stroke="black" points="92792.24,-1060.6 92788.74,-1050.6 92785.24,-1060.6 92792.24,-1060.6"/>
</g>
<!-- L10_S1_TP1_GPU9_mha_ar -->
<g id="node1089" class="node">
<title>L10_S1_TP1_GPU9_mha_ar</title>
<ellipse fill="none" stroke="black" cx="93906" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="93906" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="93906" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="93906" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="93906" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP0_GPU8_attn_v&#45;&gt;L10_S1_TP1_GPU9_mha_ar -->
<g id="edge3050" class="edge">
<title>L10_S1_TP0_GPU8_attn_v&#45;&gt;L10_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M92815.95,-1116.55C92815.95,-1100.15 92815.95,-1084 92815.95,-1084 92815.95,-1084 93577.71,-1084 93577.71,-1084 93577.71,-1084 93577.71,-1066.18 93577.71,-1066.18"/>
<polygon fill="black" stroke="black" points="93581.21,-1066.18 93577.71,-1056.18 93574.21,-1066.18 93581.21,-1066.18"/>
</g>
<!-- L10_S1_TP2_GPU10_mha_ar -->
<g id="node1099" class="node">
<title>L10_S1_TP2_GPU10_mha_ar</title>
<ellipse fill="none" stroke="black" cx="94675" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="94675" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="94675" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="94675" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="94675" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP0_GPU8_attn_v&#45;&gt;L10_S1_TP2_GPU10_mha_ar -->
<g id="edge3086" class="edge">
<title>L10_S1_TP0_GPU8_attn_v&#45;&gt;L10_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M92843.16,-1116.55C92843.16,-1100.15 92843.16,-1084 92843.16,-1084 92843.16,-1084 94362.25,-1084 94362.25,-1084 94362.25,-1084 94362.25,-1069.2 94362.25,-1069.2"/>
<polygon fill="black" stroke="black" points="94365.75,-1069.2 94362.25,-1059.2 94358.75,-1069.2 94365.75,-1069.2"/>
</g>
<!-- L10_S1_TP3_GPU11_mha_ar -->
<g id="node1109" class="node">
<title>L10_S1_TP3_GPU11_mha_ar</title>
<ellipse fill="none" stroke="black" cx="95444" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="95444" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="95444" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="95444" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="95444" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP0_GPU8_attn_v&#45;&gt;L10_S1_TP3_GPU11_mha_ar -->
<g id="edge3122" class="edge">
<title>L10_S1_TP0_GPU8_attn_v&#45;&gt;L10_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M92870.37,-1116.55C92870.37,-1100.15 92870.37,-1084 92870.37,-1084 92870.37,-1084 95175.8,-1084 95175.8,-1084 95175.8,-1084 95175.8,-1076.31 95175.8,-1076.31"/>
<polygon fill="black" stroke="black" points="95179.3,-1076.31 95175.8,-1066.31 95172.3,-1076.31 95179.3,-1076.31"/>
</g>
<!-- L10_S1_TP4_GPU12_mha_ar -->
<g id="node1119" class="node">
<title>L10_S1_TP4_GPU12_mha_ar</title>
<ellipse fill="none" stroke="black" cx="96213" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="96213" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="96213" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="96213" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="96213" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP0_GPU8_attn_v&#45;&gt;L10_S1_TP4_GPU12_mha_ar -->
<g id="edge3158" class="edge">
<title>L10_S1_TP0_GPU8_attn_v&#45;&gt;L10_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M92725.51,-1116.4C92725.51,-1061.27 92725.51,-959 92725.51,-959 92725.51,-959 95894.84,-959 95894.84,-959 95894.84,-959 95894.84,-996.85 95894.84,-996.85"/>
<polygon fill="black" stroke="black" points="95891.34,-996.85 95894.84,-1006.85 95898.34,-996.85 95891.34,-996.85"/>
</g>
<!-- L10_S1_TP5_GPU13_mha_ar -->
<g id="node1129" class="node">
<title>L10_S1_TP5_GPU13_mha_ar</title>
<ellipse fill="none" stroke="black" cx="96982" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="96982" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="96982" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="96982" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="96982" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP0_GPU8_attn_v&#45;&gt;L10_S1_TP5_GPU13_mha_ar -->
<g id="edge3194" class="edge">
<title>L10_S1_TP0_GPU8_attn_v&#45;&gt;L10_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M92845.5,-1184.71C92845.5,-1198.4 92845.5,-1211 92845.5,-1211 92845.5,-1211 96788,-1211 96788,-1211 96788,-1211 96788,-1083.96 96788,-1083.96"/>
<polygon fill="black" stroke="black" points="96791.5,-1083.96 96788,-1073.96 96784.5,-1083.96 96791.5,-1083.96"/>
</g>
<!-- L10_S1_TP6_GPU14_mha_ar -->
<g id="node1139" class="node">
<title>L10_S1_TP6_GPU14_mha_ar</title>
<ellipse fill="none" stroke="black" cx="97751" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="97751" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="97751" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="97751" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="97751" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP0_GPU8_attn_v&#45;&gt;L10_S1_TP6_GPU14_mha_ar -->
<g id="edge3230" class="edge">
<title>L10_S1_TP0_GPU8_attn_v&#45;&gt;L10_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M92897.58,-1116.52C92897.58,-1109.92 92897.58,-1105 92897.58,-1105 92897.58,-1105 97426.45,-1105 97426.45,-1105 97426.45,-1105 97426.45,-1067.1 97426.45,-1067.1"/>
<polygon fill="black" stroke="black" points="97429.95,-1067.1 97426.45,-1057.1 97422.95,-1067.1 97429.95,-1067.1"/>
</g>
<!-- L10_S1_TP7_GPU15_mha_ar -->
<g id="node1149" class="node">
<title>L10_S1_TP7_GPU15_mha_ar</title>
<ellipse fill="none" stroke="black" cx="98520" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="98520" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="98520" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="98520" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="98520" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP0_GPU8_attn_v&#45;&gt;L10_S1_TP7_GPU15_mha_ar -->
<g id="edge3266" class="edge">
<title>L10_S1_TP0_GPU8_attn_v&#45;&gt;L10_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M92924.79,-1116.36C92924.79,-1110.36 92924.79,-1106 92924.79,-1106 92924.79,-1106 98212.46,-1106 98212.46,-1106 98212.46,-1106 98212.46,-1070.34 98212.46,-1070.34"/>
<polygon fill="black" stroke="black" points="98215.96,-1070.34 98212.46,-1060.34 98208.96,-1070.34 98215.96,-1070.34"/>
</g>
<!-- L10_S1_TP0_GPU8_mha_res -->
<g id="node1064" class="node">
<title>L10_S1_TP0_GPU8_mha_res</title>
<polygon fill="none" stroke="black" points="92498.5,-948.5 91611.5,-948.5 91611.5,-880.5 92498.5,-880.5 92498.5,-948.5"/>
<text text-anchor="middle" x="92055" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="92055" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="92055" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="92055" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP0_GPU8_mha_ar&#45;&gt;L10_S1_TP0_GPU8_mha_res -->
<g id="edge3022" class="edge">
<title>L10_S1_TP0_GPU8_mha_ar&#45;&gt;L10_S1_TP0_GPU8_mha_res</title>
<path fill="none" stroke="black" d="M92781.3,-1048C92536.86,-1048 92256.25,-1048 92256.25,-1048 92256.25,-1048 92256.25,-958.53 92256.25,-958.53"/>
<polygon fill="black" stroke="black" points="92259.75,-958.53 92256.25,-948.53 92252.75,-958.53 92259.75,-958.53"/>
</g>
<!-- L10_S1_TP1_GPU9_attn_v -->
<g id="node1057" class="node">
<title>L10_S1_TP1_GPU9_attn_v</title>
<polygon fill="none" stroke="black" points="93908,-1184.67 92970,-1184.67 92970,-1116.67 93908,-1116.67 93908,-1184.67"/>
<text text-anchor="middle" x="93439" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="93439" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="93439" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="93439" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L10_S1_TP1_GPU9_attn_v&#45;&gt;L10_S1_TP0_GPU8_mha_ar -->
<g id="edge3015" class="edge">
<title>L10_S1_TP1_GPU9_attn_v&#45;&gt;L10_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M93037.81,-1116.51C93037.81,-1116.51 93037.81,-1088.96 93037.81,-1088.96"/>
<polygon fill="black" stroke="black" points="93041.31,-1088.96 93037.81,-1078.96 93034.31,-1088.96 93041.31,-1088.96"/>
</g>
<!-- L10_S1_TP1_GPU9_attn_v&#45;&gt;L10_S1_TP1_GPU9_mha_ar -->
<g id="edge3051" class="edge">
<title>L10_S1_TP1_GPU9_attn_v&#45;&gt;L10_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M93624.89,-1116.51C93624.89,-1116.51 93624.89,-1074.64 93624.89,-1074.64"/>
<polygon fill="black" stroke="black" points="93628.39,-1074.64 93624.89,-1064.64 93621.39,-1074.64 93628.39,-1074.64"/>
</g>
<!-- L10_S1_TP1_GPU9_attn_v&#45;&gt;L10_S1_TP2_GPU10_mha_ar -->
<g id="edge3087" class="edge">
<title>L10_S1_TP1_GPU9_attn_v&#45;&gt;L10_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M93672.08,-1116.55C93672.08,-1100.15 93672.08,-1084 93672.08,-1084 93672.08,-1084 94424.96,-1084 94424.96,-1084 94424.96,-1084 94424.96,-1078.57 94424.96,-1078.57"/>
<polygon fill="black" stroke="black" points="94428.46,-1078.57 94424.96,-1068.57 94421.46,-1078.57 94428.46,-1078.57"/>
</g>
<!-- L10_S1_TP1_GPU9_attn_v&#45;&gt;L10_S1_TP3_GPU11_mha_ar -->
<g id="edge3123" class="edge">
<title>L10_S1_TP1_GPU9_attn_v&#45;&gt;L10_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M93719.26,-1116.55C93719.26,-1100.15 93719.26,-1084 93719.26,-1084 93719.26,-1084 95283.08,-1084 95283.08,-1084 95283.08,-1084 95283.08,-1083.24 95283.08,-1083.24"/>
<polygon fill="black" stroke="black" points="95286.58,-1086.41 95283.08,-1076.41 95279.58,-1086.41 95286.58,-1086.41"/>
</g>
<!-- L10_S1_TP1_GPU9_attn_v&#45;&gt;L10_S1_TP4_GPU12_mha_ar -->
<g id="edge3159" class="edge">
<title>L10_S1_TP1_GPU9_attn_v&#45;&gt;L10_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M93521.5,-1116.4C93521.5,-1061.27 93521.5,-959 93521.5,-959 93521.5,-959 95866.18,-959 95866.18,-959 95866.18,-959 95866.18,-1004.01 95866.18,-1004.01"/>
<polygon fill="black" stroke="black" points="95862.68,-1004.01 95866.18,-1014.01 95869.68,-1004.01 95862.68,-1004.01"/>
</g>
<!-- L10_S1_TP1_GPU9_attn_v&#45;&gt;L10_S1_TP5_GPU13_mha_ar -->
<g id="edge3195" class="edge">
<title>L10_S1_TP1_GPU9_attn_v&#45;&gt;L10_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M93766.45,-1116.52C93766.45,-1109.92 93766.45,-1105 93766.45,-1105 93766.45,-1105 96634.77,-1105 96634.77,-1105 96634.77,-1105 96634.77,-1061.23 96634.77,-1061.23"/>
<polygon fill="black" stroke="black" points="96638.27,-1061.23 96634.77,-1051.23 96631.27,-1061.23 96638.27,-1061.23"/>
</g>
<!-- L10_S1_TP1_GPU9_attn_v&#45;&gt;L10_S1_TP6_GPU14_mha_ar -->
<g id="edge3231" class="edge">
<title>L10_S1_TP1_GPU9_attn_v&#45;&gt;L10_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M93813.63,-1116.52C93813.63,-1109.92 93813.63,-1105 93813.63,-1105 93813.63,-1105 97477.38,-1105 97477.38,-1105 97477.38,-1105 97477.38,-1075.82 97477.38,-1075.82"/>
<polygon fill="black" stroke="black" points="97480.88,-1075.82 97477.38,-1065.82 97473.88,-1075.82 97480.88,-1075.82"/>
</g>
<!-- L10_S1_TP1_GPU9_attn_v&#45;&gt;L10_S1_TP7_GPU15_mha_ar -->
<g id="edge3267" class="edge">
<title>L10_S1_TP1_GPU9_attn_v&#45;&gt;L10_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M93860.82,-1116.36C93860.82,-1110.36 93860.82,-1106 93860.82,-1106 93860.82,-1106 98280.39,-1106 98280.39,-1106 98280.39,-1106 98280.39,-1079.72 98280.39,-1079.72"/>
<polygon fill="black" stroke="black" points="98283.89,-1079.72 98280.39,-1069.72 98276.89,-1079.72 98283.89,-1079.72"/>
</g>
<!-- L10_S1_TP2_GPU10_attn_v -->
<g id="node1058" class="node">
<title>L10_S1_TP2_GPU10_attn_v</title>
<polygon fill="none" stroke="black" points="94864,-1184.67 93926,-1184.67 93926,-1116.67 94864,-1116.67 94864,-1184.67"/>
<text text-anchor="middle" x="94395" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="94395" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="94395" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="94395" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L10_S1_TP2_GPU10_attn_v&#45;&gt;L10_S1_TP0_GPU8_mha_ar -->
<g id="edge3016" class="edge">
<title>L10_S1_TP2_GPU10_attn_v&#45;&gt;L10_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M93985.25,-1116.53C93985.25,-1115.56 93985.25,-1115 93985.25,-1115 93985.25,-1115 93105.62,-1115 93105.62,-1115 93105.62,-1115 93105.62,-1090.53 93105.62,-1090.53"/>
<polygon fill="black" stroke="black" points="93109.12,-1090.53 93105.62,-1080.53 93102.12,-1090.53 93109.12,-1090.53"/>
</g>
<!-- L10_S1_TP2_GPU10_attn_v&#45;&gt;L10_S1_TP1_GPU9_mha_ar -->
<g id="edge3052" class="edge">
<title>L10_S1_TP2_GPU10_attn_v&#45;&gt;L10_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M94044.49,-1116.51C94044.49,-1116.51 94044.49,-1087.65 94044.49,-1087.65"/>
<polygon fill="black" stroke="black" points="94047.99,-1087.65 94044.49,-1077.65 94040.99,-1087.65 94047.99,-1087.65"/>
</g>
<!-- L10_S1_TP2_GPU10_attn_v&#45;&gt;L10_S1_TP2_GPU10_mha_ar -->
<g id="edge3088" class="edge">
<title>L10_S1_TP2_GPU10_attn_v&#45;&gt;L10_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M94487.68,-1116.51C94487.68,-1116.51 94487.68,-1084.63 94487.68,-1084.63"/>
<polygon fill="black" stroke="black" points="94491.18,-1084.63 94487.68,-1074.63 94484.18,-1084.63 94491.18,-1084.63"/>
</g>
<!-- L10_S1_TP2_GPU10_attn_v&#45;&gt;L10_S1_TP3_GPU11_mha_ar -->
<g id="edge3124" class="edge">
<title>L10_S1_TP2_GPU10_attn_v&#45;&gt;L10_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M94550.4,-1116.55C94550.4,-1100.15 94550.4,-1084 94550.4,-1084 94550.4,-1084 95390.36,-1084 95390.36,-1084 95390.36,-1084 95390.36,-1083.63 95390.36,-1083.63"/>
<polygon fill="black" stroke="black" points="95393.86,-1090.3 95390.36,-1080.3 95386.86,-1090.3 95393.86,-1090.3"/>
</g>
<!-- L10_S1_TP2_GPU10_attn_v&#45;&gt;L10_S1_TP4_GPU12_mha_ar -->
<g id="edge3160" class="edge">
<title>L10_S1_TP2_GPU10_attn_v&#45;&gt;L10_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M94613.12,-1116.36C94613.12,-1110.36 94613.12,-1106 94613.12,-1106 94613.12,-1106 96052.42,-1106 96052.42,-1106 96052.42,-1106 96052.42,-1086.14 96052.42,-1086.14"/>
<polygon fill="black" stroke="black" points="96055.92,-1086.14 96052.42,-1076.14 96048.92,-1086.14 96055.92,-1086.14"/>
</g>
<!-- L10_S1_TP2_GPU10_attn_v&#45;&gt;L10_S1_TP5_GPU13_mha_ar -->
<g id="edge3196" class="edge">
<title>L10_S1_TP2_GPU10_attn_v&#45;&gt;L10_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M94675.84,-1116.36C94675.84,-1110.36 94675.84,-1106 94675.84,-1106 94675.84,-1106 96663.02,-1106 96663.02,-1106 96663.02,-1106 96663.02,-1068.26 96663.02,-1068.26"/>
<polygon fill="black" stroke="black" points="96666.52,-1068.26 96663.02,-1058.26 96659.52,-1068.26 96666.52,-1068.26"/>
</g>
<!-- L10_S1_TP2_GPU10_attn_v&#45;&gt;L10_S1_TP6_GPU14_mha_ar -->
<g id="edge3232" class="edge">
<title>L10_S1_TP2_GPU10_attn_v&#45;&gt;L10_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M94738.56,-1116.36C94738.56,-1110.36 94738.56,-1106 94738.56,-1106 94738.56,-1106 97528.3,-1106 97528.3,-1106 97528.3,-1106 97528.3,-1081.44 97528.3,-1081.44"/>
<polygon fill="black" stroke="black" points="97531.8,-1081.44 97528.3,-1071.44 97524.8,-1081.44 97531.8,-1081.44"/>
</g>
<!-- L10_S1_TP2_GPU10_attn_v&#45;&gt;L10_S1_TP7_GPU15_mha_ar -->
<g id="edge3268" class="edge">
<title>L10_S1_TP2_GPU10_attn_v&#45;&gt;L10_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M94801.28,-1116.36C94801.28,-1110.36 94801.28,-1106 94801.28,-1106 94801.28,-1106 98348.33,-1106 98348.33,-1106 98348.33,-1106 98348.33,-1085.71 98348.33,-1085.71"/>
<polygon fill="black" stroke="black" points="98351.83,-1085.71 98348.33,-1075.71 98344.83,-1085.71 98351.83,-1085.71"/>
</g>
<!-- L10_S1_TP3_GPU11_attn_v -->
<g id="node1059" class="node">
<title>L10_S1_TP3_GPU11_attn_v</title>
<polygon fill="none" stroke="black" points="95820,-1184.67 94882,-1184.67 94882,-1116.67 95820,-1116.67 95820,-1184.67"/>
<text text-anchor="middle" x="95351" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="95351" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="95351" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="95351" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L10_S1_TP3_GPU11_attn_v&#45;&gt;L10_S1_TP0_GPU8_mha_ar -->
<g id="edge3017" class="edge">
<title>L10_S1_TP3_GPU11_attn_v&#45;&gt;L10_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M94915.69,-1116.53C94915.69,-1115.56 94915.69,-1115 94915.69,-1115 94915.69,-1115 93173.43,-1115 93173.43,-1115 93173.43,-1115 93173.43,-1090.53 93173.43,-1090.53"/>
<polygon fill="black" stroke="black" points="93176.93,-1090.53 93173.43,-1080.53 93169.93,-1090.53 93176.93,-1090.53"/>
</g>
<!-- L10_S1_TP3_GPU11_attn_v&#45;&gt;L10_S1_TP1_GPU9_mha_ar -->
<g id="edge3053" class="edge">
<title>L10_S1_TP3_GPU11_attn_v&#45;&gt;L10_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M94949.39,-1116.53C94949.39,-1115.56 94949.39,-1115 94949.39,-1115 94949.39,-1115 94103.74,-1115 94103.74,-1115 94103.74,-1115 94103.74,-1083.79 94103.74,-1083.79"/>
<polygon fill="black" stroke="black" points="94107.24,-1083.79 94103.74,-1073.79 94100.24,-1083.79 94107.24,-1083.79"/>
</g>
<!-- L10_S1_TP3_GPU11_attn_v&#45;&gt;L10_S1_TP2_GPU10_mha_ar -->
<g id="edge3089" class="edge">
<title>L10_S1_TP3_GPU11_attn_v&#45;&gt;L10_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M94983.08,-1116.51C94983.08,-1116.51 94983.08,-1070.31 94983.08,-1070.31"/>
<polygon fill="black" stroke="black" points="94986.58,-1070.31 94983.08,-1060.31 94979.58,-1070.31 94986.58,-1070.31"/>
</g>
<!-- L10_S1_TP3_GPU11_attn_v&#45;&gt;L10_S1_TP3_GPU11_mha_ar -->
<g id="edge3125" class="edge">
<title>L10_S1_TP3_GPU11_attn_v&#45;&gt;L10_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M95497.64,-1116.51C95497.64,-1116.51 95497.64,-1090.27 95497.64,-1090.27"/>
<polygon fill="black" stroke="black" points="95501.14,-1090.27 95497.64,-1080.27 95494.14,-1090.27 95501.14,-1090.27"/>
</g>
<!-- L10_S1_TP3_GPU11_attn_v&#45;&gt;L10_S1_TP4_GPU12_mha_ar -->
<g id="edge3161" class="edge">
<title>L10_S1_TP3_GPU11_attn_v&#45;&gt;L10_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M95820.03,-1161C95823.09,-1161 95824.71,-1161 95824.71,-1161 95824.71,-1161 95824.71,-1016 95824.71,-1016 95824.71,-1016 95850.55,-1016 95850.55,-1016"/>
<polygon fill="black" stroke="black" points="95850.55,-1019.5 95860.55,-1016 95850.55,-1012.5 95850.55,-1019.5"/>
</g>
<!-- L10_S1_TP3_GPU11_attn_v&#45;&gt;L10_S1_TP5_GPU13_mha_ar -->
<g id="edge3197" class="edge">
<title>L10_S1_TP3_GPU11_attn_v&#45;&gt;L10_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M95771,-1185.05C95771,-1186.28 95771,-1187 95771,-1187 95771,-1187 96782,-1187 96782,-1187 96782,-1187 96782,-1083.56 96782,-1083.56"/>
<polygon fill="black" stroke="black" points="96785.5,-1083.56 96782,-1073.56 96778.5,-1083.56 96785.5,-1083.56"/>
</g>
<!-- L10_S1_TP3_GPU11_attn_v&#45;&gt;L10_S1_TP6_GPU14_mha_ar -->
<g id="edge3233" class="edge">
<title>L10_S1_TP3_GPU11_attn_v&#45;&gt;L10_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M95722,-1185.03C95722,-1191.35 95722,-1196 95722,-1196 95722,-1196 97741,-1196 97741,-1196 97741,-1196 97741,-1090.73 97741,-1090.73"/>
<polygon fill="black" stroke="black" points="97744.5,-1090.73 97741,-1080.73 97737.5,-1090.73 97744.5,-1090.73"/>
</g>
<!-- L10_S1_TP3_GPU11_attn_v&#45;&gt;L10_S1_TP7_GPU15_mha_ar -->
<g id="edge3269" class="edge">
<title>L10_S1_TP3_GPU11_attn_v&#45;&gt;L10_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M95604.92,-1116.36C95604.92,-1110.36 95604.92,-1106 95604.92,-1106 95604.92,-1106 98416.26,-1106 98416.26,-1106 98416.26,-1106 98416.26,-1089.08 98416.26,-1089.08"/>
<polygon fill="black" stroke="black" points="98419.76,-1089.08 98416.26,-1079.08 98412.76,-1089.08 98419.76,-1089.08"/>
</g>
<!-- L10_S1_TP4_GPU12_attn_v -->
<g id="node1060" class="node">
<title>L10_S1_TP4_GPU12_attn_v</title>
<polygon fill="none" stroke="black" points="96776,-1184.67 95838,-1184.67 95838,-1116.67 96776,-1116.67 96776,-1184.67"/>
<text text-anchor="middle" x="96307" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="96307" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="96307" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="96307" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L10_S1_TP4_GPU12_attn_v&#45;&gt;L10_S1_TP0_GPU8_mha_ar -->
<g id="edge3018" class="edge">
<title>L10_S1_TP4_GPU12_attn_v&#45;&gt;L10_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M95945.21,-1116.36C95945.21,-1110.36 95945.21,-1106 95945.21,-1106 95945.21,-1106 93241.24,-1106 93241.24,-1106 93241.24,-1106 93241.24,-1089.08 93241.24,-1089.08"/>
<polygon fill="black" stroke="black" points="93244.74,-1089.08 93241.24,-1079.08 93237.74,-1089.08 93244.74,-1089.08"/>
</g>
<!-- L10_S1_TP4_GPU12_attn_v&#45;&gt;L10_S1_TP1_GPU9_mha_ar -->
<g id="edge3054" class="edge">
<title>L10_S1_TP4_GPU12_attn_v&#45;&gt;L10_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M95914.33,-1184.8C95914.33,-1193.77 95914.33,-1201 95914.33,-1201 95914.33,-1201 93917,-1201 93917,-1201 93917,-1201 93917,-1090.84 93917,-1090.84"/>
<polygon fill="black" stroke="black" points="93920.5,-1090.84 93917,-1080.84 93913.5,-1090.84 93920.5,-1090.84"/>
</g>
<!-- L10_S1_TP4_GPU12_attn_v&#45;&gt;L10_S1_TP2_GPU10_mha_ar -->
<g id="edge3090" class="edge">
<title>L10_S1_TP4_GPU12_attn_v&#45;&gt;L10_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M95876.17,-1184.8C95876.17,-1189.08 95876.17,-1192 95876.17,-1192 95876.17,-1192 94877.5,-1192 94877.5,-1192 94877.5,-1192 94877.5,-1083.22 94877.5,-1083.22"/>
<polygon fill="black" stroke="black" points="94881,-1083.22 94877.5,-1073.22 94874,-1083.22 94881,-1083.22"/>
</g>
<!-- L10_S1_TP4_GPU12_attn_v&#45;&gt;L10_S1_TP3_GPU11_mha_ar -->
<g id="edge3126" class="edge">
<title>L10_S1_TP4_GPU12_attn_v&#45;&gt;L10_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M95837.93,-1139C95827.95,-1139 95822.36,-1139 95822.36,-1139 95822.36,-1139 95822.36,-1048 95822.36,-1048 95822.36,-1048 95809.82,-1048 95809.82,-1048"/>
<polygon fill="black" stroke="black" points="95809.82,-1044.5 95799.82,-1048 95809.82,-1051.5 95809.82,-1044.5"/>
</g>
<!-- L10_S1_TP4_GPU12_attn_v&#45;&gt;L10_S1_TP4_GPU12_mha_ar -->
<g id="edge3162" class="edge">
<title>L10_S1_TP4_GPU12_attn_v&#45;&gt;L10_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M96159.63,-1116.51C96159.63,-1116.51 96159.63,-1090.27 96159.63,-1090.27"/>
<polygon fill="black" stroke="black" points="96163.13,-1090.27 96159.63,-1080.27 96156.13,-1090.27 96163.13,-1090.27"/>
</g>
<!-- L10_S1_TP4_GPU12_attn_v&#45;&gt;L10_S1_TP5_GPU13_mha_ar -->
<g id="edge3198" class="edge">
<title>L10_S1_TP4_GPU12_attn_v&#45;&gt;L10_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M96691.26,-1116.51C96691.26,-1116.51 96691.26,-1073.04 96691.26,-1073.04"/>
<polygon fill="black" stroke="black" points="96694.76,-1073.04 96691.26,-1063.04 96687.76,-1073.04 96694.76,-1073.04"/>
</g>
<!-- L10_S1_TP4_GPU12_attn_v&#45;&gt;L10_S1_TP6_GPU14_mha_ar -->
<g id="edge3234" class="edge">
<title>L10_S1_TP4_GPU12_attn_v&#45;&gt;L10_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M96719.51,-1116.36C96719.51,-1110.36 96719.51,-1106 96719.51,-1106 96719.51,-1106 97579.23,-1106 97579.23,-1106 97579.23,-1106 97579.23,-1085.71 97579.23,-1085.71"/>
<polygon fill="black" stroke="black" points="97582.73,-1085.71 97579.23,-1075.71 97575.73,-1085.71 97582.73,-1085.71"/>
</g>
<!-- L10_S1_TP4_GPU12_attn_v&#45;&gt;L10_S1_TP7_GPU15_mha_ar -->
<g id="edge3270" class="edge">
<title>L10_S1_TP4_GPU12_attn_v&#45;&gt;L10_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M96747.75,-1116.26C96747.75,-1110.85 96747.75,-1107 96747.75,-1107 96747.75,-1107 98484.2,-1107 98484.2,-1107 98484.2,-1107 98484.2,-1090.55 98484.2,-1090.55"/>
<polygon fill="black" stroke="black" points="98487.7,-1090.55 98484.2,-1080.55 98480.7,-1090.55 98487.7,-1090.55"/>
</g>
<!-- L10_S1_TP5_GPU13_attn_v -->
<g id="node1061" class="node">
<title>L10_S1_TP5_GPU13_attn_v</title>
<polygon fill="none" stroke="black" points="97732,-1184.67 96794,-1184.67 96794,-1116.67 97732,-1116.67 97732,-1184.67"/>
<text text-anchor="middle" x="97263" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="97263" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="97263" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="97263" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L10_S1_TP5_GPU13_attn_v&#45;&gt;L10_S1_TP0_GPU8_mha_ar -->
<g id="edge3019" class="edge">
<title>L10_S1_TP5_GPU13_attn_v&#45;&gt;L10_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M96864.43,-1116.36C96864.43,-1110.36 96864.43,-1106 96864.43,-1106 96864.43,-1106 93309.05,-1106 93309.05,-1106 93309.05,-1106 93309.05,-1085.71 93309.05,-1085.71"/>
<polygon fill="black" stroke="black" points="93312.55,-1085.71 93309.05,-1075.71 93305.55,-1085.71 93312.55,-1085.71"/>
</g>
<!-- L10_S1_TP5_GPU13_attn_v&#45;&gt;L10_S1_TP1_GPU9_mha_ar -->
<g id="edge3055" class="edge">
<title>L10_S1_TP5_GPU13_attn_v&#45;&gt;L10_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M96934.87,-1116.36C96934.87,-1110.36 96934.87,-1106 96934.87,-1106 96934.87,-1106 94162.98,-1106 94162.98,-1106 94162.98,-1106 94162.98,-1078 94162.98,-1078"/>
<polygon fill="black" stroke="black" points="94166.48,-1078 94162.98,-1068 94159.48,-1078 94166.48,-1078"/>
</g>
<!-- L10_S1_TP5_GPU13_attn_v&#45;&gt;L10_S1_TP2_GPU10_mha_ar -->
<g id="edge3091" class="edge">
<title>L10_S1_TP5_GPU13_attn_v&#45;&gt;L10_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M96871.25,-1184.68C96871.25,-1197.03 96871.25,-1208 96871.25,-1208 96871.25,-1208 94873,-1208 94873,-1208 94873,-1208 94873,-1083.71 94873,-1083.71"/>
<polygon fill="black" stroke="black" points="94876.5,-1083.71 94873,-1073.71 94869.5,-1083.71 94876.5,-1083.71"/>
</g>
<!-- L10_S1_TP5_GPU13_attn_v&#45;&gt;L10_S1_TP3_GPU11_mha_ar -->
<g id="edge3127" class="edge">
<title>L10_S1_TP5_GPU13_attn_v&#45;&gt;L10_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M97005.3,-1116.36C97005.3,-1110.36 97005.3,-1106 97005.3,-1106 97005.3,-1106 95712.2,-1106 95712.2,-1106 95712.2,-1106 95712.2,-1076.28 95712.2,-1076.28"/>
<polygon fill="black" stroke="black" points="95715.7,-1076.28 95712.2,-1066.28 95708.7,-1076.28 95715.7,-1076.28"/>
</g>
<!-- L10_S1_TP5_GPU13_attn_v&#45;&gt;L10_S1_TP4_GPU12_mha_ar -->
<g id="edge3163" class="edge">
<title>L10_S1_TP5_GPU13_attn_v&#45;&gt;L10_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M97075.74,-1116.43C97075.74,-1102.67 97075.74,-1090 97075.74,-1090 97075.74,-1090 96266.84,-1090 96266.84,-1090 96266.84,-1090 96266.84,-1089.03 96266.84,-1089.03"/>
<polygon fill="black" stroke="black" points="96270.34,-1090.26 96266.84,-1080.26 96263.34,-1090.26 96270.34,-1090.26"/>
</g>
<!-- L10_S1_TP5_GPU13_attn_v&#45;&gt;L10_S1_TP5_GPU13_mha_ar -->
<g id="edge3199" class="edge">
<title>L10_S1_TP5_GPU13_attn_v&#45;&gt;L10_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M97146.17,-1116.51C97146.17,-1116.51 97146.17,-1085.92 97146.17,-1085.92"/>
<polygon fill="black" stroke="black" points="97149.67,-1085.92 97146.17,-1075.92 97142.67,-1085.92 97149.67,-1085.92"/>
</g>
<!-- L10_S1_TP5_GPU13_attn_v&#45;&gt;L10_S1_TP6_GPU14_mha_ar -->
<g id="edge3235" class="edge">
<title>L10_S1_TP5_GPU13_attn_v&#45;&gt;L10_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M97630.15,-1116.51C97630.15,-1116.51 97630.15,-1088.52 97630.15,-1088.52"/>
<polygon fill="black" stroke="black" points="97633.65,-1088.52 97630.15,-1078.52 97626.65,-1088.52 97633.65,-1088.52"/>
</g>
<!-- L10_S1_TP5_GPU13_attn_v&#45;&gt;L10_S1_TP7_GPU15_mha_ar -->
<g id="edge3271" class="edge">
<title>L10_S1_TP5_GPU13_attn_v&#45;&gt;L10_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M97681.08,-1116.26C97681.08,-1110.85 97681.08,-1107 97681.08,-1107 97681.08,-1107 98552.13,-1107 98552.13,-1107 98552.13,-1107 98552.13,-1090.55 98552.13,-1090.55"/>
<polygon fill="black" stroke="black" points="98555.63,-1090.55 98552.13,-1080.55 98548.63,-1090.55 98555.63,-1090.55"/>
</g>
<!-- L10_S1_TP6_GPU14_attn_v -->
<g id="node1062" class="node">
<title>L10_S1_TP6_GPU14_attn_v</title>
<polygon fill="none" stroke="black" points="98688,-1184.67 97750,-1184.67 97750,-1116.67 98688,-1116.67 98688,-1184.67"/>
<text text-anchor="middle" x="98219" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="98219" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="98219" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="98219" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L10_S1_TP6_GPU14_attn_v&#45;&gt;L10_S1_TP0_GPU8_mha_ar -->
<g id="edge3020" class="edge">
<title>L10_S1_TP6_GPU14_attn_v&#45;&gt;L10_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M97797.06,-1116.36C97797.06,-1110.36 97797.06,-1106 97797.06,-1106 97797.06,-1106 93376.86,-1106 93376.86,-1106 93376.86,-1106 93376.86,-1079.72 93376.86,-1079.72"/>
<polygon fill="black" stroke="black" points="93380.36,-1079.72 93376.86,-1069.72 93373.36,-1079.72 93380.36,-1079.72"/>
</g>
<!-- L10_S1_TP6_GPU14_attn_v&#45;&gt;L10_S1_TP1_GPU9_mha_ar -->
<g id="edge3056" class="edge">
<title>L10_S1_TP6_GPU14_attn_v&#45;&gt;L10_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M97844.12,-1116.36C97844.12,-1110.36 97844.12,-1106 97844.12,-1106 97844.12,-1106 94222.23,-1106 94222.23,-1106 94222.23,-1106 94222.23,-1068.67 94222.23,-1068.67"/>
<polygon fill="black" stroke="black" points="94225.73,-1068.67 94222.23,-1058.67 94218.73,-1068.67 94225.73,-1068.67"/>
</g>
<!-- L10_S1_TP6_GPU14_attn_v&#45;&gt;L10_S1_TP2_GPU10_mha_ar -->
<g id="edge3092" class="edge">
<title>L10_S1_TP6_GPU14_attn_v&#45;&gt;L10_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M97891.18,-1116.36C97891.18,-1110.36 97891.18,-1106 97891.18,-1106 97891.18,-1106 95016.78,-1106 95016.78,-1106 95016.78,-1106 95016.78,-1062.64 95016.78,-1062.64"/>
<polygon fill="black" stroke="black" points="95020.28,-1062.64 95016.78,-1052.64 95013.28,-1062.64 95020.28,-1062.64"/>
</g>
<!-- L10_S1_TP6_GPU14_attn_v&#45;&gt;L10_S1_TP3_GPU11_mha_ar -->
<g id="edge3128" class="edge">
<title>L10_S1_TP6_GPU14_attn_v&#45;&gt;L10_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M98135.5,-1116.55C98135.5,-1066.23 98135.5,-978 98135.5,-978 98135.5,-978 95790.02,-978 95790.02,-978 95790.02,-978 95790.02,-1003.8 95790.02,-1003.8"/>
<polygon fill="black" stroke="black" points="95786.52,-1003.8 95790.02,-1013.8 95793.52,-1003.8 95786.52,-1003.8"/>
</g>
<!-- L10_S1_TP6_GPU14_attn_v&#45;&gt;L10_S1_TP4_GPU12_mha_ar -->
<g id="edge3164" class="edge">
<title>L10_S1_TP6_GPU14_attn_v&#45;&gt;L10_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M97938.24,-1116.43C97938.24,-1102.67 97938.24,-1090 97938.24,-1090 97938.24,-1090 96374.05,-1090 96374.05,-1090 96374.05,-1090 96374.05,-1086.1 96374.05,-1086.1"/>
<polygon fill="black" stroke="black" points="96377.55,-1086.1 96374.05,-1076.1 96370.55,-1086.1 96377.55,-1086.1"/>
</g>
<!-- L10_S1_TP6_GPU14_attn_v&#45;&gt;L10_S1_TP5_GPU13_mha_ar -->
<g id="edge3200" class="edge">
<title>L10_S1_TP6_GPU14_attn_v&#45;&gt;L10_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M97985.3,-1116.43C97985.3,-1102.67 97985.3,-1090 97985.3,-1090 97985.3,-1090 97216.61,-1090 97216.61,-1090 97216.61,-1090 97216.61,-1080.24 97216.61,-1080.24"/>
<polygon fill="black" stroke="black" points="97220.11,-1080.24 97216.61,-1070.24 97213.11,-1080.24 97220.11,-1080.24"/>
</g>
<!-- L10_S1_TP6_GPU14_attn_v&#45;&gt;L10_S1_TP6_GPU14_mha_ar -->
<g id="edge3236" class="edge">
<title>L10_S1_TP6_GPU14_attn_v&#45;&gt;L10_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M98032.36,-1116.51C98032.36,-1116.51 98032.36,-1074.64 98032.36,-1074.64"/>
<polygon fill="black" stroke="black" points="98035.86,-1074.64 98032.36,-1064.64 98028.86,-1074.64 98035.86,-1074.64"/>
</g>
<!-- L10_S1_TP6_GPU14_attn_v&#45;&gt;L10_S1_TP7_GPU15_mha_ar -->
<g id="edge3272" class="edge">
<title>L10_S1_TP6_GPU14_attn_v&#45;&gt;L10_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M98620.07,-1116.51C98620.07,-1116.51 98620.07,-1088.96 98620.07,-1088.96"/>
<polygon fill="black" stroke="black" points="98623.57,-1088.96 98620.07,-1078.96 98616.57,-1088.96 98623.57,-1088.96"/>
</g>
<!-- L10_S1_TP7_GPU15_attn_v -->
<g id="node1063" class="node">
<title>L10_S1_TP7_GPU15_attn_v</title>
<polygon fill="none" stroke="black" points="99644,-1184.67 98706,-1184.67 98706,-1116.67 99644,-1116.67 99644,-1184.67"/>
<text text-anchor="middle" x="99175" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="99175" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="99175" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="99175" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L10_S1_TP7_GPU15_attn_v&#45;&gt;L10_S1_TP0_GPU8_mha_ar -->
<g id="edge3021" class="edge">
<title>L10_S1_TP7_GPU15_attn_v&#45;&gt;L10_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M98737.58,-1116.36C98737.58,-1110.36 98737.58,-1106 98737.58,-1106 98737.58,-1106 93444.66,-1106 93444.66,-1106 93444.66,-1106 93444.66,-1070.34 93444.66,-1070.34"/>
<polygon fill="black" stroke="black" points="93448.16,-1070.34 93444.66,-1060.34 93441.16,-1070.34 93448.16,-1070.34"/>
</g>
<!-- L10_S1_TP7_GPU15_attn_v&#45;&gt;L10_S1_TP1_GPU9_mha_ar -->
<g id="edge3057" class="edge">
<title>L10_S1_TP7_GPU15_attn_v&#45;&gt;L10_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M98942.82,-1116.36C98942.82,-1065.74 98942.82,-977 98942.82,-977 98942.82,-977 94024.49,-977 94024.49,-977 94024.49,-977 94024.49,-977.99 94024.49,-977.99"/>
<polygon fill="black" stroke="black" points="94020.99,-976.94 94024.49,-986.94 94027.99,-976.94 94020.99,-976.94"/>
</g>
<!-- L10_S1_TP7_GPU15_attn_v&#45;&gt;L10_S1_TP2_GPU10_mha_ar -->
<g id="edge3093" class="edge">
<title>L10_S1_TP7_GPU15_attn_v&#45;&gt;L10_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M98852.75,-1184.72C98852.75,-1200.15 98852.75,-1215 98852.75,-1215 98852.75,-1215 94868.5,-1215 94868.5,-1215 94868.5,-1215 94868.5,-1083.98 94868.5,-1083.98"/>
<polygon fill="black" stroke="black" points="94872,-1083.98 94868.5,-1073.98 94865,-1083.98 94872,-1083.98"/>
</g>
<!-- L10_S1_TP7_GPU15_attn_v&#45;&gt;L10_S1_TP3_GPU11_mha_ar -->
<g id="edge3129" class="edge">
<title>L10_S1_TP7_GPU15_attn_v&#45;&gt;L10_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M98919.15,-1116.55C98919.15,-1066.23 98919.15,-978 98919.15,-978 98919.15,-978 95761.26,-978 95761.26,-978 95761.26,-978 95761.26,-996.57 95761.26,-996.57"/>
<polygon fill="black" stroke="black" points="95757.76,-996.57 95761.26,-1006.57 95764.76,-996.57 95757.76,-996.57"/>
</g>
<!-- L10_S1_TP7_GPU15_attn_v&#45;&gt;L10_S1_TP4_GPU12_mha_ar -->
<g id="edge3165" class="edge">
<title>L10_S1_TP7_GPU15_attn_v&#45;&gt;L10_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M98769.16,-1116.43C98769.16,-1102.67 98769.16,-1090 98769.16,-1090 98769.16,-1090 96481.26,-1090 96481.26,-1090 96481.26,-1090 96481.26,-1076.31 96481.26,-1076.31"/>
<polygon fill="black" stroke="black" points="96484.76,-1076.31 96481.26,-1066.31 96477.76,-1076.31 96484.76,-1076.31"/>
</g>
<!-- L10_S1_TP7_GPU15_attn_v&#45;&gt;L10_S1_TP5_GPU13_mha_ar -->
<g id="edge3201" class="edge">
<title>L10_S1_TP7_GPU15_attn_v&#45;&gt;L10_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M98800.74,-1116.43C98800.74,-1102.67 98800.74,-1090 98800.74,-1090 98800.74,-1090 97287.04,-1090 97287.04,-1090 97287.04,-1090 97287.04,-1070.95 97287.04,-1070.95"/>
<polygon fill="black" stroke="black" points="97290.54,-1070.95 97287.04,-1060.95 97283.54,-1070.96 97290.54,-1070.95"/>
</g>
<!-- L10_S1_TP7_GPU15_attn_v&#45;&gt;L10_S1_TP6_GPU14_mha_ar -->
<g id="edge3237" class="edge">
<title>L10_S1_TP7_GPU15_attn_v&#45;&gt;L10_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M98832.32,-1116.43C98832.32,-1102.67 98832.32,-1090 98832.32,-1090 98832.32,-1090 98079.41,-1090 98079.41,-1090 98079.41,-1090 98079.41,-1065.94 98079.41,-1065.94"/>
<polygon fill="black" stroke="black" points="98082.91,-1065.94 98079.41,-1055.94 98075.91,-1065.94 98082.91,-1065.94"/>
</g>
<!-- L10_S1_TP7_GPU15_attn_v&#45;&gt;L10_S1_TP7_GPU15_mha_ar -->
<g id="edge3273" class="edge">
<title>L10_S1_TP7_GPU15_attn_v&#45;&gt;L10_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M98863.89,-1116.51C98863.89,-1116.51 98863.89,-1061.95 98863.89,-1061.95"/>
<polygon fill="black" stroke="black" points="98867.39,-1061.95 98863.89,-1051.95 98860.39,-1061.95 98867.39,-1061.95"/>
</g>
<!-- L10_S1_TP0_GPU8_gate -->
<g id="node1065" class="node">
<title>L10_S1_TP0_GPU8_gate</title>
<polygon fill="none" stroke="black" points="92584.56,-844.5 91742.15,-844.5 91525.44,-708.5 92367.85,-708.5 92584.56,-844.5"/>
<text text-anchor="middle" x="92055" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="92055" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="92055" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="92055" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L10_S1_TP0_GPU8_mha_res&#45;&gt;L10_S1_TP0_GPU8_gate -->
<g id="edge3023" class="edge">
<title>L10_S1_TP0_GPU8_mha_res&#45;&gt;L10_S1_TP0_GPU8_gate</title>
<path fill="none" stroke="black" d="M92055,-880.39C92055,-880.39 92055,-854.73 92055,-854.73"/>
<polygon fill="black" stroke="black" points="92058.5,-854.73 92055,-844.73 92051.5,-854.73 92058.5,-854.73"/>
</g>
<!-- L10_S1_TP0_GPU8_moe_res -->
<g id="node1083" class="node">
<title>L10_S1_TP0_GPU8_moe_res</title>
<polygon fill="none" stroke="black" points="92547,-436.33 91727,-436.33 91727,-368.33 92547,-368.33 92547,-436.33"/>
<text text-anchor="middle" x="92137" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="92137" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="92137" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="92137" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP0_GPU8_mha_res&#45;&gt;L10_S1_TP0_GPU8_moe_res -->
<g id="edge3043" class="edge">
<title>L10_S1_TP0_GPU8_mha_res&#45;&gt;L10_S1_TP0_GPU8_moe_res</title>
<path fill="none" stroke="black" d="M91611.43,-903C91553.69,-903 91514.11,-903 91514.11,-903 91514.11,-903 91514.11,-402 91514.11,-402 91514.11,-402 91716.73,-402 91716.73,-402"/>
<polygon fill="black" stroke="black" points="91716.73,-405.5 91726.73,-402 91716.73,-398.5 91716.73,-405.5"/>
</g>
<!-- L10_S1_TP0_GPU8_expert0 -->
<g id="node1066" class="node">
<title>L10_S1_TP0_GPU8_expert0</title>
<polygon fill="none" stroke="black" points="92549.5,-672.5 92100.5,-672.5 92100.5,-604.5 92549.5,-604.5 92549.5,-672.5"/>
<text text-anchor="middle" x="92325" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="92325" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="92325" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="92325" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L10_S1_TP0_GPU8_gate&#45;&gt;L10_S1_TP0_GPU8_expert0 -->
<g id="edge3024" class="edge">
<title>L10_S1_TP0_GPU8_gate&#45;&gt;L10_S1_TP0_GPU8_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92325,-708.31C92325,-708.31 92325,-682.71 92325,-682.71"/>
<polygon fill="black" stroke="black" points="92328.5,-682.71 92325,-672.71 92321.5,-682.71 92328.5,-682.71"/>
</g>
<!-- L10_S1_TP0_GPU8_expert1 -->
<g id="node1067" class="node">
<title>L10_S1_TP0_GPU8_expert1</title>
<polygon fill="none" stroke="black" points="93016.5,-672.5 92567.5,-672.5 92567.5,-604.5 93016.5,-604.5 93016.5,-672.5"/>
<text text-anchor="middle" x="92792" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="92792" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="92792" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="92792" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L10_S1_TP0_GPU8_gate&#45;&gt;L10_S1_TP0_GPU8_expert1 -->
<g id="edge3025" class="edge">
<title>L10_S1_TP0_GPU8_gate&#45;&gt;L10_S1_TP0_GPU8_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92576.14,-776.4C92576.14,-776.4 92576.14,-682.74 92576.14,-682.74"/>
<polygon fill="black" stroke="black" points="92579.64,-682.74 92576.14,-672.74 92572.64,-682.74 92579.64,-682.74"/>
</g>
<!-- L10_S1_TP0_GPU8_moe_ar -->
<g id="node1068" class="node">
<title>L10_S1_TP0_GPU8_moe_ar</title>
<ellipse fill="none" stroke="black" cx="93423" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="93423" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="93423" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="93423" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="93423" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP0_GPU8_expert0&#45;&gt;L10_S1_TP0_GPU8_moe_ar -->
<g id="edge3026" class="edge">
<title>L10_S1_TP0_GPU8_expert0&#45;&gt;L10_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M92502.35,-604.4C92502.35,-576.28 92502.35,-541 92502.35,-541 92502.35,-541 93110.59,-541 93110.59,-541"/>
<polygon fill="black" stroke="black" points="93110.59,-544.5 93120.59,-541 93110.59,-537.5 93110.59,-544.5"/>
</g>
<!-- L10_S1_TP1_GPU9_moe_ar -->
<g id="node1092" class="node">
<title>L10_S1_TP1_GPU9_moe_ar</title>
<ellipse fill="none" stroke="black" cx="94110" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="94110" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="94110" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="94110" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="94110" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP0_GPU8_expert0&#45;&gt;L10_S1_TP1_GPU9_moe_ar -->
<g id="edge3062" class="edge">
<title>L10_S1_TP0_GPU8_expert0&#45;&gt;L10_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M92413.05,-604.26C92413.05,-595.25 92413.05,-588 92413.05,-588 92413.05,-588 93793.03,-588 93793.03,-588 93793.03,-588 93793.03,-546.09 93793.03,-546.09"/>
<polygon fill="black" stroke="black" points="93796.53,-546.09 93793.03,-536.09 93789.53,-546.09 93796.53,-546.09"/>
</g>
<!-- L10_S1_TP2_GPU10_moe_ar -->
<g id="node1102" class="node">
<title>L10_S1_TP2_GPU10_moe_ar</title>
<ellipse fill="none" stroke="black" cx="94797" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="94797" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="94797" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="94797" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="94797" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP0_GPU8_expert0&#45;&gt;L10_S1_TP2_GPU10_moe_ar -->
<g id="edge3098" class="edge">
<title>L10_S1_TP0_GPU8_expert0&#45;&gt;L10_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M92368.4,-604.31C92368.4,-552.23 92368.4,-459 92368.4,-459 92368.4,-459 94567.69,-459 94567.69,-459 94567.69,-459 94567.69,-475.4 94567.69,-475.4"/>
<polygon fill="black" stroke="black" points="94564.19,-475.4 94567.69,-485.4 94571.19,-475.4 94564.19,-475.4"/>
</g>
<!-- L10_S1_TP3_GPU11_moe_ar -->
<g id="node1112" class="node">
<title>L10_S1_TP3_GPU11_moe_ar</title>
<ellipse fill="none" stroke="black" cx="95484" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="95484" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="95484" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="95484" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="95484" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP0_GPU8_expert0&#45;&gt;L10_S1_TP3_GPU11_moe_ar -->
<g id="edge3134" class="edge">
<title>L10_S1_TP0_GPU8_expert0&#45;&gt;L10_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M92323.75,-604.31C92323.75,-552.23 92323.75,-459 92323.75,-459 92323.75,-459 95362.36,-459 95362.36,-459 95362.36,-459 95362.36,-465.46 95362.36,-465.46"/>
<polygon fill="black" stroke="black" points="95358.86,-465.46 95362.36,-475.46 95365.86,-465.46 95358.86,-465.46"/>
</g>
<!-- L10_S1_TP4_GPU12_moe_ar -->
<g id="node1122" class="node">
<title>L10_S1_TP4_GPU12_moe_ar</title>
<ellipse fill="none" stroke="black" cx="96171" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="96171" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="96171" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="96171" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="96171" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP0_GPU8_expert0&#45;&gt;L10_S1_TP4_GPU12_moe_ar -->
<g id="edge3170" class="edge">
<title>L10_S1_TP0_GPU8_expert0&#45;&gt;L10_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M92279.1,-604.31C92279.1,-552.23 92279.1,-459 92279.1,-459 92279.1,-459 95871.38,-459 95871.38,-459 95871.38,-459 95871.38,-488.94 95871.38,-488.94"/>
<polygon fill="black" stroke="black" points="95867.88,-488.94 95871.38,-498.94 95874.88,-488.94 95867.88,-488.94"/>
</g>
<!-- L10_S1_TP5_GPU13_moe_ar -->
<g id="node1132" class="node">
<title>L10_S1_TP5_GPU13_moe_ar</title>
<ellipse fill="none" stroke="black" cx="96858" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="96858" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="96858" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="96858" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="96858" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP0_GPU8_expert0&#45;&gt;L10_S1_TP5_GPU13_moe_ar -->
<g id="edge3206" class="edge">
<title>L10_S1_TP0_GPU8_expert0&#45;&gt;L10_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M92234.45,-604.31C92234.45,-552.23 92234.45,-459 92234.45,-459 92234.45,-459 96667.11,-459 96667.11,-459 96667.11,-459 96667.11,-470.83 96667.11,-470.83"/>
<polygon fill="black" stroke="black" points="96663.61,-470.83 96667.11,-480.83 96670.61,-470.83 96663.61,-470.83"/>
</g>
<!-- L10_S1_TP6_GPU14_moe_ar -->
<g id="node1142" class="node">
<title>L10_S1_TP6_GPU14_moe_ar</title>
<ellipse fill="none" stroke="black" cx="97545" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="97545" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="97545" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="97545" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="97545" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP0_GPU8_expert0&#45;&gt;L10_S1_TP6_GPU14_moe_ar -->
<g id="edge3242" class="edge">
<title>L10_S1_TP0_GPU8_expert0&#45;&gt;L10_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M92189.8,-604.31C92189.8,-552.23 92189.8,-459 92189.8,-459 92189.8,-459 97419.38,-459 97419.38,-459 97419.38,-459 97419.38,-465.78 97419.38,-465.78"/>
<polygon fill="black" stroke="black" points="97415.88,-465.78 97419.38,-475.78 97422.88,-465.78 97415.88,-465.78"/>
</g>
<!-- L10_S1_TP7_GPU15_moe_ar -->
<g id="node1152" class="node">
<title>L10_S1_TP7_GPU15_moe_ar</title>
<ellipse fill="none" stroke="black" cx="98232" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="98232" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="98232" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="98232" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="98232" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP0_GPU8_expert0&#45;&gt;L10_S1_TP7_GPU15_moe_ar -->
<g id="edge3278" class="edge">
<title>L10_S1_TP0_GPU8_expert0&#45;&gt;L10_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M92145.15,-604.18C92145.15,-549.57 92145.15,-449 92145.15,-449 92145.15,-449 98206.13,-449 98206.13,-449 98206.13,-449 98206.13,-462.38 98206.13,-462.38"/>
<polygon fill="black" stroke="black" points="98202.63,-462.38 98206.13,-472.38 98209.63,-462.38 98202.63,-462.38"/>
</g>
<!-- L10_S1_TP0_GPU8_expert1&#45;&gt;L10_S1_TP0_GPU8_moe_ar -->
<g id="edge3027" class="edge">
<title>L10_S1_TP0_GPU8_expert1&#45;&gt;L10_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M92986.56,-604.13C92986.56,-580.74 92986.56,-554 92986.56,-554 92986.56,-554 93173.39,-554 93173.39,-554"/>
<polygon fill="black" stroke="black" points="93173.39,-557.5 93183.39,-554 93173.39,-550.5 93173.39,-557.5"/>
</g>
<!-- L10_S1_TP0_GPU8_expert1&#45;&gt;L10_S1_TP1_GPU9_moe_ar -->
<g id="edge3063" class="edge">
<title>L10_S1_TP0_GPU8_expert1&#45;&gt;L10_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M92926.69,-604.26C92926.69,-595.25 92926.69,-588 92926.69,-588 92926.69,-588 93810.53,-588 93810.53,-588 93810.53,-588 93810.53,-552.17 93810.53,-552.17"/>
<polygon fill="black" stroke="black" points="93814.03,-552.17 93810.53,-542.17 93807.03,-552.17 93814.03,-552.17"/>
</g>
<!-- L10_S1_TP0_GPU8_expert1&#45;&gt;L10_S1_TP2_GPU10_moe_ar -->
<g id="edge3099" class="edge">
<title>L10_S1_TP0_GPU8_expert1&#45;&gt;L10_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M92956.62,-604.26C92956.62,-595.25 92956.62,-588 92956.62,-588 92956.62,-588 94509.42,-588 94509.42,-588 94509.42,-588 94509.42,-555.2 94509.42,-555.2"/>
<polygon fill="black" stroke="black" points="94512.92,-555.2 94509.42,-545.2 94505.92,-555.2 94512.92,-555.2"/>
</g>
<!-- L10_S1_TP0_GPU8_expert1&#45;&gt;L10_S1_TP3_GPU11_moe_ar -->
<g id="edge3135" class="edge">
<title>L10_S1_TP0_GPU8_expert1&#45;&gt;L10_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M92809.86,-672.68C92809.86,-687.27 92809.86,-701 92809.86,-701 92809.86,-701 95360.5,-701 95360.5,-701 95360.5,-701 95360.5,-575.52 95360.5,-575.52"/>
<polygon fill="black" stroke="black" points="95364,-575.52 95360.5,-565.52 95357,-575.52 95364,-575.52"/>
</g>
<!-- L10_S1_TP0_GPU8_expert1&#45;&gt;L10_S1_TP4_GPU12_moe_ar -->
<g id="edge3171" class="edge">
<title>L10_S1_TP0_GPU8_expert1&#45;&gt;L10_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M92896.75,-604.42C92896.75,-554.15 92896.75,-466 92896.75,-466 92896.75,-466 95859.77,-466 95859.77,-466 95859.77,-466 95859.77,-492.6 95859.77,-492.6"/>
<polygon fill="black" stroke="black" points="95856.27,-492.6 95859.77,-502.6 95863.27,-492.6 95856.27,-492.6"/>
</g>
<!-- L10_S1_TP0_GPU8_expert1&#45;&gt;L10_S1_TP5_GPU13_moe_ar -->
<g id="edge3207" class="edge">
<title>L10_S1_TP0_GPU8_expert1&#45;&gt;L10_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M92866.81,-604.42C92866.81,-554.15 92866.81,-466 92866.81,-466 92866.81,-466 96631.22,-466 96631.22,-466 96631.22,-466 96631.22,-475.03 96631.22,-475.03"/>
<polygon fill="black" stroke="black" points="96627.72,-475.03 96631.22,-485.03 96634.72,-475.03 96627.72,-475.03"/>
</g>
<!-- L10_S1_TP0_GPU8_expert1&#45;&gt;L10_S1_TP6_GPU14_moe_ar -->
<g id="edge3243" class="edge">
<title>L10_S1_TP0_GPU8_expert1&#45;&gt;L10_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M92836.88,-604.42C92836.88,-554.15 92836.88,-466 92836.88,-466 92836.88,-466 97349.77,-466 97349.77,-466 97349.77,-466 97349.77,-471.16 97349.77,-471.16"/>
<polygon fill="black" stroke="black" points="97346.27,-471.16 97349.77,-481.16 97353.27,-471.16 97346.27,-471.16"/>
</g>
<!-- L10_S1_TP0_GPU8_expert1&#45;&gt;L10_S1_TP7_GPU15_moe_ar -->
<g id="edge3279" class="edge">
<title>L10_S1_TP0_GPU8_expert1&#45;&gt;L10_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M92806.94,-604.36C92806.94,-550.04 92806.94,-450 92806.94,-450 92806.94,-450 98103.27,-450 98103.27,-450 98103.27,-450 98103.27,-465.82 98103.27,-465.82"/>
<polygon fill="black" stroke="black" points="98099.77,-465.82 98103.27,-475.82 98106.77,-465.82 98099.77,-465.82"/>
</g>
<!-- L10_S1_TP0_GPU8_moe_ar&#45;&gt;L10_S1_TP0_GPU8_moe_res -->
<g id="edge3042" class="edge">
<title>L10_S1_TP0_GPU8_moe_ar&#45;&gt;L10_S1_TP0_GPU8_moe_res</title>
<path fill="none" stroke="black" d="M93091.47,-527C92812.14,-527 92457.7,-527 92457.7,-527 92457.7,-527 92457.7,-446.4 92457.7,-446.4"/>
<polygon fill="black" stroke="black" points="92461.2,-446.4 92457.7,-436.4 92454.2,-446.4 92461.2,-446.4"/>
</g>
<!-- L10_S1_TP1_GPU9_expert0 -->
<g id="node1069" class="node">
<title>L10_S1_TP1_GPU9_expert0</title>
<polygon fill="none" stroke="black" points="93483.5,-672.5 93034.5,-672.5 93034.5,-604.5 93483.5,-604.5 93483.5,-672.5"/>
<text text-anchor="middle" x="93259" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="93259" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="93259" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="93259" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L10_S1_TP1_GPU9_expert0&#45;&gt;L10_S1_TP0_GPU8_moe_ar -->
<g id="edge3028" class="edge">
<title>L10_S1_TP1_GPU9_expert0&#45;&gt;L10_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M93154.37,-604.34C93154.37,-604.34 93154.37,-559.3 93154.37,-559.3"/>
<polygon fill="black" stroke="black" points="93157.87,-559.3 93154.37,-549.3 93150.87,-559.3 93157.87,-559.3"/>
</g>
<!-- L10_S1_TP1_GPU9_expert0&#45;&gt;L10_S1_TP1_GPU9_moe_ar -->
<g id="edge3064" class="edge">
<title>L10_S1_TP1_GPU9_expert0&#45;&gt;L10_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M93220.19,-604.26C93220.19,-595.25 93220.19,-588 93220.19,-588 93220.19,-588 93828.03,-588 93828.03,-588 93828.03,-588 93828.03,-556.35 93828.03,-556.35"/>
<polygon fill="black" stroke="black" points="93831.53,-556.35 93828.03,-546.35 93824.53,-556.35 93831.53,-556.35"/>
</g>
<!-- L10_S1_TP1_GPU9_expert0&#45;&gt;L10_S1_TP2_GPU10_moe_ar -->
<g id="edge3100" class="edge">
<title>L10_S1_TP1_GPU9_expert0&#45;&gt;L10_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M93286.02,-604.26C93286.02,-595.25 93286.02,-588 93286.02,-588 93286.02,-588 94556.31,-588 94556.31,-588 94556.31,-588 94556.31,-563.81 94556.31,-563.81"/>
<polygon fill="black" stroke="black" points="94559.81,-563.81 94556.31,-553.81 94552.81,-563.81 94559.81,-563.81"/>
</g>
<!-- L10_S1_TP1_GPU9_expert0&#45;&gt;L10_S1_TP3_GPU11_moe_ar -->
<g id="edge3136" class="edge">
<title>L10_S1_TP1_GPU9_expert0&#45;&gt;L10_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M93351.85,-604.26C93351.85,-595.25 93351.85,-588 93351.85,-588 93351.85,-588 95174.78,-588 95174.78,-588 95174.78,-588 95174.78,-548.88 95174.78,-548.88"/>
<polygon fill="black" stroke="black" points="95178.28,-548.88 95174.78,-538.88 95171.28,-548.88 95178.28,-548.88"/>
</g>
<!-- L10_S1_TP1_GPU9_expert0&#45;&gt;L10_S1_TP4_GPU12_moe_ar -->
<g id="edge3172" class="edge">
<title>L10_S1_TP1_GPU9_expert0&#45;&gt;L10_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M93075.03,-604.42C93075.03,-554.15 93075.03,-466 93075.03,-466 93075.03,-466 95848.15,-466 95848.15,-466 95848.15,-466 95848.15,-497.8 95848.15,-497.8"/>
<polygon fill="black" stroke="black" points="95844.65,-497.8 95848.15,-507.8 95851.65,-497.8 95844.65,-497.8"/>
</g>
<!-- L10_S1_TP1_GPU9_expert0&#45;&gt;L10_S1_TP5_GPU13_moe_ar -->
<g id="edge3208" class="edge">
<title>L10_S1_TP1_GPU9_expert0&#45;&gt;L10_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M93061.52,-604.42C93061.52,-554.15 93061.52,-466 93061.52,-466 93061.52,-466 96595.32,-466 96595.32,-466 96595.32,-466 96595.32,-480.34 96595.32,-480.34"/>
<polygon fill="black" stroke="black" points="96591.82,-480.34 96595.32,-490.34 96598.82,-480.34 96591.82,-480.34"/>
</g>
<!-- L10_S1_TP1_GPU9_expert0&#45;&gt;L10_S1_TP6_GPU14_moe_ar -->
<g id="edge3244" class="edge">
<title>L10_S1_TP1_GPU9_expert0&#45;&gt;L10_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M93048.01,-604.42C93048.01,-554.15 93048.01,-466 93048.01,-466 93048.01,-466 97280.15,-466 97280.15,-466 97280.15,-466 97280.15,-480.98 97280.15,-480.98"/>
<polygon fill="black" stroke="black" points="97276.65,-480.98 97280.15,-490.98 97283.65,-480.98 97276.65,-480.98"/>
</g>
<!-- L10_S1_TP1_GPU9_expert0&#45;&gt;L10_S1_TP7_GPU15_moe_ar -->
<g id="edge3280" class="edge">
<title>L10_S1_TP1_GPU9_expert0&#45;&gt;L10_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M93417.67,-604.39C93417.67,-595.82 93417.67,-589 93417.67,-589 93417.67,-589 97925.98,-589 97925.98,-589 97925.98,-589 97925.98,-549.89 97925.98,-549.89"/>
<polygon fill="black" stroke="black" points="97929.48,-549.89 97925.98,-539.89 97922.48,-549.89 97929.48,-549.89"/>
</g>
<!-- L10_S1_TP1_GPU9_expert1 -->
<g id="node1070" class="node">
<title>L10_S1_TP1_GPU9_expert1</title>
<polygon fill="none" stroke="black" points="93950.5,-672.5 93501.5,-672.5 93501.5,-604.5 93950.5,-604.5 93950.5,-672.5"/>
<text text-anchor="middle" x="93726" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="93726" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="93726" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="93726" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L10_S1_TP1_GPU9_expert1&#45;&gt;L10_S1_TP0_GPU8_moe_ar -->
<g id="edge3029" class="edge">
<title>L10_S1_TP1_GPU9_expert1&#45;&gt;L10_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M93524.77,-604.34C93524.77,-604.34 93524.77,-576.36 93524.77,-576.36"/>
<polygon fill="black" stroke="black" points="93528.27,-576.36 93524.77,-566.36 93521.27,-576.36 93528.27,-576.36"/>
</g>
<!-- L10_S1_TP1_GPU9_expert1&#45;&gt;L10_S1_TP1_GPU9_moe_ar -->
<g id="edge3065" class="edge">
<title>L10_S1_TP1_GPU9_expert1&#45;&gt;L10_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M93845.52,-604.34C93845.52,-604.34 93845.52,-560.09 93845.52,-560.09"/>
<polygon fill="black" stroke="black" points="93849.02,-560.09 93845.52,-550.09 93842.02,-560.09 93849.02,-560.09"/>
</g>
<!-- L10_S1_TP1_GPU9_expert1&#45;&gt;L10_S1_TP2_GPU10_moe_ar -->
<g id="edge3101" class="edge">
<title>L10_S1_TP1_GPU9_expert1&#45;&gt;L10_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M93880.52,-604.26C93880.52,-595.25 93880.52,-588 93880.52,-588 93880.52,-588 94603.19,-588 94603.19,-588 94603.19,-588 94603.19,-569.73 94603.19,-569.73"/>
<polygon fill="black" stroke="black" points="94606.69,-569.73 94603.19,-559.73 94599.69,-569.73 94606.69,-569.73"/>
</g>
<!-- L10_S1_TP1_GPU9_expert1&#45;&gt;L10_S1_TP3_GPU11_moe_ar -->
<g id="edge3137" class="edge">
<title>L10_S1_TP1_GPU9_expert1&#45;&gt;L10_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M93898.01,-604.26C93898.01,-595.25 93898.01,-588 93898.01,-588 93898.01,-588 95200.03,-588 95200.03,-588 95200.03,-588 95200.03,-555.97 95200.03,-555.97"/>
<polygon fill="black" stroke="black" points="95203.53,-555.97 95200.03,-545.97 95196.53,-555.97 95203.53,-555.97"/>
</g>
<!-- L10_S1_TP1_GPU9_expert1&#45;&gt;L10_S1_TP4_GPU12_moe_ar -->
<g id="edge3173" class="edge">
<title>L10_S1_TP1_GPU9_expert1&#45;&gt;L10_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M93915.51,-604.26C93915.51,-595.25 93915.51,-588 93915.51,-588 93915.51,-588 95881.43,-588 95881.43,-588 95881.43,-588 95881.43,-554.82 95881.43,-554.82"/>
<polygon fill="black" stroke="black" points="95884.93,-554.82 95881.43,-544.82 95877.93,-554.82 95884.93,-554.82"/>
</g>
<!-- L10_S1_TP1_GPU9_expert1&#45;&gt;L10_S1_TP5_GPU13_moe_ar -->
<g id="edge3209" class="edge">
<title>L10_S1_TP1_GPU9_expert1&#45;&gt;L10_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M93766.5,-604.2C93766.5,-555.2 93766.5,-471 93766.5,-471 93766.5,-471 96559.43,-471 96559.43,-471 96559.43,-471 96559.43,-488.6 96559.43,-488.6"/>
<polygon fill="black" stroke="black" points="96555.93,-488.6 96559.43,-498.6 96562.93,-488.6 96555.93,-488.6"/>
</g>
<!-- L10_S1_TP1_GPU9_expert1&#45;&gt;L10_S1_TP6_GPU14_moe_ar -->
<g id="edge3245" class="edge">
<title>L10_S1_TP1_GPU9_expert1&#45;&gt;L10_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M93933,-604.39C93933,-595.82 93933,-589 93933,-589 93933,-589 97349.75,-589 97349.75,-589 97349.75,-589 97349.75,-569.52 97349.75,-569.52"/>
<polygon fill="black" stroke="black" points="97353.25,-569.52 97349.75,-559.52 97346.25,-569.52 97353.25,-569.52"/>
</g>
<!-- L10_S1_TP1_GPU9_expert1&#45;&gt;L10_S1_TP7_GPU15_moe_ar -->
<g id="edge3281" class="edge">
<title>L10_S1_TP1_GPU9_expert1&#45;&gt;L10_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M93548.04,-604.39C93548.04,-595.82 93548.04,-589 93548.04,-589 93548.04,-589 97982.86,-589 97982.86,-589 97982.86,-589 97982.86,-562.7 97982.86,-562.7"/>
<polygon fill="black" stroke="black" points="97986.36,-562.7 97982.86,-552.7 97979.36,-562.7 97986.36,-562.7"/>
</g>
<!-- L10_S1_TP2_GPU10_expert0 -->
<g id="node1071" class="node">
<title>L10_S1_TP2_GPU10_expert0</title>
<polygon fill="none" stroke="black" points="94417.5,-672.5 93968.5,-672.5 93968.5,-604.5 94417.5,-604.5 94417.5,-672.5"/>
<text text-anchor="middle" x="94193" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="94193" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="94193" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="94193" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L10_S1_TP2_GPU10_expert0&#45;&gt;L10_S1_TP0_GPU8_moe_ar -->
<g id="edge3030" class="edge">
<title>L10_S1_TP2_GPU10_expert0&#45;&gt;L10_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M94024.62,-603.88C94024.62,-603.31 94024.62,-603 94024.62,-603 94024.62,-603 93571.31,-603 93571.31,-603 93571.31,-603 93571.31,-573.64 93571.31,-573.64"/>
<polygon fill="black" stroke="black" points="93574.81,-573.64 93571.31,-563.64 93567.81,-573.64 93574.81,-573.64"/>
</g>
<!-- L10_S1_TP2_GPU10_expert0&#45;&gt;L10_S1_TP1_GPU9_moe_ar -->
<g id="edge3066" class="edge">
<title>L10_S1_TP2_GPU10_expert0&#45;&gt;L10_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M94080.75,-604.34C94080.75,-604.34 94080.75,-578.55 94080.75,-578.55"/>
<polygon fill="black" stroke="black" points="94084.25,-578.55 94080.75,-568.55 94077.25,-578.55 94084.25,-578.55"/>
</g>
<!-- L10_S1_TP2_GPU10_expert0&#45;&gt;L10_S1_TP2_GPU10_moe_ar -->
<g id="edge3102" class="edge">
<title>L10_S1_TP2_GPU10_expert0&#45;&gt;L10_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M94193,-604.26C94193,-595.25 94193,-588 94193,-588 94193,-588 94650.08,-588 94650.08,-588 94650.08,-588 94650.08,-573.98 94650.08,-573.98"/>
<polygon fill="black" stroke="black" points="94653.58,-573.98 94650.08,-563.98 94646.58,-573.98 94653.58,-573.98"/>
</g>
<!-- L10_S1_TP2_GPU10_expert0&#45;&gt;L10_S1_TP3_GPU11_moe_ar -->
<g id="edge3138" class="edge">
<title>L10_S1_TP2_GPU10_expert0&#45;&gt;L10_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M94249.12,-604.26C94249.12,-595.25 94249.12,-588 94249.12,-588 94249.12,-588 95225.27,-588 95225.27,-588 95225.27,-588 95225.27,-561.04 95225.27,-561.04"/>
<polygon fill="black" stroke="black" points="95228.77,-561.04 95225.27,-551.04 95221.77,-561.04 95228.77,-561.04"/>
</g>
<!-- L10_S1_TP2_GPU10_expert0&#45;&gt;L10_S1_TP4_GPU12_moe_ar -->
<g id="edge3174" class="edge">
<title>L10_S1_TP2_GPU10_expert0&#45;&gt;L10_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M94305.25,-604.26C94305.25,-595.25 94305.25,-588 94305.25,-588 94305.25,-588 95926.33,-588 95926.33,-588 95926.33,-588 95926.33,-563.42 95926.33,-563.42"/>
<polygon fill="black" stroke="black" points="95929.83,-563.42 95926.33,-553.42 95922.83,-563.42 95929.83,-563.42"/>
</g>
<!-- L10_S1_TP2_GPU10_expert0&#45;&gt;L10_S1_TP5_GPU13_moe_ar -->
<g id="edge3210" class="edge">
<title>L10_S1_TP2_GPU10_expert0&#45;&gt;L10_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M94361.38,-604.39C94361.38,-595.82 94361.38,-589 94361.38,-589 94361.38,-589 96548.98,-589 96548.98,-589 96548.98,-589 96548.98,-549.16 96548.98,-549.16"/>
<polygon fill="black" stroke="black" points="96552.48,-549.16 96548.98,-539.16 96545.48,-549.16 96552.48,-549.16"/>
</g>
<!-- L10_S1_TP2_GPU10_expert0&#45;&gt;L10_S1_TP6_GPU14_moe_ar -->
<g id="edge3246" class="edge">
<title>L10_S1_TP2_GPU10_expert0&#45;&gt;L10_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M94305.25,-672.64C94305.25,-682.67 94305.25,-691 94305.25,-691 94305.25,-691 97234.5,-691 97234.5,-691 97234.5,-691 97234.5,-548.35 97234.5,-548.35"/>
<polygon fill="black" stroke="black" points="97238,-548.35 97234.5,-538.35 97231,-548.35 97238,-548.35"/>
</g>
<!-- L10_S1_TP2_GPU10_expert0&#45;&gt;L10_S1_TP7_GPU15_moe_ar -->
<g id="edge3282" class="edge">
<title>L10_S1_TP2_GPU10_expert0&#45;&gt;L10_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M94193,-672.64C94193,-682.67 94193,-691 94193,-691 94193,-691 98167.9,-691 98167.9,-691 98167.9,-691 98167.9,-577.93 98167.9,-577.93"/>
<polygon fill="black" stroke="black" points="98171.4,-577.93 98167.9,-567.93 98164.4,-577.93 98171.4,-577.93"/>
</g>
<!-- L10_S1_TP2_GPU10_expert1 -->
<g id="node1072" class="node">
<title>L10_S1_TP2_GPU10_expert1</title>
<polygon fill="none" stroke="black" points="94884.5,-672.5 94435.5,-672.5 94435.5,-604.5 94884.5,-604.5 94884.5,-672.5"/>
<text text-anchor="middle" x="94660" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="94660" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="94660" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="94660" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L10_S1_TP2_GPU10_expert1&#45;&gt;L10_S1_TP0_GPU8_moe_ar -->
<g id="edge3031" class="edge">
<title>L10_S1_TP2_GPU10_expert1&#45;&gt;L10_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M94450.49,-604.39C94450.49,-595.82 94450.49,-589 94450.49,-589 94450.49,-589 93594.58,-589 93594.58,-589 93594.58,-589 93594.58,-571.89 93594.58,-571.89"/>
<polygon fill="black" stroke="black" points="93598.08,-571.89 93594.58,-561.89 93591.08,-571.89 93598.08,-571.89"/>
</g>
<!-- L10_S1_TP2_GPU10_expert1&#45;&gt;L10_S1_TP1_GPU9_moe_ar -->
<g id="edge3067" class="edge">
<title>L10_S1_TP2_GPU10_expert1&#45;&gt;L10_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M94439.98,-604.34C94439.98,-604.34 94439.98,-538.63 94439.98,-538.63"/>
<polygon fill="black" stroke="black" points="94443.48,-538.63 94439.98,-528.63 94436.48,-538.63 94443.48,-538.63"/>
</g>
<!-- L10_S1_TP2_GPU10_expert1&#45;&gt;L10_S1_TP2_GPU10_moe_ar -->
<g id="edge3103" class="edge">
<title>L10_S1_TP2_GPU10_expert1&#45;&gt;L10_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M94696.96,-604.34C94696.96,-604.34 94696.96,-576.36 94696.96,-576.36"/>
<polygon fill="black" stroke="black" points="94700.46,-576.36 94696.96,-566.36 94693.46,-576.36 94700.46,-576.36"/>
</g>
<!-- L10_S1_TP2_GPU10_expert1&#45;&gt;L10_S1_TP3_GPU11_moe_ar -->
<g id="edge3139" class="edge">
<title>L10_S1_TP2_GPU10_expert1&#45;&gt;L10_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M94743.85,-604.26C94743.85,-595.25 94743.85,-588 94743.85,-588 94743.85,-588 95250.52,-588 95250.52,-588 95250.52,-588 95250.52,-565 95250.52,-565"/>
<polygon fill="black" stroke="black" points="95254.02,-565 95250.52,-555 95247.02,-565 95254.02,-565"/>
</g>
<!-- L10_S1_TP2_GPU10_expert1&#45;&gt;L10_S1_TP4_GPU12_moe_ar -->
<g id="edge3175" class="edge">
<title>L10_S1_TP2_GPU10_expert1&#45;&gt;L10_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M94790.73,-604.26C94790.73,-595.25 94790.73,-588 94790.73,-588 94790.73,-588 95971.23,-588 95971.23,-588 95971.23,-588 95971.23,-569.34 95971.23,-569.34"/>
<polygon fill="black" stroke="black" points="95974.73,-569.34 95971.23,-559.34 95967.73,-569.34 95974.73,-569.34"/>
</g>
<!-- L10_S1_TP2_GPU10_expert1&#45;&gt;L10_S1_TP5_GPU13_moe_ar -->
<g id="edge3211" class="edge">
<title>L10_S1_TP2_GPU10_expert1&#45;&gt;L10_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M94837.62,-604.39C94837.62,-595.82 94837.62,-589 94837.62,-589 94837.62,-589 96574.42,-589 96574.42,-589 96574.42,-589 96574.42,-555.95 96574.42,-555.95"/>
<polygon fill="black" stroke="black" points="96577.92,-555.95 96574.42,-545.95 96570.92,-555.95 96577.92,-555.95"/>
</g>
<!-- L10_S1_TP2_GPU10_expert1&#45;&gt;L10_S1_TP6_GPU14_moe_ar -->
<g id="edge3247" class="edge">
<title>L10_S1_TP2_GPU10_expert1&#45;&gt;L10_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M94842.74,-672.81C94842.74,-677.64 94842.74,-681 94842.74,-681 94842.74,-681 97231.5,-681 97231.5,-681 97231.5,-681 97231.5,-547.3 97231.5,-547.3"/>
<polygon fill="black" stroke="black" points="97235,-547.3 97231.5,-537.3 97228,-547.3 97235,-547.3"/>
</g>
<!-- L10_S1_TP2_GPU10_expert1&#45;&gt;L10_S1_TP7_GPU15_moe_ar -->
<g id="edge3283" class="edge">
<title>L10_S1_TP2_GPU10_expert1&#45;&gt;L10_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M94800.98,-672.64C94800.98,-682.67 94800.98,-691 94800.98,-691 94800.98,-691 98164.3,-691 98164.3,-691 98164.3,-691 98164.3,-577.93 98164.3,-577.93"/>
<polygon fill="black" stroke="black" points="98167.8,-577.93 98164.3,-567.93 98160.8,-577.93 98167.8,-577.93"/>
</g>
<!-- L10_S1_TP3_GPU11_expert0 -->
<g id="node1073" class="node">
<title>L10_S1_TP3_GPU11_expert0</title>
<polygon fill="none" stroke="black" points="95351.5,-672.5 94902.5,-672.5 94902.5,-604.5 95351.5,-604.5 95351.5,-672.5"/>
<text text-anchor="middle" x="95127" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="95127" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="95127" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="95127" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L10_S1_TP3_GPU11_expert0&#45;&gt;L10_S1_TP0_GPU8_moe_ar -->
<g id="edge3032" class="edge">
<title>L10_S1_TP3_GPU11_expert0&#45;&gt;L10_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M94931.12,-604.39C94931.12,-595.82 94931.12,-589 94931.12,-589 94931.12,-589 93617.85,-589 93617.85,-589 93617.85,-589 93617.85,-569.52 93617.85,-569.52"/>
<polygon fill="black" stroke="black" points="93621.35,-569.52 93617.85,-559.52 93614.35,-569.52 93621.35,-569.52"/>
</g>
<!-- L10_S1_TP3_GPU11_expert0&#45;&gt;L10_S1_TP1_GPU9_moe_ar -->
<g id="edge3068" class="edge">
<title>L10_S1_TP3_GPU11_expert0&#45;&gt;L10_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M94959.74,-604.39C94959.74,-595.82 94959.74,-589 94959.74,-589 94959.74,-589 94431,-589 94431,-589 94431,-589 94431,-543.97 94431,-543.97"/>
<polygon fill="black" stroke="black" points="94434.5,-543.97 94431,-533.97 94427.5,-543.97 94434.5,-543.97"/>
</g>
<!-- L10_S1_TP3_GPU11_expert0&#45;&gt;L10_S1_TP2_GPU10_moe_ar -->
<g id="edge3104" class="edge">
<title>L10_S1_TP3_GPU11_expert0&#45;&gt;L10_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M94988.36,-604.34C94988.36,-604.34 94988.36,-569.91 94988.36,-569.91"/>
<polygon fill="black" stroke="black" points="94991.86,-569.91 94988.36,-559.91 94984.86,-569.91 94991.86,-569.91"/>
</g>
<!-- L10_S1_TP3_GPU11_expert0&#45;&gt;L10_S1_TP3_GPU11_moe_ar -->
<g id="edge3140" class="edge">
<title>L10_S1_TP3_GPU11_expert0&#45;&gt;L10_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M95275.76,-604.34C95275.76,-604.34 95275.76,-568.22 95275.76,-568.22"/>
<polygon fill="black" stroke="black" points="95279.26,-568.22 95275.76,-558.22 95272.26,-568.22 95279.26,-568.22"/>
</g>
<!-- L10_S1_TP3_GPU11_expert0&#45;&gt;L10_S1_TP4_GPU12_moe_ar -->
<g id="edge3176" class="edge">
<title>L10_S1_TP3_GPU11_expert0&#45;&gt;L10_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M95301.01,-604.39C95301.01,-595.82 95301.01,-589 95301.01,-589 95301.01,-589 96061.02,-589 96061.02,-589 96061.02,-589 96061.02,-576.16 96061.02,-576.16"/>
<polygon fill="black" stroke="black" points="96064.52,-576.16 96061.02,-566.16 96057.52,-576.16 96064.52,-576.16"/>
</g>
<!-- L10_S1_TP3_GPU11_expert0&#45;&gt;L10_S1_TP5_GPU13_moe_ar -->
<g id="edge3212" class="edge">
<title>L10_S1_TP3_GPU11_expert0&#45;&gt;L10_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M95326.25,-604.39C95326.25,-595.82 95326.25,-589 95326.25,-589 95326.25,-589 96599.86,-589 96599.86,-589 96599.86,-589 96599.86,-561.1 96599.86,-561.1"/>
<polygon fill="black" stroke="black" points="96603.36,-561.1 96599.86,-551.1 96596.36,-561.1 96603.36,-561.1"/>
</g>
<!-- L10_S1_TP3_GPU11_expert0&#45;&gt;L10_S1_TP6_GPU14_moe_ar -->
<g id="edge3248" class="edge">
<title>L10_S1_TP3_GPU11_expert0&#45;&gt;L10_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M95201.83,-672.81C95201.83,-677.64 95201.83,-681 95201.83,-681 95201.83,-681 97228.5,-681 97228.5,-681 97228.5,-681 97228.5,-546.11 97228.5,-546.11"/>
<polygon fill="black" stroke="black" points="97232,-546.11 97228.5,-536.11 97225,-546.11 97232,-546.11"/>
</g>
<!-- L10_S1_TP3_GPU11_expert0&#45;&gt;L10_S1_TP7_GPU15_moe_ar -->
<g id="edge3284" class="edge">
<title>L10_S1_TP3_GPU11_expert0&#45;&gt;L10_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M95140.5,-604.36C95140.5,-550.04 95140.5,-450 95140.5,-450 95140.5,-450 98000.4,-450 98000.4,-450 98000.4,-450 98000.4,-475.62 98000.4,-475.62"/>
<polygon fill="black" stroke="black" points="97996.9,-475.62 98000.4,-485.62 98003.9,-475.62 97996.9,-475.62"/>
</g>
<!-- L10_S1_TP3_GPU11_expert1 -->
<g id="node1074" class="node">
<title>L10_S1_TP3_GPU11_expert1</title>
<polygon fill="none" stroke="black" points="95818.5,-672.5 95369.5,-672.5 95369.5,-604.5 95818.5,-604.5 95818.5,-672.5"/>
<text text-anchor="middle" x="95594" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="95594" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="95594" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="95594" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L10_S1_TP3_GPU11_expert1&#45;&gt;L10_S1_TP0_GPU8_moe_ar -->
<g id="edge3033" class="edge">
<title>L10_S1_TP3_GPU11_expert1&#45;&gt;L10_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M95419.38,-604.39C95419.38,-595.82 95419.38,-589 95419.38,-589 95419.38,-589 93641.12,-589 93641.12,-589 93641.12,-589 93641.12,-567.12 93641.12,-567.12"/>
<polygon fill="black" stroke="black" points="93644.62,-567.12 93641.12,-557.12 93637.62,-567.12 93644.62,-567.12"/>
</g>
<!-- L10_S1_TP3_GPU11_expert1&#45;&gt;L10_S1_TP1_GPU9_moe_ar -->
<g id="edge3069" class="edge">
<title>L10_S1_TP3_GPU11_expert1&#45;&gt;L10_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M95469.27,-604.39C95469.27,-595.82 95469.27,-589 95469.27,-589 95469.27,-589 94433.25,-589 94433.25,-589 94433.25,-589 94433.25,-543 94433.25,-543"/>
<polygon fill="black" stroke="black" points="94436.75,-543 94433.25,-533 94429.75,-543 94436.75,-543"/>
</g>
<!-- L10_S1_TP3_GPU11_expert1&#45;&gt;L10_S1_TP2_GPU10_moe_ar -->
<g id="edge3105" class="edge">
<title>L10_S1_TP3_GPU11_expert1&#45;&gt;L10_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M95519.15,-604.39C95519.15,-595.82 95519.15,-589 95519.15,-589 95519.15,-589 95016.98,-589 95016.98,-589 95016.98,-589 95016.98,-566.72 95016.98,-566.72"/>
<polygon fill="black" stroke="black" points="95020.48,-566.72 95016.98,-556.72 95013.48,-566.72 95020.48,-566.72"/>
</g>
<!-- L10_S1_TP3_GPU11_expert1&#45;&gt;L10_S1_TP3_GPU11_moe_ar -->
<g id="edge3141" class="edge">
<title>L10_S1_TP3_GPU11_expert1&#45;&gt;L10_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M95569.04,-604.34C95569.04,-604.34 95569.04,-577.23 95569.04,-577.23"/>
<polygon fill="black" stroke="black" points="95572.54,-577.23 95569.04,-567.23 95565.54,-577.23 95572.54,-577.23"/>
</g>
<!-- L10_S1_TP3_GPU11_expert1&#45;&gt;L10_S1_TP4_GPU12_moe_ar -->
<g id="edge3177" class="edge">
<title>L10_S1_TP3_GPU11_expert1&#45;&gt;L10_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M95818.7,-627C95825.52,-627 95829.43,-627 95829.43,-627 95829.43,-627 95829.43,-504 95829.43,-504 95829.43,-504 95846.52,-504 95846.52,-504"/>
<polygon fill="black" stroke="black" points="95846.52,-507.5 95856.52,-504 95846.52,-500.5 95846.52,-507.5"/>
</g>
<!-- L10_S1_TP3_GPU11_expert1&#45;&gt;L10_S1_TP5_GPU13_moe_ar -->
<g id="edge3213" class="edge">
<title>L10_S1_TP3_GPU11_expert1&#45;&gt;L10_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M95618.92,-604.39C95618.92,-595.82 95618.92,-589 95618.92,-589 95618.92,-589 96625.3,-589 96625.3,-589 96625.3,-589 96625.3,-565.11 96625.3,-565.11"/>
<polygon fill="black" stroke="black" points="96628.8,-565.11 96625.3,-555.11 96621.8,-565.11 96628.8,-565.11"/>
</g>
<!-- L10_S1_TP3_GPU11_expert1&#45;&gt;L10_S1_TP6_GPU14_moe_ar -->
<g id="edge3249" class="edge">
<title>L10_S1_TP3_GPU11_expert1&#45;&gt;L10_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M95706.25,-672.81C95706.25,-677.64 95706.25,-681 95706.25,-681 95706.25,-681 97225.5,-681 97225.5,-681 97225.5,-681 97225.5,-544.67 97225.5,-544.67"/>
<polygon fill="black" stroke="black" points="97229,-544.67 97225.5,-534.67 97222,-544.67 97229,-544.67"/>
</g>
<!-- L10_S1_TP3_GPU11_expert1&#45;&gt;L10_S1_TP7_GPU15_moe_ar -->
<g id="edge3285" class="edge">
<title>L10_S1_TP3_GPU11_expert1&#45;&gt;L10_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M95594,-672.64C95594,-682.67 95594,-691 95594,-691 95594,-691 98160.7,-691 98160.7,-691 98160.7,-691 98160.7,-577.48 98160.7,-577.48"/>
<polygon fill="black" stroke="black" points="98164.2,-577.48 98160.7,-567.48 98157.2,-577.48 98164.2,-577.48"/>
</g>
<!-- L10_S1_TP4_GPU12_expert0 -->
<g id="node1075" class="node">
<title>L10_S1_TP4_GPU12_expert0</title>
<polygon fill="none" stroke="black" points="96285.5,-672.5 95836.5,-672.5 95836.5,-604.5 96285.5,-604.5 96285.5,-672.5"/>
<text text-anchor="middle" x="96061" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="96061" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="96061" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="96061" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L10_S1_TP4_GPU12_expert0&#45;&gt;L10_S1_TP0_GPU8_moe_ar -->
<g id="edge3034" class="edge">
<title>L10_S1_TP4_GPU12_expert0&#45;&gt;L10_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M96061.36,-672.64C96061.36,-686.36 96061.36,-699 96061.36,-699 96061.36,-699 93495.5,-699 93495.5,-699 93495.5,-699 93495.5,-577.8 93495.5,-577.8"/>
<polygon fill="black" stroke="black" points="93499,-577.8 93495.5,-567.8 93492,-577.8 93499,-577.8"/>
</g>
<!-- L10_S1_TP4_GPU12_expert0&#45;&gt;L10_S1_TP1_GPU9_moe_ar -->
<g id="edge3070" class="edge">
<title>L10_S1_TP4_GPU12_expert0&#45;&gt;L10_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M95949.29,-672.77C95949.29,-677.07 95949.29,-680 95949.29,-680 95949.29,-680 94426.5,-680 94426.5,-680 94426.5,-680 94426.5,-546.01 94426.5,-546.01"/>
<polygon fill="black" stroke="black" points="94430,-546.01 94426.5,-536.01 94423,-546.01 94430,-546.01"/>
</g>
<!-- L10_S1_TP4_GPU12_expert0&#45;&gt;L10_S1_TP2_GPU10_moe_ar -->
<g id="edge3106" class="edge">
<title>L10_S1_TP4_GPU12_expert0&#45;&gt;L10_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M96016.12,-604.26C96016.12,-595.25 96016.12,-588 96016.12,-588 96016.12,-588 95045.6,-588 95045.6,-588 95045.6,-588 95045.6,-562.62 95045.6,-562.62"/>
<polygon fill="black" stroke="black" points="95049.1,-562.62 95045.6,-552.62 95042.1,-562.62 95049.1,-562.62"/>
</g>
<!-- L10_S1_TP4_GPU12_expert0&#45;&gt;L10_S1_TP3_GPU11_moe_ar -->
<g id="edge3142" class="edge">
<title>L10_S1_TP4_GPU12_expert0&#45;&gt;L10_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M95836.24,-649C95830.39,-649 95827.07,-649 95827.07,-649 95827.07,-649 95827.07,-536 95827.07,-536 95827.07,-536 95810.44,-536 95810.44,-536"/>
<polygon fill="black" stroke="black" points="95810.44,-532.5 95800.44,-536 95810.44,-539.5 95810.44,-532.5"/>
</g>
<!-- L10_S1_TP4_GPU12_expert0&#45;&gt;L10_S1_TP4_GPU12_moe_ar -->
<g id="edge3178" class="edge">
<title>L10_S1_TP4_GPU12_expert0&#45;&gt;L10_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M96105.92,-604.34C96105.92,-604.34 96105.92,-577.67 96105.92,-577.67"/>
<polygon fill="black" stroke="black" points="96109.42,-577.67 96105.92,-567.67 96102.42,-577.67 96109.42,-577.67"/>
</g>
<!-- L10_S1_TP4_GPU12_expert0&#45;&gt;L10_S1_TP5_GPU13_moe_ar -->
<g id="edge3214" class="edge">
<title>L10_S1_TP4_GPU12_expert0&#45;&gt;L10_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M96150.81,-603.88C96150.81,-603.31 96150.81,-603 96150.81,-603 96150.81,-603 96650.74,-603 96650.74,-603 96650.74,-603 96650.74,-568.32 96650.74,-568.32"/>
<polygon fill="black" stroke="black" points="96654.24,-568.32 96650.74,-558.32 96647.24,-568.32 96654.24,-568.32"/>
</g>
<!-- L10_S1_TP4_GPU12_expert0&#45;&gt;L10_S1_TP6_GPU14_moe_ar -->
<g id="edge3250" class="edge">
<title>L10_S1_TP4_GPU12_expert0&#45;&gt;L10_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M96195.71,-603.88C96195.71,-603.31 96195.71,-603 96195.71,-603 96195.71,-603 97222.5,-603 97222.5,-603 97222.5,-603 97222.5,-543.32 97222.5,-543.32"/>
<polygon fill="black" stroke="black" points="97226,-543.32 97222.5,-533.32 97219,-543.32 97226,-543.32"/>
</g>
<!-- L10_S1_TP4_GPU12_expert0&#45;&gt;L10_S1_TP7_GPU15_moe_ar -->
<g id="edge3286" class="edge">
<title>L10_S1_TP4_GPU12_expert0&#45;&gt;L10_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M96240.6,-603.88C96240.6,-603.31 96240.6,-603 96240.6,-603 96240.6,-603 98011.3,-603 98011.3,-603 98011.3,-603 98011.3,-566.88 98011.3,-566.88"/>
<polygon fill="black" stroke="black" points="98014.8,-566.88 98011.3,-556.88 98007.8,-566.88 98014.8,-566.88"/>
</g>
<!-- L10_S1_TP4_GPU12_expert1 -->
<g id="node1076" class="node">
<title>L10_S1_TP4_GPU12_expert1</title>
<polygon fill="none" stroke="black" points="96752.5,-672.5 96303.5,-672.5 96303.5,-604.5 96752.5,-604.5 96752.5,-672.5"/>
<text text-anchor="middle" x="96528" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="96528" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="96528" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="96528" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L10_S1_TP4_GPU12_expert1&#45;&gt;L10_S1_TP0_GPU8_moe_ar -->
<g id="edge3035" class="edge">
<title>L10_S1_TP4_GPU12_expert1&#45;&gt;L10_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M96514.5,-604.2C96514.5,-554.67 96514.5,-469 96514.5,-469 96514.5,-469 93703.97,-469 93703.97,-469 93703.97,-469 93703.97,-484.11 93703.97,-484.11"/>
<polygon fill="black" stroke="black" points="93700.47,-484.11 93703.97,-494.11 93707.47,-484.11 93700.47,-484.11"/>
</g>
<!-- L10_S1_TP4_GPU12_expert1&#45;&gt;L10_S1_TP1_GPU9_moe_ar -->
<g id="edge3071" class="edge">
<title>L10_S1_TP4_GPU12_expert1&#45;&gt;L10_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M96453.17,-672.77C96453.17,-677.07 96453.17,-680 96453.17,-680 96453.17,-680 94424.25,-680 94424.25,-680 94424.25,-680 94424.25,-546.89 94424.25,-546.89"/>
<polygon fill="black" stroke="black" points="94427.75,-546.89 94424.25,-536.89 94420.75,-546.89 94427.75,-546.89"/>
</g>
<!-- L10_S1_TP4_GPU12_expert1&#45;&gt;L10_S1_TP2_GPU10_moe_ar -->
<g id="edge3107" class="edge">
<title>L10_S1_TP4_GPU12_expert1&#45;&gt;L10_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M96328.75,-604.26C96328.75,-595.25 96328.75,-588 96328.75,-588 96328.75,-588 95074.22,-588 95074.22,-588 95074.22,-588 95074.22,-557.52 95074.22,-557.52"/>
<polygon fill="black" stroke="black" points="95077.72,-557.52 95074.22,-547.52 95070.72,-557.52 95077.72,-557.52"/>
</g>
<!-- L10_S1_TP4_GPU12_expert1&#45;&gt;L10_S1_TP3_GPU11_moe_ar -->
<g id="edge3143" class="edge">
<title>L10_S1_TP4_GPU12_expert1&#45;&gt;L10_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M96353.99,-604.39C96353.99,-595.82 96353.99,-589 96353.99,-589 96353.99,-589 95668.81,-589 95668.81,-589 95668.81,-589 95668.81,-570.71 95668.81,-570.71"/>
<polygon fill="black" stroke="black" points="95672.31,-570.71 95668.81,-560.71 95665.31,-570.71 95672.31,-570.71"/>
</g>
<!-- L10_S1_TP4_GPU12_expert1&#45;&gt;L10_S1_TP4_GPU12_moe_ar -->
<g id="edge3179" class="edge">
<title>L10_S1_TP4_GPU12_expert1&#45;&gt;L10_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M96379.24,-604.34C96379.24,-604.34 96379.24,-568.22 96379.24,-568.22"/>
<polygon fill="black" stroke="black" points="96382.74,-568.22 96379.24,-558.22 96375.74,-568.22 96382.74,-568.22"/>
</g>
<!-- L10_S1_TP4_GPU12_expert1&#45;&gt;L10_S1_TP5_GPU13_moe_ar -->
<g id="edge3215" class="edge">
<title>L10_S1_TP4_GPU12_expert1&#45;&gt;L10_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M96676.18,-604.34C96676.18,-604.34 96676.18,-571.18 96676.18,-571.18"/>
<polygon fill="black" stroke="black" points="96679.68,-571.18 96676.18,-561.18 96672.68,-571.18 96679.68,-571.18"/>
</g>
<!-- L10_S1_TP4_GPU12_expert1&#45;&gt;L10_S1_TP6_GPU14_moe_ar -->
<g id="edge3251" class="edge">
<title>L10_S1_TP4_GPU12_expert1&#45;&gt;L10_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M96701.62,-603.88C96701.62,-603.31 96701.62,-603 96701.62,-603 96701.62,-603 97213.53,-603 97213.53,-603 97213.53,-603 97213.53,-536.9 97213.53,-536.9"/>
<polygon fill="black" stroke="black" points="97217.03,-536.9 97213.53,-526.9 97210.03,-536.9 97217.03,-536.9"/>
</g>
<!-- L10_S1_TP4_GPU12_expert1&#45;&gt;L10_S1_TP7_GPU15_moe_ar -->
<g id="edge3287" class="edge">
<title>L10_S1_TP4_GPU12_expert1&#45;&gt;L10_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M96727.06,-603.88C96727.06,-603.31 96727.06,-603 96727.06,-603 96727.06,-603 98039.74,-603 98039.74,-603 98039.74,-603 98039.74,-569.77 98039.74,-569.77"/>
<polygon fill="black" stroke="black" points="98043.24,-569.77 98039.74,-559.77 98036.24,-569.77 98043.24,-569.77"/>
</g>
<!-- L10_S1_TP5_GPU13_expert0 -->
<g id="node1077" class="node">
<title>L10_S1_TP5_GPU13_expert0</title>
<polygon fill="none" stroke="black" points="97219.5,-672.5 96770.5,-672.5 96770.5,-604.5 97219.5,-604.5 97219.5,-672.5"/>
<text text-anchor="middle" x="96995" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="96995" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="96995" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="96995" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L10_S1_TP5_GPU13_expert0&#45;&gt;L10_S1_TP0_GPU8_moe_ar -->
<g id="edge3036" class="edge">
<title>L10_S1_TP5_GPU13_expert0&#45;&gt;L10_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M96854.69,-672.53C96854.69,-688.89 96854.69,-705 96854.69,-705 96854.69,-705 93489.5,-705 93489.5,-705 93489.5,-705 93489.5,-577.95 93489.5,-577.95"/>
<polygon fill="black" stroke="black" points="93493,-577.95 93489.5,-567.95 93486,-577.95 93493,-577.95"/>
</g>
<!-- L10_S1_TP5_GPU13_expert0&#45;&gt;L10_S1_TP1_GPU9_moe_ar -->
<g id="edge3072" class="edge">
<title>L10_S1_TP5_GPU13_expert0&#45;&gt;L10_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M96812.59,-672.77C96812.59,-677.07 96812.59,-680 96812.59,-680 96812.59,-680 94422,-680 94422,-680 94422,-680 94422,-547.8 94422,-547.8"/>
<polygon fill="black" stroke="black" points="94425.5,-547.8 94422,-537.8 94418.5,-547.8 94425.5,-547.8"/>
</g>
<!-- L10_S1_TP5_GPU13_expert0&#45;&gt;L10_S1_TP2_GPU10_moe_ar -->
<g id="edge3108" class="edge">
<title>L10_S1_TP5_GPU13_expert0&#45;&gt;L10_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M96812.7,-604.26C96812.7,-595.25 96812.7,-588 96812.7,-588 96812.7,-588 95102.84,-588 95102.84,-588 95102.84,-588 95102.84,-549.96 95102.84,-549.96"/>
<polygon fill="black" stroke="black" points="95106.34,-549.96 95102.84,-539.96 95099.34,-549.96 95106.34,-549.96"/>
</g>
<!-- L10_S1_TP5_GPU13_expert0&#45;&gt;L10_S1_TP3_GPU11_moe_ar -->
<g id="edge3144" class="edge">
<title>L10_S1_TP5_GPU13_expert0&#45;&gt;L10_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M96854.89,-604.26C96854.89,-595.25 96854.89,-588 96854.89,-588 96854.89,-588 95718.69,-588 95718.69,-588 95718.69,-588 95718.69,-565 95718.69,-565"/>
<polygon fill="black" stroke="black" points="95722.19,-565 95718.69,-555 95715.19,-565 95722.19,-565"/>
</g>
<!-- L10_S1_TP5_GPU13_expert0&#45;&gt;L10_S1_TP4_GPU12_moe_ar -->
<g id="edge3180" class="edge">
<title>L10_S1_TP5_GPU13_expert0&#45;&gt;L10_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M96897.09,-604.26C96897.09,-595.25 96897.09,-588 96897.09,-588 96897.09,-588 96404.48,-588 96404.48,-588 96404.48,-588 96404.48,-565 96404.48,-565"/>
<polygon fill="black" stroke="black" points="96407.98,-565 96404.48,-555 96400.98,-565 96407.98,-565"/>
</g>
<!-- L10_S1_TP5_GPU13_expert0&#45;&gt;L10_S1_TP5_GPU13_moe_ar -->
<g id="edge3216" class="edge">
<title>L10_S1_TP5_GPU13_expert0&#45;&gt;L10_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M96939.28,-604.34C96939.28,-604.34 96939.28,-577.23 96939.28,-577.23"/>
<polygon fill="black" stroke="black" points="96942.78,-577.23 96939.28,-567.23 96935.78,-577.23 96942.78,-577.23"/>
</g>
<!-- L10_S1_TP5_GPU13_expert0&#45;&gt;L10_S1_TP6_GPU14_moe_ar -->
<g id="edge3252" class="edge">
<title>L10_S1_TP5_GPU13_expert0&#45;&gt;L10_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M97216.51,-604.34C97216.51,-604.34 97216.51,-539.61 97216.51,-539.61"/>
<polygon fill="black" stroke="black" points="97220.01,-539.61 97216.51,-529.61 97213.01,-539.61 97220.01,-539.61"/>
</g>
<!-- L10_S1_TP5_GPU13_expert0&#45;&gt;L10_S1_TP7_GPU15_moe_ar -->
<g id="edge3288" class="edge">
<title>L10_S1_TP5_GPU13_expert0&#45;&gt;L10_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M97201.5,-603.88C97201.5,-603.31 97201.5,-603 97201.5,-603 97201.5,-603 98068.18,-603 98068.18,-603 98068.18,-603 98068.18,-572.68 98068.18,-572.68"/>
<polygon fill="black" stroke="black" points="98071.68,-572.68 98068.18,-562.68 98064.68,-572.68 98071.68,-572.68"/>
</g>
<!-- L10_S1_TP5_GPU13_expert1 -->
<g id="node1078" class="node">
<title>L10_S1_TP5_GPU13_expert1</title>
<polygon fill="none" stroke="black" points="97686.5,-672.5 97237.5,-672.5 97237.5,-604.5 97686.5,-604.5 97686.5,-672.5"/>
<text text-anchor="middle" x="97462" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="97462" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="97462" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="97462" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L10_S1_TP5_GPU13_expert1&#45;&gt;L10_S1_TP0_GPU8_moe_ar -->
<g id="edge3037" class="edge">
<title>L10_S1_TP5_GPU13_expert1&#45;&gt;L10_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M97293.62,-604.39C97293.62,-595.82 97293.62,-589 97293.62,-589 97293.62,-589 93664.38,-589 93664.38,-589 93664.38,-589 93664.38,-563.9 93664.38,-563.9"/>
<polygon fill="black" stroke="black" points="93667.88,-563.9 93664.38,-553.9 93660.88,-563.9 93667.88,-563.9"/>
</g>
<!-- L10_S1_TP5_GPU13_expert1&#45;&gt;L10_S1_TP1_GPU9_moe_ar -->
<g id="edge3073" class="edge">
<title>L10_S1_TP5_GPU13_expert1&#45;&gt;L10_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M97462,-672.81C97462,-677.64 97462,-681 97462,-681 97462,-681 94419.75,-681 94419.75,-681 94419.75,-681 94419.75,-548.84 94419.75,-548.84"/>
<polygon fill="black" stroke="black" points="94423.25,-548.84 94419.75,-538.84 94416.25,-548.84 94423.25,-548.84"/>
</g>
<!-- L10_S1_TP5_GPU13_expert1&#45;&gt;L10_S1_TP2_GPU10_moe_ar -->
<g id="edge3109" class="edge">
<title>L10_S1_TP5_GPU13_expert1&#45;&gt;L10_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M97349.75,-672.81C97349.75,-677.64 97349.75,-681 97349.75,-681 97349.75,-681 94893.5,-681 94893.5,-681 94893.5,-681 94893.5,-576.86 94893.5,-576.86"/>
<polygon fill="black" stroke="black" points="94897,-576.86 94893.5,-566.86 94890,-576.86 94897,-576.86"/>
</g>
<!-- L10_S1_TP5_GPU13_expert1&#45;&gt;L10_S1_TP3_GPU11_moe_ar -->
<g id="edge3145" class="edge">
<title>L10_S1_TP5_GPU13_expert1&#45;&gt;L10_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M97405.88,-604.26C97405.88,-595.25 97405.88,-588 97405.88,-588 97405.88,-588 95768.58,-588 95768.58,-588 95768.58,-588 95768.58,-555.97 95768.58,-555.97"/>
<polygon fill="black" stroke="black" points="95772.08,-555.97 95768.58,-545.97 95765.08,-555.97 95772.08,-555.97"/>
</g>
<!-- L10_S1_TP5_GPU13_expert1&#45;&gt;L10_S1_TP4_GPU12_moe_ar -->
<g id="edge3181" class="edge">
<title>L10_S1_TP5_GPU13_expert1&#45;&gt;L10_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M97462,-604.26C97462,-595.25 97462,-588 97462,-588 97462,-588 96429.73,-588 96429.73,-588 96429.73,-588 96429.73,-561.04 96429.73,-561.04"/>
<polygon fill="black" stroke="black" points="96433.23,-561.04 96429.73,-551.04 96426.23,-561.04 96433.23,-561.04"/>
</g>
<!-- L10_S1_TP5_GPU13_expert1&#45;&gt;L10_S1_TP5_GPU13_moe_ar -->
<g id="edge3217" class="edge">
<title>L10_S1_TP5_GPU13_expert1&#45;&gt;L10_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M97518.12,-604.26C97518.12,-595.25 97518.12,-588 97518.12,-588 97518.12,-588 96981.48,-588 96981.48,-588 96981.48,-588 96981.48,-575.12 96981.48,-575.12"/>
<polygon fill="black" stroke="black" points="96984.98,-575.12 96981.48,-565.12 96977.98,-575.12 96984.98,-575.12"/>
</g>
<!-- L10_S1_TP5_GPU13_expert1&#45;&gt;L10_S1_TP6_GPU14_moe_ar -->
<g id="edge3253" class="edge">
<title>L10_S1_TP5_GPU13_expert1&#45;&gt;L10_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M97574.25,-604.34C97574.25,-604.34 97574.25,-578.55 97574.25,-578.55"/>
<polygon fill="black" stroke="black" points="97577.75,-578.55 97574.25,-568.55 97570.75,-578.55 97577.75,-578.55"/>
</g>
<!-- L10_S1_TP5_GPU13_expert1&#45;&gt;L10_S1_TP7_GPU15_moe_ar -->
<g id="edge3289" class="edge">
<title>L10_S1_TP5_GPU13_expert1&#45;&gt;L10_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M97630.38,-603.88C97630.38,-603.31 97630.38,-603 97630.38,-603 97630.38,-603 98096.62,-603 98096.62,-603 98096.62,-603 98096.62,-574.61 98096.62,-574.61"/>
<polygon fill="black" stroke="black" points="98100.12,-574.61 98096.62,-564.61 98093.12,-574.61 98100.12,-574.61"/>
</g>
<!-- L10_S1_TP6_GPU14_expert0 -->
<g id="node1079" class="node">
<title>L10_S1_TP6_GPU14_expert0</title>
<polygon fill="none" stroke="black" points="98153.5,-672.5 97704.5,-672.5 97704.5,-604.5 98153.5,-604.5 98153.5,-672.5"/>
<text text-anchor="middle" x="97929" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="97929" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="97929" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="97929" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L10_S1_TP6_GPU14_expert0&#45;&gt;L10_S1_TP0_GPU8_moe_ar -->
<g id="edge3038" class="edge">
<title>L10_S1_TP6_GPU14_expert0&#45;&gt;L10_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M97954.42,-604.39C97954.42,-595.82 97954.42,-589 97954.42,-589 97954.42,-589 93687.65,-589 93687.65,-589 93687.65,-589 93687.65,-559.9 93687.65,-559.9"/>
<polygon fill="black" stroke="black" points="93691.15,-559.9 93687.65,-549.9 93684.15,-559.9 93691.15,-559.9"/>
</g>
<!-- L10_S1_TP6_GPU14_expert0&#45;&gt;L10_S1_TP1_GPU9_moe_ar -->
<g id="edge3074" class="edge">
<title>L10_S1_TP6_GPU14_expert0&#45;&gt;L10_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M97726.37,-604.39C97726.37,-595.82 97726.37,-589 97726.37,-589 97726.37,-589 94136.88,-589 94136.88,-589 94136.88,-589 94136.88,-578.42 94136.88,-578.42"/>
<polygon fill="black" stroke="black" points="94140.38,-578.42 94136.88,-568.42 94133.38,-578.42 94140.38,-578.42"/>
</g>
<!-- L10_S1_TP6_GPU14_expert0&#45;&gt;L10_S1_TP2_GPU10_moe_ar -->
<g id="edge3110" class="edge">
<title>L10_S1_TP6_GPU14_expert0&#45;&gt;L10_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M97888.5,-604.36C97888.5,-550.04 97888.5,-450 97888.5,-450 97888.5,-450 95098.77,-450 95098.77,-450 95098.77,-450 95098.77,-489.67 95098.77,-489.67"/>
<polygon fill="black" stroke="black" points="95095.27,-489.67 95098.77,-499.67 95102.27,-489.67 95095.27,-489.67"/>
</g>
<!-- L10_S1_TP6_GPU14_expert0&#45;&gt;L10_S1_TP3_GPU11_moe_ar -->
<g id="edge3146" class="edge">
<title>L10_S1_TP6_GPU14_expert0&#45;&gt;L10_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M97883.98,-604.36C97883.98,-550.04 97883.98,-450 97883.98,-450 97883.98,-450 95812.37,-450 95812.37,-450 95812.37,-450 95812.37,-501.21 95812.37,-501.21"/>
<polygon fill="black" stroke="black" points="95808.87,-501.21 95812.37,-511.21 95815.87,-501.21 95808.87,-501.21"/>
</g>
<!-- L10_S1_TP6_GPU14_expert0&#45;&gt;L10_S1_TP4_GPU12_moe_ar -->
<g id="edge3182" class="edge">
<title>L10_S1_TP6_GPU14_expert0&#45;&gt;L10_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M97748.24,-604.26C97748.24,-595.25 97748.24,-588 97748.24,-588 97748.24,-588 96454.97,-588 96454.97,-588 96454.97,-588 96454.97,-555.97 96454.97,-555.97"/>
<polygon fill="black" stroke="black" points="96458.47,-555.97 96454.97,-545.97 96451.47,-555.97 96458.47,-555.97"/>
</g>
<!-- L10_S1_TP6_GPU14_expert0&#45;&gt;L10_S1_TP5_GPU13_moe_ar -->
<g id="edge3218" class="edge">
<title>L10_S1_TP6_GPU14_expert0&#45;&gt;L10_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M97770.11,-604.26C97770.11,-595.25 97770.11,-588 97770.11,-588 97770.11,-588 97023.68,-588 97023.68,-588 97023.68,-588 97023.68,-572.45 97023.68,-572.45"/>
<polygon fill="black" stroke="black" points="97027.18,-572.45 97023.68,-562.45 97020.18,-572.45 97027.18,-572.45"/>
</g>
<!-- L10_S1_TP6_GPU14_expert0&#45;&gt;L10_S1_TP6_GPU14_moe_ar -->
<g id="edge3254" class="edge">
<title>L10_S1_TP6_GPU14_expert0&#45;&gt;L10_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M97791.98,-604.34C97791.98,-604.34 97791.98,-562.87 97791.98,-562.87"/>
<polygon fill="black" stroke="black" points="97795.48,-562.87 97791.98,-552.87 97788.48,-562.87 97795.48,-562.87"/>
</g>
<!-- L10_S1_TP6_GPU14_expert0&#45;&gt;L10_S1_TP7_GPU15_moe_ar -->
<g id="edge3290" class="edge">
<title>L10_S1_TP6_GPU14_expert0&#45;&gt;L10_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M98125.06,-604.34C98125.06,-604.34 98125.06,-576.36 98125.06,-576.36"/>
<polygon fill="black" stroke="black" points="98128.56,-576.36 98125.06,-566.36 98121.56,-576.36 98128.56,-576.36"/>
</g>
<!-- L10_S1_TP6_GPU14_expert1 -->
<g id="node1080" class="node">
<title>L10_S1_TP6_GPU14_expert1</title>
<polygon fill="none" stroke="black" points="98620.5,-672.5 98171.5,-672.5 98171.5,-604.5 98620.5,-604.5 98620.5,-672.5"/>
<text text-anchor="middle" x="98396" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="98396" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="98396" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="98396" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L10_S1_TP6_GPU14_expert1&#45;&gt;L10_S1_TP0_GPU8_moe_ar -->
<g id="edge3039" class="edge">
<title>L10_S1_TP6_GPU14_expert1&#45;&gt;L10_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M98227.92,-604.39C98227.92,-595.82 98227.92,-589 98227.92,-589 98227.92,-589 93710.92,-589 93710.92,-589 93710.92,-589 93710.92,-555.18 93710.92,-555.18"/>
<polygon fill="black" stroke="black" points="93714.42,-555.18 93710.92,-545.18 93707.42,-555.18 93714.42,-555.18"/>
</g>
<!-- L10_S1_TP6_GPU14_expert1&#45;&gt;L10_S1_TP1_GPU9_moe_ar -->
<g id="edge3075" class="edge">
<title>L10_S1_TP6_GPU14_expert1&#45;&gt;L10_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M98284.35,-604.39C98284.35,-595.82 98284.35,-589 98284.35,-589 98284.35,-589 93863.02,-589 93863.02,-589 93863.02,-589 93863.02,-563.1 93863.02,-563.1"/>
<polygon fill="black" stroke="black" points="93866.52,-563.1 93863.02,-553.1 93859.52,-563.1 93866.52,-563.1"/>
</g>
<!-- L10_S1_TP6_GPU14_expert1&#45;&gt;L10_S1_TP2_GPU10_moe_ar -->
<g id="edge3111" class="edge">
<title>L10_S1_TP6_GPU14_expert1&#45;&gt;L10_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M98602.49,-604.18C98602.49,-549.57 98602.49,-449 98602.49,-449 98602.49,-449 95066.08,-449 95066.08,-449 95066.08,-449 95066.08,-481.78 95066.08,-481.78"/>
<polygon fill="black" stroke="black" points="95062.58,-481.78 95066.08,-491.78 95069.58,-481.78 95062.58,-481.78"/>
</g>
<!-- L10_S1_TP6_GPU14_expert1&#45;&gt;L10_S1_TP3_GPU11_moe_ar -->
<g id="edge3147" class="edge">
<title>L10_S1_TP6_GPU14_expert1&#45;&gt;L10_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M98584.47,-604.18C98584.47,-549.57 98584.47,-449 98584.47,-449 98584.47,-449 95806.28,-449 95806.28,-449 95806.28,-449 95806.28,-497.32 95806.28,-497.32"/>
<polygon fill="black" stroke="black" points="95802.78,-497.32 95806.28,-507.32 95809.78,-497.32 95802.78,-497.32"/>
</g>
<!-- L10_S1_TP6_GPU14_expert1&#45;&gt;L10_S1_TP4_GPU12_moe_ar -->
<g id="edge3183" class="edge">
<title>L10_S1_TP6_GPU14_expert1&#45;&gt;L10_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M98340.77,-604.26C98340.77,-595.25 98340.77,-588 98340.77,-588 98340.77,-588 96480.22,-588 96480.22,-588 96480.22,-588 96480.22,-548.88 96480.22,-548.88"/>
<polygon fill="black" stroke="black" points="96483.72,-548.88 96480.22,-538.88 96476.72,-548.88 96483.72,-548.88"/>
</g>
<!-- L10_S1_TP6_GPU14_expert1&#45;&gt;L10_S1_TP5_GPU13_moe_ar -->
<g id="edge3219" class="edge">
<title>L10_S1_TP6_GPU14_expert1&#45;&gt;L10_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M98397.19,-604.26C98397.19,-595.25 98397.19,-588 98397.19,-588 98397.19,-588 97065.87,-588 97065.87,-588 97065.87,-588 97065.87,-568.16 97065.87,-568.16"/>
<polygon fill="black" stroke="black" points="97069.37,-568.16 97065.87,-558.16 97062.37,-568.16 97069.37,-568.16"/>
</g>
<!-- L10_S1_TP6_GPU14_expert1&#45;&gt;L10_S1_TP6_GPU14_moe_ar -->
<g id="edge3255" class="edge">
<title>L10_S1_TP6_GPU14_expert1&#45;&gt;L10_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M98453.62,-604.44C98453.62,-594.86 98453.62,-587 98453.62,-587 98453.62,-587 97813.85,-587 97813.85,-587 97813.85,-587 97813.85,-559.04 97813.85,-559.04"/>
<polygon fill="black" stroke="black" points="97817.35,-559.04 97813.85,-549.04 97810.35,-559.04 97817.35,-559.04"/>
</g>
<!-- L10_S1_TP6_GPU14_expert1&#45;&gt;L10_S1_TP7_GPU15_moe_ar -->
<g id="edge3291" class="edge">
<title>L10_S1_TP6_GPU14_expert1&#45;&gt;L10_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M98510.04,-604.34C98510.04,-604.34 98510.04,-557.38 98510.04,-557.38"/>
<polygon fill="black" stroke="black" points="98513.54,-557.38 98510.04,-547.38 98506.54,-557.38 98513.54,-557.38"/>
</g>
<!-- L10_S1_TP7_GPU15_expert0 -->
<g id="node1081" class="node">
<title>L10_S1_TP7_GPU15_expert0</title>
<polygon fill="none" stroke="black" points="99087.5,-672.5 98638.5,-672.5 98638.5,-604.5 99087.5,-604.5 99087.5,-672.5"/>
<text text-anchor="middle" x="98863" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="98863" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="98863" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="98863" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L10_S1_TP7_GPU15_expert0&#45;&gt;L10_S1_TP0_GPU8_moe_ar -->
<g id="edge3040" class="edge">
<title>L10_S1_TP7_GPU15_expert0&#45;&gt;L10_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M98646.56,-604.39C98646.56,-595.82 98646.56,-589 98646.56,-589 98646.56,-589 93734.19,-589 93734.19,-589 93734.19,-589 93734.19,-548.08 93734.19,-548.08"/>
<polygon fill="black" stroke="black" points="93737.69,-548.08 93734.19,-538.08 93730.69,-548.08 93737.69,-548.08"/>
</g>
<!-- L10_S1_TP7_GPU15_expert0&#45;&gt;L10_S1_TP1_GPU9_moe_ar -->
<g id="edge3076" class="edge">
<title>L10_S1_TP7_GPU15_expert0&#45;&gt;L10_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M98702.94,-604.18C98702.94,-549.57 98702.94,-449 98702.94,-449 98702.94,-449 94282.31,-449 94282.31,-449 94282.31,-449 94282.31,-468.87 94282.31,-468.87"/>
<polygon fill="black" stroke="black" points="94278.81,-468.87 94282.31,-478.87 94285.81,-468.87 94278.81,-468.87"/>
</g>
<!-- L10_S1_TP7_GPU15_expert0&#45;&gt;L10_S1_TP2_GPU10_moe_ar -->
<g id="edge3112" class="edge">
<title>L10_S1_TP7_GPU15_expert0&#45;&gt;L10_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M98694.89,-604.18C98694.89,-549.57 98694.89,-449 98694.89,-449 98694.89,-449 95033.38,-449 95033.38,-449 95033.38,-449 95033.38,-476.38 95033.38,-476.38"/>
<polygon fill="black" stroke="black" points="95029.88,-476.38 95033.38,-486.38 95036.88,-476.38 95029.88,-476.38"/>
</g>
<!-- L10_S1_TP7_GPU15_expert0&#45;&gt;L10_S1_TP3_GPU11_moe_ar -->
<g id="edge3148" class="edge">
<title>L10_S1_TP7_GPU15_expert0&#45;&gt;L10_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M98686.83,-604.18C98686.83,-549.57 98686.83,-449 98686.83,-449 98686.83,-449 95800.18,-449 95800.18,-449 95800.18,-449 95800.18,-494.57 95800.18,-494.57"/>
<polygon fill="black" stroke="black" points="95796.68,-494.57 95800.18,-504.57 95803.68,-494.57 95796.68,-494.57"/>
</g>
<!-- L10_S1_TP7_GPU15_expert0&#45;&gt;L10_S1_TP4_GPU12_moe_ar -->
<g id="edge3184" class="edge">
<title>L10_S1_TP7_GPU15_expert0&#45;&gt;L10_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M98678.78,-604.47C98678.78,-553.18 98678.78,-462 98678.78,-462 98678.78,-462 96297.97,-462 96297.97,-462 96297.97,-462 96297.97,-465.84 96297.97,-465.84"/>
<polygon fill="black" stroke="black" points="96294.47,-465.84 96297.97,-475.84 96301.47,-465.84 96294.47,-465.84"/>
</g>
<!-- L10_S1_TP7_GPU15_expert0&#45;&gt;L10_S1_TP5_GPU13_moe_ar -->
<g id="edge3220" class="edge">
<title>L10_S1_TP7_GPU15_expert0&#45;&gt;L10_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M98654.61,-604.26C98654.61,-595.25 98654.61,-588 98654.61,-588 98654.61,-588 97108.07,-588 97108.07,-588 97108.07,-588 97108.07,-562.62 97108.07,-562.62"/>
<polygon fill="black" stroke="black" points="97111.57,-562.62 97108.07,-552.62 97104.57,-562.62 97111.57,-562.62"/>
</g>
<!-- L10_S1_TP7_GPU15_expert0&#45;&gt;L10_S1_TP6_GPU14_moe_ar -->
<g id="edge3256" class="edge">
<title>L10_S1_TP7_GPU15_expert0&#45;&gt;L10_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M98662.67,-604.44C98662.67,-594.86 98662.67,-587 98662.67,-587 98662.67,-587 97835.72,-587 97835.72,-587 97835.72,-587 97835.72,-554.45 97835.72,-554.45"/>
<polygon fill="black" stroke="black" points="97839.22,-554.45 97835.72,-544.45 97832.22,-554.45 97839.22,-554.45"/>
</g>
<!-- L10_S1_TP7_GPU15_expert0&#45;&gt;L10_S1_TP7_GPU15_moe_ar -->
<g id="edge3292" class="edge">
<title>L10_S1_TP7_GPU15_expert0&#45;&gt;L10_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M98670.72,-604.13C98670.72,-580.74 98670.72,-554 98670.72,-554 98670.72,-554 98481.58,-554 98481.58,-554"/>
<polygon fill="black" stroke="black" points="98481.58,-550.5 98471.58,-554 98481.58,-557.5 98481.58,-550.5"/>
</g>
<!-- L10_S1_TP7_GPU15_expert1 -->
<g id="node1082" class="node">
<title>L10_S1_TP7_GPU15_expert1</title>
<polygon fill="none" stroke="black" points="99554.5,-672.5 99105.5,-672.5 99105.5,-604.5 99554.5,-604.5 99554.5,-672.5"/>
<text text-anchor="middle" x="99330" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="99330" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="99330" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="99330" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L10_S1_TP7_GPU15_expert1&#45;&gt;L10_S1_TP0_GPU8_moe_ar -->
<g id="edge3041" class="edge">
<title>L10_S1_TP7_GPU15_expert1&#45;&gt;L10_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M99477.81,-604.18C99477.81,-549.57 99477.81,-449 99477.81,-449 99477.81,-449 93650.49,-449 93650.49,-449 93650.49,-449 93650.49,-475.13 93650.49,-475.13"/>
<polygon fill="black" stroke="black" points="93646.99,-475.13 93650.49,-485.13 93653.99,-475.13 93646.99,-475.13"/>
</g>
<!-- L10_S1_TP7_GPU15_expert1&#45;&gt;L10_S1_TP1_GPU9_moe_ar -->
<g id="edge3077" class="edge">
<title>L10_S1_TP7_GPU15_expert1&#45;&gt;L10_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M99424.62,-604.18C99424.62,-549.57 99424.62,-449 99424.62,-449 99424.62,-449 94120.15,-449 94120.15,-449 94120.15,-449 94120.15,-461.99 94120.15,-461.99"/>
<polygon fill="black" stroke="black" points="94116.65,-461.99 94120.15,-471.99 94123.65,-461.99 94116.65,-461.99"/>
</g>
<!-- L10_S1_TP7_GPU15_expert1&#45;&gt;L10_S1_TP2_GPU10_moe_ar -->
<g id="edge3113" class="edge">
<title>L10_S1_TP7_GPU15_expert1&#45;&gt;L10_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M99371.44,-604.18C99371.44,-549.57 99371.44,-449 99371.44,-449 99371.44,-449 95000.69,-449 95000.69,-449 95000.69,-449 95000.69,-472.2 95000.69,-472.2"/>
<polygon fill="black" stroke="black" points="94997.19,-472.2 95000.69,-482.2 95004.19,-472.2 94997.19,-472.2"/>
</g>
<!-- L10_S1_TP7_GPU15_expert1&#45;&gt;L10_S1_TP3_GPU11_moe_ar -->
<g id="edge3149" class="edge">
<title>L10_S1_TP7_GPU15_expert1&#45;&gt;L10_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M99318.25,-604.18C99318.25,-549.57 99318.25,-449 99318.25,-449 99318.25,-449 95794.09,-449 95794.09,-449 95794.09,-449 95794.09,-492.39 95794.09,-492.39"/>
<polygon fill="black" stroke="black" points="95790.59,-492.39 95794.09,-502.39 95797.59,-492.39 95790.59,-492.39"/>
</g>
<!-- L10_S1_TP7_GPU15_expert1&#45;&gt;L10_S1_TP4_GPU12_moe_ar -->
<g id="edge3185" class="edge">
<title>L10_S1_TP7_GPU15_expert1&#45;&gt;L10_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M99255.17,-672.78C99255.17,-688.63 99255.17,-704 99255.17,-704 99255.17,-704 96294.5,-704 96294.5,-704 96294.5,-704 96294.5,-575.33 96294.5,-575.33"/>
<polygon fill="black" stroke="black" points="96298,-575.33 96294.5,-565.33 96291,-575.33 96298,-575.33"/>
</g>
<!-- L10_S1_TP7_GPU15_expert1&#45;&gt;L10_S1_TP5_GPU13_moe_ar -->
<g id="edge3221" class="edge">
<title>L10_S1_TP7_GPU15_expert1&#45;&gt;L10_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M99158.69,-604.44C99158.69,-594.86 99158.69,-587 99158.69,-587 99158.69,-587 97150.27,-587 97150.27,-587 97150.27,-587 97150.27,-554.08 97150.27,-554.08"/>
<polygon fill="black" stroke="black" points="97153.77,-554.08 97150.27,-544.08 97146.77,-554.08 97153.77,-554.08"/>
</g>
<!-- L10_S1_TP7_GPU15_expert1&#45;&gt;L10_S1_TP6_GPU14_moe_ar -->
<g id="edge3257" class="edge">
<title>L10_S1_TP7_GPU15_expert1&#45;&gt;L10_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M99211.88,-604.44C99211.88,-594.86 99211.88,-587 99211.88,-587 99211.88,-587 97857.59,-587 97857.59,-587 97857.59,-587 97857.59,-547.56 97857.59,-547.56"/>
<polygon fill="black" stroke="black" points="97861.09,-547.56 97857.59,-537.56 97854.09,-547.56 97861.09,-547.56"/>
</g>
<!-- L10_S1_TP7_GPU15_expert1&#45;&gt;L10_S1_TP7_GPU15_moe_ar -->
<g id="edge3293" class="edge">
<title>L10_S1_TP7_GPU15_expert1&#45;&gt;L10_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M99265.06,-604.4C99265.06,-576.28 99265.06,-541 99265.06,-541 99265.06,-541 98544.28,-541 98544.28,-541"/>
<polygon fill="black" stroke="black" points="98544.28,-537.5 98534.28,-541 98544.28,-544.5 98544.28,-537.5"/>
</g>
<!-- L10_S1_TP0_GPU8_norm -->
<g id="node1084" class="node">
<title>L10_S1_TP0_GPU8_norm</title>
<polygon fill="none" stroke="black" points="92361.5,-332.33 91912.5,-332.33 91912.5,-264.33 92361.5,-264.33 92361.5,-332.33"/>
<text text-anchor="middle" x="92137" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="92137" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="92137" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="92137" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP0_GPU8_moe_res&#45;&gt;L10_S1_TP0_GPU8_norm -->
<g id="edge3044" class="edge">
<title>L10_S1_TP0_GPU8_moe_res&#45;&gt;L10_S1_TP0_GPU8_norm</title>
<path fill="none" stroke="black" d="M92137,-368.28C92137,-368.28 92137,-342.46 92137,-342.46"/>
<polygon fill="black" stroke="black" points="92140.5,-342.46 92137,-332.46 92133.5,-342.46 92140.5,-342.46"/>
</g>
<!-- L10_S1_TP1_GPU9_qkv_linear -->
<g id="node1085" class="node">
<title>L10_S1_TP1_GPU9_qkv_linear</title>
<polygon fill="none" stroke="black" points="93549,-1614.75 92941,-1614.75 92941,-1546.75 93549,-1546.75 93549,-1614.75"/>
<text text-anchor="middle" x="93245" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="93245" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="93245" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="93245" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L10_S1_TP1_GPU9_qkv_slice -->
<g id="node1086" class="node">
<title>L10_S1_TP1_GPU9_qkv_slice</title>
<polygon fill="none" stroke="black" points="93543,-1496.67 92947,-1496.67 92947,-1428.67 93543,-1428.67 93543,-1496.67"/>
<text text-anchor="middle" x="93245" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="93245" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="93245" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="93245" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L10_S1_TP1_GPU9_qkv_linear&#45;&gt;L10_S1_TP1_GPU9_qkv_slice -->
<g id="edge3045" class="edge">
<title>L10_S1_TP1_GPU9_qkv_linear&#45;&gt;L10_S1_TP1_GPU9_qkv_slice</title>
<path fill="none" stroke="black" d="M93245,-1546.59C93245,-1546.59 93245,-1506.74 93245,-1506.74"/>
<polygon fill="black" stroke="black" points="93248.5,-1506.74 93245,-1496.74 93241.5,-1506.74 93248.5,-1506.74"/>
</g>
<!-- L10_S1_TP1_GPU9_qkv_slice&#45;&gt;L10_S1_TP1_GPU9_attn_v -->
<g id="edge3049" class="edge">
<title>L10_S1_TP1_GPU9_qkv_slice&#45;&gt;L10_S1_TP1_GPU9_attn_v</title>
<path fill="none" stroke="black" d="M92997.75,-1428.38C92997.75,-1428.38 92997.75,-1195 92997.75,-1195"/>
<polygon fill="black" stroke="black" points="93001.25,-1195 92997.75,-1185 92994.25,-1195 93001.25,-1195"/>
</g>
<!-- L10_S1_TP1_GPU9_qk_matmul -->
<g id="node1087" class="node">
<title>L10_S1_TP1_GPU9_qk_matmul</title>
<polygon fill="none" stroke="black" points="93960.5,-1392.67 93025.5,-1392.67 93025.5,-1324.67 93960.5,-1324.67 93960.5,-1392.67"/>
<text text-anchor="middle" x="93493" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="93493" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="93493" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="93493" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L10_S1_TP1_GPU9_qkv_slice&#45;&gt;L10_S1_TP1_GPU9_qk_matmul -->
<g id="edge3046" class="edge">
<title>L10_S1_TP1_GPU9_qkv_slice&#45;&gt;L10_S1_TP1_GPU9_qk_matmul</title>
<path fill="none" stroke="black" d="M93284.25,-1428.61C93284.25,-1428.61 93284.25,-1402.8 93284.25,-1402.8"/>
<polygon fill="black" stroke="black" points="93287.75,-1402.8 93284.25,-1392.8 93280.75,-1402.8 93287.75,-1402.8"/>
</g>
<!-- L10_S1_TP1_GPU9_softmax -->
<g id="node1088" class="node">
<title>L10_S1_TP1_GPU9_softmax</title>
<polygon fill="none" stroke="black" points="93721,-1288.67 93211,-1288.67 93211,-1220.67 93721,-1220.67 93721,-1288.67"/>
<text text-anchor="middle" x="93466" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="93466" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="93466" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="93466" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L10_S1_TP1_GPU9_qk_matmul&#45;&gt;L10_S1_TP1_GPU9_softmax -->
<g id="edge3047" class="edge">
<title>L10_S1_TP1_GPU9_qk_matmul&#45;&gt;L10_S1_TP1_GPU9_softmax</title>
<path fill="none" stroke="black" d="M93466,-1324.61C93466,-1324.61 93466,-1298.8 93466,-1298.8"/>
<polygon fill="black" stroke="black" points="93469.5,-1298.8 93466,-1288.8 93462.5,-1298.8 93469.5,-1298.8"/>
</g>
<!-- L10_S1_TP1_GPU9_softmax&#45;&gt;L10_S1_TP1_GPU9_attn_v -->
<g id="edge3048" class="edge">
<title>L10_S1_TP1_GPU9_softmax&#45;&gt;L10_S1_TP1_GPU9_attn_v</title>
<path fill="none" stroke="black" d="M93466,-1220.61C93466,-1220.61 93466,-1194.8 93466,-1194.8"/>
<polygon fill="black" stroke="black" points="93469.5,-1194.8 93466,-1184.8 93462.5,-1194.8 93469.5,-1194.8"/>
</g>
<!-- L10_S1_TP1_GPU9_mha_res -->
<g id="node1090" class="node">
<title>L10_S1_TP1_GPU9_mha_res</title>
<polygon fill="none" stroke="black" points="93576.5,-948.5 92689.5,-948.5 92689.5,-880.5 93576.5,-880.5 93576.5,-948.5"/>
<text text-anchor="middle" x="93133" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="93133" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="93133" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="93133" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP1_GPU9_mha_ar&#45;&gt;L10_S1_TP1_GPU9_mha_res -->
<g id="edge3058" class="edge">
<title>L10_S1_TP1_GPU9_mha_ar&#45;&gt;L10_S1_TP1_GPU9_mha_res</title>
<path fill="none" stroke="black" d="M93553.51,-1015.91C93553.51,-1015.91 93553.51,-958.58 93553.51,-958.58"/>
<polygon fill="black" stroke="black" points="93557.01,-958.58 93553.51,-948.58 93550.01,-958.58 93557.01,-958.58"/>
</g>
<!-- L10_S1_TP1_GPU9_gate -->
<g id="node1091" class="node">
<title>L10_S1_TP1_GPU9_gate</title>
<polygon fill="none" stroke="black" points="93662.56,-844.5 92820.15,-844.5 92603.44,-708.5 93445.85,-708.5 93662.56,-844.5"/>
<text text-anchor="middle" x="93133" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="93133" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="93133" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="93133" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L10_S1_TP1_GPU9_mha_res&#45;&gt;L10_S1_TP1_GPU9_gate -->
<g id="edge3059" class="edge">
<title>L10_S1_TP1_GPU9_mha_res&#45;&gt;L10_S1_TP1_GPU9_gate</title>
<path fill="none" stroke="black" d="M93133,-880.39C93133,-880.39 93133,-854.73 93133,-854.73"/>
<polygon fill="black" stroke="black" points="93136.5,-854.73 93133,-844.73 93129.5,-854.73 93136.5,-854.73"/>
</g>
<!-- L10_S1_TP1_GPU9_moe_res -->
<g id="node1093" class="node">
<title>L10_S1_TP1_GPU9_moe_res</title>
<polygon fill="none" stroke="black" points="93597,-436.33 92777,-436.33 92777,-368.33 93597,-368.33 93597,-436.33"/>
<text text-anchor="middle" x="93187" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="93187" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="93187" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="93187" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP1_GPU9_mha_res&#45;&gt;L10_S1_TP1_GPU9_moe_res -->
<g id="edge3079" class="edge">
<title>L10_S1_TP1_GPU9_mha_res&#45;&gt;L10_S1_TP1_GPU9_moe_res</title>
<path fill="none" stroke="black" d="M92689.43,-914C92632.73,-914 92594,-914 92594,-914 92594,-914 92594,-675 92594,-675 92594,-675 93025.5,-675 93025.5,-675 93025.5,-675 93025.5,-446.59 93025.5,-446.59"/>
<polygon fill="black" stroke="black" points="93029,-446.59 93025.5,-436.59 93022,-446.59 93029,-446.59"/>
</g>
<!-- L10_S1_TP1_GPU9_gate&#45;&gt;L10_S1_TP1_GPU9_expert0 -->
<g id="edge3060" class="edge">
<title>L10_S1_TP1_GPU9_gate&#45;&gt;L10_S1_TP1_GPU9_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M93259,-708.31C93259,-708.31 93259,-682.71 93259,-682.71"/>
<polygon fill="black" stroke="black" points="93262.5,-682.71 93259,-672.71 93255.5,-682.71 93262.5,-682.71"/>
</g>
<!-- L10_S1_TP1_GPU9_gate&#45;&gt;L10_S1_TP1_GPU9_expert1 -->
<g id="edge3061" class="edge">
<title>L10_S1_TP1_GPU9_gate&#45;&gt;L10_S1_TP1_GPU9_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M93582.14,-776.4C93582.14,-776.4 93582.14,-682.74 93582.14,-682.74"/>
<polygon fill="black" stroke="black" points="93585.64,-682.74 93582.14,-672.74 93578.64,-682.74 93585.64,-682.74"/>
</g>
<!-- L10_S1_TP1_GPU9_moe_ar&#45;&gt;L10_S1_TP1_GPU9_moe_res -->
<g id="edge3078" class="edge">
<title>L10_S1_TP1_GPU9_moe_ar&#45;&gt;L10_S1_TP1_GPU9_moe_res</title>
<path fill="none" stroke="black" d="M93866.77,-487.12C93866.77,-452.09 93866.77,-402 93866.77,-402 93866.77,-402 93607.13,-402 93607.13,-402"/>
<polygon fill="black" stroke="black" points="93607.13,-398.5 93597.13,-402 93607.13,-405.5 93607.13,-398.5"/>
</g>
<!-- L10_S1_TP1_GPU9_norm -->
<g id="node1094" class="node">
<title>L10_S1_TP1_GPU9_norm</title>
<polygon fill="none" stroke="black" points="93411.5,-332.33 92962.5,-332.33 92962.5,-264.33 93411.5,-264.33 93411.5,-332.33"/>
<text text-anchor="middle" x="93187" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="93187" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="93187" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="93187" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP1_GPU9_moe_res&#45;&gt;L10_S1_TP1_GPU9_norm -->
<g id="edge3080" class="edge">
<title>L10_S1_TP1_GPU9_moe_res&#45;&gt;L10_S1_TP1_GPU9_norm</title>
<path fill="none" stroke="black" d="M93187,-368.28C93187,-368.28 93187,-342.46 93187,-342.46"/>
<polygon fill="black" stroke="black" points="93190.5,-342.46 93187,-332.46 93183.5,-342.46 93190.5,-342.46"/>
</g>
<!-- L10_S1_TP2_GPU10_qkv_linear -->
<g id="node1095" class="node">
<title>L10_S1_TP2_GPU10_qkv_linear</title>
<polygon fill="none" stroke="black" points="94541,-1614.75 93933,-1614.75 93933,-1546.75 94541,-1546.75 94541,-1614.75"/>
<text text-anchor="middle" x="94237" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="94237" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="94237" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="94237" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L10_S1_TP2_GPU10_qkv_slice -->
<g id="node1096" class="node">
<title>L10_S1_TP2_GPU10_qkv_slice</title>
<polygon fill="none" stroke="black" points="94535,-1496.67 93939,-1496.67 93939,-1428.67 94535,-1428.67 94535,-1496.67"/>
<text text-anchor="middle" x="94237" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="94237" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="94237" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="94237" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L10_S1_TP2_GPU10_qkv_linear&#45;&gt;L10_S1_TP2_GPU10_qkv_slice -->
<g id="edge3081" class="edge">
<title>L10_S1_TP2_GPU10_qkv_linear&#45;&gt;L10_S1_TP2_GPU10_qkv_slice</title>
<path fill="none" stroke="black" d="M94237,-1546.59C94237,-1546.59 94237,-1506.74 94237,-1506.74"/>
<polygon fill="black" stroke="black" points="94240.5,-1506.74 94237,-1496.74 94233.5,-1506.74 94240.5,-1506.74"/>
</g>
<!-- L10_S1_TP2_GPU10_qkv_slice&#45;&gt;L10_S1_TP2_GPU10_attn_v -->
<g id="edge3085" class="edge">
<title>L10_S1_TP2_GPU10_qkv_slice&#45;&gt;L10_S1_TP2_GPU10_attn_v</title>
<path fill="none" stroke="black" d="M93989,-1428.38C93989,-1428.38 93989,-1195 93989,-1195"/>
<polygon fill="black" stroke="black" points="93992.5,-1195 93989,-1185 93985.5,-1195 93992.5,-1195"/>
</g>
<!-- L10_S1_TP2_GPU10_qk_matmul -->
<g id="node1097" class="node">
<title>L10_S1_TP2_GPU10_qk_matmul</title>
<polygon fill="none" stroke="black" points="94952.5,-1392.67 94017.5,-1392.67 94017.5,-1324.67 94952.5,-1324.67 94952.5,-1392.67"/>
<text text-anchor="middle" x="94485" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="94485" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="94485" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="94485" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L10_S1_TP2_GPU10_qkv_slice&#45;&gt;L10_S1_TP2_GPU10_qk_matmul -->
<g id="edge3082" class="edge">
<title>L10_S1_TP2_GPU10_qkv_slice&#45;&gt;L10_S1_TP2_GPU10_qk_matmul</title>
<path fill="none" stroke="black" d="M94276.25,-1428.61C94276.25,-1428.61 94276.25,-1402.8 94276.25,-1402.8"/>
<polygon fill="black" stroke="black" points="94279.75,-1402.8 94276.25,-1392.8 94272.75,-1402.8 94279.75,-1402.8"/>
</g>
<!-- L10_S1_TP2_GPU10_softmax -->
<g id="node1098" class="node">
<title>L10_S1_TP2_GPU10_softmax</title>
<polygon fill="none" stroke="black" points="94695,-1288.67 94185,-1288.67 94185,-1220.67 94695,-1220.67 94695,-1288.67"/>
<text text-anchor="middle" x="94440" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="94440" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="94440" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="94440" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L10_S1_TP2_GPU10_qk_matmul&#45;&gt;L10_S1_TP2_GPU10_softmax -->
<g id="edge3083" class="edge">
<title>L10_S1_TP2_GPU10_qk_matmul&#45;&gt;L10_S1_TP2_GPU10_softmax</title>
<path fill="none" stroke="black" d="M94440,-1324.61C94440,-1324.61 94440,-1298.8 94440,-1298.8"/>
<polygon fill="black" stroke="black" points="94443.5,-1298.8 94440,-1288.8 94436.5,-1298.8 94443.5,-1298.8"/>
</g>
<!-- L10_S1_TP2_GPU10_softmax&#45;&gt;L10_S1_TP2_GPU10_attn_v -->
<g id="edge3084" class="edge">
<title>L10_S1_TP2_GPU10_softmax&#45;&gt;L10_S1_TP2_GPU10_attn_v</title>
<path fill="none" stroke="black" d="M94440,-1220.61C94440,-1220.61 94440,-1194.8 94440,-1194.8"/>
<polygon fill="black" stroke="black" points="94443.5,-1194.8 94440,-1184.8 94436.5,-1194.8 94443.5,-1194.8"/>
</g>
<!-- L10_S1_TP2_GPU10_mha_res -->
<g id="node1100" class="node">
<title>L10_S1_TP2_GPU10_mha_res</title>
<polygon fill="none" stroke="black" points="94654.5,-948.5 93767.5,-948.5 93767.5,-880.5 94654.5,-880.5 94654.5,-948.5"/>
<text text-anchor="middle" x="94211" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="94211" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="94211" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="94211" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP2_GPU10_mha_ar&#45;&gt;L10_S1_TP2_GPU10_mha_res -->
<g id="edge3094" class="edge">
<title>L10_S1_TP2_GPU10_mha_ar&#45;&gt;L10_S1_TP2_GPU10_mha_res</title>
<path fill="none" stroke="black" d="M94477.01,-991.61C94477.01,-991.61 94477.01,-958.74 94477.01,-958.74"/>
<polygon fill="black" stroke="black" points="94480.51,-958.74 94477.01,-948.74 94473.51,-958.74 94480.51,-958.74"/>
</g>
<!-- L10_S1_TP2_GPU10_gate -->
<g id="node1101" class="node">
<title>L10_S1_TP2_GPU10_gate</title>
<polygon fill="none" stroke="black" points="94740.56,-844.5 93898.15,-844.5 93681.44,-708.5 94523.85,-708.5 94740.56,-844.5"/>
<text text-anchor="middle" x="94211" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="94211" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="94211" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="94211" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L10_S1_TP2_GPU10_mha_res&#45;&gt;L10_S1_TP2_GPU10_gate -->
<g id="edge3095" class="edge">
<title>L10_S1_TP2_GPU10_mha_res&#45;&gt;L10_S1_TP2_GPU10_gate</title>
<path fill="none" stroke="black" d="M94211,-880.39C94211,-880.39 94211,-854.73 94211,-854.73"/>
<polygon fill="black" stroke="black" points="94214.5,-854.73 94211,-844.73 94207.5,-854.73 94214.5,-854.73"/>
</g>
<!-- L10_S1_TP2_GPU10_moe_res -->
<g id="node1103" class="node">
<title>L10_S1_TP2_GPU10_moe_res</title>
<polygon fill="none" stroke="black" points="94778,-436.33 93958,-436.33 93958,-368.33 94778,-368.33 94778,-436.33"/>
<text text-anchor="middle" x="94368" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="94368" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="94368" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="94368" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP2_GPU10_mha_res&#45;&gt;L10_S1_TP2_GPU10_moe_res -->
<g id="edge3115" class="edge">
<title>L10_S1_TP2_GPU10_mha_res&#45;&gt;L10_S1_TP2_GPU10_moe_res</title>
<path fill="none" stroke="black" d="M94654.57,-914C94711.27,-914 94750,-914 94750,-914 94750,-914 94750,-681 94750,-681 94750,-681 94428.75,-681 94428.75,-681 94428.75,-681 94428.75,-589 94428.75,-589 94428.75,-589 94456.51,-589 94456.51,-589 94456.51,-589 94456.51,-446.57 94456.51,-446.57"/>
<polygon fill="black" stroke="black" points="94460.01,-446.57 94456.51,-436.57 94453.01,-446.57 94460.01,-446.57"/>
</g>
<!-- L10_S1_TP2_GPU10_gate&#45;&gt;L10_S1_TP2_GPU10_expert0 -->
<g id="edge3096" class="edge">
<title>L10_S1_TP2_GPU10_gate&#45;&gt;L10_S1_TP2_GPU10_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M94080.75,-708.31C94080.75,-708.31 94080.75,-682.71 94080.75,-682.71"/>
<polygon fill="black" stroke="black" points="94084.25,-682.71 94080.75,-672.71 94077.25,-682.71 94084.25,-682.71"/>
</g>
<!-- L10_S1_TP2_GPU10_gate&#45;&gt;L10_S1_TP2_GPU10_expert1 -->
<g id="edge3097" class="edge">
<title>L10_S1_TP2_GPU10_gate&#45;&gt;L10_S1_TP2_GPU10_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M94588.14,-748.57C94588.14,-748.57 94588.14,-682.74 94588.14,-682.74"/>
<polygon fill="black" stroke="black" points="94591.64,-682.74 94588.14,-672.74 94584.64,-682.74 94591.64,-682.74"/>
</g>
<!-- L10_S1_TP2_GPU10_moe_ar&#45;&gt;L10_S1_TP2_GPU10_moe_res -->
<g id="edge3114" class="edge">
<title>L10_S1_TP2_GPU10_moe_ar&#45;&gt;L10_S1_TP2_GPU10_moe_res</title>
<path fill="none" stroke="black" d="M94672.85,-475.44C94672.85,-475.44 94672.85,-446.53 94672.85,-446.53"/>
<polygon fill="black" stroke="black" points="94676.35,-446.53 94672.85,-436.53 94669.35,-446.53 94676.35,-446.53"/>
</g>
<!-- L10_S1_TP2_GPU10_norm -->
<g id="node1104" class="node">
<title>L10_S1_TP2_GPU10_norm</title>
<polygon fill="none" stroke="black" points="94592.5,-332.33 94143.5,-332.33 94143.5,-264.33 94592.5,-264.33 94592.5,-332.33"/>
<text text-anchor="middle" x="94368" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="94368" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="94368" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="94368" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP2_GPU10_moe_res&#45;&gt;L10_S1_TP2_GPU10_norm -->
<g id="edge3116" class="edge">
<title>L10_S1_TP2_GPU10_moe_res&#45;&gt;L10_S1_TP2_GPU10_norm</title>
<path fill="none" stroke="black" d="M94368,-368.28C94368,-368.28 94368,-342.46 94368,-342.46"/>
<polygon fill="black" stroke="black" points="94371.5,-342.46 94368,-332.46 94364.5,-342.46 94371.5,-342.46"/>
</g>
<!-- L10_S1_TP3_GPU11_qkv_linear -->
<g id="node1105" class="node">
<title>L10_S1_TP3_GPU11_qkv_linear</title>
<polygon fill="none" stroke="black" points="95633,-1614.75 95025,-1614.75 95025,-1546.75 95633,-1546.75 95633,-1614.75"/>
<text text-anchor="middle" x="95329" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="95329" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="95329" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="95329" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L10_S1_TP3_GPU11_qkv_slice -->
<g id="node1106" class="node">
<title>L10_S1_TP3_GPU11_qkv_slice</title>
<polygon fill="none" stroke="black" points="95627,-1496.67 95031,-1496.67 95031,-1428.67 95627,-1428.67 95627,-1496.67"/>
<text text-anchor="middle" x="95329" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="95329" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="95329" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="95329" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L10_S1_TP3_GPU11_qkv_linear&#45;&gt;L10_S1_TP3_GPU11_qkv_slice -->
<g id="edge3117" class="edge">
<title>L10_S1_TP3_GPU11_qkv_linear&#45;&gt;L10_S1_TP3_GPU11_qkv_slice</title>
<path fill="none" stroke="black" d="M95329,-1546.59C95329,-1546.59 95329,-1506.74 95329,-1506.74"/>
<polygon fill="black" stroke="black" points="95332.5,-1506.74 95329,-1496.74 95325.5,-1506.74 95332.5,-1506.74"/>
</g>
<!-- L10_S1_TP3_GPU11_qkv_slice&#45;&gt;L10_S1_TP3_GPU11_attn_v -->
<g id="edge3121" class="edge">
<title>L10_S1_TP3_GPU11_qkv_slice&#45;&gt;L10_S1_TP3_GPU11_attn_v</title>
<path fill="none" stroke="black" d="M95030.68,-1462C95002.96,-1462 94985,-1462 94985,-1462 94985,-1462 94985,-1194.87 94985,-1194.87"/>
<polygon fill="black" stroke="black" points="94988.5,-1194.87 94985,-1184.87 94981.5,-1194.87 94988.5,-1194.87"/>
</g>
<!-- L10_S1_TP3_GPU11_qk_matmul -->
<g id="node1107" class="node">
<title>L10_S1_TP3_GPU11_qk_matmul</title>
<polygon fill="none" stroke="black" points="95952.5,-1392.67 95017.5,-1392.67 95017.5,-1324.67 95952.5,-1324.67 95952.5,-1392.67"/>
<text text-anchor="middle" x="95485" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="95485" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="95485" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="95485" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L10_S1_TP3_GPU11_qkv_slice&#45;&gt;L10_S1_TP3_GPU11_qk_matmul -->
<g id="edge3118" class="edge">
<title>L10_S1_TP3_GPU11_qkv_slice&#45;&gt;L10_S1_TP3_GPU11_qk_matmul</title>
<path fill="none" stroke="black" d="M95329,-1428.61C95329,-1428.61 95329,-1402.8 95329,-1402.8"/>
<polygon fill="black" stroke="black" points="95332.5,-1402.8 95329,-1392.8 95325.5,-1402.8 95332.5,-1402.8"/>
</g>
<!-- L10_S1_TP3_GPU11_softmax -->
<g id="node1108" class="node">
<title>L10_S1_TP3_GPU11_softmax</title>
<polygon fill="none" stroke="black" points="95673,-1288.67 95163,-1288.67 95163,-1220.67 95673,-1220.67 95673,-1288.67"/>
<text text-anchor="middle" x="95418" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="95418" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="95418" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="95418" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L10_S1_TP3_GPU11_qk_matmul&#45;&gt;L10_S1_TP3_GPU11_softmax -->
<g id="edge3119" class="edge">
<title>L10_S1_TP3_GPU11_qk_matmul&#45;&gt;L10_S1_TP3_GPU11_softmax</title>
<path fill="none" stroke="black" d="M95418,-1324.61C95418,-1324.61 95418,-1298.8 95418,-1298.8"/>
<polygon fill="black" stroke="black" points="95421.5,-1298.8 95418,-1288.8 95414.5,-1298.8 95421.5,-1298.8"/>
</g>
<!-- L10_S1_TP3_GPU11_softmax&#45;&gt;L10_S1_TP3_GPU11_attn_v -->
<g id="edge3120" class="edge">
<title>L10_S1_TP3_GPU11_softmax&#45;&gt;L10_S1_TP3_GPU11_attn_v</title>
<path fill="none" stroke="black" d="M95418,-1220.61C95418,-1220.61 95418,-1194.8 95418,-1194.8"/>
<polygon fill="black" stroke="black" points="95421.5,-1194.8 95418,-1184.8 95414.5,-1194.8 95421.5,-1194.8"/>
</g>
<!-- L10_S1_TP3_GPU11_mha_res -->
<g id="node1110" class="node">
<title>L10_S1_TP3_GPU11_mha_res</title>
<polygon fill="none" stroke="black" points="95732.5,-948.5 94845.5,-948.5 94845.5,-880.5 95732.5,-880.5 95732.5,-948.5"/>
<text text-anchor="middle" x="95289" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="95289" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="95289" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="95289" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP3_GPU11_mha_ar&#45;&gt;L10_S1_TP3_GPU11_mha_res -->
<g id="edge3130" class="edge">
<title>L10_S1_TP3_GPU11_mha_ar&#45;&gt;L10_S1_TP3_GPU11_mha_res</title>
<path fill="none" stroke="black" d="M95400.51,-984.55C95400.51,-984.55 95400.51,-958.73 95400.51,-958.73"/>
<polygon fill="black" stroke="black" points="95404.01,-958.73 95400.51,-948.73 95397.01,-958.73 95404.01,-958.73"/>
</g>
<!-- L10_S1_TP3_GPU11_gate -->
<g id="node1111" class="node">
<title>L10_S1_TP3_GPU11_gate</title>
<polygon fill="none" stroke="black" points="95818.56,-844.5 94976.15,-844.5 94759.44,-708.5 95601.85,-708.5 95818.56,-844.5"/>
<text text-anchor="middle" x="95289" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="95289" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="95289" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="95289" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L10_S1_TP3_GPU11_mha_res&#45;&gt;L10_S1_TP3_GPU11_gate -->
<g id="edge3131" class="edge">
<title>L10_S1_TP3_GPU11_mha_res&#45;&gt;L10_S1_TP3_GPU11_gate</title>
<path fill="none" stroke="black" d="M95289,-880.39C95289,-880.39 95289,-854.73 95289,-854.73"/>
<polygon fill="black" stroke="black" points="95292.5,-854.73 95289,-844.73 95285.5,-854.73 95292.5,-854.73"/>
</g>
<!-- L10_S1_TP3_GPU11_moe_res -->
<g id="node1113" class="node">
<title>L10_S1_TP3_GPU11_moe_res</title>
<polygon fill="none" stroke="black" points="95788,-436.33 94968,-436.33 94968,-368.33 95788,-368.33 95788,-436.33"/>
<text text-anchor="middle" x="95378" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="95378" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="95378" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="95378" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP3_GPU11_mha_res&#45;&gt;L10_S1_TP3_GPU11_moe_res -->
<g id="edge3151" class="edge">
<title>L10_S1_TP3_GPU11_mha_res&#45;&gt;L10_S1_TP3_GPU11_moe_res</title>
<path fill="none" stroke="black" d="M95732.55,-925C95791.35,-925 95831.79,-925 95831.79,-925 95831.79,-925 95831.79,-413 95831.79,-413 95831.79,-413 95798.27,-413 95798.27,-413"/>
<polygon fill="black" stroke="black" points="95798.27,-409.5 95788.27,-413 95798.27,-416.5 95798.27,-409.5"/>
</g>
<!-- L10_S1_TP3_GPU11_gate&#45;&gt;L10_S1_TP3_GPU11_expert0 -->
<g id="edge3132" class="edge">
<title>L10_S1_TP3_GPU11_gate&#45;&gt;L10_S1_TP3_GPU11_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M95052.17,-708.31C95052.17,-708.31 95052.17,-682.71 95052.17,-682.71"/>
<polygon fill="black" stroke="black" points="95055.67,-682.71 95052.17,-672.71 95048.67,-682.71 95055.67,-682.71"/>
</g>
<!-- L10_S1_TP3_GPU11_gate&#45;&gt;L10_S1_TP3_GPU11_expert1 -->
<g id="edge3133" class="edge">
<title>L10_S1_TP3_GPU11_gate&#45;&gt;L10_S1_TP3_GPU11_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M95481.75,-708.31C95481.75,-708.31 95481.75,-682.71 95481.75,-682.71"/>
<polygon fill="black" stroke="black" points="95485.25,-682.71 95481.75,-672.71 95478.25,-682.71 95485.25,-682.71"/>
</g>
<!-- L10_S1_TP3_GPU11_moe_ar&#45;&gt;L10_S1_TP3_GPU11_moe_res -->
<g id="edge3150" class="edge">
<title>L10_S1_TP3_GPU11_moe_ar&#45;&gt;L10_S1_TP3_GPU11_moe_res</title>
<path fill="none" stroke="black" d="M95575.18,-474.09C95575.18,-474.09 95575.18,-446.48 95575.18,-446.48"/>
<polygon fill="black" stroke="black" points="95578.68,-446.48 95575.18,-436.48 95571.68,-446.48 95578.68,-446.48"/>
</g>
<!-- L10_S1_TP3_GPU11_norm -->
<g id="node1114" class="node">
<title>L10_S1_TP3_GPU11_norm</title>
<polygon fill="none" stroke="black" points="95602.5,-332.33 95153.5,-332.33 95153.5,-264.33 95602.5,-264.33 95602.5,-332.33"/>
<text text-anchor="middle" x="95378" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="95378" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="95378" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="95378" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP3_GPU11_moe_res&#45;&gt;L10_S1_TP3_GPU11_norm -->
<g id="edge3152" class="edge">
<title>L10_S1_TP3_GPU11_moe_res&#45;&gt;L10_S1_TP3_GPU11_norm</title>
<path fill="none" stroke="black" d="M95378,-368.28C95378,-368.28 95378,-342.46 95378,-342.46"/>
<polygon fill="black" stroke="black" points="95381.5,-342.46 95378,-332.46 95374.5,-342.46 95381.5,-342.46"/>
</g>
<!-- L10_S1_TP4_GPU12_qkv_linear -->
<g id="node1115" class="node">
<title>L10_S1_TP4_GPU12_qkv_linear</title>
<polygon fill="none" stroke="black" points="96444,-1614.75 95836,-1614.75 95836,-1546.75 96444,-1546.75 96444,-1614.75"/>
<text text-anchor="middle" x="96140" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="96140" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="96140" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="96140" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L10_S1_TP4_GPU12_qkv_slice -->
<g id="node1116" class="node">
<title>L10_S1_TP4_GPU12_qkv_slice</title>
<polygon fill="none" stroke="black" points="96438,-1496.67 95842,-1496.67 95842,-1428.67 96438,-1428.67 96438,-1496.67"/>
<text text-anchor="middle" x="96140" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="96140" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="96140" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="96140" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L10_S1_TP4_GPU12_qkv_linear&#45;&gt;L10_S1_TP4_GPU12_qkv_slice -->
<g id="edge3153" class="edge">
<title>L10_S1_TP4_GPU12_qkv_linear&#45;&gt;L10_S1_TP4_GPU12_qkv_slice</title>
<path fill="none" stroke="black" d="M96140,-1546.59C96140,-1546.59 96140,-1506.74 96140,-1506.74"/>
<polygon fill="black" stroke="black" points="96143.5,-1506.74 96140,-1496.74 96136.5,-1506.74 96143.5,-1506.74"/>
</g>
<!-- L10_S1_TP4_GPU12_qkv_slice&#45;&gt;L10_S1_TP4_GPU12_attn_v -->
<g id="edge3157" class="edge">
<title>L10_S1_TP4_GPU12_qkv_slice&#45;&gt;L10_S1_TP4_GPU12_attn_v</title>
<path fill="none" stroke="black" d="M95983,-1428.38C95983,-1428.38 95983,-1195 95983,-1195"/>
<polygon fill="black" stroke="black" points="95986.5,-1195 95983,-1185 95979.5,-1195 95986.5,-1195"/>
</g>
<!-- L10_S1_TP4_GPU12_qk_matmul -->
<g id="node1117" class="node">
<title>L10_S1_TP4_GPU12_qk_matmul</title>
<polygon fill="none" stroke="black" points="96948.5,-1392.67 96013.5,-1392.67 96013.5,-1324.67 96948.5,-1324.67 96948.5,-1392.67"/>
<text text-anchor="middle" x="96481" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="96481" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="96481" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="96481" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L10_S1_TP4_GPU12_qkv_slice&#45;&gt;L10_S1_TP4_GPU12_qk_matmul -->
<g id="edge3154" class="edge">
<title>L10_S1_TP4_GPU12_qkv_slice&#45;&gt;L10_S1_TP4_GPU12_qk_matmul</title>
<path fill="none" stroke="black" d="M96225.75,-1428.61C96225.75,-1428.61 96225.75,-1402.8 96225.75,-1402.8"/>
<polygon fill="black" stroke="black" points="96229.25,-1402.8 96225.75,-1392.8 96222.25,-1402.8 96229.25,-1402.8"/>
</g>
<!-- L10_S1_TP4_GPU12_softmax -->
<g id="node1118" class="node">
<title>L10_S1_TP4_GPU12_softmax</title>
<polygon fill="none" stroke="black" points="96649,-1288.67 96139,-1288.67 96139,-1220.67 96649,-1220.67 96649,-1288.67"/>
<text text-anchor="middle" x="96394" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="96394" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="96394" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="96394" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L10_S1_TP4_GPU12_qk_matmul&#45;&gt;L10_S1_TP4_GPU12_softmax -->
<g id="edge3155" class="edge">
<title>L10_S1_TP4_GPU12_qk_matmul&#45;&gt;L10_S1_TP4_GPU12_softmax</title>
<path fill="none" stroke="black" d="M96394,-1324.61C96394,-1324.61 96394,-1298.8 96394,-1298.8"/>
<polygon fill="black" stroke="black" points="96397.5,-1298.8 96394,-1288.8 96390.5,-1298.8 96397.5,-1298.8"/>
</g>
<!-- L10_S1_TP4_GPU12_softmax&#45;&gt;L10_S1_TP4_GPU12_attn_v -->
<g id="edge3156" class="edge">
<title>L10_S1_TP4_GPU12_softmax&#45;&gt;L10_S1_TP4_GPU12_attn_v</title>
<path fill="none" stroke="black" d="M96394,-1220.61C96394,-1220.61 96394,-1194.8 96394,-1194.8"/>
<polygon fill="black" stroke="black" points="96397.5,-1194.8 96394,-1184.8 96390.5,-1194.8 96397.5,-1194.8"/>
</g>
<!-- L10_S1_TP4_GPU12_mha_res -->
<g id="node1120" class="node">
<title>L10_S1_TP4_GPU12_mha_res</title>
<polygon fill="none" stroke="black" points="96810.5,-948.5 95923.5,-948.5 95923.5,-880.5 96810.5,-880.5 96810.5,-948.5"/>
<text text-anchor="middle" x="96367" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="96367" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="96367" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="96367" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP4_GPU12_mha_ar&#45;&gt;L10_S1_TP4_GPU12_mha_res -->
<g id="edge3166" class="edge">
<title>L10_S1_TP4_GPU12_mha_ar&#45;&gt;L10_S1_TP4_GPU12_mha_res</title>
<path fill="none" stroke="black" d="M96255.99,-984.55C96255.99,-984.55 96255.99,-958.73 96255.99,-958.73"/>
<polygon fill="black" stroke="black" points="96259.49,-958.73 96255.99,-948.73 96252.49,-958.73 96259.49,-958.73"/>
</g>
<!-- L10_S1_TP4_GPU12_gate -->
<g id="node1121" class="node">
<title>L10_S1_TP4_GPU12_gate</title>
<polygon fill="none" stroke="black" points="96896.56,-844.5 96054.15,-844.5 95837.44,-708.5 96679.85,-708.5 96896.56,-844.5"/>
<text text-anchor="middle" x="96367" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="96367" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="96367" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="96367" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L10_S1_TP4_GPU12_mha_res&#45;&gt;L10_S1_TP4_GPU12_gate -->
<g id="edge3167" class="edge">
<title>L10_S1_TP4_GPU12_mha_res&#45;&gt;L10_S1_TP4_GPU12_gate</title>
<path fill="none" stroke="black" d="M96367,-880.39C96367,-880.39 96367,-854.73 96367,-854.73"/>
<polygon fill="black" stroke="black" points="96370.5,-854.73 96367,-844.73 96363.5,-854.73 96370.5,-854.73"/>
</g>
<!-- L10_S1_TP4_GPU12_moe_res -->
<g id="node1123" class="node">
<title>L10_S1_TP4_GPU12_moe_res</title>
<polygon fill="none" stroke="black" points="96703,-436.33 95883,-436.33 95883,-368.33 96703,-368.33 96703,-436.33"/>
<text text-anchor="middle" x="96293" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="96293" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="96293" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="96293" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP4_GPU12_mha_res&#45;&gt;L10_S1_TP4_GPU12_moe_res -->
<g id="edge3187" class="edge">
<title>L10_S1_TP4_GPU12_mha_res&#45;&gt;L10_S1_TP4_GPU12_moe_res</title>
<path fill="none" stroke="black" d="M95923.33,-903C95870.1,-903 95834.14,-903 95834.14,-903 95834.14,-903 95834.14,-390 95834.14,-390 95834.14,-390 95872.81,-390 95872.81,-390"/>
<polygon fill="black" stroke="black" points="95872.81,-393.5 95882.81,-390 95872.81,-386.5 95872.81,-393.5"/>
</g>
<!-- L10_S1_TP4_GPU12_gate&#45;&gt;L10_S1_TP4_GPU12_expert0 -->
<g id="edge3168" class="edge">
<title>L10_S1_TP4_GPU12_gate&#45;&gt;L10_S1_TP4_GPU12_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M96173.43,-708.31C96173.43,-708.31 96173.43,-682.71 96173.43,-682.71"/>
<polygon fill="black" stroke="black" points="96176.93,-682.71 96173.43,-672.71 96169.93,-682.71 96176.93,-682.71"/>
</g>
<!-- L10_S1_TP4_GPU12_gate&#45;&gt;L10_S1_TP4_GPU12_expert1 -->
<g id="edge3169" class="edge">
<title>L10_S1_TP4_GPU12_gate&#45;&gt;L10_S1_TP4_GPU12_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M96602.83,-708.31C96602.83,-708.31 96602.83,-682.71 96602.83,-682.71"/>
<polygon fill="black" stroke="black" points="96606.33,-682.71 96602.83,-672.71 96599.33,-682.71 96606.33,-682.71"/>
</g>
<!-- L10_S1_TP4_GPU12_moe_ar&#45;&gt;L10_S1_TP4_GPU12_moe_res -->
<g id="edge3186" class="edge">
<title>L10_S1_TP4_GPU12_moe_ar&#45;&gt;L10_S1_TP4_GPU12_moe_res</title>
<path fill="none" stroke="black" d="M96090.49,-473.75C96090.49,-473.75 96090.49,-446.65 96090.49,-446.65"/>
<polygon fill="black" stroke="black" points="96093.99,-446.65 96090.49,-436.65 96086.99,-446.65 96093.99,-446.65"/>
</g>
<!-- L10_S1_TP4_GPU12_norm -->
<g id="node1124" class="node">
<title>L10_S1_TP4_GPU12_norm</title>
<polygon fill="none" stroke="black" points="96517.5,-332.33 96068.5,-332.33 96068.5,-264.33 96517.5,-264.33 96517.5,-332.33"/>
<text text-anchor="middle" x="96293" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="96293" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="96293" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="96293" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP4_GPU12_moe_res&#45;&gt;L10_S1_TP4_GPU12_norm -->
<g id="edge3188" class="edge">
<title>L10_S1_TP4_GPU12_moe_res&#45;&gt;L10_S1_TP4_GPU12_norm</title>
<path fill="none" stroke="black" d="M96293,-368.28C96293,-368.28 96293,-342.46 96293,-342.46"/>
<polygon fill="black" stroke="black" points="96296.5,-342.46 96293,-332.46 96289.5,-342.46 96296.5,-342.46"/>
</g>
<!-- L10_S1_TP5_GPU13_qkv_linear -->
<g id="node1125" class="node">
<title>L10_S1_TP5_GPU13_qkv_linear</title>
<polygon fill="none" stroke="black" points="97639,-1614.75 97031,-1614.75 97031,-1546.75 97639,-1546.75 97639,-1614.75"/>
<text text-anchor="middle" x="97335" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="97335" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="97335" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="97335" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L10_S1_TP5_GPU13_qkv_slice -->
<g id="node1126" class="node">
<title>L10_S1_TP5_GPU13_qkv_slice</title>
<polygon fill="none" stroke="black" points="97633,-1496.67 97037,-1496.67 97037,-1428.67 97633,-1428.67 97633,-1496.67"/>
<text text-anchor="middle" x="97335" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="97335" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="97335" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="97335" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L10_S1_TP5_GPU13_qkv_linear&#45;&gt;L10_S1_TP5_GPU13_qkv_slice -->
<g id="edge3189" class="edge">
<title>L10_S1_TP5_GPU13_qkv_linear&#45;&gt;L10_S1_TP5_GPU13_qkv_slice</title>
<path fill="none" stroke="black" d="M97335,-1546.59C97335,-1546.59 97335,-1506.74 97335,-1506.74"/>
<polygon fill="black" stroke="black" points="97338.5,-1506.74 97335,-1496.74 97331.5,-1506.74 97338.5,-1506.74"/>
</g>
<!-- L10_S1_TP5_GPU13_qkv_slice&#45;&gt;L10_S1_TP5_GPU13_attn_v -->
<g id="edge3193" class="edge">
<title>L10_S1_TP5_GPU13_qkv_slice&#45;&gt;L10_S1_TP5_GPU13_attn_v</title>
<path fill="none" stroke="black" d="M97036.95,-1462C97001.73,-1462 96978,-1462 96978,-1462 96978,-1462 96978,-1194.87 96978,-1194.87"/>
<polygon fill="black" stroke="black" points="96981.5,-1194.87 96978,-1184.87 96974.5,-1194.87 96981.5,-1194.87"/>
</g>
<!-- L10_S1_TP5_GPU13_qk_matmul -->
<g id="node1127" class="node">
<title>L10_S1_TP5_GPU13_qk_matmul</title>
<polygon fill="none" stroke="black" points="97942.5,-1392.67 97007.5,-1392.67 97007.5,-1324.67 97942.5,-1324.67 97942.5,-1392.67"/>
<text text-anchor="middle" x="97475" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="97475" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="97475" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="97475" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L10_S1_TP5_GPU13_qkv_slice&#45;&gt;L10_S1_TP5_GPU13_qk_matmul -->
<g id="edge3190" class="edge">
<title>L10_S1_TP5_GPU13_qkv_slice&#45;&gt;L10_S1_TP5_GPU13_qk_matmul</title>
<path fill="none" stroke="black" d="M97335,-1428.61C97335,-1428.61 97335,-1402.8 97335,-1402.8"/>
<polygon fill="black" stroke="black" points="97338.5,-1402.8 97335,-1392.8 97331.5,-1402.8 97338.5,-1402.8"/>
</g>
<!-- L10_S1_TP5_GPU13_softmax -->
<g id="node1128" class="node">
<title>L10_S1_TP5_GPU13_softmax</title>
<polygon fill="none" stroke="black" points="97624,-1288.67 97114,-1288.67 97114,-1220.67 97624,-1220.67 97624,-1288.67"/>
<text text-anchor="middle" x="97369" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="97369" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="97369" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="97369" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L10_S1_TP5_GPU13_qk_matmul&#45;&gt;L10_S1_TP5_GPU13_softmax -->
<g id="edge3191" class="edge">
<title>L10_S1_TP5_GPU13_qk_matmul&#45;&gt;L10_S1_TP5_GPU13_softmax</title>
<path fill="none" stroke="black" d="M97369,-1324.61C97369,-1324.61 97369,-1298.8 97369,-1298.8"/>
<polygon fill="black" stroke="black" points="97372.5,-1298.8 97369,-1288.8 97365.5,-1298.8 97372.5,-1298.8"/>
</g>
<!-- L10_S1_TP5_GPU13_softmax&#45;&gt;L10_S1_TP5_GPU13_attn_v -->
<g id="edge3192" class="edge">
<title>L10_S1_TP5_GPU13_softmax&#45;&gt;L10_S1_TP5_GPU13_attn_v</title>
<path fill="none" stroke="black" d="M97369,-1220.61C97369,-1220.61 97369,-1194.8 97369,-1194.8"/>
<polygon fill="black" stroke="black" points="97372.5,-1194.8 97369,-1184.8 97365.5,-1194.8 97372.5,-1194.8"/>
</g>
<!-- L10_S1_TP5_GPU13_mha_res -->
<g id="node1130" class="node">
<title>L10_S1_TP5_GPU13_mha_res</title>
<polygon fill="none" stroke="black" points="97888.5,-948.5 97001.5,-948.5 97001.5,-880.5 97888.5,-880.5 97888.5,-948.5"/>
<text text-anchor="middle" x="97445" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="97445" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="97445" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="97445" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP5_GPU13_mha_ar&#45;&gt;L10_S1_TP5_GPU13_mha_res -->
<g id="edge3202" class="edge">
<title>L10_S1_TP5_GPU13_mha_ar&#45;&gt;L10_S1_TP5_GPU13_mha_res</title>
<path fill="none" stroke="black" d="M97179.49,-991.61C97179.49,-991.61 97179.49,-958.74 97179.49,-958.74"/>
<polygon fill="black" stroke="black" points="97182.99,-958.74 97179.49,-948.74 97175.99,-958.74 97182.99,-958.74"/>
</g>
<!-- L10_S1_TP5_GPU13_gate -->
<g id="node1131" class="node">
<title>L10_S1_TP5_GPU13_gate</title>
<polygon fill="none" stroke="black" points="97974.56,-844.5 97132.15,-844.5 96915.44,-708.5 97757.85,-708.5 97974.56,-844.5"/>
<text text-anchor="middle" x="97445" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="97445" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="97445" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="97445" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L10_S1_TP5_GPU13_mha_res&#45;&gt;L10_S1_TP5_GPU13_gate -->
<g id="edge3203" class="edge">
<title>L10_S1_TP5_GPU13_mha_res&#45;&gt;L10_S1_TP5_GPU13_gate</title>
<path fill="none" stroke="black" d="M97445,-880.39C97445,-880.39 97445,-854.73 97445,-854.73"/>
<polygon fill="black" stroke="black" points="97448.5,-854.73 97445,-844.73 97441.5,-854.73 97448.5,-854.73"/>
</g>
<!-- L10_S1_TP5_GPU13_moe_res -->
<g id="node1133" class="node">
<title>L10_S1_TP5_GPU13_moe_res</title>
<polygon fill="none" stroke="black" points="98309,-436.33 97489,-436.33 97489,-368.33 98309,-368.33 98309,-436.33"/>
<text text-anchor="middle" x="97899" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="97899" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="97899" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="97899" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP5_GPU13_mha_res&#45;&gt;L10_S1_TP5_GPU13_moe_res -->
<g id="edge3223" class="edge">
<title>L10_S1_TP5_GPU13_mha_res&#45;&gt;L10_S1_TP5_GPU13_moe_res</title>
<path fill="none" stroke="black" d="M97888.57,-914C97945.27,-914 97984,-914 97984,-914 97984,-914 97984,-692 97984,-692 97984,-692 98157.1,-692 98157.1,-692 98157.1,-692 98157.1,-589 98157.1,-589 98157.1,-589 97893.02,-589 97893.02,-589 97893.02,-589 97893.02,-446.57 97893.02,-446.57"/>
<polygon fill="black" stroke="black" points="97896.52,-446.57 97893.02,-436.57 97889.52,-446.57 97896.52,-446.57"/>
</g>
<!-- L10_S1_TP5_GPU13_gate&#45;&gt;L10_S1_TP5_GPU13_expert0 -->
<g id="edge3204" class="edge">
<title>L10_S1_TP5_GPU13_gate&#45;&gt;L10_S1_TP5_GPU13_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M97067.36,-708.31C97067.36,-708.31 97067.36,-682.71 97067.36,-682.71"/>
<polygon fill="black" stroke="black" points="97070.86,-682.71 97067.36,-672.71 97063.86,-682.71 97070.86,-682.71"/>
</g>
<!-- L10_S1_TP5_GPU13_gate&#45;&gt;L10_S1_TP5_GPU13_expert1 -->
<g id="edge3205" class="edge">
<title>L10_S1_TP5_GPU13_gate&#45;&gt;L10_S1_TP5_GPU13_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M97574.25,-708.31C97574.25,-708.31 97574.25,-682.71 97574.25,-682.71"/>
<polygon fill="black" stroke="black" points="97577.75,-682.71 97574.25,-672.71 97570.75,-682.71 97577.75,-682.71"/>
</g>
<!-- L10_S1_TP5_GPU13_moe_ar&#45;&gt;L10_S1_TP5_GPU13_moe_res -->
<g id="edge3222" class="edge">
<title>L10_S1_TP5_GPU13_moe_ar&#45;&gt;L10_S1_TP5_GPU13_moe_res</title>
<path fill="none" stroke="black" d="M96947.73,-473.95C96947.73,-440.78 96947.73,-402 96947.73,-402 96947.73,-402 97478.67,-402 97478.67,-402"/>
<polygon fill="black" stroke="black" points="97478.67,-405.5 97488.67,-402 97478.67,-398.5 97478.67,-405.5"/>
</g>
<!-- L10_S1_TP5_GPU13_norm -->
<g id="node1134" class="node">
<title>L10_S1_TP5_GPU13_norm</title>
<polygon fill="none" stroke="black" points="98123.5,-332.33 97674.5,-332.33 97674.5,-264.33 98123.5,-264.33 98123.5,-332.33"/>
<text text-anchor="middle" x="97899" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="97899" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="97899" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="97899" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP5_GPU13_moe_res&#45;&gt;L10_S1_TP5_GPU13_norm -->
<g id="edge3224" class="edge">
<title>L10_S1_TP5_GPU13_moe_res&#45;&gt;L10_S1_TP5_GPU13_norm</title>
<path fill="none" stroke="black" d="M97899,-368.28C97899,-368.28 97899,-342.46 97899,-342.46"/>
<polygon fill="black" stroke="black" points="97902.5,-342.46 97899,-332.46 97895.5,-342.46 97902.5,-342.46"/>
</g>
<!-- L10_S1_TP6_GPU14_qkv_linear -->
<g id="node1135" class="node">
<title>L10_S1_TP6_GPU14_qkv_linear</title>
<polygon fill="none" stroke="black" points="98480,-1614.75 97872,-1614.75 97872,-1546.75 98480,-1546.75 98480,-1614.75"/>
<text text-anchor="middle" x="98176" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="98176" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="98176" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="98176" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L10_S1_TP6_GPU14_qkv_slice -->
<g id="node1136" class="node">
<title>L10_S1_TP6_GPU14_qkv_slice</title>
<polygon fill="none" stroke="black" points="98474,-1496.67 97878,-1496.67 97878,-1428.67 98474,-1428.67 98474,-1496.67"/>
<text text-anchor="middle" x="98176" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="98176" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="98176" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="98176" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L10_S1_TP6_GPU14_qkv_linear&#45;&gt;L10_S1_TP6_GPU14_qkv_slice -->
<g id="edge3225" class="edge">
<title>L10_S1_TP6_GPU14_qkv_linear&#45;&gt;L10_S1_TP6_GPU14_qkv_slice</title>
<path fill="none" stroke="black" d="M98176,-1546.59C98176,-1546.59 98176,-1506.74 98176,-1506.74"/>
<polygon fill="black" stroke="black" points="98179.5,-1506.74 98176,-1496.74 98172.5,-1506.74 98179.5,-1506.74"/>
</g>
<!-- L10_S1_TP6_GPU14_qkv_slice&#45;&gt;L10_S1_TP6_GPU14_attn_v -->
<g id="edge3229" class="edge">
<title>L10_S1_TP6_GPU14_qkv_slice&#45;&gt;L10_S1_TP6_GPU14_attn_v</title>
<path fill="none" stroke="black" d="M98003.5,-1428.38C98003.5,-1428.38 98003.5,-1195 98003.5,-1195"/>
<polygon fill="black" stroke="black" points="98007,-1195 98003.5,-1185 98000,-1195 98007,-1195"/>
</g>
<!-- L10_S1_TP6_GPU14_qk_matmul -->
<g id="node1137" class="node">
<title>L10_S1_TP6_GPU14_qk_matmul</title>
<polygon fill="none" stroke="black" points="98999.5,-1392.67 98064.5,-1392.67 98064.5,-1324.67 98999.5,-1324.67 98999.5,-1392.67"/>
<text text-anchor="middle" x="98532" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="98532" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="98532" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="98532" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L10_S1_TP6_GPU14_qkv_slice&#45;&gt;L10_S1_TP6_GPU14_qk_matmul -->
<g id="edge3226" class="edge">
<title>L10_S1_TP6_GPU14_qkv_slice&#45;&gt;L10_S1_TP6_GPU14_qk_matmul</title>
<path fill="none" stroke="black" d="M98269.25,-1428.61C98269.25,-1428.61 98269.25,-1402.8 98269.25,-1402.8"/>
<polygon fill="black" stroke="black" points="98272.75,-1402.8 98269.25,-1392.8 98265.75,-1402.8 98272.75,-1402.8"/>
</g>
<!-- L10_S1_TP6_GPU14_softmax -->
<g id="node1138" class="node">
<title>L10_S1_TP6_GPU14_softmax</title>
<polygon fill="none" stroke="black" points="98680,-1288.67 98170,-1288.67 98170,-1220.67 98680,-1220.67 98680,-1288.67"/>
<text text-anchor="middle" x="98425" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="98425" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="98425" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="98425" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L10_S1_TP6_GPU14_qk_matmul&#45;&gt;L10_S1_TP6_GPU14_softmax -->
<g id="edge3227" class="edge">
<title>L10_S1_TP6_GPU14_qk_matmul&#45;&gt;L10_S1_TP6_GPU14_softmax</title>
<path fill="none" stroke="black" d="M98425,-1324.61C98425,-1324.61 98425,-1298.8 98425,-1298.8"/>
<polygon fill="black" stroke="black" points="98428.5,-1298.8 98425,-1288.8 98421.5,-1298.8 98428.5,-1298.8"/>
</g>
<!-- L10_S1_TP6_GPU14_softmax&#45;&gt;L10_S1_TP6_GPU14_attn_v -->
<g id="edge3228" class="edge">
<title>L10_S1_TP6_GPU14_softmax&#45;&gt;L10_S1_TP6_GPU14_attn_v</title>
<path fill="none" stroke="black" d="M98425,-1220.61C98425,-1220.61 98425,-1194.8 98425,-1194.8"/>
<polygon fill="black" stroke="black" points="98428.5,-1194.8 98425,-1184.8 98421.5,-1194.8 98428.5,-1194.8"/>
</g>
<!-- L10_S1_TP6_GPU14_mha_res -->
<g id="node1140" class="node">
<title>L10_S1_TP6_GPU14_mha_res</title>
<polygon fill="none" stroke="black" points="98966.5,-948.5 98079.5,-948.5 98079.5,-880.5 98966.5,-880.5 98966.5,-948.5"/>
<text text-anchor="middle" x="98523" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="98523" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="98523" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="98523" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP6_GPU14_mha_ar&#45;&gt;L10_S1_TP6_GPU14_mha_res -->
<g id="edge3238" class="edge">
<title>L10_S1_TP6_GPU14_mha_ar&#45;&gt;L10_S1_TP6_GPU14_mha_res</title>
<path fill="none" stroke="black" d="M98102.99,-1015.66C98102.99,-1015.66 98102.99,-958.91 98102.99,-958.91"/>
<polygon fill="black" stroke="black" points="98106.49,-958.91 98102.99,-948.91 98099.49,-958.91 98106.49,-958.91"/>
</g>
<!-- L10_S1_TP6_GPU14_gate -->
<g id="node1141" class="node">
<title>L10_S1_TP6_GPU14_gate</title>
<polygon fill="none" stroke="black" points="99052.56,-844.5 98210.15,-844.5 97993.44,-708.5 98835.85,-708.5 99052.56,-844.5"/>
<text text-anchor="middle" x="98523" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="98523" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="98523" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="98523" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L10_S1_TP6_GPU14_mha_res&#45;&gt;L10_S1_TP6_GPU14_gate -->
<g id="edge3239" class="edge">
<title>L10_S1_TP6_GPU14_mha_res&#45;&gt;L10_S1_TP6_GPU14_gate</title>
<path fill="none" stroke="black" d="M98523,-880.39C98523,-880.39 98523,-854.73 98523,-854.73"/>
<polygon fill="black" stroke="black" points="98526.5,-854.73 98523,-844.73 98519.5,-854.73 98526.5,-854.73"/>
</g>
<!-- L10_S1_TP6_GPU14_moe_res -->
<g id="node1143" class="node">
<title>L10_S1_TP6_GPU14_moe_res</title>
<polygon fill="none" stroke="black" points="99531,-436.33 98711,-436.33 98711,-368.33 99531,-368.33 99531,-436.33"/>
<text text-anchor="middle" x="99121" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="99121" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="99121" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="99121" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP6_GPU14_mha_res&#45;&gt;L10_S1_TP6_GPU14_moe_res -->
<g id="edge3259" class="edge">
<title>L10_S1_TP6_GPU14_mha_res&#45;&gt;L10_S1_TP6_GPU14_moe_res</title>
<path fill="none" stroke="black" d="M98966.57,-914C99023.27,-914 99062,-914 99062,-914 99062,-914 99062,-694 99062,-694 99062,-694 99096.5,-694 99096.5,-694 99096.5,-694 99096.5,-446.36 99096.5,-446.36"/>
<polygon fill="black" stroke="black" points="99100,-446.36 99096.5,-436.36 99093,-446.36 99100,-446.36"/>
</g>
<!-- L10_S1_TP6_GPU14_gate&#45;&gt;L10_S1_TP6_GPU14_expert0 -->
<g id="edge3240" class="edge">
<title>L10_S1_TP6_GPU14_gate&#45;&gt;L10_S1_TP6_GPU14_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M98073.36,-708.31C98073.36,-708.31 98073.36,-682.71 98073.36,-682.71"/>
<polygon fill="black" stroke="black" points="98076.86,-682.71 98073.36,-672.71 98069.86,-682.71 98076.86,-682.71"/>
</g>
<!-- L10_S1_TP6_GPU14_gate&#45;&gt;L10_S1_TP6_GPU14_expert1 -->
<g id="edge3241" class="edge">
<title>L10_S1_TP6_GPU14_gate&#45;&gt;L10_S1_TP6_GPU14_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M98396,-708.31C98396,-708.31 98396,-682.71 98396,-682.71"/>
<polygon fill="black" stroke="black" points="98399.5,-682.71 98396,-672.71 98392.5,-682.71 98399.5,-682.71"/>
</g>
<!-- L10_S1_TP6_GPU14_moe_ar&#45;&gt;L10_S1_TP6_GPU14_moe_res -->
<g id="edge3258" class="edge">
<title>L10_S1_TP6_GPU14_moe_ar&#45;&gt;L10_S1_TP6_GPU14_moe_res</title>
<path fill="none" stroke="black" d="M97684.23,-476.31C97684.23,-456.72 97684.23,-438 97684.23,-438 97684.23,-438 98899.25,-438 98899.25,-438 98899.25,-438 98899.25,-437.85 98899.25,-437.85"/>
<polygon fill="black" stroke="black" points="98902.75,-446.47 98899.25,-436.47 98895.75,-446.47 98902.75,-446.47"/>
</g>
<!-- L10_S1_TP6_GPU14_norm -->
<g id="node1144" class="node">
<title>L10_S1_TP6_GPU14_norm</title>
<polygon fill="none" stroke="black" points="99345.5,-332.33 98896.5,-332.33 98896.5,-264.33 99345.5,-264.33 99345.5,-332.33"/>
<text text-anchor="middle" x="99121" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="99121" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="99121" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="99121" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP6_GPU14_moe_res&#45;&gt;L10_S1_TP6_GPU14_norm -->
<g id="edge3260" class="edge">
<title>L10_S1_TP6_GPU14_moe_res&#45;&gt;L10_S1_TP6_GPU14_norm</title>
<path fill="none" stroke="black" d="M99121,-368.28C99121,-368.28 99121,-342.46 99121,-342.46"/>
<polygon fill="black" stroke="black" points="99124.5,-342.46 99121,-332.46 99117.5,-342.46 99124.5,-342.46"/>
</g>
<!-- L10_S1_TP7_GPU15_qkv_linear -->
<g id="node1145" class="node">
<title>L10_S1_TP7_GPU15_qkv_linear</title>
<polygon fill="none" stroke="black" points="99654,-1614.75 99046,-1614.75 99046,-1546.75 99654,-1546.75 99654,-1614.75"/>
<text text-anchor="middle" x="99350" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="99350" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="99350" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="99350" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L10_S1_TP7_GPU15_qkv_slice -->
<g id="node1146" class="node">
<title>L10_S1_TP7_GPU15_qkv_slice</title>
<polygon fill="none" stroke="black" points="99648,-1496.67 99052,-1496.67 99052,-1428.67 99648,-1428.67 99648,-1496.67"/>
<text text-anchor="middle" x="99350" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="99350" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="99350" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="99350" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L10_S1_TP7_GPU15_qkv_linear&#45;&gt;L10_S1_TP7_GPU15_qkv_slice -->
<g id="edge3261" class="edge">
<title>L10_S1_TP7_GPU15_qkv_linear&#45;&gt;L10_S1_TP7_GPU15_qkv_slice</title>
<path fill="none" stroke="black" d="M99350,-1546.59C99350,-1546.59 99350,-1506.74 99350,-1506.74"/>
<polygon fill="black" stroke="black" points="99353.5,-1506.74 99350,-1496.74 99346.5,-1506.74 99353.5,-1506.74"/>
</g>
<!-- L10_S1_TP7_GPU15_qkv_slice&#45;&gt;L10_S1_TP7_GPU15_attn_v -->
<g id="edge3265" class="edge">
<title>L10_S1_TP7_GPU15_qkv_slice&#45;&gt;L10_S1_TP7_GPU15_attn_v</title>
<path fill="none" stroke="black" d="M99091.25,-1428.38C99091.25,-1428.38 99091.25,-1195 99091.25,-1195"/>
<polygon fill="black" stroke="black" points="99094.75,-1195 99091.25,-1185 99087.75,-1195 99094.75,-1195"/>
</g>
<!-- L10_S1_TP7_GPU15_qk_matmul -->
<g id="node1147" class="node">
<title>L10_S1_TP7_GPU15_qk_matmul</title>
<polygon fill="none" stroke="black" points="100065.5,-1392.67 99130.5,-1392.67 99130.5,-1324.67 100065.5,-1324.67 100065.5,-1392.67"/>
<text text-anchor="middle" x="99598" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="99598" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="99598" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="99598" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L10_S1_TP7_GPU15_qkv_slice&#45;&gt;L10_S1_TP7_GPU15_qk_matmul -->
<g id="edge3262" class="edge">
<title>L10_S1_TP7_GPU15_qkv_slice&#45;&gt;L10_S1_TP7_GPU15_qk_matmul</title>
<path fill="none" stroke="black" d="M99389.25,-1428.61C99389.25,-1428.61 99389.25,-1402.8 99389.25,-1402.8"/>
<polygon fill="black" stroke="black" points="99392.75,-1402.8 99389.25,-1392.8 99385.75,-1402.8 99392.75,-1402.8"/>
</g>
<!-- L10_S1_TP7_GPU15_softmax -->
<g id="node1148" class="node">
<title>L10_S1_TP7_GPU15_softmax</title>
<polygon fill="none" stroke="black" points="99746,-1288.67 99236,-1288.67 99236,-1220.67 99746,-1220.67 99746,-1288.67"/>
<text text-anchor="middle" x="99491" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="99491" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="99491" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="99491" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L10_S1_TP7_GPU15_qk_matmul&#45;&gt;L10_S1_TP7_GPU15_softmax -->
<g id="edge3263" class="edge">
<title>L10_S1_TP7_GPU15_qk_matmul&#45;&gt;L10_S1_TP7_GPU15_softmax</title>
<path fill="none" stroke="black" d="M99491,-1324.61C99491,-1324.61 99491,-1298.8 99491,-1298.8"/>
<polygon fill="black" stroke="black" points="99494.5,-1298.8 99491,-1288.8 99487.5,-1298.8 99494.5,-1298.8"/>
</g>
<!-- L10_S1_TP7_GPU15_softmax&#45;&gt;L10_S1_TP7_GPU15_attn_v -->
<g id="edge3264" class="edge">
<title>L10_S1_TP7_GPU15_softmax&#45;&gt;L10_S1_TP7_GPU15_attn_v</title>
<path fill="none" stroke="black" d="M99440,-1220.61C99440,-1220.61 99440,-1194.8 99440,-1194.8"/>
<polygon fill="black" stroke="black" points="99443.5,-1194.8 99440,-1184.8 99436.5,-1194.8 99443.5,-1194.8"/>
</g>
<!-- L10_S1_TP7_GPU15_mha_res -->
<g id="node1150" class="node">
<title>L10_S1_TP7_GPU15_mha_res</title>
<polygon fill="none" stroke="black" points="100044.5,-948.5 99157.5,-948.5 99157.5,-880.5 100044.5,-880.5 100044.5,-948.5"/>
<text text-anchor="middle" x="99601" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="99601" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="99601" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="99601" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP7_GPU15_mha_ar&#45;&gt;L10_S1_TP7_GPU15_mha_res -->
<g id="edge3274" class="edge">
<title>L10_S1_TP7_GPU15_mha_ar&#45;&gt;L10_S1_TP7_GPU15_mha_res</title>
<path fill="none" stroke="black" d="M98872.53,-1016C99117.7,-1016 99400.75,-1016 99400.75,-1016 99400.75,-1016 99400.75,-958.58 99400.75,-958.58"/>
<polygon fill="black" stroke="black" points="99404.25,-958.58 99400.75,-948.58 99397.25,-958.58 99404.25,-958.58"/>
</g>
<!-- L10_S1_TP7_GPU15_gate -->
<g id="node1151" class="node">
<title>L10_S1_TP7_GPU15_gate</title>
<polygon fill="none" stroke="black" points="100130.56,-844.5 99288.15,-844.5 99071.44,-708.5 99913.85,-708.5 100130.56,-844.5"/>
<text text-anchor="middle" x="99601" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="99601" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="99601" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="99601" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L10_S1_TP7_GPU15_mha_res&#45;&gt;L10_S1_TP7_GPU15_gate -->
<g id="edge3275" class="edge">
<title>L10_S1_TP7_GPU15_mha_res&#45;&gt;L10_S1_TP7_GPU15_gate</title>
<path fill="none" stroke="black" d="M99601,-880.39C99601,-880.39 99601,-854.73 99601,-854.73"/>
<polygon fill="black" stroke="black" points="99604.5,-854.73 99601,-844.73 99597.5,-854.73 99604.5,-854.73"/>
</g>
<!-- L10_S1_TP7_GPU15_moe_res -->
<g id="node1153" class="node">
<title>L10_S1_TP7_GPU15_moe_res</title>
<polygon fill="none" stroke="black" points="100446,-436.33 99626,-436.33 99626,-368.33 100446,-368.33 100446,-436.33"/>
<text text-anchor="middle" x="100036" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="100036" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="100036" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="100036" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP7_GPU15_mha_res&#45;&gt;L10_S1_TP7_GPU15_moe_res -->
<g id="edge3295" class="edge">
<title>L10_S1_TP7_GPU15_mha_res&#45;&gt;L10_S1_TP7_GPU15_moe_res</title>
<path fill="none" stroke="black" d="M100044.59,-925C100177.39,-925 100288.39,-925 100288.39,-925 100288.39,-925 100288.39,-446.63 100288.39,-446.63"/>
<polygon fill="black" stroke="black" points="100291.89,-446.63 100288.39,-436.63 100284.89,-446.63 100291.89,-446.63"/>
</g>
<!-- L10_S1_TP7_GPU15_gate&#45;&gt;L10_S1_TP7_GPU15_expert0 -->
<g id="edge3276" class="edge">
<title>L10_S1_TP7_GPU15_gate&#45;&gt;L10_S1_TP7_GPU15_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M99079.36,-776.4C99079.36,-776.4 99079.36,-682.74 99079.36,-682.74"/>
<polygon fill="black" stroke="black" points="99082.86,-682.74 99079.36,-672.74 99075.86,-682.74 99082.86,-682.74"/>
</g>
<!-- L10_S1_TP7_GPU15_gate&#45;&gt;L10_S1_TP7_GPU15_expert1 -->
<g id="edge3277" class="edge">
<title>L10_S1_TP7_GPU15_gate&#45;&gt;L10_S1_TP7_GPU15_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M99404.83,-708.31C99404.83,-708.31 99404.83,-682.71 99404.83,-682.71"/>
<polygon fill="black" stroke="black" points="99408.33,-682.71 99404.83,-672.71 99401.33,-682.71 99408.33,-682.71"/>
</g>
<!-- L10_S1_TP7_GPU15_moe_ar&#45;&gt;L10_S1_TP7_GPU15_moe_res -->
<g id="edge3294" class="edge">
<title>L10_S1_TP7_GPU15_moe_ar&#45;&gt;L10_S1_TP7_GPU15_moe_res</title>
<path fill="none" stroke="black" d="M98563.69,-527C99044.54,-527 99878.39,-527 99878.39,-527 99878.39,-527 99878.39,-446.4 99878.39,-446.4"/>
<polygon fill="black" stroke="black" points="99881.89,-446.4 99878.39,-436.4 99874.89,-446.4 99881.89,-446.4"/>
</g>
<!-- L10_S1_TP7_GPU15_norm -->
<g id="node1154" class="node">
<title>L10_S1_TP7_GPU15_norm</title>
<polygon fill="none" stroke="black" points="100260.5,-332.33 99811.5,-332.33 99811.5,-264.33 100260.5,-264.33 100260.5,-332.33"/>
<text text-anchor="middle" x="100036" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="100036" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="100036" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="100036" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L10_S1_TP7_GPU15_moe_res&#45;&gt;L10_S1_TP7_GPU15_norm -->
<g id="edge3296" class="edge">
<title>L10_S1_TP7_GPU15_moe_res&#45;&gt;L10_S1_TP7_GPU15_norm</title>
<path fill="none" stroke="black" d="M100036,-368.28C100036,-368.28 100036,-342.46 100036,-342.46"/>
<polygon fill="black" stroke="black" points="100039.5,-342.46 100036,-332.46 100032.5,-342.46 100039.5,-342.46"/>
</g>
<!-- L11_S1_TP0_GPU8_qkv_linear -->
<g id="node1155" class="node">
<title>L11_S1_TP0_GPU8_qkv_linear</title>
<polygon fill="none" stroke="black" points="101409,-1614.75 100801,-1614.75 100801,-1546.75 101409,-1546.75 101409,-1614.75"/>
<text text-anchor="middle" x="101105" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="101105" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="101105" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="101105" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L11_S1_TP0_GPU8_qkv_slice -->
<g id="node1156" class="node">
<title>L11_S1_TP0_GPU8_qkv_slice</title>
<polygon fill="none" stroke="black" points="101403,-1496.67 100807,-1496.67 100807,-1428.67 101403,-1428.67 101403,-1496.67"/>
<text text-anchor="middle" x="101105" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="101105" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="101105" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="101105" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L11_S1_TP0_GPU8_qkv_linear&#45;&gt;L11_S1_TP0_GPU8_qkv_slice -->
<g id="edge3297" class="edge">
<title>L11_S1_TP0_GPU8_qkv_linear&#45;&gt;L11_S1_TP0_GPU8_qkv_slice</title>
<path fill="none" stroke="black" d="M101105,-1546.59C101105,-1546.59 101105,-1506.74 101105,-1506.74"/>
<polygon fill="black" stroke="black" points="101108.5,-1506.74 101105,-1496.74 101101.5,-1506.74 101108.5,-1506.74"/>
</g>
<!-- L11_S1_TP0_GPU8_qk_matmul -->
<g id="node1157" class="node">
<title>L11_S1_TP0_GPU8_qk_matmul</title>
<polygon fill="none" stroke="black" points="101877.5,-1392.67 100942.5,-1392.67 100942.5,-1324.67 101877.5,-1324.67 101877.5,-1392.67"/>
<text text-anchor="middle" x="101410" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="101410" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="101410" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="101410" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L11_S1_TP0_GPU8_qkv_slice&#45;&gt;L11_S1_TP0_GPU8_qk_matmul -->
<g id="edge3298" class="edge">
<title>L11_S1_TP0_GPU8_qkv_slice&#45;&gt;L11_S1_TP0_GPU8_qk_matmul</title>
<path fill="none" stroke="black" d="M101172.75,-1428.61C101172.75,-1428.61 101172.75,-1402.8 101172.75,-1402.8"/>
<polygon fill="black" stroke="black" points="101176.25,-1402.8 101172.75,-1392.8 101169.25,-1402.8 101176.25,-1402.8"/>
</g>
<!-- L11_S1_TP0_GPU8_attn_v -->
<g id="node1159" class="node">
<title>L11_S1_TP0_GPU8_attn_v</title>
<polygon fill="none" stroke="black" points="101878,-1184.67 100940,-1184.67 100940,-1116.67 101878,-1116.67 101878,-1184.67"/>
<text text-anchor="middle" x="101409" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="101409" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="101409" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="101409" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L11_S1_TP0_GPU8_qkv_slice&#45;&gt;L11_S1_TP0_GPU8_attn_v -->
<g id="edge3301" class="edge">
<title>L11_S1_TP0_GPU8_qkv_slice&#45;&gt;L11_S1_TP0_GPU8_attn_v</title>
<path fill="none" stroke="black" d="M100873.5,-1428.61C100873.5,-1347.57 100873.5,-1150 100873.5,-1150 100873.5,-1150 100929.97,-1150 100929.97,-1150"/>
<polygon fill="black" stroke="black" points="100929.97,-1153.5 100939.97,-1150 100929.97,-1146.5 100929.97,-1153.5"/>
</g>
<!-- L11_S1_TP0_GPU8_softmax -->
<g id="node1158" class="node">
<title>L11_S1_TP0_GPU8_softmax</title>
<polygon fill="none" stroke="black" points="101664,-1288.67 101154,-1288.67 101154,-1220.67 101664,-1220.67 101664,-1288.67"/>
<text text-anchor="middle" x="101409" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="101409" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="101409" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="101409" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L11_S1_TP0_GPU8_qk_matmul&#45;&gt;L11_S1_TP0_GPU8_softmax -->
<g id="edge3299" class="edge">
<title>L11_S1_TP0_GPU8_qk_matmul&#45;&gt;L11_S1_TP0_GPU8_softmax</title>
<path fill="none" stroke="black" d="M101409,-1324.61C101409,-1324.61 101409,-1298.8 101409,-1298.8"/>
<polygon fill="black" stroke="black" points="101412.5,-1298.8 101409,-1288.8 101405.5,-1298.8 101412.5,-1298.8"/>
</g>
<!-- L11_S1_TP0_GPU8_softmax&#45;&gt;L11_S1_TP0_GPU8_attn_v -->
<g id="edge3300" class="edge">
<title>L11_S1_TP0_GPU8_softmax&#45;&gt;L11_S1_TP0_GPU8_attn_v</title>
<path fill="none" stroke="black" d="M101409,-1220.61C101409,-1220.61 101409,-1194.8 101409,-1194.8"/>
<polygon fill="black" stroke="black" points="101412.5,-1194.8 101409,-1184.8 101405.5,-1194.8 101412.5,-1194.8"/>
</g>
<!-- L11_S1_TP0_GPU8_mha_ar -->
<g id="node1160" class="node">
<title>L11_S1_TP0_GPU8_mha_ar</title>
<ellipse fill="none" stroke="black" cx="102064" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="102064" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="102064" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="102064" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="102064" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP0_GPU8_attn_v&#45;&gt;L11_S1_TP0_GPU8_mha_ar -->
<g id="edge3302" class="edge">
<title>L11_S1_TP0_GPU8_attn_v&#45;&gt;L11_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M101720.11,-1116.51C101720.11,-1116.51 101720.11,-1061.95 101720.11,-1061.95"/>
<polygon fill="black" stroke="black" points="101723.61,-1061.95 101720.11,-1051.95 101716.61,-1061.95 101723.61,-1061.95"/>
</g>
<!-- L11_S1_TP1_GPU9_mha_ar -->
<g id="node1193" class="node">
<title>L11_S1_TP1_GPU9_mha_ar</title>
<ellipse fill="none" stroke="black" cx="102833" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="102833" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="102833" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="102833" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="102833" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP0_GPU8_attn_v&#45;&gt;L11_S1_TP1_GPU9_mha_ar -->
<g id="edge3338" class="edge">
<title>L11_S1_TP0_GPU8_attn_v&#45;&gt;L11_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M101751.68,-1116.43C101751.68,-1102.67 101751.68,-1090 101751.68,-1090 101751.68,-1090 102504.59,-1090 102504.59,-1090 102504.59,-1090 102504.59,-1065.94 102504.59,-1065.94"/>
<polygon fill="black" stroke="black" points="102508.09,-1065.94 102504.59,-1055.94 102501.09,-1065.94 102508.09,-1065.94"/>
</g>
<!-- L11_S1_TP2_GPU10_mha_ar -->
<g id="node1203" class="node">
<title>L11_S1_TP2_GPU10_mha_ar</title>
<ellipse fill="none" stroke="black" cx="103602" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="103602" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="103602" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="103602" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="103602" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP0_GPU8_attn_v&#45;&gt;L11_S1_TP2_GPU10_mha_ar -->
<g id="edge3374" class="edge">
<title>L11_S1_TP0_GPU8_attn_v&#45;&gt;L11_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M101783.26,-1116.43C101783.26,-1102.67 101783.26,-1090 101783.26,-1090 101783.26,-1090 103296.96,-1090 103296.96,-1090 103296.96,-1090 103296.96,-1070.95 103296.96,-1070.95"/>
<polygon fill="black" stroke="black" points="103300.46,-1070.95 103296.96,-1060.95 103293.46,-1070.96 103300.46,-1070.95"/>
</g>
<!-- L11_S1_TP3_GPU11_mha_ar -->
<g id="node1213" class="node">
<title>L11_S1_TP3_GPU11_mha_ar</title>
<ellipse fill="none" stroke="black" cx="104371" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="104371" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="104371" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="104371" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="104371" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP0_GPU8_attn_v&#45;&gt;L11_S1_TP3_GPU11_mha_ar -->
<g id="edge3410" class="edge">
<title>L11_S1_TP0_GPU8_attn_v&#45;&gt;L11_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M101814.84,-1116.65C101814.84,-1103.25 101814.84,-1091 101814.84,-1091 101814.84,-1091 104102.74,-1091 104102.74,-1091 104102.74,-1091 104102.74,-1076.23 104102.74,-1076.23"/>
<polygon fill="black" stroke="black" points="104106.24,-1076.23 104102.74,-1066.23 104099.24,-1076.23 104106.24,-1076.23"/>
</g>
<!-- L11_S1_TP4_GPU12_mha_ar -->
<g id="node1223" class="node">
<title>L11_S1_TP4_GPU12_mha_ar</title>
<ellipse fill="none" stroke="black" cx="105140" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="105140" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="105140" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="105140" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="105140" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP0_GPU8_attn_v&#45;&gt;L11_S1_TP4_GPU12_mha_ar -->
<g id="edge3446" class="edge">
<title>L11_S1_TP0_GPU8_attn_v&#45;&gt;L11_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M101653.01,-1116.34C101653.01,-1066.24 101653.01,-979 101653.01,-979 101653.01,-979 104822.74,-979 104822.74,-979 104822.74,-979 104822.74,-996.73 104822.74,-996.73"/>
<polygon fill="black" stroke="black" points="104819.24,-996.73 104822.74,-1006.73 104826.24,-996.73 104819.24,-996.73"/>
</g>
<!-- L11_S1_TP5_GPU13_mha_ar -->
<g id="node1233" class="node">
<title>L11_S1_TP5_GPU13_mha_ar</title>
<ellipse fill="none" stroke="black" cx="105909" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="105909" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="105909" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="105909" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="105909" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP0_GPU8_attn_v&#45;&gt;L11_S1_TP5_GPU13_mha_ar -->
<g id="edge3482" class="edge">
<title>L11_S1_TP0_GPU8_attn_v&#45;&gt;L11_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M101806.33,-1184.72C101806.33,-1200.15 101806.33,-1215 101806.33,-1215 101806.33,-1215 105715.5,-1215 105715.5,-1215 105715.5,-1215 105715.5,-1083.98 105715.5,-1083.98"/>
<polygon fill="black" stroke="black" points="105719,-1083.98 105715.5,-1073.98 105712,-1083.98 105719,-1083.98"/>
</g>
<!-- L11_S1_TP6_GPU14_mha_ar -->
<g id="node1243" class="node">
<title>L11_S1_TP6_GPU14_mha_ar</title>
<ellipse fill="none" stroke="black" cx="106678" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="106678" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="106678" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="106678" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="106678" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP0_GPU8_attn_v&#45;&gt;L11_S1_TP6_GPU14_mha_ar -->
<g id="edge3518" class="edge">
<title>L11_S1_TP0_GPU8_attn_v&#45;&gt;L11_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M101735.17,-1184.83C101735.17,-1201.92 101735.17,-1219 101735.17,-1219 101735.17,-1219 106670,-1219 106670,-1219 106670,-1219 106670,-1091.08 106670,-1091.08"/>
<polygon fill="black" stroke="black" points="106673.5,-1091.08 106670,-1081.08 106666.5,-1091.08 106673.5,-1091.08"/>
</g>
<!-- L11_S1_TP7_GPU15_mha_ar -->
<g id="node1253" class="node">
<title>L11_S1_TP7_GPU15_mha_ar</title>
<ellipse fill="none" stroke="black" cx="107447" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="107447" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="107447" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="107447" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="107447" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP0_GPU8_attn_v&#45;&gt;L11_S1_TP7_GPU15_mha_ar -->
<g id="edge3554" class="edge">
<title>L11_S1_TP0_GPU8_attn_v&#45;&gt;L11_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M101846.42,-1116.26C101846.42,-1110.85 101846.42,-1107 101846.42,-1107 101846.42,-1107 107139.34,-1107 107139.34,-1107 107139.34,-1107 107139.34,-1070.29 107139.34,-1070.29"/>
<polygon fill="black" stroke="black" points="107142.84,-1070.29 107139.34,-1060.29 107135.84,-1070.29 107142.84,-1070.29"/>
</g>
<!-- L11_S1_TP0_GPU8_mha_res -->
<g id="node1168" class="node">
<title>L11_S1_TP0_GPU8_mha_res</title>
<polygon fill="none" stroke="black" points="101426.5,-948.5 100539.5,-948.5 100539.5,-880.5 101426.5,-880.5 101426.5,-948.5"/>
<text text-anchor="middle" x="100983" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="100983" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="100983" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="100983" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP0_GPU8_mha_ar&#45;&gt;L11_S1_TP0_GPU8_mha_res -->
<g id="edge3310" class="edge">
<title>L11_S1_TP0_GPU8_mha_ar&#45;&gt;L11_S1_TP0_GPU8_mha_res</title>
<path fill="none" stroke="black" d="M101708.3,-1048C101463.86,-1048 101183.25,-1048 101183.25,-1048 101183.25,-1048 101183.25,-958.53 101183.25,-958.53"/>
<polygon fill="black" stroke="black" points="101186.75,-958.53 101183.25,-948.53 101179.75,-958.53 101186.75,-958.53"/>
</g>
<!-- L11_S1_TP1_GPU9_attn_v -->
<g id="node1161" class="node">
<title>L11_S1_TP1_GPU9_attn_v</title>
<polygon fill="none" stroke="black" points="102834,-1184.67 101896,-1184.67 101896,-1116.67 102834,-1116.67 102834,-1184.67"/>
<text text-anchor="middle" x="102365" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="102365" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="102365" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="102365" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L11_S1_TP1_GPU9_attn_v&#45;&gt;L11_S1_TP0_GPU8_mha_ar -->
<g id="edge3303" class="edge">
<title>L11_S1_TP1_GPU9_attn_v&#45;&gt;L11_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M101963.93,-1116.51C101963.93,-1116.51 101963.93,-1088.96 101963.93,-1088.96"/>
<polygon fill="black" stroke="black" points="101967.43,-1088.96 101963.93,-1078.96 101960.43,-1088.96 101967.43,-1088.96"/>
</g>
<!-- L11_S1_TP1_GPU9_attn_v&#45;&gt;L11_S1_TP1_GPU9_mha_ar -->
<g id="edge3339" class="edge">
<title>L11_S1_TP1_GPU9_attn_v&#45;&gt;L11_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M102551.64,-1116.51C102551.64,-1116.51 102551.64,-1074.64 102551.64,-1074.64"/>
<polygon fill="black" stroke="black" points="102555.14,-1074.64 102551.64,-1064.64 102548.14,-1074.64 102555.14,-1074.64"/>
</g>
<!-- L11_S1_TP1_GPU9_attn_v&#45;&gt;L11_S1_TP2_GPU10_mha_ar -->
<g id="edge3375" class="edge">
<title>L11_S1_TP1_GPU9_attn_v&#45;&gt;L11_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M102598.7,-1116.43C102598.7,-1102.67 102598.7,-1090 102598.7,-1090 102598.7,-1090 103367.39,-1090 103367.39,-1090 103367.39,-1090 103367.39,-1080.24 103367.39,-1080.24"/>
<polygon fill="black" stroke="black" points="103370.89,-1080.24 103367.39,-1070.24 103363.89,-1080.24 103370.89,-1080.24"/>
</g>
<!-- L11_S1_TP1_GPU9_attn_v&#45;&gt;L11_S1_TP3_GPU11_mha_ar -->
<g id="edge3411" class="edge">
<title>L11_S1_TP1_GPU9_attn_v&#45;&gt;L11_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M102645.76,-1116.65C102645.76,-1103.25 102645.76,-1091 102645.76,-1091 102645.76,-1091 104209.95,-1091 104209.95,-1091 104209.95,-1091 104209.95,-1086.26 104209.95,-1086.26"/>
<polygon fill="black" stroke="black" points="104213.45,-1086.26 104209.95,-1076.26 104206.45,-1086.26 104213.45,-1086.26"/>
</g>
<!-- L11_S1_TP1_GPU9_attn_v&#45;&gt;L11_S1_TP4_GPU12_mha_ar -->
<g id="edge3447" class="edge">
<title>L11_S1_TP1_GPU9_attn_v&#45;&gt;L11_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M102448.5,-1116.34C102448.5,-1066.24 102448.5,-979 102448.5,-979 102448.5,-979 104793.98,-979 104793.98,-979 104793.98,-979 104793.98,-1003.84 104793.98,-1003.84"/>
<polygon fill="black" stroke="black" points="104790.48,-1003.84 104793.98,-1013.84 104797.48,-1003.84 104790.48,-1003.84"/>
</g>
<!-- L11_S1_TP1_GPU9_attn_v&#45;&gt;L11_S1_TP5_GPU13_mha_ar -->
<g id="edge3483" class="edge">
<title>L11_S1_TP1_GPU9_attn_v&#45;&gt;L11_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M102692.82,-1116.26C102692.82,-1110.85 102692.82,-1107 102692.82,-1107 102692.82,-1107 105567.22,-1107 105567.22,-1107 105567.22,-1107 105567.22,-1062.53 105567.22,-1062.53"/>
<polygon fill="black" stroke="black" points="105570.72,-1062.53 105567.22,-1052.53 105563.72,-1062.53 105570.72,-1062.53"/>
</g>
<!-- L11_S1_TP1_GPU9_attn_v&#45;&gt;L11_S1_TP6_GPU14_mha_ar -->
<g id="edge3519" class="edge">
<title>L11_S1_TP1_GPU9_attn_v&#45;&gt;L11_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M102739.88,-1116.26C102739.88,-1110.85 102739.88,-1107 102739.88,-1107 102739.88,-1107 106361.77,-1107 106361.77,-1107 106361.77,-1107 106361.77,-1068.61 106361.77,-1068.61"/>
<polygon fill="black" stroke="black" points="106365.27,-1068.61 106361.77,-1058.61 106358.27,-1068.61 106365.27,-1068.61"/>
</g>
<!-- L11_S1_TP1_GPU9_attn_v&#45;&gt;L11_S1_TP7_GPU15_mha_ar -->
<g id="edge3555" class="edge">
<title>L11_S1_TP1_GPU9_attn_v&#45;&gt;L11_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M102786.94,-1116.26C102786.94,-1110.85 102786.94,-1107 102786.94,-1107 102786.94,-1107 107207.14,-1107 107207.14,-1107 107207.14,-1107 107207.14,-1079.79 107207.14,-1079.79"/>
<polygon fill="black" stroke="black" points="107210.64,-1079.79 107207.14,-1069.79 107203.64,-1079.79 107210.64,-1079.79"/>
</g>
<!-- L11_S1_TP2_GPU10_attn_v -->
<g id="node1162" class="node">
<title>L11_S1_TP2_GPU10_attn_v</title>
<polygon fill="none" stroke="black" points="103790,-1184.67 102852,-1184.67 102852,-1116.67 103790,-1116.67 103790,-1184.67"/>
<text text-anchor="middle" x="103321" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="103321" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="103321" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="103321" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L11_S1_TP2_GPU10_attn_v&#45;&gt;L11_S1_TP0_GPU8_mha_ar -->
<g id="edge3304" class="edge">
<title>L11_S1_TP2_GPU10_attn_v&#45;&gt;L11_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M102902.92,-1116.63C102902.92,-1111.57 102902.92,-1108 102902.92,-1108 102902.92,-1108 102031.87,-1108 102031.87,-1108 102031.87,-1108 102031.87,-1090.77 102031.87,-1090.77"/>
<polygon fill="black" stroke="black" points="102035.37,-1090.77 102031.87,-1080.77 102028.37,-1090.77 102035.37,-1090.77"/>
</g>
<!-- L11_S1_TP2_GPU10_attn_v&#45;&gt;L11_S1_TP1_GPU9_mha_ar -->
<g id="edge3340" class="edge">
<title>L11_S1_TP2_GPU10_attn_v&#45;&gt;L11_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M102953.85,-1116.51C102953.85,-1116.51 102953.85,-1088.52 102953.85,-1088.52"/>
<polygon fill="black" stroke="black" points="102957.35,-1088.52 102953.85,-1078.52 102950.35,-1088.52 102957.35,-1088.52"/>
</g>
<!-- L11_S1_TP2_GPU10_attn_v&#45;&gt;L11_S1_TP2_GPU10_mha_ar -->
<g id="edge3376" class="edge">
<title>L11_S1_TP2_GPU10_attn_v&#45;&gt;L11_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M103437.83,-1116.51C103437.83,-1116.51 103437.83,-1085.92 103437.83,-1085.92"/>
<polygon fill="black" stroke="black" points="103441.33,-1085.92 103437.83,-1075.92 103434.33,-1085.92 103441.33,-1085.92"/>
</g>
<!-- L11_S1_TP2_GPU10_attn_v&#45;&gt;L11_S1_TP3_GPU11_mha_ar -->
<g id="edge3412" class="edge">
<title>L11_S1_TP2_GPU10_attn_v&#45;&gt;L11_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M103508.26,-1116.65C103508.26,-1103.25 103508.26,-1091 103508.26,-1091 103508.26,-1091 104317.16,-1091 104317.16,-1091 104317.16,-1091 104317.16,-1089.93 104317.16,-1089.93"/>
<polygon fill="black" stroke="black" points="104320.66,-1090.29 104317.16,-1080.29 104313.66,-1090.29 104320.66,-1090.29"/>
</g>
<!-- L11_S1_TP2_GPU10_attn_v&#45;&gt;L11_S1_TP4_GPU12_mha_ar -->
<g id="edge3448" class="edge">
<title>L11_S1_TP2_GPU10_attn_v&#45;&gt;L11_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M103578.7,-1116.26C103578.7,-1110.85 103578.7,-1107 103578.7,-1107 103578.7,-1107 104979.08,-1107 104979.08,-1107 104979.08,-1107 104979.08,-1086.3 104979.08,-1086.3"/>
<polygon fill="black" stroke="black" points="104982.58,-1086.3 104979.08,-1076.3 104975.58,-1086.3 104982.58,-1086.3"/>
</g>
<!-- L11_S1_TP2_GPU10_attn_v&#45;&gt;L11_S1_TP5_GPU13_mha_ar -->
<g id="edge3484" class="edge">
<title>L11_S1_TP2_GPU10_attn_v&#45;&gt;L11_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M103707,-1184.68C103707,-1197.03 103707,-1208 103707,-1208 103707,-1208 105711,-1208 105711,-1208 105711,-1208 105711,-1083.71 105711,-1083.71"/>
<polygon fill="black" stroke="black" points="105714.5,-1083.71 105711,-1073.71 105707.5,-1083.71 105714.5,-1083.71"/>
</g>
<!-- L11_S1_TP2_GPU10_attn_v&#45;&gt;L11_S1_TP6_GPU14_mha_ar -->
<g id="edge3520" class="edge">
<title>L11_S1_TP2_GPU10_attn_v&#45;&gt;L11_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M103649.13,-1116.26C103649.13,-1110.85 103649.13,-1107 103649.13,-1107 103649.13,-1107 106421.02,-1107 106421.02,-1107 106421.02,-1107 106421.02,-1078.05 106421.02,-1078.05"/>
<polygon fill="black" stroke="black" points="106424.52,-1078.05 106421.02,-1068.05 106417.52,-1078.05 106424.52,-1078.05"/>
</g>
<!-- L11_S1_TP2_GPU10_attn_v&#45;&gt;L11_S1_TP7_GPU15_mha_ar -->
<g id="edge3556" class="edge">
<title>L11_S1_TP2_GPU10_attn_v&#45;&gt;L11_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M103719.57,-1116.63C103719.57,-1111.57 103719.57,-1108 103719.57,-1108 103719.57,-1108 107274.95,-1108 107274.95,-1108 107274.95,-1108 107274.95,-1085.58 107274.95,-1085.58"/>
<polygon fill="black" stroke="black" points="107278.45,-1085.58 107274.95,-1075.58 107271.45,-1085.58 107278.45,-1085.58"/>
</g>
<!-- L11_S1_TP3_GPU11_attn_v -->
<g id="node1163" class="node">
<title>L11_S1_TP3_GPU11_attn_v</title>
<polygon fill="none" stroke="black" points="104746,-1184.67 103808,-1184.67 103808,-1116.67 104746,-1116.67 104746,-1184.67"/>
<text text-anchor="middle" x="104277" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="104277" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="104277" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="104277" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L11_S1_TP3_GPU11_attn_v&#45;&gt;L11_S1_TP0_GPU8_mha_ar -->
<g id="edge3305" class="edge">
<title>L11_S1_TP3_GPU11_attn_v&#45;&gt;L11_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M103836.25,-1116.63C103836.25,-1111.57 103836.25,-1108 103836.25,-1108 103836.25,-1108 102099.8,-1108 102099.8,-1108 102099.8,-1108 102099.8,-1090.77 102099.8,-1090.77"/>
<polygon fill="black" stroke="black" points="102103.3,-1090.77 102099.8,-1080.77 102096.3,-1090.77 102103.3,-1090.77"/>
</g>
<!-- L11_S1_TP3_GPU11_attn_v&#45;&gt;L11_S1_TP1_GPU9_mha_ar -->
<g id="edge3341" class="edge">
<title>L11_S1_TP3_GPU11_attn_v&#45;&gt;L11_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M103864.49,-1116.63C103864.49,-1111.57 103864.49,-1108 103864.49,-1108 103864.49,-1108 103004.77,-1108 103004.77,-1108 103004.77,-1108 103004.77,-1085.58 103004.77,-1085.58"/>
<polygon fill="black" stroke="black" points="103008.27,-1085.58 103004.77,-1075.58 103001.27,-1085.58 103008.27,-1085.58"/>
</g>
<!-- L11_S1_TP3_GPU11_attn_v&#45;&gt;L11_S1_TP2_GPU10_mha_ar -->
<g id="edge3377" class="edge">
<title>L11_S1_TP3_GPU11_attn_v&#45;&gt;L11_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M103892.74,-1116.51C103892.74,-1116.51 103892.74,-1073.04 103892.74,-1073.04"/>
<polygon fill="black" stroke="black" points="103896.24,-1073.04 103892.74,-1063.04 103889.24,-1073.04 103896.24,-1073.04"/>
</g>
<!-- L11_S1_TP3_GPU11_attn_v&#45;&gt;L11_S1_TP3_GPU11_mha_ar -->
<g id="edge3413" class="edge">
<title>L11_S1_TP3_GPU11_attn_v&#45;&gt;L11_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M104424.37,-1116.51C104424.37,-1116.51 104424.37,-1090.27 104424.37,-1090.27"/>
<polygon fill="black" stroke="black" points="104427.87,-1090.27 104424.37,-1080.27 104420.87,-1090.27 104427.87,-1090.27"/>
</g>
<!-- L11_S1_TP3_GPU11_attn_v&#45;&gt;L11_S1_TP4_GPU12_mha_ar -->
<g id="edge3449" class="edge">
<title>L11_S1_TP3_GPU11_attn_v&#45;&gt;L11_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M104746.16,-1161C104748.14,-1161 104749.17,-1161 104749.17,-1161 104749.17,-1161 104749.17,-1048 104749.17,-1048 104749.17,-1048 104774.2,-1048 104774.2,-1048"/>
<polygon fill="black" stroke="black" points="104774.2,-1051.5 104784.2,-1048 104774.2,-1044.5 104774.2,-1051.5"/>
</g>
<!-- L11_S1_TP3_GPU11_attn_v&#45;&gt;L11_S1_TP5_GPU13_mha_ar -->
<g id="edge3485" class="edge">
<title>L11_S1_TP3_GPU11_attn_v&#45;&gt;L11_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M104697.33,-1184.8C104697.33,-1189.08 104697.33,-1192 104697.33,-1192 104697.33,-1192 105706.5,-1192 105706.5,-1192 105706.5,-1192 105706.5,-1083.22 105706.5,-1083.22"/>
<polygon fill="black" stroke="black" points="105710,-1083.22 105706.5,-1073.22 105703,-1083.22 105710,-1083.22"/>
</g>
<!-- L11_S1_TP3_GPU11_attn_v&#45;&gt;L11_S1_TP6_GPU14_mha_ar -->
<g id="edge3521" class="edge">
<title>L11_S1_TP3_GPU11_attn_v&#45;&gt;L11_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M104648.67,-1184.8C104648.67,-1193.77 104648.67,-1201 104648.67,-1201 104648.67,-1201 106664,-1201 106664,-1201 106664,-1201 106664,-1090.84 106664,-1090.84"/>
<polygon fill="black" stroke="black" points="106667.5,-1090.84 106664,-1080.84 106660.5,-1090.84 106667.5,-1090.84"/>
</g>
<!-- L11_S1_TP3_GPU11_attn_v&#45;&gt;L11_S1_TP7_GPU15_mha_ar -->
<g id="edge3557" class="edge">
<title>L11_S1_TP3_GPU11_attn_v&#45;&gt;L11_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M104531.58,-1116.63C104531.58,-1111.57 104531.58,-1108 104531.58,-1108 104531.58,-1108 107342.76,-1108 107342.76,-1108 107342.76,-1108 107342.76,-1089.06 107342.76,-1089.06"/>
<polygon fill="black" stroke="black" points="107346.26,-1089.06 107342.76,-1079.06 107339.26,-1089.06 107346.26,-1089.06"/>
</g>
<!-- L11_S1_TP4_GPU12_attn_v -->
<g id="node1164" class="node">
<title>L11_S1_TP4_GPU12_attn_v</title>
<polygon fill="none" stroke="black" points="105702,-1184.67 104764,-1184.67 104764,-1116.67 105702,-1116.67 105702,-1184.67"/>
<text text-anchor="middle" x="105233" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="105233" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="105233" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="105233" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L11_S1_TP4_GPU12_attn_v&#45;&gt;L11_S1_TP0_GPU8_mha_ar -->
<g id="edge3306" class="edge">
<title>L11_S1_TP4_GPU12_attn_v&#45;&gt;L11_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M104871.8,-1116.26C104871.8,-1110.85 104871.8,-1107 104871.8,-1107 104871.8,-1107 102167.74,-1107 102167.74,-1107 102167.74,-1107 102167.74,-1088.87 102167.74,-1088.87"/>
<polygon fill="black" stroke="black" points="102171.24,-1088.87 102167.74,-1078.87 102164.24,-1088.87 102171.24,-1088.87"/>
</g>
<!-- L11_S1_TP4_GPU12_attn_v&#45;&gt;L11_S1_TP1_GPU9_mha_ar -->
<g id="edge3342" class="edge">
<title>L11_S1_TP4_GPU12_attn_v&#45;&gt;L11_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M104842.33,-1184.83C104842.33,-1191.77 104842.33,-1197 104842.33,-1197 104842.33,-1197 102843,-1197 102843,-1197 102843,-1197 102843,-1091.02 102843,-1091.02"/>
<polygon fill="black" stroke="black" points="102846.5,-1091.02 102843,-1081.02 102839.5,-1091.02 102846.5,-1091.02"/>
</g>
<!-- L11_S1_TP4_GPU12_attn_v&#45;&gt;L11_S1_TP2_GPU10_mha_ar -->
<g id="edge3378" class="edge">
<title>L11_S1_TP4_GPU12_attn_v&#45;&gt;L11_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M104803.17,-1185.07C104803.17,-1186.9 104803.17,-1188 104803.17,-1188 104803.17,-1188 103802,-1188 103802,-1188 103802,-1188 103802,-1083.42 103802,-1083.42"/>
<polygon fill="black" stroke="black" points="103805.5,-1083.42 103802,-1073.42 103798.5,-1083.42 103805.5,-1083.42"/>
</g>
<!-- L11_S1_TP4_GPU12_attn_v&#45;&gt;L11_S1_TP3_GPU11_mha_ar -->
<g id="edge3414" class="edge">
<title>L11_S1_TP4_GPU12_attn_v&#45;&gt;L11_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M104763.95,-1139C104755.98,-1139 104751.57,-1139 104751.57,-1139 104751.57,-1139 104751.57,-1016 104751.57,-1016 104751.57,-1016 104733.58,-1016 104733.58,-1016"/>
<polygon fill="black" stroke="black" points="104733.58,-1012.5 104723.58,-1016 104733.58,-1019.5 104733.58,-1012.5"/>
</g>
<!-- L11_S1_TP4_GPU12_attn_v&#45;&gt;L11_S1_TP4_GPU12_mha_ar -->
<g id="edge3450" class="edge">
<title>L11_S1_TP4_GPU12_attn_v&#45;&gt;L11_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M105086.36,-1116.51C105086.36,-1116.51 105086.36,-1090.27 105086.36,-1090.27"/>
<polygon fill="black" stroke="black" points="105089.86,-1090.27 105086.36,-1080.27 105082.86,-1090.27 105089.86,-1090.27"/>
</g>
<!-- L11_S1_TP4_GPU12_attn_v&#45;&gt;L11_S1_TP5_GPU13_mha_ar -->
<g id="edge3486" class="edge">
<title>L11_S1_TP4_GPU12_attn_v&#45;&gt;L11_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M105600.92,-1116.51C105600.92,-1116.51 105600.92,-1070.31 105600.92,-1070.31"/>
<polygon fill="black" stroke="black" points="105604.42,-1070.31 105600.92,-1060.31 105597.42,-1070.31 105604.42,-1070.31"/>
</g>
<!-- L11_S1_TP4_GPU12_attn_v&#45;&gt;L11_S1_TP6_GPU14_mha_ar -->
<g id="edge3522" class="edge">
<title>L11_S1_TP4_GPU12_attn_v&#45;&gt;L11_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M105634.61,-1116.53C105634.61,-1115.56 105634.61,-1115 105634.61,-1115 105634.61,-1115 106480.26,-1115 106480.26,-1115 106480.26,-1115 106480.26,-1083.79 106480.26,-1083.79"/>
<polygon fill="black" stroke="black" points="106483.76,-1083.79 106480.26,-1073.79 106476.76,-1083.79 106483.76,-1083.79"/>
</g>
<!-- L11_S1_TP4_GPU12_attn_v&#45;&gt;L11_S1_TP7_GPU15_mha_ar -->
<g id="edge3558" class="edge">
<title>L11_S1_TP4_GPU12_attn_v&#45;&gt;L11_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M105668.31,-1116.53C105668.31,-1115.56 105668.31,-1115 105668.31,-1115 105668.31,-1115 107410.57,-1115 107410.57,-1115 107410.57,-1115 107410.57,-1090.53 107410.57,-1090.53"/>
<polygon fill="black" stroke="black" points="107414.07,-1090.53 107410.57,-1080.53 107407.07,-1090.53 107414.07,-1090.53"/>
</g>
<!-- L11_S1_TP5_GPU13_attn_v -->
<g id="node1165" class="node">
<title>L11_S1_TP5_GPU13_attn_v</title>
<polygon fill="none" stroke="black" points="106658,-1184.67 105720,-1184.67 105720,-1116.67 106658,-1116.67 106658,-1184.67"/>
<text text-anchor="middle" x="106189" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="106189" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="106189" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="106189" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L11_S1_TP5_GPU13_attn_v&#45;&gt;L11_S1_TP0_GPU8_mha_ar -->
<g id="edge3307" class="edge">
<title>L11_S1_TP5_GPU13_attn_v&#45;&gt;L11_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M105790.56,-1116.26C105790.56,-1110.85 105790.56,-1107 105790.56,-1107 105790.56,-1107 102235.67,-1107 102235.67,-1107 102235.67,-1107 102235.67,-1085.44 102235.67,-1085.44"/>
<polygon fill="black" stroke="black" points="102239.17,-1085.44 102235.67,-1075.44 102232.17,-1085.44 102239.17,-1085.44"/>
</g>
<!-- L11_S1_TP5_GPU13_attn_v&#45;&gt;L11_S1_TP1_GPU9_mha_ar -->
<g id="edge3343" class="edge">
<title>L11_S1_TP5_GPU13_attn_v&#45;&gt;L11_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M105861.12,-1116.63C105861.12,-1111.57 105861.12,-1108 105861.12,-1108 105861.12,-1108 103055.7,-1108 103055.7,-1108 103055.7,-1108 103055.7,-1081.62 103055.7,-1081.62"/>
<polygon fill="black" stroke="black" points="103059.2,-1081.62 103055.7,-1071.62 103052.2,-1081.62 103059.2,-1081.62"/>
</g>
<!-- L11_S1_TP5_GPU13_attn_v&#45;&gt;L11_S1_TP2_GPU10_mha_ar -->
<g id="edge3379" class="edge">
<title>L11_S1_TP5_GPU13_attn_v&#45;&gt;L11_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M105797.75,-1184.77C105797.75,-1195.68 105797.75,-1205 105797.75,-1205 105797.75,-1205 103796,-1205 103796,-1205 103796,-1205 103796,-1083.88 103796,-1083.88"/>
<polygon fill="black" stroke="black" points="103799.5,-1083.88 103796,-1073.88 103792.5,-1083.88 103799.5,-1083.88"/>
</g>
<!-- L11_S1_TP5_GPU13_attn_v&#45;&gt;L11_S1_TP3_GPU11_mha_ar -->
<g id="edge3415" class="edge">
<title>L11_S1_TP5_GPU13_attn_v&#45;&gt;L11_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M105931.68,-1116.63C105931.68,-1111.57 105931.68,-1108 105931.68,-1108 105931.68,-1108 104638.79,-1108 104638.79,-1108 104638.79,-1108 104638.79,-1076.32 104638.79,-1076.32"/>
<polygon fill="black" stroke="black" points="104642.29,-1076.32 104638.79,-1066.32 104635.29,-1076.32 104642.29,-1076.32"/>
</g>
<!-- L11_S1_TP5_GPU13_attn_v&#45;&gt;L11_S1_TP4_GPU12_mha_ar -->
<g id="edge3451" class="edge">
<title>L11_S1_TP5_GPU13_attn_v&#45;&gt;L11_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M106002.24,-1116.29C106002.24,-1100.41 106002.24,-1085 106002.24,-1085 106002.24,-1085 105193.64,-1085 105193.64,-1085 105193.64,-1085 105193.64,-1084.55 105193.64,-1084.55"/>
<polygon fill="black" stroke="black" points="105197.14,-1090.53 105193.64,-1080.53 105190.14,-1090.53 105197.14,-1090.53"/>
</g>
<!-- L11_S1_TP5_GPU13_attn_v&#45;&gt;L11_S1_TP5_GPU13_mha_ar -->
<g id="edge3487" class="edge">
<title>L11_S1_TP5_GPU13_attn_v&#45;&gt;L11_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M106072.8,-1116.51C106072.8,-1116.51 106072.8,-1085.92 106072.8,-1085.92"/>
<polygon fill="black" stroke="black" points="106076.3,-1085.92 106072.8,-1075.92 106069.3,-1085.92 106076.3,-1085.92"/>
</g>
<!-- L11_S1_TP5_GPU13_attn_v&#45;&gt;L11_S1_TP6_GPU14_mha_ar -->
<g id="edge3523" class="edge">
<title>L11_S1_TP5_GPU13_attn_v&#45;&gt;L11_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M106539.51,-1116.51C106539.51,-1116.51 106539.51,-1087.65 106539.51,-1087.65"/>
<polygon fill="black" stroke="black" points="106543.01,-1087.65 106539.51,-1077.65 106536.01,-1087.65 106543.01,-1087.65"/>
</g>
<!-- L11_S1_TP5_GPU13_attn_v&#45;&gt;L11_S1_TP7_GPU15_mha_ar -->
<g id="edge3559" class="edge">
<title>L11_S1_TP5_GPU13_attn_v&#45;&gt;L11_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M106598.75,-1116.53C106598.75,-1115.56 106598.75,-1115 106598.75,-1115 106598.75,-1115 107478.38,-1115 107478.38,-1115 107478.38,-1115 107478.38,-1090.53 107478.38,-1090.53"/>
<polygon fill="black" stroke="black" points="107481.88,-1090.53 107478.38,-1080.53 107474.88,-1090.53 107481.88,-1090.53"/>
</g>
<!-- L11_S1_TP6_GPU14_attn_v -->
<g id="node1166" class="node">
<title>L11_S1_TP6_GPU14_attn_v</title>
<polygon fill="none" stroke="black" points="107614,-1184.67 106676,-1184.67 106676,-1116.67 107614,-1116.67 107614,-1184.67"/>
<text text-anchor="middle" x="107145" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="107145" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="107145" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="107145" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L11_S1_TP6_GPU14_attn_v&#45;&gt;L11_S1_TP0_GPU8_mha_ar -->
<g id="edge3308" class="edge">
<title>L11_S1_TP6_GPU14_attn_v&#45;&gt;L11_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M106723.18,-1116.26C106723.18,-1110.85 106723.18,-1107 106723.18,-1107 106723.18,-1107 102303.61,-1107 102303.61,-1107 102303.61,-1107 102303.61,-1079.79 102303.61,-1079.79"/>
<polygon fill="black" stroke="black" points="102307.11,-1079.79 102303.61,-1069.79 102300.11,-1079.79 102307.11,-1079.79"/>
</g>
<!-- L11_S1_TP6_GPU14_attn_v&#45;&gt;L11_S1_TP1_GPU9_mha_ar -->
<g id="edge3344" class="edge">
<title>L11_S1_TP6_GPU14_attn_v&#45;&gt;L11_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M106770.37,-1116.26C106770.37,-1110.85 106770.37,-1107 106770.37,-1107 106770.37,-1107 103106.62,-1107 103106.62,-1107 103106.62,-1107 103106.62,-1075.87 103106.62,-1075.87"/>
<polygon fill="black" stroke="black" points="103110.12,-1075.87 103106.62,-1065.87 103103.12,-1075.87 103110.12,-1075.87"/>
</g>
<!-- L11_S1_TP6_GPU14_attn_v&#45;&gt;L11_S1_TP2_GPU10_mha_ar -->
<g id="edge3380" class="edge">
<title>L11_S1_TP6_GPU14_attn_v&#45;&gt;L11_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M106817.55,-1116.26C106817.55,-1110.85 106817.55,-1107 106817.55,-1107 106817.55,-1107 103920.98,-1107 103920.98,-1107 103920.98,-1107 103920.98,-1068.19 103920.98,-1068.19"/>
<polygon fill="black" stroke="black" points="103924.48,-1068.19 103920.98,-1058.19 103917.48,-1068.19 103924.48,-1068.19"/>
</g>
<!-- L11_S1_TP6_GPU14_attn_v&#45;&gt;L11_S1_TP3_GPU11_mha_ar -->
<g id="edge3416" class="edge">
<title>L11_S1_TP6_GPU14_attn_v&#45;&gt;L11_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M107062.5,-1116.58C107062.5,-1061.74 107062.5,-960 107062.5,-960 107062.5,-960 104717.82,-960 104717.82,-960 104717.82,-960 104717.82,-1003.89 104717.82,-1003.89"/>
<polygon fill="black" stroke="black" points="104714.32,-1003.89 104717.82,-1013.89 104721.32,-1003.89 104714.32,-1003.89"/>
</g>
<!-- L11_S1_TP6_GPU14_attn_v&#45;&gt;L11_S1_TP4_GPU12_mha_ar -->
<g id="edge3452" class="edge">
<title>L11_S1_TP6_GPU14_attn_v&#45;&gt;L11_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M106864.74,-1116.29C106864.74,-1100.41 106864.74,-1085 106864.74,-1085 106864.74,-1085 105300.92,-1085 105300.92,-1085 105300.92,-1085 105300.92,-1084.13 105300.92,-1084.13"/>
<polygon fill="black" stroke="black" points="105304.42,-1086.34 105300.92,-1076.34 105297.42,-1086.34 105304.42,-1086.34"/>
</g>
<!-- L11_S1_TP6_GPU14_attn_v&#45;&gt;L11_S1_TP5_GPU13_mha_ar -->
<g id="edge3488" class="edge">
<title>L11_S1_TP6_GPU14_attn_v&#45;&gt;L11_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M106911.92,-1116.55C106911.92,-1100.15 106911.92,-1084 106911.92,-1084 106911.92,-1084 106143.36,-1084 106143.36,-1084 106143.36,-1084 106143.36,-1080.22 106143.36,-1080.22"/>
<polygon fill="black" stroke="black" points="106146.86,-1080.22 106143.36,-1070.22 106139.86,-1080.22 106146.86,-1080.22"/>
</g>
<!-- L11_S1_TP6_GPU14_attn_v&#45;&gt;L11_S1_TP6_GPU14_mha_ar -->
<g id="edge3524" class="edge">
<title>L11_S1_TP6_GPU14_attn_v&#45;&gt;L11_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M106959.11,-1116.51C106959.11,-1116.51 106959.11,-1074.64 106959.11,-1074.64"/>
<polygon fill="black" stroke="black" points="106962.61,-1074.64 106959.11,-1064.64 106955.61,-1074.64 106962.61,-1074.64"/>
</g>
<!-- L11_S1_TP6_GPU14_attn_v&#45;&gt;L11_S1_TP7_GPU15_mha_ar -->
<g id="edge3560" class="edge">
<title>L11_S1_TP6_GPU14_attn_v&#45;&gt;L11_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M107546.19,-1116.51C107546.19,-1116.51 107546.19,-1088.96 107546.19,-1088.96"/>
<polygon fill="black" stroke="black" points="107549.69,-1088.96 107546.19,-1078.96 107542.69,-1088.96 107549.69,-1088.96"/>
</g>
<!-- L11_S1_TP7_GPU15_attn_v -->
<g id="node1167" class="node">
<title>L11_S1_TP7_GPU15_attn_v</title>
<polygon fill="none" stroke="black" points="108570,-1184.67 107632,-1184.67 107632,-1116.67 108570,-1116.67 108570,-1184.67"/>
<text text-anchor="middle" x="108101" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="108101" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="108101" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="108101" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L11_S1_TP7_GPU15_attn_v&#45;&gt;L11_S1_TP0_GPU8_mha_ar -->
<g id="edge3309" class="edge">
<title>L11_S1_TP7_GPU15_attn_v&#45;&gt;L11_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M107655.81,-1116.26C107655.81,-1110.85 107655.81,-1107 107655.81,-1107 107655.81,-1107 102371.54,-1107 102371.54,-1107 102371.54,-1107 102371.54,-1070.29 102371.54,-1070.29"/>
<polygon fill="black" stroke="black" points="102375.04,-1070.29 102371.54,-1060.29 102368.04,-1070.29 102375.04,-1070.29"/>
</g>
<!-- L11_S1_TP7_GPU15_attn_v&#45;&gt;L11_S1_TP1_GPU9_mha_ar -->
<g id="edge3345" class="edge">
<title>L11_S1_TP7_GPU15_attn_v&#45;&gt;L11_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M107679.62,-1116.26C107679.62,-1110.85 107679.62,-1107 107679.62,-1107 107679.62,-1107 103157.55,-1107 103157.55,-1107 103157.55,-1107 103157.55,-1066.95 103157.55,-1066.95"/>
<polygon fill="black" stroke="black" points="103161.05,-1066.95 103157.55,-1056.95 103154.05,-1066.95 103161.05,-1066.95"/>
</g>
<!-- L11_S1_TP7_GPU15_attn_v&#45;&gt;L11_S1_TP2_GPU10_mha_ar -->
<g id="edge3381" class="edge">
<title>L11_S1_TP7_GPU15_attn_v&#45;&gt;L11_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M107703.43,-1116.26C107703.43,-1110.85 107703.43,-1107 107703.43,-1107 107703.43,-1107 103949.23,-1107 103949.23,-1107 103949.23,-1107 103949.23,-1060.98 103949.23,-1060.98"/>
<polygon fill="black" stroke="black" points="103952.73,-1060.98 103949.23,-1050.98 103945.73,-1060.98 103952.73,-1060.98"/>
</g>
<!-- L11_S1_TP7_GPU15_attn_v&#45;&gt;L11_S1_TP3_GPU11_mha_ar -->
<g id="edge3417" class="edge">
<title>L11_S1_TP7_GPU15_attn_v&#45;&gt;L11_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M107858.49,-1116.58C107858.49,-1061.74 107858.49,-960 107858.49,-960 107858.49,-960 104689.16,-960 104689.16,-960 104689.16,-960 104689.16,-996.79 104689.16,-996.79"/>
<polygon fill="black" stroke="black" points="104685.66,-996.79 104689.16,-1006.79 104692.66,-996.79 104685.66,-996.79"/>
</g>
<!-- L11_S1_TP7_GPU15_attn_v&#45;&gt;L11_S1_TP4_GPU12_mha_ar -->
<g id="edge3453" class="edge">
<title>L11_S1_TP7_GPU15_attn_v&#45;&gt;L11_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M107727.24,-1116.29C107727.24,-1100.41 107727.24,-1085 107727.24,-1085 107727.24,-1085 105408.2,-1085 105408.2,-1085 105408.2,-1085 105408.2,-1076.37 105408.2,-1076.37"/>
<polygon fill="black" stroke="black" points="105411.7,-1076.37 105408.2,-1066.37 105404.7,-1076.37 105411.7,-1076.37"/>
</g>
<!-- L11_S1_TP7_GPU15_attn_v&#45;&gt;L11_S1_TP5_GPU13_mha_ar -->
<g id="edge3489" class="edge">
<title>L11_S1_TP7_GPU15_attn_v&#45;&gt;L11_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M107751.05,-1116.55C107751.05,-1100.15 107751.05,-1084 107751.05,-1084 107751.05,-1084 106213.91,-1084 106213.91,-1084 106213.91,-1084 106213.91,-1070.7 106213.91,-1070.7"/>
<polygon fill="black" stroke="black" points="106217.41,-1070.7 106213.91,-1060.7 106210.41,-1070.7 106217.41,-1070.7"/>
</g>
<!-- L11_S1_TP7_GPU15_attn_v&#45;&gt;L11_S1_TP6_GPU14_mha_ar -->
<g id="edge3525" class="edge">
<title>L11_S1_TP7_GPU15_attn_v&#45;&gt;L11_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M107774.86,-1116.55C107774.86,-1100.15 107774.86,-1084 107774.86,-1084 107774.86,-1084 107006.29,-1084 107006.29,-1084 107006.29,-1084 107006.29,-1066.18 107006.29,-1066.18"/>
<polygon fill="black" stroke="black" points="107009.79,-1066.18 107006.29,-1056.18 107002.79,-1066.18 107009.79,-1066.18"/>
</g>
<!-- L11_S1_TP7_GPU15_attn_v&#45;&gt;L11_S1_TP7_GPU15_mha_ar -->
<g id="edge3561" class="edge">
<title>L11_S1_TP7_GPU15_attn_v&#45;&gt;L11_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M107798.66,-1116.51C107798.66,-1116.51 107798.66,-1059.62 107798.66,-1059.62"/>
<polygon fill="black" stroke="black" points="107802.16,-1059.62 107798.66,-1049.62 107795.16,-1059.62 107802.16,-1059.62"/>
</g>
<!-- L11_S1_TP0_GPU8_gate -->
<g id="node1169" class="node">
<title>L11_S1_TP0_GPU8_gate</title>
<polygon fill="none" stroke="black" points="101512.56,-844.5 100670.15,-844.5 100453.44,-708.5 101295.85,-708.5 101512.56,-844.5"/>
<text text-anchor="middle" x="100983" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="100983" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="100983" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="100983" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L11_S1_TP0_GPU8_mha_res&#45;&gt;L11_S1_TP0_GPU8_gate -->
<g id="edge3311" class="edge">
<title>L11_S1_TP0_GPU8_mha_res&#45;&gt;L11_S1_TP0_GPU8_gate</title>
<path fill="none" stroke="black" d="M100983,-880.39C100983,-880.39 100983,-854.73 100983,-854.73"/>
<polygon fill="black" stroke="black" points="100986.5,-854.73 100983,-844.73 100979.5,-854.73 100986.5,-854.73"/>
</g>
<!-- L11_S1_TP0_GPU8_moe_res -->
<g id="node1187" class="node">
<title>L11_S1_TP0_GPU8_moe_res</title>
<polygon fill="none" stroke="black" points="101545,-436.33 100725,-436.33 100725,-368.33 101545,-368.33 101545,-436.33"/>
<text text-anchor="middle" x="101135" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="101135" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="101135" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="101135" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP0_GPU8_mha_res&#45;&gt;L11_S1_TP0_GPU8_moe_res -->
<g id="edge3331" class="edge">
<title>L11_S1_TP0_GPU8_mha_res&#45;&gt;L11_S1_TP0_GPU8_moe_res</title>
<path fill="none" stroke="black" d="M100539.49,-903C100485.87,-903 100449.61,-903 100449.61,-903 100449.61,-903 100449.61,-402 100449.61,-402 100449.61,-402 100714.93,-402 100714.93,-402"/>
<polygon fill="black" stroke="black" points="100714.93,-405.5 100724.93,-402 100714.93,-398.5 100714.93,-405.5"/>
</g>
<!-- L11_S1_TP0_GPU8_expert0 -->
<g id="node1170" class="node">
<title>L11_S1_TP0_GPU8_expert0</title>
<polygon fill="none" stroke="black" points="101477.5,-672.5 101028.5,-672.5 101028.5,-604.5 101477.5,-604.5 101477.5,-672.5"/>
<text text-anchor="middle" x="101253" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="101253" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="101253" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="101253" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L11_S1_TP0_GPU8_gate&#45;&gt;L11_S1_TP0_GPU8_expert0 -->
<g id="edge3312" class="edge">
<title>L11_S1_TP0_GPU8_gate&#45;&gt;L11_S1_TP0_GPU8_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M101253,-708.31C101253,-708.31 101253,-682.71 101253,-682.71"/>
<polygon fill="black" stroke="black" points="101256.5,-682.71 101253,-672.71 101249.5,-682.71 101256.5,-682.71"/>
</g>
<!-- L11_S1_TP0_GPU8_expert1 -->
<g id="node1171" class="node">
<title>L11_S1_TP0_GPU8_expert1</title>
<polygon fill="none" stroke="black" points="101944.5,-672.5 101495.5,-672.5 101495.5,-604.5 101944.5,-604.5 101944.5,-672.5"/>
<text text-anchor="middle" x="101720" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="101720" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="101720" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="101720" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L11_S1_TP0_GPU8_gate&#45;&gt;L11_S1_TP0_GPU8_expert1 -->
<g id="edge3313" class="edge">
<title>L11_S1_TP0_GPU8_gate&#45;&gt;L11_S1_TP0_GPU8_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M101504.14,-776.4C101504.14,-776.4 101504.14,-682.74 101504.14,-682.74"/>
<polygon fill="black" stroke="black" points="101507.64,-682.74 101504.14,-672.74 101500.64,-682.74 101507.64,-682.74"/>
</g>
<!-- L11_S1_TP0_GPU8_moe_ar -->
<g id="node1172" class="node">
<title>L11_S1_TP0_GPU8_moe_ar</title>
<ellipse fill="none" stroke="black" cx="102350" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="102350" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="102350" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="102350" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="102350" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP0_GPU8_expert0&#45;&gt;L11_S1_TP0_GPU8_moe_ar -->
<g id="edge3314" class="edge">
<title>L11_S1_TP0_GPU8_expert0&#45;&gt;L11_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M101427.61,-604.37C101427.61,-563.08 101427.61,-499 101427.61,-499 101427.61,-499 102040.53,-499 102040.53,-499"/>
<polygon fill="black" stroke="black" points="102040.53,-502.5 102050.53,-499 102040.53,-495.5 102040.53,-502.5"/>
</g>
<!-- L11_S1_TP1_GPU9_moe_ar -->
<g id="node1196" class="node">
<title>L11_S1_TP1_GPU9_moe_ar</title>
<ellipse fill="none" stroke="black" cx="103037" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="103037" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="103037" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="103037" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="103037" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP0_GPU8_expert0&#45;&gt;L11_S1_TP1_GPU9_moe_ar -->
<g id="edge3350" class="edge">
<title>L11_S1_TP0_GPU8_expert0&#45;&gt;L11_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M101377.72,-604.29C101377.72,-593.34 101377.72,-584 101377.72,-584 101377.72,-584 102720.13,-584 102720.13,-584 102720.13,-584 102720.13,-545.81 102720.13,-545.81"/>
<polygon fill="black" stroke="black" points="102723.63,-545.81 102720.13,-535.81 102716.63,-545.81 102723.63,-545.81"/>
</g>
<!-- L11_S1_TP2_GPU10_moe_ar -->
<g id="node1206" class="node">
<title>L11_S1_TP2_GPU10_moe_ar</title>
<ellipse fill="none" stroke="black" cx="103724" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="103724" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="103724" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="103724" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="103724" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP0_GPU8_expert0&#45;&gt;L11_S1_TP2_GPU10_moe_ar -->
<g id="edge3386" class="edge">
<title>L11_S1_TP0_GPU8_expert0&#45;&gt;L11_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M101327.83,-604.36C101327.83,-551.78 101327.83,-457 101327.83,-457 101327.83,-457 103476.36,-457 103476.36,-457 103476.36,-457 103476.36,-477.97 103476.36,-477.97"/>
<polygon fill="black" stroke="black" points="103472.86,-477.97 103476.36,-487.97 103479.86,-477.97 103472.86,-477.97"/>
</g>
<!-- L11_S1_TP3_GPU11_moe_ar -->
<g id="node1216" class="node">
<title>L11_S1_TP3_GPU11_moe_ar</title>
<ellipse fill="none" stroke="black" cx="104411" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="104411" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="104411" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="104411" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="104411" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP0_GPU8_expert0&#45;&gt;L11_S1_TP3_GPU11_moe_ar -->
<g id="edge3422" class="edge">
<title>L11_S1_TP0_GPU8_expert0&#45;&gt;L11_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M101277.94,-604.36C101277.94,-551.78 101277.94,-457 101277.94,-457 101277.94,-457 104271.03,-457 104271.03,-457 104271.03,-457 104271.03,-466.72 104271.03,-466.72"/>
<polygon fill="black" stroke="black" points="104267.53,-466.72 104271.03,-476.72 104274.53,-466.72 104267.53,-466.72"/>
</g>
<!-- L11_S1_TP4_GPU12_moe_ar -->
<g id="node1226" class="node">
<title>L11_S1_TP4_GPU12_moe_ar</title>
<ellipse fill="none" stroke="black" cx="105098" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="105098" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="105098" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="105098" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="105098" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP0_GPU8_expert0&#45;&gt;L11_S1_TP4_GPU12_moe_ar -->
<g id="edge3458" class="edge">
<title>L11_S1_TP0_GPU8_expert0&#45;&gt;L11_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M101228.06,-604.36C101228.06,-551.78 101228.06,-457 101228.06,-457 101228.06,-457 104990.82,-457 104990.82,-457 104990.82,-457 104990.82,-464.66 104990.82,-464.66"/>
<polygon fill="black" stroke="black" points="104987.32,-464.66 104990.82,-474.66 104994.32,-464.67 104987.32,-464.66"/>
</g>
<!-- L11_S1_TP5_GPU13_moe_ar -->
<g id="node1236" class="node">
<title>L11_S1_TP5_GPU13_moe_ar</title>
<ellipse fill="none" stroke="black" cx="105785" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="105785" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="105785" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="105785" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="105785" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP0_GPU8_expert0&#45;&gt;L11_S1_TP5_GPU13_moe_ar -->
<g id="edge3494" class="edge">
<title>L11_S1_TP0_GPU8_expert0&#45;&gt;L11_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M101178.17,-604.36C101178.17,-551.78 101178.17,-457 101178.17,-457 101178.17,-457 105562.11,-457 105562.11,-457 105562.11,-457 105562.11,-474.26 105562.11,-474.26"/>
<polygon fill="black" stroke="black" points="105558.61,-474.26 105562.11,-484.26 105565.61,-474.26 105558.61,-474.26"/>
</g>
<!-- L11_S1_TP6_GPU14_moe_ar -->
<g id="node1246" class="node">
<title>L11_S1_TP6_GPU14_moe_ar</title>
<ellipse fill="none" stroke="black" cx="106472" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="106472" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="106472" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="106472" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="106472" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP0_GPU8_expert0&#45;&gt;L11_S1_TP6_GPU14_moe_ar -->
<g id="edge3530" class="edge">
<title>L11_S1_TP0_GPU8_expert0&#45;&gt;L11_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M101128.28,-604.36C101128.28,-551.78 101128.28,-457 101128.28,-457 101128.28,-457 106316.38,-457 106316.38,-457 106316.38,-457 106316.38,-467.76 106316.38,-467.76"/>
<polygon fill="black" stroke="black" points="106312.88,-467.76 106316.38,-477.76 106319.88,-467.76 106312.88,-467.76"/>
</g>
<!-- L11_S1_TP7_GPU15_moe_ar -->
<g id="node1256" class="node">
<title>L11_S1_TP7_GPU15_moe_ar</title>
<ellipse fill="none" stroke="black" cx="107159" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="107159" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="107159" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="107159" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="107159" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP0_GPU8_expert0&#45;&gt;L11_S1_TP7_GPU15_moe_ar -->
<g id="edge3566" class="edge">
<title>L11_S1_TP0_GPU8_expert0&#45;&gt;L11_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M101078.39,-604.23C101078.39,-550.87 101078.39,-454 101078.39,-454 101078.39,-454 107103.13,-454 107103.13,-454 107103.13,-454 107103.13,-462.85 107103.13,-462.85"/>
<polygon fill="black" stroke="black" points="107099.63,-462.85 107103.13,-472.85 107106.63,-462.85 107099.63,-462.85"/>
</g>
<!-- L11_S1_TP0_GPU8_expert1&#45;&gt;L11_S1_TP0_GPU8_moe_ar -->
<g id="edge3315" class="edge">
<title>L11_S1_TP0_GPU8_expert1&#45;&gt;L11_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M101907.56,-604.21C101907.56,-567.05 101907.56,-513 101907.56,-513 101907.56,-513 102009.49,-513 102009.49,-513"/>
<polygon fill="black" stroke="black" points="102009.49,-516.5 102019.49,-513 102009.49,-509.5 102009.49,-516.5"/>
</g>
<!-- L11_S1_TP0_GPU8_expert1&#45;&gt;L11_S1_TP1_GPU9_moe_ar -->
<g id="edge3351" class="edge">
<title>L11_S1_TP0_GPU8_expert1&#45;&gt;L11_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M101833.69,-604.29C101833.69,-593.34 101833.69,-584 101833.69,-584 101833.69,-584 102737.73,-584 102737.73,-584 102737.73,-584 102737.73,-551.94 102737.73,-551.94"/>
<polygon fill="black" stroke="black" points="102741.23,-551.94 102737.73,-541.94 102734.23,-551.94 102741.23,-551.94"/>
</g>
<!-- L11_S1_TP0_GPU8_expert1&#45;&gt;L11_S1_TP2_GPU10_moe_ar -->
<g id="edge3387" class="edge">
<title>L11_S1_TP0_GPU8_expert1&#45;&gt;L11_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M101870.62,-604.29C101870.62,-593.34 101870.62,-584 101870.62,-584 101870.62,-584 103436.53,-584 103436.53,-584 103436.53,-584 103436.53,-555.18 103436.53,-555.18"/>
<polygon fill="black" stroke="black" points="103440.03,-555.18 103436.53,-545.18 103433.03,-555.18 103440.03,-555.18"/>
</g>
<!-- L11_S1_TP0_GPU8_expert1&#45;&gt;L11_S1_TP3_GPU11_moe_ar -->
<g id="edge3423" class="edge">
<title>L11_S1_TP0_GPU8_expert1&#45;&gt;L11_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M101737.86,-672.85C101737.86,-686.93 101737.86,-700 101737.86,-700 101737.86,-700 104288.5,-700 104288.5,-700 104288.5,-700 104288.5,-575.27 104288.5,-575.27"/>
<polygon fill="black" stroke="black" points="104292,-575.27 104288.5,-565.27 104285,-575.27 104292,-575.27"/>
</g>
<!-- L11_S1_TP0_GPU8_expert1&#45;&gt;L11_S1_TP4_GPU12_moe_ar -->
<g id="edge3459" class="edge">
<title>L11_S1_TP0_GPU8_expert1&#45;&gt;L11_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M101796.75,-604.4C101796.75,-555.69 101796.75,-472 101796.75,-472 101796.75,-472 104880.41,-472 104880.41,-472 104880.41,-472 104880.41,-473.72 104880.41,-473.72"/>
<polygon fill="black" stroke="black" points="104876.91,-473.72 104880.41,-483.72 104883.91,-473.72 104876.91,-473.72"/>
</g>
<!-- L11_S1_TP0_GPU8_expert1&#45;&gt;L11_S1_TP5_GPU13_moe_ar -->
<g id="edge3495" class="edge">
<title>L11_S1_TP0_GPU8_expert1&#45;&gt;L11_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M101759.81,-604.2C101759.81,-554.67 101759.81,-469 101759.81,-469 101759.81,-469 105534.22,-469 105534.22,-469 105534.22,-469 105534.22,-478.44 105534.22,-478.44"/>
<polygon fill="black" stroke="black" points="105530.72,-478.44 105534.22,-488.44 105537.72,-478.44 105530.72,-478.44"/>
</g>
<!-- L11_S1_TP0_GPU8_expert1&#45;&gt;L11_S1_TP6_GPU14_moe_ar -->
<g id="edge3531" class="edge">
<title>L11_S1_TP0_GPU8_expert1&#45;&gt;L11_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M101722.88,-604.2C101722.88,-554.67 101722.88,-469 101722.88,-469 101722.88,-469 106256.77,-469 106256.77,-469 106256.77,-469 106256.77,-473.6 106256.77,-473.6"/>
<polygon fill="black" stroke="black" points="106253.27,-473.6 106256.77,-483.6 106260.27,-473.6 106253.27,-473.6"/>
</g>
<!-- L11_S1_TP0_GPU8_expert1&#45;&gt;L11_S1_TP7_GPU15_moe_ar -->
<g id="edge3567" class="edge">
<title>L11_S1_TP0_GPU8_expert1&#45;&gt;L11_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M101685.94,-604.23C101685.94,-550.87 101685.94,-454 101685.94,-454 101685.94,-454 107010.27,-454 107010.27,-454 107010.27,-454 107010.27,-467.23 107010.27,-467.23"/>
<polygon fill="black" stroke="black" points="107006.77,-467.23 107010.27,-477.23 107013.77,-467.23 107006.77,-467.23"/>
</g>
<!-- L11_S1_TP0_GPU8_moe_ar&#45;&gt;L11_S1_TP0_GPU8_moe_res -->
<g id="edge3330" class="edge">
<title>L11_S1_TP0_GPU8_moe_ar&#45;&gt;L11_S1_TP0_GPU8_moe_res</title>
<path fill="none" stroke="black" d="M102116.38,-486C101870.98,-486 101520.25,-486 101520.25,-486 101520.25,-486 101520.25,-446.36 101520.25,-446.36"/>
<polygon fill="black" stroke="black" points="101523.75,-446.36 101520.25,-436.36 101516.75,-446.36 101523.75,-446.36"/>
</g>
<!-- L11_S1_TP1_GPU9_expert0 -->
<g id="node1173" class="node">
<title>L11_S1_TP1_GPU9_expert0</title>
<polygon fill="none" stroke="black" points="102411.5,-672.5 101962.5,-672.5 101962.5,-604.5 102411.5,-604.5 102411.5,-672.5"/>
<text text-anchor="middle" x="102187" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="102187" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="102187" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="102187" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L11_S1_TP1_GPU9_expert0&#45;&gt;L11_S1_TP0_GPU8_moe_ar -->
<g id="edge3316" class="edge">
<title>L11_S1_TP1_GPU9_expert0&#45;&gt;L11_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M102081.53,-604.34C102081.53,-604.34 102081.53,-559.3 102081.53,-559.3"/>
<polygon fill="black" stroke="black" points="102085.03,-559.3 102081.53,-549.3 102078.03,-559.3 102085.03,-559.3"/>
</g>
<!-- L11_S1_TP1_GPU9_expert0&#45;&gt;L11_S1_TP1_GPU9_moe_ar -->
<g id="edge3352" class="edge">
<title>L11_S1_TP1_GPU9_expert0&#45;&gt;L11_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M102147.53,-604.29C102147.53,-593.34 102147.53,-584 102147.53,-584 102147.53,-584 102755.33,-584 102755.33,-584 102755.33,-584 102755.33,-556.65 102755.33,-556.65"/>
<polygon fill="black" stroke="black" points="102758.83,-556.65 102755.33,-546.65 102751.83,-556.65 102758.83,-556.65"/>
</g>
<!-- L11_S1_TP1_GPU9_expert0&#45;&gt;L11_S1_TP2_GPU10_moe_ar -->
<g id="edge3388" class="edge">
<title>L11_S1_TP1_GPU9_expert0&#45;&gt;L11_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M102213.52,-604.29C102213.52,-593.34 102213.52,-584 102213.52,-584 102213.52,-584 103483.53,-584 103483.53,-584 103483.53,-584 103483.53,-564.07 103483.53,-564.07"/>
<polygon fill="black" stroke="black" points="103487.03,-564.07 103483.53,-554.07 103480.03,-564.07 103487.03,-564.07"/>
</g>
<!-- L11_S1_TP1_GPU9_expert0&#45;&gt;L11_S1_TP3_GPU11_moe_ar -->
<g id="edge3424" class="edge">
<title>L11_S1_TP1_GPU9_expert0&#45;&gt;L11_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M102279.51,-604.29C102279.51,-593.34 102279.51,-584 102279.51,-584 102279.51,-584 104101.91,-584 104101.91,-584 104101.91,-584 104101.91,-548.81 104101.91,-548.81"/>
<polygon fill="black" stroke="black" points="104105.41,-548.81 104101.91,-538.81 104098.41,-548.81 104105.41,-548.81"/>
</g>
<!-- L11_S1_TP1_GPU9_expert0&#45;&gt;L11_S1_TP4_GPU12_moe_ar -->
<g id="edge3460" class="edge">
<title>L11_S1_TP1_GPU9_expert0&#45;&gt;L11_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M102261.83,-672.64C102261.83,-688.11 102261.83,-703 102261.83,-703 102261.83,-703 105222.5,-703 105222.5,-703 105222.5,-703 105222.5,-575.08 105222.5,-575.08"/>
<polygon fill="black" stroke="black" points="105226,-575.08 105222.5,-565.08 105219,-575.08 105226,-575.08"/>
</g>
<!-- L11_S1_TP1_GPU9_expert0&#45;&gt;L11_S1_TP5_GPU13_moe_ar -->
<g id="edge3496" class="edge">
<title>L11_S1_TP1_GPU9_expert0&#45;&gt;L11_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M101997.86,-604.2C101997.86,-554.67 101997.86,-469 101997.86,-469 101997.86,-469 105506.32,-469 105506.32,-469 105506.32,-469 105506.32,-483.8 105506.32,-483.8"/>
<polygon fill="black" stroke="black" points="105502.82,-483.8 105506.32,-493.8 105509.82,-483.8 105502.82,-483.8"/>
</g>
<!-- L11_S1_TP1_GPU9_expert0&#45;&gt;L11_S1_TP6_GPU14_moe_ar -->
<g id="edge3532" class="edge">
<title>L11_S1_TP1_GPU9_expert0&#45;&gt;L11_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M101980.18,-604.2C101980.18,-554.67 101980.18,-469 101980.18,-469 101980.18,-469 106197.15,-469 106197.15,-469 106197.15,-469 106197.15,-482.9 106197.15,-482.9"/>
<polygon fill="black" stroke="black" points="106193.65,-482.9 106197.15,-492.9 106200.65,-482.9 106193.65,-482.9"/>
</g>
<!-- L11_S1_TP1_GPU9_expert0&#45;&gt;L11_S1_TP7_GPU15_moe_ar -->
<g id="edge3568" class="edge">
<title>L11_S1_TP1_GPU9_expert0&#45;&gt;L11_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M102345.51,-604.31C102345.51,-593.83 102345.51,-585 102345.51,-585 102345.51,-585 106853.09,-585 106853.09,-585 106853.09,-585 106853.09,-550.14 106853.09,-550.14"/>
<polygon fill="black" stroke="black" points="106856.59,-550.14 106853.09,-540.14 106849.59,-550.14 106856.59,-550.14"/>
</g>
<!-- L11_S1_TP1_GPU9_expert1 -->
<g id="node1174" class="node">
<title>L11_S1_TP1_GPU9_expert1</title>
<polygon fill="none" stroke="black" points="102878.5,-672.5 102429.5,-672.5 102429.5,-604.5 102878.5,-604.5 102878.5,-672.5"/>
<text text-anchor="middle" x="102654" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="102654" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="102654" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="102654" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L11_S1_TP1_GPU9_expert1&#45;&gt;L11_S1_TP0_GPU8_moe_ar -->
<g id="edge3317" class="edge">
<title>L11_S1_TP1_GPU9_expert1&#45;&gt;L11_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M102452.68,-604.34C102452.68,-604.34 102452.68,-576.36 102452.68,-576.36"/>
<polygon fill="black" stroke="black" points="102456.18,-576.36 102452.68,-566.36 102449.18,-576.36 102456.18,-576.36"/>
</g>
<!-- L11_S1_TP1_GPU9_expert1&#45;&gt;L11_S1_TP1_GPU9_moe_ar -->
<g id="edge3353" class="edge">
<title>L11_S1_TP1_GPU9_expert1&#45;&gt;L11_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M102772.92,-604.34C102772.92,-604.34 102772.92,-560.09 102772.92,-560.09"/>
<polygon fill="black" stroke="black" points="102776.42,-560.09 102772.92,-550.09 102769.42,-560.09 102776.42,-560.09"/>
</g>
<!-- L11_S1_TP1_GPU9_expert1&#45;&gt;L11_S1_TP2_GPU10_moe_ar -->
<g id="edge3389" class="edge">
<title>L11_S1_TP1_GPU9_expert1&#45;&gt;L11_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M102808.12,-604.29C102808.12,-593.34 102808.12,-584 102808.12,-584 102808.12,-584 103530.53,-584 103530.53,-584 103530.53,-584 103530.53,-569.96 103530.53,-569.96"/>
<polygon fill="black" stroke="black" points="103534.03,-569.96 103530.53,-559.96 103527.03,-569.96 103534.03,-569.96"/>
</g>
<!-- L11_S1_TP1_GPU9_expert1&#45;&gt;L11_S1_TP3_GPU11_moe_ar -->
<g id="edge3425" class="edge">
<title>L11_S1_TP1_GPU9_expert1&#45;&gt;L11_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M102825.71,-604.29C102825.71,-593.34 102825.71,-584 102825.71,-584 102825.71,-584 104127.28,-584 104127.28,-584 104127.28,-584 104127.28,-555.91 104127.28,-555.91"/>
<polygon fill="black" stroke="black" points="104130.78,-555.91 104127.28,-545.91 104123.78,-555.91 104130.78,-555.91"/>
</g>
<!-- L11_S1_TP1_GPU9_expert1&#45;&gt;L11_S1_TP4_GPU12_moe_ar -->
<g id="edge3461" class="edge">
<title>L11_S1_TP1_GPU9_expert1&#45;&gt;L11_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M102843.31,-604.31C102843.31,-593.83 102843.31,-585 102843.31,-585 102843.31,-585 104809.4,-585 104809.4,-585 104809.4,-585 104809.4,-554.83 104809.4,-554.83"/>
<polygon fill="black" stroke="black" points="104812.9,-554.83 104809.4,-544.83 104805.9,-554.83 104812.9,-554.83"/>
</g>
<!-- L11_S1_TP1_GPU9_expert1&#45;&gt;L11_S1_TP5_GPU13_moe_ar -->
<g id="edge3497" class="edge">
<title>L11_S1_TP1_GPU9_expert1&#45;&gt;L11_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M102693.5,-604.4C102693.5,-555.17 102693.5,-470 102693.5,-470 102693.5,-470 105478.43,-470 105478.43,-470 105478.43,-470 105478.43,-491.07 105478.43,-491.07"/>
<polygon fill="black" stroke="black" points="105474.93,-491.07 105478.43,-501.07 105481.93,-491.07 105474.93,-491.07"/>
</g>
<!-- L11_S1_TP1_GPU9_expert1&#45;&gt;L11_S1_TP6_GPU14_moe_ar -->
<g id="edge3533" class="edge">
<title>L11_S1_TP1_GPU9_expert1&#45;&gt;L11_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M102743.86,-672.65C102743.86,-689.39 102743.86,-706 102743.86,-706 102743.86,-706 106162.93,-706 106162.93,-706 106162.93,-706 106162.93,-548.89 106162.93,-548.89"/>
<polygon fill="black" stroke="black" points="106166.43,-548.89 106162.93,-538.89 106159.43,-548.89 106166.43,-548.89"/>
</g>
<!-- L11_S1_TP1_GPU9_expert1&#45;&gt;L11_S1_TP7_GPU15_moe_ar -->
<g id="edge3569" class="edge">
<title>L11_S1_TP1_GPU9_expert1&#45;&gt;L11_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M102860.9,-604.31C102860.9,-593.83 102860.9,-585 102860.9,-585 102860.9,-585 106910.19,-585 106910.19,-585 106910.19,-585 106910.19,-562.71 106910.19,-562.71"/>
<polygon fill="black" stroke="black" points="106913.69,-562.71 106910.19,-552.71 106906.69,-562.71 106913.69,-562.71"/>
</g>
<!-- L11_S1_TP2_GPU10_expert0 -->
<g id="node1175" class="node">
<title>L11_S1_TP2_GPU10_expert0</title>
<polygon fill="none" stroke="black" points="103345.5,-672.5 102896.5,-672.5 102896.5,-604.5 103345.5,-604.5 103345.5,-672.5"/>
<text text-anchor="middle" x="103121" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="103121" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="103121" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="103121" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L11_S1_TP2_GPU10_expert0&#45;&gt;L11_S1_TP0_GPU8_moe_ar -->
<g id="edge3318" class="edge">
<title>L11_S1_TP2_GPU10_expert0&#45;&gt;L11_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M102946.39,-603.88C102946.39,-603.31 102946.39,-603 102946.39,-603 102946.39,-603 102475.86,-603 102475.86,-603 102475.86,-603 102475.86,-575.09 102475.86,-575.09"/>
<polygon fill="black" stroke="black" points="102479.36,-575.09 102475.86,-565.09 102472.36,-575.09 102479.36,-575.09"/>
</g>
<!-- L11_S1_TP2_GPU10_expert0&#45;&gt;L11_S1_TP1_GPU9_moe_ar -->
<g id="edge3354" class="edge">
<title>L11_S1_TP2_GPU10_expert0&#45;&gt;L11_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M102996.28,-604.34C102996.28,-604.34 102996.28,-578.55 102996.28,-578.55"/>
<polygon fill="black" stroke="black" points="102999.78,-578.55 102996.28,-568.55 102992.78,-578.55 102999.78,-578.55"/>
</g>
<!-- L11_S1_TP2_GPU10_expert0&#45;&gt;L11_S1_TP2_GPU10_moe_ar -->
<g id="edge3390" class="edge">
<title>L11_S1_TP2_GPU10_expert0&#45;&gt;L11_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M103145.94,-604.29C103145.94,-593.34 103145.94,-584 103145.94,-584 103145.94,-584 103577.52,-584 103577.52,-584 103577.52,-584 103577.52,-573.88 103577.52,-573.88"/>
<polygon fill="black" stroke="black" points="103581.02,-573.88 103577.52,-563.88 103574.02,-573.88 103581.02,-573.88"/>
</g>
<!-- L11_S1_TP2_GPU10_expert0&#45;&gt;L11_S1_TP3_GPU11_moe_ar -->
<g id="edge3426" class="edge">
<title>L11_S1_TP2_GPU10_expert0&#45;&gt;L11_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M103195.83,-604.29C103195.83,-593.34 103195.83,-584 103195.83,-584 103195.83,-584 104152.65,-584 104152.65,-584 104152.65,-584 104152.65,-561.09 104152.65,-561.09"/>
<polygon fill="black" stroke="black" points="104156.15,-561.09 104152.65,-551.09 104149.15,-561.09 104156.15,-561.09"/>
</g>
<!-- L11_S1_TP2_GPU10_expert0&#45;&gt;L11_S1_TP4_GPU12_moe_ar -->
<g id="edge3462" class="edge">
<title>L11_S1_TP2_GPU10_expert0&#45;&gt;L11_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M103245.72,-604.31C103245.72,-593.83 103245.72,-585 103245.72,-585 103245.72,-585 104854.3,-585 104854.3,-585 104854.3,-585 104854.3,-563.46 104854.3,-563.46"/>
<polygon fill="black" stroke="black" points="104857.8,-563.46 104854.3,-553.46 104850.8,-563.46 104857.8,-563.46"/>
</g>
<!-- L11_S1_TP2_GPU10_expert0&#45;&gt;L11_S1_TP5_GPU13_moe_ar -->
<g id="edge3498" class="edge">
<title>L11_S1_TP2_GPU10_expert0&#45;&gt;L11_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M103295.61,-604.31C103295.61,-593.83 103295.61,-585 103295.61,-585 103295.61,-585 105476.09,-585 105476.09,-585 105476.09,-585 105476.09,-549.1 105476.09,-549.1"/>
<polygon fill="black" stroke="black" points="105479.59,-549.1 105476.09,-539.1 105472.59,-549.1 105479.59,-549.1"/>
</g>
<!-- L11_S1_TP2_GPU10_expert0&#45;&gt;L11_S1_TP6_GPU14_moe_ar -->
<g id="edge3534" class="edge">
<title>L11_S1_TP2_GPU10_expert0&#45;&gt;L11_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M103233.25,-672.61C103233.25,-681.18 103233.25,-688 103233.25,-688 103233.25,-688 106160.36,-688 106160.36,-688 106160.36,-688 106160.36,-548.03 106160.36,-548.03"/>
<polygon fill="black" stroke="black" points="106163.86,-548.03 106160.36,-538.03 106156.86,-548.03 106163.86,-548.03"/>
</g>
<!-- L11_S1_TP2_GPU10_expert0&#45;&gt;L11_S1_TP7_GPU15_moe_ar -->
<g id="edge3570" class="edge">
<title>L11_S1_TP2_GPU10_expert0&#45;&gt;L11_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M103121,-672.61C103121,-681.18 103121,-688 103121,-688 103121,-688 107095.9,-688 107095.9,-688 107095.9,-688 107095.9,-577.99 107095.9,-577.99"/>
<polygon fill="black" stroke="black" points="107099.4,-577.99 107095.9,-567.99 107092.4,-577.99 107099.4,-577.99"/>
</g>
<!-- L11_S1_TP2_GPU10_expert1 -->
<g id="node1176" class="node">
<title>L11_S1_TP2_GPU10_expert1</title>
<polygon fill="none" stroke="black" points="103812.5,-672.5 103363.5,-672.5 103363.5,-604.5 103812.5,-604.5 103812.5,-672.5"/>
<text text-anchor="middle" x="103588" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="103588" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="103588" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="103588" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L11_S1_TP2_GPU10_expert1&#45;&gt;L11_S1_TP0_GPU8_moe_ar -->
<g id="edge3319" class="edge">
<title>L11_S1_TP2_GPU10_expert1&#45;&gt;L11_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M103377.49,-604.31C103377.49,-593.83 103377.49,-585 103377.49,-585 103377.49,-585 102499.03,-585 102499.03,-585 102499.03,-585 102499.03,-573.49 102499.03,-573.49"/>
<polygon fill="black" stroke="black" points="102502.54,-573.49 102499.03,-563.49 102495.54,-573.49 102502.54,-573.49"/>
</g>
<!-- L11_S1_TP2_GPU10_expert1&#45;&gt;L11_S1_TP1_GPU9_moe_ar -->
<g id="edge3355" class="edge">
<title>L11_S1_TP2_GPU10_expert1&#45;&gt;L11_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M103367.48,-604.34C103367.48,-604.34 103367.48,-538.15 103367.48,-538.15"/>
<polygon fill="black" stroke="black" points="103370.98,-538.15 103367.48,-528.15 103363.98,-538.15 103370.98,-538.15"/>
</g>
<!-- L11_S1_TP2_GPU10_expert1&#45;&gt;L11_S1_TP2_GPU10_moe_ar -->
<g id="edge3391" class="edge">
<title>L11_S1_TP2_GPU10_expert1&#45;&gt;L11_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M103624.52,-604.34C103624.52,-604.34 103624.52,-576.36 103624.52,-576.36"/>
<polygon fill="black" stroke="black" points="103628.02,-576.36 103624.52,-566.36 103621.02,-576.36 103628.02,-576.36"/>
</g>
<!-- L11_S1_TP2_GPU10_expert1&#45;&gt;L11_S1_TP3_GPU11_moe_ar -->
<g id="edge3427" class="edge">
<title>L11_S1_TP2_GPU10_expert1&#45;&gt;L11_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M103671.51,-604.29C103671.51,-593.34 103671.51,-584 103671.51,-584 103671.51,-584 104178.02,-584 104178.02,-584 104178.02,-584 104178.02,-565.18 104178.02,-565.18"/>
<polygon fill="black" stroke="black" points="104181.52,-565.18 104178.02,-555.18 104174.52,-565.18 104181.52,-565.18"/>
</g>
<!-- L11_S1_TP2_GPU10_expert1&#45;&gt;L11_S1_TP4_GPU12_moe_ar -->
<g id="edge3463" class="edge">
<title>L11_S1_TP2_GPU10_expert1&#45;&gt;L11_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M103718.51,-604.31C103718.51,-593.83 103718.51,-585 103718.51,-585 103718.51,-585 104899.2,-585 104899.2,-585 104899.2,-585 104899.2,-569.1 104899.2,-569.1"/>
<polygon fill="black" stroke="black" points="104902.7,-569.1 104899.2,-559.1 104895.7,-569.1 104902.7,-569.1"/>
</g>
<!-- L11_S1_TP2_GPU10_expert1&#45;&gt;L11_S1_TP5_GPU13_moe_ar -->
<g id="edge3499" class="edge">
<title>L11_S1_TP2_GPU10_expert1&#45;&gt;L11_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M103765.5,-604.31C103765.5,-593.83 103765.5,-585 103765.5,-585 103765.5,-585 105501.64,-585 105501.64,-585 105501.64,-585 105501.64,-556.31 105501.64,-556.31"/>
<polygon fill="black" stroke="black" points="105505.14,-556.31 105501.64,-546.31 105498.14,-556.31 105505.14,-556.31"/>
</g>
<!-- L11_S1_TP2_GPU10_expert1&#45;&gt;L11_S1_TP6_GPU14_moe_ar -->
<g id="edge3535" class="edge">
<title>L11_S1_TP2_GPU10_expert1&#45;&gt;L11_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M103770.74,-672.61C103770.74,-681.18 103770.74,-688 103770.74,-688 103770.74,-688 106157.79,-688 106157.79,-688 106157.79,-688 106157.79,-547.1 106157.79,-547.1"/>
<polygon fill="black" stroke="black" points="106161.29,-547.1 106157.79,-537.1 106154.29,-547.1 106161.29,-547.1"/>
</g>
<!-- L11_S1_TP2_GPU10_expert1&#45;&gt;L11_S1_TP7_GPU15_moe_ar -->
<g id="edge3571" class="edge">
<title>L11_S1_TP2_GPU10_expert1&#45;&gt;L11_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M103728.98,-672.61C103728.98,-681.18 103728.98,-688 103728.98,-688 103728.98,-688 107092.3,-688 107092.3,-688 107092.3,-688 107092.3,-577.54 107092.3,-577.54"/>
<polygon fill="black" stroke="black" points="107095.8,-577.54 107092.3,-567.54 107088.8,-577.54 107095.8,-577.54"/>
</g>
<!-- L11_S1_TP3_GPU11_expert0 -->
<g id="node1177" class="node">
<title>L11_S1_TP3_GPU11_expert0</title>
<polygon fill="none" stroke="black" points="104279.5,-672.5 103830.5,-672.5 103830.5,-604.5 104279.5,-604.5 104279.5,-672.5"/>
<text text-anchor="middle" x="104055" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="104055" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="104055" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="104055" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L11_S1_TP3_GPU11_expert0&#45;&gt;L11_S1_TP0_GPU8_moe_ar -->
<g id="edge3320" class="edge">
<title>L11_S1_TP3_GPU11_expert0&#45;&gt;L11_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M103859,-604.31C103859,-593.83 103859,-585 103859,-585 103859,-585 102522.21,-585 102522.21,-585 102522.21,-585 102522.21,-571.68 102522.21,-571.68"/>
<polygon fill="black" stroke="black" points="102525.71,-571.68 102522.21,-561.68 102518.71,-571.68 102525.71,-571.68"/>
</g>
<!-- L11_S1_TP3_GPU11_expert0&#45;&gt;L11_S1_TP1_GPU9_moe_ar -->
<g id="edge3356" class="edge">
<title>L11_S1_TP3_GPU11_expert0&#45;&gt;L11_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M103887.49,-604.31C103887.49,-593.83 103887.49,-585 103887.49,-585 103887.49,-585 103358.36,-585 103358.36,-585 103358.36,-585 103358.36,-543.8 103358.36,-543.8"/>
<polygon fill="black" stroke="black" points="103361.86,-543.8 103358.36,-533.8 103354.86,-543.8 103361.86,-543.8"/>
</g>
<!-- L11_S1_TP3_GPU11_expert0&#45;&gt;L11_S1_TP2_GPU10_moe_ar -->
<g id="edge3392" class="edge">
<title>L11_S1_TP3_GPU11_expert0&#45;&gt;L11_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M103915.99,-604.34C103915.99,-604.34 103915.99,-569.91 103915.99,-569.91"/>
<polygon fill="black" stroke="black" points="103919.49,-569.91 103915.99,-559.91 103912.49,-569.91 103919.49,-569.91"/>
</g>
<!-- L11_S1_TP3_GPU11_expert0&#45;&gt;L11_S1_TP3_GPU11_moe_ar -->
<g id="edge3428" class="edge">
<title>L11_S1_TP3_GPU11_expert0&#45;&gt;L11_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M104203.39,-604.34C104203.39,-604.34 104203.39,-568.22 104203.39,-568.22"/>
<polygon fill="black" stroke="black" points="104206.89,-568.22 104203.39,-558.22 104199.89,-568.22 104206.89,-568.22"/>
</g>
<!-- L11_S1_TP3_GPU11_expert0&#45;&gt;L11_S1_TP4_GPU12_moe_ar -->
<g id="edge3464" class="edge">
<title>L11_S1_TP3_GPU11_expert0&#45;&gt;L11_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M104228.76,-604.31C104228.76,-593.83 104228.76,-585 104228.76,-585 104228.76,-585 104989,-585 104989,-585 104989,-585 104989,-575.97 104989,-575.97"/>
<polygon fill="black" stroke="black" points="104992.5,-575.97 104989,-565.97 104985.5,-575.97 104992.5,-575.97"/>
</g>
<!-- L11_S1_TP3_GPU11_expert0&#45;&gt;L11_S1_TP5_GPU13_moe_ar -->
<g id="edge3500" class="edge">
<title>L11_S1_TP3_GPU11_expert0&#45;&gt;L11_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M104254.13,-604.31C104254.13,-593.83 104254.13,-585 104254.13,-585 104254.13,-585 105527.19,-585 105527.19,-585 105527.19,-585 105527.19,-561.19 105527.19,-561.19"/>
<polygon fill="black" stroke="black" points="105530.69,-561.19 105527.19,-551.19 105523.69,-561.2 105530.69,-561.19"/>
</g>
<!-- L11_S1_TP3_GPU11_expert0&#45;&gt;L11_S1_TP6_GPU14_moe_ar -->
<g id="edge3536" class="edge">
<title>L11_S1_TP3_GPU11_expert0&#45;&gt;L11_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M104129.83,-672.61C104129.83,-681.18 104129.83,-688 104129.83,-688 104129.83,-688 106155.21,-688 106155.21,-688 106155.21,-688 106155.21,-545.88 106155.21,-545.88"/>
<polygon fill="black" stroke="black" points="106158.71,-545.88 106155.21,-535.88 106151.71,-545.88 106158.71,-545.88"/>
</g>
<!-- L11_S1_TP3_GPU11_expert0&#45;&gt;L11_S1_TP7_GPU15_moe_ar -->
<g id="edge3572" class="edge">
<title>L11_S1_TP3_GPU11_expert0&#45;&gt;L11_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M104067.5,-604.23C104067.5,-550.87 104067.5,-454 104067.5,-454 104067.5,-454 106917.4,-454 106917.4,-454 106917.4,-454 106917.4,-476.82 106917.4,-476.82"/>
<polygon fill="black" stroke="black" points="106913.9,-476.82 106917.4,-486.82 106920.9,-476.82 106913.9,-476.82"/>
</g>
<!-- L11_S1_TP3_GPU11_expert1 -->
<g id="node1178" class="node">
<title>L11_S1_TP3_GPU11_expert1</title>
<polygon fill="none" stroke="black" points="104746.5,-672.5 104297.5,-672.5 104297.5,-604.5 104746.5,-604.5 104746.5,-672.5"/>
<text text-anchor="middle" x="104522" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="104522" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="104522" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="104522" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L11_S1_TP3_GPU11_expert1&#45;&gt;L11_S1_TP0_GPU8_moe_ar -->
<g id="edge3321" class="edge">
<title>L11_S1_TP3_GPU11_expert1&#45;&gt;L11_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M104347.27,-604.31C104347.27,-593.83 104347.27,-585 104347.27,-585 104347.27,-585 102545.39,-585 102545.39,-585 102545.39,-585 102545.39,-569.47 102545.39,-569.47"/>
<polygon fill="black" stroke="black" points="102548.89,-569.47 102545.39,-559.47 102541.89,-569.47 102548.89,-569.47"/>
</g>
<!-- L11_S1_TP3_GPU11_expert1&#45;&gt;L11_S1_TP1_GPU9_moe_ar -->
<g id="edge3357" class="edge">
<title>L11_S1_TP3_GPU11_expert1&#45;&gt;L11_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M104397.05,-604.31C104397.05,-593.83 104397.05,-585 104397.05,-585 104397.05,-585 103360.93,-585 103360.93,-585 103360.93,-585 103360.93,-542.56 103360.93,-542.56"/>
<polygon fill="black" stroke="black" points="103364.43,-542.56 103360.93,-532.56 103357.43,-542.56 103364.43,-542.56"/>
</g>
<!-- L11_S1_TP3_GPU11_expert1&#45;&gt;L11_S1_TP2_GPU10_moe_ar -->
<g id="edge3393" class="edge">
<title>L11_S1_TP3_GPU11_expert1&#45;&gt;L11_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M104446.82,-604.31C104446.82,-593.83 104446.82,-585 104446.82,-585 104446.82,-585 103944.48,-585 103944.48,-585 103944.48,-585 103944.48,-566.86 103944.48,-566.86"/>
<polygon fill="black" stroke="black" points="103947.98,-566.86 103944.48,-556.86 103940.98,-566.86 103947.98,-566.86"/>
</g>
<!-- L11_S1_TP3_GPU11_expert1&#45;&gt;L11_S1_TP3_GPU11_moe_ar -->
<g id="edge3429" class="edge">
<title>L11_S1_TP3_GPU11_expert1&#45;&gt;L11_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M104496.59,-604.34C104496.59,-604.34 104496.59,-577.23 104496.59,-577.23"/>
<polygon fill="black" stroke="black" points="104500.09,-577.23 104496.59,-567.23 104493.09,-577.23 104500.09,-577.23"/>
</g>
<!-- L11_S1_TP3_GPU11_expert1&#45;&gt;L11_S1_TP4_GPU12_moe_ar -->
<g id="edge3465" class="edge">
<title>L11_S1_TP3_GPU11_expert1&#45;&gt;L11_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M104746.59,-627C104752.81,-627 104756.36,-627 104756.36,-627 104756.36,-627 104756.36,-504 104756.36,-504 104756.36,-504 104773.45,-504 104773.45,-504"/>
<polygon fill="black" stroke="black" points="104773.45,-507.5 104783.45,-504 104773.45,-500.5 104773.45,-507.5"/>
</g>
<!-- L11_S1_TP3_GPU11_expert1&#45;&gt;L11_S1_TP5_GPU13_moe_ar -->
<g id="edge3501" class="edge">
<title>L11_S1_TP3_GPU11_expert1&#45;&gt;L11_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M104546.37,-604.31C104546.37,-593.83 104546.37,-585 104546.37,-585 104546.37,-585 105552.74,-585 105552.74,-585 105552.74,-585 105552.74,-565.35 105552.74,-565.35"/>
<polygon fill="black" stroke="black" points="105556.24,-565.35 105552.74,-555.35 105549.24,-565.35 105556.24,-565.35"/>
</g>
<!-- L11_S1_TP3_GPU11_expert1&#45;&gt;L11_S1_TP6_GPU14_moe_ar -->
<g id="edge3537" class="edge">
<title>L11_S1_TP3_GPU11_expert1&#45;&gt;L11_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M104634.25,-672.61C104634.25,-681.18 104634.25,-688 104634.25,-688 104634.25,-688 106152.64,-688 106152.64,-688 106152.64,-688 106152.64,-544.7 106152.64,-544.7"/>
<polygon fill="black" stroke="black" points="106156.14,-544.7 106152.64,-534.7 106149.14,-544.7 106156.14,-544.7"/>
</g>
<!-- L11_S1_TP3_GPU11_expert1&#45;&gt;L11_S1_TP7_GPU15_moe_ar -->
<g id="edge3573" class="edge">
<title>L11_S1_TP3_GPU11_expert1&#45;&gt;L11_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M104522,-672.61C104522,-681.18 104522,-688 104522,-688 104522,-688 107088.7,-688 107088.7,-688 107088.7,-688 107088.7,-577.54 107088.7,-577.54"/>
<polygon fill="black" stroke="black" points="107092.2,-577.54 107088.7,-567.54 107085.2,-577.54 107092.2,-577.54"/>
</g>
<!-- L11_S1_TP4_GPU12_expert0 -->
<g id="node1179" class="node">
<title>L11_S1_TP4_GPU12_expert0</title>
<polygon fill="none" stroke="black" points="105213.5,-672.5 104764.5,-672.5 104764.5,-604.5 105213.5,-604.5 105213.5,-672.5"/>
<text text-anchor="middle" x="104989" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="104989" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="104989" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="104989" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L11_S1_TP4_GPU12_expert0&#45;&gt;L11_S1_TP0_GPU8_moe_ar -->
<g id="edge3322" class="edge">
<title>L11_S1_TP4_GPU12_expert0&#45;&gt;L11_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M104989.36,-672.85C104989.36,-686.93 104989.36,-700 104989.36,-700 104989.36,-700 102423.5,-700 102423.5,-700 102423.5,-700 102423.5,-577.6 102423.5,-577.6"/>
<polygon fill="black" stroke="black" points="102427,-577.6 102423.5,-567.6 102420,-577.6 102427,-577.6"/>
</g>
<!-- L11_S1_TP4_GPU12_expert0&#45;&gt;L11_S1_TP1_GPU9_moe_ar -->
<g id="edge3358" class="edge">
<title>L11_S1_TP4_GPU12_expert0&#45;&gt;L11_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M104877.29,-672.58C104877.29,-675.29 104877.29,-677 104877.29,-677 104877.29,-677 103353.21,-677 103353.21,-677 103353.21,-677 103353.21,-546.29 103353.21,-546.29"/>
<polygon fill="black" stroke="black" points="103356.71,-546.29 103353.21,-536.29 103349.71,-546.29 103356.71,-546.29"/>
</g>
<!-- L11_S1_TP4_GPU12_expert0&#45;&gt;L11_S1_TP2_GPU10_moe_ar -->
<g id="edge3394" class="edge">
<title>L11_S1_TP4_GPU12_expert0&#45;&gt;L11_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M104944.1,-604.29C104944.1,-593.34 104944.1,-584 104944.1,-584 104944.1,-584 103972.98,-584 103972.98,-584 103972.98,-584 103972.98,-562.58 103972.98,-562.58"/>
<polygon fill="black" stroke="black" points="103976.48,-562.58 103972.98,-552.58 103969.48,-562.58 103976.48,-562.58"/>
</g>
<!-- L11_S1_TP4_GPU12_expert0&#45;&gt;L11_S1_TP3_GPU11_moe_ar -->
<g id="edge3430" class="edge">
<title>L11_S1_TP4_GPU12_expert0&#45;&gt;L11_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M104764.37,-649C104757.75,-649 104753.96,-649 104753.96,-649 104753.96,-649 104753.96,-536 104753.96,-536 104753.96,-536 104737.62,-536 104737.62,-536"/>
<polygon fill="black" stroke="black" points="104737.62,-532.5 104727.62,-536 104737.62,-539.5 104737.62,-532.5"/>
</g>
<!-- L11_S1_TP4_GPU12_expert0&#45;&gt;L11_S1_TP4_GPU12_moe_ar -->
<g id="edge3466" class="edge">
<title>L11_S1_TP4_GPU12_expert0&#45;&gt;L11_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M105033.9,-604.34C105033.9,-604.34 105033.9,-577.67 105033.9,-577.67"/>
<polygon fill="black" stroke="black" points="105037.4,-577.67 105033.9,-567.67 105030.4,-577.67 105037.4,-577.67"/>
</g>
<!-- L11_S1_TP4_GPU12_expert0&#45;&gt;L11_S1_TP5_GPU13_moe_ar -->
<g id="edge3502" class="edge">
<title>L11_S1_TP4_GPU12_expert0&#45;&gt;L11_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M105078.8,-604.46C105078.8,-602.32 105078.8,-601 105078.8,-601 105078.8,-601 105578.29,-601 105578.29,-601 105578.29,-601 105578.29,-568.35 105578.29,-568.35"/>
<polygon fill="black" stroke="black" points="105581.79,-568.35 105578.29,-558.35 105574.79,-568.35 105581.79,-568.35"/>
</g>
<!-- L11_S1_TP4_GPU12_expert0&#45;&gt;L11_S1_TP6_GPU14_moe_ar -->
<g id="edge3538" class="edge">
<title>L11_S1_TP4_GPU12_expert0&#45;&gt;L11_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M105123.7,-604.46C105123.7,-602.32 105123.7,-601 105123.7,-601 105123.7,-601 106150.07,-601 106150.07,-601 106150.07,-601 106150.07,-543.72 106150.07,-543.72"/>
<polygon fill="black" stroke="black" points="106153.57,-543.72 106150.07,-533.72 106146.57,-543.72 106153.57,-543.72"/>
</g>
<!-- L11_S1_TP4_GPU12_expert0&#45;&gt;L11_S1_TP7_GPU15_moe_ar -->
<g id="edge3574" class="edge">
<title>L11_S1_TP4_GPU12_expert0&#45;&gt;L11_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M105168.6,-604.46C105168.6,-602.32 105168.6,-601 105168.6,-601 105168.6,-601 106938.74,-601 106938.74,-601 106938.74,-601 106938.74,-566.94 106938.74,-566.94"/>
<polygon fill="black" stroke="black" points="106942.24,-566.94 106938.74,-556.94 106935.24,-566.94 106942.24,-566.94"/>
</g>
<!-- L11_S1_TP4_GPU12_expert1 -->
<g id="node1180" class="node">
<title>L11_S1_TP4_GPU12_expert1</title>
<polygon fill="none" stroke="black" points="105680.5,-672.5 105231.5,-672.5 105231.5,-604.5 105680.5,-604.5 105680.5,-672.5"/>
<text text-anchor="middle" x="105456" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="105456" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="105456" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="105456" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L11_S1_TP4_GPU12_expert1&#45;&gt;L11_S1_TP0_GPU8_moe_ar -->
<g id="edge3323" class="edge">
<title>L11_S1_TP4_GPU12_expert1&#45;&gt;L11_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M105441.5,-604.2C105441.5,-554.67 105441.5,-469 105441.5,-469 105441.5,-469 102576.73,-469 102576.73,-469 102576.73,-469 102576.73,-474.99 102576.73,-474.99"/>
<polygon fill="black" stroke="black" points="102573.23,-474.99 102576.73,-484.99 102580.23,-474.99 102573.23,-474.99"/>
</g>
<!-- L11_S1_TP4_GPU12_expert1&#45;&gt;L11_S1_TP1_GPU9_moe_ar -->
<g id="edge3359" class="edge">
<title>L11_S1_TP4_GPU12_expert1&#45;&gt;L11_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M105381.17,-672.51C105381.17,-675.83 105381.17,-678 105381.17,-678 105381.17,-678 103350.64,-678 103350.64,-678 103350.64,-678 103350.64,-547.28 103350.64,-547.28"/>
<polygon fill="black" stroke="black" points="103354.14,-547.28 103350.64,-537.28 103347.14,-547.28 103354.14,-547.28"/>
</g>
<!-- L11_S1_TP4_GPU12_expert1&#45;&gt;L11_S1_TP2_GPU10_moe_ar -->
<g id="edge3395" class="edge">
<title>L11_S1_TP4_GPU12_expert1&#45;&gt;L11_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M105256.62,-604.29C105256.62,-593.34 105256.62,-584 105256.62,-584 105256.62,-584 104001.47,-584 104001.47,-584 104001.47,-584 104001.47,-557.38 104001.47,-557.38"/>
<polygon fill="black" stroke="black" points="104004.97,-557.38 104001.47,-547.38 103997.97,-557.38 104004.97,-557.38"/>
</g>
<!-- L11_S1_TP4_GPU12_expert1&#45;&gt;L11_S1_TP3_GPU11_moe_ar -->
<g id="edge3431" class="edge">
<title>L11_S1_TP4_GPU12_expert1&#45;&gt;L11_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M105281.74,-604.31C105281.74,-593.83 105281.74,-585 105281.74,-585 105281.74,-585 104596.14,-585 104596.14,-585 104596.14,-585 104596.14,-570.58 104596.14,-570.58"/>
<polygon fill="black" stroke="black" points="104599.64,-570.58 104596.14,-560.58 104592.64,-570.58 104599.64,-570.58"/>
</g>
<!-- L11_S1_TP4_GPU12_expert1&#45;&gt;L11_S1_TP4_GPU12_moe_ar -->
<g id="edge3467" class="edge">
<title>L11_S1_TP4_GPU12_expert1&#45;&gt;L11_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M105306.86,-604.34C105306.86,-604.34 105306.86,-568.22 105306.86,-568.22"/>
<polygon fill="black" stroke="black" points="105310.36,-568.22 105306.86,-558.22 105303.36,-568.22 105310.36,-568.22"/>
</g>
<!-- L11_S1_TP4_GPU12_expert1&#45;&gt;L11_S1_TP5_GPU13_moe_ar -->
<g id="edge3503" class="edge">
<title>L11_S1_TP4_GPU12_expert1&#45;&gt;L11_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M105603.85,-604.34C105603.85,-604.34 105603.85,-571.18 105603.85,-571.18"/>
<polygon fill="black" stroke="black" points="105607.35,-571.18 105603.85,-561.18 105600.35,-571.18 105607.35,-571.18"/>
</g>
<!-- L11_S1_TP4_GPU12_expert1&#45;&gt;L11_S1_TP6_GPU14_moe_ar -->
<g id="edge3539" class="edge">
<title>L11_S1_TP4_GPU12_expert1&#45;&gt;L11_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M105629.4,-604.46C105629.4,-602.32 105629.4,-601 105629.4,-601 105629.4,-601 106140.86,-601 106140.86,-601 106140.86,-601 106140.86,-537.29 106140.86,-537.29"/>
<polygon fill="black" stroke="black" points="106144.36,-537.29 106140.86,-527.29 106137.36,-537.29 106144.36,-537.29"/>
</g>
<!-- L11_S1_TP4_GPU12_expert1&#45;&gt;L11_S1_TP7_GPU15_moe_ar -->
<g id="edge3575" class="edge">
<title>L11_S1_TP4_GPU12_expert1&#45;&gt;L11_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M105654.95,-604.46C105654.95,-602.32 105654.95,-601 105654.95,-601 105654.95,-601 106967.29,-601 106967.29,-601 106967.29,-601 106967.29,-570.24 106967.29,-570.24"/>
<polygon fill="black" stroke="black" points="106970.79,-570.24 106967.29,-560.24 106963.79,-570.24 106970.79,-570.24"/>
</g>
<!-- L11_S1_TP5_GPU13_expert0 -->
<g id="node1181" class="node">
<title>L11_S1_TP5_GPU13_expert0</title>
<polygon fill="none" stroke="black" points="106147.5,-672.5 105698.5,-672.5 105698.5,-604.5 106147.5,-604.5 106147.5,-672.5"/>
<text text-anchor="middle" x="105923" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="105923" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="105923" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="105923" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L11_S1_TP5_GPU13_expert0&#45;&gt;L11_S1_TP0_GPU8_moe_ar -->
<g id="edge3324" class="edge">
<title>L11_S1_TP5_GPU13_expert0&#45;&gt;L11_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M105782.69,-672.65C105782.69,-689.39 105782.69,-706 105782.69,-706 105782.69,-706 102417.5,-706 102417.5,-706 102417.5,-706 102417.5,-577.73 102417.5,-577.73"/>
<polygon fill="black" stroke="black" points="102421,-577.73 102417.5,-567.73 102414,-577.73 102421,-577.73"/>
</g>
<!-- L11_S1_TP5_GPU13_expert0&#45;&gt;L11_S1_TP1_GPU9_moe_ar -->
<g id="edge3360" class="edge">
<title>L11_S1_TP5_GPU13_expert0&#45;&gt;L11_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M105740.59,-672.51C105740.59,-675.83 105740.59,-678 105740.59,-678 105740.59,-678 103348.07,-678 103348.07,-678 103348.07,-678 103348.07,-548.19 103348.07,-548.19"/>
<polygon fill="black" stroke="black" points="103351.57,-548.19 103348.07,-538.19 103344.57,-548.19 103351.57,-548.19"/>
</g>
<!-- L11_S1_TP5_GPU13_expert0&#45;&gt;L11_S1_TP2_GPU10_moe_ar -->
<g id="edge3396" class="edge">
<title>L11_S1_TP5_GPU13_expert0&#45;&gt;L11_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M105740.6,-604.29C105740.6,-593.34 105740.6,-584 105740.6,-584 105740.6,-584 104029.97,-584 104029.97,-584 104029.97,-584 104029.97,-549.84 104029.97,-549.84"/>
<polygon fill="black" stroke="black" points="104033.47,-549.84 104029.97,-539.84 104026.47,-549.84 104033.47,-549.84"/>
</g>
<!-- L11_S1_TP5_GPU13_expert0&#45;&gt;L11_S1_TP3_GPU11_moe_ar -->
<g id="edge3432" class="edge">
<title>L11_S1_TP5_GPU13_expert0&#45;&gt;L11_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M105782.69,-604.29C105782.69,-593.34 105782.69,-584 105782.69,-584 105782.69,-584 104645.91,-584 104645.91,-584 104645.91,-584 104645.91,-564.81 104645.91,-564.81"/>
<polygon fill="black" stroke="black" points="104649.41,-564.81 104645.91,-554.81 104642.41,-564.81 104649.41,-564.81"/>
</g>
<!-- L11_S1_TP5_GPU13_expert0&#45;&gt;L11_S1_TP4_GPU12_moe_ar -->
<g id="edge3468" class="edge">
<title>L11_S1_TP5_GPU13_expert0&#45;&gt;L11_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M105824.79,-604.29C105824.79,-593.34 105824.79,-584 105824.79,-584 105824.79,-584 105331.98,-584 105331.98,-584 105331.98,-584 105331.98,-564.81 105331.98,-564.81"/>
<polygon fill="black" stroke="black" points="105335.48,-564.81 105331.98,-554.81 105328.48,-564.81 105335.48,-564.81"/>
</g>
<!-- L11_S1_TP5_GPU13_expert0&#45;&gt;L11_S1_TP5_GPU13_moe_ar -->
<g id="edge3504" class="edge">
<title>L11_S1_TP5_GPU13_expert0&#45;&gt;L11_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M105866.88,-604.34C105866.88,-604.34 105866.88,-577.23 105866.88,-577.23"/>
<polygon fill="black" stroke="black" points="105870.38,-577.23 105866.88,-567.23 105863.38,-577.23 105870.38,-577.23"/>
</g>
<!-- L11_S1_TP5_GPU13_expert0&#45;&gt;L11_S1_TP6_GPU14_moe_ar -->
<g id="edge3540" class="edge">
<title>L11_S1_TP5_GPU13_expert0&#45;&gt;L11_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M106144.18,-604.34C106144.18,-604.34 106144.18,-540.13 106144.18,-540.13"/>
<polygon fill="black" stroke="black" points="106147.68,-540.13 106144.18,-530.13 106140.68,-540.13 106147.68,-540.13"/>
</g>
<!-- L11_S1_TP5_GPU13_expert0&#45;&gt;L11_S1_TP7_GPU15_moe_ar -->
<g id="edge3576" class="edge">
<title>L11_S1_TP5_GPU13_expert0&#45;&gt;L11_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M106128.5,-604.46C106128.5,-602.32 106128.5,-601 106128.5,-601 106128.5,-601 106995.85,-601 106995.85,-601 106995.85,-601 106995.85,-572.6 106995.85,-572.6"/>
<polygon fill="black" stroke="black" points="106999.35,-572.6 106995.85,-562.6 106992.35,-572.6 106999.35,-572.6"/>
</g>
<!-- L11_S1_TP5_GPU13_expert1 -->
<g id="node1182" class="node">
<title>L11_S1_TP5_GPU13_expert1</title>
<polygon fill="none" stroke="black" points="106614.5,-672.5 106165.5,-672.5 106165.5,-604.5 106614.5,-604.5 106614.5,-672.5"/>
<text text-anchor="middle" x="106390" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="106390" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="106390" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="106390" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L11_S1_TP5_GPU13_expert1&#45;&gt;L11_S1_TP0_GPU8_moe_ar -->
<g id="edge3325" class="edge">
<title>L11_S1_TP5_GPU13_expert1&#45;&gt;L11_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M106221.62,-604.31C106221.62,-593.83 106221.62,-585 106221.62,-585 106221.62,-585 102568.57,-585 102568.57,-585 102568.57,-585 102568.57,-566.86 102568.57,-566.86"/>
<polygon fill="black" stroke="black" points="102572.07,-566.86 102568.57,-556.86 102565.07,-566.86 102572.07,-566.86"/>
</g>
<!-- L11_S1_TP5_GPU13_expert1&#45;&gt;L11_S1_TP1_GPU9_moe_ar -->
<g id="edge3361" class="edge">
<title>L11_S1_TP5_GPU13_expert1&#45;&gt;L11_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M106277.75,-604.31C106277.75,-593.83 106277.75,-585 106277.75,-585 106277.75,-585 103046.17,-585 103046.17,-585 103046.17,-585 103046.17,-578.7 103046.17,-578.7"/>
<polygon fill="black" stroke="black" points="103049.67,-578.7 103046.17,-568.7 103042.67,-578.7 103049.67,-578.7"/>
</g>
<!-- L11_S1_TP5_GPU13_expert1&#45;&gt;L11_S1_TP2_GPU10_moe_ar -->
<g id="edge3397" class="edge">
<title>L11_S1_TP5_GPU13_expert1&#45;&gt;L11_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M106315.17,-672.61C106315.17,-681.18 106315.17,-688 106315.17,-688 106315.17,-688 103821.5,-688 103821.5,-688 103821.5,-688 103821.5,-576.65 103821.5,-576.65"/>
<polygon fill="black" stroke="black" points="103825,-576.65 103821.5,-566.65 103818,-576.65 103825,-576.65"/>
</g>
<!-- L11_S1_TP5_GPU13_expert1&#45;&gt;L11_S1_TP3_GPU11_moe_ar -->
<g id="edge3433" class="edge">
<title>L11_S1_TP5_GPU13_expert1&#45;&gt;L11_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M106333.88,-604.29C106333.88,-593.34 106333.88,-584 106333.88,-584 106333.88,-584 104695.69,-584 104695.69,-584 104695.69,-584 104695.69,-555.91 104695.69,-555.91"/>
<polygon fill="black" stroke="black" points="104699.19,-555.91 104695.69,-545.91 104692.19,-555.91 104699.19,-555.91"/>
</g>
<!-- L11_S1_TP5_GPU13_expert1&#45;&gt;L11_S1_TP4_GPU12_moe_ar -->
<g id="edge3469" class="edge">
<title>L11_S1_TP5_GPU13_expert1&#45;&gt;L11_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M106390,-604.29C106390,-593.34 106390,-584 106390,-584 106390,-584 105357.1,-584 105357.1,-584 105357.1,-584 105357.1,-561.09 105357.1,-561.09"/>
<polygon fill="black" stroke="black" points="105360.6,-561.09 105357.1,-551.09 105353.6,-561.09 105360.6,-561.09"/>
</g>
<!-- L11_S1_TP5_GPU13_expert1&#45;&gt;L11_S1_TP5_GPU13_moe_ar -->
<g id="edge3505" class="edge">
<title>L11_S1_TP5_GPU13_expert1&#45;&gt;L11_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M106446.12,-604.29C106446.12,-593.34 106446.12,-584 106446.12,-584 106446.12,-584 105908.98,-584 105908.98,-584 105908.98,-584 105908.98,-575.27 105908.98,-575.27"/>
<polygon fill="black" stroke="black" points="105912.48,-575.27 105908.98,-565.27 105905.48,-575.27 105912.48,-575.27"/>
</g>
<!-- L11_S1_TP5_GPU13_expert1&#45;&gt;L11_S1_TP6_GPU14_moe_ar -->
<g id="edge3541" class="edge">
<title>L11_S1_TP5_GPU13_expert1&#45;&gt;L11_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M106502.25,-604.34C106502.25,-604.34 106502.25,-578.55 106502.25,-578.55"/>
<polygon fill="black" stroke="black" points="106505.75,-578.55 106502.25,-568.55 106498.75,-578.55 106505.75,-578.55"/>
</g>
<!-- L11_S1_TP5_GPU13_expert1&#45;&gt;L11_S1_TP7_GPU15_moe_ar -->
<g id="edge3577" class="edge">
<title>L11_S1_TP5_GPU13_expert1&#45;&gt;L11_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M106558.38,-604.46C106558.38,-602.32 106558.38,-601 106558.38,-601 106558.38,-601 107024.4,-601 107024.4,-601 107024.4,-601 107024.4,-574.48 107024.4,-574.48"/>
<polygon fill="black" stroke="black" points="107027.9,-574.48 107024.4,-564.48 107020.9,-574.48 107027.9,-574.48"/>
</g>
<!-- L11_S1_TP6_GPU14_expert0 -->
<g id="node1183" class="node">
<title>L11_S1_TP6_GPU14_expert0</title>
<polygon fill="none" stroke="black" points="107081.5,-672.5 106632.5,-672.5 106632.5,-604.5 107081.5,-604.5 107081.5,-672.5"/>
<text text-anchor="middle" x="106857" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="106857" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="106857" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="106857" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L11_S1_TP6_GPU14_expert0&#45;&gt;L11_S1_TP0_GPU8_moe_ar -->
<g id="edge3326" class="edge">
<title>L11_S1_TP6_GPU14_expert0&#45;&gt;L11_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M106881.64,-604.31C106881.64,-593.83 106881.64,-585 106881.64,-585 106881.64,-585 102591.75,-585 102591.75,-585 102591.75,-585 102591.75,-563.84 102591.75,-563.84"/>
<polygon fill="black" stroke="black" points="102595.25,-563.84 102591.75,-553.84 102588.25,-563.84 102595.25,-563.84"/>
</g>
<!-- L11_S1_TP6_GPU14_expert0&#45;&gt;L11_S1_TP1_GPU9_moe_ar -->
<g id="edge3362" class="edge">
<title>L11_S1_TP6_GPU14_expert0&#45;&gt;L11_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M106654.25,-604.31C106654.25,-593.83 106654.25,-585 106654.25,-585 106654.25,-585 103096.06,-585 103096.06,-585 103096.06,-585 103096.06,-578.03 103096.06,-578.03"/>
<polygon fill="black" stroke="black" points="103099.56,-578.03 103096.06,-568.03 103092.56,-578.03 103099.56,-578.03"/>
</g>
<!-- L11_S1_TP6_GPU14_expert0&#45;&gt;L11_S1_TP2_GPU10_moe_ar -->
<g id="edge3398" class="edge">
<title>L11_S1_TP6_GPU14_expert0&#45;&gt;L11_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M106815.5,-604.23C106815.5,-550.87 106815.5,-454 106815.5,-454 106815.5,-454 104014.77,-454 104014.77,-454 104014.77,-454 104014.77,-486.44 104014.77,-486.44"/>
<polygon fill="black" stroke="black" points="104011.27,-486.44 104014.77,-496.44 104018.27,-486.44 104011.27,-486.44"/>
</g>
<!-- L11_S1_TP6_GPU14_expert0&#45;&gt;L11_S1_TP3_GPU11_moe_ar -->
<g id="edge3434" class="edge">
<title>L11_S1_TP6_GPU14_expert0&#45;&gt;L11_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M106810.98,-604.23C106810.98,-550.87 106810.98,-454 106810.98,-454 106810.98,-454 104728.37,-454 104728.37,-454 104728.37,-454 104728.37,-495.01 104728.37,-495.01"/>
<polygon fill="black" stroke="black" points="104724.87,-495.01 104728.37,-505.01 104731.87,-495.01 104724.87,-495.01"/>
</g>
<!-- L11_S1_TP6_GPU14_expert0&#45;&gt;L11_S1_TP4_GPU12_moe_ar -->
<g id="edge3470" class="edge">
<title>L11_S1_TP6_GPU14_expert0&#45;&gt;L11_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M106675.99,-604.29C106675.99,-593.34 106675.99,-584 106675.99,-584 106675.99,-584 105382.22,-584 105382.22,-584 105382.22,-584 105382.22,-555.91 105382.22,-555.91"/>
<polygon fill="black" stroke="black" points="105385.72,-555.91 105382.22,-545.91 105378.72,-555.91 105385.72,-555.91"/>
</g>
<!-- L11_S1_TP6_GPU14_expert0&#45;&gt;L11_S1_TP5_GPU13_moe_ar -->
<g id="edge3506" class="edge">
<title>L11_S1_TP6_GPU14_expert0&#45;&gt;L11_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M106697.74,-604.29C106697.74,-593.34 106697.74,-584 106697.74,-584 106697.74,-584 105951.08,-584 105951.08,-584 105951.08,-584 105951.08,-572.47 105951.08,-572.47"/>
<polygon fill="black" stroke="black" points="105954.58,-572.47 105951.08,-562.47 105947.58,-572.47 105954.58,-572.47"/>
</g>
<!-- L11_S1_TP6_GPU14_expert0&#45;&gt;L11_S1_TP6_GPU14_moe_ar -->
<g id="edge3542" class="edge">
<title>L11_S1_TP6_GPU14_expert0&#45;&gt;L11_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M106719.48,-604.34C106719.48,-604.34 106719.48,-562.87 106719.48,-562.87"/>
<polygon fill="black" stroke="black" points="106722.98,-562.87 106719.48,-552.87 106715.98,-562.87 106722.98,-562.87"/>
</g>
<!-- L11_S1_TP6_GPU14_expert0&#45;&gt;L11_S1_TP7_GPU15_moe_ar -->
<g id="edge3578" class="edge">
<title>L11_S1_TP6_GPU14_expert0&#45;&gt;L11_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M107052.95,-604.34C107052.95,-604.34 107052.95,-576.36 107052.95,-576.36"/>
<polygon fill="black" stroke="black" points="107056.45,-576.36 107052.95,-566.36 107049.45,-576.36 107056.45,-576.36"/>
</g>
<!-- L11_S1_TP6_GPU14_expert1 -->
<g id="node1184" class="node">
<title>L11_S1_TP6_GPU14_expert1</title>
<polygon fill="none" stroke="black" points="107548.5,-672.5 107099.5,-672.5 107099.5,-604.5 107548.5,-604.5 107548.5,-672.5"/>
<text text-anchor="middle" x="107324" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="107324" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="107324" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="107324" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L11_S1_TP6_GPU14_expert1&#45;&gt;L11_S1_TP0_GPU8_moe_ar -->
<g id="edge3327" class="edge">
<title>L11_S1_TP6_GPU14_expert1&#45;&gt;L11_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M107155.78,-604.31C107155.78,-593.83 107155.78,-585 107155.78,-585 107155.78,-585 102614.93,-585 102614.93,-585 102614.93,-585 102614.93,-560.06 102614.93,-560.06"/>
<polygon fill="black" stroke="black" points="102618.43,-560.06 102614.93,-550.06 102611.43,-560.06 102618.43,-560.06"/>
</g>
<!-- L11_S1_TP6_GPU14_expert1&#45;&gt;L11_S1_TP1_GPU9_moe_ar -->
<g id="edge3363" class="edge">
<title>L11_S1_TP6_GPU14_expert1&#45;&gt;L11_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M107212.06,-604.31C107212.06,-593.83 107212.06,-585 107212.06,-585 107212.06,-585 102790.52,-585 102790.52,-585 102790.52,-585 102790.52,-563.09 102790.52,-563.09"/>
<polygon fill="black" stroke="black" points="102794.02,-563.09 102790.52,-553.09 102787.02,-563.09 102794.02,-563.09"/>
</g>
<!-- L11_S1_TP6_GPU14_expert1&#45;&gt;L11_S1_TP2_GPU10_moe_ar -->
<g id="edge3399" class="edge">
<title>L11_S1_TP6_GPU14_expert1&#45;&gt;L11_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M107530.15,-604.23C107530.15,-550.87 107530.15,-454 107530.15,-454 107530.15,-454 103971.08,-454 103971.08,-454 103971.08,-454 103971.08,-477.99 103971.08,-477.99"/>
<polygon fill="black" stroke="black" points="103967.58,-477.99 103971.08,-487.99 103974.58,-477.99 103967.58,-477.99"/>
</g>
<!-- L11_S1_TP6_GPU14_expert1&#45;&gt;L11_S1_TP3_GPU11_moe_ar -->
<g id="edge3435" class="edge">
<title>L11_S1_TP6_GPU14_expert1&#45;&gt;L11_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M107511.81,-604.23C107511.81,-550.87 107511.81,-454 107511.81,-454 107511.81,-454 104711.28,-454 104711.28,-454 104711.28,-454 104711.28,-489.04 104711.28,-489.04"/>
<polygon fill="black" stroke="black" points="104707.78,-489.04 104711.28,-499.04 104714.78,-489.04 104707.78,-489.04"/>
</g>
<!-- L11_S1_TP6_GPU14_expert1&#45;&gt;L11_S1_TP4_GPU12_moe_ar -->
<g id="edge3471" class="edge">
<title>L11_S1_TP6_GPU14_expert1&#45;&gt;L11_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M107268.34,-604.29C107268.34,-593.34 107268.34,-584 107268.34,-584 107268.34,-584 105407.34,-584 105407.34,-584 105407.34,-584 105407.34,-548.81 105407.34,-548.81"/>
<polygon fill="black" stroke="black" points="105410.84,-548.81 105407.34,-538.81 105403.84,-548.81 105410.84,-548.81"/>
</g>
<!-- L11_S1_TP6_GPU14_expert1&#45;&gt;L11_S1_TP5_GPU13_moe_ar -->
<g id="edge3507" class="edge">
<title>L11_S1_TP6_GPU14_expert1&#45;&gt;L11_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M107324.62,-604.29C107324.62,-593.34 107324.62,-584 107324.62,-584 107324.62,-584 105993.17,-584 105993.17,-584 105993.17,-584 105993.17,-568.14 105993.17,-568.14"/>
<polygon fill="black" stroke="black" points="105996.67,-568.14 105993.17,-558.14 105989.67,-568.14 105996.67,-568.14"/>
</g>
<!-- L11_S1_TP6_GPU14_expert1&#45;&gt;L11_S1_TP6_GPU14_moe_ar -->
<g id="edge3543" class="edge">
<title>L11_S1_TP6_GPU14_expert1&#45;&gt;L11_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M107380.9,-604.29C107380.9,-593.34 107380.9,-584 107380.9,-584 107380.9,-584 106741.23,-584 106741.23,-584 106741.23,-584 106741.23,-559.23 106741.23,-559.23"/>
<polygon fill="black" stroke="black" points="106744.73,-559.23 106741.23,-549.23 106737.73,-559.23 106744.73,-559.23"/>
</g>
<!-- L11_S1_TP6_GPU14_expert1&#45;&gt;L11_S1_TP7_GPU15_moe_ar -->
<g id="edge3579" class="edge">
<title>L11_S1_TP6_GPU14_expert1&#45;&gt;L11_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M107437.18,-604.34C107437.18,-604.34 107437.18,-557.38 107437.18,-557.38"/>
<polygon fill="black" stroke="black" points="107440.68,-557.38 107437.18,-547.38 107433.68,-557.38 107440.68,-557.38"/>
</g>
<!-- L11_S1_TP7_GPU15_expert0 -->
<g id="node1185" class="node">
<title>L11_S1_TP7_GPU15_expert0</title>
<polygon fill="none" stroke="black" points="108015.5,-672.5 107566.5,-672.5 107566.5,-604.5 108015.5,-604.5 108015.5,-672.5"/>
<text text-anchor="middle" x="107791" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="107791" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="107791" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="107791" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L11_S1_TP7_GPU15_expert0&#45;&gt;L11_S1_TP0_GPU8_moe_ar -->
<g id="edge3328" class="edge">
<title>L11_S1_TP7_GPU15_expert0&#45;&gt;L11_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M107570,-604.31C107570,-593.83 107570,-585 107570,-585 107570,-585 102638.1,-585 102638.1,-585 102638.1,-585 102638.1,-555.2 102638.1,-555.2"/>
<polygon fill="black" stroke="black" points="102641.6,-555.2 102638.1,-545.2 102634.6,-555.2 102641.6,-555.2"/>
</g>
<!-- L11_S1_TP7_GPU15_expert0&#45;&gt;L11_S1_TP1_GPU9_moe_ar -->
<g id="edge3364" class="edge">
<title>L11_S1_TP7_GPU15_expert0&#45;&gt;L11_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M107594.5,-604.23C107594.5,-550.87 107594.5,-454 107594.5,-454 107594.5,-454 103190.97,-454 103190.97,-454 103190.97,-454 103190.97,-467.6 103190.97,-467.6"/>
<polygon fill="black" stroke="black" points="103187.47,-467.6 103190.97,-477.6 103194.47,-467.6 103187.47,-467.6"/>
</g>
<!-- L11_S1_TP7_GPU15_expert0&#45;&gt;L11_S1_TP2_GPU10_moe_ar -->
<g id="edge3400" class="edge">
<title>L11_S1_TP7_GPU15_expert0&#45;&gt;L11_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M107591,-604.23C107591,-550.87 107591,-454 107591,-454 107591,-454 103927.38,-454 103927.38,-454 103927.38,-454 103927.38,-472.17 103927.38,-472.17"/>
<polygon fill="black" stroke="black" points="103923.88,-472.17 103927.38,-482.17 103930.88,-472.17 103923.88,-472.17"/>
</g>
<!-- L11_S1_TP7_GPU15_expert0&#45;&gt;L11_S1_TP3_GPU11_moe_ar -->
<g id="edge3436" class="edge">
<title>L11_S1_TP7_GPU15_expert0&#45;&gt;L11_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M107587.5,-604.23C107587.5,-550.87 107587.5,-454 107587.5,-454 107587.5,-454 104694.18,-454 104694.18,-454 104694.18,-454 104694.18,-484.55 104694.18,-484.55"/>
<polygon fill="black" stroke="black" points="104690.68,-484.55 104694.18,-494.55 104697.68,-484.55 104690.68,-484.55"/>
</g>
<!-- L11_S1_TP7_GPU15_expert0&#45;&gt;L11_S1_TP4_GPU12_moe_ar -->
<g id="edge3472" class="edge">
<title>L11_S1_TP7_GPU15_expert0&#45;&gt;L11_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M107584,-604.24C107584,-553.17 107584,-463 107584,-463 107584,-463 105322.05,-463 105322.05,-463 105322.05,-463 105322.05,-474.71 105322.05,-474.71"/>
<polygon fill="black" stroke="black" points="105318.55,-474.71 105322.05,-484.71 105325.55,-474.71 105318.55,-474.71"/>
</g>
<!-- L11_S1_TP7_GPU15_expert0&#45;&gt;L11_S1_TP5_GPU13_moe_ar -->
<g id="edge3508" class="edge">
<title>L11_S1_TP7_GPU15_expert0&#45;&gt;L11_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M107573.5,-604.29C107573.5,-593.34 107573.5,-584 107573.5,-584 107573.5,-584 106035.27,-584 106035.27,-584 106035.27,-584 106035.27,-562.58 106035.27,-562.58"/>
<polygon fill="black" stroke="black" points="106038.77,-562.58 106035.27,-552.58 106031.77,-562.58 106038.77,-562.58"/>
</g>
<!-- L11_S1_TP7_GPU15_expert0&#45;&gt;L11_S1_TP6_GPU14_moe_ar -->
<g id="edge3544" class="edge">
<title>L11_S1_TP7_GPU15_expert0&#45;&gt;L11_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M107577,-604.29C107577,-593.34 107577,-584 107577,-584 107577,-584 106762.97,-584 106762.97,-584 106762.97,-584 106762.97,-554.45 106762.97,-554.45"/>
<polygon fill="black" stroke="black" points="106766.47,-554.45 106762.97,-544.45 106759.47,-554.45 106766.47,-554.45"/>
</g>
<!-- L11_S1_TP7_GPU15_expert0&#45;&gt;L11_S1_TP7_GPU15_moe_ar -->
<g id="edge3580" class="edge">
<title>L11_S1_TP7_GPU15_expert0&#45;&gt;L11_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M107580.5,-604.13C107580.5,-580.74 107580.5,-554 107580.5,-554 107580.5,-554 107408.38,-554 107408.38,-554"/>
<polygon fill="black" stroke="black" points="107408.38,-550.5 107398.38,-554 107408.38,-557.5 107408.38,-550.5"/>
</g>
<!-- L11_S1_TP7_GPU15_expert1 -->
<g id="node1186" class="node">
<title>L11_S1_TP7_GPU15_expert1</title>
<polygon fill="none" stroke="black" points="108482.5,-672.5 108033.5,-672.5 108033.5,-604.5 108482.5,-604.5 108482.5,-672.5"/>
<text text-anchor="middle" x="108258" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="108258" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="108258" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="108258" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L11_S1_TP7_GPU15_expert1&#45;&gt;L11_S1_TP0_GPU8_moe_ar -->
<g id="edge3329" class="edge">
<title>L11_S1_TP7_GPU15_expert1&#45;&gt;L11_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M108076.22,-604.31C108076.22,-593.83 108076.22,-585 108076.22,-585 108076.22,-585 102661.28,-585 102661.28,-585 102661.28,-585 102661.28,-548.06 102661.28,-548.06"/>
<polygon fill="black" stroke="black" points="102664.78,-548.06 102661.28,-538.06 102657.78,-548.06 102664.78,-548.06"/>
</g>
<!-- L11_S1_TP7_GPU15_expert1&#45;&gt;L11_S1_TP1_GPU9_moe_ar -->
<g id="edge3365" class="edge">
<title>L11_S1_TP7_GPU15_expert1&#45;&gt;L11_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M108375.28,-604.48C108375.28,-550.92 108375.28,-453 108375.28,-453 108375.28,-453 103010.49,-453 103010.49,-453 103010.49,-453 103010.49,-462.14 103010.49,-462.14"/>
<polygon fill="black" stroke="black" points="103006.99,-462.14 103010.49,-472.14 103013.99,-462.14 103006.99,-462.14"/>
</g>
<!-- L11_S1_TP7_GPU15_expert1&#45;&gt;L11_S1_TP2_GPU10_moe_ar -->
<g id="edge3401" class="edge">
<title>L11_S1_TP7_GPU15_expert1&#45;&gt;L11_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M108332.56,-604.48C108332.56,-550.92 108332.56,-453 108332.56,-453 108332.56,-453 103883.69,-453 103883.69,-453 103883.69,-453 103883.69,-468.1 103883.69,-468.1"/>
<polygon fill="black" stroke="black" points="103880.19,-468.1 103883.69,-478.1 103887.19,-468.1 103880.19,-468.1"/>
</g>
<!-- L11_S1_TP7_GPU15_expert1&#45;&gt;L11_S1_TP3_GPU11_moe_ar -->
<g id="edge3437" class="edge">
<title>L11_S1_TP7_GPU15_expert1&#45;&gt;L11_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M108289.83,-604.48C108289.83,-550.92 108289.83,-453 108289.83,-453 108289.83,-453 104677.09,-453 104677.09,-453 104677.09,-453 104677.09,-481.04 104677.09,-481.04"/>
<polygon fill="black" stroke="black" points="104673.59,-481.04 104677.09,-491.04 104680.59,-481.04 104673.59,-481.04"/>
</g>
<!-- L11_S1_TP7_GPU15_expert1&#45;&gt;L11_S1_TP4_GPU12_moe_ar -->
<g id="edge3473" class="edge">
<title>L11_S1_TP7_GPU15_expert1&#45;&gt;L11_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M108247.11,-604.24C108247.11,-553.17 108247.11,-463 108247.11,-463 108247.11,-463 105211.64,-463 105211.64,-463 105211.64,-463 105211.64,-465.18 105211.64,-465.18"/>
<polygon fill="black" stroke="black" points="105208.14,-465.18 105211.64,-475.18 105215.14,-465.18 105208.14,-465.18"/>
</g>
<!-- L11_S1_TP7_GPU15_expert1&#45;&gt;L11_S1_TP5_GPU13_moe_ar -->
<g id="edge3509" class="edge">
<title>L11_S1_TP7_GPU15_expert1&#45;&gt;L11_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M108118.94,-604.29C108118.94,-593.34 108118.94,-584 108118.94,-584 108118.94,-584 106077.37,-584 106077.37,-584 106077.37,-584 106077.37,-554.09 106077.37,-554.09"/>
<polygon fill="black" stroke="black" points="106080.87,-554.09 106077.37,-544.09 106073.87,-554.09 106080.87,-554.09"/>
</g>
<!-- L11_S1_TP7_GPU15_expert1&#45;&gt;L11_S1_TP6_GPU14_moe_ar -->
<g id="edge3545" class="edge">
<title>L11_S1_TP7_GPU15_expert1&#45;&gt;L11_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M108161.67,-604.3C108161.67,-592.88 108161.67,-583 108161.67,-583 108161.67,-583 106784.72,-583 106784.72,-583 106784.72,-583 106784.72,-547.52 106784.72,-547.52"/>
<polygon fill="black" stroke="black" points="106788.22,-547.52 106784.72,-537.52 106781.22,-547.52 106788.22,-547.52"/>
</g>
<!-- L11_S1_TP7_GPU15_expert1&#45;&gt;L11_S1_TP7_GPU15_moe_ar -->
<g id="edge3581" class="edge">
<title>L11_S1_TP7_GPU15_expert1&#45;&gt;L11_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M108204.39,-604.4C108204.39,-576.28 108204.39,-541 108204.39,-541 108204.39,-541 107471.37,-541 107471.37,-541"/>
<polygon fill="black" stroke="black" points="107471.37,-537.5 107461.37,-541 107471.37,-544.5 107471.37,-537.5"/>
</g>
<!-- L11_S1_TP0_GPU8_norm -->
<g id="node1188" class="node">
<title>L11_S1_TP0_GPU8_norm</title>
<polygon fill="none" stroke="black" points="101359.5,-332.33 100910.5,-332.33 100910.5,-264.33 101359.5,-264.33 101359.5,-332.33"/>
<text text-anchor="middle" x="101135" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="101135" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="101135" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="101135" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP0_GPU8_moe_res&#45;&gt;L11_S1_TP0_GPU8_norm -->
<g id="edge3332" class="edge">
<title>L11_S1_TP0_GPU8_moe_res&#45;&gt;L11_S1_TP0_GPU8_norm</title>
<path fill="none" stroke="black" d="M101135,-368.28C101135,-368.28 101135,-342.46 101135,-342.46"/>
<polygon fill="black" stroke="black" points="101138.5,-342.46 101135,-332.46 101131.5,-342.46 101138.5,-342.46"/>
</g>
<!-- L11_S1_TP1_GPU9_qkv_linear -->
<g id="node1189" class="node">
<title>L11_S1_TP1_GPU9_qkv_linear</title>
<polygon fill="none" stroke="black" points="102474,-1614.75 101866,-1614.75 101866,-1546.75 102474,-1546.75 102474,-1614.75"/>
<text text-anchor="middle" x="102170" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="102170" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="102170" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="102170" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L11_S1_TP1_GPU9_qkv_slice -->
<g id="node1190" class="node">
<title>L11_S1_TP1_GPU9_qkv_slice</title>
<polygon fill="none" stroke="black" points="102468,-1496.67 101872,-1496.67 101872,-1428.67 102468,-1428.67 102468,-1496.67"/>
<text text-anchor="middle" x="102170" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="102170" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="102170" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="102170" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L11_S1_TP1_GPU9_qkv_linear&#45;&gt;L11_S1_TP1_GPU9_qkv_slice -->
<g id="edge3333" class="edge">
<title>L11_S1_TP1_GPU9_qkv_linear&#45;&gt;L11_S1_TP1_GPU9_qkv_slice</title>
<path fill="none" stroke="black" d="M102170,-1546.59C102170,-1546.59 102170,-1506.74 102170,-1506.74"/>
<polygon fill="black" stroke="black" points="102173.5,-1506.74 102170,-1496.74 102166.5,-1506.74 102173.5,-1506.74"/>
</g>
<!-- L11_S1_TP1_GPU9_qkv_slice&#45;&gt;L11_S1_TP1_GPU9_attn_v -->
<g id="edge3337" class="edge">
<title>L11_S1_TP1_GPU9_qkv_slice&#45;&gt;L11_S1_TP1_GPU9_attn_v</title>
<path fill="none" stroke="black" d="M101923.25,-1428.38C101923.25,-1428.38 101923.25,-1195 101923.25,-1195"/>
<polygon fill="black" stroke="black" points="101926.75,-1195 101923.25,-1185 101919.75,-1195 101926.75,-1195"/>
</g>
<!-- L11_S1_TP1_GPU9_qk_matmul -->
<g id="node1191" class="node">
<title>L11_S1_TP1_GPU9_qk_matmul</title>
<polygon fill="none" stroke="black" points="102885.5,-1392.67 101950.5,-1392.67 101950.5,-1324.67 102885.5,-1324.67 102885.5,-1392.67"/>
<text text-anchor="middle" x="102418" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="102418" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="102418" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="102418" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L11_S1_TP1_GPU9_qkv_slice&#45;&gt;L11_S1_TP1_GPU9_qk_matmul -->
<g id="edge3334" class="edge">
<title>L11_S1_TP1_GPU9_qkv_slice&#45;&gt;L11_S1_TP1_GPU9_qk_matmul</title>
<path fill="none" stroke="black" d="M102209.25,-1428.61C102209.25,-1428.61 102209.25,-1402.8 102209.25,-1402.8"/>
<polygon fill="black" stroke="black" points="102212.75,-1402.8 102209.25,-1392.8 102205.75,-1402.8 102212.75,-1402.8"/>
</g>
<!-- L11_S1_TP1_GPU9_softmax -->
<g id="node1192" class="node">
<title>L11_S1_TP1_GPU9_softmax</title>
<polygon fill="none" stroke="black" points="102646,-1288.67 102136,-1288.67 102136,-1220.67 102646,-1220.67 102646,-1288.67"/>
<text text-anchor="middle" x="102391" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="102391" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="102391" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="102391" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L11_S1_TP1_GPU9_qk_matmul&#45;&gt;L11_S1_TP1_GPU9_softmax -->
<g id="edge3335" class="edge">
<title>L11_S1_TP1_GPU9_qk_matmul&#45;&gt;L11_S1_TP1_GPU9_softmax</title>
<path fill="none" stroke="black" d="M102391,-1324.61C102391,-1324.61 102391,-1298.8 102391,-1298.8"/>
<polygon fill="black" stroke="black" points="102394.5,-1298.8 102391,-1288.8 102387.5,-1298.8 102394.5,-1298.8"/>
</g>
<!-- L11_S1_TP1_GPU9_softmax&#45;&gt;L11_S1_TP1_GPU9_attn_v -->
<g id="edge3336" class="edge">
<title>L11_S1_TP1_GPU9_softmax&#45;&gt;L11_S1_TP1_GPU9_attn_v</title>
<path fill="none" stroke="black" d="M102391,-1220.61C102391,-1220.61 102391,-1194.8 102391,-1194.8"/>
<polygon fill="black" stroke="black" points="102394.5,-1194.8 102391,-1184.8 102387.5,-1194.8 102394.5,-1194.8"/>
</g>
<!-- L11_S1_TP1_GPU9_mha_res -->
<g id="node1194" class="node">
<title>L11_S1_TP1_GPU9_mha_res</title>
<polygon fill="none" stroke="black" points="102504.5,-948.5 101617.5,-948.5 101617.5,-880.5 102504.5,-880.5 102504.5,-948.5"/>
<text text-anchor="middle" x="102061" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="102061" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="102061" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="102061" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP1_GPU9_mha_ar&#45;&gt;L11_S1_TP1_GPU9_mha_res -->
<g id="edge3346" class="edge">
<title>L11_S1_TP1_GPU9_mha_ar&#45;&gt;L11_S1_TP1_GPU9_mha_res</title>
<path fill="none" stroke="black" d="M102481.01,-1015.66C102481.01,-1015.66 102481.01,-958.91 102481.01,-958.91"/>
<polygon fill="black" stroke="black" points="102484.51,-958.91 102481.01,-948.91 102477.51,-958.91 102484.51,-958.91"/>
</g>
<!-- L11_S1_TP1_GPU9_gate -->
<g id="node1195" class="node">
<title>L11_S1_TP1_GPU9_gate</title>
<polygon fill="none" stroke="black" points="102590.56,-844.5 101748.15,-844.5 101531.44,-708.5 102373.85,-708.5 102590.56,-844.5"/>
<text text-anchor="middle" x="102061" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="102061" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="102061" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="102061" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L11_S1_TP1_GPU9_mha_res&#45;&gt;L11_S1_TP1_GPU9_gate -->
<g id="edge3347" class="edge">
<title>L11_S1_TP1_GPU9_mha_res&#45;&gt;L11_S1_TP1_GPU9_gate</title>
<path fill="none" stroke="black" d="M102061,-880.39C102061,-880.39 102061,-854.73 102061,-854.73"/>
<polygon fill="black" stroke="black" points="102064.5,-854.73 102061,-844.73 102057.5,-854.73 102064.5,-854.73"/>
</g>
<!-- L11_S1_TP1_GPU9_moe_res -->
<g id="node1197" class="node">
<title>L11_S1_TP1_GPU9_moe_res</title>
<polygon fill="none" stroke="black" points="102469,-436.33 101649,-436.33 101649,-368.33 102469,-368.33 102469,-436.33"/>
<text text-anchor="middle" x="102059" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="102059" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="102059" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="102059" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP1_GPU9_mha_res&#45;&gt;L11_S1_TP1_GPU9_moe_res -->
<g id="edge3367" class="edge">
<title>L11_S1_TP1_GPU9_mha_res&#45;&gt;L11_S1_TP1_GPU9_moe_res</title>
<path fill="none" stroke="black" d="M101617.43,-914C101560.73,-914 101522,-914 101522,-914 101522,-914 101522,-672 101522,-672 101522,-672 101953.5,-672 101953.5,-672 101953.5,-672 101953.5,-446.49 101953.5,-446.49"/>
<polygon fill="black" stroke="black" points="101957,-446.49 101953.5,-436.49 101950,-446.49 101957,-446.49"/>
</g>
<!-- L11_S1_TP1_GPU9_gate&#45;&gt;L11_S1_TP1_GPU9_expert0 -->
<g id="edge3348" class="edge">
<title>L11_S1_TP1_GPU9_gate&#45;&gt;L11_S1_TP1_GPU9_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M102112.17,-708.31C102112.17,-708.31 102112.17,-682.71 102112.17,-682.71"/>
<polygon fill="black" stroke="black" points="102115.67,-682.71 102112.17,-672.71 102108.67,-682.71 102115.67,-682.71"/>
</g>
<!-- L11_S1_TP1_GPU9_gate&#45;&gt;L11_S1_TP1_GPU9_expert1 -->
<g id="edge3349" class="edge">
<title>L11_S1_TP1_GPU9_gate&#45;&gt;L11_S1_TP1_GPU9_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M102510.14,-776.4C102510.14,-776.4 102510.14,-682.74 102510.14,-682.74"/>
<polygon fill="black" stroke="black" points="102513.64,-682.74 102510.14,-672.74 102506.64,-682.74 102513.64,-682.74"/>
</g>
<!-- L11_S1_TP1_GPU9_moe_ar&#45;&gt;L11_S1_TP1_GPU9_moe_res -->
<g id="edge3366" class="edge">
<title>L11_S1_TP1_GPU9_moe_ar&#45;&gt;L11_S1_TP1_GPU9_moe_res</title>
<path fill="none" stroke="black" d="M102766.27,-492.05C102766.27,-457.02 102766.27,-402 102766.27,-402 102766.27,-402 102479.14,-402 102479.14,-402"/>
<polygon fill="black" stroke="black" points="102479.14,-398.5 102469.14,-402 102479.14,-405.5 102479.14,-398.5"/>
</g>
<!-- L11_S1_TP1_GPU9_norm -->
<g id="node1198" class="node">
<title>L11_S1_TP1_GPU9_norm</title>
<polygon fill="none" stroke="black" points="102283.5,-332.33 101834.5,-332.33 101834.5,-264.33 102283.5,-264.33 102283.5,-332.33"/>
<text text-anchor="middle" x="102059" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="102059" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="102059" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="102059" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP1_GPU9_moe_res&#45;&gt;L11_S1_TP1_GPU9_norm -->
<g id="edge3368" class="edge">
<title>L11_S1_TP1_GPU9_moe_res&#45;&gt;L11_S1_TP1_GPU9_norm</title>
<path fill="none" stroke="black" d="M102059,-368.28C102059,-368.28 102059,-342.46 102059,-342.46"/>
<polygon fill="black" stroke="black" points="102062.5,-342.46 102059,-332.46 102055.5,-342.46 102062.5,-342.46"/>
</g>
<!-- L11_S1_TP2_GPU10_qkv_linear -->
<g id="node1199" class="node">
<title>L11_S1_TP2_GPU10_qkv_linear</title>
<polygon fill="none" stroke="black" points="103474,-1614.75 102866,-1614.75 102866,-1546.75 103474,-1546.75 103474,-1614.75"/>
<text text-anchor="middle" x="103170" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="103170" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="103170" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="103170" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L11_S1_TP2_GPU10_qkv_slice -->
<g id="node1200" class="node">
<title>L11_S1_TP2_GPU10_qkv_slice</title>
<polygon fill="none" stroke="black" points="103468,-1496.67 102872,-1496.67 102872,-1428.67 103468,-1428.67 103468,-1496.67"/>
<text text-anchor="middle" x="103170" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="103170" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="103170" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="103170" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L11_S1_TP2_GPU10_qkv_linear&#45;&gt;L11_S1_TP2_GPU10_qkv_slice -->
<g id="edge3369" class="edge">
<title>L11_S1_TP2_GPU10_qkv_linear&#45;&gt;L11_S1_TP2_GPU10_qkv_slice</title>
<path fill="none" stroke="black" d="M103170,-1546.59C103170,-1546.59 103170,-1506.74 103170,-1506.74"/>
<polygon fill="black" stroke="black" points="103173.5,-1506.74 103170,-1496.74 103166.5,-1506.74 103173.5,-1506.74"/>
</g>
<!-- L11_S1_TP2_GPU10_qkv_slice&#45;&gt;L11_S1_TP2_GPU10_attn_v -->
<g id="edge3373" class="edge">
<title>L11_S1_TP2_GPU10_qkv_slice&#45;&gt;L11_S1_TP2_GPU10_attn_v</title>
<path fill="none" stroke="black" d="M102918,-1428.38C102918,-1428.38 102918,-1195 102918,-1195"/>
<polygon fill="black" stroke="black" points="102921.5,-1195 102918,-1185 102914.5,-1195 102921.5,-1195"/>
</g>
<!-- L11_S1_TP2_GPU10_qk_matmul -->
<g id="node1201" class="node">
<title>L11_S1_TP2_GPU10_qk_matmul</title>
<polygon fill="none" stroke="black" points="103885.5,-1392.67 102950.5,-1392.67 102950.5,-1324.67 103885.5,-1324.67 103885.5,-1392.67"/>
<text text-anchor="middle" x="103418" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="103418" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="103418" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="103418" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L11_S1_TP2_GPU10_qkv_slice&#45;&gt;L11_S1_TP2_GPU10_qk_matmul -->
<g id="edge3370" class="edge">
<title>L11_S1_TP2_GPU10_qkv_slice&#45;&gt;L11_S1_TP2_GPU10_qk_matmul</title>
<path fill="none" stroke="black" d="M103209.25,-1428.61C103209.25,-1428.61 103209.25,-1402.8 103209.25,-1402.8"/>
<polygon fill="black" stroke="black" points="103212.75,-1402.8 103209.25,-1392.8 103205.75,-1402.8 103212.75,-1402.8"/>
</g>
<!-- L11_S1_TP2_GPU10_softmax -->
<g id="node1202" class="node">
<title>L11_S1_TP2_GPU10_softmax</title>
<polygon fill="none" stroke="black" points="103624,-1288.67 103114,-1288.67 103114,-1220.67 103624,-1220.67 103624,-1288.67"/>
<text text-anchor="middle" x="103369" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="103369" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="103369" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="103369" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L11_S1_TP2_GPU10_qk_matmul&#45;&gt;L11_S1_TP2_GPU10_softmax -->
<g id="edge3371" class="edge">
<title>L11_S1_TP2_GPU10_qk_matmul&#45;&gt;L11_S1_TP2_GPU10_softmax</title>
<path fill="none" stroke="black" d="M103369,-1324.61C103369,-1324.61 103369,-1298.8 103369,-1298.8"/>
<polygon fill="black" stroke="black" points="103372.5,-1298.8 103369,-1288.8 103365.5,-1298.8 103372.5,-1298.8"/>
</g>
<!-- L11_S1_TP2_GPU10_softmax&#45;&gt;L11_S1_TP2_GPU10_attn_v -->
<g id="edge3372" class="edge">
<title>L11_S1_TP2_GPU10_softmax&#45;&gt;L11_S1_TP2_GPU10_attn_v</title>
<path fill="none" stroke="black" d="M103369,-1220.61C103369,-1220.61 103369,-1194.8 103369,-1194.8"/>
<polygon fill="black" stroke="black" points="103372.5,-1194.8 103369,-1184.8 103365.5,-1194.8 103372.5,-1194.8"/>
</g>
<!-- L11_S1_TP2_GPU10_mha_res -->
<g id="node1204" class="node">
<title>L11_S1_TP2_GPU10_mha_res</title>
<polygon fill="none" stroke="black" points="103582.5,-948.5 102695.5,-948.5 102695.5,-880.5 103582.5,-880.5 103582.5,-948.5"/>
<text text-anchor="middle" x="103139" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="103139" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="103139" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="103139" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP2_GPU10_mha_ar&#45;&gt;L11_S1_TP2_GPU10_mha_res -->
<g id="edge3382" class="edge">
<title>L11_S1_TP2_GPU10_mha_ar&#45;&gt;L11_S1_TP2_GPU10_mha_res</title>
<path fill="none" stroke="black" d="M103404.51,-991.61C103404.51,-991.61 103404.51,-958.74 103404.51,-958.74"/>
<polygon fill="black" stroke="black" points="103408.01,-958.74 103404.51,-948.74 103401.01,-958.74 103408.01,-958.74"/>
</g>
<!-- L11_S1_TP2_GPU10_gate -->
<g id="node1205" class="node">
<title>L11_S1_TP2_GPU10_gate</title>
<polygon fill="none" stroke="black" points="103668.56,-844.5 102826.15,-844.5 102609.44,-708.5 103451.85,-708.5 103668.56,-844.5"/>
<text text-anchor="middle" x="103139" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="103139" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="103139" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="103139" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L11_S1_TP2_GPU10_mha_res&#45;&gt;L11_S1_TP2_GPU10_gate -->
<g id="edge3383" class="edge">
<title>L11_S1_TP2_GPU10_mha_res&#45;&gt;L11_S1_TP2_GPU10_gate</title>
<path fill="none" stroke="black" d="M103139,-880.39C103139,-880.39 103139,-854.73 103139,-854.73"/>
<polygon fill="black" stroke="black" points="103142.5,-854.73 103139,-844.73 103135.5,-854.73 103142.5,-854.73"/>
</g>
<!-- L11_S1_TP2_GPU10_moe_res -->
<g id="node1207" class="node">
<title>L11_S1_TP2_GPU10_moe_res</title>
<polygon fill="none" stroke="black" points="103650,-436.33 102830,-436.33 102830,-368.33 103650,-368.33 103650,-436.33"/>
<text text-anchor="middle" x="103240" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="103240" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="103240" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="103240" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP2_GPU10_mha_res&#45;&gt;L11_S1_TP2_GPU10_moe_res -->
<g id="edge3403" class="edge">
<title>L11_S1_TP2_GPU10_mha_res&#45;&gt;L11_S1_TP2_GPU10_moe_res</title>
<path fill="none" stroke="black" d="M103582.57,-914C103639.27,-914 103678,-914 103678,-914 103678,-914 103678,-678 103678,-678 103678,-678 103355.79,-678 103355.79,-678 103355.79,-678 103355.79,-585 103355.79,-585 103355.79,-585 103383.51,-585 103383.51,-585 103383.51,-585 103383.51,-446.69 103383.51,-446.69"/>
<polygon fill="black" stroke="black" points="103387.01,-446.69 103383.51,-436.69 103380.01,-446.69 103387.01,-446.69"/>
</g>
<!-- L11_S1_TP2_GPU10_gate&#45;&gt;L11_S1_TP2_GPU10_expert0 -->
<g id="edge3384" class="edge">
<title>L11_S1_TP2_GPU10_gate&#45;&gt;L11_S1_TP2_GPU10_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M103008.75,-708.31C103008.75,-708.31 103008.75,-682.71 103008.75,-682.71"/>
<polygon fill="black" stroke="black" points="103012.25,-682.71 103008.75,-672.71 103005.25,-682.71 103012.25,-682.71"/>
</g>
<!-- L11_S1_TP2_GPU10_gate&#45;&gt;L11_S1_TP2_GPU10_expert1 -->
<g id="edge3385" class="edge">
<title>L11_S1_TP2_GPU10_gate&#45;&gt;L11_S1_TP2_GPU10_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M103516.14,-748.57C103516.14,-748.57 103516.14,-682.74 103516.14,-682.74"/>
<polygon fill="black" stroke="black" points="103519.64,-682.74 103516.14,-672.74 103512.64,-682.74 103519.64,-682.74"/>
</g>
<!-- L11_S1_TP2_GPU10_moe_ar&#45;&gt;L11_S1_TP2_GPU10_moe_res -->
<g id="edge3402" class="edge">
<title>L11_S1_TP2_GPU10_moe_ar&#45;&gt;L11_S1_TP2_GPU10_moe_res</title>
<path fill="none" stroke="black" d="M103563.18,-478.12C103563.18,-478.12 103563.18,-446.58 103563.18,-446.58"/>
<polygon fill="black" stroke="black" points="103566.68,-446.58 103563.18,-436.58 103559.68,-446.58 103566.68,-446.58"/>
</g>
<!-- L11_S1_TP2_GPU10_norm -->
<g id="node1208" class="node">
<title>L11_S1_TP2_GPU10_norm</title>
<polygon fill="none" stroke="black" points="103464.5,-332.33 103015.5,-332.33 103015.5,-264.33 103464.5,-264.33 103464.5,-332.33"/>
<text text-anchor="middle" x="103240" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="103240" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="103240" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="103240" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP2_GPU10_moe_res&#45;&gt;L11_S1_TP2_GPU10_norm -->
<g id="edge3404" class="edge">
<title>L11_S1_TP2_GPU10_moe_res&#45;&gt;L11_S1_TP2_GPU10_norm</title>
<path fill="none" stroke="black" d="M103240,-368.28C103240,-368.28 103240,-342.46 103240,-342.46"/>
<polygon fill="black" stroke="black" points="103243.5,-342.46 103240,-332.46 103236.5,-342.46 103243.5,-342.46"/>
</g>
<!-- L11_S1_TP3_GPU11_qkv_linear -->
<g id="node1209" class="node">
<title>L11_S1_TP3_GPU11_qkv_linear</title>
<polygon fill="none" stroke="black" points="104470,-1614.75 103862,-1614.75 103862,-1546.75 104470,-1546.75 104470,-1614.75"/>
<text text-anchor="middle" x="104166" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="104166" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="104166" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="104166" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L11_S1_TP3_GPU11_qkv_slice -->
<g id="node1210" class="node">
<title>L11_S1_TP3_GPU11_qkv_slice</title>
<polygon fill="none" stroke="black" points="104464,-1496.67 103868,-1496.67 103868,-1428.67 104464,-1428.67 104464,-1496.67"/>
<text text-anchor="middle" x="104166" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="104166" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="104166" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="104166" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L11_S1_TP3_GPU11_qkv_linear&#45;&gt;L11_S1_TP3_GPU11_qkv_slice -->
<g id="edge3405" class="edge">
<title>L11_S1_TP3_GPU11_qkv_linear&#45;&gt;L11_S1_TP3_GPU11_qkv_slice</title>
<path fill="none" stroke="black" d="M104166,-1546.59C104166,-1546.59 104166,-1506.74 104166,-1506.74"/>
<polygon fill="black" stroke="black" points="104169.5,-1506.74 104166,-1496.74 104162.5,-1506.74 104169.5,-1506.74"/>
</g>
<!-- L11_S1_TP3_GPU11_qkv_slice&#45;&gt;L11_S1_TP3_GPU11_attn_v -->
<g id="edge3409" class="edge">
<title>L11_S1_TP3_GPU11_qkv_slice&#45;&gt;L11_S1_TP3_GPU11_attn_v</title>
<path fill="none" stroke="black" d="M103916,-1428.38C103916,-1428.38 103916,-1195 103916,-1195"/>
<polygon fill="black" stroke="black" points="103919.5,-1195 103916,-1185 103912.5,-1195 103919.5,-1195"/>
</g>
<!-- L11_S1_TP3_GPU11_qk_matmul -->
<g id="node1211" class="node">
<title>L11_S1_TP3_GPU11_qk_matmul</title>
<polygon fill="none" stroke="black" points="104881.5,-1392.67 103946.5,-1392.67 103946.5,-1324.67 104881.5,-1324.67 104881.5,-1392.67"/>
<text text-anchor="middle" x="104414" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="104414" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="104414" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="104414" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L11_S1_TP3_GPU11_qkv_slice&#45;&gt;L11_S1_TP3_GPU11_qk_matmul -->
<g id="edge3406" class="edge">
<title>L11_S1_TP3_GPU11_qkv_slice&#45;&gt;L11_S1_TP3_GPU11_qk_matmul</title>
<path fill="none" stroke="black" d="M104205.25,-1428.61C104205.25,-1428.61 104205.25,-1402.8 104205.25,-1402.8"/>
<polygon fill="black" stroke="black" points="104208.75,-1402.8 104205.25,-1392.8 104201.75,-1402.8 104208.75,-1402.8"/>
</g>
<!-- L11_S1_TP3_GPU11_softmax -->
<g id="node1212" class="node">
<title>L11_S1_TP3_GPU11_softmax</title>
<polygon fill="none" stroke="black" points="104600,-1288.67 104090,-1288.67 104090,-1220.67 104600,-1220.67 104600,-1288.67"/>
<text text-anchor="middle" x="104345" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="104345" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="104345" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="104345" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L11_S1_TP3_GPU11_qk_matmul&#45;&gt;L11_S1_TP3_GPU11_softmax -->
<g id="edge3407" class="edge">
<title>L11_S1_TP3_GPU11_qk_matmul&#45;&gt;L11_S1_TP3_GPU11_softmax</title>
<path fill="none" stroke="black" d="M104345,-1324.61C104345,-1324.61 104345,-1298.8 104345,-1298.8"/>
<polygon fill="black" stroke="black" points="104348.5,-1298.8 104345,-1288.8 104341.5,-1298.8 104348.5,-1298.8"/>
</g>
<!-- L11_S1_TP3_GPU11_softmax&#45;&gt;L11_S1_TP3_GPU11_attn_v -->
<g id="edge3408" class="edge">
<title>L11_S1_TP3_GPU11_softmax&#45;&gt;L11_S1_TP3_GPU11_attn_v</title>
<path fill="none" stroke="black" d="M104345,-1220.61C104345,-1220.61 104345,-1194.8 104345,-1194.8"/>
<polygon fill="black" stroke="black" points="104348.5,-1194.8 104345,-1184.8 104341.5,-1194.8 104348.5,-1194.8"/>
</g>
<!-- L11_S1_TP3_GPU11_mha_res -->
<g id="node1214" class="node">
<title>L11_S1_TP3_GPU11_mha_res</title>
<polygon fill="none" stroke="black" points="104660.5,-948.5 103773.5,-948.5 103773.5,-880.5 104660.5,-880.5 104660.5,-948.5"/>
<text text-anchor="middle" x="104217" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="104217" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="104217" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="104217" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP3_GPU11_mha_ar&#45;&gt;L11_S1_TP3_GPU11_mha_res -->
<g id="edge3418" class="edge">
<title>L11_S1_TP3_GPU11_mha_ar&#45;&gt;L11_S1_TP3_GPU11_mha_res</title>
<path fill="none" stroke="black" d="M104328.01,-984.55C104328.01,-984.55 104328.01,-958.73 104328.01,-958.73"/>
<polygon fill="black" stroke="black" points="104331.51,-958.73 104328.01,-948.73 104324.51,-958.73 104331.51,-958.73"/>
</g>
<!-- L11_S1_TP3_GPU11_gate -->
<g id="node1215" class="node">
<title>L11_S1_TP3_GPU11_gate</title>
<polygon fill="none" stroke="black" points="104746.56,-844.5 103904.15,-844.5 103687.44,-708.5 104529.85,-708.5 104746.56,-844.5"/>
<text text-anchor="middle" x="104217" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="104217" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="104217" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="104217" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L11_S1_TP3_GPU11_mha_res&#45;&gt;L11_S1_TP3_GPU11_gate -->
<g id="edge3419" class="edge">
<title>L11_S1_TP3_GPU11_mha_res&#45;&gt;L11_S1_TP3_GPU11_gate</title>
<path fill="none" stroke="black" d="M104217,-880.39C104217,-880.39 104217,-854.73 104217,-854.73"/>
<polygon fill="black" stroke="black" points="104220.5,-854.73 104217,-844.73 104213.5,-854.73 104220.5,-854.73"/>
</g>
<!-- L11_S1_TP3_GPU11_moe_res -->
<g id="node1217" class="node">
<title>L11_S1_TP3_GPU11_moe_res</title>
<polygon fill="none" stroke="black" points="104660,-436.33 103840,-436.33 103840,-368.33 104660,-368.33 104660,-436.33"/>
<text text-anchor="middle" x="104250" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="104250" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="104250" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="104250" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP3_GPU11_mha_res&#45;&gt;L11_S1_TP3_GPU11_moe_res -->
<g id="edge3439" class="edge">
<title>L11_S1_TP3_GPU11_mha_res&#45;&gt;L11_S1_TP3_GPU11_moe_res</title>
<path fill="none" stroke="black" d="M104660.64,-903C104718.82,-903 104758.75,-903 104758.75,-903 104758.75,-903 104758.75,-390 104758.75,-390 104758.75,-390 104670.06,-390 104670.06,-390"/>
<polygon fill="black" stroke="black" points="104670.06,-386.5 104660.06,-390 104670.06,-393.5 104670.06,-386.5"/>
</g>
<!-- L11_S1_TP3_GPU11_gate&#45;&gt;L11_S1_TP3_GPU11_expert0 -->
<g id="edge3420" class="edge">
<title>L11_S1_TP3_GPU11_gate&#45;&gt;L11_S1_TP3_GPU11_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M103980.17,-708.31C103980.17,-708.31 103980.17,-682.71 103980.17,-682.71"/>
<polygon fill="black" stroke="black" points="103983.67,-682.71 103980.17,-672.71 103976.67,-682.71 103983.67,-682.71"/>
</g>
<!-- L11_S1_TP3_GPU11_gate&#45;&gt;L11_S1_TP3_GPU11_expert1 -->
<g id="edge3421" class="edge">
<title>L11_S1_TP3_GPU11_gate&#45;&gt;L11_S1_TP3_GPU11_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M104409.75,-708.31C104409.75,-708.31 104409.75,-682.71 104409.75,-682.71"/>
<polygon fill="black" stroke="black" points="104413.25,-682.71 104409.75,-672.71 104406.25,-682.71 104413.25,-682.71"/>
</g>
<!-- L11_S1_TP3_GPU11_moe_ar&#45;&gt;L11_S1_TP3_GPU11_moe_res -->
<g id="edge3438" class="edge">
<title>L11_S1_TP3_GPU11_moe_ar&#45;&gt;L11_S1_TP3_GPU11_moe_res</title>
<path fill="none" stroke="black" d="M104465.51,-472.73C104465.51,-472.73 104465.51,-446.41 104465.51,-446.41"/>
<polygon fill="black" stroke="black" points="104469.01,-446.41 104465.51,-436.41 104462.01,-446.41 104469.01,-446.41"/>
</g>
<!-- L11_S1_TP3_GPU11_norm -->
<g id="node1218" class="node">
<title>L11_S1_TP3_GPU11_norm</title>
<polygon fill="none" stroke="black" points="104474.5,-332.33 104025.5,-332.33 104025.5,-264.33 104474.5,-264.33 104474.5,-332.33"/>
<text text-anchor="middle" x="104250" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="104250" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="104250" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="104250" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP3_GPU11_moe_res&#45;&gt;L11_S1_TP3_GPU11_norm -->
<g id="edge3440" class="edge">
<title>L11_S1_TP3_GPU11_moe_res&#45;&gt;L11_S1_TP3_GPU11_norm</title>
<path fill="none" stroke="black" d="M104250,-368.28C104250,-368.28 104250,-342.46 104250,-342.46"/>
<polygon fill="black" stroke="black" points="104253.5,-342.46 104250,-332.46 104246.5,-342.46 104253.5,-342.46"/>
</g>
<!-- L11_S1_TP4_GPU12_qkv_linear -->
<g id="node1219" class="node">
<title>L11_S1_TP4_GPU12_qkv_linear</title>
<polygon fill="none" stroke="black" points="105464,-1614.75 104856,-1614.75 104856,-1546.75 105464,-1546.75 105464,-1614.75"/>
<text text-anchor="middle" x="105160" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="105160" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="105160" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="105160" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L11_S1_TP4_GPU12_qkv_slice -->
<g id="node1220" class="node">
<title>L11_S1_TP4_GPU12_qkv_slice</title>
<polygon fill="none" stroke="black" points="105458,-1496.67 104862,-1496.67 104862,-1428.67 105458,-1428.67 105458,-1496.67"/>
<text text-anchor="middle" x="105160" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="105160" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="105160" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="105160" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L11_S1_TP4_GPU12_qkv_linear&#45;&gt;L11_S1_TP4_GPU12_qkv_slice -->
<g id="edge3441" class="edge">
<title>L11_S1_TP4_GPU12_qkv_linear&#45;&gt;L11_S1_TP4_GPU12_qkv_slice</title>
<path fill="none" stroke="black" d="M105160,-1546.59C105160,-1546.59 105160,-1506.74 105160,-1506.74"/>
<polygon fill="black" stroke="black" points="105163.5,-1506.74 105160,-1496.74 105156.5,-1506.74 105163.5,-1506.74"/>
</g>
<!-- L11_S1_TP4_GPU12_qkv_slice&#45;&gt;L11_S1_TP4_GPU12_attn_v -->
<g id="edge3445" class="edge">
<title>L11_S1_TP4_GPU12_qkv_slice&#45;&gt;L11_S1_TP4_GPU12_attn_v</title>
<path fill="none" stroke="black" d="M104911,-1428.38C104911,-1428.38 104911,-1195 104911,-1195"/>
<polygon fill="black" stroke="black" points="104914.5,-1195 104911,-1185 104907.5,-1195 104914.5,-1195"/>
</g>
<!-- L11_S1_TP4_GPU12_qk_matmul -->
<g id="node1221" class="node">
<title>L11_S1_TP4_GPU12_qk_matmul</title>
<polygon fill="none" stroke="black" points="105875.5,-1392.67 104940.5,-1392.67 104940.5,-1324.67 105875.5,-1324.67 105875.5,-1392.67"/>
<text text-anchor="middle" x="105408" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="105408" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="105408" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="105408" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L11_S1_TP4_GPU12_qkv_slice&#45;&gt;L11_S1_TP4_GPU12_qk_matmul -->
<g id="edge3442" class="edge">
<title>L11_S1_TP4_GPU12_qkv_slice&#45;&gt;L11_S1_TP4_GPU12_qk_matmul</title>
<path fill="none" stroke="black" d="M105199.25,-1428.61C105199.25,-1428.61 105199.25,-1402.8 105199.25,-1402.8"/>
<polygon fill="black" stroke="black" points="105202.75,-1402.8 105199.25,-1392.8 105195.75,-1402.8 105202.75,-1402.8"/>
</g>
<!-- L11_S1_TP4_GPU12_softmax -->
<g id="node1222" class="node">
<title>L11_S1_TP4_GPU12_softmax</title>
<polygon fill="none" stroke="black" points="105575,-1288.67 105065,-1288.67 105065,-1220.67 105575,-1220.67 105575,-1288.67"/>
<text text-anchor="middle" x="105320" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="105320" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="105320" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="105320" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L11_S1_TP4_GPU12_qk_matmul&#45;&gt;L11_S1_TP4_GPU12_softmax -->
<g id="edge3443" class="edge">
<title>L11_S1_TP4_GPU12_qk_matmul&#45;&gt;L11_S1_TP4_GPU12_softmax</title>
<path fill="none" stroke="black" d="M105320,-1324.61C105320,-1324.61 105320,-1298.8 105320,-1298.8"/>
<polygon fill="black" stroke="black" points="105323.5,-1298.8 105320,-1288.8 105316.5,-1298.8 105323.5,-1298.8"/>
</g>
<!-- L11_S1_TP4_GPU12_softmax&#45;&gt;L11_S1_TP4_GPU12_attn_v -->
<g id="edge3444" class="edge">
<title>L11_S1_TP4_GPU12_softmax&#45;&gt;L11_S1_TP4_GPU12_attn_v</title>
<path fill="none" stroke="black" d="M105320,-1220.61C105320,-1220.61 105320,-1194.8 105320,-1194.8"/>
<polygon fill="black" stroke="black" points="105323.5,-1194.8 105320,-1184.8 105316.5,-1194.8 105323.5,-1194.8"/>
</g>
<!-- L11_S1_TP4_GPU12_mha_res -->
<g id="node1224" class="node">
<title>L11_S1_TP4_GPU12_mha_res</title>
<polygon fill="none" stroke="black" points="105738.5,-948.5 104851.5,-948.5 104851.5,-880.5 105738.5,-880.5 105738.5,-948.5"/>
<text text-anchor="middle" x="105295" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="105295" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="105295" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="105295" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP4_GPU12_mha_ar&#45;&gt;L11_S1_TP4_GPU12_mha_res -->
<g id="edge3454" class="edge">
<title>L11_S1_TP4_GPU12_mha_ar&#45;&gt;L11_S1_TP4_GPU12_mha_res</title>
<path fill="none" stroke="black" d="M105183.49,-984.55C105183.49,-984.55 105183.49,-958.73 105183.49,-958.73"/>
<polygon fill="black" stroke="black" points="105186.99,-958.73 105183.49,-948.73 105179.99,-958.73 105186.99,-958.73"/>
</g>
<!-- L11_S1_TP4_GPU12_gate -->
<g id="node1225" class="node">
<title>L11_S1_TP4_GPU12_gate</title>
<polygon fill="none" stroke="black" points="105824.56,-844.5 104982.15,-844.5 104765.44,-708.5 105607.85,-708.5 105824.56,-844.5"/>
<text text-anchor="middle" x="105295" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="105295" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="105295" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="105295" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L11_S1_TP4_GPU12_mha_res&#45;&gt;L11_S1_TP4_GPU12_gate -->
<g id="edge3455" class="edge">
<title>L11_S1_TP4_GPU12_mha_res&#45;&gt;L11_S1_TP4_GPU12_gate</title>
<path fill="none" stroke="black" d="M105295,-880.39C105295,-880.39 105295,-854.73 105295,-854.73"/>
<polygon fill="black" stroke="black" points="105298.5,-854.73 105295,-844.73 105291.5,-854.73 105298.5,-854.73"/>
</g>
<!-- L11_S1_TP4_GPU12_moe_res -->
<g id="node1227" class="node">
<title>L11_S1_TP4_GPU12_moe_res</title>
<polygon fill="none" stroke="black" points="105590,-436.33 104770,-436.33 104770,-368.33 105590,-368.33 105590,-436.33"/>
<text text-anchor="middle" x="105180" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="105180" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="105180" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="105180" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP4_GPU12_mha_res&#45;&gt;L11_S1_TP4_GPU12_moe_res -->
<g id="edge3475" class="edge">
<title>L11_S1_TP4_GPU12_mha_res&#45;&gt;L11_S1_TP4_GPU12_moe_res</title>
<path fill="none" stroke="black" d="M104851.4,-925C104797.58,-925 104761.14,-925 104761.14,-925 104761.14,-925 104761.14,-413 104761.14,-413 104761.14,-413 104762.02,-413 104762.02,-413"/>
<polygon fill="black" stroke="black" points="104759.89,-416.5 104769.89,-413 104759.89,-409.5 104759.89,-416.5"/>
</g>
<!-- L11_S1_TP4_GPU12_gate&#45;&gt;L11_S1_TP4_GPU12_expert0 -->
<g id="edge3456" class="edge">
<title>L11_S1_TP4_GPU12_gate&#45;&gt;L11_S1_TP4_GPU12_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M105101.43,-708.31C105101.43,-708.31 105101.43,-682.71 105101.43,-682.71"/>
<polygon fill="black" stroke="black" points="105104.93,-682.71 105101.43,-672.71 105097.93,-682.71 105104.93,-682.71"/>
</g>
<!-- L11_S1_TP4_GPU12_gate&#45;&gt;L11_S1_TP4_GPU12_expert1 -->
<g id="edge3457" class="edge">
<title>L11_S1_TP4_GPU12_gate&#45;&gt;L11_S1_TP4_GPU12_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M105530.83,-708.31C105530.83,-708.31 105530.83,-682.71 105530.83,-682.71"/>
<polygon fill="black" stroke="black" points="105534.33,-682.71 105530.83,-672.71 105527.33,-682.71 105534.33,-682.71"/>
</g>
<!-- L11_S1_TP4_GPU12_moe_ar&#45;&gt;L11_S1_TP4_GPU12_moe_res -->
<g id="edge3474" class="edge">
<title>L11_S1_TP4_GPU12_moe_ar&#45;&gt;L11_S1_TP4_GPU12_moe_res</title>
<path fill="none" stroke="black" d="M105101.23,-472.05C105101.23,-472.05 105101.23,-446.37 105101.23,-446.37"/>
<polygon fill="black" stroke="black" points="105104.73,-446.37 105101.23,-436.37 105097.73,-446.37 105104.73,-446.37"/>
</g>
<!-- L11_S1_TP4_GPU12_norm -->
<g id="node1228" class="node">
<title>L11_S1_TP4_GPU12_norm</title>
<polygon fill="none" stroke="black" points="105404.5,-332.33 104955.5,-332.33 104955.5,-264.33 105404.5,-264.33 105404.5,-332.33"/>
<text text-anchor="middle" x="105180" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="105180" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="105180" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="105180" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP4_GPU12_moe_res&#45;&gt;L11_S1_TP4_GPU12_norm -->
<g id="edge3476" class="edge">
<title>L11_S1_TP4_GPU12_moe_res&#45;&gt;L11_S1_TP4_GPU12_norm</title>
<path fill="none" stroke="black" d="M105180,-368.28C105180,-368.28 105180,-342.46 105180,-342.46"/>
<polygon fill="black" stroke="black" points="105183.5,-342.46 105180,-332.46 105176.5,-342.46 105183.5,-342.46"/>
</g>
<!-- L11_S1_TP5_GPU13_qkv_linear -->
<g id="node1229" class="node">
<title>L11_S1_TP5_GPU13_qkv_linear</title>
<polygon fill="none" stroke="black" points="106457,-1614.75 105849,-1614.75 105849,-1546.75 106457,-1546.75 106457,-1614.75"/>
<text text-anchor="middle" x="106153" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="106153" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="106153" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="106153" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L11_S1_TP5_GPU13_qkv_slice -->
<g id="node1230" class="node">
<title>L11_S1_TP5_GPU13_qkv_slice</title>
<polygon fill="none" stroke="black" points="106451,-1496.67 105855,-1496.67 105855,-1428.67 106451,-1428.67 106451,-1496.67"/>
<text text-anchor="middle" x="106153" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="106153" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="106153" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="106153" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L11_S1_TP5_GPU13_qkv_linear&#45;&gt;L11_S1_TP5_GPU13_qkv_slice -->
<g id="edge3477" class="edge">
<title>L11_S1_TP5_GPU13_qkv_linear&#45;&gt;L11_S1_TP5_GPU13_qkv_slice</title>
<path fill="none" stroke="black" d="M106153,-1546.59C106153,-1546.59 106153,-1506.74 106153,-1506.74"/>
<polygon fill="black" stroke="black" points="106156.5,-1506.74 106153,-1496.74 106149.5,-1506.74 106156.5,-1506.74"/>
</g>
<!-- L11_S1_TP5_GPU13_qkv_slice&#45;&gt;L11_S1_TP5_GPU13_attn_v -->
<g id="edge3481" class="edge">
<title>L11_S1_TP5_GPU13_qkv_slice&#45;&gt;L11_S1_TP5_GPU13_attn_v</title>
<path fill="none" stroke="black" d="M105904.5,-1428.38C105904.5,-1428.38 105904.5,-1195 105904.5,-1195"/>
<polygon fill="black" stroke="black" points="105908,-1195 105904.5,-1185 105901,-1195 105908,-1195"/>
</g>
<!-- L11_S1_TP5_GPU13_qk_matmul -->
<g id="node1231" class="node">
<title>L11_S1_TP5_GPU13_qk_matmul</title>
<polygon fill="none" stroke="black" points="106868.5,-1392.67 105933.5,-1392.67 105933.5,-1324.67 106868.5,-1324.67 106868.5,-1392.67"/>
<text text-anchor="middle" x="106401" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="106401" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="106401" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="106401" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L11_S1_TP5_GPU13_qkv_slice&#45;&gt;L11_S1_TP5_GPU13_qk_matmul -->
<g id="edge3478" class="edge">
<title>L11_S1_TP5_GPU13_qkv_slice&#45;&gt;L11_S1_TP5_GPU13_qk_matmul</title>
<path fill="none" stroke="black" d="M106192.25,-1428.61C106192.25,-1428.61 106192.25,-1402.8 106192.25,-1402.8"/>
<polygon fill="black" stroke="black" points="106195.75,-1402.8 106192.25,-1392.8 106188.75,-1402.8 106195.75,-1402.8"/>
</g>
<!-- L11_S1_TP5_GPU13_softmax -->
<g id="node1232" class="node">
<title>L11_S1_TP5_GPU13_softmax</title>
<polygon fill="none" stroke="black" points="106550,-1288.67 106040,-1288.67 106040,-1220.67 106550,-1220.67 106550,-1288.67"/>
<text text-anchor="middle" x="106295" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="106295" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="106295" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="106295" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L11_S1_TP5_GPU13_qk_matmul&#45;&gt;L11_S1_TP5_GPU13_softmax -->
<g id="edge3479" class="edge">
<title>L11_S1_TP5_GPU13_qk_matmul&#45;&gt;L11_S1_TP5_GPU13_softmax</title>
<path fill="none" stroke="black" d="M106295,-1324.61C106295,-1324.61 106295,-1298.8 106295,-1298.8"/>
<polygon fill="black" stroke="black" points="106298.5,-1298.8 106295,-1288.8 106291.5,-1298.8 106298.5,-1298.8"/>
</g>
<!-- L11_S1_TP5_GPU13_softmax&#45;&gt;L11_S1_TP5_GPU13_attn_v -->
<g id="edge3480" class="edge">
<title>L11_S1_TP5_GPU13_softmax&#45;&gt;L11_S1_TP5_GPU13_attn_v</title>
<path fill="none" stroke="black" d="M106295,-1220.61C106295,-1220.61 106295,-1194.8 106295,-1194.8"/>
<polygon fill="black" stroke="black" points="106298.5,-1194.8 106295,-1184.8 106291.5,-1194.8 106298.5,-1194.8"/>
</g>
<!-- L11_S1_TP5_GPU13_mha_res -->
<g id="node1234" class="node">
<title>L11_S1_TP5_GPU13_mha_res</title>
<polygon fill="none" stroke="black" points="106816.5,-948.5 105929.5,-948.5 105929.5,-880.5 106816.5,-880.5 106816.5,-948.5"/>
<text text-anchor="middle" x="106373" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="106373" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="106373" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="106373" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP5_GPU13_mha_ar&#45;&gt;L11_S1_TP5_GPU13_mha_res -->
<g id="edge3490" class="edge">
<title>L11_S1_TP5_GPU13_mha_ar&#45;&gt;L11_S1_TP5_GPU13_mha_res</title>
<path fill="none" stroke="black" d="M106106.99,-991.61C106106.99,-991.61 106106.99,-958.74 106106.99,-958.74"/>
<polygon fill="black" stroke="black" points="106110.49,-958.74 106106.99,-948.74 106103.49,-958.74 106110.49,-958.74"/>
</g>
<!-- L11_S1_TP5_GPU13_gate -->
<g id="node1235" class="node">
<title>L11_S1_TP5_GPU13_gate</title>
<polygon fill="none" stroke="black" points="106902.56,-844.5 106060.15,-844.5 105843.44,-708.5 106685.85,-708.5 106902.56,-844.5"/>
<text text-anchor="middle" x="106373" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="106373" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="106373" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="106373" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L11_S1_TP5_GPU13_mha_res&#45;&gt;L11_S1_TP5_GPU13_gate -->
<g id="edge3491" class="edge">
<title>L11_S1_TP5_GPU13_mha_res&#45;&gt;L11_S1_TP5_GPU13_gate</title>
<path fill="none" stroke="black" d="M106373,-880.39C106373,-880.39 106373,-854.73 106373,-854.73"/>
<polygon fill="black" stroke="black" points="106376.5,-854.73 106373,-844.73 106369.5,-854.73 106376.5,-854.73"/>
</g>
<!-- L11_S1_TP5_GPU13_moe_res -->
<g id="node1237" class="node">
<title>L11_S1_TP5_GPU13_moe_res</title>
<polygon fill="none" stroke="black" points="107196,-436.33 106376,-436.33 106376,-368.33 107196,-368.33 107196,-436.33"/>
<text text-anchor="middle" x="106786" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="106786" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="106786" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="106786" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP5_GPU13_mha_res&#45;&gt;L11_S1_TP5_GPU13_moe_res -->
<g id="edge3511" class="edge">
<title>L11_S1_TP5_GPU13_mha_res&#45;&gt;L11_S1_TP5_GPU13_moe_res</title>
<path fill="none" stroke="black" d="M106816.57,-914C106873.27,-914 106912,-914 106912,-914 106912,-914 106912,-688 106912,-688 106912,-688 107085.1,-688 107085.1,-688 107085.1,-688 107085.1,-585 107085.1,-585 107085.1,-585 106820.02,-585 106820.02,-585 106820.02,-585 106820.02,-446.69 106820.02,-446.69"/>
<polygon fill="black" stroke="black" points="106823.52,-446.69 106820.02,-436.69 106816.52,-446.69 106823.52,-446.69"/>
</g>
<!-- L11_S1_TP5_GPU13_gate&#45;&gt;L11_S1_TP5_GPU13_expert0 -->
<g id="edge3492" class="edge">
<title>L11_S1_TP5_GPU13_gate&#45;&gt;L11_S1_TP5_GPU13_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M105995.36,-708.31C105995.36,-708.31 105995.36,-682.71 105995.36,-682.71"/>
<polygon fill="black" stroke="black" points="105998.86,-682.71 105995.36,-672.71 105991.86,-682.71 105998.86,-682.71"/>
</g>
<!-- L11_S1_TP5_GPU13_gate&#45;&gt;L11_S1_TP5_GPU13_expert1 -->
<g id="edge3493" class="edge">
<title>L11_S1_TP5_GPU13_gate&#45;&gt;L11_S1_TP5_GPU13_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M106464.83,-708.31C106464.83,-708.31 106464.83,-682.71 106464.83,-682.71"/>
<polygon fill="black" stroke="black" points="106468.33,-682.71 106464.83,-672.71 106461.33,-682.71 106468.33,-682.71"/>
</g>
<!-- L11_S1_TP5_GPU13_moe_ar&#45;&gt;L11_S1_TP5_GPU13_moe_res -->
<g id="edge3510" class="edge">
<title>L11_S1_TP5_GPU13_moe_ar&#45;&gt;L11_S1_TP5_GPU13_moe_res</title>
<path fill="none" stroke="black" d="M105854.73,-473.27C105854.73,-440.25 105854.73,-402 105854.73,-402 105854.73,-402 106365.84,-402 106365.84,-402"/>
<polygon fill="black" stroke="black" points="106365.84,-405.5 106375.84,-402 106365.84,-398.5 106365.84,-405.5"/>
</g>
<!-- L11_S1_TP5_GPU13_norm -->
<g id="node1238" class="node">
<title>L11_S1_TP5_GPU13_norm</title>
<polygon fill="none" stroke="black" points="107010.5,-332.33 106561.5,-332.33 106561.5,-264.33 107010.5,-264.33 107010.5,-332.33"/>
<text text-anchor="middle" x="106786" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="106786" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="106786" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="106786" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP5_GPU13_moe_res&#45;&gt;L11_S1_TP5_GPU13_norm -->
<g id="edge3512" class="edge">
<title>L11_S1_TP5_GPU13_moe_res&#45;&gt;L11_S1_TP5_GPU13_norm</title>
<path fill="none" stroke="black" d="M106786,-368.28C106786,-368.28 106786,-342.46 106786,-342.46"/>
<polygon fill="black" stroke="black" points="106789.5,-342.46 106786,-332.46 106782.5,-342.46 106789.5,-342.46"/>
</g>
<!-- L11_S1_TP6_GPU14_qkv_linear -->
<g id="node1239" class="node">
<title>L11_S1_TP6_GPU14_qkv_linear</title>
<polygon fill="none" stroke="black" points="107555,-1614.75 106947,-1614.75 106947,-1546.75 107555,-1546.75 107555,-1614.75"/>
<text text-anchor="middle" x="107251" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="107251" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="107251" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="107251" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L11_S1_TP6_GPU14_qkv_slice -->
<g id="node1240" class="node">
<title>L11_S1_TP6_GPU14_qkv_slice</title>
<polygon fill="none" stroke="black" points="107549,-1496.67 106953,-1496.67 106953,-1428.67 107549,-1428.67 107549,-1496.67"/>
<text text-anchor="middle" x="107251" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="107251" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="107251" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="107251" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L11_S1_TP6_GPU14_qkv_linear&#45;&gt;L11_S1_TP6_GPU14_qkv_slice -->
<g id="edge3513" class="edge">
<title>L11_S1_TP6_GPU14_qkv_linear&#45;&gt;L11_S1_TP6_GPU14_qkv_slice</title>
<path fill="none" stroke="black" d="M107251,-1546.59C107251,-1546.59 107251,-1506.74 107251,-1506.74"/>
<polygon fill="black" stroke="black" points="107254.5,-1506.74 107251,-1496.74 107247.5,-1506.74 107254.5,-1506.74"/>
</g>
<!-- L11_S1_TP6_GPU14_qkv_slice&#45;&gt;L11_S1_TP6_GPU14_attn_v -->
<g id="edge3517" class="edge">
<title>L11_S1_TP6_GPU14_qkv_slice&#45;&gt;L11_S1_TP6_GPU14_attn_v</title>
<path fill="none" stroke="black" d="M106992.25,-1428.38C106992.25,-1428.38 106992.25,-1195 106992.25,-1195"/>
<polygon fill="black" stroke="black" points="106995.75,-1195 106992.25,-1185 106988.75,-1195 106995.75,-1195"/>
</g>
<!-- L11_S1_TP6_GPU14_qk_matmul -->
<g id="node1241" class="node">
<title>L11_S1_TP6_GPU14_qk_matmul</title>
<polygon fill="none" stroke="black" points="107966.5,-1392.67 107031.5,-1392.67 107031.5,-1324.67 107966.5,-1324.67 107966.5,-1392.67"/>
<text text-anchor="middle" x="107499" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="107499" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="107499" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="107499" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L11_S1_TP6_GPU14_qkv_slice&#45;&gt;L11_S1_TP6_GPU14_qk_matmul -->
<g id="edge3514" class="edge">
<title>L11_S1_TP6_GPU14_qkv_slice&#45;&gt;L11_S1_TP6_GPU14_qk_matmul</title>
<path fill="none" stroke="black" d="M107290.25,-1428.61C107290.25,-1428.61 107290.25,-1402.8 107290.25,-1402.8"/>
<polygon fill="black" stroke="black" points="107293.75,-1402.8 107290.25,-1392.8 107286.75,-1402.8 107293.75,-1402.8"/>
</g>
<!-- L11_S1_TP6_GPU14_softmax -->
<g id="node1242" class="node">
<title>L11_S1_TP6_GPU14_softmax</title>
<polygon fill="none" stroke="black" points="107647,-1288.67 107137,-1288.67 107137,-1220.67 107647,-1220.67 107647,-1288.67"/>
<text text-anchor="middle" x="107392" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="107392" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="107392" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="107392" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L11_S1_TP6_GPU14_qk_matmul&#45;&gt;L11_S1_TP6_GPU14_softmax -->
<g id="edge3515" class="edge">
<title>L11_S1_TP6_GPU14_qk_matmul&#45;&gt;L11_S1_TP6_GPU14_softmax</title>
<path fill="none" stroke="black" d="M107392,-1324.61C107392,-1324.61 107392,-1298.8 107392,-1298.8"/>
<polygon fill="black" stroke="black" points="107395.5,-1298.8 107392,-1288.8 107388.5,-1298.8 107395.5,-1298.8"/>
</g>
<!-- L11_S1_TP6_GPU14_softmax&#45;&gt;L11_S1_TP6_GPU14_attn_v -->
<g id="edge3516" class="edge">
<title>L11_S1_TP6_GPU14_softmax&#45;&gt;L11_S1_TP6_GPU14_attn_v</title>
<path fill="none" stroke="black" d="M107375.5,-1220.61C107375.5,-1220.61 107375.5,-1194.8 107375.5,-1194.8"/>
<polygon fill="black" stroke="black" points="107379,-1194.8 107375.5,-1184.8 107372,-1194.8 107379,-1194.8"/>
</g>
<!-- L11_S1_TP6_GPU14_mha_res -->
<g id="node1244" class="node">
<title>L11_S1_TP6_GPU14_mha_res</title>
<polygon fill="none" stroke="black" points="107894.5,-948.5 107007.5,-948.5 107007.5,-880.5 107894.5,-880.5 107894.5,-948.5"/>
<text text-anchor="middle" x="107451" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="107451" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="107451" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="107451" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP6_GPU14_mha_ar&#45;&gt;L11_S1_TP6_GPU14_mha_res -->
<g id="edge3526" class="edge">
<title>L11_S1_TP6_GPU14_mha_ar&#45;&gt;L11_S1_TP6_GPU14_mha_res</title>
<path fill="none" stroke="black" d="M107030.49,-1015.91C107030.49,-1015.91 107030.49,-958.58 107030.49,-958.58"/>
<polygon fill="black" stroke="black" points="107033.99,-958.58 107030.49,-948.58 107026.99,-958.58 107033.99,-958.58"/>
</g>
<!-- L11_S1_TP6_GPU14_gate -->
<g id="node1245" class="node">
<title>L11_S1_TP6_GPU14_gate</title>
<polygon fill="none" stroke="black" points="107980.56,-844.5 107138.15,-844.5 106921.44,-708.5 107763.85,-708.5 107980.56,-844.5"/>
<text text-anchor="middle" x="107451" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="107451" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="107451" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="107451" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L11_S1_TP6_GPU14_mha_res&#45;&gt;L11_S1_TP6_GPU14_gate -->
<g id="edge3527" class="edge">
<title>L11_S1_TP6_GPU14_mha_res&#45;&gt;L11_S1_TP6_GPU14_gate</title>
<path fill="none" stroke="black" d="M107451,-880.39C107451,-880.39 107451,-854.73 107451,-854.73"/>
<polygon fill="black" stroke="black" points="107454.5,-854.73 107451,-844.73 107447.5,-854.73 107454.5,-854.73"/>
</g>
<!-- L11_S1_TP6_GPU14_moe_res -->
<g id="node1247" class="node">
<title>L11_S1_TP6_GPU14_moe_res</title>
<polygon fill="none" stroke="black" points="108418,-436.33 107598,-436.33 107598,-368.33 108418,-368.33 108418,-436.33"/>
<text text-anchor="middle" x="108008" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="108008" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="108008" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="108008" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP6_GPU14_mha_res&#45;&gt;L11_S1_TP6_GPU14_moe_res -->
<g id="edge3547" class="edge">
<title>L11_S1_TP6_GPU14_mha_res&#45;&gt;L11_S1_TP6_GPU14_moe_res</title>
<path fill="none" stroke="black" d="M107894.57,-914C107951.27,-914 107990,-914 107990,-914 107990,-914 107990,-693 107990,-693 107990,-693 108024.5,-693 108024.5,-693 108024.5,-693 108024.5,-446.53 108024.5,-446.53"/>
<polygon fill="black" stroke="black" points="108028,-446.53 108024.5,-436.53 108021,-446.53 108028,-446.53"/>
</g>
<!-- L11_S1_TP6_GPU14_gate&#45;&gt;L11_S1_TP6_GPU14_expert0 -->
<g id="edge3528" class="edge">
<title>L11_S1_TP6_GPU14_gate&#45;&gt;L11_S1_TP6_GPU14_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M107001.36,-708.31C107001.36,-708.31 107001.36,-682.71 107001.36,-682.71"/>
<polygon fill="black" stroke="black" points="107004.86,-682.71 107001.36,-672.71 106997.86,-682.71 107004.86,-682.71"/>
</g>
<!-- L11_S1_TP6_GPU14_gate&#45;&gt;L11_S1_TP6_GPU14_expert1 -->
<g id="edge3529" class="edge">
<title>L11_S1_TP6_GPU14_gate&#45;&gt;L11_S1_TP6_GPU14_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M107324,-708.31C107324,-708.31 107324,-682.71 107324,-682.71"/>
<polygon fill="black" stroke="black" points="107327.5,-682.71 107324,-672.71 107320.5,-682.71 107327.5,-682.71"/>
</g>
<!-- L11_S1_TP6_GPU14_moe_ar&#45;&gt;L11_S1_TP6_GPU14_moe_res -->
<g id="edge3546" class="edge">
<title>L11_S1_TP6_GPU14_moe_ar&#45;&gt;L11_S1_TP6_GPU14_moe_res</title>
<path fill="none" stroke="black" d="M106591.23,-475.29C106591.23,-455.64 106591.23,-437 106591.23,-437 106591.23,-437 107806.75,-437 107806.75,-437 107806.75,-437 107806.75,-436.96 107806.75,-436.96"/>
<polygon fill="black" stroke="black" points="107810.25,-446.61 107806.75,-436.61 107803.25,-446.61 107810.25,-446.61"/>
</g>
<!-- L11_S1_TP6_GPU14_norm -->
<g id="node1248" class="node">
<title>L11_S1_TP6_GPU14_norm</title>
<polygon fill="none" stroke="black" points="108232.5,-332.33 107783.5,-332.33 107783.5,-264.33 108232.5,-264.33 108232.5,-332.33"/>
<text text-anchor="middle" x="108008" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="108008" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="108008" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="108008" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP6_GPU14_moe_res&#45;&gt;L11_S1_TP6_GPU14_norm -->
<g id="edge3548" class="edge">
<title>L11_S1_TP6_GPU14_moe_res&#45;&gt;L11_S1_TP6_GPU14_norm</title>
<path fill="none" stroke="black" d="M108008,-368.28C108008,-368.28 108008,-342.46 108008,-342.46"/>
<polygon fill="black" stroke="black" points="108011.5,-342.46 108008,-332.46 108004.5,-342.46 108011.5,-342.46"/>
</g>
<!-- L11_S1_TP7_GPU15_qkv_linear -->
<g id="node1249" class="node">
<title>L11_S1_TP7_GPU15_qkv_linear</title>
<polygon fill="none" stroke="black" points="108600,-1614.75 107992,-1614.75 107992,-1546.75 108600,-1546.75 108600,-1614.75"/>
<text text-anchor="middle" x="108296" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="108296" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="108296" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="108296" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L11_S1_TP7_GPU15_qkv_slice -->
<g id="node1250" class="node">
<title>L11_S1_TP7_GPU15_qkv_slice</title>
<polygon fill="none" stroke="black" points="108594,-1496.67 107998,-1496.67 107998,-1428.67 108594,-1428.67 108594,-1496.67"/>
<text text-anchor="middle" x="108296" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="108296" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="108296" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="108296" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L11_S1_TP7_GPU15_qkv_linear&#45;&gt;L11_S1_TP7_GPU15_qkv_slice -->
<g id="edge3549" class="edge">
<title>L11_S1_TP7_GPU15_qkv_linear&#45;&gt;L11_S1_TP7_GPU15_qkv_slice</title>
<path fill="none" stroke="black" d="M108296,-1546.59C108296,-1546.59 108296,-1506.74 108296,-1506.74"/>
<polygon fill="black" stroke="black" points="108299.5,-1506.74 108296,-1496.74 108292.5,-1506.74 108299.5,-1506.74"/>
</g>
<!-- L11_S1_TP7_GPU15_qkv_slice&#45;&gt;L11_S1_TP7_GPU15_attn_v -->
<g id="edge3553" class="edge">
<title>L11_S1_TP7_GPU15_qkv_slice&#45;&gt;L11_S1_TP7_GPU15_attn_v</title>
<path fill="none" stroke="black" d="M108037.25,-1428.38C108037.25,-1428.38 108037.25,-1195 108037.25,-1195"/>
<polygon fill="black" stroke="black" points="108040.75,-1195 108037.25,-1185 108033.75,-1195 108040.75,-1195"/>
</g>
<!-- L11_S1_TP7_GPU15_qk_matmul -->
<g id="node1251" class="node">
<title>L11_S1_TP7_GPU15_qk_matmul</title>
<polygon fill="none" stroke="black" points="109011.5,-1392.67 108076.5,-1392.67 108076.5,-1324.67 109011.5,-1324.67 109011.5,-1392.67"/>
<text text-anchor="middle" x="108544" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="108544" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="108544" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="108544" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L11_S1_TP7_GPU15_qkv_slice&#45;&gt;L11_S1_TP7_GPU15_qk_matmul -->
<g id="edge3550" class="edge">
<title>L11_S1_TP7_GPU15_qkv_slice&#45;&gt;L11_S1_TP7_GPU15_qk_matmul</title>
<path fill="none" stroke="black" d="M108335.25,-1428.61C108335.25,-1428.61 108335.25,-1402.8 108335.25,-1402.8"/>
<polygon fill="black" stroke="black" points="108338.75,-1402.8 108335.25,-1392.8 108331.75,-1402.8 108338.75,-1402.8"/>
</g>
<!-- L11_S1_TP7_GPU15_softmax -->
<g id="node1252" class="node">
<title>L11_S1_TP7_GPU15_softmax</title>
<polygon fill="none" stroke="black" points="108692,-1288.67 108182,-1288.67 108182,-1220.67 108692,-1220.67 108692,-1288.67"/>
<text text-anchor="middle" x="108437" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="108437" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="108437" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="108437" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L11_S1_TP7_GPU15_qk_matmul&#45;&gt;L11_S1_TP7_GPU15_softmax -->
<g id="edge3551" class="edge">
<title>L11_S1_TP7_GPU15_qk_matmul&#45;&gt;L11_S1_TP7_GPU15_softmax</title>
<path fill="none" stroke="black" d="M108437,-1324.61C108437,-1324.61 108437,-1298.8 108437,-1298.8"/>
<polygon fill="black" stroke="black" points="108440.5,-1298.8 108437,-1288.8 108433.5,-1298.8 108440.5,-1298.8"/>
</g>
<!-- L11_S1_TP7_GPU15_softmax&#45;&gt;L11_S1_TP7_GPU15_attn_v -->
<g id="edge3552" class="edge">
<title>L11_S1_TP7_GPU15_softmax&#45;&gt;L11_S1_TP7_GPU15_attn_v</title>
<path fill="none" stroke="black" d="M108376,-1220.61C108376,-1220.61 108376,-1194.8 108376,-1194.8"/>
<polygon fill="black" stroke="black" points="108379.5,-1194.8 108376,-1184.8 108372.5,-1194.8 108379.5,-1194.8"/>
</g>
<!-- L11_S1_TP7_GPU15_mha_res -->
<g id="node1254" class="node">
<title>L11_S1_TP7_GPU15_mha_res</title>
<polygon fill="none" stroke="black" points="108972.5,-948.5 108085.5,-948.5 108085.5,-880.5 108972.5,-880.5 108972.5,-948.5"/>
<text text-anchor="middle" x="108529" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="108529" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="108529" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="108529" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP7_GPU15_mha_ar&#45;&gt;L11_S1_TP7_GPU15_mha_res -->
<g id="edge3562" class="edge">
<title>L11_S1_TP7_GPU15_mha_ar&#45;&gt;L11_S1_TP7_GPU15_mha_res</title>
<path fill="none" stroke="black" d="M107799.53,-1016C108044.7,-1016 108327.75,-1016 108327.75,-1016 108327.75,-1016 108327.75,-958.58 108327.75,-958.58"/>
<polygon fill="black" stroke="black" points="108331.25,-958.58 108327.75,-948.58 108324.25,-958.58 108331.25,-958.58"/>
</g>
<!-- L11_S1_TP7_GPU15_gate -->
<g id="node1255" class="node">
<title>L11_S1_TP7_GPU15_gate</title>
<polygon fill="none" stroke="black" points="109058.56,-844.5 108216.15,-844.5 107999.44,-708.5 108841.85,-708.5 109058.56,-844.5"/>
<text text-anchor="middle" x="108529" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="108529" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="108529" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="108529" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L11_S1_TP7_GPU15_mha_res&#45;&gt;L11_S1_TP7_GPU15_gate -->
<g id="edge3563" class="edge">
<title>L11_S1_TP7_GPU15_mha_res&#45;&gt;L11_S1_TP7_GPU15_gate</title>
<path fill="none" stroke="black" d="M108529,-880.39C108529,-880.39 108529,-854.73 108529,-854.73"/>
<polygon fill="black" stroke="black" points="108532.5,-854.73 108529,-844.73 108525.5,-854.73 108532.5,-854.73"/>
</g>
<!-- L11_S1_TP7_GPU15_moe_res -->
<g id="node1257" class="node">
<title>L11_S1_TP7_GPU15_moe_res</title>
<polygon fill="none" stroke="black" points="109448,-436.33 108628,-436.33 108628,-368.33 109448,-368.33 109448,-436.33"/>
<text text-anchor="middle" x="109038" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="109038" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="109038" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="109038" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP7_GPU15_mha_res&#45;&gt;L11_S1_TP7_GPU15_moe_res -->
<g id="edge3583" class="edge">
<title>L11_S1_TP7_GPU15_mha_res&#45;&gt;L11_S1_TP7_GPU15_moe_res</title>
<path fill="none" stroke="black" d="M108972.97,-914C109107.32,-914 109220,-914 109220,-914 109220,-914 109220,-446.7 109220,-446.7"/>
<polygon fill="black" stroke="black" points="109223.5,-446.7 109220,-436.7 109216.5,-446.7 109223.5,-446.7"/>
</g>
<!-- L11_S1_TP7_GPU15_gate&#45;&gt;L11_S1_TP7_GPU15_expert0 -->
<g id="edge3564" class="edge">
<title>L11_S1_TP7_GPU15_gate&#45;&gt;L11_S1_TP7_GPU15_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M108007.36,-776.4C108007.36,-776.4 108007.36,-682.74 108007.36,-682.74"/>
<polygon fill="black" stroke="black" points="108010.86,-682.74 108007.36,-672.74 108003.86,-682.74 108010.86,-682.74"/>
</g>
<!-- L11_S1_TP7_GPU15_gate&#45;&gt;L11_S1_TP7_GPU15_expert1 -->
<g id="edge3565" class="edge">
<title>L11_S1_TP7_GPU15_gate&#45;&gt;L11_S1_TP7_GPU15_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M108258,-708.31C108258,-708.31 108258,-682.71 108258,-682.71"/>
<polygon fill="black" stroke="black" points="108261.5,-682.71 108258,-672.71 108254.5,-682.71 108261.5,-682.71"/>
</g>
<!-- L11_S1_TP7_GPU15_moe_ar&#45;&gt;L11_S1_TP7_GPU15_moe_res -->
<g id="edge3582" class="edge">
<title>L11_S1_TP7_GPU15_moe_ar&#45;&gt;L11_S1_TP7_GPU15_moe_res</title>
<path fill="none" stroke="black" d="M107490.52,-527C107981.19,-527 108843.39,-527 108843.39,-527 108843.39,-527 108843.39,-446.4 108843.39,-446.4"/>
<polygon fill="black" stroke="black" points="108846.89,-446.4 108843.39,-436.4 108839.89,-446.4 108846.89,-446.4"/>
</g>
<!-- L11_S1_TP7_GPU15_norm -->
<g id="node1258" class="node">
<title>L11_S1_TP7_GPU15_norm</title>
<polygon fill="none" stroke="black" points="109262.5,-332.33 108813.5,-332.33 108813.5,-264.33 109262.5,-264.33 109262.5,-332.33"/>
<text text-anchor="middle" x="109038" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="109038" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="109038" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="109038" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L11_S1_TP7_GPU15_moe_res&#45;&gt;L11_S1_TP7_GPU15_norm -->
<g id="edge3584" class="edge">
<title>L11_S1_TP7_GPU15_moe_res&#45;&gt;L11_S1_TP7_GPU15_norm</title>
<path fill="none" stroke="black" d="M109038,-368.28C109038,-368.28 109038,-342.46 109038,-342.46"/>
<polygon fill="black" stroke="black" points="109041.5,-342.46 109038,-332.46 109034.5,-342.46 109041.5,-342.46"/>
</g>
<!-- L12_S1_TP0_GPU8_qkv_linear -->
<g id="node1259" class="node">
<title>L12_S1_TP0_GPU8_qkv_linear</title>
<polygon fill="none" stroke="black" points="110339,-1614.75 109731,-1614.75 109731,-1546.75 110339,-1546.75 110339,-1614.75"/>
<text text-anchor="middle" x="110035" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="110035" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="110035" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="110035" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L12_S1_TP0_GPU8_qkv_slice -->
<g id="node1260" class="node">
<title>L12_S1_TP0_GPU8_qkv_slice</title>
<polygon fill="none" stroke="black" points="110333,-1496.67 109737,-1496.67 109737,-1428.67 110333,-1428.67 110333,-1496.67"/>
<text text-anchor="middle" x="110035" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="110035" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="110035" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="110035" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L12_S1_TP0_GPU8_qkv_linear&#45;&gt;L12_S1_TP0_GPU8_qkv_slice -->
<g id="edge3585" class="edge">
<title>L12_S1_TP0_GPU8_qkv_linear&#45;&gt;L12_S1_TP0_GPU8_qkv_slice</title>
<path fill="none" stroke="black" d="M110035,-1546.59C110035,-1546.59 110035,-1506.74 110035,-1506.74"/>
<polygon fill="black" stroke="black" points="110038.5,-1506.74 110035,-1496.74 110031.5,-1506.74 110038.5,-1506.74"/>
</g>
<!-- L12_S1_TP0_GPU8_qk_matmul -->
<g id="node1261" class="node">
<title>L12_S1_TP0_GPU8_qk_matmul</title>
<polygon fill="none" stroke="black" points="110807.5,-1392.67 109872.5,-1392.67 109872.5,-1324.67 110807.5,-1324.67 110807.5,-1392.67"/>
<text text-anchor="middle" x="110340" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="110340" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="110340" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="110340" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L12_S1_TP0_GPU8_qkv_slice&#45;&gt;L12_S1_TP0_GPU8_qk_matmul -->
<g id="edge3586" class="edge">
<title>L12_S1_TP0_GPU8_qkv_slice&#45;&gt;L12_S1_TP0_GPU8_qk_matmul</title>
<path fill="none" stroke="black" d="M110102.75,-1428.61C110102.75,-1428.61 110102.75,-1402.8 110102.75,-1402.8"/>
<polygon fill="black" stroke="black" points="110106.25,-1402.8 110102.75,-1392.8 110099.25,-1402.8 110106.25,-1402.8"/>
</g>
<!-- L12_S1_TP0_GPU8_attn_v -->
<g id="node1263" class="node">
<title>L12_S1_TP0_GPU8_attn_v</title>
<polygon fill="none" stroke="black" points="110808,-1184.67 109870,-1184.67 109870,-1116.67 110808,-1116.67 110808,-1184.67"/>
<text text-anchor="middle" x="110339" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="110339" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="110339" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="110339" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L12_S1_TP0_GPU8_qkv_slice&#45;&gt;L12_S1_TP0_GPU8_attn_v -->
<g id="edge3589" class="edge">
<title>L12_S1_TP0_GPU8_qkv_slice&#45;&gt;L12_S1_TP0_GPU8_attn_v</title>
<path fill="none" stroke="black" d="M109803.5,-1428.61C109803.5,-1347.57 109803.5,-1150 109803.5,-1150 109803.5,-1150 109859.97,-1150 109859.97,-1150"/>
<polygon fill="black" stroke="black" points="109859.97,-1153.5 109869.97,-1150 109859.97,-1146.5 109859.97,-1153.5"/>
</g>
<!-- L12_S1_TP0_GPU8_softmax -->
<g id="node1262" class="node">
<title>L12_S1_TP0_GPU8_softmax</title>
<polygon fill="none" stroke="black" points="110594,-1288.67 110084,-1288.67 110084,-1220.67 110594,-1220.67 110594,-1288.67"/>
<text text-anchor="middle" x="110339" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="110339" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="110339" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="110339" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L12_S1_TP0_GPU8_qk_matmul&#45;&gt;L12_S1_TP0_GPU8_softmax -->
<g id="edge3587" class="edge">
<title>L12_S1_TP0_GPU8_qk_matmul&#45;&gt;L12_S1_TP0_GPU8_softmax</title>
<path fill="none" stroke="black" d="M110339,-1324.61C110339,-1324.61 110339,-1298.8 110339,-1298.8"/>
<polygon fill="black" stroke="black" points="110342.5,-1298.8 110339,-1288.8 110335.5,-1298.8 110342.5,-1298.8"/>
</g>
<!-- L12_S1_TP0_GPU8_softmax&#45;&gt;L12_S1_TP0_GPU8_attn_v -->
<g id="edge3588" class="edge">
<title>L12_S1_TP0_GPU8_softmax&#45;&gt;L12_S1_TP0_GPU8_attn_v</title>
<path fill="none" stroke="black" d="M110339,-1220.61C110339,-1220.61 110339,-1194.8 110339,-1194.8"/>
<polygon fill="black" stroke="black" points="110342.5,-1194.8 110339,-1184.8 110335.5,-1194.8 110342.5,-1194.8"/>
</g>
<!-- L12_S1_TP0_GPU8_mha_ar -->
<g id="node1264" class="node">
<title>L12_S1_TP0_GPU8_mha_ar</title>
<ellipse fill="none" stroke="black" cx="110993" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="110993" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="110993" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="110993" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="110993" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP0_GPU8_attn_v&#45;&gt;L12_S1_TP0_GPU8_mha_ar -->
<g id="edge3590" class="edge">
<title>L12_S1_TP0_GPU8_attn_v&#45;&gt;L12_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M110644.74,-1116.51C110644.74,-1116.51 110644.74,-1060.6 110644.74,-1060.6"/>
<polygon fill="black" stroke="black" points="110648.24,-1060.6 110644.74,-1050.6 110641.24,-1060.6 110648.24,-1060.6"/>
</g>
<!-- L12_S1_TP1_GPU9_mha_ar -->
<g id="node1297" class="node">
<title>L12_S1_TP1_GPU9_mha_ar</title>
<ellipse fill="none" stroke="black" cx="111762" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="111762" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="111762" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="111762" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="111762" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP0_GPU8_attn_v&#45;&gt;L12_S1_TP1_GPU9_mha_ar -->
<g id="edge3626" class="edge">
<title>L12_S1_TP0_GPU8_attn_v&#45;&gt;L12_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M110671.95,-1116.29C110671.95,-1100.41 110671.95,-1085 110671.95,-1085 110671.95,-1085 111433.71,-1085 111433.71,-1085 111433.71,-1085 111433.71,-1066.03 111433.71,-1066.03"/>
<polygon fill="black" stroke="black" points="111437.21,-1066.03 111433.71,-1056.03 111430.21,-1066.03 111437.21,-1066.03"/>
</g>
<!-- L12_S1_TP2_GPU10_mha_ar -->
<g id="node1307" class="node">
<title>L12_S1_TP2_GPU10_mha_ar</title>
<ellipse fill="none" stroke="black" cx="112531" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="112531" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="112531" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="112531" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="112531" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP0_GPU8_attn_v&#45;&gt;L12_S1_TP2_GPU10_mha_ar -->
<g id="edge3662" class="edge">
<title>L12_S1_TP0_GPU8_attn_v&#45;&gt;L12_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M110699.16,-1116.29C110699.16,-1100.41 110699.16,-1085 110699.16,-1085 110699.16,-1085 112218.25,-1085 112218.25,-1085 112218.25,-1085 112218.25,-1069.41 112218.25,-1069.41"/>
<polygon fill="black" stroke="black" points="112221.75,-1069.41 112218.25,-1059.41 112214.75,-1069.41 112221.75,-1069.41"/>
</g>
<!-- L12_S1_TP3_GPU11_mha_ar -->
<g id="node1317" class="node">
<title>L12_S1_TP3_GPU11_mha_ar</title>
<ellipse fill="none" stroke="black" cx="113300" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="113300" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="113300" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="113300" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="113300" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP0_GPU8_attn_v&#45;&gt;L12_S1_TP3_GPU11_mha_ar -->
<g id="edge3698" class="edge">
<title>L12_S1_TP0_GPU8_attn_v&#45;&gt;L12_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M110726.37,-1116.29C110726.37,-1100.41 110726.37,-1085 110726.37,-1085 110726.37,-1085 113031.8,-1085 113031.8,-1085 113031.8,-1085 113031.8,-1076.37 113031.8,-1076.37"/>
<polygon fill="black" stroke="black" points="113035.3,-1076.37 113031.8,-1066.37 113028.3,-1076.37 113035.3,-1076.37"/>
</g>
<!-- L12_S1_TP4_GPU12_mha_ar -->
<g id="node1327" class="node">
<title>L12_S1_TP4_GPU12_mha_ar</title>
<ellipse fill="none" stroke="black" cx="114069" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="114069" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="114069" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="114069" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="114069" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP0_GPU8_attn_v&#45;&gt;L12_S1_TP4_GPU12_mha_ar -->
<g id="edge3734" class="edge">
<title>L12_S1_TP0_GPU8_attn_v&#45;&gt;L12_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M110581.51,-1116.32C110581.51,-1061.66 110581.51,-961 110581.51,-961 110581.51,-961 113750.84,-961 113750.84,-961 113750.84,-961 113750.84,-996.74 113750.84,-996.74"/>
<polygon fill="black" stroke="black" points="113747.34,-996.74 113750.84,-1006.74 113754.34,-996.74 113747.34,-996.74"/>
</g>
<!-- L12_S1_TP5_GPU13_mha_ar -->
<g id="node1337" class="node">
<title>L12_S1_TP5_GPU13_mha_ar</title>
<ellipse fill="none" stroke="black" cx="114838" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="114838" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="114838" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="114838" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="114838" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP0_GPU8_attn_v&#45;&gt;L12_S1_TP5_GPU13_mha_ar -->
<g id="edge3770" class="edge">
<title>L12_S1_TP0_GPU8_attn_v&#45;&gt;L12_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M110700.75,-1184.71C110700.75,-1198.4 110700.75,-1211 110700.75,-1211 110700.75,-1211 114644,-1211 114644,-1211 114644,-1211 114644,-1083.96 114644,-1083.96"/>
<polygon fill="black" stroke="black" points="114647.5,-1083.96 114644,-1073.96 114640.5,-1083.96 114647.5,-1083.96"/>
</g>
<!-- L12_S1_TP6_GPU14_mha_ar -->
<g id="node1347" class="node">
<title>L12_S1_TP6_GPU14_mha_ar</title>
<ellipse fill="none" stroke="black" cx="115607" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="115607" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="115607" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="115607" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="115607" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP0_GPU8_attn_v&#45;&gt;L12_S1_TP6_GPU14_mha_ar -->
<g id="edge3806" class="edge">
<title>L12_S1_TP0_GPU8_attn_v&#45;&gt;L12_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M110753.58,-1116.63C110753.58,-1111.57 110753.58,-1108 110753.58,-1108 110753.58,-1108 115282.45,-1108 115282.45,-1108 115282.45,-1108 115282.45,-1066.86 115282.45,-1066.86"/>
<polygon fill="black" stroke="black" points="115285.95,-1066.86 115282.45,-1056.86 115278.95,-1066.86 115285.95,-1066.86"/>
</g>
<!-- L12_S1_TP7_GPU15_mha_ar -->
<g id="node1357" class="node">
<title>L12_S1_TP7_GPU15_mha_ar</title>
<ellipse fill="none" stroke="black" cx="116376" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="116376" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="116376" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="116376" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="116376" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP0_GPU8_attn_v&#45;&gt;L12_S1_TP7_GPU15_mha_ar -->
<g id="edge3842" class="edge">
<title>L12_S1_TP0_GPU8_attn_v&#45;&gt;L12_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M110780.79,-1116.63C110780.79,-1111.57 110780.79,-1108 110780.79,-1108 110780.79,-1108 116068.46,-1108 116068.46,-1108 116068.46,-1108 116068.46,-1070.24 116068.46,-1070.24"/>
<polygon fill="black" stroke="black" points="116071.96,-1070.24 116068.46,-1060.24 116064.96,-1070.24 116071.96,-1070.24"/>
</g>
<!-- L12_S1_TP0_GPU8_mha_res -->
<g id="node1272" class="node">
<title>L12_S1_TP0_GPU8_mha_res</title>
<polygon fill="none" stroke="black" points="110354.5,-948.5 109467.5,-948.5 109467.5,-880.5 110354.5,-880.5 110354.5,-948.5"/>
<text text-anchor="middle" x="109911" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="109911" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="109911" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="109911" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP0_GPU8_mha_ar&#45;&gt;L12_S1_TP0_GPU8_mha_res -->
<g id="edge3598" class="edge">
<title>L12_S1_TP0_GPU8_mha_ar&#45;&gt;L12_S1_TP0_GPU8_mha_res</title>
<path fill="none" stroke="black" d="M110637.3,-1048C110392.86,-1048 110112.25,-1048 110112.25,-1048 110112.25,-1048 110112.25,-958.53 110112.25,-958.53"/>
<polygon fill="black" stroke="black" points="110115.75,-958.53 110112.25,-948.53 110108.75,-958.53 110115.75,-958.53"/>
</g>
<!-- L12_S1_TP1_GPU9_attn_v -->
<g id="node1265" class="node">
<title>L12_S1_TP1_GPU9_attn_v</title>
<polygon fill="none" stroke="black" points="111764,-1184.67 110826,-1184.67 110826,-1116.67 111764,-1116.67 111764,-1184.67"/>
<text text-anchor="middle" x="111295" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="111295" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="111295" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="111295" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L12_S1_TP1_GPU9_attn_v&#45;&gt;L12_S1_TP0_GPU8_mha_ar -->
<g id="edge3591" class="edge">
<title>L12_S1_TP1_GPU9_attn_v&#45;&gt;L12_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M110893.81,-1116.51C110893.81,-1116.51 110893.81,-1088.96 110893.81,-1088.96"/>
<polygon fill="black" stroke="black" points="110897.31,-1088.96 110893.81,-1078.96 110890.31,-1088.96 110897.31,-1088.96"/>
</g>
<!-- L12_S1_TP1_GPU9_attn_v&#45;&gt;L12_S1_TP1_GPU9_mha_ar -->
<g id="edge3627" class="edge">
<title>L12_S1_TP1_GPU9_attn_v&#45;&gt;L12_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M111480.89,-1116.51C111480.89,-1116.51 111480.89,-1074.64 111480.89,-1074.64"/>
<polygon fill="black" stroke="black" points="111484.39,-1074.64 111480.89,-1064.64 111477.39,-1074.64 111484.39,-1074.64"/>
</g>
<!-- L12_S1_TP1_GPU9_attn_v&#45;&gt;L12_S1_TP2_GPU10_mha_ar -->
<g id="edge3663" class="edge">
<title>L12_S1_TP1_GPU9_attn_v&#45;&gt;L12_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M111528.08,-1116.29C111528.08,-1100.41 111528.08,-1085 111528.08,-1085 111528.08,-1085 112280.96,-1085 112280.96,-1085 112280.96,-1085 112280.96,-1078.7 112280.96,-1078.7"/>
<polygon fill="black" stroke="black" points="112284.46,-1078.7 112280.96,-1068.7 112277.46,-1078.7 112284.46,-1078.7"/>
</g>
<!-- L12_S1_TP1_GPU9_attn_v&#45;&gt;L12_S1_TP3_GPU11_mha_ar -->
<g id="edge3699" class="edge">
<title>L12_S1_TP1_GPU9_attn_v&#45;&gt;L12_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M111575.26,-1116.29C111575.26,-1100.41 111575.26,-1085 111575.26,-1085 111575.26,-1085 113139.08,-1085 113139.08,-1085 113139.08,-1085 113139.08,-1084.13 113139.08,-1084.13"/>
<polygon fill="black" stroke="black" points="113142.58,-1086.34 113139.08,-1076.34 113135.58,-1086.34 113142.58,-1086.34"/>
</g>
<!-- L12_S1_TP1_GPU9_attn_v&#45;&gt;L12_S1_TP4_GPU12_mha_ar -->
<g id="edge3735" class="edge">
<title>L12_S1_TP1_GPU9_attn_v&#45;&gt;L12_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M111377.5,-1116.32C111377.5,-1061.66 111377.5,-961 111377.5,-961 111377.5,-961 113722.18,-961 113722.18,-961 113722.18,-961 113722.18,-1004.15 113722.18,-1004.15"/>
<polygon fill="black" stroke="black" points="113718.68,-1004.15 113722.18,-1014.15 113725.68,-1004.15 113718.68,-1004.15"/>
</g>
<!-- L12_S1_TP1_GPU9_attn_v&#45;&gt;L12_S1_TP5_GPU13_mha_ar -->
<g id="edge3771" class="edge">
<title>L12_S1_TP1_GPU9_attn_v&#45;&gt;L12_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M111622.45,-1116.63C111622.45,-1111.57 111622.45,-1108 111622.45,-1108 111622.45,-1108 114490.77,-1108 114490.77,-1108 114490.77,-1108 114490.77,-1061.23 114490.77,-1061.23"/>
<polygon fill="black" stroke="black" points="114494.27,-1061.23 114490.77,-1051.23 114487.27,-1061.23 114494.27,-1061.23"/>
</g>
<!-- L12_S1_TP1_GPU9_attn_v&#45;&gt;L12_S1_TP6_GPU14_mha_ar -->
<g id="edge3807" class="edge">
<title>L12_S1_TP1_GPU9_attn_v&#45;&gt;L12_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M111669.63,-1116.63C111669.63,-1111.57 111669.63,-1108 111669.63,-1108 111669.63,-1108 115333.38,-1108 115333.38,-1108 115333.38,-1108 115333.38,-1075.88 115333.38,-1075.88"/>
<polygon fill="black" stroke="black" points="115336.88,-1075.88 115333.38,-1065.88 115329.88,-1075.88 115336.88,-1075.88"/>
</g>
<!-- L12_S1_TP1_GPU9_attn_v&#45;&gt;L12_S1_TP7_GPU15_mha_ar -->
<g id="edge3843" class="edge">
<title>L12_S1_TP1_GPU9_attn_v&#45;&gt;L12_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M111716.82,-1116.63C111716.82,-1111.57 111716.82,-1108 111716.82,-1108 111716.82,-1108 116136.39,-1108 116136.39,-1108 116136.39,-1108 116136.39,-1079.85 116136.39,-1079.85"/>
<polygon fill="black" stroke="black" points="116139.89,-1079.85 116136.39,-1069.85 116132.89,-1079.85 116139.89,-1079.85"/>
</g>
<!-- L12_S1_TP2_GPU10_attn_v -->
<g id="node1266" class="node">
<title>L12_S1_TP2_GPU10_attn_v</title>
<polygon fill="none" stroke="black" points="112720,-1184.67 111782,-1184.67 111782,-1116.67 112720,-1116.67 112720,-1184.67"/>
<text text-anchor="middle" x="112251" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="112251" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="112251" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="112251" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L12_S1_TP2_GPU10_attn_v&#45;&gt;L12_S1_TP0_GPU8_mha_ar -->
<g id="edge3592" class="edge">
<title>L12_S1_TP2_GPU10_attn_v&#45;&gt;L12_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M111841.25,-1116.39C111841.25,-1116.14 111841.25,-1116 111841.25,-1116 111841.25,-1116 110961.62,-1116 110961.62,-1116 110961.62,-1116 110961.62,-1090.62 110961.62,-1090.62"/>
<polygon fill="black" stroke="black" points="110965.12,-1090.62 110961.62,-1080.62 110958.12,-1090.62 110965.12,-1090.62"/>
</g>
<!-- L12_S1_TP2_GPU10_attn_v&#45;&gt;L12_S1_TP1_GPU9_mha_ar -->
<g id="edge3628" class="edge">
<title>L12_S1_TP2_GPU10_attn_v&#45;&gt;L12_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M111900.49,-1116.51C111900.49,-1116.51 111900.49,-1087.65 111900.49,-1087.65"/>
<polygon fill="black" stroke="black" points="111903.99,-1087.65 111900.49,-1077.65 111896.99,-1087.65 111903.99,-1087.65"/>
</g>
<!-- L12_S1_TP2_GPU10_attn_v&#45;&gt;L12_S1_TP2_GPU10_mha_ar -->
<g id="edge3664" class="edge">
<title>L12_S1_TP2_GPU10_attn_v&#45;&gt;L12_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M112343.68,-1116.51C112343.68,-1116.51 112343.68,-1084.63 112343.68,-1084.63"/>
<polygon fill="black" stroke="black" points="112347.18,-1084.63 112343.68,-1074.63 112340.18,-1084.63 112347.18,-1084.63"/>
</g>
<!-- L12_S1_TP2_GPU10_attn_v&#45;&gt;L12_S1_TP3_GPU11_mha_ar -->
<g id="edge3700" class="edge">
<title>L12_S1_TP2_GPU10_attn_v&#45;&gt;L12_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M112406.4,-1116.29C112406.4,-1100.41 112406.4,-1085 112406.4,-1085 112406.4,-1085 113246.36,-1085 113246.36,-1085 113246.36,-1085 113246.36,-1084.55 113246.36,-1084.55"/>
<polygon fill="black" stroke="black" points="113249.86,-1090.53 113246.36,-1080.53 113242.86,-1090.53 113249.86,-1090.53"/>
</g>
<!-- L12_S1_TP2_GPU10_attn_v&#45;&gt;L12_S1_TP4_GPU12_mha_ar -->
<g id="edge3736" class="edge">
<title>L12_S1_TP2_GPU10_attn_v&#45;&gt;L12_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M112469.12,-1116.64C112469.12,-1112.12 112469.12,-1109 112469.12,-1109 112469.12,-1109 113908.42,-1109 113908.42,-1109 113908.42,-1109 113908.42,-1086.15 113908.42,-1086.15"/>
<polygon fill="black" stroke="black" points="113911.92,-1086.15 113908.42,-1076.15 113904.92,-1086.15 113911.92,-1086.15"/>
</g>
<!-- L12_S1_TP2_GPU10_attn_v&#45;&gt;L12_S1_TP5_GPU13_mha_ar -->
<g id="edge3772" class="edge">
<title>L12_S1_TP2_GPU10_attn_v&#45;&gt;L12_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M112531.84,-1116.64C112531.84,-1112.12 112531.84,-1109 112531.84,-1109 112531.84,-1109 114519.02,-1109 114519.02,-1109 114519.02,-1109 114519.02,-1068.03 114519.02,-1068.03"/>
<polygon fill="black" stroke="black" points="114522.52,-1068.03 114519.02,-1058.03 114515.52,-1068.03 114522.52,-1068.03"/>
</g>
<!-- L12_S1_TP2_GPU10_attn_v&#45;&gt;L12_S1_TP6_GPU14_mha_ar -->
<g id="edge3808" class="edge">
<title>L12_S1_TP2_GPU10_attn_v&#45;&gt;L12_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M112594.56,-1116.63C112594.56,-1111.57 112594.56,-1108 112594.56,-1108 112594.56,-1108 115384.3,-1108 115384.3,-1108 115384.3,-1108 115384.3,-1081.62 115384.3,-1081.62"/>
<polygon fill="black" stroke="black" points="115387.8,-1081.62 115384.3,-1071.62 115380.8,-1081.62 115387.8,-1081.62"/>
</g>
<!-- L12_S1_TP2_GPU10_attn_v&#45;&gt;L12_S1_TP7_GPU15_mha_ar -->
<g id="edge3844" class="edge">
<title>L12_S1_TP2_GPU10_attn_v&#45;&gt;L12_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M112657.28,-1116.63C112657.28,-1111.57 112657.28,-1108 112657.28,-1108 112657.28,-1108 116204.33,-1108 116204.33,-1108 116204.33,-1108 116204.33,-1085.58 116204.33,-1085.58"/>
<polygon fill="black" stroke="black" points="116207.83,-1085.58 116204.33,-1075.58 116200.83,-1085.58 116207.83,-1085.58"/>
</g>
<!-- L12_S1_TP3_GPU11_attn_v -->
<g id="node1267" class="node">
<title>L12_S1_TP3_GPU11_attn_v</title>
<polygon fill="none" stroke="black" points="113676,-1184.67 112738,-1184.67 112738,-1116.67 113676,-1116.67 113676,-1184.67"/>
<text text-anchor="middle" x="113207" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="113207" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="113207" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="113207" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L12_S1_TP3_GPU11_attn_v&#45;&gt;L12_S1_TP0_GPU8_mha_ar -->
<g id="edge3593" class="edge">
<title>L12_S1_TP3_GPU11_attn_v&#45;&gt;L12_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M112771.69,-1116.53C112771.69,-1115.56 112771.69,-1115 112771.69,-1115 112771.69,-1115 111029.43,-1115 111029.43,-1115 111029.43,-1115 111029.43,-1090.53 111029.43,-1090.53"/>
<polygon fill="black" stroke="black" points="111032.93,-1090.53 111029.43,-1080.53 111025.93,-1090.53 111032.93,-1090.53"/>
</g>
<!-- L12_S1_TP3_GPU11_attn_v&#45;&gt;L12_S1_TP1_GPU9_mha_ar -->
<g id="edge3629" class="edge">
<title>L12_S1_TP3_GPU11_attn_v&#45;&gt;L12_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M112805.39,-1116.53C112805.39,-1115.56 112805.39,-1115 112805.39,-1115 112805.39,-1115 111959.74,-1115 111959.74,-1115 111959.74,-1115 111959.74,-1083.79 111959.74,-1083.79"/>
<polygon fill="black" stroke="black" points="111963.24,-1083.79 111959.74,-1073.79 111956.24,-1083.79 111963.24,-1083.79"/>
</g>
<!-- L12_S1_TP3_GPU11_attn_v&#45;&gt;L12_S1_TP2_GPU10_mha_ar -->
<g id="edge3665" class="edge">
<title>L12_S1_TP3_GPU11_attn_v&#45;&gt;L12_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M112839.08,-1116.51C112839.08,-1116.51 112839.08,-1070.31 112839.08,-1070.31"/>
<polygon fill="black" stroke="black" points="112842.58,-1070.31 112839.08,-1060.31 112835.58,-1070.31 112842.58,-1070.31"/>
</g>
<!-- L12_S1_TP3_GPU11_attn_v&#45;&gt;L12_S1_TP3_GPU11_mha_ar -->
<g id="edge3701" class="edge">
<title>L12_S1_TP3_GPU11_attn_v&#45;&gt;L12_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M113353.64,-1116.51C113353.64,-1116.51 113353.64,-1090.27 113353.64,-1090.27"/>
<polygon fill="black" stroke="black" points="113357.14,-1090.27 113353.64,-1080.27 113350.14,-1090.27 113357.14,-1090.27"/>
</g>
<!-- L12_S1_TP3_GPU11_attn_v&#45;&gt;L12_S1_TP4_GPU12_mha_ar -->
<g id="edge3737" class="edge">
<title>L12_S1_TP3_GPU11_attn_v&#45;&gt;L12_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M113676.03,-1161C113679.09,-1161 113680.71,-1161 113680.71,-1161 113680.71,-1161 113680.71,-1016 113680.71,-1016 113680.71,-1016 113706.55,-1016 113706.55,-1016"/>
<polygon fill="black" stroke="black" points="113706.55,-1019.5 113716.55,-1016 113706.55,-1012.5 113706.55,-1019.5"/>
</g>
<!-- L12_S1_TP3_GPU11_attn_v&#45;&gt;L12_S1_TP5_GPU13_mha_ar -->
<g id="edge3773" class="edge">
<title>L12_S1_TP3_GPU11_attn_v&#45;&gt;L12_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M113627,-1185.07C113627,-1186.9 113627,-1188 113627,-1188 113627,-1188 114638,-1188 114638,-1188 114638,-1188 114638,-1083.42 114638,-1083.42"/>
<polygon fill="black" stroke="black" points="114641.5,-1083.42 114638,-1073.42 114634.5,-1083.42 114641.5,-1083.42"/>
</g>
<!-- L12_S1_TP3_GPU11_attn_v&#45;&gt;L12_S1_TP6_GPU14_mha_ar -->
<g id="edge3809" class="edge">
<title>L12_S1_TP3_GPU11_attn_v&#45;&gt;L12_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M113578,-1184.83C113578,-1191.77 113578,-1197 113578,-1197 113578,-1197 115597,-1197 115597,-1197 115597,-1197 115597,-1091.02 115597,-1091.02"/>
<polygon fill="black" stroke="black" points="115600.5,-1091.02 115597,-1081.02 115593.5,-1091.02 115600.5,-1091.02"/>
</g>
<!-- L12_S1_TP3_GPU11_attn_v&#45;&gt;L12_S1_TP7_GPU15_mha_ar -->
<g id="edge3845" class="edge">
<title>L12_S1_TP3_GPU11_attn_v&#45;&gt;L12_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M113460.92,-1116.63C113460.92,-1111.57 113460.92,-1108 113460.92,-1108 113460.92,-1108 116272.26,-1108 116272.26,-1108 116272.26,-1108 116272.26,-1089.06 116272.26,-1089.06"/>
<polygon fill="black" stroke="black" points="116275.76,-1089.06 116272.26,-1079.06 116268.76,-1089.06 116275.76,-1089.06"/>
</g>
<!-- L12_S1_TP4_GPU12_attn_v -->
<g id="node1268" class="node">
<title>L12_S1_TP4_GPU12_attn_v</title>
<polygon fill="none" stroke="black" points="114632,-1184.67 113694,-1184.67 113694,-1116.67 114632,-1116.67 114632,-1184.67"/>
<text text-anchor="middle" x="114163" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="114163" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="114163" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="114163" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L12_S1_TP4_GPU12_attn_v&#45;&gt;L12_S1_TP0_GPU8_mha_ar -->
<g id="edge3594" class="edge">
<title>L12_S1_TP4_GPU12_attn_v&#45;&gt;L12_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M113801.21,-1116.64C113801.21,-1112.12 113801.21,-1109 113801.21,-1109 113801.21,-1109 111097.24,-1109 111097.24,-1109 111097.24,-1109 111097.24,-1088.8 111097.24,-1088.8"/>
<polygon fill="black" stroke="black" points="111100.74,-1088.8 111097.24,-1078.8 111093.74,-1088.8 111100.74,-1088.8"/>
</g>
<!-- L12_S1_TP4_GPU12_attn_v&#45;&gt;L12_S1_TP1_GPU9_mha_ar -->
<g id="edge3630" class="edge">
<title>L12_S1_TP4_GPU12_attn_v&#45;&gt;L12_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M113770.33,-1184.8C113770.33,-1193.77 113770.33,-1201 113770.33,-1201 113770.33,-1201 111776,-1201 111776,-1201 111776,-1201 111776,-1090.84 111776,-1090.84"/>
<polygon fill="black" stroke="black" points="111779.5,-1090.84 111776,-1080.84 111772.5,-1090.84 111779.5,-1090.84"/>
</g>
<!-- L12_S1_TP4_GPU12_attn_v&#45;&gt;L12_S1_TP2_GPU10_mha_ar -->
<g id="edge3666" class="edge">
<title>L12_S1_TP4_GPU12_attn_v&#45;&gt;L12_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M113732.17,-1184.84C113732.17,-1189.65 113732.17,-1193 113732.17,-1193 113732.17,-1193 112733.5,-1193 112733.5,-1193 112733.5,-1193 112733.5,-1083.48 112733.5,-1083.48"/>
<polygon fill="black" stroke="black" points="112737,-1083.48 112733.5,-1073.48 112730,-1083.48 112737,-1083.48"/>
</g>
<!-- L12_S1_TP4_GPU12_attn_v&#45;&gt;L12_S1_TP3_GPU11_mha_ar -->
<g id="edge3702" class="edge">
<title>L12_S1_TP4_GPU12_attn_v&#45;&gt;L12_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M113693.93,-1139C113683.95,-1139 113678.36,-1139 113678.36,-1139 113678.36,-1139 113678.36,-1048 113678.36,-1048 113678.36,-1048 113665.82,-1048 113665.82,-1048"/>
<polygon fill="black" stroke="black" points="113665.82,-1044.5 113655.82,-1048 113665.82,-1051.5 113665.82,-1044.5"/>
</g>
<!-- L12_S1_TP4_GPU12_attn_v&#45;&gt;L12_S1_TP4_GPU12_mha_ar -->
<g id="edge3738" class="edge">
<title>L12_S1_TP4_GPU12_attn_v&#45;&gt;L12_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M114015.63,-1116.51C114015.63,-1116.51 114015.63,-1090.27 114015.63,-1090.27"/>
<polygon fill="black" stroke="black" points="114019.13,-1090.27 114015.63,-1080.27 114012.13,-1090.27 114019.13,-1090.27"/>
</g>
<!-- L12_S1_TP4_GPU12_attn_v&#45;&gt;L12_S1_TP5_GPU13_mha_ar -->
<g id="edge3774" class="edge">
<title>L12_S1_TP4_GPU12_attn_v&#45;&gt;L12_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M114547.26,-1116.51C114547.26,-1116.51 114547.26,-1073.04 114547.26,-1073.04"/>
<polygon fill="black" stroke="black" points="114550.76,-1073.04 114547.26,-1063.04 114543.76,-1073.04 114550.76,-1073.04"/>
</g>
<!-- L12_S1_TP4_GPU12_attn_v&#45;&gt;L12_S1_TP6_GPU14_mha_ar -->
<g id="edge3810" class="edge">
<title>L12_S1_TP4_GPU12_attn_v&#45;&gt;L12_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M114575.51,-1116.64C114575.51,-1112.12 114575.51,-1109 114575.51,-1109 114575.51,-1109 115435.23,-1109 115435.23,-1109 115435.23,-1109 115435.23,-1085.7 115435.23,-1085.7"/>
<polygon fill="black" stroke="black" points="115438.73,-1085.7 115435.23,-1075.7 115431.73,-1085.7 115438.73,-1085.7"/>
</g>
<!-- L12_S1_TP4_GPU12_attn_v&#45;&gt;L12_S1_TP7_GPU15_mha_ar -->
<g id="edge3846" class="edge">
<title>L12_S1_TP4_GPU12_attn_v&#45;&gt;L12_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M114603.75,-1116.64C114603.75,-1112.12 114603.75,-1109 114603.75,-1109 114603.75,-1109 116340.2,-1109 116340.2,-1109 116340.2,-1109 116340.2,-1090.55 116340.2,-1090.55"/>
<polygon fill="black" stroke="black" points="116343.7,-1090.55 116340.2,-1080.55 116336.7,-1090.55 116343.7,-1090.55"/>
</g>
<!-- L12_S1_TP5_GPU13_attn_v -->
<g id="node1269" class="node">
<title>L12_S1_TP5_GPU13_attn_v</title>
<polygon fill="none" stroke="black" points="115588,-1184.67 114650,-1184.67 114650,-1116.67 115588,-1116.67 115588,-1184.67"/>
<text text-anchor="middle" x="115119" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="115119" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="115119" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="115119" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L12_S1_TP5_GPU13_attn_v&#45;&gt;L12_S1_TP0_GPU8_mha_ar -->
<g id="edge3595" class="edge">
<title>L12_S1_TP5_GPU13_attn_v&#45;&gt;L12_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M114720.43,-1116.64C114720.43,-1112.12 114720.43,-1109 114720.43,-1109 114720.43,-1109 111165.05,-1109 111165.05,-1109 111165.05,-1109 111165.05,-1085.7 111165.05,-1085.7"/>
<polygon fill="black" stroke="black" points="111168.55,-1085.7 111165.05,-1075.7 111161.55,-1085.7 111168.55,-1085.7"/>
</g>
<!-- L12_S1_TP5_GPU13_attn_v&#45;&gt;L12_S1_TP1_GPU9_mha_ar -->
<g id="edge3631" class="edge">
<title>L12_S1_TP5_GPU13_attn_v&#45;&gt;L12_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M114790.87,-1116.64C114790.87,-1112.12 114790.87,-1109 114790.87,-1109 114790.87,-1109 112018.98,-1109 112018.98,-1109 112018.98,-1109 112018.98,-1077.66 112018.98,-1077.66"/>
<polygon fill="black" stroke="black" points="112022.48,-1077.66 112018.98,-1067.66 112015.48,-1077.66 112022.48,-1077.66"/>
</g>
<!-- L12_S1_TP5_GPU13_attn_v&#45;&gt;L12_S1_TP2_GPU10_mha_ar -->
<g id="edge3667" class="edge">
<title>L12_S1_TP5_GPU13_attn_v&#45;&gt;L12_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M114727.25,-1184.68C114727.25,-1197.03 114727.25,-1208 114727.25,-1208 114727.25,-1208 112729,-1208 112729,-1208 112729,-1208 112729,-1083.71 112729,-1083.71"/>
<polygon fill="black" stroke="black" points="112732.5,-1083.71 112729,-1073.71 112725.5,-1083.71 112732.5,-1083.71"/>
</g>
<!-- L12_S1_TP5_GPU13_attn_v&#45;&gt;L12_S1_TP3_GPU11_mha_ar -->
<g id="edge3703" class="edge">
<title>L12_S1_TP5_GPU13_attn_v&#45;&gt;L12_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M114861.3,-1116.63C114861.3,-1111.57 114861.3,-1108 114861.3,-1108 114861.3,-1108 113568.2,-1108 113568.2,-1108 113568.2,-1108 113568.2,-1076.32 113568.2,-1076.32"/>
<polygon fill="black" stroke="black" points="113571.7,-1076.32 113568.2,-1066.32 113564.7,-1076.32 113571.7,-1076.32"/>
</g>
<!-- L12_S1_TP5_GPU13_attn_v&#45;&gt;L12_S1_TP4_GPU12_mha_ar -->
<g id="edge3739" class="edge">
<title>L12_S1_TP5_GPU13_attn_v&#45;&gt;L12_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M114931.74,-1116.65C114931.74,-1103.25 114931.74,-1091 114931.74,-1091 114931.74,-1091 114122.84,-1091 114122.84,-1091 114122.84,-1091 114122.84,-1089.93 114122.84,-1089.93"/>
<polygon fill="black" stroke="black" points="114126.34,-1090.29 114122.84,-1080.29 114119.34,-1090.29 114126.34,-1090.29"/>
</g>
<!-- L12_S1_TP5_GPU13_attn_v&#45;&gt;L12_S1_TP5_GPU13_mha_ar -->
<g id="edge3775" class="edge">
<title>L12_S1_TP5_GPU13_attn_v&#45;&gt;L12_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M115002.17,-1116.51C115002.17,-1116.51 115002.17,-1085.92 115002.17,-1085.92"/>
<polygon fill="black" stroke="black" points="115005.67,-1085.92 115002.17,-1075.92 114998.67,-1085.92 115005.67,-1085.92"/>
</g>
<!-- L12_S1_TP5_GPU13_attn_v&#45;&gt;L12_S1_TP6_GPU14_mha_ar -->
<g id="edge3811" class="edge">
<title>L12_S1_TP5_GPU13_attn_v&#45;&gt;L12_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M115486.15,-1116.51C115486.15,-1116.51 115486.15,-1088.52 115486.15,-1088.52"/>
<polygon fill="black" stroke="black" points="115489.65,-1088.52 115486.15,-1078.52 115482.65,-1088.52 115489.65,-1088.52"/>
</g>
<!-- L12_S1_TP5_GPU13_attn_v&#45;&gt;L12_S1_TP7_GPU15_mha_ar -->
<g id="edge3847" class="edge">
<title>L12_S1_TP5_GPU13_attn_v&#45;&gt;L12_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M115537.08,-1116.64C115537.08,-1112.12 115537.08,-1109 115537.08,-1109 115537.08,-1109 116408.13,-1109 116408.13,-1109 116408.13,-1109 116408.13,-1090.55 116408.13,-1090.55"/>
<polygon fill="black" stroke="black" points="116411.63,-1090.55 116408.13,-1080.55 116404.63,-1090.55 116411.63,-1090.55"/>
</g>
<!-- L12_S1_TP6_GPU14_attn_v -->
<g id="node1270" class="node">
<title>L12_S1_TP6_GPU14_attn_v</title>
<polygon fill="none" stroke="black" points="116544,-1184.67 115606,-1184.67 115606,-1116.67 116544,-1116.67 116544,-1184.67"/>
<text text-anchor="middle" x="116075" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="116075" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="116075" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="116075" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L12_S1_TP6_GPU14_attn_v&#45;&gt;L12_S1_TP0_GPU8_mha_ar -->
<g id="edge3596" class="edge">
<title>L12_S1_TP6_GPU14_attn_v&#45;&gt;L12_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M115653.06,-1116.64C115653.06,-1112.12 115653.06,-1109 115653.06,-1109 115653.06,-1109 111232.86,-1109 111232.86,-1109 111232.86,-1109 111232.86,-1079.9 111232.86,-1079.9"/>
<polygon fill="black" stroke="black" points="111236.36,-1079.9 111232.86,-1069.9 111229.36,-1079.9 111236.36,-1079.9"/>
</g>
<!-- L12_S1_TP6_GPU14_attn_v&#45;&gt;L12_S1_TP1_GPU9_mha_ar -->
<g id="edge3632" class="edge">
<title>L12_S1_TP6_GPU14_attn_v&#45;&gt;L12_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M115700.12,-1116.64C115700.12,-1112.12 115700.12,-1109 115700.12,-1109 115700.12,-1109 112078.23,-1109 112078.23,-1109 112078.23,-1109 112078.23,-1068.88 112078.23,-1068.88"/>
<polygon fill="black" stroke="black" points="112081.73,-1068.88 112078.23,-1058.88 112074.73,-1068.88 112081.73,-1068.88"/>
</g>
<!-- L12_S1_TP6_GPU14_attn_v&#45;&gt;L12_S1_TP2_GPU10_mha_ar -->
<g id="edge3668" class="edge">
<title>L12_S1_TP6_GPU14_attn_v&#45;&gt;L12_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M115747.18,-1116.64C115747.18,-1112.12 115747.18,-1109 115747.18,-1109 115747.18,-1109 112872.78,-1109 112872.78,-1109 112872.78,-1109 112872.78,-1062.66 112872.78,-1062.66"/>
<polygon fill="black" stroke="black" points="112876.28,-1062.66 112872.78,-1052.66 112869.28,-1062.66 112876.28,-1062.66"/>
</g>
<!-- L12_S1_TP6_GPU14_attn_v&#45;&gt;L12_S1_TP3_GPU11_mha_ar -->
<g id="edge3704" class="edge">
<title>L12_S1_TP6_GPU14_attn_v&#45;&gt;L12_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M115991.5,-1116.54C115991.5,-1066.73 115991.5,-980 115991.5,-980 115991.5,-980 113646.02,-980 113646.02,-980 113646.02,-980 113646.02,-1003.9 113646.02,-1003.9"/>
<polygon fill="black" stroke="black" points="113642.52,-1003.9 113646.02,-1013.9 113649.52,-1003.9 113642.52,-1003.9"/>
</g>
<!-- L12_S1_TP6_GPU14_attn_v&#45;&gt;L12_S1_TP4_GPU12_mha_ar -->
<g id="edge3740" class="edge">
<title>L12_S1_TP6_GPU14_attn_v&#45;&gt;L12_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M115794.24,-1116.65C115794.24,-1103.25 115794.24,-1091 115794.24,-1091 115794.24,-1091 114230.05,-1091 114230.05,-1091 114230.05,-1091 114230.05,-1086.26 114230.05,-1086.26"/>
<polygon fill="black" stroke="black" points="114233.55,-1086.26 114230.05,-1076.26 114226.55,-1086.26 114233.55,-1086.26"/>
</g>
<!-- L12_S1_TP6_GPU14_attn_v&#45;&gt;L12_S1_TP5_GPU13_mha_ar -->
<g id="edge3776" class="edge">
<title>L12_S1_TP6_GPU14_attn_v&#45;&gt;L12_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M115841.3,-1116.65C115841.3,-1103.25 115841.3,-1091 115841.3,-1091 115841.3,-1091 115072.61,-1091 115072.61,-1091 115072.61,-1091 115072.61,-1080.24 115072.61,-1080.24"/>
<polygon fill="black" stroke="black" points="115076.11,-1080.24 115072.61,-1070.24 115069.11,-1080.24 115076.11,-1080.24"/>
</g>
<!-- L12_S1_TP6_GPU14_attn_v&#45;&gt;L12_S1_TP6_GPU14_mha_ar -->
<g id="edge3812" class="edge">
<title>L12_S1_TP6_GPU14_attn_v&#45;&gt;L12_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M115888.36,-1116.51C115888.36,-1116.51 115888.36,-1074.64 115888.36,-1074.64"/>
<polygon fill="black" stroke="black" points="115891.86,-1074.64 115888.36,-1064.64 115884.86,-1074.64 115891.86,-1074.64"/>
</g>
<!-- L12_S1_TP6_GPU14_attn_v&#45;&gt;L12_S1_TP7_GPU15_mha_ar -->
<g id="edge3848" class="edge">
<title>L12_S1_TP6_GPU14_attn_v&#45;&gt;L12_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M116476.07,-1116.51C116476.07,-1116.51 116476.07,-1088.96 116476.07,-1088.96"/>
<polygon fill="black" stroke="black" points="116479.57,-1088.96 116476.07,-1078.96 116472.57,-1088.96 116479.57,-1088.96"/>
</g>
<!-- L12_S1_TP7_GPU15_attn_v -->
<g id="node1271" class="node">
<title>L12_S1_TP7_GPU15_attn_v</title>
<polygon fill="none" stroke="black" points="117500,-1184.67 116562,-1184.67 116562,-1116.67 117500,-1116.67 117500,-1184.67"/>
<text text-anchor="middle" x="117031" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="117031" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="117031" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="117031" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L12_S1_TP7_GPU15_attn_v&#45;&gt;L12_S1_TP0_GPU8_mha_ar -->
<g id="edge3597" class="edge">
<title>L12_S1_TP7_GPU15_attn_v&#45;&gt;L12_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M116593.58,-1116.64C116593.58,-1112.12 116593.58,-1109 116593.58,-1109 116593.58,-1109 111300.66,-1109 111300.66,-1109 111300.66,-1109 111300.66,-1070.17 111300.66,-1070.17"/>
<polygon fill="black" stroke="black" points="111304.16,-1070.17 111300.66,-1060.17 111297.16,-1070.17 111304.16,-1070.17"/>
</g>
<!-- L12_S1_TP7_GPU15_attn_v&#45;&gt;L12_S1_TP1_GPU9_mha_ar -->
<g id="edge3633" class="edge">
<title>L12_S1_TP7_GPU15_attn_v&#45;&gt;L12_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M116572.67,-1184.83C116572.67,-1201.92 116572.67,-1219 116572.67,-1219 116572.67,-1219 111770,-1219 111770,-1219 111770,-1219 111770,-1091.08 111770,-1091.08"/>
<polygon fill="black" stroke="black" points="111773.5,-1091.08 111770,-1081.08 111766.5,-1091.08 111773.5,-1091.08"/>
</g>
<!-- L12_S1_TP7_GPU15_attn_v&#45;&gt;L12_S1_TP2_GPU10_mha_ar -->
<g id="edge3669" class="edge">
<title>L12_S1_TP7_GPU15_attn_v&#45;&gt;L12_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M116567.33,-1184.72C116567.33,-1200.15 116567.33,-1215 116567.33,-1215 116567.33,-1215 112724.5,-1215 112724.5,-1215 112724.5,-1215 112724.5,-1083.98 112724.5,-1083.98"/>
<polygon fill="black" stroke="black" points="112728,-1083.98 112724.5,-1073.98 112721,-1083.98 112728,-1083.98"/>
</g>
<!-- L12_S1_TP7_GPU15_attn_v&#45;&gt;L12_S1_TP3_GPU11_mha_ar -->
<g id="edge3705" class="edge">
<title>L12_S1_TP7_GPU15_attn_v&#45;&gt;L12_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M116786.99,-1116.54C116786.99,-1066.73 116786.99,-980 116786.99,-980 116786.99,-980 113617.26,-980 113617.26,-980 113617.26,-980 113617.26,-996.6 113617.26,-996.6"/>
<polygon fill="black" stroke="black" points="113613.76,-996.6 113617.26,-1006.6 113620.76,-996.6 113613.76,-996.6"/>
</g>
<!-- L12_S1_TP7_GPU15_attn_v&#45;&gt;L12_S1_TP4_GPU12_mha_ar -->
<g id="edge3741" class="edge">
<title>L12_S1_TP7_GPU15_attn_v&#45;&gt;L12_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M116625.16,-1116.65C116625.16,-1103.25 116625.16,-1091 116625.16,-1091 116625.16,-1091 114337.26,-1091 114337.26,-1091 114337.26,-1091 114337.26,-1076.23 114337.26,-1076.23"/>
<polygon fill="black" stroke="black" points="114340.76,-1076.23 114337.26,-1066.23 114333.76,-1076.23 114340.76,-1076.23"/>
</g>
<!-- L12_S1_TP7_GPU15_attn_v&#45;&gt;L12_S1_TP5_GPU13_mha_ar -->
<g id="edge3777" class="edge">
<title>L12_S1_TP7_GPU15_attn_v&#45;&gt;L12_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M116656.74,-1116.65C116656.74,-1103.25 116656.74,-1091 116656.74,-1091 116656.74,-1091 115143.04,-1091 115143.04,-1091 115143.04,-1091 115143.04,-1070.76 115143.04,-1070.76"/>
<polygon fill="black" stroke="black" points="115146.54,-1070.76 115143.04,-1060.76 115139.54,-1070.76 115146.54,-1070.76"/>
</g>
<!-- L12_S1_TP7_GPU15_attn_v&#45;&gt;L12_S1_TP6_GPU14_mha_ar -->
<g id="edge3813" class="edge">
<title>L12_S1_TP7_GPU15_attn_v&#45;&gt;L12_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M116688.32,-1116.65C116688.32,-1103.25 116688.32,-1091 116688.32,-1091 116688.32,-1091 115935.41,-1091 115935.41,-1091 115935.41,-1091 115935.41,-1066.01 115935.41,-1066.01"/>
<polygon fill="black" stroke="black" points="115938.91,-1066.01 115935.41,-1056.01 115931.91,-1066.01 115938.91,-1066.01"/>
</g>
<!-- L12_S1_TP7_GPU15_attn_v&#45;&gt;L12_S1_TP7_GPU15_mha_ar -->
<g id="edge3849" class="edge">
<title>L12_S1_TP7_GPU15_attn_v&#45;&gt;L12_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M116719.89,-1116.51C116719.89,-1116.51 116719.89,-1061.95 116719.89,-1061.95"/>
<polygon fill="black" stroke="black" points="116723.39,-1061.95 116719.89,-1051.95 116716.39,-1061.95 116723.39,-1061.95"/>
</g>
<!-- L12_S1_TP0_GPU8_gate -->
<g id="node1273" class="node">
<title>L12_S1_TP0_GPU8_gate</title>
<polygon fill="none" stroke="black" points="110440.56,-844.5 109598.15,-844.5 109381.44,-708.5 110223.85,-708.5 110440.56,-844.5"/>
<text text-anchor="middle" x="109911" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="109911" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="109911" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="109911" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L12_S1_TP0_GPU8_mha_res&#45;&gt;L12_S1_TP0_GPU8_gate -->
<g id="edge3599" class="edge">
<title>L12_S1_TP0_GPU8_mha_res&#45;&gt;L12_S1_TP0_GPU8_gate</title>
<path fill="none" stroke="black" d="M109911,-880.39C109911,-880.39 109911,-854.73 109911,-854.73"/>
<polygon fill="black" stroke="black" points="109914.5,-854.73 109911,-844.73 109907.5,-854.73 109914.5,-854.73"/>
</g>
<!-- L12_S1_TP0_GPU8_moe_res -->
<g id="node1291" class="node">
<title>L12_S1_TP0_GPU8_moe_res</title>
<polygon fill="none" stroke="black" points="110469,-436.33 109649,-436.33 109649,-368.33 110469,-368.33 110469,-436.33"/>
<text text-anchor="middle" x="110059" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="110059" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="110059" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="110059" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP0_GPU8_mha_res&#45;&gt;L12_S1_TP0_GPU8_moe_res -->
<g id="edge3619" class="edge">
<title>L12_S1_TP0_GPU8_mha_res&#45;&gt;L12_S1_TP0_GPU8_moe_res</title>
<path fill="none" stroke="black" d="M110354.8,-925C110409.67,-925 110446.93,-925 110446.93,-925 110446.93,-925 110446.93,-680 110446.93,-680 110446.93,-680 110414.5,-680 110414.5,-680 110414.5,-680 110414.5,-446.38 110414.5,-446.38"/>
<polygon fill="black" stroke="black" points="110418,-446.38 110414.5,-436.38 110411,-446.38 110418,-446.38"/>
</g>
<!-- L12_S1_TP0_GPU8_expert0 -->
<g id="node1274" class="node">
<title>L12_S1_TP0_GPU8_expert0</title>
<polygon fill="none" stroke="black" points="110405.5,-672.5 109956.5,-672.5 109956.5,-604.5 110405.5,-604.5 110405.5,-672.5"/>
<text text-anchor="middle" x="110181" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="110181" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="110181" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="110181" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L12_S1_TP0_GPU8_gate&#45;&gt;L12_S1_TP0_GPU8_expert0 -->
<g id="edge3600" class="edge">
<title>L12_S1_TP0_GPU8_gate&#45;&gt;L12_S1_TP0_GPU8_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M110181,-708.31C110181,-708.31 110181,-682.71 110181,-682.71"/>
<polygon fill="black" stroke="black" points="110184.5,-682.71 110181,-672.71 110177.5,-682.71 110184.5,-682.71"/>
</g>
<!-- L12_S1_TP0_GPU8_expert1 -->
<g id="node1275" class="node">
<title>L12_S1_TP0_GPU8_expert1</title>
<polygon fill="none" stroke="black" points="110872.5,-672.5 110423.5,-672.5 110423.5,-604.5 110872.5,-604.5 110872.5,-672.5"/>
<text text-anchor="middle" x="110648" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="110648" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="110648" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="110648" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L12_S1_TP0_GPU8_gate&#45;&gt;L12_S1_TP0_GPU8_expert1 -->
<g id="edge3601" class="edge">
<title>L12_S1_TP0_GPU8_gate&#45;&gt;L12_S1_TP0_GPU8_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M110432.14,-776.4C110432.14,-776.4 110432.14,-682.74 110432.14,-682.74"/>
<polygon fill="black" stroke="black" points="110435.64,-682.74 110432.14,-672.74 110428.64,-682.74 110435.64,-682.74"/>
</g>
<!-- L12_S1_TP0_GPU8_moe_ar -->
<g id="node1276" class="node">
<title>L12_S1_TP0_GPU8_moe_ar</title>
<ellipse fill="none" stroke="black" cx="111279" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="111279" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="111279" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="111279" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="111279" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP0_GPU8_expert0&#45;&gt;L12_S1_TP0_GPU8_moe_ar -->
<g id="edge3602" class="edge">
<title>L12_S1_TP0_GPU8_expert0&#45;&gt;L12_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M110355.61,-604.37C110355.61,-563.08 110355.61,-499 110355.61,-499 110355.61,-499 110969.52,-499 110969.52,-499"/>
<polygon fill="black" stroke="black" points="110969.52,-502.5 110979.52,-499 110969.52,-495.5 110969.52,-502.5"/>
</g>
<!-- L12_S1_TP1_GPU9_moe_ar -->
<g id="node1300" class="node">
<title>L12_S1_TP1_GPU9_moe_ar</title>
<ellipse fill="none" stroke="black" cx="111966" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="111966" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="111966" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="111966" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="111966" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP0_GPU8_expert0&#45;&gt;L12_S1_TP1_GPU9_moe_ar -->
<g id="edge3638" class="edge">
<title>L12_S1_TP0_GPU8_expert0&#45;&gt;L12_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M110305.72,-604.33C110305.72,-592.43 110305.72,-582 110305.72,-582 110305.72,-582 111649.03,-582 111649.03,-582 111649.03,-582 111649.03,-545.96 111649.03,-545.96"/>
<polygon fill="black" stroke="black" points="111652.53,-545.96 111649.03,-535.96 111645.53,-545.96 111652.53,-545.96"/>
</g>
<!-- L12_S1_TP2_GPU10_moe_ar -->
<g id="node1310" class="node">
<title>L12_S1_TP2_GPU10_moe_ar</title>
<ellipse fill="none" stroke="black" cx="112653" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="112653" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="112653" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="112653" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="112653" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP0_GPU8_expert0&#45;&gt;L12_S1_TP2_GPU10_moe_ar -->
<g id="edge3674" class="edge">
<title>L12_S1_TP0_GPU8_expert0&#45;&gt;L12_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M110255.83,-604.31C110255.83,-552.23 110255.83,-459 110255.83,-459 110255.83,-459 112403.69,-459 112403.69,-459 112403.69,-459 112403.69,-478.27 112403.69,-478.27"/>
<polygon fill="black" stroke="black" points="112400.19,-478.27 112403.69,-488.27 112407.19,-478.27 112400.19,-478.27"/>
</g>
<!-- L12_S1_TP3_GPU11_moe_ar -->
<g id="node1320" class="node">
<title>L12_S1_TP3_GPU11_moe_ar</title>
<ellipse fill="none" stroke="black" cx="113340" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="113340" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="113340" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="113340" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="113340" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP0_GPU8_expert0&#45;&gt;L12_S1_TP3_GPU11_moe_ar -->
<g id="edge3710" class="edge">
<title>L12_S1_TP0_GPU8_expert0&#45;&gt;L12_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M110205.94,-604.31C110205.94,-552.23 110205.94,-459 110205.94,-459 110205.94,-459 113198.36,-459 113198.36,-459 113198.36,-459 113198.36,-466.76 113198.36,-466.76"/>
<polygon fill="black" stroke="black" points="113194.86,-466.76 113198.36,-476.76 113201.86,-466.76 113194.86,-466.76"/>
</g>
<!-- L12_S1_TP4_GPU12_moe_ar -->
<g id="node1330" class="node">
<title>L12_S1_TP4_GPU12_moe_ar</title>
<ellipse fill="none" stroke="black" cx="114027" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="114027" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="114027" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="114027" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="114027" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP0_GPU8_expert0&#45;&gt;L12_S1_TP4_GPU12_moe_ar -->
<g id="edge3746" class="edge">
<title>L12_S1_TP0_GPU8_expert0&#45;&gt;L12_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M110156.06,-604.31C110156.06,-552.23 110156.06,-459 110156.06,-459 110156.06,-459 113727.38,-459 113727.38,-459 113727.38,-459 113727.38,-488.94 113727.38,-488.94"/>
<polygon fill="black" stroke="black" points="113723.88,-488.94 113727.38,-498.94 113730.88,-488.94 113723.88,-488.94"/>
</g>
<!-- L12_S1_TP5_GPU13_moe_ar -->
<g id="node1340" class="node">
<title>L12_S1_TP5_GPU13_moe_ar</title>
<ellipse fill="none" stroke="black" cx="114714" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="114714" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="114714" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="114714" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="114714" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP0_GPU8_expert0&#45;&gt;L12_S1_TP5_GPU13_moe_ar -->
<g id="edge3782" class="edge">
<title>L12_S1_TP0_GPU8_expert0&#45;&gt;L12_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M110106.17,-604.31C110106.17,-552.23 110106.17,-459 110106.17,-459 110106.17,-459 114523.11,-459 114523.11,-459 114523.11,-459 114523.11,-470.83 114523.11,-470.83"/>
<polygon fill="black" stroke="black" points="114519.61,-470.83 114523.11,-480.83 114526.61,-470.83 114519.61,-470.83"/>
</g>
<!-- L12_S1_TP6_GPU14_moe_ar -->
<g id="node1350" class="node">
<title>L12_S1_TP6_GPU14_moe_ar</title>
<ellipse fill="none" stroke="black" cx="115401" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="115401" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="115401" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="115401" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="115401" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP0_GPU8_expert0&#45;&gt;L12_S1_TP6_GPU14_moe_ar -->
<g id="edge3818" class="edge">
<title>L12_S1_TP0_GPU8_expert0&#45;&gt;L12_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M110056.28,-604.31C110056.28,-552.23 110056.28,-459 110056.28,-459 110056.28,-459 115275.38,-459 115275.38,-459 115275.38,-459 115275.38,-465.78 115275.38,-465.78"/>
<polygon fill="black" stroke="black" points="115271.88,-465.78 115275.38,-475.78 115278.88,-465.78 115271.88,-465.78"/>
</g>
<!-- L12_S1_TP7_GPU15_moe_ar -->
<g id="node1360" class="node">
<title>L12_S1_TP7_GPU15_moe_ar</title>
<ellipse fill="none" stroke="black" cx="116088" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="116088" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="116088" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="116088" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="116088" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP0_GPU8_expert0&#45;&gt;L12_S1_TP7_GPU15_moe_ar -->
<g id="edge3854" class="edge">
<title>L12_S1_TP0_GPU8_expert0&#45;&gt;L12_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M110006.39,-604.11C110006.39,-549.98 110006.39,-451 110006.39,-451 110006.39,-451 116062.13,-451 116062.13,-451 116062.13,-451 116062.13,-462.2 116062.13,-462.2"/>
<polygon fill="black" stroke="black" points="116058.63,-462.2 116062.13,-472.2 116065.63,-462.2 116058.63,-462.2"/>
</g>
<!-- L12_S1_TP0_GPU8_expert1&#45;&gt;L12_S1_TP0_GPU8_moe_ar -->
<g id="edge3603" class="edge">
<title>L12_S1_TP0_GPU8_expert1&#45;&gt;L12_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M110835.06,-604.21C110835.06,-567.05 110835.06,-513 110835.06,-513 110835.06,-513 110938.52,-513 110938.52,-513"/>
<polygon fill="black" stroke="black" points="110938.52,-516.5 110948.52,-513 110938.52,-509.5 110938.52,-516.5"/>
</g>
<!-- L12_S1_TP0_GPU8_expert1&#45;&gt;L12_S1_TP1_GPU9_moe_ar -->
<g id="edge3639" class="edge">
<title>L12_S1_TP0_GPU8_expert1&#45;&gt;L12_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M110760.19,-604.33C110760.19,-592.43 110760.19,-582 110760.19,-582 110760.19,-582 111666.53,-582 111666.53,-582 111666.53,-582 111666.53,-551.96 111666.53,-551.96"/>
<polygon fill="black" stroke="black" points="111670.03,-551.96 111666.53,-541.96 111663.03,-551.96 111670.03,-551.96"/>
</g>
<!-- L12_S1_TP0_GPU8_expert1&#45;&gt;L12_S1_TP2_GPU10_moe_ar -->
<g id="edge3675" class="edge">
<title>L12_S1_TP0_GPU8_expert1&#45;&gt;L12_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M110797.62,-604.33C110797.62,-592.43 110797.62,-582 110797.62,-582 110797.62,-582 112365.42,-582 112365.42,-582 112365.42,-582 112365.42,-555.11 112365.42,-555.11"/>
<polygon fill="black" stroke="black" points="112368.92,-555.11 112365.42,-545.11 112361.92,-555.11 112368.92,-555.11"/>
</g>
<!-- L12_S1_TP0_GPU8_expert1&#45;&gt;L12_S1_TP3_GPU11_moe_ar -->
<g id="edge3711" class="edge">
<title>L12_S1_TP0_GPU8_expert1&#45;&gt;L12_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M110665.86,-672.68C110665.86,-687.27 110665.86,-701 110665.86,-701 110665.86,-701 113216.5,-701 113216.5,-701 113216.5,-701 113216.5,-575.52 113216.5,-575.52"/>
<polygon fill="black" stroke="black" points="113220,-575.52 113216.5,-565.52 113213,-575.52 113220,-575.52"/>
</g>
<!-- L12_S1_TP0_GPU8_expert1&#45;&gt;L12_S1_TP4_GPU12_moe_ar -->
<g id="edge3747" class="edge">
<title>L12_S1_TP0_GPU8_expert1&#45;&gt;L12_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M110722.75,-604.21C110722.75,-554.16 110722.75,-467 110722.75,-467 110722.75,-467 113715.77,-467 113715.77,-467 113715.77,-467 113715.77,-492.63 113715.77,-492.63"/>
<polygon fill="black" stroke="black" points="113712.27,-492.63 113715.77,-502.63 113719.27,-492.63 113712.27,-492.63"/>
</g>
<!-- L12_S1_TP0_GPU8_expert1&#45;&gt;L12_S1_TP5_GPU13_moe_ar -->
<g id="edge3783" class="edge">
<title>L12_S1_TP0_GPU8_expert1&#45;&gt;L12_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M110685.31,-604.21C110685.31,-554.16 110685.31,-467 110685.31,-467 110685.31,-467 114487.22,-467 114487.22,-467 114487.22,-467 114487.22,-474.79 114487.22,-474.79"/>
<polygon fill="black" stroke="black" points="114483.72,-474.79 114487.22,-484.79 114490.72,-474.79 114483.72,-474.79"/>
</g>
<!-- L12_S1_TP0_GPU8_expert1&#45;&gt;L12_S1_TP6_GPU14_moe_ar -->
<g id="edge3819" class="edge">
<title>L12_S1_TP0_GPU8_expert1&#45;&gt;L12_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M110647.88,-604.42C110647.88,-554.15 110647.88,-466 110647.88,-466 110647.88,-466 115205.77,-466 115205.77,-466 115205.77,-466 115205.77,-471.16 115205.77,-471.16"/>
<polygon fill="black" stroke="black" points="115202.27,-471.16 115205.77,-481.16 115209.27,-471.16 115202.27,-471.16"/>
</g>
<!-- L12_S1_TP0_GPU8_expert1&#45;&gt;L12_S1_TP7_GPU15_moe_ar -->
<g id="edge3855" class="edge">
<title>L12_S1_TP0_GPU8_expert1&#45;&gt;L12_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M110610.44,-604.11C110610.44,-549.98 110610.44,-451 110610.44,-451 110610.44,-451 115959.27,-451 115959.27,-451 115959.27,-451 115959.27,-465.67 115959.27,-465.67"/>
<polygon fill="black" stroke="black" points="115955.77,-465.67 115959.27,-475.67 115962.77,-465.67 115955.77,-465.67"/>
</g>
<!-- L12_S1_TP0_GPU8_moe_ar&#45;&gt;L12_S1_TP0_GPU8_moe_res -->
<g id="edge3618" class="edge">
<title>L12_S1_TP0_GPU8_moe_ar&#45;&gt;L12_S1_TP0_GPU8_moe_res</title>
<path fill="none" stroke="black" d="M111045.37,-486C110799.04,-486 110446.25,-486 110446.25,-486 110446.25,-486 110446.25,-446.36 110446.25,-446.36"/>
<polygon fill="black" stroke="black" points="110449.75,-446.36 110446.25,-436.36 110442.75,-446.36 110449.75,-446.36"/>
</g>
<!-- L12_S1_TP1_GPU9_expert0 -->
<g id="node1277" class="node">
<title>L12_S1_TP1_GPU9_expert0</title>
<polygon fill="none" stroke="black" points="111339.5,-672.5 110890.5,-672.5 110890.5,-604.5 111339.5,-604.5 111339.5,-672.5"/>
<text text-anchor="middle" x="111115" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="111115" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="111115" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="111115" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L12_S1_TP1_GPU9_expert0&#45;&gt;L12_S1_TP0_GPU8_moe_ar -->
<g id="edge3604" class="edge">
<title>L12_S1_TP1_GPU9_expert0&#45;&gt;L12_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M111010.37,-604.34C111010.37,-604.34 111010.37,-559.3 111010.37,-559.3"/>
<polygon fill="black" stroke="black" points="111013.87,-559.3 111010.37,-549.3 111006.87,-559.3 111013.87,-559.3"/>
</g>
<!-- L12_S1_TP1_GPU9_expert0&#45;&gt;L12_S1_TP1_GPU9_moe_ar -->
<g id="edge3640" class="edge">
<title>L12_S1_TP1_GPU9_expert0&#45;&gt;L12_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M111076.19,-604.33C111076.19,-592.43 111076.19,-582 111076.19,-582 111076.19,-582 111684.03,-582 111684.03,-582 111684.03,-582 111684.03,-556.53 111684.03,-556.53"/>
<polygon fill="black" stroke="black" points="111687.53,-556.53 111684.03,-546.53 111680.53,-556.53 111687.53,-556.53"/>
</g>
<!-- L12_S1_TP1_GPU9_expert0&#45;&gt;L12_S1_TP2_GPU10_moe_ar -->
<g id="edge3676" class="edge">
<title>L12_S1_TP1_GPU9_expert0&#45;&gt;L12_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M111142.02,-604.33C111142.02,-592.43 111142.02,-582 111142.02,-582 111142.02,-582 112412.31,-582 112412.31,-582 112412.31,-582 112412.31,-564.09 112412.31,-564.09"/>
<polygon fill="black" stroke="black" points="112415.81,-564.09 112412.31,-554.09 112408.81,-564.09 112415.81,-564.09"/>
</g>
<!-- L12_S1_TP1_GPU9_expert0&#45;&gt;L12_S1_TP3_GPU11_moe_ar -->
<g id="edge3712" class="edge">
<title>L12_S1_TP1_GPU9_expert0&#45;&gt;L12_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M111207.85,-604.33C111207.85,-592.43 111207.85,-582 111207.85,-582 111207.85,-582 113030.78,-582 113030.78,-582 113030.78,-582 113030.78,-548.89 113030.78,-548.89"/>
<polygon fill="black" stroke="black" points="113034.28,-548.89 113030.78,-538.89 113027.28,-548.89 113034.28,-548.89"/>
</g>
<!-- L12_S1_TP1_GPU9_expert0&#45;&gt;L12_S1_TP4_GPU12_moe_ar -->
<g id="edge3748" class="edge">
<title>L12_S1_TP1_GPU9_expert0&#45;&gt;L12_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M110931.03,-604.21C110931.03,-554.16 110931.03,-467 110931.03,-467 110931.03,-467 113704.15,-467 113704.15,-467 113704.15,-467 113704.15,-497.76 113704.15,-497.76"/>
<polygon fill="black" stroke="black" points="113700.65,-497.76 113704.15,-507.76 113707.65,-497.76 113700.65,-497.76"/>
</g>
<!-- L12_S1_TP1_GPU9_expert0&#45;&gt;L12_S1_TP5_GPU13_moe_ar -->
<g id="edge3784" class="edge">
<title>L12_S1_TP1_GPU9_expert0&#45;&gt;L12_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M110917.52,-604.21C110917.52,-554.16 110917.52,-467 110917.52,-467 110917.52,-467 114451.32,-467 114451.32,-467 114451.32,-467 114451.32,-480.58 114451.32,-480.58"/>
<polygon fill="black" stroke="black" points="114447.82,-480.58 114451.32,-490.58 114454.82,-480.58 114447.82,-480.58"/>
</g>
<!-- L12_S1_TP1_GPU9_expert0&#45;&gt;L12_S1_TP6_GPU14_moe_ar -->
<g id="edge3820" class="edge">
<title>L12_S1_TP1_GPU9_expert0&#45;&gt;L12_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M110904.01,-604.21C110904.01,-554.16 110904.01,-467 110904.01,-467 110904.01,-467 115136.15,-467 115136.15,-467 115136.15,-467 115136.15,-480.9 115136.15,-480.9"/>
<polygon fill="black" stroke="black" points="115132.65,-480.9 115136.15,-490.9 115139.65,-480.9 115132.65,-480.9"/>
</g>
<!-- L12_S1_TP1_GPU9_expert0&#45;&gt;L12_S1_TP7_GPU15_moe_ar -->
<g id="edge3856" class="edge">
<title>L12_S1_TP1_GPU9_expert0&#45;&gt;L12_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M111273.67,-604.3C111273.67,-592.88 111273.67,-583 111273.67,-583 111273.67,-583 115781.98,-583 115781.98,-583 115781.98,-583 115781.98,-549.88 115781.98,-549.88"/>
<polygon fill="black" stroke="black" points="115785.48,-549.88 115781.98,-539.88 115778.48,-549.88 115785.48,-549.88"/>
</g>
<!-- L12_S1_TP1_GPU9_expert1 -->
<g id="node1278" class="node">
<title>L12_S1_TP1_GPU9_expert1</title>
<polygon fill="none" stroke="black" points="111806.5,-672.5 111357.5,-672.5 111357.5,-604.5 111806.5,-604.5 111806.5,-672.5"/>
<text text-anchor="middle" x="111582" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="111582" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="111582" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="111582" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L12_S1_TP1_GPU9_expert1&#45;&gt;L12_S1_TP0_GPU8_moe_ar -->
<g id="edge3605" class="edge">
<title>L12_S1_TP1_GPU9_expert1&#45;&gt;L12_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M111380.77,-604.34C111380.77,-604.34 111380.77,-576.36 111380.77,-576.36"/>
<polygon fill="black" stroke="black" points="111384.27,-576.36 111380.77,-566.36 111377.27,-576.36 111384.27,-576.36"/>
</g>
<!-- L12_S1_TP1_GPU9_expert1&#45;&gt;L12_S1_TP1_GPU9_moe_ar -->
<g id="edge3641" class="edge">
<title>L12_S1_TP1_GPU9_expert1&#45;&gt;L12_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M111701.52,-604.34C111701.52,-604.34 111701.52,-560.09 111701.52,-560.09"/>
<polygon fill="black" stroke="black" points="111705.02,-560.09 111701.52,-550.09 111698.02,-560.09 111705.02,-560.09"/>
</g>
<!-- L12_S1_TP1_GPU9_expert1&#45;&gt;L12_S1_TP2_GPU10_moe_ar -->
<g id="edge3677" class="edge">
<title>L12_S1_TP1_GPU9_expert1&#45;&gt;L12_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M111736.52,-604.33C111736.52,-592.43 111736.52,-582 111736.52,-582 111736.52,-582 112459.19,-582 112459.19,-582 112459.19,-582 112459.19,-569.77 112459.19,-569.77"/>
<polygon fill="black" stroke="black" points="112462.69,-569.77 112459.19,-559.77 112455.69,-569.77 112462.69,-569.77"/>
</g>
<!-- L12_S1_TP1_GPU9_expert1&#45;&gt;L12_S1_TP3_GPU11_moe_ar -->
<g id="edge3713" class="edge">
<title>L12_S1_TP1_GPU9_expert1&#45;&gt;L12_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M111754.01,-604.33C111754.01,-592.43 111754.01,-582 111754.01,-582 111754.01,-582 113056.03,-582 113056.03,-582 113056.03,-582 113056.03,-555.82 113056.03,-555.82"/>
<polygon fill="black" stroke="black" points="113059.53,-555.82 113056.03,-545.82 113052.53,-555.82 113059.53,-555.82"/>
</g>
<!-- L12_S1_TP1_GPU9_expert1&#45;&gt;L12_S1_TP4_GPU12_moe_ar -->
<g id="edge3749" class="edge">
<title>L12_S1_TP1_GPU9_expert1&#45;&gt;L12_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M111771.51,-604.3C111771.51,-592.88 111771.51,-583 111771.51,-583 111771.51,-583 113737.43,-583 113737.43,-583 113737.43,-583 113737.43,-554.79 113737.43,-554.79"/>
<polygon fill="black" stroke="black" points="113740.93,-554.79 113737.43,-544.79 113733.93,-554.79 113740.93,-554.79"/>
</g>
<!-- L12_S1_TP1_GPU9_expert1&#45;&gt;L12_S1_TP5_GPU13_moe_ar -->
<g id="edge3785" class="edge">
<title>L12_S1_TP1_GPU9_expert1&#45;&gt;L12_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M111622.5,-604.2C111622.5,-555.2 111622.5,-471 111622.5,-471 111622.5,-471 114415.43,-471 114415.43,-471 114415.43,-471 114415.43,-488.6 114415.43,-488.6"/>
<polygon fill="black" stroke="black" points="114411.93,-488.6 114415.43,-498.6 114418.93,-488.6 114411.93,-488.6"/>
</g>
<!-- L12_S1_TP1_GPU9_expert1&#45;&gt;L12_S1_TP6_GPU14_moe_ar -->
<g id="edge3821" class="edge">
<title>L12_S1_TP1_GPU9_expert1&#45;&gt;L12_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M111789,-604.3C111789,-592.88 111789,-583 111789,-583 111789,-583 115205.75,-583 115205.75,-583 115205.75,-583 115205.75,-569.7 115205.75,-569.7"/>
<polygon fill="black" stroke="black" points="115209.25,-569.7 115205.75,-559.7 115202.25,-569.7 115209.25,-569.7"/>
</g>
<!-- L12_S1_TP1_GPU9_expert1&#45;&gt;L12_S1_TP7_GPU15_moe_ar -->
<g id="edge3857" class="edge">
<title>L12_S1_TP1_GPU9_expert1&#45;&gt;L12_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M111404.04,-604.3C111404.04,-592.88 111404.04,-583 111404.04,-583 111404.04,-583 115838.86,-583 115838.86,-583 115838.86,-583 115838.86,-562.81 115838.86,-562.81"/>
<polygon fill="black" stroke="black" points="115842.36,-562.81 115838.86,-552.81 115835.36,-562.81 115842.36,-562.81"/>
</g>
<!-- L12_S1_TP2_GPU10_expert0 -->
<g id="node1279" class="node">
<title>L12_S1_TP2_GPU10_expert0</title>
<polygon fill="none" stroke="black" points="112273.5,-672.5 111824.5,-672.5 111824.5,-604.5 112273.5,-604.5 112273.5,-672.5"/>
<text text-anchor="middle" x="112049" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="112049" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="112049" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="112049" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L12_S1_TP2_GPU10_expert0&#45;&gt;L12_S1_TP0_GPU8_moe_ar -->
<g id="edge3606" class="edge">
<title>L12_S1_TP2_GPU10_expert0&#45;&gt;L12_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M111880.62,-603.88C111880.62,-603.31 111880.62,-603 111880.62,-603 111880.62,-603 111427.31,-603 111427.31,-603 111427.31,-603 111427.31,-573.64 111427.31,-573.64"/>
<polygon fill="black" stroke="black" points="111430.81,-573.64 111427.31,-563.64 111423.81,-573.64 111430.81,-573.64"/>
</g>
<!-- L12_S1_TP2_GPU10_expert0&#45;&gt;L12_S1_TP1_GPU9_moe_ar -->
<g id="edge3642" class="edge">
<title>L12_S1_TP2_GPU10_expert0&#45;&gt;L12_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M111936.75,-604.34C111936.75,-604.34 111936.75,-578.55 111936.75,-578.55"/>
<polygon fill="black" stroke="black" points="111940.25,-578.55 111936.75,-568.55 111933.25,-578.55 111940.25,-578.55"/>
</g>
<!-- L12_S1_TP2_GPU10_expert0&#45;&gt;L12_S1_TP2_GPU10_moe_ar -->
<g id="edge3678" class="edge">
<title>L12_S1_TP2_GPU10_expert0&#45;&gt;L12_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M112049,-604.33C112049,-592.43 112049,-582 112049,-582 112049,-582 112506.08,-582 112506.08,-582 112506.08,-582 112506.08,-573.86 112506.08,-573.86"/>
<polygon fill="black" stroke="black" points="112509.58,-573.86 112506.08,-563.86 112502.58,-573.86 112509.58,-573.86"/>
</g>
<!-- L12_S1_TP2_GPU10_expert0&#45;&gt;L12_S1_TP3_GPU11_moe_ar -->
<g id="edge3714" class="edge">
<title>L12_S1_TP2_GPU10_expert0&#45;&gt;L12_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M112105.12,-604.33C112105.12,-592.43 112105.12,-582 112105.12,-582 112105.12,-582 113081.27,-582 113081.27,-582 113081.27,-582 113081.27,-561.21 113081.27,-561.21"/>
<polygon fill="black" stroke="black" points="113084.77,-561.21 113081.27,-551.21 113077.77,-561.21 113084.77,-561.21"/>
</g>
<!-- L12_S1_TP2_GPU10_expert0&#45;&gt;L12_S1_TP4_GPU12_moe_ar -->
<g id="edge3750" class="edge">
<title>L12_S1_TP2_GPU10_expert0&#45;&gt;L12_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M112161.25,-604.3C112161.25,-592.88 112161.25,-583 112161.25,-583 112161.25,-583 113782.33,-583 113782.33,-583 113782.33,-583 113782.33,-563.54 113782.33,-563.54"/>
<polygon fill="black" stroke="black" points="113785.83,-563.54 113782.33,-553.54 113778.83,-563.54 113785.83,-563.54"/>
</g>
<!-- L12_S1_TP2_GPU10_expert0&#45;&gt;L12_S1_TP5_GPU13_moe_ar -->
<g id="edge3786" class="edge">
<title>L12_S1_TP2_GPU10_expert0&#45;&gt;L12_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M112217.38,-604.3C112217.38,-592.88 112217.38,-583 112217.38,-583 112217.38,-583 114404.98,-583 114404.98,-583 114404.98,-583 114404.98,-548.85 114404.98,-548.85"/>
<polygon fill="black" stroke="black" points="114408.48,-548.85 114404.98,-538.85 114401.48,-548.86 114408.48,-548.85"/>
</g>
<!-- L12_S1_TP2_GPU10_expert0&#45;&gt;L12_S1_TP6_GPU14_moe_ar -->
<g id="edge3822" class="edge">
<title>L12_S1_TP2_GPU10_expert0&#45;&gt;L12_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M112161.25,-672.69C112161.25,-683.17 112161.25,-692 112161.25,-692 112161.25,-692 115090.5,-692 115090.5,-692 115090.5,-692 115090.5,-548.45 115090.5,-548.45"/>
<polygon fill="black" stroke="black" points="115094,-548.45 115090.5,-538.45 115087,-548.45 115094,-548.45"/>
</g>
<!-- L12_S1_TP2_GPU10_expert0&#45;&gt;L12_S1_TP7_GPU15_moe_ar -->
<g id="edge3858" class="edge">
<title>L12_S1_TP2_GPU10_expert0&#45;&gt;L12_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M112049,-672.69C112049,-683.17 112049,-692 112049,-692 112049,-692 116023.9,-692 116023.9,-692 116023.9,-692 116023.9,-577.76 116023.9,-577.76"/>
<polygon fill="black" stroke="black" points="116027.4,-577.76 116023.9,-567.76 116020.4,-577.76 116027.4,-577.76"/>
</g>
<!-- L12_S1_TP2_GPU10_expert1 -->
<g id="node1280" class="node">
<title>L12_S1_TP2_GPU10_expert1</title>
<polygon fill="none" stroke="black" points="112740.5,-672.5 112291.5,-672.5 112291.5,-604.5 112740.5,-604.5 112740.5,-672.5"/>
<text text-anchor="middle" x="112516" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="112516" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="112516" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="112516" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L12_S1_TP2_GPU10_expert1&#45;&gt;L12_S1_TP0_GPU8_moe_ar -->
<g id="edge3607" class="edge">
<title>L12_S1_TP2_GPU10_expert1&#45;&gt;L12_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M112306.49,-604.3C112306.49,-592.88 112306.49,-583 112306.49,-583 112306.49,-583 111450.58,-583 111450.58,-583 111450.58,-583 111450.58,-571.81 111450.58,-571.81"/>
<polygon fill="black" stroke="black" points="111454.08,-571.81 111450.58,-561.81 111447.08,-571.81 111454.08,-571.81"/>
</g>
<!-- L12_S1_TP2_GPU10_expert1&#45;&gt;L12_S1_TP1_GPU9_moe_ar -->
<g id="edge3643" class="edge">
<title>L12_S1_TP2_GPU10_expert1&#45;&gt;L12_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M112295.98,-604.34C112295.98,-604.34 112295.98,-538.63 112295.98,-538.63"/>
<polygon fill="black" stroke="black" points="112299.48,-538.63 112295.98,-528.63 112292.48,-538.63 112299.48,-538.63"/>
</g>
<!-- L12_S1_TP2_GPU10_expert1&#45;&gt;L12_S1_TP2_GPU10_moe_ar -->
<g id="edge3679" class="edge">
<title>L12_S1_TP2_GPU10_expert1&#45;&gt;L12_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M112552.96,-604.34C112552.96,-604.34 112552.96,-576.36 112552.96,-576.36"/>
<polygon fill="black" stroke="black" points="112556.46,-576.36 112552.96,-566.36 112549.46,-576.36 112556.46,-576.36"/>
</g>
<!-- L12_S1_TP2_GPU10_expert1&#45;&gt;L12_S1_TP3_GPU11_moe_ar -->
<g id="edge3715" class="edge">
<title>L12_S1_TP2_GPU10_expert1&#45;&gt;L12_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M112599.85,-604.33C112599.85,-592.43 112599.85,-582 112599.85,-582 112599.85,-582 113106.52,-582 113106.52,-582 113106.52,-582 113106.52,-565.17 113106.52,-565.17"/>
<polygon fill="black" stroke="black" points="113110.02,-565.17 113106.52,-555.17 113103.02,-565.17 113110.02,-565.17"/>
</g>
<!-- L12_S1_TP2_GPU10_expert1&#45;&gt;L12_S1_TP4_GPU12_moe_ar -->
<g id="edge3751" class="edge">
<title>L12_S1_TP2_GPU10_expert1&#45;&gt;L12_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M112646.73,-604.3C112646.73,-592.88 112646.73,-583 112646.73,-583 112646.73,-583 113827.23,-583 113827.23,-583 113827.23,-583 113827.23,-568.98 113827.23,-568.98"/>
<polygon fill="black" stroke="black" points="113830.73,-568.98 113827.23,-558.98 113823.73,-568.98 113830.73,-568.98"/>
</g>
<!-- L12_S1_TP2_GPU10_expert1&#45;&gt;L12_S1_TP5_GPU13_moe_ar -->
<g id="edge3787" class="edge">
<title>L12_S1_TP2_GPU10_expert1&#45;&gt;L12_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M112693.62,-604.3C112693.62,-592.88 112693.62,-583 112693.62,-583 112693.62,-583 114430.42,-583 114430.42,-583 114430.42,-583 114430.42,-556.23 114430.42,-556.23"/>
<polygon fill="black" stroke="black" points="114433.92,-556.23 114430.42,-546.23 114426.92,-556.23 114433.92,-556.23"/>
</g>
<!-- L12_S1_TP2_GPU10_expert1&#45;&gt;L12_S1_TP6_GPU14_moe_ar -->
<g id="edge3823" class="edge">
<title>L12_S1_TP2_GPU10_expert1&#45;&gt;L12_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M112698.74,-672.58C112698.74,-675.29 112698.74,-677 112698.74,-677 112698.74,-677 115087.5,-677 115087.5,-677 115087.5,-677 115087.5,-547.17 115087.5,-547.17"/>
<polygon fill="black" stroke="black" points="115091,-547.17 115087.5,-537.17 115084,-547.17 115091,-547.17"/>
</g>
<!-- L12_S1_TP2_GPU10_expert1&#45;&gt;L12_S1_TP7_GPU15_moe_ar -->
<g id="edge3859" class="edge">
<title>L12_S1_TP2_GPU10_expert1&#45;&gt;L12_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M112656.98,-672.69C112656.98,-683.17 112656.98,-692 112656.98,-692 112656.98,-692 116020.3,-692 116020.3,-692 116020.3,-692 116020.3,-577.76 116020.3,-577.76"/>
<polygon fill="black" stroke="black" points="116023.8,-577.76 116020.3,-567.76 116016.8,-577.76 116023.8,-577.76"/>
</g>
<!-- L12_S1_TP3_GPU11_expert0 -->
<g id="node1281" class="node">
<title>L12_S1_TP3_GPU11_expert0</title>
<polygon fill="none" stroke="black" points="113207.5,-672.5 112758.5,-672.5 112758.5,-604.5 113207.5,-604.5 113207.5,-672.5"/>
<text text-anchor="middle" x="112983" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="112983" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="112983" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="112983" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L12_S1_TP3_GPU11_expert0&#45;&gt;L12_S1_TP0_GPU8_moe_ar -->
<g id="edge3608" class="edge">
<title>L12_S1_TP3_GPU11_expert0&#45;&gt;L12_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M112787.12,-604.3C112787.12,-592.88 112787.12,-583 112787.12,-583 112787.12,-583 111473.85,-583 111473.85,-583 111473.85,-583 111473.85,-569.7 111473.85,-569.7"/>
<polygon fill="black" stroke="black" points="111477.35,-569.7 111473.85,-559.7 111470.35,-569.7 111477.35,-569.7"/>
</g>
<!-- L12_S1_TP3_GPU11_expert0&#45;&gt;L12_S1_TP1_GPU9_moe_ar -->
<g id="edge3644" class="edge">
<title>L12_S1_TP3_GPU11_expert0&#45;&gt;L12_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M112815.74,-604.3C112815.74,-592.88 112815.74,-583 112815.74,-583 112815.74,-583 112287,-583 112287,-583 112287,-583 112287,-544 112287,-544"/>
<polygon fill="black" stroke="black" points="112290.5,-544 112287,-534 112283.5,-544 112290.5,-544"/>
</g>
<!-- L12_S1_TP3_GPU11_expert0&#45;&gt;L12_S1_TP2_GPU10_moe_ar -->
<g id="edge3680" class="edge">
<title>L12_S1_TP3_GPU11_expert0&#45;&gt;L12_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M112844.36,-604.34C112844.36,-604.34 112844.36,-569.91 112844.36,-569.91"/>
<polygon fill="black" stroke="black" points="112847.86,-569.91 112844.36,-559.91 112840.86,-569.91 112847.86,-569.91"/>
</g>
<!-- L12_S1_TP3_GPU11_expert0&#45;&gt;L12_S1_TP3_GPU11_moe_ar -->
<g id="edge3716" class="edge">
<title>L12_S1_TP3_GPU11_expert0&#45;&gt;L12_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M113131.76,-604.34C113131.76,-604.34 113131.76,-568.22 113131.76,-568.22"/>
<polygon fill="black" stroke="black" points="113135.26,-568.22 113131.76,-558.22 113128.26,-568.22 113135.26,-568.22"/>
</g>
<!-- L12_S1_TP3_GPU11_expert0&#45;&gt;L12_S1_TP4_GPU12_moe_ar -->
<g id="edge3752" class="edge">
<title>L12_S1_TP3_GPU11_expert0&#45;&gt;L12_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M113157.01,-604.3C113157.01,-592.88 113157.01,-583 113157.01,-583 113157.01,-583 113917.02,-583 113917.02,-583 113917.02,-583 113917.02,-575.9 113917.02,-575.9"/>
<polygon fill="black" stroke="black" points="113920.52,-575.9 113917.02,-565.9 113913.52,-575.9 113920.52,-575.9"/>
</g>
<!-- L12_S1_TP3_GPU11_expert0&#45;&gt;L12_S1_TP5_GPU13_moe_ar -->
<g id="edge3788" class="edge">
<title>L12_S1_TP3_GPU11_expert0&#45;&gt;L12_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M113182.25,-604.3C113182.25,-592.88 113182.25,-583 113182.25,-583 113182.25,-583 114455.86,-583 114455.86,-583 114455.86,-583 114455.86,-561.34 114455.86,-561.34"/>
<polygon fill="black" stroke="black" points="114459.36,-561.34 114455.86,-551.34 114452.36,-561.34 114459.36,-561.34"/>
</g>
<!-- L12_S1_TP3_GPU11_expert0&#45;&gt;L12_S1_TP6_GPU14_moe_ar -->
<g id="edge3824" class="edge">
<title>L12_S1_TP3_GPU11_expert0&#45;&gt;L12_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M113057.83,-672.58C113057.83,-675.29 113057.83,-677 113057.83,-677 113057.83,-677 115084.5,-677 115084.5,-677 115084.5,-677 115084.5,-546 115084.5,-546"/>
<polygon fill="black" stroke="black" points="115088,-546 115084.5,-536 115081,-546 115088,-546"/>
</g>
<!-- L12_S1_TP3_GPU11_expert0&#45;&gt;L12_S1_TP7_GPU15_moe_ar -->
<g id="edge3860" class="edge">
<title>L12_S1_TP3_GPU11_expert0&#45;&gt;L12_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M112996.5,-604.11C112996.5,-549.98 112996.5,-451 112996.5,-451 112996.5,-451 115856.4,-451 115856.4,-451 115856.4,-451 115856.4,-475.71 115856.4,-475.71"/>
<polygon fill="black" stroke="black" points="115852.9,-475.71 115856.4,-485.71 115859.9,-475.71 115852.9,-475.71"/>
</g>
<!-- L12_S1_TP3_GPU11_expert1 -->
<g id="node1282" class="node">
<title>L12_S1_TP3_GPU11_expert1</title>
<polygon fill="none" stroke="black" points="113674.5,-672.5 113225.5,-672.5 113225.5,-604.5 113674.5,-604.5 113674.5,-672.5"/>
<text text-anchor="middle" x="113450" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="113450" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="113450" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="113450" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L12_S1_TP3_GPU11_expert1&#45;&gt;L12_S1_TP0_GPU8_moe_ar -->
<g id="edge3609" class="edge">
<title>L12_S1_TP3_GPU11_expert1&#45;&gt;L12_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M113275.38,-604.3C113275.38,-592.88 113275.38,-583 113275.38,-583 113275.38,-583 111497.12,-583 111497.12,-583 111497.12,-583 111497.12,-567.18 111497.12,-567.18"/>
<polygon fill="black" stroke="black" points="111500.62,-567.18 111497.12,-557.18 111493.62,-567.18 111500.62,-567.18"/>
</g>
<!-- L12_S1_TP3_GPU11_expert1&#45;&gt;L12_S1_TP1_GPU9_moe_ar -->
<g id="edge3645" class="edge">
<title>L12_S1_TP3_GPU11_expert1&#45;&gt;L12_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M113325.27,-604.3C113325.27,-592.88 113325.27,-583 113325.27,-583 113325.27,-583 112289.25,-583 112289.25,-583 112289.25,-583 112289.25,-542.78 112289.25,-542.78"/>
<polygon fill="black" stroke="black" points="112292.75,-542.78 112289.25,-532.78 112285.75,-542.78 112292.75,-542.78"/>
</g>
<!-- L12_S1_TP3_GPU11_expert1&#45;&gt;L12_S1_TP2_GPU10_moe_ar -->
<g id="edge3681" class="edge">
<title>L12_S1_TP3_GPU11_expert1&#45;&gt;L12_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M113375.15,-604.3C113375.15,-592.88 113375.15,-583 113375.15,-583 113375.15,-583 112872.98,-583 112872.98,-583 112872.98,-583 112872.98,-566.82 112872.98,-566.82"/>
<polygon fill="black" stroke="black" points="112876.48,-566.82 112872.98,-556.82 112869.48,-566.82 112876.48,-566.82"/>
</g>
<!-- L12_S1_TP3_GPU11_expert1&#45;&gt;L12_S1_TP3_GPU11_moe_ar -->
<g id="edge3717" class="edge">
<title>L12_S1_TP3_GPU11_expert1&#45;&gt;L12_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M113425.04,-604.34C113425.04,-604.34 113425.04,-577.23 113425.04,-577.23"/>
<polygon fill="black" stroke="black" points="113428.54,-577.23 113425.04,-567.23 113421.54,-577.23 113428.54,-577.23"/>
</g>
<!-- L12_S1_TP3_GPU11_expert1&#45;&gt;L12_S1_TP4_GPU12_moe_ar -->
<g id="edge3753" class="edge">
<title>L12_S1_TP3_GPU11_expert1&#45;&gt;L12_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M113674.7,-627C113681.52,-627 113685.43,-627 113685.43,-627 113685.43,-627 113685.43,-504 113685.43,-504 113685.43,-504 113702.52,-504 113702.52,-504"/>
<polygon fill="black" stroke="black" points="113702.52,-507.5 113712.52,-504 113702.52,-500.5 113702.52,-507.5"/>
</g>
<!-- L12_S1_TP3_GPU11_expert1&#45;&gt;L12_S1_TP5_GPU13_moe_ar -->
<g id="edge3789" class="edge">
<title>L12_S1_TP3_GPU11_expert1&#45;&gt;L12_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M113474.92,-604.3C113474.92,-592.88 113474.92,-583 113474.92,-583 113474.92,-583 114481.3,-583 114481.3,-583 114481.3,-583 114481.3,-565 114481.3,-565"/>
<polygon fill="black" stroke="black" points="114484.8,-565 114481.3,-555 114477.8,-565 114484.8,-565"/>
</g>
<!-- L12_S1_TP3_GPU11_expert1&#45;&gt;L12_S1_TP6_GPU14_moe_ar -->
<g id="edge3825" class="edge">
<title>L12_S1_TP3_GPU11_expert1&#45;&gt;L12_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M113562.25,-672.58C113562.25,-675.29 113562.25,-677 113562.25,-677 113562.25,-677 115081.5,-677 115081.5,-677 115081.5,-677 115081.5,-544.87 115081.5,-544.87"/>
<polygon fill="black" stroke="black" points="115085,-544.87 115081.5,-534.87 115078,-544.87 115085,-544.87"/>
</g>
<!-- L12_S1_TP3_GPU11_expert1&#45;&gt;L12_S1_TP7_GPU15_moe_ar -->
<g id="edge3861" class="edge">
<title>L12_S1_TP3_GPU11_expert1&#45;&gt;L12_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M113450,-672.69C113450,-683.17 113450,-692 113450,-692 113450,-692 116016.7,-692 116016.7,-692 116016.7,-692 116016.7,-577.76 116016.7,-577.76"/>
<polygon fill="black" stroke="black" points="116020.2,-577.76 116016.7,-567.76 116013.2,-577.76 116020.2,-577.76"/>
</g>
<!-- L12_S1_TP4_GPU12_expert0 -->
<g id="node1283" class="node">
<title>L12_S1_TP4_GPU12_expert0</title>
<polygon fill="none" stroke="black" points="114141.5,-672.5 113692.5,-672.5 113692.5,-604.5 114141.5,-604.5 114141.5,-672.5"/>
<text text-anchor="middle" x="113917" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="113917" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="113917" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="113917" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L12_S1_TP4_GPU12_expert0&#45;&gt;L12_S1_TP0_GPU8_moe_ar -->
<g id="edge3610" class="edge">
<title>L12_S1_TP4_GPU12_expert0&#45;&gt;L12_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M113917.36,-672.64C113917.36,-686.36 113917.36,-699 113917.36,-699 113917.36,-699 111351.5,-699 111351.5,-699 111351.5,-699 111351.5,-577.8 111351.5,-577.8"/>
<polygon fill="black" stroke="black" points="111355,-577.8 111351.5,-567.8 111348,-577.8 111355,-577.8"/>
</g>
<!-- L12_S1_TP4_GPU12_expert0&#45;&gt;L12_S1_TP1_GPU9_moe_ar -->
<g id="edge3646" class="edge">
<title>L12_S1_TP4_GPU12_expert0&#45;&gt;L12_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M113805.29,-672.58C113805.29,-675.29 113805.29,-677 113805.29,-677 113805.29,-677 112282.5,-677 112282.5,-677 112282.5,-677 112282.5,-546 112282.5,-546"/>
<polygon fill="black" stroke="black" points="112286,-546 112282.5,-536 112279,-546 112286,-546"/>
</g>
<!-- L12_S1_TP4_GPU12_expert0&#45;&gt;L12_S1_TP2_GPU10_moe_ar -->
<g id="edge3682" class="edge">
<title>L12_S1_TP4_GPU12_expert0&#45;&gt;L12_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M113872.12,-604.3C113872.12,-592.88 113872.12,-583 113872.12,-583 113872.12,-583 112901.6,-583 112901.6,-583 112901.6,-583 112901.6,-562.81 112901.6,-562.81"/>
<polygon fill="black" stroke="black" points="112905.1,-562.81 112901.6,-552.81 112898.1,-562.81 112905.1,-562.81"/>
</g>
<!-- L12_S1_TP4_GPU12_expert0&#45;&gt;L12_S1_TP3_GPU11_moe_ar -->
<g id="edge3718" class="edge">
<title>L12_S1_TP4_GPU12_expert0&#45;&gt;L12_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M113692.24,-649C113686.39,-649 113683.07,-649 113683.07,-649 113683.07,-649 113683.07,-536 113683.07,-536 113683.07,-536 113666.44,-536 113666.44,-536"/>
<polygon fill="black" stroke="black" points="113666.44,-532.5 113656.44,-536 113666.44,-539.5 113666.44,-532.5"/>
</g>
<!-- L12_S1_TP4_GPU12_expert0&#45;&gt;L12_S1_TP4_GPU12_moe_ar -->
<g id="edge3754" class="edge">
<title>L12_S1_TP4_GPU12_expert0&#45;&gt;L12_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M113961.92,-604.34C113961.92,-604.34 113961.92,-577.67 113961.92,-577.67"/>
<polygon fill="black" stroke="black" points="113965.42,-577.67 113961.92,-567.67 113958.42,-577.67 113965.42,-577.67"/>
</g>
<!-- L12_S1_TP4_GPU12_expert0&#45;&gt;L12_S1_TP5_GPU13_moe_ar -->
<g id="edge3790" class="edge">
<title>L12_S1_TP4_GPU12_expert0&#45;&gt;L12_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M114006.81,-603.88C114006.81,-603.31 114006.81,-603 114006.81,-603 114006.81,-603 114506.74,-603 114506.74,-603 114506.74,-603 114506.74,-568.32 114506.74,-568.32"/>
<polygon fill="black" stroke="black" points="114510.24,-568.32 114506.74,-558.32 114503.24,-568.32 114510.24,-568.32"/>
</g>
<!-- L12_S1_TP4_GPU12_expert0&#45;&gt;L12_S1_TP6_GPU14_moe_ar -->
<g id="edge3826" class="edge">
<title>L12_S1_TP4_GPU12_expert0&#45;&gt;L12_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M114051.71,-603.88C114051.71,-603.31 114051.71,-603 114051.71,-603 114051.71,-603 115078.5,-603 115078.5,-603 115078.5,-603 115078.5,-543.32 115078.5,-543.32"/>
<polygon fill="black" stroke="black" points="115082,-543.32 115078.5,-533.32 115075,-543.32 115082,-543.32"/>
</g>
<!-- L12_S1_TP4_GPU12_expert0&#45;&gt;L12_S1_TP7_GPU15_moe_ar -->
<g id="edge3862" class="edge">
<title>L12_S1_TP4_GPU12_expert0&#45;&gt;L12_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M114096.6,-603.88C114096.6,-603.31 114096.6,-603 114096.6,-603 114096.6,-603 115867.3,-603 115867.3,-603 115867.3,-603 115867.3,-566.88 115867.3,-566.88"/>
<polygon fill="black" stroke="black" points="115870.8,-566.88 115867.3,-556.88 115863.8,-566.88 115870.8,-566.88"/>
</g>
<!-- L12_S1_TP4_GPU12_expert1 -->
<g id="node1284" class="node">
<title>L12_S1_TP4_GPU12_expert1</title>
<polygon fill="none" stroke="black" points="114608.5,-672.5 114159.5,-672.5 114159.5,-604.5 114608.5,-604.5 114608.5,-672.5"/>
<text text-anchor="middle" x="114384" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="114384" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="114384" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="114384" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L12_S1_TP4_GPU12_expert1&#45;&gt;L12_S1_TP0_GPU8_moe_ar -->
<g id="edge3611" class="edge">
<title>L12_S1_TP4_GPU12_expert1&#45;&gt;L12_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M114370.5,-604.2C114370.5,-554.67 114370.5,-469 114370.5,-469 114370.5,-469 111539.97,-469 111539.97,-469 111539.97,-469 111539.97,-480.21 111539.97,-480.21"/>
<polygon fill="black" stroke="black" points="111536.47,-480.21 111539.97,-490.21 111543.47,-480.21 111536.47,-480.21"/>
</g>
<!-- L12_S1_TP4_GPU12_expert1&#45;&gt;L12_S1_TP1_GPU9_moe_ar -->
<g id="edge3647" class="edge">
<title>L12_S1_TP4_GPU12_expert1&#45;&gt;L12_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M114309.17,-672.58C114309.17,-675.29 114309.17,-677 114309.17,-677 114309.17,-677 112280.25,-677 112280.25,-677 112280.25,-677 112280.25,-547.17 112280.25,-547.17"/>
<polygon fill="black" stroke="black" points="112283.75,-547.17 112280.25,-537.17 112276.75,-547.17 112283.75,-547.17"/>
</g>
<!-- L12_S1_TP4_GPU12_expert1&#45;&gt;L12_S1_TP2_GPU10_moe_ar -->
<g id="edge3683" class="edge">
<title>L12_S1_TP4_GPU12_expert1&#45;&gt;L12_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M114184.75,-604.33C114184.75,-592.43 114184.75,-582 114184.75,-582 114184.75,-582 112930.22,-582 112930.22,-582 112930.22,-582 112930.22,-557.61 112930.22,-557.61"/>
<polygon fill="black" stroke="black" points="112933.72,-557.61 112930.22,-547.61 112926.72,-557.61 112933.72,-557.61"/>
</g>
<!-- L12_S1_TP4_GPU12_expert1&#45;&gt;L12_S1_TP3_GPU11_moe_ar -->
<g id="edge3719" class="edge">
<title>L12_S1_TP4_GPU12_expert1&#45;&gt;L12_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M114209.99,-604.3C114209.99,-592.88 114209.99,-583 114209.99,-583 114209.99,-583 113524.81,-583 113524.81,-583 113524.81,-583 113524.81,-570.76 113524.81,-570.76"/>
<polygon fill="black" stroke="black" points="113528.31,-570.76 113524.81,-560.76 113521.31,-570.76 113528.31,-570.76"/>
</g>
<!-- L12_S1_TP4_GPU12_expert1&#45;&gt;L12_S1_TP4_GPU12_moe_ar -->
<g id="edge3755" class="edge">
<title>L12_S1_TP4_GPU12_expert1&#45;&gt;L12_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M114235.24,-604.34C114235.24,-604.34 114235.24,-568.22 114235.24,-568.22"/>
<polygon fill="black" stroke="black" points="114238.74,-568.22 114235.24,-558.22 114231.74,-568.22 114238.74,-568.22"/>
</g>
<!-- L12_S1_TP4_GPU12_expert1&#45;&gt;L12_S1_TP5_GPU13_moe_ar -->
<g id="edge3791" class="edge">
<title>L12_S1_TP4_GPU12_expert1&#45;&gt;L12_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M114532.18,-604.34C114532.18,-604.34 114532.18,-571.18 114532.18,-571.18"/>
<polygon fill="black" stroke="black" points="114535.68,-571.18 114532.18,-561.18 114528.68,-571.18 114535.68,-571.18"/>
</g>
<!-- L12_S1_TP4_GPU12_expert1&#45;&gt;L12_S1_TP6_GPU14_moe_ar -->
<g id="edge3827" class="edge">
<title>L12_S1_TP4_GPU12_expert1&#45;&gt;L12_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M114557.62,-603.88C114557.62,-603.31 114557.62,-603 114557.62,-603 114557.62,-603 115069.53,-603 115069.53,-603 115069.53,-603 115069.53,-536.9 115069.53,-536.9"/>
<polygon fill="black" stroke="black" points="115073.03,-536.9 115069.53,-526.9 115066.03,-536.9 115073.03,-536.9"/>
</g>
<!-- L12_S1_TP4_GPU12_expert1&#45;&gt;L12_S1_TP7_GPU15_moe_ar -->
<g id="edge3863" class="edge">
<title>L12_S1_TP4_GPU12_expert1&#45;&gt;L12_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M114583.06,-603.88C114583.06,-603.31 114583.06,-603 114583.06,-603 114583.06,-603 115895.74,-603 115895.74,-603 115895.74,-603 115895.74,-569.77 115895.74,-569.77"/>
<polygon fill="black" stroke="black" points="115899.24,-569.77 115895.74,-559.77 115892.24,-569.77 115899.24,-569.77"/>
</g>
<!-- L12_S1_TP5_GPU13_expert0 -->
<g id="node1285" class="node">
<title>L12_S1_TP5_GPU13_expert0</title>
<polygon fill="none" stroke="black" points="115075.5,-672.5 114626.5,-672.5 114626.5,-604.5 115075.5,-604.5 115075.5,-672.5"/>
<text text-anchor="middle" x="114851" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="114851" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="114851" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="114851" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L12_S1_TP5_GPU13_expert0&#45;&gt;L12_S1_TP0_GPU8_moe_ar -->
<g id="edge3612" class="edge">
<title>L12_S1_TP5_GPU13_expert0&#45;&gt;L12_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M114710.69,-672.53C114710.69,-688.89 114710.69,-705 114710.69,-705 114710.69,-705 111345.5,-705 111345.5,-705 111345.5,-705 111345.5,-577.95 111345.5,-577.95"/>
<polygon fill="black" stroke="black" points="111349,-577.95 111345.5,-567.95 111342,-577.95 111349,-577.95"/>
</g>
<!-- L12_S1_TP5_GPU13_expert0&#45;&gt;L12_S1_TP1_GPU9_moe_ar -->
<g id="edge3648" class="edge">
<title>L12_S1_TP5_GPU13_expert0&#45;&gt;L12_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M114668.59,-672.58C114668.59,-675.29 114668.59,-677 114668.59,-677 114668.59,-677 112278,-677 112278,-677 112278,-677 112278,-547.77 112278,-547.77"/>
<polygon fill="black" stroke="black" points="112281.5,-547.77 112278,-537.77 112274.5,-547.77 112281.5,-547.77"/>
</g>
<!-- L12_S1_TP5_GPU13_expert0&#45;&gt;L12_S1_TP2_GPU10_moe_ar -->
<g id="edge3684" class="edge">
<title>L12_S1_TP5_GPU13_expert0&#45;&gt;L12_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M114668.7,-604.33C114668.7,-592.43 114668.7,-582 114668.7,-582 114668.7,-582 112958.84,-582 112958.84,-582 112958.84,-582 112958.84,-549.9 112958.84,-549.9"/>
<polygon fill="black" stroke="black" points="112962.34,-549.9 112958.84,-539.9 112955.34,-549.9 112962.34,-549.9"/>
</g>
<!-- L12_S1_TP5_GPU13_expert0&#45;&gt;L12_S1_TP3_GPU11_moe_ar -->
<g id="edge3720" class="edge">
<title>L12_S1_TP5_GPU13_expert0&#45;&gt;L12_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M114710.89,-604.33C114710.89,-592.43 114710.89,-582 114710.89,-582 114710.89,-582 113574.69,-582 113574.69,-582 113574.69,-582 113574.69,-564.81 113574.69,-564.81"/>
<polygon fill="black" stroke="black" points="113578.19,-564.81 113574.69,-554.81 113571.19,-564.81 113578.19,-564.81"/>
</g>
<!-- L12_S1_TP5_GPU13_expert0&#45;&gt;L12_S1_TP4_GPU12_moe_ar -->
<g id="edge3756" class="edge">
<title>L12_S1_TP5_GPU13_expert0&#45;&gt;L12_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M114753.09,-604.33C114753.09,-592.43 114753.09,-582 114753.09,-582 114753.09,-582 114260.48,-582 114260.48,-582 114260.48,-582 114260.48,-565.17 114260.48,-565.17"/>
<polygon fill="black" stroke="black" points="114263.98,-565.17 114260.48,-555.17 114256.98,-565.17 114263.98,-565.17"/>
</g>
<!-- L12_S1_TP5_GPU13_expert0&#45;&gt;L12_S1_TP5_GPU13_moe_ar -->
<g id="edge3792" class="edge">
<title>L12_S1_TP5_GPU13_expert0&#45;&gt;L12_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M114795.28,-604.34C114795.28,-604.34 114795.28,-577.23 114795.28,-577.23"/>
<polygon fill="black" stroke="black" points="114798.78,-577.23 114795.28,-567.23 114791.78,-577.23 114798.78,-577.23"/>
</g>
<!-- L12_S1_TP5_GPU13_expert0&#45;&gt;L12_S1_TP6_GPU14_moe_ar -->
<g id="edge3828" class="edge">
<title>L12_S1_TP5_GPU13_expert0&#45;&gt;L12_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M115072.51,-604.34C115072.51,-604.34 115072.51,-539.61 115072.51,-539.61"/>
<polygon fill="black" stroke="black" points="115076.01,-539.61 115072.51,-529.61 115069.01,-539.61 115076.01,-539.61"/>
</g>
<!-- L12_S1_TP5_GPU13_expert0&#45;&gt;L12_S1_TP7_GPU15_moe_ar -->
<g id="edge3864" class="edge">
<title>L12_S1_TP5_GPU13_expert0&#45;&gt;L12_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M115057.5,-603.88C115057.5,-603.31 115057.5,-603 115057.5,-603 115057.5,-603 115924.18,-603 115924.18,-603 115924.18,-603 115924.18,-572.68 115924.18,-572.68"/>
<polygon fill="black" stroke="black" points="115927.68,-572.68 115924.18,-562.68 115920.68,-572.68 115927.68,-572.68"/>
</g>
<!-- L12_S1_TP5_GPU13_expert1 -->
<g id="node1286" class="node">
<title>L12_S1_TP5_GPU13_expert1</title>
<polygon fill="none" stroke="black" points="115542.5,-672.5 115093.5,-672.5 115093.5,-604.5 115542.5,-604.5 115542.5,-672.5"/>
<text text-anchor="middle" x="115318" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="115318" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="115318" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="115318" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L12_S1_TP5_GPU13_expert1&#45;&gt;L12_S1_TP0_GPU8_moe_ar -->
<g id="edge3613" class="edge">
<title>L12_S1_TP5_GPU13_expert1&#45;&gt;L12_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M115149.62,-604.3C115149.62,-592.88 115149.62,-583 115149.62,-583 115149.62,-583 111520.38,-583 111520.38,-583 111520.38,-583 111520.38,-563.91 111520.38,-563.91"/>
<polygon fill="black" stroke="black" points="111523.88,-563.91 111520.38,-553.91 111516.88,-563.91 111523.88,-563.91"/>
</g>
<!-- L12_S1_TP5_GPU13_expert1&#45;&gt;L12_S1_TP1_GPU9_moe_ar -->
<g id="edge3649" class="edge">
<title>L12_S1_TP5_GPU13_expert1&#45;&gt;L12_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M115318,-672.58C115318,-675.29 115318,-677 115318,-677 115318,-677 112275.75,-677 112275.75,-677 112275.75,-677 112275.75,-548.68 112275.75,-548.68"/>
<polygon fill="black" stroke="black" points="112279.25,-548.68 112275.75,-538.68 112272.25,-548.68 112279.25,-548.68"/>
</g>
<!-- L12_S1_TP5_GPU13_expert1&#45;&gt;L12_S1_TP2_GPU10_moe_ar -->
<g id="edge3685" class="edge">
<title>L12_S1_TP5_GPU13_expert1&#45;&gt;L12_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M115205.75,-672.58C115205.75,-675.29 115205.75,-677 115205.75,-677 115205.75,-677 112749.5,-677 112749.5,-677 112749.5,-677 112749.5,-576.55 112749.5,-576.55"/>
<polygon fill="black" stroke="black" points="112753,-576.55 112749.5,-566.55 112746,-576.55 112753,-576.55"/>
</g>
<!-- L12_S1_TP5_GPU13_expert1&#45;&gt;L12_S1_TP3_GPU11_moe_ar -->
<g id="edge3721" class="edge">
<title>L12_S1_TP5_GPU13_expert1&#45;&gt;L12_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M115261.88,-604.33C115261.88,-592.43 115261.88,-582 115261.88,-582 115261.88,-582 113624.58,-582 113624.58,-582 113624.58,-582 113624.58,-555.82 113624.58,-555.82"/>
<polygon fill="black" stroke="black" points="113628.08,-555.82 113624.58,-545.82 113621.08,-555.82 113628.08,-555.82"/>
</g>
<!-- L12_S1_TP5_GPU13_expert1&#45;&gt;L12_S1_TP4_GPU12_moe_ar -->
<g id="edge3757" class="edge">
<title>L12_S1_TP5_GPU13_expert1&#45;&gt;L12_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M115318,-604.33C115318,-592.43 115318,-582 115318,-582 115318,-582 114285.73,-582 114285.73,-582 114285.73,-582 114285.73,-561.21 114285.73,-561.21"/>
<polygon fill="black" stroke="black" points="114289.23,-561.21 114285.73,-551.21 114282.23,-561.21 114289.23,-561.21"/>
</g>
<!-- L12_S1_TP5_GPU13_expert1&#45;&gt;L12_S1_TP5_GPU13_moe_ar -->
<g id="edge3793" class="edge">
<title>L12_S1_TP5_GPU13_expert1&#45;&gt;L12_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M115374.12,-604.33C115374.12,-592.43 115374.12,-582 115374.12,-582 115374.12,-582 114837.48,-582 114837.48,-582 114837.48,-582 114837.48,-575.17 114837.48,-575.17"/>
<polygon fill="black" stroke="black" points="114840.98,-575.17 114837.48,-565.17 114833.98,-575.17 114840.98,-575.17"/>
</g>
<!-- L12_S1_TP5_GPU13_expert1&#45;&gt;L12_S1_TP6_GPU14_moe_ar -->
<g id="edge3829" class="edge">
<title>L12_S1_TP5_GPU13_expert1&#45;&gt;L12_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M115430.25,-604.34C115430.25,-604.34 115430.25,-578.55 115430.25,-578.55"/>
<polygon fill="black" stroke="black" points="115433.75,-578.55 115430.25,-568.55 115426.75,-578.55 115433.75,-578.55"/>
</g>
<!-- L12_S1_TP5_GPU13_expert1&#45;&gt;L12_S1_TP7_GPU15_moe_ar -->
<g id="edge3865" class="edge">
<title>L12_S1_TP5_GPU13_expert1&#45;&gt;L12_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M115486.38,-603.88C115486.38,-603.31 115486.38,-603 115486.38,-603 115486.38,-603 115952.62,-603 115952.62,-603 115952.62,-603 115952.62,-574.61 115952.62,-574.61"/>
<polygon fill="black" stroke="black" points="115956.12,-574.61 115952.62,-564.61 115949.12,-574.61 115956.12,-574.61"/>
</g>
<!-- L12_S1_TP6_GPU14_expert0 -->
<g id="node1287" class="node">
<title>L12_S1_TP6_GPU14_expert0</title>
<polygon fill="none" stroke="black" points="116009.5,-672.5 115560.5,-672.5 115560.5,-604.5 116009.5,-604.5 116009.5,-672.5"/>
<text text-anchor="middle" x="115785" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="115785" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="115785" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="115785" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L12_S1_TP6_GPU14_expert0&#45;&gt;L12_S1_TP0_GPU8_moe_ar -->
<g id="edge3614" class="edge">
<title>L12_S1_TP6_GPU14_expert0&#45;&gt;L12_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M115810.42,-604.3C115810.42,-592.88 115810.42,-583 115810.42,-583 115810.42,-583 111543.65,-583 111543.65,-583 111543.65,-583 111543.65,-559.88 111543.65,-559.88"/>
<polygon fill="black" stroke="black" points="111547.15,-559.88 111543.65,-549.88 111540.15,-559.88 111547.15,-559.88"/>
</g>
<!-- L12_S1_TP6_GPU14_expert0&#45;&gt;L12_S1_TP1_GPU9_moe_ar -->
<g id="edge3650" class="edge">
<title>L12_S1_TP6_GPU14_expert0&#45;&gt;L12_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M115582.37,-604.3C115582.37,-592.88 115582.37,-583 115582.37,-583 115582.37,-583 111992.88,-583 111992.88,-583 111992.88,-583 111992.88,-578.48 111992.88,-578.48"/>
<polygon fill="black" stroke="black" points="111996.38,-578.48 111992.88,-568.48 111989.38,-578.48 111996.38,-578.48"/>
</g>
<!-- L12_S1_TP6_GPU14_expert0&#45;&gt;L12_S1_TP2_GPU10_moe_ar -->
<g id="edge3686" class="edge">
<title>L12_S1_TP6_GPU14_expert0&#45;&gt;L12_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M115744.5,-604.11C115744.5,-549.98 115744.5,-451 115744.5,-451 115744.5,-451 112942.77,-451 112942.77,-451 112942.77,-451 112942.77,-486.14 112942.77,-486.14"/>
<polygon fill="black" stroke="black" points="112939.27,-486.14 112942.77,-496.14 112946.27,-486.14 112939.27,-486.14"/>
</g>
<!-- L12_S1_TP6_GPU14_expert0&#45;&gt;L12_S1_TP3_GPU11_moe_ar -->
<g id="edge3722" class="edge">
<title>L12_S1_TP6_GPU14_expert0&#45;&gt;L12_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M115739.98,-604.11C115739.98,-549.98 115739.98,-451 115739.98,-451 115739.98,-451 113656.37,-451 113656.37,-451 113656.37,-451 113656.37,-494.66 113656.37,-494.66"/>
<polygon fill="black" stroke="black" points="113652.87,-494.66 113656.37,-504.66 113659.87,-494.66 113652.87,-494.66"/>
</g>
<!-- L12_S1_TP6_GPU14_expert0&#45;&gt;L12_S1_TP4_GPU12_moe_ar -->
<g id="edge3758" class="edge">
<title>L12_S1_TP6_GPU14_expert0&#45;&gt;L12_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M115604.24,-604.33C115604.24,-592.43 115604.24,-582 115604.24,-582 115604.24,-582 114310.97,-582 114310.97,-582 114310.97,-582 114310.97,-555.82 114310.97,-555.82"/>
<polygon fill="black" stroke="black" points="114314.47,-555.82 114310.97,-545.82 114307.47,-555.82 114314.47,-555.82"/>
</g>
<!-- L12_S1_TP6_GPU14_expert0&#45;&gt;L12_S1_TP5_GPU13_moe_ar -->
<g id="edge3794" class="edge">
<title>L12_S1_TP6_GPU14_expert0&#45;&gt;L12_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M115626.11,-604.33C115626.11,-592.43 115626.11,-582 115626.11,-582 115626.11,-582 114879.68,-582 114879.68,-582 114879.68,-582 114879.68,-572.51 114879.68,-572.51"/>
<polygon fill="black" stroke="black" points="114883.18,-572.51 114879.68,-562.51 114876.18,-572.51 114883.18,-572.51"/>
</g>
<!-- L12_S1_TP6_GPU14_expert0&#45;&gt;L12_S1_TP6_GPU14_moe_ar -->
<g id="edge3830" class="edge">
<title>L12_S1_TP6_GPU14_expert0&#45;&gt;L12_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M115647.98,-604.34C115647.98,-604.34 115647.98,-562.87 115647.98,-562.87"/>
<polygon fill="black" stroke="black" points="115651.48,-562.87 115647.98,-552.87 115644.48,-562.87 115651.48,-562.87"/>
</g>
<!-- L12_S1_TP6_GPU14_expert0&#45;&gt;L12_S1_TP7_GPU15_moe_ar -->
<g id="edge3866" class="edge">
<title>L12_S1_TP6_GPU14_expert0&#45;&gt;L12_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M115981.06,-604.34C115981.06,-604.34 115981.06,-576.36 115981.06,-576.36"/>
<polygon fill="black" stroke="black" points="115984.56,-576.36 115981.06,-566.36 115977.56,-576.36 115984.56,-576.36"/>
</g>
<!-- L12_S1_TP6_GPU14_expert1 -->
<g id="node1288" class="node">
<title>L12_S1_TP6_GPU14_expert1</title>
<polygon fill="none" stroke="black" points="116476.5,-672.5 116027.5,-672.5 116027.5,-604.5 116476.5,-604.5 116476.5,-672.5"/>
<text text-anchor="middle" x="116252" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="116252" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="116252" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="116252" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L12_S1_TP6_GPU14_expert1&#45;&gt;L12_S1_TP0_GPU8_moe_ar -->
<g id="edge3615" class="edge">
<title>L12_S1_TP6_GPU14_expert1&#45;&gt;L12_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M116083.92,-604.3C116083.92,-592.88 116083.92,-583 116083.92,-583 116083.92,-583 111566.92,-583 111566.92,-583 111566.92,-583 111566.92,-555.15 111566.92,-555.15"/>
<polygon fill="black" stroke="black" points="111570.42,-555.15 111566.92,-545.15 111563.42,-555.15 111570.42,-555.15"/>
</g>
<!-- L12_S1_TP6_GPU14_expert1&#45;&gt;L12_S1_TP1_GPU9_moe_ar -->
<g id="edge3651" class="edge">
<title>L12_S1_TP6_GPU14_expert1&#45;&gt;L12_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M116140.35,-604.3C116140.35,-592.88 116140.35,-583 116140.35,-583 116140.35,-583 111719.02,-583 111719.02,-583 111719.02,-583 111719.02,-563.17 111719.02,-563.17"/>
<polygon fill="black" stroke="black" points="111722.52,-563.17 111719.02,-553.17 111715.52,-563.17 111722.52,-563.17"/>
</g>
<!-- L12_S1_TP6_GPU14_expert1&#45;&gt;L12_S1_TP2_GPU10_moe_ar -->
<g id="edge3687" class="edge">
<title>L12_S1_TP6_GPU14_expert1&#45;&gt;L12_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M116458.49,-604.36C116458.49,-550.04 116458.49,-450 116458.49,-450 116458.49,-450 112898.08,-450 112898.08,-450 112898.08,-450 112898.08,-477.68 112898.08,-477.68"/>
<polygon fill="black" stroke="black" points="112894.58,-477.68 112898.08,-487.68 112901.58,-477.68 112894.58,-477.68"/>
</g>
<!-- L12_S1_TP6_GPU14_expert1&#45;&gt;L12_S1_TP3_GPU11_moe_ar -->
<g id="edge3723" class="edge">
<title>L12_S1_TP6_GPU14_expert1&#45;&gt;L12_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M116440.47,-604.11C116440.47,-549.98 116440.47,-451 116440.47,-451 116440.47,-451 113638.28,-451 113638.28,-451 113638.28,-451 113638.28,-488.45 113638.28,-488.45"/>
<polygon fill="black" stroke="black" points="113634.78,-488.45 113638.28,-498.45 113641.78,-488.45 113634.78,-488.45"/>
</g>
<!-- L12_S1_TP6_GPU14_expert1&#45;&gt;L12_S1_TP4_GPU12_moe_ar -->
<g id="edge3759" class="edge">
<title>L12_S1_TP6_GPU14_expert1&#45;&gt;L12_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M116196.77,-604.33C116196.77,-592.43 116196.77,-582 116196.77,-582 116196.77,-582 114336.22,-582 114336.22,-582 114336.22,-582 114336.22,-548.89 114336.22,-548.89"/>
<polygon fill="black" stroke="black" points="114339.72,-548.89 114336.22,-538.89 114332.72,-548.89 114339.72,-548.89"/>
</g>
<!-- L12_S1_TP6_GPU14_expert1&#45;&gt;L12_S1_TP5_GPU13_moe_ar -->
<g id="edge3795" class="edge">
<title>L12_S1_TP6_GPU14_expert1&#45;&gt;L12_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M116253.19,-604.33C116253.19,-592.43 116253.19,-582 116253.19,-582 116253.19,-582 114921.87,-582 114921.87,-582 114921.87,-582 114921.87,-568.37 114921.87,-568.37"/>
<polygon fill="black" stroke="black" points="114925.37,-568.37 114921.87,-558.37 114918.37,-568.37 114925.37,-568.37"/>
</g>
<!-- L12_S1_TP6_GPU14_expert1&#45;&gt;L12_S1_TP6_GPU14_moe_ar -->
<g id="edge3831" class="edge">
<title>L12_S1_TP6_GPU14_expert1&#45;&gt;L12_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M116309.62,-604.33C116309.62,-592.43 116309.62,-582 116309.62,-582 116309.62,-582 115669.85,-582 115669.85,-582 115669.85,-582 115669.85,-559.04 115669.85,-559.04"/>
<polygon fill="black" stroke="black" points="115673.35,-559.04 115669.85,-549.04 115666.35,-559.04 115673.35,-559.04"/>
</g>
<!-- L12_S1_TP6_GPU14_expert1&#45;&gt;L12_S1_TP7_GPU15_moe_ar -->
<g id="edge3867" class="edge">
<title>L12_S1_TP6_GPU14_expert1&#45;&gt;L12_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M116366.04,-604.34C116366.04,-604.34 116366.04,-557.38 116366.04,-557.38"/>
<polygon fill="black" stroke="black" points="116369.54,-557.38 116366.04,-547.38 116362.54,-557.38 116369.54,-557.38"/>
</g>
<!-- L12_S1_TP7_GPU15_expert0 -->
<g id="node1289" class="node">
<title>L12_S1_TP7_GPU15_expert0</title>
<polygon fill="none" stroke="black" points="116943.5,-672.5 116494.5,-672.5 116494.5,-604.5 116943.5,-604.5 116943.5,-672.5"/>
<text text-anchor="middle" x="116719" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="116719" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="116719" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="116719" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L12_S1_TP7_GPU15_expert0&#45;&gt;L12_S1_TP0_GPU8_moe_ar -->
<g id="edge3616" class="edge">
<title>L12_S1_TP7_GPU15_expert0&#45;&gt;L12_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M116502.56,-604.3C116502.56,-592.88 116502.56,-583 116502.56,-583 116502.56,-583 111590.19,-583 111590.19,-583 111590.19,-583 111590.19,-548.18 111590.19,-548.18"/>
<polygon fill="black" stroke="black" points="111593.69,-548.18 111590.19,-538.18 111586.69,-548.18 111593.69,-548.18"/>
</g>
<!-- L12_S1_TP7_GPU15_expert0&#45;&gt;L12_S1_TP1_GPU9_moe_ar -->
<g id="edge3652" class="edge">
<title>L12_S1_TP7_GPU15_expert0&#45;&gt;L12_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M116558.94,-604.36C116558.94,-550.04 116558.94,-450 116558.94,-450 116558.94,-450 112118.31,-450 112118.31,-450 112118.31,-450 112118.31,-467.43 112118.31,-467.43"/>
<polygon fill="black" stroke="black" points="112114.81,-467.43 112118.31,-477.43 112121.81,-467.43 112114.81,-467.43"/>
</g>
<!-- L12_S1_TP7_GPU15_expert0&#45;&gt;L12_S1_TP2_GPU10_moe_ar -->
<g id="edge3688" class="edge">
<title>L12_S1_TP7_GPU15_expert0&#45;&gt;L12_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M116550.89,-604.36C116550.89,-550.04 116550.89,-450 116550.89,-450 116550.89,-450 112853.38,-450 112853.38,-450 112853.38,-450 112853.38,-471.91 112853.38,-471.91"/>
<polygon fill="black" stroke="black" points="112849.88,-471.91 112853.38,-481.91 112856.88,-471.91 112849.88,-471.91"/>
</g>
<!-- L12_S1_TP7_GPU15_expert0&#45;&gt;L12_S1_TP3_GPU11_moe_ar -->
<g id="edge3724" class="edge">
<title>L12_S1_TP7_GPU15_expert0&#45;&gt;L12_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M116542.83,-604.36C116542.83,-550.04 116542.83,-450 116542.83,-450 116542.83,-450 113620.18,-450 113620.18,-450 113620.18,-450 113620.18,-483.79 113620.18,-483.79"/>
<polygon fill="black" stroke="black" points="113616.68,-483.79 113620.18,-493.79 113623.68,-483.79 113616.68,-483.79"/>
</g>
<!-- L12_S1_TP7_GPU15_expert0&#45;&gt;L12_S1_TP4_GPU12_moe_ar -->
<g id="edge3760" class="edge">
<title>L12_S1_TP7_GPU15_expert0&#45;&gt;L12_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M116534.78,-604.24C116534.78,-553.17 116534.78,-463 116534.78,-463 116534.78,-463 114153.97,-463 114153.97,-463 114153.97,-463 114153.97,-465.74 114153.97,-465.74"/>
<polygon fill="black" stroke="black" points="114150.47,-465.74 114153.97,-475.74 114157.47,-465.74 114150.47,-465.74"/>
</g>
<!-- L12_S1_TP7_GPU15_expert0&#45;&gt;L12_S1_TP5_GPU13_moe_ar -->
<g id="edge3796" class="edge">
<title>L12_S1_TP7_GPU15_expert0&#45;&gt;L12_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M116510.61,-604.33C116510.61,-592.43 116510.61,-582 116510.61,-582 116510.61,-582 114964.07,-582 114964.07,-582 114964.07,-582 114964.07,-562.65 114964.07,-562.65"/>
<polygon fill="black" stroke="black" points="114967.57,-562.65 114964.07,-552.65 114960.57,-562.65 114967.57,-562.65"/>
</g>
<!-- L12_S1_TP7_GPU15_expert0&#45;&gt;L12_S1_TP6_GPU14_moe_ar -->
<g id="edge3832" class="edge">
<title>L12_S1_TP7_GPU15_expert0&#45;&gt;L12_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M116518.67,-604.33C116518.67,-592.43 116518.67,-582 116518.67,-582 116518.67,-582 115691.72,-582 115691.72,-582 115691.72,-582 115691.72,-554.4 115691.72,-554.4"/>
<polygon fill="black" stroke="black" points="115695.22,-554.4 115691.72,-544.4 115688.22,-554.4 115695.22,-554.4"/>
</g>
<!-- L12_S1_TP7_GPU15_expert0&#45;&gt;L12_S1_TP7_GPU15_moe_ar -->
<g id="edge3868" class="edge">
<title>L12_S1_TP7_GPU15_expert0&#45;&gt;L12_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M116526.72,-604.13C116526.72,-580.74 116526.72,-554 116526.72,-554 116526.72,-554 116337.58,-554 116337.58,-554"/>
<polygon fill="black" stroke="black" points="116337.58,-550.5 116327.58,-554 116337.58,-557.5 116337.58,-550.5"/>
</g>
<!-- L12_S1_TP7_GPU15_expert1 -->
<g id="node1290" class="node">
<title>L12_S1_TP7_GPU15_expert1</title>
<polygon fill="none" stroke="black" points="117410.5,-672.5 116961.5,-672.5 116961.5,-604.5 117410.5,-604.5 117410.5,-672.5"/>
<text text-anchor="middle" x="117186" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="117186" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="117186" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="117186" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L12_S1_TP7_GPU15_expert1&#45;&gt;L12_S1_TP0_GPU8_moe_ar -->
<g id="edge3617" class="edge">
<title>L12_S1_TP7_GPU15_expert1&#45;&gt;L12_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M117333.81,-604.36C117333.81,-550.04 117333.81,-450 117333.81,-450 117333.81,-450 111466.49,-450 111466.49,-450 111466.49,-450 111466.49,-470.27 111466.49,-470.27"/>
<polygon fill="black" stroke="black" points="111462.99,-470.27 111466.49,-480.27 111469.99,-470.27 111462.99,-470.27"/>
</g>
<!-- L12_S1_TP7_GPU15_expert1&#45;&gt;L12_S1_TP1_GPU9_moe_ar -->
<g id="edge3653" class="edge">
<title>L12_S1_TP7_GPU15_expert1&#45;&gt;L12_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M117280.62,-604.36C117280.62,-550.04 117280.62,-450 117280.62,-450 117280.62,-450 111936.15,-450 111936.15,-450 111936.15,-450 111936.15,-462.28 111936.15,-462.28"/>
<polygon fill="black" stroke="black" points="111932.65,-462.28 111936.15,-472.28 111939.65,-462.28 111932.65,-462.28"/>
</g>
<!-- L12_S1_TP7_GPU15_expert1&#45;&gt;L12_S1_TP2_GPU10_moe_ar -->
<g id="edge3689" class="edge">
<title>L12_S1_TP7_GPU15_expert1&#45;&gt;L12_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M117227.44,-604.36C117227.44,-550.04 117227.44,-450 117227.44,-450 117227.44,-450 112808.69,-450 112808.69,-450 112808.69,-450 112808.69,-467.83 112808.69,-467.83"/>
<polygon fill="black" stroke="black" points="112805.19,-467.83 112808.69,-477.83 112812.19,-467.83 112805.19,-467.83"/>
</g>
<!-- L12_S1_TP7_GPU15_expert1&#45;&gt;L12_S1_TP3_GPU11_moe_ar -->
<g id="edge3725" class="edge">
<title>L12_S1_TP7_GPU15_expert1&#45;&gt;L12_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M117174.25,-604.36C117174.25,-550.04 117174.25,-450 117174.25,-450 117174.25,-450 113602.09,-450 113602.09,-450 113602.09,-450 113602.09,-480.14 113602.09,-480.14"/>
<polygon fill="black" stroke="black" points="113598.59,-480.14 113602.09,-490.14 113605.59,-480.14 113598.59,-480.14"/>
</g>
<!-- L12_S1_TP7_GPU15_expert1&#45;&gt;L12_S1_TP4_GPU12_moe_ar -->
<g id="edge3761" class="edge">
<title>L12_S1_TP7_GPU15_expert1&#45;&gt;L12_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M117111.17,-672.78C117111.17,-688.63 117111.17,-704 117111.17,-704 117111.17,-704 114150.5,-704 114150.5,-704 114150.5,-704 114150.5,-575.33 114150.5,-575.33"/>
<polygon fill="black" stroke="black" points="114154,-575.33 114150.5,-565.33 114147,-575.33 114154,-575.33"/>
</g>
<!-- L12_S1_TP7_GPU15_expert1&#45;&gt;L12_S1_TP5_GPU13_moe_ar -->
<g id="edge3797" class="edge">
<title>L12_S1_TP7_GPU15_expert1&#45;&gt;L12_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M117014.69,-604.33C117014.69,-592.43 117014.69,-582 117014.69,-582 117014.69,-582 115006.27,-582 115006.27,-582 115006.27,-582 115006.27,-554.05 115006.27,-554.05"/>
<polygon fill="black" stroke="black" points="115009.77,-554.05 115006.27,-544.05 115002.77,-554.05 115009.77,-554.05"/>
</g>
<!-- L12_S1_TP7_GPU15_expert1&#45;&gt;L12_S1_TP6_GPU14_moe_ar -->
<g id="edge3833" class="edge">
<title>L12_S1_TP7_GPU15_expert1&#45;&gt;L12_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M117067.88,-604.33C117067.88,-592.43 117067.88,-582 117067.88,-582 117067.88,-582 115713.59,-582 115713.59,-582 115713.59,-582 115713.59,-547.57 115713.59,-547.57"/>
<polygon fill="black" stroke="black" points="115717.09,-547.57 115713.59,-537.57 115710.09,-547.57 115717.09,-547.57"/>
</g>
<!-- L12_S1_TP7_GPU15_expert1&#45;&gt;L12_S1_TP7_GPU15_moe_ar -->
<g id="edge3869" class="edge">
<title>L12_S1_TP7_GPU15_expert1&#45;&gt;L12_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M117121.06,-604.4C117121.06,-576.28 117121.06,-541 117121.06,-541 117121.06,-541 116400.28,-541 116400.28,-541"/>
<polygon fill="black" stroke="black" points="116400.28,-537.5 116390.28,-541 116400.28,-544.5 116400.28,-537.5"/>
</g>
<!-- L12_S1_TP0_GPU8_norm -->
<g id="node1292" class="node">
<title>L12_S1_TP0_GPU8_norm</title>
<polygon fill="none" stroke="black" points="110283.5,-332.33 109834.5,-332.33 109834.5,-264.33 110283.5,-264.33 110283.5,-332.33"/>
<text text-anchor="middle" x="110059" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="110059" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="110059" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="110059" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP0_GPU8_moe_res&#45;&gt;L12_S1_TP0_GPU8_norm -->
<g id="edge3620" class="edge">
<title>L12_S1_TP0_GPU8_moe_res&#45;&gt;L12_S1_TP0_GPU8_norm</title>
<path fill="none" stroke="black" d="M110059,-368.28C110059,-368.28 110059,-342.46 110059,-342.46"/>
<polygon fill="black" stroke="black" points="110062.5,-342.46 110059,-332.46 110055.5,-342.46 110062.5,-342.46"/>
</g>
<!-- L12_S1_TP1_GPU9_qkv_linear -->
<g id="node1293" class="node">
<title>L12_S1_TP1_GPU9_qkv_linear</title>
<polygon fill="none" stroke="black" points="111404,-1614.75 110796,-1614.75 110796,-1546.75 111404,-1546.75 111404,-1614.75"/>
<text text-anchor="middle" x="111100" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="111100" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="111100" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="111100" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L12_S1_TP1_GPU9_qkv_slice -->
<g id="node1294" class="node">
<title>L12_S1_TP1_GPU9_qkv_slice</title>
<polygon fill="none" stroke="black" points="111398,-1496.67 110802,-1496.67 110802,-1428.67 111398,-1428.67 111398,-1496.67"/>
<text text-anchor="middle" x="111100" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="111100" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="111100" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="111100" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L12_S1_TP1_GPU9_qkv_linear&#45;&gt;L12_S1_TP1_GPU9_qkv_slice -->
<g id="edge3621" class="edge">
<title>L12_S1_TP1_GPU9_qkv_linear&#45;&gt;L12_S1_TP1_GPU9_qkv_slice</title>
<path fill="none" stroke="black" d="M111100,-1546.59C111100,-1546.59 111100,-1506.74 111100,-1506.74"/>
<polygon fill="black" stroke="black" points="111103.5,-1506.74 111100,-1496.74 111096.5,-1506.74 111103.5,-1506.74"/>
</g>
<!-- L12_S1_TP1_GPU9_qkv_slice&#45;&gt;L12_S1_TP1_GPU9_attn_v -->
<g id="edge3625" class="edge">
<title>L12_S1_TP1_GPU9_qkv_slice&#45;&gt;L12_S1_TP1_GPU9_attn_v</title>
<path fill="none" stroke="black" d="M110853.25,-1428.38C110853.25,-1428.38 110853.25,-1195 110853.25,-1195"/>
<polygon fill="black" stroke="black" points="110856.75,-1195 110853.25,-1185 110849.75,-1195 110856.75,-1195"/>
</g>
<!-- L12_S1_TP1_GPU9_qk_matmul -->
<g id="node1295" class="node">
<title>L12_S1_TP1_GPU9_qk_matmul</title>
<polygon fill="none" stroke="black" points="111815.5,-1392.67 110880.5,-1392.67 110880.5,-1324.67 111815.5,-1324.67 111815.5,-1392.67"/>
<text text-anchor="middle" x="111348" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="111348" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="111348" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="111348" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L12_S1_TP1_GPU9_qkv_slice&#45;&gt;L12_S1_TP1_GPU9_qk_matmul -->
<g id="edge3622" class="edge">
<title>L12_S1_TP1_GPU9_qkv_slice&#45;&gt;L12_S1_TP1_GPU9_qk_matmul</title>
<path fill="none" stroke="black" d="M111139.25,-1428.61C111139.25,-1428.61 111139.25,-1402.8 111139.25,-1402.8"/>
<polygon fill="black" stroke="black" points="111142.75,-1402.8 111139.25,-1392.8 111135.75,-1402.8 111142.75,-1402.8"/>
</g>
<!-- L12_S1_TP1_GPU9_softmax -->
<g id="node1296" class="node">
<title>L12_S1_TP1_GPU9_softmax</title>
<polygon fill="none" stroke="black" points="111577,-1288.67 111067,-1288.67 111067,-1220.67 111577,-1220.67 111577,-1288.67"/>
<text text-anchor="middle" x="111322" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="111322" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="111322" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="111322" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L12_S1_TP1_GPU9_qk_matmul&#45;&gt;L12_S1_TP1_GPU9_softmax -->
<g id="edge3623" class="edge">
<title>L12_S1_TP1_GPU9_qk_matmul&#45;&gt;L12_S1_TP1_GPU9_softmax</title>
<path fill="none" stroke="black" d="M111322,-1324.61C111322,-1324.61 111322,-1298.8 111322,-1298.8"/>
<polygon fill="black" stroke="black" points="111325.5,-1298.8 111322,-1288.8 111318.5,-1298.8 111325.5,-1298.8"/>
</g>
<!-- L12_S1_TP1_GPU9_softmax&#45;&gt;L12_S1_TP1_GPU9_attn_v -->
<g id="edge3624" class="edge">
<title>L12_S1_TP1_GPU9_softmax&#45;&gt;L12_S1_TP1_GPU9_attn_v</title>
<path fill="none" stroke="black" d="M111322,-1220.61C111322,-1220.61 111322,-1194.8 111322,-1194.8"/>
<polygon fill="black" stroke="black" points="111325.5,-1194.8 111322,-1184.8 111318.5,-1194.8 111325.5,-1194.8"/>
</g>
<!-- L12_S1_TP1_GPU9_mha_res -->
<g id="node1298" class="node">
<title>L12_S1_TP1_GPU9_mha_res</title>
<polygon fill="none" stroke="black" points="111432.5,-948.5 110545.5,-948.5 110545.5,-880.5 111432.5,-880.5 111432.5,-948.5"/>
<text text-anchor="middle" x="110989" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="110989" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="110989" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="110989" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP1_GPU9_mha_ar&#45;&gt;L12_S1_TP1_GPU9_mha_res -->
<g id="edge3634" class="edge">
<title>L12_S1_TP1_GPU9_mha_ar&#45;&gt;L12_S1_TP1_GPU9_mha_res</title>
<path fill="none" stroke="black" d="M111409.51,-1015.91C111409.51,-1015.91 111409.51,-958.58 111409.51,-958.58"/>
<polygon fill="black" stroke="black" points="111413.01,-958.58 111409.51,-948.58 111406.01,-958.58 111413.01,-958.58"/>
</g>
<!-- L12_S1_TP1_GPU9_gate -->
<g id="node1299" class="node">
<title>L12_S1_TP1_GPU9_gate</title>
<polygon fill="none" stroke="black" points="111518.56,-844.5 110676.15,-844.5 110459.44,-708.5 111301.85,-708.5 111518.56,-844.5"/>
<text text-anchor="middle" x="110989" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="110989" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="110989" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="110989" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L12_S1_TP1_GPU9_mha_res&#45;&gt;L12_S1_TP1_GPU9_gate -->
<g id="edge3635" class="edge">
<title>L12_S1_TP1_GPU9_mha_res&#45;&gt;L12_S1_TP1_GPU9_gate</title>
<path fill="none" stroke="black" d="M110989,-880.39C110989,-880.39 110989,-854.73 110989,-854.73"/>
<polygon fill="black" stroke="black" points="110992.5,-854.73 110989,-844.73 110985.5,-854.73 110992.5,-854.73"/>
</g>
<!-- L12_S1_TP1_GPU9_moe_res -->
<g id="node1301" class="node">
<title>L12_S1_TP1_GPU9_moe_res</title>
<polygon fill="none" stroke="black" points="111393,-436.33 110573,-436.33 110573,-368.33 111393,-368.33 111393,-436.33"/>
<text text-anchor="middle" x="110983" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="110983" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="110983" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="110983" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP1_GPU9_mha_res&#45;&gt;L12_S1_TP1_GPU9_moe_res -->
<g id="edge3655" class="edge">
<title>L12_S1_TP1_GPU9_mha_res&#45;&gt;L12_S1_TP1_GPU9_moe_res</title>
<path fill="none" stroke="black" d="M110545.2,-903C110490.33,-903 110453.07,-903 110453.07,-903 110453.07,-903 110453.07,-672 110453.07,-672 110453.07,-672 110881.5,-672 110881.5,-672 110881.5,-672 110881.5,-446.49 110881.5,-446.49"/>
<polygon fill="black" stroke="black" points="110885,-446.49 110881.5,-436.49 110878,-446.49 110885,-446.49"/>
</g>
<!-- L12_S1_TP1_GPU9_gate&#45;&gt;L12_S1_TP1_GPU9_expert0 -->
<g id="edge3636" class="edge">
<title>L12_S1_TP1_GPU9_gate&#45;&gt;L12_S1_TP1_GPU9_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M111115,-708.31C111115,-708.31 111115,-682.71 111115,-682.71"/>
<polygon fill="black" stroke="black" points="111118.5,-682.71 111115,-672.71 111111.5,-682.71 111118.5,-682.71"/>
</g>
<!-- L12_S1_TP1_GPU9_gate&#45;&gt;L12_S1_TP1_GPU9_expert1 -->
<g id="edge3637" class="edge">
<title>L12_S1_TP1_GPU9_gate&#45;&gt;L12_S1_TP1_GPU9_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M111438.14,-776.4C111438.14,-776.4 111438.14,-682.74 111438.14,-682.74"/>
<polygon fill="black" stroke="black" points="111441.64,-682.74 111438.14,-672.74 111434.64,-682.74 111441.64,-682.74"/>
</g>
<!-- L12_S1_TP1_GPU9_moe_ar&#45;&gt;L12_S1_TP1_GPU9_moe_res -->
<g id="edge3654" class="edge">
<title>L12_S1_TP1_GPU9_moe_ar&#45;&gt;L12_S1_TP1_GPU9_moe_res</title>
<path fill="none" stroke="black" d="M111692.77,-492.65C111692.77,-457.65 111692.77,-402 111692.77,-402 111692.77,-402 111403.05,-402 111403.05,-402"/>
<polygon fill="black" stroke="black" points="111403.05,-398.5 111393.05,-402 111403.05,-405.5 111403.05,-398.5"/>
</g>
<!-- L12_S1_TP1_GPU9_norm -->
<g id="node1302" class="node">
<title>L12_S1_TP1_GPU9_norm</title>
<polygon fill="none" stroke="black" points="111207.5,-332.33 110758.5,-332.33 110758.5,-264.33 111207.5,-264.33 111207.5,-332.33"/>
<text text-anchor="middle" x="110983" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="110983" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="110983" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="110983" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP1_GPU9_moe_res&#45;&gt;L12_S1_TP1_GPU9_norm -->
<g id="edge3656" class="edge">
<title>L12_S1_TP1_GPU9_moe_res&#45;&gt;L12_S1_TP1_GPU9_norm</title>
<path fill="none" stroke="black" d="M110983,-368.28C110983,-368.28 110983,-342.46 110983,-342.46"/>
<polygon fill="black" stroke="black" points="110986.5,-342.46 110983,-332.46 110979.5,-342.46 110986.5,-342.46"/>
</g>
<!-- L12_S1_TP2_GPU10_qkv_linear -->
<g id="node1303" class="node">
<title>L12_S1_TP2_GPU10_qkv_linear</title>
<polygon fill="none" stroke="black" points="112397,-1614.75 111789,-1614.75 111789,-1546.75 112397,-1546.75 112397,-1614.75"/>
<text text-anchor="middle" x="112093" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="112093" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="112093" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="112093" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L12_S1_TP2_GPU10_qkv_slice -->
<g id="node1304" class="node">
<title>L12_S1_TP2_GPU10_qkv_slice</title>
<polygon fill="none" stroke="black" points="112391,-1496.67 111795,-1496.67 111795,-1428.67 112391,-1428.67 112391,-1496.67"/>
<text text-anchor="middle" x="112093" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="112093" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="112093" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="112093" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L12_S1_TP2_GPU10_qkv_linear&#45;&gt;L12_S1_TP2_GPU10_qkv_slice -->
<g id="edge3657" class="edge">
<title>L12_S1_TP2_GPU10_qkv_linear&#45;&gt;L12_S1_TP2_GPU10_qkv_slice</title>
<path fill="none" stroke="black" d="M112093,-1546.59C112093,-1546.59 112093,-1506.74 112093,-1506.74"/>
<polygon fill="black" stroke="black" points="112096.5,-1506.74 112093,-1496.74 112089.5,-1506.74 112096.5,-1506.74"/>
</g>
<!-- L12_S1_TP2_GPU10_qkv_slice&#45;&gt;L12_S1_TP2_GPU10_attn_v -->
<g id="edge3661" class="edge">
<title>L12_S1_TP2_GPU10_qkv_slice&#45;&gt;L12_S1_TP2_GPU10_attn_v</title>
<path fill="none" stroke="black" d="M111844.5,-1428.38C111844.5,-1428.38 111844.5,-1195 111844.5,-1195"/>
<polygon fill="black" stroke="black" points="111848,-1195 111844.5,-1185 111841,-1195 111848,-1195"/>
</g>
<!-- L12_S1_TP2_GPU10_qk_matmul -->
<g id="node1305" class="node">
<title>L12_S1_TP2_GPU10_qk_matmul</title>
<polygon fill="none" stroke="black" points="112808.5,-1392.67 111873.5,-1392.67 111873.5,-1324.67 112808.5,-1324.67 112808.5,-1392.67"/>
<text text-anchor="middle" x="112341" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="112341" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="112341" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="112341" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L12_S1_TP2_GPU10_qkv_slice&#45;&gt;L12_S1_TP2_GPU10_qk_matmul -->
<g id="edge3658" class="edge">
<title>L12_S1_TP2_GPU10_qkv_slice&#45;&gt;L12_S1_TP2_GPU10_qk_matmul</title>
<path fill="none" stroke="black" d="M112132.25,-1428.61C112132.25,-1428.61 112132.25,-1402.8 112132.25,-1402.8"/>
<polygon fill="black" stroke="black" points="112135.75,-1402.8 112132.25,-1392.8 112128.75,-1402.8 112135.75,-1402.8"/>
</g>
<!-- L12_S1_TP2_GPU10_softmax -->
<g id="node1306" class="node">
<title>L12_S1_TP2_GPU10_softmax</title>
<polygon fill="none" stroke="black" points="112551,-1288.67 112041,-1288.67 112041,-1220.67 112551,-1220.67 112551,-1288.67"/>
<text text-anchor="middle" x="112296" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="112296" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="112296" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="112296" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L12_S1_TP2_GPU10_qk_matmul&#45;&gt;L12_S1_TP2_GPU10_softmax -->
<g id="edge3659" class="edge">
<title>L12_S1_TP2_GPU10_qk_matmul&#45;&gt;L12_S1_TP2_GPU10_softmax</title>
<path fill="none" stroke="black" d="M112296,-1324.61C112296,-1324.61 112296,-1298.8 112296,-1298.8"/>
<polygon fill="black" stroke="black" points="112299.5,-1298.8 112296,-1288.8 112292.5,-1298.8 112299.5,-1298.8"/>
</g>
<!-- L12_S1_TP2_GPU10_softmax&#45;&gt;L12_S1_TP2_GPU10_attn_v -->
<g id="edge3660" class="edge">
<title>L12_S1_TP2_GPU10_softmax&#45;&gt;L12_S1_TP2_GPU10_attn_v</title>
<path fill="none" stroke="black" d="M112296,-1220.61C112296,-1220.61 112296,-1194.8 112296,-1194.8"/>
<polygon fill="black" stroke="black" points="112299.5,-1194.8 112296,-1184.8 112292.5,-1194.8 112299.5,-1194.8"/>
</g>
<!-- L12_S1_TP2_GPU10_mha_res -->
<g id="node1308" class="node">
<title>L12_S1_TP2_GPU10_mha_res</title>
<polygon fill="none" stroke="black" points="112510.5,-948.5 111623.5,-948.5 111623.5,-880.5 112510.5,-880.5 112510.5,-948.5"/>
<text text-anchor="middle" x="112067" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="112067" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="112067" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="112067" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP2_GPU10_mha_ar&#45;&gt;L12_S1_TP2_GPU10_mha_res -->
<g id="edge3670" class="edge">
<title>L12_S1_TP2_GPU10_mha_ar&#45;&gt;L12_S1_TP2_GPU10_mha_res</title>
<path fill="none" stroke="black" d="M112333.01,-991.61C112333.01,-991.61 112333.01,-958.74 112333.01,-958.74"/>
<polygon fill="black" stroke="black" points="112336.51,-958.74 112333.01,-948.74 112329.51,-958.74 112336.51,-958.74"/>
</g>
<!-- L12_S1_TP2_GPU10_gate -->
<g id="node1309" class="node">
<title>L12_S1_TP2_GPU10_gate</title>
<polygon fill="none" stroke="black" points="112596.56,-844.5 111754.15,-844.5 111537.44,-708.5 112379.85,-708.5 112596.56,-844.5"/>
<text text-anchor="middle" x="112067" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="112067" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="112067" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="112067" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L12_S1_TP2_GPU10_mha_res&#45;&gt;L12_S1_TP2_GPU10_gate -->
<g id="edge3671" class="edge">
<title>L12_S1_TP2_GPU10_mha_res&#45;&gt;L12_S1_TP2_GPU10_gate</title>
<path fill="none" stroke="black" d="M112067,-880.39C112067,-880.39 112067,-854.73 112067,-854.73"/>
<polygon fill="black" stroke="black" points="112070.5,-854.73 112067,-844.73 112063.5,-854.73 112070.5,-854.73"/>
</g>
<!-- L12_S1_TP2_GPU10_moe_res -->
<g id="node1311" class="node">
<title>L12_S1_TP2_GPU10_moe_res</title>
<polygon fill="none" stroke="black" points="112574,-436.33 111754,-436.33 111754,-368.33 112574,-368.33 112574,-436.33"/>
<text text-anchor="middle" x="112164" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="112164" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="112164" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="112164" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP2_GPU10_mha_res&#45;&gt;L12_S1_TP2_GPU10_moe_res -->
<g id="edge3691" class="edge">
<title>L12_S1_TP2_GPU10_mha_res&#45;&gt;L12_S1_TP2_GPU10_moe_res</title>
<path fill="none" stroke="black" d="M112510.57,-914C112567.27,-914 112606,-914 112606,-914 112606,-914 112606,-677 112606,-677 112606,-677 112284.75,-677 112284.75,-677 112284.75,-677 112284.75,-583 112284.75,-583 112284.75,-583 112312.51,-583 112312.51,-583 112312.51,-583 112312.51,-446.74 112312.51,-446.74"/>
<polygon fill="black" stroke="black" points="112316.01,-446.74 112312.51,-436.74 112309.01,-446.74 112316.01,-446.74"/>
</g>
<!-- L12_S1_TP2_GPU10_gate&#45;&gt;L12_S1_TP2_GPU10_expert0 -->
<g id="edge3672" class="edge">
<title>L12_S1_TP2_GPU10_gate&#45;&gt;L12_S1_TP2_GPU10_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M111936.75,-708.31C111936.75,-708.31 111936.75,-682.71 111936.75,-682.71"/>
<polygon fill="black" stroke="black" points="111940.25,-682.71 111936.75,-672.71 111933.25,-682.71 111940.25,-682.71"/>
</g>
<!-- L12_S1_TP2_GPU10_gate&#45;&gt;L12_S1_TP2_GPU10_expert1 -->
<g id="edge3673" class="edge">
<title>L12_S1_TP2_GPU10_gate&#45;&gt;L12_S1_TP2_GPU10_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M112444.14,-748.57C112444.14,-748.57 112444.14,-682.74 112444.14,-682.74"/>
<polygon fill="black" stroke="black" points="112447.64,-682.74 112444.14,-672.74 112440.64,-682.74 112447.64,-682.74"/>
</g>
<!-- L12_S1_TP2_GPU10_moe_ar&#45;&gt;L12_S1_TP2_GPU10_moe_res -->
<g id="edge3690" class="edge">
<title>L12_S1_TP2_GPU10_moe_ar&#45;&gt;L12_S1_TP2_GPU10_moe_res</title>
<path fill="none" stroke="black" d="M112488.85,-478.45C112488.85,-478.45 112488.85,-446.39 112488.85,-446.39"/>
<polygon fill="black" stroke="black" points="112492.35,-446.39 112488.85,-436.39 112485.35,-446.39 112492.35,-446.39"/>
</g>
<!-- L12_S1_TP2_GPU10_norm -->
<g id="node1312" class="node">
<title>L12_S1_TP2_GPU10_norm</title>
<polygon fill="none" stroke="black" points="112388.5,-332.33 111939.5,-332.33 111939.5,-264.33 112388.5,-264.33 112388.5,-332.33"/>
<text text-anchor="middle" x="112164" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="112164" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="112164" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="112164" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP2_GPU10_moe_res&#45;&gt;L12_S1_TP2_GPU10_norm -->
<g id="edge3692" class="edge">
<title>L12_S1_TP2_GPU10_moe_res&#45;&gt;L12_S1_TP2_GPU10_norm</title>
<path fill="none" stroke="black" d="M112164,-368.28C112164,-368.28 112164,-342.46 112164,-342.46"/>
<polygon fill="black" stroke="black" points="112167.5,-342.46 112164,-332.46 112160.5,-342.46 112167.5,-342.46"/>
</g>
<!-- L12_S1_TP3_GPU11_qkv_linear -->
<g id="node1313" class="node">
<title>L12_S1_TP3_GPU11_qkv_linear</title>
<polygon fill="none" stroke="black" points="113397,-1614.75 112789,-1614.75 112789,-1546.75 113397,-1546.75 113397,-1614.75"/>
<text text-anchor="middle" x="113093" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="113093" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="113093" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="113093" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L12_S1_TP3_GPU11_qkv_slice -->
<g id="node1314" class="node">
<title>L12_S1_TP3_GPU11_qkv_slice</title>
<polygon fill="none" stroke="black" points="113391,-1496.67 112795,-1496.67 112795,-1428.67 113391,-1428.67 113391,-1496.67"/>
<text text-anchor="middle" x="113093" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="113093" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="113093" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="113093" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L12_S1_TP3_GPU11_qkv_linear&#45;&gt;L12_S1_TP3_GPU11_qkv_slice -->
<g id="edge3693" class="edge">
<title>L12_S1_TP3_GPU11_qkv_linear&#45;&gt;L12_S1_TP3_GPU11_qkv_slice</title>
<path fill="none" stroke="black" d="M113093,-1546.59C113093,-1546.59 113093,-1506.74 113093,-1506.74"/>
<polygon fill="black" stroke="black" points="113096.5,-1506.74 113093,-1496.74 113089.5,-1506.74 113096.5,-1506.74"/>
</g>
<!-- L12_S1_TP3_GPU11_qkv_slice&#45;&gt;L12_S1_TP3_GPU11_attn_v -->
<g id="edge3697" class="edge">
<title>L12_S1_TP3_GPU11_qkv_slice&#45;&gt;L12_S1_TP3_GPU11_attn_v</title>
<path fill="none" stroke="black" d="M112841,-1428.38C112841,-1428.38 112841,-1195 112841,-1195"/>
<polygon fill="black" stroke="black" points="112844.5,-1195 112841,-1185 112837.5,-1195 112844.5,-1195"/>
</g>
<!-- L12_S1_TP3_GPU11_qk_matmul -->
<g id="node1315" class="node">
<title>L12_S1_TP3_GPU11_qk_matmul</title>
<polygon fill="none" stroke="black" points="113808.5,-1392.67 112873.5,-1392.67 112873.5,-1324.67 113808.5,-1324.67 113808.5,-1392.67"/>
<text text-anchor="middle" x="113341" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="113341" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="113341" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="113341" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L12_S1_TP3_GPU11_qkv_slice&#45;&gt;L12_S1_TP3_GPU11_qk_matmul -->
<g id="edge3694" class="edge">
<title>L12_S1_TP3_GPU11_qkv_slice&#45;&gt;L12_S1_TP3_GPU11_qk_matmul</title>
<path fill="none" stroke="black" d="M113132.25,-1428.61C113132.25,-1428.61 113132.25,-1402.8 113132.25,-1402.8"/>
<polygon fill="black" stroke="black" points="113135.75,-1402.8 113132.25,-1392.8 113128.75,-1402.8 113135.75,-1402.8"/>
</g>
<!-- L12_S1_TP3_GPU11_softmax -->
<g id="node1316" class="node">
<title>L12_S1_TP3_GPU11_softmax</title>
<polygon fill="none" stroke="black" points="113529,-1288.67 113019,-1288.67 113019,-1220.67 113529,-1220.67 113529,-1288.67"/>
<text text-anchor="middle" x="113274" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="113274" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="113274" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="113274" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L12_S1_TP3_GPU11_qk_matmul&#45;&gt;L12_S1_TP3_GPU11_softmax -->
<g id="edge3695" class="edge">
<title>L12_S1_TP3_GPU11_qk_matmul&#45;&gt;L12_S1_TP3_GPU11_softmax</title>
<path fill="none" stroke="black" d="M113274,-1324.61C113274,-1324.61 113274,-1298.8 113274,-1298.8"/>
<polygon fill="black" stroke="black" points="113277.5,-1298.8 113274,-1288.8 113270.5,-1298.8 113277.5,-1298.8"/>
</g>
<!-- L12_S1_TP3_GPU11_softmax&#45;&gt;L12_S1_TP3_GPU11_attn_v -->
<g id="edge3696" class="edge">
<title>L12_S1_TP3_GPU11_softmax&#45;&gt;L12_S1_TP3_GPU11_attn_v</title>
<path fill="none" stroke="black" d="M113274,-1220.61C113274,-1220.61 113274,-1194.8 113274,-1194.8"/>
<polygon fill="black" stroke="black" points="113277.5,-1194.8 113274,-1184.8 113270.5,-1194.8 113277.5,-1194.8"/>
</g>
<!-- L12_S1_TP3_GPU11_mha_res -->
<g id="node1318" class="node">
<title>L12_S1_TP3_GPU11_mha_res</title>
<polygon fill="none" stroke="black" points="113588.5,-948.5 112701.5,-948.5 112701.5,-880.5 113588.5,-880.5 113588.5,-948.5"/>
<text text-anchor="middle" x="113145" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="113145" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="113145" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="113145" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP3_GPU11_mha_ar&#45;&gt;L12_S1_TP3_GPU11_mha_res -->
<g id="edge3706" class="edge">
<title>L12_S1_TP3_GPU11_mha_ar&#45;&gt;L12_S1_TP3_GPU11_mha_res</title>
<path fill="none" stroke="black" d="M113256.51,-984.55C113256.51,-984.55 113256.51,-958.73 113256.51,-958.73"/>
<polygon fill="black" stroke="black" points="113260.01,-958.73 113256.51,-948.73 113253.01,-958.73 113260.01,-958.73"/>
</g>
<!-- L12_S1_TP3_GPU11_gate -->
<g id="node1319" class="node">
<title>L12_S1_TP3_GPU11_gate</title>
<polygon fill="none" stroke="black" points="113674.56,-844.5 112832.15,-844.5 112615.44,-708.5 113457.85,-708.5 113674.56,-844.5"/>
<text text-anchor="middle" x="113145" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="113145" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="113145" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="113145" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L12_S1_TP3_GPU11_mha_res&#45;&gt;L12_S1_TP3_GPU11_gate -->
<g id="edge3707" class="edge">
<title>L12_S1_TP3_GPU11_mha_res&#45;&gt;L12_S1_TP3_GPU11_gate</title>
<path fill="none" stroke="black" d="M113145,-880.39C113145,-880.39 113145,-854.73 113145,-854.73"/>
<polygon fill="black" stroke="black" points="113148.5,-854.73 113145,-844.73 113141.5,-854.73 113148.5,-854.73"/>
</g>
<!-- L12_S1_TP3_GPU11_moe_res -->
<g id="node1321" class="node">
<title>L12_S1_TP3_GPU11_moe_res</title>
<polygon fill="none" stroke="black" points="113584,-436.33 112764,-436.33 112764,-368.33 113584,-368.33 113584,-436.33"/>
<text text-anchor="middle" x="113174" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="113174" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="113174" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="113174" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP3_GPU11_mha_res&#45;&gt;L12_S1_TP3_GPU11_moe_res -->
<g id="edge3727" class="edge">
<title>L12_S1_TP3_GPU11_mha_res&#45;&gt;L12_S1_TP3_GPU11_moe_res</title>
<path fill="none" stroke="black" d="M113588.55,-903C113647.35,-903 113687.79,-903 113687.79,-903 113687.79,-903 113687.79,-390 113687.79,-390 113687.79,-390 113594.12,-390 113594.12,-390"/>
<polygon fill="black" stroke="black" points="113594.12,-386.5 113584.12,-390 113594.12,-393.5 113594.12,-386.5"/>
</g>
<!-- L12_S1_TP3_GPU11_gate&#45;&gt;L12_S1_TP3_GPU11_expert0 -->
<g id="edge3708" class="edge">
<title>L12_S1_TP3_GPU11_gate&#45;&gt;L12_S1_TP3_GPU11_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M112908.17,-708.31C112908.17,-708.31 112908.17,-682.71 112908.17,-682.71"/>
<polygon fill="black" stroke="black" points="112911.67,-682.71 112908.17,-672.71 112904.67,-682.71 112911.67,-682.71"/>
</g>
<!-- L12_S1_TP3_GPU11_gate&#45;&gt;L12_S1_TP3_GPU11_expert1 -->
<g id="edge3709" class="edge">
<title>L12_S1_TP3_GPU11_gate&#45;&gt;L12_S1_TP3_GPU11_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M113337.75,-708.31C113337.75,-708.31 113337.75,-682.71 113337.75,-682.71"/>
<polygon fill="black" stroke="black" points="113341.25,-682.71 113337.75,-672.71 113334.25,-682.71 113341.25,-682.71"/>
</g>
<!-- L12_S1_TP3_GPU11_moe_ar&#45;&gt;L12_S1_TP3_GPU11_moe_res -->
<g id="edge3726" class="edge">
<title>L12_S1_TP3_GPU11_moe_ar&#45;&gt;L12_S1_TP3_GPU11_moe_res</title>
<path fill="none" stroke="black" d="M113391.18,-472.73C113391.18,-472.73 113391.18,-446.41 113391.18,-446.41"/>
<polygon fill="black" stroke="black" points="113394.68,-446.41 113391.18,-436.41 113387.68,-446.41 113394.68,-446.41"/>
</g>
<!-- L12_S1_TP3_GPU11_norm -->
<g id="node1322" class="node">
<title>L12_S1_TP3_GPU11_norm</title>
<polygon fill="none" stroke="black" points="113398.5,-332.33 112949.5,-332.33 112949.5,-264.33 113398.5,-264.33 113398.5,-332.33"/>
<text text-anchor="middle" x="113174" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="113174" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="113174" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="113174" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP3_GPU11_moe_res&#45;&gt;L12_S1_TP3_GPU11_norm -->
<g id="edge3728" class="edge">
<title>L12_S1_TP3_GPU11_moe_res&#45;&gt;L12_S1_TP3_GPU11_norm</title>
<path fill="none" stroke="black" d="M113174,-368.28C113174,-368.28 113174,-342.46 113174,-342.46"/>
<polygon fill="black" stroke="black" points="113177.5,-342.46 113174,-332.46 113170.5,-342.46 113177.5,-342.46"/>
</g>
<!-- L12_S1_TP4_GPU12_qkv_linear -->
<g id="node1323" class="node">
<title>L12_S1_TP4_GPU12_qkv_linear</title>
<polygon fill="none" stroke="black" points="114393,-1614.75 113785,-1614.75 113785,-1546.75 114393,-1546.75 114393,-1614.75"/>
<text text-anchor="middle" x="114089" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="114089" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="114089" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="114089" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L12_S1_TP4_GPU12_qkv_slice -->
<g id="node1324" class="node">
<title>L12_S1_TP4_GPU12_qkv_slice</title>
<polygon fill="none" stroke="black" points="114387,-1496.67 113791,-1496.67 113791,-1428.67 114387,-1428.67 114387,-1496.67"/>
<text text-anchor="middle" x="114089" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="114089" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="114089" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="114089" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L12_S1_TP4_GPU12_qkv_linear&#45;&gt;L12_S1_TP4_GPU12_qkv_slice -->
<g id="edge3729" class="edge">
<title>L12_S1_TP4_GPU12_qkv_linear&#45;&gt;L12_S1_TP4_GPU12_qkv_slice</title>
<path fill="none" stroke="black" d="M114089,-1546.59C114089,-1546.59 114089,-1506.74 114089,-1506.74"/>
<polygon fill="black" stroke="black" points="114092.5,-1506.74 114089,-1496.74 114085.5,-1506.74 114092.5,-1506.74"/>
</g>
<!-- L12_S1_TP4_GPU12_qkv_slice&#45;&gt;L12_S1_TP4_GPU12_attn_v -->
<g id="edge3733" class="edge">
<title>L12_S1_TP4_GPU12_qkv_slice&#45;&gt;L12_S1_TP4_GPU12_attn_v</title>
<path fill="none" stroke="black" d="M113839,-1428.38C113839,-1428.38 113839,-1195 113839,-1195"/>
<polygon fill="black" stroke="black" points="113842.5,-1195 113839,-1185 113835.5,-1195 113842.5,-1195"/>
</g>
<!-- L12_S1_TP4_GPU12_qk_matmul -->
<g id="node1325" class="node">
<title>L12_S1_TP4_GPU12_qk_matmul</title>
<polygon fill="none" stroke="black" points="114804.5,-1392.67 113869.5,-1392.67 113869.5,-1324.67 114804.5,-1324.67 114804.5,-1392.67"/>
<text text-anchor="middle" x="114337" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="114337" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="114337" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="114337" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L12_S1_TP4_GPU12_qkv_slice&#45;&gt;L12_S1_TP4_GPU12_qk_matmul -->
<g id="edge3730" class="edge">
<title>L12_S1_TP4_GPU12_qkv_slice&#45;&gt;L12_S1_TP4_GPU12_qk_matmul</title>
<path fill="none" stroke="black" d="M114128.25,-1428.61C114128.25,-1428.61 114128.25,-1402.8 114128.25,-1402.8"/>
<polygon fill="black" stroke="black" points="114131.75,-1402.8 114128.25,-1392.8 114124.75,-1402.8 114131.75,-1402.8"/>
</g>
<!-- L12_S1_TP4_GPU12_softmax -->
<g id="node1326" class="node">
<title>L12_S1_TP4_GPU12_softmax</title>
<polygon fill="none" stroke="black" points="114505,-1288.67 113995,-1288.67 113995,-1220.67 114505,-1220.67 114505,-1288.67"/>
<text text-anchor="middle" x="114250" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="114250" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="114250" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="114250" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L12_S1_TP4_GPU12_qk_matmul&#45;&gt;L12_S1_TP4_GPU12_softmax -->
<g id="edge3731" class="edge">
<title>L12_S1_TP4_GPU12_qk_matmul&#45;&gt;L12_S1_TP4_GPU12_softmax</title>
<path fill="none" stroke="black" d="M114250,-1324.61C114250,-1324.61 114250,-1298.8 114250,-1298.8"/>
<polygon fill="black" stroke="black" points="114253.5,-1298.8 114250,-1288.8 114246.5,-1298.8 114253.5,-1298.8"/>
</g>
<!-- L12_S1_TP4_GPU12_softmax&#45;&gt;L12_S1_TP4_GPU12_attn_v -->
<g id="edge3732" class="edge">
<title>L12_S1_TP4_GPU12_softmax&#45;&gt;L12_S1_TP4_GPU12_attn_v</title>
<path fill="none" stroke="black" d="M114250,-1220.61C114250,-1220.61 114250,-1194.8 114250,-1194.8"/>
<polygon fill="black" stroke="black" points="114253.5,-1194.8 114250,-1184.8 114246.5,-1194.8 114253.5,-1194.8"/>
</g>
<!-- L12_S1_TP4_GPU12_mha_res -->
<g id="node1328" class="node">
<title>L12_S1_TP4_GPU12_mha_res</title>
<polygon fill="none" stroke="black" points="114666.5,-948.5 113779.5,-948.5 113779.5,-880.5 114666.5,-880.5 114666.5,-948.5"/>
<text text-anchor="middle" x="114223" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="114223" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="114223" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="114223" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP4_GPU12_mha_ar&#45;&gt;L12_S1_TP4_GPU12_mha_res -->
<g id="edge3742" class="edge">
<title>L12_S1_TP4_GPU12_mha_ar&#45;&gt;L12_S1_TP4_GPU12_mha_res</title>
<path fill="none" stroke="black" d="M114111.99,-984.55C114111.99,-984.55 114111.99,-958.73 114111.99,-958.73"/>
<polygon fill="black" stroke="black" points="114115.49,-958.73 114111.99,-948.73 114108.49,-958.73 114115.49,-958.73"/>
</g>
<!-- L12_S1_TP4_GPU12_gate -->
<g id="node1329" class="node">
<title>L12_S1_TP4_GPU12_gate</title>
<polygon fill="none" stroke="black" points="114752.56,-844.5 113910.15,-844.5 113693.44,-708.5 114535.85,-708.5 114752.56,-844.5"/>
<text text-anchor="middle" x="114223" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="114223" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="114223" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="114223" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L12_S1_TP4_GPU12_mha_res&#45;&gt;L12_S1_TP4_GPU12_gate -->
<g id="edge3743" class="edge">
<title>L12_S1_TP4_GPU12_mha_res&#45;&gt;L12_S1_TP4_GPU12_gate</title>
<path fill="none" stroke="black" d="M114223,-880.39C114223,-880.39 114223,-854.73 114223,-854.73"/>
<polygon fill="black" stroke="black" points="114226.5,-854.73 114223,-844.73 114219.5,-854.73 114226.5,-854.73"/>
</g>
<!-- L12_S1_TP4_GPU12_moe_res -->
<g id="node1331" class="node">
<title>L12_S1_TP4_GPU12_moe_res</title>
<polygon fill="none" stroke="black" points="114559,-436.33 113739,-436.33 113739,-368.33 114559,-368.33 114559,-436.33"/>
<text text-anchor="middle" x="114149" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="114149" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="114149" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="114149" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP4_GPU12_mha_res&#45;&gt;L12_S1_TP4_GPU12_moe_res -->
<g id="edge3763" class="edge">
<title>L12_S1_TP4_GPU12_mha_res&#45;&gt;L12_S1_TP4_GPU12_moe_res</title>
<path fill="none" stroke="black" d="M113779.33,-925C113726.1,-925 113690.14,-925 113690.14,-925 113690.14,-925 113690.14,-413 113690.14,-413 113690.14,-413 113728.81,-413 113728.81,-413"/>
<polygon fill="black" stroke="black" points="113728.81,-416.5 113738.81,-413 113728.81,-409.5 113728.81,-416.5"/>
</g>
<!-- L12_S1_TP4_GPU12_gate&#45;&gt;L12_S1_TP4_GPU12_expert0 -->
<g id="edge3744" class="edge">
<title>L12_S1_TP4_GPU12_gate&#45;&gt;L12_S1_TP4_GPU12_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M114029.43,-708.31C114029.43,-708.31 114029.43,-682.71 114029.43,-682.71"/>
<polygon fill="black" stroke="black" points="114032.93,-682.71 114029.43,-672.71 114025.93,-682.71 114032.93,-682.71"/>
</g>
<!-- L12_S1_TP4_GPU12_gate&#45;&gt;L12_S1_TP4_GPU12_expert1 -->
<g id="edge3745" class="edge">
<title>L12_S1_TP4_GPU12_gate&#45;&gt;L12_S1_TP4_GPU12_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M114458.83,-708.31C114458.83,-708.31 114458.83,-682.71 114458.83,-682.71"/>
<polygon fill="black" stroke="black" points="114462.33,-682.71 114458.83,-672.71 114455.33,-682.71 114462.33,-682.71"/>
</g>
<!-- L12_S1_TP4_GPU12_moe_ar&#45;&gt;L12_S1_TP4_GPU12_moe_res -->
<g id="edge3762" class="edge">
<title>L12_S1_TP4_GPU12_moe_ar&#45;&gt;L12_S1_TP4_GPU12_moe_res</title>
<path fill="none" stroke="black" d="M113946.49,-473.75C113946.49,-473.75 113946.49,-446.65 113946.49,-446.65"/>
<polygon fill="black" stroke="black" points="113949.99,-446.65 113946.49,-436.65 113942.99,-446.65 113949.99,-446.65"/>
</g>
<!-- L12_S1_TP4_GPU12_norm -->
<g id="node1332" class="node">
<title>L12_S1_TP4_GPU12_norm</title>
<polygon fill="none" stroke="black" points="114373.5,-332.33 113924.5,-332.33 113924.5,-264.33 114373.5,-264.33 114373.5,-332.33"/>
<text text-anchor="middle" x="114149" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="114149" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="114149" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="114149" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP4_GPU12_moe_res&#45;&gt;L12_S1_TP4_GPU12_norm -->
<g id="edge3764" class="edge">
<title>L12_S1_TP4_GPU12_moe_res&#45;&gt;L12_S1_TP4_GPU12_norm</title>
<path fill="none" stroke="black" d="M114149,-368.28C114149,-368.28 114149,-342.46 114149,-342.46"/>
<polygon fill="black" stroke="black" points="114152.5,-342.46 114149,-332.46 114145.5,-342.46 114152.5,-342.46"/>
</g>
<!-- L12_S1_TP5_GPU13_qkv_linear -->
<g id="node1333" class="node">
<title>L12_S1_TP5_GPU13_qkv_linear</title>
<polygon fill="none" stroke="black" points="115387,-1614.75 114779,-1614.75 114779,-1546.75 115387,-1546.75 115387,-1614.75"/>
<text text-anchor="middle" x="115083" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="115083" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="115083" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="115083" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L12_S1_TP5_GPU13_qkv_slice -->
<g id="node1334" class="node">
<title>L12_S1_TP5_GPU13_qkv_slice</title>
<polygon fill="none" stroke="black" points="115381,-1496.67 114785,-1496.67 114785,-1428.67 115381,-1428.67 115381,-1496.67"/>
<text text-anchor="middle" x="115083" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="115083" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="115083" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="115083" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L12_S1_TP5_GPU13_qkv_linear&#45;&gt;L12_S1_TP5_GPU13_qkv_slice -->
<g id="edge3765" class="edge">
<title>L12_S1_TP5_GPU13_qkv_linear&#45;&gt;L12_S1_TP5_GPU13_qkv_slice</title>
<path fill="none" stroke="black" d="M115083,-1546.59C115083,-1546.59 115083,-1506.74 115083,-1506.74"/>
<polygon fill="black" stroke="black" points="115086.5,-1506.74 115083,-1496.74 115079.5,-1506.74 115086.5,-1506.74"/>
</g>
<!-- L12_S1_TP5_GPU13_qkv_slice&#45;&gt;L12_S1_TP5_GPU13_attn_v -->
<g id="edge3769" class="edge">
<title>L12_S1_TP5_GPU13_qkv_slice&#45;&gt;L12_S1_TP5_GPU13_attn_v</title>
<path fill="none" stroke="black" d="M114834,-1428.38C114834,-1428.38 114834,-1195 114834,-1195"/>
<polygon fill="black" stroke="black" points="114837.5,-1195 114834,-1185 114830.5,-1195 114837.5,-1195"/>
</g>
<!-- L12_S1_TP5_GPU13_qk_matmul -->
<g id="node1335" class="node">
<title>L12_S1_TP5_GPU13_qk_matmul</title>
<polygon fill="none" stroke="black" points="115798.5,-1392.67 114863.5,-1392.67 114863.5,-1324.67 115798.5,-1324.67 115798.5,-1392.67"/>
<text text-anchor="middle" x="115331" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="115331" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="115331" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="115331" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L12_S1_TP5_GPU13_qkv_slice&#45;&gt;L12_S1_TP5_GPU13_qk_matmul -->
<g id="edge3766" class="edge">
<title>L12_S1_TP5_GPU13_qkv_slice&#45;&gt;L12_S1_TP5_GPU13_qk_matmul</title>
<path fill="none" stroke="black" d="M115122.25,-1428.61C115122.25,-1428.61 115122.25,-1402.8 115122.25,-1402.8"/>
<polygon fill="black" stroke="black" points="115125.75,-1402.8 115122.25,-1392.8 115118.75,-1402.8 115125.75,-1402.8"/>
</g>
<!-- L12_S1_TP5_GPU13_softmax -->
<g id="node1336" class="node">
<title>L12_S1_TP5_GPU13_softmax</title>
<polygon fill="none" stroke="black" points="115480,-1288.67 114970,-1288.67 114970,-1220.67 115480,-1220.67 115480,-1288.67"/>
<text text-anchor="middle" x="115225" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="115225" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="115225" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="115225" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L12_S1_TP5_GPU13_qk_matmul&#45;&gt;L12_S1_TP5_GPU13_softmax -->
<g id="edge3767" class="edge">
<title>L12_S1_TP5_GPU13_qk_matmul&#45;&gt;L12_S1_TP5_GPU13_softmax</title>
<path fill="none" stroke="black" d="M115225,-1324.61C115225,-1324.61 115225,-1298.8 115225,-1298.8"/>
<polygon fill="black" stroke="black" points="115228.5,-1298.8 115225,-1288.8 115221.5,-1298.8 115228.5,-1298.8"/>
</g>
<!-- L12_S1_TP5_GPU13_softmax&#45;&gt;L12_S1_TP5_GPU13_attn_v -->
<g id="edge3768" class="edge">
<title>L12_S1_TP5_GPU13_softmax&#45;&gt;L12_S1_TP5_GPU13_attn_v</title>
<path fill="none" stroke="black" d="M115225,-1220.61C115225,-1220.61 115225,-1194.8 115225,-1194.8"/>
<polygon fill="black" stroke="black" points="115228.5,-1194.8 115225,-1184.8 115221.5,-1194.8 115228.5,-1194.8"/>
</g>
<!-- L12_S1_TP5_GPU13_mha_res -->
<g id="node1338" class="node">
<title>L12_S1_TP5_GPU13_mha_res</title>
<polygon fill="none" stroke="black" points="115744.5,-948.5 114857.5,-948.5 114857.5,-880.5 115744.5,-880.5 115744.5,-948.5"/>
<text text-anchor="middle" x="115301" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="115301" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="115301" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="115301" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP5_GPU13_mha_ar&#45;&gt;L12_S1_TP5_GPU13_mha_res -->
<g id="edge3778" class="edge">
<title>L12_S1_TP5_GPU13_mha_ar&#45;&gt;L12_S1_TP5_GPU13_mha_res</title>
<path fill="none" stroke="black" d="M115035.49,-991.61C115035.49,-991.61 115035.49,-958.74 115035.49,-958.74"/>
<polygon fill="black" stroke="black" points="115038.99,-958.74 115035.49,-948.74 115031.99,-958.74 115038.99,-958.74"/>
</g>
<!-- L12_S1_TP5_GPU13_gate -->
<g id="node1339" class="node">
<title>L12_S1_TP5_GPU13_gate</title>
<polygon fill="none" stroke="black" points="115830.56,-844.5 114988.15,-844.5 114771.44,-708.5 115613.85,-708.5 115830.56,-844.5"/>
<text text-anchor="middle" x="115301" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="115301" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="115301" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="115301" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L12_S1_TP5_GPU13_mha_res&#45;&gt;L12_S1_TP5_GPU13_gate -->
<g id="edge3779" class="edge">
<title>L12_S1_TP5_GPU13_mha_res&#45;&gt;L12_S1_TP5_GPU13_gate</title>
<path fill="none" stroke="black" d="M115301,-880.39C115301,-880.39 115301,-854.73 115301,-854.73"/>
<polygon fill="black" stroke="black" points="115304.5,-854.73 115301,-844.73 115297.5,-854.73 115304.5,-854.73"/>
</g>
<!-- L12_S1_TP5_GPU13_moe_res -->
<g id="node1341" class="node">
<title>L12_S1_TP5_GPU13_moe_res</title>
<polygon fill="none" stroke="black" points="116165,-436.33 115345,-436.33 115345,-368.33 116165,-368.33 116165,-436.33"/>
<text text-anchor="middle" x="115755" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="115755" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="115755" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="115755" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP5_GPU13_mha_res&#45;&gt;L12_S1_TP5_GPU13_moe_res -->
<g id="edge3799" class="edge">
<title>L12_S1_TP5_GPU13_mha_res&#45;&gt;L12_S1_TP5_GPU13_moe_res</title>
<path fill="none" stroke="black" d="M115744.57,-914C115801.27,-914 115840,-914 115840,-914 115840,-914 115840,-692 115840,-692 115840,-692 116013.1,-692 116013.1,-692 116013.1,-692 116013.1,-583 116013.1,-583 116013.1,-583 115749.02,-583 115749.02,-583 115749.02,-583 115749.02,-446.74 115749.02,-446.74"/>
<polygon fill="black" stroke="black" points="115752.52,-446.74 115749.02,-436.74 115745.52,-446.74 115752.52,-446.74"/>
</g>
<!-- L12_S1_TP5_GPU13_gate&#45;&gt;L12_S1_TP5_GPU13_expert0 -->
<g id="edge3780" class="edge">
<title>L12_S1_TP5_GPU13_gate&#45;&gt;L12_S1_TP5_GPU13_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M114923.36,-708.31C114923.36,-708.31 114923.36,-682.71 114923.36,-682.71"/>
<polygon fill="black" stroke="black" points="114926.86,-682.71 114923.36,-672.71 114919.86,-682.71 114926.86,-682.71"/>
</g>
<!-- L12_S1_TP5_GPU13_gate&#45;&gt;L12_S1_TP5_GPU13_expert1 -->
<g id="edge3781" class="edge">
<title>L12_S1_TP5_GPU13_gate&#45;&gt;L12_S1_TP5_GPU13_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M115430.25,-708.31C115430.25,-708.31 115430.25,-682.71 115430.25,-682.71"/>
<polygon fill="black" stroke="black" points="115433.75,-682.71 115430.25,-672.71 115426.75,-682.71 115433.75,-682.71"/>
</g>
<!-- L12_S1_TP5_GPU13_moe_ar&#45;&gt;L12_S1_TP5_GPU13_moe_res -->
<g id="edge3798" class="edge">
<title>L12_S1_TP5_GPU13_moe_ar&#45;&gt;L12_S1_TP5_GPU13_moe_res</title>
<path fill="none" stroke="black" d="M114803.73,-473.95C114803.73,-440.78 114803.73,-402 114803.73,-402 114803.73,-402 115334.67,-402 115334.67,-402"/>
<polygon fill="black" stroke="black" points="115334.67,-405.5 115344.67,-402 115334.67,-398.5 115334.67,-405.5"/>
</g>
<!-- L12_S1_TP5_GPU13_norm -->
<g id="node1342" class="node">
<title>L12_S1_TP5_GPU13_norm</title>
<polygon fill="none" stroke="black" points="115979.5,-332.33 115530.5,-332.33 115530.5,-264.33 115979.5,-264.33 115979.5,-332.33"/>
<text text-anchor="middle" x="115755" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="115755" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="115755" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="115755" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP5_GPU13_moe_res&#45;&gt;L12_S1_TP5_GPU13_norm -->
<g id="edge3800" class="edge">
<title>L12_S1_TP5_GPU13_moe_res&#45;&gt;L12_S1_TP5_GPU13_norm</title>
<path fill="none" stroke="black" d="M115755,-368.28C115755,-368.28 115755,-342.46 115755,-342.46"/>
<polygon fill="black" stroke="black" points="115758.5,-342.46 115755,-332.46 115751.5,-342.46 115758.5,-342.46"/>
</g>
<!-- L12_S1_TP6_GPU14_qkv_linear -->
<g id="node1343" class="node">
<title>L12_S1_TP6_GPU14_qkv_linear</title>
<polygon fill="none" stroke="black" points="116486,-1614.75 115878,-1614.75 115878,-1546.75 116486,-1546.75 116486,-1614.75"/>
<text text-anchor="middle" x="116182" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="116182" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="116182" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="116182" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L12_S1_TP6_GPU14_qkv_slice -->
<g id="node1344" class="node">
<title>L12_S1_TP6_GPU14_qkv_slice</title>
<polygon fill="none" stroke="black" points="116480,-1496.67 115884,-1496.67 115884,-1428.67 116480,-1428.67 116480,-1496.67"/>
<text text-anchor="middle" x="116182" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="116182" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="116182" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="116182" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L12_S1_TP6_GPU14_qkv_linear&#45;&gt;L12_S1_TP6_GPU14_qkv_slice -->
<g id="edge3801" class="edge">
<title>L12_S1_TP6_GPU14_qkv_linear&#45;&gt;L12_S1_TP6_GPU14_qkv_slice</title>
<path fill="none" stroke="black" d="M116182,-1546.59C116182,-1546.59 116182,-1506.74 116182,-1506.74"/>
<polygon fill="black" stroke="black" points="116185.5,-1506.74 116182,-1496.74 116178.5,-1506.74 116185.5,-1506.74"/>
</g>
<!-- L12_S1_TP6_GPU14_qkv_slice&#45;&gt;L12_S1_TP6_GPU14_attn_v -->
<g id="edge3805" class="edge">
<title>L12_S1_TP6_GPU14_qkv_slice&#45;&gt;L12_S1_TP6_GPU14_attn_v</title>
<path fill="none" stroke="black" d="M115923.25,-1428.38C115923.25,-1428.38 115923.25,-1195 115923.25,-1195"/>
<polygon fill="black" stroke="black" points="115926.75,-1195 115923.25,-1185 115919.75,-1195 115926.75,-1195"/>
</g>
<!-- L12_S1_TP6_GPU14_qk_matmul -->
<g id="node1345" class="node">
<title>L12_S1_TP6_GPU14_qk_matmul</title>
<polygon fill="none" stroke="black" points="116897.5,-1392.67 115962.5,-1392.67 115962.5,-1324.67 116897.5,-1324.67 116897.5,-1392.67"/>
<text text-anchor="middle" x="116430" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="116430" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="116430" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="116430" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L12_S1_TP6_GPU14_qkv_slice&#45;&gt;L12_S1_TP6_GPU14_qk_matmul -->
<g id="edge3802" class="edge">
<title>L12_S1_TP6_GPU14_qkv_slice&#45;&gt;L12_S1_TP6_GPU14_qk_matmul</title>
<path fill="none" stroke="black" d="M116221.25,-1428.61C116221.25,-1428.61 116221.25,-1402.8 116221.25,-1402.8"/>
<polygon fill="black" stroke="black" points="116224.75,-1402.8 116221.25,-1392.8 116217.75,-1402.8 116224.75,-1402.8"/>
</g>
<!-- L12_S1_TP6_GPU14_softmax -->
<g id="node1346" class="node">
<title>L12_S1_TP6_GPU14_softmax</title>
<polygon fill="none" stroke="black" points="116578,-1288.67 116068,-1288.67 116068,-1220.67 116578,-1220.67 116578,-1288.67"/>
<text text-anchor="middle" x="116323" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="116323" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="116323" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="116323" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L12_S1_TP6_GPU14_qk_matmul&#45;&gt;L12_S1_TP6_GPU14_softmax -->
<g id="edge3803" class="edge">
<title>L12_S1_TP6_GPU14_qk_matmul&#45;&gt;L12_S1_TP6_GPU14_softmax</title>
<path fill="none" stroke="black" d="M116323,-1324.61C116323,-1324.61 116323,-1298.8 116323,-1298.8"/>
<polygon fill="black" stroke="black" points="116326.5,-1298.8 116323,-1288.8 116319.5,-1298.8 116326.5,-1298.8"/>
</g>
<!-- L12_S1_TP6_GPU14_softmax&#45;&gt;L12_S1_TP6_GPU14_attn_v -->
<g id="edge3804" class="edge">
<title>L12_S1_TP6_GPU14_softmax&#45;&gt;L12_S1_TP6_GPU14_attn_v</title>
<path fill="none" stroke="black" d="M116306,-1220.61C116306,-1220.61 116306,-1194.8 116306,-1194.8"/>
<polygon fill="black" stroke="black" points="116309.5,-1194.8 116306,-1184.8 116302.5,-1194.8 116309.5,-1194.8"/>
</g>
<!-- L12_S1_TP6_GPU14_mha_res -->
<g id="node1348" class="node">
<title>L12_S1_TP6_GPU14_mha_res</title>
<polygon fill="none" stroke="black" points="116822.5,-948.5 115935.5,-948.5 115935.5,-880.5 116822.5,-880.5 116822.5,-948.5"/>
<text text-anchor="middle" x="116379" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="116379" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="116379" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="116379" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP6_GPU14_mha_ar&#45;&gt;L12_S1_TP6_GPU14_mha_res -->
<g id="edge3814" class="edge">
<title>L12_S1_TP6_GPU14_mha_ar&#45;&gt;L12_S1_TP6_GPU14_mha_res</title>
<path fill="none" stroke="black" d="M115958.99,-1015.66C115958.99,-1015.66 115958.99,-958.91 115958.99,-958.91"/>
<polygon fill="black" stroke="black" points="115962.49,-958.91 115958.99,-948.91 115955.49,-958.91 115962.49,-958.91"/>
</g>
<!-- L12_S1_TP6_GPU14_gate -->
<g id="node1349" class="node">
<title>L12_S1_TP6_GPU14_gate</title>
<polygon fill="none" stroke="black" points="116908.56,-844.5 116066.15,-844.5 115849.44,-708.5 116691.85,-708.5 116908.56,-844.5"/>
<text text-anchor="middle" x="116379" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="116379" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="116379" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="116379" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L12_S1_TP6_GPU14_mha_res&#45;&gt;L12_S1_TP6_GPU14_gate -->
<g id="edge3815" class="edge">
<title>L12_S1_TP6_GPU14_mha_res&#45;&gt;L12_S1_TP6_GPU14_gate</title>
<path fill="none" stroke="black" d="M116379,-880.39C116379,-880.39 116379,-854.73 116379,-854.73"/>
<polygon fill="black" stroke="black" points="116382.5,-854.73 116379,-844.73 116375.5,-854.73 116382.5,-854.73"/>
</g>
<!-- L12_S1_TP6_GPU14_moe_res -->
<g id="node1351" class="node">
<title>L12_S1_TP6_GPU14_moe_res</title>
<polygon fill="none" stroke="black" points="117387,-436.33 116567,-436.33 116567,-368.33 117387,-368.33 117387,-436.33"/>
<text text-anchor="middle" x="116977" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="116977" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="116977" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="116977" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP6_GPU14_mha_res&#45;&gt;L12_S1_TP6_GPU14_moe_res -->
<g id="edge3835" class="edge">
<title>L12_S1_TP6_GPU14_mha_res&#45;&gt;L12_S1_TP6_GPU14_moe_res</title>
<path fill="none" stroke="black" d="M116822.57,-914C116879.27,-914 116918,-914 116918,-914 116918,-914 116918,-694 116918,-694 116918,-694 116952.5,-694 116952.5,-694 116952.5,-694 116952.5,-446.36 116952.5,-446.36"/>
<polygon fill="black" stroke="black" points="116956,-446.36 116952.5,-436.36 116949,-446.36 116956,-446.36"/>
</g>
<!-- L12_S1_TP6_GPU14_gate&#45;&gt;L12_S1_TP6_GPU14_expert0 -->
<g id="edge3816" class="edge">
<title>L12_S1_TP6_GPU14_gate&#45;&gt;L12_S1_TP6_GPU14_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M115929.36,-708.31C115929.36,-708.31 115929.36,-682.71 115929.36,-682.71"/>
<polygon fill="black" stroke="black" points="115932.86,-682.71 115929.36,-672.71 115925.86,-682.71 115932.86,-682.71"/>
</g>
<!-- L12_S1_TP6_GPU14_gate&#45;&gt;L12_S1_TP6_GPU14_expert1 -->
<g id="edge3817" class="edge">
<title>L12_S1_TP6_GPU14_gate&#45;&gt;L12_S1_TP6_GPU14_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M116252,-708.31C116252,-708.31 116252,-682.71 116252,-682.71"/>
<polygon fill="black" stroke="black" points="116255.5,-682.71 116252,-672.71 116248.5,-682.71 116255.5,-682.71"/>
</g>
<!-- L12_S1_TP6_GPU14_moe_ar&#45;&gt;L12_S1_TP6_GPU14_moe_res -->
<g id="edge3834" class="edge">
<title>L12_S1_TP6_GPU14_moe_ar&#45;&gt;L12_S1_TP6_GPU14_moe_res</title>
<path fill="none" stroke="black" d="M115540.23,-476.31C115540.23,-456.72 115540.23,-438 115540.23,-438 115540.23,-438 116755.25,-438 116755.25,-438 116755.25,-438 116755.25,-437.85 116755.25,-437.85"/>
<polygon fill="black" stroke="black" points="116758.75,-446.47 116755.25,-436.47 116751.75,-446.47 116758.75,-446.47"/>
</g>
<!-- L12_S1_TP6_GPU14_norm -->
<g id="node1352" class="node">
<title>L12_S1_TP6_GPU14_norm</title>
<polygon fill="none" stroke="black" points="117201.5,-332.33 116752.5,-332.33 116752.5,-264.33 117201.5,-264.33 117201.5,-332.33"/>
<text text-anchor="middle" x="116977" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="116977" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="116977" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="116977" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP6_GPU14_moe_res&#45;&gt;L12_S1_TP6_GPU14_norm -->
<g id="edge3836" class="edge">
<title>L12_S1_TP6_GPU14_moe_res&#45;&gt;L12_S1_TP6_GPU14_norm</title>
<path fill="none" stroke="black" d="M116977,-368.28C116977,-368.28 116977,-342.46 116977,-342.46"/>
<polygon fill="black" stroke="black" points="116980.5,-342.46 116977,-332.46 116973.5,-342.46 116980.5,-342.46"/>
</g>
<!-- L12_S1_TP7_GPU15_qkv_linear -->
<g id="node1353" class="node">
<title>L12_S1_TP7_GPU15_qkv_linear</title>
<polygon fill="none" stroke="black" points="117530,-1614.75 116922,-1614.75 116922,-1546.75 117530,-1546.75 117530,-1614.75"/>
<text text-anchor="middle" x="117226" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="117226" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="117226" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="117226" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L12_S1_TP7_GPU15_qkv_slice -->
<g id="node1354" class="node">
<title>L12_S1_TP7_GPU15_qkv_slice</title>
<polygon fill="none" stroke="black" points="117524,-1496.67 116928,-1496.67 116928,-1428.67 117524,-1428.67 117524,-1496.67"/>
<text text-anchor="middle" x="117226" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="117226" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="117226" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="117226" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L12_S1_TP7_GPU15_qkv_linear&#45;&gt;L12_S1_TP7_GPU15_qkv_slice -->
<g id="edge3837" class="edge">
<title>L12_S1_TP7_GPU15_qkv_linear&#45;&gt;L12_S1_TP7_GPU15_qkv_slice</title>
<path fill="none" stroke="black" d="M117226,-1546.59C117226,-1546.59 117226,-1506.74 117226,-1506.74"/>
<polygon fill="black" stroke="black" points="117229.5,-1506.74 117226,-1496.74 117222.5,-1506.74 117229.5,-1506.74"/>
</g>
<!-- L12_S1_TP7_GPU15_qkv_slice&#45;&gt;L12_S1_TP7_GPU15_attn_v -->
<g id="edge3841" class="edge">
<title>L12_S1_TP7_GPU15_qkv_slice&#45;&gt;L12_S1_TP7_GPU15_attn_v</title>
<path fill="none" stroke="black" d="M116967.25,-1428.38C116967.25,-1428.38 116967.25,-1195 116967.25,-1195"/>
<polygon fill="black" stroke="black" points="116970.75,-1195 116967.25,-1185 116963.75,-1195 116970.75,-1195"/>
</g>
<!-- L12_S1_TP7_GPU15_qk_matmul -->
<g id="node1355" class="node">
<title>L12_S1_TP7_GPU15_qk_matmul</title>
<polygon fill="none" stroke="black" points="117941.5,-1392.67 117006.5,-1392.67 117006.5,-1324.67 117941.5,-1324.67 117941.5,-1392.67"/>
<text text-anchor="middle" x="117474" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="117474" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="117474" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="117474" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L12_S1_TP7_GPU15_qkv_slice&#45;&gt;L12_S1_TP7_GPU15_qk_matmul -->
<g id="edge3838" class="edge">
<title>L12_S1_TP7_GPU15_qkv_slice&#45;&gt;L12_S1_TP7_GPU15_qk_matmul</title>
<path fill="none" stroke="black" d="M117265.25,-1428.61C117265.25,-1428.61 117265.25,-1402.8 117265.25,-1402.8"/>
<polygon fill="black" stroke="black" points="117268.75,-1402.8 117265.25,-1392.8 117261.75,-1402.8 117268.75,-1402.8"/>
</g>
<!-- L12_S1_TP7_GPU15_softmax -->
<g id="node1356" class="node">
<title>L12_S1_TP7_GPU15_softmax</title>
<polygon fill="none" stroke="black" points="117622,-1288.67 117112,-1288.67 117112,-1220.67 117622,-1220.67 117622,-1288.67"/>
<text text-anchor="middle" x="117367" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="117367" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="117367" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="117367" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L12_S1_TP7_GPU15_qk_matmul&#45;&gt;L12_S1_TP7_GPU15_softmax -->
<g id="edge3839" class="edge">
<title>L12_S1_TP7_GPU15_qk_matmul&#45;&gt;L12_S1_TP7_GPU15_softmax</title>
<path fill="none" stroke="black" d="M117367,-1324.61C117367,-1324.61 117367,-1298.8 117367,-1298.8"/>
<polygon fill="black" stroke="black" points="117370.5,-1298.8 117367,-1288.8 117363.5,-1298.8 117370.5,-1298.8"/>
</g>
<!-- L12_S1_TP7_GPU15_softmax&#45;&gt;L12_S1_TP7_GPU15_attn_v -->
<g id="edge3840" class="edge">
<title>L12_S1_TP7_GPU15_softmax&#45;&gt;L12_S1_TP7_GPU15_attn_v</title>
<path fill="none" stroke="black" d="M117306,-1220.61C117306,-1220.61 117306,-1194.8 117306,-1194.8"/>
<polygon fill="black" stroke="black" points="117309.5,-1194.8 117306,-1184.8 117302.5,-1194.8 117309.5,-1194.8"/>
</g>
<!-- L12_S1_TP7_GPU15_mha_res -->
<g id="node1358" class="node">
<title>L12_S1_TP7_GPU15_mha_res</title>
<polygon fill="none" stroke="black" points="117900.5,-948.5 117013.5,-948.5 117013.5,-880.5 117900.5,-880.5 117900.5,-948.5"/>
<text text-anchor="middle" x="117457" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="117457" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="117457" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="117457" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP7_GPU15_mha_ar&#45;&gt;L12_S1_TP7_GPU15_mha_res -->
<g id="edge3850" class="edge">
<title>L12_S1_TP7_GPU15_mha_ar&#45;&gt;L12_S1_TP7_GPU15_mha_res</title>
<path fill="none" stroke="black" d="M116728.53,-1016C116973.7,-1016 117256.75,-1016 117256.75,-1016 117256.75,-1016 117256.75,-958.58 117256.75,-958.58"/>
<polygon fill="black" stroke="black" points="117260.25,-958.58 117256.75,-948.58 117253.25,-958.58 117260.25,-958.58"/>
</g>
<!-- L12_S1_TP7_GPU15_gate -->
<g id="node1359" class="node">
<title>L12_S1_TP7_GPU15_gate</title>
<polygon fill="none" stroke="black" points="117986.56,-844.5 117144.15,-844.5 116927.44,-708.5 117769.85,-708.5 117986.56,-844.5"/>
<text text-anchor="middle" x="117457" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="117457" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="117457" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="117457" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L12_S1_TP7_GPU15_mha_res&#45;&gt;L12_S1_TP7_GPU15_gate -->
<g id="edge3851" class="edge">
<title>L12_S1_TP7_GPU15_mha_res&#45;&gt;L12_S1_TP7_GPU15_gate</title>
<path fill="none" stroke="black" d="M117457,-880.39C117457,-880.39 117457,-854.73 117457,-854.73"/>
<polygon fill="black" stroke="black" points="117460.5,-854.73 117457,-844.73 117453.5,-854.73 117460.5,-854.73"/>
</g>
<!-- L12_S1_TP7_GPU15_moe_res -->
<g id="node1361" class="node">
<title>L12_S1_TP7_GPU15_moe_res</title>
<polygon fill="none" stroke="black" points="118417,-436.33 117597,-436.33 117597,-368.33 118417,-368.33 118417,-436.33"/>
<text text-anchor="middle" x="118007" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="118007" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="118007" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="118007" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP7_GPU15_mha_res&#45;&gt;L12_S1_TP7_GPU15_moe_res -->
<g id="edge3871" class="edge">
<title>L12_S1_TP7_GPU15_mha_res&#45;&gt;L12_S1_TP7_GPU15_moe_res</title>
<path fill="none" stroke="black" d="M117900.53,-925C118060.27,-925 118201.89,-925 118201.89,-925 118201.89,-925 118201.89,-446.63 118201.89,-446.63"/>
<polygon fill="black" stroke="black" points="118205.39,-446.63 118201.89,-436.63 118198.39,-446.63 118205.39,-446.63"/>
</g>
<!-- L12_S1_TP7_GPU15_gate&#45;&gt;L12_S1_TP7_GPU15_expert0 -->
<g id="edge3852" class="edge">
<title>L12_S1_TP7_GPU15_gate&#45;&gt;L12_S1_TP7_GPU15_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M116935.36,-776.4C116935.36,-776.4 116935.36,-682.74 116935.36,-682.74"/>
<polygon fill="black" stroke="black" points="116938.86,-682.74 116935.36,-672.74 116931.86,-682.74 116938.86,-682.74"/>
</g>
<!-- L12_S1_TP7_GPU15_gate&#45;&gt;L12_S1_TP7_GPU15_expert1 -->
<g id="edge3853" class="edge">
<title>L12_S1_TP7_GPU15_gate&#45;&gt;L12_S1_TP7_GPU15_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M117260.83,-708.31C117260.83,-708.31 117260.83,-682.71 117260.83,-682.71"/>
<polygon fill="black" stroke="black" points="117264.33,-682.71 117260.83,-672.71 117257.33,-682.71 117264.33,-682.71"/>
</g>
<!-- L12_S1_TP7_GPU15_moe_ar&#45;&gt;L12_S1_TP7_GPU15_moe_res -->
<g id="edge3870" class="edge">
<title>L12_S1_TP7_GPU15_moe_ar&#45;&gt;L12_S1_TP7_GPU15_moe_res</title>
<path fill="none" stroke="black" d="M116419.56,-527C116915.24,-527 117791.89,-527 117791.89,-527 117791.89,-527 117791.89,-446.4 117791.89,-446.4"/>
<polygon fill="black" stroke="black" points="117795.39,-446.4 117791.89,-436.4 117788.39,-446.4 117795.39,-446.4"/>
</g>
<!-- L12_S1_TP7_GPU15_norm -->
<g id="node1362" class="node">
<title>L12_S1_TP7_GPU15_norm</title>
<polygon fill="none" stroke="black" points="118231.5,-332.33 117782.5,-332.33 117782.5,-264.33 118231.5,-264.33 118231.5,-332.33"/>
<text text-anchor="middle" x="118007" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="118007" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="118007" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="118007" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L12_S1_TP7_GPU15_moe_res&#45;&gt;L12_S1_TP7_GPU15_norm -->
<g id="edge3872" class="edge">
<title>L12_S1_TP7_GPU15_moe_res&#45;&gt;L12_S1_TP7_GPU15_norm</title>
<path fill="none" stroke="black" d="M118007,-368.28C118007,-368.28 118007,-342.46 118007,-342.46"/>
<polygon fill="black" stroke="black" points="118010.5,-342.46 118007,-332.46 118003.5,-342.46 118010.5,-342.46"/>
</g>
<!-- L13_S1_TP0_GPU8_qkv_linear -->
<g id="node1363" class="node">
<title>L13_S1_TP0_GPU8_qkv_linear</title>
<polygon fill="none" stroke="black" points="119828,-1614.75 119220,-1614.75 119220,-1546.75 119828,-1546.75 119828,-1614.75"/>
<text text-anchor="middle" x="119524" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="119524" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="119524" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="119524" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L13_S1_TP0_GPU8_qkv_slice -->
<g id="node1364" class="node">
<title>L13_S1_TP0_GPU8_qkv_slice</title>
<polygon fill="none" stroke="black" points="119822,-1496.67 119226,-1496.67 119226,-1428.67 119822,-1428.67 119822,-1496.67"/>
<text text-anchor="middle" x="119524" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="119524" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="119524" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="119524" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L13_S1_TP0_GPU8_qkv_linear&#45;&gt;L13_S1_TP0_GPU8_qkv_slice -->
<g id="edge3873" class="edge">
<title>L13_S1_TP0_GPU8_qkv_linear&#45;&gt;L13_S1_TP0_GPU8_qkv_slice</title>
<path fill="none" stroke="black" d="M119524,-1546.59C119524,-1546.59 119524,-1506.74 119524,-1506.74"/>
<polygon fill="black" stroke="black" points="119527.5,-1506.74 119524,-1496.74 119520.5,-1506.74 119527.5,-1506.74"/>
</g>
<!-- L13_S1_TP0_GPU8_qk_matmul -->
<g id="node1365" class="node">
<title>L13_S1_TP0_GPU8_qk_matmul</title>
<polygon fill="none" stroke="black" points="120304.5,-1392.67 119369.5,-1392.67 119369.5,-1324.67 120304.5,-1324.67 120304.5,-1392.67"/>
<text text-anchor="middle" x="119837" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="119837" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="119837" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="119837" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L13_S1_TP0_GPU8_qkv_slice&#45;&gt;L13_S1_TP0_GPU8_qk_matmul -->
<g id="edge3874" class="edge">
<title>L13_S1_TP0_GPU8_qkv_slice&#45;&gt;L13_S1_TP0_GPU8_qk_matmul</title>
<path fill="none" stroke="black" d="M119595.75,-1428.61C119595.75,-1428.61 119595.75,-1402.8 119595.75,-1402.8"/>
<polygon fill="black" stroke="black" points="119599.25,-1402.8 119595.75,-1392.8 119592.25,-1402.8 119599.25,-1402.8"/>
</g>
<!-- L13_S1_TP0_GPU8_attn_v -->
<g id="node1367" class="node">
<title>L13_S1_TP0_GPU8_attn_v</title>
<polygon fill="none" stroke="black" points="120305,-1184.67 119367,-1184.67 119367,-1116.67 120305,-1116.67 120305,-1184.67"/>
<text text-anchor="middle" x="119836" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="119836" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="119836" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="119836" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L13_S1_TP0_GPU8_qkv_slice&#45;&gt;L13_S1_TP0_GPU8_attn_v -->
<g id="edge3877" class="edge">
<title>L13_S1_TP0_GPU8_qkv_slice&#45;&gt;L13_S1_TP0_GPU8_attn_v</title>
<path fill="none" stroke="black" d="M119296.5,-1428.61C119296.5,-1347.57 119296.5,-1150 119296.5,-1150 119296.5,-1150 119356.75,-1150 119356.75,-1150"/>
<polygon fill="black" stroke="black" points="119356.75,-1153.5 119366.75,-1150 119356.75,-1146.5 119356.75,-1153.5"/>
</g>
<!-- L13_S1_TP0_GPU8_softmax -->
<g id="node1366" class="node">
<title>L13_S1_TP0_GPU8_softmax</title>
<polygon fill="none" stroke="black" points="120091,-1288.67 119581,-1288.67 119581,-1220.67 120091,-1220.67 120091,-1288.67"/>
<text text-anchor="middle" x="119836" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="119836" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="119836" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="119836" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L13_S1_TP0_GPU8_qk_matmul&#45;&gt;L13_S1_TP0_GPU8_softmax -->
<g id="edge3875" class="edge">
<title>L13_S1_TP0_GPU8_qk_matmul&#45;&gt;L13_S1_TP0_GPU8_softmax</title>
<path fill="none" stroke="black" d="M119836,-1324.61C119836,-1324.61 119836,-1298.8 119836,-1298.8"/>
<polygon fill="black" stroke="black" points="119839.5,-1298.8 119836,-1288.8 119832.5,-1298.8 119839.5,-1298.8"/>
</g>
<!-- L13_S1_TP0_GPU8_softmax&#45;&gt;L13_S1_TP0_GPU8_attn_v -->
<g id="edge3876" class="edge">
<title>L13_S1_TP0_GPU8_softmax&#45;&gt;L13_S1_TP0_GPU8_attn_v</title>
<path fill="none" stroke="black" d="M119836,-1220.61C119836,-1220.61 119836,-1194.8 119836,-1194.8"/>
<polygon fill="black" stroke="black" points="119839.5,-1194.8 119836,-1184.8 119832.5,-1194.8 119839.5,-1194.8"/>
</g>
<!-- L13_S1_TP0_GPU8_mha_ar -->
<g id="node1368" class="node">
<title>L13_S1_TP0_GPU8_mha_ar</title>
<ellipse fill="none" stroke="black" cx="120491" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="120491" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="120491" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="120491" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="120491" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP0_GPU8_attn_v&#45;&gt;L13_S1_TP0_GPU8_mha_ar -->
<g id="edge3878" class="edge">
<title>L13_S1_TP0_GPU8_attn_v&#45;&gt;L13_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M120147.11,-1116.51C120147.11,-1116.51 120147.11,-1061.95 120147.11,-1061.95"/>
<polygon fill="black" stroke="black" points="120150.61,-1061.95 120147.11,-1051.95 120143.61,-1061.95 120150.61,-1061.95"/>
</g>
<!-- L13_S1_TP1_GPU9_mha_ar -->
<g id="node1401" class="node">
<title>L13_S1_TP1_GPU9_mha_ar</title>
<ellipse fill="none" stroke="black" cx="121260" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="121260" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="121260" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="121260" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="121260" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP0_GPU8_attn_v&#45;&gt;L13_S1_TP1_GPU9_mha_ar -->
<g id="edge3914" class="edge">
<title>L13_S1_TP0_GPU8_attn_v&#45;&gt;L13_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M120178.68,-1116.65C120178.68,-1103.25 120178.68,-1091 120178.68,-1091 120178.68,-1091 120931.59,-1091 120931.59,-1091 120931.59,-1091 120931.59,-1066.01 120931.59,-1066.01"/>
<polygon fill="black" stroke="black" points="120935.09,-1066.01 120931.59,-1056.01 120928.09,-1066.01 120935.09,-1066.01"/>
</g>
<!-- L13_S1_TP2_GPU10_mha_ar -->
<g id="node1411" class="node">
<title>L13_S1_TP2_GPU10_mha_ar</title>
<ellipse fill="none" stroke="black" cx="122029" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="122029" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="122029" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="122029" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="122029" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP0_GPU8_attn_v&#45;&gt;L13_S1_TP2_GPU10_mha_ar -->
<g id="edge3950" class="edge">
<title>L13_S1_TP0_GPU8_attn_v&#45;&gt;L13_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M120210.26,-1116.65C120210.26,-1103.25 120210.26,-1091 120210.26,-1091 120210.26,-1091 121716.13,-1091 121716.13,-1091 121716.13,-1091 121716.13,-1069.4 121716.13,-1069.4"/>
<polygon fill="black" stroke="black" points="121719.63,-1069.4 121716.13,-1059.4 121712.63,-1069.4 121719.63,-1069.4"/>
</g>
<!-- L13_S1_TP3_GPU11_mha_ar -->
<g id="node1421" class="node">
<title>L13_S1_TP3_GPU11_mha_ar</title>
<ellipse fill="none" stroke="black" cx="122798" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="122798" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="122798" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="122798" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="122798" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP0_GPU8_attn_v&#45;&gt;L13_S1_TP3_GPU11_mha_ar -->
<g id="edge3986" class="edge">
<title>L13_S1_TP0_GPU8_attn_v&#45;&gt;L13_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M120241.84,-1116.65C120241.84,-1103.25 120241.84,-1091 120241.84,-1091 120241.84,-1091 122529.74,-1091 122529.74,-1091 122529.74,-1091 122529.74,-1076.23 122529.74,-1076.23"/>
<polygon fill="black" stroke="black" points="122533.24,-1076.23 122529.74,-1066.23 122526.24,-1076.23 122533.24,-1076.23"/>
</g>
<!-- L13_S1_TP4_GPU12_mha_ar -->
<g id="node1431" class="node">
<title>L13_S1_TP4_GPU12_mha_ar</title>
<ellipse fill="none" stroke="black" cx="123567" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="123567" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="123567" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="123567" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="123567" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP0_GPU8_attn_v&#45;&gt;L13_S1_TP4_GPU12_mha_ar -->
<g id="edge4022" class="edge">
<title>L13_S1_TP0_GPU8_attn_v&#45;&gt;L13_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M120080.01,-1116.33C120080.01,-1066.75 120080.01,-981 120080.01,-981 120080.01,-981 123249.74,-981 123249.74,-981 123249.74,-981 123249.74,-996.79 123249.74,-996.79"/>
<polygon fill="black" stroke="black" points="123246.24,-996.79 123249.74,-1006.79 123253.24,-996.79 123246.24,-996.79"/>
</g>
<!-- L13_S1_TP5_GPU13_mha_ar -->
<g id="node1441" class="node">
<title>L13_S1_TP5_GPU13_mha_ar</title>
<ellipse fill="none" stroke="black" cx="124336" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="124336" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="124336" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="124336" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="124336" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP0_GPU8_attn_v&#45;&gt;L13_S1_TP5_GPU13_mha_ar -->
<g id="edge4058" class="edge">
<title>L13_S1_TP0_GPU8_attn_v&#45;&gt;L13_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M120233.33,-1184.86C120233.33,-1200.67 120233.33,-1216 120233.33,-1216 120233.33,-1216 124141,-1216 124141,-1216 124141,-1216 124141,-1083.75 124141,-1083.75"/>
<polygon fill="black" stroke="black" points="124144.5,-1083.75 124141,-1073.75 124137.5,-1083.75 124144.5,-1083.75"/>
</g>
<!-- L13_S1_TP6_GPU14_mha_ar -->
<g id="node1451" class="node">
<title>L13_S1_TP6_GPU14_mha_ar</title>
<ellipse fill="none" stroke="black" cx="125105" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="125105" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="125105" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="125105" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="125105" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP0_GPU8_attn_v&#45;&gt;L13_S1_TP6_GPU14_mha_ar -->
<g id="edge4094" class="edge">
<title>L13_S1_TP0_GPU8_attn_v&#45;&gt;L13_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M120162.17,-1184.83C120162.17,-1201.92 120162.17,-1219 120162.17,-1219 120162.17,-1219 125097,-1219 125097,-1219 125097,-1219 125097,-1091.08 125097,-1091.08"/>
<polygon fill="black" stroke="black" points="125100.5,-1091.08 125097,-1081.08 125093.5,-1091.08 125100.5,-1091.08"/>
</g>
<!-- L13_S1_TP7_GPU15_mha_ar -->
<g id="node1461" class="node">
<title>L13_S1_TP7_GPU15_mha_ar</title>
<ellipse fill="none" stroke="black" cx="125874" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="125874" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="125874" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="125874" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="125874" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP0_GPU8_attn_v&#45;&gt;L13_S1_TP7_GPU15_mha_ar -->
<g id="edge4130" class="edge">
<title>L13_S1_TP0_GPU8_attn_v&#45;&gt;L13_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M120273.42,-1116.35C120273.42,-1112.54 120273.42,-1110 120273.42,-1110 120273.42,-1110 125566.34,-1110 125566.34,-1110 125566.34,-1110 125566.34,-1070.53 125566.34,-1070.53"/>
<polygon fill="black" stroke="black" points="125569.84,-1070.53 125566.34,-1060.53 125562.84,-1070.53 125569.84,-1070.53"/>
</g>
<!-- L13_S1_TP0_GPU8_mha_res -->
<g id="node1376" class="node">
<title>L13_S1_TP0_GPU8_mha_res</title>
<polygon fill="none" stroke="black" points="119853.5,-948.5 118966.5,-948.5 118966.5,-880.5 119853.5,-880.5 119853.5,-948.5"/>
<text text-anchor="middle" x="119410" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="119410" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="119410" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="119410" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP0_GPU8_mha_ar&#45;&gt;L13_S1_TP0_GPU8_mha_res -->
<g id="edge3886" class="edge">
<title>L13_S1_TP0_GPU8_mha_ar&#45;&gt;L13_S1_TP0_GPU8_mha_res</title>
<path fill="none" stroke="black" d="M120135.3,-1048C119890.86,-1048 119610.25,-1048 119610.25,-1048 119610.25,-1048 119610.25,-958.53 119610.25,-958.53"/>
<polygon fill="black" stroke="black" points="119613.75,-958.53 119610.25,-948.53 119606.75,-958.53 119613.75,-958.53"/>
</g>
<!-- L13_S1_TP1_GPU9_attn_v -->
<g id="node1369" class="node">
<title>L13_S1_TP1_GPU9_attn_v</title>
<polygon fill="none" stroke="black" points="121261,-1184.67 120323,-1184.67 120323,-1116.67 121261,-1116.67 121261,-1184.67"/>
<text text-anchor="middle" x="120792" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="120792" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="120792" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="120792" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L13_S1_TP1_GPU9_attn_v&#45;&gt;L13_S1_TP0_GPU8_mha_ar -->
<g id="edge3879" class="edge">
<title>L13_S1_TP1_GPU9_attn_v&#45;&gt;L13_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M120390.93,-1116.51C120390.93,-1116.51 120390.93,-1088.96 120390.93,-1088.96"/>
<polygon fill="black" stroke="black" points="120394.43,-1088.96 120390.93,-1078.96 120387.43,-1088.96 120394.43,-1088.96"/>
</g>
<!-- L13_S1_TP1_GPU9_attn_v&#45;&gt;L13_S1_TP1_GPU9_mha_ar -->
<g id="edge3915" class="edge">
<title>L13_S1_TP1_GPU9_attn_v&#45;&gt;L13_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M120978.64,-1116.51C120978.64,-1116.51 120978.64,-1074.64 120978.64,-1074.64"/>
<polygon fill="black" stroke="black" points="120982.14,-1074.64 120978.64,-1064.64 120975.14,-1074.64 120982.14,-1074.64"/>
</g>
<!-- L13_S1_TP1_GPU9_attn_v&#45;&gt;L13_S1_TP2_GPU10_mha_ar -->
<g id="edge3951" class="edge">
<title>L13_S1_TP1_GPU9_attn_v&#45;&gt;L13_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M121025.7,-1116.65C121025.7,-1103.25 121025.7,-1091 121025.7,-1091 121025.7,-1091 121778.74,-1091 121778.74,-1091 121778.74,-1091 121778.74,-1078.58 121778.74,-1078.58"/>
<polygon fill="black" stroke="black" points="121782.24,-1078.58 121778.74,-1068.58 121775.24,-1078.58 121782.24,-1078.58"/>
</g>
<!-- L13_S1_TP1_GPU9_attn_v&#45;&gt;L13_S1_TP3_GPU11_mha_ar -->
<g id="edge3987" class="edge">
<title>L13_S1_TP1_GPU9_attn_v&#45;&gt;L13_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M121072.76,-1116.65C121072.76,-1103.25 121072.76,-1091 121072.76,-1091 121072.76,-1091 122636.95,-1091 122636.95,-1091 122636.95,-1091 122636.95,-1086.26 122636.95,-1086.26"/>
<polygon fill="black" stroke="black" points="122640.45,-1086.26 122636.95,-1076.26 122633.45,-1086.26 122640.45,-1086.26"/>
</g>
<!-- L13_S1_TP1_GPU9_attn_v&#45;&gt;L13_S1_TP4_GPU12_mha_ar -->
<g id="edge4023" class="edge">
<title>L13_S1_TP1_GPU9_attn_v&#45;&gt;L13_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M120875.5,-1116.33C120875.5,-1066.75 120875.5,-981 120875.5,-981 120875.5,-981 123220.98,-981 123220.98,-981 123220.98,-981 123220.98,-1003.67 123220.98,-1003.67"/>
<polygon fill="black" stroke="black" points="123217.48,-1003.67 123220.98,-1013.67 123224.48,-1003.67 123217.48,-1003.67"/>
</g>
<!-- L13_S1_TP1_GPU9_attn_v&#45;&gt;L13_S1_TP5_GPU13_mha_ar -->
<g id="edge4059" class="edge">
<title>L13_S1_TP1_GPU9_attn_v&#45;&gt;L13_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M121119.82,-1116.35C121119.82,-1112.54 121119.82,-1110 121119.82,-1110 121119.82,-1110 123988.61,-1110 123988.61,-1110 123988.61,-1110 123988.61,-1060.93 123988.61,-1060.93"/>
<polygon fill="black" stroke="black" points="123992.11,-1060.93 123988.61,-1050.93 123985.11,-1060.93 123992.11,-1060.93"/>
</g>
<!-- L13_S1_TP1_GPU9_attn_v&#45;&gt;L13_S1_TP6_GPU14_mha_ar -->
<g id="edge4095" class="edge">
<title>L13_S1_TP1_GPU9_attn_v&#45;&gt;L13_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M121166.88,-1116.35C121166.88,-1112.54 121166.88,-1110 121166.88,-1110 121166.88,-1110 124788.77,-1110 124788.77,-1110 124788.77,-1110 124788.77,-1068.79 124788.77,-1068.79"/>
<polygon fill="black" stroke="black" points="124792.27,-1068.79 124788.77,-1058.79 124785.27,-1068.79 124792.27,-1068.79"/>
</g>
<!-- L13_S1_TP1_GPU9_attn_v&#45;&gt;L13_S1_TP7_GPU15_mha_ar -->
<g id="edge4131" class="edge">
<title>L13_S1_TP1_GPU9_attn_v&#45;&gt;L13_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M121213.94,-1116.35C121213.94,-1112.54 121213.94,-1110 121213.94,-1110 121213.94,-1110 125634.14,-1110 125634.14,-1110 125634.14,-1110 125634.14,-1079.93 125634.14,-1079.93"/>
<polygon fill="black" stroke="black" points="125637.64,-1079.93 125634.14,-1069.93 125630.64,-1079.93 125637.64,-1079.93"/>
</g>
<!-- L13_S1_TP2_GPU10_attn_v -->
<g id="node1370" class="node">
<title>L13_S1_TP2_GPU10_attn_v</title>
<polygon fill="none" stroke="black" points="122217,-1184.67 121279,-1184.67 121279,-1116.67 122217,-1116.67 122217,-1184.67"/>
<text text-anchor="middle" x="121748" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="121748" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="121748" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="121748" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L13_S1_TP2_GPU10_attn_v&#45;&gt;L13_S1_TP0_GPU8_mha_ar -->
<g id="edge3880" class="edge">
<title>L13_S1_TP2_GPU10_attn_v&#45;&gt;L13_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M121329.92,-1116.35C121329.92,-1112.54 121329.92,-1110 121329.92,-1110 121329.92,-1110 120458.87,-1110 120458.87,-1110 120458.87,-1110 120458.87,-1090.73 120458.87,-1090.73"/>
<polygon fill="black" stroke="black" points="120462.37,-1090.73 120458.87,-1080.73 120455.37,-1090.73 120462.37,-1090.73"/>
</g>
<!-- L13_S1_TP2_GPU10_attn_v&#45;&gt;L13_S1_TP1_GPU9_mha_ar -->
<g id="edge3916" class="edge">
<title>L13_S1_TP2_GPU10_attn_v&#45;&gt;L13_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M121380.85,-1116.51C121380.85,-1116.51 121380.85,-1088.52 121380.85,-1088.52"/>
<polygon fill="black" stroke="black" points="121384.35,-1088.52 121380.85,-1078.52 121377.35,-1088.52 121384.35,-1088.52"/>
</g>
<!-- L13_S1_TP2_GPU10_attn_v&#45;&gt;L13_S1_TP2_GPU10_mha_ar -->
<g id="edge3952" class="edge">
<title>L13_S1_TP2_GPU10_attn_v&#45;&gt;L13_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M121841.35,-1116.51C121841.35,-1116.51 121841.35,-1084.63 121841.35,-1084.63"/>
<polygon fill="black" stroke="black" points="121844.85,-1084.63 121841.35,-1074.63 121837.85,-1084.63 121844.85,-1084.63"/>
</g>
<!-- L13_S1_TP2_GPU10_attn_v&#45;&gt;L13_S1_TP3_GPU11_mha_ar -->
<g id="edge3988" class="edge">
<title>L13_S1_TP2_GPU10_attn_v&#45;&gt;L13_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M121903.96,-1116.65C121903.96,-1103.25 121903.96,-1091 121903.96,-1091 121903.96,-1091 122744.16,-1091 122744.16,-1091 122744.16,-1091 122744.16,-1089.93 122744.16,-1089.93"/>
<polygon fill="black" stroke="black" points="122747.66,-1090.29 122744.16,-1080.29 122740.66,-1090.29 122747.66,-1090.29"/>
</g>
<!-- L13_S1_TP2_GPU10_attn_v&#45;&gt;L13_S1_TP4_GPU12_mha_ar -->
<g id="edge4024" class="edge">
<title>L13_S1_TP2_GPU10_attn_v&#45;&gt;L13_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M121966.57,-1116.35C121966.57,-1112.54 121966.57,-1110 121966.57,-1110 121966.57,-1110 123406.08,-1110 123406.08,-1110 123406.08,-1110 123406.08,-1086.27 123406.08,-1086.27"/>
<polygon fill="black" stroke="black" points="123409.58,-1086.27 123406.08,-1076.27 123402.58,-1086.27 123409.58,-1086.27"/>
</g>
<!-- L13_S1_TP2_GPU10_attn_v&#45;&gt;L13_S1_TP5_GPU13_mha_ar -->
<g id="edge4060" class="edge">
<title>L13_S1_TP2_GPU10_attn_v&#45;&gt;L13_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M122029.18,-1116.35C122029.18,-1112.54 122029.18,-1110 122029.18,-1110 122029.18,-1110 124016.68,-1110 124016.68,-1110 124016.68,-1110 124016.68,-1067.93 124016.68,-1067.93"/>
<polygon fill="black" stroke="black" points="124020.18,-1067.93 124016.68,-1057.93 124013.18,-1067.93 124020.18,-1067.93"/>
</g>
<!-- L13_S1_TP2_GPU10_attn_v&#45;&gt;L13_S1_TP6_GPU14_mha_ar -->
<g id="edge4096" class="edge">
<title>L13_S1_TP2_GPU10_attn_v&#45;&gt;L13_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M122091.78,-1116.35C122091.78,-1112.54 122091.78,-1110 122091.78,-1110 122091.78,-1110 124848.02,-1110 124848.02,-1110 124848.02,-1110 124848.02,-1077.67 124848.02,-1077.67"/>
<polygon fill="black" stroke="black" points="124851.52,-1077.67 124848.02,-1067.67 124844.52,-1077.67 124851.52,-1077.67"/>
</g>
<!-- L13_S1_TP2_GPU10_attn_v&#45;&gt;L13_S1_TP7_GPU15_mha_ar -->
<g id="edge4132" class="edge">
<title>L13_S1_TP2_GPU10_attn_v&#45;&gt;L13_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M122154.39,-1116.35C122154.39,-1112.54 122154.39,-1110 122154.39,-1110 122154.39,-1110 125701.95,-1110 125701.95,-1110 125701.95,-1110 125701.95,-1085.37 125701.95,-1085.37"/>
<polygon fill="black" stroke="black" points="125705.45,-1085.37 125701.95,-1075.37 125698.45,-1085.37 125705.45,-1085.37"/>
</g>
<!-- L13_S1_TP3_GPU11_attn_v -->
<g id="node1371" class="node">
<title>L13_S1_TP3_GPU11_attn_v</title>
<polygon fill="none" stroke="black" points="123173,-1184.67 122235,-1184.67 122235,-1116.67 123173,-1116.67 123173,-1184.67"/>
<text text-anchor="middle" x="122704" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="122704" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="122704" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="122704" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L13_S1_TP3_GPU11_attn_v&#45;&gt;L13_S1_TP0_GPU8_mha_ar -->
<g id="edge3881" class="edge">
<title>L13_S1_TP3_GPU11_attn_v&#45;&gt;L13_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M122268.89,-1116.35C122268.89,-1112.54 122268.89,-1110 122268.89,-1110 122268.89,-1110 120526.8,-1110 120526.8,-1110 120526.8,-1110 120526.8,-1090.73 120526.8,-1090.73"/>
<polygon fill="black" stroke="black" points="120530.3,-1090.73 120526.8,-1080.73 120523.3,-1090.73 120530.3,-1090.73"/>
</g>
<!-- L13_S1_TP3_GPU11_attn_v&#45;&gt;L13_S1_TP1_GPU9_mha_ar -->
<g id="edge3917" class="edge">
<title>L13_S1_TP3_GPU11_attn_v&#45;&gt;L13_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M122302.79,-1116.35C122302.79,-1112.54 122302.79,-1110 122302.79,-1110 122302.79,-1110 121431.77,-1110 121431.77,-1110 121431.77,-1110 121431.77,-1085.37 121431.77,-1085.37"/>
<polygon fill="black" stroke="black" points="121435.27,-1085.37 121431.77,-1075.37 121428.27,-1085.37 121435.27,-1085.37"/>
</g>
<!-- L13_S1_TP3_GPU11_attn_v&#45;&gt;L13_S1_TP2_GPU10_mha_ar -->
<g id="edge3953" class="edge">
<title>L13_S1_TP3_GPU11_attn_v&#45;&gt;L13_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M122336.68,-1116.51C122336.68,-1116.51 122336.68,-1070.31 122336.68,-1070.31"/>
<polygon fill="black" stroke="black" points="122340.18,-1070.31 122336.68,-1060.31 122333.18,-1070.31 122340.18,-1070.31"/>
</g>
<!-- L13_S1_TP3_GPU11_attn_v&#45;&gt;L13_S1_TP3_GPU11_mha_ar -->
<g id="edge3989" class="edge">
<title>L13_S1_TP3_GPU11_attn_v&#45;&gt;L13_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M122851.37,-1116.51C122851.37,-1116.51 122851.37,-1090.27 122851.37,-1090.27"/>
<polygon fill="black" stroke="black" points="122854.87,-1090.27 122851.37,-1080.27 122847.87,-1090.27 122854.87,-1090.27"/>
</g>
<!-- L13_S1_TP3_GPU11_attn_v&#45;&gt;L13_S1_TP4_GPU12_mha_ar -->
<g id="edge4025" class="edge">
<title>L13_S1_TP3_GPU11_attn_v&#45;&gt;L13_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M123173.16,-1161C123175.14,-1161 123176.17,-1161 123176.17,-1161 123176.17,-1161 123176.17,-1048 123176.17,-1048 123176.17,-1048 123201.2,-1048 123201.2,-1048"/>
<polygon fill="black" stroke="black" points="123201.2,-1051.5 123211.2,-1048 123201.2,-1044.5 123201.2,-1051.5"/>
</g>
<!-- L13_S1_TP3_GPU11_attn_v&#45;&gt;L13_S1_TP5_GPU13_mha_ar -->
<g id="edge4061" class="edge">
<title>L13_S1_TP3_GPU11_attn_v&#45;&gt;L13_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M123124,-1184.84C123124,-1189.65 123124,-1193 123124,-1193 123124,-1193 124135,-1193 124135,-1193 124135,-1193 124135,-1083.48 124135,-1083.48"/>
<polygon fill="black" stroke="black" points="124138.5,-1083.48 124135,-1073.48 124131.5,-1083.48 124138.5,-1083.48"/>
</g>
<!-- L13_S1_TP3_GPU11_attn_v&#45;&gt;L13_S1_TP6_GPU14_mha_ar -->
<g id="edge4097" class="edge">
<title>L13_S1_TP3_GPU11_attn_v&#45;&gt;L13_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M123075,-1184.91C123075,-1194.32 123075,-1202 123075,-1202 123075,-1202 125091,-1202 125091,-1202 125091,-1202 125091,-1090.68 125091,-1090.68"/>
<polygon fill="black" stroke="black" points="125094.5,-1090.68 125091,-1080.68 125087.5,-1090.68 125094.5,-1090.68"/>
</g>
<!-- L13_S1_TP3_GPU11_attn_v&#45;&gt;L13_S1_TP7_GPU15_mha_ar -->
<g id="edge4133" class="edge">
<title>L13_S1_TP3_GPU11_attn_v&#45;&gt;L13_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M122958.58,-1116.35C122958.58,-1112.54 122958.58,-1110 122958.58,-1110 122958.58,-1110 125769.76,-1110 125769.76,-1110 125769.76,-1110 125769.76,-1088.96 125769.76,-1088.96"/>
<polygon fill="black" stroke="black" points="125773.26,-1088.96 125769.76,-1078.96 125766.26,-1088.96 125773.26,-1088.96"/>
</g>
<!-- L13_S1_TP4_GPU12_attn_v -->
<g id="node1372" class="node">
<title>L13_S1_TP4_GPU12_attn_v</title>
<polygon fill="none" stroke="black" points="124129,-1184.67 123191,-1184.67 123191,-1116.67 124129,-1116.67 124129,-1184.67"/>
<text text-anchor="middle" x="123660" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="123660" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="123660" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="123660" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L13_S1_TP4_GPU12_attn_v&#45;&gt;L13_S1_TP0_GPU8_mha_ar -->
<g id="edge3882" class="edge">
<title>L13_S1_TP4_GPU12_attn_v&#45;&gt;L13_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M123298.8,-1116.35C123298.8,-1112.54 123298.8,-1110 123298.8,-1110 123298.8,-1110 120594.74,-1110 120594.74,-1110 120594.74,-1110 120594.74,-1088.96 120594.74,-1088.96"/>
<polygon fill="black" stroke="black" points="120598.24,-1088.96 120594.74,-1078.96 120591.24,-1088.96 120598.24,-1088.96"/>
</g>
<!-- L13_S1_TP4_GPU12_attn_v&#45;&gt;L13_S1_TP1_GPU9_mha_ar -->
<g id="edge3918" class="edge">
<title>L13_S1_TP4_GPU12_attn_v&#45;&gt;L13_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M123267.33,-1184.83C123267.33,-1191.77 123267.33,-1197 123267.33,-1197 123267.33,-1197 121270,-1197 121270,-1197 121270,-1197 121270,-1091.02 121270,-1091.02"/>
<polygon fill="black" stroke="black" points="121273.5,-1091.02 121270,-1081.02 121266.5,-1091.02 121273.5,-1091.02"/>
</g>
<!-- L13_S1_TP4_GPU12_attn_v&#45;&gt;L13_S1_TP2_GPU10_mha_ar -->
<g id="edge3954" class="edge">
<title>L13_S1_TP4_GPU12_attn_v&#45;&gt;L13_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M123229.17,-1185.07C123229.17,-1186.9 123229.17,-1188 123229.17,-1188 123229.17,-1188 122230.5,-1188 122230.5,-1188 122230.5,-1188 122230.5,-1083.42 122230.5,-1083.42"/>
<polygon fill="black" stroke="black" points="122234,-1083.42 122230.5,-1073.42 122227,-1083.42 122234,-1083.42"/>
</g>
<!-- L13_S1_TP4_GPU12_attn_v&#45;&gt;L13_S1_TP3_GPU11_mha_ar -->
<g id="edge3990" class="edge">
<title>L13_S1_TP4_GPU12_attn_v&#45;&gt;L13_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M123190.95,-1139C123182.98,-1139 123178.57,-1139 123178.57,-1139 123178.57,-1139 123178.57,-1016 123178.57,-1016 123178.57,-1016 123160.58,-1016 123160.58,-1016"/>
<polygon fill="black" stroke="black" points="123160.58,-1012.5 123150.58,-1016 123160.58,-1019.5 123160.58,-1012.5"/>
</g>
<!-- L13_S1_TP4_GPU12_attn_v&#45;&gt;L13_S1_TP4_GPU12_mha_ar -->
<g id="edge4026" class="edge">
<title>L13_S1_TP4_GPU12_attn_v&#45;&gt;L13_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M123513.36,-1116.51C123513.36,-1116.51 123513.36,-1090.27 123513.36,-1090.27"/>
<polygon fill="black" stroke="black" points="123516.86,-1090.27 123513.36,-1080.27 123509.86,-1090.27 123516.86,-1090.27"/>
</g>
<!-- L13_S1_TP4_GPU12_attn_v&#45;&gt;L13_S1_TP5_GPU13_mha_ar -->
<g id="edge4062" class="edge">
<title>L13_S1_TP4_GPU12_attn_v&#45;&gt;L13_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M124044.76,-1116.51C124044.76,-1116.51 124044.76,-1073.04 124044.76,-1073.04"/>
<polygon fill="black" stroke="black" points="124048.26,-1073.04 124044.76,-1063.04 124041.26,-1073.04 124048.26,-1073.04"/>
</g>
<!-- L13_S1_TP4_GPU12_attn_v&#45;&gt;L13_S1_TP6_GPU14_mha_ar -->
<g id="edge4098" class="edge">
<title>L13_S1_TP4_GPU12_attn_v&#45;&gt;L13_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M124072.84,-1116.39C124072.84,-1116.14 124072.84,-1116 124072.84,-1116 124072.84,-1116 124907.26,-1116 124907.26,-1116 124907.26,-1116 124907.26,-1083.8 124907.26,-1083.8"/>
<polygon fill="black" stroke="black" points="124910.76,-1083.8 124907.26,-1073.8 124903.76,-1083.8 124910.76,-1083.8"/>
</g>
<!-- L13_S1_TP4_GPU12_attn_v&#45;&gt;L13_S1_TP7_GPU15_mha_ar -->
<g id="edge4134" class="edge">
<title>L13_S1_TP4_GPU12_attn_v&#45;&gt;L13_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M124100.92,-1116.39C124100.92,-1116.14 124100.92,-1116 124100.92,-1116 124100.92,-1116 125837.57,-1116 125837.57,-1116 125837.57,-1116 125837.57,-1090.62 125837.57,-1090.62"/>
<polygon fill="black" stroke="black" points="125841.07,-1090.62 125837.57,-1080.62 125834.07,-1090.62 125841.07,-1090.62"/>
</g>
<!-- L13_S1_TP5_GPU13_attn_v -->
<g id="node1373" class="node">
<title>L13_S1_TP5_GPU13_attn_v</title>
<polygon fill="none" stroke="black" points="125085,-1184.67 124147,-1184.67 124147,-1116.67 125085,-1116.67 125085,-1184.67"/>
<text text-anchor="middle" x="124616" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="124616" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="124616" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="124616" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L13_S1_TP5_GPU13_attn_v&#45;&gt;L13_S1_TP0_GPU8_mha_ar -->
<g id="edge3883" class="edge">
<title>L13_S1_TP5_GPU13_attn_v&#45;&gt;L13_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M124217.56,-1116.35C124217.56,-1112.54 124217.56,-1110 124217.56,-1110 124217.56,-1110 120662.67,-1110 120662.67,-1110 120662.67,-1110 120662.67,-1085.37 120662.67,-1085.37"/>
<polygon fill="black" stroke="black" points="120666.17,-1085.37 120662.67,-1075.37 120659.17,-1085.37 120666.17,-1085.37"/>
</g>
<!-- L13_S1_TP5_GPU13_attn_v&#45;&gt;L13_S1_TP1_GPU9_mha_ar -->
<g id="edge3919" class="edge">
<title>L13_S1_TP5_GPU13_attn_v&#45;&gt;L13_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M124288.12,-1116.35C124288.12,-1112.54 124288.12,-1110 124288.12,-1110 124288.12,-1110 121482.7,-1110 121482.7,-1110 121482.7,-1110 121482.7,-1081.75 121482.7,-1081.75"/>
<polygon fill="black" stroke="black" points="121486.2,-1081.74 121482.7,-1071.75 121479.2,-1081.75 121486.2,-1081.74"/>
</g>
<!-- L13_S1_TP5_GPU13_attn_v&#45;&gt;L13_S1_TP2_GPU10_mha_ar -->
<g id="edge3955" class="edge">
<title>L13_S1_TP5_GPU13_attn_v&#45;&gt;L13_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M124223.25,-1184.77C124223.25,-1195.68 124223.25,-1205 124223.25,-1205 124223.25,-1205 122226,-1205 122226,-1205 122226,-1205 122226,-1083.88 122226,-1083.88"/>
<polygon fill="black" stroke="black" points="122229.5,-1083.88 122226,-1073.88 122222.5,-1083.88 122229.5,-1083.88"/>
</g>
<!-- L13_S1_TP5_GPU13_attn_v&#45;&gt;L13_S1_TP3_GPU11_mha_ar -->
<g id="edge3991" class="edge">
<title>L13_S1_TP5_GPU13_attn_v&#45;&gt;L13_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M124358.68,-1116.35C124358.68,-1112.54 124358.68,-1110 124358.68,-1110 124358.68,-1110 123065.79,-1110 123065.79,-1110 123065.79,-1110 123065.79,-1076.31 123065.79,-1076.31"/>
<polygon fill="black" stroke="black" points="123069.29,-1076.31 123065.79,-1066.31 123062.29,-1076.31 123069.29,-1076.31"/>
</g>
<!-- L13_S1_TP5_GPU13_attn_v&#45;&gt;L13_S1_TP4_GPU12_mha_ar -->
<g id="edge4027" class="edge">
<title>L13_S1_TP5_GPU13_attn_v&#45;&gt;L13_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M124429.24,-1116.29C124429.24,-1100.41 124429.24,-1085 124429.24,-1085 124429.24,-1085 123620.64,-1085 123620.64,-1085 123620.64,-1085 123620.64,-1084.55 123620.64,-1084.55"/>
<polygon fill="black" stroke="black" points="123624.14,-1090.53 123620.64,-1080.53 123617.14,-1090.53 123624.14,-1090.53"/>
</g>
<!-- L13_S1_TP5_GPU13_attn_v&#45;&gt;L13_S1_TP5_GPU13_mha_ar -->
<g id="edge4063" class="edge">
<title>L13_S1_TP5_GPU13_attn_v&#45;&gt;L13_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M124499.8,-1116.51C124499.8,-1116.51 124499.8,-1085.92 124499.8,-1085.92"/>
<polygon fill="black" stroke="black" points="124503.3,-1085.92 124499.8,-1075.92 124496.3,-1085.92 124503.3,-1085.92"/>
</g>
<!-- L13_S1_TP5_GPU13_attn_v&#45;&gt;L13_S1_TP6_GPU14_mha_ar -->
<g id="edge4099" class="edge">
<title>L13_S1_TP5_GPU13_attn_v&#45;&gt;L13_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M124966.51,-1116.51C124966.51,-1116.51 124966.51,-1087.65 124966.51,-1087.65"/>
<polygon fill="black" stroke="black" points="124970.01,-1087.65 124966.51,-1077.65 124963.01,-1087.65 124970.01,-1087.65"/>
</g>
<!-- L13_S1_TP5_GPU13_attn_v&#45;&gt;L13_S1_TP7_GPU15_mha_ar -->
<g id="edge4135" class="edge">
<title>L13_S1_TP5_GPU13_attn_v&#45;&gt;L13_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M125025.75,-1116.39C125025.75,-1116.14 125025.75,-1116 125025.75,-1116 125025.75,-1116 125905.38,-1116 125905.38,-1116 125905.38,-1116 125905.38,-1090.62 125905.38,-1090.62"/>
<polygon fill="black" stroke="black" points="125908.88,-1090.62 125905.38,-1080.62 125901.88,-1090.62 125908.88,-1090.62"/>
</g>
<!-- L13_S1_TP6_GPU14_attn_v -->
<g id="node1374" class="node">
<title>L13_S1_TP6_GPU14_attn_v</title>
<polygon fill="none" stroke="black" points="126041,-1184.67 125103,-1184.67 125103,-1116.67 126041,-1116.67 126041,-1184.67"/>
<text text-anchor="middle" x="125572" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="125572" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="125572" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="125572" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L13_S1_TP6_GPU14_attn_v&#45;&gt;L13_S1_TP0_GPU8_mha_ar -->
<g id="edge3884" class="edge">
<title>L13_S1_TP6_GPU14_attn_v&#45;&gt;L13_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M125150.18,-1116.35C125150.18,-1112.54 125150.18,-1110 125150.18,-1110 125150.18,-1110 120730.61,-1110 120730.61,-1110 120730.61,-1110 120730.61,-1079.93 120730.61,-1079.93"/>
<polygon fill="black" stroke="black" points="120734.11,-1079.93 120730.61,-1069.93 120727.11,-1079.93 120734.11,-1079.93"/>
</g>
<!-- L13_S1_TP6_GPU14_attn_v&#45;&gt;L13_S1_TP1_GPU9_mha_ar -->
<g id="edge3920" class="edge">
<title>L13_S1_TP6_GPU14_attn_v&#45;&gt;L13_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M125197.37,-1116.64C125197.37,-1112.12 125197.37,-1109 125197.37,-1109 125197.37,-1109 121533.62,-1109 121533.62,-1109 121533.62,-1109 121533.62,-1075.88 121533.62,-1075.88"/>
<polygon fill="black" stroke="black" points="121537.12,-1075.88 121533.62,-1065.88 121530.12,-1075.88 121537.12,-1075.88"/>
</g>
<!-- L13_S1_TP6_GPU14_attn_v&#45;&gt;L13_S1_TP2_GPU10_mha_ar -->
<g id="edge3956" class="edge">
<title>L13_S1_TP6_GPU14_attn_v&#45;&gt;L13_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M125244.55,-1116.64C125244.55,-1112.12 125244.55,-1109 125244.55,-1109 125244.55,-1109 122370.58,-1109 122370.58,-1109 122370.58,-1109 122370.58,-1062.66 122370.58,-1062.66"/>
<polygon fill="black" stroke="black" points="122374.08,-1062.66 122370.58,-1052.66 122367.08,-1062.66 122374.08,-1062.66"/>
</g>
<!-- L13_S1_TP6_GPU14_attn_v&#45;&gt;L13_S1_TP3_GPU11_mha_ar -->
<g id="edge3992" class="edge">
<title>L13_S1_TP6_GPU14_attn_v&#45;&gt;L13_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M125489.5,-1116.5C125489.5,-1062.13 125489.5,-962 125489.5,-962 125489.5,-962 123144.82,-962 123144.82,-962 123144.82,-962 123144.82,-1004.04 123144.82,-1004.04"/>
<polygon fill="black" stroke="black" points="123141.32,-1004.04 123144.82,-1014.04 123148.32,-1004.04 123141.32,-1004.04"/>
</g>
<!-- L13_S1_TP6_GPU14_attn_v&#45;&gt;L13_S1_TP4_GPU12_mha_ar -->
<g id="edge4028" class="edge">
<title>L13_S1_TP6_GPU14_attn_v&#45;&gt;L13_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M125291.74,-1116.29C125291.74,-1100.41 125291.74,-1085 125291.74,-1085 125291.74,-1085 123727.92,-1085 123727.92,-1085 123727.92,-1085 123727.92,-1084.13 123727.92,-1084.13"/>
<polygon fill="black" stroke="black" points="123731.42,-1086.34 123727.92,-1076.34 123724.42,-1086.34 123731.42,-1086.34"/>
</g>
<!-- L13_S1_TP6_GPU14_attn_v&#45;&gt;L13_S1_TP5_GPU13_mha_ar -->
<g id="edge4064" class="edge">
<title>L13_S1_TP6_GPU14_attn_v&#45;&gt;L13_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M125338.92,-1116.29C125338.92,-1100.41 125338.92,-1085 125338.92,-1085 125338.92,-1085 124570.36,-1085 124570.36,-1085 124570.36,-1085 124570.36,-1080.4 124570.36,-1080.4"/>
<polygon fill="black" stroke="black" points="124573.86,-1080.4 124570.36,-1070.4 124566.86,-1080.4 124573.86,-1080.4"/>
</g>
<!-- L13_S1_TP6_GPU14_attn_v&#45;&gt;L13_S1_TP6_GPU14_mha_ar -->
<g id="edge4100" class="edge">
<title>L13_S1_TP6_GPU14_attn_v&#45;&gt;L13_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M125386.11,-1116.51C125386.11,-1116.51 125386.11,-1074.64 125386.11,-1074.64"/>
<polygon fill="black" stroke="black" points="125389.61,-1074.64 125386.11,-1064.64 125382.61,-1074.64 125389.61,-1074.64"/>
</g>
<!-- L13_S1_TP6_GPU14_attn_v&#45;&gt;L13_S1_TP7_GPU15_mha_ar -->
<g id="edge4136" class="edge">
<title>L13_S1_TP6_GPU14_attn_v&#45;&gt;L13_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M125973.19,-1116.51C125973.19,-1116.51 125973.19,-1088.96 125973.19,-1088.96"/>
<polygon fill="black" stroke="black" points="125976.69,-1088.96 125973.19,-1078.96 125969.69,-1088.96 125976.69,-1088.96"/>
</g>
<!-- L13_S1_TP7_GPU15_attn_v -->
<g id="node1375" class="node">
<title>L13_S1_TP7_GPU15_attn_v</title>
<polygon fill="none" stroke="black" points="126997,-1184.67 126059,-1184.67 126059,-1116.67 126997,-1116.67 126997,-1184.67"/>
<text text-anchor="middle" x="126528" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="126528" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="126528" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="126528" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L13_S1_TP7_GPU15_attn_v&#45;&gt;L13_S1_TP0_GPU8_mha_ar -->
<g id="edge3885" class="edge">
<title>L13_S1_TP7_GPU15_attn_v&#45;&gt;L13_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M126086.21,-1116.64C126086.21,-1112.12 126086.21,-1109 126086.21,-1109 126086.21,-1109 120798.54,-1109 120798.54,-1109 120798.54,-1109 120798.54,-1070.17 120798.54,-1070.17"/>
<polygon fill="black" stroke="black" points="120802.04,-1070.17 120798.54,-1060.17 120795.04,-1070.17 120802.04,-1070.17"/>
</g>
<!-- L13_S1_TP7_GPU15_attn_v&#45;&gt;L13_S1_TP1_GPU9_mha_ar -->
<g id="edge3921" class="edge">
<title>L13_S1_TP7_GPU15_attn_v&#45;&gt;L13_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M126113.42,-1116.64C126113.42,-1112.12 126113.42,-1109 126113.42,-1109 126113.42,-1109 121584.55,-1109 121584.55,-1109 121584.55,-1109 121584.55,-1066.76 121584.55,-1066.76"/>
<polygon fill="black" stroke="black" points="121588.05,-1066.76 121584.55,-1056.76 121581.05,-1066.76 121588.05,-1066.76"/>
</g>
<!-- L13_S1_TP7_GPU15_attn_v&#45;&gt;L13_S1_TP2_GPU10_mha_ar -->
<g id="edge3957" class="edge">
<title>L13_S1_TP7_GPU15_attn_v&#45;&gt;L13_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M126199.75,-1184.71C126199.75,-1198.4 126199.75,-1211 126199.75,-1211 126199.75,-1211 122221.5,-1211 122221.5,-1211 122221.5,-1211 122221.5,-1083.96 122221.5,-1083.96"/>
<polygon fill="black" stroke="black" points="122225,-1083.96 122221.5,-1073.96 122218,-1083.96 122225,-1083.96"/>
</g>
<!-- L13_S1_TP7_GPU15_attn_v&#45;&gt;L13_S1_TP3_GPU11_mha_ar -->
<g id="edge3993" class="edge">
<title>L13_S1_TP7_GPU15_attn_v&#45;&gt;L13_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M126285.49,-1116.5C126285.49,-1062.13 126285.49,-962 126285.49,-962 126285.49,-962 123116.16,-962 123116.16,-962 123116.16,-962 123116.16,-996.7 123116.16,-996.7"/>
<polygon fill="black" stroke="black" points="123112.66,-996.7 123116.16,-1006.7 123119.66,-996.7 123112.66,-996.7"/>
</g>
<!-- L13_S1_TP7_GPU15_attn_v&#45;&gt;L13_S1_TP4_GPU12_mha_ar -->
<g id="edge4029" class="edge">
<title>L13_S1_TP7_GPU15_attn_v&#45;&gt;L13_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M126140.63,-1116.29C126140.63,-1100.41 126140.63,-1085 126140.63,-1085 126140.63,-1085 123835.2,-1085 123835.2,-1085 123835.2,-1085 123835.2,-1076.37 123835.2,-1076.37"/>
<polygon fill="black" stroke="black" points="123838.7,-1076.37 123835.2,-1066.37 123831.7,-1076.37 123838.7,-1076.37"/>
</g>
<!-- L13_S1_TP7_GPU15_attn_v&#45;&gt;L13_S1_TP5_GPU13_mha_ar -->
<g id="edge4065" class="edge">
<title>L13_S1_TP7_GPU15_attn_v&#45;&gt;L13_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M126167.84,-1116.29C126167.84,-1100.41 126167.84,-1085 126167.84,-1085 126167.84,-1085 124640.91,-1085 124640.91,-1085 124640.91,-1085 124640.91,-1070.94 124640.91,-1070.94"/>
<polygon fill="black" stroke="black" points="124644.41,-1070.94 124640.91,-1060.94 124637.41,-1070.94 124644.41,-1070.94"/>
</g>
<!-- L13_S1_TP7_GPU15_attn_v&#45;&gt;L13_S1_TP6_GPU14_mha_ar -->
<g id="edge4101" class="edge">
<title>L13_S1_TP7_GPU15_attn_v&#45;&gt;L13_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M126195.05,-1116.29C126195.05,-1100.41 126195.05,-1085 126195.05,-1085 126195.05,-1085 125433.29,-1085 125433.29,-1085 125433.29,-1085 125433.29,-1066.03 125433.29,-1066.03"/>
<polygon fill="black" stroke="black" points="125436.79,-1066.03 125433.29,-1056.03 125429.79,-1066.03 125436.79,-1066.03"/>
</g>
<!-- L13_S1_TP7_GPU15_attn_v&#45;&gt;L13_S1_TP7_GPU15_mha_ar -->
<g id="edge4137" class="edge">
<title>L13_S1_TP7_GPU15_attn_v&#45;&gt;L13_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M126222.26,-1116.51C126222.26,-1116.51 126222.26,-1060.6 126222.26,-1060.6"/>
<polygon fill="black" stroke="black" points="126225.76,-1060.6 126222.26,-1050.6 126218.76,-1060.6 126225.76,-1060.6"/>
</g>
<!-- L13_S1_TP0_GPU8_gate -->
<g id="node1377" class="node">
<title>L13_S1_TP0_GPU8_gate</title>
<polygon fill="none" stroke="black" points="119939.56,-844.5 119097.15,-844.5 118880.44,-708.5 119722.85,-708.5 119939.56,-844.5"/>
<text text-anchor="middle" x="119410" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="119410" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="119410" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="119410" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L13_S1_TP0_GPU8_mha_res&#45;&gt;L13_S1_TP0_GPU8_gate -->
<g id="edge3887" class="edge">
<title>L13_S1_TP0_GPU8_mha_res&#45;&gt;L13_S1_TP0_GPU8_gate</title>
<path fill="none" stroke="black" d="M119410,-880.39C119410,-880.39 119410,-854.73 119410,-854.73"/>
<polygon fill="black" stroke="black" points="119413.5,-854.73 119410,-844.73 119406.5,-854.73 119413.5,-854.73"/>
</g>
<!-- L13_S1_TP0_GPU8_moe_res -->
<g id="node1395" class="node">
<title>L13_S1_TP0_GPU8_moe_res</title>
<polygon fill="none" stroke="black" points="119598,-436.33 118778,-436.33 118778,-368.33 119598,-368.33 119598,-436.33"/>
<text text-anchor="middle" x="119188" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="119188" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="119188" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="119188" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP0_GPU8_mha_res&#45;&gt;L13_S1_TP0_GPU8_moe_res -->
<g id="edge3907" class="edge">
<title>L13_S1_TP0_GPU8_mha_res&#45;&gt;L13_S1_TP0_GPU8_moe_res</title>
<path fill="none" stroke="black" d="M118966.4,-903C118887.08,-903 118829.11,-903 118829.11,-903 118829.11,-903 118829.11,-446.35 118829.11,-446.35"/>
<polygon fill="black" stroke="black" points="118832.61,-446.35 118829.11,-436.35 118825.61,-446.35 118832.61,-446.35"/>
</g>
<!-- L13_S1_TP0_GPU8_expert0 -->
<g id="node1378" class="node">
<title>L13_S1_TP0_GPU8_expert0</title>
<polygon fill="none" stroke="black" points="119904.5,-672.5 119455.5,-672.5 119455.5,-604.5 119904.5,-604.5 119904.5,-672.5"/>
<text text-anchor="middle" x="119680" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="119680" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="119680" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="119680" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L13_S1_TP0_GPU8_gate&#45;&gt;L13_S1_TP0_GPU8_expert0 -->
<g id="edge3888" class="edge">
<title>L13_S1_TP0_GPU8_gate&#45;&gt;L13_S1_TP0_GPU8_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M119680,-708.31C119680,-708.31 119680,-682.71 119680,-682.71"/>
<polygon fill="black" stroke="black" points="119683.5,-682.71 119680,-672.71 119676.5,-682.71 119683.5,-682.71"/>
</g>
<!-- L13_S1_TP0_GPU8_expert1 -->
<g id="node1379" class="node">
<title>L13_S1_TP0_GPU8_expert1</title>
<polygon fill="none" stroke="black" points="120371.5,-672.5 119922.5,-672.5 119922.5,-604.5 120371.5,-604.5 120371.5,-672.5"/>
<text text-anchor="middle" x="120147" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="120147" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="120147" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="120147" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L13_S1_TP0_GPU8_gate&#45;&gt;L13_S1_TP0_GPU8_expert1 -->
<g id="edge3889" class="edge">
<title>L13_S1_TP0_GPU8_gate&#45;&gt;L13_S1_TP0_GPU8_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M119931.14,-776.4C119931.14,-776.4 119931.14,-682.74 119931.14,-682.74"/>
<polygon fill="black" stroke="black" points="119934.64,-682.74 119931.14,-672.74 119927.64,-682.74 119934.64,-682.74"/>
</g>
<!-- L13_S1_TP0_GPU8_moe_ar -->
<g id="node1380" class="node">
<title>L13_S1_TP0_GPU8_moe_ar</title>
<ellipse fill="none" stroke="black" cx="120777" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="120777" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="120777" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="120777" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="120777" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP0_GPU8_expert0&#45;&gt;L13_S1_TP0_GPU8_moe_ar -->
<g id="edge3890" class="edge">
<title>L13_S1_TP0_GPU8_expert0&#45;&gt;L13_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M119870.44,-604.37C119870.44,-563.08 119870.44,-499 119870.44,-499 119870.44,-499 120467.33,-499 120467.33,-499"/>
<polygon fill="black" stroke="black" points="120467.33,-502.5 120477.33,-499 120467.33,-495.5 120467.33,-502.5"/>
</g>
<!-- L13_S1_TP1_GPU9_moe_ar -->
<g id="node1404" class="node">
<title>L13_S1_TP1_GPU9_moe_ar</title>
<ellipse fill="none" stroke="black" cx="121464" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="121464" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="121464" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="121464" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="121464" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP0_GPU8_expert0&#45;&gt;L13_S1_TP1_GPU9_moe_ar -->
<g id="edge3926" class="edge">
<title>L13_S1_TP0_GPU8_expert0&#45;&gt;L13_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M119632.06,-604.49C119632.06,-586.46 119632.06,-568 119632.06,-568 119632.06,-568 121149.09,-568 121149.09,-568 121149.09,-568 121149.09,-546.79 121149.09,-546.79"/>
<polygon fill="black" stroke="black" points="121152.59,-546.79 121149.09,-536.79 121145.59,-546.79 121152.59,-546.79"/>
</g>
<!-- L13_S1_TP2_GPU10_moe_ar -->
<g id="node1414" class="node">
<title>L13_S1_TP2_GPU10_moe_ar</title>
<ellipse fill="none" stroke="black" cx="122151" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="122151" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="122151" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="122151" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="122151" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP0_GPU8_expert0&#45;&gt;L13_S1_TP2_GPU10_moe_ar -->
<g id="edge3962" class="edge">
<title>L13_S1_TP0_GPU8_expert0&#45;&gt;L13_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M119836.39,-604.49C119836.39,-547.28 119836.39,-438 119836.39,-438 119836.39,-438 121875.77,-438 121875.77,-438 121875.77,-438 121875.77,-482.97 121875.77,-482.97"/>
<polygon fill="black" stroke="black" points="121872.27,-482.97 121875.77,-492.97 121879.27,-482.97 121872.27,-482.97"/>
</g>
<!-- L13_S1_TP3_GPU11_moe_ar -->
<g id="node1424" class="node">
<title>L13_S1_TP3_GPU11_moe_ar</title>
<ellipse fill="none" stroke="black" cx="122838" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="122838" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="122838" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="122838" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="122838" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP0_GPU8_expert0&#45;&gt;L13_S1_TP3_GPU11_moe_ar -->
<g id="edge3998" class="edge">
<title>L13_S1_TP0_GPU8_expert0&#45;&gt;L13_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M119802.33,-604.49C119802.33,-547.28 119802.33,-438 119802.33,-438 119802.33,-438 122681.27,-438 122681.27,-438 122681.27,-438 122681.27,-467.76 122681.27,-467.76"/>
<polygon fill="black" stroke="black" points="122677.77,-467.76 122681.27,-477.76 122684.77,-467.76 122677.77,-467.76"/>
</g>
<!-- L13_S1_TP4_GPU12_moe_ar -->
<g id="node1434" class="node">
<title>L13_S1_TP4_GPU12_moe_ar</title>
<ellipse fill="none" stroke="black" cx="123525" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="123525" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="123525" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="123525" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="123525" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP0_GPU8_expert0&#45;&gt;L13_S1_TP4_GPU12_moe_ar -->
<g id="edge4034" class="edge">
<title>L13_S1_TP0_GPU8_expert0&#45;&gt;L13_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M119768.28,-604.49C119768.28,-547.28 119768.28,-438 119768.28,-438 119768.28,-438 123417.82,-438 123417.82,-438 123417.82,-438 123417.82,-464.39 123417.82,-464.39"/>
<polygon fill="black" stroke="black" points="123414.32,-464.39 123417.82,-474.39 123421.32,-464.39 123414.32,-464.39"/>
</g>
<!-- L13_S1_TP5_GPU13_moe_ar -->
<g id="node1444" class="node">
<title>L13_S1_TP5_GPU13_moe_ar</title>
<ellipse fill="none" stroke="black" cx="124212" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="124212" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="124212" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="124212" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="124212" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP0_GPU8_expert0&#45;&gt;L13_S1_TP5_GPU13_moe_ar -->
<g id="edge4070" class="edge">
<title>L13_S1_TP0_GPU8_expert0&#45;&gt;L13_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M119734.22,-604.49C119734.22,-547.28 119734.22,-438 119734.22,-438 119734.22,-438 123989.11,-438 123989.11,-438 123989.11,-438 123989.11,-474.51 123989.11,-474.51"/>
<polygon fill="black" stroke="black" points="123985.61,-474.51 123989.11,-484.51 123992.61,-474.51 123985.61,-474.51"/>
</g>
<!-- L13_S1_TP6_GPU14_moe_ar -->
<g id="node1454" class="node">
<title>L13_S1_TP6_GPU14_moe_ar</title>
<ellipse fill="none" stroke="black" cx="124899" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="124899" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="124899" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="124899" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="124899" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP0_GPU8_expert0&#45;&gt;L13_S1_TP6_GPU14_moe_ar -->
<g id="edge4106" class="edge">
<title>L13_S1_TP0_GPU8_expert0&#45;&gt;L13_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M119700.17,-604.49C119700.17,-547.28 119700.17,-438 119700.17,-438 119700.17,-438 125010.49,-438 125010.49,-438 125010.49,-438 125010.49,-464.87 125010.49,-464.87"/>
<polygon fill="black" stroke="black" points="125006.99,-464.87 125010.49,-474.87 125013.99,-464.87 125006.99,-464.87"/>
</g>
<!-- L13_S1_TP7_GPU15_moe_ar -->
<g id="node1464" class="node">
<title>L13_S1_TP7_GPU15_moe_ar</title>
<ellipse fill="none" stroke="black" cx="125586" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="125586" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="125586" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="125586" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="125586" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP0_GPU8_expert0&#45;&gt;L13_S1_TP7_GPU15_moe_ar -->
<g id="edge4142" class="edge">
<title>L13_S1_TP0_GPU8_expert0&#45;&gt;L13_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M119666.11,-604.16C119666.11,-586.65 119666.11,-569 119666.11,-569 119666.11,-569 125277.23,-569 125277.23,-569 125277.23,-569 125277.23,-549.06 125277.23,-549.06"/>
<polygon fill="black" stroke="black" points="125280.73,-549.06 125277.23,-539.06 125273.73,-549.06 125280.73,-549.06"/>
</g>
<!-- L13_S1_TP0_GPU8_expert1&#45;&gt;L13_S1_TP0_GPU8_moe_ar -->
<g id="edge3891" class="edge">
<title>L13_S1_TP0_GPU8_expert1&#45;&gt;L13_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M120341.89,-604.21C120341.89,-567.05 120341.89,-513 120341.89,-513 120341.89,-513 120436.39,-513 120436.39,-513"/>
<polygon fill="black" stroke="black" points="120436.39,-516.5 120446.39,-513 120436.39,-509.5 120436.39,-516.5"/>
</g>
<!-- L13_S1_TP0_GPU8_expert1&#45;&gt;L13_S1_TP1_GPU9_moe_ar -->
<g id="edge3927" class="edge">
<title>L13_S1_TP0_GPU8_expert1&#45;&gt;L13_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M120134.61,-604.49C120134.61,-586.46 120134.61,-568 120134.61,-568 120134.61,-568 121168.64,-568 121168.64,-568 121168.64,-568 121168.64,-553.09 121168.64,-553.09"/>
<polygon fill="black" stroke="black" points="121172.14,-553.09 121168.64,-543.09 121165.14,-553.09 121172.14,-553.09"/>
</g>
<!-- L13_S1_TP0_GPU8_expert1&#45;&gt;L13_S1_TP2_GPU10_moe_ar -->
<g id="edge3963" class="edge">
<title>L13_S1_TP0_GPU8_expert1&#45;&gt;L13_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M120312.28,-604.2C120312.28,-547.16 120312.28,-439 120312.28,-439 120312.28,-439 121846.15,-439 121846.15,-439 121846.15,-439 121846.15,-490.29 121846.15,-490.29"/>
<polygon fill="black" stroke="black" points="121842.65,-490.29 121846.15,-500.29 121849.65,-490.29 121842.65,-490.29"/>
</g>
<!-- L13_S1_TP0_GPU8_expert1&#45;&gt;L13_S1_TP3_GPU11_moe_ar -->
<g id="edge3999" class="edge">
<title>L13_S1_TP0_GPU8_expert1&#45;&gt;L13_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M120282.67,-604.49C120282.67,-547.28 120282.67,-438 120282.67,-438 120282.67,-438 122592.4,-438 122592.4,-438 122592.4,-438 122592.4,-477.37 122592.4,-477.37"/>
<polygon fill="black" stroke="black" points="122588.9,-477.37 122592.4,-487.37 122595.9,-477.37 122588.9,-477.37"/>
</g>
<!-- L13_S1_TP0_GPU8_expert1&#45;&gt;L13_S1_TP4_GPU12_moe_ar -->
<g id="edge4035" class="edge">
<title>L13_S1_TP0_GPU8_expert1&#45;&gt;L13_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M120253.06,-604.49C120253.06,-547.28 120253.06,-438 120253.06,-438 120253.06,-438 123307.41,-438 123307.41,-438 123307.41,-438 123307.41,-473.55 123307.41,-473.55"/>
<polygon fill="black" stroke="black" points="123303.91,-473.55 123307.41,-483.55 123310.91,-473.55 123303.91,-473.55"/>
</g>
<!-- L13_S1_TP0_GPU8_expert1&#45;&gt;L13_S1_TP5_GPU13_moe_ar -->
<g id="edge4071" class="edge">
<title>L13_S1_TP0_GPU8_expert1&#45;&gt;L13_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M120223.44,-604.49C120223.44,-547.28 120223.44,-438 120223.44,-438 120223.44,-438 123961.22,-438 123961.22,-438 123961.22,-438 123961.22,-478.32 123961.22,-478.32"/>
<polygon fill="black" stroke="black" points="123957.72,-478.32 123961.22,-488.32 123964.72,-478.32 123957.72,-478.32"/>
</g>
<!-- L13_S1_TP0_GPU8_expert1&#45;&gt;L13_S1_TP6_GPU14_moe_ar -->
<g id="edge4107" class="edge">
<title>L13_S1_TP0_GPU8_expert1&#45;&gt;L13_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M120193.83,-604.49C120193.83,-547.28 120193.83,-438 120193.83,-438 120193.83,-438 124787.51,-438 124787.51,-438 124787.51,-438 124787.51,-464.87 124787.51,-464.87"/>
<polygon fill="black" stroke="black" points="124784.01,-464.87 124787.51,-474.87 124791.01,-464.87 124784.01,-464.87"/>
</g>
<!-- L13_S1_TP0_GPU8_expert1&#45;&gt;L13_S1_TP7_GPU15_moe_ar -->
<g id="edge4143" class="edge">
<title>L13_S1_TP0_GPU8_expert1&#45;&gt;L13_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M120164.22,-604.16C120164.22,-586.65 120164.22,-569 120164.22,-569 120164.22,-569 125302.93,-569 125302.93,-569 125302.93,-569 125302.93,-556.13 125302.93,-556.13"/>
<polygon fill="black" stroke="black" points="125306.43,-556.13 125302.93,-546.13 125299.43,-556.13 125306.43,-556.13"/>
</g>
<!-- L13_S1_TP0_GPU8_moe_ar&#45;&gt;L13_S1_TP0_GPU8_moe_res -->
<g id="edge3906" class="edge">
<title>L13_S1_TP0_GPU8_moe_ar&#45;&gt;L13_S1_TP0_GPU8_moe_res</title>
<path fill="none" stroke="black" d="M120543.3,-486C120181.44,-486 119526.75,-486 119526.75,-486 119526.75,-486 119526.75,-446.36 119526.75,-446.36"/>
<polygon fill="black" stroke="black" points="119530.25,-446.36 119526.75,-436.36 119523.25,-446.36 119530.25,-446.36"/>
</g>
<!-- L13_S1_TP1_GPU9_expert0 -->
<g id="node1381" class="node">
<title>L13_S1_TP1_GPU9_expert0</title>
<polygon fill="none" stroke="black" points="120838.5,-672.5 120389.5,-672.5 120389.5,-604.5 120838.5,-604.5 120838.5,-672.5"/>
<text text-anchor="middle" x="120614" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="120614" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="120614" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="120614" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L13_S1_TP1_GPU9_expert0&#45;&gt;L13_S1_TP0_GPU8_moe_ar -->
<g id="edge3892" class="edge">
<title>L13_S1_TP1_GPU9_expert0&#45;&gt;L13_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M120499.1,-604.34C120499.1,-604.34 120499.1,-557.38 120499.1,-557.38"/>
<polygon fill="black" stroke="black" points="120502.6,-557.38 120499.1,-547.38 120495.6,-557.38 120502.6,-557.38"/>
</g>
<!-- L13_S1_TP1_GPU9_expert0&#45;&gt;L13_S1_TP1_GPU9_moe_ar -->
<g id="edge3928" class="edge">
<title>L13_S1_TP1_GPU9_expert0&#45;&gt;L13_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M120555.67,-604.49C120555.67,-586.46 120555.67,-568 120555.67,-568 120555.67,-568 121188.19,-568 121188.19,-568 121188.19,-568 121188.19,-557.82 121188.19,-557.82"/>
<polygon fill="black" stroke="black" points="121191.69,-557.82 121188.19,-547.82 121184.69,-557.82 121191.69,-557.82"/>
</g>
<!-- L13_S1_TP1_GPU9_expert0&#45;&gt;L13_S1_TP2_GPU10_moe_ar -->
<g id="edge3964" class="edge">
<title>L13_S1_TP1_GPU9_expert0&#45;&gt;L13_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M120612.24,-604.49C120612.24,-586.46 120612.24,-568 120612.24,-568 120612.24,-568 121869.41,-568 121869.41,-568 121869.41,-568 121869.41,-556.44 121869.41,-556.44"/>
<polygon fill="black" stroke="black" points="121872.91,-556.44 121869.41,-546.44 121865.91,-556.44 121872.91,-556.44"/>
</g>
<!-- L13_S1_TP1_GPU9_expert0&#45;&gt;L13_S1_TP3_GPU11_moe_ar -->
<g id="edge4000" class="edge">
<title>L13_S1_TP1_GPU9_expert0&#45;&gt;L13_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M120668.8,-604.49C120668.8,-586.46 120668.8,-568 120668.8,-568 120668.8,-568 122528.91,-568 122528.91,-568 122528.91,-568 122528.91,-548.95 122528.91,-548.95"/>
<polygon fill="black" stroke="black" points="122532.41,-548.95 122528.91,-538.95 122525.41,-548.95 122532.41,-548.95"/>
</g>
<!-- L13_S1_TP1_GPU9_expert0&#45;&gt;L13_S1_TP4_GPU12_moe_ar -->
<g id="edge4036" class="edge">
<title>L13_S1_TP1_GPU9_expert0&#45;&gt;L13_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M120688.83,-672.64C120688.83,-688.11 120688.83,-703 120688.83,-703 120688.83,-703 123649.5,-703 123649.5,-703 123649.5,-703 123649.5,-575.08 123649.5,-575.08"/>
<polygon fill="black" stroke="black" points="123653,-575.08 123649.5,-565.08 123646,-575.08 123653,-575.08"/>
</g>
<!-- L13_S1_TP1_GPU9_expert0&#45;&gt;L13_S1_TP5_GPU13_moe_ar -->
<g id="edge4072" class="edge">
<title>L13_S1_TP1_GPU9_expert0&#45;&gt;L13_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M120416.02,-604.4C120416.02,-555.17 120416.02,-470 120416.02,-470 120416.02,-470 123933.32,-470 123933.32,-470 123933.32,-470 123933.32,-483.73 123933.32,-483.73"/>
<polygon fill="black" stroke="black" points="123929.82,-483.73 123933.32,-493.73 123936.82,-483.73 123929.82,-483.73"/>
</g>
<!-- L13_S1_TP1_GPU9_expert0&#45;&gt;L13_S1_TP6_GPU14_moe_ar -->
<g id="edge4108" class="edge">
<title>L13_S1_TP1_GPU9_expert0&#45;&gt;L13_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M120725.37,-604.16C120725.37,-586.65 120725.37,-569 120725.37,-569 120725.37,-569 124637.4,-569 124637.4,-569 124637.4,-569 124637.4,-560.63 124637.4,-560.63"/>
<polygon fill="black" stroke="black" points="124640.9,-560.63 124637.4,-550.63 124633.9,-560.63 124640.9,-560.63"/>
</g>
<!-- L13_S1_TP1_GPU9_expert0&#45;&gt;L13_S1_TP7_GPU15_moe_ar -->
<g id="edge4144" class="edge">
<title>L13_S1_TP1_GPU9_expert0&#45;&gt;L13_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M120781.93,-604.16C120781.93,-586.65 120781.93,-569 120781.93,-569 120781.93,-569 125328.63,-569 125328.63,-569 125328.63,-569 125328.63,-561.19 125328.63,-561.19"/>
<polygon fill="black" stroke="black" points="125332.13,-561.19 125328.63,-551.19 125325.13,-561.19 125332.13,-561.19"/>
</g>
<!-- L13_S1_TP1_GPU9_expert1 -->
<g id="node1382" class="node">
<title>L13_S1_TP1_GPU9_expert1</title>
<polygon fill="none" stroke="black" points="121305.5,-672.5 120856.5,-672.5 120856.5,-604.5 121305.5,-604.5 121305.5,-672.5"/>
<text text-anchor="middle" x="121081" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="121081" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="121081" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="121081" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L13_S1_TP1_GPU9_expert1&#45;&gt;L13_S1_TP0_GPU8_moe_ar -->
<g id="edge3893" class="edge">
<title>L13_S1_TP1_GPU9_expert1&#45;&gt;L13_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M120879.68,-604.34C120879.68,-604.34 120879.68,-576.36 120879.68,-576.36"/>
<polygon fill="black" stroke="black" points="120883.18,-576.36 120879.68,-566.36 120876.18,-576.36 120883.18,-576.36"/>
</g>
<!-- L13_S1_TP1_GPU9_expert1&#45;&gt;L13_S1_TP1_GPU9_moe_ar -->
<g id="edge3929" class="edge">
<title>L13_S1_TP1_GPU9_expert1&#45;&gt;L13_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M121207.74,-604.34C121207.74,-604.34 121207.74,-561.67 121207.74,-561.67"/>
<polygon fill="black" stroke="black" points="121211.24,-561.67 121207.74,-551.67 121204.24,-561.67 121211.24,-561.67"/>
</g>
<!-- L13_S1_TP1_GPU9_expert1&#45;&gt;L13_S1_TP2_GPU10_moe_ar -->
<g id="edge3965" class="edge">
<title>L13_S1_TP1_GPU9_expert1&#45;&gt;L13_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M121227.29,-604.49C121227.29,-586.46 121227.29,-568 121227.29,-568 121227.29,-568 121922.28,-568 121922.28,-568 121922.28,-568 121922.28,-565.99 121922.28,-565.99"/>
<polygon fill="black" stroke="black" points="121925.78,-565.99 121922.28,-555.99 121918.78,-565.99 121925.78,-565.99"/>
</g>
<!-- L13_S1_TP1_GPU9_expert1&#45;&gt;L13_S1_TP3_GPU11_moe_ar -->
<g id="edge4001" class="edge">
<title>L13_S1_TP1_GPU9_expert1&#45;&gt;L13_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M121246.85,-604.49C121246.85,-586.46 121246.85,-568 121246.85,-568 121246.85,-568 122554.28,-568 122554.28,-568 122554.28,-568 122554.28,-555.88 122554.28,-555.88"/>
<polygon fill="black" stroke="black" points="122557.78,-555.88 122554.28,-545.88 122550.78,-555.88 122557.78,-555.88"/>
</g>
<!-- L13_S1_TP1_GPU9_expert1&#45;&gt;L13_S1_TP4_GPU12_moe_ar -->
<g id="edge4037" class="edge">
<title>L13_S1_TP1_GPU9_expert1&#45;&gt;L13_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M121266.4,-604.16C121266.4,-586.65 121266.4,-569 121266.4,-569 121266.4,-569 123236.4,-569 123236.4,-569 123236.4,-569 123236.4,-554.99 123236.4,-554.99"/>
<polygon fill="black" stroke="black" points="123239.9,-554.99 123236.4,-544.99 123232.9,-554.99 123239.9,-554.99"/>
</g>
<!-- L13_S1_TP1_GPU9_expert1&#45;&gt;L13_S1_TP5_GPU13_moe_ar -->
<g id="edge4073" class="edge">
<title>L13_S1_TP1_GPU9_expert1&#45;&gt;L13_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M121122.27,-604.4C121122.27,-555.17 121122.27,-470 121122.27,-470 121122.27,-470 123905.43,-470 123905.43,-470 123905.43,-470 123905.43,-491.07 123905.43,-491.07"/>
<polygon fill="black" stroke="black" points="123901.93,-491.07 123905.43,-501.07 123908.93,-491.07 123901.93,-491.07"/>
</g>
<!-- L13_S1_TP1_GPU9_expert1&#45;&gt;L13_S1_TP6_GPU14_moe_ar -->
<g id="edge4109" class="edge">
<title>L13_S1_TP1_GPU9_expert1&#45;&gt;L13_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M121285.95,-604.25C121285.95,-587.12 121285.95,-570 121285.95,-570 121285.95,-570 124727.2,-570 124727.2,-570 124727.2,-570 124727.2,-569.18 124727.2,-569.18"/>
<polygon fill="black" stroke="black" points="124730.7,-571.81 124727.2,-561.81 124723.7,-571.81 124730.7,-571.81"/>
</g>
<!-- L13_S1_TP1_GPU9_expert1&#45;&gt;L13_S1_TP7_GPU15_moe_ar -->
<g id="edge4145" class="edge">
<title>L13_S1_TP1_GPU9_expert1&#45;&gt;L13_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M120902.86,-604.25C120902.86,-587.12 120902.86,-570 120902.86,-570 120902.86,-570 125354.32,-570 125354.32,-570 125354.32,-570 125354.32,-565.12 125354.32,-565.12"/>
<polygon fill="black" stroke="black" points="125357.82,-565.12 125354.32,-555.12 125350.82,-565.12 125357.82,-565.12"/>
</g>
<!-- L13_S1_TP2_GPU10_expert0 -->
<g id="node1383" class="node">
<title>L13_S1_TP2_GPU10_expert0</title>
<polygon fill="none" stroke="black" points="121772.5,-672.5 121323.5,-672.5 121323.5,-604.5 121772.5,-604.5 121772.5,-672.5"/>
<text text-anchor="middle" x="121548" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="121548" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="121548" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="121548" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L13_S1_TP2_GPU10_expert0&#45;&gt;L13_S1_TP0_GPU8_moe_ar -->
<g id="edge3894" class="edge">
<title>L13_S1_TP2_GPU10_expert0&#45;&gt;L13_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M121379.62,-603.88C121379.62,-603.31 121379.62,-603 121379.62,-603 121379.62,-603 120926.03,-603 120926.03,-603 120926.03,-603 120926.03,-573.64 120926.03,-573.64"/>
<polygon fill="black" stroke="black" points="120929.54,-573.64 120926.03,-563.64 120922.54,-573.64 120929.54,-573.64"/>
</g>
<!-- L13_S1_TP2_GPU10_expert0&#45;&gt;L13_S1_TP1_GPU9_moe_ar -->
<g id="edge3930" class="edge">
<title>L13_S1_TP2_GPU10_expert0&#45;&gt;L13_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M121435.75,-604.34C121435.75,-604.34 121435.75,-578.55 121435.75,-578.55"/>
<polygon fill="black" stroke="black" points="121439.25,-578.55 121435.75,-568.55 121432.25,-578.55 121439.25,-578.55"/>
</g>
<!-- L13_S1_TP2_GPU10_expert0&#45;&gt;L13_S1_TP2_GPU10_moe_ar -->
<g id="edge3966" class="edge">
<title>L13_S1_TP2_GPU10_expert0&#45;&gt;L13_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M121491.88,-604.49C121491.88,-586.46 121491.88,-568 121491.88,-568 121491.88,-568 121975.15,-568 121975.15,-568 121975.15,-568 121975.15,-567.34 121975.15,-567.34"/>
<polygon fill="black" stroke="black" points="121978.65,-571.38 121975.15,-561.38 121971.65,-571.38 121978.65,-571.38"/>
</g>
<!-- L13_S1_TP2_GPU10_expert0&#45;&gt;L13_S1_TP3_GPU11_moe_ar -->
<g id="edge4002" class="edge">
<title>L13_S1_TP2_GPU10_expert0&#45;&gt;L13_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M121548,-604.49C121548,-586.46 121548,-568 121548,-568 121548,-568 122579.65,-568 122579.65,-568 122579.65,-568 122579.65,-561.09 122579.65,-561.09"/>
<polygon fill="black" stroke="black" points="122583.15,-561.09 122579.65,-551.09 122576.15,-561.09 122583.15,-561.09"/>
</g>
<!-- L13_S1_TP2_GPU10_expert0&#45;&gt;L13_S1_TP4_GPU12_moe_ar -->
<g id="edge4038" class="edge">
<title>L13_S1_TP2_GPU10_expert0&#45;&gt;L13_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M121604.12,-604.16C121604.12,-586.65 121604.12,-569 121604.12,-569 121604.12,-569 123281.3,-569 123281.3,-569 123281.3,-569 123281.3,-563.36 123281.3,-563.36"/>
<polygon fill="black" stroke="black" points="123284.8,-563.36 123281.3,-553.36 123277.8,-563.36 123284.8,-563.36"/>
</g>
<!-- L13_S1_TP2_GPU10_expert0&#45;&gt;L13_S1_TP5_GPU13_moe_ar -->
<g id="edge4074" class="edge">
<title>L13_S1_TP2_GPU10_expert0&#45;&gt;L13_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M121660.25,-604.16C121660.25,-586.65 121660.25,-569 121660.25,-569 121660.25,-569 123903.09,-569 123903.09,-569 123903.09,-569 123903.09,-549.06 123903.09,-549.06"/>
<polygon fill="black" stroke="black" points="123906.59,-549.06 123903.09,-539.06 123899.59,-549.06 123906.59,-549.06"/>
</g>
<!-- L13_S1_TP2_GPU10_expert0&#45;&gt;L13_S1_TP6_GPU14_moe_ar -->
<g id="edge4110" class="edge">
<title>L13_S1_TP2_GPU10_expert0&#45;&gt;L13_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M121716.38,-604.25C121716.38,-587.12 121716.38,-570 121716.38,-570 121716.38,-570 124772.1,-570 124772.1,-570 124772.1,-570 124772.1,-569.51 124772.1,-569.51"/>
<polygon fill="black" stroke="black" points="124775.6,-575.06 124772.1,-565.06 124768.6,-575.06 124775.6,-575.06"/>
</g>
<!-- L13_S1_TP2_GPU10_expert0&#45;&gt;L13_S1_TP7_GPU15_moe_ar -->
<g id="edge4146" class="edge">
<title>L13_S1_TP2_GPU10_expert0&#45;&gt;L13_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M121622.83,-672.75C121622.83,-689.87 121622.83,-707 121622.83,-707 121622.83,-707 125522.9,-707 125522.9,-707 125522.9,-707 125522.9,-577.98 125522.9,-577.98"/>
<polygon fill="black" stroke="black" points="125526.4,-577.98 125522.9,-567.98 125519.4,-577.98 125526.4,-577.98"/>
</g>
<!-- L13_S1_TP2_GPU10_expert1 -->
<g id="node1384" class="node">
<title>L13_S1_TP2_GPU10_expert1</title>
<polygon fill="none" stroke="black" points="122239.5,-672.5 121790.5,-672.5 121790.5,-604.5 122239.5,-604.5 122239.5,-672.5"/>
<text text-anchor="middle" x="122015" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="122015" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="122015" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="122015" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L13_S1_TP2_GPU10_expert1&#45;&gt;L13_S1_TP0_GPU8_moe_ar -->
<g id="edge3895" class="edge">
<title>L13_S1_TP2_GPU10_expert1&#45;&gt;L13_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M121804.49,-604.47C121804.49,-588.11 121804.49,-572 121804.49,-572 121804.49,-572 120949.21,-572 120949.21,-572 120949.21,-572 120949.21,-570.98 120949.21,-570.98"/>
<polygon fill="black" stroke="black" points="120952.71,-571.81 120949.21,-561.81 120945.71,-571.81 120952.71,-571.81"/>
</g>
<!-- L13_S1_TP2_GPU10_expert1&#45;&gt;L13_S1_TP1_GPU9_moe_ar -->
<g id="edge3931" class="edge">
<title>L13_S1_TP2_GPU10_expert1&#45;&gt;L13_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M121794.48,-604.34C121794.48,-604.34 121794.48,-538.15 121794.48,-538.15"/>
<polygon fill="black" stroke="black" points="121797.98,-538.15 121794.48,-528.15 121790.98,-538.15 121797.98,-538.15"/>
</g>
<!-- L13_S1_TP2_GPU10_expert1&#45;&gt;L13_S1_TP2_GPU10_moe_ar -->
<g id="edge3967" class="edge">
<title>L13_S1_TP2_GPU10_expert1&#45;&gt;L13_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M122028.02,-604.34C122028.02,-604.34 122028.02,-575.49 122028.02,-575.49"/>
<polygon fill="black" stroke="black" points="122031.52,-575.49 122028.02,-565.49 122024.52,-575.49 122031.52,-575.49"/>
</g>
<!-- L13_S1_TP2_GPU10_expert1&#45;&gt;L13_S1_TP3_GPU11_moe_ar -->
<g id="edge4003" class="edge">
<title>L13_S1_TP2_GPU10_expert1&#45;&gt;L13_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M122080.89,-604.49C122080.89,-586.46 122080.89,-568 122080.89,-568 122080.89,-568 122605.02,-568 122605.02,-568 122605.02,-568 122605.02,-565 122605.02,-565"/>
<polygon fill="black" stroke="black" points="122608.52,-565 122605.02,-555 122601.52,-565 122608.52,-565"/>
</g>
<!-- L13_S1_TP2_GPU10_expert1&#45;&gt;L13_S1_TP4_GPU12_moe_ar -->
<g id="edge4039" class="edge">
<title>L13_S1_TP2_GPU10_expert1&#45;&gt;L13_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M122133.76,-604.16C122133.76,-586.65 122133.76,-569 122133.76,-569 122133.76,-569 123326.2,-569 123326.2,-569 123326.2,-569 123326.2,-568.02 123326.2,-568.02"/>
<polygon fill="black" stroke="black" points="123329.7,-569.17 123326.2,-559.17 123322.7,-569.17 123329.7,-569.17"/>
</g>
<!-- L13_S1_TP2_GPU10_expert1&#45;&gt;L13_S1_TP5_GPU13_moe_ar -->
<g id="edge4075" class="edge">
<title>L13_S1_TP2_GPU10_expert1&#45;&gt;L13_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M122186.63,-604.16C122186.63,-586.65 122186.63,-569 122186.63,-569 122186.63,-569 123928.64,-569 123928.64,-569 123928.64,-569 123928.64,-556.13 123928.64,-556.13"/>
<polygon fill="black" stroke="black" points="123932.14,-556.13 123928.64,-546.13 123925.14,-556.13 123932.14,-556.13"/>
</g>
<!-- L13_S1_TP2_GPU10_expert1&#45;&gt;L13_S1_TP6_GPU14_moe_ar -->
<g id="edge4111" class="edge">
<title>L13_S1_TP2_GPU10_expert1&#45;&gt;L13_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M122197.74,-672.61C122197.74,-672.87 122197.74,-673 122197.74,-673 122197.74,-673 124589.5,-673 124589.5,-673 124589.5,-673 124589.5,-548.82 124589.5,-548.82"/>
<polygon fill="black" stroke="black" points="124593,-548.82 124589.5,-538.82 124586,-548.82 124593,-548.82"/>
</g>
<!-- L13_S1_TP2_GPU10_expert1&#45;&gt;L13_S1_TP7_GPU15_moe_ar -->
<g id="edge4147" class="edge">
<title>L13_S1_TP2_GPU10_expert1&#45;&gt;L13_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M122155.98,-672.53C122155.98,-688.89 122155.98,-705 122155.98,-705 122155.98,-705 125519.3,-705 125519.3,-705 125519.3,-705 125519.3,-577.95 125519.3,-577.95"/>
<polygon fill="black" stroke="black" points="125522.8,-577.95 125519.3,-567.95 125515.8,-577.95 125522.8,-577.95"/>
</g>
<!-- L13_S1_TP3_GPU11_expert0 -->
<g id="node1385" class="node">
<title>L13_S1_TP3_GPU11_expert0</title>
<polygon fill="none" stroke="black" points="122706.5,-672.5 122257.5,-672.5 122257.5,-604.5 122706.5,-604.5 122706.5,-672.5"/>
<text text-anchor="middle" x="122482" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="122482" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="122482" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="122482" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L13_S1_TP3_GPU11_expert0&#45;&gt;L13_S1_TP0_GPU8_moe_ar -->
<g id="edge3896" class="edge">
<title>L13_S1_TP3_GPU11_expert0&#45;&gt;L13_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M122286,-604.47C122286,-588.11 122286,-572 122286,-572 122286,-572 120972.39,-572 120972.39,-572 120972.39,-572 120972.39,-569.51 120972.39,-569.51"/>
<polygon fill="black" stroke="black" points="120975.89,-569.51 120972.39,-559.51 120968.89,-569.51 120975.89,-569.51"/>
</g>
<!-- L13_S1_TP3_GPU11_expert0&#45;&gt;L13_S1_TP1_GPU9_moe_ar -->
<g id="edge3932" class="edge">
<title>L13_S1_TP3_GPU11_expert0&#45;&gt;L13_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M122314.49,-604.47C122314.49,-588.11 122314.49,-572 122314.49,-572 122314.49,-572 121786.5,-572 121786.5,-572 121786.5,-572 121786.5,-543.17 121786.5,-543.17"/>
<polygon fill="black" stroke="black" points="121790,-543.17 121786.5,-533.17 121783,-543.17 121790,-543.17"/>
</g>
<!-- L13_S1_TP3_GPU11_expert0&#45;&gt;L13_S1_TP2_GPU10_moe_ar -->
<g id="edge3968" class="edge">
<title>L13_S1_TP3_GPU11_expert0&#45;&gt;L13_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M122342.99,-604.34C122342.99,-604.34 122342.99,-569.91 122342.99,-569.91"/>
<polygon fill="black" stroke="black" points="122346.49,-569.91 122342.99,-559.91 122339.49,-569.91 122346.49,-569.91"/>
</g>
<!-- L13_S1_TP3_GPU11_expert0&#45;&gt;L13_S1_TP3_GPU11_moe_ar -->
<g id="edge4004" class="edge">
<title>L13_S1_TP3_GPU11_expert0&#45;&gt;L13_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M122630.39,-604.34C122630.39,-604.34 122630.39,-568.22 122630.39,-568.22"/>
<polygon fill="black" stroke="black" points="122633.89,-568.22 122630.39,-558.22 122626.89,-568.22 122633.89,-568.22"/>
</g>
<!-- L13_S1_TP3_GPU11_expert0&#45;&gt;L13_S1_TP4_GPU12_moe_ar -->
<g id="edge4040" class="edge">
<title>L13_S1_TP3_GPU11_expert0&#45;&gt;L13_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M122655.76,-604.16C122655.76,-586.65 122655.76,-569 122655.76,-569 122655.76,-569 123416,-569 123416,-569 123416,-569 123416,-568.71 123416,-568.71"/>
<polygon fill="black" stroke="black" points="123419.5,-576.11 123416,-566.11 123412.5,-576.11 123419.5,-576.11"/>
</g>
<!-- L13_S1_TP3_GPU11_expert0&#45;&gt;L13_S1_TP5_GPU13_moe_ar -->
<g id="edge4076" class="edge">
<title>L13_S1_TP3_GPU11_expert0&#45;&gt;L13_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M122681.13,-604.16C122681.13,-586.65 122681.13,-569 122681.13,-569 122681.13,-569 123954.19,-569 123954.19,-569 123954.19,-569 123954.19,-561.19 123954.19,-561.19"/>
<polygon fill="black" stroke="black" points="123957.69,-561.19 123954.19,-551.19 123950.69,-561.19 123957.69,-561.19"/>
</g>
<!-- L13_S1_TP3_GPU11_expert0&#45;&gt;L13_S1_TP6_GPU14_moe_ar -->
<g id="edge4112" class="edge">
<title>L13_S1_TP3_GPU11_expert0&#45;&gt;L13_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M122594.25,-672.61C122594.25,-672.87 122594.25,-673 122594.25,-673 122594.25,-673 124586.5,-673 124586.5,-673 124586.5,-673 124586.5,-547.62 124586.5,-547.62"/>
<polygon fill="black" stroke="black" points="124590,-547.62 124586.5,-537.62 124583,-547.62 124590,-547.62"/>
</g>
<!-- L13_S1_TP3_GPU11_expert0&#45;&gt;L13_S1_TP7_GPU15_moe_ar -->
<g id="edge4148" class="edge">
<title>L13_S1_TP3_GPU11_expert0&#45;&gt;L13_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M122482,-672.64C122482,-688.11 122482,-703 122482,-703 122482,-703 125515.7,-703 125515.7,-703 125515.7,-703 125515.7,-577.44 125515.7,-577.44"/>
<polygon fill="black" stroke="black" points="125519.2,-577.44 125515.7,-567.44 125512.2,-577.44 125519.2,-577.44"/>
</g>
<!-- L13_S1_TP3_GPU11_expert1 -->
<g id="node1386" class="node">
<title>L13_S1_TP3_GPU11_expert1</title>
<polygon fill="none" stroke="black" points="123173.5,-672.5 122724.5,-672.5 122724.5,-604.5 123173.5,-604.5 123173.5,-672.5"/>
<text text-anchor="middle" x="122949" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="122949" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="122949" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="122949" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L13_S1_TP3_GPU11_expert1&#45;&gt;L13_S1_TP0_GPU8_moe_ar -->
<g id="edge3897" class="edge">
<title>L13_S1_TP3_GPU11_expert1&#45;&gt;L13_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M122774.27,-604.47C122774.27,-588.11 122774.27,-572 122774.27,-572 122774.27,-572 120995.57,-572 120995.57,-572 120995.57,-572 120995.57,-567.08 120995.57,-567.08"/>
<polygon fill="black" stroke="black" points="120999.07,-567.08 120995.57,-557.08 120992.07,-567.08 120999.07,-567.08"/>
</g>
<!-- L13_S1_TP3_GPU11_expert1&#45;&gt;L13_S1_TP1_GPU9_moe_ar -->
<g id="edge3933" class="edge">
<title>L13_S1_TP3_GPU11_expert1&#45;&gt;L13_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M122824.05,-604.47C122824.05,-588.11 122824.05,-572 122824.05,-572 122824.05,-572 121788.5,-572 121788.5,-572 121788.5,-572 121788.5,-542.12 121788.5,-542.12"/>
<polygon fill="black" stroke="black" points="121792,-542.12 121788.5,-532.12 121785,-542.12 121792,-542.12"/>
</g>
<!-- L13_S1_TP3_GPU11_expert1&#45;&gt;L13_S1_TP2_GPU10_moe_ar -->
<g id="edge3969" class="edge">
<title>L13_S1_TP3_GPU11_expert1&#45;&gt;L13_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M122873.82,-604.47C122873.82,-588.11 122873.82,-572 122873.82,-572 122873.82,-572 122371.48,-572 122371.48,-572 122371.48,-572 122371.48,-566.8 122371.48,-566.8"/>
<polygon fill="black" stroke="black" points="122374.98,-566.8 122371.48,-556.8 122367.98,-566.8 122374.98,-566.8"/>
</g>
<!-- L13_S1_TP3_GPU11_expert1&#45;&gt;L13_S1_TP3_GPU11_moe_ar -->
<g id="edge4005" class="edge">
<title>L13_S1_TP3_GPU11_expert1&#45;&gt;L13_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M122923.59,-604.34C122923.59,-604.34 122923.59,-577.23 122923.59,-577.23"/>
<polygon fill="black" stroke="black" points="122927.09,-577.23 122923.59,-567.23 122920.09,-577.23 122927.09,-577.23"/>
</g>
<!-- L13_S1_TP3_GPU11_expert1&#45;&gt;L13_S1_TP4_GPU12_moe_ar -->
<g id="edge4041" class="edge">
<title>L13_S1_TP3_GPU11_expert1&#45;&gt;L13_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M123173.59,-627C123179.81,-627 123183.36,-627 123183.36,-627 123183.36,-627 123183.36,-504 123183.36,-504 123183.36,-504 123200.45,-504 123200.45,-504"/>
<polygon fill="black" stroke="black" points="123200.45,-507.5 123210.45,-504 123200.45,-500.5 123200.45,-507.5"/>
</g>
<!-- L13_S1_TP3_GPU11_expert1&#45;&gt;L13_S1_TP5_GPU13_moe_ar -->
<g id="edge4077" class="edge">
<title>L13_S1_TP3_GPU11_expert1&#45;&gt;L13_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M122973.37,-604.16C122973.37,-586.65 122973.37,-569 122973.37,-569 122973.37,-569 123979.74,-569 123979.74,-569 123979.74,-569 123979.74,-565.21 123979.74,-565.21"/>
<polygon fill="black" stroke="black" points="123983.24,-565.21 123979.74,-555.21 123976.24,-565.21 123983.24,-565.21"/>
</g>
<!-- L13_S1_TP3_GPU11_expert1&#45;&gt;L13_S1_TP6_GPU14_moe_ar -->
<g id="edge4113" class="edge">
<title>L13_S1_TP3_GPU11_expert1&#45;&gt;L13_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M123061.25,-672.61C123061.25,-672.87 123061.25,-673 123061.25,-673 123061.25,-673 124583.5,-673 124583.5,-673 124583.5,-673 124583.5,-546.46 124583.5,-546.46"/>
<polygon fill="black" stroke="black" points="124587,-546.46 124583.5,-536.46 124580,-546.46 124587,-546.46"/>
</g>
<!-- L13_S1_TP3_GPU11_expert1&#45;&gt;L13_S1_TP7_GPU15_moe_ar -->
<g id="edge4149" class="edge">
<title>L13_S1_TP3_GPU11_expert1&#45;&gt;L13_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M122949,-672.64C122949,-686.36 122949,-699 122949,-699 122949,-699 125512.1,-699 125512.1,-699 125512.1,-699 125512.1,-577.34 125512.1,-577.34"/>
<polygon fill="black" stroke="black" points="125515.6,-577.34 125512.1,-567.34 125508.6,-577.34 125515.6,-577.34"/>
</g>
<!-- L13_S1_TP4_GPU12_expert0 -->
<g id="node1387" class="node">
<title>L13_S1_TP4_GPU12_expert0</title>
<polygon fill="none" stroke="black" points="123640.5,-672.5 123191.5,-672.5 123191.5,-604.5 123640.5,-604.5 123640.5,-672.5"/>
<text text-anchor="middle" x="123416" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="123416" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="123416" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="123416" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L13_S1_TP4_GPU12_expert0&#45;&gt;L13_S1_TP0_GPU8_moe_ar -->
<g id="edge3898" class="edge">
<title>L13_S1_TP4_GPU12_expert0&#45;&gt;L13_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M123416.36,-672.85C123416.36,-686.93 123416.36,-700 123416.36,-700 123416.36,-700 120847.5,-700 120847.5,-700 120847.5,-700 120847.5,-577.6 120847.5,-577.6"/>
<polygon fill="black" stroke="black" points="120851,-577.6 120847.5,-567.6 120844,-577.6 120851,-577.6"/>
</g>
<!-- L13_S1_TP4_GPU12_expert0&#45;&gt;L13_S1_TP1_GPU9_moe_ar -->
<g id="edge3934" class="edge">
<title>L13_S1_TP4_GPU12_expert0&#45;&gt;L13_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M123304.29,-673.12C123304.29,-673.69 123304.29,-674 123304.29,-674 123304.29,-674 121782.5,-674 121782.5,-674 121782.5,-674 121782.5,-545.14 121782.5,-545.14"/>
<polygon fill="black" stroke="black" points="121786,-545.14 121782.5,-535.14 121779,-545.14 121786,-545.14"/>
</g>
<!-- L13_S1_TP4_GPU12_expert0&#45;&gt;L13_S1_TP2_GPU10_moe_ar -->
<g id="edge3970" class="edge">
<title>L13_S1_TP4_GPU12_expert0&#45;&gt;L13_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M123371.1,-604.16C123371.1,-586.65 123371.1,-569 123371.1,-569 123371.1,-569 122399.98,-569 122399.98,-569 122399.98,-569 122399.98,-562.55 122399.98,-562.55"/>
<polygon fill="black" stroke="black" points="122403.48,-562.55 122399.98,-552.55 122396.48,-562.55 122403.48,-562.55"/>
</g>
<!-- L13_S1_TP4_GPU12_expert0&#45;&gt;L13_S1_TP3_GPU11_moe_ar -->
<g id="edge4006" class="edge">
<title>L13_S1_TP4_GPU12_expert0&#45;&gt;L13_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M123191.37,-649C123184.75,-649 123180.96,-649 123180.96,-649 123180.96,-649 123180.96,-536 123180.96,-536 123180.96,-536 123164.62,-536 123164.62,-536"/>
<polygon fill="black" stroke="black" points="123164.62,-532.5 123154.62,-536 123164.62,-539.5 123164.62,-532.5"/>
</g>
<!-- L13_S1_TP4_GPU12_expert0&#45;&gt;L13_S1_TP4_GPU12_moe_ar -->
<g id="edge4042" class="edge">
<title>L13_S1_TP4_GPU12_expert0&#45;&gt;L13_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M123460.9,-604.34C123460.9,-604.34 123460.9,-577.67 123460.9,-577.67"/>
<polygon fill="black" stroke="black" points="123464.4,-577.67 123460.9,-567.67 123457.4,-577.67 123464.4,-577.67"/>
</g>
<!-- L13_S1_TP4_GPU12_expert0&#45;&gt;L13_S1_TP5_GPU13_moe_ar -->
<g id="edge4078" class="edge">
<title>L13_S1_TP4_GPU12_expert0&#45;&gt;L13_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M123505.8,-604.16C123505.8,-586.65 123505.8,-569 123505.8,-569 123505.8,-569 124005.29,-569 124005.29,-569 124005.29,-569 124005.29,-567.92 124005.29,-567.92"/>
<polygon fill="black" stroke="black" points="124008.79,-568.22 124005.29,-558.22 124001.79,-568.22 124008.79,-568.22"/>
</g>
<!-- L13_S1_TP4_GPU12_expert0&#45;&gt;L13_S1_TP6_GPU14_moe_ar -->
<g id="edge4114" class="edge">
<title>L13_S1_TP4_GPU12_expert0&#45;&gt;L13_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M123550.7,-604.16C123550.7,-586.65 123550.7,-569 123550.7,-569 123550.7,-569 124577.5,-569 124577.5,-569 124577.5,-569 124577.5,-543.69 124577.5,-543.69"/>
<polygon fill="black" stroke="black" points="124581,-543.69 124577.5,-533.69 124574,-543.69 124581,-543.69"/>
</g>
<!-- L13_S1_TP4_GPU12_expert0&#45;&gt;L13_S1_TP7_GPU15_moe_ar -->
<g id="edge4150" class="edge">
<title>L13_S1_TP4_GPU12_expert0&#45;&gt;L13_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M123595.6,-604.25C123595.6,-587.12 123595.6,-570 123595.6,-570 123595.6,-570 125380.02,-570 125380.02,-570 125380.02,-570 125380.02,-568.5 125380.02,-568.5"/>
<polygon fill="black" stroke="black" points="125383.52,-568.5 125380.02,-558.5 125376.52,-568.5 125383.52,-568.5"/>
</g>
<!-- L13_S1_TP4_GPU12_expert1 -->
<g id="node1388" class="node">
<title>L13_S1_TP4_GPU12_expert1</title>
<polygon fill="none" stroke="black" points="124107.5,-672.5 123658.5,-672.5 123658.5,-604.5 124107.5,-604.5 124107.5,-672.5"/>
<text text-anchor="middle" x="123883" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="123883" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="123883" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="123883" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L13_S1_TP4_GPU12_expert1&#45;&gt;L13_S1_TP0_GPU8_moe_ar -->
<g id="edge3899" class="edge">
<title>L13_S1_TP4_GPU12_expert1&#45;&gt;L13_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M123868.5,-604.4C123868.5,-555.17 123868.5,-470 123868.5,-470 123868.5,-470 121064.85,-470 121064.85,-470 121064.85,-470 121064.85,-485.8 121064.85,-485.8"/>
<polygon fill="black" stroke="black" points="121061.35,-485.8 121064.85,-495.8 121068.35,-485.8 121061.35,-485.8"/>
</g>
<!-- L13_S1_TP4_GPU12_expert1&#45;&gt;L13_S1_TP1_GPU9_moe_ar -->
<g id="edge3935" class="edge">
<title>L13_S1_TP4_GPU12_expert1&#45;&gt;L13_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M123808.17,-673.12C123808.17,-673.69 123808.17,-674 123808.17,-674 123808.17,-674 121780.5,-674 121780.5,-674 121780.5,-674 121780.5,-545.99 121780.5,-545.99"/>
<polygon fill="black" stroke="black" points="121784,-545.99 121780.5,-535.99 121777,-545.99 121784,-545.99"/>
</g>
<!-- L13_S1_TP4_GPU12_expert1&#45;&gt;L13_S1_TP2_GPU10_moe_ar -->
<g id="edge3971" class="edge">
<title>L13_S1_TP4_GPU12_expert1&#45;&gt;L13_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M123683.62,-604.16C123683.62,-586.65 123683.62,-569 123683.62,-569 123683.62,-569 122428.47,-569 122428.47,-569 122428.47,-569 122428.47,-557.27 122428.47,-557.27"/>
<polygon fill="black" stroke="black" points="122431.97,-557.27 122428.47,-547.27 122424.97,-557.27 122431.97,-557.27"/>
</g>
<!-- L13_S1_TP4_GPU12_expert1&#45;&gt;L13_S1_TP3_GPU11_moe_ar -->
<g id="edge4007" class="edge">
<title>L13_S1_TP4_GPU12_expert1&#45;&gt;L13_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M123708.74,-604.16C123708.74,-586.65 123708.74,-569 123708.74,-569 123708.74,-569 123023.14,-569 123023.14,-569 123023.14,-569 123023.14,-568.15 123023.14,-568.15"/>
<polygon fill="black" stroke="black" points="123026.64,-570.54 123023.14,-560.54 123019.64,-570.54 123026.64,-570.54"/>
</g>
<!-- L13_S1_TP4_GPU12_expert1&#45;&gt;L13_S1_TP4_GPU12_moe_ar -->
<g id="edge4043" class="edge">
<title>L13_S1_TP4_GPU12_expert1&#45;&gt;L13_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M123733.86,-604.34C123733.86,-604.34 123733.86,-568.22 123733.86,-568.22"/>
<polygon fill="black" stroke="black" points="123737.36,-568.22 123733.86,-558.22 123730.36,-568.22 123737.36,-568.22"/>
</g>
<!-- L13_S1_TP4_GPU12_expert1&#45;&gt;L13_S1_TP5_GPU13_moe_ar -->
<g id="edge4079" class="edge">
<title>L13_S1_TP4_GPU12_expert1&#45;&gt;L13_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M124030.85,-604.34C124030.85,-604.34 124030.85,-571.18 124030.85,-571.18"/>
<polygon fill="black" stroke="black" points="124034.35,-571.18 124030.85,-561.18 124027.35,-571.18 124034.35,-571.18"/>
</g>
<!-- L13_S1_TP4_GPU12_expert1&#45;&gt;L13_S1_TP6_GPU14_moe_ar -->
<g id="edge4115" class="edge">
<title>L13_S1_TP4_GPU12_expert1&#45;&gt;L13_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M124056.4,-604.16C124056.4,-586.65 124056.4,-569 124056.4,-569 124056.4,-569 124567.86,-569 124567.86,-569 124567.86,-569 124567.86,-537.58 124567.86,-537.58"/>
<polygon fill="black" stroke="black" points="124571.36,-537.58 124567.86,-527.58 124564.36,-537.59 124571.36,-537.58"/>
</g>
<!-- L13_S1_TP4_GPU12_expert1&#45;&gt;L13_S1_TP7_GPU15_moe_ar -->
<g id="edge4151" class="edge">
<title>L13_S1_TP4_GPU12_expert1&#45;&gt;L13_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M124081.95,-604.25C124081.95,-587.12 124081.95,-570 124081.95,-570 124081.95,-570 125405.72,-570 125405.72,-570 125405.72,-570 125405.72,-569.14 125405.72,-569.14"/>
<polygon fill="black" stroke="black" points="125409.22,-571.36 125405.72,-561.36 125402.22,-571.36 125409.22,-571.36"/>
</g>
<!-- L13_S1_TP5_GPU13_expert0 -->
<g id="node1389" class="node">
<title>L13_S1_TP5_GPU13_expert0</title>
<polygon fill="none" stroke="black" points="124574.5,-672.5 124125.5,-672.5 124125.5,-604.5 124574.5,-604.5 124574.5,-672.5"/>
<text text-anchor="middle" x="124350" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="124350" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="124350" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="124350" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L13_S1_TP5_GPU13_expert0&#45;&gt;L13_S1_TP0_GPU8_moe_ar -->
<g id="edge3900" class="edge">
<title>L13_S1_TP5_GPU13_expert0&#45;&gt;L13_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M124172.27,-604.47C124172.27,-588.11 124172.27,-572 124172.27,-572 124172.27,-572 121018.75,-572 121018.75,-572 121018.75,-572 121018.75,-563.67 121018.75,-563.67"/>
<polygon fill="black" stroke="black" points="121022.25,-563.67 121018.75,-553.67 121015.25,-563.67 121022.25,-563.67"/>
</g>
<!-- L13_S1_TP5_GPU13_expert0&#45;&gt;L13_S1_TP1_GPU9_moe_ar -->
<g id="edge3936" class="edge">
<title>L13_S1_TP5_GPU13_expert0&#45;&gt;L13_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M124188.64,-673.12C124188.64,-673.69 124188.64,-674 124188.64,-674 124188.64,-674 121778.5,-674 121778.5,-674 121778.5,-674 121778.5,-546.85 121778.5,-546.85"/>
<polygon fill="black" stroke="black" points="121782,-546.85 121778.5,-536.85 121775,-546.85 121782,-546.85"/>
</g>
<!-- L13_S1_TP5_GPU13_expert0&#45;&gt;L13_S1_TP2_GPU10_moe_ar -->
<g id="edge3972" class="edge">
<title>L13_S1_TP5_GPU13_expert0&#45;&gt;L13_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M124219.05,-604.16C124219.05,-586.65 124219.05,-569 124219.05,-569 124219.05,-569 122456.97,-569 122456.97,-569 122456.97,-569 122456.97,-549.9 122456.97,-549.9"/>
<polygon fill="black" stroke="black" points="122460.47,-549.9 122456.97,-539.9 122453.47,-549.9 122460.47,-549.9"/>
</g>
<!-- L13_S1_TP5_GPU13_expert0&#45;&gt;L13_S1_TP3_GPU11_moe_ar -->
<g id="edge4008" class="edge">
<title>L13_S1_TP5_GPU13_expert0&#45;&gt;L13_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M124265.82,-604.16C124265.82,-586.65 124265.82,-569 124265.82,-569 124265.82,-569 123072.91,-569 123072.91,-569 123072.91,-569 123072.91,-564.69 123072.91,-564.69"/>
<polygon fill="black" stroke="black" points="123076.41,-564.69 123072.91,-554.69 123069.41,-564.69 123076.41,-564.69"/>
</g>
<!-- L13_S1_TP5_GPU13_expert0&#45;&gt;L13_S1_TP4_GPU12_moe_ar -->
<g id="edge4044" class="edge">
<title>L13_S1_TP5_GPU13_expert0&#45;&gt;L13_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M124312.59,-604.16C124312.59,-586.65 124312.59,-569 124312.59,-569 124312.59,-569 123758.98,-569 123758.98,-569 123758.98,-569 123758.98,-564.95 123758.98,-564.95"/>
<polygon fill="black" stroke="black" points="123762.48,-564.95 123758.98,-554.95 123755.48,-564.95 123762.48,-564.95"/>
</g>
<!-- L13_S1_TP5_GPU13_expert0&#45;&gt;L13_S1_TP5_GPU13_moe_ar -->
<g id="edge4080" class="edge">
<title>L13_S1_TP5_GPU13_expert0&#45;&gt;L13_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M124359.37,-604.34C124359.37,-604.34 124359.37,-573.75 124359.37,-573.75"/>
<polygon fill="black" stroke="black" points="124362.87,-573.75 124359.37,-563.75 124355.87,-573.75 124362.87,-573.75"/>
</g>
<!-- L13_S1_TP5_GPU13_expert0&#45;&gt;L13_S1_TP6_GPU14_moe_ar -->
<g id="edge4116" class="edge">
<title>L13_S1_TP5_GPU13_expert0&#45;&gt;L13_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M124571.18,-604.34C124571.18,-604.34 124571.18,-540.13 124571.18,-540.13"/>
<polygon fill="black" stroke="black" points="124574.68,-540.13 124571.18,-530.13 124567.68,-540.13 124574.68,-540.13"/>
</g>
<!-- L13_S1_TP5_GPU13_expert0&#45;&gt;L13_S1_TP7_GPU15_moe_ar -->
<g id="edge4152" class="edge">
<title>L13_S1_TP5_GPU13_expert0&#45;&gt;L13_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M124552.49,-604.25C124552.49,-587.12 124552.49,-570 124552.49,-570 124552.49,-570 125431.41,-570 125431.41,-570 125431.41,-570 125431.41,-569.31 125431.41,-569.31"/>
<polygon fill="black" stroke="black" points="125434.91,-573.11 125431.41,-563.11 125427.91,-573.11 125434.91,-573.11"/>
</g>
<!-- L13_S1_TP5_GPU13_expert1 -->
<g id="node1390" class="node">
<title>L13_S1_TP5_GPU13_expert1</title>
<polygon fill="none" stroke="black" points="125041.5,-672.5 124592.5,-672.5 124592.5,-604.5 125041.5,-604.5 125041.5,-672.5"/>
<text text-anchor="middle" x="124817" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="124817" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="124817" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="124817" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L13_S1_TP5_GPU13_expert1&#45;&gt;L13_S1_TP0_GPU8_moe_ar -->
<g id="edge3901" class="edge">
<title>L13_S1_TP5_GPU13_expert1&#45;&gt;L13_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M124682.3,-604.25C124682.3,-587.12 124682.3,-570 124682.3,-570 124682.3,-570 121041.93,-570 121041.93,-570 121041.93,-570 121041.93,-559.83 121041.93,-559.83"/>
<polygon fill="black" stroke="black" points="121045.43,-559.83 121041.93,-549.83 121038.43,-559.83 121045.43,-559.83"/>
</g>
<!-- L13_S1_TP5_GPU13_expert1&#45;&gt;L13_S1_TP1_GPU9_moe_ar -->
<g id="edge3937" class="edge">
<title>L13_S1_TP5_GPU13_expert1&#45;&gt;L13_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M124817,-673.12C124817,-673.69 124817,-674 124817,-674 124817,-674 121776.5,-674 121776.5,-674 121776.5,-674 121776.5,-547.74 121776.5,-547.74"/>
<polygon fill="black" stroke="black" points="121780,-547.74 121776.5,-537.74 121773,-547.74 121780,-547.74"/>
</g>
<!-- L13_S1_TP5_GPU13_expert1&#45;&gt;L13_S1_TP2_GPU10_moe_ar -->
<g id="edge3973" class="edge">
<title>L13_S1_TP5_GPU13_expert1&#45;&gt;L13_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M124704.75,-673.12C124704.75,-673.69 124704.75,-674 124704.75,-674 124704.75,-674 122251.5,-674 122251.5,-674 122251.5,-674 122251.5,-576.5 122251.5,-576.5"/>
<polygon fill="black" stroke="black" points="122255,-576.5 122251.5,-566.5 122248,-576.5 122255,-576.5"/>
</g>
<!-- L13_S1_TP5_GPU13_expert1&#45;&gt;L13_S1_TP3_GPU11_moe_ar -->
<g id="edge4009" class="edge">
<title>L13_S1_TP5_GPU13_expert1&#45;&gt;L13_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M124817,-604.16C124817,-586.65 124817,-569 124817,-569 124817,-569 123122.69,-569 123122.69,-569 123122.69,-569 123122.69,-555.85 123122.69,-555.85"/>
<polygon fill="black" stroke="black" points="123126.19,-555.85 123122.69,-545.85 123119.19,-555.85 123126.19,-555.85"/>
</g>
<!-- L13_S1_TP5_GPU13_expert1&#45;&gt;L13_S1_TP4_GPU12_moe_ar -->
<g id="edge4045" class="edge">
<title>L13_S1_TP5_GPU13_expert1&#45;&gt;L13_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M124861.9,-604.16C124861.9,-586.65 124861.9,-569 124861.9,-569 124861.9,-569 123784.1,-569 123784.1,-569 123784.1,-569 123784.1,-560.91 123784.1,-560.91"/>
<polygon fill="black" stroke="black" points="123787.6,-560.91 123784.1,-550.91 123780.6,-560.91 123787.6,-560.91"/>
</g>
<!-- L13_S1_TP5_GPU13_expert1&#45;&gt;L13_S1_TP5_GPU13_moe_ar -->
<g id="edge4081" class="edge">
<title>L13_S1_TP5_GPU13_expert1&#45;&gt;L13_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M124906.8,-604.16C124906.8,-586.65 124906.8,-569 124906.8,-569 124906.8,-569 124406.14,-569 124406.14,-569 124406.14,-569 124406.14,-568.06 124406.14,-568.06"/>
<polygon fill="black" stroke="black" points="124409.64,-569.63 124406.14,-559.63 124402.64,-569.63 124409.64,-569.63"/>
</g>
<!-- L13_S1_TP5_GPU13_expert1&#45;&gt;L13_S1_TP6_GPU14_moe_ar -->
<g id="edge4117" class="edge">
<title>L13_S1_TP5_GPU13_expert1&#45;&gt;L13_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M124951.7,-604.34C124951.7,-604.34 124951.7,-578.11 124951.7,-578.11"/>
<polygon fill="black" stroke="black" points="124955.2,-578.11 124951.7,-568.11 124948.2,-578.11 124955.2,-578.11"/>
</g>
<!-- L13_S1_TP5_GPU13_expert1&#45;&gt;L13_S1_TP7_GPU15_moe_ar -->
<g id="edge4153" class="edge">
<title>L13_S1_TP5_GPU13_expert1&#45;&gt;L13_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M124996.6,-604.46C124996.6,-602.32 124996.6,-601 124996.6,-601 124996.6,-601 125457.11,-601 125457.11,-601 125457.11,-601 125457.11,-574.95 125457.11,-574.95"/>
<polygon fill="black" stroke="black" points="125460.61,-574.95 125457.11,-564.95 125453.61,-574.95 125460.61,-574.95"/>
</g>
<!-- L13_S1_TP6_GPU14_expert0 -->
<g id="node1391" class="node">
<title>L13_S1_TP6_GPU14_expert0</title>
<polygon fill="none" stroke="black" points="125508.5,-672.5 125059.5,-672.5 125059.5,-604.5 125508.5,-604.5 125508.5,-672.5"/>
<text text-anchor="middle" x="125284" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="125284" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="125284" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="125284" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L13_S1_TP6_GPU14_expert0&#45;&gt;L13_S1_TP0_GPU8_moe_ar -->
<g id="edge3902" class="edge">
<title>L13_S1_TP6_GPU14_expert0&#45;&gt;L13_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M125081.25,-604.25C125081.25,-587.12 125081.25,-570 125081.25,-570 125081.25,-570 121065.1,-570 121065.1,-570 121065.1,-570 121065.1,-554.92 121065.1,-554.92"/>
<polygon fill="black" stroke="black" points="121068.6,-554.92 121065.1,-544.92 121061.6,-554.92 121068.6,-554.92"/>
</g>
<!-- L13_S1_TP6_GPU14_expert0&#45;&gt;L13_S1_TP1_GPU9_moe_ar -->
<g id="edge3938" class="edge">
<title>L13_S1_TP6_GPU14_expert0&#45;&gt;L13_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M125239.69,-673.12C125239.69,-673.69 125239.69,-674 125239.69,-674 125239.69,-674 121774.5,-674 121774.5,-674 121774.5,-674 121774.5,-548.33 121774.5,-548.33"/>
<polygon fill="black" stroke="black" points="121778,-548.33 121774.5,-538.33 121771,-548.33 121778,-548.33"/>
</g>
<!-- L13_S1_TP6_GPU14_expert0&#45;&gt;L13_S1_TP2_GPU10_moe_ar -->
<g id="edge3974" class="edge">
<title>L13_S1_TP6_GPU14_expert0&#45;&gt;L13_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M125149.59,-673.12C125149.59,-673.69 125149.59,-674 125149.59,-674 125149.59,-674 122245.5,-674 122245.5,-674 122245.5,-674 122245.5,-576.91 122245.5,-576.91"/>
<polygon fill="black" stroke="black" points="122249,-576.91 122245.5,-566.91 122242,-576.91 122249,-576.91"/>
</g>
<!-- L13_S1_TP6_GPU14_expert0&#45;&gt;L13_S1_TP3_GPU11_moe_ar -->
<g id="edge4010" class="edge">
<title>L13_S1_TP6_GPU14_expert0&#45;&gt;L13_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M125243.18,-604.41C125243.18,-551.35 125243.18,-455 125243.18,-455 125243.18,-455 123109.77,-455 123109.77,-455 123109.77,-455 123109.77,-482.29 123109.77,-482.29"/>
<polygon fill="black" stroke="black" points="123106.27,-482.29 123109.77,-492.29 123113.27,-482.29 123106.27,-482.29"/>
</g>
<!-- L13_S1_TP6_GPU14_expert0&#45;&gt;L13_S1_TP4_GPU12_moe_ar -->
<g id="edge4046" class="edge">
<title>L13_S1_TP6_GPU14_expert0&#45;&gt;L13_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M125102.99,-604.16C125102.99,-586.65 125102.99,-569 125102.99,-569 125102.99,-569 123809.22,-569 123809.22,-569 123809.22,-569 123809.22,-555.85 123809.22,-555.85"/>
<polygon fill="black" stroke="black" points="123812.72,-555.85 123809.22,-545.85 123805.72,-555.85 123812.72,-555.85"/>
</g>
<!-- L13_S1_TP6_GPU14_expert0&#45;&gt;L13_S1_TP5_GPU13_moe_ar -->
<g id="edge4082" class="edge">
<title>L13_S1_TP6_GPU14_expert0&#45;&gt;L13_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M125124.74,-604.16C125124.74,-586.65 125124.74,-569 125124.74,-569 125124.74,-569 124452.91,-569 124452.91,-569 124452.91,-569 124452.91,-563.89 124452.91,-563.89"/>
<polygon fill="black" stroke="black" points="124456.41,-563.89 124452.91,-553.89 124449.41,-563.89 124456.41,-563.89"/>
</g>
<!-- L13_S1_TP6_GPU14_expert0&#45;&gt;L13_S1_TP6_GPU14_moe_ar -->
<g id="edge4118" class="edge">
<title>L13_S1_TP6_GPU14_expert0&#45;&gt;L13_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M125146.48,-604.34C125146.48,-604.34 125146.48,-562.87 125146.48,-562.87"/>
<polygon fill="black" stroke="black" points="125149.98,-562.87 125146.48,-552.87 125142.98,-562.87 125149.98,-562.87"/>
</g>
<!-- L13_S1_TP6_GPU14_expert0&#45;&gt;L13_S1_TP7_GPU15_moe_ar -->
<g id="edge4154" class="edge">
<title>L13_S1_TP6_GPU14_expert0&#45;&gt;L13_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M125482.8,-604.34C125482.8,-604.34 125482.8,-576.36 125482.8,-576.36"/>
<polygon fill="black" stroke="black" points="125486.3,-576.36 125482.8,-566.36 125479.3,-576.36 125486.3,-576.36"/>
</g>
<!-- L13_S1_TP6_GPU14_expert1 -->
<g id="node1392" class="node">
<title>L13_S1_TP6_GPU14_expert1</title>
<polygon fill="none" stroke="black" points="125975.5,-672.5 125526.5,-672.5 125526.5,-604.5 125975.5,-604.5 125975.5,-672.5"/>
<text text-anchor="middle" x="125751" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="125751" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="125751" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="125751" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L13_S1_TP6_GPU14_expert1&#45;&gt;L13_S1_TP0_GPU8_moe_ar -->
<g id="edge3903" class="edge">
<title>L13_S1_TP6_GPU14_expert1&#45;&gt;L13_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M125592.16,-604.25C125592.16,-587.12 125592.16,-570 125592.16,-570 125592.16,-570 121088.28,-570 121088.28,-570 121088.28,-570 121088.28,-548.04 121088.28,-548.04"/>
<polygon fill="black" stroke="black" points="121091.78,-548.04 121088.28,-538.04 121084.78,-548.04 121091.78,-548.04"/>
</g>
<!-- L13_S1_TP6_GPU14_expert1&#45;&gt;L13_S1_TP1_GPU9_moe_ar -->
<g id="edge3939" class="edge">
<title>L13_S1_TP6_GPU14_expert1&#45;&gt;L13_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M125676.17,-672.84C125676.17,-690.35 125676.17,-708 125676.17,-708 125676.17,-708 121314.5,-708 121314.5,-708 121314.5,-708 121314.5,-573.45 121314.5,-573.45"/>
<polygon fill="black" stroke="black" points="121318,-573.45 121314.5,-563.45 121311,-573.45 121318,-573.45"/>
</g>
<!-- L13_S1_TP6_GPU14_expert1&#45;&gt;L13_S1_TP2_GPU10_moe_ar -->
<g id="edge3975" class="edge">
<title>L13_S1_TP6_GPU14_expert1&#45;&gt;L13_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M125957.15,-604.23C125957.15,-550.87 125957.15,-454 125957.15,-454 125957.15,-454 122373.85,-454 122373.85,-454 122373.85,-454 122373.85,-474.49 122373.85,-474.49"/>
<polygon fill="black" stroke="black" points="122370.35,-474.49 122373.85,-484.49 122377.35,-474.49 122370.35,-474.49"/>
</g>
<!-- L13_S1_TP6_GPU14_expert1&#45;&gt;L13_S1_TP3_GPU11_moe_ar -->
<g id="edge4011" class="edge">
<title>L13_S1_TP6_GPU14_expert1&#45;&gt;L13_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M125938.81,-604.23C125938.81,-550.87 125938.81,-454 125938.81,-454 125938.81,-454 123047.08,-454 123047.08,-454 123047.08,-454 123047.08,-472.55 123047.08,-472.55"/>
<polygon fill="black" stroke="black" points="123043.58,-472.55 123047.08,-482.55 123050.58,-472.55 123043.58,-472.55"/>
</g>
<!-- L13_S1_TP6_GPU14_expert1&#45;&gt;L13_S1_TP4_GPU12_moe_ar -->
<g id="edge4047" class="edge">
<title>L13_S1_TP6_GPU14_expert1&#45;&gt;L13_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M125657.82,-604.16C125657.82,-586.65 125657.82,-569 125657.82,-569 125657.82,-569 123834.34,-569 123834.34,-569 123834.34,-569 123834.34,-548.78 123834.34,-548.78"/>
<polygon fill="black" stroke="black" points="123837.84,-548.78 123834.34,-538.78 123830.84,-548.78 123837.84,-548.78"/>
</g>
<!-- L13_S1_TP6_GPU14_expert1&#45;&gt;L13_S1_TP5_GPU13_moe_ar -->
<g id="edge4083" class="edge">
<title>L13_S1_TP6_GPU14_expert1&#45;&gt;L13_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M125723.48,-604.16C125723.48,-586.65 125723.48,-569 125723.48,-569 125723.48,-569 124499.69,-569 124499.69,-569 124499.69,-569 124499.69,-554.99 124499.69,-554.99"/>
<polygon fill="black" stroke="black" points="124503.19,-554.99 124499.69,-544.99 124496.19,-554.99 124503.19,-554.99"/>
</g>
<!-- L13_S1_TP6_GPU14_expert1&#45;&gt;L13_S1_TP6_GPU14_moe_ar -->
<g id="edge4119" class="edge">
<title>L13_S1_TP6_GPU14_expert1&#45;&gt;L13_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M125789.14,-604.49C125789.14,-586.46 125789.14,-568 125789.14,-568 125789.14,-568 125168.23,-568 125168.23,-568 125168.23,-568 125168.23,-559.19 125168.23,-559.19"/>
<polygon fill="black" stroke="black" points="125171.73,-559.19 125168.23,-549.19 125164.73,-559.19 125171.73,-559.19"/>
</g>
<!-- L13_S1_TP6_GPU14_expert1&#45;&gt;L13_S1_TP7_GPU15_moe_ar -->
<g id="edge4155" class="edge">
<title>L13_S1_TP6_GPU14_expert1&#45;&gt;L13_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M125854.8,-604.34C125854.8,-604.34 125854.8,-559.3 125854.8,-559.3"/>
<polygon fill="black" stroke="black" points="125858.3,-559.3 125854.8,-549.3 125851.3,-559.3 125858.3,-559.3"/>
</g>
<!-- L13_S1_TP7_GPU15_expert0 -->
<g id="node1393" class="node">
<title>L13_S1_TP7_GPU15_expert0</title>
<polygon fill="none" stroke="black" points="126442.5,-672.5 125993.5,-672.5 125993.5,-604.5 126442.5,-604.5 126442.5,-672.5"/>
<text text-anchor="middle" x="126218" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="126218" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="126218" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="126218" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L13_S1_TP7_GPU15_expert0&#45;&gt;L13_S1_TP0_GPU8_moe_ar -->
<g id="edge3904" class="edge">
<title>L13_S1_TP7_GPU15_expert0&#45;&gt;L13_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M126021.5,-604.27C126021.5,-547.97 126021.5,-442 126021.5,-442 126021.5,-442 121018.23,-442 121018.23,-442 121018.23,-442 121018.23,-476.71 121018.23,-476.71"/>
<polygon fill="black" stroke="black" points="121014.73,-476.71 121018.23,-486.71 121021.73,-476.71 121014.73,-476.71"/>
</g>
<!-- L13_S1_TP7_GPU15_expert0&#45;&gt;L13_S1_TP1_GPU9_moe_ar -->
<g id="edge3940" class="edge">
<title>L13_S1_TP7_GPU15_expert0&#45;&gt;L13_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M126018,-604.27C126018,-547.97 126018,-442 126018,-442 126018,-442 121631.23,-442 121631.23,-442 121631.23,-442 121631.23,-468.45 121631.23,-468.45"/>
<polygon fill="black" stroke="black" points="121627.73,-468.45 121631.23,-478.45 121634.73,-468.45 121627.73,-468.45"/>
</g>
<!-- L13_S1_TP7_GPU15_expert0&#45;&gt;L13_S1_TP2_GPU10_moe_ar -->
<g id="edge3976" class="edge">
<title>L13_S1_TP7_GPU15_expert0&#45;&gt;L13_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M126014.5,-604.27C126014.5,-547.97 126014.5,-442 126014.5,-442 126014.5,-442 122262.23,-442 122262.23,-442 122262.23,-442 122262.23,-464.8 122262.23,-464.8"/>
<polygon fill="black" stroke="black" points="122258.73,-464.8 122262.23,-474.8 122265.73,-464.8 122258.73,-464.8"/>
</g>
<!-- L13_S1_TP7_GPU15_expert0&#45;&gt;L13_S1_TP3_GPU11_moe_ar -->
<g id="edge4012" class="edge">
<title>L13_S1_TP7_GPU15_expert0&#45;&gt;L13_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M126011,-604.27C126011,-547.97 126011,-442 126011,-442 126011,-442 122984.38,-442 122984.38,-442 122984.38,-442 122984.38,-467.08 122984.38,-467.08"/>
<polygon fill="black" stroke="black" points="122980.88,-467.08 122984.38,-477.08 122987.88,-467.08 122980.88,-467.08"/>
</g>
<!-- L13_S1_TP7_GPU15_expert0&#45;&gt;L13_S1_TP4_GPU12_moe_ar -->
<g id="edge4048" class="edge">
<title>L13_S1_TP7_GPU15_expert0&#45;&gt;L13_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M126007.5,-604.27C126007.5,-547.97 126007.5,-442 126007.5,-442 126007.5,-442 123749.05,-442 123749.05,-442 123749.05,-442 123749.05,-474.42 123749.05,-474.42"/>
<polygon fill="black" stroke="black" points="123745.55,-474.42 123749.05,-484.42 123752.55,-474.42 123745.55,-474.42"/>
</g>
<!-- L13_S1_TP7_GPU15_expert0&#45;&gt;L13_S1_TP5_GPU13_moe_ar -->
<g id="edge4084" class="edge">
<title>L13_S1_TP7_GPU15_expert0&#45;&gt;L13_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M126004,-604.27C126004,-547.97 126004,-442 126004,-442 126004,-442 124514.6,-442 124514.6,-442 124514.6,-442 124514.6,-489.81 124514.6,-489.81"/>
<polygon fill="black" stroke="black" points="124511.1,-489.81 124514.6,-499.81 124518.1,-489.81 124511.1,-489.81"/>
</g>
<!-- L13_S1_TP7_GPU15_expert0&#45;&gt;L13_S1_TP6_GPU14_moe_ar -->
<g id="edge4120" class="edge">
<title>L13_S1_TP7_GPU15_expert0&#45;&gt;L13_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M125997,-604.49C125997,-586.46 125997,-568 125997,-568 125997,-568 125189.97,-568 125189.97,-568 125189.97,-568 125189.97,-554.21 125189.97,-554.21"/>
<polygon fill="black" stroke="black" points="125193.47,-554.21 125189.97,-544.21 125186.47,-554.21 125193.47,-554.21"/>
</g>
<!-- L13_S1_TP7_GPU15_expert0&#45;&gt;L13_S1_TP7_GPU15_moe_ar -->
<g id="edge4156" class="edge">
<title>L13_S1_TP7_GPU15_expert0&#45;&gt;L13_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M126000.5,-604.13C126000.5,-580.74 126000.5,-554 126000.5,-554 126000.5,-554 125835.62,-554 125835.62,-554"/>
<polygon fill="black" stroke="black" points="125835.62,-550.5 125825.62,-554 125835.62,-557.5 125835.62,-550.5"/>
</g>
<!-- L13_S1_TP7_GPU15_expert1 -->
<g id="node1394" class="node">
<title>L13_S1_TP7_GPU15_expert1</title>
<polygon fill="none" stroke="black" points="126909.5,-672.5 126460.5,-672.5 126460.5,-604.5 126909.5,-604.5 126909.5,-672.5"/>
<text text-anchor="middle" x="126685" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="126685" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="126685" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="126685" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L13_S1_TP7_GPU15_expert1&#45;&gt;L13_S1_TP0_GPU8_moe_ar -->
<g id="edge3905" class="edge">
<title>L13_S1_TP7_GPU15_expert1&#45;&gt;L13_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M126802.28,-604.1C126802.28,-547.51 126802.28,-441 126802.28,-441 126802.28,-441 120971.62,-441 120971.62,-441 120971.62,-441 120971.62,-471.17 120971.62,-471.17"/>
<polygon fill="black" stroke="black" points="120968.12,-471.17 120971.62,-481.17 120975.12,-471.17 120968.12,-471.17"/>
</g>
<!-- L13_S1_TP7_GPU15_expert1&#45;&gt;L13_S1_TP1_GPU9_moe_ar -->
<g id="edge3941" class="edge">
<title>L13_S1_TP7_GPU15_expert1&#45;&gt;L13_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M126759.56,-604.1C126759.56,-547.51 126759.56,-441 126759.56,-441 126759.56,-441 121464,-441 121464,-441 121464,-441 121464,-461.93 121464,-461.93"/>
<polygon fill="black" stroke="black" points="121460.5,-461.93 121464,-471.93 121467.5,-461.93 121460.5,-461.93"/>
</g>
<!-- L13_S1_TP7_GPU15_expert1&#45;&gt;L13_S1_TP2_GPU10_moe_ar -->
<g id="edge3977" class="edge">
<title>L13_S1_TP7_GPU15_expert1&#45;&gt;L13_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M126716.83,-604.1C126716.83,-547.51 126716.83,-441 126716.83,-441 126716.83,-441 122150.62,-441 122150.62,-441 122150.62,-441 122150.62,-461.93 122150.62,-461.93"/>
<polygon fill="black" stroke="black" points="122147.12,-461.93 122150.62,-471.93 122154.12,-461.93 122147.12,-461.93"/>
</g>
<!-- L13_S1_TP7_GPU15_expert1&#45;&gt;L13_S1_TP3_GPU11_moe_ar -->
<g id="edge4013" class="edge">
<title>L13_S1_TP7_GPU15_expert1&#45;&gt;L13_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M126674.11,-604.1C126674.11,-547.51 126674.11,-441 126674.11,-441 126674.11,-441 122921.69,-441 122921.69,-441 122921.69,-441 122921.69,-463.76 122921.69,-463.76"/>
<polygon fill="black" stroke="black" points="122918.19,-463.76 122921.69,-473.76 122925.19,-463.76 122918.19,-463.76"/>
</g>
<!-- L13_S1_TP7_GPU15_expert1&#45;&gt;L13_S1_TP4_GPU12_moe_ar -->
<g id="edge4049" class="edge">
<title>L13_S1_TP7_GPU15_expert1&#45;&gt;L13_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M126631.39,-604.1C126631.39,-547.51 126631.39,-441 126631.39,-441 126631.39,-441 123638.64,-441 123638.64,-441 123638.64,-441 123638.64,-465.14 123638.64,-465.14"/>
<polygon fill="black" stroke="black" points="123635.14,-465.14 123638.64,-475.14 123642.14,-465.14 123635.14,-465.14"/>
</g>
<!-- L13_S1_TP7_GPU15_expert1&#45;&gt;L13_S1_TP5_GPU13_moe_ar -->
<g id="edge4085" class="edge">
<title>L13_S1_TP7_GPU15_expert1&#45;&gt;L13_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M126588.67,-604.27C126588.67,-547.97 126588.67,-442 126588.67,-442 126588.67,-442 124482.73,-442 124482.73,-442 124482.73,-442 124482.73,-482.11 124482.73,-482.11"/>
<polygon fill="black" stroke="black" points="124479.23,-482.11 124482.73,-492.11 124486.23,-482.11 124479.23,-482.11"/>
</g>
<!-- L13_S1_TP7_GPU15_expert1&#45;&gt;L13_S1_TP6_GPU14_moe_ar -->
<g id="edge4121" class="edge">
<title>L13_S1_TP7_GPU15_expert1&#45;&gt;L13_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M126503.22,-604.49C126503.22,-586.46 126503.22,-568 126503.22,-568 126503.22,-568 125211.72,-568 125211.72,-568 125211.72,-568 125211.72,-547.6 125211.72,-547.6"/>
<polygon fill="black" stroke="black" points="125215.22,-547.6 125211.72,-537.6 125208.22,-547.6 125215.22,-547.6"/>
</g>
<!-- L13_S1_TP7_GPU15_expert1&#45;&gt;L13_S1_TP7_GPU15_moe_ar -->
<g id="edge4157" class="edge">
<title>L13_S1_TP7_GPU15_expert1&#45;&gt;L13_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M126545.94,-604.4C126545.94,-576.28 126545.94,-541 126545.94,-541 126545.94,-541 125898.41,-541 125898.41,-541"/>
<polygon fill="black" stroke="black" points="125898.41,-537.5 125888.41,-541 125898.41,-544.5 125898.41,-537.5"/>
</g>
<!-- L13_S1_TP0_GPU8_norm -->
<g id="node1396" class="node">
<title>L13_S1_TP0_GPU8_norm</title>
<polygon fill="none" stroke="black" points="119412.5,-332.33 118963.5,-332.33 118963.5,-264.33 119412.5,-264.33 119412.5,-332.33"/>
<text text-anchor="middle" x="119188" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="119188" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="119188" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="119188" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP0_GPU8_moe_res&#45;&gt;L13_S1_TP0_GPU8_norm -->
<g id="edge3908" class="edge">
<title>L13_S1_TP0_GPU8_moe_res&#45;&gt;L13_S1_TP0_GPU8_norm</title>
<path fill="none" stroke="black" d="M119188,-368.28C119188,-368.28 119188,-342.46 119188,-342.46"/>
<polygon fill="black" stroke="black" points="119191.5,-342.46 119188,-332.46 119184.5,-342.46 119191.5,-342.46"/>
</g>
<!-- L13_S1_TP1_GPU9_qkv_linear -->
<g id="node1397" class="node">
<title>L13_S1_TP1_GPU9_qkv_linear</title>
<polygon fill="none" stroke="black" points="120886,-1614.75 120278,-1614.75 120278,-1546.75 120886,-1546.75 120886,-1614.75"/>
<text text-anchor="middle" x="120582" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="120582" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="120582" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="120582" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L13_S1_TP1_GPU9_qkv_slice -->
<g id="node1398" class="node">
<title>L13_S1_TP1_GPU9_qkv_slice</title>
<polygon fill="none" stroke="black" points="120880,-1496.67 120284,-1496.67 120284,-1428.67 120880,-1428.67 120880,-1496.67"/>
<text text-anchor="middle" x="120582" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="120582" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="120582" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="120582" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L13_S1_TP1_GPU9_qkv_linear&#45;&gt;L13_S1_TP1_GPU9_qkv_slice -->
<g id="edge3909" class="edge">
<title>L13_S1_TP1_GPU9_qkv_linear&#45;&gt;L13_S1_TP1_GPU9_qkv_slice</title>
<path fill="none" stroke="black" d="M120582,-1546.59C120582,-1546.59 120582,-1506.74 120582,-1506.74"/>
<polygon fill="black" stroke="black" points="120585.5,-1506.74 120582,-1496.74 120578.5,-1506.74 120585.5,-1506.74"/>
</g>
<!-- L13_S1_TP1_GPU9_qkv_slice&#45;&gt;L13_S1_TP1_GPU9_attn_v -->
<g id="edge3913" class="edge">
<title>L13_S1_TP1_GPU9_qkv_slice&#45;&gt;L13_S1_TP1_GPU9_attn_v</title>
<path fill="none" stroke="black" d="M120342.75,-1428.38C120342.75,-1428.38 120342.75,-1195 120342.75,-1195"/>
<polygon fill="black" stroke="black" points="120346.25,-1195 120342.75,-1185 120339.25,-1195 120346.25,-1195"/>
</g>
<!-- L13_S1_TP1_GPU9_qk_matmul -->
<g id="node1399" class="node">
<title>L13_S1_TP1_GPU9_qk_matmul</title>
<polygon fill="none" stroke="black" points="121297.5,-1392.67 120362.5,-1392.67 120362.5,-1324.67 121297.5,-1324.67 121297.5,-1392.67"/>
<text text-anchor="middle" x="120830" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="120830" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="120830" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="120830" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L13_S1_TP1_GPU9_qkv_slice&#45;&gt;L13_S1_TP1_GPU9_qk_matmul -->
<g id="edge3910" class="edge">
<title>L13_S1_TP1_GPU9_qkv_slice&#45;&gt;L13_S1_TP1_GPU9_qk_matmul</title>
<path fill="none" stroke="black" d="M120621.25,-1428.61C120621.25,-1428.61 120621.25,-1402.8 120621.25,-1402.8"/>
<polygon fill="black" stroke="black" points="120624.75,-1402.8 120621.25,-1392.8 120617.75,-1402.8 120624.75,-1402.8"/>
</g>
<!-- L13_S1_TP1_GPU9_softmax -->
<g id="node1400" class="node">
<title>L13_S1_TP1_GPU9_softmax</title>
<polygon fill="none" stroke="black" points="121066,-1288.67 120556,-1288.67 120556,-1220.67 121066,-1220.67 121066,-1288.67"/>
<text text-anchor="middle" x="120811" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="120811" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="120811" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="120811" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L13_S1_TP1_GPU9_qk_matmul&#45;&gt;L13_S1_TP1_GPU9_softmax -->
<g id="edge3911" class="edge">
<title>L13_S1_TP1_GPU9_qk_matmul&#45;&gt;L13_S1_TP1_GPU9_softmax</title>
<path fill="none" stroke="black" d="M120811,-1324.61C120811,-1324.61 120811,-1298.8 120811,-1298.8"/>
<polygon fill="black" stroke="black" points="120814.5,-1298.8 120811,-1288.8 120807.5,-1298.8 120814.5,-1298.8"/>
</g>
<!-- L13_S1_TP1_GPU9_softmax&#45;&gt;L13_S1_TP1_GPU9_attn_v -->
<g id="edge3912" class="edge">
<title>L13_S1_TP1_GPU9_softmax&#45;&gt;L13_S1_TP1_GPU9_attn_v</title>
<path fill="none" stroke="black" d="M120811,-1220.61C120811,-1220.61 120811,-1194.8 120811,-1194.8"/>
<polygon fill="black" stroke="black" points="120814.5,-1194.8 120811,-1184.8 120807.5,-1194.8 120814.5,-1194.8"/>
</g>
<!-- L13_S1_TP1_GPU9_mha_res -->
<g id="node1402" class="node">
<title>L13_S1_TP1_GPU9_mha_res</title>
<polygon fill="none" stroke="black" points="120931.5,-948.5 120044.5,-948.5 120044.5,-880.5 120931.5,-880.5 120931.5,-948.5"/>
<text text-anchor="middle" x="120488" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="120488" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="120488" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="120488" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP1_GPU9_mha_ar&#45;&gt;L13_S1_TP1_GPU9_mha_res -->
<g id="edge3922" class="edge">
<title>L13_S1_TP1_GPU9_mha_ar&#45;&gt;L13_S1_TP1_GPU9_mha_res</title>
<path fill="none" stroke="black" d="M120908.01,-1015.66C120908.01,-1015.66 120908.01,-958.91 120908.01,-958.91"/>
<polygon fill="black" stroke="black" points="120911.51,-958.91 120908.01,-948.91 120904.51,-958.91 120911.51,-958.91"/>
</g>
<!-- L13_S1_TP1_GPU9_gate -->
<g id="node1403" class="node">
<title>L13_S1_TP1_GPU9_gate</title>
<polygon fill="none" stroke="black" points="121017.56,-844.5 120175.15,-844.5 119958.44,-708.5 120800.85,-708.5 121017.56,-844.5"/>
<text text-anchor="middle" x="120488" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="120488" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="120488" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="120488" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L13_S1_TP1_GPU9_mha_res&#45;&gt;L13_S1_TP1_GPU9_gate -->
<g id="edge3923" class="edge">
<title>L13_S1_TP1_GPU9_mha_res&#45;&gt;L13_S1_TP1_GPU9_gate</title>
<path fill="none" stroke="black" d="M120488,-880.39C120488,-880.39 120488,-854.73 120488,-854.73"/>
<polygon fill="black" stroke="black" points="120491.5,-854.73 120488,-844.73 120484.5,-854.73 120491.5,-854.73"/>
</g>
<!-- L13_S1_TP1_GPU9_moe_res -->
<g id="node1405" class="node">
<title>L13_S1_TP1_GPU9_moe_res</title>
<polygon fill="none" stroke="black" points="120925,-436.33 120105,-436.33 120105,-368.33 120925,-368.33 120925,-436.33"/>
<text text-anchor="middle" x="120515" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="120515" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="120515" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="120515" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP1_GPU9_mha_res&#45;&gt;L13_S1_TP1_GPU9_moe_res -->
<g id="edge3943" class="edge">
<title>L13_S1_TP1_GPU9_mha_res&#45;&gt;L13_S1_TP1_GPU9_moe_res</title>
<path fill="none" stroke="black" d="M120044.43,-914C119987.73,-914 119949,-914 119949,-914 119949,-914 119949,-673 119949,-673 119949,-673 120380.5,-673 120380.5,-673 120380.5,-673 120380.5,-446.34 120380.5,-446.34"/>
<polygon fill="black" stroke="black" points="120384,-446.34 120380.5,-436.34 120377,-446.34 120384,-446.34"/>
</g>
<!-- L13_S1_TP1_GPU9_gate&#45;&gt;L13_S1_TP1_GPU9_expert0 -->
<g id="edge3924" class="edge">
<title>L13_S1_TP1_GPU9_gate&#45;&gt;L13_S1_TP1_GPU9_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M120539.17,-708.31C120539.17,-708.31 120539.17,-682.71 120539.17,-682.71"/>
<polygon fill="black" stroke="black" points="120542.67,-682.71 120539.17,-672.71 120535.67,-682.71 120542.67,-682.71"/>
</g>
<!-- L13_S1_TP1_GPU9_gate&#45;&gt;L13_S1_TP1_GPU9_expert1 -->
<g id="edge3925" class="edge">
<title>L13_S1_TP1_GPU9_gate&#45;&gt;L13_S1_TP1_GPU9_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M120937.14,-776.4C120937.14,-776.4 120937.14,-682.74 120937.14,-682.74"/>
<polygon fill="black" stroke="black" points="120940.64,-682.74 120937.14,-672.74 120933.64,-682.74 120940.64,-682.74"/>
</g>
<!-- L13_S1_TP1_GPU9_moe_ar&#45;&gt;L13_S1_TP1_GPU9_moe_res -->
<g id="edge3942" class="edge">
<title>L13_S1_TP1_GPU9_moe_ar&#45;&gt;L13_S1_TP1_GPU9_moe_res</title>
<path fill="none" stroke="black" d="M121296.77,-478.7C121296.77,-457.44 121296.77,-436 121296.77,-436 121296.77,-436 120935.16,-436 120935.16,-436"/>
<polygon fill="black" stroke="black" points="120935.16,-432.5 120925.16,-436 120935.16,-439.5 120935.16,-432.5"/>
</g>
<!-- L13_S1_TP1_GPU9_norm -->
<g id="node1406" class="node">
<title>L13_S1_TP1_GPU9_norm</title>
<polygon fill="none" stroke="black" points="120739.5,-332.33 120290.5,-332.33 120290.5,-264.33 120739.5,-264.33 120739.5,-332.33"/>
<text text-anchor="middle" x="120515" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="120515" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="120515" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="120515" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP1_GPU9_moe_res&#45;&gt;L13_S1_TP1_GPU9_norm -->
<g id="edge3944" class="edge">
<title>L13_S1_TP1_GPU9_moe_res&#45;&gt;L13_S1_TP1_GPU9_norm</title>
<path fill="none" stroke="black" d="M120515,-368.28C120515,-368.28 120515,-342.46 120515,-342.46"/>
<polygon fill="black" stroke="black" points="120518.5,-342.46 120515,-332.46 120511.5,-342.46 120518.5,-342.46"/>
</g>
<!-- L13_S1_TP2_GPU10_qkv_linear -->
<g id="node1407" class="node">
<title>L13_S1_TP2_GPU10_qkv_linear</title>
<polygon fill="none" stroke="black" points="121894,-1614.75 121286,-1614.75 121286,-1546.75 121894,-1546.75 121894,-1614.75"/>
<text text-anchor="middle" x="121590" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="121590" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="121590" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="121590" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L13_S1_TP2_GPU10_qkv_slice -->
<g id="node1408" class="node">
<title>L13_S1_TP2_GPU10_qkv_slice</title>
<polygon fill="none" stroke="black" points="121888,-1496.67 121292,-1496.67 121292,-1428.67 121888,-1428.67 121888,-1496.67"/>
<text text-anchor="middle" x="121590" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="121590" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="121590" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="121590" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L13_S1_TP2_GPU10_qkv_linear&#45;&gt;L13_S1_TP2_GPU10_qkv_slice -->
<g id="edge3945" class="edge">
<title>L13_S1_TP2_GPU10_qkv_linear&#45;&gt;L13_S1_TP2_GPU10_qkv_slice</title>
<path fill="none" stroke="black" d="M121590,-1546.59C121590,-1546.59 121590,-1506.74 121590,-1506.74"/>
<polygon fill="black" stroke="black" points="121593.5,-1506.74 121590,-1496.74 121586.5,-1506.74 121593.5,-1506.74"/>
</g>
<!-- L13_S1_TP2_GPU10_qkv_slice&#45;&gt;L13_S1_TP2_GPU10_attn_v -->
<g id="edge3949" class="edge">
<title>L13_S1_TP2_GPU10_qkv_slice&#45;&gt;L13_S1_TP2_GPU10_attn_v</title>
<path fill="none" stroke="black" d="M121334,-1428.38C121334,-1428.38 121334,-1195 121334,-1195"/>
<polygon fill="black" stroke="black" points="121337.5,-1195 121334,-1185 121330.5,-1195 121337.5,-1195"/>
</g>
<!-- L13_S1_TP2_GPU10_qk_matmul -->
<g id="node1409" class="node">
<title>L13_S1_TP2_GPU10_qk_matmul</title>
<polygon fill="none" stroke="black" points="122305.5,-1392.67 121370.5,-1392.67 121370.5,-1324.67 122305.5,-1324.67 122305.5,-1392.67"/>
<text text-anchor="middle" x="121838" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="121838" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="121838" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="121838" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L13_S1_TP2_GPU10_qkv_slice&#45;&gt;L13_S1_TP2_GPU10_qk_matmul -->
<g id="edge3946" class="edge">
<title>L13_S1_TP2_GPU10_qkv_slice&#45;&gt;L13_S1_TP2_GPU10_qk_matmul</title>
<path fill="none" stroke="black" d="M121629.25,-1428.61C121629.25,-1428.61 121629.25,-1402.8 121629.25,-1402.8"/>
<polygon fill="black" stroke="black" points="121632.75,-1402.8 121629.25,-1392.8 121625.75,-1402.8 121632.75,-1402.8"/>
</g>
<!-- L13_S1_TP2_GPU10_softmax -->
<g id="node1410" class="node">
<title>L13_S1_TP2_GPU10_softmax</title>
<polygon fill="none" stroke="black" points="122048,-1288.67 121538,-1288.67 121538,-1220.67 122048,-1220.67 122048,-1288.67"/>
<text text-anchor="middle" x="121793" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="121793" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="121793" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="121793" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L13_S1_TP2_GPU10_qk_matmul&#45;&gt;L13_S1_TP2_GPU10_softmax -->
<g id="edge3947" class="edge">
<title>L13_S1_TP2_GPU10_qk_matmul&#45;&gt;L13_S1_TP2_GPU10_softmax</title>
<path fill="none" stroke="black" d="M121793,-1324.61C121793,-1324.61 121793,-1298.8 121793,-1298.8"/>
<polygon fill="black" stroke="black" points="121796.5,-1298.8 121793,-1288.8 121789.5,-1298.8 121796.5,-1298.8"/>
</g>
<!-- L13_S1_TP2_GPU10_softmax&#45;&gt;L13_S1_TP2_GPU10_attn_v -->
<g id="edge3948" class="edge">
<title>L13_S1_TP2_GPU10_softmax&#45;&gt;L13_S1_TP2_GPU10_attn_v</title>
<path fill="none" stroke="black" d="M121793,-1220.61C121793,-1220.61 121793,-1194.8 121793,-1194.8"/>
<polygon fill="black" stroke="black" points="121796.5,-1194.8 121793,-1184.8 121789.5,-1194.8 121796.5,-1194.8"/>
</g>
<!-- L13_S1_TP2_GPU10_mha_res -->
<g id="node1412" class="node">
<title>L13_S1_TP2_GPU10_mha_res</title>
<polygon fill="none" stroke="black" points="122009.5,-948.5 121122.5,-948.5 121122.5,-880.5 122009.5,-880.5 122009.5,-948.5"/>
<text text-anchor="middle" x="121566" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="121566" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="121566" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="121566" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP2_GPU10_mha_ar&#45;&gt;L13_S1_TP2_GPU10_mha_res -->
<g id="edge3958" class="edge">
<title>L13_S1_TP2_GPU10_mha_ar&#45;&gt;L13_S1_TP2_GPU10_mha_res</title>
<path fill="none" stroke="black" d="M121831.51,-991.61C121831.51,-991.61 121831.51,-958.74 121831.51,-958.74"/>
<polygon fill="black" stroke="black" points="121835.01,-958.74 121831.51,-948.74 121828.01,-958.74 121835.01,-958.74"/>
</g>
<!-- L13_S1_TP2_GPU10_gate -->
<g id="node1413" class="node">
<title>L13_S1_TP2_GPU10_gate</title>
<polygon fill="none" stroke="black" points="122095.56,-844.5 121253.15,-844.5 121036.44,-708.5 121878.85,-708.5 122095.56,-844.5"/>
<text text-anchor="middle" x="121566" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="121566" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="121566" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="121566" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L13_S1_TP2_GPU10_mha_res&#45;&gt;L13_S1_TP2_GPU10_gate -->
<g id="edge3959" class="edge">
<title>L13_S1_TP2_GPU10_mha_res&#45;&gt;L13_S1_TP2_GPU10_gate</title>
<path fill="none" stroke="black" d="M121566,-880.39C121566,-880.39 121566,-854.73 121566,-854.73"/>
<polygon fill="black" stroke="black" points="121569.5,-854.73 121566,-844.73 121562.5,-854.73 121569.5,-854.73"/>
</g>
<!-- L13_S1_TP2_GPU10_moe_res -->
<g id="node1415" class="node">
<title>L13_S1_TP2_GPU10_moe_res</title>
<polygon fill="none" stroke="black" points="121935,-436.33 121115,-436.33 121115,-368.33 121935,-368.33 121935,-436.33"/>
<text text-anchor="middle" x="121525" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="121525" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="121525" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="121525" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP2_GPU10_mha_res&#45;&gt;L13_S1_TP2_GPU10_moe_res -->
<g id="edge3979" class="edge">
<title>L13_S1_TP2_GPU10_mha_res&#45;&gt;L13_S1_TP2_GPU10_moe_res</title>
<path fill="none" stroke="black" d="M122009.57,-914C122066.27,-914 122105,-914 122105,-914 122105,-914 122105,-675 122105,-675 122105,-675 121784.5,-675 121784.5,-675 121784.5,-675 121784.5,-572 121784.5,-572 121784.5,-572 121810.51,-572 121810.51,-572 121810.51,-572 121810.51,-446.67 121810.51,-446.67"/>
<polygon fill="black" stroke="black" points="121814.01,-446.67 121810.51,-436.67 121807.01,-446.67 121814.01,-446.67"/>
</g>
<!-- L13_S1_TP2_GPU10_gate&#45;&gt;L13_S1_TP2_GPU10_expert0 -->
<g id="edge3960" class="edge">
<title>L13_S1_TP2_GPU10_gate&#45;&gt;L13_S1_TP2_GPU10_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M121473.17,-708.31C121473.17,-708.31 121473.17,-682.71 121473.17,-682.71"/>
<polygon fill="black" stroke="black" points="121476.67,-682.71 121473.17,-672.71 121469.67,-682.71 121476.67,-682.71"/>
</g>
<!-- L13_S1_TP2_GPU10_gate&#45;&gt;L13_S1_TP2_GPU10_expert1 -->
<g id="edge3961" class="edge">
<title>L13_S1_TP2_GPU10_gate&#45;&gt;L13_S1_TP2_GPU10_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M121943.14,-748.57C121943.14,-748.57 121943.14,-682.74 121943.14,-682.74"/>
<polygon fill="black" stroke="black" points="121946.64,-682.74 121943.14,-672.74 121939.64,-682.74 121946.64,-682.74"/>
</g>
<!-- L13_S1_TP2_GPU10_moe_ar&#45;&gt;L13_S1_TP2_GPU10_moe_res -->
<g id="edge3978" class="edge">
<title>L13_S1_TP2_GPU10_moe_ar&#45;&gt;L13_S1_TP2_GPU10_moe_res</title>
<path fill="none" stroke="black" d="M121905.38,-487.52C121905.38,-487.52 121905.38,-446.7 121905.38,-446.7"/>
<polygon fill="black" stroke="black" points="121908.88,-446.7 121905.38,-436.7 121901.88,-446.7 121908.88,-446.7"/>
</g>
<!-- L13_S1_TP2_GPU10_norm -->
<g id="node1416" class="node">
<title>L13_S1_TP2_GPU10_norm</title>
<polygon fill="none" stroke="black" points="121749.5,-332.33 121300.5,-332.33 121300.5,-264.33 121749.5,-264.33 121749.5,-332.33"/>
<text text-anchor="middle" x="121525" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="121525" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="121525" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="121525" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP2_GPU10_moe_res&#45;&gt;L13_S1_TP2_GPU10_norm -->
<g id="edge3980" class="edge">
<title>L13_S1_TP2_GPU10_moe_res&#45;&gt;L13_S1_TP2_GPU10_norm</title>
<path fill="none" stroke="black" d="M121525,-368.28C121525,-368.28 121525,-342.46 121525,-342.46"/>
<polygon fill="black" stroke="black" points="121528.5,-342.46 121525,-332.46 121521.5,-342.46 121528.5,-342.46"/>
</g>
<!-- L13_S1_TP3_GPU11_qkv_linear -->
<g id="node1417" class="node">
<title>L13_S1_TP3_GPU11_qkv_linear</title>
<polygon fill="none" stroke="black" points="122894,-1614.75 122286,-1614.75 122286,-1546.75 122894,-1546.75 122894,-1614.75"/>
<text text-anchor="middle" x="122590" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="122590" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="122590" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="122590" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L13_S1_TP3_GPU11_qkv_slice -->
<g id="node1418" class="node">
<title>L13_S1_TP3_GPU11_qkv_slice</title>
<polygon fill="none" stroke="black" points="122888,-1496.67 122292,-1496.67 122292,-1428.67 122888,-1428.67 122888,-1496.67"/>
<text text-anchor="middle" x="122590" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="122590" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="122590" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="122590" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L13_S1_TP3_GPU11_qkv_linear&#45;&gt;L13_S1_TP3_GPU11_qkv_slice -->
<g id="edge3981" class="edge">
<title>L13_S1_TP3_GPU11_qkv_linear&#45;&gt;L13_S1_TP3_GPU11_qkv_slice</title>
<path fill="none" stroke="black" d="M122590,-1546.59C122590,-1546.59 122590,-1506.74 122590,-1506.74"/>
<polygon fill="black" stroke="black" points="122593.5,-1506.74 122590,-1496.74 122586.5,-1506.74 122593.5,-1506.74"/>
</g>
<!-- L13_S1_TP3_GPU11_qkv_slice&#45;&gt;L13_S1_TP3_GPU11_attn_v -->
<g id="edge3985" class="edge">
<title>L13_S1_TP3_GPU11_qkv_slice&#45;&gt;L13_S1_TP3_GPU11_attn_v</title>
<path fill="none" stroke="black" d="M122338,-1428.38C122338,-1428.38 122338,-1195 122338,-1195"/>
<polygon fill="black" stroke="black" points="122341.5,-1195 122338,-1185 122334.5,-1195 122341.5,-1195"/>
</g>
<!-- L13_S1_TP3_GPU11_qk_matmul -->
<g id="node1419" class="node">
<title>L13_S1_TP3_GPU11_qk_matmul</title>
<polygon fill="none" stroke="black" points="123305.5,-1392.67 122370.5,-1392.67 122370.5,-1324.67 123305.5,-1324.67 123305.5,-1392.67"/>
<text text-anchor="middle" x="122838" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="122838" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="122838" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="122838" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L13_S1_TP3_GPU11_qkv_slice&#45;&gt;L13_S1_TP3_GPU11_qk_matmul -->
<g id="edge3982" class="edge">
<title>L13_S1_TP3_GPU11_qkv_slice&#45;&gt;L13_S1_TP3_GPU11_qk_matmul</title>
<path fill="none" stroke="black" d="M122629.25,-1428.61C122629.25,-1428.61 122629.25,-1402.8 122629.25,-1402.8"/>
<polygon fill="black" stroke="black" points="122632.75,-1402.8 122629.25,-1392.8 122625.75,-1402.8 122632.75,-1402.8"/>
</g>
<!-- L13_S1_TP3_GPU11_softmax -->
<g id="node1420" class="node">
<title>L13_S1_TP3_GPU11_softmax</title>
<polygon fill="none" stroke="black" points="123026,-1288.67 122516,-1288.67 122516,-1220.67 123026,-1220.67 123026,-1288.67"/>
<text text-anchor="middle" x="122771" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="122771" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="122771" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="122771" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L13_S1_TP3_GPU11_qk_matmul&#45;&gt;L13_S1_TP3_GPU11_softmax -->
<g id="edge3983" class="edge">
<title>L13_S1_TP3_GPU11_qk_matmul&#45;&gt;L13_S1_TP3_GPU11_softmax</title>
<path fill="none" stroke="black" d="M122771,-1324.61C122771,-1324.61 122771,-1298.8 122771,-1298.8"/>
<polygon fill="black" stroke="black" points="122774.5,-1298.8 122771,-1288.8 122767.5,-1298.8 122774.5,-1298.8"/>
</g>
<!-- L13_S1_TP3_GPU11_softmax&#45;&gt;L13_S1_TP3_GPU11_attn_v -->
<g id="edge3984" class="edge">
<title>L13_S1_TP3_GPU11_softmax&#45;&gt;L13_S1_TP3_GPU11_attn_v</title>
<path fill="none" stroke="black" d="M122771,-1220.61C122771,-1220.61 122771,-1194.8 122771,-1194.8"/>
<polygon fill="black" stroke="black" points="122774.5,-1194.8 122771,-1184.8 122767.5,-1194.8 122774.5,-1194.8"/>
</g>
<!-- L13_S1_TP3_GPU11_mha_res -->
<g id="node1422" class="node">
<title>L13_S1_TP3_GPU11_mha_res</title>
<polygon fill="none" stroke="black" points="123087.5,-948.5 122200.5,-948.5 122200.5,-880.5 123087.5,-880.5 123087.5,-948.5"/>
<text text-anchor="middle" x="122644" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="122644" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="122644" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="122644" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP3_GPU11_mha_ar&#45;&gt;L13_S1_TP3_GPU11_mha_res -->
<g id="edge3994" class="edge">
<title>L13_S1_TP3_GPU11_mha_ar&#45;&gt;L13_S1_TP3_GPU11_mha_res</title>
<path fill="none" stroke="black" d="M122755.01,-984.55C122755.01,-984.55 122755.01,-958.73 122755.01,-958.73"/>
<polygon fill="black" stroke="black" points="122758.51,-958.73 122755.01,-948.73 122751.51,-958.73 122758.51,-958.73"/>
</g>
<!-- L13_S1_TP3_GPU11_gate -->
<g id="node1423" class="node">
<title>L13_S1_TP3_GPU11_gate</title>
<polygon fill="none" stroke="black" points="123173.56,-844.5 122331.15,-844.5 122114.44,-708.5 122956.85,-708.5 123173.56,-844.5"/>
<text text-anchor="middle" x="122644" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="122644" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="122644" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="122644" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L13_S1_TP3_GPU11_mha_res&#45;&gt;L13_S1_TP3_GPU11_gate -->
<g id="edge3995" class="edge">
<title>L13_S1_TP3_GPU11_mha_res&#45;&gt;L13_S1_TP3_GPU11_gate</title>
<path fill="none" stroke="black" d="M122644,-880.39C122644,-880.39 122644,-854.73 122644,-854.73"/>
<polygon fill="black" stroke="black" points="122647.5,-854.73 122644,-844.73 122640.5,-854.73 122647.5,-854.73"/>
</g>
<!-- L13_S1_TP3_GPU11_moe_res -->
<g id="node1425" class="node">
<title>L13_S1_TP3_GPU11_moe_res</title>
<polygon fill="none" stroke="black" points="122859,-436.33 122039,-436.33 122039,-368.33 122859,-368.33 122859,-436.33"/>
<text text-anchor="middle" x="122449" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="122449" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="122449" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="122449" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP3_GPU11_mha_res&#45;&gt;L13_S1_TP3_GPU11_moe_res -->
<g id="edge4015" class="edge">
<title>L13_S1_TP3_GPU11_mha_res&#45;&gt;L13_S1_TP3_GPU11_moe_res</title>
<path fill="none" stroke="black" d="M123087.64,-925C123145.82,-925 123185.75,-925 123185.75,-925 123185.75,-925 123185.75,-413 123185.75,-413 123185.75,-413 122869.12,-413 122869.12,-413"/>
<polygon fill="black" stroke="black" points="122869.12,-409.5 122859.12,-413 122869.12,-416.5 122869.12,-409.5"/>
</g>
<!-- L13_S1_TP3_GPU11_gate&#45;&gt;L13_S1_TP3_GPU11_expert0 -->
<g id="edge3996" class="edge">
<title>L13_S1_TP3_GPU11_gate&#45;&gt;L13_S1_TP3_GPU11_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M122369.75,-708.31C122369.75,-708.31 122369.75,-682.71 122369.75,-682.71"/>
<polygon fill="black" stroke="black" points="122373.25,-682.71 122369.75,-672.71 122366.25,-682.71 122373.25,-682.71"/>
</g>
<!-- L13_S1_TP3_GPU11_gate&#45;&gt;L13_S1_TP3_GPU11_expert1 -->
<g id="edge3997" class="edge">
<title>L13_S1_TP3_GPU11_gate&#45;&gt;L13_S1_TP3_GPU11_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M122836.75,-708.31C122836.75,-708.31 122836.75,-682.71 122836.75,-682.71"/>
<polygon fill="black" stroke="black" points="122840.25,-682.71 122836.75,-672.71 122833.25,-682.71 122840.25,-682.71"/>
</g>
<!-- L13_S1_TP3_GPU11_moe_ar&#45;&gt;L13_S1_TP3_GPU11_moe_res -->
<g id="edge4014" class="edge">
<title>L13_S1_TP3_GPU11_moe_ar&#45;&gt;L13_S1_TP3_GPU11_moe_res</title>
<path fill="none" stroke="black" d="M122770.13,-473.07C122770.13,-473.07 122770.13,-446.61 122770.13,-446.61"/>
<polygon fill="black" stroke="black" points="122773.63,-446.61 122770.13,-436.61 122766.63,-446.61 122773.63,-446.61"/>
</g>
<!-- L13_S1_TP3_GPU11_norm -->
<g id="node1426" class="node">
<title>L13_S1_TP3_GPU11_norm</title>
<polygon fill="none" stroke="black" points="122673.5,-332.33 122224.5,-332.33 122224.5,-264.33 122673.5,-264.33 122673.5,-332.33"/>
<text text-anchor="middle" x="122449" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="122449" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="122449" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="122449" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP3_GPU11_moe_res&#45;&gt;L13_S1_TP3_GPU11_norm -->
<g id="edge4016" class="edge">
<title>L13_S1_TP3_GPU11_moe_res&#45;&gt;L13_S1_TP3_GPU11_norm</title>
<path fill="none" stroke="black" d="M122449,-368.28C122449,-368.28 122449,-342.46 122449,-342.46"/>
<polygon fill="black" stroke="black" points="122452.5,-342.46 122449,-332.46 122445.5,-342.46 122452.5,-342.46"/>
</g>
<!-- L13_S1_TP4_GPU12_qkv_linear -->
<g id="node1427" class="node">
<title>L13_S1_TP4_GPU12_qkv_linear</title>
<polygon fill="none" stroke="black" points="123888,-1614.75 123280,-1614.75 123280,-1546.75 123888,-1546.75 123888,-1614.75"/>
<text text-anchor="middle" x="123584" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="123584" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="123584" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="123584" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L13_S1_TP4_GPU12_qkv_slice -->
<g id="node1428" class="node">
<title>L13_S1_TP4_GPU12_qkv_slice</title>
<polygon fill="none" stroke="black" points="123882,-1496.67 123286,-1496.67 123286,-1428.67 123882,-1428.67 123882,-1496.67"/>
<text text-anchor="middle" x="123584" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="123584" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="123584" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="123584" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L13_S1_TP4_GPU12_qkv_linear&#45;&gt;L13_S1_TP4_GPU12_qkv_slice -->
<g id="edge4017" class="edge">
<title>L13_S1_TP4_GPU12_qkv_linear&#45;&gt;L13_S1_TP4_GPU12_qkv_slice</title>
<path fill="none" stroke="black" d="M123584,-1546.59C123584,-1546.59 123584,-1506.74 123584,-1506.74"/>
<polygon fill="black" stroke="black" points="123587.5,-1506.74 123584,-1496.74 123580.5,-1506.74 123587.5,-1506.74"/>
</g>
<!-- L13_S1_TP4_GPU12_qkv_slice&#45;&gt;L13_S1_TP4_GPU12_attn_v -->
<g id="edge4021" class="edge">
<title>L13_S1_TP4_GPU12_qkv_slice&#45;&gt;L13_S1_TP4_GPU12_attn_v</title>
<path fill="none" stroke="black" d="M123335,-1428.38C123335,-1428.38 123335,-1195 123335,-1195"/>
<polygon fill="black" stroke="black" points="123338.5,-1195 123335,-1185 123331.5,-1195 123338.5,-1195"/>
</g>
<!-- L13_S1_TP4_GPU12_qk_matmul -->
<g id="node1429" class="node">
<title>L13_S1_TP4_GPU12_qk_matmul</title>
<polygon fill="none" stroke="black" points="124299.5,-1392.67 123364.5,-1392.67 123364.5,-1324.67 124299.5,-1324.67 124299.5,-1392.67"/>
<text text-anchor="middle" x="123832" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="123832" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="123832" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="123832" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L13_S1_TP4_GPU12_qkv_slice&#45;&gt;L13_S1_TP4_GPU12_qk_matmul -->
<g id="edge4018" class="edge">
<title>L13_S1_TP4_GPU12_qkv_slice&#45;&gt;L13_S1_TP4_GPU12_qk_matmul</title>
<path fill="none" stroke="black" d="M123623.25,-1428.61C123623.25,-1428.61 123623.25,-1402.8 123623.25,-1402.8"/>
<polygon fill="black" stroke="black" points="123626.75,-1402.8 123623.25,-1392.8 123619.75,-1402.8 123626.75,-1402.8"/>
</g>
<!-- L13_S1_TP4_GPU12_softmax -->
<g id="node1430" class="node">
<title>L13_S1_TP4_GPU12_softmax</title>
<polygon fill="none" stroke="black" points="124001,-1288.67 123491,-1288.67 123491,-1220.67 124001,-1220.67 124001,-1288.67"/>
<text text-anchor="middle" x="123746" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="123746" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="123746" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="123746" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L13_S1_TP4_GPU12_qk_matmul&#45;&gt;L13_S1_TP4_GPU12_softmax -->
<g id="edge4019" class="edge">
<title>L13_S1_TP4_GPU12_qk_matmul&#45;&gt;L13_S1_TP4_GPU12_softmax</title>
<path fill="none" stroke="black" d="M123746,-1324.61C123746,-1324.61 123746,-1298.8 123746,-1298.8"/>
<polygon fill="black" stroke="black" points="123749.5,-1298.8 123746,-1288.8 123742.5,-1298.8 123749.5,-1298.8"/>
</g>
<!-- L13_S1_TP4_GPU12_softmax&#45;&gt;L13_S1_TP4_GPU12_attn_v -->
<g id="edge4020" class="edge">
<title>L13_S1_TP4_GPU12_softmax&#45;&gt;L13_S1_TP4_GPU12_attn_v</title>
<path fill="none" stroke="black" d="M123746,-1220.61C123746,-1220.61 123746,-1194.8 123746,-1194.8"/>
<polygon fill="black" stroke="black" points="123749.5,-1194.8 123746,-1184.8 123742.5,-1194.8 123749.5,-1194.8"/>
</g>
<!-- L13_S1_TP4_GPU12_mha_res -->
<g id="node1432" class="node">
<title>L13_S1_TP4_GPU12_mha_res</title>
<polygon fill="none" stroke="black" points="124165.5,-948.5 123278.5,-948.5 123278.5,-880.5 124165.5,-880.5 124165.5,-948.5"/>
<text text-anchor="middle" x="123722" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="123722" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="123722" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="123722" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP4_GPU12_mha_ar&#45;&gt;L13_S1_TP4_GPU12_mha_res -->
<g id="edge4030" class="edge">
<title>L13_S1_TP4_GPU12_mha_ar&#45;&gt;L13_S1_TP4_GPU12_mha_res</title>
<path fill="none" stroke="black" d="M123610.49,-984.55C123610.49,-984.55 123610.49,-958.73 123610.49,-958.73"/>
<polygon fill="black" stroke="black" points="123613.99,-958.73 123610.49,-948.73 123606.99,-958.73 123613.99,-958.73"/>
</g>
<!-- L13_S1_TP4_GPU12_gate -->
<g id="node1433" class="node">
<title>L13_S1_TP4_GPU12_gate</title>
<polygon fill="none" stroke="black" points="124251.56,-844.5 123409.15,-844.5 123192.44,-708.5 124034.85,-708.5 124251.56,-844.5"/>
<text text-anchor="middle" x="123722" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="123722" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="123722" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="123722" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L13_S1_TP4_GPU12_mha_res&#45;&gt;L13_S1_TP4_GPU12_gate -->
<g id="edge4031" class="edge">
<title>L13_S1_TP4_GPU12_mha_res&#45;&gt;L13_S1_TP4_GPU12_gate</title>
<path fill="none" stroke="black" d="M123722,-880.39C123722,-880.39 123722,-854.73 123722,-854.73"/>
<polygon fill="black" stroke="black" points="123725.5,-854.73 123722,-844.73 123718.5,-854.73 123725.5,-854.73"/>
</g>
<!-- L13_S1_TP4_GPU12_moe_res -->
<g id="node1435" class="node">
<title>L13_S1_TP4_GPU12_moe_res</title>
<polygon fill="none" stroke="black" points="124017,-436.33 123197,-436.33 123197,-368.33 124017,-368.33 124017,-436.33"/>
<text text-anchor="middle" x="123607" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="123607" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="123607" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="123607" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP4_GPU12_mha_res&#45;&gt;L13_S1_TP4_GPU12_moe_res -->
<g id="edge4051" class="edge">
<title>L13_S1_TP4_GPU12_mha_res&#45;&gt;L13_S1_TP4_GPU12_moe_res</title>
<path fill="none" stroke="black" d="M123278.4,-903C123224.58,-903 123188.14,-903 123188.14,-903 123188.14,-903 123188.14,-390 123188.14,-390 123188.14,-390 123189.02,-390 123189.02,-390"/>
<polygon fill="black" stroke="black" points="123186.89,-393.5 123196.89,-390 123186.89,-386.5 123186.89,-393.5"/>
</g>
<!-- L13_S1_TP4_GPU12_gate&#45;&gt;L13_S1_TP4_GPU12_expert0 -->
<g id="edge4032" class="edge">
<title>L13_S1_TP4_GPU12_gate&#45;&gt;L13_S1_TP4_GPU12_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M123528.43,-708.31C123528.43,-708.31 123528.43,-682.71 123528.43,-682.71"/>
<polygon fill="black" stroke="black" points="123531.93,-682.71 123528.43,-672.71 123524.93,-682.71 123531.93,-682.71"/>
</g>
<!-- L13_S1_TP4_GPU12_gate&#45;&gt;L13_S1_TP4_GPU12_expert1 -->
<g id="edge4033" class="edge">
<title>L13_S1_TP4_GPU12_gate&#45;&gt;L13_S1_TP4_GPU12_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M123957.83,-708.31C123957.83,-708.31 123957.83,-682.71 123957.83,-682.71"/>
<polygon fill="black" stroke="black" points="123961.33,-682.71 123957.83,-672.71 123954.33,-682.71 123961.33,-682.71"/>
</g>
<!-- L13_S1_TP4_GPU12_moe_ar&#45;&gt;L13_S1_TP4_GPU12_moe_res -->
<g id="edge4050" class="edge">
<title>L13_S1_TP4_GPU12_moe_ar&#45;&gt;L13_S1_TP4_GPU12_moe_res</title>
<path fill="none" stroke="black" d="M123528.23,-472.05C123528.23,-472.05 123528.23,-446.37 123528.23,-446.37"/>
<polygon fill="black" stroke="black" points="123531.73,-446.37 123528.23,-436.37 123524.73,-446.37 123531.73,-446.37"/>
</g>
<!-- L13_S1_TP4_GPU12_norm -->
<g id="node1436" class="node">
<title>L13_S1_TP4_GPU12_norm</title>
<polygon fill="none" stroke="black" points="123831.5,-332.33 123382.5,-332.33 123382.5,-264.33 123831.5,-264.33 123831.5,-332.33"/>
<text text-anchor="middle" x="123607" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="123607" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="123607" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="123607" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP4_GPU12_moe_res&#45;&gt;L13_S1_TP4_GPU12_norm -->
<g id="edge4052" class="edge">
<title>L13_S1_TP4_GPU12_moe_res&#45;&gt;L13_S1_TP4_GPU12_norm</title>
<path fill="none" stroke="black" d="M123607,-368.28C123607,-368.28 123607,-342.46 123607,-342.46"/>
<polygon fill="black" stroke="black" points="123610.5,-342.46 123607,-332.46 123603.5,-342.46 123610.5,-342.46"/>
</g>
<!-- L13_S1_TP5_GPU13_qkv_linear -->
<g id="node1437" class="node">
<title>L13_S1_TP5_GPU13_qkv_linear</title>
<polygon fill="none" stroke="black" points="124884,-1614.75 124276,-1614.75 124276,-1546.75 124884,-1546.75 124884,-1614.75"/>
<text text-anchor="middle" x="124580" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="124580" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="124580" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="124580" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L13_S1_TP5_GPU13_qkv_slice -->
<g id="node1438" class="node">
<title>L13_S1_TP5_GPU13_qkv_slice</title>
<polygon fill="none" stroke="black" points="124878,-1496.67 124282,-1496.67 124282,-1428.67 124878,-1428.67 124878,-1496.67"/>
<text text-anchor="middle" x="124580" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="124580" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="124580" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="124580" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L13_S1_TP5_GPU13_qkv_linear&#45;&gt;L13_S1_TP5_GPU13_qkv_slice -->
<g id="edge4053" class="edge">
<title>L13_S1_TP5_GPU13_qkv_linear&#45;&gt;L13_S1_TP5_GPU13_qkv_slice</title>
<path fill="none" stroke="black" d="M124580,-1546.59C124580,-1546.59 124580,-1506.74 124580,-1506.74"/>
<polygon fill="black" stroke="black" points="124583.5,-1506.74 124580,-1496.74 124576.5,-1506.74 124583.5,-1506.74"/>
</g>
<!-- L13_S1_TP5_GPU13_qkv_slice&#45;&gt;L13_S1_TP5_GPU13_attn_v -->
<g id="edge4057" class="edge">
<title>L13_S1_TP5_GPU13_qkv_slice&#45;&gt;L13_S1_TP5_GPU13_attn_v</title>
<path fill="none" stroke="black" d="M124330,-1428.38C124330,-1428.38 124330,-1195 124330,-1195"/>
<polygon fill="black" stroke="black" points="124333.5,-1195 124330,-1185 124326.5,-1195 124333.5,-1195"/>
</g>
<!-- L13_S1_TP5_GPU13_qk_matmul -->
<g id="node1439" class="node">
<title>L13_S1_TP5_GPU13_qk_matmul</title>
<polygon fill="none" stroke="black" points="125295.5,-1392.67 124360.5,-1392.67 124360.5,-1324.67 125295.5,-1324.67 125295.5,-1392.67"/>
<text text-anchor="middle" x="124828" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="124828" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="124828" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="124828" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L13_S1_TP5_GPU13_qkv_slice&#45;&gt;L13_S1_TP5_GPU13_qk_matmul -->
<g id="edge4054" class="edge">
<title>L13_S1_TP5_GPU13_qkv_slice&#45;&gt;L13_S1_TP5_GPU13_qk_matmul</title>
<path fill="none" stroke="black" d="M124619.25,-1428.61C124619.25,-1428.61 124619.25,-1402.8 124619.25,-1402.8"/>
<polygon fill="black" stroke="black" points="124622.75,-1402.8 124619.25,-1392.8 124615.75,-1402.8 124622.75,-1402.8"/>
</g>
<!-- L13_S1_TP5_GPU13_softmax -->
<g id="node1440" class="node">
<title>L13_S1_TP5_GPU13_softmax</title>
<polygon fill="none" stroke="black" points="124977,-1288.67 124467,-1288.67 124467,-1220.67 124977,-1220.67 124977,-1288.67"/>
<text text-anchor="middle" x="124722" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="124722" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="124722" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="124722" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L13_S1_TP5_GPU13_qk_matmul&#45;&gt;L13_S1_TP5_GPU13_softmax -->
<g id="edge4055" class="edge">
<title>L13_S1_TP5_GPU13_qk_matmul&#45;&gt;L13_S1_TP5_GPU13_softmax</title>
<path fill="none" stroke="black" d="M124722,-1324.61C124722,-1324.61 124722,-1298.8 124722,-1298.8"/>
<polygon fill="black" stroke="black" points="124725.5,-1298.8 124722,-1288.8 124718.5,-1298.8 124725.5,-1298.8"/>
</g>
<!-- L13_S1_TP5_GPU13_softmax&#45;&gt;L13_S1_TP5_GPU13_attn_v -->
<g id="edge4056" class="edge">
<title>L13_S1_TP5_GPU13_softmax&#45;&gt;L13_S1_TP5_GPU13_attn_v</title>
<path fill="none" stroke="black" d="M124722,-1220.61C124722,-1220.61 124722,-1194.8 124722,-1194.8"/>
<polygon fill="black" stroke="black" points="124725.5,-1194.8 124722,-1184.8 124718.5,-1194.8 124725.5,-1194.8"/>
</g>
<!-- L13_S1_TP5_GPU13_mha_res -->
<g id="node1442" class="node">
<title>L13_S1_TP5_GPU13_mha_res</title>
<polygon fill="none" stroke="black" points="125243.5,-948.5 124356.5,-948.5 124356.5,-880.5 125243.5,-880.5 125243.5,-948.5"/>
<text text-anchor="middle" x="124800" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="124800" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="124800" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="124800" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP5_GPU13_mha_ar&#45;&gt;L13_S1_TP5_GPU13_mha_res -->
<g id="edge4066" class="edge">
<title>L13_S1_TP5_GPU13_mha_ar&#45;&gt;L13_S1_TP5_GPU13_mha_res</title>
<path fill="none" stroke="black" d="M124533.99,-991.61C124533.99,-991.61 124533.99,-958.74 124533.99,-958.74"/>
<polygon fill="black" stroke="black" points="124537.49,-958.74 124533.99,-948.74 124530.49,-958.74 124537.49,-958.74"/>
</g>
<!-- L13_S1_TP5_GPU13_gate -->
<g id="node1443" class="node">
<title>L13_S1_TP5_GPU13_gate</title>
<polygon fill="none" stroke="black" points="125329.56,-844.5 124487.15,-844.5 124270.44,-708.5 125112.85,-708.5 125329.56,-844.5"/>
<text text-anchor="middle" x="124800" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="124800" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="124800" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="124800" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L13_S1_TP5_GPU13_mha_res&#45;&gt;L13_S1_TP5_GPU13_gate -->
<g id="edge4067" class="edge">
<title>L13_S1_TP5_GPU13_mha_res&#45;&gt;L13_S1_TP5_GPU13_gate</title>
<path fill="none" stroke="black" d="M124800,-880.39C124800,-880.39 124800,-854.73 124800,-854.73"/>
<polygon fill="black" stroke="black" points="124803.5,-854.73 124800,-844.73 124796.5,-854.73 124803.5,-854.73"/>
</g>
<!-- L13_S1_TP5_GPU13_moe_res -->
<g id="node1445" class="node">
<title>L13_S1_TP5_GPU13_moe_res</title>
<polygon fill="none" stroke="black" points="125239,-436.33 124419,-436.33 124419,-368.33 125239,-368.33 125239,-436.33"/>
<text text-anchor="middle" x="124829" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="124829" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="124829" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="124829" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP5_GPU13_mha_res&#45;&gt;L13_S1_TP5_GPU13_moe_res -->
<g id="edge4087" class="edge">
<title>L13_S1_TP5_GPU13_mha_res&#45;&gt;L13_S1_TP5_GPU13_moe_res</title>
<path fill="none" stroke="black" d="M124356.43,-914C124299.73,-914 124261,-914 124261,-914 124261,-914 124261,-673 124261,-673 124261,-673 124580.5,-673 124580.5,-673 124580.5,-673 124580.5,-570 124580.5,-570 124580.5,-570 124558.51,-570 124558.51,-570 124558.51,-570 124558.51,-446.67 124558.51,-446.67"/>
<polygon fill="black" stroke="black" points="124562.01,-446.67 124558.51,-436.67 124555.01,-446.67 124562.01,-446.67"/>
</g>
<!-- L13_S1_TP5_GPU13_gate&#45;&gt;L13_S1_TP5_GPU13_expert0 -->
<g id="edge4068" class="edge">
<title>L13_S1_TP5_GPU13_gate&#45;&gt;L13_S1_TP5_GPU13_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M124422.36,-708.31C124422.36,-708.31 124422.36,-682.71 124422.36,-682.71"/>
<polygon fill="black" stroke="black" points="124425.86,-682.71 124422.36,-672.71 124418.86,-682.71 124425.86,-682.71"/>
</g>
<!-- L13_S1_TP5_GPU13_gate&#45;&gt;L13_S1_TP5_GPU13_expert1 -->
<g id="edge4069" class="edge">
<title>L13_S1_TP5_GPU13_gate&#45;&gt;L13_S1_TP5_GPU13_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M124929.25,-708.31C124929.25,-708.31 124929.25,-682.71 124929.25,-682.71"/>
<polygon fill="black" stroke="black" points="124932.75,-682.71 124929.25,-672.71 124925.75,-682.71 124932.75,-682.71"/>
</g>
<!-- L13_S1_TP5_GPU13_moe_ar&#45;&gt;L13_S1_TP5_GPU13_moe_res -->
<g id="edge4086" class="edge">
<title>L13_S1_TP5_GPU13_moe_ar&#45;&gt;L13_S1_TP5_GPU13_moe_res</title>
<path fill="none" stroke="black" d="M124450.87,-486.58C124450.87,-486.58 124450.87,-446.59 124450.87,-446.59"/>
<polygon fill="black" stroke="black" points="124454.37,-446.59 124450.87,-436.59 124447.37,-446.59 124454.37,-446.59"/>
</g>
<!-- L13_S1_TP5_GPU13_norm -->
<g id="node1446" class="node">
<title>L13_S1_TP5_GPU13_norm</title>
<polygon fill="none" stroke="black" points="125053.5,-332.33 124604.5,-332.33 124604.5,-264.33 125053.5,-264.33 125053.5,-332.33"/>
<text text-anchor="middle" x="124829" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="124829" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="124829" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="124829" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP5_GPU13_moe_res&#45;&gt;L13_S1_TP5_GPU13_norm -->
<g id="edge4088" class="edge">
<title>L13_S1_TP5_GPU13_moe_res&#45;&gt;L13_S1_TP5_GPU13_norm</title>
<path fill="none" stroke="black" d="M124829,-368.28C124829,-368.28 124829,-342.46 124829,-342.46"/>
<polygon fill="black" stroke="black" points="124832.5,-342.46 124829,-332.46 124825.5,-342.46 124832.5,-342.46"/>
</g>
<!-- L13_S1_TP6_GPU14_qkv_linear -->
<g id="node1447" class="node">
<title>L13_S1_TP6_GPU14_qkv_linear</title>
<polygon fill="none" stroke="black" points="125929,-1614.75 125321,-1614.75 125321,-1546.75 125929,-1546.75 125929,-1614.75"/>
<text text-anchor="middle" x="125625" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="125625" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="125625" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="125625" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L13_S1_TP6_GPU14_qkv_slice -->
<g id="node1448" class="node">
<title>L13_S1_TP6_GPU14_qkv_slice</title>
<polygon fill="none" stroke="black" points="125923,-1496.67 125327,-1496.67 125327,-1428.67 125923,-1428.67 125923,-1496.67"/>
<text text-anchor="middle" x="125625" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="125625" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="125625" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="125625" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L13_S1_TP6_GPU14_qkv_linear&#45;&gt;L13_S1_TP6_GPU14_qkv_slice -->
<g id="edge4089" class="edge">
<title>L13_S1_TP6_GPU14_qkv_linear&#45;&gt;L13_S1_TP6_GPU14_qkv_slice</title>
<path fill="none" stroke="black" d="M125625,-1546.59C125625,-1546.59 125625,-1506.74 125625,-1506.74"/>
<polygon fill="black" stroke="black" points="125628.5,-1506.74 125625,-1496.74 125621.5,-1506.74 125628.5,-1506.74"/>
</g>
<!-- L13_S1_TP6_GPU14_qkv_slice&#45;&gt;L13_S1_TP6_GPU14_attn_v -->
<g id="edge4093" class="edge">
<title>L13_S1_TP6_GPU14_qkv_slice&#45;&gt;L13_S1_TP6_GPU14_attn_v</title>
<path fill="none" stroke="black" d="M125366.25,-1428.38C125366.25,-1428.38 125366.25,-1195 125366.25,-1195"/>
<polygon fill="black" stroke="black" points="125369.75,-1195 125366.25,-1185 125362.75,-1195 125369.75,-1195"/>
</g>
<!-- L13_S1_TP6_GPU14_qk_matmul -->
<g id="node1449" class="node">
<title>L13_S1_TP6_GPU14_qk_matmul</title>
<polygon fill="none" stroke="black" points="126340.5,-1392.67 125405.5,-1392.67 125405.5,-1324.67 126340.5,-1324.67 126340.5,-1392.67"/>
<text text-anchor="middle" x="125873" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="125873" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="125873" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="125873" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L13_S1_TP6_GPU14_qkv_slice&#45;&gt;L13_S1_TP6_GPU14_qk_matmul -->
<g id="edge4090" class="edge">
<title>L13_S1_TP6_GPU14_qkv_slice&#45;&gt;L13_S1_TP6_GPU14_qk_matmul</title>
<path fill="none" stroke="black" d="M125664.25,-1428.61C125664.25,-1428.61 125664.25,-1402.8 125664.25,-1402.8"/>
<polygon fill="black" stroke="black" points="125667.75,-1402.8 125664.25,-1392.8 125660.75,-1402.8 125667.75,-1402.8"/>
</g>
<!-- L13_S1_TP6_GPU14_softmax -->
<g id="node1450" class="node">
<title>L13_S1_TP6_GPU14_softmax</title>
<polygon fill="none" stroke="black" points="126021,-1288.67 125511,-1288.67 125511,-1220.67 126021,-1220.67 126021,-1288.67"/>
<text text-anchor="middle" x="125766" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="125766" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="125766" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="125766" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L13_S1_TP6_GPU14_qk_matmul&#45;&gt;L13_S1_TP6_GPU14_softmax -->
<g id="edge4091" class="edge">
<title>L13_S1_TP6_GPU14_qk_matmul&#45;&gt;L13_S1_TP6_GPU14_softmax</title>
<path fill="none" stroke="black" d="M125766,-1324.61C125766,-1324.61 125766,-1298.8 125766,-1298.8"/>
<polygon fill="black" stroke="black" points="125769.5,-1298.8 125766,-1288.8 125762.5,-1298.8 125769.5,-1298.8"/>
</g>
<!-- L13_S1_TP6_GPU14_softmax&#45;&gt;L13_S1_TP6_GPU14_attn_v -->
<g id="edge4092" class="edge">
<title>L13_S1_TP6_GPU14_softmax&#45;&gt;L13_S1_TP6_GPU14_attn_v</title>
<path fill="none" stroke="black" d="M125766,-1220.61C125766,-1220.61 125766,-1194.8 125766,-1194.8"/>
<polygon fill="black" stroke="black" points="125769.5,-1194.8 125766,-1184.8 125762.5,-1194.8 125769.5,-1194.8"/>
</g>
<!-- L13_S1_TP6_GPU14_mha_res -->
<g id="node1452" class="node">
<title>L13_S1_TP6_GPU14_mha_res</title>
<polygon fill="none" stroke="black" points="126321.5,-948.5 125434.5,-948.5 125434.5,-880.5 126321.5,-880.5 126321.5,-948.5"/>
<text text-anchor="middle" x="125878" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="125878" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="125878" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="125878" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP6_GPU14_mha_ar&#45;&gt;L13_S1_TP6_GPU14_mha_res -->
<g id="edge4102" class="edge">
<title>L13_S1_TP6_GPU14_mha_ar&#45;&gt;L13_S1_TP6_GPU14_mha_res</title>
<path fill="none" stroke="black" d="M125457.49,-1015.91C125457.49,-1015.91 125457.49,-958.58 125457.49,-958.58"/>
<polygon fill="black" stroke="black" points="125460.99,-958.58 125457.49,-948.58 125453.99,-958.58 125460.99,-958.58"/>
</g>
<!-- L13_S1_TP6_GPU14_gate -->
<g id="node1453" class="node">
<title>L13_S1_TP6_GPU14_gate</title>
<polygon fill="none" stroke="black" points="126407.56,-844.5 125565.15,-844.5 125348.44,-708.5 126190.85,-708.5 126407.56,-844.5"/>
<text text-anchor="middle" x="125878" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="125878" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="125878" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="125878" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L13_S1_TP6_GPU14_mha_res&#45;&gt;L13_S1_TP6_GPU14_gate -->
<g id="edge4103" class="edge">
<title>L13_S1_TP6_GPU14_mha_res&#45;&gt;L13_S1_TP6_GPU14_gate</title>
<path fill="none" stroke="black" d="M125878,-880.39C125878,-880.39 125878,-854.73 125878,-854.73"/>
<polygon fill="black" stroke="black" points="125881.5,-854.73 125878,-844.73 125874.5,-854.73 125881.5,-854.73"/>
</g>
<!-- L13_S1_TP6_GPU14_moe_res -->
<g id="node1455" class="node">
<title>L13_S1_TP6_GPU14_moe_res</title>
<polygon fill="none" stroke="black" points="126845,-436.33 126025,-436.33 126025,-368.33 126845,-368.33 126845,-436.33"/>
<text text-anchor="middle" x="126435" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="126435" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="126435" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="126435" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP6_GPU14_mha_res&#45;&gt;L13_S1_TP6_GPU14_moe_res -->
<g id="edge4123" class="edge">
<title>L13_S1_TP6_GPU14_mha_res&#45;&gt;L13_S1_TP6_GPU14_moe_res</title>
<path fill="none" stroke="black" d="M126321.57,-914C126378.27,-914 126417,-914 126417,-914 126417,-914 126417,-693 126417,-693 126417,-693 126451.5,-693 126451.5,-693 126451.5,-693 126451.5,-446.53 126451.5,-446.53"/>
<polygon fill="black" stroke="black" points="126455,-446.53 126451.5,-436.53 126448,-446.53 126455,-446.53"/>
</g>
<!-- L13_S1_TP6_GPU14_gate&#45;&gt;L13_S1_TP6_GPU14_expert0 -->
<g id="edge4104" class="edge">
<title>L13_S1_TP6_GPU14_gate&#45;&gt;L13_S1_TP6_GPU14_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M125428.36,-708.31C125428.36,-708.31 125428.36,-682.71 125428.36,-682.71"/>
<polygon fill="black" stroke="black" points="125431.86,-682.71 125428.36,-672.71 125424.86,-682.71 125431.86,-682.71"/>
</g>
<!-- L13_S1_TP6_GPU14_gate&#45;&gt;L13_S1_TP6_GPU14_expert1 -->
<g id="edge4105" class="edge">
<title>L13_S1_TP6_GPU14_gate&#45;&gt;L13_S1_TP6_GPU14_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M125825.83,-708.31C125825.83,-708.31 125825.83,-682.71 125825.83,-682.71"/>
<polygon fill="black" stroke="black" points="125829.33,-682.71 125825.83,-672.71 125822.33,-682.71 125829.33,-682.71"/>
</g>
<!-- L13_S1_TP6_GPU14_moe_ar&#45;&gt;L13_S1_TP6_GPU14_moe_res -->
<g id="edge4122" class="edge">
<title>L13_S1_TP6_GPU14_moe_ar&#45;&gt;L13_S1_TP6_GPU14_moe_res</title>
<path fill="none" stroke="black" d="M125233.7,-520C125242.41,-520 125247.36,-520 125247.36,-520 125247.36,-520 125247.36,-402 125247.36,-402 125247.36,-402 126014.62,-402 126014.62,-402"/>
<polygon fill="black" stroke="black" points="126014.62,-405.5 126024.62,-402 126014.62,-398.5 126014.62,-405.5"/>
</g>
<!-- L13_S1_TP6_GPU14_norm -->
<g id="node1456" class="node">
<title>L13_S1_TP6_GPU14_norm</title>
<polygon fill="none" stroke="black" points="126659.5,-332.33 126210.5,-332.33 126210.5,-264.33 126659.5,-264.33 126659.5,-332.33"/>
<text text-anchor="middle" x="126435" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="126435" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="126435" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="126435" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP6_GPU14_moe_res&#45;&gt;L13_S1_TP6_GPU14_norm -->
<g id="edge4124" class="edge">
<title>L13_S1_TP6_GPU14_moe_res&#45;&gt;L13_S1_TP6_GPU14_norm</title>
<path fill="none" stroke="black" d="M126435,-368.28C126435,-368.28 126435,-342.46 126435,-342.46"/>
<polygon fill="black" stroke="black" points="126438.5,-342.46 126435,-332.46 126431.5,-342.46 126438.5,-342.46"/>
</g>
<!-- L13_S1_TP7_GPU15_qkv_linear -->
<g id="node1457" class="node">
<title>L13_S1_TP7_GPU15_qkv_linear</title>
<polygon fill="none" stroke="black" points="127031,-1614.75 126423,-1614.75 126423,-1546.75 127031,-1546.75 127031,-1614.75"/>
<text text-anchor="middle" x="126727" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="126727" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="126727" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="126727" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L13_S1_TP7_GPU15_qkv_slice -->
<g id="node1458" class="node">
<title>L13_S1_TP7_GPU15_qkv_slice</title>
<polygon fill="none" stroke="black" points="127025,-1496.67 126429,-1496.67 126429,-1428.67 127025,-1428.67 127025,-1496.67"/>
<text text-anchor="middle" x="126727" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="126727" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="126727" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="126727" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L13_S1_TP7_GPU15_qkv_linear&#45;&gt;L13_S1_TP7_GPU15_qkv_slice -->
<g id="edge4125" class="edge">
<title>L13_S1_TP7_GPU15_qkv_linear&#45;&gt;L13_S1_TP7_GPU15_qkv_slice</title>
<path fill="none" stroke="black" d="M126727,-1546.59C126727,-1546.59 126727,-1506.74 126727,-1506.74"/>
<polygon fill="black" stroke="black" points="126730.5,-1506.74 126727,-1496.74 126723.5,-1506.74 126730.5,-1506.74"/>
</g>
<!-- L13_S1_TP7_GPU15_qkv_slice&#45;&gt;L13_S1_TP7_GPU15_attn_v -->
<g id="edge4129" class="edge">
<title>L13_S1_TP7_GPU15_qkv_slice&#45;&gt;L13_S1_TP7_GPU15_attn_v</title>
<path fill="none" stroke="black" d="M126468.25,-1428.38C126468.25,-1428.38 126468.25,-1195 126468.25,-1195"/>
<polygon fill="black" stroke="black" points="126471.75,-1195 126468.25,-1185 126464.75,-1195 126471.75,-1195"/>
</g>
<!-- L13_S1_TP7_GPU15_qk_matmul -->
<g id="node1459" class="node">
<title>L13_S1_TP7_GPU15_qk_matmul</title>
<polygon fill="none" stroke="black" points="127442.5,-1392.67 126507.5,-1392.67 126507.5,-1324.67 127442.5,-1324.67 127442.5,-1392.67"/>
<text text-anchor="middle" x="126975" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="126975" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="126975" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="126975" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L13_S1_TP7_GPU15_qkv_slice&#45;&gt;L13_S1_TP7_GPU15_qk_matmul -->
<g id="edge4126" class="edge">
<title>L13_S1_TP7_GPU15_qkv_slice&#45;&gt;L13_S1_TP7_GPU15_qk_matmul</title>
<path fill="none" stroke="black" d="M126766.25,-1428.61C126766.25,-1428.61 126766.25,-1402.8 126766.25,-1402.8"/>
<polygon fill="black" stroke="black" points="126769.75,-1402.8 126766.25,-1392.8 126762.75,-1402.8 126769.75,-1402.8"/>
</g>
<!-- L13_S1_TP7_GPU15_softmax -->
<g id="node1460" class="node">
<title>L13_S1_TP7_GPU15_softmax</title>
<polygon fill="none" stroke="black" points="127123,-1288.67 126613,-1288.67 126613,-1220.67 127123,-1220.67 127123,-1288.67"/>
<text text-anchor="middle" x="126868" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="126868" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="126868" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="126868" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L13_S1_TP7_GPU15_qk_matmul&#45;&gt;L13_S1_TP7_GPU15_softmax -->
<g id="edge4127" class="edge">
<title>L13_S1_TP7_GPU15_qk_matmul&#45;&gt;L13_S1_TP7_GPU15_softmax</title>
<path fill="none" stroke="black" d="M126868,-1324.61C126868,-1324.61 126868,-1298.8 126868,-1298.8"/>
<polygon fill="black" stroke="black" points="126871.5,-1298.8 126868,-1288.8 126864.5,-1298.8 126871.5,-1298.8"/>
</g>
<!-- L13_S1_TP7_GPU15_softmax&#45;&gt;L13_S1_TP7_GPU15_attn_v -->
<g id="edge4128" class="edge">
<title>L13_S1_TP7_GPU15_softmax&#45;&gt;L13_S1_TP7_GPU15_attn_v</title>
<path fill="none" stroke="black" d="M126805,-1220.61C126805,-1220.61 126805,-1194.8 126805,-1194.8"/>
<polygon fill="black" stroke="black" points="126808.5,-1194.8 126805,-1184.8 126801.5,-1194.8 126808.5,-1194.8"/>
</g>
<!-- L13_S1_TP7_GPU15_mha_res -->
<g id="node1462" class="node">
<title>L13_S1_TP7_GPU15_mha_res</title>
<polygon fill="none" stroke="black" points="127399.5,-948.5 126512.5,-948.5 126512.5,-880.5 127399.5,-880.5 127399.5,-948.5"/>
<text text-anchor="middle" x="126956" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="126956" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="126956" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="126956" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP7_GPU15_mha_ar&#45;&gt;L13_S1_TP7_GPU15_mha_res -->
<g id="edge4138" class="edge">
<title>L13_S1_TP7_GPU15_mha_ar&#45;&gt;L13_S1_TP7_GPU15_mha_res</title>
<path fill="none" stroke="black" d="M126226.53,-1016C126471.7,-1016 126754.75,-1016 126754.75,-1016 126754.75,-1016 126754.75,-958.58 126754.75,-958.58"/>
<polygon fill="black" stroke="black" points="126758.25,-958.58 126754.75,-948.58 126751.25,-958.58 126758.25,-958.58"/>
</g>
<!-- L13_S1_TP7_GPU15_gate -->
<g id="node1463" class="node">
<title>L13_S1_TP7_GPU15_gate</title>
<polygon fill="none" stroke="black" points="127485.56,-844.5 126643.15,-844.5 126426.44,-708.5 127268.85,-708.5 127485.56,-844.5"/>
<text text-anchor="middle" x="126956" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="126956" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="126956" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="126956" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L13_S1_TP7_GPU15_mha_res&#45;&gt;L13_S1_TP7_GPU15_gate -->
<g id="edge4139" class="edge">
<title>L13_S1_TP7_GPU15_mha_res&#45;&gt;L13_S1_TP7_GPU15_gate</title>
<path fill="none" stroke="black" d="M126956,-880.39C126956,-880.39 126956,-854.73 126956,-854.73"/>
<polygon fill="black" stroke="black" points="126959.5,-854.73 126956,-844.73 126952.5,-854.73 126959.5,-854.73"/>
</g>
<!-- L13_S1_TP7_GPU15_moe_res -->
<g id="node1465" class="node">
<title>L13_S1_TP7_GPU15_moe_res</title>
<polygon fill="none" stroke="black" points="127875,-436.33 127055,-436.33 127055,-368.33 127875,-368.33 127875,-436.33"/>
<text text-anchor="middle" x="127465" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="127465" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="127465" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="127465" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP7_GPU15_mha_res&#45;&gt;L13_S1_TP7_GPU15_moe_res -->
<g id="edge4159" class="edge">
<title>L13_S1_TP7_GPU15_mha_res&#45;&gt;L13_S1_TP7_GPU15_moe_res</title>
<path fill="none" stroke="black" d="M127399.54,-925C127549.82,-925 127680.39,-925 127680.39,-925 127680.39,-925 127680.39,-446.63 127680.39,-446.63"/>
<polygon fill="black" stroke="black" points="127683.89,-446.63 127680.39,-436.63 127676.89,-446.63 127683.89,-446.63"/>
</g>
<!-- L13_S1_TP7_GPU15_gate&#45;&gt;L13_S1_TP7_GPU15_expert0 -->
<g id="edge4140" class="edge">
<title>L13_S1_TP7_GPU15_gate&#45;&gt;L13_S1_TP7_GPU15_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M126434.36,-776.4C126434.36,-776.4 126434.36,-682.74 126434.36,-682.74"/>
<polygon fill="black" stroke="black" points="126437.86,-682.74 126434.36,-672.74 126430.86,-682.74 126437.86,-682.74"/>
</g>
<!-- L13_S1_TP7_GPU15_gate&#45;&gt;L13_S1_TP7_GPU15_expert1 -->
<g id="edge4141" class="edge">
<title>L13_S1_TP7_GPU15_gate&#45;&gt;L13_S1_TP7_GPU15_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M126685,-708.31C126685,-708.31 126685,-682.71 126685,-682.71"/>
<polygon fill="black" stroke="black" points="126688.5,-682.71 126685,-672.71 126681.5,-682.71 126688.5,-682.71"/>
</g>
<!-- L13_S1_TP7_GPU15_moe_ar&#45;&gt;L13_S1_TP7_GPU15_moe_res -->
<g id="edge4158" class="edge">
<title>L13_S1_TP7_GPU15_moe_ar&#45;&gt;L13_S1_TP7_GPU15_moe_res</title>
<path fill="none" stroke="black" d="M125917.52,-527C126408.19,-527 127270.39,-527 127270.39,-527 127270.39,-527 127270.39,-446.4 127270.39,-446.4"/>
<polygon fill="black" stroke="black" points="127273.89,-446.4 127270.39,-436.4 127266.89,-446.4 127273.89,-446.4"/>
</g>
<!-- L13_S1_TP7_GPU15_norm -->
<g id="node1466" class="node">
<title>L13_S1_TP7_GPU15_norm</title>
<polygon fill="none" stroke="black" points="127689.5,-332.33 127240.5,-332.33 127240.5,-264.33 127689.5,-264.33 127689.5,-332.33"/>
<text text-anchor="middle" x="127465" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="127465" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="127465" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="127465" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L13_S1_TP7_GPU15_moe_res&#45;&gt;L13_S1_TP7_GPU15_norm -->
<g id="edge4160" class="edge">
<title>L13_S1_TP7_GPU15_moe_res&#45;&gt;L13_S1_TP7_GPU15_norm</title>
<path fill="none" stroke="black" d="M127465,-368.28C127465,-368.28 127465,-342.46 127465,-342.46"/>
<polygon fill="black" stroke="black" points="127468.5,-342.46 127465,-332.46 127461.5,-342.46 127468.5,-342.46"/>
</g>
<!-- L14_S1_TP0_GPU8_qkv_linear -->
<g id="node1467" class="node">
<title>L14_S1_TP0_GPU8_qkv_linear</title>
<polygon fill="none" stroke="black" points="129209,-1614.75 128601,-1614.75 128601,-1546.75 129209,-1546.75 129209,-1614.75"/>
<text text-anchor="middle" x="128905" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="128905" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="128905" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="128905" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L14_S1_TP0_GPU8_qkv_slice -->
<g id="node1468" class="node">
<title>L14_S1_TP0_GPU8_qkv_slice</title>
<polygon fill="none" stroke="black" points="129203,-1496.67 128607,-1496.67 128607,-1428.67 129203,-1428.67 129203,-1496.67"/>
<text text-anchor="middle" x="128905" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="128905" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="128905" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="128905" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L14_S1_TP0_GPU8_qkv_linear&#45;&gt;L14_S1_TP0_GPU8_qkv_slice -->
<g id="edge4161" class="edge">
<title>L14_S1_TP0_GPU8_qkv_linear&#45;&gt;L14_S1_TP0_GPU8_qkv_slice</title>
<path fill="none" stroke="black" d="M128905,-1546.59C128905,-1546.59 128905,-1506.74 128905,-1506.74"/>
<polygon fill="black" stroke="black" points="128908.5,-1506.74 128905,-1496.74 128901.5,-1506.74 128908.5,-1506.74"/>
</g>
<!-- L14_S1_TP0_GPU8_qk_matmul -->
<g id="node1469" class="node">
<title>L14_S1_TP0_GPU8_qk_matmul</title>
<polygon fill="none" stroke="black" points="129677.5,-1392.67 128742.5,-1392.67 128742.5,-1324.67 129677.5,-1324.67 129677.5,-1392.67"/>
<text text-anchor="middle" x="129210" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="129210" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="129210" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="129210" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L14_S1_TP0_GPU8_qkv_slice&#45;&gt;L14_S1_TP0_GPU8_qk_matmul -->
<g id="edge4162" class="edge">
<title>L14_S1_TP0_GPU8_qkv_slice&#45;&gt;L14_S1_TP0_GPU8_qk_matmul</title>
<path fill="none" stroke="black" d="M128972.75,-1428.61C128972.75,-1428.61 128972.75,-1402.8 128972.75,-1402.8"/>
<polygon fill="black" stroke="black" points="128976.25,-1402.8 128972.75,-1392.8 128969.25,-1402.8 128976.25,-1402.8"/>
</g>
<!-- L14_S1_TP0_GPU8_attn_v -->
<g id="node1471" class="node">
<title>L14_S1_TP0_GPU8_attn_v</title>
<polygon fill="none" stroke="black" points="129678,-1184.67 128740,-1184.67 128740,-1116.67 129678,-1116.67 129678,-1184.67"/>
<text text-anchor="middle" x="129209" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="129209" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="129209" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="129209" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L14_S1_TP0_GPU8_qkv_slice&#45;&gt;L14_S1_TP0_GPU8_attn_v -->
<g id="edge4165" class="edge">
<title>L14_S1_TP0_GPU8_qkv_slice&#45;&gt;L14_S1_TP0_GPU8_attn_v</title>
<path fill="none" stroke="black" d="M128673.5,-1428.61C128673.5,-1347.57 128673.5,-1150 128673.5,-1150 128673.5,-1150 128729.97,-1150 128729.97,-1150"/>
<polygon fill="black" stroke="black" points="128729.97,-1153.5 128739.97,-1150 128729.97,-1146.5 128729.97,-1153.5"/>
</g>
<!-- L14_S1_TP0_GPU8_softmax -->
<g id="node1470" class="node">
<title>L14_S1_TP0_GPU8_softmax</title>
<polygon fill="none" stroke="black" points="129464,-1288.67 128954,-1288.67 128954,-1220.67 129464,-1220.67 129464,-1288.67"/>
<text text-anchor="middle" x="129209" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="129209" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="129209" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="129209" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L14_S1_TP0_GPU8_qk_matmul&#45;&gt;L14_S1_TP0_GPU8_softmax -->
<g id="edge4163" class="edge">
<title>L14_S1_TP0_GPU8_qk_matmul&#45;&gt;L14_S1_TP0_GPU8_softmax</title>
<path fill="none" stroke="black" d="M129209,-1324.61C129209,-1324.61 129209,-1298.8 129209,-1298.8"/>
<polygon fill="black" stroke="black" points="129212.5,-1298.8 129209,-1288.8 129205.5,-1298.8 129212.5,-1298.8"/>
</g>
<!-- L14_S1_TP0_GPU8_softmax&#45;&gt;L14_S1_TP0_GPU8_attn_v -->
<g id="edge4164" class="edge">
<title>L14_S1_TP0_GPU8_softmax&#45;&gt;L14_S1_TP0_GPU8_attn_v</title>
<path fill="none" stroke="black" d="M129209,-1220.61C129209,-1220.61 129209,-1194.8 129209,-1194.8"/>
<polygon fill="black" stroke="black" points="129212.5,-1194.8 129209,-1184.8 129205.5,-1194.8 129212.5,-1194.8"/>
</g>
<!-- L14_S1_TP0_GPU8_mha_ar -->
<g id="node1472" class="node">
<title>L14_S1_TP0_GPU8_mha_ar</title>
<ellipse fill="none" stroke="black" cx="129863" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="129863" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="129863" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="129863" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="129863" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP0_GPU8_attn_v&#45;&gt;L14_S1_TP0_GPU8_mha_ar -->
<g id="edge4166" class="edge">
<title>L14_S1_TP0_GPU8_attn_v&#45;&gt;L14_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M129514.74,-1116.51C129514.74,-1116.51 129514.74,-1060.6 129514.74,-1060.6"/>
<polygon fill="black" stroke="black" points="129518.24,-1060.6 129514.74,-1050.6 129511.24,-1060.6 129518.24,-1060.6"/>
</g>
<!-- L14_S1_TP1_GPU9_mha_ar -->
<g id="node1505" class="node">
<title>L14_S1_TP1_GPU9_mha_ar</title>
<ellipse fill="none" stroke="black" cx="130632" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="130632" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="130632" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="130632" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="130632" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP0_GPU8_attn_v&#45;&gt;L14_S1_TP1_GPU9_mha_ar -->
<g id="edge4202" class="edge">
<title>L14_S1_TP0_GPU8_attn_v&#45;&gt;L14_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M129541.95,-1116.29C129541.95,-1100.41 129541.95,-1085 129541.95,-1085 129541.95,-1085 130303.71,-1085 130303.71,-1085 130303.71,-1085 130303.71,-1066.03 130303.71,-1066.03"/>
<polygon fill="black" stroke="black" points="130307.21,-1066.03 130303.71,-1056.03 130300.21,-1066.03 130307.21,-1066.03"/>
</g>
<!-- L14_S1_TP2_GPU10_mha_ar -->
<g id="node1515" class="node">
<title>L14_S1_TP2_GPU10_mha_ar</title>
<ellipse fill="none" stroke="black" cx="131401" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="131401" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="131401" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="131401" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="131401" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP0_GPU8_attn_v&#45;&gt;L14_S1_TP2_GPU10_mha_ar -->
<g id="edge4238" class="edge">
<title>L14_S1_TP0_GPU8_attn_v&#45;&gt;L14_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M129569.16,-1116.44C129569.16,-1100.93 129569.16,-1086 129569.16,-1086 129569.16,-1086 131088.25,-1086 131088.25,-1086 131088.25,-1086 131088.25,-1069.29 131088.25,-1069.29"/>
<polygon fill="black" stroke="black" points="131091.75,-1069.29 131088.25,-1059.29 131084.75,-1069.29 131091.75,-1069.29"/>
</g>
<!-- L14_S1_TP3_GPU11_mha_ar -->
<g id="node1525" class="node">
<title>L14_S1_TP3_GPU11_mha_ar</title>
<ellipse fill="none" stroke="black" cx="132170" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="132170" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="132170" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="132170" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="132170" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP0_GPU8_attn_v&#45;&gt;L14_S1_TP3_GPU11_mha_ar -->
<g id="edge4274" class="edge">
<title>L14_S1_TP0_GPU8_attn_v&#45;&gt;L14_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M129596.37,-1116.44C129596.37,-1100.93 129596.37,-1086 129596.37,-1086 129596.37,-1086 131901.8,-1086 131901.8,-1086 131901.8,-1086 131901.8,-1076.41 131901.8,-1076.41"/>
<polygon fill="black" stroke="black" points="131905.3,-1076.41 131901.8,-1066.41 131898.3,-1076.41 131905.3,-1076.41"/>
</g>
<!-- L14_S1_TP4_GPU12_mha_ar -->
<g id="node1535" class="node">
<title>L14_S1_TP4_GPU12_mha_ar</title>
<ellipse fill="none" stroke="black" cx="132939" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="132939" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="132939" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="132939" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="132939" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP0_GPU8_attn_v&#45;&gt;L14_S1_TP4_GPU12_mha_ar -->
<g id="edge4310" class="edge">
<title>L14_S1_TP0_GPU8_attn_v&#45;&gt;L14_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M129451.51,-1116.25C129451.51,-1062.07 129451.51,-963 129451.51,-963 129451.51,-963 132620.84,-963 132620.84,-963 132620.84,-963 132620.84,-996.67 132620.84,-996.67"/>
<polygon fill="black" stroke="black" points="132617.34,-996.67 132620.84,-1006.67 132624.34,-996.67 132617.34,-996.67"/>
</g>
<!-- L14_S1_TP5_GPU13_mha_ar -->
<g id="node1545" class="node">
<title>L14_S1_TP5_GPU13_mha_ar</title>
<ellipse fill="none" stroke="black" cx="133708" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="133708" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="133708" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="133708" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="133708" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP0_GPU8_attn_v&#45;&gt;L14_S1_TP5_GPU13_mha_ar -->
<g id="edge4346" class="edge">
<title>L14_S1_TP0_GPU8_attn_v&#45;&gt;L14_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M129570.75,-1184.71C129570.75,-1198.4 129570.75,-1211 129570.75,-1211 129570.75,-1211 133514,-1211 133514,-1211 133514,-1211 133514,-1083.96 133514,-1083.96"/>
<polygon fill="black" stroke="black" points="133517.5,-1083.96 133514,-1073.96 133510.5,-1083.96 133517.5,-1083.96"/>
</g>
<!-- L14_S1_TP6_GPU14_mha_ar -->
<g id="node1555" class="node">
<title>L14_S1_TP6_GPU14_mha_ar</title>
<ellipse fill="none" stroke="black" cx="134477" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="134477" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="134477" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="134477" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="134477" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP0_GPU8_attn_v&#45;&gt;L14_S1_TP6_GPU14_mha_ar -->
<g id="edge4382" class="edge">
<title>L14_S1_TP0_GPU8_attn_v&#45;&gt;L14_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M129623.58,-1116.52C129623.58,-1113.18 129623.58,-1111 129623.58,-1111 129623.58,-1111 134152.45,-1111 134152.45,-1111 134152.45,-1111 134152.45,-1066.96 134152.45,-1066.96"/>
<polygon fill="black" stroke="black" points="134155.95,-1066.96 134152.45,-1056.96 134148.95,-1066.96 134155.95,-1066.96"/>
</g>
<!-- L14_S1_TP7_GPU15_mha_ar -->
<g id="node1565" class="node">
<title>L14_S1_TP7_GPU15_mha_ar</title>
<ellipse fill="none" stroke="black" cx="135246" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="135246" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="135246" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="135246" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="135246" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP0_GPU8_attn_v&#45;&gt;L14_S1_TP7_GPU15_mha_ar -->
<g id="edge4418" class="edge">
<title>L14_S1_TP0_GPU8_attn_v&#45;&gt;L14_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M129650.79,-1116.52C129650.79,-1113.18 129650.79,-1111 129650.79,-1111 129650.79,-1111 134938.46,-1111 134938.46,-1111 134938.46,-1111 134938.46,-1070.45 134938.46,-1070.45"/>
<polygon fill="black" stroke="black" points="134941.96,-1070.45 134938.46,-1060.45 134934.96,-1070.45 134941.96,-1070.45"/>
</g>
<!-- L14_S1_TP0_GPU8_mha_res -->
<g id="node1480" class="node">
<title>L14_S1_TP0_GPU8_mha_res</title>
<polygon fill="none" stroke="black" points="129224.5,-948.5 128337.5,-948.5 128337.5,-880.5 129224.5,-880.5 129224.5,-948.5"/>
<text text-anchor="middle" x="128781" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="128781" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="128781" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="128781" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP0_GPU8_mha_ar&#45;&gt;L14_S1_TP0_GPU8_mha_res -->
<g id="edge4174" class="edge">
<title>L14_S1_TP0_GPU8_mha_ar&#45;&gt;L14_S1_TP0_GPU8_mha_res</title>
<path fill="none" stroke="black" d="M129507.3,-1048C129262.86,-1048 128982.25,-1048 128982.25,-1048 128982.25,-1048 128982.25,-958.53 128982.25,-958.53"/>
<polygon fill="black" stroke="black" points="128985.75,-958.53 128982.25,-948.53 128978.75,-958.53 128985.75,-958.53"/>
</g>
<!-- L14_S1_TP1_GPU9_attn_v -->
<g id="node1473" class="node">
<title>L14_S1_TP1_GPU9_attn_v</title>
<polygon fill="none" stroke="black" points="130634,-1184.67 129696,-1184.67 129696,-1116.67 130634,-1116.67 130634,-1184.67"/>
<text text-anchor="middle" x="130165" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="130165" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="130165" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="130165" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L14_S1_TP1_GPU9_attn_v&#45;&gt;L14_S1_TP0_GPU8_mha_ar -->
<g id="edge4167" class="edge">
<title>L14_S1_TP1_GPU9_attn_v&#45;&gt;L14_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M129763.81,-1116.51C129763.81,-1116.51 129763.81,-1088.96 129763.81,-1088.96"/>
<polygon fill="black" stroke="black" points="129767.31,-1088.96 129763.81,-1078.96 129760.31,-1088.96 129767.31,-1088.96"/>
</g>
<!-- L14_S1_TP1_GPU9_attn_v&#45;&gt;L14_S1_TP1_GPU9_mha_ar -->
<g id="edge4203" class="edge">
<title>L14_S1_TP1_GPU9_attn_v&#45;&gt;L14_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M130350.89,-1116.51C130350.89,-1116.51 130350.89,-1074.64 130350.89,-1074.64"/>
<polygon fill="black" stroke="black" points="130354.39,-1074.64 130350.89,-1064.64 130347.39,-1074.64 130354.39,-1074.64"/>
</g>
<!-- L14_S1_TP1_GPU9_attn_v&#45;&gt;L14_S1_TP2_GPU10_mha_ar -->
<g id="edge4239" class="edge">
<title>L14_S1_TP1_GPU9_attn_v&#45;&gt;L14_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M130398.08,-1116.44C130398.08,-1100.93 130398.08,-1086 130398.08,-1086 130398.08,-1086 131150.96,-1086 131150.96,-1086 131150.96,-1086 131150.96,-1078.51 131150.96,-1078.51"/>
<polygon fill="black" stroke="black" points="131154.46,-1078.51 131150.96,-1068.51 131147.46,-1078.51 131154.46,-1078.51"/>
</g>
<!-- L14_S1_TP1_GPU9_attn_v&#45;&gt;L14_S1_TP3_GPU11_mha_ar -->
<g id="edge4275" class="edge">
<title>L14_S1_TP1_GPU9_attn_v&#45;&gt;L14_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M130445.26,-1116.44C130445.26,-1100.93 130445.26,-1086 130445.26,-1086 130445.26,-1086 132009.08,-1086 132009.08,-1086 132009.08,-1086 132009.08,-1085.02 132009.08,-1085.02"/>
<polygon fill="black" stroke="black" points="132012.58,-1086.2 132009.08,-1076.2 132005.58,-1086.2 132012.58,-1086.2"/>
</g>
<!-- L14_S1_TP1_GPU9_attn_v&#45;&gt;L14_S1_TP4_GPU12_mha_ar -->
<g id="edge4311" class="edge">
<title>L14_S1_TP1_GPU9_attn_v&#45;&gt;L14_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M130247.5,-1116.25C130247.5,-1062.07 130247.5,-963 130247.5,-963 130247.5,-963 132592.18,-963 132592.18,-963 132592.18,-963 132592.18,-1003.94 132592.18,-1003.94"/>
<polygon fill="black" stroke="black" points="132588.68,-1003.94 132592.18,-1013.94 132595.68,-1003.94 132588.68,-1003.94"/>
</g>
<!-- L14_S1_TP1_GPU9_attn_v&#45;&gt;L14_S1_TP5_GPU13_mha_ar -->
<g id="edge4347" class="edge">
<title>L14_S1_TP1_GPU9_attn_v&#45;&gt;L14_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M130492.45,-1116.52C130492.45,-1113.18 130492.45,-1111 130492.45,-1111 130492.45,-1111 133360.77,-1111 133360.77,-1111 133360.77,-1111 133360.77,-1061.17 133360.77,-1061.17"/>
<polygon fill="black" stroke="black" points="133364.27,-1061.17 133360.77,-1051.17 133357.27,-1061.17 133364.27,-1061.17"/>
</g>
<!-- L14_S1_TP1_GPU9_attn_v&#45;&gt;L14_S1_TP6_GPU14_mha_ar -->
<g id="edge4383" class="edge">
<title>L14_S1_TP1_GPU9_attn_v&#45;&gt;L14_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M130539.63,-1116.52C130539.63,-1113.18 130539.63,-1111 130539.63,-1111 130539.63,-1111 134203.38,-1111 134203.38,-1111 134203.38,-1111 134203.38,-1075.84 134203.38,-1075.84"/>
<polygon fill="black" stroke="black" points="134206.88,-1075.84 134203.38,-1065.84 134199.88,-1075.84 134206.88,-1075.84"/>
</g>
<!-- L14_S1_TP1_GPU9_attn_v&#45;&gt;L14_S1_TP7_GPU15_mha_ar -->
<g id="edge4419" class="edge">
<title>L14_S1_TP1_GPU9_attn_v&#45;&gt;L14_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M130586.82,-1116.52C130586.82,-1113.18 130586.82,-1111 130586.82,-1111 130586.82,-1111 135006.39,-1111 135006.39,-1111 135006.39,-1111 135006.39,-1079.95 135006.39,-1079.95"/>
<polygon fill="black" stroke="black" points="135009.89,-1079.95 135006.39,-1069.95 135002.89,-1079.95 135009.89,-1079.95"/>
</g>
<!-- L14_S1_TP2_GPU10_attn_v -->
<g id="node1474" class="node">
<title>L14_S1_TP2_GPU10_attn_v</title>
<polygon fill="none" stroke="black" points="131590,-1184.67 130652,-1184.67 130652,-1116.67 131590,-1116.67 131590,-1184.67"/>
<text text-anchor="middle" x="131121" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="131121" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="131121" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="131121" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L14_S1_TP2_GPU10_attn_v&#45;&gt;L14_S1_TP0_GPU8_mha_ar -->
<g id="edge4168" class="edge">
<title>L14_S1_TP2_GPU10_attn_v&#45;&gt;L14_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M130711.25,-1116.39C130711.25,-1116.14 130711.25,-1116 130711.25,-1116 130711.25,-1116 129831.62,-1116 129831.62,-1116 129831.62,-1116 129831.62,-1090.62 129831.62,-1090.62"/>
<polygon fill="black" stroke="black" points="129835.12,-1090.62 129831.62,-1080.62 129828.12,-1090.62 129835.12,-1090.62"/>
</g>
<!-- L14_S1_TP2_GPU10_attn_v&#45;&gt;L14_S1_TP1_GPU9_mha_ar -->
<g id="edge4204" class="edge">
<title>L14_S1_TP2_GPU10_attn_v&#45;&gt;L14_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M130770.49,-1116.51C130770.49,-1116.51 130770.49,-1087.65 130770.49,-1087.65"/>
<polygon fill="black" stroke="black" points="130773.99,-1087.65 130770.49,-1077.65 130766.99,-1087.65 130773.99,-1087.65"/>
</g>
<!-- L14_S1_TP2_GPU10_attn_v&#45;&gt;L14_S1_TP2_GPU10_mha_ar -->
<g id="edge4240" class="edge">
<title>L14_S1_TP2_GPU10_attn_v&#45;&gt;L14_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M131213.68,-1116.51C131213.68,-1116.51 131213.68,-1084.63 131213.68,-1084.63"/>
<polygon fill="black" stroke="black" points="131217.18,-1084.63 131213.68,-1074.63 131210.18,-1084.63 131217.18,-1084.63"/>
</g>
<!-- L14_S1_TP2_GPU10_attn_v&#45;&gt;L14_S1_TP3_GPU11_mha_ar -->
<g id="edge4276" class="edge">
<title>L14_S1_TP2_GPU10_attn_v&#45;&gt;L14_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M131276.4,-1116.44C131276.4,-1100.93 131276.4,-1086 131276.4,-1086 131276.4,-1086 132116.36,-1086 132116.36,-1086 132116.36,-1086 132116.36,-1085.43 132116.36,-1085.43"/>
<polygon fill="black" stroke="black" points="132119.86,-1090.28 132116.36,-1080.28 132112.86,-1090.28 132119.86,-1090.28"/>
</g>
<!-- L14_S1_TP2_GPU10_attn_v&#45;&gt;L14_S1_TP4_GPU12_mha_ar -->
<g id="edge4312" class="edge">
<title>L14_S1_TP2_GPU10_attn_v&#45;&gt;L14_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M131339.12,-1116.44C131339.12,-1113.72 131339.12,-1112 131339.12,-1112 131339.12,-1112 132778.42,-1112 132778.42,-1112 132778.42,-1112 132778.42,-1086.47 132778.42,-1086.47"/>
<polygon fill="black" stroke="black" points="132781.92,-1086.47 132778.42,-1076.47 132774.92,-1086.47 132781.92,-1086.47"/>
</g>
<!-- L14_S1_TP2_GPU10_attn_v&#45;&gt;L14_S1_TP5_GPU13_mha_ar -->
<g id="edge4348" class="edge">
<title>L14_S1_TP2_GPU10_attn_v&#45;&gt;L14_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M131401.84,-1116.44C131401.84,-1113.72 131401.84,-1112 131401.84,-1112 131401.84,-1112 133389.02,-1112 133389.02,-1112 133389.02,-1112 133389.02,-1068.15 133389.02,-1068.15"/>
<polygon fill="black" stroke="black" points="133392.52,-1068.15 133389.02,-1058.15 133385.52,-1068.15 133392.52,-1068.15"/>
</g>
<!-- L14_S1_TP2_GPU10_attn_v&#45;&gt;L14_S1_TP6_GPU14_mha_ar -->
<g id="edge4384" class="edge">
<title>L14_S1_TP2_GPU10_attn_v&#45;&gt;L14_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M131464.56,-1116.52C131464.56,-1113.18 131464.56,-1111 131464.56,-1111 131464.56,-1111 134254.3,-1111 134254.3,-1111 134254.3,-1111 134254.3,-1081.33 134254.3,-1081.33"/>
<polygon fill="black" stroke="black" points="134257.8,-1081.33 134254.3,-1071.33 134250.8,-1081.33 134257.8,-1081.33"/>
</g>
<!-- L14_S1_TP2_GPU10_attn_v&#45;&gt;L14_S1_TP7_GPU15_mha_ar -->
<g id="edge4420" class="edge">
<title>L14_S1_TP2_GPU10_attn_v&#45;&gt;L14_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M131527.28,-1116.52C131527.28,-1113.18 131527.28,-1111 131527.28,-1111 131527.28,-1111 135074.33,-1111 135074.33,-1111 135074.33,-1111 135074.33,-1085.46 135074.33,-1085.46"/>
<polygon fill="black" stroke="black" points="135077.83,-1085.46 135074.33,-1075.46 135070.83,-1085.46 135077.83,-1085.46"/>
</g>
<!-- L14_S1_TP3_GPU11_attn_v -->
<g id="node1475" class="node">
<title>L14_S1_TP3_GPU11_attn_v</title>
<polygon fill="none" stroke="black" points="132546,-1184.67 131608,-1184.67 131608,-1116.67 132546,-1116.67 132546,-1184.67"/>
<text text-anchor="middle" x="132077" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="132077" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="132077" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="132077" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L14_S1_TP3_GPU11_attn_v&#45;&gt;L14_S1_TP0_GPU8_mha_ar -->
<g id="edge4169" class="edge">
<title>L14_S1_TP3_GPU11_attn_v&#45;&gt;L14_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M131641.69,-1116.39C131641.69,-1116.14 131641.69,-1116 131641.69,-1116 131641.69,-1116 129899.43,-1116 129899.43,-1116 129899.43,-1116 129899.43,-1090.62 129899.43,-1090.62"/>
<polygon fill="black" stroke="black" points="129902.93,-1090.62 129899.43,-1080.62 129895.93,-1090.62 129902.93,-1090.62"/>
</g>
<!-- L14_S1_TP3_GPU11_attn_v&#45;&gt;L14_S1_TP1_GPU9_mha_ar -->
<g id="edge4205" class="edge">
<title>L14_S1_TP3_GPU11_attn_v&#45;&gt;L14_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M131675.39,-1116.39C131675.39,-1116.14 131675.39,-1116 131675.39,-1116 131675.39,-1116 130829.74,-1116 130829.74,-1116 130829.74,-1116 130829.74,-1083.8 130829.74,-1083.8"/>
<polygon fill="black" stroke="black" points="130833.24,-1083.8 130829.74,-1073.8 130826.24,-1083.8 130833.24,-1083.8"/>
</g>
<!-- L14_S1_TP3_GPU11_attn_v&#45;&gt;L14_S1_TP2_GPU10_mha_ar -->
<g id="edge4241" class="edge">
<title>L14_S1_TP3_GPU11_attn_v&#45;&gt;L14_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M131709.08,-1116.51C131709.08,-1116.51 131709.08,-1070.31 131709.08,-1070.31"/>
<polygon fill="black" stroke="black" points="131712.58,-1070.31 131709.08,-1060.31 131705.58,-1070.31 131712.58,-1070.31"/>
</g>
<!-- L14_S1_TP3_GPU11_attn_v&#45;&gt;L14_S1_TP3_GPU11_mha_ar -->
<g id="edge4277" class="edge">
<title>L14_S1_TP3_GPU11_attn_v&#45;&gt;L14_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M132223.64,-1116.51C132223.64,-1116.51 132223.64,-1090.27 132223.64,-1090.27"/>
<polygon fill="black" stroke="black" points="132227.14,-1090.27 132223.64,-1080.27 132220.14,-1090.27 132227.14,-1090.27"/>
</g>
<!-- L14_S1_TP3_GPU11_attn_v&#45;&gt;L14_S1_TP4_GPU12_mha_ar -->
<g id="edge4313" class="edge">
<title>L14_S1_TP3_GPU11_attn_v&#45;&gt;L14_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M132546.06,-1161C132548.92,-1161 132550.44,-1161 132550.44,-1161 132550.44,-1161 132550.44,-1016 132550.44,-1016 132550.44,-1016 132576.3,-1016 132576.3,-1016"/>
<polygon fill="black" stroke="black" points="132576.3,-1019.5 132586.3,-1016 132576.3,-1012.5 132576.3,-1019.5"/>
</g>
<!-- L14_S1_TP3_GPU11_attn_v&#45;&gt;L14_S1_TP5_GPU13_mha_ar -->
<g id="edge4349" class="edge">
<title>L14_S1_TP3_GPU11_attn_v&#45;&gt;L14_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M132497.33,-1184.9C132497.33,-1187.42 132497.33,-1189 132497.33,-1189 132497.33,-1189 133508,-1189 133508,-1189 133508,-1189 133508,-1083.68 133508,-1083.68"/>
<polygon fill="black" stroke="black" points="133511.5,-1083.68 133508,-1073.68 133504.5,-1083.68 133511.5,-1083.68"/>
</g>
<!-- L14_S1_TP3_GPU11_attn_v&#45;&gt;L14_S1_TP6_GPU14_mha_ar -->
<g id="edge4385" class="edge">
<title>L14_S1_TP3_GPU11_attn_v&#45;&gt;L14_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M132448.67,-1184.81C132448.67,-1192.28 132448.67,-1198 132448.67,-1198 132448.67,-1198 134467,-1198 134467,-1198 134467,-1198 134467,-1090.87 134467,-1090.87"/>
<polygon fill="black" stroke="black" points="134470.5,-1090.87 134467,-1080.87 134463.5,-1090.87 134470.5,-1090.87"/>
</g>
<!-- L14_S1_TP3_GPU11_attn_v&#45;&gt;L14_S1_TP7_GPU15_mha_ar -->
<g id="edge4421" class="edge">
<title>L14_S1_TP3_GPU11_attn_v&#45;&gt;L14_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M132330.92,-1116.52C132330.92,-1113.18 132330.92,-1111 132330.92,-1111 132330.92,-1111 135142.26,-1111 135142.26,-1111 135142.26,-1111 135142.26,-1089.1 135142.26,-1089.1"/>
<polygon fill="black" stroke="black" points="135145.76,-1089.1 135142.26,-1079.1 135138.76,-1089.1 135145.76,-1089.1"/>
</g>
<!-- L14_S1_TP4_GPU12_attn_v -->
<g id="node1476" class="node">
<title>L14_S1_TP4_GPU12_attn_v</title>
<polygon fill="none" stroke="black" points="133502,-1184.67 132564,-1184.67 132564,-1116.67 133502,-1116.67 133502,-1184.67"/>
<text text-anchor="middle" x="133033" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="133033" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="133033" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="133033" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L14_S1_TP4_GPU12_attn_v&#45;&gt;L14_S1_TP0_GPU8_mha_ar -->
<g id="edge4170" class="edge">
<title>L14_S1_TP4_GPU12_attn_v&#45;&gt;L14_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M132671.21,-1116.52C132671.21,-1113.18 132671.21,-1111 132671.21,-1111 132671.21,-1111 129967.24,-1111 129967.24,-1111 129967.24,-1111 129967.24,-1089.1 129967.24,-1089.1"/>
<polygon fill="black" stroke="black" points="129970.74,-1089.1 129967.24,-1079.1 129963.74,-1089.1 129970.74,-1089.1"/>
</g>
<!-- L14_S1_TP4_GPU12_attn_v&#45;&gt;L14_S1_TP1_GPU9_mha_ar -->
<g id="edge4206" class="edge">
<title>L14_S1_TP4_GPU12_attn_v&#45;&gt;L14_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M132642.33,-1184.91C132642.33,-1194.32 132642.33,-1202 132642.33,-1202 132642.33,-1202 130646,-1202 130646,-1202 130646,-1202 130646,-1090.68 130646,-1090.68"/>
<polygon fill="black" stroke="black" points="130649.5,-1090.68 130646,-1080.68 130642.5,-1090.68 130649.5,-1090.68"/>
</g>
<!-- L14_S1_TP4_GPU12_attn_v&#45;&gt;L14_S1_TP2_GPU10_mha_ar -->
<g id="edge4242" class="edge">
<title>L14_S1_TP4_GPU12_attn_v&#45;&gt;L14_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M132603.17,-1184.84C132603.17,-1189.65 132603.17,-1193 132603.17,-1193 132603.17,-1193 131603.5,-1193 131603.5,-1193 131603.5,-1193 131603.5,-1083.48 131603.5,-1083.48"/>
<polygon fill="black" stroke="black" points="131607,-1083.48 131603.5,-1073.48 131600,-1083.48 131607,-1083.48"/>
</g>
<!-- L14_S1_TP4_GPU12_attn_v&#45;&gt;L14_S1_TP3_GPU11_mha_ar -->
<g id="edge4278" class="edge">
<title>L14_S1_TP4_GPU12_attn_v&#45;&gt;L14_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M132563.8,-1139C132553.81,-1139 132548.22,-1139 132548.22,-1139 132548.22,-1139 132548.22,-1048 132548.22,-1048 132548.22,-1048 132535.69,-1048 132535.69,-1048"/>
<polygon fill="black" stroke="black" points="132535.69,-1044.5 132525.69,-1048 132535.69,-1051.5 132535.69,-1044.5"/>
</g>
<!-- L14_S1_TP4_GPU12_attn_v&#45;&gt;L14_S1_TP4_GPU12_mha_ar -->
<g id="edge4314" class="edge">
<title>L14_S1_TP4_GPU12_attn_v&#45;&gt;L14_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M132885.63,-1116.51C132885.63,-1116.51 132885.63,-1090.27 132885.63,-1090.27"/>
<polygon fill="black" stroke="black" points="132889.13,-1090.27 132885.63,-1080.27 132882.13,-1090.27 132889.13,-1090.27"/>
</g>
<!-- L14_S1_TP4_GPU12_attn_v&#45;&gt;L14_S1_TP5_GPU13_mha_ar -->
<g id="edge4350" class="edge">
<title>L14_S1_TP4_GPU12_attn_v&#45;&gt;L14_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M133417.26,-1116.51C133417.26,-1116.51 133417.26,-1073.04 133417.26,-1073.04"/>
<polygon fill="black" stroke="black" points="133420.76,-1073.04 133417.26,-1063.04 133413.76,-1073.04 133420.76,-1073.04"/>
</g>
<!-- L14_S1_TP4_GPU12_attn_v&#45;&gt;L14_S1_TP6_GPU14_mha_ar -->
<g id="edge4386" class="edge">
<title>L14_S1_TP4_GPU12_attn_v&#45;&gt;L14_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M133445.51,-1116.44C133445.51,-1113.72 133445.51,-1112 133445.51,-1112 133445.51,-1112 134305.23,-1112 134305.23,-1112 134305.23,-1112 134305.23,-1085.55 134305.23,-1085.55"/>
<polygon fill="black" stroke="black" points="134308.73,-1085.55 134305.23,-1075.55 134301.73,-1085.55 134308.73,-1085.55"/>
</g>
<!-- L14_S1_TP4_GPU12_attn_v&#45;&gt;L14_S1_TP7_GPU15_mha_ar -->
<g id="edge4422" class="edge">
<title>L14_S1_TP4_GPU12_attn_v&#45;&gt;L14_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M133473.75,-1116.44C133473.75,-1113.72 133473.75,-1112 133473.75,-1112 133473.75,-1112 135210.2,-1112 135210.2,-1112 135210.2,-1112 135210.2,-1090.61 135210.2,-1090.61"/>
<polygon fill="black" stroke="black" points="135213.7,-1090.61 135210.2,-1080.61 135206.7,-1090.61 135213.7,-1090.61"/>
</g>
<!-- L14_S1_TP5_GPU13_attn_v -->
<g id="node1477" class="node">
<title>L14_S1_TP5_GPU13_attn_v</title>
<polygon fill="none" stroke="black" points="134458,-1184.67 133520,-1184.67 133520,-1116.67 134458,-1116.67 134458,-1184.67"/>
<text text-anchor="middle" x="133989" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="133989" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="133989" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="133989" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L14_S1_TP5_GPU13_attn_v&#45;&gt;L14_S1_TP0_GPU8_mha_ar -->
<g id="edge4171" class="edge">
<title>L14_S1_TP5_GPU13_attn_v&#45;&gt;L14_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M133590.43,-1116.52C133590.43,-1113.18 133590.43,-1111 133590.43,-1111 133590.43,-1111 130035.05,-1111 130035.05,-1111 130035.05,-1111 130035.05,-1085.46 130035.05,-1085.46"/>
<polygon fill="black" stroke="black" points="130038.55,-1085.46 130035.05,-1075.46 130031.55,-1085.46 130038.55,-1085.46"/>
</g>
<!-- L14_S1_TP5_GPU13_attn_v&#45;&gt;L14_S1_TP1_GPU9_mha_ar -->
<g id="edge4207" class="edge">
<title>L14_S1_TP5_GPU13_attn_v&#45;&gt;L14_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M133660.87,-1116.52C133660.87,-1113.18 133660.87,-1111 133660.87,-1111 133660.87,-1111 130888.98,-1111 130888.98,-1111 130888.98,-1111 130888.98,-1077.66 130888.98,-1077.66"/>
<polygon fill="black" stroke="black" points="130892.48,-1077.66 130888.98,-1067.66 130885.48,-1077.66 130892.48,-1077.66"/>
</g>
<!-- L14_S1_TP5_GPU13_attn_v&#45;&gt;L14_S1_TP2_GPU10_mha_ar -->
<g id="edge4243" class="edge">
<title>L14_S1_TP5_GPU13_attn_v&#45;&gt;L14_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M133597.75,-1184.68C133597.75,-1197.03 133597.75,-1208 133597.75,-1208 133597.75,-1208 131599,-1208 131599,-1208 131599,-1208 131599,-1083.71 131599,-1083.71"/>
<polygon fill="black" stroke="black" points="131602.5,-1083.71 131599,-1073.71 131595.5,-1083.71 131602.5,-1083.71"/>
</g>
<!-- L14_S1_TP5_GPU13_attn_v&#45;&gt;L14_S1_TP3_GPU11_mha_ar -->
<g id="edge4279" class="edge">
<title>L14_S1_TP5_GPU13_attn_v&#45;&gt;L14_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M133731.3,-1116.52C133731.3,-1113.18 133731.3,-1111 133731.3,-1111 133731.3,-1111 132438.2,-1111 132438.2,-1111 132438.2,-1111 132438.2,-1076.29 132438.2,-1076.29"/>
<polygon fill="black" stroke="black" points="132441.7,-1076.29 132438.2,-1066.29 132434.7,-1076.29 132441.7,-1076.29"/>
</g>
<!-- L14_S1_TP5_GPU13_attn_v&#45;&gt;L14_S1_TP4_GPU12_mha_ar -->
<g id="edge4315" class="edge">
<title>L14_S1_TP5_GPU13_attn_v&#45;&gt;L14_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M133801.74,-1116.54C133801.74,-1103.63 133801.74,-1092 133801.74,-1092 133801.74,-1092 132992.84,-1092 132992.84,-1092 132992.84,-1092 132992.84,-1090.26 132992.84,-1090.26"/>
<polygon fill="black" stroke="black" points="132996.34,-1090.26 132992.84,-1080.26 132989.34,-1090.26 132996.34,-1090.26"/>
</g>
<!-- L14_S1_TP5_GPU13_attn_v&#45;&gt;L14_S1_TP5_GPU13_mha_ar -->
<g id="edge4351" class="edge">
<title>L14_S1_TP5_GPU13_attn_v&#45;&gt;L14_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M133872.17,-1116.51C133872.17,-1116.51 133872.17,-1085.92 133872.17,-1085.92"/>
<polygon fill="black" stroke="black" points="133875.67,-1085.92 133872.17,-1075.92 133868.67,-1085.92 133875.67,-1085.92"/>
</g>
<!-- L14_S1_TP5_GPU13_attn_v&#45;&gt;L14_S1_TP6_GPU14_mha_ar -->
<g id="edge4387" class="edge">
<title>L14_S1_TP5_GPU13_attn_v&#45;&gt;L14_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M134356.15,-1116.51C134356.15,-1116.51 134356.15,-1088.52 134356.15,-1088.52"/>
<polygon fill="black" stroke="black" points="134359.65,-1088.52 134356.15,-1078.52 134352.65,-1088.52 134359.65,-1088.52"/>
</g>
<!-- L14_S1_TP5_GPU13_attn_v&#45;&gt;L14_S1_TP7_GPU15_mha_ar -->
<g id="edge4423" class="edge">
<title>L14_S1_TP5_GPU13_attn_v&#45;&gt;L14_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M134407.08,-1116.44C134407.08,-1113.72 134407.08,-1112 134407.08,-1112 134407.08,-1112 135278.13,-1112 135278.13,-1112 135278.13,-1112 135278.13,-1090.61 135278.13,-1090.61"/>
<polygon fill="black" stroke="black" points="135281.63,-1090.61 135278.13,-1080.61 135274.63,-1090.61 135281.63,-1090.61"/>
</g>
<!-- L14_S1_TP6_GPU14_attn_v -->
<g id="node1478" class="node">
<title>L14_S1_TP6_GPU14_attn_v</title>
<polygon fill="none" stroke="black" points="135414,-1184.67 134476,-1184.67 134476,-1116.67 135414,-1116.67 135414,-1184.67"/>
<text text-anchor="middle" x="134945" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="134945" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="134945" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="134945" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L14_S1_TP6_GPU14_attn_v&#45;&gt;L14_S1_TP0_GPU8_mha_ar -->
<g id="edge4172" class="edge">
<title>L14_S1_TP6_GPU14_attn_v&#45;&gt;L14_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M134523.06,-1116.52C134523.06,-1113.18 134523.06,-1111 134523.06,-1111 134523.06,-1111 130102.86,-1111 130102.86,-1111 130102.86,-1111 130102.86,-1079.95 130102.86,-1079.95"/>
<polygon fill="black" stroke="black" points="130106.36,-1079.95 130102.86,-1069.95 130099.36,-1079.95 130106.36,-1079.95"/>
</g>
<!-- L14_S1_TP6_GPU14_attn_v&#45;&gt;L14_S1_TP1_GPU9_mha_ar -->
<g id="edge4208" class="edge">
<title>L14_S1_TP6_GPU14_attn_v&#45;&gt;L14_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M134570.12,-1116.52C134570.12,-1113.18 134570.12,-1111 134570.12,-1111 134570.12,-1111 130948.23,-1111 130948.23,-1111 130948.23,-1111 130948.23,-1068.69 130948.23,-1068.69"/>
<polygon fill="black" stroke="black" points="130951.73,-1068.69 130948.23,-1058.69 130944.73,-1068.69 130951.73,-1068.69"/>
</g>
<!-- L14_S1_TP6_GPU14_attn_v&#45;&gt;L14_S1_TP2_GPU10_mha_ar -->
<g id="edge4244" class="edge">
<title>L14_S1_TP6_GPU14_attn_v&#45;&gt;L14_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M134617.18,-1116.52C134617.18,-1113.18 134617.18,-1111 134617.18,-1111 134617.18,-1111 131742.78,-1111 131742.78,-1111 131742.78,-1111 131742.78,-1062.78 131742.78,-1062.78"/>
<polygon fill="black" stroke="black" points="131746.28,-1062.78 131742.78,-1052.78 131739.28,-1062.78 131746.28,-1062.78"/>
</g>
<!-- L14_S1_TP6_GPU14_attn_v&#45;&gt;L14_S1_TP3_GPU11_mha_ar -->
<g id="edge4280" class="edge">
<title>L14_S1_TP6_GPU14_attn_v&#45;&gt;L14_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M134861.5,-1116.53C134861.5,-1067.25 134861.5,-982 134861.5,-982 134861.5,-982 132516.02,-982 132516.02,-982 132516.02,-982 132516.02,-1003.75 132516.02,-1003.75"/>
<polygon fill="black" stroke="black" points="132512.52,-1003.75 132516.02,-1013.75 132519.52,-1003.75 132512.52,-1003.75"/>
</g>
<!-- L14_S1_TP6_GPU14_attn_v&#45;&gt;L14_S1_TP4_GPU12_mha_ar -->
<g id="edge4316" class="edge">
<title>L14_S1_TP6_GPU14_attn_v&#45;&gt;L14_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M134664.24,-1116.54C134664.24,-1103.63 134664.24,-1092 134664.24,-1092 134664.24,-1092 133100.05,-1092 133100.05,-1092 133100.05,-1092 133100.05,-1086.08 133100.05,-1086.08"/>
<polygon fill="black" stroke="black" points="133103.55,-1086.08 133100.05,-1076.08 133096.55,-1086.08 133103.55,-1086.08"/>
</g>
<!-- L14_S1_TP6_GPU14_attn_v&#45;&gt;L14_S1_TP5_GPU13_mha_ar -->
<g id="edge4352" class="edge">
<title>L14_S1_TP6_GPU14_attn_v&#45;&gt;L14_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M134711.3,-1116.54C134711.3,-1103.63 134711.3,-1092 134711.3,-1092 134711.3,-1092 133942.61,-1092 133942.61,-1092 133942.61,-1092 133942.61,-1080.21 133942.61,-1080.21"/>
<polygon fill="black" stroke="black" points="133946.11,-1080.21 133942.61,-1070.21 133939.11,-1080.21 133946.11,-1080.21"/>
</g>
<!-- L14_S1_TP6_GPU14_attn_v&#45;&gt;L14_S1_TP6_GPU14_mha_ar -->
<g id="edge4388" class="edge">
<title>L14_S1_TP6_GPU14_attn_v&#45;&gt;L14_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M134758.36,-1116.51C134758.36,-1116.51 134758.36,-1074.64 134758.36,-1074.64"/>
<polygon fill="black" stroke="black" points="134761.86,-1074.64 134758.36,-1064.64 134754.86,-1074.64 134761.86,-1074.64"/>
</g>
<!-- L14_S1_TP6_GPU14_attn_v&#45;&gt;L14_S1_TP7_GPU15_mha_ar -->
<g id="edge4424" class="edge">
<title>L14_S1_TP6_GPU14_attn_v&#45;&gt;L14_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M135346.07,-1116.51C135346.07,-1116.51 135346.07,-1088.96 135346.07,-1088.96"/>
<polygon fill="black" stroke="black" points="135349.57,-1088.96 135346.07,-1078.96 135342.57,-1088.96 135349.57,-1088.96"/>
</g>
<!-- L14_S1_TP7_GPU15_attn_v -->
<g id="node1479" class="node">
<title>L14_S1_TP7_GPU15_attn_v</title>
<polygon fill="none" stroke="black" points="136370,-1184.67 135432,-1184.67 135432,-1116.67 136370,-1116.67 136370,-1184.67"/>
<text text-anchor="middle" x="135901" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="135901" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="135901" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="135901" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L14_S1_TP7_GPU15_attn_v&#45;&gt;L14_S1_TP0_GPU8_mha_ar -->
<g id="edge4173" class="edge">
<title>L14_S1_TP7_GPU15_attn_v&#45;&gt;L14_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M135463.58,-1116.52C135463.58,-1113.18 135463.58,-1111 135463.58,-1111 135463.58,-1111 130170.66,-1111 130170.66,-1111 130170.66,-1111 130170.66,-1070.45 130170.66,-1070.45"/>
<polygon fill="black" stroke="black" points="130174.16,-1070.45 130170.66,-1060.45 130167.16,-1070.45 130174.16,-1070.45"/>
</g>
<!-- L14_S1_TP7_GPU15_attn_v&#45;&gt;L14_S1_TP1_GPU9_mha_ar -->
<g id="edge4209" class="edge">
<title>L14_S1_TP7_GPU15_attn_v&#45;&gt;L14_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M135442,-1184.93C135442,-1202.39 135442,-1220 135442,-1220 135442,-1220 130640,-1220 130640,-1220 130640,-1220 130640,-1090.85 130640,-1090.85"/>
<polygon fill="black" stroke="black" points="130643.5,-1090.85 130640,-1080.85 130636.5,-1090.85 130643.5,-1090.85"/>
</g>
<!-- L14_S1_TP7_GPU15_attn_v&#45;&gt;L14_S1_TP2_GPU10_mha_ar -->
<g id="edge4245" class="edge">
<title>L14_S1_TP7_GPU15_attn_v&#45;&gt;L14_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M135437,-1184.86C135437,-1200.67 135437,-1216 135437,-1216 135437,-1216 131594.5,-1216 131594.5,-1216 131594.5,-1216 131594.5,-1084.2 131594.5,-1084.2"/>
<polygon fill="black" stroke="black" points="131598,-1084.2 131594.5,-1074.2 131591,-1084.2 131598,-1084.2"/>
</g>
<!-- L14_S1_TP7_GPU15_attn_v&#45;&gt;L14_S1_TP3_GPU11_mha_ar -->
<g id="edge4281" class="edge">
<title>L14_S1_TP7_GPU15_attn_v&#45;&gt;L14_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M135656.99,-1116.53C135656.99,-1067.25 135656.99,-982 135656.99,-982 135656.99,-982 132487.26,-982 132487.26,-982 132487.26,-982 132487.26,-996.7 132487.26,-996.7"/>
<polygon fill="black" stroke="black" points="132483.76,-996.7 132487.26,-1006.7 132490.76,-996.7 132483.76,-996.7"/>
</g>
<!-- L14_S1_TP7_GPU15_attn_v&#45;&gt;L14_S1_TP4_GPU12_mha_ar -->
<g id="edge4317" class="edge">
<title>L14_S1_TP7_GPU15_attn_v&#45;&gt;L14_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M135495.16,-1116.54C135495.16,-1103.63 135495.16,-1092 135495.16,-1092 135495.16,-1092 133207.26,-1092 133207.26,-1092 133207.26,-1092 133207.26,-1076.46 133207.26,-1076.46"/>
<polygon fill="black" stroke="black" points="133210.76,-1076.46 133207.26,-1066.46 133203.76,-1076.46 133210.76,-1076.46"/>
</g>
<!-- L14_S1_TP7_GPU15_attn_v&#45;&gt;L14_S1_TP5_GPU13_mha_ar -->
<g id="edge4353" class="edge">
<title>L14_S1_TP7_GPU15_attn_v&#45;&gt;L14_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M135526.74,-1116.54C135526.74,-1103.63 135526.74,-1092 135526.74,-1092 135526.74,-1092 134013.04,-1092 134013.04,-1092 134013.04,-1092 134013.04,-1070.9 134013.04,-1070.9"/>
<polygon fill="black" stroke="black" points="134016.54,-1070.9 134013.04,-1060.9 134009.54,-1070.9 134016.54,-1070.9"/>
</g>
<!-- L14_S1_TP7_GPU15_attn_v&#45;&gt;L14_S1_TP6_GPU14_mha_ar -->
<g id="edge4389" class="edge">
<title>L14_S1_TP7_GPU15_attn_v&#45;&gt;L14_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M135558.32,-1116.65C135558.32,-1103.25 135558.32,-1091 135558.32,-1091 135558.32,-1091 134805.41,-1091 134805.41,-1091 134805.41,-1091 134805.41,-1066.01 134805.41,-1066.01"/>
<polygon fill="black" stroke="black" points="134808.91,-1066.01 134805.41,-1056.01 134801.91,-1066.01 134808.91,-1066.01"/>
</g>
<!-- L14_S1_TP7_GPU15_attn_v&#45;&gt;L14_S1_TP7_GPU15_mha_ar -->
<g id="edge4425" class="edge">
<title>L14_S1_TP7_GPU15_attn_v&#45;&gt;L14_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M135589.89,-1116.51C135589.89,-1116.51 135589.89,-1061.95 135589.89,-1061.95"/>
<polygon fill="black" stroke="black" points="135593.39,-1061.95 135589.89,-1051.95 135586.39,-1061.95 135593.39,-1061.95"/>
</g>
<!-- L14_S1_TP0_GPU8_gate -->
<g id="node1481" class="node">
<title>L14_S1_TP0_GPU8_gate</title>
<polygon fill="none" stroke="black" points="129310.56,-844.5 128468.15,-844.5 128251.44,-708.5 129093.85,-708.5 129310.56,-844.5"/>
<text text-anchor="middle" x="128781" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="128781" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="128781" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="128781" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L14_S1_TP0_GPU8_mha_res&#45;&gt;L14_S1_TP0_GPU8_gate -->
<g id="edge4175" class="edge">
<title>L14_S1_TP0_GPU8_mha_res&#45;&gt;L14_S1_TP0_GPU8_gate</title>
<path fill="none" stroke="black" d="M128781,-880.39C128781,-880.39 128781,-854.73 128781,-854.73"/>
<polygon fill="black" stroke="black" points="128784.5,-854.73 128781,-844.73 128777.5,-854.73 128784.5,-854.73"/>
</g>
<!-- L14_S1_TP0_GPU8_moe_res -->
<g id="node1499" class="node">
<title>L14_S1_TP0_GPU8_moe_res</title>
<polygon fill="none" stroke="black" points="128799,-436.33 127979,-436.33 127979,-368.33 128799,-368.33 128799,-436.33"/>
<text text-anchor="middle" x="128389" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="128389" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="128389" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="128389" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP0_GPU8_mha_res&#45;&gt;L14_S1_TP0_GPU8_moe_res -->
<g id="edge4195" class="edge">
<title>L14_S1_TP0_GPU8_mha_res&#45;&gt;L14_S1_TP0_GPU8_moe_res</title>
<path fill="none" stroke="black" d="M128337.3,-903C128214.95,-903 128115.11,-903 128115.11,-903 128115.11,-903 128115.11,-446.35 128115.11,-446.35"/>
<polygon fill="black" stroke="black" points="128118.61,-446.35 128115.11,-436.35 128111.61,-446.35 128118.61,-446.35"/>
</g>
<!-- L14_S1_TP0_GPU8_expert0 -->
<g id="node1482" class="node">
<title>L14_S1_TP0_GPU8_expert0</title>
<polygon fill="none" stroke="black" points="129275.5,-672.5 128826.5,-672.5 128826.5,-604.5 129275.5,-604.5 129275.5,-672.5"/>
<text text-anchor="middle" x="129051" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="129051" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="129051" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="129051" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L14_S1_TP0_GPU8_gate&#45;&gt;L14_S1_TP0_GPU8_expert0 -->
<g id="edge4176" class="edge">
<title>L14_S1_TP0_GPU8_gate&#45;&gt;L14_S1_TP0_GPU8_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M129051,-708.31C129051,-708.31 129051,-682.71 129051,-682.71"/>
<polygon fill="black" stroke="black" points="129054.5,-682.71 129051,-672.71 129047.5,-682.71 129054.5,-682.71"/>
</g>
<!-- L14_S1_TP0_GPU8_expert1 -->
<g id="node1483" class="node">
<title>L14_S1_TP0_GPU8_expert1</title>
<polygon fill="none" stroke="black" points="129742.5,-672.5 129293.5,-672.5 129293.5,-604.5 129742.5,-604.5 129742.5,-672.5"/>
<text text-anchor="middle" x="129518" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="129518" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="129518" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="129518" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L14_S1_TP0_GPU8_gate&#45;&gt;L14_S1_TP0_GPU8_expert1 -->
<g id="edge4177" class="edge">
<title>L14_S1_TP0_GPU8_gate&#45;&gt;L14_S1_TP0_GPU8_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M129302.14,-776.4C129302.14,-776.4 129302.14,-682.74 129302.14,-682.74"/>
<polygon fill="black" stroke="black" points="129305.64,-682.74 129302.14,-672.74 129298.64,-682.74 129305.64,-682.74"/>
</g>
<!-- L14_S1_TP0_GPU8_moe_ar -->
<g id="node1484" class="node">
<title>L14_S1_TP0_GPU8_moe_ar</title>
<ellipse fill="none" stroke="black" cx="130148" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="130148" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="130148" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="130148" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="130148" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP0_GPU8_expert0&#45;&gt;L14_S1_TP0_GPU8_moe_ar -->
<g id="edge4178" class="edge">
<title>L14_S1_TP0_GPU8_expert0&#45;&gt;L14_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M129273.57,-604.37C129273.57,-563.08 129273.57,-499 129273.57,-499 129273.57,-499 129838.29,-499 129838.29,-499"/>
<polygon fill="black" stroke="black" points="129838.29,-502.5 129848.29,-499 129838.29,-495.5 129838.29,-502.5"/>
</g>
<!-- L14_S1_TP1_GPU9_moe_ar -->
<g id="node1508" class="node">
<title>L14_S1_TP1_GPU9_moe_ar</title>
<ellipse fill="none" stroke="black" cx="130835" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="130835" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="130835" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="130835" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="130835" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP0_GPU8_expert0&#45;&gt;L14_S1_TP1_GPU9_moe_ar -->
<g id="edge4214" class="edge">
<title>L14_S1_TP0_GPU8_expert0&#45;&gt;L14_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M129271.64,-604.32C129271.64,-589.73 129271.64,-576 129271.64,-576 129271.64,-576 130516.53,-576 130516.53,-576 130516.53,-576 130516.53,-545.31 130516.53,-545.31"/>
<polygon fill="black" stroke="black" points="130520.04,-545.31 130516.53,-535.31 130513.04,-545.31 130520.04,-545.31"/>
</g>
<!-- L14_S1_TP2_GPU10_moe_ar -->
<g id="node1518" class="node">
<title>L14_S1_TP2_GPU10_moe_ar</title>
<ellipse fill="none" stroke="black" cx="131522" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="131522" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="131522" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="131522" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="131522" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP0_GPU8_expert0&#45;&gt;L14_S1_TP2_GPU10_moe_ar -->
<g id="edge4250" class="edge">
<title>L14_S1_TP0_GPU8_expert0&#45;&gt;L14_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M129269.71,-604.2C129269.71,-547.16 129269.71,-439 129269.71,-439 129269.71,-439 131225.27,-439 131225.27,-439 131225.27,-439 131225.27,-488.17 131225.27,-488.17"/>
<polygon fill="black" stroke="black" points="131221.77,-488.17 131225.27,-498.17 131228.77,-488.17 131221.77,-488.17"/>
</g>
<!-- L14_S1_TP3_GPU11_moe_ar -->
<g id="node1528" class="node">
<title>L14_S1_TP3_GPU11_moe_ar</title>
<ellipse fill="none" stroke="black" cx="132209" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="132209" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="132209" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="132209" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="132209" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP0_GPU8_expert0&#45;&gt;L14_S1_TP3_GPU11_moe_ar -->
<g id="edge4286" class="edge">
<title>L14_S1_TP0_GPU8_expert0&#45;&gt;L14_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M129267.79,-604.2C129267.79,-547.16 129267.79,-439 129267.79,-439 129267.79,-439 132007.36,-439 132007.36,-439 132007.36,-439 132007.36,-471.62 132007.36,-471.62"/>
<polygon fill="black" stroke="black" points="132003.86,-471.62 132007.36,-481.62 132010.86,-471.62 132003.86,-471.62"/>
</g>
<!-- L14_S1_TP4_GPU12_moe_ar -->
<g id="node1538" class="node">
<title>L14_S1_TP4_GPU12_moe_ar</title>
<ellipse fill="none" stroke="black" cx="132896" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="132896" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="132896" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="132896" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="132896" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP0_GPU8_expert0&#45;&gt;L14_S1_TP4_GPU12_moe_ar -->
<g id="edge4322" class="edge">
<title>L14_S1_TP0_GPU8_expert0&#45;&gt;L14_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M129265.86,-604.2C129265.86,-547.16 129265.86,-439 129265.86,-439 129265.86,-439 132899.23,-439 132899.23,-439 132899.23,-439 132899.23,-462.12 132899.23,-462.12"/>
<polygon fill="black" stroke="black" points="132895.73,-462.12 132899.23,-472.12 132902.73,-462.12 132895.73,-462.12"/>
</g>
<!-- L14_S1_TP5_GPU13_moe_ar -->
<g id="node1548" class="node">
<title>L14_S1_TP5_GPU13_moe_ar</title>
<ellipse fill="none" stroke="black" cx="133583" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="133583" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="133583" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="133583" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="133583" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP0_GPU8_expert0&#45;&gt;L14_S1_TP5_GPU13_moe_ar -->
<g id="edge4358" class="edge">
<title>L14_S1_TP0_GPU8_expert0&#45;&gt;L14_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M129263.93,-604.2C129263.93,-547.16 129263.93,-439 129263.93,-439 129263.93,-439 133360.11,-439 133360.11,-439 133360.11,-439 133360.11,-474.47 133360.11,-474.47"/>
<polygon fill="black" stroke="black" points="133356.61,-474.47 133360.11,-484.47 133363.61,-474.47 133356.61,-474.47"/>
</g>
<!-- L14_S1_TP6_GPU14_moe_ar -->
<g id="node1558" class="node">
<title>L14_S1_TP6_GPU14_moe_ar</title>
<ellipse fill="none" stroke="black" cx="134270" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="134270" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="134270" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="134270" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="134270" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP0_GPU8_expert0&#45;&gt;L14_S1_TP6_GPU14_moe_ar -->
<g id="edge4394" class="edge">
<title>L14_S1_TP0_GPU8_expert0&#45;&gt;L14_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M129116.83,-604.2C129116.83,-547.16 129116.83,-439 129116.83,-439 129116.83,-439 134114.38,-439 134114.38,-439 134114.38,-439 134114.38,-467.8 134114.38,-467.8"/>
<polygon fill="black" stroke="black" points="134110.88,-467.8 134114.38,-477.8 134117.88,-467.8 134110.88,-467.8"/>
</g>
<!-- L14_S1_TP7_GPU15_moe_ar -->
<g id="node1568" class="node">
<title>L14_S1_TP7_GPU15_moe_ar</title>
<ellipse fill="none" stroke="black" cx="134957" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="134957" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="134957" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="134957" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="134957" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP0_GPU8_expert0&#45;&gt;L14_S1_TP7_GPU15_moe_ar -->
<g id="edge4430" class="edge">
<title>L14_S1_TP0_GPU8_expert0&#45;&gt;L14_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M128971.67,-604.2C128971.67,-547.16 128971.67,-439 128971.67,-439 128971.67,-439 134901.13,-439 134901.13,-439 134901.13,-439 134901.13,-462.59 134901.13,-462.59"/>
<polygon fill="black" stroke="black" points="134897.63,-462.59 134901.13,-472.59 134904.63,-462.59 134897.63,-462.59"/>
</g>
<!-- L14_S1_TP0_GPU8_expert1&#45;&gt;L14_S1_TP0_GPU8_moe_ar -->
<g id="edge4179" class="edge">
<title>L14_S1_TP0_GPU8_expert1&#45;&gt;L14_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M129686.38,-604.21C129686.38,-567.05 129686.38,-513 129686.38,-513 129686.38,-513 129807.42,-513 129807.42,-513"/>
<polygon fill="black" stroke="black" points="129807.42,-516.5 129817.42,-513 129807.42,-509.5 129807.42,-516.5"/>
</g>
<!-- L14_S1_TP0_GPU8_expert1&#45;&gt;L14_S1_TP1_GPU9_moe_ar -->
<g id="edge4215" class="edge">
<title>L14_S1_TP0_GPU8_expert1&#45;&gt;L14_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M129630.25,-604.15C129630.25,-590.07 129630.25,-577 129630.25,-577 129630.25,-577 130532.53,-577 130532.53,-577 130532.53,-577 130532.53,-551.16 130532.53,-551.16"/>
<polygon fill="black" stroke="black" points="130536.03,-551.16 130532.53,-541.16 130529.03,-551.16 130536.03,-551.16"/>
</g>
<!-- L14_S1_TP0_GPU8_expert1&#45;&gt;L14_S1_TP2_GPU10_moe_ar -->
<g id="edge4251" class="edge">
<title>L14_S1_TP0_GPU8_expert1&#45;&gt;L14_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M129574.12,-604.2C129574.12,-547.16 129574.12,-439 129574.12,-439 129574.12,-439 131206.4,-439 131206.4,-439 131206.4,-439 131206.4,-494.33 131206.4,-494.33"/>
<polygon fill="black" stroke="black" points="131202.9,-494.33 131206.4,-504.33 131209.9,-494.33 131202.9,-494.33"/>
</g>
<!-- L14_S1_TP0_GPU8_expert1&#45;&gt;L14_S1_TP3_GPU11_moe_ar -->
<g id="edge4287" class="edge">
<title>L14_S1_TP0_GPU8_expert1&#45;&gt;L14_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M129535.86,-672.85C129535.86,-686.93 129535.86,-700 129535.86,-700 129535.86,-700 132086.5,-700 132086.5,-700 132086.5,-700 132086.5,-575.27 132086.5,-575.27"/>
<polygon fill="black" stroke="black" points="132090,-575.27 132086.5,-565.27 132083,-575.27 132090,-575.27"/>
</g>
<!-- L14_S1_TP0_GPU8_expert1&#45;&gt;L14_S1_TP4_GPU12_moe_ar -->
<g id="edge4323" class="edge">
<title>L14_S1_TP0_GPU8_expert1&#45;&gt;L14_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M129518,-604.2C129518,-547.16 129518,-439 129518,-439 129518,-439 132788.82,-439 132788.82,-439 132788.82,-439 132788.82,-464.47 132788.82,-464.47"/>
<polygon fill="black" stroke="black" points="132785.32,-464.47 132788.82,-474.47 132792.32,-464.47 132785.32,-464.47"/>
</g>
<!-- L14_S1_TP0_GPU8_expert1&#45;&gt;L14_S1_TP5_GPU13_moe_ar -->
<g id="edge4359" class="edge">
<title>L14_S1_TP0_GPU8_expert1&#45;&gt;L14_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M129461.88,-604.2C129461.88,-547.16 129461.88,-439 129461.88,-439 129461.88,-439 133332.22,-439 133332.22,-439 133332.22,-439 133332.22,-478.24 133332.22,-478.24"/>
<polygon fill="black" stroke="black" points="133328.72,-478.24 133332.22,-488.24 133335.72,-478.24 133328.72,-478.24"/>
</g>
<!-- L14_S1_TP0_GPU8_expert1&#45;&gt;L14_S1_TP6_GPU14_moe_ar -->
<g id="edge4395" class="edge">
<title>L14_S1_TP0_GPU8_expert1&#45;&gt;L14_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M129405.75,-604.2C129405.75,-547.16 129405.75,-439 129405.75,-439 129405.75,-439 134054.77,-439 134054.77,-439 134054.77,-439 134054.77,-473.52 134054.77,-473.52"/>
<polygon fill="black" stroke="black" points="134051.27,-473.52 134054.77,-483.52 134058.27,-473.52 134051.27,-473.52"/>
</g>
<!-- L14_S1_TP0_GPU8_expert1&#45;&gt;L14_S1_TP7_GPU15_moe_ar -->
<g id="edge4431" class="edge">
<title>L14_S1_TP0_GPU8_expert1&#45;&gt;L14_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M129349.62,-604.2C129349.62,-547.16 129349.62,-439 129349.62,-439 129349.62,-439 134808.27,-439 134808.27,-439 134808.27,-439 134808.27,-467.32 134808.27,-467.32"/>
<polygon fill="black" stroke="black" points="134804.77,-467.32 134808.27,-477.32 134811.77,-467.32 134804.77,-467.32"/>
</g>
<!-- L14_S1_TP0_GPU8_moe_ar&#45;&gt;L14_S1_TP0_GPU8_moe_res -->
<g id="edge4194" class="edge">
<title>L14_S1_TP0_GPU8_moe_ar&#45;&gt;L14_S1_TP0_GPU8_moe_res</title>
<path fill="none" stroke="black" d="M129914.18,-486C129464.93,-486 128525.11,-486 128525.11,-486 128525.11,-486 128525.11,-446.36 128525.11,-446.36"/>
<polygon fill="black" stroke="black" points="128528.61,-446.36 128525.11,-436.36 128521.61,-446.36 128528.61,-446.36"/>
</g>
<!-- L14_S1_TP1_GPU9_expert0 -->
<g id="node1485" class="node">
<title>L14_S1_TP1_GPU9_expert0</title>
<polygon fill="none" stroke="black" points="130209.5,-672.5 129760.5,-672.5 129760.5,-604.5 130209.5,-604.5 130209.5,-672.5"/>
<text text-anchor="middle" x="129985" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="129985" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="129985" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="129985" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L14_S1_TP1_GPU9_expert0&#45;&gt;L14_S1_TP0_GPU8_moe_ar -->
<g id="edge4180" class="edge">
<title>L14_S1_TP1_GPU9_expert0&#45;&gt;L14_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M129892.73,-604.34C129892.73,-604.34 129892.73,-561.67 129892.73,-561.67"/>
<polygon fill="black" stroke="black" points="129896.23,-561.67 129892.73,-551.67 129889.23,-561.67 129896.23,-561.67"/>
</g>
<!-- L14_S1_TP1_GPU9_expert0&#45;&gt;L14_S1_TP1_GPU9_moe_ar -->
<g id="edge4216" class="edge">
<title>L14_S1_TP1_GPU9_expert0&#45;&gt;L14_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M129971.92,-604.15C129971.92,-590.07 129971.92,-577 129971.92,-577 129971.92,-577 130548.53,-577 130548.53,-577 130548.53,-577 130548.53,-555.4 130548.53,-555.4"/>
<polygon fill="black" stroke="black" points="130552.03,-555.4 130548.53,-545.4 130545.03,-555.4 130552.03,-555.4"/>
</g>
<!-- L14_S1_TP1_GPU9_expert0&#45;&gt;L14_S1_TP2_GPU10_moe_ar -->
<g id="edge4252" class="edge">
<title>L14_S1_TP1_GPU9_expert0&#45;&gt;L14_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M130051.12,-604.15C130051.12,-590.07 130051.12,-577 130051.12,-577 130051.12,-577 131240.41,-577 131240.41,-577 131240.41,-577 131240.41,-556.39 131240.41,-556.39"/>
<polygon fill="black" stroke="black" points="131243.91,-556.39 131240.41,-546.39 131236.91,-556.39 131243.91,-556.39"/>
</g>
<!-- L14_S1_TP1_GPU9_expert0&#45;&gt;L14_S1_TP3_GPU11_moe_ar -->
<g id="edge4288" class="edge">
<title>L14_S1_TP1_GPU9_expert0&#45;&gt;L14_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M130130.31,-604.15C130130.31,-590.07 130130.31,-577 130130.31,-577 130130.31,-577 131899.91,-577 131899.91,-577 131899.91,-577 131899.91,-548.94 131899.91,-548.94"/>
<polygon fill="black" stroke="black" points="131903.41,-548.94 131899.91,-538.94 131896.41,-548.94 131903.41,-548.94"/>
</g>
<!-- L14_S1_TP1_GPU9_expert0&#45;&gt;L14_S1_TP4_GPU12_moe_ar -->
<g id="edge4324" class="edge">
<title>L14_S1_TP1_GPU9_expert0&#45;&gt;L14_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M129800.28,-604.44C129800.28,-553.66 129800.28,-464 129800.28,-464 129800.28,-464 132678.41,-464 132678.41,-464 132678.41,-464 132678.41,-473.73 132678.41,-473.73"/>
<polygon fill="black" stroke="black" points="132674.91,-473.73 132678.41,-483.73 132681.91,-473.73 132674.91,-473.73"/>
</g>
<!-- L14_S1_TP1_GPU9_expert0&#45;&gt;L14_S1_TP5_GPU13_moe_ar -->
<g id="edge4360" class="edge">
<title>L14_S1_TP1_GPU9_expert0&#45;&gt;L14_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M129787.02,-604.44C129787.02,-553.66 129787.02,-464 129787.02,-464 129787.02,-464 133304.32,-464 133304.32,-464 133304.32,-464 133304.32,-483.53 133304.32,-483.53"/>
<polygon fill="black" stroke="black" points="133300.82,-483.53 133304.32,-493.53 133307.82,-483.53 133300.82,-483.53"/>
</g>
<!-- L14_S1_TP1_GPU9_expert0&#45;&gt;L14_S1_TP6_GPU14_moe_ar -->
<g id="edge4396" class="edge">
<title>L14_S1_TP1_GPU9_expert0&#45;&gt;L14_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M129773.76,-604.44C129773.76,-553.66 129773.76,-464 129773.76,-464 129773.76,-464 133995.15,-464 133995.15,-464 133995.15,-464 133995.15,-482.87 133995.15,-482.87"/>
<polygon fill="black" stroke="black" points="133991.65,-482.87 133995.15,-492.87 133998.65,-482.87 133991.65,-482.87"/>
</g>
<!-- L14_S1_TP1_GPU9_expert0&#45;&gt;L14_S1_TP7_GPU15_moe_ar -->
<g id="edge4432" class="edge">
<title>L14_S1_TP1_GPU9_expert0&#45;&gt;L14_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M130059.83,-672.74C130059.83,-681.75 130059.83,-689 130059.83,-689 130059.83,-689 134893.9,-689 134893.9,-689 134893.9,-689 134893.9,-577.82 134893.9,-577.82"/>
<polygon fill="black" stroke="black" points="134897.4,-577.82 134893.9,-567.82 134890.4,-577.82 134897.4,-577.82"/>
</g>
<!-- L14_S1_TP1_GPU9_expert1 -->
<g id="node1486" class="node">
<title>L14_S1_TP1_GPU9_expert1</title>
<polygon fill="none" stroke="black" points="130676.5,-672.5 130227.5,-672.5 130227.5,-604.5 130676.5,-604.5 130676.5,-672.5"/>
<text text-anchor="middle" x="130452" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="130452" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="130452" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="130452" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L14_S1_TP1_GPU9_expert1&#45;&gt;L14_S1_TP0_GPU8_moe_ar -->
<g id="edge4181" class="edge">
<title>L14_S1_TP1_GPU9_expert1&#45;&gt;L14_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M130253,-604.34C130253,-604.34 130253,-576.36 130253,-576.36"/>
<polygon fill="black" stroke="black" points="130256.5,-576.36 130253,-566.36 130249.5,-576.36 130256.5,-576.36"/>
</g>
<!-- L14_S1_TP1_GPU9_expert1&#45;&gt;L14_S1_TP1_GPU9_moe_ar -->
<g id="edge4217" class="edge">
<title>L14_S1_TP1_GPU9_expert1&#45;&gt;L14_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M130564.52,-604.34C130564.52,-604.34 130564.52,-558.91 130564.52,-558.91"/>
<polygon fill="black" stroke="black" points="130568.02,-558.91 130564.52,-548.91 130561.02,-558.91 130568.02,-558.91"/>
</g>
<!-- L14_S1_TP1_GPU9_expert1&#45;&gt;L14_S1_TP2_GPU10_moe_ar -->
<g id="edge4253" class="edge">
<title>L14_S1_TP1_GPU9_expert1&#45;&gt;L14_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M130596.52,-604.15C130596.52,-590.07 130596.52,-577 130596.52,-577 130596.52,-577 131293.28,-577 131293.28,-577 131293.28,-577 131293.28,-565.61 131293.28,-565.61"/>
<polygon fill="black" stroke="black" points="131296.78,-565.61 131293.28,-555.61 131289.78,-565.61 131296.78,-565.61"/>
</g>
<!-- L14_S1_TP1_GPU9_expert1&#45;&gt;L14_S1_TP3_GPU11_moe_ar -->
<g id="edge4289" class="edge">
<title>L14_S1_TP1_GPU9_expert1&#45;&gt;L14_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M130612.51,-604.15C130612.51,-590.07 130612.51,-577 130612.51,-577 130612.51,-577 131925.28,-577 131925.28,-577 131925.28,-577 131925.28,-556.06 131925.28,-556.06"/>
<polygon fill="black" stroke="black" points="131928.78,-556.06 131925.28,-546.06 131921.78,-556.06 131928.78,-556.06"/>
</g>
<!-- L14_S1_TP1_GPU9_expert1&#45;&gt;L14_S1_TP4_GPU12_moe_ar -->
<g id="edge4325" class="edge">
<title>L14_S1_TP1_GPU9_expert1&#45;&gt;L14_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M130628.51,-604.15C130628.51,-590.07 130628.51,-577 130628.51,-577 130628.51,-577 132607.4,-577 132607.4,-577 132607.4,-577 132607.4,-554.74 132607.4,-554.74"/>
<polygon fill="black" stroke="black" points="132610.9,-554.74 132607.4,-544.74 132603.9,-554.74 132610.9,-554.74"/>
</g>
<!-- L14_S1_TP1_GPU9_expert1&#45;&gt;L14_S1_TP5_GPU13_moe_ar -->
<g id="edge4361" class="edge">
<title>L14_S1_TP1_GPU9_expert1&#45;&gt;L14_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M130491.5,-604.4C130491.5,-555.17 130491.5,-470 130491.5,-470 130491.5,-470 133276.43,-470 133276.43,-470 133276.43,-470 133276.43,-491.07 133276.43,-491.07"/>
<polygon fill="black" stroke="black" points="133272.93,-491.07 133276.43,-501.07 133279.93,-491.07 133272.93,-491.07"/>
</g>
<!-- L14_S1_TP1_GPU9_expert1&#45;&gt;L14_S1_TP6_GPU14_moe_ar -->
<g id="edge4397" class="edge">
<title>L14_S1_TP1_GPU9_expert1&#45;&gt;L14_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M130644.51,-604.15C130644.51,-590.07 130644.51,-577 130644.51,-577 130644.51,-577 134027.64,-577 134027.64,-577 134027.64,-577 134027.64,-563.66 134027.64,-563.66"/>
<polygon fill="black" stroke="black" points="134031.14,-563.66 134027.64,-553.66 134024.14,-563.66 134031.14,-563.66"/>
</g>
<!-- L14_S1_TP1_GPU9_expert1&#45;&gt;L14_S1_TP7_GPU15_moe_ar -->
<g id="edge4433" class="edge">
<title>L14_S1_TP1_GPU9_expert1&#45;&gt;L14_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M130660.5,-604.36C130660.5,-590.64 130660.5,-578 130660.5,-578 130660.5,-578 134679.64,-578 134679.64,-578 134679.64,-578 134679.64,-557.52 134679.64,-557.52"/>
<polygon fill="black" stroke="black" points="134683.14,-557.52 134679.64,-547.52 134676.14,-557.52 134683.14,-557.52"/>
</g>
<!-- L14_S1_TP2_GPU10_expert0 -->
<g id="node1487" class="node">
<title>L14_S1_TP2_GPU10_expert0</title>
<polygon fill="none" stroke="black" points="131143.5,-672.5 130694.5,-672.5 130694.5,-604.5 131143.5,-604.5 131143.5,-672.5"/>
<text text-anchor="middle" x="130919" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="130919" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="130919" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="130919" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L14_S1_TP2_GPU10_expert0&#45;&gt;L14_S1_TP0_GPU8_moe_ar -->
<g id="edge4182" class="edge">
<title>L14_S1_TP2_GPU10_expert0&#45;&gt;L14_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M130744.39,-603.88C130744.39,-603.31 130744.39,-603 130744.39,-603 130744.39,-603 130278.49,-603 130278.49,-603 130278.49,-603 130278.49,-575.09 130278.49,-575.09"/>
<polygon fill="black" stroke="black" points="130281.99,-575.09 130278.49,-565.09 130274.99,-575.09 130281.99,-575.09"/>
</g>
<!-- L14_S1_TP2_GPU10_expert0&#45;&gt;L14_S1_TP1_GPU9_moe_ar -->
<g id="edge4218" class="edge">
<title>L14_S1_TP2_GPU10_expert0&#45;&gt;L14_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M130794.28,-604.34C130794.28,-604.34 130794.28,-578.55 130794.28,-578.55"/>
<polygon fill="black" stroke="black" points="130797.78,-578.55 130794.28,-568.55 130790.78,-578.55 130797.78,-578.55"/>
</g>
<!-- L14_S1_TP2_GPU10_expert0&#45;&gt;L14_S1_TP2_GPU10_moe_ar -->
<g id="edge4254" class="edge">
<title>L14_S1_TP2_GPU10_expert0&#45;&gt;L14_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M130894.06,-604.15C130894.06,-590.07 130894.06,-577 130894.06,-577 130894.06,-577 131346.15,-577 131346.15,-577 131346.15,-577 131346.15,-571.54 131346.15,-571.54"/>
<polygon fill="black" stroke="black" points="131349.65,-571.54 131346.15,-561.54 131342.65,-571.54 131349.65,-571.54"/>
</g>
<!-- L14_S1_TP2_GPU10_expert0&#45;&gt;L14_S1_TP3_GPU11_moe_ar -->
<g id="edge4290" class="edge">
<title>L14_S1_TP2_GPU10_expert0&#45;&gt;L14_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M130943.94,-604.15C130943.94,-590.07 130943.94,-577 130943.94,-577 130943.94,-577 131950.65,-577 131950.65,-577 131950.65,-577 131950.65,-561.03 131950.65,-561.03"/>
<polygon fill="black" stroke="black" points="131954.15,-561.03 131950.65,-551.03 131947.15,-561.03 131954.15,-561.03"/>
</g>
<!-- L14_S1_TP2_GPU10_expert0&#45;&gt;L14_S1_TP4_GPU12_moe_ar -->
<g id="edge4326" class="edge">
<title>L14_S1_TP2_GPU10_expert0&#45;&gt;L14_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M130993.83,-604.15C130993.83,-590.07 130993.83,-577 130993.83,-577 130993.83,-577 132652.3,-577 132652.3,-577 132652.3,-577 132652.3,-563.66 132652.3,-563.66"/>
<polygon fill="black" stroke="black" points="132655.8,-563.66 132652.3,-553.66 132648.8,-563.66 132655.8,-563.66"/>
</g>
<!-- L14_S1_TP2_GPU10_expert0&#45;&gt;L14_S1_TP5_GPU13_moe_ar -->
<g id="edge4362" class="edge">
<title>L14_S1_TP2_GPU10_expert0&#45;&gt;L14_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M131043.72,-604.15C131043.72,-590.07 131043.72,-577 131043.72,-577 131043.72,-577 133274.09,-577 133274.09,-577 133274.09,-577 133274.09,-548.94 133274.09,-548.94"/>
<polygon fill="black" stroke="black" points="133277.59,-548.94 133274.09,-538.94 133270.59,-548.94 133277.59,-548.94"/>
</g>
<!-- L14_S1_TP2_GPU10_expert0&#45;&gt;L14_S1_TP6_GPU14_moe_ar -->
<g id="edge4398" class="edge">
<title>L14_S1_TP2_GPU10_expert0&#45;&gt;L14_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M130993.83,-672.74C130993.83,-681.75 130993.83,-689 130993.83,-689 130993.83,-689 133960.5,-689 133960.5,-689 133960.5,-689 133960.5,-548.78 133960.5,-548.78"/>
<polygon fill="black" stroke="black" points="133964,-548.78 133960.5,-538.78 133957,-548.78 133964,-548.78"/>
</g>
<!-- L14_S1_TP2_GPU10_expert0&#45;&gt;L14_S1_TP7_GPU15_moe_ar -->
<g id="edge4434" class="edge">
<title>L14_S1_TP2_GPU10_expert0&#45;&gt;L14_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M131093.61,-604.36C131093.61,-590.64 131093.61,-578 131093.61,-578 131093.61,-578 134708.19,-578 134708.19,-578 134708.19,-578 134708.19,-562.58 134708.19,-562.58"/>
<polygon fill="black" stroke="black" points="134711.69,-562.58 134708.19,-552.58 134704.69,-562.58 134711.69,-562.58"/>
</g>
<!-- L14_S1_TP2_GPU10_expert1 -->
<g id="node1488" class="node">
<title>L14_S1_TP2_GPU10_expert1</title>
<polygon fill="none" stroke="black" points="131610.5,-672.5 131161.5,-672.5 131161.5,-604.5 131610.5,-604.5 131610.5,-672.5"/>
<text text-anchor="middle" x="131386" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="131386" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="131386" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="131386" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L14_S1_TP2_GPU10_expert1&#45;&gt;L14_S1_TP0_GPU8_moe_ar -->
<g id="edge4183" class="edge">
<title>L14_S1_TP2_GPU10_expert1&#45;&gt;L14_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M131175.49,-604.36C131175.49,-590.64 131175.49,-578 131175.49,-578 131175.49,-578 130303.99,-578 130303.99,-578 130303.99,-578 130303.99,-573.17 130303.99,-573.17"/>
<polygon fill="black" stroke="black" points="130307.49,-573.17 130303.99,-563.17 130300.49,-573.17 130307.49,-573.17"/>
</g>
<!-- L14_S1_TP2_GPU10_expert1&#45;&gt;L14_S1_TP1_GPU9_moe_ar -->
<g id="edge4219" class="edge">
<title>L14_S1_TP2_GPU10_expert1&#45;&gt;L14_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M131165.48,-604.34C131165.48,-604.34 131165.48,-538.15 131165.48,-538.15"/>
<polygon fill="black" stroke="black" points="131168.98,-538.15 131165.48,-528.15 131161.98,-538.15 131168.98,-538.15"/>
</g>
<!-- L14_S1_TP2_GPU10_expert1&#45;&gt;L14_S1_TP2_GPU10_moe_ar -->
<g id="edge4255" class="edge">
<title>L14_S1_TP2_GPU10_expert1&#45;&gt;L14_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M131399.02,-604.34C131399.02,-604.34 131399.02,-575.49 131399.02,-575.49"/>
<polygon fill="black" stroke="black" points="131402.52,-575.49 131399.02,-565.49 131395.52,-575.49 131402.52,-575.49"/>
</g>
<!-- L14_S1_TP2_GPU10_expert1&#45;&gt;L14_S1_TP3_GPU11_moe_ar -->
<g id="edge4291" class="edge">
<title>L14_S1_TP2_GPU10_expert1&#45;&gt;L14_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M131451.89,-604.15C131451.89,-590.07 131451.89,-577 131451.89,-577 131451.89,-577 131976.02,-577 131976.02,-577 131976.02,-577 131976.02,-564.96 131976.02,-564.96"/>
<polygon fill="black" stroke="black" points="131979.52,-564.96 131976.02,-554.96 131972.52,-564.96 131979.52,-564.96"/>
</g>
<!-- L14_S1_TP2_GPU10_expert1&#45;&gt;L14_S1_TP4_GPU12_moe_ar -->
<g id="edge4327" class="edge">
<title>L14_S1_TP2_GPU10_expert1&#45;&gt;L14_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M131504.76,-604.15C131504.76,-590.07 131504.76,-577 131504.76,-577 131504.76,-577 132697.2,-577 132697.2,-577 132697.2,-577 132697.2,-569.1 132697.2,-569.1"/>
<polygon fill="black" stroke="black" points="132700.7,-569.1 132697.2,-559.1 132693.7,-569.1 132700.7,-569.1"/>
</g>
<!-- L14_S1_TP2_GPU10_expert1&#45;&gt;L14_S1_TP5_GPU13_moe_ar -->
<g id="edge4363" class="edge">
<title>L14_S1_TP2_GPU10_expert1&#45;&gt;L14_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M131557.63,-604.15C131557.63,-590.07 131557.63,-577 131557.63,-577 131557.63,-577 133299.64,-577 133299.64,-577 133299.64,-577 133299.64,-556.06 133299.64,-556.06"/>
<polygon fill="black" stroke="black" points="133303.14,-556.06 133299.64,-546.06 133296.14,-556.06 133303.14,-556.06"/>
</g>
<!-- L14_S1_TP2_GPU10_expert1&#45;&gt;L14_S1_TP6_GPU14_moe_ar -->
<g id="edge4399" class="edge">
<title>L14_S1_TP2_GPU10_expert1&#45;&gt;L14_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M131568.74,-672.54C131568.74,-674.68 131568.74,-676 131568.74,-676 131568.74,-676 133957.5,-676 133957.5,-676 133957.5,-676 133957.5,-547.66 133957.5,-547.66"/>
<polygon fill="black" stroke="black" points="133961,-547.66 133957.5,-537.66 133954,-547.66 133961,-547.66"/>
</g>
<!-- L14_S1_TP2_GPU10_expert1&#45;&gt;L14_S1_TP7_GPU15_moe_ar -->
<g id="edge4435" class="edge">
<title>L14_S1_TP2_GPU10_expert1&#45;&gt;L14_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M131526.98,-672.74C131526.98,-681.75 131526.98,-689 131526.98,-689 131526.98,-689 134890.3,-689 134890.3,-689 134890.3,-689 134890.3,-577.82 134890.3,-577.82"/>
<polygon fill="black" stroke="black" points="134893.8,-577.82 134890.3,-567.82 134886.8,-577.82 134893.8,-577.82"/>
</g>
<!-- L14_S1_TP3_GPU11_expert0 -->
<g id="node1489" class="node">
<title>L14_S1_TP3_GPU11_expert0</title>
<polygon fill="none" stroke="black" points="132077.5,-672.5 131628.5,-672.5 131628.5,-604.5 132077.5,-604.5 132077.5,-672.5"/>
<text text-anchor="middle" x="131853" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="131853" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="131853" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="131853" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L14_S1_TP3_GPU11_expert0&#45;&gt;L14_S1_TP0_GPU8_moe_ar -->
<g id="edge4184" class="edge">
<title>L14_S1_TP3_GPU11_expert0&#45;&gt;L14_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M131657,-604.36C131657,-590.64 131657,-578 131657,-578 131657,-578 130329.48,-578 130329.48,-578 130329.48,-578 130329.48,-571.03 130329.48,-571.03"/>
<polygon fill="black" stroke="black" points="130332.98,-571.03 130329.48,-561.03 130325.98,-571.03 130332.98,-571.03"/>
</g>
<!-- L14_S1_TP3_GPU11_expert0&#45;&gt;L14_S1_TP1_GPU9_moe_ar -->
<g id="edge4220" class="edge">
<title>L14_S1_TP3_GPU11_expert0&#45;&gt;L14_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M131685.49,-604.15C131685.49,-590.07 131685.49,-577 131685.49,-577 131685.49,-577 131157,-577 131157,-577 131157,-577 131157,-543.54 131157,-543.54"/>
<polygon fill="black" stroke="black" points="131160.5,-543.54 131157,-533.54 131153.5,-543.54 131160.5,-543.54"/>
</g>
<!-- L14_S1_TP3_GPU11_expert0&#45;&gt;L14_S1_TP2_GPU10_moe_ar -->
<g id="edge4256" class="edge">
<title>L14_S1_TP3_GPU11_expert0&#45;&gt;L14_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M131713.99,-604.34C131713.99,-604.34 131713.99,-569.91 131713.99,-569.91"/>
<polygon fill="black" stroke="black" points="131717.49,-569.91 131713.99,-559.91 131710.49,-569.91 131717.49,-569.91"/>
</g>
<!-- L14_S1_TP3_GPU11_expert0&#45;&gt;L14_S1_TP3_GPU11_moe_ar -->
<g id="edge4292" class="edge">
<title>L14_S1_TP3_GPU11_expert0&#45;&gt;L14_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M132001.39,-604.34C132001.39,-604.34 132001.39,-568.22 132001.39,-568.22"/>
<polygon fill="black" stroke="black" points="132004.89,-568.22 132001.39,-558.22 131997.89,-568.22 132004.89,-568.22"/>
</g>
<!-- L14_S1_TP3_GPU11_expert0&#45;&gt;L14_S1_TP4_GPU12_moe_ar -->
<g id="edge4328" class="edge">
<title>L14_S1_TP3_GPU11_expert0&#45;&gt;L14_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M132026.76,-604.15C132026.76,-590.07 132026.76,-577 132026.76,-577 132026.76,-577 132787,-577 132787,-577 132787,-577 132787,-575.91 132787,-575.91"/>
<polygon fill="black" stroke="black" points="132790.5,-576.09 132787,-566.09 132783.5,-576.09 132790.5,-576.09"/>
</g>
<!-- L14_S1_TP3_GPU11_expert0&#45;&gt;L14_S1_TP5_GPU13_moe_ar -->
<g id="edge4364" class="edge">
<title>L14_S1_TP3_GPU11_expert0&#45;&gt;L14_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M132052.13,-604.15C132052.13,-590.07 132052.13,-577 132052.13,-577 132052.13,-577 133325.19,-577 133325.19,-577 133325.19,-577 133325.19,-561.36 133325.19,-561.36"/>
<polygon fill="black" stroke="black" points="133328.69,-561.36 133325.19,-551.36 133321.69,-561.36 133328.69,-561.36"/>
</g>
<!-- L14_S1_TP3_GPU11_expert0&#45;&gt;L14_S1_TP6_GPU14_moe_ar -->
<g id="edge4400" class="edge">
<title>L14_S1_TP3_GPU11_expert0&#45;&gt;L14_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M131927.83,-672.54C131927.83,-674.68 131927.83,-676 131927.83,-676 131927.83,-676 133954.5,-676 133954.5,-676 133954.5,-676 133954.5,-546.48 133954.5,-546.48"/>
<polygon fill="black" stroke="black" points="133958,-546.48 133954.5,-536.48 133951,-546.48 133958,-546.48"/>
</g>
<!-- L14_S1_TP3_GPU11_expert0&#45;&gt;L14_S1_TP7_GPU15_moe_ar -->
<g id="edge4436" class="edge">
<title>L14_S1_TP3_GPU11_expert0&#45;&gt;L14_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M131865.5,-604.41C131865.5,-551.35 131865.5,-455 131865.5,-455 131865.5,-455 134715.4,-455 134715.4,-455 134715.4,-455 134715.4,-476.94 134715.4,-476.94"/>
<polygon fill="black" stroke="black" points="134711.9,-476.94 134715.4,-486.94 134718.9,-476.94 134711.9,-476.94"/>
</g>
<!-- L14_S1_TP3_GPU11_expert1 -->
<g id="node1490" class="node">
<title>L14_S1_TP3_GPU11_expert1</title>
<polygon fill="none" stroke="black" points="132544.5,-672.5 132095.5,-672.5 132095.5,-604.5 132544.5,-604.5 132544.5,-672.5"/>
<text text-anchor="middle" x="132320" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="132320" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="132320" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="132320" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L14_S1_TP3_GPU11_expert1&#45;&gt;L14_S1_TP0_GPU8_moe_ar -->
<g id="edge4185" class="edge">
<title>L14_S1_TP3_GPU11_expert1&#45;&gt;L14_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M132145.27,-604.36C132145.27,-590.64 132145.27,-578 132145.27,-578 132145.27,-578 130354.98,-578 130354.98,-578 130354.98,-578 130354.98,-568.5 130354.98,-568.5"/>
<polygon fill="black" stroke="black" points="130358.48,-568.5 130354.98,-558.5 130351.48,-568.5 130358.48,-568.5"/>
</g>
<!-- L14_S1_TP3_GPU11_expert1&#45;&gt;L14_S1_TP1_GPU9_moe_ar -->
<g id="edge4221" class="edge">
<title>L14_S1_TP3_GPU11_expert1&#45;&gt;L14_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M132195.05,-604.15C132195.05,-590.07 132195.05,-577 132195.05,-577 132195.05,-577 131159.25,-577 131159.25,-577 131159.25,-577 131159.25,-542.42 131159.25,-542.42"/>
<polygon fill="black" stroke="black" points="131162.75,-542.42 131159.25,-532.42 131155.75,-542.42 131162.75,-542.42"/>
</g>
<!-- L14_S1_TP3_GPU11_expert1&#45;&gt;L14_S1_TP2_GPU10_moe_ar -->
<g id="edge4257" class="edge">
<title>L14_S1_TP3_GPU11_expert1&#45;&gt;L14_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M132244.82,-604.15C132244.82,-590.07 132244.82,-577 132244.82,-577 132244.82,-577 131742.48,-577 131742.48,-577 131742.48,-577 131742.48,-566.89 131742.48,-566.89"/>
<polygon fill="black" stroke="black" points="131745.98,-566.89 131742.48,-556.89 131738.98,-566.89 131745.98,-566.89"/>
</g>
<!-- L14_S1_TP3_GPU11_expert1&#45;&gt;L14_S1_TP3_GPU11_moe_ar -->
<g id="edge4293" class="edge">
<title>L14_S1_TP3_GPU11_expert1&#45;&gt;L14_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M132294.59,-604.34C132294.59,-604.34 132294.59,-577.23 132294.59,-577.23"/>
<polygon fill="black" stroke="black" points="132298.09,-577.23 132294.59,-567.23 132291.09,-577.23 132298.09,-577.23"/>
</g>
<!-- L14_S1_TP3_GPU11_expert1&#45;&gt;L14_S1_TP4_GPU12_moe_ar -->
<g id="edge4329" class="edge">
<title>L14_S1_TP3_GPU11_expert1&#45;&gt;L14_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M132544.79,-627C132551.21,-627 132554.88,-627 132554.88,-627 132554.88,-627 132554.88,-504 132554.88,-504 132554.88,-504 132571.36,-504 132571.36,-504"/>
<polygon fill="black" stroke="black" points="132571.36,-507.5 132581.36,-504 132571.36,-500.5 132571.36,-507.5"/>
</g>
<!-- L14_S1_TP3_GPU11_expert1&#45;&gt;L14_S1_TP5_GPU13_moe_ar -->
<g id="edge4365" class="edge">
<title>L14_S1_TP3_GPU11_expert1&#45;&gt;L14_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M132344.37,-604.15C132344.37,-590.07 132344.37,-577 132344.37,-577 132344.37,-577 133350.74,-577 133350.74,-577 133350.74,-577 133350.74,-565.29 133350.74,-565.29"/>
<polygon fill="black" stroke="black" points="133354.24,-565.29 133350.74,-555.29 133347.24,-565.29 133354.24,-565.29"/>
</g>
<!-- L14_S1_TP3_GPU11_expert1&#45;&gt;L14_S1_TP6_GPU14_moe_ar -->
<g id="edge4401" class="edge">
<title>L14_S1_TP3_GPU11_expert1&#45;&gt;L14_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M132432.25,-672.54C132432.25,-674.68 132432.25,-676 132432.25,-676 132432.25,-676 133951.5,-676 133951.5,-676 133951.5,-676 133951.5,-545.33 133951.5,-545.33"/>
<polygon fill="black" stroke="black" points="133955,-545.33 133951.5,-535.33 133948,-545.33 133955,-545.33"/>
</g>
<!-- L14_S1_TP3_GPU11_expert1&#45;&gt;L14_S1_TP7_GPU15_moe_ar -->
<g id="edge4437" class="edge">
<title>L14_S1_TP3_GPU11_expert1&#45;&gt;L14_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M132320,-672.61C132320,-681.18 132320,-688 132320,-688 132320,-688 134886.7,-688 134886.7,-688 134886.7,-688 134886.7,-577.54 134886.7,-577.54"/>
<polygon fill="black" stroke="black" points="134890.2,-577.54 134886.7,-567.54 134883.2,-577.54 134890.2,-577.54"/>
</g>
<!-- L14_S1_TP4_GPU12_expert0 -->
<g id="node1491" class="node">
<title>L14_S1_TP4_GPU12_expert0</title>
<polygon fill="none" stroke="black" points="133011.5,-672.5 132562.5,-672.5 132562.5,-604.5 133011.5,-604.5 133011.5,-672.5"/>
<text text-anchor="middle" x="132787" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="132787" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="132787" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="132787" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L14_S1_TP4_GPU12_expert0&#45;&gt;L14_S1_TP0_GPU8_moe_ar -->
<g id="edge4186" class="edge">
<title>L14_S1_TP4_GPU12_expert0&#45;&gt;L14_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M132787.36,-672.74C132787.36,-681.75 132787.36,-689 132787.36,-689 132787.36,-689 130223,-689 130223,-689 130223,-689 130223,-577.38 130223,-577.38"/>
<polygon fill="black" stroke="black" points="130226.5,-577.38 130223,-567.38 130219.5,-577.38 130226.5,-577.38"/>
</g>
<!-- L14_S1_TP4_GPU12_expert0&#45;&gt;L14_S1_TP1_GPU9_moe_ar -->
<g id="edge4222" class="edge">
<title>L14_S1_TP4_GPU12_expert0&#45;&gt;L14_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M132675.29,-672.61C132675.29,-674.11 132675.29,-675 132675.29,-675 132675.29,-675 131152.5,-675 131152.5,-675 131152.5,-675 131152.5,-545.8 131152.5,-545.8"/>
<polygon fill="black" stroke="black" points="131156,-545.8 131152.5,-535.8 131149,-545.8 131156,-545.8"/>
</g>
<!-- L14_S1_TP4_GPU12_expert0&#45;&gt;L14_S1_TP2_GPU10_moe_ar -->
<g id="edge4258" class="edge">
<title>L14_S1_TP4_GPU12_expert0&#45;&gt;L14_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M132742.1,-604.15C132742.1,-590.07 132742.1,-577 132742.1,-577 132742.1,-577 131770.98,-577 131770.98,-577 131770.98,-577 131770.98,-562.68 131770.98,-562.68"/>
<polygon fill="black" stroke="black" points="131774.48,-562.68 131770.98,-552.68 131767.48,-562.68 131774.48,-562.68"/>
</g>
<!-- L14_S1_TP4_GPU12_expert0&#45;&gt;L14_S1_TP3_GPU11_moe_ar -->
<g id="edge4294" class="edge">
<title>L14_S1_TP4_GPU12_expert0&#45;&gt;L14_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M132562.43,-649C132556.21,-649 132552.66,-649 132552.66,-649 132552.66,-649 132552.66,-536 132552.66,-536 132552.66,-536 132535.69,-536 132535.69,-536"/>
<polygon fill="black" stroke="black" points="132535.69,-532.5 132525.69,-536 132535.69,-539.5 132535.69,-532.5"/>
</g>
<!-- L14_S1_TP4_GPU12_expert0&#45;&gt;L14_S1_TP4_GPU12_moe_ar -->
<g id="edge4330" class="edge">
<title>L14_S1_TP4_GPU12_expert0&#45;&gt;L14_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M132831.9,-604.34C132831.9,-604.34 132831.9,-577.67 132831.9,-577.67"/>
<polygon fill="black" stroke="black" points="132835.4,-577.67 132831.9,-567.67 132828.4,-577.67 132835.4,-577.67"/>
</g>
<!-- L14_S1_TP4_GPU12_expert0&#45;&gt;L14_S1_TP5_GPU13_moe_ar -->
<g id="edge4366" class="edge">
<title>L14_S1_TP4_GPU12_expert0&#45;&gt;L14_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M132876.8,-604.46C132876.8,-602.32 132876.8,-601 132876.8,-601 132876.8,-601 133376.29,-601 133376.29,-601 133376.29,-601 133376.29,-568.35 133376.29,-568.35"/>
<polygon fill="black" stroke="black" points="133379.79,-568.35 133376.29,-558.35 133372.79,-568.35 133379.79,-568.35"/>
</g>
<!-- L14_S1_TP4_GPU12_expert0&#45;&gt;L14_S1_TP6_GPU14_moe_ar -->
<g id="edge4402" class="edge">
<title>L14_S1_TP4_GPU12_expert0&#45;&gt;L14_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M132921.7,-604.46C132921.7,-602.32 132921.7,-601 132921.7,-601 132921.7,-601 133948.5,-601 133948.5,-601 133948.5,-601 133948.5,-543.72 133948.5,-543.72"/>
<polygon fill="black" stroke="black" points="133952,-543.72 133948.5,-533.72 133945,-543.72 133952,-543.72"/>
</g>
<!-- L14_S1_TP4_GPU12_expert0&#45;&gt;L14_S1_TP7_GPU15_moe_ar -->
<g id="edge4438" class="edge">
<title>L14_S1_TP4_GPU12_expert0&#45;&gt;L14_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M132966.6,-604.46C132966.6,-602.32 132966.6,-601 132966.6,-601 132966.6,-601 134736.74,-601 134736.74,-601 134736.74,-601 134736.74,-566.94 134736.74,-566.94"/>
<polygon fill="black" stroke="black" points="134740.24,-566.94 134736.74,-556.94 134733.24,-566.94 134740.24,-566.94"/>
</g>
<!-- L14_S1_TP4_GPU12_expert1 -->
<g id="node1492" class="node">
<title>L14_S1_TP4_GPU12_expert1</title>
<polygon fill="none" stroke="black" points="133478.5,-672.5 133029.5,-672.5 133029.5,-604.5 133478.5,-604.5 133478.5,-672.5"/>
<text text-anchor="middle" x="133254" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="133254" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="133254" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="133254" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L14_S1_TP4_GPU12_expert1&#45;&gt;L14_S1_TP0_GPU8_moe_ar -->
<g id="edge4187" class="edge">
<title>L14_S1_TP4_GPU12_expert1&#45;&gt;L14_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M133239.5,-604.4C133239.5,-555.17 133239.5,-470 133239.5,-470 133239.5,-470 130462.73,-470 130462.73,-470 130462.73,-470 130462.73,-493.91 130462.73,-493.91"/>
<polygon fill="black" stroke="black" points="130459.23,-493.91 130462.73,-503.91 130466.23,-493.91 130459.23,-493.91"/>
</g>
<!-- L14_S1_TP4_GPU12_expert1&#45;&gt;L14_S1_TP1_GPU9_moe_ar -->
<g id="edge4223" class="edge">
<title>L14_S1_TP4_GPU12_expert1&#45;&gt;L14_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M133179.17,-672.61C133179.17,-674.11 133179.17,-675 133179.17,-675 133179.17,-675 131150.25,-675 131150.25,-675 131150.25,-675 131150.25,-546.67 131150.25,-546.67"/>
<polygon fill="black" stroke="black" points="131153.75,-546.67 131150.25,-536.67 131146.75,-546.67 131153.75,-546.67"/>
</g>
<!-- L14_S1_TP4_GPU12_expert1&#45;&gt;L14_S1_TP2_GPU10_moe_ar -->
<g id="edge4259" class="edge">
<title>L14_S1_TP4_GPU12_expert1&#45;&gt;L14_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M133054.62,-604.15C133054.62,-590.07 133054.62,-577 133054.62,-577 133054.62,-577 131799.47,-577 131799.47,-577 131799.47,-577 131799.47,-557.38 131799.47,-557.38"/>
<polygon fill="black" stroke="black" points="131802.97,-557.38 131799.47,-547.38 131795.97,-557.38 131802.97,-557.38"/>
</g>
<!-- L14_S1_TP4_GPU12_expert1&#45;&gt;L14_S1_TP3_GPU11_moe_ar -->
<g id="edge4295" class="edge">
<title>L14_S1_TP4_GPU12_expert1&#45;&gt;L14_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M133079.74,-604.15C133079.74,-590.07 133079.74,-577 133079.74,-577 133079.74,-577 132394.14,-577 132394.14,-577 132394.14,-577 132394.14,-570.63 132394.14,-570.63"/>
<polygon fill="black" stroke="black" points="132397.64,-570.63 132394.14,-560.63 132390.64,-570.63 132397.64,-570.63"/>
</g>
<!-- L14_S1_TP4_GPU12_expert1&#45;&gt;L14_S1_TP4_GPU12_moe_ar -->
<g id="edge4331" class="edge">
<title>L14_S1_TP4_GPU12_expert1&#45;&gt;L14_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M133104.86,-604.34C133104.86,-604.34 133104.86,-568.22 133104.86,-568.22"/>
<polygon fill="black" stroke="black" points="133108.36,-568.22 133104.86,-558.22 133101.36,-568.22 133108.36,-568.22"/>
</g>
<!-- L14_S1_TP4_GPU12_expert1&#45;&gt;L14_S1_TP5_GPU13_moe_ar -->
<g id="edge4367" class="edge">
<title>L14_S1_TP4_GPU12_expert1&#45;&gt;L14_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M133401.85,-604.34C133401.85,-604.34 133401.85,-571.18 133401.85,-571.18"/>
<polygon fill="black" stroke="black" points="133405.35,-571.18 133401.85,-561.18 133398.35,-571.18 133405.35,-571.18"/>
</g>
<!-- L14_S1_TP4_GPU12_expert1&#45;&gt;L14_S1_TP6_GPU14_moe_ar -->
<g id="edge4403" class="edge">
<title>L14_S1_TP4_GPU12_expert1&#45;&gt;L14_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M133427.4,-604.46C133427.4,-602.32 133427.4,-601 133427.4,-601 133427.4,-601 133938.86,-601 133938.86,-601 133938.86,-601 133938.86,-537.29 133938.86,-537.29"/>
<polygon fill="black" stroke="black" points="133942.36,-537.29 133938.86,-527.29 133935.36,-537.29 133942.36,-537.29"/>
</g>
<!-- L14_S1_TP4_GPU12_expert1&#45;&gt;L14_S1_TP7_GPU15_moe_ar -->
<g id="edge4439" class="edge">
<title>L14_S1_TP4_GPU12_expert1&#45;&gt;L14_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M133452.95,-604.46C133452.95,-602.32 133452.95,-601 133452.95,-601 133452.95,-601 134765.29,-601 134765.29,-601 134765.29,-601 134765.29,-570.24 134765.29,-570.24"/>
<polygon fill="black" stroke="black" points="134768.79,-570.24 134765.29,-560.24 134761.79,-570.24 134768.79,-570.24"/>
</g>
<!-- L14_S1_TP5_GPU13_expert0 -->
<g id="node1493" class="node">
<title>L14_S1_TP5_GPU13_expert0</title>
<polygon fill="none" stroke="black" points="133945.5,-672.5 133496.5,-672.5 133496.5,-604.5 133945.5,-604.5 133945.5,-672.5"/>
<text text-anchor="middle" x="133721" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="133721" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="133721" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="133721" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L14_S1_TP5_GPU13_expert0&#45;&gt;L14_S1_TP0_GPU8_moe_ar -->
<g id="edge4188" class="edge">
<title>L14_S1_TP5_GPU13_expert0&#45;&gt;L14_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M133580.69,-672.74C133580.69,-681.75 133580.69,-689 133580.69,-689 133580.69,-689 130218.5,-689 130218.5,-689 130218.5,-689 130218.5,-577.82 130218.5,-577.82"/>
<polygon fill="black" stroke="black" points="130222,-577.82 130218.5,-567.82 130215,-577.82 130222,-577.82"/>
</g>
<!-- L14_S1_TP5_GPU13_expert0&#45;&gt;L14_S1_TP1_GPU9_moe_ar -->
<g id="edge4224" class="edge">
<title>L14_S1_TP5_GPU13_expert0&#45;&gt;L14_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M133538.59,-672.61C133538.59,-674.11 133538.59,-675 133538.59,-675 133538.59,-675 131148,-675 131148,-675 131148,-675 131148,-547.55 131148,-547.55"/>
<polygon fill="black" stroke="black" points="131151.5,-547.55 131148,-537.55 131144.5,-547.55 131151.5,-547.55"/>
</g>
<!-- L14_S1_TP5_GPU13_expert0&#45;&gt;L14_S1_TP2_GPU10_moe_ar -->
<g id="edge4260" class="edge">
<title>L14_S1_TP5_GPU13_expert0&#45;&gt;L14_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M133538.6,-604.15C133538.6,-590.07 133538.6,-577 133538.6,-577 133538.6,-577 131827.97,-577 131827.97,-577 131827.97,-577 131827.97,-549.89 131827.97,-549.89"/>
<polygon fill="black" stroke="black" points="131831.47,-549.89 131827.97,-539.89 131824.47,-549.89 131831.47,-549.89"/>
</g>
<!-- L14_S1_TP5_GPU13_expert0&#45;&gt;L14_S1_TP3_GPU11_moe_ar -->
<g id="edge4296" class="edge">
<title>L14_S1_TP5_GPU13_expert0&#45;&gt;L14_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M133580.69,-604.15C133580.69,-590.07 133580.69,-577 133580.69,-577 133580.69,-577 132443.91,-577 132443.91,-577 132443.91,-577 132443.91,-564.96 132443.91,-564.96"/>
<polygon fill="black" stroke="black" points="132447.41,-564.96 132443.91,-554.96 132440.41,-564.96 132447.41,-564.96"/>
</g>
<!-- L14_S1_TP5_GPU13_expert0&#45;&gt;L14_S1_TP4_GPU12_moe_ar -->
<g id="edge4332" class="edge">
<title>L14_S1_TP5_GPU13_expert0&#45;&gt;L14_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M133622.79,-604.32C133622.79,-589.73 133622.79,-576 133622.79,-576 133622.79,-576 133129.98,-576 133129.98,-576 133129.98,-576 133129.98,-564.99 133129.98,-564.99"/>
<polygon fill="black" stroke="black" points="133133.48,-564.99 133129.98,-554.99 133126.48,-564.99 133133.48,-564.99"/>
</g>
<!-- L14_S1_TP5_GPU13_expert0&#45;&gt;L14_S1_TP5_GPU13_moe_ar -->
<g id="edge4368" class="edge">
<title>L14_S1_TP5_GPU13_expert0&#45;&gt;L14_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M133664.88,-604.34C133664.88,-604.34 133664.88,-577.23 133664.88,-577.23"/>
<polygon fill="black" stroke="black" points="133668.38,-577.23 133664.88,-567.23 133661.38,-577.23 133668.38,-577.23"/>
</g>
<!-- L14_S1_TP5_GPU13_expert0&#45;&gt;L14_S1_TP6_GPU14_moe_ar -->
<g id="edge4404" class="edge">
<title>L14_S1_TP5_GPU13_expert0&#45;&gt;L14_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M133942.18,-604.34C133942.18,-604.34 133942.18,-540.13 133942.18,-540.13"/>
<polygon fill="black" stroke="black" points="133945.68,-540.13 133942.18,-530.13 133938.68,-540.13 133945.68,-540.13"/>
</g>
<!-- L14_S1_TP5_GPU13_expert0&#45;&gt;L14_S1_TP7_GPU15_moe_ar -->
<g id="edge4440" class="edge">
<title>L14_S1_TP5_GPU13_expert0&#45;&gt;L14_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M133926.5,-604.46C133926.5,-602.32 133926.5,-601 133926.5,-601 133926.5,-601 134793.85,-601 134793.85,-601 134793.85,-601 134793.85,-572.6 134793.85,-572.6"/>
<polygon fill="black" stroke="black" points="134797.35,-572.6 134793.85,-562.6 134790.35,-572.6 134797.35,-572.6"/>
</g>
<!-- L14_S1_TP5_GPU13_expert1 -->
<g id="node1494" class="node">
<title>L14_S1_TP5_GPU13_expert1</title>
<polygon fill="none" stroke="black" points="134412.5,-672.5 133963.5,-672.5 133963.5,-604.5 134412.5,-604.5 134412.5,-672.5"/>
<text text-anchor="middle" x="134188" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="134188" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="134188" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="134188" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L14_S1_TP5_GPU13_expert1&#45;&gt;L14_S1_TP0_GPU8_moe_ar -->
<g id="edge4189" class="edge">
<title>L14_S1_TP5_GPU13_expert1&#45;&gt;L14_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M134232.9,-672.74C134232.9,-681.75 134232.9,-689 134232.9,-689 134232.9,-689 130214,-689 130214,-689 130214,-689 130214,-577.82 130214,-577.82"/>
<polygon fill="black" stroke="black" points="130217.5,-577.82 130214,-567.82 130210.5,-577.82 130217.5,-577.82"/>
</g>
<!-- L14_S1_TP5_GPU13_expert1&#45;&gt;L14_S1_TP1_GPU9_moe_ar -->
<g id="edge4225" class="edge">
<title>L14_S1_TP5_GPU13_expert1&#45;&gt;L14_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M134143.1,-672.54C134143.1,-674.68 134143.1,-676 134143.1,-676 134143.1,-676 131145.75,-676 131145.75,-676 131145.75,-676 131145.75,-548.26 131145.75,-548.26"/>
<polygon fill="black" stroke="black" points="131149.25,-548.26 131145.75,-538.26 131142.25,-548.26 131149.25,-548.26"/>
</g>
<!-- L14_S1_TP5_GPU13_expert1&#45;&gt;L14_S1_TP2_GPU10_moe_ar -->
<g id="edge4261" class="edge">
<title>L14_S1_TP5_GPU13_expert1&#45;&gt;L14_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M134053.3,-672.54C134053.3,-674.68 134053.3,-676 134053.3,-676 134053.3,-676 131622.5,-676 131622.5,-676 131622.5,-676 131622.5,-576.68 131622.5,-576.68"/>
<polygon fill="black" stroke="black" points="131626,-576.68 131622.5,-566.68 131619,-576.68 131626,-576.68"/>
</g>
<!-- L14_S1_TP5_GPU13_expert1&#45;&gt;L14_S1_TP3_GPU11_moe_ar -->
<g id="edge4297" class="edge">
<title>L14_S1_TP5_GPU13_expert1&#45;&gt;L14_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M134091.79,-604.15C134091.79,-590.07 134091.79,-577 134091.79,-577 134091.79,-577 132493.69,-577 132493.69,-577 132493.69,-577 132493.69,-555.73 132493.69,-555.73"/>
<polygon fill="black" stroke="black" points="132497.19,-555.73 132493.69,-545.73 132490.19,-555.73 132497.19,-555.73"/>
</g>
<!-- L14_S1_TP5_GPU13_expert1&#45;&gt;L14_S1_TP4_GPU12_moe_ar -->
<g id="edge4333" class="edge">
<title>L14_S1_TP5_GPU13_expert1&#45;&gt;L14_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M134155.93,-604.32C134155.93,-589.73 134155.93,-576 134155.93,-576 134155.93,-576 133155.1,-576 133155.1,-576 133155.1,-576 133155.1,-561.13 133155.1,-561.13"/>
<polygon fill="black" stroke="black" points="133158.6,-561.13 133155.1,-551.13 133151.6,-561.13 133158.6,-561.13"/>
</g>
<!-- L14_S1_TP5_GPU13_expert1&#45;&gt;L14_S1_TP5_GPU13_moe_ar -->
<g id="edge4369" class="edge">
<title>L14_S1_TP5_GPU13_expert1&#45;&gt;L14_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M134220.07,-604.32C134220.07,-589.73 134220.07,-576 134220.07,-576 134220.07,-576 133706.98,-576 133706.98,-576 133706.98,-576 133706.98,-574.93 133706.98,-574.93"/>
<polygon fill="black" stroke="black" points="133710.48,-575.28 133706.98,-565.28 133703.48,-575.28 133710.48,-575.28"/>
</g>
<!-- L14_S1_TP5_GPU13_expert1&#45;&gt;L14_S1_TP6_GPU14_moe_ar -->
<g id="edge4405" class="edge">
<title>L14_S1_TP5_GPU13_expert1&#45;&gt;L14_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M134284.21,-604.34C134284.21,-604.34 134284.21,-578.55 134284.21,-578.55"/>
<polygon fill="black" stroke="black" points="134287.71,-578.55 134284.21,-568.55 134280.71,-578.55 134287.71,-578.55"/>
</g>
<!-- L14_S1_TP5_GPU13_expert1&#45;&gt;L14_S1_TP7_GPU15_moe_ar -->
<g id="edge4441" class="edge">
<title>L14_S1_TP5_GPU13_expert1&#45;&gt;L14_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M134348.36,-604.46C134348.36,-602.32 134348.36,-601 134348.36,-601 134348.36,-601 134822.4,-601 134822.4,-601 134822.4,-601 134822.4,-574.48 134822.4,-574.48"/>
<polygon fill="black" stroke="black" points="134825.9,-574.48 134822.4,-564.48 134818.9,-574.48 134825.9,-574.48"/>
</g>
<!-- L14_S1_TP6_GPU14_expert0 -->
<g id="node1495" class="node">
<title>L14_S1_TP6_GPU14_expert0</title>
<polygon fill="none" stroke="black" points="134879.5,-672.5 134430.5,-672.5 134430.5,-604.5 134879.5,-604.5 134879.5,-672.5"/>
<text text-anchor="middle" x="134655" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="134655" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="134655" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="134655" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L14_S1_TP6_GPU14_expert0&#45;&gt;L14_S1_TP0_GPU8_moe_ar -->
<g id="edge4190" class="edge">
<title>L14_S1_TP6_GPU14_expert0&#45;&gt;L14_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M134651.09,-604.36C134651.09,-590.64 134651.09,-578 134651.09,-578 134651.09,-578 130380.48,-578 130380.48,-578 130380.48,-578 130380.48,-565.24 130380.48,-565.24"/>
<polygon fill="black" stroke="black" points="130383.98,-565.24 130380.48,-555.24 130376.98,-565.24 130383.98,-565.24"/>
</g>
<!-- L14_S1_TP6_GPU14_expert0&#45;&gt;L14_S1_TP1_GPU9_moe_ar -->
<g id="edge4226" class="edge">
<title>L14_S1_TP6_GPU14_expert0&#45;&gt;L14_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M134452.25,-604.36C134452.25,-590.64 134452.25,-578 134452.25,-578 134452.25,-578 130844.17,-578 130844.17,-578 130844.17,-578 130844.17,-577.05 130844.17,-577.05"/>
<polygon fill="black" stroke="black" points="130847.67,-578.49 130844.17,-568.49 130840.67,-578.49 130847.67,-578.49"/>
</g>
<!-- L14_S1_TP6_GPU14_expert0&#45;&gt;L14_S1_TP2_GPU10_moe_ar -->
<g id="edge4262" class="edge">
<title>L14_S1_TP6_GPU14_expert0&#45;&gt;L14_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M134565.64,-672.74C134565.64,-681.75 134565.64,-689 134565.64,-689 134565.64,-689 131616.5,-689 131616.5,-689 131616.5,-689 131616.5,-576.93 131616.5,-576.93"/>
<polygon fill="black" stroke="black" points="131620,-576.93 131616.5,-566.93 131613,-576.93 131620,-576.93"/>
</g>
<!-- L14_S1_TP6_GPU14_expert0&#45;&gt;L14_S1_TP3_GPU11_moe_ar -->
<g id="edge4298" class="edge">
<title>L14_S1_TP6_GPU14_expert0&#45;&gt;L14_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M134610.49,-604.41C134610.49,-551.35 134610.49,-455 134610.49,-455 134610.49,-455 132489.37,-455 132489.37,-455 132489.37,-455 132489.37,-484.19 132489.37,-484.19"/>
<polygon fill="black" stroke="black" points="132485.87,-484.19 132489.37,-494.19 132492.87,-484.19 132485.87,-484.19"/>
</g>
<!-- L14_S1_TP6_GPU14_expert0&#45;&gt;L14_S1_TP4_GPU12_moe_ar -->
<g id="edge4334" class="edge">
<title>L14_S1_TP6_GPU14_expert0&#45;&gt;L14_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M134473.99,-604.32C134473.99,-589.73 134473.99,-576 134473.99,-576 134473.99,-576 133180.22,-576 133180.22,-576 133180.22,-576 133180.22,-555.93 133180.22,-555.93"/>
<polygon fill="black" stroke="black" points="133183.72,-555.93 133180.22,-545.93 133176.72,-555.93 133183.72,-555.93"/>
</g>
<!-- L14_S1_TP6_GPU14_expert0&#45;&gt;L14_S1_TP5_GPU13_moe_ar -->
<g id="edge4370" class="edge">
<title>L14_S1_TP6_GPU14_expert0&#45;&gt;L14_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M134495.74,-604.32C134495.74,-589.73 134495.74,-576 134495.74,-576 134495.74,-576 133749.08,-576 133749.08,-576 133749.08,-576 133749.08,-572.26 133749.08,-572.26"/>
<polygon fill="black" stroke="black" points="133752.58,-572.26 133749.08,-562.26 133745.58,-572.26 133752.58,-572.26"/>
</g>
<!-- L14_S1_TP6_GPU14_expert0&#45;&gt;L14_S1_TP6_GPU14_moe_ar -->
<g id="edge4406" class="edge">
<title>L14_S1_TP6_GPU14_expert0&#45;&gt;L14_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M134517.48,-604.34C134517.48,-604.34 134517.48,-562.87 134517.48,-562.87"/>
<polygon fill="black" stroke="black" points="134520.98,-562.87 134517.48,-552.87 134513.98,-562.87 134520.98,-562.87"/>
</g>
<!-- L14_S1_TP6_GPU14_expert0&#45;&gt;L14_S1_TP7_GPU15_moe_ar -->
<g id="edge4442" class="edge">
<title>L14_S1_TP6_GPU14_expert0&#45;&gt;L14_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M134850.95,-604.34C134850.95,-604.34 134850.95,-576.36 134850.95,-576.36"/>
<polygon fill="black" stroke="black" points="134854.45,-576.36 134850.95,-566.36 134847.45,-576.36 134854.45,-576.36"/>
</g>
<!-- L14_S1_TP6_GPU14_expert1 -->
<g id="node1496" class="node">
<title>L14_S1_TP6_GPU14_expert1</title>
<polygon fill="none" stroke="black" points="135346.5,-672.5 134897.5,-672.5 134897.5,-604.5 135346.5,-604.5 135346.5,-672.5"/>
<text text-anchor="middle" x="135122" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="135122" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="135122" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="135122" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L14_S1_TP6_GPU14_expert1&#45;&gt;L14_S1_TP0_GPU8_moe_ar -->
<g id="edge4191" class="edge">
<title>L14_S1_TP6_GPU14_expert1&#45;&gt;L14_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M134953.78,-604.36C134953.78,-590.64 134953.78,-578 134953.78,-578 134953.78,-578 130405.97,-578 130405.97,-578 130405.97,-578 130405.97,-561.23 130405.97,-561.23"/>
<polygon fill="black" stroke="black" points="130409.47,-561.23 130405.97,-551.23 130402.47,-561.23 130409.47,-561.23"/>
</g>
<!-- L14_S1_TP6_GPU14_expert1&#45;&gt;L14_S1_TP1_GPU9_moe_ar -->
<g id="edge4227" class="edge">
<title>L14_S1_TP6_GPU14_expert1&#45;&gt;L14_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M135010.06,-604.36C135010.06,-590.64 135010.06,-578 135010.06,-578 135010.06,-578 130580.52,-578 130580.52,-578 130580.52,-578 130580.52,-561.9 130580.52,-561.9"/>
<polygon fill="black" stroke="black" points="130584.02,-561.9 130580.52,-551.9 130577.02,-561.9 130584.02,-561.9"/>
</g>
<!-- L14_S1_TP6_GPU14_expert1&#45;&gt;L14_S1_TP2_GPU10_moe_ar -->
<g id="edge4263" class="edge">
<title>L14_S1_TP6_GPU14_expert1&#45;&gt;L14_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M135328.15,-604.41C135328.15,-551.35 135328.15,-455 135328.15,-455 135328.15,-455 131755.6,-455 131755.6,-455 131755.6,-455 131755.6,-475.79 131755.6,-475.79"/>
<polygon fill="black" stroke="black" points="131752.1,-475.79 131755.6,-485.79 131759.1,-475.79 131752.1,-475.79"/>
</g>
<!-- L14_S1_TP6_GPU14_expert1&#45;&gt;L14_S1_TP3_GPU11_moe_ar -->
<g id="edge4299" class="edge">
<title>L14_S1_TP6_GPU14_expert1&#45;&gt;L14_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M135309.81,-604.41C135309.81,-551.35 135309.81,-455 135309.81,-455 135309.81,-455 132435.28,-455 132435.28,-455 132435.28,-455 132435.28,-474.65 132435.28,-474.65"/>
<polygon fill="black" stroke="black" points="132431.78,-474.65 132435.28,-484.65 132438.78,-474.65 132431.78,-474.65"/>
</g>
<!-- L14_S1_TP6_GPU14_expert1&#45;&gt;L14_S1_TP4_GPU12_moe_ar -->
<g id="edge4335" class="edge">
<title>L14_S1_TP6_GPU14_expert1&#45;&gt;L14_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M135066.34,-604.32C135066.34,-589.73 135066.34,-576 135066.34,-576 135066.34,-576 133205.34,-576 133205.34,-576 133205.34,-576 133205.34,-548.92 133205.34,-548.92"/>
<polygon fill="black" stroke="black" points="133208.84,-548.92 133205.34,-538.92 133201.84,-548.92 133208.84,-548.92"/>
</g>
<!-- L14_S1_TP6_GPU14_expert1&#45;&gt;L14_S1_TP5_GPU13_moe_ar -->
<g id="edge4371" class="edge">
<title>L14_S1_TP6_GPU14_expert1&#45;&gt;L14_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M135122.62,-604.32C135122.62,-589.73 135122.62,-576 135122.62,-576 135122.62,-576 133791.17,-576 133791.17,-576 133791.17,-576 133791.17,-568.11 133791.17,-568.11"/>
<polygon fill="black" stroke="black" points="133794.67,-568.11 133791.17,-558.11 133787.67,-568.11 133794.67,-568.11"/>
</g>
<!-- L14_S1_TP6_GPU14_expert1&#45;&gt;L14_S1_TP6_GPU14_moe_ar -->
<g id="edge4407" class="edge">
<title>L14_S1_TP6_GPU14_expert1&#45;&gt;L14_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M135178.9,-604.32C135178.9,-589.73 135178.9,-576 135178.9,-576 135178.9,-576 134539.23,-576 134539.23,-576 134539.23,-576 134539.23,-559.19 134539.23,-559.19"/>
<polygon fill="black" stroke="black" points="134542.73,-559.18 134539.23,-549.19 134535.73,-559.19 134542.73,-559.18"/>
</g>
<!-- L14_S1_TP6_GPU14_expert1&#45;&gt;L14_S1_TP7_GPU15_moe_ar -->
<g id="edge4443" class="edge">
<title>L14_S1_TP6_GPU14_expert1&#45;&gt;L14_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M135235.18,-604.34C135235.18,-604.34 135235.18,-557.38 135235.18,-557.38"/>
<polygon fill="black" stroke="black" points="135238.68,-557.38 135235.18,-547.38 135231.68,-557.38 135238.68,-557.38"/>
</g>
<!-- L14_S1_TP7_GPU15_expert0 -->
<g id="node1497" class="node">
<title>L14_S1_TP7_GPU15_expert0</title>
<polygon fill="none" stroke="black" points="135813.5,-672.5 135364.5,-672.5 135364.5,-604.5 135813.5,-604.5 135813.5,-672.5"/>
<text text-anchor="middle" x="135589" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="135589" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="135589" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="135589" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L14_S1_TP7_GPU15_expert0&#45;&gt;L14_S1_TP0_GPU8_moe_ar -->
<g id="edge4192" class="edge">
<title>L14_S1_TP7_GPU15_expert0&#45;&gt;L14_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M135420.62,-604.36C135420.62,-590.64 135420.62,-578 135420.62,-578 135420.62,-578 130431.47,-578 130431.47,-578 130431.47,-578 130431.47,-556.18 130431.47,-556.18"/>
<polygon fill="black" stroke="black" points="130434.97,-556.18 130431.47,-546.18 130427.97,-556.18 130434.97,-556.18"/>
</g>
<!-- L14_S1_TP7_GPU15_expert0&#45;&gt;L14_S1_TP1_GPU9_moe_ar -->
<g id="edge4228" class="edge">
<title>L14_S1_TP7_GPU15_expert0&#45;&gt;L14_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M135757.38,-604.41C135757.38,-551.35 135757.38,-455 135757.38,-455 135757.38,-455 131002.23,-455 131002.23,-455 131002.23,-455 131002.23,-468.62 131002.23,-468.62"/>
<polygon fill="black" stroke="black" points="130998.73,-468.62 131002.23,-478.62 131005.73,-468.62 130998.73,-468.62"/>
</g>
<!-- L14_S1_TP7_GPU15_expert0&#45;&gt;L14_S1_TP2_GPU10_moe_ar -->
<g id="edge4264" class="edge">
<title>L14_S1_TP7_GPU15_expert0&#45;&gt;L14_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M135701.25,-604.41C135701.25,-551.35 135701.25,-455 135701.25,-455 135701.25,-455 131654.73,-455 131654.73,-455 131654.73,-455 131654.73,-466.06 131654.73,-466.06"/>
<polygon fill="black" stroke="black" points="131651.23,-466.06 131654.73,-476.06 131658.23,-466.06 131651.23,-466.06"/>
</g>
<!-- L14_S1_TP7_GPU15_expert0&#45;&gt;L14_S1_TP3_GPU11_moe_ar -->
<g id="edge4300" class="edge">
<title>L14_S1_TP7_GPU15_expert0&#45;&gt;L14_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M135645.12,-604.41C135645.12,-551.35 135645.12,-455 135645.12,-455 135645.12,-455 132381.18,-455 132381.18,-455 132381.18,-455 132381.18,-468.99 132381.18,-468.99"/>
<polygon fill="black" stroke="black" points="132377.68,-468.99 132381.18,-478.99 132384.68,-468.99 132377.68,-468.99"/>
</g>
<!-- L14_S1_TP7_GPU15_expert0&#45;&gt;L14_S1_TP4_GPU12_moe_ar -->
<g id="edge4336" class="edge">
<title>L14_S1_TP7_GPU15_expert0&#45;&gt;L14_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M135571.64,-672.85C135571.64,-687.81 135571.64,-702 135571.64,-702 135571.64,-702 133020.5,-702 133020.5,-702 133020.5,-702 133020.5,-575.3 133020.5,-575.3"/>
<polygon fill="black" stroke="black" points="133024,-575.3 133020.5,-565.3 133017,-575.3 133024,-575.3"/>
</g>
<!-- L14_S1_TP7_GPU15_expert0&#45;&gt;L14_S1_TP5_GPU13_moe_ar -->
<g id="edge4372" class="edge">
<title>L14_S1_TP7_GPU15_expert0&#45;&gt;L14_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M135476.75,-604.32C135476.75,-589.73 135476.75,-576 135476.75,-576 135476.75,-576 133833.27,-576 133833.27,-576 133833.27,-576 133833.27,-562.43 133833.27,-562.43"/>
<polygon fill="black" stroke="black" points="133836.77,-562.43 133833.27,-552.43 133829.77,-562.43 133836.77,-562.43"/>
</g>
<!-- L14_S1_TP7_GPU15_expert0&#45;&gt;L14_S1_TP6_GPU14_moe_ar -->
<g id="edge4408" class="edge">
<title>L14_S1_TP7_GPU15_expert0&#45;&gt;L14_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M135532.88,-604.32C135532.88,-589.73 135532.88,-576 135532.88,-576 135532.88,-576 134560.97,-576 134560.97,-576 134560.97,-576 134560.97,-554.31 134560.97,-554.31"/>
<polygon fill="black" stroke="black" points="134564.47,-554.31 134560.97,-544.31 134557.47,-554.31 134564.47,-554.31"/>
</g>
<!-- L14_S1_TP7_GPU15_expert0&#45;&gt;L14_S1_TP7_GPU15_moe_ar -->
<g id="edge4444" class="edge">
<title>L14_S1_TP7_GPU15_expert0&#45;&gt;L14_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M135589,-604.31C135589,-580.13 135589,-552 135589,-552 135589,-552 135219.51,-552 135219.51,-552"/>
<polygon fill="black" stroke="black" points="135219.51,-548.5 135209.51,-552 135219.51,-555.5 135219.51,-548.5"/>
</g>
<!-- L14_S1_TP7_GPU15_expert1 -->
<g id="node1498" class="node">
<title>L14_S1_TP7_GPU15_expert1</title>
<polygon fill="none" stroke="black" points="136280.5,-672.5 135831.5,-672.5 135831.5,-604.5 136280.5,-604.5 136280.5,-672.5"/>
<text text-anchor="middle" x="136056" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="136056" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="136056" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="136056" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L14_S1_TP7_GPU15_expert1&#45;&gt;L14_S1_TP0_GPU8_moe_ar -->
<g id="edge4193" class="edge">
<title>L14_S1_TP7_GPU15_expert1&#45;&gt;L14_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M135852.89,-604.36C135852.89,-590.64 135852.89,-578 135852.89,-578 135852.89,-578 130456.97,-578 130456.97,-578 130456.97,-578 130456.97,-548.95 130456.97,-548.95"/>
<polygon fill="black" stroke="black" points="130460.47,-548.95 130456.97,-538.95 130453.47,-548.95 130460.47,-548.95"/>
</g>
<!-- L14_S1_TP7_GPU15_expert1&#45;&gt;L14_S1_TP1_GPU9_moe_ar -->
<g id="edge4229" class="edge">
<title>L14_S1_TP7_GPU15_expert1&#45;&gt;L14_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M136002.61,-604.41C136002.61,-551.35 136002.61,-455 136002.61,-455 136002.61,-455 130835,-455 130835,-455 130835,-455 130835,-462.19 130835,-462.19"/>
<polygon fill="black" stroke="black" points="130831.5,-462.19 130835,-472.19 130838.5,-462.19 130831.5,-462.19"/>
</g>
<!-- L14_S1_TP7_GPU15_expert1&#45;&gt;L14_S1_TP2_GPU10_moe_ar -->
<g id="edge4265" class="edge">
<title>L14_S1_TP7_GPU15_expert1&#45;&gt;L14_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M135981.22,-604.41C135981.22,-551.35 135981.22,-455 135981.22,-455 135981.22,-455 131553.87,-455 131553.87,-455 131553.87,-455 131553.87,-462.53 131553.87,-462.53"/>
<polygon fill="black" stroke="black" points="131550.37,-462.53 131553.87,-472.53 131557.37,-462.53 131550.37,-462.53"/>
</g>
<!-- L14_S1_TP7_GPU15_expert1&#45;&gt;L14_S1_TP3_GPU11_moe_ar -->
<g id="edge4301" class="edge">
<title>L14_S1_TP7_GPU15_expert1&#45;&gt;L14_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M135959.83,-604.41C135959.83,-551.35 135959.83,-455 135959.83,-455 135959.83,-455 132327.09,-455 132327.09,-455 132327.09,-455 132327.09,-465.34 132327.09,-465.34"/>
<polygon fill="black" stroke="black" points="132323.59,-465.34 132327.09,-475.34 132330.59,-465.34 132323.59,-465.34"/>
</g>
<!-- L14_S1_TP7_GPU15_expert1&#45;&gt;L14_S1_TP4_GPU12_moe_ar -->
<g id="edge4337" class="edge">
<title>L14_S1_TP7_GPU15_expert1&#45;&gt;L14_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M135938.44,-604.4C135938.44,-555.69 135938.44,-472 135938.44,-472 135938.44,-472 133120.05,-472 133120.05,-472 133120.05,-472 133120.05,-474.47 133120.05,-474.47"/>
<polygon fill="black" stroke="black" points="133116.55,-474.47 133120.05,-484.47 133123.55,-474.47 133116.55,-474.47"/>
</g>
<!-- L14_S1_TP7_GPU15_expert1&#45;&gt;L14_S1_TP5_GPU13_moe_ar -->
<g id="edge4373" class="edge">
<title>L14_S1_TP7_GPU15_expert1&#45;&gt;L14_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M135874.28,-604.32C135874.28,-589.73 135874.28,-576 135874.28,-576 135874.28,-576 133875.37,-576 133875.37,-576 133875.37,-576 133875.37,-553.99 133875.37,-553.99"/>
<polygon fill="black" stroke="black" points="133878.87,-553.99 133875.37,-543.99 133871.87,-553.99 133878.87,-553.99"/>
</g>
<!-- L14_S1_TP7_GPU15_expert1&#45;&gt;L14_S1_TP6_GPU14_moe_ar -->
<g id="edge4409" class="edge">
<title>L14_S1_TP7_GPU15_expert1&#45;&gt;L14_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M135895.67,-604.32C135895.67,-589.73 135895.67,-576 135895.67,-576 135895.67,-576 134582.72,-576 134582.72,-576 134582.72,-576 134582.72,-547.7 134582.72,-547.7"/>
<polygon fill="black" stroke="black" points="134586.22,-547.7 134582.72,-537.7 134579.22,-547.7 134586.22,-547.7"/>
</g>
<!-- L14_S1_TP7_GPU15_expert1&#45;&gt;L14_S1_TP7_GPU15_moe_ar -->
<g id="edge4445" class="edge">
<title>L14_S1_TP7_GPU15_expert1&#45;&gt;L14_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M135917.06,-604.37C135917.06,-574.55 135917.06,-536 135917.06,-536 135917.06,-536 135283.69,-536 135283.69,-536"/>
<polygon fill="black" stroke="black" points="135283.69,-532.5 135273.69,-536 135283.69,-539.5 135283.69,-532.5"/>
</g>
<!-- L14_S1_TP0_GPU8_norm -->
<g id="node1500" class="node">
<title>L14_S1_TP0_GPU8_norm</title>
<polygon fill="none" stroke="black" points="128613.5,-332.33 128164.5,-332.33 128164.5,-264.33 128613.5,-264.33 128613.5,-332.33"/>
<text text-anchor="middle" x="128389" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="128389" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="128389" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="128389" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP0_GPU8_moe_res&#45;&gt;L14_S1_TP0_GPU8_norm -->
<g id="edge4196" class="edge">
<title>L14_S1_TP0_GPU8_moe_res&#45;&gt;L14_S1_TP0_GPU8_norm</title>
<path fill="none" stroke="black" d="M128389,-368.28C128389,-368.28 128389,-342.46 128389,-342.46"/>
<polygon fill="black" stroke="black" points="128392.5,-342.46 128389,-332.46 128385.5,-342.46 128392.5,-342.46"/>
</g>
<!-- L14_S1_TP1_GPU9_qkv_linear -->
<g id="node1501" class="node">
<title>L14_S1_TP1_GPU9_qkv_linear</title>
<polygon fill="none" stroke="black" points="130274,-1614.75 129666,-1614.75 129666,-1546.75 130274,-1546.75 130274,-1614.75"/>
<text text-anchor="middle" x="129970" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="129970" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="129970" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="129970" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L14_S1_TP1_GPU9_qkv_slice -->
<g id="node1502" class="node">
<title>L14_S1_TP1_GPU9_qkv_slice</title>
<polygon fill="none" stroke="black" points="130268,-1496.67 129672,-1496.67 129672,-1428.67 130268,-1428.67 130268,-1496.67"/>
<text text-anchor="middle" x="129970" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="129970" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="129970" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="129970" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L14_S1_TP1_GPU9_qkv_linear&#45;&gt;L14_S1_TP1_GPU9_qkv_slice -->
<g id="edge4197" class="edge">
<title>L14_S1_TP1_GPU9_qkv_linear&#45;&gt;L14_S1_TP1_GPU9_qkv_slice</title>
<path fill="none" stroke="black" d="M129970,-1546.59C129970,-1546.59 129970,-1506.74 129970,-1506.74"/>
<polygon fill="black" stroke="black" points="129973.5,-1506.74 129970,-1496.74 129966.5,-1506.74 129973.5,-1506.74"/>
</g>
<!-- L14_S1_TP1_GPU9_qkv_slice&#45;&gt;L14_S1_TP1_GPU9_attn_v -->
<g id="edge4201" class="edge">
<title>L14_S1_TP1_GPU9_qkv_slice&#45;&gt;L14_S1_TP1_GPU9_attn_v</title>
<path fill="none" stroke="black" d="M129723.25,-1428.38C129723.25,-1428.38 129723.25,-1195 129723.25,-1195"/>
<polygon fill="black" stroke="black" points="129726.75,-1195 129723.25,-1185 129719.75,-1195 129726.75,-1195"/>
</g>
<!-- L14_S1_TP1_GPU9_qk_matmul -->
<g id="node1503" class="node">
<title>L14_S1_TP1_GPU9_qk_matmul</title>
<polygon fill="none" stroke="black" points="130685.5,-1392.67 129750.5,-1392.67 129750.5,-1324.67 130685.5,-1324.67 130685.5,-1392.67"/>
<text text-anchor="middle" x="130218" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="130218" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="130218" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="130218" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L14_S1_TP1_GPU9_qkv_slice&#45;&gt;L14_S1_TP1_GPU9_qk_matmul -->
<g id="edge4198" class="edge">
<title>L14_S1_TP1_GPU9_qkv_slice&#45;&gt;L14_S1_TP1_GPU9_qk_matmul</title>
<path fill="none" stroke="black" d="M130009.25,-1428.61C130009.25,-1428.61 130009.25,-1402.8 130009.25,-1402.8"/>
<polygon fill="black" stroke="black" points="130012.75,-1402.8 130009.25,-1392.8 130005.75,-1402.8 130012.75,-1402.8"/>
</g>
<!-- L14_S1_TP1_GPU9_softmax -->
<g id="node1504" class="node">
<title>L14_S1_TP1_GPU9_softmax</title>
<polygon fill="none" stroke="black" points="130446,-1288.67 129936,-1288.67 129936,-1220.67 130446,-1220.67 130446,-1288.67"/>
<text text-anchor="middle" x="130191" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="130191" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="130191" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="130191" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L14_S1_TP1_GPU9_qk_matmul&#45;&gt;L14_S1_TP1_GPU9_softmax -->
<g id="edge4199" class="edge">
<title>L14_S1_TP1_GPU9_qk_matmul&#45;&gt;L14_S1_TP1_GPU9_softmax</title>
<path fill="none" stroke="black" d="M130191,-1324.61C130191,-1324.61 130191,-1298.8 130191,-1298.8"/>
<polygon fill="black" stroke="black" points="130194.5,-1298.8 130191,-1288.8 130187.5,-1298.8 130194.5,-1298.8"/>
</g>
<!-- L14_S1_TP1_GPU9_softmax&#45;&gt;L14_S1_TP1_GPU9_attn_v -->
<g id="edge4200" class="edge">
<title>L14_S1_TP1_GPU9_softmax&#45;&gt;L14_S1_TP1_GPU9_attn_v</title>
<path fill="none" stroke="black" d="M130191,-1220.61C130191,-1220.61 130191,-1194.8 130191,-1194.8"/>
<polygon fill="black" stroke="black" points="130194.5,-1194.8 130191,-1184.8 130187.5,-1194.8 130194.5,-1194.8"/>
</g>
<!-- L14_S1_TP1_GPU9_mha_res -->
<g id="node1506" class="node">
<title>L14_S1_TP1_GPU9_mha_res</title>
<polygon fill="none" stroke="black" points="130302.5,-948.5 129415.5,-948.5 129415.5,-880.5 130302.5,-880.5 130302.5,-948.5"/>
<text text-anchor="middle" x="129859" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="129859" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="129859" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="129859" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP1_GPU9_mha_ar&#45;&gt;L14_S1_TP1_GPU9_mha_res -->
<g id="edge4210" class="edge">
<title>L14_S1_TP1_GPU9_mha_ar&#45;&gt;L14_S1_TP1_GPU9_mha_res</title>
<path fill="none" stroke="black" d="M130279.51,-1015.91C130279.51,-1015.91 130279.51,-958.58 130279.51,-958.58"/>
<polygon fill="black" stroke="black" points="130283.01,-958.58 130279.51,-948.58 130276.01,-958.58 130283.01,-958.58"/>
</g>
<!-- L14_S1_TP1_GPU9_gate -->
<g id="node1507" class="node">
<title>L14_S1_TP1_GPU9_gate</title>
<polygon fill="none" stroke="black" points="130388.56,-844.5 129546.15,-844.5 129329.44,-708.5 130171.85,-708.5 130388.56,-844.5"/>
<text text-anchor="middle" x="129859" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="129859" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="129859" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="129859" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L14_S1_TP1_GPU9_mha_res&#45;&gt;L14_S1_TP1_GPU9_gate -->
<g id="edge4211" class="edge">
<title>L14_S1_TP1_GPU9_mha_res&#45;&gt;L14_S1_TP1_GPU9_gate</title>
<path fill="none" stroke="black" d="M129859,-880.39C129859,-880.39 129859,-854.73 129859,-854.73"/>
<polygon fill="black" stroke="black" points="129862.5,-854.73 129859,-844.73 129855.5,-854.73 129862.5,-854.73"/>
</g>
<!-- L14_S1_TP1_GPU9_moe_res -->
<g id="node1509" class="node">
<title>L14_S1_TP1_GPU9_moe_res</title>
<polygon fill="none" stroke="black" points="130082,-436.33 129262,-436.33 129262,-368.33 130082,-368.33 130082,-436.33"/>
<text text-anchor="middle" x="129672" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="129672" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="129672" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="129672" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP1_GPU9_mha_res&#45;&gt;L14_S1_TP1_GPU9_moe_res -->
<g id="edge4231" class="edge">
<title>L14_S1_TP1_GPU9_mha_res&#45;&gt;L14_S1_TP1_GPU9_moe_res</title>
<path fill="none" stroke="black" d="M129415.43,-914C129358.73,-914 129320,-914 129320,-914 129320,-914 129320,-681 129320,-681 129320,-681 129284.5,-681 129284.5,-681 129284.5,-681 129284.5,-446.5 129284.5,-446.5"/>
<polygon fill="black" stroke="black" points="129288,-446.5 129284.5,-436.5 129281,-446.5 129288,-446.5"/>
</g>
<!-- L14_S1_TP1_GPU9_gate&#45;&gt;L14_S1_TP1_GPU9_expert0 -->
<g id="edge4212" class="edge">
<title>L14_S1_TP1_GPU9_gate&#45;&gt;L14_S1_TP1_GPU9_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M129910.17,-708.31C129910.17,-708.31 129910.17,-682.71 129910.17,-682.71"/>
<polygon fill="black" stroke="black" points="129913.67,-682.71 129910.17,-672.71 129906.67,-682.71 129913.67,-682.71"/>
</g>
<!-- L14_S1_TP1_GPU9_gate&#45;&gt;L14_S1_TP1_GPU9_expert1 -->
<g id="edge4213" class="edge">
<title>L14_S1_TP1_GPU9_gate&#45;&gt;L14_S1_TP1_GPU9_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M130308.14,-776.4C130308.14,-776.4 130308.14,-682.74 130308.14,-682.74"/>
<polygon fill="black" stroke="black" points="130311.64,-682.74 130308.14,-672.74 130304.64,-682.74 130311.64,-682.74"/>
</g>
<!-- L14_S1_TP1_GPU9_moe_ar&#45;&gt;L14_S1_TP1_GPU9_moe_res -->
<g id="edge4230" class="edge">
<title>L14_S1_TP1_GPU9_moe_ar&#45;&gt;L14_S1_TP1_GPU9_moe_res</title>
<path fill="none" stroke="black" d="M130667.77,-478.7C130667.77,-457.44 130667.77,-436 130667.77,-436 130667.77,-436 130092.35,-436 130092.35,-436"/>
<polygon fill="black" stroke="black" points="130092.35,-432.5 130082.35,-436 130092.35,-439.5 130092.35,-432.5"/>
</g>
<!-- L14_S1_TP1_GPU9_norm -->
<g id="node1510" class="node">
<title>L14_S1_TP1_GPU9_norm</title>
<polygon fill="none" stroke="black" points="129896.5,-332.33 129447.5,-332.33 129447.5,-264.33 129896.5,-264.33 129896.5,-332.33"/>
<text text-anchor="middle" x="129672" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="129672" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="129672" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="129672" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP1_GPU9_moe_res&#45;&gt;L14_S1_TP1_GPU9_norm -->
<g id="edge4232" class="edge">
<title>L14_S1_TP1_GPU9_moe_res&#45;&gt;L14_S1_TP1_GPU9_norm</title>
<path fill="none" stroke="black" d="M129672,-368.28C129672,-368.28 129672,-342.46 129672,-342.46"/>
<polygon fill="black" stroke="black" points="129675.5,-342.46 129672,-332.46 129668.5,-342.46 129675.5,-342.46"/>
</g>
<!-- L14_S1_TP2_GPU10_qkv_linear -->
<g id="node1511" class="node">
<title>L14_S1_TP2_GPU10_qkv_linear</title>
<polygon fill="none" stroke="black" points="131366,-1614.75 130758,-1614.75 130758,-1546.75 131366,-1546.75 131366,-1614.75"/>
<text text-anchor="middle" x="131062" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="131062" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="131062" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="131062" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L14_S1_TP2_GPU10_qkv_slice -->
<g id="node1512" class="node">
<title>L14_S1_TP2_GPU10_qkv_slice</title>
<polygon fill="none" stroke="black" points="131360,-1496.67 130764,-1496.67 130764,-1428.67 131360,-1428.67 131360,-1496.67"/>
<text text-anchor="middle" x="131062" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="131062" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="131062" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="131062" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L14_S1_TP2_GPU10_qkv_linear&#45;&gt;L14_S1_TP2_GPU10_qkv_slice -->
<g id="edge4233" class="edge">
<title>L14_S1_TP2_GPU10_qkv_linear&#45;&gt;L14_S1_TP2_GPU10_qkv_slice</title>
<path fill="none" stroke="black" d="M131062,-1546.59C131062,-1546.59 131062,-1506.74 131062,-1506.74"/>
<polygon fill="black" stroke="black" points="131065.5,-1506.74 131062,-1496.74 131058.5,-1506.74 131065.5,-1506.74"/>
</g>
<!-- L14_S1_TP2_GPU10_qkv_slice&#45;&gt;L14_S1_TP2_GPU10_attn_v -->
<g id="edge4237" class="edge">
<title>L14_S1_TP2_GPU10_qkv_slice&#45;&gt;L14_S1_TP2_GPU10_attn_v</title>
<path fill="none" stroke="black" d="M130763.68,-1462C130735.96,-1462 130718,-1462 130718,-1462 130718,-1462 130718,-1194.87 130718,-1194.87"/>
<polygon fill="black" stroke="black" points="130721.5,-1194.87 130718,-1184.87 130714.5,-1194.87 130721.5,-1194.87"/>
</g>
<!-- L14_S1_TP2_GPU10_qk_matmul -->
<g id="node1513" class="node">
<title>L14_S1_TP2_GPU10_qk_matmul</title>
<polygon fill="none" stroke="black" points="131685.5,-1392.67 130750.5,-1392.67 130750.5,-1324.67 131685.5,-1324.67 131685.5,-1392.67"/>
<text text-anchor="middle" x="131218" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="131218" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="131218" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="131218" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L14_S1_TP2_GPU10_qkv_slice&#45;&gt;L14_S1_TP2_GPU10_qk_matmul -->
<g id="edge4234" class="edge">
<title>L14_S1_TP2_GPU10_qkv_slice&#45;&gt;L14_S1_TP2_GPU10_qk_matmul</title>
<path fill="none" stroke="black" d="M131062,-1428.61C131062,-1428.61 131062,-1402.8 131062,-1402.8"/>
<polygon fill="black" stroke="black" points="131065.5,-1402.8 131062,-1392.8 131058.5,-1402.8 131065.5,-1402.8"/>
</g>
<!-- L14_S1_TP2_GPU10_softmax -->
<g id="node1514" class="node">
<title>L14_S1_TP2_GPU10_softmax</title>
<polygon fill="none" stroke="black" points="131424,-1288.67 130914,-1288.67 130914,-1220.67 131424,-1220.67 131424,-1288.67"/>
<text text-anchor="middle" x="131169" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="131169" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="131169" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="131169" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L14_S1_TP2_GPU10_qk_matmul&#45;&gt;L14_S1_TP2_GPU10_softmax -->
<g id="edge4235" class="edge">
<title>L14_S1_TP2_GPU10_qk_matmul&#45;&gt;L14_S1_TP2_GPU10_softmax</title>
<path fill="none" stroke="black" d="M131169,-1324.61C131169,-1324.61 131169,-1298.8 131169,-1298.8"/>
<polygon fill="black" stroke="black" points="131172.5,-1298.8 131169,-1288.8 131165.5,-1298.8 131172.5,-1298.8"/>
</g>
<!-- L14_S1_TP2_GPU10_softmax&#45;&gt;L14_S1_TP2_GPU10_attn_v -->
<g id="edge4236" class="edge">
<title>L14_S1_TP2_GPU10_softmax&#45;&gt;L14_S1_TP2_GPU10_attn_v</title>
<path fill="none" stroke="black" d="M131169,-1220.61C131169,-1220.61 131169,-1194.8 131169,-1194.8"/>
<polygon fill="black" stroke="black" points="131172.5,-1194.8 131169,-1184.8 131165.5,-1194.8 131172.5,-1194.8"/>
</g>
<!-- L14_S1_TP2_GPU10_mha_res -->
<g id="node1516" class="node">
<title>L14_S1_TP2_GPU10_mha_res</title>
<polygon fill="none" stroke="black" points="131380.5,-948.5 130493.5,-948.5 130493.5,-880.5 131380.5,-880.5 131380.5,-948.5"/>
<text text-anchor="middle" x="130937" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="130937" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="130937" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="130937" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP2_GPU10_mha_ar&#45;&gt;L14_S1_TP2_GPU10_mha_res -->
<g id="edge4246" class="edge">
<title>L14_S1_TP2_GPU10_mha_ar&#45;&gt;L14_S1_TP2_GPU10_mha_res</title>
<path fill="none" stroke="black" d="M131203.01,-991.61C131203.01,-991.61 131203.01,-958.74 131203.01,-958.74"/>
<polygon fill="black" stroke="black" points="131206.51,-958.74 131203.01,-948.74 131199.51,-958.74 131206.51,-958.74"/>
</g>
<!-- L14_S1_TP2_GPU10_gate -->
<g id="node1517" class="node">
<title>L14_S1_TP2_GPU10_gate</title>
<polygon fill="none" stroke="black" points="131466.56,-844.5 130624.15,-844.5 130407.44,-708.5 131249.85,-708.5 131466.56,-844.5"/>
<text text-anchor="middle" x="130937" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="130937" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="130937" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="130937" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L14_S1_TP2_GPU10_mha_res&#45;&gt;L14_S1_TP2_GPU10_gate -->
<g id="edge4247" class="edge">
<title>L14_S1_TP2_GPU10_mha_res&#45;&gt;L14_S1_TP2_GPU10_gate</title>
<path fill="none" stroke="black" d="M130937,-880.39C130937,-880.39 130937,-854.73 130937,-854.73"/>
<polygon fill="black" stroke="black" points="130940.5,-854.73 130937,-844.73 130933.5,-854.73 130940.5,-854.73"/>
</g>
<!-- L14_S1_TP2_GPU10_moe_res -->
<g id="node1519" class="node">
<title>L14_S1_TP2_GPU10_moe_res</title>
<polygon fill="none" stroke="black" points="131263,-436.33 130443,-436.33 130443,-368.33 131263,-368.33 131263,-436.33"/>
<text text-anchor="middle" x="130853" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="130853" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="130853" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="130853" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP2_GPU10_mha_res&#45;&gt;L14_S1_TP2_GPU10_moe_res -->
<g id="edge4267" class="edge">
<title>L14_S1_TP2_GPU10_mha_res&#45;&gt;L14_S1_TP2_GPU10_moe_res</title>
<path fill="none" stroke="black" d="M131380.57,-914C131437.27,-914 131476,-914 131476,-914 131476,-914 131476,-676 131476,-676 131476,-676 131154.75,-676 131154.75,-676 131154.75,-676 131154.75,-578 131154.75,-578 131154.75,-578 131181.51,-578 131181.51,-578 131181.51,-578 131181.51,-446.62 131181.51,-446.62"/>
<polygon fill="black" stroke="black" points="131185.01,-446.62 131181.51,-436.62 131178.01,-446.62 131185.01,-446.62"/>
</g>
<!-- L14_S1_TP2_GPU10_gate&#45;&gt;L14_S1_TP2_GPU10_expert0 -->
<g id="edge4248" class="edge">
<title>L14_S1_TP2_GPU10_gate&#45;&gt;L14_S1_TP2_GPU10_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M130844.17,-708.31C130844.17,-708.31 130844.17,-682.71 130844.17,-682.71"/>
<polygon fill="black" stroke="black" points="130847.67,-682.71 130844.17,-672.71 130840.67,-682.71 130847.67,-682.71"/>
</g>
<!-- L14_S1_TP2_GPU10_gate&#45;&gt;L14_S1_TP2_GPU10_expert1 -->
<g id="edge4249" class="edge">
<title>L14_S1_TP2_GPU10_gate&#45;&gt;L14_S1_TP2_GPU10_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M131314.14,-748.57C131314.14,-748.57 131314.14,-682.74 131314.14,-682.74"/>
<polygon fill="black" stroke="black" points="131317.64,-682.74 131314.14,-672.74 131310.64,-682.74 131317.64,-682.74"/>
</g>
<!-- L14_S1_TP2_GPU10_moe_ar&#45;&gt;L14_S1_TP2_GPU10_moe_res -->
<g id="edge4266" class="edge">
<title>L14_S1_TP2_GPU10_moe_ar&#45;&gt;L14_S1_TP2_GPU10_moe_res</title>
<path fill="none" stroke="black" d="M131244.13,-493.62C131244.13,-493.62 131244.13,-446.66 131244.13,-446.66"/>
<polygon fill="black" stroke="black" points="131247.63,-446.66 131244.13,-436.66 131240.63,-446.66 131247.63,-446.66"/>
</g>
<!-- L14_S1_TP2_GPU10_norm -->
<g id="node1520" class="node">
<title>L14_S1_TP2_GPU10_norm</title>
<polygon fill="none" stroke="black" points="131077.5,-332.33 130628.5,-332.33 130628.5,-264.33 131077.5,-264.33 131077.5,-332.33"/>
<text text-anchor="middle" x="130853" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="130853" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="130853" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="130853" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP2_GPU10_moe_res&#45;&gt;L14_S1_TP2_GPU10_norm -->
<g id="edge4268" class="edge">
<title>L14_S1_TP2_GPU10_moe_res&#45;&gt;L14_S1_TP2_GPU10_norm</title>
<path fill="none" stroke="black" d="M130853,-368.28C130853,-368.28 130853,-342.46 130853,-342.46"/>
<polygon fill="black" stroke="black" points="130856.5,-342.46 130853,-332.46 130849.5,-342.46 130856.5,-342.46"/>
</g>
<!-- L14_S1_TP3_GPU11_qkv_linear -->
<g id="node1521" class="node">
<title>L14_S1_TP3_GPU11_qkv_linear</title>
<polygon fill="none" stroke="black" points="132177,-1614.75 131569,-1614.75 131569,-1546.75 132177,-1546.75 132177,-1614.75"/>
<text text-anchor="middle" x="131873" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="131873" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="131873" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="131873" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L14_S1_TP3_GPU11_qkv_slice -->
<g id="node1522" class="node">
<title>L14_S1_TP3_GPU11_qkv_slice</title>
<polygon fill="none" stroke="black" points="132171,-1496.67 131575,-1496.67 131575,-1428.67 132171,-1428.67 132171,-1496.67"/>
<text text-anchor="middle" x="131873" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="131873" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="131873" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="131873" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L14_S1_TP3_GPU11_qkv_linear&#45;&gt;L14_S1_TP3_GPU11_qkv_slice -->
<g id="edge4269" class="edge">
<title>L14_S1_TP3_GPU11_qkv_linear&#45;&gt;L14_S1_TP3_GPU11_qkv_slice</title>
<path fill="none" stroke="black" d="M131873,-1546.59C131873,-1546.59 131873,-1506.74 131873,-1506.74"/>
<polygon fill="black" stroke="black" points="131876.5,-1506.74 131873,-1496.74 131869.5,-1506.74 131876.5,-1506.74"/>
</g>
<!-- L14_S1_TP3_GPU11_qkv_slice&#45;&gt;L14_S1_TP3_GPU11_attn_v -->
<g id="edge4273" class="edge">
<title>L14_S1_TP3_GPU11_qkv_slice&#45;&gt;L14_S1_TP3_GPU11_attn_v</title>
<path fill="none" stroke="black" d="M131716,-1428.38C131716,-1428.38 131716,-1195 131716,-1195"/>
<polygon fill="black" stroke="black" points="131719.5,-1195 131716,-1185 131712.5,-1195 131719.5,-1195"/>
</g>
<!-- L14_S1_TP3_GPU11_qk_matmul -->
<g id="node1523" class="node">
<title>L14_S1_TP3_GPU11_qk_matmul</title>
<polygon fill="none" stroke="black" points="132681.5,-1392.67 131746.5,-1392.67 131746.5,-1324.67 132681.5,-1324.67 132681.5,-1392.67"/>
<text text-anchor="middle" x="132214" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="132214" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="132214" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="132214" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L14_S1_TP3_GPU11_qkv_slice&#45;&gt;L14_S1_TP3_GPU11_qk_matmul -->
<g id="edge4270" class="edge">
<title>L14_S1_TP3_GPU11_qkv_slice&#45;&gt;L14_S1_TP3_GPU11_qk_matmul</title>
<path fill="none" stroke="black" d="M131958.75,-1428.61C131958.75,-1428.61 131958.75,-1402.8 131958.75,-1402.8"/>
<polygon fill="black" stroke="black" points="131962.25,-1402.8 131958.75,-1392.8 131955.25,-1402.8 131962.25,-1402.8"/>
</g>
<!-- L14_S1_TP3_GPU11_softmax -->
<g id="node1524" class="node">
<title>L14_S1_TP3_GPU11_softmax</title>
<polygon fill="none" stroke="black" points="132400,-1288.67 131890,-1288.67 131890,-1220.67 132400,-1220.67 132400,-1288.67"/>
<text text-anchor="middle" x="132145" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="132145" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="132145" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="132145" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L14_S1_TP3_GPU11_qk_matmul&#45;&gt;L14_S1_TP3_GPU11_softmax -->
<g id="edge4271" class="edge">
<title>L14_S1_TP3_GPU11_qk_matmul&#45;&gt;L14_S1_TP3_GPU11_softmax</title>
<path fill="none" stroke="black" d="M132145,-1324.61C132145,-1324.61 132145,-1298.8 132145,-1298.8"/>
<polygon fill="black" stroke="black" points="132148.5,-1298.8 132145,-1288.8 132141.5,-1298.8 132148.5,-1298.8"/>
</g>
<!-- L14_S1_TP3_GPU11_softmax&#45;&gt;L14_S1_TP3_GPU11_attn_v -->
<g id="edge4272" class="edge">
<title>L14_S1_TP3_GPU11_softmax&#45;&gt;L14_S1_TP3_GPU11_attn_v</title>
<path fill="none" stroke="black" d="M132145,-1220.61C132145,-1220.61 132145,-1194.8 132145,-1194.8"/>
<polygon fill="black" stroke="black" points="132148.5,-1194.8 132145,-1184.8 132141.5,-1194.8 132148.5,-1194.8"/>
</g>
<!-- L14_S1_TP3_GPU11_mha_res -->
<g id="node1526" class="node">
<title>L14_S1_TP3_GPU11_mha_res</title>
<polygon fill="none" stroke="black" points="132458.5,-948.5 131571.5,-948.5 131571.5,-880.5 132458.5,-880.5 132458.5,-948.5"/>
<text text-anchor="middle" x="132015" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="132015" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="132015" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="132015" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP3_GPU11_mha_ar&#45;&gt;L14_S1_TP3_GPU11_mha_res -->
<g id="edge4282" class="edge">
<title>L14_S1_TP3_GPU11_mha_ar&#45;&gt;L14_S1_TP3_GPU11_mha_res</title>
<path fill="none" stroke="black" d="M132126.51,-984.55C132126.51,-984.55 132126.51,-958.73 132126.51,-958.73"/>
<polygon fill="black" stroke="black" points="132130.01,-958.73 132126.51,-948.73 132123.01,-958.73 132130.01,-958.73"/>
</g>
<!-- L14_S1_TP3_GPU11_gate -->
<g id="node1527" class="node">
<title>L14_S1_TP3_GPU11_gate</title>
<polygon fill="none" stroke="black" points="132544.56,-844.5 131702.15,-844.5 131485.44,-708.5 132327.85,-708.5 132544.56,-844.5"/>
<text text-anchor="middle" x="132015" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="132015" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="132015" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="132015" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L14_S1_TP3_GPU11_mha_res&#45;&gt;L14_S1_TP3_GPU11_gate -->
<g id="edge4283" class="edge">
<title>L14_S1_TP3_GPU11_mha_res&#45;&gt;L14_S1_TP3_GPU11_gate</title>
<path fill="none" stroke="black" d="M132015,-880.39C132015,-880.39 132015,-854.73 132015,-854.73"/>
<polygon fill="black" stroke="black" points="132018.5,-854.73 132015,-844.73 132011.5,-854.73 132018.5,-854.73"/>
</g>
<!-- L14_S1_TP3_GPU11_moe_res -->
<g id="node1529" class="node">
<title>L14_S1_TP3_GPU11_moe_res</title>
<polygon fill="none" stroke="black" points="132273,-436.33 131453,-436.33 131453,-368.33 132273,-368.33 132273,-436.33"/>
<text text-anchor="middle" x="131863" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="131863" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="131863" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="131863" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP3_GPU11_mha_res&#45;&gt;L14_S1_TP3_GPU11_moe_res -->
<g id="edge4303" class="edge">
<title>L14_S1_TP3_GPU11_mha_res&#45;&gt;L14_S1_TP3_GPU11_moe_res</title>
<path fill="none" stroke="black" d="M132458.61,-925C132517,-925 132557.1,-925 132557.1,-925 132557.1,-925 132557.1,-413 132557.1,-413 132557.1,-413 132283.03,-413 132283.03,-413"/>
<polygon fill="black" stroke="black" points="132283.03,-409.5 132273.03,-413 132283.03,-416.5 132283.03,-409.5"/>
</g>
<!-- L14_S1_TP3_GPU11_gate&#45;&gt;L14_S1_TP3_GPU11_expert0 -->
<g id="edge4284" class="edge">
<title>L14_S1_TP3_GPU11_gate&#45;&gt;L14_S1_TP3_GPU11_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M131778.17,-708.31C131778.17,-708.31 131778.17,-682.71 131778.17,-682.71"/>
<polygon fill="black" stroke="black" points="131781.67,-682.71 131778.17,-672.71 131774.67,-682.71 131781.67,-682.71"/>
</g>
<!-- L14_S1_TP3_GPU11_gate&#45;&gt;L14_S1_TP3_GPU11_expert1 -->
<g id="edge4285" class="edge">
<title>L14_S1_TP3_GPU11_gate&#45;&gt;L14_S1_TP3_GPU11_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M132207.75,-708.31C132207.75,-708.31 132207.75,-682.71 132207.75,-682.71"/>
<polygon fill="black" stroke="black" points="132211.25,-682.71 132207.75,-672.71 132204.25,-682.71 132211.25,-682.71"/>
</g>
<!-- L14_S1_TP3_GPU11_moe_ar&#45;&gt;L14_S1_TP3_GPU11_moe_res -->
<g id="edge4302" class="edge">
<title>L14_S1_TP3_GPU11_moe_ar&#45;&gt;L14_S1_TP3_GPU11_moe_res</title>
<path fill="none" stroke="black" d="M132140.18,-473.07C132140.18,-473.07 132140.18,-446.61 132140.18,-446.61"/>
<polygon fill="black" stroke="black" points="132143.68,-446.61 132140.18,-436.61 132136.68,-446.61 132143.68,-446.61"/>
</g>
<!-- L14_S1_TP3_GPU11_norm -->
<g id="node1530" class="node">
<title>L14_S1_TP3_GPU11_norm</title>
<polygon fill="none" stroke="black" points="132087.5,-332.33 131638.5,-332.33 131638.5,-264.33 132087.5,-264.33 132087.5,-332.33"/>
<text text-anchor="middle" x="131863" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="131863" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="131863" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="131863" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP3_GPU11_moe_res&#45;&gt;L14_S1_TP3_GPU11_norm -->
<g id="edge4304" class="edge">
<title>L14_S1_TP3_GPU11_moe_res&#45;&gt;L14_S1_TP3_GPU11_norm</title>
<path fill="none" stroke="black" d="M131863,-368.28C131863,-368.28 131863,-342.46 131863,-342.46"/>
<polygon fill="black" stroke="black" points="131866.5,-342.46 131863,-332.46 131859.5,-342.46 131866.5,-342.46"/>
</g>
<!-- L14_S1_TP4_GPU12_qkv_linear -->
<g id="node1531" class="node">
<title>L14_S1_TP4_GPU12_qkv_linear</title>
<polygon fill="none" stroke="black" points="133264,-1614.75 132656,-1614.75 132656,-1546.75 133264,-1546.75 133264,-1614.75"/>
<text text-anchor="middle" x="132960" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="132960" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="132960" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="132960" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L14_S1_TP4_GPU12_qkv_slice -->
<g id="node1532" class="node">
<title>L14_S1_TP4_GPU12_qkv_slice</title>
<polygon fill="none" stroke="black" points="133258,-1496.67 132662,-1496.67 132662,-1428.67 133258,-1428.67 133258,-1496.67"/>
<text text-anchor="middle" x="132960" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="132960" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="132960" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="132960" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L14_S1_TP4_GPU12_qkv_linear&#45;&gt;L14_S1_TP4_GPU12_qkv_slice -->
<g id="edge4305" class="edge">
<title>L14_S1_TP4_GPU12_qkv_linear&#45;&gt;L14_S1_TP4_GPU12_qkv_slice</title>
<path fill="none" stroke="black" d="M132960,-1546.59C132960,-1546.59 132960,-1506.74 132960,-1506.74"/>
<polygon fill="black" stroke="black" points="132963.5,-1506.74 132960,-1496.74 132956.5,-1506.74 132963.5,-1506.74"/>
</g>
<!-- L14_S1_TP4_GPU12_qkv_slice&#45;&gt;L14_S1_TP4_GPU12_attn_v -->
<g id="edge4309" class="edge">
<title>L14_S1_TP4_GPU12_qkv_slice&#45;&gt;L14_S1_TP4_GPU12_attn_v</title>
<path fill="none" stroke="black" d="M132711,-1428.38C132711,-1428.38 132711,-1195 132711,-1195"/>
<polygon fill="black" stroke="black" points="132714.5,-1195 132711,-1185 132707.5,-1195 132714.5,-1195"/>
</g>
<!-- L14_S1_TP4_GPU12_qk_matmul -->
<g id="node1533" class="node">
<title>L14_S1_TP4_GPU12_qk_matmul</title>
<polygon fill="none" stroke="black" points="133675.5,-1392.67 132740.5,-1392.67 132740.5,-1324.67 133675.5,-1324.67 133675.5,-1392.67"/>
<text text-anchor="middle" x="133208" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="133208" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="133208" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="133208" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L14_S1_TP4_GPU12_qkv_slice&#45;&gt;L14_S1_TP4_GPU12_qk_matmul -->
<g id="edge4306" class="edge">
<title>L14_S1_TP4_GPU12_qkv_slice&#45;&gt;L14_S1_TP4_GPU12_qk_matmul</title>
<path fill="none" stroke="black" d="M132999.25,-1428.61C132999.25,-1428.61 132999.25,-1402.8 132999.25,-1402.8"/>
<polygon fill="black" stroke="black" points="133002.75,-1402.8 132999.25,-1392.8 132995.75,-1402.8 133002.75,-1402.8"/>
</g>
<!-- L14_S1_TP4_GPU12_softmax -->
<g id="node1534" class="node">
<title>L14_S1_TP4_GPU12_softmax</title>
<polygon fill="none" stroke="black" points="133375,-1288.67 132865,-1288.67 132865,-1220.67 133375,-1220.67 133375,-1288.67"/>
<text text-anchor="middle" x="133120" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="133120" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="133120" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="133120" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L14_S1_TP4_GPU12_qk_matmul&#45;&gt;L14_S1_TP4_GPU12_softmax -->
<g id="edge4307" class="edge">
<title>L14_S1_TP4_GPU12_qk_matmul&#45;&gt;L14_S1_TP4_GPU12_softmax</title>
<path fill="none" stroke="black" d="M133120,-1324.61C133120,-1324.61 133120,-1298.8 133120,-1298.8"/>
<polygon fill="black" stroke="black" points="133123.5,-1298.8 133120,-1288.8 133116.5,-1298.8 133123.5,-1298.8"/>
</g>
<!-- L14_S1_TP4_GPU12_softmax&#45;&gt;L14_S1_TP4_GPU12_attn_v -->
<g id="edge4308" class="edge">
<title>L14_S1_TP4_GPU12_softmax&#45;&gt;L14_S1_TP4_GPU12_attn_v</title>
<path fill="none" stroke="black" d="M133120,-1220.61C133120,-1220.61 133120,-1194.8 133120,-1194.8"/>
<polygon fill="black" stroke="black" points="133123.5,-1194.8 133120,-1184.8 133116.5,-1194.8 133123.5,-1194.8"/>
</g>
<!-- L14_S1_TP4_GPU12_mha_res -->
<g id="node1536" class="node">
<title>L14_S1_TP4_GPU12_mha_res</title>
<polygon fill="none" stroke="black" points="133536.5,-948.5 132649.5,-948.5 132649.5,-880.5 133536.5,-880.5 133536.5,-948.5"/>
<text text-anchor="middle" x="133093" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="133093" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="133093" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="133093" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP4_GPU12_mha_ar&#45;&gt;L14_S1_TP4_GPU12_mha_res -->
<g id="edge4318" class="edge">
<title>L14_S1_TP4_GPU12_mha_ar&#45;&gt;L14_S1_TP4_GPU12_mha_res</title>
<path fill="none" stroke="black" d="M132981.99,-984.55C132981.99,-984.55 132981.99,-958.73 132981.99,-958.73"/>
<polygon fill="black" stroke="black" points="132985.49,-958.73 132981.99,-948.73 132978.49,-958.73 132985.49,-958.73"/>
</g>
<!-- L14_S1_TP4_GPU12_gate -->
<g id="node1537" class="node">
<title>L14_S1_TP4_GPU12_gate</title>
<polygon fill="none" stroke="black" points="133622.56,-844.5 132780.15,-844.5 132563.44,-708.5 133405.85,-708.5 133622.56,-844.5"/>
<text text-anchor="middle" x="133093" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="133093" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="133093" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="133093" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L14_S1_TP4_GPU12_mha_res&#45;&gt;L14_S1_TP4_GPU12_gate -->
<g id="edge4319" class="edge">
<title>L14_S1_TP4_GPU12_mha_res&#45;&gt;L14_S1_TP4_GPU12_gate</title>
<path fill="none" stroke="black" d="M133093,-880.39C133093,-880.39 133093,-854.73 133093,-854.73"/>
<polygon fill="black" stroke="black" points="133096.5,-854.73 133093,-844.73 133089.5,-854.73 133096.5,-854.73"/>
</g>
<!-- L14_S1_TP4_GPU12_moe_res -->
<g id="node1539" class="node">
<title>L14_S1_TP4_GPU12_moe_res</title>
<polygon fill="none" stroke="black" points="133388,-436.33 132568,-436.33 132568,-368.33 133388,-368.33 133388,-436.33"/>
<text text-anchor="middle" x="132978" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="132978" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="132978" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="132978" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP4_GPU12_mha_res&#45;&gt;L14_S1_TP4_GPU12_moe_res -->
<g id="edge4339" class="edge">
<title>L14_S1_TP4_GPU12_mha_res&#45;&gt;L14_S1_TP4_GPU12_moe_res</title>
<path fill="none" stroke="black" d="M132649.25,-903C132595.6,-903 132559.32,-903 132559.32,-903 132559.32,-903 132559.32,-390 132559.32,-390 132559.32,-390 132560.16,-390 132560.16,-390"/>
<polygon fill="black" stroke="black" points="132557.68,-393.5 132567.68,-390 132557.68,-386.5 132557.68,-393.5"/>
</g>
<!-- L14_S1_TP4_GPU12_gate&#45;&gt;L14_S1_TP4_GPU12_expert0 -->
<g id="edge4320" class="edge">
<title>L14_S1_TP4_GPU12_gate&#45;&gt;L14_S1_TP4_GPU12_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M132899.43,-708.31C132899.43,-708.31 132899.43,-682.71 132899.43,-682.71"/>
<polygon fill="black" stroke="black" points="132902.93,-682.71 132899.43,-672.71 132895.93,-682.71 132902.93,-682.71"/>
</g>
<!-- L14_S1_TP4_GPU12_gate&#45;&gt;L14_S1_TP4_GPU12_expert1 -->
<g id="edge4321" class="edge">
<title>L14_S1_TP4_GPU12_gate&#45;&gt;L14_S1_TP4_GPU12_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M133328.83,-708.31C133328.83,-708.31 133328.83,-682.71 133328.83,-682.71"/>
<polygon fill="black" stroke="black" points="133332.33,-682.71 133328.83,-672.71 133325.33,-682.71 133332.33,-682.71"/>
</g>
<!-- L14_S1_TP4_GPU12_moe_ar&#45;&gt;L14_S1_TP4_GPU12_moe_res -->
<g id="edge4338" class="edge">
<title>L14_S1_TP4_GPU12_moe_ar&#45;&gt;L14_S1_TP4_GPU12_moe_res</title>
<path fill="none" stroke="black" d="M133009.64,-475.1C133009.64,-475.1 133009.64,-446.34 133009.64,-446.34"/>
<polygon fill="black" stroke="black" points="133013.14,-446.34 133009.64,-436.34 133006.14,-446.34 133013.14,-446.34"/>
</g>
<!-- L14_S1_TP4_GPU12_norm -->
<g id="node1540" class="node">
<title>L14_S1_TP4_GPU12_norm</title>
<polygon fill="none" stroke="black" points="133202.5,-332.33 132753.5,-332.33 132753.5,-264.33 133202.5,-264.33 133202.5,-332.33"/>
<text text-anchor="middle" x="132978" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="132978" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="132978" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="132978" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP4_GPU12_moe_res&#45;&gt;L14_S1_TP4_GPU12_norm -->
<g id="edge4340" class="edge">
<title>L14_S1_TP4_GPU12_moe_res&#45;&gt;L14_S1_TP4_GPU12_norm</title>
<path fill="none" stroke="black" d="M132978,-368.28C132978,-368.28 132978,-342.46 132978,-342.46"/>
<polygon fill="black" stroke="black" points="132981.5,-342.46 132978,-332.46 132974.5,-342.46 132981.5,-342.46"/>
</g>
<!-- L14_S1_TP5_GPU13_qkv_linear -->
<g id="node1541" class="node">
<title>L14_S1_TP5_GPU13_qkv_linear</title>
<polygon fill="none" stroke="black" points="134257,-1614.75 133649,-1614.75 133649,-1546.75 134257,-1546.75 134257,-1614.75"/>
<text text-anchor="middle" x="133953" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="133953" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="133953" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="133953" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L14_S1_TP5_GPU13_qkv_slice -->
<g id="node1542" class="node">
<title>L14_S1_TP5_GPU13_qkv_slice</title>
<polygon fill="none" stroke="black" points="134251,-1496.67 133655,-1496.67 133655,-1428.67 134251,-1428.67 134251,-1496.67"/>
<text text-anchor="middle" x="133953" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="133953" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="133953" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="133953" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L14_S1_TP5_GPU13_qkv_linear&#45;&gt;L14_S1_TP5_GPU13_qkv_slice -->
<g id="edge4341" class="edge">
<title>L14_S1_TP5_GPU13_qkv_linear&#45;&gt;L14_S1_TP5_GPU13_qkv_slice</title>
<path fill="none" stroke="black" d="M133953,-1546.59C133953,-1546.59 133953,-1506.74 133953,-1506.74"/>
<polygon fill="black" stroke="black" points="133956.5,-1506.74 133953,-1496.74 133949.5,-1506.74 133956.5,-1506.74"/>
</g>
<!-- L14_S1_TP5_GPU13_qkv_slice&#45;&gt;L14_S1_TP5_GPU13_attn_v -->
<g id="edge4345" class="edge">
<title>L14_S1_TP5_GPU13_qkv_slice&#45;&gt;L14_S1_TP5_GPU13_attn_v</title>
<path fill="none" stroke="black" d="M133704.5,-1428.38C133704.5,-1428.38 133704.5,-1195 133704.5,-1195"/>
<polygon fill="black" stroke="black" points="133708,-1195 133704.5,-1185 133701,-1195 133708,-1195"/>
</g>
<!-- L14_S1_TP5_GPU13_qk_matmul -->
<g id="node1543" class="node">
<title>L14_S1_TP5_GPU13_qk_matmul</title>
<polygon fill="none" stroke="black" points="134668.5,-1392.67 133733.5,-1392.67 133733.5,-1324.67 134668.5,-1324.67 134668.5,-1392.67"/>
<text text-anchor="middle" x="134201" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="134201" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="134201" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="134201" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L14_S1_TP5_GPU13_qkv_slice&#45;&gt;L14_S1_TP5_GPU13_qk_matmul -->
<g id="edge4342" class="edge">
<title>L14_S1_TP5_GPU13_qkv_slice&#45;&gt;L14_S1_TP5_GPU13_qk_matmul</title>
<path fill="none" stroke="black" d="M133992.25,-1428.61C133992.25,-1428.61 133992.25,-1402.8 133992.25,-1402.8"/>
<polygon fill="black" stroke="black" points="133995.75,-1402.8 133992.25,-1392.8 133988.75,-1402.8 133995.75,-1402.8"/>
</g>
<!-- L14_S1_TP5_GPU13_softmax -->
<g id="node1544" class="node">
<title>L14_S1_TP5_GPU13_softmax</title>
<polygon fill="none" stroke="black" points="134350,-1288.67 133840,-1288.67 133840,-1220.67 134350,-1220.67 134350,-1288.67"/>
<text text-anchor="middle" x="134095" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="134095" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="134095" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="134095" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L14_S1_TP5_GPU13_qk_matmul&#45;&gt;L14_S1_TP5_GPU13_softmax -->
<g id="edge4343" class="edge">
<title>L14_S1_TP5_GPU13_qk_matmul&#45;&gt;L14_S1_TP5_GPU13_softmax</title>
<path fill="none" stroke="black" d="M134095,-1324.61C134095,-1324.61 134095,-1298.8 134095,-1298.8"/>
<polygon fill="black" stroke="black" points="134098.5,-1298.8 134095,-1288.8 134091.5,-1298.8 134098.5,-1298.8"/>
</g>
<!-- L14_S1_TP5_GPU13_softmax&#45;&gt;L14_S1_TP5_GPU13_attn_v -->
<g id="edge4344" class="edge">
<title>L14_S1_TP5_GPU13_softmax&#45;&gt;L14_S1_TP5_GPU13_attn_v</title>
<path fill="none" stroke="black" d="M134095,-1220.61C134095,-1220.61 134095,-1194.8 134095,-1194.8"/>
<polygon fill="black" stroke="black" points="134098.5,-1194.8 134095,-1184.8 134091.5,-1194.8 134098.5,-1194.8"/>
</g>
<!-- L14_S1_TP5_GPU13_mha_res -->
<g id="node1546" class="node">
<title>L14_S1_TP5_GPU13_mha_res</title>
<polygon fill="none" stroke="black" points="134614.5,-948.5 133727.5,-948.5 133727.5,-880.5 134614.5,-880.5 134614.5,-948.5"/>
<text text-anchor="middle" x="134171" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="134171" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="134171" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="134171" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP5_GPU13_mha_ar&#45;&gt;L14_S1_TP5_GPU13_mha_res -->
<g id="edge4354" class="edge">
<title>L14_S1_TP5_GPU13_mha_ar&#45;&gt;L14_S1_TP5_GPU13_mha_res</title>
<path fill="none" stroke="black" d="M133905.49,-991.61C133905.49,-991.61 133905.49,-958.74 133905.49,-958.74"/>
<polygon fill="black" stroke="black" points="133908.99,-958.74 133905.49,-948.74 133901.99,-958.74 133908.99,-958.74"/>
</g>
<!-- L14_S1_TP5_GPU13_gate -->
<g id="node1547" class="node">
<title>L14_S1_TP5_GPU13_gate</title>
<polygon fill="none" stroke="black" points="134700.56,-844.5 133858.15,-844.5 133641.44,-708.5 134483.85,-708.5 134700.56,-844.5"/>
<text text-anchor="middle" x="134171" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="134171" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="134171" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="134171" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L14_S1_TP5_GPU13_mha_res&#45;&gt;L14_S1_TP5_GPU13_gate -->
<g id="edge4355" class="edge">
<title>L14_S1_TP5_GPU13_mha_res&#45;&gt;L14_S1_TP5_GPU13_gate</title>
<path fill="none" stroke="black" d="M134171,-880.39C134171,-880.39 134171,-854.73 134171,-854.73"/>
<polygon fill="black" stroke="black" points="134174.5,-854.73 134171,-844.73 134167.5,-854.73 134174.5,-854.73"/>
</g>
<!-- L14_S1_TP5_GPU13_moe_res -->
<g id="node1549" class="node">
<title>L14_S1_TP5_GPU13_moe_res</title>
<polygon fill="none" stroke="black" points="134994,-436.33 134174,-436.33 134174,-368.33 134994,-368.33 134994,-436.33"/>
<text text-anchor="middle" x="134584" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="134584" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="134584" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="134584" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP5_GPU13_mha_res&#45;&gt;L14_S1_TP5_GPU13_moe_res -->
<g id="edge4375" class="edge">
<title>L14_S1_TP5_GPU13_mha_res&#45;&gt;L14_S1_TP5_GPU13_moe_res</title>
<path fill="none" stroke="black" d="M134614.57,-914C134671.27,-914 134710,-914 134710,-914 134710,-914 134710,-689 134710,-689 134710,-689 134883.1,-689 134883.1,-689 134883.1,-689 134883.1,-577 134883.1,-577 134883.1,-577 134616.51,-577 134616.51,-577 134616.51,-577 134616.51,-446.43 134616.51,-446.43"/>
<polygon fill="black" stroke="black" points="134620.01,-446.43 134616.51,-436.43 134613.01,-446.43 134620.01,-446.43"/>
</g>
<!-- L14_S1_TP5_GPU13_gate&#45;&gt;L14_S1_TP5_GPU13_expert0 -->
<g id="edge4356" class="edge">
<title>L14_S1_TP5_GPU13_gate&#45;&gt;L14_S1_TP5_GPU13_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M133793.36,-708.31C133793.36,-708.31 133793.36,-682.71 133793.36,-682.71"/>
<polygon fill="black" stroke="black" points="133796.86,-682.71 133793.36,-672.71 133789.86,-682.71 133796.86,-682.71"/>
</g>
<!-- L14_S1_TP5_GPU13_gate&#45;&gt;L14_S1_TP5_GPU13_expert1 -->
<g id="edge4357" class="edge">
<title>L14_S1_TP5_GPU13_gate&#45;&gt;L14_S1_TP5_GPU13_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M134322.7,-708.31C134322.7,-708.31 134322.7,-682.71 134322.7,-682.71"/>
<polygon fill="black" stroke="black" points="134326.2,-682.71 134322.7,-672.71 134319.2,-682.71 134326.2,-682.71"/>
</g>
<!-- L14_S1_TP5_GPU13_moe_ar&#45;&gt;L14_S1_TP5_GPU13_moe_res -->
<g id="edge4374" class="edge">
<title>L14_S1_TP5_GPU13_moe_ar&#45;&gt;L14_S1_TP5_GPU13_moe_res</title>
<path fill="none" stroke="black" d="M133652.73,-473.27C133652.73,-440.25 133652.73,-402 133652.73,-402 133652.73,-402 134163.84,-402 134163.84,-402"/>
<polygon fill="black" stroke="black" points="134163.84,-405.5 134173.84,-402 134163.84,-398.5 134163.84,-405.5"/>
</g>
<!-- L14_S1_TP5_GPU13_norm -->
<g id="node1550" class="node">
<title>L14_S1_TP5_GPU13_norm</title>
<polygon fill="none" stroke="black" points="134808.5,-332.33 134359.5,-332.33 134359.5,-264.33 134808.5,-264.33 134808.5,-332.33"/>
<text text-anchor="middle" x="134584" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="134584" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="134584" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="134584" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP5_GPU13_moe_res&#45;&gt;L14_S1_TP5_GPU13_norm -->
<g id="edge4376" class="edge">
<title>L14_S1_TP5_GPU13_moe_res&#45;&gt;L14_S1_TP5_GPU13_norm</title>
<path fill="none" stroke="black" d="M134584,-368.28C134584,-368.28 134584,-342.46 134584,-342.46"/>
<polygon fill="black" stroke="black" points="134587.5,-342.46 134584,-332.46 134580.5,-342.46 134587.5,-342.46"/>
</g>
<!-- L14_S1_TP6_GPU14_qkv_linear -->
<g id="node1551" class="node">
<title>L14_S1_TP6_GPU14_qkv_linear</title>
<polygon fill="none" stroke="black" points="135355,-1614.75 134747,-1614.75 134747,-1546.75 135355,-1546.75 135355,-1614.75"/>
<text text-anchor="middle" x="135051" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="135051" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="135051" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="135051" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L14_S1_TP6_GPU14_qkv_slice -->
<g id="node1552" class="node">
<title>L14_S1_TP6_GPU14_qkv_slice</title>
<polygon fill="none" stroke="black" points="135349,-1496.67 134753,-1496.67 134753,-1428.67 135349,-1428.67 135349,-1496.67"/>
<text text-anchor="middle" x="135051" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="135051" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="135051" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="135051" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L14_S1_TP6_GPU14_qkv_linear&#45;&gt;L14_S1_TP6_GPU14_qkv_slice -->
<g id="edge4377" class="edge">
<title>L14_S1_TP6_GPU14_qkv_linear&#45;&gt;L14_S1_TP6_GPU14_qkv_slice</title>
<path fill="none" stroke="black" d="M135051,-1546.59C135051,-1546.59 135051,-1506.74 135051,-1506.74"/>
<polygon fill="black" stroke="black" points="135054.5,-1506.74 135051,-1496.74 135047.5,-1506.74 135054.5,-1506.74"/>
</g>
<!-- L14_S1_TP6_GPU14_qkv_slice&#45;&gt;L14_S1_TP6_GPU14_attn_v -->
<g id="edge4381" class="edge">
<title>L14_S1_TP6_GPU14_qkv_slice&#45;&gt;L14_S1_TP6_GPU14_attn_v</title>
<path fill="none" stroke="black" d="M134792.25,-1428.38C134792.25,-1428.38 134792.25,-1195 134792.25,-1195"/>
<polygon fill="black" stroke="black" points="134795.75,-1195 134792.25,-1185 134788.75,-1195 134795.75,-1195"/>
</g>
<!-- L14_S1_TP6_GPU14_qk_matmul -->
<g id="node1553" class="node">
<title>L14_S1_TP6_GPU14_qk_matmul</title>
<polygon fill="none" stroke="black" points="135766.5,-1392.67 134831.5,-1392.67 134831.5,-1324.67 135766.5,-1324.67 135766.5,-1392.67"/>
<text text-anchor="middle" x="135299" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="135299" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="135299" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="135299" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L14_S1_TP6_GPU14_qkv_slice&#45;&gt;L14_S1_TP6_GPU14_qk_matmul -->
<g id="edge4378" class="edge">
<title>L14_S1_TP6_GPU14_qkv_slice&#45;&gt;L14_S1_TP6_GPU14_qk_matmul</title>
<path fill="none" stroke="black" d="M135090.25,-1428.61C135090.25,-1428.61 135090.25,-1402.8 135090.25,-1402.8"/>
<polygon fill="black" stroke="black" points="135093.75,-1402.8 135090.25,-1392.8 135086.75,-1402.8 135093.75,-1402.8"/>
</g>
<!-- L14_S1_TP6_GPU14_softmax -->
<g id="node1554" class="node">
<title>L14_S1_TP6_GPU14_softmax</title>
<polygon fill="none" stroke="black" points="135447,-1288.67 134937,-1288.67 134937,-1220.67 135447,-1220.67 135447,-1288.67"/>
<text text-anchor="middle" x="135192" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="135192" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="135192" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="135192" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L14_S1_TP6_GPU14_qk_matmul&#45;&gt;L14_S1_TP6_GPU14_softmax -->
<g id="edge4379" class="edge">
<title>L14_S1_TP6_GPU14_qk_matmul&#45;&gt;L14_S1_TP6_GPU14_softmax</title>
<path fill="none" stroke="black" d="M135192,-1324.61C135192,-1324.61 135192,-1298.8 135192,-1298.8"/>
<polygon fill="black" stroke="black" points="135195.5,-1298.8 135192,-1288.8 135188.5,-1298.8 135195.5,-1298.8"/>
</g>
<!-- L14_S1_TP6_GPU14_softmax&#45;&gt;L14_S1_TP6_GPU14_attn_v -->
<g id="edge4380" class="edge">
<title>L14_S1_TP6_GPU14_softmax&#45;&gt;L14_S1_TP6_GPU14_attn_v</title>
<path fill="none" stroke="black" d="M135175.5,-1220.61C135175.5,-1220.61 135175.5,-1194.8 135175.5,-1194.8"/>
<polygon fill="black" stroke="black" points="135179,-1194.8 135175.5,-1184.8 135172,-1194.8 135179,-1194.8"/>
</g>
<!-- L14_S1_TP6_GPU14_mha_res -->
<g id="node1556" class="node">
<title>L14_S1_TP6_GPU14_mha_res</title>
<polygon fill="none" stroke="black" points="135692.5,-948.5 134805.5,-948.5 134805.5,-880.5 135692.5,-880.5 135692.5,-948.5"/>
<text text-anchor="middle" x="135249" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="135249" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="135249" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="135249" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP6_GPU14_mha_ar&#45;&gt;L14_S1_TP6_GPU14_mha_res -->
<g id="edge4390" class="edge">
<title>L14_S1_TP6_GPU14_mha_ar&#45;&gt;L14_S1_TP6_GPU14_mha_res</title>
<path fill="none" stroke="black" d="M134828.99,-1015.66C134828.99,-1015.66 134828.99,-958.91 134828.99,-958.91"/>
<polygon fill="black" stroke="black" points="134832.49,-958.91 134828.99,-948.91 134825.49,-958.91 134832.49,-958.91"/>
</g>
<!-- L14_S1_TP6_GPU14_gate -->
<g id="node1557" class="node">
<title>L14_S1_TP6_GPU14_gate</title>
<polygon fill="none" stroke="black" points="135778.56,-844.5 134936.15,-844.5 134719.44,-708.5 135561.85,-708.5 135778.56,-844.5"/>
<text text-anchor="middle" x="135249" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="135249" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="135249" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="135249" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L14_S1_TP6_GPU14_mha_res&#45;&gt;L14_S1_TP6_GPU14_gate -->
<g id="edge4391" class="edge">
<title>L14_S1_TP6_GPU14_mha_res&#45;&gt;L14_S1_TP6_GPU14_gate</title>
<path fill="none" stroke="black" d="M135249,-880.39C135249,-880.39 135249,-854.73 135249,-854.73"/>
<polygon fill="black" stroke="black" points="135252.5,-854.73 135249,-844.73 135245.5,-854.73 135252.5,-854.73"/>
</g>
<!-- L14_S1_TP6_GPU14_moe_res -->
<g id="node1559" class="node">
<title>L14_S1_TP6_GPU14_moe_res</title>
<polygon fill="none" stroke="black" points="136024,-436.33 135204,-436.33 135204,-368.33 136024,-368.33 136024,-436.33"/>
<text text-anchor="middle" x="135614" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="135614" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="135614" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="135614" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP6_GPU14_mha_res&#45;&gt;L14_S1_TP6_GPU14_moe_res -->
<g id="edge4411" class="edge">
<title>L14_S1_TP6_GPU14_mha_res&#45;&gt;L14_S1_TP6_GPU14_moe_res</title>
<path fill="none" stroke="black" d="M135692.57,-914C135749.27,-914 135788,-914 135788,-914 135788,-914 135788,-685 135788,-685 135788,-685 135822.5,-685 135822.5,-685 135822.5,-685 135822.5,-446.43 135822.5,-446.43"/>
<polygon fill="black" stroke="black" points="135826,-446.43 135822.5,-436.43 135819,-446.43 135826,-446.43"/>
</g>
<!-- L14_S1_TP6_GPU14_gate&#45;&gt;L14_S1_TP6_GPU14_expert0 -->
<g id="edge4392" class="edge">
<title>L14_S1_TP6_GPU14_gate&#45;&gt;L14_S1_TP6_GPU14_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M134799.36,-708.31C134799.36,-708.31 134799.36,-682.71 134799.36,-682.71"/>
<polygon fill="black" stroke="black" points="134802.86,-682.71 134799.36,-672.71 134795.86,-682.71 134802.86,-682.71"/>
</g>
<!-- L14_S1_TP6_GPU14_gate&#45;&gt;L14_S1_TP6_GPU14_expert1 -->
<g id="edge4393" class="edge">
<title>L14_S1_TP6_GPU14_gate&#45;&gt;L14_S1_TP6_GPU14_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M135122,-708.31C135122,-708.31 135122,-682.71 135122,-682.71"/>
<polygon fill="black" stroke="black" points="135125.5,-682.71 135122,-672.71 135118.5,-682.71 135125.5,-682.71"/>
</g>
<!-- L14_S1_TP6_GPU14_moe_ar&#45;&gt;L14_S1_TP6_GPU14_moe_res -->
<g id="edge4410" class="edge">
<title>L14_S1_TP6_GPU14_moe_ar&#45;&gt;L14_S1_TP6_GPU14_moe_res</title>
<path fill="none" stroke="black" d="M134389.23,-475.29C134389.23,-455.64 134389.23,-437 134389.23,-437 134389.23,-437 135247.73,-437 135247.73,-437 135247.73,-437 135247.73,-436.96 135247.73,-436.96"/>
<polygon fill="black" stroke="black" points="135251.23,-446.61 135247.73,-436.61 135244.23,-446.61 135251.23,-446.61"/>
</g>
<!-- L14_S1_TP6_GPU14_norm -->
<g id="node1560" class="node">
<title>L14_S1_TP6_GPU14_norm</title>
<polygon fill="none" stroke="black" points="135838.5,-332.33 135389.5,-332.33 135389.5,-264.33 135838.5,-264.33 135838.5,-332.33"/>
<text text-anchor="middle" x="135614" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="135614" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="135614" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="135614" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP6_GPU14_moe_res&#45;&gt;L14_S1_TP6_GPU14_norm -->
<g id="edge4412" class="edge">
<title>L14_S1_TP6_GPU14_moe_res&#45;&gt;L14_S1_TP6_GPU14_norm</title>
<path fill="none" stroke="black" d="M135614,-368.28C135614,-368.28 135614,-342.46 135614,-342.46"/>
<polygon fill="black" stroke="black" points="135617.5,-342.46 135614,-332.46 135610.5,-342.46 135617.5,-342.46"/>
</g>
<!-- L14_S1_TP7_GPU15_qkv_linear -->
<g id="node1561" class="node">
<title>L14_S1_TP7_GPU15_qkv_linear</title>
<polygon fill="none" stroke="black" points="136400,-1614.75 135792,-1614.75 135792,-1546.75 136400,-1546.75 136400,-1614.75"/>
<text text-anchor="middle" x="136096" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="136096" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="136096" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="136096" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L14_S1_TP7_GPU15_qkv_slice -->
<g id="node1562" class="node">
<title>L14_S1_TP7_GPU15_qkv_slice</title>
<polygon fill="none" stroke="black" points="136394,-1496.67 135798,-1496.67 135798,-1428.67 136394,-1428.67 136394,-1496.67"/>
<text text-anchor="middle" x="136096" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="136096" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="136096" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="136096" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L14_S1_TP7_GPU15_qkv_linear&#45;&gt;L14_S1_TP7_GPU15_qkv_slice -->
<g id="edge4413" class="edge">
<title>L14_S1_TP7_GPU15_qkv_linear&#45;&gt;L14_S1_TP7_GPU15_qkv_slice</title>
<path fill="none" stroke="black" d="M136096,-1546.59C136096,-1546.59 136096,-1506.74 136096,-1506.74"/>
<polygon fill="black" stroke="black" points="136099.5,-1506.74 136096,-1496.74 136092.5,-1506.74 136099.5,-1506.74"/>
</g>
<!-- L14_S1_TP7_GPU15_qkv_slice&#45;&gt;L14_S1_TP7_GPU15_attn_v -->
<g id="edge4417" class="edge">
<title>L14_S1_TP7_GPU15_qkv_slice&#45;&gt;L14_S1_TP7_GPU15_attn_v</title>
<path fill="none" stroke="black" d="M135837.25,-1428.38C135837.25,-1428.38 135837.25,-1195 135837.25,-1195"/>
<polygon fill="black" stroke="black" points="135840.75,-1195 135837.25,-1185 135833.75,-1195 135840.75,-1195"/>
</g>
<!-- L14_S1_TP7_GPU15_qk_matmul -->
<g id="node1563" class="node">
<title>L14_S1_TP7_GPU15_qk_matmul</title>
<polygon fill="none" stroke="black" points="136811.5,-1392.67 135876.5,-1392.67 135876.5,-1324.67 136811.5,-1324.67 136811.5,-1392.67"/>
<text text-anchor="middle" x="136344" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="136344" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="136344" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="136344" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L14_S1_TP7_GPU15_qkv_slice&#45;&gt;L14_S1_TP7_GPU15_qk_matmul -->
<g id="edge4414" class="edge">
<title>L14_S1_TP7_GPU15_qkv_slice&#45;&gt;L14_S1_TP7_GPU15_qk_matmul</title>
<path fill="none" stroke="black" d="M136135.25,-1428.61C136135.25,-1428.61 136135.25,-1402.8 136135.25,-1402.8"/>
<polygon fill="black" stroke="black" points="136138.75,-1402.8 136135.25,-1392.8 136131.75,-1402.8 136138.75,-1402.8"/>
</g>
<!-- L14_S1_TP7_GPU15_softmax -->
<g id="node1564" class="node">
<title>L14_S1_TP7_GPU15_softmax</title>
<polygon fill="none" stroke="black" points="136492,-1288.67 135982,-1288.67 135982,-1220.67 136492,-1220.67 136492,-1288.67"/>
<text text-anchor="middle" x="136237" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="136237" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="136237" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="136237" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L14_S1_TP7_GPU15_qk_matmul&#45;&gt;L14_S1_TP7_GPU15_softmax -->
<g id="edge4415" class="edge">
<title>L14_S1_TP7_GPU15_qk_matmul&#45;&gt;L14_S1_TP7_GPU15_softmax</title>
<path fill="none" stroke="black" d="M136237,-1324.61C136237,-1324.61 136237,-1298.8 136237,-1298.8"/>
<polygon fill="black" stroke="black" points="136240.5,-1298.8 136237,-1288.8 136233.5,-1298.8 136240.5,-1298.8"/>
</g>
<!-- L14_S1_TP7_GPU15_softmax&#45;&gt;L14_S1_TP7_GPU15_attn_v -->
<g id="edge4416" class="edge">
<title>L14_S1_TP7_GPU15_softmax&#45;&gt;L14_S1_TP7_GPU15_attn_v</title>
<path fill="none" stroke="black" d="M136176,-1220.61C136176,-1220.61 136176,-1194.8 136176,-1194.8"/>
<polygon fill="black" stroke="black" points="136179.5,-1194.8 136176,-1184.8 136172.5,-1194.8 136179.5,-1194.8"/>
</g>
<!-- L14_S1_TP7_GPU15_mha_res -->
<g id="node1566" class="node">
<title>L14_S1_TP7_GPU15_mha_res</title>
<polygon fill="none" stroke="black" points="136770.5,-948.5 135883.5,-948.5 135883.5,-880.5 136770.5,-880.5 136770.5,-948.5"/>
<text text-anchor="middle" x="136327" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="136327" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="136327" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="136327" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP7_GPU15_mha_ar&#45;&gt;L14_S1_TP7_GPU15_mha_res -->
<g id="edge4426" class="edge">
<title>L14_S1_TP7_GPU15_mha_ar&#45;&gt;L14_S1_TP7_GPU15_mha_res</title>
<path fill="none" stroke="black" d="M135598.53,-1016C135843.7,-1016 136126.75,-1016 136126.75,-1016 136126.75,-1016 136126.75,-958.58 136126.75,-958.58"/>
<polygon fill="black" stroke="black" points="136130.25,-958.58 136126.75,-948.58 136123.25,-958.58 136130.25,-958.58"/>
</g>
<!-- L14_S1_TP7_GPU15_gate -->
<g id="node1567" class="node">
<title>L14_S1_TP7_GPU15_gate</title>
<polygon fill="none" stroke="black" points="136856.56,-844.5 136014.15,-844.5 135797.44,-708.5 136639.85,-708.5 136856.56,-844.5"/>
<text text-anchor="middle" x="136327" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="136327" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="136327" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="136327" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L14_S1_TP7_GPU15_mha_res&#45;&gt;L14_S1_TP7_GPU15_gate -->
<g id="edge4427" class="edge">
<title>L14_S1_TP7_GPU15_mha_res&#45;&gt;L14_S1_TP7_GPU15_gate</title>
<path fill="none" stroke="black" d="M136327,-880.39C136327,-880.39 136327,-854.73 136327,-854.73"/>
<polygon fill="black" stroke="black" points="136330.5,-854.73 136327,-844.73 136323.5,-854.73 136330.5,-854.73"/>
</g>
<!-- L14_S1_TP7_GPU15_moe_res -->
<g id="node1569" class="node">
<title>L14_S1_TP7_GPU15_moe_res</title>
<polygon fill="none" stroke="black" points="137246,-436.33 136426,-436.33 136426,-368.33 137246,-368.33 137246,-436.33"/>
<text text-anchor="middle" x="136836" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="136836" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="136836" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="136836" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP7_GPU15_mha_res&#45;&gt;L14_S1_TP7_GPU15_moe_res -->
<g id="edge4447" class="edge">
<title>L14_S1_TP7_GPU15_mha_res&#45;&gt;L14_S1_TP7_GPU15_moe_res</title>
<path fill="none" stroke="black" d="M136770.97,-914C136905.32,-914 137018,-914 137018,-914 137018,-914 137018,-446.7 137018,-446.7"/>
<polygon fill="black" stroke="black" points="137021.5,-446.7 137018,-436.7 137014.5,-446.7 137021.5,-446.7"/>
</g>
<!-- L14_S1_TP7_GPU15_gate&#45;&gt;L14_S1_TP7_GPU15_expert0 -->
<g id="edge4428" class="edge">
<title>L14_S1_TP7_GPU15_gate&#45;&gt;L14_S1_TP7_GPU15_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M135805.36,-776.4C135805.36,-776.4 135805.36,-682.74 135805.36,-682.74"/>
<polygon fill="black" stroke="black" points="135808.86,-682.74 135805.36,-672.74 135801.86,-682.74 135808.86,-682.74"/>
</g>
<!-- L14_S1_TP7_GPU15_gate&#45;&gt;L14_S1_TP7_GPU15_expert1 -->
<g id="edge4429" class="edge">
<title>L14_S1_TP7_GPU15_gate&#45;&gt;L14_S1_TP7_GPU15_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M136056,-708.31C136056,-708.31 136056,-682.71 136056,-682.71"/>
<polygon fill="black" stroke="black" points="136059.5,-682.71 136056,-672.71 136052.5,-682.71 136059.5,-682.71"/>
</g>
<!-- L14_S1_TP7_GPU15_moe_ar&#45;&gt;L14_S1_TP7_GPU15_moe_res -->
<g id="edge4446" class="edge">
<title>L14_S1_TP7_GPU15_moe_ar&#45;&gt;L14_S1_TP7_GPU15_moe_res</title>
<path fill="none" stroke="black" d="M135291.54,-520C135782.72,-520 136641.39,-520 136641.39,-520 136641.39,-520 136641.39,-446.37 136641.39,-446.37"/>
<polygon fill="black" stroke="black" points="136644.89,-446.37 136641.39,-436.37 136637.89,-446.37 136644.89,-446.37"/>
</g>
<!-- L14_S1_TP7_GPU15_norm -->
<g id="node1570" class="node">
<title>L14_S1_TP7_GPU15_norm</title>
<polygon fill="none" stroke="black" points="137060.5,-332.33 136611.5,-332.33 136611.5,-264.33 137060.5,-264.33 137060.5,-332.33"/>
<text text-anchor="middle" x="136836" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="136836" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="136836" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="136836" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L14_S1_TP7_GPU15_moe_res&#45;&gt;L14_S1_TP7_GPU15_norm -->
<g id="edge4448" class="edge">
<title>L14_S1_TP7_GPU15_moe_res&#45;&gt;L14_S1_TP7_GPU15_norm</title>
<path fill="none" stroke="black" d="M136836,-368.28C136836,-368.28 136836,-342.46 136836,-342.46"/>
<polygon fill="black" stroke="black" points="136839.5,-342.46 136836,-332.46 136832.5,-342.46 136839.5,-342.46"/>
</g>
<!-- L15_S1_TP0_GPU8_qkv_linear -->
<g id="node1571" class="node">
<title>L15_S1_TP0_GPU8_qkv_linear</title>
<polygon fill="none" stroke="black" points="138135,-1614.75 137527,-1614.75 137527,-1546.75 138135,-1546.75 138135,-1614.75"/>
<text text-anchor="middle" x="137831" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="137831" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="137831" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="137831" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L15_S1_TP0_GPU8_qkv_slice -->
<g id="node1572" class="node">
<title>L15_S1_TP0_GPU8_qkv_slice</title>
<polygon fill="none" stroke="black" points="138129,-1496.67 137533,-1496.67 137533,-1428.67 138129,-1428.67 138129,-1496.67"/>
<text text-anchor="middle" x="137831" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="137831" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="137831" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="137831" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L15_S1_TP0_GPU8_qkv_linear&#45;&gt;L15_S1_TP0_GPU8_qkv_slice -->
<g id="edge4449" class="edge">
<title>L15_S1_TP0_GPU8_qkv_linear&#45;&gt;L15_S1_TP0_GPU8_qkv_slice</title>
<path fill="none" stroke="black" d="M137831,-1546.59C137831,-1546.59 137831,-1506.74 137831,-1506.74"/>
<polygon fill="black" stroke="black" points="137834.5,-1506.74 137831,-1496.74 137827.5,-1506.74 137834.5,-1506.74"/>
</g>
<!-- L15_S1_TP0_GPU8_qk_matmul -->
<g id="node1573" class="node">
<title>L15_S1_TP0_GPU8_qk_matmul</title>
<polygon fill="none" stroke="black" points="138603.5,-1392.67 137668.5,-1392.67 137668.5,-1324.67 138603.5,-1324.67 138603.5,-1392.67"/>
<text text-anchor="middle" x="138136" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="138136" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="138136" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="138136" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L15_S1_TP0_GPU8_qkv_slice&#45;&gt;L15_S1_TP0_GPU8_qk_matmul -->
<g id="edge4450" class="edge">
<title>L15_S1_TP0_GPU8_qkv_slice&#45;&gt;L15_S1_TP0_GPU8_qk_matmul</title>
<path fill="none" stroke="black" d="M137898.75,-1428.61C137898.75,-1428.61 137898.75,-1402.8 137898.75,-1402.8"/>
<polygon fill="black" stroke="black" points="137902.25,-1402.8 137898.75,-1392.8 137895.25,-1402.8 137902.25,-1402.8"/>
</g>
<!-- L15_S1_TP0_GPU8_attn_v -->
<g id="node1575" class="node">
<title>L15_S1_TP0_GPU8_attn_v</title>
<polygon fill="none" stroke="black" points="138604,-1184.67 137666,-1184.67 137666,-1116.67 138604,-1116.67 138604,-1184.67"/>
<text text-anchor="middle" x="138135" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="138135" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="138135" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="138135" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L15_S1_TP0_GPU8_qkv_slice&#45;&gt;L15_S1_TP0_GPU8_attn_v -->
<g id="edge4453" class="edge">
<title>L15_S1_TP0_GPU8_qkv_slice&#45;&gt;L15_S1_TP0_GPU8_attn_v</title>
<path fill="none" stroke="black" d="M137599.5,-1428.61C137599.5,-1347.57 137599.5,-1150 137599.5,-1150 137599.5,-1150 137655.97,-1150 137655.97,-1150"/>
<polygon fill="black" stroke="black" points="137655.97,-1153.5 137665.97,-1150 137655.97,-1146.5 137655.97,-1153.5"/>
</g>
<!-- L15_S1_TP0_GPU8_softmax -->
<g id="node1574" class="node">
<title>L15_S1_TP0_GPU8_softmax</title>
<polygon fill="none" stroke="black" points="138390,-1288.67 137880,-1288.67 137880,-1220.67 138390,-1220.67 138390,-1288.67"/>
<text text-anchor="middle" x="138135" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="138135" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="138135" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="138135" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L15_S1_TP0_GPU8_qk_matmul&#45;&gt;L15_S1_TP0_GPU8_softmax -->
<g id="edge4451" class="edge">
<title>L15_S1_TP0_GPU8_qk_matmul&#45;&gt;L15_S1_TP0_GPU8_softmax</title>
<path fill="none" stroke="black" d="M138135,-1324.61C138135,-1324.61 138135,-1298.8 138135,-1298.8"/>
<polygon fill="black" stroke="black" points="138138.5,-1298.8 138135,-1288.8 138131.5,-1298.8 138138.5,-1298.8"/>
</g>
<!-- L15_S1_TP0_GPU8_softmax&#45;&gt;L15_S1_TP0_GPU8_attn_v -->
<g id="edge4452" class="edge">
<title>L15_S1_TP0_GPU8_softmax&#45;&gt;L15_S1_TP0_GPU8_attn_v</title>
<path fill="none" stroke="black" d="M138135,-1220.61C138135,-1220.61 138135,-1194.8 138135,-1194.8"/>
<polygon fill="black" stroke="black" points="138138.5,-1194.8 138135,-1184.8 138131.5,-1194.8 138138.5,-1194.8"/>
</g>
<!-- L15_S1_TP0_GPU8_mha_ar -->
<g id="node1576" class="node">
<title>L15_S1_TP0_GPU8_mha_ar</title>
<ellipse fill="none" stroke="black" cx="138790" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="138790" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="138790" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="138790" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="138790" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP0_GPU8_attn_v&#45;&gt;L15_S1_TP0_GPU8_mha_ar -->
<g id="edge4454" class="edge">
<title>L15_S1_TP0_GPU8_attn_v&#45;&gt;L15_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M138446.11,-1116.51C138446.11,-1116.51 138446.11,-1061.95 138446.11,-1061.95"/>
<polygon fill="black" stroke="black" points="138449.61,-1061.95 138446.11,-1051.95 138442.61,-1061.95 138449.61,-1061.95"/>
</g>
<!-- L15_S1_TP1_GPU9_mha_ar -->
<g id="node1609" class="node">
<title>L15_S1_TP1_GPU9_mha_ar</title>
<ellipse fill="none" stroke="black" cx="139559" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="139559" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="139559" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="139559" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="139559" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP0_GPU8_attn_v&#45;&gt;L15_S1_TP1_GPU9_mha_ar -->
<g id="edge4490" class="edge">
<title>L15_S1_TP0_GPU8_attn_v&#45;&gt;L15_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M138477.68,-1116.54C138477.68,-1103.63 138477.68,-1092 138477.68,-1092 138477.68,-1092 139230.59,-1092 139230.59,-1092 139230.59,-1092 139230.59,-1066.07 139230.59,-1066.07"/>
<polygon fill="black" stroke="black" points="139234.09,-1066.07 139230.59,-1056.07 139227.09,-1066.07 139234.09,-1066.07"/>
</g>
<!-- L15_S1_TP2_GPU10_mha_ar -->
<g id="node1619" class="node">
<title>L15_S1_TP2_GPU10_mha_ar</title>
<ellipse fill="none" stroke="black" cx="140328" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="140328" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="140328" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="140328" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="140328" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP0_GPU8_attn_v&#45;&gt;L15_S1_TP2_GPU10_mha_ar -->
<g id="edge4526" class="edge">
<title>L15_S1_TP0_GPU8_attn_v&#45;&gt;L15_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M138509.26,-1116.54C138509.26,-1103.63 138509.26,-1092 138509.26,-1092 138509.26,-1092 140015.13,-1092 140015.13,-1092 140015.13,-1092 140015.13,-1069.51 140015.13,-1069.51"/>
<polygon fill="black" stroke="black" points="140018.63,-1069.51 140015.13,-1059.51 140011.63,-1069.51 140018.63,-1069.51"/>
</g>
<!-- L15_S1_TP3_GPU11_mha_ar -->
<g id="node1629" class="node">
<title>L15_S1_TP3_GPU11_mha_ar</title>
<ellipse fill="none" stroke="black" cx="141097" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="141097" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="141097" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="141097" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="141097" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP0_GPU8_attn_v&#45;&gt;L15_S1_TP3_GPU11_mha_ar -->
<g id="edge4562" class="edge">
<title>L15_S1_TP0_GPU8_attn_v&#45;&gt;L15_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M138540.84,-1116.54C138540.84,-1103.63 138540.84,-1092 138540.84,-1092 138540.84,-1092 140828.74,-1092 140828.74,-1092 140828.74,-1092 140828.74,-1076.46 140828.74,-1076.46"/>
<polygon fill="black" stroke="black" points="140832.24,-1076.46 140828.74,-1066.46 140825.24,-1076.46 140832.24,-1076.46"/>
</g>
<!-- L15_S1_TP4_GPU12_mha_ar -->
<g id="node1639" class="node">
<title>L15_S1_TP4_GPU12_mha_ar</title>
<ellipse fill="none" stroke="black" cx="141866" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="141866" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="141866" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="141866" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="141866" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP0_GPU8_attn_v&#45;&gt;L15_S1_TP4_GPU12_mha_ar -->
<g id="edge4598" class="edge">
<title>L15_S1_TP0_GPU8_attn_v&#45;&gt;L15_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M138379.01,-1116.33C138379.01,-1067.28 138379.01,-983 138379.01,-983 138379.01,-983 141548.74,-983 141548.74,-983 141548.74,-983 141548.74,-996.63 141548.74,-996.63"/>
<polygon fill="black" stroke="black" points="141545.24,-996.63 141548.74,-1006.63 141552.24,-996.63 141545.24,-996.63"/>
</g>
<!-- L15_S1_TP5_GPU13_mha_ar -->
<g id="node1649" class="node">
<title>L15_S1_TP5_GPU13_mha_ar</title>
<ellipse fill="none" stroke="black" cx="142635" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="142635" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="142635" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="142635" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="142635" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP0_GPU8_attn_v&#45;&gt;L15_S1_TP5_GPU13_mha_ar -->
<g id="edge4634" class="edge">
<title>L15_S1_TP0_GPU8_attn_v&#45;&gt;L15_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M138532.33,-1184.86C138532.33,-1200.67 138532.33,-1216 138532.33,-1216 138532.33,-1216 142440,-1216 142440,-1216 142440,-1216 142440,-1083.75 142440,-1083.75"/>
<polygon fill="black" stroke="black" points="142443.5,-1083.75 142440,-1073.75 142436.5,-1083.75 142443.5,-1083.75"/>
</g>
<!-- L15_S1_TP6_GPU14_mha_ar -->
<g id="node1659" class="node">
<title>L15_S1_TP6_GPU14_mha_ar</title>
<ellipse fill="none" stroke="black" cx="143404" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="143404" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="143404" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="143404" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="143404" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP0_GPU8_attn_v&#45;&gt;L15_S1_TP6_GPU14_mha_ar -->
<g id="edge4670" class="edge">
<title>L15_S1_TP0_GPU8_attn_v&#45;&gt;L15_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M138461.17,-1184.93C138461.17,-1202.39 138461.17,-1220 138461.17,-1220 138461.17,-1220 143396,-1220 143396,-1220 143396,-1220 143396,-1090.85 143396,-1090.85"/>
<polygon fill="black" stroke="black" points="143399.5,-1090.85 143396,-1080.85 143392.5,-1090.85 143399.5,-1090.85"/>
</g>
<!-- L15_S1_TP7_GPU15_mha_ar -->
<g id="node1669" class="node">
<title>L15_S1_TP7_GPU15_mha_ar</title>
<ellipse fill="none" stroke="black" cx="144173" cy="-1032.58" rx="375.45" ry="48.17"/>
<text text-anchor="middle" x="144173" y="-1051.38" font-family="Times,serif" font-size="14.00">MHA AllReduce</text>
<text text-anchor="middle" x="144173" y="-1036.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128] (8×)</text>
<text text-anchor="middle" x="144173" y="-1021.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128]</text>
<text text-anchor="middle" x="144173" y="-1006.38" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP0_GPU8_attn_v&#45;&gt;L15_S1_TP7_GPU15_mha_ar -->
<g id="edge4706" class="edge">
<title>L15_S1_TP0_GPU8_attn_v&#45;&gt;L15_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M138572.42,-1116.48C138572.42,-1114.32 138572.42,-1113 138572.42,-1113 138572.42,-1113 143865.34,-1113 143865.34,-1113 143865.34,-1113 143865.34,-1070.26 143865.34,-1070.26"/>
<polygon fill="black" stroke="black" points="143868.84,-1070.26 143865.34,-1060.26 143861.84,-1070.26 143868.84,-1070.26"/>
</g>
<!-- L15_S1_TP0_GPU8_mha_res -->
<g id="node1584" class="node">
<title>L15_S1_TP0_GPU8_mha_res</title>
<polygon fill="none" stroke="black" points="138152.5,-948.5 137265.5,-948.5 137265.5,-880.5 138152.5,-880.5 138152.5,-948.5"/>
<text text-anchor="middle" x="137709" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="137709" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="137709" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="137709" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP0_GPU8_mha_ar&#45;&gt;L15_S1_TP0_GPU8_mha_res -->
<g id="edge4462" class="edge">
<title>L15_S1_TP0_GPU8_mha_ar&#45;&gt;L15_S1_TP0_GPU8_mha_res</title>
<path fill="none" stroke="black" d="M138434.3,-1048C138189.86,-1048 137909.25,-1048 137909.25,-1048 137909.25,-1048 137909.25,-958.53 137909.25,-958.53"/>
<polygon fill="black" stroke="black" points="137912.75,-958.53 137909.25,-948.53 137905.75,-958.53 137912.75,-958.53"/>
</g>
<!-- L15_S1_TP1_GPU9_attn_v -->
<g id="node1577" class="node">
<title>L15_S1_TP1_GPU9_attn_v</title>
<polygon fill="none" stroke="black" points="139560,-1184.67 138622,-1184.67 138622,-1116.67 139560,-1116.67 139560,-1184.67"/>
<text text-anchor="middle" x="139091" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="139091" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="139091" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="139091" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L15_S1_TP1_GPU9_attn_v&#45;&gt;L15_S1_TP0_GPU8_mha_ar -->
<g id="edge4455" class="edge">
<title>L15_S1_TP1_GPU9_attn_v&#45;&gt;L15_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M138689.93,-1116.51C138689.93,-1116.51 138689.93,-1088.96 138689.93,-1088.96"/>
<polygon fill="black" stroke="black" points="138693.43,-1088.96 138689.93,-1078.96 138686.43,-1088.96 138693.43,-1088.96"/>
</g>
<!-- L15_S1_TP1_GPU9_attn_v&#45;&gt;L15_S1_TP1_GPU9_mha_ar -->
<g id="edge4491" class="edge">
<title>L15_S1_TP1_GPU9_attn_v&#45;&gt;L15_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M139277.64,-1116.51C139277.64,-1116.51 139277.64,-1074.64 139277.64,-1074.64"/>
<polygon fill="black" stroke="black" points="139281.14,-1074.64 139277.64,-1064.64 139274.14,-1074.64 139281.14,-1074.64"/>
</g>
<!-- L15_S1_TP1_GPU9_attn_v&#45;&gt;L15_S1_TP2_GPU10_mha_ar -->
<g id="edge4527" class="edge">
<title>L15_S1_TP1_GPU9_attn_v&#45;&gt;L15_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M139324.7,-1116.54C139324.7,-1103.63 139324.7,-1092 139324.7,-1092 139324.7,-1092 140077.74,-1092 140077.74,-1092 140077.74,-1092 140077.74,-1078.52 140077.74,-1078.52"/>
<polygon fill="black" stroke="black" points="140081.24,-1078.52 140077.74,-1068.52 140074.24,-1078.52 140081.24,-1078.52"/>
</g>
<!-- L15_S1_TP1_GPU9_attn_v&#45;&gt;L15_S1_TP3_GPU11_mha_ar -->
<g id="edge4563" class="edge">
<title>L15_S1_TP1_GPU9_attn_v&#45;&gt;L15_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M139371.76,-1116.54C139371.76,-1103.63 139371.76,-1092 139371.76,-1092 139371.76,-1092 140935.95,-1092 140935.95,-1092 140935.95,-1092 140935.95,-1086.08 140935.95,-1086.08"/>
<polygon fill="black" stroke="black" points="140939.45,-1086.08 140935.95,-1076.08 140932.45,-1086.08 140939.45,-1086.08"/>
</g>
<!-- L15_S1_TP1_GPU9_attn_v&#45;&gt;L15_S1_TP4_GPU12_mha_ar -->
<g id="edge4599" class="edge">
<title>L15_S1_TP1_GPU9_attn_v&#45;&gt;L15_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M139174.5,-1116.33C139174.5,-1067.28 139174.5,-983 139174.5,-983 139174.5,-983 141519.98,-983 141519.98,-983 141519.98,-983 141519.98,-1003.84 141519.98,-1003.84"/>
<polygon fill="black" stroke="black" points="141516.48,-1003.84 141519.98,-1013.84 141523.48,-1003.84 141516.48,-1003.84"/>
</g>
<!-- L15_S1_TP1_GPU9_attn_v&#45;&gt;L15_S1_TP5_GPU13_mha_ar -->
<g id="edge4635" class="edge">
<title>L15_S1_TP1_GPU9_attn_v&#45;&gt;L15_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M139418.82,-1116.44C139418.82,-1113.72 139418.82,-1112 139418.82,-1112 139418.82,-1112 142287.61,-1112 142287.61,-1112 142287.61,-1112 142287.61,-1061 142287.61,-1061"/>
<polygon fill="black" stroke="black" points="142291.11,-1061 142287.61,-1051 142284.11,-1061 142291.11,-1061"/>
</g>
<!-- L15_S1_TP1_GPU9_attn_v&#45;&gt;L15_S1_TP6_GPU14_mha_ar -->
<g id="edge4671" class="edge">
<title>L15_S1_TP1_GPU9_attn_v&#45;&gt;L15_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M139465.88,-1116.44C139465.88,-1113.72 139465.88,-1112 139465.88,-1112 139465.88,-1112 143087.77,-1112 143087.77,-1112 143087.77,-1112 143087.77,-1068.59 143087.77,-1068.59"/>
<polygon fill="black" stroke="black" points="143091.27,-1068.59 143087.77,-1058.59 143084.27,-1068.59 143091.27,-1068.59"/>
</g>
<!-- L15_S1_TP1_GPU9_attn_v&#45;&gt;L15_S1_TP7_GPU15_mha_ar -->
<g id="edge4707" class="edge">
<title>L15_S1_TP1_GPU9_attn_v&#45;&gt;L15_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M139512.94,-1116.48C139512.94,-1114.32 139512.94,-1113 139512.94,-1113 139512.94,-1113 143933.14,-1113 143933.14,-1113 143933.14,-1113 143933.14,-1079.97 143933.14,-1079.97"/>
<polygon fill="black" stroke="black" points="143936.64,-1079.97 143933.14,-1069.97 143929.64,-1079.97 143936.64,-1079.97"/>
</g>
<!-- L15_S1_TP2_GPU10_attn_v -->
<g id="node1578" class="node">
<title>L15_S1_TP2_GPU10_attn_v</title>
<polygon fill="none" stroke="black" points="140516,-1184.67 139578,-1184.67 139578,-1116.67 140516,-1116.67 140516,-1184.67"/>
<text text-anchor="middle" x="140047" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="140047" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="140047" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="140047" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L15_S1_TP2_GPU10_attn_v&#45;&gt;L15_S1_TP0_GPU8_mha_ar -->
<g id="edge4456" class="edge">
<title>L15_S1_TP2_GPU10_attn_v&#45;&gt;L15_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M139628.92,-1116.48C139628.92,-1114.32 139628.92,-1113 139628.92,-1113 139628.92,-1113 138757.87,-1113 138757.87,-1113 138757.87,-1113 138757.87,-1090.75 138757.87,-1090.75"/>
<polygon fill="black" stroke="black" points="138761.37,-1090.75 138757.87,-1080.75 138754.37,-1090.75 138761.37,-1090.75"/>
</g>
<!-- L15_S1_TP2_GPU10_attn_v&#45;&gt;L15_S1_TP1_GPU9_mha_ar -->
<g id="edge4492" class="edge">
<title>L15_S1_TP2_GPU10_attn_v&#45;&gt;L15_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M139679.85,-1116.51C139679.85,-1116.51 139679.85,-1088.52 139679.85,-1088.52"/>
<polygon fill="black" stroke="black" points="139683.35,-1088.52 139679.85,-1078.52 139676.35,-1088.52 139683.35,-1088.52"/>
</g>
<!-- L15_S1_TP2_GPU10_attn_v&#45;&gt;L15_S1_TP2_GPU10_mha_ar -->
<g id="edge4528" class="edge">
<title>L15_S1_TP2_GPU10_attn_v&#45;&gt;L15_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M140140.35,-1116.51C140140.35,-1116.51 140140.35,-1084.63 140140.35,-1084.63"/>
<polygon fill="black" stroke="black" points="140143.85,-1084.63 140140.35,-1074.63 140136.85,-1084.63 140143.85,-1084.63"/>
</g>
<!-- L15_S1_TP2_GPU10_attn_v&#45;&gt;L15_S1_TP3_GPU11_mha_ar -->
<g id="edge4564" class="edge">
<title>L15_S1_TP2_GPU10_attn_v&#45;&gt;L15_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M140202.96,-1116.54C140202.96,-1103.63 140202.96,-1092 140202.96,-1092 140202.96,-1092 141043.16,-1092 141043.16,-1092 141043.16,-1092 141043.16,-1090.26 141043.16,-1090.26"/>
<polygon fill="black" stroke="black" points="141046.66,-1090.26 141043.16,-1080.26 141039.66,-1090.26 141046.66,-1090.26"/>
</g>
<!-- L15_S1_TP2_GPU10_attn_v&#45;&gt;L15_S1_TP4_GPU12_mha_ar -->
<g id="edge4600" class="edge">
<title>L15_S1_TP2_GPU10_attn_v&#45;&gt;L15_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M140265.57,-1116.44C140265.57,-1113.72 140265.57,-1112 140265.57,-1112 140265.57,-1112 141705.08,-1112 141705.08,-1112 141705.08,-1112 141705.08,-1086.47 141705.08,-1086.47"/>
<polygon fill="black" stroke="black" points="141708.58,-1086.47 141705.08,-1076.47 141701.58,-1086.47 141708.58,-1086.47"/>
</g>
<!-- L15_S1_TP2_GPU10_attn_v&#45;&gt;L15_S1_TP5_GPU13_mha_ar -->
<g id="edge4636" class="edge">
<title>L15_S1_TP2_GPU10_attn_v&#45;&gt;L15_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M140328.18,-1116.44C140328.18,-1113.72 140328.18,-1112 140328.18,-1112 140328.18,-1112 142315.68,-1112 142315.68,-1112 142315.68,-1112 142315.68,-1068.15 142315.68,-1068.15"/>
<polygon fill="black" stroke="black" points="142319.18,-1068.15 142315.68,-1058.15 142312.18,-1068.15 142319.18,-1068.15"/>
</g>
<!-- L15_S1_TP2_GPU10_attn_v&#45;&gt;L15_S1_TP6_GPU14_mha_ar -->
<g id="edge4672" class="edge">
<title>L15_S1_TP2_GPU10_attn_v&#45;&gt;L15_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M140390.78,-1116.48C140390.78,-1114.32 140390.78,-1113 140390.78,-1113 140390.78,-1113 143147.02,-1113 143147.02,-1113 143147.02,-1113 143147.02,-1078.09 143147.02,-1078.09"/>
<polygon fill="black" stroke="black" points="143150.52,-1078.09 143147.02,-1068.09 143143.52,-1078.09 143150.52,-1078.09"/>
</g>
<!-- L15_S1_TP2_GPU10_attn_v&#45;&gt;L15_S1_TP7_GPU15_mha_ar -->
<g id="edge4708" class="edge">
<title>L15_S1_TP2_GPU10_attn_v&#45;&gt;L15_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M140453.39,-1116.48C140453.39,-1114.32 140453.39,-1113 140453.39,-1113 140453.39,-1113 144000.95,-1113 144000.95,-1113 144000.95,-1113 144000.95,-1085.62 144000.95,-1085.62"/>
<polygon fill="black" stroke="black" points="144004.45,-1085.62 144000.95,-1075.62 143997.45,-1085.62 144004.45,-1085.62"/>
</g>
<!-- L15_S1_TP3_GPU11_attn_v -->
<g id="node1579" class="node">
<title>L15_S1_TP3_GPU11_attn_v</title>
<polygon fill="none" stroke="black" points="141472,-1184.67 140534,-1184.67 140534,-1116.67 141472,-1116.67 141472,-1184.67"/>
<text text-anchor="middle" x="141003" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="141003" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="141003" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="141003" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L15_S1_TP3_GPU11_attn_v&#45;&gt;L15_S1_TP0_GPU8_mha_ar -->
<g id="edge4457" class="edge">
<title>L15_S1_TP3_GPU11_attn_v&#45;&gt;L15_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M140567.89,-1116.48C140567.89,-1114.32 140567.89,-1113 140567.89,-1113 140567.89,-1113 138825.8,-1113 138825.8,-1113 138825.8,-1113 138825.8,-1090.75 138825.8,-1090.75"/>
<polygon fill="black" stroke="black" points="138829.3,-1090.75 138825.8,-1080.75 138822.3,-1090.75 138829.3,-1090.75"/>
</g>
<!-- L15_S1_TP3_GPU11_attn_v&#45;&gt;L15_S1_TP1_GPU9_mha_ar -->
<g id="edge4493" class="edge">
<title>L15_S1_TP3_GPU11_attn_v&#45;&gt;L15_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M140601.79,-1116.48C140601.79,-1114.32 140601.79,-1113 140601.79,-1113 140601.79,-1113 139730.77,-1113 139730.77,-1113 139730.77,-1113 139730.77,-1085.62 139730.77,-1085.62"/>
<polygon fill="black" stroke="black" points="139734.27,-1085.62 139730.77,-1075.62 139727.27,-1085.62 139734.27,-1085.62"/>
</g>
<!-- L15_S1_TP3_GPU11_attn_v&#45;&gt;L15_S1_TP2_GPU10_mha_ar -->
<g id="edge4529" class="edge">
<title>L15_S1_TP3_GPU11_attn_v&#45;&gt;L15_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M140635.68,-1116.51C140635.68,-1116.51 140635.68,-1070.31 140635.68,-1070.31"/>
<polygon fill="black" stroke="black" points="140639.18,-1070.31 140635.68,-1060.31 140632.18,-1070.31 140639.18,-1070.31"/>
</g>
<!-- L15_S1_TP3_GPU11_attn_v&#45;&gt;L15_S1_TP3_GPU11_mha_ar -->
<g id="edge4565" class="edge">
<title>L15_S1_TP3_GPU11_attn_v&#45;&gt;L15_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M141150.37,-1116.51C141150.37,-1116.51 141150.37,-1090.27 141150.37,-1090.27"/>
<polygon fill="black" stroke="black" points="141153.87,-1090.27 141150.37,-1080.27 141146.87,-1090.27 141153.87,-1090.27"/>
</g>
<!-- L15_S1_TP3_GPU11_attn_v&#45;&gt;L15_S1_TP4_GPU12_mha_ar -->
<g id="edge4601" class="edge">
<title>L15_S1_TP3_GPU11_attn_v&#45;&gt;L15_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M141472.19,-1161C141474.87,-1161 141476.29,-1161 141476.29,-1161 141476.29,-1161 141476.29,-1048 141476.29,-1048 141476.29,-1048 141500.19,-1048 141500.19,-1048"/>
<polygon fill="black" stroke="black" points="141500.19,-1051.5 141510.19,-1048 141500.19,-1044.5 141500.19,-1051.5"/>
</g>
<!-- L15_S1_TP3_GPU11_attn_v&#45;&gt;L15_S1_TP5_GPU13_mha_ar -->
<g id="edge4637" class="edge">
<title>L15_S1_TP3_GPU11_attn_v&#45;&gt;L15_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M141423,-1184.81C141423,-1190.18 141423,-1194 141423,-1194 141423,-1194 142434,-1194 142434,-1194 142434,-1194 142434,-1083.32 142434,-1083.32"/>
<polygon fill="black" stroke="black" points="142437.5,-1083.32 142434,-1073.32 142430.5,-1083.32 142437.5,-1083.32"/>
</g>
<!-- L15_S1_TP3_GPU11_attn_v&#45;&gt;L15_S1_TP6_GPU14_mha_ar -->
<g id="edge4673" class="edge">
<title>L15_S1_TP3_GPU11_attn_v&#45;&gt;L15_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M141374,-1184.91C141374,-1194.32 141374,-1202 141374,-1202 141374,-1202 143390,-1202 143390,-1202 143390,-1202 143390,-1090.68 143390,-1090.68"/>
<polygon fill="black" stroke="black" points="143393.5,-1090.68 143390,-1080.68 143386.5,-1090.68 143393.5,-1090.68"/>
</g>
<!-- L15_S1_TP3_GPU11_attn_v&#45;&gt;L15_S1_TP7_GPU15_mha_ar -->
<g id="edge4709" class="edge">
<title>L15_S1_TP3_GPU11_attn_v&#45;&gt;L15_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M141257.58,-1116.48C141257.58,-1114.32 141257.58,-1113 141257.58,-1113 141257.58,-1113 144068.76,-1113 144068.76,-1113 144068.76,-1113 144068.76,-1088.9 144068.76,-1088.9"/>
<polygon fill="black" stroke="black" points="144072.26,-1088.9 144068.76,-1078.9 144065.26,-1088.9 144072.26,-1088.9"/>
</g>
<!-- L15_S1_TP4_GPU12_attn_v -->
<g id="node1580" class="node">
<title>L15_S1_TP4_GPU12_attn_v</title>
<polygon fill="none" stroke="black" points="142428,-1184.67 141490,-1184.67 141490,-1116.67 142428,-1116.67 142428,-1184.67"/>
<text text-anchor="middle" x="141959" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="141959" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="141959" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="141959" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L15_S1_TP4_GPU12_attn_v&#45;&gt;L15_S1_TP0_GPU8_mha_ar -->
<g id="edge4458" class="edge">
<title>L15_S1_TP4_GPU12_attn_v&#45;&gt;L15_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M141597.8,-1116.44C141597.8,-1113.72 141597.8,-1112 141597.8,-1112 141597.8,-1112 138893.74,-1112 138893.74,-1112 138893.74,-1112 138893.74,-1089.24 138893.74,-1089.24"/>
<polygon fill="black" stroke="black" points="138897.24,-1089.24 138893.74,-1079.24 138890.24,-1089.24 138897.24,-1089.24"/>
</g>
<!-- L15_S1_TP4_GPU12_attn_v&#45;&gt;L15_S1_TP1_GPU9_mha_ar -->
<g id="edge4494" class="edge">
<title>L15_S1_TP4_GPU12_attn_v&#45;&gt;L15_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M141566.33,-1184.81C141566.33,-1192.28 141566.33,-1198 141566.33,-1198 141566.33,-1198 139569,-1198 139569,-1198 139569,-1198 139569,-1090.87 139569,-1090.87"/>
<polygon fill="black" stroke="black" points="139572.5,-1090.87 139569,-1080.87 139565.5,-1090.87 139572.5,-1090.87"/>
</g>
<!-- L15_S1_TP4_GPU12_attn_v&#45;&gt;L15_S1_TP2_GPU10_mha_ar -->
<g id="edge4530" class="edge">
<title>L15_S1_TP4_GPU12_attn_v&#45;&gt;L15_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M141528.17,-1184.9C141528.17,-1187.42 141528.17,-1189 141528.17,-1189 141528.17,-1189 140529.5,-1189 140529.5,-1189 140529.5,-1189 140529.5,-1083.27 140529.5,-1083.27"/>
<polygon fill="black" stroke="black" points="140533,-1083.27 140529.5,-1073.27 140526,-1083.27 140533,-1083.27"/>
</g>
<!-- L15_S1_TP4_GPU12_attn_v&#45;&gt;L15_S1_TP3_GPU11_mha_ar -->
<g id="edge4566" class="edge">
<title>L15_S1_TP4_GPU12_attn_v&#45;&gt;L15_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M141489.97,-1139C141482.62,-1139 141478.57,-1139 141478.57,-1139 141478.57,-1139 141478.57,-1016 141478.57,-1016 141478.57,-1016 141459.58,-1016 141459.58,-1016"/>
<polygon fill="black" stroke="black" points="141459.58,-1012.5 141449.58,-1016 141459.58,-1019.5 141459.58,-1012.5"/>
</g>
<!-- L15_S1_TP4_GPU12_attn_v&#45;&gt;L15_S1_TP4_GPU12_mha_ar -->
<g id="edge4602" class="edge">
<title>L15_S1_TP4_GPU12_attn_v&#45;&gt;L15_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M141812.36,-1116.51C141812.36,-1116.51 141812.36,-1090.27 141812.36,-1090.27"/>
<polygon fill="black" stroke="black" points="141815.86,-1090.27 141812.36,-1080.27 141808.86,-1090.27 141815.86,-1090.27"/>
</g>
<!-- L15_S1_TP4_GPU12_attn_v&#45;&gt;L15_S1_TP5_GPU13_mha_ar -->
<g id="edge4638" class="edge">
<title>L15_S1_TP4_GPU12_attn_v&#45;&gt;L15_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M142343.76,-1116.51C142343.76,-1116.51 142343.76,-1073.04 142343.76,-1073.04"/>
<polygon fill="black" stroke="black" points="142347.26,-1073.04 142343.76,-1063.04 142340.26,-1073.04 142347.26,-1073.04"/>
</g>
<!-- L15_S1_TP4_GPU12_attn_v&#45;&gt;L15_S1_TP6_GPU14_mha_ar -->
<g id="edge4674" class="edge">
<title>L15_S1_TP4_GPU12_attn_v&#45;&gt;L15_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M142371.84,-1116.39C142371.84,-1116.14 142371.84,-1116 142371.84,-1116 142371.84,-1116 143206.26,-1116 143206.26,-1116 143206.26,-1116 143206.26,-1083.8 143206.26,-1083.8"/>
<polygon fill="black" stroke="black" points="143209.76,-1083.8 143206.26,-1073.8 143202.76,-1083.8 143209.76,-1083.8"/>
</g>
<!-- L15_S1_TP4_GPU12_attn_v&#45;&gt;L15_S1_TP7_GPU15_mha_ar -->
<g id="edge4710" class="edge">
<title>L15_S1_TP4_GPU12_attn_v&#45;&gt;L15_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M142399.92,-1116.39C142399.92,-1116.14 142399.92,-1116 142399.92,-1116 142399.92,-1116 144136.57,-1116 144136.57,-1116 144136.57,-1116 144136.57,-1090.62 144136.57,-1090.62"/>
<polygon fill="black" stroke="black" points="144140.07,-1090.62 144136.57,-1080.62 144133.07,-1090.62 144140.07,-1090.62"/>
</g>
<!-- L15_S1_TP5_GPU13_attn_v -->
<g id="node1581" class="node">
<title>L15_S1_TP5_GPU13_attn_v</title>
<polygon fill="none" stroke="black" points="143384,-1184.67 142446,-1184.67 142446,-1116.67 143384,-1116.67 143384,-1184.67"/>
<text text-anchor="middle" x="142915" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="142915" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="142915" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="142915" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L15_S1_TP5_GPU13_attn_v&#45;&gt;L15_S1_TP0_GPU8_mha_ar -->
<g id="edge4459" class="edge">
<title>L15_S1_TP5_GPU13_attn_v&#45;&gt;L15_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M142516.56,-1116.44C142516.56,-1113.72 142516.56,-1112 142516.56,-1112 142516.56,-1112 138961.67,-1112 138961.67,-1112 138961.67,-1112 138961.67,-1085.55 138961.67,-1085.55"/>
<polygon fill="black" stroke="black" points="138965.17,-1085.55 138961.67,-1075.55 138958.17,-1085.55 138965.17,-1085.55"/>
</g>
<!-- L15_S1_TP5_GPU13_attn_v&#45;&gt;L15_S1_TP1_GPU9_mha_ar -->
<g id="edge4495" class="edge">
<title>L15_S1_TP5_GPU13_attn_v&#45;&gt;L15_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M142587.12,-1116.48C142587.12,-1114.32 142587.12,-1113 142587.12,-1113 142587.12,-1113 139781.7,-1113 139781.7,-1113 139781.7,-1113 139781.7,-1081.38 139781.7,-1081.38"/>
<polygon fill="black" stroke="black" points="139785.2,-1081.38 139781.7,-1071.38 139778.2,-1081.38 139785.2,-1081.38"/>
</g>
<!-- L15_S1_TP5_GPU13_attn_v&#45;&gt;L15_S1_TP2_GPU10_mha_ar -->
<g id="edge4531" class="edge">
<title>L15_S1_TP5_GPU13_attn_v&#45;&gt;L15_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M142523.25,-1184.77C142523.25,-1195.68 142523.25,-1205 142523.25,-1205 142523.25,-1205 140525,-1205 140525,-1205 140525,-1205 140525,-1083.88 140525,-1083.88"/>
<polygon fill="black" stroke="black" points="140528.5,-1083.88 140525,-1073.88 140521.5,-1083.88 140528.5,-1083.88"/>
</g>
<!-- L15_S1_TP5_GPU13_attn_v&#45;&gt;L15_S1_TP3_GPU11_mha_ar -->
<g id="edge4567" class="edge">
<title>L15_S1_TP5_GPU13_attn_v&#45;&gt;L15_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M142657.68,-1116.48C142657.68,-1114.32 142657.68,-1113 142657.68,-1113 142657.68,-1113 141364.79,-1113 141364.79,-1113 141364.79,-1113 141364.79,-1076.69 141364.79,-1076.69"/>
<polygon fill="black" stroke="black" points="141368.29,-1076.69 141364.79,-1066.69 141361.29,-1076.69 141368.29,-1076.69"/>
</g>
<!-- L15_S1_TP5_GPU13_attn_v&#45;&gt;L15_S1_TP4_GPU12_mha_ar -->
<g id="edge4603" class="edge">
<title>L15_S1_TP5_GPU13_attn_v&#45;&gt;L15_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M142728.24,-1116.44C142728.24,-1100.93 142728.24,-1086 142728.24,-1086 142728.24,-1086 141919.64,-1086 141919.64,-1086 141919.64,-1086 141919.64,-1085.43 141919.64,-1085.43"/>
<polygon fill="black" stroke="black" points="141923.14,-1090.28 141919.64,-1080.28 141916.14,-1090.28 141923.14,-1090.28"/>
</g>
<!-- L15_S1_TP5_GPU13_attn_v&#45;&gt;L15_S1_TP5_GPU13_mha_ar -->
<g id="edge4639" class="edge">
<title>L15_S1_TP5_GPU13_attn_v&#45;&gt;L15_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M142798.8,-1116.51C142798.8,-1116.51 142798.8,-1085.92 142798.8,-1085.92"/>
<polygon fill="black" stroke="black" points="142802.3,-1085.92 142798.8,-1075.92 142795.3,-1085.92 142802.3,-1085.92"/>
</g>
<!-- L15_S1_TP5_GPU13_attn_v&#45;&gt;L15_S1_TP6_GPU14_mha_ar -->
<g id="edge4675" class="edge">
<title>L15_S1_TP5_GPU13_attn_v&#45;&gt;L15_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M143265.51,-1116.51C143265.51,-1116.51 143265.51,-1087.65 143265.51,-1087.65"/>
<polygon fill="black" stroke="black" points="143269.01,-1087.65 143265.51,-1077.65 143262.01,-1087.65 143269.01,-1087.65"/>
</g>
<!-- L15_S1_TP5_GPU13_attn_v&#45;&gt;L15_S1_TP7_GPU15_mha_ar -->
<g id="edge4711" class="edge">
<title>L15_S1_TP5_GPU13_attn_v&#45;&gt;L15_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M143324.75,-1116.39C143324.75,-1116.14 143324.75,-1116 143324.75,-1116 143324.75,-1116 144204.38,-1116 144204.38,-1116 144204.38,-1116 144204.38,-1090.62 144204.38,-1090.62"/>
<polygon fill="black" stroke="black" points="144207.88,-1090.62 144204.38,-1080.62 144200.88,-1090.62 144207.88,-1090.62"/>
</g>
<!-- L15_S1_TP6_GPU14_attn_v -->
<g id="node1582" class="node">
<title>L15_S1_TP6_GPU14_attn_v</title>
<polygon fill="none" stroke="black" points="144340,-1184.67 143402,-1184.67 143402,-1116.67 144340,-1116.67 144340,-1184.67"/>
<text text-anchor="middle" x="143871" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="143871" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="143871" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="143871" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L15_S1_TP6_GPU14_attn_v&#45;&gt;L15_S1_TP0_GPU8_mha_ar -->
<g id="edge4460" class="edge">
<title>L15_S1_TP6_GPU14_attn_v&#45;&gt;L15_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M143449.18,-1116.44C143449.18,-1113.72 143449.18,-1112 143449.18,-1112 143449.18,-1112 139029.61,-1112 139029.61,-1112 139029.61,-1112 139029.61,-1079.97 139029.61,-1079.97"/>
<polygon fill="black" stroke="black" points="139033.11,-1079.97 139029.61,-1069.97 139026.11,-1079.97 139033.11,-1079.97"/>
</g>
<!-- L15_S1_TP6_GPU14_attn_v&#45;&gt;L15_S1_TP1_GPU9_mha_ar -->
<g id="edge4496" class="edge">
<title>L15_S1_TP6_GPU14_attn_v&#45;&gt;L15_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M143496.37,-1116.44C143496.37,-1113.72 143496.37,-1112 143496.37,-1112 143496.37,-1112 139832.62,-1112 139832.62,-1112 139832.62,-1112 139832.62,-1075.8 139832.62,-1075.8"/>
<polygon fill="black" stroke="black" points="139836.12,-1075.8 139832.62,-1065.8 139829.12,-1075.8 139836.12,-1075.8"/>
</g>
<!-- L15_S1_TP6_GPU14_attn_v&#45;&gt;L15_S1_TP2_GPU10_mha_ar -->
<g id="edge4532" class="edge">
<title>L15_S1_TP6_GPU14_attn_v&#45;&gt;L15_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M143543.55,-1116.44C143543.55,-1113.72 143543.55,-1112 143543.55,-1112 143543.55,-1112 140669.58,-1112 140669.58,-1112 140669.58,-1112 140669.58,-1062.62 140669.58,-1062.62"/>
<polygon fill="black" stroke="black" points="140673.08,-1062.62 140669.58,-1052.62 140666.08,-1062.62 140673.08,-1062.62"/>
</g>
<!-- L15_S1_TP6_GPU14_attn_v&#45;&gt;L15_S1_TP3_GPU11_mha_ar -->
<g id="edge4568" class="edge">
<title>L15_S1_TP6_GPU14_attn_v&#45;&gt;L15_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M143788.5,-1116.43C143788.5,-1062.54 143788.5,-964 143788.5,-964 143788.5,-964 141443.82,-964 141443.82,-964 141443.82,-964 141443.82,-1003.84 141443.82,-1003.84"/>
<polygon fill="black" stroke="black" points="141440.32,-1003.84 141443.82,-1013.84 141447.32,-1003.84 141440.32,-1003.84"/>
</g>
<!-- L15_S1_TP6_GPU14_attn_v&#45;&gt;L15_S1_TP4_GPU12_mha_ar -->
<g id="edge4604" class="edge">
<title>L15_S1_TP6_GPU14_attn_v&#45;&gt;L15_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M143590.74,-1116.44C143590.74,-1100.93 143590.74,-1086 143590.74,-1086 143590.74,-1086 142026.92,-1086 142026.92,-1086 142026.92,-1086 142026.92,-1085.02 142026.92,-1085.02"/>
<polygon fill="black" stroke="black" points="142030.42,-1086.2 142026.92,-1076.2 142023.42,-1086.2 142030.42,-1086.2"/>
</g>
<!-- L15_S1_TP6_GPU14_attn_v&#45;&gt;L15_S1_TP5_GPU13_mha_ar -->
<g id="edge4640" class="edge">
<title>L15_S1_TP6_GPU14_attn_v&#45;&gt;L15_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M143637.92,-1116.44C143637.92,-1100.93 143637.92,-1086 143637.92,-1086 143637.92,-1086 142869.36,-1086 142869.36,-1086 142869.36,-1086 142869.36,-1080.26 142869.36,-1080.26"/>
<polygon fill="black" stroke="black" points="142872.86,-1080.26 142869.36,-1070.26 142865.86,-1080.26 142872.86,-1080.26"/>
</g>
<!-- L15_S1_TP6_GPU14_attn_v&#45;&gt;L15_S1_TP6_GPU14_mha_ar -->
<g id="edge4676" class="edge">
<title>L15_S1_TP6_GPU14_attn_v&#45;&gt;L15_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M143685.11,-1116.51C143685.11,-1116.51 143685.11,-1074.64 143685.11,-1074.64"/>
<polygon fill="black" stroke="black" points="143688.61,-1074.64 143685.11,-1064.64 143681.61,-1074.64 143688.61,-1074.64"/>
</g>
<!-- L15_S1_TP6_GPU14_attn_v&#45;&gt;L15_S1_TP7_GPU15_mha_ar -->
<g id="edge4712" class="edge">
<title>L15_S1_TP6_GPU14_attn_v&#45;&gt;L15_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M144272.19,-1116.51C144272.19,-1116.51 144272.19,-1088.96 144272.19,-1088.96"/>
<polygon fill="black" stroke="black" points="144275.69,-1088.96 144272.19,-1078.96 144268.69,-1088.96 144275.69,-1088.96"/>
</g>
<!-- L15_S1_TP7_GPU15_attn_v -->
<g id="node1583" class="node">
<title>L15_S1_TP7_GPU15_attn_v</title>
<polygon fill="none" stroke="black" points="145296,-1184.67 144358,-1184.67 144358,-1116.67 145296,-1116.67 145296,-1184.67"/>
<text text-anchor="middle" x="144827" y="-1169.47" font-family="Times,serif" font-size="14.00">Attn@V</text>
<text text-anchor="middle" x="144827" y="-1154.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="144827" y="-1139.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="144827" y="-1124.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L15_S1_TP7_GPU15_attn_v&#45;&gt;L15_S1_TP0_GPU8_mha_ar -->
<g id="edge4461" class="edge">
<title>L15_S1_TP7_GPU15_attn_v&#45;&gt;L15_S1_TP0_GPU8_mha_ar</title>
<path fill="none" stroke="black" d="M144385.21,-1116.44C144385.21,-1113.72 144385.21,-1112 144385.21,-1112 144385.21,-1112 139097.54,-1112 139097.54,-1112 139097.54,-1112 139097.54,-1070.36 139097.54,-1070.36"/>
<polygon fill="black" stroke="black" points="139101.04,-1070.36 139097.54,-1060.36 139094.04,-1070.36 139101.04,-1070.36"/>
</g>
<!-- L15_S1_TP7_GPU15_attn_v&#45;&gt;L15_S1_TP1_GPU9_mha_ar -->
<g id="edge4497" class="edge">
<title>L15_S1_TP7_GPU15_attn_v&#45;&gt;L15_S1_TP1_GPU9_mha_ar</title>
<path fill="none" stroke="black" d="M144412.42,-1116.44C144412.42,-1113.72 144412.42,-1112 144412.42,-1112 144412.42,-1112 139883.55,-1112 139883.55,-1112 139883.55,-1112 139883.55,-1066.84 139883.55,-1066.84"/>
<polygon fill="black" stroke="black" points="139887.05,-1066.84 139883.55,-1056.84 139880.05,-1066.84 139887.05,-1066.84"/>
</g>
<!-- L15_S1_TP7_GPU15_attn_v&#45;&gt;L15_S1_TP2_GPU10_mha_ar -->
<g id="edge4533" class="edge">
<title>L15_S1_TP7_GPU15_attn_v&#45;&gt;L15_S1_TP2_GPU10_mha_ar</title>
<path fill="none" stroke="black" d="M144366,-1184.92C144366,-1198.97 144366,-1212 144366,-1212 144366,-1212 140520.5,-1212 140520.5,-1212 140520.5,-1212 140520.5,-1084.2 140520.5,-1084.2"/>
<polygon fill="black" stroke="black" points="140524,-1084.2 140520.5,-1074.2 140517,-1084.2 140524,-1084.2"/>
</g>
<!-- L15_S1_TP7_GPU15_attn_v&#45;&gt;L15_S1_TP3_GPU11_mha_ar -->
<g id="edge4569" class="edge">
<title>L15_S1_TP7_GPU15_attn_v&#45;&gt;L15_S1_TP3_GPU11_mha_ar</title>
<path fill="none" stroke="black" d="M144584.49,-1116.43C144584.49,-1062.54 144584.49,-964 144584.49,-964 144584.49,-964 141415.16,-964 141415.16,-964 141415.16,-964 141415.16,-997.05 141415.16,-997.05"/>
<polygon fill="black" stroke="black" points="141411.66,-997.05 141415.16,-1007.05 141418.66,-997.05 141411.66,-997.05"/>
</g>
<!-- L15_S1_TP7_GPU15_attn_v&#45;&gt;L15_S1_TP4_GPU12_mha_ar -->
<g id="edge4605" class="edge">
<title>L15_S1_TP7_GPU15_attn_v&#45;&gt;L15_S1_TP4_GPU12_mha_ar</title>
<path fill="none" stroke="black" d="M144439.63,-1116.44C144439.63,-1100.93 144439.63,-1086 144439.63,-1086 144439.63,-1086 142134.2,-1086 142134.2,-1086 142134.2,-1086 142134.2,-1076.41 142134.2,-1076.41"/>
<polygon fill="black" stroke="black" points="142137.7,-1076.41 142134.2,-1066.41 142130.7,-1076.41 142137.7,-1076.41"/>
</g>
<!-- L15_S1_TP7_GPU15_attn_v&#45;&gt;L15_S1_TP5_GPU13_mha_ar -->
<g id="edge4641" class="edge">
<title>L15_S1_TP7_GPU15_attn_v&#45;&gt;L15_S1_TP5_GPU13_mha_ar</title>
<path fill="none" stroke="black" d="M144466.84,-1116.44C144466.84,-1100.93 144466.84,-1086 144466.84,-1086 144466.84,-1086 142939.91,-1086 142939.91,-1086 142939.91,-1086 142939.91,-1070.86 142939.91,-1070.86"/>
<polygon fill="black" stroke="black" points="142943.41,-1070.86 142939.91,-1060.86 142936.41,-1070.86 142943.41,-1070.86"/>
</g>
<!-- L15_S1_TP7_GPU15_attn_v&#45;&gt;L15_S1_TP6_GPU14_mha_ar -->
<g id="edge4677" class="edge">
<title>L15_S1_TP7_GPU15_attn_v&#45;&gt;L15_S1_TP6_GPU14_mha_ar</title>
<path fill="none" stroke="black" d="M144494.05,-1116.44C144494.05,-1100.93 144494.05,-1086 144494.05,-1086 144494.05,-1086 143732.29,-1086 143732.29,-1086 143732.29,-1086 143732.29,-1066.17 143732.29,-1066.17"/>
<polygon fill="black" stroke="black" points="143735.79,-1066.17 143732.29,-1056.17 143728.79,-1066.17 143735.79,-1066.17"/>
</g>
<!-- L15_S1_TP7_GPU15_attn_v&#45;&gt;L15_S1_TP7_GPU15_mha_ar -->
<g id="edge4713" class="edge">
<title>L15_S1_TP7_GPU15_attn_v&#45;&gt;L15_S1_TP7_GPU15_mha_ar</title>
<path fill="none" stroke="black" d="M144521.26,-1116.51C144521.26,-1116.51 144521.26,-1060.6 144521.26,-1060.6"/>
<polygon fill="black" stroke="black" points="144524.76,-1060.6 144521.26,-1050.6 144517.76,-1060.6 144524.76,-1060.6"/>
</g>
<!-- L15_S1_TP0_GPU8_gate -->
<g id="node1585" class="node">
<title>L15_S1_TP0_GPU8_gate</title>
<polygon fill="none" stroke="black" points="138238.56,-844.5 137396.15,-844.5 137179.44,-708.5 138021.85,-708.5 138238.56,-844.5"/>
<text text-anchor="middle" x="137709" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="137709" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="137709" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="137709" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L15_S1_TP0_GPU8_mha_res&#45;&gt;L15_S1_TP0_GPU8_gate -->
<g id="edge4463" class="edge">
<title>L15_S1_TP0_GPU8_mha_res&#45;&gt;L15_S1_TP0_GPU8_gate</title>
<path fill="none" stroke="black" d="M137709,-880.39C137709,-880.39 137709,-854.73 137709,-854.73"/>
<polygon fill="black" stroke="black" points="137712.5,-854.73 137709,-844.73 137705.5,-854.73 137712.5,-854.73"/>
</g>
<!-- L15_S1_TP0_GPU8_moe_res -->
<g id="node1603" class="node">
<title>L15_S1_TP0_GPU8_moe_res</title>
<polygon fill="none" stroke="black" points="138960,-436.33 138140,-436.33 138140,-368.33 138960,-368.33 138960,-436.33"/>
<text text-anchor="middle" x="138550" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="138550" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="138550" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="138550" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP0_GPU8_mha_res&#45;&gt;L15_S1_TP0_GPU8_moe_res -->
<g id="edge4483" class="edge">
<title>L15_S1_TP0_GPU8_mha_res&#45;&gt;L15_S1_TP0_GPU8_moe_res</title>
<path fill="none" stroke="black" d="M138152.57,-914C138209.27,-914 138248,-914 138248,-914 138248,-914 138248,-698 138248,-698 138248,-698 138213.5,-698 138213.5,-698 138213.5,-698 138213.5,-446.54 138213.5,-446.54"/>
<polygon fill="black" stroke="black" points="138217,-446.54 138213.5,-436.54 138210,-446.54 138217,-446.54"/>
</g>
<!-- L15_S1_TP0_GPU8_expert0 -->
<g id="node1586" class="node">
<title>L15_S1_TP0_GPU8_expert0</title>
<polygon fill="none" stroke="black" points="138204.5,-672.5 137755.5,-672.5 137755.5,-604.5 138204.5,-604.5 138204.5,-672.5"/>
<text text-anchor="middle" x="137980" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="137980" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="137980" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="137980" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L15_S1_TP0_GPU8_gate&#45;&gt;L15_S1_TP0_GPU8_expert0 -->
<g id="edge4464" class="edge">
<title>L15_S1_TP0_GPU8_gate&#45;&gt;L15_S1_TP0_GPU8_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M137980,-708.31C137980,-708.31 137980,-682.71 137980,-682.71"/>
<polygon fill="black" stroke="black" points="137983.5,-682.71 137980,-672.71 137976.5,-682.71 137983.5,-682.71"/>
</g>
<!-- L15_S1_TP0_GPU8_expert1 -->
<g id="node1587" class="node">
<title>L15_S1_TP0_GPU8_expert1</title>
<polygon fill="none" stroke="black" points="138671.5,-672.5 138222.5,-672.5 138222.5,-604.5 138671.5,-604.5 138671.5,-672.5"/>
<text text-anchor="middle" x="138447" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="138447" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="138447" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="138447" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- L15_S1_TP0_GPU8_gate&#45;&gt;L15_S1_TP0_GPU8_expert1 -->
<g id="edge4465" class="edge">
<title>L15_S1_TP0_GPU8_gate&#45;&gt;L15_S1_TP0_GPU8_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M138230.64,-776.4C138230.64,-776.4 138230.64,-682.74 138230.64,-682.74"/>
<polygon fill="black" stroke="black" points="138234.14,-682.74 138230.64,-672.74 138227.14,-682.74 138234.14,-682.74"/>
</g>
<!-- L15_S1_TP0_GPU8_moe_ar -->
<g id="node1588" class="node">
<title>L15_S1_TP0_GPU8_moe_ar</title>
<ellipse fill="none" stroke="black" cx="139078" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="139078" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="139078" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="139078" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="139078" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP0_GPU8_expert0&#45;&gt;L15_S1_TP0_GPU8_moe_ar -->
<g id="edge4466" class="edge">
<title>L15_S1_TP0_GPU8_expert0&#45;&gt;L15_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M138197.33,-604.35C138197.33,-559.95 138197.33,-488 138197.33,-488 138197.33,-488 138820.93,-488 138820.93,-488"/>
<polygon fill="black" stroke="black" points="138820.93,-491.5 138830.93,-488 138820.93,-484.5 138820.93,-491.5"/>
</g>
<!-- L15_S1_TP1_GPU9_moe_ar -->
<g id="node1612" class="node">
<title>L15_S1_TP1_GPU9_moe_ar</title>
<ellipse fill="none" stroke="black" cx="139765" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="139765" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="139765" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="139765" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="139765" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP0_GPU8_expert0&#45;&gt;L15_S1_TP1_GPU9_moe_ar -->
<g id="edge4502" class="edge">
<title>L15_S1_TP0_GPU8_expert0&#45;&gt;L15_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M138190.17,-604.32C138190.17,-598.35 138190.17,-594 138190.17,-594 138190.17,-594 139448.03,-594 139448.03,-594 139448.03,-594 139448.03,-546.02 139448.03,-546.02"/>
<polygon fill="black" stroke="black" points="139451.53,-546.02 139448.03,-536.02 139444.53,-546.02 139451.53,-546.02"/>
</g>
<!-- L15_S1_TP2_GPU10_moe_ar -->
<g id="node1622" class="node">
<title>L15_S1_TP2_GPU10_moe_ar</title>
<ellipse fill="none" stroke="black" cx="140452" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="140452" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="140452" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="140452" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="140452" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP0_GPU8_expert0&#45;&gt;L15_S1_TP2_GPU10_moe_ar -->
<g id="edge4538" class="edge">
<title>L15_S1_TP0_GPU8_expert0&#45;&gt;L15_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M138183,-604.08C138183,-552.21 138183,-460 138183,-460 138183,-460 140290.36,-460 140290.36,-460 140290.36,-460 140290.36,-468.13 140290.36,-468.13"/>
<polygon fill="black" stroke="black" points="140286.86,-468.13 140290.36,-478.13 140293.86,-468.13 140286.86,-468.13"/>
</g>
<!-- L15_S1_TP3_GPU11_moe_ar -->
<g id="node1632" class="node">
<title>L15_S1_TP3_GPU11_moe_ar</title>
<ellipse fill="none" stroke="black" cx="141139" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="141139" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="141139" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="141139" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="141139" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP0_GPU8_expert0&#45;&gt;L15_S1_TP3_GPU11_moe_ar -->
<g id="edge4574" class="edge">
<title>L15_S1_TP0_GPU8_expert0&#45;&gt;L15_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M138175.83,-604.08C138175.83,-552.21 138175.83,-460 138175.83,-460 138175.83,-460 140900.1,-460 140900.1,-460 140900.1,-460 140900.1,-476.68 140900.1,-476.68"/>
<polygon fill="black" stroke="black" points="140896.6,-476.68 140900.1,-486.68 140903.6,-476.68 140896.6,-476.68"/>
</g>
<!-- L15_S1_TP4_GPU12_moe_ar -->
<g id="node1642" class="node">
<title>L15_S1_TP4_GPU12_moe_ar</title>
<ellipse fill="none" stroke="black" cx="141826" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="141826" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="141826" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="141826" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="141826" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP0_GPU8_expert0&#45;&gt;L15_S1_TP4_GPU12_moe_ar -->
<g id="edge4610" class="edge">
<title>L15_S1_TP0_GPU8_expert0&#45;&gt;L15_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M138168.67,-604.08C138168.67,-552.21 138168.67,-460 138168.67,-460 138168.67,-460 141826.23,-460 141826.23,-460 141826.23,-460 141826.23,-462.23 141826.23,-462.23"/>
<polygon fill="black" stroke="black" points="141822.73,-462.23 141826.23,-472.23 141829.73,-462.23 141822.73,-462.23"/>
</g>
<!-- L15_S1_TP5_GPU13_moe_ar -->
<g id="node1652" class="node">
<title>L15_S1_TP5_GPU13_moe_ar</title>
<ellipse fill="none" stroke="black" cx="142513" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="142513" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="142513" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="142513" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="142513" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP0_GPU8_expert0&#45;&gt;L15_S1_TP5_GPU13_moe_ar -->
<g id="edge4646" class="edge">
<title>L15_S1_TP0_GPU8_expert0&#45;&gt;L15_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M138161.5,-604.31C138161.5,-552.23 138161.5,-459 138161.5,-459 138161.5,-459 142285.31,-459 142285.31,-459 142285.31,-459 142285.31,-475.05 142285.31,-475.05"/>
<polygon fill="black" stroke="black" points="142281.81,-475.05 142285.31,-485.05 142288.81,-475.05 142281.81,-475.05"/>
</g>
<!-- L15_S1_TP6_GPU14_moe_ar -->
<g id="node1662" class="node">
<title>L15_S1_TP6_GPU14_moe_ar</title>
<ellipse fill="none" stroke="black" cx="143200" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="143200" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="143200" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="143200" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="143200" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP0_GPU8_expert0&#45;&gt;L15_S1_TP6_GPU14_moe_ar -->
<g id="edge4682" class="edge">
<title>L15_S1_TP0_GPU8_expert0&#45;&gt;L15_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M138154.33,-604.31C138154.33,-552.23 138154.33,-459 138154.33,-459 138154.33,-459 143078.88,-459 143078.88,-459 143078.88,-459 143078.88,-465.46 143078.88,-465.46"/>
<polygon fill="black" stroke="black" points="143075.38,-465.46 143078.88,-475.46 143082.38,-465.46 143075.38,-465.46"/>
</g>
<!-- L15_S1_TP7_GPU15_moe_ar -->
<g id="node1672" class="node">
<title>L15_S1_TP7_GPU15_moe_ar</title>
<ellipse fill="none" stroke="black" cx="143887" cy="-520.42" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="143887" y="-539.22" font-family="Times,serif" font-size="14.00">MoE AllReduce</text>
<text text-anchor="middle" x="143887" y="-524.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096] (8×)</text>
<text text-anchor="middle" x="143887" y="-509.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="143887" y="-494.22" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP0_GPU8_expert0&#45;&gt;L15_S1_TP7_GPU15_moe_ar -->
<g id="edge4718" class="edge">
<title>L15_S1_TP0_GPU8_expert0&#45;&gt;L15_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M138147.17,-604.29C138147.17,-550.45 138147.17,-452 138147.17,-452 138147.17,-452 143842.85,-452 143842.85,-452 143842.85,-452 143842.85,-462.53 143842.85,-462.53"/>
<polygon fill="black" stroke="black" points="143839.35,-462.53 143842.85,-472.53 143846.35,-462.53 143839.35,-462.53"/>
</g>
<!-- L15_S1_TP0_GPU8_expert1&#45;&gt;L15_S1_TP0_GPU8_moe_ar -->
<g id="edge4467" class="edge">
<title>L15_S1_TP0_GPU8_expert1&#45;&gt;L15_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M138615.38,-604.21C138615.38,-564.36 138615.38,-504 138615.38,-504 138615.38,-504 138753.34,-504 138753.34,-504"/>
<polygon fill="black" stroke="black" points="138753.34,-507.5 138763.34,-504 138753.34,-500.5 138753.34,-507.5"/>
</g>
<!-- L15_S1_TP0_GPU8_expert1&#45;&gt;L15_S1_TP1_GPU9_moe_ar -->
<g id="edge4503" class="edge">
<title>L15_S1_TP0_GPU8_expert1&#45;&gt;L15_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M138278.62,-604.32C138278.62,-598.35 138278.62,-594 138278.62,-594 138278.62,-594 139465.53,-594 139465.53,-594 139465.53,-594 139465.53,-552.1 139465.53,-552.1"/>
<polygon fill="black" stroke="black" points="139469.03,-552.1 139465.53,-542.1 139462.03,-552.1 139469.03,-552.1"/>
</g>
<!-- L15_S1_TP0_GPU8_expert1&#45;&gt;L15_S1_TP2_GPU10_moe_ar -->
<g id="edge4539" class="edge">
<title>L15_S1_TP0_GPU8_expert1&#45;&gt;L15_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M138334.75,-604.32C138334.75,-598.35 138334.75,-594 138334.75,-594 138334.75,-594 140164.42,-594 140164.42,-594 140164.42,-594 140164.42,-555.33 140164.42,-555.33"/>
<polygon fill="black" stroke="black" points="140167.92,-555.33 140164.42,-545.33 140160.92,-555.33 140167.92,-555.33"/>
</g>
<!-- L15_S1_TP0_GPU8_expert1&#45;&gt;L15_S1_TP3_GPU11_moe_ar -->
<g id="edge4575" class="edge">
<title>L15_S1_TP0_GPU8_expert1&#45;&gt;L15_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M138464.36,-672.68C138464.36,-687.27 138464.36,-701 138464.36,-701 138464.36,-701 141015.5,-701 141015.5,-701 141015.5,-701 141015.5,-575.52 141015.5,-575.52"/>
<polygon fill="black" stroke="black" points="141019,-575.52 141015.5,-565.52 141012,-575.52 141019,-575.52"/>
</g>
<!-- L15_S1_TP0_GPU8_expert1&#45;&gt;L15_S1_TP4_GPU12_moe_ar -->
<g id="edge4611" class="edge">
<title>L15_S1_TP0_GPU8_expert1&#45;&gt;L15_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M138559.25,-604.21C138559.25,-554.16 138559.25,-467 138559.25,-467 138559.25,-467 141714.82,-467 141714.82,-467 141714.82,-467 141714.82,-467.79 141714.82,-467.79"/>
<polygon fill="black" stroke="black" points="141711.32,-464.88 141714.82,-474.88 141718.32,-464.88 141711.32,-464.88"/>
</g>
<!-- L15_S1_TP0_GPU8_expert1&#45;&gt;L15_S1_TP5_GPU13_moe_ar -->
<g id="edge4647" class="edge">
<title>L15_S1_TP0_GPU8_expert1&#45;&gt;L15_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M138503.12,-604.21C138503.12,-554.16 138503.12,-467 138503.12,-467 138503.12,-467 142258.62,-467 142258.62,-467 142258.62,-467 142258.62,-479.03 142258.62,-479.03"/>
<polygon fill="black" stroke="black" points="142255.12,-479.03 142258.62,-489.03 142262.12,-479.03 142255.12,-479.03"/>
</g>
<!-- L15_S1_TP0_GPU8_expert1&#45;&gt;L15_S1_TP6_GPU14_moe_ar -->
<g id="edge4683" class="edge">
<title>L15_S1_TP0_GPU8_expert1&#45;&gt;L15_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M138447,-604.21C138447,-554.16 138447,-467 138447,-467 138447,-467 143007.77,-467 143007.77,-467 143007.77,-467 143007.77,-471.03 143007.77,-471.03"/>
<polygon fill="black" stroke="black" points="143004.27,-471.03 143007.77,-481.03 143011.27,-471.03 143004.27,-471.03"/>
</g>
<!-- L15_S1_TP0_GPU8_expert1&#45;&gt;L15_S1_TP7_GPU15_moe_ar -->
<g id="edge4719" class="edge">
<title>L15_S1_TP0_GPU8_expert1&#45;&gt;L15_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M138390.88,-604.49C138390.88,-601.17 138390.88,-599 138390.88,-599 138390.88,-599 143580.98,-599 143580.98,-599 143580.98,-599 143580.98,-549.84 143580.98,-549.84"/>
<polygon fill="black" stroke="black" points="143584.48,-549.84 143580.98,-539.84 143577.48,-549.84 143584.48,-549.84"/>
</g>
<!-- L15_S1_TP0_GPU8_moe_ar&#45;&gt;L15_S1_TP0_GPU8_moe_res -->
<g id="edge4482" class="edge">
<title>L15_S1_TP0_GPU8_moe_ar&#45;&gt;L15_S1_TP0_GPU8_moe_res</title>
<path fill="none" stroke="black" d="M138851.77,-484.99C138851.77,-484.99 138851.77,-446.52 138851.77,-446.52"/>
<polygon fill="black" stroke="black" points="138855.27,-446.52 138851.77,-436.52 138848.27,-446.52 138855.27,-446.52"/>
</g>
<!-- L15_S1_TP1_GPU9_expert0 -->
<g id="node1589" class="node">
<title>L15_S1_TP1_GPU9_expert0</title>
<polygon fill="none" stroke="black" points="139138.5,-672.5 138689.5,-672.5 138689.5,-604.5 139138.5,-604.5 139138.5,-672.5"/>
<text text-anchor="middle" x="138914" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="138914" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="138914" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="138914" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L15_S1_TP1_GPU9_expert0&#45;&gt;L15_S1_TP0_GPU8_moe_ar -->
<g id="edge4468" class="edge">
<title>L15_S1_TP1_GPU9_expert0&#45;&gt;L15_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M138809.37,-604.34C138809.37,-604.34 138809.37,-559.3 138809.37,-559.3"/>
<polygon fill="black" stroke="black" points="138812.87,-559.3 138809.37,-549.3 138805.87,-559.3 138812.87,-559.3"/>
</g>
<!-- L15_S1_TP1_GPU9_expert0&#45;&gt;L15_S1_TP1_GPU9_moe_ar -->
<g id="edge4504" class="edge">
<title>L15_S1_TP1_GPU9_expert0&#45;&gt;L15_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M138875.19,-604.32C138875.19,-598.35 138875.19,-594 138875.19,-594 138875.19,-594 139483.03,-594 139483.03,-594 139483.03,-594 139483.03,-556.57 139483.03,-556.57"/>
<polygon fill="black" stroke="black" points="139486.53,-556.57 139483.03,-546.57 139479.53,-556.57 139486.53,-556.57"/>
</g>
<!-- L15_S1_TP1_GPU9_expert0&#45;&gt;L15_S1_TP2_GPU10_moe_ar -->
<g id="edge4540" class="edge">
<title>L15_S1_TP1_GPU9_expert0&#45;&gt;L15_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M138941.02,-604.32C138941.02,-598.35 138941.02,-594 138941.02,-594 138941.02,-594 140211.31,-594 140211.31,-594 140211.31,-594 140211.31,-564.19 140211.31,-564.19"/>
<polygon fill="black" stroke="black" points="140214.81,-564.19 140211.31,-554.19 140207.81,-564.19 140214.81,-564.19"/>
</g>
<!-- L15_S1_TP1_GPU9_expert0&#45;&gt;L15_S1_TP3_GPU11_moe_ar -->
<g id="edge4576" class="edge">
<title>L15_S1_TP1_GPU9_expert0&#45;&gt;L15_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M139006.85,-604.33C139006.85,-600.53 139006.85,-598 139006.85,-598 139006.85,-598 140829.78,-598 140829.78,-598 140829.78,-598 140829.78,-548.8 140829.78,-548.8"/>
<polygon fill="black" stroke="black" points="140833.28,-548.8 140829.78,-538.8 140826.28,-548.8 140833.28,-548.8"/>
</g>
<!-- L15_S1_TP1_GPU9_expert0&#45;&gt;L15_S1_TP4_GPU12_moe_ar -->
<g id="edge4612" class="edge">
<title>L15_S1_TP1_GPU9_expert0&#45;&gt;L15_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M138730.03,-604.21C138730.03,-554.16 138730.03,-467 138730.03,-467 138730.03,-467 141603.41,-467 141603.41,-467 141603.41,-467 141603.41,-474.49 141603.41,-474.49"/>
<polygon fill="black" stroke="black" points="141599.91,-474.49 141603.41,-484.49 141606.91,-474.49 141599.91,-474.49"/>
</g>
<!-- L15_S1_TP1_GPU9_expert0&#45;&gt;L15_S1_TP5_GPU13_moe_ar -->
<g id="edge4648" class="edge">
<title>L15_S1_TP1_GPU9_expert0&#45;&gt;L15_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M138716.52,-604.21C138716.52,-554.16 138716.52,-467 138716.52,-467 138716.52,-467 142231.92,-467 142231.92,-467 142231.92,-467 142231.92,-484.33 142231.92,-484.33"/>
<polygon fill="black" stroke="black" points="142228.42,-484.33 142231.92,-494.33 142235.42,-484.33 142228.42,-484.33"/>
</g>
<!-- L15_S1_TP1_GPU9_expert0&#45;&gt;L15_S1_TP6_GPU14_moe_ar -->
<g id="edge4684" class="edge">
<title>L15_S1_TP1_GPU9_expert0&#45;&gt;L15_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M138703.01,-604.21C138703.01,-554.16 138703.01,-467 138703.01,-467 138703.01,-467 142936.65,-467 142936.65,-467 142936.65,-467 142936.65,-480.58 142936.65,-480.58"/>
<polygon fill="black" stroke="black" points="142933.15,-480.58 142936.65,-490.58 142940.15,-480.58 142933.15,-480.58"/>
</g>
<!-- L15_S1_TP1_GPU9_expert0&#45;&gt;L15_S1_TP7_GPU15_moe_ar -->
<g id="edge4720" class="edge">
<title>L15_S1_TP1_GPU9_expert0&#45;&gt;L15_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M139072.67,-604.49C139072.67,-601.17 139072.67,-599 139072.67,-599 139072.67,-599 143609.42,-599 143609.42,-599 143609.42,-599 143609.42,-557.46 143609.42,-557.46"/>
<polygon fill="black" stroke="black" points="143612.92,-557.46 143609.42,-547.46 143605.92,-557.46 143612.92,-557.46"/>
</g>
<!-- L15_S1_TP1_GPU9_expert1 -->
<g id="node1590" class="node">
<title>L15_S1_TP1_GPU9_expert1</title>
<polygon fill="none" stroke="black" points="139605.5,-672.5 139156.5,-672.5 139156.5,-604.5 139605.5,-604.5 139605.5,-672.5"/>
<text text-anchor="middle" x="139381" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="139381" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="139381" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="139381" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L15_S1_TP1_GPU9_expert1&#45;&gt;L15_S1_TP0_GPU8_moe_ar -->
<g id="edge4469" class="edge">
<title>L15_S1_TP1_GPU9_expert1&#45;&gt;L15_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M139184.94,-604.34C139184.94,-604.34 139184.94,-576.36 139184.94,-576.36"/>
<polygon fill="black" stroke="black" points="139188.44,-576.36 139184.94,-566.36 139181.44,-576.36 139188.44,-576.36"/>
</g>
<!-- L15_S1_TP1_GPU9_expert1&#45;&gt;L15_S1_TP1_GPU9_moe_ar -->
<g id="edge4505" class="edge">
<title>L15_S1_TP1_GPU9_expert1&#45;&gt;L15_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M139500.52,-604.34C139500.52,-604.34 139500.52,-560.09 139500.52,-560.09"/>
<polygon fill="black" stroke="black" points="139504.02,-560.09 139500.52,-550.09 139497.02,-560.09 139504.02,-560.09"/>
</g>
<!-- L15_S1_TP1_GPU9_expert1&#45;&gt;L15_S1_TP2_GPU10_moe_ar -->
<g id="edge4541" class="edge">
<title>L15_S1_TP1_GPU9_expert1&#45;&gt;L15_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M139518.02,-604.32C139518.02,-598.35 139518.02,-594 139518.02,-594 139518.02,-594 140258.19,-594 140258.19,-594 140258.19,-594 140258.19,-569.79 140258.19,-569.79"/>
<polygon fill="black" stroke="black" points="140261.69,-569.79 140258.19,-559.79 140254.69,-569.79 140261.69,-569.79"/>
</g>
<!-- L15_S1_TP1_GPU9_expert1&#45;&gt;L15_S1_TP3_GPU11_moe_ar -->
<g id="edge4577" class="edge">
<title>L15_S1_TP1_GPU9_expert1&#45;&gt;L15_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M139535.52,-604.33C139535.52,-600.53 139535.52,-598 139535.52,-598 139535.52,-598 140855.03,-598 140855.03,-598 140855.03,-598 140855.03,-555.82 140855.03,-555.82"/>
<polygon fill="black" stroke="black" points="140858.53,-555.82 140855.03,-545.82 140851.53,-555.82 140858.53,-555.82"/>
</g>
<!-- L15_S1_TP1_GPU9_expert1&#45;&gt;L15_S1_TP4_GPU12_moe_ar -->
<g id="edge4613" class="edge">
<title>L15_S1_TP1_GPU9_expert1&#45;&gt;L15_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M139553.01,-604.33C139553.01,-600.53 139553.01,-598 139553.01,-598 139553.01,-598 141536.43,-598 141536.43,-598 141536.43,-598 141536.43,-554.54 141536.43,-554.54"/>
<polygon fill="black" stroke="black" points="141539.93,-554.54 141536.43,-544.54 141532.93,-554.54 141539.93,-554.54"/>
</g>
<!-- L15_S1_TP1_GPU9_expert1&#45;&gt;L15_S1_TP5_GPU13_moe_ar -->
<g id="edge4649" class="edge">
<title>L15_S1_TP1_GPU9_expert1&#45;&gt;L15_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M139424.51,-604.2C139424.51,-555.2 139424.51,-471 139424.51,-471 139424.51,-471 142205.23,-471 142205.23,-471 142205.23,-471 142205.23,-491.45 142205.23,-491.45"/>
<polygon fill="black" stroke="black" points="142201.73,-491.45 142205.23,-501.45 142208.73,-491.45 142201.73,-491.45"/>
</g>
<!-- L15_S1_TP1_GPU9_expert1&#45;&gt;L15_S1_TP6_GPU14_moe_ar -->
<g id="edge4685" class="edge">
<title>L15_S1_TP1_GPU9_expert1&#45;&gt;L15_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M139570.51,-604.49C139570.51,-601.17 139570.51,-599 139570.51,-599 139570.51,-599 143004.75,-599 143004.75,-599 143004.75,-599 143004.75,-569.71 143004.75,-569.71"/>
<polygon fill="black" stroke="black" points="143008.25,-569.71 143004.75,-559.71 143001.25,-569.71 143008.25,-569.71"/>
</g>
<!-- L15_S1_TP1_GPU9_expert1&#45;&gt;L15_S1_TP7_GPU15_moe_ar -->
<g id="edge4721" class="edge">
<title>L15_S1_TP1_GPU9_expert1&#45;&gt;L15_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M139588,-604.49C139588,-601.17 139588,-599 139588,-599 139588,-599 143637.86,-599 143637.86,-599 143637.86,-599 143637.86,-562.83 143637.86,-562.83"/>
<polygon fill="black" stroke="black" points="143641.36,-562.83 143637.86,-552.83 143634.36,-562.83 143641.36,-562.83"/>
</g>
<!-- L15_S1_TP2_GPU10_expert0 -->
<g id="node1591" class="node">
<title>L15_S1_TP2_GPU10_expert0</title>
<polygon fill="none" stroke="black" points="140072.5,-672.5 139623.5,-672.5 139623.5,-604.5 140072.5,-604.5 140072.5,-672.5"/>
<text text-anchor="middle" x="139848" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="139848" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="139848" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="139848" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L15_S1_TP2_GPU10_expert0&#45;&gt;L15_S1_TP0_GPU8_moe_ar -->
<g id="edge4470" class="edge">
<title>L15_S1_TP2_GPU10_expert0&#45;&gt;L15_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M139679.62,-603.88C139679.62,-603.31 139679.62,-603 139679.62,-603 139679.62,-603 139213.38,-603 139213.38,-603 139213.38,-603 139213.38,-574.61 139213.38,-574.61"/>
<polygon fill="black" stroke="black" points="139216.88,-574.61 139213.38,-564.61 139209.88,-574.61 139216.88,-574.61"/>
</g>
<!-- L15_S1_TP2_GPU10_expert0&#45;&gt;L15_S1_TP1_GPU9_moe_ar -->
<g id="edge4506" class="edge">
<title>L15_S1_TP2_GPU10_expert0&#45;&gt;L15_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M139735.75,-604.34C139735.75,-604.34 139735.75,-578.55 139735.75,-578.55"/>
<polygon fill="black" stroke="black" points="139739.25,-578.55 139735.75,-568.55 139732.25,-578.55 139739.25,-578.55"/>
</g>
<!-- L15_S1_TP2_GPU10_expert0&#45;&gt;L15_S1_TP2_GPU10_moe_ar -->
<g id="edge4542" class="edge">
<title>L15_S1_TP2_GPU10_expert0&#45;&gt;L15_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M139848,-604.32C139848,-598.35 139848,-594 139848,-594 139848,-594 140305.08,-594 140305.08,-594 140305.08,-594 140305.08,-573.65 140305.08,-573.65"/>
<polygon fill="black" stroke="black" points="140308.58,-573.65 140305.08,-563.65 140301.58,-573.65 140308.58,-573.65"/>
</g>
<!-- L15_S1_TP2_GPU10_expert0&#45;&gt;L15_S1_TP3_GPU11_moe_ar -->
<g id="edge4578" class="edge">
<title>L15_S1_TP2_GPU10_expert0&#45;&gt;L15_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M139904.12,-604.33C139904.12,-600.53 139904.12,-598 139904.12,-598 139904.12,-598 140880.27,-598 140880.27,-598 140880.27,-598 140880.27,-561.08 140880.27,-561.08"/>
<polygon fill="black" stroke="black" points="140883.77,-561.08 140880.27,-551.08 140876.77,-561.08 140883.77,-561.08"/>
</g>
<!-- L15_S1_TP2_GPU10_expert0&#45;&gt;L15_S1_TP4_GPU12_moe_ar -->
<g id="edge4614" class="edge">
<title>L15_S1_TP2_GPU10_expert0&#45;&gt;L15_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M139960.25,-604.33C139960.25,-600.53 139960.25,-598 139960.25,-598 139960.25,-598 141581.33,-598 141581.33,-598 141581.33,-598 141581.33,-563.32 141581.33,-563.32"/>
<polygon fill="black" stroke="black" points="141584.83,-563.32 141581.33,-553.32 141577.83,-563.32 141584.83,-563.32"/>
</g>
<!-- L15_S1_TP2_GPU10_expert0&#45;&gt;L15_S1_TP5_GPU13_moe_ar -->
<g id="edge4650" class="edge">
<title>L15_S1_TP2_GPU10_expert0&#45;&gt;L15_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M140016.38,-604.33C140016.38,-600.53 140016.38,-598 140016.38,-598 140016.38,-598 142203.98,-598 142203.98,-598 142203.98,-598 142203.98,-549.2 142203.98,-549.2"/>
<polygon fill="black" stroke="black" points="142207.48,-549.2 142203.98,-539.2 142200.48,-549.2 142207.48,-549.2"/>
</g>
<!-- L15_S1_TP2_GPU10_expert0&#45;&gt;L15_S1_TP6_GPU14_moe_ar -->
<g id="edge4686" class="edge">
<title>L15_S1_TP2_GPU10_expert0&#45;&gt;L15_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M139960.25,-672.78C139960.25,-679.75 139960.25,-685 139960.25,-685 139960.25,-685 142890.25,-685 142890.25,-685 142890.25,-685 142890.25,-548.66 142890.25,-548.66"/>
<polygon fill="black" stroke="black" points="142893.75,-548.66 142890.25,-538.66 142886.75,-548.66 142893.75,-548.66"/>
</g>
<!-- L15_S1_TP2_GPU10_expert0&#45;&gt;L15_S1_TP7_GPU15_moe_ar -->
<g id="edge4722" class="edge">
<title>L15_S1_TP2_GPU10_expert0&#45;&gt;L15_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M139848,-672.7C139848,-684.12 139848,-694 139848,-694 139848,-694 143822.9,-694 143822.9,-694 143822.9,-694 143822.9,-577.85 143822.9,-577.85"/>
<polygon fill="black" stroke="black" points="143826.4,-577.85 143822.9,-567.85 143819.4,-577.85 143826.4,-577.85"/>
</g>
<!-- L15_S1_TP2_GPU10_expert1 -->
<g id="node1592" class="node">
<title>L15_S1_TP2_GPU10_expert1</title>
<polygon fill="none" stroke="black" points="140539.5,-672.5 140090.5,-672.5 140090.5,-604.5 140539.5,-604.5 140539.5,-672.5"/>
<text text-anchor="middle" x="140315" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="140315" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="140315" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="140315" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L15_S1_TP2_GPU10_expert1&#45;&gt;L15_S1_TP0_GPU8_moe_ar -->
<g id="edge4471" class="edge">
<title>L15_S1_TP2_GPU10_expert1&#45;&gt;L15_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M140105.49,-604.49C140105.49,-601.17 140105.49,-599 140105.49,-599 140105.49,-599 139241.82,-599 139241.82,-599 139241.82,-599 139241.82,-572.47 139241.82,-572.47"/>
<polygon fill="black" stroke="black" points="139245.32,-572.47 139241.82,-562.47 139238.32,-572.47 139245.32,-572.47"/>
</g>
<!-- L15_S1_TP2_GPU10_expert1&#45;&gt;L15_S1_TP1_GPU9_moe_ar -->
<g id="edge4507" class="edge">
<title>L15_S1_TP2_GPU10_expert1&#45;&gt;L15_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M140094.98,-604.34C140094.98,-604.34 140094.98,-538.63 140094.98,-538.63"/>
<polygon fill="black" stroke="black" points="140098.48,-538.63 140094.98,-528.63 140091.48,-538.63 140098.48,-538.63"/>
</g>
<!-- L15_S1_TP2_GPU10_expert1&#45;&gt;L15_S1_TP2_GPU10_moe_ar -->
<g id="edge4543" class="edge">
<title>L15_S1_TP2_GPU10_expert1&#45;&gt;L15_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M140351.96,-604.34C140351.96,-604.34 140351.96,-576.36 140351.96,-576.36"/>
<polygon fill="black" stroke="black" points="140355.46,-576.36 140351.96,-566.36 140348.46,-576.36 140355.46,-576.36"/>
</g>
<!-- L15_S1_TP2_GPU10_expert1&#45;&gt;L15_S1_TP3_GPU11_moe_ar -->
<g id="edge4579" class="edge">
<title>L15_S1_TP2_GPU10_expert1&#45;&gt;L15_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M140398.85,-604.33C140398.85,-600.53 140398.85,-598 140398.85,-598 140398.85,-598 140905.52,-598 140905.52,-598 140905.52,-598 140905.52,-565.12 140905.52,-565.12"/>
<polygon fill="black" stroke="black" points="140909.02,-565.12 140905.52,-555.12 140902.02,-565.12 140909.02,-565.12"/>
</g>
<!-- L15_S1_TP2_GPU10_expert1&#45;&gt;L15_S1_TP4_GPU12_moe_ar -->
<g id="edge4615" class="edge">
<title>L15_S1_TP2_GPU10_expert1&#45;&gt;L15_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M140445.73,-604.33C140445.73,-600.53 140445.73,-598 140445.73,-598 140445.73,-598 141626.23,-598 141626.23,-598 141626.23,-598 141626.23,-569.21 141626.23,-569.21"/>
<polygon fill="black" stroke="black" points="141629.73,-569.21 141626.23,-559.21 141622.73,-569.21 141629.73,-569.21"/>
</g>
<!-- L15_S1_TP2_GPU10_expert1&#45;&gt;L15_S1_TP5_GPU13_moe_ar -->
<g id="edge4651" class="edge">
<title>L15_S1_TP2_GPU10_expert1&#45;&gt;L15_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M140492.62,-604.33C140492.62,-600.53 140492.62,-598 140492.62,-598 140492.62,-598 142229.42,-598 142229.42,-598 142229.42,-598 142229.42,-556.25 142229.42,-556.25"/>
<polygon fill="black" stroke="black" points="142232.92,-556.25 142229.42,-546.25 142225.92,-556.25 142232.92,-556.25"/>
</g>
<!-- L15_S1_TP2_GPU10_expert1&#45;&gt;L15_S1_TP6_GPU14_moe_ar -->
<g id="edge4687" class="edge">
<title>L15_S1_TP2_GPU10_expert1&#45;&gt;L15_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M140497.41,-672.52C140497.41,-679.1 140497.41,-684 140497.41,-684 140497.41,-684 142888,-684 142888,-684 142888,-684 142888,-547.92 142888,-547.92"/>
<polygon fill="black" stroke="black" points="142891.5,-547.92 142888,-537.92 142884.5,-547.92 142891.5,-547.92"/>
</g>
<!-- L15_S1_TP2_GPU10_expert1&#45;&gt;L15_S1_TP7_GPU15_moe_ar -->
<g id="edge4723" class="edge">
<title>L15_S1_TP2_GPU10_expert1&#45;&gt;L15_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M140455.31,-672.7C140455.31,-684.12 140455.31,-694 140455.31,-694 140455.31,-694 143819.3,-694 143819.3,-694 143819.3,-694 143819.3,-577.85 143819.3,-577.85"/>
<polygon fill="black" stroke="black" points="143822.8,-577.85 143819.3,-567.85 143815.8,-577.85 143822.8,-577.85"/>
</g>
<!-- L15_S1_TP3_GPU11_expert0 -->
<g id="node1593" class="node">
<title>L15_S1_TP3_GPU11_expert0</title>
<polygon fill="none" stroke="black" points="141006.5,-672.5 140557.5,-672.5 140557.5,-604.5 141006.5,-604.5 141006.5,-672.5"/>
<text text-anchor="middle" x="140782" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="140782" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="140782" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="140782" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L15_S1_TP3_GPU11_expert0&#45;&gt;L15_S1_TP0_GPU8_moe_ar -->
<g id="edge4472" class="edge">
<title>L15_S1_TP3_GPU11_expert0&#45;&gt;L15_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M140586.12,-604.49C140586.12,-601.17 140586.12,-599 140586.12,-599 140586.12,-599 139270.26,-599 139270.26,-599 139270.26,-599 139270.26,-570.17 139270.26,-570.17"/>
<polygon fill="black" stroke="black" points="139273.76,-570.17 139270.26,-560.17 139266.76,-570.17 139273.76,-570.17"/>
</g>
<!-- L15_S1_TP3_GPU11_expert0&#45;&gt;L15_S1_TP1_GPU9_moe_ar -->
<g id="edge4508" class="edge">
<title>L15_S1_TP3_GPU11_expert0&#45;&gt;L15_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M140614.74,-604.49C140614.74,-601.17 140614.74,-599 140614.74,-599 140614.74,-599 140086,-599 140086,-599 140086,-599 140086,-544.1 140086,-544.1"/>
<polygon fill="black" stroke="black" points="140089.5,-544.1 140086,-534.1 140082.5,-544.1 140089.5,-544.1"/>
</g>
<!-- L15_S1_TP3_GPU11_expert0&#45;&gt;L15_S1_TP2_GPU10_moe_ar -->
<g id="edge4544" class="edge">
<title>L15_S1_TP3_GPU11_expert0&#45;&gt;L15_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M140643.36,-604.34C140643.36,-604.34 140643.36,-569.91 140643.36,-569.91"/>
<polygon fill="black" stroke="black" points="140646.86,-569.91 140643.36,-559.91 140639.86,-569.91 140646.86,-569.91"/>
</g>
<!-- L15_S1_TP3_GPU11_expert0&#45;&gt;L15_S1_TP3_GPU11_moe_ar -->
<g id="edge4580" class="edge">
<title>L15_S1_TP3_GPU11_expert0&#45;&gt;L15_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M140930.76,-604.34C140930.76,-604.34 140930.76,-568.22 140930.76,-568.22"/>
<polygon fill="black" stroke="black" points="140934.26,-568.22 140930.76,-558.22 140927.26,-568.22 140934.26,-568.22"/>
</g>
<!-- L15_S1_TP3_GPU11_expert0&#45;&gt;L15_S1_TP4_GPU12_moe_ar -->
<g id="edge4616" class="edge">
<title>L15_S1_TP3_GPU11_expert0&#45;&gt;L15_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M140956.01,-604.33C140956.01,-600.53 140956.01,-598 140956.01,-598 140956.01,-598 141716.02,-598 141716.02,-598 141716.02,-598 141716.02,-576 141716.02,-576"/>
<polygon fill="black" stroke="black" points="141719.52,-576 141716.02,-566 141712.52,-576 141719.52,-576"/>
</g>
<!-- L15_S1_TP3_GPU11_expert0&#45;&gt;L15_S1_TP5_GPU13_moe_ar -->
<g id="edge4652" class="edge">
<title>L15_S1_TP3_GPU11_expert0&#45;&gt;L15_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M140981.25,-604.33C140981.25,-600.53 140981.25,-598 140981.25,-598 140981.25,-598 142254.86,-598 142254.86,-598 142254.86,-598 142254.86,-561.08 142254.86,-561.08"/>
<polygon fill="black" stroke="black" points="142258.36,-561.08 142254.86,-551.08 142251.36,-561.08 142258.36,-561.08"/>
</g>
<!-- L15_S1_TP3_GPU11_expert0&#45;&gt;L15_S1_TP6_GPU14_moe_ar -->
<g id="edge4688" class="edge">
<title>L15_S1_TP3_GPU11_expert0&#45;&gt;L15_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M140856.83,-672.52C140856.83,-679.1 140856.83,-684 140856.83,-684 140856.83,-684 142885.75,-684 142885.75,-684 142885.75,-684 142885.75,-547 142885.75,-547"/>
<polygon fill="black" stroke="black" points="142889.25,-547 142885.75,-537 142882.25,-547 142889.25,-547"/>
</g>
<!-- L15_S1_TP3_GPU11_expert0&#45;&gt;L15_S1_TP7_GPU15_moe_ar -->
<g id="edge4724" class="edge">
<title>L15_S1_TP3_GPU11_expert0&#45;&gt;L15_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M140795.5,-604.29C140795.5,-550.45 140795.5,-452 140795.5,-452 140795.5,-452 143697.69,-452 143697.69,-452 143697.69,-452 143697.69,-470.62 143697.69,-470.62"/>
<polygon fill="black" stroke="black" points="143694.19,-470.62 143697.69,-480.62 143701.19,-470.62 143694.19,-470.62"/>
</g>
<!-- L15_S1_TP3_GPU11_expert1 -->
<g id="node1594" class="node">
<title>L15_S1_TP3_GPU11_expert1</title>
<polygon fill="none" stroke="black" points="141473.5,-672.5 141024.5,-672.5 141024.5,-604.5 141473.5,-604.5 141473.5,-672.5"/>
<text text-anchor="middle" x="141249" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="141249" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="141249" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="141249" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L15_S1_TP3_GPU11_expert1&#45;&gt;L15_S1_TP0_GPU8_moe_ar -->
<g id="edge4473" class="edge">
<title>L15_S1_TP3_GPU11_expert1&#45;&gt;L15_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M141074.38,-604.49C141074.38,-601.17 141074.38,-599 141074.38,-599 141074.38,-599 139298.7,-599 139298.7,-599 139298.7,-599 139298.7,-566.95 139298.7,-566.95"/>
<polygon fill="black" stroke="black" points="139302.2,-566.95 139298.7,-556.95 139295.2,-566.95 139302.2,-566.95"/>
</g>
<!-- L15_S1_TP3_GPU11_expert1&#45;&gt;L15_S1_TP1_GPU9_moe_ar -->
<g id="edge4509" class="edge">
<title>L15_S1_TP3_GPU11_expert1&#45;&gt;L15_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M141124.27,-604.49C141124.27,-601.17 141124.27,-599 141124.27,-599 141124.27,-599 140088.25,-599 140088.25,-599 140088.25,-599 140088.25,-543.04 140088.25,-543.04"/>
<polygon fill="black" stroke="black" points="140091.75,-543.04 140088.25,-533.04 140084.75,-543.04 140091.75,-543.04"/>
</g>
<!-- L15_S1_TP3_GPU11_expert1&#45;&gt;L15_S1_TP2_GPU10_moe_ar -->
<g id="edge4545" class="edge">
<title>L15_S1_TP3_GPU11_expert1&#45;&gt;L15_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M141174.15,-604.49C141174.15,-601.17 141174.15,-599 141174.15,-599 141174.15,-599 140671.98,-599 140671.98,-599 140671.98,-599 140671.98,-566.95 140671.98,-566.95"/>
<polygon fill="black" stroke="black" points="140675.48,-566.95 140671.98,-556.95 140668.48,-566.95 140675.48,-566.95"/>
</g>
<!-- L15_S1_TP3_GPU11_expert1&#45;&gt;L15_S1_TP3_GPU11_moe_ar -->
<g id="edge4581" class="edge">
<title>L15_S1_TP3_GPU11_expert1&#45;&gt;L15_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M141224.04,-604.34C141224.04,-604.34 141224.04,-577.23 141224.04,-577.23"/>
<polygon fill="black" stroke="black" points="141227.54,-577.23 141224.04,-567.23 141220.54,-577.23 141227.54,-577.23"/>
</g>
<!-- L15_S1_TP3_GPU11_expert1&#45;&gt;L15_S1_TP4_GPU12_moe_ar -->
<g id="edge4617" class="edge">
<title>L15_S1_TP3_GPU11_expert1&#45;&gt;L15_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M141473.67,-627C141479.71,-627 141483.14,-627 141483.14,-627 141483.14,-627 141483.14,-504 141483.14,-504 141483.14,-504 141501.49,-504 141501.49,-504"/>
<polygon fill="black" stroke="black" points="141501.49,-507.5 141511.49,-504 141501.49,-500.5 141501.49,-507.5"/>
</g>
<!-- L15_S1_TP3_GPU11_expert1&#45;&gt;L15_S1_TP5_GPU13_moe_ar -->
<g id="edge4653" class="edge">
<title>L15_S1_TP3_GPU11_expert1&#45;&gt;L15_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M141273.92,-604.33C141273.92,-600.53 141273.92,-598 141273.92,-598 141273.92,-598 142280.3,-598 142280.3,-598 142280.3,-598 142280.3,-565.12 142280.3,-565.12"/>
<polygon fill="black" stroke="black" points="142283.8,-565.12 142280.3,-555.12 142276.8,-565.12 142283.8,-565.12"/>
</g>
<!-- L15_S1_TP3_GPU11_expert1&#45;&gt;L15_S1_TP6_GPU14_moe_ar -->
<g id="edge4689" class="edge">
<title>L15_S1_TP3_GPU11_expert1&#45;&gt;L15_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M141360.71,-672.52C141360.71,-679.1 141360.71,-684 141360.71,-684 141360.71,-684 142883.5,-684 142883.5,-684 142883.5,-684 142883.5,-546.1 142883.5,-546.1"/>
<polygon fill="black" stroke="black" points="142887,-546.1 142883.5,-536.1 142880,-546.1 142887,-546.1"/>
</g>
<!-- L15_S1_TP3_GPU11_expert1&#45;&gt;L15_S1_TP7_GPU15_moe_ar -->
<g id="edge4725" class="edge">
<title>L15_S1_TP3_GPU11_expert1&#45;&gt;L15_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M141248.64,-672.7C141248.64,-684.12 141248.64,-694 141248.64,-694 141248.64,-694 143815.7,-694 143815.7,-694 143815.7,-694 143815.7,-577.85 143815.7,-577.85"/>
<polygon fill="black" stroke="black" points="143819.2,-577.85 143815.7,-567.85 143812.2,-577.85 143819.2,-577.85"/>
</g>
<!-- L15_S1_TP4_GPU12_expert0 -->
<g id="node1595" class="node">
<title>L15_S1_TP4_GPU12_expert0</title>
<polygon fill="none" stroke="black" points="141940.5,-672.5 141491.5,-672.5 141491.5,-604.5 141940.5,-604.5 141940.5,-672.5"/>
<text text-anchor="middle" x="141716" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="141716" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="141716" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="141716" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L15_S1_TP4_GPU12_expert0&#45;&gt;L15_S1_TP0_GPU8_moe_ar -->
<g id="edge4474" class="edge">
<title>L15_S1_TP4_GPU12_expert0&#45;&gt;L15_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M141716,-672.67C141716,-684.57 141716,-695 141716,-695 141716,-695 139147.5,-695 139147.5,-695 139147.5,-695 139147.5,-577.66 139147.5,-577.66"/>
<polygon fill="black" stroke="black" points="139151,-577.66 139147.5,-567.66 139144,-577.66 139151,-577.66"/>
</g>
<!-- L15_S1_TP4_GPU12_expert0&#45;&gt;L15_S1_TP1_GPU9_moe_ar -->
<g id="edge4510" class="edge">
<title>L15_S1_TP4_GPU12_expert0&#45;&gt;L15_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M141603.75,-672.52C141603.75,-679.1 141603.75,-684 141603.75,-684 141603.75,-684 140081.5,-684 140081.5,-684 140081.5,-684 140081.5,-546.1 140081.5,-546.1"/>
<polygon fill="black" stroke="black" points="140085,-546.1 140081.5,-536.1 140078,-546.1 140085,-546.1"/>
</g>
<!-- L15_S1_TP4_GPU12_expert0&#45;&gt;L15_S1_TP2_GPU10_moe_ar -->
<g id="edge4546" class="edge">
<title>L15_S1_TP4_GPU12_expert0&#45;&gt;L15_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M141671.12,-604.33C141671.12,-600.53 141671.12,-598 141671.12,-598 141671.12,-598 140700.6,-598 140700.6,-598 140700.6,-598 140700.6,-562.87 140700.6,-562.87"/>
<polygon fill="black" stroke="black" points="140704.1,-562.87 140700.6,-552.87 140697.1,-562.87 140704.1,-562.87"/>
</g>
<!-- L15_S1_TP4_GPU12_expert0&#45;&gt;L15_S1_TP3_GPU11_moe_ar -->
<g id="edge4582" class="edge">
<title>L15_S1_TP4_GPU12_expert0&#45;&gt;L15_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M141491.26,-649C141484.65,-649 141480.86,-649 141480.86,-649 141480.86,-649 141480.86,-536 141480.86,-536 141480.86,-536 141465.44,-536 141465.44,-536"/>
<polygon fill="black" stroke="black" points="141465.44,-532.5 141455.44,-536 141465.44,-539.5 141465.44,-532.5"/>
</g>
<!-- L15_S1_TP4_GPU12_expert0&#45;&gt;L15_S1_TP4_GPU12_moe_ar -->
<g id="edge4618" class="edge">
<title>L15_S1_TP4_GPU12_expert0&#45;&gt;L15_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M141760.92,-604.34C141760.92,-604.34 141760.92,-577.67 141760.92,-577.67"/>
<polygon fill="black" stroke="black" points="141764.42,-577.67 141760.92,-567.67 141757.42,-577.67 141764.42,-577.67"/>
</g>
<!-- L15_S1_TP4_GPU12_expert0&#45;&gt;L15_S1_TP5_GPU13_moe_ar -->
<g id="edge4654" class="edge">
<title>L15_S1_TP4_GPU12_expert0&#45;&gt;L15_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M141805.81,-604.33C141805.81,-600.53 141805.81,-598 141805.81,-598 141805.81,-598 142305.74,-598 142305.74,-598 142305.74,-598 142305.74,-568.3 142305.74,-568.3"/>
<polygon fill="black" stroke="black" points="142309.24,-568.3 142305.74,-558.3 142302.24,-568.3 142309.24,-568.3"/>
</g>
<!-- L15_S1_TP4_GPU12_expert0&#45;&gt;L15_S1_TP6_GPU14_moe_ar -->
<g id="edge4690" class="edge">
<title>L15_S1_TP4_GPU12_expert0&#45;&gt;L15_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M141850.71,-604.33C141850.71,-600.53 141850.71,-598 141850.71,-598 141850.71,-598 142876.75,-598 142876.75,-598 142876.75,-598 142876.75,-542.88 142876.75,-542.88"/>
<polygon fill="black" stroke="black" points="142880.25,-542.88 142876.75,-532.88 142873.25,-542.88 142880.25,-542.88"/>
</g>
<!-- L15_S1_TP4_GPU12_expert0&#45;&gt;L15_S1_TP7_GPU15_moe_ar -->
<g id="edge4726" class="edge">
<title>L15_S1_TP4_GPU12_expert0&#45;&gt;L15_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M141895.6,-604.49C141895.6,-601.17 141895.6,-599 141895.6,-599 141895.6,-599 143666.3,-599 143666.3,-599 143666.3,-599 143666.3,-566.95 143666.3,-566.95"/>
<polygon fill="black" stroke="black" points="143669.8,-566.95 143666.3,-556.95 143662.8,-566.95 143669.8,-566.95"/>
</g>
<!-- L15_S1_TP4_GPU12_expert1 -->
<g id="node1596" class="node">
<title>L15_S1_TP4_GPU12_expert1</title>
<polygon fill="none" stroke="black" points="142407.5,-672.5 141958.5,-672.5 141958.5,-604.5 142407.5,-604.5 142407.5,-672.5"/>
<text text-anchor="middle" x="142183" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="142183" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="142183" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="142183" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L15_S1_TP4_GPU12_expert1&#45;&gt;L15_S1_TP0_GPU8_moe_ar -->
<g id="edge4475" class="edge">
<title>L15_S1_TP4_GPU12_expert1&#45;&gt;L15_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M142169.5,-604.2C142169.5,-554.67 142169.5,-469 142169.5,-469 142169.5,-469 139303.85,-469 139303.85,-469 139303.85,-469 139303.85,-474.71 139303.85,-474.71"/>
<polygon fill="black" stroke="black" points="139300.35,-474.71 139303.85,-484.71 139307.35,-474.71 139300.35,-474.71"/>
</g>
<!-- L15_S1_TP4_GPU12_expert1&#45;&gt;L15_S1_TP1_GPU9_moe_ar -->
<g id="edge4511" class="edge">
<title>L15_S1_TP4_GPU12_expert1&#45;&gt;L15_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M142108.17,-672.52C142108.17,-679.1 142108.17,-684 142108.17,-684 142108.17,-684 140079.25,-684 140079.25,-684 140079.25,-684 140079.25,-547 140079.25,-547"/>
<polygon fill="black" stroke="black" points="140082.75,-547 140079.25,-537 140075.75,-547 140082.75,-547"/>
</g>
<!-- L15_S1_TP4_GPU12_expert1&#45;&gt;L15_S1_TP2_GPU10_moe_ar -->
<g id="edge4547" class="edge">
<title>L15_S1_TP4_GPU12_expert1&#45;&gt;L15_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M141983.75,-604.33C141983.75,-600.53 141983.75,-598 141983.75,-598 141983.75,-598 140729.22,-598 140729.22,-598 140729.22,-598 140729.22,-557.55 140729.22,-557.55"/>
<polygon fill="black" stroke="black" points="140732.72,-557.55 140729.22,-547.55 140725.72,-557.55 140732.72,-557.55"/>
</g>
<!-- L15_S1_TP4_GPU12_expert1&#45;&gt;L15_S1_TP3_GPU11_moe_ar -->
<g id="edge4583" class="edge">
<title>L15_S1_TP4_GPU12_expert1&#45;&gt;L15_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M142008.99,-604.33C142008.99,-600.53 142008.99,-598 142008.99,-598 142008.99,-598 141323.81,-598 141323.81,-598 141323.81,-598 141323.81,-570.57 141323.81,-570.57"/>
<polygon fill="black" stroke="black" points="141327.31,-570.57 141323.81,-560.57 141320.31,-570.57 141327.31,-570.57"/>
</g>
<!-- L15_S1_TP4_GPU12_expert1&#45;&gt;L15_S1_TP4_GPU12_moe_ar -->
<g id="edge4619" class="edge">
<title>L15_S1_TP4_GPU12_expert1&#45;&gt;L15_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M142034.24,-604.34C142034.24,-604.34 142034.24,-568.22 142034.24,-568.22"/>
<polygon fill="black" stroke="black" points="142037.74,-568.22 142034.24,-558.22 142030.74,-568.22 142037.74,-568.22"/>
</g>
<!-- L15_S1_TP4_GPU12_expert1&#45;&gt;L15_S1_TP5_GPU13_moe_ar -->
<g id="edge4655" class="edge">
<title>L15_S1_TP4_GPU12_expert1&#45;&gt;L15_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M142331.18,-604.34C142331.18,-604.34 142331.18,-571.18 142331.18,-571.18"/>
<polygon fill="black" stroke="black" points="142334.68,-571.18 142331.18,-561.18 142327.68,-571.18 142334.68,-571.18"/>
</g>
<!-- L15_S1_TP4_GPU12_expert1&#45;&gt;L15_S1_TP6_GPU14_moe_ar -->
<g id="edge4691" class="edge">
<title>L15_S1_TP4_GPU12_expert1&#45;&gt;L15_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M142356.62,-604.49C142356.62,-601.17 142356.62,-599 142356.62,-599 142356.62,-599 142879,-599 142879,-599 142879,-599 142879,-544.1 142879,-544.1"/>
<polygon fill="black" stroke="black" points="142882.5,-544.1 142879,-534.1 142875.5,-544.1 142882.5,-544.1"/>
</g>
<!-- L15_S1_TP4_GPU12_expert1&#45;&gt;L15_S1_TP7_GPU15_moe_ar -->
<g id="edge4727" class="edge">
<title>L15_S1_TP4_GPU12_expert1&#45;&gt;L15_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M142382.06,-604.49C142382.06,-601.17 142382.06,-599 142382.06,-599 142382.06,-599 143694.74,-599 143694.74,-599 143694.74,-599 143694.74,-570.17 143694.74,-570.17"/>
<polygon fill="black" stroke="black" points="143698.24,-570.17 143694.74,-560.17 143691.24,-570.17 143698.24,-570.17"/>
</g>
<!-- L15_S1_TP5_GPU13_expert0 -->
<g id="node1597" class="node">
<title>L15_S1_TP5_GPU13_expert0</title>
<polygon fill="none" stroke="black" points="142874.5,-672.5 142425.5,-672.5 142425.5,-604.5 142874.5,-604.5 142874.5,-672.5"/>
<text text-anchor="middle" x="142650" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="142650" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="142650" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="142650" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L15_S1_TP5_GPU13_expert0&#45;&gt;L15_S1_TP0_GPU8_moe_ar -->
<g id="edge4476" class="edge">
<title>L15_S1_TP5_GPU13_expert0&#45;&gt;L15_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M142509.02,-672.67C142509.02,-684.57 142509.02,-695 142509.02,-695 142509.02,-695 139143,-695 139143,-695 139143,-695 139143,-577.66 139143,-577.66"/>
<polygon fill="black" stroke="black" points="139146.5,-577.66 139143,-567.66 139139.5,-577.66 139146.5,-577.66"/>
</g>
<!-- L15_S1_TP5_GPU13_expert0&#45;&gt;L15_S1_TP1_GPU9_moe_ar -->
<g id="edge4512" class="edge">
<title>L15_S1_TP5_GPU13_expert0&#45;&gt;L15_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M142467.26,-672.52C142467.26,-679.1 142467.26,-684 142467.26,-684 142467.26,-684 140077,-684 140077,-684 140077,-684 140077,-547.92 140077,-547.92"/>
<polygon fill="black" stroke="black" points="140080.5,-547.92 140077,-537.92 140073.5,-547.92 140080.5,-547.92"/>
</g>
<!-- L15_S1_TP5_GPU13_expert0&#45;&gt;L15_S1_TP2_GPU10_moe_ar -->
<g id="edge4548" class="edge">
<title>L15_S1_TP5_GPU13_expert0&#45;&gt;L15_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M142467.7,-604.33C142467.7,-600.53 142467.7,-598 142467.7,-598 142467.7,-598 140757.84,-598 140757.84,-598 140757.84,-598 140757.84,-549.99 140757.84,-549.99"/>
<polygon fill="black" stroke="black" points="140761.34,-549.99 140757.84,-539.99 140754.34,-549.99 140761.34,-549.99"/>
</g>
<!-- L15_S1_TP5_GPU13_expert0&#45;&gt;L15_S1_TP3_GPU11_moe_ar -->
<g id="edge4584" class="edge">
<title>L15_S1_TP5_GPU13_expert0&#45;&gt;L15_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M142509.89,-604.33C142509.89,-600.53 142509.89,-598 142509.89,-598 142509.89,-598 141373.69,-598 141373.69,-598 141373.69,-598 141373.69,-565.12 141373.69,-565.12"/>
<polygon fill="black" stroke="black" points="141377.19,-565.12 141373.69,-555.12 141370.19,-565.12 141377.19,-565.12"/>
</g>
<!-- L15_S1_TP5_GPU13_expert0&#45;&gt;L15_S1_TP4_GPU12_moe_ar -->
<g id="edge4620" class="edge">
<title>L15_S1_TP5_GPU13_expert0&#45;&gt;L15_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M142552.09,-604.33C142552.09,-600.53 142552.09,-598 142552.09,-598 142552.09,-598 142059.48,-598 142059.48,-598 142059.48,-598 142059.48,-565.12 142059.48,-565.12"/>
<polygon fill="black" stroke="black" points="142062.98,-565.12 142059.48,-555.12 142055.98,-565.12 142062.98,-565.12"/>
</g>
<!-- L15_S1_TP5_GPU13_expert0&#45;&gt;L15_S1_TP5_GPU13_moe_ar -->
<g id="edge4656" class="edge">
<title>L15_S1_TP5_GPU13_expert0&#45;&gt;L15_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M142594.28,-604.34C142594.28,-604.34 142594.28,-577.23 142594.28,-577.23"/>
<polygon fill="black" stroke="black" points="142597.78,-577.23 142594.28,-567.23 142590.78,-577.23 142597.78,-577.23"/>
</g>
<!-- L15_S1_TP5_GPU13_expert0&#45;&gt;L15_S1_TP6_GPU14_moe_ar -->
<g id="edge4692" class="edge">
<title>L15_S1_TP5_GPU13_expert0&#45;&gt;L15_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M142870.02,-604.34C142870.02,-604.34 142870.02,-538.63 142870.02,-538.63"/>
<polygon fill="black" stroke="black" points="142873.52,-538.63 142870.02,-528.63 142866.52,-538.63 142873.52,-538.63"/>
</g>
<!-- L15_S1_TP5_GPU13_expert0&#45;&gt;L15_S1_TP7_GPU15_moe_ar -->
<g id="edge4728" class="edge">
<title>L15_S1_TP5_GPU13_expert0&#45;&gt;L15_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M142853.49,-604.49C142853.49,-601.17 142853.49,-599 142853.49,-599 142853.49,-599 143723.18,-599 143723.18,-599 143723.18,-599 143723.18,-572.47 143723.18,-572.47"/>
<polygon fill="black" stroke="black" points="143726.68,-572.47 143723.18,-562.47 143719.68,-572.47 143726.68,-572.47"/>
</g>
<!-- L15_S1_TP5_GPU13_expert1 -->
<g id="node1598" class="node">
<title>L15_S1_TP5_GPU13_expert1</title>
<polygon fill="none" stroke="black" points="143341.5,-672.5 142892.5,-672.5 142892.5,-604.5 143341.5,-604.5 143341.5,-672.5"/>
<text text-anchor="middle" x="143117" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="143117" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="143117" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="143117" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L15_S1_TP5_GPU13_expert1&#45;&gt;L15_S1_TP0_GPU8_moe_ar -->
<g id="edge4477" class="edge">
<title>L15_S1_TP5_GPU13_expert1&#45;&gt;L15_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M142948.62,-604.49C142948.62,-601.17 142948.62,-599 142948.62,-599 142948.62,-599 139327.14,-599 139327.14,-599 139327.14,-599 139327.14,-562.83 139327.14,-562.83"/>
<polygon fill="black" stroke="black" points="139330.64,-562.83 139327.14,-552.83 139323.64,-562.83 139330.64,-562.83"/>
</g>
<!-- L15_S1_TP5_GPU13_expert1&#45;&gt;L15_S1_TP1_GPU9_moe_ar -->
<g id="edge4513" class="edge">
<title>L15_S1_TP5_GPU13_expert1&#45;&gt;L15_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M143117,-672.78C143117,-679.75 143117,-685 143117,-685 143117,-685 140074.75,-685 140074.75,-685 140074.75,-685 140074.75,-548.66 140074.75,-548.66"/>
<polygon fill="black" stroke="black" points="140078.25,-548.66 140074.75,-538.66 140071.25,-548.66 140078.25,-548.66"/>
</g>
<!-- L15_S1_TP5_GPU13_expert1&#45;&gt;L15_S1_TP2_GPU10_moe_ar -->
<g id="edge4549" class="edge">
<title>L15_S1_TP5_GPU13_expert1&#45;&gt;L15_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M143004.75,-672.78C143004.75,-679.75 143004.75,-685 143004.75,-685 143004.75,-685 140548.5,-685 140548.5,-685 140548.5,-685 140548.5,-576.7 140548.5,-576.7"/>
<polygon fill="black" stroke="black" points="140552,-576.7 140548.5,-566.7 140545,-576.7 140552,-576.7"/>
</g>
<!-- L15_S1_TP5_GPU13_expert1&#45;&gt;L15_S1_TP3_GPU11_moe_ar -->
<g id="edge4585" class="edge">
<title>L15_S1_TP5_GPU13_expert1&#45;&gt;L15_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M143060.88,-604.33C143060.88,-600.53 143060.88,-598 143060.88,-598 143060.88,-598 141423.58,-598 141423.58,-598 141423.58,-598 141423.58,-555.82 141423.58,-555.82"/>
<polygon fill="black" stroke="black" points="141427.08,-555.82 141423.58,-545.82 141420.08,-555.82 141427.08,-555.82"/>
</g>
<!-- L15_S1_TP5_GPU13_expert1&#45;&gt;L15_S1_TP4_GPU12_moe_ar -->
<g id="edge4621" class="edge">
<title>L15_S1_TP5_GPU13_expert1&#45;&gt;L15_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M143117,-604.33C143117,-600.53 143117,-598 143117,-598 143117,-598 142084.73,-598 142084.73,-598 142084.73,-598 142084.73,-561.08 142084.73,-561.08"/>
<polygon fill="black" stroke="black" points="142088.23,-561.08 142084.73,-551.08 142081.23,-561.08 142088.23,-561.08"/>
</g>
<!-- L15_S1_TP5_GPU13_expert1&#45;&gt;L15_S1_TP5_GPU13_moe_ar -->
<g id="edge4657" class="edge">
<title>L15_S1_TP5_GPU13_expert1&#45;&gt;L15_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M143173.12,-604.32C143173.12,-598.35 143173.12,-594 143173.12,-594 143173.12,-594 142636.48,-594 142636.48,-594 142636.48,-594 142636.48,-575.34 142636.48,-575.34"/>
<polygon fill="black" stroke="black" points="142639.98,-575.34 142636.48,-565.34 142632.98,-575.34 142639.98,-575.34"/>
</g>
<!-- L15_S1_TP5_GPU13_expert1&#45;&gt;L15_S1_TP6_GPU14_moe_ar -->
<g id="edge4693" class="edge">
<title>L15_S1_TP5_GPU13_expert1&#45;&gt;L15_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M143229.25,-604.34C143229.25,-604.34 143229.25,-578.55 143229.25,-578.55"/>
<polygon fill="black" stroke="black" points="143232.75,-578.55 143229.25,-568.55 143225.75,-578.55 143232.75,-578.55"/>
</g>
<!-- L15_S1_TP5_GPU13_expert1&#45;&gt;L15_S1_TP7_GPU15_moe_ar -->
<g id="edge4729" class="edge">
<title>L15_S1_TP5_GPU13_expert1&#45;&gt;L15_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M143285.38,-603.88C143285.38,-603.31 143285.38,-603 143285.38,-603 143285.38,-603 143751.62,-603 143751.62,-603 143751.62,-603 143751.62,-574.61 143751.62,-574.61"/>
<polygon fill="black" stroke="black" points="143755.12,-574.61 143751.62,-564.61 143748.12,-574.61 143755.12,-574.61"/>
</g>
<!-- L15_S1_TP6_GPU14_expert0 -->
<g id="node1599" class="node">
<title>L15_S1_TP6_GPU14_expert0</title>
<polygon fill="none" stroke="black" points="143808.5,-672.5 143359.5,-672.5 143359.5,-604.5 143808.5,-604.5 143808.5,-672.5"/>
<text text-anchor="middle" x="143584" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="143584" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="143584" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="143584" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L15_S1_TP6_GPU14_expert0&#45;&gt;L15_S1_TP0_GPU8_moe_ar -->
<g id="edge4478" class="edge">
<title>L15_S1_TP6_GPU14_expert0&#45;&gt;L15_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M143378.94,-604.49C143378.94,-601.17 143378.94,-599 143378.94,-599 143378.94,-599 139355.58,-599 139355.58,-599 139355.58,-599 139355.58,-557.46 139355.58,-557.46"/>
<polygon fill="black" stroke="black" points="139359.08,-557.46 139355.58,-547.46 139352.08,-557.46 139359.08,-557.46"/>
</g>
<!-- L15_S1_TP6_GPU14_expert0&#45;&gt;L15_S1_TP1_GPU9_moe_ar -->
<g id="edge4514" class="edge">
<title>L15_S1_TP6_GPU14_expert0&#45;&gt;L15_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M143398.38,-604.49C143398.38,-601.17 143398.38,-599 143398.38,-599 143398.38,-599 139791.88,-599 139791.88,-599 139791.88,-599 139791.88,-578.39 139791.88,-578.39"/>
<polygon fill="black" stroke="black" points="139795.38,-578.39 139791.88,-568.39 139788.38,-578.39 139795.38,-578.39"/>
</g>
<!-- L15_S1_TP6_GPU14_expert0&#45;&gt;L15_S1_TP2_GPU10_moe_ar -->
<g id="edge4550" class="edge">
<title>L15_S1_TP6_GPU14_expert0&#45;&gt;L15_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M143543.5,-604.29C143543.5,-550.45 143543.5,-452 143543.5,-452 143543.5,-452 140759.97,-452 140759.97,-452 140759.97,-452 140759.97,-491.36 140759.97,-491.36"/>
<polygon fill="black" stroke="black" points="140756.47,-491.36 140759.97,-501.36 140763.47,-491.36 140756.47,-491.36"/>
</g>
<!-- L15_S1_TP6_GPU14_expert0&#45;&gt;L15_S1_TP3_GPU11_moe_ar -->
<g id="edge4586" class="edge">
<title>L15_S1_TP6_GPU14_expert0&#45;&gt;L15_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M143538.98,-604.29C143538.98,-550.45 143538.98,-452 143538.98,-452 143538.98,-452 141377.9,-452 141377.9,-452 141377.9,-452 141377.9,-476.61 141377.9,-476.61"/>
<polygon fill="black" stroke="black" points="141374.4,-476.61 141377.9,-486.61 141381.4,-476.61 141374.4,-476.61"/>
</g>
<!-- L15_S1_TP6_GPU14_expert0&#45;&gt;L15_S1_TP4_GPU12_moe_ar -->
<g id="edge4622" class="edge">
<title>L15_S1_TP6_GPU14_expert0&#45;&gt;L15_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M143417.82,-604.33C143417.82,-600.53 143417.82,-598 143417.82,-598 143417.82,-598 142109.97,-598 142109.97,-598 142109.97,-598 142109.97,-555.82 142109.97,-555.82"/>
<polygon fill="black" stroke="black" points="142113.47,-555.82 142109.97,-545.82 142106.47,-555.82 142113.47,-555.82"/>
</g>
<!-- L15_S1_TP6_GPU14_expert0&#45;&gt;L15_S1_TP5_GPU13_moe_ar -->
<g id="edge4658" class="edge">
<title>L15_S1_TP6_GPU14_expert0&#45;&gt;L15_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M143437.26,-604.32C143437.26,-598.35 143437.26,-594 143437.26,-594 143437.26,-594 142678.68,-594 142678.68,-594 142678.68,-594 142678.68,-572.37 142678.68,-572.37"/>
<polygon fill="black" stroke="black" points="142682.18,-572.37 142678.68,-562.37 142675.18,-572.37 142682.18,-572.37"/>
</g>
<!-- L15_S1_TP6_GPU14_expert0&#45;&gt;L15_S1_TP6_GPU14_moe_ar -->
<g id="edge4694" class="edge">
<title>L15_S1_TP6_GPU14_expert0&#45;&gt;L15_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M143456.7,-604.34C143456.7,-604.34 143456.7,-561.27 143456.7,-561.27"/>
<polygon fill="black" stroke="black" points="143460.2,-561.27 143456.7,-551.27 143453.2,-561.27 143460.2,-561.27"/>
</g>
<!-- L15_S1_TP6_GPU14_expert0&#45;&gt;L15_S1_TP7_GPU15_moe_ar -->
<g id="edge4730" class="edge">
<title>L15_S1_TP6_GPU14_expert0&#45;&gt;L15_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M143780.06,-604.34C143780.06,-604.34 143780.06,-576.36 143780.06,-576.36"/>
<polygon fill="black" stroke="black" points="143783.56,-576.36 143780.06,-566.36 143776.56,-576.36 143783.56,-576.36"/>
</g>
<!-- L15_S1_TP6_GPU14_expert1 -->
<g id="node1600" class="node">
<title>L15_S1_TP6_GPU14_expert1</title>
<polygon fill="none" stroke="black" points="144275.5,-672.5 143826.5,-672.5 143826.5,-604.5 144275.5,-604.5 144275.5,-672.5"/>
<text text-anchor="middle" x="144051" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="144051" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="144051" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="144051" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L15_S1_TP6_GPU14_expert1&#45;&gt;L15_S1_TP0_GPU8_moe_ar -->
<g id="edge4479" class="edge">
<title>L15_S1_TP6_GPU14_expert1&#45;&gt;L15_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M143892.33,-604.49C143892.33,-601.17 143892.33,-599 143892.33,-599 143892.33,-599 139384.02,-599 139384.02,-599 139384.02,-599 139384.02,-549.84 139384.02,-549.84"/>
<polygon fill="black" stroke="black" points="139387.52,-549.84 139384.02,-539.84 139380.52,-549.84 139387.52,-549.84"/>
</g>
<!-- L15_S1_TP6_GPU14_expert1&#45;&gt;L15_S1_TP1_GPU9_moe_ar -->
<g id="edge4515" class="edge">
<title>L15_S1_TP6_GPU14_expert1&#45;&gt;L15_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M144261.99,-604.29C144261.99,-550.45 144261.99,-452 144261.99,-452 144261.99,-452 140028.6,-452 140028.6,-452 140028.6,-452 140028.6,-480.61 140028.6,-480.61"/>
<polygon fill="black" stroke="black" points="140025.1,-480.61 140028.6,-490.61 140032.1,-480.61 140025.1,-480.61"/>
</g>
<!-- L15_S1_TP6_GPU14_expert1&#45;&gt;L15_S1_TP2_GPU10_moe_ar -->
<g id="edge4551" class="edge">
<title>L15_S1_TP6_GPU14_expert1&#45;&gt;L15_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M144248.48,-604.29C144248.48,-550.45 144248.48,-452 144248.48,-452 144248.48,-452 140733.48,-452 140733.48,-452 140733.48,-452 140733.48,-484.16 140733.48,-484.16"/>
<polygon fill="black" stroke="black" points="140729.98,-484.16 140733.48,-494.16 140736.98,-484.16 140729.98,-484.16"/>
</g>
<!-- L15_S1_TP6_GPU14_expert1&#45;&gt;L15_S1_TP3_GPU11_moe_ar -->
<g id="edge4587" class="edge">
<title>L15_S1_TP6_GPU14_expert1&#45;&gt;L15_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M144234.97,-604.29C144234.97,-550.45 144234.97,-452 144234.97,-452 144234.97,-452 141282.34,-452 141282.34,-452 141282.34,-452 141282.34,-466.7 141282.34,-466.7"/>
<polygon fill="black" stroke="black" points="141278.84,-466.7 141282.34,-476.7 141285.84,-466.7 141278.84,-466.7"/>
</g>
<!-- L15_S1_TP6_GPU14_expert1&#45;&gt;L15_S1_TP4_GPU12_moe_ar -->
<g id="edge4623" class="edge">
<title>L15_S1_TP6_GPU14_expert1&#45;&gt;L15_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M143958.15,-604.33C143958.15,-600.53 143958.15,-598 143958.15,-598 143958.15,-598 142135.22,-598 142135.22,-598 142135.22,-598 142135.22,-548.8 142135.22,-548.8"/>
<polygon fill="black" stroke="black" points="142138.72,-548.8 142135.22,-538.8 142131.72,-548.8 142138.72,-548.8"/>
</g>
<!-- L15_S1_TP6_GPU14_expert1&#45;&gt;L15_S1_TP5_GPU13_moe_ar -->
<g id="edge4659" class="edge">
<title>L15_S1_TP6_GPU14_expert1&#45;&gt;L15_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M144023.98,-604.32C144023.98,-598.35 144023.98,-594 144023.98,-594 144023.98,-594 142720.87,-594 142720.87,-594 142720.87,-594 142720.87,-568.5 142720.87,-568.5"/>
<polygon fill="black" stroke="black" points="142724.37,-568.5 142720.87,-558.5 142717.37,-568.5 142724.37,-568.5"/>
</g>
<!-- L15_S1_TP6_GPU14_expert1&#45;&gt;L15_S1_TP6_GPU14_moe_ar -->
<g id="edge4695" class="edge">
<title>L15_S1_TP6_GPU14_expert1&#45;&gt;L15_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M144089.81,-604.32C144089.81,-598.35 144089.81,-594 144089.81,-594 144089.81,-594 143476.14,-594 143476.14,-594 143476.14,-594 143476.14,-557.82 143476.14,-557.82"/>
<polygon fill="black" stroke="black" points="143479.64,-557.82 143476.14,-547.82 143472.64,-557.82 143479.64,-557.82"/>
</g>
<!-- L15_S1_TP6_GPU14_expert1&#45;&gt;L15_S1_TP7_GPU15_moe_ar -->
<g id="edge4731" class="edge">
<title>L15_S1_TP6_GPU14_expert1&#45;&gt;L15_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M144155.63,-604.34C144155.63,-604.34 144155.63,-559.3 144155.63,-559.3"/>
<polygon fill="black" stroke="black" points="144159.13,-559.3 144155.63,-549.3 144152.13,-559.3 144159.13,-559.3"/>
</g>
<!-- L15_S1_TP7_GPU15_expert0 -->
<g id="node1601" class="node">
<title>L15_S1_TP7_GPU15_expert0</title>
<polygon fill="none" stroke="black" points="144742.5,-672.5 144293.5,-672.5 144293.5,-604.5 144742.5,-604.5 144742.5,-672.5"/>
<text text-anchor="middle" x="144518" y="-657.3" font-family="Times,serif" font-size="14.00">Expert0 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="144518" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="144518" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="144518" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L15_S1_TP7_GPU15_expert0&#45;&gt;L15_S1_TP0_GPU8_moe_ar -->
<g id="edge4480" class="edge">
<title>L15_S1_TP7_GPU15_expert0&#45;&gt;L15_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M144686.38,-604.11C144686.38,-549.98 144686.38,-451 144686.38,-451 144686.38,-451 139195.23,-451 139195.23,-451 139195.23,-451 139195.23,-465.28 139195.23,-465.28"/>
<polygon fill="black" stroke="black" points="139191.73,-465.28 139195.23,-475.28 139198.73,-465.28 139191.73,-465.28"/>
</g>
<!-- L15_S1_TP7_GPU15_expert0&#45;&gt;L15_S1_TP1_GPU9_moe_ar -->
<g id="edge4516" class="edge">
<title>L15_S1_TP7_GPU15_expert0&#45;&gt;L15_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M144630.25,-604.11C144630.25,-549.98 144630.25,-451 144630.25,-451 144630.25,-451 139957.73,-451 139957.73,-451 139957.73,-451 139957.73,-470.84 139957.73,-470.84"/>
<polygon fill="black" stroke="black" points="139954.23,-470.84 139957.73,-480.84 139961.23,-470.84 139954.23,-470.84"/>
</g>
<!-- L15_S1_TP7_GPU15_expert0&#45;&gt;L15_S1_TP2_GPU10_moe_ar -->
<g id="edge4552" class="edge">
<title>L15_S1_TP7_GPU15_expert0&#45;&gt;L15_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M144574.12,-604.11C144574.12,-549.98 144574.12,-451 144574.12,-451 144574.12,-451 140706.98,-451 140706.98,-451 140706.98,-451 140706.98,-478.96 140706.98,-478.96"/>
<polygon fill="black" stroke="black" points="140703.48,-478.96 140706.98,-488.96 140710.48,-478.96 140703.48,-478.96"/>
</g>
<!-- L15_S1_TP7_GPU15_expert0&#45;&gt;L15_S1_TP3_GPU11_moe_ar -->
<g id="edge4588" class="edge">
<title>L15_S1_TP7_GPU15_expert0&#45;&gt;L15_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M144518,-604.29C144518,-550.45 144518,-452 144518,-452 144518,-452 141186.78,-452 141186.78,-452 141186.78,-452 141186.78,-462.53 141186.78,-462.53"/>
<polygon fill="black" stroke="black" points="141183.28,-462.53 141186.78,-472.53 141190.28,-462.53 141183.28,-462.53"/>
</g>
<!-- L15_S1_TP7_GPU15_expert0&#45;&gt;L15_S1_TP4_GPU12_moe_ar -->
<g id="edge4624" class="edge">
<title>L15_S1_TP7_GPU15_expert0&#45;&gt;L15_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M144500.14,-672.85C144500.14,-687.81 144500.14,-702 144500.14,-702 144500.14,-702 141949.5,-702 141949.5,-702 141949.5,-702 141949.5,-575.3 141949.5,-575.3"/>
<polygon fill="black" stroke="black" points="141953,-575.3 141949.5,-565.3 141946,-575.3 141953,-575.3"/>
</g>
<!-- L15_S1_TP7_GPU15_expert0&#45;&gt;L15_S1_TP5_GPU13_moe_ar -->
<g id="edge4660" class="edge">
<title>L15_S1_TP7_GPU15_expert0&#45;&gt;L15_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M144349.62,-604.32C144349.62,-598.35 144349.62,-594 144349.62,-594 144349.62,-594 142763.07,-594 142763.07,-594 142763.07,-594 142763.07,-562.48 142763.07,-562.48"/>
<polygon fill="black" stroke="black" points="142766.57,-562.48 142763.07,-552.48 142759.57,-562.48 142766.57,-562.48"/>
</g>
<!-- L15_S1_TP7_GPU15_expert0&#45;&gt;L15_S1_TP6_GPU14_moe_ar -->
<g id="edge4696" class="edge">
<title>L15_S1_TP7_GPU15_expert0&#45;&gt;L15_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M144405.75,-604.32C144405.75,-598.35 144405.75,-594 144405.75,-594 144405.75,-594 143495.58,-594 143495.58,-594 143495.58,-594 143495.58,-553.3 143495.58,-553.3"/>
<polygon fill="black" stroke="black" points="143499.08,-553.3 143495.58,-543.3 143492.08,-553.3 143499.08,-553.3"/>
</g>
<!-- L15_S1_TP7_GPU15_expert0&#45;&gt;L15_S1_TP7_GPU15_moe_ar -->
<g id="edge4732" class="edge">
<title>L15_S1_TP7_GPU15_expert0&#45;&gt;L15_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M144461.88,-604.37C144461.88,-574.55 144461.88,-536 144461.88,-536 144461.88,-536 144213.45,-536 144213.45,-536"/>
<polygon fill="black" stroke="black" points="144213.45,-532.5 144203.45,-536 144213.45,-539.5 144213.45,-532.5"/>
</g>
<!-- L15_S1_TP7_GPU15_expert1 -->
<g id="node1602" class="node">
<title>L15_S1_TP7_GPU15_expert1</title>
<polygon fill="none" stroke="black" points="145209.5,-672.5 144760.5,-672.5 144760.5,-604.5 145209.5,-604.5 145209.5,-672.5"/>
<text text-anchor="middle" x="144985" y="-657.3" font-family="Times,serif" font-size="14.00">Expert1 MLP (4096&#45;&gt;16384&#45;&gt;4096)</text>
<text text-anchor="middle" x="144985" y="-642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="144985" y="-627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="144985" y="-612.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L15_S1_TP7_GPU15_expert1&#45;&gt;L15_S1_TP0_GPU8_moe_ar -->
<g id="edge4481" class="edge">
<title>L15_S1_TP7_GPU15_expert1&#45;&gt;L15_S1_TP0_GPU8_moe_ar</title>
<path fill="none" stroke="black" d="M144818.72,-604.11C144818.72,-549.98 144818.72,-451 144818.72,-451 144818.72,-451 139086.62,-451 139086.62,-451 139086.62,-451 139086.62,-462.2 139086.62,-462.2"/>
<polygon fill="black" stroke="black" points="139083.12,-462.2 139086.62,-472.2 139090.12,-462.2 139083.12,-462.2"/>
</g>
<!-- L15_S1_TP7_GPU15_expert1&#45;&gt;L15_S1_TP1_GPU9_moe_ar -->
<g id="edge4517" class="edge">
<title>L15_S1_TP7_GPU15_expert1&#45;&gt;L15_S1_TP1_GPU9_moe_ar</title>
<path fill="none" stroke="black" d="M144811.44,-604.11C144811.44,-549.98 144811.44,-451 144811.44,-451 144811.44,-451 139886.87,-451 139886.87,-451 139886.87,-451 139886.87,-465.28 139886.87,-465.28"/>
<polygon fill="black" stroke="black" points="139883.37,-465.28 139886.87,-475.28 139890.37,-465.28 139883.37,-465.28"/>
</g>
<!-- L15_S1_TP7_GPU15_expert1&#45;&gt;L15_S1_TP2_GPU10_moe_ar -->
<g id="edge4553" class="edge">
<title>L15_S1_TP7_GPU15_expert1&#45;&gt;L15_S1_TP2_GPU10_moe_ar</title>
<path fill="none" stroke="black" d="M144804.17,-604.11C144804.17,-549.98 144804.17,-451 144804.17,-451 144804.17,-451 140680.49,-451 140680.49,-451 140680.49,-451 140680.49,-475.3 140680.49,-475.3"/>
<polygon fill="black" stroke="black" points="140676.99,-475.3 140680.49,-485.3 140683.99,-475.3 140676.99,-475.3"/>
</g>
<!-- L15_S1_TP7_GPU15_expert1&#45;&gt;L15_S1_TP3_GPU11_moe_ar -->
<g id="edge4589" class="edge">
<title>L15_S1_TP7_GPU15_expert1&#45;&gt;L15_S1_TP3_GPU11_moe_ar</title>
<path fill="none" stroke="black" d="M144796.89,-604.11C144796.89,-549.98 144796.89,-451 144796.89,-451 144796.89,-451 141091.22,-451 141091.22,-451 141091.22,-451 141091.22,-462.58 141091.22,-462.58"/>
<polygon fill="black" stroke="black" points="141087.72,-462.58 141091.22,-472.58 141094.72,-462.58 141087.72,-462.58"/>
</g>
<!-- L15_S1_TP7_GPU15_expert1&#45;&gt;L15_S1_TP4_GPU12_moe_ar -->
<g id="edge4625" class="edge">
<title>L15_S1_TP7_GPU15_expert1&#45;&gt;L15_S1_TP4_GPU12_moe_ar</title>
<path fill="none" stroke="black" d="M144789.61,-604.2C144789.61,-555.2 144789.61,-471 144789.61,-471 144789.61,-471 142049.05,-471 142049.05,-471 142049.05,-471 142049.05,-474.5 142049.05,-474.5"/>
<polygon fill="black" stroke="black" points="142045.55,-474.5 142049.05,-484.5 142052.55,-474.5 142045.55,-474.5"/>
</g>
<!-- L15_S1_TP7_GPU15_expert1&#45;&gt;L15_S1_TP5_GPU13_moe_ar -->
<g id="edge4661" class="edge">
<title>L15_S1_TP7_GPU15_expert1&#45;&gt;L15_S1_TP5_GPU13_moe_ar</title>
<path fill="none" stroke="black" d="M144767.78,-604.32C144767.78,-598.35 144767.78,-594 144767.78,-594 144767.78,-594 142805.27,-594 142805.27,-594 142805.27,-594 142805.27,-554.1 142805.27,-554.1"/>
<polygon fill="black" stroke="black" points="142808.77,-554.1 142805.27,-544.1 142801.77,-554.1 142808.77,-554.1"/>
</g>
<!-- L15_S1_TP7_GPU15_expert1&#45;&gt;L15_S1_TP6_GPU14_moe_ar -->
<g id="edge4697" class="edge">
<title>L15_S1_TP7_GPU15_expert1&#45;&gt;L15_S1_TP6_GPU14_moe_ar</title>
<path fill="none" stroke="black" d="M144775.06,-604.32C144775.06,-598.35 144775.06,-594 144775.06,-594 144775.06,-594 143515.02,-594 143515.02,-594 143515.02,-594 143515.02,-546.75 143515.02,-546.75"/>
<polygon fill="black" stroke="black" points="143518.52,-546.75 143515.02,-536.75 143511.52,-546.75 143518.52,-546.75"/>
</g>
<!-- L15_S1_TP7_GPU15_expert1&#45;&gt;L15_S1_TP7_GPU15_moe_ar -->
<g id="edge4733" class="edge">
<title>L15_S1_TP7_GPU15_expert1&#45;&gt;L15_S1_TP7_GPU15_moe_ar</title>
<path fill="none" stroke="black" d="M144782.33,-604.21C144782.33,-564.36 144782.33,-504 144782.33,-504 144782.33,-504 144211.4,-504 144211.4,-504"/>
<polygon fill="black" stroke="black" points="144211.4,-500.5 144201.4,-504 144211.4,-507.5 144211.4,-500.5"/>
</g>
<!-- L15_S1_TP0_GPU8_norm -->
<g id="node1604" class="node">
<title>L15_S1_TP0_GPU8_norm</title>
<polygon fill="none" stroke="black" points="139007.5,-332.33 138558.5,-332.33 138558.5,-264.33 139007.5,-264.33 139007.5,-332.33"/>
<text text-anchor="middle" x="138783" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="138783" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="138783" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="138783" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP0_GPU8_moe_res&#45;&gt;L15_S1_TP0_GPU8_norm -->
<g id="edge4484" class="edge">
<title>L15_S1_TP0_GPU8_moe_res&#45;&gt;L15_S1_TP0_GPU8_norm</title>
<path fill="none" stroke="black" d="M138759.25,-368.28C138759.25,-368.28 138759.25,-342.46 138759.25,-342.46"/>
<polygon fill="black" stroke="black" points="138762.75,-342.46 138759.25,-332.46 138755.75,-342.46 138762.75,-342.46"/>
</g>
<!-- output -->
<g id="node1675" class="node">
<title>output</title>
<ellipse fill="none" stroke="black" cx="141483" cy="-180.25" rx="317.48" ry="48.17"/>
<text text-anchor="middle" x="141483" y="-199.05" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="141483" y="-184.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="141483" y="-169.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="141483" y="-154.05" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP0_GPU8_norm&#45;&gt;output -->
<g id="edge4737" class="edge">
<title>L15_S1_TP0_GPU8_norm&#45;&gt;output</title>
<path fill="none" stroke="black" d="M138783,-264.19C138783,-243.86 138783,-222 138783,-222 138783,-222 141315.18,-222 141315.18,-222"/>
<polygon fill="black" stroke="black" points="141315.18,-225.5 141325.18,-222 141315.18,-218.5 141315.18,-225.5"/>
</g>
<!-- L15_S1_TP1_GPU9_qkv_linear -->
<g id="node1605" class="node">
<title>L15_S1_TP1_GPU9_qkv_linear</title>
<polygon fill="none" stroke="black" points="139200,-1614.75 138592,-1614.75 138592,-1546.75 139200,-1546.75 139200,-1614.75"/>
<text text-anchor="middle" x="138896" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="138896" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="138896" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="138896" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L15_S1_TP1_GPU9_qkv_slice -->
<g id="node1606" class="node">
<title>L15_S1_TP1_GPU9_qkv_slice</title>
<polygon fill="none" stroke="black" points="139194,-1496.67 138598,-1496.67 138598,-1428.67 139194,-1428.67 139194,-1496.67"/>
<text text-anchor="middle" x="138896" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="138896" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="138896" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="138896" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L15_S1_TP1_GPU9_qkv_linear&#45;&gt;L15_S1_TP1_GPU9_qkv_slice -->
<g id="edge4485" class="edge">
<title>L15_S1_TP1_GPU9_qkv_linear&#45;&gt;L15_S1_TP1_GPU9_qkv_slice</title>
<path fill="none" stroke="black" d="M138896,-1546.59C138896,-1546.59 138896,-1506.74 138896,-1506.74"/>
<polygon fill="black" stroke="black" points="138899.5,-1506.74 138896,-1496.74 138892.5,-1506.74 138899.5,-1506.74"/>
</g>
<!-- L15_S1_TP1_GPU9_qkv_slice&#45;&gt;L15_S1_TP1_GPU9_attn_v -->
<g id="edge4489" class="edge">
<title>L15_S1_TP1_GPU9_qkv_slice&#45;&gt;L15_S1_TP1_GPU9_attn_v</title>
<path fill="none" stroke="black" d="M138649.25,-1428.38C138649.25,-1428.38 138649.25,-1195 138649.25,-1195"/>
<polygon fill="black" stroke="black" points="138652.75,-1195 138649.25,-1185 138645.75,-1195 138652.75,-1195"/>
</g>
<!-- L15_S1_TP1_GPU9_qk_matmul -->
<g id="node1607" class="node">
<title>L15_S1_TP1_GPU9_qk_matmul</title>
<polygon fill="none" stroke="black" points="139611.5,-1392.67 138676.5,-1392.67 138676.5,-1324.67 139611.5,-1324.67 139611.5,-1392.67"/>
<text text-anchor="middle" x="139144" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="139144" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="139144" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="139144" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L15_S1_TP1_GPU9_qkv_slice&#45;&gt;L15_S1_TP1_GPU9_qk_matmul -->
<g id="edge4486" class="edge">
<title>L15_S1_TP1_GPU9_qkv_slice&#45;&gt;L15_S1_TP1_GPU9_qk_matmul</title>
<path fill="none" stroke="black" d="M138935.25,-1428.61C138935.25,-1428.61 138935.25,-1402.8 138935.25,-1402.8"/>
<polygon fill="black" stroke="black" points="138938.75,-1402.8 138935.25,-1392.8 138931.75,-1402.8 138938.75,-1402.8"/>
</g>
<!-- L15_S1_TP1_GPU9_softmax -->
<g id="node1608" class="node">
<title>L15_S1_TP1_GPU9_softmax</title>
<polygon fill="none" stroke="black" points="139372,-1288.67 138862,-1288.67 138862,-1220.67 139372,-1220.67 139372,-1288.67"/>
<text text-anchor="middle" x="139117" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="139117" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="139117" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="139117" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L15_S1_TP1_GPU9_qk_matmul&#45;&gt;L15_S1_TP1_GPU9_softmax -->
<g id="edge4487" class="edge">
<title>L15_S1_TP1_GPU9_qk_matmul&#45;&gt;L15_S1_TP1_GPU9_softmax</title>
<path fill="none" stroke="black" d="M139117,-1324.61C139117,-1324.61 139117,-1298.8 139117,-1298.8"/>
<polygon fill="black" stroke="black" points="139120.5,-1298.8 139117,-1288.8 139113.5,-1298.8 139120.5,-1298.8"/>
</g>
<!-- L15_S1_TP1_GPU9_softmax&#45;&gt;L15_S1_TP1_GPU9_attn_v -->
<g id="edge4488" class="edge">
<title>L15_S1_TP1_GPU9_softmax&#45;&gt;L15_S1_TP1_GPU9_attn_v</title>
<path fill="none" stroke="black" d="M139117,-1220.61C139117,-1220.61 139117,-1194.8 139117,-1194.8"/>
<polygon fill="black" stroke="black" points="139120.5,-1194.8 139117,-1184.8 139113.5,-1194.8 139120.5,-1194.8"/>
</g>
<!-- L15_S1_TP1_GPU9_mha_res -->
<g id="node1610" class="node">
<title>L15_S1_TP1_GPU9_mha_res</title>
<polygon fill="none" stroke="black" points="139230.5,-948.5 138343.5,-948.5 138343.5,-880.5 139230.5,-880.5 139230.5,-948.5"/>
<text text-anchor="middle" x="138787" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="138787" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="138787" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="138787" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP1_GPU9_mha_ar&#45;&gt;L15_S1_TP1_GPU9_mha_res -->
<g id="edge4498" class="edge">
<title>L15_S1_TP1_GPU9_mha_ar&#45;&gt;L15_S1_TP1_GPU9_mha_res</title>
<path fill="none" stroke="black" d="M139207.01,-1015.66C139207.01,-1015.66 139207.01,-958.91 139207.01,-958.91"/>
<polygon fill="black" stroke="black" points="139210.51,-958.91 139207.01,-948.91 139203.51,-958.91 139210.51,-958.91"/>
</g>
<!-- L15_S1_TP1_GPU9_gate -->
<g id="node1611" class="node">
<title>L15_S1_TP1_GPU9_gate</title>
<polygon fill="none" stroke="black" points="139316.56,-844.5 138474.15,-844.5 138257.44,-708.5 139099.85,-708.5 139316.56,-844.5"/>
<text text-anchor="middle" x="138787" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="138787" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="138787" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="138787" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- L15_S1_TP1_GPU9_mha_res&#45;&gt;L15_S1_TP1_GPU9_gate -->
<g id="edge4499" class="edge">
<title>L15_S1_TP1_GPU9_mha_res&#45;&gt;L15_S1_TP1_GPU9_gate</title>
<path fill="none" stroke="black" d="M138787,-880.39C138787,-880.39 138787,-854.73 138787,-854.73"/>
<polygon fill="black" stroke="black" points="138790.5,-854.73 138787,-844.73 138783.5,-854.73 138790.5,-854.73"/>
</g>
<!-- L15_S1_TP1_GPU9_moe_res -->
<g id="node1613" class="node">
<title>L15_S1_TP1_GPU9_moe_res</title>
<polygon fill="none" stroke="black" points="139798,-436.33 138978,-436.33 138978,-368.33 139798,-368.33 139798,-436.33"/>
<text text-anchor="middle" x="139388" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="139388" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="139388" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="139388" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP1_GPU9_mha_res&#45;&gt;L15_S1_TP1_GPU9_moe_res -->
<g id="edge4519" class="edge">
<title>L15_S1_TP1_GPU9_mha_res&#45;&gt;L15_S1_TP1_GPU9_moe_res</title>
<path fill="none" stroke="black" d="M139230.57,-914C139287.27,-914 139326,-914 139326,-914 139326,-914 139326,-695 139326,-695 139326,-695 139152,-695 139152,-695 139152,-695 139152,-604 139152,-604 139152,-604 139418.49,-604 139418.49,-604 139418.49,-604 139418.49,-446.54 139418.49,-446.54"/>
<polygon fill="black" stroke="black" points="139421.99,-446.54 139418.49,-436.54 139414.99,-446.54 139421.99,-446.54"/>
</g>
<!-- L15_S1_TP1_GPU9_gate&#45;&gt;L15_S1_TP1_GPU9_expert0 -->
<g id="edge4500" class="edge">
<title>L15_S1_TP1_GPU9_gate&#45;&gt;L15_S1_TP1_GPU9_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M138914,-708.31C138914,-708.31 138914,-682.71 138914,-682.71"/>
<polygon fill="black" stroke="black" points="138917.5,-682.71 138914,-672.71 138910.5,-682.71 138917.5,-682.71"/>
</g>
<!-- L15_S1_TP1_GPU9_gate&#45;&gt;L15_S1_TP1_GPU9_expert1 -->
<g id="edge4501" class="edge">
<title>L15_S1_TP1_GPU9_gate&#45;&gt;L15_S1_TP1_GPU9_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M139236.64,-776.4C139236.64,-776.4 139236.64,-682.74 139236.64,-682.74"/>
<polygon fill="black" stroke="black" points="139240.14,-682.74 139236.64,-672.74 139233.14,-682.74 139240.14,-682.74"/>
</g>
<!-- L15_S1_TP1_GPU9_moe_ar&#45;&gt;L15_S1_TP1_GPU9_moe_res -->
<g id="edge4518" class="edge">
<title>L15_S1_TP1_GPU9_moe_ar&#45;&gt;L15_S1_TP1_GPU9_moe_res</title>
<path fill="none" stroke="black" d="M139614.27,-477.45C139614.27,-477.45 139614.27,-446.57 139614.27,-446.57"/>
<polygon fill="black" stroke="black" points="139617.77,-446.57 139614.27,-436.57 139610.77,-446.57 139617.77,-446.57"/>
</g>
<!-- L15_S1_TP1_GPU9_norm -->
<g id="node1614" class="node">
<title>L15_S1_TP1_GPU9_norm</title>
<polygon fill="none" stroke="black" points="140030.5,-332.33 139581.5,-332.33 139581.5,-264.33 140030.5,-264.33 140030.5,-332.33"/>
<text text-anchor="middle" x="139806" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="139806" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="139806" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="139806" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP1_GPU9_moe_res&#45;&gt;L15_S1_TP1_GPU9_norm -->
<g id="edge4520" class="edge">
<title>L15_S1_TP1_GPU9_moe_res&#45;&gt;L15_S1_TP1_GPU9_norm</title>
<path fill="none" stroke="black" d="M139689.75,-368.28C139689.75,-368.28 139689.75,-342.46 139689.75,-342.46"/>
<polygon fill="black" stroke="black" points="139693.25,-342.46 139689.75,-332.46 139686.25,-342.46 139693.25,-342.46"/>
</g>
<!-- L15_S1_TP1_GPU9_norm&#45;&gt;output -->
<g id="edge4738" class="edge">
<title>L15_S1_TP1_GPU9_norm&#45;&gt;output</title>
<path fill="none" stroke="black" d="M139806,-264.21C139806,-244.67 139806,-224 139806,-224 139806,-224 141341.06,-224 141341.06,-224"/>
<polygon fill="black" stroke="black" points="141341.06,-227.5 141351.06,-224 141341.06,-220.5 141341.06,-227.5"/>
</g>
<!-- L15_S1_TP2_GPU10_qkv_linear -->
<g id="node1615" class="node">
<title>L15_S1_TP2_GPU10_qkv_linear</title>
<polygon fill="none" stroke="black" points="140286,-1614.75 139678,-1614.75 139678,-1546.75 140286,-1546.75 140286,-1614.75"/>
<text text-anchor="middle" x="139982" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="139982" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="139982" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="139982" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L15_S1_TP2_GPU10_qkv_slice -->
<g id="node1616" class="node">
<title>L15_S1_TP2_GPU10_qkv_slice</title>
<polygon fill="none" stroke="black" points="140280,-1496.67 139684,-1496.67 139684,-1428.67 140280,-1428.67 140280,-1496.67"/>
<text text-anchor="middle" x="139982" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="139982" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="139982" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="139982" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L15_S1_TP2_GPU10_qkv_linear&#45;&gt;L15_S1_TP2_GPU10_qkv_slice -->
<g id="edge4521" class="edge">
<title>L15_S1_TP2_GPU10_qkv_linear&#45;&gt;L15_S1_TP2_GPU10_qkv_slice</title>
<path fill="none" stroke="black" d="M139982,-1546.59C139982,-1546.59 139982,-1506.74 139982,-1506.74"/>
<polygon fill="black" stroke="black" points="139985.5,-1506.74 139982,-1496.74 139978.5,-1506.74 139985.5,-1506.74"/>
</g>
<!-- L15_S1_TP2_GPU10_qkv_slice&#45;&gt;L15_S1_TP2_GPU10_attn_v -->
<g id="edge4525" class="edge">
<title>L15_S1_TP2_GPU10_qkv_slice&#45;&gt;L15_S1_TP2_GPU10_attn_v</title>
<path fill="none" stroke="black" d="M139683.75,-1462C139657.43,-1462 139640.5,-1462 139640.5,-1462 139640.5,-1462 139640.5,-1194.87 139640.5,-1194.87"/>
<polygon fill="black" stroke="black" points="139644,-1194.87 139640.5,-1184.87 139637,-1194.87 139644,-1194.87"/>
</g>
<!-- L15_S1_TP2_GPU10_qk_matmul -->
<g id="node1617" class="node">
<title>L15_S1_TP2_GPU10_qk_matmul</title>
<polygon fill="none" stroke="black" points="140604.5,-1392.67 139669.5,-1392.67 139669.5,-1324.67 140604.5,-1324.67 140604.5,-1392.67"/>
<text text-anchor="middle" x="140137" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="140137" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="140137" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="140137" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L15_S1_TP2_GPU10_qkv_slice&#45;&gt;L15_S1_TP2_GPU10_qk_matmul -->
<g id="edge4522" class="edge">
<title>L15_S1_TP2_GPU10_qkv_slice&#45;&gt;L15_S1_TP2_GPU10_qk_matmul</title>
<path fill="none" stroke="black" d="M139982,-1428.61C139982,-1428.61 139982,-1402.8 139982,-1402.8"/>
<polygon fill="black" stroke="black" points="139985.5,-1402.8 139982,-1392.8 139978.5,-1402.8 139985.5,-1402.8"/>
</g>
<!-- L15_S1_TP2_GPU10_softmax -->
<g id="node1618" class="node">
<title>L15_S1_TP2_GPU10_softmax</title>
<polygon fill="none" stroke="black" points="140347,-1288.67 139837,-1288.67 139837,-1220.67 140347,-1220.67 140347,-1288.67"/>
<text text-anchor="middle" x="140092" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="140092" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="140092" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="140092" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L15_S1_TP2_GPU10_qk_matmul&#45;&gt;L15_S1_TP2_GPU10_softmax -->
<g id="edge4523" class="edge">
<title>L15_S1_TP2_GPU10_qk_matmul&#45;&gt;L15_S1_TP2_GPU10_softmax</title>
<path fill="none" stroke="black" d="M140092,-1324.61C140092,-1324.61 140092,-1298.8 140092,-1298.8"/>
<polygon fill="black" stroke="black" points="140095.5,-1298.8 140092,-1288.8 140088.5,-1298.8 140095.5,-1298.8"/>
</g>
<!-- L15_S1_TP2_GPU10_softmax&#45;&gt;L15_S1_TP2_GPU10_attn_v -->
<g id="edge4524" class="edge">
<title>L15_S1_TP2_GPU10_softmax&#45;&gt;L15_S1_TP2_GPU10_attn_v</title>
<path fill="none" stroke="black" d="M140092,-1220.61C140092,-1220.61 140092,-1194.8 140092,-1194.8"/>
<polygon fill="black" stroke="black" points="140095.5,-1194.8 140092,-1184.8 140088.5,-1194.8 140095.5,-1194.8"/>
</g>
<!-- L15_S1_TP2_GPU10_mha_res -->
<g id="node1620" class="node">
<title>L15_S1_TP2_GPU10_mha_res</title>
<polygon fill="none" stroke="black" points="140308.5,-948.5 139421.5,-948.5 139421.5,-880.5 140308.5,-880.5 140308.5,-948.5"/>
<text text-anchor="middle" x="139865" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="139865" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="139865" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="139865" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP2_GPU10_mha_ar&#45;&gt;L15_S1_TP2_GPU10_mha_res -->
<g id="edge4534" class="edge">
<title>L15_S1_TP2_GPU10_mha_ar&#45;&gt;L15_S1_TP2_GPU10_mha_res</title>
<path fill="none" stroke="black" d="M140130.51,-991.61C140130.51,-991.61 140130.51,-958.74 140130.51,-958.74"/>
<polygon fill="black" stroke="black" points="140134.01,-958.74 140130.51,-948.74 140127.01,-958.74 140134.01,-958.74"/>
</g>
<!-- L15_S1_TP2_GPU10_gate -->
<g id="node1621" class="node">
<title>L15_S1_TP2_GPU10_gate</title>
<polygon fill="none" stroke="black" points="140394.56,-844.5 139552.15,-844.5 139335.44,-708.5 140177.85,-708.5 140394.56,-844.5"/>
<text text-anchor="middle" x="139865" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="139865" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="139865" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="139865" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- L15_S1_TP2_GPU10_mha_res&#45;&gt;L15_S1_TP2_GPU10_gate -->
<g id="edge4535" class="edge">
<title>L15_S1_TP2_GPU10_mha_res&#45;&gt;L15_S1_TP2_GPU10_gate</title>
<path fill="none" stroke="black" d="M139865,-880.39C139865,-880.39 139865,-854.73 139865,-854.73"/>
<polygon fill="black" stroke="black" points="139868.5,-854.73 139865,-844.73 139861.5,-854.73 139868.5,-854.73"/>
</g>
<!-- L15_S1_TP2_GPU10_moe_res -->
<g id="node1623" class="node">
<title>L15_S1_TP2_GPU10_moe_res</title>
<polygon fill="none" stroke="black" points="140636,-436.33 139816,-436.33 139816,-368.33 140636,-368.33 140636,-436.33"/>
<text text-anchor="middle" x="140226" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="140226" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="140226" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="140226" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP2_GPU10_mha_res&#45;&gt;L15_S1_TP2_GPU10_moe_res -->
<g id="edge4555" class="edge">
<title>L15_S1_TP2_GPU10_mha_res&#45;&gt;L15_S1_TP2_GPU10_moe_res</title>
<path fill="none" stroke="black" d="M140308.57,-914C140365.27,-914 140404,-914 140404,-914 140404,-914 140404,-685 140404,-685 140404,-685 140083.75,-685 140083.75,-685 140083.75,-685 140083.75,-599 140083.75,-599 140083.75,-599 140111.51,-599 140111.51,-599 140111.51,-599 140111.51,-446.59 140111.51,-446.59"/>
<polygon fill="black" stroke="black" points="140115.01,-446.59 140111.51,-436.59 140108.01,-446.59 140115.01,-446.59"/>
</g>
<!-- L15_S1_TP2_GPU10_gate&#45;&gt;L15_S1_TP2_GPU10_expert0 -->
<g id="edge4536" class="edge">
<title>L15_S1_TP2_GPU10_gate&#45;&gt;L15_S1_TP2_GPU10_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M139735.75,-708.31C139735.75,-708.31 139735.75,-682.71 139735.75,-682.71"/>
<polygon fill="black" stroke="black" points="139739.25,-682.71 139735.75,-672.71 139732.25,-682.71 139739.25,-682.71"/>
</g>
<!-- L15_S1_TP2_GPU10_gate&#45;&gt;L15_S1_TP2_GPU10_expert1 -->
<g id="edge4537" class="edge">
<title>L15_S1_TP2_GPU10_gate&#45;&gt;L15_S1_TP2_GPU10_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M140242.64,-748.9C140242.64,-748.9 140242.64,-682.65 140242.64,-682.65"/>
<polygon fill="black" stroke="black" points="140246.14,-682.65 140242.64,-672.65 140239.14,-682.65 140246.14,-682.65"/>
</g>
<!-- L15_S1_TP2_GPU10_moe_ar&#45;&gt;L15_S1_TP2_GPU10_moe_res -->
<g id="edge4554" class="edge">
<title>L15_S1_TP2_GPU10_moe_ar&#45;&gt;L15_S1_TP2_GPU10_moe_res</title>
<path fill="none" stroke="black" d="M140463.18,-472.05C140463.18,-472.05 140463.18,-446.37 140463.18,-446.37"/>
<polygon fill="black" stroke="black" points="140466.68,-446.37 140463.18,-436.37 140459.68,-446.37 140466.68,-446.37"/>
</g>
<!-- L15_S1_TP2_GPU10_norm -->
<g id="node1624" class="node">
<title>L15_S1_TP2_GPU10_norm</title>
<polygon fill="none" stroke="black" points="140775.5,-332.33 140326.5,-332.33 140326.5,-264.33 140775.5,-264.33 140775.5,-332.33"/>
<text text-anchor="middle" x="140551" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="140551" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="140551" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="140551" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP2_GPU10_moe_res&#45;&gt;L15_S1_TP2_GPU10_norm -->
<g id="edge4556" class="edge">
<title>L15_S1_TP2_GPU10_moe_res&#45;&gt;L15_S1_TP2_GPU10_norm</title>
<path fill="none" stroke="black" d="M140481.25,-368.28C140481.25,-368.28 140481.25,-342.46 140481.25,-342.46"/>
<polygon fill="black" stroke="black" points="140484.75,-342.46 140481.25,-332.46 140477.75,-342.46 140484.75,-342.46"/>
</g>
<!-- L15_S1_TP2_GPU10_norm&#45;&gt;output -->
<g id="edge4739" class="edge">
<title>L15_S1_TP2_GPU10_norm&#45;&gt;output</title>
<path fill="none" stroke="black" d="M140551,-264.28C140551,-245.52 140551,-226 140551,-226 140551,-226 141375.02,-226 141375.02,-226"/>
<polygon fill="black" stroke="black" points="141375.02,-229.5 141385.02,-226 141375.02,-222.5 141375.02,-229.5"/>
</g>
<!-- L15_S1_TP3_GPU11_qkv_linear -->
<g id="node1625" class="node">
<title>L15_S1_TP3_GPU11_qkv_linear</title>
<polygon fill="none" stroke="black" points="141099,-1614.75 140491,-1614.75 140491,-1546.75 141099,-1546.75 141099,-1614.75"/>
<text text-anchor="middle" x="140795" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="140795" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="140795" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="140795" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L15_S1_TP3_GPU11_qkv_slice -->
<g id="node1626" class="node">
<title>L15_S1_TP3_GPU11_qkv_slice</title>
<polygon fill="none" stroke="black" points="141093,-1496.67 140497,-1496.67 140497,-1428.67 141093,-1428.67 141093,-1496.67"/>
<text text-anchor="middle" x="140795" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="140795" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="140795" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="140795" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L15_S1_TP3_GPU11_qkv_linear&#45;&gt;L15_S1_TP3_GPU11_qkv_slice -->
<g id="edge4557" class="edge">
<title>L15_S1_TP3_GPU11_qkv_linear&#45;&gt;L15_S1_TP3_GPU11_qkv_slice</title>
<path fill="none" stroke="black" d="M140795,-1546.59C140795,-1546.59 140795,-1506.74 140795,-1506.74"/>
<polygon fill="black" stroke="black" points="140798.5,-1506.74 140795,-1496.74 140791.5,-1506.74 140798.5,-1506.74"/>
</g>
<!-- L15_S1_TP3_GPU11_qkv_slice&#45;&gt;L15_S1_TP3_GPU11_attn_v -->
<g id="edge4561" class="edge">
<title>L15_S1_TP3_GPU11_qkv_slice&#45;&gt;L15_S1_TP3_GPU11_attn_v</title>
<path fill="none" stroke="black" d="M140637,-1428.38C140637,-1428.38 140637,-1195 140637,-1195"/>
<polygon fill="black" stroke="black" points="140640.5,-1195 140637,-1185 140633.5,-1195 140640.5,-1195"/>
</g>
<!-- L15_S1_TP3_GPU11_qk_matmul -->
<g id="node1627" class="node">
<title>L15_S1_TP3_GPU11_qk_matmul</title>
<polygon fill="none" stroke="black" points="141604.5,-1392.67 140669.5,-1392.67 140669.5,-1324.67 141604.5,-1324.67 141604.5,-1392.67"/>
<text text-anchor="middle" x="141137" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="141137" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="141137" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="141137" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L15_S1_TP3_GPU11_qkv_slice&#45;&gt;L15_S1_TP3_GPU11_qk_matmul -->
<g id="edge4558" class="edge">
<title>L15_S1_TP3_GPU11_qkv_slice&#45;&gt;L15_S1_TP3_GPU11_qk_matmul</title>
<path fill="none" stroke="black" d="M140881.25,-1428.61C140881.25,-1428.61 140881.25,-1402.8 140881.25,-1402.8"/>
<polygon fill="black" stroke="black" points="140884.75,-1402.8 140881.25,-1392.8 140877.75,-1402.8 140884.75,-1402.8"/>
</g>
<!-- L15_S1_TP3_GPU11_softmax -->
<g id="node1628" class="node">
<title>L15_S1_TP3_GPU11_softmax</title>
<polygon fill="none" stroke="black" points="141325,-1288.67 140815,-1288.67 140815,-1220.67 141325,-1220.67 141325,-1288.67"/>
<text text-anchor="middle" x="141070" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="141070" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="141070" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="141070" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L15_S1_TP3_GPU11_qk_matmul&#45;&gt;L15_S1_TP3_GPU11_softmax -->
<g id="edge4559" class="edge">
<title>L15_S1_TP3_GPU11_qk_matmul&#45;&gt;L15_S1_TP3_GPU11_softmax</title>
<path fill="none" stroke="black" d="M141070,-1324.61C141070,-1324.61 141070,-1298.8 141070,-1298.8"/>
<polygon fill="black" stroke="black" points="141073.5,-1298.8 141070,-1288.8 141066.5,-1298.8 141073.5,-1298.8"/>
</g>
<!-- L15_S1_TP3_GPU11_softmax&#45;&gt;L15_S1_TP3_GPU11_attn_v -->
<g id="edge4560" class="edge">
<title>L15_S1_TP3_GPU11_softmax&#45;&gt;L15_S1_TP3_GPU11_attn_v</title>
<path fill="none" stroke="black" d="M141070,-1220.61C141070,-1220.61 141070,-1194.8 141070,-1194.8"/>
<polygon fill="black" stroke="black" points="141073.5,-1194.8 141070,-1184.8 141066.5,-1194.8 141073.5,-1194.8"/>
</g>
<!-- L15_S1_TP3_GPU11_mha_res -->
<g id="node1630" class="node">
<title>L15_S1_TP3_GPU11_mha_res</title>
<polygon fill="none" stroke="black" points="141386.5,-948.5 140499.5,-948.5 140499.5,-880.5 141386.5,-880.5 141386.5,-948.5"/>
<text text-anchor="middle" x="140943" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="140943" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="140943" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="140943" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP3_GPU11_mha_ar&#45;&gt;L15_S1_TP3_GPU11_mha_res -->
<g id="edge4570" class="edge">
<title>L15_S1_TP3_GPU11_mha_ar&#45;&gt;L15_S1_TP3_GPU11_mha_res</title>
<path fill="none" stroke="black" d="M141054.01,-984.55C141054.01,-984.55 141054.01,-958.73 141054.01,-958.73"/>
<polygon fill="black" stroke="black" points="141057.51,-958.73 141054.01,-948.73 141050.51,-958.73 141057.51,-958.73"/>
</g>
<!-- L15_S1_TP3_GPU11_gate -->
<g id="node1631" class="node">
<title>L15_S1_TP3_GPU11_gate</title>
<polygon fill="none" stroke="black" points="141472.56,-844.5 140630.15,-844.5 140413.44,-708.5 141255.85,-708.5 141472.56,-844.5"/>
<text text-anchor="middle" x="140943" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="140943" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="140943" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="140943" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- L15_S1_TP3_GPU11_mha_res&#45;&gt;L15_S1_TP3_GPU11_gate -->
<g id="edge4571" class="edge">
<title>L15_S1_TP3_GPU11_mha_res&#45;&gt;L15_S1_TP3_GPU11_gate</title>
<path fill="none" stroke="black" d="M140943,-880.39C140943,-880.39 140943,-854.73 140943,-854.73"/>
<polygon fill="black" stroke="black" points="140946.5,-854.73 140943,-844.73 140939.5,-854.73 140946.5,-854.73"/>
</g>
<!-- L15_S1_TP3_GPU11_moe_res -->
<g id="node1633" class="node">
<title>L15_S1_TP3_GPU11_moe_res</title>
<polygon fill="none" stroke="black" points="141474,-436.33 140654,-436.33 140654,-368.33 141474,-368.33 141474,-436.33"/>
<text text-anchor="middle" x="141064" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="141064" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="141064" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="141064" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP3_GPU11_mha_res&#45;&gt;L15_S1_TP3_GPU11_moe_res -->
<g id="edge4591" class="edge">
<title>L15_S1_TP3_GPU11_mha_res&#45;&gt;L15_S1_TP3_GPU11_moe_res</title>
<path fill="none" stroke="black" d="M141386.57,-925C141445.16,-925 141485.43,-925 141485.43,-925 141485.43,-925 141485.43,-413 141485.43,-413 141485.43,-413 141484.16,-413 141484.16,-413"/>
<polygon fill="black" stroke="black" points="141484.16,-409.5 141474.16,-413 141484.16,-416.5 141484.16,-409.5"/>
</g>
<!-- L15_S1_TP3_GPU11_gate&#45;&gt;L15_S1_TP3_GPU11_expert0 -->
<g id="edge4572" class="edge">
<title>L15_S1_TP3_GPU11_gate&#45;&gt;L15_S1_TP3_GPU11_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M140707.17,-708.31C140707.17,-708.31 140707.17,-682.71 140707.17,-682.71"/>
<polygon fill="black" stroke="black" points="140710.67,-682.71 140707.17,-672.71 140703.67,-682.71 140710.67,-682.71"/>
</g>
<!-- L15_S1_TP3_GPU11_gate&#45;&gt;L15_S1_TP3_GPU11_expert1 -->
<g id="edge4573" class="edge">
<title>L15_S1_TP3_GPU11_gate&#45;&gt;L15_S1_TP3_GPU11_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M141136.57,-708.31C141136.57,-708.31 141136.57,-682.71 141136.57,-682.71"/>
<polygon fill="black" stroke="black" points="141140.07,-682.71 141136.57,-672.71 141133.07,-682.71 141140.07,-682.71"/>
</g>
<!-- L15_S1_TP3_GPU11_moe_ar&#45;&gt;L15_S1_TP3_GPU11_moe_res -->
<g id="edge4590" class="edge">
<title>L15_S1_TP3_GPU11_moe_ar&#45;&gt;L15_S1_TP3_GPU11_moe_res</title>
<path fill="none" stroke="black" d="M140995.66,-476.78C140995.66,-476.78 140995.66,-446.57 140995.66,-446.57"/>
<polygon fill="black" stroke="black" points="140999.16,-446.57 140995.66,-436.57 140992.16,-446.57 140999.16,-446.57"/>
</g>
<!-- L15_S1_TP3_GPU11_norm -->
<g id="node1634" class="node">
<title>L15_S1_TP3_GPU11_norm</title>
<polygon fill="none" stroke="black" points="141381.5,-332.33 140932.5,-332.33 140932.5,-264.33 141381.5,-264.33 141381.5,-332.33"/>
<text text-anchor="middle" x="141157" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="141157" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="141157" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="141157" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP3_GPU11_moe_res&#45;&gt;L15_S1_TP3_GPU11_norm -->
<g id="edge4592" class="edge">
<title>L15_S1_TP3_GPU11_moe_res&#45;&gt;L15_S1_TP3_GPU11_norm</title>
<path fill="none" stroke="black" d="M141157,-368.28C141157,-368.28 141157,-342.46 141157,-342.46"/>
<polygon fill="black" stroke="black" points="141160.5,-342.46 141157,-332.46 141153.5,-342.46 141160.5,-342.46"/>
</g>
<!-- L15_S1_TP3_GPU11_norm&#45;&gt;output -->
<g id="edge4740" class="edge">
<title>L15_S1_TP3_GPU11_norm&#45;&gt;output</title>
<path fill="none" stroke="black" d="M141273.5,-264.18C141273.5,-264.18 141273.5,-226.39 141273.5,-226.39"/>
<polygon fill="black" stroke="black" points="141277,-226.39 141273.5,-216.39 141270,-226.39 141277,-226.39"/>
</g>
<!-- L15_S1_TP4_GPU12_qkv_linear -->
<g id="node1635" class="node">
<title>L15_S1_TP4_GPU12_qkv_linear</title>
<polygon fill="none" stroke="black" points="142281,-1614.75 141673,-1614.75 141673,-1546.75 142281,-1546.75 142281,-1614.75"/>
<text text-anchor="middle" x="141977" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="141977" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="141977" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="141977" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L15_S1_TP4_GPU12_qkv_slice -->
<g id="node1636" class="node">
<title>L15_S1_TP4_GPU12_qkv_slice</title>
<polygon fill="none" stroke="black" points="142275,-1496.67 141679,-1496.67 141679,-1428.67 142275,-1428.67 142275,-1496.67"/>
<text text-anchor="middle" x="141977" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="141977" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="141977" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="141977" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L15_S1_TP4_GPU12_qkv_linear&#45;&gt;L15_S1_TP4_GPU12_qkv_slice -->
<g id="edge4593" class="edge">
<title>L15_S1_TP4_GPU12_qkv_linear&#45;&gt;L15_S1_TP4_GPU12_qkv_slice</title>
<path fill="none" stroke="black" d="M141977,-1546.59C141977,-1546.59 141977,-1506.74 141977,-1506.74"/>
<polygon fill="black" stroke="black" points="141980.5,-1506.74 141977,-1496.74 141973.5,-1506.74 141980.5,-1506.74"/>
</g>
<!-- L15_S1_TP4_GPU12_qkv_slice&#45;&gt;L15_S1_TP4_GPU12_attn_v -->
<g id="edge4597" class="edge">
<title>L15_S1_TP4_GPU12_qkv_slice&#45;&gt;L15_S1_TP4_GPU12_attn_v</title>
<path fill="none" stroke="black" d="M141678.66,-1462C141652.1,-1462 141635,-1462 141635,-1462 141635,-1462 141635,-1194.87 141635,-1194.87"/>
<polygon fill="black" stroke="black" points="141638.5,-1194.87 141635,-1184.87 141631.5,-1194.87 141638.5,-1194.87"/>
</g>
<!-- L15_S1_TP4_GPU12_qk_matmul -->
<g id="node1637" class="node">
<title>L15_S1_TP4_GPU12_qk_matmul</title>
<polygon fill="none" stroke="black" points="142600.5,-1392.67 141665.5,-1392.67 141665.5,-1324.67 142600.5,-1324.67 142600.5,-1392.67"/>
<text text-anchor="middle" x="142133" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="142133" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="142133" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="142133" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L15_S1_TP4_GPU12_qkv_slice&#45;&gt;L15_S1_TP4_GPU12_qk_matmul -->
<g id="edge4594" class="edge">
<title>L15_S1_TP4_GPU12_qkv_slice&#45;&gt;L15_S1_TP4_GPU12_qk_matmul</title>
<path fill="none" stroke="black" d="M141977,-1428.61C141977,-1428.61 141977,-1402.8 141977,-1402.8"/>
<polygon fill="black" stroke="black" points="141980.5,-1402.8 141977,-1392.8 141973.5,-1402.8 141980.5,-1402.8"/>
</g>
<!-- L15_S1_TP4_GPU12_softmax -->
<g id="node1638" class="node">
<title>L15_S1_TP4_GPU12_softmax</title>
<polygon fill="none" stroke="black" points="142301,-1288.67 141791,-1288.67 141791,-1220.67 142301,-1220.67 142301,-1288.67"/>
<text text-anchor="middle" x="142046" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="142046" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="142046" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="142046" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L15_S1_TP4_GPU12_qk_matmul&#45;&gt;L15_S1_TP4_GPU12_softmax -->
<g id="edge4595" class="edge">
<title>L15_S1_TP4_GPU12_qk_matmul&#45;&gt;L15_S1_TP4_GPU12_softmax</title>
<path fill="none" stroke="black" d="M142046,-1324.61C142046,-1324.61 142046,-1298.8 142046,-1298.8"/>
<polygon fill="black" stroke="black" points="142049.5,-1298.8 142046,-1288.8 142042.5,-1298.8 142049.5,-1298.8"/>
</g>
<!-- L15_S1_TP4_GPU12_softmax&#45;&gt;L15_S1_TP4_GPU12_attn_v -->
<g id="edge4596" class="edge">
<title>L15_S1_TP4_GPU12_softmax&#45;&gt;L15_S1_TP4_GPU12_attn_v</title>
<path fill="none" stroke="black" d="M142046,-1220.61C142046,-1220.61 142046,-1194.8 142046,-1194.8"/>
<polygon fill="black" stroke="black" points="142049.5,-1194.8 142046,-1184.8 142042.5,-1194.8 142049.5,-1194.8"/>
</g>
<!-- L15_S1_TP4_GPU12_mha_res -->
<g id="node1640" class="node">
<title>L15_S1_TP4_GPU12_mha_res</title>
<polygon fill="none" stroke="black" points="142464.5,-948.5 141577.5,-948.5 141577.5,-880.5 142464.5,-880.5 142464.5,-948.5"/>
<text text-anchor="middle" x="142021" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="142021" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="142021" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="142021" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP4_GPU12_mha_ar&#45;&gt;L15_S1_TP4_GPU12_mha_res -->
<g id="edge4606" class="edge">
<title>L15_S1_TP4_GPU12_mha_ar&#45;&gt;L15_S1_TP4_GPU12_mha_res</title>
<path fill="none" stroke="black" d="M141909.49,-984.55C141909.49,-984.55 141909.49,-958.73 141909.49,-958.73"/>
<polygon fill="black" stroke="black" points="141912.99,-958.73 141909.49,-948.73 141905.99,-958.73 141912.99,-958.73"/>
</g>
<!-- L15_S1_TP4_GPU12_gate -->
<g id="node1641" class="node">
<title>L15_S1_TP4_GPU12_gate</title>
<polygon fill="none" stroke="black" points="142550.56,-844.5 141708.15,-844.5 141491.44,-708.5 142333.85,-708.5 142550.56,-844.5"/>
<text text-anchor="middle" x="142021" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="142021" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="142021" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="142021" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- L15_S1_TP4_GPU12_mha_res&#45;&gt;L15_S1_TP4_GPU12_gate -->
<g id="edge4607" class="edge">
<title>L15_S1_TP4_GPU12_mha_res&#45;&gt;L15_S1_TP4_GPU12_gate</title>
<path fill="none" stroke="black" d="M142021,-880.39C142021,-880.39 142021,-854.73 142021,-854.73"/>
<polygon fill="black" stroke="black" points="142024.5,-854.73 142021,-844.73 142017.5,-854.73 142024.5,-854.73"/>
</g>
<!-- L15_S1_TP4_GPU12_moe_res -->
<g id="node1643" class="node">
<title>L15_S1_TP4_GPU12_moe_res</title>
<polygon fill="none" stroke="black" points="142312,-436.33 141492,-436.33 141492,-368.33 142312,-368.33 142312,-436.33"/>
<text text-anchor="middle" x="141902" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="141902" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="141902" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="141902" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP4_GPU12_mha_res&#45;&gt;L15_S1_TP4_GPU12_moe_res -->
<g id="edge4627" class="edge">
<title>L15_S1_TP4_GPU12_mha_res&#45;&gt;L15_S1_TP4_GPU12_moe_res</title>
<path fill="none" stroke="black" d="M141577.27,-903C141523.83,-903 141487.71,-903 141487.71,-903 141487.71,-903 141487.71,-390 141487.71,-390 141487.71,-390 141488.12,-390 141488.12,-390"/>
<polygon fill="black" stroke="black" points="141481.81,-393.5 141491.81,-390 141481.81,-386.5 141481.81,-393.5"/>
</g>
<!-- L15_S1_TP4_GPU12_gate&#45;&gt;L15_S1_TP4_GPU12_expert0 -->
<g id="edge4608" class="edge">
<title>L15_S1_TP4_GPU12_gate&#45;&gt;L15_S1_TP4_GPU12_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M141828.25,-708.31C141828.25,-708.31 141828.25,-682.71 141828.25,-682.71"/>
<polygon fill="black" stroke="black" points="141831.75,-682.71 141828.25,-672.71 141824.75,-682.71 141831.75,-682.71"/>
</g>
<!-- L15_S1_TP4_GPU12_gate&#45;&gt;L15_S1_TP4_GPU12_expert1 -->
<g id="edge4609" class="edge">
<title>L15_S1_TP4_GPU12_gate&#45;&gt;L15_S1_TP4_GPU12_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M142257.83,-708.31C142257.83,-708.31 142257.83,-682.71 142257.83,-682.71"/>
<polygon fill="black" stroke="black" points="142261.33,-682.71 142257.83,-672.71 142254.33,-682.71 142261.33,-682.71"/>
</g>
<!-- L15_S1_TP4_GPU12_moe_ar&#45;&gt;L15_S1_TP4_GPU12_moe_res -->
<g id="edge4626" class="edge">
<title>L15_S1_TP4_GPU12_moe_ar&#45;&gt;L15_S1_TP4_GPU12_moe_res</title>
<path fill="none" stroke="black" d="M141937.64,-474.76C141937.64,-474.76 141937.64,-446.51 141937.64,-446.51"/>
<polygon fill="black" stroke="black" points="141941.14,-446.51 141937.64,-436.51 141934.14,-446.51 141941.14,-446.51"/>
</g>
<!-- L15_S1_TP4_GPU12_norm -->
<g id="node1644" class="node">
<title>L15_S1_TP4_GPU12_norm</title>
<polygon fill="none" stroke="black" points="142033.5,-332.33 141584.5,-332.33 141584.5,-264.33 142033.5,-264.33 142033.5,-332.33"/>
<text text-anchor="middle" x="141809" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="141809" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="141809" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="141809" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP4_GPU12_moe_res&#45;&gt;L15_S1_TP4_GPU12_norm -->
<g id="edge4628" class="edge">
<title>L15_S1_TP4_GPU12_moe_res&#45;&gt;L15_S1_TP4_GPU12_norm</title>
<path fill="none" stroke="black" d="M141809,-368.28C141809,-368.28 141809,-342.46 141809,-342.46"/>
<polygon fill="black" stroke="black" points="141812.5,-342.46 141809,-332.46 141805.5,-342.46 141812.5,-342.46"/>
</g>
<!-- L15_S1_TP4_GPU12_norm&#45;&gt;output -->
<g id="edge4741" class="edge">
<title>L15_S1_TP4_GPU12_norm&#45;&gt;output</title>
<path fill="none" stroke="black" d="M141692.5,-264.18C141692.5,-264.18 141692.5,-226.39 141692.5,-226.39"/>
<polygon fill="black" stroke="black" points="141696,-226.39 141692.5,-216.39 141689,-226.39 141696,-226.39"/>
</g>
<!-- L15_S1_TP5_GPU13_qkv_linear -->
<g id="node1645" class="node">
<title>L15_S1_TP5_GPU13_qkv_linear</title>
<polygon fill="none" stroke="black" points="143091,-1614.75 142483,-1614.75 142483,-1546.75 143091,-1546.75 143091,-1614.75"/>
<text text-anchor="middle" x="142787" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="142787" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="142787" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="142787" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L15_S1_TP5_GPU13_qkv_slice -->
<g id="node1646" class="node">
<title>L15_S1_TP5_GPU13_qkv_slice</title>
<polygon fill="none" stroke="black" points="143085,-1496.67 142489,-1496.67 142489,-1428.67 143085,-1428.67 143085,-1496.67"/>
<text text-anchor="middle" x="142787" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="142787" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="142787" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="142787" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L15_S1_TP5_GPU13_qkv_linear&#45;&gt;L15_S1_TP5_GPU13_qkv_slice -->
<g id="edge4629" class="edge">
<title>L15_S1_TP5_GPU13_qkv_linear&#45;&gt;L15_S1_TP5_GPU13_qkv_slice</title>
<path fill="none" stroke="black" d="M142787,-1546.59C142787,-1546.59 142787,-1506.74 142787,-1506.74"/>
<polygon fill="black" stroke="black" points="142790.5,-1506.74 142787,-1496.74 142783.5,-1506.74 142790.5,-1506.74"/>
</g>
<!-- L15_S1_TP5_GPU13_qkv_slice&#45;&gt;L15_S1_TP5_GPU13_attn_v -->
<g id="edge4633" class="edge">
<title>L15_S1_TP5_GPU13_qkv_slice&#45;&gt;L15_S1_TP5_GPU13_attn_v</title>
<path fill="none" stroke="black" d="M142630,-1428.38C142630,-1428.38 142630,-1195 142630,-1195"/>
<polygon fill="black" stroke="black" points="142633.5,-1195 142630,-1185 142626.5,-1195 142633.5,-1195"/>
</g>
<!-- L15_S1_TP5_GPU13_qk_matmul -->
<g id="node1647" class="node">
<title>L15_S1_TP5_GPU13_qk_matmul</title>
<polygon fill="none" stroke="black" points="143594.5,-1392.67 142659.5,-1392.67 142659.5,-1324.67 143594.5,-1324.67 143594.5,-1392.67"/>
<text text-anchor="middle" x="143127" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="143127" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="143127" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="143127" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L15_S1_TP5_GPU13_qkv_slice&#45;&gt;L15_S1_TP5_GPU13_qk_matmul -->
<g id="edge4630" class="edge">
<title>L15_S1_TP5_GPU13_qkv_slice&#45;&gt;L15_S1_TP5_GPU13_qk_matmul</title>
<path fill="none" stroke="black" d="M142872.25,-1428.61C142872.25,-1428.61 142872.25,-1402.8 142872.25,-1402.8"/>
<polygon fill="black" stroke="black" points="142875.75,-1402.8 142872.25,-1392.8 142868.75,-1402.8 142875.75,-1402.8"/>
</g>
<!-- L15_S1_TP5_GPU13_softmax -->
<g id="node1648" class="node">
<title>L15_S1_TP5_GPU13_softmax</title>
<polygon fill="none" stroke="black" points="143276,-1288.67 142766,-1288.67 142766,-1220.67 143276,-1220.67 143276,-1288.67"/>
<text text-anchor="middle" x="143021" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="143021" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="143021" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="143021" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L15_S1_TP5_GPU13_qk_matmul&#45;&gt;L15_S1_TP5_GPU13_softmax -->
<g id="edge4631" class="edge">
<title>L15_S1_TP5_GPU13_qk_matmul&#45;&gt;L15_S1_TP5_GPU13_softmax</title>
<path fill="none" stroke="black" d="M143021,-1324.61C143021,-1324.61 143021,-1298.8 143021,-1298.8"/>
<polygon fill="black" stroke="black" points="143024.5,-1298.8 143021,-1288.8 143017.5,-1298.8 143024.5,-1298.8"/>
</g>
<!-- L15_S1_TP5_GPU13_softmax&#45;&gt;L15_S1_TP5_GPU13_attn_v -->
<g id="edge4632" class="edge">
<title>L15_S1_TP5_GPU13_softmax&#45;&gt;L15_S1_TP5_GPU13_attn_v</title>
<path fill="none" stroke="black" d="M143021,-1220.61C143021,-1220.61 143021,-1194.8 143021,-1194.8"/>
<polygon fill="black" stroke="black" points="143024.5,-1194.8 143021,-1184.8 143017.5,-1194.8 143024.5,-1194.8"/>
</g>
<!-- L15_S1_TP5_GPU13_mha_res -->
<g id="node1650" class="node">
<title>L15_S1_TP5_GPU13_mha_res</title>
<polygon fill="none" stroke="black" points="143542.5,-948.5 142655.5,-948.5 142655.5,-880.5 143542.5,-880.5 143542.5,-948.5"/>
<text text-anchor="middle" x="143099" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="143099" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="143099" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="143099" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP5_GPU13_mha_ar&#45;&gt;L15_S1_TP5_GPU13_mha_res -->
<g id="edge4642" class="edge">
<title>L15_S1_TP5_GPU13_mha_ar&#45;&gt;L15_S1_TP5_GPU13_mha_res</title>
<path fill="none" stroke="black" d="M142832.99,-991.61C142832.99,-991.61 142832.99,-958.74 142832.99,-958.74"/>
<polygon fill="black" stroke="black" points="142836.49,-958.74 142832.99,-948.74 142829.49,-958.74 142836.49,-958.74"/>
</g>
<!-- L15_S1_TP5_GPU13_gate -->
<g id="node1651" class="node">
<title>L15_S1_TP5_GPU13_gate</title>
<polygon fill="none" stroke="black" points="143628.56,-844.5 142786.15,-844.5 142569.44,-708.5 143411.85,-708.5 143628.56,-844.5"/>
<text text-anchor="middle" x="143099" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="143099" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="143099" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="143099" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- L15_S1_TP5_GPU13_mha_res&#45;&gt;L15_S1_TP5_GPU13_gate -->
<g id="edge4643" class="edge">
<title>L15_S1_TP5_GPU13_mha_res&#45;&gt;L15_S1_TP5_GPU13_gate</title>
<path fill="none" stroke="black" d="M143099,-880.39C143099,-880.39 143099,-854.73 143099,-854.73"/>
<polygon fill="black" stroke="black" points="143102.5,-854.73 143099,-844.73 143095.5,-854.73 143102.5,-854.73"/>
</g>
<!-- L15_S1_TP5_GPU13_moe_res -->
<g id="node1653" class="node">
<title>L15_S1_TP5_GPU13_moe_res</title>
<polygon fill="none" stroke="black" points="143150,-436.33 142330,-436.33 142330,-368.33 143150,-368.33 143150,-436.33"/>
<text text-anchor="middle" x="142740" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="142740" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="142740" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="142740" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP5_GPU13_mha_res&#45;&gt;L15_S1_TP5_GPU13_moe_res -->
<g id="edge4663" class="edge">
<title>L15_S1_TP5_GPU13_mha_res&#45;&gt;L15_S1_TP5_GPU13_moe_res</title>
<path fill="none" stroke="black" d="M142655.43,-914C142598.73,-914 142560,-914 142560,-914 142560,-914 142560,-685 142560,-685 142560,-685 142881.25,-685 142881.25,-685 142881.25,-685 142881.25,-599 142881.25,-599 142881.25,-599 142859.51,-599 142859.51,-599 142859.51,-599 142859.51,-446.59 142859.51,-446.59"/>
<polygon fill="black" stroke="black" points="142863.01,-446.59 142859.51,-436.59 142856.01,-446.59 142863.01,-446.59"/>
</g>
<!-- L15_S1_TP5_GPU13_gate&#45;&gt;L15_S1_TP5_GPU13_expert0 -->
<g id="edge4644" class="edge">
<title>L15_S1_TP5_GPU13_gate&#45;&gt;L15_S1_TP5_GPU13_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M142721.86,-708.31C142721.86,-708.31 142721.86,-682.71 142721.86,-682.71"/>
<polygon fill="black" stroke="black" points="142725.36,-682.71 142721.86,-672.71 142718.36,-682.71 142725.36,-682.71"/>
</g>
<!-- L15_S1_TP5_GPU13_gate&#45;&gt;L15_S1_TP5_GPU13_expert1 -->
<g id="edge4645" class="edge">
<title>L15_S1_TP5_GPU13_gate&#45;&gt;L15_S1_TP5_GPU13_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M143229.25,-708.31C143229.25,-708.31 143229.25,-682.71 143229.25,-682.71"/>
<polygon fill="black" stroke="black" points="143232.75,-682.71 143229.25,-672.71 143225.75,-682.71 143232.75,-682.71"/>
</g>
<!-- L15_S1_TP5_GPU13_moe_ar&#45;&gt;L15_S1_TP5_GPU13_moe_res -->
<g id="edge4662" class="edge">
<title>L15_S1_TP5_GPU13_moe_ar&#45;&gt;L15_S1_TP5_GPU13_moe_res</title>
<path fill="none" stroke="black" d="M142588.73,-473.41C142588.73,-473.41 142588.73,-446.45 142588.73,-446.45"/>
<polygon fill="black" stroke="black" points="142592.23,-446.45 142588.73,-436.45 142585.23,-446.45 142592.23,-446.45"/>
</g>
<!-- L15_S1_TP5_GPU13_norm -->
<g id="node1654" class="node">
<title>L15_S1_TP5_GPU13_norm</title>
<polygon fill="none" stroke="black" points="142778.5,-332.33 142329.5,-332.33 142329.5,-264.33 142778.5,-264.33 142778.5,-332.33"/>
<text text-anchor="middle" x="142554" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="142554" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="142554" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="142554" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP5_GPU13_moe_res&#45;&gt;L15_S1_TP5_GPU13_norm -->
<g id="edge4664" class="edge">
<title>L15_S1_TP5_GPU13_moe_res&#45;&gt;L15_S1_TP5_GPU13_norm</title>
<path fill="none" stroke="black" d="M142554.25,-368.28C142554.25,-368.28 142554.25,-342.46 142554.25,-342.46"/>
<polygon fill="black" stroke="black" points="142557.75,-342.46 142554.25,-332.46 142550.75,-342.46 142557.75,-342.46"/>
</g>
<!-- L15_S1_TP5_GPU13_norm&#45;&gt;output -->
<g id="edge4742" class="edge">
<title>L15_S1_TP5_GPU13_norm&#45;&gt;output</title>
<path fill="none" stroke="black" d="M142554,-264.28C142554,-237.26 142554,-204 142554,-204 142554,-204 141769.16,-204 141769.16,-204"/>
<polygon fill="black" stroke="black" points="141769.16,-200.5 141759.16,-204 141769.16,-207.5 141769.16,-200.5"/>
</g>
<!-- L15_S1_TP6_GPU14_qkv_linear -->
<g id="node1655" class="node">
<title>L15_S1_TP6_GPU14_qkv_linear</title>
<polygon fill="none" stroke="black" points="144282,-1614.75 143674,-1614.75 143674,-1546.75 144282,-1546.75 144282,-1614.75"/>
<text text-anchor="middle" x="143978" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="143978" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="143978" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="143978" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L15_S1_TP6_GPU14_qkv_slice -->
<g id="node1656" class="node">
<title>L15_S1_TP6_GPU14_qkv_slice</title>
<polygon fill="none" stroke="black" points="144276,-1496.67 143680,-1496.67 143680,-1428.67 144276,-1428.67 144276,-1496.67"/>
<text text-anchor="middle" x="143978" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="143978" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="143978" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="143978" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L15_S1_TP6_GPU14_qkv_linear&#45;&gt;L15_S1_TP6_GPU14_qkv_slice -->
<g id="edge4665" class="edge">
<title>L15_S1_TP6_GPU14_qkv_linear&#45;&gt;L15_S1_TP6_GPU14_qkv_slice</title>
<path fill="none" stroke="black" d="M143978,-1546.59C143978,-1546.59 143978,-1506.74 143978,-1506.74"/>
<polygon fill="black" stroke="black" points="143981.5,-1506.74 143978,-1496.74 143974.5,-1506.74 143981.5,-1506.74"/>
</g>
<!-- L15_S1_TP6_GPU14_qkv_slice&#45;&gt;L15_S1_TP6_GPU14_attn_v -->
<g id="edge4669" class="edge">
<title>L15_S1_TP6_GPU14_qkv_slice&#45;&gt;L15_S1_TP6_GPU14_attn_v</title>
<path fill="none" stroke="black" d="M143719.25,-1428.38C143719.25,-1428.38 143719.25,-1195 143719.25,-1195"/>
<polygon fill="black" stroke="black" points="143722.75,-1195 143719.25,-1185 143715.75,-1195 143722.75,-1195"/>
</g>
<!-- L15_S1_TP6_GPU14_qk_matmul -->
<g id="node1657" class="node">
<title>L15_S1_TP6_GPU14_qk_matmul</title>
<polygon fill="none" stroke="black" points="144693.5,-1392.67 143758.5,-1392.67 143758.5,-1324.67 144693.5,-1324.67 144693.5,-1392.67"/>
<text text-anchor="middle" x="144226" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="144226" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="144226" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="144226" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L15_S1_TP6_GPU14_qkv_slice&#45;&gt;L15_S1_TP6_GPU14_qk_matmul -->
<g id="edge4666" class="edge">
<title>L15_S1_TP6_GPU14_qkv_slice&#45;&gt;L15_S1_TP6_GPU14_qk_matmul</title>
<path fill="none" stroke="black" d="M144017.25,-1428.61C144017.25,-1428.61 144017.25,-1402.8 144017.25,-1402.8"/>
<polygon fill="black" stroke="black" points="144020.75,-1402.8 144017.25,-1392.8 144013.75,-1402.8 144020.75,-1402.8"/>
</g>
<!-- L15_S1_TP6_GPU14_softmax -->
<g id="node1658" class="node">
<title>L15_S1_TP6_GPU14_softmax</title>
<polygon fill="none" stroke="black" points="144374,-1288.67 143864,-1288.67 143864,-1220.67 144374,-1220.67 144374,-1288.67"/>
<text text-anchor="middle" x="144119" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="144119" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="144119" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="144119" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L15_S1_TP6_GPU14_qk_matmul&#45;&gt;L15_S1_TP6_GPU14_softmax -->
<g id="edge4667" class="edge">
<title>L15_S1_TP6_GPU14_qk_matmul&#45;&gt;L15_S1_TP6_GPU14_softmax</title>
<path fill="none" stroke="black" d="M144119,-1324.61C144119,-1324.61 144119,-1298.8 144119,-1298.8"/>
<polygon fill="black" stroke="black" points="144122.5,-1298.8 144119,-1288.8 144115.5,-1298.8 144122.5,-1298.8"/>
</g>
<!-- L15_S1_TP6_GPU14_softmax&#45;&gt;L15_S1_TP6_GPU14_attn_v -->
<g id="edge4668" class="edge">
<title>L15_S1_TP6_GPU14_softmax&#45;&gt;L15_S1_TP6_GPU14_attn_v</title>
<path fill="none" stroke="black" d="M144102,-1220.61C144102,-1220.61 144102,-1194.8 144102,-1194.8"/>
<polygon fill="black" stroke="black" points="144105.5,-1194.8 144102,-1184.8 144098.5,-1194.8 144105.5,-1194.8"/>
</g>
<!-- L15_S1_TP6_GPU14_mha_res -->
<g id="node1660" class="node">
<title>L15_S1_TP6_GPU14_mha_res</title>
<polygon fill="none" stroke="black" points="144620.5,-948.5 143733.5,-948.5 143733.5,-880.5 144620.5,-880.5 144620.5,-948.5"/>
<text text-anchor="middle" x="144177" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="144177" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="144177" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="144177" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP6_GPU14_mha_ar&#45;&gt;L15_S1_TP6_GPU14_mha_res -->
<g id="edge4678" class="edge">
<title>L15_S1_TP6_GPU14_mha_ar&#45;&gt;L15_S1_TP6_GPU14_mha_res</title>
<path fill="none" stroke="black" d="M143756.49,-1015.91C143756.49,-1015.91 143756.49,-958.58 143756.49,-958.58"/>
<polygon fill="black" stroke="black" points="143759.99,-958.58 143756.49,-948.58 143752.99,-958.58 143759.99,-958.58"/>
</g>
<!-- L15_S1_TP6_GPU14_gate -->
<g id="node1661" class="node">
<title>L15_S1_TP6_GPU14_gate</title>
<polygon fill="none" stroke="black" points="144706.56,-844.5 143864.15,-844.5 143647.44,-708.5 144489.85,-708.5 144706.56,-844.5"/>
<text text-anchor="middle" x="144177" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="144177" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="144177" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="144177" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- L15_S1_TP6_GPU14_mha_res&#45;&gt;L15_S1_TP6_GPU14_gate -->
<g id="edge4679" class="edge">
<title>L15_S1_TP6_GPU14_mha_res&#45;&gt;L15_S1_TP6_GPU14_gate</title>
<path fill="none" stroke="black" d="M144177,-880.39C144177,-880.39 144177,-854.73 144177,-854.73"/>
<polygon fill="black" stroke="black" points="144180.5,-854.73 144177,-844.73 144173.5,-854.73 144180.5,-854.73"/>
</g>
<!-- L15_S1_TP6_GPU14_moe_res -->
<g id="node1663" class="node">
<title>L15_S1_TP6_GPU14_moe_res</title>
<polygon fill="none" stroke="black" points="143988,-436.33 143168,-436.33 143168,-368.33 143988,-368.33 143988,-436.33"/>
<text text-anchor="middle" x="143578" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="143578" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="143578" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="143578" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP6_GPU14_mha_res&#45;&gt;L15_S1_TP6_GPU14_moe_res -->
<g id="edge4699" class="edge">
<title>L15_S1_TP6_GPU14_mha_res&#45;&gt;L15_S1_TP6_GPU14_moe_res</title>
<path fill="none" stroke="black" d="M143733.43,-914C143676.73,-914 143638,-914 143638,-914 143638,-914 143638,-695 143638,-695 143638,-695 143812.1,-695 143812.1,-695 143812.1,-695 143812.1,-603 143812.1,-603 143812.1,-603 143548.02,-603 143548.02,-603 143548.02,-603 143548.02,-446.37 143548.02,-446.37"/>
<polygon fill="black" stroke="black" points="143551.52,-446.37 143548.02,-436.37 143544.52,-446.37 143551.52,-446.37"/>
</g>
<!-- L15_S1_TP6_GPU14_gate&#45;&gt;L15_S1_TP6_GPU14_expert0 -->
<g id="edge4680" class="edge">
<title>L15_S1_TP6_GPU14_gate&#45;&gt;L15_S1_TP6_GPU14_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M143727.86,-708.31C143727.86,-708.31 143727.86,-682.71 143727.86,-682.71"/>
<polygon fill="black" stroke="black" points="143731.36,-682.71 143727.86,-672.71 143724.36,-682.71 143731.36,-682.71"/>
</g>
<!-- L15_S1_TP6_GPU14_gate&#45;&gt;L15_S1_TP6_GPU14_expert1 -->
<g id="edge4681" class="edge">
<title>L15_S1_TP6_GPU14_gate&#45;&gt;L15_S1_TP6_GPU14_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M144051,-708.31C144051,-708.31 144051,-682.71 144051,-682.71"/>
<polygon fill="black" stroke="black" points="144054.5,-682.71 144051,-672.71 144047.5,-682.71 144054.5,-682.71"/>
</g>
<!-- L15_S1_TP6_GPU14_moe_ar&#45;&gt;L15_S1_TP6_GPU14_moe_res -->
<g id="edge4698" class="edge">
<title>L15_S1_TP6_GPU14_moe_ar&#45;&gt;L15_S1_TP6_GPU14_moe_res</title>
<path fill="none" stroke="black" d="M143351.23,-477.45C143351.23,-477.45 143351.23,-446.57 143351.23,-446.57"/>
<polygon fill="black" stroke="black" points="143354.73,-446.57 143351.23,-436.57 143347.73,-446.57 143354.73,-446.57"/>
</g>
<!-- L15_S1_TP6_GPU14_norm -->
<g id="node1664" class="node">
<title>L15_S1_TP6_GPU14_norm</title>
<polygon fill="none" stroke="black" points="143570.5,-332.33 143121.5,-332.33 143121.5,-264.33 143570.5,-264.33 143570.5,-332.33"/>
<text text-anchor="middle" x="143346" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="143346" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="143346" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="143346" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP6_GPU14_moe_res&#45;&gt;L15_S1_TP6_GPU14_norm -->
<g id="edge4700" class="edge">
<title>L15_S1_TP6_GPU14_moe_res&#45;&gt;L15_S1_TP6_GPU14_norm</title>
<path fill="none" stroke="black" d="M143369.25,-368.28C143369.25,-368.28 143369.25,-342.46 143369.25,-342.46"/>
<polygon fill="black" stroke="black" points="143372.75,-342.46 143369.25,-332.46 143365.75,-342.46 143372.75,-342.46"/>
</g>
<!-- L15_S1_TP6_GPU14_norm&#45;&gt;output -->
<g id="edge4743" class="edge">
<title>L15_S1_TP6_GPU14_norm&#45;&gt;output</title>
<path fill="none" stroke="black" d="M143346,-264.11C143346,-229.16 143346,-180 143346,-180 143346,-180 141810.62,-180 141810.62,-180"/>
<polygon fill="black" stroke="black" points="141810.62,-176.5 141800.62,-180 141810.62,-183.5 141810.62,-176.5"/>
</g>
<!-- L15_S1_TP7_GPU15_qkv_linear -->
<g id="node1665" class="node">
<title>L15_S1_TP7_GPU15_qkv_linear</title>
<polygon fill="none" stroke="black" points="145327,-1614.75 144719,-1614.75 144719,-1546.75 145327,-1546.75 145327,-1614.75"/>
<text text-anchor="middle" x="145023" y="-1599.55" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="145023" y="-1584.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="145023" y="-1569.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="145023" y="-1554.55" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L15_S1_TP7_GPU15_qkv_slice -->
<g id="node1666" class="node">
<title>L15_S1_TP7_GPU15_qkv_slice</title>
<polygon fill="none" stroke="black" points="145321,-1496.67 144725,-1496.67 144725,-1428.67 145321,-1428.67 145321,-1496.67"/>
<text text-anchor="middle" x="145023" y="-1481.47" font-family="Times,serif" font-size="14.00">QKV Slice (TP)</text>
<text text-anchor="middle" x="145023" y="-1466.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128, tp_shard=1]</text>
<text text-anchor="middle" x="145023" y="-1451.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="145023" y="-1436.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L15_S1_TP7_GPU15_qkv_linear&#45;&gt;L15_S1_TP7_GPU15_qkv_slice -->
<g id="edge4701" class="edge">
<title>L15_S1_TP7_GPU15_qkv_linear&#45;&gt;L15_S1_TP7_GPU15_qkv_slice</title>
<path fill="none" stroke="black" d="M145023,-1546.59C145023,-1546.59 145023,-1506.74 145023,-1506.74"/>
<polygon fill="black" stroke="black" points="145026.5,-1506.74 145023,-1496.74 145019.5,-1506.74 145026.5,-1506.74"/>
</g>
<!-- L15_S1_TP7_GPU15_qkv_slice&#45;&gt;L15_S1_TP7_GPU15_attn_v -->
<g id="edge4705" class="edge">
<title>L15_S1_TP7_GPU15_qkv_slice&#45;&gt;L15_S1_TP7_GPU15_attn_v</title>
<path fill="none" stroke="black" d="M144764.25,-1428.38C144764.25,-1428.38 144764.25,-1195 144764.25,-1195"/>
<polygon fill="black" stroke="black" points="144767.75,-1195 144764.25,-1185 144760.75,-1195 144767.75,-1195"/>
</g>
<!-- L15_S1_TP7_GPU15_qk_matmul -->
<g id="node1667" class="node">
<title>L15_S1_TP7_GPU15_qk_matmul</title>
<polygon fill="none" stroke="black" points="145738.5,-1392.67 144803.5,-1392.67 144803.5,-1324.67 145738.5,-1324.67 145738.5,-1392.67"/>
<text text-anchor="middle" x="145271" y="-1377.47" font-family="Times,serif" font-size="14.00">QK Matmul</text>
<text text-anchor="middle" x="145271" y="-1362.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=4, head_dim=128], [batch_size=128, seq_len=10000, heads=4, head_dim=128]</text>
<text text-anchor="middle" x="145271" y="-1347.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="145271" y="-1332.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L15_S1_TP7_GPU15_qkv_slice&#45;&gt;L15_S1_TP7_GPU15_qk_matmul -->
<g id="edge4702" class="edge">
<title>L15_S1_TP7_GPU15_qkv_slice&#45;&gt;L15_S1_TP7_GPU15_qk_matmul</title>
<path fill="none" stroke="black" d="M145062.25,-1428.61C145062.25,-1428.61 145062.25,-1402.8 145062.25,-1402.8"/>
<polygon fill="black" stroke="black" points="145065.75,-1402.8 145062.25,-1392.8 145058.75,-1402.8 145065.75,-1402.8"/>
</g>
<!-- L15_S1_TP7_GPU15_softmax -->
<g id="node1668" class="node">
<title>L15_S1_TP7_GPU15_softmax</title>
<polygon fill="none" stroke="black" points="145419,-1288.67 144909,-1288.67 144909,-1220.67 145419,-1220.67 145419,-1288.67"/>
<text text-anchor="middle" x="145164" y="-1273.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="145164" y="-1258.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="145164" y="-1243.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, heads=4, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="145164" y="-1228.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L15_S1_TP7_GPU15_qk_matmul&#45;&gt;L15_S1_TP7_GPU15_softmax -->
<g id="edge4703" class="edge">
<title>L15_S1_TP7_GPU15_qk_matmul&#45;&gt;L15_S1_TP7_GPU15_softmax</title>
<path fill="none" stroke="black" d="M145164,-1324.61C145164,-1324.61 145164,-1298.8 145164,-1298.8"/>
<polygon fill="black" stroke="black" points="145167.5,-1298.8 145164,-1288.8 145160.5,-1298.8 145167.5,-1298.8"/>
</g>
<!-- L15_S1_TP7_GPU15_softmax&#45;&gt;L15_S1_TP7_GPU15_attn_v -->
<g id="edge4704" class="edge">
<title>L15_S1_TP7_GPU15_softmax&#45;&gt;L15_S1_TP7_GPU15_attn_v</title>
<path fill="none" stroke="black" d="M145102.5,-1220.61C145102.5,-1220.61 145102.5,-1194.8 145102.5,-1194.8"/>
<polygon fill="black" stroke="black" points="145106,-1194.8 145102.5,-1184.8 145099,-1194.8 145106,-1194.8"/>
</g>
<!-- L15_S1_TP7_GPU15_mha_res -->
<g id="node1670" class="node">
<title>L15_S1_TP7_GPU15_mha_res</title>
<polygon fill="none" stroke="black" points="145698.5,-948.5 144811.5,-948.5 144811.5,-880.5 145698.5,-880.5 145698.5,-948.5"/>
<text text-anchor="middle" x="145255" y="-933.3" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="145255" y="-918.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, head_dim=128], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="145255" y="-903.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="145255" y="-888.3" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP7_GPU15_mha_ar&#45;&gt;L15_S1_TP7_GPU15_mha_res -->
<g id="edge4714" class="edge">
<title>L15_S1_TP7_GPU15_mha_ar&#45;&gt;L15_S1_TP7_GPU15_mha_res</title>
<path fill="none" stroke="black" d="M144548.75,-1032C144788.22,-1032 145053.75,-1032 145053.75,-1032 145053.75,-1032 145053.75,-958.8 145053.75,-958.8"/>
<polygon fill="black" stroke="black" points="145057.25,-958.8 145053.75,-948.8 145050.25,-958.8 145057.25,-958.8"/>
</g>
<!-- L15_S1_TP7_GPU15_gate -->
<g id="node1671" class="node">
<title>L15_S1_TP7_GPU15_gate</title>
<polygon fill="none" stroke="black" points="145784.56,-844.5 144942.15,-844.5 144725.44,-708.5 145567.85,-708.5 145784.56,-844.5"/>
<text text-anchor="middle" x="145255" y="-795.3" font-family="Times,serif" font-size="14.00">MoE Gate (Top2)</text>
<text text-anchor="middle" x="145255" y="-780.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="145255" y="-765.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, top_k=2, expert_id=0..15]</text>
<text text-anchor="middle" x="145255" y="-750.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- L15_S1_TP7_GPU15_mha_res&#45;&gt;L15_S1_TP7_GPU15_gate -->
<g id="edge4715" class="edge">
<title>L15_S1_TP7_GPU15_mha_res&#45;&gt;L15_S1_TP7_GPU15_gate</title>
<path fill="none" stroke="black" d="M145255,-880.39C145255,-880.39 145255,-854.73 145255,-854.73"/>
<polygon fill="black" stroke="black" points="145258.5,-854.73 145255,-844.73 145251.5,-854.73 145258.5,-854.73"/>
</g>
<!-- L15_S1_TP7_GPU15_moe_res -->
<g id="node1673" class="node">
<title>L15_S1_TP7_GPU15_moe_res</title>
<polygon fill="none" stroke="black" points="144826,-436.33 144006,-436.33 144006,-368.33 144826,-368.33 144826,-436.33"/>
<text text-anchor="middle" x="144416" y="-421.13" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="144416" y="-406.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096], [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="144416" y="-391.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="144416" y="-376.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP7_GPU15_mha_res&#45;&gt;L15_S1_TP7_GPU15_moe_res -->
<g id="edge4735" class="edge">
<title>L15_S1_TP7_GPU15_mha_res&#45;&gt;L15_S1_TP7_GPU15_moe_res</title>
<path fill="none" stroke="black" d="M144811.43,-914C144754.73,-914 144716,-914 144716,-914 144716,-914 144716,-697 144716,-697 144716,-697 144751.5,-697 144751.5,-697 144751.5,-697 144751.5,-446.42 144751.5,-446.42"/>
<polygon fill="black" stroke="black" points="144755,-446.42 144751.5,-436.42 144748,-446.42 144755,-446.42"/>
</g>
<!-- L15_S1_TP7_GPU15_gate&#45;&gt;L15_S1_TP7_GPU15_expert0 -->
<g id="edge4716" class="edge">
<title>L15_S1_TP7_GPU15_gate&#45;&gt;L15_S1_TP7_GPU15_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M144733.86,-776.4C144733.86,-776.4 144733.86,-682.74 144733.86,-682.74"/>
<polygon fill="black" stroke="black" points="144737.36,-682.74 144733.86,-672.74 144730.36,-682.74 144737.36,-682.74"/>
</g>
<!-- L15_S1_TP7_GPU15_gate&#45;&gt;L15_S1_TP7_GPU15_expert1 -->
<g id="edge4717" class="edge">
<title>L15_S1_TP7_GPU15_gate&#45;&gt;L15_S1_TP7_GPU15_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M144985,-708.31C144985,-708.31 144985,-682.71 144985,-682.71"/>
<polygon fill="black" stroke="black" points="144988.5,-682.71 144985,-672.71 144981.5,-682.71 144988.5,-682.71"/>
</g>
<!-- L15_S1_TP7_GPU15_moe_ar&#45;&gt;L15_S1_TP7_GPU15_moe_res -->
<g id="edge4734" class="edge">
<title>L15_S1_TP7_GPU15_moe_ar&#45;&gt;L15_S1_TP7_GPU15_moe_res</title>
<path fill="none" stroke="black" d="M144113.73,-484.99C144113.73,-484.99 144113.73,-446.52 144113.73,-446.52"/>
<polygon fill="black" stroke="black" points="144117.23,-446.52 144113.73,-436.52 144110.23,-446.52 144117.23,-446.52"/>
</g>
<!-- L15_S1_TP7_GPU15_norm -->
<g id="node1674" class="node">
<title>L15_S1_TP7_GPU15_norm</title>
<polygon fill="none" stroke="black" points="144385.5,-332.33 143936.5,-332.33 143936.5,-264.33 144385.5,-264.33 144385.5,-332.33"/>
<text text-anchor="middle" x="144161" y="-317.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="144161" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="144161" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="144161" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: all stage 1</text>
</g>
<!-- L15_S1_TP7_GPU15_moe_res&#45;&gt;L15_S1_TP7_GPU15_norm -->
<g id="edge4736" class="edge">
<title>L15_S1_TP7_GPU15_moe_res&#45;&gt;L15_S1_TP7_GPU15_norm</title>
<path fill="none" stroke="black" d="M144195.75,-368.28C144195.75,-368.28 144195.75,-342.46 144195.75,-342.46"/>
<polygon fill="black" stroke="black" points="144199.25,-342.46 144195.75,-332.46 144192.25,-342.46 144199.25,-342.46"/>
</g>
<!-- L15_S1_TP7_GPU15_norm&#45;&gt;output -->
<g id="edge4744" class="edge">
<title>L15_S1_TP7_GPU15_norm&#45;&gt;output</title>
<path fill="none" stroke="black" d="M144161,-264.24C144161,-222.13 144161,-156 144161,-156 144161,-156 141767.32,-156 141767.32,-156"/>
<polygon fill="black" stroke="black" points="141767.32,-152.5 141757.32,-156 141767.32,-159.5 141767.32,-152.5"/>
</g>
</g>
</svg>
