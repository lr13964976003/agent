<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="15000pt" height="10812pt"
 viewBox="0.00 0.00 3600.00 2594.91" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.91 0.91) rotate(0) translate(4 11869.16)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-11869.16 16468,-11869.16 16468,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="8577" cy="-11827.68" rx="317.48" ry="37.45"/>
<text text-anchor="middle" x="8577" y="-11838.98" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="8577" y="-11823.98" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="8577" y="-11808.98" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
</g>
<!-- mha_layer0_gpu0 -->
<g id="node2" class="node">
<title>mha_layer0_gpu0</title>
<path fill="lightblue" stroke="black" d="M2120,-11754.21C2120,-11754.21 1672,-11754.21 1672,-11754.21 1666,-11754.21 1660,-11748.21 1660,-11742.21 1660,-11742.21 1660,-11713.21 1660,-11713.21 1660,-11707.21 1666,-11701.21 1672,-11701.21 1672,-11701.21 2120,-11701.21 2120,-11701.21 2126,-11701.21 2132,-11707.21 2132,-11713.21 2132,-11713.21 2132,-11742.21 2132,-11742.21 2132,-11748.21 2126,-11754.21 2120,-11754.21"/>
<text text-anchor="middle" x="1896" y="-11739.01" font-family="Times,serif" font-size="14.00">MHA Layer 0 GPU 0</text>
<text text-anchor="middle" x="1896" y="-11724.01" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1896" y="-11709.01" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- input&#45;&gt;mha_layer0_gpu0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;mha_layer0_gpu0</title>
<path fill="none" stroke="black" d="M8262.19,-11822.78C7446.69,-11812.57 5198.49,-11783.82 3326,-11754.21 2910.57,-11747.64 2427.28,-11738.76 2142.32,-11733.4"/>
<polygon fill="black" stroke="black" points="2142.33,-11729.9 2132.26,-11733.21 2142.2,-11736.9 2142.33,-11729.9"/>
</g>
<!-- mha_layer0_gpu1 -->
<g id="node3" class="node">
<title>mha_layer0_gpu1</title>
<path fill="lightblue" stroke="black" d="M3795,-11754.21C3795,-11754.21 3347,-11754.21 3347,-11754.21 3341,-11754.21 3335,-11748.21 3335,-11742.21 3335,-11742.21 3335,-11713.21 3335,-11713.21 3335,-11707.21 3341,-11701.21 3347,-11701.21 3347,-11701.21 3795,-11701.21 3795,-11701.21 3801,-11701.21 3807,-11707.21 3807,-11713.21 3807,-11713.21 3807,-11742.21 3807,-11742.21 3807,-11748.21 3801,-11754.21 3795,-11754.21"/>
<text text-anchor="middle" x="3571" y="-11739.01" font-family="Times,serif" font-size="14.00">MHA Layer 0 GPU 1</text>
<text text-anchor="middle" x="3571" y="-11724.01" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3571" y="-11709.01" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- input&#45;&gt;mha_layer0_gpu1 -->
<g id="edge2" class="edge">
<title>input&#45;&gt;mha_layer0_gpu1</title>
<path fill="none" stroke="black" d="M8262.2,-11822.62C7566.86,-11813.32 5847.46,-11788.64 4408,-11754.21 4209.41,-11749.46 3984.37,-11742.51 3817.68,-11737.07"/>
<polygon fill="black" stroke="black" points="3817.4,-11733.56 3807.29,-11736.73 3817.17,-11740.55 3817.4,-11733.56"/>
</g>
<!-- mha_layer0_gpu2 -->
<g id="node4" class="node">
<title>mha_layer0_gpu2</title>
<path fill="lightblue" stroke="black" d="M4877,-11754.21C4877,-11754.21 4429,-11754.21 4429,-11754.21 4423,-11754.21 4417,-11748.21 4417,-11742.21 4417,-11742.21 4417,-11713.21 4417,-11713.21 4417,-11707.21 4423,-11701.21 4429,-11701.21 4429,-11701.21 4877,-11701.21 4877,-11701.21 4883,-11701.21 4889,-11707.21 4889,-11713.21 4889,-11713.21 4889,-11742.21 4889,-11742.21 4889,-11748.21 4883,-11754.21 4877,-11754.21"/>
<text text-anchor="middle" x="4653" y="-11739.01" font-family="Times,serif" font-size="14.00">MHA Layer 0 GPU 2</text>
<text text-anchor="middle" x="4653" y="-11724.01" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4653" y="-11709.01" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- input&#45;&gt;mha_layer0_gpu2 -->
<g id="edge3" class="edge">
<title>input&#45;&gt;mha_layer0_gpu2</title>
<path fill="none" stroke="black" d="M8262.4,-11822.64C7664.49,-11814.36 6322.91,-11792.9 5194,-11754.21 5097.66,-11750.9 4991.73,-11746.16 4899.33,-11741.65"/>
<polygon fill="black" stroke="black" points="4899.45,-11738.15 4889.29,-11741.16 4899.1,-11745.15 4899.45,-11738.15"/>
</g>
<!-- mha_layer0_gpu3 -->
<g id="node5" class="node">
<title>mha_layer0_gpu3</title>
<path fill="lightblue" stroke="black" d="M5663,-11754.21C5663,-11754.21 5215,-11754.21 5215,-11754.21 5209,-11754.21 5203,-11748.21 5203,-11742.21 5203,-11742.21 5203,-11713.21 5203,-11713.21 5203,-11707.21 5209,-11701.21 5215,-11701.21 5215,-11701.21 5663,-11701.21 5663,-11701.21 5669,-11701.21 5675,-11707.21 5675,-11713.21 5675,-11713.21 5675,-11742.21 5675,-11742.21 5675,-11748.21 5669,-11754.21 5663,-11754.21"/>
<text text-anchor="middle" x="5439" y="-11739.01" font-family="Times,serif" font-size="14.00">MHA Layer 0 GPU 3</text>
<text text-anchor="middle" x="5439" y="-11724.01" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5439" y="-11709.01" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- input&#45;&gt;mha_layer0_gpu3 -->
<g id="edge4" class="edge">
<title>input&#45;&gt;mha_layer0_gpu3</title>
<path fill="none" stroke="black" d="M8262.7,-11822.31C7752.47,-11814.32 6712.29,-11794.37 5832,-11754.21 5784.47,-11752.04 5733.75,-11749.16 5685.08,-11746.13"/>
<polygon fill="black" stroke="black" points="5685.25,-11742.63 5675.05,-11745.5 5684.81,-11749.62 5685.25,-11742.63"/>
</g>
<!-- mha_layer0_gpu4 -->
<g id="node6" class="node">
<title>mha_layer0_gpu4</title>
<path fill="lightblue" stroke="black" d="M6301,-11754.21C6301,-11754.21 5853,-11754.21 5853,-11754.21 5847,-11754.21 5841,-11748.21 5841,-11742.21 5841,-11742.21 5841,-11713.21 5841,-11713.21 5841,-11707.21 5847,-11701.21 5853,-11701.21 5853,-11701.21 6301,-11701.21 6301,-11701.21 6307,-11701.21 6313,-11707.21 6313,-11713.21 6313,-11713.21 6313,-11742.21 6313,-11742.21 6313,-11748.21 6307,-11754.21 6301,-11754.21"/>
<text text-anchor="middle" x="6077" y="-11739.01" font-family="Times,serif" font-size="14.00">MHA Layer 0 GPU 4</text>
<text text-anchor="middle" x="6077" y="-11724.01" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6077" y="-11709.01" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- input&#45;&gt;mha_layer0_gpu4 -->
<g id="edge5" class="edge">
<title>input&#45;&gt;mha_layer0_gpu4</title>
<path fill="none" stroke="black" d="M8264.38,-11820.87C7840.72,-11811.94 7060.78,-11791.8 6396,-11754.21 6372.48,-11752.88 6347.99,-11751.29 6323.51,-11749.56"/>
<polygon fill="black" stroke="black" points="6323.62,-11746.06 6313.4,-11748.84 6323.12,-11753.04 6323.62,-11746.06"/>
</g>
<!-- mha_layer0_gpu5 -->
<g id="node7" class="node">
<title>mha_layer0_gpu5</title>
<path fill="lightblue" stroke="black" d="M6865,-11754.21C6865,-11754.21 6417,-11754.21 6417,-11754.21 6411,-11754.21 6405,-11748.21 6405,-11742.21 6405,-11742.21 6405,-11713.21 6405,-11713.21 6405,-11707.21 6411,-11701.21 6417,-11701.21 6417,-11701.21 6865,-11701.21 6865,-11701.21 6871,-11701.21 6877,-11707.21 6877,-11713.21 6877,-11713.21 6877,-11742.21 6877,-11742.21 6877,-11748.21 6871,-11754.21 6865,-11754.21"/>
<text text-anchor="middle" x="6641" y="-11739.01" font-family="Times,serif" font-size="14.00">MHA Layer 0 GPU 5</text>
<text text-anchor="middle" x="6641" y="-11724.01" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6641" y="-11709.01" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- input&#45;&gt;mha_layer0_gpu5 -->
<g id="edge6" class="edge">
<title>input&#45;&gt;mha_layer0_gpu5</title>
<path fill="none" stroke="black" d="M8288.21,-11812.07C7907.78,-11792.82 7245.22,-11759.28 6887.3,-11741.17"/>
<polygon fill="black" stroke="black" points="6887.22,-11737.66 6877.06,-11740.65 6886.87,-11744.65 6887.22,-11737.66"/>
</g>
<!-- mha_layer0_gpu6 -->
<g id="node8" class="node">
<title>mha_layer0_gpu6</title>
<path fill="lightblue" stroke="black" d="M7829,-11754.21C7829,-11754.21 7381,-11754.21 7381,-11754.21 7375,-11754.21 7369,-11748.21 7369,-11742.21 7369,-11742.21 7369,-11713.21 7369,-11713.21 7369,-11707.21 7375,-11701.21 7381,-11701.21 7381,-11701.21 7829,-11701.21 7829,-11701.21 7835,-11701.21 7841,-11707.21 7841,-11713.21 7841,-11713.21 7841,-11742.21 7841,-11742.21 7841,-11748.21 7835,-11754.21 7829,-11754.21"/>
<text text-anchor="middle" x="7605" y="-11739.01" font-family="Times,serif" font-size="14.00">MHA Layer 0 GPU 6</text>
<text text-anchor="middle" x="7605" y="-11724.01" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7605" y="-11709.01" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- input&#45;&gt;mha_layer0_gpu6 -->
<g id="edge7" class="edge">
<title>input&#45;&gt;mha_layer0_gpu6</title>
<path fill="none" stroke="black" d="M8339.53,-11802.75C8191.47,-11787.82 8001.31,-11768.65 7851.57,-11753.56"/>
<polygon fill="black" stroke="black" points="7851.61,-11750.05 7841.31,-11752.53 7850.91,-11757.01 7851.61,-11750.05"/>
</g>
<!-- mha_layer0_gpu7 -->
<g id="node9" class="node">
<title>mha_layer0_gpu7</title>
<path fill="lightblue" stroke="black" d="M8556,-11754.21C8556,-11754.21 8108,-11754.21 8108,-11754.21 8102,-11754.21 8096,-11748.21 8096,-11742.21 8096,-11742.21 8096,-11713.21 8096,-11713.21 8096,-11707.21 8102,-11701.21 8108,-11701.21 8108,-11701.21 8556,-11701.21 8556,-11701.21 8562,-11701.21 8568,-11707.21 8568,-11713.21 8568,-11713.21 8568,-11742.21 8568,-11742.21 8568,-11748.21 8562,-11754.21 8556,-11754.21"/>
<text text-anchor="middle" x="8332" y="-11739.01" font-family="Times,serif" font-size="14.00">MHA Layer 0 GPU 7</text>
<text text-anchor="middle" x="8332" y="-11724.01" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8332" y="-11709.01" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- input&#45;&gt;mha_layer0_gpu7 -->
<g id="edge8" class="edge">
<title>input&#45;&gt;mha_layer0_gpu7</title>
<path fill="none" stroke="black" d="M8489.24,-11791.59C8461.85,-11780.63 8431.93,-11768.67 8405.61,-11758.14"/>
<polygon fill="black" stroke="black" points="8406.68,-11754.8 8396.09,-11754.34 8404.08,-11761.3 8406.68,-11754.8"/>
</g>
<!-- mha_layer0_gpu8 -->
<g id="node10" class="node">
<title>mha_layer0_gpu8</title>
<path fill="lightblue" stroke="black" d="M9283,-11754.21C9283,-11754.21 8835,-11754.21 8835,-11754.21 8829,-11754.21 8823,-11748.21 8823,-11742.21 8823,-11742.21 8823,-11713.21 8823,-11713.21 8823,-11707.21 8829,-11701.21 8835,-11701.21 8835,-11701.21 9283,-11701.21 9283,-11701.21 9289,-11701.21 9295,-11707.21 9295,-11713.21 9295,-11713.21 9295,-11742.21 9295,-11742.21 9295,-11748.21 9289,-11754.21 9283,-11754.21"/>
<text text-anchor="middle" x="9059" y="-11739.01" font-family="Times,serif" font-size="14.00">MHA Layer 0 GPU 8</text>
<text text-anchor="middle" x="9059" y="-11724.01" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9059" y="-11709.01" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- input&#45;&gt;mha_layer0_gpu8 -->
<g id="edge9" class="edge">
<title>input&#45;&gt;mha_layer0_gpu8</title>
<path fill="none" stroke="black" d="M8732.83,-11795.01C8794.31,-11782.51 8864.29,-11768.29 8923.62,-11756.23"/>
<polygon fill="black" stroke="black" points="8924.32,-11759.65 8933.43,-11754.23 8922.93,-11752.79 8924.32,-11759.65"/>
</g>
<!-- mha_layer0_gpu9 -->
<g id="node11" class="node">
<title>mha_layer0_gpu9</title>
<path fill="lightblue" stroke="black" d="M10128,-11754.21C10128,-11754.21 9680,-11754.21 9680,-11754.21 9674,-11754.21 9668,-11748.21 9668,-11742.21 9668,-11742.21 9668,-11713.21 9668,-11713.21 9668,-11707.21 9674,-11701.21 9680,-11701.21 9680,-11701.21 10128,-11701.21 10128,-11701.21 10134,-11701.21 10140,-11707.21 10140,-11713.21 10140,-11713.21 10140,-11742.21 10140,-11742.21 10140,-11748.21 10134,-11754.21 10128,-11754.21"/>
<text text-anchor="middle" x="9904" y="-11739.01" font-family="Times,serif" font-size="14.00">MHA Layer 0 GPU 9</text>
<text text-anchor="middle" x="9904" y="-11724.01" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9904" y="-11709.01" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- input&#45;&gt;mha_layer0_gpu9 -->
<g id="edge10" class="edge">
<title>input&#45;&gt;mha_layer0_gpu9</title>
<path fill="none" stroke="black" d="M8842.35,-11807.09C9080,-11789.55 9425.79,-11764.01 9657.49,-11746.91"/>
<polygon fill="black" stroke="black" points="9658.03,-11750.38 9667.75,-11746.15 9657.52,-11743.4 9658.03,-11750.38"/>
</g>
<!-- mha_layer0_gpu10 -->
<g id="node12" class="node">
<title>mha_layer0_gpu10</title>
<path fill="lightblue" stroke="black" d="M11033,-11754.21C11033,-11754.21 10585,-11754.21 10585,-11754.21 10579,-11754.21 10573,-11748.21 10573,-11742.21 10573,-11742.21 10573,-11713.21 10573,-11713.21 10573,-11707.21 10579,-11701.21 10585,-11701.21 10585,-11701.21 11033,-11701.21 11033,-11701.21 11039,-11701.21 11045,-11707.21 11045,-11713.21 11045,-11713.21 11045,-11742.21 11045,-11742.21 11045,-11748.21 11039,-11754.21 11033,-11754.21"/>
<text text-anchor="middle" x="10809" y="-11739.01" font-family="Times,serif" font-size="14.00">MHA Layer 0 GPU 10</text>
<text text-anchor="middle" x="10809" y="-11724.01" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10809" y="-11709.01" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- input&#45;&gt;mha_layer0_gpu10 -->
<g id="edge11" class="edge">
<title>input&#45;&gt;mha_layer0_gpu10</title>
<path fill="none" stroke="black" d="M8871.95,-11813.74C9316.25,-11794.23 10149.13,-11757.67 10562.83,-11739.51"/>
<polygon fill="black" stroke="black" points="10562.99,-11743.01 10572.82,-11739.07 10562.68,-11736.02 10562.99,-11743.01"/>
</g>
<!-- mha_layer0_gpu11 -->
<g id="node13" class="node">
<title>mha_layer0_gpu11</title>
<path fill="lightblue" stroke="black" d="M11967,-11754.21C11967,-11754.21 11519,-11754.21 11519,-11754.21 11513,-11754.21 11507,-11748.21 11507,-11742.21 11507,-11742.21 11507,-11713.21 11507,-11713.21 11507,-11707.21 11513,-11701.21 11519,-11701.21 11519,-11701.21 11967,-11701.21 11967,-11701.21 11973,-11701.21 11979,-11707.21 11979,-11713.21 11979,-11713.21 11979,-11742.21 11979,-11742.21 11979,-11748.21 11973,-11754.21 11967,-11754.21"/>
<text text-anchor="middle" x="11743" y="-11739.01" font-family="Times,serif" font-size="14.00">MHA Layer 0 GPU 11</text>
<text text-anchor="middle" x="11743" y="-11724.01" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11743" y="-11709.01" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- input&#45;&gt;mha_layer0_gpu11 -->
<g id="edge12" class="edge">
<title>input&#45;&gt;mha_layer0_gpu11</title>
<path fill="none" stroke="black" d="M8884.99,-11818.44C9353.42,-11805.72 10273.04,-11780.08 11054,-11754.21 11200.77,-11749.34 11365.09,-11743.29 11496.45,-11738.29"/>
<polygon fill="black" stroke="black" points="11496.79,-11741.78 11506.65,-11737.91 11496.52,-11734.79 11496.79,-11741.78"/>
</g>
<!-- mha_layer0_gpu12 -->
<g id="node14" class="node">
<title>mha_layer0_gpu12</title>
<path fill="lightblue" stroke="black" d="M12916,-11754.21C12916,-11754.21 12468,-11754.21 12468,-11754.21 12462,-11754.21 12456,-11748.21 12456,-11742.21 12456,-11742.21 12456,-11713.21 12456,-11713.21 12456,-11707.21 12462,-11701.21 12468,-11701.21 12468,-11701.21 12916,-11701.21 12916,-11701.21 12922,-11701.21 12928,-11707.21 12928,-11713.21 12928,-11713.21 12928,-11742.21 12928,-11742.21 12928,-11748.21 12922,-11754.21 12916,-11754.21"/>
<text text-anchor="middle" x="12692" y="-11739.01" font-family="Times,serif" font-size="14.00">MHA Layer 0 GPU 12</text>
<text text-anchor="middle" x="12692" y="-11724.01" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12692" y="-11709.01" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- input&#45;&gt;mha_layer0_gpu12 -->
<g id="edge13" class="edge">
<title>input&#45;&gt;mha_layer0_gpu12</title>
<path fill="none" stroke="black" d="M8890.36,-11821.59C9491.25,-11811.48 10847.14,-11786.99 11988,-11754.21 12140.07,-11749.84 12310.56,-11743.69 12445.68,-11738.53"/>
<polygon fill="black" stroke="black" points="12445.9,-11742.03 12455.76,-11738.15 12445.63,-11735.03 12445.9,-11742.03"/>
</g>
<!-- mha_layer0_gpu13 -->
<g id="node15" class="node">
<title>mha_layer0_gpu13</title>
<path fill="lightblue" stroke="black" d="M13873,-11754.21C13873,-11754.21 13425,-11754.21 13425,-11754.21 13419,-11754.21 13413,-11748.21 13413,-11742.21 13413,-11742.21 13413,-11713.21 13413,-11713.21 13413,-11707.21 13419,-11701.21 13425,-11701.21 13425,-11701.21 13873,-11701.21 13873,-11701.21 13879,-11701.21 13885,-11707.21 13885,-11713.21 13885,-11713.21 13885,-11742.21 13885,-11742.21 13885,-11748.21 13879,-11754.21 13873,-11754.21"/>
<text text-anchor="middle" x="13649" y="-11739.01" font-family="Times,serif" font-size="14.00">MHA Layer 0 GPU 13</text>
<text text-anchor="middle" x="13649" y="-11724.01" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13649" y="-11709.01" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- input&#45;&gt;mha_layer0_gpu13 -->
<g id="edge14" class="edge">
<title>input&#45;&gt;mha_layer0_gpu13</title>
<path fill="none" stroke="black" d="M8892.66,-11823.51C9610.85,-11815.84 11422.24,-11793.92 12937,-11754.21 13091.86,-11750.15 13265.6,-11743.96 13402.7,-11738.69"/>
<polygon fill="black" stroke="black" points="13403.06,-11742.18 13412.92,-11738.3 13402.79,-11735.18 13403.06,-11742.18"/>
</g>
<!-- mha_layer0_gpu14 -->
<g id="node16" class="node">
<title>mha_layer0_gpu14</title>
<path fill="lightblue" stroke="black" d="M14833,-11754.21C14833,-11754.21 14385,-11754.21 14385,-11754.21 14379,-11754.21 14373,-11748.21 14373,-11742.21 14373,-11742.21 14373,-11713.21 14373,-11713.21 14373,-11707.21 14379,-11701.21 14385,-11701.21 14385,-11701.21 14833,-11701.21 14833,-11701.21 14839,-11701.21 14845,-11707.21 14845,-11713.21 14845,-11713.21 14845,-11742.21 14845,-11742.21 14845,-11748.21 14839,-11754.21 14833,-11754.21"/>
<text text-anchor="middle" x="14609" y="-11739.01" font-family="Times,serif" font-size="14.00">MHA Layer 0 GPU 14</text>
<text text-anchor="middle" x="14609" y="-11724.01" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14609" y="-11709.01" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- input&#45;&gt;mha_layer0_gpu14 -->
<g id="edge15" class="edge">
<title>input&#45;&gt;mha_layer0_gpu14</title>
<path fill="none" stroke="black" d="M8893.92,-11824.8C9718.18,-11819.36 11996.87,-11800.96 13894,-11754.21 14049.82,-11750.37 14224.67,-11744.16 14362.47,-11738.84"/>
<polygon fill="black" stroke="black" points="14362.88,-11742.32 14372.74,-11738.44 14362.61,-11735.33 14362.88,-11742.32"/>
</g>
<!-- mha_layer0_gpu15 -->
<g id="node17" class="node">
<title>mha_layer0_gpu15</title>
<path fill="lightblue" stroke="black" d="M15795,-11754.21C15795,-11754.21 15347,-11754.21 15347,-11754.21 15341,-11754.21 15335,-11748.21 15335,-11742.21 15335,-11742.21 15335,-11713.21 15335,-11713.21 15335,-11707.21 15341,-11701.21 15347,-11701.21 15347,-11701.21 15795,-11701.21 15795,-11701.21 15801,-11701.21 15807,-11707.21 15807,-11713.21 15807,-11713.21 15807,-11742.21 15807,-11742.21 15807,-11748.21 15801,-11754.21 15795,-11754.21"/>
<text text-anchor="middle" x="15571" y="-11739.01" font-family="Times,serif" font-size="14.00">MHA Layer 0 GPU 15</text>
<text text-anchor="middle" x="15571" y="-11724.01" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="15571" y="-11709.01" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- input&#45;&gt;mha_layer0_gpu15 -->
<g id="edge16" class="edge">
<title>input&#45;&gt;mha_layer0_gpu15</title>
<path fill="none" stroke="black" d="M8894.25,-11825.71C9815.26,-11822.3 12569.06,-11808.02 14854,-11754.21 15010.56,-11750.52 15186.28,-11744.3 15324.58,-11738.93"/>
<polygon fill="black" stroke="black" points="15325.04,-11742.42 15334.9,-11738.53 15324.77,-11735.42 15325.04,-11742.42"/>
</g>
<!-- gate_layer0_gpu0 -->
<g id="node18" class="node">
<title>gate_layer0_gpu0</title>
<path fill="lightsteelblue" stroke="black" d="M1454.07,-11663.87C1454.07,-11663.87 1004.93,-11613.54 1004.93,-11613.54 998.96,-11612.87 998.96,-11611.54 1004.93,-11610.87 1004.93,-11610.87 1454.07,-11560.54 1454.07,-11560.54 1460.04,-11559.87 1471.96,-11559.87 1477.93,-11560.54 1477.93,-11560.54 1927.07,-11610.87 1927.07,-11610.87 1933.04,-11611.54 1933.04,-11612.87 1927.07,-11613.54 1927.07,-11613.54 1477.93,-11663.87 1477.93,-11663.87 1471.96,-11664.54 1460.04,-11664.54 1454.07,-11663.87"/>
<text text-anchor="middle" x="1466" y="-11623.51" font-family="Times,serif" font-size="14.00">Gate Layer 0 GPU 0</text>
<text text-anchor="middle" x="1466" y="-11608.51" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="1466" y="-11593.51" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer0_gpu0&#45;&gt;gate_layer0_gpu0 -->
<g id="edge17" class="edge">
<title>mha_layer0_gpu0&#45;&gt;gate_layer0_gpu0</title>
<path fill="none" stroke="black" d="M1799.23,-11701.16C1744.69,-11686.77 1675.42,-11668.48 1614.18,-11652.32"/>
<polygon fill="black" stroke="black" points="1614.99,-11648.91 1604.43,-11649.74 1613.2,-11655.68 1614.99,-11648.91"/>
</g>
<!-- gate_layer0_gpu1 -->
<g id="node19" class="node">
<title>gate_layer0_gpu1</title>
<path fill="lightsteelblue" stroke="black" d="M2418.07,-11663.87C2418.07,-11663.87 1968.93,-11613.54 1968.93,-11613.54 1962.96,-11612.87 1962.96,-11611.54 1968.93,-11610.87 1968.93,-11610.87 2418.07,-11560.54 2418.07,-11560.54 2424.04,-11559.87 2435.96,-11559.87 2441.93,-11560.54 2441.93,-11560.54 2891.07,-11610.87 2891.07,-11610.87 2897.04,-11611.54 2897.04,-11612.87 2891.07,-11613.54 2891.07,-11613.54 2441.93,-11663.87 2441.93,-11663.87 2435.96,-11664.54 2424.04,-11664.54 2418.07,-11663.87"/>
<text text-anchor="middle" x="2430" y="-11623.51" font-family="Times,serif" font-size="14.00">Gate Layer 0 GPU 1</text>
<text text-anchor="middle" x="2430" y="-11608.51" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="2430" y="-11593.51" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer0_gpu1&#45;&gt;gate_layer0_gpu1 -->
<g id="edge18" class="edge">
<title>mha_layer0_gpu1&#45;&gt;gate_layer0_gpu1</title>
<path fill="none" stroke="black" d="M3334.92,-11705.51C3209.29,-11694.01 3052.2,-11679.31 2912,-11665.21 2834.46,-11657.41 2749.96,-11648.45 2673.67,-11640.18"/>
<polygon fill="black" stroke="black" points="2673.76,-11636.67 2663.44,-11639.08 2673.01,-11643.63 2673.76,-11636.67"/>
</g>
<!-- gate_layer0_gpu2 -->
<g id="node20" class="node">
<title>gate_layer0_gpu2</title>
<path fill="lightsteelblue" stroke="black" d="M3382.07,-11663.87C3382.07,-11663.87 2932.93,-11613.54 2932.93,-11613.54 2926.96,-11612.87 2926.96,-11611.54 2932.93,-11610.87 2932.93,-11610.87 3382.07,-11560.54 3382.07,-11560.54 3388.04,-11559.87 3399.96,-11559.87 3405.93,-11560.54 3405.93,-11560.54 3855.07,-11610.87 3855.07,-11610.87 3861.04,-11611.54 3861.04,-11612.87 3855.07,-11613.54 3855.07,-11613.54 3405.93,-11663.87 3405.93,-11663.87 3399.96,-11664.54 3388.04,-11664.54 3382.07,-11663.87"/>
<text text-anchor="middle" x="3394" y="-11623.51" font-family="Times,serif" font-size="14.00">Gate Layer 0 GPU 2</text>
<text text-anchor="middle" x="3394" y="-11608.51" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="3394" y="-11593.51" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer0_gpu2&#45;&gt;gate_layer0_gpu2 -->
<g id="edge19" class="edge">
<title>mha_layer0_gpu2&#45;&gt;gate_layer0_gpu2</title>
<path fill="none" stroke="black" d="M4416.95,-11709.78C4262.87,-11698.3 4057.38,-11682.17 3876,-11665.21 3797.4,-11657.86 3711.7,-11648.91 3634.65,-11640.53"/>
<polygon fill="black" stroke="black" points="3634.65,-11637.01 3624.33,-11639.4 3633.89,-11643.97 3634.65,-11637.01"/>
</g>
<!-- gate_layer0_gpu3 -->
<g id="node21" class="node">
<title>gate_layer0_gpu3</title>
<path fill="lightsteelblue" stroke="black" d="M4346.07,-11663.87C4346.07,-11663.87 3896.93,-11613.54 3896.93,-11613.54 3890.96,-11612.87 3890.96,-11611.54 3896.93,-11610.87 3896.93,-11610.87 4346.07,-11560.54 4346.07,-11560.54 4352.04,-11559.87 4363.96,-11559.87 4369.93,-11560.54 4369.93,-11560.54 4819.07,-11610.87 4819.07,-11610.87 4825.04,-11611.54 4825.04,-11612.87 4819.07,-11613.54 4819.07,-11613.54 4369.93,-11663.87 4369.93,-11663.87 4363.96,-11664.54 4352.04,-11664.54 4346.07,-11663.87"/>
<text text-anchor="middle" x="4358" y="-11623.51" font-family="Times,serif" font-size="14.00">Gate Layer 0 GPU 3</text>
<text text-anchor="middle" x="4358" y="-11608.51" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4358" y="-11593.51" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer0_gpu3&#45;&gt;gate_layer0_gpu3 -->
<g id="edge20" class="edge">
<title>mha_layer0_gpu3&#45;&gt;gate_layer0_gpu3</title>
<path fill="none" stroke="black" d="M5202.84,-11702.74C5092.58,-11691.48 4959.56,-11677.79 4840,-11665.21 4763.1,-11657.11 4679.31,-11648.13 4603.49,-11639.94"/>
<polygon fill="black" stroke="black" points="4603.64,-11636.43 4593.33,-11638.84 4602.89,-11643.39 4603.64,-11636.43"/>
</g>
<!-- gate_layer0_gpu4 -->
<g id="node22" class="node">
<title>gate_layer0_gpu4</title>
<path fill="lightsteelblue" stroke="black" d="M5310.07,-11663.87C5310.07,-11663.87 4860.93,-11613.54 4860.93,-11613.54 4854.96,-11612.87 4854.96,-11611.54 4860.93,-11610.87 4860.93,-11610.87 5310.07,-11560.54 5310.07,-11560.54 5316.04,-11559.87 5327.96,-11559.87 5333.93,-11560.54 5333.93,-11560.54 5783.07,-11610.87 5783.07,-11610.87 5789.04,-11611.54 5789.04,-11612.87 5783.07,-11613.54 5783.07,-11613.54 5333.93,-11663.87 5333.93,-11663.87 5327.96,-11664.54 5316.04,-11664.54 5310.07,-11663.87"/>
<text text-anchor="middle" x="5322" y="-11623.51" font-family="Times,serif" font-size="14.00">Gate Layer 0 GPU 4</text>
<text text-anchor="middle" x="5322" y="-11608.51" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5322" y="-11593.51" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer0_gpu4&#45;&gt;gate_layer0_gpu4 -->
<g id="edge21" class="edge">
<title>mha_layer0_gpu4&#45;&gt;gate_layer0_gpu4</title>
<path fill="none" stroke="black" d="M5907.09,-11701.16C5795.54,-11684.39 5648.88,-11662.35 5530.31,-11644.52"/>
<polygon fill="black" stroke="black" points="5530.79,-11641.05 5520.38,-11643.03 5529.75,-11647.98 5530.79,-11641.05"/>
</g>
<!-- gate_layer0_gpu5 -->
<g id="node23" class="node">
<title>gate_layer0_gpu5</title>
<path fill="lightsteelblue" stroke="black" d="M6274.07,-11663.87C6274.07,-11663.87 5824.93,-11613.54 5824.93,-11613.54 5818.96,-11612.87 5818.96,-11611.54 5824.93,-11610.87 5824.93,-11610.87 6274.07,-11560.54 6274.07,-11560.54 6280.04,-11559.87 6291.96,-11559.87 6297.93,-11560.54 6297.93,-11560.54 6747.07,-11610.87 6747.07,-11610.87 6753.04,-11611.54 6753.04,-11612.87 6747.07,-11613.54 6747.07,-11613.54 6297.93,-11663.87 6297.93,-11663.87 6291.96,-11664.54 6280.04,-11664.54 6274.07,-11663.87"/>
<text text-anchor="middle" x="6286" y="-11623.51" font-family="Times,serif" font-size="14.00">Gate Layer 0 GPU 5</text>
<text text-anchor="middle" x="6286" y="-11608.51" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6286" y="-11593.51" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer0_gpu5&#45;&gt;gate_layer0_gpu5 -->
<g id="edge22" class="edge">
<title>mha_layer0_gpu5&#45;&gt;gate_layer0_gpu5</title>
<path fill="none" stroke="black" d="M6560.89,-11701.09C6518.23,-11687.45 6464.71,-11670.34 6416.25,-11654.85"/>
<polygon fill="black" stroke="black" points="6417.22,-11651.48 6406.63,-11651.77 6415.09,-11658.15 6417.22,-11651.48"/>
</g>
<!-- gate_layer0_gpu6 -->
<g id="node24" class="node">
<title>gate_layer0_gpu6</title>
<path fill="lightsteelblue" stroke="black" d="M7238.07,-11663.87C7238.07,-11663.87 6788.93,-11613.54 6788.93,-11613.54 6782.96,-11612.87 6782.96,-11611.54 6788.93,-11610.87 6788.93,-11610.87 7238.07,-11560.54 7238.07,-11560.54 7244.04,-11559.87 7255.96,-11559.87 7261.93,-11560.54 7261.93,-11560.54 7711.07,-11610.87 7711.07,-11610.87 7717.04,-11611.54 7717.04,-11612.87 7711.07,-11613.54 7711.07,-11613.54 7261.93,-11663.87 7261.93,-11663.87 7255.96,-11664.54 7244.04,-11664.54 7238.07,-11663.87"/>
<text text-anchor="middle" x="7250" y="-11623.51" font-family="Times,serif" font-size="14.00">Gate Layer 0 GPU 6</text>
<text text-anchor="middle" x="7250" y="-11608.51" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="7250" y="-11593.51" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer0_gpu6&#45;&gt;gate_layer0_gpu6 -->
<g id="edge23" class="edge">
<title>mha_layer0_gpu6&#45;&gt;gate_layer0_gpu6</title>
<path fill="none" stroke="black" d="M7524.89,-11701.09C7482.23,-11687.45 7428.71,-11670.34 7380.25,-11654.85"/>
<polygon fill="black" stroke="black" points="7381.22,-11651.48 7370.63,-11651.77 7379.09,-11658.15 7381.22,-11651.48"/>
</g>
<!-- gate_layer0_gpu7 -->
<g id="node25" class="node">
<title>gate_layer0_gpu7</title>
<path fill="lightsteelblue" stroke="black" d="M8202.07,-11663.87C8202.07,-11663.87 7752.93,-11613.54 7752.93,-11613.54 7746.96,-11612.87 7746.96,-11611.54 7752.93,-11610.87 7752.93,-11610.87 8202.07,-11560.54 8202.07,-11560.54 8208.04,-11559.87 8219.96,-11559.87 8225.93,-11560.54 8225.93,-11560.54 8675.07,-11610.87 8675.07,-11610.87 8681.04,-11611.54 8681.04,-11612.87 8675.07,-11613.54 8675.07,-11613.54 8225.93,-11663.87 8225.93,-11663.87 8219.96,-11664.54 8208.04,-11664.54 8202.07,-11663.87"/>
<text text-anchor="middle" x="8214" y="-11623.51" font-family="Times,serif" font-size="14.00">Gate Layer 0 GPU 7</text>
<text text-anchor="middle" x="8214" y="-11608.51" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="8214" y="-11593.51" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer0_gpu7&#45;&gt;gate_layer0_gpu7 -->
<g id="edge24" class="edge">
<title>mha_layer0_gpu7&#45;&gt;gate_layer0_gpu7</title>
<path fill="none" stroke="black" d="M8305.22,-11700.95C8294.65,-11690.78 8282.09,-11678.7 8269.72,-11666.8"/>
<polygon fill="black" stroke="black" points="8272.1,-11664.24 8262.47,-11659.83 8267.25,-11669.28 8272.1,-11664.24"/>
</g>
<!-- gate_layer0_gpu8 -->
<g id="node26" class="node">
<title>gate_layer0_gpu8</title>
<path fill="lightsteelblue" stroke="black" d="M9166.07,-11663.87C9166.07,-11663.87 8716.93,-11613.54 8716.93,-11613.54 8710.96,-11612.87 8710.96,-11611.54 8716.93,-11610.87 8716.93,-11610.87 9166.07,-11560.54 9166.07,-11560.54 9172.04,-11559.87 9183.96,-11559.87 9189.93,-11560.54 9189.93,-11560.54 9639.07,-11610.87 9639.07,-11610.87 9645.04,-11611.54 9645.04,-11612.87 9639.07,-11613.54 9639.07,-11613.54 9189.93,-11663.87 9189.93,-11663.87 9183.96,-11664.54 9172.04,-11664.54 9166.07,-11663.87"/>
<text text-anchor="middle" x="9178" y="-11623.51" font-family="Times,serif" font-size="14.00">Gate Layer 0 GPU 8</text>
<text text-anchor="middle" x="9178" y="-11608.51" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="9178" y="-11593.51" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer0_gpu8&#45;&gt;gate_layer0_gpu8 -->
<g id="edge25" class="edge">
<title>mha_layer0_gpu8&#45;&gt;gate_layer0_gpu8</title>
<path fill="none" stroke="black" d="M9086,-11700.95C9096.67,-11690.78 9109.34,-11678.7 9121.81,-11666.8"/>
<polygon fill="black" stroke="black" points="9124.3,-11669.26 9129.12,-11659.83 9119.47,-11664.2 9124.3,-11669.26"/>
</g>
<!-- gate_layer0_gpu9 -->
<g id="node27" class="node">
<title>gate_layer0_gpu9</title>
<path fill="lightsteelblue" stroke="black" d="M10130.07,-11663.87C10130.07,-11663.87 9680.93,-11613.54 9680.93,-11613.54 9674.96,-11612.87 9674.96,-11611.54 9680.93,-11610.87 9680.93,-11610.87 10130.07,-11560.54 10130.07,-11560.54 10136.04,-11559.87 10147.96,-11559.87 10153.93,-11560.54 10153.93,-11560.54 10603.07,-11610.87 10603.07,-11610.87 10609.04,-11611.54 10609.04,-11612.87 10603.07,-11613.54 10603.07,-11613.54 10153.93,-11663.87 10153.93,-11663.87 10147.96,-11664.54 10136.04,-11664.54 10130.07,-11663.87"/>
<text text-anchor="middle" x="10142" y="-11623.51" font-family="Times,serif" font-size="14.00">Gate Layer 0 GPU 9</text>
<text text-anchor="middle" x="10142" y="-11608.51" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="10142" y="-11593.51" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer0_gpu9&#45;&gt;gate_layer0_gpu9 -->
<g id="edge26" class="edge">
<title>mha_layer0_gpu9&#45;&gt;gate_layer0_gpu9</title>
<path fill="none" stroke="black" d="M9957.71,-11701.09C9983.3,-11688.89 10014.74,-11673.9 10044.34,-11659.78"/>
<polygon fill="black" stroke="black" points="10045.95,-11662.89 10053.47,-11655.43 10042.93,-11656.57 10045.95,-11662.89"/>
</g>
<!-- gate_layer0_gpu10 -->
<g id="node28" class="node">
<title>gate_layer0_gpu10</title>
<path fill="lightsteelblue" stroke="black" d="M11094.07,-11663.87C11094.07,-11663.87 10644.93,-11613.54 10644.93,-11613.54 10638.96,-11612.87 10638.96,-11611.54 10644.93,-11610.87 10644.93,-11610.87 11094.07,-11560.54 11094.07,-11560.54 11100.04,-11559.87 11111.96,-11559.87 11117.93,-11560.54 11117.93,-11560.54 11567.07,-11610.87 11567.07,-11610.87 11573.04,-11611.54 11573.04,-11612.87 11567.07,-11613.54 11567.07,-11613.54 11117.93,-11663.87 11117.93,-11663.87 11111.96,-11664.54 11100.04,-11664.54 11094.07,-11663.87"/>
<text text-anchor="middle" x="11106" y="-11623.51" font-family="Times,serif" font-size="14.00">Gate Layer 0 GPU 10</text>
<text text-anchor="middle" x="11106" y="-11608.51" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11106" y="-11593.51" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer0_gpu10&#45;&gt;gate_layer0_gpu10 -->
<g id="edge27" class="edge">
<title>mha_layer0_gpu10&#45;&gt;gate_layer0_gpu10</title>
<path fill="none" stroke="black" d="M10876.02,-11701.09C10909.93,-11688.13 10952.05,-11672.04 10990.94,-11657.18"/>
<polygon fill="black" stroke="black" points="10992.66,-11660.27 11000.76,-11653.43 10990.17,-11653.73 10992.66,-11660.27"/>
</g>
<!-- gate_layer0_gpu11 -->
<g id="node29" class="node">
<title>gate_layer0_gpu11</title>
<path fill="lightsteelblue" stroke="black" d="M12058.07,-11663.87C12058.07,-11663.87 11608.93,-11613.54 11608.93,-11613.54 11602.96,-11612.87 11602.96,-11611.54 11608.93,-11610.87 11608.93,-11610.87 12058.07,-11560.54 12058.07,-11560.54 12064.04,-11559.87 12075.96,-11559.87 12081.93,-11560.54 12081.93,-11560.54 12531.07,-11610.87 12531.07,-11610.87 12537.04,-11611.54 12537.04,-11612.87 12531.07,-11613.54 12531.07,-11613.54 12081.93,-11663.87 12081.93,-11663.87 12075.96,-11664.54 12064.04,-11664.54 12058.07,-11663.87"/>
<text text-anchor="middle" x="12070" y="-11623.51" font-family="Times,serif" font-size="14.00">Gate Layer 0 GPU 11</text>
<text text-anchor="middle" x="12070" y="-11608.51" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="12070" y="-11593.51" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer0_gpu11&#45;&gt;gate_layer0_gpu11 -->
<g id="edge28" class="edge">
<title>mha_layer0_gpu11&#45;&gt;gate_layer0_gpu11</title>
<path fill="none" stroke="black" d="M11816.79,-11701.09C11855.23,-11687.75 11903.24,-11671.09 11947.09,-11655.87"/>
<polygon fill="black" stroke="black" points="11948.37,-11659.13 11956.67,-11652.54 11946.08,-11652.52 11948.37,-11659.13"/>
</g>
<!-- gate_layer0_gpu12 -->
<g id="node30" class="node">
<title>gate_layer0_gpu12</title>
<path fill="lightsteelblue" stroke="black" d="M13022.07,-11663.87C13022.07,-11663.87 12572.93,-11613.54 12572.93,-11613.54 12566.96,-11612.87 12566.96,-11611.54 12572.93,-11610.87 12572.93,-11610.87 13022.07,-11560.54 13022.07,-11560.54 13028.04,-11559.87 13039.96,-11559.87 13045.93,-11560.54 13045.93,-11560.54 13495.07,-11610.87 13495.07,-11610.87 13501.04,-11611.54 13501.04,-11612.87 13495.07,-11613.54 13495.07,-11613.54 13045.93,-11663.87 13045.93,-11663.87 13039.96,-11664.54 13028.04,-11664.54 13022.07,-11663.87"/>
<text text-anchor="middle" x="13034" y="-11623.51" font-family="Times,serif" font-size="14.00">Gate Layer 0 GPU 12</text>
<text text-anchor="middle" x="13034" y="-11608.51" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13034" y="-11593.51" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer0_gpu12&#45;&gt;gate_layer0_gpu12 -->
<g id="edge29" class="edge">
<title>mha_layer0_gpu12&#45;&gt;gate_layer0_gpu12</title>
<path fill="none" stroke="black" d="M12769.18,-11701.09C12809.91,-11687.58 12860.93,-11670.64 12907.29,-11655.26"/>
<polygon fill="black" stroke="black" points="12908.41,-11658.57 12916.8,-11652.1 12906.2,-11651.93 12908.41,-11658.57"/>
</g>
<!-- gate_layer0_gpu13 -->
<g id="node31" class="node">
<title>gate_layer0_gpu13</title>
<path fill="lightsteelblue" stroke="black" d="M13986.07,-11663.87C13986.07,-11663.87 13536.93,-11613.54 13536.93,-11613.54 13530.96,-11612.87 13530.96,-11611.54 13536.93,-11610.87 13536.93,-11610.87 13986.07,-11560.54 13986.07,-11560.54 13992.04,-11559.87 14003.96,-11559.87 14009.93,-11560.54 14009.93,-11560.54 14459.07,-11610.87 14459.07,-11610.87 14465.04,-11611.54 14465.04,-11612.87 14459.07,-11613.54 14459.07,-11613.54 14009.93,-11663.87 14009.93,-11663.87 14003.96,-11664.54 13992.04,-11664.54 13986.07,-11663.87"/>
<text text-anchor="middle" x="13998" y="-11623.51" font-family="Times,serif" font-size="14.00">Gate Layer 0 GPU 13</text>
<text text-anchor="middle" x="13998" y="-11608.51" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13998" y="-11593.51" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer0_gpu13&#45;&gt;gate_layer0_gpu13 -->
<g id="edge30" class="edge">
<title>mha_layer0_gpu13&#45;&gt;gate_layer0_gpu13</title>
<path fill="none" stroke="black" d="M13727.76,-11701.09C13769.51,-11687.51 13821.86,-11670.49 13869.34,-11655.05"/>
<polygon fill="black" stroke="black" points="13870.65,-11658.3 13879.07,-11651.88 13868.48,-11651.65 13870.65,-11658.3"/>
</g>
<!-- gate_layer0_gpu14 -->
<g id="node32" class="node">
<title>gate_layer0_gpu14</title>
<path fill="lightsteelblue" stroke="black" d="M14950.07,-11663.87C14950.07,-11663.87 14500.93,-11613.54 14500.93,-11613.54 14494.96,-11612.87 14494.96,-11611.54 14500.93,-11610.87 14500.93,-11610.87 14950.07,-11560.54 14950.07,-11560.54 14956.04,-11559.87 14967.96,-11559.87 14973.93,-11560.54 14973.93,-11560.54 15423.07,-11610.87 15423.07,-11610.87 15429.04,-11611.54 15429.04,-11612.87 15423.07,-11613.54 15423.07,-11613.54 14973.93,-11663.87 14973.93,-11663.87 14967.96,-11664.54 14956.04,-11664.54 14950.07,-11663.87"/>
<text text-anchor="middle" x="14962" y="-11623.51" font-family="Times,serif" font-size="14.00">Gate Layer 0 GPU 14</text>
<text text-anchor="middle" x="14962" y="-11608.51" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14962" y="-11593.51" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer0_gpu14&#45;&gt;gate_layer0_gpu14 -->
<g id="edge31" class="edge">
<title>mha_layer0_gpu14&#45;&gt;gate_layer0_gpu14</title>
<path fill="none" stroke="black" d="M14688.66,-11701.09C14731.08,-11687.45 14784.3,-11670.34 14832.49,-11654.85"/>
<polygon fill="black" stroke="black" points="14833.6,-11658.17 14842.05,-11651.77 14831.46,-11651.5 14833.6,-11658.17"/>
</g>
<!-- gate_layer0_gpu15 -->
<g id="node33" class="node">
<title>gate_layer0_gpu15</title>
<path fill="lightsteelblue" stroke="black" d="M15914.07,-11663.87C15914.07,-11663.87 15464.93,-11613.54 15464.93,-11613.54 15458.96,-11612.87 15458.96,-11611.54 15464.93,-11610.87 15464.93,-11610.87 15914.07,-11560.54 15914.07,-11560.54 15920.04,-11559.87 15931.96,-11559.87 15937.93,-11560.54 15937.93,-11560.54 16387.07,-11610.87 16387.07,-11610.87 16393.04,-11611.54 16393.04,-11612.87 16387.07,-11613.54 16387.07,-11613.54 15937.93,-11663.87 15937.93,-11663.87 15931.96,-11664.54 15920.04,-11664.54 15914.07,-11663.87"/>
<text text-anchor="middle" x="15926" y="-11623.51" font-family="Times,serif" font-size="14.00">Gate Layer 0 GPU 15</text>
<text text-anchor="middle" x="15926" y="-11608.51" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="15926" y="-11593.51" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer0_gpu15&#45;&gt;gate_layer0_gpu15 -->
<g id="edge32" class="edge">
<title>mha_layer0_gpu15&#45;&gt;gate_layer0_gpu15</title>
<path fill="none" stroke="black" d="M15651.11,-11701.09C15693.77,-11687.45 15747.29,-11670.34 15795.75,-11654.85"/>
<polygon fill="black" stroke="black" points="15796.91,-11658.15 15805.37,-11651.77 15794.78,-11651.48 15796.91,-11658.15"/>
</g>
<!-- route_layer0_gpu0 -->
<g id="node50" class="node">
<title>route_layer0_gpu0</title>
<path fill="orange" stroke="black" d="M2133.74,-11523.21C2133.74,-11523.21 1625.24,-11523.21 1625.24,-11523.21 1619.24,-11523.21 1608.5,-11519.53 1603.75,-11515.86 1603.75,-11515.86 1485.75,-11424.55 1485.75,-11424.55 1481,-11420.88 1482.26,-11417.21 1488.26,-11417.21 1488.26,-11417.21 1996.76,-11417.21 1996.76,-11417.21 2002.76,-11417.21 2013.5,-11420.88 2018.25,-11424.55 2018.25,-11424.55 2136.25,-11515.86 2136.25,-11515.86 2141,-11519.53 2139.74,-11523.21 2133.74,-11523.21"/>
<text text-anchor="middle" x="1811" y="-11481.51" font-family="Times,serif" font-size="14.00">Token Router Layer 0 GPU 0</text>
<text text-anchor="middle" x="1811" y="-11466.51" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="1811" y="-11451.51" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer0_gpu0&#45;&gt;route_layer0_gpu0 -->
<g id="edge33" class="edge">
<title>gate_layer0_gpu0&#45;&gt;route_layer0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1566.72,-11570.34C1600.04,-11556.82 1637.7,-11541.53 1673.31,-11527.08"/>
<polygon fill="black" stroke="black" points="1674.85,-11530.23 1682.8,-11523.23 1672.22,-11523.75 1674.85,-11530.23"/>
</g>
<!-- route_layer0_gpu1 -->
<g id="node52" class="node">
<title>route_layer0_gpu1</title>
<path fill="orange" stroke="black" d="M3097.74,-11523.21C3097.74,-11523.21 2589.24,-11523.21 2589.24,-11523.21 2583.24,-11523.21 2572.5,-11519.53 2567.75,-11515.86 2567.75,-11515.86 2449.75,-11424.55 2449.75,-11424.55 2445,-11420.88 2446.26,-11417.21 2452.26,-11417.21 2452.26,-11417.21 2960.76,-11417.21 2960.76,-11417.21 2966.76,-11417.21 2977.5,-11420.88 2982.25,-11424.55 2982.25,-11424.55 3100.25,-11515.86 3100.25,-11515.86 3105,-11519.53 3103.74,-11523.21 3097.74,-11523.21"/>
<text text-anchor="middle" x="2775" y="-11481.51" font-family="Times,serif" font-size="14.00">Token Router Layer 0 GPU 1</text>
<text text-anchor="middle" x="2775" y="-11466.51" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="2775" y="-11451.51" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer0_gpu1&#45;&gt;route_layer0_gpu1 -->
<g id="edge34" class="edge">
<title>gate_layer0_gpu1&#45;&gt;route_layer0_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2530.72,-11570.34C2564.04,-11556.82 2601.7,-11541.53 2637.31,-11527.08"/>
<polygon fill="black" stroke="black" points="2638.85,-11530.23 2646.8,-11523.23 2636.22,-11523.75 2638.85,-11530.23"/>
</g>
<!-- route_layer0_gpu2 -->
<g id="node54" class="node">
<title>route_layer0_gpu2</title>
<path fill="orange" stroke="black" d="M3923.74,-11523.21C3923.74,-11523.21 3415.24,-11523.21 3415.24,-11523.21 3409.24,-11523.21 3398.5,-11519.53 3393.75,-11515.86 3393.75,-11515.86 3275.75,-11424.55 3275.75,-11424.55 3271,-11420.88 3272.26,-11417.21 3278.26,-11417.21 3278.26,-11417.21 3786.76,-11417.21 3786.76,-11417.21 3792.76,-11417.21 3803.5,-11420.88 3808.25,-11424.55 3808.25,-11424.55 3926.25,-11515.86 3926.25,-11515.86 3931,-11519.53 3929.74,-11523.21 3923.74,-11523.21"/>
<text text-anchor="middle" x="3601" y="-11481.51" font-family="Times,serif" font-size="14.00">Token Router Layer 0 GPU 2</text>
<text text-anchor="middle" x="3601" y="-11466.51" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="3601" y="-11451.51" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer0_gpu2&#45;&gt;route_layer0_gpu2 -->
<g id="edge35" class="edge">
<title>gate_layer0_gpu2&#45;&gt;route_layer0_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3460.07,-11566.52C3477.71,-11554.59 3497.04,-11541.52 3515.57,-11528.99"/>
<polygon fill="black" stroke="black" points="3517.69,-11531.77 3524.02,-11523.27 3513.77,-11525.98 3517.69,-11531.77"/>
</g>
<!-- route_layer0_gpu3 -->
<g id="node56" class="node">
<title>route_layer0_gpu3</title>
<path fill="orange" stroke="black" d="M5025.74,-11523.21C5025.74,-11523.21 4517.24,-11523.21 4517.24,-11523.21 4511.24,-11523.21 4500.5,-11519.53 4495.75,-11515.86 4495.75,-11515.86 4377.75,-11424.55 4377.75,-11424.55 4373,-11420.88 4374.26,-11417.21 4380.26,-11417.21 4380.26,-11417.21 4888.76,-11417.21 4888.76,-11417.21 4894.76,-11417.21 4905.5,-11420.88 4910.25,-11424.55 4910.25,-11424.55 5028.25,-11515.86 5028.25,-11515.86 5033,-11519.53 5031.74,-11523.21 5025.74,-11523.21"/>
<text text-anchor="middle" x="4703" y="-11481.51" font-family="Times,serif" font-size="14.00">Token Router Layer 0 GPU 3</text>
<text text-anchor="middle" x="4703" y="-11466.51" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="4703" y="-11451.51" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer0_gpu3&#45;&gt;route_layer0_gpu3 -->
<g id="edge36" class="edge">
<title>gate_layer0_gpu3&#45;&gt;route_layer0_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4458.72,-11570.34C4492.04,-11556.82 4529.7,-11541.53 4565.31,-11527.08"/>
<polygon fill="black" stroke="black" points="4566.85,-11530.23 4574.8,-11523.23 4564.22,-11523.75 4566.85,-11530.23"/>
</g>
<!-- route_layer0_gpu4 -->
<g id="node58" class="node">
<title>route_layer0_gpu4</title>
<path fill="orange" stroke="black" d="M5851.74,-11523.21C5851.74,-11523.21 5343.24,-11523.21 5343.24,-11523.21 5337.24,-11523.21 5326.5,-11519.53 5321.75,-11515.86 5321.75,-11515.86 5203.75,-11424.55 5203.75,-11424.55 5199,-11420.88 5200.26,-11417.21 5206.26,-11417.21 5206.26,-11417.21 5714.76,-11417.21 5714.76,-11417.21 5720.76,-11417.21 5731.5,-11420.88 5736.25,-11424.55 5736.25,-11424.55 5854.25,-11515.86 5854.25,-11515.86 5859,-11519.53 5857.74,-11523.21 5851.74,-11523.21"/>
<text text-anchor="middle" x="5529" y="-11481.51" font-family="Times,serif" font-size="14.00">Token Router Layer 0 GPU 4</text>
<text text-anchor="middle" x="5529" y="-11466.51" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="5529" y="-11451.51" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer0_gpu4&#45;&gt;route_layer0_gpu4 -->
<g id="edge37" class="edge">
<title>gate_layer0_gpu4&#45;&gt;route_layer0_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5388.07,-11566.52C5405.71,-11554.59 5425.04,-11541.52 5443.57,-11528.99"/>
<polygon fill="black" stroke="black" points="5445.69,-11531.77 5452.02,-11523.27 5441.77,-11525.98 5445.69,-11531.77"/>
</g>
<!-- route_layer0_gpu5 -->
<g id="node60" class="node">
<title>route_layer0_gpu5</title>
<path fill="orange" stroke="black" d="M6815.74,-11523.21C6815.74,-11523.21 6307.24,-11523.21 6307.24,-11523.21 6301.24,-11523.21 6290.5,-11519.53 6285.75,-11515.86 6285.75,-11515.86 6167.75,-11424.55 6167.75,-11424.55 6163,-11420.88 6164.26,-11417.21 6170.26,-11417.21 6170.26,-11417.21 6678.76,-11417.21 6678.76,-11417.21 6684.76,-11417.21 6695.5,-11420.88 6700.25,-11424.55 6700.25,-11424.55 6818.25,-11515.86 6818.25,-11515.86 6823,-11519.53 6821.74,-11523.21 6815.74,-11523.21"/>
<text text-anchor="middle" x="6493" y="-11481.51" font-family="Times,serif" font-size="14.00">Token Router Layer 0 GPU 5</text>
<text text-anchor="middle" x="6493" y="-11466.51" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="6493" y="-11451.51" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer0_gpu5&#45;&gt;route_layer0_gpu5 -->
<g id="edge38" class="edge">
<title>gate_layer0_gpu5&#45;&gt;route_layer0_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6352.07,-11566.52C6369.71,-11554.59 6389.04,-11541.52 6407.57,-11528.99"/>
<polygon fill="black" stroke="black" points="6409.69,-11531.77 6416.02,-11523.27 6405.77,-11525.98 6409.69,-11531.77"/>
</g>
<!-- route_layer0_gpu6 -->
<g id="node62" class="node">
<title>route_layer0_gpu6</title>
<path fill="orange" stroke="black" d="M7779.74,-11523.21C7779.74,-11523.21 7271.24,-11523.21 7271.24,-11523.21 7265.24,-11523.21 7254.5,-11519.53 7249.75,-11515.86 7249.75,-11515.86 7131.75,-11424.55 7131.75,-11424.55 7127,-11420.88 7128.26,-11417.21 7134.26,-11417.21 7134.26,-11417.21 7642.76,-11417.21 7642.76,-11417.21 7648.76,-11417.21 7659.5,-11420.88 7664.25,-11424.55 7664.25,-11424.55 7782.25,-11515.86 7782.25,-11515.86 7787,-11519.53 7785.74,-11523.21 7779.74,-11523.21"/>
<text text-anchor="middle" x="7457" y="-11481.51" font-family="Times,serif" font-size="14.00">Token Router Layer 0 GPU 6</text>
<text text-anchor="middle" x="7457" y="-11466.51" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="7457" y="-11451.51" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer0_gpu6&#45;&gt;route_layer0_gpu6 -->
<g id="edge39" class="edge">
<title>gate_layer0_gpu6&#45;&gt;route_layer0_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7316.07,-11566.52C7333.71,-11554.59 7353.04,-11541.52 7371.57,-11528.99"/>
<polygon fill="black" stroke="black" points="7373.69,-11531.77 7380.02,-11523.27 7369.77,-11525.98 7373.69,-11531.77"/>
</g>
<!-- route_layer0_gpu7 -->
<g id="node64" class="node">
<title>route_layer0_gpu7</title>
<path fill="orange" stroke="black" d="M8605.74,-11523.21C8605.74,-11523.21 8097.24,-11523.21 8097.24,-11523.21 8091.24,-11523.21 8080.5,-11519.53 8075.75,-11515.86 8075.75,-11515.86 7957.75,-11424.55 7957.75,-11424.55 7953,-11420.88 7954.26,-11417.21 7960.26,-11417.21 7960.26,-11417.21 8468.76,-11417.21 8468.76,-11417.21 8474.76,-11417.21 8485.5,-11420.88 8490.25,-11424.55 8490.25,-11424.55 8608.25,-11515.86 8608.25,-11515.86 8613,-11519.53 8611.74,-11523.21 8605.74,-11523.21"/>
<text text-anchor="middle" x="8283" y="-11481.51" font-family="Times,serif" font-size="14.00">Token Router Layer 0 GPU 7</text>
<text text-anchor="middle" x="8283" y="-11466.51" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="8283" y="-11451.51" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer0_gpu7&#45;&gt;route_layer0_gpu7 -->
<g id="edge40" class="edge">
<title>gate_layer0_gpu7&#45;&gt;route_layer0_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8238.33,-11561.85C8242.97,-11552.42 8247.89,-11542.45 8252.69,-11532.7"/>
<polygon fill="black" stroke="black" points="8255.97,-11533.96 8257.26,-11523.44 8249.7,-11530.86 8255.97,-11533.96"/>
</g>
<!-- route_layer0_gpu8 -->
<g id="node66" class="node">
<title>route_layer0_gpu8</title>
<path fill="orange" stroke="black" d="M9431.74,-11523.21C9431.74,-11523.21 8923.24,-11523.21 8923.24,-11523.21 8917.24,-11523.21 8906.5,-11519.53 8901.75,-11515.86 8901.75,-11515.86 8783.75,-11424.55 8783.75,-11424.55 8779,-11420.88 8780.26,-11417.21 8786.26,-11417.21 8786.26,-11417.21 9294.76,-11417.21 9294.76,-11417.21 9300.76,-11417.21 9311.5,-11420.88 9316.25,-11424.55 9316.25,-11424.55 9434.25,-11515.86 9434.25,-11515.86 9439,-11519.53 9437.74,-11523.21 9431.74,-11523.21"/>
<text text-anchor="middle" x="9109" y="-11481.51" font-family="Times,serif" font-size="14.00">Token Router Layer 0 GPU 8</text>
<text text-anchor="middle" x="9109" y="-11466.51" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="9109" y="-11451.51" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer0_gpu8&#45;&gt;route_layer0_gpu8 -->
<g id="edge41" class="edge">
<title>gate_layer0_gpu8&#45;&gt;route_layer0_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9153.67,-11561.85C9149.03,-11552.42 9144.11,-11542.45 9139.31,-11532.7"/>
<polygon fill="black" stroke="black" points="9142.3,-11530.86 9134.74,-11523.44 9136.03,-11533.96 9142.3,-11530.86"/>
</g>
<!-- route_layer0_gpu9 -->
<g id="node68" class="node">
<title>route_layer0_gpu9</title>
<path fill="orange" stroke="black" d="M10326.74,-11523.21C10326.74,-11523.21 9818.24,-11523.21 9818.24,-11523.21 9812.24,-11523.21 9801.5,-11519.53 9796.75,-11515.86 9796.75,-11515.86 9678.75,-11424.55 9678.75,-11424.55 9674,-11420.88 9675.26,-11417.21 9681.26,-11417.21 9681.26,-11417.21 10189.76,-11417.21 10189.76,-11417.21 10195.76,-11417.21 10206.5,-11420.88 10211.25,-11424.55 10211.25,-11424.55 10329.25,-11515.86 10329.25,-11515.86 10334,-11519.53 10332.74,-11523.21 10326.74,-11523.21"/>
<text text-anchor="middle" x="10004" y="-11481.51" font-family="Times,serif" font-size="14.00">Token Router Layer 0 GPU 9</text>
<text text-anchor="middle" x="10004" y="-11466.51" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="10004" y="-11451.51" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer0_gpu9&#45;&gt;route_layer0_gpu9 -->
<g id="edge42" class="edge">
<title>gate_layer0_gpu9&#45;&gt;route_layer0_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10095.66,-11564.2C10085.13,-11553.51 10073.8,-11542.02 10062.83,-11530.89"/>
<polygon fill="black" stroke="black" points="10065.19,-11528.3 10055.68,-11523.63 10060.2,-11533.21 10065.19,-11528.3"/>
</g>
<!-- route_layer0_gpu10 -->
<g id="node70" class="node">
<title>route_layer0_gpu10</title>
<path fill="orange" stroke="black" d="M11255.74,-11523.21C11255.74,-11523.21 10747.24,-11523.21 10747.24,-11523.21 10741.24,-11523.21 10730.5,-11519.53 10725.75,-11515.86 10725.75,-11515.86 10607.75,-11424.55 10607.75,-11424.55 10603,-11420.88 10604.26,-11417.21 10610.26,-11417.21 10610.26,-11417.21 11118.76,-11417.21 11118.76,-11417.21 11124.76,-11417.21 11135.5,-11420.88 11140.25,-11424.55 11140.25,-11424.55 11258.25,-11515.86 11258.25,-11515.86 11263,-11519.53 11261.74,-11523.21 11255.74,-11523.21"/>
<text text-anchor="middle" x="10933" y="-11481.51" font-family="Times,serif" font-size="14.00">Token Router Layer 0 GPU 10</text>
<text text-anchor="middle" x="10933" y="-11466.51" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="10933" y="-11451.51" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer0_gpu10&#45;&gt;route_layer0_gpu10 -->
<g id="edge43" class="edge">
<title>gate_layer0_gpu10&#45;&gt;route_layer0_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11049.35,-11565.37C11035.3,-11553.99 11020.05,-11541.65 11005.36,-11529.76"/>
<polygon fill="black" stroke="black" points="11007.24,-11526.79 10997.27,-11523.22 11002.84,-11532.23 11007.24,-11526.79"/>
</g>
<!-- route_layer0_gpu11 -->
<g id="node72" class="node">
<title>route_layer0_gpu11</title>
<path fill="orange" stroke="black" d="M12202.74,-11523.21C12202.74,-11523.21 11694.24,-11523.21 11694.24,-11523.21 11688.24,-11523.21 11677.5,-11519.53 11672.75,-11515.86 11672.75,-11515.86 11554.75,-11424.55 11554.75,-11424.55 11550,-11420.88 11551.26,-11417.21 11557.26,-11417.21 11557.26,-11417.21 12065.76,-11417.21 12065.76,-11417.21 12071.76,-11417.21 12082.5,-11420.88 12087.25,-11424.55 12087.25,-11424.55 12205.25,-11515.86 12205.25,-11515.86 12210,-11519.53 12208.74,-11523.21 12202.74,-11523.21"/>
<text text-anchor="middle" x="11880" y="-11481.51" font-family="Times,serif" font-size="14.00">Token Router Layer 0 GPU 11</text>
<text text-anchor="middle" x="11880" y="-11466.51" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="11880" y="-11451.51" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer0_gpu11&#45;&gt;route_layer0_gpu11 -->
<g id="edge44" class="edge">
<title>gate_layer0_gpu11&#45;&gt;route_layer0_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12008.57,-11565.95C11992.74,-11554.27 11975.47,-11541.55 11958.87,-11529.32"/>
<polygon fill="black" stroke="black" points="11960.92,-11526.48 11950.79,-11523.37 11956.77,-11532.12 11960.92,-11526.48"/>
</g>
<!-- route_layer0_gpu12 -->
<g id="node74" class="node">
<title>route_layer0_gpu12</title>
<path fill="orange" stroke="black" d="M13157.74,-11523.21C13157.74,-11523.21 12649.24,-11523.21 12649.24,-11523.21 12643.24,-11523.21 12632.5,-11519.53 12627.75,-11515.86 12627.75,-11515.86 12509.75,-11424.55 12509.75,-11424.55 12505,-11420.88 12506.26,-11417.21 12512.26,-11417.21 12512.26,-11417.21 13020.76,-11417.21 13020.76,-11417.21 13026.76,-11417.21 13037.5,-11420.88 13042.25,-11424.55 13042.25,-11424.55 13160.25,-11515.86 13160.25,-11515.86 13165,-11519.53 13163.74,-11523.21 13157.74,-11523.21"/>
<text text-anchor="middle" x="12835" y="-11481.51" font-family="Times,serif" font-size="14.00">Token Router Layer 0 GPU 12</text>
<text text-anchor="middle" x="12835" y="-11466.51" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="12835" y="-11451.51" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer0_gpu12&#45;&gt;route_layer0_gpu12 -->
<g id="edge45" class="edge">
<title>gate_layer0_gpu12&#45;&gt;route_layer0_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12970.21,-11566.33C12953.51,-11554.58 12935.25,-11541.74 12917.71,-11529.4"/>
<polygon fill="black" stroke="black" points="12919.36,-11526.28 12909.17,-11523.39 12915.34,-11532 12919.36,-11526.28"/>
</g>
<!-- route_layer0_gpu13 -->
<g id="node76" class="node">
<title>route_layer0_gpu13</title>
<path fill="orange" stroke="black" d="M14117.74,-11523.21C14117.74,-11523.21 13609.24,-11523.21 13609.24,-11523.21 13603.24,-11523.21 13592.5,-11519.53 13587.75,-11515.86 13587.75,-11515.86 13469.75,-11424.55 13469.75,-11424.55 13465,-11420.88 13466.26,-11417.21 13472.26,-11417.21 13472.26,-11417.21 13980.76,-11417.21 13980.76,-11417.21 13986.76,-11417.21 13997.5,-11420.88 14002.25,-11424.55 14002.25,-11424.55 14120.25,-11515.86 14120.25,-11515.86 14125,-11519.53 14123.74,-11523.21 14117.74,-11523.21"/>
<text text-anchor="middle" x="13795" y="-11481.51" font-family="Times,serif" font-size="14.00">Token Router Layer 0 GPU 13</text>
<text text-anchor="middle" x="13795" y="-11466.51" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="13795" y="-11451.51" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer0_gpu13&#45;&gt;route_layer0_gpu13 -->
<g id="edge46" class="edge">
<title>gate_layer0_gpu13&#45;&gt;route_layer0_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13932.93,-11566.33C13915.89,-11554.58 13897.27,-11541.74 13879.38,-11529.4"/>
<polygon fill="black" stroke="black" points="13880.88,-11526.18 13870.66,-11523.39 13876.91,-11531.95 13880.88,-11526.18"/>
</g>
<!-- route_layer0_gpu14 -->
<g id="node78" class="node">
<title>route_layer0_gpu14</title>
<path fill="orange" stroke="black" d="M15079.74,-11523.21C15079.74,-11523.21 14571.24,-11523.21 14571.24,-11523.21 14565.24,-11523.21 14554.5,-11519.53 14549.75,-11515.86 14549.75,-11515.86 14431.75,-11424.55 14431.75,-11424.55 14427,-11420.88 14428.26,-11417.21 14434.26,-11417.21 14434.26,-11417.21 14942.76,-11417.21 14942.76,-11417.21 14948.76,-11417.21 14959.5,-11420.88 14964.25,-11424.55 14964.25,-11424.55 15082.25,-11515.86 15082.25,-11515.86 15087,-11519.53 15085.74,-11523.21 15079.74,-11523.21"/>
<text text-anchor="middle" x="14757" y="-11481.51" font-family="Times,serif" font-size="14.00">Token Router Layer 0 GPU 14</text>
<text text-anchor="middle" x="14757" y="-11466.51" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="14757" y="-11451.51" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer0_gpu14&#45;&gt;route_layer0_gpu14 -->
<g id="edge47" class="edge">
<title>gate_layer0_gpu14&#45;&gt;route_layer0_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14896.57,-11566.52C14879.1,-11554.59 14859.96,-11541.52 14841.61,-11528.99"/>
<polygon fill="black" stroke="black" points="14843.47,-11526.02 14833.24,-11523.27 14839.52,-11531.8 14843.47,-11526.02"/>
</g>
<!-- route_layer0_gpu15 -->
<g id="node80" class="node">
<title>route_layer0_gpu15</title>
<path fill="orange" stroke="black" d="M16042.74,-11523.21C16042.74,-11523.21 15534.24,-11523.21 15534.24,-11523.21 15528.24,-11523.21 15517.5,-11519.53 15512.75,-11515.86 15512.75,-11515.86 15394.75,-11424.55 15394.75,-11424.55 15390,-11420.88 15391.26,-11417.21 15397.26,-11417.21 15397.26,-11417.21 15905.76,-11417.21 15905.76,-11417.21 15911.76,-11417.21 15922.5,-11420.88 15927.25,-11424.55 15927.25,-11424.55 16045.25,-11515.86 16045.25,-11515.86 16050,-11519.53 16048.74,-11523.21 16042.74,-11523.21"/>
<text text-anchor="middle" x="15720" y="-11481.51" font-family="Times,serif" font-size="14.00">Token Router Layer 0 GPU 15</text>
<text text-anchor="middle" x="15720" y="-11466.51" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="15720" y="-11451.51" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer0_gpu15&#45;&gt;route_layer0_gpu15 -->
<g id="edge48" class="edge">
<title>gate_layer0_gpu15&#45;&gt;route_layer0_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15860.25,-11566.52C15842.69,-11554.59 15823.46,-11541.52 15805.02,-11528.99"/>
<polygon fill="black" stroke="black" points="15806.85,-11526 15796.61,-11523.27 15802.91,-11531.79 15806.85,-11526"/>
</g>
<!-- expert_layer0_gpu0_expert0 -->
<g id="node34" class="node">
<title>expert_layer0_gpu0_expert0</title>
<path fill="lightcoral" stroke="black" d="M2750.5,-11270.25C2750.5,-11270.25 2281.5,-11270.25 2281.5,-11270.25 2275.5,-11270.25 2269.5,-11264.25 2269.5,-11258.25 2269.5,-11258.25 2269.5,-11214.25 2269.5,-11214.25 2269.5,-11208.25 2275.5,-11202.25 2281.5,-11202.25 2281.5,-11202.25 2750.5,-11202.25 2750.5,-11202.25 2756.5,-11202.25 2762.5,-11208.25 2762.5,-11214.25 2762.5,-11214.25 2762.5,-11258.25 2762.5,-11258.25 2762.5,-11264.25 2756.5,-11270.25 2750.5,-11270.25"/>
<text text-anchor="middle" x="2516" y="-11255.05" font-family="Times,serif" font-size="14.00">Expert 0 Layer 0 GPU 0</text>
<text text-anchor="middle" x="2516" y="-11240.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2516" y="-11225.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2516" y="-11210.05" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer0_gpu0 -->
<g id="node51" class="node">
<title>aggregate_layer0_gpu0</title>
<path fill="orange" stroke="black" d="M2256.29,-11166.25C2256.29,-11166.25 1769.19,-11166.25 1769.19,-11166.25 1763.19,-11166.25 1752.52,-11162.49 1747.85,-11158.72 1747.85,-11158.72 1635.06,-11067.78 1635.06,-11067.78 1630.38,-11064.02 1631.71,-11060.25 1637.71,-11060.25 1637.71,-11060.25 2124.81,-11060.25 2124.81,-11060.25 2130.81,-11060.25 2141.48,-11064.02 2146.15,-11067.78 2146.15,-11067.78 2258.94,-11158.72 2258.94,-11158.72 2263.62,-11162.49 2262.29,-11166.25 2256.29,-11166.25"/>
<text text-anchor="middle" x="1947" y="-11124.55" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 0 GPU 0</text>
<text text-anchor="middle" x="1947" y="-11109.55" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="1947" y="-11094.55" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer0_gpu0_expert0&#45;&gt;aggregate_layer0_gpu0 -->
<g id="edge81" class="edge">
<title>expert_layer0_gpu0_expert0&#45;&gt;aggregate_layer0_gpu0</title>
<path fill="none" stroke="black" d="M2360.52,-11202.19C2311.42,-11191.75 2255.82,-11179.92 2201.67,-11168.41"/>
<polygon fill="black" stroke="black" points="2202.09,-11164.92 2191.58,-11166.26 2200.64,-11171.77 2202.09,-11164.92"/>
</g>
<!-- expert_layer0_gpu1_expert1 -->
<g id="node35" class="node">
<title>expert_layer0_gpu1_expert1</title>
<path fill="lightcoral" stroke="black" d="M3487.5,-11270.25C3487.5,-11270.25 3018.5,-11270.25 3018.5,-11270.25 3012.5,-11270.25 3006.5,-11264.25 3006.5,-11258.25 3006.5,-11258.25 3006.5,-11214.25 3006.5,-11214.25 3006.5,-11208.25 3012.5,-11202.25 3018.5,-11202.25 3018.5,-11202.25 3487.5,-11202.25 3487.5,-11202.25 3493.5,-11202.25 3499.5,-11208.25 3499.5,-11214.25 3499.5,-11214.25 3499.5,-11258.25 3499.5,-11258.25 3499.5,-11264.25 3493.5,-11270.25 3487.5,-11270.25"/>
<text text-anchor="middle" x="3253" y="-11255.05" font-family="Times,serif" font-size="14.00">Expert 1 Layer 0 GPU 1</text>
<text text-anchor="middle" x="3253" y="-11240.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3253" y="-11225.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3253" y="-11210.05" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer0_gpu1 -->
<g id="node53" class="node">
<title>aggregate_layer0_gpu1</title>
<path fill="orange" stroke="black" d="M3221.29,-11166.25C3221.29,-11166.25 2734.19,-11166.25 2734.19,-11166.25 2728.19,-11166.25 2717.52,-11162.49 2712.85,-11158.72 2712.85,-11158.72 2600.06,-11067.78 2600.06,-11067.78 2595.38,-11064.02 2596.71,-11060.25 2602.71,-11060.25 2602.71,-11060.25 3089.81,-11060.25 3089.81,-11060.25 3095.81,-11060.25 3106.48,-11064.02 3111.15,-11067.78 3111.15,-11067.78 3223.94,-11158.72 3223.94,-11158.72 3228.62,-11162.49 3227.29,-11166.25 3221.29,-11166.25"/>
<text text-anchor="middle" x="2912" y="-11124.55" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 0 GPU 1</text>
<text text-anchor="middle" x="2912" y="-11109.55" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="2912" y="-11094.55" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer0_gpu1_expert1&#45;&gt;aggregate_layer0_gpu1 -->
<g id="edge82" class="edge">
<title>expert_layer0_gpu1_expert1&#45;&gt;aggregate_layer0_gpu1</title>
<path fill="none" stroke="black" d="M3159.82,-11202.19C3131.5,-11192.14 3099.56,-11180.81 3068.26,-11169.7"/>
<polygon fill="black" stroke="black" points="3069.17,-11166.31 3058.58,-11166.26 3066.83,-11172.91 3069.17,-11166.31"/>
</g>
<!-- expert_layer0_gpu2_expert2 -->
<g id="node36" class="node">
<title>expert_layer0_gpu2_expert2</title>
<path fill="lightcoral" stroke="black" d="M4638.5,-11270.25C4638.5,-11270.25 4169.5,-11270.25 4169.5,-11270.25 4163.5,-11270.25 4157.5,-11264.25 4157.5,-11258.25 4157.5,-11258.25 4157.5,-11214.25 4157.5,-11214.25 4157.5,-11208.25 4163.5,-11202.25 4169.5,-11202.25 4169.5,-11202.25 4638.5,-11202.25 4638.5,-11202.25 4644.5,-11202.25 4650.5,-11208.25 4650.5,-11214.25 4650.5,-11214.25 4650.5,-11258.25 4650.5,-11258.25 4650.5,-11264.25 4644.5,-11270.25 4638.5,-11270.25"/>
<text text-anchor="middle" x="4404" y="-11255.05" font-family="Times,serif" font-size="14.00">Expert 2 Layer 0 GPU 2</text>
<text text-anchor="middle" x="4404" y="-11240.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4404" y="-11225.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4404" y="-11210.05" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer0_gpu2 -->
<g id="node55" class="node">
<title>aggregate_layer0_gpu2</title>
<path fill="orange" stroke="black" d="M4185.29,-11166.25C4185.29,-11166.25 3698.19,-11166.25 3698.19,-11166.25 3692.19,-11166.25 3681.52,-11162.49 3676.85,-11158.72 3676.85,-11158.72 3564.06,-11067.78 3564.06,-11067.78 3559.38,-11064.02 3560.71,-11060.25 3566.71,-11060.25 3566.71,-11060.25 4053.81,-11060.25 4053.81,-11060.25 4059.81,-11060.25 4070.48,-11064.02 4075.15,-11067.78 4075.15,-11067.78 4187.94,-11158.72 4187.94,-11158.72 4192.62,-11162.49 4191.29,-11166.25 4185.29,-11166.25"/>
<text text-anchor="middle" x="3876" y="-11124.55" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 0 GPU 2</text>
<text text-anchor="middle" x="3876" y="-11109.55" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="3876" y="-11094.55" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer0_gpu2_expert2&#45;&gt;aggregate_layer0_gpu2 -->
<g id="edge83" class="edge">
<title>expert_layer0_gpu2_expert2&#45;&gt;aggregate_layer0_gpu2</title>
<path fill="none" stroke="black" d="M4259.72,-11202.19C4214.35,-11191.79 4162.99,-11180.02 4112.95,-11168.55"/>
<polygon fill="black" stroke="black" points="4113.49,-11165.09 4102.96,-11166.26 4111.93,-11171.91 4113.49,-11165.09"/>
</g>
<!-- expert_layer0_gpu3_expert3 -->
<g id="node37" class="node">
<title>expert_layer0_gpu3_expert3</title>
<path fill="lightcoral" stroke="black" d="M5378.5,-11270.25C5378.5,-11270.25 4909.5,-11270.25 4909.5,-11270.25 4903.5,-11270.25 4897.5,-11264.25 4897.5,-11258.25 4897.5,-11258.25 4897.5,-11214.25 4897.5,-11214.25 4897.5,-11208.25 4903.5,-11202.25 4909.5,-11202.25 4909.5,-11202.25 5378.5,-11202.25 5378.5,-11202.25 5384.5,-11202.25 5390.5,-11208.25 5390.5,-11214.25 5390.5,-11214.25 5390.5,-11258.25 5390.5,-11258.25 5390.5,-11264.25 5384.5,-11270.25 5378.5,-11270.25"/>
<text text-anchor="middle" x="5144" y="-11255.05" font-family="Times,serif" font-size="14.00">Expert 3 Layer 0 GPU 3</text>
<text text-anchor="middle" x="5144" y="-11240.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5144" y="-11225.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5144" y="-11210.05" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer0_gpu3 -->
<g id="node57" class="node">
<title>aggregate_layer0_gpu3</title>
<path fill="orange" stroke="black" d="M5300.29,-11166.25C5300.29,-11166.25 4813.19,-11166.25 4813.19,-11166.25 4807.19,-11166.25 4796.52,-11162.49 4791.85,-11158.72 4791.85,-11158.72 4679.06,-11067.78 4679.06,-11067.78 4674.38,-11064.02 4675.71,-11060.25 4681.71,-11060.25 4681.71,-11060.25 5168.81,-11060.25 5168.81,-11060.25 5174.81,-11060.25 5185.48,-11064.02 5190.15,-11067.78 5190.15,-11067.78 5302.94,-11158.72 5302.94,-11158.72 5307.62,-11162.49 5306.29,-11166.25 5300.29,-11166.25"/>
<text text-anchor="middle" x="4991" y="-11124.55" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 0 GPU 3</text>
<text text-anchor="middle" x="4991" y="-11109.55" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="4991" y="-11094.55" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer0_gpu3_expert3&#45;&gt;aggregate_layer0_gpu3 -->
<g id="edge84" class="edge">
<title>expert_layer0_gpu3_expert3&#45;&gt;aggregate_layer0_gpu3</title>
<path fill="none" stroke="black" d="M5102.19,-11202.19C5090.62,-11193.03 5077.69,-11182.81 5064.87,-11172.67"/>
<polygon fill="black" stroke="black" points="5066.93,-11169.84 5056.91,-11166.38 5062.59,-11175.33 5066.93,-11169.84"/>
</g>
<!-- expert_layer0_gpu4_expert4 -->
<g id="node38" class="node">
<title>expert_layer0_gpu4_expert4</title>
<path fill="lightcoral" stroke="black" d="M6247.5,-11270.25C6247.5,-11270.25 5778.5,-11270.25 5778.5,-11270.25 5772.5,-11270.25 5766.5,-11264.25 5766.5,-11258.25 5766.5,-11258.25 5766.5,-11214.25 5766.5,-11214.25 5766.5,-11208.25 5772.5,-11202.25 5778.5,-11202.25 5778.5,-11202.25 6247.5,-11202.25 6247.5,-11202.25 6253.5,-11202.25 6259.5,-11208.25 6259.5,-11214.25 6259.5,-11214.25 6259.5,-11258.25 6259.5,-11258.25 6259.5,-11264.25 6253.5,-11270.25 6247.5,-11270.25"/>
<text text-anchor="middle" x="6013" y="-11255.05" font-family="Times,serif" font-size="14.00">Expert 4 Layer 0 GPU 4</text>
<text text-anchor="middle" x="6013" y="-11240.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6013" y="-11225.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6013" y="-11210.05" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer0_gpu4 -->
<g id="node59" class="node">
<title>aggregate_layer0_gpu4</title>
<path fill="orange" stroke="black" d="M6117.29,-11166.25C6117.29,-11166.25 5630.19,-11166.25 5630.19,-11166.25 5624.19,-11166.25 5613.52,-11162.49 5608.85,-11158.72 5608.85,-11158.72 5496.06,-11067.78 5496.06,-11067.78 5491.38,-11064.02 5492.71,-11060.25 5498.71,-11060.25 5498.71,-11060.25 5985.81,-11060.25 5985.81,-11060.25 5991.81,-11060.25 6002.48,-11064.02 6007.15,-11067.78 6007.15,-11067.78 6119.94,-11158.72 6119.94,-11158.72 6124.62,-11162.49 6123.29,-11166.25 6117.29,-11166.25"/>
<text text-anchor="middle" x="5808" y="-11124.55" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 0 GPU 4</text>
<text text-anchor="middle" x="5808" y="-11109.55" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="5808" y="-11094.55" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer0_gpu4_expert4&#45;&gt;aggregate_layer0_gpu4 -->
<g id="edge85" class="edge">
<title>expert_layer0_gpu4_expert4&#45;&gt;aggregate_layer0_gpu4</title>
<path fill="none" stroke="black" d="M5956.98,-11202.19C5940.89,-11192.69 5922.85,-11182.04 5905.03,-11171.53"/>
<polygon fill="black" stroke="black" points="5906.71,-11168.45 5896.31,-11166.38 5903.15,-11174.48 5906.71,-11168.45"/>
</g>
<!-- expert_layer0_gpu5_expert5 -->
<g id="node39" class="node">
<title>expert_layer0_gpu5_expert5</title>
<path fill="lightcoral" stroke="black" d="M7183.5,-11270.25C7183.5,-11270.25 6714.5,-11270.25 6714.5,-11270.25 6708.5,-11270.25 6702.5,-11264.25 6702.5,-11258.25 6702.5,-11258.25 6702.5,-11214.25 6702.5,-11214.25 6702.5,-11208.25 6708.5,-11202.25 6714.5,-11202.25 6714.5,-11202.25 7183.5,-11202.25 7183.5,-11202.25 7189.5,-11202.25 7195.5,-11208.25 7195.5,-11214.25 7195.5,-11214.25 7195.5,-11258.25 7195.5,-11258.25 7195.5,-11264.25 7189.5,-11270.25 7183.5,-11270.25"/>
<text text-anchor="middle" x="6949" y="-11255.05" font-family="Times,serif" font-size="14.00">Expert 5 Layer 0 GPU 5</text>
<text text-anchor="middle" x="6949" y="-11240.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6949" y="-11225.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6949" y="-11210.05" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer0_gpu5 -->
<g id="node61" class="node">
<title>aggregate_layer0_gpu5</title>
<path fill="orange" stroke="black" d="M7051.29,-11166.25C7051.29,-11166.25 6564.19,-11166.25 6564.19,-11166.25 6558.19,-11166.25 6547.52,-11162.49 6542.85,-11158.72 6542.85,-11158.72 6430.06,-11067.78 6430.06,-11067.78 6425.38,-11064.02 6426.71,-11060.25 6432.71,-11060.25 6432.71,-11060.25 6919.81,-11060.25 6919.81,-11060.25 6925.81,-11060.25 6936.48,-11064.02 6941.15,-11067.78 6941.15,-11067.78 7053.94,-11158.72 7053.94,-11158.72 7058.62,-11162.49 7057.29,-11166.25 7051.29,-11166.25"/>
<text text-anchor="middle" x="6742" y="-11124.55" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 0 GPU 5</text>
<text text-anchor="middle" x="6742" y="-11109.55" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="6742" y="-11094.55" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer0_gpu5_expert5&#45;&gt;aggregate_layer0_gpu5 -->
<g id="edge86" class="edge">
<title>expert_layer0_gpu5_expert5&#45;&gt;aggregate_layer0_gpu5</title>
<path fill="none" stroke="black" d="M6892.44,-11202.19C6876.18,-11192.69 6857.97,-11182.04 6839.98,-11171.53"/>
<polygon fill="black" stroke="black" points="6841.58,-11168.4 6831.18,-11166.38 6838.04,-11174.45 6841.58,-11168.4"/>
</g>
<!-- expert_layer0_gpu6_expert6 -->
<g id="node40" class="node">
<title>expert_layer0_gpu6_expert6</title>
<path fill="lightcoral" stroke="black" d="M7976.5,-11270.25C7976.5,-11270.25 7507.5,-11270.25 7507.5,-11270.25 7501.5,-11270.25 7495.5,-11264.25 7495.5,-11258.25 7495.5,-11258.25 7495.5,-11214.25 7495.5,-11214.25 7495.5,-11208.25 7501.5,-11202.25 7507.5,-11202.25 7507.5,-11202.25 7976.5,-11202.25 7976.5,-11202.25 7982.5,-11202.25 7988.5,-11208.25 7988.5,-11214.25 7988.5,-11214.25 7988.5,-11258.25 7988.5,-11258.25 7988.5,-11264.25 7982.5,-11270.25 7976.5,-11270.25"/>
<text text-anchor="middle" x="7742" y="-11255.05" font-family="Times,serif" font-size="14.00">Expert 6 Layer 0 GPU 6</text>
<text text-anchor="middle" x="7742" y="-11240.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7742" y="-11225.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7742" y="-11210.05" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer0_gpu6 -->
<g id="node63" class="node">
<title>aggregate_layer0_gpu6</title>
<path fill="orange" stroke="black" d="M7863.29,-11166.25C7863.29,-11166.25 7376.19,-11166.25 7376.19,-11166.25 7370.19,-11166.25 7359.52,-11162.49 7354.85,-11158.72 7354.85,-11158.72 7242.06,-11067.78 7242.06,-11067.78 7237.38,-11064.02 7238.71,-11060.25 7244.71,-11060.25 7244.71,-11060.25 7731.81,-11060.25 7731.81,-11060.25 7737.81,-11060.25 7748.48,-11064.02 7753.15,-11067.78 7753.15,-11067.78 7865.94,-11158.72 7865.94,-11158.72 7870.62,-11162.49 7869.29,-11166.25 7863.29,-11166.25"/>
<text text-anchor="middle" x="7554" y="-11124.55" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 0 GPU 6</text>
<text text-anchor="middle" x="7554" y="-11109.55" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="7554" y="-11094.55" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer0_gpu6_expert6&#45;&gt;aggregate_layer0_gpu6 -->
<g id="edge87" class="edge">
<title>expert_layer0_gpu6_expert6&#45;&gt;aggregate_layer0_gpu6</title>
<path fill="none" stroke="black" d="M7690.63,-11202.19C7676,-11192.77 7659.63,-11182.24 7643.43,-11171.81"/>
<polygon fill="black" stroke="black" points="7645.29,-11168.85 7634.99,-11166.38 7641.51,-11174.74 7645.29,-11168.85"/>
</g>
<!-- expert_layer0_gpu7_expert7 -->
<g id="node41" class="node">
<title>expert_layer0_gpu7_expert7</title>
<path fill="lightcoral" stroke="black" d="M8600.5,-11270.25C8600.5,-11270.25 8131.5,-11270.25 8131.5,-11270.25 8125.5,-11270.25 8119.5,-11264.25 8119.5,-11258.25 8119.5,-11258.25 8119.5,-11214.25 8119.5,-11214.25 8119.5,-11208.25 8125.5,-11202.25 8131.5,-11202.25 8131.5,-11202.25 8600.5,-11202.25 8600.5,-11202.25 8606.5,-11202.25 8612.5,-11208.25 8612.5,-11214.25 8612.5,-11214.25 8612.5,-11258.25 8612.5,-11258.25 8612.5,-11264.25 8606.5,-11270.25 8600.5,-11270.25"/>
<text text-anchor="middle" x="8366" y="-11255.05" font-family="Times,serif" font-size="14.00">Expert 7 Layer 0 GPU 7</text>
<text text-anchor="middle" x="8366" y="-11240.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8366" y="-11225.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8366" y="-11210.05" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer0_gpu7 -->
<g id="node65" class="node">
<title>aggregate_layer0_gpu7</title>
<path fill="orange" stroke="black" d="M8600.29,-11166.25C8600.29,-11166.25 8113.19,-11166.25 8113.19,-11166.25 8107.19,-11166.25 8096.52,-11162.49 8091.85,-11158.72 8091.85,-11158.72 7979.06,-11067.78 7979.06,-11067.78 7974.38,-11064.02 7975.71,-11060.25 7981.71,-11060.25 7981.71,-11060.25 8468.81,-11060.25 8468.81,-11060.25 8474.81,-11060.25 8485.48,-11064.02 8490.15,-11067.78 8490.15,-11067.78 8602.94,-11158.72 8602.94,-11158.72 8607.62,-11162.49 8606.29,-11166.25 8600.29,-11166.25"/>
<text text-anchor="middle" x="8291" y="-11124.55" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 0 GPU 7</text>
<text text-anchor="middle" x="8291" y="-11109.55" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="8291" y="-11094.55" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer0_gpu7_expert7&#45;&gt;aggregate_layer0_gpu7 -->
<g id="edge88" class="edge">
<title>expert_layer0_gpu7_expert7&#45;&gt;aggregate_layer0_gpu7</title>
<path fill="none" stroke="black" d="M8345.51,-11202.19C8340.26,-11193.72 8334.45,-11184.35 8328.63,-11174.97"/>
<polygon fill="black" stroke="black" points="8331.55,-11173.04 8323.31,-11166.38 8325.6,-11176.72 8331.55,-11173.04"/>
</g>
<!-- expert_layer0_gpu8_expert8 -->
<g id="node42" class="node">
<title>expert_layer0_gpu8_expert8</title>
<path fill="lightcoral" stroke="black" d="M9261.5,-11270.25C9261.5,-11270.25 8792.5,-11270.25 8792.5,-11270.25 8786.5,-11270.25 8780.5,-11264.25 8780.5,-11258.25 8780.5,-11258.25 8780.5,-11214.25 8780.5,-11214.25 8780.5,-11208.25 8786.5,-11202.25 8792.5,-11202.25 8792.5,-11202.25 9261.5,-11202.25 9261.5,-11202.25 9267.5,-11202.25 9273.5,-11208.25 9273.5,-11214.25 9273.5,-11214.25 9273.5,-11258.25 9273.5,-11258.25 9273.5,-11264.25 9267.5,-11270.25 9261.5,-11270.25"/>
<text text-anchor="middle" x="9027" y="-11255.05" font-family="Times,serif" font-size="14.00">Expert 8 Layer 0 GPU 8</text>
<text text-anchor="middle" x="9027" y="-11240.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9027" y="-11225.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9027" y="-11210.05" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer0_gpu8 -->
<g id="node67" class="node">
<title>aggregate_layer0_gpu8</title>
<path fill="orange" stroke="black" d="M9412.29,-11166.25C9412.29,-11166.25 8925.19,-11166.25 8925.19,-11166.25 8919.19,-11166.25 8908.52,-11162.49 8903.85,-11158.72 8903.85,-11158.72 8791.06,-11067.78 8791.06,-11067.78 8786.38,-11064.02 8787.71,-11060.25 8793.71,-11060.25 8793.71,-11060.25 9280.81,-11060.25 9280.81,-11060.25 9286.81,-11060.25 9297.48,-11064.02 9302.15,-11067.78 9302.15,-11067.78 9414.94,-11158.72 9414.94,-11158.72 9419.62,-11162.49 9418.29,-11166.25 9412.29,-11166.25"/>
<text text-anchor="middle" x="9103" y="-11124.55" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 0 GPU 8</text>
<text text-anchor="middle" x="9103" y="-11109.55" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="9103" y="-11094.55" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer0_gpu8_expert8&#45;&gt;aggregate_layer0_gpu8 -->
<g id="edge89" class="edge">
<title>expert_layer0_gpu8_expert8&#45;&gt;aggregate_layer0_gpu8</title>
<path fill="none" stroke="black" d="M9047.77,-11202.19C9053.08,-11193.72 9058.97,-11184.35 9064.86,-11174.97"/>
<polygon fill="black" stroke="black" points="9067.9,-11176.71 9070.26,-11166.38 9061.98,-11172.99 9067.9,-11176.71"/>
</g>
<!-- expert_layer0_gpu9_expert9 -->
<g id="node43" class="node">
<title>expert_layer0_gpu9_expert9</title>
<path fill="lightcoral" stroke="black" d="M10036.5,-11270.25C10036.5,-11270.25 9567.5,-11270.25 9567.5,-11270.25 9561.5,-11270.25 9555.5,-11264.25 9555.5,-11258.25 9555.5,-11258.25 9555.5,-11214.25 9555.5,-11214.25 9555.5,-11208.25 9561.5,-11202.25 9567.5,-11202.25 9567.5,-11202.25 10036.5,-11202.25 10036.5,-11202.25 10042.5,-11202.25 10048.5,-11208.25 10048.5,-11214.25 10048.5,-11214.25 10048.5,-11258.25 10048.5,-11258.25 10048.5,-11264.25 10042.5,-11270.25 10036.5,-11270.25"/>
<text text-anchor="middle" x="9802" y="-11255.05" font-family="Times,serif" font-size="14.00">Expert 9 Layer 0 GPU 9</text>
<text text-anchor="middle" x="9802" y="-11240.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9802" y="-11225.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9802" y="-11210.05" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer0_gpu9 -->
<g id="node69" class="node">
<title>aggregate_layer0_gpu9</title>
<path fill="orange" stroke="black" d="M10300.29,-11166.25C10300.29,-11166.25 9813.19,-11166.25 9813.19,-11166.25 9807.19,-11166.25 9796.52,-11162.49 9791.85,-11158.72 9791.85,-11158.72 9679.06,-11067.78 9679.06,-11067.78 9674.38,-11064.02 9675.71,-11060.25 9681.71,-11060.25 9681.71,-11060.25 10168.81,-11060.25 10168.81,-11060.25 10174.81,-11060.25 10185.48,-11064.02 10190.15,-11067.78 10190.15,-11067.78 10302.94,-11158.72 10302.94,-11158.72 10307.62,-11162.49 10306.29,-11166.25 10300.29,-11166.25"/>
<text text-anchor="middle" x="9991" y="-11124.55" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 0 GPU 9</text>
<text text-anchor="middle" x="9991" y="-11109.55" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="9991" y="-11094.55" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer0_gpu9_expert9&#45;&gt;aggregate_layer0_gpu9 -->
<g id="edge90" class="edge">
<title>expert_layer0_gpu9_expert9&#45;&gt;aggregate_layer0_gpu9</title>
<path fill="none" stroke="black" d="M9853.65,-11202.19C9868.35,-11192.77 9884.81,-11182.24 9901.09,-11171.81"/>
<polygon fill="black" stroke="black" points="9903.04,-11174.72 9909.58,-11166.38 9899.27,-11168.82 9903.04,-11174.72"/>
</g>
<!-- expert_layer0_gpu10_expert10 -->
<g id="node44" class="node">
<title>expert_layer0_gpu10_expert10</title>
<path fill="lightcoral" stroke="black" d="M10876.5,-11270.25C10876.5,-11270.25 10407.5,-11270.25 10407.5,-11270.25 10401.5,-11270.25 10395.5,-11264.25 10395.5,-11258.25 10395.5,-11258.25 10395.5,-11214.25 10395.5,-11214.25 10395.5,-11208.25 10401.5,-11202.25 10407.5,-11202.25 10407.5,-11202.25 10876.5,-11202.25 10876.5,-11202.25 10882.5,-11202.25 10888.5,-11208.25 10888.5,-11214.25 10888.5,-11214.25 10888.5,-11258.25 10888.5,-11258.25 10888.5,-11264.25 10882.5,-11270.25 10876.5,-11270.25"/>
<text text-anchor="middle" x="10642" y="-11255.05" font-family="Times,serif" font-size="14.00">Expert 10 Layer 0 GPU 10</text>
<text text-anchor="middle" x="10642" y="-11240.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10642" y="-11225.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10642" y="-11210.05" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer0_gpu10 -->
<g id="node71" class="node">
<title>aggregate_layer0_gpu10</title>
<path fill="orange" stroke="black" d="M11205.29,-11166.25C11205.29,-11166.25 10718.19,-11166.25 10718.19,-11166.25 10712.19,-11166.25 10701.52,-11162.49 10696.85,-11158.72 10696.85,-11158.72 10584.06,-11067.78 10584.06,-11067.78 10579.38,-11064.02 10580.71,-11060.25 10586.71,-11060.25 10586.71,-11060.25 11073.81,-11060.25 11073.81,-11060.25 11079.81,-11060.25 11090.48,-11064.02 11095.15,-11067.78 11095.15,-11067.78 11207.94,-11158.72 11207.94,-11158.72 11212.62,-11162.49 11211.29,-11166.25 11205.29,-11166.25"/>
<text text-anchor="middle" x="10896" y="-11124.55" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 0 GPU 10</text>
<text text-anchor="middle" x="10896" y="-11109.55" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="10896" y="-11094.55" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer0_gpu10_expert10&#45;&gt;aggregate_layer0_gpu10 -->
<g id="edge91" class="edge">
<title>expert_layer0_gpu10_expert10&#45;&gt;aggregate_layer0_gpu10</title>
<path fill="none" stroke="black" d="M10711.41,-11202.19C10731.8,-11192.47 10754.72,-11181.56 10777.28,-11170.81"/>
<polygon fill="black" stroke="black" points="10779.05,-11173.84 10786.58,-11166.38 10776.04,-11167.52 10779.05,-11173.84"/>
</g>
<!-- expert_layer0_gpu11_expert11 -->
<g id="node45" class="node">
<title>expert_layer0_gpu11_expert11</title>
<path fill="lightcoral" stroke="black" d="M11687.5,-11270.25C11687.5,-11270.25 11218.5,-11270.25 11218.5,-11270.25 11212.5,-11270.25 11206.5,-11264.25 11206.5,-11258.25 11206.5,-11258.25 11206.5,-11214.25 11206.5,-11214.25 11206.5,-11208.25 11212.5,-11202.25 11218.5,-11202.25 11218.5,-11202.25 11687.5,-11202.25 11687.5,-11202.25 11693.5,-11202.25 11699.5,-11208.25 11699.5,-11214.25 11699.5,-11214.25 11699.5,-11258.25 11699.5,-11258.25 11699.5,-11264.25 11693.5,-11270.25 11687.5,-11270.25"/>
<text text-anchor="middle" x="11453" y="-11255.05" font-family="Times,serif" font-size="14.00">Expert 11 Layer 0 GPU 11</text>
<text text-anchor="middle" x="11453" y="-11240.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11453" y="-11225.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11453" y="-11210.05" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer0_gpu11 -->
<g id="node73" class="node">
<title>aggregate_layer0_gpu11</title>
<path fill="orange" stroke="black" d="M11988.29,-11166.25C11988.29,-11166.25 11501.19,-11166.25 11501.19,-11166.25 11495.19,-11166.25 11484.52,-11162.49 11479.85,-11158.72 11479.85,-11158.72 11367.06,-11067.78 11367.06,-11067.78 11362.38,-11064.02 11363.71,-11060.25 11369.71,-11060.25 11369.71,-11060.25 11856.81,-11060.25 11856.81,-11060.25 11862.81,-11060.25 11873.48,-11064.02 11878.15,-11067.78 11878.15,-11067.78 11990.94,-11158.72 11990.94,-11158.72 11995.62,-11162.49 11994.29,-11166.25 11988.29,-11166.25"/>
<text text-anchor="middle" x="11679" y="-11124.55" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 0 GPU 11</text>
<text text-anchor="middle" x="11679" y="-11109.55" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="11679" y="-11094.55" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer0_gpu11_expert11&#45;&gt;aggregate_layer0_gpu11 -->
<g id="edge92" class="edge">
<title>expert_layer0_gpu11_expert11&#45;&gt;aggregate_layer0_gpu11</title>
<path fill="none" stroke="black" d="M11514.76,-11202.19C11532.66,-11192.6 11552.75,-11181.85 11572.56,-11171.24"/>
<polygon fill="black" stroke="black" points="11574.48,-11174.19 11581.64,-11166.38 11571.17,-11168.01 11574.48,-11174.19"/>
</g>
<!-- expert_layer0_gpu12_expert12 -->
<g id="node46" class="node">
<title>expert_layer0_gpu12_expert12</title>
<path fill="lightcoral" stroke="black" d="M12454.5,-11270.25C12454.5,-11270.25 11985.5,-11270.25 11985.5,-11270.25 11979.5,-11270.25 11973.5,-11264.25 11973.5,-11258.25 11973.5,-11258.25 11973.5,-11214.25 11973.5,-11214.25 11973.5,-11208.25 11979.5,-11202.25 11985.5,-11202.25 11985.5,-11202.25 12454.5,-11202.25 12454.5,-11202.25 12460.5,-11202.25 12466.5,-11208.25 12466.5,-11214.25 12466.5,-11214.25 12466.5,-11258.25 12466.5,-11258.25 12466.5,-11264.25 12460.5,-11270.25 12454.5,-11270.25"/>
<text text-anchor="middle" x="12220" y="-11255.05" font-family="Times,serif" font-size="14.00">Expert 12 Layer 0 GPU 12</text>
<text text-anchor="middle" x="12220" y="-11240.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12220" y="-11225.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12220" y="-11210.05" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer0_gpu12 -->
<g id="node75" class="node">
<title>aggregate_layer0_gpu12</title>
<path fill="orange" stroke="black" d="M12710.29,-11166.25C12710.29,-11166.25 12223.19,-11166.25 12223.19,-11166.25 12217.19,-11166.25 12206.52,-11162.49 12201.85,-11158.72 12201.85,-11158.72 12089.06,-11067.78 12089.06,-11067.78 12084.38,-11064.02 12085.71,-11060.25 12091.71,-11060.25 12091.71,-11060.25 12578.81,-11060.25 12578.81,-11060.25 12584.81,-11060.25 12595.48,-11064.02 12600.15,-11067.78 12600.15,-11067.78 12712.94,-11158.72 12712.94,-11158.72 12717.62,-11162.49 12716.29,-11166.25 12710.29,-11166.25"/>
<text text-anchor="middle" x="12401" y="-11124.55" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 0 GPU 12</text>
<text text-anchor="middle" x="12401" y="-11109.55" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="12401" y="-11094.55" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer0_gpu12_expert12&#45;&gt;aggregate_layer0_gpu12 -->
<g id="edge93" class="edge">
<title>expert_layer0_gpu12_expert12&#45;&gt;aggregate_layer0_gpu12</title>
<path fill="none" stroke="black" d="M12269.46,-11202.19C12283.41,-11192.86 12299.02,-11182.43 12314.47,-11172.1"/>
<polygon fill="black" stroke="black" points="12316.66,-11174.85 12323.03,-11166.38 12312.77,-11169.03 12316.66,-11174.85"/>
</g>
<!-- expert_layer0_gpu13_expert13 -->
<g id="node47" class="node">
<title>expert_layer0_gpu13_expert13</title>
<path fill="lightcoral" stroke="black" d="M13183.5,-11270.25C13183.5,-11270.25 12714.5,-11270.25 12714.5,-11270.25 12708.5,-11270.25 12702.5,-11264.25 12702.5,-11258.25 12702.5,-11258.25 12702.5,-11214.25 12702.5,-11214.25 12702.5,-11208.25 12708.5,-11202.25 12714.5,-11202.25 12714.5,-11202.25 13183.5,-11202.25 13183.5,-11202.25 13189.5,-11202.25 13195.5,-11208.25 13195.5,-11214.25 13195.5,-11214.25 13195.5,-11258.25 13195.5,-11258.25 13195.5,-11264.25 13189.5,-11270.25 13183.5,-11270.25"/>
<text text-anchor="middle" x="12949" y="-11255.05" font-family="Times,serif" font-size="14.00">Expert 13 Layer 0 GPU 13</text>
<text text-anchor="middle" x="12949" y="-11240.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12949" y="-11225.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12949" y="-11210.05" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer0_gpu13 -->
<g id="node77" class="node">
<title>aggregate_layer0_gpu13</title>
<path fill="orange" stroke="black" d="M13401.29,-11166.25C13401.29,-11166.25 12914.19,-11166.25 12914.19,-11166.25 12908.19,-11166.25 12897.52,-11162.49 12892.85,-11158.72 12892.85,-11158.72 12780.06,-11067.78 12780.06,-11067.78 12775.38,-11064.02 12776.71,-11060.25 12782.71,-11060.25 12782.71,-11060.25 13269.81,-11060.25 13269.81,-11060.25 13275.81,-11060.25 13286.48,-11064.02 13291.15,-11067.78 13291.15,-11067.78 13403.94,-11158.72 13403.94,-11158.72 13408.62,-11162.49 13407.29,-11166.25 13401.29,-11166.25"/>
<text text-anchor="middle" x="13092" y="-11124.55" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 0 GPU 13</text>
<text text-anchor="middle" x="13092" y="-11109.55" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="13092" y="-11094.55" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer0_gpu13_expert13&#45;&gt;aggregate_layer0_gpu13 -->
<g id="edge94" class="edge">
<title>expert_layer0_gpu13_expert13&#45;&gt;aggregate_layer0_gpu13</title>
<path fill="none" stroke="black" d="M12988.08,-11202.19C12998.79,-11193.12 13010.74,-11183.01 13022.62,-11172.96"/>
<polygon fill="black" stroke="black" points="13025.02,-11175.51 13030.4,-11166.38 13020.5,-11170.17 13025.02,-11175.51"/>
</g>
<!-- expert_layer0_gpu14_expert14 -->
<g id="node48" class="node">
<title>expert_layer0_gpu14_expert14</title>
<path fill="lightcoral" stroke="black" d="M13885.5,-11270.25C13885.5,-11270.25 13416.5,-11270.25 13416.5,-11270.25 13410.5,-11270.25 13404.5,-11264.25 13404.5,-11258.25 13404.5,-11258.25 13404.5,-11214.25 13404.5,-11214.25 13404.5,-11208.25 13410.5,-11202.25 13416.5,-11202.25 13416.5,-11202.25 13885.5,-11202.25 13885.5,-11202.25 13891.5,-11202.25 13897.5,-11208.25 13897.5,-11214.25 13897.5,-11214.25 13897.5,-11258.25 13897.5,-11258.25 13897.5,-11264.25 13891.5,-11270.25 13885.5,-11270.25"/>
<text text-anchor="middle" x="13651" y="-11255.05" font-family="Times,serif" font-size="14.00">Expert 14 Layer 0 GPU 14</text>
<text text-anchor="middle" x="13651" y="-11240.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="13651" y="-11225.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="13651" y="-11210.05" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer0_gpu14 -->
<g id="node79" class="node">
<title>aggregate_layer0_gpu14</title>
<path fill="orange" stroke="black" d="M14077.29,-11166.25C14077.29,-11166.25 13590.19,-11166.25 13590.19,-11166.25 13584.19,-11166.25 13573.52,-11162.49 13568.85,-11158.72 13568.85,-11158.72 13456.06,-11067.78 13456.06,-11067.78 13451.38,-11064.02 13452.71,-11060.25 13458.71,-11060.25 13458.71,-11060.25 13945.81,-11060.25 13945.81,-11060.25 13951.81,-11060.25 13962.48,-11064.02 13967.15,-11067.78 13967.15,-11067.78 14079.94,-11158.72 14079.94,-11158.72 14084.62,-11162.49 14083.29,-11166.25 14077.29,-11166.25"/>
<text text-anchor="middle" x="13768" y="-11124.55" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 0 GPU 14</text>
<text text-anchor="middle" x="13768" y="-11109.55" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="13768" y="-11094.55" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer0_gpu14_expert14&#45;&gt;aggregate_layer0_gpu14 -->
<g id="edge95" class="edge">
<title>expert_layer0_gpu14_expert14&#45;&gt;aggregate_layer0_gpu14</title>
<path fill="none" stroke="black" d="M13682.97,-11202.19C13691.49,-11193.38 13700.96,-11183.58 13710.4,-11173.82"/>
<polygon fill="black" stroke="black" points="13713.16,-11176 13717.6,-11166.38 13708.13,-11171.14 13713.16,-11176"/>
</g>
<!-- expert_layer0_gpu15_expert15 -->
<g id="node49" class="node">
<title>expert_layer0_gpu15_expert15</title>
<path fill="lightcoral" stroke="black" d="M14960.5,-11270.25C14960.5,-11270.25 14491.5,-11270.25 14491.5,-11270.25 14485.5,-11270.25 14479.5,-11264.25 14479.5,-11258.25 14479.5,-11258.25 14479.5,-11214.25 14479.5,-11214.25 14479.5,-11208.25 14485.5,-11202.25 14491.5,-11202.25 14491.5,-11202.25 14960.5,-11202.25 14960.5,-11202.25 14966.5,-11202.25 14972.5,-11208.25 14972.5,-11214.25 14972.5,-11214.25 14972.5,-11258.25 14972.5,-11258.25 14972.5,-11264.25 14966.5,-11270.25 14960.5,-11270.25"/>
<text text-anchor="middle" x="14726" y="-11255.05" font-family="Times,serif" font-size="14.00">Expert 15 Layer 0 GPU 15</text>
<text text-anchor="middle" x="14726" y="-11240.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14726" y="-11225.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14726" y="-11210.05" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer0_gpu15 -->
<g id="node81" class="node">
<title>aggregate_layer0_gpu15</title>
<path fill="orange" stroke="black" d="M15525.29,-11166.25C15525.29,-11166.25 15038.19,-11166.25 15038.19,-11166.25 15032.19,-11166.25 15021.52,-11162.49 15016.85,-11158.72 15016.85,-11158.72 14904.06,-11067.78 14904.06,-11067.78 14899.38,-11064.02 14900.71,-11060.25 14906.71,-11060.25 14906.71,-11060.25 15393.81,-11060.25 15393.81,-11060.25 15399.81,-11060.25 15410.48,-11064.02 15415.15,-11067.78 15415.15,-11067.78 15527.94,-11158.72 15527.94,-11158.72 15532.62,-11162.49 15531.29,-11166.25 15525.29,-11166.25"/>
<text text-anchor="middle" x="15216" y="-11124.55" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 0 GPU 15</text>
<text text-anchor="middle" x="15216" y="-11109.55" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="15216" y="-11094.55" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer0_gpu15_expert15&#45;&gt;aggregate_layer0_gpu15 -->
<g id="edge96" class="edge">
<title>expert_layer0_gpu15_expert15&#45;&gt;aggregate_layer0_gpu15</title>
<path fill="none" stroke="black" d="M14859.89,-11202.19C14906.61,-11190.65 14960.17,-11177.43 15011.32,-11164.8"/>
<polygon fill="black" stroke="black" points="15012.3,-11168.16 15021.17,-11162.36 15010.63,-11161.36 15012.3,-11168.16"/>
</g>
<!-- comm_layer0 -->
<g id="node82" class="node">
<title>comm_layer0</title>
<ellipse fill="lightpink" stroke="black" cx="8696" cy="-11343.73" rx="243.49" ry="37.45"/>
<text text-anchor="middle" x="8696" y="-11355.03" font-family="Times,serif" font-size="14.00">Cross&#45;GPU Communication Layer 0</text>
<text text-anchor="middle" x="8696" y="-11340.03" font-family="Times,serif" font-size="14.00">Input: Tokens from routing decisions</text>
<text text-anchor="middle" x="8696" y="-11325.03" font-family="Times,serif" font-size="14.00">Output: Tokens delivered to destination GPUs</text>
</g>
<!-- route_layer0_gpu0&#45;&gt;comm_layer0 -->
<g id="edge49" class="edge">
<title>route_layer0_gpu0&#45;&gt;comm_layer0</title>
<path fill="none" stroke="black" d="M2045.53,-11445.52C2161.41,-11434.84 2303.41,-11423.29 2431,-11417.21 3631.02,-11360.02 7424.69,-11347.56 8442.57,-11345.22"/>
<polygon fill="black" stroke="black" points="8442.59,-11348.72 8452.58,-11345.2 8442.57,-11341.72 8442.59,-11348.72"/>
</g>
<!-- mha_layer1_gpu0 -->
<g id="node83" class="node">
<title>mha_layer1_gpu0</title>
<path fill="lightblue" stroke="black" d="M2105,-11024.25C2105,-11024.25 1657,-11024.25 1657,-11024.25 1651,-11024.25 1645,-11018.25 1645,-11012.25 1645,-11012.25 1645,-10983.25 1645,-10983.25 1645,-10977.25 1651,-10971.25 1657,-10971.25 1657,-10971.25 2105,-10971.25 2105,-10971.25 2111,-10971.25 2117,-10977.25 2117,-10983.25 2117,-10983.25 2117,-11012.25 2117,-11012.25 2117,-11018.25 2111,-11024.25 2105,-11024.25"/>
<text text-anchor="middle" x="1881" y="-11009.05" font-family="Times,serif" font-size="14.00">MHA Layer 1 GPU 0</text>
<text text-anchor="middle" x="1881" y="-10994.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1881" y="-10979.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer0_gpu0&#45;&gt;mha_layer1_gpu0 -->
<g id="edge97" class="edge">
<title>aggregate_layer0_gpu0&#45;&gt;mha_layer1_gpu0</title>
<path fill="none" stroke="black" d="M1916.7,-11060.15C1911.38,-11051 1905.96,-11041.67 1901,-11033.15"/>
<polygon fill="black" stroke="black" points="1903.89,-11031.15 1895.84,-11024.27 1897.84,-11034.67 1903.89,-11031.15"/>
</g>
<!-- route_layer0_gpu1&#45;&gt;comm_layer0 -->
<g id="edge50" class="edge">
<title>route_layer0_gpu1&#45;&gt;comm_layer0</title>
<path fill="none" stroke="black" d="M3002.65,-11440.2C3082.9,-11431.15 3173.83,-11422.24 3257,-11417.21 4285.4,-11355.02 7512.02,-11346.19 8442.51,-11344.94"/>
<polygon fill="black" stroke="black" points="8442.68,-11348.44 8452.68,-11344.92 8442.67,-11341.44 8442.68,-11348.44"/>
</g>
<!-- mha_layer1_gpu1 -->
<g id="node84" class="node">
<title>mha_layer1_gpu1</title>
<path fill="lightblue" stroke="black" d="M2832,-11024.25C2832,-11024.25 2384,-11024.25 2384,-11024.25 2378,-11024.25 2372,-11018.25 2372,-11012.25 2372,-11012.25 2372,-10983.25 2372,-10983.25 2372,-10977.25 2378,-10971.25 2384,-10971.25 2384,-10971.25 2832,-10971.25 2832,-10971.25 2838,-10971.25 2844,-10977.25 2844,-10983.25 2844,-10983.25 2844,-11012.25 2844,-11012.25 2844,-11018.25 2838,-11024.25 2832,-11024.25"/>
<text text-anchor="middle" x="2608" y="-11009.05" font-family="Times,serif" font-size="14.00">MHA Layer 1 GPU 1</text>
<text text-anchor="middle" x="2608" y="-10994.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2608" y="-10979.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer0_gpu1&#45;&gt;mha_layer1_gpu1 -->
<g id="edge98" class="edge">
<title>aggregate_layer0_gpu1&#45;&gt;mha_layer1_gpu1</title>
<path fill="none" stroke="black" d="M2772.46,-11060.15C2742.71,-11049.05 2712.32,-11037.7 2685.89,-11027.83"/>
<polygon fill="black" stroke="black" points="2686.93,-11024.49 2676.34,-11024.27 2684.48,-11031.04 2686.93,-11024.49"/>
</g>
<!-- route_layer0_gpu2&#45;&gt;comm_layer0 -->
<g id="edge51" class="edge">
<title>route_layer0_gpu2&#45;&gt;comm_layer0</title>
<path fill="none" stroke="black" d="M3840.65,-11449.58C3989.69,-11438.16 4185.37,-11424.61 4359,-11417.21 5909.36,-11351.12 7773.87,-11344.46 8442.28,-11344.38"/>
<polygon fill="black" stroke="black" points="8442.52,-11347.88 8452.52,-11344.38 8442.52,-11340.88 8442.52,-11347.88"/>
</g>
<!-- mha_layer1_gpu2 -->
<g id="node85" class="node">
<title>mha_layer1_gpu2</title>
<path fill="lightblue" stroke="black" d="M3797,-11024.25C3797,-11024.25 3349,-11024.25 3349,-11024.25 3343,-11024.25 3337,-11018.25 3337,-11012.25 3337,-11012.25 3337,-10983.25 3337,-10983.25 3337,-10977.25 3343,-10971.25 3349,-10971.25 3349,-10971.25 3797,-10971.25 3797,-10971.25 3803,-10971.25 3809,-10977.25 3809,-10983.25 3809,-10983.25 3809,-11012.25 3809,-11012.25 3809,-11018.25 3803,-11024.25 3797,-11024.25"/>
<text text-anchor="middle" x="3573" y="-11009.05" font-family="Times,serif" font-size="14.00">MHA Layer 1 GPU 2</text>
<text text-anchor="middle" x="3573" y="-10994.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3573" y="-10979.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer0_gpu2&#45;&gt;mha_layer1_gpu2 -->
<g id="edge99" class="edge">
<title>aggregate_layer0_gpu2&#45;&gt;mha_layer1_gpu2</title>
<path fill="none" stroke="black" d="M3736.92,-11060.15C3707.26,-11049.05 3676.97,-11037.7 3650.63,-11027.83"/>
<polygon fill="black" stroke="black" points="3651.7,-11024.5 3641.11,-11024.27 3649.25,-11031.05 3651.7,-11024.5"/>
</g>
<!-- route_layer0_gpu3&#45;&gt;comm_layer0 -->
<g id="edge52" class="edge">
<title>route_layer0_gpu3&#45;&gt;comm_layer0</title>
<path fill="none" stroke="black" d="M4930.98,-11440.51C5011.15,-11431.5 5101.95,-11422.53 5185,-11417.21 5819.22,-11376.53 7748.92,-11354.04 8443.51,-11347.09"/>
<polygon fill="black" stroke="black" points="8443.68,-11350.59 8453.65,-11346.99 8443.61,-11343.59 8443.68,-11350.59"/>
</g>
<!-- mha_layer1_gpu3 -->
<g id="node86" class="node">
<title>mha_layer1_gpu3</title>
<path fill="lightblue" stroke="black" d="M5064,-11024.25C5064,-11024.25 4616,-11024.25 4616,-11024.25 4610,-11024.25 4604,-11018.25 4604,-11012.25 4604,-11012.25 4604,-10983.25 4604,-10983.25 4604,-10977.25 4610,-10971.25 4616,-10971.25 4616,-10971.25 5064,-10971.25 5064,-10971.25 5070,-10971.25 5076,-10977.25 5076,-10983.25 5076,-10983.25 5076,-11012.25 5076,-11012.25 5076,-11018.25 5070,-11024.25 5064,-11024.25"/>
<text text-anchor="middle" x="4840" y="-11009.05" font-family="Times,serif" font-size="14.00">MHA Layer 1 GPU 3</text>
<text text-anchor="middle" x="4840" y="-10994.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4840" y="-10979.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer0_gpu3&#45;&gt;mha_layer1_gpu3 -->
<g id="edge100" class="edge">
<title>aggregate_layer0_gpu3&#45;&gt;mha_layer1_gpu3</title>
<path fill="none" stroke="black" d="M4921.69,-11060.15C4908.21,-11050.02 4894.46,-11039.69 4882.19,-11030.46"/>
<polygon fill="black" stroke="black" points="4884.04,-11027.48 4873.94,-11024.27 4879.83,-11033.07 4884.04,-11027.48"/>
</g>
<!-- route_layer0_gpu4&#45;&gt;comm_layer0 -->
<g id="edge53" class="edge">
<title>route_layer0_gpu4&#45;&gt;comm_layer0</title>
<path fill="none" stroke="black" d="M5764.68,-11446.36C5880.37,-11435.93 6021.88,-11424.34 6149,-11417.21 6988.61,-11370.09 7985.72,-11352.98 8443.45,-11347.3"/>
<polygon fill="black" stroke="black" points="8443.54,-11350.8 8453.5,-11347.17 8443.45,-11343.8 8443.54,-11350.8"/>
</g>
<!-- mha_layer1_gpu4 -->
<g id="node87" class="node">
<title>mha_layer1_gpu4</title>
<path fill="lightblue" stroke="black" d="M5871,-11024.25C5871,-11024.25 5423,-11024.25 5423,-11024.25 5417,-11024.25 5411,-11018.25 5411,-11012.25 5411,-11012.25 5411,-10983.25 5411,-10983.25 5411,-10977.25 5417,-10971.25 5423,-10971.25 5423,-10971.25 5871,-10971.25 5871,-10971.25 5877,-10971.25 5883,-10977.25 5883,-10983.25 5883,-10983.25 5883,-11012.25 5883,-11012.25 5883,-11018.25 5877,-11024.25 5871,-11024.25"/>
<text text-anchor="middle" x="5647" y="-11009.05" font-family="Times,serif" font-size="14.00">MHA Layer 1 GPU 4</text>
<text text-anchor="middle" x="5647" y="-10994.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5647" y="-10979.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer0_gpu4&#45;&gt;mha_layer1_gpu4 -->
<g id="edge101" class="edge">
<title>aggregate_layer0_gpu4&#45;&gt;mha_layer1_gpu4</title>
<path fill="none" stroke="black" d="M5734.1,-11060.15C5719.59,-11049.92 5704.79,-11039.49 5691.6,-11030.2"/>
<polygon fill="black" stroke="black" points="5693.38,-11027.17 5683.19,-11024.27 5689.35,-11032.89 5693.38,-11027.17"/>
</g>
<!-- route_layer0_gpu5&#45;&gt;comm_layer0 -->
<g id="edge54" class="edge">
<title>route_layer0_gpu5&#45;&gt;comm_layer0</title>
<path fill="none" stroke="black" d="M6729.84,-11447.22C6845.34,-11437.04 6986.35,-11425.41 7113,-11417.21 7585.57,-11386.58 8138.32,-11364.37 8449.77,-11353.11"/>
<polygon fill="black" stroke="black" points="8449.97,-11356.6 8459.84,-11352.75 8449.72,-11349.61 8449.97,-11356.6"/>
</g>
<!-- mha_layer1_gpu5 -->
<g id="node88" class="node">
<title>mha_layer1_gpu5</title>
<path fill="lightblue" stroke="black" d="M6663,-11024.25C6663,-11024.25 6215,-11024.25 6215,-11024.25 6209,-11024.25 6203,-11018.25 6203,-11012.25 6203,-11012.25 6203,-10983.25 6203,-10983.25 6203,-10977.25 6209,-10971.25 6215,-10971.25 6215,-10971.25 6663,-10971.25 6663,-10971.25 6669,-10971.25 6675,-10977.25 6675,-10983.25 6675,-10983.25 6675,-11012.25 6675,-11012.25 6675,-11018.25 6669,-11024.25 6663,-11024.25"/>
<text text-anchor="middle" x="6439" y="-11009.05" font-family="Times,serif" font-size="14.00">MHA Layer 1 GPU 5</text>
<text text-anchor="middle" x="6439" y="-10994.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6439" y="-10979.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer0_gpu5&#45;&gt;mha_layer1_gpu5 -->
<g id="edge102" class="edge">
<title>aggregate_layer0_gpu5&#45;&gt;mha_layer1_gpu5</title>
<path fill="none" stroke="black" d="M6602.92,-11060.15C6573.26,-11049.05 6542.97,-11037.7 6516.63,-11027.83"/>
<polygon fill="black" stroke="black" points="6517.7,-11024.5 6507.11,-11024.27 6515.25,-11031.05 6517.7,-11024.5"/>
</g>
<!-- route_layer0_gpu6&#45;&gt;comm_layer0 -->
<g id="edge55" class="edge">
<title>route_layer0_gpu6&#45;&gt;comm_layer0</title>
<path fill="none" stroke="black" d="M7688.93,-11443.61C7768.22,-11435.02 7857.46,-11425.51 7939,-11417.21 8121.32,-11398.64 8328.49,-11378.9 8479.96,-11364.72"/>
<polygon fill="black" stroke="black" points="8480.68,-11368.17 8490.31,-11363.75 8480.02,-11361.2 8480.68,-11368.17"/>
</g>
<!-- mha_layer1_gpu6 -->
<g id="node89" class="node">
<title>mha_layer1_gpu6</title>
<path fill="lightblue" stroke="black" d="M7665,-11024.25C7665,-11024.25 7217,-11024.25 7217,-11024.25 7211,-11024.25 7205,-11018.25 7205,-11012.25 7205,-11012.25 7205,-10983.25 7205,-10983.25 7205,-10977.25 7211,-10971.25 7217,-10971.25 7217,-10971.25 7665,-10971.25 7665,-10971.25 7671,-10971.25 7677,-10977.25 7677,-10983.25 7677,-10983.25 7677,-11012.25 7677,-11012.25 7677,-11018.25 7671,-11024.25 7665,-11024.25"/>
<text text-anchor="middle" x="7441" y="-11009.05" font-family="Times,serif" font-size="14.00">MHA Layer 1 GPU 6</text>
<text text-anchor="middle" x="7441" y="-10994.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7441" y="-10979.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer0_gpu6&#45;&gt;mha_layer1_gpu6 -->
<g id="edge103" class="edge">
<title>aggregate_layer0_gpu6&#45;&gt;mha_layer1_gpu6</title>
<path fill="none" stroke="black" d="M7502.13,-11060.15C7492.43,-11050.41 7482.55,-11040.48 7473.63,-11031.53"/>
<polygon fill="black" stroke="black" points="7475.94,-11028.88 7466.4,-11024.27 7470.98,-11033.82 7475.94,-11028.88"/>
</g>
<!-- route_layer0_gpu7&#45;&gt;comm_layer0 -->
<g id="edge56" class="edge">
<title>route_layer0_gpu7&#45;&gt;comm_layer0</title>
<path fill="none" stroke="black" d="M8455.76,-11417.14C8497.02,-11404.7 8540.13,-11391.71 8578.26,-11380.22"/>
<polygon fill="black" stroke="black" points="8579.27,-11383.57 8587.84,-11377.33 8577.25,-11376.86 8579.27,-11383.57"/>
</g>
<!-- mha_layer1_gpu7 -->
<g id="node90" class="node">
<title>mha_layer1_gpu7</title>
<path fill="lightblue" stroke="black" d="M8507,-11024.25C8507,-11024.25 8059,-11024.25 8059,-11024.25 8053,-11024.25 8047,-11018.25 8047,-11012.25 8047,-11012.25 8047,-10983.25 8047,-10983.25 8047,-10977.25 8053,-10971.25 8059,-10971.25 8059,-10971.25 8507,-10971.25 8507,-10971.25 8513,-10971.25 8519,-10977.25 8519,-10983.25 8519,-10983.25 8519,-11012.25 8519,-11012.25 8519,-11018.25 8513,-11024.25 8507,-11024.25"/>
<text text-anchor="middle" x="8283" y="-11009.05" font-family="Times,serif" font-size="14.00">MHA Layer 1 GPU 7</text>
<text text-anchor="middle" x="8283" y="-10994.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8283" y="-10979.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer0_gpu7&#45;&gt;mha_layer1_gpu7 -->
<g id="edge104" class="edge">
<title>aggregate_layer0_gpu7&#45;&gt;mha_layer1_gpu7</title>
<path fill="none" stroke="black" d="M8287.33,-11060.15C8286.71,-11051.39 8286.08,-11042.47 8285.5,-11034.25"/>
<polygon fill="black" stroke="black" points="8288.99,-11034 8284.8,-11024.27 8282.01,-11034.49 8288.99,-11034"/>
</g>
<!-- route_layer0_gpu8&#45;&gt;comm_layer0 -->
<g id="edge57" class="edge">
<title>route_layer0_gpu8&#45;&gt;comm_layer0</title>
<path fill="none" stroke="black" d="M8936.24,-11417.14C8894.98,-11404.7 8851.87,-11391.71 8813.74,-11380.22"/>
<polygon fill="black" stroke="black" points="8814.75,-11376.86 8804.16,-11377.33 8812.73,-11383.57 8814.75,-11376.86"/>
</g>
<!-- mha_layer1_gpu8 -->
<g id="node91" class="node">
<title>mha_layer1_gpu8</title>
<path fill="lightblue" stroke="black" d="M9397,-11024.25C9397,-11024.25 8949,-11024.25 8949,-11024.25 8943,-11024.25 8937,-11018.25 8937,-11012.25 8937,-11012.25 8937,-10983.25 8937,-10983.25 8937,-10977.25 8943,-10971.25 8949,-10971.25 8949,-10971.25 9397,-10971.25 9397,-10971.25 9403,-10971.25 9409,-10977.25 9409,-10983.25 9409,-10983.25 9409,-11012.25 9409,-11012.25 9409,-11018.25 9403,-11024.25 9397,-11024.25"/>
<text text-anchor="middle" x="9173" y="-11009.05" font-family="Times,serif" font-size="14.00">MHA Layer 1 GPU 8</text>
<text text-anchor="middle" x="9173" y="-10994.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9173" y="-10979.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer0_gpu8&#45;&gt;mha_layer1_gpu8 -->
<g id="edge105" class="edge">
<title>aggregate_layer0_gpu8&#45;&gt;mha_layer1_gpu8</title>
<path fill="none" stroke="black" d="M9135.13,-11060.15C9140.84,-11050.9 9146.65,-11041.48 9151.95,-11032.88"/>
<polygon fill="black" stroke="black" points="9154.99,-11034.62 9157.26,-11024.27 9149.04,-11030.94 9154.99,-11034.62"/>
</g>
<!-- route_layer0_gpu9&#45;&gt;comm_layer0 -->
<g id="edge58" class="edge">
<title>route_layer0_gpu9&#45;&gt;comm_layer0</title>
<path fill="none" stroke="black" d="M9698.57,-11440.14C9456.68,-11417.12 9124.9,-11385.55 8910.47,-11365.14"/>
<polygon fill="black" stroke="black" points="8910.64,-11361.64 8900.35,-11364.18 8909.97,-11368.61 8910.64,-11361.64"/>
</g>
<!-- mha_layer1_gpu9 -->
<g id="node92" class="node">
<title>mha_layer1_gpu9</title>
<path fill="lightblue" stroke="black" d="M10323,-11024.25C10323,-11024.25 9875,-11024.25 9875,-11024.25 9869,-11024.25 9863,-11018.25 9863,-11012.25 9863,-11012.25 9863,-10983.25 9863,-10983.25 9863,-10977.25 9869,-10971.25 9875,-10971.25 9875,-10971.25 10323,-10971.25 10323,-10971.25 10329,-10971.25 10335,-10977.25 10335,-10983.25 10335,-10983.25 10335,-11012.25 10335,-11012.25 10335,-11018.25 10329,-11024.25 10323,-11024.25"/>
<text text-anchor="middle" x="10099" y="-11009.05" font-family="Times,serif" font-size="14.00">MHA Layer 1 GPU 9</text>
<text text-anchor="middle" x="10099" y="-10994.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10099" y="-10979.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer0_gpu9&#45;&gt;mha_layer1_gpu9 -->
<g id="edge106" class="edge">
<title>aggregate_layer0_gpu9&#45;&gt;mha_layer1_gpu9</title>
<path fill="none" stroke="black" d="M10040.57,-11060.15C10049.85,-11050.41 10059.29,-11040.48 10067.81,-11031.53"/>
<polygon fill="black" stroke="black" points="10070.36,-11033.92 10074.72,-11024.27 10065.29,-11029.1 10070.36,-11033.92"/>
</g>
<!-- route_layer0_gpu10&#45;&gt;comm_layer0 -->
<g id="edge59" class="edge">
<title>route_layer0_gpu10&#45;&gt;comm_layer0</title>
<path fill="none" stroke="black" d="M10626.55,-11439.36C10536.84,-11431.33 10438.55,-11423.21 10348,-11417.21 9850.5,-11384.2 9267.68,-11362.62 8944.29,-11352.15"/>
<polygon fill="black" stroke="black" points="8943.96,-11348.64 8933.85,-11351.82 8943.73,-11355.64 8943.96,-11348.64"/>
</g>
<!-- mha_layer1_gpu10 -->
<g id="node93" class="node">
<title>mha_layer1_gpu10</title>
<path fill="lightblue" stroke="black" d="M11393,-11024.25C11393,-11024.25 10945,-11024.25 10945,-11024.25 10939,-11024.25 10933,-11018.25 10933,-11012.25 10933,-11012.25 10933,-10983.25 10933,-10983.25 10933,-10977.25 10939,-10971.25 10945,-10971.25 10945,-10971.25 11393,-10971.25 11393,-10971.25 11399,-10971.25 11405,-10977.25 11405,-10983.25 11405,-10983.25 11405,-11012.25 11405,-11012.25 11405,-11018.25 11399,-11024.25 11393,-11024.25"/>
<text text-anchor="middle" x="11169" y="-11009.05" font-family="Times,serif" font-size="14.00">MHA Layer 1 GPU 10</text>
<text text-anchor="middle" x="11169" y="-10994.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11169" y="-10979.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer0_gpu10&#45;&gt;mha_layer1_gpu10 -->
<g id="edge107" class="edge">
<title>aggregate_layer0_gpu10&#45;&gt;mha_layer1_gpu10</title>
<path fill="none" stroke="black" d="M11021.31,-11060.15C11047.68,-11049.19 11074.6,-11038 11098.12,-11028.22"/>
<polygon fill="black" stroke="black" points="11099.74,-11031.34 11107.63,-11024.27 11097.06,-11024.87 11099.74,-11031.34"/>
</g>
<!-- route_layer0_gpu11&#45;&gt;comm_layer0 -->
<g id="edge60" class="edge">
<title>route_layer0_gpu11&#45;&gt;comm_layer0</title>
<path fill="none" stroke="black" d="M11573.49,-11439.31C11478.53,-11430.98 11373.51,-11422.72 11277,-11417.21 10424.3,-11368.51 9411.18,-11352.15 8948.76,-11346.97"/>
<polygon fill="black" stroke="black" points="8948.65,-11343.47 8938.61,-11346.86 8948.57,-11350.47 8948.65,-11343.47"/>
</g>
<!-- mha_layer1_gpu11 -->
<g id="node94" class="node">
<title>mha_layer1_gpu11</title>
<path fill="lightblue" stroke="black" d="M12225,-11024.25C12225,-11024.25 11777,-11024.25 11777,-11024.25 11771,-11024.25 11765,-11018.25 11765,-11012.25 11765,-11012.25 11765,-10983.25 11765,-10983.25 11765,-10977.25 11771,-10971.25 11777,-10971.25 11777,-10971.25 12225,-10971.25 12225,-10971.25 12231,-10971.25 12237,-10977.25 12237,-10983.25 12237,-10983.25 12237,-11012.25 12237,-11012.25 12237,-11018.25 12231,-11024.25 12225,-11024.25"/>
<text text-anchor="middle" x="12001" y="-11009.05" font-family="Times,serif" font-size="14.00">MHA Layer 1 GPU 11</text>
<text text-anchor="middle" x="12001" y="-10994.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12001" y="-10979.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer0_gpu11&#45;&gt;mha_layer1_gpu11 -->
<g id="edge108" class="edge">
<title>aggregate_layer0_gpu11&#45;&gt;mha_layer1_gpu11</title>
<path fill="none" stroke="black" d="M11826.81,-11060.15C11858.46,-11049 11890.79,-11037.6 11918.87,-11027.7"/>
<polygon fill="black" stroke="black" points="11920.35,-11030.89 11928.62,-11024.27 11918.02,-11024.29 11920.35,-11030.89"/>
</g>
<!-- route_layer0_gpu12&#45;&gt;comm_layer0 -->
<g id="edge61" class="edge">
<title>route_layer0_gpu12&#45;&gt;comm_layer0</title>
<path fill="none" stroke="black" d="M12528.74,-11439.26C12431.41,-11430.78 12323.27,-11422.44 12224,-11417.21 10998.11,-11352.52 9529.78,-11344.69 8949.63,-11344.35"/>
<polygon fill="black" stroke="black" points="8949.47,-11340.85 8939.47,-11344.34 8949.46,-11347.85 8949.47,-11340.85"/>
</g>
<!-- mha_layer1_gpu12 -->
<g id="node95" class="node">
<title>mha_layer1_gpu12</title>
<path fill="lightblue" stroke="black" d="M12886,-11024.25C12886,-11024.25 12438,-11024.25 12438,-11024.25 12432,-11024.25 12426,-11018.25 12426,-11012.25 12426,-11012.25 12426,-10983.25 12426,-10983.25 12426,-10977.25 12432,-10971.25 12438,-10971.25 12438,-10971.25 12886,-10971.25 12886,-10971.25 12892,-10971.25 12898,-10977.25 12898,-10983.25 12898,-10983.25 12898,-11012.25 12898,-11012.25 12898,-11018.25 12892,-11024.25 12886,-11024.25"/>
<text text-anchor="middle" x="12662" y="-11009.05" font-family="Times,serif" font-size="14.00">MHA Layer 1 GPU 12</text>
<text text-anchor="middle" x="12662" y="-10994.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12662" y="-10979.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer0_gpu12&#45;&gt;mha_layer1_gpu12 -->
<g id="edge109" class="edge">
<title>aggregate_layer0_gpu12&#45;&gt;mha_layer1_gpu12</title>
<path fill="none" stroke="black" d="M12520.81,-11060.15C12545.9,-11049.24 12571.52,-11038.1 12593.93,-11028.35"/>
<polygon fill="black" stroke="black" points="12595.56,-11031.46 12603.33,-11024.27 12592.76,-11025.05 12595.56,-11031.46"/>
</g>
<!-- route_layer0_gpu13&#45;&gt;comm_layer0 -->
<g id="edge62" class="edge">
<title>route_layer0_gpu13&#45;&gt;comm_layer0</title>
<path fill="none" stroke="black" d="M13488.61,-11439.21C13389.87,-11430.65 13279.89,-11422.27 13179,-11417.21 12346.38,-11375.38 9768.53,-11352.81 8948.92,-11346.55"/>
<polygon fill="black" stroke="black" points="8948.79,-11343.05 8938.77,-11346.47 8948.74,-11350.05 8948.79,-11343.05"/>
</g>
<!-- mha_layer1_gpu13 -->
<g id="node96" class="node">
<title>mha_layer1_gpu13</title>
<path fill="lightblue" stroke="black" d="M13461,-11024.25C13461,-11024.25 13013,-11024.25 13013,-11024.25 13007,-11024.25 13001,-11018.25 13001,-11012.25 13001,-11012.25 13001,-10983.25 13001,-10983.25 13001,-10977.25 13007,-10971.25 13013,-10971.25 13013,-10971.25 13461,-10971.25 13461,-10971.25 13467,-10971.25 13473,-10977.25 13473,-10983.25 13473,-10983.25 13473,-11012.25 13473,-11012.25 13473,-11018.25 13467,-11024.25 13461,-11024.25"/>
<text text-anchor="middle" x="13237" y="-11009.05" font-family="Times,serif" font-size="14.00">MHA Layer 1 GPU 13</text>
<text text-anchor="middle" x="13237" y="-10994.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13237" y="-10979.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer0_gpu13&#45;&gt;mha_layer1_gpu13 -->
<g id="edge110" class="edge">
<title>aggregate_layer0_gpu13&#45;&gt;mha_layer1_gpu13</title>
<path fill="none" stroke="black" d="M13158.56,-11060.15C13171.5,-11050.02 13184.7,-11039.69 13196.49,-11030.46"/>
<polygon fill="black" stroke="black" points="13198.69,-11033.19 13204.41,-11024.27 13194.37,-11027.67 13198.69,-11033.19"/>
</g>
<!-- route_layer0_gpu14&#45;&gt;comm_layer0 -->
<g id="edge63" class="edge">
<title>route_layer0_gpu14&#45;&gt;comm_layer0</title>
<path fill="none" stroke="black" d="M14450.41,-11439.1C14351.15,-11430.51 14240.49,-11422.15 14139,-11417.21 13109.03,-11367.08 9879.73,-11349.75 8949.24,-11345.72"/>
<polygon fill="black" stroke="black" points="8949.08,-11342.22 8939.07,-11345.68 8949.05,-11349.22 8949.08,-11342.22"/>
</g>
<!-- mha_layer1_gpu14 -->
<g id="node97" class="node">
<title>mha_layer1_gpu14</title>
<path fill="lightblue" stroke="black" d="M13994,-11024.25C13994,-11024.25 13546,-11024.25 13546,-11024.25 13540,-11024.25 13534,-11018.25 13534,-11012.25 13534,-11012.25 13534,-10983.25 13534,-10983.25 13534,-10977.25 13540,-10971.25 13546,-10971.25 13546,-10971.25 13994,-10971.25 13994,-10971.25 14000,-10971.25 14006,-10977.25 14006,-10983.25 14006,-10983.25 14006,-11012.25 14006,-11012.25 14006,-11018.25 14000,-11024.25 13994,-11024.25"/>
<text text-anchor="middle" x="13770" y="-11009.05" font-family="Times,serif" font-size="14.00">MHA Layer 1 GPU 14</text>
<text text-anchor="middle" x="13770" y="-10994.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13770" y="-10979.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer0_gpu14&#45;&gt;mha_layer1_gpu14 -->
<g id="edge111" class="edge">
<title>aggregate_layer0_gpu14&#45;&gt;mha_layer1_gpu14</title>
<path fill="none" stroke="black" d="M13768.92,-11060.15C13769.07,-11051.48 13769.23,-11042.67 13769.37,-11034.52"/>
<polygon fill="black" stroke="black" points="13772.87,-11034.33 13769.55,-11024.27 13765.87,-11034.2 13772.87,-11034.33"/>
</g>
<!-- route_layer0_gpu15&#45;&gt;comm_layer0 -->
<g id="edge64" class="edge">
<title>route_layer0_gpu15&#45;&gt;comm_layer0</title>
<path fill="none" stroke="black" d="M15413.31,-11439.02C15313.79,-11430.41 15202.8,-11422.05 15101,-11417.21 13871.91,-11358.7 9981.5,-11347.19 8949.4,-11345.14"/>
<polygon fill="black" stroke="black" points="8949.26,-11341.64 8939.25,-11345.12 8949.24,-11348.64 8949.26,-11341.64"/>
</g>
<!-- mha_layer1_gpu15 -->
<g id="node98" class="node">
<title>mha_layer1_gpu15</title>
<path fill="lightblue" stroke="black" d="M15827,-11024.25C15827,-11024.25 15379,-11024.25 15379,-11024.25 15373,-11024.25 15367,-11018.25 15367,-11012.25 15367,-11012.25 15367,-10983.25 15367,-10983.25 15367,-10977.25 15373,-10971.25 15379,-10971.25 15379,-10971.25 15827,-10971.25 15827,-10971.25 15833,-10971.25 15839,-10977.25 15839,-10983.25 15839,-10983.25 15839,-11012.25 15839,-11012.25 15839,-11018.25 15833,-11024.25 15827,-11024.25"/>
<text text-anchor="middle" x="15603" y="-11009.05" font-family="Times,serif" font-size="14.00">MHA Layer 1 GPU 15</text>
<text text-anchor="middle" x="15603" y="-10994.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="15603" y="-10979.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer0_gpu15&#45;&gt;mha_layer1_gpu15 -->
<g id="edge112" class="edge">
<title>aggregate_layer0_gpu15&#45;&gt;mha_layer1_gpu15</title>
<path fill="none" stroke="black" d="M15393.36,-11060.24C15432.09,-11048.88 15471.7,-11037.26 15505.9,-11027.23"/>
<polygon fill="black" stroke="black" points="15507.26,-11030.48 15515.87,-11024.31 15505.29,-11023.76 15507.26,-11030.48"/>
</g>
<!-- comm_layer0&#45;&gt;expert_layer0_gpu0_expert0 -->
<g id="edge65" class="edge">
<title>comm_layer0&#45;&gt;expert_layer0_gpu0_expert0</title>
<path fill="none" stroke="black" d="M8452.91,-11341.45C7508.81,-11336.19 4084.08,-11314.42 2997,-11270.25 2924.21,-11267.3 2845.32,-11262.54 2772.89,-11257.54"/>
<polygon fill="black" stroke="black" points="2772.93,-11254.03 2762.72,-11256.83 2772.45,-11261.02 2772.93,-11254.03"/>
</g>
<!-- comm_layer0&#45;&gt;expert_layer0_gpu1_expert1 -->
<g id="edge66" class="edge">
<title>comm_layer0&#45;&gt;expert_layer0_gpu1_expert1</title>
<path fill="none" stroke="black" d="M8453.45,-11340.65C7773.85,-11334.44 5793.18,-11313.69 4148,-11270.25 3932.91,-11264.57 3688.83,-11255.39 3509.96,-11248.15"/>
<polygon fill="black" stroke="black" points="3510.02,-11244.65 3499.88,-11247.75 3509.73,-11251.65 3510.02,-11244.65"/>
</g>
<!-- comm_layer0&#45;&gt;expert_layer0_gpu2_expert2 -->
<g id="edge67" class="edge">
<title>comm_layer0&#45;&gt;expert_layer0_gpu2_expert2</title>
<path fill="none" stroke="black" d="M8452.79,-11342.23C7849.13,-11340.11 6233.77,-11328.9 4888,-11270.25 4814.27,-11267.04 4734.3,-11262.16 4661.01,-11257.13"/>
<polygon fill="black" stroke="black" points="4660.93,-11253.62 4650.71,-11256.42 4660.45,-11260.6 4660.93,-11253.62"/>
</g>
<!-- comm_layer0&#45;&gt;expert_layer0_gpu3_expert3 -->
<g id="edge68" class="edge">
<title>comm_layer0&#45;&gt;expert_layer0_gpu3_expert3</title>
<path fill="none" stroke="black" d="M8454.48,-11339.15C7952.16,-11331.19 6758.2,-11309.54 5757,-11270.25 5640.04,-11265.66 5510.62,-11258.94 5400.95,-11252.76"/>
<polygon fill="black" stroke="black" points="5400.92,-11249.25 5390.74,-11252.18 5400.53,-11256.24 5400.92,-11249.25"/>
</g>
<!-- comm_layer0&#45;&gt;expert_layer0_gpu4_expert4 -->
<g id="edge69" class="edge">
<title>comm_layer0&#45;&gt;expert_layer0_gpu4_expert4</title>
<path fill="none" stroke="black" d="M8458.93,-11335.1C8083.99,-11322.81 7331.17,-11297.28 6693,-11270.25 6553.16,-11264.33 6397.19,-11256.83 6269.94,-11250.47"/>
<polygon fill="black" stroke="black" points="6269.83,-11246.96 6259.66,-11249.96 6269.48,-11253.95 6269.83,-11246.96"/>
</g>
<!-- comm_layer0&#45;&gt;expert_layer0_gpu5_expert5 -->
<g id="edge70" class="edge">
<title>comm_layer0&#45;&gt;expert_layer0_gpu5_expert5</title>
<path fill="none" stroke="black" d="M8471.03,-11329.36C8228.06,-11314.89 7829.58,-11291.1 7486,-11270.25 7394.66,-11264.71 7294.57,-11258.58 7205.82,-11253.12"/>
<polygon fill="black" stroke="black" points="7205.81,-11249.61 7195.61,-11252.49 7205.38,-11256.6 7205.81,-11249.61"/>
</g>
<!-- comm_layer0&#45;&gt;expert_layer0_gpu6_expert6 -->
<g id="edge71" class="edge">
<title>comm_layer0&#45;&gt;expert_layer0_gpu6_expert6</title>
<path fill="none" stroke="black" d="M8501.22,-11321.19C8356.31,-11305.17 8157.13,-11283.15 7999.14,-11265.68"/>
<polygon fill="black" stroke="black" points="7999.12,-11262.16 7988.8,-11264.54 7998.35,-11269.12 7999.12,-11262.16"/>
</g>
<!-- comm_layer0&#45;&gt;expert_layer0_gpu7_expert7 -->
<g id="edge72" class="edge">
<title>comm_layer0&#45;&gt;expert_layer0_gpu7_expert7</title>
<path fill="none" stroke="black" d="M8592.49,-11309.65C8556.49,-11298.14 8515.92,-11285.17 8479.18,-11273.43"/>
<polygon fill="black" stroke="black" points="8480.02,-11270.02 8469.42,-11270.31 8477.88,-11276.69 8480.02,-11270.02"/>
</g>
<!-- comm_layer0&#45;&gt;expert_layer0_gpu8_expert8 -->
<g id="edge73" class="edge">
<title>comm_layer0&#45;&gt;expert_layer0_gpu8_expert8</title>
<path fill="none" stroke="black" d="M8799.37,-11309.79C8835.59,-11298.25 8876.45,-11285.23 8913.45,-11273.44"/>
<polygon fill="black" stroke="black" points="8914.81,-11276.68 8923.28,-11270.31 8912.69,-11270.01 8914.81,-11276.68"/>
</g>
<!-- comm_layer0&#45;&gt;expert_layer0_gpu9_expert9 -->
<g id="edge74" class="edge">
<title>comm_layer0&#45;&gt;expert_layer0_gpu9_expert9</title>
<path fill="none" stroke="black" d="M8900.15,-11323.26C9081.9,-11305.93 9348.62,-11280.49 9544.87,-11261.77"/>
<polygon fill="black" stroke="black" points="9545.42,-11265.24 9555.04,-11260.8 9544.76,-11258.27 9545.42,-11265.24"/>
</g>
<!-- comm_layer0&#45;&gt;expert_layer0_gpu10_expert10 -->
<g id="edge75" class="edge">
<title>comm_layer0&#45;&gt;expert_layer0_gpu10_expert10</title>
<path fill="none" stroke="black" d="M8924.48,-11330.78C9194.89,-11316.59 9658.75,-11292.09 10057,-11270.25 10164.51,-11264.36 10283.13,-11257.7 10385.29,-11251.91"/>
<polygon fill="black" stroke="black" points="10385.65,-11255.39 10395.44,-11251.33 10385.26,-11248.41 10385.65,-11255.39"/>
</g>
<!-- comm_layer0&#45;&gt;expert_layer0_gpu11_expert11 -->
<g id="edge76" class="edge">
<title>comm_layer0&#45;&gt;expert_layer0_gpu11_expert11</title>
<path fill="none" stroke="black" d="M8935.47,-11336.91C9339.85,-11326.62 10183.77,-11303.16 10897,-11270.25 10994.74,-11265.74 11102.08,-11259.64 11196.16,-11253.91"/>
<polygon fill="black" stroke="black" points="11196.63,-11257.39 11206.39,-11253.29 11196.2,-11250.41 11196.63,-11257.39"/>
</g>
<!-- comm_layer0&#45;&gt;expert_layer0_gpu12_expert12 -->
<g id="edge77" class="edge">
<title>comm_layer0&#45;&gt;expert_layer0_gpu12_expert12</title>
<path fill="none" stroke="black" d="M8938.17,-11340.21C9449.85,-11334.16 10678.56,-11315.8 11708,-11270.25 11790.99,-11266.58 11881.46,-11261.21 11962.95,-11255.85"/>
<polygon fill="black" stroke="black" points="11963.61,-11259.32 11973.36,-11255.17 11963.15,-11252.33 11963.61,-11259.32"/>
</g>
<!-- comm_layer0&#45;&gt;expert_layer0_gpu13_expert13 -->
<g id="edge78" class="edge">
<title>comm_layer0&#45;&gt;expert_layer0_gpu13_expert13</title>
<path fill="none" stroke="black" d="M8939.29,-11342.3C9539.88,-11340.33 11140.95,-11329.45 12475,-11270.25 12545.4,-11267.13 12621.59,-11262.42 12691.88,-11257.52"/>
<polygon fill="black" stroke="black" points="12692.47,-11260.99 12702.2,-11256.8 12691.98,-11254.01 12692.47,-11260.99"/>
</g>
<!-- comm_layer0&#45;&gt;expert_layer0_gpu14_expert14 -->
<g id="edge79" class="edge">
<title>comm_layer0&#45;&gt;expert_layer0_gpu14_expert14</title>
<path fill="none" stroke="black" d="M8938.69,-11340.68C9749.77,-11333.52 12362.55,-11308.05 13204,-11270.25 13265.58,-11267.49 13331.85,-11263.27 13394.01,-11258.77"/>
<polygon fill="black" stroke="black" points="13394.63,-11262.24 13404.35,-11258.02 13394.12,-11255.26 13394.63,-11262.24"/>
</g>
<!-- comm_layer0&#45;&gt;expert_layer0_gpu15_expert15 -->
<g id="edge80" class="edge">
<title>comm_layer0&#45;&gt;expert_layer0_gpu15_expert15</title>
<path fill="none" stroke="black" d="M8938.86,-11341.62C9682.23,-11337.74 11992.34,-11322.06 13906,-11270.25 14094.68,-11265.15 14307.67,-11256.49 14469.28,-11249.32"/>
<polygon fill="black" stroke="black" points="14469.53,-11252.81 14479.37,-11248.87 14469.22,-11245.82 14469.53,-11252.81"/>
</g>
<!-- gate_layer1_gpu0 -->
<g id="node99" class="node">
<title>gate_layer1_gpu0</title>
<path fill="lightsteelblue" stroke="black" d="M1519.07,-10933.92C1519.07,-10933.92 1069.93,-10883.59 1069.93,-10883.59 1063.96,-10882.92 1063.96,-10881.58 1069.93,-10880.92 1069.93,-10880.92 1519.07,-10830.59 1519.07,-10830.59 1525.04,-10829.92 1536.96,-10829.92 1542.93,-10830.59 1542.93,-10830.59 1992.07,-10880.92 1992.07,-10880.92 1998.04,-10881.58 1998.04,-10882.92 1992.07,-10883.59 1992.07,-10883.59 1542.93,-10933.92 1542.93,-10933.92 1536.96,-10934.58 1525.04,-10934.58 1519.07,-10933.92"/>
<text text-anchor="middle" x="1531" y="-10893.55" font-family="Times,serif" font-size="14.00">Gate Layer 1 GPU 0</text>
<text text-anchor="middle" x="1531" y="-10878.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="1531" y="-10863.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer1_gpu0&#45;&gt;gate_layer1_gpu0 -->
<g id="edge113" class="edge">
<title>mha_layer1_gpu0&#45;&gt;gate_layer1_gpu0</title>
<path fill="none" stroke="black" d="M1802.02,-10971.14C1760.14,-10957.56 1707.64,-10940.54 1660.03,-10925.1"/>
<polygon fill="black" stroke="black" points="1660.86,-10921.69 1650.27,-10921.93 1658.7,-10928.34 1660.86,-10921.69"/>
</g>
<!-- gate_layer1_gpu1 -->
<g id="node100" class="node">
<title>gate_layer1_gpu1</title>
<path fill="lightsteelblue" stroke="black" d="M2483.07,-10933.92C2483.07,-10933.92 2033.93,-10883.59 2033.93,-10883.59 2027.96,-10882.92 2027.96,-10881.58 2033.93,-10880.92 2033.93,-10880.92 2483.07,-10830.59 2483.07,-10830.59 2489.04,-10829.92 2500.96,-10829.92 2506.93,-10830.59 2506.93,-10830.59 2956.07,-10880.92 2956.07,-10880.92 2962.04,-10881.58 2962.04,-10882.92 2956.07,-10883.59 2956.07,-10883.59 2506.93,-10933.92 2506.93,-10933.92 2500.96,-10934.58 2489.04,-10934.58 2483.07,-10933.92"/>
<text text-anchor="middle" x="2495" y="-10893.55" font-family="Times,serif" font-size="14.00">Gate Layer 1 GPU 1</text>
<text text-anchor="middle" x="2495" y="-10878.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="2495" y="-10863.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer1_gpu1&#45;&gt;gate_layer1_gpu1 -->
<g id="edge114" class="edge">
<title>mha_layer1_gpu1&#45;&gt;gate_layer1_gpu1</title>
<path fill="none" stroke="black" d="M2582.36,-10971C2572.44,-10961.03 2560.68,-10949.23 2549.07,-10937.56"/>
<polygon fill="black" stroke="black" points="2551.4,-10934.95 2541.87,-10930.33 2546.44,-10939.89 2551.4,-10934.95"/>
</g>
<!-- gate_layer1_gpu2 -->
<g id="node101" class="node">
<title>gate_layer1_gpu2</title>
<path fill="lightsteelblue" stroke="black" d="M3447.07,-10933.92C3447.07,-10933.92 2997.93,-10883.59 2997.93,-10883.59 2991.96,-10882.92 2991.96,-10881.58 2997.93,-10880.92 2997.93,-10880.92 3447.07,-10830.59 3447.07,-10830.59 3453.04,-10829.92 3464.96,-10829.92 3470.93,-10830.59 3470.93,-10830.59 3920.07,-10880.92 3920.07,-10880.92 3926.04,-10881.58 3926.04,-10882.92 3920.07,-10883.59 3920.07,-10883.59 3470.93,-10933.92 3470.93,-10933.92 3464.96,-10934.58 3453.04,-10934.58 3447.07,-10933.92"/>
<text text-anchor="middle" x="3459" y="-10893.55" font-family="Times,serif" font-size="14.00">Gate Layer 1 GPU 2</text>
<text text-anchor="middle" x="3459" y="-10878.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="3459" y="-10863.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer1_gpu2&#45;&gt;gate_layer1_gpu2 -->
<g id="edge115" class="edge">
<title>mha_layer1_gpu2&#45;&gt;gate_layer1_gpu2</title>
<path fill="none" stroke="black" d="M3547.13,-10971C3537.12,-10961.03 3525.26,-10949.23 3513.54,-10937.56"/>
<polygon fill="black" stroke="black" points="3515.84,-10934.9 3506.28,-10930.33 3510.9,-10939.87 3515.84,-10934.9"/>
</g>
<!-- gate_layer1_gpu3 -->
<g id="node102" class="node">
<title>gate_layer1_gpu3</title>
<path fill="lightsteelblue" stroke="black" d="M4411.07,-10933.92C4411.07,-10933.92 3961.93,-10883.59 3961.93,-10883.59 3955.96,-10882.92 3955.96,-10881.58 3961.93,-10880.92 3961.93,-10880.92 4411.07,-10830.59 4411.07,-10830.59 4417.04,-10829.92 4428.96,-10829.92 4434.93,-10830.59 4434.93,-10830.59 4884.07,-10880.92 4884.07,-10880.92 4890.04,-10881.58 4890.04,-10882.92 4884.07,-10883.59 4884.07,-10883.59 4434.93,-10933.92 4434.93,-10933.92 4428.96,-10934.58 4417.04,-10934.58 4411.07,-10933.92"/>
<text text-anchor="middle" x="4423" y="-10893.55" font-family="Times,serif" font-size="14.00">Gate Layer 1 GPU 3</text>
<text text-anchor="middle" x="4423" y="-10878.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4423" y="-10863.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer1_gpu3&#45;&gt;gate_layer1_gpu3 -->
<g id="edge116" class="edge">
<title>mha_layer1_gpu3&#45;&gt;gate_layer1_gpu3</title>
<path fill="none" stroke="black" d="M4746.16,-10971.21C4693.72,-10956.94 4627.23,-10938.84 4568.22,-10922.78"/>
<polygon fill="black" stroke="black" points="4569.01,-10919.37 4558.44,-10920.12 4567.17,-10926.12 4569.01,-10919.37"/>
</g>
<!-- gate_layer1_gpu4 -->
<g id="node103" class="node">
<title>gate_layer1_gpu4</title>
<path fill="lightsteelblue" stroke="black" d="M5375.07,-10933.92C5375.07,-10933.92 4925.93,-10883.59 4925.93,-10883.59 4919.96,-10882.92 4919.96,-10881.58 4925.93,-10880.92 4925.93,-10880.92 5375.07,-10830.59 5375.07,-10830.59 5381.04,-10829.92 5392.96,-10829.92 5398.93,-10830.59 5398.93,-10830.59 5848.07,-10880.92 5848.07,-10880.92 5854.04,-10881.58 5854.04,-10882.92 5848.07,-10883.59 5848.07,-10883.59 5398.93,-10933.92 5398.93,-10933.92 5392.96,-10934.58 5381.04,-10934.58 5375.07,-10933.92"/>
<text text-anchor="middle" x="5387" y="-10893.55" font-family="Times,serif" font-size="14.00">Gate Layer 1 GPU 4</text>
<text text-anchor="middle" x="5387" y="-10878.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5387" y="-10863.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer1_gpu4&#45;&gt;gate_layer1_gpu4 -->
<g id="edge117" class="edge">
<title>mha_layer1_gpu4&#45;&gt;gate_layer1_gpu4</title>
<path fill="none" stroke="black" d="M5588.33,-10971.14C5559.65,-10958.62 5524.26,-10943.17 5491.19,-10928.73"/>
<polygon fill="black" stroke="black" points="5492.49,-10925.49 5481.93,-10924.69 5489.69,-10931.9 5492.49,-10925.49"/>
</g>
<!-- gate_layer1_gpu5 -->
<g id="node104" class="node">
<title>gate_layer1_gpu5</title>
<path fill="lightsteelblue" stroke="black" d="M6339.07,-10933.92C6339.07,-10933.92 5889.93,-10883.59 5889.93,-10883.59 5883.96,-10882.92 5883.96,-10881.58 5889.93,-10880.92 5889.93,-10880.92 6339.07,-10830.59 6339.07,-10830.59 6345.04,-10829.92 6356.96,-10829.92 6362.93,-10830.59 6362.93,-10830.59 6812.07,-10880.92 6812.07,-10880.92 6818.04,-10881.58 6818.04,-10882.92 6812.07,-10883.59 6812.07,-10883.59 6362.93,-10933.92 6362.93,-10933.92 6356.96,-10934.58 6345.04,-10934.58 6339.07,-10933.92"/>
<text text-anchor="middle" x="6351" y="-10893.55" font-family="Times,serif" font-size="14.00">Gate Layer 1 GPU 5</text>
<text text-anchor="middle" x="6351" y="-10878.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6351" y="-10863.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer1_gpu5&#45;&gt;gate_layer1_gpu5 -->
<g id="edge118" class="edge">
<title>mha_layer1_gpu5&#45;&gt;gate_layer1_gpu5</title>
<path fill="none" stroke="black" d="M6419.03,-10971C6411.69,-10961.52 6403.05,-10950.39 6394.45,-10939.29"/>
<polygon fill="black" stroke="black" points="6397.1,-10937 6388.2,-10931.24 6391.57,-10941.29 6397.1,-10937"/>
</g>
<!-- gate_layer1_gpu6 -->
<g id="node105" class="node">
<title>gate_layer1_gpu6</title>
<path fill="lightsteelblue" stroke="black" d="M7303.07,-10933.92C7303.07,-10933.92 6853.93,-10883.59 6853.93,-10883.59 6847.96,-10882.92 6847.96,-10881.58 6853.93,-10880.92 6853.93,-10880.92 7303.07,-10830.59 7303.07,-10830.59 7309.04,-10829.92 7320.96,-10829.92 7326.93,-10830.59 7326.93,-10830.59 7776.07,-10880.92 7776.07,-10880.92 7782.04,-10881.58 7782.04,-10882.92 7776.07,-10883.59 7776.07,-10883.59 7326.93,-10933.92 7326.93,-10933.92 7320.96,-10934.58 7309.04,-10934.58 7303.07,-10933.92"/>
<text text-anchor="middle" x="7315" y="-10893.55" font-family="Times,serif" font-size="14.00">Gate Layer 1 GPU 6</text>
<text text-anchor="middle" x="7315" y="-10878.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="7315" y="-10863.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer1_gpu6&#45;&gt;gate_layer1_gpu6 -->
<g id="edge119" class="edge">
<title>mha_layer1_gpu6&#45;&gt;gate_layer1_gpu6</title>
<path fill="none" stroke="black" d="M7412.41,-10971C7401.06,-10960.77 7387.56,-10948.61 7374.28,-10936.65"/>
<polygon fill="black" stroke="black" points="7376.28,-10933.74 7366.51,-10929.65 7371.59,-10938.94 7376.28,-10933.74"/>
</g>
<!-- gate_layer1_gpu7 -->
<g id="node106" class="node">
<title>gate_layer1_gpu7</title>
<path fill="lightsteelblue" stroke="black" d="M8267.07,-10933.92C8267.07,-10933.92 7817.93,-10883.59 7817.93,-10883.59 7811.96,-10882.92 7811.96,-10881.58 7817.93,-10880.92 7817.93,-10880.92 8267.07,-10830.59 8267.07,-10830.59 8273.04,-10829.92 8284.96,-10829.92 8290.93,-10830.59 8290.93,-10830.59 8740.07,-10880.92 8740.07,-10880.92 8746.04,-10881.58 8746.04,-10882.92 8740.07,-10883.59 8740.07,-10883.59 8290.93,-10933.92 8290.93,-10933.92 8284.96,-10934.58 8273.04,-10934.58 8267.07,-10933.92"/>
<text text-anchor="middle" x="8279" y="-10893.55" font-family="Times,serif" font-size="14.00">Gate Layer 1 GPU 7</text>
<text text-anchor="middle" x="8279" y="-10878.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="8279" y="-10863.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer1_gpu7&#45;&gt;gate_layer1_gpu7 -->
<g id="edge120" class="edge">
<title>mha_layer1_gpu7&#45;&gt;gate_layer1_gpu7</title>
<path fill="none" stroke="black" d="M8282.09,-10971C8281.82,-10963.3 8281.51,-10954.5 8281.19,-10945.52"/>
<polygon fill="black" stroke="black" points="8284.69,-10945.22 8280.84,-10935.35 8277.69,-10945.47 8284.69,-10945.22"/>
</g>
<!-- gate_layer1_gpu8 -->
<g id="node107" class="node">
<title>gate_layer1_gpu8</title>
<path fill="lightsteelblue" stroke="black" d="M9231.07,-10933.92C9231.07,-10933.92 8781.93,-10883.59 8781.93,-10883.59 8775.96,-10882.92 8775.96,-10881.58 8781.93,-10880.92 8781.93,-10880.92 9231.07,-10830.59 9231.07,-10830.59 9237.04,-10829.92 9248.96,-10829.92 9254.93,-10830.59 9254.93,-10830.59 9704.07,-10880.92 9704.07,-10880.92 9710.04,-10881.58 9710.04,-10882.92 9704.07,-10883.59 9704.07,-10883.59 9254.93,-10933.92 9254.93,-10933.92 9248.96,-10934.58 9237.04,-10934.58 9231.07,-10933.92"/>
<text text-anchor="middle" x="9243" y="-10893.55" font-family="Times,serif" font-size="14.00">Gate Layer 1 GPU 8</text>
<text text-anchor="middle" x="9243" y="-10878.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="9243" y="-10863.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer1_gpu8&#45;&gt;gate_layer1_gpu8 -->
<g id="edge121" class="edge">
<title>mha_layer1_gpu8&#45;&gt;gate_layer1_gpu8</title>
<path fill="none" stroke="black" d="M9188.88,-10971C9194.49,-10961.92 9201.03,-10951.3 9207.59,-10940.66"/>
<polygon fill="black" stroke="black" points="9210.57,-10942.5 9212.84,-10932.15 9204.62,-10938.82 9210.57,-10942.5"/>
</g>
<!-- gate_layer1_gpu9 -->
<g id="node108" class="node">
<title>gate_layer1_gpu9</title>
<path fill="lightsteelblue" stroke="black" d="M10195.07,-10933.92C10195.07,-10933.92 9745.93,-10883.59 9745.93,-10883.59 9739.96,-10882.92 9739.96,-10881.58 9745.93,-10880.92 9745.93,-10880.92 10195.07,-10830.59 10195.07,-10830.59 10201.04,-10829.92 10212.96,-10829.92 10218.93,-10830.59 10218.93,-10830.59 10668.07,-10880.92 10668.07,-10880.92 10674.04,-10881.58 10674.04,-10882.92 10668.07,-10883.59 10668.07,-10883.59 10218.93,-10933.92 10218.93,-10933.92 10212.96,-10934.58 10201.04,-10934.58 10195.07,-10933.92"/>
<text text-anchor="middle" x="10207" y="-10893.55" font-family="Times,serif" font-size="14.00">Gate Layer 1 GPU 9</text>
<text text-anchor="middle" x="10207" y="-10878.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="10207" y="-10863.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer1_gpu9&#45;&gt;gate_layer1_gpu9 -->
<g id="edge122" class="edge">
<title>mha_layer1_gpu9&#45;&gt;gate_layer1_gpu9</title>
<path fill="none" stroke="black" d="M10123.51,-10971C10132.9,-10961.13 10144.01,-10949.45 10155.01,-10937.89"/>
<polygon fill="black" stroke="black" points="10157.85,-10939.99 10162.2,-10930.33 10152.78,-10935.16 10157.85,-10939.99"/>
</g>
<!-- gate_layer1_gpu10 -->
<g id="node109" class="node">
<title>gate_layer1_gpu10</title>
<path fill="lightsteelblue" stroke="black" d="M11159.07,-10933.92C11159.07,-10933.92 10709.93,-10883.59 10709.93,-10883.59 10703.96,-10882.92 10703.96,-10881.58 10709.93,-10880.92 10709.93,-10880.92 11159.07,-10830.59 11159.07,-10830.59 11165.04,-10829.92 11176.96,-10829.92 11182.93,-10830.59 11182.93,-10830.59 11632.07,-10880.92 11632.07,-10880.92 11638.04,-10881.58 11638.04,-10882.92 11632.07,-10883.59 11632.07,-10883.59 11182.93,-10933.92 11182.93,-10933.92 11176.96,-10934.58 11165.04,-10934.58 11159.07,-10933.92"/>
<text text-anchor="middle" x="11171" y="-10893.55" font-family="Times,serif" font-size="14.00">Gate Layer 1 GPU 10</text>
<text text-anchor="middle" x="11171" y="-10878.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11171" y="-10863.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer1_gpu10&#45;&gt;gate_layer1_gpu10 -->
<g id="edge123" class="edge">
<title>mha_layer1_gpu10&#45;&gt;gate_layer1_gpu10</title>
<path fill="none" stroke="black" d="M11169.45,-10971C11169.59,-10963.3 11169.74,-10954.5 11169.9,-10945.52"/>
<polygon fill="black" stroke="black" points="11173.41,-10945.41 11170.08,-10935.35 11166.41,-10945.29 11173.41,-10945.41"/>
</g>
<!-- gate_layer1_gpu11 -->
<g id="node110" class="node">
<title>gate_layer1_gpu11</title>
<path fill="lightsteelblue" stroke="black" d="M12123.07,-10933.92C12123.07,-10933.92 11673.93,-10883.59 11673.93,-10883.59 11667.96,-10882.92 11667.96,-10881.58 11673.93,-10880.92 11673.93,-10880.92 12123.07,-10830.59 12123.07,-10830.59 12129.04,-10829.92 12140.96,-10829.92 12146.93,-10830.59 12146.93,-10830.59 12596.07,-10880.92 12596.07,-10880.92 12602.04,-10881.58 12602.04,-10882.92 12596.07,-10883.59 12596.07,-10883.59 12146.93,-10933.92 12146.93,-10933.92 12140.96,-10934.58 12129.04,-10934.58 12123.07,-10933.92"/>
<text text-anchor="middle" x="12135" y="-10893.55" font-family="Times,serif" font-size="14.00">Gate Layer 1 GPU 11</text>
<text text-anchor="middle" x="12135" y="-10878.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="12135" y="-10863.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer1_gpu11&#45;&gt;gate_layer1_gpu11 -->
<g id="edge124" class="edge">
<title>mha_layer1_gpu11&#45;&gt;gate_layer1_gpu11</title>
<path fill="none" stroke="black" d="M12031.41,-10971C12043.72,-10960.57 12058.41,-10948.12 12072.81,-10935.93"/>
<polygon fill="black" stroke="black" points="12075.39,-10938.33 12080.76,-10929.2 12070.87,-10932.99 12075.39,-10938.33"/>
</g>
<!-- gate_layer1_gpu12 -->
<g id="node111" class="node">
<title>gate_layer1_gpu12</title>
<path fill="lightsteelblue" stroke="black" d="M13087.07,-10933.92C13087.07,-10933.92 12637.93,-10883.59 12637.93,-10883.59 12631.96,-10882.92 12631.96,-10881.58 12637.93,-10880.92 12637.93,-10880.92 13087.07,-10830.59 13087.07,-10830.59 13093.04,-10829.92 13104.96,-10829.92 13110.93,-10830.59 13110.93,-10830.59 13560.07,-10880.92 13560.07,-10880.92 13566.04,-10881.58 13566.04,-10882.92 13560.07,-10883.59 13560.07,-10883.59 13110.93,-10933.92 13110.93,-10933.92 13104.96,-10934.58 13093.04,-10934.58 13087.07,-10933.92"/>
<text text-anchor="middle" x="13099" y="-10893.55" font-family="Times,serif" font-size="14.00">Gate Layer 1 GPU 12</text>
<text text-anchor="middle" x="13099" y="-10878.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13099" y="-10863.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer1_gpu12&#45;&gt;gate_layer1_gpu12 -->
<g id="edge125" class="edge">
<title>mha_layer1_gpu12&#45;&gt;gate_layer1_gpu12</title>
<path fill="none" stroke="black" d="M12760.34,-10971.21C12815.89,-10956.78 12886.47,-10938.45 12948.81,-10922.26"/>
<polygon fill="black" stroke="black" points="12949.94,-10925.58 12958.74,-10919.68 12948.18,-10918.81 12949.94,-10925.58"/>
</g>
<!-- gate_layer1_gpu13 -->
<g id="node112" class="node">
<title>gate_layer1_gpu13</title>
<path fill="lightsteelblue" stroke="black" d="M14051.07,-10933.92C14051.07,-10933.92 13601.93,-10883.59 13601.93,-10883.59 13595.96,-10882.92 13595.96,-10881.58 13601.93,-10880.92 13601.93,-10880.92 14051.07,-10830.59 14051.07,-10830.59 14057.04,-10829.92 14068.96,-10829.92 14074.93,-10830.59 14074.93,-10830.59 14524.07,-10880.92 14524.07,-10880.92 14530.04,-10881.58 14530.04,-10882.92 14524.07,-10883.59 14524.07,-10883.59 14074.93,-10933.92 14074.93,-10933.92 14068.96,-10934.58 14057.04,-10934.58 14051.07,-10933.92"/>
<text text-anchor="middle" x="14063" y="-10893.55" font-family="Times,serif" font-size="14.00">Gate Layer 1 GPU 13</text>
<text text-anchor="middle" x="14063" y="-10878.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14063" y="-10863.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer1_gpu13&#45;&gt;gate_layer1_gpu13 -->
<g id="edge126" class="edge">
<title>mha_layer1_gpu13&#45;&gt;gate_layer1_gpu13</title>
<path fill="none" stroke="black" d="M13422.63,-10971.25C13547.57,-10954.08 13712.85,-10931.37 13844.2,-10913.32"/>
<polygon fill="black" stroke="black" points="13844.96,-10916.75 13854.39,-10911.92 13844.01,-10909.81 13844.96,-10916.75"/>
</g>
<!-- gate_layer1_gpu14 -->
<g id="node113" class="node">
<title>gate_layer1_gpu14</title>
<path fill="lightsteelblue" stroke="black" d="M15015.07,-10933.92C15015.07,-10933.92 14565.93,-10883.59 14565.93,-10883.59 14559.96,-10882.92 14559.96,-10881.58 14565.93,-10880.92 14565.93,-10880.92 15015.07,-10830.59 15015.07,-10830.59 15021.04,-10829.92 15032.96,-10829.92 15038.93,-10830.59 15038.93,-10830.59 15488.07,-10880.92 15488.07,-10880.92 15494.04,-10881.58 15494.04,-10882.92 15488.07,-10883.59 15488.07,-10883.59 15038.93,-10933.92 15038.93,-10933.92 15032.96,-10934.58 15021.04,-10934.58 15015.07,-10933.92"/>
<text text-anchor="middle" x="15027" y="-10893.55" font-family="Times,serif" font-size="14.00">Gate Layer 1 GPU 14</text>
<text text-anchor="middle" x="15027" y="-10878.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="15027" y="-10863.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer1_gpu14&#45;&gt;gate_layer1_gpu14 -->
<g id="edge127" class="edge">
<title>mha_layer1_gpu14&#45;&gt;gate_layer1_gpu14</title>
<path fill="none" stroke="black" d="M14006.3,-10979.74C14159.88,-10968.26 14364.42,-10952.16 14545,-10935.25 14623.49,-10927.91 14709.08,-10918.97 14786.05,-10910.6"/>
<polygon fill="black" stroke="black" points="14786.81,-10914.04 14796.37,-10909.48 14786.05,-10907.08 14786.81,-10914.04"/>
</g>
<!-- gate_layer1_gpu15 -->
<g id="node114" class="node">
<title>gate_layer1_gpu15</title>
<path fill="lightsteelblue" stroke="black" d="M15979.07,-10933.92C15979.07,-10933.92 15529.93,-10883.59 15529.93,-10883.59 15523.96,-10882.92 15523.96,-10881.58 15529.93,-10880.92 15529.93,-10880.92 15979.07,-10830.59 15979.07,-10830.59 15985.04,-10829.92 15996.96,-10829.92 16002.93,-10830.59 16002.93,-10830.59 16452.07,-10880.92 16452.07,-10880.92 16458.04,-10881.58 16458.04,-10882.92 16452.07,-10883.59 16452.07,-10883.59 16002.93,-10933.92 16002.93,-10933.92 15996.96,-10934.58 15985.04,-10934.58 15979.07,-10933.92"/>
<text text-anchor="middle" x="15991" y="-10893.55" font-family="Times,serif" font-size="14.00">Gate Layer 1 GPU 15</text>
<text text-anchor="middle" x="15991" y="-10878.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="15991" y="-10863.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer1_gpu15&#45;&gt;gate_layer1_gpu15 -->
<g id="edge128" class="edge">
<title>mha_layer1_gpu15&#45;&gt;gate_layer1_gpu15</title>
<path fill="none" stroke="black" d="M15690.56,-10971.14C15738.32,-10957.17 15798.54,-10939.55 15852.5,-10923.77"/>
<polygon fill="black" stroke="black" points="15853.54,-10927.11 15862.15,-10920.94 15851.57,-10920.39 15853.54,-10927.11"/>
</g>
<!-- route_layer1_gpu0 -->
<g id="node131" class="node">
<title>route_layer1_gpu0</title>
<path fill="orange" stroke="black" d="M2151.74,-10793.25C2151.74,-10793.25 1643.24,-10793.25 1643.24,-10793.25 1637.24,-10793.25 1626.5,-10789.58 1621.75,-10785.91 1621.75,-10785.91 1503.75,-10694.6 1503.75,-10694.6 1499,-10690.93 1500.26,-10687.25 1506.26,-10687.25 1506.26,-10687.25 2014.76,-10687.25 2014.76,-10687.25 2020.76,-10687.25 2031.5,-10690.93 2036.25,-10694.6 2036.25,-10694.6 2154.25,-10785.91 2154.25,-10785.91 2159,-10789.58 2157.74,-10793.25 2151.74,-10793.25"/>
<text text-anchor="middle" x="1829" y="-10751.55" font-family="Times,serif" font-size="14.00">Token Router Layer 1 GPU 0</text>
<text text-anchor="middle" x="1829" y="-10736.55" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="1829" y="-10721.55" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer1_gpu0&#45;&gt;route_layer1_gpu0 -->
<g id="edge129" class="edge">
<title>gate_layer1_gpu0&#45;&gt;route_layer1_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1620.41,-10839.25C1648.3,-10826.15 1679.52,-10811.48 1709.15,-10797.56"/>
<polygon fill="black" stroke="black" points="1710.72,-10800.69 1718.28,-10793.27 1707.74,-10794.35 1710.72,-10800.69"/>
</g>
<!-- route_layer1_gpu1 -->
<g id="node133" class="node">
<title>route_layer1_gpu1</title>
<path fill="orange" stroke="black" d="M2977.74,-10793.25C2977.74,-10793.25 2469.24,-10793.25 2469.24,-10793.25 2463.24,-10793.25 2452.5,-10789.58 2447.75,-10785.91 2447.75,-10785.91 2329.75,-10694.6 2329.75,-10694.6 2325,-10690.93 2326.26,-10687.25 2332.26,-10687.25 2332.26,-10687.25 2840.76,-10687.25 2840.76,-10687.25 2846.76,-10687.25 2857.5,-10690.93 2862.25,-10694.6 2862.25,-10694.6 2980.25,-10785.91 2980.25,-10785.91 2985,-10789.58 2983.74,-10793.25 2977.74,-10793.25"/>
<text text-anchor="middle" x="2655" y="-10751.55" font-family="Times,serif" font-size="14.00">Token Router Layer 1 GPU 1</text>
<text text-anchor="middle" x="2655" y="-10736.55" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="2655" y="-10721.55" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer1_gpu1&#45;&gt;route_layer1_gpu1 -->
<g id="edge130" class="edge">
<title>gate_layer1_gpu1&#45;&gt;route_layer1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2547.83,-10835.02C2560.54,-10823.91 2574.29,-10811.88 2587.56,-10800.27"/>
<polygon fill="black" stroke="black" points="2590.08,-10802.7 2595.31,-10793.49 2585.47,-10797.44 2590.08,-10802.7"/>
</g>
<!-- route_layer1_gpu2 -->
<g id="node135" class="node">
<title>route_layer1_gpu2</title>
<path fill="orange" stroke="black" d="M3894.74,-10793.25C3894.74,-10793.25 3386.24,-10793.25 3386.24,-10793.25 3380.24,-10793.25 3369.5,-10789.58 3364.75,-10785.91 3364.75,-10785.91 3246.75,-10694.6 3246.75,-10694.6 3242,-10690.93 3243.26,-10687.25 3249.26,-10687.25 3249.26,-10687.25 3757.76,-10687.25 3757.76,-10687.25 3763.76,-10687.25 3774.5,-10690.93 3779.25,-10694.6 3779.25,-10694.6 3897.25,-10785.91 3897.25,-10785.91 3902,-10789.58 3900.74,-10793.25 3894.74,-10793.25"/>
<text text-anchor="middle" x="3572" y="-10751.55" font-family="Times,serif" font-size="14.00">Token Router Layer 1 GPU 2</text>
<text text-anchor="middle" x="3572" y="-10736.55" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="3572" y="-10721.55" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer1_gpu2&#45;&gt;route_layer1_gpu2 -->
<g id="edge131" class="edge">
<title>gate_layer1_gpu2&#45;&gt;route_layer1_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3497.57,-10833.46C3505.83,-10823.24 3514.65,-10812.31 3523.23,-10801.68"/>
<polygon fill="black" stroke="black" points="3526.17,-10803.6 3529.73,-10793.62 3520.73,-10799.21 3526.17,-10803.6"/>
</g>
<!-- route_layer1_gpu3 -->
<g id="node137" class="node">
<title>route_layer1_gpu3</title>
<path fill="orange" stroke="black" d="M5272.74,-10793.25C5272.74,-10793.25 4764.24,-10793.25 4764.24,-10793.25 4758.24,-10793.25 4747.5,-10789.58 4742.75,-10785.91 4742.75,-10785.91 4624.75,-10694.6 4624.75,-10694.6 4620,-10690.93 4621.26,-10687.25 4627.26,-10687.25 4627.26,-10687.25 5135.76,-10687.25 5135.76,-10687.25 5141.76,-10687.25 5152.5,-10690.93 5157.25,-10694.6 5157.25,-10694.6 5275.25,-10785.91 5275.25,-10785.91 5280,-10789.58 5278.74,-10793.25 5272.74,-10793.25"/>
<text text-anchor="middle" x="4950" y="-10751.55" font-family="Times,serif" font-size="14.00">Token Router Layer 1 GPU 3</text>
<text text-anchor="middle" x="4950" y="-10736.55" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="4950" y="-10721.55" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer1_gpu3&#45;&gt;route_layer1_gpu3 -->
<g id="edge132" class="edge">
<title>gate_layer1_gpu3&#45;&gt;route_layer1_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4560.77,-10844.65C4616.79,-10829.77 4682.71,-10812.26 4744.21,-10795.92"/>
<polygon fill="black" stroke="black" points="4745.28,-10799.26 4754.04,-10793.31 4743.48,-10792.5 4745.28,-10799.26"/>
</g>
<!-- route_layer1_gpu4 -->
<g id="node139" class="node">
<title>route_layer1_gpu4</title>
<path fill="orange" stroke="black" d="M6305.74,-10793.25C6305.74,-10793.25 5797.24,-10793.25 5797.24,-10793.25 5791.24,-10793.25 5780.5,-10789.58 5775.75,-10785.91 5775.75,-10785.91 5657.75,-10694.6 5657.75,-10694.6 5653,-10690.93 5654.26,-10687.25 5660.26,-10687.25 5660.26,-10687.25 6168.76,-10687.25 6168.76,-10687.25 6174.76,-10687.25 6185.5,-10690.93 6190.25,-10694.6 6190.25,-10694.6 6308.25,-10785.91 6308.25,-10785.91 6313,-10789.58 6311.74,-10793.25 6305.74,-10793.25"/>
<text text-anchor="middle" x="5983" y="-10751.55" font-family="Times,serif" font-size="14.00">Token Router Layer 1 GPU 4</text>
<text text-anchor="middle" x="5983" y="-10736.55" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="5983" y="-10721.55" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer1_gpu4&#45;&gt;route_layer1_gpu4 -->
<g id="edge133" class="edge">
<title>gate_layer1_gpu4&#45;&gt;route_layer1_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5537.01,-10846.02C5607.45,-10829.47 5692.67,-10809.45 5769.66,-10791.37"/>
<polygon fill="black" stroke="black" points="5770.56,-10794.75 5779.5,-10789.06 5768.96,-10787.94 5770.56,-10794.75"/>
</g>
<!-- route_layer1_gpu5 -->
<g id="node141" class="node">
<title>route_layer1_gpu5</title>
<path fill="orange" stroke="black" d="M7165.74,-10793.25C7165.74,-10793.25 6657.24,-10793.25 6657.24,-10793.25 6651.24,-10793.25 6640.5,-10789.58 6635.75,-10785.91 6635.75,-10785.91 6517.75,-10694.6 6517.75,-10694.6 6513,-10690.93 6514.26,-10687.25 6520.26,-10687.25 6520.26,-10687.25 7028.76,-10687.25 7028.76,-10687.25 7034.76,-10687.25 7045.5,-10690.93 7050.25,-10694.6 7050.25,-10694.6 7168.25,-10785.91 7168.25,-10785.91 7173,-10789.58 7171.74,-10793.25 7165.74,-10793.25"/>
<text text-anchor="middle" x="6843" y="-10751.55" font-family="Times,serif" font-size="14.00">Token Router Layer 1 GPU 5</text>
<text text-anchor="middle" x="6843" y="-10736.55" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="6843" y="-10721.55" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer1_gpu5&#45;&gt;route_layer1_gpu5 -->
<g id="edge134" class="edge">
<title>gate_layer1_gpu5&#45;&gt;route_layer1_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6482.2,-10843.92C6533.73,-10829.26 6593.93,-10812.13 6650.22,-10796.11"/>
<polygon fill="black" stroke="black" points="6651.29,-10799.44 6659.95,-10793.34 6649.37,-10792.71 6651.29,-10799.44"/>
</g>
<!-- route_layer1_gpu6 -->
<g id="node143" class="node">
<title>route_layer1_gpu6</title>
<path fill="orange" stroke="black" d="M7939.74,-10793.25C7939.74,-10793.25 7431.24,-10793.25 7431.24,-10793.25 7425.24,-10793.25 7414.5,-10789.58 7409.75,-10785.91 7409.75,-10785.91 7291.75,-10694.6 7291.75,-10694.6 7287,-10690.93 7288.26,-10687.25 7294.26,-10687.25 7294.26,-10687.25 7802.76,-10687.25 7802.76,-10687.25 7808.76,-10687.25 7819.5,-10690.93 7824.25,-10694.6 7824.25,-10694.6 7942.25,-10785.91 7942.25,-10785.91 7947,-10789.58 7945.74,-10793.25 7939.74,-10793.25"/>
<text text-anchor="middle" x="7617" y="-10751.55" font-family="Times,serif" font-size="14.00">Token Router Layer 1 GPU 6</text>
<text text-anchor="middle" x="7617" y="-10736.55" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="7617" y="-10721.55" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer1_gpu6&#45;&gt;route_layer1_gpu6 -->
<g id="edge135" class="edge">
<title>gate_layer1_gpu6&#45;&gt;route_layer1_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7405.61,-10839.25C7433.87,-10826.15 7465.52,-10811.48 7495.54,-10797.56"/>
<polygon fill="black" stroke="black" points="7497.2,-10800.65 7504.8,-10793.27 7494.25,-10794.3 7497.2,-10800.65"/>
</g>
<!-- route_layer1_gpu7 -->
<g id="node145" class="node">
<title>route_layer1_gpu7</title>
<path fill="orange" stroke="black" d="M8670.74,-10793.25C8670.74,-10793.25 8162.24,-10793.25 8162.24,-10793.25 8156.24,-10793.25 8145.5,-10789.58 8140.75,-10785.91 8140.75,-10785.91 8022.75,-10694.6 8022.75,-10694.6 8018,-10690.93 8019.26,-10687.25 8025.26,-10687.25 8025.26,-10687.25 8533.76,-10687.25 8533.76,-10687.25 8539.76,-10687.25 8550.5,-10690.93 8555.25,-10694.6 8555.25,-10694.6 8673.25,-10785.91 8673.25,-10785.91 8678,-10789.58 8676.74,-10793.25 8670.74,-10793.25"/>
<text text-anchor="middle" x="8348" y="-10751.55" font-family="Times,serif" font-size="14.00">Token Router Layer 1 GPU 7</text>
<text text-anchor="middle" x="8348" y="-10736.55" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="8348" y="-10721.55" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer1_gpu7&#45;&gt;route_layer1_gpu7 -->
<g id="edge136" class="edge">
<title>gate_layer1_gpu7&#45;&gt;route_layer1_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8303.33,-10831.89C8307.97,-10822.47 8312.89,-10812.49 8317.69,-10802.74"/>
<polygon fill="black" stroke="black" points="8320.97,-10804.01 8322.26,-10793.49 8314.7,-10800.91 8320.97,-10804.01"/>
</g>
<!-- route_layer1_gpu8 -->
<g id="node147" class="node">
<title>route_layer1_gpu8</title>
<path fill="orange" stroke="black" d="M9496.74,-10793.25C9496.74,-10793.25 8988.24,-10793.25 8988.24,-10793.25 8982.24,-10793.25 8971.5,-10789.58 8966.75,-10785.91 8966.75,-10785.91 8848.75,-10694.6 8848.75,-10694.6 8844,-10690.93 8845.26,-10687.25 8851.26,-10687.25 8851.26,-10687.25 9359.76,-10687.25 9359.76,-10687.25 9365.76,-10687.25 9376.5,-10690.93 9381.25,-10694.6 9381.25,-10694.6 9499.25,-10785.91 9499.25,-10785.91 9504,-10789.58 9502.74,-10793.25 9496.74,-10793.25"/>
<text text-anchor="middle" x="9174" y="-10751.55" font-family="Times,serif" font-size="14.00">Token Router Layer 1 GPU 8</text>
<text text-anchor="middle" x="9174" y="-10736.55" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="9174" y="-10721.55" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer1_gpu8&#45;&gt;route_layer1_gpu8 -->
<g id="edge137" class="edge">
<title>gate_layer1_gpu8&#45;&gt;route_layer1_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9218.67,-10831.89C9214.03,-10822.47 9209.11,-10812.49 9204.31,-10802.74"/>
<polygon fill="black" stroke="black" points="9207.3,-10800.91 9199.74,-10793.49 9201.03,-10804.01 9207.3,-10800.91"/>
</g>
<!-- route_layer1_gpu9 -->
<g id="node149" class="node">
<title>route_layer1_gpu9</title>
<path fill="orange" stroke="black" d="M10391.74,-10793.25C10391.74,-10793.25 9883.24,-10793.25 9883.24,-10793.25 9877.24,-10793.25 9866.5,-10789.58 9861.75,-10785.91 9861.75,-10785.91 9743.75,-10694.6 9743.75,-10694.6 9739,-10690.93 9740.26,-10687.25 9746.26,-10687.25 9746.26,-10687.25 10254.76,-10687.25 10254.76,-10687.25 10260.76,-10687.25 10271.5,-10690.93 10276.25,-10694.6 10276.25,-10694.6 10394.25,-10785.91 10394.25,-10785.91 10399,-10789.58 10397.74,-10793.25 10391.74,-10793.25"/>
<text text-anchor="middle" x="10069" y="-10751.55" font-family="Times,serif" font-size="14.00">Token Router Layer 1 GPU 9</text>
<text text-anchor="middle" x="10069" y="-10736.55" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="10069" y="-10721.55" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer1_gpu9&#45;&gt;route_layer1_gpu9 -->
<g id="edge138" class="edge">
<title>gate_layer1_gpu9&#45;&gt;route_layer1_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10160.66,-10834.25C10150.13,-10823.56 10138.8,-10812.07 10127.83,-10800.93"/>
<polygon fill="black" stroke="black" points="10130.19,-10798.34 10120.68,-10793.68 10125.2,-10803.26 10130.19,-10798.34"/>
</g>
<!-- route_layer1_gpu10 -->
<g id="node151" class="node">
<title>route_layer1_gpu10</title>
<path fill="orange" stroke="black" d="M11320.74,-10793.25C11320.74,-10793.25 10812.24,-10793.25 10812.24,-10793.25 10806.24,-10793.25 10795.5,-10789.58 10790.75,-10785.91 10790.75,-10785.91 10672.75,-10694.6 10672.75,-10694.6 10668,-10690.93 10669.26,-10687.25 10675.26,-10687.25 10675.26,-10687.25 11183.76,-10687.25 11183.76,-10687.25 11189.76,-10687.25 11200.5,-10690.93 11205.25,-10694.6 11205.25,-10694.6 11323.25,-10785.91 11323.25,-10785.91 11328,-10789.58 11326.74,-10793.25 11320.74,-10793.25"/>
<text text-anchor="middle" x="10998" y="-10751.55" font-family="Times,serif" font-size="14.00">Token Router Layer 1 GPU 10</text>
<text text-anchor="middle" x="10998" y="-10736.55" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="10998" y="-10721.55" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer1_gpu10&#45;&gt;route_layer1_gpu10 -->
<g id="edge139" class="edge">
<title>gate_layer1_gpu10&#45;&gt;route_layer1_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11114.35,-10835.41C11100.3,-10824.04 11085.05,-10811.7 11070.36,-10799.81"/>
<polygon fill="black" stroke="black" points="11072.24,-10796.83 11062.27,-10793.26 11067.84,-10802.27 11072.24,-10796.83"/>
</g>
<!-- route_layer1_gpu11 -->
<g id="node153" class="node">
<title>route_layer1_gpu11</title>
<path fill="orange" stroke="black" d="M12267.74,-10793.25C12267.74,-10793.25 11759.24,-10793.25 11759.24,-10793.25 11753.24,-10793.25 11742.5,-10789.58 11737.75,-10785.91 11737.75,-10785.91 11619.75,-10694.6 11619.75,-10694.6 11615,-10690.93 11616.26,-10687.25 11622.26,-10687.25 11622.26,-10687.25 12130.76,-10687.25 12130.76,-10687.25 12136.76,-10687.25 12147.5,-10690.93 12152.25,-10694.6 12152.25,-10694.6 12270.25,-10785.91 12270.25,-10785.91 12275,-10789.58 12273.74,-10793.25 12267.74,-10793.25"/>
<text text-anchor="middle" x="11945" y="-10751.55" font-family="Times,serif" font-size="14.00">Token Router Layer 1 GPU 11</text>
<text text-anchor="middle" x="11945" y="-10736.55" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="11945" y="-10721.55" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer1_gpu11&#45;&gt;route_layer1_gpu11 -->
<g id="edge140" class="edge">
<title>gate_layer1_gpu11&#45;&gt;route_layer1_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12073.57,-10835.99C12057.74,-10824.32 12040.47,-10811.6 12023.87,-10799.37"/>
<polygon fill="black" stroke="black" points="12025.92,-10796.53 12015.79,-10793.42 12021.77,-10802.17 12025.92,-10796.53"/>
</g>
<!-- route_layer1_gpu12 -->
<g id="node155" class="node">
<title>route_layer1_gpu12</title>
<path fill="orange" stroke="black" d="M13222.74,-10793.25C13222.74,-10793.25 12714.24,-10793.25 12714.24,-10793.25 12708.24,-10793.25 12697.5,-10789.58 12692.75,-10785.91 12692.75,-10785.91 12574.75,-10694.6 12574.75,-10694.6 12570,-10690.93 12571.26,-10687.25 12577.26,-10687.25 12577.26,-10687.25 13085.76,-10687.25 13085.76,-10687.25 13091.76,-10687.25 13102.5,-10690.93 13107.25,-10694.6 13107.25,-10694.6 13225.25,-10785.91 13225.25,-10785.91 13230,-10789.58 13228.74,-10793.25 13222.74,-10793.25"/>
<text text-anchor="middle" x="12900" y="-10751.55" font-family="Times,serif" font-size="14.00">Token Router Layer 1 GPU 12</text>
<text text-anchor="middle" x="12900" y="-10736.55" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="12900" y="-10721.55" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer1_gpu12&#45;&gt;route_layer1_gpu12 -->
<g id="edge141" class="edge">
<title>gate_layer1_gpu12&#45;&gt;route_layer1_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13035.21,-10836.38C13018.51,-10824.63 13000.25,-10811.78 12982.71,-10799.44"/>
<polygon fill="black" stroke="black" points="12984.36,-10796.33 12974.17,-10793.43 12980.34,-10802.05 12984.36,-10796.33"/>
</g>
<!-- route_layer1_gpu13 -->
<g id="node157" class="node">
<title>route_layer1_gpu13</title>
<path fill="orange" stroke="black" d="M14182.74,-10793.25C14182.74,-10793.25 13674.24,-10793.25 13674.24,-10793.25 13668.24,-10793.25 13657.5,-10789.58 13652.75,-10785.91 13652.75,-10785.91 13534.75,-10694.6 13534.75,-10694.6 13530,-10690.93 13531.26,-10687.25 13537.26,-10687.25 13537.26,-10687.25 14045.76,-10687.25 14045.76,-10687.25 14051.76,-10687.25 14062.5,-10690.93 14067.25,-10694.6 14067.25,-10694.6 14185.25,-10785.91 14185.25,-10785.91 14190,-10789.58 14188.74,-10793.25 14182.74,-10793.25"/>
<text text-anchor="middle" x="13860" y="-10751.55" font-family="Times,serif" font-size="14.00">Token Router Layer 1 GPU 13</text>
<text text-anchor="middle" x="13860" y="-10736.55" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="13860" y="-10721.55" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer1_gpu13&#45;&gt;route_layer1_gpu13 -->
<g id="edge142" class="edge">
<title>gate_layer1_gpu13&#45;&gt;route_layer1_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13997.93,-10836.38C13980.89,-10824.63 13962.27,-10811.78 13944.38,-10799.44"/>
<polygon fill="black" stroke="black" points="13945.88,-10796.23 13935.66,-10793.43 13941.91,-10801.99 13945.88,-10796.23"/>
</g>
<!-- route_layer1_gpu14 -->
<g id="node159" class="node">
<title>route_layer1_gpu14</title>
<path fill="orange" stroke="black" d="M15144.74,-10793.25C15144.74,-10793.25 14636.24,-10793.25 14636.24,-10793.25 14630.24,-10793.25 14619.5,-10789.58 14614.75,-10785.91 14614.75,-10785.91 14496.75,-10694.6 14496.75,-10694.6 14492,-10690.93 14493.26,-10687.25 14499.26,-10687.25 14499.26,-10687.25 15007.76,-10687.25 15007.76,-10687.25 15013.76,-10687.25 15024.5,-10690.93 15029.25,-10694.6 15029.25,-10694.6 15147.25,-10785.91 15147.25,-10785.91 15152,-10789.58 15150.74,-10793.25 15144.74,-10793.25"/>
<text text-anchor="middle" x="14822" y="-10751.55" font-family="Times,serif" font-size="14.00">Token Router Layer 1 GPU 14</text>
<text text-anchor="middle" x="14822" y="-10736.55" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="14822" y="-10721.55" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer1_gpu14&#45;&gt;route_layer1_gpu14 -->
<g id="edge143" class="edge">
<title>gate_layer1_gpu14&#45;&gt;route_layer1_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14961.57,-10836.57C14944.1,-10824.64 14924.96,-10811.56 14906.61,-10799.03"/>
<polygon fill="black" stroke="black" points="14908.47,-10796.07 14898.24,-10793.32 14904.52,-10801.85 14908.47,-10796.07"/>
</g>
<!-- route_layer1_gpu15 -->
<g id="node161" class="node">
<title>route_layer1_gpu15</title>
<path fill="orange" stroke="black" d="M16107.74,-10793.25C16107.74,-10793.25 15599.24,-10793.25 15599.24,-10793.25 15593.24,-10793.25 15582.5,-10789.58 15577.75,-10785.91 15577.75,-10785.91 15459.75,-10694.6 15459.75,-10694.6 15455,-10690.93 15456.26,-10687.25 15462.26,-10687.25 15462.26,-10687.25 15970.76,-10687.25 15970.76,-10687.25 15976.76,-10687.25 15987.5,-10690.93 15992.25,-10694.6 15992.25,-10694.6 16110.25,-10785.91 16110.25,-10785.91 16115,-10789.58 16113.74,-10793.25 16107.74,-10793.25"/>
<text text-anchor="middle" x="15785" y="-10751.55" font-family="Times,serif" font-size="14.00">Token Router Layer 1 GPU 15</text>
<text text-anchor="middle" x="15785" y="-10736.55" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="15785" y="-10721.55" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer1_gpu15&#45;&gt;route_layer1_gpu15 -->
<g id="edge144" class="edge">
<title>gate_layer1_gpu15&#45;&gt;route_layer1_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15925.25,-10836.57C15907.69,-10824.64 15888.46,-10811.56 15870.02,-10799.03"/>
<polygon fill="black" stroke="black" points="15871.85,-10796.04 15861.61,-10793.32 15867.91,-10801.83 15871.85,-10796.04"/>
</g>
<!-- expert_layer1_gpu0_expert0 -->
<g id="node115" class="node">
<title>expert_layer1_gpu0_expert0</title>
<path fill="lightcoral" stroke="black" d="M2907.5,-10540.3C2907.5,-10540.3 2438.5,-10540.3 2438.5,-10540.3 2432.5,-10540.3 2426.5,-10534.3 2426.5,-10528.3 2426.5,-10528.3 2426.5,-10484.3 2426.5,-10484.3 2426.5,-10478.3 2432.5,-10472.3 2438.5,-10472.3 2438.5,-10472.3 2907.5,-10472.3 2907.5,-10472.3 2913.5,-10472.3 2919.5,-10478.3 2919.5,-10484.3 2919.5,-10484.3 2919.5,-10528.3 2919.5,-10528.3 2919.5,-10534.3 2913.5,-10540.3 2907.5,-10540.3"/>
<text text-anchor="middle" x="2673" y="-10525.1" font-family="Times,serif" font-size="14.00">Expert 0 Layer 1 GPU 0</text>
<text text-anchor="middle" x="2673" y="-10510.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2673" y="-10495.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2673" y="-10480.1" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer1_gpu0 -->
<g id="node132" class="node">
<title>aggregate_layer1_gpu0</title>
<path fill="orange" stroke="black" d="M2588.29,-10436.3C2588.29,-10436.3 2101.19,-10436.3 2101.19,-10436.3 2095.19,-10436.3 2084.52,-10432.53 2079.85,-10428.77 2079.85,-10428.77 1967.06,-10337.83 1967.06,-10337.83 1962.38,-10334.07 1963.71,-10330.3 1969.71,-10330.3 1969.71,-10330.3 2456.81,-10330.3 2456.81,-10330.3 2462.81,-10330.3 2473.48,-10334.07 2478.15,-10337.83 2478.15,-10337.83 2590.94,-10428.77 2590.94,-10428.77 2595.62,-10432.53 2594.29,-10436.3 2588.29,-10436.3"/>
<text text-anchor="middle" x="2279" y="-10394.6" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 1 GPU 0</text>
<text text-anchor="middle" x="2279" y="-10379.6" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="2279" y="-10364.6" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer1_gpu0_expert0&#45;&gt;aggregate_layer1_gpu0 -->
<g id="edge177" class="edge">
<title>expert_layer1_gpu0_expert0&#45;&gt;aggregate_layer1_gpu0</title>
<path fill="none" stroke="black" d="M2565.34,-10472.24C2532.19,-10462.06 2494.75,-10450.56 2458.15,-10439.32"/>
<polygon fill="black" stroke="black" points="2458.95,-10435.9 2448.36,-10436.31 2456.89,-10442.59 2458.95,-10435.9"/>
</g>
<!-- expert_layer1_gpu1_expert1 -->
<g id="node116" class="node">
<title>expert_layer1_gpu1_expert1</title>
<path fill="lightcoral" stroke="black" d="M3722.5,-10540.3C3722.5,-10540.3 3253.5,-10540.3 3253.5,-10540.3 3247.5,-10540.3 3241.5,-10534.3 3241.5,-10528.3 3241.5,-10528.3 3241.5,-10484.3 3241.5,-10484.3 3241.5,-10478.3 3247.5,-10472.3 3253.5,-10472.3 3253.5,-10472.3 3722.5,-10472.3 3722.5,-10472.3 3728.5,-10472.3 3734.5,-10478.3 3734.5,-10484.3 3734.5,-10484.3 3734.5,-10528.3 3734.5,-10528.3 3734.5,-10534.3 3728.5,-10540.3 3722.5,-10540.3"/>
<text text-anchor="middle" x="3488" y="-10525.1" font-family="Times,serif" font-size="14.00">Expert 1 Layer 1 GPU 1</text>
<text text-anchor="middle" x="3488" y="-10510.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3488" y="-10495.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3488" y="-10480.1" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer1_gpu1 -->
<g id="node134" class="node">
<title>aggregate_layer1_gpu1</title>
<path fill="orange" stroke="black" d="M3708.29,-10436.3C3708.29,-10436.3 3221.19,-10436.3 3221.19,-10436.3 3215.19,-10436.3 3204.52,-10432.53 3199.85,-10428.77 3199.85,-10428.77 3087.06,-10337.83 3087.06,-10337.83 3082.38,-10334.07 3083.71,-10330.3 3089.71,-10330.3 3089.71,-10330.3 3576.81,-10330.3 3576.81,-10330.3 3582.81,-10330.3 3593.48,-10334.07 3598.15,-10337.83 3598.15,-10337.83 3710.94,-10428.77 3710.94,-10428.77 3715.62,-10432.53 3714.29,-10436.3 3708.29,-10436.3"/>
<text text-anchor="middle" x="3399" y="-10394.6" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 1 GPU 1</text>
<text text-anchor="middle" x="3399" y="-10379.6" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="3399" y="-10364.6" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer1_gpu1_expert1&#45;&gt;aggregate_layer1_gpu1 -->
<g id="edge178" class="edge">
<title>expert_layer1_gpu1_expert1&#45;&gt;aggregate_layer1_gpu1</title>
<path fill="none" stroke="black" d="M3463.68,-10472.24C3457.39,-10463.69 3450.42,-10454.21 3443.45,-10444.73"/>
<polygon fill="black" stroke="black" points="3446.09,-10442.41 3437.34,-10436.43 3440.45,-10446.56 3446.09,-10442.41"/>
</g>
<!-- expert_layer1_gpu2_expert2 -->
<g id="node117" class="node">
<title>expert_layer1_gpu2_expert2</title>
<path fill="lightcoral" stroke="black" d="M4591.5,-10540.3C4591.5,-10540.3 4122.5,-10540.3 4122.5,-10540.3 4116.5,-10540.3 4110.5,-10534.3 4110.5,-10528.3 4110.5,-10528.3 4110.5,-10484.3 4110.5,-10484.3 4110.5,-10478.3 4116.5,-10472.3 4122.5,-10472.3 4122.5,-10472.3 4591.5,-10472.3 4591.5,-10472.3 4597.5,-10472.3 4603.5,-10478.3 4603.5,-10484.3 4603.5,-10484.3 4603.5,-10528.3 4603.5,-10528.3 4603.5,-10534.3 4597.5,-10540.3 4591.5,-10540.3"/>
<text text-anchor="middle" x="4357" y="-10525.1" font-family="Times,serif" font-size="14.00">Expert 2 Layer 1 GPU 2</text>
<text text-anchor="middle" x="4357" y="-10510.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4357" y="-10495.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4357" y="-10480.1" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer1_gpu2 -->
<g id="node136" class="node">
<title>aggregate_layer1_gpu2</title>
<path fill="orange" stroke="black" d="M4437.29,-10436.3C4437.29,-10436.3 3950.19,-10436.3 3950.19,-10436.3 3944.19,-10436.3 3933.52,-10432.53 3928.85,-10428.77 3928.85,-10428.77 3816.06,-10337.83 3816.06,-10337.83 3811.38,-10334.07 3812.71,-10330.3 3818.71,-10330.3 3818.71,-10330.3 4305.81,-10330.3 4305.81,-10330.3 4311.81,-10330.3 4322.48,-10334.07 4327.15,-10337.83 4327.15,-10337.83 4439.94,-10428.77 4439.94,-10428.77 4444.62,-10432.53 4443.29,-10436.3 4437.29,-10436.3"/>
<text text-anchor="middle" x="4128" y="-10394.6" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 1 GPU 2</text>
<text text-anchor="middle" x="4128" y="-10379.6" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="4128" y="-10364.6" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer1_gpu2_expert2&#45;&gt;aggregate_layer1_gpu2 -->
<g id="edge179" class="edge">
<title>expert_layer1_gpu2_expert2&#45;&gt;aggregate_layer1_gpu2</title>
<path fill="none" stroke="black" d="M4294.42,-10472.24C4276.2,-10462.61 4255.75,-10451.8 4235.58,-10441.14"/>
<polygon fill="black" stroke="black" points="4237.13,-10438 4226.65,-10436.43 4233.86,-10444.19 4237.13,-10438"/>
</g>
<!-- expert_layer1_gpu3_expert3 -->
<g id="node118" class="node">
<title>expert_layer1_gpu3_expert3</title>
<path fill="lightcoral" stroke="black" d="M5373.5,-10540.3C5373.5,-10540.3 4904.5,-10540.3 4904.5,-10540.3 4898.5,-10540.3 4892.5,-10534.3 4892.5,-10528.3 4892.5,-10528.3 4892.5,-10484.3 4892.5,-10484.3 4892.5,-10478.3 4898.5,-10472.3 4904.5,-10472.3 4904.5,-10472.3 5373.5,-10472.3 5373.5,-10472.3 5379.5,-10472.3 5385.5,-10478.3 5385.5,-10484.3 5385.5,-10484.3 5385.5,-10528.3 5385.5,-10528.3 5385.5,-10534.3 5379.5,-10540.3 5373.5,-10540.3"/>
<text text-anchor="middle" x="5139" y="-10525.1" font-family="Times,serif" font-size="14.00">Expert 3 Layer 1 GPU 3</text>
<text text-anchor="middle" x="5139" y="-10510.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5139" y="-10495.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5139" y="-10480.1" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer1_gpu3 -->
<g id="node138" class="node">
<title>aggregate_layer1_gpu3</title>
<path fill="orange" stroke="black" d="M5328.29,-10436.3C5328.29,-10436.3 4841.19,-10436.3 4841.19,-10436.3 4835.19,-10436.3 4824.52,-10432.53 4819.85,-10428.77 4819.85,-10428.77 4707.06,-10337.83 4707.06,-10337.83 4702.38,-10334.07 4703.71,-10330.3 4709.71,-10330.3 4709.71,-10330.3 5196.81,-10330.3 5196.81,-10330.3 5202.81,-10330.3 5213.48,-10334.07 5218.15,-10337.83 5218.15,-10337.83 5330.94,-10428.77 5330.94,-10428.77 5335.62,-10432.53 5334.29,-10436.3 5328.29,-10436.3"/>
<text text-anchor="middle" x="5019" y="-10394.6" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 1 GPU 3</text>
<text text-anchor="middle" x="5019" y="-10379.6" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="5019" y="-10364.6" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer1_gpu3_expert3&#45;&gt;aggregate_layer1_gpu3 -->
<g id="edge180" class="edge">
<title>expert_layer1_gpu3_expert3&#45;&gt;aggregate_layer1_gpu3</title>
<path fill="none" stroke="black" d="M5106.21,-10472.24C5097.39,-10463.34 5087.57,-10453.44 5077.79,-10443.58"/>
<polygon fill="black" stroke="black" points="5080.22,-10441.06 5070.7,-10436.43 5075.25,-10445.99 5080.22,-10441.06"/>
</g>
<!-- expert_layer1_gpu4_expert4 -->
<g id="node119" class="node">
<title>expert_layer1_gpu4_expert4</title>
<path fill="lightcoral" stroke="black" d="M6515.5,-10540.3C6515.5,-10540.3 6046.5,-10540.3 6046.5,-10540.3 6040.5,-10540.3 6034.5,-10534.3 6034.5,-10528.3 6034.5,-10528.3 6034.5,-10484.3 6034.5,-10484.3 6034.5,-10478.3 6040.5,-10472.3 6046.5,-10472.3 6046.5,-10472.3 6515.5,-10472.3 6515.5,-10472.3 6521.5,-10472.3 6527.5,-10478.3 6527.5,-10484.3 6527.5,-10484.3 6527.5,-10528.3 6527.5,-10528.3 6527.5,-10534.3 6521.5,-10540.3 6515.5,-10540.3"/>
<text text-anchor="middle" x="6281" y="-10525.1" font-family="Times,serif" font-size="14.00">Expert 4 Layer 1 GPU 4</text>
<text text-anchor="middle" x="6281" y="-10510.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6281" y="-10495.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6281" y="-10480.1" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer1_gpu4 -->
<g id="node140" class="node">
<title>aggregate_layer1_gpu4</title>
<path fill="orange" stroke="black" d="M6104.29,-10436.3C6104.29,-10436.3 5617.19,-10436.3 5617.19,-10436.3 5611.19,-10436.3 5600.52,-10432.53 5595.85,-10428.77 5595.85,-10428.77 5483.06,-10337.83 5483.06,-10337.83 5478.38,-10334.07 5479.71,-10330.3 5485.71,-10330.3 5485.71,-10330.3 5972.81,-10330.3 5972.81,-10330.3 5978.81,-10330.3 5989.48,-10334.07 5994.15,-10337.83 5994.15,-10337.83 6106.94,-10428.77 6106.94,-10428.77 6111.62,-10432.53 6110.29,-10436.3 6104.29,-10436.3"/>
<text text-anchor="middle" x="5795" y="-10394.6" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 1 GPU 4</text>
<text text-anchor="middle" x="5795" y="-10379.6" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="5795" y="-10364.6" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer1_gpu4_expert4&#45;&gt;aggregate_layer1_gpu4 -->
<g id="edge181" class="edge">
<title>expert_layer1_gpu4_expert4&#45;&gt;aggregate_layer1_gpu4</title>
<path fill="none" stroke="black" d="M6148.2,-10472.24C6106.61,-10461.88 6059.56,-10450.17 6013.68,-10438.74"/>
<polygon fill="black" stroke="black" points="6014.46,-10435.33 6003.91,-10436.31 6012.76,-10442.12 6014.46,-10435.33"/>
</g>
<!-- expert_layer1_gpu5_expert5 -->
<g id="node120" class="node">
<title>expert_layer1_gpu5_expert5</title>
<path fill="lightcoral" stroke="black" d="M7342.5,-10540.3C7342.5,-10540.3 6873.5,-10540.3 6873.5,-10540.3 6867.5,-10540.3 6861.5,-10534.3 6861.5,-10528.3 6861.5,-10528.3 6861.5,-10484.3 6861.5,-10484.3 6861.5,-10478.3 6867.5,-10472.3 6873.5,-10472.3 6873.5,-10472.3 7342.5,-10472.3 7342.5,-10472.3 7348.5,-10472.3 7354.5,-10478.3 7354.5,-10484.3 7354.5,-10484.3 7354.5,-10528.3 7354.5,-10528.3 7354.5,-10534.3 7348.5,-10540.3 7342.5,-10540.3"/>
<text text-anchor="middle" x="7108" y="-10525.1" font-family="Times,serif" font-size="14.00">Expert 5 Layer 1 GPU 5</text>
<text text-anchor="middle" x="7108" y="-10510.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7108" y="-10495.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7108" y="-10480.1" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer1_gpu5 -->
<g id="node142" class="node">
<title>aggregate_layer1_gpu5</title>
<path fill="orange" stroke="black" d="M6822.29,-10436.3C6822.29,-10436.3 6335.19,-10436.3 6335.19,-10436.3 6329.19,-10436.3 6318.52,-10432.53 6313.85,-10428.77 6313.85,-10428.77 6201.06,-10337.83 6201.06,-10337.83 6196.38,-10334.07 6197.71,-10330.3 6203.71,-10330.3 6203.71,-10330.3 6690.81,-10330.3 6690.81,-10330.3 6696.81,-10330.3 6707.48,-10334.07 6712.15,-10337.83 6712.15,-10337.83 6824.94,-10428.77 6824.94,-10428.77 6829.62,-10432.53 6828.29,-10436.3 6822.29,-10436.3"/>
<text text-anchor="middle" x="6513" y="-10394.6" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 1 GPU 5</text>
<text text-anchor="middle" x="6513" y="-10379.6" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="6513" y="-10364.6" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer1_gpu5_expert5&#45;&gt;aggregate_layer1_gpu5 -->
<g id="edge182" class="edge">
<title>expert_layer1_gpu5_expert5&#45;&gt;aggregate_layer1_gpu5</title>
<path fill="none" stroke="black" d="M6945.41,-10472.24C6893.86,-10461.75 6835.45,-10449.87 6778.61,-10438.31"/>
<polygon fill="black" stroke="black" points="6779.26,-10434.87 6768.76,-10436.31 6777.86,-10441.73 6779.26,-10434.87"/>
</g>
<!-- expert_layer1_gpu6_expert6 -->
<g id="node121" class="node">
<title>expert_layer1_gpu6_expert6</title>
<path fill="lightcoral" stroke="black" d="M8011.5,-10540.3C8011.5,-10540.3 7542.5,-10540.3 7542.5,-10540.3 7536.5,-10540.3 7530.5,-10534.3 7530.5,-10528.3 7530.5,-10528.3 7530.5,-10484.3 7530.5,-10484.3 7530.5,-10478.3 7536.5,-10472.3 7542.5,-10472.3 7542.5,-10472.3 8011.5,-10472.3 8011.5,-10472.3 8017.5,-10472.3 8023.5,-10478.3 8023.5,-10484.3 8023.5,-10484.3 8023.5,-10528.3 8023.5,-10528.3 8023.5,-10534.3 8017.5,-10540.3 8011.5,-10540.3"/>
<text text-anchor="middle" x="7777" y="-10525.1" font-family="Times,serif" font-size="14.00">Expert 6 Layer 1 GPU 6</text>
<text text-anchor="middle" x="7777" y="-10510.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7777" y="-10495.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7777" y="-10480.1" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer1_gpu6 -->
<g id="node144" class="node">
<title>aggregate_layer1_gpu6</title>
<path fill="orange" stroke="black" d="M7772.29,-10436.3C7772.29,-10436.3 7285.19,-10436.3 7285.19,-10436.3 7279.19,-10436.3 7268.52,-10432.53 7263.85,-10428.77 7263.85,-10428.77 7151.06,-10337.83 7151.06,-10337.83 7146.38,-10334.07 7147.71,-10330.3 7153.71,-10330.3 7153.71,-10330.3 7640.81,-10330.3 7640.81,-10330.3 7646.81,-10330.3 7657.48,-10334.07 7662.15,-10337.83 7662.15,-10337.83 7774.94,-10428.77 7774.94,-10428.77 7779.62,-10432.53 7778.29,-10436.3 7772.29,-10436.3"/>
<text text-anchor="middle" x="7463" y="-10394.6" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 1 GPU 6</text>
<text text-anchor="middle" x="7463" y="-10379.6" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="7463" y="-10364.6" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer1_gpu6_expert6&#45;&gt;aggregate_layer1_gpu6 -->
<g id="edge183" class="edge">
<title>expert_layer1_gpu6_expert6&#45;&gt;aggregate_layer1_gpu6</title>
<path fill="none" stroke="black" d="M7691.2,-10472.24C7665.34,-10462.27 7636.21,-10451.05 7607.64,-10440.04"/>
<polygon fill="black" stroke="black" points="7608.56,-10436.64 7597.97,-10436.31 7606.04,-10443.17 7608.56,-10436.64"/>
</g>
<!-- expert_layer1_gpu7_expert7 -->
<g id="node122" class="node">
<title>expert_layer1_gpu7_expert7</title>
<path fill="lightcoral" stroke="black" d="M8601.5,-10540.3C8601.5,-10540.3 8132.5,-10540.3 8132.5,-10540.3 8126.5,-10540.3 8120.5,-10534.3 8120.5,-10528.3 8120.5,-10528.3 8120.5,-10484.3 8120.5,-10484.3 8120.5,-10478.3 8126.5,-10472.3 8132.5,-10472.3 8132.5,-10472.3 8601.5,-10472.3 8601.5,-10472.3 8607.5,-10472.3 8613.5,-10478.3 8613.5,-10484.3 8613.5,-10484.3 8613.5,-10528.3 8613.5,-10528.3 8613.5,-10534.3 8607.5,-10540.3 8601.5,-10540.3"/>
<text text-anchor="middle" x="8367" y="-10525.1" font-family="Times,serif" font-size="14.00">Expert 7 Layer 1 GPU 7</text>
<text text-anchor="middle" x="8367" y="-10510.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8367" y="-10495.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8367" y="-10480.1" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer1_gpu7 -->
<g id="node146" class="node">
<title>aggregate_layer1_gpu7</title>
<path fill="orange" stroke="black" d="M8607.29,-10436.3C8607.29,-10436.3 8120.19,-10436.3 8120.19,-10436.3 8114.19,-10436.3 8103.52,-10432.53 8098.85,-10428.77 8098.85,-10428.77 7986.06,-10337.83 7986.06,-10337.83 7981.38,-10334.07 7982.71,-10330.3 7988.71,-10330.3 7988.71,-10330.3 8475.81,-10330.3 8475.81,-10330.3 8481.81,-10330.3 8492.48,-10334.07 8497.15,-10337.83 8497.15,-10337.83 8609.94,-10428.77 8609.94,-10428.77 8614.62,-10432.53 8613.29,-10436.3 8607.29,-10436.3"/>
<text text-anchor="middle" x="8298" y="-10394.6" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 1 GPU 7</text>
<text text-anchor="middle" x="8298" y="-10379.6" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="8298" y="-10364.6" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer1_gpu7_expert7&#45;&gt;aggregate_layer1_gpu7 -->
<g id="edge184" class="edge">
<title>expert_layer1_gpu7_expert7&#45;&gt;aggregate_layer1_gpu7</title>
<path fill="none" stroke="black" d="M8348.15,-10472.24C8343.37,-10463.86 8338.08,-10454.59 8332.79,-10445.3"/>
<polygon fill="black" stroke="black" points="8335.72,-10443.38 8327.73,-10436.43 8329.64,-10446.85 8335.72,-10443.38"/>
</g>
<!-- expert_layer1_gpu8_expert8 -->
<g id="node123" class="node">
<title>expert_layer1_gpu8_expert8</title>
<path fill="lightcoral" stroke="black" d="M9251.5,-10540.3C9251.5,-10540.3 8782.5,-10540.3 8782.5,-10540.3 8776.5,-10540.3 8770.5,-10534.3 8770.5,-10528.3 8770.5,-10528.3 8770.5,-10484.3 8770.5,-10484.3 8770.5,-10478.3 8776.5,-10472.3 8782.5,-10472.3 8782.5,-10472.3 9251.5,-10472.3 9251.5,-10472.3 9257.5,-10472.3 9263.5,-10478.3 9263.5,-10484.3 9263.5,-10484.3 9263.5,-10528.3 9263.5,-10528.3 9263.5,-10534.3 9257.5,-10540.3 9251.5,-10540.3"/>
<text text-anchor="middle" x="9017" y="-10525.1" font-family="Times,serif" font-size="14.00">Expert 8 Layer 1 GPU 8</text>
<text text-anchor="middle" x="9017" y="-10510.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9017" y="-10495.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9017" y="-10480.1" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer1_gpu8 -->
<g id="node148" class="node">
<title>aggregate_layer1_gpu8</title>
<path fill="orange" stroke="black" d="M9396.29,-10436.3C9396.29,-10436.3 8909.19,-10436.3 8909.19,-10436.3 8903.19,-10436.3 8892.52,-10432.53 8887.85,-10428.77 8887.85,-10428.77 8775.06,-10337.83 8775.06,-10337.83 8770.38,-10334.07 8771.71,-10330.3 8777.71,-10330.3 8777.71,-10330.3 9264.81,-10330.3 9264.81,-10330.3 9270.81,-10330.3 9281.48,-10334.07 9286.15,-10337.83 9286.15,-10337.83 9398.94,-10428.77 9398.94,-10428.77 9403.62,-10432.53 9402.29,-10436.3 9396.29,-10436.3"/>
<text text-anchor="middle" x="9087" y="-10394.6" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 1 GPU 8</text>
<text text-anchor="middle" x="9087" y="-10379.6" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="9087" y="-10364.6" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer1_gpu8_expert8&#45;&gt;aggregate_layer1_gpu8 -->
<g id="edge185" class="edge">
<title>expert_layer1_gpu8_expert8&#45;&gt;aggregate_layer1_gpu8</title>
<path fill="none" stroke="black" d="M9036.13,-10472.24C9040.97,-10463.86 9046.34,-10454.59 9051.71,-10445.3"/>
<polygon fill="black" stroke="black" points="9054.87,-10446.84 9056.84,-10436.43 9048.81,-10443.33 9054.87,-10446.84"/>
</g>
<!-- expert_layer1_gpu9_expert9 -->
<g id="node124" class="node">
<title>expert_layer1_gpu9_expert9</title>
<path fill="lightcoral" stroke="black" d="M9998.5,-10540.3C9998.5,-10540.3 9529.5,-10540.3 9529.5,-10540.3 9523.5,-10540.3 9517.5,-10534.3 9517.5,-10528.3 9517.5,-10528.3 9517.5,-10484.3 9517.5,-10484.3 9517.5,-10478.3 9523.5,-10472.3 9529.5,-10472.3 9529.5,-10472.3 9998.5,-10472.3 9998.5,-10472.3 10004.5,-10472.3 10010.5,-10478.3 10010.5,-10484.3 10010.5,-10484.3 10010.5,-10528.3 10010.5,-10528.3 10010.5,-10534.3 10004.5,-10540.3 9998.5,-10540.3"/>
<text text-anchor="middle" x="9764" y="-10525.1" font-family="Times,serif" font-size="14.00">Expert 9 Layer 1 GPU 9</text>
<text text-anchor="middle" x="9764" y="-10510.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9764" y="-10495.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9764" y="-10480.1" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer1_gpu9 -->
<g id="node150" class="node">
<title>aggregate_layer1_gpu9</title>
<path fill="orange" stroke="black" d="M10240.29,-10436.3C10240.29,-10436.3 9753.19,-10436.3 9753.19,-10436.3 9747.19,-10436.3 9736.52,-10432.53 9731.85,-10428.77 9731.85,-10428.77 9619.06,-10337.83 9619.06,-10337.83 9614.38,-10334.07 9615.71,-10330.3 9621.71,-10330.3 9621.71,-10330.3 10108.81,-10330.3 10108.81,-10330.3 10114.81,-10330.3 10125.48,-10334.07 10130.15,-10337.83 10130.15,-10337.83 10242.94,-10428.77 10242.94,-10428.77 10247.62,-10432.53 10246.29,-10436.3 10240.29,-10436.3"/>
<text text-anchor="middle" x="9931" y="-10394.6" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 1 GPU 9</text>
<text text-anchor="middle" x="9931" y="-10379.6" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="9931" y="-10364.6" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer1_gpu9_expert9&#45;&gt;aggregate_layer1_gpu9 -->
<g id="edge186" class="edge">
<title>expert_layer1_gpu9_expert9&#45;&gt;aggregate_layer1_gpu9</title>
<path fill="none" stroke="black" d="M9809.63,-10472.24C9822.39,-10462.99 9836.64,-10452.67 9850.77,-10442.43"/>
<polygon fill="black" stroke="black" points="9853.01,-10445.13 9859.06,-10436.43 9848.9,-10439.46 9853.01,-10445.13"/>
</g>
<!-- expert_layer1_gpu10_expert10 -->
<g id="node125" class="node">
<title>expert_layer1_gpu10_expert10</title>
<path fill="lightcoral" stroke="black" d="M10748.5,-10540.3C10748.5,-10540.3 10279.5,-10540.3 10279.5,-10540.3 10273.5,-10540.3 10267.5,-10534.3 10267.5,-10528.3 10267.5,-10528.3 10267.5,-10484.3 10267.5,-10484.3 10267.5,-10478.3 10273.5,-10472.3 10279.5,-10472.3 10279.5,-10472.3 10748.5,-10472.3 10748.5,-10472.3 10754.5,-10472.3 10760.5,-10478.3 10760.5,-10484.3 10760.5,-10484.3 10760.5,-10528.3 10760.5,-10528.3 10760.5,-10534.3 10754.5,-10540.3 10748.5,-10540.3"/>
<text text-anchor="middle" x="10514" y="-10525.1" font-family="Times,serif" font-size="14.00">Expert 10 Layer 1 GPU 10</text>
<text text-anchor="middle" x="10514" y="-10510.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10514" y="-10495.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10514" y="-10480.1" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer1_gpu10 -->
<g id="node152" class="node">
<title>aggregate_layer1_gpu10</title>
<path fill="orange" stroke="black" d="M10993.29,-10436.3C10993.29,-10436.3 10506.19,-10436.3 10506.19,-10436.3 10500.19,-10436.3 10489.52,-10432.53 10484.85,-10428.77 10484.85,-10428.77 10372.06,-10337.83 10372.06,-10337.83 10367.38,-10334.07 10368.71,-10330.3 10374.71,-10330.3 10374.71,-10330.3 10861.81,-10330.3 10861.81,-10330.3 10867.81,-10330.3 10878.48,-10334.07 10883.15,-10337.83 10883.15,-10337.83 10995.94,-10428.77 10995.94,-10428.77 11000.62,-10432.53 10999.29,-10436.3 10993.29,-10436.3"/>
<text text-anchor="middle" x="10684" y="-10394.6" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 1 GPU 10</text>
<text text-anchor="middle" x="10684" y="-10379.6" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="10684" y="-10364.6" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer1_gpu10_expert10&#45;&gt;aggregate_layer1_gpu10 -->
<g id="edge187" class="edge">
<title>expert_layer1_gpu10_expert10&#45;&gt;aggregate_layer1_gpu10</title>
<path fill="none" stroke="black" d="M10560.45,-10472.24C10573.44,-10462.99 10587.94,-10452.67 10602.32,-10442.43"/>
<polygon fill="black" stroke="black" points="10604.65,-10445.08 10610.76,-10436.43 10600.59,-10439.37 10604.65,-10445.08"/>
</g>
<!-- expert_layer1_gpu11_expert11 -->
<g id="node126" class="node">
<title>expert_layer1_gpu11_expert11</title>
<path fill="lightcoral" stroke="black" d="M11476.5,-10540.3C11476.5,-10540.3 11007.5,-10540.3 11007.5,-10540.3 11001.5,-10540.3 10995.5,-10534.3 10995.5,-10528.3 10995.5,-10528.3 10995.5,-10484.3 10995.5,-10484.3 10995.5,-10478.3 11001.5,-10472.3 11007.5,-10472.3 11007.5,-10472.3 11476.5,-10472.3 11476.5,-10472.3 11482.5,-10472.3 11488.5,-10478.3 11488.5,-10484.3 11488.5,-10484.3 11488.5,-10528.3 11488.5,-10528.3 11488.5,-10534.3 11482.5,-10540.3 11476.5,-10540.3"/>
<text text-anchor="middle" x="11242" y="-10525.1" font-family="Times,serif" font-size="14.00">Expert 11 Layer 1 GPU 11</text>
<text text-anchor="middle" x="11242" y="-10510.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11242" y="-10495.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11242" y="-10480.1" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer1_gpu11 -->
<g id="node154" class="node">
<title>aggregate_layer1_gpu11</title>
<path fill="orange" stroke="black" d="M11700.29,-10436.3C11700.29,-10436.3 11213.19,-10436.3 11213.19,-10436.3 11207.19,-10436.3 11196.52,-10432.53 11191.85,-10428.77 11191.85,-10428.77 11079.06,-10337.83 11079.06,-10337.83 11074.38,-10334.07 11075.71,-10330.3 11081.71,-10330.3 11081.71,-10330.3 11568.81,-10330.3 11568.81,-10330.3 11574.81,-10330.3 11585.48,-10334.07 11590.15,-10337.83 11590.15,-10337.83 11702.94,-10428.77 11702.94,-10428.77 11707.62,-10432.53 11706.29,-10436.3 11700.29,-10436.3"/>
<text text-anchor="middle" x="11391" y="-10394.6" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 1 GPU 11</text>
<text text-anchor="middle" x="11391" y="-10379.6" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="11391" y="-10364.6" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer1_gpu11_expert11&#45;&gt;aggregate_layer1_gpu11 -->
<g id="edge188" class="edge">
<title>expert_layer1_gpu11_expert11&#45;&gt;aggregate_layer1_gpu11</title>
<path fill="none" stroke="black" d="M11282.71,-10472.24C11293.88,-10463.17 11306.34,-10453.05 11318.71,-10443.01"/>
<polygon fill="black" stroke="black" points="11321.25,-10445.45 11326.81,-10436.43 11316.84,-10440.01 11321.25,-10445.45"/>
</g>
<!-- expert_layer1_gpu12_expert12 -->
<g id="node127" class="node">
<title>expert_layer1_gpu12_expert12</title>
<path fill="lightcoral" stroke="black" d="M12182.5,-10540.3C12182.5,-10540.3 11713.5,-10540.3 11713.5,-10540.3 11707.5,-10540.3 11701.5,-10534.3 11701.5,-10528.3 11701.5,-10528.3 11701.5,-10484.3 11701.5,-10484.3 11701.5,-10478.3 11707.5,-10472.3 11713.5,-10472.3 11713.5,-10472.3 12182.5,-10472.3 12182.5,-10472.3 12188.5,-10472.3 12194.5,-10478.3 12194.5,-10484.3 12194.5,-10484.3 12194.5,-10528.3 12194.5,-10528.3 12194.5,-10534.3 12188.5,-10540.3 12182.5,-10540.3"/>
<text text-anchor="middle" x="11948" y="-10525.1" font-family="Times,serif" font-size="14.00">Expert 12 Layer 1 GPU 12</text>
<text text-anchor="middle" x="11948" y="-10510.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11948" y="-10495.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11948" y="-10480.1" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer1_gpu12 -->
<g id="node156" class="node">
<title>aggregate_layer1_gpu12</title>
<path fill="orange" stroke="black" d="M12384.29,-10436.3C12384.29,-10436.3 11897.19,-10436.3 11897.19,-10436.3 11891.19,-10436.3 11880.52,-10432.53 11875.85,-10428.77 11875.85,-10428.77 11763.06,-10337.83 11763.06,-10337.83 11758.38,-10334.07 11759.71,-10330.3 11765.71,-10330.3 11765.71,-10330.3 12252.81,-10330.3 12252.81,-10330.3 12258.81,-10330.3 12269.48,-10334.07 12274.15,-10337.83 12274.15,-10337.83 12386.94,-10428.77 12386.94,-10428.77 12391.62,-10432.53 12390.29,-10436.3 12384.29,-10436.3"/>
<text text-anchor="middle" x="12075" y="-10394.6" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 1 GPU 12</text>
<text text-anchor="middle" x="12075" y="-10379.6" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="12075" y="-10364.6" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer1_gpu12_expert12&#45;&gt;aggregate_layer1_gpu12 -->
<g id="edge189" class="edge">
<title>expert_layer1_gpu12_expert12&#45;&gt;aggregate_layer1_gpu12</title>
<path fill="none" stroke="black" d="M11982.7,-10472.24C11992.04,-10463.34 12002.43,-10453.44 12012.78,-10443.58"/>
<polygon fill="black" stroke="black" points="12015.46,-10445.86 12020.29,-10436.43 12010.63,-10440.79 12015.46,-10445.86"/>
</g>
<!-- expert_layer1_gpu13_expert13 -->
<g id="node128" class="node">
<title>expert_layer1_gpu13_expert13</title>
<path fill="lightcoral" stroke="black" d="M13169.5,-10540.3C13169.5,-10540.3 12700.5,-10540.3 12700.5,-10540.3 12694.5,-10540.3 12688.5,-10534.3 12688.5,-10528.3 12688.5,-10528.3 12688.5,-10484.3 12688.5,-10484.3 12688.5,-10478.3 12694.5,-10472.3 12700.5,-10472.3 12700.5,-10472.3 13169.5,-10472.3 13169.5,-10472.3 13175.5,-10472.3 13181.5,-10478.3 13181.5,-10484.3 13181.5,-10484.3 13181.5,-10528.3 13181.5,-10528.3 13181.5,-10534.3 13175.5,-10540.3 13169.5,-10540.3"/>
<text text-anchor="middle" x="12935" y="-10525.1" font-family="Times,serif" font-size="14.00">Expert 13 Layer 1 GPU 13</text>
<text text-anchor="middle" x="12935" y="-10510.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12935" y="-10495.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12935" y="-10480.1" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer1_gpu13 -->
<g id="node158" class="node">
<title>aggregate_layer1_gpu13</title>
<path fill="orange" stroke="black" d="M13652.29,-10436.3C13652.29,-10436.3 13165.19,-10436.3 13165.19,-10436.3 13159.19,-10436.3 13148.52,-10432.53 13143.85,-10428.77 13143.85,-10428.77 13031.06,-10337.83 13031.06,-10337.83 13026.38,-10334.07 13027.71,-10330.3 13033.71,-10330.3 13033.71,-10330.3 13520.81,-10330.3 13520.81,-10330.3 13526.81,-10330.3 13537.48,-10334.07 13542.15,-10337.83 13542.15,-10337.83 13654.94,-10428.77 13654.94,-10428.77 13659.62,-10432.53 13658.29,-10436.3 13652.29,-10436.3"/>
<text text-anchor="middle" x="13343" y="-10394.6" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 1 GPU 13</text>
<text text-anchor="middle" x="13343" y="-10379.6" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="13343" y="-10364.6" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer1_gpu13_expert13&#45;&gt;aggregate_layer1_gpu13 -->
<g id="edge190" class="edge">
<title>expert_layer1_gpu13_expert13&#45;&gt;aggregate_layer1_gpu13</title>
<path fill="none" stroke="black" d="M13046.49,-10472.24C13080.96,-10462.01 13119.91,-10450.46 13157.97,-10439.17"/>
<polygon fill="black" stroke="black" points="13159.03,-10442.51 13167.62,-10436.31 13157.04,-10435.8 13159.03,-10442.51"/>
</g>
<!-- expert_layer1_gpu14_expert14 -->
<g id="node129" class="node">
<title>expert_layer1_gpu14_expert14</title>
<path fill="lightcoral" stroke="black" d="M14145.5,-10540.3C14145.5,-10540.3 13676.5,-10540.3 13676.5,-10540.3 13670.5,-10540.3 13664.5,-10534.3 13664.5,-10528.3 13664.5,-10528.3 13664.5,-10484.3 13664.5,-10484.3 13664.5,-10478.3 13670.5,-10472.3 13676.5,-10472.3 13676.5,-10472.3 14145.5,-10472.3 14145.5,-10472.3 14151.5,-10472.3 14157.5,-10478.3 14157.5,-10484.3 14157.5,-10484.3 14157.5,-10528.3 14157.5,-10528.3 14157.5,-10534.3 14151.5,-10540.3 14145.5,-10540.3"/>
<text text-anchor="middle" x="13911" y="-10525.1" font-family="Times,serif" font-size="14.00">Expert 14 Layer 1 GPU 14</text>
<text text-anchor="middle" x="13911" y="-10510.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="13911" y="-10495.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="13911" y="-10480.1" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer1_gpu14 -->
<g id="node160" class="node">
<title>aggregate_layer1_gpu14</title>
<path fill="orange" stroke="black" d="M14616.29,-10436.3C14616.29,-10436.3 14129.19,-10436.3 14129.19,-10436.3 14123.19,-10436.3 14112.52,-10432.53 14107.85,-10428.77 14107.85,-10428.77 13995.06,-10337.83 13995.06,-10337.83 13990.38,-10334.07 13991.71,-10330.3 13997.71,-10330.3 13997.71,-10330.3 14484.81,-10330.3 14484.81,-10330.3 14490.81,-10330.3 14501.48,-10334.07 14506.15,-10337.83 14506.15,-10337.83 14618.94,-10428.77 14618.94,-10428.77 14623.62,-10432.53 14622.29,-10436.3 14616.29,-10436.3"/>
<text text-anchor="middle" x="14307" y="-10394.6" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 1 GPU 14</text>
<text text-anchor="middle" x="14307" y="-10379.6" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="14307" y="-10364.6" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer1_gpu14_expert14&#45;&gt;aggregate_layer1_gpu14 -->
<g id="edge191" class="edge">
<title>expert_layer1_gpu14_expert14&#45;&gt;aggregate_layer1_gpu14</title>
<path fill="none" stroke="black" d="M14019.21,-10472.24C14052.53,-10462.06 14090.15,-10450.56 14126.94,-10439.32"/>
<polygon fill="black" stroke="black" points="14128.24,-10442.58 14136.78,-10436.31 14126.19,-10435.89 14128.24,-10442.58"/>
</g>
<!-- expert_layer1_gpu15_expert15 -->
<g id="node130" class="node">
<title>expert_layer1_gpu15_expert15</title>
<path fill="lightcoral" stroke="black" d="M15212.5,-10540.3C15212.5,-10540.3 14743.5,-10540.3 14743.5,-10540.3 14737.5,-10540.3 14731.5,-10534.3 14731.5,-10528.3 14731.5,-10528.3 14731.5,-10484.3 14731.5,-10484.3 14731.5,-10478.3 14737.5,-10472.3 14743.5,-10472.3 14743.5,-10472.3 15212.5,-10472.3 15212.5,-10472.3 15218.5,-10472.3 15224.5,-10478.3 15224.5,-10484.3 15224.5,-10484.3 15224.5,-10528.3 15224.5,-10528.3 15224.5,-10534.3 15218.5,-10540.3 15212.5,-10540.3"/>
<text text-anchor="middle" x="14978" y="-10525.1" font-family="Times,serif" font-size="14.00">Expert 15 Layer 1 GPU 15</text>
<text text-anchor="middle" x="14978" y="-10510.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14978" y="-10495.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14978" y="-10480.1" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer1_gpu15 -->
<g id="node162" class="node">
<title>aggregate_layer1_gpu15</title>
<path fill="orange" stroke="black" d="M15775.29,-10436.3C15775.29,-10436.3 15288.19,-10436.3 15288.19,-10436.3 15282.19,-10436.3 15271.52,-10432.53 15266.85,-10428.77 15266.85,-10428.77 15154.06,-10337.83 15154.06,-10337.83 15149.38,-10334.07 15150.71,-10330.3 15156.71,-10330.3 15156.71,-10330.3 15643.81,-10330.3 15643.81,-10330.3 15649.81,-10330.3 15660.48,-10334.07 15665.15,-10337.83 15665.15,-10337.83 15777.94,-10428.77 15777.94,-10428.77 15782.62,-10432.53 15781.29,-10436.3 15775.29,-10436.3"/>
<text text-anchor="middle" x="15466" y="-10394.6" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 1 GPU 15</text>
<text text-anchor="middle" x="15466" y="-10379.6" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="15466" y="-10364.6" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer1_gpu15_expert15&#45;&gt;aggregate_layer1_gpu15 -->
<g id="edge192" class="edge">
<title>expert_layer1_gpu15_expert15&#45;&gt;aggregate_layer1_gpu15</title>
<path fill="none" stroke="black" d="M15111.35,-10472.24C15157.74,-10460.73 15210.91,-10447.55 15261.72,-10434.95"/>
<polygon fill="black" stroke="black" points="15262.64,-10438.33 15271.51,-10432.52 15260.96,-10431.53 15262.64,-10438.33"/>
</g>
<!-- comm_layer1 -->
<g id="node163" class="node">
<title>comm_layer1</title>
<ellipse fill="lightpink" stroke="black" cx="8692" cy="-10613.78" rx="243.49" ry="37.45"/>
<text text-anchor="middle" x="8692" y="-10625.08" font-family="Times,serif" font-size="14.00">Cross&#45;GPU Communication Layer 1</text>
<text text-anchor="middle" x="8692" y="-10610.08" font-family="Times,serif" font-size="14.00">Input: Tokens from routing decisions</text>
<text text-anchor="middle" x="8692" y="-10595.08" font-family="Times,serif" font-size="14.00">Output: Tokens delivered to destination GPUs</text>
</g>
<!-- route_layer1_gpu0&#45;&gt;comm_layer1 -->
<g id="edge145" class="edge">
<title>route_layer1_gpu0&#45;&gt;comm_layer1</title>
<path fill="none" stroke="black" d="M2056.65,-10710.15C2136.89,-10701.1 2227.82,-10692.2 2311,-10687.25 3534.36,-10614.48 7408.93,-10613.36 8438.64,-10614.4"/>
<polygon fill="black" stroke="black" points="8438.76,-10617.9 8448.76,-10614.41 8438.77,-10610.9 8438.76,-10617.9"/>
</g>
<!-- mha_layer2_gpu0 -->
<g id="node164" class="node">
<title>mha_layer2_gpu0</title>
<path fill="lightblue" stroke="black" d="M1983,-10294.3C1983,-10294.3 1535,-10294.3 1535,-10294.3 1529,-10294.3 1523,-10288.3 1523,-10282.3 1523,-10282.3 1523,-10253.3 1523,-10253.3 1523,-10247.3 1529,-10241.3 1535,-10241.3 1535,-10241.3 1983,-10241.3 1983,-10241.3 1989,-10241.3 1995,-10247.3 1995,-10253.3 1995,-10253.3 1995,-10282.3 1995,-10282.3 1995,-10288.3 1989,-10294.3 1983,-10294.3"/>
<text text-anchor="middle" x="1759" y="-10279.1" font-family="Times,serif" font-size="14.00">MHA Layer 2 GPU 0</text>
<text text-anchor="middle" x="1759" y="-10264.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1759" y="-10249.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer1_gpu0&#45;&gt;mha_layer2_gpu0 -->
<g id="edge193" class="edge">
<title>aggregate_layer1_gpu0&#45;&gt;mha_layer2_gpu0</title>
<path fill="none" stroke="black" d="M2040.69,-10330.28C1987.3,-10318.63 1932.69,-10306.71 1885.93,-10296.51"/>
<polygon fill="black" stroke="black" points="1886.6,-10293.07 1876.08,-10294.35 1885.1,-10299.91 1886.6,-10293.07"/>
</g>
<!-- route_layer1_gpu1&#45;&gt;comm_layer1 -->
<g id="edge146" class="edge">
<title>route_layer1_gpu1&#45;&gt;comm_layer1</title>
<path fill="none" stroke="black" d="M2887.5,-10714.05C2991.53,-10703.83 3115.78,-10693.08 3228,-10687.25 4262.07,-10633.55 7505.5,-10618.74 8438.58,-10615.54"/>
<polygon fill="black" stroke="black" points="8438.78,-10619.03 8448.77,-10615.5 8438.76,-10612.03 8438.78,-10619.03"/>
</g>
<!-- mha_layer2_gpu1 -->
<g id="node165" class="node">
<title>mha_layer2_gpu1</title>
<path fill="lightblue" stroke="black" d="M2710,-10294.3C2710,-10294.3 2262,-10294.3 2262,-10294.3 2256,-10294.3 2250,-10288.3 2250,-10282.3 2250,-10282.3 2250,-10253.3 2250,-10253.3 2250,-10247.3 2256,-10241.3 2262,-10241.3 2262,-10241.3 2710,-10241.3 2710,-10241.3 2716,-10241.3 2722,-10247.3 2722,-10253.3 2722,-10253.3 2722,-10282.3 2722,-10282.3 2722,-10288.3 2716,-10294.3 2710,-10294.3"/>
<text text-anchor="middle" x="2486" y="-10279.1" font-family="Times,serif" font-size="14.00">MHA Layer 2 GPU 1</text>
<text text-anchor="middle" x="2486" y="-10264.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2486" y="-10249.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer1_gpu1&#45;&gt;mha_layer2_gpu1 -->
<g id="edge194" class="edge">
<title>aggregate_layer1_gpu1&#45;&gt;mha_layer2_gpu1</title>
<path fill="none" stroke="black" d="M3095.3,-10344.55C2966.37,-10328.52 2819.06,-10310.2 2701.58,-10295.6"/>
<polygon fill="black" stroke="black" points="2701.74,-10292.09 2691.39,-10294.33 2700.88,-10299.04 2701.74,-10292.09"/>
</g>
<!-- route_layer1_gpu2&#45;&gt;comm_layer1 -->
<g id="edge147" class="edge">
<title>route_layer1_gpu2&#45;&gt;comm_layer1</title>
<path fill="none" stroke="black" d="M3818.17,-10724.62C4027.6,-10712.71 4336.43,-10696.42 4606,-10687.25 6056.43,-10637.93 7797.69,-10621.16 8438.99,-10616.41"/>
<polygon fill="black" stroke="black" points="8439.31,-10619.9 8449.28,-10616.33 8439.25,-10612.9 8439.31,-10619.9"/>
</g>
<!-- mha_layer2_gpu2 -->
<g id="node166" class="node">
<title>mha_layer2_gpu2</title>
<path fill="lightblue" stroke="black" d="M3979,-10294.3C3979,-10294.3 3531,-10294.3 3531,-10294.3 3525,-10294.3 3519,-10288.3 3519,-10282.3 3519,-10282.3 3519,-10253.3 3519,-10253.3 3519,-10247.3 3525,-10241.3 3531,-10241.3 3531,-10241.3 3979,-10241.3 3979,-10241.3 3985,-10241.3 3991,-10247.3 3991,-10253.3 3991,-10253.3 3991,-10282.3 3991,-10282.3 3991,-10288.3 3985,-10294.3 3979,-10294.3"/>
<text text-anchor="middle" x="3755" y="-10279.1" font-family="Times,serif" font-size="14.00">MHA Layer 2 GPU 2</text>
<text text-anchor="middle" x="3755" y="-10264.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3755" y="-10249.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer1_gpu2&#45;&gt;mha_layer2_gpu2 -->
<g id="edge195" class="edge">
<title>aggregate_layer1_gpu2&#45;&gt;mha_layer2_gpu2</title>
<path fill="none" stroke="black" d="M3957.06,-10330.28C3919.72,-10318.92 3881.55,-10307.31 3848.59,-10297.28"/>
<polygon fill="black" stroke="black" points="3849.57,-10293.92 3838.98,-10294.35 3847.53,-10300.61 3849.57,-10293.92"/>
</g>
<!-- route_layer1_gpu3&#45;&gt;comm_layer1 -->
<g id="edge148" class="edge">
<title>route_layer1_gpu3&#45;&gt;comm_layer1</title>
<path fill="none" stroke="black" d="M5188.16,-10718.24C5320.78,-10707.3 5488.94,-10694.69 5639,-10687.25 6676.95,-10635.8 7915.27,-10620.65 8438.63,-10616.37"/>
<polygon fill="black" stroke="black" points="8438.98,-10619.87 8448.95,-10616.29 8438.92,-10612.87 8438.98,-10619.87"/>
</g>
<!-- mha_layer2_gpu3 -->
<g id="node167" class="node">
<title>mha_layer2_gpu3</title>
<path fill="lightblue" stroke="black" d="M4940,-10294.3C4940,-10294.3 4492,-10294.3 4492,-10294.3 4486,-10294.3 4480,-10288.3 4480,-10282.3 4480,-10282.3 4480,-10253.3 4480,-10253.3 4480,-10247.3 4486,-10241.3 4492,-10241.3 4492,-10241.3 4940,-10241.3 4940,-10241.3 4946,-10241.3 4952,-10247.3 4952,-10253.3 4952,-10253.3 4952,-10282.3 4952,-10282.3 4952,-10288.3 4946,-10294.3 4940,-10294.3"/>
<text text-anchor="middle" x="4716" y="-10279.1" font-family="Times,serif" font-size="14.00">MHA Layer 2 GPU 3</text>
<text text-anchor="middle" x="4716" y="-10264.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4716" y="-10249.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer1_gpu3&#45;&gt;mha_layer2_gpu3 -->
<g id="edge196" class="edge">
<title>aggregate_layer1_gpu3&#45;&gt;mha_layer2_gpu3</title>
<path fill="none" stroke="black" d="M4879.92,-10330.2C4850.26,-10319.09 4819.97,-10307.75 4793.63,-10297.88"/>
<polygon fill="black" stroke="black" points="4794.7,-10294.54 4784.11,-10294.31 4792.25,-10301.1 4794.7,-10294.54"/>
</g>
<!-- route_layer1_gpu4&#45;&gt;comm_layer1 -->
<g id="edge149" class="edge">
<title>route_layer1_gpu4&#45;&gt;comm_layer1</title>
<path fill="none" stroke="black" d="M6213.9,-10712.63C6302.89,-10703.25 6405.57,-10693.5 6499,-10687.25 7200.8,-10640.35 8031.07,-10623.4 8439.4,-10617.6"/>
<polygon fill="black" stroke="black" points="8439.62,-10621.09 8449.57,-10617.45 8439.52,-10614.1 8439.62,-10621.09"/>
</g>
<!-- mha_layer2_gpu4 -->
<g id="node168" class="node">
<title>mha_layer2_gpu4</title>
<path fill="lightblue" stroke="black" d="M5868,-10294.3C5868,-10294.3 5420,-10294.3 5420,-10294.3 5414,-10294.3 5408,-10288.3 5408,-10282.3 5408,-10282.3 5408,-10253.3 5408,-10253.3 5408,-10247.3 5414,-10241.3 5420,-10241.3 5420,-10241.3 5868,-10241.3 5868,-10241.3 5874,-10241.3 5880,-10247.3 5880,-10253.3 5880,-10253.3 5880,-10282.3 5880,-10282.3 5880,-10288.3 5874,-10294.3 5868,-10294.3"/>
<text text-anchor="middle" x="5644" y="-10279.1" font-family="Times,serif" font-size="14.00">MHA Layer 2 GPU 4</text>
<text text-anchor="middle" x="5644" y="-10264.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5644" y="-10249.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer1_gpu4&#45;&gt;mha_layer2_gpu4 -->
<g id="edge197" class="edge">
<title>aggregate_layer1_gpu4&#45;&gt;mha_layer2_gpu4</title>
<path fill="none" stroke="black" d="M5725.69,-10330.2C5712.21,-10320.07 5698.46,-10309.74 5686.19,-10300.51"/>
<polygon fill="black" stroke="black" points="5688.04,-10297.52 5677.94,-10294.31 5683.83,-10303.12 5688.04,-10297.52"/>
</g>
<!-- route_layer1_gpu5&#45;&gt;comm_layer1 -->
<g id="edge150" class="edge">
<title>route_layer1_gpu5&#45;&gt;comm_layer1</title>
<path fill="none" stroke="black" d="M7068.93,-10708.95C7134.64,-10700.94 7206.6,-10692.96 7273,-10687.25 7682.88,-10652.05 8160.94,-10631.95 8444.39,-10622.22"/>
<polygon fill="black" stroke="black" points="8444.52,-10625.72 8454.39,-10621.88 8444.28,-10618.72 8444.52,-10625.72"/>
</g>
<!-- mha_layer2_gpu5 -->
<g id="node169" class="node">
<title>mha_layer2_gpu5</title>
<path fill="lightblue" stroke="black" d="M6576,-10294.3C6576,-10294.3 6128,-10294.3 6128,-10294.3 6122,-10294.3 6116,-10288.3 6116,-10282.3 6116,-10282.3 6116,-10253.3 6116,-10253.3 6116,-10247.3 6122,-10241.3 6128,-10241.3 6128,-10241.3 6576,-10241.3 6576,-10241.3 6582,-10241.3 6588,-10247.3 6588,-10253.3 6588,-10253.3 6588,-10282.3 6588,-10282.3 6588,-10288.3 6582,-10294.3 6576,-10294.3"/>
<text text-anchor="middle" x="6352" y="-10279.1" font-family="Times,serif" font-size="14.00">MHA Layer 2 GPU 5</text>
<text text-anchor="middle" x="6352" y="-10264.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6352" y="-10249.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer1_gpu5&#45;&gt;mha_layer2_gpu5 -->
<g id="edge198" class="edge">
<title>aggregate_layer1_gpu5&#45;&gt;mha_layer2_gpu5</title>
<path fill="none" stroke="black" d="M6439.1,-10330.2C6424.59,-10319.97 6409.79,-10309.54 6396.6,-10300.24"/>
<polygon fill="black" stroke="black" points="6398.38,-10297.21 6388.19,-10294.31 6394.35,-10302.94 6398.38,-10297.21"/>
</g>
<!-- route_layer1_gpu6&#45;&gt;comm_layer1 -->
<g id="edge151" class="edge">
<title>route_layer1_gpu6&#45;&gt;comm_layer1</title>
<path fill="none" stroke="black" d="M7841.71,-10707.95C7894.88,-10700.85 7951.41,-10693.55 8004,-10687.25 8163.1,-10668.19 8343.22,-10649.31 8479.25,-10635.6"/>
<polygon fill="black" stroke="black" points="8479.78,-10639.07 8489.38,-10634.58 8479.08,-10632.1 8479.78,-10639.07"/>
</g>
<!-- mha_layer2_gpu6 -->
<g id="node170" class="node">
<title>mha_layer2_gpu6</title>
<path fill="lightblue" stroke="black" d="M7588,-10294.3C7588,-10294.3 7140,-10294.3 7140,-10294.3 7134,-10294.3 7128,-10288.3 7128,-10282.3 7128,-10282.3 7128,-10253.3 7128,-10253.3 7128,-10247.3 7134,-10241.3 7140,-10241.3 7140,-10241.3 7588,-10241.3 7588,-10241.3 7594,-10241.3 7600,-10247.3 7600,-10253.3 7600,-10253.3 7600,-10282.3 7600,-10282.3 7600,-10288.3 7594,-10294.3 7588,-10294.3"/>
<text text-anchor="middle" x="7364" y="-10279.1" font-family="Times,serif" font-size="14.00">MHA Layer 2 GPU 6</text>
<text text-anchor="middle" x="7364" y="-10264.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7364" y="-10249.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer1_gpu6&#45;&gt;mha_layer2_gpu6 -->
<g id="edge199" class="edge">
<title>aggregate_layer1_gpu6&#45;&gt;mha_layer2_gpu6</title>
<path fill="none" stroke="black" d="M7417.56,-10330.2C7409.23,-10320.65 7400.75,-10310.93 7393.06,-10302.12"/>
<polygon fill="black" stroke="black" points="7395.47,-10299.55 7386.25,-10294.31 7390.19,-10304.15 7395.47,-10299.55"/>
</g>
<!-- route_layer1_gpu7&#45;&gt;comm_layer1 -->
<g id="edge152" class="edge">
<title>route_layer1_gpu7&#45;&gt;comm_layer1</title>
<path fill="none" stroke="black" d="M8491.89,-10687.19C8524.54,-10675.37 8558.57,-10663.06 8589.12,-10652"/>
<polygon fill="black" stroke="black" points="8590.69,-10655.16 8598.91,-10648.46 8588.31,-10648.57 8590.69,-10655.16"/>
</g>
<!-- mha_layer2_gpu7 -->
<g id="node171" class="node">
<title>mha_layer2_gpu7</title>
<path fill="lightblue" stroke="black" d="M8476,-10294.3C8476,-10294.3 8028,-10294.3 8028,-10294.3 8022,-10294.3 8016,-10288.3 8016,-10282.3 8016,-10282.3 8016,-10253.3 8016,-10253.3 8016,-10247.3 8022,-10241.3 8028,-10241.3 8028,-10241.3 8476,-10241.3 8476,-10241.3 8482,-10241.3 8488,-10247.3 8488,-10253.3 8488,-10253.3 8488,-10282.3 8488,-10282.3 8488,-10288.3 8482,-10294.3 8476,-10294.3"/>
<text text-anchor="middle" x="8252" y="-10279.1" font-family="Times,serif" font-size="14.00">MHA Layer 2 GPU 7</text>
<text text-anchor="middle" x="8252" y="-10264.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8252" y="-10249.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer1_gpu7&#45;&gt;mha_layer2_gpu7 -->
<g id="edge200" class="edge">
<title>aggregate_layer1_gpu7&#45;&gt;mha_layer2_gpu7</title>
<path fill="none" stroke="black" d="M8276.88,-10330.2C8273.25,-10321.24 8269.56,-10312.12 8266.16,-10303.74"/>
<polygon fill="black" stroke="black" points="8269.34,-10302.27 8262.34,-10294.31 8262.85,-10304.9 8269.34,-10302.27"/>
</g>
<!-- route_layer1_gpu8&#45;&gt;comm_layer1 -->
<g id="edge153" class="edge">
<title>route_layer1_gpu8&#45;&gt;comm_layer1</title>
<path fill="none" stroke="black" d="M8972.38,-10687.19C8922.27,-10674.24 8869.83,-10660.7 8824.03,-10648.87"/>
<polygon fill="black" stroke="black" points="8824.62,-10645.41 8814.06,-10646.3 8822.87,-10652.19 8824.62,-10645.41"/>
</g>
<!-- mha_layer2_gpu8 -->
<g id="node172" class="node">
<title>mha_layer2_gpu8</title>
<path fill="lightblue" stroke="black" d="M9370,-10294.3C9370,-10294.3 8922,-10294.3 8922,-10294.3 8916,-10294.3 8910,-10288.3 8910,-10282.3 8910,-10282.3 8910,-10253.3 8910,-10253.3 8910,-10247.3 8916,-10241.3 8922,-10241.3 8922,-10241.3 9370,-10241.3 9370,-10241.3 9376,-10241.3 9382,-10247.3 9382,-10253.3 9382,-10253.3 9382,-10282.3 9382,-10282.3 9382,-10288.3 9376,-10294.3 9370,-10294.3"/>
<text text-anchor="middle" x="9146" y="-10279.1" font-family="Times,serif" font-size="14.00">MHA Layer 2 GPU 8</text>
<text text-anchor="middle" x="9146" y="-10264.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9146" y="-10249.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer1_gpu8&#45;&gt;mha_layer2_gpu8 -->
<g id="edge201" class="edge">
<title>aggregate_layer1_gpu8&#45;&gt;mha_layer2_gpu8</title>
<path fill="none" stroke="black" d="M9114.08,-10330.2C9118.84,-10321.04 9123.69,-10311.72 9128.12,-10303.2"/>
<polygon fill="black" stroke="black" points="9131.23,-10304.8 9132.74,-10294.31 9125.02,-10301.57 9131.23,-10304.8"/>
</g>
<!-- route_layer1_gpu9&#45;&gt;comm_layer1 -->
<g id="edge154" class="edge">
<title>route_layer1_gpu9&#45;&gt;comm_layer1</title>
<path fill="none" stroke="black" d="M9763.73,-10710.08C9683.78,-10702.54 9597.66,-10694.51 9518,-10687.25 9312.63,-10668.55 9078.46,-10648.09 8912.03,-10633.69"/>
<polygon fill="black" stroke="black" points="8911.93,-10630.17 8901.67,-10632.79 8911.33,-10637.14 8911.93,-10630.17"/>
</g>
<!-- mha_layer2_gpu9 -->
<g id="node173" class="node">
<title>mha_layer2_gpu9</title>
<path fill="lightblue" stroke="black" d="M10387,-10294.3C10387,-10294.3 9939,-10294.3 9939,-10294.3 9933,-10294.3 9927,-10288.3 9927,-10282.3 9927,-10282.3 9927,-10253.3 9927,-10253.3 9927,-10247.3 9933,-10241.3 9939,-10241.3 9939,-10241.3 10387,-10241.3 10387,-10241.3 10393,-10241.3 10399,-10247.3 10399,-10253.3 10399,-10253.3 10399,-10282.3 10399,-10282.3 10399,-10288.3 10393,-10294.3 10387,-10294.3"/>
<text text-anchor="middle" x="10163" y="-10279.1" font-family="Times,serif" font-size="14.00">MHA Layer 2 GPU 9</text>
<text text-anchor="middle" x="10163" y="-10264.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10163" y="-10249.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer1_gpu9&#45;&gt;mha_layer2_gpu9 -->
<g id="edge202" class="edge">
<title>aggregate_layer1_gpu9&#45;&gt;mha_layer2_gpu9</title>
<path fill="none" stroke="black" d="M10037.49,-10330.2C10059.5,-10319.43 10081.97,-10308.44 10101.69,-10298.79"/>
<polygon fill="black" stroke="black" points="10103.4,-10301.85 10110.85,-10294.31 10100.33,-10295.56 10103.4,-10301.85"/>
</g>
<!-- route_layer1_gpu10&#45;&gt;comm_layer1 -->
<g id="edge155" class="edge">
<title>route_layer1_gpu10&#45;&gt;comm_layer1</title>
<path fill="none" stroke="black" d="M10691.56,-10709.31C10601.85,-10701.27 10503.55,-10693.18 10413,-10687.25 9889.68,-10652.99 9275.71,-10631.66 8940.88,-10621.62"/>
<polygon fill="black" stroke="black" points="8940.67,-10618.11 8930.57,-10621.31 8940.46,-10625.11 8940.67,-10618.11"/>
</g>
<!-- mha_layer2_gpu10 -->
<g id="node174" class="node">
<title>mha_layer2_gpu10</title>
<path fill="lightblue" stroke="black" d="M11133,-10294.3C11133,-10294.3 10685,-10294.3 10685,-10294.3 10679,-10294.3 10673,-10288.3 10673,-10282.3 10673,-10282.3 10673,-10253.3 10673,-10253.3 10673,-10247.3 10679,-10241.3 10685,-10241.3 10685,-10241.3 11133,-10241.3 11133,-10241.3 11139,-10241.3 11145,-10247.3 11145,-10253.3 11145,-10253.3 11145,-10282.3 11145,-10282.3 11145,-10288.3 11139,-10294.3 11133,-10294.3"/>
<text text-anchor="middle" x="10909" y="-10279.1" font-family="Times,serif" font-size="14.00">MHA Layer 2 GPU 10</text>
<text text-anchor="middle" x="10909" y="-10264.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10909" y="-10249.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer1_gpu10&#45;&gt;mha_layer2_gpu10 -->
<g id="edge203" class="edge">
<title>aggregate_layer1_gpu10&#45;&gt;mha_layer2_gpu10</title>
<path fill="none" stroke="black" d="M10787.28,-10330.2C10808.53,-10319.48 10830.21,-10308.54 10849.28,-10298.92"/>
<polygon fill="black" stroke="black" points="10851.07,-10301.94 10858.42,-10294.31 10847.92,-10295.69 10851.07,-10301.94"/>
</g>
<!-- route_layer1_gpu11&#45;&gt;comm_layer1 -->
<g id="edge156" class="edge">
<title>route_layer1_gpu11&#45;&gt;comm_layer1</title>
<path fill="none" stroke="black" d="M11638.49,-10709.32C11543.54,-10700.99 11438.51,-10692.73 11342,-10687.25 10462.29,-10637.34 9416.29,-10621.55 8944.71,-10616.76"/>
<polygon fill="black" stroke="black" points="8944.75,-10613.26 8934.71,-10616.65 8944.68,-10620.26 8944.75,-10613.26"/>
</g>
<!-- mha_layer2_gpu11 -->
<g id="node175" class="node">
<title>mha_layer2_gpu11</title>
<path fill="lightblue" stroke="black" d="M11751,-10294.3C11751,-10294.3 11303,-10294.3 11303,-10294.3 11297,-10294.3 11291,-10288.3 11291,-10282.3 11291,-10282.3 11291,-10253.3 11291,-10253.3 11291,-10247.3 11297,-10241.3 11303,-10241.3 11303,-10241.3 11751,-10241.3 11751,-10241.3 11757,-10241.3 11763,-10247.3 11763,-10253.3 11763,-10253.3 11763,-10282.3 11763,-10282.3 11763,-10288.3 11757,-10294.3 11751,-10294.3"/>
<text text-anchor="middle" x="11527" y="-10279.1" font-family="Times,serif" font-size="14.00">MHA Layer 2 GPU 11</text>
<text text-anchor="middle" x="11527" y="-10264.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11527" y="-10249.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer1_gpu11&#45;&gt;mha_layer2_gpu11 -->
<g id="edge204" class="edge">
<title>aggregate_layer1_gpu11&#45;&gt;mha_layer2_gpu11</title>
<path fill="none" stroke="black" d="M11453.43,-10330.2C11465.45,-10320.17 11477.71,-10309.93 11488.69,-10300.78"/>
<polygon fill="black" stroke="black" points="11490.99,-10303.41 11496.43,-10294.31 11486.51,-10298.03 11490.99,-10303.41"/>
</g>
<!-- route_layer1_gpu12&#45;&gt;comm_layer1 -->
<g id="edge157" class="edge">
<title>route_layer1_gpu12&#45;&gt;comm_layer1</title>
<path fill="none" stroke="black" d="M12593.35,-10709.24C12496.12,-10700.78 12388.14,-10692.46 12289,-10687.25 11035.64,-10621.36 9533.73,-10614.26 8945.66,-10614.25"/>
<polygon fill="black" stroke="black" points="8945.36,-10610.75 8935.36,-10614.25 8945.36,-10617.75 8945.36,-10610.75"/>
</g>
<!-- mha_layer2_gpu12 -->
<g id="node176" class="node">
<title>mha_layer2_gpu12</title>
<path fill="lightblue" stroke="black" d="M12305,-10294.3C12305,-10294.3 11857,-10294.3 11857,-10294.3 11851,-10294.3 11845,-10288.3 11845,-10282.3 11845,-10282.3 11845,-10253.3 11845,-10253.3 11845,-10247.3 11851,-10241.3 11857,-10241.3 11857,-10241.3 12305,-10241.3 12305,-10241.3 12311,-10241.3 12317,-10247.3 12317,-10253.3 12317,-10253.3 12317,-10282.3 12317,-10282.3 12317,-10288.3 12311,-10294.3 12305,-10294.3"/>
<text text-anchor="middle" x="12081" y="-10279.1" font-family="Times,serif" font-size="14.00">MHA Layer 2 GPU 12</text>
<text text-anchor="middle" x="12081" y="-10264.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12081" y="-10249.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer1_gpu12&#45;&gt;mha_layer2_gpu12 -->
<g id="edge205" class="edge">
<title>aggregate_layer1_gpu12&#45;&gt;mha_layer2_gpu12</title>
<path fill="none" stroke="black" d="M12077.75,-10330.2C12078.21,-10321.53 12078.68,-10312.71 12079.11,-10304.57"/>
<polygon fill="black" stroke="black" points="12082.62,-10304.48 12079.65,-10294.31 12075.63,-10304.11 12082.62,-10304.48"/>
</g>
<!-- route_layer1_gpu13&#45;&gt;comm_layer1 -->
<g id="edge158" class="edge">
<title>route_layer1_gpu13&#45;&gt;comm_layer1</title>
<path fill="none" stroke="black" d="M13553.61,-10709.24C13454.87,-10700.68 13344.89,-10692.31 13244,-10687.25 12397.33,-10644.83 9773.43,-10622.61 8945.2,-10616.53"/>
<polygon fill="black" stroke="black" points="8944.96,-10613.03 8934.94,-10616.45 8944.91,-10620.03 8944.96,-10613.03"/>
</g>
<!-- mha_layer2_gpu13 -->
<g id="node177" class="node">
<title>mha_layer2_gpu13</title>
<path fill="lightblue" stroke="black" d="M14102,-10294.3C14102,-10294.3 13654,-10294.3 13654,-10294.3 13648,-10294.3 13642,-10288.3 13642,-10282.3 13642,-10282.3 13642,-10253.3 13642,-10253.3 13642,-10247.3 13648,-10241.3 13654,-10241.3 13654,-10241.3 14102,-10241.3 14102,-10241.3 14108,-10241.3 14114,-10247.3 14114,-10253.3 14114,-10253.3 14114,-10282.3 14114,-10282.3 14114,-10288.3 14108,-10294.3 14102,-10294.3"/>
<text text-anchor="middle" x="13878" y="-10279.1" font-family="Times,serif" font-size="14.00">MHA Layer 2 GPU 13</text>
<text text-anchor="middle" x="13878" y="-10264.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13878" y="-10249.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer1_gpu13&#45;&gt;mha_layer2_gpu13 -->
<g id="edge206" class="edge">
<title>aggregate_layer1_gpu13&#45;&gt;mha_layer2_gpu13</title>
<path fill="none" stroke="black" d="M13544.5,-10339.55C13612.54,-10325.12 13686.66,-10309.39 13747.7,-10296.44"/>
<polygon fill="black" stroke="black" points="13748.72,-10299.8 13757.77,-10294.31 13747.27,-10292.96 13748.72,-10299.8"/>
</g>
<!-- route_layer1_gpu14&#45;&gt;comm_layer1 -->
<g id="edge159" class="edge">
<title>route_layer1_gpu14&#45;&gt;comm_layer1</title>
<path fill="none" stroke="black" d="M14515.41,-10709.14C14416.15,-10700.55 14305.49,-10692.18 14204,-10687.25 13159.78,-10636.52 9883.27,-10619.59 8945.23,-10615.72"/>
<polygon fill="black" stroke="black" points="8944.99,-10612.22 8934.98,-10615.68 8944.96,-10619.22 8944.99,-10612.22"/>
</g>
<!-- mha_layer2_gpu14 -->
<g id="node178" class="node">
<title>mha_layer2_gpu14</title>
<path fill="lightblue" stroke="black" d="M14677,-10294.3C14677,-10294.3 14229,-10294.3 14229,-10294.3 14223,-10294.3 14217,-10288.3 14217,-10282.3 14217,-10282.3 14217,-10253.3 14217,-10253.3 14217,-10247.3 14223,-10241.3 14229,-10241.3 14229,-10241.3 14677,-10241.3 14677,-10241.3 14683,-10241.3 14689,-10247.3 14689,-10253.3 14689,-10253.3 14689,-10282.3 14689,-10282.3 14689,-10288.3 14683,-10294.3 14677,-10294.3"/>
<text text-anchor="middle" x="14453" y="-10279.1" font-family="Times,serif" font-size="14.00">MHA Layer 2 GPU 14</text>
<text text-anchor="middle" x="14453" y="-10264.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14453" y="-10249.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer1_gpu14&#45;&gt;mha_layer2_gpu14 -->
<g id="edge207" class="edge">
<title>aggregate_layer1_gpu14&#45;&gt;mha_layer2_gpu14</title>
<path fill="none" stroke="black" d="M14374.02,-10330.2C14387.05,-10320.07 14400.34,-10309.74 14412.21,-10300.51"/>
<polygon fill="black" stroke="black" points="14414.43,-10303.21 14420.18,-10294.31 14410.14,-10297.69 14414.43,-10303.21"/>
</g>
<!-- route_layer1_gpu15&#45;&gt;comm_layer1 -->
<g id="edge160" class="edge">
<title>route_layer1_gpu15&#45;&gt;comm_layer1</title>
<path fill="none" stroke="black" d="M15478.31,-10709.06C15378.79,-10700.44 15267.8,-10692.09 15166,-10687.25 13922.62,-10628.15 9984.7,-10617.06 8945.49,-10615.15"/>
<polygon fill="black" stroke="black" points="8945.28,-10611.65 8935.27,-10615.13 8945.27,-10618.65 8945.28,-10611.65"/>
</g>
<!-- mha_layer2_gpu15 -->
<g id="node179" class="node">
<title>mha_layer2_gpu15</title>
<path fill="lightblue" stroke="black" d="M15933,-10294.3C15933,-10294.3 15485,-10294.3 15485,-10294.3 15479,-10294.3 15473,-10288.3 15473,-10282.3 15473,-10282.3 15473,-10253.3 15473,-10253.3 15473,-10247.3 15479,-10241.3 15485,-10241.3 15485,-10241.3 15933,-10241.3 15933,-10241.3 15939,-10241.3 15945,-10247.3 15945,-10253.3 15945,-10253.3 15945,-10282.3 15945,-10282.3 15945,-10288.3 15939,-10294.3 15933,-10294.3"/>
<text text-anchor="middle" x="15709" y="-10279.1" font-family="Times,serif" font-size="14.00">MHA Layer 2 GPU 15</text>
<text text-anchor="middle" x="15709" y="-10264.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="15709" y="-10249.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer1_gpu15&#45;&gt;mha_layer2_gpu15 -->
<g id="edge208" class="edge">
<title>aggregate_layer1_gpu15&#45;&gt;mha_layer2_gpu15</title>
<path fill="none" stroke="black" d="M15577.54,-10330.2C15600.7,-10319.39 15624.34,-10308.34 15645.07,-10298.66"/>
<polygon fill="black" stroke="black" points="15646.8,-10301.72 15654.38,-10294.31 15643.83,-10295.37 15646.8,-10301.72"/>
</g>
<!-- comm_layer1&#45;&gt;expert_layer1_gpu0_expert0 -->
<g id="edge161" class="edge">
<title>comm_layer1&#45;&gt;expert_layer1_gpu0_expert0</title>
<path fill="none" stroke="black" d="M8449.39,-10611.03C7531.36,-10604.21 4269.98,-10577.81 3232,-10540.3 3133.12,-10536.73 3024.51,-10530.78 2929.54,-10524.91"/>
<polygon fill="black" stroke="black" points="2929.71,-10521.41 2919.51,-10524.29 2929.27,-10528.4 2929.71,-10521.41"/>
</g>
<!-- comm_layer1&#45;&gt;expert_layer1_gpu1_expert1 -->
<g id="edge162" class="edge">
<title>comm_layer1&#45;&gt;expert_layer1_gpu1_expert1</title>
<path fill="none" stroke="black" d="M8448.96,-10612.19C7764.57,-10609.84 5762.79,-10598.13 4101,-10540.3 3984.03,-10536.23 3854.6,-10529.58 3744.94,-10523.31"/>
<polygon fill="black" stroke="black" points="3744.91,-10519.8 3734.72,-10522.72 3744.51,-10526.79 3744.91,-10519.8"/>
</g>
<!-- comm_layer1&#45;&gt;expert_layer1_gpu2_expert2 -->
<g id="edge163" class="edge">
<title>comm_layer1&#45;&gt;expert_layer1_gpu2_expert2</title>
<path fill="none" stroke="black" d="M8449.02,-10611.83C7845.47,-10608.67 6229.49,-10595.32 4883,-10540.3 4795.28,-10536.72 4699.42,-10531.18 4613.85,-10525.66"/>
<polygon fill="black" stroke="black" points="4613.94,-10522.16 4603.74,-10525.01 4613.49,-10529.15 4613.94,-10522.16"/>
</g>
<!-- comm_layer1&#45;&gt;expert_layer1_gpu3_expert3 -->
<g id="edge164" class="edge">
<title>comm_layer1&#45;&gt;expert_layer1_gpu3_expert3</title>
<path fill="none" stroke="black" d="M8452.45,-10607.07C7985.44,-10595.78 6920.52,-10569.14 6025,-10540.3 5813.15,-10533.48 5572.86,-10524.45 5396.02,-10517.56"/>
<polygon fill="black" stroke="black" points="5395.92,-10514.05 5385.79,-10517.16 5395.65,-10521.04 5395.92,-10514.05"/>
</g>
<!-- comm_layer1&#45;&gt;expert_layer1_gpu4_expert4 -->
<g id="edge165" class="edge">
<title>comm_layer1&#45;&gt;expert_layer1_gpu4_expert4</title>
<path fill="none" stroke="black" d="M8455.58,-10604.85C8105.28,-10592.8 7427.77,-10568.27 6852,-10540.3 6749.16,-10535.3 6635.95,-10528.94 6537.65,-10523.14"/>
<polygon fill="black" stroke="black" points="6537.76,-10519.64 6527.57,-10522.54 6537.35,-10526.63 6537.76,-10519.64"/>
</g>
<!-- comm_layer1&#45;&gt;expert_layer1_gpu5_expert5 -->
<g id="edge166" class="edge">
<title>comm_layer1&#45;&gt;expert_layer1_gpu5_expert5</title>
<path fill="none" stroke="black" d="M8465.79,-10599.98C8229.88,-10586.35 7849.39,-10563.58 7521,-10540.3 7470.45,-10536.72 7416.43,-10532.6 7364.7,-10528.53"/>
<polygon fill="black" stroke="black" points="7364.97,-10525.04 7354.72,-10527.74 7364.42,-10532.02 7364.97,-10525.04"/>
</g>
<!-- comm_layer1&#45;&gt;expert_layer1_gpu6_expert6 -->
<g id="edge167" class="edge">
<title>comm_layer1&#45;&gt;expert_layer1_gpu6_expert6</title>
<path fill="none" stroke="black" d="M8500.19,-10590.67C8364.82,-10575.06 8181.96,-10553.98 8033.99,-10536.92"/>
<polygon fill="black" stroke="black" points="8034.18,-10533.42 8023.85,-10535.76 8033.38,-10540.38 8034.18,-10533.42"/>
</g>
<!-- comm_layer1&#45;&gt;expert_layer1_gpu7_expert7 -->
<g id="edge168" class="edge">
<title>comm_layer1&#45;&gt;expert_layer1_gpu7_expert7</title>
<path fill="none" stroke="black" d="M8590.06,-10579.69C8554.6,-10568.18 8514.65,-10555.22 8478.46,-10543.47"/>
<polygon fill="black" stroke="black" points="8479.45,-10540.11 8468.86,-10540.36 8477.29,-10546.77 8479.45,-10540.11"/>
</g>
<!-- comm_layer1&#45;&gt;expert_layer1_gpu8_expert8 -->
<g id="edge169" class="edge">
<title>comm_layer1&#45;&gt;expert_layer1_gpu8_expert8</title>
<path fill="none" stroke="black" d="M8793.94,-10579.69C8829.4,-10568.18 8869.35,-10555.22 8905.54,-10543.47"/>
<polygon fill="black" stroke="black" points="8906.71,-10546.77 8915.14,-10540.36 8904.55,-10540.11 8906.71,-10546.77"/>
</g>
<!-- comm_layer1&#45;&gt;expert_layer1_gpu9_expert9 -->
<g id="edge170" class="edge">
<title>comm_layer1&#45;&gt;expert_layer1_gpu9_expert9</title>
<path fill="none" stroke="black" d="M8894.26,-10592.88C9068.02,-10575.78 9319.5,-10551.04 9507.4,-10532.55"/>
<polygon fill="black" stroke="black" points="9507.81,-10536.02 9517.42,-10531.56 9507.13,-10529.06 9507.81,-10536.02"/>
</g>
<!-- comm_layer1&#45;&gt;expert_layer1_gpu10_expert10 -->
<g id="edge171" class="edge">
<title>comm_layer1&#45;&gt;expert_layer1_gpu10_expert10</title>
<path fill="none" stroke="black" d="M8921,-10601.11C9185.53,-10587.43 9633.82,-10563.66 10019,-10540.3 10096.34,-10535.61 10180.45,-10530.14 10257.02,-10525.02"/>
<polygon fill="black" stroke="black" points="10257.55,-10528.49 10267.29,-10524.33 10257.08,-10521.51 10257.55,-10528.49"/>
</g>
<!-- comm_layer1&#45;&gt;expert_layer1_gpu11_expert11 -->
<g id="edge172" class="edge">
<title>comm_layer1&#45;&gt;expert_layer1_gpu11_expert11</title>
<path fill="none" stroke="black" d="M8931.59,-10607.12C9318.3,-10597.39 10103.99,-10575.09 10769,-10540.3 10839.12,-10536.63 10915.04,-10531.74 10985.09,-10526.86"/>
<polygon fill="black" stroke="black" points="10985.65,-10530.33 10995.38,-10526.14 10985.16,-10523.34 10985.65,-10530.33"/>
</g>
<!-- comm_layer1&#45;&gt;expert_layer1_gpu12_expert12 -->
<g id="edge173" class="edge">
<title>comm_layer1&#45;&gt;expert_layer1_gpu12_expert12</title>
<path fill="none" stroke="black" d="M8934.62,-10610.36C9420.97,-10604.67 10549.75,-10587.17 11497,-10540.3 11559.99,-10537.18 11627.85,-10532.77 11691.33,-10528.19"/>
<polygon fill="black" stroke="black" points="11691.76,-10531.67 11701.48,-10527.45 11691.25,-10524.69 11691.76,-10531.67"/>
</g>
<!-- comm_layer1&#45;&gt;expert_layer1_gpu13_expert13 -->
<g id="edge174" class="edge">
<title>comm_layer1&#45;&gt;expert_layer1_gpu13_expert13</title>
<path fill="none" stroke="black" d="M8933.89,-10609.82C9503.63,-10602.4 10974.59,-10580.66 12203,-10540.3 12360.84,-10535.11 12537.74,-10527.2 12678.09,-10520.42"/>
<polygon fill="black" stroke="black" points="12678.31,-10523.91 12688.13,-10519.93 12677.98,-10516.92 12678.31,-10523.91"/>
</g>
<!-- comm_layer1&#45;&gt;expert_layer1_gpu14_expert14 -->
<g id="edge175" class="edge">
<title>comm_layer1&#45;&gt;expert_layer1_gpu14_expert14</title>
<path fill="none" stroke="black" d="M8934.93,-10611.39C9609.96,-10607 11565.56,-10590.55 13190,-10540.3 13343.96,-10535.54 13516.3,-10527.74 13653.87,-10520.92"/>
<polygon fill="black" stroke="black" points="13654.32,-10524.4 13664.14,-10520.41 13653.97,-10517.41 13654.32,-10524.4"/>
</g>
<!-- comm_layer1&#45;&gt;expert_layer1_gpu15_expert15 -->
<g id="edge176" class="edge">
<title>comm_layer1&#45;&gt;expert_layer1_gpu15_expert15</title>
<path fill="none" stroke="black" d="M8935.19,-10611.93C9703.11,-10608.75 12144.99,-10594.74 14166,-10540.3 14351.62,-10535.3 14561,-10526.72 14720.65,-10519.56"/>
<polygon fill="black" stroke="black" points="14721.26,-10523.04 14731.09,-10519.09 14720.94,-10516.04 14721.26,-10523.04"/>
</g>
<!-- gate_layer2_gpu0 -->
<g id="node180" class="node">
<title>gate_layer2_gpu0</title>
<path fill="lightsteelblue" stroke="black" d="M1481.07,-10203.96C1481.07,-10203.96 1031.93,-10153.64 1031.93,-10153.64 1025.96,-10152.97 1025.96,-10151.63 1031.93,-10150.96 1031.93,-10150.96 1481.07,-10100.64 1481.07,-10100.64 1487.04,-10099.97 1498.96,-10099.97 1504.93,-10100.64 1504.93,-10100.64 1954.07,-10150.96 1954.07,-10150.96 1960.04,-10151.63 1960.04,-10152.97 1954.07,-10153.64 1954.07,-10153.64 1504.93,-10203.96 1504.93,-10203.96 1498.96,-10204.63 1487.04,-10204.63 1481.07,-10203.96"/>
<text text-anchor="middle" x="1493" y="-10163.6" font-family="Times,serif" font-size="14.00">Gate Layer 2 GPU 0</text>
<text text-anchor="middle" x="1493" y="-10148.6" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="1493" y="-10133.6" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer2_gpu0&#45;&gt;gate_layer2_gpu0 -->
<g id="edge209" class="edge">
<title>mha_layer2_gpu0&#45;&gt;gate_layer2_gpu0</title>
<path fill="none" stroke="black" d="M1698.97,-10241.19C1669.49,-10228.61 1633.08,-10213.07 1599.11,-10198.58"/>
<polygon fill="black" stroke="black" points="1600.17,-10195.22 1589.6,-10194.52 1597.42,-10201.66 1600.17,-10195.22"/>
</g>
<!-- gate_layer2_gpu1 -->
<g id="node181" class="node">
<title>gate_layer2_gpu1</title>
<path fill="lightsteelblue" stroke="black" d="M2445.07,-10203.96C2445.07,-10203.96 1995.93,-10153.64 1995.93,-10153.64 1989.96,-10152.97 1989.96,-10151.63 1995.93,-10150.96 1995.93,-10150.96 2445.07,-10100.64 2445.07,-10100.64 2451.04,-10099.97 2462.96,-10099.97 2468.93,-10100.64 2468.93,-10100.64 2918.07,-10150.96 2918.07,-10150.96 2924.04,-10151.63 2924.04,-10152.97 2918.07,-10153.64 2918.07,-10153.64 2468.93,-10203.96 2468.93,-10203.96 2462.96,-10204.63 2451.04,-10204.63 2445.07,-10203.96"/>
<text text-anchor="middle" x="2457" y="-10163.6" font-family="Times,serif" font-size="14.00">Gate Layer 2 GPU 1</text>
<text text-anchor="middle" x="2457" y="-10148.6" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="2457" y="-10133.6" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer2_gpu1&#45;&gt;gate_layer2_gpu1 -->
<g id="edge210" class="edge">
<title>mha_layer2_gpu1&#45;&gt;gate_layer2_gpu1</title>
<path fill="none" stroke="black" d="M2479.42,-10241.04C2477.34,-10232.89 2474.94,-10223.5 2472.5,-10213.97"/>
<polygon fill="black" stroke="black" points="2475.83,-10212.84 2469.96,-10204.02 2469.04,-10214.58 2475.83,-10212.84"/>
</g>
<!-- gate_layer2_gpu2 -->
<g id="node182" class="node">
<title>gate_layer2_gpu2</title>
<path fill="lightsteelblue" stroke="black" d="M3409.07,-10203.96C3409.07,-10203.96 2959.93,-10153.64 2959.93,-10153.64 2953.96,-10152.97 2953.96,-10151.63 2959.93,-10150.96 2959.93,-10150.96 3409.07,-10100.64 3409.07,-10100.64 3415.04,-10099.97 3426.96,-10099.97 3432.93,-10100.64 3432.93,-10100.64 3882.07,-10150.96 3882.07,-10150.96 3888.04,-10151.63 3888.04,-10152.97 3882.07,-10153.64 3882.07,-10153.64 3432.93,-10203.96 3432.93,-10203.96 3426.96,-10204.63 3415.04,-10204.63 3409.07,-10203.96"/>
<text text-anchor="middle" x="3421" y="-10163.6" font-family="Times,serif" font-size="14.00">Gate Layer 2 GPU 2</text>
<text text-anchor="middle" x="3421" y="-10148.6" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="3421" y="-10133.6" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer2_gpu2&#45;&gt;gate_layer2_gpu2 -->
<g id="edge211" class="edge">
<title>mha_layer2_gpu2&#45;&gt;gate_layer2_gpu2</title>
<path fill="none" stroke="black" d="M3679.63,-10241.19C3640.11,-10227.76 3590.68,-10210.96 3545.65,-10195.66"/>
<polygon fill="black" stroke="black" points="3546.7,-10192.32 3536.11,-10192.42 3544.45,-10198.95 3546.7,-10192.32"/>
</g>
<!-- gate_layer2_gpu3 -->
<g id="node183" class="node">
<title>gate_layer2_gpu3</title>
<path fill="lightsteelblue" stroke="black" d="M4373.07,-10203.96C4373.07,-10203.96 3923.93,-10153.64 3923.93,-10153.64 3917.96,-10152.97 3917.96,-10151.63 3923.93,-10150.96 3923.93,-10150.96 4373.07,-10100.64 4373.07,-10100.64 4379.04,-10099.97 4390.96,-10099.97 4396.93,-10100.64 4396.93,-10100.64 4846.07,-10150.96 4846.07,-10150.96 4852.04,-10151.63 4852.04,-10152.97 4846.07,-10153.64 4846.07,-10153.64 4396.93,-10203.96 4396.93,-10203.96 4390.96,-10204.63 4379.04,-10204.63 4373.07,-10203.96"/>
<text text-anchor="middle" x="4385" y="-10163.6" font-family="Times,serif" font-size="14.00">Gate Layer 2 GPU 3</text>
<text text-anchor="middle" x="4385" y="-10148.6" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4385" y="-10133.6" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer2_gpu3&#45;&gt;gate_layer2_gpu3 -->
<g id="edge212" class="edge">
<title>mha_layer2_gpu3&#45;&gt;gate_layer2_gpu3</title>
<path fill="none" stroke="black" d="M4641.3,-10241.19C4602.31,-10227.82 4553.58,-10211.11 4509.11,-10195.86"/>
<polygon fill="black" stroke="black" points="4509.99,-10192.46 4499.4,-10192.53 4507.72,-10199.08 4509.99,-10192.46"/>
</g>
<!-- gate_layer2_gpu4 -->
<g id="node184" class="node">
<title>gate_layer2_gpu4</title>
<path fill="lightsteelblue" stroke="black" d="M5337.07,-10203.96C5337.07,-10203.96 4887.93,-10153.64 4887.93,-10153.64 4881.96,-10152.97 4881.96,-10151.63 4887.93,-10150.96 4887.93,-10150.96 5337.07,-10100.64 5337.07,-10100.64 5343.04,-10099.97 5354.96,-10099.97 5360.93,-10100.64 5360.93,-10100.64 5810.07,-10150.96 5810.07,-10150.96 5816.04,-10151.63 5816.04,-10152.97 5810.07,-10153.64 5810.07,-10153.64 5360.93,-10203.96 5360.93,-10203.96 5354.96,-10204.63 5343.04,-10204.63 5337.07,-10203.96"/>
<text text-anchor="middle" x="5349" y="-10163.6" font-family="Times,serif" font-size="14.00">Gate Layer 2 GPU 4</text>
<text text-anchor="middle" x="5349" y="-10148.6" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5349" y="-10133.6" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer2_gpu4&#45;&gt;gate_layer2_gpu4 -->
<g id="edge213" class="edge">
<title>mha_layer2_gpu4&#45;&gt;gate_layer2_gpu4</title>
<path fill="none" stroke="black" d="M5577.43,-10241.19C5543.82,-10228.26 5502.1,-10212.21 5463.55,-10197.37"/>
<polygon fill="black" stroke="black" points="5464.41,-10193.95 5453.82,-10193.63 5461.9,-10200.49 5464.41,-10193.95"/>
</g>
<!-- gate_layer2_gpu5 -->
<g id="node185" class="node">
<title>gate_layer2_gpu5</title>
<path fill="lightsteelblue" stroke="black" d="M6301.07,-10203.96C6301.07,-10203.96 5851.93,-10153.64 5851.93,-10153.64 5845.96,-10152.97 5845.96,-10151.63 5851.93,-10150.96 5851.93,-10150.96 6301.07,-10100.64 6301.07,-10100.64 6307.04,-10099.97 6318.96,-10099.97 6324.93,-10100.64 6324.93,-10100.64 6774.07,-10150.96 6774.07,-10150.96 6780.04,-10151.63 6780.04,-10152.97 6774.07,-10153.64 6774.07,-10153.64 6324.93,-10203.96 6324.93,-10203.96 6318.96,-10204.63 6307.04,-10204.63 6301.07,-10203.96"/>
<text text-anchor="middle" x="6313" y="-10163.6" font-family="Times,serif" font-size="14.00">Gate Layer 2 GPU 5</text>
<text text-anchor="middle" x="6313" y="-10148.6" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6313" y="-10133.6" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer2_gpu5&#45;&gt;gate_layer2_gpu5 -->
<g id="edge214" class="edge">
<title>mha_layer2_gpu5&#45;&gt;gate_layer2_gpu5</title>
<path fill="none" stroke="black" d="M6343.15,-10241.04C6340.28,-10232.71 6336.98,-10223.08 6333.62,-10213.32"/>
<polygon fill="black" stroke="black" points="6336.83,-10211.89 6330.27,-10203.57 6330.21,-10214.16 6336.83,-10211.89"/>
</g>
<!-- gate_layer2_gpu6 -->
<g id="node186" class="node">
<title>gate_layer2_gpu6</title>
<path fill="lightsteelblue" stroke="black" d="M7265.07,-10203.96C7265.07,-10203.96 6815.93,-10153.64 6815.93,-10153.64 6809.96,-10152.97 6809.96,-10151.63 6815.93,-10150.96 6815.93,-10150.96 7265.07,-10100.64 7265.07,-10100.64 7271.04,-10099.97 7282.96,-10099.97 7288.93,-10100.64 7288.93,-10100.64 7738.07,-10150.96 7738.07,-10150.96 7744.04,-10151.63 7744.04,-10152.97 7738.07,-10153.64 7738.07,-10153.64 7288.93,-10203.96 7288.93,-10203.96 7282.96,-10204.63 7271.04,-10204.63 7265.07,-10203.96"/>
<text text-anchor="middle" x="7277" y="-10163.6" font-family="Times,serif" font-size="14.00">Gate Layer 2 GPU 6</text>
<text text-anchor="middle" x="7277" y="-10148.6" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="7277" y="-10133.6" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer2_gpu6&#45;&gt;gate_layer2_gpu6 -->
<g id="edge215" class="edge">
<title>mha_layer2_gpu6&#45;&gt;gate_layer2_gpu6</title>
<path fill="none" stroke="black" d="M7344.26,-10241.04C7337,-10231.57 7328.46,-10220.44 7319.95,-10209.34"/>
<polygon fill="black" stroke="black" points="7322.64,-10207.09 7313.78,-10201.28 7317.09,-10211.35 7322.64,-10207.09"/>
</g>
<!-- gate_layer2_gpu7 -->
<g id="node187" class="node">
<title>gate_layer2_gpu7</title>
<path fill="lightsteelblue" stroke="black" d="M8229.07,-10203.96C8229.07,-10203.96 7779.93,-10153.64 7779.93,-10153.64 7773.96,-10152.97 7773.96,-10151.63 7779.93,-10150.96 7779.93,-10150.96 8229.07,-10100.64 8229.07,-10100.64 8235.04,-10099.97 8246.96,-10099.97 8252.93,-10100.64 8252.93,-10100.64 8702.07,-10150.96 8702.07,-10150.96 8708.04,-10151.63 8708.04,-10152.97 8702.07,-10153.64 8702.07,-10153.64 8252.93,-10203.96 8252.93,-10203.96 8246.96,-10204.63 8235.04,-10204.63 8229.07,-10203.96"/>
<text text-anchor="middle" x="8241" y="-10163.6" font-family="Times,serif" font-size="14.00">Gate Layer 2 GPU 7</text>
<text text-anchor="middle" x="8241" y="-10148.6" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="8241" y="-10133.6" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer2_gpu7&#45;&gt;gate_layer2_gpu7 -->
<g id="edge216" class="edge">
<title>mha_layer2_gpu7&#45;&gt;gate_layer2_gpu7</title>
<path fill="none" stroke="black" d="M8249.5,-10241.04C8248.74,-10233.17 8247.87,-10224.14 8246.97,-10214.94"/>
<polygon fill="black" stroke="black" points="8250.45,-10214.55 8246,-10204.94 8243.49,-10215.23 8250.45,-10214.55"/>
</g>
<!-- gate_layer2_gpu8 -->
<g id="node188" class="node">
<title>gate_layer2_gpu8</title>
<path fill="lightsteelblue" stroke="black" d="M9193.07,-10203.96C9193.07,-10203.96 8743.93,-10153.64 8743.93,-10153.64 8737.96,-10152.97 8737.96,-10151.63 8743.93,-10150.96 8743.93,-10150.96 9193.07,-10100.64 9193.07,-10100.64 9199.04,-10099.97 9210.96,-10099.97 9216.93,-10100.64 9216.93,-10100.64 9666.07,-10150.96 9666.07,-10150.96 9672.04,-10151.63 9672.04,-10152.97 9666.07,-10153.64 9666.07,-10153.64 9216.93,-10203.96 9216.93,-10203.96 9210.96,-10204.63 9199.04,-10204.63 9193.07,-10203.96"/>
<text text-anchor="middle" x="9205" y="-10163.6" font-family="Times,serif" font-size="14.00">Gate Layer 2 GPU 8</text>
<text text-anchor="middle" x="9205" y="-10148.6" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="9205" y="-10133.6" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer2_gpu8&#45;&gt;gate_layer2_gpu8 -->
<g id="edge217" class="edge">
<title>mha_layer2_gpu8&#45;&gt;gate_layer2_gpu8</title>
<path fill="none" stroke="black" d="M9159.39,-10241.04C9163.96,-10232.24 9169.29,-10222.01 9174.64,-10211.7"/>
<polygon fill="black" stroke="black" points="9177.84,-10213.14 9179.35,-10202.65 9171.63,-10209.91 9177.84,-10213.14"/>
</g>
<!-- gate_layer2_gpu9 -->
<g id="node189" class="node">
<title>gate_layer2_gpu9</title>
<path fill="lightsteelblue" stroke="black" d="M10157.07,-10203.96C10157.07,-10203.96 9707.93,-10153.64 9707.93,-10153.64 9701.96,-10152.97 9701.96,-10151.63 9707.93,-10150.96 9707.93,-10150.96 10157.07,-10100.64 10157.07,-10100.64 10163.04,-10099.97 10174.96,-10099.97 10180.93,-10100.64 10180.93,-10100.64 10630.07,-10150.96 10630.07,-10150.96 10636.04,-10151.63 10636.04,-10152.97 10630.07,-10153.64 10630.07,-10153.64 10180.93,-10203.96 10180.93,-10203.96 10174.96,-10204.63 10163.04,-10204.63 10157.07,-10203.96"/>
<text text-anchor="middle" x="10169" y="-10163.6" font-family="Times,serif" font-size="14.00">Gate Layer 2 GPU 9</text>
<text text-anchor="middle" x="10169" y="-10148.6" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="10169" y="-10133.6" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer2_gpu9&#45;&gt;gate_layer2_gpu9 -->
<g id="edge218" class="edge">
<title>mha_layer2_gpu9&#45;&gt;gate_layer2_gpu9</title>
<path fill="none" stroke="black" d="M10164.36,-10241.04C10164.77,-10233.35 10165.23,-10224.55 10165.71,-10215.57"/>
<polygon fill="black" stroke="black" points="10169.21,-10215.57 10166.25,-10205.4 10162.22,-10215.2 10169.21,-10215.57"/>
</g>
<!-- gate_layer2_gpu10 -->
<g id="node190" class="node">
<title>gate_layer2_gpu10</title>
<path fill="lightsteelblue" stroke="black" d="M11121.07,-10203.96C11121.07,-10203.96 10671.93,-10153.64 10671.93,-10153.64 10665.96,-10152.97 10665.96,-10151.63 10671.93,-10150.96 10671.93,-10150.96 11121.07,-10100.64 11121.07,-10100.64 11127.04,-10099.97 11138.96,-10099.97 11144.93,-10100.64 11144.93,-10100.64 11594.07,-10150.96 11594.07,-10150.96 11600.04,-10151.63 11600.04,-10152.97 11594.07,-10153.64 11594.07,-10153.64 11144.93,-10203.96 11144.93,-10203.96 11138.96,-10204.63 11127.04,-10204.63 11121.07,-10203.96"/>
<text text-anchor="middle" x="11133" y="-10163.6" font-family="Times,serif" font-size="14.00">Gate Layer 2 GPU 10</text>
<text text-anchor="middle" x="11133" y="-10148.6" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11133" y="-10133.6" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer2_gpu10&#45;&gt;gate_layer2_gpu10 -->
<g id="edge219" class="edge">
<title>mha_layer2_gpu10&#45;&gt;gate_layer2_gpu10</title>
<path fill="none" stroke="black" d="M10959.55,-10241.19C10983.2,-10229.2 11012.14,-10214.54 11039.56,-10200.64"/>
<polygon fill="black" stroke="black" points="11041.45,-10203.61 11048.79,-10195.97 11038.29,-10197.37 11041.45,-10203.61"/>
</g>
<!-- gate_layer2_gpu11 -->
<g id="node191" class="node">
<title>gate_layer2_gpu11</title>
<path fill="lightsteelblue" stroke="black" d="M12085.07,-10203.96C12085.07,-10203.96 11635.93,-10153.64 11635.93,-10153.64 11629.96,-10152.97 11629.96,-10151.63 11635.93,-10150.96 11635.93,-10150.96 12085.07,-10100.64 12085.07,-10100.64 12091.04,-10099.97 12102.96,-10099.97 12108.93,-10100.64 12108.93,-10100.64 12558.07,-10150.96 12558.07,-10150.96 12564.04,-10151.63 12564.04,-10152.97 12558.07,-10153.64 12558.07,-10153.64 12108.93,-10203.96 12108.93,-10203.96 12102.96,-10204.63 12091.04,-10204.63 12085.07,-10203.96"/>
<text text-anchor="middle" x="12097" y="-10163.6" font-family="Times,serif" font-size="14.00">Gate Layer 2 GPU 11</text>
<text text-anchor="middle" x="12097" y="-10148.6" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="12097" y="-10133.6" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer2_gpu11&#45;&gt;gate_layer2_gpu11 -->
<g id="edge220" class="edge">
<title>mha_layer2_gpu11&#45;&gt;gate_layer2_gpu11</title>
<path fill="none" stroke="black" d="M11655.27,-10241.26C11733.35,-10225.71 11834.21,-10205.63 11919.83,-10188.58"/>
<polygon fill="black" stroke="black" points="11920.54,-10192.01 11929.66,-10186.62 11919.17,-10185.14 11920.54,-10192.01"/>
</g>
<!-- gate_layer2_gpu12 -->
<g id="node192" class="node">
<title>gate_layer2_gpu12</title>
<path fill="lightsteelblue" stroke="black" d="M13049.07,-10203.96C13049.07,-10203.96 12599.93,-10153.64 12599.93,-10153.64 12593.96,-10152.97 12593.96,-10151.63 12599.93,-10150.96 12599.93,-10150.96 13049.07,-10100.64 13049.07,-10100.64 13055.04,-10099.97 13066.96,-10099.97 13072.93,-10100.64 13072.93,-10100.64 13522.07,-10150.96 13522.07,-10150.96 13528.04,-10151.63 13528.04,-10152.97 13522.07,-10153.64 13522.07,-10153.64 13072.93,-10203.96 13072.93,-10203.96 13066.96,-10204.63 13055.04,-10204.63 13049.07,-10203.96"/>
<text text-anchor="middle" x="13061" y="-10163.6" font-family="Times,serif" font-size="14.00">Gate Layer 2 GPU 12</text>
<text text-anchor="middle" x="13061" y="-10148.6" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13061" y="-10133.6" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer2_gpu12&#45;&gt;gate_layer2_gpu12 -->
<g id="edge221" class="edge">
<title>mha_layer2_gpu12&#45;&gt;gate_layer2_gpu12</title>
<path fill="none" stroke="black" d="M12301.24,-10241.29C12456.14,-10223.35 12663.31,-10199.36 12822.18,-10180.96"/>
<polygon fill="black" stroke="black" points="12823.05,-10184.38 12832.58,-10179.75 12822.24,-10177.43 12823.05,-10184.38"/>
</g>
<!-- gate_layer2_gpu13 -->
<g id="node193" class="node">
<title>gate_layer2_gpu13</title>
<path fill="lightsteelblue" stroke="black" d="M14013.07,-10203.96C14013.07,-10203.96 13563.93,-10153.64 13563.93,-10153.64 13557.96,-10152.97 13557.96,-10151.63 13563.93,-10150.96 13563.93,-10150.96 14013.07,-10100.64 14013.07,-10100.64 14019.04,-10099.97 14030.96,-10099.97 14036.93,-10100.64 14036.93,-10100.64 14486.07,-10150.96 14486.07,-10150.96 14492.04,-10151.63 14492.04,-10152.97 14486.07,-10153.64 14486.07,-10153.64 14036.93,-10203.96 14036.93,-10203.96 14030.96,-10204.63 14019.04,-10204.63 14013.07,-10203.96"/>
<text text-anchor="middle" x="14025" y="-10163.6" font-family="Times,serif" font-size="14.00">Gate Layer 2 GPU 13</text>
<text text-anchor="middle" x="14025" y="-10148.6" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14025" y="-10133.6" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer2_gpu13&#45;&gt;gate_layer2_gpu13 -->
<g id="edge222" class="edge">
<title>mha_layer2_gpu13&#45;&gt;gate_layer2_gpu13</title>
<path fill="none" stroke="black" d="M13911.36,-10241.04C13925.26,-10230.31 13941.93,-10217.44 13958.16,-10204.91"/>
<polygon fill="black" stroke="black" points="13960.31,-10207.67 13966.08,-10198.79 13956.03,-10202.13 13960.31,-10207.67"/>
</g>
<!-- gate_layer2_gpu14 -->
<g id="node194" class="node">
<title>gate_layer2_gpu14</title>
<path fill="lightsteelblue" stroke="black" d="M14977.07,-10203.96C14977.07,-10203.96 14527.93,-10153.64 14527.93,-10153.64 14521.96,-10152.97 14521.96,-10151.63 14527.93,-10150.96 14527.93,-10150.96 14977.07,-10100.64 14977.07,-10100.64 14983.04,-10099.97 14994.96,-10099.97 15000.93,-10100.64 15000.93,-10100.64 15450.07,-10150.96 15450.07,-10150.96 15456.04,-10151.63 15456.04,-10152.97 15450.07,-10153.64 15450.07,-10153.64 15000.93,-10203.96 15000.93,-10203.96 14994.96,-10204.63 14983.04,-10204.63 14977.07,-10203.96"/>
<text text-anchor="middle" x="14989" y="-10163.6" font-family="Times,serif" font-size="14.00">Gate Layer 2 GPU 14</text>
<text text-anchor="middle" x="14989" y="-10148.6" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14989" y="-10133.6" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer2_gpu14&#45;&gt;gate_layer2_gpu14 -->
<g id="edge223" class="edge">
<title>mha_layer2_gpu14&#45;&gt;gate_layer2_gpu14</title>
<path fill="none" stroke="black" d="M14573.62,-10241.26C14645.78,-10225.98 14738.64,-10206.32 14818.24,-10189.46"/>
<polygon fill="black" stroke="black" points="14819.32,-10192.81 14828.38,-10187.31 14817.87,-10185.96 14819.32,-10192.81"/>
</g>
<!-- gate_layer2_gpu15 -->
<g id="node195" class="node">
<title>gate_layer2_gpu15</title>
<path fill="lightsteelblue" stroke="black" d="M15941.07,-10203.96C15941.07,-10203.96 15491.93,-10153.64 15491.93,-10153.64 15485.96,-10152.97 15485.96,-10151.63 15491.93,-10150.96 15491.93,-10150.96 15941.07,-10100.64 15941.07,-10100.64 15947.04,-10099.97 15958.96,-10099.97 15964.93,-10100.64 15964.93,-10100.64 16414.07,-10150.96 16414.07,-10150.96 16420.04,-10151.63 16420.04,-10152.97 16414.07,-10153.64 16414.07,-10153.64 15964.93,-10203.96 15964.93,-10203.96 15958.96,-10204.63 15947.04,-10204.63 15941.07,-10203.96"/>
<text text-anchor="middle" x="15953" y="-10163.6" font-family="Times,serif" font-size="14.00">Gate Layer 2 GPU 15</text>
<text text-anchor="middle" x="15953" y="-10148.6" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="15953" y="-10133.6" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer2_gpu15&#45;&gt;gate_layer2_gpu15 -->
<g id="edge224" class="edge">
<title>mha_layer2_gpu15&#45;&gt;gate_layer2_gpu15</title>
<path fill="none" stroke="black" d="M15764.06,-10241.19C15790.43,-10228.92 15822.84,-10213.85 15853.32,-10199.67"/>
<polygon fill="black" stroke="black" points="15855.12,-10202.69 15862.71,-10195.3 15852.17,-10196.34 15855.12,-10202.69"/>
</g>
<!-- route_layer2_gpu0 -->
<g id="node212" class="node">
<title>route_layer2_gpu0</title>
<path fill="orange" stroke="black" d="M2091.74,-10063.3C2091.74,-10063.3 1583.24,-10063.3 1583.24,-10063.3 1577.24,-10063.3 1566.5,-10059.63 1561.75,-10055.96 1561.75,-10055.96 1443.75,-9964.64 1443.75,-9964.64 1439,-9960.97 1440.26,-9957.3 1446.26,-9957.3 1446.26,-9957.3 1954.76,-9957.3 1954.76,-9957.3 1960.76,-9957.3 1971.5,-9960.97 1976.25,-9964.64 1976.25,-9964.64 2094.25,-10055.96 2094.25,-10055.96 2099,-10059.63 2097.74,-10063.3 2091.74,-10063.3"/>
<text text-anchor="middle" x="1769" y="-10021.6" font-family="Times,serif" font-size="14.00">Token Router Layer 2 GPU 0</text>
<text text-anchor="middle" x="1769" y="-10006.6" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="1769" y="-9991.6" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer2_gpu0&#45;&gt;route_layer2_gpu0 -->
<g id="edge225" class="edge">
<title>gate_layer2_gpu0&#45;&gt;route_layer2_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1577.31,-10108.53C1602.52,-10095.75 1630.56,-10081.52 1657.24,-10067.99"/>
<polygon fill="black" stroke="black" points="1658.9,-10071.07 1666.23,-10063.43 1655.73,-10064.83 1658.9,-10071.07"/>
</g>
<!-- route_layer2_gpu1 -->
<g id="node214" class="node">
<title>route_layer2_gpu1</title>
<path fill="orange" stroke="black" d="M2917.74,-10063.3C2917.74,-10063.3 2409.24,-10063.3 2409.24,-10063.3 2403.24,-10063.3 2392.5,-10059.63 2387.75,-10055.96 2387.75,-10055.96 2269.75,-9964.64 2269.75,-9964.64 2265,-9960.97 2266.26,-9957.3 2272.26,-9957.3 2272.26,-9957.3 2780.76,-9957.3 2780.76,-9957.3 2786.76,-9957.3 2797.5,-9960.97 2802.25,-9964.64 2802.25,-9964.64 2920.25,-10055.96 2920.25,-10055.96 2925,-10059.63 2923.74,-10063.3 2917.74,-10063.3"/>
<text text-anchor="middle" x="2595" y="-10021.6" font-family="Times,serif" font-size="14.00">Token Router Layer 2 GPU 1</text>
<text text-anchor="middle" x="2595" y="-10006.6" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="2595" y="-9991.6" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer2_gpu1&#45;&gt;route_layer2_gpu1 -->
<g id="edge226" class="edge">
<title>gate_layer2_gpu1&#45;&gt;route_layer2_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2503.34,-10104.29C2513.87,-10093.61 2525.2,-10082.11 2536.17,-10070.98"/>
<polygon fill="black" stroke="black" points="2538.8,-10073.3 2543.32,-10063.73 2533.81,-10068.39 2538.8,-10073.3"/>
</g>
<!-- route_layer2_gpu2 -->
<g id="node216" class="node">
<title>route_layer2_gpu2</title>
<path fill="orange" stroke="black" d="M3915.74,-10063.3C3915.74,-10063.3 3407.24,-10063.3 3407.24,-10063.3 3401.24,-10063.3 3390.5,-10059.63 3385.75,-10055.96 3385.75,-10055.96 3267.75,-9964.64 3267.75,-9964.64 3263,-9960.97 3264.26,-9957.3 3270.26,-9957.3 3270.26,-9957.3 3778.76,-9957.3 3778.76,-9957.3 3784.76,-9957.3 3795.5,-9960.97 3800.25,-9964.64 3800.25,-9964.64 3918.25,-10055.96 3918.25,-10055.96 3923,-10059.63 3921.74,-10063.3 3915.74,-10063.3"/>
<text text-anchor="middle" x="3593" y="-10021.6" font-family="Times,serif" font-size="14.00">Token Router Layer 2 GPU 2</text>
<text text-anchor="middle" x="3593" y="-10006.6" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="3593" y="-9991.6" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer2_gpu2&#45;&gt;route_layer2_gpu2 -->
<g id="edge227" class="edge">
<title>gate_layer2_gpu2&#45;&gt;route_layer2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3477.32,-10105.46C3491.29,-10094.09 3506.45,-10081.75 3521.06,-10069.86"/>
<polygon fill="black" stroke="black" points="3523.56,-10072.34 3529.1,-10063.31 3519.14,-10066.91 3523.56,-10072.34"/>
</g>
<!-- route_layer2_gpu3 -->
<g id="node218" class="node">
<title>route_layer2_gpu3</title>
<path fill="orange" stroke="black" d="M4845.74,-10063.3C4845.74,-10063.3 4337.24,-10063.3 4337.24,-10063.3 4331.24,-10063.3 4320.5,-10059.63 4315.75,-10055.96 4315.75,-10055.96 4197.75,-9964.64 4197.75,-9964.64 4193,-9960.97 4194.26,-9957.3 4200.26,-9957.3 4200.26,-9957.3 4708.76,-9957.3 4708.76,-9957.3 4714.76,-9957.3 4725.5,-9960.97 4730.25,-9964.64 4730.25,-9964.64 4848.25,-10055.96 4848.25,-10055.96 4853,-10059.63 4851.74,-10063.3 4845.74,-10063.3"/>
<text text-anchor="middle" x="4523" y="-10021.6" font-family="Times,serif" font-size="14.00">Token Router Layer 2 GPU 3</text>
<text text-anchor="middle" x="4523" y="-10006.6" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="4523" y="-9991.6" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer2_gpu3&#45;&gt;route_layer2_gpu3 -->
<g id="edge228" class="edge">
<title>gate_layer2_gpu3&#45;&gt;route_layer2_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4431.34,-10104.29C4441.87,-10093.61 4453.2,-10082.11 4464.17,-10070.98"/>
<polygon fill="black" stroke="black" points="4466.8,-10073.3 4471.32,-10063.73 4461.81,-10068.39 4466.8,-10073.3"/>
</g>
<!-- route_layer2_gpu4 -->
<g id="node220" class="node">
<title>route_layer2_gpu4</title>
<path fill="orange" stroke="black" d="M6085.74,-10063.3C6085.74,-10063.3 5577.24,-10063.3 5577.24,-10063.3 5571.24,-10063.3 5560.5,-10059.63 5555.75,-10055.96 5555.75,-10055.96 5437.75,-9964.64 5437.75,-9964.64 5433,-9960.97 5434.26,-9957.3 5440.26,-9957.3 5440.26,-9957.3 5948.76,-9957.3 5948.76,-9957.3 5954.76,-9957.3 5965.5,-9960.97 5970.25,-9964.64 5970.25,-9964.64 6088.25,-10055.96 6088.25,-10055.96 6093,-10059.63 6091.74,-10063.3 6085.74,-10063.3"/>
<text text-anchor="middle" x="5763" y="-10021.6" font-family="Times,serif" font-size="14.00">Token Router Layer 2 GPU 4</text>
<text text-anchor="middle" x="5763" y="-10006.6" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="5763" y="-9991.6" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer2_gpu4&#45;&gt;route_layer2_gpu4 -->
<g id="edge229" class="edge">
<title>gate_layer2_gpu4&#45;&gt;route_layer2_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5464.6,-10112.21C5506.36,-10098.09 5554.34,-10081.86 5599.44,-10066.61"/>
<polygon fill="black" stroke="black" points="5600.66,-10069.89 5609.01,-10063.37 5598.42,-10063.26 5600.66,-10069.89"/>
</g>
<!-- route_layer2_gpu5 -->
<g id="node222" class="node">
<title>route_layer2_gpu5</title>
<path fill="orange" stroke="black" d="M7049.74,-10063.3C7049.74,-10063.3 6541.24,-10063.3 6541.24,-10063.3 6535.24,-10063.3 6524.5,-10059.63 6519.75,-10055.96 6519.75,-10055.96 6401.75,-9964.64 6401.75,-9964.64 6397,-9960.97 6398.26,-9957.3 6404.26,-9957.3 6404.26,-9957.3 6912.76,-9957.3 6912.76,-9957.3 6918.76,-9957.3 6929.5,-9960.97 6934.25,-9964.64 6934.25,-9964.64 7052.25,-10055.96 7052.25,-10055.96 7057,-10059.63 7055.74,-10063.3 7049.74,-10063.3"/>
<text text-anchor="middle" x="6727" y="-10021.6" font-family="Times,serif" font-size="14.00">Token Router Layer 2 GPU 5</text>
<text text-anchor="middle" x="6727" y="-10006.6" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="6727" y="-9991.6" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer2_gpu5&#45;&gt;route_layer2_gpu5 -->
<g id="edge230" class="edge">
<title>gate_layer2_gpu5&#45;&gt;route_layer2_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6428.6,-10112.21C6470.36,-10098.09 6518.34,-10081.86 6563.44,-10066.61"/>
<polygon fill="black" stroke="black" points="6564.66,-10069.89 6573.01,-10063.37 6562.42,-10063.26 6564.66,-10069.89"/>
</g>
<!-- route_layer2_gpu6 -->
<g id="node224" class="node">
<title>route_layer2_gpu6</title>
<path fill="orange" stroke="black" d="M7875.74,-10063.3C7875.74,-10063.3 7367.24,-10063.3 7367.24,-10063.3 7361.24,-10063.3 7350.5,-10059.63 7345.75,-10055.96 7345.75,-10055.96 7227.75,-9964.64 7227.75,-9964.64 7223,-9960.97 7224.26,-9957.3 7230.26,-9957.3 7230.26,-9957.3 7738.76,-9957.3 7738.76,-9957.3 7744.76,-9957.3 7755.5,-9960.97 7760.25,-9964.64 7760.25,-9964.64 7878.25,-10055.96 7878.25,-10055.96 7883,-10059.63 7881.74,-10063.3 7875.74,-10063.3"/>
<text text-anchor="middle" x="7553" y="-10021.6" font-family="Times,serif" font-size="14.00">Token Router Layer 2 GPU 6</text>
<text text-anchor="middle" x="7553" y="-10006.6" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="7553" y="-9991.6" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer2_gpu6&#45;&gt;route_layer2_gpu6 -->
<g id="edge231" class="edge">
<title>gate_layer2_gpu6&#45;&gt;route_layer2_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7361.31,-10108.53C7386.52,-10095.75 7414.56,-10081.52 7441.24,-10067.99"/>
<polygon fill="black" stroke="black" points="7442.9,-10071.07 7450.23,-10063.43 7439.73,-10064.83 7442.9,-10071.07"/>
</g>
<!-- route_layer2_gpu7 -->
<g id="node226" class="node">
<title>route_layer2_gpu7</title>
<path fill="orange" stroke="black" d="M8632.74,-10063.3C8632.74,-10063.3 8124.24,-10063.3 8124.24,-10063.3 8118.24,-10063.3 8107.5,-10059.63 8102.75,-10055.96 8102.75,-10055.96 7984.75,-9964.64 7984.75,-9964.64 7980,-9960.97 7981.26,-9957.3 7987.26,-9957.3 7987.26,-9957.3 8495.76,-9957.3 8495.76,-9957.3 8501.76,-9957.3 8512.5,-9960.97 8517.25,-9964.64 8517.25,-9964.64 8635.25,-10055.96 8635.25,-10055.96 8640,-10059.63 8638.74,-10063.3 8632.74,-10063.3"/>
<text text-anchor="middle" x="8310" y="-10021.6" font-family="Times,serif" font-size="14.00">Token Router Layer 2 GPU 7</text>
<text text-anchor="middle" x="8310" y="-10006.6" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="8310" y="-9991.6" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer2_gpu7&#45;&gt;route_layer2_gpu7 -->
<g id="edge232" class="edge">
<title>gate_layer2_gpu7&#45;&gt;route_layer2_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8265.33,-10101.94C8269.97,-10092.52 8274.89,-10082.54 8279.69,-10072.79"/>
<polygon fill="black" stroke="black" points="8282.97,-10074.05 8284.26,-10063.53 8276.7,-10070.96 8282.97,-10074.05"/>
</g>
<!-- route_layer2_gpu8 -->
<g id="node228" class="node">
<title>route_layer2_gpu8</title>
<path fill="orange" stroke="black" d="M9458.74,-10063.3C9458.74,-10063.3 8950.24,-10063.3 8950.24,-10063.3 8944.24,-10063.3 8933.5,-10059.63 8928.75,-10055.96 8928.75,-10055.96 8810.75,-9964.64 8810.75,-9964.64 8806,-9960.97 8807.26,-9957.3 8813.26,-9957.3 8813.26,-9957.3 9321.76,-9957.3 9321.76,-9957.3 9327.76,-9957.3 9338.5,-9960.97 9343.25,-9964.64 9343.25,-9964.64 9461.25,-10055.96 9461.25,-10055.96 9466,-10059.63 9464.74,-10063.3 9458.74,-10063.3"/>
<text text-anchor="middle" x="9136" y="-10021.6" font-family="Times,serif" font-size="14.00">Token Router Layer 2 GPU 8</text>
<text text-anchor="middle" x="9136" y="-10006.6" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="9136" y="-9991.6" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer2_gpu8&#45;&gt;route_layer2_gpu8 -->
<g id="edge233" class="edge">
<title>gate_layer2_gpu8&#45;&gt;route_layer2_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9180.67,-10101.94C9176.03,-10092.52 9171.11,-10082.54 9166.31,-10072.79"/>
<polygon fill="black" stroke="black" points="9169.3,-10070.96 9161.74,-10063.53 9163.03,-10074.05 9169.3,-10070.96"/>
</g>
<!-- route_layer2_gpu9 -->
<g id="node230" class="node">
<title>route_layer2_gpu9</title>
<path fill="orange" stroke="black" d="M10353.74,-10063.3C10353.74,-10063.3 9845.24,-10063.3 9845.24,-10063.3 9839.24,-10063.3 9828.5,-10059.63 9823.75,-10055.96 9823.75,-10055.96 9705.75,-9964.64 9705.75,-9964.64 9701,-9960.97 9702.26,-9957.3 9708.26,-9957.3 9708.26,-9957.3 10216.76,-9957.3 10216.76,-9957.3 10222.76,-9957.3 10233.5,-9960.97 10238.25,-9964.64 10238.25,-9964.64 10356.25,-10055.96 10356.25,-10055.96 10361,-10059.63 10359.74,-10063.3 10353.74,-10063.3"/>
<text text-anchor="middle" x="10031" y="-10021.6" font-family="Times,serif" font-size="14.00">Token Router Layer 2 GPU 9</text>
<text text-anchor="middle" x="10031" y="-10006.6" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="10031" y="-9991.6" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer2_gpu9&#45;&gt;route_layer2_gpu9 -->
<g id="edge234" class="edge">
<title>gate_layer2_gpu9&#45;&gt;route_layer2_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10122.66,-10104.29C10112.13,-10093.61 10100.8,-10082.11 10089.83,-10070.98"/>
<polygon fill="black" stroke="black" points="10092.19,-10068.39 10082.68,-10063.73 10087.2,-10073.3 10092.19,-10068.39"/>
</g>
<!-- route_layer2_gpu10 -->
<g id="node232" class="node">
<title>route_layer2_gpu10</title>
<path fill="orange" stroke="black" d="M11282.74,-10063.3C11282.74,-10063.3 10774.24,-10063.3 10774.24,-10063.3 10768.24,-10063.3 10757.5,-10059.63 10752.75,-10055.96 10752.75,-10055.96 10634.75,-9964.64 10634.75,-9964.64 10630,-9960.97 10631.26,-9957.3 10637.26,-9957.3 10637.26,-9957.3 11145.76,-9957.3 11145.76,-9957.3 11151.76,-9957.3 11162.5,-9960.97 11167.25,-9964.64 11167.25,-9964.64 11285.25,-10055.96 11285.25,-10055.96 11290,-10059.63 11288.74,-10063.3 11282.74,-10063.3"/>
<text text-anchor="middle" x="10960" y="-10021.6" font-family="Times,serif" font-size="14.00">Token Router Layer 2 GPU 10</text>
<text text-anchor="middle" x="10960" y="-10006.6" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="10960" y="-9991.6" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer2_gpu10&#45;&gt;route_layer2_gpu10 -->
<g id="edge235" class="edge">
<title>gate_layer2_gpu10&#45;&gt;route_layer2_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11076.35,-10105.46C11062.3,-10094.09 11047.05,-10081.75 11032.36,-10069.86"/>
<polygon fill="black" stroke="black" points="11034.24,-10066.88 11024.27,-10063.31 11029.84,-10072.32 11034.24,-10066.88"/>
</g>
<!-- route_layer2_gpu11 -->
<g id="node234" class="node">
<title>route_layer2_gpu11</title>
<path fill="orange" stroke="black" d="M12229.74,-10063.3C12229.74,-10063.3 11721.24,-10063.3 11721.24,-10063.3 11715.24,-10063.3 11704.5,-10059.63 11699.75,-10055.96 11699.75,-10055.96 11581.75,-9964.64 11581.75,-9964.64 11577,-9960.97 11578.26,-9957.3 11584.26,-9957.3 11584.26,-9957.3 12092.76,-9957.3 12092.76,-9957.3 12098.76,-9957.3 12109.5,-9960.97 12114.25,-9964.64 12114.25,-9964.64 12232.25,-10055.96 12232.25,-10055.96 12237,-10059.63 12235.74,-10063.3 12229.74,-10063.3"/>
<text text-anchor="middle" x="11907" y="-10021.6" font-family="Times,serif" font-size="14.00">Token Router Layer 2 GPU 11</text>
<text text-anchor="middle" x="11907" y="-10006.6" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="11907" y="-9991.6" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer2_gpu11&#45;&gt;route_layer2_gpu11 -->
<g id="edge236" class="edge">
<title>gate_layer2_gpu11&#45;&gt;route_layer2_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12035.57,-10106.04C12019.74,-10094.37 12002.47,-10081.64 11985.87,-10069.42"/>
<polygon fill="black" stroke="black" points="11987.92,-10066.58 11977.79,-10063.46 11983.77,-10072.21 11987.92,-10066.58"/>
</g>
<!-- route_layer2_gpu12 -->
<g id="node236" class="node">
<title>route_layer2_gpu12</title>
<path fill="orange" stroke="black" d="M13184.74,-10063.3C13184.74,-10063.3 12676.24,-10063.3 12676.24,-10063.3 12670.24,-10063.3 12659.5,-10059.63 12654.75,-10055.96 12654.75,-10055.96 12536.75,-9964.64 12536.75,-9964.64 12532,-9960.97 12533.26,-9957.3 12539.26,-9957.3 12539.26,-9957.3 13047.76,-9957.3 13047.76,-9957.3 13053.76,-9957.3 13064.5,-9960.97 13069.25,-9964.64 13069.25,-9964.64 13187.25,-10055.96 13187.25,-10055.96 13192,-10059.63 13190.74,-10063.3 13184.74,-10063.3"/>
<text text-anchor="middle" x="12862" y="-10021.6" font-family="Times,serif" font-size="14.00">Token Router Layer 2 GPU 12</text>
<text text-anchor="middle" x="12862" y="-10006.6" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="12862" y="-9991.6" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer2_gpu12&#45;&gt;route_layer2_gpu12 -->
<g id="edge237" class="edge">
<title>gate_layer2_gpu12&#45;&gt;route_layer2_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12997.21,-10106.43C12980.51,-10094.67 12962.25,-10081.83 12944.71,-10069.49"/>
<polygon fill="black" stroke="black" points="12946.36,-10066.37 12936.17,-10063.48 12942.34,-10072.1 12946.36,-10066.37"/>
</g>
<!-- route_layer2_gpu13 -->
<g id="node238" class="node">
<title>route_layer2_gpu13</title>
<path fill="orange" stroke="black" d="M14144.74,-10063.3C14144.74,-10063.3 13636.24,-10063.3 13636.24,-10063.3 13630.24,-10063.3 13619.5,-10059.63 13614.75,-10055.96 13614.75,-10055.96 13496.75,-9964.64 13496.75,-9964.64 13492,-9960.97 13493.26,-9957.3 13499.26,-9957.3 13499.26,-9957.3 14007.76,-9957.3 14007.76,-9957.3 14013.76,-9957.3 14024.5,-9960.97 14029.25,-9964.64 14029.25,-9964.64 14147.25,-10055.96 14147.25,-10055.96 14152,-10059.63 14150.74,-10063.3 14144.74,-10063.3"/>
<text text-anchor="middle" x="13822" y="-10021.6" font-family="Times,serif" font-size="14.00">Token Router Layer 2 GPU 13</text>
<text text-anchor="middle" x="13822" y="-10006.6" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="13822" y="-9991.6" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer2_gpu13&#45;&gt;route_layer2_gpu13 -->
<g id="edge238" class="edge">
<title>gate_layer2_gpu13&#45;&gt;route_layer2_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13959.93,-10106.43C13942.89,-10094.67 13924.27,-10081.83 13906.38,-10069.49"/>
<polygon fill="black" stroke="black" points="13907.88,-10066.28 13897.66,-10063.48 13903.91,-10072.04 13907.88,-10066.28"/>
</g>
<!-- route_layer2_gpu14 -->
<g id="node240" class="node">
<title>route_layer2_gpu14</title>
<path fill="orange" stroke="black" d="M15106.74,-10063.3C15106.74,-10063.3 14598.24,-10063.3 14598.24,-10063.3 14592.24,-10063.3 14581.5,-10059.63 14576.75,-10055.96 14576.75,-10055.96 14458.75,-9964.64 14458.75,-9964.64 14454,-9960.97 14455.26,-9957.3 14461.26,-9957.3 14461.26,-9957.3 14969.76,-9957.3 14969.76,-9957.3 14975.76,-9957.3 14986.5,-9960.97 14991.25,-9964.64 14991.25,-9964.64 15109.25,-10055.96 15109.25,-10055.96 15114,-10059.63 15112.74,-10063.3 15106.74,-10063.3"/>
<text text-anchor="middle" x="14784" y="-10021.6" font-family="Times,serif" font-size="14.00">Token Router Layer 2 GPU 14</text>
<text text-anchor="middle" x="14784" y="-10006.6" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="14784" y="-9991.6" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer2_gpu14&#45;&gt;route_layer2_gpu14 -->
<g id="edge239" class="edge">
<title>gate_layer2_gpu14&#45;&gt;route_layer2_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14923.57,-10106.62C14906.1,-10094.68 14886.96,-10081.61 14868.61,-10069.08"/>
<polygon fill="black" stroke="black" points="14870.47,-10066.11 14860.24,-10063.37 14866.52,-10071.9 14870.47,-10066.11"/>
</g>
<!-- route_layer2_gpu15 -->
<g id="node242" class="node">
<title>route_layer2_gpu15</title>
<path fill="orange" stroke="black" d="M16069.74,-10063.3C16069.74,-10063.3 15561.24,-10063.3 15561.24,-10063.3 15555.24,-10063.3 15544.5,-10059.63 15539.75,-10055.96 15539.75,-10055.96 15421.75,-9964.64 15421.75,-9964.64 15417,-9960.97 15418.26,-9957.3 15424.26,-9957.3 15424.26,-9957.3 15932.76,-9957.3 15932.76,-9957.3 15938.76,-9957.3 15949.5,-9960.97 15954.25,-9964.64 15954.25,-9964.64 16072.25,-10055.96 16072.25,-10055.96 16077,-10059.63 16075.74,-10063.3 16069.74,-10063.3"/>
<text text-anchor="middle" x="15747" y="-10021.6" font-family="Times,serif" font-size="14.00">Token Router Layer 2 GPU 15</text>
<text text-anchor="middle" x="15747" y="-10006.6" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="15747" y="-9991.6" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer2_gpu15&#45;&gt;route_layer2_gpu15 -->
<g id="edge240" class="edge">
<title>gate_layer2_gpu15&#45;&gt;route_layer2_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15887.25,-10106.62C15869.69,-10094.68 15850.46,-10081.61 15832.02,-10069.08"/>
<polygon fill="black" stroke="black" points="15833.85,-10066.09 15823.61,-10063.37 15829.91,-10071.88 15833.85,-10066.09"/>
</g>
<!-- expert_layer2_gpu0_expert0 -->
<g id="node196" class="node">
<title>expert_layer2_gpu0_expert0</title>
<path fill="lightcoral" stroke="black" d="M2430.5,-9810.35C2430.5,-9810.35 1961.5,-9810.35 1961.5,-9810.35 1955.5,-9810.35 1949.5,-9804.35 1949.5,-9798.35 1949.5,-9798.35 1949.5,-9754.35 1949.5,-9754.35 1949.5,-9748.35 1955.5,-9742.35 1961.5,-9742.35 1961.5,-9742.35 2430.5,-9742.35 2430.5,-9742.35 2436.5,-9742.35 2442.5,-9748.35 2442.5,-9754.35 2442.5,-9754.35 2442.5,-9798.35 2442.5,-9798.35 2442.5,-9804.35 2436.5,-9810.35 2430.5,-9810.35"/>
<text text-anchor="middle" x="2196" y="-9795.15" font-family="Times,serif" font-size="14.00">Expert 0 Layer 2 GPU 0</text>
<text text-anchor="middle" x="2196" y="-9780.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2196" y="-9765.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2196" y="-9750.15" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer2_gpu0 -->
<g id="node213" class="node">
<title>aggregate_layer2_gpu0</title>
<path fill="orange" stroke="black" d="M2070.29,-9706.35C2070.29,-9706.35 1583.19,-9706.35 1583.19,-9706.35 1577.19,-9706.35 1566.52,-9702.58 1561.85,-9698.81 1561.85,-9698.81 1449.06,-9607.88 1449.06,-9607.88 1444.38,-9604.11 1445.71,-9600.35 1451.71,-9600.35 1451.71,-9600.35 1938.81,-9600.35 1938.81,-9600.35 1944.81,-9600.35 1955.48,-9604.11 1960.15,-9607.88 1960.15,-9607.88 2072.94,-9698.81 2072.94,-9698.81 2077.62,-9702.58 2076.29,-9706.35 2070.29,-9706.35"/>
<text text-anchor="middle" x="1761" y="-9664.65" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 2 GPU 0</text>
<text text-anchor="middle" x="1761" y="-9649.65" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="1761" y="-9634.65" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer2_gpu0_expert0&#45;&gt;aggregate_layer2_gpu0 -->
<g id="edge273" class="edge">
<title>expert_layer2_gpu0_expert0&#45;&gt;aggregate_layer2_gpu0</title>
<path fill="none" stroke="black" d="M2077.13,-9742.28C2040.22,-9732.02 1998.5,-9720.41 1957.76,-9709.08"/>
<polygon fill="black" stroke="black" points="1958.56,-9705.67 1947.98,-9706.36 1956.68,-9712.41 1958.56,-9705.67"/>
</g>
<!-- expert_layer2_gpu1_expert1 -->
<g id="node197" class="node">
<title>expert_layer2_gpu1_expert1</title>
<path fill="lightcoral" stroke="black" d="M3091.5,-9810.35C3091.5,-9810.35 2622.5,-9810.35 2622.5,-9810.35 2616.5,-9810.35 2610.5,-9804.35 2610.5,-9798.35 2610.5,-9798.35 2610.5,-9754.35 2610.5,-9754.35 2610.5,-9748.35 2616.5,-9742.35 2622.5,-9742.35 2622.5,-9742.35 3091.5,-9742.35 3091.5,-9742.35 3097.5,-9742.35 3103.5,-9748.35 3103.5,-9754.35 3103.5,-9754.35 3103.5,-9798.35 3103.5,-9798.35 3103.5,-9804.35 3097.5,-9810.35 3091.5,-9810.35"/>
<text text-anchor="middle" x="2857" y="-9795.15" font-family="Times,serif" font-size="14.00">Expert 1 Layer 2 GPU 1</text>
<text text-anchor="middle" x="2857" y="-9780.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2857" y="-9765.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2857" y="-9750.15" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer2_gpu1 -->
<g id="node215" class="node">
<title>aggregate_layer2_gpu1</title>
<path fill="orange" stroke="black" d="M2882.29,-9706.35C2882.29,-9706.35 2395.19,-9706.35 2395.19,-9706.35 2389.19,-9706.35 2378.52,-9702.58 2373.85,-9698.81 2373.85,-9698.81 2261.06,-9607.88 2261.06,-9607.88 2256.38,-9604.11 2257.71,-9600.35 2263.71,-9600.35 2263.71,-9600.35 2750.81,-9600.35 2750.81,-9600.35 2756.81,-9600.35 2767.48,-9604.11 2772.15,-9607.88 2772.15,-9607.88 2884.94,-9698.81 2884.94,-9698.81 2889.62,-9702.58 2888.29,-9706.35 2882.29,-9706.35"/>
<text text-anchor="middle" x="2573" y="-9664.65" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 2 GPU 1</text>
<text text-anchor="middle" x="2573" y="-9649.65" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="2573" y="-9634.65" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer2_gpu1_expert1&#45;&gt;aggregate_layer2_gpu1 -->
<g id="edge274" class="edge">
<title>expert_layer2_gpu1_expert1&#45;&gt;aggregate_layer2_gpu1</title>
<path fill="none" stroke="black" d="M2779.4,-9742.28C2756.21,-9732.41 2730.12,-9721.29 2704.49,-9710.37"/>
<polygon fill="black" stroke="black" points="2705.65,-9707.06 2695.08,-9706.36 2702.9,-9713.5 2705.65,-9707.06"/>
</g>
<!-- expert_layer2_gpu2_expert2 -->
<g id="node198" class="node">
<title>expert_layer2_gpu2_expert2</title>
<path fill="lightcoral" stroke="black" d="M4218.5,-9810.35C4218.5,-9810.35 3749.5,-9810.35 3749.5,-9810.35 3743.5,-9810.35 3737.5,-9804.35 3737.5,-9798.35 3737.5,-9798.35 3737.5,-9754.35 3737.5,-9754.35 3737.5,-9748.35 3743.5,-9742.35 3749.5,-9742.35 3749.5,-9742.35 4218.5,-9742.35 4218.5,-9742.35 4224.5,-9742.35 4230.5,-9748.35 4230.5,-9754.35 4230.5,-9754.35 4230.5,-9798.35 4230.5,-9798.35 4230.5,-9804.35 4224.5,-9810.35 4218.5,-9810.35"/>
<text text-anchor="middle" x="3984" y="-9795.15" font-family="Times,serif" font-size="14.00">Expert 2 Layer 2 GPU 2</text>
<text text-anchor="middle" x="3984" y="-9780.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3984" y="-9765.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3984" y="-9750.15" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer2_gpu2 -->
<g id="node217" class="node">
<title>aggregate_layer2_gpu2</title>
<path fill="orange" stroke="black" d="M3876.29,-9706.35C3876.29,-9706.35 3389.19,-9706.35 3389.19,-9706.35 3383.19,-9706.35 3372.52,-9702.58 3367.85,-9698.81 3367.85,-9698.81 3255.06,-9607.88 3255.06,-9607.88 3250.38,-9604.11 3251.71,-9600.35 3257.71,-9600.35 3257.71,-9600.35 3744.81,-9600.35 3744.81,-9600.35 3750.81,-9600.35 3761.48,-9604.11 3766.15,-9607.88 3766.15,-9607.88 3878.94,-9698.81 3878.94,-9698.81 3883.62,-9702.58 3882.29,-9706.35 3876.29,-9706.35"/>
<text text-anchor="middle" x="3567" y="-9664.65" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 2 GPU 2</text>
<text text-anchor="middle" x="3567" y="-9649.65" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="3567" y="-9634.65" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer2_gpu2_expert2&#45;&gt;aggregate_layer2_gpu2 -->
<g id="edge275" class="edge">
<title>expert_layer2_gpu2_expert2&#45;&gt;aggregate_layer2_gpu2</title>
<path fill="none" stroke="black" d="M3870.05,-9742.28C3834.82,-9732.06 3795.01,-9720.51 3756.11,-9709.22"/>
<polygon fill="black" stroke="black" points="3756.83,-9705.78 3746.25,-9706.36 3754.88,-9712.51 3756.83,-9705.78"/>
</g>
<!-- expert_layer2_gpu3_expert3 -->
<g id="node199" class="node">
<title>expert_layer2_gpu3_expert3</title>
<path fill="lightcoral" stroke="black" d="M5414.5,-9810.35C5414.5,-9810.35 4945.5,-9810.35 4945.5,-9810.35 4939.5,-9810.35 4933.5,-9804.35 4933.5,-9798.35 4933.5,-9798.35 4933.5,-9754.35 4933.5,-9754.35 4933.5,-9748.35 4939.5,-9742.35 4945.5,-9742.35 4945.5,-9742.35 5414.5,-9742.35 5414.5,-9742.35 5420.5,-9742.35 5426.5,-9748.35 5426.5,-9754.35 5426.5,-9754.35 5426.5,-9798.35 5426.5,-9798.35 5426.5,-9804.35 5420.5,-9810.35 5414.5,-9810.35"/>
<text text-anchor="middle" x="5180" y="-9795.15" font-family="Times,serif" font-size="14.00">Expert 3 Layer 2 GPU 3</text>
<text text-anchor="middle" x="5180" y="-9780.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5180" y="-9765.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5180" y="-9750.15" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer2_gpu3 -->
<g id="node219" class="node">
<title>aggregate_layer2_gpu3</title>
<path fill="orange" stroke="black" d="M4674.29,-9706.35C4674.29,-9706.35 4187.19,-9706.35 4187.19,-9706.35 4181.19,-9706.35 4170.52,-9702.58 4165.85,-9698.81 4165.85,-9698.81 4053.06,-9607.88 4053.06,-9607.88 4048.38,-9604.11 4049.71,-9600.35 4055.71,-9600.35 4055.71,-9600.35 4542.81,-9600.35 4542.81,-9600.35 4548.81,-9600.35 4559.48,-9604.11 4564.15,-9607.88 4564.15,-9607.88 4676.94,-9698.81 4676.94,-9698.81 4681.62,-9702.58 4680.29,-9706.35 4674.29,-9706.35"/>
<text text-anchor="middle" x="4365" y="-9664.65" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 2 GPU 3</text>
<text text-anchor="middle" x="4365" y="-9649.65" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="4365" y="-9634.65" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer2_gpu3_expert3&#45;&gt;aggregate_layer2_gpu3 -->
<g id="edge276" class="edge">
<title>expert_layer2_gpu3_expert3&#45;&gt;aggregate_layer2_gpu3</title>
<path fill="none" stroke="black" d="M4957.57,-9742.32C4875.11,-9730.08 4779.83,-9715.93 4690.1,-9702.61"/>
<polygon fill="black" stroke="black" points="4690.44,-9699.12 4680.03,-9701.12 4689.41,-9706.05 4690.44,-9699.12"/>
</g>
<!-- expert_layer2_gpu4_expert4 -->
<g id="node200" class="node">
<title>expert_layer2_gpu4_expert4</title>
<path fill="lightcoral" stroke="black" d="M6267.5,-9810.35C6267.5,-9810.35 5798.5,-9810.35 5798.5,-9810.35 5792.5,-9810.35 5786.5,-9804.35 5786.5,-9798.35 5786.5,-9798.35 5786.5,-9754.35 5786.5,-9754.35 5786.5,-9748.35 5792.5,-9742.35 5798.5,-9742.35 5798.5,-9742.35 6267.5,-9742.35 6267.5,-9742.35 6273.5,-9742.35 6279.5,-9748.35 6279.5,-9754.35 6279.5,-9754.35 6279.5,-9798.35 6279.5,-9798.35 6279.5,-9804.35 6273.5,-9810.35 6267.5,-9810.35"/>
<text text-anchor="middle" x="6033" y="-9795.15" font-family="Times,serif" font-size="14.00">Expert 4 Layer 2 GPU 4</text>
<text text-anchor="middle" x="6033" y="-9780.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6033" y="-9765.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6033" y="-9750.15" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer2_gpu4 -->
<g id="node221" class="node">
<title>aggregate_layer2_gpu4</title>
<path fill="orange" stroke="black" d="M6016.29,-9706.35C6016.29,-9706.35 5529.19,-9706.35 5529.19,-9706.35 5523.19,-9706.35 5512.52,-9702.58 5507.85,-9698.81 5507.85,-9698.81 5395.06,-9607.88 5395.06,-9607.88 5390.38,-9604.11 5391.71,-9600.35 5397.71,-9600.35 5397.71,-9600.35 5884.81,-9600.35 5884.81,-9600.35 5890.81,-9600.35 5901.48,-9604.11 5906.15,-9607.88 5906.15,-9607.88 6018.94,-9698.81 6018.94,-9698.81 6023.62,-9702.58 6022.29,-9706.35 6016.29,-9706.35"/>
<text text-anchor="middle" x="5707" y="-9664.65" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 2 GPU 4</text>
<text text-anchor="middle" x="5707" y="-9649.65" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="5707" y="-9634.65" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer2_gpu4_expert4&#45;&gt;aggregate_layer2_gpu4 -->
<g id="edge277" class="edge">
<title>expert_layer2_gpu4_expert4&#45;&gt;aggregate_layer2_gpu4</title>
<path fill="none" stroke="black" d="M5943.92,-9742.28C5916.96,-9732.28 5886.57,-9721 5856.78,-9709.94"/>
<polygon fill="black" stroke="black" points="5857.72,-9706.56 5847.13,-9706.36 5855.29,-9713.12 5857.72,-9706.56"/>
</g>
<!-- expert_layer2_gpu5_expert5 -->
<g id="node201" class="node">
<title>expert_layer2_gpu5_expert5</title>
<path fill="lightcoral" stroke="black" d="M7160.5,-9810.35C7160.5,-9810.35 6691.5,-9810.35 6691.5,-9810.35 6685.5,-9810.35 6679.5,-9804.35 6679.5,-9798.35 6679.5,-9798.35 6679.5,-9754.35 6679.5,-9754.35 6679.5,-9748.35 6685.5,-9742.35 6691.5,-9742.35 6691.5,-9742.35 7160.5,-9742.35 7160.5,-9742.35 7166.5,-9742.35 7172.5,-9748.35 7172.5,-9754.35 7172.5,-9754.35 7172.5,-9798.35 7172.5,-9798.35 7172.5,-9804.35 7166.5,-9810.35 7160.5,-9810.35"/>
<text text-anchor="middle" x="6926" y="-9795.15" font-family="Times,serif" font-size="14.00">Expert 5 Layer 2 GPU 5</text>
<text text-anchor="middle" x="6926" y="-9780.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6926" y="-9765.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6926" y="-9750.15" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer2_gpu5 -->
<g id="node223" class="node">
<title>aggregate_layer2_gpu5</title>
<path fill="orange" stroke="black" d="M7018.29,-9706.35C7018.29,-9706.35 6531.19,-9706.35 6531.19,-9706.35 6525.19,-9706.35 6514.52,-9702.58 6509.85,-9698.81 6509.85,-9698.81 6397.06,-9607.88 6397.06,-9607.88 6392.38,-9604.11 6393.71,-9600.35 6399.71,-9600.35 6399.71,-9600.35 6886.81,-9600.35 6886.81,-9600.35 6892.81,-9600.35 6903.48,-9604.11 6908.15,-9607.88 6908.15,-9607.88 7020.94,-9698.81 7020.94,-9698.81 7025.62,-9702.58 7024.29,-9706.35 7018.29,-9706.35"/>
<text text-anchor="middle" x="6709" y="-9664.65" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 2 GPU 5</text>
<text text-anchor="middle" x="6709" y="-9649.65" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="6709" y="-9634.65" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer2_gpu5_expert5&#45;&gt;aggregate_layer2_gpu5 -->
<g id="edge278" class="edge">
<title>expert_layer2_gpu5_expert5&#45;&gt;aggregate_layer2_gpu5</title>
<path fill="none" stroke="black" d="M6866.7,-9742.28C6849.59,-9732.74 6830.4,-9722.04 6811.46,-9711.48"/>
<polygon fill="black" stroke="black" points="6812.92,-9708.29 6802.48,-9706.47 6809.51,-9714.4 6812.92,-9708.29"/>
</g>
<!-- expert_layer2_gpu6_expert6 -->
<g id="node202" class="node">
<title>expert_layer2_gpu6_expert6</title>
<path fill="lightcoral" stroke="black" d="M7948.5,-9810.35C7948.5,-9810.35 7479.5,-9810.35 7479.5,-9810.35 7473.5,-9810.35 7467.5,-9804.35 7467.5,-9798.35 7467.5,-9798.35 7467.5,-9754.35 7467.5,-9754.35 7467.5,-9748.35 7473.5,-9742.35 7479.5,-9742.35 7479.5,-9742.35 7948.5,-9742.35 7948.5,-9742.35 7954.5,-9742.35 7960.5,-9748.35 7960.5,-9754.35 7960.5,-9754.35 7960.5,-9798.35 7960.5,-9798.35 7960.5,-9804.35 7954.5,-9810.35 7948.5,-9810.35"/>
<text text-anchor="middle" x="7714" y="-9795.15" font-family="Times,serif" font-size="14.00">Expert 6 Layer 2 GPU 6</text>
<text text-anchor="middle" x="7714" y="-9780.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7714" y="-9765.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7714" y="-9750.15" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer2_gpu6 -->
<g id="node225" class="node">
<title>aggregate_layer2_gpu6</title>
<path fill="orange" stroke="black" d="M7849.29,-9706.35C7849.29,-9706.35 7362.19,-9706.35 7362.19,-9706.35 7356.19,-9706.35 7345.52,-9702.58 7340.85,-9698.81 7340.85,-9698.81 7228.06,-9607.88 7228.06,-9607.88 7223.38,-9604.11 7224.71,-9600.35 7230.71,-9600.35 7230.71,-9600.35 7717.81,-9600.35 7717.81,-9600.35 7723.81,-9600.35 7734.48,-9604.11 7739.15,-9607.88 7739.15,-9607.88 7851.94,-9698.81 7851.94,-9698.81 7856.62,-9702.58 7855.29,-9706.35 7849.29,-9706.35"/>
<text text-anchor="middle" x="7540" y="-9664.65" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 2 GPU 6</text>
<text text-anchor="middle" x="7540" y="-9649.65" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="7540" y="-9634.65" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer2_gpu6_expert6&#45;&gt;aggregate_layer2_gpu6 -->
<g id="edge279" class="edge">
<title>expert_layer2_gpu6_expert6&#45;&gt;aggregate_layer2_gpu6</title>
<path fill="none" stroke="black" d="M7666.45,-9742.28C7653.04,-9732.95 7638.04,-9722.52 7623.18,-9712.19"/>
<polygon fill="black" stroke="black" points="7625.17,-9709.31 7614.96,-9706.47 7621.17,-9715.06 7625.17,-9709.31"/>
</g>
<!-- expert_layer2_gpu7_expert7 -->
<g id="node203" class="node">
<title>expert_layer2_gpu7_expert7</title>
<path fill="lightcoral" stroke="black" d="M8576.5,-9810.35C8576.5,-9810.35 8107.5,-9810.35 8107.5,-9810.35 8101.5,-9810.35 8095.5,-9804.35 8095.5,-9798.35 8095.5,-9798.35 8095.5,-9754.35 8095.5,-9754.35 8095.5,-9748.35 8101.5,-9742.35 8107.5,-9742.35 8107.5,-9742.35 8576.5,-9742.35 8576.5,-9742.35 8582.5,-9742.35 8588.5,-9748.35 8588.5,-9754.35 8588.5,-9754.35 8588.5,-9798.35 8588.5,-9798.35 8588.5,-9804.35 8582.5,-9810.35 8576.5,-9810.35"/>
<text text-anchor="middle" x="8342" y="-9795.15" font-family="Times,serif" font-size="14.00">Expert 7 Layer 2 GPU 7</text>
<text text-anchor="middle" x="8342" y="-9780.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8342" y="-9765.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8342" y="-9750.15" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer2_gpu7 -->
<g id="node227" class="node">
<title>aggregate_layer2_gpu7</title>
<path fill="orange" stroke="black" d="M8595.29,-9706.35C8595.29,-9706.35 8108.19,-9706.35 8108.19,-9706.35 8102.19,-9706.35 8091.52,-9702.58 8086.85,-9698.81 8086.85,-9698.81 7974.06,-9607.88 7974.06,-9607.88 7969.38,-9604.11 7970.71,-9600.35 7976.71,-9600.35 7976.71,-9600.35 8463.81,-9600.35 8463.81,-9600.35 8469.81,-9600.35 8480.48,-9604.11 8485.15,-9607.88 8485.15,-9607.88 8597.94,-9698.81 8597.94,-9698.81 8602.62,-9702.58 8601.29,-9706.35 8595.29,-9706.35"/>
<text text-anchor="middle" x="8286" y="-9664.65" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 2 GPU 7</text>
<text text-anchor="middle" x="8286" y="-9649.65" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="8286" y="-9634.65" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer2_gpu7_expert7&#45;&gt;aggregate_layer2_gpu7 -->
<g id="edge280" class="edge">
<title>expert_layer2_gpu7_expert7&#45;&gt;aggregate_layer2_gpu7</title>
<path fill="none" stroke="black" d="M8326.7,-9742.28C8322.86,-9733.99 8318.62,-9724.83 8314.37,-9715.64"/>
<polygon fill="black" stroke="black" points="8317.5,-9714.08 8310.12,-9706.47 8311.15,-9717.02 8317.5,-9714.08"/>
</g>
<!-- expert_layer2_gpu8_expert8 -->
<g id="node204" class="node">
<title>expert_layer2_gpu8_expert8</title>
<path fill="lightcoral" stroke="black" d="M9200.5,-9810.35C9200.5,-9810.35 8731.5,-9810.35 8731.5,-9810.35 8725.5,-9810.35 8719.5,-9804.35 8719.5,-9798.35 8719.5,-9798.35 8719.5,-9754.35 8719.5,-9754.35 8719.5,-9748.35 8725.5,-9742.35 8731.5,-9742.35 8731.5,-9742.35 9200.5,-9742.35 9200.5,-9742.35 9206.5,-9742.35 9212.5,-9748.35 9212.5,-9754.35 9212.5,-9754.35 9212.5,-9798.35 9212.5,-9798.35 9212.5,-9804.35 9206.5,-9810.35 9200.5,-9810.35"/>
<text text-anchor="middle" x="8966" y="-9795.15" font-family="Times,serif" font-size="14.00">Expert 8 Layer 2 GPU 8</text>
<text text-anchor="middle" x="8966" y="-9780.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8966" y="-9765.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8966" y="-9750.15" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer2_gpu8 -->
<g id="node229" class="node">
<title>aggregate_layer2_gpu8</title>
<path fill="orange" stroke="black" d="M9332.29,-9706.35C9332.29,-9706.35 8845.19,-9706.35 8845.19,-9706.35 8839.19,-9706.35 8828.52,-9702.58 8823.85,-9698.81 8823.85,-9698.81 8711.06,-9607.88 8711.06,-9607.88 8706.38,-9604.11 8707.71,-9600.35 8713.71,-9600.35 8713.71,-9600.35 9200.81,-9600.35 9200.81,-9600.35 9206.81,-9600.35 9217.48,-9604.11 9222.15,-9607.88 9222.15,-9607.88 9334.94,-9698.81 9334.94,-9698.81 9339.62,-9702.58 9338.29,-9706.35 9332.29,-9706.35"/>
<text text-anchor="middle" x="9023" y="-9664.65" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 2 GPU 8</text>
<text text-anchor="middle" x="9023" y="-9649.65" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="9023" y="-9634.65" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer2_gpu8_expert8&#45;&gt;aggregate_layer2_gpu8 -->
<g id="edge281" class="edge">
<title>expert_layer2_gpu8_expert8&#45;&gt;aggregate_layer2_gpu8</title>
<path fill="none" stroke="black" d="M8981.58,-9742.28C8985.48,-9733.99 8989.8,-9724.83 8994.13,-9715.64"/>
<polygon fill="black" stroke="black" points="8997.35,-9717.01 8998.44,-9706.47 8991.02,-9714.03 8997.35,-9717.01"/>
</g>
<!-- expert_layer2_gpu9_expert9 -->
<g id="node205" class="node">
<title>expert_layer2_gpu9_expert9</title>
<path fill="lightcoral" stroke="black" d="M9937.5,-9810.35C9937.5,-9810.35 9468.5,-9810.35 9468.5,-9810.35 9462.5,-9810.35 9456.5,-9804.35 9456.5,-9798.35 9456.5,-9798.35 9456.5,-9754.35 9456.5,-9754.35 9456.5,-9748.35 9462.5,-9742.35 9468.5,-9742.35 9468.5,-9742.35 9937.5,-9742.35 9937.5,-9742.35 9943.5,-9742.35 9949.5,-9748.35 9949.5,-9754.35 9949.5,-9754.35 9949.5,-9798.35 9949.5,-9798.35 9949.5,-9804.35 9943.5,-9810.35 9937.5,-9810.35"/>
<text text-anchor="middle" x="9703" y="-9795.15" font-family="Times,serif" font-size="14.00">Expert 9 Layer 2 GPU 9</text>
<text text-anchor="middle" x="9703" y="-9780.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9703" y="-9765.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9703" y="-9750.15" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer2_gpu9 -->
<g id="node231" class="node">
<title>aggregate_layer2_gpu9</title>
<path fill="orange" stroke="black" d="M10182.29,-9706.35C10182.29,-9706.35 9695.19,-9706.35 9695.19,-9706.35 9689.19,-9706.35 9678.52,-9702.58 9673.85,-9698.81 9673.85,-9698.81 9561.06,-9607.88 9561.06,-9607.88 9556.38,-9604.11 9557.71,-9600.35 9563.71,-9600.35 9563.71,-9600.35 10050.81,-9600.35 10050.81,-9600.35 10056.81,-9600.35 10067.48,-9604.11 10072.15,-9607.88 10072.15,-9607.88 10184.94,-9698.81 10184.94,-9698.81 10189.62,-9702.58 10188.29,-9706.35 10182.29,-9706.35"/>
<text text-anchor="middle" x="9873" y="-9664.65" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 2 GPU 9</text>
<text text-anchor="middle" x="9873" y="-9649.65" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="9873" y="-9634.65" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer2_gpu9_expert9&#45;&gt;aggregate_layer2_gpu9 -->
<g id="edge282" class="edge">
<title>expert_layer2_gpu9_expert9&#45;&gt;aggregate_layer2_gpu9</title>
<path fill="none" stroke="black" d="M9749.45,-9742.28C9762.44,-9733.04 9776.94,-9722.72 9791.32,-9712.48"/>
<polygon fill="black" stroke="black" points="9793.65,-9715.12 9799.76,-9706.47 9789.59,-9709.42 9793.65,-9715.12"/>
</g>
<!-- expert_layer2_gpu10_expert10 -->
<g id="node206" class="node">
<title>expert_layer2_gpu10_expert10</title>
<path fill="lightcoral" stroke="black" d="M10700.5,-9810.35C10700.5,-9810.35 10231.5,-9810.35 10231.5,-9810.35 10225.5,-9810.35 10219.5,-9804.35 10219.5,-9798.35 10219.5,-9798.35 10219.5,-9754.35 10219.5,-9754.35 10219.5,-9748.35 10225.5,-9742.35 10231.5,-9742.35 10231.5,-9742.35 10700.5,-9742.35 10700.5,-9742.35 10706.5,-9742.35 10712.5,-9748.35 10712.5,-9754.35 10712.5,-9754.35 10712.5,-9798.35 10712.5,-9798.35 10712.5,-9804.35 10706.5,-9810.35 10700.5,-9810.35"/>
<text text-anchor="middle" x="10466" y="-9795.15" font-family="Times,serif" font-size="14.00">Expert 10 Layer 2 GPU 10</text>
<text text-anchor="middle" x="10466" y="-9780.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10466" y="-9765.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10466" y="-9750.15" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer2_gpu10 -->
<g id="node233" class="node">
<title>aggregate_layer2_gpu10</title>
<path fill="orange" stroke="black" d="M10971.29,-9706.35C10971.29,-9706.35 10484.19,-9706.35 10484.19,-9706.35 10478.19,-9706.35 10467.52,-9702.58 10462.85,-9698.81 10462.85,-9698.81 10350.06,-9607.88 10350.06,-9607.88 10345.38,-9604.11 10346.71,-9600.35 10352.71,-9600.35 10352.71,-9600.35 10839.81,-9600.35 10839.81,-9600.35 10845.81,-9600.35 10856.48,-9604.11 10861.15,-9607.88 10861.15,-9607.88 10973.94,-9698.81 10973.94,-9698.81 10978.62,-9702.58 10977.29,-9706.35 10971.29,-9706.35"/>
<text text-anchor="middle" x="10662" y="-9664.65" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 2 GPU 10</text>
<text text-anchor="middle" x="10662" y="-9649.65" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="10662" y="-9634.65" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer2_gpu10_expert10&#45;&gt;aggregate_layer2_gpu10 -->
<g id="edge283" class="edge">
<title>expert_layer2_gpu10_expert10&#45;&gt;aggregate_layer2_gpu10</title>
<path fill="none" stroke="black" d="M10519.56,-9742.28C10534.81,-9732.87 10551.88,-9722.33 10568.76,-9711.91"/>
<polygon fill="black" stroke="black" points="10570.89,-9714.7 10577.56,-9706.47 10567.22,-9708.75 10570.89,-9714.7"/>
</g>
<!-- expert_layer2_gpu11_expert11 -->
<g id="node207" class="node">
<title>expert_layer2_gpu11_expert11</title>
<path fill="lightcoral" stroke="black" d="M11486.5,-9810.35C11486.5,-9810.35 11017.5,-9810.35 11017.5,-9810.35 11011.5,-9810.35 11005.5,-9804.35 11005.5,-9798.35 11005.5,-9798.35 11005.5,-9754.35 11005.5,-9754.35 11005.5,-9748.35 11011.5,-9742.35 11017.5,-9742.35 11017.5,-9742.35 11486.5,-9742.35 11486.5,-9742.35 11492.5,-9742.35 11498.5,-9748.35 11498.5,-9754.35 11498.5,-9754.35 11498.5,-9798.35 11498.5,-9798.35 11498.5,-9804.35 11492.5,-9810.35 11486.5,-9810.35"/>
<text text-anchor="middle" x="11252" y="-9795.15" font-family="Times,serif" font-size="14.00">Expert 11 Layer 2 GPU 11</text>
<text text-anchor="middle" x="11252" y="-9780.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11252" y="-9765.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11252" y="-9750.15" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer2_gpu11 -->
<g id="node235" class="node">
<title>aggregate_layer2_gpu11</title>
<path fill="orange" stroke="black" d="M11780.29,-9706.35C11780.29,-9706.35 11293.19,-9706.35 11293.19,-9706.35 11287.19,-9706.35 11276.52,-9702.58 11271.85,-9698.81 11271.85,-9698.81 11159.06,-9607.88 11159.06,-9607.88 11154.38,-9604.11 11155.71,-9600.35 11161.71,-9600.35 11161.71,-9600.35 11648.81,-9600.35 11648.81,-9600.35 11654.81,-9600.35 11665.48,-9604.11 11670.15,-9607.88 11670.15,-9607.88 11782.94,-9698.81 11782.94,-9698.81 11787.62,-9702.58 11786.29,-9706.35 11780.29,-9706.35"/>
<text text-anchor="middle" x="11471" y="-9664.65" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 2 GPU 11</text>
<text text-anchor="middle" x="11471" y="-9649.65" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="11471" y="-9634.65" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer2_gpu11_expert11&#45;&gt;aggregate_layer2_gpu11 -->
<g id="edge284" class="edge">
<title>expert_layer2_gpu11_expert11&#45;&gt;aggregate_layer2_gpu11</title>
<path fill="none" stroke="black" d="M11311.84,-9742.28C11329.19,-9732.7 11348.66,-9721.94 11367.86,-9711.33"/>
<polygon fill="black" stroke="black" points="11369.59,-9714.37 11376.65,-9706.47 11366.21,-9708.25 11369.59,-9714.37"/>
</g>
<!-- expert_layer2_gpu12_expert12 -->
<g id="node208" class="node">
<title>expert_layer2_gpu12_expert12</title>
<path fill="lightcoral" stroke="black" d="M12246.5,-9810.35C12246.5,-9810.35 11777.5,-9810.35 11777.5,-9810.35 11771.5,-9810.35 11765.5,-9804.35 11765.5,-9798.35 11765.5,-9798.35 11765.5,-9754.35 11765.5,-9754.35 11765.5,-9748.35 11771.5,-9742.35 11777.5,-9742.35 11777.5,-9742.35 12246.5,-9742.35 12246.5,-9742.35 12252.5,-9742.35 12258.5,-9748.35 12258.5,-9754.35 12258.5,-9754.35 12258.5,-9798.35 12258.5,-9798.35 12258.5,-9804.35 12252.5,-9810.35 12246.5,-9810.35"/>
<text text-anchor="middle" x="12012" y="-9795.15" font-family="Times,serif" font-size="14.00">Expert 12 Layer 2 GPU 12</text>
<text text-anchor="middle" x="12012" y="-9780.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12012" y="-9765.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12012" y="-9750.15" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer2_gpu12 -->
<g id="node237" class="node">
<title>aggregate_layer2_gpu12</title>
<path fill="orange" stroke="black" d="M12515.29,-9706.35C12515.29,-9706.35 12028.19,-9706.35 12028.19,-9706.35 12022.19,-9706.35 12011.52,-9702.58 12006.85,-9698.81 12006.85,-9698.81 11894.06,-9607.88 11894.06,-9607.88 11889.38,-9604.11 11890.71,-9600.35 11896.71,-9600.35 11896.71,-9600.35 12383.81,-9600.35 12383.81,-9600.35 12389.81,-9600.35 12400.48,-9604.11 12405.15,-9607.88 12405.15,-9607.88 12517.94,-9698.81 12517.94,-9698.81 12522.62,-9702.58 12521.29,-9706.35 12515.29,-9706.35"/>
<text text-anchor="middle" x="12206" y="-9664.65" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 2 GPU 12</text>
<text text-anchor="middle" x="12206" y="-9649.65" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="12206" y="-9634.65" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer2_gpu12_expert12&#45;&gt;aggregate_layer2_gpu12 -->
<g id="edge285" class="edge">
<title>expert_layer2_gpu12_expert12&#45;&gt;aggregate_layer2_gpu12</title>
<path fill="none" stroke="black" d="M12065.01,-9742.28C12080.11,-9732.87 12097,-9722.33 12113.71,-9711.91"/>
<polygon fill="black" stroke="black" points="12115.79,-9714.74 12122.42,-9706.47 12112.09,-9708.8 12115.79,-9714.74"/>
</g>
<!-- expert_layer2_gpu13_expert13 -->
<g id="node209" class="node">
<title>expert_layer2_gpu13_expert13</title>
<path fill="lightcoral" stroke="black" d="M12975.5,-9810.35C12975.5,-9810.35 12506.5,-9810.35 12506.5,-9810.35 12500.5,-9810.35 12494.5,-9804.35 12494.5,-9798.35 12494.5,-9798.35 12494.5,-9754.35 12494.5,-9754.35 12494.5,-9748.35 12500.5,-9742.35 12506.5,-9742.35 12506.5,-9742.35 12975.5,-9742.35 12975.5,-9742.35 12981.5,-9742.35 12987.5,-9748.35 12987.5,-9754.35 12987.5,-9754.35 12987.5,-9798.35 12987.5,-9798.35 12987.5,-9804.35 12981.5,-9810.35 12975.5,-9810.35"/>
<text text-anchor="middle" x="12741" y="-9795.15" font-family="Times,serif" font-size="14.00">Expert 13 Layer 2 GPU 13</text>
<text text-anchor="middle" x="12741" y="-9780.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12741" y="-9765.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12741" y="-9750.15" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer2_gpu13 -->
<g id="node239" class="node">
<title>aggregate_layer2_gpu13</title>
<path fill="orange" stroke="black" d="M13213.29,-9706.35C13213.29,-9706.35 12726.19,-9706.35 12726.19,-9706.35 12720.19,-9706.35 12709.52,-9702.58 12704.85,-9698.81 12704.85,-9698.81 12592.06,-9607.88 12592.06,-9607.88 12587.38,-9604.11 12588.71,-9600.35 12594.71,-9600.35 12594.71,-9600.35 13081.81,-9600.35 13081.81,-9600.35 13087.81,-9600.35 13098.48,-9604.11 13103.15,-9607.88 13103.15,-9607.88 13215.94,-9698.81 13215.94,-9698.81 13220.62,-9702.58 13219.29,-9706.35 13213.29,-9706.35"/>
<text text-anchor="middle" x="12904" y="-9664.65" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 2 GPU 13</text>
<text text-anchor="middle" x="12904" y="-9649.65" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="12904" y="-9634.65" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer2_gpu13_expert13&#45;&gt;aggregate_layer2_gpu13 -->
<g id="edge286" class="edge">
<title>expert_layer2_gpu13_expert13&#45;&gt;aggregate_layer2_gpu13</title>
<path fill="none" stroke="black" d="M12785.54,-9742.28C12797.99,-9733.04 12811.9,-9722.72 12825.69,-9712.48"/>
<polygon fill="black" stroke="black" points="12827.84,-9715.24 12833.78,-9706.47 12823.66,-9709.62 12827.84,-9715.24"/>
</g>
<!-- expert_layer2_gpu14_expert14 -->
<g id="node210" class="node">
<title>expert_layer2_gpu14_expert14</title>
<path fill="lightcoral" stroke="black" d="M13680.5,-9810.35C13680.5,-9810.35 13211.5,-9810.35 13211.5,-9810.35 13205.5,-9810.35 13199.5,-9804.35 13199.5,-9798.35 13199.5,-9798.35 13199.5,-9754.35 13199.5,-9754.35 13199.5,-9748.35 13205.5,-9742.35 13211.5,-9742.35 13211.5,-9742.35 13680.5,-9742.35 13680.5,-9742.35 13686.5,-9742.35 13692.5,-9748.35 13692.5,-9754.35 13692.5,-9754.35 13692.5,-9798.35 13692.5,-9798.35 13692.5,-9804.35 13686.5,-9810.35 13680.5,-9810.35"/>
<text text-anchor="middle" x="13446" y="-9795.15" font-family="Times,serif" font-size="14.00">Expert 14 Layer 2 GPU 14</text>
<text text-anchor="middle" x="13446" y="-9780.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="13446" y="-9765.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="13446" y="-9750.15" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer2_gpu14 -->
<g id="node241" class="node">
<title>aggregate_layer2_gpu14</title>
<path fill="orange" stroke="black" d="M13893.29,-9706.35C13893.29,-9706.35 13406.19,-9706.35 13406.19,-9706.35 13400.19,-9706.35 13389.52,-9702.58 13384.85,-9698.81 13384.85,-9698.81 13272.06,-9607.88 13272.06,-9607.88 13267.38,-9604.11 13268.71,-9600.35 13274.71,-9600.35 13274.71,-9600.35 13761.81,-9600.35 13761.81,-9600.35 13767.81,-9600.35 13778.48,-9604.11 13783.15,-9607.88 13783.15,-9607.88 13895.94,-9698.81 13895.94,-9698.81 13900.62,-9702.58 13899.29,-9706.35 13893.29,-9706.35"/>
<text text-anchor="middle" x="13584" y="-9664.65" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 2 GPU 14</text>
<text text-anchor="middle" x="13584" y="-9649.65" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="13584" y="-9634.65" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer2_gpu14_expert14&#45;&gt;aggregate_layer2_gpu14 -->
<g id="edge287" class="edge">
<title>expert_layer2_gpu14_expert14&#45;&gt;aggregate_layer2_gpu14</title>
<path fill="none" stroke="black" d="M13483.71,-9742.28C13493.95,-9733.3 13505.37,-9723.29 13516.72,-9713.34"/>
<polygon fill="black" stroke="black" points="13519.34,-9715.7 13524.55,-9706.47 13514.72,-9710.43 13519.34,-9715.7"/>
</g>
<!-- expert_layer2_gpu15_expert15 -->
<g id="node211" class="node">
<title>expert_layer2_gpu15_expert15</title>
<path fill="lightcoral" stroke="black" d="M14367.5,-9810.35C14367.5,-9810.35 13898.5,-9810.35 13898.5,-9810.35 13892.5,-9810.35 13886.5,-9804.35 13886.5,-9798.35 13886.5,-9798.35 13886.5,-9754.35 13886.5,-9754.35 13886.5,-9748.35 13892.5,-9742.35 13898.5,-9742.35 13898.5,-9742.35 14367.5,-9742.35 14367.5,-9742.35 14373.5,-9742.35 14379.5,-9748.35 14379.5,-9754.35 14379.5,-9754.35 14379.5,-9798.35 14379.5,-9798.35 14379.5,-9804.35 14373.5,-9810.35 14367.5,-9810.35"/>
<text text-anchor="middle" x="14133" y="-9795.15" font-family="Times,serif" font-size="14.00">Expert 15 Layer 2 GPU 15</text>
<text text-anchor="middle" x="14133" y="-9780.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14133" y="-9765.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14133" y="-9750.15" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer2_gpu15 -->
<g id="node243" class="node">
<title>aggregate_layer2_gpu15</title>
<path fill="orange" stroke="black" d="M14563.29,-9706.35C14563.29,-9706.35 14076.19,-9706.35 14076.19,-9706.35 14070.19,-9706.35 14059.52,-9702.58 14054.85,-9698.81 14054.85,-9698.81 13942.06,-9607.88 13942.06,-9607.88 13937.38,-9604.11 13938.71,-9600.35 13944.71,-9600.35 13944.71,-9600.35 14431.81,-9600.35 14431.81,-9600.35 14437.81,-9600.35 14448.48,-9604.11 14453.15,-9607.88 14453.15,-9607.88 14565.94,-9698.81 14565.94,-9698.81 14570.62,-9702.58 14569.29,-9706.35 14563.29,-9706.35"/>
<text text-anchor="middle" x="14254" y="-9664.65" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 2 GPU 15</text>
<text text-anchor="middle" x="14254" y="-9649.65" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="14254" y="-9634.65" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer2_gpu15_expert15&#45;&gt;aggregate_layer2_gpu15 -->
<g id="edge288" class="edge">
<title>expert_layer2_gpu15_expert15&#45;&gt;aggregate_layer2_gpu15</title>
<path fill="none" stroke="black" d="M14166.06,-9742.28C14174.96,-9733.39 14184.86,-9723.49 14194.72,-9713.63"/>
<polygon fill="black" stroke="black" points="14197.28,-9716.02 14201.87,-9706.47 14192.33,-9711.07 14197.28,-9716.02"/>
</g>
<!-- comm_layer2 -->
<g id="node244" class="node">
<title>comm_layer2</title>
<ellipse fill="lightpink" stroke="black" cx="8654" cy="-9883.82" rx="243.49" ry="37.45"/>
<text text-anchor="middle" x="8654" y="-9895.12" font-family="Times,serif" font-size="14.00">Cross&#45;GPU Communication Layer 2</text>
<text text-anchor="middle" x="8654" y="-9880.12" font-family="Times,serif" font-size="14.00">Input: Tokens from routing decisions</text>
<text text-anchor="middle" x="8654" y="-9865.12" font-family="Times,serif" font-size="14.00">Output: Tokens delivered to destination GPUs</text>
</g>
<!-- route_layer2_gpu0&#45;&gt;comm_layer2 -->
<g id="edge241" class="edge">
<title>route_layer2_gpu0&#45;&gt;comm_layer2</title>
<path fill="none" stroke="black" d="M1996.65,-9980.2C2076.89,-9971.14 2167.82,-9962.25 2251,-9957.3 3478.93,-9884.28 7368.69,-9883.35 8400.64,-9884.43"/>
<polygon fill="black" stroke="black" points="8400.78,-9887.93 8410.78,-9884.44 8400.79,-9880.93 8400.78,-9887.93"/>
</g>
<!-- mha_layer3_gpu0 -->
<g id="node245" class="node">
<title>mha_layer3_gpu0</title>
<path fill="lightblue" stroke="black" d="M1834,-9564.35C1834,-9564.35 1386,-9564.35 1386,-9564.35 1380,-9564.35 1374,-9558.35 1374,-9552.35 1374,-9552.35 1374,-9523.35 1374,-9523.35 1374,-9517.35 1380,-9511.35 1386,-9511.35 1386,-9511.35 1834,-9511.35 1834,-9511.35 1840,-9511.35 1846,-9517.35 1846,-9523.35 1846,-9523.35 1846,-9552.35 1846,-9552.35 1846,-9558.35 1840,-9564.35 1834,-9564.35"/>
<text text-anchor="middle" x="1610" y="-9549.15" font-family="Times,serif" font-size="14.00">MHA Layer 3 GPU 0</text>
<text text-anchor="middle" x="1610" y="-9534.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1610" y="-9519.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer2_gpu0&#45;&gt;mha_layer3_gpu0 -->
<g id="edge289" class="edge">
<title>aggregate_layer2_gpu0&#45;&gt;mha_layer3_gpu0</title>
<path fill="none" stroke="black" d="M1691.69,-9600.25C1678.21,-9590.11 1664.46,-9579.78 1652.19,-9570.56"/>
<polygon fill="black" stroke="black" points="1654.04,-9567.57 1643.94,-9564.36 1649.83,-9573.17 1654.04,-9567.57"/>
</g>
<!-- route_layer2_gpu1&#45;&gt;comm_layer2 -->
<g id="edge242" class="edge">
<title>route_layer2_gpu1&#45;&gt;comm_layer2</title>
<path fill="none" stroke="black" d="M2830.88,-9986.77C2955.15,-9975.85 3110.19,-9963.74 3249,-9957.3 4271.3,-9909.86 7474.91,-9890.65 8400.96,-9886"/>
<polygon fill="black" stroke="black" points="8401.09,-9889.5 8411.07,-9885.95 8401.06,-9882.5 8401.09,-9889.5"/>
</g>
<!-- mha_layer3_gpu1 -->
<g id="node246" class="node">
<title>mha_layer3_gpu1</title>
<path fill="lightblue" stroke="black" d="M2646,-9564.35C2646,-9564.35 2198,-9564.35 2198,-9564.35 2192,-9564.35 2186,-9558.35 2186,-9552.35 2186,-9552.35 2186,-9523.35 2186,-9523.35 2186,-9517.35 2192,-9511.35 2198,-9511.35 2198,-9511.35 2646,-9511.35 2646,-9511.35 2652,-9511.35 2658,-9517.35 2658,-9523.35 2658,-9523.35 2658,-9552.35 2658,-9552.35 2658,-9558.35 2652,-9564.35 2646,-9564.35"/>
<text text-anchor="middle" x="2422" y="-9549.15" font-family="Times,serif" font-size="14.00">MHA Layer 3 GPU 1</text>
<text text-anchor="middle" x="2422" y="-9534.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2422" y="-9519.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer2_gpu1&#45;&gt;mha_layer3_gpu1 -->
<g id="edge290" class="edge">
<title>aggregate_layer2_gpu1&#45;&gt;mha_layer3_gpu1</title>
<path fill="none" stroke="black" d="M2503.69,-9600.25C2490.21,-9590.11 2476.46,-9579.78 2464.19,-9570.56"/>
<polygon fill="black" stroke="black" points="2466.04,-9567.57 2455.94,-9564.36 2461.83,-9573.17 2466.04,-9567.57"/>
</g>
<!-- route_layer2_gpu2&#45;&gt;comm_layer2 -->
<g id="edge243" class="edge">
<title>route_layer2_gpu2&#45;&gt;comm_layer2</title>
<path fill="none" stroke="black" d="M3826.2,-9984.71C3933.52,-9974.39 4062.6,-9963.4 4179,-9957.3 5009.92,-9913.76 7582.6,-9892.34 8401.16,-9886.51"/>
<polygon fill="black" stroke="black" points="8401.33,-9890.01 8411.31,-9886.44 8401.28,-9883.01 8401.33,-9890.01"/>
</g>
<!-- mha_layer3_gpu2 -->
<g id="node247" class="node">
<title>mha_layer3_gpu2</title>
<path fill="lightblue" stroke="black" d="M3620,-9564.35C3620,-9564.35 3172,-9564.35 3172,-9564.35 3166,-9564.35 3160,-9558.35 3160,-9552.35 3160,-9552.35 3160,-9523.35 3160,-9523.35 3160,-9517.35 3166,-9511.35 3172,-9511.35 3172,-9511.35 3620,-9511.35 3620,-9511.35 3626,-9511.35 3632,-9517.35 3632,-9523.35 3632,-9523.35 3632,-9552.35 3632,-9552.35 3632,-9558.35 3626,-9564.35 3620,-9564.35"/>
<text text-anchor="middle" x="3396" y="-9549.15" font-family="Times,serif" font-size="14.00">MHA Layer 3 GPU 2</text>
<text text-anchor="middle" x="3396" y="-9534.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3396" y="-9519.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer2_gpu2&#45;&gt;mha_layer3_gpu2 -->
<g id="edge291" class="edge">
<title>aggregate_layer2_gpu2&#45;&gt;mha_layer3_gpu2</title>
<path fill="none" stroke="black" d="M3488.51,-9600.25C3472.95,-9589.92 3457.08,-9579.39 3442.97,-9570.02"/>
<polygon fill="black" stroke="black" points="3444.71,-9566.97 3434.44,-9564.36 3440.84,-9572.81 3444.71,-9566.97"/>
</g>
<!-- route_layer2_gpu3&#45;&gt;comm_layer2 -->
<g id="edge244" class="edge">
<title>route_layer2_gpu3&#45;&gt;comm_layer2</title>
<path fill="none" stroke="black" d="M4766.75,-9992.81C4946.86,-9981.19 5198.11,-9966.18 5419,-9957.3 6529.81,-9912.64 7856.36,-9893.72 8401.34,-9887.43"/>
<polygon fill="black" stroke="black" points="8401.73,-9890.92 8411.69,-9887.31 8401.65,-9883.92 8401.73,-9890.92"/>
</g>
<!-- mha_layer3_gpu3 -->
<g id="node248" class="node">
<title>mha_layer3_gpu3</title>
<path fill="lightblue" stroke="black" d="M4541,-9564.35C4541,-9564.35 4093,-9564.35 4093,-9564.35 4087,-9564.35 4081,-9558.35 4081,-9552.35 4081,-9552.35 4081,-9523.35 4081,-9523.35 4081,-9517.35 4087,-9511.35 4093,-9511.35 4093,-9511.35 4541,-9511.35 4541,-9511.35 4547,-9511.35 4553,-9517.35 4553,-9523.35 4553,-9523.35 4553,-9552.35 4553,-9552.35 4553,-9558.35 4547,-9564.35 4541,-9564.35"/>
<text text-anchor="middle" x="4317" y="-9549.15" font-family="Times,serif" font-size="14.00">MHA Layer 3 GPU 3</text>
<text text-anchor="middle" x="4317" y="-9534.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4317" y="-9519.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer2_gpu3&#45;&gt;mha_layer3_gpu3 -->
<g id="edge292" class="edge">
<title>aggregate_layer2_gpu3&#45;&gt;mha_layer3_gpu3</title>
<path fill="none" stroke="black" d="M4342.97,-9600.25C4339.18,-9591.28 4335.32,-9582.16 4331.78,-9573.79"/>
<polygon fill="black" stroke="black" points="4334.91,-9572.21 4327.79,-9564.36 4328.46,-9574.93 4334.91,-9572.21"/>
</g>
<!-- route_layer2_gpu4&#45;&gt;comm_layer2 -->
<g id="edge245" class="edge">
<title>route_layer2_gpu4&#45;&gt;comm_layer2</title>
<path fill="none" stroke="black" d="M5998.69,-9986.64C6114.38,-9976.26 6255.89,-9964.65 6383,-9957.3 7115.69,-9914.91 7982.91,-9895.85 8402.11,-9888.61"/>
<polygon fill="black" stroke="black" points="8402.3,-9892.1 8412.24,-9888.43 8402.18,-9885.1 8402.3,-9892.1"/>
</g>
<!-- mha_layer3_gpu4 -->
<g id="node249" class="node">
<title>mha_layer3_gpu4</title>
<path fill="lightblue" stroke="black" d="M5694,-9564.35C5694,-9564.35 5246,-9564.35 5246,-9564.35 5240,-9564.35 5234,-9558.35 5234,-9552.35 5234,-9552.35 5234,-9523.35 5234,-9523.35 5234,-9517.35 5240,-9511.35 5246,-9511.35 5246,-9511.35 5694,-9511.35 5694,-9511.35 5700,-9511.35 5706,-9517.35 5706,-9523.35 5706,-9523.35 5706,-9552.35 5706,-9552.35 5706,-9558.35 5700,-9564.35 5694,-9564.35"/>
<text text-anchor="middle" x="5470" y="-9549.15" font-family="Times,serif" font-size="14.00">MHA Layer 3 GPU 4</text>
<text text-anchor="middle" x="5470" y="-9534.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5470" y="-9519.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer2_gpu4&#45;&gt;mha_layer3_gpu4 -->
<g id="edge293" class="edge">
<title>aggregate_layer2_gpu4&#45;&gt;mha_layer3_gpu4</title>
<path fill="none" stroke="black" d="M5598.21,-9600.25C5575.63,-9589.43 5552.57,-9578.39 5532.35,-9568.71"/>
<polygon fill="black" stroke="black" points="5533.81,-9565.52 5523.28,-9564.36 5530.78,-9571.84 5533.81,-9565.52"/>
</g>
<!-- route_layer2_gpu5&#45;&gt;comm_layer2 -->
<g id="edge246" class="edge">
<title>route_layer2_gpu5&#45;&gt;comm_layer2</title>
<path fill="none" stroke="black" d="M6956.6,-9981.81C7036.41,-9972.98 7126.56,-9963.81 7209,-9957.3 7629.08,-9924.13 8119.13,-9903.31 8407.04,-9892.9"/>
<polygon fill="black" stroke="black" points="8407.33,-9896.39 8417.2,-9892.53 8407.08,-9889.39 8407.33,-9896.39"/>
</g>
<!-- mha_layer3_gpu5 -->
<g id="node250" class="node">
<title>mha_layer3_gpu5</title>
<path fill="lightblue" stroke="black" d="M6677,-9564.35C6677,-9564.35 6229,-9564.35 6229,-9564.35 6223,-9564.35 6217,-9558.35 6217,-9552.35 6217,-9552.35 6217,-9523.35 6217,-9523.35 6217,-9517.35 6223,-9511.35 6229,-9511.35 6229,-9511.35 6677,-9511.35 6677,-9511.35 6683,-9511.35 6689,-9517.35 6689,-9523.35 6689,-9523.35 6689,-9552.35 6689,-9552.35 6689,-9558.35 6683,-9564.35 6677,-9564.35"/>
<text text-anchor="middle" x="6453" y="-9549.15" font-family="Times,serif" font-size="14.00">MHA Layer 3 GPU 5</text>
<text text-anchor="middle" x="6453" y="-9534.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6453" y="-9519.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer2_gpu5&#45;&gt;mha_layer3_gpu5 -->
<g id="edge294" class="edge">
<title>aggregate_layer2_gpu5&#45;&gt;mha_layer3_gpu5</title>
<path fill="none" stroke="black" d="M6591.49,-9600.25C6566.88,-9589.33 6541.74,-9578.19 6519.76,-9568.45"/>
<polygon fill="black" stroke="black" points="6521.11,-9565.21 6510.55,-9564.36 6518.27,-9571.61 6521.11,-9565.21"/>
</g>
<!-- route_layer2_gpu6&#45;&gt;comm_layer2 -->
<g id="edge247" class="edge">
<title>route_layer2_gpu6&#45;&gt;comm_layer2</title>
<path fill="none" stroke="black" d="M7780.12,-9979.86C7840.5,-9972.27 7905.7,-9964.27 7966,-9957.3 8125.76,-9938.83 8306.61,-9919.85 8442.79,-9905.95"/>
<polygon fill="black" stroke="black" points="8443.34,-9909.42 8452.93,-9904.92 8442.63,-9902.45 8443.34,-9909.42"/>
</g>
<!-- mha_layer3_gpu6 -->
<g id="node251" class="node">
<title>mha_layer3_gpu6</title>
<path fill="lightblue" stroke="black" d="M7613,-9564.35C7613,-9564.35 7165,-9564.35 7165,-9564.35 7159,-9564.35 7153,-9558.35 7153,-9552.35 7153,-9552.35 7153,-9523.35 7153,-9523.35 7153,-9517.35 7159,-9511.35 7165,-9511.35 7165,-9511.35 7613,-9511.35 7613,-9511.35 7619,-9511.35 7625,-9517.35 7625,-9523.35 7625,-9523.35 7625,-9552.35 7625,-9552.35 7625,-9558.35 7619,-9564.35 7613,-9564.35"/>
<text text-anchor="middle" x="7389" y="-9549.15" font-family="Times,serif" font-size="14.00">MHA Layer 3 GPU 6</text>
<text text-anchor="middle" x="7389" y="-9534.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7389" y="-9519.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer2_gpu6&#45;&gt;mha_layer3_gpu6 -->
<g id="edge295" class="edge">
<title>aggregate_layer2_gpu6&#45;&gt;mha_layer3_gpu6</title>
<path fill="none" stroke="black" d="M7470.69,-9600.25C7457.21,-9590.11 7443.46,-9579.78 7431.19,-9570.56"/>
<polygon fill="black" stroke="black" points="7433.04,-9567.57 7422.94,-9564.36 7428.83,-9573.17 7433.04,-9567.57"/>
</g>
<!-- route_layer2_gpu7&#45;&gt;comm_layer2 -->
<g id="edge248" class="edge">
<title>route_layer2_gpu7&#45;&gt;comm_layer2</title>
<path fill="none" stroke="black" d="M8453.89,-9957.23C8486.54,-9945.42 8520.57,-9933.1 8551.12,-9922.05"/>
<polygon fill="black" stroke="black" points="8552.69,-9925.2 8560.91,-9918.51 8550.31,-9918.62 8552.69,-9925.2"/>
</g>
<!-- mha_layer3_gpu7 -->
<g id="node252" class="node">
<title>mha_layer3_gpu7</title>
<path fill="lightblue" stroke="black" d="M8359,-9564.35C8359,-9564.35 7911,-9564.35 7911,-9564.35 7905,-9564.35 7899,-9558.35 7899,-9552.35 7899,-9552.35 7899,-9523.35 7899,-9523.35 7899,-9517.35 7905,-9511.35 7911,-9511.35 7911,-9511.35 8359,-9511.35 8359,-9511.35 8365,-9511.35 8371,-9517.35 8371,-9523.35 8371,-9523.35 8371,-9552.35 8371,-9552.35 8371,-9558.35 8365,-9564.35 8359,-9564.35"/>
<text text-anchor="middle" x="8135" y="-9549.15" font-family="Times,serif" font-size="14.00">MHA Layer 3 GPU 7</text>
<text text-anchor="middle" x="8135" y="-9534.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8135" y="-9519.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer2_gpu7&#45;&gt;mha_layer3_gpu7 -->
<g id="edge296" class="edge">
<title>aggregate_layer2_gpu7&#45;&gt;mha_layer3_gpu7</title>
<path fill="none" stroke="black" d="M8216.69,-9600.25C8203.21,-9590.11 8189.46,-9579.78 8177.19,-9570.56"/>
<polygon fill="black" stroke="black" points="8179.04,-9567.57 8168.94,-9564.36 8174.83,-9573.17 8179.04,-9567.57"/>
</g>
<!-- route_layer2_gpu8&#45;&gt;comm_layer2 -->
<g id="edge249" class="edge">
<title>route_layer2_gpu8&#45;&gt;comm_layer2</title>
<path fill="none" stroke="black" d="M8934.38,-9957.23C8884.27,-9944.29 8831.83,-9930.75 8786.03,-9918.92"/>
<polygon fill="black" stroke="black" points="8786.62,-9915.46 8776.06,-9916.35 8784.87,-9922.24 8786.62,-9915.46"/>
</g>
<!-- mha_layer3_gpu8 -->
<g id="node253" class="node">
<title>mha_layer3_gpu8</title>
<path fill="lightblue" stroke="black" d="M9282,-9564.35C9282,-9564.35 8834,-9564.35 8834,-9564.35 8828,-9564.35 8822,-9558.35 8822,-9552.35 8822,-9552.35 8822,-9523.35 8822,-9523.35 8822,-9517.35 8828,-9511.35 8834,-9511.35 8834,-9511.35 9282,-9511.35 9282,-9511.35 9288,-9511.35 9294,-9517.35 9294,-9523.35 9294,-9523.35 9294,-9552.35 9294,-9552.35 9294,-9558.35 9288,-9564.35 9282,-9564.35"/>
<text text-anchor="middle" x="9058" y="-9549.15" font-family="Times,serif" font-size="14.00">MHA Layer 3 GPU 8</text>
<text text-anchor="middle" x="9058" y="-9534.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9058" y="-9519.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer2_gpu8&#45;&gt;mha_layer3_gpu8 -->
<g id="edge297" class="edge">
<title>aggregate_layer2_gpu8&#45;&gt;mha_layer3_gpu8</title>
<path fill="none" stroke="black" d="M9039.07,-9600.25C9041.8,-9591.38 9044.58,-9582.36 9047.14,-9574.06"/>
<polygon fill="black" stroke="black" points="9050.53,-9574.95 9050.13,-9564.36 9043.84,-9572.88 9050.53,-9574.95"/>
</g>
<!-- route_layer2_gpu9&#45;&gt;comm_layer2 -->
<g id="edge250" class="edge">
<title>route_layer2_gpu9&#45;&gt;comm_layer2</title>
<path fill="none" stroke="black" d="M9725.73,-9980.13C9645.78,-9972.59 9559.66,-9964.55 9480,-9957.3 9274.63,-9938.6 9040.46,-9918.13 8874.03,-9903.73"/>
<polygon fill="black" stroke="black" points="8873.93,-9900.21 8863.67,-9902.84 8873.33,-9907.19 8873.93,-9900.21"/>
</g>
<!-- mha_layer3_gpu9 -->
<g id="node254" class="node">
<title>mha_layer3_gpu9</title>
<path fill="lightblue" stroke="black" d="M10221,-9564.35C10221,-9564.35 9773,-9564.35 9773,-9564.35 9767,-9564.35 9761,-9558.35 9761,-9552.35 9761,-9552.35 9761,-9523.35 9761,-9523.35 9761,-9517.35 9767,-9511.35 9773,-9511.35 9773,-9511.35 10221,-9511.35 10221,-9511.35 10227,-9511.35 10233,-9517.35 10233,-9523.35 10233,-9523.35 10233,-9552.35 10233,-9552.35 10233,-9558.35 10227,-9564.35 10221,-9564.35"/>
<text text-anchor="middle" x="9997" y="-9549.15" font-family="Times,serif" font-size="14.00">MHA Layer 3 GPU 9</text>
<text text-anchor="middle" x="9997" y="-9534.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9997" y="-9519.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer2_gpu9&#45;&gt;mha_layer3_gpu9 -->
<g id="edge298" class="edge">
<title>aggregate_layer2_gpu9&#45;&gt;mha_layer3_gpu9</title>
<path fill="none" stroke="black" d="M9929.92,-9600.25C9940.67,-9590.41 9951.63,-9580.38 9961.48,-9571.36"/>
<polygon fill="black" stroke="black" points="9964.11,-9573.69 9969.13,-9564.36 9959.39,-9568.53 9964.11,-9573.69"/>
</g>
<!-- route_layer2_gpu10&#45;&gt;comm_layer2 -->
<g id="edge251" class="edge">
<title>route_layer2_gpu10&#45;&gt;comm_layer2</title>
<path fill="none" stroke="black" d="M10653.56,-9979.35C10563.85,-9971.32 10465.55,-9963.23 10375,-9957.3 9851.68,-9923.04 9237.71,-9901.71 8902.88,-9891.67"/>
<polygon fill="black" stroke="black" points="8902.67,-9888.16 8892.57,-9891.36 8902.46,-9895.16 8902.67,-9888.16"/>
</g>
<!-- mha_layer3_gpu10 -->
<g id="node255" class="node">
<title>mha_layer3_gpu10</title>
<path fill="lightblue" stroke="black" d="M10948,-9564.35C10948,-9564.35 10500,-9564.35 10500,-9564.35 10494,-9564.35 10488,-9558.35 10488,-9552.35 10488,-9552.35 10488,-9523.35 10488,-9523.35 10488,-9517.35 10494,-9511.35 10500,-9511.35 10500,-9511.35 10948,-9511.35 10948,-9511.35 10954,-9511.35 10960,-9517.35 10960,-9523.35 10960,-9523.35 10960,-9552.35 10960,-9552.35 10960,-9558.35 10954,-9564.35 10948,-9564.35"/>
<text text-anchor="middle" x="10724" y="-9549.15" font-family="Times,serif" font-size="14.00">MHA Layer 3 GPU 10</text>
<text text-anchor="middle" x="10724" y="-9534.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10724" y="-9519.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer2_gpu10&#45;&gt;mha_layer3_gpu10 -->
<g id="edge299" class="edge">
<title>aggregate_layer2_gpu10&#45;&gt;mha_layer3_gpu10</title>
<path fill="none" stroke="black" d="M10690.46,-9600.25C10695.46,-9591.09 10700.55,-9581.77 10705.21,-9573.25"/>
<polygon fill="black" stroke="black" points="10708.34,-9574.81 10710.06,-9564.36 10702.2,-9571.46 10708.34,-9574.81"/>
</g>
<!-- route_layer2_gpu11&#45;&gt;comm_layer2 -->
<g id="edge252" class="edge">
<title>route_layer2_gpu11&#45;&gt;comm_layer2</title>
<path fill="none" stroke="black" d="M11600.49,-9979.36C11505.54,-9971.03 11400.51,-9962.78 11304,-9957.3 10424.29,-9907.38 9378.29,-9891.59 8906.71,-9886.8"/>
<polygon fill="black" stroke="black" points="8906.75,-9883.3 8896.71,-9886.7 8906.68,-9890.3 8906.75,-9883.3"/>
</g>
<!-- mha_layer3_gpu11 -->
<g id="node256" class="node">
<title>mha_layer3_gpu11</title>
<path fill="lightblue" stroke="black" d="M12207,-9564.35C12207,-9564.35 11759,-9564.35 11759,-9564.35 11753,-9564.35 11747,-9558.35 11747,-9552.35 11747,-9552.35 11747,-9523.35 11747,-9523.35 11747,-9517.35 11753,-9511.35 11759,-9511.35 11759,-9511.35 12207,-9511.35 12207,-9511.35 12213,-9511.35 12219,-9517.35 12219,-9523.35 12219,-9523.35 12219,-9552.35 12219,-9552.35 12219,-9558.35 12213,-9564.35 12207,-9564.35"/>
<text text-anchor="middle" x="11983" y="-9549.15" font-family="Times,serif" font-size="14.00">MHA Layer 3 GPU 11</text>
<text text-anchor="middle" x="11983" y="-9534.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11983" y="-9519.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer2_gpu11&#45;&gt;mha_layer3_gpu11 -->
<g id="edge300" class="edge">
<title>aggregate_layer2_gpu11&#45;&gt;mha_layer3_gpu11</title>
<path fill="none" stroke="black" d="M11670.79,-9608.06C11733.79,-9594.09 11801.58,-9579.06 11857.83,-9566.59"/>
<polygon fill="black" stroke="black" points="11858.83,-9569.96 11867.84,-9564.38 11857.32,-9563.12 11858.83,-9569.96"/>
</g>
<!-- route_layer2_gpu12&#45;&gt;comm_layer2 -->
<g id="edge253" class="edge">
<title>route_layer2_gpu12&#45;&gt;comm_layer2</title>
<path fill="none" stroke="black" d="M12555.35,-9979.29C12458.12,-9970.83 12350.14,-9962.51 12251,-9957.3 10997.64,-9891.41 9495.73,-9884.3 8907.66,-9884.29"/>
<polygon fill="black" stroke="black" points="8907.36,-9880.79 8897.36,-9884.3 8907.36,-9887.79 8907.36,-9880.79"/>
</g>
<!-- mha_layer3_gpu12 -->
<g id="node257" class="node">
<title>mha_layer3_gpu12</title>
<path fill="lightblue" stroke="black" d="M12864,-9564.35C12864,-9564.35 12416,-9564.35 12416,-9564.35 12410,-9564.35 12404,-9558.35 12404,-9552.35 12404,-9552.35 12404,-9523.35 12404,-9523.35 12404,-9517.35 12410,-9511.35 12416,-9511.35 12416,-9511.35 12864,-9511.35 12864,-9511.35 12870,-9511.35 12876,-9517.35 12876,-9523.35 12876,-9523.35 12876,-9552.35 12876,-9552.35 12876,-9558.35 12870,-9564.35 12864,-9564.35"/>
<text text-anchor="middle" x="12640" y="-9549.15" font-family="Times,serif" font-size="14.00">MHA Layer 3 GPU 12</text>
<text text-anchor="middle" x="12640" y="-9534.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12640" y="-9519.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer2_gpu12&#45;&gt;mha_layer3_gpu12 -->
<g id="edge301" class="edge">
<title>aggregate_layer2_gpu12&#45;&gt;mha_layer3_gpu12</title>
<path fill="none" stroke="black" d="M12398.25,-9602.07C12444.34,-9590.02 12491.93,-9577.57 12532.56,-9566.94"/>
<polygon fill="black" stroke="black" points="12533.68,-9570.27 12542.47,-9564.35 12531.91,-9563.5 12533.68,-9570.27"/>
</g>
<!-- route_layer2_gpu13&#45;&gt;comm_layer2 -->
<g id="edge254" class="edge">
<title>route_layer2_gpu13&#45;&gt;comm_layer2</title>
<path fill="none" stroke="black" d="M13515.61,-9979.28C13416.87,-9970.72 13306.89,-9962.36 13206,-9957.3 12359.33,-9914.87 9735.43,-9892.66 8907.2,-9886.57"/>
<polygon fill="black" stroke="black" points="8906.96,-9883.07 8896.94,-9886.5 8906.91,-9890.07 8906.96,-9883.07"/>
</g>
<!-- mha_layer3_gpu13 -->
<g id="node258" class="node">
<title>mha_layer3_gpu13</title>
<path fill="lightblue" stroke="black" d="M13437,-9564.35C13437,-9564.35 12989,-9564.35 12989,-9564.35 12983,-9564.35 12977,-9558.35 12977,-9552.35 12977,-9552.35 12977,-9523.35 12977,-9523.35 12977,-9517.35 12983,-9511.35 12989,-9511.35 12989,-9511.35 13437,-9511.35 13437,-9511.35 13443,-9511.35 13449,-9517.35 13449,-9523.35 13449,-9523.35 13449,-9552.35 13449,-9552.35 13449,-9558.35 13443,-9564.35 13437,-9564.35"/>
<text text-anchor="middle" x="13213" y="-9549.15" font-family="Times,serif" font-size="14.00">MHA Layer 3 GPU 13</text>
<text text-anchor="middle" x="13213" y="-9534.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13213" y="-9519.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer2_gpu13&#45;&gt;mha_layer3_gpu13 -->
<g id="edge302" class="edge">
<title>aggregate_layer2_gpu13&#45;&gt;mha_layer3_gpu13</title>
<path fill="none" stroke="black" d="M13045.84,-9600.25C13076.08,-9589.14 13106.97,-9577.79 13133.83,-9567.93"/>
<polygon fill="black" stroke="black" points="13135.36,-9571.09 13143.54,-9564.36 13132.95,-9564.52 13135.36,-9571.09"/>
</g>
<!-- route_layer2_gpu14&#45;&gt;comm_layer2 -->
<g id="edge255" class="edge">
<title>route_layer2_gpu14&#45;&gt;comm_layer2</title>
<path fill="none" stroke="black" d="M14477.41,-9979.19C14378.15,-9970.59 14267.49,-9962.23 14166,-9957.3 13121.78,-9906.57 9845.27,-9889.64 8907.23,-9885.77"/>
<polygon fill="black" stroke="black" points="8906.99,-9882.27 8896.98,-9885.73 8906.96,-9889.27 8906.99,-9882.27"/>
</g>
<!-- mha_layer3_gpu14 -->
<g id="node259" class="node">
<title>mha_layer3_gpu14</title>
<path fill="lightblue" stroke="black" d="M13969,-9564.35C13969,-9564.35 13521,-9564.35 13521,-9564.35 13515,-9564.35 13509,-9558.35 13509,-9552.35 13509,-9552.35 13509,-9523.35 13509,-9523.35 13509,-9517.35 13515,-9511.35 13521,-9511.35 13521,-9511.35 13969,-9511.35 13969,-9511.35 13975,-9511.35 13981,-9517.35 13981,-9523.35 13981,-9523.35 13981,-9552.35 13981,-9552.35 13981,-9558.35 13975,-9564.35 13969,-9564.35"/>
<text text-anchor="middle" x="13745" y="-9549.15" font-family="Times,serif" font-size="14.00">MHA Layer 3 GPU 14</text>
<text text-anchor="middle" x="13745" y="-9534.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13745" y="-9519.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer2_gpu14&#45;&gt;mha_layer3_gpu14 -->
<g id="edge303" class="edge">
<title>aggregate_layer2_gpu14&#45;&gt;mha_layer3_gpu14</title>
<path fill="none" stroke="black" d="M13657.9,-9600.25C13672.41,-9590.02 13687.21,-9579.58 13700.4,-9570.29"/>
<polygon fill="black" stroke="black" points="13702.65,-9572.98 13708.81,-9564.36 13698.62,-9567.26 13702.65,-9572.98"/>
</g>
<!-- route_layer2_gpu15&#45;&gt;comm_layer2 -->
<g id="edge256" class="edge">
<title>route_layer2_gpu15&#45;&gt;comm_layer2</title>
<path fill="none" stroke="black" d="M15440.31,-9979.1C15340.79,-9970.49 15229.8,-9962.14 15128,-9957.3 13884.62,-9898.19 9946.7,-9887.11 8907.49,-9885.2"/>
<polygon fill="black" stroke="black" points="8907.28,-9881.7 8897.27,-9885.18 8907.27,-9888.7 8907.28,-9881.7"/>
</g>
<!-- mha_layer3_gpu15 -->
<g id="node260" class="node">
<title>mha_layer3_gpu15</title>
<path fill="lightblue" stroke="black" d="M14480,-9564.35C14480,-9564.35 14032,-9564.35 14032,-9564.35 14026,-9564.35 14020,-9558.35 14020,-9552.35 14020,-9552.35 14020,-9523.35 14020,-9523.35 14020,-9517.35 14026,-9511.35 14032,-9511.35 14032,-9511.35 14480,-9511.35 14480,-9511.35 14486,-9511.35 14492,-9517.35 14492,-9523.35 14492,-9523.35 14492,-9552.35 14492,-9552.35 14492,-9558.35 14486,-9564.35 14480,-9564.35"/>
<text text-anchor="middle" x="14256" y="-9549.15" font-family="Times,serif" font-size="14.00">MHA Layer 3 GPU 15</text>
<text text-anchor="middle" x="14256" y="-9534.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14256" y="-9519.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer2_gpu15&#45;&gt;mha_layer3_gpu15 -->
<g id="edge304" class="edge">
<title>aggregate_layer2_gpu15&#45;&gt;mha_layer3_gpu15</title>
<path fill="none" stroke="black" d="M14254.92,-9600.25C14255.07,-9591.58 14255.23,-9582.76 14255.37,-9574.61"/>
<polygon fill="black" stroke="black" points="14258.87,-9574.42 14255.55,-9564.36 14251.87,-9574.3 14258.87,-9574.42"/>
</g>
<!-- comm_layer2&#45;&gt;expert_layer2_gpu0_expert0 -->
<g id="edge257" class="edge">
<title>comm_layer2&#45;&gt;expert_layer2_gpu0_expert0</title>
<path fill="none" stroke="black" d="M8410.98,-9882.17C7430.26,-9879.17 3761.19,-9864.49 2601,-9810.35 2553.04,-9808.11 2501.95,-9804.73 2452.79,-9800.97"/>
<polygon fill="black" stroke="black" points="2452.9,-9797.47 2442.66,-9800.19 2452.36,-9804.45 2452.9,-9797.47"/>
</g>
<!-- comm_layer2&#45;&gt;expert_layer2_gpu1_expert1 -->
<g id="edge258" class="edge">
<title>comm_layer2&#45;&gt;expert_layer2_gpu1_expert1</title>
<path fill="none" stroke="black" d="M8411.13,-9881.24C7694.47,-9876.14 5526.18,-9857.63 3728,-9810.35 3521.37,-9804.91 3287.26,-9795.88 3113.83,-9788.64"/>
<polygon fill="black" stroke="black" points="3113.94,-9785.14 3103.8,-9788.22 3113.64,-9792.14 3113.94,-9785.14"/>
</g>
<!-- comm_layer2&#45;&gt;expert_layer2_gpu2_expert2 -->
<g id="edge259" class="edge">
<title>comm_layer2&#45;&gt;expert_layer2_gpu2_expert2</title>
<path fill="none" stroke="black" d="M8412.32,-9879.44C7818.49,-9870.83 6240.35,-9846.24 4924,-9810.35 4692.87,-9804.04 4429.86,-9794.62 4240.94,-9787.45"/>
<polygon fill="black" stroke="black" points="4240.99,-9783.95 4230.87,-9787.07 4240.73,-9790.95 4240.99,-9783.95"/>
</g>
<!-- comm_layer2&#45;&gt;expert_layer2_gpu3_expert3 -->
<g id="edge260" class="edge">
<title>comm_layer2&#45;&gt;expert_layer2_gpu3_expert3</title>
<path fill="none" stroke="black" d="M8412.38,-9879.19C7917.65,-9871.2 6753.63,-9849.63 5777,-9810.35 5665.47,-9805.86 5542.3,-9799.32 5436.95,-9793.24"/>
<polygon fill="black" stroke="black" points="5437,-9789.74 5426.81,-9792.66 5436.59,-9796.73 5437,-9789.74"/>
</g>
<!-- comm_layer2&#45;&gt;expert_layer2_gpu4_expert4 -->
<g id="edge261" class="edge">
<title>comm_layer2&#45;&gt;expert_layer2_gpu4_expert4</title>
<path fill="none" stroke="black" d="M8416.89,-9875.33C8044.73,-9863.31 7300.79,-9838.21 6670,-9810.35 6544.9,-9804.82 6406.03,-9797.74 6289.96,-9791.55"/>
<polygon fill="black" stroke="black" points="6290.05,-9788.05 6279.87,-9791.01 6289.67,-9795.04 6290.05,-9788.05"/>
</g>
<!-- comm_layer2&#45;&gt;expert_layer2_gpu5_expert5 -->
<g id="edge262" class="edge">
<title>comm_layer2&#45;&gt;expert_layer2_gpu5_expert5</title>
<path fill="none" stroke="black" d="M8429.43,-9869.31C8189.07,-9854.82 7796.57,-9831.11 7458,-9810.35 7368.28,-9804.85 7270.06,-9798.77 7182.7,-9793.34"/>
<polygon fill="black" stroke="black" points="7182.85,-9789.85 7172.65,-9792.72 7182.42,-9796.83 7182.85,-9789.85"/>
</g>
<!-- comm_layer2&#45;&gt;expert_layer2_gpu6_expert6 -->
<g id="edge263" class="edge">
<title>comm_layer2&#45;&gt;expert_layer2_gpu6_expert6</title>
<path fill="none" stroke="black" d="M8460.37,-9861.1C8318.77,-9845.21 8125.27,-9823.49 7970.77,-9806.16"/>
<polygon fill="black" stroke="black" points="7970.98,-9802.66 7960.65,-9805.02 7970.2,-9809.62 7970.98,-9802.66"/>
</g>
<!-- comm_layer2&#45;&gt;expert_layer2_gpu7_expert7 -->
<g id="edge264" class="edge">
<title>comm_layer2&#45;&gt;expert_layer2_gpu7_expert7</title>
<path fill="none" stroke="black" d="M8555.28,-9849.45C8521.58,-9838.06 8483.74,-9825.27 8449.4,-9813.65"/>
<polygon fill="black" stroke="black" points="8450.4,-9810.3 8439.81,-9810.41 8448.16,-9816.93 8450.4,-9810.3"/>
</g>
<!-- comm_layer2&#45;&gt;expert_layer2_gpu8_expert8 -->
<g id="edge265" class="edge">
<title>comm_layer2&#45;&gt;expert_layer2_gpu8_expert8</title>
<path fill="none" stroke="black" d="M8752.72,-9849.45C8786.42,-9838.06 8824.26,-9825.27 8858.6,-9813.65"/>
<polygon fill="black" stroke="black" points="8859.84,-9816.93 8868.19,-9810.41 8857.6,-9810.3 8859.84,-9816.93"/>
</g>
<!-- comm_layer2&#45;&gt;expert_layer2_gpu9_expert9 -->
<g id="edge266" class="edge">
<title>comm_layer2&#45;&gt;expert_layer2_gpu9_expert9</title>
<path fill="none" stroke="black" d="M8854.71,-9862.64C9022.91,-9845.73 9264.1,-9821.48 9446.33,-9803.15"/>
<polygon fill="black" stroke="black" points="9446.73,-9806.63 9456.33,-9802.15 9446.03,-9799.67 9446.73,-9806.63"/>
</g>
<!-- comm_layer2&#45;&gt;expert_layer2_gpu10_expert10 -->
<g id="edge267" class="edge">
<title>comm_layer2&#45;&gt;expert_layer2_gpu10_expert10</title>
<path fill="none" stroke="black" d="M8882.24,-9870.78C9142.58,-9856.9 9581.02,-9833.07 9958,-9810.35 10039.64,-9805.43 10128.64,-9799.75 10209.01,-9794.51"/>
<polygon fill="black" stroke="black" points="10209.52,-9797.98 10219.27,-9793.84 10209.07,-9791 10209.52,-9797.98"/>
</g>
<!-- comm_layer2&#45;&gt;expert_layer2_gpu11_expert11 -->
<g id="edge268" class="edge">
<title>comm_layer2&#45;&gt;expert_layer2_gpu11_expert11</title>
<path fill="none" stroke="black" d="M8892.8,-9876.55C9277.75,-9865.95 10059.29,-9842.5 10721,-9810.35 10810.39,-9806 10908.18,-9800.22 10995.2,-9794.71"/>
<polygon fill="black" stroke="black" points="10995.46,-9798.2 11005.22,-9794.07 10995.01,-9791.21 10995.46,-9798.2"/>
</g>
<!-- comm_layer2&#45;&gt;expert_layer2_gpu12_expert12 -->
<g id="edge269" class="edge">
<title>comm_layer2&#45;&gt;expert_layer2_gpu12_expert12</title>
<path fill="none" stroke="black" d="M8896,-9879.93C9387.99,-9873.32 10540.27,-9854.19 11507,-9810.35 11587.7,-9806.69 11675.57,-9801.4 11755.05,-9796.12"/>
<polygon fill="black" stroke="black" points="11755.46,-9799.61 11765.21,-9795.45 11755,-9792.62 11755.46,-9799.61"/>
</g>
<!-- comm_layer2&#45;&gt;expert_layer2_gpu13_expert13 -->
<g id="edge270" class="edge">
<title>comm_layer2&#45;&gt;expert_layer2_gpu13_expert13</title>
<path fill="none" stroke="black" d="M8897.03,-9882.09C9479.14,-9879.44 10999.19,-9867.16 12267,-9810.35 12337.4,-9807.19 12413.59,-9802.47 12483.87,-9797.57"/>
<polygon fill="black" stroke="black" points="12484.47,-9801.04 12494.2,-9796.85 12483.98,-9794.06 12484.47,-9801.04"/>
</g>
<!-- comm_layer2&#45;&gt;expert_layer2_gpu14_expert14 -->
<g id="edge271" class="edge">
<title>comm_layer2&#45;&gt;expert_layer2_gpu14_expert14</title>
<path fill="none" stroke="black" d="M8897.48,-9883.58C9557.44,-9884.58 11435.78,-9880.52 12996,-9810.35 13058.68,-9807.53 13126.18,-9803.24 13189.36,-9798.68"/>
<polygon fill="black" stroke="black" points="13189.74,-9802.17 13199.46,-9797.95 13189.23,-9795.18 13189.74,-9802.17"/>
</g>
<!-- comm_layer2&#45;&gt;expert_layer2_gpu15_expert15 -->
<g id="edge272" class="edge">
<title>comm_layer2&#45;&gt;expert_layer2_gpu15_expert15</title>
<path fill="none" stroke="black" d="M8896.77,-9881.33C9769.84,-9875.66 12748.72,-9853.51 13701,-9810.35 13757.83,-9807.77 13818.78,-9803.84 13876.46,-9799.57"/>
<polygon fill="black" stroke="black" points="13876.72,-9803.06 13886.43,-9798.83 13876.2,-9796.08 13876.72,-9803.06"/>
</g>
<!-- gate_layer3_gpu0 -->
<g id="node261" class="node">
<title>gate_layer3_gpu0</title>
<path fill="lightsteelblue" stroke="black" d="M1370.07,-9474.01C1370.07,-9474.01 920.93,-9423.68 920.93,-9423.68 914.96,-9423.01 914.96,-9421.68 920.93,-9421.01 920.93,-9421.01 1370.07,-9370.68 1370.07,-9370.68 1376.04,-9370.01 1387.96,-9370.01 1393.93,-9370.68 1393.93,-9370.68 1843.07,-9421.01 1843.07,-9421.01 1849.04,-9421.68 1849.04,-9423.01 1843.07,-9423.68 1843.07,-9423.68 1393.93,-9474.01 1393.93,-9474.01 1387.96,-9474.68 1376.04,-9474.68 1370.07,-9474.01"/>
<text text-anchor="middle" x="1382" y="-9433.65" font-family="Times,serif" font-size="14.00">Gate Layer 3 GPU 0</text>
<text text-anchor="middle" x="1382" y="-9418.65" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="1382" y="-9403.65" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer3_gpu0&#45;&gt;gate_layer3_gpu0 -->
<g id="edge305" class="edge">
<title>mha_layer3_gpu0&#45;&gt;gate_layer3_gpu0</title>
<path fill="none" stroke="black" d="M1558.55,-9511.23C1534.37,-9499.2 1504.76,-9484.46 1476.74,-9470.51"/>
<polygon fill="black" stroke="black" points="1478.22,-9467.34 1467.71,-9466.01 1475.1,-9473.6 1478.22,-9467.34"/>
</g>
<!-- gate_layer3_gpu1 -->
<g id="node262" class="node">
<title>gate_layer3_gpu1</title>
<path fill="lightsteelblue" stroke="black" d="M2334.07,-9474.01C2334.07,-9474.01 1884.93,-9423.68 1884.93,-9423.68 1878.96,-9423.01 1878.96,-9421.68 1884.93,-9421.01 1884.93,-9421.01 2334.07,-9370.68 2334.07,-9370.68 2340.04,-9370.01 2351.96,-9370.01 2357.93,-9370.68 2357.93,-9370.68 2807.07,-9421.01 2807.07,-9421.01 2813.04,-9421.68 2813.04,-9423.01 2807.07,-9423.68 2807.07,-9423.68 2357.93,-9474.01 2357.93,-9474.01 2351.96,-9474.68 2340.04,-9474.68 2334.07,-9474.01"/>
<text text-anchor="middle" x="2346" y="-9433.65" font-family="Times,serif" font-size="14.00">Gate Layer 3 GPU 1</text>
<text text-anchor="middle" x="2346" y="-9418.65" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="2346" y="-9403.65" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer3_gpu1&#45;&gt;gate_layer3_gpu1 -->
<g id="edge306" class="edge">
<title>mha_layer3_gpu1&#45;&gt;gate_layer3_gpu1</title>
<path fill="none" stroke="black" d="M2404.75,-9511.09C2398.6,-9501.91 2391.41,-9491.16 2384.2,-9480.39"/>
<polygon fill="black" stroke="black" points="2386.91,-9478.15 2378.44,-9471.79 2381.09,-9482.04 2386.91,-9478.15"/>
</g>
<!-- gate_layer3_gpu2 -->
<g id="node263" class="node">
<title>gate_layer3_gpu2</title>
<path fill="lightsteelblue" stroke="black" d="M3298.07,-9474.01C3298.07,-9474.01 2848.93,-9423.68 2848.93,-9423.68 2842.96,-9423.01 2842.96,-9421.68 2848.93,-9421.01 2848.93,-9421.01 3298.07,-9370.68 3298.07,-9370.68 3304.04,-9370.01 3315.96,-9370.01 3321.93,-9370.68 3321.93,-9370.68 3771.07,-9421.01 3771.07,-9421.01 3777.04,-9421.68 3777.04,-9423.01 3771.07,-9423.68 3771.07,-9423.68 3321.93,-9474.01 3321.93,-9474.01 3315.96,-9474.68 3304.04,-9474.68 3298.07,-9474.01"/>
<text text-anchor="middle" x="3310" y="-9433.65" font-family="Times,serif" font-size="14.00">Gate Layer 3 GPU 2</text>
<text text-anchor="middle" x="3310" y="-9418.65" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="3310" y="-9403.65" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer3_gpu2&#45;&gt;gate_layer3_gpu2 -->
<g id="edge307" class="edge">
<title>mha_layer3_gpu2&#45;&gt;gate_layer3_gpu2</title>
<path fill="none" stroke="black" d="M3376.49,-9511.09C3369.31,-9501.62 3360.87,-9490.48 3352.46,-9479.38"/>
<polygon fill="black" stroke="black" points="3355.19,-9477.19 3346.36,-9471.33 3349.61,-9481.42 3355.19,-9477.19"/>
</g>
<!-- gate_layer3_gpu3 -->
<g id="node264" class="node">
<title>gate_layer3_gpu3</title>
<path fill="lightsteelblue" stroke="black" d="M4262.07,-9474.01C4262.07,-9474.01 3812.93,-9423.68 3812.93,-9423.68 3806.96,-9423.01 3806.96,-9421.68 3812.93,-9421.01 3812.93,-9421.01 4262.07,-9370.68 4262.07,-9370.68 4268.04,-9370.01 4279.96,-9370.01 4285.93,-9370.68 4285.93,-9370.68 4735.07,-9421.01 4735.07,-9421.01 4741.04,-9421.68 4741.04,-9423.01 4735.07,-9423.68 4735.07,-9423.68 4285.93,-9474.01 4285.93,-9474.01 4279.96,-9474.68 4268.04,-9474.68 4262.07,-9474.01"/>
<text text-anchor="middle" x="4274" y="-9433.65" font-family="Times,serif" font-size="14.00">Gate Layer 3 GPU 3</text>
<text text-anchor="middle" x="4274" y="-9418.65" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4274" y="-9403.65" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer3_gpu3&#45;&gt;gate_layer3_gpu3 -->
<g id="edge308" class="edge">
<title>mha_layer3_gpu3&#45;&gt;gate_layer3_gpu3</title>
<path fill="none" stroke="black" d="M4307.24,-9511.09C4304.05,-9502.67 4300.36,-9492.92 4296.62,-9483.06"/>
<polygon fill="black" stroke="black" points="4299.86,-9481.72 4293.04,-9473.61 4293.31,-9484.2 4299.86,-9481.72"/>
</g>
<!-- gate_layer3_gpu4 -->
<g id="node265" class="node">
<title>gate_layer3_gpu4</title>
<path fill="lightsteelblue" stroke="black" d="M5226.07,-9474.01C5226.07,-9474.01 4776.93,-9423.68 4776.93,-9423.68 4770.96,-9423.01 4770.96,-9421.68 4776.93,-9421.01 4776.93,-9421.01 5226.07,-9370.68 5226.07,-9370.68 5232.04,-9370.01 5243.96,-9370.01 5249.93,-9370.68 5249.93,-9370.68 5699.07,-9421.01 5699.07,-9421.01 5705.04,-9421.68 5705.04,-9423.01 5699.07,-9423.68 5699.07,-9423.68 5249.93,-9474.01 5249.93,-9474.01 5243.96,-9474.68 5232.04,-9474.68 5226.07,-9474.01"/>
<text text-anchor="middle" x="5238" y="-9433.65" font-family="Times,serif" font-size="14.00">Gate Layer 3 GPU 4</text>
<text text-anchor="middle" x="5238" y="-9418.65" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5238" y="-9403.65" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer3_gpu4&#45;&gt;gate_layer3_gpu4 -->
<g id="edge309" class="edge">
<title>mha_layer3_gpu4&#45;&gt;gate_layer3_gpu4</title>
<path fill="none" stroke="black" d="M5417.65,-9511.23C5392.92,-9499.14 5362.62,-9484.31 5333.99,-9470.31"/>
<polygon fill="black" stroke="black" points="5335.28,-9467.04 5324.76,-9465.79 5332.2,-9473.33 5335.28,-9467.04"/>
</g>
<!-- gate_layer3_gpu5 -->
<g id="node266" class="node">
<title>gate_layer3_gpu5</title>
<path fill="lightsteelblue" stroke="black" d="M6190.07,-9474.01C6190.07,-9474.01 5740.93,-9423.68 5740.93,-9423.68 5734.96,-9423.01 5734.96,-9421.68 5740.93,-9421.01 5740.93,-9421.01 6190.07,-9370.68 6190.07,-9370.68 6196.04,-9370.01 6207.96,-9370.01 6213.93,-9370.68 6213.93,-9370.68 6663.07,-9421.01 6663.07,-9421.01 6669.04,-9421.68 6669.04,-9423.01 6663.07,-9423.68 6663.07,-9423.68 6213.93,-9474.01 6213.93,-9474.01 6207.96,-9474.68 6196.04,-9474.68 6190.07,-9474.01"/>
<text text-anchor="middle" x="6202" y="-9433.65" font-family="Times,serif" font-size="14.00">Gate Layer 3 GPU 5</text>
<text text-anchor="middle" x="6202" y="-9418.65" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6202" y="-9403.65" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer3_gpu5&#45;&gt;gate_layer3_gpu5 -->
<g id="edge310" class="edge">
<title>mha_layer3_gpu5&#45;&gt;gate_layer3_gpu5</title>
<path fill="none" stroke="black" d="M6396.36,-9511.23C6368.99,-9498.86 6335.28,-9483.62 6303.67,-9469.32"/>
<polygon fill="black" stroke="black" points="6304.94,-9466.05 6294.38,-9465.12 6302.05,-9472.43 6304.94,-9466.05"/>
</g>
<!-- gate_layer3_gpu6 -->
<g id="node267" class="node">
<title>gate_layer3_gpu6</title>
<path fill="lightsteelblue" stroke="black" d="M7154.07,-9474.01C7154.07,-9474.01 6704.93,-9423.68 6704.93,-9423.68 6698.96,-9423.01 6698.96,-9421.68 6704.93,-9421.01 6704.93,-9421.01 7154.07,-9370.68 7154.07,-9370.68 7160.04,-9370.01 7171.96,-9370.01 7177.93,-9370.68 7177.93,-9370.68 7627.07,-9421.01 7627.07,-9421.01 7633.04,-9421.68 7633.04,-9423.01 7627.07,-9423.68 7627.07,-9423.68 7177.93,-9474.01 7177.93,-9474.01 7171.96,-9474.68 7160.04,-9474.68 7154.07,-9474.01"/>
<text text-anchor="middle" x="7166" y="-9433.65" font-family="Times,serif" font-size="14.00">Gate Layer 3 GPU 6</text>
<text text-anchor="middle" x="7166" y="-9418.65" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="7166" y="-9403.65" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer3_gpu6&#45;&gt;gate_layer3_gpu6 -->
<g id="edge311" class="edge">
<title>mha_layer3_gpu6&#45;&gt;gate_layer3_gpu6</title>
<path fill="none" stroke="black" d="M7338.68,-9511.23C7315.13,-9499.25 7286.32,-9484.58 7259.02,-9470.69"/>
<polygon fill="black" stroke="black" points="7260.33,-9467.43 7249.83,-9466.01 7257.16,-9473.67 7260.33,-9467.43"/>
</g>
<!-- gate_layer3_gpu7 -->
<g id="node268" class="node">
<title>gate_layer3_gpu7</title>
<path fill="lightsteelblue" stroke="black" d="M8118.07,-9474.01C8118.07,-9474.01 7668.93,-9423.68 7668.93,-9423.68 7662.96,-9423.01 7662.96,-9421.68 7668.93,-9421.01 7668.93,-9421.01 8118.07,-9370.68 8118.07,-9370.68 8124.04,-9370.01 8135.96,-9370.01 8141.93,-9370.68 8141.93,-9370.68 8591.07,-9421.01 8591.07,-9421.01 8597.04,-9421.68 8597.04,-9423.01 8591.07,-9423.68 8591.07,-9423.68 8141.93,-9474.01 8141.93,-9474.01 8135.96,-9474.68 8124.04,-9474.68 8118.07,-9474.01"/>
<text text-anchor="middle" x="8130" y="-9433.65" font-family="Times,serif" font-size="14.00">Gate Layer 3 GPU 7</text>
<text text-anchor="middle" x="8130" y="-9418.65" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="8130" y="-9403.65" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer3_gpu7&#45;&gt;gate_layer3_gpu7 -->
<g id="edge312" class="edge">
<title>mha_layer3_gpu7&#45;&gt;gate_layer3_gpu7</title>
<path fill="none" stroke="black" d="M8133.87,-9511.09C8133.53,-9503.39 8133.14,-9494.6 8132.74,-9485.61"/>
<polygon fill="black" stroke="black" points="8136.23,-9485.28 8132.3,-9475.44 8129.24,-9485.59 8136.23,-9485.28"/>
</g>
<!-- gate_layer3_gpu8 -->
<g id="node269" class="node">
<title>gate_layer3_gpu8</title>
<path fill="lightsteelblue" stroke="black" d="M9082.07,-9474.01C9082.07,-9474.01 8632.93,-9423.68 8632.93,-9423.68 8626.96,-9423.01 8626.96,-9421.68 8632.93,-9421.01 8632.93,-9421.01 9082.07,-9370.68 9082.07,-9370.68 9088.04,-9370.01 9099.96,-9370.01 9105.93,-9370.68 9105.93,-9370.68 9555.07,-9421.01 9555.07,-9421.01 9561.04,-9421.68 9561.04,-9423.01 9555.07,-9423.68 9555.07,-9423.68 9105.93,-9474.01 9105.93,-9474.01 9099.96,-9474.68 9088.04,-9474.68 9082.07,-9474.01"/>
<text text-anchor="middle" x="9094" y="-9433.65" font-family="Times,serif" font-size="14.00">Gate Layer 3 GPU 8</text>
<text text-anchor="middle" x="9094" y="-9418.65" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="9094" y="-9403.65" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer3_gpu8&#45;&gt;gate_layer3_gpu8 -->
<g id="edge313" class="edge">
<title>mha_layer3_gpu8&#45;&gt;gate_layer3_gpu8</title>
<path fill="none" stroke="black" d="M9066.17,-9511.09C9068.81,-9502.75 9071.87,-9493.13 9074.96,-9483.37"/>
<polygon fill="black" stroke="black" points="9078.37,-9484.2 9078.06,-9473.61 9071.7,-9482.09 9078.37,-9484.2"/>
</g>
<!-- gate_layer3_gpu9 -->
<g id="node270" class="node">
<title>gate_layer3_gpu9</title>
<path fill="lightsteelblue" stroke="black" d="M10046.07,-9474.01C10046.07,-9474.01 9596.93,-9423.68 9596.93,-9423.68 9590.96,-9423.01 9590.96,-9421.68 9596.93,-9421.01 9596.93,-9421.01 10046.07,-9370.68 10046.07,-9370.68 10052.04,-9370.01 10063.96,-9370.01 10069.93,-9370.68 10069.93,-9370.68 10519.07,-9421.01 10519.07,-9421.01 10525.04,-9421.68 10525.04,-9423.01 10519.07,-9423.68 10519.07,-9423.68 10069.93,-9474.01 10069.93,-9474.01 10063.96,-9474.68 10052.04,-9474.68 10046.07,-9474.01"/>
<text text-anchor="middle" x="10058" y="-9433.65" font-family="Times,serif" font-size="14.00">Gate Layer 3 GPU 9</text>
<text text-anchor="middle" x="10058" y="-9418.65" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="10058" y="-9403.65" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer3_gpu9&#45;&gt;gate_layer3_gpu9 -->
<g id="edge314" class="edge">
<title>mha_layer3_gpu9&#45;&gt;gate_layer3_gpu9</title>
<path fill="none" stroke="black" d="M10010.84,-9511.09C10015.57,-9502.29 10021.07,-9492.05 10026.62,-9481.74"/>
<polygon fill="black" stroke="black" points="10029.82,-9483.16 10031.48,-9472.7 10023.66,-9479.85 10029.82,-9483.16"/>
</g>
<!-- gate_layer3_gpu10 -->
<g id="node271" class="node">
<title>gate_layer3_gpu10</title>
<path fill="lightsteelblue" stroke="black" d="M11010.07,-9474.01C11010.07,-9474.01 10560.93,-9423.68 10560.93,-9423.68 10554.96,-9423.01 10554.96,-9421.68 10560.93,-9421.01 10560.93,-9421.01 11010.07,-9370.68 11010.07,-9370.68 11016.04,-9370.01 11027.96,-9370.01 11033.93,-9370.68 11033.93,-9370.68 11483.07,-9421.01 11483.07,-9421.01 11489.04,-9421.68 11489.04,-9423.01 11483.07,-9423.68 11483.07,-9423.68 11033.93,-9474.01 11033.93,-9474.01 11027.96,-9474.68 11016.04,-9474.68 11010.07,-9474.01"/>
<text text-anchor="middle" x="11022" y="-9433.65" font-family="Times,serif" font-size="14.00">Gate Layer 3 GPU 10</text>
<text text-anchor="middle" x="11022" y="-9418.65" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11022" y="-9403.65" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer3_gpu10&#45;&gt;gate_layer3_gpu10 -->
<g id="edge315" class="edge">
<title>mha_layer3_gpu10&#45;&gt;gate_layer3_gpu10</title>
<path fill="none" stroke="black" d="M10791.25,-9511.23C10825.42,-9498.22 10867.89,-9482.04 10907.05,-9467.13"/>
<polygon fill="black" stroke="black" points="10908.3,-9470.4 10916.4,-9463.57 10905.81,-9463.85 10908.3,-9470.4"/>
</g>
<!-- gate_layer3_gpu11 -->
<g id="node272" class="node">
<title>gate_layer3_gpu11</title>
<path fill="lightsteelblue" stroke="black" d="M11974.07,-9474.01C11974.07,-9474.01 11524.93,-9423.68 11524.93,-9423.68 11518.96,-9423.01 11518.96,-9421.68 11524.93,-9421.01 11524.93,-9421.01 11974.07,-9370.68 11974.07,-9370.68 11980.04,-9370.01 11991.96,-9370.01 11997.93,-9370.68 11997.93,-9370.68 12447.07,-9421.01 12447.07,-9421.01 12453.04,-9421.68 12453.04,-9423.01 12447.07,-9423.68 12447.07,-9423.68 11997.93,-9474.01 11997.93,-9474.01 11991.96,-9474.68 11980.04,-9474.68 11974.07,-9474.01"/>
<text text-anchor="middle" x="11986" y="-9433.65" font-family="Times,serif" font-size="14.00">Gate Layer 3 GPU 11</text>
<text text-anchor="middle" x="11986" y="-9418.65" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11986" y="-9403.65" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer3_gpu11&#45;&gt;gate_layer3_gpu11 -->
<g id="edge316" class="edge">
<title>mha_layer3_gpu11&#45;&gt;gate_layer3_gpu11</title>
<path fill="none" stroke="black" d="M11983.68,-9511.09C11983.88,-9503.39 11984.12,-9494.6 11984.35,-9485.61"/>
<polygon fill="black" stroke="black" points="11987.86,-9485.53 11984.62,-9475.44 11980.86,-9485.35 11987.86,-9485.53"/>
</g>
<!-- gate_layer3_gpu12 -->
<g id="node273" class="node">
<title>gate_layer3_gpu12</title>
<path fill="lightsteelblue" stroke="black" d="M12938.07,-9474.01C12938.07,-9474.01 12488.93,-9423.68 12488.93,-9423.68 12482.96,-9423.01 12482.96,-9421.68 12488.93,-9421.01 12488.93,-9421.01 12938.07,-9370.68 12938.07,-9370.68 12944.04,-9370.01 12955.96,-9370.01 12961.93,-9370.68 12961.93,-9370.68 13411.07,-9421.01 13411.07,-9421.01 13417.04,-9421.68 13417.04,-9423.01 13411.07,-9423.68 13411.07,-9423.68 12961.93,-9474.01 12961.93,-9474.01 12955.96,-9474.68 12944.04,-9474.68 12938.07,-9474.01"/>
<text text-anchor="middle" x="12950" y="-9433.65" font-family="Times,serif" font-size="14.00">Gate Layer 3 GPU 12</text>
<text text-anchor="middle" x="12950" y="-9418.65" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="12950" y="-9403.65" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer3_gpu12&#45;&gt;gate_layer3_gpu12 -->
<g id="edge317" class="edge">
<title>mha_layer3_gpu12&#45;&gt;gate_layer3_gpu12</title>
<path fill="none" stroke="black" d="M12709.96,-9511.23C12745.82,-9498.1 12790.49,-9481.75 12831.54,-9466.72"/>
<polygon fill="black" stroke="black" points="12832.87,-9469.96 12841.06,-9463.23 12830.46,-9463.39 12832.87,-9469.96"/>
</g>
<!-- gate_layer3_gpu13 -->
<g id="node274" class="node">
<title>gate_layer3_gpu13</title>
<path fill="lightsteelblue" stroke="black" d="M13902.07,-9474.01C13902.07,-9474.01 13452.93,-9423.68 13452.93,-9423.68 13446.96,-9423.01 13446.96,-9421.68 13452.93,-9421.01 13452.93,-9421.01 13902.07,-9370.68 13902.07,-9370.68 13908.04,-9370.01 13919.96,-9370.01 13925.93,-9370.68 13925.93,-9370.68 14375.07,-9421.01 14375.07,-9421.01 14381.04,-9421.68 14381.04,-9423.01 14375.07,-9423.68 14375.07,-9423.68 13925.93,-9474.01 13925.93,-9474.01 13919.96,-9474.68 13908.04,-9474.68 13902.07,-9474.01"/>
<text text-anchor="middle" x="13914" y="-9433.65" font-family="Times,serif" font-size="14.00">Gate Layer 3 GPU 13</text>
<text text-anchor="middle" x="13914" y="-9418.65" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13914" y="-9403.65" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer3_gpu13&#45;&gt;gate_layer3_gpu13 -->
<g id="edge318" class="edge">
<title>mha_layer3_gpu13&#45;&gt;gate_layer3_gpu13</title>
<path fill="none" stroke="black" d="M13370.75,-9511.3C13472.26,-9494.87 13605.06,-9473.37 13713.95,-9455.74"/>
<polygon fill="black" stroke="black" points="13714.76,-9459.15 13724.07,-9454.1 13713.64,-9452.24 13714.76,-9459.15"/>
</g>
<!-- gate_layer3_gpu14 -->
<g id="node275" class="node">
<title>gate_layer3_gpu14</title>
<path fill="lightsteelblue" stroke="black" d="M14866.07,-9474.01C14866.07,-9474.01 14416.93,-9423.68 14416.93,-9423.68 14410.96,-9423.01 14410.96,-9421.68 14416.93,-9421.01 14416.93,-9421.01 14866.07,-9370.68 14866.07,-9370.68 14872.04,-9370.01 14883.96,-9370.01 14889.93,-9370.68 14889.93,-9370.68 15339.07,-9421.01 15339.07,-9421.01 15345.04,-9421.68 15345.04,-9423.01 15339.07,-9423.68 15339.07,-9423.68 14889.93,-9474.01 14889.93,-9474.01 14883.96,-9474.68 14872.04,-9474.68 14866.07,-9474.01"/>
<text text-anchor="middle" x="14878" y="-9433.65" font-family="Times,serif" font-size="14.00">Gate Layer 3 GPU 14</text>
<text text-anchor="middle" x="14878" y="-9418.65" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14878" y="-9403.65" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer3_gpu14&#45;&gt;gate_layer3_gpu14 -->
<g id="edge319" class="edge">
<title>mha_layer3_gpu14&#45;&gt;gate_layer3_gpu14</title>
<path fill="none" stroke="black" d="M13981.05,-9514.19C13991.17,-9513.23 14001.19,-9512.28 14011,-9511.35 14182.09,-9495.15 14225.01,-9492.56 14396,-9475.35 14473.54,-9467.54 14558.04,-9458.58 14634.33,-9450.32"/>
<polygon fill="black" stroke="black" points="14634.99,-9453.77 14644.56,-9449.21 14634.24,-9446.81 14634.99,-9453.77"/>
</g>
<!-- gate_layer3_gpu15 -->
<g id="node276" class="node">
<title>gate_layer3_gpu15</title>
<path fill="lightsteelblue" stroke="black" d="M15830.07,-9474.01C15830.07,-9474.01 15380.93,-9423.68 15380.93,-9423.68 15374.96,-9423.01 15374.96,-9421.68 15380.93,-9421.01 15380.93,-9421.01 15830.07,-9370.68 15830.07,-9370.68 15836.04,-9370.01 15847.96,-9370.01 15853.93,-9370.68 15853.93,-9370.68 16303.07,-9421.01 16303.07,-9421.01 16309.04,-9421.68 16309.04,-9423.01 16303.07,-9423.68 16303.07,-9423.68 15853.93,-9474.01 15853.93,-9474.01 15847.96,-9474.68 15836.04,-9474.68 15830.07,-9474.01"/>
<text text-anchor="middle" x="15842" y="-9433.65" font-family="Times,serif" font-size="14.00">Gate Layer 3 GPU 15</text>
<text text-anchor="middle" x="15842" y="-9418.65" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="15842" y="-9403.65" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer3_gpu15&#45;&gt;gate_layer3_gpu15 -->
<g id="edge320" class="edge">
<title>mha_layer3_gpu15&#45;&gt;gate_layer3_gpu15</title>
<path fill="none" stroke="black" d="M14492.06,-9527.24C14715.76,-9517.3 15061.05,-9499.78 15360,-9475.35 15440.45,-9468.77 15528.26,-9459.82 15606.63,-9451.21"/>
<polygon fill="black" stroke="black" points="15607.08,-9454.68 15616.63,-9450.1 15606.31,-9447.72 15607.08,-9454.68"/>
</g>
<!-- route_layer3_gpu0 -->
<g id="node293" class="node">
<title>route_layer3_gpu0</title>
<path fill="orange" stroke="black" d="M2118.74,-9333.35C2118.74,-9333.35 1610.24,-9333.35 1610.24,-9333.35 1604.24,-9333.35 1593.5,-9329.67 1588.75,-9326 1588.75,-9326 1470.75,-9234.69 1470.75,-9234.69 1466,-9231.02 1467.26,-9227.35 1473.26,-9227.35 1473.26,-9227.35 1981.76,-9227.35 1981.76,-9227.35 1987.76,-9227.35 1998.5,-9231.02 2003.25,-9234.69 2003.25,-9234.69 2121.25,-9326 2121.25,-9326 2126,-9329.67 2124.74,-9333.35 2118.74,-9333.35"/>
<text text-anchor="middle" x="1796" y="-9291.65" font-family="Times,serif" font-size="14.00">Token Router Layer 3 GPU 0</text>
<text text-anchor="middle" x="1796" y="-9276.65" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="1796" y="-9261.65" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer3_gpu0&#45;&gt;route_layer3_gpu0 -->
<g id="edge321" class="edge">
<title>gate_layer3_gpu0&#45;&gt;route_layer3_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1497.6,-9382.26C1539.36,-9368.13 1587.34,-9351.91 1632.44,-9336.66"/>
<polygon fill="black" stroke="black" points="1633.66,-9339.94 1642.01,-9333.42 1631.42,-9333.31 1633.66,-9339.94"/>
</g>
<!-- route_layer3_gpu1 -->
<g id="node295" class="node">
<title>route_layer3_gpu1</title>
<path fill="orange" stroke="black" d="M3100.74,-9333.35C3100.74,-9333.35 2592.24,-9333.35 2592.24,-9333.35 2586.24,-9333.35 2575.5,-9329.67 2570.75,-9326 2570.75,-9326 2452.75,-9234.69 2452.75,-9234.69 2448,-9231.02 2449.26,-9227.35 2455.26,-9227.35 2455.26,-9227.35 2963.76,-9227.35 2963.76,-9227.35 2969.76,-9227.35 2980.5,-9231.02 2985.25,-9234.69 2985.25,-9234.69 3103.25,-9326 3103.25,-9326 3108,-9329.67 3106.74,-9333.35 3100.74,-9333.35"/>
<text text-anchor="middle" x="2778" y="-9291.65" font-family="Times,serif" font-size="14.00">Token Router Layer 3 GPU 1</text>
<text text-anchor="middle" x="2778" y="-9276.65" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="2778" y="-9261.65" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer3_gpu1&#45;&gt;route_layer3_gpu1 -->
<g id="edge322" class="edge">
<title>gate_layer3_gpu1&#45;&gt;route_layer3_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2465.48,-9382.63C2509.4,-9368.39 2560.02,-9351.99 2607.56,-9336.58"/>
<polygon fill="black" stroke="black" points="2608.91,-9339.82 2617.34,-9333.41 2606.75,-9333.16 2608.91,-9339.82"/>
</g>
<!-- route_layer3_gpu2 -->
<g id="node297" class="node">
<title>route_layer3_gpu2</title>
<path fill="orange" stroke="black" d="M3995.74,-9333.35C3995.74,-9333.35 3487.24,-9333.35 3487.24,-9333.35 3481.24,-9333.35 3470.5,-9329.67 3465.75,-9326 3465.75,-9326 3347.75,-9234.69 3347.75,-9234.69 3343,-9231.02 3344.26,-9227.35 3350.26,-9227.35 3350.26,-9227.35 3858.76,-9227.35 3858.76,-9227.35 3864.76,-9227.35 3875.5,-9231.02 3880.25,-9234.69 3880.25,-9234.69 3998.25,-9326 3998.25,-9326 4003,-9329.67 4001.74,-9333.35 3995.74,-9333.35"/>
<text text-anchor="middle" x="3673" y="-9291.65" font-family="Times,serif" font-size="14.00">Token Router Layer 3 GPU 2</text>
<text text-anchor="middle" x="3673" y="-9276.65" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="3673" y="-9261.65" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer3_gpu2&#45;&gt;route_layer3_gpu2 -->
<g id="edge323" class="edge">
<title>gate_layer3_gpu2&#45;&gt;route_layer3_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3414.51,-9381.04C3450.04,-9367.34 3490.39,-9351.77 3528.48,-9337.08"/>
<polygon fill="black" stroke="black" points="3530.04,-9340.23 3538.11,-9333.37 3527.52,-9333.7 3530.04,-9340.23"/>
</g>
<!-- route_layer3_gpu3 -->
<g id="node299" class="node">
<title>route_layer3_gpu3</title>
<path fill="orange" stroke="black" d="M4786.74,-9333.35C4786.74,-9333.35 4278.24,-9333.35 4278.24,-9333.35 4272.24,-9333.35 4261.5,-9329.67 4256.75,-9326 4256.75,-9326 4138.75,-9234.69 4138.75,-9234.69 4134,-9231.02 4135.26,-9227.35 4141.26,-9227.35 4141.26,-9227.35 4649.76,-9227.35 4649.76,-9227.35 4655.76,-9227.35 4666.5,-9231.02 4671.25,-9234.69 4671.25,-9234.69 4789.25,-9326 4789.25,-9326 4794,-9329.67 4792.74,-9333.35 4786.74,-9333.35"/>
<text text-anchor="middle" x="4464" y="-9291.65" font-family="Times,serif" font-size="14.00">Token Router Layer 3 GPU 3</text>
<text text-anchor="middle" x="4464" y="-9276.65" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="4464" y="-9261.65" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer3_gpu3&#45;&gt;route_layer3_gpu3 -->
<g id="edge324" class="edge">
<title>gate_layer3_gpu3&#45;&gt;route_layer3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4335.43,-9376.09C4351.26,-9364.41 4368.53,-9351.69 4385.13,-9339.46"/>
<polygon fill="black" stroke="black" points="4387.23,-9342.26 4393.21,-9333.51 4383.08,-9336.62 4387.23,-9342.26"/>
</g>
<!-- route_layer3_gpu4 -->
<g id="node301" class="node">
<title>route_layer3_gpu4</title>
<path fill="orange" stroke="black" d="M5733.74,-9333.35C5733.74,-9333.35 5225.24,-9333.35 5225.24,-9333.35 5219.24,-9333.35 5208.5,-9329.67 5203.75,-9326 5203.75,-9326 5085.75,-9234.69 5085.75,-9234.69 5081,-9231.02 5082.26,-9227.35 5088.26,-9227.35 5088.26,-9227.35 5596.76,-9227.35 5596.76,-9227.35 5602.76,-9227.35 5613.5,-9231.02 5618.25,-9234.69 5618.25,-9234.69 5736.25,-9326 5736.25,-9326 5741,-9329.67 5739.74,-9333.35 5733.74,-9333.35"/>
<text text-anchor="middle" x="5411" y="-9291.65" font-family="Times,serif" font-size="14.00">Token Router Layer 3 GPU 4</text>
<text text-anchor="middle" x="5411" y="-9276.65" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="5411" y="-9261.65" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer3_gpu4&#45;&gt;route_layer3_gpu4 -->
<g id="edge325" class="edge">
<title>gate_layer3_gpu4&#45;&gt;route_layer3_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5294.65,-9375.51C5308.7,-9364.13 5323.95,-9351.79 5338.64,-9339.91"/>
<polygon fill="black" stroke="black" points="5341.16,-9342.37 5346.73,-9333.36 5336.76,-9336.93 5341.16,-9342.37"/>
</g>
<!-- route_layer3_gpu5 -->
<g id="node303" class="node">
<title>route_layer3_gpu5</title>
<path fill="orange" stroke="black" d="M6835.74,-9333.35C6835.74,-9333.35 6327.24,-9333.35 6327.24,-9333.35 6321.24,-9333.35 6310.5,-9329.67 6305.75,-9326 6305.75,-9326 6187.75,-9234.69 6187.75,-9234.69 6183,-9231.02 6184.26,-9227.35 6190.26,-9227.35 6190.26,-9227.35 6698.76,-9227.35 6698.76,-9227.35 6704.76,-9227.35 6715.5,-9231.02 6720.25,-9234.69 6720.25,-9234.69 6838.25,-9326 6838.25,-9326 6843,-9329.67 6841.74,-9333.35 6835.74,-9333.35"/>
<text text-anchor="middle" x="6513" y="-9291.65" font-family="Times,serif" font-size="14.00">Token Router Layer 3 GPU 5</text>
<text text-anchor="middle" x="6513" y="-9276.65" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="6513" y="-9261.65" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer3_gpu5&#45;&gt;route_layer3_gpu5 -->
<g id="edge326" class="edge">
<title>gate_layer3_gpu5&#45;&gt;route_layer3_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6294.89,-9379.53C6324.21,-9366.33 6357.1,-9351.53 6388.27,-9337.49"/>
<polygon fill="black" stroke="black" points="6389.77,-9340.66 6397.45,-9333.36 6386.89,-9334.28 6389.77,-9340.66"/>
</g>
<!-- route_layer3_gpu6 -->
<g id="node305" class="node">
<title>route_layer3_gpu6</title>
<path fill="orange" stroke="black" d="M7730.74,-9333.35C7730.74,-9333.35 7222.24,-9333.35 7222.24,-9333.35 7216.24,-9333.35 7205.5,-9329.67 7200.75,-9326 7200.75,-9326 7082.75,-9234.69 7082.75,-9234.69 7078,-9231.02 7079.26,-9227.35 7085.26,-9227.35 7085.26,-9227.35 7593.76,-9227.35 7593.76,-9227.35 7599.76,-9227.35 7610.5,-9231.02 7615.25,-9234.69 7615.25,-9234.69 7733.25,-9326 7733.25,-9326 7738,-9329.67 7736.74,-9333.35 7730.74,-9333.35"/>
<text text-anchor="middle" x="7408" y="-9291.65" font-family="Times,serif" font-size="14.00">Token Router Layer 3 GPU 6</text>
<text text-anchor="middle" x="7408" y="-9276.65" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="7408" y="-9261.65" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer3_gpu6&#45;&gt;route_layer3_gpu6 -->
<g id="edge327" class="edge">
<title>gate_layer3_gpu6&#45;&gt;route_layer3_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7241.57,-9377.63C7262.88,-9365.3 7286.38,-9351.71 7308.84,-9338.71"/>
<polygon fill="black" stroke="black" points="7310.82,-9341.61 7317.72,-9333.57 7307.31,-9335.55 7310.82,-9341.61"/>
</g>
<!-- route_layer3_gpu7 -->
<g id="node307" class="node">
<title>route_layer3_gpu7</title>
<path fill="orange" stroke="black" d="M8521.74,-9333.35C8521.74,-9333.35 8013.24,-9333.35 8013.24,-9333.35 8007.24,-9333.35 7996.5,-9329.67 7991.75,-9326 7991.75,-9326 7873.75,-9234.69 7873.75,-9234.69 7869,-9231.02 7870.26,-9227.35 7876.26,-9227.35 7876.26,-9227.35 8384.76,-9227.35 8384.76,-9227.35 8390.76,-9227.35 8401.5,-9231.02 8406.25,-9234.69 8406.25,-9234.69 8524.25,-9326 8524.25,-9326 8529,-9329.67 8527.74,-9333.35 8521.74,-9333.35"/>
<text text-anchor="middle" x="8199" y="-9291.65" font-family="Times,serif" font-size="14.00">Token Router Layer 3 GPU 7</text>
<text text-anchor="middle" x="8199" y="-9276.65" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="8199" y="-9261.65" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer3_gpu7&#45;&gt;route_layer3_gpu7 -->
<g id="edge328" class="edge">
<title>gate_layer3_gpu7&#45;&gt;route_layer3_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8154.33,-9371.99C8158.97,-9362.56 8163.89,-9352.59 8168.69,-9342.84"/>
<polygon fill="black" stroke="black" points="8171.97,-9344.1 8173.26,-9333.58 8165.7,-9341 8171.97,-9344.1"/>
</g>
<!-- route_layer3_gpu8 -->
<g id="node309" class="node">
<title>route_layer3_gpu8</title>
<path fill="orange" stroke="black" d="M9347.74,-9333.35C9347.74,-9333.35 8839.24,-9333.35 8839.24,-9333.35 8833.24,-9333.35 8822.5,-9329.67 8817.75,-9326 8817.75,-9326 8699.75,-9234.69 8699.75,-9234.69 8695,-9231.02 8696.26,-9227.35 8702.26,-9227.35 8702.26,-9227.35 9210.76,-9227.35 9210.76,-9227.35 9216.76,-9227.35 9227.5,-9231.02 9232.25,-9234.69 9232.25,-9234.69 9350.25,-9326 9350.25,-9326 9355,-9329.67 9353.74,-9333.35 9347.74,-9333.35"/>
<text text-anchor="middle" x="9025" y="-9291.65" font-family="Times,serif" font-size="14.00">Token Router Layer 3 GPU 8</text>
<text text-anchor="middle" x="9025" y="-9276.65" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="9025" y="-9261.65" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer3_gpu8&#45;&gt;route_layer3_gpu8 -->
<g id="edge329" class="edge">
<title>gate_layer3_gpu8&#45;&gt;route_layer3_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9069.67,-9371.99C9065.03,-9362.56 9060.11,-9352.59 9055.31,-9342.84"/>
<polygon fill="black" stroke="black" points="9058.3,-9341 9050.74,-9333.58 9052.03,-9344.1 9058.3,-9341"/>
</g>
<!-- route_layer3_gpu9 -->
<g id="node311" class="node">
<title>route_layer3_gpu9</title>
<path fill="orange" stroke="black" d="M10242.74,-9333.35C10242.74,-9333.35 9734.24,-9333.35 9734.24,-9333.35 9728.24,-9333.35 9717.5,-9329.67 9712.75,-9326 9712.75,-9326 9594.75,-9234.69 9594.75,-9234.69 9590,-9231.02 9591.26,-9227.35 9597.26,-9227.35 9597.26,-9227.35 10105.76,-9227.35 10105.76,-9227.35 10111.76,-9227.35 10122.5,-9231.02 10127.25,-9234.69 10127.25,-9234.69 10245.25,-9326 10245.25,-9326 10250,-9329.67 10248.74,-9333.35 10242.74,-9333.35"/>
<text text-anchor="middle" x="9920" y="-9291.65" font-family="Times,serif" font-size="14.00">Token Router Layer 3 GPU 9</text>
<text text-anchor="middle" x="9920" y="-9276.65" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="9920" y="-9261.65" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer3_gpu9&#45;&gt;route_layer3_gpu9 -->
<g id="edge330" class="edge">
<title>gate_layer3_gpu9&#45;&gt;route_layer3_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10011.66,-9374.34C10001.13,-9363.65 9989.8,-9352.16 9978.83,-9341.03"/>
<polygon fill="black" stroke="black" points="9981.19,-9338.44 9971.68,-9333.77 9976.2,-9343.35 9981.19,-9338.44"/>
</g>
<!-- route_layer3_gpu10 -->
<g id="node313" class="node">
<title>route_layer3_gpu10</title>
<path fill="orange" stroke="black" d="M11171.74,-9333.35C11171.74,-9333.35 10663.24,-9333.35 10663.24,-9333.35 10657.24,-9333.35 10646.5,-9329.67 10641.75,-9326 10641.75,-9326 10523.75,-9234.69 10523.75,-9234.69 10519,-9231.02 10520.26,-9227.35 10526.26,-9227.35 10526.26,-9227.35 11034.76,-9227.35 11034.76,-9227.35 11040.76,-9227.35 11051.5,-9231.02 11056.25,-9234.69 11056.25,-9234.69 11174.25,-9326 11174.25,-9326 11179,-9329.67 11177.74,-9333.35 11171.74,-9333.35"/>
<text text-anchor="middle" x="10849" y="-9291.65" font-family="Times,serif" font-size="14.00">Token Router Layer 3 GPU 10</text>
<text text-anchor="middle" x="10849" y="-9276.65" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="10849" y="-9261.65" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer3_gpu10&#45;&gt;route_layer3_gpu10 -->
<g id="edge331" class="edge">
<title>gate_layer3_gpu10&#45;&gt;route_layer3_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10965.35,-9375.51C10951.3,-9364.13 10936.05,-9351.79 10921.36,-9339.91"/>
<polygon fill="black" stroke="black" points="10923.24,-9336.93 10913.27,-9333.36 10918.84,-9342.37 10923.24,-9336.93"/>
</g>
<!-- route_layer3_gpu11 -->
<g id="node315" class="node">
<title>route_layer3_gpu11</title>
<path fill="orange" stroke="black" d="M12118.74,-9333.35C12118.74,-9333.35 11610.24,-9333.35 11610.24,-9333.35 11604.24,-9333.35 11593.5,-9329.67 11588.75,-9326 11588.75,-9326 11470.75,-9234.69 11470.75,-9234.69 11466,-9231.02 11467.26,-9227.35 11473.26,-9227.35 11473.26,-9227.35 11981.76,-9227.35 11981.76,-9227.35 11987.76,-9227.35 11998.5,-9231.02 12003.25,-9234.69 12003.25,-9234.69 12121.25,-9326 12121.25,-9326 12126,-9329.67 12124.74,-9333.35 12118.74,-9333.35"/>
<text text-anchor="middle" x="11796" y="-9291.65" font-family="Times,serif" font-size="14.00">Token Router Layer 3 GPU 11</text>
<text text-anchor="middle" x="11796" y="-9276.65" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="11796" y="-9261.65" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer3_gpu11&#45;&gt;route_layer3_gpu11 -->
<g id="edge332" class="edge">
<title>gate_layer3_gpu11&#45;&gt;route_layer3_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11924.57,-9376.09C11908.74,-9364.41 11891.47,-9351.69 11874.87,-9339.46"/>
<polygon fill="black" stroke="black" points="11876.92,-9336.62 11866.79,-9333.51 11872.77,-9342.26 11876.92,-9336.62"/>
</g>
<!-- route_layer3_gpu12 -->
<g id="node317" class="node">
<title>route_layer3_gpu12</title>
<path fill="orange" stroke="black" d="M13073.74,-9333.35C13073.74,-9333.35 12565.24,-9333.35 12565.24,-9333.35 12559.24,-9333.35 12548.5,-9329.67 12543.75,-9326 12543.75,-9326 12425.75,-9234.69 12425.75,-9234.69 12421,-9231.02 12422.26,-9227.35 12428.26,-9227.35 12428.26,-9227.35 12936.76,-9227.35 12936.76,-9227.35 12942.76,-9227.35 12953.5,-9231.02 12958.25,-9234.69 12958.25,-9234.69 13076.25,-9326 13076.25,-9326 13081,-9329.67 13079.74,-9333.35 13073.74,-9333.35"/>
<text text-anchor="middle" x="12751" y="-9291.65" font-family="Times,serif" font-size="14.00">Token Router Layer 3 GPU 12</text>
<text text-anchor="middle" x="12751" y="-9276.65" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="12751" y="-9261.65" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer3_gpu12&#45;&gt;route_layer3_gpu12 -->
<g id="edge333" class="edge">
<title>gate_layer3_gpu12&#45;&gt;route_layer3_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12886.21,-9376.47C12869.51,-9364.72 12851.25,-9351.88 12833.71,-9339.54"/>
<polygon fill="black" stroke="black" points="12835.36,-9336.42 12825.17,-9333.53 12831.34,-9342.14 12835.36,-9336.42"/>
</g>
<!-- route_layer3_gpu13 -->
<g id="node319" class="node">
<title>route_layer3_gpu13</title>
<path fill="orange" stroke="black" d="M14033.74,-9333.35C14033.74,-9333.35 13525.24,-9333.35 13525.24,-9333.35 13519.24,-9333.35 13508.5,-9329.67 13503.75,-9326 13503.75,-9326 13385.75,-9234.69 13385.75,-9234.69 13381,-9231.02 13382.26,-9227.35 13388.26,-9227.35 13388.26,-9227.35 13896.76,-9227.35 13896.76,-9227.35 13902.76,-9227.35 13913.5,-9231.02 13918.25,-9234.69 13918.25,-9234.69 14036.25,-9326 14036.25,-9326 14041,-9329.67 14039.74,-9333.35 14033.74,-9333.35"/>
<text text-anchor="middle" x="13711" y="-9291.65" font-family="Times,serif" font-size="14.00">Token Router Layer 3 GPU 13</text>
<text text-anchor="middle" x="13711" y="-9276.65" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="13711" y="-9261.65" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer3_gpu13&#45;&gt;route_layer3_gpu13 -->
<g id="edge334" class="edge">
<title>gate_layer3_gpu13&#45;&gt;route_layer3_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13848.93,-9376.47C13831.89,-9364.72 13813.27,-9351.88 13795.38,-9339.54"/>
<polygon fill="black" stroke="black" points="13796.88,-9336.32 13786.66,-9333.53 13792.91,-9342.09 13796.88,-9336.32"/>
</g>
<!-- route_layer3_gpu14 -->
<g id="node321" class="node">
<title>route_layer3_gpu14</title>
<path fill="orange" stroke="black" d="M14995.74,-9333.35C14995.74,-9333.35 14487.24,-9333.35 14487.24,-9333.35 14481.24,-9333.35 14470.5,-9329.67 14465.75,-9326 14465.75,-9326 14347.75,-9234.69 14347.75,-9234.69 14343,-9231.02 14344.26,-9227.35 14350.26,-9227.35 14350.26,-9227.35 14858.76,-9227.35 14858.76,-9227.35 14864.76,-9227.35 14875.5,-9231.02 14880.25,-9234.69 14880.25,-9234.69 14998.25,-9326 14998.25,-9326 15003,-9329.67 15001.74,-9333.35 14995.74,-9333.35"/>
<text text-anchor="middle" x="14673" y="-9291.65" font-family="Times,serif" font-size="14.00">Token Router Layer 3 GPU 14</text>
<text text-anchor="middle" x="14673" y="-9276.65" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="14673" y="-9261.65" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer3_gpu14&#45;&gt;route_layer3_gpu14 -->
<g id="edge335" class="edge">
<title>gate_layer3_gpu14&#45;&gt;route_layer3_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14812.57,-9376.66C14795.1,-9364.73 14775.96,-9351.66 14757.61,-9339.13"/>
<polygon fill="black" stroke="black" points="14759.47,-9336.16 14749.24,-9333.41 14755.52,-9341.94 14759.47,-9336.16"/>
</g>
<!-- route_layer3_gpu15 -->
<g id="node323" class="node">
<title>route_layer3_gpu15</title>
<path fill="orange" stroke="black" d="M15958.74,-9333.35C15958.74,-9333.35 15450.24,-9333.35 15450.24,-9333.35 15444.24,-9333.35 15433.5,-9329.67 15428.75,-9326 15428.75,-9326 15310.75,-9234.69 15310.75,-9234.69 15306,-9231.02 15307.26,-9227.35 15313.26,-9227.35 15313.26,-9227.35 15821.76,-9227.35 15821.76,-9227.35 15827.76,-9227.35 15838.5,-9231.02 15843.25,-9234.69 15843.25,-9234.69 15961.25,-9326 15961.25,-9326 15966,-9329.67 15964.74,-9333.35 15958.74,-9333.35"/>
<text text-anchor="middle" x="15636" y="-9291.65" font-family="Times,serif" font-size="14.00">Token Router Layer 3 GPU 15</text>
<text text-anchor="middle" x="15636" y="-9276.65" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="15636" y="-9261.65" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer3_gpu15&#45;&gt;route_layer3_gpu15 -->
<g id="edge336" class="edge">
<title>gate_layer3_gpu15&#45;&gt;route_layer3_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15776.25,-9376.66C15758.69,-9364.73 15739.46,-9351.66 15721.02,-9339.13"/>
<polygon fill="black" stroke="black" points="15722.85,-9336.14 15712.61,-9333.41 15718.91,-9341.93 15722.85,-9336.14"/>
</g>
<!-- expert_layer3_gpu0_expert0 -->
<g id="node277" class="node">
<title>expert_layer3_gpu0_expert0</title>
<path fill="lightcoral" stroke="black" d="M1887.5,-9080.39C1887.5,-9080.39 1418.5,-9080.39 1418.5,-9080.39 1412.5,-9080.39 1406.5,-9074.39 1406.5,-9068.39 1406.5,-9068.39 1406.5,-9024.39 1406.5,-9024.39 1406.5,-9018.39 1412.5,-9012.39 1418.5,-9012.39 1418.5,-9012.39 1887.5,-9012.39 1887.5,-9012.39 1893.5,-9012.39 1899.5,-9018.39 1899.5,-9024.39 1899.5,-9024.39 1899.5,-9068.39 1899.5,-9068.39 1899.5,-9074.39 1893.5,-9080.39 1887.5,-9080.39"/>
<text text-anchor="middle" x="1653" y="-9065.19" font-family="Times,serif" font-size="14.00">Expert 0 Layer 3 GPU 0</text>
<text text-anchor="middle" x="1653" y="-9050.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="1653" y="-9035.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="1653" y="-9020.19" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer3_gpu0 -->
<g id="node294" class="node">
<title>aggregate_layer3_gpu0</title>
<path fill="orange" stroke="black" d="M1887.29,-8976.39C1887.29,-8976.39 1400.19,-8976.39 1400.19,-8976.39 1394.19,-8976.39 1383.52,-8972.63 1378.85,-8968.86 1378.85,-8968.86 1266.06,-8877.92 1266.06,-8877.92 1261.38,-8874.16 1262.71,-8870.39 1268.71,-8870.39 1268.71,-8870.39 1755.81,-8870.39 1755.81,-8870.39 1761.81,-8870.39 1772.48,-8874.16 1777.15,-8877.92 1777.15,-8877.92 1889.94,-8968.86 1889.94,-8968.86 1894.62,-8972.63 1893.29,-8976.39 1887.29,-8976.39"/>
<text text-anchor="middle" x="1578" y="-8934.69" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 3 GPU 0</text>
<text text-anchor="middle" x="1578" y="-8919.69" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="1578" y="-8904.69" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer3_gpu0_expert0&#45;&gt;aggregate_layer3_gpu0 -->
<g id="edge369" class="edge">
<title>expert_layer3_gpu0_expert0&#45;&gt;aggregate_layer3_gpu0</title>
<path fill="none" stroke="black" d="M1632.51,-9012.33C1627.26,-9003.86 1621.45,-8994.49 1615.63,-8985.11"/>
<polygon fill="black" stroke="black" points="1618.55,-8983.18 1610.31,-8976.52 1612.6,-8986.86 1618.55,-8983.18"/>
</g>
<!-- expert_layer3_gpu1_expert1 -->
<g id="node278" class="node">
<title>expert_layer3_gpu1_expert1</title>
<path fill="lightcoral" stroke="black" d="M3778.5,-9080.39C3778.5,-9080.39 3309.5,-9080.39 3309.5,-9080.39 3303.5,-9080.39 3297.5,-9074.39 3297.5,-9068.39 3297.5,-9068.39 3297.5,-9024.39 3297.5,-9024.39 3297.5,-9018.39 3303.5,-9012.39 3309.5,-9012.39 3309.5,-9012.39 3778.5,-9012.39 3778.5,-9012.39 3784.5,-9012.39 3790.5,-9018.39 3790.5,-9024.39 3790.5,-9024.39 3790.5,-9068.39 3790.5,-9068.39 3790.5,-9074.39 3784.5,-9080.39 3778.5,-9080.39"/>
<text text-anchor="middle" x="3544" y="-9065.19" font-family="Times,serif" font-size="14.00">Expert 1 Layer 3 GPU 1</text>
<text text-anchor="middle" x="3544" y="-9050.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3544" y="-9035.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3544" y="-9020.19" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer3_gpu1 -->
<g id="node296" class="node">
<title>aggregate_layer3_gpu1</title>
<path fill="orange" stroke="black" d="M3532.29,-8976.39C3532.29,-8976.39 3045.19,-8976.39 3045.19,-8976.39 3039.19,-8976.39 3028.52,-8972.63 3023.85,-8968.86 3023.85,-8968.86 2911.06,-8877.92 2911.06,-8877.92 2906.38,-8874.16 2907.71,-8870.39 2913.71,-8870.39 2913.71,-8870.39 3400.81,-8870.39 3400.81,-8870.39 3406.81,-8870.39 3417.48,-8874.16 3422.15,-8877.92 3422.15,-8877.92 3534.94,-8968.86 3534.94,-8968.86 3539.62,-8972.63 3538.29,-8976.39 3532.29,-8976.39"/>
<text text-anchor="middle" x="3223" y="-8934.69" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 3 GPU 1</text>
<text text-anchor="middle" x="3223" y="-8919.69" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="3223" y="-8904.69" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer3_gpu1_expert1&#45;&gt;aggregate_layer3_gpu1 -->
<g id="edge370" class="edge">
<title>expert_layer3_gpu1_expert1&#45;&gt;aggregate_layer3_gpu1</title>
<path fill="none" stroke="black" d="M3456.29,-9012.33C3429.74,-9002.32 3399.82,-8991.04 3370.48,-8979.99"/>
<polygon fill="black" stroke="black" points="3371.57,-8976.66 3360.98,-8976.4 3369.1,-8983.21 3371.57,-8976.66"/>
</g>
<!-- expert_layer3_gpu2_expert2 -->
<g id="node279" class="node">
<title>expert_layer3_gpu2_expert2</title>
<path fill="lightcoral" stroke="black" d="M4808.5,-9080.39C4808.5,-9080.39 4339.5,-9080.39 4339.5,-9080.39 4333.5,-9080.39 4327.5,-9074.39 4327.5,-9068.39 4327.5,-9068.39 4327.5,-9024.39 4327.5,-9024.39 4327.5,-9018.39 4333.5,-9012.39 4339.5,-9012.39 4339.5,-9012.39 4808.5,-9012.39 4808.5,-9012.39 4814.5,-9012.39 4820.5,-9018.39 4820.5,-9024.39 4820.5,-9024.39 4820.5,-9068.39 4820.5,-9068.39 4820.5,-9074.39 4814.5,-9080.39 4808.5,-9080.39"/>
<text text-anchor="middle" x="4574" y="-9065.19" font-family="Times,serif" font-size="14.00">Expert 2 Layer 3 GPU 2</text>
<text text-anchor="middle" x="4574" y="-9050.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4574" y="-9035.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4574" y="-9020.19" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer3_gpu2 -->
<g id="node298" class="node">
<title>aggregate_layer3_gpu2</title>
<path fill="orange" stroke="black" d="M4685.29,-8976.39C4685.29,-8976.39 4198.19,-8976.39 4198.19,-8976.39 4192.19,-8976.39 4181.52,-8972.63 4176.85,-8968.86 4176.85,-8968.86 4064.06,-8877.92 4064.06,-8877.92 4059.38,-8874.16 4060.71,-8870.39 4066.71,-8870.39 4066.71,-8870.39 4553.81,-8870.39 4553.81,-8870.39 4559.81,-8870.39 4570.48,-8874.16 4575.15,-8877.92 4575.15,-8877.92 4687.94,-8968.86 4687.94,-8968.86 4692.62,-8972.63 4691.29,-8976.39 4685.29,-8976.39"/>
<text text-anchor="middle" x="4376" y="-8934.69" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 3 GPU 2</text>
<text text-anchor="middle" x="4376" y="-8919.69" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="4376" y="-8904.69" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer3_gpu2_expert2&#45;&gt;aggregate_layer3_gpu2 -->
<g id="edge371" class="edge">
<title>expert_layer3_gpu2_expert2&#45;&gt;aggregate_layer3_gpu2</title>
<path fill="none" stroke="black" d="M4519.9,-9012.33C4504.49,-9002.91 4487.24,-8992.38 4470.19,-8981.95"/>
<polygon fill="black" stroke="black" points="4471.66,-8978.75 4461.3,-8976.52 4468.01,-8984.72 4471.66,-8978.75"/>
</g>
<!-- expert_layer3_gpu3_expert3 -->
<g id="node280" class="node">
<title>expert_layer3_gpu3_expert3</title>
<path fill="lightcoral" stroke="black" d="M5653.5,-9080.39C5653.5,-9080.39 5184.5,-9080.39 5184.5,-9080.39 5178.5,-9080.39 5172.5,-9074.39 5172.5,-9068.39 5172.5,-9068.39 5172.5,-9024.39 5172.5,-9024.39 5172.5,-9018.39 5178.5,-9012.39 5184.5,-9012.39 5184.5,-9012.39 5653.5,-9012.39 5653.5,-9012.39 5659.5,-9012.39 5665.5,-9018.39 5665.5,-9024.39 5665.5,-9024.39 5665.5,-9068.39 5665.5,-9068.39 5665.5,-9074.39 5659.5,-9080.39 5653.5,-9080.39"/>
<text text-anchor="middle" x="5419" y="-9065.19" font-family="Times,serif" font-size="14.00">Expert 3 Layer 3 GPU 3</text>
<text text-anchor="middle" x="5419" y="-9050.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5419" y="-9035.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5419" y="-9020.19" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer3_gpu3 -->
<g id="node300" class="node">
<title>aggregate_layer3_gpu3</title>
<path fill="orange" stroke="black" d="M5592.29,-8976.39C5592.29,-8976.39 5105.19,-8976.39 5105.19,-8976.39 5099.19,-8976.39 5088.52,-8972.63 5083.85,-8968.86 5083.85,-8968.86 4971.06,-8877.92 4971.06,-8877.92 4966.38,-8874.16 4967.71,-8870.39 4973.71,-8870.39 4973.71,-8870.39 5460.81,-8870.39 5460.81,-8870.39 5466.81,-8870.39 5477.48,-8874.16 5482.15,-8877.92 5482.15,-8877.92 5594.94,-8968.86 5594.94,-8968.86 5599.62,-8972.63 5598.29,-8976.39 5592.29,-8976.39"/>
<text text-anchor="middle" x="5283" y="-8934.69" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 3 GPU 3</text>
<text text-anchor="middle" x="5283" y="-8919.69" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="5283" y="-8904.69" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer3_gpu3_expert3&#45;&gt;aggregate_layer3_gpu3 -->
<g id="edge372" class="edge">
<title>expert_layer3_gpu3_expert3&#45;&gt;aggregate_layer3_gpu3</title>
<path fill="none" stroke="black" d="M5381.84,-9012.33C5371.74,-9003.35 5360.49,-8993.34 5349.31,-8983.39"/>
<polygon fill="black" stroke="black" points="5351.39,-8980.55 5341.59,-8976.52 5346.73,-8985.78 5351.39,-8980.55"/>
</g>
<!-- expert_layer3_gpu4_expert4 -->
<g id="node281" class="node">
<title>expert_layer3_gpu4_expert4</title>
<path fill="lightcoral" stroke="black" d="M6452.5,-9080.39C6452.5,-9080.39 5983.5,-9080.39 5983.5,-9080.39 5977.5,-9080.39 5971.5,-9074.39 5971.5,-9068.39 5971.5,-9068.39 5971.5,-9024.39 5971.5,-9024.39 5971.5,-9018.39 5977.5,-9012.39 5983.5,-9012.39 5983.5,-9012.39 6452.5,-9012.39 6452.5,-9012.39 6458.5,-9012.39 6464.5,-9018.39 6464.5,-9024.39 6464.5,-9024.39 6464.5,-9068.39 6464.5,-9068.39 6464.5,-9074.39 6458.5,-9080.39 6452.5,-9080.39"/>
<text text-anchor="middle" x="6218" y="-9065.19" font-family="Times,serif" font-size="14.00">Expert 4 Layer 3 GPU 4</text>
<text text-anchor="middle" x="6218" y="-9050.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6218" y="-9035.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6218" y="-9020.19" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer3_gpu4 -->
<g id="node302" class="node">
<title>aggregate_layer3_gpu4</title>
<path fill="orange" stroke="black" d="M6376.29,-8976.39C6376.29,-8976.39 5889.19,-8976.39 5889.19,-8976.39 5883.19,-8976.39 5872.52,-8972.63 5867.85,-8968.86 5867.85,-8968.86 5755.06,-8877.92 5755.06,-8877.92 5750.38,-8874.16 5751.71,-8870.39 5757.71,-8870.39 5757.71,-8870.39 6244.81,-8870.39 6244.81,-8870.39 6250.81,-8870.39 6261.48,-8874.16 6266.15,-8877.92 6266.15,-8877.92 6378.94,-8968.86 6378.94,-8968.86 6383.62,-8972.63 6382.29,-8976.39 6376.29,-8976.39"/>
<text text-anchor="middle" x="6067" y="-8934.69" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 3 GPU 4</text>
<text text-anchor="middle" x="6067" y="-8919.69" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="6067" y="-8904.69" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer3_gpu4_expert4&#45;&gt;aggregate_layer3_gpu4 -->
<g id="edge373" class="edge">
<title>expert_layer3_gpu4_expert4&#45;&gt;aggregate_layer3_gpu4</title>
<path fill="none" stroke="black" d="M6176.74,-9012.33C6165.31,-9003.17 6152.56,-8992.95 6139.91,-8982.81"/>
<polygon fill="black" stroke="black" points="6142.04,-8980.04 6132.05,-8976.52 6137.67,-8985.5 6142.04,-8980.04"/>
</g>
<!-- expert_layer3_gpu5_expert5 -->
<g id="node282" class="node">
<title>expert_layer3_gpu5_expert5</title>
<path fill="lightcoral" stroke="black" d="M7180.5,-9080.39C7180.5,-9080.39 6711.5,-9080.39 6711.5,-9080.39 6705.5,-9080.39 6699.5,-9074.39 6699.5,-9068.39 6699.5,-9068.39 6699.5,-9024.39 6699.5,-9024.39 6699.5,-9018.39 6705.5,-9012.39 6711.5,-9012.39 6711.5,-9012.39 7180.5,-9012.39 7180.5,-9012.39 7186.5,-9012.39 7192.5,-9018.39 7192.5,-9024.39 7192.5,-9024.39 7192.5,-9068.39 7192.5,-9068.39 7192.5,-9074.39 7186.5,-9080.39 7180.5,-9080.39"/>
<text text-anchor="middle" x="6946" y="-9065.19" font-family="Times,serif" font-size="14.00">Expert 5 Layer 3 GPU 5</text>
<text text-anchor="middle" x="6946" y="-9050.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6946" y="-9035.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6946" y="-9020.19" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer3_gpu5 -->
<g id="node304" class="node">
<title>aggregate_layer3_gpu5</title>
<path fill="orange" stroke="black" d="M7099.29,-8976.39C7099.29,-8976.39 6612.19,-8976.39 6612.19,-8976.39 6606.19,-8976.39 6595.52,-8972.63 6590.85,-8968.86 6590.85,-8968.86 6478.06,-8877.92 6478.06,-8877.92 6473.38,-8874.16 6474.71,-8870.39 6480.71,-8870.39 6480.71,-8870.39 6967.81,-8870.39 6967.81,-8870.39 6973.81,-8870.39 6984.48,-8874.16 6989.15,-8877.92 6989.15,-8877.92 7101.94,-8968.86 7101.94,-8968.86 7106.62,-8972.63 7105.29,-8976.39 7099.29,-8976.39"/>
<text text-anchor="middle" x="6790" y="-8934.69" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 3 GPU 5</text>
<text text-anchor="middle" x="6790" y="-8919.69" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="6790" y="-8904.69" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer3_gpu5_expert5&#45;&gt;aggregate_layer3_gpu5 -->
<g id="edge374" class="edge">
<title>expert_layer3_gpu5_expert5&#45;&gt;aggregate_layer3_gpu5</title>
<path fill="none" stroke="black" d="M6903.37,-9012.33C6891.57,-9003.17 6878.39,-8992.95 6865.32,-8982.81"/>
<polygon fill="black" stroke="black" points="6867.25,-8979.88 6857.2,-8976.52 6862.96,-8985.41 6867.25,-8979.88"/>
</g>
<!-- expert_layer3_gpu6_expert6 -->
<g id="node283" class="node">
<title>expert_layer3_gpu6_expert6</title>
<path fill="lightcoral" stroke="black" d="M7864.5,-9080.39C7864.5,-9080.39 7395.5,-9080.39 7395.5,-9080.39 7389.5,-9080.39 7383.5,-9074.39 7383.5,-9068.39 7383.5,-9068.39 7383.5,-9024.39 7383.5,-9024.39 7383.5,-9018.39 7389.5,-9012.39 7395.5,-9012.39 7395.5,-9012.39 7864.5,-9012.39 7864.5,-9012.39 7870.5,-9012.39 7876.5,-9018.39 7876.5,-9024.39 7876.5,-9024.39 7876.5,-9068.39 7876.5,-9068.39 7876.5,-9074.39 7870.5,-9080.39 7864.5,-9080.39"/>
<text text-anchor="middle" x="7630" y="-9065.19" font-family="Times,serif" font-size="14.00">Expert 6 Layer 3 GPU 6</text>
<text text-anchor="middle" x="7630" y="-9050.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7630" y="-9035.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7630" y="-9020.19" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer3_gpu6 -->
<g id="node306" class="node">
<title>aggregate_layer3_gpu6</title>
<path fill="orange" stroke="black" d="M7791.29,-8976.39C7791.29,-8976.39 7304.19,-8976.39 7304.19,-8976.39 7298.19,-8976.39 7287.52,-8972.63 7282.85,-8968.86 7282.85,-8968.86 7170.06,-8877.92 7170.06,-8877.92 7165.38,-8874.16 7166.71,-8870.39 7172.71,-8870.39 7172.71,-8870.39 7659.81,-8870.39 7659.81,-8870.39 7665.81,-8870.39 7676.48,-8874.16 7681.15,-8877.92 7681.15,-8877.92 7793.94,-8968.86 7793.94,-8968.86 7798.62,-8972.63 7797.29,-8976.39 7791.29,-8976.39"/>
<text text-anchor="middle" x="7482" y="-8934.69" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 3 GPU 6</text>
<text text-anchor="middle" x="7482" y="-8919.69" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="7482" y="-8904.69" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer3_gpu6_expert6&#45;&gt;aggregate_layer3_gpu6 -->
<g id="edge375" class="edge">
<title>expert_layer3_gpu6_expert6&#45;&gt;aggregate_layer3_gpu6</title>
<path fill="none" stroke="black" d="M7589.56,-9012.33C7578.47,-9003.26 7566.1,-8993.15 7553.81,-8983.1"/>
<polygon fill="black" stroke="black" points="7555.72,-8980.14 7545.76,-8976.52 7551.29,-8985.56 7555.72,-8980.14"/>
</g>
<!-- expert_layer3_gpu7_expert7 -->
<g id="node284" class="node">
<title>expert_layer3_gpu7_expert7</title>
<path fill="lightcoral" stroke="black" d="M8457.5,-9080.39C8457.5,-9080.39 7988.5,-9080.39 7988.5,-9080.39 7982.5,-9080.39 7976.5,-9074.39 7976.5,-9068.39 7976.5,-9068.39 7976.5,-9024.39 7976.5,-9024.39 7976.5,-9018.39 7982.5,-9012.39 7988.5,-9012.39 7988.5,-9012.39 8457.5,-9012.39 8457.5,-9012.39 8463.5,-9012.39 8469.5,-9018.39 8469.5,-9024.39 8469.5,-9024.39 8469.5,-9068.39 8469.5,-9068.39 8469.5,-9074.39 8463.5,-9080.39 8457.5,-9080.39"/>
<text text-anchor="middle" x="8223" y="-9065.19" font-family="Times,serif" font-size="14.00">Expert 7 Layer 3 GPU 7</text>
<text text-anchor="middle" x="8223" y="-9050.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8223" y="-9035.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8223" y="-9020.19" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer3_gpu7 -->
<g id="node308" class="node">
<title>aggregate_layer3_gpu7</title>
<path fill="orange" stroke="black" d="M8467.29,-8976.39C8467.29,-8976.39 7980.19,-8976.39 7980.19,-8976.39 7974.19,-8976.39 7963.52,-8972.63 7958.85,-8968.86 7958.85,-8968.86 7846.06,-8877.92 7846.06,-8877.92 7841.38,-8874.16 7842.71,-8870.39 7848.71,-8870.39 7848.71,-8870.39 8335.81,-8870.39 8335.81,-8870.39 8341.81,-8870.39 8352.48,-8874.16 8357.15,-8877.92 8357.15,-8877.92 8469.94,-8968.86 8469.94,-8968.86 8474.62,-8972.63 8473.29,-8976.39 8467.29,-8976.39"/>
<text text-anchor="middle" x="8158" y="-8934.69" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 3 GPU 7</text>
<text text-anchor="middle" x="8158" y="-8919.69" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="8158" y="-8904.69" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer3_gpu7_expert7&#45;&gt;aggregate_layer3_gpu7 -->
<g id="edge376" class="edge">
<title>expert_layer3_gpu7_expert7&#45;&gt;aggregate_layer3_gpu7</title>
<path fill="none" stroke="black" d="M8205.24,-9012.33C8200.74,-9003.95 8195.76,-8994.68 8190.77,-8985.4"/>
<polygon fill="black" stroke="black" points="8193.82,-8983.67 8186,-8976.52 8187.65,-8986.99 8193.82,-8983.67"/>
</g>
<!-- expert_layer3_gpu8_expert8 -->
<g id="node285" class="node">
<title>expert_layer3_gpu8_expert8</title>
<path fill="lightcoral" stroke="black" d="M9097.5,-9080.39C9097.5,-9080.39 8628.5,-9080.39 8628.5,-9080.39 8622.5,-9080.39 8616.5,-9074.39 8616.5,-9068.39 8616.5,-9068.39 8616.5,-9024.39 8616.5,-9024.39 8616.5,-9018.39 8622.5,-9012.39 8628.5,-9012.39 8628.5,-9012.39 9097.5,-9012.39 9097.5,-9012.39 9103.5,-9012.39 9109.5,-9018.39 9109.5,-9024.39 9109.5,-9024.39 9109.5,-9068.39 9109.5,-9068.39 9109.5,-9074.39 9103.5,-9080.39 9097.5,-9080.39"/>
<text text-anchor="middle" x="8863" y="-9065.19" font-family="Times,serif" font-size="14.00">Expert 8 Layer 3 GPU 8</text>
<text text-anchor="middle" x="8863" y="-9050.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8863" y="-9035.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8863" y="-9020.19" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer3_gpu8 -->
<g id="node310" class="node">
<title>aggregate_layer3_gpu8</title>
<path fill="orange" stroke="black" d="M9237.29,-8976.39C9237.29,-8976.39 8750.19,-8976.39 8750.19,-8976.39 8744.19,-8976.39 8733.52,-8972.63 8728.85,-8968.86 8728.85,-8968.86 8616.06,-8877.92 8616.06,-8877.92 8611.38,-8874.16 8612.71,-8870.39 8618.71,-8870.39 8618.71,-8870.39 9105.81,-8870.39 9105.81,-8870.39 9111.81,-8870.39 9122.48,-8874.16 9127.15,-8877.92 9127.15,-8877.92 9239.94,-8968.86 9239.94,-8968.86 9244.62,-8972.63 9243.29,-8976.39 9237.29,-8976.39"/>
<text text-anchor="middle" x="8928" y="-8934.69" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 3 GPU 8</text>
<text text-anchor="middle" x="8928" y="-8919.69" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="8928" y="-8904.69" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer3_gpu8_expert8&#45;&gt;aggregate_layer3_gpu8 -->
<g id="edge377" class="edge">
<title>expert_layer3_gpu8_expert8&#45;&gt;aggregate_layer3_gpu8</title>
<path fill="none" stroke="black" d="M8880.76,-9012.33C8885.26,-9003.95 8890.24,-8994.68 8895.23,-8985.4"/>
<polygon fill="black" stroke="black" points="8898.35,-8986.99 8900,-8976.52 8892.18,-8983.67 8898.35,-8986.99"/>
</g>
<!-- expert_layer3_gpu9_expert9 -->
<g id="node286" class="node">
<title>expert_layer3_gpu9_expert9</title>
<path fill="lightcoral" stroke="black" d="M9851.5,-9080.39C9851.5,-9080.39 9382.5,-9080.39 9382.5,-9080.39 9376.5,-9080.39 9370.5,-9074.39 9370.5,-9068.39 9370.5,-9068.39 9370.5,-9024.39 9370.5,-9024.39 9370.5,-9018.39 9376.5,-9012.39 9382.5,-9012.39 9382.5,-9012.39 9851.5,-9012.39 9851.5,-9012.39 9857.5,-9012.39 9863.5,-9018.39 9863.5,-9024.39 9863.5,-9024.39 9863.5,-9068.39 9863.5,-9068.39 9863.5,-9074.39 9857.5,-9080.39 9851.5,-9080.39"/>
<text text-anchor="middle" x="9617" y="-9065.19" font-family="Times,serif" font-size="14.00">Expert 9 Layer 3 GPU 9</text>
<text text-anchor="middle" x="9617" y="-9050.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9617" y="-9035.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9617" y="-9020.19" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer3_gpu9 -->
<g id="node312" class="node">
<title>aggregate_layer3_gpu9</title>
<path fill="orange" stroke="black" d="M10104.29,-8976.39C10104.29,-8976.39 9617.19,-8976.39 9617.19,-8976.39 9611.19,-8976.39 9600.52,-8972.63 9595.85,-8968.86 9595.85,-8968.86 9483.06,-8877.92 9483.06,-8877.92 9478.38,-8874.16 9479.71,-8870.39 9485.71,-8870.39 9485.71,-8870.39 9972.81,-8870.39 9972.81,-8870.39 9978.81,-8870.39 9989.48,-8874.16 9994.15,-8877.92 9994.15,-8877.92 10106.94,-8968.86 10106.94,-8968.86 10111.62,-8972.63 10110.29,-8976.39 10104.29,-8976.39"/>
<text text-anchor="middle" x="9795" y="-8934.69" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 3 GPU 9</text>
<text text-anchor="middle" x="9795" y="-8919.69" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="9795" y="-8904.69" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer3_gpu9_expert9&#45;&gt;aggregate_layer3_gpu9 -->
<g id="edge378" class="edge">
<title>expert_layer3_gpu9_expert9&#45;&gt;aggregate_layer3_gpu9</title>
<path fill="none" stroke="black" d="M9665.64,-9012.33C9679.36,-9003 9694.71,-8992.57 9709.9,-8982.24"/>
<polygon fill="black" stroke="black" points="9712.01,-8985.04 9718.32,-8976.52 9708.08,-8979.25 9712.01,-8985.04"/>
</g>
<!-- expert_layer3_gpu10_expert10 -->
<g id="node287" class="node">
<title>expert_layer3_gpu10_expert10</title>
<path fill="lightcoral" stroke="black" d="M10685.5,-9080.39C10685.5,-9080.39 10216.5,-9080.39 10216.5,-9080.39 10210.5,-9080.39 10204.5,-9074.39 10204.5,-9068.39 10204.5,-9068.39 10204.5,-9024.39 10204.5,-9024.39 10204.5,-9018.39 10210.5,-9012.39 10216.5,-9012.39 10216.5,-9012.39 10685.5,-9012.39 10685.5,-9012.39 10691.5,-9012.39 10697.5,-9018.39 10697.5,-9024.39 10697.5,-9024.39 10697.5,-9068.39 10697.5,-9068.39 10697.5,-9074.39 10691.5,-9080.39 10685.5,-9080.39"/>
<text text-anchor="middle" x="10451" y="-9065.19" font-family="Times,serif" font-size="14.00">Expert 10 Layer 3 GPU 10</text>
<text text-anchor="middle" x="10451" y="-9050.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10451" y="-9035.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10451" y="-9020.19" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer3_gpu10 -->
<g id="node314" class="node">
<title>aggregate_layer3_gpu10</title>
<path fill="orange" stroke="black" d="M11019.29,-8976.39C11019.29,-8976.39 10532.19,-8976.39 10532.19,-8976.39 10526.19,-8976.39 10515.52,-8972.63 10510.85,-8968.86 10510.85,-8968.86 10398.06,-8877.92 10398.06,-8877.92 10393.38,-8874.16 10394.71,-8870.39 10400.71,-8870.39 10400.71,-8870.39 10887.81,-8870.39 10887.81,-8870.39 10893.81,-8870.39 10904.48,-8874.16 10909.15,-8877.92 10909.15,-8877.92 11021.94,-8968.86 11021.94,-8968.86 11026.62,-8972.63 11025.29,-8976.39 11019.29,-8976.39"/>
<text text-anchor="middle" x="10710" y="-8934.69" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 3 GPU 10</text>
<text text-anchor="middle" x="10710" y="-8919.69" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="10710" y="-8904.69" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer3_gpu10_expert10&#45;&gt;aggregate_layer3_gpu10 -->
<g id="edge379" class="edge">
<title>expert_layer3_gpu10_expert10&#45;&gt;aggregate_layer3_gpu10</title>
<path fill="none" stroke="black" d="M10521.77,-9012.33C10542.66,-9002.57 10566.14,-8991.6 10589.25,-8980.81"/>
<polygon fill="black" stroke="black" points="10590.84,-8983.92 10598.42,-8976.52 10587.88,-8977.58 10590.84,-8983.92"/>
</g>
<!-- expert_layer3_gpu11_expert11 -->
<g id="node288" class="node">
<title>expert_layer3_gpu11_expert11</title>
<path fill="lightcoral" stroke="black" d="M11572.5,-9080.39C11572.5,-9080.39 11103.5,-9080.39 11103.5,-9080.39 11097.5,-9080.39 11091.5,-9074.39 11091.5,-9068.39 11091.5,-9068.39 11091.5,-9024.39 11091.5,-9024.39 11091.5,-9018.39 11097.5,-9012.39 11103.5,-9012.39 11103.5,-9012.39 11572.5,-9012.39 11572.5,-9012.39 11578.5,-9012.39 11584.5,-9018.39 11584.5,-9024.39 11584.5,-9024.39 11584.5,-9068.39 11584.5,-9068.39 11584.5,-9074.39 11578.5,-9080.39 11572.5,-9080.39"/>
<text text-anchor="middle" x="11338" y="-9065.19" font-family="Times,serif" font-size="14.00">Expert 11 Layer 3 GPU 11</text>
<text text-anchor="middle" x="11338" y="-9050.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11338" y="-9035.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11338" y="-9020.19" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer3_gpu11 -->
<g id="node316" class="node">
<title>aggregate_layer3_gpu11</title>
<path fill="orange" stroke="black" d="M11959.29,-8976.39C11959.29,-8976.39 11472.19,-8976.39 11472.19,-8976.39 11466.19,-8976.39 11455.52,-8972.63 11450.85,-8968.86 11450.85,-8968.86 11338.06,-8877.92 11338.06,-8877.92 11333.38,-8874.16 11334.71,-8870.39 11340.71,-8870.39 11340.71,-8870.39 11827.81,-8870.39 11827.81,-8870.39 11833.81,-8870.39 11844.48,-8874.16 11849.15,-8877.92 11849.15,-8877.92 11961.94,-8968.86 11961.94,-8968.86 11966.62,-8972.63 11965.29,-8976.39 11959.29,-8976.39"/>
<text text-anchor="middle" x="11650" y="-8934.69" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 3 GPU 11</text>
<text text-anchor="middle" x="11650" y="-8919.69" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="11650" y="-8904.69" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer3_gpu11_expert11&#45;&gt;aggregate_layer3_gpu11 -->
<g id="edge380" class="edge">
<title>expert_layer3_gpu11_expert11&#45;&gt;aggregate_layer3_gpu11</title>
<path fill="none" stroke="black" d="M11423.26,-9012.33C11448.95,-9002.37 11477.89,-8991.14 11506.28,-8980.13"/>
<polygon fill="black" stroke="black" points="11507.83,-8983.28 11515.89,-8976.4 11505.3,-8976.76 11507.83,-8983.28"/>
</g>
<!-- expert_layer3_gpu12_expert12 -->
<g id="node289" class="node">
<title>expert_layer3_gpu12_expert12</title>
<path fill="lightcoral" stroke="black" d="M12492.5,-9080.39C12492.5,-9080.39 12023.5,-9080.39 12023.5,-9080.39 12017.5,-9080.39 12011.5,-9074.39 12011.5,-9068.39 12011.5,-9068.39 12011.5,-9024.39 12011.5,-9024.39 12011.5,-9018.39 12017.5,-9012.39 12023.5,-9012.39 12023.5,-9012.39 12492.5,-9012.39 12492.5,-9012.39 12498.5,-9012.39 12504.5,-9018.39 12504.5,-9024.39 12504.5,-9024.39 12504.5,-9068.39 12504.5,-9068.39 12504.5,-9074.39 12498.5,-9080.39 12492.5,-9080.39"/>
<text text-anchor="middle" x="12258" y="-9065.19" font-family="Times,serif" font-size="14.00">Expert 12 Layer 3 GPU 12</text>
<text text-anchor="middle" x="12258" y="-9050.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12258" y="-9035.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12258" y="-9020.19" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer3_gpu12 -->
<g id="node318" class="node">
<title>aggregate_layer3_gpu12</title>
<path fill="orange" stroke="black" d="M12911.29,-8976.39C12911.29,-8976.39 12424.19,-8976.39 12424.19,-8976.39 12418.19,-8976.39 12407.52,-8972.63 12402.85,-8968.86 12402.85,-8968.86 12290.06,-8877.92 12290.06,-8877.92 12285.38,-8874.16 12286.71,-8870.39 12292.71,-8870.39 12292.71,-8870.39 12779.81,-8870.39 12779.81,-8870.39 12785.81,-8870.39 12796.48,-8874.16 12801.15,-8877.92 12801.15,-8877.92 12913.94,-8968.86 12913.94,-8968.86 12918.62,-8972.63 12917.29,-8976.39 12911.29,-8976.39"/>
<text text-anchor="middle" x="12602" y="-8934.69" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 3 GPU 12</text>
<text text-anchor="middle" x="12602" y="-8919.69" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="12602" y="-8904.69" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer3_gpu12_expert12&#45;&gt;aggregate_layer3_gpu12 -->
<g id="edge381" class="edge">
<title>expert_layer3_gpu12_expert12&#45;&gt;aggregate_layer3_gpu12</title>
<path fill="none" stroke="black" d="M12352,-9012.33C12380.57,-9002.28 12412.79,-8990.95 12444.36,-8979.84"/>
<polygon fill="black" stroke="black" points="12445.86,-8983.02 12454.13,-8976.4 12443.54,-8976.42 12445.86,-8983.02"/>
</g>
<!-- expert_layer3_gpu13_expert13 -->
<g id="node290" class="node">
<title>expert_layer3_gpu13_expert13</title>
<path fill="lightcoral" stroke="black" d="M13409.5,-9080.39C13409.5,-9080.39 12940.5,-9080.39 12940.5,-9080.39 12934.5,-9080.39 12928.5,-9074.39 12928.5,-9068.39 12928.5,-9068.39 12928.5,-9024.39 12928.5,-9024.39 12928.5,-9018.39 12934.5,-9012.39 12940.5,-9012.39 12940.5,-9012.39 13409.5,-9012.39 13409.5,-9012.39 13415.5,-9012.39 13421.5,-9018.39 13421.5,-9024.39 13421.5,-9024.39 13421.5,-9068.39 13421.5,-9068.39 13421.5,-9074.39 13415.5,-9080.39 13409.5,-9080.39"/>
<text text-anchor="middle" x="13175" y="-9065.19" font-family="Times,serif" font-size="14.00">Expert 13 Layer 3 GPU 13</text>
<text text-anchor="middle" x="13175" y="-9050.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="13175" y="-9035.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="13175" y="-9020.19" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer3_gpu13 -->
<g id="node320" class="node">
<title>aggregate_layer3_gpu13</title>
<path fill="orange" stroke="black" d="M13826.29,-8976.39C13826.29,-8976.39 13339.19,-8976.39 13339.19,-8976.39 13333.19,-8976.39 13322.52,-8972.63 13317.85,-8968.86 13317.85,-8968.86 13205.06,-8877.92 13205.06,-8877.92 13200.38,-8874.16 13201.71,-8870.39 13207.71,-8870.39 13207.71,-8870.39 13694.81,-8870.39 13694.81,-8870.39 13700.81,-8870.39 13711.48,-8874.16 13716.15,-8877.92 13716.15,-8877.92 13828.94,-8968.86 13828.94,-8968.86 13833.62,-8972.63 13832.29,-8976.39 13826.29,-8976.39"/>
<text text-anchor="middle" x="13517" y="-8934.69" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 3 GPU 13</text>
<text text-anchor="middle" x="13517" y="-8919.69" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="13517" y="-8904.69" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer3_gpu13_expert13&#45;&gt;aggregate_layer3_gpu13 -->
<g id="edge382" class="edge">
<title>expert_layer3_gpu13_expert13&#45;&gt;aggregate_layer3_gpu13</title>
<path fill="none" stroke="black" d="M13268.45,-9012.33C13296.86,-9002.28 13328.89,-8990.95 13360.28,-8979.84"/>
<polygon fill="black" stroke="black" points="13361.73,-8983.04 13369.99,-8976.4 13359.4,-8976.44 13361.73,-8983.04"/>
</g>
<!-- expert_layer3_gpu14_expert14 -->
<g id="node291" class="node">
<title>expert_layer3_gpu14_expert14</title>
<path fill="lightcoral" stroke="black" d="M14262.5,-9080.39C14262.5,-9080.39 13793.5,-9080.39 13793.5,-9080.39 13787.5,-9080.39 13781.5,-9074.39 13781.5,-9068.39 13781.5,-9068.39 13781.5,-9024.39 13781.5,-9024.39 13781.5,-9018.39 13787.5,-9012.39 13793.5,-9012.39 13793.5,-9012.39 14262.5,-9012.39 14262.5,-9012.39 14268.5,-9012.39 14274.5,-9018.39 14274.5,-9024.39 14274.5,-9024.39 14274.5,-9068.39 14274.5,-9068.39 14274.5,-9074.39 14268.5,-9080.39 14262.5,-9080.39"/>
<text text-anchor="middle" x="14028" y="-9065.19" font-family="Times,serif" font-size="14.00">Expert 14 Layer 3 GPU 14</text>
<text text-anchor="middle" x="14028" y="-9050.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14028" y="-9035.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14028" y="-9020.19" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer3_gpu14 -->
<g id="node322" class="node">
<title>aggregate_layer3_gpu14</title>
<path fill="orange" stroke="black" d="M14614.29,-8976.39C14614.29,-8976.39 14127.19,-8976.39 14127.19,-8976.39 14121.19,-8976.39 14110.52,-8972.63 14105.85,-8968.86 14105.85,-8968.86 13993.06,-8877.92 13993.06,-8877.92 13988.38,-8874.16 13989.71,-8870.39 13995.71,-8870.39 13995.71,-8870.39 14482.81,-8870.39 14482.81,-8870.39 14488.81,-8870.39 14499.48,-8874.16 14504.15,-8877.92 14504.15,-8877.92 14616.94,-8968.86 14616.94,-8968.86 14621.62,-8972.63 14620.29,-8976.39 14614.29,-8976.39"/>
<text text-anchor="middle" x="14305" y="-8934.69" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 3 GPU 14</text>
<text text-anchor="middle" x="14305" y="-8919.69" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="14305" y="-8904.69" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer3_gpu14_expert14&#45;&gt;aggregate_layer3_gpu14 -->
<g id="edge383" class="edge">
<title>expert_layer3_gpu14_expert14&#45;&gt;aggregate_layer3_gpu14</title>
<path fill="none" stroke="black" d="M14103.69,-9012.33C14126.3,-9002.45 14151.75,-8991.34 14176.75,-8980.42"/>
<polygon fill="black" stroke="black" points="14178.17,-8983.62 14185.93,-8976.4 14175.37,-8977.2 14178.17,-8983.62"/>
</g>
<!-- expert_layer3_gpu15_expert15 -->
<g id="node292" class="node">
<title>expert_layer3_gpu15_expert15</title>
<path fill="lightcoral" stroke="black" d="M15050.5,-9080.39C15050.5,-9080.39 14581.5,-9080.39 14581.5,-9080.39 14575.5,-9080.39 14569.5,-9074.39 14569.5,-9068.39 14569.5,-9068.39 14569.5,-9024.39 14569.5,-9024.39 14569.5,-9018.39 14575.5,-9012.39 14581.5,-9012.39 14581.5,-9012.39 15050.5,-9012.39 15050.5,-9012.39 15056.5,-9012.39 15062.5,-9018.39 15062.5,-9024.39 15062.5,-9024.39 15062.5,-9068.39 15062.5,-9068.39 15062.5,-9074.39 15056.5,-9080.39 15050.5,-9080.39"/>
<text text-anchor="middle" x="14816" y="-9065.19" font-family="Times,serif" font-size="14.00">Expert 15 Layer 3 GPU 15</text>
<text text-anchor="middle" x="14816" y="-9050.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14816" y="-9035.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14816" y="-9020.19" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer3_gpu15 -->
<g id="node324" class="node">
<title>aggregate_layer3_gpu15</title>
<path fill="orange" stroke="black" d="M15338.29,-8976.39C15338.29,-8976.39 14851.19,-8976.39 14851.19,-8976.39 14845.19,-8976.39 14834.52,-8972.63 14829.85,-8968.86 14829.85,-8968.86 14717.06,-8877.92 14717.06,-8877.92 14712.38,-8874.16 14713.71,-8870.39 14719.71,-8870.39 14719.71,-8870.39 15206.81,-8870.39 15206.81,-8870.39 15212.81,-8870.39 15223.48,-8874.16 15228.15,-8877.92 15228.15,-8877.92 15340.94,-8968.86 15340.94,-8968.86 15345.62,-8972.63 15344.29,-8976.39 15338.29,-8976.39"/>
<text text-anchor="middle" x="15029" y="-8934.69" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 3 GPU 15</text>
<text text-anchor="middle" x="15029" y="-8919.69" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="15029" y="-8904.69" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer3_gpu15_expert15&#45;&gt;aggregate_layer3_gpu15 -->
<g id="edge384" class="edge">
<title>expert_layer3_gpu15_expert15&#45;&gt;aggregate_layer3_gpu15</title>
<path fill="none" stroke="black" d="M14874.2,-9012.33C14891,-9002.79 14909.84,-8992.09 14928.43,-8981.52"/>
<polygon fill="black" stroke="black" points="14930.27,-8984.5 14937.24,-8976.52 14926.82,-8978.42 14930.27,-8984.5"/>
</g>
<!-- comm_layer3 -->
<g id="node325" class="node">
<title>comm_layer3</title>
<ellipse fill="lightpink" stroke="black" cx="8543" cy="-9153.87" rx="243.49" ry="37.45"/>
<text text-anchor="middle" x="8543" y="-9165.17" font-family="Times,serif" font-size="14.00">Cross&#45;GPU Communication Layer 3</text>
<text text-anchor="middle" x="8543" y="-9150.17" font-family="Times,serif" font-size="14.00">Input: Tokens from routing decisions</text>
<text text-anchor="middle" x="8543" y="-9135.17" font-family="Times,serif" font-size="14.00">Output: Tokens delivered to destination GPUs</text>
</g>
<!-- route_layer3_gpu0&#45;&gt;comm_layer3 -->
<g id="edge337" class="edge">
<title>route_layer3_gpu0&#45;&gt;comm_layer3</title>
<path fill="none" stroke="black" d="M2031.33,-9256.24C2151.66,-9245.42 2300.51,-9233.57 2434,-9227.35 3601.75,-9172.9 7287.86,-9158.48 8289.61,-9155.53"/>
<polygon fill="black" stroke="black" points="8289.83,-9159.02 8299.82,-9155.5 8289.81,-9152.02 8289.83,-9159.02"/>
</g>
<!-- mha_layer4_gpu0 -->
<g id="node326" class="node">
<title>mha_layer4_gpu0</title>
<path fill="lightblue" stroke="black" d="M1754,-8834.39C1754,-8834.39 1306,-8834.39 1306,-8834.39 1300,-8834.39 1294,-8828.39 1294,-8822.39 1294,-8822.39 1294,-8793.39 1294,-8793.39 1294,-8787.39 1300,-8781.39 1306,-8781.39 1306,-8781.39 1754,-8781.39 1754,-8781.39 1760,-8781.39 1766,-8787.39 1766,-8793.39 1766,-8793.39 1766,-8822.39 1766,-8822.39 1766,-8828.39 1760,-8834.39 1754,-8834.39"/>
<text text-anchor="middle" x="1530" y="-8819.19" font-family="Times,serif" font-size="14.00">MHA Layer 4 GPU 0</text>
<text text-anchor="middle" x="1530" y="-8804.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1530" y="-8789.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer3_gpu0&#45;&gt;mha_layer4_gpu0 -->
<g id="edge385" class="edge">
<title>aggregate_layer3_gpu0&#45;&gt;mha_layer4_gpu0</title>
<path fill="none" stroke="black" d="M1555.97,-8870.29C1552.18,-8861.33 1548.32,-8852.21 1544.78,-8843.84"/>
<polygon fill="black" stroke="black" points="1547.91,-8842.25 1540.79,-8834.41 1541.46,-8844.98 1547.91,-8842.25"/>
</g>
<!-- route_layer3_gpu1&#45;&gt;comm_layer3 -->
<g id="edge338" class="edge">
<title>route_layer3_gpu1&#45;&gt;comm_layer3</title>
<path fill="none" stroke="black" d="M3009.59,-9253.33C3107.95,-9243.36 3223.94,-9233.02 3329,-9227.35 4311.45,-9174.25 7384.44,-9159.07 8289.67,-9155.7"/>
<polygon fill="black" stroke="black" points="8289.9,-9159.19 8299.89,-9155.66 8289.88,-9152.19 8289.9,-9159.19"/>
</g>
<!-- mha_layer4_gpu1 -->
<g id="node327" class="node">
<title>mha_layer4_gpu1</title>
<path fill="lightblue" stroke="black" d="M2718,-8834.39C2718,-8834.39 2270,-8834.39 2270,-8834.39 2264,-8834.39 2258,-8828.39 2258,-8822.39 2258,-8822.39 2258,-8793.39 2258,-8793.39 2258,-8787.39 2264,-8781.39 2270,-8781.39 2270,-8781.39 2718,-8781.39 2718,-8781.39 2724,-8781.39 2730,-8787.39 2730,-8793.39 2730,-8793.39 2730,-8822.39 2730,-8822.39 2730,-8828.39 2724,-8834.39 2718,-8834.39"/>
<text text-anchor="middle" x="2494" y="-8819.19" font-family="Times,serif" font-size="14.00">MHA Layer 4 GPU 1</text>
<text text-anchor="middle" x="2494" y="-8804.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2494" y="-8789.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer3_gpu1&#45;&gt;mha_layer4_gpu1 -->
<g id="edge386" class="edge">
<title>aggregate_layer3_gpu1&#45;&gt;mha_layer4_gpu1</title>
<path fill="none" stroke="black" d="M2904.58,-8872.82C2823.31,-8860.16 2738.94,-8847.03 2667.98,-8835.98"/>
<polygon fill="black" stroke="black" points="2668.47,-8832.52 2658.05,-8834.44 2667.4,-8839.43 2668.47,-8832.52"/>
</g>
<!-- route_layer3_gpu2&#45;&gt;comm_layer3 -->
<g id="edge339" class="edge">
<title>route_layer3_gpu2&#45;&gt;comm_layer3</title>
<path fill="none" stroke="black" d="M3898.57,-9248.68C3969.32,-9240.25 4047.79,-9232.13 4120,-9227.35 4939.53,-9173.1 7477.19,-9158.91 8289.86,-9155.7"/>
<polygon fill="black" stroke="black" points="8289.95,-9159.2 8299.94,-9155.66 8289.92,-9152.2 8289.95,-9159.2"/>
</g>
<!-- mha_layer4_gpu2 -->
<g id="node328" class="node">
<title>mha_layer4_gpu2</title>
<path fill="lightblue" stroke="black" d="M3682,-8834.39C3682,-8834.39 3234,-8834.39 3234,-8834.39 3228,-8834.39 3222,-8828.39 3222,-8822.39 3222,-8822.39 3222,-8793.39 3222,-8793.39 3222,-8787.39 3228,-8781.39 3234,-8781.39 3234,-8781.39 3682,-8781.39 3682,-8781.39 3688,-8781.39 3694,-8787.39 3694,-8793.39 3694,-8793.39 3694,-8822.39 3694,-8822.39 3694,-8828.39 3688,-8834.39 3682,-8834.39"/>
<text text-anchor="middle" x="3458" y="-8819.19" font-family="Times,serif" font-size="14.00">MHA Layer 4 GPU 2</text>
<text text-anchor="middle" x="3458" y="-8804.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3458" y="-8789.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer3_gpu2&#45;&gt;mha_layer4_gpu2 -->
<g id="edge387" class="edge">
<title>aggregate_layer3_gpu2&#45;&gt;mha_layer4_gpu2</title>
<path fill="none" stroke="black" d="M4072.55,-8884.88C3942.28,-8868.77 3793.04,-8850.32 3674.26,-8835.63"/>
<polygon fill="black" stroke="black" points="3674.67,-8832.16 3664.31,-8834.4 3673.81,-8839.1 3674.67,-8832.16"/>
</g>
<!-- route_layer3_gpu3&#45;&gt;comm_layer3 -->
<g id="edge340" class="edge">
<title>route_layer3_gpu3&#45;&gt;comm_layer3</title>
<path fill="none" stroke="black" d="M4698.57,-9255.54C4810.07,-9245.14 4945.29,-9233.86 5067,-9227.35 6272.35,-9162.88 7715.66,-9154.9 8289.63,-9154.5"/>
<polygon fill="black" stroke="black" points="8289.69,-9158 8299.69,-9154.49 8289.69,-9151 8289.69,-9158"/>
</g>
<!-- mha_layer4_gpu3 -->
<g id="node329" class="node">
<title>mha_layer4_gpu3</title>
<path fill="lightblue" stroke="black" d="M4862,-8834.39C4862,-8834.39 4414,-8834.39 4414,-8834.39 4408,-8834.39 4402,-8828.39 4402,-8822.39 4402,-8822.39 4402,-8793.39 4402,-8793.39 4402,-8787.39 4408,-8781.39 4414,-8781.39 4414,-8781.39 4862,-8781.39 4862,-8781.39 4868,-8781.39 4874,-8787.39 4874,-8793.39 4874,-8793.39 4874,-8822.39 4874,-8822.39 4874,-8828.39 4868,-8834.39 4862,-8834.39"/>
<text text-anchor="middle" x="4638" y="-8819.19" font-family="Times,serif" font-size="14.00">MHA Layer 4 GPU 3</text>
<text text-anchor="middle" x="4638" y="-8804.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4638" y="-8789.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer3_gpu3&#45;&gt;mha_layer4_gpu3 -->
<g id="edge388" class="edge">
<title>aggregate_layer3_gpu3&#45;&gt;mha_layer4_gpu3</title>
<path fill="none" stroke="black" d="M4987.4,-8870.38C4920.35,-8858.58 4851.74,-8846.5 4793.27,-8836.22"/>
<polygon fill="black" stroke="black" points="4793.68,-8832.73 4783.22,-8834.45 4792.47,-8839.63 4793.68,-8832.73"/>
</g>
<!-- route_layer3_gpu4&#45;&gt;comm_layer3 -->
<g id="edge341" class="edge">
<title>route_layer3_gpu4&#45;&gt;comm_layer3</title>
<path fill="none" stroke="black" d="M5651.96,-9260.47C5800.86,-9249.39 5995.92,-9235.92 6169,-9227.35 6942.32,-9189.03 7858.41,-9167.93 8291.79,-9159.41"/>
<polygon fill="black" stroke="black" points="8292.01,-9162.9 8301.94,-9159.21 8291.87,-9155.9 8292.01,-9162.9"/>
</g>
<!-- mha_layer4_gpu4 -->
<g id="node330" class="node">
<title>mha_layer4_gpu4</title>
<path fill="lightblue" stroke="black" d="M5837,-8834.39C5837,-8834.39 5389,-8834.39 5389,-8834.39 5383,-8834.39 5377,-8828.39 5377,-8822.39 5377,-8822.39 5377,-8793.39 5377,-8793.39 5377,-8787.39 5383,-8781.39 5389,-8781.39 5389,-8781.39 5837,-8781.39 5837,-8781.39 5843,-8781.39 5849,-8787.39 5849,-8793.39 5849,-8793.39 5849,-8822.39 5849,-8822.39 5849,-8828.39 5843,-8834.39 5837,-8834.39"/>
<text text-anchor="middle" x="5613" y="-8819.19" font-family="Times,serif" font-size="14.00">MHA Layer 4 GPU 4</text>
<text text-anchor="middle" x="5613" y="-8804.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5613" y="-8789.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer3_gpu4&#45;&gt;mha_layer4_gpu4 -->
<g id="edge389" class="edge">
<title>aggregate_layer3_gpu4&#45;&gt;mha_layer4_gpu4</title>
<path fill="none" stroke="black" d="M5858.93,-8870.38C5812.81,-8858.85 5765.64,-8847.05 5725.11,-8836.92"/>
<polygon fill="black" stroke="black" points="5725.77,-8833.48 5715.22,-8834.45 5724.07,-8840.27 5725.77,-8833.48"/>
</g>
<!-- route_layer3_gpu5&#45;&gt;comm_layer3 -->
<g id="edge342" class="edge">
<title>route_layer3_gpu5&#45;&gt;comm_layer3</title>
<path fill="none" stroke="black" d="M6746.73,-9254.94C6844.67,-9245.32 6959.78,-9234.81 7064,-9227.35 7497.34,-9196.3 8003.08,-9174.66 8296.78,-9163.53"/>
<polygon fill="black" stroke="black" points="8297.28,-9167.02 8307.14,-9163.14 8297.02,-9160.02 8297.28,-9167.02"/>
</g>
<!-- mha_layer4_gpu5 -->
<g id="node331" class="node">
<title>mha_layer4_gpu5</title>
<path fill="lightblue" stroke="black" d="M6711,-8834.39C6711,-8834.39 6263,-8834.39 6263,-8834.39 6257,-8834.39 6251,-8828.39 6251,-8822.39 6251,-8822.39 6251,-8793.39 6251,-8793.39 6251,-8787.39 6257,-8781.39 6263,-8781.39 6263,-8781.39 6711,-8781.39 6711,-8781.39 6717,-8781.39 6723,-8787.39 6723,-8793.39 6723,-8793.39 6723,-8822.39 6723,-8822.39 6723,-8828.39 6717,-8834.39 6711,-8834.39"/>
<text text-anchor="middle" x="6487" y="-8819.19" font-family="Times,serif" font-size="14.00">MHA Layer 4 GPU 5</text>
<text text-anchor="middle" x="6487" y="-8804.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6487" y="-8789.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer3_gpu5&#45;&gt;mha_layer4_gpu5 -->
<g id="edge390" class="edge">
<title>aggregate_layer3_gpu5&#45;&gt;mha_layer4_gpu5</title>
<path fill="none" stroke="black" d="M6650.92,-8870.29C6621.26,-8859.19 6590.97,-8847.84 6564.63,-8837.97"/>
<polygon fill="black" stroke="black" points="6565.7,-8834.64 6555.11,-8834.41 6563.25,-8841.19 6565.7,-8834.64"/>
</g>
<!-- route_layer3_gpu6&#45;&gt;comm_layer3 -->
<g id="edge343" class="edge">
<title>route_layer3_gpu6&#45;&gt;comm_layer3</title>
<path fill="none" stroke="black" d="M7637.93,-9252.11C7707.64,-9243.99 7784.43,-9235.17 7855,-9227.35 8015.42,-9209.57 8197.01,-9190.48 8333.34,-9176.36"/>
<polygon fill="black" stroke="black" points="8333.9,-9179.82 8343.48,-9175.31 8333.18,-9172.86 8333.9,-9179.82"/>
</g>
<!-- mha_layer4_gpu6 -->
<g id="node332" class="node">
<title>mha_layer4_gpu6</title>
<path fill="lightblue" stroke="black" d="M7520,-8834.39C7520,-8834.39 7072,-8834.39 7072,-8834.39 7066,-8834.39 7060,-8828.39 7060,-8822.39 7060,-8822.39 7060,-8793.39 7060,-8793.39 7060,-8787.39 7066,-8781.39 7072,-8781.39 7072,-8781.39 7520,-8781.39 7520,-8781.39 7526,-8781.39 7532,-8787.39 7532,-8793.39 7532,-8793.39 7532,-8822.39 7532,-8822.39 7532,-8828.39 7526,-8834.39 7520,-8834.39"/>
<text text-anchor="middle" x="7296" y="-8819.19" font-family="Times,serif" font-size="14.00">MHA Layer 4 GPU 6</text>
<text text-anchor="middle" x="7296" y="-8804.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7296" y="-8789.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer3_gpu6&#45;&gt;mha_layer4_gpu6 -->
<g id="edge391" class="edge">
<title>aggregate_layer3_gpu6&#45;&gt;mha_layer4_gpu6</title>
<path fill="none" stroke="black" d="M7396.62,-8870.29C7379.54,-8859.87 7362.11,-8849.23 7346.66,-8839.81"/>
<polygon fill="black" stroke="black" points="7348.17,-8836.63 7337.81,-8834.41 7344.52,-8842.6 7348.17,-8836.63"/>
</g>
<!-- route_layer3_gpu7&#45;&gt;comm_layer3 -->
<g id="edge344" class="edge">
<title>route_layer3_gpu7&#45;&gt;comm_layer3</title>
<path fill="none" stroke="black" d="M8342.89,-9227.28C8375.54,-9215.47 8409.57,-9203.15 8440.12,-9192.1"/>
<polygon fill="black" stroke="black" points="8441.69,-9195.25 8449.91,-9188.56 8439.31,-9188.67 8441.69,-9195.25"/>
</g>
<!-- mha_layer4_gpu7 -->
<g id="node333" class="node">
<title>mha_layer4_gpu7</title>
<path fill="lightblue" stroke="black" d="M8297,-8834.39C8297,-8834.39 7849,-8834.39 7849,-8834.39 7843,-8834.39 7837,-8828.39 7837,-8822.39 7837,-8822.39 7837,-8793.39 7837,-8793.39 7837,-8787.39 7843,-8781.39 7849,-8781.39 7849,-8781.39 8297,-8781.39 8297,-8781.39 8303,-8781.39 8309,-8787.39 8309,-8793.39 8309,-8793.39 8309,-8822.39 8309,-8822.39 8309,-8828.39 8303,-8834.39 8297,-8834.39"/>
<text text-anchor="middle" x="8073" y="-8819.19" font-family="Times,serif" font-size="14.00">MHA Layer 4 GPU 7</text>
<text text-anchor="middle" x="8073" y="-8804.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8073" y="-8789.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer3_gpu7&#45;&gt;mha_layer4_gpu7 -->
<g id="edge392" class="edge">
<title>aggregate_layer3_gpu7&#45;&gt;mha_layer4_gpu7</title>
<path fill="none" stroke="black" d="M8118.98,-8870.29C8111.91,-8860.84 8104.7,-8851.22 8098.15,-8842.48"/>
<polygon fill="black" stroke="black" points="8100.9,-8840.31 8092.11,-8834.41 8095.3,-8844.51 8100.9,-8840.31"/>
</g>
<!-- route_layer3_gpu8&#45;&gt;comm_layer3 -->
<g id="edge345" class="edge">
<title>route_layer3_gpu8&#45;&gt;comm_layer3</title>
<path fill="none" stroke="black" d="M8823.38,-9227.28C8773.27,-9214.34 8720.83,-9200.79 8675.03,-9188.97"/>
<polygon fill="black" stroke="black" points="8675.62,-9185.5 8665.06,-9186.39 8673.87,-9192.28 8675.62,-9185.5"/>
</g>
<!-- mha_layer4_gpu8 -->
<g id="node334" class="node">
<title>mha_layer4_gpu8</title>
<path fill="lightblue" stroke="black" d="M9190,-8834.39C9190,-8834.39 8742,-8834.39 8742,-8834.39 8736,-8834.39 8730,-8828.39 8730,-8822.39 8730,-8822.39 8730,-8793.39 8730,-8793.39 8730,-8787.39 8736,-8781.39 8742,-8781.39 8742,-8781.39 9190,-8781.39 9190,-8781.39 9196,-8781.39 9202,-8787.39 9202,-8793.39 9202,-8793.39 9202,-8822.39 9202,-8822.39 9202,-8828.39 9196,-8834.39 9190,-8834.39"/>
<text text-anchor="middle" x="8966" y="-8819.19" font-family="Times,serif" font-size="14.00">MHA Layer 4 GPU 8</text>
<text text-anchor="middle" x="8966" y="-8804.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8966" y="-8789.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer3_gpu8&#45;&gt;mha_layer4_gpu8 -->
<g id="edge393" class="edge">
<title>aggregate_layer3_gpu8&#45;&gt;mha_layer4_gpu8</title>
<path fill="none" stroke="black" d="M8945.44,-8870.29C8948.41,-8861.43 8951.43,-8852.41 8954.21,-8844.11"/>
<polygon fill="black" stroke="black" points="8957.6,-8845 8957.46,-8834.41 8950.96,-8842.78 8957.6,-8845"/>
</g>
<!-- route_layer3_gpu9&#45;&gt;comm_layer3 -->
<g id="edge346" class="edge">
<title>route_layer3_gpu9&#45;&gt;comm_layer3</title>
<path fill="none" stroke="black" d="M9614.73,-9250.18C9534.78,-9242.64 9448.66,-9234.6 9369,-9227.35 9163.63,-9208.65 8929.46,-9188.18 8763.03,-9173.78"/>
<polygon fill="black" stroke="black" points="8762.93,-9170.26 8752.67,-9172.88 8762.33,-9177.23 8762.93,-9170.26"/>
</g>
<!-- mha_layer4_gpu9 -->
<g id="node335" class="node">
<title>mha_layer4_gpu9</title>
<path fill="lightblue" stroke="black" d="M10106,-8834.39C10106,-8834.39 9658,-8834.39 9658,-8834.39 9652,-8834.39 9646,-8828.39 9646,-8822.39 9646,-8822.39 9646,-8793.39 9646,-8793.39 9646,-8787.39 9652,-8781.39 9658,-8781.39 9658,-8781.39 10106,-8781.39 10106,-8781.39 10112,-8781.39 10118,-8787.39 10118,-8793.39 10118,-8793.39 10118,-8822.39 10118,-8822.39 10118,-8828.39 10112,-8834.39 10106,-8834.39"/>
<text text-anchor="middle" x="9882" y="-8819.19" font-family="Times,serif" font-size="14.00">MHA Layer 4 GPU 9</text>
<text text-anchor="middle" x="9882" y="-8804.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9882" y="-8789.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer3_gpu9&#45;&gt;mha_layer4_gpu9 -->
<g id="edge394" class="edge">
<title>aggregate_layer3_gpu9&#45;&gt;mha_layer4_gpu9</title>
<path fill="none" stroke="black" d="M9834.94,-8870.29C9842.18,-8860.84 9849.56,-8851.22 9856.26,-8842.48"/>
<polygon fill="black" stroke="black" points="9859.14,-8844.47 9862.44,-8834.41 9853.58,-8840.21 9859.14,-8844.47"/>
</g>
<!-- route_layer3_gpu10&#45;&gt;comm_layer3 -->
<g id="edge347" class="edge">
<title>route_layer3_gpu10&#45;&gt;comm_layer3</title>
<path fill="none" stroke="black" d="M10542.56,-9249.4C10452.85,-9241.37 10354.55,-9233.27 10264,-9227.35 9740.68,-9193.09 9126.71,-9171.75 8791.88,-9161.71"/>
<polygon fill="black" stroke="black" points="8791.67,-9158.21 8781.57,-9161.41 8791.46,-9165.2 8791.67,-9158.21"/>
</g>
<!-- mha_layer4_gpu10 -->
<g id="node336" class="node">
<title>mha_layer4_gpu10</title>
<path fill="lightblue" stroke="black" d="M11045,-8834.39C11045,-8834.39 10597,-8834.39 10597,-8834.39 10591,-8834.39 10585,-8828.39 10585,-8822.39 10585,-8822.39 10585,-8793.39 10585,-8793.39 10585,-8787.39 10591,-8781.39 10597,-8781.39 10597,-8781.39 11045,-8781.39 11045,-8781.39 11051,-8781.39 11057,-8787.39 11057,-8793.39 11057,-8793.39 11057,-8822.39 11057,-8822.39 11057,-8828.39 11051,-8834.39 11045,-8834.39"/>
<text text-anchor="middle" x="10821" y="-8819.19" font-family="Times,serif" font-size="14.00">MHA Layer 4 GPU 10</text>
<text text-anchor="middle" x="10821" y="-8804.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10821" y="-8789.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer3_gpu10&#45;&gt;mha_layer4_gpu10 -->
<g id="edge395" class="edge">
<title>aggregate_layer3_gpu10&#45;&gt;mha_layer4_gpu10</title>
<path fill="none" stroke="black" d="M10760.95,-8870.29C10770.48,-8860.55 10780.19,-8850.62 10788.94,-8841.67"/>
<polygon fill="black" stroke="black" points="10791.56,-8844 10796.05,-8834.41 10786.55,-8839.11 10791.56,-8844"/>
</g>
<!-- route_layer3_gpu11&#45;&gt;comm_layer3 -->
<g id="edge348" class="edge">
<title>route_layer3_gpu11&#45;&gt;comm_layer3</title>
<path fill="none" stroke="black" d="M11489.49,-9249.41C11394.54,-9241.08 11289.51,-9232.82 11193,-9227.35 10313.29,-9177.43 9267.29,-9161.64 8795.71,-9156.85"/>
<polygon fill="black" stroke="black" points="8795.75,-9153.35 8785.71,-9156.75 8795.68,-9160.35 8795.75,-9153.35"/>
</g>
<!-- mha_layer4_gpu11 -->
<g id="node337" class="node">
<title>mha_layer4_gpu11</title>
<path fill="lightblue" stroke="black" d="M11997,-8834.39C11997,-8834.39 11549,-8834.39 11549,-8834.39 11543,-8834.39 11537,-8828.39 11537,-8822.39 11537,-8822.39 11537,-8793.39 11537,-8793.39 11537,-8787.39 11543,-8781.39 11549,-8781.39 11549,-8781.39 11997,-8781.39 11997,-8781.39 12003,-8781.39 12009,-8787.39 12009,-8793.39 12009,-8793.39 12009,-8822.39 12009,-8822.39 12009,-8828.39 12003,-8834.39 11997,-8834.39"/>
<text text-anchor="middle" x="11773" y="-8819.19" font-family="Times,serif" font-size="14.00">MHA Layer 4 GPU 11</text>
<text text-anchor="middle" x="11773" y="-8804.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11773" y="-8789.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer3_gpu11&#45;&gt;mha_layer4_gpu11 -->
<g id="edge396" class="edge">
<title>aggregate_layer3_gpu11&#45;&gt;mha_layer4_gpu11</title>
<path fill="none" stroke="black" d="M11706.46,-8870.29C11717.12,-8860.45 11727.99,-8850.43 11737.77,-8841.4"/>
<polygon fill="black" stroke="black" points="11740.38,-8843.76 11745.35,-8834.41 11735.63,-8838.62 11740.38,-8843.76"/>
</g>
<!-- route_layer3_gpu12&#45;&gt;comm_layer3 -->
<g id="edge349" class="edge">
<title>route_layer3_gpu12&#45;&gt;comm_layer3</title>
<path fill="none" stroke="black" d="M12444.35,-9249.34C12347.12,-9240.87 12239.14,-9232.56 12140,-9227.35 10886.64,-9161.45 9384.73,-9154.35 8796.66,-9154.34"/>
<polygon fill="black" stroke="black" points="8796.36,-9150.84 8786.36,-9154.34 8796.36,-9157.84 8796.36,-9150.84"/>
</g>
<!-- mha_layer4_gpu12 -->
<g id="node338" class="node">
<title>mha_layer4_gpu12</title>
<path fill="lightblue" stroke="black" d="M12955,-8834.39C12955,-8834.39 12507,-8834.39 12507,-8834.39 12501,-8834.39 12495,-8828.39 12495,-8822.39 12495,-8822.39 12495,-8793.39 12495,-8793.39 12495,-8787.39 12501,-8781.39 12507,-8781.39 12507,-8781.39 12955,-8781.39 12955,-8781.39 12961,-8781.39 12967,-8787.39 12967,-8793.39 12967,-8793.39 12967,-8822.39 12967,-8822.39 12967,-8828.39 12961,-8834.39 12955,-8834.39"/>
<text text-anchor="middle" x="12731" y="-8819.19" font-family="Times,serif" font-size="14.00">MHA Layer 4 GPU 12</text>
<text text-anchor="middle" x="12731" y="-8804.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12731" y="-8789.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer3_gpu12&#45;&gt;mha_layer4_gpu12 -->
<g id="edge397" class="edge">
<title>aggregate_layer3_gpu12&#45;&gt;mha_layer4_gpu12</title>
<path fill="none" stroke="black" d="M12661.21,-8870.29C12672.51,-8860.36 12684.02,-8850.23 12694.35,-8841.14"/>
<polygon fill="black" stroke="black" points="12696.81,-8843.64 12702,-8834.41 12692.18,-8838.38 12696.81,-8843.64"/>
</g>
<!-- route_layer3_gpu13&#45;&gt;comm_layer3 -->
<g id="edge350" class="edge">
<title>route_layer3_gpu13&#45;&gt;comm_layer3</title>
<path fill="none" stroke="black" d="M13404.61,-9249.33C13305.87,-9240.77 13195.89,-9232.4 13095,-9227.35 12248.33,-9184.92 9624.43,-9162.71 8796.2,-9156.62"/>
<polygon fill="black" stroke="black" points="8795.96,-9153.12 8785.94,-9156.55 8795.91,-9160.12 8795.96,-9153.12"/>
</g>
<!-- mha_layer4_gpu13 -->
<g id="node339" class="node">
<title>mha_layer4_gpu13</title>
<path fill="lightblue" stroke="black" d="M14033,-8834.39C14033,-8834.39 13585,-8834.39 13585,-8834.39 13579,-8834.39 13573,-8828.39 13573,-8822.39 13573,-8822.39 13573,-8793.39 13573,-8793.39 13573,-8787.39 13579,-8781.39 13585,-8781.39 13585,-8781.39 14033,-8781.39 14033,-8781.39 14039,-8781.39 14045,-8787.39 14045,-8793.39 14045,-8793.39 14045,-8822.39 14045,-8822.39 14045,-8828.39 14039,-8834.39 14033,-8834.39"/>
<text text-anchor="middle" x="13809" y="-8819.19" font-family="Times,serif" font-size="14.00">MHA Layer 4 GPU 13</text>
<text text-anchor="middle" x="13809" y="-8804.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13809" y="-8789.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer3_gpu13&#45;&gt;mha_layer4_gpu13 -->
<g id="edge398" class="edge">
<title>aggregate_layer3_gpu13&#45;&gt;mha_layer4_gpu13</title>
<path fill="none" stroke="black" d="M13651.04,-8870.29C13679.48,-8859.24 13708.54,-8847.94 13733.85,-8838.1"/>
<polygon fill="black" stroke="black" points="13735.31,-8841.29 13743.36,-8834.41 13732.77,-8834.77 13735.31,-8841.29"/>
</g>
<!-- route_layer3_gpu14&#45;&gt;comm_layer3 -->
<g id="edge351" class="edge">
<title>route_layer3_gpu14&#45;&gt;comm_layer3</title>
<path fill="none" stroke="black" d="M14366.41,-9249.23C14267.15,-9240.64 14156.49,-9232.28 14055,-9227.35 13010.78,-9176.61 9734.27,-9159.69 8796.23,-9155.81"/>
<polygon fill="black" stroke="black" points="8795.99,-9152.31 8785.98,-9155.77 8795.96,-9159.31 8795.99,-9152.31"/>
</g>
<!-- mha_layer4_gpu14 -->
<g id="node340" class="node">
<title>mha_layer4_gpu14</title>
<path fill="lightblue" stroke="black" d="M14694,-8834.39C14694,-8834.39 14246,-8834.39 14246,-8834.39 14240,-8834.39 14234,-8828.39 14234,-8822.39 14234,-8822.39 14234,-8793.39 14234,-8793.39 14234,-8787.39 14240,-8781.39 14246,-8781.39 14246,-8781.39 14694,-8781.39 14694,-8781.39 14700,-8781.39 14706,-8787.39 14706,-8793.39 14706,-8793.39 14706,-8822.39 14706,-8822.39 14706,-8828.39 14700,-8834.39 14694,-8834.39"/>
<text text-anchor="middle" x="14470" y="-8819.19" font-family="Times,serif" font-size="14.00">MHA Layer 4 GPU 14</text>
<text text-anchor="middle" x="14470" y="-8804.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14470" y="-8789.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer3_gpu14&#45;&gt;mha_layer4_gpu14 -->
<g id="edge399" class="edge">
<title>aggregate_layer3_gpu14&#45;&gt;mha_layer4_gpu14</title>
<path fill="none" stroke="black" d="M14380.74,-8870.29C14395.61,-8860.06 14410.78,-8849.63 14424.29,-8840.34"/>
<polygon fill="black" stroke="black" points="14426.65,-8842.96 14432.91,-8834.41 14422.69,-8837.19 14426.65,-8842.96"/>
</g>
<!-- route_layer3_gpu15&#45;&gt;comm_layer3 -->
<g id="edge352" class="edge">
<title>route_layer3_gpu15&#45;&gt;comm_layer3</title>
<path fill="none" stroke="black" d="M15329.31,-9249.15C15229.79,-9240.54 15118.8,-9232.19 15017,-9227.35 13773.62,-9168.24 9835.7,-9157.16 8796.49,-9155.24"/>
<polygon fill="black" stroke="black" points="8796.28,-9151.74 8786.27,-9155.22 8796.27,-9158.74 8796.28,-9151.74"/>
</g>
<!-- mha_layer4_gpu15 -->
<g id="node341" class="node">
<title>mha_layer4_gpu15</title>
<path fill="lightblue" stroke="black" d="M15269,-8834.39C15269,-8834.39 14821,-8834.39 14821,-8834.39 14815,-8834.39 14809,-8828.39 14809,-8822.39 14809,-8822.39 14809,-8793.39 14809,-8793.39 14809,-8787.39 14815,-8781.39 14821,-8781.39 14821,-8781.39 15269,-8781.39 15269,-8781.39 15275,-8781.39 15281,-8787.39 15281,-8793.39 15281,-8793.39 15281,-8822.39 15281,-8822.39 15281,-8828.39 15275,-8834.39 15269,-8834.39"/>
<text text-anchor="middle" x="15045" y="-8819.19" font-family="Times,serif" font-size="14.00">MHA Layer 4 GPU 15</text>
<text text-anchor="middle" x="15045" y="-8804.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="15045" y="-8789.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer3_gpu15&#45;&gt;mha_layer4_gpu15 -->
<g id="edge400" class="edge">
<title>aggregate_layer3_gpu15&#45;&gt;mha_layer4_gpu15</title>
<path fill="none" stroke="black" d="M15036.34,-8870.29C15037.58,-8861.53 15038.84,-8852.61 15040,-8844.39"/>
<polygon fill="black" stroke="black" points="15043.47,-8844.8 15041.4,-8834.41 15036.54,-8843.82 15043.47,-8844.8"/>
</g>
<!-- comm_layer3&#45;&gt;expert_layer3_gpu0_expert0 -->
<g id="edge353" class="edge">
<title>comm_layer3&#45;&gt;expert_layer3_gpu0_expert0</title>
<path fill="none" stroke="black" d="M8300.73,-9150.08C7553.9,-9141.36 5220.9,-9113.23 3288,-9080.39 2800.77,-9072.12 2231.93,-9060.1 1909.92,-9053.09"/>
<polygon fill="black" stroke="black" points="1909.59,-9049.58 1899.51,-9052.86 1909.44,-9056.58 1909.59,-9049.58"/>
</g>
<!-- comm_layer3&#45;&gt;expert_layer3_gpu1_expert1 -->
<g id="edge354" class="edge">
<title>comm_layer3&#45;&gt;expert_layer3_gpu1_expert1</title>
<path fill="none" stroke="black" d="M8300.33,-9150.87C7653.21,-9145.06 5832.47,-9125.66 4318,-9080.39 4145.51,-9075.24 3951.51,-9066.96 3800.88,-9059.99"/>
<polygon fill="black" stroke="black" points="3800.71,-9056.48 3790.56,-9059.51 3800.39,-9063.47 3800.71,-9056.48"/>
</g>
<!-- comm_layer3&#45;&gt;expert_layer3_gpu2_expert2 -->
<g id="edge355" class="edge">
<title>comm_layer3&#45;&gt;expert_layer3_gpu2_expert2</title>
<path fill="none" stroke="black" d="M8300.58,-9150.54C7745.32,-9144.58 6338.57,-9125.92 5163,-9080.39 5054.18,-9076.18 4934.14,-9069.77 4830.97,-9063.72"/>
<polygon fill="black" stroke="black" points="4830.91,-9060.21 4820.72,-9063.12 4830.5,-9067.2 4830.91,-9060.21"/>
</g>
<!-- comm_layer3&#45;&gt;expert_layer3_gpu3_expert3 -->
<g id="edge356" class="edge">
<title>comm_layer3&#45;&gt;expert_layer3_gpu3_expert3</title>
<path fill="none" stroke="black" d="M8301.83,-9148.72C7845.06,-9140.28 6822.38,-9118.61 5962,-9080.39 5868.56,-9076.24 5766.15,-9070.36 5675.69,-9064.72"/>
<polygon fill="black" stroke="black" points="5675.77,-9061.22 5665.57,-9064.08 5675.33,-9068.2 5675.77,-9061.22"/>
</g>
<!-- comm_layer3&#45;&gt;expert_layer3_gpu4_expert4 -->
<g id="edge357" class="edge">
<title>comm_layer3&#45;&gt;expert_layer3_gpu4_expert4</title>
<path fill="none" stroke="black" d="M8305.23,-9145.91C7952.5,-9135.05 7269.85,-9112 6690,-9080.39 6620.23,-9076.59 6544.71,-9071.67 6474.96,-9066.8"/>
<polygon fill="black" stroke="black" points="6474.94,-9063.29 6464.72,-9066.08 6474.45,-9070.27 6474.94,-9063.29"/>
</g>
<!-- comm_layer3&#45;&gt;expert_layer3_gpu5_expert5 -->
<g id="edge358" class="edge">
<title>comm_layer3&#45;&gt;expert_layer3_gpu5_expert5</title>
<path fill="none" stroke="black" d="M8317.19,-9139.88C8081.69,-9126.09 7701.86,-9103.19 7374,-9080.39 7318.59,-9076.54 7259.17,-9072.13 7202.77,-9067.82"/>
<polygon fill="black" stroke="black" points="7202.89,-9064.32 7192.65,-9067.05 7202.35,-9071.3 7202.89,-9064.32"/>
</g>
<!-- comm_layer3&#45;&gt;expert_layer3_gpu6_expert6 -->
<g id="edge359" class="edge">
<title>comm_layer3&#45;&gt;expert_layer3_gpu6_expert6</title>
<path fill="none" stroke="black" d="M8351.33,-9130.73C8216.37,-9115.13 8034.2,-9094.09 7886.7,-9077.05"/>
<polygon fill="black" stroke="black" points="7886.92,-9073.55 7876.59,-9075.88 7886.12,-9080.51 7886.92,-9073.55"/>
</g>
<!-- comm_layer3&#45;&gt;expert_layer3_gpu7_expert7 -->
<g id="edge360" class="edge">
<title>comm_layer3&#45;&gt;expert_layer3_gpu7_expert7</title>
<path fill="none" stroke="black" d="M8442.19,-9119.64C8407.53,-9108.22 8368.55,-9095.37 8333.18,-9083.71"/>
<polygon fill="black" stroke="black" points="8333.9,-9080.26 8323.3,-9080.45 8331.71,-9086.91 8333.9,-9080.26"/>
</g>
<!-- comm_layer3&#45;&gt;expert_layer3_gpu8_expert8 -->
<g id="edge361" class="edge">
<title>comm_layer3&#45;&gt;expert_layer3_gpu8_expert8</title>
<path fill="none" stroke="black" d="M8643.81,-9119.64C8678.47,-9108.22 8717.45,-9095.37 8752.82,-9083.71"/>
<polygon fill="black" stroke="black" points="8754.29,-9086.91 8762.7,-9080.45 8752.1,-9080.26 8754.29,-9086.91"/>
</g>
<!-- comm_layer3&#45;&gt;expert_layer3_gpu9_expert9 -->
<g id="edge362" class="edge">
<title>comm_layer3&#45;&gt;expert_layer3_gpu9_expert9</title>
<path fill="none" stroke="black" d="M8745.33,-9133C8919.52,-9115.89 9171.86,-9091.11 9360.25,-9072.61"/>
<polygon fill="black" stroke="black" points="9360.69,-9076.08 9370.3,-9071.62 9360.01,-9069.12 9360.69,-9076.08"/>
</g>
<!-- comm_layer3&#45;&gt;expert_layer3_gpu10_expert10 -->
<g id="edge363" class="edge">
<title>comm_layer3&#45;&gt;expert_layer3_gpu10_expert10</title>
<path fill="none" stroke="black" d="M8770.82,-9140.62C9035.52,-9126.34 9485.41,-9101.95 9872,-9080.39 9977.56,-9074.51 10093.93,-9067.9 10194.49,-9062.15"/>
<polygon fill="black" stroke="black" points="10194.7,-9065.64 10204.48,-9061.58 10194.3,-9058.65 10194.7,-9065.64"/>
</g>
<!-- comm_layer3&#45;&gt;expert_layer3_gpu11_expert11 -->
<g id="edge364" class="edge">
<title>comm_layer3&#45;&gt;expert_layer3_gpu11_expert11</title>
<path fill="none" stroke="black" d="M8781.51,-9146.33C9180.11,-9135.08 10006.84,-9110.36 10706,-9080.39 10829.34,-9075.11 10966.15,-9068.1 11080.86,-9061.91"/>
<polygon fill="black" stroke="black" points="11081.39,-9065.39 11091.18,-9061.35 11081.01,-9058.4 11081.39,-9065.39"/>
</g>
<!-- comm_layer3&#45;&gt;expert_layer3_gpu12_expert12 -->
<g id="edge365" class="edge">
<title>comm_layer3&#45;&gt;expert_layer3_gpu12_expert12</title>
<path fill="none" stroke="black" d="M8784.74,-9149.25C9300.69,-9141.04 10547.95,-9118.73 11593,-9080.39 11727.69,-9075.45 11877.64,-9068.17 12001,-9061.7"/>
<polygon fill="black" stroke="black" points="12001.54,-9065.17 12011.34,-9061.15 12001.17,-9058.18 12001.54,-9065.17"/>
</g>
<!-- comm_layer3&#45;&gt;expert_layer3_gpu13_expert13 -->
<g id="edge366" class="edge">
<title>comm_layer3&#45;&gt;expert_layer3_gpu13_expert13</title>
<path fill="none" stroke="black" d="M8785.6,-9151.1C9406.05,-9146.01 11101.29,-9128.45 12513,-9080.39 12646.67,-9075.84 12795.43,-9068.62 12918.02,-9062.09"/>
<polygon fill="black" stroke="black" points="12918.5,-9065.57 12928.3,-9061.54 12918.12,-9058.58 12918.5,-9065.57"/>
</g>
<!-- comm_layer3&#45;&gt;expert_layer3_gpu14_expert14 -->
<g id="edge367" class="edge">
<title>comm_layer3&#45;&gt;expert_layer3_gpu14_expert14</title>
<path fill="none" stroke="black" d="M8786.21,-9152.73C9499.57,-9151.57 11648.38,-9142.74 13430,-9080.39 13541.87,-9076.48 13665.4,-9070.02 13771,-9063.85"/>
<polygon fill="black" stroke="black" points="13771.38,-9067.33 13781.16,-9063.25 13770.97,-9060.35 13771.38,-9067.33"/>
</g>
<!-- comm_layer3&#45;&gt;expert_layer3_gpu15_expert15 -->
<g id="edge368" class="edge">
<title>comm_layer3&#45;&gt;expert_layer3_gpu15_expert15</title>
<path fill="none" stroke="black" d="M8785.81,-9151.4C9733.79,-9145.41 13187.18,-9121.21 14283,-9080.39 14373.1,-9077.04 14471.67,-9071.47 14559.26,-9065.85"/>
<polygon fill="black" stroke="black" points="14559.58,-9069.34 14569.34,-9065.2 14559.13,-9062.35 14559.58,-9069.34"/>
</g>
<!-- gate_layer4_gpu0 -->
<g id="node342" class="node">
<title>gate_layer4_gpu0</title>
<path fill="lightsteelblue" stroke="black" d="M1281.07,-8744.06C1281.07,-8744.06 831.93,-8693.73 831.93,-8693.73 825.96,-8693.06 825.96,-8691.73 831.93,-8691.06 831.93,-8691.06 1281.07,-8640.73 1281.07,-8640.73 1287.04,-8640.06 1298.96,-8640.06 1304.93,-8640.73 1304.93,-8640.73 1754.07,-8691.06 1754.07,-8691.06 1760.04,-8691.73 1760.04,-8693.06 1754.07,-8693.73 1754.07,-8693.73 1304.93,-8744.06 1304.93,-8744.06 1298.96,-8744.73 1287.04,-8744.73 1281.07,-8744.06"/>
<text text-anchor="middle" x="1293" y="-8703.69" font-family="Times,serif" font-size="14.00">Gate Layer 4 GPU 0</text>
<text text-anchor="middle" x="1293" y="-8688.69" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="1293" y="-8673.69" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer4_gpu0&#45;&gt;gate_layer4_gpu0 -->
<g id="edge401" class="edge">
<title>mha_layer4_gpu0&#45;&gt;gate_layer4_gpu0</title>
<path fill="none" stroke="black" d="M1476.52,-8781.28C1451.03,-8769.07 1419.73,-8754.08 1390.25,-8739.96"/>
<polygon fill="black" stroke="black" points="1391.69,-8736.78 1381.16,-8735.61 1388.67,-8743.09 1391.69,-8736.78"/>
</g>
<!-- gate_layer4_gpu1 -->
<g id="node343" class="node">
<title>gate_layer4_gpu1</title>
<path fill="lightsteelblue" stroke="black" d="M2245.07,-8744.06C2245.07,-8744.06 1795.93,-8693.73 1795.93,-8693.73 1789.96,-8693.06 1789.96,-8691.73 1795.93,-8691.06 1795.93,-8691.06 2245.07,-8640.73 2245.07,-8640.73 2251.04,-8640.06 2262.96,-8640.06 2268.93,-8640.73 2268.93,-8640.73 2718.07,-8691.06 2718.07,-8691.06 2724.04,-8691.73 2724.04,-8693.06 2718.07,-8693.73 2718.07,-8693.73 2268.93,-8744.06 2268.93,-8744.06 2262.96,-8744.73 2251.04,-8744.73 2245.07,-8744.06"/>
<text text-anchor="middle" x="2257" y="-8703.69" font-family="Times,serif" font-size="14.00">Gate Layer 4 GPU 1</text>
<text text-anchor="middle" x="2257" y="-8688.69" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="2257" y="-8673.69" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer4_gpu1&#45;&gt;gate_layer4_gpu1 -->
<g id="edge402" class="edge">
<title>mha_layer4_gpu1&#45;&gt;gate_layer4_gpu1</title>
<path fill="none" stroke="black" d="M2440.52,-8781.28C2415.03,-8769.07 2383.73,-8754.08 2354.25,-8739.96"/>
<polygon fill="black" stroke="black" points="2355.69,-8736.78 2345.16,-8735.61 2352.67,-8743.09 2355.69,-8736.78"/>
</g>
<!-- gate_layer4_gpu2 -->
<g id="node344" class="node">
<title>gate_layer4_gpu2</title>
<path fill="lightsteelblue" stroke="black" d="M3209.07,-8744.06C3209.07,-8744.06 2759.93,-8693.73 2759.93,-8693.73 2753.96,-8693.06 2753.96,-8691.73 2759.93,-8691.06 2759.93,-8691.06 3209.07,-8640.73 3209.07,-8640.73 3215.04,-8640.06 3226.96,-8640.06 3232.93,-8640.73 3232.93,-8640.73 3682.07,-8691.06 3682.07,-8691.06 3688.04,-8691.73 3688.04,-8693.06 3682.07,-8693.73 3682.07,-8693.73 3232.93,-8744.06 3232.93,-8744.06 3226.96,-8744.73 3215.04,-8744.73 3209.07,-8744.06"/>
<text text-anchor="middle" x="3221" y="-8703.69" font-family="Times,serif" font-size="14.00">Gate Layer 4 GPU 2</text>
<text text-anchor="middle" x="3221" y="-8688.69" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="3221" y="-8673.69" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer4_gpu2&#45;&gt;gate_layer4_gpu2 -->
<g id="edge403" class="edge">
<title>mha_layer4_gpu2&#45;&gt;gate_layer4_gpu2</title>
<path fill="none" stroke="black" d="M3404.52,-8781.28C3379.03,-8769.07 3347.73,-8754.08 3318.25,-8739.96"/>
<polygon fill="black" stroke="black" points="3319.69,-8736.78 3309.16,-8735.61 3316.67,-8743.09 3319.69,-8736.78"/>
</g>
<!-- gate_layer4_gpu3 -->
<g id="node345" class="node">
<title>gate_layer4_gpu3</title>
<path fill="lightsteelblue" stroke="black" d="M4173.07,-8744.06C4173.07,-8744.06 3723.93,-8693.73 3723.93,-8693.73 3717.96,-8693.06 3717.96,-8691.73 3723.93,-8691.06 3723.93,-8691.06 4173.07,-8640.73 4173.07,-8640.73 4179.04,-8640.06 4190.96,-8640.06 4196.93,-8640.73 4196.93,-8640.73 4646.07,-8691.06 4646.07,-8691.06 4652.04,-8691.73 4652.04,-8693.06 4646.07,-8693.73 4646.07,-8693.73 4196.93,-8744.06 4196.93,-8744.06 4190.96,-8744.73 4179.04,-8744.73 4173.07,-8744.06"/>
<text text-anchor="middle" x="4185" y="-8703.69" font-family="Times,serif" font-size="14.00">Gate Layer 4 GPU 3</text>
<text text-anchor="middle" x="4185" y="-8688.69" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4185" y="-8673.69" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer4_gpu3&#45;&gt;gate_layer4_gpu3 -->
<g id="edge404" class="edge">
<title>mha_layer4_gpu3&#45;&gt;gate_layer4_gpu3</title>
<path fill="none" stroke="black" d="M4536.06,-8781.35C4477.86,-8766.77 4403.74,-8748.2 4338.62,-8731.88"/>
<polygon fill="black" stroke="black" points="4339.22,-8728.43 4328.67,-8729.39 4337.52,-8735.22 4339.22,-8728.43"/>
</g>
<!-- gate_layer4_gpu4 -->
<g id="node346" class="node">
<title>gate_layer4_gpu4</title>
<path fill="lightsteelblue" stroke="black" d="M5137.07,-8744.06C5137.07,-8744.06 4687.93,-8693.73 4687.93,-8693.73 4681.96,-8693.06 4681.96,-8691.73 4687.93,-8691.06 4687.93,-8691.06 5137.07,-8640.73 5137.07,-8640.73 5143.04,-8640.06 5154.96,-8640.06 5160.93,-8640.73 5160.93,-8640.73 5610.07,-8691.06 5610.07,-8691.06 5616.04,-8691.73 5616.04,-8693.06 5610.07,-8693.73 5610.07,-8693.73 5160.93,-8744.06 5160.93,-8744.06 5154.96,-8744.73 5143.04,-8744.73 5137.07,-8744.06"/>
<text text-anchor="middle" x="5149" y="-8703.69" font-family="Times,serif" font-size="14.00">Gate Layer 4 GPU 4</text>
<text text-anchor="middle" x="5149" y="-8688.69" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5149" y="-8673.69" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer4_gpu4&#45;&gt;gate_layer4_gpu4 -->
<g id="edge405" class="edge">
<title>mha_layer4_gpu4&#45;&gt;gate_layer4_gpu4</title>
<path fill="none" stroke="black" d="M5508.58,-8781.35C5448.47,-8766.65 5371.77,-8747.89 5304.66,-8731.47"/>
<polygon fill="black" stroke="black" points="5305.38,-8728.04 5294.84,-8729.07 5303.72,-8734.84 5305.38,-8728.04"/>
</g>
<!-- gate_layer4_gpu5 -->
<g id="node347" class="node">
<title>gate_layer4_gpu5</title>
<path fill="lightsteelblue" stroke="black" d="M6101.07,-8744.06C6101.07,-8744.06 5651.93,-8693.73 5651.93,-8693.73 5645.96,-8693.06 5645.96,-8691.73 5651.93,-8691.06 5651.93,-8691.06 6101.07,-8640.73 6101.07,-8640.73 6107.04,-8640.06 6118.96,-8640.06 6124.93,-8640.73 6124.93,-8640.73 6574.07,-8691.06 6574.07,-8691.06 6580.04,-8691.73 6580.04,-8693.06 6574.07,-8693.73 6574.07,-8693.73 6124.93,-8744.06 6124.93,-8744.06 6118.96,-8744.73 6107.04,-8744.73 6101.07,-8744.06"/>
<text text-anchor="middle" x="6113" y="-8703.69" font-family="Times,serif" font-size="14.00">Gate Layer 4 GPU 5</text>
<text text-anchor="middle" x="6113" y="-8688.69" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6113" y="-8673.69" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer4_gpu5&#45;&gt;gate_layer4_gpu5 -->
<g id="edge406" class="edge">
<title>mha_layer4_gpu5&#45;&gt;gate_layer4_gpu5</title>
<path fill="none" stroke="black" d="M6402.6,-8781.28C6356.97,-8767.43 6299.52,-8750 6247.86,-8734.32"/>
<polygon fill="black" stroke="black" points="6248.86,-8730.97 6238.28,-8731.41 6246.83,-8737.67 6248.86,-8730.97"/>
</g>
<!-- gate_layer4_gpu6 -->
<g id="node348" class="node">
<title>gate_layer4_gpu6</title>
<path fill="lightsteelblue" stroke="black" d="M7065.07,-8744.06C7065.07,-8744.06 6615.93,-8693.73 6615.93,-8693.73 6609.96,-8693.06 6609.96,-8691.73 6615.93,-8691.06 6615.93,-8691.06 7065.07,-8640.73 7065.07,-8640.73 7071.04,-8640.06 7082.96,-8640.06 7088.93,-8640.73 7088.93,-8640.73 7538.07,-8691.06 7538.07,-8691.06 7544.04,-8691.73 7544.04,-8693.06 7538.07,-8693.73 7538.07,-8693.73 7088.93,-8744.06 7088.93,-8744.06 7082.96,-8744.73 7071.04,-8744.73 7065.07,-8744.06"/>
<text text-anchor="middle" x="7077" y="-8703.69" font-family="Times,serif" font-size="14.00">Gate Layer 4 GPU 6</text>
<text text-anchor="middle" x="7077" y="-8688.69" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="7077" y="-8673.69" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer4_gpu6&#45;&gt;gate_layer4_gpu6 -->
<g id="edge407" class="edge">
<title>mha_layer4_gpu6&#45;&gt;gate_layer4_gpu6</title>
<path fill="none" stroke="black" d="M7246.58,-8781.28C7223.57,-8769.36 7195.44,-8754.77 7168.75,-8740.94"/>
<polygon fill="black" stroke="black" points="7170.25,-8737.78 7159.76,-8736.29 7167.03,-8743.99 7170.25,-8737.78"/>
</g>
<!-- gate_layer4_gpu7 -->
<g id="node349" class="node">
<title>gate_layer4_gpu7</title>
<path fill="lightsteelblue" stroke="black" d="M8029.07,-8744.06C8029.07,-8744.06 7579.93,-8693.73 7579.93,-8693.73 7573.96,-8693.06 7573.96,-8691.73 7579.93,-8691.06 7579.93,-8691.06 8029.07,-8640.73 8029.07,-8640.73 8035.04,-8640.06 8046.96,-8640.06 8052.93,-8640.73 8052.93,-8640.73 8502.07,-8691.06 8502.07,-8691.06 8508.04,-8691.73 8508.04,-8693.06 8502.07,-8693.73 8502.07,-8693.73 8052.93,-8744.06 8052.93,-8744.06 8046.96,-8744.73 8035.04,-8744.73 8029.07,-8744.06"/>
<text text-anchor="middle" x="8041" y="-8703.69" font-family="Times,serif" font-size="14.00">Gate Layer 4 GPU 7</text>
<text text-anchor="middle" x="8041" y="-8688.69" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="8041" y="-8673.69" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer4_gpu7&#45;&gt;gate_layer4_gpu7 -->
<g id="edge408" class="edge">
<title>mha_layer4_gpu7&#45;&gt;gate_layer4_gpu7</title>
<path fill="none" stroke="black" d="M8065.74,-8781.14C8063.42,-8772.9 8060.74,-8763.4 8058.02,-8753.76"/>
<polygon fill="black" stroke="black" points="8061.38,-8752.79 8055.3,-8744.12 8054.65,-8754.69 8061.38,-8752.79"/>
</g>
<!-- gate_layer4_gpu8 -->
<g id="node350" class="node">
<title>gate_layer4_gpu8</title>
<path fill="lightsteelblue" stroke="black" d="M8993.07,-8744.06C8993.07,-8744.06 8543.93,-8693.73 8543.93,-8693.73 8537.96,-8693.06 8537.96,-8691.73 8543.93,-8691.06 8543.93,-8691.06 8993.07,-8640.73 8993.07,-8640.73 8999.04,-8640.06 9010.96,-8640.06 9016.93,-8640.73 9016.93,-8640.73 9466.07,-8691.06 9466.07,-8691.06 9472.04,-8691.73 9472.04,-8693.06 9466.07,-8693.73 9466.07,-8693.73 9016.93,-8744.06 9016.93,-8744.06 9010.96,-8744.73 8999.04,-8744.73 8993.07,-8744.06"/>
<text text-anchor="middle" x="9005" y="-8703.69" font-family="Times,serif" font-size="14.00">Gate Layer 4 GPU 8</text>
<text text-anchor="middle" x="9005" y="-8688.69" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="9005" y="-8673.69" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer4_gpu8&#45;&gt;gate_layer4_gpu8 -->
<g id="edge409" class="edge">
<title>mha_layer4_gpu8&#45;&gt;gate_layer4_gpu8</title>
<path fill="none" stroke="black" d="M8974.85,-8781.14C8977.72,-8772.8 8981.02,-8763.17 8984.38,-8753.42"/>
<polygon fill="black" stroke="black" points="8987.79,-8754.25 8987.73,-8743.66 8981.17,-8751.98 8987.79,-8754.25"/>
</g>
<!-- gate_layer4_gpu9 -->
<g id="node351" class="node">
<title>gate_layer4_gpu9</title>
<path fill="lightsteelblue" stroke="black" d="M9957.07,-8744.06C9957.07,-8744.06 9507.93,-8693.73 9507.93,-8693.73 9501.96,-8693.06 9501.96,-8691.73 9507.93,-8691.06 9507.93,-8691.06 9957.07,-8640.73 9957.07,-8640.73 9963.04,-8640.06 9974.96,-8640.06 9980.93,-8640.73 9980.93,-8640.73 10430.07,-8691.06 10430.07,-8691.06 10436.04,-8691.73 10436.04,-8693.06 10430.07,-8693.73 10430.07,-8693.73 9980.93,-8744.06 9980.93,-8744.06 9974.96,-8744.73 9963.04,-8744.73 9957.07,-8744.06"/>
<text text-anchor="middle" x="9969" y="-8703.69" font-family="Times,serif" font-size="14.00">Gate Layer 4 GPU 9</text>
<text text-anchor="middle" x="9969" y="-8688.69" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="9969" y="-8673.69" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer4_gpu9&#45;&gt;gate_layer4_gpu9 -->
<g id="edge410" class="edge">
<title>mha_layer4_gpu9&#45;&gt;gate_layer4_gpu9</title>
<path fill="none" stroke="black" d="M9901.74,-8781.14C9909,-8771.66 9917.54,-8760.53 9926.05,-8749.43"/>
<polygon fill="black" stroke="black" points="9928.91,-8751.44 9932.22,-8741.38 9923.36,-8747.19 9928.91,-8751.44"/>
</g>
<!-- gate_layer4_gpu10 -->
<g id="node352" class="node">
<title>gate_layer4_gpu10</title>
<path fill="lightsteelblue" stroke="black" d="M10921.07,-8744.06C10921.07,-8744.06 10471.93,-8693.73 10471.93,-8693.73 10465.96,-8693.06 10465.96,-8691.73 10471.93,-8691.06 10471.93,-8691.06 10921.07,-8640.73 10921.07,-8640.73 10927.04,-8640.06 10938.96,-8640.06 10944.93,-8640.73 10944.93,-8640.73 11394.07,-8691.06 11394.07,-8691.06 11400.04,-8691.73 11400.04,-8693.06 11394.07,-8693.73 11394.07,-8693.73 10944.93,-8744.06 10944.93,-8744.06 10938.96,-8744.73 10927.04,-8744.73 10921.07,-8744.06"/>
<text text-anchor="middle" x="10933" y="-8703.69" font-family="Times,serif" font-size="14.00">Gate Layer 4 GPU 10</text>
<text text-anchor="middle" x="10933" y="-8688.69" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="10933" y="-8673.69" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer4_gpu10&#45;&gt;gate_layer4_gpu10 -->
<g id="edge411" class="edge">
<title>mha_layer4_gpu10&#45;&gt;gate_layer4_gpu10</title>
<path fill="none" stroke="black" d="M10846.41,-8781.14C10856.25,-8771.17 10867.9,-8759.37 10879.41,-8747.7"/>
<polygon fill="black" stroke="black" points="10882.01,-8750.05 10886.55,-8740.47 10877.03,-8745.13 10882.01,-8750.05"/>
</g>
<!-- gate_layer4_gpu11 -->
<g id="node353" class="node">
<title>gate_layer4_gpu11</title>
<path fill="lightsteelblue" stroke="black" d="M11885.07,-8744.06C11885.07,-8744.06 11435.93,-8693.73 11435.93,-8693.73 11429.96,-8693.06 11429.96,-8691.73 11435.93,-8691.06 11435.93,-8691.06 11885.07,-8640.73 11885.07,-8640.73 11891.04,-8640.06 11902.96,-8640.06 11908.93,-8640.73 11908.93,-8640.73 12358.07,-8691.06 12358.07,-8691.06 12364.04,-8691.73 12364.04,-8693.06 12358.07,-8693.73 12358.07,-8693.73 11908.93,-8744.06 11908.93,-8744.06 11902.96,-8744.73 11891.04,-8744.73 11885.07,-8744.06"/>
<text text-anchor="middle" x="11897" y="-8703.69" font-family="Times,serif" font-size="14.00">Gate Layer 4 GPU 11</text>
<text text-anchor="middle" x="11897" y="-8688.69" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11897" y="-8673.69" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer4_gpu11&#45;&gt;gate_layer4_gpu11 -->
<g id="edge412" class="edge">
<title>mha_layer4_gpu11&#45;&gt;gate_layer4_gpu11</title>
<path fill="none" stroke="black" d="M11801.14,-8781.14C11812.25,-8770.97 11825.45,-8758.88 11838.45,-8746.98"/>
<polygon fill="black" stroke="black" points="11841.05,-8749.35 11846.06,-8740.02 11836.32,-8744.19 11841.05,-8749.35"/>
</g>
<!-- gate_layer4_gpu12 -->
<g id="node354" class="node">
<title>gate_layer4_gpu12</title>
<path fill="lightsteelblue" stroke="black" d="M12849.07,-8744.06C12849.07,-8744.06 12399.93,-8693.73 12399.93,-8693.73 12393.96,-8693.06 12393.96,-8691.73 12399.93,-8691.06 12399.93,-8691.06 12849.07,-8640.73 12849.07,-8640.73 12855.04,-8640.06 12866.96,-8640.06 12872.93,-8640.73 12872.93,-8640.73 13322.07,-8691.06 13322.07,-8691.06 13328.04,-8691.73 13328.04,-8693.06 13322.07,-8693.73 13322.07,-8693.73 12872.93,-8744.06 12872.93,-8744.06 12866.96,-8744.73 12855.04,-8744.73 12849.07,-8744.06"/>
<text text-anchor="middle" x="12861" y="-8703.69" font-family="Times,serif" font-size="14.00">Gate Layer 4 GPU 12</text>
<text text-anchor="middle" x="12861" y="-8688.69" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="12861" y="-8673.69" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer4_gpu12&#45;&gt;gate_layer4_gpu12 -->
<g id="edge413" class="edge">
<title>mha_layer4_gpu12&#45;&gt;gate_layer4_gpu12</title>
<path fill="none" stroke="black" d="M12760.5,-8781.14C12772.38,-8770.76 12786.55,-8758.39 12800.44,-8746.26"/>
<polygon fill="black" stroke="black" points="12802.89,-8748.78 12808.12,-8739.56 12798.28,-8743.5 12802.89,-8748.78"/>
</g>
<!-- gate_layer4_gpu13 -->
<g id="node355" class="node">
<title>gate_layer4_gpu13</title>
<path fill="lightsteelblue" stroke="black" d="M13813.07,-8744.06C13813.07,-8744.06 13363.93,-8693.73 13363.93,-8693.73 13357.96,-8693.06 13357.96,-8691.73 13363.93,-8691.06 13363.93,-8691.06 13813.07,-8640.73 13813.07,-8640.73 13819.04,-8640.06 13830.96,-8640.06 13836.93,-8640.73 13836.93,-8640.73 14286.07,-8691.06 14286.07,-8691.06 14292.04,-8691.73 14292.04,-8693.06 14286.07,-8693.73 14286.07,-8693.73 13836.93,-8744.06 13836.93,-8744.06 13830.96,-8744.73 13819.04,-8744.73 13813.07,-8744.06"/>
<text text-anchor="middle" x="13825" y="-8703.69" font-family="Times,serif" font-size="14.00">Gate Layer 4 GPU 13</text>
<text text-anchor="middle" x="13825" y="-8688.69" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13825" y="-8673.69" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer4_gpu13&#45;&gt;gate_layer4_gpu13 -->
<g id="edge414" class="edge">
<title>mha_layer4_gpu13&#45;&gt;gate_layer4_gpu13</title>
<path fill="none" stroke="black" d="M13812.63,-8781.14C13813.74,-8773.26 13815.01,-8764.23 13816.31,-8755.04"/>
<polygon fill="black" stroke="black" points="13819.79,-8755.42 13817.72,-8745.03 13812.86,-8754.45 13819.79,-8755.42"/>
</g>
<!-- gate_layer4_gpu14 -->
<g id="node356" class="node">
<title>gate_layer4_gpu14</title>
<path fill="lightsteelblue" stroke="black" d="M14777.07,-8744.06C14777.07,-8744.06 14327.93,-8693.73 14327.93,-8693.73 14321.96,-8693.06 14321.96,-8691.73 14327.93,-8691.06 14327.93,-8691.06 14777.07,-8640.73 14777.07,-8640.73 14783.04,-8640.06 14794.96,-8640.06 14800.93,-8640.73 14800.93,-8640.73 15250.07,-8691.06 15250.07,-8691.06 15256.04,-8691.73 15256.04,-8693.06 15250.07,-8693.73 15250.07,-8693.73 14800.93,-8744.06 14800.93,-8744.06 14794.96,-8744.73 14783.04,-8744.73 14777.07,-8744.06"/>
<text text-anchor="middle" x="14789" y="-8703.69" font-family="Times,serif" font-size="14.00">Gate Layer 4 GPU 14</text>
<text text-anchor="middle" x="14789" y="-8688.69" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14789" y="-8673.69" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer4_gpu14&#45;&gt;gate_layer4_gpu14 -->
<g id="edge415" class="edge">
<title>mha_layer4_gpu14&#45;&gt;gate_layer4_gpu14</title>
<path fill="none" stroke="black" d="M14541.99,-8781.28C14579.23,-8768.03 14625.69,-8751.5 14668.24,-8736.36"/>
<polygon fill="black" stroke="black" points="14669.57,-8739.6 14677.82,-8732.95 14667.23,-8733 14669.57,-8739.6"/>
</g>
<!-- gate_layer4_gpu15 -->
<g id="node357" class="node">
<title>gate_layer4_gpu15</title>
<path fill="lightsteelblue" stroke="black" d="M15741.07,-8744.06C15741.07,-8744.06 15291.93,-8693.73 15291.93,-8693.73 15285.96,-8693.06 15285.96,-8691.73 15291.93,-8691.06 15291.93,-8691.06 15741.07,-8640.73 15741.07,-8640.73 15747.04,-8640.06 15758.96,-8640.06 15764.93,-8640.73 15764.93,-8640.73 16214.07,-8691.06 16214.07,-8691.06 16220.04,-8691.73 16220.04,-8693.06 16214.07,-8693.73 16214.07,-8693.73 15764.93,-8744.06 15764.93,-8744.06 15758.96,-8744.73 15747.04,-8744.73 15741.07,-8744.06"/>
<text text-anchor="middle" x="15753" y="-8703.69" font-family="Times,serif" font-size="14.00">Gate Layer 4 GPU 15</text>
<text text-anchor="middle" x="15753" y="-8688.69" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="15753" y="-8673.69" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer4_gpu15&#45;&gt;gate_layer4_gpu15 -->
<g id="edge416" class="edge">
<title>mha_layer4_gpu15&#45;&gt;gate_layer4_gpu15</title>
<path fill="none" stroke="black" d="M15204.33,-8781.35C15307.15,-8764.87 15441.76,-8743.29 15551.92,-8725.63"/>
<polygon fill="black" stroke="black" points="15552.5,-8729.08 15561.82,-8724.04 15551.39,-8722.17 15552.5,-8729.08"/>
</g>
<!-- route_layer4_gpu0 -->
<g id="node374" class="node">
<title>route_layer4_gpu0</title>
<path fill="orange" stroke="black" d="M1753.74,-8603.39C1753.74,-8603.39 1245.24,-8603.39 1245.24,-8603.39 1239.24,-8603.39 1228.5,-8599.72 1223.75,-8596.05 1223.75,-8596.05 1105.75,-8504.74 1105.75,-8504.74 1101,-8501.07 1102.26,-8497.39 1108.26,-8497.39 1108.26,-8497.39 1616.76,-8497.39 1616.76,-8497.39 1622.76,-8497.39 1633.5,-8501.07 1638.25,-8504.74 1638.25,-8504.74 1756.25,-8596.05 1756.25,-8596.05 1761,-8599.72 1759.74,-8603.39 1753.74,-8603.39"/>
<text text-anchor="middle" x="1431" y="-8561.69" font-family="Times,serif" font-size="14.00">Token Router Layer 4 GPU 0</text>
<text text-anchor="middle" x="1431" y="-8546.69" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="1431" y="-8531.69" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer4_gpu0&#45;&gt;route_layer4_gpu0 -->
<g id="edge417" class="edge">
<title>gate_layer4_gpu0&#45;&gt;route_layer4_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1339.34,-8644.39C1349.87,-8633.7 1361.2,-8622.21 1372.17,-8611.07"/>
<polygon fill="black" stroke="black" points="1374.8,-8613.4 1379.32,-8603.82 1369.81,-8608.48 1374.8,-8613.4"/>
</g>
<!-- route_layer4_gpu1 -->
<g id="node376" class="node">
<title>route_layer4_gpu1</title>
<path fill="orange" stroke="black" d="M2786.74,-8603.39C2786.74,-8603.39 2278.24,-8603.39 2278.24,-8603.39 2272.24,-8603.39 2261.5,-8599.72 2256.75,-8596.05 2256.75,-8596.05 2138.75,-8504.74 2138.75,-8504.74 2134,-8501.07 2135.26,-8497.39 2141.26,-8497.39 2141.26,-8497.39 2649.76,-8497.39 2649.76,-8497.39 2655.76,-8497.39 2666.5,-8501.07 2671.25,-8504.74 2671.25,-8504.74 2789.25,-8596.05 2789.25,-8596.05 2794,-8599.72 2792.74,-8603.39 2786.74,-8603.39"/>
<text text-anchor="middle" x="2464" y="-8561.69" font-family="Times,serif" font-size="14.00">Token Router Layer 4 GPU 1</text>
<text text-anchor="middle" x="2464" y="-8546.69" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="2464" y="-8531.69" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer4_gpu1&#45;&gt;route_layer4_gpu1 -->
<g id="edge418" class="edge">
<title>gate_layer4_gpu1&#45;&gt;route_layer4_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2323.07,-8646.71C2340.71,-8634.78 2360.04,-8621.7 2378.57,-8609.17"/>
<polygon fill="black" stroke="black" points="2380.69,-8611.96 2387.02,-8603.46 2376.77,-8606.16 2380.69,-8611.96"/>
</g>
<!-- route_layer4_gpu2 -->
<g id="node378" class="node">
<title>route_layer4_gpu2</title>
<path fill="orange" stroke="black" d="M3871.74,-8603.39C3871.74,-8603.39 3363.24,-8603.39 3363.24,-8603.39 3357.24,-8603.39 3346.5,-8599.72 3341.75,-8596.05 3341.75,-8596.05 3223.75,-8504.74 3223.75,-8504.74 3219,-8501.07 3220.26,-8497.39 3226.26,-8497.39 3226.26,-8497.39 3734.76,-8497.39 3734.76,-8497.39 3740.76,-8497.39 3751.5,-8501.07 3756.25,-8504.74 3756.25,-8504.74 3874.25,-8596.05 3874.25,-8596.05 3879,-8599.72 3877.74,-8603.39 3871.74,-8603.39"/>
<text text-anchor="middle" x="3549" y="-8561.69" font-family="Times,serif" font-size="14.00">Token Router Layer 4 GPU 2</text>
<text text-anchor="middle" x="3549" y="-8546.69" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="3549" y="-8531.69" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer4_gpu2&#45;&gt;route_layer4_gpu2 -->
<g id="edge419" class="edge">
<title>gate_layer4_gpu2&#45;&gt;route_layer4_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3317.64,-8650.15C3348.99,-8636.76 3384.31,-8621.69 3417.75,-8607.42"/>
<polygon fill="black" stroke="black" points="3419.3,-8610.56 3427.12,-8603.42 3416.55,-8604.12 3419.3,-8610.56"/>
</g>
<!-- route_layer4_gpu3 -->
<g id="node380" class="node">
<title>route_layer4_gpu3</title>
<path fill="orange" stroke="black" d="M4697.74,-8603.39C4697.74,-8603.39 4189.24,-8603.39 4189.24,-8603.39 4183.24,-8603.39 4172.5,-8599.72 4167.75,-8596.05 4167.75,-8596.05 4049.75,-8504.74 4049.75,-8504.74 4045,-8501.07 4046.26,-8497.39 4052.26,-8497.39 4052.26,-8497.39 4560.76,-8497.39 4560.76,-8497.39 4566.76,-8497.39 4577.5,-8501.07 4582.25,-8504.74 4582.25,-8504.74 4700.25,-8596.05 4700.25,-8596.05 4705,-8599.72 4703.74,-8603.39 4697.74,-8603.39"/>
<text text-anchor="middle" x="4375" y="-8561.69" font-family="Times,serif" font-size="14.00">Token Router Layer 4 GPU 3</text>
<text text-anchor="middle" x="4375" y="-8546.69" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="4375" y="-8531.69" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer4_gpu3&#45;&gt;route_layer4_gpu3 -->
<g id="edge420" class="edge">
<title>gate_layer4_gpu3&#45;&gt;route_layer4_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4246.43,-8646.13C4262.26,-8634.46 4279.53,-8621.74 4296.13,-8609.51"/>
<polygon fill="black" stroke="black" points="4298.23,-8612.31 4304.21,-8603.56 4294.08,-8606.67 4298.23,-8612.31"/>
</g>
<!-- route_layer4_gpu4 -->
<g id="node382" class="node">
<title>route_layer4_gpu4</title>
<path fill="orange" stroke="black" d="M5644.74,-8603.39C5644.74,-8603.39 5136.24,-8603.39 5136.24,-8603.39 5130.24,-8603.39 5119.5,-8599.72 5114.75,-8596.05 5114.75,-8596.05 4996.75,-8504.74 4996.75,-8504.74 4992,-8501.07 4993.26,-8497.39 4999.26,-8497.39 4999.26,-8497.39 5507.76,-8497.39 5507.76,-8497.39 5513.76,-8497.39 5524.5,-8501.07 5529.25,-8504.74 5529.25,-8504.74 5647.25,-8596.05 5647.25,-8596.05 5652,-8599.72 5650.74,-8603.39 5644.74,-8603.39"/>
<text text-anchor="middle" x="5322" y="-8561.69" font-family="Times,serif" font-size="14.00">Token Router Layer 4 GPU 4</text>
<text text-anchor="middle" x="5322" y="-8546.69" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="5322" y="-8531.69" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer4_gpu4&#45;&gt;route_layer4_gpu4 -->
<g id="edge421" class="edge">
<title>gate_layer4_gpu4&#45;&gt;route_layer4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5205.65,-8645.55C5219.7,-8634.18 5234.95,-8621.84 5249.64,-8609.95"/>
<polygon fill="black" stroke="black" points="5252.16,-8612.41 5257.73,-8603.4 5247.76,-8606.97 5252.16,-8612.41"/>
</g>
<!-- route_layer4_gpu5 -->
<g id="node384" class="node">
<title>route_layer4_gpu5</title>
<path fill="orange" stroke="black" d="M6746.74,-8603.39C6746.74,-8603.39 6238.24,-8603.39 6238.24,-8603.39 6232.24,-8603.39 6221.5,-8599.72 6216.75,-8596.05 6216.75,-8596.05 6098.75,-8504.74 6098.75,-8504.74 6094,-8501.07 6095.26,-8497.39 6101.26,-8497.39 6101.26,-8497.39 6609.76,-8497.39 6609.76,-8497.39 6615.76,-8497.39 6626.5,-8501.07 6631.25,-8504.74 6631.25,-8504.74 6749.25,-8596.05 6749.25,-8596.05 6754,-8599.72 6752.74,-8603.39 6746.74,-8603.39"/>
<text text-anchor="middle" x="6424" y="-8561.69" font-family="Times,serif" font-size="14.00">Token Router Layer 4 GPU 5</text>
<text text-anchor="middle" x="6424" y="-8546.69" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="6424" y="-8531.69" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer4_gpu5&#45;&gt;route_layer4_gpu5 -->
<g id="edge422" class="edge">
<title>gate_layer4_gpu5&#45;&gt;route_layer4_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6205.89,-8649.58C6235.21,-8636.38 6268.1,-8621.57 6299.27,-8607.54"/>
<polygon fill="black" stroke="black" points="6300.77,-8610.71 6308.45,-8603.41 6297.89,-8604.32 6300.77,-8610.71"/>
</g>
<!-- route_layer4_gpu6 -->
<g id="node386" class="node">
<title>route_layer4_gpu6</title>
<path fill="orange" stroke="black" d="M7641.74,-8603.39C7641.74,-8603.39 7133.24,-8603.39 7133.24,-8603.39 7127.24,-8603.39 7116.5,-8599.72 7111.75,-8596.05 7111.75,-8596.05 6993.75,-8504.74 6993.75,-8504.74 6989,-8501.07 6990.26,-8497.39 6996.26,-8497.39 6996.26,-8497.39 7504.76,-8497.39 7504.76,-8497.39 7510.76,-8497.39 7521.5,-8501.07 7526.25,-8504.74 7526.25,-8504.74 7644.25,-8596.05 7644.25,-8596.05 7649,-8599.72 7647.74,-8603.39 7641.74,-8603.39"/>
<text text-anchor="middle" x="7319" y="-8561.69" font-family="Times,serif" font-size="14.00">Token Router Layer 4 GPU 6</text>
<text text-anchor="middle" x="7319" y="-8546.69" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="7319" y="-8531.69" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer4_gpu6&#45;&gt;route_layer4_gpu6 -->
<g id="edge423" class="edge">
<title>gate_layer4_gpu6&#45;&gt;route_layer4_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7152.57,-8647.67C7173.88,-8635.35 7197.38,-8621.75 7219.84,-8608.76"/>
<polygon fill="black" stroke="black" points="7221.82,-8611.66 7228.72,-8603.62 7218.31,-8605.6 7221.82,-8611.66"/>
</g>
<!-- route_layer4_gpu7 -->
<g id="node388" class="node">
<title>route_layer4_gpu7</title>
<path fill="orange" stroke="black" d="M8432.74,-8603.39C8432.74,-8603.39 7924.24,-8603.39 7924.24,-8603.39 7918.24,-8603.39 7907.5,-8599.72 7902.75,-8596.05 7902.75,-8596.05 7784.75,-8504.74 7784.75,-8504.74 7780,-8501.07 7781.26,-8497.39 7787.26,-8497.39 7787.26,-8497.39 8295.76,-8497.39 8295.76,-8497.39 8301.76,-8497.39 8312.5,-8501.07 8317.25,-8504.74 8317.25,-8504.74 8435.25,-8596.05 8435.25,-8596.05 8440,-8599.72 8438.74,-8603.39 8432.74,-8603.39"/>
<text text-anchor="middle" x="8110" y="-8561.69" font-family="Times,serif" font-size="14.00">Token Router Layer 4 GPU 7</text>
<text text-anchor="middle" x="8110" y="-8546.69" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="8110" y="-8531.69" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer4_gpu7&#45;&gt;route_layer4_gpu7 -->
<g id="edge424" class="edge">
<title>gate_layer4_gpu7&#45;&gt;route_layer4_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8065.33,-8642.03C8069.97,-8632.61 8074.89,-8622.63 8079.69,-8612.88"/>
<polygon fill="black" stroke="black" points="8082.97,-8614.15 8084.26,-8603.63 8076.7,-8611.05 8082.97,-8614.15"/>
</g>
<!-- route_layer4_gpu8 -->
<g id="node390" class="node">
<title>route_layer4_gpu8</title>
<path fill="orange" stroke="black" d="M9258.74,-8603.39C9258.74,-8603.39 8750.24,-8603.39 8750.24,-8603.39 8744.24,-8603.39 8733.5,-8599.72 8728.75,-8596.05 8728.75,-8596.05 8610.75,-8504.74 8610.75,-8504.74 8606,-8501.07 8607.26,-8497.39 8613.26,-8497.39 8613.26,-8497.39 9121.76,-8497.39 9121.76,-8497.39 9127.76,-8497.39 9138.5,-8501.07 9143.25,-8504.74 9143.25,-8504.74 9261.25,-8596.05 9261.25,-8596.05 9266,-8599.72 9264.74,-8603.39 9258.74,-8603.39"/>
<text text-anchor="middle" x="8936" y="-8561.69" font-family="Times,serif" font-size="14.00">Token Router Layer 4 GPU 8</text>
<text text-anchor="middle" x="8936" y="-8546.69" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="8936" y="-8531.69" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer4_gpu8&#45;&gt;route_layer4_gpu8 -->
<g id="edge425" class="edge">
<title>gate_layer4_gpu8&#45;&gt;route_layer4_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8980.67,-8642.03C8976.03,-8632.61 8971.11,-8622.63 8966.31,-8612.88"/>
<polygon fill="black" stroke="black" points="8969.3,-8611.05 8961.74,-8603.63 8963.03,-8614.15 8969.3,-8611.05"/>
</g>
<!-- route_layer4_gpu9 -->
<g id="node392" class="node">
<title>route_layer4_gpu9</title>
<path fill="orange" stroke="black" d="M10153.74,-8603.39C10153.74,-8603.39 9645.24,-8603.39 9645.24,-8603.39 9639.24,-8603.39 9628.5,-8599.72 9623.75,-8596.05 9623.75,-8596.05 9505.75,-8504.74 9505.75,-8504.74 9501,-8501.07 9502.26,-8497.39 9508.26,-8497.39 9508.26,-8497.39 10016.76,-8497.39 10016.76,-8497.39 10022.76,-8497.39 10033.5,-8501.07 10038.25,-8504.74 10038.25,-8504.74 10156.25,-8596.05 10156.25,-8596.05 10161,-8599.72 10159.74,-8603.39 10153.74,-8603.39"/>
<text text-anchor="middle" x="9831" y="-8561.69" font-family="Times,serif" font-size="14.00">Token Router Layer 4 GPU 9</text>
<text text-anchor="middle" x="9831" y="-8546.69" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="9831" y="-8531.69" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer4_gpu9&#45;&gt;route_layer4_gpu9 -->
<g id="edge426" class="edge">
<title>gate_layer4_gpu9&#45;&gt;route_layer4_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9922.66,-8644.39C9912.13,-8633.7 9900.8,-8622.21 9889.83,-8611.07"/>
<polygon fill="black" stroke="black" points="9892.19,-8608.48 9882.68,-8603.82 9887.2,-8613.4 9892.19,-8608.48"/>
</g>
<!-- route_layer4_gpu10 -->
<g id="node394" class="node">
<title>route_layer4_gpu10</title>
<path fill="orange" stroke="black" d="M11082.74,-8603.39C11082.74,-8603.39 10574.24,-8603.39 10574.24,-8603.39 10568.24,-8603.39 10557.5,-8599.72 10552.75,-8596.05 10552.75,-8596.05 10434.75,-8504.74 10434.75,-8504.74 10430,-8501.07 10431.26,-8497.39 10437.26,-8497.39 10437.26,-8497.39 10945.76,-8497.39 10945.76,-8497.39 10951.76,-8497.39 10962.5,-8501.07 10967.25,-8504.74 10967.25,-8504.74 11085.25,-8596.05 11085.25,-8596.05 11090,-8599.72 11088.74,-8603.39 11082.74,-8603.39"/>
<text text-anchor="middle" x="10760" y="-8561.69" font-family="Times,serif" font-size="14.00">Token Router Layer 4 GPU 10</text>
<text text-anchor="middle" x="10760" y="-8546.69" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="10760" y="-8531.69" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer4_gpu10&#45;&gt;route_layer4_gpu10 -->
<g id="edge427" class="edge">
<title>gate_layer4_gpu10&#45;&gt;route_layer4_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10876.35,-8645.55C10862.3,-8634.18 10847.05,-8621.84 10832.36,-8609.95"/>
<polygon fill="black" stroke="black" points="10834.24,-8606.97 10824.27,-8603.4 10829.84,-8612.41 10834.24,-8606.97"/>
</g>
<!-- route_layer4_gpu11 -->
<g id="node396" class="node">
<title>route_layer4_gpu11</title>
<path fill="orange" stroke="black" d="M12029.74,-8603.39C12029.74,-8603.39 11521.24,-8603.39 11521.24,-8603.39 11515.24,-8603.39 11504.5,-8599.72 11499.75,-8596.05 11499.75,-8596.05 11381.75,-8504.74 11381.75,-8504.74 11377,-8501.07 11378.26,-8497.39 11384.26,-8497.39 11384.26,-8497.39 11892.76,-8497.39 11892.76,-8497.39 11898.76,-8497.39 11909.5,-8501.07 11914.25,-8504.74 11914.25,-8504.74 12032.25,-8596.05 12032.25,-8596.05 12037,-8599.72 12035.74,-8603.39 12029.74,-8603.39"/>
<text text-anchor="middle" x="11707" y="-8561.69" font-family="Times,serif" font-size="14.00">Token Router Layer 4 GPU 11</text>
<text text-anchor="middle" x="11707" y="-8546.69" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="11707" y="-8531.69" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer4_gpu11&#45;&gt;route_layer4_gpu11 -->
<g id="edge428" class="edge">
<title>gate_layer4_gpu11&#45;&gt;route_layer4_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11835.57,-8646.13C11819.74,-8634.46 11802.47,-8621.74 11785.87,-8609.51"/>
<polygon fill="black" stroke="black" points="11787.92,-8606.67 11777.79,-8603.56 11783.77,-8612.31 11787.92,-8606.67"/>
</g>
<!-- route_layer4_gpu12 -->
<g id="node398" class="node">
<title>route_layer4_gpu12</title>
<path fill="orange" stroke="black" d="M12984.74,-8603.39C12984.74,-8603.39 12476.24,-8603.39 12476.24,-8603.39 12470.24,-8603.39 12459.5,-8599.72 12454.75,-8596.05 12454.75,-8596.05 12336.75,-8504.74 12336.75,-8504.74 12332,-8501.07 12333.26,-8497.39 12339.26,-8497.39 12339.26,-8497.39 12847.76,-8497.39 12847.76,-8497.39 12853.76,-8497.39 12864.5,-8501.07 12869.25,-8504.74 12869.25,-8504.74 12987.25,-8596.05 12987.25,-8596.05 12992,-8599.72 12990.74,-8603.39 12984.74,-8603.39"/>
<text text-anchor="middle" x="12662" y="-8561.69" font-family="Times,serif" font-size="14.00">Token Router Layer 4 GPU 12</text>
<text text-anchor="middle" x="12662" y="-8546.69" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="12662" y="-8531.69" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer4_gpu12&#45;&gt;route_layer4_gpu12 -->
<g id="edge429" class="edge">
<title>gate_layer4_gpu12&#45;&gt;route_layer4_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12797.21,-8646.52C12780.51,-8634.77 12762.25,-8621.92 12744.71,-8609.58"/>
<polygon fill="black" stroke="black" points="12746.36,-8606.47 12736.17,-8603.57 12742.34,-8612.19 12746.36,-8606.47"/>
</g>
<!-- route_layer4_gpu13 -->
<g id="node400" class="node">
<title>route_layer4_gpu13</title>
<path fill="orange" stroke="black" d="M13944.74,-8603.39C13944.74,-8603.39 13436.24,-8603.39 13436.24,-8603.39 13430.24,-8603.39 13419.5,-8599.72 13414.75,-8596.05 13414.75,-8596.05 13296.75,-8504.74 13296.75,-8504.74 13292,-8501.07 13293.26,-8497.39 13299.26,-8497.39 13299.26,-8497.39 13807.76,-8497.39 13807.76,-8497.39 13813.76,-8497.39 13824.5,-8501.07 13829.25,-8504.74 13829.25,-8504.74 13947.25,-8596.05 13947.25,-8596.05 13952,-8599.72 13950.74,-8603.39 13944.74,-8603.39"/>
<text text-anchor="middle" x="13622" y="-8561.69" font-family="Times,serif" font-size="14.00">Token Router Layer 4 GPU 13</text>
<text text-anchor="middle" x="13622" y="-8546.69" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="13622" y="-8531.69" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer4_gpu13&#45;&gt;route_layer4_gpu13 -->
<g id="edge430" class="edge">
<title>gate_layer4_gpu13&#45;&gt;route_layer4_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13759.93,-8646.52C13742.89,-8634.77 13724.27,-8621.92 13706.38,-8609.58"/>
<polygon fill="black" stroke="black" points="13707.88,-8606.37 13697.66,-8603.57 13703.91,-8612.13 13707.88,-8606.37"/>
</g>
<!-- route_layer4_gpu14 -->
<g id="node402" class="node">
<title>route_layer4_gpu14</title>
<path fill="orange" stroke="black" d="M14906.74,-8603.39C14906.74,-8603.39 14398.24,-8603.39 14398.24,-8603.39 14392.24,-8603.39 14381.5,-8599.72 14376.75,-8596.05 14376.75,-8596.05 14258.75,-8504.74 14258.75,-8504.74 14254,-8501.07 14255.26,-8497.39 14261.26,-8497.39 14261.26,-8497.39 14769.76,-8497.39 14769.76,-8497.39 14775.76,-8497.39 14786.5,-8501.07 14791.25,-8504.74 14791.25,-8504.74 14909.25,-8596.05 14909.25,-8596.05 14914,-8599.72 14912.74,-8603.39 14906.74,-8603.39"/>
<text text-anchor="middle" x="14584" y="-8561.69" font-family="Times,serif" font-size="14.00">Token Router Layer 4 GPU 14</text>
<text text-anchor="middle" x="14584" y="-8546.69" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="14584" y="-8531.69" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer4_gpu14&#45;&gt;route_layer4_gpu14 -->
<g id="edge431" class="edge">
<title>gate_layer4_gpu14&#45;&gt;route_layer4_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14723.57,-8646.71C14706.1,-8634.78 14686.96,-8621.7 14668.61,-8609.17"/>
<polygon fill="black" stroke="black" points="14670.47,-8606.21 14660.24,-8603.46 14666.52,-8611.99 14670.47,-8606.21"/>
</g>
<!-- route_layer4_gpu15 -->
<g id="node404" class="node">
<title>route_layer4_gpu15</title>
<path fill="orange" stroke="black" d="M15869.74,-8603.39C15869.74,-8603.39 15361.24,-8603.39 15361.24,-8603.39 15355.24,-8603.39 15344.5,-8599.72 15339.75,-8596.05 15339.75,-8596.05 15221.75,-8504.74 15221.75,-8504.74 15217,-8501.07 15218.26,-8497.39 15224.26,-8497.39 15224.26,-8497.39 15732.76,-8497.39 15732.76,-8497.39 15738.76,-8497.39 15749.5,-8501.07 15754.25,-8504.74 15754.25,-8504.74 15872.25,-8596.05 15872.25,-8596.05 15877,-8599.72 15875.74,-8603.39 15869.74,-8603.39"/>
<text text-anchor="middle" x="15547" y="-8561.69" font-family="Times,serif" font-size="14.00">Token Router Layer 4 GPU 15</text>
<text text-anchor="middle" x="15547" y="-8546.69" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="15547" y="-8531.69" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer4_gpu15&#45;&gt;route_layer4_gpu15 -->
<g id="edge432" class="edge">
<title>gate_layer4_gpu15&#45;&gt;route_layer4_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15687.25,-8646.71C15669.69,-8634.78 15650.46,-8621.7 15632.02,-8609.17"/>
<polygon fill="black" stroke="black" points="15633.85,-8606.18 15623.61,-8603.46 15629.91,-8611.97 15633.85,-8606.18"/>
</g>
<!-- expert_layer4_gpu0_expert0 -->
<g id="node358" class="node">
<title>expert_layer4_gpu0_expert0</title>
<path fill="lightcoral" stroke="black" d="M2361.5,-8350.44C2361.5,-8350.44 1892.5,-8350.44 1892.5,-8350.44 1886.5,-8350.44 1880.5,-8344.44 1880.5,-8338.44 1880.5,-8338.44 1880.5,-8294.44 1880.5,-8294.44 1880.5,-8288.44 1886.5,-8282.44 1892.5,-8282.44 1892.5,-8282.44 2361.5,-8282.44 2361.5,-8282.44 2367.5,-8282.44 2373.5,-8288.44 2373.5,-8294.44 2373.5,-8294.44 2373.5,-8338.44 2373.5,-8338.44 2373.5,-8344.44 2367.5,-8350.44 2361.5,-8350.44"/>
<text text-anchor="middle" x="2127" y="-8335.24" font-family="Times,serif" font-size="14.00">Expert 0 Layer 4 GPU 0</text>
<text text-anchor="middle" x="2127" y="-8320.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2127" y="-8305.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2127" y="-8290.24" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer4_gpu0 -->
<g id="node375" class="node">
<title>aggregate_layer4_gpu0</title>
<path fill="orange" stroke="black" d="M2096.29,-8246.44C2096.29,-8246.44 1609.19,-8246.44 1609.19,-8246.44 1603.19,-8246.44 1592.52,-8242.67 1587.85,-8238.91 1587.85,-8238.91 1475.06,-8147.97 1475.06,-8147.97 1470.38,-8144.21 1471.71,-8140.44 1477.71,-8140.44 1477.71,-8140.44 1964.81,-8140.44 1964.81,-8140.44 1970.81,-8140.44 1981.48,-8144.21 1986.15,-8147.97 1986.15,-8147.97 2098.94,-8238.91 2098.94,-8238.91 2103.62,-8242.67 2102.29,-8246.44 2096.29,-8246.44"/>
<text text-anchor="middle" x="1787" y="-8204.74" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 4 GPU 0</text>
<text text-anchor="middle" x="1787" y="-8189.74" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="1787" y="-8174.74" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer4_gpu0_expert0&#45;&gt;aggregate_layer4_gpu0 -->
<g id="edge465" class="edge">
<title>expert_layer4_gpu0_expert0&#45;&gt;aggregate_layer4_gpu0</title>
<path fill="none" stroke="black" d="M2034.09,-8282.38C2005.85,-8272.33 1974.01,-8260.99 1942.81,-8249.89"/>
<polygon fill="black" stroke="black" points="1943.74,-8246.51 1933.15,-8246.45 1941.4,-8253.1 1943.74,-8246.51"/>
</g>
<!-- expert_layer4_gpu1_expert1 -->
<g id="node359" class="node">
<title>expert_layer4_gpu1_expert1</title>
<path fill="lightcoral" stroke="black" d="M3025.5,-8350.44C3025.5,-8350.44 2556.5,-8350.44 2556.5,-8350.44 2550.5,-8350.44 2544.5,-8344.44 2544.5,-8338.44 2544.5,-8338.44 2544.5,-8294.44 2544.5,-8294.44 2544.5,-8288.44 2550.5,-8282.44 2556.5,-8282.44 2556.5,-8282.44 3025.5,-8282.44 3025.5,-8282.44 3031.5,-8282.44 3037.5,-8288.44 3037.5,-8294.44 3037.5,-8294.44 3037.5,-8338.44 3037.5,-8338.44 3037.5,-8344.44 3031.5,-8350.44 3025.5,-8350.44"/>
<text text-anchor="middle" x="2791" y="-8335.24" font-family="Times,serif" font-size="14.00">Expert 1 Layer 4 GPU 1</text>
<text text-anchor="middle" x="2791" y="-8320.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2791" y="-8305.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2791" y="-8290.24" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer4_gpu1 -->
<g id="node377" class="node">
<title>aggregate_layer4_gpu1</title>
<path fill="orange" stroke="black" d="M2913.29,-8246.44C2913.29,-8246.44 2426.19,-8246.44 2426.19,-8246.44 2420.19,-8246.44 2409.52,-8242.67 2404.85,-8238.91 2404.85,-8238.91 2292.06,-8147.97 2292.06,-8147.97 2287.38,-8144.21 2288.71,-8140.44 2294.71,-8140.44 2294.71,-8140.44 2781.81,-8140.44 2781.81,-8140.44 2787.81,-8140.44 2798.48,-8144.21 2803.15,-8147.97 2803.15,-8147.97 2915.94,-8238.91 2915.94,-8238.91 2920.62,-8242.67 2919.29,-8246.44 2913.29,-8246.44"/>
<text text-anchor="middle" x="2604" y="-8204.74" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 4 GPU 1</text>
<text text-anchor="middle" x="2604" y="-8189.74" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="2604" y="-8174.74" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer4_gpu1_expert1&#45;&gt;aggregate_layer4_gpu1 -->
<g id="edge466" class="edge">
<title>expert_layer4_gpu1_expert1&#45;&gt;aggregate_layer4_gpu1</title>
<path fill="none" stroke="black" d="M2739.9,-8282.38C2725.35,-8272.96 2709.06,-8262.42 2692.96,-8252"/>
<polygon fill="black" stroke="black" points="2694.86,-8249.06 2684.56,-8246.57 2691.05,-8254.94 2694.86,-8249.06"/>
</g>
<!-- expert_layer4_gpu2_expert2 -->
<g id="node360" class="node">
<title>expert_layer4_gpu2_expert2</title>
<path fill="lightcoral" stroke="black" d="M4043.5,-8350.44C4043.5,-8350.44 3574.5,-8350.44 3574.5,-8350.44 3568.5,-8350.44 3562.5,-8344.44 3562.5,-8338.44 3562.5,-8338.44 3562.5,-8294.44 3562.5,-8294.44 3562.5,-8288.44 3568.5,-8282.44 3574.5,-8282.44 3574.5,-8282.44 4043.5,-8282.44 4043.5,-8282.44 4049.5,-8282.44 4055.5,-8288.44 4055.5,-8294.44 4055.5,-8294.44 4055.5,-8338.44 4055.5,-8338.44 4055.5,-8344.44 4049.5,-8350.44 4043.5,-8350.44"/>
<text text-anchor="middle" x="3809" y="-8335.24" font-family="Times,serif" font-size="14.00">Expert 2 Layer 4 GPU 2</text>
<text text-anchor="middle" x="3809" y="-8320.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3809" y="-8305.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3809" y="-8290.24" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer4_gpu2 -->
<g id="node379" class="node">
<title>aggregate_layer4_gpu2</title>
<path fill="orange" stroke="black" d="M3965.29,-8246.44C3965.29,-8246.44 3478.19,-8246.44 3478.19,-8246.44 3472.19,-8246.44 3461.52,-8242.67 3456.85,-8238.91 3456.85,-8238.91 3344.06,-8147.97 3344.06,-8147.97 3339.38,-8144.21 3340.71,-8140.44 3346.71,-8140.44 3346.71,-8140.44 3833.81,-8140.44 3833.81,-8140.44 3839.81,-8140.44 3850.48,-8144.21 3855.15,-8147.97 3855.15,-8147.97 3967.94,-8238.91 3967.94,-8238.91 3972.62,-8242.67 3971.29,-8246.44 3965.29,-8246.44"/>
<text text-anchor="middle" x="3656" y="-8204.74" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 4 GPU 2</text>
<text text-anchor="middle" x="3656" y="-8189.74" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="3656" y="-8174.74" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer4_gpu2_expert2&#45;&gt;aggregate_layer4_gpu2 -->
<g id="edge467" class="edge">
<title>expert_layer4_gpu2_expert2&#45;&gt;aggregate_layer4_gpu2</title>
<path fill="none" stroke="black" d="M3767.19,-8282.38C3755.62,-8273.22 3742.69,-8263 3729.87,-8252.86"/>
<polygon fill="black" stroke="black" points="3731.93,-8250.02 3721.91,-8246.57 3727.59,-8255.52 3731.93,-8250.02"/>
</g>
<!-- expert_layer4_gpu3_expert3 -->
<g id="node361" class="node">
<title>expert_layer4_gpu3_expert3</title>
<path fill="lightcoral" stroke="black" d="M4942.5,-8350.44C4942.5,-8350.44 4473.5,-8350.44 4473.5,-8350.44 4467.5,-8350.44 4461.5,-8344.44 4461.5,-8338.44 4461.5,-8338.44 4461.5,-8294.44 4461.5,-8294.44 4461.5,-8288.44 4467.5,-8282.44 4473.5,-8282.44 4473.5,-8282.44 4942.5,-8282.44 4942.5,-8282.44 4948.5,-8282.44 4954.5,-8288.44 4954.5,-8294.44 4954.5,-8294.44 4954.5,-8338.44 4954.5,-8338.44 4954.5,-8344.44 4948.5,-8350.44 4942.5,-8350.44"/>
<text text-anchor="middle" x="4708" y="-8335.24" font-family="Times,serif" font-size="14.00">Expert 3 Layer 4 GPU 3</text>
<text text-anchor="middle" x="4708" y="-8320.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4708" y="-8305.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4708" y="-8290.24" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer4_gpu3 -->
<g id="node381" class="node">
<title>aggregate_layer4_gpu3</title>
<path fill="orange" stroke="black" d="M4782.29,-8246.44C4782.29,-8246.44 4295.19,-8246.44 4295.19,-8246.44 4289.19,-8246.44 4278.52,-8242.67 4273.85,-8238.91 4273.85,-8238.91 4161.06,-8147.97 4161.06,-8147.97 4156.38,-8144.21 4157.71,-8140.44 4163.71,-8140.44 4163.71,-8140.44 4650.81,-8140.44 4650.81,-8140.44 4656.81,-8140.44 4667.48,-8144.21 4672.15,-8147.97 4672.15,-8147.97 4784.94,-8238.91 4784.94,-8238.91 4789.62,-8242.67 4788.29,-8246.44 4782.29,-8246.44"/>
<text text-anchor="middle" x="4473" y="-8204.74" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 4 GPU 3</text>
<text text-anchor="middle" x="4473" y="-8189.74" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="4473" y="-8174.74" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer4_gpu3_expert3&#45;&gt;aggregate_layer4_gpu3 -->
<g id="edge468" class="edge">
<title>expert_layer4_gpu3_expert3&#45;&gt;aggregate_layer4_gpu3</title>
<path fill="none" stroke="black" d="M4643.79,-8282.38C4625.08,-8272.75 4604.09,-8261.94 4583.4,-8251.28"/>
<polygon fill="black" stroke="black" points="4584.73,-8248.03 4574.24,-8246.57 4581.53,-8254.26 4584.73,-8248.03"/>
</g>
<!-- expert_layer4_gpu4_expert4 -->
<g id="node362" class="node">
<title>expert_layer4_gpu4_expert4</title>
<path fill="lightcoral" stroke="black" d="M5764.5,-8350.44C5764.5,-8350.44 5295.5,-8350.44 5295.5,-8350.44 5289.5,-8350.44 5283.5,-8344.44 5283.5,-8338.44 5283.5,-8338.44 5283.5,-8294.44 5283.5,-8294.44 5283.5,-8288.44 5289.5,-8282.44 5295.5,-8282.44 5295.5,-8282.44 5764.5,-8282.44 5764.5,-8282.44 5770.5,-8282.44 5776.5,-8288.44 5776.5,-8294.44 5776.5,-8294.44 5776.5,-8338.44 5776.5,-8338.44 5776.5,-8344.44 5770.5,-8350.44 5764.5,-8350.44"/>
<text text-anchor="middle" x="5530" y="-8335.24" font-family="Times,serif" font-size="14.00">Expert 4 Layer 4 GPU 4</text>
<text text-anchor="middle" x="5530" y="-8320.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5530" y="-8305.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5530" y="-8290.24" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer4_gpu4 -->
<g id="node383" class="node">
<title>aggregate_layer4_gpu4</title>
<path fill="orange" stroke="black" d="M5686.29,-8246.44C5686.29,-8246.44 5199.19,-8246.44 5199.19,-8246.44 5193.19,-8246.44 5182.52,-8242.67 5177.85,-8238.91 5177.85,-8238.91 5065.06,-8147.97 5065.06,-8147.97 5060.38,-8144.21 5061.71,-8140.44 5067.71,-8140.44 5067.71,-8140.44 5554.81,-8140.44 5554.81,-8140.44 5560.81,-8140.44 5571.48,-8144.21 5576.15,-8147.97 5576.15,-8147.97 5688.94,-8238.91 5688.94,-8238.91 5693.62,-8242.67 5692.29,-8246.44 5686.29,-8246.44"/>
<text text-anchor="middle" x="5377" y="-8204.74" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 4 GPU 4</text>
<text text-anchor="middle" x="5377" y="-8189.74" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="5377" y="-8174.74" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer4_gpu4_expert4&#45;&gt;aggregate_layer4_gpu4 -->
<g id="edge469" class="edge">
<title>expert_layer4_gpu4_expert4&#45;&gt;aggregate_layer4_gpu4</title>
<path fill="none" stroke="black" d="M5488.19,-8282.38C5476.62,-8273.22 5463.69,-8263 5450.87,-8252.86"/>
<polygon fill="black" stroke="black" points="5452.93,-8250.02 5442.91,-8246.57 5448.59,-8255.52 5452.93,-8250.02"/>
</g>
<!-- expert_layer4_gpu5_expert5 -->
<g id="node363" class="node">
<title>expert_layer4_gpu5_expert5</title>
<path fill="lightcoral" stroke="black" d="M6892.5,-8350.44C6892.5,-8350.44 6423.5,-8350.44 6423.5,-8350.44 6417.5,-8350.44 6411.5,-8344.44 6411.5,-8338.44 6411.5,-8338.44 6411.5,-8294.44 6411.5,-8294.44 6411.5,-8288.44 6417.5,-8282.44 6423.5,-8282.44 6423.5,-8282.44 6892.5,-8282.44 6892.5,-8282.44 6898.5,-8282.44 6904.5,-8288.44 6904.5,-8294.44 6904.5,-8294.44 6904.5,-8338.44 6904.5,-8338.44 6904.5,-8344.44 6898.5,-8350.44 6892.5,-8350.44"/>
<text text-anchor="middle" x="6658" y="-8335.24" font-family="Times,serif" font-size="14.00">Expert 5 Layer 4 GPU 5</text>
<text text-anchor="middle" x="6658" y="-8320.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6658" y="-8305.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6658" y="-8290.24" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer4_gpu5 -->
<g id="node385" class="node">
<title>aggregate_layer4_gpu5</title>
<path fill="orange" stroke="black" d="M6725.29,-8246.44C6725.29,-8246.44 6238.19,-8246.44 6238.19,-8246.44 6232.19,-8246.44 6221.52,-8242.67 6216.85,-8238.91 6216.85,-8238.91 6104.06,-8147.97 6104.06,-8147.97 6099.38,-8144.21 6100.71,-8140.44 6106.71,-8140.44 6106.71,-8140.44 6593.81,-8140.44 6593.81,-8140.44 6599.81,-8140.44 6610.48,-8144.21 6615.15,-8147.97 6615.15,-8147.97 6727.94,-8238.91 6727.94,-8238.91 6732.62,-8242.67 6731.29,-8246.44 6725.29,-8246.44"/>
<text text-anchor="middle" x="6416" y="-8204.74" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 4 GPU 5</text>
<text text-anchor="middle" x="6416" y="-8189.74" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="6416" y="-8174.74" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer4_gpu5_expert5&#45;&gt;aggregate_layer4_gpu5 -->
<g id="edge470" class="edge">
<title>expert_layer4_gpu5_expert5&#45;&gt;aggregate_layer4_gpu5</title>
<path fill="none" stroke="black" d="M6591.87,-8282.38C6572.53,-8272.7 6550.8,-8261.84 6529.4,-8251.14"/>
<polygon fill="black" stroke="black" points="6530.76,-8247.91 6520.25,-8246.57 6527.63,-8254.17 6530.76,-8247.91"/>
</g>
<!-- expert_layer4_gpu6_expert6 -->
<g id="node364" class="node">
<title>expert_layer4_gpu6_expert6</title>
<path fill="lightcoral" stroke="black" d="M7712.5,-8350.44C7712.5,-8350.44 7243.5,-8350.44 7243.5,-8350.44 7237.5,-8350.44 7231.5,-8344.44 7231.5,-8338.44 7231.5,-8338.44 7231.5,-8294.44 7231.5,-8294.44 7231.5,-8288.44 7237.5,-8282.44 7243.5,-8282.44 7243.5,-8282.44 7712.5,-8282.44 7712.5,-8282.44 7718.5,-8282.44 7724.5,-8288.44 7724.5,-8294.44 7724.5,-8294.44 7724.5,-8338.44 7724.5,-8338.44 7724.5,-8344.44 7718.5,-8350.44 7712.5,-8350.44"/>
<text text-anchor="middle" x="7478" y="-8335.24" font-family="Times,serif" font-size="14.00">Expert 6 Layer 4 GPU 6</text>
<text text-anchor="middle" x="7478" y="-8320.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7478" y="-8305.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7478" y="-8290.24" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer4_gpu6 -->
<g id="node387" class="node">
<title>aggregate_layer4_gpu6</title>
<path fill="orange" stroke="black" d="M7575.29,-8246.44C7575.29,-8246.44 7088.19,-8246.44 7088.19,-8246.44 7082.19,-8246.44 7071.52,-8242.67 7066.85,-8238.91 7066.85,-8238.91 6954.06,-8147.97 6954.06,-8147.97 6949.38,-8144.21 6950.71,-8140.44 6956.71,-8140.44 6956.71,-8140.44 7443.81,-8140.44 7443.81,-8140.44 7449.81,-8140.44 7460.48,-8144.21 7465.15,-8147.97 7465.15,-8147.97 7577.94,-8238.91 7577.94,-8238.91 7582.62,-8242.67 7581.29,-8246.44 7575.29,-8246.44"/>
<text text-anchor="middle" x="7266" y="-8204.74" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 4 GPU 6</text>
<text text-anchor="middle" x="7266" y="-8189.74" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="7266" y="-8174.74" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer4_gpu6_expert6&#45;&gt;aggregate_layer4_gpu6 -->
<g id="edge471" class="edge">
<title>expert_layer4_gpu6_expert6&#45;&gt;aggregate_layer4_gpu6</title>
<path fill="none" stroke="black" d="M7420.07,-8282.38C7403.35,-8272.83 7384.6,-8262.13 7366.1,-8251.57"/>
<polygon fill="black" stroke="black" points="7367.75,-8248.48 7357.33,-8246.57 7364.28,-8254.56 7367.75,-8248.48"/>
</g>
<!-- expert_layer4_gpu7_expert7 -->
<g id="node365" class="node">
<title>expert_layer4_gpu7_expert7</title>
<path fill="lightcoral" stroke="black" d="M8377.5,-8350.44C8377.5,-8350.44 7908.5,-8350.44 7908.5,-8350.44 7902.5,-8350.44 7896.5,-8344.44 7896.5,-8338.44 7896.5,-8338.44 7896.5,-8294.44 7896.5,-8294.44 7896.5,-8288.44 7902.5,-8282.44 7908.5,-8282.44 7908.5,-8282.44 8377.5,-8282.44 8377.5,-8282.44 8383.5,-8282.44 8389.5,-8288.44 8389.5,-8294.44 8389.5,-8294.44 8389.5,-8338.44 8389.5,-8338.44 8389.5,-8344.44 8383.5,-8350.44 8377.5,-8350.44"/>
<text text-anchor="middle" x="8143" y="-8335.24" font-family="Times,serif" font-size="14.00">Expert 7 Layer 4 GPU 7</text>
<text text-anchor="middle" x="8143" y="-8320.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8143" y="-8305.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8143" y="-8290.24" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer4_gpu7 -->
<g id="node389" class="node">
<title>aggregate_layer4_gpu7</title>
<path fill="orange" stroke="black" d="M8396.29,-8246.44C8396.29,-8246.44 7909.19,-8246.44 7909.19,-8246.44 7903.19,-8246.44 7892.52,-8242.67 7887.85,-8238.91 7887.85,-8238.91 7775.06,-8147.97 7775.06,-8147.97 7770.38,-8144.21 7771.71,-8140.44 7777.71,-8140.44 7777.71,-8140.44 8264.81,-8140.44 8264.81,-8140.44 8270.81,-8140.44 8281.48,-8144.21 8286.15,-8147.97 8286.15,-8147.97 8398.94,-8238.91 8398.94,-8238.91 8403.62,-8242.67 8402.29,-8246.44 8396.29,-8246.44"/>
<text text-anchor="middle" x="8087" y="-8204.74" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 4 GPU 7</text>
<text text-anchor="middle" x="8087" y="-8189.74" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="8087" y="-8174.74" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer4_gpu7_expert7&#45;&gt;aggregate_layer4_gpu7 -->
<g id="edge472" class="edge">
<title>expert_layer4_gpu7_expert7&#45;&gt;aggregate_layer4_gpu7</title>
<path fill="none" stroke="black" d="M8127.7,-8282.38C8123.86,-8274.08 8119.62,-8264.92 8115.37,-8255.73"/>
<polygon fill="black" stroke="black" points="8118.5,-8254.17 8111.12,-8246.57 8112.15,-8257.11 8118.5,-8254.17"/>
</g>
<!-- expert_layer4_gpu8_expert8 -->
<g id="node366" class="node">
<title>expert_layer4_gpu8_expert8</title>
<path fill="lightcoral" stroke="black" d="M9000.5,-8350.44C9000.5,-8350.44 8531.5,-8350.44 8531.5,-8350.44 8525.5,-8350.44 8519.5,-8344.44 8519.5,-8338.44 8519.5,-8338.44 8519.5,-8294.44 8519.5,-8294.44 8519.5,-8288.44 8525.5,-8282.44 8531.5,-8282.44 8531.5,-8282.44 9000.5,-8282.44 9000.5,-8282.44 9006.5,-8282.44 9012.5,-8288.44 9012.5,-8294.44 9012.5,-8294.44 9012.5,-8338.44 9012.5,-8338.44 9012.5,-8344.44 9006.5,-8350.44 9000.5,-8350.44"/>
<text text-anchor="middle" x="8766" y="-8335.24" font-family="Times,serif" font-size="14.00">Expert 8 Layer 4 GPU 8</text>
<text text-anchor="middle" x="8766" y="-8320.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8766" y="-8305.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8766" y="-8290.24" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer4_gpu8 -->
<g id="node391" class="node">
<title>aggregate_layer4_gpu8</title>
<path fill="orange" stroke="black" d="M9132.29,-8246.44C9132.29,-8246.44 8645.19,-8246.44 8645.19,-8246.44 8639.19,-8246.44 8628.52,-8242.67 8623.85,-8238.91 8623.85,-8238.91 8511.06,-8147.97 8511.06,-8147.97 8506.38,-8144.21 8507.71,-8140.44 8513.71,-8140.44 8513.71,-8140.44 9000.81,-8140.44 9000.81,-8140.44 9006.81,-8140.44 9017.48,-8144.21 9022.15,-8147.97 9022.15,-8147.97 9134.94,-8238.91 9134.94,-8238.91 9139.62,-8242.67 9138.29,-8246.44 9132.29,-8246.44"/>
<text text-anchor="middle" x="8823" y="-8204.74" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 4 GPU 8</text>
<text text-anchor="middle" x="8823" y="-8189.74" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="8823" y="-8174.74" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer4_gpu8_expert8&#45;&gt;aggregate_layer4_gpu8 -->
<g id="edge473" class="edge">
<title>expert_layer4_gpu8_expert8&#45;&gt;aggregate_layer4_gpu8</title>
<path fill="none" stroke="black" d="M8781.58,-8282.38C8785.48,-8274.08 8789.8,-8264.92 8794.13,-8255.73"/>
<polygon fill="black" stroke="black" points="8797.35,-8257.1 8798.44,-8246.57 8791.02,-8254.12 8797.35,-8257.1"/>
</g>
<!-- expert_layer4_gpu9_expert9 -->
<g id="node367" class="node">
<title>expert_layer4_gpu9_expert9</title>
<path fill="lightcoral" stroke="black" d="M9661.5,-8350.44C9661.5,-8350.44 9192.5,-8350.44 9192.5,-8350.44 9186.5,-8350.44 9180.5,-8344.44 9180.5,-8338.44 9180.5,-8338.44 9180.5,-8294.44 9180.5,-8294.44 9180.5,-8288.44 9186.5,-8282.44 9192.5,-8282.44 9192.5,-8282.44 9661.5,-8282.44 9661.5,-8282.44 9667.5,-8282.44 9673.5,-8288.44 9673.5,-8294.44 9673.5,-8294.44 9673.5,-8338.44 9673.5,-8338.44 9673.5,-8344.44 9667.5,-8350.44 9661.5,-8350.44"/>
<text text-anchor="middle" x="9427" y="-8335.24" font-family="Times,serif" font-size="14.00">Expert 9 Layer 4 GPU 9</text>
<text text-anchor="middle" x="9427" y="-8320.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9427" y="-8305.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9427" y="-8290.24" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer4_gpu9 -->
<g id="node393" class="node">
<title>aggregate_layer4_gpu9</title>
<path fill="orange" stroke="black" d="M9831.29,-8246.44C9831.29,-8246.44 9344.19,-8246.44 9344.19,-8246.44 9338.19,-8246.44 9327.52,-8242.67 9322.85,-8238.91 9322.85,-8238.91 9210.06,-8147.97 9210.06,-8147.97 9205.38,-8144.21 9206.71,-8140.44 9212.71,-8140.44 9212.71,-8140.44 9699.81,-8140.44 9699.81,-8140.44 9705.81,-8140.44 9716.48,-8144.21 9721.15,-8147.97 9721.15,-8147.97 9833.94,-8238.91 9833.94,-8238.91 9838.62,-8242.67 9837.29,-8246.44 9831.29,-8246.44"/>
<text text-anchor="middle" x="9522" y="-8204.74" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 4 GPU 9</text>
<text text-anchor="middle" x="9522" y="-8189.74" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="9522" y="-8174.74" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer4_gpu9_expert9&#45;&gt;aggregate_layer4_gpu9 -->
<g id="edge474" class="edge">
<title>expert_layer4_gpu9_expert9&#45;&gt;aggregate_layer4_gpu9</title>
<path fill="none" stroke="black" d="M9452.96,-8282.38C9459.74,-8273.74 9467.26,-8264.16 9474.78,-8254.58"/>
<polygon fill="black" stroke="black" points="9477.65,-8256.59 9481.07,-8246.57 9472.15,-8252.27 9477.65,-8256.59"/>
</g>
<!-- expert_layer4_gpu10_expert10 -->
<g id="node368" class="node">
<title>expert_layer4_gpu10_expert10</title>
<path fill="lightcoral" stroke="black" d="M10505.5,-8350.44C10505.5,-8350.44 10036.5,-8350.44 10036.5,-8350.44 10030.5,-8350.44 10024.5,-8344.44 10024.5,-8338.44 10024.5,-8338.44 10024.5,-8294.44 10024.5,-8294.44 10024.5,-8288.44 10030.5,-8282.44 10036.5,-8282.44 10036.5,-8282.44 10505.5,-8282.44 10505.5,-8282.44 10511.5,-8282.44 10517.5,-8288.44 10517.5,-8294.44 10517.5,-8294.44 10517.5,-8338.44 10517.5,-8338.44 10517.5,-8344.44 10511.5,-8350.44 10505.5,-8350.44"/>
<text text-anchor="middle" x="10271" y="-8335.24" font-family="Times,serif" font-size="14.00">Expert 10 Layer 4 GPU 10</text>
<text text-anchor="middle" x="10271" y="-8320.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10271" y="-8305.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10271" y="-8290.24" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer4_gpu10 -->
<g id="node395" class="node">
<title>aggregate_layer4_gpu10</title>
<path fill="orange" stroke="black" d="M10857.29,-8246.44C10857.29,-8246.44 10370.19,-8246.44 10370.19,-8246.44 10364.19,-8246.44 10353.52,-8242.67 10348.85,-8238.91 10348.85,-8238.91 10236.06,-8147.97 10236.06,-8147.97 10231.38,-8144.21 10232.71,-8140.44 10238.71,-8140.44 10238.71,-8140.44 10725.81,-8140.44 10725.81,-8140.44 10731.81,-8140.44 10742.48,-8144.21 10747.15,-8147.97 10747.15,-8147.97 10859.94,-8238.91 10859.94,-8238.91 10864.62,-8242.67 10863.29,-8246.44 10857.29,-8246.44"/>
<text text-anchor="middle" x="10548" y="-8204.74" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 4 GPU 10</text>
<text text-anchor="middle" x="10548" y="-8189.74" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="10548" y="-8174.74" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer4_gpu10_expert10&#45;&gt;aggregate_layer4_gpu10 -->
<g id="edge475" class="edge">
<title>expert_layer4_gpu10_expert10&#45;&gt;aggregate_layer4_gpu10</title>
<path fill="none" stroke="black" d="M10346.69,-8282.38C10369.3,-8272.5 10394.75,-8261.38 10419.75,-8250.46"/>
<polygon fill="black" stroke="black" points="10421.17,-8253.66 10428.93,-8246.45 10418.37,-8247.25 10421.17,-8253.66"/>
</g>
<!-- expert_layer4_gpu11_expert11 -->
<g id="node369" class="node">
<title>expert_layer4_gpu11_expert11</title>
<path fill="lightcoral" stroke="black" d="M11403.5,-8350.44C11403.5,-8350.44 10934.5,-8350.44 10934.5,-8350.44 10928.5,-8350.44 10922.5,-8344.44 10922.5,-8338.44 10922.5,-8338.44 10922.5,-8294.44 10922.5,-8294.44 10922.5,-8288.44 10928.5,-8282.44 10934.5,-8282.44 10934.5,-8282.44 11403.5,-8282.44 11403.5,-8282.44 11409.5,-8282.44 11415.5,-8288.44 11415.5,-8294.44 11415.5,-8294.44 11415.5,-8338.44 11415.5,-8338.44 11415.5,-8344.44 11409.5,-8350.44 11403.5,-8350.44"/>
<text text-anchor="middle" x="11169" y="-8335.24" font-family="Times,serif" font-size="14.00">Expert 11 Layer 4 GPU 11</text>
<text text-anchor="middle" x="11169" y="-8320.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11169" y="-8305.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11169" y="-8290.24" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer4_gpu11 -->
<g id="node397" class="node">
<title>aggregate_layer4_gpu11</title>
<path fill="orange" stroke="black" d="M11809.29,-8246.44C11809.29,-8246.44 11322.19,-8246.44 11322.19,-8246.44 11316.19,-8246.44 11305.52,-8242.67 11300.85,-8238.91 11300.85,-8238.91 11188.06,-8147.97 11188.06,-8147.97 11183.38,-8144.21 11184.71,-8140.44 11190.71,-8140.44 11190.71,-8140.44 11677.81,-8140.44 11677.81,-8140.44 11683.81,-8140.44 11694.48,-8144.21 11699.15,-8147.97 11699.15,-8147.97 11811.94,-8238.91 11811.94,-8238.91 11816.62,-8242.67 11815.29,-8246.44 11809.29,-8246.44"/>
<text text-anchor="middle" x="11500" y="-8204.74" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 4 GPU 11</text>
<text text-anchor="middle" x="11500" y="-8189.74" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="11500" y="-8174.74" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer4_gpu11_expert11&#45;&gt;aggregate_layer4_gpu11 -->
<g id="edge476" class="edge">
<title>expert_layer4_gpu11_expert11&#45;&gt;aggregate_layer4_gpu11</title>
<path fill="none" stroke="black" d="M11259.45,-8282.38C11286.94,-8272.33 11317.94,-8260.99 11348.32,-8249.89"/>
<polygon fill="black" stroke="black" points="11349.53,-8253.17 11357.72,-8246.45 11347.13,-8246.6 11349.53,-8253.17"/>
</g>
<!-- expert_layer4_gpu12_expert12 -->
<g id="node370" class="node">
<title>expert_layer4_gpu12_expert12</title>
<path fill="lightcoral" stroke="black" d="M12255.5,-8350.44C12255.5,-8350.44 11786.5,-8350.44 11786.5,-8350.44 11780.5,-8350.44 11774.5,-8344.44 11774.5,-8338.44 11774.5,-8338.44 11774.5,-8294.44 11774.5,-8294.44 11774.5,-8288.44 11780.5,-8282.44 11786.5,-8282.44 11786.5,-8282.44 12255.5,-8282.44 12255.5,-8282.44 12261.5,-8282.44 12267.5,-8288.44 12267.5,-8294.44 12267.5,-8294.44 12267.5,-8338.44 12267.5,-8338.44 12267.5,-8344.44 12261.5,-8350.44 12255.5,-8350.44"/>
<text text-anchor="middle" x="12021" y="-8335.24" font-family="Times,serif" font-size="14.00">Expert 12 Layer 4 GPU 12</text>
<text text-anchor="middle" x="12021" y="-8320.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12021" y="-8305.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12021" y="-8290.24" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer4_gpu12 -->
<g id="node399" class="node">
<title>aggregate_layer4_gpu12</title>
<path fill="orange" stroke="black" d="M12615.29,-8246.44C12615.29,-8246.44 12128.19,-8246.44 12128.19,-8246.44 12122.19,-8246.44 12111.52,-8242.67 12106.85,-8238.91 12106.85,-8238.91 11994.06,-8147.97 11994.06,-8147.97 11989.38,-8144.21 11990.71,-8140.44 11996.71,-8140.44 11996.71,-8140.44 12483.81,-8140.44 12483.81,-8140.44 12489.81,-8140.44 12500.48,-8144.21 12505.15,-8147.97 12505.15,-8147.97 12617.94,-8238.91 12617.94,-8238.91 12622.62,-8242.67 12621.29,-8246.44 12615.29,-8246.44"/>
<text text-anchor="middle" x="12306" y="-8204.74" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 4 GPU 12</text>
<text text-anchor="middle" x="12306" y="-8189.74" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="12306" y="-8174.74" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer4_gpu12_expert12&#45;&gt;aggregate_layer4_gpu12 -->
<g id="edge477" class="edge">
<title>expert_layer4_gpu12_expert12&#45;&gt;aggregate_layer4_gpu12</title>
<path fill="none" stroke="black" d="M12098.88,-8282.38C12122.14,-8272.5 12148.32,-8261.38 12174.04,-8250.46"/>
<polygon fill="black" stroke="black" points="12175.66,-8253.58 12183.49,-8246.45 12172.92,-8247.14 12175.66,-8253.58"/>
</g>
<!-- expert_layer4_gpu13_expert13 -->
<g id="node371" class="node">
<title>expert_layer4_gpu13_expert13</title>
<path fill="lightcoral" stroke="black" d="M13048.5,-8350.44C13048.5,-8350.44 12579.5,-8350.44 12579.5,-8350.44 12573.5,-8350.44 12567.5,-8344.44 12567.5,-8338.44 12567.5,-8338.44 12567.5,-8294.44 12567.5,-8294.44 12567.5,-8288.44 12573.5,-8282.44 12579.5,-8282.44 12579.5,-8282.44 13048.5,-8282.44 13048.5,-8282.44 13054.5,-8282.44 13060.5,-8288.44 13060.5,-8294.44 13060.5,-8294.44 13060.5,-8338.44 13060.5,-8338.44 13060.5,-8344.44 13054.5,-8350.44 13048.5,-8350.44"/>
<text text-anchor="middle" x="12814" y="-8335.24" font-family="Times,serif" font-size="14.00">Expert 13 Layer 4 GPU 13</text>
<text text-anchor="middle" x="12814" y="-8320.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12814" y="-8305.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12814" y="-8290.24" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer4_gpu13 -->
<g id="node401" class="node">
<title>aggregate_layer4_gpu13</title>
<path fill="orange" stroke="black" d="M13349.29,-8246.44C13349.29,-8246.44 12862.19,-8246.44 12862.19,-8246.44 12856.19,-8246.44 12845.52,-8242.67 12840.85,-8238.91 12840.85,-8238.91 12728.06,-8147.97 12728.06,-8147.97 12723.38,-8144.21 12724.71,-8140.44 12730.71,-8140.44 12730.71,-8140.44 13217.81,-8140.44 13217.81,-8140.44 13223.81,-8140.44 13234.48,-8144.21 13239.15,-8147.97 13239.15,-8147.97 13351.94,-8238.91 13351.94,-8238.91 13356.62,-8242.67 13355.29,-8246.44 13349.29,-8246.44"/>
<text text-anchor="middle" x="13040" y="-8204.74" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 4 GPU 13</text>
<text text-anchor="middle" x="13040" y="-8189.74" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="13040" y="-8174.74" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer4_gpu13_expert13&#45;&gt;aggregate_layer4_gpu13 -->
<g id="edge478" class="edge">
<title>expert_layer4_gpu13_expert13&#45;&gt;aggregate_layer4_gpu13</title>
<path fill="none" stroke="black" d="M12875.76,-8282.38C12893.66,-8272.79 12913.75,-8262.04 12933.56,-8251.43"/>
<polygon fill="black" stroke="black" points="12935.48,-8254.37 12942.64,-8246.57 12932.17,-8248.2 12935.48,-8254.37"/>
</g>
<!-- expert_layer4_gpu14_expert14 -->
<g id="node372" class="node">
<title>expert_layer4_gpu14_expert14</title>
<path fill="lightcoral" stroke="black" d="M14042.5,-8350.44C14042.5,-8350.44 13573.5,-8350.44 13573.5,-8350.44 13567.5,-8350.44 13561.5,-8344.44 13561.5,-8338.44 13561.5,-8338.44 13561.5,-8294.44 13561.5,-8294.44 13561.5,-8288.44 13567.5,-8282.44 13573.5,-8282.44 13573.5,-8282.44 14042.5,-8282.44 14042.5,-8282.44 14048.5,-8282.44 14054.5,-8288.44 14054.5,-8294.44 14054.5,-8294.44 14054.5,-8338.44 14054.5,-8338.44 14054.5,-8344.44 14048.5,-8350.44 14042.5,-8350.44"/>
<text text-anchor="middle" x="13808" y="-8335.24" font-family="Times,serif" font-size="14.00">Expert 14 Layer 4 GPU 14</text>
<text text-anchor="middle" x="13808" y="-8320.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="13808" y="-8305.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="13808" y="-8290.24" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer4_gpu14 -->
<g id="node403" class="node">
<title>aggregate_layer4_gpu14</title>
<path fill="orange" stroke="black" d="M14544.29,-8246.44C14544.29,-8246.44 14057.19,-8246.44 14057.19,-8246.44 14051.19,-8246.44 14040.52,-8242.67 14035.85,-8238.91 14035.85,-8238.91 13923.06,-8147.97 13923.06,-8147.97 13918.38,-8144.21 13919.71,-8140.44 13925.71,-8140.44 13925.71,-8140.44 14412.81,-8140.44 14412.81,-8140.44 14418.81,-8140.44 14429.48,-8144.21 14434.15,-8147.97 14434.15,-8147.97 14546.94,-8238.91 14546.94,-8238.91 14551.62,-8242.67 14550.29,-8246.44 14544.29,-8246.44"/>
<text text-anchor="middle" x="14235" y="-8204.74" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 4 GPU 14</text>
<text text-anchor="middle" x="14235" y="-8189.74" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="14235" y="-8174.74" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer4_gpu14_expert14&#45;&gt;aggregate_layer4_gpu14 -->
<g id="edge479" class="edge">
<title>expert_layer4_gpu14_expert14&#45;&gt;aggregate_layer4_gpu14</title>
<path fill="none" stroke="black" d="M13924.68,-8282.38C13960.84,-8272.13 14001.69,-8260.55 14041.6,-8249.24"/>
<polygon fill="black" stroke="black" points="14042.79,-8252.55 14051.45,-8246.45 14040.88,-8245.81 14042.79,-8252.55"/>
</g>
<!-- expert_layer4_gpu15_expert15 -->
<g id="node373" class="node">
<title>expert_layer4_gpu15_expert15</title>
<path fill="lightcoral" stroke="black" d="M15078.5,-8350.44C15078.5,-8350.44 14609.5,-8350.44 14609.5,-8350.44 14603.5,-8350.44 14597.5,-8344.44 14597.5,-8338.44 14597.5,-8338.44 14597.5,-8294.44 14597.5,-8294.44 14597.5,-8288.44 14603.5,-8282.44 14609.5,-8282.44 14609.5,-8282.44 15078.5,-8282.44 15078.5,-8282.44 15084.5,-8282.44 15090.5,-8288.44 15090.5,-8294.44 15090.5,-8294.44 15090.5,-8338.44 15090.5,-8338.44 15090.5,-8344.44 15084.5,-8350.44 15078.5,-8350.44"/>
<text text-anchor="middle" x="14844" y="-8335.24" font-family="Times,serif" font-size="14.00">Expert 15 Layer 4 GPU 15</text>
<text text-anchor="middle" x="14844" y="-8320.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14844" y="-8305.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14844" y="-8290.24" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer4_gpu15 -->
<g id="node405" class="node">
<title>aggregate_layer4_gpu15</title>
<path fill="orange" stroke="black" d="M15623.29,-8246.44C15623.29,-8246.44 15136.19,-8246.44 15136.19,-8246.44 15130.19,-8246.44 15119.52,-8242.67 15114.85,-8238.91 15114.85,-8238.91 15002.06,-8147.97 15002.06,-8147.97 14997.38,-8144.21 14998.71,-8140.44 15004.71,-8140.44 15004.71,-8140.44 15491.81,-8140.44 15491.81,-8140.44 15497.81,-8140.44 15508.48,-8144.21 15513.15,-8147.97 15513.15,-8147.97 15625.94,-8238.91 15625.94,-8238.91 15630.62,-8242.67 15629.29,-8246.44 15623.29,-8246.44"/>
<text text-anchor="middle" x="15314" y="-8204.74" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 4 GPU 15</text>
<text text-anchor="middle" x="15314" y="-8189.74" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="15314" y="-8174.74" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer4_gpu15_expert15&#45;&gt;aggregate_layer4_gpu15 -->
<g id="edge480" class="edge">
<title>expert_layer4_gpu15_expert15&#45;&gt;aggregate_layer4_gpu15</title>
<path fill="none" stroke="black" d="M14972.43,-8282.38C15015.28,-8271.35 15064.12,-8258.77 15111.2,-8246.65"/>
<polygon fill="black" stroke="black" points="15112.09,-8250.03 15120.9,-8244.15 15110.35,-8243.26 15112.09,-8250.03"/>
</g>
<!-- comm_layer4 -->
<g id="node406" class="node">
<title>comm_layer4</title>
<ellipse fill="lightpink" stroke="black" cx="8454" cy="-8423.92" rx="243.49" ry="37.45"/>
<text text-anchor="middle" x="8454" y="-8435.22" font-family="Times,serif" font-size="14.00">Cross&#45;GPU Communication Layer 4</text>
<text text-anchor="middle" x="8454" y="-8420.22" font-family="Times,serif" font-size="14.00">Input: Tokens from routing decisions</text>
<text text-anchor="middle" x="8454" y="-8405.22" font-family="Times,serif" font-size="14.00">Output: Tokens delivered to destination GPUs</text>
</g>
<!-- route_layer4_gpu0&#45;&gt;comm_layer4 -->
<g id="edge433" class="edge">
<title>route_layer4_gpu0&#45;&gt;comm_layer4</title>
<path fill="none" stroke="black" d="M1668.34,-8527.72C1801.07,-8516.55 1969.59,-8503.92 2120,-8497.39 3334.67,-8444.66 7176.32,-8428.95 8200.83,-8425.65"/>
<polygon fill="black" stroke="black" points="8200.92,-8429.15 8210.91,-8425.62 8200.89,-8422.15 8200.92,-8429.15"/>
</g>
<!-- mha_layer5_gpu0 -->
<g id="node407" class="node">
<title>mha_layer5_gpu0</title>
<path fill="lightblue" stroke="black" d="M1860,-8104.44C1860,-8104.44 1412,-8104.44 1412,-8104.44 1406,-8104.44 1400,-8098.44 1400,-8092.44 1400,-8092.44 1400,-8063.44 1400,-8063.44 1400,-8057.44 1406,-8051.44 1412,-8051.44 1412,-8051.44 1860,-8051.44 1860,-8051.44 1866,-8051.44 1872,-8057.44 1872,-8063.44 1872,-8063.44 1872,-8092.44 1872,-8092.44 1872,-8098.44 1866,-8104.44 1860,-8104.44"/>
<text text-anchor="middle" x="1636" y="-8089.24" font-family="Times,serif" font-size="14.00">MHA Layer 5 GPU 0</text>
<text text-anchor="middle" x="1636" y="-8074.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1636" y="-8059.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer4_gpu0&#45;&gt;mha_layer5_gpu0 -->
<g id="edge481" class="edge">
<title>aggregate_layer4_gpu0&#45;&gt;mha_layer5_gpu0</title>
<path fill="none" stroke="black" d="M1717.69,-8140.34C1704.21,-8130.21 1690.46,-8119.88 1678.19,-8110.65"/>
<polygon fill="black" stroke="black" points="1680.04,-8107.66 1669.94,-8104.45 1675.83,-8113.26 1680.04,-8107.66"/>
</g>
<!-- route_layer4_gpu1&#45;&gt;comm_layer4 -->
<g id="edge434" class="edge">
<title>route_layer4_gpu1&#45;&gt;comm_layer4</title>
<path fill="none" stroke="black" d="M2703.25,-8529.18C2848.3,-8517.77 3037.17,-8504.43 3205,-8497.39 4195.32,-8455.84 7292.26,-8432.58 8200.96,-8426.52"/>
<polygon fill="black" stroke="black" points="8201.25,-8430.02 8211.22,-8426.45 8201.2,-8423.02 8201.25,-8430.02"/>
</g>
<!-- mha_layer5_gpu1 -->
<g id="node408" class="node">
<title>mha_layer5_gpu1</title>
<path fill="lightblue" stroke="black" d="M2667,-8104.44C2667,-8104.44 2219,-8104.44 2219,-8104.44 2213,-8104.44 2207,-8098.44 2207,-8092.44 2207,-8092.44 2207,-8063.44 2207,-8063.44 2207,-8057.44 2213,-8051.44 2219,-8051.44 2219,-8051.44 2667,-8051.44 2667,-8051.44 2673,-8051.44 2679,-8057.44 2679,-8063.44 2679,-8063.44 2679,-8092.44 2679,-8092.44 2679,-8098.44 2673,-8104.44 2667,-8104.44"/>
<text text-anchor="middle" x="2443" y="-8089.24" font-family="Times,serif" font-size="14.00">MHA Layer 5 GPU 1</text>
<text text-anchor="middle" x="2443" y="-8074.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2443" y="-8059.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer4_gpu1&#45;&gt;mha_layer5_gpu1 -->
<g id="edge482" class="edge">
<title>aggregate_layer4_gpu1&#45;&gt;mha_layer5_gpu1</title>
<path fill="none" stroke="black" d="M2530.1,-8140.34C2515.59,-8130.11 2500.79,-8119.68 2487.6,-8110.38"/>
<polygon fill="black" stroke="black" points="2489.38,-8107.35 2479.19,-8104.45 2485.35,-8113.08 2489.38,-8107.35"/>
</g>
<!-- route_layer4_gpu2&#45;&gt;comm_layer4 -->
<g id="edge435" class="edge">
<title>route_layer4_gpu2&#45;&gt;comm_layer4</title>
<path fill="none" stroke="black" d="M3776.66,-8520.53C3856.91,-8511.49 3947.84,-8502.55 4031,-8497.39 4850.75,-8446.56 7388.26,-8430.08 8200.88,-8426.03"/>
<polygon fill="black" stroke="black" points="8200.97,-8429.53 8210.95,-8425.98 8200.94,-8422.53 8200.97,-8429.53"/>
</g>
<!-- mha_layer5_gpu2 -->
<g id="node409" class="node">
<title>mha_layer5_gpu2</title>
<path fill="lightblue" stroke="black" d="M3729,-8104.44C3729,-8104.44 3281,-8104.44 3281,-8104.44 3275,-8104.44 3269,-8098.44 3269,-8092.44 3269,-8092.44 3269,-8063.44 3269,-8063.44 3269,-8057.44 3275,-8051.44 3281,-8051.44 3281,-8051.44 3729,-8051.44 3729,-8051.44 3735,-8051.44 3741,-8057.44 3741,-8063.44 3741,-8063.44 3741,-8092.44 3741,-8092.44 3741,-8098.44 3735,-8104.44 3729,-8104.44"/>
<text text-anchor="middle" x="3505" y="-8089.24" font-family="Times,serif" font-size="14.00">MHA Layer 5 GPU 2</text>
<text text-anchor="middle" x="3505" y="-8074.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3505" y="-8059.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer4_gpu2&#45;&gt;mha_layer5_gpu2 -->
<g id="edge483" class="edge">
<title>aggregate_layer4_gpu2&#45;&gt;mha_layer5_gpu2</title>
<path fill="none" stroke="black" d="M3586.69,-8140.34C3573.21,-8130.21 3559.46,-8119.88 3547.19,-8110.65"/>
<polygon fill="black" stroke="black" points="3549.04,-8107.66 3538.94,-8104.45 3544.83,-8113.26 3549.04,-8107.66"/>
</g>
<!-- route_layer4_gpu3&#45;&gt;comm_layer4 -->
<g id="edge436" class="edge">
<title>route_layer4_gpu3&#45;&gt;comm_layer4</title>
<path fill="none" stroke="black" d="M4609.57,-8525.59C4721.07,-8515.19 4856.29,-8503.9 4978,-8497.39 6183.35,-8432.92 7626.66,-8424.95 8200.63,-8424.55"/>
<polygon fill="black" stroke="black" points="8200.69,-8428.05 8210.69,-8424.54 8200.69,-8421.05 8200.69,-8428.05"/>
</g>
<!-- mha_layer5_gpu3 -->
<g id="node410" class="node">
<title>mha_layer5_gpu3</title>
<path fill="lightblue" stroke="black" d="M4536,-8104.44C4536,-8104.44 4088,-8104.44 4088,-8104.44 4082,-8104.44 4076,-8098.44 4076,-8092.44 4076,-8092.44 4076,-8063.44 4076,-8063.44 4076,-8057.44 4082,-8051.44 4088,-8051.44 4088,-8051.44 4536,-8051.44 4536,-8051.44 4542,-8051.44 4548,-8057.44 4548,-8063.44 4548,-8063.44 4548,-8092.44 4548,-8092.44 4548,-8098.44 4542,-8104.44 4536,-8104.44"/>
<text text-anchor="middle" x="4312" y="-8089.24" font-family="Times,serif" font-size="14.00">MHA Layer 5 GPU 3</text>
<text text-anchor="middle" x="4312" y="-8074.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4312" y="-8059.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer4_gpu3&#45;&gt;mha_layer5_gpu3 -->
<g id="edge484" class="edge">
<title>aggregate_layer4_gpu3&#45;&gt;mha_layer5_gpu3</title>
<path fill="none" stroke="black" d="M4399.1,-8140.34C4384.59,-8130.11 4369.79,-8119.68 4356.6,-8110.38"/>
<polygon fill="black" stroke="black" points="4358.38,-8107.35 4348.19,-8104.45 4354.35,-8113.08 4358.38,-8107.35"/>
</g>
<!-- route_layer4_gpu4&#45;&gt;comm_layer4 -->
<g id="edge437" class="edge">
<title>route_layer4_gpu4&#45;&gt;comm_layer4</title>
<path fill="none" stroke="black" d="M5562.96,-8530.52C5711.86,-8519.44 5906.92,-8505.97 6080,-8497.39 6853.32,-8459.08 7769.41,-8437.98 8202.79,-8429.45"/>
<polygon fill="black" stroke="black" points="8203.01,-8432.95 8212.94,-8429.25 8202.87,-8425.95 8203.01,-8432.95"/>
</g>
<!-- mha_layer5_gpu4 -->
<g id="node411" class="node">
<title>mha_layer5_gpu4</title>
<path fill="lightblue" stroke="black" d="M5429,-8104.44C5429,-8104.44 4981,-8104.44 4981,-8104.44 4975,-8104.44 4969,-8098.44 4969,-8092.44 4969,-8092.44 4969,-8063.44 4969,-8063.44 4969,-8057.44 4975,-8051.44 4981,-8051.44 4981,-8051.44 5429,-8051.44 5429,-8051.44 5435,-8051.44 5441,-8057.44 5441,-8063.44 5441,-8063.44 5441,-8092.44 5441,-8092.44 5441,-8098.44 5435,-8104.44 5429,-8104.44"/>
<text text-anchor="middle" x="5205" y="-8089.24" font-family="Times,serif" font-size="14.00">MHA Layer 5 GPU 4</text>
<text text-anchor="middle" x="5205" y="-8074.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5205" y="-8059.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer4_gpu4&#45;&gt;mha_layer5_gpu4 -->
<g id="edge485" class="edge">
<title>aggregate_layer4_gpu4&#45;&gt;mha_layer5_gpu4</title>
<path fill="none" stroke="black" d="M5298.05,-8140.34C5282.4,-8130.01 5266.43,-8119.48 5252.25,-8110.12"/>
<polygon fill="black" stroke="black" points="5253.94,-8107.04 5243.66,-8104.45 5250.08,-8112.88 5253.94,-8107.04"/>
</g>
<!-- route_layer4_gpu5&#45;&gt;comm_layer4 -->
<g id="edge438" class="edge">
<title>route_layer4_gpu5&#45;&gt;comm_layer4</title>
<path fill="none" stroke="black" d="M6657.73,-8524.98C6755.67,-8515.37 6870.78,-8504.86 6975,-8497.39 7408.34,-8466.34 7914.08,-8444.7 8207.78,-8433.58"/>
<polygon fill="black" stroke="black" points="8208.28,-8437.07 8218.14,-8433.19 8208.02,-8430.07 8208.28,-8437.07"/>
</g>
<!-- mha_layer5_gpu5 -->
<g id="node412" class="node">
<title>mha_layer5_gpu5</title>
<path fill="lightblue" stroke="black" d="M6430,-8104.44C6430,-8104.44 5982,-8104.44 5982,-8104.44 5976,-8104.44 5970,-8098.44 5970,-8092.44 5970,-8092.44 5970,-8063.44 5970,-8063.44 5970,-8057.44 5976,-8051.44 5982,-8051.44 5982,-8051.44 6430,-8051.44 6430,-8051.44 6436,-8051.44 6442,-8057.44 6442,-8063.44 6442,-8063.44 6442,-8092.44 6442,-8092.44 6442,-8098.44 6436,-8104.44 6430,-8104.44"/>
<text text-anchor="middle" x="6206" y="-8089.24" font-family="Times,serif" font-size="14.00">MHA Layer 5 GPU 5</text>
<text text-anchor="middle" x="6206" y="-8074.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6206" y="-8059.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer4_gpu5&#45;&gt;mha_layer5_gpu5 -->
<g id="edge486" class="edge">
<title>aggregate_layer4_gpu5&#45;&gt;mha_layer5_gpu5</title>
<path fill="none" stroke="black" d="M6319.6,-8140.34C6299.96,-8129.72 6279.9,-8118.88 6262.22,-8109.33"/>
<polygon fill="black" stroke="black" points="6263.67,-8106.13 6253.21,-8104.45 6260.34,-8112.29 6263.67,-8106.13"/>
</g>
<!-- route_layer4_gpu6&#45;&gt;comm_layer4 -->
<g id="edge439" class="edge">
<title>route_layer4_gpu6&#45;&gt;comm_layer4</title>
<path fill="none" stroke="black" d="M7548.93,-8522.16C7618.64,-8514.04 7695.43,-8505.21 7766,-8497.39 7926.42,-8479.61 8108.01,-8460.53 8244.34,-8446.41"/>
<polygon fill="black" stroke="black" points="8244.9,-8449.87 8254.48,-8445.36 8244.18,-8442.9 8244.9,-8449.87"/>
</g>
<!-- mha_layer5_gpu6 -->
<g id="node413" class="node">
<title>mha_layer5_gpu6</title>
<path fill="lightblue" stroke="black" d="M7339,-8104.44C7339,-8104.44 6891,-8104.44 6891,-8104.44 6885,-8104.44 6879,-8098.44 6879,-8092.44 6879,-8092.44 6879,-8063.44 6879,-8063.44 6879,-8057.44 6885,-8051.44 6891,-8051.44 6891,-8051.44 7339,-8051.44 7339,-8051.44 7345,-8051.44 7351,-8057.44 7351,-8063.44 7351,-8063.44 7351,-8092.44 7351,-8092.44 7351,-8098.44 7345,-8104.44 7339,-8104.44"/>
<text text-anchor="middle" x="7115" y="-8089.24" font-family="Times,serif" font-size="14.00">MHA Layer 5 GPU 6</text>
<text text-anchor="middle" x="7115" y="-8074.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7115" y="-8059.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer4_gpu6&#45;&gt;mha_layer5_gpu6 -->
<g id="edge487" class="edge">
<title>aggregate_layer4_gpu6&#45;&gt;mha_layer5_gpu6</title>
<path fill="none" stroke="black" d="M7196.69,-8140.34C7183.21,-8130.21 7169.46,-8119.88 7157.19,-8110.65"/>
<polygon fill="black" stroke="black" points="7159.04,-8107.66 7148.94,-8104.45 7154.83,-8113.26 7159.04,-8107.66"/>
</g>
<!-- route_layer4_gpu7&#45;&gt;comm_layer4 -->
<g id="edge440" class="edge">
<title>route_layer4_gpu7&#45;&gt;comm_layer4</title>
<path fill="none" stroke="black" d="M8253.89,-8497.33C8286.54,-8485.51 8320.57,-8473.2 8351.12,-8462.14"/>
<polygon fill="black" stroke="black" points="8352.69,-8465.3 8360.91,-8458.6 8350.31,-8458.71 8352.69,-8465.3"/>
</g>
<!-- mha_layer5_gpu7 -->
<g id="node414" class="node">
<title>mha_layer5_gpu7</title>
<path fill="lightblue" stroke="black" d="M8245,-8104.44C8245,-8104.44 7797,-8104.44 7797,-8104.44 7791,-8104.44 7785,-8098.44 7785,-8092.44 7785,-8092.44 7785,-8063.44 7785,-8063.44 7785,-8057.44 7791,-8051.44 7797,-8051.44 7797,-8051.44 8245,-8051.44 8245,-8051.44 8251,-8051.44 8257,-8057.44 8257,-8063.44 8257,-8063.44 8257,-8092.44 8257,-8092.44 8257,-8098.44 8251,-8104.44 8245,-8104.44"/>
<text text-anchor="middle" x="8021" y="-8089.24" font-family="Times,serif" font-size="14.00">MHA Layer 5 GPU 7</text>
<text text-anchor="middle" x="8021" y="-8074.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8021" y="-8059.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer4_gpu7&#45;&gt;mha_layer5_gpu7 -->
<g id="edge488" class="edge">
<title>aggregate_layer4_gpu7&#45;&gt;mha_layer5_gpu7</title>
<path fill="none" stroke="black" d="M8056.7,-8140.34C8051.38,-8131.18 8045.96,-8121.86 8041,-8113.34"/>
<polygon fill="black" stroke="black" points="8043.89,-8111.34 8035.84,-8104.45 8037.84,-8114.86 8043.89,-8111.34"/>
</g>
<!-- route_layer4_gpu8&#45;&gt;comm_layer4 -->
<g id="edge441" class="edge">
<title>route_layer4_gpu8&#45;&gt;comm_layer4</title>
<path fill="none" stroke="black" d="M8734.38,-8497.33C8684.27,-8484.38 8631.83,-8470.84 8586.03,-8459.01"/>
<polygon fill="black" stroke="black" points="8586.62,-8455.55 8576.06,-8456.44 8584.87,-8462.33 8586.62,-8455.55"/>
</g>
<!-- mha_layer5_gpu8 -->
<g id="node415" class="node">
<title>mha_layer5_gpu8</title>
<path fill="lightblue" stroke="black" d="M9180,-8104.44C9180,-8104.44 8732,-8104.44 8732,-8104.44 8726,-8104.44 8720,-8098.44 8720,-8092.44 8720,-8092.44 8720,-8063.44 8720,-8063.44 8720,-8057.44 8726,-8051.44 8732,-8051.44 8732,-8051.44 9180,-8051.44 9180,-8051.44 9186,-8051.44 9192,-8057.44 9192,-8063.44 9192,-8063.44 9192,-8092.44 9192,-8092.44 9192,-8098.44 9186,-8104.44 9180,-8104.44"/>
<text text-anchor="middle" x="8956" y="-8089.24" font-family="Times,serif" font-size="14.00">MHA Layer 5 GPU 8</text>
<text text-anchor="middle" x="8956" y="-8074.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8956" y="-8059.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer4_gpu8&#45;&gt;mha_layer5_gpu8 -->
<g id="edge489" class="edge">
<title>aggregate_layer4_gpu8&#45;&gt;mha_layer5_gpu8</title>
<path fill="none" stroke="black" d="M8884.05,-8140.34C8895.7,-8130.4 8907.57,-8120.27 8918.22,-8111.18"/>
<polygon fill="black" stroke="black" points="8920.77,-8113.61 8926.1,-8104.45 8916.22,-8108.28 8920.77,-8113.61"/>
</g>
<!-- route_layer4_gpu9&#45;&gt;comm_layer4 -->
<g id="edge442" class="edge">
<title>route_layer4_gpu9&#45;&gt;comm_layer4</title>
<path fill="none" stroke="black" d="M9525.73,-8520.22C9445.78,-8512.68 9359.66,-8504.65 9280,-8497.39 9074.63,-8478.69 8840.46,-8458.23 8674.03,-8443.83"/>
<polygon fill="black" stroke="black" points="8673.93,-8440.31 8663.67,-8442.93 8673.33,-8447.28 8673.93,-8440.31"/>
</g>
<!-- mha_layer5_gpu9 -->
<g id="node416" class="node">
<title>mha_layer5_gpu9</title>
<path fill="lightblue" stroke="black" d="M9755,-8104.44C9755,-8104.44 9307,-8104.44 9307,-8104.44 9301,-8104.44 9295,-8098.44 9295,-8092.44 9295,-8092.44 9295,-8063.44 9295,-8063.44 9295,-8057.44 9301,-8051.44 9307,-8051.44 9307,-8051.44 9755,-8051.44 9755,-8051.44 9761,-8051.44 9767,-8057.44 9767,-8063.44 9767,-8063.44 9767,-8092.44 9767,-8092.44 9767,-8098.44 9761,-8104.44 9755,-8104.44"/>
<text text-anchor="middle" x="9531" y="-8089.24" font-family="Times,serif" font-size="14.00">MHA Layer 5 GPU 9</text>
<text text-anchor="middle" x="9531" y="-8074.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9531" y="-8059.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer4_gpu9&#45;&gt;mha_layer5_gpu9 -->
<g id="edge490" class="edge">
<title>aggregate_layer4_gpu9&#45;&gt;mha_layer5_gpu9</title>
<path fill="none" stroke="black" d="M9526.13,-8140.34C9526.83,-8131.57 9527.53,-8122.65 9528.19,-8114.43"/>
<polygon fill="black" stroke="black" points="9531.68,-8114.7 9528.98,-8104.45 9524.7,-8114.15 9531.68,-8114.7"/>
</g>
<!-- route_layer4_gpu10&#45;&gt;comm_layer4 -->
<g id="edge443" class="edge">
<title>route_layer4_gpu10&#45;&gt;comm_layer4</title>
<path fill="none" stroke="black" d="M10453.56,-8519.45C10363.85,-8511.41 10265.55,-8503.32 10175,-8497.39 9651.68,-8463.13 9037.71,-8441.8 8702.88,-8431.76"/>
<polygon fill="black" stroke="black" points="8702.67,-8428.25 8692.57,-8431.45 8702.46,-8435.25 8702.67,-8428.25"/>
</g>
<!-- mha_layer5_gpu10 -->
<g id="node417" class="node">
<title>mha_layer5_gpu10</title>
<path fill="lightblue" stroke="black" d="M10945,-8104.44C10945,-8104.44 10497,-8104.44 10497,-8104.44 10491,-8104.44 10485,-8098.44 10485,-8092.44 10485,-8092.44 10485,-8063.44 10485,-8063.44 10485,-8057.44 10491,-8051.44 10497,-8051.44 10497,-8051.44 10945,-8051.44 10945,-8051.44 10951,-8051.44 10957,-8057.44 10957,-8063.44 10957,-8063.44 10957,-8092.44 10957,-8092.44 10957,-8098.44 10951,-8104.44 10945,-8104.44"/>
<text text-anchor="middle" x="10721" y="-8089.24" font-family="Times,serif" font-size="14.00">MHA Layer 5 GPU 10</text>
<text text-anchor="middle" x="10721" y="-8074.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10721" y="-8059.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer4_gpu10&#45;&gt;mha_layer5_gpu10 -->
<g id="edge491" class="edge">
<title>aggregate_layer4_gpu10&#45;&gt;mha_layer5_gpu10</title>
<path fill="none" stroke="black" d="M10627.41,-8140.34C10643.15,-8130.01 10659.21,-8119.48 10673.48,-8110.12"/>
<polygon fill="black" stroke="black" points="10675.67,-8112.87 10682.11,-8104.45 10671.83,-8107.01 10675.67,-8112.87"/>
</g>
<!-- route_layer4_gpu11&#45;&gt;comm_layer4 -->
<g id="edge444" class="edge">
<title>route_layer4_gpu11&#45;&gt;comm_layer4</title>
<path fill="none" stroke="black" d="M11400.49,-8519.46C11305.54,-8511.13 11200.51,-8502.87 11104,-8497.39 10224.29,-8447.48 9178.29,-8431.69 8706.71,-8426.9"/>
<polygon fill="black" stroke="black" points="8706.75,-8423.4 8696.71,-8426.79 8706.68,-8430.4 8706.75,-8423.4"/>
</g>
<!-- mha_layer5_gpu11 -->
<g id="node418" class="node">
<title>mha_layer5_gpu11</title>
<path fill="lightblue" stroke="black" d="M12055,-8104.44C12055,-8104.44 11607,-8104.44 11607,-8104.44 11601,-8104.44 11595,-8098.44 11595,-8092.44 11595,-8092.44 11595,-8063.44 11595,-8063.44 11595,-8057.44 11601,-8051.44 11607,-8051.44 11607,-8051.44 12055,-8051.44 12055,-8051.44 12061,-8051.44 12067,-8057.44 12067,-8063.44 12067,-8063.44 12067,-8092.44 12067,-8092.44 12067,-8098.44 12061,-8104.44 12055,-8104.44"/>
<text text-anchor="middle" x="11831" y="-8089.24" font-family="Times,serif" font-size="14.00">MHA Layer 5 GPU 11</text>
<text text-anchor="middle" x="11831" y="-8074.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11831" y="-8059.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer4_gpu11&#45;&gt;mha_layer5_gpu11 -->
<g id="edge492" class="edge">
<title>aggregate_layer4_gpu11&#45;&gt;mha_layer5_gpu11</title>
<path fill="none" stroke="black" d="M11651.94,-8140.34C11684.61,-8129.14 11718,-8117.69 11746.95,-8107.76"/>
<polygon fill="black" stroke="black" points="11748.27,-8111.01 11756.59,-8104.45 11746,-8104.39 11748.27,-8111.01"/>
</g>
<!-- route_layer4_gpu12&#45;&gt;comm_layer4 -->
<g id="edge445" class="edge">
<title>route_layer4_gpu12&#45;&gt;comm_layer4</title>
<path fill="none" stroke="black" d="M12355.35,-8519.38C12258.12,-8510.92 12150.14,-8502.61 12051,-8497.39 10797.64,-8431.5 9295.73,-8424.4 8707.66,-8424.39"/>
<polygon fill="black" stroke="black" points="8707.36,-8420.89 8697.36,-8424.39 8707.36,-8427.89 8707.36,-8420.89"/>
</g>
<!-- mha_layer5_gpu12 -->
<g id="node419" class="node">
<title>mha_layer5_gpu12</title>
<path fill="lightblue" stroke="black" d="M12716,-8104.44C12716,-8104.44 12268,-8104.44 12268,-8104.44 12262,-8104.44 12256,-8098.44 12256,-8092.44 12256,-8092.44 12256,-8063.44 12256,-8063.44 12256,-8057.44 12262,-8051.44 12268,-8051.44 12268,-8051.44 12716,-8051.44 12716,-8051.44 12722,-8051.44 12728,-8057.44 12728,-8063.44 12728,-8063.44 12728,-8092.44 12728,-8092.44 12728,-8098.44 12722,-8104.44 12716,-8104.44"/>
<text text-anchor="middle" x="12492" y="-8089.24" font-family="Times,serif" font-size="14.00">MHA Layer 5 GPU 12</text>
<text text-anchor="middle" x="12492" y="-8074.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12492" y="-8059.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer4_gpu12&#45;&gt;mha_layer5_gpu12 -->
<g id="edge493" class="edge">
<title>aggregate_layer4_gpu12&#45;&gt;mha_layer5_gpu12</title>
<path fill="none" stroke="black" d="M12391.38,-8140.34C12408.46,-8129.92 12425.89,-8119.28 12441.34,-8109.85"/>
<polygon fill="black" stroke="black" points="12443.48,-8112.65 12450.19,-8104.45 12439.83,-8106.67 12443.48,-8112.65"/>
</g>
<!-- route_layer4_gpu13&#45;&gt;comm_layer4 -->
<g id="edge446" class="edge">
<title>route_layer4_gpu13&#45;&gt;comm_layer4</title>
<path fill="none" stroke="black" d="M13315.61,-8519.38C13216.87,-8510.82 13106.89,-8502.45 13006,-8497.39 12159.33,-8454.97 9535.43,-8432.75 8707.2,-8426.67"/>
<polygon fill="black" stroke="black" points="8706.96,-8423.17 8696.94,-8426.59 8706.91,-8430.17 8706.96,-8423.17"/>
</g>
<!-- mha_layer5_gpu13 -->
<g id="node420" class="node">
<title>mha_layer5_gpu13</title>
<path fill="lightblue" stroke="black" d="M13291,-8104.44C13291,-8104.44 12843,-8104.44 12843,-8104.44 12837,-8104.44 12831,-8098.44 12831,-8092.44 12831,-8092.44 12831,-8063.44 12831,-8063.44 12831,-8057.44 12837,-8051.44 12843,-8051.44 12843,-8051.44 13291,-8051.44 13291,-8051.44 13297,-8051.44 13303,-8057.44 13303,-8063.44 13303,-8063.44 13303,-8092.44 13303,-8092.44 13303,-8098.44 13297,-8104.44 13291,-8104.44"/>
<text text-anchor="middle" x="13067" y="-8089.24" font-family="Times,serif" font-size="14.00">MHA Layer 5 GPU 13</text>
<text text-anchor="middle" x="13067" y="-8074.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13067" y="-8059.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer4_gpu13&#45;&gt;mha_layer5_gpu13 -->
<g id="edge494" class="edge">
<title>aggregate_layer4_gpu13&#45;&gt;mha_layer5_gpu13</title>
<path fill="none" stroke="black" d="M13052.39,-8140.34C13054.48,-8131.57 13056.6,-8122.65 13058.56,-8114.43"/>
<polygon fill="black" stroke="black" points="13062.02,-8114.99 13060.93,-8104.45 13055.21,-8113.37 13062.02,-8114.99"/>
</g>
<!-- route_layer4_gpu14&#45;&gt;comm_layer4 -->
<g id="edge447" class="edge">
<title>route_layer4_gpu14&#45;&gt;comm_layer4</title>
<path fill="none" stroke="black" d="M14277.41,-8519.28C14178.15,-8510.69 14067.49,-8502.32 13966,-8497.39 12921.78,-8446.66 9645.27,-8429.73 8707.23,-8425.86"/>
<polygon fill="black" stroke="black" points="8706.99,-8422.36 8696.98,-8425.82 8706.96,-8429.36 8706.99,-8422.36"/>
</g>
<!-- mha_layer5_gpu14 -->
<g id="node421" class="node">
<title>mha_layer5_gpu14</title>
<path fill="lightblue" stroke="black" d="M14716,-8104.44C14716,-8104.44 14268,-8104.44 14268,-8104.44 14262,-8104.44 14256,-8098.44 14256,-8092.44 14256,-8092.44 14256,-8063.44 14256,-8063.44 14256,-8057.44 14262,-8051.44 14268,-8051.44 14268,-8051.44 14716,-8051.44 14716,-8051.44 14722,-8051.44 14728,-8057.44 14728,-8063.44 14728,-8063.44 14728,-8092.44 14728,-8092.44 14728,-8098.44 14722,-8104.44 14716,-8104.44"/>
<text text-anchor="middle" x="14492" y="-8089.24" font-family="Times,serif" font-size="14.00">MHA Layer 5 GPU 14</text>
<text text-anchor="middle" x="14492" y="-8074.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14492" y="-8059.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer4_gpu14&#45;&gt;mha_layer5_gpu14 -->
<g id="edge495" class="edge">
<title>aggregate_layer4_gpu14&#45;&gt;mha_layer5_gpu14</title>
<path fill="none" stroke="black" d="M14352.97,-8140.34C14377.68,-8129.43 14402.91,-8118.29 14424.98,-8108.54"/>
<polygon fill="black" stroke="black" points="14426.5,-8111.7 14434.23,-8104.45 14423.67,-8105.29 14426.5,-8111.7"/>
</g>
<!-- route_layer4_gpu15&#45;&gt;comm_layer4 -->
<g id="edge448" class="edge">
<title>route_layer4_gpu15&#45;&gt;comm_layer4</title>
<path fill="none" stroke="black" d="M15240.31,-8519.2C15140.79,-8510.58 15029.8,-8502.23 14928,-8497.39 13684.62,-8438.29 9746.7,-8427.2 8707.49,-8425.29"/>
<polygon fill="black" stroke="black" points="8707.28,-8421.79 8697.27,-8425.27 8707.27,-8428.79 8707.28,-8421.79"/>
</g>
<!-- mha_layer5_gpu15 -->
<g id="node422" class="node">
<title>mha_layer5_gpu15</title>
<path fill="lightblue" stroke="black" d="M15738,-8104.44C15738,-8104.44 15290,-8104.44 15290,-8104.44 15284,-8104.44 15278,-8098.44 15278,-8092.44 15278,-8092.44 15278,-8063.44 15278,-8063.44 15278,-8057.44 15284,-8051.44 15290,-8051.44 15290,-8051.44 15738,-8051.44 15738,-8051.44 15744,-8051.44 15750,-8057.44 15750,-8063.44 15750,-8063.44 15750,-8092.44 15750,-8092.44 15750,-8098.44 15744,-8104.44 15738,-8104.44"/>
<text text-anchor="middle" x="15514" y="-8089.24" font-family="Times,serif" font-size="14.00">MHA Layer 5 GPU 15</text>
<text text-anchor="middle" x="15514" y="-8074.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="15514" y="-8059.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer4_gpu15&#45;&gt;mha_layer5_gpu15 -->
<g id="edge496" class="edge">
<title>aggregate_layer4_gpu15&#45;&gt;mha_layer5_gpu15</title>
<path fill="none" stroke="black" d="M15405.81,-8140.34C15424.35,-8129.82 15443.27,-8119.08 15459.99,-8109.59"/>
<polygon fill="black" stroke="black" points="15462.07,-8112.43 15469.04,-8104.45 15458.62,-8106.35 15462.07,-8112.43"/>
</g>
<!-- comm_layer4&#45;&gt;expert_layer4_gpu0_expert0 -->
<g id="edge449" class="edge">
<title>comm_layer4&#45;&gt;expert_layer4_gpu0_expert0</title>
<path fill="none" stroke="black" d="M8210.63,-8422.16C7243.16,-8418.82 3667.28,-8403.1 2535,-8350.44 2486,-8348.16 2433.77,-8344.71 2383.6,-8340.89"/>
<polygon fill="black" stroke="black" points="2383.83,-8337.4 2373.6,-8340.12 2383.3,-8344.38 2383.83,-8337.4"/>
</g>
<!-- comm_layer4&#45;&gt;expert_layer4_gpu1_expert1 -->
<g id="edge450" class="edge">
<title>comm_layer4&#45;&gt;expert_layer4_gpu1_expert1</title>
<path fill="none" stroke="black" d="M8211.08,-8421.77C7496.73,-8417.88 5340.86,-8402.36 3553,-8350.44 3384.64,-8345.55 3195.45,-8337.37 3047.71,-8330.38"/>
<polygon fill="black" stroke="black" points="3047.75,-8326.88 3037.59,-8329.9 3047.41,-8333.87 3047.75,-8326.88"/>
</g>
<!-- comm_layer4&#45;&gt;expert_layer4_gpu2_expert2 -->
<g id="edge451" class="edge">
<title>comm_layer4&#45;&gt;expert_layer4_gpu2_expert2</title>
<path fill="none" stroke="black" d="M8211.16,-8421.32C7587.1,-8416.62 5876.35,-8399.87 4452,-8350.44 4324.86,-8346.03 4183.69,-8339.02 4066.08,-8332.59"/>
<polygon fill="black" stroke="black" points="4066.04,-8329.08 4055.86,-8332.03 4065.65,-8336.07 4066.04,-8329.08"/>
</g>
<!-- comm_layer4&#45;&gt;expert_layer4_gpu3_expert3 -->
<g id="edge452" class="edge">
<title>comm_layer4&#45;&gt;expert_layer4_gpu3_expert3</title>
<path fill="none" stroke="black" d="M8211.8,-8420.32C7679.99,-8413.99 6370.13,-8394.87 5274,-8350.44 5172.96,-8346.34 5061.85,-8340.22 4965.04,-8334.36"/>
<polygon fill="black" stroke="black" points="4965.01,-8330.85 4954.82,-8333.74 4964.59,-8337.84 4965.01,-8330.85"/>
</g>
<!-- comm_layer4&#45;&gt;expert_layer4_gpu4_expert4 -->
<g id="edge453" class="edge">
<title>comm_layer4&#45;&gt;expert_layer4_gpu4_expert4</title>
<path fill="none" stroke="black" d="M8217.79,-8414.77C7836.02,-8401.55 7059.7,-8374.5 6402,-8350.44 6195.01,-8342.87 5960.4,-8333.97 5786.7,-8327.32"/>
<polygon fill="black" stroke="black" points="5786.78,-8323.83 5776.66,-8326.94 5786.51,-8330.82 5786.78,-8323.83"/>
</g>
<!-- comm_layer4&#45;&gt;expert_layer4_gpu5_expert5 -->
<g id="edge454" class="edge">
<title>comm_layer4&#45;&gt;expert_layer4_gpu5_expert5</title>
<path fill="none" stroke="black" d="M8228.81,-8409.69C7894.08,-8390.03 7267.01,-8353.21 6914.86,-8332.52"/>
<polygon fill="black" stroke="black" points="6914.97,-8329.03 6904.78,-8331.93 6914.56,-8336.01 6914.97,-8329.03"/>
</g>
<!-- comm_layer4&#45;&gt;expert_layer4_gpu6_expert6 -->
<g id="edge455" class="edge">
<title>comm_layer4&#45;&gt;expert_layer4_gpu6_expert6</title>
<path fill="none" stroke="black" d="M8257.96,-8401.73C8107.63,-8385.48 7898.86,-8362.92 7735.13,-8345.23"/>
<polygon fill="black" stroke="black" points="7735.23,-8341.72 7724.91,-8344.12 7734.48,-8348.68 7735.23,-8341.72"/>
</g>
<!-- comm_layer4&#45;&gt;expert_layer4_gpu7_expert7 -->
<g id="edge456" class="edge">
<title>comm_layer4&#45;&gt;expert_layer4_gpu7_expert7</title>
<path fill="none" stroke="black" d="M8355.6,-8389.54C8322.01,-8378.15 8284.29,-8365.36 8250.05,-8353.75"/>
<polygon fill="black" stroke="black" points="8251.09,-8350.4 8240.5,-8350.51 8248.84,-8357.03 8251.09,-8350.4"/>
</g>
<!-- comm_layer4&#45;&gt;expert_layer4_gpu8_expert8 -->
<g id="edge457" class="edge">
<title>comm_layer4&#45;&gt;expert_layer4_gpu8_expert8</title>
<path fill="none" stroke="black" d="M8552.72,-8389.54C8586.42,-8378.15 8624.26,-8365.36 8658.6,-8353.75"/>
<polygon fill="black" stroke="black" points="8659.84,-8357.02 8668.19,-8350.51 8657.6,-8350.39 8659.84,-8357.02"/>
</g>
<!-- comm_layer4&#45;&gt;expert_layer4_gpu9_expert9 -->
<g id="edge458" class="edge">
<title>comm_layer4&#45;&gt;expert_layer4_gpu9_expert9</title>
<path fill="none" stroke="black" d="M8650.02,-8401.67C8799.66,-8385.45 9007.15,-8362.95 9170.07,-8345.29"/>
<polygon fill="black" stroke="black" points="9170.68,-8348.75 9180.24,-8344.19 9169.92,-8341.79 9170.68,-8348.75"/>
</g>
<!-- comm_layer4&#45;&gt;expert_layer4_gpu10_expert10 -->
<g id="edge459" class="edge">
<title>comm_layer4&#45;&gt;expert_layer4_gpu10_expert10</title>
<path fill="none" stroke="black" d="M8679.54,-8409.82C9018.54,-8390.14 9657.62,-8353.05 10014.12,-8332.35"/>
<polygon fill="black" stroke="black" points="10014.55,-8335.83 10024.33,-8331.76 10014.14,-8328.84 10014.55,-8335.83"/>
</g>
<!-- comm_layer4&#45;&gt;expert_layer4_gpu11_expert11 -->
<g id="edge460" class="edge">
<title>comm_layer4&#45;&gt;expert_layer4_gpu11_expert11</title>
<path fill="none" stroke="black" d="M8691.77,-8415.86C9077.04,-8404.14 9861.62,-8379.11 10526,-8350.44 10653.23,-8344.95 10794.57,-8337.81 10912.26,-8331.58"/>
<polygon fill="black" stroke="black" points="10912.69,-8335.06 10922.49,-8331.03 10912.31,-8328.07 10912.69,-8335.06"/>
</g>
<!-- comm_layer4&#45;&gt;expert_layer4_gpu12_expert12 -->
<g id="edge461" class="edge">
<title>comm_layer4&#45;&gt;expert_layer4_gpu12_expert12</title>
<path fill="none" stroke="black" d="M8695.65,-8419.54C9201.86,-8411.92 10410.65,-8390.8 11424,-8350.44 11535.53,-8346 11658.7,-8339.46 11764.05,-8333.38"/>
<polygon fill="black" stroke="black" points="11764.41,-8336.87 11774.19,-8332.79 11764,-8329.88 11764.41,-8336.87"/>
</g>
<!-- comm_layer4&#45;&gt;expert_layer4_gpu13_expert13 -->
<g id="edge462" class="edge">
<title>comm_layer4&#45;&gt;expert_layer4_gpu13_expert13</title>
<path fill="none" stroke="black" d="M8696.96,-8421.87C9301.91,-8418.5 10924.26,-8404.69 12276,-8350.44 12367.72,-8346.76 12468.14,-8341.05 12557.13,-8335.42"/>
<polygon fill="black" stroke="black" points="12557.61,-8338.89 12567.37,-8334.76 12557.17,-8331.91 12557.61,-8338.89"/>
</g>
<!-- comm_layer4&#45;&gt;expert_layer4_gpu14_expert14 -->
<g id="edge463" class="edge">
<title>comm_layer4&#45;&gt;expert_layer4_gpu14_expert14</title>
<path fill="none" stroke="black" d="M8697.05,-8421.57C9383.77,-8417.25 11397.27,-8400.88 13069,-8350.44 13229.3,-8345.6 13409.06,-8337.63 13551.15,-8330.74"/>
<polygon fill="black" stroke="black" points="13551.49,-8334.22 13561.31,-8330.24 13551.15,-8327.23 13551.49,-8334.22"/>
</g>
<!-- comm_layer4&#45;&gt;expert_layer4_gpu15_expert15 -->
<g id="edge464" class="edge">
<title>comm_layer4&#45;&gt;expert_layer4_gpu15_expert15</title>
<path fill="none" stroke="black" d="M8697.33,-8422.32C9477.56,-8419.86 11987.02,-8407.7 14063,-8350.44 14237.88,-8345.62 14434.68,-8337.28 14586.98,-8330.2"/>
<polygon fill="black" stroke="black" points="14587.58,-8333.67 14597.4,-8329.71 14587.25,-8326.68 14587.58,-8333.67"/>
</g>
<!-- gate_layer5_gpu0 -->
<g id="node423" class="node">
<title>gate_layer5_gpu0</title>
<path fill="lightsteelblue" stroke="black" d="M1242.07,-8014.1C1242.07,-8014.1 792.93,-7963.78 792.93,-7963.78 786.96,-7963.11 786.96,-7961.77 792.93,-7961.1 792.93,-7961.1 1242.07,-7910.78 1242.07,-7910.78 1248.04,-7910.11 1259.96,-7910.11 1265.93,-7910.78 1265.93,-7910.78 1715.07,-7961.1 1715.07,-7961.1 1721.04,-7961.77 1721.04,-7963.11 1715.07,-7963.78 1715.07,-7963.78 1265.93,-8014.1 1265.93,-8014.1 1259.96,-8014.77 1248.04,-8014.77 1242.07,-8014.1"/>
<text text-anchor="middle" x="1254" y="-7973.74" font-family="Times,serif" font-size="14.00">Gate Layer 5 GPU 0</text>
<text text-anchor="middle" x="1254" y="-7958.74" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="1254" y="-7943.74" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer5_gpu0&#45;&gt;gate_layer5_gpu0 -->
<g id="edge497" class="edge">
<title>mha_layer5_gpu0&#45;&gt;gate_layer5_gpu0</title>
<path fill="none" stroke="black" d="M1549.8,-8051.33C1502.98,-8037.42 1443.99,-8019.89 1391.04,-8004.16"/>
<polygon fill="black" stroke="black" points="1391.81,-8000.73 1381.22,-8001.24 1389.81,-8007.44 1391.81,-8000.73"/>
</g>
<!-- gate_layer5_gpu1 -->
<g id="node424" class="node">
<title>gate_layer5_gpu1</title>
<path fill="lightsteelblue" stroke="black" d="M2206.07,-8014.1C2206.07,-8014.1 1756.93,-7963.78 1756.93,-7963.78 1750.96,-7963.11 1750.96,-7961.77 1756.93,-7961.1 1756.93,-7961.1 2206.07,-7910.78 2206.07,-7910.78 2212.04,-7910.11 2223.96,-7910.11 2229.93,-7910.78 2229.93,-7910.78 2679.07,-7961.1 2679.07,-7961.1 2685.04,-7961.77 2685.04,-7963.11 2679.07,-7963.78 2679.07,-7963.78 2229.93,-8014.1 2229.93,-8014.1 2223.96,-8014.77 2212.04,-8014.77 2206.07,-8014.1"/>
<text text-anchor="middle" x="2218" y="-7973.74" font-family="Times,serif" font-size="14.00">Gate Layer 5 GPU 1</text>
<text text-anchor="middle" x="2218" y="-7958.74" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="2218" y="-7943.74" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer5_gpu1&#45;&gt;gate_layer5_gpu1 -->
<g id="edge498" class="edge">
<title>mha_layer5_gpu1&#45;&gt;gate_layer5_gpu1</title>
<path fill="none" stroke="black" d="M2392.23,-8051.33C2368.47,-8039.34 2339.4,-8024.68 2311.86,-8010.78"/>
<polygon fill="black" stroke="black" points="2313.09,-8007.49 2302.58,-8006.11 2309.94,-8013.74 2313.09,-8007.49"/>
</g>
<!-- gate_layer5_gpu2 -->
<g id="node425" class="node">
<title>gate_layer5_gpu2</title>
<path fill="lightsteelblue" stroke="black" d="M3170.07,-8014.1C3170.07,-8014.1 2720.93,-7963.78 2720.93,-7963.78 2714.96,-7963.11 2714.96,-7961.77 2720.93,-7961.1 2720.93,-7961.1 3170.07,-7910.78 3170.07,-7910.78 3176.04,-7910.11 3187.96,-7910.11 3193.93,-7910.78 3193.93,-7910.78 3643.07,-7961.1 3643.07,-7961.1 3649.04,-7961.77 3649.04,-7963.11 3643.07,-7963.78 3643.07,-7963.78 3193.93,-8014.1 3193.93,-8014.1 3187.96,-8014.77 3176.04,-8014.77 3170.07,-8014.1"/>
<text text-anchor="middle" x="3182" y="-7973.74" font-family="Times,serif" font-size="14.00">Gate Layer 5 GPU 2</text>
<text text-anchor="middle" x="3182" y="-7958.74" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="3182" y="-7943.74" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer5_gpu2&#45;&gt;gate_layer5_gpu2 -->
<g id="edge499" class="edge">
<title>mha_layer5_gpu2&#45;&gt;gate_layer5_gpu2</title>
<path fill="none" stroke="black" d="M3432.11,-8051.33C3394.23,-8038.02 3346.94,-8021.4 3303.7,-8006.21"/>
<polygon fill="black" stroke="black" points="3304.85,-8002.9 3294.26,-8002.89 3302.53,-8009.5 3304.85,-8002.9"/>
</g>
<!-- gate_layer5_gpu3 -->
<g id="node426" class="node">
<title>gate_layer5_gpu3</title>
<path fill="lightsteelblue" stroke="black" d="M4134.07,-8014.1C4134.07,-8014.1 3684.93,-7963.78 3684.93,-7963.78 3678.96,-7963.11 3678.96,-7961.77 3684.93,-7961.1 3684.93,-7961.1 4134.07,-7910.78 4134.07,-7910.78 4140.04,-7910.11 4151.96,-7910.11 4157.93,-7910.78 4157.93,-7910.78 4607.07,-7961.1 4607.07,-7961.1 4613.04,-7961.77 4613.04,-7963.11 4607.07,-7963.78 4607.07,-7963.78 4157.93,-8014.1 4157.93,-8014.1 4151.96,-8014.77 4140.04,-8014.77 4134.07,-8014.1"/>
<text text-anchor="middle" x="4146" y="-7973.74" font-family="Times,serif" font-size="14.00">Gate Layer 5 GPU 3</text>
<text text-anchor="middle" x="4146" y="-7958.74" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4146" y="-7943.74" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer5_gpu3&#45;&gt;gate_layer5_gpu3 -->
<g id="edge500" class="edge">
<title>mha_layer5_gpu3&#45;&gt;gate_layer5_gpu3</title>
<path fill="none" stroke="black" d="M4274.33,-8051.18C4258.17,-8040.13 4238.69,-8026.82 4219.85,-8013.94"/>
<polygon fill="black" stroke="black" points="4221.77,-8011.01 4211.54,-8008.25 4217.82,-8016.79 4221.77,-8011.01"/>
</g>
<!-- gate_layer5_gpu4 -->
<g id="node427" class="node">
<title>gate_layer5_gpu4</title>
<path fill="lightsteelblue" stroke="black" d="M5098.07,-8014.1C5098.07,-8014.1 4648.93,-7963.78 4648.93,-7963.78 4642.96,-7963.11 4642.96,-7961.77 4648.93,-7961.1 4648.93,-7961.1 5098.07,-7910.78 5098.07,-7910.78 5104.04,-7910.11 5115.96,-7910.11 5121.93,-7910.78 5121.93,-7910.78 5571.07,-7961.1 5571.07,-7961.1 5577.04,-7961.77 5577.04,-7963.11 5571.07,-7963.78 5571.07,-7963.78 5121.93,-8014.1 5121.93,-8014.1 5115.96,-8014.77 5104.04,-8014.77 5098.07,-8014.1"/>
<text text-anchor="middle" x="5110" y="-7973.74" font-family="Times,serif" font-size="14.00">Gate Layer 5 GPU 4</text>
<text text-anchor="middle" x="5110" y="-7958.74" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5110" y="-7943.74" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer5_gpu4&#45;&gt;gate_layer5_gpu4 -->
<g id="edge501" class="edge">
<title>mha_layer5_gpu4&#45;&gt;gate_layer5_gpu4</title>
<path fill="none" stroke="black" d="M5183.44,-8051.18C5175.44,-8041.62 5166.01,-8030.36 5156.63,-8019.15"/>
<polygon fill="black" stroke="black" points="5159.27,-8016.85 5150.16,-8011.42 5153.9,-8021.34 5159.27,-8016.85"/>
</g>
<!-- gate_layer5_gpu5 -->
<g id="node428" class="node">
<title>gate_layer5_gpu5</title>
<path fill="lightsteelblue" stroke="black" d="M6062.07,-8014.1C6062.07,-8014.1 5612.93,-7963.78 5612.93,-7963.78 5606.96,-7963.11 5606.96,-7961.77 5612.93,-7961.1 5612.93,-7961.1 6062.07,-7910.78 6062.07,-7910.78 6068.04,-7910.11 6079.96,-7910.11 6085.93,-7910.78 6085.93,-7910.78 6535.07,-7961.1 6535.07,-7961.1 6541.04,-7961.77 6541.04,-7963.11 6535.07,-7963.78 6535.07,-7963.78 6085.93,-8014.1 6085.93,-8014.1 6079.96,-8014.77 6068.04,-8014.77 6062.07,-8014.1"/>
<text text-anchor="middle" x="6074" y="-7973.74" font-family="Times,serif" font-size="14.00">Gate Layer 5 GPU 5</text>
<text text-anchor="middle" x="6074" y="-7958.74" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6074" y="-7943.74" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer5_gpu5&#45;&gt;gate_layer5_gpu5 -->
<g id="edge502" class="edge">
<title>mha_layer5_gpu5&#45;&gt;gate_layer5_gpu5</title>
<path fill="none" stroke="black" d="M6176.05,-8051.18C6163.98,-8040.81 6149.6,-8028.44 6135.49,-8016.31"/>
<polygon fill="black" stroke="black" points="6137.56,-8013.48 6127.7,-8009.61 6133,-8018.78 6137.56,-8013.48"/>
</g>
<!-- gate_layer5_gpu6 -->
<g id="node429" class="node">
<title>gate_layer5_gpu6</title>
<path fill="lightsteelblue" stroke="black" d="M7026.07,-8014.1C7026.07,-8014.1 6576.93,-7963.78 6576.93,-7963.78 6570.96,-7963.11 6570.96,-7961.77 6576.93,-7961.1 6576.93,-7961.1 7026.07,-7910.78 7026.07,-7910.78 7032.04,-7910.11 7043.96,-7910.11 7049.93,-7910.78 7049.93,-7910.78 7499.07,-7961.1 7499.07,-7961.1 7505.04,-7961.77 7505.04,-7963.11 7499.07,-7963.78 7499.07,-7963.78 7049.93,-8014.1 7049.93,-8014.1 7043.96,-8014.77 7032.04,-8014.77 7026.07,-8014.1"/>
<text text-anchor="middle" x="7038" y="-7973.74" font-family="Times,serif" font-size="14.00">Gate Layer 5 GPU 6</text>
<text text-anchor="middle" x="7038" y="-7958.74" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="7038" y="-7943.74" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer5_gpu6&#45;&gt;gate_layer5_gpu6 -->
<g id="edge503" class="edge">
<title>mha_layer5_gpu6&#45;&gt;gate_layer5_gpu6</title>
<path fill="none" stroke="black" d="M7097.53,-8051.18C7091.23,-8041.91 7083.86,-8031.04 7076.48,-8020.17"/>
<polygon fill="black" stroke="black" points="7079.37,-8018.19 7070.86,-8011.88 7073.58,-8022.12 7079.37,-8018.19"/>
</g>
<!-- gate_layer5_gpu7 -->
<g id="node430" class="node">
<title>gate_layer5_gpu7</title>
<path fill="lightsteelblue" stroke="black" d="M7990.07,-8014.1C7990.07,-8014.1 7540.93,-7963.78 7540.93,-7963.78 7534.96,-7963.11 7534.96,-7961.77 7540.93,-7961.1 7540.93,-7961.1 7990.07,-7910.78 7990.07,-7910.78 7996.04,-7910.11 8007.96,-7910.11 8013.93,-7910.78 8013.93,-7910.78 8463.07,-7961.1 8463.07,-7961.1 8469.04,-7961.77 8469.04,-7963.11 8463.07,-7963.78 8463.07,-7963.78 8013.93,-8014.1 8013.93,-8014.1 8007.96,-8014.77 7996.04,-8014.77 7990.07,-8014.1"/>
<text text-anchor="middle" x="8002" y="-7973.74" font-family="Times,serif" font-size="14.00">Gate Layer 5 GPU 7</text>
<text text-anchor="middle" x="8002" y="-7958.74" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="8002" y="-7943.74" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer5_gpu7&#45;&gt;gate_layer5_gpu7 -->
<g id="edge504" class="edge">
<title>mha_layer5_gpu7&#45;&gt;gate_layer5_gpu7</title>
<path fill="none" stroke="black" d="M8016.69,-8051.18C8015.35,-8043.21 8013.82,-8034.06 8012.26,-8024.75"/>
<polygon fill="black" stroke="black" points="8015.67,-8023.91 8010.57,-8014.62 8008.77,-8025.06 8015.67,-8023.91"/>
</g>
<!-- gate_layer5_gpu8 -->
<g id="node431" class="node">
<title>gate_layer5_gpu8</title>
<path fill="lightsteelblue" stroke="black" d="M8954.07,-8014.1C8954.07,-8014.1 8504.93,-7963.78 8504.93,-7963.78 8498.96,-7963.11 8498.96,-7961.77 8504.93,-7961.1 8504.93,-7961.1 8954.07,-7910.78 8954.07,-7910.78 8960.04,-7910.11 8971.96,-7910.11 8977.93,-7910.78 8977.93,-7910.78 9427.07,-7961.1 9427.07,-7961.1 9433.04,-7961.77 9433.04,-7963.11 9427.07,-7963.78 9427.07,-7963.78 8977.93,-8014.1 8977.93,-8014.1 8971.96,-8014.77 8960.04,-8014.77 8954.07,-8014.1"/>
<text text-anchor="middle" x="8966" y="-7973.74" font-family="Times,serif" font-size="14.00">Gate Layer 5 GPU 8</text>
<text text-anchor="middle" x="8966" y="-7958.74" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="8966" y="-7943.74" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer5_gpu8&#45;&gt;gate_layer5_gpu8 -->
<g id="edge505" class="edge">
<title>mha_layer5_gpu8&#45;&gt;gate_layer5_gpu8</title>
<path fill="none" stroke="black" d="M8958.27,-8051.18C8958.96,-8043.31 8959.76,-8034.28 8960.57,-8025.08"/>
<polygon fill="black" stroke="black" points="8964.06,-8025.35 8961.45,-8015.08 8957.09,-8024.73 8964.06,-8025.35"/>
</g>
<!-- gate_layer5_gpu9 -->
<g id="node432" class="node">
<title>gate_layer5_gpu9</title>
<path fill="lightsteelblue" stroke="black" d="M9918.07,-8014.1C9918.07,-8014.1 9468.93,-7963.78 9468.93,-7963.78 9462.96,-7963.11 9462.96,-7961.77 9468.93,-7961.1 9468.93,-7961.1 9918.07,-7910.78 9918.07,-7910.78 9924.04,-7910.11 9935.96,-7910.11 9941.93,-7910.78 9941.93,-7910.78 10391.07,-7961.1 10391.07,-7961.1 10397.04,-7961.77 10397.04,-7963.11 10391.07,-7963.78 10391.07,-7963.78 9941.93,-8014.1 9941.93,-8014.1 9935.96,-8014.77 9924.04,-8014.77 9918.07,-8014.1"/>
<text text-anchor="middle" x="9930" y="-7973.74" font-family="Times,serif" font-size="14.00">Gate Layer 5 GPU 9</text>
<text text-anchor="middle" x="9930" y="-7958.74" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="9930" y="-7943.74" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer5_gpu9&#45;&gt;gate_layer5_gpu9 -->
<g id="edge506" class="edge">
<title>mha_layer5_gpu9&#45;&gt;gate_layer5_gpu9</title>
<path fill="none" stroke="black" d="M9621.04,-8051.33C9670.58,-8037.23 9733.16,-8019.43 9789.02,-8003.54"/>
<polygon fill="black" stroke="black" points="9789.99,-8006.91 9798.65,-8000.8 9788.07,-8000.17 9789.99,-8006.91"/>
</g>
<!-- gate_layer5_gpu10 -->
<g id="node433" class="node">
<title>gate_layer5_gpu10</title>
<path fill="lightsteelblue" stroke="black" d="M10882.07,-8014.1C10882.07,-8014.1 10432.93,-7963.78 10432.93,-7963.78 10426.96,-7963.11 10426.96,-7961.77 10432.93,-7961.1 10432.93,-7961.1 10882.07,-7910.78 10882.07,-7910.78 10888.04,-7910.11 10899.96,-7910.11 10905.93,-7910.78 10905.93,-7910.78 11355.07,-7961.1 11355.07,-7961.1 11361.04,-7961.77 11361.04,-7963.11 11355.07,-7963.78 11355.07,-7963.78 10905.93,-8014.1 10905.93,-8014.1 10899.96,-8014.77 10888.04,-8014.77 10882.07,-8014.1"/>
<text text-anchor="middle" x="10894" y="-7973.74" font-family="Times,serif" font-size="14.00">Gate Layer 5 GPU 10</text>
<text text-anchor="middle" x="10894" y="-7958.74" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="10894" y="-7943.74" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer5_gpu10&#45;&gt;gate_layer5_gpu10 -->
<g id="edge507" class="edge">
<title>mha_layer5_gpu10&#45;&gt;gate_layer5_gpu10</title>
<path fill="none" stroke="black" d="M10760.26,-8051.18C10777.27,-8040.03 10797.79,-8026.56 10817.6,-8013.56"/>
<polygon fill="black" stroke="black" points="10819.59,-8016.44 10826.04,-8008.03 10815.75,-8010.59 10819.59,-8016.44"/>
</g>
<!-- gate_layer5_gpu11 -->
<g id="node434" class="node">
<title>gate_layer5_gpu11</title>
<path fill="lightsteelblue" stroke="black" d="M11846.07,-8014.1C11846.07,-8014.1 11396.93,-7963.78 11396.93,-7963.78 11390.96,-7963.11 11390.96,-7961.77 11396.93,-7961.1 11396.93,-7961.1 11846.07,-7910.78 11846.07,-7910.78 11852.04,-7910.11 11863.96,-7910.11 11869.93,-7910.78 11869.93,-7910.78 12319.07,-7961.1 12319.07,-7961.1 12325.04,-7961.77 12325.04,-7963.11 12319.07,-7963.78 12319.07,-7963.78 11869.93,-8014.1 11869.93,-8014.1 11863.96,-8014.77 11852.04,-8014.77 11846.07,-8014.1"/>
<text text-anchor="middle" x="11858" y="-7973.74" font-family="Times,serif" font-size="14.00">Gate Layer 5 GPU 11</text>
<text text-anchor="middle" x="11858" y="-7958.74" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11858" y="-7943.74" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer5_gpu11&#45;&gt;gate_layer5_gpu11 -->
<g id="edge508" class="edge">
<title>mha_layer5_gpu11&#45;&gt;gate_layer5_gpu11</title>
<path fill="none" stroke="black" d="M11837.13,-8051.18C11839.07,-8043.03 11841.3,-8033.64 11843.57,-8024.11"/>
<polygon fill="black" stroke="black" points="11847.02,-8024.7 11845.93,-8014.16 11840.21,-8023.08 11847.02,-8024.7"/>
</g>
<!-- gate_layer5_gpu12 -->
<g id="node435" class="node">
<title>gate_layer5_gpu12</title>
<path fill="lightsteelblue" stroke="black" d="M12810.07,-8014.1C12810.07,-8014.1 12360.93,-7963.78 12360.93,-7963.78 12354.96,-7963.11 12354.96,-7961.77 12360.93,-7961.1 12360.93,-7961.1 12810.07,-7910.78 12810.07,-7910.78 12816.04,-7910.11 12827.96,-7910.11 12833.93,-7910.78 12833.93,-7910.78 13283.07,-7961.1 13283.07,-7961.1 13289.04,-7961.77 13289.04,-7963.11 13283.07,-7963.78 13283.07,-7963.78 12833.93,-8014.1 12833.93,-8014.1 12827.96,-8014.77 12816.04,-8014.77 12810.07,-8014.1"/>
<text text-anchor="middle" x="12822" y="-7973.74" font-family="Times,serif" font-size="14.00">Gate Layer 5 GPU 12</text>
<text text-anchor="middle" x="12822" y="-7958.74" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="12822" y="-7943.74" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer5_gpu12&#45;&gt;gate_layer5_gpu12 -->
<g id="edge509" class="edge">
<title>mha_layer5_gpu12&#45;&gt;gate_layer5_gpu12</title>
<path fill="none" stroke="black" d="M12566.47,-8051.33C12605.34,-8037.96 12653.93,-8021.25 12698.26,-8006"/>
<polygon fill="black" stroke="black" points="12699.63,-8009.23 12707.95,-8002.67 12697.36,-8002.61 12699.63,-8009.23"/>
</g>
<!-- gate_layer5_gpu13 -->
<g id="node436" class="node">
<title>gate_layer5_gpu13</title>
<path fill="lightsteelblue" stroke="black" d="M13774.07,-8014.1C13774.07,-8014.1 13324.93,-7963.78 13324.93,-7963.78 13318.96,-7963.11 13318.96,-7961.77 13324.93,-7961.1 13324.93,-7961.1 13774.07,-7910.78 13774.07,-7910.78 13780.04,-7910.11 13791.96,-7910.11 13797.93,-7910.78 13797.93,-7910.78 14247.07,-7961.1 14247.07,-7961.1 14253.04,-7961.77 14253.04,-7963.11 14247.07,-7963.78 14247.07,-7963.78 13797.93,-8014.1 13797.93,-8014.1 13791.96,-8014.77 13780.04,-8014.77 13774.07,-8014.1"/>
<text text-anchor="middle" x="13786" y="-7973.74" font-family="Times,serif" font-size="14.00">Gate Layer 5 GPU 13</text>
<text text-anchor="middle" x="13786" y="-7958.74" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13786" y="-7943.74" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer5_gpu13&#45;&gt;gate_layer5_gpu13 -->
<g id="edge510" class="edge">
<title>mha_layer5_gpu13&#45;&gt;gate_layer5_gpu13</title>
<path fill="none" stroke="black" d="M13228.81,-8051.4C13333.62,-8034.85 13470.98,-8013.17 13583.08,-7995.47"/>
<polygon fill="black" stroke="black" points="13583.83,-7998.9 13593.16,-7993.88 13582.74,-7991.98 13583.83,-7998.9"/>
</g>
<!-- gate_layer5_gpu14 -->
<g id="node437" class="node">
<title>gate_layer5_gpu14</title>
<path fill="lightsteelblue" stroke="black" d="M14738.07,-8014.1C14738.07,-8014.1 14288.93,-7963.78 14288.93,-7963.78 14282.96,-7963.11 14282.96,-7961.77 14288.93,-7961.1 14288.93,-7961.1 14738.07,-7910.78 14738.07,-7910.78 14744.04,-7910.11 14755.96,-7910.11 14761.93,-7910.78 14761.93,-7910.78 15211.07,-7961.1 15211.07,-7961.1 15217.04,-7961.77 15217.04,-7963.11 15211.07,-7963.78 15211.07,-7963.78 14761.93,-8014.1 14761.93,-8014.1 14755.96,-8014.77 14744.04,-8014.77 14738.07,-8014.1"/>
<text text-anchor="middle" x="14750" y="-7973.74" font-family="Times,serif" font-size="14.00">Gate Layer 5 GPU 14</text>
<text text-anchor="middle" x="14750" y="-7958.74" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14750" y="-7943.74" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer5_gpu14&#45;&gt;gate_layer5_gpu14 -->
<g id="edge511" class="edge">
<title>mha_layer5_gpu14&#45;&gt;gate_layer5_gpu14</title>
<path fill="none" stroke="black" d="M14550.22,-8051.33C14578.61,-8038.84 14613.63,-8023.43 14646.38,-8009.03"/>
<polygon fill="black" stroke="black" points="14647.8,-8012.22 14655.55,-8004.99 14644.98,-8005.81 14647.8,-8012.22"/>
</g>
<!-- gate_layer5_gpu15 -->
<g id="node438" class="node">
<title>gate_layer5_gpu15</title>
<path fill="lightsteelblue" stroke="black" d="M15702.07,-8014.1C15702.07,-8014.1 15252.93,-7963.78 15252.93,-7963.78 15246.96,-7963.11 15246.96,-7961.77 15252.93,-7961.1 15252.93,-7961.1 15702.07,-7910.78 15702.07,-7910.78 15708.04,-7910.11 15719.96,-7910.11 15725.93,-7910.78 15725.93,-7910.78 16175.07,-7961.1 16175.07,-7961.1 16181.04,-7961.77 16181.04,-7963.11 16175.07,-7963.78 16175.07,-7963.78 15725.93,-8014.1 15725.93,-8014.1 15719.96,-8014.77 15708.04,-8014.77 15702.07,-8014.1"/>
<text text-anchor="middle" x="15714" y="-7973.74" font-family="Times,serif" font-size="14.00">Gate Layer 5 GPU 15</text>
<text text-anchor="middle" x="15714" y="-7958.74" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="15714" y="-7943.74" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer5_gpu15&#45;&gt;gate_layer5_gpu15 -->
<g id="edge512" class="edge">
<title>mha_layer5_gpu15&#45;&gt;gate_layer5_gpu15</title>
<path fill="none" stroke="black" d="M15559.38,-8051.18C15579.91,-8039.53 15604.87,-8025.37 15628.69,-8011.85"/>
<polygon fill="black" stroke="black" points="15630.44,-8014.89 15637.41,-8006.91 15626.98,-8008.8 15630.44,-8014.89"/>
</g>
<!-- route_layer5_gpu0 -->
<g id="node455" class="node">
<title>route_layer5_gpu0</title>
<path fill="orange" stroke="black" d="M1714.74,-7873.44C1714.74,-7873.44 1206.24,-7873.44 1206.24,-7873.44 1200.24,-7873.44 1189.5,-7869.77 1184.75,-7866.1 1184.75,-7866.1 1066.75,-7774.78 1066.75,-7774.78 1062,-7771.11 1063.26,-7767.44 1069.26,-7767.44 1069.26,-7767.44 1577.76,-7767.44 1577.76,-7767.44 1583.76,-7767.44 1594.5,-7771.11 1599.25,-7774.78 1599.25,-7774.78 1717.25,-7866.1 1717.25,-7866.1 1722,-7869.77 1720.74,-7873.44 1714.74,-7873.44"/>
<text text-anchor="middle" x="1392" y="-7831.74" font-family="Times,serif" font-size="14.00">Token Router Layer 5 GPU 0</text>
<text text-anchor="middle" x="1392" y="-7816.74" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="1392" y="-7801.74" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer5_gpu0&#45;&gt;route_layer5_gpu0 -->
<g id="edge513" class="edge">
<title>gate_layer5_gpu0&#45;&gt;route_layer5_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1300.34,-7914.43C1310.87,-7903.75 1322.2,-7892.25 1333.17,-7881.12"/>
<polygon fill="black" stroke="black" points="1335.8,-7883.45 1340.32,-7873.87 1330.81,-7878.53 1335.8,-7883.45"/>
</g>
<!-- route_layer5_gpu1 -->
<g id="node457" class="node">
<title>route_layer5_gpu1</title>
<path fill="orange" stroke="black" d="M2700.74,-7873.44C2700.74,-7873.44 2192.24,-7873.44 2192.24,-7873.44 2186.24,-7873.44 2175.5,-7869.77 2170.75,-7866.1 2170.75,-7866.1 2052.75,-7774.78 2052.75,-7774.78 2048,-7771.11 2049.26,-7767.44 2055.26,-7767.44 2055.26,-7767.44 2563.76,-7767.44 2563.76,-7767.44 2569.76,-7767.44 2580.5,-7771.11 2585.25,-7774.78 2585.25,-7774.78 2703.25,-7866.1 2703.25,-7866.1 2708,-7869.77 2706.74,-7873.44 2700.74,-7873.44"/>
<text text-anchor="middle" x="2378" y="-7831.74" font-family="Times,serif" font-size="14.00">Token Router Layer 5 GPU 1</text>
<text text-anchor="middle" x="2378" y="-7816.74" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="2378" y="-7801.74" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer5_gpu1&#45;&gt;route_layer5_gpu1 -->
<g id="edge514" class="edge">
<title>gate_layer5_gpu1&#45;&gt;route_layer5_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2270.83,-7915.21C2283.54,-7904.09 2297.29,-7892.07 2310.56,-7880.45"/>
<polygon fill="black" stroke="black" points="2313.08,-7882.89 2318.31,-7873.67 2308.47,-7877.62 2313.08,-7882.89"/>
</g>
<!-- route_layer5_gpu2 -->
<g id="node459" class="node">
<title>route_layer5_gpu2</title>
<path fill="orange" stroke="black" d="M3617.74,-7873.44C3617.74,-7873.44 3109.24,-7873.44 3109.24,-7873.44 3103.24,-7873.44 3092.5,-7869.77 3087.75,-7866.1 3087.75,-7866.1 2969.75,-7774.78 2969.75,-7774.78 2965,-7771.11 2966.26,-7767.44 2972.26,-7767.44 2972.26,-7767.44 3480.76,-7767.44 3480.76,-7767.44 3486.76,-7767.44 3497.5,-7771.11 3502.25,-7774.78 3502.25,-7774.78 3620.25,-7866.1 3620.25,-7866.1 3625,-7869.77 3623.74,-7873.44 3617.74,-7873.44"/>
<text text-anchor="middle" x="3295" y="-7831.74" font-family="Times,serif" font-size="14.00">Token Router Layer 5 GPU 2</text>
<text text-anchor="middle" x="3295" y="-7816.74" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="3295" y="-7801.74" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer5_gpu2&#45;&gt;route_layer5_gpu2 -->
<g id="edge515" class="edge">
<title>gate_layer5_gpu2&#45;&gt;route_layer5_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3220.57,-7913.65C3228.83,-7903.43 3237.65,-7892.49 3246.23,-7881.86"/>
<polygon fill="black" stroke="black" points="3249.17,-7883.79 3252.73,-7873.81 3243.73,-7879.39 3249.17,-7883.79"/>
</g>
<!-- route_layer5_gpu3 -->
<g id="node461" class="node">
<title>route_layer5_gpu3</title>
<path fill="orange" stroke="black" d="M4995.74,-7873.44C4995.74,-7873.44 4487.24,-7873.44 4487.24,-7873.44 4481.24,-7873.44 4470.5,-7869.77 4465.75,-7866.1 4465.75,-7866.1 4347.75,-7774.78 4347.75,-7774.78 4343,-7771.11 4344.26,-7767.44 4350.26,-7767.44 4350.26,-7767.44 4858.76,-7767.44 4858.76,-7767.44 4864.76,-7767.44 4875.5,-7771.11 4880.25,-7774.78 4880.25,-7774.78 4998.25,-7866.1 4998.25,-7866.1 5003,-7869.77 5001.74,-7873.44 4995.74,-7873.44"/>
<text text-anchor="middle" x="4673" y="-7831.74" font-family="Times,serif" font-size="14.00">Token Router Layer 5 GPU 3</text>
<text text-anchor="middle" x="4673" y="-7816.74" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="4673" y="-7801.74" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer5_gpu3&#45;&gt;route_layer5_gpu3 -->
<g id="edge516" class="edge">
<title>gate_layer5_gpu3&#45;&gt;route_layer5_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4283.77,-7924.84C4339.79,-7909.96 4405.71,-7892.45 4467.21,-7876.11"/>
<polygon fill="black" stroke="black" points="4468.28,-7879.45 4477.04,-7873.5 4466.48,-7872.68 4468.28,-7879.45"/>
</g>
<!-- route_layer5_gpu4 -->
<g id="node463" class="node">
<title>route_layer5_gpu4</title>
<path fill="orange" stroke="black" d="M6028.74,-7873.44C6028.74,-7873.44 5520.24,-7873.44 5520.24,-7873.44 5514.24,-7873.44 5503.5,-7869.77 5498.75,-7866.1 5498.75,-7866.1 5380.75,-7774.78 5380.75,-7774.78 5376,-7771.11 5377.26,-7767.44 5383.26,-7767.44 5383.26,-7767.44 5891.76,-7767.44 5891.76,-7767.44 5897.76,-7767.44 5908.5,-7771.11 5913.25,-7774.78 5913.25,-7774.78 6031.25,-7866.1 6031.25,-7866.1 6036,-7869.77 6034.74,-7873.44 6028.74,-7873.44"/>
<text text-anchor="middle" x="5706" y="-7831.74" font-family="Times,serif" font-size="14.00">Token Router Layer 5 GPU 4</text>
<text text-anchor="middle" x="5706" y="-7816.74" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="5706" y="-7801.74" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer5_gpu4&#45;&gt;route_layer5_gpu4 -->
<g id="edge517" class="edge">
<title>gate_layer5_gpu4&#45;&gt;route_layer5_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5260.01,-7926.2C5330.45,-7909.66 5415.67,-7889.64 5492.66,-7871.55"/>
<polygon fill="black" stroke="black" points="5493.56,-7874.94 5502.5,-7869.24 5491.96,-7868.12 5493.56,-7874.94"/>
</g>
<!-- route_layer5_gpu5 -->
<g id="node465" class="node">
<title>route_layer5_gpu5</title>
<path fill="orange" stroke="black" d="M6888.74,-7873.44C6888.74,-7873.44 6380.24,-7873.44 6380.24,-7873.44 6374.24,-7873.44 6363.5,-7869.77 6358.75,-7866.1 6358.75,-7866.1 6240.75,-7774.78 6240.75,-7774.78 6236,-7771.11 6237.26,-7767.44 6243.26,-7767.44 6243.26,-7767.44 6751.76,-7767.44 6751.76,-7767.44 6757.76,-7767.44 6768.5,-7771.11 6773.25,-7774.78 6773.25,-7774.78 6891.25,-7866.1 6891.25,-7866.1 6896,-7869.77 6894.74,-7873.44 6888.74,-7873.44"/>
<text text-anchor="middle" x="6566" y="-7831.74" font-family="Times,serif" font-size="14.00">Token Router Layer 5 GPU 5</text>
<text text-anchor="middle" x="6566" y="-7816.74" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="6566" y="-7801.74" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer5_gpu5&#45;&gt;route_layer5_gpu5 -->
<g id="edge518" class="edge">
<title>gate_layer5_gpu5&#45;&gt;route_layer5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6205.2,-7924.11C6256.73,-7909.44 6316.93,-7892.31 6373.22,-7876.3"/>
<polygon fill="black" stroke="black" points="6374.29,-7879.63 6382.95,-7873.53 6372.37,-7872.9 6374.29,-7879.63"/>
</g>
<!-- route_layer5_gpu6 -->
<g id="node467" class="node">
<title>route_layer5_gpu6</title>
<path fill="orange" stroke="black" d="M7662.74,-7873.44C7662.74,-7873.44 7154.24,-7873.44 7154.24,-7873.44 7148.24,-7873.44 7137.5,-7869.77 7132.75,-7866.1 7132.75,-7866.1 7014.75,-7774.78 7014.75,-7774.78 7010,-7771.11 7011.26,-7767.44 7017.26,-7767.44 7017.26,-7767.44 7525.76,-7767.44 7525.76,-7767.44 7531.76,-7767.44 7542.5,-7771.11 7547.25,-7774.78 7547.25,-7774.78 7665.25,-7866.1 7665.25,-7866.1 7670,-7869.77 7668.74,-7873.44 7662.74,-7873.44"/>
<text text-anchor="middle" x="7340" y="-7831.74" font-family="Times,serif" font-size="14.00">Token Router Layer 5 GPU 6</text>
<text text-anchor="middle" x="7340" y="-7816.74" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="7340" y="-7801.74" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer5_gpu6&#45;&gt;route_layer5_gpu6 -->
<g id="edge519" class="edge">
<title>gate_layer5_gpu6&#45;&gt;route_layer5_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7128.61,-7919.44C7156.87,-7906.33 7188.52,-7891.66 7218.54,-7877.75"/>
<polygon fill="black" stroke="black" points="7220.2,-7880.84 7227.8,-7873.45 7217.25,-7874.49 7220.2,-7880.84"/>
</g>
<!-- route_layer5_gpu7 -->
<g id="node469" class="node">
<title>route_layer5_gpu7</title>
<path fill="orange" stroke="black" d="M8393.74,-7873.44C8393.74,-7873.44 7885.24,-7873.44 7885.24,-7873.44 7879.24,-7873.44 7868.5,-7869.77 7863.75,-7866.1 7863.75,-7866.1 7745.75,-7774.78 7745.75,-7774.78 7741,-7771.11 7742.26,-7767.44 7748.26,-7767.44 7748.26,-7767.44 8256.76,-7767.44 8256.76,-7767.44 8262.76,-7767.44 8273.5,-7771.11 8278.25,-7774.78 8278.25,-7774.78 8396.25,-7866.1 8396.25,-7866.1 8401,-7869.77 8399.74,-7873.44 8393.74,-7873.44"/>
<text text-anchor="middle" x="8071" y="-7831.74" font-family="Times,serif" font-size="14.00">Token Router Layer 5 GPU 7</text>
<text text-anchor="middle" x="8071" y="-7816.74" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="8071" y="-7801.74" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer5_gpu7&#45;&gt;route_layer5_gpu7 -->
<g id="edge520" class="edge">
<title>gate_layer5_gpu7&#45;&gt;route_layer5_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8026.33,-7912.08C8030.97,-7902.66 8035.89,-7892.68 8040.69,-7882.93"/>
<polygon fill="black" stroke="black" points="8043.97,-7884.19 8045.26,-7873.67 8037.7,-7881.1 8043.97,-7884.19"/>
</g>
<!-- route_layer5_gpu8 -->
<g id="node471" class="node">
<title>route_layer5_gpu8</title>
<path fill="orange" stroke="black" d="M9219.74,-7873.44C9219.74,-7873.44 8711.24,-7873.44 8711.24,-7873.44 8705.24,-7873.44 8694.5,-7869.77 8689.75,-7866.1 8689.75,-7866.1 8571.75,-7774.78 8571.75,-7774.78 8567,-7771.11 8568.26,-7767.44 8574.26,-7767.44 8574.26,-7767.44 9082.76,-7767.44 9082.76,-7767.44 9088.76,-7767.44 9099.5,-7771.11 9104.25,-7774.78 9104.25,-7774.78 9222.25,-7866.1 9222.25,-7866.1 9227,-7869.77 9225.74,-7873.44 9219.74,-7873.44"/>
<text text-anchor="middle" x="8897" y="-7831.74" font-family="Times,serif" font-size="14.00">Token Router Layer 5 GPU 8</text>
<text text-anchor="middle" x="8897" y="-7816.74" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="8897" y="-7801.74" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer5_gpu8&#45;&gt;route_layer5_gpu8 -->
<g id="edge521" class="edge">
<title>gate_layer5_gpu8&#45;&gt;route_layer5_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8941.67,-7912.08C8937.03,-7902.66 8932.11,-7892.68 8927.31,-7882.93"/>
<polygon fill="black" stroke="black" points="8930.3,-7881.1 8922.74,-7873.67 8924.03,-7884.19 8930.3,-7881.1"/>
</g>
<!-- route_layer5_gpu9 -->
<g id="node473" class="node">
<title>route_layer5_gpu9</title>
<path fill="orange" stroke="black" d="M10114.74,-7873.44C10114.74,-7873.44 9606.24,-7873.44 9606.24,-7873.44 9600.24,-7873.44 9589.5,-7869.77 9584.75,-7866.1 9584.75,-7866.1 9466.75,-7774.78 9466.75,-7774.78 9462,-7771.11 9463.26,-7767.44 9469.26,-7767.44 9469.26,-7767.44 9977.76,-7767.44 9977.76,-7767.44 9983.76,-7767.44 9994.5,-7771.11 9999.25,-7774.78 9999.25,-7774.78 10117.25,-7866.1 10117.25,-7866.1 10122,-7869.77 10120.74,-7873.44 10114.74,-7873.44"/>
<text text-anchor="middle" x="9792" y="-7831.74" font-family="Times,serif" font-size="14.00">Token Router Layer 5 GPU 9</text>
<text text-anchor="middle" x="9792" y="-7816.74" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="9792" y="-7801.74" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer5_gpu9&#45;&gt;route_layer5_gpu9 -->
<g id="edge522" class="edge">
<title>gate_layer5_gpu9&#45;&gt;route_layer5_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9883.66,-7914.43C9873.13,-7903.75 9861.8,-7892.25 9850.83,-7881.12"/>
<polygon fill="black" stroke="black" points="9853.19,-7878.53 9843.68,-7873.87 9848.2,-7883.45 9853.19,-7878.53"/>
</g>
<!-- route_layer5_gpu10 -->
<g id="node475" class="node">
<title>route_layer5_gpu10</title>
<path fill="orange" stroke="black" d="M11043.74,-7873.44C11043.74,-7873.44 10535.24,-7873.44 10535.24,-7873.44 10529.24,-7873.44 10518.5,-7869.77 10513.75,-7866.1 10513.75,-7866.1 10395.75,-7774.78 10395.75,-7774.78 10391,-7771.11 10392.26,-7767.44 10398.26,-7767.44 10398.26,-7767.44 10906.76,-7767.44 10906.76,-7767.44 10912.76,-7767.44 10923.5,-7771.11 10928.25,-7774.78 10928.25,-7774.78 11046.25,-7866.1 11046.25,-7866.1 11051,-7869.77 11049.74,-7873.44 11043.74,-7873.44"/>
<text text-anchor="middle" x="10721" y="-7831.74" font-family="Times,serif" font-size="14.00">Token Router Layer 5 GPU 10</text>
<text text-anchor="middle" x="10721" y="-7816.74" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="10721" y="-7801.74" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer5_gpu10&#45;&gt;route_layer5_gpu10 -->
<g id="edge523" class="edge">
<title>gate_layer5_gpu10&#45;&gt;route_layer5_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10837.35,-7915.6C10823.3,-7904.23 10808.05,-7891.89 10793.36,-7880"/>
<polygon fill="black" stroke="black" points="10795.24,-7877.02 10785.27,-7873.45 10790.84,-7882.46 10795.24,-7877.02"/>
</g>
<!-- route_layer5_gpu11 -->
<g id="node477" class="node">
<title>route_layer5_gpu11</title>
<path fill="orange" stroke="black" d="M11990.74,-7873.44C11990.74,-7873.44 11482.24,-7873.44 11482.24,-7873.44 11476.24,-7873.44 11465.5,-7869.77 11460.75,-7866.1 11460.75,-7866.1 11342.75,-7774.78 11342.75,-7774.78 11338,-7771.11 11339.26,-7767.44 11345.26,-7767.44 11345.26,-7767.44 11853.76,-7767.44 11853.76,-7767.44 11859.76,-7767.44 11870.5,-7771.11 11875.25,-7774.78 11875.25,-7774.78 11993.25,-7866.1 11993.25,-7866.1 11998,-7869.77 11996.74,-7873.44 11990.74,-7873.44"/>
<text text-anchor="middle" x="11668" y="-7831.74" font-family="Times,serif" font-size="14.00">Token Router Layer 5 GPU 11</text>
<text text-anchor="middle" x="11668" y="-7816.74" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="11668" y="-7801.74" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer5_gpu11&#45;&gt;route_layer5_gpu11 -->
<g id="edge524" class="edge">
<title>gate_layer5_gpu11&#45;&gt;route_layer5_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11796.57,-7916.18C11780.74,-7904.51 11763.47,-7891.78 11746.87,-7879.56"/>
<polygon fill="black" stroke="black" points="11748.92,-7876.72 11738.79,-7873.6 11744.77,-7882.35 11748.92,-7876.72"/>
</g>
<!-- route_layer5_gpu12 -->
<g id="node479" class="node">
<title>route_layer5_gpu12</title>
<path fill="orange" stroke="black" d="M12945.74,-7873.44C12945.74,-7873.44 12437.24,-7873.44 12437.24,-7873.44 12431.24,-7873.44 12420.5,-7869.77 12415.75,-7866.1 12415.75,-7866.1 12297.75,-7774.78 12297.75,-7774.78 12293,-7771.11 12294.26,-7767.44 12300.26,-7767.44 12300.26,-7767.44 12808.76,-7767.44 12808.76,-7767.44 12814.76,-7767.44 12825.5,-7771.11 12830.25,-7774.78 12830.25,-7774.78 12948.25,-7866.1 12948.25,-7866.1 12953,-7869.77 12951.74,-7873.44 12945.74,-7873.44"/>
<text text-anchor="middle" x="12623" y="-7831.74" font-family="Times,serif" font-size="14.00">Token Router Layer 5 GPU 12</text>
<text text-anchor="middle" x="12623" y="-7816.74" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="12623" y="-7801.74" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer5_gpu12&#45;&gt;route_layer5_gpu12 -->
<g id="edge525" class="edge">
<title>gate_layer5_gpu12&#45;&gt;route_layer5_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12758.21,-7916.57C12741.51,-7904.81 12723.25,-7891.97 12705.71,-7879.63"/>
<polygon fill="black" stroke="black" points="12707.36,-7876.51 12697.17,-7873.62 12703.34,-7882.24 12707.36,-7876.51"/>
</g>
<!-- route_layer5_gpu13 -->
<g id="node481" class="node">
<title>route_layer5_gpu13</title>
<path fill="orange" stroke="black" d="M13905.74,-7873.44C13905.74,-7873.44 13397.24,-7873.44 13397.24,-7873.44 13391.24,-7873.44 13380.5,-7869.77 13375.75,-7866.1 13375.75,-7866.1 13257.75,-7774.78 13257.75,-7774.78 13253,-7771.11 13254.26,-7767.44 13260.26,-7767.44 13260.26,-7767.44 13768.76,-7767.44 13768.76,-7767.44 13774.76,-7767.44 13785.5,-7771.11 13790.25,-7774.78 13790.25,-7774.78 13908.25,-7866.1 13908.25,-7866.1 13913,-7869.77 13911.74,-7873.44 13905.74,-7873.44"/>
<text text-anchor="middle" x="13583" y="-7831.74" font-family="Times,serif" font-size="14.00">Token Router Layer 5 GPU 13</text>
<text text-anchor="middle" x="13583" y="-7816.74" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="13583" y="-7801.74" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer5_gpu13&#45;&gt;route_layer5_gpu13 -->
<g id="edge526" class="edge">
<title>gate_layer5_gpu13&#45;&gt;route_layer5_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13720.93,-7916.57C13703.89,-7904.81 13685.27,-7891.97 13667.38,-7879.63"/>
<polygon fill="black" stroke="black" points="13668.88,-7876.42 13658.66,-7873.62 13664.91,-7882.18 13668.88,-7876.42"/>
</g>
<!-- route_layer5_gpu14 -->
<g id="node483" class="node">
<title>route_layer5_gpu14</title>
<path fill="orange" stroke="black" d="M14867.74,-7873.44C14867.74,-7873.44 14359.24,-7873.44 14359.24,-7873.44 14353.24,-7873.44 14342.5,-7869.77 14337.75,-7866.1 14337.75,-7866.1 14219.75,-7774.78 14219.75,-7774.78 14215,-7771.11 14216.26,-7767.44 14222.26,-7767.44 14222.26,-7767.44 14730.76,-7767.44 14730.76,-7767.44 14736.76,-7767.44 14747.5,-7771.11 14752.25,-7774.78 14752.25,-7774.78 14870.25,-7866.1 14870.25,-7866.1 14875,-7869.77 14873.74,-7873.44 14867.74,-7873.44"/>
<text text-anchor="middle" x="14545" y="-7831.74" font-family="Times,serif" font-size="14.00">Token Router Layer 5 GPU 14</text>
<text text-anchor="middle" x="14545" y="-7816.74" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="14545" y="-7801.74" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer5_gpu14&#45;&gt;route_layer5_gpu14 -->
<g id="edge527" class="edge">
<title>gate_layer5_gpu14&#45;&gt;route_layer5_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14684.57,-7916.76C14667.1,-7904.82 14647.96,-7891.75 14629.61,-7879.22"/>
<polygon fill="black" stroke="black" points="14631.47,-7876.25 14621.24,-7873.51 14627.52,-7882.04 14631.47,-7876.25"/>
</g>
<!-- route_layer5_gpu15 -->
<g id="node485" class="node">
<title>route_layer5_gpu15</title>
<path fill="orange" stroke="black" d="M15830.74,-7873.44C15830.74,-7873.44 15322.24,-7873.44 15322.24,-7873.44 15316.24,-7873.44 15305.5,-7869.77 15300.75,-7866.1 15300.75,-7866.1 15182.75,-7774.78 15182.75,-7774.78 15178,-7771.11 15179.26,-7767.44 15185.26,-7767.44 15185.26,-7767.44 15693.76,-7767.44 15693.76,-7767.44 15699.76,-7767.44 15710.5,-7771.11 15715.25,-7774.78 15715.25,-7774.78 15833.25,-7866.1 15833.25,-7866.1 15838,-7869.77 15836.74,-7873.44 15830.74,-7873.44"/>
<text text-anchor="middle" x="15508" y="-7831.74" font-family="Times,serif" font-size="14.00">Token Router Layer 5 GPU 15</text>
<text text-anchor="middle" x="15508" y="-7816.74" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="15508" y="-7801.74" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer5_gpu15&#45;&gt;route_layer5_gpu15 -->
<g id="edge528" class="edge">
<title>gate_layer5_gpu15&#45;&gt;route_layer5_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15648.25,-7916.76C15630.69,-7904.82 15611.46,-7891.75 15593.02,-7879.22"/>
<polygon fill="black" stroke="black" points="15594.85,-7876.23 15584.61,-7873.51 15590.91,-7882.02 15594.85,-7876.23"/>
</g>
<!-- expert_layer5_gpu0_expert0 -->
<g id="node439" class="node">
<title>expert_layer5_gpu0_expert0</title>
<path fill="lightcoral" stroke="black" d="M2019.5,-7620.49C2019.5,-7620.49 1550.5,-7620.49 1550.5,-7620.49 1544.5,-7620.49 1538.5,-7614.49 1538.5,-7608.49 1538.5,-7608.49 1538.5,-7564.49 1538.5,-7564.49 1538.5,-7558.49 1544.5,-7552.49 1550.5,-7552.49 1550.5,-7552.49 2019.5,-7552.49 2019.5,-7552.49 2025.5,-7552.49 2031.5,-7558.49 2031.5,-7564.49 2031.5,-7564.49 2031.5,-7608.49 2031.5,-7608.49 2031.5,-7614.49 2025.5,-7620.49 2019.5,-7620.49"/>
<text text-anchor="middle" x="1785" y="-7605.29" font-family="Times,serif" font-size="14.00">Expert 0 Layer 5 GPU 0</text>
<text text-anchor="middle" x="1785" y="-7590.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="1785" y="-7575.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="1785" y="-7560.29" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer5_gpu0 -->
<g id="node456" class="node">
<title>aggregate_layer5_gpu0</title>
<path fill="orange" stroke="black" d="M2019.29,-7516.49C2019.29,-7516.49 1532.19,-7516.49 1532.19,-7516.49 1526.19,-7516.49 1515.52,-7512.72 1510.85,-7508.95 1510.85,-7508.95 1398.06,-7418.02 1398.06,-7418.02 1393.38,-7414.25 1394.71,-7410.49 1400.71,-7410.49 1400.71,-7410.49 1887.81,-7410.49 1887.81,-7410.49 1893.81,-7410.49 1904.48,-7414.25 1909.15,-7418.02 1909.15,-7418.02 2021.94,-7508.95 2021.94,-7508.95 2026.62,-7512.72 2025.29,-7516.49 2019.29,-7516.49"/>
<text text-anchor="middle" x="1710" y="-7474.79" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 5 GPU 0</text>
<text text-anchor="middle" x="1710" y="-7459.79" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="1710" y="-7444.79" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer5_gpu0_expert0&#45;&gt;aggregate_layer5_gpu0 -->
<g id="edge561" class="edge">
<title>expert_layer5_gpu0_expert0&#45;&gt;aggregate_layer5_gpu0</title>
<path fill="none" stroke="black" d="M1764.51,-7552.42C1759.26,-7543.96 1753.45,-7534.58 1747.63,-7525.2"/>
<polygon fill="black" stroke="black" points="1750.55,-7523.27 1742.31,-7516.61 1744.6,-7526.96 1750.55,-7523.27"/>
</g>
<!-- expert_layer5_gpu1_expert1 -->
<g id="node440" class="node">
<title>expert_layer5_gpu1_expert1</title>
<path fill="lightcoral" stroke="black" d="M3167.5,-7620.49C3167.5,-7620.49 2698.5,-7620.49 2698.5,-7620.49 2692.5,-7620.49 2686.5,-7614.49 2686.5,-7608.49 2686.5,-7608.49 2686.5,-7564.49 2686.5,-7564.49 2686.5,-7558.49 2692.5,-7552.49 2698.5,-7552.49 2698.5,-7552.49 3167.5,-7552.49 3167.5,-7552.49 3173.5,-7552.49 3179.5,-7558.49 3179.5,-7564.49 3179.5,-7564.49 3179.5,-7608.49 3179.5,-7608.49 3179.5,-7614.49 3173.5,-7620.49 3167.5,-7620.49"/>
<text text-anchor="middle" x="2933" y="-7605.29" font-family="Times,serif" font-size="14.00">Expert 1 Layer 5 GPU 1</text>
<text text-anchor="middle" x="2933" y="-7590.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2933" y="-7575.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2933" y="-7560.29" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer5_gpu1 -->
<g id="node458" class="node">
<title>aggregate_layer5_gpu1</title>
<path fill="orange" stroke="black" d="M2831.29,-7516.49C2831.29,-7516.49 2344.19,-7516.49 2344.19,-7516.49 2338.19,-7516.49 2327.52,-7512.72 2322.85,-7508.95 2322.85,-7508.95 2210.06,-7418.02 2210.06,-7418.02 2205.38,-7414.25 2206.71,-7410.49 2212.71,-7410.49 2212.71,-7410.49 2699.81,-7410.49 2699.81,-7410.49 2705.81,-7410.49 2716.48,-7414.25 2721.15,-7418.02 2721.15,-7418.02 2833.94,-7508.95 2833.94,-7508.95 2838.62,-7512.72 2837.29,-7516.49 2831.29,-7516.49"/>
<text text-anchor="middle" x="2522" y="-7474.79" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 5 GPU 1</text>
<text text-anchor="middle" x="2522" y="-7459.79" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="2522" y="-7444.79" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer5_gpu1_expert1&#45;&gt;aggregate_layer5_gpu1 -->
<g id="edge562" class="edge">
<title>expert_layer5_gpu1_expert1&#45;&gt;aggregate_layer5_gpu1</title>
<path fill="none" stroke="black" d="M2820.69,-7552.42C2785.96,-7542.2 2746.73,-7530.65 2708.39,-7519.36"/>
<polygon fill="black" stroke="black" points="2709.25,-7515.96 2698.67,-7516.5 2707.27,-7522.68 2709.25,-7515.96"/>
</g>
<!-- expert_layer5_gpu2_expert2 -->
<g id="node441" class="node">
<title>expert_layer5_gpu2_expert2</title>
<path fill="lightcoral" stroke="black" d="M4567.5,-7620.49C4567.5,-7620.49 4098.5,-7620.49 4098.5,-7620.49 4092.5,-7620.49 4086.5,-7614.49 4086.5,-7608.49 4086.5,-7608.49 4086.5,-7564.49 4086.5,-7564.49 4086.5,-7558.49 4092.5,-7552.49 4098.5,-7552.49 4098.5,-7552.49 4567.5,-7552.49 4567.5,-7552.49 4573.5,-7552.49 4579.5,-7558.49 4579.5,-7564.49 4579.5,-7564.49 4579.5,-7608.49 4579.5,-7608.49 4579.5,-7614.49 4573.5,-7620.49 4567.5,-7620.49"/>
<text text-anchor="middle" x="4333" y="-7605.29" font-family="Times,serif" font-size="14.00">Expert 2 Layer 5 GPU 2</text>
<text text-anchor="middle" x="4333" y="-7590.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4333" y="-7575.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4333" y="-7560.29" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer5_gpu2 -->
<g id="node460" class="node">
<title>aggregate_layer5_gpu2</title>
<path fill="orange" stroke="black" d="M4413.29,-7516.49C4413.29,-7516.49 3926.19,-7516.49 3926.19,-7516.49 3920.19,-7516.49 3909.52,-7512.72 3904.85,-7508.95 3904.85,-7508.95 3792.06,-7418.02 3792.06,-7418.02 3787.38,-7414.25 3788.71,-7410.49 3794.71,-7410.49 3794.71,-7410.49 4281.81,-7410.49 4281.81,-7410.49 4287.81,-7410.49 4298.48,-7414.25 4303.15,-7418.02 4303.15,-7418.02 4415.94,-7508.95 4415.94,-7508.95 4420.62,-7512.72 4419.29,-7516.49 4413.29,-7516.49"/>
<text text-anchor="middle" x="4104" y="-7474.79" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 5 GPU 2</text>
<text text-anchor="middle" x="4104" y="-7459.79" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="4104" y="-7444.79" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer5_gpu2_expert2&#45;&gt;aggregate_layer5_gpu2 -->
<g id="edge563" class="edge">
<title>expert_layer5_gpu2_expert2&#45;&gt;aggregate_layer5_gpu2</title>
<path fill="none" stroke="black" d="M4270.42,-7552.42C4252.2,-7542.79 4231.75,-7531.98 4211.58,-7521.33"/>
<polygon fill="black" stroke="black" points="4213.13,-7518.19 4202.65,-7516.61 4209.86,-7524.38 4213.13,-7518.19"/>
</g>
<!-- expert_layer5_gpu3_expert3 -->
<g id="node442" class="node">
<title>expert_layer5_gpu3_expert3</title>
<path fill="lightcoral" stroke="black" d="M5400.5,-7620.49C5400.5,-7620.49 4931.5,-7620.49 4931.5,-7620.49 4925.5,-7620.49 4919.5,-7614.49 4919.5,-7608.49 4919.5,-7608.49 4919.5,-7564.49 4919.5,-7564.49 4919.5,-7558.49 4925.5,-7552.49 4931.5,-7552.49 4931.5,-7552.49 5400.5,-7552.49 5400.5,-7552.49 5406.5,-7552.49 5412.5,-7558.49 5412.5,-7564.49 5412.5,-7564.49 5412.5,-7608.49 5412.5,-7608.49 5412.5,-7614.49 5406.5,-7620.49 5400.5,-7620.49"/>
<text text-anchor="middle" x="5166" y="-7605.29" font-family="Times,serif" font-size="14.00">Expert 3 Layer 5 GPU 3</text>
<text text-anchor="middle" x="5166" y="-7590.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5166" y="-7575.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5166" y="-7560.29" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer5_gpu3 -->
<g id="node462" class="node">
<title>aggregate_layer5_gpu3</title>
<path fill="orange" stroke="black" d="M5350.29,-7516.49C5350.29,-7516.49 4863.19,-7516.49 4863.19,-7516.49 4857.19,-7516.49 4846.52,-7512.72 4841.85,-7508.95 4841.85,-7508.95 4729.06,-7418.02 4729.06,-7418.02 4724.38,-7414.25 4725.71,-7410.49 4731.71,-7410.49 4731.71,-7410.49 5218.81,-7410.49 5218.81,-7410.49 5224.81,-7410.49 5235.48,-7414.25 5240.15,-7418.02 5240.15,-7418.02 5352.94,-7508.95 5352.94,-7508.95 5357.62,-7512.72 5356.29,-7516.49 5350.29,-7516.49"/>
<text text-anchor="middle" x="5041" y="-7474.79" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 5 GPU 3</text>
<text text-anchor="middle" x="5041" y="-7459.79" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="5041" y="-7444.79" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer5_gpu3_expert3&#45;&gt;aggregate_layer5_gpu3 -->
<g id="edge564" class="edge">
<title>expert_layer5_gpu3_expert3&#45;&gt;aggregate_layer5_gpu3</title>
<path fill="none" stroke="black" d="M5131.84,-7552.42C5122.65,-7543.53 5112.42,-7533.63 5102.24,-7523.77"/>
<polygon fill="black" stroke="black" points="5104.47,-7521.05 5094.85,-7516.61 5099.6,-7526.08 5104.47,-7521.05"/>
</g>
<!-- expert_layer5_gpu4_expert4 -->
<g id="node443" class="node">
<title>expert_layer5_gpu4_expert4</title>
<path fill="lightcoral" stroke="black" d="M6383.5,-7620.49C6383.5,-7620.49 5914.5,-7620.49 5914.5,-7620.49 5908.5,-7620.49 5902.5,-7614.49 5902.5,-7608.49 5902.5,-7608.49 5902.5,-7564.49 5902.5,-7564.49 5902.5,-7558.49 5908.5,-7552.49 5914.5,-7552.49 5914.5,-7552.49 6383.5,-7552.49 6383.5,-7552.49 6389.5,-7552.49 6395.5,-7558.49 6395.5,-7564.49 6395.5,-7564.49 6395.5,-7608.49 6395.5,-7608.49 6395.5,-7614.49 6389.5,-7620.49 6383.5,-7620.49"/>
<text text-anchor="middle" x="6149" y="-7605.29" font-family="Times,serif" font-size="14.00">Expert 4 Layer 5 GPU 4</text>
<text text-anchor="middle" x="6149" y="-7590.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6149" y="-7575.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6149" y="-7560.29" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer5_gpu4 -->
<g id="node464" class="node">
<title>aggregate_layer5_gpu4</title>
<path fill="orange" stroke="black" d="M6195.29,-7516.49C6195.29,-7516.49 5708.19,-7516.49 5708.19,-7516.49 5702.19,-7516.49 5691.52,-7512.72 5686.85,-7508.95 5686.85,-7508.95 5574.06,-7418.02 5574.06,-7418.02 5569.38,-7414.25 5570.71,-7410.49 5576.71,-7410.49 5576.71,-7410.49 6063.81,-7410.49 6063.81,-7410.49 6069.81,-7410.49 6080.48,-7414.25 6085.15,-7418.02 6085.15,-7418.02 6197.94,-7508.95 6197.94,-7508.95 6202.62,-7512.72 6201.29,-7516.49 6195.29,-7516.49"/>
<text text-anchor="middle" x="5886" y="-7474.79" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 5 GPU 4</text>
<text text-anchor="middle" x="5886" y="-7459.79" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="5886" y="-7444.79" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer5_gpu4_expert4&#45;&gt;aggregate_layer5_gpu4 -->
<g id="edge565" class="edge">
<title>expert_layer5_gpu4_expert4&#45;&gt;aggregate_layer5_gpu4</title>
<path fill="none" stroke="black" d="M6077.13,-7552.42C6055.85,-7542.63 6031.93,-7531.62 6008.39,-7520.8"/>
<polygon fill="black" stroke="black" points="6009.6,-7517.5 5999.05,-7516.5 6006.67,-7523.86 6009.6,-7517.5"/>
</g>
<!-- expert_layer5_gpu5_expert5 -->
<g id="node444" class="node">
<title>expert_layer5_gpu5_expert5</title>
<path fill="lightcoral" stroke="black" d="M7130.5,-7620.49C7130.5,-7620.49 6661.5,-7620.49 6661.5,-7620.49 6655.5,-7620.49 6649.5,-7614.49 6649.5,-7608.49 6649.5,-7608.49 6649.5,-7564.49 6649.5,-7564.49 6649.5,-7558.49 6655.5,-7552.49 6661.5,-7552.49 6661.5,-7552.49 7130.5,-7552.49 7130.5,-7552.49 7136.5,-7552.49 7142.5,-7558.49 7142.5,-7564.49 7142.5,-7564.49 7142.5,-7608.49 7142.5,-7608.49 7142.5,-7614.49 7136.5,-7620.49 7130.5,-7620.49"/>
<text text-anchor="middle" x="6896" y="-7605.29" font-family="Times,serif" font-size="14.00">Expert 5 Layer 5 GPU 5</text>
<text text-anchor="middle" x="6896" y="-7590.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6896" y="-7575.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6896" y="-7560.29" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer5_gpu5 -->
<g id="node466" class="node">
<title>aggregate_layer5_gpu5</title>
<path fill="orange" stroke="black" d="M6948.29,-7516.49C6948.29,-7516.49 6461.19,-7516.49 6461.19,-7516.49 6455.19,-7516.49 6444.52,-7512.72 6439.85,-7508.95 6439.85,-7508.95 6327.06,-7418.02 6327.06,-7418.02 6322.38,-7414.25 6323.71,-7410.49 6329.71,-7410.49 6329.71,-7410.49 6816.81,-7410.49 6816.81,-7410.49 6822.81,-7410.49 6833.48,-7414.25 6838.15,-7418.02 6838.15,-7418.02 6950.94,-7508.95 6950.94,-7508.95 6955.62,-7512.72 6954.29,-7516.49 6948.29,-7516.49"/>
<text text-anchor="middle" x="6639" y="-7474.79" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 5 GPU 5</text>
<text text-anchor="middle" x="6639" y="-7459.79" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="6639" y="-7444.79" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer5_gpu5_expert5&#45;&gt;aggregate_layer5_gpu5 -->
<g id="edge566" class="edge">
<title>expert_layer5_gpu5_expert5&#45;&gt;aggregate_layer5_gpu5</title>
<path fill="none" stroke="black" d="M6825.77,-7552.42C6805.04,-7542.66 6781.75,-7531.69 6758.82,-7520.9"/>
<polygon fill="black" stroke="black" points="6760.25,-7517.71 6749.72,-7516.61 6757.27,-7524.04 6760.25,-7517.71"/>
</g>
<!-- expert_layer5_gpu6_expert6 -->
<g id="node445" class="node">
<title>expert_layer5_gpu6_expert6</title>
<path fill="lightcoral" stroke="black" d="M7759.5,-7620.49C7759.5,-7620.49 7290.5,-7620.49 7290.5,-7620.49 7284.5,-7620.49 7278.5,-7614.49 7278.5,-7608.49 7278.5,-7608.49 7278.5,-7564.49 7278.5,-7564.49 7278.5,-7558.49 7284.5,-7552.49 7290.5,-7552.49 7290.5,-7552.49 7759.5,-7552.49 7759.5,-7552.49 7765.5,-7552.49 7771.5,-7558.49 7771.5,-7564.49 7771.5,-7564.49 7771.5,-7608.49 7771.5,-7608.49 7771.5,-7614.49 7765.5,-7620.49 7759.5,-7620.49"/>
<text text-anchor="middle" x="7525" y="-7605.29" font-family="Times,serif" font-size="14.00">Expert 6 Layer 5 GPU 6</text>
<text text-anchor="middle" x="7525" y="-7590.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7525" y="-7575.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7525" y="-7560.29" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer5_gpu6 -->
<g id="node468" class="node">
<title>aggregate_layer5_gpu6</title>
<path fill="orange" stroke="black" d="M7655.29,-7516.49C7655.29,-7516.49 7168.19,-7516.49 7168.19,-7516.49 7162.19,-7516.49 7151.52,-7512.72 7146.85,-7508.95 7146.85,-7508.95 7034.06,-7418.02 7034.06,-7418.02 7029.38,-7414.25 7030.71,-7410.49 7036.71,-7410.49 7036.71,-7410.49 7523.81,-7410.49 7523.81,-7410.49 7529.81,-7410.49 7540.48,-7414.25 7545.15,-7418.02 7545.15,-7418.02 7657.94,-7508.95 7657.94,-7508.95 7662.62,-7512.72 7661.29,-7516.49 7655.29,-7516.49"/>
<text text-anchor="middle" x="7346" y="-7474.79" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 5 GPU 6</text>
<text text-anchor="middle" x="7346" y="-7459.79" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="7346" y="-7444.79" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer5_gpu6_expert6&#45;&gt;aggregate_layer5_gpu6 -->
<g id="edge567" class="edge">
<title>expert_layer5_gpu6_expert6&#45;&gt;aggregate_layer5_gpu6</title>
<path fill="none" stroke="black" d="M7476.09,-7552.42C7462.29,-7543.09 7446.86,-7532.66 7431.58,-7522.33"/>
<polygon fill="black" stroke="black" points="7433.36,-7519.31 7423.11,-7516.61 7429.44,-7525.11 7433.36,-7519.31"/>
</g>
<!-- expert_layer5_gpu7_expert7 -->
<g id="node446" class="node">
<title>expert_layer5_gpu7_expert7</title>
<path fill="lightcoral" stroke="black" d="M8329.5,-7620.49C8329.5,-7620.49 7860.5,-7620.49 7860.5,-7620.49 7854.5,-7620.49 7848.5,-7614.49 7848.5,-7608.49 7848.5,-7608.49 7848.5,-7564.49 7848.5,-7564.49 7848.5,-7558.49 7854.5,-7552.49 7860.5,-7552.49 7860.5,-7552.49 8329.5,-7552.49 8329.5,-7552.49 8335.5,-7552.49 8341.5,-7558.49 8341.5,-7564.49 8341.5,-7564.49 8341.5,-7608.49 8341.5,-7608.49 8341.5,-7614.49 8335.5,-7620.49 8329.5,-7620.49"/>
<text text-anchor="middle" x="8095" y="-7605.29" font-family="Times,serif" font-size="14.00">Expert 7 Layer 5 GPU 7</text>
<text text-anchor="middle" x="8095" y="-7590.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8095" y="-7575.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8095" y="-7560.29" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer5_gpu7 -->
<g id="node470" class="node">
<title>aggregate_layer5_gpu7</title>
<path fill="orange" stroke="black" d="M8339.29,-7516.49C8339.29,-7516.49 7852.19,-7516.49 7852.19,-7516.49 7846.19,-7516.49 7835.52,-7512.72 7830.85,-7508.95 7830.85,-7508.95 7718.06,-7418.02 7718.06,-7418.02 7713.38,-7414.25 7714.71,-7410.49 7720.71,-7410.49 7720.71,-7410.49 8207.81,-7410.49 8207.81,-7410.49 8213.81,-7410.49 8224.48,-7414.25 8229.15,-7418.02 8229.15,-7418.02 8341.94,-7508.95 8341.94,-7508.95 8346.62,-7512.72 8345.29,-7516.49 8339.29,-7516.49"/>
<text text-anchor="middle" x="8030" y="-7474.79" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 5 GPU 7</text>
<text text-anchor="middle" x="8030" y="-7459.79" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="8030" y="-7444.79" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer5_gpu7_expert7&#45;&gt;aggregate_layer5_gpu7 -->
<g id="edge568" class="edge">
<title>expert_layer5_gpu7_expert7&#45;&gt;aggregate_layer5_gpu7</title>
<path fill="none" stroke="black" d="M8077.24,-7552.42C8072.74,-7544.04 8067.76,-7534.78 8062.77,-7525.49"/>
<polygon fill="black" stroke="black" points="8065.82,-7523.77 8058,-7516.61 8059.65,-7527.08 8065.82,-7523.77"/>
</g>
<!-- expert_layer5_gpu8_expert8 -->
<g id="node447" class="node">
<title>expert_layer5_gpu8_expert8</title>
<path fill="lightcoral" stroke="black" d="M8969.5,-7620.49C8969.5,-7620.49 8500.5,-7620.49 8500.5,-7620.49 8494.5,-7620.49 8488.5,-7614.49 8488.5,-7608.49 8488.5,-7608.49 8488.5,-7564.49 8488.5,-7564.49 8488.5,-7558.49 8494.5,-7552.49 8500.5,-7552.49 8500.5,-7552.49 8969.5,-7552.49 8969.5,-7552.49 8975.5,-7552.49 8981.5,-7558.49 8981.5,-7564.49 8981.5,-7564.49 8981.5,-7608.49 8981.5,-7608.49 8981.5,-7614.49 8975.5,-7620.49 8969.5,-7620.49"/>
<text text-anchor="middle" x="8735" y="-7605.29" font-family="Times,serif" font-size="14.00">Expert 8 Layer 5 GPU 8</text>
<text text-anchor="middle" x="8735" y="-7590.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8735" y="-7575.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8735" y="-7560.29" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer5_gpu8 -->
<g id="node472" class="node">
<title>aggregate_layer5_gpu8</title>
<path fill="orange" stroke="black" d="M9109.29,-7516.49C9109.29,-7516.49 8622.19,-7516.49 8622.19,-7516.49 8616.19,-7516.49 8605.52,-7512.72 8600.85,-7508.95 8600.85,-7508.95 8488.06,-7418.02 8488.06,-7418.02 8483.38,-7414.25 8484.71,-7410.49 8490.71,-7410.49 8490.71,-7410.49 8977.81,-7410.49 8977.81,-7410.49 8983.81,-7410.49 8994.48,-7414.25 8999.15,-7418.02 8999.15,-7418.02 9111.94,-7508.95 9111.94,-7508.95 9116.62,-7512.72 9115.29,-7516.49 9109.29,-7516.49"/>
<text text-anchor="middle" x="8800" y="-7474.79" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 5 GPU 8</text>
<text text-anchor="middle" x="8800" y="-7459.79" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="8800" y="-7444.79" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer5_gpu8_expert8&#45;&gt;aggregate_layer5_gpu8 -->
<g id="edge569" class="edge">
<title>expert_layer5_gpu8_expert8&#45;&gt;aggregate_layer5_gpu8</title>
<path fill="none" stroke="black" d="M8752.76,-7552.42C8757.26,-7544.04 8762.24,-7534.78 8767.23,-7525.49"/>
<polygon fill="black" stroke="black" points="8770.35,-7527.08 8772,-7516.61 8764.18,-7523.77 8770.35,-7527.08"/>
</g>
<!-- expert_layer5_gpu9_expert9 -->
<g id="node448" class="node">
<title>expert_layer5_gpu9_expert9</title>
<path fill="lightcoral" stroke="black" d="M9695.5,-7620.49C9695.5,-7620.49 9226.5,-7620.49 9226.5,-7620.49 9220.5,-7620.49 9214.5,-7614.49 9214.5,-7608.49 9214.5,-7608.49 9214.5,-7564.49 9214.5,-7564.49 9214.5,-7558.49 9220.5,-7552.49 9226.5,-7552.49 9226.5,-7552.49 9695.5,-7552.49 9695.5,-7552.49 9701.5,-7552.49 9707.5,-7558.49 9707.5,-7564.49 9707.5,-7564.49 9707.5,-7608.49 9707.5,-7608.49 9707.5,-7614.49 9701.5,-7620.49 9695.5,-7620.49"/>
<text text-anchor="middle" x="9461" y="-7605.29" font-family="Times,serif" font-size="14.00">Expert 9 Layer 5 GPU 9</text>
<text text-anchor="middle" x="9461" y="-7590.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9461" y="-7575.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9461" y="-7560.29" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer5_gpu9 -->
<g id="node474" class="node">
<title>aggregate_layer5_gpu9</title>
<path fill="orange" stroke="black" d="M9921.29,-7516.49C9921.29,-7516.49 9434.19,-7516.49 9434.19,-7516.49 9428.19,-7516.49 9417.52,-7512.72 9412.85,-7508.95 9412.85,-7508.95 9300.06,-7418.02 9300.06,-7418.02 9295.38,-7414.25 9296.71,-7410.49 9302.71,-7410.49 9302.71,-7410.49 9789.81,-7410.49 9789.81,-7410.49 9795.81,-7410.49 9806.48,-7414.25 9811.15,-7418.02 9811.15,-7418.02 9923.94,-7508.95 9923.94,-7508.95 9928.62,-7512.72 9927.29,-7516.49 9921.29,-7516.49"/>
<text text-anchor="middle" x="9612" y="-7474.79" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 5 GPU 9</text>
<text text-anchor="middle" x="9612" y="-7459.79" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="9612" y="-7444.79" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer5_gpu9_expert9&#45;&gt;aggregate_layer5_gpu9 -->
<g id="edge570" class="edge">
<title>expert_layer5_gpu9_expert9&#45;&gt;aggregate_layer5_gpu9</title>
<path fill="none" stroke="black" d="M9502.26,-7552.42C9513.69,-7543.27 9526.44,-7533.05 9539.09,-7522.91"/>
<polygon fill="black" stroke="black" points="9541.33,-7525.6 9546.95,-7516.61 9536.96,-7520.14 9541.33,-7525.6"/>
</g>
<!-- expert_layer5_gpu10_expert10 -->
<g id="node449" class="node">
<title>expert_layer5_gpu10_expert10</title>
<path fill="lightcoral" stroke="black" d="M10427.5,-7620.49C10427.5,-7620.49 9958.5,-7620.49 9958.5,-7620.49 9952.5,-7620.49 9946.5,-7614.49 9946.5,-7608.49 9946.5,-7608.49 9946.5,-7564.49 9946.5,-7564.49 9946.5,-7558.49 9952.5,-7552.49 9958.5,-7552.49 9958.5,-7552.49 10427.5,-7552.49 10427.5,-7552.49 10433.5,-7552.49 10439.5,-7558.49 10439.5,-7564.49 10439.5,-7564.49 10439.5,-7608.49 10439.5,-7608.49 10439.5,-7614.49 10433.5,-7620.49 10427.5,-7620.49"/>
<text text-anchor="middle" x="10193" y="-7605.29" font-family="Times,serif" font-size="14.00">Expert 10 Layer 5 GPU 10</text>
<text text-anchor="middle" x="10193" y="-7590.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10193" y="-7575.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10193" y="-7560.29" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer5_gpu10 -->
<g id="node476" class="node">
<title>aggregate_layer5_gpu10</title>
<path fill="orange" stroke="black" d="M10658.29,-7516.49C10658.29,-7516.49 10171.19,-7516.49 10171.19,-7516.49 10165.19,-7516.49 10154.52,-7512.72 10149.85,-7508.95 10149.85,-7508.95 10037.06,-7418.02 10037.06,-7418.02 10032.38,-7414.25 10033.71,-7410.49 10039.71,-7410.49 10039.71,-7410.49 10526.81,-7410.49 10526.81,-7410.49 10532.81,-7410.49 10543.48,-7414.25 10548.15,-7418.02 10548.15,-7418.02 10660.94,-7508.95 10660.94,-7508.95 10665.62,-7512.72 10664.29,-7516.49 10658.29,-7516.49"/>
<text text-anchor="middle" x="10349" y="-7474.79" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 5 GPU 10</text>
<text text-anchor="middle" x="10349" y="-7459.79" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="10349" y="-7444.79" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer5_gpu10_expert10&#45;&gt;aggregate_layer5_gpu10 -->
<g id="edge571" class="edge">
<title>expert_layer5_gpu10_expert10&#45;&gt;aggregate_layer5_gpu10</title>
<path fill="none" stroke="black" d="M10235.63,-7552.42C10247.43,-7543.27 10260.61,-7533.05 10273.68,-7522.91"/>
<polygon fill="black" stroke="black" points="10276.04,-7525.51 10281.8,-7516.61 10271.75,-7519.98 10276.04,-7525.51"/>
</g>
<!-- expert_layer5_gpu11_expert11 -->
<g id="node450" class="node">
<title>expert_layer5_gpu11_expert11</title>
<path fill="lightcoral" stroke="black" d="M11299.5,-7620.49C11299.5,-7620.49 10830.5,-7620.49 10830.5,-7620.49 10824.5,-7620.49 10818.5,-7614.49 10818.5,-7608.49 10818.5,-7608.49 10818.5,-7564.49 10818.5,-7564.49 10818.5,-7558.49 10824.5,-7552.49 10830.5,-7552.49 10830.5,-7552.49 11299.5,-7552.49 11299.5,-7552.49 11305.5,-7552.49 11311.5,-7558.49 11311.5,-7564.49 11311.5,-7564.49 11311.5,-7608.49 11311.5,-7608.49 11311.5,-7614.49 11305.5,-7620.49 11299.5,-7620.49"/>
<text text-anchor="middle" x="11065" y="-7605.29" font-family="Times,serif" font-size="14.00">Expert 11 Layer 5 GPU 11</text>
<text text-anchor="middle" x="11065" y="-7590.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11065" y="-7575.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11065" y="-7560.29" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer5_gpu11 -->
<g id="node478" class="node">
<title>aggregate_layer5_gpu11</title>
<path fill="orange" stroke="black" d="M11671.29,-7516.49C11671.29,-7516.49 11184.19,-7516.49 11184.19,-7516.49 11178.19,-7516.49 11167.52,-7512.72 11162.85,-7508.95 11162.85,-7508.95 11050.06,-7418.02 11050.06,-7418.02 11045.38,-7414.25 11046.71,-7410.49 11052.71,-7410.49 11052.71,-7410.49 11539.81,-7410.49 11539.81,-7410.49 11545.81,-7410.49 11556.48,-7414.25 11561.15,-7418.02 11561.15,-7418.02 11673.94,-7508.95 11673.94,-7508.95 11678.62,-7512.72 11677.29,-7516.49 11671.29,-7516.49"/>
<text text-anchor="middle" x="11362" y="-7474.79" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 5 GPU 11</text>
<text text-anchor="middle" x="11362" y="-7459.79" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="11362" y="-7444.79" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer5_gpu11_expert11&#45;&gt;aggregate_layer5_gpu11 -->
<g id="edge572" class="edge">
<title>expert_layer5_gpu11_expert11&#45;&gt;aggregate_layer5_gpu11</title>
<path fill="none" stroke="black" d="M11146.16,-7552.42C11170.51,-7542.5 11197.92,-7531.33 11224.84,-7520.37"/>
<polygon fill="black" stroke="black" points="11226.39,-7523.51 11234.34,-7516.5 11223.75,-7517.03 11226.39,-7523.51"/>
</g>
<!-- expert_layer5_gpu12_expert12 -->
<g id="node451" class="node">
<title>expert_layer5_gpu12_expert12</title>
<path fill="lightcoral" stroke="black" d="M12154.5,-7620.49C12154.5,-7620.49 11685.5,-7620.49 11685.5,-7620.49 11679.5,-7620.49 11673.5,-7614.49 11673.5,-7608.49 11673.5,-7608.49 11673.5,-7564.49 11673.5,-7564.49 11673.5,-7558.49 11679.5,-7552.49 11685.5,-7552.49 11685.5,-7552.49 12154.5,-7552.49 12154.5,-7552.49 12160.5,-7552.49 12166.5,-7558.49 12166.5,-7564.49 12166.5,-7564.49 12166.5,-7608.49 12166.5,-7608.49 12166.5,-7614.49 12160.5,-7620.49 12154.5,-7620.49"/>
<text text-anchor="middle" x="11920" y="-7605.29" font-family="Times,serif" font-size="14.00">Expert 12 Layer 5 GPU 12</text>
<text text-anchor="middle" x="11920" y="-7590.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11920" y="-7575.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11920" y="-7560.29" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer5_gpu12 -->
<g id="node480" class="node">
<title>aggregate_layer5_gpu12</title>
<path fill="orange" stroke="black" d="M12508.29,-7516.49C12508.29,-7516.49 12021.19,-7516.49 12021.19,-7516.49 12015.19,-7516.49 12004.52,-7512.72 11999.85,-7508.95 11999.85,-7508.95 11887.06,-7418.02 11887.06,-7418.02 11882.38,-7414.25 11883.71,-7410.49 11889.71,-7410.49 11889.71,-7410.49 12376.81,-7410.49 12376.81,-7410.49 12382.81,-7410.49 12393.48,-7414.25 12398.15,-7418.02 12398.15,-7418.02 12510.94,-7508.95 12510.94,-7508.95 12515.62,-7512.72 12514.29,-7516.49 12508.29,-7516.49"/>
<text text-anchor="middle" x="12199" y="-7474.79" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 5 GPU 12</text>
<text text-anchor="middle" x="12199" y="-7459.79" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="12199" y="-7444.79" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer5_gpu12_expert12&#45;&gt;aggregate_layer5_gpu12 -->
<g id="edge573" class="edge">
<title>expert_layer5_gpu12_expert12&#45;&gt;aggregate_layer5_gpu12</title>
<path fill="none" stroke="black" d="M11996.24,-7552.42C12019.01,-7542.55 12044.64,-7531.43 12069.82,-7520.51"/>
<polygon fill="black" stroke="black" points="12071.29,-7523.69 12079.07,-7516.5 12068.51,-7517.27 12071.29,-7523.69"/>
</g>
<!-- expert_layer5_gpu13_expert13 -->
<g id="node452" class="node">
<title>expert_layer5_gpu13_expert13</title>
<path fill="lightcoral" stroke="black" d="M12956.5,-7620.49C12956.5,-7620.49 12487.5,-7620.49 12487.5,-7620.49 12481.5,-7620.49 12475.5,-7614.49 12475.5,-7608.49 12475.5,-7608.49 12475.5,-7564.49 12475.5,-7564.49 12475.5,-7558.49 12481.5,-7552.49 12487.5,-7552.49 12487.5,-7552.49 12956.5,-7552.49 12956.5,-7552.49 12962.5,-7552.49 12968.5,-7558.49 12968.5,-7564.49 12968.5,-7564.49 12968.5,-7608.49 12968.5,-7608.49 12968.5,-7614.49 12962.5,-7620.49 12956.5,-7620.49"/>
<text text-anchor="middle" x="12722" y="-7605.29" font-family="Times,serif" font-size="14.00">Expert 13 Layer 5 GPU 13</text>
<text text-anchor="middle" x="12722" y="-7590.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12722" y="-7575.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12722" y="-7560.29" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer5_gpu13 -->
<g id="node482" class="node">
<title>aggregate_layer5_gpu13</title>
<path fill="orange" stroke="black" d="M13257.29,-7516.49C13257.29,-7516.49 12770.19,-7516.49 12770.19,-7516.49 12764.19,-7516.49 12753.52,-7512.72 12748.85,-7508.95 12748.85,-7508.95 12636.06,-7418.02 12636.06,-7418.02 12631.38,-7414.25 12632.71,-7410.49 12638.71,-7410.49 12638.71,-7410.49 13125.81,-7410.49 13125.81,-7410.49 13131.81,-7410.49 13142.48,-7414.25 13147.15,-7418.02 13147.15,-7418.02 13259.94,-7508.95 13259.94,-7508.95 13264.62,-7512.72 13263.29,-7516.49 13257.29,-7516.49"/>
<text text-anchor="middle" x="12948" y="-7474.79" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 5 GPU 13</text>
<text text-anchor="middle" x="12948" y="-7459.79" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="12948" y="-7444.79" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer5_gpu13_expert13&#45;&gt;aggregate_layer5_gpu13 -->
<g id="edge574" class="edge">
<title>expert_layer5_gpu13_expert13&#45;&gt;aggregate_layer5_gpu13</title>
<path fill="none" stroke="black" d="M12783.76,-7552.42C12801.66,-7542.84 12821.75,-7532.08 12841.56,-7521.47"/>
<polygon fill="black" stroke="black" points="12843.48,-7524.42 12850.64,-7516.61 12840.17,-7518.25 12843.48,-7524.42"/>
</g>
<!-- expert_layer5_gpu14_expert14 -->
<g id="node453" class="node">
<title>expert_layer5_gpu14_expert14</title>
<path fill="lightcoral" stroke="black" d="M13958.5,-7620.49C13958.5,-7620.49 13489.5,-7620.49 13489.5,-7620.49 13483.5,-7620.49 13477.5,-7614.49 13477.5,-7608.49 13477.5,-7608.49 13477.5,-7564.49 13477.5,-7564.49 13477.5,-7558.49 13483.5,-7552.49 13489.5,-7552.49 13489.5,-7552.49 13958.5,-7552.49 13958.5,-7552.49 13964.5,-7552.49 13970.5,-7558.49 13970.5,-7564.49 13970.5,-7564.49 13970.5,-7608.49 13970.5,-7608.49 13970.5,-7614.49 13964.5,-7620.49 13958.5,-7620.49"/>
<text text-anchor="middle" x="13724" y="-7605.29" font-family="Times,serif" font-size="14.00">Expert 14 Layer 5 GPU 14</text>
<text text-anchor="middle" x="13724" y="-7590.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="13724" y="-7575.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="13724" y="-7560.29" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer5_gpu14 -->
<g id="node484" class="node">
<title>aggregate_layer5_gpu14</title>
<path fill="orange" stroke="black" d="M14460.29,-7516.49C14460.29,-7516.49 13973.19,-7516.49 13973.19,-7516.49 13967.19,-7516.49 13956.52,-7512.72 13951.85,-7508.95 13951.85,-7508.95 13839.06,-7418.02 13839.06,-7418.02 13834.38,-7414.25 13835.71,-7410.49 13841.71,-7410.49 13841.71,-7410.49 14328.81,-7410.49 14328.81,-7410.49 14334.81,-7410.49 14345.48,-7414.25 14350.15,-7418.02 14350.15,-7418.02 14462.94,-7508.95 14462.94,-7508.95 14467.62,-7512.72 14466.29,-7516.49 14460.29,-7516.49"/>
<text text-anchor="middle" x="14151" y="-7474.79" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 5 GPU 14</text>
<text text-anchor="middle" x="14151" y="-7459.79" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="14151" y="-7444.79" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer5_gpu14_expert14&#45;&gt;aggregate_layer5_gpu14 -->
<g id="edge575" class="edge">
<title>expert_layer5_gpu14_expert14&#45;&gt;aggregate_layer5_gpu14</title>
<path fill="none" stroke="black" d="M13840.68,-7552.42C13876.84,-7542.18 13917.69,-7530.6 13957.6,-7519.29"/>
<polygon fill="black" stroke="black" points="13958.79,-7522.59 13967.45,-7516.5 13956.88,-7515.86 13958.79,-7522.59"/>
</g>
<!-- expert_layer5_gpu15_expert15 -->
<g id="node454" class="node">
<title>expert_layer5_gpu15_expert15</title>
<path fill="lightcoral" stroke="black" d="M15001.5,-7620.49C15001.5,-7620.49 14532.5,-7620.49 14532.5,-7620.49 14526.5,-7620.49 14520.5,-7614.49 14520.5,-7608.49 14520.5,-7608.49 14520.5,-7564.49 14520.5,-7564.49 14520.5,-7558.49 14526.5,-7552.49 14532.5,-7552.49 14532.5,-7552.49 15001.5,-7552.49 15001.5,-7552.49 15007.5,-7552.49 15013.5,-7558.49 15013.5,-7564.49 15013.5,-7564.49 15013.5,-7608.49 15013.5,-7608.49 15013.5,-7614.49 15007.5,-7620.49 15001.5,-7620.49"/>
<text text-anchor="middle" x="14767" y="-7605.29" font-family="Times,serif" font-size="14.00">Expert 15 Layer 5 GPU 15</text>
<text text-anchor="middle" x="14767" y="-7590.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14767" y="-7575.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14767" y="-7560.29" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer5_gpu15 -->
<g id="node486" class="node">
<title>aggregate_layer5_gpu15</title>
<path fill="orange" stroke="black" d="M15543.29,-7516.49C15543.29,-7516.49 15056.19,-7516.49 15056.19,-7516.49 15050.19,-7516.49 15039.52,-7512.72 15034.85,-7508.95 15034.85,-7508.95 14922.06,-7418.02 14922.06,-7418.02 14917.38,-7414.25 14918.71,-7410.49 14924.71,-7410.49 14924.71,-7410.49 15411.81,-7410.49 15411.81,-7410.49 15417.81,-7410.49 15428.48,-7414.25 15433.15,-7418.02 15433.15,-7418.02 15545.94,-7508.95 15545.94,-7508.95 15550.62,-7512.72 15549.29,-7516.49 15543.29,-7516.49"/>
<text text-anchor="middle" x="15234" y="-7474.79" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 5 GPU 15</text>
<text text-anchor="middle" x="15234" y="-7459.79" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="15234" y="-7444.79" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer5_gpu15_expert15&#45;&gt;aggregate_layer5_gpu15 -->
<g id="edge576" class="edge">
<title>expert_layer5_gpu15_expert15&#45;&gt;aggregate_layer5_gpu15</title>
<path fill="none" stroke="black" d="M14894.61,-7552.42C14936.84,-7541.48 14984.93,-7529.02 15031.37,-7516.99"/>
<polygon fill="black" stroke="black" points="15032.45,-7520.32 15041.25,-7514.43 15030.69,-7513.55 15032.45,-7520.32"/>
</g>
<!-- comm_layer5 -->
<g id="node487" class="node">
<title>comm_layer5</title>
<ellipse fill="lightpink" stroke="black" cx="8415" cy="-7693.96" rx="243.49" ry="37.45"/>
<text text-anchor="middle" x="8415" y="-7705.26" font-family="Times,serif" font-size="14.00">Cross&#45;GPU Communication Layer 5</text>
<text text-anchor="middle" x="8415" y="-7690.26" font-family="Times,serif" font-size="14.00">Input: Tokens from routing decisions</text>
<text text-anchor="middle" x="8415" y="-7675.26" font-family="Times,serif" font-size="14.00">Output: Tokens delivered to destination GPUs</text>
</g>
<!-- route_layer5_gpu0&#45;&gt;comm_layer5 -->
<g id="edge529" class="edge">
<title>route_layer5_gpu0&#45;&gt;comm_layer5</title>
<path fill="none" stroke="black" d="M1627.3,-7796.44C1748.64,-7785.58 1899.12,-7773.66 2034,-7767.44 3258.22,-7710.98 7132.16,-7697.98 8161.69,-7695.49"/>
<polygon fill="black" stroke="black" points="8161.82,-7698.99 8171.81,-7695.46 8161.8,-7691.99 8161.82,-7698.99"/>
</g>
<!-- mha_layer6_gpu0 -->
<g id="node488" class="node">
<title>mha_layer6_gpu0</title>
<path fill="lightblue" stroke="black" d="M1545,-7374.49C1545,-7374.49 1097,-7374.49 1097,-7374.49 1091,-7374.49 1085,-7368.49 1085,-7362.49 1085,-7362.49 1085,-7333.49 1085,-7333.49 1085,-7327.49 1091,-7321.49 1097,-7321.49 1097,-7321.49 1545,-7321.49 1545,-7321.49 1551,-7321.49 1557,-7327.49 1557,-7333.49 1557,-7333.49 1557,-7362.49 1557,-7362.49 1557,-7368.49 1551,-7374.49 1545,-7374.49"/>
<text text-anchor="middle" x="1321" y="-7359.29" font-family="Times,serif" font-size="14.00">MHA Layer 6 GPU 0</text>
<text text-anchor="middle" x="1321" y="-7344.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1321" y="-7329.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer5_gpu0&#45;&gt;mha_layer6_gpu0 -->
<g id="edge577" class="edge">
<title>aggregate_layer5_gpu0&#45;&gt;mha_layer6_gpu0</title>
<path fill="none" stroke="black" d="M1531.72,-7410.47C1492.79,-7399.11 1452.98,-7387.5 1418.6,-7377.46"/>
<polygon fill="black" stroke="black" points="1419.16,-7373.98 1408.58,-7374.54 1417.2,-7380.7 1419.16,-7373.98"/>
</g>
<!-- route_layer5_gpu1&#45;&gt;comm_layer5 -->
<g id="edge530" class="edge">
<title>route_layer5_gpu1&#45;&gt;comm_layer5</title>
<path fill="none" stroke="black" d="M2610.5,-7794.23C2714.53,-7784.02 2838.78,-7773.27 2951,-7767.44 3985.07,-7713.74 7228.5,-7698.92 8161.58,-7695.72"/>
<polygon fill="black" stroke="black" points="8161.78,-7699.22 8171.77,-7695.69 8161.76,-7692.22 8161.78,-7699.22"/>
</g>
<!-- mha_layer6_gpu1 -->
<g id="node489" class="node">
<title>mha_layer6_gpu1</title>
<path fill="lightblue" stroke="black" d="M2595,-7374.49C2595,-7374.49 2147,-7374.49 2147,-7374.49 2141,-7374.49 2135,-7368.49 2135,-7362.49 2135,-7362.49 2135,-7333.49 2135,-7333.49 2135,-7327.49 2141,-7321.49 2147,-7321.49 2147,-7321.49 2595,-7321.49 2595,-7321.49 2601,-7321.49 2607,-7327.49 2607,-7333.49 2607,-7333.49 2607,-7362.49 2607,-7362.49 2607,-7368.49 2601,-7374.49 2595,-7374.49"/>
<text text-anchor="middle" x="2371" y="-7359.29" font-family="Times,serif" font-size="14.00">MHA Layer 6 GPU 1</text>
<text text-anchor="middle" x="2371" y="-7344.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2371" y="-7329.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer5_gpu1&#45;&gt;mha_layer6_gpu1 -->
<g id="edge578" class="edge">
<title>aggregate_layer5_gpu1&#45;&gt;mha_layer6_gpu1</title>
<path fill="none" stroke="black" d="M2452.69,-7410.39C2439.21,-7400.25 2425.46,-7389.92 2413.19,-7380.7"/>
<polygon fill="black" stroke="black" points="2415.04,-7377.71 2404.94,-7374.5 2410.83,-7383.31 2415.04,-7377.71"/>
</g>
<!-- route_layer5_gpu2&#45;&gt;comm_layer5 -->
<g id="edge531" class="edge">
<title>route_layer5_gpu2&#45;&gt;comm_layer5</title>
<path fill="none" stroke="black" d="M3541.17,-7804.8C3750.6,-7792.89 4059.43,-7776.61 4329,-7767.44 5779.43,-7718.12 7520.69,-7701.34 8161.99,-7696.59"/>
<polygon fill="black" stroke="black" points="8162.31,-7700.09 8172.28,-7696.52 8162.25,-7693.09 8162.31,-7700.09"/>
</g>
<!-- mha_layer6_gpu2 -->
<g id="node490" class="node">
<title>mha_layer6_gpu2</title>
<path fill="lightblue" stroke="black" d="M3571,-7374.49C3571,-7374.49 3123,-7374.49 3123,-7374.49 3117,-7374.49 3111,-7368.49 3111,-7362.49 3111,-7362.49 3111,-7333.49 3111,-7333.49 3111,-7327.49 3117,-7321.49 3123,-7321.49 3123,-7321.49 3571,-7321.49 3571,-7321.49 3577,-7321.49 3583,-7327.49 3583,-7333.49 3583,-7333.49 3583,-7362.49 3583,-7362.49 3583,-7368.49 3577,-7374.49 3571,-7374.49"/>
<text text-anchor="middle" x="3347" y="-7359.29" font-family="Times,serif" font-size="14.00">MHA Layer 6 GPU 2</text>
<text text-anchor="middle" x="3347" y="-7344.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3347" y="-7329.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer5_gpu2&#45;&gt;mha_layer6_gpu2 -->
<g id="edge579" class="edge">
<title>aggregate_layer5_gpu2&#45;&gt;mha_layer6_gpu2</title>
<path fill="none" stroke="black" d="M3788.45,-7415.17C3699.26,-7401.8 3605.27,-7387.71 3527.05,-7375.98"/>
<polygon fill="black" stroke="black" points="3527.51,-7372.51 3517.1,-7374.49 3526.47,-7379.43 3527.51,-7372.51"/>
</g>
<!-- route_layer5_gpu3&#45;&gt;comm_layer5 -->
<g id="edge532" class="edge">
<title>route_layer5_gpu3&#45;&gt;comm_layer5</title>
<path fill="none" stroke="black" d="M4911.16,-7798.42C5043.78,-7787.49 5211.94,-7774.88 5362,-7767.44 6399.95,-7715.99 7638.27,-7700.84 8161.63,-7696.56"/>
<polygon fill="black" stroke="black" points="8161.98,-7700.06 8171.95,-7696.48 8161.92,-7693.06 8161.98,-7700.06"/>
</g>
<!-- mha_layer6_gpu3 -->
<g id="node491" class="node">
<title>mha_layer6_gpu3</title>
<path fill="lightblue" stroke="black" d="M5133,-7374.49C5133,-7374.49 4685,-7374.49 4685,-7374.49 4679,-7374.49 4673,-7368.49 4673,-7362.49 4673,-7362.49 4673,-7333.49 4673,-7333.49 4673,-7327.49 4679,-7321.49 4685,-7321.49 4685,-7321.49 5133,-7321.49 5133,-7321.49 5139,-7321.49 5145,-7327.49 5145,-7333.49 5145,-7333.49 5145,-7362.49 5145,-7362.49 5145,-7368.49 5139,-7374.49 5133,-7374.49"/>
<text text-anchor="middle" x="4909" y="-7359.29" font-family="Times,serif" font-size="14.00">MHA Layer 6 GPU 3</text>
<text text-anchor="middle" x="4909" y="-7344.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4909" y="-7329.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer5_gpu3&#45;&gt;mha_layer6_gpu3 -->
<g id="edge580" class="edge">
<title>aggregate_layer5_gpu3&#45;&gt;mha_layer6_gpu3</title>
<path fill="none" stroke="black" d="M4980.41,-7410.39C4968.85,-7400.45 4957.07,-7390.32 4946.5,-7381.23"/>
<polygon fill="black" stroke="black" points="4948.54,-7378.37 4938.67,-7374.5 4943.97,-7383.67 4948.54,-7378.37"/>
</g>
<!-- route_layer5_gpu4&#45;&gt;comm_layer5 -->
<g id="edge533" class="edge">
<title>route_layer5_gpu4&#45;&gt;comm_layer5</title>
<path fill="none" stroke="black" d="M5936.9,-7792.82C6025.89,-7783.44 6128.57,-7773.68 6222,-7767.44 6923.8,-7720.53 7754.07,-7703.59 8162.4,-7697.78"/>
<polygon fill="black" stroke="black" points="8162.62,-7701.28 8172.57,-7697.64 8162.52,-7694.28 8162.62,-7701.28"/>
</g>
<!-- mha_layer6_gpu4 -->
<g id="node492" class="node">
<title>mha_layer6_gpu4</title>
<path fill="lightblue" stroke="black" d="M5774,-7374.49C5774,-7374.49 5326,-7374.49 5326,-7374.49 5320,-7374.49 5314,-7368.49 5314,-7362.49 5314,-7362.49 5314,-7333.49 5314,-7333.49 5314,-7327.49 5320,-7321.49 5326,-7321.49 5326,-7321.49 5774,-7321.49 5774,-7321.49 5780,-7321.49 5786,-7327.49 5786,-7333.49 5786,-7333.49 5786,-7362.49 5786,-7362.49 5786,-7368.49 5780,-7374.49 5774,-7374.49"/>
<text text-anchor="middle" x="5550" y="-7359.29" font-family="Times,serif" font-size="14.00">MHA Layer 6 GPU 4</text>
<text text-anchor="middle" x="5550" y="-7344.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5550" y="-7329.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer5_gpu4&#45;&gt;mha_layer6_gpu4 -->
<g id="edge581" class="edge">
<title>aggregate_layer5_gpu4&#45;&gt;mha_layer6_gpu4</title>
<path fill="none" stroke="black" d="M5731.77,-7410.39C5698.6,-7399.18 5664.71,-7387.73 5635.32,-7377.81"/>
<polygon fill="black" stroke="black" points="5636.12,-7374.38 5625.53,-7374.5 5633.88,-7381.02 5636.12,-7374.38"/>
</g>
<!-- route_layer5_gpu5&#45;&gt;comm_layer5 -->
<g id="edge534" class="edge">
<title>route_layer5_gpu5&#45;&gt;comm_layer5</title>
<path fill="none" stroke="black" d="M6791.93,-7789.14C6857.64,-7781.13 6929.6,-7773.14 6996,-7767.44 7405.88,-7732.23 7883.94,-7712.14 8167.39,-7702.41"/>
<polygon fill="black" stroke="black" points="8167.52,-7705.91 8177.39,-7702.07 8167.28,-7698.91 8167.52,-7705.91"/>
</g>
<!-- mha_layer6_gpu5 -->
<g id="node493" class="node">
<title>mha_layer6_gpu5</title>
<path fill="lightblue" stroke="black" d="M6563,-7374.49C6563,-7374.49 6115,-7374.49 6115,-7374.49 6109,-7374.49 6103,-7368.49 6103,-7362.49 6103,-7362.49 6103,-7333.49 6103,-7333.49 6103,-7327.49 6109,-7321.49 6115,-7321.49 6115,-7321.49 6563,-7321.49 6563,-7321.49 6569,-7321.49 6575,-7327.49 6575,-7333.49 6575,-7333.49 6575,-7362.49 6575,-7362.49 6575,-7368.49 6569,-7374.49 6563,-7374.49"/>
<text text-anchor="middle" x="6339" y="-7359.29" font-family="Times,serif" font-size="14.00">MHA Layer 6 GPU 5</text>
<text text-anchor="middle" x="6339" y="-7344.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6339" y="-7329.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer5_gpu5&#45;&gt;mha_layer6_gpu5 -->
<g id="edge582" class="edge">
<title>aggregate_layer5_gpu5&#45;&gt;mha_layer6_gpu5</title>
<path fill="none" stroke="black" d="M6501.29,-7410.39C6471.93,-7399.28 6441.94,-7387.93 6415.86,-7378.07"/>
<polygon fill="black" stroke="black" points="6417.03,-7374.77 6406.44,-7374.5 6414.55,-7381.31 6417.03,-7374.77"/>
</g>
<!-- route_layer5_gpu6&#45;&gt;comm_layer5 -->
<g id="edge535" class="edge">
<title>route_layer5_gpu6&#45;&gt;comm_layer5</title>
<path fill="none" stroke="black" d="M7564.71,-7788.14C7617.88,-7781.04 7674.41,-7773.74 7727,-7767.44 7886.1,-7748.38 8066.22,-7729.5 8202.25,-7715.79"/>
<polygon fill="black" stroke="black" points="8202.78,-7719.25 8212.38,-7714.77 8202.08,-7712.29 8202.78,-7719.25"/>
</g>
<!-- mha_layer6_gpu6 -->
<g id="node494" class="node">
<title>mha_layer6_gpu6</title>
<path fill="lightblue" stroke="black" d="M7388,-7374.49C7388,-7374.49 6940,-7374.49 6940,-7374.49 6934,-7374.49 6928,-7368.49 6928,-7362.49 6928,-7362.49 6928,-7333.49 6928,-7333.49 6928,-7327.49 6934,-7321.49 6940,-7321.49 6940,-7321.49 7388,-7321.49 7388,-7321.49 7394,-7321.49 7400,-7327.49 7400,-7333.49 7400,-7333.49 7400,-7362.49 7400,-7362.49 7400,-7368.49 7394,-7374.49 7388,-7374.49"/>
<text text-anchor="middle" x="7164" y="-7359.29" font-family="Times,serif" font-size="14.00">MHA Layer 6 GPU 6</text>
<text text-anchor="middle" x="7164" y="-7344.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7164" y="-7329.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer5_gpu6&#45;&gt;mha_layer6_gpu6 -->
<g id="edge583" class="edge">
<title>aggregate_layer5_gpu6&#45;&gt;mha_layer6_gpu6</title>
<path fill="none" stroke="black" d="M7262.46,-7410.39C7245.74,-7399.96 7228.69,-7389.33 7213.57,-7379.9"/>
<polygon fill="black" stroke="black" points="7215.25,-7376.82 7204.91,-7374.5 7211.54,-7382.76 7215.25,-7376.82"/>
</g>
<!-- route_layer5_gpu7&#45;&gt;comm_layer5 -->
<g id="edge536" class="edge">
<title>route_layer5_gpu7&#45;&gt;comm_layer5</title>
<path fill="none" stroke="black" d="M8214.89,-7767.37C8247.54,-7755.56 8281.57,-7743.24 8312.12,-7732.19"/>
<polygon fill="black" stroke="black" points="8313.69,-7735.34 8321.91,-7728.65 8311.31,-7728.76 8313.69,-7735.34"/>
</g>
<!-- mha_layer6_gpu7 -->
<g id="node495" class="node">
<title>mha_layer6_gpu7</title>
<path fill="lightblue" stroke="black" d="M8169,-7374.49C8169,-7374.49 7721,-7374.49 7721,-7374.49 7715,-7374.49 7709,-7368.49 7709,-7362.49 7709,-7362.49 7709,-7333.49 7709,-7333.49 7709,-7327.49 7715,-7321.49 7721,-7321.49 7721,-7321.49 8169,-7321.49 8169,-7321.49 8175,-7321.49 8181,-7327.49 8181,-7333.49 8181,-7333.49 8181,-7362.49 8181,-7362.49 8181,-7368.49 8175,-7374.49 8169,-7374.49"/>
<text text-anchor="middle" x="7945" y="-7359.29" font-family="Times,serif" font-size="14.00">MHA Layer 6 GPU 7</text>
<text text-anchor="middle" x="7945" y="-7344.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7945" y="-7329.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer5_gpu7&#45;&gt;mha_layer6_gpu7 -->
<g id="edge584" class="edge">
<title>aggregate_layer5_gpu7&#45;&gt;mha_layer6_gpu7</title>
<path fill="none" stroke="black" d="M7990.98,-7410.39C7983.91,-7400.94 7976.7,-7391.31 7970.15,-7382.57"/>
<polygon fill="black" stroke="black" points="7972.9,-7380.41 7964.11,-7374.5 7967.3,-7384.6 7972.9,-7380.41"/>
</g>
<!-- route_layer5_gpu8&#45;&gt;comm_layer5 -->
<g id="edge537" class="edge">
<title>route_layer5_gpu8&#45;&gt;comm_layer5</title>
<path fill="none" stroke="black" d="M8695.38,-7767.37C8645.27,-7754.43 8592.83,-7740.89 8547.03,-7729.06"/>
<polygon fill="black" stroke="black" points="8547.62,-7725.6 8537.06,-7726.49 8545.87,-7732.38 8547.62,-7725.6"/>
</g>
<!-- mha_layer6_gpu8 -->
<g id="node496" class="node">
<title>mha_layer6_gpu8</title>
<path fill="lightblue" stroke="black" d="M9052,-7374.49C9052,-7374.49 8604,-7374.49 8604,-7374.49 8598,-7374.49 8592,-7368.49 8592,-7362.49 8592,-7362.49 8592,-7333.49 8592,-7333.49 8592,-7327.49 8598,-7321.49 8604,-7321.49 8604,-7321.49 9052,-7321.49 9052,-7321.49 9058,-7321.49 9064,-7327.49 9064,-7333.49 9064,-7333.49 9064,-7362.49 9064,-7362.49 9064,-7368.49 9058,-7374.49 9052,-7374.49"/>
<text text-anchor="middle" x="8828" y="-7359.29" font-family="Times,serif" font-size="14.00">MHA Layer 6 GPU 8</text>
<text text-anchor="middle" x="8828" y="-7344.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8828" y="-7329.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer5_gpu8&#45;&gt;mha_layer6_gpu8 -->
<g id="edge585" class="edge">
<title>aggregate_layer5_gpu8&#45;&gt;mha_layer6_gpu8</title>
<path fill="none" stroke="black" d="M8812.85,-7410.39C8815.02,-7401.62 8817.22,-7392.7 8819.24,-7384.48"/>
<polygon fill="black" stroke="black" points="8822.71,-7385.05 8821.71,-7374.5 8815.91,-7383.37 8822.71,-7385.05"/>
</g>
<!-- route_layer5_gpu9&#45;&gt;comm_layer5 -->
<g id="edge538" class="edge">
<title>route_layer5_gpu9&#45;&gt;comm_layer5</title>
<path fill="none" stroke="black" d="M9486.73,-7790.27C9406.78,-7782.73 9320.66,-7774.69 9241,-7767.44 9035.63,-7748.74 8801.46,-7728.27 8635.03,-7713.87"/>
<polygon fill="black" stroke="black" points="8634.93,-7710.35 8624.67,-7712.98 8634.33,-7717.33 8634.93,-7710.35"/>
</g>
<!-- mha_layer6_gpu9 -->
<g id="node497" class="node">
<title>mha_layer6_gpu9</title>
<path fill="lightblue" stroke="black" d="M10045,-7374.49C10045,-7374.49 9597,-7374.49 9597,-7374.49 9591,-7374.49 9585,-7368.49 9585,-7362.49 9585,-7362.49 9585,-7333.49 9585,-7333.49 9585,-7327.49 9591,-7321.49 9597,-7321.49 9597,-7321.49 10045,-7321.49 10045,-7321.49 10051,-7321.49 10057,-7327.49 10057,-7333.49 10057,-7333.49 10057,-7362.49 10057,-7362.49 10057,-7368.49 10051,-7374.49 10045,-7374.49"/>
<text text-anchor="middle" x="9821" y="-7359.29" font-family="Times,serif" font-size="14.00">MHA Layer 6 GPU 9</text>
<text text-anchor="middle" x="9821" y="-7344.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9821" y="-7329.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer5_gpu9&#45;&gt;mha_layer6_gpu9 -->
<g id="edge586" class="edge">
<title>aggregate_layer5_gpu9&#45;&gt;mha_layer6_gpu9</title>
<path fill="none" stroke="black" d="M9707.94,-7410.39C9727.49,-7399.77 9747.45,-7388.93 9765.05,-7379.37"/>
<polygon fill="black" stroke="black" points="9766.9,-7382.35 9774.02,-7374.5 9763.56,-7376.2 9766.9,-7382.35"/>
</g>
<!-- route_layer5_gpu10&#45;&gt;comm_layer5 -->
<g id="edge539" class="edge">
<title>route_layer5_gpu10&#45;&gt;comm_layer5</title>
<path fill="none" stroke="black" d="M10414.56,-7789.49C10324.85,-7781.46 10226.55,-7773.37 10136,-7767.44 9612.68,-7733.18 8998.71,-7711.85 8663.88,-7701.81"/>
<polygon fill="black" stroke="black" points="8663.67,-7698.3 8653.57,-7701.5 8663.46,-7705.3 8663.67,-7698.3"/>
</g>
<!-- mha_layer6_gpu10 -->
<g id="node498" class="node">
<title>mha_layer6_gpu10</title>
<path fill="lightblue" stroke="black" d="M10597,-7374.49C10597,-7374.49 10149,-7374.49 10149,-7374.49 10143,-7374.49 10137,-7368.49 10137,-7362.49 10137,-7362.49 10137,-7333.49 10137,-7333.49 10137,-7327.49 10143,-7321.49 10149,-7321.49 10149,-7321.49 10597,-7321.49 10597,-7321.49 10603,-7321.49 10609,-7327.49 10609,-7333.49 10609,-7333.49 10609,-7362.49 10609,-7362.49 10609,-7368.49 10603,-7374.49 10597,-7374.49"/>
<text text-anchor="middle" x="10373" y="-7359.29" font-family="Times,serif" font-size="14.00">MHA Layer 6 GPU 10</text>
<text text-anchor="middle" x="10373" y="-7344.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10373" y="-7329.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer5_gpu10&#45;&gt;mha_layer6_gpu10 -->
<g id="edge587" class="edge">
<title>aggregate_layer5_gpu10&#45;&gt;mha_layer6_gpu10</title>
<path fill="none" stroke="black" d="M10360.02,-7410.39C10361.87,-7401.62 10363.76,-7392.7 10365.5,-7384.48"/>
<polygon fill="black" stroke="black" points="10368.96,-7385.01 10367.61,-7374.5 10362.11,-7383.56 10368.96,-7385.01"/>
</g>
<!-- route_layer5_gpu11&#45;&gt;comm_layer5 -->
<g id="edge540" class="edge">
<title>route_layer5_gpu11&#45;&gt;comm_layer5</title>
<path fill="none" stroke="black" d="M11361.49,-7789.5C11266.54,-7781.17 11161.51,-7772.92 11065,-7767.44 10185.29,-7717.52 9139.29,-7701.73 8667.71,-7696.94"/>
<polygon fill="black" stroke="black" points="8667.75,-7693.44 8657.71,-7696.84 8667.68,-7700.44 8667.75,-7693.44"/>
</g>
<!-- mha_layer6_gpu11 -->
<g id="node499" class="node">
<title>mha_layer6_gpu11</title>
<path fill="lightblue" stroke="black" d="M11967,-7374.49C11967,-7374.49 11519,-7374.49 11519,-7374.49 11513,-7374.49 11507,-7368.49 11507,-7362.49 11507,-7362.49 11507,-7333.49 11507,-7333.49 11507,-7327.49 11513,-7321.49 11519,-7321.49 11519,-7321.49 11967,-7321.49 11967,-7321.49 11973,-7321.49 11979,-7327.49 11979,-7333.49 11979,-7333.49 11979,-7362.49 11979,-7362.49 11979,-7368.49 11973,-7374.49 11967,-7374.49"/>
<text text-anchor="middle" x="11743" y="-7359.29" font-family="Times,serif" font-size="14.00">MHA Layer 6 GPU 11</text>
<text text-anchor="middle" x="11743" y="-7344.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11743" y="-7329.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer5_gpu11&#45;&gt;mha_layer6_gpu11 -->
<g id="edge588" class="edge">
<title>aggregate_layer5_gpu11&#45;&gt;mha_layer6_gpu11</title>
<path fill="none" stroke="black" d="M11536.61,-7410.47C11574.74,-7399.11 11613.73,-7387.5 11647.41,-7377.46"/>
<polygon fill="black" stroke="black" points="11648.63,-7380.75 11657.22,-7374.54 11646.63,-7374.04 11648.63,-7380.75"/>
</g>
<!-- route_layer5_gpu12&#45;&gt;comm_layer5 -->
<g id="edge541" class="edge">
<title>route_layer5_gpu12&#45;&gt;comm_layer5</title>
<path fill="none" stroke="black" d="M12316.35,-7789.43C12219.12,-7780.97 12111.14,-7772.65 12012,-7767.44 10758.64,-7701.55 9256.73,-7694.44 8668.66,-7694.43"/>
<polygon fill="black" stroke="black" points="8668.36,-7690.93 8658.36,-7694.44 8668.36,-7697.93 8668.36,-7690.93"/>
</g>
<!-- mha_layer6_gpu12 -->
<g id="node500" class="node">
<title>mha_layer6_gpu12</title>
<path fill="lightblue" stroke="black" d="M12628,-7374.49C12628,-7374.49 12180,-7374.49 12180,-7374.49 12174,-7374.49 12168,-7368.49 12168,-7362.49 12168,-7362.49 12168,-7333.49 12168,-7333.49 12168,-7327.49 12174,-7321.49 12180,-7321.49 12180,-7321.49 12628,-7321.49 12628,-7321.49 12634,-7321.49 12640,-7327.49 12640,-7333.49 12640,-7333.49 12640,-7362.49 12640,-7362.49 12640,-7368.49 12634,-7374.49 12628,-7374.49"/>
<text text-anchor="middle" x="12404" y="-7359.29" font-family="Times,serif" font-size="14.00">MHA Layer 6 GPU 12</text>
<text text-anchor="middle" x="12404" y="-7344.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12404" y="-7329.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer5_gpu12&#45;&gt;mha_layer6_gpu12 -->
<g id="edge589" class="edge">
<title>aggregate_layer5_gpu12&#45;&gt;mha_layer6_gpu12</title>
<path fill="none" stroke="black" d="M12293.1,-7410.39C12312.28,-7399.77 12331.86,-7388.93 12349.12,-7379.37"/>
<polygon fill="black" stroke="black" points="12350.86,-7382.41 12357.92,-7374.5 12347.47,-7376.28 12350.86,-7382.41"/>
</g>
<!-- route_layer5_gpu13&#45;&gt;comm_layer5 -->
<g id="edge542" class="edge">
<title>route_layer5_gpu13&#45;&gt;comm_layer5</title>
<path fill="none" stroke="black" d="M13276.61,-7789.42C13177.87,-7780.86 13067.89,-7772.5 12967,-7767.44 12120.33,-7725.01 9496.43,-7702.8 8668.2,-7696.71"/>
<polygon fill="black" stroke="black" points="8667.96,-7693.21 8657.94,-7696.64 8667.91,-7700.21 8667.96,-7693.21"/>
</g>
<!-- mha_layer6_gpu13 -->
<g id="node501" class="node">
<title>mha_layer6_gpu13</title>
<path fill="lightblue" stroke="black" d="M13203,-7374.49C13203,-7374.49 12755,-7374.49 12755,-7374.49 12749,-7374.49 12743,-7368.49 12743,-7362.49 12743,-7362.49 12743,-7333.49 12743,-7333.49 12743,-7327.49 12749,-7321.49 12755,-7321.49 12755,-7321.49 13203,-7321.49 13203,-7321.49 13209,-7321.49 13215,-7327.49 13215,-7333.49 13215,-7333.49 13215,-7362.49 13215,-7362.49 13215,-7368.49 13209,-7374.49 13203,-7374.49"/>
<text text-anchor="middle" x="12979" y="-7359.29" font-family="Times,serif" font-size="14.00">MHA Layer 6 GPU 13</text>
<text text-anchor="middle" x="12979" y="-7344.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12979" y="-7329.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer5_gpu13&#45;&gt;mha_layer6_gpu13 -->
<g id="edge590" class="edge">
<title>aggregate_layer5_gpu13&#45;&gt;mha_layer6_gpu13</title>
<path fill="none" stroke="black" d="M12962.23,-7410.39C12964.65,-7401.52 12967.11,-7392.5 12969.38,-7384.2"/>
<polygon fill="black" stroke="black" points="12972.77,-7385.07 12972.03,-7374.5 12966.02,-7383.22 12972.77,-7385.07"/>
</g>
<!-- route_layer5_gpu14&#45;&gt;comm_layer5 -->
<g id="edge543" class="edge">
<title>route_layer5_gpu14&#45;&gt;comm_layer5</title>
<path fill="none" stroke="black" d="M14238.41,-7789.33C14139.15,-7780.73 14028.49,-7772.37 13927,-7767.44 12882.78,-7716.71 9606.27,-7699.78 8668.23,-7695.91"/>
<polygon fill="black" stroke="black" points="8667.99,-7692.41 8657.98,-7695.87 8667.96,-7699.41 8667.99,-7692.41"/>
</g>
<!-- mha_layer6_gpu14 -->
<g id="node502" class="node">
<title>mha_layer6_gpu14</title>
<path fill="lightblue" stroke="black" d="M14632,-7374.49C14632,-7374.49 14184,-7374.49 14184,-7374.49 14178,-7374.49 14172,-7368.49 14172,-7362.49 14172,-7362.49 14172,-7333.49 14172,-7333.49 14172,-7327.49 14178,-7321.49 14184,-7321.49 14184,-7321.49 14632,-7321.49 14632,-7321.49 14638,-7321.49 14644,-7327.49 14644,-7333.49 14644,-7333.49 14644,-7362.49 14644,-7362.49 14644,-7368.49 14638,-7374.49 14632,-7374.49"/>
<text text-anchor="middle" x="14408" y="-7359.29" font-family="Times,serif" font-size="14.00">MHA Layer 6 GPU 14</text>
<text text-anchor="middle" x="14408" y="-7344.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14408" y="-7329.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer5_gpu14&#45;&gt;mha_layer6_gpu14 -->
<g id="edge591" class="edge">
<title>aggregate_layer5_gpu14&#45;&gt;mha_layer6_gpu14</title>
<path fill="none" stroke="black" d="M14268.97,-7410.39C14293.68,-7399.47 14318.91,-7388.33 14340.98,-7378.59"/>
<polygon fill="black" stroke="black" points="14342.5,-7381.74 14350.23,-7374.5 14339.67,-7375.34 14342.5,-7381.74"/>
</g>
<!-- route_layer5_gpu15&#45;&gt;comm_layer5 -->
<g id="edge544" class="edge">
<title>route_layer5_gpu15&#45;&gt;comm_layer5</title>
<path fill="none" stroke="black" d="M15201.31,-7789.24C15101.79,-7780.63 14990.8,-7772.28 14889,-7767.44 13645.62,-7708.33 9707.7,-7697.25 8668.49,-7695.34"/>
<polygon fill="black" stroke="black" points="8668.28,-7691.84 8658.27,-7695.32 8668.27,-7698.84 8668.28,-7691.84"/>
</g>
<!-- mha_layer6_gpu15 -->
<g id="node503" class="node">
<title>mha_layer6_gpu15</title>
<path fill="lightblue" stroke="black" d="M15656,-7374.49C15656,-7374.49 15208,-7374.49 15208,-7374.49 15202,-7374.49 15196,-7368.49 15196,-7362.49 15196,-7362.49 15196,-7333.49 15196,-7333.49 15196,-7327.49 15202,-7321.49 15208,-7321.49 15208,-7321.49 15656,-7321.49 15656,-7321.49 15662,-7321.49 15668,-7327.49 15668,-7333.49 15668,-7333.49 15668,-7362.49 15668,-7362.49 15668,-7368.49 15662,-7374.49 15656,-7374.49"/>
<text text-anchor="middle" x="15432" y="-7359.29" font-family="Times,serif" font-size="14.00">MHA Layer 6 GPU 15</text>
<text text-anchor="middle" x="15432" y="-7344.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="15432" y="-7329.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer5_gpu15&#45;&gt;mha_layer6_gpu15 -->
<g id="edge592" class="edge">
<title>aggregate_layer5_gpu15&#45;&gt;mha_layer6_gpu15</title>
<path fill="none" stroke="black" d="M15324.89,-7410.39C15343.24,-7399.86 15361.97,-7389.13 15378.53,-7379.64"/>
<polygon fill="black" stroke="black" points="15380.56,-7382.51 15387.49,-7374.5 15377.08,-7376.44 15380.56,-7382.51"/>
</g>
<!-- comm_layer5&#45;&gt;expert_layer5_gpu0_expert0 -->
<g id="edge545" class="edge">
<title>comm_layer5&#45;&gt;expert_layer5_gpu0_expert0</title>
<path fill="none" stroke="black" d="M8172.02,-7692.01C7380.74,-7688.45 4806.16,-7673.31 2677,-7620.49 2462.81,-7615.17 2219.79,-7605.97 2041.56,-7598.63"/>
<polygon fill="black" stroke="black" points="2041.66,-7595.14 2031.53,-7598.22 2041.37,-7602.13 2041.66,-7595.14"/>
</g>
<!-- comm_layer5&#45;&gt;expert_layer5_gpu1_expert1 -->
<g id="edge546" class="edge">
<title>comm_layer5&#45;&gt;expert_layer5_gpu1_expert1</title>
<path fill="none" stroke="black" d="M8173.06,-7689.95C7515.1,-7681.53 5637.9,-7656.04 4077,-7620.49 3772.15,-7613.54 3421.67,-7603.07 3189.83,-7595.79"/>
<polygon fill="black" stroke="black" points="3189.67,-7592.28 3179.57,-7595.46 3189.45,-7599.28 3189.67,-7592.28"/>
</g>
<!-- comm_layer5&#45;&gt;expert_layer5_gpu2_expert2 -->
<g id="edge547" class="edge">
<title>comm_layer5&#45;&gt;expert_layer5_gpu2_expert2</title>
<path fill="none" stroke="black" d="M8172.43,-7690.99C7602.82,-7685.69 6135.29,-7668.18 4910,-7620.49 4805.19,-7616.41 4689.77,-7610.16 4589.88,-7604.19"/>
<polygon fill="black" stroke="black" points="4589.83,-7600.68 4579.64,-7603.57 4589.41,-7607.67 4589.83,-7600.68"/>
</g>
<!-- comm_layer5&#45;&gt;expert_layer5_gpu3_expert3 -->
<g id="edge548" class="edge">
<title>comm_layer5&#45;&gt;expert_layer5_gpu3_expert3</title>
<path fill="none" stroke="black" d="M8175.46,-7687.41C7727.29,-7676.71 6731.52,-7651.56 5893,-7620.49 5737.03,-7614.71 5562.3,-7606.82 5423.23,-7600.21"/>
<polygon fill="black" stroke="black" points="5423.02,-7596.69 5412.86,-7599.71 5422.68,-7603.68 5423.02,-7596.69"/>
</g>
<!-- comm_layer5&#45;&gt;expert_layer5_gpu4_expert4 -->
<g id="edge549" class="edge">
<title>comm_layer5&#45;&gt;expert_layer5_gpu4_expert4</title>
<path fill="none" stroke="black" d="M8178.04,-7685.27C7837.62,-7673.77 7190.49,-7650.22 6640,-7620.49 6563.87,-7616.37 6481.14,-7611.12 6405.68,-7606.02"/>
<polygon fill="black" stroke="black" points="6405.77,-7602.52 6395.56,-7605.33 6405.3,-7609.5 6405.77,-7602.52"/>
</g>
<!-- comm_layer5&#45;&gt;expert_layer5_gpu5_expert5 -->
<g id="edge550" class="edge">
<title>comm_layer5&#45;&gt;expert_layer5_gpu5_expert5</title>
<path fill="none" stroke="black" d="M8188.2,-7680.3C7956.92,-7666.99 7587.8,-7644.67 7269,-7620.49 7231.51,-7617.64 7191.92,-7614.4 7153.1,-7611.08"/>
<polygon fill="black" stroke="black" points="7152.98,-7607.56 7142.71,-7610.19 7152.38,-7614.53 7152.98,-7607.56"/>
</g>
<!-- comm_layer5&#45;&gt;expert_layer5_gpu6_expert6 -->
<g id="edge551" class="edge">
<title>comm_layer5&#45;&gt;expert_layer5_gpu6_expert6</title>
<path fill="none" stroke="black" d="M8225.16,-7670.47C8095.92,-7655.15 7923.29,-7634.69 7781.79,-7617.92"/>
<polygon fill="black" stroke="black" points="7782,-7614.42 7771.66,-7616.72 7781.18,-7621.37 7782,-7614.42"/>
</g>
<!-- comm_layer5&#45;&gt;expert_layer5_gpu7_expert7 -->
<g id="edge552" class="edge">
<title>comm_layer5&#45;&gt;expert_layer5_gpu7_expert7</title>
<path fill="none" stroke="black" d="M8314.19,-7659.73C8279.53,-7648.31 8240.55,-7635.46 8205.18,-7623.8"/>
<polygon fill="black" stroke="black" points="8205.9,-7620.35 8195.3,-7620.55 8203.71,-7627 8205.9,-7620.35"/>
</g>
<!-- comm_layer5&#45;&gt;expert_layer5_gpu8_expert8 -->
<g id="edge553" class="edge">
<title>comm_layer5&#45;&gt;expert_layer5_gpu8_expert8</title>
<path fill="none" stroke="black" d="M8515.81,-7659.73C8550.47,-7648.31 8589.45,-7635.46 8624.82,-7623.8"/>
<polygon fill="black" stroke="black" points="8626.29,-7627 8634.7,-7620.55 8624.1,-7620.35 8626.29,-7627"/>
</g>
<!-- comm_layer5&#45;&gt;expert_layer5_gpu9_expert9 -->
<g id="edge554" class="edge">
<title>comm_layer5&#45;&gt;expert_layer5_gpu9_expert9</title>
<path fill="none" stroke="black" d="M8615.75,-7672.72C8783.25,-7655.83 9023.01,-7631.65 9204.42,-7613.36"/>
<polygon fill="black" stroke="black" points="9204.78,-7616.84 9214.37,-7612.36 9204.07,-7609.88 9204.78,-7616.84"/>
</g>
<!-- comm_layer5&#45;&gt;expert_layer5_gpu10_expert10 -->
<g id="edge555" class="edge">
<title>comm_layer5&#45;&gt;expert_layer5_gpu10_expert10</title>
<path fill="none" stroke="black" d="M8643.61,-7681.16C8903.47,-7667.52 9340.36,-7643.94 9716,-7620.49 9787.51,-7616.02 9865.03,-7610.82 9936.37,-7605.88"/>
<polygon fill="black" stroke="black" points="9936.66,-7609.36 9946.39,-7605.18 9936.17,-7602.38 9936.66,-7609.36"/>
</g>
<!-- comm_layer5&#45;&gt;expert_layer5_gpu11_expert11 -->
<g id="edge556" class="edge">
<title>comm_layer5&#45;&gt;expert_layer5_gpu11_expert11</title>
<path fill="none" stroke="black" d="M8652.54,-7685.87C9032.05,-7674.22 9798.58,-7649.43 10448,-7620.49 10566.34,-7615.21 10697.39,-7608.35 10808.17,-7602.25"/>
<polygon fill="black" stroke="black" points="10808.69,-7605.72 10818.48,-7601.68 10808.3,-7598.73 10808.69,-7605.72"/>
</g>
<!-- comm_layer5&#45;&gt;expert_layer5_gpu12_expert12 -->
<g id="edge557" class="edge">
<title>comm_layer5&#45;&gt;expert_layer5_gpu12_expert12</title>
<path fill="none" stroke="black" d="M8656.58,-7689.39C9154.76,-7681.47 10332.29,-7659.96 11320,-7620.49 11432.6,-7615.99 11556.99,-7609.41 11663.19,-7603.31"/>
<polygon fill="black" stroke="black" points="11663.63,-7606.79 11673.41,-7602.72 11663.22,-7599.8 11663.63,-7606.79"/>
</g>
<!-- comm_layer5&#45;&gt;expert_layer5_gpu13_expert13 -->
<g id="edge558" class="edge">
<title>comm_layer5&#45;&gt;expert_layer5_gpu13_expert13</title>
<path fill="none" stroke="black" d="M8657.87,-7691.73C9256,-7687.94 10848.01,-7673.28 12175,-7620.49 12269.72,-7616.72 12373.57,-7610.88 12465.1,-7605.16"/>
<polygon fill="black" stroke="black" points="12465.58,-7608.64 12475.34,-7604.52 12465.14,-7601.65 12465.58,-7608.64"/>
</g>
<!-- comm_layer5&#45;&gt;expert_layer5_gpu14_expert14 -->
<g id="edge559" class="edge">
<title>comm_layer5&#45;&gt;expert_layer5_gpu14_expert14</title>
<path fill="none" stroke="black" d="M8658,-7691.52C9339.46,-7686.95 11326.68,-7670.04 12977,-7620.49 13139.99,-7615.59 13322.87,-7607.56 13466.89,-7600.64"/>
<polygon fill="black" stroke="black" points="13467.37,-7604.12 13477.19,-7600.14 13467.03,-7597.13 13467.37,-7604.12"/>
</g>
<!-- comm_layer5&#45;&gt;expert_layer5_gpu15_expert15 -->
<g id="edge560" class="edge">
<title>comm_layer5&#45;&gt;expert_layer5_gpu15_expert15</title>
<path fill="none" stroke="black" d="M8658.08,-7692.3C9433.99,-7689.64 11921.17,-7676.97 13979,-7620.49 14156.46,-7615.62 14356.29,-7607.21 14510.31,-7600.11"/>
<polygon fill="black" stroke="black" points="14510.56,-7603.6 14520.39,-7599.64 14510.24,-7596.61 14510.56,-7603.6"/>
</g>
<!-- gate_layer6_gpu0 -->
<g id="node504" class="node">
<title>gate_layer6_gpu0</title>
<path fill="lightsteelblue" stroke="black" d="M1158.07,-7284.15C1158.07,-7284.15 708.93,-7233.82 708.93,-7233.82 702.96,-7233.15 702.96,-7231.82 708.93,-7231.15 708.93,-7231.15 1158.07,-7180.82 1158.07,-7180.82 1164.04,-7180.15 1175.96,-7180.15 1181.93,-7180.82 1181.93,-7180.82 1631.07,-7231.15 1631.07,-7231.15 1637.04,-7231.82 1637.04,-7233.15 1631.07,-7233.82 1631.07,-7233.82 1181.93,-7284.15 1181.93,-7284.15 1175.96,-7284.82 1164.04,-7284.82 1158.07,-7284.15"/>
<text text-anchor="middle" x="1170" y="-7243.79" font-family="Times,serif" font-size="14.00">Gate Layer 6 GPU 0</text>
<text text-anchor="middle" x="1170" y="-7228.79" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="1170" y="-7213.79" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer6_gpu0&#45;&gt;gate_layer6_gpu0 -->
<g id="edge593" class="edge">
<title>mha_layer6_gpu0&#45;&gt;gate_layer6_gpu0</title>
<path fill="none" stroke="black" d="M1286.74,-7321.23C1272.38,-7310.44 1255.15,-7297.49 1238.39,-7284.9"/>
<polygon fill="black" stroke="black" points="1240.32,-7281.96 1230.22,-7278.75 1236.11,-7287.56 1240.32,-7281.96"/>
</g>
<!-- gate_layer6_gpu1 -->
<g id="node505" class="node">
<title>gate_layer6_gpu1</title>
<path fill="lightsteelblue" stroke="black" d="M2122.07,-7284.15C2122.07,-7284.15 1672.93,-7233.82 1672.93,-7233.82 1666.96,-7233.15 1666.96,-7231.82 1672.93,-7231.15 1672.93,-7231.15 2122.07,-7180.82 2122.07,-7180.82 2128.04,-7180.15 2139.96,-7180.15 2145.93,-7180.82 2145.93,-7180.82 2595.07,-7231.15 2595.07,-7231.15 2601.04,-7231.82 2601.04,-7233.15 2595.07,-7233.82 2595.07,-7233.82 2145.93,-7284.15 2145.93,-7284.15 2139.96,-7284.82 2128.04,-7284.82 2122.07,-7284.15"/>
<text text-anchor="middle" x="2134" y="-7243.79" font-family="Times,serif" font-size="14.00">Gate Layer 6 GPU 1</text>
<text text-anchor="middle" x="2134" y="-7228.79" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="2134" y="-7213.79" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer6_gpu1&#45;&gt;gate_layer6_gpu1 -->
<g id="edge594" class="edge">
<title>mha_layer6_gpu1&#45;&gt;gate_layer6_gpu1</title>
<path fill="none" stroke="black" d="M2317.52,-7321.37C2292.03,-7309.17 2260.73,-7294.18 2231.25,-7280.06"/>
<polygon fill="black" stroke="black" points="2232.69,-7276.87 2222.16,-7275.71 2229.67,-7283.18 2232.69,-7276.87"/>
</g>
<!-- gate_layer6_gpu2 -->
<g id="node506" class="node">
<title>gate_layer6_gpu2</title>
<path fill="lightsteelblue" stroke="black" d="M3086.07,-7284.15C3086.07,-7284.15 2636.93,-7233.82 2636.93,-7233.82 2630.96,-7233.15 2630.96,-7231.82 2636.93,-7231.15 2636.93,-7231.15 3086.07,-7180.82 3086.07,-7180.82 3092.04,-7180.15 3103.96,-7180.15 3109.93,-7180.82 3109.93,-7180.82 3559.07,-7231.15 3559.07,-7231.15 3565.04,-7231.82 3565.04,-7233.15 3559.07,-7233.82 3559.07,-7233.82 3109.93,-7284.15 3109.93,-7284.15 3103.96,-7284.82 3092.04,-7284.82 3086.07,-7284.15"/>
<text text-anchor="middle" x="3098" y="-7243.79" font-family="Times,serif" font-size="14.00">Gate Layer 6 GPU 2</text>
<text text-anchor="middle" x="3098" y="-7228.79" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="3098" y="-7213.79" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer6_gpu2&#45;&gt;gate_layer6_gpu2 -->
<g id="edge595" class="edge">
<title>mha_layer6_gpu2&#45;&gt;gate_layer6_gpu2</title>
<path fill="none" stroke="black" d="M3290.81,-7321.37C3263.65,-7309 3230.22,-7293.76 3198.86,-7279.46"/>
<polygon fill="black" stroke="black" points="3200.2,-7276.22 3189.65,-7275.26 3197.29,-7282.59 3200.2,-7276.22"/>
</g>
<!-- gate_layer6_gpu3 -->
<g id="node507" class="node">
<title>gate_layer6_gpu3</title>
<path fill="lightsteelblue" stroke="black" d="M4050.07,-7284.15C4050.07,-7284.15 3600.93,-7233.82 3600.93,-7233.82 3594.96,-7233.15 3594.96,-7231.82 3600.93,-7231.15 3600.93,-7231.15 4050.07,-7180.82 4050.07,-7180.82 4056.04,-7180.15 4067.96,-7180.15 4073.93,-7180.82 4073.93,-7180.82 4523.07,-7231.15 4523.07,-7231.15 4529.04,-7231.82 4529.04,-7233.15 4523.07,-7233.82 4523.07,-7233.82 4073.93,-7284.15 4073.93,-7284.15 4067.96,-7284.82 4056.04,-7284.82 4050.07,-7284.15"/>
<text text-anchor="middle" x="4062" y="-7243.79" font-family="Times,serif" font-size="14.00">Gate Layer 6 GPU 3</text>
<text text-anchor="middle" x="4062" y="-7228.79" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4062" y="-7213.79" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer6_gpu3&#45;&gt;gate_layer6_gpu3 -->
<g id="edge596" class="edge">
<title>mha_layer6_gpu3&#45;&gt;gate_layer6_gpu3</title>
<path fill="none" stroke="black" d="M4718.65,-7321.48C4589.69,-7304.2 4418.82,-7281.3 4283.71,-7263.2"/>
<polygon fill="black" stroke="black" points="4284.01,-7259.71 4273.64,-7261.85 4283.08,-7266.64 4284.01,-7259.71"/>
</g>
<!-- gate_layer6_gpu4 -->
<g id="node508" class="node">
<title>gate_layer6_gpu4</title>
<path fill="lightsteelblue" stroke="black" d="M5014.07,-7284.15C5014.07,-7284.15 4564.93,-7233.82 4564.93,-7233.82 4558.96,-7233.15 4558.96,-7231.82 4564.93,-7231.15 4564.93,-7231.15 5014.07,-7180.82 5014.07,-7180.82 5020.04,-7180.15 5031.96,-7180.15 5037.93,-7180.82 5037.93,-7180.82 5487.07,-7231.15 5487.07,-7231.15 5493.04,-7231.82 5493.04,-7233.15 5487.07,-7233.82 5487.07,-7233.82 5037.93,-7284.15 5037.93,-7284.15 5031.96,-7284.82 5020.04,-7284.82 5014.07,-7284.15"/>
<text text-anchor="middle" x="5026" y="-7243.79" font-family="Times,serif" font-size="14.00">Gate Layer 6 GPU 4</text>
<text text-anchor="middle" x="5026" y="-7228.79" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5026" y="-7213.79" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer6_gpu4&#45;&gt;gate_layer6_gpu4 -->
<g id="edge597" class="edge">
<title>mha_layer6_gpu4&#45;&gt;gate_layer6_gpu4</title>
<path fill="none" stroke="black" d="M5432.08,-7321.44C5361.89,-7306.24 5271.69,-7286.7 5194.13,-7269.9"/>
<polygon fill="black" stroke="black" points="5194.77,-7266.46 5184.25,-7267.76 5193.29,-7273.3 5194.77,-7266.46"/>
</g>
<!-- gate_layer6_gpu5 -->
<g id="node509" class="node">
<title>gate_layer6_gpu5</title>
<path fill="lightsteelblue" stroke="black" d="M5978.07,-7284.15C5978.07,-7284.15 5528.93,-7233.82 5528.93,-7233.82 5522.96,-7233.15 5522.96,-7231.82 5528.93,-7231.15 5528.93,-7231.15 5978.07,-7180.82 5978.07,-7180.82 5984.04,-7180.15 5995.96,-7180.15 6001.93,-7180.82 6001.93,-7180.82 6451.07,-7231.15 6451.07,-7231.15 6457.04,-7231.82 6457.04,-7233.15 6451.07,-7233.82 6451.07,-7233.82 6001.93,-7284.15 6001.93,-7284.15 5995.96,-7284.82 5984.04,-7284.82 5978.07,-7284.15"/>
<text text-anchor="middle" x="5990" y="-7243.79" font-family="Times,serif" font-size="14.00">Gate Layer 6 GPU 5</text>
<text text-anchor="middle" x="5990" y="-7228.79" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5990" y="-7213.79" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer6_gpu5&#45;&gt;gate_layer6_gpu5 -->
<g id="edge598" class="edge">
<title>mha_layer6_gpu5&#45;&gt;gate_layer6_gpu5</title>
<path fill="none" stroke="black" d="M6260.24,-7321.37C6218.49,-7307.79 6166.14,-7290.77 6118.66,-7275.33"/>
<polygon fill="black" stroke="black" points="6119.52,-7271.93 6108.93,-7272.16 6117.35,-7278.58 6119.52,-7271.93"/>
</g>
<!-- gate_layer6_gpu6 -->
<g id="node510" class="node">
<title>gate_layer6_gpu6</title>
<path fill="lightsteelblue" stroke="black" d="M6942.07,-7284.15C6942.07,-7284.15 6492.93,-7233.82 6492.93,-7233.82 6486.96,-7233.15 6486.96,-7231.82 6492.93,-7231.15 6492.93,-7231.15 6942.07,-7180.82 6942.07,-7180.82 6948.04,-7180.15 6959.96,-7180.15 6965.93,-7180.82 6965.93,-7180.82 7415.07,-7231.15 7415.07,-7231.15 7421.04,-7231.82 7421.04,-7233.15 7415.07,-7233.82 7415.07,-7233.82 6965.93,-7284.15 6965.93,-7284.15 6959.96,-7284.82 6948.04,-7284.82 6942.07,-7284.15"/>
<text text-anchor="middle" x="6954" y="-7243.79" font-family="Times,serif" font-size="14.00">Gate Layer 6 GPU 6</text>
<text text-anchor="middle" x="6954" y="-7228.79" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6954" y="-7213.79" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer6_gpu6&#45;&gt;gate_layer6_gpu6 -->
<g id="edge599" class="edge">
<title>mha_layer6_gpu6&#45;&gt;gate_layer6_gpu6</title>
<path fill="none" stroke="black" d="M7116.61,-7321.37C7094.75,-7309.56 7068.07,-7295.14 7042.69,-7281.42"/>
<polygon fill="black" stroke="black" points="7044.24,-7278.28 7033.77,-7276.6 7040.91,-7284.44 7044.24,-7278.28"/>
</g>
<!-- gate_layer6_gpu7 -->
<g id="node511" class="node">
<title>gate_layer6_gpu7</title>
<path fill="lightsteelblue" stroke="black" d="M7906.07,-7284.15C7906.07,-7284.15 7456.93,-7233.82 7456.93,-7233.82 7450.96,-7233.15 7450.96,-7231.82 7456.93,-7231.15 7456.93,-7231.15 7906.07,-7180.82 7906.07,-7180.82 7912.04,-7180.15 7923.96,-7180.15 7929.93,-7180.82 7929.93,-7180.82 8379.07,-7231.15 8379.07,-7231.15 8385.04,-7231.82 8385.04,-7233.15 8379.07,-7233.82 8379.07,-7233.82 7929.93,-7284.15 7929.93,-7284.15 7923.96,-7284.82 7912.04,-7284.82 7906.07,-7284.15"/>
<text text-anchor="middle" x="7918" y="-7243.79" font-family="Times,serif" font-size="14.00">Gate Layer 6 GPU 7</text>
<text text-anchor="middle" x="7918" y="-7228.79" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="7918" y="-7213.79" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer6_gpu7&#45;&gt;gate_layer6_gpu7 -->
<g id="edge600" class="edge">
<title>mha_layer6_gpu7&#45;&gt;gate_layer6_gpu7</title>
<path fill="none" stroke="black" d="M7938.87,-7321.23C7936.93,-7313.08 7934.7,-7303.69 7932.43,-7294.15"/>
<polygon fill="black" stroke="black" points="7935.79,-7293.13 7930.07,-7284.21 7928.98,-7294.75 7935.79,-7293.13"/>
</g>
<!-- gate_layer6_gpu8 -->
<g id="node512" class="node">
<title>gate_layer6_gpu8</title>
<path fill="lightsteelblue" stroke="black" d="M8870.07,-7284.15C8870.07,-7284.15 8420.93,-7233.82 8420.93,-7233.82 8414.96,-7233.15 8414.96,-7231.82 8420.93,-7231.15 8420.93,-7231.15 8870.07,-7180.82 8870.07,-7180.82 8876.04,-7180.15 8887.96,-7180.15 8893.93,-7180.82 8893.93,-7180.82 9343.07,-7231.15 9343.07,-7231.15 9349.04,-7231.82 9349.04,-7233.15 9343.07,-7233.82 9343.07,-7233.82 8893.93,-7284.15 8893.93,-7284.15 8887.96,-7284.82 8876.04,-7284.82 8870.07,-7284.15"/>
<text text-anchor="middle" x="8882" y="-7243.79" font-family="Times,serif" font-size="14.00">Gate Layer 6 GPU 8</text>
<text text-anchor="middle" x="8882" y="-7228.79" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="8882" y="-7213.79" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer6_gpu8&#45;&gt;gate_layer6_gpu8 -->
<g id="edge601" class="edge">
<title>mha_layer6_gpu8&#45;&gt;gate_layer6_gpu8</title>
<path fill="none" stroke="black" d="M8840.25,-7321.23C8844.35,-7312.62 8849.1,-7302.63 8853.9,-7292.55"/>
<polygon fill="black" stroke="black" points="8857.17,-7293.83 8858.3,-7283.3 8850.85,-7290.82 8857.17,-7293.83"/>
</g>
<!-- gate_layer6_gpu9 -->
<g id="node513" class="node">
<title>gate_layer6_gpu9</title>
<path fill="lightsteelblue" stroke="black" d="M9834.07,-7284.15C9834.07,-7284.15 9384.93,-7233.82 9384.93,-7233.82 9378.96,-7233.15 9378.96,-7231.82 9384.93,-7231.15 9384.93,-7231.15 9834.07,-7180.82 9834.07,-7180.82 9840.04,-7180.15 9851.96,-7180.15 9857.93,-7180.82 9857.93,-7180.82 10307.07,-7231.15 10307.07,-7231.15 10313.04,-7231.82 10313.04,-7233.15 10307.07,-7233.82 10307.07,-7233.82 9857.93,-7284.15 9857.93,-7284.15 9851.96,-7284.82 9840.04,-7284.82 9834.07,-7284.15"/>
<text text-anchor="middle" x="9846" y="-7243.79" font-family="Times,serif" font-size="14.00">Gate Layer 6 GPU 9</text>
<text text-anchor="middle" x="9846" y="-7228.79" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="9846" y="-7213.79" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer6_gpu9&#45;&gt;gate_layer6_gpu9 -->
<g id="edge602" class="edge">
<title>mha_layer6_gpu9&#45;&gt;gate_layer6_gpu9</title>
<path fill="none" stroke="black" d="M9826.67,-7321.23C9828.45,-7313.17 9830.49,-7303.91 9832.56,-7294.49"/>
<polygon fill="black" stroke="black" points="9835.99,-7295.19 9834.73,-7284.67 9829.16,-7293.68 9835.99,-7295.19"/>
</g>
<!-- gate_layer6_gpu10 -->
<g id="node514" class="node">
<title>gate_layer6_gpu10</title>
<path fill="lightsteelblue" stroke="black" d="M10798.07,-7284.15C10798.07,-7284.15 10348.93,-7233.82 10348.93,-7233.82 10342.96,-7233.15 10342.96,-7231.82 10348.93,-7231.15 10348.93,-7231.15 10798.07,-7180.82 10798.07,-7180.82 10804.04,-7180.15 10815.96,-7180.15 10821.93,-7180.82 10821.93,-7180.82 11271.07,-7231.15 11271.07,-7231.15 11277.04,-7231.82 11277.04,-7233.15 11271.07,-7233.82 11271.07,-7233.82 10821.93,-7284.15 10821.93,-7284.15 10815.96,-7284.82 10804.04,-7284.82 10798.07,-7284.15"/>
<text text-anchor="middle" x="10810" y="-7243.79" font-family="Times,serif" font-size="14.00">Gate Layer 6 GPU 10</text>
<text text-anchor="middle" x="10810" y="-7228.79" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="10810" y="-7213.79" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer6_gpu10&#45;&gt;gate_layer6_gpu10 -->
<g id="edge603" class="edge">
<title>mha_layer6_gpu10&#45;&gt;gate_layer6_gpu10</title>
<path fill="none" stroke="black" d="M10471.34,-7321.44C10526.89,-7307.02 10597.47,-7288.69 10659.81,-7272.5"/>
<polygon fill="black" stroke="black" points="10660.94,-7275.82 10669.74,-7269.92 10659.18,-7269.04 10660.94,-7275.82"/>
</g>
<!-- gate_layer6_gpu11 -->
<g id="node515" class="node">
<title>gate_layer6_gpu11</title>
<path fill="lightsteelblue" stroke="black" d="M11762.07,-7284.15C11762.07,-7284.15 11312.93,-7233.82 11312.93,-7233.82 11306.96,-7233.15 11306.96,-7231.82 11312.93,-7231.15 11312.93,-7231.15 11762.07,-7180.82 11762.07,-7180.82 11768.04,-7180.15 11779.96,-7180.15 11785.93,-7180.82 11785.93,-7180.82 12235.07,-7231.15 12235.07,-7231.15 12241.04,-7231.82 12241.04,-7233.15 12235.07,-7233.82 12235.07,-7233.82 11785.93,-7284.15 11785.93,-7284.15 11779.96,-7284.82 11768.04,-7284.82 11762.07,-7284.15"/>
<text text-anchor="middle" x="11774" y="-7243.79" font-family="Times,serif" font-size="14.00">Gate Layer 6 GPU 11</text>
<text text-anchor="middle" x="11774" y="-7228.79" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11774" y="-7213.79" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer6_gpu11&#45;&gt;gate_layer6_gpu11 -->
<g id="edge604" class="edge">
<title>mha_layer6_gpu11&#45;&gt;gate_layer6_gpu11</title>
<path fill="none" stroke="black" d="M11750.03,-7321.23C11752.26,-7313.08 11754.83,-7303.69 11757.43,-7294.15"/>
<polygon fill="black" stroke="black" points="11760.89,-7294.78 11760.15,-7284.21 11754.14,-7292.93 11760.89,-7294.78"/>
</g>
<!-- gate_layer6_gpu12 -->
<g id="node516" class="node">
<title>gate_layer6_gpu12</title>
<path fill="lightsteelblue" stroke="black" d="M12726.07,-7284.15C12726.07,-7284.15 12276.93,-7233.82 12276.93,-7233.82 12270.96,-7233.15 12270.96,-7231.82 12276.93,-7231.15 12276.93,-7231.15 12726.07,-7180.82 12726.07,-7180.82 12732.04,-7180.15 12743.96,-7180.15 12749.93,-7180.82 12749.93,-7180.82 13199.07,-7231.15 13199.07,-7231.15 13205.04,-7231.82 13205.04,-7233.15 13199.07,-7233.82 13199.07,-7233.82 12749.93,-7284.15 12749.93,-7284.15 12743.96,-7284.82 12732.04,-7284.82 12726.07,-7284.15"/>
<text text-anchor="middle" x="12738" y="-7243.79" font-family="Times,serif" font-size="14.00">Gate Layer 6 GPU 12</text>
<text text-anchor="middle" x="12738" y="-7228.79" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="12738" y="-7213.79" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer6_gpu12&#45;&gt;gate_layer6_gpu12 -->
<g id="edge605" class="edge">
<title>mha_layer6_gpu12&#45;&gt;gate_layer6_gpu12</title>
<path fill="none" stroke="black" d="M12479.37,-7321.37C12518.89,-7307.94 12568.32,-7291.15 12613.35,-7275.84"/>
<polygon fill="black" stroke="black" points="12614.55,-7279.13 12622.89,-7272.6 12612.3,-7272.51 12614.55,-7279.13"/>
</g>
<!-- gate_layer6_gpu13 -->
<g id="node517" class="node">
<title>gate_layer6_gpu13</title>
<path fill="lightsteelblue" stroke="black" d="M13690.07,-7284.15C13690.07,-7284.15 13240.93,-7233.82 13240.93,-7233.82 13234.96,-7233.15 13234.96,-7231.82 13240.93,-7231.15 13240.93,-7231.15 13690.07,-7180.82 13690.07,-7180.82 13696.04,-7180.15 13707.96,-7180.15 13713.93,-7180.82 13713.93,-7180.82 14163.07,-7231.15 14163.07,-7231.15 14169.04,-7231.82 14169.04,-7233.15 14163.07,-7233.82 14163.07,-7233.82 13713.93,-7284.15 13713.93,-7284.15 13707.96,-7284.82 13696.04,-7284.82 13690.07,-7284.15"/>
<text text-anchor="middle" x="13702" y="-7243.79" font-family="Times,serif" font-size="14.00">Gate Layer 6 GPU 13</text>
<text text-anchor="middle" x="13702" y="-7228.79" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13702" y="-7213.79" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer6_gpu13&#45;&gt;gate_layer6_gpu13 -->
<g id="edge606" class="edge">
<title>mha_layer6_gpu13&#45;&gt;gate_layer6_gpu13</title>
<path fill="none" stroke="black" d="M13141.71,-7321.44C13247.21,-7304.88 13385.49,-7283.17 13498.28,-7265.47"/>
<polygon fill="black" stroke="black" points="13499.08,-7268.88 13508.42,-7263.88 13498,-7261.97 13499.08,-7268.88"/>
</g>
<!-- gate_layer6_gpu14 -->
<g id="node518" class="node">
<title>gate_layer6_gpu14</title>
<path fill="lightsteelblue" stroke="black" d="M14654.07,-7284.15C14654.07,-7284.15 14204.93,-7233.82 14204.93,-7233.82 14198.96,-7233.15 14198.96,-7231.82 14204.93,-7231.15 14204.93,-7231.15 14654.07,-7180.82 14654.07,-7180.82 14660.04,-7180.15 14671.96,-7180.15 14677.93,-7180.82 14677.93,-7180.82 15127.07,-7231.15 15127.07,-7231.15 15133.04,-7231.82 15133.04,-7233.15 15127.07,-7233.82 15127.07,-7233.82 14677.93,-7284.15 14677.93,-7284.15 14671.96,-7284.82 14660.04,-7284.82 14654.07,-7284.15"/>
<text text-anchor="middle" x="14666" y="-7243.79" font-family="Times,serif" font-size="14.00">Gate Layer 6 GPU 14</text>
<text text-anchor="middle" x="14666" y="-7228.79" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14666" y="-7213.79" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer6_gpu14&#45;&gt;gate_layer6_gpu14 -->
<g id="edge607" class="edge">
<title>mha_layer6_gpu14&#45;&gt;gate_layer6_gpu14</title>
<path fill="none" stroke="black" d="M14466.22,-7321.37C14494.61,-7308.88 14529.63,-7293.48 14562.38,-7279.07"/>
<polygon fill="black" stroke="black" points="14563.8,-7282.27 14571.55,-7275.04 14560.98,-7275.86 14563.8,-7282.27"/>
</g>
<!-- gate_layer6_gpu15 -->
<g id="node519" class="node">
<title>gate_layer6_gpu15</title>
<path fill="lightsteelblue" stroke="black" d="M15618.07,-7284.15C15618.07,-7284.15 15168.93,-7233.82 15168.93,-7233.82 15162.96,-7233.15 15162.96,-7231.82 15168.93,-7231.15 15168.93,-7231.15 15618.07,-7180.82 15618.07,-7180.82 15624.04,-7180.15 15635.96,-7180.15 15641.93,-7180.82 15641.93,-7180.82 16091.07,-7231.15 16091.07,-7231.15 16097.04,-7231.82 16097.04,-7233.15 16091.07,-7233.82 16091.07,-7233.82 15641.93,-7284.15 15641.93,-7284.15 15635.96,-7284.82 15624.04,-7284.82 15618.07,-7284.15"/>
<text text-anchor="middle" x="15630" y="-7243.79" font-family="Times,serif" font-size="14.00">Gate Layer 6 GPU 15</text>
<text text-anchor="middle" x="15630" y="-7228.79" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="15630" y="-7213.79" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer6_gpu15&#45;&gt;gate_layer6_gpu15 -->
<g id="edge608" class="edge">
<title>mha_layer6_gpu15&#45;&gt;gate_layer6_gpu15</title>
<path fill="none" stroke="black" d="M15476.93,-7321.23C15497.06,-7309.69 15521.5,-7295.68 15544.88,-7282.28"/>
<polygon fill="black" stroke="black" points="15546.85,-7285.19 15553.78,-7277.18 15543.37,-7279.11 15546.85,-7285.19"/>
</g>
<!-- route_layer6_gpu0 -->
<g id="node536" class="node">
<title>route_layer6_gpu0</title>
<path fill="orange" stroke="black" d="M1768.74,-7143.49C1768.74,-7143.49 1260.24,-7143.49 1260.24,-7143.49 1254.24,-7143.49 1243.5,-7139.81 1238.75,-7136.14 1238.75,-7136.14 1120.75,-7044.83 1120.75,-7044.83 1116,-7041.16 1117.26,-7037.49 1123.26,-7037.49 1123.26,-7037.49 1631.76,-7037.49 1631.76,-7037.49 1637.76,-7037.49 1648.5,-7041.16 1653.25,-7044.83 1653.25,-7044.83 1771.25,-7136.14 1771.25,-7136.14 1776,-7139.81 1774.74,-7143.49 1768.74,-7143.49"/>
<text text-anchor="middle" x="1446" y="-7101.79" font-family="Times,serif" font-size="14.00">Token Router Layer 6 GPU 0</text>
<text text-anchor="middle" x="1446" y="-7086.79" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="1446" y="-7071.79" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer6_gpu0&#45;&gt;route_layer6_gpu0 -->
<g id="edge609" class="edge">
<title>gate_layer6_gpu0&#45;&gt;route_layer6_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1254.31,-7188.72C1279.52,-7175.93 1307.56,-7161.71 1334.24,-7148.17"/>
<polygon fill="black" stroke="black" points="1335.9,-7151.26 1343.23,-7143.61 1332.73,-7145.02 1335.9,-7151.26"/>
</g>
<!-- route_layer6_gpu1 -->
<g id="node538" class="node">
<title>route_layer6_gpu1</title>
<path fill="orange" stroke="black" d="M2766.74,-7143.49C2766.74,-7143.49 2258.24,-7143.49 2258.24,-7143.49 2252.24,-7143.49 2241.5,-7139.81 2236.75,-7136.14 2236.75,-7136.14 2118.75,-7044.83 2118.75,-7044.83 2114,-7041.16 2115.26,-7037.49 2121.26,-7037.49 2121.26,-7037.49 2629.76,-7037.49 2629.76,-7037.49 2635.76,-7037.49 2646.5,-7041.16 2651.25,-7044.83 2651.25,-7044.83 2769.25,-7136.14 2769.25,-7136.14 2774,-7139.81 2772.74,-7143.49 2766.74,-7143.49"/>
<text text-anchor="middle" x="2444" y="-7101.79" font-family="Times,serif" font-size="14.00">Token Router Layer 6 GPU 1</text>
<text text-anchor="middle" x="2444" y="-7086.79" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="2444" y="-7071.79" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer6_gpu1&#45;&gt;route_layer6_gpu1 -->
<g id="edge610" class="edge">
<title>gate_layer6_gpu1&#45;&gt;route_layer6_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2226.59,-7189.67C2255.82,-7176.47 2288.6,-7161.67 2319.67,-7147.63"/>
<polygon fill="black" stroke="black" points="2321.15,-7150.81 2328.82,-7143.5 2318.26,-7144.43 2321.15,-7150.81"/>
</g>
<!-- route_layer6_gpu2 -->
<g id="node540" class="node">
<title>route_layer6_gpu2</title>
<path fill="orange" stroke="black" d="M3592.74,-7143.49C3592.74,-7143.49 3084.24,-7143.49 3084.24,-7143.49 3078.24,-7143.49 3067.5,-7139.81 3062.75,-7136.14 3062.75,-7136.14 2944.75,-7044.83 2944.75,-7044.83 2940,-7041.16 2941.26,-7037.49 2947.26,-7037.49 2947.26,-7037.49 3455.76,-7037.49 3455.76,-7037.49 3461.76,-7037.49 3472.5,-7041.16 3477.25,-7044.83 3477.25,-7044.83 3595.25,-7136.14 3595.25,-7136.14 3600,-7139.81 3598.74,-7143.49 3592.74,-7143.49"/>
<text text-anchor="middle" x="3270" y="-7101.79" font-family="Times,serif" font-size="14.00">Token Router Layer 6 GPU 2</text>
<text text-anchor="middle" x="3270" y="-7086.79" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="3270" y="-7071.79" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer6_gpu2&#45;&gt;route_layer6_gpu2 -->
<g id="edge611" class="edge">
<title>gate_layer6_gpu2&#45;&gt;route_layer6_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3154.32,-7185.65C3168.29,-7174.27 3183.45,-7161.93 3198.06,-7150.05"/>
<polygon fill="black" stroke="black" points="3200.56,-7152.52 3206.1,-7143.5 3196.14,-7147.09 3200.56,-7152.52"/>
</g>
<!-- route_layer6_gpu3 -->
<g id="node542" class="node">
<title>route_layer6_gpu3</title>
<path fill="orange" stroke="black" d="M4522.74,-7143.49C4522.74,-7143.49 4014.24,-7143.49 4014.24,-7143.49 4008.24,-7143.49 3997.5,-7139.81 3992.75,-7136.14 3992.75,-7136.14 3874.75,-7044.83 3874.75,-7044.83 3870,-7041.16 3871.26,-7037.49 3877.26,-7037.49 3877.26,-7037.49 4385.76,-7037.49 4385.76,-7037.49 4391.76,-7037.49 4402.5,-7041.16 4407.25,-7044.83 4407.25,-7044.83 4525.25,-7136.14 4525.25,-7136.14 4530,-7139.81 4528.74,-7143.49 4522.74,-7143.49"/>
<text text-anchor="middle" x="4200" y="-7101.79" font-family="Times,serif" font-size="14.00">Token Router Layer 6 GPU 3</text>
<text text-anchor="middle" x="4200" y="-7086.79" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="4200" y="-7071.79" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer6_gpu3&#45;&gt;route_layer6_gpu3 -->
<g id="edge612" class="edge">
<title>gate_layer6_gpu3&#45;&gt;route_layer6_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4108.34,-7184.48C4118.87,-7173.79 4130.2,-7162.3 4141.17,-7151.17"/>
<polygon fill="black" stroke="black" points="4143.8,-7153.49 4148.32,-7143.91 4138.81,-7148.58 4143.8,-7153.49"/>
</g>
<!-- route_layer6_gpu4 -->
<g id="node544" class="node">
<title>route_layer6_gpu4</title>
<path fill="orange" stroke="black" d="M5762.74,-7143.49C5762.74,-7143.49 5254.24,-7143.49 5254.24,-7143.49 5248.24,-7143.49 5237.5,-7139.81 5232.75,-7136.14 5232.75,-7136.14 5114.75,-7044.83 5114.75,-7044.83 5110,-7041.16 5111.26,-7037.49 5117.26,-7037.49 5117.26,-7037.49 5625.76,-7037.49 5625.76,-7037.49 5631.76,-7037.49 5642.5,-7041.16 5647.25,-7044.83 5647.25,-7044.83 5765.25,-7136.14 5765.25,-7136.14 5770,-7139.81 5768.74,-7143.49 5762.74,-7143.49"/>
<text text-anchor="middle" x="5440" y="-7101.79" font-family="Times,serif" font-size="14.00">Token Router Layer 6 GPU 4</text>
<text text-anchor="middle" x="5440" y="-7086.79" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="5440" y="-7071.79" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer6_gpu4&#45;&gt;route_layer6_gpu4 -->
<g id="edge613" class="edge">
<title>gate_layer6_gpu4&#45;&gt;route_layer6_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5141.6,-7192.4C5183.36,-7178.27 5231.34,-7162.05 5276.44,-7146.8"/>
<polygon fill="black" stroke="black" points="5277.66,-7150.08 5286.01,-7143.56 5275.42,-7143.45 5277.66,-7150.08"/>
</g>
<!-- route_layer6_gpu5 -->
<g id="node546" class="node">
<title>route_layer6_gpu5</title>
<path fill="orange" stroke="black" d="M6726.74,-7143.49C6726.74,-7143.49 6218.24,-7143.49 6218.24,-7143.49 6212.24,-7143.49 6201.5,-7139.81 6196.75,-7136.14 6196.75,-7136.14 6078.75,-7044.83 6078.75,-7044.83 6074,-7041.16 6075.26,-7037.49 6081.26,-7037.49 6081.26,-7037.49 6589.76,-7037.49 6589.76,-7037.49 6595.76,-7037.49 6606.5,-7041.16 6611.25,-7044.83 6611.25,-7044.83 6729.25,-7136.14 6729.25,-7136.14 6734,-7139.81 6732.74,-7143.49 6726.74,-7143.49"/>
<text text-anchor="middle" x="6404" y="-7101.79" font-family="Times,serif" font-size="14.00">Token Router Layer 6 GPU 5</text>
<text text-anchor="middle" x="6404" y="-7086.79" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="6404" y="-7071.79" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer6_gpu5&#45;&gt;route_layer6_gpu5 -->
<g id="edge614" class="edge">
<title>gate_layer6_gpu5&#45;&gt;route_layer6_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6105.6,-7192.4C6147.36,-7178.27 6195.34,-7162.05 6240.44,-7146.8"/>
<polygon fill="black" stroke="black" points="6241.66,-7150.08 6250.01,-7143.56 6239.42,-7143.45 6241.66,-7150.08"/>
</g>
<!-- route_layer6_gpu6 -->
<g id="node548" class="node">
<title>route_layer6_gpu6</title>
<path fill="orange" stroke="black" d="M7552.74,-7143.49C7552.74,-7143.49 7044.24,-7143.49 7044.24,-7143.49 7038.24,-7143.49 7027.5,-7139.81 7022.75,-7136.14 7022.75,-7136.14 6904.75,-7044.83 6904.75,-7044.83 6900,-7041.16 6901.26,-7037.49 6907.26,-7037.49 6907.26,-7037.49 7415.76,-7037.49 7415.76,-7037.49 7421.76,-7037.49 7432.5,-7041.16 7437.25,-7044.83 7437.25,-7044.83 7555.25,-7136.14 7555.25,-7136.14 7560,-7139.81 7558.74,-7143.49 7552.74,-7143.49"/>
<text text-anchor="middle" x="7230" y="-7101.79" font-family="Times,serif" font-size="14.00">Token Router Layer 6 GPU 6</text>
<text text-anchor="middle" x="7230" y="-7086.79" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="7230" y="-7071.79" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer6_gpu6&#45;&gt;route_layer6_gpu6 -->
<g id="edge615" class="edge">
<title>gate_layer6_gpu6&#45;&gt;route_layer6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7038.31,-7188.72C7063.52,-7175.93 7091.56,-7161.71 7118.24,-7148.17"/>
<polygon fill="black" stroke="black" points="7119.9,-7151.26 7127.23,-7143.61 7116.73,-7145.02 7119.9,-7151.26"/>
</g>
<!-- route_layer6_gpu7 -->
<g id="node550" class="node">
<title>route_layer6_gpu7</title>
<path fill="orange" stroke="black" d="M8309.74,-7143.49C8309.74,-7143.49 7801.24,-7143.49 7801.24,-7143.49 7795.24,-7143.49 7784.5,-7139.81 7779.75,-7136.14 7779.75,-7136.14 7661.75,-7044.83 7661.75,-7044.83 7657,-7041.16 7658.26,-7037.49 7664.26,-7037.49 7664.26,-7037.49 8172.76,-7037.49 8172.76,-7037.49 8178.76,-7037.49 8189.5,-7041.16 8194.25,-7044.83 8194.25,-7044.83 8312.25,-7136.14 8312.25,-7136.14 8317,-7139.81 8315.74,-7143.49 8309.74,-7143.49"/>
<text text-anchor="middle" x="7987" y="-7101.79" font-family="Times,serif" font-size="14.00">Token Router Layer 6 GPU 7</text>
<text text-anchor="middle" x="7987" y="-7086.79" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="7987" y="-7071.79" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer6_gpu7&#45;&gt;route_layer6_gpu7 -->
<g id="edge616" class="edge">
<title>gate_layer6_gpu7&#45;&gt;route_layer6_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7942.33,-7182.13C7946.97,-7172.7 7951.89,-7162.73 7956.69,-7152.98"/>
<polygon fill="black" stroke="black" points="7959.97,-7154.24 7961.26,-7143.72 7953.7,-7151.14 7959.97,-7154.24"/>
</g>
<!-- route_layer6_gpu8 -->
<g id="node552" class="node">
<title>route_layer6_gpu8</title>
<path fill="orange" stroke="black" d="M9135.74,-7143.49C9135.74,-7143.49 8627.24,-7143.49 8627.24,-7143.49 8621.24,-7143.49 8610.5,-7139.81 8605.75,-7136.14 8605.75,-7136.14 8487.75,-7044.83 8487.75,-7044.83 8483,-7041.16 8484.26,-7037.49 8490.26,-7037.49 8490.26,-7037.49 8998.76,-7037.49 8998.76,-7037.49 9004.76,-7037.49 9015.5,-7041.16 9020.25,-7044.83 9020.25,-7044.83 9138.25,-7136.14 9138.25,-7136.14 9143,-7139.81 9141.74,-7143.49 9135.74,-7143.49"/>
<text text-anchor="middle" x="8813" y="-7101.79" font-family="Times,serif" font-size="14.00">Token Router Layer 6 GPU 8</text>
<text text-anchor="middle" x="8813" y="-7086.79" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="8813" y="-7071.79" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer6_gpu8&#45;&gt;route_layer6_gpu8 -->
<g id="edge617" class="edge">
<title>gate_layer6_gpu8&#45;&gt;route_layer6_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8857.67,-7182.13C8853.03,-7172.7 8848.11,-7162.73 8843.31,-7152.98"/>
<polygon fill="black" stroke="black" points="8846.3,-7151.14 8838.74,-7143.72 8840.03,-7154.24 8846.3,-7151.14"/>
</g>
<!-- route_layer6_gpu9 -->
<g id="node554" class="node">
<title>route_layer6_gpu9</title>
<path fill="orange" stroke="black" d="M10030.74,-7143.49C10030.74,-7143.49 9522.24,-7143.49 9522.24,-7143.49 9516.24,-7143.49 9505.5,-7139.81 9500.75,-7136.14 9500.75,-7136.14 9382.75,-7044.83 9382.75,-7044.83 9378,-7041.16 9379.26,-7037.49 9385.26,-7037.49 9385.26,-7037.49 9893.76,-7037.49 9893.76,-7037.49 9899.76,-7037.49 9910.5,-7041.16 9915.25,-7044.83 9915.25,-7044.83 10033.25,-7136.14 10033.25,-7136.14 10038,-7139.81 10036.74,-7143.49 10030.74,-7143.49"/>
<text text-anchor="middle" x="9708" y="-7101.79" font-family="Times,serif" font-size="14.00">Token Router Layer 6 GPU 9</text>
<text text-anchor="middle" x="9708" y="-7086.79" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="9708" y="-7071.79" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer6_gpu9&#45;&gt;route_layer6_gpu9 -->
<g id="edge618" class="edge">
<title>gate_layer6_gpu9&#45;&gt;route_layer6_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9799.66,-7184.48C9789.13,-7173.79 9777.8,-7162.3 9766.83,-7151.17"/>
<polygon fill="black" stroke="black" points="9769.19,-7148.58 9759.68,-7143.91 9764.2,-7153.49 9769.19,-7148.58"/>
</g>
<!-- route_layer6_gpu10 -->
<g id="node556" class="node">
<title>route_layer6_gpu10</title>
<path fill="orange" stroke="black" d="M10959.74,-7143.49C10959.74,-7143.49 10451.24,-7143.49 10451.24,-7143.49 10445.24,-7143.49 10434.5,-7139.81 10429.75,-7136.14 10429.75,-7136.14 10311.75,-7044.83 10311.75,-7044.83 10307,-7041.16 10308.26,-7037.49 10314.26,-7037.49 10314.26,-7037.49 10822.76,-7037.49 10822.76,-7037.49 10828.76,-7037.49 10839.5,-7041.16 10844.25,-7044.83 10844.25,-7044.83 10962.25,-7136.14 10962.25,-7136.14 10967,-7139.81 10965.74,-7143.49 10959.74,-7143.49"/>
<text text-anchor="middle" x="10637" y="-7101.79" font-family="Times,serif" font-size="14.00">Token Router Layer 6 GPU 10</text>
<text text-anchor="middle" x="10637" y="-7086.79" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="10637" y="-7071.79" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer6_gpu10&#45;&gt;route_layer6_gpu10 -->
<g id="edge619" class="edge">
<title>gate_layer6_gpu10&#45;&gt;route_layer6_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10753.35,-7185.65C10739.3,-7174.27 10724.05,-7161.93 10709.36,-7150.05"/>
<polygon fill="black" stroke="black" points="10711.24,-7147.07 10701.27,-7143.5 10706.84,-7152.51 10711.24,-7147.07"/>
</g>
<!-- route_layer6_gpu11 -->
<g id="node558" class="node">
<title>route_layer6_gpu11</title>
<path fill="orange" stroke="black" d="M11906.74,-7143.49C11906.74,-7143.49 11398.24,-7143.49 11398.24,-7143.49 11392.24,-7143.49 11381.5,-7139.81 11376.75,-7136.14 11376.75,-7136.14 11258.75,-7044.83 11258.75,-7044.83 11254,-7041.16 11255.26,-7037.49 11261.26,-7037.49 11261.26,-7037.49 11769.76,-7037.49 11769.76,-7037.49 11775.76,-7037.49 11786.5,-7041.16 11791.25,-7044.83 11791.25,-7044.83 11909.25,-7136.14 11909.25,-7136.14 11914,-7139.81 11912.74,-7143.49 11906.74,-7143.49"/>
<text text-anchor="middle" x="11584" y="-7101.79" font-family="Times,serif" font-size="14.00">Token Router Layer 6 GPU 11</text>
<text text-anchor="middle" x="11584" y="-7086.79" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="11584" y="-7071.79" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer6_gpu11&#45;&gt;route_layer6_gpu11 -->
<g id="edge620" class="edge">
<title>gate_layer6_gpu11&#45;&gt;route_layer6_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11712.57,-7186.23C11696.74,-7174.55 11679.47,-7161.83 11662.87,-7149.6"/>
<polygon fill="black" stroke="black" points="11664.92,-7146.76 11654.79,-7143.65 11660.77,-7152.4 11664.92,-7146.76"/>
</g>
<!-- route_layer6_gpu12 -->
<g id="node560" class="node">
<title>route_layer6_gpu12</title>
<path fill="orange" stroke="black" d="M12861.74,-7143.49C12861.74,-7143.49 12353.24,-7143.49 12353.24,-7143.49 12347.24,-7143.49 12336.5,-7139.81 12331.75,-7136.14 12331.75,-7136.14 12213.75,-7044.83 12213.75,-7044.83 12209,-7041.16 12210.26,-7037.49 12216.26,-7037.49 12216.26,-7037.49 12724.76,-7037.49 12724.76,-7037.49 12730.76,-7037.49 12741.5,-7041.16 12746.25,-7044.83 12746.25,-7044.83 12864.25,-7136.14 12864.25,-7136.14 12869,-7139.81 12867.74,-7143.49 12861.74,-7143.49"/>
<text text-anchor="middle" x="12539" y="-7101.79" font-family="Times,serif" font-size="14.00">Token Router Layer 6 GPU 12</text>
<text text-anchor="middle" x="12539" y="-7086.79" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="12539" y="-7071.79" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer6_gpu12&#45;&gt;route_layer6_gpu12 -->
<g id="edge621" class="edge">
<title>gate_layer6_gpu12&#45;&gt;route_layer6_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12674.21,-7186.61C12657.51,-7174.86 12639.25,-7162.02 12621.71,-7149.68"/>
<polygon fill="black" stroke="black" points="12623.36,-7146.56 12613.17,-7143.67 12619.34,-7152.28 12623.36,-7146.56"/>
</g>
<!-- route_layer6_gpu13 -->
<g id="node562" class="node">
<title>route_layer6_gpu13</title>
<path fill="orange" stroke="black" d="M13821.74,-7143.49C13821.74,-7143.49 13313.24,-7143.49 13313.24,-7143.49 13307.24,-7143.49 13296.5,-7139.81 13291.75,-7136.14 13291.75,-7136.14 13173.75,-7044.83 13173.75,-7044.83 13169,-7041.16 13170.26,-7037.49 13176.26,-7037.49 13176.26,-7037.49 13684.76,-7037.49 13684.76,-7037.49 13690.76,-7037.49 13701.5,-7041.16 13706.25,-7044.83 13706.25,-7044.83 13824.25,-7136.14 13824.25,-7136.14 13829,-7139.81 13827.74,-7143.49 13821.74,-7143.49"/>
<text text-anchor="middle" x="13499" y="-7101.79" font-family="Times,serif" font-size="14.00">Token Router Layer 6 GPU 13</text>
<text text-anchor="middle" x="13499" y="-7086.79" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="13499" y="-7071.79" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer6_gpu13&#45;&gt;route_layer6_gpu13 -->
<g id="edge622" class="edge">
<title>gate_layer6_gpu13&#45;&gt;route_layer6_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13636.93,-7186.61C13619.89,-7174.86 13601.27,-7162.02 13583.38,-7149.68"/>
<polygon fill="black" stroke="black" points="13584.88,-7146.46 13574.66,-7143.67 13580.91,-7152.23 13584.88,-7146.46"/>
</g>
<!-- route_layer6_gpu14 -->
<g id="node564" class="node">
<title>route_layer6_gpu14</title>
<path fill="orange" stroke="black" d="M14783.74,-7143.49C14783.74,-7143.49 14275.24,-7143.49 14275.24,-7143.49 14269.24,-7143.49 14258.5,-7139.81 14253.75,-7136.14 14253.75,-7136.14 14135.75,-7044.83 14135.75,-7044.83 14131,-7041.16 14132.26,-7037.49 14138.26,-7037.49 14138.26,-7037.49 14646.76,-7037.49 14646.76,-7037.49 14652.76,-7037.49 14663.5,-7041.16 14668.25,-7044.83 14668.25,-7044.83 14786.25,-7136.14 14786.25,-7136.14 14791,-7139.81 14789.74,-7143.49 14783.74,-7143.49"/>
<text text-anchor="middle" x="14461" y="-7101.79" font-family="Times,serif" font-size="14.00">Token Router Layer 6 GPU 14</text>
<text text-anchor="middle" x="14461" y="-7086.79" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="14461" y="-7071.79" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer6_gpu14&#45;&gt;route_layer6_gpu14 -->
<g id="edge623" class="edge">
<title>gate_layer6_gpu14&#45;&gt;route_layer6_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14600.57,-7186.8C14583.1,-7174.87 14563.96,-7161.8 14545.61,-7149.27"/>
<polygon fill="black" stroke="black" points="14547.47,-7146.3 14537.24,-7143.55 14543.52,-7152.08 14547.47,-7146.3"/>
</g>
<!-- route_layer6_gpu15 -->
<g id="node566" class="node">
<title>route_layer6_gpu15</title>
<path fill="orange" stroke="black" d="M15746.74,-7143.49C15746.74,-7143.49 15238.24,-7143.49 15238.24,-7143.49 15232.24,-7143.49 15221.5,-7139.81 15216.75,-7136.14 15216.75,-7136.14 15098.75,-7044.83 15098.75,-7044.83 15094,-7041.16 15095.26,-7037.49 15101.26,-7037.49 15101.26,-7037.49 15609.76,-7037.49 15609.76,-7037.49 15615.76,-7037.49 15626.5,-7041.16 15631.25,-7044.83 15631.25,-7044.83 15749.25,-7136.14 15749.25,-7136.14 15754,-7139.81 15752.74,-7143.49 15746.74,-7143.49"/>
<text text-anchor="middle" x="15424" y="-7101.79" font-family="Times,serif" font-size="14.00">Token Router Layer 6 GPU 15</text>
<text text-anchor="middle" x="15424" y="-7086.79" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="15424" y="-7071.79" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer6_gpu15&#45;&gt;route_layer6_gpu15 -->
<g id="edge624" class="edge">
<title>gate_layer6_gpu15&#45;&gt;route_layer6_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15564.25,-7186.8C15546.69,-7174.87 15527.46,-7161.8 15509.02,-7149.27"/>
<polygon fill="black" stroke="black" points="15510.85,-7146.28 15500.61,-7143.55 15506.91,-7152.07 15510.85,-7146.28"/>
</g>
<!-- expert_layer6_gpu0_expert0 -->
<g id="node520" class="node">
<title>expert_layer6_gpu0_expert0</title>
<path fill="lightcoral" stroke="black" d="M2108.5,-6890.53C2108.5,-6890.53 1639.5,-6890.53 1639.5,-6890.53 1633.5,-6890.53 1627.5,-6884.53 1627.5,-6878.53 1627.5,-6878.53 1627.5,-6834.53 1627.5,-6834.53 1627.5,-6828.53 1633.5,-6822.53 1639.5,-6822.53 1639.5,-6822.53 2108.5,-6822.53 2108.5,-6822.53 2114.5,-6822.53 2120.5,-6828.53 2120.5,-6834.53 2120.5,-6834.53 2120.5,-6878.53 2120.5,-6878.53 2120.5,-6884.53 2114.5,-6890.53 2108.5,-6890.53"/>
<text text-anchor="middle" x="1874" y="-6875.33" font-family="Times,serif" font-size="14.00">Expert 0 Layer 6 GPU 0</text>
<text text-anchor="middle" x="1874" y="-6860.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="1874" y="-6845.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="1874" y="-6830.33" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer6_gpu0 -->
<g id="node537" class="node">
<title>aggregate_layer6_gpu0</title>
<path fill="orange" stroke="black" d="M1838.29,-6786.53C1838.29,-6786.53 1351.19,-6786.53 1351.19,-6786.53 1345.19,-6786.53 1334.52,-6782.77 1329.85,-6779 1329.85,-6779 1217.06,-6688.06 1217.06,-6688.06 1212.38,-6684.3 1213.71,-6680.53 1219.71,-6680.53 1219.71,-6680.53 1706.81,-6680.53 1706.81,-6680.53 1712.81,-6680.53 1723.48,-6684.3 1728.15,-6688.06 1728.15,-6688.06 1840.94,-6779 1840.94,-6779 1845.62,-6782.77 1844.29,-6786.53 1838.29,-6786.53"/>
<text text-anchor="middle" x="1529" y="-6744.83" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 6 GPU 0</text>
<text text-anchor="middle" x="1529" y="-6729.83" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="1529" y="-6714.83" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer6_gpu0_expert0&#45;&gt;aggregate_layer6_gpu0 -->
<g id="edge657" class="edge">
<title>expert_layer6_gpu0_expert0&#45;&gt;aggregate_layer6_gpu0</title>
<path fill="none" stroke="black" d="M1779.73,-6822.47C1751.07,-6812.42 1718.76,-6801.09 1687.1,-6789.98"/>
<polygon fill="black" stroke="black" points="1687.89,-6786.55 1677.3,-6786.54 1685.58,-6793.16 1687.89,-6786.55"/>
</g>
<!-- expert_layer6_gpu1_expert1 -->
<g id="node521" class="node">
<title>expert_layer6_gpu1_expert1</title>
<path fill="lightcoral" stroke="black" d="M3557.5,-6890.53C3557.5,-6890.53 3088.5,-6890.53 3088.5,-6890.53 3082.5,-6890.53 3076.5,-6884.53 3076.5,-6878.53 3076.5,-6878.53 3076.5,-6834.53 3076.5,-6834.53 3076.5,-6828.53 3082.5,-6822.53 3088.5,-6822.53 3088.5,-6822.53 3557.5,-6822.53 3557.5,-6822.53 3563.5,-6822.53 3569.5,-6828.53 3569.5,-6834.53 3569.5,-6834.53 3569.5,-6878.53 3569.5,-6878.53 3569.5,-6884.53 3563.5,-6890.53 3557.5,-6890.53"/>
<text text-anchor="middle" x="3323" y="-6875.33" font-family="Times,serif" font-size="14.00">Expert 1 Layer 6 GPU 1</text>
<text text-anchor="middle" x="3323" y="-6860.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3323" y="-6845.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3323" y="-6830.33" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer6_gpu1 -->
<g id="node539" class="node">
<title>aggregate_layer6_gpu1</title>
<path fill="orange" stroke="black" d="M3180.29,-6786.53C3180.29,-6786.53 2693.19,-6786.53 2693.19,-6786.53 2687.19,-6786.53 2676.52,-6782.77 2671.85,-6779 2671.85,-6779 2559.06,-6688.06 2559.06,-6688.06 2554.38,-6684.3 2555.71,-6680.53 2561.71,-6680.53 2561.71,-6680.53 3048.81,-6680.53 3048.81,-6680.53 3054.81,-6680.53 3065.48,-6684.3 3070.15,-6688.06 3070.15,-6688.06 3182.94,-6779 3182.94,-6779 3187.62,-6782.77 3186.29,-6786.53 3180.29,-6786.53"/>
<text text-anchor="middle" x="2871" y="-6744.83" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 6 GPU 1</text>
<text text-anchor="middle" x="2871" y="-6729.83" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="2871" y="-6714.83" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer6_gpu1_expert1&#45;&gt;aggregate_layer6_gpu1 -->
<g id="edge658" class="edge">
<title>expert_layer6_gpu1_expert1&#45;&gt;aggregate_layer6_gpu1</title>
<path fill="none" stroke="black" d="M3199.49,-6822.47C3161.05,-6812.18 3117.6,-6800.55 3075.18,-6789.19"/>
<polygon fill="black" stroke="black" points="3075.86,-6785.75 3065.29,-6786.54 3074.05,-6792.51 3075.86,-6785.75"/>
</g>
<!-- expert_layer6_gpu2_expert2 -->
<g id="node522" class="node">
<title>expert_layer6_gpu2_expert2</title>
<path fill="lightcoral" stroke="black" d="M4537.5,-6890.53C4537.5,-6890.53 4068.5,-6890.53 4068.5,-6890.53 4062.5,-6890.53 4056.5,-6884.53 4056.5,-6878.53 4056.5,-6878.53 4056.5,-6834.53 4056.5,-6834.53 4056.5,-6828.53 4062.5,-6822.53 4068.5,-6822.53 4068.5,-6822.53 4537.5,-6822.53 4537.5,-6822.53 4543.5,-6822.53 4549.5,-6828.53 4549.5,-6834.53 4549.5,-6834.53 4549.5,-6878.53 4549.5,-6878.53 4549.5,-6884.53 4543.5,-6890.53 4537.5,-6890.53"/>
<text text-anchor="middle" x="4303" y="-6875.33" font-family="Times,serif" font-size="14.00">Expert 2 Layer 6 GPU 2</text>
<text text-anchor="middle" x="4303" y="-6860.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4303" y="-6845.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4303" y="-6830.33" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer6_gpu2 -->
<g id="node541" class="node">
<title>aggregate_layer6_gpu2</title>
<path fill="orange" stroke="black" d="M4182.29,-6786.53C4182.29,-6786.53 3695.19,-6786.53 3695.19,-6786.53 3689.19,-6786.53 3678.52,-6782.77 3673.85,-6779 3673.85,-6779 3561.06,-6688.06 3561.06,-6688.06 3556.38,-6684.3 3557.71,-6680.53 3563.71,-6680.53 3563.71,-6680.53 4050.81,-6680.53 4050.81,-6680.53 4056.81,-6680.53 4067.48,-6684.3 4072.15,-6688.06 4072.15,-6688.06 4184.94,-6779 4184.94,-6779 4189.62,-6782.77 4188.29,-6786.53 4182.29,-6786.53"/>
<text text-anchor="middle" x="3873" y="-6744.83" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 6 GPU 2</text>
<text text-anchor="middle" x="3873" y="-6729.83" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="3873" y="-6714.83" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer6_gpu2_expert2&#45;&gt;aggregate_layer6_gpu2 -->
<g id="edge659" class="edge">
<title>expert_layer6_gpu2_expert2&#45;&gt;aggregate_layer6_gpu2</title>
<path fill="none" stroke="black" d="M4185.5,-6822.47C4149.01,-6812.2 4107.77,-6800.6 4067.5,-6789.26"/>
<polygon fill="black" stroke="black" points="4068.41,-6785.88 4057.83,-6786.54 4066.51,-6792.62 4068.41,-6785.88"/>
</g>
<!-- expert_layer6_gpu3_expert3 -->
<g id="node523" class="node">
<title>expert_layer6_gpu3_expert3</title>
<path fill="lightcoral" stroke="black" d="M5283.5,-6890.53C5283.5,-6890.53 4814.5,-6890.53 4814.5,-6890.53 4808.5,-6890.53 4802.5,-6884.53 4802.5,-6878.53 4802.5,-6878.53 4802.5,-6834.53 4802.5,-6834.53 4802.5,-6828.53 4808.5,-6822.53 4814.5,-6822.53 4814.5,-6822.53 5283.5,-6822.53 5283.5,-6822.53 5289.5,-6822.53 5295.5,-6828.53 5295.5,-6834.53 5295.5,-6834.53 5295.5,-6878.53 5295.5,-6878.53 5295.5,-6884.53 5289.5,-6890.53 5283.5,-6890.53"/>
<text text-anchor="middle" x="5049" y="-6875.33" font-family="Times,serif" font-size="14.00">Expert 3 Layer 6 GPU 3</text>
<text text-anchor="middle" x="5049" y="-6860.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5049" y="-6845.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5049" y="-6830.33" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer6_gpu3 -->
<g id="node543" class="node">
<title>aggregate_layer6_gpu3</title>
<path fill="orange" stroke="black" d="M5013.29,-6786.53C5013.29,-6786.53 4526.19,-6786.53 4526.19,-6786.53 4520.19,-6786.53 4509.52,-6782.77 4504.85,-6779 4504.85,-6779 4392.06,-6688.06 4392.06,-6688.06 4387.38,-6684.3 4388.71,-6680.53 4394.71,-6680.53 4394.71,-6680.53 4881.81,-6680.53 4881.81,-6680.53 4887.81,-6680.53 4898.48,-6684.3 4903.15,-6688.06 4903.15,-6688.06 5015.94,-6779 5015.94,-6779 5020.62,-6782.77 5019.29,-6786.53 5013.29,-6786.53"/>
<text text-anchor="middle" x="4704" y="-6744.83" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 6 GPU 3</text>
<text text-anchor="middle" x="4704" y="-6729.83" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="4704" y="-6714.83" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer6_gpu3_expert3&#45;&gt;aggregate_layer6_gpu3 -->
<g id="edge660" class="edge">
<title>expert_layer6_gpu3_expert3&#45;&gt;aggregate_layer6_gpu3</title>
<path fill="none" stroke="black" d="M4954.73,-6822.47C4926.07,-6812.42 4893.76,-6801.09 4862.1,-6789.98"/>
<polygon fill="black" stroke="black" points="4862.89,-6786.55 4852.3,-6786.54 4860.58,-6793.16 4862.89,-6786.55"/>
</g>
<!-- expert_layer6_gpu4_expert4 -->
<g id="node524" class="node">
<title>expert_layer6_gpu4_expert4</title>
<path fill="lightcoral" stroke="black" d="M5911.5,-6890.53C5911.5,-6890.53 5442.5,-6890.53 5442.5,-6890.53 5436.5,-6890.53 5430.5,-6884.53 5430.5,-6878.53 5430.5,-6878.53 5430.5,-6834.53 5430.5,-6834.53 5430.5,-6828.53 5436.5,-6822.53 5442.5,-6822.53 5442.5,-6822.53 5911.5,-6822.53 5911.5,-6822.53 5917.5,-6822.53 5923.5,-6828.53 5923.5,-6834.53 5923.5,-6834.53 5923.5,-6878.53 5923.5,-6878.53 5923.5,-6884.53 5917.5,-6890.53 5911.5,-6890.53"/>
<text text-anchor="middle" x="5677" y="-6875.33" font-family="Times,serif" font-size="14.00">Expert 4 Layer 6 GPU 4</text>
<text text-anchor="middle" x="5677" y="-6860.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5677" y="-6845.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5677" y="-6830.33" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer6_gpu4 -->
<g id="node545" class="node">
<title>aggregate_layer6_gpu4</title>
<path fill="orange" stroke="black" d="M5759.29,-6786.53C5759.29,-6786.53 5272.19,-6786.53 5272.19,-6786.53 5266.19,-6786.53 5255.52,-6782.77 5250.85,-6779 5250.85,-6779 5138.06,-6688.06 5138.06,-6688.06 5133.38,-6684.3 5134.71,-6680.53 5140.71,-6680.53 5140.71,-6680.53 5627.81,-6680.53 5627.81,-6680.53 5633.81,-6680.53 5644.48,-6684.3 5649.15,-6688.06 5649.15,-6688.06 5761.94,-6779 5761.94,-6779 5766.62,-6782.77 5765.29,-6786.53 5759.29,-6786.53"/>
<text text-anchor="middle" x="5450" y="-6744.83" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 6 GPU 4</text>
<text text-anchor="middle" x="5450" y="-6729.83" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="5450" y="-6714.83" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer6_gpu4_expert4&#45;&gt;aggregate_layer6_gpu4 -->
<g id="edge661" class="edge">
<title>expert_layer6_gpu4_expert4&#45;&gt;aggregate_layer6_gpu4</title>
<path fill="none" stroke="black" d="M5614.97,-6822.47C5596.9,-6812.84 5576.63,-6802.03 5556.64,-6791.38"/>
<polygon fill="black" stroke="black" points="5558.26,-6788.28 5547.79,-6786.66 5554.97,-6794.45 5558.26,-6788.28"/>
</g>
<!-- expert_layer6_gpu5_expert5 -->
<g id="node525" class="node">
<title>expert_layer6_gpu5_expert5</title>
<path fill="lightcoral" stroke="black" d="M6653.5,-6890.53C6653.5,-6890.53 6184.5,-6890.53 6184.5,-6890.53 6178.5,-6890.53 6172.5,-6884.53 6172.5,-6878.53 6172.5,-6878.53 6172.5,-6834.53 6172.5,-6834.53 6172.5,-6828.53 6178.5,-6822.53 6184.5,-6822.53 6184.5,-6822.53 6653.5,-6822.53 6653.5,-6822.53 6659.5,-6822.53 6665.5,-6828.53 6665.5,-6834.53 6665.5,-6834.53 6665.5,-6878.53 6665.5,-6878.53 6665.5,-6884.53 6659.5,-6890.53 6653.5,-6890.53"/>
<text text-anchor="middle" x="6419" y="-6875.33" font-family="Times,serif" font-size="14.00">Expert 5 Layer 6 GPU 5</text>
<text text-anchor="middle" x="6419" y="-6860.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6419" y="-6845.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6419" y="-6830.33" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer6_gpu5 -->
<g id="node547" class="node">
<title>aggregate_layer6_gpu5</title>
<path fill="orange" stroke="black" d="M6463.29,-6786.53C6463.29,-6786.53 5976.19,-6786.53 5976.19,-6786.53 5970.19,-6786.53 5959.52,-6782.77 5954.85,-6779 5954.85,-6779 5842.06,-6688.06 5842.06,-6688.06 5837.38,-6684.3 5838.71,-6680.53 5844.71,-6680.53 5844.71,-6680.53 6331.81,-6680.53 6331.81,-6680.53 6337.81,-6680.53 6348.48,-6684.3 6353.15,-6688.06 6353.15,-6688.06 6465.94,-6779 6465.94,-6779 6470.62,-6782.77 6469.29,-6786.53 6463.29,-6786.53"/>
<text text-anchor="middle" x="6154" y="-6744.83" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 6 GPU 5</text>
<text text-anchor="middle" x="6154" y="-6729.83" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="6154" y="-6714.83" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer6_gpu5_expert5&#45;&gt;aggregate_layer6_gpu5 -->
<g id="edge662" class="edge">
<title>expert_layer6_gpu5_expert5&#45;&gt;aggregate_layer6_gpu5</title>
<path fill="none" stroke="black" d="M6346.59,-6822.47C6325.05,-6812.64 6300.82,-6801.57 6277.01,-6790.7"/>
<polygon fill="black" stroke="black" points="6278.46,-6787.51 6267.91,-6786.54 6275.55,-6793.88 6278.46,-6787.51"/>
</g>
<!-- expert_layer6_gpu6_expert6 -->
<g id="node526" class="node">
<title>expert_layer6_gpu6_expert6</title>
<path fill="lightcoral" stroke="black" d="M7574.5,-6890.53C7574.5,-6890.53 7105.5,-6890.53 7105.5,-6890.53 7099.5,-6890.53 7093.5,-6884.53 7093.5,-6878.53 7093.5,-6878.53 7093.5,-6834.53 7093.5,-6834.53 7093.5,-6828.53 7099.5,-6822.53 7105.5,-6822.53 7105.5,-6822.53 7574.5,-6822.53 7574.5,-6822.53 7580.5,-6822.53 7586.5,-6828.53 7586.5,-6834.53 7586.5,-6834.53 7586.5,-6878.53 7586.5,-6878.53 7586.5,-6884.53 7580.5,-6890.53 7574.5,-6890.53"/>
<text text-anchor="middle" x="7340" y="-6875.33" font-family="Times,serif" font-size="14.00">Expert 6 Layer 6 GPU 6</text>
<text text-anchor="middle" x="7340" y="-6860.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7340" y="-6845.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7340" y="-6830.33" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer6_gpu6 -->
<g id="node549" class="node">
<title>aggregate_layer6_gpu6</title>
<path fill="orange" stroke="black" d="M7423.29,-6786.53C7423.29,-6786.53 6936.19,-6786.53 6936.19,-6786.53 6930.19,-6786.53 6919.52,-6782.77 6914.85,-6779 6914.85,-6779 6802.06,-6688.06 6802.06,-6688.06 6797.38,-6684.3 6798.71,-6680.53 6804.71,-6680.53 6804.71,-6680.53 7291.81,-6680.53 7291.81,-6680.53 7297.81,-6680.53 7308.48,-6684.3 7313.15,-6688.06 7313.15,-6688.06 7425.94,-6779 7425.94,-6779 7430.62,-6782.77 7429.29,-6786.53 7423.29,-6786.53"/>
<text text-anchor="middle" x="7114" y="-6744.83" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 6 GPU 6</text>
<text text-anchor="middle" x="7114" y="-6729.83" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="7114" y="-6714.83" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer6_gpu6_expert6&#45;&gt;aggregate_layer6_gpu6 -->
<g id="edge663" class="edge">
<title>expert_layer6_gpu6_expert6&#45;&gt;aggregate_layer6_gpu6</title>
<path fill="none" stroke="black" d="M7278.24,-6822.47C7260.34,-6812.88 7240.25,-6802.13 7220.44,-6791.52"/>
<polygon fill="black" stroke="black" points="7221.83,-6788.29 7211.36,-6786.66 7218.52,-6794.47 7221.83,-6788.29"/>
</g>
<!-- expert_layer6_gpu7_expert7 -->
<g id="node527" class="node">
<title>expert_layer6_gpu7_expert7</title>
<path fill="lightcoral" stroke="black" d="M8235.5,-6890.53C8235.5,-6890.53 7766.5,-6890.53 7766.5,-6890.53 7760.5,-6890.53 7754.5,-6884.53 7754.5,-6878.53 7754.5,-6878.53 7754.5,-6834.53 7754.5,-6834.53 7754.5,-6828.53 7760.5,-6822.53 7766.5,-6822.53 7766.5,-6822.53 8235.5,-6822.53 8235.5,-6822.53 8241.5,-6822.53 8247.5,-6828.53 8247.5,-6834.53 8247.5,-6834.53 8247.5,-6878.53 8247.5,-6878.53 8247.5,-6884.53 8241.5,-6890.53 8235.5,-6890.53"/>
<text text-anchor="middle" x="8001" y="-6875.33" font-family="Times,serif" font-size="14.00">Expert 7 Layer 6 GPU 7</text>
<text text-anchor="middle" x="8001" y="-6860.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8001" y="-6845.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8001" y="-6830.33" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer6_gpu7 -->
<g id="node551" class="node">
<title>aggregate_layer6_gpu7</title>
<path fill="orange" stroke="black" d="M8235.29,-6786.53C8235.29,-6786.53 7748.19,-6786.53 7748.19,-6786.53 7742.19,-6786.53 7731.52,-6782.77 7726.85,-6779 7726.85,-6779 7614.06,-6688.06 7614.06,-6688.06 7609.38,-6684.3 7610.71,-6680.53 7616.71,-6680.53 7616.71,-6680.53 8103.81,-6680.53 8103.81,-6680.53 8109.81,-6680.53 8120.48,-6684.3 8125.15,-6688.06 8125.15,-6688.06 8237.94,-6779 8237.94,-6779 8242.62,-6782.77 8241.29,-6786.53 8235.29,-6786.53"/>
<text text-anchor="middle" x="7926" y="-6744.83" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 6 GPU 7</text>
<text text-anchor="middle" x="7926" y="-6729.83" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="7926" y="-6714.83" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer6_gpu7_expert7&#45;&gt;aggregate_layer6_gpu7 -->
<g id="edge664" class="edge">
<title>expert_layer6_gpu7_expert7&#45;&gt;aggregate_layer6_gpu7</title>
<path fill="none" stroke="black" d="M7980.51,-6822.47C7975.26,-6814 7969.45,-6804.63 7963.63,-6795.25"/>
<polygon fill="black" stroke="black" points="7966.55,-6793.32 7958.31,-6786.66 7960.6,-6797 7966.55,-6793.32"/>
</g>
<!-- expert_layer6_gpu8_expert8 -->
<g id="node528" class="node">
<title>expert_layer6_gpu8_expert8</title>
<path fill="lightcoral" stroke="black" d="M8896.5,-6890.53C8896.5,-6890.53 8427.5,-6890.53 8427.5,-6890.53 8421.5,-6890.53 8415.5,-6884.53 8415.5,-6878.53 8415.5,-6878.53 8415.5,-6834.53 8415.5,-6834.53 8415.5,-6828.53 8421.5,-6822.53 8427.5,-6822.53 8427.5,-6822.53 8896.5,-6822.53 8896.5,-6822.53 8902.5,-6822.53 8908.5,-6828.53 8908.5,-6834.53 8908.5,-6834.53 8908.5,-6878.53 8908.5,-6878.53 8908.5,-6884.53 8902.5,-6890.53 8896.5,-6890.53"/>
<text text-anchor="middle" x="8662" y="-6875.33" font-family="Times,serif" font-size="14.00">Expert 8 Layer 6 GPU 8</text>
<text text-anchor="middle" x="8662" y="-6860.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8662" y="-6845.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8662" y="-6830.33" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer6_gpu8 -->
<g id="node553" class="node">
<title>aggregate_layer6_gpu8</title>
<path fill="orange" stroke="black" d="M9047.29,-6786.53C9047.29,-6786.53 8560.19,-6786.53 8560.19,-6786.53 8554.19,-6786.53 8543.52,-6782.77 8538.85,-6779 8538.85,-6779 8426.06,-6688.06 8426.06,-6688.06 8421.38,-6684.3 8422.71,-6680.53 8428.71,-6680.53 8428.71,-6680.53 8915.81,-6680.53 8915.81,-6680.53 8921.81,-6680.53 8932.48,-6684.3 8937.15,-6688.06 8937.15,-6688.06 9049.94,-6779 9049.94,-6779 9054.62,-6782.77 9053.29,-6786.53 9047.29,-6786.53"/>
<text text-anchor="middle" x="8738" y="-6744.83" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 6 GPU 8</text>
<text text-anchor="middle" x="8738" y="-6729.83" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="8738" y="-6714.83" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer6_gpu8_expert8&#45;&gt;aggregate_layer6_gpu8 -->
<g id="edge665" class="edge">
<title>expert_layer6_gpu8_expert8&#45;&gt;aggregate_layer6_gpu8</title>
<path fill="none" stroke="black" d="M8682.77,-6822.47C8688.08,-6814 8693.97,-6804.63 8699.86,-6795.25"/>
<polygon fill="black" stroke="black" points="8702.9,-6796.99 8705.26,-6786.66 8696.98,-6793.27 8702.9,-6796.99"/>
</g>
<!-- expert_layer6_gpu9_expert9 -->
<g id="node529" class="node">
<title>expert_layer6_gpu9_expert9</title>
<path fill="lightcoral" stroke="black" d="M9671.5,-6890.53C9671.5,-6890.53 9202.5,-6890.53 9202.5,-6890.53 9196.5,-6890.53 9190.5,-6884.53 9190.5,-6878.53 9190.5,-6878.53 9190.5,-6834.53 9190.5,-6834.53 9190.5,-6828.53 9196.5,-6822.53 9202.5,-6822.53 9202.5,-6822.53 9671.5,-6822.53 9671.5,-6822.53 9677.5,-6822.53 9683.5,-6828.53 9683.5,-6834.53 9683.5,-6834.53 9683.5,-6878.53 9683.5,-6878.53 9683.5,-6884.53 9677.5,-6890.53 9671.5,-6890.53"/>
<text text-anchor="middle" x="9437" y="-6875.33" font-family="Times,serif" font-size="14.00">Expert 9 Layer 6 GPU 9</text>
<text text-anchor="middle" x="9437" y="-6860.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9437" y="-6845.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9437" y="-6830.33" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer6_gpu9 -->
<g id="node555" class="node">
<title>aggregate_layer6_gpu9</title>
<path fill="orange" stroke="black" d="M9935.29,-6786.53C9935.29,-6786.53 9448.19,-6786.53 9448.19,-6786.53 9442.19,-6786.53 9431.52,-6782.77 9426.85,-6779 9426.85,-6779 9314.06,-6688.06 9314.06,-6688.06 9309.38,-6684.3 9310.71,-6680.53 9316.71,-6680.53 9316.71,-6680.53 9803.81,-6680.53 9803.81,-6680.53 9809.81,-6680.53 9820.48,-6684.3 9825.15,-6688.06 9825.15,-6688.06 9937.94,-6779 9937.94,-6779 9942.62,-6782.77 9941.29,-6786.53 9935.29,-6786.53"/>
<text text-anchor="middle" x="9626" y="-6744.83" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 6 GPU 9</text>
<text text-anchor="middle" x="9626" y="-6729.83" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="9626" y="-6714.83" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer6_gpu9_expert9&#45;&gt;aggregate_layer6_gpu9 -->
<g id="edge666" class="edge">
<title>expert_layer6_gpu9_expert9&#45;&gt;aggregate_layer6_gpu9</title>
<path fill="none" stroke="black" d="M9488.65,-6822.47C9503.35,-6813.05 9519.81,-6802.52 9536.09,-6792.09"/>
<polygon fill="black" stroke="black" points="9538.04,-6795 9544.58,-6786.66 9534.27,-6789.1 9538.04,-6795"/>
</g>
<!-- expert_layer6_gpu10_expert10 -->
<g id="node530" class="node">
<title>expert_layer6_gpu10_expert10</title>
<path fill="lightcoral" stroke="black" d="M10500.5,-6890.53C10500.5,-6890.53 10031.5,-6890.53 10031.5,-6890.53 10025.5,-6890.53 10019.5,-6884.53 10019.5,-6878.53 10019.5,-6878.53 10019.5,-6834.53 10019.5,-6834.53 10019.5,-6828.53 10025.5,-6822.53 10031.5,-6822.53 10031.5,-6822.53 10500.5,-6822.53 10500.5,-6822.53 10506.5,-6822.53 10512.5,-6828.53 10512.5,-6834.53 10512.5,-6834.53 10512.5,-6878.53 10512.5,-6878.53 10512.5,-6884.53 10506.5,-6890.53 10500.5,-6890.53"/>
<text text-anchor="middle" x="10266" y="-6875.33" font-family="Times,serif" font-size="14.00">Expert 10 Layer 6 GPU 10</text>
<text text-anchor="middle" x="10266" y="-6860.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10266" y="-6845.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10266" y="-6830.33" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer6_gpu10 -->
<g id="node557" class="node">
<title>aggregate_layer6_gpu10</title>
<path fill="orange" stroke="black" d="M10818.29,-6786.53C10818.29,-6786.53 10331.19,-6786.53 10331.19,-6786.53 10325.19,-6786.53 10314.52,-6782.77 10309.85,-6779 10309.85,-6779 10197.06,-6688.06 10197.06,-6688.06 10192.38,-6684.3 10193.71,-6680.53 10199.71,-6680.53 10199.71,-6680.53 10686.81,-6680.53 10686.81,-6680.53 10692.81,-6680.53 10703.48,-6684.3 10708.15,-6688.06 10708.15,-6688.06 10820.94,-6779 10820.94,-6779 10825.62,-6782.77 10824.29,-6786.53 10818.29,-6786.53"/>
<text text-anchor="middle" x="10509" y="-6744.83" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 6 GPU 10</text>
<text text-anchor="middle" x="10509" y="-6729.83" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="10509" y="-6714.83" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer6_gpu10_expert10&#45;&gt;aggregate_layer6_gpu10 -->
<g id="edge667" class="edge">
<title>expert_layer6_gpu10_expert10&#45;&gt;aggregate_layer6_gpu10</title>
<path fill="none" stroke="black" d="M10332.4,-6822.47C10351.83,-6812.8 10373.64,-6801.93 10395.13,-6791.23"/>
<polygon fill="black" stroke="black" points="10396.92,-6794.25 10404.32,-6786.66 10393.8,-6787.98 10396.92,-6794.25"/>
</g>
<!-- expert_layer6_gpu11_expert11 -->
<g id="node531" class="node">
<title>expert_layer6_gpu11_expert11</title>
<path fill="lightcoral" stroke="black" d="M11300.5,-6890.53C11300.5,-6890.53 10831.5,-6890.53 10831.5,-6890.53 10825.5,-6890.53 10819.5,-6884.53 10819.5,-6878.53 10819.5,-6878.53 10819.5,-6834.53 10819.5,-6834.53 10819.5,-6828.53 10825.5,-6822.53 10831.5,-6822.53 10831.5,-6822.53 11300.5,-6822.53 11300.5,-6822.53 11306.5,-6822.53 11312.5,-6828.53 11312.5,-6834.53 11312.5,-6834.53 11312.5,-6878.53 11312.5,-6878.53 11312.5,-6884.53 11306.5,-6890.53 11300.5,-6890.53"/>
<text text-anchor="middle" x="11066" y="-6875.33" font-family="Times,serif" font-size="14.00">Expert 11 Layer 6 GPU 11</text>
<text text-anchor="middle" x="11066" y="-6860.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11066" y="-6845.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11066" y="-6830.33" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer6_gpu11 -->
<g id="node559" class="node">
<title>aggregate_layer6_gpu11</title>
<path fill="orange" stroke="black" d="M11590.29,-6786.53C11590.29,-6786.53 11103.19,-6786.53 11103.19,-6786.53 11097.19,-6786.53 11086.52,-6782.77 11081.85,-6779 11081.85,-6779 10969.06,-6688.06 10969.06,-6688.06 10964.38,-6684.3 10965.71,-6680.53 10971.71,-6680.53 10971.71,-6680.53 11458.81,-6680.53 11458.81,-6680.53 11464.81,-6680.53 11475.48,-6684.3 11480.15,-6688.06 11480.15,-6688.06 11592.94,-6779 11592.94,-6779 11597.62,-6782.77 11596.29,-6786.53 11590.29,-6786.53"/>
<text text-anchor="middle" x="11281" y="-6744.83" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 6 GPU 11</text>
<text text-anchor="middle" x="11281" y="-6729.83" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="11281" y="-6714.83" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer6_gpu11_expert11&#45;&gt;aggregate_layer6_gpu11 -->
<g id="edge668" class="edge">
<title>expert_layer6_gpu11_expert11&#45;&gt;aggregate_layer6_gpu11</title>
<path fill="none" stroke="black" d="M11124.75,-6822.47C11141.71,-6812.93 11160.72,-6802.23 11179.49,-6791.66"/>
<polygon fill="black" stroke="black" points="11181.38,-6794.61 11188.38,-6786.66 11177.95,-6788.51 11181.38,-6794.61"/>
</g>
<!-- expert_layer6_gpu12_expert12 -->
<g id="node532" class="node">
<title>expert_layer6_gpu12_expert12</title>
<path fill="lightcoral" stroke="black" d="M12059.5,-6890.53C12059.5,-6890.53 11590.5,-6890.53 11590.5,-6890.53 11584.5,-6890.53 11578.5,-6884.53 11578.5,-6878.53 11578.5,-6878.53 11578.5,-6834.53 11578.5,-6834.53 11578.5,-6828.53 11584.5,-6822.53 11590.5,-6822.53 11590.5,-6822.53 12059.5,-6822.53 12059.5,-6822.53 12065.5,-6822.53 12071.5,-6828.53 12071.5,-6834.53 12071.5,-6834.53 12071.5,-6878.53 12071.5,-6878.53 12071.5,-6884.53 12065.5,-6890.53 12059.5,-6890.53"/>
<text text-anchor="middle" x="11825" y="-6875.33" font-family="Times,serif" font-size="14.00">Expert 12 Layer 6 GPU 12</text>
<text text-anchor="middle" x="11825" y="-6860.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11825" y="-6845.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11825" y="-6830.33" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer6_gpu12 -->
<g id="node561" class="node">
<title>aggregate_layer6_gpu12</title>
<path fill="orange" stroke="black" d="M12307.29,-6786.53C12307.29,-6786.53 11820.19,-6786.53 11820.19,-6786.53 11814.19,-6786.53 11803.52,-6782.77 11798.85,-6779 11798.85,-6779 11686.06,-6688.06 11686.06,-6688.06 11681.38,-6684.3 11682.71,-6680.53 11688.71,-6680.53 11688.71,-6680.53 12175.81,-6680.53 12175.81,-6680.53 12181.81,-6680.53 12192.48,-6684.3 12197.15,-6688.06 12197.15,-6688.06 12309.94,-6779 12309.94,-6779 12314.62,-6782.77 12313.29,-6786.53 12307.29,-6786.53"/>
<text text-anchor="middle" x="11998" y="-6744.83" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 6 GPU 12</text>
<text text-anchor="middle" x="11998" y="-6729.83" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="11998" y="-6714.83" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer6_gpu12_expert12&#45;&gt;aggregate_layer6_gpu12 -->
<g id="edge669" class="edge">
<title>expert_layer6_gpu12_expert12&#45;&gt;aggregate_layer6_gpu12</title>
<path fill="none" stroke="black" d="M11872.27,-6822.47C11885.49,-6813.23 11900.25,-6802.9 11914.88,-6792.67"/>
<polygon fill="black" stroke="black" points="11917.28,-6795.26 11923.47,-6786.66 11913.27,-6789.52 11917.28,-6795.26"/>
</g>
<!-- expert_layer6_gpu13_expert13 -->
<g id="node533" class="node">
<title>expert_layer6_gpu13_expert13</title>
<path fill="lightcoral" stroke="black" d="M13010.5,-6890.53C13010.5,-6890.53 12541.5,-6890.53 12541.5,-6890.53 12535.5,-6890.53 12529.5,-6884.53 12529.5,-6878.53 12529.5,-6878.53 12529.5,-6834.53 12529.5,-6834.53 12529.5,-6828.53 12535.5,-6822.53 12541.5,-6822.53 12541.5,-6822.53 13010.5,-6822.53 13010.5,-6822.53 13016.5,-6822.53 13022.5,-6828.53 13022.5,-6834.53 13022.5,-6834.53 13022.5,-6878.53 13022.5,-6878.53 13022.5,-6884.53 13016.5,-6890.53 13010.5,-6890.53"/>
<text text-anchor="middle" x="12776" y="-6875.33" font-family="Times,serif" font-size="14.00">Expert 13 Layer 6 GPU 13</text>
<text text-anchor="middle" x="12776" y="-6860.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12776" y="-6845.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12776" y="-6830.33" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer6_gpu13 -->
<g id="node563" class="node">
<title>aggregate_layer6_gpu13</title>
<path fill="orange" stroke="black" d="M13450.29,-6786.53C13450.29,-6786.53 12963.19,-6786.53 12963.19,-6786.53 12957.19,-6786.53 12946.52,-6782.77 12941.85,-6779 12941.85,-6779 12829.06,-6688.06 12829.06,-6688.06 12824.38,-6684.3 12825.71,-6680.53 12831.71,-6680.53 12831.71,-6680.53 13318.81,-6680.53 13318.81,-6680.53 13324.81,-6680.53 13335.48,-6684.3 13340.15,-6688.06 13340.15,-6688.06 13452.94,-6779 13452.94,-6779 13457.62,-6782.77 13456.29,-6786.53 13450.29,-6786.53"/>
<text text-anchor="middle" x="13141" y="-6744.83" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 6 GPU 13</text>
<text text-anchor="middle" x="13141" y="-6729.83" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="13141" y="-6714.83" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer6_gpu13_expert13&#45;&gt;aggregate_layer6_gpu13 -->
<g id="edge670" class="edge">
<title>expert_layer6_gpu13_expert13&#45;&gt;aggregate_layer6_gpu13</title>
<path fill="none" stroke="black" d="M12875.74,-6822.47C12906.32,-6812.33 12940.83,-6800.89 12974.6,-6789.69"/>
<polygon fill="black" stroke="black" points="12975.71,-6793.01 12984.11,-6786.54 12973.51,-6786.37 12975.71,-6793.01"/>
</g>
<!-- expert_layer6_gpu14_expert14 -->
<g id="node534" class="node">
<title>expert_layer6_gpu14_expert14</title>
<path fill="lightcoral" stroke="black" d="M13936.5,-6890.53C13936.5,-6890.53 13467.5,-6890.53 13467.5,-6890.53 13461.5,-6890.53 13455.5,-6884.53 13455.5,-6878.53 13455.5,-6878.53 13455.5,-6834.53 13455.5,-6834.53 13455.5,-6828.53 13461.5,-6822.53 13467.5,-6822.53 13467.5,-6822.53 13936.5,-6822.53 13936.5,-6822.53 13942.5,-6822.53 13948.5,-6828.53 13948.5,-6834.53 13948.5,-6834.53 13948.5,-6878.53 13948.5,-6878.53 13948.5,-6884.53 13942.5,-6890.53 13936.5,-6890.53"/>
<text text-anchor="middle" x="13702" y="-6875.33" font-family="Times,serif" font-size="14.00">Expert 14 Layer 6 GPU 14</text>
<text text-anchor="middle" x="13702" y="-6860.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="13702" y="-6845.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="13702" y="-6830.33" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer6_gpu14 -->
<g id="node565" class="node">
<title>aggregate_layer6_gpu14</title>
<path fill="orange" stroke="black" d="M14352.29,-6786.53C14352.29,-6786.53 13865.19,-6786.53 13865.19,-6786.53 13859.19,-6786.53 13848.52,-6782.77 13843.85,-6779 13843.85,-6779 13731.06,-6688.06 13731.06,-6688.06 13726.38,-6684.3 13727.71,-6680.53 13733.71,-6680.53 13733.71,-6680.53 14220.81,-6680.53 14220.81,-6680.53 14226.81,-6680.53 14237.48,-6684.3 14242.15,-6688.06 14242.15,-6688.06 14354.94,-6779 14354.94,-6779 14359.62,-6782.77 14358.29,-6786.53 14352.29,-6786.53"/>
<text text-anchor="middle" x="14043" y="-6744.83" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 6 GPU 14</text>
<text text-anchor="middle" x="14043" y="-6729.83" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="14043" y="-6714.83" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer6_gpu14_expert14&#45;&gt;aggregate_layer6_gpu14 -->
<g id="edge671" class="edge">
<title>expert_layer6_gpu14_expert14&#45;&gt;aggregate_layer6_gpu14</title>
<path fill="none" stroke="black" d="M13795.18,-6822.47C13823.5,-6812.42 13855.44,-6801.09 13886.74,-6789.98"/>
<polygon fill="black" stroke="black" points="13888.17,-6793.19 13896.42,-6786.54 13885.83,-6786.59 13888.17,-6793.19"/>
</g>
<!-- expert_layer6_gpu15_expert15 -->
<g id="node535" class="node">
<title>expert_layer6_gpu15_expert15</title>
<path fill="lightcoral" stroke="black" d="M14963.5,-6890.53C14963.5,-6890.53 14494.5,-6890.53 14494.5,-6890.53 14488.5,-6890.53 14482.5,-6884.53 14482.5,-6878.53 14482.5,-6878.53 14482.5,-6834.53 14482.5,-6834.53 14482.5,-6828.53 14488.5,-6822.53 14494.5,-6822.53 14494.5,-6822.53 14963.5,-6822.53 14963.5,-6822.53 14969.5,-6822.53 14975.5,-6828.53 14975.5,-6834.53 14975.5,-6834.53 14975.5,-6878.53 14975.5,-6878.53 14975.5,-6884.53 14969.5,-6890.53 14963.5,-6890.53"/>
<text text-anchor="middle" x="14729" y="-6875.33" font-family="Times,serif" font-size="14.00">Expert 15 Layer 6 GPU 15</text>
<text text-anchor="middle" x="14729" y="-6860.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14729" y="-6845.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14729" y="-6830.33" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer6_gpu15 -->
<g id="node567" class="node">
<title>aggregate_layer6_gpu15</title>
<path fill="orange" stroke="black" d="M15480.29,-6786.53C15480.29,-6786.53 14993.19,-6786.53 14993.19,-6786.53 14987.19,-6786.53 14976.52,-6782.77 14971.85,-6779 14971.85,-6779 14859.06,-6688.06 14859.06,-6688.06 14854.38,-6684.3 14855.71,-6680.53 14861.71,-6680.53 14861.71,-6680.53 15348.81,-6680.53 15348.81,-6680.53 15354.81,-6680.53 15365.48,-6684.3 15370.15,-6688.06 15370.15,-6688.06 15482.94,-6779 15482.94,-6779 15487.62,-6782.77 15486.29,-6786.53 15480.29,-6786.53"/>
<text text-anchor="middle" x="15171" y="-6744.83" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 6 GPU 15</text>
<text text-anchor="middle" x="15171" y="-6729.83" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="15171" y="-6714.83" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer6_gpu15_expert15&#45;&gt;aggregate_layer6_gpu15 -->
<g id="edge672" class="edge">
<title>expert_layer6_gpu15_expert15&#45;&gt;aggregate_layer6_gpu15</title>
<path fill="none" stroke="black" d="M14849.78,-6822.47C14887.36,-6812.18 14929.86,-6800.55 14971.34,-6789.19"/>
<polygon fill="black" stroke="black" points="14972.29,-6792.56 14981.01,-6786.54 14970.44,-6785.81 14972.29,-6792.56"/>
</g>
<!-- comm_layer6 -->
<g id="node568" class="node">
<title>comm_layer6</title>
<ellipse fill="lightpink" stroke="black" cx="8331" cy="-6964.01" rx="243.49" ry="37.45"/>
<text text-anchor="middle" x="8331" y="-6975.31" font-family="Times,serif" font-size="14.00">Cross&#45;GPU Communication Layer 6</text>
<text text-anchor="middle" x="8331" y="-6960.31" font-family="Times,serif" font-size="14.00">Input: Tokens from routing decisions</text>
<text text-anchor="middle" x="8331" y="-6945.31" font-family="Times,serif" font-size="14.00">Output: Tokens delivered to destination GPUs</text>
</g>
<!-- route_layer6_gpu0&#45;&gt;comm_layer6 -->
<g id="edge625" class="edge">
<title>route_layer6_gpu0&#45;&gt;comm_layer6</title>
<path fill="none" stroke="black" d="M1681.88,-7066.85C1806.15,-7055.91 1961.19,-7043.81 2100,-7037.49 3292.98,-6983.18 7062.5,-6968.64 8077.3,-6965.66"/>
<polygon fill="black" stroke="black" points="8077.65,-6969.16 8087.64,-6965.63 8077.63,-6962.16 8077.65,-6969.16"/>
</g>
<!-- mha_layer7_gpu0 -->
<g id="node569" class="node">
<title>mha_layer7_gpu0</title>
<path fill="lightblue" stroke="black" d="M1597,-6644.53C1597,-6644.53 1149,-6644.53 1149,-6644.53 1143,-6644.53 1137,-6638.53 1137,-6632.53 1137,-6632.53 1137,-6603.53 1137,-6603.53 1137,-6597.53 1143,-6591.53 1149,-6591.53 1149,-6591.53 1597,-6591.53 1597,-6591.53 1603,-6591.53 1609,-6597.53 1609,-6603.53 1609,-6603.53 1609,-6632.53 1609,-6632.53 1609,-6638.53 1603,-6644.53 1597,-6644.53"/>
<text text-anchor="middle" x="1373" y="-6629.33" font-family="Times,serif" font-size="14.00">MHA Layer 7 GPU 0</text>
<text text-anchor="middle" x="1373" y="-6614.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1373" y="-6599.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer6_gpu0&#45;&gt;mha_layer7_gpu0 -->
<g id="edge673" class="edge">
<title>aggregate_layer6_gpu0&#45;&gt;mha_layer7_gpu0</title>
<path fill="none" stroke="black" d="M1457.39,-6680.43C1443.33,-6670.2 1428.99,-6659.77 1416.22,-6650.48"/>
<polygon fill="black" stroke="black" points="1418.21,-6647.6 1408.07,-6644.55 1414.09,-6653.26 1418.21,-6647.6"/>
</g>
<!-- route_layer6_gpu1&#45;&gt;comm_layer6 -->
<g id="edge626" class="edge">
<title>route_layer6_gpu1&#45;&gt;comm_layer6</title>
<path fill="none" stroke="black" d="M2671.65,-7060.48C2751.9,-7051.44 2842.83,-7042.52 2926,-7037.49 3947.39,-6975.68 7150.76,-6966.58 8077.51,-6965.24"/>
<polygon fill="black" stroke="black" points="8077.64,-6968.74 8087.64,-6965.23 8077.63,-6961.74 8077.64,-6968.74"/>
</g>
<!-- mha_layer7_gpu1 -->
<g id="node570" class="node">
<title>mha_layer7_gpu1</title>
<path fill="lightblue" stroke="black" d="M2561,-6644.53C2561,-6644.53 2113,-6644.53 2113,-6644.53 2107,-6644.53 2101,-6638.53 2101,-6632.53 2101,-6632.53 2101,-6603.53 2101,-6603.53 2101,-6597.53 2107,-6591.53 2113,-6591.53 2113,-6591.53 2561,-6591.53 2561,-6591.53 2567,-6591.53 2573,-6597.53 2573,-6603.53 2573,-6603.53 2573,-6632.53 2573,-6632.53 2573,-6638.53 2567,-6644.53 2561,-6644.53"/>
<text text-anchor="middle" x="2337" y="-6629.33" font-family="Times,serif" font-size="14.00">MHA Layer 7 GPU 1</text>
<text text-anchor="middle" x="2337" y="-6614.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2337" y="-6599.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer6_gpu1&#45;&gt;mha_layer7_gpu1 -->
<g id="edge674" class="edge">
<title>aggregate_layer6_gpu1&#45;&gt;mha_layer7_gpu1</title>
<path fill="none" stroke="black" d="M2626.27,-6680.52C2571.33,-6668.84 2515.13,-6656.89 2467.05,-6646.67"/>
<polygon fill="black" stroke="black" points="2467.74,-6643.24 2457.23,-6644.59 2466.29,-6650.09 2467.74,-6643.24"/>
</g>
<!-- route_layer6_gpu2&#45;&gt;comm_layer6 -->
<g id="edge627" class="edge">
<title>route_layer6_gpu2&#45;&gt;comm_layer6</title>
<path fill="none" stroke="black" d="M3503.2,-7064.9C3610.52,-7054.58 3739.6,-7043.59 3856,-7037.49 4686.92,-6993.95 7259.6,-6972.53 8078.16,-6966.7"/>
<polygon fill="black" stroke="black" points="8078.33,-6970.19 8088.31,-6966.62 8078.28,-6963.19 8078.33,-6970.19"/>
</g>
<!-- mha_layer7_gpu2 -->
<g id="node571" class="node">
<title>mha_layer7_gpu2</title>
<path fill="lightblue" stroke="black" d="M3525,-6644.53C3525,-6644.53 3077,-6644.53 3077,-6644.53 3071,-6644.53 3065,-6638.53 3065,-6632.53 3065,-6632.53 3065,-6603.53 3065,-6603.53 3065,-6597.53 3071,-6591.53 3077,-6591.53 3077,-6591.53 3525,-6591.53 3525,-6591.53 3531,-6591.53 3537,-6597.53 3537,-6603.53 3537,-6603.53 3537,-6632.53 3537,-6632.53 3537,-6638.53 3531,-6644.53 3525,-6644.53"/>
<text text-anchor="middle" x="3301" y="-6629.33" font-family="Times,serif" font-size="14.00">MHA Layer 7 GPU 2</text>
<text text-anchor="middle" x="3301" y="-6614.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3301" y="-6599.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer6_gpu2&#45;&gt;mha_layer7_gpu2 -->
<g id="edge675" class="edge">
<title>aggregate_layer6_gpu2&#45;&gt;mha_layer7_gpu2</title>
<path fill="none" stroke="black" d="M3610.86,-6680.52C3551.76,-6668.79 3491.3,-6656.79 3439.66,-6646.55"/>
<polygon fill="black" stroke="black" points="3440.28,-6643.1 3429.79,-6644.59 3438.91,-6649.97 3440.28,-6643.1"/>
</g>
<!-- route_layer6_gpu3&#45;&gt;comm_layer6 -->
<g id="edge628" class="edge">
<title>route_layer6_gpu3&#45;&gt;comm_layer6</title>
<path fill="none" stroke="black" d="M4443.75,-7072.99C4623.86,-7061.38 4875.11,-7046.37 5096,-7037.49 6206.81,-6992.82 7533.36,-6973.9 8078.34,-6967.61"/>
<polygon fill="black" stroke="black" points="8078.73,-6971.11 8088.69,-6967.49 8078.65,-6964.11 8078.73,-6971.11"/>
</g>
<!-- mha_layer7_gpu3 -->
<g id="node572" class="node">
<title>mha_layer7_gpu3</title>
<path fill="lightblue" stroke="black" d="M4533,-6644.53C4533,-6644.53 4085,-6644.53 4085,-6644.53 4079,-6644.53 4073,-6638.53 4073,-6632.53 4073,-6632.53 4073,-6603.53 4073,-6603.53 4073,-6597.53 4079,-6591.53 4085,-6591.53 4085,-6591.53 4533,-6591.53 4533,-6591.53 4539,-6591.53 4545,-6597.53 4545,-6603.53 4545,-6603.53 4545,-6632.53 4545,-6632.53 4545,-6638.53 4539,-6644.53 4533,-6644.53"/>
<text text-anchor="middle" x="4309" y="-6629.33" font-family="Times,serif" font-size="14.00">MHA Layer 7 GPU 3</text>
<text text-anchor="middle" x="4309" y="-6614.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4309" y="-6599.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer6_gpu3&#45;&gt;mha_layer7_gpu3 -->
<g id="edge676" class="edge">
<title>aggregate_layer6_gpu3&#45;&gt;mha_layer7_gpu3</title>
<path fill="none" stroke="black" d="M4522.97,-6680.52C4483.27,-6669.11 4442.67,-6657.44 4407.66,-6647.38"/>
<polygon fill="black" stroke="black" points="4408.51,-6643.99 4397.94,-6644.59 4406.58,-6650.71 4408.51,-6643.99"/>
</g>
<!-- route_layer6_gpu4&#45;&gt;comm_layer6 -->
<g id="edge629" class="edge">
<title>route_layer6_gpu4&#45;&gt;comm_layer6</title>
<path fill="none" stroke="black" d="M5675.69,-7066.83C5791.38,-7056.45 5932.89,-7044.84 6060,-7037.49 6792.69,-6995.1 7659.91,-6976.04 8079.11,-6968.79"/>
<polygon fill="black" stroke="black" points="8079.3,-6972.29 8089.24,-6968.62 8079.18,-6965.29 8079.3,-6972.29"/>
</g>
<!-- mha_layer7_gpu4 -->
<g id="node573" class="node">
<title>mha_layer7_gpu4</title>
<path fill="lightblue" stroke="black" d="M5502,-6644.53C5502,-6644.53 5054,-6644.53 5054,-6644.53 5048,-6644.53 5042,-6638.53 5042,-6632.53 5042,-6632.53 5042,-6603.53 5042,-6603.53 5042,-6597.53 5048,-6591.53 5054,-6591.53 5054,-6591.53 5502,-6591.53 5502,-6591.53 5508,-6591.53 5514,-6597.53 5514,-6603.53 5514,-6603.53 5514,-6632.53 5514,-6632.53 5514,-6638.53 5508,-6644.53 5502,-6644.53"/>
<text text-anchor="middle" x="5278" y="-6629.33" font-family="Times,serif" font-size="14.00">MHA Layer 7 GPU 4</text>
<text text-anchor="middle" x="5278" y="-6614.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5278" y="-6599.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer6_gpu4&#45;&gt;mha_layer7_gpu4 -->
<g id="edge677" class="edge">
<title>aggregate_layer6_gpu4&#45;&gt;mha_layer7_gpu4</title>
<path fill="none" stroke="black" d="M5371.05,-6680.43C5355.4,-6670.11 5339.43,-6659.57 5325.25,-6650.21"/>
<polygon fill="black" stroke="black" points="5326.94,-6647.13 5316.66,-6644.55 5323.08,-6652.98 5326.94,-6647.13"/>
</g>
<!-- route_layer6_gpu5&#45;&gt;comm_layer6 -->
<g id="edge630" class="edge">
<title>route_layer6_gpu5&#45;&gt;comm_layer6</title>
<path fill="none" stroke="black" d="M6633.6,-7062C6713.41,-7053.17 6803.56,-7044 6886,-7037.49 7306.08,-7004.32 7796.13,-6983.5 8084.04,-6973.08"/>
<polygon fill="black" stroke="black" points="8084.33,-6976.58 8094.2,-6972.72 8084.08,-6969.58 8084.33,-6976.58"/>
</g>
<!-- mha_layer7_gpu5 -->
<g id="node574" class="node">
<title>mha_layer7_gpu5</title>
<path fill="lightblue" stroke="black" d="M6293,-6644.53C6293,-6644.53 5845,-6644.53 5845,-6644.53 5839,-6644.53 5833,-6638.53 5833,-6632.53 5833,-6632.53 5833,-6603.53 5833,-6603.53 5833,-6597.53 5839,-6591.53 5845,-6591.53 5845,-6591.53 6293,-6591.53 6293,-6591.53 6299,-6591.53 6305,-6597.53 6305,-6603.53 6305,-6603.53 6305,-6632.53 6305,-6632.53 6305,-6638.53 6299,-6644.53 6293,-6644.53"/>
<text text-anchor="middle" x="6069" y="-6629.33" font-family="Times,serif" font-size="14.00">MHA Layer 7 GPU 5</text>
<text text-anchor="middle" x="6069" y="-6614.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6069" y="-6599.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer6_gpu5&#45;&gt;mha_layer7_gpu5 -->
<g id="edge678" class="edge">
<title>aggregate_layer6_gpu5&#45;&gt;mha_layer7_gpu5</title>
<path fill="none" stroke="black" d="M6114.98,-6680.43C6107.91,-6670.98 6100.7,-6661.36 6094.15,-6652.62"/>
<polygon fill="black" stroke="black" points="6096.9,-6650.45 6088.11,-6644.55 6091.3,-6654.65 6096.9,-6650.45"/>
</g>
<!-- route_layer6_gpu6&#45;&gt;comm_layer6 -->
<g id="edge631" class="edge">
<title>route_layer6_gpu6&#45;&gt;comm_layer6</title>
<path fill="none" stroke="black" d="M7457.12,-7060.05C7517.5,-7052.45 7582.7,-7044.46 7643,-7037.49 7802.76,-7019.02 7983.61,-7000.04 8119.79,-6986.14"/>
<polygon fill="black" stroke="black" points="8120.34,-6989.6 8129.93,-6985.11 8119.63,-6982.64 8120.34,-6989.6"/>
</g>
<!-- mha_layer7_gpu6 -->
<g id="node575" class="node">
<title>mha_layer7_gpu6</title>
<path fill="lightblue" stroke="black" d="M7262,-6644.53C7262,-6644.53 6814,-6644.53 6814,-6644.53 6808,-6644.53 6802,-6638.53 6802,-6632.53 6802,-6632.53 6802,-6603.53 6802,-6603.53 6802,-6597.53 6808,-6591.53 6814,-6591.53 6814,-6591.53 7262,-6591.53 7262,-6591.53 7268,-6591.53 7274,-6597.53 7274,-6603.53 7274,-6603.53 7274,-6632.53 7274,-6632.53 7274,-6638.53 7268,-6644.53 7262,-6644.53"/>
<text text-anchor="middle" x="7038" y="-6629.33" font-family="Times,serif" font-size="14.00">MHA Layer 7 GPU 6</text>
<text text-anchor="middle" x="7038" y="-6614.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7038" y="-6599.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer6_gpu6&#45;&gt;mha_layer7_gpu6 -->
<g id="edge679" class="edge">
<title>aggregate_layer6_gpu6&#45;&gt;mha_layer7_gpu6</title>
<path fill="none" stroke="black" d="M7079.11,-6680.43C7072.85,-6671.08 7066.47,-6661.56 7060.67,-6652.89"/>
<polygon fill="black" stroke="black" points="7063.56,-6650.91 7055.08,-6644.55 7057.74,-6654.8 7063.56,-6650.91"/>
</g>
<!-- route_layer6_gpu7&#45;&gt;comm_layer6 -->
<g id="edge632" class="edge">
<title>route_layer6_gpu7&#45;&gt;comm_layer6</title>
<path fill="none" stroke="black" d="M8130.89,-7037.42C8163.54,-7025.61 8197.57,-7013.29 8228.12,-7002.24"/>
<polygon fill="black" stroke="black" points="8229.69,-7005.39 8237.91,-6998.7 8227.31,-6998.81 8229.69,-7005.39"/>
</g>
<!-- mha_layer7_gpu7 -->
<g id="node576" class="node">
<title>mha_layer7_gpu7</title>
<path fill="lightblue" stroke="black" d="M8122,-6644.53C8122,-6644.53 7674,-6644.53 7674,-6644.53 7668,-6644.53 7662,-6638.53 7662,-6632.53 7662,-6632.53 7662,-6603.53 7662,-6603.53 7662,-6597.53 7668,-6591.53 7674,-6591.53 7674,-6591.53 8122,-6591.53 8122,-6591.53 8128,-6591.53 8134,-6597.53 8134,-6603.53 8134,-6603.53 8134,-6632.53 8134,-6632.53 8134,-6638.53 8128,-6644.53 8122,-6644.53"/>
<text text-anchor="middle" x="7898" y="-6629.33" font-family="Times,serif" font-size="14.00">MHA Layer 7 GPU 7</text>
<text text-anchor="middle" x="7898" y="-6614.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7898" y="-6599.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer6_gpu7&#45;&gt;mha_layer7_gpu7 -->
<g id="edge680" class="edge">
<title>aggregate_layer6_gpu7&#45;&gt;mha_layer7_gpu7</title>
<path fill="none" stroke="black" d="M7913.15,-6680.43C7910.98,-6671.67 7908.78,-6662.75 7906.76,-6654.53"/>
<polygon fill="black" stroke="black" points="7910.09,-6653.42 7904.29,-6644.55 7903.29,-6655.09 7910.09,-6653.42"/>
</g>
<!-- route_layer6_gpu8&#45;&gt;comm_layer6 -->
<g id="edge633" class="edge">
<title>route_layer6_gpu8&#45;&gt;comm_layer6</title>
<path fill="none" stroke="black" d="M8611.38,-7037.42C8561.27,-7024.48 8508.83,-7010.93 8463.03,-6999.11"/>
<polygon fill="black" stroke="black" points="8463.62,-6995.64 8453.06,-6996.53 8461.87,-7002.42 8463.62,-6995.64"/>
</g>
<!-- mha_layer7_gpu8 -->
<g id="node577" class="node">
<title>mha_layer7_gpu8</title>
<path fill="lightblue" stroke="black" d="M9017,-6644.53C9017,-6644.53 8569,-6644.53 8569,-6644.53 8563,-6644.53 8557,-6638.53 8557,-6632.53 8557,-6632.53 8557,-6603.53 8557,-6603.53 8557,-6597.53 8563,-6591.53 8569,-6591.53 8569,-6591.53 9017,-6591.53 9017,-6591.53 9023,-6591.53 9029,-6597.53 9029,-6603.53 9029,-6603.53 9029,-6632.53 9029,-6632.53 9029,-6638.53 9023,-6644.53 9017,-6644.53"/>
<text text-anchor="middle" x="8793" y="-6629.33" font-family="Times,serif" font-size="14.00">MHA Layer 7 GPU 8</text>
<text text-anchor="middle" x="8793" y="-6614.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8793" y="-6599.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer6_gpu8&#45;&gt;mha_layer7_gpu8 -->
<g id="edge681" class="edge">
<title>aggregate_layer6_gpu8&#45;&gt;mha_layer7_gpu8</title>
<path fill="none" stroke="black" d="M8763.25,-6680.43C8767.64,-6671.37 8772.11,-6662.15 8776.2,-6653.71"/>
<polygon fill="black" stroke="black" points="8779.43,-6655.07 8780.64,-6644.55 8773.13,-6652.02 8779.43,-6655.07"/>
</g>
<!-- route_layer6_gpu9&#45;&gt;comm_layer6 -->
<g id="edge634" class="edge">
<title>route_layer6_gpu9&#45;&gt;comm_layer6</title>
<path fill="none" stroke="black" d="M9402.73,-7060.32C9322.78,-7052.78 9236.66,-7044.74 9157,-7037.49 8951.63,-7018.79 8717.46,-6998.32 8551.03,-6983.92"/>
<polygon fill="black" stroke="black" points="8550.93,-6980.4 8540.67,-6983.02 8550.33,-6987.37 8550.93,-6980.4"/>
</g>
<!-- mha_layer7_gpu9 -->
<g id="node578" class="node">
<title>mha_layer7_gpu9</title>
<path fill="lightblue" stroke="black" d="M9943,-6644.53C9943,-6644.53 9495,-6644.53 9495,-6644.53 9489,-6644.53 9483,-6638.53 9483,-6632.53 9483,-6632.53 9483,-6603.53 9483,-6603.53 9483,-6597.53 9489,-6591.53 9495,-6591.53 9495,-6591.53 9943,-6591.53 9943,-6591.53 9949,-6591.53 9955,-6597.53 9955,-6603.53 9955,-6603.53 9955,-6632.53 9955,-6632.53 9955,-6638.53 9949,-6644.53 9943,-6644.53"/>
<text text-anchor="middle" x="9719" y="-6629.33" font-family="Times,serif" font-size="14.00">MHA Layer 7 GPU 9</text>
<text text-anchor="middle" x="9719" y="-6614.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9719" y="-6599.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer6_gpu9&#45;&gt;mha_layer7_gpu9 -->
<g id="edge682" class="edge">
<title>aggregate_layer6_gpu9&#45;&gt;mha_layer7_gpu9</title>
<path fill="none" stroke="black" d="M9668.69,-6680.43C9676.51,-6670.89 9684.48,-6661.16 9691.7,-6652.35"/>
<polygon fill="black" stroke="black" points="9694.46,-6654.5 9698.09,-6644.55 9689.05,-6650.06 9694.46,-6654.5"/>
</g>
<!-- route_layer6_gpu10&#45;&gt;comm_layer6 -->
<g id="edge635" class="edge">
<title>route_layer6_gpu10&#45;&gt;comm_layer6</title>
<path fill="none" stroke="black" d="M10330.56,-7059.54C10240.85,-7051.51 10142.55,-7043.41 10052,-7037.49 9528.68,-7003.23 8914.71,-6981.89 8579.88,-6971.85"/>
<polygon fill="black" stroke="black" points="8579.67,-6968.35 8569.57,-6971.55 8579.46,-6975.34 8579.67,-6968.35"/>
</g>
<!-- mha_layer7_gpu10 -->
<g id="node579" class="node">
<title>mha_layer7_gpu10</title>
<path fill="lightblue" stroke="black" d="M10993,-6644.53C10993,-6644.53 10545,-6644.53 10545,-6644.53 10539,-6644.53 10533,-6638.53 10533,-6632.53 10533,-6632.53 10533,-6603.53 10533,-6603.53 10533,-6597.53 10539,-6591.53 10545,-6591.53 10545,-6591.53 10993,-6591.53 10993,-6591.53 10999,-6591.53 11005,-6597.53 11005,-6603.53 11005,-6603.53 11005,-6632.53 11005,-6632.53 11005,-6638.53 10999,-6644.53 10993,-6644.53"/>
<text text-anchor="middle" x="10769" y="-6629.33" font-family="Times,serif" font-size="14.00">MHA Layer 7 GPU 10</text>
<text text-anchor="middle" x="10769" y="-6614.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10769" y="-6599.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer6_gpu10&#45;&gt;mha_layer7_gpu10 -->
<g id="edge683" class="edge">
<title>aggregate_layer6_gpu10&#45;&gt;mha_layer7_gpu10</title>
<path fill="none" stroke="black" d="M10628.35,-6680.43C10653.34,-6669.52 10678.87,-6658.38 10701.19,-6648.63"/>
<polygon fill="black" stroke="black" points="10702.79,-6651.76 10710.55,-6644.55 10699.99,-6645.34 10702.79,-6651.76"/>
</g>
<!-- route_layer6_gpu11&#45;&gt;comm_layer6 -->
<g id="edge636" class="edge">
<title>route_layer6_gpu11&#45;&gt;comm_layer6</title>
<path fill="none" stroke="black" d="M11277.49,-7059.55C11182.54,-7051.22 11077.51,-7042.96 10981,-7037.49 10101.29,-6987.57 9055.29,-6971.78 8583.71,-6966.99"/>
<polygon fill="black" stroke="black" points="8583.75,-6963.49 8573.71,-6966.89 8583.68,-6970.49 8583.75,-6963.49"/>
</g>
<!-- mha_layer7_gpu11 -->
<g id="node580" class="node">
<title>mha_layer7_gpu11</title>
<path fill="lightblue" stroke="black" d="M11654,-6644.53C11654,-6644.53 11206,-6644.53 11206,-6644.53 11200,-6644.53 11194,-6638.53 11194,-6632.53 11194,-6632.53 11194,-6603.53 11194,-6603.53 11194,-6597.53 11200,-6591.53 11206,-6591.53 11206,-6591.53 11654,-6591.53 11654,-6591.53 11660,-6591.53 11666,-6597.53 11666,-6603.53 11666,-6603.53 11666,-6632.53 11666,-6632.53 11666,-6638.53 11660,-6644.53 11654,-6644.53"/>
<text text-anchor="middle" x="11430" y="-6629.33" font-family="Times,serif" font-size="14.00">MHA Layer 7 GPU 11</text>
<text text-anchor="middle" x="11430" y="-6614.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11430" y="-6599.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer6_gpu11&#45;&gt;mha_layer7_gpu11 -->
<g id="edge684" class="edge">
<title>aggregate_layer6_gpu11&#45;&gt;mha_layer7_gpu11</title>
<path fill="none" stroke="black" d="M11349.39,-6680.43C11362.7,-6670.3 11376.26,-6659.97 11388.37,-6650.74"/>
<polygon fill="black" stroke="black" points="11390.67,-6653.39 11396.51,-6644.55 11386.43,-6647.82 11390.67,-6653.39"/>
</g>
<!-- route_layer6_gpu12&#45;&gt;comm_layer6 -->
<g id="edge637" class="edge">
<title>route_layer6_gpu12&#45;&gt;comm_layer6</title>
<path fill="none" stroke="black" d="M12232.35,-7059.48C12135.12,-7051.01 12027.14,-7042.7 11928,-7037.49 10674.64,-6971.59 9172.73,-6964.49 8584.66,-6964.48"/>
<polygon fill="black" stroke="black" points="8584.36,-6960.98 8574.36,-6964.48 8584.36,-6967.98 8584.36,-6960.98"/>
</g>
<!-- mha_layer7_gpu12 -->
<g id="node581" class="node">
<title>mha_layer7_gpu12</title>
<path fill="lightblue" stroke="black" d="M12229,-6644.53C12229,-6644.53 11781,-6644.53 11781,-6644.53 11775,-6644.53 11769,-6638.53 11769,-6632.53 11769,-6632.53 11769,-6603.53 11769,-6603.53 11769,-6597.53 11775,-6591.53 11781,-6591.53 11781,-6591.53 12229,-6591.53 12229,-6591.53 12235,-6591.53 12241,-6597.53 12241,-6603.53 12241,-6603.53 12241,-6632.53 12241,-6632.53 12241,-6638.53 12235,-6644.53 12229,-6644.53"/>
<text text-anchor="middle" x="12005" y="-6629.33" font-family="Times,serif" font-size="14.00">MHA Layer 7 GPU 12</text>
<text text-anchor="middle" x="12005" y="-6614.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12005" y="-6599.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer6_gpu12&#45;&gt;mha_layer7_gpu12 -->
<g id="edge685" class="edge">
<title>aggregate_layer6_gpu12&#45;&gt;mha_layer7_gpu12</title>
<path fill="none" stroke="black" d="M12001.21,-6680.43C12001.75,-6671.76 12002.29,-6662.95 12002.79,-6654.8"/>
<polygon fill="black" stroke="black" points="12006.3,-6654.74 12003.43,-6644.55 11999.32,-6654.31 12006.3,-6654.74"/>
</g>
<!-- route_layer6_gpu13&#45;&gt;comm_layer6 -->
<g id="edge638" class="edge">
<title>route_layer6_gpu13&#45;&gt;comm_layer6</title>
<path fill="none" stroke="black" d="M13192.61,-7059.47C13093.87,-7050.91 12983.89,-7042.54 12883,-7037.49 12036.33,-6995.06 9412.43,-6972.85 8584.2,-6966.76"/>
<polygon fill="black" stroke="black" points="8583.96,-6963.26 8573.94,-6966.69 8583.91,-6970.26 8583.96,-6963.26"/>
</g>
<!-- mha_layer7_gpu13 -->
<g id="node582" class="node">
<title>mha_layer7_gpu13</title>
<path fill="lightblue" stroke="black" d="M13792,-6644.53C13792,-6644.53 13344,-6644.53 13344,-6644.53 13338,-6644.53 13332,-6638.53 13332,-6632.53 13332,-6632.53 13332,-6603.53 13332,-6603.53 13332,-6597.53 13338,-6591.53 13344,-6591.53 13344,-6591.53 13792,-6591.53 13792,-6591.53 13798,-6591.53 13804,-6597.53 13804,-6603.53 13804,-6603.53 13804,-6632.53 13804,-6632.53 13804,-6638.53 13798,-6644.53 13792,-6644.53"/>
<text text-anchor="middle" x="13568" y="-6629.33" font-family="Times,serif" font-size="14.00">MHA Layer 7 GPU 13</text>
<text text-anchor="middle" x="13568" y="-6614.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13568" y="-6599.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer6_gpu13&#45;&gt;mha_layer7_gpu13 -->
<g id="edge686" class="edge">
<title>aggregate_layer6_gpu13&#45;&gt;mha_layer7_gpu13</title>
<path fill="none" stroke="black" d="M13332.33,-6681.68C13376.92,-6669.82 13422.82,-6657.62 13462.12,-6647.18"/>
<polygon fill="black" stroke="black" points="13463.2,-6650.51 13471.97,-6644.56 13461.4,-6643.75 13463.2,-6650.51"/>
</g>
<!-- route_layer6_gpu14&#45;&gt;comm_layer6 -->
<g id="edge639" class="edge">
<title>route_layer6_gpu14&#45;&gt;comm_layer6</title>
<path fill="none" stroke="black" d="M14154.41,-7059.37C14055.15,-7050.78 13944.49,-7042.42 13843,-7037.49 12798.78,-6986.75 9522.27,-6969.83 8584.23,-6965.95"/>
<polygon fill="black" stroke="black" points="8583.99,-6962.45 8573.98,-6965.91 8583.96,-6969.45 8583.99,-6962.45"/>
</g>
<!-- mha_layer7_gpu14 -->
<g id="node583" class="node">
<title>mha_layer7_gpu14</title>
<path fill="lightblue" stroke="black" d="M14367,-6644.53C14367,-6644.53 13919,-6644.53 13919,-6644.53 13913,-6644.53 13907,-6638.53 13907,-6632.53 13907,-6632.53 13907,-6603.53 13907,-6603.53 13907,-6597.53 13913,-6591.53 13919,-6591.53 13919,-6591.53 14367,-6591.53 14367,-6591.53 14373,-6591.53 14379,-6597.53 14379,-6603.53 14379,-6603.53 14379,-6632.53 14379,-6632.53 14379,-6638.53 14373,-6644.53 14367,-6644.53"/>
<text text-anchor="middle" x="14143" y="-6629.33" font-family="Times,serif" font-size="14.00">MHA Layer 7 GPU 14</text>
<text text-anchor="middle" x="14143" y="-6614.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14143" y="-6599.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer6_gpu14&#45;&gt;mha_layer7_gpu14 -->
<g id="edge687" class="edge">
<title>aggregate_layer6_gpu14&#45;&gt;mha_layer7_gpu14</title>
<path fill="none" stroke="black" d="M14088.9,-6680.43C14097.4,-6670.79 14106.06,-6660.96 14113.88,-6652.08"/>
<polygon fill="black" stroke="black" points="14116.54,-6654.36 14120.52,-6644.55 14111.28,-6649.74 14116.54,-6654.36"/>
</g>
<!-- route_layer6_gpu15&#45;&gt;comm_layer6 -->
<g id="edge640" class="edge">
<title>route_layer6_gpu15&#45;&gt;comm_layer6</title>
<path fill="none" stroke="black" d="M15117.31,-7059.29C15017.79,-7050.68 14906.8,-7042.33 14805,-7037.49 13561.62,-6978.38 9623.7,-6967.3 8584.49,-6965.38"/>
<polygon fill="black" stroke="black" points="8584.28,-6961.88 8574.27,-6965.36 8584.27,-6968.88 8584.28,-6961.88"/>
</g>
<!-- mha_layer7_gpu15 -->
<g id="node584" class="node">
<title>mha_layer7_gpu15</title>
<path fill="lightblue" stroke="black" d="M15607,-6644.53C15607,-6644.53 15159,-6644.53 15159,-6644.53 15153,-6644.53 15147,-6638.53 15147,-6632.53 15147,-6632.53 15147,-6603.53 15147,-6603.53 15147,-6597.53 15153,-6591.53 15159,-6591.53 15159,-6591.53 15607,-6591.53 15607,-6591.53 15613,-6591.53 15619,-6597.53 15619,-6603.53 15619,-6603.53 15619,-6632.53 15619,-6632.53 15619,-6638.53 15613,-6644.53 15607,-6644.53"/>
<text text-anchor="middle" x="15383" y="-6629.33" font-family="Times,serif" font-size="14.00">MHA Layer 7 GPU 15</text>
<text text-anchor="middle" x="15383" y="-6614.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="15383" y="-6599.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer6_gpu15&#45;&gt;mha_layer7_gpu15 -->
<g id="edge688" class="edge">
<title>aggregate_layer6_gpu15&#45;&gt;mha_layer7_gpu15</title>
<path fill="none" stroke="black" d="M15268.31,-6680.43C15288.15,-6669.81 15308.39,-6658.98 15326.24,-6649.42"/>
<polygon fill="black" stroke="black" points="15328.18,-6652.35 15335.34,-6644.55 15324.88,-6646.18 15328.18,-6652.35"/>
</g>
<!-- comm_layer6&#45;&gt;expert_layer6_gpu0_expert0 -->
<g id="edge641" class="edge">
<title>comm_layer6&#45;&gt;expert_layer6_gpu0_expert0</title>
<path fill="none" stroke="black" d="M8088.3,-6960.87C7340.16,-6954 5003.07,-6930.64 3067,-6890.53 2744.33,-6883.85 2372.66,-6873.08 2131.07,-6865.68"/>
<polygon fill="black" stroke="black" points="2130.84,-6862.17 2120.74,-6865.36 2130.63,-6869.16 2130.84,-6862.17"/>
</g>
<!-- comm_layer6&#45;&gt;expert_layer6_gpu1_expert1 -->
<g id="edge642" class="edge">
<title>comm_layer6&#45;&gt;expert_layer6_gpu1_expert1</title>
<path fill="none" stroke="black" d="M8088.2,-6961.34C7434.91,-6956.31 5585.1,-6938.59 4047,-6890.53 3891.95,-6885.69 3718.32,-6877.86 3579.97,-6871.04"/>
<polygon fill="black" stroke="black" points="3579.81,-6867.53 3569.65,-6870.53 3579.46,-6874.52 3579.81,-6867.53"/>
</g>
<!-- comm_layer6&#45;&gt;expert_layer6_gpu2_expert2 -->
<g id="edge643" class="edge">
<title>comm_layer6&#45;&gt;expert_layer6_gpu2_expert2</title>
<path fill="none" stroke="black" d="M8087.98,-6961.94C7514.28,-6958.57 6030.91,-6944.87 4793,-6890.53 4717.19,-6887.21 4634.86,-6882.2 4559.71,-6877.09"/>
<polygon fill="black" stroke="black" points="4559.85,-6873.59 4549.64,-6876.4 4559.37,-6880.58 4559.85,-6873.59"/>
</g>
<!-- comm_layer6&#45;&gt;expert_layer6_gpu3_expert3 -->
<g id="edge644" class="edge">
<title>comm_layer6&#45;&gt;expert_layer6_gpu3_expert3</title>
<path fill="none" stroke="black" d="M8087.91,-6962.17C7588.09,-6959.3 6408.98,-6946.6 5421,-6890.53 5383.79,-6888.42 5344.53,-6885.59 5306.02,-6882.48"/>
<polygon fill="black" stroke="black" points="5305.97,-6878.96 5295.71,-6881.64 5305.4,-6885.94 5305.97,-6878.96"/>
</g>
<!-- comm_layer6&#45;&gt;expert_layer6_gpu4_expert4 -->
<g id="edge645" class="edge">
<title>comm_layer6&#45;&gt;expert_layer6_gpu4_expert4</title>
<path fill="none" stroke="black" d="M8091.08,-6957.68C7691.17,-6948.2 6863.05,-6925.99 6163,-6890.53 6088.58,-6886.76 6007.83,-6881.68 5933.9,-6876.63"/>
<polygon fill="black" stroke="black" points="5933.74,-6873.11 5923.52,-6875.92 5933.26,-6880.1 5933.74,-6873.11"/>
</g>
<!-- comm_layer6&#45;&gt;expert_layer6_gpu5_expert5 -->
<g id="edge646" class="edge">
<title>comm_layer6&#45;&gt;expert_layer6_gpu5_expert5</title>
<path fill="none" stroke="black" d="M8103.69,-6950.47C7745.46,-6930.71 7051.79,-6892.44 6675.97,-6871.71"/>
<polygon fill="black" stroke="black" points="6675.95,-6868.2 6665.77,-6871.15 6675.56,-6875.19 6675.95,-6868.2"/>
</g>
<!-- comm_layer6&#45;&gt;expert_layer6_gpu6_expert6 -->
<g id="edge647" class="edge">
<title>comm_layer6&#45;&gt;expert_layer6_gpu6_expert6</title>
<path fill="none" stroke="black" d="M8133.73,-6942.01C7979.57,-6925.61 7764.08,-6902.67 7596.53,-6884.84"/>
<polygon fill="black" stroke="black" points="7596.89,-6881.36 7586.57,-6883.78 7596.15,-6888.32 7596.89,-6881.36"/>
</g>
<!-- comm_layer6&#45;&gt;expert_layer6_gpu7_expert7 -->
<g id="edge648" class="edge">
<title>comm_layer6&#45;&gt;expert_layer6_gpu7_expert7</title>
<path fill="none" stroke="black" d="M8227.49,-6929.93C8191.49,-6918.42 8150.92,-6905.45 8114.18,-6893.71"/>
<polygon fill="black" stroke="black" points="8115.02,-6890.3 8104.42,-6890.59 8112.88,-6896.97 8115.02,-6890.3"/>
</g>
<!-- comm_layer6&#45;&gt;expert_layer6_gpu8_expert8 -->
<g id="edge649" class="edge">
<title>comm_layer6&#45;&gt;expert_layer6_gpu8_expert8</title>
<path fill="none" stroke="black" d="M8434.37,-6930.07C8470.59,-6918.53 8511.45,-6905.51 8548.45,-6893.72"/>
<polygon fill="black" stroke="black" points="8549.81,-6896.96 8558.28,-6890.59 8547.69,-6890.29 8549.81,-6896.96"/>
</g>
<!-- comm_layer6&#45;&gt;expert_layer6_gpu9_expert9 -->
<g id="edge650" class="edge">
<title>comm_layer6&#45;&gt;expert_layer6_gpu9_expert9</title>
<path fill="none" stroke="black" d="M8535.15,-6943.54C8716.9,-6926.21 8983.62,-6900.77 9179.87,-6882.05"/>
<polygon fill="black" stroke="black" points="9180.42,-6885.52 9190.04,-6881.08 9179.76,-6878.55 9180.42,-6885.52"/>
</g>
<!-- comm_layer6&#45;&gt;expert_layer6_gpu10_expert10 -->
<g id="edge651" class="edge">
<title>comm_layer6&#45;&gt;expert_layer6_gpu10_expert10</title>
<path fill="none" stroke="black" d="M8559.48,-6951.14C8829.89,-6937.02 9293.76,-6912.58 9692,-6890.53 9795.7,-6884.79 9909.93,-6878.26 10009,-6872.54"/>
<polygon fill="black" stroke="black" points="10009.37,-6876.03 10019.15,-6871.95 10008.96,-6869.04 10009.37,-6876.03"/>
</g>
<!-- comm_layer6&#45;&gt;expert_layer6_gpu11_expert11 -->
<g id="edge652" class="edge">
<title>comm_layer6&#45;&gt;expert_layer6_gpu11_expert11</title>
<path fill="none" stroke="black" d="M8570.49,-6957.23C8973.33,-6947.03 9812.06,-6923.72 10521,-6890.53 10615,-6886.13 10718.06,-6880.18 10809.01,-6874.55"/>
<polygon fill="black" stroke="black" points="10809.43,-6878.03 10819.19,-6873.91 10808.99,-6871.04 10809.43,-6878.03"/>
</g>
<!-- comm_layer6&#45;&gt;expert_layer6_gpu12_expert12 -->
<g id="edge653" class="edge">
<title>comm_layer6&#45;&gt;expert_layer6_gpu12_expert12</title>
<path fill="none" stroke="black" d="M8573.35,-6960.51C9082.45,-6954.53 10300.4,-6936.3 11321,-6890.53 11401.44,-6886.93 11489.01,-6881.66 11568.26,-6876.39"/>
<polygon fill="black" stroke="black" points="11568.63,-6879.87 11578.38,-6875.72 11568.17,-6872.89 11568.63,-6879.87"/>
</g>
<!-- comm_layer6&#45;&gt;expert_layer6_gpu13_expert13 -->
<g id="edge654" class="edge">
<title>comm_layer6&#45;&gt;expert_layer6_gpu13_expert13</title>
<path fill="none" stroke="black" d="M8573.39,-6960.68C9169.9,-6954.43 10756.79,-6934.68 12080,-6890.53 12225.38,-6885.68 12387.73,-6878.11 12519.05,-6871.44"/>
<polygon fill="black" stroke="black" points="12519.44,-6874.92 12529.25,-6870.92 12519.08,-6867.93 12519.44,-6874.92"/>
</g>
<!-- comm_layer6&#45;&gt;expert_layer6_gpu14_expert14 -->
<g id="edge655" class="edge">
<title>comm_layer6&#45;&gt;expert_layer6_gpu14_expert14</title>
<path fill="none" stroke="black" d="M8574.15,-6962.15C9269.35,-6959.07 11325.03,-6945.62 13031,-6890.53 13167.77,-6886.12 13320.11,-6878.82 13445.02,-6872.21"/>
<polygon fill="black" stroke="black" points="13445.31,-6875.69 13455.11,-6871.67 13444.94,-6868.7 13445.31,-6875.69"/>
</g>
<!-- comm_layer6&#45;&gt;expert_layer6_gpu15_expert15 -->
<g id="edge656" class="edge">
<title>comm_layer6&#45;&gt;expert_layer6_gpu15_expert15</title>
<path fill="none" stroke="black" d="M8574.38,-6962.47C9356.19,-6960.17 11874.13,-6948.45 13957,-6890.53 14128.72,-6885.76 14321.82,-6877.5 14471.94,-6870.44"/>
<polygon fill="black" stroke="black" points="14472.39,-6873.93 14482.22,-6869.96 14472.06,-6866.93 14472.39,-6873.93"/>
</g>
<!-- gate_layer7_gpu0 -->
<g id="node585" class="node">
<title>gate_layer7_gpu0</title>
<path fill="lightsteelblue" stroke="black" d="M1124.07,-6554.2C1124.07,-6554.2 674.93,-6503.87 674.93,-6503.87 668.96,-6503.2 668.96,-6501.87 674.93,-6501.2 674.93,-6501.2 1124.07,-6450.87 1124.07,-6450.87 1130.04,-6450.2 1141.96,-6450.2 1147.93,-6450.87 1147.93,-6450.87 1597.07,-6501.2 1597.07,-6501.2 1603.04,-6501.87 1603.04,-6503.2 1597.07,-6503.87 1597.07,-6503.87 1147.93,-6554.2 1147.93,-6554.2 1141.96,-6554.87 1130.04,-6554.87 1124.07,-6554.2"/>
<text text-anchor="middle" x="1136" y="-6513.83" font-family="Times,serif" font-size="14.00">Gate Layer 7 GPU 0</text>
<text text-anchor="middle" x="1136" y="-6498.83" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="1136" y="-6483.83" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer7_gpu0&#45;&gt;gate_layer7_gpu0 -->
<g id="edge689" class="edge">
<title>mha_layer7_gpu0&#45;&gt;gate_layer7_gpu0</title>
<path fill="none" stroke="black" d="M1319.52,-6591.42C1294.03,-6579.21 1262.73,-6564.22 1233.25,-6550.1"/>
<polygon fill="black" stroke="black" points="1234.69,-6546.92 1224.16,-6545.75 1231.67,-6553.23 1234.69,-6546.92"/>
</g>
<!-- gate_layer7_gpu1 -->
<g id="node586" class="node">
<title>gate_layer7_gpu1</title>
<path fill="lightsteelblue" stroke="black" d="M2088.07,-6554.2C2088.07,-6554.2 1638.93,-6503.87 1638.93,-6503.87 1632.96,-6503.2 1632.96,-6501.87 1638.93,-6501.2 1638.93,-6501.2 2088.07,-6450.87 2088.07,-6450.87 2094.04,-6450.2 2105.96,-6450.2 2111.93,-6450.87 2111.93,-6450.87 2561.07,-6501.2 2561.07,-6501.2 2567.04,-6501.87 2567.04,-6503.2 2561.07,-6503.87 2561.07,-6503.87 2111.93,-6554.2 2111.93,-6554.2 2105.96,-6554.87 2094.04,-6554.87 2088.07,-6554.2"/>
<text text-anchor="middle" x="2100" y="-6513.83" font-family="Times,serif" font-size="14.00">Gate Layer 7 GPU 1</text>
<text text-anchor="middle" x="2100" y="-6498.83" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="2100" y="-6483.83" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer7_gpu1&#45;&gt;gate_layer7_gpu1 -->
<g id="edge690" class="edge">
<title>mha_layer7_gpu1&#45;&gt;gate_layer7_gpu1</title>
<path fill="none" stroke="black" d="M2283.52,-6591.42C2258.03,-6579.21 2226.73,-6564.22 2197.25,-6550.1"/>
<polygon fill="black" stroke="black" points="2198.69,-6546.92 2188.16,-6545.75 2195.67,-6553.23 2198.69,-6546.92"/>
</g>
<!-- gate_layer7_gpu2 -->
<g id="node587" class="node">
<title>gate_layer7_gpu2</title>
<path fill="lightsteelblue" stroke="black" d="M3052.07,-6554.2C3052.07,-6554.2 2602.93,-6503.87 2602.93,-6503.87 2596.96,-6503.2 2596.96,-6501.87 2602.93,-6501.2 2602.93,-6501.2 3052.07,-6450.87 3052.07,-6450.87 3058.04,-6450.2 3069.96,-6450.2 3075.93,-6450.87 3075.93,-6450.87 3525.07,-6501.2 3525.07,-6501.2 3531.04,-6501.87 3531.04,-6503.2 3525.07,-6503.87 3525.07,-6503.87 3075.93,-6554.2 3075.93,-6554.2 3069.96,-6554.87 3058.04,-6554.87 3052.07,-6554.2"/>
<text text-anchor="middle" x="3064" y="-6513.83" font-family="Times,serif" font-size="14.00">Gate Layer 7 GPU 2</text>
<text text-anchor="middle" x="3064" y="-6498.83" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="3064" y="-6483.83" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer7_gpu2&#45;&gt;gate_layer7_gpu2 -->
<g id="edge691" class="edge">
<title>mha_layer7_gpu2&#45;&gt;gate_layer7_gpu2</title>
<path fill="none" stroke="black" d="M3247.52,-6591.42C3222.03,-6579.21 3190.73,-6564.22 3161.25,-6550.1"/>
<polygon fill="black" stroke="black" points="3162.69,-6546.92 3152.16,-6545.75 3159.67,-6553.23 3162.69,-6546.92"/>
</g>
<!-- gate_layer7_gpu3 -->
<g id="node588" class="node">
<title>gate_layer7_gpu3</title>
<path fill="lightsteelblue" stroke="black" d="M4016.07,-6554.2C4016.07,-6554.2 3566.93,-6503.87 3566.93,-6503.87 3560.96,-6503.2 3560.96,-6501.87 3566.93,-6501.2 3566.93,-6501.2 4016.07,-6450.87 4016.07,-6450.87 4022.04,-6450.2 4033.96,-6450.2 4039.93,-6450.87 4039.93,-6450.87 4489.07,-6501.2 4489.07,-6501.2 4495.04,-6501.87 4495.04,-6503.2 4489.07,-6503.87 4489.07,-6503.87 4039.93,-6554.2 4039.93,-6554.2 4033.96,-6554.87 4022.04,-6554.87 4016.07,-6554.2"/>
<text text-anchor="middle" x="4028" y="-6513.83" font-family="Times,serif" font-size="14.00">Gate Layer 7 GPU 3</text>
<text text-anchor="middle" x="4028" y="-6498.83" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4028" y="-6483.83" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer7_gpu3&#45;&gt;gate_layer7_gpu3 -->
<g id="edge692" class="edge">
<title>mha_layer7_gpu3&#45;&gt;gate_layer7_gpu3</title>
<path fill="none" stroke="black" d="M4245.59,-6591.42C4214.01,-6578.67 4174.91,-6562.87 4138.61,-6548.21"/>
<polygon fill="black" stroke="black" points="4139.53,-6544.81 4128.95,-6544.31 4136.91,-6551.3 4139.53,-6544.81"/>
</g>
<!-- gate_layer7_gpu4 -->
<g id="node589" class="node">
<title>gate_layer7_gpu4</title>
<path fill="lightsteelblue" stroke="black" d="M4980.07,-6554.2C4980.07,-6554.2 4530.93,-6503.87 4530.93,-6503.87 4524.96,-6503.2 4524.96,-6501.87 4530.93,-6501.2 4530.93,-6501.2 4980.07,-6450.87 4980.07,-6450.87 4986.04,-6450.2 4997.96,-6450.2 5003.93,-6450.87 5003.93,-6450.87 5453.07,-6501.2 5453.07,-6501.2 5459.04,-6501.87 5459.04,-6503.2 5453.07,-6503.87 5453.07,-6503.87 5003.93,-6554.2 5003.93,-6554.2 4997.96,-6554.87 4986.04,-6554.87 4980.07,-6554.2"/>
<text text-anchor="middle" x="4992" y="-6513.83" font-family="Times,serif" font-size="14.00">Gate Layer 7 GPU 4</text>
<text text-anchor="middle" x="4992" y="-6498.83" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4992" y="-6483.83" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer7_gpu4&#45;&gt;gate_layer7_gpu4 -->
<g id="edge693" class="edge">
<title>mha_layer7_gpu4&#45;&gt;gate_layer7_gpu4</title>
<path fill="none" stroke="black" d="M5213.46,-6591.42C5181.03,-6578.55 5140.81,-6562.59 5103.58,-6547.81"/>
<polygon fill="black" stroke="black" points="5104.77,-6544.52 5094.18,-6544.09 5102.19,-6551.03 5104.77,-6544.52"/>
</g>
<!-- gate_layer7_gpu5 -->
<g id="node590" class="node">
<title>gate_layer7_gpu5</title>
<path fill="lightsteelblue" stroke="black" d="M5944.07,-6554.2C5944.07,-6554.2 5494.93,-6503.87 5494.93,-6503.87 5488.96,-6503.2 5488.96,-6501.87 5494.93,-6501.2 5494.93,-6501.2 5944.07,-6450.87 5944.07,-6450.87 5950.04,-6450.2 5961.96,-6450.2 5967.93,-6450.87 5967.93,-6450.87 6417.07,-6501.2 6417.07,-6501.2 6423.04,-6501.87 6423.04,-6503.2 6417.07,-6503.87 6417.07,-6503.87 5967.93,-6554.2 5967.93,-6554.2 5961.96,-6554.87 5950.04,-6554.87 5944.07,-6554.2"/>
<text text-anchor="middle" x="5956" y="-6513.83" font-family="Times,serif" font-size="14.00">Gate Layer 7 GPU 5</text>
<text text-anchor="middle" x="5956" y="-6498.83" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5956" y="-6483.83" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer7_gpu5&#45;&gt;gate_layer7_gpu5 -->
<g id="edge694" class="edge">
<title>mha_layer7_gpu5&#45;&gt;gate_layer7_gpu5</title>
<path fill="none" stroke="black" d="M6043.36,-6591.28C6033.44,-6581.31 6021.68,-6569.51 6010.07,-6557.84"/>
<polygon fill="black" stroke="black" points="6012.4,-6555.23 6002.87,-6550.61 6007.44,-6560.17 6012.4,-6555.23"/>
</g>
<!-- gate_layer7_gpu6 -->
<g id="node591" class="node">
<title>gate_layer7_gpu6</title>
<path fill="lightsteelblue" stroke="black" d="M6908.07,-6554.2C6908.07,-6554.2 6458.93,-6503.87 6458.93,-6503.87 6452.96,-6503.2 6452.96,-6501.87 6458.93,-6501.2 6458.93,-6501.2 6908.07,-6450.87 6908.07,-6450.87 6914.04,-6450.2 6925.96,-6450.2 6931.93,-6450.87 6931.93,-6450.87 7381.07,-6501.2 7381.07,-6501.2 7387.04,-6501.87 7387.04,-6503.2 7381.07,-6503.87 7381.07,-6503.87 6931.93,-6554.2 6931.93,-6554.2 6925.96,-6554.87 6914.04,-6554.87 6908.07,-6554.2"/>
<text text-anchor="middle" x="6920" y="-6513.83" font-family="Times,serif" font-size="14.00">Gate Layer 7 GPU 6</text>
<text text-anchor="middle" x="6920" y="-6498.83" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6920" y="-6483.83" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer7_gpu6&#45;&gt;gate_layer7_gpu6 -->
<g id="edge695" class="edge">
<title>mha_layer7_gpu6&#45;&gt;gate_layer7_gpu6</title>
<path fill="none" stroke="black" d="M7011.22,-6591.28C7000.65,-6581.11 6988.09,-6569.02 6975.72,-6557.12"/>
<polygon fill="black" stroke="black" points="6978.1,-6554.57 6968.47,-6550.16 6973.25,-6559.61 6978.1,-6554.57"/>
</g>
<!-- gate_layer7_gpu7 -->
<g id="node592" class="node">
<title>gate_layer7_gpu7</title>
<path fill="lightsteelblue" stroke="black" d="M7872.07,-6554.2C7872.07,-6554.2 7422.93,-6503.87 7422.93,-6503.87 7416.96,-6503.2 7416.96,-6501.87 7422.93,-6501.2 7422.93,-6501.2 7872.07,-6450.87 7872.07,-6450.87 7878.04,-6450.2 7889.96,-6450.2 7895.93,-6450.87 7895.93,-6450.87 8345.07,-6501.2 8345.07,-6501.2 8351.04,-6501.87 8351.04,-6503.2 8345.07,-6503.87 8345.07,-6503.87 7895.93,-6554.2 7895.93,-6554.2 7889.96,-6554.87 7878.04,-6554.87 7872.07,-6554.2"/>
<text text-anchor="middle" x="7884" y="-6513.83" font-family="Times,serif" font-size="14.00">Gate Layer 7 GPU 7</text>
<text text-anchor="middle" x="7884" y="-6498.83" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="7884" y="-6483.83" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer7_gpu7&#45;&gt;gate_layer7_gpu7 -->
<g id="edge696" class="edge">
<title>mha_layer7_gpu7&#45;&gt;gate_layer7_gpu7</title>
<path fill="none" stroke="black" d="M7894.82,-6591.28C7893.85,-6583.4 7892.74,-6574.37 7891.6,-6565.18"/>
<polygon fill="black" stroke="black" points="7895.07,-6564.67 7890.37,-6555.17 7888.12,-6565.52 7895.07,-6564.67"/>
</g>
<!-- gate_layer7_gpu8 -->
<g id="node593" class="node">
<title>gate_layer7_gpu8</title>
<path fill="lightsteelblue" stroke="black" d="M8836.07,-6554.2C8836.07,-6554.2 8386.93,-6503.87 8386.93,-6503.87 8380.96,-6503.2 8380.96,-6501.87 8386.93,-6501.2 8386.93,-6501.2 8836.07,-6450.87 8836.07,-6450.87 8842.04,-6450.2 8853.96,-6450.2 8859.93,-6450.87 8859.93,-6450.87 9309.07,-6501.2 9309.07,-6501.2 9315.04,-6501.87 9315.04,-6503.2 9309.07,-6503.87 9309.07,-6503.87 8859.93,-6554.2 8859.93,-6554.2 8853.96,-6554.87 8842.04,-6554.87 8836.07,-6554.2"/>
<text text-anchor="middle" x="8848" y="-6513.83" font-family="Times,serif" font-size="14.00">Gate Layer 7 GPU 8</text>
<text text-anchor="middle" x="8848" y="-6498.83" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="8848" y="-6483.83" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer7_gpu8&#45;&gt;gate_layer7_gpu8 -->
<g id="edge697" class="edge">
<title>mha_layer7_gpu8&#45;&gt;gate_layer7_gpu8</title>
<path fill="none" stroke="black" d="M8805.48,-6591.28C8809.75,-6582.48 8814.71,-6572.24 8819.7,-6561.93"/>
<polygon fill="black" stroke="black" points="8822.87,-6563.41 8824.08,-6552.89 8816.57,-6560.36 8822.87,-6563.41"/>
</g>
<!-- gate_layer7_gpu9 -->
<g id="node594" class="node">
<title>gate_layer7_gpu9</title>
<path fill="lightsteelblue" stroke="black" d="M9800.07,-6554.2C9800.07,-6554.2 9350.93,-6503.87 9350.93,-6503.87 9344.96,-6503.2 9344.96,-6501.87 9350.93,-6501.2 9350.93,-6501.2 9800.07,-6450.87 9800.07,-6450.87 9806.04,-6450.2 9817.96,-6450.2 9823.93,-6450.87 9823.93,-6450.87 10273.07,-6501.2 10273.07,-6501.2 10279.04,-6501.87 10279.04,-6503.2 10273.07,-6503.87 10273.07,-6503.87 9823.93,-6554.2 9823.93,-6554.2 9817.96,-6554.87 9806.04,-6554.87 9800.07,-6554.2"/>
<text text-anchor="middle" x="9812" y="-6513.83" font-family="Times,serif" font-size="14.00">Gate Layer 7 GPU 9</text>
<text text-anchor="middle" x="9812" y="-6498.83" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="9812" y="-6483.83" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer7_gpu9&#45;&gt;gate_layer7_gpu9 -->
<g id="edge698" class="edge">
<title>mha_layer7_gpu9&#45;&gt;gate_layer7_gpu9</title>
<path fill="none" stroke="black" d="M9740.1,-6591.28C9747.87,-6581.8 9756.99,-6570.67 9766.08,-6559.57"/>
<polygon fill="black" stroke="black" points="9769.05,-6561.47 9772.68,-6551.52 9763.64,-6557.04 9769.05,-6561.47"/>
</g>
<!-- gate_layer7_gpu10 -->
<g id="node595" class="node">
<title>gate_layer7_gpu10</title>
<path fill="lightsteelblue" stroke="black" d="M10764.07,-6554.2C10764.07,-6554.2 10314.93,-6503.87 10314.93,-6503.87 10308.96,-6503.2 10308.96,-6501.87 10314.93,-6501.2 10314.93,-6501.2 10764.07,-6450.87 10764.07,-6450.87 10770.04,-6450.2 10781.96,-6450.2 10787.93,-6450.87 10787.93,-6450.87 11237.07,-6501.2 11237.07,-6501.2 11243.04,-6501.87 11243.04,-6503.2 11237.07,-6503.87 11237.07,-6503.87 10787.93,-6554.2 10787.93,-6554.2 10781.96,-6554.87 10770.04,-6554.87 10764.07,-6554.2"/>
<text text-anchor="middle" x="10776" y="-6513.83" font-family="Times,serif" font-size="14.00">Gate Layer 7 GPU 10</text>
<text text-anchor="middle" x="10776" y="-6498.83" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="10776" y="-6483.83" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer7_gpu10&#45;&gt;gate_layer7_gpu10 -->
<g id="edge699" class="edge">
<title>mha_layer7_gpu10&#45;&gt;gate_layer7_gpu10</title>
<path fill="none" stroke="black" d="M10770.59,-6591.28C10771.06,-6583.58 10771.61,-6574.78 10772.16,-6565.8"/>
<polygon fill="black" stroke="black" points="10775.66,-6565.83 10772.79,-6555.63 10768.68,-6565.4 10775.66,-6565.83"/>
</g>
<!-- gate_layer7_gpu11 -->
<g id="node596" class="node">
<title>gate_layer7_gpu11</title>
<path fill="lightsteelblue" stroke="black" d="M11728.07,-6554.2C11728.07,-6554.2 11278.93,-6503.87 11278.93,-6503.87 11272.96,-6503.2 11272.96,-6501.87 11278.93,-6501.2 11278.93,-6501.2 11728.07,-6450.87 11728.07,-6450.87 11734.04,-6450.2 11745.96,-6450.2 11751.93,-6450.87 11751.93,-6450.87 12201.07,-6501.2 12201.07,-6501.2 12207.04,-6501.87 12207.04,-6503.2 12201.07,-6503.87 12201.07,-6503.87 11751.93,-6554.2 11751.93,-6554.2 11745.96,-6554.87 11734.04,-6554.87 11728.07,-6554.2"/>
<text text-anchor="middle" x="11740" y="-6513.83" font-family="Times,serif" font-size="14.00">Gate Layer 7 GPU 11</text>
<text text-anchor="middle" x="11740" y="-6498.83" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11740" y="-6483.83" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer7_gpu11&#45;&gt;gate_layer7_gpu11 -->
<g id="edge700" class="edge">
<title>mha_layer7_gpu11&#45;&gt;gate_layer7_gpu11</title>
<path fill="none" stroke="black" d="M11499.96,-6591.42C11535.82,-6578.29 11580.49,-6561.93 11621.54,-6546.91"/>
<polygon fill="black" stroke="black" points="11622.87,-6550.15 11631.06,-6543.42 11620.46,-6543.57 11622.87,-6550.15"/>
</g>
<!-- gate_layer7_gpu12 -->
<g id="node597" class="node">
<title>gate_layer7_gpu12</title>
<path fill="lightsteelblue" stroke="black" d="M12692.07,-6554.2C12692.07,-6554.2 12242.93,-6503.87 12242.93,-6503.87 12236.96,-6503.2 12236.96,-6501.87 12242.93,-6501.2 12242.93,-6501.2 12692.07,-6450.87 12692.07,-6450.87 12698.04,-6450.2 12709.96,-6450.2 12715.93,-6450.87 12715.93,-6450.87 13165.07,-6501.2 13165.07,-6501.2 13171.04,-6501.87 13171.04,-6503.2 13165.07,-6503.87 13165.07,-6503.87 12715.93,-6554.2 12715.93,-6554.2 12709.96,-6554.87 12698.04,-6554.87 12692.07,-6554.2"/>
<text text-anchor="middle" x="12704" y="-6513.83" font-family="Times,serif" font-size="14.00">Gate Layer 7 GPU 12</text>
<text text-anchor="middle" x="12704" y="-6498.83" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="12704" y="-6483.83" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer7_gpu12&#45;&gt;gate_layer7_gpu12 -->
<g id="edge701" class="edge">
<title>mha_layer7_gpu12&#45;&gt;gate_layer7_gpu12</title>
<path fill="none" stroke="black" d="M12162.3,-6591.49C12263.42,-6575.07 12395.68,-6553.6 12504.2,-6535.98"/>
<polygon fill="black" stroke="black" points="12504.98,-6539.39 12514.29,-6534.34 12503.86,-6532.48 12504.98,-6539.39"/>
</g>
<!-- gate_layer7_gpu13 -->
<g id="node598" class="node">
<title>gate_layer7_gpu13</title>
<path fill="lightsteelblue" stroke="black" d="M13656.07,-6554.2C13656.07,-6554.2 13206.93,-6503.87 13206.93,-6503.87 13200.96,-6503.2 13200.96,-6501.87 13206.93,-6501.2 13206.93,-6501.2 13656.07,-6450.87 13656.07,-6450.87 13662.04,-6450.2 13673.96,-6450.2 13679.93,-6450.87 13679.93,-6450.87 14129.07,-6501.2 14129.07,-6501.2 14135.04,-6501.87 14135.04,-6503.2 14129.07,-6503.87 14129.07,-6503.87 13679.93,-6554.2 13679.93,-6554.2 13673.96,-6554.87 13662.04,-6554.87 13656.07,-6554.2"/>
<text text-anchor="middle" x="13668" y="-6513.83" font-family="Times,serif" font-size="14.00">Gate Layer 7 GPU 13</text>
<text text-anchor="middle" x="13668" y="-6498.83" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13668" y="-6483.83" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer7_gpu13&#45;&gt;gate_layer7_gpu13 -->
<g id="edge702" class="edge">
<title>mha_layer7_gpu13&#45;&gt;gate_layer7_gpu13</title>
<path fill="none" stroke="black" d="M13590.69,-6591.28C13599.21,-6581.61 13609.26,-6570.2 13619.24,-6558.87"/>
<polygon fill="black" stroke="black" points="13622.14,-6560.88 13626.12,-6551.06 13616.89,-6556.25 13622.14,-6560.88"/>
</g>
<!-- gate_layer7_gpu14 -->
<g id="node599" class="node">
<title>gate_layer7_gpu14</title>
<path fill="lightsteelblue" stroke="black" d="M14620.07,-6554.2C14620.07,-6554.2 14170.93,-6503.87 14170.93,-6503.87 14164.96,-6503.2 14164.96,-6501.87 14170.93,-6501.2 14170.93,-6501.2 14620.07,-6450.87 14620.07,-6450.87 14626.04,-6450.2 14637.96,-6450.2 14643.93,-6450.87 14643.93,-6450.87 15093.07,-6501.2 15093.07,-6501.2 15099.04,-6501.87 15099.04,-6503.2 15093.07,-6503.87 15093.07,-6503.87 14643.93,-6554.2 14643.93,-6554.2 14637.96,-6554.87 14626.04,-6554.87 14620.07,-6554.2"/>
<text text-anchor="middle" x="14632" y="-6513.83" font-family="Times,serif" font-size="14.00">Gate Layer 7 GPU 14</text>
<text text-anchor="middle" x="14632" y="-6498.83" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14632" y="-6483.83" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer7_gpu14&#45;&gt;gate_layer7_gpu14 -->
<g id="edge703" class="edge">
<title>mha_layer7_gpu14&#45;&gt;gate_layer7_gpu14</title>
<path fill="none" stroke="black" d="M14253.05,-6591.49C14317.2,-6576.6 14399.28,-6557.55 14470.63,-6540.99"/>
<polygon fill="black" stroke="black" points="14471.68,-6544.34 14480.63,-6538.67 14470.09,-6537.52 14471.68,-6544.34"/>
</g>
<!-- gate_layer7_gpu15 -->
<g id="node600" class="node">
<title>gate_layer7_gpu15</title>
<path fill="lightsteelblue" stroke="black" d="M15584.07,-6554.2C15584.07,-6554.2 15134.93,-6503.87 15134.93,-6503.87 15128.96,-6503.2 15128.96,-6501.87 15134.93,-6501.2 15134.93,-6501.2 15584.07,-6450.87 15584.07,-6450.87 15590.04,-6450.2 15601.96,-6450.2 15607.93,-6450.87 15607.93,-6450.87 16057.07,-6501.2 16057.07,-6501.2 16063.04,-6501.87 16063.04,-6503.2 16057.07,-6503.87 16057.07,-6503.87 15607.93,-6554.2 15607.93,-6554.2 15601.96,-6554.87 15590.04,-6554.87 15584.07,-6554.2"/>
<text text-anchor="middle" x="15596" y="-6513.83" font-family="Times,serif" font-size="14.00">Gate Layer 7 GPU 15</text>
<text text-anchor="middle" x="15596" y="-6498.83" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="15596" y="-6483.83" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer7_gpu15&#45;&gt;gate_layer7_gpu15 -->
<g id="edge704" class="edge">
<title>mha_layer7_gpu15&#45;&gt;gate_layer7_gpu15</title>
<path fill="none" stroke="black" d="M15431.07,-6591.42C15453.24,-6579.61 15480.3,-6565.18 15506.05,-6551.47"/>
<polygon fill="black" stroke="black" points="15507.91,-6554.44 15515.09,-6546.65 15504.61,-6548.26 15507.91,-6554.44"/>
</g>
<!-- route_layer7_gpu0 -->
<g id="node617" class="node">
<title>route_layer7_gpu0</title>
<path fill="orange" stroke="black" d="M1543.74,-6413.53C1543.74,-6413.53 1035.24,-6413.53 1035.24,-6413.53 1029.24,-6413.53 1018.5,-6409.86 1013.75,-6406.19 1013.75,-6406.19 895.75,-6314.88 895.75,-6314.88 891,-6311.21 892.26,-6307.53 898.26,-6307.53 898.26,-6307.53 1406.76,-6307.53 1406.76,-6307.53 1412.76,-6307.53 1423.5,-6311.21 1428.25,-6314.88 1428.25,-6314.88 1546.25,-6406.19 1546.25,-6406.19 1551,-6409.86 1549.74,-6413.53 1543.74,-6413.53"/>
<text text-anchor="middle" x="1221" y="-6371.83" font-family="Times,serif" font-size="14.00">Token Router Layer 7 GPU 0</text>
<text text-anchor="middle" x="1221" y="-6356.83" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="1221" y="-6341.83" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer7_gpu0&#45;&gt;route_layer7_gpu0 -->
<g id="edge705" class="edge">
<title>gate_layer7_gpu0&#45;&gt;route_layer7_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1165.73,-6452.57C1171.65,-6442.81 1177.94,-6432.45 1184.07,-6422.35"/>
<polygon fill="black" stroke="black" points="1187.21,-6423.93 1189.41,-6413.56 1181.23,-6420.3 1187.21,-6423.93"/>
</g>
<!-- route_layer7_gpu1 -->
<g id="node619" class="node">
<title>route_layer7_gpu1</title>
<path fill="orange" stroke="black" d="M3197.74,-6413.53C3197.74,-6413.53 2689.24,-6413.53 2689.24,-6413.53 2683.24,-6413.53 2672.5,-6409.86 2667.75,-6406.19 2667.75,-6406.19 2549.75,-6314.88 2549.75,-6314.88 2545,-6311.21 2546.26,-6307.53 2552.26,-6307.53 2552.26,-6307.53 3060.76,-6307.53 3060.76,-6307.53 3066.76,-6307.53 3077.5,-6311.21 3082.25,-6314.88 3082.25,-6314.88 3200.25,-6406.19 3200.25,-6406.19 3205,-6409.86 3203.74,-6413.53 3197.74,-6413.53"/>
<text text-anchor="middle" x="2875" y="-6371.83" font-family="Times,serif" font-size="14.00">Token Router Layer 7 GPU 1</text>
<text text-anchor="middle" x="2875" y="-6356.83" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="2875" y="-6341.83" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer7_gpu1&#45;&gt;route_layer7_gpu1 -->
<g id="edge706" class="edge">
<title>gate_layer7_gpu1&#45;&gt;route_layer7_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2277.8,-6469.41C2388.42,-6449.43 2531.68,-6423.55 2650.15,-6402.15"/>
<polygon fill="black" stroke="black" points="2650.86,-6405.58 2660.08,-6400.36 2649.62,-6398.69 2650.86,-6405.58"/>
</g>
<!-- route_layer7_gpu2 -->
<g id="node621" class="node">
<title>route_layer7_gpu2</title>
<path fill="orange" stroke="black" d="M4368.74,-6413.53C4368.74,-6413.53 3860.24,-6413.53 3860.24,-6413.53 3854.24,-6413.53 3843.5,-6409.86 3838.75,-6406.19 3838.75,-6406.19 3720.75,-6314.88 3720.75,-6314.88 3716,-6311.21 3717.26,-6307.53 3723.26,-6307.53 3723.26,-6307.53 4231.76,-6307.53 4231.76,-6307.53 4237.76,-6307.53 4248.5,-6311.21 4253.25,-6314.88 4253.25,-6314.88 4371.25,-6406.19 4371.25,-6406.19 4376,-6409.86 4374.74,-6413.53 4368.74,-6413.53"/>
<text text-anchor="middle" x="4046" y="-6371.83" font-family="Times,serif" font-size="14.00">Token Router Layer 7 GPU 2</text>
<text text-anchor="middle" x="4046" y="-6356.83" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="4046" y="-6341.83" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer7_gpu2&#45;&gt;route_layer7_gpu2 -->
<g id="edge707" class="edge">
<title>gate_layer7_gpu2&#45;&gt;route_layer7_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3268.37,-6472.4C3426.77,-6449.81 3646.43,-6418.5 3811.9,-6394.91"/>
<polygon fill="black" stroke="black" points="3812.81,-6398.31 3822.22,-6393.44 3811.82,-6391.38 3812.81,-6398.31"/>
</g>
<!-- route_layer7_gpu3 -->
<g id="node623" class="node">
<title>route_layer7_gpu3</title>
<path fill="orange" stroke="black" d="M5297.74,-6413.53C5297.74,-6413.53 4789.24,-6413.53 4789.24,-6413.53 4783.24,-6413.53 4772.5,-6409.86 4767.75,-6406.19 4767.75,-6406.19 4649.75,-6314.88 4649.75,-6314.88 4645,-6311.21 4646.26,-6307.53 4652.26,-6307.53 4652.26,-6307.53 5160.76,-6307.53 5160.76,-6307.53 5166.76,-6307.53 5177.5,-6311.21 5182.25,-6314.88 5182.25,-6314.88 5300.25,-6406.19 5300.25,-6406.19 5305,-6409.86 5303.74,-6413.53 5297.74,-6413.53"/>
<text text-anchor="middle" x="4975" y="-6371.83" font-family="Times,serif" font-size="14.00">Token Router Layer 7 GPU 3</text>
<text text-anchor="middle" x="4975" y="-6356.83" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="4975" y="-6341.83" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer7_gpu3&#45;&gt;route_layer7_gpu3 -->
<g id="edge708" class="edge">
<title>gate_layer7_gpu3&#45;&gt;route_layer7_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4228.26,-6471.93C4378.43,-6449.73 4584.36,-6419.28 4741.94,-6395.99"/>
<polygon fill="black" stroke="black" points="4742.86,-6399.39 4752.24,-6394.46 4741.84,-6392.46 4742.86,-6399.39"/>
</g>
<!-- route_layer7_gpu4 -->
<g id="node625" class="node">
<title>route_layer7_gpu4</title>
<path fill="orange" stroke="black" d="M6106.74,-6413.53C6106.74,-6413.53 5598.24,-6413.53 5598.24,-6413.53 5592.24,-6413.53 5581.5,-6409.86 5576.75,-6406.19 5576.75,-6406.19 5458.75,-6314.88 5458.75,-6314.88 5454,-6311.21 5455.26,-6307.53 5461.26,-6307.53 5461.26,-6307.53 5969.76,-6307.53 5969.76,-6307.53 5975.76,-6307.53 5986.5,-6311.21 5991.25,-6314.88 5991.25,-6314.88 6109.25,-6406.19 6109.25,-6406.19 6114,-6409.86 6112.74,-6413.53 6106.74,-6413.53"/>
<text text-anchor="middle" x="5784" y="-6371.83" font-family="Times,serif" font-size="14.00">Token Router Layer 7 GPU 4</text>
<text text-anchor="middle" x="5784" y="-6356.83" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="5784" y="-6341.83" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer7_gpu4&#45;&gt;route_layer7_gpu4 -->
<g id="edge709" class="edge">
<title>gate_layer7_gpu4&#45;&gt;route_layer7_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5172.21,-6469.68C5286.77,-6449.43 5436,-6423.05 5558.4,-6401.41"/>
<polygon fill="black" stroke="black" points="5559.04,-6404.85 5568.28,-6399.67 5557.83,-6397.96 5559.04,-6404.85"/>
</g>
<!-- route_layer7_gpu5 -->
<g id="node627" class="node">
<title>route_layer7_gpu5</title>
<path fill="orange" stroke="black" d="M6854.74,-6413.53C6854.74,-6413.53 6346.24,-6413.53 6346.24,-6413.53 6340.24,-6413.53 6329.5,-6409.86 6324.75,-6406.19 6324.75,-6406.19 6206.75,-6314.88 6206.75,-6314.88 6202,-6311.21 6203.26,-6307.53 6209.26,-6307.53 6209.26,-6307.53 6717.76,-6307.53 6717.76,-6307.53 6723.76,-6307.53 6734.5,-6311.21 6739.25,-6314.88 6739.25,-6314.88 6857.25,-6406.19 6857.25,-6406.19 6862,-6409.86 6860.74,-6413.53 6854.74,-6413.53"/>
<text text-anchor="middle" x="6532" y="-6371.83" font-family="Times,serif" font-size="14.00">Token Router Layer 7 GPU 5</text>
<text text-anchor="middle" x="6532" y="-6356.83" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="6532" y="-6341.83" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer7_gpu5&#45;&gt;route_layer7_gpu5 -->
<g id="edge710" class="edge">
<title>gate_layer7_gpu5&#45;&gt;route_layer7_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6102.47,-6465.93C6168.65,-6449.85 6248.12,-6430.53 6320.6,-6412.92"/>
<polygon fill="black" stroke="black" points="6321.43,-6416.32 6330.32,-6410.55 6319.77,-6409.51 6321.43,-6416.32"/>
</g>
<!-- route_layer7_gpu6 -->
<g id="node629" class="node">
<title>route_layer7_gpu6</title>
<path fill="orange" stroke="black" d="M7572.74,-6413.53C7572.74,-6413.53 7064.24,-6413.53 7064.24,-6413.53 7058.24,-6413.53 7047.5,-6409.86 7042.75,-6406.19 7042.75,-6406.19 6924.75,-6314.88 6924.75,-6314.88 6920,-6311.21 6921.26,-6307.53 6927.26,-6307.53 6927.26,-6307.53 7435.76,-6307.53 7435.76,-6307.53 7441.76,-6307.53 7452.5,-6311.21 7457.25,-6314.88 7457.25,-6314.88 7575.25,-6406.19 7575.25,-6406.19 7580,-6409.86 7578.74,-6413.53 7572.74,-6413.53"/>
<text text-anchor="middle" x="7250" y="-6371.83" font-family="Times,serif" font-size="14.00">Token Router Layer 7 GPU 6</text>
<text text-anchor="middle" x="7250" y="-6356.83" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="7250" y="-6341.83" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer7_gpu6&#45;&gt;route_layer7_gpu6 -->
<g id="edge711" class="edge">
<title>gate_layer7_gpu6&#45;&gt;route_layer7_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7017.23,-6460.29C7048.77,-6446.9 7084.31,-6431.83 7117.94,-6417.56"/>
<polygon fill="black" stroke="black" points="7119.54,-6420.68 7127.38,-6413.56 7116.8,-6414.24 7119.54,-6420.68"/>
</g>
<!-- route_layer7_gpu7 -->
<g id="node631" class="node">
<title>route_layer7_gpu7</title>
<path fill="orange" stroke="black" d="M8275.74,-6413.53C8275.74,-6413.53 7767.24,-6413.53 7767.24,-6413.53 7761.24,-6413.53 7750.5,-6409.86 7745.75,-6406.19 7745.75,-6406.19 7627.75,-6314.88 7627.75,-6314.88 7623,-6311.21 7624.26,-6307.53 7630.26,-6307.53 7630.26,-6307.53 8138.76,-6307.53 8138.76,-6307.53 8144.76,-6307.53 8155.5,-6311.21 8160.25,-6314.88 8160.25,-6314.88 8278.25,-6406.19 8278.25,-6406.19 8283,-6409.86 8281.74,-6413.53 8275.74,-6413.53"/>
<text text-anchor="middle" x="7953" y="-6371.83" font-family="Times,serif" font-size="14.00">Token Router Layer 7 GPU 7</text>
<text text-anchor="middle" x="7953" y="-6356.83" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="7953" y="-6341.83" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer7_gpu7&#45;&gt;route_layer7_gpu7 -->
<g id="edge712" class="edge">
<title>gate_layer7_gpu7&#45;&gt;route_layer7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7908.33,-6452.17C7912.97,-6442.75 7917.89,-6432.77 7922.69,-6423.02"/>
<polygon fill="black" stroke="black" points="7925.97,-6424.29 7927.26,-6413.77 7919.7,-6421.19 7925.97,-6424.29"/>
</g>
<!-- route_layer7_gpu8 -->
<g id="node633" class="node">
<title>route_layer7_gpu8</title>
<path fill="orange" stroke="black" d="M9101.74,-6413.53C9101.74,-6413.53 8593.24,-6413.53 8593.24,-6413.53 8587.24,-6413.53 8576.5,-6409.86 8571.75,-6406.19 8571.75,-6406.19 8453.75,-6314.88 8453.75,-6314.88 8449,-6311.21 8450.26,-6307.53 8456.26,-6307.53 8456.26,-6307.53 8964.76,-6307.53 8964.76,-6307.53 8970.76,-6307.53 8981.5,-6311.21 8986.25,-6314.88 8986.25,-6314.88 9104.25,-6406.19 9104.25,-6406.19 9109,-6409.86 9107.74,-6413.53 9101.74,-6413.53"/>
<text text-anchor="middle" x="8779" y="-6371.83" font-family="Times,serif" font-size="14.00">Token Router Layer 7 GPU 8</text>
<text text-anchor="middle" x="8779" y="-6356.83" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="8779" y="-6341.83" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer7_gpu8&#45;&gt;route_layer7_gpu8 -->
<g id="edge713" class="edge">
<title>gate_layer7_gpu8&#45;&gt;route_layer7_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8823.67,-6452.17C8819.03,-6442.75 8814.11,-6432.77 8809.31,-6423.02"/>
<polygon fill="black" stroke="black" points="8812.3,-6421.19 8804.74,-6413.77 8806.03,-6424.29 8812.3,-6421.19"/>
</g>
<!-- route_layer7_gpu9 -->
<g id="node635" class="node">
<title>route_layer7_gpu9</title>
<path fill="orange" stroke="black" d="M9996.74,-6413.53C9996.74,-6413.53 9488.24,-6413.53 9488.24,-6413.53 9482.24,-6413.53 9471.5,-6409.86 9466.75,-6406.19 9466.75,-6406.19 9348.75,-6314.88 9348.75,-6314.88 9344,-6311.21 9345.26,-6307.53 9351.26,-6307.53 9351.26,-6307.53 9859.76,-6307.53 9859.76,-6307.53 9865.76,-6307.53 9876.5,-6311.21 9881.25,-6314.88 9881.25,-6314.88 9999.25,-6406.19 9999.25,-6406.19 10004,-6409.86 10002.74,-6413.53 9996.74,-6413.53"/>
<text text-anchor="middle" x="9674" y="-6371.83" font-family="Times,serif" font-size="14.00">Token Router Layer 7 GPU 9</text>
<text text-anchor="middle" x="9674" y="-6356.83" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="9674" y="-6341.83" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer7_gpu9&#45;&gt;route_layer7_gpu9 -->
<g id="edge714" class="edge">
<title>gate_layer7_gpu9&#45;&gt;route_layer7_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9765.66,-6454.53C9755.13,-6443.84 9743.8,-6432.35 9732.83,-6421.21"/>
<polygon fill="black" stroke="black" points="9735.19,-6418.62 9725.68,-6413.96 9730.2,-6423.54 9735.19,-6418.62"/>
</g>
<!-- route_layer7_gpu10 -->
<g id="node637" class="node">
<title>route_layer7_gpu10</title>
<path fill="orange" stroke="black" d="M10925.74,-6413.53C10925.74,-6413.53 10417.24,-6413.53 10417.24,-6413.53 10411.24,-6413.53 10400.5,-6409.86 10395.75,-6406.19 10395.75,-6406.19 10277.75,-6314.88 10277.75,-6314.88 10273,-6311.21 10274.26,-6307.53 10280.26,-6307.53 10280.26,-6307.53 10788.76,-6307.53 10788.76,-6307.53 10794.76,-6307.53 10805.5,-6311.21 10810.25,-6314.88 10810.25,-6314.88 10928.25,-6406.19 10928.25,-6406.19 10933,-6409.86 10931.74,-6413.53 10925.74,-6413.53"/>
<text text-anchor="middle" x="10603" y="-6371.83" font-family="Times,serif" font-size="14.00">Token Router Layer 7 GPU 10</text>
<text text-anchor="middle" x="10603" y="-6356.83" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="10603" y="-6341.83" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer7_gpu10&#45;&gt;route_layer7_gpu10 -->
<g id="edge715" class="edge">
<title>gate_layer7_gpu10&#45;&gt;route_layer7_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10719.35,-6455.69C10705.3,-6444.32 10690.05,-6431.98 10675.36,-6420.09"/>
<polygon fill="black" stroke="black" points="10677.24,-6417.11 10667.27,-6413.54 10672.84,-6422.55 10677.24,-6417.11"/>
</g>
<!-- route_layer7_gpu11 -->
<g id="node639" class="node">
<title>route_layer7_gpu11</title>
<path fill="orange" stroke="black" d="M11872.74,-6413.53C11872.74,-6413.53 11364.24,-6413.53 11364.24,-6413.53 11358.24,-6413.53 11347.5,-6409.86 11342.75,-6406.19 11342.75,-6406.19 11224.75,-6314.88 11224.75,-6314.88 11220,-6311.21 11221.26,-6307.53 11227.26,-6307.53 11227.26,-6307.53 11735.76,-6307.53 11735.76,-6307.53 11741.76,-6307.53 11752.5,-6311.21 11757.25,-6314.88 11757.25,-6314.88 11875.25,-6406.19 11875.25,-6406.19 11880,-6409.86 11878.74,-6413.53 11872.74,-6413.53"/>
<text text-anchor="middle" x="11550" y="-6371.83" font-family="Times,serif" font-size="14.00">Token Router Layer 7 GPU 11</text>
<text text-anchor="middle" x="11550" y="-6356.83" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="11550" y="-6341.83" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer7_gpu11&#45;&gt;route_layer7_gpu11 -->
<g id="edge716" class="edge">
<title>gate_layer7_gpu11&#45;&gt;route_layer7_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11678.57,-6456.27C11662.74,-6444.6 11645.47,-6431.88 11628.87,-6419.65"/>
<polygon fill="black" stroke="black" points="11630.92,-6416.81 11620.79,-6413.7 11626.77,-6422.45 11630.92,-6416.81"/>
</g>
<!-- route_layer7_gpu12 -->
<g id="node641" class="node">
<title>route_layer7_gpu12</title>
<path fill="orange" stroke="black" d="M12827.74,-6413.53C12827.74,-6413.53 12319.24,-6413.53 12319.24,-6413.53 12313.24,-6413.53 12302.5,-6409.86 12297.75,-6406.19 12297.75,-6406.19 12179.75,-6314.88 12179.75,-6314.88 12175,-6311.21 12176.26,-6307.53 12182.26,-6307.53 12182.26,-6307.53 12690.76,-6307.53 12690.76,-6307.53 12696.76,-6307.53 12707.5,-6311.21 12712.25,-6314.88 12712.25,-6314.88 12830.25,-6406.19 12830.25,-6406.19 12835,-6409.86 12833.74,-6413.53 12827.74,-6413.53"/>
<text text-anchor="middle" x="12505" y="-6371.83" font-family="Times,serif" font-size="14.00">Token Router Layer 7 GPU 12</text>
<text text-anchor="middle" x="12505" y="-6356.83" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="12505" y="-6341.83" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer7_gpu12&#45;&gt;route_layer7_gpu12 -->
<g id="edge717" class="edge">
<title>gate_layer7_gpu12&#45;&gt;route_layer7_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12640.21,-6456.66C12623.51,-6444.91 12605.25,-6432.06 12587.71,-6419.72"/>
<polygon fill="black" stroke="black" points="12589.36,-6416.61 12579.17,-6413.71 12585.34,-6422.33 12589.36,-6416.61"/>
</g>
<!-- route_layer7_gpu13 -->
<g id="node643" class="node">
<title>route_layer7_gpu13</title>
<path fill="orange" stroke="black" d="M13787.74,-6413.53C13787.74,-6413.53 13279.24,-6413.53 13279.24,-6413.53 13273.24,-6413.53 13262.5,-6409.86 13257.75,-6406.19 13257.75,-6406.19 13139.75,-6314.88 13139.75,-6314.88 13135,-6311.21 13136.26,-6307.53 13142.26,-6307.53 13142.26,-6307.53 13650.76,-6307.53 13650.76,-6307.53 13656.76,-6307.53 13667.5,-6311.21 13672.25,-6314.88 13672.25,-6314.88 13790.25,-6406.19 13790.25,-6406.19 13795,-6409.86 13793.74,-6413.53 13787.74,-6413.53"/>
<text text-anchor="middle" x="13465" y="-6371.83" font-family="Times,serif" font-size="14.00">Token Router Layer 7 GPU 13</text>
<text text-anchor="middle" x="13465" y="-6356.83" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="13465" y="-6341.83" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer7_gpu13&#45;&gt;route_layer7_gpu13 -->
<g id="edge718" class="edge">
<title>gate_layer7_gpu13&#45;&gt;route_layer7_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13602.93,-6456.66C13585.89,-6444.91 13567.27,-6432.06 13549.38,-6419.72"/>
<polygon fill="black" stroke="black" points="13550.88,-6416.51 13540.66,-6413.71 13546.91,-6422.27 13550.88,-6416.51"/>
</g>
<!-- route_layer7_gpu14 -->
<g id="node645" class="node">
<title>route_layer7_gpu14</title>
<path fill="orange" stroke="black" d="M14749.74,-6413.53C14749.74,-6413.53 14241.24,-6413.53 14241.24,-6413.53 14235.24,-6413.53 14224.5,-6409.86 14219.75,-6406.19 14219.75,-6406.19 14101.75,-6314.88 14101.75,-6314.88 14097,-6311.21 14098.26,-6307.53 14104.26,-6307.53 14104.26,-6307.53 14612.76,-6307.53 14612.76,-6307.53 14618.76,-6307.53 14629.5,-6311.21 14634.25,-6314.88 14634.25,-6314.88 14752.25,-6406.19 14752.25,-6406.19 14757,-6409.86 14755.74,-6413.53 14749.74,-6413.53"/>
<text text-anchor="middle" x="14427" y="-6371.83" font-family="Times,serif" font-size="14.00">Token Router Layer 7 GPU 14</text>
<text text-anchor="middle" x="14427" y="-6356.83" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="14427" y="-6341.83" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer7_gpu14&#45;&gt;route_layer7_gpu14 -->
<g id="edge719" class="edge">
<title>gate_layer7_gpu14&#45;&gt;route_layer7_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14566.57,-6456.85C14549.1,-6444.92 14529.96,-6431.84 14511.61,-6419.31"/>
<polygon fill="black" stroke="black" points="14513.47,-6416.35 14503.24,-6413.6 14509.52,-6422.13 14513.47,-6416.35"/>
</g>
<!-- route_layer7_gpu15 -->
<g id="node647" class="node">
<title>route_layer7_gpu15</title>
<path fill="orange" stroke="black" d="M15712.74,-6413.53C15712.74,-6413.53 15204.24,-6413.53 15204.24,-6413.53 15198.24,-6413.53 15187.5,-6409.86 15182.75,-6406.19 15182.75,-6406.19 15064.75,-6314.88 15064.75,-6314.88 15060,-6311.21 15061.26,-6307.53 15067.26,-6307.53 15067.26,-6307.53 15575.76,-6307.53 15575.76,-6307.53 15581.76,-6307.53 15592.5,-6311.21 15597.25,-6314.88 15597.25,-6314.88 15715.25,-6406.19 15715.25,-6406.19 15720,-6409.86 15718.74,-6413.53 15712.74,-6413.53"/>
<text text-anchor="middle" x="15390" y="-6371.83" font-family="Times,serif" font-size="14.00">Token Router Layer 7 GPU 15</text>
<text text-anchor="middle" x="15390" y="-6356.83" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="15390" y="-6341.83" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer7_gpu15&#45;&gt;route_layer7_gpu15 -->
<g id="edge720" class="edge">
<title>gate_layer7_gpu15&#45;&gt;route_layer7_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15530.25,-6456.85C15512.69,-6444.92 15493.46,-6431.84 15475.02,-6419.31"/>
<polygon fill="black" stroke="black" points="15476.85,-6416.32 15466.61,-6413.6 15472.91,-6422.11 15476.85,-6416.32"/>
</g>
<!-- expert_layer7_gpu0_expert0 -->
<g id="node601" class="node">
<title>expert_layer7_gpu0_expert0</title>
<path fill="lightcoral" stroke="black" d="M1847.5,-6160.58C1847.5,-6160.58 1378.5,-6160.58 1378.5,-6160.58 1372.5,-6160.58 1366.5,-6154.58 1366.5,-6148.58 1366.5,-6148.58 1366.5,-6104.58 1366.5,-6104.58 1366.5,-6098.58 1372.5,-6092.58 1378.5,-6092.58 1378.5,-6092.58 1847.5,-6092.58 1847.5,-6092.58 1853.5,-6092.58 1859.5,-6098.58 1859.5,-6104.58 1859.5,-6104.58 1859.5,-6148.58 1859.5,-6148.58 1859.5,-6154.58 1853.5,-6160.58 1847.5,-6160.58"/>
<text text-anchor="middle" x="1613" y="-6145.38" font-family="Times,serif" font-size="14.00">Expert 0 Layer 7 GPU 0</text>
<text text-anchor="middle" x="1613" y="-6130.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="1613" y="-6115.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="1613" y="-6100.38" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer7_gpu0 -->
<g id="node618" class="node">
<title>aggregate_layer7_gpu0</title>
<path fill="orange" stroke="black" d="M1847.29,-6056.58C1847.29,-6056.58 1360.19,-6056.58 1360.19,-6056.58 1354.19,-6056.58 1343.52,-6052.81 1338.85,-6049.05 1338.85,-6049.05 1226.06,-5958.11 1226.06,-5958.11 1221.38,-5954.35 1222.71,-5950.58 1228.71,-5950.58 1228.71,-5950.58 1715.81,-5950.58 1715.81,-5950.58 1721.81,-5950.58 1732.48,-5954.35 1737.15,-5958.11 1737.15,-5958.11 1849.94,-6049.05 1849.94,-6049.05 1854.62,-6052.81 1853.29,-6056.58 1847.29,-6056.58"/>
<text text-anchor="middle" x="1538" y="-6014.88" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 7 GPU 0</text>
<text text-anchor="middle" x="1538" y="-5999.88" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="1538" y="-5984.88" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer7_gpu0_expert0&#45;&gt;aggregate_layer7_gpu0 -->
<g id="edge753" class="edge">
<title>expert_layer7_gpu0_expert0&#45;&gt;aggregate_layer7_gpu0</title>
<path fill="none" stroke="black" d="M1592.51,-6092.52C1587.26,-6084.05 1581.45,-6074.68 1575.63,-6065.3"/>
<polygon fill="black" stroke="black" points="1578.55,-6063.36 1570.31,-6056.71 1572.6,-6067.05 1578.55,-6063.36"/>
</g>
<!-- expert_layer7_gpu1_expert1 -->
<g id="node602" class="node">
<title>expert_layer7_gpu1_expert1</title>
<path fill="lightcoral" stroke="black" d="M2798.5,-6160.58C2798.5,-6160.58 2329.5,-6160.58 2329.5,-6160.58 2323.5,-6160.58 2317.5,-6154.58 2317.5,-6148.58 2317.5,-6148.58 2317.5,-6104.58 2317.5,-6104.58 2317.5,-6098.58 2323.5,-6092.58 2329.5,-6092.58 2329.5,-6092.58 2798.5,-6092.58 2798.5,-6092.58 2804.5,-6092.58 2810.5,-6098.58 2810.5,-6104.58 2810.5,-6104.58 2810.5,-6148.58 2810.5,-6148.58 2810.5,-6154.58 2804.5,-6160.58 2798.5,-6160.58"/>
<text text-anchor="middle" x="2564" y="-6145.38" font-family="Times,serif" font-size="14.00">Expert 1 Layer 7 GPU 1</text>
<text text-anchor="middle" x="2564" y="-6130.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2564" y="-6115.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2564" y="-6100.38" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer7_gpu1 -->
<g id="node620" class="node">
<title>aggregate_layer7_gpu1</title>
<path fill="orange" stroke="black" d="M2740.29,-6056.58C2740.29,-6056.58 2253.19,-6056.58 2253.19,-6056.58 2247.19,-6056.58 2236.52,-6052.81 2231.85,-6049.05 2231.85,-6049.05 2119.06,-5958.11 2119.06,-5958.11 2114.38,-5954.35 2115.71,-5950.58 2121.71,-5950.58 2121.71,-5950.58 2608.81,-5950.58 2608.81,-5950.58 2614.81,-5950.58 2625.48,-5954.35 2630.15,-5958.11 2630.15,-5958.11 2742.94,-6049.05 2742.94,-6049.05 2747.62,-6052.81 2746.29,-6056.58 2740.29,-6056.58"/>
<text text-anchor="middle" x="2431" y="-6014.88" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 7 GPU 1</text>
<text text-anchor="middle" x="2431" y="-5999.88" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="2431" y="-5984.88" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer7_gpu1_expert1&#45;&gt;aggregate_layer7_gpu1 -->
<g id="edge754" class="edge">
<title>expert_layer7_gpu1_expert1&#45;&gt;aggregate_layer7_gpu1</title>
<path fill="none" stroke="black" d="M2527.66,-6092.52C2517.78,-6083.53 2506.78,-6073.53 2495.85,-6063.57"/>
<polygon fill="black" stroke="black" points="2498.05,-6060.85 2488.3,-6056.71 2493.34,-6066.03 2498.05,-6060.85"/>
</g>
<!-- expert_layer7_gpu2_expert2 -->
<g id="node603" class="node">
<title>expert_layer7_gpu2_expert2</title>
<path fill="lightcoral" stroke="black" d="M3782.5,-6160.58C3782.5,-6160.58 3313.5,-6160.58 3313.5,-6160.58 3307.5,-6160.58 3301.5,-6154.58 3301.5,-6148.58 3301.5,-6148.58 3301.5,-6104.58 3301.5,-6104.58 3301.5,-6098.58 3307.5,-6092.58 3313.5,-6092.58 3313.5,-6092.58 3782.5,-6092.58 3782.5,-6092.58 3788.5,-6092.58 3794.5,-6098.58 3794.5,-6104.58 3794.5,-6104.58 3794.5,-6148.58 3794.5,-6148.58 3794.5,-6154.58 3788.5,-6160.58 3782.5,-6160.58"/>
<text text-anchor="middle" x="3548" y="-6145.38" font-family="Times,serif" font-size="14.00">Expert 2 Layer 7 GPU 2</text>
<text text-anchor="middle" x="3548" y="-6130.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3548" y="-6115.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3548" y="-6100.38" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer7_gpu2 -->
<g id="node622" class="node">
<title>aggregate_layer7_gpu2</title>
<path fill="orange" stroke="black" d="M3517.29,-6056.58C3517.29,-6056.58 3030.19,-6056.58 3030.19,-6056.58 3024.19,-6056.58 3013.52,-6052.81 3008.85,-6049.05 3008.85,-6049.05 2896.06,-5958.11 2896.06,-5958.11 2891.38,-5954.35 2892.71,-5950.58 2898.71,-5950.58 2898.71,-5950.58 3385.81,-5950.58 3385.81,-5950.58 3391.81,-5950.58 3402.48,-5954.35 3407.15,-5958.11 3407.15,-5958.11 3519.94,-6049.05 3519.94,-6049.05 3524.62,-6052.81 3523.29,-6056.58 3517.29,-6056.58"/>
<text text-anchor="middle" x="3208" y="-6014.88" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 7 GPU 2</text>
<text text-anchor="middle" x="3208" y="-5999.88" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="3208" y="-5984.88" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer7_gpu2_expert2&#45;&gt;aggregate_layer7_gpu2 -->
<g id="edge755" class="edge">
<title>expert_layer7_gpu2_expert2&#45;&gt;aggregate_layer7_gpu2</title>
<path fill="none" stroke="black" d="M3455.09,-6092.52C3426.85,-6082.47 3395.01,-6071.13 3363.81,-6060.03"/>
<polygon fill="black" stroke="black" points="3364.74,-6056.65 3354.15,-6056.59 3362.4,-6063.24 3364.74,-6056.65"/>
</g>
<!-- expert_layer7_gpu3_expert3 -->
<g id="node604" class="node">
<title>expert_layer7_gpu3_expert3</title>
<path fill="lightcoral" stroke="black" d="M4818.5,-6160.58C4818.5,-6160.58 4349.5,-6160.58 4349.5,-6160.58 4343.5,-6160.58 4337.5,-6154.58 4337.5,-6148.58 4337.5,-6148.58 4337.5,-6104.58 4337.5,-6104.58 4337.5,-6098.58 4343.5,-6092.58 4349.5,-6092.58 4349.5,-6092.58 4818.5,-6092.58 4818.5,-6092.58 4824.5,-6092.58 4830.5,-6098.58 4830.5,-6104.58 4830.5,-6104.58 4830.5,-6148.58 4830.5,-6148.58 4830.5,-6154.58 4824.5,-6160.58 4818.5,-6160.58"/>
<text text-anchor="middle" x="4584" y="-6145.38" font-family="Times,serif" font-size="14.00">Expert 3 Layer 7 GPU 3</text>
<text text-anchor="middle" x="4584" y="-6130.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4584" y="-6115.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4584" y="-6100.38" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer7_gpu3 -->
<g id="node624" class="node">
<title>aggregate_layer7_gpu3</title>
<path fill="orange" stroke="black" d="M4317.29,-6056.58C4317.29,-6056.58 3830.19,-6056.58 3830.19,-6056.58 3824.19,-6056.58 3813.52,-6052.81 3808.85,-6049.05 3808.85,-6049.05 3696.06,-5958.11 3696.06,-5958.11 3691.38,-5954.35 3692.71,-5950.58 3698.71,-5950.58 3698.71,-5950.58 4185.81,-5950.58 4185.81,-5950.58 4191.81,-5950.58 4202.48,-5954.35 4207.15,-5958.11 4207.15,-5958.11 4319.94,-6049.05 4319.94,-6049.05 4324.62,-6052.81 4323.29,-6056.58 4317.29,-6056.58"/>
<text text-anchor="middle" x="4008" y="-6014.88" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 7 GPU 3</text>
<text text-anchor="middle" x="4008" y="-5999.88" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="4008" y="-5984.88" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer7_gpu3_expert3&#45;&gt;aggregate_layer7_gpu3 -->
<g id="edge756" class="edge">
<title>expert_layer7_gpu3_expert3&#45;&gt;aggregate_layer7_gpu3</title>
<path fill="none" stroke="black" d="M4426.61,-6092.52C4376.8,-6082.05 4320.38,-6070.2 4265.47,-6058.67"/>
<polygon fill="black" stroke="black" points="4266.1,-6055.22 4255.59,-6056.59 4264.66,-6062.07 4266.1,-6055.22"/>
</g>
<!-- expert_layer7_gpu4_expert4 -->
<g id="node605" class="node">
<title>expert_layer7_gpu4_expert4</title>
<path fill="lightcoral" stroke="black" d="M5990.5,-6160.58C5990.5,-6160.58 5521.5,-6160.58 5521.5,-6160.58 5515.5,-6160.58 5509.5,-6154.58 5509.5,-6148.58 5509.5,-6148.58 5509.5,-6104.58 5509.5,-6104.58 5509.5,-6098.58 5515.5,-6092.58 5521.5,-6092.58 5521.5,-6092.58 5990.5,-6092.58 5990.5,-6092.58 5996.5,-6092.58 6002.5,-6098.58 6002.5,-6104.58 6002.5,-6104.58 6002.5,-6148.58 6002.5,-6148.58 6002.5,-6154.58 5996.5,-6160.58 5990.5,-6160.58"/>
<text text-anchor="middle" x="5756" y="-6145.38" font-family="Times,serif" font-size="14.00">Expert 4 Layer 7 GPU 4</text>
<text text-anchor="middle" x="5756" y="-6130.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5756" y="-6115.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5756" y="-6100.38" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer7_gpu4 -->
<g id="node626" class="node">
<title>aggregate_layer7_gpu4</title>
<path fill="orange" stroke="black" d="M5659.29,-6056.58C5659.29,-6056.58 5172.19,-6056.58 5172.19,-6056.58 5166.19,-6056.58 5155.52,-6052.81 5150.85,-6049.05 5150.85,-6049.05 5038.06,-5958.11 5038.06,-5958.11 5033.38,-5954.35 5034.71,-5950.58 5040.71,-5950.58 5040.71,-5950.58 5527.81,-5950.58 5527.81,-5950.58 5533.81,-5950.58 5544.48,-5954.35 5549.15,-5958.11 5549.15,-5958.11 5661.94,-6049.05 5661.94,-6049.05 5666.62,-6052.81 5665.29,-6056.58 5659.29,-6056.58"/>
<text text-anchor="middle" x="5350" y="-6014.88" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 7 GPU 4</text>
<text text-anchor="middle" x="5350" y="-5999.88" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="5350" y="-5984.88" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer7_gpu4_expert4&#45;&gt;aggregate_layer7_gpu4 -->
<g id="edge757" class="edge">
<title>expert_layer7_gpu4_expert4&#45;&gt;aggregate_layer7_gpu4</title>
<path fill="none" stroke="black" d="M5645.06,-6092.52C5610.75,-6082.29 5572,-6070.74 5534.12,-6059.45"/>
<polygon fill="black" stroke="black" points="5535.1,-6056.09 5524.52,-6056.59 5533.1,-6062.8 5535.1,-6056.09"/>
</g>
<!-- expert_layer7_gpu5_expert5 -->
<g id="node606" class="node">
<title>expert_layer7_gpu5_expert5</title>
<path fill="lightcoral" stroke="black" d="M6746.5,-6160.58C6746.5,-6160.58 6277.5,-6160.58 6277.5,-6160.58 6271.5,-6160.58 6265.5,-6154.58 6265.5,-6148.58 6265.5,-6148.58 6265.5,-6104.58 6265.5,-6104.58 6265.5,-6098.58 6271.5,-6092.58 6277.5,-6092.58 6277.5,-6092.58 6746.5,-6092.58 6746.5,-6092.58 6752.5,-6092.58 6758.5,-6098.58 6758.5,-6104.58 6758.5,-6104.58 6758.5,-6148.58 6758.5,-6148.58 6758.5,-6154.58 6752.5,-6160.58 6746.5,-6160.58"/>
<text text-anchor="middle" x="6512" y="-6145.38" font-family="Times,serif" font-size="14.00">Expert 5 Layer 7 GPU 5</text>
<text text-anchor="middle" x="6512" y="-6130.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6512" y="-6115.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6512" y="-6100.38" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer7_gpu5 -->
<g id="node628" class="node">
<title>aggregate_layer7_gpu5</title>
<path fill="orange" stroke="black" d="M6661.29,-6056.58C6661.29,-6056.58 6174.19,-6056.58 6174.19,-6056.58 6168.19,-6056.58 6157.52,-6052.81 6152.85,-6049.05 6152.85,-6049.05 6040.06,-5958.11 6040.06,-5958.11 6035.38,-5954.35 6036.71,-5950.58 6042.71,-5950.58 6042.71,-5950.58 6529.81,-5950.58 6529.81,-5950.58 6535.81,-5950.58 6546.48,-5954.35 6551.15,-5958.11 6551.15,-5958.11 6663.94,-6049.05 6663.94,-6049.05 6668.62,-6052.81 6667.29,-6056.58 6661.29,-6056.58"/>
<text text-anchor="middle" x="6352" y="-6014.88" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 7 GPU 5</text>
<text text-anchor="middle" x="6352" y="-5999.88" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="6352" y="-5984.88" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer7_gpu5_expert5&#45;&gt;aggregate_layer7_gpu5 -->
<g id="edge758" class="edge">
<title>expert_layer7_gpu5_expert5&#45;&gt;aggregate_layer7_gpu5</title>
<path fill="none" stroke="black" d="M6468.28,-6092.52C6456.17,-6083.36 6442.66,-6073.14 6429.25,-6063"/>
<polygon fill="black" stroke="black" points="6431.02,-6059.95 6420.93,-6056.71 6426.79,-6065.53 6431.02,-6059.95"/>
</g>
<!-- expert_layer7_gpu6_expert6 -->
<g id="node607" class="node">
<title>expert_layer7_gpu6_expert6</title>
<path fill="lightcoral" stroke="black" d="M7534.5,-6160.58C7534.5,-6160.58 7065.5,-6160.58 7065.5,-6160.58 7059.5,-6160.58 7053.5,-6154.58 7053.5,-6148.58 7053.5,-6148.58 7053.5,-6104.58 7053.5,-6104.58 7053.5,-6098.58 7059.5,-6092.58 7065.5,-6092.58 7065.5,-6092.58 7534.5,-6092.58 7534.5,-6092.58 7540.5,-6092.58 7546.5,-6098.58 7546.5,-6104.58 7546.5,-6104.58 7546.5,-6148.58 7546.5,-6148.58 7546.5,-6154.58 7540.5,-6160.58 7534.5,-6160.58"/>
<text text-anchor="middle" x="7300" y="-6145.38" font-family="Times,serif" font-size="14.00">Expert 6 Layer 7 GPU 6</text>
<text text-anchor="middle" x="7300" y="-6130.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7300" y="-6115.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7300" y="-6100.38" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer7_gpu6 -->
<g id="node630" class="node">
<title>aggregate_layer7_gpu6</title>
<path fill="orange" stroke="black" d="M7492.29,-6056.58C7492.29,-6056.58 7005.19,-6056.58 7005.19,-6056.58 6999.19,-6056.58 6988.52,-6052.81 6983.85,-6049.05 6983.85,-6049.05 6871.06,-5958.11 6871.06,-5958.11 6866.38,-5954.35 6867.71,-5950.58 6873.71,-5950.58 6873.71,-5950.58 7360.81,-5950.58 7360.81,-5950.58 7366.81,-5950.58 7377.48,-5954.35 7382.15,-5958.11 7382.15,-5958.11 7494.94,-6049.05 7494.94,-6049.05 7499.62,-6052.81 7498.29,-6056.58 7492.29,-6056.58"/>
<text text-anchor="middle" x="7183" y="-6014.88" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 7 GPU 6</text>
<text text-anchor="middle" x="7183" y="-5999.88" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="7183" y="-5984.88" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer7_gpu6_expert6&#45;&gt;aggregate_layer7_gpu6 -->
<g id="edge759" class="edge">
<title>expert_layer7_gpu6_expert6&#45;&gt;aggregate_layer7_gpu6</title>
<path fill="none" stroke="black" d="M7268.03,-6092.52C7259.51,-6083.71 7250.04,-6073.91 7240.6,-6064.15"/>
<polygon fill="black" stroke="black" points="7242.87,-6061.46 7233.4,-6056.71 7237.84,-6066.33 7242.87,-6061.46"/>
</g>
<!-- expert_layer7_gpu7_expert7 -->
<g id="node608" class="node">
<title>expert_layer7_gpu7_expert7</title>
<path fill="lightcoral" stroke="black" d="M8219.5,-6160.58C8219.5,-6160.58 7750.5,-6160.58 7750.5,-6160.58 7744.5,-6160.58 7738.5,-6154.58 7738.5,-6148.58 7738.5,-6148.58 7738.5,-6104.58 7738.5,-6104.58 7738.5,-6098.58 7744.5,-6092.58 7750.5,-6092.58 7750.5,-6092.58 8219.5,-6092.58 8219.5,-6092.58 8225.5,-6092.58 8231.5,-6098.58 8231.5,-6104.58 8231.5,-6104.58 8231.5,-6148.58 8231.5,-6148.58 8231.5,-6154.58 8225.5,-6160.58 8219.5,-6160.58"/>
<text text-anchor="middle" x="7985" y="-6145.38" font-family="Times,serif" font-size="14.00">Expert 7 Layer 7 GPU 7</text>
<text text-anchor="middle" x="7985" y="-6130.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7985" y="-6115.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7985" y="-6100.38" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer7_gpu7 -->
<g id="node632" class="node">
<title>aggregate_layer7_gpu7</title>
<path fill="orange" stroke="black" d="M8238.29,-6056.58C8238.29,-6056.58 7751.19,-6056.58 7751.19,-6056.58 7745.19,-6056.58 7734.52,-6052.81 7729.85,-6049.05 7729.85,-6049.05 7617.06,-5958.11 7617.06,-5958.11 7612.38,-5954.35 7613.71,-5950.58 7619.71,-5950.58 7619.71,-5950.58 8106.81,-5950.58 8106.81,-5950.58 8112.81,-5950.58 8123.48,-5954.35 8128.15,-5958.11 8128.15,-5958.11 8240.94,-6049.05 8240.94,-6049.05 8245.62,-6052.81 8244.29,-6056.58 8238.29,-6056.58"/>
<text text-anchor="middle" x="7929" y="-6014.88" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 7 GPU 7</text>
<text text-anchor="middle" x="7929" y="-5999.88" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="7929" y="-5984.88" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer7_gpu7_expert7&#45;&gt;aggregate_layer7_gpu7 -->
<g id="edge760" class="edge">
<title>expert_layer7_gpu7_expert7&#45;&gt;aggregate_layer7_gpu7</title>
<path fill="none" stroke="black" d="M7969.7,-6092.52C7965.86,-6084.22 7961.62,-6075.06 7957.37,-6065.87"/>
<polygon fill="black" stroke="black" points="7960.5,-6064.31 7953.12,-6056.71 7954.15,-6067.25 7960.5,-6064.31"/>
</g>
<!-- expert_layer7_gpu8_expert8 -->
<g id="node609" class="node">
<title>expert_layer7_gpu8_expert8</title>
<path fill="lightcoral" stroke="black" d="M8843.5,-6160.58C8843.5,-6160.58 8374.5,-6160.58 8374.5,-6160.58 8368.5,-6160.58 8362.5,-6154.58 8362.5,-6148.58 8362.5,-6148.58 8362.5,-6104.58 8362.5,-6104.58 8362.5,-6098.58 8368.5,-6092.58 8374.5,-6092.58 8374.5,-6092.58 8843.5,-6092.58 8843.5,-6092.58 8849.5,-6092.58 8855.5,-6098.58 8855.5,-6104.58 8855.5,-6104.58 8855.5,-6148.58 8855.5,-6148.58 8855.5,-6154.58 8849.5,-6160.58 8843.5,-6160.58"/>
<text text-anchor="middle" x="8609" y="-6145.38" font-family="Times,serif" font-size="14.00">Expert 8 Layer 7 GPU 8</text>
<text text-anchor="middle" x="8609" y="-6130.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8609" y="-6115.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8609" y="-6100.38" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer7_gpu8 -->
<g id="node634" class="node">
<title>aggregate_layer7_gpu8</title>
<path fill="orange" stroke="black" d="M8975.29,-6056.58C8975.29,-6056.58 8488.19,-6056.58 8488.19,-6056.58 8482.19,-6056.58 8471.52,-6052.81 8466.85,-6049.05 8466.85,-6049.05 8354.06,-5958.11 8354.06,-5958.11 8349.38,-5954.35 8350.71,-5950.58 8356.71,-5950.58 8356.71,-5950.58 8843.81,-5950.58 8843.81,-5950.58 8849.81,-5950.58 8860.48,-5954.35 8865.15,-5958.11 8865.15,-5958.11 8977.94,-6049.05 8977.94,-6049.05 8982.62,-6052.81 8981.29,-6056.58 8975.29,-6056.58"/>
<text text-anchor="middle" x="8666" y="-6014.88" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 7 GPU 8</text>
<text text-anchor="middle" x="8666" y="-5999.88" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="8666" y="-5984.88" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer7_gpu8_expert8&#45;&gt;aggregate_layer7_gpu8 -->
<g id="edge761" class="edge">
<title>expert_layer7_gpu8_expert8&#45;&gt;aggregate_layer7_gpu8</title>
<path fill="none" stroke="black" d="M8624.58,-6092.52C8628.48,-6084.22 8632.8,-6075.06 8637.13,-6065.87"/>
<polygon fill="black" stroke="black" points="8640.35,-6067.24 8641.44,-6056.71 8634.02,-6064.26 8640.35,-6067.24"/>
</g>
<!-- expert_layer7_gpu9_expert9 -->
<g id="node610" class="node">
<title>expert_layer7_gpu9_expert9</title>
<path fill="lightcoral" stroke="black" d="M9580.5,-6160.58C9580.5,-6160.58 9111.5,-6160.58 9111.5,-6160.58 9105.5,-6160.58 9099.5,-6154.58 9099.5,-6148.58 9099.5,-6148.58 9099.5,-6104.58 9099.5,-6104.58 9099.5,-6098.58 9105.5,-6092.58 9111.5,-6092.58 9111.5,-6092.58 9580.5,-6092.58 9580.5,-6092.58 9586.5,-6092.58 9592.5,-6098.58 9592.5,-6104.58 9592.5,-6104.58 9592.5,-6148.58 9592.5,-6148.58 9592.5,-6154.58 9586.5,-6160.58 9580.5,-6160.58"/>
<text text-anchor="middle" x="9346" y="-6145.38" font-family="Times,serif" font-size="14.00">Expert 9 Layer 7 GPU 9</text>
<text text-anchor="middle" x="9346" y="-6130.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9346" y="-6115.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9346" y="-6100.38" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer7_gpu9 -->
<g id="node636" class="node">
<title>aggregate_layer7_gpu9</title>
<path fill="orange" stroke="black" d="M9825.29,-6056.58C9825.29,-6056.58 9338.19,-6056.58 9338.19,-6056.58 9332.19,-6056.58 9321.52,-6052.81 9316.85,-6049.05 9316.85,-6049.05 9204.06,-5958.11 9204.06,-5958.11 9199.38,-5954.35 9200.71,-5950.58 9206.71,-5950.58 9206.71,-5950.58 9693.81,-5950.58 9693.81,-5950.58 9699.81,-5950.58 9710.48,-5954.35 9715.15,-5958.11 9715.15,-5958.11 9827.94,-6049.05 9827.94,-6049.05 9832.62,-6052.81 9831.29,-6056.58 9825.29,-6056.58"/>
<text text-anchor="middle" x="9516" y="-6014.88" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 7 GPU 9</text>
<text text-anchor="middle" x="9516" y="-5999.88" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="9516" y="-5984.88" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer7_gpu9_expert9&#45;&gt;aggregate_layer7_gpu9 -->
<g id="edge762" class="edge">
<title>expert_layer7_gpu9_expert9&#45;&gt;aggregate_layer7_gpu9</title>
<path fill="none" stroke="black" d="M9392.45,-6092.52C9405.44,-6083.27 9419.94,-6072.95 9434.32,-6062.71"/>
<polygon fill="black" stroke="black" points="9436.65,-6065.36 9442.76,-6056.71 9432.59,-6059.65 9436.65,-6065.36"/>
</g>
<!-- expert_layer7_gpu10_expert10 -->
<g id="node611" class="node">
<title>expert_layer7_gpu10_expert10</title>
<path fill="lightcoral" stroke="black" d="M10380.5,-6160.58C10380.5,-6160.58 9911.5,-6160.58 9911.5,-6160.58 9905.5,-6160.58 9899.5,-6154.58 9899.5,-6148.58 9899.5,-6148.58 9899.5,-6104.58 9899.5,-6104.58 9899.5,-6098.58 9905.5,-6092.58 9911.5,-6092.58 9911.5,-6092.58 10380.5,-6092.58 10380.5,-6092.58 10386.5,-6092.58 10392.5,-6098.58 10392.5,-6104.58 10392.5,-6104.58 10392.5,-6148.58 10392.5,-6148.58 10392.5,-6154.58 10386.5,-6160.58 10380.5,-6160.58"/>
<text text-anchor="middle" x="10146" y="-6145.38" font-family="Times,serif" font-size="14.00">Expert 10 Layer 7 GPU 10</text>
<text text-anchor="middle" x="10146" y="-6130.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10146" y="-6115.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10146" y="-6100.38" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer7_gpu10 -->
<g id="node638" class="node">
<title>aggregate_layer7_gpu10</title>
<path fill="orange" stroke="black" d="M10689.29,-6056.58C10689.29,-6056.58 10202.19,-6056.58 10202.19,-6056.58 10196.19,-6056.58 10185.52,-6052.81 10180.85,-6049.05 10180.85,-6049.05 10068.06,-5958.11 10068.06,-5958.11 10063.38,-5954.35 10064.71,-5950.58 10070.71,-5950.58 10070.71,-5950.58 10557.81,-5950.58 10557.81,-5950.58 10563.81,-5950.58 10574.48,-5954.35 10579.15,-5958.11 10579.15,-5958.11 10691.94,-6049.05 10691.94,-6049.05 10696.62,-6052.81 10695.29,-6056.58 10689.29,-6056.58"/>
<text text-anchor="middle" x="10380" y="-6014.88" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 7 GPU 10</text>
<text text-anchor="middle" x="10380" y="-5999.88" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="10380" y="-5984.88" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer7_gpu10_expert10&#45;&gt;aggregate_layer7_gpu10 -->
<g id="edge763" class="edge">
<title>expert_layer7_gpu10_expert10&#45;&gt;aggregate_layer7_gpu10</title>
<path fill="none" stroke="black" d="M10209.94,-6092.52C10228.57,-6082.89 10249.47,-6072.08 10270.07,-6061.42"/>
<polygon fill="black" stroke="black" points="10271.92,-6064.41 10279.19,-6056.71 10268.7,-6058.19 10271.92,-6064.41"/>
</g>
<!-- expert_layer7_gpu11_expert11 -->
<g id="node612" class="node">
<title>expert_layer7_gpu11_expert11</title>
<path fill="lightcoral" stroke="black" d="M11162.5,-6160.58C11162.5,-6160.58 10693.5,-6160.58 10693.5,-6160.58 10687.5,-6160.58 10681.5,-6154.58 10681.5,-6148.58 10681.5,-6148.58 10681.5,-6104.58 10681.5,-6104.58 10681.5,-6098.58 10687.5,-6092.58 10693.5,-6092.58 10693.5,-6092.58 11162.5,-6092.58 11162.5,-6092.58 11168.5,-6092.58 11174.5,-6098.58 11174.5,-6104.58 11174.5,-6104.58 11174.5,-6148.58 11174.5,-6148.58 11174.5,-6154.58 11168.5,-6160.58 11162.5,-6160.58"/>
<text text-anchor="middle" x="10928" y="-6145.38" font-family="Times,serif" font-size="14.00">Expert 11 Layer 7 GPU 11</text>
<text text-anchor="middle" x="10928" y="-6130.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10928" y="-6115.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10928" y="-6100.38" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer7_gpu11 -->
<g id="node640" class="node">
<title>aggregate_layer7_gpu11</title>
<path fill="orange" stroke="black" d="M11452.29,-6056.58C11452.29,-6056.58 10965.19,-6056.58 10965.19,-6056.58 10959.19,-6056.58 10948.52,-6052.81 10943.85,-6049.05 10943.85,-6049.05 10831.06,-5958.11 10831.06,-5958.11 10826.38,-5954.35 10827.71,-5950.58 10833.71,-5950.58 10833.71,-5950.58 11320.81,-5950.58 11320.81,-5950.58 11326.81,-5950.58 11337.48,-5954.35 11342.15,-5958.11 11342.15,-5958.11 11454.94,-6049.05 11454.94,-6049.05 11459.62,-6052.81 11458.29,-6056.58 11452.29,-6056.58"/>
<text text-anchor="middle" x="11143" y="-6014.88" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 7 GPU 11</text>
<text text-anchor="middle" x="11143" y="-5999.88" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="11143" y="-5984.88" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer7_gpu11_expert11&#45;&gt;aggregate_layer7_gpu11 -->
<g id="edge764" class="edge">
<title>expert_layer7_gpu11_expert11&#45;&gt;aggregate_layer7_gpu11</title>
<path fill="none" stroke="black" d="M10986.75,-6092.52C11003.71,-6082.97 11022.72,-6072.27 11041.49,-6061.71"/>
<polygon fill="black" stroke="black" points="11043.38,-6064.66 11050.38,-6056.71 11039.95,-6058.56 11043.38,-6064.66"/>
</g>
<!-- expert_layer7_gpu12_expert12 -->
<g id="node613" class="node">
<title>expert_layer7_gpu12_expert12</title>
<path fill="lightcoral" stroke="black" d="M11909.5,-6160.58C11909.5,-6160.58 11440.5,-6160.58 11440.5,-6160.58 11434.5,-6160.58 11428.5,-6154.58 11428.5,-6148.58 11428.5,-6148.58 11428.5,-6104.58 11428.5,-6104.58 11428.5,-6098.58 11434.5,-6092.58 11440.5,-6092.58 11440.5,-6092.58 11909.5,-6092.58 11909.5,-6092.58 11915.5,-6092.58 11921.5,-6098.58 11921.5,-6104.58 11921.5,-6104.58 11921.5,-6148.58 11921.5,-6148.58 11921.5,-6154.58 11915.5,-6160.58 11909.5,-6160.58"/>
<text text-anchor="middle" x="11675" y="-6145.38" font-family="Times,serif" font-size="14.00">Expert 12 Layer 7 GPU 12</text>
<text text-anchor="middle" x="11675" y="-6130.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11675" y="-6115.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11675" y="-6100.38" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer7_gpu12 -->
<g id="node642" class="node">
<title>aggregate_layer7_gpu12</title>
<path fill="orange" stroke="black" d="M12164.29,-6056.58C12164.29,-6056.58 11677.19,-6056.58 11677.19,-6056.58 11671.19,-6056.58 11660.52,-6052.81 11655.85,-6049.05 11655.85,-6049.05 11543.06,-5958.11 11543.06,-5958.11 11538.38,-5954.35 11539.71,-5950.58 11545.71,-5950.58 11545.71,-5950.58 12032.81,-5950.58 12032.81,-5950.58 12038.81,-5950.58 12049.48,-5954.35 12054.15,-5958.11 12054.15,-5958.11 12166.94,-6049.05 12166.94,-6049.05 12171.62,-6052.81 12170.29,-6056.58 12164.29,-6056.58"/>
<text text-anchor="middle" x="11855" y="-6014.88" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 7 GPU 12</text>
<text text-anchor="middle" x="11855" y="-5999.88" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="11855" y="-5984.88" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer7_gpu12_expert12&#45;&gt;aggregate_layer7_gpu12 -->
<g id="edge765" class="edge">
<title>expert_layer7_gpu12_expert12&#45;&gt;aggregate_layer7_gpu12</title>
<path fill="none" stroke="black" d="M11724.19,-6092.52C11738.06,-6083.19 11753.58,-6072.76 11768.95,-6062.43"/>
<polygon fill="black" stroke="black" points="11771.11,-6065.19 11777.46,-6056.71 11767.2,-6059.38 11771.11,-6065.19"/>
</g>
<!-- expert_layer7_gpu13_expert13 -->
<g id="node614" class="node">
<title>expert_layer7_gpu13_expert13</title>
<path fill="lightcoral" stroke="black" d="M12853.5,-6160.58C12853.5,-6160.58 12384.5,-6160.58 12384.5,-6160.58 12378.5,-6160.58 12372.5,-6154.58 12372.5,-6148.58 12372.5,-6148.58 12372.5,-6104.58 12372.5,-6104.58 12372.5,-6098.58 12378.5,-6092.58 12384.5,-6092.58 12384.5,-6092.58 12853.5,-6092.58 12853.5,-6092.58 12859.5,-6092.58 12865.5,-6098.58 12865.5,-6104.58 12865.5,-6104.58 12865.5,-6148.58 12865.5,-6148.58 12865.5,-6154.58 12859.5,-6160.58 12853.5,-6160.58"/>
<text text-anchor="middle" x="12619" y="-6145.38" font-family="Times,serif" font-size="14.00">Expert 13 Layer 7 GPU 13</text>
<text text-anchor="middle" x="12619" y="-6130.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12619" y="-6115.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12619" y="-6100.38" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer7_gpu13 -->
<g id="node644" class="node">
<title>aggregate_layer7_gpu13</title>
<path fill="orange" stroke="black" d="M13305.29,-6056.58C13305.29,-6056.58 12818.19,-6056.58 12818.19,-6056.58 12812.19,-6056.58 12801.52,-6052.81 12796.85,-6049.05 12796.85,-6049.05 12684.06,-5958.11 12684.06,-5958.11 12679.38,-5954.35 12680.71,-5950.58 12686.71,-5950.58 12686.71,-5950.58 13173.81,-5950.58 13173.81,-5950.58 13179.81,-5950.58 13190.48,-5954.35 13195.15,-5958.11 13195.15,-5958.11 13307.94,-6049.05 13307.94,-6049.05 13312.62,-6052.81 13311.29,-6056.58 13305.29,-6056.58"/>
<text text-anchor="middle" x="12996" y="-6014.88" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 7 GPU 13</text>
<text text-anchor="middle" x="12996" y="-5999.88" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="12996" y="-5984.88" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer7_gpu13_expert13&#45;&gt;aggregate_layer7_gpu13 -->
<g id="edge766" class="edge">
<title>expert_layer7_gpu13_expert13&#45;&gt;aggregate_layer7_gpu13</title>
<path fill="none" stroke="black" d="M12722.02,-6092.52C12753.6,-6082.38 12789.25,-6070.94 12824.13,-6059.74"/>
<polygon fill="black" stroke="black" points="12825.5,-6062.98 12833.95,-6056.59 12823.36,-6056.32 12825.5,-6062.98"/>
</g>
<!-- expert_layer7_gpu14_expert14 -->
<g id="node615" class="node">
<title>expert_layer7_gpu14_expert14</title>
<path fill="lightcoral" stroke="black" d="M13775.5,-6160.58C13775.5,-6160.58 13306.5,-6160.58 13306.5,-6160.58 13300.5,-6160.58 13294.5,-6154.58 13294.5,-6148.58 13294.5,-6148.58 13294.5,-6104.58 13294.5,-6104.58 13294.5,-6098.58 13300.5,-6092.58 13306.5,-6092.58 13306.5,-6092.58 13775.5,-6092.58 13775.5,-6092.58 13781.5,-6092.58 13787.5,-6098.58 13787.5,-6104.58 13787.5,-6104.58 13787.5,-6148.58 13787.5,-6148.58 13787.5,-6154.58 13781.5,-6160.58 13775.5,-6160.58"/>
<text text-anchor="middle" x="13541" y="-6145.38" font-family="Times,serif" font-size="14.00">Expert 14 Layer 7 GPU 14</text>
<text text-anchor="middle" x="13541" y="-6130.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="13541" y="-6115.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="13541" y="-6100.38" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer7_gpu14 -->
<g id="node646" class="node">
<title>aggregate_layer7_gpu14</title>
<path fill="orange" stroke="black" d="M14206.29,-6056.58C14206.29,-6056.58 13719.19,-6056.58 13719.19,-6056.58 13713.19,-6056.58 13702.52,-6052.81 13697.85,-6049.05 13697.85,-6049.05 13585.06,-5958.11 13585.06,-5958.11 13580.38,-5954.35 13581.71,-5950.58 13587.71,-5950.58 13587.71,-5950.58 14074.81,-5950.58 14074.81,-5950.58 14080.81,-5950.58 14091.48,-5954.35 14096.15,-5958.11 14096.15,-5958.11 14208.94,-6049.05 14208.94,-6049.05 14213.62,-6052.81 14212.29,-6056.58 14206.29,-6056.58"/>
<text text-anchor="middle" x="13897" y="-6014.88" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 7 GPU 14</text>
<text text-anchor="middle" x="13897" y="-5999.88" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="13897" y="-5984.88" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer7_gpu14_expert14&#45;&gt;aggregate_layer7_gpu14 -->
<g id="edge767" class="edge">
<title>expert_layer7_gpu14_expert14&#45;&gt;aggregate_layer7_gpu14</title>
<path fill="none" stroke="black" d="M13638.28,-6092.52C13667.98,-6082.42 13701.48,-6071.03 13734.28,-6059.88"/>
<polygon fill="black" stroke="black" points="13735.63,-6063.12 13743.97,-6056.59 13733.38,-6056.5 13735.63,-6063.12"/>
</g>
<!-- expert_layer7_gpu15_expert15 -->
<g id="node616" class="node">
<title>expert_layer7_gpu15_expert15</title>
<path fill="lightcoral" stroke="black" d="M14627.5,-6160.58C14627.5,-6160.58 14158.5,-6160.58 14158.5,-6160.58 14152.5,-6160.58 14146.5,-6154.58 14146.5,-6148.58 14146.5,-6148.58 14146.5,-6104.58 14146.5,-6104.58 14146.5,-6098.58 14152.5,-6092.58 14158.5,-6092.58 14158.5,-6092.58 14627.5,-6092.58 14627.5,-6092.58 14633.5,-6092.58 14639.5,-6098.58 14639.5,-6104.58 14639.5,-6104.58 14639.5,-6148.58 14639.5,-6148.58 14639.5,-6154.58 14633.5,-6160.58 14627.5,-6160.58"/>
<text text-anchor="middle" x="14393" y="-6145.38" font-family="Times,serif" font-size="14.00">Expert 15 Layer 7 GPU 15</text>
<text text-anchor="middle" x="14393" y="-6130.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14393" y="-6115.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14393" y="-6100.38" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer7_gpu15 -->
<g id="node648" class="node">
<title>aggregate_layer7_gpu15</title>
<path fill="orange" stroke="black" d="M14987.29,-6056.58C14987.29,-6056.58 14500.19,-6056.58 14500.19,-6056.58 14494.19,-6056.58 14483.52,-6052.81 14478.85,-6049.05 14478.85,-6049.05 14366.06,-5958.11 14366.06,-5958.11 14361.38,-5954.35 14362.71,-5950.58 14368.71,-5950.58 14368.71,-5950.58 14855.81,-5950.58 14855.81,-5950.58 14861.81,-5950.58 14872.48,-5954.35 14877.15,-5958.11 14877.15,-5958.11 14989.94,-6049.05 14989.94,-6049.05 14994.62,-6052.81 14993.29,-6056.58 14987.29,-6056.58"/>
<text text-anchor="middle" x="14678" y="-6014.88" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 7 GPU 15</text>
<text text-anchor="middle" x="14678" y="-5999.88" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="14678" y="-5984.88" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer7_gpu15_expert15&#45;&gt;aggregate_layer7_gpu15 -->
<g id="edge768" class="edge">
<title>expert_layer7_gpu15_expert15&#45;&gt;aggregate_layer7_gpu15</title>
<path fill="none" stroke="black" d="M14470.88,-6092.52C14494.14,-6082.64 14520.32,-6071.52 14546.04,-6060.6"/>
<polygon fill="black" stroke="black" points="14547.66,-6063.72 14555.49,-6056.59 14544.92,-6057.28 14547.66,-6063.72"/>
</g>
<!-- comm_layer7 -->
<g id="node649" class="node">
<title>comm_layer7</title>
<ellipse fill="lightpink" stroke="black" cx="8297" cy="-6234.06" rx="243.49" ry="37.45"/>
<text text-anchor="middle" x="8297" y="-6245.36" font-family="Times,serif" font-size="14.00">Cross&#45;GPU Communication Layer 7</text>
<text text-anchor="middle" x="8297" y="-6230.36" font-family="Times,serif" font-size="14.00">Input: Tokens from routing decisions</text>
<text text-anchor="middle" x="8297" y="-6215.36" font-family="Times,serif" font-size="14.00">Output: Tokens delivered to destination GPUs</text>
</g>
<!-- route_layer7_gpu0&#45;&gt;comm_layer7 -->
<g id="edge721" class="edge">
<title>route_layer7_gpu0&#45;&gt;comm_layer7</title>
<path fill="none" stroke="black" d="M1470.85,-6347.6C1734.4,-6335.49 2161.83,-6317.18 2531,-6307.53 4662.27,-6251.85 7237.83,-6238.65 8043.6,-6235.79"/>
<polygon fill="black" stroke="black" points="8043.88,-6239.29 8053.87,-6235.76 8043.86,-6232.29 8043.88,-6239.29"/>
</g>
<!-- mha_layer8_gpu0 -->
<g id="node650" class="node">
<title>mha_layer8_gpu0</title>
<path fill="lightblue" stroke="black" d="M1532,-5914.58C1532,-5914.58 1084,-5914.58 1084,-5914.58 1078,-5914.58 1072,-5908.58 1072,-5902.58 1072,-5902.58 1072,-5873.58 1072,-5873.58 1072,-5867.58 1078,-5861.58 1084,-5861.58 1084,-5861.58 1532,-5861.58 1532,-5861.58 1538,-5861.58 1544,-5867.58 1544,-5873.58 1544,-5873.58 1544,-5902.58 1544,-5902.58 1544,-5908.58 1538,-5914.58 1532,-5914.58"/>
<text text-anchor="middle" x="1308" y="-5899.38" font-family="Times,serif" font-size="14.00">MHA Layer 8 GPU 0</text>
<text text-anchor="middle" x="1308" y="-5884.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1308" y="-5869.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer7_gpu0&#45;&gt;mha_layer8_gpu0 -->
<g id="edge769" class="edge">
<title>aggregate_layer7_gpu0&#45;&gt;mha_layer8_gpu0</title>
<path fill="none" stroke="black" d="M1432.42,-5950.48C1410.61,-5939.71 1388.34,-5928.72 1368.78,-5919.07"/>
<polygon fill="black" stroke="black" points="1370.22,-5915.88 1359.7,-5914.59 1367.12,-5922.16 1370.22,-5915.88"/>
</g>
<!-- route_layer7_gpu1&#45;&gt;comm_layer7 -->
<g id="edge722" class="edge">
<title>route_layer7_gpu1&#45;&gt;comm_layer7</title>
<path fill="none" stroke="black" d="M3116.85,-6341.32C3281.66,-6329.65 3504.88,-6315.28 3702,-6307.53 5356.85,-6242.49 7349.1,-6235.28 8043.59,-6234.87"/>
<polygon fill="black" stroke="black" points="8043.73,-6238.37 8053.72,-6234.87 8043.72,-6231.37 8043.73,-6238.37"/>
</g>
<!-- mha_layer8_gpu1 -->
<g id="node651" class="node">
<title>mha_layer8_gpu1</title>
<path fill="lightblue" stroke="black" d="M2504,-5914.58C2504,-5914.58 2056,-5914.58 2056,-5914.58 2050,-5914.58 2044,-5908.58 2044,-5902.58 2044,-5902.58 2044,-5873.58 2044,-5873.58 2044,-5867.58 2050,-5861.58 2056,-5861.58 2056,-5861.58 2504,-5861.58 2504,-5861.58 2510,-5861.58 2516,-5867.58 2516,-5873.58 2516,-5873.58 2516,-5902.58 2516,-5902.58 2516,-5908.58 2510,-5914.58 2504,-5914.58"/>
<text text-anchor="middle" x="2280" y="-5899.38" font-family="Times,serif" font-size="14.00">MHA Layer 8 GPU 1</text>
<text text-anchor="middle" x="2280" y="-5884.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2280" y="-5869.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer7_gpu1&#45;&gt;mha_layer8_gpu1 -->
<g id="edge770" class="edge">
<title>aggregate_layer7_gpu1&#45;&gt;mha_layer8_gpu1</title>
<path fill="none" stroke="black" d="M2361.69,-5950.48C2348.21,-5940.35 2334.46,-5930.02 2322.19,-5920.79"/>
<polygon fill="black" stroke="black" points="2324.04,-5917.8 2313.94,-5914.59 2319.83,-5923.4 2324.04,-5917.8"/>
</g>
<!-- route_layer7_gpu2&#45;&gt;comm_layer7 -->
<g id="edge723" class="edge">
<title>route_layer7_gpu2&#45;&gt;comm_layer7</title>
<path fill="none" stroke="black" d="M4279.52,-6335.06C4386.51,-6324.81 4515.06,-6313.82 4631,-6307.53 5297.03,-6271.39 7329.22,-6245.85 8044.6,-6237.78"/>
<polygon fill="black" stroke="black" points="8044.82,-6241.28 8054.78,-6237.66 8044.74,-6234.28 8044.82,-6241.28"/>
</g>
<!-- mha_layer8_gpu2 -->
<g id="node652" class="node">
<title>mha_layer8_gpu2</title>
<path fill="lightblue" stroke="black" d="M3271,-5914.58C3271,-5914.58 2823,-5914.58 2823,-5914.58 2817,-5914.58 2811,-5908.58 2811,-5902.58 2811,-5902.58 2811,-5873.58 2811,-5873.58 2811,-5867.58 2817,-5861.58 2823,-5861.58 2823,-5861.58 3271,-5861.58 3271,-5861.58 3277,-5861.58 3283,-5867.58 3283,-5873.58 3283,-5873.58 3283,-5902.58 3283,-5902.58 3283,-5908.58 3277,-5914.58 3271,-5914.58"/>
<text text-anchor="middle" x="3047" y="-5899.38" font-family="Times,serif" font-size="14.00">MHA Layer 8 GPU 2</text>
<text text-anchor="middle" x="3047" y="-5884.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3047" y="-5869.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer7_gpu2&#45;&gt;mha_layer8_gpu2 -->
<g id="edge771" class="edge">
<title>aggregate_layer7_gpu2&#45;&gt;mha_layer8_gpu2</title>
<path fill="none" stroke="black" d="M3134.1,-5950.48C3119.59,-5940.25 3104.79,-5929.82 3091.6,-5920.52"/>
<polygon fill="black" stroke="black" points="3093.38,-5917.49 3083.19,-5914.59 3089.35,-5923.22 3093.38,-5917.49"/>
</g>
<!-- route_layer7_gpu3&#45;&gt;comm_layer7 -->
<g id="edge724" class="edge">
<title>route_layer7_gpu3&#45;&gt;comm_layer7</title>
<path fill="none" stroke="black" d="M5202.29,-6330.16C5277.8,-6321.46 5362.4,-6312.85 5440,-6307.53 6399.59,-6241.83 7544.14,-6234.07 8043.29,-6234.18"/>
<polygon fill="black" stroke="black" points="8043.5,-6237.68 8053.5,-6234.18 8043.5,-6230.68 8043.5,-6237.68"/>
</g>
<!-- mha_layer8_gpu3 -->
<g id="node653" class="node">
<title>mha_layer8_gpu3</title>
<path fill="lightblue" stroke="black" d="M4164,-5914.58C4164,-5914.58 3716,-5914.58 3716,-5914.58 3710,-5914.58 3704,-5908.58 3704,-5902.58 3704,-5902.58 3704,-5873.58 3704,-5873.58 3704,-5867.58 3710,-5861.58 3716,-5861.58 3716,-5861.58 4164,-5861.58 4164,-5861.58 4170,-5861.58 4176,-5867.58 4176,-5873.58 4176,-5873.58 4176,-5902.58 4176,-5902.58 4176,-5908.58 4170,-5914.58 4164,-5914.58"/>
<text text-anchor="middle" x="3940" y="-5899.38" font-family="Times,serif" font-size="14.00">MHA Layer 8 GPU 3</text>
<text text-anchor="middle" x="3940" y="-5884.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3940" y="-5869.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer7_gpu3&#45;&gt;mha_layer8_gpu3 -->
<g id="edge772" class="edge">
<title>aggregate_layer7_gpu3&#45;&gt;mha_layer8_gpu3</title>
<path fill="none" stroke="black" d="M3976.79,-5950.48C3971.24,-5941.22 3965.6,-5931.8 3960.45,-5923.21"/>
<polygon fill="black" stroke="black" points="3963.43,-5921.37 3955.29,-5914.59 3957.42,-5924.97 3963.43,-5921.37"/>
</g>
<!-- route_layer7_gpu4&#45;&gt;comm_layer7 -->
<g id="edge725" class="edge">
<title>route_layer7_gpu4&#45;&gt;comm_layer7</title>
<path fill="none" stroke="black" d="M6007.19,-6327.01C6065.89,-6319.5 6129.23,-6312.31 6188,-6307.53 6856.41,-6253.15 7647.21,-6239.48 8043.65,-6236.11"/>
<polygon fill="black" stroke="black" points="8043.84,-6239.61 8053.81,-6236.03 8043.78,-6232.61 8043.84,-6239.61"/>
</g>
<!-- mha_layer8_gpu4 -->
<g id="node654" class="node">
<title>mha_layer8_gpu4</title>
<path fill="lightblue" stroke="black" d="M5317,-5914.58C5317,-5914.58 4869,-5914.58 4869,-5914.58 4863,-5914.58 4857,-5908.58 4857,-5902.58 4857,-5902.58 4857,-5873.58 4857,-5873.58 4857,-5867.58 4863,-5861.58 4869,-5861.58 4869,-5861.58 5317,-5861.58 5317,-5861.58 5323,-5861.58 5329,-5867.58 5329,-5873.58 5329,-5873.58 5329,-5902.58 5329,-5902.58 5329,-5908.58 5323,-5914.58 5317,-5914.58"/>
<text text-anchor="middle" x="5093" y="-5899.38" font-family="Times,serif" font-size="14.00">MHA Layer 8 GPU 4</text>
<text text-anchor="middle" x="5093" y="-5884.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5093" y="-5869.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer7_gpu4&#45;&gt;mha_layer8_gpu4 -->
<g id="edge773" class="edge">
<title>aggregate_layer7_gpu4&#45;&gt;mha_layer8_gpu4</title>
<path fill="none" stroke="black" d="M5232.03,-5950.48C5207.32,-5939.57 5182.09,-5928.43 5160.02,-5918.68"/>
<polygon fill="black" stroke="black" points="5161.33,-5915.43 5150.77,-5914.59 5158.5,-5921.84 5161.33,-5915.43"/>
</g>
<!-- route_layer7_gpu5&#45;&gt;comm_layer7 -->
<g id="edge726" class="edge">
<title>route_layer7_gpu5&#45;&gt;comm_layer7</title>
<path fill="none" stroke="black" d="M6753.12,-6325.58C6803.29,-6318.77 6856.4,-6312.26 6906,-6307.53 7304.45,-6269.52 7769.14,-6250.37 8047.85,-6241.57"/>
<polygon fill="black" stroke="black" points="8048.21,-6245.06 8058.1,-6241.25 8047.99,-6238.07 8048.21,-6245.06"/>
</g>
<!-- mha_layer8_gpu5 -->
<g id="node655" class="node">
<title>mha_layer8_gpu5</title>
<path fill="lightblue" stroke="black" d="M6273,-5914.58C6273,-5914.58 5825,-5914.58 5825,-5914.58 5819,-5914.58 5813,-5908.58 5813,-5902.58 5813,-5902.58 5813,-5873.58 5813,-5873.58 5813,-5867.58 5819,-5861.58 5825,-5861.58 5825,-5861.58 6273,-5861.58 6273,-5861.58 6279,-5861.58 6285,-5867.58 6285,-5873.58 6285,-5873.58 6285,-5902.58 6285,-5902.58 6285,-5908.58 6279,-5914.58 6273,-5914.58"/>
<text text-anchor="middle" x="6049" y="-5899.38" font-family="Times,serif" font-size="14.00">MHA Layer 8 GPU 5</text>
<text text-anchor="middle" x="6049" y="-5884.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6049" y="-5869.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer7_gpu5&#45;&gt;mha_layer8_gpu5 -->
<g id="edge774" class="edge">
<title>aggregate_layer7_gpu5&#45;&gt;mha_layer8_gpu5</title>
<path fill="none" stroke="black" d="M6212.92,-5950.48C6183.26,-5939.37 6152.97,-5928.03 6126.63,-5918.16"/>
<polygon fill="black" stroke="black" points="6127.7,-5914.82 6117.11,-5914.59 6125.25,-5921.38 6127.7,-5914.82"/>
</g>
<!-- route_layer7_gpu6&#45;&gt;comm_layer7 -->
<g id="edge727" class="edge">
<title>route_layer7_gpu6&#45;&gt;comm_layer7</title>
<path fill="none" stroke="black" d="M7471.96,-6326.01C7517.26,-6319.55 7564.63,-6313.08 7609,-6307.53 7767.41,-6287.72 7946.81,-6268.95 8082.68,-6255.47"/>
<polygon fill="black" stroke="black" points="8083.2,-6258.94 8092.8,-6254.47 8082.51,-6251.97 8083.2,-6258.94"/>
</g>
<!-- mha_layer8_gpu6 -->
<g id="node656" class="node">
<title>mha_layer8_gpu6</title>
<path fill="lightblue" stroke="black" d="M7256,-5914.58C7256,-5914.58 6808,-5914.58 6808,-5914.58 6802,-5914.58 6796,-5908.58 6796,-5902.58 6796,-5902.58 6796,-5873.58 6796,-5873.58 6796,-5867.58 6802,-5861.58 6808,-5861.58 6808,-5861.58 7256,-5861.58 7256,-5861.58 7262,-5861.58 7268,-5867.58 7268,-5873.58 7268,-5873.58 7268,-5902.58 7268,-5902.58 7268,-5908.58 7262,-5914.58 7256,-5914.58"/>
<text text-anchor="middle" x="7032" y="-5899.38" font-family="Times,serif" font-size="14.00">MHA Layer 8 GPU 6</text>
<text text-anchor="middle" x="7032" y="-5884.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7032" y="-5869.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer7_gpu6&#45;&gt;mha_layer8_gpu6 -->
<g id="edge775" class="edge">
<title>aggregate_layer7_gpu6&#45;&gt;mha_layer8_gpu6</title>
<path fill="none" stroke="black" d="M7113.69,-5950.48C7100.21,-5940.35 7086.46,-5930.02 7074.19,-5920.79"/>
<polygon fill="black" stroke="black" points="7076.04,-5917.8 7065.94,-5914.59 7071.83,-5923.4 7076.04,-5917.8"/>
</g>
<!-- route_layer7_gpu7&#45;&gt;comm_layer7 -->
<g id="edge728" class="edge">
<title>route_layer7_gpu7&#45;&gt;comm_layer7</title>
<path fill="none" stroke="black" d="M8096.89,-6307.47C8129.54,-6295.65 8163.57,-6283.34 8194.12,-6272.28"/>
<polygon fill="black" stroke="black" points="8195.69,-6275.44 8203.91,-6268.74 8193.31,-6268.85 8195.69,-6275.44"/>
</g>
<!-- mha_layer8_gpu7 -->
<g id="node657" class="node">
<title>mha_layer8_gpu7</title>
<path fill="lightblue" stroke="black" d="M8002,-5914.58C8002,-5914.58 7554,-5914.58 7554,-5914.58 7548,-5914.58 7542,-5908.58 7542,-5902.58 7542,-5902.58 7542,-5873.58 7542,-5873.58 7542,-5867.58 7548,-5861.58 7554,-5861.58 7554,-5861.58 8002,-5861.58 8002,-5861.58 8008,-5861.58 8014,-5867.58 8014,-5873.58 8014,-5873.58 8014,-5902.58 8014,-5902.58 8014,-5908.58 8008,-5914.58 8002,-5914.58"/>
<text text-anchor="middle" x="7778" y="-5899.38" font-family="Times,serif" font-size="14.00">MHA Layer 8 GPU 7</text>
<text text-anchor="middle" x="7778" y="-5884.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7778" y="-5869.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer7_gpu7&#45;&gt;mha_layer8_gpu7 -->
<g id="edge776" class="edge">
<title>aggregate_layer7_gpu7&#45;&gt;mha_layer8_gpu7</title>
<path fill="none" stroke="black" d="M7859.69,-5950.48C7846.21,-5940.35 7832.46,-5930.02 7820.19,-5920.79"/>
<polygon fill="black" stroke="black" points="7822.04,-5917.8 7811.94,-5914.59 7817.83,-5923.4 7822.04,-5917.8"/>
</g>
<!-- route_layer7_gpu8&#45;&gt;comm_layer7 -->
<g id="edge729" class="edge">
<title>route_layer7_gpu8&#45;&gt;comm_layer7</title>
<path fill="none" stroke="black" d="M8577.38,-6307.47C8527.27,-6294.52 8474.83,-6280.98 8429.03,-6269.15"/>
<polygon fill="black" stroke="black" points="8429.62,-6265.69 8419.06,-6266.58 8427.87,-6272.47 8429.62,-6265.69"/>
</g>
<!-- mha_layer8_gpu8 -->
<g id="node658" class="node">
<title>mha_layer8_gpu8</title>
<path fill="lightblue" stroke="black" d="M8915,-5914.58C8915,-5914.58 8467,-5914.58 8467,-5914.58 8461,-5914.58 8455,-5908.58 8455,-5902.58 8455,-5902.58 8455,-5873.58 8455,-5873.58 8455,-5867.58 8461,-5861.58 8467,-5861.58 8467,-5861.58 8915,-5861.58 8915,-5861.58 8921,-5861.58 8927,-5867.58 8927,-5873.58 8927,-5873.58 8927,-5902.58 8927,-5902.58 8927,-5908.58 8921,-5914.58 8915,-5914.58"/>
<text text-anchor="middle" x="8691" y="-5899.38" font-family="Times,serif" font-size="14.00">MHA Layer 8 GPU 8</text>
<text text-anchor="middle" x="8691" y="-5884.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8691" y="-5869.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer7_gpu8&#45;&gt;mha_layer8_gpu8 -->
<g id="edge777" class="edge">
<title>aggregate_layer7_gpu8&#45;&gt;mha_layer8_gpu8</title>
<path fill="none" stroke="black" d="M8677.48,-5950.48C8679.41,-5941.71 8681.37,-5932.79 8683.18,-5924.57"/>
<polygon fill="black" stroke="black" points="8686.65,-5925.11 8685.38,-5914.59 8679.81,-5923.61 8686.65,-5925.11"/>
</g>
<!-- route_layer7_gpu9&#45;&gt;comm_layer7 -->
<g id="edge730" class="edge">
<title>route_layer7_gpu9&#45;&gt;comm_layer7</title>
<path fill="none" stroke="black" d="M9368.73,-6330.36C9288.78,-6322.82 9202.66,-6314.79 9123,-6307.53 8917.63,-6288.83 8683.46,-6268.37 8517.03,-6253.97"/>
<polygon fill="black" stroke="black" points="8516.93,-6250.45 8506.67,-6253.07 8516.33,-6257.42 8516.93,-6250.45"/>
</g>
<!-- mha_layer8_gpu9 -->
<g id="node659" class="node">
<title>mha_layer8_gpu9</title>
<path fill="lightblue" stroke="black" d="M9822,-5914.58C9822,-5914.58 9374,-5914.58 9374,-5914.58 9368,-5914.58 9362,-5908.58 9362,-5902.58 9362,-5902.58 9362,-5873.58 9362,-5873.58 9362,-5867.58 9368,-5861.58 9374,-5861.58 9374,-5861.58 9822,-5861.58 9822,-5861.58 9828,-5861.58 9834,-5867.58 9834,-5873.58 9834,-5873.58 9834,-5902.58 9834,-5902.58 9834,-5908.58 9828,-5914.58 9822,-5914.58"/>
<text text-anchor="middle" x="9598" y="-5899.38" font-family="Times,serif" font-size="14.00">MHA Layer 8 GPU 9</text>
<text text-anchor="middle" x="9598" y="-5884.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9598" y="-5869.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer7_gpu9&#45;&gt;mha_layer8_gpu9 -->
<g id="edge778" class="edge">
<title>aggregate_layer7_gpu9&#45;&gt;mha_layer8_gpu9</title>
<path fill="none" stroke="black" d="M9553.64,-5950.48C9560.4,-5941.13 9567.28,-5931.6 9573.54,-5922.94"/>
<polygon fill="black" stroke="black" points="9576.55,-5924.75 9579.57,-5914.59 9570.87,-5920.65 9576.55,-5924.75"/>
</g>
<!-- route_layer7_gpu10&#45;&gt;comm_layer7 -->
<g id="edge731" class="edge">
<title>route_layer7_gpu10&#45;&gt;comm_layer7</title>
<path fill="none" stroke="black" d="M10296.56,-6329.59C10206.85,-6321.55 10108.55,-6313.46 10018,-6307.53 9494.68,-6273.27 8880.71,-6251.94 8545.88,-6241.9"/>
<polygon fill="black" stroke="black" points="8545.67,-6238.39 8535.57,-6241.59 8545.46,-6245.39 8545.67,-6238.39"/>
</g>
<!-- mha_layer8_gpu10 -->
<g id="node660" class="node">
<title>mha_layer8_gpu10</title>
<path fill="lightblue" stroke="black" d="M10856,-5914.58C10856,-5914.58 10408,-5914.58 10408,-5914.58 10402,-5914.58 10396,-5908.58 10396,-5902.58 10396,-5902.58 10396,-5873.58 10396,-5873.58 10396,-5867.58 10402,-5861.58 10408,-5861.58 10408,-5861.58 10856,-5861.58 10856,-5861.58 10862,-5861.58 10868,-5867.58 10868,-5873.58 10868,-5873.58 10868,-5902.58 10868,-5902.58 10868,-5908.58 10862,-5914.58 10856,-5914.58"/>
<text text-anchor="middle" x="10632" y="-5899.38" font-family="Times,serif" font-size="14.00">MHA Layer 8 GPU 10</text>
<text text-anchor="middle" x="10632" y="-5884.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10632" y="-5869.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer7_gpu10&#45;&gt;mha_layer8_gpu10 -->
<g id="edge779" class="edge">
<title>aggregate_layer7_gpu10&#45;&gt;mha_layer8_gpu10</title>
<path fill="none" stroke="black" d="M10495.67,-5950.48C10519.79,-5939.62 10544.42,-5928.52 10565.99,-5918.81"/>
<polygon fill="black" stroke="black" points="10567.67,-5921.89 10575.35,-5914.59 10564.8,-5915.51 10567.67,-5921.89"/>
</g>
<!-- route_layer7_gpu11&#45;&gt;comm_layer7 -->
<g id="edge732" class="edge">
<title>route_layer7_gpu11&#45;&gt;comm_layer7</title>
<path fill="none" stroke="black" d="M11243.49,-6329.6C11148.54,-6321.27 11043.51,-6313.01 10947,-6307.53 10067.29,-6257.62 9021.29,-6241.83 8549.71,-6237.04"/>
<polygon fill="black" stroke="black" points="8549.75,-6233.54 8539.71,-6236.93 8549.68,-6240.54 8549.75,-6233.54"/>
</g>
<!-- mha_layer8_gpu11 -->
<g id="node661" class="node">
<title>mha_layer8_gpu11</title>
<path fill="lightblue" stroke="black" d="M11517,-5914.58C11517,-5914.58 11069,-5914.58 11069,-5914.58 11063,-5914.58 11057,-5908.58 11057,-5902.58 11057,-5902.58 11057,-5873.58 11057,-5873.58 11057,-5867.58 11063,-5861.58 11069,-5861.58 11069,-5861.58 11517,-5861.58 11517,-5861.58 11523,-5861.58 11529,-5867.58 11529,-5873.58 11529,-5873.58 11529,-5902.58 11529,-5902.58 11529,-5908.58 11523,-5914.58 11517,-5914.58"/>
<text text-anchor="middle" x="11293" y="-5899.38" font-family="Times,serif" font-size="14.00">MHA Layer 8 GPU 11</text>
<text text-anchor="middle" x="11293" y="-5884.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11293" y="-5869.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer7_gpu11&#45;&gt;mha_layer8_gpu11 -->
<g id="edge780" class="edge">
<title>aggregate_layer7_gpu11&#45;&gt;mha_layer8_gpu11</title>
<path fill="none" stroke="black" d="M11211.85,-5950.48C11225.25,-5940.35 11238.9,-5930.02 11251.09,-5920.79"/>
<polygon fill="black" stroke="black" points="11253.42,-5923.42 11259.28,-5914.59 11249.2,-5917.84 11253.42,-5923.42"/>
</g>
<!-- route_layer7_gpu12&#45;&gt;comm_layer7 -->
<g id="edge733" class="edge">
<title>route_layer7_gpu12&#45;&gt;comm_layer7</title>
<path fill="none" stroke="black" d="M12198.35,-6329.52C12101.12,-6321.06 11993.14,-6312.75 11894,-6307.53 10640.64,-6241.64 9138.73,-6234.54 8550.66,-6234.53"/>
<polygon fill="black" stroke="black" points="8550.36,-6231.03 8540.36,-6234.53 8550.36,-6238.03 8550.36,-6231.03"/>
</g>
<!-- mha_layer8_gpu12 -->
<g id="node662" class="node">
<title>mha_layer8_gpu12</title>
<path fill="lightblue" stroke="black" d="M12092,-5914.58C12092,-5914.58 11644,-5914.58 11644,-5914.58 11638,-5914.58 11632,-5908.58 11632,-5902.58 11632,-5902.58 11632,-5873.58 11632,-5873.58 11632,-5867.58 11638,-5861.58 11644,-5861.58 11644,-5861.58 12092,-5861.58 12092,-5861.58 12098,-5861.58 12104,-5867.58 12104,-5873.58 12104,-5873.58 12104,-5902.58 12104,-5902.58 12104,-5908.58 12098,-5914.58 12092,-5914.58"/>
<text text-anchor="middle" x="11868" y="-5899.38" font-family="Times,serif" font-size="14.00">MHA Layer 8 GPU 12</text>
<text text-anchor="middle" x="11868" y="-5884.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11868" y="-5869.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer7_gpu12&#45;&gt;mha_layer8_gpu12 -->
<g id="edge781" class="edge">
<title>aggregate_layer7_gpu12&#45;&gt;mha_layer8_gpu12</title>
<path fill="none" stroke="black" d="M11860.97,-5950.48C11861.97,-5941.71 11862.99,-5932.79 11863.93,-5924.57"/>
<polygon fill="black" stroke="black" points="11867.42,-5924.93 11865.08,-5914.59 11860.46,-5924.13 11867.42,-5924.93"/>
</g>
<!-- route_layer7_gpu13&#45;&gt;comm_layer7 -->
<g id="edge734" class="edge">
<title>route_layer7_gpu13&#45;&gt;comm_layer7</title>
<path fill="none" stroke="black" d="M13158.61,-6329.52C13059.87,-6320.96 12949.89,-6312.59 12849,-6307.53 12002.33,-6265.11 9378.43,-6242.89 8550.2,-6236.81"/>
<polygon fill="black" stroke="black" points="8549.96,-6233.31 8539.94,-6236.73 8549.91,-6240.31 8549.96,-6233.31"/>
</g>
<!-- mha_layer8_gpu13 -->
<g id="node663" class="node">
<title>mha_layer8_gpu13</title>
<path fill="lightblue" stroke="black" d="M13713,-5914.58C13713,-5914.58 13265,-5914.58 13265,-5914.58 13259,-5914.58 13253,-5908.58 13253,-5902.58 13253,-5902.58 13253,-5873.58 13253,-5873.58 13253,-5867.58 13259,-5861.58 13265,-5861.58 13265,-5861.58 13713,-5861.58 13713,-5861.58 13719,-5861.58 13725,-5867.58 13725,-5873.58 13725,-5873.58 13725,-5902.58 13725,-5902.58 13725,-5908.58 13719,-5914.58 13713,-5914.58"/>
<text text-anchor="middle" x="13489" y="-5899.38" font-family="Times,serif" font-size="14.00">MHA Layer 8 GPU 13</text>
<text text-anchor="middle" x="13489" y="-5884.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13489" y="-5869.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer7_gpu13&#45;&gt;mha_layer8_gpu13 -->
<g id="edge782" class="edge">
<title>aggregate_layer7_gpu13&#45;&gt;mha_layer8_gpu13</title>
<path fill="none" stroke="black" d="M13194.04,-5956.99C13252.89,-5943.44 13315.58,-5929 13367.97,-5916.94"/>
<polygon fill="black" stroke="black" points="13369,-5920.3 13377.96,-5914.64 13367.43,-5913.48 13369,-5920.3"/>
</g>
<!-- route_layer7_gpu14&#45;&gt;comm_layer7 -->
<g id="edge735" class="edge">
<title>route_layer7_gpu14&#45;&gt;comm_layer7</title>
<path fill="none" stroke="black" d="M14120.41,-6329.42C14021.15,-6320.83 13910.49,-6312.46 13809,-6307.53 12764.78,-6256.8 9488.27,-6239.87 8550.23,-6236"/>
<polygon fill="black" stroke="black" points="8549.99,-6232.5 8539.98,-6235.96 8549.96,-6239.5 8549.99,-6232.5"/>
</g>
<!-- mha_layer8_gpu14 -->
<g id="node664" class="node">
<title>mha_layer8_gpu14</title>
<path fill="lightblue" stroke="black" d="M14374,-5914.58C14374,-5914.58 13926,-5914.58 13926,-5914.58 13920,-5914.58 13914,-5908.58 13914,-5902.58 13914,-5902.58 13914,-5873.58 13914,-5873.58 13914,-5867.58 13920,-5861.58 13926,-5861.58 13926,-5861.58 14374,-5861.58 14374,-5861.58 14380,-5861.58 14386,-5867.58 14386,-5873.58 14386,-5873.58 14386,-5902.58 14386,-5902.58 14386,-5908.58 14380,-5914.58 14374,-5914.58"/>
<text text-anchor="middle" x="14150" y="-5899.38" font-family="Times,serif" font-size="14.00">MHA Layer 8 GPU 14</text>
<text text-anchor="middle" x="14150" y="-5884.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14150" y="-5869.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer7_gpu14&#45;&gt;mha_layer8_gpu14 -->
<g id="edge783" class="edge">
<title>aggregate_layer7_gpu14&#45;&gt;mha_layer8_gpu14</title>
<path fill="none" stroke="black" d="M14013.13,-5950.48C14037.35,-5939.62 14062.07,-5928.52 14083.73,-5918.81"/>
<polygon fill="black" stroke="black" points="14085.44,-5921.88 14093.13,-5914.59 14082.57,-5915.49 14085.44,-5921.88"/>
</g>
<!-- route_layer7_gpu15&#45;&gt;comm_layer7 -->
<g id="edge736" class="edge">
<title>route_layer7_gpu15&#45;&gt;comm_layer7</title>
<path fill="none" stroke="black" d="M15083.31,-6329.34C14983.79,-6320.72 14872.8,-6312.37 14771,-6307.53 13527.62,-6248.43 9589.7,-6237.34 8550.49,-6235.43"/>
<polygon fill="black" stroke="black" points="8550.28,-6231.93 8540.27,-6235.41 8550.27,-6238.93 8550.28,-6231.93"/>
</g>
<!-- mha_layer8_gpu15 -->
<g id="node665" class="node">
<title>mha_layer8_gpu15</title>
<path fill="lightblue" stroke="black" d="M14949,-5914.58C14949,-5914.58 14501,-5914.58 14501,-5914.58 14495,-5914.58 14489,-5908.58 14489,-5902.58 14489,-5902.58 14489,-5873.58 14489,-5873.58 14489,-5867.58 14495,-5861.58 14501,-5861.58 14501,-5861.58 14949,-5861.58 14949,-5861.58 14955,-5861.58 14961,-5867.58 14961,-5873.58 14961,-5873.58 14961,-5902.58 14961,-5902.58 14961,-5908.58 14955,-5914.58 14949,-5914.58"/>
<text text-anchor="middle" x="14725" y="-5899.38" font-family="Times,serif" font-size="14.00">MHA Layer 8 GPU 15</text>
<text text-anchor="middle" x="14725" y="-5884.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14725" y="-5869.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer7_gpu15&#45;&gt;mha_layer8_gpu15 -->
<g id="edge784" class="edge">
<title>aggregate_layer7_gpu15&#45;&gt;mha_layer8_gpu15</title>
<path fill="none" stroke="black" d="M14699.57,-5950.48C14703.29,-5941.52 14707.06,-5932.4 14710.53,-5924.03"/>
<polygon fill="black" stroke="black" points="14713.84,-5925.17 14714.43,-5914.59 14707.38,-5922.49 14713.84,-5925.17"/>
</g>
<!-- comm_layer7&#45;&gt;expert_layer7_gpu0_expert0 -->
<g id="edge737" class="edge">
<title>comm_layer7&#45;&gt;expert_layer7_gpu0_expert0</title>
<path fill="none" stroke="black" d="M8053.77,-6233.2C7240.19,-6233 4539.4,-6227.04 2308,-6160.58 2162.96,-6156.26 2001.02,-6148.73 1869.96,-6141.95"/>
<polygon fill="black" stroke="black" points="1869.95,-6138.45 1859.79,-6141.42 1869.59,-6145.44 1869.95,-6138.45"/>
</g>
<!-- comm_layer7&#45;&gt;expert_layer7_gpu1_expert1 -->
<g id="edge738" class="edge">
<title>comm_layer7&#45;&gt;expert_layer7_gpu1_expert1</title>
<path fill="none" stroke="black" d="M8053.78,-6232.19C7329.22,-6229.04 5121.82,-6215.29 3292,-6160.58 3135.62,-6155.9 2960.46,-6148.05 2821.15,-6141.17"/>
<polygon fill="black" stroke="black" points="2820.92,-6137.66 2810.75,-6140.66 2820.57,-6144.65 2820.92,-6137.66"/>
</g>
<!-- comm_layer7&#45;&gt;expert_layer7_gpu2_expert2 -->
<g id="edge739" class="edge">
<title>comm_layer7&#45;&gt;expert_layer7_gpu2_expert2</title>
<path fill="none" stroke="black" d="M8054.48,-6230.66C7434.23,-6224.07 5739.52,-6203.32 4328,-6160.58 4153.52,-6155.3 3957.18,-6146.98 3805.14,-6140.01"/>
<polygon fill="black" stroke="black" points="3804.88,-6136.5 3794.73,-6139.54 3804.56,-6143.49 3804.88,-6136.5"/>
</g>
<!-- comm_layer7&#45;&gt;expert_layer7_gpu3_expert3 -->
<g id="edge740" class="edge">
<title>comm_layer7&#45;&gt;expert_layer7_gpu3_expert3</title>
<path fill="none" stroke="black" d="M8057.06,-6227.66C7573.33,-6216.59 6446.46,-6189.89 5500,-6160.58 5277.44,-6153.69 5024.52,-6144.47 4840.91,-6137.53"/>
<polygon fill="black" stroke="black" points="4840.98,-6134.03 4830.85,-6137.15 4840.71,-6141.02 4840.98,-6134.03"/>
</g>
<!-- comm_layer7&#45;&gt;expert_layer7_gpu4_expert4 -->
<g id="edge741" class="edge">
<title>comm_layer7&#45;&gt;expert_layer7_gpu4_expert4</title>
<path fill="none" stroke="black" d="M8058.09,-6226.93C7676.89,-6216.62 6907.56,-6193.64 6256,-6160.58 6176.85,-6156.56 6090.71,-6151.23 6012.58,-6146.02"/>
<polygon fill="black" stroke="black" points="6012.81,-6142.53 6002.6,-6145.35 6012.34,-6149.51 6012.81,-6142.53"/>
</g>
<!-- comm_layer7&#45;&gt;expert_layer7_gpu5_expert5 -->
<g id="edge742" class="edge">
<title>comm_layer7&#45;&gt;expert_layer7_gpu5_expert5</title>
<path fill="none" stroke="black" d="M8070.63,-6220.25C7819.67,-6205.98 7402.89,-6182.09 7044,-6160.58 6954.28,-6155.2 6856.05,-6149.15 6768.69,-6143.72"/>
<polygon fill="black" stroke="black" points="6768.84,-6140.22 6758.64,-6143.09 6768.41,-6147.21 6768.84,-6140.22"/>
</g>
<!-- comm_layer7&#45;&gt;expert_layer7_gpu6_expert6 -->
<g id="edge743" class="edge">
<title>comm_layer7&#45;&gt;expert_layer7_gpu6_expert6</title>
<path fill="none" stroke="black" d="M8099.43,-6212.15C7943.86,-6195.7 7725.8,-6172.63 7556.72,-6154.74"/>
<polygon fill="black" stroke="black" points="7556.99,-6151.25 7546.67,-6153.68 7556.25,-6158.21 7556.99,-6151.25"/>
</g>
<!-- comm_layer7&#45;&gt;expert_layer7_gpu7_expert7 -->
<g id="edge744" class="edge">
<title>comm_layer7&#45;&gt;expert_layer7_gpu7_expert7</title>
<path fill="none" stroke="black" d="M8198.28,-6199.68C8164.58,-6188.29 8126.74,-6175.5 8092.4,-6163.89"/>
<polygon fill="black" stroke="black" points="8093.4,-6160.53 8082.81,-6160.65 8091.16,-6167.16 8093.4,-6160.53"/>
</g>
<!-- comm_layer7&#45;&gt;expert_layer7_gpu8_expert8 -->
<g id="edge745" class="edge">
<title>comm_layer7&#45;&gt;expert_layer7_gpu8_expert8</title>
<path fill="none" stroke="black" d="M8395.72,-6199.68C8429.42,-6188.29 8467.26,-6175.5 8501.6,-6163.89"/>
<polygon fill="black" stroke="black" points="8502.84,-6167.16 8511.19,-6160.65 8500.6,-6160.53 8502.84,-6167.16"/>
</g>
<!-- comm_layer7&#45;&gt;expert_layer7_gpu9_expert9 -->
<g id="edge746" class="edge">
<title>comm_layer7&#45;&gt;expert_layer7_gpu9_expert9</title>
<path fill="none" stroke="black" d="M8497.71,-6212.88C8665.91,-6195.96 8907.1,-6171.71 9089.33,-6153.39"/>
<polygon fill="black" stroke="black" points="9089.73,-6156.87 9099.33,-6152.38 9089.03,-6149.9 9089.73,-6156.87"/>
</g>
<!-- comm_layer7&#45;&gt;expert_layer7_gpu10_expert10 -->
<g id="edge747" class="edge">
<title>comm_layer7&#45;&gt;expert_layer7_gpu10_expert10</title>
<path fill="none" stroke="black" d="M8524.63,-6220.75C8784.89,-6206.59 9223.69,-6182.49 9601,-6160.58 9695.06,-6155.12 9798.24,-6148.92 9889.28,-6143.39"/>
<polygon fill="black" stroke="black" points="9889.7,-6146.87 9899.47,-6142.77 9889.27,-6139.88 9889.7,-6146.87"/>
</g>
<!-- comm_layer7&#45;&gt;expert_layer7_gpu11_expert11 -->
<g id="edge748" class="edge">
<title>comm_layer7&#45;&gt;expert_layer7_gpu11_expert11</title>
<path fill="none" stroke="black" d="M8536.11,-6227.01C8926.53,-6216.64 9725.17,-6193.37 10401,-6160.58 10489.08,-6156.31 10585.37,-6150.58 10671.27,-6145.11"/>
<polygon fill="black" stroke="black" points="10671.67,-6148.59 10681.42,-6144.46 10671.22,-6141.6 10671.67,-6148.59"/>
</g>
<!-- comm_layer7&#45;&gt;expert_layer7_gpu12_expert12 -->
<g id="edge749" class="edge">
<title>comm_layer7&#45;&gt;expert_layer7_gpu12_expert12</title>
<path fill="none" stroke="black" d="M8539.42,-6230.39C9035.77,-6224.19 10203.57,-6205.71 11183,-6160.58 11259.42,-6157.06 11342.44,-6151.97 11418.14,-6146.85"/>
<polygon fill="black" stroke="black" points="11418.55,-6150.33 11428.29,-6146.16 11418.08,-6143.34 11418.55,-6150.33"/>
</g>
<!-- comm_layer7&#45;&gt;expert_layer7_gpu13_expert13 -->
<g id="edge750" class="edge">
<title>comm_layer7&#45;&gt;expert_layer7_gpu13_expert13</title>
<path fill="none" stroke="black" d="M8539.41,-6230.56C9123.17,-6224.03 10653.25,-6203.88 11930,-6160.58 12073.04,-6155.73 12232.69,-6148.21 12362.26,-6141.58"/>
<polygon fill="black" stroke="black" points="12362.52,-6145.07 12372.33,-6141.07 12362.16,-6138.08 12362.52,-6145.07"/>
</g>
<!-- comm_layer7&#45;&gt;expert_layer7_gpu14_expert14 -->
<g id="edge751" class="edge">
<title>comm_layer7&#45;&gt;expert_layer7_gpu14_expert14</title>
<path fill="none" stroke="black" d="M8540.2,-6232.08C9223.35,-6228.72 11217.9,-6214.64 12874,-6160.58 13009.53,-6156.16 13160.44,-6148.89 13284.39,-6142.29"/>
<polygon fill="black" stroke="black" points="13284.6,-6145.79 13294.4,-6141.76 13284.23,-6138.8 13284.6,-6145.79"/>
</g>
<!-- comm_layer7&#45;&gt;expert_layer7_gpu15_expert15 -->
<g id="edge752" class="edge">
<title>comm_layer7&#45;&gt;expert_layer7_gpu15_expert15</title>
<path fill="none" stroke="black" d="M8540.32,-6233.5C9310.72,-6234.11 11765.32,-6230.06 13796,-6160.58 13907.56,-6156.76 14030.73,-6150.33 14136.08,-6144.15"/>
<polygon fill="black" stroke="black" points="14136.44,-6147.64 14146.21,-6143.56 14136.03,-6140.65 14136.44,-6147.64"/>
</g>
<!-- gate_layer8_gpu0 -->
<g id="node666" class="node">
<title>gate_layer8_gpu0</title>
<path fill="lightsteelblue" stroke="black" d="M993.07,-5824.24C993.07,-5824.24 543.93,-5773.92 543.93,-5773.92 537.96,-5773.25 537.96,-5771.91 543.93,-5771.24 543.93,-5771.24 993.07,-5720.92 993.07,-5720.92 999.04,-5720.25 1010.96,-5720.25 1016.93,-5720.92 1016.93,-5720.92 1466.07,-5771.24 1466.07,-5771.24 1472.04,-5771.91 1472.04,-5773.25 1466.07,-5773.92 1466.07,-5773.92 1016.93,-5824.24 1016.93,-5824.24 1010.96,-5824.91 999.04,-5824.91 993.07,-5824.24"/>
<text text-anchor="middle" x="1005" y="-5783.88" font-family="Times,serif" font-size="14.00">Gate Layer 8 GPU 0</text>
<text text-anchor="middle" x="1005" y="-5768.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="1005" y="-5753.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer8_gpu0&#45;&gt;gate_layer8_gpu0 -->
<g id="edge785" class="edge">
<title>mha_layer8_gpu0&#45;&gt;gate_layer8_gpu0</title>
<path fill="none" stroke="black" d="M1239.62,-5861.47C1204.8,-5848.42 1161.49,-5832.2 1121.6,-5817.26"/>
<polygon fill="black" stroke="black" points="1122.67,-5813.92 1112.08,-5813.69 1120.21,-5820.47 1122.67,-5813.92"/>
</g>
<!-- gate_layer8_gpu1 -->
<g id="node667" class="node">
<title>gate_layer8_gpu1</title>
<path fill="lightsteelblue" stroke="black" d="M1957.07,-5824.24C1957.07,-5824.24 1507.93,-5773.92 1507.93,-5773.92 1501.96,-5773.25 1501.96,-5771.91 1507.93,-5771.24 1507.93,-5771.24 1957.07,-5720.92 1957.07,-5720.92 1963.04,-5720.25 1974.96,-5720.25 1980.93,-5720.92 1980.93,-5720.92 2430.07,-5771.24 2430.07,-5771.24 2436.04,-5771.91 2436.04,-5773.25 2430.07,-5773.92 2430.07,-5773.92 1980.93,-5824.24 1980.93,-5824.24 1974.96,-5824.91 1963.04,-5824.91 1957.07,-5824.24"/>
<text text-anchor="middle" x="1969" y="-5783.88" font-family="Times,serif" font-size="14.00">Gate Layer 8 GPU 1</text>
<text text-anchor="middle" x="1969" y="-5768.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="1969" y="-5753.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer8_gpu1&#45;&gt;gate_layer8_gpu1 -->
<g id="edge786" class="edge">
<title>mha_layer8_gpu1&#45;&gt;gate_layer8_gpu1</title>
<path fill="none" stroke="black" d="M2209.82,-5861.47C2173.83,-5848.33 2129.02,-5831.98 2087.85,-5816.95"/>
<polygon fill="black" stroke="black" points="2088.89,-5813.61 2078.3,-5813.47 2086.49,-5820.18 2088.89,-5813.61"/>
</g>
<!-- gate_layer8_gpu2 -->
<g id="node668" class="node">
<title>gate_layer8_gpu2</title>
<path fill="lightsteelblue" stroke="black" d="M2921.07,-5824.24C2921.07,-5824.24 2471.93,-5773.92 2471.93,-5773.92 2465.96,-5773.25 2465.96,-5771.91 2471.93,-5771.24 2471.93,-5771.24 2921.07,-5720.92 2921.07,-5720.92 2927.04,-5720.25 2938.96,-5720.25 2944.93,-5720.92 2944.93,-5720.92 3394.07,-5771.24 3394.07,-5771.24 3400.04,-5771.91 3400.04,-5773.25 3394.07,-5773.92 3394.07,-5773.92 2944.93,-5824.24 2944.93,-5824.24 2938.96,-5824.91 2927.04,-5824.91 2921.07,-5824.24"/>
<text text-anchor="middle" x="2933" y="-5783.88" font-family="Times,serif" font-size="14.00">Gate Layer 8 GPU 2</text>
<text text-anchor="middle" x="2933" y="-5768.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="2933" y="-5753.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer8_gpu2&#45;&gt;gate_layer8_gpu2 -->
<g id="edge787" class="edge">
<title>mha_layer8_gpu2&#45;&gt;gate_layer8_gpu2</title>
<path fill="none" stroke="black" d="M3021.13,-5861.32C3011.12,-5851.36 2999.26,-5839.55 2987.54,-5827.89"/>
<polygon fill="black" stroke="black" points="2989.84,-5825.23 2980.28,-5820.66 2984.9,-5830.19 2989.84,-5825.23"/>
</g>
<!-- gate_layer8_gpu3 -->
<g id="node669" class="node">
<title>gate_layer8_gpu3</title>
<path fill="lightsteelblue" stroke="black" d="M3885.07,-5824.24C3885.07,-5824.24 3435.93,-5773.92 3435.93,-5773.92 3429.96,-5773.25 3429.96,-5771.91 3435.93,-5771.24 3435.93,-5771.24 3885.07,-5720.92 3885.07,-5720.92 3891.04,-5720.25 3902.96,-5720.25 3908.93,-5720.92 3908.93,-5720.92 4358.07,-5771.24 4358.07,-5771.24 4364.04,-5771.91 4364.04,-5773.25 4358.07,-5773.92 4358.07,-5773.92 3908.93,-5824.24 3908.93,-5824.24 3902.96,-5824.91 3891.04,-5824.91 3885.07,-5824.24"/>
<text text-anchor="middle" x="3897" y="-5783.88" font-family="Times,serif" font-size="14.00">Gate Layer 8 GPU 3</text>
<text text-anchor="middle" x="3897" y="-5768.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="3897" y="-5753.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer8_gpu3&#45;&gt;gate_layer8_gpu3 -->
<g id="edge788" class="edge">
<title>mha_layer8_gpu3&#45;&gt;gate_layer8_gpu3</title>
<path fill="none" stroke="black" d="M3930.24,-5861.32C3927.05,-5852.9 3923.36,-5843.16 3919.62,-5833.3"/>
<polygon fill="black" stroke="black" points="3922.86,-5831.96 3916.04,-5823.85 3916.31,-5834.44 3922.86,-5831.96"/>
</g>
<!-- gate_layer8_gpu4 -->
<g id="node670" class="node">
<title>gate_layer8_gpu4</title>
<path fill="lightsteelblue" stroke="black" d="M4849.07,-5824.24C4849.07,-5824.24 4399.93,-5773.92 4399.93,-5773.92 4393.96,-5773.25 4393.96,-5771.91 4399.93,-5771.24 4399.93,-5771.24 4849.07,-5720.92 4849.07,-5720.92 4855.04,-5720.25 4866.96,-5720.25 4872.93,-5720.92 4872.93,-5720.92 5322.07,-5771.24 5322.07,-5771.24 5328.04,-5771.91 5328.04,-5773.25 5322.07,-5773.92 5322.07,-5773.92 4872.93,-5824.24 4872.93,-5824.24 4866.96,-5824.91 4855.04,-5824.91 4849.07,-5824.24"/>
<text text-anchor="middle" x="4861" y="-5783.88" font-family="Times,serif" font-size="14.00">Gate Layer 8 GPU 4</text>
<text text-anchor="middle" x="4861" y="-5768.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4861" y="-5753.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer8_gpu4&#45;&gt;gate_layer8_gpu4 -->
<g id="edge789" class="edge">
<title>mha_layer8_gpu4&#45;&gt;gate_layer8_gpu4</title>
<path fill="none" stroke="black" d="M5040.65,-5861.47C5015.92,-5849.37 4985.62,-5834.55 4956.99,-5820.54"/>
<polygon fill="black" stroke="black" points="4958.28,-5817.28 4947.76,-5816.02 4955.2,-5823.56 4958.28,-5817.28"/>
</g>
<!-- gate_layer8_gpu5 -->
<g id="node671" class="node">
<title>gate_layer8_gpu5</title>
<path fill="lightsteelblue" stroke="black" d="M5813.07,-5824.24C5813.07,-5824.24 5363.93,-5773.92 5363.93,-5773.92 5357.96,-5773.25 5357.96,-5771.91 5363.93,-5771.24 5363.93,-5771.24 5813.07,-5720.92 5813.07,-5720.92 5819.04,-5720.25 5830.96,-5720.25 5836.93,-5720.92 5836.93,-5720.92 6286.07,-5771.24 6286.07,-5771.24 6292.04,-5771.91 6292.04,-5773.25 6286.07,-5773.92 6286.07,-5773.92 5836.93,-5824.24 5836.93,-5824.24 5830.96,-5824.91 5819.04,-5824.91 5813.07,-5824.24"/>
<text text-anchor="middle" x="5825" y="-5783.88" font-family="Times,serif" font-size="14.00">Gate Layer 8 GPU 5</text>
<text text-anchor="middle" x="5825" y="-5768.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5825" y="-5753.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer8_gpu5&#45;&gt;gate_layer8_gpu5 -->
<g id="edge790" class="edge">
<title>mha_layer8_gpu5&#45;&gt;gate_layer8_gpu5</title>
<path fill="none" stroke="black" d="M5998.45,-5861.47C5974.8,-5849.48 5945.86,-5834.82 5918.44,-5820.92"/>
<polygon fill="black" stroke="black" points="5919.71,-5817.65 5909.21,-5816.25 5916.55,-5823.89 5919.71,-5817.65"/>
</g>
<!-- gate_layer8_gpu6 -->
<g id="node672" class="node">
<title>gate_layer8_gpu6</title>
<path fill="lightsteelblue" stroke="black" d="M6777.07,-5824.24C6777.07,-5824.24 6327.93,-5773.92 6327.93,-5773.92 6321.96,-5773.25 6321.96,-5771.91 6327.93,-5771.24 6327.93,-5771.24 6777.07,-5720.92 6777.07,-5720.92 6783.04,-5720.25 6794.96,-5720.25 6800.93,-5720.92 6800.93,-5720.92 7250.07,-5771.24 7250.07,-5771.24 7256.04,-5771.91 7256.04,-5773.25 7250.07,-5773.92 7250.07,-5773.92 6800.93,-5824.24 6800.93,-5824.24 6794.96,-5824.91 6783.04,-5824.91 6777.07,-5824.24"/>
<text text-anchor="middle" x="6789" y="-5783.88" font-family="Times,serif" font-size="14.00">Gate Layer 8 GPU 6</text>
<text text-anchor="middle" x="6789" y="-5768.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6789" y="-5753.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer8_gpu6&#45;&gt;gate_layer8_gpu6 -->
<g id="edge791" class="edge">
<title>mha_layer8_gpu6&#45;&gt;gate_layer8_gpu6</title>
<path fill="none" stroke="black" d="M6977.16,-5861.47C6950.9,-5849.2 6918.63,-5834.13 6888.27,-5819.95"/>
<polygon fill="black" stroke="black" points="6889.46,-5816.64 6878.92,-5815.58 6886.5,-5822.98 6889.46,-5816.64"/>
</g>
<!-- gate_layer8_gpu7 -->
<g id="node673" class="node">
<title>gate_layer8_gpu7</title>
<path fill="lightsteelblue" stroke="black" d="M7741.07,-5824.24C7741.07,-5824.24 7291.93,-5773.92 7291.93,-5773.92 7285.96,-5773.25 7285.96,-5771.91 7291.93,-5771.24 7291.93,-5771.24 7741.07,-5720.92 7741.07,-5720.92 7747.04,-5720.25 7758.96,-5720.25 7764.93,-5720.92 7764.93,-5720.92 8214.07,-5771.24 8214.07,-5771.24 8220.04,-5771.91 8220.04,-5773.25 8214.07,-5773.92 8214.07,-5773.92 7764.93,-5824.24 7764.93,-5824.24 7758.96,-5824.91 7747.04,-5824.91 7741.07,-5824.24"/>
<text text-anchor="middle" x="7753" y="-5783.88" font-family="Times,serif" font-size="14.00">Gate Layer 8 GPU 7</text>
<text text-anchor="middle" x="7753" y="-5768.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="7753" y="-5753.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer8_gpu7&#45;&gt;gate_layer8_gpu7 -->
<g id="edge792" class="edge">
<title>mha_layer8_gpu7&#45;&gt;gate_layer8_gpu7</title>
<path fill="none" stroke="black" d="M7772.33,-5861.32C7770.55,-5853.27 7768.51,-5844.01 7766.44,-5834.59"/>
<polygon fill="black" stroke="black" points="7769.84,-5833.77 7764.27,-5824.76 7763.01,-5835.28 7769.84,-5833.77"/>
</g>
<!-- gate_layer8_gpu8 -->
<g id="node674" class="node">
<title>gate_layer8_gpu8</title>
<path fill="lightsteelblue" stroke="black" d="M8705.07,-5824.24C8705.07,-5824.24 8255.93,-5773.92 8255.93,-5773.92 8249.96,-5773.25 8249.96,-5771.91 8255.93,-5771.24 8255.93,-5771.24 8705.07,-5720.92 8705.07,-5720.92 8711.04,-5720.25 8722.96,-5720.25 8728.93,-5720.92 8728.93,-5720.92 9178.07,-5771.24 9178.07,-5771.24 9184.04,-5771.91 9184.04,-5773.25 9178.07,-5773.92 9178.07,-5773.92 8728.93,-5824.24 8728.93,-5824.24 8722.96,-5824.91 8711.04,-5824.91 8705.07,-5824.24"/>
<text text-anchor="middle" x="8717" y="-5783.88" font-family="Times,serif" font-size="14.00">Gate Layer 8 GPU 8</text>
<text text-anchor="middle" x="8717" y="-5768.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="8717" y="-5753.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer8_gpu8&#45;&gt;gate_layer8_gpu8 -->
<g id="edge793" class="edge">
<title>mha_layer8_gpu8&#45;&gt;gate_layer8_gpu8</title>
<path fill="none" stroke="black" d="M8696.9,-5861.32C8698.77,-5853.17 8700.92,-5843.78 8703.1,-5834.25"/>
<polygon fill="black" stroke="black" points="8706.56,-5834.83 8705.38,-5824.3 8699.74,-5833.27 8706.56,-5834.83"/>
</g>
<!-- gate_layer8_gpu9 -->
<g id="node675" class="node">
<title>gate_layer8_gpu9</title>
<path fill="lightsteelblue" stroke="black" d="M9669.07,-5824.24C9669.07,-5824.24 9219.93,-5773.92 9219.93,-5773.92 9213.96,-5773.25 9213.96,-5771.91 9219.93,-5771.24 9219.93,-5771.24 9669.07,-5720.92 9669.07,-5720.92 9675.04,-5720.25 9686.96,-5720.25 9692.93,-5720.92 9692.93,-5720.92 10142.07,-5771.24 10142.07,-5771.24 10148.04,-5771.91 10148.04,-5773.25 10142.07,-5773.92 10142.07,-5773.92 9692.93,-5824.24 9692.93,-5824.24 9686.96,-5824.91 9675.04,-5824.91 9669.07,-5824.24"/>
<text text-anchor="middle" x="9681" y="-5783.88" font-family="Times,serif" font-size="14.00">Gate Layer 8 GPU 9</text>
<text text-anchor="middle" x="9681" y="-5768.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="9681" y="-5753.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer8_gpu9&#45;&gt;gate_layer8_gpu9 -->
<g id="edge794" class="edge">
<title>mha_layer8_gpu9&#45;&gt;gate_layer8_gpu9</title>
<path fill="none" stroke="black" d="M9616.83,-5861.32C9623.62,-5852.05 9631.57,-5841.18 9639.52,-5830.31"/>
<polygon fill="black" stroke="black" points="9642.5,-5832.16 9645.58,-5822.02 9636.85,-5828.03 9642.5,-5832.16"/>
</g>
<!-- gate_layer8_gpu10 -->
<g id="node676" class="node">
<title>gate_layer8_gpu10</title>
<path fill="lightsteelblue" stroke="black" d="M10633.07,-5824.24C10633.07,-5824.24 10183.93,-5773.92 10183.93,-5773.92 10177.96,-5773.25 10177.96,-5771.91 10183.93,-5771.24 10183.93,-5771.24 10633.07,-5720.92 10633.07,-5720.92 10639.04,-5720.25 10650.96,-5720.25 10656.93,-5720.92 10656.93,-5720.92 11106.07,-5771.24 11106.07,-5771.24 11112.04,-5771.91 11112.04,-5773.25 11106.07,-5773.92 11106.07,-5773.92 10656.93,-5824.24 10656.93,-5824.24 10650.96,-5824.91 10639.04,-5824.91 10633.07,-5824.24"/>
<text text-anchor="middle" x="10645" y="-5783.88" font-family="Times,serif" font-size="14.00">Gate Layer 8 GPU 10</text>
<text text-anchor="middle" x="10645" y="-5768.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="10645" y="-5753.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer8_gpu10&#45;&gt;gate_layer8_gpu10 -->
<g id="edge795" class="edge">
<title>mha_layer8_gpu10&#45;&gt;gate_layer8_gpu10</title>
<path fill="none" stroke="black" d="M10634.95,-5861.32C10635.85,-5853.45 10636.89,-5844.42 10637.94,-5835.22"/>
<polygon fill="black" stroke="black" points="10641.42,-5835.55 10639.09,-5825.22 10634.47,-5834.76 10641.42,-5835.55"/>
</g>
<!-- gate_layer8_gpu11 -->
<g id="node677" class="node">
<title>gate_layer8_gpu11</title>
<path fill="lightsteelblue" stroke="black" d="M11597.07,-5824.24C11597.07,-5824.24 11147.93,-5773.92 11147.93,-5773.92 11141.96,-5773.25 11141.96,-5771.91 11147.93,-5771.24 11147.93,-5771.24 11597.07,-5720.92 11597.07,-5720.92 11603.04,-5720.25 11614.96,-5720.25 11620.93,-5720.92 11620.93,-5720.92 12070.07,-5771.24 12070.07,-5771.24 12076.04,-5771.91 12076.04,-5773.25 12070.07,-5773.92 12070.07,-5773.92 11620.93,-5824.24 11620.93,-5824.24 11614.96,-5824.91 11603.04,-5824.91 11597.07,-5824.24"/>
<text text-anchor="middle" x="11609" y="-5783.88" font-family="Times,serif" font-size="14.00">Gate Layer 8 GPU 11</text>
<text text-anchor="middle" x="11609" y="-5768.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11609" y="-5753.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer8_gpu11&#45;&gt;gate_layer8_gpu11 -->
<g id="edge796" class="edge">
<title>mha_layer8_gpu11&#45;&gt;gate_layer8_gpu11</title>
<path fill="none" stroke="black" d="M11364.31,-5861.47C11401.12,-5848.25 11447.02,-5831.76 11489.09,-5816.65"/>
<polygon fill="black" stroke="black" points="11490.33,-5819.92 11498.56,-5813.25 11487.97,-5813.33 11490.33,-5819.92"/>
</g>
<!-- gate_layer8_gpu12 -->
<g id="node678" class="node">
<title>gate_layer8_gpu12</title>
<path fill="lightsteelblue" stroke="black" d="M12561.07,-5824.24C12561.07,-5824.24 12111.93,-5773.92 12111.93,-5773.92 12105.96,-5773.25 12105.96,-5771.91 12111.93,-5771.24 12111.93,-5771.24 12561.07,-5720.92 12561.07,-5720.92 12567.04,-5720.25 12578.96,-5720.25 12584.93,-5720.92 12584.93,-5720.92 13034.07,-5771.24 13034.07,-5771.24 13040.04,-5771.91 13040.04,-5773.25 13034.07,-5773.92 13034.07,-5773.92 12584.93,-5824.24 12584.93,-5824.24 12578.96,-5824.91 12567.04,-5824.91 12561.07,-5824.24"/>
<text text-anchor="middle" x="12573" y="-5783.88" font-family="Times,serif" font-size="14.00">Gate Layer 8 GPU 12</text>
<text text-anchor="middle" x="12573" y="-5768.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="12573" y="-5753.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer8_gpu12&#45;&gt;gate_layer8_gpu12 -->
<g id="edge797" class="edge">
<title>mha_layer8_gpu12&#45;&gt;gate_layer8_gpu12</title>
<path fill="none" stroke="black" d="M12026.66,-5861.54C12128.83,-5845.09 12262.55,-5823.56 12372.12,-5805.92"/>
<polygon fill="black" stroke="black" points="12372.99,-5809.32 12382.31,-5804.28 12371.88,-5802.41 12372.99,-5809.32"/>
</g>
<!-- gate_layer8_gpu13 -->
<g id="node679" class="node">
<title>gate_layer8_gpu13</title>
<path fill="lightsteelblue" stroke="black" d="M13525.07,-5824.24C13525.07,-5824.24 13075.93,-5773.92 13075.93,-5773.92 13069.96,-5773.25 13069.96,-5771.91 13075.93,-5771.24 13075.93,-5771.24 13525.07,-5720.92 13525.07,-5720.92 13531.04,-5720.25 13542.96,-5720.25 13548.93,-5720.92 13548.93,-5720.92 13998.07,-5771.24 13998.07,-5771.24 14004.04,-5771.91 14004.04,-5773.25 13998.07,-5773.92 13998.07,-5773.92 13548.93,-5824.24 13548.93,-5824.24 13542.96,-5824.91 13531.04,-5824.91 13525.07,-5824.24"/>
<text text-anchor="middle" x="13537" y="-5783.88" font-family="Times,serif" font-size="14.00">Gate Layer 8 GPU 13</text>
<text text-anchor="middle" x="13537" y="-5768.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13537" y="-5753.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer8_gpu13&#45;&gt;gate_layer8_gpu13 -->
<g id="edge798" class="edge">
<title>mha_layer8_gpu13&#45;&gt;gate_layer8_gpu13</title>
<path fill="none" stroke="black" d="M13499.89,-5861.32C13503.53,-5852.71 13507.76,-5842.72 13512.02,-5832.64"/>
<polygon fill="black" stroke="black" points="13515.26,-5833.96 13515.94,-5823.39 13508.82,-5831.24 13515.26,-5833.96"/>
</g>
<!-- gate_layer8_gpu14 -->
<g id="node680" class="node">
<title>gate_layer8_gpu14</title>
<path fill="lightsteelblue" stroke="black" d="M14489.07,-5824.24C14489.07,-5824.24 14039.93,-5773.92 14039.93,-5773.92 14033.96,-5773.25 14033.96,-5771.91 14039.93,-5771.24 14039.93,-5771.24 14489.07,-5720.92 14489.07,-5720.92 14495.04,-5720.25 14506.96,-5720.25 14512.93,-5720.92 14512.93,-5720.92 14962.07,-5771.24 14962.07,-5771.24 14968.04,-5771.91 14968.04,-5773.25 14962.07,-5773.92 14962.07,-5773.92 14512.93,-5824.24 14512.93,-5824.24 14506.96,-5824.91 14495.04,-5824.91 14489.07,-5824.24"/>
<text text-anchor="middle" x="14501" y="-5783.88" font-family="Times,serif" font-size="14.00">Gate Layer 8 GPU 14</text>
<text text-anchor="middle" x="14501" y="-5768.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14501" y="-5753.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer8_gpu14&#45;&gt;gate_layer8_gpu14 -->
<g id="edge799" class="edge">
<title>mha_layer8_gpu14&#45;&gt;gate_layer8_gpu14</title>
<path fill="none" stroke="black" d="M14229.21,-5861.47C14271.2,-5847.89 14323.85,-5830.86 14371.6,-5815.42"/>
<polygon fill="black" stroke="black" points="14372.95,-5818.66 14381.39,-5812.26 14370.8,-5812 14372.95,-5818.66"/>
</g>
<!-- gate_layer8_gpu15 -->
<g id="node681" class="node">
<title>gate_layer8_gpu15</title>
<path fill="lightsteelblue" stroke="black" d="M15453.07,-5824.24C15453.07,-5824.24 15003.93,-5773.92 15003.93,-5773.92 14997.96,-5773.25 14997.96,-5771.91 15003.93,-5771.24 15003.93,-5771.24 15453.07,-5720.92 15453.07,-5720.92 15459.04,-5720.25 15470.96,-5720.25 15476.93,-5720.92 15476.93,-5720.92 15926.07,-5771.24 15926.07,-5771.24 15932.04,-5771.91 15932.04,-5773.25 15926.07,-5773.92 15926.07,-5773.92 15476.93,-5824.24 15476.93,-5824.24 15470.96,-5824.91 15459.04,-5824.91 15453.07,-5824.24"/>
<text text-anchor="middle" x="15465" y="-5783.88" font-family="Times,serif" font-size="14.00">Gate Layer 8 GPU 15</text>
<text text-anchor="middle" x="15465" y="-5768.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="15465" y="-5753.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer8_gpu15&#45;&gt;gate_layer8_gpu15 -->
<g id="edge800" class="edge">
<title>mha_layer8_gpu15&#45;&gt;gate_layer8_gpu15</title>
<path fill="none" stroke="black" d="M14891.53,-5861.54C15000.24,-5844.86 15142.96,-5822.97 15258.83,-5805.2"/>
<polygon fill="black" stroke="black" points="15259.53,-5808.64 15268.89,-5803.66 15258.47,-5801.72 15259.53,-5808.64"/>
</g>
<!-- route_layer8_gpu0 -->
<g id="node698" class="node">
<title>route_layer8_gpu0</title>
<path fill="orange" stroke="black" d="M1412.74,-5683.58C1412.74,-5683.58 904.24,-5683.58 904.24,-5683.58 898.24,-5683.58 887.5,-5679.91 882.75,-5676.24 882.75,-5676.24 764.75,-5584.92 764.75,-5584.92 760,-5581.25 761.26,-5577.58 767.26,-5577.58 767.26,-5577.58 1275.76,-5577.58 1275.76,-5577.58 1281.76,-5577.58 1292.5,-5581.25 1297.25,-5584.92 1297.25,-5584.92 1415.25,-5676.24 1415.25,-5676.24 1420,-5679.91 1418.74,-5683.58 1412.74,-5683.58"/>
<text text-anchor="middle" x="1090" y="-5641.88" font-family="Times,serif" font-size="14.00">Token Router Layer 8 GPU 0</text>
<text text-anchor="middle" x="1090" y="-5626.88" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="1090" y="-5611.88" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer8_gpu0&#45;&gt;route_layer8_gpu0 -->
<g id="edge801" class="edge">
<title>gate_layer8_gpu0&#45;&gt;route_layer8_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1034.73,-5722.61C1040.65,-5712.86 1046.94,-5702.5 1053.07,-5692.4"/>
<polygon fill="black" stroke="black" points="1056.21,-5693.98 1058.41,-5683.61 1050.23,-5690.34 1056.21,-5693.98"/>
</g>
<!-- route_layer8_gpu1 -->
<g id="node700" class="node">
<title>route_layer8_gpu1</title>
<path fill="orange" stroke="black" d="M3066.74,-5683.58C3066.74,-5683.58 2558.24,-5683.58 2558.24,-5683.58 2552.24,-5683.58 2541.5,-5679.91 2536.75,-5676.24 2536.75,-5676.24 2418.75,-5584.92 2418.75,-5584.92 2414,-5581.25 2415.26,-5577.58 2421.26,-5577.58 2421.26,-5577.58 2929.76,-5577.58 2929.76,-5577.58 2935.76,-5577.58 2946.5,-5581.25 2951.25,-5584.92 2951.25,-5584.92 3069.25,-5676.24 3069.25,-5676.24 3074,-5679.91 3072.74,-5683.58 3066.74,-5683.58"/>
<text text-anchor="middle" x="2744" y="-5641.88" font-family="Times,serif" font-size="14.00">Token Router Layer 8 GPU 1</text>
<text text-anchor="middle" x="2744" y="-5626.88" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="2744" y="-5611.88" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer8_gpu1&#45;&gt;route_layer8_gpu1 -->
<g id="edge802" class="edge">
<title>gate_layer8_gpu1&#45;&gt;route_layer8_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2146.8,-5739.46C2257.42,-5719.48 2400.68,-5693.6 2519.15,-5672.2"/>
<polygon fill="black" stroke="black" points="2519.86,-5675.63 2529.08,-5670.4 2518.62,-5668.74 2519.86,-5675.63"/>
</g>
<!-- route_layer8_gpu2 -->
<g id="node702" class="node">
<title>route_layer8_gpu2</title>
<path fill="orange" stroke="black" d="M4237.74,-5683.58C4237.74,-5683.58 3729.24,-5683.58 3729.24,-5683.58 3723.24,-5683.58 3712.5,-5679.91 3707.75,-5676.24 3707.75,-5676.24 3589.75,-5584.92 3589.75,-5584.92 3585,-5581.25 3586.26,-5577.58 3592.26,-5577.58 3592.26,-5577.58 4100.76,-5577.58 4100.76,-5577.58 4106.76,-5577.58 4117.5,-5581.25 4122.25,-5584.92 4122.25,-5584.92 4240.25,-5676.24 4240.25,-5676.24 4245,-5679.91 4243.74,-5683.58 4237.74,-5683.58"/>
<text text-anchor="middle" x="3915" y="-5641.88" font-family="Times,serif" font-size="14.00">Token Router Layer 8 GPU 2</text>
<text text-anchor="middle" x="3915" y="-5626.88" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="3915" y="-5611.88" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer8_gpu2&#45;&gt;route_layer8_gpu2 -->
<g id="edge803" class="edge">
<title>gate_layer8_gpu2&#45;&gt;route_layer8_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3137.37,-5742.44C3295.77,-5719.86 3515.43,-5688.55 3680.9,-5664.96"/>
<polygon fill="black" stroke="black" points="3681.81,-5668.36 3691.22,-5663.48 3680.82,-5661.43 3681.81,-5668.36"/>
</g>
<!-- route_layer8_gpu3 -->
<g id="node704" class="node">
<title>route_layer8_gpu3</title>
<path fill="orange" stroke="black" d="M5166.74,-5683.58C5166.74,-5683.58 4658.24,-5683.58 4658.24,-5683.58 4652.24,-5683.58 4641.5,-5679.91 4636.75,-5676.24 4636.75,-5676.24 4518.75,-5584.92 4518.75,-5584.92 4514,-5581.25 4515.26,-5577.58 4521.26,-5577.58 4521.26,-5577.58 5029.76,-5577.58 5029.76,-5577.58 5035.76,-5577.58 5046.5,-5581.25 5051.25,-5584.92 5051.25,-5584.92 5169.25,-5676.24 5169.25,-5676.24 5174,-5679.91 5172.74,-5683.58 5166.74,-5683.58"/>
<text text-anchor="middle" x="4844" y="-5641.88" font-family="Times,serif" font-size="14.00">Token Router Layer 8 GPU 3</text>
<text text-anchor="middle" x="4844" y="-5626.88" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="4844" y="-5611.88" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer8_gpu3&#45;&gt;route_layer8_gpu3 -->
<g id="edge804" class="edge">
<title>gate_layer8_gpu3&#45;&gt;route_layer8_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4097.26,-5741.98C4247.43,-5719.77 4453.36,-5689.33 4610.94,-5666.03"/>
<polygon fill="black" stroke="black" points="4611.86,-5669.44 4621.24,-5664.51 4610.84,-5662.51 4611.86,-5669.44"/>
</g>
<!-- route_layer8_gpu4 -->
<g id="node706" class="node">
<title>route_layer8_gpu4</title>
<path fill="orange" stroke="black" d="M5975.74,-5683.58C5975.74,-5683.58 5467.24,-5683.58 5467.24,-5683.58 5461.24,-5683.58 5450.5,-5679.91 5445.75,-5676.24 5445.75,-5676.24 5327.75,-5584.92 5327.75,-5584.92 5323,-5581.25 5324.26,-5577.58 5330.26,-5577.58 5330.26,-5577.58 5838.76,-5577.58 5838.76,-5577.58 5844.76,-5577.58 5855.5,-5581.25 5860.25,-5584.92 5860.25,-5584.92 5978.25,-5676.24 5978.25,-5676.24 5983,-5679.91 5981.74,-5683.58 5975.74,-5683.58"/>
<text text-anchor="middle" x="5653" y="-5641.88" font-family="Times,serif" font-size="14.00">Token Router Layer 8 GPU 4</text>
<text text-anchor="middle" x="5653" y="-5626.88" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="5653" y="-5611.88" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer8_gpu4&#45;&gt;route_layer8_gpu4 -->
<g id="edge805" class="edge">
<title>gate_layer8_gpu4&#45;&gt;route_layer8_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5041.21,-5739.72C5155.77,-5719.47 5305,-5693.1 5427.4,-5671.46"/>
<polygon fill="black" stroke="black" points="5428.04,-5674.9 5437.28,-5669.71 5426.83,-5668.01 5428.04,-5674.9"/>
</g>
<!-- route_layer8_gpu5 -->
<g id="node708" class="node">
<title>route_layer8_gpu5</title>
<path fill="orange" stroke="black" d="M6723.74,-5683.58C6723.74,-5683.58 6215.24,-5683.58 6215.24,-5683.58 6209.24,-5683.58 6198.5,-5679.91 6193.75,-5676.24 6193.75,-5676.24 6075.75,-5584.92 6075.75,-5584.92 6071,-5581.25 6072.26,-5577.58 6078.26,-5577.58 6078.26,-5577.58 6586.76,-5577.58 6586.76,-5577.58 6592.76,-5577.58 6603.5,-5581.25 6608.25,-5584.92 6608.25,-5584.92 6726.25,-5676.24 6726.25,-5676.24 6731,-5679.91 6729.74,-5683.58 6723.74,-5683.58"/>
<text text-anchor="middle" x="6401" y="-5641.88" font-family="Times,serif" font-size="14.00">Token Router Layer 8 GPU 5</text>
<text text-anchor="middle" x="6401" y="-5626.88" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="6401" y="-5611.88" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer8_gpu5&#45;&gt;route_layer8_gpu5 -->
<g id="edge806" class="edge">
<title>gate_layer8_gpu5&#45;&gt;route_layer8_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5971.47,-5735.98C6037.65,-5719.89 6117.12,-5700.58 6189.6,-5682.96"/>
<polygon fill="black" stroke="black" points="6190.43,-5686.36 6199.32,-5680.6 6188.77,-5679.56 6190.43,-5686.36"/>
</g>
<!-- route_layer8_gpu6 -->
<g id="node710" class="node">
<title>route_layer8_gpu6</title>
<path fill="orange" stroke="black" d="M7441.74,-5683.58C7441.74,-5683.58 6933.24,-5683.58 6933.24,-5683.58 6927.24,-5683.58 6916.5,-5679.91 6911.75,-5676.24 6911.75,-5676.24 6793.75,-5584.92 6793.75,-5584.92 6789,-5581.25 6790.26,-5577.58 6796.26,-5577.58 6796.26,-5577.58 7304.76,-5577.58 7304.76,-5577.58 7310.76,-5577.58 7321.5,-5581.25 7326.25,-5584.92 7326.25,-5584.92 7444.25,-5676.24 7444.25,-5676.24 7449,-5679.91 7447.74,-5683.58 7441.74,-5683.58"/>
<text text-anchor="middle" x="7119" y="-5641.88" font-family="Times,serif" font-size="14.00">Token Router Layer 8 GPU 6</text>
<text text-anchor="middle" x="7119" y="-5626.88" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="7119" y="-5611.88" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer8_gpu6&#45;&gt;route_layer8_gpu6 -->
<g id="edge807" class="edge">
<title>gate_layer8_gpu6&#45;&gt;route_layer8_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6886.23,-5730.33C6917.77,-5716.95 6953.31,-5701.87 6986.94,-5687.6"/>
<polygon fill="black" stroke="black" points="6988.54,-5690.73 6996.38,-5683.6 6985.8,-5684.29 6988.54,-5690.73"/>
</g>
<!-- route_layer8_gpu7 -->
<g id="node712" class="node">
<title>route_layer8_gpu7</title>
<path fill="orange" stroke="black" d="M8144.74,-5683.58C8144.74,-5683.58 7636.24,-5683.58 7636.24,-5683.58 7630.24,-5683.58 7619.5,-5679.91 7614.75,-5676.24 7614.75,-5676.24 7496.75,-5584.92 7496.75,-5584.92 7492,-5581.25 7493.26,-5577.58 7499.26,-5577.58 7499.26,-5577.58 8007.76,-5577.58 8007.76,-5577.58 8013.76,-5577.58 8024.5,-5581.25 8029.25,-5584.92 8029.25,-5584.92 8147.25,-5676.24 8147.25,-5676.24 8152,-5679.91 8150.74,-5683.58 8144.74,-5683.58"/>
<text text-anchor="middle" x="7822" y="-5641.88" font-family="Times,serif" font-size="14.00">Token Router Layer 8 GPU 7</text>
<text text-anchor="middle" x="7822" y="-5626.88" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="7822" y="-5611.88" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer8_gpu7&#45;&gt;route_layer8_gpu7 -->
<g id="edge808" class="edge">
<title>gate_layer8_gpu7&#45;&gt;route_layer8_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7777.33,-5722.22C7781.97,-5712.8 7786.89,-5702.82 7791.69,-5693.07"/>
<polygon fill="black" stroke="black" points="7794.97,-5694.33 7796.26,-5683.81 7788.7,-5691.24 7794.97,-5694.33"/>
</g>
<!-- route_layer8_gpu8 -->
<g id="node714" class="node">
<title>route_layer8_gpu8</title>
<path fill="orange" stroke="black" d="M8970.74,-5683.58C8970.74,-5683.58 8462.24,-5683.58 8462.24,-5683.58 8456.24,-5683.58 8445.5,-5679.91 8440.75,-5676.24 8440.75,-5676.24 8322.75,-5584.92 8322.75,-5584.92 8318,-5581.25 8319.26,-5577.58 8325.26,-5577.58 8325.26,-5577.58 8833.76,-5577.58 8833.76,-5577.58 8839.76,-5577.58 8850.5,-5581.25 8855.25,-5584.92 8855.25,-5584.92 8973.25,-5676.24 8973.25,-5676.24 8978,-5679.91 8976.74,-5683.58 8970.74,-5683.58"/>
<text text-anchor="middle" x="8648" y="-5641.88" font-family="Times,serif" font-size="14.00">Token Router Layer 8 GPU 8</text>
<text text-anchor="middle" x="8648" y="-5626.88" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="8648" y="-5611.88" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer8_gpu8&#45;&gt;route_layer8_gpu8 -->
<g id="edge809" class="edge">
<title>gate_layer8_gpu8&#45;&gt;route_layer8_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8692.67,-5722.22C8688.03,-5712.8 8683.11,-5702.82 8678.31,-5693.07"/>
<polygon fill="black" stroke="black" points="8681.3,-5691.24 8673.74,-5683.81 8675.03,-5694.33 8681.3,-5691.24"/>
</g>
<!-- route_layer8_gpu9 -->
<g id="node716" class="node">
<title>route_layer8_gpu9</title>
<path fill="orange" stroke="black" d="M9865.74,-5683.58C9865.74,-5683.58 9357.24,-5683.58 9357.24,-5683.58 9351.24,-5683.58 9340.5,-5679.91 9335.75,-5676.24 9335.75,-5676.24 9217.75,-5584.92 9217.75,-5584.92 9213,-5581.25 9214.26,-5577.58 9220.26,-5577.58 9220.26,-5577.58 9728.76,-5577.58 9728.76,-5577.58 9734.76,-5577.58 9745.5,-5581.25 9750.25,-5584.92 9750.25,-5584.92 9868.25,-5676.24 9868.25,-5676.24 9873,-5679.91 9871.74,-5683.58 9865.74,-5683.58"/>
<text text-anchor="middle" x="9543" y="-5641.88" font-family="Times,serif" font-size="14.00">Token Router Layer 8 GPU 9</text>
<text text-anchor="middle" x="9543" y="-5626.88" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="9543" y="-5611.88" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer8_gpu9&#45;&gt;route_layer8_gpu9 -->
<g id="edge810" class="edge">
<title>gate_layer8_gpu9&#45;&gt;route_layer8_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9634.66,-5724.57C9624.13,-5713.89 9612.8,-5702.39 9601.83,-5691.26"/>
<polygon fill="black" stroke="black" points="9604.19,-5688.67 9594.68,-5684.01 9599.2,-5693.59 9604.19,-5688.67"/>
</g>
<!-- route_layer8_gpu10 -->
<g id="node718" class="node">
<title>route_layer8_gpu10</title>
<path fill="orange" stroke="black" d="M10794.74,-5683.58C10794.74,-5683.58 10286.24,-5683.58 10286.24,-5683.58 10280.24,-5683.58 10269.5,-5679.91 10264.75,-5676.24 10264.75,-5676.24 10146.75,-5584.92 10146.75,-5584.92 10142,-5581.25 10143.26,-5577.58 10149.26,-5577.58 10149.26,-5577.58 10657.76,-5577.58 10657.76,-5577.58 10663.76,-5577.58 10674.5,-5581.25 10679.25,-5584.92 10679.25,-5584.92 10797.25,-5676.24 10797.25,-5676.24 10802,-5679.91 10800.74,-5683.58 10794.74,-5683.58"/>
<text text-anchor="middle" x="10472" y="-5641.88" font-family="Times,serif" font-size="14.00">Token Router Layer 8 GPU 10</text>
<text text-anchor="middle" x="10472" y="-5626.88" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="10472" y="-5611.88" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer8_gpu10&#45;&gt;route_layer8_gpu10 -->
<g id="edge811" class="edge">
<title>gate_layer8_gpu10&#45;&gt;route_layer8_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10588.35,-5725.74C10574.3,-5714.37 10559.05,-5702.03 10544.36,-5690.14"/>
<polygon fill="black" stroke="black" points="10546.24,-5687.16 10536.27,-5683.59 10541.84,-5692.6 10546.24,-5687.16"/>
</g>
<!-- route_layer8_gpu11 -->
<g id="node720" class="node">
<title>route_layer8_gpu11</title>
<path fill="orange" stroke="black" d="M11741.74,-5683.58C11741.74,-5683.58 11233.24,-5683.58 11233.24,-5683.58 11227.24,-5683.58 11216.5,-5679.91 11211.75,-5676.24 11211.75,-5676.24 11093.75,-5584.92 11093.75,-5584.92 11089,-5581.25 11090.26,-5577.58 11096.26,-5577.58 11096.26,-5577.58 11604.76,-5577.58 11604.76,-5577.58 11610.76,-5577.58 11621.5,-5581.25 11626.25,-5584.92 11626.25,-5584.92 11744.25,-5676.24 11744.25,-5676.24 11749,-5679.91 11747.74,-5683.58 11741.74,-5683.58"/>
<text text-anchor="middle" x="11419" y="-5641.88" font-family="Times,serif" font-size="14.00">Token Router Layer 8 GPU 11</text>
<text text-anchor="middle" x="11419" y="-5626.88" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="11419" y="-5611.88" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer8_gpu11&#45;&gt;route_layer8_gpu11 -->
<g id="edge812" class="edge">
<title>gate_layer8_gpu11&#45;&gt;route_layer8_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11547.57,-5726.32C11531.74,-5714.65 11514.47,-5701.92 11497.87,-5689.7"/>
<polygon fill="black" stroke="black" points="11499.92,-5686.86 11489.79,-5683.74 11495.77,-5692.49 11499.92,-5686.86"/>
</g>
<!-- route_layer8_gpu12 -->
<g id="node722" class="node">
<title>route_layer8_gpu12</title>
<path fill="orange" stroke="black" d="M12696.74,-5683.58C12696.74,-5683.58 12188.24,-5683.58 12188.24,-5683.58 12182.24,-5683.58 12171.5,-5679.91 12166.75,-5676.24 12166.75,-5676.24 12048.75,-5584.92 12048.75,-5584.92 12044,-5581.25 12045.26,-5577.58 12051.26,-5577.58 12051.26,-5577.58 12559.76,-5577.58 12559.76,-5577.58 12565.76,-5577.58 12576.5,-5581.25 12581.25,-5584.92 12581.25,-5584.92 12699.25,-5676.24 12699.25,-5676.24 12704,-5679.91 12702.74,-5683.58 12696.74,-5683.58"/>
<text text-anchor="middle" x="12374" y="-5641.88" font-family="Times,serif" font-size="14.00">Token Router Layer 8 GPU 12</text>
<text text-anchor="middle" x="12374" y="-5626.88" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="12374" y="-5611.88" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer8_gpu12&#45;&gt;route_layer8_gpu12 -->
<g id="edge813" class="edge">
<title>gate_layer8_gpu12&#45;&gt;route_layer8_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12509.21,-5726.71C12492.51,-5714.95 12474.25,-5702.11 12456.71,-5689.77"/>
<polygon fill="black" stroke="black" points="12458.36,-5686.65 12448.17,-5683.76 12454.34,-5692.38 12458.36,-5686.65"/>
</g>
<!-- route_layer8_gpu13 -->
<g id="node724" class="node">
<title>route_layer8_gpu13</title>
<path fill="orange" stroke="black" d="M13656.74,-5683.58C13656.74,-5683.58 13148.24,-5683.58 13148.24,-5683.58 13142.24,-5683.58 13131.5,-5679.91 13126.75,-5676.24 13126.75,-5676.24 13008.75,-5584.92 13008.75,-5584.92 13004,-5581.25 13005.26,-5577.58 13011.26,-5577.58 13011.26,-5577.58 13519.76,-5577.58 13519.76,-5577.58 13525.76,-5577.58 13536.5,-5581.25 13541.25,-5584.92 13541.25,-5584.92 13659.25,-5676.24 13659.25,-5676.24 13664,-5679.91 13662.74,-5683.58 13656.74,-5683.58"/>
<text text-anchor="middle" x="13334" y="-5641.88" font-family="Times,serif" font-size="14.00">Token Router Layer 8 GPU 13</text>
<text text-anchor="middle" x="13334" y="-5626.88" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="13334" y="-5611.88" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer8_gpu13&#45;&gt;route_layer8_gpu13 -->
<g id="edge814" class="edge">
<title>gate_layer8_gpu13&#45;&gt;route_layer8_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13471.93,-5726.71C13454.89,-5714.95 13436.27,-5702.11 13418.38,-5689.77"/>
<polygon fill="black" stroke="black" points="13419.88,-5686.56 13409.66,-5683.76 13415.91,-5692.32 13419.88,-5686.56"/>
</g>
<!-- route_layer8_gpu14 -->
<g id="node726" class="node">
<title>route_layer8_gpu14</title>
<path fill="orange" stroke="black" d="M14618.74,-5683.58C14618.74,-5683.58 14110.24,-5683.58 14110.24,-5683.58 14104.24,-5683.58 14093.5,-5679.91 14088.75,-5676.24 14088.75,-5676.24 13970.75,-5584.92 13970.75,-5584.92 13966,-5581.25 13967.26,-5577.58 13973.26,-5577.58 13973.26,-5577.58 14481.76,-5577.58 14481.76,-5577.58 14487.76,-5577.58 14498.5,-5581.25 14503.25,-5584.92 14503.25,-5584.92 14621.25,-5676.24 14621.25,-5676.24 14626,-5679.91 14624.74,-5683.58 14618.74,-5683.58"/>
<text text-anchor="middle" x="14296" y="-5641.88" font-family="Times,serif" font-size="14.00">Token Router Layer 8 GPU 14</text>
<text text-anchor="middle" x="14296" y="-5626.88" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="14296" y="-5611.88" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer8_gpu14&#45;&gt;route_layer8_gpu14 -->
<g id="edge815" class="edge">
<title>gate_layer8_gpu14&#45;&gt;route_layer8_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14435.57,-5726.9C14418.1,-5714.96 14398.96,-5701.89 14380.61,-5689.36"/>
<polygon fill="black" stroke="black" points="14382.47,-5686.39 14372.24,-5683.65 14378.52,-5692.18 14382.47,-5686.39"/>
</g>
<!-- route_layer8_gpu15 -->
<g id="node728" class="node">
<title>route_layer8_gpu15</title>
<path fill="orange" stroke="black" d="M15581.74,-5683.58C15581.74,-5683.58 15073.24,-5683.58 15073.24,-5683.58 15067.24,-5683.58 15056.5,-5679.91 15051.75,-5676.24 15051.75,-5676.24 14933.75,-5584.92 14933.75,-5584.92 14929,-5581.25 14930.26,-5577.58 14936.26,-5577.58 14936.26,-5577.58 15444.76,-5577.58 15444.76,-5577.58 15450.76,-5577.58 15461.5,-5581.25 15466.25,-5584.92 15466.25,-5584.92 15584.25,-5676.24 15584.25,-5676.24 15589,-5679.91 15587.74,-5683.58 15581.74,-5683.58"/>
<text text-anchor="middle" x="15259" y="-5641.88" font-family="Times,serif" font-size="14.00">Token Router Layer 8 GPU 15</text>
<text text-anchor="middle" x="15259" y="-5626.88" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="15259" y="-5611.88" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer8_gpu15&#45;&gt;route_layer8_gpu15 -->
<g id="edge816" class="edge">
<title>gate_layer8_gpu15&#45;&gt;route_layer8_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15399.25,-5726.9C15381.69,-5714.96 15362.46,-5701.89 15344.02,-5689.36"/>
<polygon fill="black" stroke="black" points="15345.85,-5686.37 15335.61,-5683.65 15341.91,-5692.16 15345.85,-5686.37"/>
</g>
<!-- expert_layer8_gpu0_expert0 -->
<g id="node682" class="node">
<title>expert_layer8_gpu0_expert0</title>
<path fill="lightcoral" stroke="black" d="M1801.5,-5430.63C1801.5,-5430.63 1332.5,-5430.63 1332.5,-5430.63 1326.5,-5430.63 1320.5,-5424.63 1320.5,-5418.63 1320.5,-5418.63 1320.5,-5374.63 1320.5,-5374.63 1320.5,-5368.63 1326.5,-5362.63 1332.5,-5362.63 1332.5,-5362.63 1801.5,-5362.63 1801.5,-5362.63 1807.5,-5362.63 1813.5,-5368.63 1813.5,-5374.63 1813.5,-5374.63 1813.5,-5418.63 1813.5,-5418.63 1813.5,-5424.63 1807.5,-5430.63 1801.5,-5430.63"/>
<text text-anchor="middle" x="1567" y="-5415.43" font-family="Times,serif" font-size="14.00">Expert 0 Layer 8 GPU 0</text>
<text text-anchor="middle" x="1567" y="-5400.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="1567" y="-5385.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="1567" y="-5370.43" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer8_gpu0 -->
<g id="node699" class="node">
<title>aggregate_layer8_gpu0</title>
<path fill="orange" stroke="black" d="M1801.29,-5326.63C1801.29,-5326.63 1314.19,-5326.63 1314.19,-5326.63 1308.19,-5326.63 1297.52,-5322.86 1292.85,-5319.09 1292.85,-5319.09 1180.06,-5228.16 1180.06,-5228.16 1175.38,-5224.39 1176.71,-5220.63 1182.71,-5220.63 1182.71,-5220.63 1669.81,-5220.63 1669.81,-5220.63 1675.81,-5220.63 1686.48,-5224.39 1691.15,-5228.16 1691.15,-5228.16 1803.94,-5319.09 1803.94,-5319.09 1808.62,-5322.86 1807.29,-5326.63 1801.29,-5326.63"/>
<text text-anchor="middle" x="1492" y="-5284.93" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 8 GPU 0</text>
<text text-anchor="middle" x="1492" y="-5269.93" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="1492" y="-5254.93" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer8_gpu0_expert0&#45;&gt;aggregate_layer8_gpu0 -->
<g id="edge849" class="edge">
<title>expert_layer8_gpu0_expert0&#45;&gt;aggregate_layer8_gpu0</title>
<path fill="none" stroke="black" d="M1546.51,-5362.56C1541.26,-5354.1 1535.45,-5344.72 1529.63,-5335.34"/>
<polygon fill="black" stroke="black" points="1532.55,-5333.41 1524.31,-5326.75 1526.6,-5337.1 1532.55,-5333.41"/>
</g>
<!-- expert_layer8_gpu1_expert1 -->
<g id="node683" class="node">
<title>expert_layer8_gpu1_expert1</title>
<path fill="lightcoral" stroke="black" d="M2746.5,-5430.63C2746.5,-5430.63 2277.5,-5430.63 2277.5,-5430.63 2271.5,-5430.63 2265.5,-5424.63 2265.5,-5418.63 2265.5,-5418.63 2265.5,-5374.63 2265.5,-5374.63 2265.5,-5368.63 2271.5,-5362.63 2277.5,-5362.63 2277.5,-5362.63 2746.5,-5362.63 2746.5,-5362.63 2752.5,-5362.63 2758.5,-5368.63 2758.5,-5374.63 2758.5,-5374.63 2758.5,-5418.63 2758.5,-5418.63 2758.5,-5424.63 2752.5,-5430.63 2746.5,-5430.63"/>
<text text-anchor="middle" x="2512" y="-5415.43" font-family="Times,serif" font-size="14.00">Expert 1 Layer 8 GPU 1</text>
<text text-anchor="middle" x="2512" y="-5400.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2512" y="-5385.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2512" y="-5370.43" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer8_gpu1 -->
<g id="node701" class="node">
<title>aggregate_layer8_gpu1</title>
<path fill="orange" stroke="black" d="M2689.29,-5326.63C2689.29,-5326.63 2202.19,-5326.63 2202.19,-5326.63 2196.19,-5326.63 2185.52,-5322.86 2180.85,-5319.09 2180.85,-5319.09 2068.06,-5228.16 2068.06,-5228.16 2063.38,-5224.39 2064.71,-5220.63 2070.71,-5220.63 2070.71,-5220.63 2557.81,-5220.63 2557.81,-5220.63 2563.81,-5220.63 2574.48,-5224.39 2579.15,-5228.16 2579.15,-5228.16 2691.94,-5319.09 2691.94,-5319.09 2696.62,-5322.86 2695.29,-5326.63 2689.29,-5326.63"/>
<text text-anchor="middle" x="2380" y="-5284.93" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 8 GPU 1</text>
<text text-anchor="middle" x="2380" y="-5269.93" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="2380" y="-5254.93" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer8_gpu1_expert1&#45;&gt;aggregate_layer8_gpu1 -->
<g id="edge850" class="edge">
<title>expert_layer8_gpu1_expert1&#45;&gt;aggregate_layer8_gpu1</title>
<path fill="none" stroke="black" d="M2475.93,-5362.56C2466.13,-5353.58 2455.21,-5343.57 2444.36,-5333.62"/>
<polygon fill="black" stroke="black" points="2446.6,-5330.93 2436.87,-5326.75 2441.87,-5336.09 2446.6,-5330.93"/>
</g>
<!-- expert_layer8_gpu2_expert2 -->
<g id="node684" class="node">
<title>expert_layer8_gpu2_expert2</title>
<path fill="lightcoral" stroke="black" d="M3806.5,-5430.63C3806.5,-5430.63 3337.5,-5430.63 3337.5,-5430.63 3331.5,-5430.63 3325.5,-5424.63 3325.5,-5418.63 3325.5,-5418.63 3325.5,-5374.63 3325.5,-5374.63 3325.5,-5368.63 3331.5,-5362.63 3337.5,-5362.63 3337.5,-5362.63 3806.5,-5362.63 3806.5,-5362.63 3812.5,-5362.63 3818.5,-5368.63 3818.5,-5374.63 3818.5,-5374.63 3818.5,-5418.63 3818.5,-5418.63 3818.5,-5424.63 3812.5,-5430.63 3806.5,-5430.63"/>
<text text-anchor="middle" x="3572" y="-5415.43" font-family="Times,serif" font-size="14.00">Expert 2 Layer 8 GPU 2</text>
<text text-anchor="middle" x="3572" y="-5400.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3572" y="-5385.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3572" y="-5370.43" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer8_gpu2 -->
<g id="node703" class="node">
<title>aggregate_layer8_gpu2</title>
<path fill="orange" stroke="black" d="M3692.29,-5326.63C3692.29,-5326.63 3205.19,-5326.63 3205.19,-5326.63 3199.19,-5326.63 3188.52,-5322.86 3183.85,-5319.09 3183.85,-5319.09 3071.06,-5228.16 3071.06,-5228.16 3066.38,-5224.39 3067.71,-5220.63 3073.71,-5220.63 3073.71,-5220.63 3560.81,-5220.63 3560.81,-5220.63 3566.81,-5220.63 3577.48,-5224.39 3582.15,-5228.16 3582.15,-5228.16 3694.94,-5319.09 3694.94,-5319.09 3699.62,-5322.86 3698.29,-5326.63 3692.29,-5326.63"/>
<text text-anchor="middle" x="3383" y="-5284.93" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 8 GPU 2</text>
<text text-anchor="middle" x="3383" y="-5269.93" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="3383" y="-5254.93" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer8_gpu2_expert2&#45;&gt;aggregate_layer8_gpu2 -->
<g id="edge851" class="edge">
<title>expert_layer8_gpu2_expert2&#45;&gt;aggregate_layer8_gpu2</title>
<path fill="none" stroke="black" d="M3520.35,-5362.56C3505.65,-5353.15 3489.19,-5342.61 3472.91,-5332.19"/>
<polygon fill="black" stroke="black" points="3474.73,-5329.2 3464.42,-5326.75 3470.96,-5335.09 3474.73,-5329.2"/>
</g>
<!-- expert_layer8_gpu3_expert3 -->
<g id="node685" class="node">
<title>expert_layer8_gpu3_expert3</title>
<path fill="lightcoral" stroke="black" d="M4718.5,-5430.63C4718.5,-5430.63 4249.5,-5430.63 4249.5,-5430.63 4243.5,-5430.63 4237.5,-5424.63 4237.5,-5418.63 4237.5,-5418.63 4237.5,-5374.63 4237.5,-5374.63 4237.5,-5368.63 4243.5,-5362.63 4249.5,-5362.63 4249.5,-5362.63 4718.5,-5362.63 4718.5,-5362.63 4724.5,-5362.63 4730.5,-5368.63 4730.5,-5374.63 4730.5,-5374.63 4730.5,-5418.63 4730.5,-5418.63 4730.5,-5424.63 4724.5,-5430.63 4718.5,-5430.63"/>
<text text-anchor="middle" x="4484" y="-5415.43" font-family="Times,serif" font-size="14.00">Expert 3 Layer 8 GPU 3</text>
<text text-anchor="middle" x="4484" y="-5400.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4484" y="-5385.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4484" y="-5370.43" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer8_gpu3 -->
<g id="node705" class="node">
<title>aggregate_layer8_gpu3</title>
<path fill="orange" stroke="black" d="M4429.29,-5326.63C4429.29,-5326.63 3942.19,-5326.63 3942.19,-5326.63 3936.19,-5326.63 3925.52,-5322.86 3920.85,-5319.09 3920.85,-5319.09 3808.06,-5228.16 3808.06,-5228.16 3803.38,-5224.39 3804.71,-5220.63 3810.71,-5220.63 3810.71,-5220.63 4297.81,-5220.63 4297.81,-5220.63 4303.81,-5220.63 4314.48,-5224.39 4319.15,-5228.16 4319.15,-5228.16 4431.94,-5319.09 4431.94,-5319.09 4436.62,-5322.86 4435.29,-5326.63 4429.29,-5326.63"/>
<text text-anchor="middle" x="4120" y="-5284.93" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 8 GPU 3</text>
<text text-anchor="middle" x="4120" y="-5269.93" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="4120" y="-5254.93" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer8_gpu3_expert3&#45;&gt;aggregate_layer8_gpu3 -->
<g id="edge852" class="edge">
<title>expert_layer8_gpu3_expert3&#45;&gt;aggregate_layer8_gpu3</title>
<path fill="none" stroke="black" d="M4384.54,-5362.56C4354.17,-5352.47 4319.91,-5341.08 4286.37,-5329.93"/>
<polygon fill="black" stroke="black" points="4287.06,-5326.47 4276.46,-5326.64 4284.85,-5333.11 4287.06,-5326.47"/>
</g>
<!-- expert_layer8_gpu4_expert4 -->
<g id="node686" class="node">
<title>expert_layer8_gpu4_expert4</title>
<path fill="lightcoral" stroke="black" d="M5951.5,-5430.63C5951.5,-5430.63 5482.5,-5430.63 5482.5,-5430.63 5476.5,-5430.63 5470.5,-5424.63 5470.5,-5418.63 5470.5,-5418.63 5470.5,-5374.63 5470.5,-5374.63 5470.5,-5368.63 5476.5,-5362.63 5482.5,-5362.63 5482.5,-5362.63 5951.5,-5362.63 5951.5,-5362.63 5957.5,-5362.63 5963.5,-5368.63 5963.5,-5374.63 5963.5,-5374.63 5963.5,-5418.63 5963.5,-5418.63 5963.5,-5424.63 5957.5,-5430.63 5951.5,-5430.63"/>
<text text-anchor="middle" x="5717" y="-5415.43" font-family="Times,serif" font-size="14.00">Expert 4 Layer 8 GPU 4</text>
<text text-anchor="middle" x="5717" y="-5400.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5717" y="-5385.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5717" y="-5370.43" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer8_gpu4 -->
<g id="node707" class="node">
<title>aggregate_layer8_gpu4</title>
<path fill="orange" stroke="black" d="M5707.29,-5326.63C5707.29,-5326.63 5220.19,-5326.63 5220.19,-5326.63 5214.19,-5326.63 5203.52,-5322.86 5198.85,-5319.09 5198.85,-5319.09 5086.06,-5228.16 5086.06,-5228.16 5081.38,-5224.39 5082.71,-5220.63 5088.71,-5220.63 5088.71,-5220.63 5575.81,-5220.63 5575.81,-5220.63 5581.81,-5220.63 5592.48,-5224.39 5597.15,-5228.16 5597.15,-5228.16 5709.94,-5319.09 5709.94,-5319.09 5714.62,-5322.86 5713.29,-5326.63 5707.29,-5326.63"/>
<text text-anchor="middle" x="5398" y="-5284.93" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 8 GPU 4</text>
<text text-anchor="middle" x="5398" y="-5269.93" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="5398" y="-5254.93" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer8_gpu4_expert4&#45;&gt;aggregate_layer8_gpu4 -->
<g id="edge853" class="edge">
<title>expert_layer8_gpu4_expert4&#45;&gt;aggregate_layer8_gpu4</title>
<path fill="none" stroke="black" d="M5629.83,-5362.56C5603.45,-5352.56 5573.71,-5341.28 5544.56,-5330.22"/>
<polygon fill="black" stroke="black" points="5545.71,-5326.91 5535.12,-5326.64 5543.23,-5333.46 5545.71,-5326.91"/>
</g>
<!-- expert_layer8_gpu5_expert5 -->
<g id="node687" class="node">
<title>expert_layer8_gpu5_expert5</title>
<path fill="lightcoral" stroke="black" d="M6757.5,-5430.63C6757.5,-5430.63 6288.5,-5430.63 6288.5,-5430.63 6282.5,-5430.63 6276.5,-5424.63 6276.5,-5418.63 6276.5,-5418.63 6276.5,-5374.63 6276.5,-5374.63 6276.5,-5368.63 6282.5,-5362.63 6288.5,-5362.63 6288.5,-5362.63 6757.5,-5362.63 6757.5,-5362.63 6763.5,-5362.63 6769.5,-5368.63 6769.5,-5374.63 6769.5,-5374.63 6769.5,-5418.63 6769.5,-5418.63 6769.5,-5424.63 6763.5,-5430.63 6757.5,-5430.63"/>
<text text-anchor="middle" x="6523" y="-5415.43" font-family="Times,serif" font-size="14.00">Expert 5 Layer 8 GPU 5</text>
<text text-anchor="middle" x="6523" y="-5400.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6523" y="-5385.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6523" y="-5370.43" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer8_gpu5 -->
<g id="node709" class="node">
<title>aggregate_layer8_gpu5</title>
<path fill="orange" stroke="black" d="M6562.29,-5326.63C6562.29,-5326.63 6075.19,-5326.63 6075.19,-5326.63 6069.19,-5326.63 6058.52,-5322.86 6053.85,-5319.09 6053.85,-5319.09 5941.06,-5228.16 5941.06,-5228.16 5936.38,-5224.39 5937.71,-5220.63 5943.71,-5220.63 5943.71,-5220.63 6430.81,-5220.63 6430.81,-5220.63 6436.81,-5220.63 6447.48,-5224.39 6452.15,-5228.16 6452.15,-5228.16 6564.94,-5319.09 6564.94,-5319.09 6569.62,-5322.86 6568.29,-5326.63 6562.29,-5326.63"/>
<text text-anchor="middle" x="6253" y="-5284.93" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 8 GPU 5</text>
<text text-anchor="middle" x="6253" y="-5269.93" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="6253" y="-5254.93" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer8_gpu5_expert5&#45;&gt;aggregate_layer8_gpu5 -->
<g id="edge854" class="edge">
<title>expert_layer8_gpu5_expert5&#45;&gt;aggregate_layer8_gpu5</title>
<path fill="none" stroke="black" d="M6449.22,-5362.56C6427.28,-5352.73 6402.59,-5341.67 6378.33,-5330.79"/>
<polygon fill="black" stroke="black" points="6379.62,-5327.53 6369.06,-5326.64 6376.75,-5333.92 6379.62,-5327.53"/>
</g>
<!-- expert_layer8_gpu6_expert6 -->
<g id="node688" class="node">
<title>expert_layer8_gpu6_expert6</title>
<path fill="lightcoral" stroke="black" d="M7391.5,-5430.63C7391.5,-5430.63 6922.5,-5430.63 6922.5,-5430.63 6916.5,-5430.63 6910.5,-5424.63 6910.5,-5418.63 6910.5,-5418.63 6910.5,-5374.63 6910.5,-5374.63 6910.5,-5368.63 6916.5,-5362.63 6922.5,-5362.63 6922.5,-5362.63 7391.5,-5362.63 7391.5,-5362.63 7397.5,-5362.63 7403.5,-5368.63 7403.5,-5374.63 7403.5,-5374.63 7403.5,-5418.63 7403.5,-5418.63 7403.5,-5424.63 7397.5,-5430.63 7391.5,-5430.63"/>
<text text-anchor="middle" x="7157" y="-5415.43" font-family="Times,serif" font-size="14.00">Expert 6 Layer 8 GPU 6</text>
<text text-anchor="middle" x="7157" y="-5400.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7157" y="-5385.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7157" y="-5370.43" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer8_gpu6 -->
<g id="node711" class="node">
<title>aggregate_layer8_gpu6</title>
<path fill="orange" stroke="black" d="M7320.29,-5326.63C7320.29,-5326.63 6833.19,-5326.63 6833.19,-5326.63 6827.19,-5326.63 6816.52,-5322.86 6811.85,-5319.09 6811.85,-5319.09 6699.06,-5228.16 6699.06,-5228.16 6694.38,-5224.39 6695.71,-5220.63 6701.71,-5220.63 6701.71,-5220.63 7188.81,-5220.63 7188.81,-5220.63 7194.81,-5220.63 7205.48,-5224.39 7210.15,-5228.16 7210.15,-5228.16 7322.94,-5319.09 7322.94,-5319.09 7327.62,-5322.86 7326.29,-5326.63 7320.29,-5326.63"/>
<text text-anchor="middle" x="7011" y="-5284.93" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 8 GPU 6</text>
<text text-anchor="middle" x="7011" y="-5269.93" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="7011" y="-5254.93" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer8_gpu6_expert6&#45;&gt;aggregate_layer8_gpu6 -->
<g id="edge855" class="edge">
<title>expert_layer8_gpu6_expert6&#45;&gt;aggregate_layer8_gpu6</title>
<path fill="none" stroke="black" d="M7117.1,-5362.56C7106.16,-5353.49 7093.96,-5343.38 7081.84,-5333.33"/>
<polygon fill="black" stroke="black" points="7083.83,-5330.44 7073.9,-5326.75 7079.36,-5335.83 7083.83,-5330.44"/>
</g>
<!-- expert_layer8_gpu7_expert7 -->
<g id="node689" class="node">
<title>expert_layer8_gpu7_expert7</title>
<path fill="lightcoral" stroke="black" d="M8100.5,-5430.63C8100.5,-5430.63 7631.5,-5430.63 7631.5,-5430.63 7625.5,-5430.63 7619.5,-5424.63 7619.5,-5418.63 7619.5,-5418.63 7619.5,-5374.63 7619.5,-5374.63 7619.5,-5368.63 7625.5,-5362.63 7631.5,-5362.63 7631.5,-5362.63 8100.5,-5362.63 8100.5,-5362.63 8106.5,-5362.63 8112.5,-5368.63 8112.5,-5374.63 8112.5,-5374.63 8112.5,-5418.63 8112.5,-5418.63 8112.5,-5424.63 8106.5,-5430.63 8100.5,-5430.63"/>
<text text-anchor="middle" x="7866" y="-5415.43" font-family="Times,serif" font-size="14.00">Expert 7 Layer 8 GPU 7</text>
<text text-anchor="middle" x="7866" y="-5400.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7866" y="-5385.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7866" y="-5370.43" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer8_gpu7 -->
<g id="node713" class="node">
<title>aggregate_layer8_gpu7</title>
<path fill="orange" stroke="black" d="M8130.29,-5326.63C8130.29,-5326.63 7643.19,-5326.63 7643.19,-5326.63 7637.19,-5326.63 7626.52,-5322.86 7621.85,-5319.09 7621.85,-5319.09 7509.06,-5228.16 7509.06,-5228.16 7504.38,-5224.39 7505.71,-5220.63 7511.71,-5220.63 7511.71,-5220.63 7998.81,-5220.63 7998.81,-5220.63 8004.81,-5220.63 8015.48,-5224.39 8020.15,-5228.16 8020.15,-5228.16 8132.94,-5319.09 8132.94,-5319.09 8137.62,-5322.86 8136.29,-5326.63 8130.29,-5326.63"/>
<text text-anchor="middle" x="7821" y="-5284.93" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 8 GPU 7</text>
<text text-anchor="middle" x="7821" y="-5269.93" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="7821" y="-5254.93" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer8_gpu7_expert7&#45;&gt;aggregate_layer8_gpu7 -->
<g id="edge856" class="edge">
<title>expert_layer8_gpu7_expert7&#45;&gt;aggregate_layer8_gpu7</title>
<path fill="none" stroke="black" d="M7853.7,-5362.56C7850.65,-5354.36 7847.28,-5345.3 7843.9,-5336.21"/>
<polygon fill="black" stroke="black" points="7847.15,-5334.91 7840.39,-5326.75 7840.59,-5337.35 7847.15,-5334.91"/>
</g>
<!-- expert_layer8_gpu8_expert8 -->
<g id="node690" class="node">
<title>expert_layer8_gpu8_expert8</title>
<path fill="lightcoral" stroke="black" d="M8700.5,-5430.63C8700.5,-5430.63 8231.5,-5430.63 8231.5,-5430.63 8225.5,-5430.63 8219.5,-5424.63 8219.5,-5418.63 8219.5,-5418.63 8219.5,-5374.63 8219.5,-5374.63 8219.5,-5368.63 8225.5,-5362.63 8231.5,-5362.63 8231.5,-5362.63 8700.5,-5362.63 8700.5,-5362.63 8706.5,-5362.63 8712.5,-5368.63 8712.5,-5374.63 8712.5,-5374.63 8712.5,-5418.63 8712.5,-5418.63 8712.5,-5424.63 8706.5,-5430.63 8700.5,-5430.63"/>
<text text-anchor="middle" x="8466" y="-5415.43" font-family="Times,serif" font-size="14.00">Expert 8 Layer 8 GPU 8</text>
<text text-anchor="middle" x="8466" y="-5400.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8466" y="-5385.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8466" y="-5370.43" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer8_gpu8 -->
<g id="node715" class="node">
<title>aggregate_layer8_gpu8</title>
<path fill="orange" stroke="black" d="M8820.29,-5326.63C8820.29,-5326.63 8333.19,-5326.63 8333.19,-5326.63 8327.19,-5326.63 8316.52,-5322.86 8311.85,-5319.09 8311.85,-5319.09 8199.06,-5228.16 8199.06,-5228.16 8194.38,-5224.39 8195.71,-5220.63 8201.71,-5220.63 8201.71,-5220.63 8688.81,-5220.63 8688.81,-5220.63 8694.81,-5220.63 8705.48,-5224.39 8710.15,-5228.16 8710.15,-5228.16 8822.94,-5319.09 8822.94,-5319.09 8827.62,-5322.86 8826.29,-5326.63 8820.29,-5326.63"/>
<text text-anchor="middle" x="8511" y="-5284.93" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 8 GPU 8</text>
<text text-anchor="middle" x="8511" y="-5269.93" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="8511" y="-5254.93" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer8_gpu8_expert8&#45;&gt;aggregate_layer8_gpu8 -->
<g id="edge857" class="edge">
<title>expert_layer8_gpu8_expert8&#45;&gt;aggregate_layer8_gpu8</title>
<path fill="none" stroke="black" d="M8478.3,-5362.56C8481.35,-5354.36 8484.72,-5345.3 8488.1,-5336.21"/>
<polygon fill="black" stroke="black" points="8491.41,-5337.35 8491.61,-5326.75 8484.85,-5334.91 8491.41,-5337.35"/>
</g>
<!-- expert_layer8_gpu9_expert9 -->
<g id="node691" class="node">
<title>expert_layer8_gpu9_expert9</title>
<path fill="lightcoral" stroke="black" d="M9338.5,-5430.63C9338.5,-5430.63 8869.5,-5430.63 8869.5,-5430.63 8863.5,-5430.63 8857.5,-5424.63 8857.5,-5418.63 8857.5,-5418.63 8857.5,-5374.63 8857.5,-5374.63 8857.5,-5368.63 8863.5,-5362.63 8869.5,-5362.63 8869.5,-5362.63 9338.5,-5362.63 9338.5,-5362.63 9344.5,-5362.63 9350.5,-5368.63 9350.5,-5374.63 9350.5,-5374.63 9350.5,-5418.63 9350.5,-5418.63 9350.5,-5424.63 9344.5,-5430.63 9338.5,-5430.63"/>
<text text-anchor="middle" x="9104" y="-5415.43" font-family="Times,serif" font-size="14.00">Expert 9 Layer 8 GPU 9</text>
<text text-anchor="middle" x="9104" y="-5400.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9104" y="-5385.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9104" y="-5370.43" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer8_gpu9 -->
<g id="node717" class="node">
<title>aggregate_layer8_gpu9</title>
<path fill="orange" stroke="black" d="M9496.29,-5326.63C9496.29,-5326.63 9009.19,-5326.63 9009.19,-5326.63 9003.19,-5326.63 8992.52,-5322.86 8987.85,-5319.09 8987.85,-5319.09 8875.06,-5228.16 8875.06,-5228.16 8870.38,-5224.39 8871.71,-5220.63 8877.71,-5220.63 8877.71,-5220.63 9364.81,-5220.63 9364.81,-5220.63 9370.81,-5220.63 9381.48,-5224.39 9386.15,-5228.16 9386.15,-5228.16 9498.94,-5319.09 9498.94,-5319.09 9503.62,-5322.86 9502.29,-5326.63 9496.29,-5326.63"/>
<text text-anchor="middle" x="9187" y="-5284.93" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 8 GPU 9</text>
<text text-anchor="middle" x="9187" y="-5269.93" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="9187" y="-5254.93" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer8_gpu9_expert9&#45;&gt;aggregate_layer8_gpu9 -->
<g id="edge858" class="edge">
<title>expert_layer8_gpu9_expert9&#45;&gt;aggregate_layer8_gpu9</title>
<path fill="none" stroke="black" d="M9126.68,-5362.56C9132.55,-5354.01 9139.05,-5344.53 9145.55,-5335.06"/>
<polygon fill="black" stroke="black" points="9148.47,-5336.98 9151.24,-5326.75 9142.7,-5333.02 9148.47,-5336.98"/>
</g>
<!-- expert_layer8_gpu10_expert10 -->
<g id="node692" class="node">
<title>expert_layer8_gpu10_expert10</title>
<path fill="lightcoral" stroke="black" d="M10187.5,-5430.63C10187.5,-5430.63 9718.5,-5430.63 9718.5,-5430.63 9712.5,-5430.63 9706.5,-5424.63 9706.5,-5418.63 9706.5,-5418.63 9706.5,-5374.63 9706.5,-5374.63 9706.5,-5368.63 9712.5,-5362.63 9718.5,-5362.63 9718.5,-5362.63 10187.5,-5362.63 10187.5,-5362.63 10193.5,-5362.63 10199.5,-5368.63 10199.5,-5374.63 10199.5,-5374.63 10199.5,-5418.63 10199.5,-5418.63 10199.5,-5424.63 10193.5,-5430.63 10187.5,-5430.63"/>
<text text-anchor="middle" x="9953" y="-5415.43" font-family="Times,serif" font-size="14.00">Expert 10 Layer 8 GPU 10</text>
<text text-anchor="middle" x="9953" y="-5400.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9953" y="-5385.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9953" y="-5370.43" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer8_gpu10 -->
<g id="node719" class="node">
<title>aggregate_layer8_gpu10</title>
<path fill="orange" stroke="black" d="M10556.29,-5326.63C10556.29,-5326.63 10069.19,-5326.63 10069.19,-5326.63 10063.19,-5326.63 10052.52,-5322.86 10047.85,-5319.09 10047.85,-5319.09 9935.06,-5228.16 9935.06,-5228.16 9930.38,-5224.39 9931.71,-5220.63 9937.71,-5220.63 9937.71,-5220.63 10424.81,-5220.63 10424.81,-5220.63 10430.81,-5220.63 10441.48,-5224.39 10446.15,-5228.16 10446.15,-5228.16 10558.94,-5319.09 10558.94,-5319.09 10563.62,-5322.86 10562.29,-5326.63 10556.29,-5326.63"/>
<text text-anchor="middle" x="10247" y="-5284.93" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 8 GPU 10</text>
<text text-anchor="middle" x="10247" y="-5269.93" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="10247" y="-5254.93" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer8_gpu10_expert10&#45;&gt;aggregate_layer8_gpu10 -->
<g id="edge859" class="edge">
<title>expert_layer8_gpu10_expert10&#45;&gt;aggregate_layer8_gpu10</title>
<path fill="none" stroke="black" d="M10033.34,-5362.56C10057.44,-5352.64 10084.58,-5341.47 10111.23,-5330.51"/>
<polygon fill="black" stroke="black" points="10112.71,-5333.68 10120.62,-5326.64 10110.05,-5327.21 10112.71,-5333.68"/>
</g>
<!-- expert_layer8_gpu11_expert11 -->
<g id="node693" class="node">
<title>expert_layer8_gpu11_expert11</title>
<path fill="lightcoral" stroke="black" d="M11096.5,-5430.63C11096.5,-5430.63 10627.5,-5430.63 10627.5,-5430.63 10621.5,-5430.63 10615.5,-5424.63 10615.5,-5418.63 10615.5,-5418.63 10615.5,-5374.63 10615.5,-5374.63 10615.5,-5368.63 10621.5,-5362.63 10627.5,-5362.63 10627.5,-5362.63 11096.5,-5362.63 11096.5,-5362.63 11102.5,-5362.63 11108.5,-5368.63 11108.5,-5374.63 11108.5,-5374.63 11108.5,-5418.63 11108.5,-5418.63 11108.5,-5424.63 11102.5,-5430.63 11096.5,-5430.63"/>
<text text-anchor="middle" x="10862" y="-5415.43" font-family="Times,serif" font-size="14.00">Expert 11 Layer 8 GPU 11</text>
<text text-anchor="middle" x="10862" y="-5400.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10862" y="-5385.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10862" y="-5370.43" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer8_gpu11 -->
<g id="node721" class="node">
<title>aggregate_layer8_gpu11</title>
<path fill="orange" stroke="black" d="M11525.29,-5326.63C11525.29,-5326.63 11038.19,-5326.63 11038.19,-5326.63 11032.19,-5326.63 11021.52,-5322.86 11016.85,-5319.09 11016.85,-5319.09 10904.06,-5228.16 10904.06,-5228.16 10899.38,-5224.39 10900.71,-5220.63 10906.71,-5220.63 10906.71,-5220.63 11393.81,-5220.63 11393.81,-5220.63 11399.81,-5220.63 11410.48,-5224.39 11415.15,-5228.16 11415.15,-5228.16 11527.94,-5319.09 11527.94,-5319.09 11532.62,-5322.86 11531.29,-5326.63 11525.29,-5326.63"/>
<text text-anchor="middle" x="11216" y="-5284.93" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 8 GPU 11</text>
<text text-anchor="middle" x="11216" y="-5269.93" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="11216" y="-5254.93" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer8_gpu11_expert11&#45;&gt;aggregate_layer8_gpu11 -->
<g id="edge860" class="edge">
<title>expert_layer8_gpu11_expert11&#45;&gt;aggregate_layer8_gpu11</title>
<path fill="none" stroke="black" d="M10958.73,-5362.56C10988.26,-5352.47 11021.58,-5341.08 11054.2,-5329.93"/>
<polygon fill="black" stroke="black" points="11055.5,-5333.18 11063.83,-5326.64 11053.24,-5326.56 11055.5,-5333.18"/>
</g>
<!-- expert_layer8_gpu12_expert12 -->
<g id="node694" class="node">
<title>expert_layer8_gpu12_expert12</title>
<path fill="lightcoral" stroke="black" d="M11958.5,-5430.63C11958.5,-5430.63 11489.5,-5430.63 11489.5,-5430.63 11483.5,-5430.63 11477.5,-5424.63 11477.5,-5418.63 11477.5,-5418.63 11477.5,-5374.63 11477.5,-5374.63 11477.5,-5368.63 11483.5,-5362.63 11489.5,-5362.63 11489.5,-5362.63 11958.5,-5362.63 11958.5,-5362.63 11964.5,-5362.63 11970.5,-5368.63 11970.5,-5374.63 11970.5,-5374.63 11970.5,-5418.63 11970.5,-5418.63 11970.5,-5424.63 11964.5,-5430.63 11958.5,-5430.63"/>
<text text-anchor="middle" x="11724" y="-5415.43" font-family="Times,serif" font-size="14.00">Expert 12 Layer 8 GPU 12</text>
<text text-anchor="middle" x="11724" y="-5400.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11724" y="-5385.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11724" y="-5370.43" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer8_gpu12 -->
<g id="node723" class="node">
<title>aggregate_layer8_gpu12</title>
<path fill="orange" stroke="black" d="M12340.29,-5326.63C12340.29,-5326.63 11853.19,-5326.63 11853.19,-5326.63 11847.19,-5326.63 11836.52,-5322.86 11831.85,-5319.09 11831.85,-5319.09 11719.06,-5228.16 11719.06,-5228.16 11714.38,-5224.39 11715.71,-5220.63 11721.71,-5220.63 11721.71,-5220.63 12208.81,-5220.63 12208.81,-5220.63 12214.81,-5220.63 12225.48,-5224.39 12230.15,-5228.16 12230.15,-5228.16 12342.94,-5319.09 12342.94,-5319.09 12347.62,-5322.86 12346.29,-5326.63 12340.29,-5326.63"/>
<text text-anchor="middle" x="12031" y="-5284.93" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 8 GPU 12</text>
<text text-anchor="middle" x="12031" y="-5269.93" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="12031" y="-5254.93" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer8_gpu12_expert12&#45;&gt;aggregate_layer8_gpu12 -->
<g id="edge861" class="edge">
<title>expert_layer8_gpu12_expert12&#45;&gt;aggregate_layer8_gpu12</title>
<path fill="none" stroke="black" d="M11807.89,-5362.56C11833.17,-5352.6 11861.65,-5341.37 11889.59,-5330.36"/>
<polygon fill="black" stroke="black" points="11891.02,-5333.56 11899.04,-5326.64 11888.45,-5327.05 11891.02,-5333.56"/>
</g>
<!-- expert_layer8_gpu13_expert13 -->
<g id="node695" class="node">
<title>expert_layer8_gpu13_expert13</title>
<path fill="lightcoral" stroke="black" d="M12910.5,-5430.63C12910.5,-5430.63 12441.5,-5430.63 12441.5,-5430.63 12435.5,-5430.63 12429.5,-5424.63 12429.5,-5418.63 12429.5,-5418.63 12429.5,-5374.63 12429.5,-5374.63 12429.5,-5368.63 12435.5,-5362.63 12441.5,-5362.63 12441.5,-5362.63 12910.5,-5362.63 12910.5,-5362.63 12916.5,-5362.63 12922.5,-5368.63 12922.5,-5374.63 12922.5,-5374.63 12922.5,-5418.63 12922.5,-5418.63 12922.5,-5424.63 12916.5,-5430.63 12910.5,-5430.63"/>
<text text-anchor="middle" x="12676" y="-5415.43" font-family="Times,serif" font-size="14.00">Expert 13 Layer 8 GPU 13</text>
<text text-anchor="middle" x="12676" y="-5400.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12676" y="-5385.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12676" y="-5370.43" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer8_gpu13 -->
<g id="node725" class="node">
<title>aggregate_layer8_gpu13</title>
<path fill="orange" stroke="black" d="M13381.29,-5326.63C13381.29,-5326.63 12894.19,-5326.63 12894.19,-5326.63 12888.19,-5326.63 12877.52,-5322.86 12872.85,-5319.09 12872.85,-5319.09 12760.06,-5228.16 12760.06,-5228.16 12755.38,-5224.39 12756.71,-5220.63 12762.71,-5220.63 12762.71,-5220.63 13249.81,-5220.63 13249.81,-5220.63 13255.81,-5220.63 13266.48,-5224.39 13271.15,-5228.16 13271.15,-5228.16 13383.94,-5319.09 13383.94,-5319.09 13388.62,-5322.86 13387.29,-5326.63 13381.29,-5326.63"/>
<text text-anchor="middle" x="13072" y="-5284.93" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 8 GPU 13</text>
<text text-anchor="middle" x="13072" y="-5269.93" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="13072" y="-5254.93" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer8_gpu13_expert13&#45;&gt;aggregate_layer8_gpu13 -->
<g id="edge862" class="edge">
<title>expert_layer8_gpu13_expert13&#45;&gt;aggregate_layer8_gpu13</title>
<path fill="none" stroke="black" d="M12784.21,-5362.56C12817.53,-5352.38 12855.15,-5340.89 12891.94,-5329.64"/>
<polygon fill="black" stroke="black" points="12893.24,-5332.91 12901.78,-5326.64 12891.19,-5326.21 12893.24,-5332.91"/>
</g>
<!-- expert_layer8_gpu14_expert14 -->
<g id="node696" class="node">
<title>expert_layer8_gpu14_expert14</title>
<path fill="lightcoral" stroke="black" d="M13811.5,-5430.63C13811.5,-5430.63 13342.5,-5430.63 13342.5,-5430.63 13336.5,-5430.63 13330.5,-5424.63 13330.5,-5418.63 13330.5,-5418.63 13330.5,-5374.63 13330.5,-5374.63 13330.5,-5368.63 13336.5,-5362.63 13342.5,-5362.63 13342.5,-5362.63 13811.5,-5362.63 13811.5,-5362.63 13817.5,-5362.63 13823.5,-5368.63 13823.5,-5374.63 13823.5,-5374.63 13823.5,-5418.63 13823.5,-5418.63 13823.5,-5424.63 13817.5,-5430.63 13811.5,-5430.63"/>
<text text-anchor="middle" x="13577" y="-5415.43" font-family="Times,serif" font-size="14.00">Expert 14 Layer 8 GPU 14</text>
<text text-anchor="middle" x="13577" y="-5400.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="13577" y="-5385.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="13577" y="-5370.43" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer8_gpu14 -->
<g id="node727" class="node">
<title>aggregate_layer8_gpu14</title>
<path fill="orange" stroke="black" d="M14232.29,-5326.63C14232.29,-5326.63 13745.19,-5326.63 13745.19,-5326.63 13739.19,-5326.63 13728.52,-5322.86 13723.85,-5319.09 13723.85,-5319.09 13611.06,-5228.16 13611.06,-5228.16 13606.38,-5224.39 13607.71,-5220.63 13613.71,-5220.63 13613.71,-5220.63 14100.81,-5220.63 14100.81,-5220.63 14106.81,-5220.63 14117.48,-5224.39 14122.15,-5228.16 14122.15,-5228.16 14234.94,-5319.09 14234.94,-5319.09 14239.62,-5322.86 14238.29,-5326.63 14232.29,-5326.63"/>
<text text-anchor="middle" x="13923" y="-5284.93" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 8 GPU 14</text>
<text text-anchor="middle" x="13923" y="-5269.93" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="13923" y="-5254.93" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer8_gpu14_expert14&#45;&gt;aggregate_layer8_gpu14 -->
<g id="edge863" class="edge">
<title>expert_layer8_gpu14_expert14&#45;&gt;aggregate_layer8_gpu14</title>
<path fill="none" stroke="black" d="M13671.55,-5362.56C13700.29,-5352.51 13732.69,-5341.18 13764.44,-5330.08"/>
<polygon fill="black" stroke="black" points="13765.99,-5333.24 13774.27,-5326.64 13763.68,-5326.64 13765.99,-5333.24"/>
</g>
<!-- expert_layer8_gpu15_expert15 -->
<g id="node697" class="node">
<title>expert_layer8_gpu15_expert15</title>
<path fill="lightcoral" stroke="black" d="M14640.5,-5430.63C14640.5,-5430.63 14171.5,-5430.63 14171.5,-5430.63 14165.5,-5430.63 14159.5,-5424.63 14159.5,-5418.63 14159.5,-5418.63 14159.5,-5374.63 14159.5,-5374.63 14159.5,-5368.63 14165.5,-5362.63 14171.5,-5362.63 14171.5,-5362.63 14640.5,-5362.63 14640.5,-5362.63 14646.5,-5362.63 14652.5,-5368.63 14652.5,-5374.63 14652.5,-5374.63 14652.5,-5418.63 14652.5,-5418.63 14652.5,-5424.63 14646.5,-5430.63 14640.5,-5430.63"/>
<text text-anchor="middle" x="14406" y="-5415.43" font-family="Times,serif" font-size="14.00">Expert 15 Layer 8 GPU 15</text>
<text text-anchor="middle" x="14406" y="-5400.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14406" y="-5385.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14406" y="-5370.43" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer8_gpu15 -->
<g id="node729" class="node">
<title>aggregate_layer8_gpu15</title>
<path fill="orange" stroke="black" d="M14988.29,-5326.63C14988.29,-5326.63 14501.19,-5326.63 14501.19,-5326.63 14495.19,-5326.63 14484.52,-5322.86 14479.85,-5319.09 14479.85,-5319.09 14367.06,-5228.16 14367.06,-5228.16 14362.38,-5224.39 14363.71,-5220.63 14369.71,-5220.63 14369.71,-5220.63 14856.81,-5220.63 14856.81,-5220.63 14862.81,-5220.63 14873.48,-5224.39 14878.15,-5228.16 14878.15,-5228.16 14990.94,-5319.09 14990.94,-5319.09 14995.62,-5322.86 14994.29,-5326.63 14988.29,-5326.63"/>
<text text-anchor="middle" x="14679" y="-5284.93" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 8 GPU 15</text>
<text text-anchor="middle" x="14679" y="-5269.93" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="14679" y="-5254.93" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer8_gpu15_expert15&#45;&gt;aggregate_layer8_gpu15 -->
<g id="edge864" class="edge">
<title>expert_layer8_gpu15_expert15&#45;&gt;aggregate_layer8_gpu15</title>
<path fill="none" stroke="black" d="M14480.6,-5362.56C14502.79,-5352.73 14527.74,-5341.67 14552.28,-5330.79"/>
<polygon fill="black" stroke="black" points="14553.93,-5333.89 14561.65,-5326.64 14551.09,-5327.49 14553.93,-5333.89"/>
</g>
<!-- comm_layer8 -->
<g id="node730" class="node">
<title>comm_layer8</title>
<ellipse fill="lightpink" stroke="black" cx="8166" cy="-5504.1" rx="243.49" ry="37.45"/>
<text text-anchor="middle" x="8166" y="-5515.4" font-family="Times,serif" font-size="14.00">Cross&#45;GPU Communication Layer 8</text>
<text text-anchor="middle" x="8166" y="-5500.4" font-family="Times,serif" font-size="14.00">Input: Tokens from routing decisions</text>
<text text-anchor="middle" x="8166" y="-5485.4" font-family="Times,serif" font-size="14.00">Output: Tokens delivered to destination GPUs</text>
</g>
<!-- route_layer8_gpu0&#45;&gt;comm_layer8 -->
<g id="edge817" class="edge">
<title>route_layer8_gpu0&#45;&gt;comm_layer8</title>
<path fill="none" stroke="black" d="M1339.85,-5617.65C1603.4,-5605.53 2030.83,-5587.23 2400,-5577.58 4531.27,-5521.9 7106.83,-5508.7 7912.6,-5505.84"/>
<polygon fill="black" stroke="black" points="7912.88,-5509.34 7922.87,-5505.8 7912.86,-5502.34 7912.88,-5509.34"/>
</g>
<!-- mha_layer9_gpu0 -->
<g id="node731" class="node">
<title>mha_layer9_gpu0</title>
<path fill="lightblue" stroke="black" d="M1375,-5184.63C1375,-5184.63 927,-5184.63 927,-5184.63 921,-5184.63 915,-5178.63 915,-5172.63 915,-5172.63 915,-5143.63 915,-5143.63 915,-5137.63 921,-5131.63 927,-5131.63 927,-5131.63 1375,-5131.63 1375,-5131.63 1381,-5131.63 1387,-5137.63 1387,-5143.63 1387,-5143.63 1387,-5172.63 1387,-5172.63 1387,-5178.63 1381,-5184.63 1375,-5184.63"/>
<text text-anchor="middle" x="1151" y="-5169.43" font-family="Times,serif" font-size="14.00">MHA Layer 9 GPU 0</text>
<text text-anchor="middle" x="1151" y="-5154.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1151" y="-5139.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer8_gpu0&#45;&gt;mha_layer9_gpu0 -->
<g id="edge865" class="edge">
<title>aggregate_layer8_gpu0&#45;&gt;mha_layer9_gpu0</title>
<path fill="none" stroke="black" d="M1335.47,-5220.53C1301.66,-5209.27 1267.12,-5197.78 1237.2,-5187.82"/>
<polygon fill="black" stroke="black" points="1238.25,-5184.48 1227.65,-5184.64 1236.04,-5191.12 1238.25,-5184.48"/>
</g>
<!-- route_layer8_gpu1&#45;&gt;comm_layer8 -->
<g id="edge818" class="edge">
<title>route_layer8_gpu1&#45;&gt;comm_layer8</title>
<path fill="none" stroke="black" d="M2985.85,-5611.37C3150.66,-5599.69 3373.88,-5585.33 3571,-5577.58 5225.85,-5512.54 7218.1,-5505.32 7912.59,-5504.92"/>
<polygon fill="black" stroke="black" points="7912.73,-5508.42 7922.72,-5504.91 7912.72,-5501.42 7912.73,-5508.42"/>
</g>
<!-- mha_layer9_gpu1 -->
<g id="node732" class="node">
<title>mha_layer9_gpu1</title>
<path fill="lightblue" stroke="black" d="M2301,-5184.63C2301,-5184.63 1853,-5184.63 1853,-5184.63 1847,-5184.63 1841,-5178.63 1841,-5172.63 1841,-5172.63 1841,-5143.63 1841,-5143.63 1841,-5137.63 1847,-5131.63 1853,-5131.63 1853,-5131.63 2301,-5131.63 2301,-5131.63 2307,-5131.63 2313,-5137.63 2313,-5143.63 2313,-5143.63 2313,-5172.63 2313,-5172.63 2313,-5178.63 2307,-5184.63 2301,-5184.63"/>
<text text-anchor="middle" x="2077" y="-5169.43" font-family="Times,serif" font-size="14.00">MHA Layer 9 GPU 1</text>
<text text-anchor="middle" x="2077" y="-5154.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2077" y="-5139.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer8_gpu1&#45;&gt;mha_layer9_gpu1 -->
<g id="edge866" class="edge">
<title>aggregate_layer8_gpu1&#45;&gt;mha_layer9_gpu1</title>
<path fill="none" stroke="black" d="M2240.92,-5220.53C2211.26,-5209.42 2180.97,-5198.07 2154.63,-5188.21"/>
<polygon fill="black" stroke="black" points="2155.7,-5184.87 2145.11,-5184.64 2153.25,-5191.43 2155.7,-5184.87"/>
</g>
<!-- route_layer8_gpu2&#45;&gt;comm_layer8 -->
<g id="edge819" class="edge">
<title>route_layer8_gpu2&#45;&gt;comm_layer8</title>
<path fill="none" stroke="black" d="M4148.52,-5605.11C4255.51,-5594.85 4384.06,-5583.87 4500,-5577.58 5166.03,-5541.44 7198.22,-5515.9 7913.6,-5507.82"/>
<polygon fill="black" stroke="black" points="7913.82,-5511.32 7923.78,-5507.71 7913.74,-5504.32 7913.82,-5511.32"/>
</g>
<!-- mha_layer9_gpu2 -->
<g id="node733" class="node">
<title>mha_layer9_gpu2</title>
<path fill="lightblue" stroke="black" d="M3456,-5184.63C3456,-5184.63 3008,-5184.63 3008,-5184.63 3002,-5184.63 2996,-5178.63 2996,-5172.63 2996,-5172.63 2996,-5143.63 2996,-5143.63 2996,-5137.63 3002,-5131.63 3008,-5131.63 3008,-5131.63 3456,-5131.63 3456,-5131.63 3462,-5131.63 3468,-5137.63 3468,-5143.63 3468,-5143.63 3468,-5172.63 3468,-5172.63 3468,-5178.63 3462,-5184.63 3456,-5184.63"/>
<text text-anchor="middle" x="3232" y="-5169.43" font-family="Times,serif" font-size="14.00">MHA Layer 9 GPU 2</text>
<text text-anchor="middle" x="3232" y="-5154.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3232" y="-5139.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer8_gpu2&#45;&gt;mha_layer9_gpu2 -->
<g id="edge867" class="edge">
<title>aggregate_layer8_gpu2&#45;&gt;mha_layer9_gpu2</title>
<path fill="none" stroke="black" d="M3313.69,-5220.53C3300.21,-5210.39 3286.46,-5200.06 3274.19,-5190.84"/>
<polygon fill="black" stroke="black" points="3276.04,-5187.85 3265.94,-5184.64 3271.83,-5193.45 3276.04,-5187.85"/>
</g>
<!-- route_layer8_gpu3&#45;&gt;comm_layer8 -->
<g id="edge820" class="edge">
<title>route_layer8_gpu3&#45;&gt;comm_layer8</title>
<path fill="none" stroke="black" d="M5071.29,-5600.21C5146.8,-5591.51 5231.4,-5582.89 5309,-5577.58 6268.59,-5511.88 7413.14,-5504.12 7912.29,-5504.23"/>
<polygon fill="black" stroke="black" points="7912.5,-5507.73 7922.5,-5504.23 7912.5,-5500.73 7912.5,-5507.73"/>
</g>
<!-- mha_layer9_gpu3 -->
<g id="node734" class="node">
<title>mha_layer9_gpu3</title>
<path fill="lightblue" stroke="black" d="M4192,-5184.63C4192,-5184.63 3744,-5184.63 3744,-5184.63 3738,-5184.63 3732,-5178.63 3732,-5172.63 3732,-5172.63 3732,-5143.63 3732,-5143.63 3732,-5137.63 3738,-5131.63 3744,-5131.63 3744,-5131.63 4192,-5131.63 4192,-5131.63 4198,-5131.63 4204,-5137.63 4204,-5143.63 4204,-5143.63 4204,-5172.63 4204,-5172.63 4204,-5178.63 4198,-5184.63 4192,-5184.63"/>
<text text-anchor="middle" x="3968" y="-5169.43" font-family="Times,serif" font-size="14.00">MHA Layer 9 GPU 3</text>
<text text-anchor="middle" x="3968" y="-5154.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3968" y="-5139.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer8_gpu3&#45;&gt;mha_layer9_gpu3 -->
<g id="edge868" class="edge">
<title>aggregate_layer8_gpu3&#45;&gt;mha_layer9_gpu3</title>
<path fill="none" stroke="black" d="M4050.23,-5220.53C4036.66,-5210.39 4022.82,-5200.06 4010.46,-5190.84"/>
<polygon fill="black" stroke="black" points="4012.27,-5187.82 4002.17,-5184.64 4008.09,-5193.43 4012.27,-5187.82"/>
</g>
<!-- route_layer8_gpu4&#45;&gt;comm_layer8 -->
<g id="edge821" class="edge">
<title>route_layer8_gpu4&#45;&gt;comm_layer8</title>
<path fill="none" stroke="black" d="M5876.19,-5597.06C5934.89,-5589.54 5998.23,-5582.36 6057,-5577.58 6725.41,-5523.2 7516.21,-5509.53 7912.65,-5506.16"/>
<polygon fill="black" stroke="black" points="7912.84,-5509.66 7922.81,-5506.07 7912.78,-5502.66 7912.84,-5509.66"/>
</g>
<!-- mha_layer9_gpu4 -->
<g id="node735" class="node">
<title>mha_layer9_gpu4</title>
<path fill="lightblue" stroke="black" d="M5319,-5184.63C5319,-5184.63 4871,-5184.63 4871,-5184.63 4865,-5184.63 4859,-5178.63 4859,-5172.63 4859,-5172.63 4859,-5143.63 4859,-5143.63 4859,-5137.63 4865,-5131.63 4871,-5131.63 4871,-5131.63 5319,-5131.63 5319,-5131.63 5325,-5131.63 5331,-5137.63 5331,-5143.63 5331,-5143.63 5331,-5172.63 5331,-5172.63 5331,-5178.63 5325,-5184.63 5319,-5184.63"/>
<text text-anchor="middle" x="5095" y="-5169.43" font-family="Times,serif" font-size="14.00">MHA Layer 9 GPU 4</text>
<text text-anchor="middle" x="5095" y="-5154.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5095" y="-5139.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer8_gpu4&#45;&gt;mha_layer9_gpu4 -->
<g id="edge869" class="edge">
<title>aggregate_layer8_gpu4&#45;&gt;mha_layer9_gpu4</title>
<path fill="none" stroke="black" d="M5258.92,-5220.53C5229.26,-5209.42 5198.97,-5198.07 5172.63,-5188.21"/>
<polygon fill="black" stroke="black" points="5173.7,-5184.87 5163.11,-5184.64 5171.25,-5191.43 5173.7,-5184.87"/>
</g>
<!-- route_layer8_gpu5&#45;&gt;comm_layer8 -->
<g id="edge822" class="edge">
<title>route_layer8_gpu5&#45;&gt;comm_layer8</title>
<path fill="none" stroke="black" d="M6622.12,-5595.62C6672.29,-5588.82 6725.4,-5582.31 6775,-5577.58 7173.45,-5539.57 7638.14,-5520.41 7916.85,-5511.62"/>
<polygon fill="black" stroke="black" points="7917.21,-5515.11 7927.1,-5511.3 7916.99,-5508.11 7917.21,-5515.11"/>
</g>
<!-- mha_layer9_gpu5 -->
<g id="node736" class="node">
<title>mha_layer9_gpu5</title>
<path fill="lightblue" stroke="black" d="M6332,-5184.63C6332,-5184.63 5884,-5184.63 5884,-5184.63 5878,-5184.63 5872,-5178.63 5872,-5172.63 5872,-5172.63 5872,-5143.63 5872,-5143.63 5872,-5137.63 5878,-5131.63 5884,-5131.63 5884,-5131.63 6332,-5131.63 6332,-5131.63 6338,-5131.63 6344,-5137.63 6344,-5143.63 6344,-5143.63 6344,-5172.63 6344,-5172.63 6344,-5178.63 6338,-5184.63 6332,-5184.63"/>
<text text-anchor="middle" x="6108" y="-5169.43" font-family="Times,serif" font-size="14.00">MHA Layer 9 GPU 5</text>
<text text-anchor="middle" x="6108" y="-5154.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6108" y="-5139.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer8_gpu5&#45;&gt;mha_layer9_gpu5 -->
<g id="edge870" class="edge">
<title>aggregate_layer8_gpu5&#45;&gt;mha_layer9_gpu5</title>
<path fill="none" stroke="black" d="M6186.44,-5220.53C6173.5,-5210.39 6160.3,-5200.06 6148.51,-5190.84"/>
<polygon fill="black" stroke="black" points="6150.63,-5188.05 6140.59,-5184.64 6146.31,-5193.56 6150.63,-5188.05"/>
</g>
<!-- route_layer8_gpu6&#45;&gt;comm_layer8 -->
<g id="edge823" class="edge">
<title>route_layer8_gpu6&#45;&gt;comm_layer8</title>
<path fill="none" stroke="black" d="M7340.96,-5596.05C7386.26,-5589.6 7433.63,-5583.13 7478,-5577.58 7636.41,-5557.77 7815.81,-5538.99 7951.68,-5525.52"/>
<polygon fill="black" stroke="black" points="7952.2,-5528.98 7961.8,-5524.51 7951.51,-5522.02 7952.2,-5528.98"/>
</g>
<!-- mha_layer9_gpu6 -->
<g id="node737" class="node">
<title>mha_layer9_gpu6</title>
<path fill="lightblue" stroke="black" d="M7150,-5184.63C7150,-5184.63 6702,-5184.63 6702,-5184.63 6696,-5184.63 6690,-5178.63 6690,-5172.63 6690,-5172.63 6690,-5143.63 6690,-5143.63 6690,-5137.63 6696,-5131.63 6702,-5131.63 6702,-5131.63 7150,-5131.63 7150,-5131.63 7156,-5131.63 7162,-5137.63 7162,-5143.63 7162,-5143.63 7162,-5172.63 7162,-5172.63 7162,-5178.63 7156,-5184.63 7150,-5184.63"/>
<text text-anchor="middle" x="6926" y="-5169.43" font-family="Times,serif" font-size="14.00">MHA Layer 9 GPU 6</text>
<text text-anchor="middle" x="6926" y="-5154.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6926" y="-5139.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer8_gpu6&#45;&gt;mha_layer9_gpu6 -->
<g id="edge871" class="edge">
<title>aggregate_layer8_gpu6&#45;&gt;mha_layer9_gpu6</title>
<path fill="none" stroke="black" d="M6971.98,-5220.53C6964.91,-5211.08 6957.7,-5201.45 6951.15,-5192.71"/>
<polygon fill="black" stroke="black" points="6953.9,-5190.55 6945.11,-5184.64 6948.3,-5194.74 6953.9,-5190.55"/>
</g>
<!-- route_layer8_gpu7&#45;&gt;comm_layer8 -->
<g id="edge824" class="edge">
<title>route_layer8_gpu7&#45;&gt;comm_layer8</title>
<path fill="none" stroke="black" d="M7965.89,-5577.51C7998.54,-5565.7 8032.57,-5553.38 8063.12,-5542.33"/>
<polygon fill="black" stroke="black" points="8064.69,-5545.48 8072.91,-5538.79 8062.31,-5538.9 8064.69,-5545.48"/>
</g>
<!-- mha_layer9_gpu7 -->
<g id="node738" class="node">
<title>mha_layer9_gpu7</title>
<path fill="lightblue" stroke="black" d="M7979,-5184.63C7979,-5184.63 7531,-5184.63 7531,-5184.63 7525,-5184.63 7519,-5178.63 7519,-5172.63 7519,-5172.63 7519,-5143.63 7519,-5143.63 7519,-5137.63 7525,-5131.63 7531,-5131.63 7531,-5131.63 7979,-5131.63 7979,-5131.63 7985,-5131.63 7991,-5137.63 7991,-5143.63 7991,-5143.63 7991,-5172.63 7991,-5172.63 7991,-5178.63 7985,-5184.63 7979,-5184.63"/>
<text text-anchor="middle" x="7755" y="-5169.43" font-family="Times,serif" font-size="14.00">MHA Layer 9 GPU 7</text>
<text text-anchor="middle" x="7755" y="-5154.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7755" y="-5139.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer8_gpu7&#45;&gt;mha_layer9_gpu7 -->
<g id="edge872" class="edge">
<title>aggregate_layer8_gpu7&#45;&gt;mha_layer9_gpu7</title>
<path fill="none" stroke="black" d="M7790.7,-5220.53C7785.38,-5211.37 7779.96,-5202.05 7775,-5193.53"/>
<polygon fill="black" stroke="black" points="7777.89,-5191.53 7769.84,-5184.64 7771.84,-5195.04 7777.89,-5191.53"/>
</g>
<!-- route_layer8_gpu8&#45;&gt;comm_layer8 -->
<g id="edge825" class="edge">
<title>route_layer8_gpu8&#45;&gt;comm_layer8</title>
<path fill="none" stroke="black" d="M8446.38,-5577.51C8396.27,-5564.57 8343.83,-5551.03 8298.03,-5539.2"/>
<polygon fill="black" stroke="black" points="8298.62,-5535.74 8288.06,-5536.63 8296.87,-5542.52 8298.62,-5535.74"/>
</g>
<!-- mha_layer9_gpu8 -->
<g id="node739" class="node">
<title>mha_layer9_gpu8</title>
<path fill="lightblue" stroke="black" d="M8877,-5184.63C8877,-5184.63 8429,-5184.63 8429,-5184.63 8423,-5184.63 8417,-5178.63 8417,-5172.63 8417,-5172.63 8417,-5143.63 8417,-5143.63 8417,-5137.63 8423,-5131.63 8429,-5131.63 8429,-5131.63 8877,-5131.63 8877,-5131.63 8883,-5131.63 8889,-5137.63 8889,-5143.63 8889,-5143.63 8889,-5172.63 8889,-5172.63 8889,-5178.63 8883,-5184.63 8877,-5184.63"/>
<text text-anchor="middle" x="8653" y="-5169.43" font-family="Times,serif" font-size="14.00">MHA Layer 9 GPU 8</text>
<text text-anchor="middle" x="8653" y="-5154.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8653" y="-5139.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer8_gpu8&#45;&gt;mha_layer9_gpu8 -->
<g id="edge873" class="edge">
<title>aggregate_layer8_gpu8&#45;&gt;mha_layer9_gpu8</title>
<path fill="none" stroke="black" d="M8576.18,-5220.53C8588.74,-5210.49 8601.54,-5200.26 8613,-5191.1"/>
<polygon fill="black" stroke="black" points="8615.45,-5193.62 8621.08,-5184.64 8611.08,-5188.15 8615.45,-5193.62"/>
</g>
<!-- route_layer8_gpu9&#45;&gt;comm_layer8 -->
<g id="edge826" class="edge">
<title>route_layer8_gpu9&#45;&gt;comm_layer8</title>
<path fill="none" stroke="black" d="M9237.73,-5600.41C9157.78,-5592.87 9071.66,-5584.83 8992,-5577.58 8786.63,-5558.88 8552.46,-5538.41 8386.03,-5524.01"/>
<polygon fill="black" stroke="black" points="8385.93,-5520.49 8375.67,-5523.12 8385.33,-5527.47 8385.93,-5520.49"/>
</g>
<!-- mha_layer9_gpu9 -->
<g id="node740" class="node">
<title>mha_layer9_gpu9</title>
<path fill="lightblue" stroke="black" d="M9419,-5184.63C9419,-5184.63 8971,-5184.63 8971,-5184.63 8965,-5184.63 8959,-5178.63 8959,-5172.63 8959,-5172.63 8959,-5143.63 8959,-5143.63 8959,-5137.63 8965,-5131.63 8971,-5131.63 8971,-5131.63 9419,-5131.63 9419,-5131.63 9425,-5131.63 9431,-5137.63 9431,-5143.63 9431,-5143.63 9431,-5172.63 9431,-5172.63 9431,-5178.63 9425,-5184.63 9419,-5184.63"/>
<text text-anchor="middle" x="9195" y="-5169.43" font-family="Times,serif" font-size="14.00">MHA Layer 9 GPU 9</text>
<text text-anchor="middle" x="9195" y="-5154.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9195" y="-5139.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer8_gpu9&#45;&gt;mha_layer9_gpu9 -->
<g id="edge874" class="edge">
<title>aggregate_layer8_gpu9&#45;&gt;mha_layer9_gpu9</title>
<path fill="none" stroke="black" d="M9190.67,-5220.53C9191.29,-5211.76 9191.92,-5202.84 9192.5,-5194.62"/>
<polygon fill="black" stroke="black" points="9195.99,-5194.86 9193.2,-5184.64 9189.01,-5194.37 9195.99,-5194.86"/>
</g>
<!-- route_layer8_gpu10&#45;&gt;comm_layer8 -->
<g id="edge827" class="edge">
<title>route_layer8_gpu10&#45;&gt;comm_layer8</title>
<path fill="none" stroke="black" d="M10165.56,-5599.63C10075.85,-5591.6 9977.55,-5583.51 9887,-5577.58 9363.68,-5543.32 8749.71,-5521.99 8414.88,-5511.95"/>
<polygon fill="black" stroke="black" points="8414.67,-5508.44 8404.57,-5511.64 8414.46,-5515.44 8414.67,-5508.44"/>
</g>
<!-- mha_layer9_gpu10 -->
<g id="node741" class="node">
<title>mha_layer9_gpu10</title>
<path fill="lightblue" stroke="black" d="M10667,-5184.63C10667,-5184.63 10219,-5184.63 10219,-5184.63 10213,-5184.63 10207,-5178.63 10207,-5172.63 10207,-5172.63 10207,-5143.63 10207,-5143.63 10207,-5137.63 10213,-5131.63 10219,-5131.63 10219,-5131.63 10667,-5131.63 10667,-5131.63 10673,-5131.63 10679,-5137.63 10679,-5143.63 10679,-5143.63 10679,-5172.63 10679,-5172.63 10679,-5178.63 10673,-5184.63 10667,-5184.63"/>
<text text-anchor="middle" x="10443" y="-5169.43" font-family="Times,serif" font-size="14.00">MHA Layer 9 GPU 10</text>
<text text-anchor="middle" x="10443" y="-5154.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10443" y="-5139.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer8_gpu10&#45;&gt;mha_layer9_gpu10 -->
<g id="edge875" class="edge">
<title>aggregate_layer8_gpu10&#45;&gt;mha_layer9_gpu10</title>
<path fill="none" stroke="black" d="M10336.97,-5220.53C10355.14,-5210 10373.68,-5199.27 10390.07,-5189.78"/>
<polygon fill="black" stroke="black" points="10392.04,-5192.68 10398.94,-5184.64 10388.53,-5186.62 10392.04,-5192.68"/>
</g>
<!-- route_layer8_gpu11&#45;&gt;comm_layer8 -->
<g id="edge828" class="edge">
<title>route_layer8_gpu11&#45;&gt;comm_layer8</title>
<path fill="none" stroke="black" d="M11112.49,-5599.64C11017.54,-5591.31 10912.51,-5583.06 10816,-5577.58 9936.29,-5527.66 8890.29,-5511.87 8418.71,-5507.08"/>
<polygon fill="black" stroke="black" points="8418.75,-5503.58 8408.71,-5506.98 8418.68,-5510.58 8418.75,-5503.58"/>
</g>
<!-- mha_layer9_gpu11 -->
<g id="node742" class="node">
<title>mha_layer9_gpu11</title>
<path fill="lightblue" stroke="black" d="M11754,-5184.63C11754,-5184.63 11306,-5184.63 11306,-5184.63 11300,-5184.63 11294,-5178.63 11294,-5172.63 11294,-5172.63 11294,-5143.63 11294,-5143.63 11294,-5137.63 11300,-5131.63 11306,-5131.63 11306,-5131.63 11754,-5131.63 11754,-5131.63 11760,-5131.63 11766,-5137.63 11766,-5143.63 11766,-5143.63 11766,-5172.63 11766,-5172.63 11766,-5178.63 11760,-5184.63 11754,-5184.63"/>
<text text-anchor="middle" x="11530" y="-5169.43" font-family="Times,serif" font-size="14.00">MHA Layer 9 GPU 11</text>
<text text-anchor="middle" x="11530" y="-5154.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11530" y="-5139.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer8_gpu11&#45;&gt;mha_layer9_gpu11 -->
<g id="edge876" class="edge">
<title>aggregate_layer8_gpu11&#45;&gt;mha_layer9_gpu11</title>
<path fill="none" stroke="black" d="M11360.13,-5220.53C11391,-5209.37 11422.53,-5197.97 11449.91,-5188.08"/>
<polygon fill="black" stroke="black" points="11451.2,-5191.33 11459.42,-5184.64 11448.82,-5184.75 11451.2,-5191.33"/>
</g>
<!-- route_layer8_gpu12&#45;&gt;comm_layer8 -->
<g id="edge829" class="edge">
<title>route_layer8_gpu12&#45;&gt;comm_layer8</title>
<path fill="none" stroke="black" d="M12067.35,-5599.57C11970.12,-5591.11 11862.14,-5582.79 11763,-5577.58 10509.64,-5511.69 9007.73,-5504.58 8419.66,-5504.57"/>
<polygon fill="black" stroke="black" points="8419.36,-5501.07 8409.36,-5504.58 8419.36,-5508.07 8419.36,-5501.07"/>
</g>
<!-- mha_layer9_gpu12 -->
<g id="node743" class="node">
<title>mha_layer9_gpu12</title>
<path fill="lightblue" stroke="black" d="M12329,-5184.63C12329,-5184.63 11881,-5184.63 11881,-5184.63 11875,-5184.63 11869,-5178.63 11869,-5172.63 11869,-5172.63 11869,-5143.63 11869,-5143.63 11869,-5137.63 11875,-5131.63 11881,-5131.63 11881,-5131.63 12329,-5131.63 12329,-5131.63 12335,-5131.63 12341,-5137.63 12341,-5143.63 12341,-5143.63 12341,-5172.63 12341,-5172.63 12341,-5178.63 12335,-5184.63 12329,-5184.63"/>
<text text-anchor="middle" x="12105" y="-5169.43" font-family="Times,serif" font-size="14.00">MHA Layer 9 GPU 12</text>
<text text-anchor="middle" x="12105" y="-5154.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12105" y="-5139.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer8_gpu12&#45;&gt;mha_layer9_gpu12 -->
<g id="edge877" class="edge">
<title>aggregate_layer8_gpu12&#45;&gt;mha_layer9_gpu12</title>
<path fill="none" stroke="black" d="M12064.97,-5220.53C12071,-5211.27 12077.15,-5201.85 12082.75,-5193.26"/>
<polygon fill="black" stroke="black" points="12085.84,-5194.93 12088.37,-5184.64 12079.97,-5191.11 12085.84,-5194.93"/>
</g>
<!-- route_layer8_gpu13&#45;&gt;comm_layer8 -->
<g id="edge830" class="edge">
<title>route_layer8_gpu13&#45;&gt;comm_layer8</title>
<path fill="none" stroke="black" d="M13027.61,-5599.56C12928.87,-5591 12818.89,-5582.64 12718,-5577.58 11871.33,-5535.15 9247.43,-5512.94 8419.2,-5506.85"/>
<polygon fill="black" stroke="black" points="8418.96,-5503.35 8408.94,-5506.78 8418.91,-5510.35 8418.96,-5503.35"/>
</g>
<!-- mha_layer9_gpu13 -->
<g id="node744" class="node">
<title>mha_layer9_gpu13</title>
<path fill="lightblue" stroke="black" d="M13711,-5184.63C13711,-5184.63 13263,-5184.63 13263,-5184.63 13257,-5184.63 13251,-5178.63 13251,-5172.63 13251,-5172.63 13251,-5143.63 13251,-5143.63 13251,-5137.63 13257,-5131.63 13263,-5131.63 13263,-5131.63 13711,-5131.63 13711,-5131.63 13717,-5131.63 13723,-5137.63 13723,-5143.63 13723,-5143.63 13723,-5172.63 13723,-5172.63 13723,-5178.63 13717,-5184.63 13711,-5184.63"/>
<text text-anchor="middle" x="13487" y="-5169.43" font-family="Times,serif" font-size="14.00">MHA Layer 9 GPU 13</text>
<text text-anchor="middle" x="13487" y="-5154.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13487" y="-5139.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer8_gpu13&#45;&gt;mha_layer9_gpu13 -->
<g id="edge878" class="edge">
<title>aggregate_layer8_gpu13&#45;&gt;mha_layer9_gpu13</title>
<path fill="none" stroke="black" d="M13262.19,-5220.61C13304.09,-5209.15 13346.93,-5197.44 13383.82,-5187.35"/>
<polygon fill="black" stroke="black" points="13384.84,-5190.7 13393.56,-5184.68 13382.99,-5183.94 13384.84,-5190.7"/>
</g>
<!-- route_layer8_gpu14&#45;&gt;comm_layer8 -->
<g id="edge831" class="edge">
<title>route_layer8_gpu14&#45;&gt;comm_layer8</title>
<path fill="none" stroke="black" d="M13989.41,-5599.47C13890.15,-5590.87 13779.49,-5582.51 13678,-5577.58 12633.78,-5526.85 9357.27,-5509.92 8419.23,-5506.05"/>
<polygon fill="black" stroke="black" points="8418.99,-5502.55 8408.98,-5506.01 8418.96,-5509.55 8418.99,-5502.55"/>
</g>
<!-- mha_layer9_gpu14 -->
<g id="node745" class="node">
<title>mha_layer9_gpu14</title>
<path fill="lightblue" stroke="black" d="M14372,-5184.63C14372,-5184.63 13924,-5184.63 13924,-5184.63 13918,-5184.63 13912,-5178.63 13912,-5172.63 13912,-5172.63 13912,-5143.63 13912,-5143.63 13912,-5137.63 13918,-5131.63 13924,-5131.63 13924,-5131.63 14372,-5131.63 14372,-5131.63 14378,-5131.63 14384,-5137.63 14384,-5143.63 14384,-5143.63 14384,-5172.63 14384,-5172.63 14384,-5178.63 14378,-5184.63 14372,-5184.63"/>
<text text-anchor="middle" x="14148" y="-5169.43" font-family="Times,serif" font-size="14.00">MHA Layer 9 GPU 14</text>
<text text-anchor="middle" x="14148" y="-5154.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14148" y="-5139.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer8_gpu14&#45;&gt;mha_layer9_gpu14 -->
<g id="edge879" class="edge">
<title>aggregate_layer8_gpu14&#45;&gt;mha_layer9_gpu14</title>
<path fill="none" stroke="black" d="M14026.28,-5220.53C14047.53,-5209.81 14069.21,-5198.87 14088.28,-5189.25"/>
<polygon fill="black" stroke="black" points="14090.07,-5192.27 14097.42,-5184.64 14086.92,-5186.02 14090.07,-5192.27"/>
</g>
<!-- route_layer8_gpu15&#45;&gt;comm_layer8 -->
<g id="edge832" class="edge">
<title>route_layer8_gpu15&#45;&gt;comm_layer8</title>
<path fill="none" stroke="black" d="M14952.31,-5599.38C14852.79,-5590.77 14741.8,-5582.42 14640,-5577.58 13396.62,-5518.47 9458.7,-5507.39 8419.49,-5505.48"/>
<polygon fill="black" stroke="black" points="8419.28,-5501.98 8409.27,-5505.46 8419.27,-5508.98 8419.28,-5501.98"/>
</g>
<!-- mha_layer9_gpu15 -->
<g id="node746" class="node">
<title>mha_layer9_gpu15</title>
<path fill="lightblue" stroke="black" d="M14947,-5184.63C14947,-5184.63 14499,-5184.63 14499,-5184.63 14493,-5184.63 14487,-5178.63 14487,-5172.63 14487,-5172.63 14487,-5143.63 14487,-5143.63 14487,-5137.63 14493,-5131.63 14499,-5131.63 14499,-5131.63 14947,-5131.63 14947,-5131.63 14953,-5131.63 14959,-5137.63 14959,-5143.63 14959,-5143.63 14959,-5172.63 14959,-5172.63 14959,-5178.63 14953,-5184.63 14947,-5184.63"/>
<text text-anchor="middle" x="14723" y="-5169.43" font-family="Times,serif" font-size="14.00">MHA Layer 9 GPU 15</text>
<text text-anchor="middle" x="14723" y="-5154.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14723" y="-5139.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer8_gpu15&#45;&gt;mha_layer9_gpu15 -->
<g id="edge880" class="edge">
<title>aggregate_layer8_gpu15&#45;&gt;mha_layer9_gpu15</title>
<path fill="none" stroke="black" d="M14699.2,-5220.53C14702.67,-5211.56 14706.21,-5202.44 14709.45,-5194.07"/>
<polygon fill="black" stroke="black" points="14712.76,-5195.23 14713.11,-5184.64 14706.23,-5192.7 14712.76,-5195.23"/>
</g>
<!-- comm_layer8&#45;&gt;expert_layer8_gpu0_expert0 -->
<g id="edge833" class="edge">
<title>comm_layer8&#45;&gt;expert_layer8_gpu0_expert0</title>
<path fill="none" stroke="black" d="M7922.81,-5503.22C7116.14,-5502.95 4455.07,-5496.75 2256,-5430.63 2112.94,-5426.32 1953.29,-5418.85 1823.72,-5412.1"/>
<polygon fill="black" stroke="black" points="1823.83,-5408.6 1813.66,-5411.57 1823.46,-5415.59 1823.83,-5408.6"/>
</g>
<!-- comm_layer8&#45;&gt;expert_layer8_gpu1_expert1 -->
<g id="edge834" class="edge">
<title>comm_layer8&#45;&gt;expert_layer8_gpu1_expert1</title>
<path fill="none" stroke="black" d="M7923.09,-5501.71C7213.64,-5497.17 5083.21,-5480.09 3316,-5430.63 3133.07,-5425.51 2926.82,-5416.99 2769.03,-5409.88"/>
<polygon fill="black" stroke="black" points="2768.85,-5406.37 2758.7,-5409.42 2768.54,-5413.37 2768.85,-5406.37"/>
</g>
<!-- comm_layer8&#45;&gt;expert_layer8_gpu2_expert2 -->
<g id="edge835" class="edge">
<title>comm_layer8&#45;&gt;expert_layer8_gpu2_expert2</title>
<path fill="none" stroke="black" d="M7923.38,-5501.33C7306.31,-5496.22 5626.82,-5478.67 4228,-5430.63 4096.37,-5426.11 3949.97,-5418.95 3828.94,-5412.45"/>
<polygon fill="black" stroke="black" points="3828.97,-5408.95 3818.79,-5411.9 3828.59,-5415.94 3828.97,-5408.95"/>
</g>
<!-- comm_layer8&#45;&gt;expert_layer8_gpu3_expert3 -->
<g id="edge836" class="edge">
<title>comm_layer8&#45;&gt;expert_layer8_gpu3_expert3</title>
<path fill="none" stroke="black" d="M7926.71,-5497.25C7454.98,-5485.59 6371.67,-5458.21 5461,-5430.63 5216.62,-5423.23 4937.9,-5413.7 4740.88,-5406.79"/>
<polygon fill="black" stroke="black" points="4740.79,-5403.29 4730.68,-5406.43 4740.55,-5410.28 4740.79,-5403.29"/>
</g>
<!-- comm_layer8&#45;&gt;expert_layer8_gpu4_expert4 -->
<g id="edge837" class="edge">
<title>comm_layer8&#45;&gt;expert_layer8_gpu4_expert4</title>
<path fill="none" stroke="black" d="M7928.71,-5495.71C7569.18,-5484.13 6864.89,-5459.97 6267,-5430.63 6171.24,-5425.93 6066.17,-5419.85 5973.74,-5414.19"/>
<polygon fill="black" stroke="black" points="5973.89,-5410.7 5963.69,-5413.58 5973.46,-5417.68 5973.89,-5410.7"/>
</g>
<!-- comm_layer8&#45;&gt;expert_layer8_gpu5_expert5 -->
<g id="edge838" class="edge">
<title>comm_layer8&#45;&gt;expert_layer8_gpu5_expert5</title>
<path fill="none" stroke="black" d="M7935.61,-5491.97C7681.97,-5479.24 7262.2,-5456.73 6901,-5430.63 6861.77,-5427.79 6820.28,-5424.48 6779.72,-5421.08"/>
<polygon fill="black" stroke="black" points="6779.97,-5417.59 6769.71,-5420.23 6779.38,-5424.56 6779.97,-5417.59"/>
</g>
<!-- comm_layer8&#45;&gt;expert_layer8_gpu6_expert6 -->
<g id="edge839" class="edge">
<title>comm_layer8&#45;&gt;expert_layer8_gpu6_expert6</title>
<path fill="none" stroke="black" d="M7967.56,-5482.36C7809.05,-5465.79 7585.74,-5442.45 7413.64,-5424.45"/>
<polygon fill="black" stroke="black" points="7413.98,-5420.97 7403.68,-5423.41 7413.26,-5427.93 7413.98,-5420.97"/>
</g>
<!-- comm_layer8&#45;&gt;expert_layer8_gpu7_expert7 -->
<g id="edge840" class="edge">
<title>comm_layer8&#45;&gt;expert_layer8_gpu7_expert7</title>
<path fill="none" stroke="black" d="M8070.67,-5469.58C8038.5,-5458.27 8002.44,-5445.6 7969.66,-5434.07"/>
<polygon fill="black" stroke="black" points="7970.65,-5430.71 7960.06,-5430.7 7968.33,-5437.32 7970.65,-5430.71"/>
</g>
<!-- comm_layer8&#45;&gt;expert_layer8_gpu8_expert8 -->
<g id="edge841" class="edge">
<title>comm_layer8&#45;&gt;expert_layer8_gpu8_expert8</title>
<path fill="none" stroke="black" d="M8261.33,-5469.58C8293.5,-5458.27 8329.56,-5445.6 8362.34,-5434.07"/>
<polygon fill="black" stroke="black" points="8363.67,-5437.32 8371.94,-5430.7 8361.35,-5430.71 8363.67,-5437.32"/>
</g>
<!-- comm_layer8&#45;&gt;expert_layer8_gpu9_expert9 -->
<g id="edge842" class="edge">
<title>comm_layer8&#45;&gt;expert_layer8_gpu9_expert9</title>
<path fill="none" stroke="black" d="M8359.5,-5481.34C8500.56,-5465.48 8693.12,-5443.83 8847.07,-5426.52"/>
<polygon fill="black" stroke="black" points="8847.6,-5429.98 8857.15,-5425.38 8846.82,-5423.02 8847.6,-5429.98"/>
</g>
<!-- comm_layer8&#45;&gt;expert_layer8_gpu10_expert10 -->
<g id="edge843" class="edge">
<title>comm_layer8&#45;&gt;expert_layer8_gpu10_expert10</title>
<path fill="none" stroke="black" d="M8390.97,-5489.82C8723.87,-5470.18 9345.96,-5433.46 9696.26,-5412.78"/>
<polygon fill="black" stroke="black" points="9696.51,-5416.27 9706.28,-5412.19 9696.09,-5409.28 9696.51,-5416.27"/>
</g>
<!-- comm_layer8&#45;&gt;expert_layer8_gpu11_expert11 -->
<g id="edge844" class="edge">
<title>comm_layer8&#45;&gt;expert_layer8_gpu11_expert11</title>
<path fill="none" stroke="black" d="M8403.42,-5495.83C8784.19,-5483.9 9555,-5458.69 10208,-5430.63 10338.91,-5425 10484.52,-5417.75 10605.04,-5411.48"/>
<polygon fill="black" stroke="black" points="10605.34,-5414.97 10615.15,-5410.95 10604.98,-5407.98 10605.34,-5414.97"/>
</g>
<!-- comm_layer8&#45;&gt;expert_layer8_gpu12_expert12 -->
<g id="edge845" class="edge">
<title>comm_layer8&#45;&gt;expert_layer8_gpu12_expert12</title>
<path fill="none" stroke="black" d="M8407.55,-5499.6C8911.36,-5491.77 10111.08,-5470.31 11117,-5430.63 11232.05,-5426.09 11359.27,-5419.42 11467.4,-5413.27"/>
<polygon fill="black" stroke="black" points="11467.69,-5416.76 11477.47,-5412.7 11467.29,-5409.77 11467.69,-5416.76"/>
</g>
<!-- comm_layer8&#45;&gt;expert_layer8_gpu13_expert13 -->
<g id="edge846" class="edge">
<title>comm_layer8&#45;&gt;expert_layer8_gpu13_expert13</title>
<path fill="none" stroke="black" d="M8408.35,-5500.88C9011.78,-5494.81 10630.09,-5475.37 11979,-5430.63 12124.73,-5425.79 12287.51,-5418.21 12419.08,-5411.53"/>
<polygon fill="black" stroke="black" points="12419.49,-5415.01 12429.3,-5411.01 12419.14,-5408.02 12419.49,-5415.01"/>
</g>
<!-- comm_layer8&#45;&gt;expert_layer8_gpu14_expert14 -->
<g id="edge847" class="edge">
<title>comm_layer8&#45;&gt;expert_layer8_gpu14_expert14</title>
<path fill="none" stroke="black" d="M8409.06,-5502.48C9110.49,-5500.02 11198.65,-5488.03 12931,-5430.63 13059.14,-5426.38 13201.48,-5419.36 13319.86,-5412.88"/>
<polygon fill="black" stroke="black" points="13320.35,-5416.36 13330.15,-5412.32 13319.97,-5409.37 13320.35,-5416.36"/>
</g>
<!-- comm_layer8&#45;&gt;expert_layer8_gpu15_expert15 -->
<g id="edge848" class="edge">
<title>comm_layer8&#45;&gt;expert_layer8_gpu15_expert15</title>
<path fill="none" stroke="black" d="M8408.87,-5501.44C9349.16,-5494.79 12751.45,-5468.58 13832,-5430.63 13935.8,-5426.98 14050.04,-5420.85 14149.1,-5414.85"/>
<polygon fill="black" stroke="black" points="14149.48,-5418.33 14159.25,-5414.23 14149.05,-5411.35 14149.48,-5418.33"/>
</g>
<!-- gate_layer9_gpu0 -->
<g id="node747" class="node">
<title>gate_layer9_gpu0</title>
<path fill="lightsteelblue" stroke="black" d="M988.07,-5094.29C988.07,-5094.29 538.93,-5043.96 538.93,-5043.96 532.96,-5043.29 532.96,-5041.96 538.93,-5041.29 538.93,-5041.29 988.07,-4990.96 988.07,-4990.96 994.04,-4990.29 1005.96,-4990.29 1011.93,-4990.96 1011.93,-4990.96 1461.07,-5041.29 1461.07,-5041.29 1467.04,-5041.96 1467.04,-5043.29 1461.07,-5043.96 1461.07,-5043.96 1011.93,-5094.29 1011.93,-5094.29 1005.96,-5094.96 994.04,-5094.96 988.07,-5094.29"/>
<text text-anchor="middle" x="1000" y="-5053.93" font-family="Times,serif" font-size="14.00">Gate Layer 9 GPU 0</text>
<text text-anchor="middle" x="1000" y="-5038.93" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="1000" y="-5023.93" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer9_gpu0&#45;&gt;gate_layer9_gpu0 -->
<g id="edge881" class="edge">
<title>mha_layer9_gpu0&#45;&gt;gate_layer9_gpu0</title>
<path fill="none" stroke="black" d="M1116.74,-5131.37C1102.38,-5120.58 1085.15,-5107.63 1068.39,-5095.04"/>
<polygon fill="black" stroke="black" points="1070.32,-5092.1 1060.22,-5088.89 1066.11,-5097.7 1070.32,-5092.1"/>
</g>
<!-- gate_layer9_gpu1 -->
<g id="node748" class="node">
<title>gate_layer9_gpu1</title>
<path fill="lightsteelblue" stroke="black" d="M1952.07,-5094.29C1952.07,-5094.29 1502.93,-5043.96 1502.93,-5043.96 1496.96,-5043.29 1496.96,-5041.96 1502.93,-5041.29 1502.93,-5041.29 1952.07,-4990.96 1952.07,-4990.96 1958.04,-4990.29 1969.96,-4990.29 1975.93,-4990.96 1975.93,-4990.96 2425.07,-5041.29 2425.07,-5041.29 2431.04,-5041.96 2431.04,-5043.29 2425.07,-5043.96 2425.07,-5043.96 1975.93,-5094.29 1975.93,-5094.29 1969.96,-5094.96 1958.04,-5094.96 1952.07,-5094.29"/>
<text text-anchor="middle" x="1964" y="-5053.93" font-family="Times,serif" font-size="14.00">Gate Layer 9 GPU 1</text>
<text text-anchor="middle" x="1964" y="-5038.93" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="1964" y="-5023.93" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer9_gpu1&#45;&gt;gate_layer9_gpu1 -->
<g id="edge882" class="edge">
<title>mha_layer9_gpu1&#45;&gt;gate_layer9_gpu1</title>
<path fill="none" stroke="black" d="M2051.36,-5131.37C2041.44,-5121.41 2029.68,-5109.6 2018.07,-5097.93"/>
<polygon fill="black" stroke="black" points="2020.4,-5095.32 2010.87,-5090.7 2015.44,-5100.26 2020.4,-5095.32"/>
</g>
<!-- gate_layer9_gpu2 -->
<g id="node749" class="node">
<title>gate_layer9_gpu2</title>
<path fill="lightsteelblue" stroke="black" d="M2916.07,-5094.29C2916.07,-5094.29 2466.93,-5043.96 2466.93,-5043.96 2460.96,-5043.29 2460.96,-5041.96 2466.93,-5041.29 2466.93,-5041.29 2916.07,-4990.96 2916.07,-4990.96 2922.04,-4990.29 2933.96,-4990.29 2939.93,-4990.96 2939.93,-4990.96 3389.07,-5041.29 3389.07,-5041.29 3395.04,-5041.96 3395.04,-5043.29 3389.07,-5043.96 3389.07,-5043.96 2939.93,-5094.29 2939.93,-5094.29 2933.96,-5094.96 2922.04,-5094.96 2916.07,-5094.29"/>
<text text-anchor="middle" x="2928" y="-5053.93" font-family="Times,serif" font-size="14.00">Gate Layer 9 GPU 2</text>
<text text-anchor="middle" x="2928" y="-5038.93" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="2928" y="-5023.93" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer9_gpu2&#45;&gt;gate_layer9_gpu2 -->
<g id="edge883" class="edge">
<title>mha_layer9_gpu2&#45;&gt;gate_layer9_gpu2</title>
<path fill="none" stroke="black" d="M3163.4,-5131.51C3128.38,-5118.44 3084.81,-5102.17 3044.7,-5087.2"/>
<polygon fill="black" stroke="black" points="3045.72,-5083.84 3035.13,-5083.62 3043.28,-5090.4 3045.72,-5083.84"/>
</g>
<!-- gate_layer9_gpu3 -->
<g id="node750" class="node">
<title>gate_layer9_gpu3</title>
<path fill="lightsteelblue" stroke="black" d="M3880.07,-5094.29C3880.07,-5094.29 3430.93,-5043.96 3430.93,-5043.96 3424.96,-5043.29 3424.96,-5041.96 3430.93,-5041.29 3430.93,-5041.29 3880.07,-4990.96 3880.07,-4990.96 3886.04,-4990.29 3897.96,-4990.29 3903.93,-4990.96 3903.93,-4990.96 4353.07,-5041.29 4353.07,-5041.29 4359.04,-5041.96 4359.04,-5043.29 4353.07,-5043.96 4353.07,-5043.96 3903.93,-5094.29 3903.93,-5094.29 3897.96,-5094.96 3886.04,-5094.96 3880.07,-5094.29"/>
<text text-anchor="middle" x="3892" y="-5053.93" font-family="Times,serif" font-size="14.00">Gate Layer 9 GPU 3</text>
<text text-anchor="middle" x="3892" y="-5038.93" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="3892" y="-5023.93" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer9_gpu3&#45;&gt;gate_layer9_gpu3 -->
<g id="edge884" class="edge">
<title>mha_layer9_gpu3&#45;&gt;gate_layer9_gpu3</title>
<path fill="none" stroke="black" d="M3950.75,-5131.37C3944.6,-5122.19 3937.41,-5111.44 3930.2,-5100.67"/>
<polygon fill="black" stroke="black" points="3932.91,-5098.43 3924.44,-5092.07 3927.09,-5102.32 3932.91,-5098.43"/>
</g>
<!-- gate_layer9_gpu4 -->
<g id="node751" class="node">
<title>gate_layer9_gpu4</title>
<path fill="lightsteelblue" stroke="black" d="M4844.07,-5094.29C4844.07,-5094.29 4394.93,-5043.96 4394.93,-5043.96 4388.96,-5043.29 4388.96,-5041.96 4394.93,-5041.29 4394.93,-5041.29 4844.07,-4990.96 4844.07,-4990.96 4850.04,-4990.29 4861.96,-4990.29 4867.93,-4990.96 4867.93,-4990.96 5317.07,-5041.29 5317.07,-5041.29 5323.04,-5041.96 5323.04,-5043.29 5317.07,-5043.96 5317.07,-5043.96 4867.93,-5094.29 4867.93,-5094.29 4861.96,-5094.96 4850.04,-5094.96 4844.07,-5094.29"/>
<text text-anchor="middle" x="4856" y="-5053.93" font-family="Times,serif" font-size="14.00">Gate Layer 9 GPU 4</text>
<text text-anchor="middle" x="4856" y="-5038.93" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4856" y="-5023.93" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer9_gpu4&#45;&gt;gate_layer9_gpu4 -->
<g id="edge885" class="edge">
<title>mha_layer9_gpu4&#45;&gt;gate_layer9_gpu4</title>
<path fill="none" stroke="black" d="M5041.07,-5131.51C5015.36,-5119.31 4983.8,-5104.32 4954.07,-5090.2"/>
<polygon fill="black" stroke="black" points="4955.44,-5086.98 4944.91,-5085.85 4952.44,-5093.3 4955.44,-5086.98"/>
</g>
<!-- gate_layer9_gpu5 -->
<g id="node752" class="node">
<title>gate_layer9_gpu5</title>
<path fill="lightsteelblue" stroke="black" d="M5808.07,-5094.29C5808.07,-5094.29 5358.93,-5043.96 5358.93,-5043.96 5352.96,-5043.29 5352.96,-5041.96 5358.93,-5041.29 5358.93,-5041.29 5808.07,-4990.96 5808.07,-4990.96 5814.04,-4990.29 5825.96,-4990.29 5831.93,-4990.96 5831.93,-4990.96 6281.07,-5041.29 6281.07,-5041.29 6287.04,-5041.96 6287.04,-5043.29 6281.07,-5043.96 6281.07,-5043.96 5831.93,-5094.29 5831.93,-5094.29 5825.96,-5094.96 5814.04,-5094.96 5808.07,-5094.29"/>
<text text-anchor="middle" x="5820" y="-5053.93" font-family="Times,serif" font-size="14.00">Gate Layer 9 GPU 5</text>
<text text-anchor="middle" x="5820" y="-5038.93" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5820" y="-5023.93" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer9_gpu5&#45;&gt;gate_layer9_gpu5 -->
<g id="edge886" class="edge">
<title>mha_layer9_gpu5&#45;&gt;gate_layer9_gpu5</title>
<path fill="none" stroke="black" d="M6043.01,-5131.51C6010.35,-5118.64 5969.85,-5102.68 5932.36,-5087.91"/>
<polygon fill="black" stroke="black" points="5933.48,-5084.59 5922.9,-5084.18 5930.92,-5091.1 5933.48,-5084.59"/>
</g>
<!-- gate_layer9_gpu6 -->
<g id="node753" class="node">
<title>gate_layer9_gpu6</title>
<path fill="lightsteelblue" stroke="black" d="M6772.07,-5094.29C6772.07,-5094.29 6322.93,-5043.96 6322.93,-5043.96 6316.96,-5043.29 6316.96,-5041.96 6322.93,-5041.29 6322.93,-5041.29 6772.07,-4990.96 6772.07,-4990.96 6778.04,-4990.29 6789.96,-4990.29 6795.93,-4990.96 6795.93,-4990.96 7245.07,-5041.29 7245.07,-5041.29 7251.04,-5041.96 7251.04,-5043.29 7245.07,-5043.96 7245.07,-5043.96 6795.93,-5094.29 6795.93,-5094.29 6789.96,-5094.96 6778.04,-5094.96 6772.07,-5094.29"/>
<text text-anchor="middle" x="6784" y="-5053.93" font-family="Times,serif" font-size="14.00">Gate Layer 9 GPU 6</text>
<text text-anchor="middle" x="6784" y="-5038.93" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6784" y="-5023.93" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer9_gpu6&#45;&gt;gate_layer9_gpu6 -->
<g id="edge887" class="edge">
<title>mha_layer9_gpu6&#45;&gt;gate_layer9_gpu6</title>
<path fill="none" stroke="black" d="M6893.78,-5131.37C6880.54,-5120.79 6864.7,-5108.13 6849.24,-5095.77"/>
<polygon fill="black" stroke="black" points="6851.19,-5092.85 6841.2,-5089.34 6846.82,-5098.32 6851.19,-5092.85"/>
</g>
<!-- gate_layer9_gpu7 -->
<g id="node754" class="node">
<title>gate_layer9_gpu7</title>
<path fill="lightsteelblue" stroke="black" d="M7736.07,-5094.29C7736.07,-5094.29 7286.93,-5043.96 7286.93,-5043.96 7280.96,-5043.29 7280.96,-5041.96 7286.93,-5041.29 7286.93,-5041.29 7736.07,-4990.96 7736.07,-4990.96 7742.04,-4990.29 7753.96,-4990.29 7759.93,-4990.96 7759.93,-4990.96 8209.07,-5041.29 8209.07,-5041.29 8215.04,-5041.96 8215.04,-5043.29 8209.07,-5043.96 8209.07,-5043.96 7759.93,-5094.29 7759.93,-5094.29 7753.96,-5094.96 7742.04,-5094.96 7736.07,-5094.29"/>
<text text-anchor="middle" x="7748" y="-5053.93" font-family="Times,serif" font-size="14.00">Gate Layer 9 GPU 7</text>
<text text-anchor="middle" x="7748" y="-5038.93" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="7748" y="-5023.93" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer9_gpu7&#45;&gt;gate_layer9_gpu7 -->
<g id="edge888" class="edge">
<title>mha_layer9_gpu7&#45;&gt;gate_layer9_gpu7</title>
<path fill="none" stroke="black" d="M7753.41,-5131.37C7752.94,-5123.67 7752.39,-5114.88 7751.84,-5105.9"/>
<polygon fill="black" stroke="black" points="7755.32,-5105.49 7751.21,-5095.72 7748.34,-5105.92 7755.32,-5105.49"/>
</g>
<!-- gate_layer9_gpu8 -->
<g id="node755" class="node">
<title>gate_layer9_gpu8</title>
<path fill="lightsteelblue" stroke="black" d="M8700.07,-5094.29C8700.07,-5094.29 8250.93,-5043.96 8250.93,-5043.96 8244.96,-5043.29 8244.96,-5041.96 8250.93,-5041.29 8250.93,-5041.29 8700.07,-4990.96 8700.07,-4990.96 8706.04,-4990.29 8717.96,-4990.29 8723.93,-4990.96 8723.93,-4990.96 9173.07,-5041.29 9173.07,-5041.29 9179.04,-5041.96 9179.04,-5043.29 9173.07,-5043.96 9173.07,-5043.96 8723.93,-5094.29 8723.93,-5094.29 8717.96,-5094.96 8706.04,-5094.96 8700.07,-5094.29"/>
<text text-anchor="middle" x="8712" y="-5053.93" font-family="Times,serif" font-size="14.00">Gate Layer 9 GPU 8</text>
<text text-anchor="middle" x="8712" y="-5038.93" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="8712" y="-5023.93" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer9_gpu8&#45;&gt;gate_layer9_gpu8 -->
<g id="edge889" class="edge">
<title>mha_layer9_gpu8&#45;&gt;gate_layer9_gpu8</title>
<path fill="none" stroke="black" d="M8666.39,-5131.37C8670.96,-5122.57 8676.29,-5112.33 8681.64,-5102.02"/>
<polygon fill="black" stroke="black" points="8684.84,-5103.47 8686.35,-5092.98 8678.63,-5100.24 8684.84,-5103.47"/>
</g>
<!-- gate_layer9_gpu9 -->
<g id="node756" class="node">
<title>gate_layer9_gpu9</title>
<path fill="lightsteelblue" stroke="black" d="M9664.07,-5094.29C9664.07,-5094.29 9214.93,-5043.96 9214.93,-5043.96 9208.96,-5043.29 9208.96,-5041.96 9214.93,-5041.29 9214.93,-5041.29 9664.07,-4990.96 9664.07,-4990.96 9670.04,-4990.29 9681.96,-4990.29 9687.93,-4990.96 9687.93,-4990.96 10137.07,-5041.29 10137.07,-5041.29 10143.04,-5041.96 10143.04,-5043.29 10137.07,-5043.96 10137.07,-5043.96 9687.93,-5094.29 9687.93,-5094.29 9681.96,-5094.96 9670.04,-5094.96 9664.07,-5094.29"/>
<text text-anchor="middle" x="9676" y="-5053.93" font-family="Times,serif" font-size="14.00">Gate Layer 9 GPU 9</text>
<text text-anchor="middle" x="9676" y="-5038.93" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="9676" y="-5023.93" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer9_gpu9&#45;&gt;gate_layer9_gpu9 -->
<g id="edge890" class="edge">
<title>mha_layer9_gpu9&#45;&gt;gate_layer9_gpu9</title>
<path fill="none" stroke="black" d="M9303.25,-5131.58C9366.09,-5116.76 9446.41,-5097.8 9516.39,-5081.29"/>
<polygon fill="black" stroke="black" points="9517.26,-5084.68 9526.19,-5078.98 9515.65,-5077.87 9517.26,-5084.68"/>
</g>
<!-- gate_layer9_gpu10 -->
<g id="node757" class="node">
<title>gate_layer9_gpu10</title>
<path fill="lightsteelblue" stroke="black" d="M10628.07,-5094.29C10628.07,-5094.29 10178.93,-5043.96 10178.93,-5043.96 10172.96,-5043.29 10172.96,-5041.96 10178.93,-5041.29 10178.93,-5041.29 10628.07,-4990.96 10628.07,-4990.96 10634.04,-4990.29 10645.96,-4990.29 10651.93,-4990.96 10651.93,-4990.96 11101.07,-5041.29 11101.07,-5041.29 11107.04,-5041.96 11107.04,-5043.29 11101.07,-5043.96 11101.07,-5043.96 10651.93,-5094.29 10651.93,-5094.29 10645.96,-5094.96 10634.04,-5094.96 10628.07,-5094.29"/>
<text text-anchor="middle" x="10640" y="-5053.93" font-family="Times,serif" font-size="14.00">Gate Layer 9 GPU 10</text>
<text text-anchor="middle" x="10640" y="-5038.93" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="10640" y="-5023.93" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer9_gpu10&#45;&gt;gate_layer9_gpu10 -->
<g id="edge891" class="edge">
<title>mha_layer9_gpu10&#45;&gt;gate_layer9_gpu10</title>
<path fill="none" stroke="black" d="M10487.7,-5131.37C10507.73,-5119.83 10532.05,-5105.82 10555.31,-5092.42"/>
<polygon fill="black" stroke="black" points="10557.25,-5095.34 10564.17,-5087.32 10553.75,-5089.28 10557.25,-5095.34"/>
</g>
<!-- gate_layer9_gpu11 -->
<g id="node758" class="node">
<title>gate_layer9_gpu11</title>
<path fill="lightsteelblue" stroke="black" d="M11592.07,-5094.29C11592.07,-5094.29 11142.93,-5043.96 11142.93,-5043.96 11136.96,-5043.29 11136.96,-5041.96 11142.93,-5041.29 11142.93,-5041.29 11592.07,-4990.96 11592.07,-4990.96 11598.04,-4990.29 11609.96,-4990.29 11615.93,-4990.96 11615.93,-4990.96 12065.07,-5041.29 12065.07,-5041.29 12071.04,-5041.96 12071.04,-5043.29 12065.07,-5043.96 12065.07,-5043.96 11615.93,-5094.29 11615.93,-5094.29 11609.96,-5094.96 11598.04,-5094.96 11592.07,-5094.29"/>
<text text-anchor="middle" x="11604" y="-5053.93" font-family="Times,serif" font-size="14.00">Gate Layer 9 GPU 11</text>
<text text-anchor="middle" x="11604" y="-5038.93" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11604" y="-5023.93" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer9_gpu11&#45;&gt;gate_layer9_gpu11 -->
<g id="edge892" class="edge">
<title>mha_layer9_gpu11&#45;&gt;gate_layer9_gpu11</title>
<path fill="none" stroke="black" d="M11546.79,-5131.37C11552.71,-5122.29 11559.63,-5111.68 11566.57,-5101.04"/>
<polygon fill="black" stroke="black" points="11569.59,-5102.81 11572.12,-5092.52 11563.73,-5098.99 11569.59,-5102.81"/>
</g>
<!-- gate_layer9_gpu12 -->
<g id="node759" class="node">
<title>gate_layer9_gpu12</title>
<path fill="lightsteelblue" stroke="black" d="M12556.07,-5094.29C12556.07,-5094.29 12106.93,-5043.96 12106.93,-5043.96 12100.96,-5043.29 12100.96,-5041.96 12106.93,-5041.29 12106.93,-5041.29 12556.07,-4990.96 12556.07,-4990.96 12562.04,-4990.29 12573.96,-4990.29 12579.93,-4990.96 12579.93,-4990.96 13029.07,-5041.29 13029.07,-5041.29 13035.04,-5041.96 13035.04,-5043.29 13029.07,-5043.96 13029.07,-5043.96 12579.93,-5094.29 12579.93,-5094.29 12573.96,-5094.96 12562.04,-5094.96 12556.07,-5094.29"/>
<text text-anchor="middle" x="12568" y="-5053.93" font-family="Times,serif" font-size="14.00">Gate Layer 9 GPU 12</text>
<text text-anchor="middle" x="12568" y="-5038.93" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="12568" y="-5023.93" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer9_gpu12&#45;&gt;gate_layer9_gpu12 -->
<g id="edge893" class="edge">
<title>mha_layer9_gpu12&#45;&gt;gate_layer9_gpu12</title>
<path fill="none" stroke="black" d="M12209.19,-5131.58C12269.05,-5116.91 12345.39,-5098.2 12412.25,-5081.81"/>
<polygon fill="black" stroke="black" points="12413.16,-5085.19 12422.04,-5079.41 12411.49,-5078.39 12413.16,-5085.19"/>
</g>
<!-- gate_layer9_gpu13 -->
<g id="node760" class="node">
<title>gate_layer9_gpu13</title>
<path fill="lightsteelblue" stroke="black" d="M13520.07,-5094.29C13520.07,-5094.29 13070.93,-5043.96 13070.93,-5043.96 13064.96,-5043.29 13064.96,-5041.96 13070.93,-5041.29 13070.93,-5041.29 13520.07,-4990.96 13520.07,-4990.96 13526.04,-4990.29 13537.96,-4990.29 13543.93,-4990.96 13543.93,-4990.96 13993.07,-5041.29 13993.07,-5041.29 13999.04,-5041.96 13999.04,-5043.29 13993.07,-5043.96 13993.07,-5043.96 13543.93,-5094.29 13543.93,-5094.29 13537.96,-5094.96 13526.04,-5094.96 13520.07,-5094.29"/>
<text text-anchor="middle" x="13532" y="-5053.93" font-family="Times,serif" font-size="14.00">Gate Layer 9 GPU 13</text>
<text text-anchor="middle" x="13532" y="-5038.93" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13532" y="-5023.93" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer9_gpu13&#45;&gt;gate_layer9_gpu13 -->
<g id="edge894" class="edge">
<title>mha_layer9_gpu13&#45;&gt;gate_layer9_gpu13</title>
<path fill="none" stroke="black" d="M13497.21,-5131.37C13500.59,-5122.85 13504.5,-5112.98 13508.46,-5103"/>
<polygon fill="black" stroke="black" points="13511.82,-5104.02 13512.25,-5093.44 13505.31,-5101.44 13511.82,-5104.02"/>
</g>
<!-- gate_layer9_gpu14 -->
<g id="node761" class="node">
<title>gate_layer9_gpu14</title>
<path fill="lightsteelblue" stroke="black" d="M14484.07,-5094.29C14484.07,-5094.29 14034.93,-5043.96 14034.93,-5043.96 14028.96,-5043.29 14028.96,-5041.96 14034.93,-5041.29 14034.93,-5041.29 14484.07,-4990.96 14484.07,-4990.96 14490.04,-4990.29 14501.96,-4990.29 14507.93,-4990.96 14507.93,-4990.96 14957.07,-5041.29 14957.07,-5041.29 14963.04,-5041.96 14963.04,-5043.29 14957.07,-5043.96 14957.07,-5043.96 14507.93,-5094.29 14507.93,-5094.29 14501.96,-5094.96 14490.04,-5094.96 14484.07,-5094.29"/>
<text text-anchor="middle" x="14496" y="-5053.93" font-family="Times,serif" font-size="14.00">Gate Layer 9 GPU 14</text>
<text text-anchor="middle" x="14496" y="-5038.93" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14496" y="-5023.93" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer9_gpu14&#45;&gt;gate_layer9_gpu14 -->
<g id="edge895" class="edge">
<title>mha_layer9_gpu14&#45;&gt;gate_layer9_gpu14</title>
<path fill="none" stroke="black" d="M14226.53,-5131.51C14268.07,-5117.96 14320.13,-5100.99 14367.38,-5085.57"/>
<polygon fill="black" stroke="black" points="14368.66,-5088.84 14377.08,-5082.41 14366.49,-5082.19 14368.66,-5088.84"/>
</g>
<!-- gate_layer9_gpu15 -->
<g id="node762" class="node">
<title>gate_layer9_gpu15</title>
<path fill="lightsteelblue" stroke="black" d="M15448.07,-5094.29C15448.07,-5094.29 14998.93,-5043.96 14998.93,-5043.96 14992.96,-5043.29 14992.96,-5041.96 14998.93,-5041.29 14998.93,-5041.29 15448.07,-4990.96 15448.07,-4990.96 15454.04,-4990.29 15465.96,-4990.29 15471.93,-4990.96 15471.93,-4990.96 15921.07,-5041.29 15921.07,-5041.29 15927.04,-5041.96 15927.04,-5043.29 15921.07,-5043.96 15921.07,-5043.96 15471.93,-5094.29 15471.93,-5094.29 15465.96,-5094.96 15454.04,-5094.96 15448.07,-5094.29"/>
<text text-anchor="middle" x="15460" y="-5053.93" font-family="Times,serif" font-size="14.00">Gate Layer 9 GPU 15</text>
<text text-anchor="middle" x="15460" y="-5038.93" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="15460" y="-5023.93" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer9_gpu15&#45;&gt;gate_layer9_gpu15 -->
<g id="edge896" class="edge">
<title>mha_layer9_gpu15&#45;&gt;gate_layer9_gpu15</title>
<path fill="none" stroke="black" d="M14888.86,-5131.58C14997.02,-5114.93 15139,-5093.06 15254.33,-5075.3"/>
<polygon fill="black" stroke="black" points="15255,-5078.74 15264.35,-5073.76 15253.93,-5071.82 15255,-5078.74"/>
</g>
<!-- route_layer9_gpu0 -->
<g id="node779" class="node">
<title>route_layer9_gpu0</title>
<path fill="orange" stroke="black" d="M1460.74,-4953.63C1460.74,-4953.63 952.24,-4953.63 952.24,-4953.63 946.24,-4953.63 935.5,-4949.95 930.75,-4946.28 930.75,-4946.28 812.75,-4854.97 812.75,-4854.97 808,-4851.3 809.26,-4847.63 815.26,-4847.63 815.26,-4847.63 1323.76,-4847.63 1323.76,-4847.63 1329.76,-4847.63 1340.5,-4851.3 1345.25,-4854.97 1345.25,-4854.97 1463.25,-4946.28 1463.25,-4946.28 1468,-4949.95 1466.74,-4953.63 1460.74,-4953.63"/>
<text text-anchor="middle" x="1138" y="-4911.93" font-family="Times,serif" font-size="14.00">Token Router Layer 9 GPU 0</text>
<text text-anchor="middle" x="1138" y="-4896.93" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="1138" y="-4881.93" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer9_gpu0&#45;&gt;route_layer9_gpu0 -->
<g id="edge897" class="edge">
<title>gate_layer9_gpu0&#45;&gt;route_layer9_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1046.34,-4994.62C1056.87,-4983.93 1068.2,-4972.44 1079.17,-4961.31"/>
<polygon fill="black" stroke="black" points="1081.8,-4963.63 1086.32,-4954.05 1076.81,-4958.72 1081.8,-4963.63"/>
</g>
<!-- route_layer9_gpu1 -->
<g id="node781" class="node">
<title>route_layer9_gpu1</title>
<path fill="orange" stroke="black" d="M2493.74,-4953.63C2493.74,-4953.63 1985.24,-4953.63 1985.24,-4953.63 1979.24,-4953.63 1968.5,-4949.95 1963.75,-4946.28 1963.75,-4946.28 1845.75,-4854.97 1845.75,-4854.97 1841,-4851.3 1842.26,-4847.63 1848.26,-4847.63 1848.26,-4847.63 2356.76,-4847.63 2356.76,-4847.63 2362.76,-4847.63 2373.5,-4851.3 2378.25,-4854.97 2378.25,-4854.97 2496.25,-4946.28 2496.25,-4946.28 2501,-4949.95 2499.74,-4953.63 2493.74,-4953.63"/>
<text text-anchor="middle" x="2171" y="-4911.93" font-family="Times,serif" font-size="14.00">Token Router Layer 9 GPU 1</text>
<text text-anchor="middle" x="2171" y="-4896.93" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="2171" y="-4881.93" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer9_gpu1&#45;&gt;route_layer9_gpu1 -->
<g id="edge898" class="edge">
<title>gate_layer9_gpu1&#45;&gt;route_layer9_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2030.07,-4996.94C2047.71,-4985.01 2067.04,-4971.94 2085.57,-4959.41"/>
<polygon fill="black" stroke="black" points="2087.69,-4962.19 2094.02,-4953.69 2083.77,-4956.4 2087.69,-4962.19"/>
</g>
<!-- route_layer9_gpu2 -->
<g id="node783" class="node">
<title>route_layer9_gpu2</title>
<path fill="orange" stroke="black" d="M3595.74,-4953.63C3595.74,-4953.63 3087.24,-4953.63 3087.24,-4953.63 3081.24,-4953.63 3070.5,-4949.95 3065.75,-4946.28 3065.75,-4946.28 2947.75,-4854.97 2947.75,-4854.97 2943,-4851.3 2944.26,-4847.63 2950.26,-4847.63 2950.26,-4847.63 3458.76,-4847.63 3458.76,-4847.63 3464.76,-4847.63 3475.5,-4851.3 3480.25,-4854.97 3480.25,-4854.97 3598.25,-4946.28 3598.25,-4946.28 3603,-4949.95 3601.74,-4953.63 3595.74,-4953.63"/>
<text text-anchor="middle" x="3273" y="-4911.93" font-family="Times,serif" font-size="14.00">Token Router Layer 9 GPU 2</text>
<text text-anchor="middle" x="3273" y="-4896.93" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="3273" y="-4881.93" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer9_gpu2&#45;&gt;route_layer9_gpu2 -->
<g id="edge899" class="edge">
<title>gate_layer9_gpu2&#45;&gt;route_layer9_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3028.72,-5000.76C3062.04,-4987.24 3099.7,-4971.95 3135.31,-4957.5"/>
<polygon fill="black" stroke="black" points="3136.85,-4960.65 3144.8,-4953.65 3134.22,-4954.17 3136.85,-4960.65"/>
</g>
<!-- route_layer9_gpu3 -->
<g id="node785" class="node">
<title>route_layer9_gpu3</title>
<path fill="orange" stroke="black" d="M4559.74,-4953.63C4559.74,-4953.63 4051.24,-4953.63 4051.24,-4953.63 4045.24,-4953.63 4034.5,-4949.95 4029.75,-4946.28 4029.75,-4946.28 3911.75,-4854.97 3911.75,-4854.97 3907,-4851.3 3908.26,-4847.63 3914.26,-4847.63 3914.26,-4847.63 4422.76,-4847.63 4422.76,-4847.63 4428.76,-4847.63 4439.5,-4851.3 4444.25,-4854.97 4444.25,-4854.97 4562.25,-4946.28 4562.25,-4946.28 4567,-4949.95 4565.74,-4953.63 4559.74,-4953.63"/>
<text text-anchor="middle" x="4237" y="-4911.93" font-family="Times,serif" font-size="14.00">Token Router Layer 9 GPU 3</text>
<text text-anchor="middle" x="4237" y="-4896.93" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="4237" y="-4881.93" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer9_gpu3&#45;&gt;route_layer9_gpu3 -->
<g id="edge900" class="edge">
<title>gate_layer9_gpu3&#45;&gt;route_layer9_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3992.72,-5000.76C4026.04,-4987.24 4063.7,-4971.95 4099.31,-4957.5"/>
<polygon fill="black" stroke="black" points="4100.85,-4960.65 4108.8,-4953.65 4098.22,-4954.17 4100.85,-4960.65"/>
</g>
<!-- route_layer9_gpu4 -->
<g id="node787" class="node">
<title>route_layer9_gpu4</title>
<path fill="orange" stroke="black" d="M5385.74,-4953.63C5385.74,-4953.63 4877.24,-4953.63 4877.24,-4953.63 4871.24,-4953.63 4860.5,-4949.95 4855.75,-4946.28 4855.75,-4946.28 4737.75,-4854.97 4737.75,-4854.97 4733,-4851.3 4734.26,-4847.63 4740.26,-4847.63 4740.26,-4847.63 5248.76,-4847.63 5248.76,-4847.63 5254.76,-4847.63 5265.5,-4851.3 5270.25,-4854.97 5270.25,-4854.97 5388.25,-4946.28 5388.25,-4946.28 5393,-4949.95 5391.74,-4953.63 5385.74,-4953.63"/>
<text text-anchor="middle" x="5063" y="-4911.93" font-family="Times,serif" font-size="14.00">Token Router Layer 9 GPU 4</text>
<text text-anchor="middle" x="5063" y="-4896.93" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="5063" y="-4881.93" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer9_gpu4&#45;&gt;route_layer9_gpu4 -->
<g id="edge901" class="edge">
<title>gate_layer9_gpu4&#45;&gt;route_layer9_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4922.07,-4996.94C4939.71,-4985.01 4959.04,-4971.94 4977.57,-4959.41"/>
<polygon fill="black" stroke="black" points="4979.69,-4962.19 4986.02,-4953.69 4975.77,-4956.4 4979.69,-4962.19"/>
</g>
<!-- route_layer9_gpu5 -->
<g id="node789" class="node">
<title>route_layer9_gpu5</title>
<path fill="orange" stroke="black" d="M6349.74,-4953.63C6349.74,-4953.63 5841.24,-4953.63 5841.24,-4953.63 5835.24,-4953.63 5824.5,-4949.95 5819.75,-4946.28 5819.75,-4946.28 5701.75,-4854.97 5701.75,-4854.97 5697,-4851.3 5698.26,-4847.63 5704.26,-4847.63 5704.26,-4847.63 6212.76,-4847.63 6212.76,-4847.63 6218.76,-4847.63 6229.5,-4851.3 6234.25,-4854.97 6234.25,-4854.97 6352.25,-4946.28 6352.25,-4946.28 6357,-4949.95 6355.74,-4953.63 6349.74,-4953.63"/>
<text text-anchor="middle" x="6027" y="-4911.93" font-family="Times,serif" font-size="14.00">Token Router Layer 9 GPU 5</text>
<text text-anchor="middle" x="6027" y="-4896.93" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="6027" y="-4881.93" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer9_gpu5&#45;&gt;route_layer9_gpu5 -->
<g id="edge902" class="edge">
<title>gate_layer9_gpu5&#45;&gt;route_layer9_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5886.07,-4996.94C5903.71,-4985.01 5923.04,-4971.94 5941.57,-4959.41"/>
<polygon fill="black" stroke="black" points="5943.69,-4962.19 5950.02,-4953.69 5939.77,-4956.4 5943.69,-4962.19"/>
</g>
<!-- route_layer9_gpu6 -->
<g id="node791" class="node">
<title>route_layer9_gpu6</title>
<path fill="orange" stroke="black" d="M7313.74,-4953.63C7313.74,-4953.63 6805.24,-4953.63 6805.24,-4953.63 6799.24,-4953.63 6788.5,-4949.95 6783.75,-4946.28 6783.75,-4946.28 6665.75,-4854.97 6665.75,-4854.97 6661,-4851.3 6662.26,-4847.63 6668.26,-4847.63 6668.26,-4847.63 7176.76,-4847.63 7176.76,-4847.63 7182.76,-4847.63 7193.5,-4851.3 7198.25,-4854.97 7198.25,-4854.97 7316.25,-4946.28 7316.25,-4946.28 7321,-4949.95 7319.74,-4953.63 7313.74,-4953.63"/>
<text text-anchor="middle" x="6991" y="-4911.93" font-family="Times,serif" font-size="14.00">Token Router Layer 9 GPU 6</text>
<text text-anchor="middle" x="6991" y="-4896.93" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="6991" y="-4881.93" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer9_gpu6&#45;&gt;route_layer9_gpu6 -->
<g id="edge903" class="edge">
<title>gate_layer9_gpu6&#45;&gt;route_layer9_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6850.07,-4996.94C6867.71,-4985.01 6887.04,-4971.94 6905.57,-4959.41"/>
<polygon fill="black" stroke="black" points="6907.69,-4962.19 6914.02,-4953.69 6903.77,-4956.4 6907.69,-4962.19"/>
</g>
<!-- route_layer9_gpu7 -->
<g id="node793" class="node">
<title>route_layer9_gpu7</title>
<path fill="orange" stroke="black" d="M8139.74,-4953.63C8139.74,-4953.63 7631.24,-4953.63 7631.24,-4953.63 7625.24,-4953.63 7614.5,-4949.95 7609.75,-4946.28 7609.75,-4946.28 7491.75,-4854.97 7491.75,-4854.97 7487,-4851.3 7488.26,-4847.63 7494.26,-4847.63 7494.26,-4847.63 8002.76,-4847.63 8002.76,-4847.63 8008.76,-4847.63 8019.5,-4851.3 8024.25,-4854.97 8024.25,-4854.97 8142.25,-4946.28 8142.25,-4946.28 8147,-4949.95 8145.74,-4953.63 8139.74,-4953.63"/>
<text text-anchor="middle" x="7817" y="-4911.93" font-family="Times,serif" font-size="14.00">Token Router Layer 9 GPU 7</text>
<text text-anchor="middle" x="7817" y="-4896.93" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="7817" y="-4881.93" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer9_gpu7&#45;&gt;route_layer9_gpu7 -->
<g id="edge904" class="edge">
<title>gate_layer9_gpu7&#45;&gt;route_layer9_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7772.33,-4992.27C7776.97,-4982.84 7781.89,-4972.87 7786.69,-4963.12"/>
<polygon fill="black" stroke="black" points="7789.97,-4964.38 7791.26,-4953.86 7783.7,-4961.28 7789.97,-4964.38"/>
</g>
<!-- route_layer9_gpu8 -->
<g id="node795" class="node">
<title>route_layer9_gpu8</title>
<path fill="orange" stroke="black" d="M8965.74,-4953.63C8965.74,-4953.63 8457.24,-4953.63 8457.24,-4953.63 8451.24,-4953.63 8440.5,-4949.95 8435.75,-4946.28 8435.75,-4946.28 8317.75,-4854.97 8317.75,-4854.97 8313,-4851.3 8314.26,-4847.63 8320.26,-4847.63 8320.26,-4847.63 8828.76,-4847.63 8828.76,-4847.63 8834.76,-4847.63 8845.5,-4851.3 8850.25,-4854.97 8850.25,-4854.97 8968.25,-4946.28 8968.25,-4946.28 8973,-4949.95 8971.74,-4953.63 8965.74,-4953.63"/>
<text text-anchor="middle" x="8643" y="-4911.93" font-family="Times,serif" font-size="14.00">Token Router Layer 9 GPU 8</text>
<text text-anchor="middle" x="8643" y="-4896.93" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="8643" y="-4881.93" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer9_gpu8&#45;&gt;route_layer9_gpu8 -->
<g id="edge905" class="edge">
<title>gate_layer9_gpu8&#45;&gt;route_layer9_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8687.67,-4992.27C8683.03,-4982.84 8678.11,-4972.87 8673.31,-4963.12"/>
<polygon fill="black" stroke="black" points="8676.3,-4961.28 8668.74,-4953.86 8670.03,-4964.38 8676.3,-4961.28"/>
</g>
<!-- route_layer9_gpu9 -->
<g id="node797" class="node">
<title>route_layer9_gpu9</title>
<path fill="orange" stroke="black" d="M9860.74,-4953.63C9860.74,-4953.63 9352.24,-4953.63 9352.24,-4953.63 9346.24,-4953.63 9335.5,-4949.95 9330.75,-4946.28 9330.75,-4946.28 9212.75,-4854.97 9212.75,-4854.97 9208,-4851.3 9209.26,-4847.63 9215.26,-4847.63 9215.26,-4847.63 9723.76,-4847.63 9723.76,-4847.63 9729.76,-4847.63 9740.5,-4851.3 9745.25,-4854.97 9745.25,-4854.97 9863.25,-4946.28 9863.25,-4946.28 9868,-4949.95 9866.74,-4953.63 9860.74,-4953.63"/>
<text text-anchor="middle" x="9538" y="-4911.93" font-family="Times,serif" font-size="14.00">Token Router Layer 9 GPU 9</text>
<text text-anchor="middle" x="9538" y="-4896.93" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="9538" y="-4881.93" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer9_gpu9&#45;&gt;route_layer9_gpu9 -->
<g id="edge906" class="edge">
<title>gate_layer9_gpu9&#45;&gt;route_layer9_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9629.66,-4994.62C9619.13,-4983.93 9607.8,-4972.44 9596.83,-4961.31"/>
<polygon fill="black" stroke="black" points="9599.19,-4958.72 9589.68,-4954.05 9594.2,-4963.63 9599.19,-4958.72"/>
</g>
<!-- route_layer9_gpu10 -->
<g id="node799" class="node">
<title>route_layer9_gpu10</title>
<path fill="orange" stroke="black" d="M10789.74,-4953.63C10789.74,-4953.63 10281.24,-4953.63 10281.24,-4953.63 10275.24,-4953.63 10264.5,-4949.95 10259.75,-4946.28 10259.75,-4946.28 10141.75,-4854.97 10141.75,-4854.97 10137,-4851.3 10138.26,-4847.63 10144.26,-4847.63 10144.26,-4847.63 10652.76,-4847.63 10652.76,-4847.63 10658.76,-4847.63 10669.5,-4851.3 10674.25,-4854.97 10674.25,-4854.97 10792.25,-4946.28 10792.25,-4946.28 10797,-4949.95 10795.74,-4953.63 10789.74,-4953.63"/>
<text text-anchor="middle" x="10467" y="-4911.93" font-family="Times,serif" font-size="14.00">Token Router Layer 9 GPU 10</text>
<text text-anchor="middle" x="10467" y="-4896.93" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="10467" y="-4881.93" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer9_gpu10&#45;&gt;route_layer9_gpu10 -->
<g id="edge907" class="edge">
<title>gate_layer9_gpu10&#45;&gt;route_layer9_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10583.35,-4995.79C10569.3,-4984.41 10554.05,-4972.07 10539.36,-4960.19"/>
<polygon fill="black" stroke="black" points="10541.24,-4957.21 10531.27,-4953.64 10536.84,-4962.65 10541.24,-4957.21"/>
</g>
<!-- route_layer9_gpu11 -->
<g id="node801" class="node">
<title>route_layer9_gpu11</title>
<path fill="orange" stroke="black" d="M11736.74,-4953.63C11736.74,-4953.63 11228.24,-4953.63 11228.24,-4953.63 11222.24,-4953.63 11211.5,-4949.95 11206.75,-4946.28 11206.75,-4946.28 11088.75,-4854.97 11088.75,-4854.97 11084,-4851.3 11085.26,-4847.63 11091.26,-4847.63 11091.26,-4847.63 11599.76,-4847.63 11599.76,-4847.63 11605.76,-4847.63 11616.5,-4851.3 11621.25,-4854.97 11621.25,-4854.97 11739.25,-4946.28 11739.25,-4946.28 11744,-4949.95 11742.74,-4953.63 11736.74,-4953.63"/>
<text text-anchor="middle" x="11414" y="-4911.93" font-family="Times,serif" font-size="14.00">Token Router Layer 9 GPU 11</text>
<text text-anchor="middle" x="11414" y="-4896.93" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="11414" y="-4881.93" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer9_gpu11&#45;&gt;route_layer9_gpu11 -->
<g id="edge908" class="edge">
<title>gate_layer9_gpu11&#45;&gt;route_layer9_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11542.57,-4996.37C11526.74,-4984.69 11509.47,-4971.97 11492.87,-4959.74"/>
<polygon fill="black" stroke="black" points="11494.92,-4956.9 11484.79,-4953.79 11490.77,-4962.54 11494.92,-4956.9"/>
</g>
<!-- route_layer9_gpu12 -->
<g id="node803" class="node">
<title>route_layer9_gpu12</title>
<path fill="orange" stroke="black" d="M12691.74,-4953.63C12691.74,-4953.63 12183.24,-4953.63 12183.24,-4953.63 12177.24,-4953.63 12166.5,-4949.95 12161.75,-4946.28 12161.75,-4946.28 12043.75,-4854.97 12043.75,-4854.97 12039,-4851.3 12040.26,-4847.63 12046.26,-4847.63 12046.26,-4847.63 12554.76,-4847.63 12554.76,-4847.63 12560.76,-4847.63 12571.5,-4851.3 12576.25,-4854.97 12576.25,-4854.97 12694.25,-4946.28 12694.25,-4946.28 12699,-4949.95 12697.74,-4953.63 12691.74,-4953.63"/>
<text text-anchor="middle" x="12369" y="-4911.93" font-family="Times,serif" font-size="14.00">Token Router Layer 9 GPU 12</text>
<text text-anchor="middle" x="12369" y="-4896.93" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="12369" y="-4881.93" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer9_gpu12&#45;&gt;route_layer9_gpu12 -->
<g id="edge909" class="edge">
<title>gate_layer9_gpu12&#45;&gt;route_layer9_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12504.21,-4996.75C12487.51,-4985 12469.25,-4972.16 12451.71,-4959.82"/>
<polygon fill="black" stroke="black" points="12453.36,-4956.7 12443.17,-4953.81 12449.34,-4962.42 12453.36,-4956.7"/>
</g>
<!-- route_layer9_gpu13 -->
<g id="node805" class="node">
<title>route_layer9_gpu13</title>
<path fill="orange" stroke="black" d="M13651.74,-4953.63C13651.74,-4953.63 13143.24,-4953.63 13143.24,-4953.63 13137.24,-4953.63 13126.5,-4949.95 13121.75,-4946.28 13121.75,-4946.28 13003.75,-4854.97 13003.75,-4854.97 12999,-4851.3 13000.26,-4847.63 13006.26,-4847.63 13006.26,-4847.63 13514.76,-4847.63 13514.76,-4847.63 13520.76,-4847.63 13531.5,-4851.3 13536.25,-4854.97 13536.25,-4854.97 13654.25,-4946.28 13654.25,-4946.28 13659,-4949.95 13657.74,-4953.63 13651.74,-4953.63"/>
<text text-anchor="middle" x="13329" y="-4911.93" font-family="Times,serif" font-size="14.00">Token Router Layer 9 GPU 13</text>
<text text-anchor="middle" x="13329" y="-4896.93" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="13329" y="-4881.93" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer9_gpu13&#45;&gt;route_layer9_gpu13 -->
<g id="edge910" class="edge">
<title>gate_layer9_gpu13&#45;&gt;route_layer9_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13466.93,-4996.75C13449.89,-4985 13431.27,-4972.16 13413.38,-4959.82"/>
<polygon fill="black" stroke="black" points="13414.88,-4956.6 13404.66,-4953.81 13410.91,-4962.37 13414.88,-4956.6"/>
</g>
<!-- route_layer9_gpu14 -->
<g id="node807" class="node">
<title>route_layer9_gpu14</title>
<path fill="orange" stroke="black" d="M14613.74,-4953.63C14613.74,-4953.63 14105.24,-4953.63 14105.24,-4953.63 14099.24,-4953.63 14088.5,-4949.95 14083.75,-4946.28 14083.75,-4946.28 13965.75,-4854.97 13965.75,-4854.97 13961,-4851.3 13962.26,-4847.63 13968.26,-4847.63 13968.26,-4847.63 14476.76,-4847.63 14476.76,-4847.63 14482.76,-4847.63 14493.5,-4851.3 14498.25,-4854.97 14498.25,-4854.97 14616.25,-4946.28 14616.25,-4946.28 14621,-4949.95 14619.74,-4953.63 14613.74,-4953.63"/>
<text text-anchor="middle" x="14291" y="-4911.93" font-family="Times,serif" font-size="14.00">Token Router Layer 9 GPU 14</text>
<text text-anchor="middle" x="14291" y="-4896.93" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="14291" y="-4881.93" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer9_gpu14&#45;&gt;route_layer9_gpu14 -->
<g id="edge911" class="edge">
<title>gate_layer9_gpu14&#45;&gt;route_layer9_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14430.57,-4996.94C14413.1,-4985.01 14393.96,-4971.94 14375.61,-4959.41"/>
<polygon fill="black" stroke="black" points="14377.47,-4956.44 14367.24,-4953.69 14373.52,-4962.22 14377.47,-4956.44"/>
</g>
<!-- route_layer9_gpu15 -->
<g id="node809" class="node">
<title>route_layer9_gpu15</title>
<path fill="orange" stroke="black" d="M15576.74,-4953.63C15576.74,-4953.63 15068.24,-4953.63 15068.24,-4953.63 15062.24,-4953.63 15051.5,-4949.95 15046.75,-4946.28 15046.75,-4946.28 14928.75,-4854.97 14928.75,-4854.97 14924,-4851.3 14925.26,-4847.63 14931.26,-4847.63 14931.26,-4847.63 15439.76,-4847.63 15439.76,-4847.63 15445.76,-4847.63 15456.5,-4851.3 15461.25,-4854.97 15461.25,-4854.97 15579.25,-4946.28 15579.25,-4946.28 15584,-4949.95 15582.74,-4953.63 15576.74,-4953.63"/>
<text text-anchor="middle" x="15254" y="-4911.93" font-family="Times,serif" font-size="14.00">Token Router Layer 9 GPU 15</text>
<text text-anchor="middle" x="15254" y="-4896.93" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="15254" y="-4881.93" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer9_gpu15&#45;&gt;route_layer9_gpu15 -->
<g id="edge912" class="edge">
<title>gate_layer9_gpu15&#45;&gt;route_layer9_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15394.25,-4996.94C15376.69,-4985.01 15357.46,-4971.94 15339.02,-4959.41"/>
<polygon fill="black" stroke="black" points="15340.85,-4956.42 15330.61,-4953.69 15336.91,-4962.21 15340.85,-4956.42"/>
</g>
<!-- expert_layer9_gpu0_expert0 -->
<g id="node763" class="node">
<title>expert_layer9_gpu0_expert0</title>
<path fill="lightcoral" stroke="black" d="M2278.5,-4700.67C2278.5,-4700.67 1809.5,-4700.67 1809.5,-4700.67 1803.5,-4700.67 1797.5,-4694.67 1797.5,-4688.67 1797.5,-4688.67 1797.5,-4644.67 1797.5,-4644.67 1797.5,-4638.67 1803.5,-4632.67 1809.5,-4632.67 1809.5,-4632.67 2278.5,-4632.67 2278.5,-4632.67 2284.5,-4632.67 2290.5,-4638.67 2290.5,-4644.67 2290.5,-4644.67 2290.5,-4688.67 2290.5,-4688.67 2290.5,-4694.67 2284.5,-4700.67 2278.5,-4700.67"/>
<text text-anchor="middle" x="2044" y="-4685.47" font-family="Times,serif" font-size="14.00">Expert 0 Layer 9 GPU 0</text>
<text text-anchor="middle" x="2044" y="-4670.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2044" y="-4655.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2044" y="-4640.47" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer9_gpu0 -->
<g id="node780" class="node">
<title>aggregate_layer9_gpu0</title>
<path fill="orange" stroke="black" d="M1663.29,-4596.67C1663.29,-4596.67 1176.19,-4596.67 1176.19,-4596.67 1170.19,-4596.67 1159.52,-4592.91 1154.85,-4589.14 1154.85,-4589.14 1042.06,-4498.2 1042.06,-4498.2 1037.38,-4494.44 1038.71,-4490.67 1044.71,-4490.67 1044.71,-4490.67 1531.81,-4490.67 1531.81,-4490.67 1537.81,-4490.67 1548.48,-4494.44 1553.15,-4498.2 1553.15,-4498.2 1665.94,-4589.14 1665.94,-4589.14 1670.62,-4592.91 1669.29,-4596.67 1663.29,-4596.67"/>
<text text-anchor="middle" x="1354" y="-4554.97" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 9 GPU 0</text>
<text text-anchor="middle" x="1354" y="-4539.97" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="1354" y="-4524.97" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer9_gpu0_expert0&#45;&gt;aggregate_layer9_gpu0 -->
<g id="edge945" class="edge">
<title>expert_layer9_gpu0_expert0&#45;&gt;aggregate_layer9_gpu0</title>
<path fill="none" stroke="black" d="M1855.45,-4632.61C1795.3,-4622.06 1727.09,-4610.1 1660.79,-4598.47"/>
<polygon fill="black" stroke="black" points="1661.05,-4594.96 1650.6,-4596.68 1659.84,-4601.86 1661.05,-4594.96"/>
</g>
<!-- expert_layer9_gpu1_expert1 -->
<g id="node764" class="node">
<title>expert_layer9_gpu1_expert1</title>
<path fill="lightcoral" stroke="black" d="M3179.5,-4700.67C3179.5,-4700.67 2710.5,-4700.67 2710.5,-4700.67 2704.5,-4700.67 2698.5,-4694.67 2698.5,-4688.67 2698.5,-4688.67 2698.5,-4644.67 2698.5,-4644.67 2698.5,-4638.67 2704.5,-4632.67 2710.5,-4632.67 2710.5,-4632.67 3179.5,-4632.67 3179.5,-4632.67 3185.5,-4632.67 3191.5,-4638.67 3191.5,-4644.67 3191.5,-4644.67 3191.5,-4688.67 3191.5,-4688.67 3191.5,-4694.67 3185.5,-4700.67 3179.5,-4700.67"/>
<text text-anchor="middle" x="2945" y="-4685.47" font-family="Times,serif" font-size="14.00">Expert 1 Layer 9 GPU 1</text>
<text text-anchor="middle" x="2945" y="-4670.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2945" y="-4655.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2945" y="-4640.47" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer9_gpu1 -->
<g id="node782" class="node">
<title>aggregate_layer9_gpu1</title>
<path fill="orange" stroke="black" d="M2480.29,-4596.67C2480.29,-4596.67 1993.19,-4596.67 1993.19,-4596.67 1987.19,-4596.67 1976.52,-4592.91 1971.85,-4589.14 1971.85,-4589.14 1859.06,-4498.2 1859.06,-4498.2 1854.38,-4494.44 1855.71,-4490.67 1861.71,-4490.67 1861.71,-4490.67 2348.81,-4490.67 2348.81,-4490.67 2354.81,-4490.67 2365.48,-4494.44 2370.15,-4498.2 2370.15,-4498.2 2482.94,-4589.14 2482.94,-4589.14 2487.62,-4592.91 2486.29,-4596.67 2480.29,-4596.67"/>
<text text-anchor="middle" x="2171" y="-4554.97" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 9 GPU 1</text>
<text text-anchor="middle" x="2171" y="-4539.97" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="2171" y="-4524.97" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer9_gpu1_expert1&#45;&gt;aggregate_layer9_gpu1 -->
<g id="edge946" class="edge">
<title>expert_layer9_gpu1_expert1&#45;&gt;aggregate_layer9_gpu1</title>
<path fill="none" stroke="black" d="M2733.76,-4632.65C2661.64,-4621.38 2579.19,-4608.49 2500.05,-4596.11"/>
<polygon fill="black" stroke="black" points="2500.33,-4592.62 2489.91,-4594.53 2499.25,-4599.53 2500.33,-4592.62"/>
</g>
<!-- expert_layer9_gpu2_expert2 -->
<g id="node765" class="node">
<title>expert_layer9_gpu2_expert2</title>
<path fill="lightcoral" stroke="black" d="M4005.5,-4700.67C4005.5,-4700.67 3536.5,-4700.67 3536.5,-4700.67 3530.5,-4700.67 3524.5,-4694.67 3524.5,-4688.67 3524.5,-4688.67 3524.5,-4644.67 3524.5,-4644.67 3524.5,-4638.67 3530.5,-4632.67 3536.5,-4632.67 3536.5,-4632.67 4005.5,-4632.67 4005.5,-4632.67 4011.5,-4632.67 4017.5,-4638.67 4017.5,-4644.67 4017.5,-4644.67 4017.5,-4688.67 4017.5,-4688.67 4017.5,-4694.67 4011.5,-4700.67 4005.5,-4700.67"/>
<text text-anchor="middle" x="3771" y="-4685.47" font-family="Times,serif" font-size="14.00">Expert 2 Layer 9 GPU 2</text>
<text text-anchor="middle" x="3771" y="-4670.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3771" y="-4655.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3771" y="-4640.47" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer9_gpu2 -->
<g id="node784" class="node">
<title>aggregate_layer9_gpu2</title>
<path fill="orange" stroke="black" d="M3801.29,-4596.67C3801.29,-4596.67 3314.19,-4596.67 3314.19,-4596.67 3308.19,-4596.67 3297.52,-4592.91 3292.85,-4589.14 3292.85,-4589.14 3180.06,-4498.2 3180.06,-4498.2 3175.38,-4494.44 3176.71,-4490.67 3182.71,-4490.67 3182.71,-4490.67 3669.81,-4490.67 3669.81,-4490.67 3675.81,-4490.67 3686.48,-4494.44 3691.15,-4498.2 3691.15,-4498.2 3803.94,-4589.14 3803.94,-4589.14 3808.62,-4592.91 3807.29,-4596.67 3801.29,-4596.67"/>
<text text-anchor="middle" x="3492" y="-4554.97" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 9 GPU 2</text>
<text text-anchor="middle" x="3492" y="-4539.97" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="3492" y="-4524.97" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer9_gpu2_expert2&#45;&gt;aggregate_layer9_gpu2 -->
<g id="edge947" class="edge">
<title>expert_layer9_gpu2_expert2&#45;&gt;aggregate_layer9_gpu2</title>
<path fill="none" stroke="black" d="M3694.76,-4632.61C3671.99,-4622.73 3646.36,-4611.62 3621.18,-4600.7"/>
<polygon fill="black" stroke="black" points="3622.49,-4597.45 3611.93,-4596.68 3619.71,-4603.87 3622.49,-4597.45"/>
</g>
<!-- expert_layer9_gpu3_expert3 -->
<g id="node766" class="node">
<title>expert_layer9_gpu3_expert3</title>
<path fill="lightcoral" stroke="black" d="M4921.5,-4700.67C4921.5,-4700.67 4452.5,-4700.67 4452.5,-4700.67 4446.5,-4700.67 4440.5,-4694.67 4440.5,-4688.67 4440.5,-4688.67 4440.5,-4644.67 4440.5,-4644.67 4440.5,-4638.67 4446.5,-4632.67 4452.5,-4632.67 4452.5,-4632.67 4921.5,-4632.67 4921.5,-4632.67 4927.5,-4632.67 4933.5,-4638.67 4933.5,-4644.67 4933.5,-4644.67 4933.5,-4688.67 4933.5,-4688.67 4933.5,-4694.67 4927.5,-4700.67 4921.5,-4700.67"/>
<text text-anchor="middle" x="4687" y="-4685.47" font-family="Times,serif" font-size="14.00">Expert 3 Layer 9 GPU 3</text>
<text text-anchor="middle" x="4687" y="-4670.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4687" y="-4655.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4687" y="-4640.47" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer9_gpu3 -->
<g id="node786" class="node">
<title>aggregate_layer9_gpu3</title>
<path fill="orange" stroke="black" d="M4796.29,-4596.67C4796.29,-4596.67 4309.19,-4596.67 4309.19,-4596.67 4303.19,-4596.67 4292.52,-4592.91 4287.85,-4589.14 4287.85,-4589.14 4175.06,-4498.2 4175.06,-4498.2 4170.38,-4494.44 4171.71,-4490.67 4177.71,-4490.67 4177.71,-4490.67 4664.81,-4490.67 4664.81,-4490.67 4670.81,-4490.67 4681.48,-4494.44 4686.15,-4498.2 4686.15,-4498.2 4798.94,-4589.14 4798.94,-4589.14 4803.62,-4592.91 4802.29,-4596.67 4796.29,-4596.67"/>
<text text-anchor="middle" x="4487" y="-4554.97" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 9 GPU 3</text>
<text text-anchor="middle" x="4487" y="-4539.97" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="4487" y="-4524.97" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer9_gpu3_expert3&#45;&gt;aggregate_layer9_gpu3 -->
<g id="edge948" class="edge">
<title>expert_layer9_gpu3_expert3&#45;&gt;aggregate_layer9_gpu3</title>
<path fill="none" stroke="black" d="M4632.35,-4632.61C4616.79,-4623.19 4599.37,-4612.66 4582.14,-4602.23"/>
<polygon fill="black" stroke="black" points="4583.53,-4598.98 4573.16,-4596.8 4579.9,-4604.97 4583.53,-4598.98"/>
</g>
<!-- expert_layer9_gpu4_expert4 -->
<g id="node767" class="node">
<title>expert_layer9_gpu4_expert4</title>
<path fill="lightcoral" stroke="black" d="M6027.5,-4700.67C6027.5,-4700.67 5558.5,-4700.67 5558.5,-4700.67 5552.5,-4700.67 5546.5,-4694.67 5546.5,-4688.67 5546.5,-4688.67 5546.5,-4644.67 5546.5,-4644.67 5546.5,-4638.67 5552.5,-4632.67 5558.5,-4632.67 5558.5,-4632.67 6027.5,-4632.67 6027.5,-4632.67 6033.5,-4632.67 6039.5,-4638.67 6039.5,-4644.67 6039.5,-4644.67 6039.5,-4688.67 6039.5,-4688.67 6039.5,-4694.67 6033.5,-4700.67 6027.5,-4700.67"/>
<text text-anchor="middle" x="5793" y="-4685.47" font-family="Times,serif" font-size="14.00">Expert 4 Layer 9 GPU 4</text>
<text text-anchor="middle" x="5793" y="-4670.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5793" y="-4655.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5793" y="-4640.47" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer9_gpu4 -->
<g id="node788" class="node">
<title>aggregate_layer9_gpu4</title>
<path fill="orange" stroke="black" d="M5597.29,-4596.67C5597.29,-4596.67 5110.19,-4596.67 5110.19,-4596.67 5104.19,-4596.67 5093.52,-4592.91 5088.85,-4589.14 5088.85,-4589.14 4976.06,-4498.2 4976.06,-4498.2 4971.38,-4494.44 4972.71,-4490.67 4978.71,-4490.67 4978.71,-4490.67 5465.81,-4490.67 5465.81,-4490.67 5471.81,-4490.67 5482.48,-4494.44 5487.15,-4498.2 5487.15,-4498.2 5599.94,-4589.14 5599.94,-4589.14 5604.62,-4592.91 5603.29,-4596.67 5597.29,-4596.67"/>
<text text-anchor="middle" x="5288" y="-4554.97" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 9 GPU 4</text>
<text text-anchor="middle" x="5288" y="-4539.97" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="5288" y="-4524.97" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer9_gpu4_expert4&#45;&gt;aggregate_layer9_gpu4 -->
<g id="edge949" class="edge">
<title>expert_layer9_gpu4_expert4&#45;&gt;aggregate_layer9_gpu4</title>
<path fill="none" stroke="black" d="M5655.01,-4632.61C5611.7,-4622.23 5562.7,-4610.49 5514.93,-4599.05"/>
<polygon fill="black" stroke="black" points="5515.61,-4595.61 5505.07,-4596.68 5513.98,-4602.42 5515.61,-4595.61"/>
</g>
<!-- expert_layer9_gpu5_expert5 -->
<g id="node768" class="node">
<title>expert_layer9_gpu5_expert5</title>
<path fill="lightcoral" stroke="black" d="M6836.5,-4700.67C6836.5,-4700.67 6367.5,-4700.67 6367.5,-4700.67 6361.5,-4700.67 6355.5,-4694.67 6355.5,-4688.67 6355.5,-4688.67 6355.5,-4644.67 6355.5,-4644.67 6355.5,-4638.67 6361.5,-4632.67 6367.5,-4632.67 6367.5,-4632.67 6836.5,-4632.67 6836.5,-4632.67 6842.5,-4632.67 6848.5,-4638.67 6848.5,-4644.67 6848.5,-4644.67 6848.5,-4688.67 6848.5,-4688.67 6848.5,-4694.67 6842.5,-4700.67 6836.5,-4700.67"/>
<text text-anchor="middle" x="6602" y="-4685.47" font-family="Times,serif" font-size="14.00">Expert 5 Layer 9 GPU 5</text>
<text text-anchor="middle" x="6602" y="-4670.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6602" y="-4655.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6602" y="-4640.47" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer9_gpu5 -->
<g id="node790" class="node">
<title>aggregate_layer9_gpu5</title>
<path fill="orange" stroke="black" d="M6553.29,-4596.67C6553.29,-4596.67 6066.19,-4596.67 6066.19,-4596.67 6060.19,-4596.67 6049.52,-4592.91 6044.85,-4589.14 6044.85,-4589.14 5932.06,-4498.2 5932.06,-4498.2 5927.38,-4494.44 5928.71,-4490.67 5934.71,-4490.67 5934.71,-4490.67 6421.81,-4490.67 6421.81,-4490.67 6427.81,-4490.67 6438.48,-4494.44 6443.15,-4498.2 6443.15,-4498.2 6555.94,-4589.14 6555.94,-4589.14 6560.62,-4592.91 6559.29,-4596.67 6553.29,-4596.67"/>
<text text-anchor="middle" x="6244" y="-4554.97" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 9 GPU 5</text>
<text text-anchor="middle" x="6244" y="-4539.97" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="6244" y="-4524.97" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer9_gpu5_expert5&#45;&gt;aggregate_layer9_gpu5 -->
<g id="edge950" class="edge">
<title>expert_layer9_gpu5_expert5&#45;&gt;aggregate_layer9_gpu5</title>
<path fill="none" stroke="black" d="M6504.17,-4632.61C6474.31,-4622.52 6440.62,-4611.13 6407.63,-4599.98"/>
<polygon fill="black" stroke="black" points="6408.48,-4596.57 6397.89,-4596.68 6406.24,-4603.2 6408.48,-4596.57"/>
</g>
<!-- expert_layer9_gpu6_expert6 -->
<g id="node769" class="node">
<title>expert_layer9_gpu6_expert6</title>
<path fill="lightcoral" stroke="black" d="M7496.5,-4700.67C7496.5,-4700.67 7027.5,-4700.67 7027.5,-4700.67 7021.5,-4700.67 7015.5,-4694.67 7015.5,-4688.67 7015.5,-4688.67 7015.5,-4644.67 7015.5,-4644.67 7015.5,-4638.67 7021.5,-4632.67 7027.5,-4632.67 7027.5,-4632.67 7496.5,-4632.67 7496.5,-4632.67 7502.5,-4632.67 7508.5,-4638.67 7508.5,-4644.67 7508.5,-4644.67 7508.5,-4688.67 7508.5,-4688.67 7508.5,-4694.67 7502.5,-4700.67 7496.5,-4700.67"/>
<text text-anchor="middle" x="7262" y="-4685.47" font-family="Times,serif" font-size="14.00">Expert 6 Layer 9 GPU 6</text>
<text text-anchor="middle" x="7262" y="-4670.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7262" y="-4655.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7262" y="-4640.47" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer9_gpu6 -->
<g id="node792" class="node">
<title>aggregate_layer9_gpu6</title>
<path fill="orange" stroke="black" d="M7362.29,-4596.67C7362.29,-4596.67 6875.19,-4596.67 6875.19,-4596.67 6869.19,-4596.67 6858.52,-4592.91 6853.85,-4589.14 6853.85,-4589.14 6741.06,-4498.2 6741.06,-4498.2 6736.38,-4494.44 6737.71,-4490.67 6743.71,-4490.67 6743.71,-4490.67 7230.81,-4490.67 7230.81,-4490.67 7236.81,-4490.67 7247.48,-4494.44 7252.15,-4498.2 7252.15,-4498.2 7364.94,-4589.14 7364.94,-4589.14 7369.62,-4592.91 7368.29,-4596.67 7362.29,-4596.67"/>
<text text-anchor="middle" x="7053" y="-4554.97" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 9 GPU 6</text>
<text text-anchor="middle" x="7053" y="-4539.97" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="7053" y="-4524.97" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer9_gpu6_expert6&#45;&gt;aggregate_layer9_gpu6 -->
<g id="edge951" class="edge">
<title>expert_layer9_gpu6_expert6&#45;&gt;aggregate_layer9_gpu6</title>
<path fill="none" stroke="black" d="M7204.89,-4632.61C7188.48,-4623.11 7170.09,-4612.46 7151.93,-4601.95"/>
<polygon fill="black" stroke="black" points="7153.45,-4598.78 7143.04,-4596.8 7149.94,-4604.84 7153.45,-4598.78"/>
</g>
<!-- expert_layer9_gpu7_expert7 -->
<g id="node770" class="node">
<title>expert_layer9_gpu7_expert7</title>
<path fill="lightcoral" stroke="black" d="M8081.5,-4700.67C8081.5,-4700.67 7612.5,-4700.67 7612.5,-4700.67 7606.5,-4700.67 7600.5,-4694.67 7600.5,-4688.67 7600.5,-4688.67 7600.5,-4644.67 7600.5,-4644.67 7600.5,-4638.67 7606.5,-4632.67 7612.5,-4632.67 7612.5,-4632.67 8081.5,-4632.67 8081.5,-4632.67 8087.5,-4632.67 8093.5,-4638.67 8093.5,-4644.67 8093.5,-4644.67 8093.5,-4688.67 8093.5,-4688.67 8093.5,-4694.67 8087.5,-4700.67 8081.5,-4700.67"/>
<text text-anchor="middle" x="7847" y="-4685.47" font-family="Times,serif" font-size="14.00">Expert 7 Layer 9 GPU 7</text>
<text text-anchor="middle" x="7847" y="-4670.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7847" y="-4655.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7847" y="-4640.47" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer9_gpu7 -->
<g id="node794" class="node">
<title>aggregate_layer9_gpu7</title>
<path fill="orange" stroke="black" d="M8097.29,-4596.67C8097.29,-4596.67 7610.19,-4596.67 7610.19,-4596.67 7604.19,-4596.67 7593.52,-4592.91 7588.85,-4589.14 7588.85,-4589.14 7476.06,-4498.2 7476.06,-4498.2 7471.38,-4494.44 7472.71,-4490.67 7478.71,-4490.67 7478.71,-4490.67 7965.81,-4490.67 7965.81,-4490.67 7971.81,-4490.67 7982.48,-4494.44 7987.15,-4498.2 7987.15,-4498.2 8099.94,-4589.14 8099.94,-4589.14 8104.62,-4592.91 8103.29,-4596.67 8097.29,-4596.67"/>
<text text-anchor="middle" x="7788" y="-4554.97" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 9 GPU 7</text>
<text text-anchor="middle" x="7788" y="-4539.97" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="7788" y="-4524.97" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer9_gpu7_expert7&#45;&gt;aggregate_layer9_gpu7 -->
<g id="edge952" class="edge">
<title>expert_layer9_gpu7_expert7&#45;&gt;aggregate_layer9_gpu7</title>
<path fill="none" stroke="black" d="M7830.88,-4632.61C7826.83,-4624.32 7822.37,-4615.15 7817.89,-4605.97"/>
<polygon fill="black" stroke="black" points="7820.95,-4604.25 7813.42,-4596.8 7814.65,-4607.32 7820.95,-4604.25"/>
</g>
<!-- expert_layer9_gpu8_expert8 -->
<g id="node771" class="node">
<title>expert_layer9_gpu8_expert8</title>
<path fill="lightcoral" stroke="black" d="M8709.5,-4700.67C8709.5,-4700.67 8240.5,-4700.67 8240.5,-4700.67 8234.5,-4700.67 8228.5,-4694.67 8228.5,-4688.67 8228.5,-4688.67 8228.5,-4644.67 8228.5,-4644.67 8228.5,-4638.67 8234.5,-4632.67 8240.5,-4632.67 8240.5,-4632.67 8709.5,-4632.67 8709.5,-4632.67 8715.5,-4632.67 8721.5,-4638.67 8721.5,-4644.67 8721.5,-4644.67 8721.5,-4688.67 8721.5,-4688.67 8721.5,-4694.67 8715.5,-4700.67 8709.5,-4700.67"/>
<text text-anchor="middle" x="8475" y="-4685.47" font-family="Times,serif" font-size="14.00">Expert 8 Layer 9 GPU 8</text>
<text text-anchor="middle" x="8475" y="-4670.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8475" y="-4655.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8475" y="-4640.47" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer9_gpu8 -->
<g id="node796" class="node">
<title>aggregate_layer9_gpu8</title>
<path fill="orange" stroke="black" d="M8843.29,-4596.67C8843.29,-4596.67 8356.19,-4596.67 8356.19,-4596.67 8350.19,-4596.67 8339.52,-4592.91 8334.85,-4589.14 8334.85,-4589.14 8222.06,-4498.2 8222.06,-4498.2 8217.38,-4494.44 8218.71,-4490.67 8224.71,-4490.67 8224.71,-4490.67 8711.81,-4490.67 8711.81,-4490.67 8717.81,-4490.67 8728.48,-4494.44 8733.15,-4498.2 8733.15,-4498.2 8845.94,-4589.14 8845.94,-4589.14 8850.62,-4592.91 8849.29,-4596.67 8843.29,-4596.67"/>
<text text-anchor="middle" x="8534" y="-4554.97" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 9 GPU 8</text>
<text text-anchor="middle" x="8534" y="-4539.97" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="8534" y="-4524.97" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer9_gpu8_expert8&#45;&gt;aggregate_layer9_gpu8 -->
<g id="edge953" class="edge">
<title>expert_layer9_gpu8_expert8&#45;&gt;aggregate_layer9_gpu8</title>
<path fill="none" stroke="black" d="M8491.12,-4632.61C8495.17,-4624.32 8499.63,-4615.15 8504.11,-4605.97"/>
<polygon fill="black" stroke="black" points="8507.35,-4607.32 8508.58,-4596.8 8501.05,-4604.25 8507.35,-4607.32"/>
</g>
<!-- expert_layer9_gpu9_expert9 -->
<g id="node772" class="node">
<title>expert_layer9_gpu9_expert9</title>
<path fill="lightcoral" stroke="black" d="M9429.5,-4700.67C9429.5,-4700.67 8960.5,-4700.67 8960.5,-4700.67 8954.5,-4700.67 8948.5,-4694.67 8948.5,-4688.67 8948.5,-4688.67 8948.5,-4644.67 8948.5,-4644.67 8948.5,-4638.67 8954.5,-4632.67 8960.5,-4632.67 8960.5,-4632.67 9429.5,-4632.67 9429.5,-4632.67 9435.5,-4632.67 9441.5,-4638.67 9441.5,-4644.67 9441.5,-4644.67 9441.5,-4688.67 9441.5,-4688.67 9441.5,-4694.67 9435.5,-4700.67 9429.5,-4700.67"/>
<text text-anchor="middle" x="9195" y="-4685.47" font-family="Times,serif" font-size="14.00">Expert 9 Layer 9 GPU 9</text>
<text text-anchor="middle" x="9195" y="-4670.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9195" y="-4655.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9195" y="-4640.47" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer9_gpu9 -->
<g id="node798" class="node">
<title>aggregate_layer9_gpu9</title>
<path fill="orange" stroke="black" d="M9655.29,-4596.67C9655.29,-4596.67 9168.19,-4596.67 9168.19,-4596.67 9162.19,-4596.67 9151.52,-4592.91 9146.85,-4589.14 9146.85,-4589.14 9034.06,-4498.2 9034.06,-4498.2 9029.38,-4494.44 9030.71,-4490.67 9036.71,-4490.67 9036.71,-4490.67 9523.81,-4490.67 9523.81,-4490.67 9529.81,-4490.67 9540.48,-4494.44 9545.15,-4498.2 9545.15,-4498.2 9657.94,-4589.14 9657.94,-4589.14 9662.62,-4592.91 9661.29,-4596.67 9655.29,-4596.67"/>
<text text-anchor="middle" x="9346" y="-4554.97" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 9 GPU 9</text>
<text text-anchor="middle" x="9346" y="-4539.97" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="9346" y="-4524.97" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer9_gpu9_expert9&#45;&gt;aggregate_layer9_gpu9 -->
<g id="edge954" class="edge">
<title>expert_layer9_gpu9_expert9&#45;&gt;aggregate_layer9_gpu9</title>
<path fill="none" stroke="black" d="M9236.26,-4632.61C9247.69,-4623.45 9260.44,-4613.24 9273.09,-4603.09"/>
<polygon fill="black" stroke="black" points="9275.33,-4605.78 9280.95,-4596.8 9270.96,-4600.32 9275.33,-4605.78"/>
</g>
<!-- expert_layer9_gpu10_expert10 -->
<g id="node773" class="node">
<title>expert_layer9_gpu10_expert10</title>
<path fill="lightcoral" stroke="black" d="M10158.5,-4700.67C10158.5,-4700.67 9689.5,-4700.67 9689.5,-4700.67 9683.5,-4700.67 9677.5,-4694.67 9677.5,-4688.67 9677.5,-4688.67 9677.5,-4644.67 9677.5,-4644.67 9677.5,-4638.67 9683.5,-4632.67 9689.5,-4632.67 9689.5,-4632.67 10158.5,-4632.67 10158.5,-4632.67 10164.5,-4632.67 10170.5,-4638.67 10170.5,-4644.67 10170.5,-4644.67 10170.5,-4688.67 10170.5,-4688.67 10170.5,-4694.67 10164.5,-4700.67 10158.5,-4700.67"/>
<text text-anchor="middle" x="9924" y="-4685.47" font-family="Times,serif" font-size="14.00">Expert 10 Layer 9 GPU 10</text>
<text text-anchor="middle" x="9924" y="-4670.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9924" y="-4655.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9924" y="-4640.47" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer9_gpu10 -->
<g id="node800" class="node">
<title>aggregate_layer9_gpu10</title>
<path fill="orange" stroke="black" d="M10392.29,-4596.67C10392.29,-4596.67 9905.19,-4596.67 9905.19,-4596.67 9899.19,-4596.67 9888.52,-4592.91 9883.85,-4589.14 9883.85,-4589.14 9771.06,-4498.2 9771.06,-4498.2 9766.38,-4494.44 9767.71,-4490.67 9773.71,-4490.67 9773.71,-4490.67 10260.81,-4490.67 10260.81,-4490.67 10266.81,-4490.67 10277.48,-4494.44 10282.15,-4498.2 10282.15,-4498.2 10394.94,-4589.14 10394.94,-4589.14 10399.62,-4592.91 10398.29,-4596.67 10392.29,-4596.67"/>
<text text-anchor="middle" x="10083" y="-4554.97" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 9 GPU 10</text>
<text text-anchor="middle" x="10083" y="-4539.97" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="10083" y="-4524.97" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer9_gpu10_expert10&#45;&gt;aggregate_layer9_gpu10 -->
<g id="edge955" class="edge">
<title>expert_layer9_gpu10_expert10&#45;&gt;aggregate_layer9_gpu10</title>
<path fill="none" stroke="black" d="M9967.45,-4632.61C9979.48,-4623.45 9992.91,-4613.24 10006.23,-4603.09"/>
<polygon fill="black" stroke="black" points="10008.66,-4605.64 10014.5,-4596.8 10004.43,-4600.07 10008.66,-4605.64"/>
</g>
<!-- expert_layer9_gpu11_expert11 -->
<g id="node774" class="node">
<title>expert_layer9_gpu11_expert11</title>
<path fill="lightcoral" stroke="black" d="M10872.5,-4700.67C10872.5,-4700.67 10403.5,-4700.67 10403.5,-4700.67 10397.5,-4700.67 10391.5,-4694.67 10391.5,-4688.67 10391.5,-4688.67 10391.5,-4644.67 10391.5,-4644.67 10391.5,-4638.67 10397.5,-4632.67 10403.5,-4632.67 10403.5,-4632.67 10872.5,-4632.67 10872.5,-4632.67 10878.5,-4632.67 10884.5,-4638.67 10884.5,-4644.67 10884.5,-4644.67 10884.5,-4688.67 10884.5,-4688.67 10884.5,-4694.67 10878.5,-4700.67 10872.5,-4700.67"/>
<text text-anchor="middle" x="10638" y="-4685.47" font-family="Times,serif" font-size="14.00">Expert 11 Layer 9 GPU 11</text>
<text text-anchor="middle" x="10638" y="-4670.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10638" y="-4655.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10638" y="-4640.47" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer9_gpu11 -->
<g id="node802" class="node">
<title>aggregate_layer9_gpu11</title>
<path fill="orange" stroke="black" d="M11091.29,-4596.67C11091.29,-4596.67 10604.19,-4596.67 10604.19,-4596.67 10598.19,-4596.67 10587.52,-4592.91 10582.85,-4589.14 10582.85,-4589.14 10470.06,-4498.2 10470.06,-4498.2 10465.38,-4494.44 10466.71,-4490.67 10472.71,-4490.67 10472.71,-4490.67 10959.81,-4490.67 10959.81,-4490.67 10965.81,-4490.67 10976.48,-4494.44 10981.15,-4498.2 10981.15,-4498.2 11093.94,-4589.14 11093.94,-4589.14 11098.62,-4592.91 11097.29,-4596.67 11091.29,-4596.67"/>
<text text-anchor="middle" x="10782" y="-4554.97" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 9 GPU 11</text>
<text text-anchor="middle" x="10782" y="-4539.97" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="10782" y="-4524.97" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer9_gpu11_expert11&#45;&gt;aggregate_layer9_gpu11 -->
<g id="edge956" class="edge">
<title>expert_layer9_gpu11_expert11&#45;&gt;aggregate_layer9_gpu11</title>
<path fill="none" stroke="black" d="M10677.35,-4632.61C10688.14,-4623.54 10700.18,-4613.43 10712.13,-4603.38"/>
<polygon fill="black" stroke="black" points="10714.56,-4605.91 10719.96,-4596.8 10710.06,-4600.55 10714.56,-4605.91"/>
</g>
<!-- expert_layer9_gpu12_expert12 -->
<g id="node775" class="node">
<title>expert_layer9_gpu12_expert12</title>
<path fill="lightcoral" stroke="black" d="M11796.5,-4700.67C11796.5,-4700.67 11327.5,-4700.67 11327.5,-4700.67 11321.5,-4700.67 11315.5,-4694.67 11315.5,-4688.67 11315.5,-4688.67 11315.5,-4644.67 11315.5,-4644.67 11315.5,-4638.67 11321.5,-4632.67 11327.5,-4632.67 11327.5,-4632.67 11796.5,-4632.67 11796.5,-4632.67 11802.5,-4632.67 11808.5,-4638.67 11808.5,-4644.67 11808.5,-4644.67 11808.5,-4688.67 11808.5,-4688.67 11808.5,-4694.67 11802.5,-4700.67 11796.5,-4700.67"/>
<text text-anchor="middle" x="11562" y="-4685.47" font-family="Times,serif" font-size="14.00">Expert 12 Layer 9 GPU 12</text>
<text text-anchor="middle" x="11562" y="-4670.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11562" y="-4655.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11562" y="-4640.47" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer9_gpu12 -->
<g id="node804" class="node">
<title>aggregate_layer9_gpu12</title>
<path fill="orange" stroke="black" d="M12225.29,-4596.67C12225.29,-4596.67 11738.19,-4596.67 11738.19,-4596.67 11732.19,-4596.67 11721.52,-4592.91 11716.85,-4589.14 11716.85,-4589.14 11604.06,-4498.2 11604.06,-4498.2 11599.38,-4494.44 11600.71,-4490.67 11606.71,-4490.67 11606.71,-4490.67 12093.81,-4490.67 12093.81,-4490.67 12099.81,-4490.67 12110.48,-4494.44 12115.15,-4498.2 12115.15,-4498.2 12227.94,-4589.14 12227.94,-4589.14 12232.62,-4592.91 12231.29,-4596.67 12225.29,-4596.67"/>
<text text-anchor="middle" x="11916" y="-4554.97" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 9 GPU 12</text>
<text text-anchor="middle" x="11916" y="-4539.97" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="11916" y="-4524.97" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer9_gpu12_expert12&#45;&gt;aggregate_layer9_gpu12 -->
<g id="edge957" class="edge">
<title>expert_layer9_gpu12_expert12&#45;&gt;aggregate_layer9_gpu12</title>
<path fill="none" stroke="black" d="M11658.73,-4632.61C11688.26,-4622.52 11721.58,-4611.13 11754.2,-4599.98"/>
<polygon fill="black" stroke="black" points="11755.5,-4603.23 11763.83,-4596.68 11753.24,-4596.61 11755.5,-4603.23"/>
</g>
<!-- expert_layer9_gpu13_expert13 -->
<g id="node776" class="node">
<title>expert_layer9_gpu13_expert13</title>
<path fill="lightcoral" stroke="black" d="M12707.5,-4700.67C12707.5,-4700.67 12238.5,-4700.67 12238.5,-4700.67 12232.5,-4700.67 12226.5,-4694.67 12226.5,-4688.67 12226.5,-4688.67 12226.5,-4644.67 12226.5,-4644.67 12226.5,-4638.67 12232.5,-4632.67 12238.5,-4632.67 12238.5,-4632.67 12707.5,-4632.67 12707.5,-4632.67 12713.5,-4632.67 12719.5,-4638.67 12719.5,-4644.67 12719.5,-4644.67 12719.5,-4688.67 12719.5,-4688.67 12719.5,-4694.67 12713.5,-4700.67 12707.5,-4700.67"/>
<text text-anchor="middle" x="12473" y="-4685.47" font-family="Times,serif" font-size="14.00">Expert 13 Layer 9 GPU 13</text>
<text text-anchor="middle" x="12473" y="-4670.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12473" y="-4655.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12473" y="-4640.47" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer9_gpu13 -->
<g id="node806" class="node">
<title>aggregate_layer9_gpu13</title>
<path fill="orange" stroke="black" d="M13123.29,-4596.67C13123.29,-4596.67 12636.19,-4596.67 12636.19,-4596.67 12630.19,-4596.67 12619.52,-4592.91 12614.85,-4589.14 12614.85,-4589.14 12502.06,-4498.2 12502.06,-4498.2 12497.38,-4494.44 12498.71,-4490.67 12504.71,-4490.67 12504.71,-4490.67 12991.81,-4490.67 12991.81,-4490.67 12997.81,-4490.67 13008.48,-4494.44 13013.15,-4498.2 13013.15,-4498.2 13125.94,-4589.14 13125.94,-4589.14 13130.62,-4592.91 13129.29,-4596.67 13123.29,-4596.67"/>
<text text-anchor="middle" x="12814" y="-4554.97" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 9 GPU 13</text>
<text text-anchor="middle" x="12814" y="-4539.97" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="12814" y="-4524.97" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer9_gpu13_expert13&#45;&gt;aggregate_layer9_gpu13 -->
<g id="edge958" class="edge">
<title>expert_layer9_gpu13_expert13&#45;&gt;aggregate_layer9_gpu13</title>
<path fill="none" stroke="black" d="M12566.18,-4632.61C12594.5,-4622.56 12626.44,-4611.23 12657.74,-4600.12"/>
<polygon fill="black" stroke="black" points="12659.17,-4603.33 12667.42,-4596.68 12656.83,-4596.73 12659.17,-4603.33"/>
</g>
<!-- expert_layer9_gpu14_expert14 -->
<g id="node777" class="node">
<title>expert_layer9_gpu14_expert14</title>
<path fill="lightcoral" stroke="black" d="M13552.5,-4700.67C13552.5,-4700.67 13083.5,-4700.67 13083.5,-4700.67 13077.5,-4700.67 13071.5,-4694.67 13071.5,-4688.67 13071.5,-4688.67 13071.5,-4644.67 13071.5,-4644.67 13071.5,-4638.67 13077.5,-4632.67 13083.5,-4632.67 13083.5,-4632.67 13552.5,-4632.67 13552.5,-4632.67 13558.5,-4632.67 13564.5,-4638.67 13564.5,-4644.67 13564.5,-4644.67 13564.5,-4688.67 13564.5,-4688.67 13564.5,-4694.67 13558.5,-4700.67 13552.5,-4700.67"/>
<text text-anchor="middle" x="13318" y="-4685.47" font-family="Times,serif" font-size="14.00">Expert 14 Layer 9 GPU 14</text>
<text text-anchor="middle" x="13318" y="-4670.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="13318" y="-4655.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="13318" y="-4640.47" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer9_gpu14 -->
<g id="node808" class="node">
<title>aggregate_layer9_gpu14</title>
<path fill="orange" stroke="black" d="M13902.29,-4596.67C13902.29,-4596.67 13415.19,-4596.67 13415.19,-4596.67 13409.19,-4596.67 13398.52,-4592.91 13393.85,-4589.14 13393.85,-4589.14 13281.06,-4498.2 13281.06,-4498.2 13276.38,-4494.44 13277.71,-4490.67 13283.71,-4490.67 13283.71,-4490.67 13770.81,-4490.67 13770.81,-4490.67 13776.81,-4490.67 13787.48,-4494.44 13792.15,-4498.2 13792.15,-4498.2 13904.94,-4589.14 13904.94,-4589.14 13909.62,-4592.91 13908.29,-4596.67 13902.29,-4596.67"/>
<text text-anchor="middle" x="13593" y="-4554.97" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 9 GPU 14</text>
<text text-anchor="middle" x="13593" y="-4539.97" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="13593" y="-4524.97" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer9_gpu14_expert14&#45;&gt;aggregate_layer9_gpu14 -->
<g id="edge959" class="edge">
<title>expert_layer9_gpu14_expert14&#45;&gt;aggregate_layer9_gpu14</title>
<path fill="none" stroke="black" d="M13393.14,-4632.61C13415.5,-4622.78 13440.63,-4611.71 13465.35,-4600.84"/>
<polygon fill="black" stroke="black" points="13467.05,-4603.92 13474.79,-4596.68 13464.23,-4597.51 13467.05,-4603.92"/>
</g>
<!-- expert_layer9_gpu15_expert15 -->
<g id="node778" class="node">
<title>expert_layer9_gpu15_expert15</title>
<path fill="lightcoral" stroke="black" d="M14583.5,-4700.67C14583.5,-4700.67 14114.5,-4700.67 14114.5,-4700.67 14108.5,-4700.67 14102.5,-4694.67 14102.5,-4688.67 14102.5,-4688.67 14102.5,-4644.67 14102.5,-4644.67 14102.5,-4638.67 14108.5,-4632.67 14114.5,-4632.67 14114.5,-4632.67 14583.5,-4632.67 14583.5,-4632.67 14589.5,-4632.67 14595.5,-4638.67 14595.5,-4644.67 14595.5,-4644.67 14595.5,-4688.67 14595.5,-4688.67 14595.5,-4694.67 14589.5,-4700.67 14583.5,-4700.67"/>
<text text-anchor="middle" x="14349" y="-4685.47" font-family="Times,serif" font-size="14.00">Expert 15 Layer 9 GPU 15</text>
<text text-anchor="middle" x="14349" y="-4670.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14349" y="-4655.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14349" y="-4640.47" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer9_gpu15 -->
<g id="node810" class="node">
<title>aggregate_layer9_gpu15</title>
<path fill="orange" stroke="black" d="M15120.29,-4596.67C15120.29,-4596.67 14633.19,-4596.67 14633.19,-4596.67 14627.19,-4596.67 14616.52,-4592.91 14611.85,-4589.14 14611.85,-4589.14 14499.06,-4498.2 14499.06,-4498.2 14494.38,-4494.44 14495.71,-4490.67 14501.71,-4490.67 14501.71,-4490.67 14988.81,-4490.67 14988.81,-4490.67 14994.81,-4490.67 15005.48,-4494.44 15010.15,-4498.2 15010.15,-4498.2 15122.94,-4589.14 15122.94,-4589.14 15127.62,-4592.91 15126.29,-4596.67 15120.29,-4596.67"/>
<text text-anchor="middle" x="14811" y="-4554.97" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 9 GPU 15</text>
<text text-anchor="middle" x="14811" y="-4539.97" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="14811" y="-4524.97" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer9_gpu15_expert15&#45;&gt;aggregate_layer9_gpu15 -->
<g id="edge960" class="edge">
<title>expert_layer9_gpu15_expert15&#45;&gt;aggregate_layer9_gpu15</title>
<path fill="none" stroke="black" d="M14475.24,-4632.61C14516.65,-4621.77 14563.75,-4609.43 14609.31,-4597.5"/>
<polygon fill="black" stroke="black" points="14610.21,-4600.88 14619,-4594.96 14608.44,-4594.11 14610.21,-4600.88"/>
</g>
<!-- comm_layer9 -->
<g id="node811" class="node">
<title>comm_layer9</title>
<ellipse fill="lightpink" stroke="black" cx="8161" cy="-4774.15" rx="243.49" ry="37.45"/>
<text text-anchor="middle" x="8161" y="-4785.45" font-family="Times,serif" font-size="14.00">Cross&#45;GPU Communication Layer 9</text>
<text text-anchor="middle" x="8161" y="-4770.45" font-family="Times,serif" font-size="14.00">Input: Tokens from routing decisions</text>
<text text-anchor="middle" x="8161" y="-4755.45" font-family="Times,serif" font-size="14.00">Output: Tokens delivered to destination GPUs</text>
</g>
<!-- route_layer9_gpu0&#45;&gt;comm_layer9 -->
<g id="edge913" class="edge">
<title>route_layer9_gpu0&#45;&gt;comm_layer9</title>
<path fill="none" stroke="black" d="M1375.34,-4877.96C1508.07,-4866.78 1676.59,-4854.16 1827,-4847.63 3041.67,-4794.89 6883.32,-4779.19 7907.83,-4775.88"/>
<polygon fill="black" stroke="black" points="7907.92,-4779.38 7917.91,-4775.85 7907.89,-4772.38 7907.92,-4779.38"/>
</g>
<!-- mha_layer10_gpu0 -->
<g id="node812" class="node">
<title>mha_layer10_gpu0</title>
<path fill="lightblue" stroke="black" d="M1427,-4454.67C1427,-4454.67 979,-4454.67 979,-4454.67 973,-4454.67 967,-4448.67 967,-4442.67 967,-4442.67 967,-4413.67 967,-4413.67 967,-4407.67 973,-4401.67 979,-4401.67 979,-4401.67 1427,-4401.67 1427,-4401.67 1433,-4401.67 1439,-4407.67 1439,-4413.67 1439,-4413.67 1439,-4442.67 1439,-4442.67 1439,-4448.67 1433,-4454.67 1427,-4454.67"/>
<text text-anchor="middle" x="1203" y="-4439.47" font-family="Times,serif" font-size="14.00">MHA Layer 10 GPU 0</text>
<text text-anchor="middle" x="1203" y="-4424.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1203" y="-4409.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer9_gpu0&#45;&gt;mha_layer10_gpu0 -->
<g id="edge961" class="edge">
<title>aggregate_layer9_gpu0&#45;&gt;mha_layer10_gpu0</title>
<path fill="none" stroke="black" d="M1284.69,-4490.57C1271.21,-4480.44 1257.46,-4470.11 1245.19,-4460.88"/>
<polygon fill="black" stroke="black" points="1247.04,-4457.9 1236.94,-4454.69 1242.83,-4463.49 1247.04,-4457.9"/>
</g>
<!-- route_layer9_gpu1&#45;&gt;comm_layer9 -->
<g id="edge914" class="edge">
<title>route_layer9_gpu1&#45;&gt;comm_layer9</title>
<path fill="none" stroke="black" d="M2410.64,-4879.82C2559.68,-4868.34 2755.36,-4854.78 2929,-4847.63 3915.87,-4806.97 7001.27,-4783.09 7908.01,-4776.82"/>
<polygon fill="black" stroke="black" points="7908.27,-4780.32 7918.24,-4776.75 7908.22,-4773.32 7908.27,-4780.32"/>
</g>
<!-- mha_layer10_gpu1 -->
<g id="node813" class="node">
<title>mha_layer10_gpu1</title>
<path fill="lightblue" stroke="black" d="M2234,-4454.67C2234,-4454.67 1786,-4454.67 1786,-4454.67 1780,-4454.67 1774,-4448.67 1774,-4442.67 1774,-4442.67 1774,-4413.67 1774,-4413.67 1774,-4407.67 1780,-4401.67 1786,-4401.67 1786,-4401.67 2234,-4401.67 2234,-4401.67 2240,-4401.67 2246,-4407.67 2246,-4413.67 2246,-4413.67 2246,-4442.67 2246,-4442.67 2246,-4448.67 2240,-4454.67 2234,-4454.67"/>
<text text-anchor="middle" x="2010" y="-4439.47" font-family="Times,serif" font-size="14.00">MHA Layer 10 GPU 1</text>
<text text-anchor="middle" x="2010" y="-4424.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2010" y="-4409.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer9_gpu1&#45;&gt;mha_layer10_gpu1 -->
<g id="edge962" class="edge">
<title>aggregate_layer9_gpu1&#45;&gt;mha_layer10_gpu1</title>
<path fill="none" stroke="black" d="M2097.1,-4490.57C2082.59,-4480.34 2067.79,-4469.91 2054.6,-4460.62"/>
<polygon fill="black" stroke="black" points="2056.38,-4457.59 2046.19,-4454.69 2052.35,-4463.31 2056.38,-4457.59"/>
</g>
<!-- route_layer9_gpu2&#45;&gt;comm_layer9 -->
<g id="edge915" class="edge">
<title>route_layer9_gpu2&#45;&gt;comm_layer9</title>
<path fill="none" stroke="black" d="M3507.91,-4876.21C3623.73,-4865.61 3765.57,-4854.05 3893,-4847.63 4681.68,-4807.9 7115.1,-4784.09 7908.23,-4777.23"/>
<polygon fill="black" stroke="black" points="7908.38,-4780.72 7918.35,-4777.14 7908.32,-4773.72 7908.38,-4780.72"/>
</g>
<!-- mha_layer10_gpu2 -->
<g id="node814" class="node">
<title>mha_layer10_gpu2</title>
<path fill="lightblue" stroke="black" d="M3328,-4454.67C3328,-4454.67 2880,-4454.67 2880,-4454.67 2874,-4454.67 2868,-4448.67 2868,-4442.67 2868,-4442.67 2868,-4413.67 2868,-4413.67 2868,-4407.67 2874,-4401.67 2880,-4401.67 2880,-4401.67 3328,-4401.67 3328,-4401.67 3334,-4401.67 3340,-4407.67 3340,-4413.67 3340,-4413.67 3340,-4442.67 3340,-4442.67 3340,-4448.67 3334,-4454.67 3328,-4454.67"/>
<text text-anchor="middle" x="3104" y="-4439.47" font-family="Times,serif" font-size="14.00">MHA Layer 10 GPU 2</text>
<text text-anchor="middle" x="3104" y="-4424.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3104" y="-4409.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer9_gpu2&#45;&gt;mha_layer10_gpu2 -->
<g id="edge963" class="edge">
<title>aggregate_layer9_gpu2&#45;&gt;mha_layer10_gpu2</title>
<path fill="none" stroke="black" d="M3314.18,-4490.66C3275.35,-4479.3 3235.64,-4467.68 3201.35,-4457.65"/>
<polygon fill="black" stroke="black" points="3201.94,-4454.18 3191.36,-4454.73 3199.97,-4460.89 3201.94,-4454.18"/>
</g>
<!-- route_layer9_gpu3&#45;&gt;comm_layer9 -->
<g id="edge916" class="edge">
<title>route_layer9_gpu3&#45;&gt;comm_layer9</title>
<path fill="none" stroke="black" d="M4464.98,-4870.95C4545.15,-4861.94 4635.95,-4852.97 4719,-4847.63 5339.19,-4807.72 7223.05,-4784.82 7908.32,-4777.63"/>
<polygon fill="black" stroke="black" points="7908.61,-4781.13 7918.57,-4777.53 7908.54,-4774.13 7908.61,-4781.13"/>
</g>
<!-- mha_layer10_gpu3 -->
<g id="node815" class="node">
<title>mha_layer10_gpu3</title>
<path fill="lightblue" stroke="black" d="M4432,-4454.67C4432,-4454.67 3984,-4454.67 3984,-4454.67 3978,-4454.67 3972,-4448.67 3972,-4442.67 3972,-4442.67 3972,-4413.67 3972,-4413.67 3972,-4407.67 3978,-4401.67 3984,-4401.67 3984,-4401.67 4432,-4401.67 4432,-4401.67 4438,-4401.67 4444,-4407.67 4444,-4413.67 4444,-4413.67 4444,-4442.67 4444,-4442.67 4444,-4448.67 4438,-4454.67 4432,-4454.67"/>
<text text-anchor="middle" x="4208" y="-4439.47" font-family="Times,serif" font-size="14.00">MHA Layer 10 GPU 3</text>
<text text-anchor="middle" x="4208" y="-4424.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4208" y="-4409.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer9_gpu3&#45;&gt;mha_layer10_gpu3 -->
<g id="edge964" class="edge">
<title>aggregate_layer9_gpu3&#45;&gt;mha_layer10_gpu3</title>
<path fill="none" stroke="black" d="M4358.93,-4490.57C4331.87,-4479.56 4304.23,-4468.32 4280.12,-4458.51"/>
<polygon fill="black" stroke="black" points="4281.3,-4455.21 4270.72,-4454.69 4278.66,-4461.7 4281.3,-4455.21"/>
</g>
<!-- route_layer9_gpu4&#45;&gt;comm_layer9 -->
<g id="edge917" class="edge">
<title>route_layer9_gpu4&#45;&gt;comm_layer9</title>
<path fill="none" stroke="black" d="M5298.68,-4876.82C5414.37,-4866.4 5555.88,-4854.81 5683,-4847.63 6495.66,-4801.7 7459.99,-4784.07 7908.38,-4778"/>
<polygon fill="black" stroke="black" points="7908.6,-4781.5 7918.55,-4777.86 7908.51,-4774.5 7908.6,-4781.5"/>
</g>
<!-- mha_layer10_gpu4 -->
<g id="node816" class="node">
<title>mha_layer10_gpu4</title>
<path fill="lightblue" stroke="black" d="M5089,-4454.67C5089,-4454.67 4641,-4454.67 4641,-4454.67 4635,-4454.67 4629,-4448.67 4629,-4442.67 4629,-4442.67 4629,-4413.67 4629,-4413.67 4629,-4407.67 4635,-4401.67 4641,-4401.67 4641,-4401.67 5089,-4401.67 5089,-4401.67 5095,-4401.67 5101,-4407.67 5101,-4413.67 5101,-4413.67 5101,-4442.67 5101,-4442.67 5101,-4448.67 5095,-4454.67 5089,-4454.67"/>
<text text-anchor="middle" x="4865" y="-4439.47" font-family="Times,serif" font-size="14.00">MHA Layer 10 GPU 4</text>
<text text-anchor="middle" x="4865" y="-4424.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4865" y="-4409.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer9_gpu4&#45;&gt;mha_layer10_gpu4 -->
<g id="edge965" class="edge">
<title>aggregate_layer9_gpu4&#45;&gt;mha_layer10_gpu4</title>
<path fill="none" stroke="black" d="M5094.14,-4490.66C5051.44,-4479.2 5007.78,-4467.48 4970.17,-4457.39"/>
<polygon fill="black" stroke="black" points="4970.8,-4453.94 4960.24,-4454.73 4968.99,-4460.7 4970.8,-4453.94"/>
</g>
<!-- route_layer9_gpu5&#45;&gt;comm_layer9 -->
<g id="edge918" class="edge">
<title>route_layer9_gpu5&#45;&gt;comm_layer9</title>
<path fill="none" stroke="black" d="M6263.85,-4877.76C6379.35,-4867.6 6520.35,-4855.97 6647,-4847.63 7094.05,-4818.19 7616.11,-4795.85 7915.68,-4784.19"/>
<polygon fill="black" stroke="black" points="7915.95,-4787.68 7925.81,-4783.8 7915.68,-4780.69 7915.95,-4787.68"/>
</g>
<!-- mha_layer10_gpu5 -->
<g id="node817" class="node">
<title>mha_layer10_gpu5</title>
<path fill="lightblue" stroke="black" d="M6165,-4454.67C6165,-4454.67 5717,-4454.67 5717,-4454.67 5711,-4454.67 5705,-4448.67 5705,-4442.67 5705,-4442.67 5705,-4413.67 5705,-4413.67 5705,-4407.67 5711,-4401.67 5717,-4401.67 5717,-4401.67 6165,-4401.67 6165,-4401.67 6171,-4401.67 6177,-4407.67 6177,-4413.67 6177,-4413.67 6177,-4442.67 6177,-4442.67 6177,-4448.67 6171,-4454.67 6165,-4454.67"/>
<text text-anchor="middle" x="5941" y="-4439.47" font-family="Times,serif" font-size="14.00">MHA Layer 10 GPU 5</text>
<text text-anchor="middle" x="5941" y="-4424.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5941" y="-4409.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer9_gpu5&#45;&gt;mha_layer10_gpu5 -->
<g id="edge966" class="edge">
<title>aggregate_layer9_gpu5&#45;&gt;mha_layer10_gpu5</title>
<path fill="none" stroke="black" d="M6104.92,-4490.57C6075.26,-4479.47 6044.97,-4468.12 6018.63,-4458.25"/>
<polygon fill="black" stroke="black" points="6019.7,-4454.92 6009.11,-4454.69 6017.25,-4461.47 6019.7,-4454.92"/>
</g>
<!-- route_layer9_gpu6&#45;&gt;comm_layer9 -->
<g id="edge919" class="edge">
<title>route_layer9_gpu6&#45;&gt;comm_layer9</title>
<path fill="none" stroke="black" d="M7223.58,-4874.42C7302.73,-4865.87 7391.71,-4856.29 7473,-4847.63 7633.93,-4830.47 7816.07,-4811.29 7952.5,-4796.98"/>
<polygon fill="black" stroke="black" points="7953.07,-4800.44 7962.65,-4795.91 7952.34,-4793.47 7953.07,-4800.44"/>
</g>
<!-- mha_layer10_gpu6 -->
<g id="node818" class="node">
<title>mha_layer10_gpu6</title>
<path fill="lightblue" stroke="black" d="M7126,-4454.67C7126,-4454.67 6678,-4454.67 6678,-4454.67 6672,-4454.67 6666,-4448.67 6666,-4442.67 6666,-4442.67 6666,-4413.67 6666,-4413.67 6666,-4407.67 6672,-4401.67 6678,-4401.67 6678,-4401.67 7126,-4401.67 7126,-4401.67 7132,-4401.67 7138,-4407.67 7138,-4413.67 7138,-4413.67 7138,-4442.67 7138,-4442.67 7138,-4448.67 7132,-4454.67 7126,-4454.67"/>
<text text-anchor="middle" x="6902" y="-4439.47" font-family="Times,serif" font-size="14.00">MHA Layer 10 GPU 6</text>
<text text-anchor="middle" x="6902" y="-4424.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6902" y="-4409.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer9_gpu6&#45;&gt;mha_layer10_gpu6 -->
<g id="edge967" class="edge">
<title>aggregate_layer9_gpu6&#45;&gt;mha_layer10_gpu6</title>
<path fill="none" stroke="black" d="M6983.69,-4490.57C6970.21,-4480.44 6956.46,-4470.11 6944.19,-4460.88"/>
<polygon fill="black" stroke="black" points="6946.04,-4457.9 6935.94,-4454.69 6941.83,-4463.49 6946.04,-4457.9"/>
</g>
<!-- route_layer9_gpu7&#45;&gt;comm_layer9 -->
<g id="edge920" class="edge">
<title>route_layer9_gpu7&#45;&gt;comm_layer9</title>
<path fill="none" stroke="black" d="M7960.89,-4847.56C7993.54,-4835.75 8027.57,-4823.43 8058.12,-4812.38"/>
<polygon fill="black" stroke="black" points="8059.69,-4815.53 8067.91,-4808.84 8057.31,-4808.95 8059.69,-4815.53"/>
</g>
<!-- mha_layer10_gpu7 -->
<g id="node819" class="node">
<title>mha_layer10_gpu7</title>
<path fill="lightblue" stroke="black" d="M7880,-4454.67C7880,-4454.67 7432,-4454.67 7432,-4454.67 7426,-4454.67 7420,-4448.67 7420,-4442.67 7420,-4442.67 7420,-4413.67 7420,-4413.67 7420,-4407.67 7426,-4401.67 7432,-4401.67 7432,-4401.67 7880,-4401.67 7880,-4401.67 7886,-4401.67 7892,-4407.67 7892,-4413.67 7892,-4413.67 7892,-4442.67 7892,-4442.67 7892,-4448.67 7886,-4454.67 7880,-4454.67"/>
<text text-anchor="middle" x="7656" y="-4439.47" font-family="Times,serif" font-size="14.00">MHA Layer 10 GPU 7</text>
<text text-anchor="middle" x="7656" y="-4424.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7656" y="-4409.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer9_gpu7&#45;&gt;mha_layer10_gpu7 -->
<g id="edge968" class="edge">
<title>aggregate_layer9_gpu7&#45;&gt;mha_layer10_gpu7</title>
<path fill="none" stroke="black" d="M7727.41,-4490.57C7715.85,-4480.64 7704.07,-4470.51 7693.5,-4461.42"/>
<polygon fill="black" stroke="black" points="7695.54,-4458.55 7685.67,-4454.69 7690.97,-4463.86 7695.54,-4458.55"/>
</g>
<!-- route_layer9_gpu8&#45;&gt;comm_layer9 -->
<g id="edge921" class="edge">
<title>route_layer9_gpu8&#45;&gt;comm_layer9</title>
<path fill="none" stroke="black" d="M8441.38,-4847.56C8391.27,-4834.62 8338.83,-4821.07 8293.03,-4809.25"/>
<polygon fill="black" stroke="black" points="8293.62,-4805.78 8283.06,-4806.67 8291.87,-4812.56 8293.62,-4805.78"/>
</g>
<!-- mha_layer10_gpu8 -->
<g id="node820" class="node">
<title>mha_layer10_gpu8</title>
<path fill="lightblue" stroke="black" d="M8791,-4454.67C8791,-4454.67 8343,-4454.67 8343,-4454.67 8337,-4454.67 8331,-4448.67 8331,-4442.67 8331,-4442.67 8331,-4413.67 8331,-4413.67 8331,-4407.67 8337,-4401.67 8343,-4401.67 8343,-4401.67 8791,-4401.67 8791,-4401.67 8797,-4401.67 8803,-4407.67 8803,-4413.67 8803,-4413.67 8803,-4442.67 8803,-4442.67 8803,-4448.67 8797,-4454.67 8791,-4454.67"/>
<text text-anchor="middle" x="8567" y="-4439.47" font-family="Times,serif" font-size="14.00">MHA Layer 10 GPU 8</text>
<text text-anchor="middle" x="8567" y="-4424.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8567" y="-4409.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer9_gpu8&#45;&gt;mha_layer10_gpu8 -->
<g id="edge969" class="edge">
<title>aggregate_layer9_gpu8&#45;&gt;mha_layer10_gpu8</title>
<path fill="none" stroke="black" d="M8549.15,-4490.57C8551.73,-4481.71 8554.35,-4472.69 8556.76,-4464.39"/>
<polygon fill="black" stroke="black" points="8560.15,-4465.27 8559.58,-4454.69 8553.43,-4463.31 8560.15,-4465.27"/>
</g>
<!-- route_layer9_gpu9&#45;&gt;comm_layer9 -->
<g id="edge922" class="edge">
<title>route_layer9_gpu9&#45;&gt;comm_layer9</title>
<path fill="none" stroke="black" d="M9232.73,-4870.46C9152.78,-4862.92 9066.66,-4854.88 8987,-4847.63 8781.63,-4828.93 8547.46,-4808.46 8381.03,-4794.06"/>
<polygon fill="black" stroke="black" points="8380.93,-4790.54 8370.67,-4793.16 8380.33,-4797.51 8380.93,-4790.54"/>
</g>
<!-- mha_layer10_gpu9 -->
<g id="node821" class="node">
<title>mha_layer10_gpu9</title>
<path fill="lightblue" stroke="black" d="M9779,-4454.67C9779,-4454.67 9331,-4454.67 9331,-4454.67 9325,-4454.67 9319,-4448.67 9319,-4442.67 9319,-4442.67 9319,-4413.67 9319,-4413.67 9319,-4407.67 9325,-4401.67 9331,-4401.67 9331,-4401.67 9779,-4401.67 9779,-4401.67 9785,-4401.67 9791,-4407.67 9791,-4413.67 9791,-4413.67 9791,-4442.67 9791,-4442.67 9791,-4448.67 9785,-4454.67 9779,-4454.67"/>
<text text-anchor="middle" x="9555" y="-4439.47" font-family="Times,serif" font-size="14.00">MHA Layer 10 GPU 9</text>
<text text-anchor="middle" x="9555" y="-4424.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9555" y="-4409.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer9_gpu9&#45;&gt;mha_layer10_gpu9 -->
<g id="edge970" class="edge">
<title>aggregate_layer9_gpu9&#45;&gt;mha_layer10_gpu9</title>
<path fill="none" stroke="black" d="M9441.94,-4490.57C9461.49,-4479.95 9481.45,-4469.12 9499.05,-4459.56"/>
<polygon fill="black" stroke="black" points="9500.9,-4462.53 9508.02,-4454.69 9497.56,-4456.38 9500.9,-4462.53"/>
</g>
<!-- route_layer9_gpu10&#45;&gt;comm_layer9 -->
<g id="edge923" class="edge">
<title>route_layer9_gpu10&#45;&gt;comm_layer9</title>
<path fill="none" stroke="black" d="M10160.56,-4869.68C10070.85,-4861.65 9972.55,-4853.55 9882,-4847.63 9358.68,-4813.37 8744.71,-4792.03 8409.88,-4781.99"/>
<polygon fill="black" stroke="black" points="8409.67,-4778.49 8399.57,-4781.69 8409.46,-4785.48 8409.67,-4778.49"/>
</g>
<!-- mha_layer10_gpu10 -->
<g id="node822" class="node">
<title>mha_layer10_gpu10</title>
<path fill="lightblue" stroke="black" d="M10440,-4454.67C10440,-4454.67 9992,-4454.67 9992,-4454.67 9986,-4454.67 9980,-4448.67 9980,-4442.67 9980,-4442.67 9980,-4413.67 9980,-4413.67 9980,-4407.67 9986,-4401.67 9992,-4401.67 9992,-4401.67 10440,-4401.67 10440,-4401.67 10446,-4401.67 10452,-4407.67 10452,-4413.67 10452,-4413.67 10452,-4442.67 10452,-4442.67 10452,-4448.67 10446,-4454.67 10440,-4454.67"/>
<text text-anchor="middle" x="10216" y="-4439.47" font-family="Times,serif" font-size="14.00">MHA Layer 10 GPU 10</text>
<text text-anchor="middle" x="10216" y="-4424.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10216" y="-4409.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer9_gpu10&#45;&gt;mha_layer10_gpu10 -->
<g id="edge971" class="edge">
<title>aggregate_layer9_gpu10&#45;&gt;mha_layer10_gpu10</title>
<path fill="none" stroke="black" d="M10144.05,-4490.57C10155.7,-4480.64 10167.57,-4470.51 10178.22,-4461.42"/>
<polygon fill="black" stroke="black" points="10180.77,-4463.84 10186.1,-4454.69 10176.22,-4458.52 10180.77,-4463.84"/>
</g>
<!-- route_layer9_gpu11&#45;&gt;comm_layer9 -->
<g id="edge924" class="edge">
<title>route_layer9_gpu11&#45;&gt;comm_layer9</title>
<path fill="none" stroke="black" d="M11107.49,-4869.69C11012.54,-4861.36 10907.51,-4853.1 10811,-4847.63 9931.29,-4797.71 8885.29,-4781.92 8413.71,-4777.13"/>
<polygon fill="black" stroke="black" points="8413.75,-4773.63 8403.71,-4777.03 8413.68,-4780.63 8413.75,-4773.63"/>
</g>
<!-- mha_layer10_gpu11 -->
<g id="node823" class="node">
<title>mha_layer10_gpu11</title>
<path fill="lightblue" stroke="black" d="M11015,-4454.67C11015,-4454.67 10567,-4454.67 10567,-4454.67 10561,-4454.67 10555,-4448.67 10555,-4442.67 10555,-4442.67 10555,-4413.67 10555,-4413.67 10555,-4407.67 10561,-4401.67 10567,-4401.67 10567,-4401.67 11015,-4401.67 11015,-4401.67 11021,-4401.67 11027,-4407.67 11027,-4413.67 11027,-4413.67 11027,-4442.67 11027,-4442.67 11027,-4448.67 11021,-4454.67 11015,-4454.67"/>
<text text-anchor="middle" x="10791" y="-4439.47" font-family="Times,serif" font-size="14.00">MHA Layer 10 GPU 11</text>
<text text-anchor="middle" x="10791" y="-4424.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10791" y="-4409.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer9_gpu11&#45;&gt;mha_layer10_gpu11 -->
<g id="edge972" class="edge">
<title>aggregate_layer9_gpu11&#45;&gt;mha_layer10_gpu11</title>
<path fill="none" stroke="black" d="M10786.13,-4490.57C10786.83,-4481.81 10787.53,-4472.89 10788.19,-4464.67"/>
<polygon fill="black" stroke="black" points="10791.68,-4464.93 10788.98,-4454.69 10784.7,-4464.38 10791.68,-4464.93"/>
</g>
<!-- route_layer9_gpu12&#45;&gt;comm_layer9 -->
<g id="edge925" class="edge">
<title>route_layer9_gpu12&#45;&gt;comm_layer9</title>
<path fill="none" stroke="black" d="M12062.35,-4869.62C11965.12,-4861.15 11857.14,-4852.84 11758,-4847.63 10504.64,-4781.73 9002.73,-4774.63 8414.66,-4774.62"/>
<polygon fill="black" stroke="black" points="8414.36,-4771.12 8404.36,-4774.62 8414.36,-4778.12 8414.36,-4771.12"/>
</g>
<!-- mha_layer10_gpu12 -->
<g id="node824" class="node">
<title>mha_layer10_gpu12</title>
<path fill="lightblue" stroke="black" d="M12631,-4454.67C12631,-4454.67 12183,-4454.67 12183,-4454.67 12177,-4454.67 12171,-4448.67 12171,-4442.67 12171,-4442.67 12171,-4413.67 12171,-4413.67 12171,-4407.67 12177,-4401.67 12183,-4401.67 12183,-4401.67 12631,-4401.67 12631,-4401.67 12637,-4401.67 12643,-4407.67 12643,-4413.67 12643,-4413.67 12643,-4442.67 12643,-4442.67 12643,-4448.67 12637,-4454.67 12631,-4454.67"/>
<text text-anchor="middle" x="12407" y="-4439.47" font-family="Times,serif" font-size="14.00">MHA Layer 10 GPU 12</text>
<text text-anchor="middle" x="12407" y="-4424.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12407" y="-4409.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer9_gpu12&#45;&gt;mha_layer10_gpu12 -->
<g id="edge973" class="edge">
<title>aggregate_layer9_gpu12&#45;&gt;mha_layer10_gpu12</title>
<path fill="none" stroke="black" d="M12113.94,-4496.92C12172.36,-4483.41 12234.51,-4469.05 12286.48,-4457.03"/>
<polygon fill="black" stroke="black" points="12287.44,-4460.4 12296.4,-4454.74 12285.87,-4453.58 12287.44,-4460.4"/>
</g>
<!-- route_layer9_gpu13&#45;&gt;comm_layer9 -->
<g id="edge926" class="edge">
<title>route_layer9_gpu13&#45;&gt;comm_layer9</title>
<path fill="none" stroke="black" d="M13022.61,-4869.61C12923.87,-4861.05 12813.89,-4852.68 12713,-4847.63 11866.33,-4805.2 9242.43,-4782.99 8414.2,-4776.9"/>
<polygon fill="black" stroke="black" points="8413.96,-4773.4 8403.94,-4776.83 8413.91,-4780.4 8413.96,-4773.4"/>
</g>
<!-- mha_layer10_gpu13 -->
<g id="node825" class="node">
<title>mha_layer10_gpu13</title>
<path fill="lightblue" stroke="black" d="M13292,-4454.67C13292,-4454.67 12844,-4454.67 12844,-4454.67 12838,-4454.67 12832,-4448.67 12832,-4442.67 12832,-4442.67 12832,-4413.67 12832,-4413.67 12832,-4407.67 12838,-4401.67 12844,-4401.67 12844,-4401.67 13292,-4401.67 13292,-4401.67 13298,-4401.67 13304,-4407.67 13304,-4413.67 13304,-4413.67 13304,-4442.67 13304,-4442.67 13304,-4448.67 13298,-4454.67 13292,-4454.67"/>
<text text-anchor="middle" x="13068" y="-4439.47" font-family="Times,serif" font-size="14.00">MHA Layer 10 GPU 13</text>
<text text-anchor="middle" x="13068" y="-4424.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13068" y="-4409.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer9_gpu13&#45;&gt;mha_layer10_gpu13 -->
<g id="edge974" class="edge">
<title>aggregate_layer9_gpu13&#45;&gt;mha_layer10_gpu13</title>
<path fill="none" stroke="black" d="M12930.59,-4490.57C12955.01,-4479.66 12979.95,-4468.52 13001.76,-4458.77"/>
<polygon fill="black" stroke="black" points="13003.2,-4461.96 13010.9,-4454.69 13000.35,-4455.57 13003.2,-4461.96"/>
</g>
<!-- route_layer9_gpu14&#45;&gt;comm_layer9 -->
<g id="edge927" class="edge">
<title>route_layer9_gpu14&#45;&gt;comm_layer9</title>
<path fill="none" stroke="black" d="M13984.41,-4869.51C13885.15,-4860.92 13774.49,-4852.56 13673,-4847.63 12628.78,-4796.89 9352.27,-4779.97 8414.23,-4776.09"/>
<polygon fill="black" stroke="black" points="8413.99,-4772.59 8403.98,-4776.05 8413.96,-4779.59 8413.99,-4772.59"/>
</g>
<!-- mha_layer10_gpu14 -->
<g id="node826" class="node">
<title>mha_layer10_gpu14</title>
<path fill="lightblue" stroke="black" d="M13867,-4454.67C13867,-4454.67 13419,-4454.67 13419,-4454.67 13413,-4454.67 13407,-4448.67 13407,-4442.67 13407,-4442.67 13407,-4413.67 13407,-4413.67 13407,-4407.67 13413,-4401.67 13419,-4401.67 13419,-4401.67 13867,-4401.67 13867,-4401.67 13873,-4401.67 13879,-4407.67 13879,-4413.67 13879,-4413.67 13879,-4442.67 13879,-4442.67 13879,-4448.67 13873,-4454.67 13867,-4454.67"/>
<text text-anchor="middle" x="13643" y="-4439.47" font-family="Times,serif" font-size="14.00">MHA Layer 10 GPU 14</text>
<text text-anchor="middle" x="13643" y="-4424.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13643" y="-4409.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer9_gpu14&#45;&gt;mha_layer10_gpu14 -->
<g id="edge975" class="edge">
<title>aggregate_layer9_gpu14&#45;&gt;mha_layer10_gpu14</title>
<path fill="none" stroke="black" d="M13615.95,-4490.57C13619.94,-4481.51 13624,-4472.29 13627.73,-4463.85"/>
<polygon fill="black" stroke="black" points="13630.93,-4465.25 13631.76,-4454.69 13624.53,-4462.43 13630.93,-4465.25"/>
</g>
<!-- route_layer9_gpu15&#45;&gt;comm_layer9 -->
<g id="edge928" class="edge">
<title>route_layer9_gpu15&#45;&gt;comm_layer9</title>
<path fill="none" stroke="black" d="M14947.31,-4869.43C14847.79,-4860.82 14736.8,-4852.47 14635,-4847.63 13391.62,-4788.52 9453.7,-4777.44 8414.49,-4775.52"/>
<polygon fill="black" stroke="black" points="8414.28,-4772.02 8404.27,-4775.5 8414.27,-4779.02 8414.28,-4772.02"/>
</g>
<!-- mha_layer10_gpu15 -->
<g id="node827" class="node">
<title>mha_layer10_gpu15</title>
<path fill="lightblue" stroke="black" d="M15304,-4454.67C15304,-4454.67 14856,-4454.67 14856,-4454.67 14850,-4454.67 14844,-4448.67 14844,-4442.67 14844,-4442.67 14844,-4413.67 14844,-4413.67 14844,-4407.67 14850,-4401.67 14856,-4401.67 14856,-4401.67 15304,-4401.67 15304,-4401.67 15310,-4401.67 15316,-4407.67 15316,-4413.67 15316,-4413.67 15316,-4442.67 15316,-4442.67 15316,-4448.67 15310,-4454.67 15304,-4454.67"/>
<text text-anchor="middle" x="15080" y="-4439.47" font-family="Times,serif" font-size="14.00">MHA Layer 10 GPU 15</text>
<text text-anchor="middle" x="15080" y="-4424.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="15080" y="-4409.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer9_gpu15&#45;&gt;mha_layer10_gpu15 -->
<g id="edge976" class="edge">
<title>aggregate_layer9_gpu15&#45;&gt;mha_layer10_gpu15</title>
<path fill="none" stroke="black" d="M14934.48,-4490.57C14960.46,-4479.61 14986.99,-4468.42 15010.16,-4458.64"/>
<polygon fill="black" stroke="black" points="15011.68,-4461.8 15019.53,-4454.69 15008.96,-4455.35 15011.68,-4461.8"/>
</g>
<!-- comm_layer9&#45;&gt;expert_layer9_gpu0_expert0 -->
<g id="edge929" class="edge">
<title>comm_layer9&#45;&gt;expert_layer9_gpu0_expert0</title>
<path fill="none" stroke="black" d="M7917.53,-4773.21C7149.44,-4772.7 4708.66,-4765.69 2689,-4700.67 2561.19,-4696.56 2419.24,-4689.56 2301.12,-4683.06"/>
<polygon fill="black" stroke="black" points="2301.03,-4679.55 2290.85,-4682.5 2300.64,-4686.54 2301.03,-4679.55"/>
</g>
<!-- comm_layer9&#45;&gt;expert_layer9_gpu1_expert1 -->
<g id="edge930" class="edge">
<title>comm_layer9&#45;&gt;expert_layer9_gpu1_expert1</title>
<path fill="none" stroke="black" d="M7917.83,-4772.97C7227.88,-4771.69 5198.85,-4762.52 3515,-4700.67 3412.53,-4696.91 3299.8,-4690.8 3201.83,-4684.85"/>
<polygon fill="black" stroke="black" points="3201.98,-4681.36 3191.79,-4684.24 3201.56,-4688.34 3201.98,-4681.36"/>
</g>
<!-- comm_layer9&#45;&gt;expert_layer9_gpu2_expert2 -->
<g id="edge931" class="edge">
<title>comm_layer9&#45;&gt;expert_layer9_gpu2_expert2</title>
<path fill="none" stroke="black" d="M7918.46,-4771C7323.91,-4765.17 5746.44,-4746.33 4431,-4700.67 4298.01,-4696.06 4150.04,-4688.85 4027.97,-4682.35"/>
<polygon fill="black" stroke="black" points="4027.91,-4678.84 4017.74,-4681.8 4027.54,-4685.83 4027.91,-4678.84"/>
</g>
<!-- comm_layer9&#45;&gt;expert_layer9_gpu3_expert3 -->
<g id="edge932" class="edge">
<title>comm_layer9&#45;&gt;expert_layer9_gpu3_expert3</title>
<path fill="none" stroke="black" d="M7921.29,-4767.43C7459.73,-4756.21 6415.5,-4729.86 5537,-4700.67 5337.83,-4694.06 5112.47,-4685.25 4943.86,-4678.39"/>
<polygon fill="black" stroke="black" points="4943.99,-4674.9 4933.85,-4677.99 4943.7,-4681.89 4943.99,-4674.9"/>
</g>
<!-- comm_layer9&#45;&gt;expert_layer9_gpu4_expert4 -->
<g id="edge933" class="edge">
<title>comm_layer9&#45;&gt;expert_layer9_gpu4_expert4</title>
<path fill="none" stroke="black" d="M7924.54,-4765.19C7578.07,-4753.2 6912.15,-4728.87 6346,-4700.67 6249.26,-4695.86 6143.06,-4689.72 6049.81,-4684.05"/>
<polygon fill="black" stroke="black" points="6049.86,-4680.55 6039.67,-4683.43 6049.43,-4687.54 6049.86,-4680.55"/>
</g>
<!-- comm_layer9&#45;&gt;expert_layer9_gpu5_expert5 -->
<g id="edge934" class="edge">
<title>comm_layer9&#45;&gt;expert_layer9_gpu5_expert5</title>
<path fill="none" stroke="black" d="M7934.9,-4760.22C7701.99,-4746.61 7328.51,-4723.96 7006,-4700.67 6958.39,-4697.24 6907.65,-4693.3 6858.78,-4689.38"/>
<polygon fill="black" stroke="black" points="6858.96,-4685.88 6848.71,-4688.57 6858.39,-4692.86 6858.96,-4685.88"/>
</g>
<!-- comm_layer9&#45;&gt;expert_layer9_gpu6_expert6 -->
<g id="edge935" class="edge">
<title>comm_layer9&#45;&gt;expert_layer9_gpu6_expert6</title>
<path fill="none" stroke="black" d="M7970.62,-4750.81C7839.14,-4735.39 7662.74,-4714.69 7518.84,-4697.81"/>
<polygon fill="black" stroke="black" points="7518.87,-4694.29 7508.54,-4696.6 7518.06,-4701.24 7518.87,-4694.29"/>
</g>
<!-- comm_layer9&#45;&gt;expert_layer9_gpu7_expert7 -->
<g id="edge936" class="edge">
<title>comm_layer9&#45;&gt;expert_layer9_gpu7_expert7</title>
<path fill="none" stroke="black" d="M8061.65,-4739.78C8027.73,-4728.38 7989.65,-4715.59 7955.09,-4703.98"/>
<polygon fill="black" stroke="black" points="7956.03,-4700.61 7945.44,-4700.74 7953.8,-4707.24 7956.03,-4700.61"/>
</g>
<!-- comm_layer9&#45;&gt;expert_layer9_gpu8_expert8 -->
<g id="edge937" class="edge">
<title>comm_layer9&#45;&gt;expert_layer9_gpu8_expert8</title>
<path fill="none" stroke="black" d="M8260.35,-4739.78C8294.27,-4728.38 8332.35,-4715.59 8366.91,-4703.98"/>
<polygon fill="black" stroke="black" points="8368.2,-4707.24 8376.56,-4700.74 8365.97,-4700.61 8368.2,-4707.24"/>
</g>
<!-- comm_layer9&#45;&gt;expert_layer9_gpu9_expert9 -->
<g id="edge938" class="edge">
<title>comm_layer9&#45;&gt;expert_layer9_gpu9_expert9</title>
<path fill="none" stroke="black" d="M8360.98,-4752.75C8525.48,-4735.97 8759.72,-4712.08 8938.1,-4693.88"/>
<polygon fill="black" stroke="black" points="8938.56,-4697.35 8948.16,-4692.85 8937.85,-4690.39 8938.56,-4697.35"/>
</g>
<!-- comm_layer9&#45;&gt;expert_layer9_gpu10_expert10 -->
<g id="edge939" class="edge">
<title>comm_layer9&#45;&gt;expert_layer9_gpu10_expert10</title>
<path fill="none" stroke="black" d="M8389.53,-4761.22C8647.24,-4747.56 9078.8,-4724.03 9450,-4700.67 9520.43,-4696.24 9596.71,-4691.09 9667.08,-4686.19"/>
<polygon fill="black" stroke="black" points="9667.68,-4689.65 9677.41,-4685.47 9667.2,-4682.67 9667.68,-4689.65"/>
</g>
<!-- comm_layer9&#45;&gt;expert_layer9_gpu11_expert11 -->
<g id="edge940" class="edge">
<title>comm_layer9&#45;&gt;expert_layer9_gpu11_expert11</title>
<path fill="none" stroke="black" d="M8400.32,-4767.33C8778.31,-4757.52 9536.63,-4735.29 10179,-4700.67 10244.54,-4697.14 10315.29,-4692.48 10381.15,-4687.77"/>
<polygon fill="black" stroke="black" points="10381.53,-4691.25 10391.26,-4687.05 10381.03,-4684.27 10381.53,-4691.25"/>
</g>
<!-- comm_layer9&#45;&gt;expert_layer9_gpu12_expert12 -->
<g id="edge941" class="edge">
<title>comm_layer9&#45;&gt;expert_layer9_gpu12_expert12</title>
<path fill="none" stroke="black" d="M8401.8,-4768.6C8877.83,-4759.21 9972.89,-4735.57 10893,-4700.67 11029.19,-4695.51 11180.9,-4688.16 11305.38,-4681.7"/>
<polygon fill="black" stroke="black" points="11305.62,-4685.19 11315.43,-4681.18 11305.26,-4678.2 11305.62,-4685.19"/>
</g>
<!-- comm_layer9&#45;&gt;expert_layer9_gpu13_expert13 -->
<g id="edge942" class="edge">
<title>comm_layer9&#45;&gt;expert_layer9_gpu13_expert13</title>
<path fill="none" stroke="black" d="M8403.59,-4770.89C8990.05,-4764.88 10531.23,-4745.75 11817,-4700.67 11948.63,-4696.06 12095.02,-4688.89 12216.06,-4682.41"/>
<polygon fill="black" stroke="black" points="12216.41,-4685.9 12226.21,-4681.87 12216.03,-4678.91 12216.41,-4685.9"/>
</g>
<!-- comm_layer9&#45;&gt;expert_layer9_gpu14_expert14 -->
<g id="edge943" class="edge">
<title>comm_layer9&#45;&gt;expert_layer9_gpu14_expert14</title>
<path fill="none" stroke="black" d="M8404.3,-4772.71C9086.59,-4770.75 11076.19,-4759.95 12728,-4700.67 12837.14,-4696.76 12957.54,-4690.39 13060.95,-4684.29"/>
<polygon fill="black" stroke="black" points="13061.45,-4687.77 13071.23,-4683.68 13061.04,-4680.78 13061.45,-4687.77"/>
</g>
<!-- comm_layer9&#45;&gt;expert_layer9_gpu15_expert15 -->
<g id="edge944" class="edge">
<title>comm_layer9&#45;&gt;expert_layer9_gpu15_expert15</title>
<path fill="none" stroke="black" d="M8404.13,-4772.41C9166.35,-4769.57 11577.28,-4756.46 13573,-4700.67 13746.1,-4695.83 13940.82,-4687.55 14091.9,-4680.49"/>
<polygon fill="black" stroke="black" points="14092.42,-4683.97 14102.24,-4680 14092.09,-4676.97 14092.42,-4683.97"/>
</g>
<!-- gate_layer10_gpu0 -->
<g id="node828" class="node">
<title>gate_layer10_gpu0</title>
<path fill="lightsteelblue" stroke="black" d="M877.07,-4364.34C877.07,-4364.34 427.93,-4314.01 427.93,-4314.01 421.96,-4313.34 421.96,-4312.01 427.93,-4311.34 427.93,-4311.34 877.07,-4261.01 877.07,-4261.01 883.04,-4260.34 894.96,-4260.34 900.93,-4261.01 900.93,-4261.01 1350.07,-4311.34 1350.07,-4311.34 1356.04,-4312.01 1356.04,-4313.34 1350.07,-4314.01 1350.07,-4314.01 900.93,-4364.34 900.93,-4364.34 894.96,-4365.01 883.04,-4365.01 877.07,-4364.34"/>
<text text-anchor="middle" x="889" y="-4323.97" font-family="Times,serif" font-size="14.00">Gate Layer 10 GPU 0</text>
<text text-anchor="middle" x="889" y="-4308.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="889" y="-4293.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer10_gpu0&#45;&gt;gate_layer10_gpu0 -->
<g id="edge977" class="edge">
<title>mha_layer10_gpu0&#45;&gt;gate_layer10_gpu0</title>
<path fill="none" stroke="black" d="M1132.14,-4401.56C1095.73,-4388.4 1050.36,-4372 1008.7,-4356.94"/>
<polygon fill="black" stroke="black" points="1009.64,-4353.56 999.05,-4353.45 1007.26,-4360.14 1009.64,-4353.56"/>
</g>
<!-- gate_layer10_gpu1 -->
<g id="node829" class="node">
<title>gate_layer10_gpu1</title>
<path fill="lightsteelblue" stroke="black" d="M1841.07,-4364.34C1841.07,-4364.34 1391.93,-4314.01 1391.93,-4314.01 1385.96,-4313.34 1385.96,-4312.01 1391.93,-4311.34 1391.93,-4311.34 1841.07,-4261.01 1841.07,-4261.01 1847.04,-4260.34 1858.96,-4260.34 1864.93,-4261.01 1864.93,-4261.01 2314.07,-4311.34 2314.07,-4311.34 2320.04,-4312.01 2320.04,-4313.34 2314.07,-4314.01 2314.07,-4314.01 1864.93,-4364.34 1864.93,-4364.34 1858.96,-4365.01 1847.04,-4365.01 1841.07,-4364.34"/>
<text text-anchor="middle" x="1853" y="-4323.97" font-family="Times,serif" font-size="14.00">Gate Layer 10 GPU 1</text>
<text text-anchor="middle" x="1853" y="-4308.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="1853" y="-4293.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer10_gpu1&#45;&gt;gate_layer10_gpu1 -->
<g id="edge978" class="edge">
<title>mha_layer10_gpu1&#45;&gt;gate_layer10_gpu1</title>
<path fill="none" stroke="black" d="M1974.37,-4401.42C1959.37,-4390.57 1941.35,-4377.54 1923.84,-4364.89"/>
<polygon fill="black" stroke="black" points="1925.46,-4361.74 1915.3,-4358.71 1921.36,-4367.41 1925.46,-4361.74"/>
</g>
<!-- gate_layer10_gpu2 -->
<g id="node830" class="node">
<title>gate_layer10_gpu2</title>
<path fill="lightsteelblue" stroke="black" d="M2805.07,-4364.34C2805.07,-4364.34 2355.93,-4314.01 2355.93,-4314.01 2349.96,-4313.34 2349.96,-4312.01 2355.93,-4311.34 2355.93,-4311.34 2805.07,-4261.01 2805.07,-4261.01 2811.04,-4260.34 2822.96,-4260.34 2828.93,-4261.01 2828.93,-4261.01 3278.07,-4311.34 3278.07,-4311.34 3284.04,-4312.01 3284.04,-4313.34 3278.07,-4314.01 3278.07,-4314.01 2828.93,-4364.34 2828.93,-4364.34 2822.96,-4365.01 2811.04,-4365.01 2805.07,-4364.34"/>
<text text-anchor="middle" x="2817" y="-4323.97" font-family="Times,serif" font-size="14.00">Gate Layer 10 GPU 2</text>
<text text-anchor="middle" x="2817" y="-4308.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="2817" y="-4293.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer10_gpu2&#45;&gt;gate_layer10_gpu2 -->
<g id="edge979" class="edge">
<title>mha_layer10_gpu2&#45;&gt;gate_layer10_gpu2</title>
<path fill="none" stroke="black" d="M3039.23,-4401.56C3006.69,-4388.69 2966.33,-4372.73 2928.97,-4357.95"/>
<polygon fill="black" stroke="black" points="2930.13,-4354.65 2919.54,-4354.23 2927.55,-4361.16 2930.13,-4354.65"/>
</g>
<!-- gate_layer10_gpu3 -->
<g id="node831" class="node">
<title>gate_layer10_gpu3</title>
<path fill="lightsteelblue" stroke="black" d="M3769.07,-4364.34C3769.07,-4364.34 3319.93,-4314.01 3319.93,-4314.01 3313.96,-4313.34 3313.96,-4312.01 3319.93,-4311.34 3319.93,-4311.34 3769.07,-4261.01 3769.07,-4261.01 3775.04,-4260.34 3786.96,-4260.34 3792.93,-4261.01 3792.93,-4261.01 4242.07,-4311.34 4242.07,-4311.34 4248.04,-4312.01 4248.04,-4313.34 4242.07,-4314.01 4242.07,-4314.01 3792.93,-4364.34 3792.93,-4364.34 3786.96,-4365.01 3775.04,-4365.01 3769.07,-4364.34"/>
<text text-anchor="middle" x="3781" y="-4323.97" font-family="Times,serif" font-size="14.00">Gate Layer 10 GPU 3</text>
<text text-anchor="middle" x="3781" y="-4308.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="3781" y="-4293.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer10_gpu3&#45;&gt;gate_layer10_gpu3 -->
<g id="edge980" class="edge">
<title>mha_layer10_gpu3&#45;&gt;gate_layer10_gpu3</title>
<path fill="none" stroke="black" d="M4111.91,-4401.63C4057.86,-4387.27 3989.26,-4369.03 3928.54,-4352.89"/>
<polygon fill="black" stroke="black" points="3929.43,-4349.51 3918.87,-4350.32 3927.63,-4356.27 3929.43,-4349.51"/>
</g>
<!-- gate_layer10_gpu4 -->
<g id="node832" class="node">
<title>gate_layer10_gpu4</title>
<path fill="lightsteelblue" stroke="black" d="M4733.07,-4364.34C4733.07,-4364.34 4283.93,-4314.01 4283.93,-4314.01 4277.96,-4313.34 4277.96,-4312.01 4283.93,-4311.34 4283.93,-4311.34 4733.07,-4261.01 4733.07,-4261.01 4739.04,-4260.34 4750.96,-4260.34 4756.93,-4261.01 4756.93,-4261.01 5206.07,-4311.34 5206.07,-4311.34 5212.04,-4312.01 5212.04,-4313.34 5206.07,-4314.01 5206.07,-4314.01 4756.93,-4364.34 4756.93,-4364.34 4750.96,-4365.01 4739.04,-4365.01 4733.07,-4364.34"/>
<text text-anchor="middle" x="4745" y="-4323.97" font-family="Times,serif" font-size="14.00">Gate Layer 10 GPU 4</text>
<text text-anchor="middle" x="4745" y="-4308.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4745" y="-4293.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer10_gpu4&#45;&gt;gate_layer10_gpu4 -->
<g id="edge981" class="edge">
<title>mha_layer10_gpu4&#45;&gt;gate_layer10_gpu4</title>
<path fill="none" stroke="black" d="M4837.77,-4401.42C4827.02,-4391.25 4814.24,-4379.16 4801.66,-4367.26"/>
<polygon fill="black" stroke="black" points="4803.96,-4364.62 4794.29,-4360.3 4799.15,-4369.71 4803.96,-4364.62"/>
</g>
<!-- gate_layer10_gpu5 -->
<g id="node833" class="node">
<title>gate_layer10_gpu5</title>
<path fill="lightsteelblue" stroke="black" d="M5697.07,-4364.34C5697.07,-4364.34 5247.93,-4314.01 5247.93,-4314.01 5241.96,-4313.34 5241.96,-4312.01 5247.93,-4311.34 5247.93,-4311.34 5697.07,-4261.01 5697.07,-4261.01 5703.04,-4260.34 5714.96,-4260.34 5720.93,-4261.01 5720.93,-4261.01 6170.07,-4311.34 6170.07,-4311.34 6176.04,-4312.01 6176.04,-4313.34 6170.07,-4314.01 6170.07,-4314.01 5720.93,-4364.34 5720.93,-4364.34 5714.96,-4365.01 5703.04,-4365.01 5697.07,-4364.34"/>
<text text-anchor="middle" x="5709" y="-4323.97" font-family="Times,serif" font-size="14.00">Gate Layer 10 GPU 5</text>
<text text-anchor="middle" x="5709" y="-4308.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5709" y="-4293.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer10_gpu5&#45;&gt;gate_layer10_gpu5 -->
<g id="edge982" class="edge">
<title>mha_layer10_gpu5&#45;&gt;gate_layer10_gpu5</title>
<path fill="none" stroke="black" d="M5888.65,-4401.56C5863.92,-4389.47 5833.62,-4374.64 5804.99,-4360.63"/>
<polygon fill="black" stroke="black" points="5806.28,-4357.37 5795.76,-4356.12 5803.2,-4363.66 5806.28,-4357.37"/>
</g>
<!-- gate_layer10_gpu6 -->
<g id="node834" class="node">
<title>gate_layer10_gpu6</title>
<path fill="lightsteelblue" stroke="black" d="M6661.07,-4364.34C6661.07,-4364.34 6211.93,-4314.01 6211.93,-4314.01 6205.96,-4313.34 6205.96,-4312.01 6211.93,-4311.34 6211.93,-4311.34 6661.07,-4261.01 6661.07,-4261.01 6667.04,-4260.34 6678.96,-4260.34 6684.93,-4261.01 6684.93,-4261.01 7134.07,-4311.34 7134.07,-4311.34 7140.04,-4312.01 7140.04,-4313.34 7134.07,-4314.01 7134.07,-4314.01 6684.93,-4364.34 6684.93,-4364.34 6678.96,-4365.01 6667.04,-4365.01 6661.07,-4364.34"/>
<text text-anchor="middle" x="6673" y="-4323.97" font-family="Times,serif" font-size="14.00">Gate Layer 10 GPU 6</text>
<text text-anchor="middle" x="6673" y="-4308.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6673" y="-4293.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer10_gpu6&#45;&gt;gate_layer10_gpu6 -->
<g id="edge983" class="edge">
<title>mha_layer10_gpu6&#45;&gt;gate_layer10_gpu6</title>
<path fill="none" stroke="black" d="M6850.32,-4401.56C6825.92,-4389.47 6796,-4374.64 6767.74,-4360.63"/>
<polygon fill="black" stroke="black" points="6769.15,-4357.42 6758.64,-4356.12 6766.04,-4363.69 6769.15,-4357.42"/>
</g>
<!-- gate_layer10_gpu7 -->
<g id="node835" class="node">
<title>gate_layer10_gpu7</title>
<path fill="lightsteelblue" stroke="black" d="M7625.07,-4364.34C7625.07,-4364.34 7175.93,-4314.01 7175.93,-4314.01 7169.96,-4313.34 7169.96,-4312.01 7175.93,-4311.34 7175.93,-4311.34 7625.07,-4261.01 7625.07,-4261.01 7631.04,-4260.34 7642.96,-4260.34 7648.93,-4261.01 7648.93,-4261.01 8098.07,-4311.34 8098.07,-4311.34 8104.04,-4312.01 8104.04,-4313.34 8098.07,-4314.01 8098.07,-4314.01 7648.93,-4364.34 7648.93,-4364.34 7642.96,-4365.01 7631.04,-4365.01 7625.07,-4364.34"/>
<text text-anchor="middle" x="7637" y="-4323.97" font-family="Times,serif" font-size="14.00">Gate Layer 10 GPU 7</text>
<text text-anchor="middle" x="7637" y="-4308.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="7637" y="-4293.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer10_gpu7&#45;&gt;gate_layer10_gpu7 -->
<g id="edge984" class="edge">
<title>mha_layer10_gpu7&#45;&gt;gate_layer10_gpu7</title>
<path fill="none" stroke="black" d="M7651.69,-4401.42C7650.35,-4393.45 7648.82,-4384.29 7647.26,-4374.98"/>
<polygon fill="black" stroke="black" points="7650.67,-4374.14 7645.57,-4364.85 7643.77,-4375.29 7650.67,-4374.14"/>
</g>
<!-- gate_layer10_gpu8 -->
<g id="node836" class="node">
<title>gate_layer10_gpu8</title>
<path fill="lightsteelblue" stroke="black" d="M8589.07,-4364.34C8589.07,-4364.34 8139.93,-4314.01 8139.93,-4314.01 8133.96,-4313.34 8133.96,-4312.01 8139.93,-4311.34 8139.93,-4311.34 8589.07,-4261.01 8589.07,-4261.01 8595.04,-4260.34 8606.96,-4260.34 8612.93,-4261.01 8612.93,-4261.01 9062.07,-4311.34 9062.07,-4311.34 9068.04,-4312.01 9068.04,-4313.34 9062.07,-4314.01 9062.07,-4314.01 8612.93,-4364.34 8612.93,-4364.34 8606.96,-4365.01 8595.04,-4365.01 8589.07,-4364.34"/>
<text text-anchor="middle" x="8601" y="-4323.97" font-family="Times,serif" font-size="14.00">Gate Layer 10 GPU 8</text>
<text text-anchor="middle" x="8601" y="-4308.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="8601" y="-4293.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer10_gpu8&#45;&gt;gate_layer10_gpu8 -->
<g id="edge985" class="edge">
<title>mha_layer10_gpu8&#45;&gt;gate_layer10_gpu8</title>
<path fill="none" stroke="black" d="M8574.72,-4401.42C8577.18,-4393.18 8580.03,-4383.68 8582.92,-4374.04"/>
<polygon fill="black" stroke="black" points="8586.29,-4374.98 8585.81,-4364.4 8579.58,-4372.97 8586.29,-4374.98"/>
</g>
<!-- gate_layer10_gpu9 -->
<g id="node837" class="node">
<title>gate_layer10_gpu9</title>
<path fill="lightsteelblue" stroke="black" d="M9553.07,-4364.34C9553.07,-4364.34 9103.93,-4314.01 9103.93,-4314.01 9097.96,-4313.34 9097.96,-4312.01 9103.93,-4311.34 9103.93,-4311.34 9553.07,-4261.01 9553.07,-4261.01 9559.04,-4260.34 9570.96,-4260.34 9576.93,-4261.01 9576.93,-4261.01 10026.07,-4311.34 10026.07,-4311.34 10032.04,-4312.01 10032.04,-4313.34 10026.07,-4314.01 10026.07,-4314.01 9576.93,-4364.34 9576.93,-4364.34 9570.96,-4365.01 9559.04,-4365.01 9553.07,-4364.34"/>
<text text-anchor="middle" x="9565" y="-4323.97" font-family="Times,serif" font-size="14.00">Gate Layer 10 GPU 9</text>
<text text-anchor="middle" x="9565" y="-4308.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="9565" y="-4293.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer10_gpu9&#45;&gt;gate_layer10_gpu9 -->
<g id="edge986" class="edge">
<title>mha_layer10_gpu9&#45;&gt;gate_layer10_gpu9</title>
<path fill="none" stroke="black" d="M9557.27,-4401.42C9557.96,-4393.54 9558.76,-4384.51 9559.57,-4375.32"/>
<polygon fill="black" stroke="black" points="9563.06,-4375.58 9560.45,-4365.31 9556.09,-4374.97 9563.06,-4375.58"/>
</g>
<!-- gate_layer10_gpu10 -->
<g id="node838" class="node">
<title>gate_layer10_gpu10</title>
<path fill="lightsteelblue" stroke="black" d="M10517.07,-4364.34C10517.07,-4364.34 10067.93,-4314.01 10067.93,-4314.01 10061.96,-4313.34 10061.96,-4312.01 10067.93,-4311.34 10067.93,-4311.34 10517.07,-4261.01 10517.07,-4261.01 10523.04,-4260.34 10534.96,-4260.34 10540.93,-4261.01 10540.93,-4261.01 10990.07,-4311.34 10990.07,-4311.34 10996.04,-4312.01 10996.04,-4313.34 10990.07,-4314.01 10990.07,-4314.01 10540.93,-4364.34 10540.93,-4364.34 10534.96,-4365.01 10523.04,-4365.01 10517.07,-4364.34"/>
<text text-anchor="middle" x="10529" y="-4323.97" font-family="Times,serif" font-size="14.00">Gate Layer 10 GPU 10</text>
<text text-anchor="middle" x="10529" y="-4308.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="10529" y="-4293.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer10_gpu10&#45;&gt;gate_layer10_gpu10 -->
<g id="edge987" class="edge">
<title>mha_layer10_gpu10&#45;&gt;gate_layer10_gpu10</title>
<path fill="none" stroke="black" d="M10286.63,-4401.56C10322.93,-4388.4 10368.16,-4372 10409.68,-4356.94"/>
<polygon fill="black" stroke="black" points="10411.1,-4360.15 10419.31,-4353.45 10408.71,-4353.57 10411.1,-4360.15"/>
</g>
<!-- gate_layer10_gpu11 -->
<g id="node839" class="node">
<title>gate_layer10_gpu11</title>
<path fill="lightsteelblue" stroke="black" d="M11481.07,-4364.34C11481.07,-4364.34 11031.93,-4314.01 11031.93,-4314.01 11025.96,-4313.34 11025.96,-4312.01 11031.93,-4311.34 11031.93,-4311.34 11481.07,-4261.01 11481.07,-4261.01 11487.04,-4260.34 11498.96,-4260.34 11504.93,-4261.01 11504.93,-4261.01 11954.07,-4311.34 11954.07,-4311.34 11960.04,-4312.01 11960.04,-4313.34 11954.07,-4314.01 11954.07,-4314.01 11504.93,-4364.34 11504.93,-4364.34 11498.96,-4365.01 11487.04,-4365.01 11481.07,-4364.34"/>
<text text-anchor="middle" x="11493" y="-4323.97" font-family="Times,serif" font-size="14.00">Gate Layer 10 GPU 11</text>
<text text-anchor="middle" x="11493" y="-4308.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11493" y="-4293.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer10_gpu11&#45;&gt;gate_layer10_gpu11 -->
<g id="edge988" class="edge">
<title>mha_layer10_gpu11&#45;&gt;gate_layer10_gpu11</title>
<path fill="none" stroke="black" d="M10948.98,-4401.63C11050.63,-4385.2 11183.61,-4363.69 11292.66,-4346.06"/>
<polygon fill="black" stroke="black" points="11293.49,-4349.48 11302.8,-4344.42 11292.37,-4342.57 11293.49,-4349.48"/>
</g>
<!-- gate_layer10_gpu12 -->
<g id="node840" class="node">
<title>gate_layer10_gpu12</title>
<path fill="lightsteelblue" stroke="black" d="M12445.07,-4364.34C12445.07,-4364.34 11995.93,-4314.01 11995.93,-4314.01 11989.96,-4313.34 11989.96,-4312.01 11995.93,-4311.34 11995.93,-4311.34 12445.07,-4261.01 12445.07,-4261.01 12451.04,-4260.34 12462.96,-4260.34 12468.93,-4261.01 12468.93,-4261.01 12918.07,-4311.34 12918.07,-4311.34 12924.04,-4312.01 12924.04,-4313.34 12918.07,-4314.01 12918.07,-4314.01 12468.93,-4364.34 12468.93,-4364.34 12462.96,-4365.01 12451.04,-4365.01 12445.07,-4364.34"/>
<text text-anchor="middle" x="12457" y="-4323.97" font-family="Times,serif" font-size="14.00">Gate Layer 10 GPU 12</text>
<text text-anchor="middle" x="12457" y="-4308.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="12457" y="-4293.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer10_gpu12&#45;&gt;gate_layer10_gpu12 -->
<g id="edge989" class="edge">
<title>mha_layer10_gpu12&#45;&gt;gate_layer10_gpu12</title>
<path fill="none" stroke="black" d="M12418.35,-4401.42C12422.14,-4392.81 12426.54,-4382.82 12430.98,-4372.73"/>
<polygon fill="black" stroke="black" points="12434.23,-4374.04 12435.06,-4363.48 12427.82,-4371.22 12434.23,-4374.04"/>
</g>
<!-- gate_layer10_gpu13 -->
<g id="node841" class="node">
<title>gate_layer10_gpu13</title>
<path fill="lightsteelblue" stroke="black" d="M13409.07,-4364.34C13409.07,-4364.34 12959.93,-4314.01 12959.93,-4314.01 12953.96,-4313.34 12953.96,-4312.01 12959.93,-4311.34 12959.93,-4311.34 13409.07,-4261.01 13409.07,-4261.01 13415.04,-4260.34 13426.96,-4260.34 13432.93,-4261.01 13432.93,-4261.01 13882.07,-4311.34 13882.07,-4311.34 13888.04,-4312.01 13888.04,-4313.34 13882.07,-4314.01 13882.07,-4314.01 13432.93,-4364.34 13432.93,-4364.34 13426.96,-4365.01 13415.04,-4365.01 13409.07,-4364.34"/>
<text text-anchor="middle" x="13421" y="-4323.97" font-family="Times,serif" font-size="14.00">Gate Layer 10 GPU 13</text>
<text text-anchor="middle" x="13421" y="-4308.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13421" y="-4293.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer10_gpu13&#45;&gt;gate_layer10_gpu13 -->
<g id="edge990" class="edge">
<title>mha_layer10_gpu13&#45;&gt;gate_layer10_gpu13</title>
<path fill="none" stroke="black" d="M13147.66,-4401.56C13190.08,-4387.92 13243.3,-4370.81 13291.49,-4355.32"/>
<polygon fill="black" stroke="black" points="13292.6,-4358.63 13301.05,-4352.24 13290.46,-4351.97 13292.6,-4358.63"/>
</g>
<!-- gate_layer10_gpu14 -->
<g id="node842" class="node">
<title>gate_layer10_gpu14</title>
<path fill="lightsteelblue" stroke="black" d="M14373.07,-4364.34C14373.07,-4364.34 13923.93,-4314.01 13923.93,-4314.01 13917.96,-4313.34 13917.96,-4312.01 13923.93,-4311.34 13923.93,-4311.34 14373.07,-4261.01 14373.07,-4261.01 14379.04,-4260.34 14390.96,-4260.34 14396.93,-4261.01 14396.93,-4261.01 14846.07,-4311.34 14846.07,-4311.34 14852.04,-4312.01 14852.04,-4313.34 14846.07,-4314.01 14846.07,-4314.01 14396.93,-4364.34 14396.93,-4364.34 14390.96,-4365.01 14379.04,-4365.01 14373.07,-4364.34"/>
<text text-anchor="middle" x="14385" y="-4323.97" font-family="Times,serif" font-size="14.00">Gate Layer 10 GPU 14</text>
<text text-anchor="middle" x="14385" y="-4308.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14385" y="-4293.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer10_gpu14&#45;&gt;gate_layer10_gpu14 -->
<g id="edge991" class="edge">
<title>mha_layer10_gpu14&#45;&gt;gate_layer10_gpu14</title>
<path fill="none" stroke="black" d="M13809.98,-4401.63C13919.09,-4384.94 14062.36,-4363.03 14178.6,-4345.25"/>
<polygon fill="black" stroke="black" points="14179.34,-4348.67 14188.69,-4343.7 14178.28,-4341.75 14179.34,-4348.67"/>
</g>
<!-- gate_layer10_gpu15 -->
<g id="node843" class="node">
<title>gate_layer10_gpu15</title>
<path fill="lightsteelblue" stroke="black" d="M15337.07,-4364.34C15337.07,-4364.34 14887.93,-4314.01 14887.93,-4314.01 14881.96,-4313.34 14881.96,-4312.01 14887.93,-4311.34 14887.93,-4311.34 15337.07,-4261.01 15337.07,-4261.01 15343.04,-4260.34 15354.96,-4260.34 15360.93,-4261.01 15360.93,-4261.01 15810.07,-4311.34 15810.07,-4311.34 15816.04,-4312.01 15816.04,-4313.34 15810.07,-4314.01 15810.07,-4314.01 15360.93,-4364.34 15360.93,-4364.34 15354.96,-4365.01 15343.04,-4365.01 15337.07,-4364.34"/>
<text text-anchor="middle" x="15349" y="-4323.97" font-family="Times,serif" font-size="14.00">Gate Layer 10 GPU 15</text>
<text text-anchor="middle" x="15349" y="-4308.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="15349" y="-4293.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer10_gpu15&#45;&gt;gate_layer10_gpu15 -->
<g id="edge992" class="edge">
<title>mha_layer10_gpu15&#45;&gt;gate_layer10_gpu15</title>
<path fill="none" stroke="black" d="M15140.7,-4401.56C15170.59,-4388.95 15207.52,-4373.37 15241.94,-4358.85"/>
<polygon fill="black" stroke="black" points="15243.72,-4361.89 15251.58,-4354.78 15241,-4355.44 15243.72,-4361.89"/>
</g>
<!-- route_layer10_gpu0 -->
<g id="node860" class="node">
<title>route_layer10_gpu0</title>
<path fill="orange" stroke="black" d="M1556.74,-4223.67C1556.74,-4223.67 1048.24,-4223.67 1048.24,-4223.67 1042.24,-4223.67 1031.5,-4220 1026.75,-4216.33 1026.75,-4216.33 908.75,-4125.02 908.75,-4125.02 904,-4121.35 905.26,-4117.67 911.26,-4117.67 911.26,-4117.67 1419.76,-4117.67 1419.76,-4117.67 1425.76,-4117.67 1436.5,-4121.35 1441.25,-4125.02 1441.25,-4125.02 1559.25,-4216.33 1559.25,-4216.33 1564,-4220 1562.74,-4223.67 1556.74,-4223.67"/>
<text text-anchor="middle" x="1234" y="-4181.97" font-family="Times,serif" font-size="14.00">Token Router Layer 10 GPU 0</text>
<text text-anchor="middle" x="1234" y="-4166.97" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="1234" y="-4151.97" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer10_gpu0&#45;&gt;route_layer10_gpu0 -->
<g id="edge993" class="edge">
<title>gate_layer10_gpu0&#45;&gt;route_layer10_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M989.72,-4270.8C1023.04,-4257.28 1060.7,-4242 1096.31,-4227.55"/>
<polygon fill="black" stroke="black" points="1097.85,-4230.7 1105.8,-4223.7 1095.22,-4224.21 1097.85,-4230.7"/>
</g>
<!-- route_layer10_gpu1 -->
<g id="node862" class="node">
<title>route_layer10_gpu1</title>
<path fill="orange" stroke="black" d="M2520.74,-4223.67C2520.74,-4223.67 2012.24,-4223.67 2012.24,-4223.67 2006.24,-4223.67 1995.5,-4220 1990.75,-4216.33 1990.75,-4216.33 1872.75,-4125.02 1872.75,-4125.02 1868,-4121.35 1869.26,-4117.67 1875.26,-4117.67 1875.26,-4117.67 2383.76,-4117.67 2383.76,-4117.67 2389.76,-4117.67 2400.5,-4121.35 2405.25,-4125.02 2405.25,-4125.02 2523.25,-4216.33 2523.25,-4216.33 2528,-4220 2526.74,-4223.67 2520.74,-4223.67"/>
<text text-anchor="middle" x="2198" y="-4181.97" font-family="Times,serif" font-size="14.00">Token Router Layer 10 GPU 1</text>
<text text-anchor="middle" x="2198" y="-4166.97" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="2198" y="-4151.97" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer10_gpu1&#45;&gt;route_layer10_gpu1 -->
<g id="edge994" class="edge">
<title>gate_layer10_gpu1&#45;&gt;route_layer10_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1953.72,-4270.8C1987.04,-4257.28 2024.7,-4242 2060.31,-4227.55"/>
<polygon fill="black" stroke="black" points="2061.85,-4230.7 2069.8,-4223.7 2059.22,-4224.21 2061.85,-4230.7"/>
</g>
<!-- route_layer10_gpu2 -->
<g id="node864" class="node">
<title>route_layer10_gpu2</title>
<path fill="orange" stroke="black" d="M3346.74,-4223.67C3346.74,-4223.67 2838.24,-4223.67 2838.24,-4223.67 2832.24,-4223.67 2821.5,-4220 2816.75,-4216.33 2816.75,-4216.33 2698.75,-4125.02 2698.75,-4125.02 2694,-4121.35 2695.26,-4117.67 2701.26,-4117.67 2701.26,-4117.67 3209.76,-4117.67 3209.76,-4117.67 3215.76,-4117.67 3226.5,-4121.35 3231.25,-4125.02 3231.25,-4125.02 3349.25,-4216.33 3349.25,-4216.33 3354,-4220 3352.74,-4223.67 3346.74,-4223.67"/>
<text text-anchor="middle" x="3024" y="-4181.97" font-family="Times,serif" font-size="14.00">Token Router Layer 10 GPU 2</text>
<text text-anchor="middle" x="3024" y="-4166.97" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="3024" y="-4151.97" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer10_gpu2&#45;&gt;route_layer10_gpu2 -->
<g id="edge995" class="edge">
<title>gate_layer10_gpu2&#45;&gt;route_layer10_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2883.07,-4266.99C2900.71,-4255.06 2920.04,-4241.98 2938.57,-4229.45"/>
<polygon fill="black" stroke="black" points="2940.69,-4232.24 2947.02,-4223.74 2936.77,-4226.44 2940.69,-4232.24"/>
</g>
<!-- route_layer10_gpu3 -->
<g id="node866" class="node">
<title>route_layer10_gpu3</title>
<path fill="orange" stroke="black" d="M4448.74,-4223.67C4448.74,-4223.67 3940.24,-4223.67 3940.24,-4223.67 3934.24,-4223.67 3923.5,-4220 3918.75,-4216.33 3918.75,-4216.33 3800.75,-4125.02 3800.75,-4125.02 3796,-4121.35 3797.26,-4117.67 3803.26,-4117.67 3803.26,-4117.67 4311.76,-4117.67 4311.76,-4117.67 4317.76,-4117.67 4328.5,-4121.35 4333.25,-4125.02 4333.25,-4125.02 4451.25,-4216.33 4451.25,-4216.33 4456,-4220 4454.74,-4223.67 4448.74,-4223.67"/>
<text text-anchor="middle" x="4126" y="-4181.97" font-family="Times,serif" font-size="14.00">Token Router Layer 10 GPU 3</text>
<text text-anchor="middle" x="4126" y="-4166.97" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="4126" y="-4151.97" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer10_gpu3&#45;&gt;route_layer10_gpu3 -->
<g id="edge996" class="edge">
<title>gate_layer10_gpu3&#45;&gt;route_layer10_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3881.72,-4270.8C3915.04,-4257.28 3952.7,-4242 3988.31,-4227.55"/>
<polygon fill="black" stroke="black" points="3989.85,-4230.7 3997.8,-4223.7 3987.22,-4224.21 3989.85,-4230.7"/>
</g>
<!-- route_layer10_gpu4 -->
<g id="node868" class="node">
<title>route_layer10_gpu4</title>
<path fill="orange" stroke="black" d="M5274.74,-4223.67C5274.74,-4223.67 4766.24,-4223.67 4766.24,-4223.67 4760.24,-4223.67 4749.5,-4220 4744.75,-4216.33 4744.75,-4216.33 4626.75,-4125.02 4626.75,-4125.02 4622,-4121.35 4623.26,-4117.67 4629.26,-4117.67 4629.26,-4117.67 5137.76,-4117.67 5137.76,-4117.67 5143.76,-4117.67 5154.5,-4121.35 5159.25,-4125.02 5159.25,-4125.02 5277.25,-4216.33 5277.25,-4216.33 5282,-4220 5280.74,-4223.67 5274.74,-4223.67"/>
<text text-anchor="middle" x="4952" y="-4181.97" font-family="Times,serif" font-size="14.00">Token Router Layer 10 GPU 4</text>
<text text-anchor="middle" x="4952" y="-4166.97" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="4952" y="-4151.97" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer10_gpu4&#45;&gt;route_layer10_gpu4 -->
<g id="edge997" class="edge">
<title>gate_layer10_gpu4&#45;&gt;route_layer10_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4811.07,-4266.99C4828.71,-4255.06 4848.04,-4241.98 4866.57,-4229.45"/>
<polygon fill="black" stroke="black" points="4868.69,-4232.24 4875.02,-4223.74 4864.77,-4226.44 4868.69,-4232.24"/>
</g>
<!-- route_layer10_gpu5 -->
<g id="node870" class="node">
<title>route_layer10_gpu5</title>
<path fill="orange" stroke="black" d="M6238.74,-4223.67C6238.74,-4223.67 5730.24,-4223.67 5730.24,-4223.67 5724.24,-4223.67 5713.5,-4220 5708.75,-4216.33 5708.75,-4216.33 5590.75,-4125.02 5590.75,-4125.02 5586,-4121.35 5587.26,-4117.67 5593.26,-4117.67 5593.26,-4117.67 6101.76,-4117.67 6101.76,-4117.67 6107.76,-4117.67 6118.5,-4121.35 6123.25,-4125.02 6123.25,-4125.02 6241.25,-4216.33 6241.25,-4216.33 6246,-4220 6244.74,-4223.67 6238.74,-4223.67"/>
<text text-anchor="middle" x="5916" y="-4181.97" font-family="Times,serif" font-size="14.00">Token Router Layer 10 GPU 5</text>
<text text-anchor="middle" x="5916" y="-4166.97" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="5916" y="-4151.97" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer10_gpu5&#45;&gt;route_layer10_gpu5 -->
<g id="edge998" class="edge">
<title>gate_layer10_gpu5&#45;&gt;route_layer10_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5775.07,-4266.99C5792.71,-4255.06 5812.04,-4241.98 5830.57,-4229.45"/>
<polygon fill="black" stroke="black" points="5832.69,-4232.24 5839.02,-4223.74 5828.77,-4226.44 5832.69,-4232.24"/>
</g>
<!-- route_layer10_gpu6 -->
<g id="node872" class="node">
<title>route_layer10_gpu6</title>
<path fill="orange" stroke="black" d="M7202.74,-4223.67C7202.74,-4223.67 6694.24,-4223.67 6694.24,-4223.67 6688.24,-4223.67 6677.5,-4220 6672.75,-4216.33 6672.75,-4216.33 6554.75,-4125.02 6554.75,-4125.02 6550,-4121.35 6551.26,-4117.67 6557.26,-4117.67 6557.26,-4117.67 7065.76,-4117.67 7065.76,-4117.67 7071.76,-4117.67 7082.5,-4121.35 7087.25,-4125.02 7087.25,-4125.02 7205.25,-4216.33 7205.25,-4216.33 7210,-4220 7208.74,-4223.67 7202.74,-4223.67"/>
<text text-anchor="middle" x="6880" y="-4181.97" font-family="Times,serif" font-size="14.00">Token Router Layer 10 GPU 6</text>
<text text-anchor="middle" x="6880" y="-4166.97" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="6880" y="-4151.97" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer10_gpu6&#45;&gt;route_layer10_gpu6 -->
<g id="edge999" class="edge">
<title>gate_layer10_gpu6&#45;&gt;route_layer10_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6739.07,-4266.99C6756.71,-4255.06 6776.04,-4241.98 6794.57,-4229.45"/>
<polygon fill="black" stroke="black" points="6796.69,-4232.24 6803.02,-4223.74 6792.77,-4226.44 6796.69,-4232.24"/>
</g>
<!-- route_layer10_gpu7 -->
<g id="node874" class="node">
<title>route_layer10_gpu7</title>
<path fill="orange" stroke="black" d="M8028.74,-4223.67C8028.74,-4223.67 7520.24,-4223.67 7520.24,-4223.67 7514.24,-4223.67 7503.5,-4220 7498.75,-4216.33 7498.75,-4216.33 7380.75,-4125.02 7380.75,-4125.02 7376,-4121.35 7377.26,-4117.67 7383.26,-4117.67 7383.26,-4117.67 7891.76,-4117.67 7891.76,-4117.67 7897.76,-4117.67 7908.5,-4121.35 7913.25,-4125.02 7913.25,-4125.02 8031.25,-4216.33 8031.25,-4216.33 8036,-4220 8034.74,-4223.67 8028.74,-4223.67"/>
<text text-anchor="middle" x="7706" y="-4181.97" font-family="Times,serif" font-size="14.00">Token Router Layer 10 GPU 7</text>
<text text-anchor="middle" x="7706" y="-4166.97" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="7706" y="-4151.97" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer10_gpu7&#45;&gt;route_layer10_gpu7 -->
<g id="edge1000" class="edge">
<title>gate_layer10_gpu7&#45;&gt;route_layer10_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7661.33,-4262.31C7665.97,-4252.89 7670.89,-4242.91 7675.69,-4233.16"/>
<polygon fill="black" stroke="black" points="7678.97,-4234.43 7680.26,-4223.91 7672.7,-4231.33 7678.97,-4234.43"/>
</g>
<!-- route_layer10_gpu8 -->
<g id="node876" class="node">
<title>route_layer10_gpu8</title>
<path fill="orange" stroke="black" d="M8854.74,-4223.67C8854.74,-4223.67 8346.24,-4223.67 8346.24,-4223.67 8340.24,-4223.67 8329.5,-4220 8324.75,-4216.33 8324.75,-4216.33 8206.75,-4125.02 8206.75,-4125.02 8202,-4121.35 8203.26,-4117.67 8209.26,-4117.67 8209.26,-4117.67 8717.76,-4117.67 8717.76,-4117.67 8723.76,-4117.67 8734.5,-4121.35 8739.25,-4125.02 8739.25,-4125.02 8857.25,-4216.33 8857.25,-4216.33 8862,-4220 8860.74,-4223.67 8854.74,-4223.67"/>
<text text-anchor="middle" x="8532" y="-4181.97" font-family="Times,serif" font-size="14.00">Token Router Layer 10 GPU 8</text>
<text text-anchor="middle" x="8532" y="-4166.97" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="8532" y="-4151.97" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer10_gpu8&#45;&gt;route_layer10_gpu8 -->
<g id="edge1001" class="edge">
<title>gate_layer10_gpu8&#45;&gt;route_layer10_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8576.67,-4262.31C8572.03,-4252.89 8567.11,-4242.91 8562.31,-4233.16"/>
<polygon fill="black" stroke="black" points="8565.3,-4231.33 8557.74,-4223.91 8559.03,-4234.43 8565.3,-4231.33"/>
</g>
<!-- route_layer10_gpu9 -->
<g id="node878" class="node">
<title>route_layer10_gpu9</title>
<path fill="orange" stroke="black" d="M9749.74,-4223.67C9749.74,-4223.67 9241.24,-4223.67 9241.24,-4223.67 9235.24,-4223.67 9224.5,-4220 9219.75,-4216.33 9219.75,-4216.33 9101.75,-4125.02 9101.75,-4125.02 9097,-4121.35 9098.26,-4117.67 9104.26,-4117.67 9104.26,-4117.67 9612.76,-4117.67 9612.76,-4117.67 9618.76,-4117.67 9629.5,-4121.35 9634.25,-4125.02 9634.25,-4125.02 9752.25,-4216.33 9752.25,-4216.33 9757,-4220 9755.74,-4223.67 9749.74,-4223.67"/>
<text text-anchor="middle" x="9427" y="-4181.97" font-family="Times,serif" font-size="14.00">Token Router Layer 10 GPU 9</text>
<text text-anchor="middle" x="9427" y="-4166.97" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="9427" y="-4151.97" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer10_gpu9&#45;&gt;route_layer10_gpu9 -->
<g id="edge1002" class="edge">
<title>gate_layer10_gpu9&#45;&gt;route_layer10_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9518.66,-4264.67C9508.13,-4253.98 9496.8,-4242.49 9485.83,-4231.35"/>
<polygon fill="black" stroke="black" points="9488.19,-4228.76 9478.68,-4224.1 9483.2,-4233.68 9488.19,-4228.76"/>
</g>
<!-- route_layer10_gpu10 -->
<g id="node880" class="node">
<title>route_layer10_gpu10</title>
<path fill="orange" stroke="black" d="M10678.74,-4223.67C10678.74,-4223.67 10170.24,-4223.67 10170.24,-4223.67 10164.24,-4223.67 10153.5,-4220 10148.75,-4216.33 10148.75,-4216.33 10030.75,-4125.02 10030.75,-4125.02 10026,-4121.35 10027.26,-4117.67 10033.26,-4117.67 10033.26,-4117.67 10541.76,-4117.67 10541.76,-4117.67 10547.76,-4117.67 10558.5,-4121.35 10563.25,-4125.02 10563.25,-4125.02 10681.25,-4216.33 10681.25,-4216.33 10686,-4220 10684.74,-4223.67 10678.74,-4223.67"/>
<text text-anchor="middle" x="10356" y="-4181.97" font-family="Times,serif" font-size="14.00">Token Router Layer 10 GPU 10</text>
<text text-anchor="middle" x="10356" y="-4166.97" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="10356" y="-4151.97" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer10_gpu10&#45;&gt;route_layer10_gpu10 -->
<g id="edge1003" class="edge">
<title>gate_layer10_gpu10&#45;&gt;route_layer10_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10472.35,-4265.83C10458.3,-4254.46 10443.05,-4242.12 10428.36,-4230.23"/>
<polygon fill="black" stroke="black" points="10430.24,-4227.25 10420.27,-4223.68 10425.84,-4232.69 10430.24,-4227.25"/>
</g>
<!-- route_layer10_gpu11 -->
<g id="node882" class="node">
<title>route_layer10_gpu11</title>
<path fill="orange" stroke="black" d="M11625.74,-4223.67C11625.74,-4223.67 11117.24,-4223.67 11117.24,-4223.67 11111.24,-4223.67 11100.5,-4220 11095.75,-4216.33 11095.75,-4216.33 10977.75,-4125.02 10977.75,-4125.02 10973,-4121.35 10974.26,-4117.67 10980.26,-4117.67 10980.26,-4117.67 11488.76,-4117.67 11488.76,-4117.67 11494.76,-4117.67 11505.5,-4121.35 11510.25,-4125.02 11510.25,-4125.02 11628.25,-4216.33 11628.25,-4216.33 11633,-4220 11631.74,-4223.67 11625.74,-4223.67"/>
<text text-anchor="middle" x="11303" y="-4181.97" font-family="Times,serif" font-size="14.00">Token Router Layer 10 GPU 11</text>
<text text-anchor="middle" x="11303" y="-4166.97" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="11303" y="-4151.97" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer10_gpu11&#45;&gt;route_layer10_gpu11 -->
<g id="edge1004" class="edge">
<title>gate_layer10_gpu11&#45;&gt;route_layer10_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11431.57,-4266.41C11415.74,-4254.74 11398.47,-4242.02 11381.87,-4229.79"/>
<polygon fill="black" stroke="black" points="11383.92,-4226.95 11373.79,-4223.84 11379.77,-4232.59 11383.92,-4226.95"/>
</g>
<!-- route_layer10_gpu12 -->
<g id="node884" class="node">
<title>route_layer10_gpu12</title>
<path fill="orange" stroke="black" d="M12580.74,-4223.67C12580.74,-4223.67 12072.24,-4223.67 12072.24,-4223.67 12066.24,-4223.67 12055.5,-4220 12050.75,-4216.33 12050.75,-4216.33 11932.75,-4125.02 11932.75,-4125.02 11928,-4121.35 11929.26,-4117.67 11935.26,-4117.67 11935.26,-4117.67 12443.76,-4117.67 12443.76,-4117.67 12449.76,-4117.67 12460.5,-4121.35 12465.25,-4125.02 12465.25,-4125.02 12583.25,-4216.33 12583.25,-4216.33 12588,-4220 12586.74,-4223.67 12580.74,-4223.67"/>
<text text-anchor="middle" x="12258" y="-4181.97" font-family="Times,serif" font-size="14.00">Token Router Layer 10 GPU 12</text>
<text text-anchor="middle" x="12258" y="-4166.97" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="12258" y="-4151.97" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer10_gpu12&#45;&gt;route_layer10_gpu12 -->
<g id="edge1005" class="edge">
<title>gate_layer10_gpu12&#45;&gt;route_layer10_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12393.21,-4266.8C12376.51,-4255.05 12358.25,-4242.2 12340.71,-4229.86"/>
<polygon fill="black" stroke="black" points="12342.36,-4226.75 12332.17,-4223.85 12338.34,-4232.47 12342.36,-4226.75"/>
</g>
<!-- route_layer10_gpu13 -->
<g id="node886" class="node">
<title>route_layer10_gpu13</title>
<path fill="orange" stroke="black" d="M13540.74,-4223.67C13540.74,-4223.67 13032.24,-4223.67 13032.24,-4223.67 13026.24,-4223.67 13015.5,-4220 13010.75,-4216.33 13010.75,-4216.33 12892.75,-4125.02 12892.75,-4125.02 12888,-4121.35 12889.26,-4117.67 12895.26,-4117.67 12895.26,-4117.67 13403.76,-4117.67 13403.76,-4117.67 13409.76,-4117.67 13420.5,-4121.35 13425.25,-4125.02 13425.25,-4125.02 13543.25,-4216.33 13543.25,-4216.33 13548,-4220 13546.74,-4223.67 13540.74,-4223.67"/>
<text text-anchor="middle" x="13218" y="-4181.97" font-family="Times,serif" font-size="14.00">Token Router Layer 10 GPU 13</text>
<text text-anchor="middle" x="13218" y="-4166.97" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="13218" y="-4151.97" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer10_gpu13&#45;&gt;route_layer10_gpu13 -->
<g id="edge1006" class="edge">
<title>gate_layer10_gpu13&#45;&gt;route_layer10_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13355.93,-4266.8C13338.89,-4255.05 13320.27,-4242.2 13302.38,-4229.86"/>
<polygon fill="black" stroke="black" points="13303.88,-4226.65 13293.66,-4223.85 13299.91,-4232.41 13303.88,-4226.65"/>
</g>
<!-- route_layer10_gpu14 -->
<g id="node888" class="node">
<title>route_layer10_gpu14</title>
<path fill="orange" stroke="black" d="M14502.74,-4223.67C14502.74,-4223.67 13994.24,-4223.67 13994.24,-4223.67 13988.24,-4223.67 13977.5,-4220 13972.75,-4216.33 13972.75,-4216.33 13854.75,-4125.02 13854.75,-4125.02 13850,-4121.35 13851.26,-4117.67 13857.26,-4117.67 13857.26,-4117.67 14365.76,-4117.67 14365.76,-4117.67 14371.76,-4117.67 14382.5,-4121.35 14387.25,-4125.02 14387.25,-4125.02 14505.25,-4216.33 14505.25,-4216.33 14510,-4220 14508.74,-4223.67 14502.74,-4223.67"/>
<text text-anchor="middle" x="14180" y="-4181.97" font-family="Times,serif" font-size="14.00">Token Router Layer 10 GPU 14</text>
<text text-anchor="middle" x="14180" y="-4166.97" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="14180" y="-4151.97" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer10_gpu14&#45;&gt;route_layer10_gpu14 -->
<g id="edge1007" class="edge">
<title>gate_layer10_gpu14&#45;&gt;route_layer10_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14319.57,-4266.99C14302.1,-4255.06 14282.96,-4241.98 14264.61,-4229.45"/>
<polygon fill="black" stroke="black" points="14266.47,-4226.49 14256.24,-4223.74 14262.52,-4232.27 14266.47,-4226.49"/>
</g>
<!-- route_layer10_gpu15 -->
<g id="node890" class="node">
<title>route_layer10_gpu15</title>
<path fill="orange" stroke="black" d="M15465.74,-4223.67C15465.74,-4223.67 14957.24,-4223.67 14957.24,-4223.67 14951.24,-4223.67 14940.5,-4220 14935.75,-4216.33 14935.75,-4216.33 14817.75,-4125.02 14817.75,-4125.02 14813,-4121.35 14814.26,-4117.67 14820.26,-4117.67 14820.26,-4117.67 15328.76,-4117.67 15328.76,-4117.67 15334.76,-4117.67 15345.5,-4121.35 15350.25,-4125.02 15350.25,-4125.02 15468.25,-4216.33 15468.25,-4216.33 15473,-4220 15471.74,-4223.67 15465.74,-4223.67"/>
<text text-anchor="middle" x="15143" y="-4181.97" font-family="Times,serif" font-size="14.00">Token Router Layer 10 GPU 15</text>
<text text-anchor="middle" x="15143" y="-4166.97" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="15143" y="-4151.97" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer10_gpu15&#45;&gt;route_layer10_gpu15 -->
<g id="edge1008" class="edge">
<title>gate_layer10_gpu15&#45;&gt;route_layer10_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15283.25,-4266.99C15265.69,-4255.06 15246.46,-4241.98 15228.02,-4229.45"/>
<polygon fill="black" stroke="black" points="15229.85,-4226.46 15219.61,-4223.74 15225.91,-4232.25 15229.85,-4226.46"/>
</g>
<!-- expert_layer10_gpu0_expert0 -->
<g id="node844" class="node">
<title>expert_layer10_gpu0_expert0</title>
<path fill="lightcoral" stroke="black" d="M1533.5,-3970.72C1533.5,-3970.72 1064.5,-3970.72 1064.5,-3970.72 1058.5,-3970.72 1052.5,-3964.72 1052.5,-3958.72 1052.5,-3958.72 1052.5,-3914.72 1052.5,-3914.72 1052.5,-3908.72 1058.5,-3902.72 1064.5,-3902.72 1064.5,-3902.72 1533.5,-3902.72 1533.5,-3902.72 1539.5,-3902.72 1545.5,-3908.72 1545.5,-3914.72 1545.5,-3914.72 1545.5,-3958.72 1545.5,-3958.72 1545.5,-3964.72 1539.5,-3970.72 1533.5,-3970.72"/>
<text text-anchor="middle" x="1299" y="-3955.52" font-family="Times,serif" font-size="14.00">Expert 0 Layer 10 GPU 0</text>
<text text-anchor="middle" x="1299" y="-3940.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="1299" y="-3925.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="1299" y="-3910.52" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer10_gpu0 -->
<g id="node861" class="node">
<title>aggregate_layer10_gpu0</title>
<path fill="orange" stroke="black" d="M1458.29,-3866.72C1458.29,-3866.72 971.19,-3866.72 971.19,-3866.72 965.19,-3866.72 954.52,-3862.95 949.85,-3859.19 949.85,-3859.19 837.06,-3768.25 837.06,-3768.25 832.38,-3764.49 833.71,-3760.72 839.71,-3760.72 839.71,-3760.72 1326.81,-3760.72 1326.81,-3760.72 1332.81,-3760.72 1343.48,-3764.49 1348.15,-3768.25 1348.15,-3768.25 1460.94,-3859.19 1460.94,-3859.19 1465.62,-3862.95 1464.29,-3866.72 1458.29,-3866.72"/>
<text text-anchor="middle" x="1149" y="-3825.02" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 10 GPU 0</text>
<text text-anchor="middle" x="1149" y="-3810.02" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="1149" y="-3795.02" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer10_gpu0_expert0&#45;&gt;aggregate_layer10_gpu0 -->
<g id="edge1041" class="edge">
<title>expert_layer10_gpu0_expert0&#45;&gt;aggregate_layer10_gpu0</title>
<path fill="none" stroke="black" d="M1258.01,-3902.66C1246.66,-3893.5 1233.99,-3883.28 1221.42,-3873.14"/>
<polygon fill="black" stroke="black" points="1223.6,-3870.4 1213.62,-3866.85 1219.21,-3875.85 1223.6,-3870.4"/>
</g>
<!-- expert_layer10_gpu1_expert1 -->
<g id="node845" class="node">
<title>expert_layer10_gpu1_expert1</title>
<path fill="lightcoral" stroke="black" d="M3489.5,-3970.72C3489.5,-3970.72 3020.5,-3970.72 3020.5,-3970.72 3014.5,-3970.72 3008.5,-3964.72 3008.5,-3958.72 3008.5,-3958.72 3008.5,-3914.72 3008.5,-3914.72 3008.5,-3908.72 3014.5,-3902.72 3020.5,-3902.72 3020.5,-3902.72 3489.5,-3902.72 3489.5,-3902.72 3495.5,-3902.72 3501.5,-3908.72 3501.5,-3914.72 3501.5,-3914.72 3501.5,-3958.72 3501.5,-3958.72 3501.5,-3964.72 3495.5,-3970.72 3489.5,-3970.72"/>
<text text-anchor="middle" x="3255" y="-3955.52" font-family="Times,serif" font-size="14.00">Expert 1 Layer 10 GPU 1</text>
<text text-anchor="middle" x="3255" y="-3940.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3255" y="-3925.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3255" y="-3910.52" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer10_gpu1 -->
<g id="node863" class="node">
<title>aggregate_layer10_gpu1</title>
<path fill="orange" stroke="black" d="M3061.29,-3866.72C3061.29,-3866.72 2574.19,-3866.72 2574.19,-3866.72 2568.19,-3866.72 2557.52,-3862.95 2552.85,-3859.19 2552.85,-3859.19 2440.06,-3768.25 2440.06,-3768.25 2435.38,-3764.49 2436.71,-3760.72 2442.71,-3760.72 2442.71,-3760.72 2929.81,-3760.72 2929.81,-3760.72 2935.81,-3760.72 2946.48,-3764.49 2951.15,-3768.25 2951.15,-3768.25 3063.94,-3859.19 3063.94,-3859.19 3068.62,-3862.95 3067.29,-3866.72 3061.29,-3866.72"/>
<text text-anchor="middle" x="2752" y="-3825.02" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 10 GPU 1</text>
<text text-anchor="middle" x="2752" y="-3810.02" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="2752" y="-3795.02" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer10_gpu1_expert1&#45;&gt;aggregate_layer10_gpu1 -->
<g id="edge1042" class="edge">
<title>expert_layer10_gpu1_expert1&#45;&gt;aggregate_layer10_gpu1</title>
<path fill="none" stroke="black" d="M3117.55,-3902.66C3074.42,-3892.28 3025.61,-3880.54 2978.03,-3869.09"/>
<polygon fill="black" stroke="black" points="2978.75,-3865.67 2968.21,-3866.73 2977.12,-3872.47 2978.75,-3865.67"/>
</g>
<!-- expert_layer10_gpu2_expert2 -->
<g id="node846" class="node">
<title>expert_layer10_gpu2_expert2</title>
<path fill="lightcoral" stroke="black" d="M4310.5,-3970.72C4310.5,-3970.72 3841.5,-3970.72 3841.5,-3970.72 3835.5,-3970.72 3829.5,-3964.72 3829.5,-3958.72 3829.5,-3958.72 3829.5,-3914.72 3829.5,-3914.72 3829.5,-3908.72 3835.5,-3902.72 3841.5,-3902.72 3841.5,-3902.72 4310.5,-3902.72 4310.5,-3902.72 4316.5,-3902.72 4322.5,-3908.72 4322.5,-3914.72 4322.5,-3914.72 4322.5,-3958.72 4322.5,-3958.72 4322.5,-3964.72 4316.5,-3970.72 4310.5,-3970.72"/>
<text text-anchor="middle" x="4076" y="-3955.52" font-family="Times,serif" font-size="14.00">Expert 2 Layer 10 GPU 2</text>
<text text-anchor="middle" x="4076" y="-3940.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4076" y="-3925.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4076" y="-3910.52" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer10_gpu2 -->
<g id="node865" class="node">
<title>aggregate_layer10_gpu2</title>
<path fill="orange" stroke="black" d="M4193.29,-3866.72C4193.29,-3866.72 3706.19,-3866.72 3706.19,-3866.72 3700.19,-3866.72 3689.52,-3862.95 3684.85,-3859.19 3684.85,-3859.19 3572.06,-3768.25 3572.06,-3768.25 3567.38,-3764.49 3568.71,-3760.72 3574.71,-3760.72 3574.71,-3760.72 4061.81,-3760.72 4061.81,-3760.72 4067.81,-3760.72 4078.48,-3764.49 4083.15,-3768.25 4083.15,-3768.25 4195.94,-3859.19 4195.94,-3859.19 4200.62,-3862.95 4199.29,-3866.72 4193.29,-3866.72"/>
<text text-anchor="middle" x="3884" y="-3825.02" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 10 GPU 2</text>
<text text-anchor="middle" x="3884" y="-3810.02" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="3884" y="-3795.02" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer10_gpu2_expert2&#45;&gt;aggregate_layer10_gpu2 -->
<g id="edge1043" class="edge">
<title>expert_layer10_gpu2_expert2&#45;&gt;aggregate_layer10_gpu2</title>
<path fill="none" stroke="black" d="M4023.54,-3902.66C4008.6,-3893.24 3991.87,-3882.7 3975.33,-3872.28"/>
<polygon fill="black" stroke="black" points="3977.04,-3869.22 3966.71,-3866.85 3973.31,-3875.14 3977.04,-3869.22"/>
</g>
<!-- expert_layer10_gpu3_expert3 -->
<g id="node847" class="node">
<title>expert_layer10_gpu3_expert3</title>
<path fill="lightcoral" stroke="black" d="M5148.5,-3970.72C5148.5,-3970.72 4679.5,-3970.72 4679.5,-3970.72 4673.5,-3970.72 4667.5,-3964.72 4667.5,-3958.72 4667.5,-3958.72 4667.5,-3914.72 4667.5,-3914.72 4667.5,-3908.72 4673.5,-3902.72 4679.5,-3902.72 4679.5,-3902.72 5148.5,-3902.72 5148.5,-3902.72 5154.5,-3902.72 5160.5,-3908.72 5160.5,-3914.72 5160.5,-3914.72 5160.5,-3958.72 5160.5,-3958.72 5160.5,-3964.72 5154.5,-3970.72 5148.5,-3970.72"/>
<text text-anchor="middle" x="4914" y="-3955.52" font-family="Times,serif" font-size="14.00">Expert 3 Layer 10 GPU 3</text>
<text text-anchor="middle" x="4914" y="-3940.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4914" y="-3925.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4914" y="-3910.52" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer10_gpu3 -->
<g id="node867" class="node">
<title>aggregate_layer10_gpu3</title>
<path fill="orange" stroke="black" d="M5089.29,-3866.72C5089.29,-3866.72 4602.19,-3866.72 4602.19,-3866.72 4596.19,-3866.72 4585.52,-3862.95 4580.85,-3859.19 4580.85,-3859.19 4468.06,-3768.25 4468.06,-3768.25 4463.38,-3764.49 4464.71,-3760.72 4470.71,-3760.72 4470.71,-3760.72 4957.81,-3760.72 4957.81,-3760.72 4963.81,-3760.72 4974.48,-3764.49 4979.15,-3768.25 4979.15,-3768.25 5091.94,-3859.19 5091.94,-3859.19 5096.62,-3862.95 5095.29,-3866.72 5089.29,-3866.72"/>
<text text-anchor="middle" x="4780" y="-3825.02" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 10 GPU 3</text>
<text text-anchor="middle" x="4780" y="-3810.02" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="4780" y="-3795.02" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer10_gpu3_expert3&#45;&gt;aggregate_layer10_gpu3 -->
<g id="edge1044" class="edge">
<title>expert_layer10_gpu3_expert3&#45;&gt;aggregate_layer10_gpu3</title>
<path fill="none" stroke="black" d="M4877.38,-3902.66C4867.44,-3893.67 4856.35,-3883.67 4845.33,-3873.71"/>
<polygon fill="black" stroke="black" points="4847.49,-3870.95 4837.73,-3866.85 4842.8,-3876.15 4847.49,-3870.95"/>
</g>
<!-- expert_layer10_gpu4_expert4 -->
<g id="node848" class="node">
<title>expert_layer10_gpu4_expert4</title>
<path fill="lightcoral" stroke="black" d="M5942.5,-3970.72C5942.5,-3970.72 5473.5,-3970.72 5473.5,-3970.72 5467.5,-3970.72 5461.5,-3964.72 5461.5,-3958.72 5461.5,-3958.72 5461.5,-3914.72 5461.5,-3914.72 5461.5,-3908.72 5467.5,-3902.72 5473.5,-3902.72 5473.5,-3902.72 5942.5,-3902.72 5942.5,-3902.72 5948.5,-3902.72 5954.5,-3908.72 5954.5,-3914.72 5954.5,-3914.72 5954.5,-3958.72 5954.5,-3958.72 5954.5,-3964.72 5948.5,-3970.72 5942.5,-3970.72"/>
<text text-anchor="middle" x="5708" y="-3955.52" font-family="Times,serif" font-size="14.00">Expert 4 Layer 10 GPU 4</text>
<text text-anchor="middle" x="5708" y="-3940.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5708" y="-3925.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5708" y="-3910.52" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer10_gpu4 -->
<g id="node869" class="node">
<title>aggregate_layer10_gpu4</title>
<path fill="orange" stroke="black" d="M5868.29,-3866.72C5868.29,-3866.72 5381.19,-3866.72 5381.19,-3866.72 5375.19,-3866.72 5364.52,-3862.95 5359.85,-3859.19 5359.85,-3859.19 5247.06,-3768.25 5247.06,-3768.25 5242.38,-3764.49 5243.71,-3760.72 5249.71,-3760.72 5249.71,-3760.72 5736.81,-3760.72 5736.81,-3760.72 5742.81,-3760.72 5753.48,-3764.49 5758.15,-3768.25 5758.15,-3768.25 5870.94,-3859.19 5870.94,-3859.19 5875.62,-3862.95 5874.29,-3866.72 5868.29,-3866.72"/>
<text text-anchor="middle" x="5559" y="-3825.02" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 10 GPU 4</text>
<text text-anchor="middle" x="5559" y="-3810.02" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="5559" y="-3795.02" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer10_gpu4_expert4&#45;&gt;aggregate_layer10_gpu4 -->
<g id="edge1045" class="edge">
<title>expert_layer10_gpu4_expert4&#45;&gt;aggregate_layer10_gpu4</title>
<path fill="none" stroke="black" d="M5667.29,-3902.66C5656.12,-3893.59 5643.66,-3883.47 5631.29,-3873.43"/>
<polygon fill="black" stroke="black" points="5633.16,-3870.43 5623.19,-3866.85 5628.75,-3875.87 5633.16,-3870.43"/>
</g>
<!-- expert_layer10_gpu5_expert5 -->
<g id="node849" class="node">
<title>expert_layer10_gpu5_expert5</title>
<path fill="lightcoral" stroke="black" d="M6685.5,-3970.72C6685.5,-3970.72 6216.5,-3970.72 6216.5,-3970.72 6210.5,-3970.72 6204.5,-3964.72 6204.5,-3958.72 6204.5,-3958.72 6204.5,-3914.72 6204.5,-3914.72 6204.5,-3908.72 6210.5,-3902.72 6216.5,-3902.72 6216.5,-3902.72 6685.5,-3902.72 6685.5,-3902.72 6691.5,-3902.72 6697.5,-3908.72 6697.5,-3914.72 6697.5,-3914.72 6697.5,-3958.72 6697.5,-3958.72 6697.5,-3964.72 6691.5,-3970.72 6685.5,-3970.72"/>
<text text-anchor="middle" x="6451" y="-3955.52" font-family="Times,serif" font-size="14.00">Expert 5 Layer 10 GPU 5</text>
<text text-anchor="middle" x="6451" y="-3940.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6451" y="-3925.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6451" y="-3910.52" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer10_gpu5 -->
<g id="node871" class="node">
<title>aggregate_layer10_gpu5</title>
<path fill="orange" stroke="black" d="M6588.29,-3866.72C6588.29,-3866.72 6101.19,-3866.72 6101.19,-3866.72 6095.19,-3866.72 6084.52,-3862.95 6079.85,-3859.19 6079.85,-3859.19 5967.06,-3768.25 5967.06,-3768.25 5962.38,-3764.49 5963.71,-3760.72 5969.71,-3760.72 5969.71,-3760.72 6456.81,-3760.72 6456.81,-3760.72 6462.81,-3760.72 6473.48,-3764.49 6478.15,-3768.25 6478.15,-3768.25 6590.94,-3859.19 6590.94,-3859.19 6595.62,-3862.95 6594.29,-3866.72 6588.29,-3866.72"/>
<text text-anchor="middle" x="6279" y="-3825.02" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 10 GPU 5</text>
<text text-anchor="middle" x="6279" y="-3810.02" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="6279" y="-3795.02" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer10_gpu5_expert5&#45;&gt;aggregate_layer10_gpu5 -->
<g id="edge1046" class="edge">
<title>expert_layer10_gpu5_expert5&#45;&gt;aggregate_layer10_gpu5</title>
<path fill="none" stroke="black" d="M6404,-3902.66C6390.86,-3893.41 6376.19,-3883.09 6361.64,-3872.85"/>
<polygon fill="black" stroke="black" points="6363.29,-3869.74 6353.1,-3866.85 6359.26,-3875.46 6363.29,-3869.74"/>
</g>
<!-- expert_layer10_gpu6_expert6 -->
<g id="node850" class="node">
<title>expert_layer10_gpu6_expert6</title>
<path fill="lightcoral" stroke="black" d="M7285.5,-3970.72C7285.5,-3970.72 6816.5,-3970.72 6816.5,-3970.72 6810.5,-3970.72 6804.5,-3964.72 6804.5,-3958.72 6804.5,-3958.72 6804.5,-3914.72 6804.5,-3914.72 6804.5,-3908.72 6810.5,-3902.72 6816.5,-3902.72 6816.5,-3902.72 7285.5,-3902.72 7285.5,-3902.72 7291.5,-3902.72 7297.5,-3908.72 7297.5,-3914.72 7297.5,-3914.72 7297.5,-3958.72 7297.5,-3958.72 7297.5,-3964.72 7291.5,-3970.72 7285.5,-3970.72"/>
<text text-anchor="middle" x="7051" y="-3955.52" font-family="Times,serif" font-size="14.00">Expert 6 Layer 10 GPU 6</text>
<text text-anchor="middle" x="7051" y="-3940.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7051" y="-3925.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7051" y="-3910.52" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer10_gpu6 -->
<g id="node873" class="node">
<title>aggregate_layer10_gpu6</title>
<path fill="orange" stroke="black" d="M7278.29,-3866.72C7278.29,-3866.72 6791.19,-3866.72 6791.19,-3866.72 6785.19,-3866.72 6774.52,-3862.95 6769.85,-3859.19 6769.85,-3859.19 6657.06,-3768.25 6657.06,-3768.25 6652.38,-3764.49 6653.71,-3760.72 6659.71,-3760.72 6659.71,-3760.72 7146.81,-3760.72 7146.81,-3760.72 7152.81,-3760.72 7163.48,-3764.49 7168.15,-3768.25 7168.15,-3768.25 7280.94,-3859.19 7280.94,-3859.19 7285.62,-3862.95 7284.29,-3866.72 7278.29,-3866.72"/>
<text text-anchor="middle" x="6969" y="-3825.02" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 10 GPU 6</text>
<text text-anchor="middle" x="6969" y="-3810.02" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="6969" y="-3795.02" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer10_gpu6_expert6&#45;&gt;aggregate_layer10_gpu6 -->
<g id="edge1047" class="edge">
<title>expert_layer10_gpu6_expert6&#45;&gt;aggregate_layer10_gpu6</title>
<path fill="none" stroke="black" d="M7028.59,-3902.66C7022.8,-3894.11 7016.37,-3884.63 7009.95,-3875.15"/>
<polygon fill="black" stroke="black" points="7012.83,-3873.16 7004.33,-3866.85 7007.04,-3877.09 7012.83,-3873.16"/>
</g>
<!-- expert_layer10_gpu7_expert7 -->
<g id="node851" class="node">
<title>expert_layer10_gpu7_expert7</title>
<path fill="lightcoral" stroke="black" d="M7954.5,-3970.72C7954.5,-3970.72 7485.5,-3970.72 7485.5,-3970.72 7479.5,-3970.72 7473.5,-3964.72 7473.5,-3958.72 7473.5,-3958.72 7473.5,-3914.72 7473.5,-3914.72 7473.5,-3908.72 7479.5,-3902.72 7485.5,-3902.72 7485.5,-3902.72 7954.5,-3902.72 7954.5,-3902.72 7960.5,-3902.72 7966.5,-3908.72 7966.5,-3914.72 7966.5,-3914.72 7966.5,-3958.72 7966.5,-3958.72 7966.5,-3964.72 7960.5,-3970.72 7954.5,-3970.72"/>
<text text-anchor="middle" x="7720" y="-3955.52" font-family="Times,serif" font-size="14.00">Expert 7 Layer 10 GPU 7</text>
<text text-anchor="middle" x="7720" y="-3940.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7720" y="-3925.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7720" y="-3910.52" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer10_gpu7 -->
<g id="node875" class="node">
<title>aggregate_layer10_gpu7</title>
<path fill="orange" stroke="black" d="M7954.29,-3866.72C7954.29,-3866.72 7467.19,-3866.72 7467.19,-3866.72 7461.19,-3866.72 7450.52,-3862.95 7445.85,-3859.19 7445.85,-3859.19 7333.06,-3768.25 7333.06,-3768.25 7328.38,-3764.49 7329.71,-3760.72 7335.71,-3760.72 7335.71,-3760.72 7822.81,-3760.72 7822.81,-3760.72 7828.81,-3760.72 7839.48,-3764.49 7844.15,-3768.25 7844.15,-3768.25 7956.94,-3859.19 7956.94,-3859.19 7961.62,-3862.95 7960.29,-3866.72 7954.29,-3866.72"/>
<text text-anchor="middle" x="7645" y="-3825.02" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 10 GPU 7</text>
<text text-anchor="middle" x="7645" y="-3810.02" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="7645" y="-3795.02" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer10_gpu7_expert7&#45;&gt;aggregate_layer10_gpu7 -->
<g id="edge1048" class="edge">
<title>expert_layer10_gpu7_expert7&#45;&gt;aggregate_layer10_gpu7</title>
<path fill="none" stroke="black" d="M7699.51,-3902.66C7694.26,-3894.19 7688.45,-3884.82 7682.63,-3875.44"/>
<polygon fill="black" stroke="black" points="7685.55,-3873.5 7677.31,-3866.85 7679.6,-3877.19 7685.55,-3873.5"/>
</g>
<!-- expert_layer10_gpu8_expert8 -->
<g id="node852" class="node">
<title>expert_layer10_gpu8_expert8</title>
<path fill="lightcoral" stroke="black" d="M8615.5,-3970.72C8615.5,-3970.72 8146.5,-3970.72 8146.5,-3970.72 8140.5,-3970.72 8134.5,-3964.72 8134.5,-3958.72 8134.5,-3958.72 8134.5,-3914.72 8134.5,-3914.72 8134.5,-3908.72 8140.5,-3902.72 8146.5,-3902.72 8146.5,-3902.72 8615.5,-3902.72 8615.5,-3902.72 8621.5,-3902.72 8627.5,-3908.72 8627.5,-3914.72 8627.5,-3914.72 8627.5,-3958.72 8627.5,-3958.72 8627.5,-3964.72 8621.5,-3970.72 8615.5,-3970.72"/>
<text text-anchor="middle" x="8381" y="-3955.52" font-family="Times,serif" font-size="14.00">Expert 8 Layer 10 GPU 8</text>
<text text-anchor="middle" x="8381" y="-3940.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8381" y="-3925.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8381" y="-3910.52" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer10_gpu8 -->
<g id="node877" class="node">
<title>aggregate_layer10_gpu8</title>
<path fill="orange" stroke="black" d="M8766.29,-3866.72C8766.29,-3866.72 8279.19,-3866.72 8279.19,-3866.72 8273.19,-3866.72 8262.52,-3862.95 8257.85,-3859.19 8257.85,-3859.19 8145.06,-3768.25 8145.06,-3768.25 8140.38,-3764.49 8141.71,-3760.72 8147.71,-3760.72 8147.71,-3760.72 8634.81,-3760.72 8634.81,-3760.72 8640.81,-3760.72 8651.48,-3764.49 8656.15,-3768.25 8656.15,-3768.25 8768.94,-3859.19 8768.94,-3859.19 8773.62,-3862.95 8772.29,-3866.72 8766.29,-3866.72"/>
<text text-anchor="middle" x="8457" y="-3825.02" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 10 GPU 8</text>
<text text-anchor="middle" x="8457" y="-3810.02" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="8457" y="-3795.02" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer10_gpu8_expert8&#45;&gt;aggregate_layer10_gpu8 -->
<g id="edge1049" class="edge">
<title>expert_layer10_gpu8_expert8&#45;&gt;aggregate_layer10_gpu8</title>
<path fill="none" stroke="black" d="M8401.77,-3902.66C8407.08,-3894.19 8412.97,-3884.82 8418.86,-3875.44"/>
<polygon fill="black" stroke="black" points="8421.9,-3877.18 8424.26,-3866.85 8415.98,-3873.45 8421.9,-3877.18"/>
</g>
<!-- expert_layer10_gpu9_expert9 -->
<g id="node853" class="node">
<title>expert_layer10_gpu9_expert9</title>
<path fill="lightcoral" stroke="black" d="M9390.5,-3970.72C9390.5,-3970.72 8921.5,-3970.72 8921.5,-3970.72 8915.5,-3970.72 8909.5,-3964.72 8909.5,-3958.72 8909.5,-3958.72 8909.5,-3914.72 8909.5,-3914.72 8909.5,-3908.72 8915.5,-3902.72 8921.5,-3902.72 8921.5,-3902.72 9390.5,-3902.72 9390.5,-3902.72 9396.5,-3902.72 9402.5,-3908.72 9402.5,-3914.72 9402.5,-3914.72 9402.5,-3958.72 9402.5,-3958.72 9402.5,-3964.72 9396.5,-3970.72 9390.5,-3970.72"/>
<text text-anchor="middle" x="9156" y="-3955.52" font-family="Times,serif" font-size="14.00">Expert 9 Layer 10 GPU 9</text>
<text text-anchor="middle" x="9156" y="-3940.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9156" y="-3925.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9156" y="-3910.52" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer10_gpu9 -->
<g id="node879" class="node">
<title>aggregate_layer10_gpu9</title>
<path fill="orange" stroke="black" d="M9654.29,-3866.72C9654.29,-3866.72 9167.19,-3866.72 9167.19,-3866.72 9161.19,-3866.72 9150.52,-3862.95 9145.85,-3859.19 9145.85,-3859.19 9033.06,-3768.25 9033.06,-3768.25 9028.38,-3764.49 9029.71,-3760.72 9035.71,-3760.72 9035.71,-3760.72 9522.81,-3760.72 9522.81,-3760.72 9528.81,-3760.72 9539.48,-3764.49 9544.15,-3768.25 9544.15,-3768.25 9656.94,-3859.19 9656.94,-3859.19 9661.62,-3862.95 9660.29,-3866.72 9654.29,-3866.72"/>
<text text-anchor="middle" x="9345" y="-3825.02" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 10 GPU 9</text>
<text text-anchor="middle" x="9345" y="-3810.02" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="9345" y="-3795.02" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer10_gpu9_expert9&#45;&gt;aggregate_layer10_gpu9 -->
<g id="edge1050" class="edge">
<title>expert_layer10_gpu9_expert9&#45;&gt;aggregate_layer10_gpu9</title>
<path fill="none" stroke="black" d="M9207.65,-3902.66C9222.35,-3893.24 9238.81,-3882.7 9255.09,-3872.28"/>
<polygon fill="black" stroke="black" points="9257.04,-3875.19 9263.58,-3866.85 9253.27,-3869.29 9257.04,-3875.19"/>
</g>
<!-- expert_layer10_gpu10_expert10 -->
<g id="node854" class="node">
<title>expert_layer10_gpu10_expert10</title>
<path fill="lightcoral" stroke="black" d="M10219.5,-3970.72C10219.5,-3970.72 9750.5,-3970.72 9750.5,-3970.72 9744.5,-3970.72 9738.5,-3964.72 9738.5,-3958.72 9738.5,-3958.72 9738.5,-3914.72 9738.5,-3914.72 9738.5,-3908.72 9744.5,-3902.72 9750.5,-3902.72 9750.5,-3902.72 10219.5,-3902.72 10219.5,-3902.72 10225.5,-3902.72 10231.5,-3908.72 10231.5,-3914.72 10231.5,-3914.72 10231.5,-3958.72 10231.5,-3958.72 10231.5,-3964.72 10225.5,-3970.72 10219.5,-3970.72"/>
<text text-anchor="middle" x="9985" y="-3955.52" font-family="Times,serif" font-size="14.00">Expert 10 Layer 10 GPU 10</text>
<text text-anchor="middle" x="9985" y="-3940.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9985" y="-3925.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9985" y="-3910.52" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer10_gpu10 -->
<g id="node881" class="node">
<title>aggregate_layer10_gpu10</title>
<path fill="orange" stroke="black" d="M10537.29,-3866.72C10537.29,-3866.72 10050.19,-3866.72 10050.19,-3866.72 10044.19,-3866.72 10033.52,-3862.95 10028.85,-3859.19 10028.85,-3859.19 9916.06,-3768.25 9916.06,-3768.25 9911.38,-3764.49 9912.71,-3760.72 9918.71,-3760.72 9918.71,-3760.72 10405.81,-3760.72 10405.81,-3760.72 10411.81,-3760.72 10422.48,-3764.49 10427.15,-3768.25 10427.15,-3768.25 10539.94,-3859.19 10539.94,-3859.19 10544.62,-3862.95 10543.29,-3866.72 10537.29,-3866.72"/>
<text text-anchor="middle" x="10228" y="-3825.02" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 10 GPU 10</text>
<text text-anchor="middle" x="10228" y="-3810.02" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="10228" y="-3795.02" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer10_gpu10_expert10&#45;&gt;aggregate_layer10_gpu10 -->
<g id="edge1051" class="edge">
<title>expert_layer10_gpu10_expert10&#45;&gt;aggregate_layer10_gpu10</title>
<path fill="none" stroke="black" d="M10051.4,-3902.66C10070.83,-3892.98 10092.64,-3882.12 10114.13,-3871.42"/>
<polygon fill="black" stroke="black" points="10115.92,-3874.44 10123.32,-3866.85 10112.8,-3868.17 10115.92,-3874.44"/>
</g>
<!-- expert_layer10_gpu11_expert11 -->
<g id="node855" class="node">
<title>expert_layer10_gpu11_expert11</title>
<path fill="lightcoral" stroke="black" d="M11019.5,-3970.72C11019.5,-3970.72 10550.5,-3970.72 10550.5,-3970.72 10544.5,-3970.72 10538.5,-3964.72 10538.5,-3958.72 10538.5,-3958.72 10538.5,-3914.72 10538.5,-3914.72 10538.5,-3908.72 10544.5,-3902.72 10550.5,-3902.72 10550.5,-3902.72 11019.5,-3902.72 11019.5,-3902.72 11025.5,-3902.72 11031.5,-3908.72 11031.5,-3914.72 11031.5,-3914.72 11031.5,-3958.72 11031.5,-3958.72 11031.5,-3964.72 11025.5,-3970.72 11019.5,-3970.72"/>
<text text-anchor="middle" x="10785" y="-3955.52" font-family="Times,serif" font-size="14.00">Expert 11 Layer 10 GPU 11</text>
<text text-anchor="middle" x="10785" y="-3940.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10785" y="-3925.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10785" y="-3910.52" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer10_gpu11 -->
<g id="node883" class="node">
<title>aggregate_layer10_gpu11</title>
<path fill="orange" stroke="black" d="M11309.29,-3866.72C11309.29,-3866.72 10822.19,-3866.72 10822.19,-3866.72 10816.19,-3866.72 10805.52,-3862.95 10800.85,-3859.19 10800.85,-3859.19 10688.06,-3768.25 10688.06,-3768.25 10683.38,-3764.49 10684.71,-3760.72 10690.71,-3760.72 10690.71,-3760.72 11177.81,-3760.72 11177.81,-3760.72 11183.81,-3760.72 11194.48,-3764.49 11199.15,-3768.25 11199.15,-3768.25 11311.94,-3859.19 11311.94,-3859.19 11316.62,-3862.95 11315.29,-3866.72 11309.29,-3866.72"/>
<text text-anchor="middle" x="11000" y="-3825.02" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 10 GPU 11</text>
<text text-anchor="middle" x="11000" y="-3810.02" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="11000" y="-3795.02" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer10_gpu11_expert11&#45;&gt;aggregate_layer10_gpu11 -->
<g id="edge1052" class="edge">
<title>expert_layer10_gpu11_expert11&#45;&gt;aggregate_layer10_gpu11</title>
<path fill="none" stroke="black" d="M10843.75,-3902.66C10860.71,-3893.11 10879.72,-3882.41 10898.49,-3871.85"/>
<polygon fill="black" stroke="black" points="10900.38,-3874.8 10907.38,-3866.85 10896.95,-3868.7 10900.38,-3874.8"/>
</g>
<!-- expert_layer10_gpu12_expert12 -->
<g id="node856" class="node">
<title>expert_layer10_gpu12_expert12</title>
<path fill="lightcoral" stroke="black" d="M11778.5,-3970.72C11778.5,-3970.72 11309.5,-3970.72 11309.5,-3970.72 11303.5,-3970.72 11297.5,-3964.72 11297.5,-3958.72 11297.5,-3958.72 11297.5,-3914.72 11297.5,-3914.72 11297.5,-3908.72 11303.5,-3902.72 11309.5,-3902.72 11309.5,-3902.72 11778.5,-3902.72 11778.5,-3902.72 11784.5,-3902.72 11790.5,-3908.72 11790.5,-3914.72 11790.5,-3914.72 11790.5,-3958.72 11790.5,-3958.72 11790.5,-3964.72 11784.5,-3970.72 11778.5,-3970.72"/>
<text text-anchor="middle" x="11544" y="-3955.52" font-family="Times,serif" font-size="14.00">Expert 12 Layer 10 GPU 12</text>
<text text-anchor="middle" x="11544" y="-3940.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11544" y="-3925.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11544" y="-3910.52" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer10_gpu12 -->
<g id="node885" class="node">
<title>aggregate_layer10_gpu12</title>
<path fill="orange" stroke="black" d="M12026.29,-3866.72C12026.29,-3866.72 11539.19,-3866.72 11539.19,-3866.72 11533.19,-3866.72 11522.52,-3862.95 11517.85,-3859.19 11517.85,-3859.19 11405.06,-3768.25 11405.06,-3768.25 11400.38,-3764.49 11401.71,-3760.72 11407.71,-3760.72 11407.71,-3760.72 11894.81,-3760.72 11894.81,-3760.72 11900.81,-3760.72 11911.48,-3764.49 11916.15,-3768.25 11916.15,-3768.25 12028.94,-3859.19 12028.94,-3859.19 12033.62,-3862.95 12032.29,-3866.72 12026.29,-3866.72"/>
<text text-anchor="middle" x="11717" y="-3825.02" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 10 GPU 12</text>
<text text-anchor="middle" x="11717" y="-3810.02" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="11717" y="-3795.02" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer10_gpu12_expert12&#45;&gt;aggregate_layer10_gpu12 -->
<g id="edge1053" class="edge">
<title>expert_layer10_gpu12_expert12&#45;&gt;aggregate_layer10_gpu12</title>
<path fill="none" stroke="black" d="M11591.27,-3902.66C11604.49,-3893.41 11619.25,-3883.09 11633.88,-3872.85"/>
<polygon fill="black" stroke="black" points="11636.28,-3875.45 11642.47,-3866.85 11632.27,-3869.71 11636.28,-3875.45"/>
</g>
<!-- expert_layer10_gpu13_expert13 -->
<g id="node857" class="node">
<title>expert_layer10_gpu13_expert13</title>
<path fill="lightcoral" stroke="black" d="M12729.5,-3970.72C12729.5,-3970.72 12260.5,-3970.72 12260.5,-3970.72 12254.5,-3970.72 12248.5,-3964.72 12248.5,-3958.72 12248.5,-3958.72 12248.5,-3914.72 12248.5,-3914.72 12248.5,-3908.72 12254.5,-3902.72 12260.5,-3902.72 12260.5,-3902.72 12729.5,-3902.72 12729.5,-3902.72 12735.5,-3902.72 12741.5,-3908.72 12741.5,-3914.72 12741.5,-3914.72 12741.5,-3958.72 12741.5,-3958.72 12741.5,-3964.72 12735.5,-3970.72 12729.5,-3970.72"/>
<text text-anchor="middle" x="12495" y="-3955.52" font-family="Times,serif" font-size="14.00">Expert 13 Layer 10 GPU 13</text>
<text text-anchor="middle" x="12495" y="-3940.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12495" y="-3925.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12495" y="-3910.52" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer10_gpu13 -->
<g id="node887" class="node">
<title>aggregate_layer10_gpu13</title>
<path fill="orange" stroke="black" d="M13169.29,-3866.72C13169.29,-3866.72 12682.19,-3866.72 12682.19,-3866.72 12676.19,-3866.72 12665.52,-3862.95 12660.85,-3859.19 12660.85,-3859.19 12548.06,-3768.25 12548.06,-3768.25 12543.38,-3764.49 12544.71,-3760.72 12550.71,-3760.72 12550.71,-3760.72 13037.81,-3760.72 13037.81,-3760.72 13043.81,-3760.72 13054.48,-3764.49 13059.15,-3768.25 13059.15,-3768.25 13171.94,-3859.19 13171.94,-3859.19 13176.62,-3862.95 13175.29,-3866.72 13169.29,-3866.72"/>
<text text-anchor="middle" x="12860" y="-3825.02" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 10 GPU 13</text>
<text text-anchor="middle" x="12860" y="-3810.02" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="12860" y="-3795.02" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer10_gpu13_expert13&#45;&gt;aggregate_layer10_gpu13 -->
<g id="edge1054" class="edge">
<title>expert_layer10_gpu13_expert13&#45;&gt;aggregate_layer10_gpu13</title>
<path fill="none" stroke="black" d="M12594.74,-3902.66C12625.32,-3892.52 12659.83,-3881.08 12693.6,-3869.88"/>
<polygon fill="black" stroke="black" points="12694.71,-3873.2 12703.11,-3866.73 12692.51,-3866.56 12694.71,-3873.2"/>
</g>
<!-- expert_layer10_gpu14_expert14 -->
<g id="node858" class="node">
<title>expert_layer10_gpu14_expert14</title>
<path fill="lightcoral" stroke="black" d="M13655.5,-3970.72C13655.5,-3970.72 13186.5,-3970.72 13186.5,-3970.72 13180.5,-3970.72 13174.5,-3964.72 13174.5,-3958.72 13174.5,-3958.72 13174.5,-3914.72 13174.5,-3914.72 13174.5,-3908.72 13180.5,-3902.72 13186.5,-3902.72 13186.5,-3902.72 13655.5,-3902.72 13655.5,-3902.72 13661.5,-3902.72 13667.5,-3908.72 13667.5,-3914.72 13667.5,-3914.72 13667.5,-3958.72 13667.5,-3958.72 13667.5,-3964.72 13661.5,-3970.72 13655.5,-3970.72"/>
<text text-anchor="middle" x="13421" y="-3955.52" font-family="Times,serif" font-size="14.00">Expert 14 Layer 10 GPU 14</text>
<text text-anchor="middle" x="13421" y="-3940.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="13421" y="-3925.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="13421" y="-3910.52" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer10_gpu14 -->
<g id="node889" class="node">
<title>aggregate_layer10_gpu14</title>
<path fill="orange" stroke="black" d="M14071.29,-3866.72C14071.29,-3866.72 13584.19,-3866.72 13584.19,-3866.72 13578.19,-3866.72 13567.52,-3862.95 13562.85,-3859.19 13562.85,-3859.19 13450.06,-3768.25 13450.06,-3768.25 13445.38,-3764.49 13446.71,-3760.72 13452.71,-3760.72 13452.71,-3760.72 13939.81,-3760.72 13939.81,-3760.72 13945.81,-3760.72 13956.48,-3764.49 13961.15,-3768.25 13961.15,-3768.25 14073.94,-3859.19 14073.94,-3859.19 14078.62,-3862.95 14077.29,-3866.72 14071.29,-3866.72"/>
<text text-anchor="middle" x="13762" y="-3825.02" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 10 GPU 14</text>
<text text-anchor="middle" x="13762" y="-3810.02" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="13762" y="-3795.02" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer10_gpu14_expert14&#45;&gt;aggregate_layer10_gpu14 -->
<g id="edge1055" class="edge">
<title>expert_layer10_gpu14_expert14&#45;&gt;aggregate_layer10_gpu14</title>
<path fill="none" stroke="black" d="M13514.18,-3902.66C13542.5,-3892.61 13574.44,-3881.27 13605.74,-3870.17"/>
<polygon fill="black" stroke="black" points="13607.17,-3873.37 13615.42,-3866.73 13604.83,-3866.78 13607.17,-3873.37"/>
</g>
<!-- expert_layer10_gpu15_expert15 -->
<g id="node859" class="node">
<title>expert_layer10_gpu15_expert15</title>
<path fill="lightcoral" stroke="black" d="M14509.5,-3970.72C14509.5,-3970.72 14040.5,-3970.72 14040.5,-3970.72 14034.5,-3970.72 14028.5,-3964.72 14028.5,-3958.72 14028.5,-3958.72 14028.5,-3914.72 14028.5,-3914.72 14028.5,-3908.72 14034.5,-3902.72 14040.5,-3902.72 14040.5,-3902.72 14509.5,-3902.72 14509.5,-3902.72 14515.5,-3902.72 14521.5,-3908.72 14521.5,-3914.72 14521.5,-3914.72 14521.5,-3958.72 14521.5,-3958.72 14521.5,-3964.72 14515.5,-3970.72 14509.5,-3970.72"/>
<text text-anchor="middle" x="14275" y="-3955.52" font-family="Times,serif" font-size="14.00">Expert 15 Layer 10 GPU 15</text>
<text text-anchor="middle" x="14275" y="-3940.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14275" y="-3925.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14275" y="-3910.52" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer10_gpu15 -->
<g id="node891" class="node">
<title>aggregate_layer10_gpu15</title>
<path fill="orange" stroke="black" d="M14853.29,-3866.72C14853.29,-3866.72 14366.19,-3866.72 14366.19,-3866.72 14360.19,-3866.72 14349.52,-3862.95 14344.85,-3859.19 14344.85,-3859.19 14232.06,-3768.25 14232.06,-3768.25 14227.38,-3764.49 14228.71,-3760.72 14234.71,-3760.72 14234.71,-3760.72 14721.81,-3760.72 14721.81,-3760.72 14727.81,-3760.72 14738.48,-3764.49 14743.15,-3768.25 14743.15,-3768.25 14855.94,-3859.19 14855.94,-3859.19 14860.62,-3862.95 14859.29,-3866.72 14853.29,-3866.72"/>
<text text-anchor="middle" x="14544" y="-3825.02" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 10 GPU 15</text>
<text text-anchor="middle" x="14544" y="-3810.02" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="14544" y="-3795.02" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer10_gpu15_expert15&#45;&gt;aggregate_layer10_gpu15 -->
<g id="edge1056" class="edge">
<title>expert_layer10_gpu15_expert15&#45;&gt;aggregate_layer10_gpu15</title>
<path fill="none" stroke="black" d="M14348.51,-3902.66C14370.37,-3892.82 14394.96,-3881.76 14419.13,-3870.89"/>
<polygon fill="black" stroke="black" points="14420.69,-3874.03 14428.37,-3866.73 14417.82,-3867.64 14420.69,-3874.03"/>
</g>
<!-- comm_layer10 -->
<g id="node892" class="node">
<title>comm_layer10</title>
<ellipse fill="lightpink" stroke="black" cx="8050" cy="-4044.2" rx="243.49" ry="37.45"/>
<text text-anchor="middle" x="8050" y="-4055.5" font-family="Times,serif" font-size="14.00">Cross&#45;GPU Communication Layer 10</text>
<text text-anchor="middle" x="8050" y="-4040.5" font-family="Times,serif" font-size="14.00">Input: Tokens from routing decisions</text>
<text text-anchor="middle" x="8050" y="-4025.5" font-family="Times,serif" font-size="14.00">Output: Tokens delivered to destination GPUs</text>
</g>
<!-- route_layer10_gpu0&#45;&gt;comm_layer10 -->
<g id="edge1009" class="edge">
<title>route_layer10_gpu0&#45;&gt;comm_layer10</title>
<path fill="none" stroke="black" d="M1468.53,-4146C1584.41,-4135.32 1726.42,-4123.76 1854,-4117.67 3039.66,-4061.09 6785.42,-4048.2 7796.43,-4045.72"/>
<polygon fill="black" stroke="black" points="7796.75,-4049.22 7806.74,-4045.7 7796.73,-4042.22 7796.75,-4049.22"/>
</g>
<!-- mha_layer11_gpu0 -->
<g id="node893" class="node">
<title>mha_layer11_gpu0</title>
<path fill="lightblue" stroke="black" d="M1316,-3724.72C1316,-3724.72 868,-3724.72 868,-3724.72 862,-3724.72 856,-3718.72 856,-3712.72 856,-3712.72 856,-3683.72 856,-3683.72 856,-3677.72 862,-3671.72 868,-3671.72 868,-3671.72 1316,-3671.72 1316,-3671.72 1322,-3671.72 1328,-3677.72 1328,-3683.72 1328,-3683.72 1328,-3712.72 1328,-3712.72 1328,-3718.72 1322,-3724.72 1316,-3724.72"/>
<text text-anchor="middle" x="1092" y="-3709.52" font-family="Times,serif" font-size="14.00">MHA Layer 11 GPU 0</text>
<text text-anchor="middle" x="1092" y="-3694.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1092" y="-3679.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer10_gpu0&#45;&gt;mha_layer11_gpu0 -->
<g id="edge1057" class="edge">
<title>aggregate_layer10_gpu0&#45;&gt;mha_layer11_gpu0</title>
<path fill="none" stroke="black" d="M1122.84,-3760.62C1118.29,-3751.56 1113.65,-3742.34 1109.41,-3733.89"/>
<polygon fill="black" stroke="black" points="1112.43,-3732.1 1104.81,-3724.73 1106.17,-3735.24 1112.43,-3732.1"/>
</g>
<!-- route_layer10_gpu1&#45;&gt;comm_layer10 -->
<g id="edge1010" class="edge">
<title>route_layer10_gpu1&#45;&gt;comm_layer10</title>
<path fill="none" stroke="black" d="M2425.65,-4140.67C2505.9,-4131.63 2596.83,-4122.71 2680,-4117.67 3694.19,-4056.26 6873.77,-4046.88 7796.57,-4045.45"/>
<polygon fill="black" stroke="black" points="7796.66,-4048.95 7806.65,-4045.44 7796.65,-4041.95 7796.66,-4048.95"/>
</g>
<!-- mha_layer11_gpu1 -->
<g id="node894" class="node">
<title>mha_layer11_gpu1</title>
<path fill="lightblue" stroke="black" d="M2280,-3724.72C2280,-3724.72 1832,-3724.72 1832,-3724.72 1826,-3724.72 1820,-3718.72 1820,-3712.72 1820,-3712.72 1820,-3683.72 1820,-3683.72 1820,-3677.72 1826,-3671.72 1832,-3671.72 1832,-3671.72 2280,-3671.72 2280,-3671.72 2286,-3671.72 2292,-3677.72 2292,-3683.72 2292,-3683.72 2292,-3712.72 2292,-3712.72 2292,-3718.72 2286,-3724.72 2280,-3724.72"/>
<text text-anchor="middle" x="2056" y="-3709.52" font-family="Times,serif" font-size="14.00">MHA Layer 11 GPU 1</text>
<text text-anchor="middle" x="2056" y="-3694.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2056" y="-3679.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer10_gpu1&#45;&gt;mha_layer11_gpu1 -->
<g id="edge1058" class="edge">
<title>aggregate_layer10_gpu1&#45;&gt;mha_layer11_gpu1</title>
<path fill="none" stroke="black" d="M2433.03,-3760.7C2360.38,-3748.86 2286.03,-3736.73 2222.76,-3726.41"/>
<polygon fill="black" stroke="black" points="2223.14,-3722.93 2212.71,-3724.77 2222.01,-3729.84 2223.14,-3722.93"/>
</g>
<!-- route_layer10_gpu2&#45;&gt;comm_layer10 -->
<g id="edge1011" class="edge">
<title>route_layer10_gpu2&#45;&gt;comm_layer10</title>
<path fill="none" stroke="black" d="M3263.65,-4150.06C3412.69,-4138.65 3608.37,-4125.1 3782,-4117.67 5304.7,-4052.56 7135.34,-4045.29 7796.43,-4044.95"/>
<polygon fill="black" stroke="black" points="7796.56,-4048.45 7806.56,-4044.94 7796.56,-4041.45 7796.56,-4048.45"/>
</g>
<!-- mha_layer11_gpu2 -->
<g id="node895" class="node">
<title>mha_layer11_gpu2</title>
<path fill="lightblue" stroke="black" d="M3436,-3724.72C3436,-3724.72 2988,-3724.72 2988,-3724.72 2982,-3724.72 2976,-3718.72 2976,-3712.72 2976,-3712.72 2976,-3683.72 2976,-3683.72 2976,-3677.72 2982,-3671.72 2988,-3671.72 2988,-3671.72 3436,-3671.72 3436,-3671.72 3442,-3671.72 3448,-3677.72 3448,-3683.72 3448,-3683.72 3448,-3712.72 3448,-3712.72 3448,-3718.72 3442,-3724.72 3436,-3724.72"/>
<text text-anchor="middle" x="3212" y="-3709.52" font-family="Times,serif" font-size="14.00">MHA Layer 11 GPU 2</text>
<text text-anchor="middle" x="3212" y="-3694.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3212" y="-3679.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer10_gpu2&#45;&gt;mha_layer11_gpu2 -->
<g id="edge1059" class="edge">
<title>aggregate_layer10_gpu2&#45;&gt;mha_layer11_gpu2</title>
<path fill="none" stroke="black" d="M3576.03,-3760.7C3506.02,-3748.88 3434.39,-3736.78 3373.39,-3726.48"/>
<polygon fill="black" stroke="black" points="3373.75,-3722.99 3363.3,-3724.77 3372.58,-3729.89 3373.75,-3722.99"/>
</g>
<!-- route_layer10_gpu3&#45;&gt;comm_layer10 -->
<g id="edge1012" class="edge">
<title>route_layer10_gpu3&#45;&gt;comm_layer10</title>
<path fill="none" stroke="black" d="M4353.98,-4140.99C4434.15,-4131.99 4524.95,-4123.02 4608,-4117.67 5228.19,-4077.76 7112.05,-4054.87 7797.32,-4047.68"/>
<polygon fill="black" stroke="black" points="7797.61,-4051.18 7807.57,-4047.57 7797.54,-4044.18 7797.61,-4051.18"/>
</g>
<!-- mha_layer11_gpu3 -->
<g id="node896" class="node">
<title>mha_layer11_gpu3</title>
<path fill="lightblue" stroke="black" d="M4398,-3724.72C4398,-3724.72 3950,-3724.72 3950,-3724.72 3944,-3724.72 3938,-3718.72 3938,-3712.72 3938,-3712.72 3938,-3683.72 3938,-3683.72 3938,-3677.72 3944,-3671.72 3950,-3671.72 3950,-3671.72 4398,-3671.72 4398,-3671.72 4404,-3671.72 4410,-3677.72 4410,-3683.72 4410,-3683.72 4410,-3712.72 4410,-3712.72 4410,-3718.72 4404,-3724.72 4398,-3724.72"/>
<text text-anchor="middle" x="4174" y="-3709.52" font-family="Times,serif" font-size="14.00">MHA Layer 11 GPU 3</text>
<text text-anchor="middle" x="4174" y="-3694.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4174" y="-3679.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer10_gpu3&#45;&gt;mha_layer11_gpu3 -->
<g id="edge1060" class="edge">
<title>aggregate_layer10_gpu3&#45;&gt;mha_layer11_gpu3</title>
<path fill="none" stroke="black" d="M4502.27,-3760.7C4439.54,-3748.95 4375.35,-3736.93 4320.56,-3726.67"/>
<polygon fill="black" stroke="black" points="4320.92,-3723.18 4310.44,-3724.77 4319.63,-3730.06 4320.92,-3723.18"/>
</g>
<!-- route_layer10_gpu4&#45;&gt;comm_layer10 -->
<g id="edge1013" class="edge">
<title>route_layer10_gpu4&#45;&gt;comm_layer10</title>
<path fill="none" stroke="black" d="M5187.68,-4146.87C5303.37,-4136.45 5444.88,-4124.86 5572,-4117.67 6384.66,-4071.74 7348.99,-4054.12 7797.38,-4048.05"/>
<polygon fill="black" stroke="black" points="7797.6,-4051.55 7807.55,-4047.91 7797.51,-4044.55 7797.6,-4051.55"/>
</g>
<!-- mha_layer11_gpu4 -->
<g id="node897" class="node">
<title>mha_layer11_gpu4</title>
<path fill="lightblue" stroke="black" d="M5395,-3724.72C5395,-3724.72 4947,-3724.72 4947,-3724.72 4941,-3724.72 4935,-3718.72 4935,-3712.72 4935,-3712.72 4935,-3683.72 4935,-3683.72 4935,-3677.72 4941,-3671.72 4947,-3671.72 4947,-3671.72 5395,-3671.72 5395,-3671.72 5401,-3671.72 5407,-3677.72 5407,-3683.72 5407,-3683.72 5407,-3712.72 5407,-3712.72 5407,-3718.72 5401,-3724.72 5395,-3724.72"/>
<text text-anchor="middle" x="5171" y="-3709.52" font-family="Times,serif" font-size="14.00">MHA Layer 11 GPU 4</text>
<text text-anchor="middle" x="5171" y="-3694.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5171" y="-3679.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer10_gpu4&#45;&gt;mha_layer11_gpu4 -->
<g id="edge1061" class="edge">
<title>aggregate_layer10_gpu4&#45;&gt;mha_layer11_gpu4</title>
<path fill="none" stroke="black" d="M5381.18,-3760.7C5342.35,-3749.34 5302.64,-3737.73 5268.35,-3727.7"/>
<polygon fill="black" stroke="black" points="5268.94,-3724.22 5258.36,-3724.77 5266.97,-3730.94 5268.94,-3724.22"/>
</g>
<!-- route_layer10_gpu5&#45;&gt;comm_layer10 -->
<g id="edge1014" class="edge">
<title>route_layer10_gpu5&#45;&gt;comm_layer10</title>
<path fill="none" stroke="black" d="M6152.85,-4147.8C6268.35,-4137.65 6409.35,-4126.01 6536,-4117.67 6983.05,-4088.24 7505.11,-4065.9 7804.68,-4054.23"/>
<polygon fill="black" stroke="black" points="7804.95,-4057.73 7814.81,-4053.84 7804.68,-4050.73 7804.95,-4057.73"/>
</g>
<!-- mha_layer11_gpu5 -->
<g id="node898" class="node">
<title>mha_layer11_gpu5</title>
<path fill="lightblue" stroke="black" d="M6224,-3724.72C6224,-3724.72 5776,-3724.72 5776,-3724.72 5770,-3724.72 5764,-3718.72 5764,-3712.72 5764,-3712.72 5764,-3683.72 5764,-3683.72 5764,-3677.72 5770,-3671.72 5776,-3671.72 5776,-3671.72 6224,-3671.72 6224,-3671.72 6230,-3671.72 6236,-3677.72 6236,-3683.72 6236,-3683.72 6236,-3712.72 6236,-3712.72 6236,-3718.72 6230,-3724.72 6224,-3724.72"/>
<text text-anchor="middle" x="6000" y="-3709.52" font-family="Times,serif" font-size="14.00">MHA Layer 11 GPU 5</text>
<text text-anchor="middle" x="6000" y="-3694.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6000" y="-3679.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer10_gpu5&#45;&gt;mha_layer11_gpu5 -->
<g id="edge1062" class="edge">
<title>aggregate_layer10_gpu5&#45;&gt;mha_layer11_gpu5</title>
<path fill="none" stroke="black" d="M6150.93,-3760.62C6123.87,-3749.61 6096.23,-3738.37 6072.12,-3728.56"/>
<polygon fill="black" stroke="black" points="6073.3,-3725.26 6062.72,-3724.73 6070.66,-3731.74 6073.3,-3725.26"/>
</g>
<!-- route_layer10_gpu6&#45;&gt;comm_layer10 -->
<g id="edge1015" class="edge">
<title>route_layer10_gpu6&#45;&gt;comm_layer10</title>
<path fill="none" stroke="black" d="M7112.58,-4144.46C7191.73,-4135.91 7280.71,-4126.34 7362,-4117.67 7522.93,-4100.52 7705.07,-4081.34 7841.5,-4067.02"/>
<polygon fill="black" stroke="black" points="7842.07,-4070.48 7851.65,-4065.96 7841.34,-4063.52 7842.07,-4070.48"/>
</g>
<!-- mha_layer11_gpu6 -->
<g id="node899" class="node">
<title>mha_layer11_gpu6</title>
<path fill="lightblue" stroke="black" d="M7042,-3724.72C7042,-3724.72 6594,-3724.72 6594,-3724.72 6588,-3724.72 6582,-3718.72 6582,-3712.72 6582,-3712.72 6582,-3683.72 6582,-3683.72 6582,-3677.72 6588,-3671.72 6594,-3671.72 6594,-3671.72 7042,-3671.72 7042,-3671.72 7048,-3671.72 7054,-3677.72 7054,-3683.72 7054,-3683.72 7054,-3712.72 7054,-3712.72 7054,-3718.72 7048,-3724.72 7042,-3724.72"/>
<text text-anchor="middle" x="6818" y="-3709.52" font-family="Times,serif" font-size="14.00">MHA Layer 11 GPU 6</text>
<text text-anchor="middle" x="6818" y="-3694.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6818" y="-3679.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer10_gpu6&#45;&gt;mha_layer11_gpu6 -->
<g id="edge1063" class="edge">
<title>aggregate_layer10_gpu6&#45;&gt;mha_layer11_gpu6</title>
<path fill="none" stroke="black" d="M6899.69,-3760.62C6886.21,-3750.49 6872.46,-3740.16 6860.19,-3730.93"/>
<polygon fill="black" stroke="black" points="6862.04,-3727.94 6851.94,-3724.73 6857.83,-3733.54 6862.04,-3727.94"/>
</g>
<!-- route_layer10_gpu7&#45;&gt;comm_layer10 -->
<g id="edge1016" class="edge">
<title>route_layer10_gpu7&#45;&gt;comm_layer10</title>
<path fill="none" stroke="black" d="M7849.89,-4117.61C7882.54,-4105.79 7916.57,-4093.48 7947.12,-4082.42"/>
<polygon fill="black" stroke="black" points="7948.69,-4085.58 7956.91,-4078.88 7946.31,-4078.99 7948.69,-4085.58"/>
</g>
<!-- mha_layer11_gpu7 -->
<g id="node900" class="node">
<title>mha_layer11_gpu7</title>
<path fill="lightblue" stroke="black" d="M7841,-3724.72C7841,-3724.72 7393,-3724.72 7393,-3724.72 7387,-3724.72 7381,-3718.72 7381,-3712.72 7381,-3712.72 7381,-3683.72 7381,-3683.72 7381,-3677.72 7387,-3671.72 7393,-3671.72 7393,-3671.72 7841,-3671.72 7841,-3671.72 7847,-3671.72 7853,-3677.72 7853,-3683.72 7853,-3683.72 7853,-3712.72 7853,-3712.72 7853,-3718.72 7847,-3724.72 7841,-3724.72"/>
<text text-anchor="middle" x="7617" y="-3709.52" font-family="Times,serif" font-size="14.00">MHA Layer 11 GPU 7</text>
<text text-anchor="middle" x="7617" y="-3694.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7617" y="-3679.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer10_gpu7&#45;&gt;mha_layer11_gpu7 -->
<g id="edge1064" class="edge">
<title>aggregate_layer10_gpu7&#45;&gt;mha_layer11_gpu7</title>
<path fill="none" stroke="black" d="M7632.15,-3760.62C7629.98,-3751.85 7627.78,-3742.93 7625.76,-3734.71"/>
<polygon fill="black" stroke="black" points="7629.09,-3733.6 7623.29,-3724.73 7622.29,-3735.28 7629.09,-3733.6"/>
</g>
<!-- route_layer10_gpu8&#45;&gt;comm_layer10 -->
<g id="edge1017" class="edge">
<title>route_layer10_gpu8&#45;&gt;comm_layer10</title>
<path fill="none" stroke="black" d="M8330.38,-4117.61C8280.27,-4104.66 8227.83,-4091.12 8182.03,-4079.29"/>
<polygon fill="black" stroke="black" points="8182.62,-4075.83 8172.06,-4076.72 8180.87,-4082.61 8182.62,-4075.83"/>
</g>
<!-- mha_layer11_gpu8 -->
<g id="node901" class="node">
<title>mha_layer11_gpu8</title>
<path fill="lightblue" stroke="black" d="M8736,-3724.72C8736,-3724.72 8288,-3724.72 8288,-3724.72 8282,-3724.72 8276,-3718.72 8276,-3712.72 8276,-3712.72 8276,-3683.72 8276,-3683.72 8276,-3677.72 8282,-3671.72 8288,-3671.72 8288,-3671.72 8736,-3671.72 8736,-3671.72 8742,-3671.72 8748,-3677.72 8748,-3683.72 8748,-3683.72 8748,-3712.72 8748,-3712.72 8748,-3718.72 8742,-3724.72 8736,-3724.72"/>
<text text-anchor="middle" x="8512" y="-3709.52" font-family="Times,serif" font-size="14.00">MHA Layer 11 GPU 8</text>
<text text-anchor="middle" x="8512" y="-3694.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8512" y="-3679.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer10_gpu8&#45;&gt;mha_layer11_gpu8 -->
<g id="edge1065" class="edge">
<title>aggregate_layer10_gpu8&#45;&gt;mha_layer11_gpu8</title>
<path fill="none" stroke="black" d="M8482.25,-3760.62C8486.64,-3751.56 8491.11,-3742.34 8495.2,-3733.89"/>
<polygon fill="black" stroke="black" points="8498.43,-3735.26 8499.64,-3724.73 8492.13,-3732.21 8498.43,-3735.26"/>
</g>
<!-- route_layer10_gpu9&#45;&gt;comm_layer10 -->
<g id="edge1018" class="edge">
<title>route_layer10_gpu9&#45;&gt;comm_layer10</title>
<path fill="none" stroke="black" d="M9121.73,-4140.5C9041.78,-4132.96 8955.66,-4124.93 8876,-4117.67 8670.63,-4098.97 8436.46,-4078.51 8270.03,-4064.11"/>
<polygon fill="black" stroke="black" points="8269.93,-4060.59 8259.67,-4063.21 8269.33,-4067.56 8269.93,-4060.59"/>
</g>
<!-- mha_layer11_gpu9 -->
<g id="node902" class="node">
<title>mha_layer11_gpu9</title>
<path fill="lightblue" stroke="black" d="M9662,-3724.72C9662,-3724.72 9214,-3724.72 9214,-3724.72 9208,-3724.72 9202,-3718.72 9202,-3712.72 9202,-3712.72 9202,-3683.72 9202,-3683.72 9202,-3677.72 9208,-3671.72 9214,-3671.72 9214,-3671.72 9662,-3671.72 9662,-3671.72 9668,-3671.72 9674,-3677.72 9674,-3683.72 9674,-3683.72 9674,-3712.72 9674,-3712.72 9674,-3718.72 9668,-3724.72 9662,-3724.72"/>
<text text-anchor="middle" x="9438" y="-3709.52" font-family="Times,serif" font-size="14.00">MHA Layer 11 GPU 9</text>
<text text-anchor="middle" x="9438" y="-3694.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9438" y="-3679.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer10_gpu9&#45;&gt;mha_layer11_gpu9 -->
<g id="edge1066" class="edge">
<title>aggregate_layer10_gpu9&#45;&gt;mha_layer11_gpu9</title>
<path fill="none" stroke="black" d="M9387.69,-3760.62C9395.51,-3751.07 9403.48,-3741.35 9410.7,-3732.54"/>
<polygon fill="black" stroke="black" points="9413.46,-3734.69 9417.09,-3724.73 9408.05,-3730.25 9413.46,-3734.69"/>
</g>
<!-- route_layer10_gpu10&#45;&gt;comm_layer10 -->
<g id="edge1019" class="edge">
<title>route_layer10_gpu10&#45;&gt;comm_layer10</title>
<path fill="none" stroke="black" d="M10049.56,-4139.73C9959.85,-4131.69 9861.55,-4123.6 9771,-4117.67 9247.68,-4083.41 8633.71,-4062.08 8298.88,-4052.04"/>
<polygon fill="black" stroke="black" points="8298.67,-4048.53 8288.57,-4051.73 8298.46,-4055.53 8298.67,-4048.53"/>
</g>
<!-- mha_layer11_gpu10 -->
<g id="node903" class="node">
<title>mha_layer11_gpu10</title>
<path fill="lightblue" stroke="black" d="M10712,-3724.72C10712,-3724.72 10264,-3724.72 10264,-3724.72 10258,-3724.72 10252,-3718.72 10252,-3712.72 10252,-3712.72 10252,-3683.72 10252,-3683.72 10252,-3677.72 10258,-3671.72 10264,-3671.72 10264,-3671.72 10712,-3671.72 10712,-3671.72 10718,-3671.72 10724,-3677.72 10724,-3683.72 10724,-3683.72 10724,-3712.72 10724,-3712.72 10724,-3718.72 10718,-3724.72 10712,-3724.72"/>
<text text-anchor="middle" x="10488" y="-3709.52" font-family="Times,serif" font-size="14.00">MHA Layer 11 GPU 10</text>
<text text-anchor="middle" x="10488" y="-3694.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10488" y="-3679.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer10_gpu10&#45;&gt;mha_layer11_gpu10 -->
<g id="edge1067" class="edge">
<title>aggregate_layer10_gpu10&#45;&gt;mha_layer11_gpu10</title>
<path fill="none" stroke="black" d="M10347.35,-3760.62C10372.34,-3749.71 10397.87,-3738.57 10420.19,-3728.82"/>
<polygon fill="black" stroke="black" points="10421.79,-3731.94 10429.55,-3724.73 10418.99,-3725.53 10421.79,-3731.94"/>
</g>
<!-- route_layer10_gpu11&#45;&gt;comm_layer10 -->
<g id="edge1020" class="edge">
<title>route_layer10_gpu11&#45;&gt;comm_layer10</title>
<path fill="none" stroke="black" d="M10996.49,-4139.74C10901.54,-4131.41 10796.51,-4123.15 10700,-4117.67 9820.29,-4067.76 8774.29,-4051.97 8302.71,-4047.18"/>
<polygon fill="black" stroke="black" points="8302.75,-4043.68 8292.71,-4047.07 8302.68,-4050.68 8302.75,-4043.68"/>
</g>
<!-- mha_layer11_gpu11 -->
<g id="node904" class="node">
<title>mha_layer11_gpu11</title>
<path fill="lightblue" stroke="black" d="M11373,-3724.72C11373,-3724.72 10925,-3724.72 10925,-3724.72 10919,-3724.72 10913,-3718.72 10913,-3712.72 10913,-3712.72 10913,-3683.72 10913,-3683.72 10913,-3677.72 10919,-3671.72 10925,-3671.72 10925,-3671.72 11373,-3671.72 11373,-3671.72 11379,-3671.72 11385,-3677.72 11385,-3683.72 11385,-3683.72 11385,-3712.72 11385,-3712.72 11385,-3718.72 11379,-3724.72 11373,-3724.72"/>
<text text-anchor="middle" x="11149" y="-3709.52" font-family="Times,serif" font-size="14.00">MHA Layer 11 GPU 11</text>
<text text-anchor="middle" x="11149" y="-3694.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11149" y="-3679.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer10_gpu11&#45;&gt;mha_layer11_gpu11 -->
<g id="edge1068" class="edge">
<title>aggregate_layer10_gpu11&#45;&gt;mha_layer11_gpu11</title>
<path fill="none" stroke="black" d="M11068.39,-3760.62C11081.7,-3750.49 11095.26,-3740.16 11107.37,-3730.93"/>
<polygon fill="black" stroke="black" points="11109.67,-3733.58 11115.51,-3724.73 11105.43,-3728.01 11109.67,-3733.58"/>
</g>
<!-- route_layer10_gpu12&#45;&gt;comm_layer10 -->
<g id="edge1021" class="edge">
<title>route_layer10_gpu12&#45;&gt;comm_layer10</title>
<path fill="none" stroke="black" d="M11951.35,-4139.66C11854.12,-4131.2 11746.14,-4122.89 11647,-4117.67 10393.64,-4051.78 8891.73,-4044.68 8303.66,-4044.67"/>
<polygon fill="black" stroke="black" points="8303.36,-4041.17 8293.36,-4044.67 8303.36,-4048.17 8303.36,-4041.17"/>
</g>
<!-- mha_layer11_gpu12 -->
<g id="node905" class="node">
<title>mha_layer11_gpu12</title>
<path fill="lightblue" stroke="black" d="M11948,-3724.72C11948,-3724.72 11500,-3724.72 11500,-3724.72 11494,-3724.72 11488,-3718.72 11488,-3712.72 11488,-3712.72 11488,-3683.72 11488,-3683.72 11488,-3677.72 11494,-3671.72 11500,-3671.72 11500,-3671.72 11948,-3671.72 11948,-3671.72 11954,-3671.72 11960,-3677.72 11960,-3683.72 11960,-3683.72 11960,-3712.72 11960,-3712.72 11960,-3718.72 11954,-3724.72 11948,-3724.72"/>
<text text-anchor="middle" x="11724" y="-3709.52" font-family="Times,serif" font-size="14.00">MHA Layer 11 GPU 12</text>
<text text-anchor="middle" x="11724" y="-3694.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11724" y="-3679.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer10_gpu12&#45;&gt;mha_layer11_gpu12 -->
<g id="edge1069" class="edge">
<title>aggregate_layer10_gpu12&#45;&gt;mha_layer11_gpu12</title>
<path fill="none" stroke="black" d="M11720.21,-3760.62C11720.75,-3751.95 11721.29,-3743.13 11721.79,-3734.99"/>
<polygon fill="black" stroke="black" points="11725.3,-3734.93 11722.43,-3724.73 11718.32,-3734.5 11725.3,-3734.93"/>
</g>
<!-- route_layer10_gpu13&#45;&gt;comm_layer10 -->
<g id="edge1022" class="edge">
<title>route_layer10_gpu13&#45;&gt;comm_layer10</title>
<path fill="none" stroke="black" d="M12911.61,-4139.66C12812.87,-4131.1 12702.89,-4122.73 12602,-4117.67 11755.33,-4075.25 9131.43,-4053.03 8303.2,-4046.95"/>
<polygon fill="black" stroke="black" points="8302.96,-4043.45 8292.94,-4046.87 8302.91,-4050.45 8302.96,-4043.45"/>
</g>
<!-- mha_layer11_gpu13 -->
<g id="node906" class="node">
<title>mha_layer11_gpu13</title>
<path fill="lightblue" stroke="black" d="M13571,-3724.72C13571,-3724.72 13123,-3724.72 13123,-3724.72 13117,-3724.72 13111,-3718.72 13111,-3712.72 13111,-3712.72 13111,-3683.72 13111,-3683.72 13111,-3677.72 13117,-3671.72 13123,-3671.72 13123,-3671.72 13571,-3671.72 13571,-3671.72 13577,-3671.72 13583,-3677.72 13583,-3683.72 13583,-3683.72 13583,-3712.72 13583,-3712.72 13583,-3718.72 13577,-3724.72 13571,-3724.72"/>
<text text-anchor="middle" x="13347" y="-3709.52" font-family="Times,serif" font-size="14.00">MHA Layer 11 GPU 13</text>
<text text-anchor="middle" x="13347" y="-3694.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13347" y="-3679.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer10_gpu13&#45;&gt;mha_layer11_gpu13 -->
<g id="edge1070" class="edge">
<title>aggregate_layer10_gpu13&#45;&gt;mha_layer11_gpu13</title>
<path fill="none" stroke="black" d="M13057.38,-3766.72C13115.09,-3753.27 13176.39,-3738.98 13227.67,-3727.03"/>
<polygon fill="black" stroke="black" points="13228.51,-3730.43 13237.45,-3724.75 13226.92,-3723.61 13228.51,-3730.43"/>
</g>
<!-- route_layer10_gpu14&#45;&gt;comm_layer10 -->
<g id="edge1023" class="edge">
<title>route_layer10_gpu14&#45;&gt;comm_layer10</title>
<path fill="none" stroke="black" d="M13873.41,-4139.56C13774.15,-4130.97 13663.49,-4122.6 13562,-4117.67 12517.78,-4066.94 9241.27,-4050.01 8303.23,-4046.14"/>
<polygon fill="black" stroke="black" points="8302.99,-4042.64 8292.98,-4046.1 8302.96,-4049.64 8302.99,-4042.64"/>
</g>
<!-- mha_layer11_gpu14 -->
<g id="node907" class="node">
<title>mha_layer11_gpu14</title>
<path fill="lightblue" stroke="black" d="M14232,-3724.72C14232,-3724.72 13784,-3724.72 13784,-3724.72 13778,-3724.72 13772,-3718.72 13772,-3712.72 13772,-3712.72 13772,-3683.72 13772,-3683.72 13772,-3677.72 13778,-3671.72 13784,-3671.72 13784,-3671.72 14232,-3671.72 14232,-3671.72 14238,-3671.72 14244,-3677.72 14244,-3683.72 14244,-3683.72 14244,-3712.72 14244,-3712.72 14244,-3718.72 14238,-3724.72 14232,-3724.72"/>
<text text-anchor="middle" x="14008" y="-3709.52" font-family="Times,serif" font-size="14.00">MHA Layer 11 GPU 14</text>
<text text-anchor="middle" x="14008" y="-3694.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14008" y="-3679.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer10_gpu14&#45;&gt;mha_layer11_gpu14 -->
<g id="edge1071" class="edge">
<title>aggregate_layer10_gpu14&#45;&gt;mha_layer11_gpu14</title>
<path fill="none" stroke="black" d="M13874.92,-3760.62C13898.47,-3749.76 13922.51,-3738.66 13943.56,-3728.95"/>
<polygon fill="black" stroke="black" points="13945.09,-3732.1 13952.7,-3724.73 13942.16,-3725.74 13945.09,-3732.1"/>
</g>
<!-- route_layer10_gpu15&#45;&gt;comm_layer10 -->
<g id="edge1024" class="edge">
<title>route_layer10_gpu15&#45;&gt;comm_layer10</title>
<path fill="none" stroke="black" d="M14836.31,-4139.48C14736.79,-4130.86 14625.8,-4122.51 14524,-4117.67 13280.62,-4058.57 9342.7,-4047.48 8303.49,-4045.57"/>
<polygon fill="black" stroke="black" points="8303.28,-4042.07 8293.27,-4045.55 8303.27,-4049.07 8303.28,-4042.07"/>
</g>
<!-- mha_layer11_gpu15 -->
<g id="node908" class="node">
<title>mha_layer11_gpu15</title>
<path fill="lightblue" stroke="black" d="M14807,-3724.72C14807,-3724.72 14359,-3724.72 14359,-3724.72 14353,-3724.72 14347,-3718.72 14347,-3712.72 14347,-3712.72 14347,-3683.72 14347,-3683.72 14347,-3677.72 14353,-3671.72 14359,-3671.72 14359,-3671.72 14807,-3671.72 14807,-3671.72 14813,-3671.72 14819,-3677.72 14819,-3683.72 14819,-3683.72 14819,-3712.72 14819,-3712.72 14819,-3718.72 14813,-3724.72 14807,-3724.72"/>
<text text-anchor="middle" x="14583" y="-3709.52" font-family="Times,serif" font-size="14.00">MHA Layer 11 GPU 15</text>
<text text-anchor="middle" x="14583" y="-3694.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14583" y="-3679.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer10_gpu15&#45;&gt;mha_layer11_gpu15 -->
<g id="edge1072" class="edge">
<title>aggregate_layer10_gpu15&#45;&gt;mha_layer11_gpu15</title>
<path fill="none" stroke="black" d="M14561.9,-3760.62C14564.95,-3751.75 14568.05,-3742.74 14570.9,-3734.44"/>
<polygon fill="black" stroke="black" points="14574.29,-3735.33 14574.23,-3724.73 14567.67,-3733.05 14574.29,-3735.33"/>
</g>
<!-- comm_layer10&#45;&gt;expert_layer10_gpu0_expert0 -->
<g id="edge1025" class="edge">
<title>comm_layer10&#45;&gt;expert_layer10_gpu0_expert0</title>
<path fill="none" stroke="black" d="M7808.16,-4040.16C7080.79,-4030.94 4849.21,-4001.95 2999,-3970.72 2487.23,-3962.08 1888.84,-3950.01 1555.94,-3943.11"/>
<polygon fill="black" stroke="black" points="1555.75,-3939.61 1545.68,-3942.9 1555.61,-3946.61 1555.75,-3939.61"/>
</g>
<!-- comm_layer10&#45;&gt;expert_layer10_gpu1_expert1 -->
<g id="edge1026" class="edge">
<title>comm_layer10&#45;&gt;expert_layer10_gpu1_expert1</title>
<path fill="none" stroke="black" d="M7806.71,-4042.53C7158.45,-4040.01 5335.63,-4027.94 3820,-3970.72 3719.24,-3966.92 3608.48,-3960.86 3511.92,-3954.97"/>
<polygon fill="black" stroke="black" points="3511.91,-3951.46 3501.72,-3954.34 3511.49,-3958.45 3511.91,-3951.46"/>
</g>
<!-- comm_layer10&#45;&gt;expert_layer10_gpu2_expert2 -->
<g id="edge1027" class="edge">
<title>comm_layer10&#45;&gt;expert_layer10_gpu2_expert2</title>
<path fill="none" stroke="black" d="M7807.5,-4040.95C7250.8,-4035.15 5838.28,-4016.78 4658,-3970.72 4551.45,-3966.56 4434.01,-3960.24 4332.7,-3954.23"/>
<polygon fill="black" stroke="black" points="4332.83,-3950.73 4322.64,-3953.63 4332.41,-3957.72 4332.83,-3950.73"/>
</g>
<!-- comm_layer10&#45;&gt;expert_layer10_gpu3_expert3 -->
<g id="edge1028" class="edge">
<title>comm_layer10&#45;&gt;expert_layer10_gpu3_expert3</title>
<path fill="none" stroke="black" d="M7808.58,-4039.15C7349.46,-4030.86 6318.89,-4009.39 5452,-3970.72 5360.3,-3966.63 5259.88,-3960.83 5170.89,-3955.23"/>
<polygon fill="black" stroke="black" points="5170.85,-3951.72 5160.65,-3954.58 5170.41,-3958.71 5170.85,-3951.72"/>
</g>
<!-- comm_layer10&#45;&gt;expert_layer10_gpu4_expert4 -->
<g id="edge1029" class="edge">
<title>comm_layer10&#45;&gt;expert_layer10_gpu4_expert4</title>
<path fill="none" stroke="black" d="M7812.35,-4036.09C7459.36,-4025.03 6775.71,-4001.73 6195,-3970.72 6120.34,-3966.73 6039.3,-3961.57 5965.15,-3956.53"/>
<polygon fill="black" stroke="black" points="5964.94,-3953 5954.73,-3955.81 5964.47,-3959.99 5964.94,-3953"/>
</g>
<!-- comm_layer10&#45;&gt;expert_layer10_gpu5_expert5 -->
<g id="edge1030" class="edge">
<title>comm_layer10&#45;&gt;expert_layer10_gpu5_expert5</title>
<path fill="none" stroke="black" d="M7818.8,-4032.48C7566.87,-4020.18 7152.01,-3998.14 6795,-3970.72 6766.65,-3968.54 6737.01,-3966.04 6707.52,-3963.41"/>
<polygon fill="black" stroke="black" points="6707.8,-3959.92 6697.53,-3962.51 6707.18,-3966.89 6707.8,-3959.92"/>
</g>
<!-- comm_layer10&#45;&gt;expert_layer10_gpu6_expert6 -->
<g id="edge1031" class="edge">
<title>comm_layer10&#45;&gt;expert_layer10_gpu6_expert6</title>
<path fill="none" stroke="black" d="M7852.33,-4022.33C7696.34,-4005.86 7477.5,-3982.75 7307.93,-3964.85"/>
<polygon fill="black" stroke="black" points="7308.17,-3961.35 7297.86,-3963.78 7307.43,-3968.31 7308.17,-3961.35"/>
</g>
<!-- comm_layer10&#45;&gt;expert_layer10_gpu7_expert7 -->
<g id="edge1032" class="edge">
<title>comm_layer10&#45;&gt;expert_layer10_gpu7_expert7</title>
<path fill="none" stroke="black" d="M7946.49,-4010.11C7910.49,-3998.6 7869.92,-3985.64 7833.18,-3973.89"/>
<polygon fill="black" stroke="black" points="7834.02,-3970.49 7823.42,-3970.78 7831.88,-3977.16 7834.02,-3970.49"/>
</g>
<!-- comm_layer10&#45;&gt;expert_layer10_gpu8_expert8 -->
<g id="edge1033" class="edge">
<title>comm_layer10&#45;&gt;expert_layer10_gpu8_expert8</title>
<path fill="none" stroke="black" d="M8153.37,-4010.26C8189.59,-3998.72 8230.45,-3985.69 8267.45,-3973.9"/>
<polygon fill="black" stroke="black" points="8268.81,-3977.14 8277.28,-3970.77 8266.69,-3970.47 8268.81,-3977.14"/>
</g>
<!-- comm_layer10&#45;&gt;expert_layer10_gpu9_expert9 -->
<g id="edge1034" class="edge">
<title>comm_layer10&#45;&gt;expert_layer10_gpu9_expert9</title>
<path fill="none" stroke="black" d="M8254.15,-4023.73C8435.9,-4006.39 8702.62,-3980.96 8898.87,-3962.24"/>
<polygon fill="black" stroke="black" points="8899.42,-3965.71 8909.04,-3961.27 8898.76,-3958.74 8899.42,-3965.71"/>
</g>
<!-- comm_layer10&#45;&gt;expert_layer10_gpu10_expert10 -->
<g id="edge1035" class="edge">
<title>comm_layer10&#45;&gt;expert_layer10_gpu10_expert10</title>
<path fill="none" stroke="black" d="M8278.48,-4031.32C8548.89,-4017.21 9012.76,-3992.77 9411,-3970.72 9514.7,-3964.98 9628.93,-3958.45 9728,-3952.73"/>
<polygon fill="black" stroke="black" points="9728.37,-3956.21 9738.15,-3952.14 9727.96,-3949.22 9728.37,-3956.21"/>
</g>
<!-- comm_layer10&#45;&gt;expert_layer10_gpu11_expert11 -->
<g id="edge1036" class="edge">
<title>comm_layer10&#45;&gt;expert_layer10_gpu11_expert11</title>
<path fill="none" stroke="black" d="M8289.49,-4037.42C8692.33,-4027.22 9531.06,-4003.91 10240,-3970.72 10334,-3966.32 10437.06,-3960.37 10528.01,-3954.73"/>
<polygon fill="black" stroke="black" points="10528.43,-3958.21 10538.19,-3954.1 10527.99,-3951.23 10528.43,-3958.21"/>
</g>
<!-- comm_layer10&#45;&gt;expert_layer10_gpu12_expert12 -->
<g id="edge1037" class="edge">
<title>comm_layer10&#45;&gt;expert_layer10_gpu12_expert12</title>
<path fill="none" stroke="black" d="M8292.35,-4040.7C8801.45,-4034.71 10019.4,-4016.48 11040,-3970.72 11120.44,-3967.11 11208.01,-3961.85 11287.26,-3956.58"/>
<polygon fill="black" stroke="black" points="11287.63,-3960.06 11297.38,-3955.9 11287.17,-3953.08 11287.63,-3960.06"/>
</g>
<!-- comm_layer10&#45;&gt;expert_layer10_gpu13_expert13 -->
<g id="edge1038" class="edge">
<title>comm_layer10&#45;&gt;expert_layer10_gpu13_expert13</title>
<path fill="none" stroke="black" d="M8292.39,-4040.86C8888.9,-4034.61 10475.79,-4014.87 11799,-3970.72 11944.38,-3965.87 12106.73,-3958.29 12238.05,-3951.63"/>
<polygon fill="black" stroke="black" points="12238.44,-3955.11 12248.25,-3951.11 12238.08,-3948.12 12238.44,-3955.11"/>
</g>
<!-- comm_layer10&#45;&gt;expert_layer10_gpu14_expert14 -->
<g id="edge1039" class="edge">
<title>comm_layer10&#45;&gt;expert_layer10_gpu14_expert14</title>
<path fill="none" stroke="black" d="M8293.15,-4042.34C8988.35,-4039.26 11044.03,-4025.81 12750,-3970.72 12886.77,-3966.3 13039.11,-3959 13164.02,-3952.39"/>
<polygon fill="black" stroke="black" points="13164.31,-3955.88 13174.11,-3951.86 13163.94,-3948.89 13164.31,-3955.88"/>
</g>
<!-- comm_layer10&#45;&gt;expert_layer10_gpu15_expert15 -->
<g id="edge1040" class="edge">
<title>comm_layer10&#45;&gt;expert_layer10_gpu15_expert15</title>
<path fill="none" stroke="black" d="M8293.41,-4043.72C9075.32,-4044.63 11593.53,-4041.47 13676,-3970.72 13788.31,-3966.9 13912.35,-3960.44 14018.29,-3954.24"/>
<polygon fill="black" stroke="black" points="14018.7,-3957.73 14028.48,-3953.65 14018.29,-3950.74 14018.7,-3957.73"/>
</g>
<!-- gate_layer11_gpu0 -->
<g id="node909" class="node">
<title>gate_layer11_gpu0</title>
<path fill="lightsteelblue" stroke="black" d="M843.07,-3634.38C843.07,-3634.38 393.93,-3584.06 393.93,-3584.06 387.96,-3583.39 387.96,-3582.05 393.93,-3581.38 393.93,-3581.38 843.07,-3531.06 843.07,-3531.06 849.04,-3530.39 860.96,-3530.39 866.93,-3531.06 866.93,-3531.06 1316.07,-3581.38 1316.07,-3581.38 1322.04,-3582.05 1322.04,-3583.39 1316.07,-3584.06 1316.07,-3584.06 866.93,-3634.38 866.93,-3634.38 860.96,-3635.05 849.04,-3635.05 843.07,-3634.38"/>
<text text-anchor="middle" x="855" y="-3594.02" font-family="Times,serif" font-size="14.00">Gate Layer 11 GPU 0</text>
<text text-anchor="middle" x="855" y="-3579.02" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="855" y="-3564.02" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer11_gpu0&#45;&gt;gate_layer11_gpu0 -->
<g id="edge1073" class="edge">
<title>mha_layer11_gpu0&#45;&gt;gate_layer11_gpu0</title>
<path fill="none" stroke="black" d="M1038.52,-3671.61C1013.03,-3659.4 981.73,-3644.41 952.25,-3630.29"/>
<polygon fill="black" stroke="black" points="953.69,-3627.1 943.16,-3625.94 950.67,-3633.42 953.69,-3627.1"/>
</g>
<!-- gate_layer11_gpu1 -->
<g id="node910" class="node">
<title>gate_layer11_gpu1</title>
<path fill="lightsteelblue" stroke="black" d="M1807.07,-3634.38C1807.07,-3634.38 1357.93,-3584.06 1357.93,-3584.06 1351.96,-3583.39 1351.96,-3582.05 1357.93,-3581.38 1357.93,-3581.38 1807.07,-3531.06 1807.07,-3531.06 1813.04,-3530.39 1824.96,-3530.39 1830.93,-3531.06 1830.93,-3531.06 2280.07,-3581.38 2280.07,-3581.38 2286.04,-3582.05 2286.04,-3583.39 2280.07,-3584.06 2280.07,-3584.06 1830.93,-3634.38 1830.93,-3634.38 1824.96,-3635.05 1813.04,-3635.05 1807.07,-3634.38"/>
<text text-anchor="middle" x="1819" y="-3594.02" font-family="Times,serif" font-size="14.00">Gate Layer 11 GPU 1</text>
<text text-anchor="middle" x="1819" y="-3579.02" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="1819" y="-3564.02" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer11_gpu1&#45;&gt;gate_layer11_gpu1 -->
<g id="edge1074" class="edge">
<title>mha_layer11_gpu1&#45;&gt;gate_layer11_gpu1</title>
<path fill="none" stroke="black" d="M2002.52,-3671.61C1977.03,-3659.4 1945.73,-3644.41 1916.25,-3630.29"/>
<polygon fill="black" stroke="black" points="1917.69,-3627.1 1907.16,-3625.94 1914.67,-3633.42 1917.69,-3627.1"/>
</g>
<!-- gate_layer11_gpu2 -->
<g id="node911" class="node">
<title>gate_layer11_gpu2</title>
<path fill="lightsteelblue" stroke="black" d="M2771.07,-3634.38C2771.07,-3634.38 2321.93,-3584.06 2321.93,-3584.06 2315.96,-3583.39 2315.96,-3582.05 2321.93,-3581.38 2321.93,-3581.38 2771.07,-3531.06 2771.07,-3531.06 2777.04,-3530.39 2788.96,-3530.39 2794.93,-3531.06 2794.93,-3531.06 3244.07,-3581.38 3244.07,-3581.38 3250.04,-3582.05 3250.04,-3583.39 3244.07,-3584.06 3244.07,-3584.06 2794.93,-3634.38 2794.93,-3634.38 2788.96,-3635.05 2777.04,-3635.05 2771.07,-3634.38"/>
<text text-anchor="middle" x="2783" y="-3594.02" font-family="Times,serif" font-size="14.00">Gate Layer 11 GPU 2</text>
<text text-anchor="middle" x="2783" y="-3579.02" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="2783" y="-3564.02" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer11_gpu2&#45;&gt;gate_layer11_gpu2 -->
<g id="edge1075" class="edge">
<title>mha_layer11_gpu2&#45;&gt;gate_layer11_gpu2</title>
<path fill="none" stroke="black" d="M3115.46,-3671.68C3061.04,-3657.28 2991.94,-3639 2930.84,-3622.83"/>
<polygon fill="black" stroke="black" points="2931.67,-3619.43 2921.1,-3620.26 2929.88,-3626.2 2931.67,-3619.43"/>
</g>
<!-- gate_layer11_gpu3 -->
<g id="node912" class="node">
<title>gate_layer11_gpu3</title>
<path fill="lightsteelblue" stroke="black" d="M3735.07,-3634.38C3735.07,-3634.38 3285.93,-3584.06 3285.93,-3584.06 3279.96,-3583.39 3279.96,-3582.05 3285.93,-3581.38 3285.93,-3581.38 3735.07,-3531.06 3735.07,-3531.06 3741.04,-3530.39 3752.96,-3530.39 3758.93,-3531.06 3758.93,-3531.06 4208.07,-3581.38 4208.07,-3581.38 4214.04,-3582.05 4214.04,-3583.39 4208.07,-3584.06 4208.07,-3584.06 3758.93,-3634.38 3758.93,-3634.38 3752.96,-3635.05 3741.04,-3635.05 3735.07,-3634.38"/>
<text text-anchor="middle" x="3747" y="-3594.02" font-family="Times,serif" font-size="14.00">Gate Layer 11 GPU 3</text>
<text text-anchor="middle" x="3747" y="-3579.02" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="3747" y="-3564.02" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer11_gpu3&#45;&gt;gate_layer11_gpu3 -->
<g id="edge1076" class="edge">
<title>mha_layer11_gpu3&#45;&gt;gate_layer11_gpu3</title>
<path fill="none" stroke="black" d="M4077.91,-3671.68C4023.86,-3657.31 3955.26,-3639.08 3894.54,-3622.94"/>
<polygon fill="black" stroke="black" points="3895.43,-3619.55 3884.87,-3620.37 3893.63,-3626.32 3895.43,-3619.55"/>
</g>
<!-- gate_layer11_gpu4 -->
<g id="node913" class="node">
<title>gate_layer11_gpu4</title>
<path fill="lightsteelblue" stroke="black" d="M4699.07,-3634.38C4699.07,-3634.38 4249.93,-3584.06 4249.93,-3584.06 4243.96,-3583.39 4243.96,-3582.05 4249.93,-3581.38 4249.93,-3581.38 4699.07,-3531.06 4699.07,-3531.06 4705.04,-3530.39 4716.96,-3530.39 4722.93,-3531.06 4722.93,-3531.06 5172.07,-3581.38 5172.07,-3581.38 5178.04,-3582.05 5178.04,-3583.39 5172.07,-3584.06 5172.07,-3584.06 4722.93,-3634.38 4722.93,-3634.38 4716.96,-3635.05 4705.04,-3635.05 4699.07,-3634.38"/>
<text text-anchor="middle" x="4711" y="-3594.02" font-family="Times,serif" font-size="14.00">Gate Layer 11 GPU 4</text>
<text text-anchor="middle" x="4711" y="-3579.02" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4711" y="-3564.02" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer11_gpu4&#45;&gt;gate_layer11_gpu4 -->
<g id="edge1077" class="edge">
<title>mha_layer11_gpu4&#45;&gt;gate_layer11_gpu4</title>
<path fill="none" stroke="black" d="M5067.48,-3671.68C5008.01,-3657 4932.17,-3638.29 4865.74,-3621.9"/>
<polygon fill="black" stroke="black" points="4866.56,-3618.5 4856.02,-3619.5 4864.89,-3625.29 4866.56,-3618.5"/>
</g>
<!-- gate_layer11_gpu5 -->
<g id="node914" class="node">
<title>gate_layer11_gpu5</title>
<path fill="lightsteelblue" stroke="black" d="M5663.07,-3634.38C5663.07,-3634.38 5213.93,-3584.06 5213.93,-3584.06 5207.96,-3583.39 5207.96,-3582.05 5213.93,-3581.38 5213.93,-3581.38 5663.07,-3531.06 5663.07,-3531.06 5669.04,-3530.39 5680.96,-3530.39 5686.93,-3531.06 5686.93,-3531.06 6136.07,-3581.38 6136.07,-3581.38 6142.04,-3582.05 6142.04,-3583.39 6136.07,-3584.06 6136.07,-3584.06 5686.93,-3634.38 5686.93,-3634.38 5680.96,-3635.05 5669.04,-3635.05 5663.07,-3634.38"/>
<text text-anchor="middle" x="5675" y="-3594.02" font-family="Times,serif" font-size="14.00">Gate Layer 11 GPU 5</text>
<text text-anchor="middle" x="5675" y="-3579.02" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5675" y="-3564.02" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer11_gpu5&#45;&gt;gate_layer11_gpu5 -->
<g id="edge1078" class="edge">
<title>mha_layer11_gpu5&#45;&gt;gate_layer11_gpu5</title>
<path fill="none" stroke="black" d="M5926.66,-3671.61C5888.55,-3658.3 5840.96,-3641.68 5797.46,-3626.49"/>
<polygon fill="black" stroke="black" points="5798.55,-3623.16 5787.95,-3623.17 5796.24,-3629.77 5798.55,-3623.16"/>
</g>
<!-- gate_layer11_gpu6 -->
<g id="node915" class="node">
<title>gate_layer11_gpu6</title>
<path fill="lightsteelblue" stroke="black" d="M6627.07,-3634.38C6627.07,-3634.38 6177.93,-3584.06 6177.93,-3584.06 6171.96,-3583.39 6171.96,-3582.05 6177.93,-3581.38 6177.93,-3581.38 6627.07,-3531.06 6627.07,-3531.06 6633.04,-3530.39 6644.96,-3530.39 6650.93,-3531.06 6650.93,-3531.06 7100.07,-3581.38 7100.07,-3581.38 7106.04,-3582.05 7106.04,-3583.39 7100.07,-3584.06 7100.07,-3584.06 6650.93,-3634.38 6650.93,-3634.38 6644.96,-3635.05 6633.04,-3635.05 6627.07,-3634.38"/>
<text text-anchor="middle" x="6639" y="-3594.02" font-family="Times,serif" font-size="14.00">Gate Layer 11 GPU 6</text>
<text text-anchor="middle" x="6639" y="-3579.02" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6639" y="-3564.02" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer11_gpu6&#45;&gt;gate_layer11_gpu6 -->
<g id="edge1079" class="edge">
<title>mha_layer11_gpu6&#45;&gt;gate_layer11_gpu6</title>
<path fill="none" stroke="black" d="M6777.38,-3671.47C6759.61,-3660.2 6738.14,-3646.58 6717.46,-3633.47"/>
<polygon fill="black" stroke="black" points="6719.29,-3630.48 6708.97,-3628.08 6715.54,-3636.4 6719.29,-3630.48"/>
</g>
<!-- gate_layer11_gpu7 -->
<g id="node916" class="node">
<title>gate_layer11_gpu7</title>
<path fill="lightsteelblue" stroke="black" d="M7591.07,-3634.38C7591.07,-3634.38 7141.93,-3584.06 7141.93,-3584.06 7135.96,-3583.39 7135.96,-3582.05 7141.93,-3581.38 7141.93,-3581.38 7591.07,-3531.06 7591.07,-3531.06 7597.04,-3530.39 7608.96,-3530.39 7614.93,-3531.06 7614.93,-3531.06 8064.07,-3581.38 8064.07,-3581.38 8070.04,-3582.05 8070.04,-3583.39 8064.07,-3584.06 8064.07,-3584.06 7614.93,-3634.38 7614.93,-3634.38 7608.96,-3635.05 7597.04,-3635.05 7591.07,-3634.38"/>
<text text-anchor="middle" x="7603" y="-3594.02" font-family="Times,serif" font-size="14.00">Gate Layer 11 GPU 7</text>
<text text-anchor="middle" x="7603" y="-3579.02" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="7603" y="-3564.02" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer11_gpu7&#45;&gt;gate_layer11_gpu7 -->
<g id="edge1080" class="edge">
<title>mha_layer11_gpu7&#45;&gt;gate_layer11_gpu7</title>
<path fill="none" stroke="black" d="M7613.82,-3671.47C7612.85,-3663.59 7611.74,-3654.56 7610.6,-3645.36"/>
<polygon fill="black" stroke="black" points="7614.07,-3644.85 7609.37,-3635.36 7607.12,-3645.71 7614.07,-3644.85"/>
</g>
<!-- gate_layer11_gpu8 -->
<g id="node917" class="node">
<title>gate_layer11_gpu8</title>
<path fill="lightsteelblue" stroke="black" d="M8555.07,-3634.38C8555.07,-3634.38 8105.93,-3584.06 8105.93,-3584.06 8099.96,-3583.39 8099.96,-3582.05 8105.93,-3581.38 8105.93,-3581.38 8555.07,-3531.06 8555.07,-3531.06 8561.04,-3530.39 8572.96,-3530.39 8578.93,-3531.06 8578.93,-3531.06 9028.07,-3581.38 9028.07,-3581.38 9034.04,-3582.05 9034.04,-3583.39 9028.07,-3584.06 9028.07,-3584.06 8578.93,-3634.38 8578.93,-3634.38 8572.96,-3635.05 8561.04,-3635.05 8555.07,-3634.38"/>
<text text-anchor="middle" x="8567" y="-3594.02" font-family="Times,serif" font-size="14.00">Gate Layer 11 GPU 8</text>
<text text-anchor="middle" x="8567" y="-3579.02" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="8567" y="-3564.02" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer11_gpu8&#45;&gt;gate_layer11_gpu8 -->
<g id="edge1081" class="edge">
<title>mha_layer11_gpu8&#45;&gt;gate_layer11_gpu8</title>
<path fill="none" stroke="black" d="M8524.48,-3671.47C8528.75,-3662.66 8533.71,-3652.43 8538.7,-3642.12"/>
<polygon fill="black" stroke="black" points="8541.87,-3643.6 8543.08,-3633.07 8535.57,-3640.54 8541.87,-3643.6"/>
</g>
<!-- gate_layer11_gpu9 -->
<g id="node918" class="node">
<title>gate_layer11_gpu9</title>
<path fill="lightsteelblue" stroke="black" d="M9519.07,-3634.38C9519.07,-3634.38 9069.93,-3584.06 9069.93,-3584.06 9063.96,-3583.39 9063.96,-3582.05 9069.93,-3581.38 9069.93,-3581.38 9519.07,-3531.06 9519.07,-3531.06 9525.04,-3530.39 9536.96,-3530.39 9542.93,-3531.06 9542.93,-3531.06 9992.07,-3581.38 9992.07,-3581.38 9998.04,-3582.05 9998.04,-3583.39 9992.07,-3584.06 9992.07,-3584.06 9542.93,-3634.38 9542.93,-3634.38 9536.96,-3635.05 9525.04,-3635.05 9519.07,-3634.38"/>
<text text-anchor="middle" x="9531" y="-3594.02" font-family="Times,serif" font-size="14.00">Gate Layer 11 GPU 9</text>
<text text-anchor="middle" x="9531" y="-3579.02" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="9531" y="-3564.02" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer11_gpu9&#45;&gt;gate_layer11_gpu9 -->
<g id="edge1082" class="edge">
<title>mha_layer11_gpu9&#45;&gt;gate_layer11_gpu9</title>
<path fill="none" stroke="black" d="M9459.1,-3671.47C9466.87,-3661.99 9475.99,-3650.86 9485.08,-3639.76"/>
<polygon fill="black" stroke="black" points="9488.05,-3641.66 9491.68,-3631.71 9482.64,-3637.22 9488.05,-3641.66"/>
</g>
<!-- gate_layer11_gpu10 -->
<g id="node919" class="node">
<title>gate_layer11_gpu10</title>
<path fill="lightsteelblue" stroke="black" d="M10483.07,-3634.38C10483.07,-3634.38 10033.93,-3584.06 10033.93,-3584.06 10027.96,-3583.39 10027.96,-3582.05 10033.93,-3581.38 10033.93,-3581.38 10483.07,-3531.06 10483.07,-3531.06 10489.04,-3530.39 10500.96,-3530.39 10506.93,-3531.06 10506.93,-3531.06 10956.07,-3581.38 10956.07,-3581.38 10962.04,-3582.05 10962.04,-3583.39 10956.07,-3584.06 10956.07,-3584.06 10506.93,-3634.38 10506.93,-3634.38 10500.96,-3635.05 10489.04,-3635.05 10483.07,-3634.38"/>
<text text-anchor="middle" x="10495" y="-3594.02" font-family="Times,serif" font-size="14.00">Gate Layer 11 GPU 10</text>
<text text-anchor="middle" x="10495" y="-3579.02" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="10495" y="-3564.02" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer11_gpu10&#45;&gt;gate_layer11_gpu10 -->
<g id="edge1083" class="edge">
<title>mha_layer11_gpu10&#45;&gt;gate_layer11_gpu10</title>
<path fill="none" stroke="black" d="M10489.59,-3671.47C10490.06,-3663.77 10490.61,-3654.97 10491.16,-3645.99"/>
<polygon fill="black" stroke="black" points="10494.66,-3646.01 10491.79,-3635.82 10487.68,-3645.58 10494.66,-3646.01"/>
</g>
<!-- gate_layer11_gpu11 -->
<g id="node920" class="node">
<title>gate_layer11_gpu11</title>
<path fill="lightsteelblue" stroke="black" d="M11447.07,-3634.38C11447.07,-3634.38 10997.93,-3584.06 10997.93,-3584.06 10991.96,-3583.39 10991.96,-3582.05 10997.93,-3581.38 10997.93,-3581.38 11447.07,-3531.06 11447.07,-3531.06 11453.04,-3530.39 11464.96,-3530.39 11470.93,-3531.06 11470.93,-3531.06 11920.07,-3581.38 11920.07,-3581.38 11926.04,-3582.05 11926.04,-3583.39 11920.07,-3584.06 11920.07,-3584.06 11470.93,-3634.38 11470.93,-3634.38 11464.96,-3635.05 11453.04,-3635.05 11447.07,-3634.38"/>
<text text-anchor="middle" x="11459" y="-3594.02" font-family="Times,serif" font-size="14.00">Gate Layer 11 GPU 11</text>
<text text-anchor="middle" x="11459" y="-3579.02" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11459" y="-3564.02" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer11_gpu11&#45;&gt;gate_layer11_gpu11 -->
<g id="edge1084" class="edge">
<title>mha_layer11_gpu11&#45;&gt;gate_layer11_gpu11</title>
<path fill="none" stroke="black" d="M11218.96,-3671.61C11254.82,-3658.47 11299.49,-3642.12 11340.54,-3627.09"/>
<polygon fill="black" stroke="black" points="11341.87,-3630.33 11350.06,-3623.61 11339.46,-3623.76 11341.87,-3630.33"/>
</g>
<!-- gate_layer11_gpu12 -->
<g id="node921" class="node">
<title>gate_layer11_gpu12</title>
<path fill="lightsteelblue" stroke="black" d="M12411.07,-3634.38C12411.07,-3634.38 11961.93,-3584.06 11961.93,-3584.06 11955.96,-3583.39 11955.96,-3582.05 11961.93,-3581.38 11961.93,-3581.38 12411.07,-3531.06 12411.07,-3531.06 12417.04,-3530.39 12428.96,-3530.39 12434.93,-3531.06 12434.93,-3531.06 12884.07,-3581.38 12884.07,-3581.38 12890.04,-3582.05 12890.04,-3583.39 12884.07,-3584.06 12884.07,-3584.06 12434.93,-3634.38 12434.93,-3634.38 12428.96,-3635.05 12417.04,-3635.05 12411.07,-3634.38"/>
<text text-anchor="middle" x="12423" y="-3594.02" font-family="Times,serif" font-size="14.00">Gate Layer 11 GPU 12</text>
<text text-anchor="middle" x="12423" y="-3579.02" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="12423" y="-3564.02" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer11_gpu12&#45;&gt;gate_layer11_gpu12 -->
<g id="edge1085" class="edge">
<title>mha_layer11_gpu12&#45;&gt;gate_layer11_gpu12</title>
<path fill="none" stroke="black" d="M11881.3,-3671.68C11982.42,-3655.26 12114.68,-3633.78 12223.2,-3616.16"/>
<polygon fill="black" stroke="black" points="12223.98,-3619.58 12233.29,-3614.52 12222.86,-3612.67 12223.98,-3619.58"/>
</g>
<!-- gate_layer11_gpu13 -->
<g id="node922" class="node">
<title>gate_layer11_gpu13</title>
<path fill="lightsteelblue" stroke="black" d="M13375.07,-3634.38C13375.07,-3634.38 12925.93,-3584.06 12925.93,-3584.06 12919.96,-3583.39 12919.96,-3582.05 12925.93,-3581.38 12925.93,-3581.38 13375.07,-3531.06 13375.07,-3531.06 13381.04,-3530.39 13392.96,-3530.39 13398.93,-3531.06 13398.93,-3531.06 13848.07,-3581.38 13848.07,-3581.38 13854.04,-3582.05 13854.04,-3583.39 13848.07,-3584.06 13848.07,-3584.06 13398.93,-3634.38 13398.93,-3634.38 13392.96,-3635.05 13381.04,-3635.05 13375.07,-3634.38"/>
<text text-anchor="middle" x="13387" y="-3594.02" font-family="Times,serif" font-size="14.00">Gate Layer 11 GPU 13</text>
<text text-anchor="middle" x="13387" y="-3579.02" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13387" y="-3564.02" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer11_gpu13&#45;&gt;gate_layer11_gpu13 -->
<g id="edge1086" class="edge">
<title>mha_layer11_gpu13&#45;&gt;gate_layer11_gpu13</title>
<path fill="none" stroke="black" d="M13356.08,-3671.47C13359.05,-3663.04 13362.48,-3653.3 13365.95,-3643.44"/>
<polygon fill="black" stroke="black" points="13369.26,-3644.58 13369.29,-3633.99 13362.66,-3642.25 13369.26,-3644.58"/>
</g>
<!-- gate_layer11_gpu14 -->
<g id="node923" class="node">
<title>gate_layer11_gpu14</title>
<path fill="lightsteelblue" stroke="black" d="M14339.07,-3634.38C14339.07,-3634.38 13889.93,-3584.06 13889.93,-3584.06 13883.96,-3583.39 13883.96,-3582.05 13889.93,-3581.38 13889.93,-3581.38 14339.07,-3531.06 14339.07,-3531.06 14345.04,-3530.39 14356.96,-3530.39 14362.93,-3531.06 14362.93,-3531.06 14812.07,-3581.38 14812.07,-3581.38 14818.04,-3582.05 14818.04,-3583.39 14812.07,-3584.06 14812.07,-3584.06 14362.93,-3634.38 14362.93,-3634.38 14356.96,-3635.05 14345.04,-3635.05 14339.07,-3634.38"/>
<text text-anchor="middle" x="14351" y="-3594.02" font-family="Times,serif" font-size="14.00">Gate Layer 11 GPU 14</text>
<text text-anchor="middle" x="14351" y="-3579.02" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14351" y="-3564.02" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer11_gpu14&#45;&gt;gate_layer11_gpu14 -->
<g id="edge1087" class="edge">
<title>mha_layer11_gpu14&#45;&gt;gate_layer11_gpu14</title>
<path fill="none" stroke="black" d="M14085.4,-3671.61C14126.26,-3658.09 14177.43,-3641.16 14223.92,-3625.77"/>
<polygon fill="black" stroke="black" points="14225.06,-3629.08 14233.45,-3622.62 14222.86,-3622.43 14225.06,-3629.08"/>
</g>
<!-- gate_layer11_gpu15 -->
<g id="node924" class="node">
<title>gate_layer11_gpu15</title>
<path fill="lightsteelblue" stroke="black" d="M15303.07,-3634.38C15303.07,-3634.38 14853.93,-3584.06 14853.93,-3584.06 14847.96,-3583.39 14847.96,-3582.05 14853.93,-3581.38 14853.93,-3581.38 15303.07,-3531.06 15303.07,-3531.06 15309.04,-3530.39 15320.96,-3530.39 15326.93,-3531.06 15326.93,-3531.06 15776.07,-3581.38 15776.07,-3581.38 15782.04,-3582.05 15782.04,-3583.39 15776.07,-3584.06 15776.07,-3584.06 15326.93,-3634.38 15326.93,-3634.38 15320.96,-3635.05 15309.04,-3635.05 15303.07,-3634.38"/>
<text text-anchor="middle" x="15315" y="-3594.02" font-family="Times,serif" font-size="14.00">Gate Layer 11 GPU 15</text>
<text text-anchor="middle" x="15315" y="-3579.02" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="15315" y="-3564.02" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer11_gpu15&#45;&gt;gate_layer11_gpu15 -->
<g id="edge1088" class="edge">
<title>mha_layer11_gpu15&#45;&gt;gate_layer11_gpu15</title>
<path fill="none" stroke="black" d="M14747.73,-3671.68C14854.96,-3655.05 14995.64,-3633.24 15110.07,-3615.5"/>
<polygon fill="black" stroke="black" points="15110.66,-3618.95 15120.01,-3613.95 15109.59,-3612.03 15110.66,-3618.95"/>
</g>
<!-- route_layer11_gpu0 -->
<g id="node941" class="node">
<title>route_layer11_gpu0</title>
<path fill="orange" stroke="black" d="M1359.74,-3493.72C1359.74,-3493.72 851.24,-3493.72 851.24,-3493.72 845.24,-3493.72 834.5,-3490.05 829.75,-3486.38 829.75,-3486.38 711.75,-3395.06 711.75,-3395.06 707,-3391.39 708.26,-3387.72 714.26,-3387.72 714.26,-3387.72 1222.76,-3387.72 1222.76,-3387.72 1228.76,-3387.72 1239.5,-3391.39 1244.25,-3395.06 1244.25,-3395.06 1362.25,-3486.38 1362.25,-3486.38 1367,-3490.05 1365.74,-3493.72 1359.74,-3493.72"/>
<text text-anchor="middle" x="1037" y="-3452.02" font-family="Times,serif" font-size="14.00">Token Router Layer 11 GPU 0</text>
<text text-anchor="middle" x="1037" y="-3437.02" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="1037" y="-3422.02" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer11_gpu0&#45;&gt;route_layer11_gpu0 -->
<g id="edge1089" class="edge">
<title>gate_layer11_gpu0&#45;&gt;route_layer11_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M914.09,-3536.27C929.12,-3524.71 945.47,-3512.13 961.2,-3500.03"/>
<polygon fill="black" stroke="black" points="963.57,-3502.62 969.36,-3493.75 959.3,-3497.07 963.57,-3502.62"/>
</g>
<!-- route_layer11_gpu1 -->
<g id="node943" class="node">
<title>route_layer11_gpu1</title>
<path fill="orange" stroke="black" d="M2737.74,-3493.72C2737.74,-3493.72 2229.24,-3493.72 2229.24,-3493.72 2223.24,-3493.72 2212.5,-3490.05 2207.75,-3486.38 2207.75,-3486.38 2089.75,-3395.06 2089.75,-3395.06 2085,-3391.39 2086.26,-3387.72 2092.26,-3387.72 2092.26,-3387.72 2600.76,-3387.72 2600.76,-3387.72 2606.76,-3387.72 2617.5,-3391.39 2622.25,-3395.06 2622.25,-3395.06 2740.25,-3486.38 2740.25,-3486.38 2745,-3490.05 2743.74,-3493.72 2737.74,-3493.72"/>
<text text-anchor="middle" x="2415" y="-3452.02" font-family="Times,serif" font-size="14.00">Token Router Layer 11 GPU 1</text>
<text text-anchor="middle" x="2415" y="-3437.02" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="2415" y="-3422.02" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer11_gpu1&#45;&gt;route_layer11_gpu1 -->
<g id="edge1090" class="edge">
<title>gate_layer11_gpu1&#45;&gt;route_layer11_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1969.01,-3546.48C2039.45,-3529.94 2124.67,-3509.92 2201.66,-3491.83"/>
<polygon fill="black" stroke="black" points="2202.56,-3495.22 2211.5,-3489.52 2200.96,-3488.4 2202.56,-3495.22"/>
</g>
<!-- route_layer11_gpu2 -->
<g id="node945" class="node">
<title>route_layer11_gpu2</title>
<path fill="orange" stroke="black" d="M3770.74,-3493.72C3770.74,-3493.72 3262.24,-3493.72 3262.24,-3493.72 3256.24,-3493.72 3245.5,-3490.05 3240.75,-3486.38 3240.75,-3486.38 3122.75,-3395.06 3122.75,-3395.06 3118,-3391.39 3119.26,-3387.72 3125.26,-3387.72 3125.26,-3387.72 3633.76,-3387.72 3633.76,-3387.72 3639.76,-3387.72 3650.5,-3391.39 3655.25,-3395.06 3655.25,-3395.06 3773.25,-3486.38 3773.25,-3486.38 3778,-3490.05 3776.74,-3493.72 3770.74,-3493.72"/>
<text text-anchor="middle" x="3448" y="-3452.02" font-family="Times,serif" font-size="14.00">Token Router Layer 11 GPU 2</text>
<text text-anchor="middle" x="3448" y="-3437.02" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="3448" y="-3422.02" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer11_gpu2&#45;&gt;route_layer11_gpu2 -->
<g id="edge1091" class="edge">
<title>gate_layer11_gpu2&#45;&gt;route_layer11_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2944.4,-3547.74C3030.17,-3529.68 3136.81,-3507.23 3229.85,-3487.65"/>
<polygon fill="black" stroke="black" points="3230.61,-3491.06 3239.68,-3485.58 3229.17,-3484.21 3230.61,-3491.06"/>
</g>
<!-- route_layer11_gpu3 -->
<g id="node947" class="node">
<title>route_layer11_gpu3</title>
<path fill="orange" stroke="black" d="M4630.74,-3493.72C4630.74,-3493.72 4122.24,-3493.72 4122.24,-3493.72 4116.24,-3493.72 4105.5,-3490.05 4100.75,-3486.38 4100.75,-3486.38 3982.75,-3395.06 3982.75,-3395.06 3978,-3391.39 3979.26,-3387.72 3985.26,-3387.72 3985.26,-3387.72 4493.76,-3387.72 4493.76,-3387.72 4499.76,-3387.72 4510.5,-3391.39 4515.25,-3395.06 4515.25,-3395.06 4633.25,-3486.38 4633.25,-3486.38 4638,-3490.05 4636.74,-3493.72 4630.74,-3493.72"/>
<text text-anchor="middle" x="4308" y="-3452.02" font-family="Times,serif" font-size="14.00">Token Router Layer 11 GPU 3</text>
<text text-anchor="middle" x="4308" y="-3437.02" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="4308" y="-3422.02" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer11_gpu3&#45;&gt;route_layer11_gpu3 -->
<g id="edge1092" class="edge">
<title>gate_layer11_gpu3&#45;&gt;route_layer11_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3891.11,-3545.76C3953.84,-3530.1 4028.61,-3511.44 4097.39,-3494.28"/>
<polygon fill="black" stroke="black" points="4098.64,-3497.57 4107.49,-3491.76 4096.94,-3490.78 4098.64,-3497.57"/>
</g>
<!-- route_layer11_gpu4 -->
<g id="node949" class="node">
<title>route_layer11_gpu4</title>
<path fill="orange" stroke="black" d="M5404.74,-3493.72C5404.74,-3493.72 4896.24,-3493.72 4896.24,-3493.72 4890.24,-3493.72 4879.5,-3490.05 4874.75,-3486.38 4874.75,-3486.38 4756.75,-3395.06 4756.75,-3395.06 4752,-3391.39 4753.26,-3387.72 4759.26,-3387.72 4759.26,-3387.72 5267.76,-3387.72 5267.76,-3387.72 5273.76,-3387.72 5284.5,-3391.39 5289.25,-3395.06 5289.25,-3395.06 5407.25,-3486.38 5407.25,-3486.38 5412,-3490.05 5410.74,-3493.72 5404.74,-3493.72"/>
<text text-anchor="middle" x="5082" y="-3452.02" font-family="Times,serif" font-size="14.00">Token Router Layer 11 GPU 4</text>
<text text-anchor="middle" x="5082" y="-3437.02" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="5082" y="-3422.02" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer11_gpu4&#45;&gt;route_layer11_gpu4 -->
<g id="edge1093" class="edge">
<title>gate_layer11_gpu4&#45;&gt;route_layer11_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4817.31,-3541.6C4853.89,-3527.8 4895.52,-3512.09 4934.76,-3497.28"/>
<polygon fill="black" stroke="black" points="4936.02,-3500.55 4944.14,-3493.74 4933.55,-3494 4936.02,-3500.55"/>
</g>
<!-- route_layer11_gpu5 -->
<g id="node951" class="node">
<title>route_layer11_gpu5</title>
<path fill="orange" stroke="black" d="M6135.74,-3493.72C6135.74,-3493.72 5627.24,-3493.72 5627.24,-3493.72 5621.24,-3493.72 5610.5,-3490.05 5605.75,-3486.38 5605.75,-3486.38 5487.75,-3395.06 5487.75,-3395.06 5483,-3391.39 5484.26,-3387.72 5490.26,-3387.72 5490.26,-3387.72 5998.76,-3387.72 5998.76,-3387.72 6004.76,-3387.72 6015.5,-3391.39 6020.25,-3395.06 6020.25,-3395.06 6138.25,-3486.38 6138.25,-3486.38 6143,-3490.05 6141.74,-3493.72 6135.74,-3493.72"/>
<text text-anchor="middle" x="5813" y="-3452.02" font-family="Times,serif" font-size="14.00">Token Router Layer 11 GPU 5</text>
<text text-anchor="middle" x="5813" y="-3437.02" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="5813" y="-3422.02" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer11_gpu5&#45;&gt;route_layer11_gpu5 -->
<g id="edge1094" class="edge">
<title>gate_layer11_gpu5&#45;&gt;route_layer11_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5721.34,-3534.71C5731.87,-3524.03 5743.2,-3512.53 5754.17,-3501.4"/>
<polygon fill="black" stroke="black" points="5756.8,-3503.73 5761.32,-3494.15 5751.81,-3498.81 5756.8,-3503.73"/>
</g>
<!-- route_layer11_gpu6 -->
<g id="node953" class="node">
<title>route_layer11_gpu6</title>
<path fill="orange" stroke="black" d="M7099.74,-3493.72C7099.74,-3493.72 6591.24,-3493.72 6591.24,-3493.72 6585.24,-3493.72 6574.5,-3490.05 6569.75,-3486.38 6569.75,-3486.38 6451.75,-3395.06 6451.75,-3395.06 6447,-3391.39 6448.26,-3387.72 6454.26,-3387.72 6454.26,-3387.72 6962.76,-3387.72 6962.76,-3387.72 6968.76,-3387.72 6979.5,-3391.39 6984.25,-3395.06 6984.25,-3395.06 7102.25,-3486.38 7102.25,-3486.38 7107,-3490.05 7105.74,-3493.72 7099.74,-3493.72"/>
<text text-anchor="middle" x="6777" y="-3452.02" font-family="Times,serif" font-size="14.00">Token Router Layer 11 GPU 6</text>
<text text-anchor="middle" x="6777" y="-3437.02" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="6777" y="-3422.02" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer11_gpu6&#45;&gt;route_layer11_gpu6 -->
<g id="edge1095" class="edge">
<title>gate_layer11_gpu6&#45;&gt;route_layer11_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6685.34,-3534.71C6695.87,-3524.03 6707.2,-3512.53 6718.17,-3501.4"/>
<polygon fill="black" stroke="black" points="6720.8,-3503.73 6725.32,-3494.15 6715.81,-3498.81 6720.8,-3503.73"/>
</g>
<!-- route_layer11_gpu7 -->
<g id="node955" class="node">
<title>route_layer11_gpu7</title>
<path fill="orange" stroke="black" d="M7994.74,-3493.72C7994.74,-3493.72 7486.24,-3493.72 7486.24,-3493.72 7480.24,-3493.72 7469.5,-3490.05 7464.75,-3486.38 7464.75,-3486.38 7346.75,-3395.06 7346.75,-3395.06 7342,-3391.39 7343.26,-3387.72 7349.26,-3387.72 7349.26,-3387.72 7857.76,-3387.72 7857.76,-3387.72 7863.76,-3387.72 7874.5,-3391.39 7879.25,-3395.06 7879.25,-3395.06 7997.25,-3486.38 7997.25,-3486.38 8002,-3490.05 8000.74,-3493.72 7994.74,-3493.72"/>
<text text-anchor="middle" x="7672" y="-3452.02" font-family="Times,serif" font-size="14.00">Token Router Layer 11 GPU 7</text>
<text text-anchor="middle" x="7672" y="-3437.02" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="7672" y="-3422.02" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer11_gpu7&#45;&gt;route_layer11_gpu7 -->
<g id="edge1096" class="edge">
<title>gate_layer11_gpu7&#45;&gt;route_layer11_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7627.33,-3532.36C7631.97,-3522.94 7636.89,-3512.96 7641.69,-3503.21"/>
<polygon fill="black" stroke="black" points="7644.97,-3504.47 7646.26,-3493.95 7638.7,-3501.38 7644.97,-3504.47"/>
</g>
<!-- route_layer11_gpu8 -->
<g id="node957" class="node">
<title>route_layer11_gpu8</title>
<path fill="orange" stroke="black" d="M8820.74,-3493.72C8820.74,-3493.72 8312.24,-3493.72 8312.24,-3493.72 8306.24,-3493.72 8295.5,-3490.05 8290.75,-3486.38 8290.75,-3486.38 8172.75,-3395.06 8172.75,-3395.06 8168,-3391.39 8169.26,-3387.72 8175.26,-3387.72 8175.26,-3387.72 8683.76,-3387.72 8683.76,-3387.72 8689.76,-3387.72 8700.5,-3391.39 8705.25,-3395.06 8705.25,-3395.06 8823.25,-3486.38 8823.25,-3486.38 8828,-3490.05 8826.74,-3493.72 8820.74,-3493.72"/>
<text text-anchor="middle" x="8498" y="-3452.02" font-family="Times,serif" font-size="14.00">Token Router Layer 11 GPU 8</text>
<text text-anchor="middle" x="8498" y="-3437.02" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="8498" y="-3422.02" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer11_gpu8&#45;&gt;route_layer11_gpu8 -->
<g id="edge1097" class="edge">
<title>gate_layer11_gpu8&#45;&gt;route_layer11_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8542.67,-3532.36C8538.03,-3522.94 8533.11,-3512.96 8528.31,-3503.21"/>
<polygon fill="black" stroke="black" points="8531.3,-3501.38 8523.74,-3493.95 8525.03,-3504.47 8531.3,-3501.38"/>
</g>
<!-- route_layer11_gpu9 -->
<g id="node959" class="node">
<title>route_layer11_gpu9</title>
<path fill="orange" stroke="black" d="M9715.74,-3493.72C9715.74,-3493.72 9207.24,-3493.72 9207.24,-3493.72 9201.24,-3493.72 9190.5,-3490.05 9185.75,-3486.38 9185.75,-3486.38 9067.75,-3395.06 9067.75,-3395.06 9063,-3391.39 9064.26,-3387.72 9070.26,-3387.72 9070.26,-3387.72 9578.76,-3387.72 9578.76,-3387.72 9584.76,-3387.72 9595.5,-3391.39 9600.25,-3395.06 9600.25,-3395.06 9718.25,-3486.38 9718.25,-3486.38 9723,-3490.05 9721.74,-3493.72 9715.74,-3493.72"/>
<text text-anchor="middle" x="9393" y="-3452.02" font-family="Times,serif" font-size="14.00">Token Router Layer 11 GPU 9</text>
<text text-anchor="middle" x="9393" y="-3437.02" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="9393" y="-3422.02" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer11_gpu9&#45;&gt;route_layer11_gpu9 -->
<g id="edge1098" class="edge">
<title>gate_layer11_gpu9&#45;&gt;route_layer11_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9484.66,-3534.71C9474.13,-3524.03 9462.8,-3512.53 9451.83,-3501.4"/>
<polygon fill="black" stroke="black" points="9454.19,-3498.81 9444.68,-3494.15 9449.2,-3503.73 9454.19,-3498.81"/>
</g>
<!-- route_layer11_gpu10 -->
<g id="node961" class="node">
<title>route_layer11_gpu10</title>
<path fill="orange" stroke="black" d="M10644.74,-3493.72C10644.74,-3493.72 10136.24,-3493.72 10136.24,-3493.72 10130.24,-3493.72 10119.5,-3490.05 10114.75,-3486.38 10114.75,-3486.38 9996.75,-3395.06 9996.75,-3395.06 9992,-3391.39 9993.26,-3387.72 9999.26,-3387.72 9999.26,-3387.72 10507.76,-3387.72 10507.76,-3387.72 10513.76,-3387.72 10524.5,-3391.39 10529.25,-3395.06 10529.25,-3395.06 10647.25,-3486.38 10647.25,-3486.38 10652,-3490.05 10650.74,-3493.72 10644.74,-3493.72"/>
<text text-anchor="middle" x="10322" y="-3452.02" font-family="Times,serif" font-size="14.00">Token Router Layer 11 GPU 10</text>
<text text-anchor="middle" x="10322" y="-3437.02" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="10322" y="-3422.02" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer11_gpu10&#45;&gt;route_layer11_gpu10 -->
<g id="edge1099" class="edge">
<title>gate_layer11_gpu10&#45;&gt;route_layer11_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10438.35,-3535.88C10424.3,-3524.51 10409.05,-3512.17 10394.36,-3500.28"/>
<polygon fill="black" stroke="black" points="10396.24,-3497.3 10386.27,-3493.73 10391.84,-3502.74 10396.24,-3497.3"/>
</g>
<!-- route_layer11_gpu11 -->
<g id="node963" class="node">
<title>route_layer11_gpu11</title>
<path fill="orange" stroke="black" d="M11591.74,-3493.72C11591.74,-3493.72 11083.24,-3493.72 11083.24,-3493.72 11077.24,-3493.72 11066.5,-3490.05 11061.75,-3486.38 11061.75,-3486.38 10943.75,-3395.06 10943.75,-3395.06 10939,-3391.39 10940.26,-3387.72 10946.26,-3387.72 10946.26,-3387.72 11454.76,-3387.72 11454.76,-3387.72 11460.76,-3387.72 11471.5,-3391.39 11476.25,-3395.06 11476.25,-3395.06 11594.25,-3486.38 11594.25,-3486.38 11599,-3490.05 11597.74,-3493.72 11591.74,-3493.72"/>
<text text-anchor="middle" x="11269" y="-3452.02" font-family="Times,serif" font-size="14.00">Token Router Layer 11 GPU 11</text>
<text text-anchor="middle" x="11269" y="-3437.02" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="11269" y="-3422.02" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer11_gpu11&#45;&gt;route_layer11_gpu11 -->
<g id="edge1100" class="edge">
<title>gate_layer11_gpu11&#45;&gt;route_layer11_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11397.57,-3536.46C11381.74,-3524.79 11364.47,-3512.06 11347.87,-3499.84"/>
<polygon fill="black" stroke="black" points="11349.92,-3497 11339.79,-3493.88 11345.77,-3502.63 11349.92,-3497"/>
</g>
<!-- route_layer11_gpu12 -->
<g id="node965" class="node">
<title>route_layer11_gpu12</title>
<path fill="orange" stroke="black" d="M12546.74,-3493.72C12546.74,-3493.72 12038.24,-3493.72 12038.24,-3493.72 12032.24,-3493.72 12021.5,-3490.05 12016.75,-3486.38 12016.75,-3486.38 11898.75,-3395.06 11898.75,-3395.06 11894,-3391.39 11895.26,-3387.72 11901.26,-3387.72 11901.26,-3387.72 12409.76,-3387.72 12409.76,-3387.72 12415.76,-3387.72 12426.5,-3391.39 12431.25,-3395.06 12431.25,-3395.06 12549.25,-3486.38 12549.25,-3486.38 12554,-3490.05 12552.74,-3493.72 12546.74,-3493.72"/>
<text text-anchor="middle" x="12224" y="-3452.02" font-family="Times,serif" font-size="14.00">Token Router Layer 11 GPU 12</text>
<text text-anchor="middle" x="12224" y="-3437.02" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="12224" y="-3422.02" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer11_gpu12&#45;&gt;route_layer11_gpu12 -->
<g id="edge1101" class="edge">
<title>gate_layer11_gpu12&#45;&gt;route_layer11_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12359.21,-3536.85C12342.51,-3525.09 12324.25,-3512.25 12306.71,-3499.91"/>
<polygon fill="black" stroke="black" points="12308.36,-3496.79 12298.17,-3493.9 12304.34,-3502.52 12308.36,-3496.79"/>
</g>
<!-- route_layer11_gpu13 -->
<g id="node967" class="node">
<title>route_layer11_gpu13</title>
<path fill="orange" stroke="black" d="M13506.74,-3493.72C13506.74,-3493.72 12998.24,-3493.72 12998.24,-3493.72 12992.24,-3493.72 12981.5,-3490.05 12976.75,-3486.38 12976.75,-3486.38 12858.75,-3395.06 12858.75,-3395.06 12854,-3391.39 12855.26,-3387.72 12861.26,-3387.72 12861.26,-3387.72 13369.76,-3387.72 13369.76,-3387.72 13375.76,-3387.72 13386.5,-3391.39 13391.25,-3395.06 13391.25,-3395.06 13509.25,-3486.38 13509.25,-3486.38 13514,-3490.05 13512.74,-3493.72 13506.74,-3493.72"/>
<text text-anchor="middle" x="13184" y="-3452.02" font-family="Times,serif" font-size="14.00">Token Router Layer 11 GPU 13</text>
<text text-anchor="middle" x="13184" y="-3437.02" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="13184" y="-3422.02" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer11_gpu13&#45;&gt;route_layer11_gpu13 -->
<g id="edge1102" class="edge">
<title>gate_layer11_gpu13&#45;&gt;route_layer11_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13321.93,-3536.85C13304.89,-3525.09 13286.27,-3512.25 13268.38,-3499.91"/>
<polygon fill="black" stroke="black" points="13269.88,-3496.7 13259.66,-3493.9 13265.91,-3502.46 13269.88,-3496.7"/>
</g>
<!-- route_layer11_gpu14 -->
<g id="node969" class="node">
<title>route_layer11_gpu14</title>
<path fill="orange" stroke="black" d="M14468.74,-3493.72C14468.74,-3493.72 13960.24,-3493.72 13960.24,-3493.72 13954.24,-3493.72 13943.5,-3490.05 13938.75,-3486.38 13938.75,-3486.38 13820.75,-3395.06 13820.75,-3395.06 13816,-3391.39 13817.26,-3387.72 13823.26,-3387.72 13823.26,-3387.72 14331.76,-3387.72 14331.76,-3387.72 14337.76,-3387.72 14348.5,-3391.39 14353.25,-3395.06 14353.25,-3395.06 14471.25,-3486.38 14471.25,-3486.38 14476,-3490.05 14474.74,-3493.72 14468.74,-3493.72"/>
<text text-anchor="middle" x="14146" y="-3452.02" font-family="Times,serif" font-size="14.00">Token Router Layer 11 GPU 14</text>
<text text-anchor="middle" x="14146" y="-3437.02" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="14146" y="-3422.02" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer11_gpu14&#45;&gt;route_layer11_gpu14 -->
<g id="edge1103" class="edge">
<title>gate_layer11_gpu14&#45;&gt;route_layer11_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14285.57,-3537.04C14268.1,-3525.1 14248.96,-3512.03 14230.61,-3499.5"/>
<polygon fill="black" stroke="black" points="14232.47,-3496.53 14222.24,-3493.79 14228.52,-3502.32 14232.47,-3496.53"/>
</g>
<!-- route_layer11_gpu15 -->
<g id="node971" class="node">
<title>route_layer11_gpu15</title>
<path fill="orange" stroke="black" d="M15431.74,-3493.72C15431.74,-3493.72 14923.24,-3493.72 14923.24,-3493.72 14917.24,-3493.72 14906.5,-3490.05 14901.75,-3486.38 14901.75,-3486.38 14783.75,-3395.06 14783.75,-3395.06 14779,-3391.39 14780.26,-3387.72 14786.26,-3387.72 14786.26,-3387.72 15294.76,-3387.72 15294.76,-3387.72 15300.76,-3387.72 15311.5,-3391.39 15316.25,-3395.06 15316.25,-3395.06 15434.25,-3486.38 15434.25,-3486.38 15439,-3490.05 15437.74,-3493.72 15431.74,-3493.72"/>
<text text-anchor="middle" x="15109" y="-3452.02" font-family="Times,serif" font-size="14.00">Token Router Layer 11 GPU 15</text>
<text text-anchor="middle" x="15109" y="-3437.02" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="15109" y="-3422.02" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer11_gpu15&#45;&gt;route_layer11_gpu15 -->
<g id="edge1104" class="edge">
<title>gate_layer11_gpu15&#45;&gt;route_layer11_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15249.25,-3537.04C15231.69,-3525.1 15212.46,-3512.03 15194.02,-3499.5"/>
<polygon fill="black" stroke="black" points="15195.85,-3496.51 15185.61,-3493.79 15191.91,-3502.3 15195.85,-3496.51"/>
</g>
<!-- expert_layer11_gpu0_expert0 -->
<g id="node925" class="node">
<title>expert_layer11_gpu0_expert0</title>
<path fill="lightcoral" stroke="black" d="M1844.5,-3240.77C1844.5,-3240.77 1375.5,-3240.77 1375.5,-3240.77 1369.5,-3240.77 1363.5,-3234.77 1363.5,-3228.77 1363.5,-3228.77 1363.5,-3184.77 1363.5,-3184.77 1363.5,-3178.77 1369.5,-3172.77 1375.5,-3172.77 1375.5,-3172.77 1844.5,-3172.77 1844.5,-3172.77 1850.5,-3172.77 1856.5,-3178.77 1856.5,-3184.77 1856.5,-3184.77 1856.5,-3228.77 1856.5,-3228.77 1856.5,-3234.77 1850.5,-3240.77 1844.5,-3240.77"/>
<text text-anchor="middle" x="1610" y="-3225.57" font-family="Times,serif" font-size="14.00">Expert 0 Layer 11 GPU 0</text>
<text text-anchor="middle" x="1610" y="-3210.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="1610" y="-3195.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="1610" y="-3180.57" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer11_gpu0 -->
<g id="node942" class="node">
<title>aggregate_layer11_gpu0</title>
<path fill="orange" stroke="black" d="M1844.29,-3136.77C1844.29,-3136.77 1357.19,-3136.77 1357.19,-3136.77 1351.19,-3136.77 1340.52,-3133 1335.85,-3129.23 1335.85,-3129.23 1223.06,-3038.3 1223.06,-3038.3 1218.38,-3034.53 1219.71,-3030.77 1225.71,-3030.77 1225.71,-3030.77 1712.81,-3030.77 1712.81,-3030.77 1718.81,-3030.77 1729.48,-3034.53 1734.15,-3038.3 1734.15,-3038.3 1846.94,-3129.23 1846.94,-3129.23 1851.62,-3133 1850.29,-3136.77 1844.29,-3136.77"/>
<text text-anchor="middle" x="1535" y="-3095.07" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 11 GPU 0</text>
<text text-anchor="middle" x="1535" y="-3080.07" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="1535" y="-3065.07" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer11_gpu0_expert0&#45;&gt;aggregate_layer11_gpu0 -->
<g id="edge1137" class="edge">
<title>expert_layer11_gpu0_expert0&#45;&gt;aggregate_layer11_gpu0</title>
<path fill="none" stroke="black" d="M1589.51,-3172.7C1584.26,-3164.24 1578.45,-3154.86 1572.63,-3145.48"/>
<polygon fill="black" stroke="black" points="1575.55,-3143.55 1567.31,-3136.89 1569.6,-3147.24 1575.55,-3143.55"/>
</g>
<!-- expert_layer11_gpu1_expert1 -->
<g id="node926" class="node">
<title>expert_layer11_gpu1_expert1</title>
<path fill="lightcoral" stroke="black" d="M3101.5,-3240.77C3101.5,-3240.77 2632.5,-3240.77 2632.5,-3240.77 2626.5,-3240.77 2620.5,-3234.77 2620.5,-3228.77 2620.5,-3228.77 2620.5,-3184.77 2620.5,-3184.77 2620.5,-3178.77 2626.5,-3172.77 2632.5,-3172.77 2632.5,-3172.77 3101.5,-3172.77 3101.5,-3172.77 3107.5,-3172.77 3113.5,-3178.77 3113.5,-3184.77 3113.5,-3184.77 3113.5,-3228.77 3113.5,-3228.77 3113.5,-3234.77 3107.5,-3240.77 3101.5,-3240.77"/>
<text text-anchor="middle" x="2867" y="-3225.57" font-family="Times,serif" font-size="14.00">Expert 1 Layer 11 GPU 1</text>
<text text-anchor="middle" x="2867" y="-3210.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2867" y="-3195.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2867" y="-3180.57" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer11_gpu1 -->
<g id="node944" class="node">
<title>aggregate_layer11_gpu1</title>
<path fill="orange" stroke="black" d="M2875.29,-3136.77C2875.29,-3136.77 2388.19,-3136.77 2388.19,-3136.77 2382.19,-3136.77 2371.52,-3133 2366.85,-3129.23 2366.85,-3129.23 2254.06,-3038.3 2254.06,-3038.3 2249.38,-3034.53 2250.71,-3030.77 2256.71,-3030.77 2256.71,-3030.77 2743.81,-3030.77 2743.81,-3030.77 2749.81,-3030.77 2760.48,-3034.53 2765.15,-3038.3 2765.15,-3038.3 2877.94,-3129.23 2877.94,-3129.23 2882.62,-3133 2881.29,-3136.77 2875.29,-3136.77"/>
<text text-anchor="middle" x="2566" y="-3095.07" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 11 GPU 1</text>
<text text-anchor="middle" x="2566" y="-3080.07" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="2566" y="-3065.07" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer11_gpu1_expert1&#45;&gt;aggregate_layer11_gpu1 -->
<g id="edge1138" class="edge">
<title>expert_layer11_gpu1_expert1&#45;&gt;aggregate_layer11_gpu1</title>
<path fill="none" stroke="black" d="M2784.75,-3172.7C2760.07,-3162.78 2732.29,-3151.61 2705.01,-3140.65"/>
<polygon fill="black" stroke="black" points="2705.97,-3137.26 2695.38,-3136.78 2703.36,-3143.76 2705.97,-3137.26"/>
</g>
<!-- expert_layer11_gpu2_expert2 -->
<g id="node927" class="node">
<title>expert_layer11_gpu2_expert2</title>
<path fill="lightcoral" stroke="black" d="M4098.5,-3240.77C4098.5,-3240.77 3629.5,-3240.77 3629.5,-3240.77 3623.5,-3240.77 3617.5,-3234.77 3617.5,-3228.77 3617.5,-3228.77 3617.5,-3184.77 3617.5,-3184.77 3617.5,-3178.77 3623.5,-3172.77 3629.5,-3172.77 3629.5,-3172.77 4098.5,-3172.77 4098.5,-3172.77 4104.5,-3172.77 4110.5,-3178.77 4110.5,-3184.77 4110.5,-3184.77 4110.5,-3228.77 4110.5,-3228.77 4110.5,-3234.77 4104.5,-3240.77 4098.5,-3240.77"/>
<text text-anchor="middle" x="3864" y="-3225.57" font-family="Times,serif" font-size="14.00">Expert 2 Layer 11 GPU 2</text>
<text text-anchor="middle" x="3864" y="-3210.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3864" y="-3195.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3864" y="-3180.57" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer11_gpu2 -->
<g id="node946" class="node">
<title>aggregate_layer11_gpu2</title>
<path fill="orange" stroke="black" d="M3989.29,-3136.77C3989.29,-3136.77 3502.19,-3136.77 3502.19,-3136.77 3496.19,-3136.77 3485.52,-3133 3480.85,-3129.23 3480.85,-3129.23 3368.06,-3038.3 3368.06,-3038.3 3363.38,-3034.53 3364.71,-3030.77 3370.71,-3030.77 3370.71,-3030.77 3857.81,-3030.77 3857.81,-3030.77 3863.81,-3030.77 3874.48,-3034.53 3879.15,-3038.3 3879.15,-3038.3 3991.94,-3129.23 3991.94,-3129.23 3996.62,-3133 3995.29,-3136.77 3989.29,-3136.77"/>
<text text-anchor="middle" x="3680" y="-3095.07" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 11 GPU 2</text>
<text text-anchor="middle" x="3680" y="-3080.07" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="3680" y="-3065.07" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer11_gpu2_expert2&#45;&gt;aggregate_layer11_gpu2 -->
<g id="edge1139" class="edge">
<title>expert_layer11_gpu2_expert2&#45;&gt;aggregate_layer11_gpu2</title>
<path fill="none" stroke="black" d="M3813.72,-3172.7C3799.54,-3163.37 3783.67,-3152.94 3767.97,-3142.61"/>
<polygon fill="black" stroke="black" points="3769.55,-3139.46 3759.27,-3136.89 3765.7,-3145.31 3769.55,-3139.46"/>
</g>
<!-- expert_layer11_gpu3_expert3 -->
<g id="node928" class="node">
<title>expert_layer11_gpu3_expert3</title>
<path fill="lightcoral" stroke="black" d="M5150.5,-3240.77C5150.5,-3240.77 4681.5,-3240.77 4681.5,-3240.77 4675.5,-3240.77 4669.5,-3234.77 4669.5,-3228.77 4669.5,-3228.77 4669.5,-3184.77 4669.5,-3184.77 4669.5,-3178.77 4675.5,-3172.77 4681.5,-3172.77 4681.5,-3172.77 5150.5,-3172.77 5150.5,-3172.77 5156.5,-3172.77 5162.5,-3178.77 5162.5,-3184.77 5162.5,-3184.77 5162.5,-3228.77 5162.5,-3228.77 5162.5,-3234.77 5156.5,-3240.77 5150.5,-3240.77"/>
<text text-anchor="middle" x="4916" y="-3225.57" font-family="Times,serif" font-size="14.00">Expert 3 Layer 11 GPU 3</text>
<text text-anchor="middle" x="4916" y="-3210.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4916" y="-3195.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4916" y="-3180.57" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer11_gpu3 -->
<g id="node948" class="node">
<title>aggregate_layer11_gpu3</title>
<path fill="orange" stroke="black" d="M4888.29,-3136.77C4888.29,-3136.77 4401.19,-3136.77 4401.19,-3136.77 4395.19,-3136.77 4384.52,-3133 4379.85,-3129.23 4379.85,-3129.23 4267.06,-3038.3 4267.06,-3038.3 4262.38,-3034.53 4263.71,-3030.77 4269.71,-3030.77 4269.71,-3030.77 4756.81,-3030.77 4756.81,-3030.77 4762.81,-3030.77 4773.48,-3034.53 4778.15,-3038.3 4778.15,-3038.3 4890.94,-3129.23 4890.94,-3129.23 4895.62,-3133 4894.29,-3136.77 4888.29,-3136.77"/>
<text text-anchor="middle" x="4579" y="-3095.07" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 11 GPU 3</text>
<text text-anchor="middle" x="4579" y="-3080.07" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="4579" y="-3065.07" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer11_gpu3_expert3&#45;&gt;aggregate_layer11_gpu3 -->
<g id="edge1140" class="edge">
<title>expert_layer11_gpu3_expert3&#45;&gt;aggregate_layer11_gpu3</title>
<path fill="none" stroke="black" d="M4823.91,-3172.7C4795.92,-3162.65 4764.36,-3151.32 4733.43,-3140.22"/>
<polygon fill="black" stroke="black" points="4734.45,-3136.86 4723.86,-3136.78 4732.09,-3143.45 4734.45,-3136.86"/>
</g>
<!-- expert_layer11_gpu4_expert4 -->
<g id="node929" class="node">
<title>expert_layer11_gpu4_expert4</title>
<path fill="lightcoral" stroke="black" d="M5981.5,-3240.77C5981.5,-3240.77 5512.5,-3240.77 5512.5,-3240.77 5506.5,-3240.77 5500.5,-3234.77 5500.5,-3228.77 5500.5,-3228.77 5500.5,-3184.77 5500.5,-3184.77 5500.5,-3178.77 5506.5,-3172.77 5512.5,-3172.77 5512.5,-3172.77 5981.5,-3172.77 5981.5,-3172.77 5987.5,-3172.77 5993.5,-3178.77 5993.5,-3184.77 5993.5,-3184.77 5993.5,-3228.77 5993.5,-3228.77 5993.5,-3234.77 5987.5,-3240.77 5981.5,-3240.77"/>
<text text-anchor="middle" x="5747" y="-3225.57" font-family="Times,serif" font-size="14.00">Expert 4 Layer 11 GPU 4</text>
<text text-anchor="middle" x="5747" y="-3210.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5747" y="-3195.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5747" y="-3180.57" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer11_gpu4 -->
<g id="node950" class="node">
<title>aggregate_layer11_gpu4</title>
<path fill="orange" stroke="black" d="M5776.29,-3136.77C5776.29,-3136.77 5289.19,-3136.77 5289.19,-3136.77 5283.19,-3136.77 5272.52,-3133 5267.85,-3129.23 5267.85,-3129.23 5155.06,-3038.3 5155.06,-3038.3 5150.38,-3034.53 5151.71,-3030.77 5157.71,-3030.77 5157.71,-3030.77 5644.81,-3030.77 5644.81,-3030.77 5650.81,-3030.77 5661.48,-3034.53 5666.15,-3038.3 5666.15,-3038.3 5778.94,-3129.23 5778.94,-3129.23 5783.62,-3133 5782.29,-3136.77 5776.29,-3136.77"/>
<text text-anchor="middle" x="5467" y="-3095.07" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 11 GPU 4</text>
<text text-anchor="middle" x="5467" y="-3080.07" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="5467" y="-3065.07" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer11_gpu4_expert4&#45;&gt;aggregate_layer11_gpu4 -->
<g id="edge1141" class="edge">
<title>expert_layer11_gpu4_expert4&#45;&gt;aggregate_layer11_gpu4</title>
<path fill="none" stroke="black" d="M5670.49,-3172.7C5647.63,-3162.83 5621.91,-3151.71 5596.64,-3140.79"/>
<polygon fill="black" stroke="black" points="5597.93,-3137.53 5587.36,-3136.78 5595.15,-3143.96 5597.93,-3137.53"/>
</g>
<!-- expert_layer11_gpu5_expert5 -->
<g id="node930" class="node">
<title>expert_layer11_gpu5_expert5</title>
<path fill="lightcoral" stroke="black" d="M6623.5,-3240.77C6623.5,-3240.77 6154.5,-3240.77 6154.5,-3240.77 6148.5,-3240.77 6142.5,-3234.77 6142.5,-3228.77 6142.5,-3228.77 6142.5,-3184.77 6142.5,-3184.77 6142.5,-3178.77 6148.5,-3172.77 6154.5,-3172.77 6154.5,-3172.77 6623.5,-3172.77 6623.5,-3172.77 6629.5,-3172.77 6635.5,-3178.77 6635.5,-3184.77 6635.5,-3184.77 6635.5,-3228.77 6635.5,-3228.77 6635.5,-3234.77 6629.5,-3240.77 6623.5,-3240.77"/>
<text text-anchor="middle" x="6389" y="-3225.57" font-family="Times,serif" font-size="14.00">Expert 5 Layer 11 GPU 5</text>
<text text-anchor="middle" x="6389" y="-3210.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6389" y="-3195.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6389" y="-3180.57" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer11_gpu5 -->
<g id="node952" class="node">
<title>aggregate_layer11_gpu5</title>
<path fill="orange" stroke="black" d="M6550.29,-3136.77C6550.29,-3136.77 6063.19,-3136.77 6063.19,-3136.77 6057.19,-3136.77 6046.52,-3133 6041.85,-3129.23 6041.85,-3129.23 5929.06,-3038.3 5929.06,-3038.3 5924.38,-3034.53 5925.71,-3030.77 5931.71,-3030.77 5931.71,-3030.77 6418.81,-3030.77 6418.81,-3030.77 6424.81,-3030.77 6435.48,-3034.53 6440.15,-3038.3 6440.15,-3038.3 6552.94,-3129.23 6552.94,-3129.23 6557.62,-3133 6556.29,-3136.77 6550.29,-3136.77"/>
<text text-anchor="middle" x="6241" y="-3095.07" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 11 GPU 5</text>
<text text-anchor="middle" x="6241" y="-3080.07" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="6241" y="-3065.07" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer11_gpu5_expert5&#45;&gt;aggregate_layer11_gpu5 -->
<g id="edge1142" class="edge">
<title>expert_layer11_gpu5_expert5&#45;&gt;aggregate_layer11_gpu5</title>
<path fill="none" stroke="black" d="M6348.56,-3172.7C6337.47,-3163.63 6325.1,-3153.52 6312.81,-3143.47"/>
<polygon fill="black" stroke="black" points="6314.72,-3140.51 6304.76,-3136.89 6310.29,-3145.93 6314.72,-3140.51"/>
</g>
<!-- expert_layer11_gpu6_expert6 -->
<g id="node931" class="node">
<title>expert_layer11_gpu6_expert6</title>
<path fill="lightcoral" stroke="black" d="M7338.5,-3240.77C7338.5,-3240.77 6869.5,-3240.77 6869.5,-3240.77 6863.5,-3240.77 6857.5,-3234.77 6857.5,-3228.77 6857.5,-3228.77 6857.5,-3184.77 6857.5,-3184.77 6857.5,-3178.77 6863.5,-3172.77 6869.5,-3172.77 6869.5,-3172.77 7338.5,-3172.77 7338.5,-3172.77 7344.5,-3172.77 7350.5,-3178.77 7350.5,-3184.77 7350.5,-3184.77 7350.5,-3228.77 7350.5,-3228.77 7350.5,-3234.77 7344.5,-3240.77 7338.5,-3240.77"/>
<text text-anchor="middle" x="7104" y="-3225.57" font-family="Times,serif" font-size="14.00">Expert 6 Layer 11 GPU 6</text>
<text text-anchor="middle" x="7104" y="-3210.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7104" y="-3195.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7104" y="-3180.57" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer11_gpu6 -->
<g id="node954" class="node">
<title>aggregate_layer11_gpu6</title>
<path fill="orange" stroke="black" d="M7268.29,-3136.77C7268.29,-3136.77 6781.19,-3136.77 6781.19,-3136.77 6775.19,-3136.77 6764.52,-3133 6759.85,-3129.23 6759.85,-3129.23 6647.06,-3038.3 6647.06,-3038.3 6642.38,-3034.53 6643.71,-3030.77 6649.71,-3030.77 6649.71,-3030.77 7136.81,-3030.77 7136.81,-3030.77 7142.81,-3030.77 7153.48,-3034.53 7158.15,-3038.3 7158.15,-3038.3 7270.94,-3129.23 7270.94,-3129.23 7275.62,-3133 7274.29,-3136.77 7268.29,-3136.77"/>
<text text-anchor="middle" x="6959" y="-3095.07" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 11 GPU 6</text>
<text text-anchor="middle" x="6959" y="-3080.07" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="6959" y="-3065.07" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer11_gpu6_expert6&#45;&gt;aggregate_layer11_gpu6 -->
<g id="edge1143" class="edge">
<title>expert_layer11_gpu6_expert6&#45;&gt;aggregate_layer11_gpu6</title>
<path fill="none" stroke="black" d="M7064.38,-3172.7C7053.51,-3163.63 7041.39,-3153.52 7029.35,-3143.47"/>
<polygon fill="black" stroke="black" points="7031.39,-3140.61 7021.47,-3136.89 7026.9,-3145.99 7031.39,-3140.61"/>
</g>
<!-- expert_layer11_gpu7_expert7 -->
<g id="node932" class="node">
<title>expert_layer11_gpu7_expert7</title>
<path fill="lightcoral" stroke="black" d="M7938.5,-3240.77C7938.5,-3240.77 7469.5,-3240.77 7469.5,-3240.77 7463.5,-3240.77 7457.5,-3234.77 7457.5,-3228.77 7457.5,-3228.77 7457.5,-3184.77 7457.5,-3184.77 7457.5,-3178.77 7463.5,-3172.77 7469.5,-3172.77 7469.5,-3172.77 7938.5,-3172.77 7938.5,-3172.77 7944.5,-3172.77 7950.5,-3178.77 7950.5,-3184.77 7950.5,-3184.77 7950.5,-3228.77 7950.5,-3228.77 7950.5,-3234.77 7944.5,-3240.77 7938.5,-3240.77"/>
<text text-anchor="middle" x="7704" y="-3225.57" font-family="Times,serif" font-size="14.00">Expert 7 Layer 11 GPU 7</text>
<text text-anchor="middle" x="7704" y="-3210.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7704" y="-3195.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7704" y="-3180.57" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer11_gpu7 -->
<g id="node956" class="node">
<title>aggregate_layer11_gpu7</title>
<path fill="orange" stroke="black" d="M7957.29,-3136.77C7957.29,-3136.77 7470.19,-3136.77 7470.19,-3136.77 7464.19,-3136.77 7453.52,-3133 7448.85,-3129.23 7448.85,-3129.23 7336.06,-3038.3 7336.06,-3038.3 7331.38,-3034.53 7332.71,-3030.77 7338.71,-3030.77 7338.71,-3030.77 7825.81,-3030.77 7825.81,-3030.77 7831.81,-3030.77 7842.48,-3034.53 7847.15,-3038.3 7847.15,-3038.3 7959.94,-3129.23 7959.94,-3129.23 7964.62,-3133 7963.29,-3136.77 7957.29,-3136.77"/>
<text text-anchor="middle" x="7648" y="-3095.07" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 11 GPU 7</text>
<text text-anchor="middle" x="7648" y="-3080.07" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="7648" y="-3065.07" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer11_gpu7_expert7&#45;&gt;aggregate_layer11_gpu7 -->
<g id="edge1144" class="edge">
<title>expert_layer11_gpu7_expert7&#45;&gt;aggregate_layer11_gpu7</title>
<path fill="none" stroke="black" d="M7688.7,-3172.7C7684.86,-3164.41 7680.62,-3155.25 7676.37,-3146.06"/>
<polygon fill="black" stroke="black" points="7679.5,-3144.5 7672.12,-3136.89 7673.15,-3147.44 7679.5,-3144.5"/>
</g>
<!-- expert_layer11_gpu8_expert8 -->
<g id="node933" class="node">
<title>expert_layer11_gpu8_expert8</title>
<path fill="lightcoral" stroke="black" d="M8562.5,-3240.77C8562.5,-3240.77 8093.5,-3240.77 8093.5,-3240.77 8087.5,-3240.77 8081.5,-3234.77 8081.5,-3228.77 8081.5,-3228.77 8081.5,-3184.77 8081.5,-3184.77 8081.5,-3178.77 8087.5,-3172.77 8093.5,-3172.77 8093.5,-3172.77 8562.5,-3172.77 8562.5,-3172.77 8568.5,-3172.77 8574.5,-3178.77 8574.5,-3184.77 8574.5,-3184.77 8574.5,-3228.77 8574.5,-3228.77 8574.5,-3234.77 8568.5,-3240.77 8562.5,-3240.77"/>
<text text-anchor="middle" x="8328" y="-3225.57" font-family="Times,serif" font-size="14.00">Expert 8 Layer 11 GPU 8</text>
<text text-anchor="middle" x="8328" y="-3210.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8328" y="-3195.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8328" y="-3180.57" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer11_gpu8 -->
<g id="node958" class="node">
<title>aggregate_layer11_gpu8</title>
<path fill="orange" stroke="black" d="M8694.29,-3136.77C8694.29,-3136.77 8207.19,-3136.77 8207.19,-3136.77 8201.19,-3136.77 8190.52,-3133 8185.85,-3129.23 8185.85,-3129.23 8073.06,-3038.3 8073.06,-3038.3 8068.38,-3034.53 8069.71,-3030.77 8075.71,-3030.77 8075.71,-3030.77 8562.81,-3030.77 8562.81,-3030.77 8568.81,-3030.77 8579.48,-3034.53 8584.15,-3038.3 8584.15,-3038.3 8696.94,-3129.23 8696.94,-3129.23 8701.62,-3133 8700.29,-3136.77 8694.29,-3136.77"/>
<text text-anchor="middle" x="8385" y="-3095.07" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 11 GPU 8</text>
<text text-anchor="middle" x="8385" y="-3080.07" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="8385" y="-3065.07" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer11_gpu8_expert8&#45;&gt;aggregate_layer11_gpu8 -->
<g id="edge1145" class="edge">
<title>expert_layer11_gpu8_expert8&#45;&gt;aggregate_layer11_gpu8</title>
<path fill="none" stroke="black" d="M8343.58,-3172.7C8347.48,-3164.41 8351.8,-3155.25 8356.13,-3146.06"/>
<polygon fill="black" stroke="black" points="8359.35,-3147.43 8360.44,-3136.89 8353.02,-3144.45 8359.35,-3147.43"/>
</g>
<!-- expert_layer11_gpu9_expert9 -->
<g id="node934" class="node">
<title>expert_layer11_gpu9_expert9</title>
<path fill="lightcoral" stroke="black" d="M9299.5,-3240.77C9299.5,-3240.77 8830.5,-3240.77 8830.5,-3240.77 8824.5,-3240.77 8818.5,-3234.77 8818.5,-3228.77 8818.5,-3228.77 8818.5,-3184.77 8818.5,-3184.77 8818.5,-3178.77 8824.5,-3172.77 8830.5,-3172.77 8830.5,-3172.77 9299.5,-3172.77 9299.5,-3172.77 9305.5,-3172.77 9311.5,-3178.77 9311.5,-3184.77 9311.5,-3184.77 9311.5,-3228.77 9311.5,-3228.77 9311.5,-3234.77 9305.5,-3240.77 9299.5,-3240.77"/>
<text text-anchor="middle" x="9065" y="-3225.57" font-family="Times,serif" font-size="14.00">Expert 9 Layer 11 GPU 9</text>
<text text-anchor="middle" x="9065" y="-3210.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9065" y="-3195.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9065" y="-3180.57" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer11_gpu9 -->
<g id="node960" class="node">
<title>aggregate_layer11_gpu9</title>
<path fill="orange" stroke="black" d="M9544.29,-3136.77C9544.29,-3136.77 9057.19,-3136.77 9057.19,-3136.77 9051.19,-3136.77 9040.52,-3133 9035.85,-3129.23 9035.85,-3129.23 8923.06,-3038.3 8923.06,-3038.3 8918.38,-3034.53 8919.71,-3030.77 8925.71,-3030.77 8925.71,-3030.77 9412.81,-3030.77 9412.81,-3030.77 9418.81,-3030.77 9429.48,-3034.53 9434.15,-3038.3 9434.15,-3038.3 9546.94,-3129.23 9546.94,-3129.23 9551.62,-3133 9550.29,-3136.77 9544.29,-3136.77"/>
<text text-anchor="middle" x="9235" y="-3095.07" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 11 GPU 9</text>
<text text-anchor="middle" x="9235" y="-3080.07" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="9235" y="-3065.07" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer11_gpu9_expert9&#45;&gt;aggregate_layer11_gpu9 -->
<g id="edge1146" class="edge">
<title>expert_layer11_gpu9_expert9&#45;&gt;aggregate_layer11_gpu9</title>
<path fill="none" stroke="black" d="M9111.45,-3172.7C9124.44,-3163.46 9138.94,-3153.14 9153.32,-3142.9"/>
<polygon fill="black" stroke="black" points="9155.65,-3145.54 9161.76,-3136.89 9151.59,-3139.84 9155.65,-3145.54"/>
</g>
<!-- expert_layer11_gpu10_expert10 -->
<g id="node935" class="node">
<title>expert_layer11_gpu10_expert10</title>
<path fill="lightcoral" stroke="black" d="M10121.5,-3240.77C10121.5,-3240.77 9652.5,-3240.77 9652.5,-3240.77 9646.5,-3240.77 9640.5,-3234.77 9640.5,-3228.77 9640.5,-3228.77 9640.5,-3184.77 9640.5,-3184.77 9640.5,-3178.77 9646.5,-3172.77 9652.5,-3172.77 9652.5,-3172.77 10121.5,-3172.77 10121.5,-3172.77 10127.5,-3172.77 10133.5,-3178.77 10133.5,-3184.77 10133.5,-3184.77 10133.5,-3228.77 10133.5,-3228.77 10133.5,-3234.77 10127.5,-3240.77 10121.5,-3240.77"/>
<text text-anchor="middle" x="9887" y="-3225.57" font-family="Times,serif" font-size="14.00">Expert 10 Layer 11 GPU 10</text>
<text text-anchor="middle" x="9887" y="-3210.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9887" y="-3195.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9887" y="-3180.57" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer11_gpu10 -->
<g id="node962" class="node">
<title>aggregate_layer11_gpu10</title>
<path fill="orange" stroke="black" d="M10451.29,-3136.77C10451.29,-3136.77 9964.19,-3136.77 9964.19,-3136.77 9958.19,-3136.77 9947.52,-3133 9942.85,-3129.23 9942.85,-3129.23 9830.06,-3038.3 9830.06,-3038.3 9825.38,-3034.53 9826.71,-3030.77 9832.71,-3030.77 9832.71,-3030.77 10319.81,-3030.77 10319.81,-3030.77 10325.81,-3030.77 10336.48,-3034.53 10341.15,-3038.3 10341.15,-3038.3 10453.94,-3129.23 10453.94,-3129.23 10458.62,-3133 10457.29,-3136.77 10451.29,-3136.77"/>
<text text-anchor="middle" x="10142" y="-3095.07" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 11 GPU 10</text>
<text text-anchor="middle" x="10142" y="-3080.07" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="10142" y="-3065.07" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer11_gpu10_expert10&#45;&gt;aggregate_layer11_gpu10 -->
<g id="edge1147" class="edge">
<title>expert_layer11_gpu10_expert10&#45;&gt;aggregate_layer11_gpu10</title>
<path fill="none" stroke="black" d="M9956.68,-3172.7C9977.16,-3162.99 10000.16,-3152.07 10022.81,-3141.32"/>
<polygon fill="black" stroke="black" points="10024.61,-3144.34 10032.15,-3136.89 10021.61,-3138.02 10024.61,-3144.34"/>
</g>
<!-- expert_layer11_gpu11_expert11 -->
<g id="node936" class="node">
<title>expert_layer11_gpu11_expert11</title>
<path fill="lightcoral" stroke="black" d="M11000.5,-3240.77C11000.5,-3240.77 10531.5,-3240.77 10531.5,-3240.77 10525.5,-3240.77 10519.5,-3234.77 10519.5,-3228.77 10519.5,-3228.77 10519.5,-3184.77 10519.5,-3184.77 10519.5,-3178.77 10525.5,-3172.77 10531.5,-3172.77 10531.5,-3172.77 11000.5,-3172.77 11000.5,-3172.77 11006.5,-3172.77 11012.5,-3178.77 11012.5,-3184.77 11012.5,-3184.77 11012.5,-3228.77 11012.5,-3228.77 11012.5,-3234.77 11006.5,-3240.77 11000.5,-3240.77"/>
<text text-anchor="middle" x="10766" y="-3225.57" font-family="Times,serif" font-size="14.00">Expert 11 Layer 11 GPU 11</text>
<text text-anchor="middle" x="10766" y="-3210.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10766" y="-3195.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10766" y="-3180.57" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer11_gpu11 -->
<g id="node964" class="node">
<title>aggregate_layer11_gpu11</title>
<path fill="orange" stroke="black" d="M11387.29,-3136.77C11387.29,-3136.77 10900.19,-3136.77 10900.19,-3136.77 10894.19,-3136.77 10883.52,-3133 10878.85,-3129.23 10878.85,-3129.23 10766.06,-3038.3 10766.06,-3038.3 10761.38,-3034.53 10762.71,-3030.77 10768.71,-3030.77 10768.71,-3030.77 11255.81,-3030.77 11255.81,-3030.77 11261.81,-3030.77 11272.48,-3034.53 11277.15,-3038.3 11277.15,-3038.3 11389.94,-3129.23 11389.94,-3129.23 11394.62,-3133 11393.29,-3136.77 11387.29,-3136.77"/>
<text text-anchor="middle" x="11078" y="-3095.07" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 11 GPU 11</text>
<text text-anchor="middle" x="11078" y="-3080.07" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="11078" y="-3065.07" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer11_gpu11_expert11&#45;&gt;aggregate_layer11_gpu11 -->
<g id="edge1148" class="edge">
<title>expert_layer11_gpu11_expert11&#45;&gt;aggregate_layer11_gpu11</title>
<path fill="none" stroke="black" d="M10851.26,-3172.7C10876.95,-3162.74 10905.89,-3151.51 10934.28,-3140.5"/>
<polygon fill="black" stroke="black" points="10935.83,-3143.66 10943.89,-3136.78 10933.3,-3137.13 10935.83,-3143.66"/>
</g>
<!-- expert_layer11_gpu12_expert12 -->
<g id="node937" class="node">
<title>expert_layer11_gpu12_expert12</title>
<path fill="lightcoral" stroke="black" d="M11893.5,-3240.77C11893.5,-3240.77 11424.5,-3240.77 11424.5,-3240.77 11418.5,-3240.77 11412.5,-3234.77 11412.5,-3228.77 11412.5,-3228.77 11412.5,-3184.77 11412.5,-3184.77 11412.5,-3178.77 11418.5,-3172.77 11424.5,-3172.77 11424.5,-3172.77 11893.5,-3172.77 11893.5,-3172.77 11899.5,-3172.77 11905.5,-3178.77 11905.5,-3184.77 11905.5,-3184.77 11905.5,-3228.77 11905.5,-3228.77 11905.5,-3234.77 11899.5,-3240.77 11893.5,-3240.77"/>
<text text-anchor="middle" x="11659" y="-3225.57" font-family="Times,serif" font-size="14.00">Expert 12 Layer 11 GPU 12</text>
<text text-anchor="middle" x="11659" y="-3210.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11659" y="-3195.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11659" y="-3180.57" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer11_gpu12 -->
<g id="node966" class="node">
<title>aggregate_layer11_gpu12</title>
<path fill="orange" stroke="black" d="M12294.29,-3136.77C12294.29,-3136.77 11807.19,-3136.77 11807.19,-3136.77 11801.19,-3136.77 11790.52,-3133 11785.85,-3129.23 11785.85,-3129.23 11673.06,-3038.3 11673.06,-3038.3 11668.38,-3034.53 11669.71,-3030.77 11675.71,-3030.77 11675.71,-3030.77 12162.81,-3030.77 12162.81,-3030.77 12168.81,-3030.77 12179.48,-3034.53 12184.15,-3038.3 12184.15,-3038.3 12296.94,-3129.23 12296.94,-3129.23 12301.62,-3133 12300.29,-3136.77 12294.29,-3136.77"/>
<text text-anchor="middle" x="11985" y="-3095.07" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 11 GPU 12</text>
<text text-anchor="middle" x="11985" y="-3080.07" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="11985" y="-3065.07" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer11_gpu12_expert12&#45;&gt;aggregate_layer11_gpu12 -->
<g id="edge1149" class="edge">
<title>expert_layer11_gpu12_expert12&#45;&gt;aggregate_layer11_gpu12</title>
<path fill="none" stroke="black" d="M11748.08,-3172.7C11775.04,-3162.7 11805.43,-3151.42 11835.22,-3140.36"/>
<polygon fill="black" stroke="black" points="11836.71,-3143.54 11844.87,-3136.78 11834.28,-3136.98 11836.71,-3143.54"/>
</g>
<!-- expert_layer11_gpu13_expert13 -->
<g id="node938" class="node">
<title>expert_layer11_gpu13_expert13</title>
<path fill="lightcoral" stroke="black" d="M12731.5,-3240.77C12731.5,-3240.77 12262.5,-3240.77 12262.5,-3240.77 12256.5,-3240.77 12250.5,-3234.77 12250.5,-3228.77 12250.5,-3228.77 12250.5,-3184.77 12250.5,-3184.77 12250.5,-3178.77 12256.5,-3172.77 12262.5,-3172.77 12262.5,-3172.77 12731.5,-3172.77 12731.5,-3172.77 12737.5,-3172.77 12743.5,-3178.77 12743.5,-3184.77 12743.5,-3184.77 12743.5,-3228.77 12743.5,-3228.77 12743.5,-3234.77 12737.5,-3240.77 12731.5,-3240.77"/>
<text text-anchor="middle" x="12497" y="-3225.57" font-family="Times,serif" font-size="14.00">Expert 13 Layer 11 GPU 13</text>
<text text-anchor="middle" x="12497" y="-3210.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12497" y="-3195.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12497" y="-3180.57" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer11_gpu13 -->
<g id="node968" class="node">
<title>aggregate_layer11_gpu13</title>
<path fill="orange" stroke="black" d="M13078.29,-3136.77C13078.29,-3136.77 12591.19,-3136.77 12591.19,-3136.77 12585.19,-3136.77 12574.52,-3133 12569.85,-3129.23 12569.85,-3129.23 12457.06,-3038.3 12457.06,-3038.3 12452.38,-3034.53 12453.71,-3030.77 12459.71,-3030.77 12459.71,-3030.77 12946.81,-3030.77 12946.81,-3030.77 12952.81,-3030.77 12963.48,-3034.53 12968.15,-3038.3 12968.15,-3038.3 13080.94,-3129.23 13080.94,-3129.23 13085.62,-3133 13084.29,-3136.77 13078.29,-3136.77"/>
<text text-anchor="middle" x="12769" y="-3095.07" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 11 GPU 13</text>
<text text-anchor="middle" x="12769" y="-3080.07" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="12769" y="-3065.07" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer11_gpu13_expert13&#45;&gt;aggregate_layer11_gpu13 -->
<g id="edge1150" class="edge">
<title>expert_layer11_gpu13_expert13&#45;&gt;aggregate_layer11_gpu13</title>
<path fill="none" stroke="black" d="M12571.33,-3172.7C12593.43,-3162.87 12618.3,-3151.81 12642.74,-3140.93"/>
<polygon fill="black" stroke="black" points="12644.37,-3144.04 12652.08,-3136.78 12641.52,-3137.64 12644.37,-3144.04"/>
</g>
<!-- expert_layer11_gpu14_expert14 -->
<g id="node939" class="node">
<title>expert_layer11_gpu14_expert14</title>
<path fill="lightcoral" stroke="black" d="M13511.5,-3240.77C13511.5,-3240.77 13042.5,-3240.77 13042.5,-3240.77 13036.5,-3240.77 13030.5,-3234.77 13030.5,-3228.77 13030.5,-3228.77 13030.5,-3184.77 13030.5,-3184.77 13030.5,-3178.77 13036.5,-3172.77 13042.5,-3172.77 13042.5,-3172.77 13511.5,-3172.77 13511.5,-3172.77 13517.5,-3172.77 13523.5,-3178.77 13523.5,-3184.77 13523.5,-3184.77 13523.5,-3228.77 13523.5,-3228.77 13523.5,-3234.77 13517.5,-3240.77 13511.5,-3240.77"/>
<text text-anchor="middle" x="13277" y="-3225.57" font-family="Times,serif" font-size="14.00">Expert 14 Layer 11 GPU 14</text>
<text text-anchor="middle" x="13277" y="-3210.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="13277" y="-3195.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="13277" y="-3180.57" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer11_gpu14 -->
<g id="node970" class="node">
<title>aggregate_layer11_gpu14</title>
<path fill="orange" stroke="black" d="M13800.29,-3136.77C13800.29,-3136.77 13313.19,-3136.77 13313.19,-3136.77 13307.19,-3136.77 13296.52,-3133 13291.85,-3129.23 13291.85,-3129.23 13179.06,-3038.3 13179.06,-3038.3 13174.38,-3034.53 13175.71,-3030.77 13181.71,-3030.77 13181.71,-3030.77 13668.81,-3030.77 13668.81,-3030.77 13674.81,-3030.77 13685.48,-3034.53 13690.15,-3038.3 13690.15,-3038.3 13802.94,-3129.23 13802.94,-3129.23 13807.62,-3133 13806.29,-3136.77 13800.29,-3136.77"/>
<text text-anchor="middle" x="13491" y="-3095.07" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 11 GPU 14</text>
<text text-anchor="middle" x="13491" y="-3080.07" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="13491" y="-3065.07" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer11_gpu14_expert14&#45;&gt;aggregate_layer11_gpu14 -->
<g id="edge1151" class="edge">
<title>expert_layer11_gpu14_expert14&#45;&gt;aggregate_layer11_gpu14</title>
<path fill="none" stroke="black" d="M13335.48,-3172.7C13352.36,-3163.16 13371.28,-3152.46 13389.96,-3141.9"/>
<polygon fill="black" stroke="black" points="13391.83,-3144.86 13398.81,-3136.89 13388.38,-3138.77 13391.83,-3144.86"/>
</g>
<!-- expert_layer11_gpu15_expert15 -->
<g id="node940" class="node">
<title>expert_layer11_gpu15_expert15</title>
<path fill="lightcoral" stroke="black" d="M14496.5,-3240.77C14496.5,-3240.77 14027.5,-3240.77 14027.5,-3240.77 14021.5,-3240.77 14015.5,-3234.77 14015.5,-3228.77 14015.5,-3228.77 14015.5,-3184.77 14015.5,-3184.77 14015.5,-3178.77 14021.5,-3172.77 14027.5,-3172.77 14027.5,-3172.77 14496.5,-3172.77 14496.5,-3172.77 14502.5,-3172.77 14508.5,-3178.77 14508.5,-3184.77 14508.5,-3184.77 14508.5,-3228.77 14508.5,-3228.77 14508.5,-3234.77 14502.5,-3240.77 14496.5,-3240.77"/>
<text text-anchor="middle" x="14262" y="-3225.57" font-family="Times,serif" font-size="14.00">Expert 15 Layer 11 GPU 15</text>
<text text-anchor="middle" x="14262" y="-3210.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14262" y="-3195.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14262" y="-3180.57" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer11_gpu15 -->
<g id="node972" class="node">
<title>aggregate_layer11_gpu15</title>
<path fill="orange" stroke="black" d="M14989.29,-3136.77C14989.29,-3136.77 14502.19,-3136.77 14502.19,-3136.77 14496.19,-3136.77 14485.52,-3133 14480.85,-3129.23 14480.85,-3129.23 14368.06,-3038.3 14368.06,-3038.3 14363.38,-3034.53 14364.71,-3030.77 14370.71,-3030.77 14370.71,-3030.77 14857.81,-3030.77 14857.81,-3030.77 14863.81,-3030.77 14874.48,-3034.53 14879.15,-3038.3 14879.15,-3038.3 14991.94,-3129.23 14991.94,-3129.23 14996.62,-3133 14995.29,-3136.77 14989.29,-3136.77"/>
<text text-anchor="middle" x="14680" y="-3095.07" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 11 GPU 15</text>
<text text-anchor="middle" x="14680" y="-3080.07" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="14680" y="-3065.07" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer11_gpu15_expert15&#45;&gt;aggregate_layer11_gpu15 -->
<g id="edge1152" class="edge">
<title>expert_layer11_gpu15_expert15&#45;&gt;aggregate_layer11_gpu15</title>
<path fill="none" stroke="black" d="M14376.22,-3172.7C14411.54,-3162.48 14451.44,-3150.93 14490.43,-3139.64"/>
<polygon fill="black" stroke="black" points="14491.69,-3142.92 14500.32,-3136.78 14489.74,-3136.2 14491.69,-3142.92"/>
</g>
<!-- comm_layer11 -->
<g id="node973" class="node">
<title>comm_layer11</title>
<ellipse fill="lightpink" stroke="black" cx="8016" cy="-3314.24" rx="243.49" ry="37.45"/>
<text text-anchor="middle" x="8016" y="-3325.54" font-family="Times,serif" font-size="14.00">Cross&#45;GPU Communication Layer 11</text>
<text text-anchor="middle" x="8016" y="-3310.54" font-family="Times,serif" font-size="14.00">Input: Tokens from routing decisions</text>
<text text-anchor="middle" x="8016" y="-3295.54" font-family="Times,serif" font-size="14.00">Output: Tokens delivered to destination GPUs</text>
</g>
<!-- route_layer11_gpu0&#45;&gt;comm_layer11 -->
<g id="edge1105" class="edge">
<title>route_layer11_gpu0&#45;&gt;comm_layer11</title>
<path fill="none" stroke="black" d="M1282.63,-3424.73C1492.07,-3412.58 1801.18,-3396.15 2071,-3387.72 4275.12,-3318.89 6940.79,-3314.46 7762.6,-3314.89"/>
<polygon fill="black" stroke="black" points="7762.78,-3318.39 7772.78,-3314.89 7762.78,-3311.39 7762.78,-3318.39"/>
</g>
<!-- mha_layer12_gpu0 -->
<g id="node974" class="node">
<title>mha_layer12_gpu0</title>
<path fill="lightblue" stroke="black" d="M1134,-2994.77C1134,-2994.77 686,-2994.77 686,-2994.77 680,-2994.77 674,-2988.77 674,-2982.77 674,-2982.77 674,-2953.77 674,-2953.77 674,-2947.77 680,-2941.77 686,-2941.77 686,-2941.77 1134,-2941.77 1134,-2941.77 1140,-2941.77 1146,-2947.77 1146,-2953.77 1146,-2953.77 1146,-2982.77 1146,-2982.77 1146,-2988.77 1140,-2994.77 1134,-2994.77"/>
<text text-anchor="middle" x="910" y="-2979.57" font-family="Times,serif" font-size="14.00">MHA Layer 12 GPU 0</text>
<text text-anchor="middle" x="910" y="-2964.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="910" y="-2949.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer11_gpu0&#45;&gt;mha_layer12_gpu0 -->
<g id="edge1153" class="edge">
<title>aggregate_layer11_gpu0&#45;&gt;mha_layer12_gpu0</title>
<path fill="none" stroke="black" d="M1248.57,-3030.75C1183.73,-3018.98 1117.39,-3006.93 1060.8,-2996.65"/>
<polygon fill="black" stroke="black" points="1061.18,-2993.16 1050.72,-2994.82 1059.93,-3000.05 1061.18,-2993.16"/>
</g>
<!-- route_layer11_gpu1&#45;&gt;comm_layer11 -->
<g id="edge1106" class="edge">
<title>route_layer11_gpu1&#45;&gt;comm_layer11</title>
<path fill="none" stroke="black" d="M2652.35,-3418.24C2785.08,-3407.13 2953.61,-3394.5 3104,-3387.72 4024.82,-3346.22 6892.52,-3323.13 7762.95,-3316.95"/>
<polygon fill="black" stroke="black" points="7763.12,-3320.45 7773.1,-3316.88 7763.07,-3313.45 7763.12,-3320.45"/>
</g>
<!-- mha_layer12_gpu1 -->
<g id="node975" class="node">
<title>mha_layer12_gpu1</title>
<path fill="lightblue" stroke="black" d="M2392,-2994.77C2392,-2994.77 1944,-2994.77 1944,-2994.77 1938,-2994.77 1932,-2988.77 1932,-2982.77 1932,-2982.77 1932,-2953.77 1932,-2953.77 1932,-2947.77 1938,-2941.77 1944,-2941.77 1944,-2941.77 2392,-2941.77 2392,-2941.77 2398,-2941.77 2404,-2947.77 2404,-2953.77 2404,-2953.77 2404,-2982.77 2404,-2982.77 2404,-2988.77 2398,-2994.77 2392,-2994.77"/>
<text text-anchor="middle" x="2168" y="-2979.57" font-family="Times,serif" font-size="14.00">MHA Layer 12 GPU 1</text>
<text text-anchor="middle" x="2168" y="-2964.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2168" y="-2949.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer11_gpu1&#45;&gt;mha_layer12_gpu1 -->
<g id="edge1154" class="edge">
<title>aggregate_layer11_gpu1&#45;&gt;mha_layer12_gpu1</title>
<path fill="none" stroke="black" d="M2383.6,-3030.75C2343.59,-3019.34 2302.69,-3007.68 2267.41,-2997.61"/>
<polygon fill="black" stroke="black" points="2268.19,-2994.2 2257.61,-2994.82 2266.27,-3000.93 2268.19,-2994.2"/>
</g>
<!-- route_layer11_gpu2&#45;&gt;comm_layer11 -->
<g id="edge1107" class="edge">
<title>route_layer11_gpu2&#45;&gt;comm_layer11</title>
<path fill="none" stroke="black" d="M3677.89,-3412.45C3767.1,-3402.95 3870.19,-3393.28 3964,-3387.72 4708.17,-3343.64 6996.77,-3322.88 7763.03,-3317.03"/>
<polygon fill="black" stroke="black" points="7763.12,-3320.53 7773.09,-3316.95 7763.06,-3313.53 7763.12,-3320.53"/>
</g>
<!-- mha_layer12_gpu2 -->
<g id="node976" class="node">
<title>mha_layer12_gpu2</title>
<path fill="lightblue" stroke="black" d="M3166,-2994.77C3166,-2994.77 2718,-2994.77 2718,-2994.77 2712,-2994.77 2706,-2988.77 2706,-2982.77 2706,-2982.77 2706,-2953.77 2706,-2953.77 2706,-2947.77 2712,-2941.77 2718,-2941.77 2718,-2941.77 3166,-2941.77 3166,-2941.77 3172,-2941.77 3178,-2947.77 3178,-2953.77 3178,-2953.77 3178,-2982.77 3178,-2982.77 3178,-2988.77 3172,-2994.77 3166,-2994.77"/>
<text text-anchor="middle" x="2942" y="-2979.57" font-family="Times,serif" font-size="14.00">MHA Layer 12 GPU 2</text>
<text text-anchor="middle" x="2942" y="-2964.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2942" y="-2949.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer11_gpu2&#45;&gt;mha_layer12_gpu2 -->
<g id="edge1155" class="edge">
<title>aggregate_layer11_gpu2&#45;&gt;mha_layer12_gpu2</title>
<path fill="none" stroke="black" d="M3362.47,-3033.93C3278.73,-3021.05 3191.39,-3007.62 3118.15,-2996.36"/>
<polygon fill="black" stroke="black" points="3118.33,-2992.84 3107.91,-2994.78 3117.26,-2999.76 3118.33,-2992.84"/>
</g>
<!-- route_layer11_gpu3&#45;&gt;comm_layer11 -->
<g id="edge1108" class="edge">
<title>route_layer11_gpu3&#45;&gt;comm_layer11</title>
<path fill="none" stroke="black" d="M4532.44,-3408.35C4598.53,-3400.26 4671.06,-3392.5 4738,-3387.72 5324.77,-3345.86 7100.78,-3324.35 7763.26,-3317.62"/>
<polygon fill="black" stroke="black" points="7763.45,-3321.11 7773.41,-3317.51 7763.38,-3314.11 7763.45,-3321.11"/>
</g>
<!-- mha_layer12_gpu3 -->
<g id="node977" class="node">
<title>mha_layer12_gpu3</title>
<path fill="lightblue" stroke="black" d="M3848,-2994.77C3848,-2994.77 3400,-2994.77 3400,-2994.77 3394,-2994.77 3388,-2988.77 3388,-2982.77 3388,-2982.77 3388,-2953.77 3388,-2953.77 3388,-2947.77 3394,-2941.77 3400,-2941.77 3400,-2941.77 3848,-2941.77 3848,-2941.77 3854,-2941.77 3860,-2947.77 3860,-2953.77 3860,-2953.77 3860,-2982.77 3860,-2982.77 3860,-2988.77 3854,-2994.77 3848,-2994.77"/>
<text text-anchor="middle" x="3624" y="-2979.57" font-family="Times,serif" font-size="14.00">MHA Layer 12 GPU 3</text>
<text text-anchor="middle" x="3624" y="-2964.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3624" y="-2949.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer11_gpu3&#45;&gt;mha_layer12_gpu3 -->
<g id="edge1156" class="edge">
<title>aggregate_layer11_gpu3&#45;&gt;mha_layer12_gpu3</title>
<path fill="none" stroke="black" d="M4277.49,-3046.93C4138.58,-3030.42 3976.57,-3011.17 3848.62,-2995.96"/>
<polygon fill="black" stroke="black" points="3849.03,-2992.49 3838.69,-2994.78 3848.2,-2999.44 3849.03,-2992.49"/>
</g>
<!-- route_layer11_gpu4&#45;&gt;comm_layer11 -->
<g id="edge1109" class="edge">
<title>route_layer11_gpu4&#45;&gt;comm_layer11</title>
<path fill="none" stroke="black" d="M5303.36,-3405.9C5357.43,-3398.77 5415.2,-3392.09 5469,-3387.72 5909.21,-3351.98 7212.29,-3327.9 7764.34,-3319.03"/>
<polygon fill="black" stroke="black" points="7764.48,-3322.53 7774.42,-3318.87 7764.37,-3315.53 7764.48,-3322.53"/>
</g>
<!-- mha_layer12_gpu4 -->
<g id="node978" class="node">
<title>mha_layer12_gpu4</title>
<path fill="lightblue" stroke="black" d="M5035,-2994.77C5035,-2994.77 4587,-2994.77 4587,-2994.77 4581,-2994.77 4575,-2988.77 4575,-2982.77 4575,-2982.77 4575,-2953.77 4575,-2953.77 4575,-2947.77 4581,-2941.77 4587,-2941.77 4587,-2941.77 5035,-2941.77 5035,-2941.77 5041,-2941.77 5047,-2947.77 5047,-2953.77 5047,-2953.77 5047,-2982.77 5047,-2982.77 5047,-2988.77 5041,-2994.77 5035,-2994.77"/>
<text text-anchor="middle" x="4811" y="-2979.57" font-family="Times,serif" font-size="14.00">MHA Layer 12 GPU 4</text>
<text text-anchor="middle" x="4811" y="-2964.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4811" y="-2949.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer11_gpu4&#45;&gt;mha_layer12_gpu4 -->
<g id="edge1157" class="edge">
<title>aggregate_layer11_gpu4&#45;&gt;mha_layer12_gpu4</title>
<path fill="none" stroke="black" d="M5166.36,-3030.75C5098.17,-3018.95 5028.38,-3006.88 4968.92,-2996.59"/>
<polygon fill="black" stroke="black" points="4969.15,-2993.08 4958.7,-2994.82 4967.96,-2999.98 4969.15,-2993.08"/>
</g>
<!-- route_layer11_gpu5&#45;&gt;comm_layer11 -->
<g id="edge1110" class="edge">
<title>route_layer11_gpu5&#45;&gt;comm_layer11</title>
<path fill="none" stroke="black" d="M6049.84,-3417.74C6165.34,-3407.56 6306.35,-3395.93 6433,-3387.72 6905.57,-3357.1 7458.32,-3334.89 7769.77,-3323.62"/>
<polygon fill="black" stroke="black" points="7769.97,-3327.12 7779.84,-3323.26 7769.72,-3320.12 7769.97,-3327.12"/>
</g>
<!-- mha_layer12_gpu5 -->
<g id="node979" class="node">
<title>mha_layer12_gpu5</title>
<path fill="lightblue" stroke="black" d="M6098,-2994.77C6098,-2994.77 5650,-2994.77 5650,-2994.77 5644,-2994.77 5638,-2988.77 5638,-2982.77 5638,-2982.77 5638,-2953.77 5638,-2953.77 5638,-2947.77 5644,-2941.77 5650,-2941.77 5650,-2941.77 6098,-2941.77 6098,-2941.77 6104,-2941.77 6110,-2947.77 6110,-2953.77 6110,-2953.77 6110,-2982.77 6110,-2982.77 6110,-2988.77 6104,-2994.77 6098,-2994.77"/>
<text text-anchor="middle" x="5874" y="-2979.57" font-family="Times,serif" font-size="14.00">MHA Layer 12 GPU 5</text>
<text text-anchor="middle" x="5874" y="-2964.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5874" y="-2949.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer11_gpu5&#45;&gt;mha_layer12_gpu5 -->
<g id="edge1158" class="edge">
<title>aggregate_layer11_gpu5&#45;&gt;mha_layer12_gpu5</title>
<path fill="none" stroke="black" d="M6072.81,-3030.75C6036.23,-3019.44 5998.84,-3007.88 5966.5,-2997.87"/>
<polygon fill="black" stroke="black" points="5967.22,-2994.43 5956.63,-2994.82 5965.15,-3001.12 5967.22,-2994.43"/>
</g>
<!-- route_layer11_gpu6&#45;&gt;comm_layer11 -->
<g id="edge1111" class="edge">
<title>route_layer11_gpu6&#45;&gt;comm_layer11</title>
<path fill="none" stroke="black" d="M7011.87,-3416.12C7240.44,-3393.16 7584.62,-3358.58 7804.78,-3336.46"/>
<polygon fill="black" stroke="black" points="7805.24,-3339.94 7814.84,-3335.45 7804.54,-3332.97 7805.24,-3339.94"/>
</g>
<!-- mha_layer12_gpu6 -->
<g id="node980" class="node">
<title>mha_layer12_gpu6</title>
<path fill="lightblue" stroke="black" d="M7032,-2994.77C7032,-2994.77 6584,-2994.77 6584,-2994.77 6578,-2994.77 6572,-2988.77 6572,-2982.77 6572,-2982.77 6572,-2953.77 6572,-2953.77 6572,-2947.77 6578,-2941.77 6584,-2941.77 6584,-2941.77 7032,-2941.77 7032,-2941.77 7038,-2941.77 7044,-2947.77 7044,-2953.77 7044,-2953.77 7044,-2982.77 7044,-2982.77 7044,-2988.77 7038,-2994.77 7032,-2994.77"/>
<text text-anchor="middle" x="6808" y="-2979.57" font-family="Times,serif" font-size="14.00">MHA Layer 12 GPU 6</text>
<text text-anchor="middle" x="6808" y="-2964.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6808" y="-2949.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer11_gpu6&#45;&gt;mha_layer12_gpu6 -->
<g id="edge1159" class="edge">
<title>aggregate_layer11_gpu6&#45;&gt;mha_layer12_gpu6</title>
<path fill="none" stroke="black" d="M6889.69,-3030.67C6876.21,-3020.53 6862.46,-3010.2 6850.19,-3000.98"/>
<polygon fill="black" stroke="black" points="6852.04,-2997.99 6841.94,-2994.78 6847.83,-3003.59 6852.04,-2997.99"/>
</g>
<!-- route_layer11_gpu7&#45;&gt;comm_layer11 -->
<g id="edge1112" class="edge">
<title>route_layer11_gpu7&#45;&gt;comm_layer11</title>
<path fill="none" stroke="black" d="M7815.89,-3387.65C7848.54,-3375.84 7882.57,-3363.52 7913.12,-3352.47"/>
<polygon fill="black" stroke="black" points="7914.69,-3355.62 7922.91,-3348.93 7912.31,-3349.04 7914.69,-3355.62"/>
</g>
<!-- mha_layer12_gpu7 -->
<g id="node981" class="node">
<title>mha_layer12_gpu7</title>
<path fill="lightblue" stroke="black" d="M7721,-2994.77C7721,-2994.77 7273,-2994.77 7273,-2994.77 7267,-2994.77 7261,-2988.77 7261,-2982.77 7261,-2982.77 7261,-2953.77 7261,-2953.77 7261,-2947.77 7267,-2941.77 7273,-2941.77 7273,-2941.77 7721,-2941.77 7721,-2941.77 7727,-2941.77 7733,-2947.77 7733,-2953.77 7733,-2953.77 7733,-2982.77 7733,-2982.77 7733,-2988.77 7727,-2994.77 7721,-2994.77"/>
<text text-anchor="middle" x="7497" y="-2979.57" font-family="Times,serif" font-size="14.00">MHA Layer 12 GPU 7</text>
<text text-anchor="middle" x="7497" y="-2964.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7497" y="-2949.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer11_gpu7&#45;&gt;mha_layer12_gpu7 -->
<g id="edge1160" class="edge">
<title>aggregate_layer11_gpu7&#45;&gt;mha_layer12_gpu7</title>
<path fill="none" stroke="black" d="M7578.69,-3030.67C7565.21,-3020.53 7551.46,-3010.2 7539.19,-3000.98"/>
<polygon fill="black" stroke="black" points="7541.04,-2997.99 7530.94,-2994.78 7536.83,-3003.59 7541.04,-2997.99"/>
</g>
<!-- route_layer11_gpu8&#45;&gt;comm_layer11 -->
<g id="edge1113" class="edge">
<title>route_layer11_gpu8&#45;&gt;comm_layer11</title>
<path fill="none" stroke="black" d="M8296.38,-3387.65C8246.27,-3374.71 8193.83,-3361.17 8148.03,-3349.34"/>
<polygon fill="black" stroke="black" points="8148.62,-3345.88 8138.06,-3346.77 8146.87,-3352.66 8148.62,-3345.88"/>
</g>
<!-- mha_layer12_gpu8 -->
<g id="node982" class="node">
<title>mha_layer12_gpu8</title>
<path fill="lightblue" stroke="black" d="M8631,-2994.77C8631,-2994.77 8183,-2994.77 8183,-2994.77 8177,-2994.77 8171,-2988.77 8171,-2982.77 8171,-2982.77 8171,-2953.77 8171,-2953.77 8171,-2947.77 8177,-2941.77 8183,-2941.77 8183,-2941.77 8631,-2941.77 8631,-2941.77 8637,-2941.77 8643,-2947.77 8643,-2953.77 8643,-2953.77 8643,-2982.77 8643,-2982.77 8643,-2988.77 8637,-2994.77 8631,-2994.77"/>
<text text-anchor="middle" x="8407" y="-2979.57" font-family="Times,serif" font-size="14.00">MHA Layer 12 GPU 8</text>
<text text-anchor="middle" x="8407" y="-2964.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8407" y="-2949.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer11_gpu8&#45;&gt;mha_layer12_gpu8 -->
<g id="edge1161" class="edge">
<title>aggregate_layer11_gpu8&#45;&gt;mha_layer12_gpu8</title>
<path fill="none" stroke="black" d="M8395.1,-3030.67C8396.8,-3021.9 8398.53,-3012.98 8400.12,-3004.76"/>
<polygon fill="black" stroke="black" points="8403.59,-3005.26 8402.05,-2994.78 8396.72,-3003.93 8403.59,-3005.26"/>
</g>
<!-- route_layer11_gpu9&#45;&gt;comm_layer11 -->
<g id="edge1114" class="edge">
<title>route_layer11_gpu9&#45;&gt;comm_layer11</title>
<path fill="none" stroke="black" d="M9087.73,-3410.55C9007.78,-3403.01 8921.66,-3394.97 8842,-3387.72 8636.63,-3369.02 8402.46,-3348.55 8236.03,-3334.15"/>
<polygon fill="black" stroke="black" points="8235.93,-3330.63 8225.67,-3333.26 8235.33,-3337.61 8235.93,-3330.63"/>
</g>
<!-- mha_layer12_gpu9 -->
<g id="node983" class="node">
<title>mha_layer12_gpu9</title>
<path fill="lightblue" stroke="black" d="M9538,-2994.77C9538,-2994.77 9090,-2994.77 9090,-2994.77 9084,-2994.77 9078,-2988.77 9078,-2982.77 9078,-2982.77 9078,-2953.77 9078,-2953.77 9078,-2947.77 9084,-2941.77 9090,-2941.77 9090,-2941.77 9538,-2941.77 9538,-2941.77 9544,-2941.77 9550,-2947.77 9550,-2953.77 9550,-2953.77 9550,-2982.77 9550,-2982.77 9550,-2988.77 9544,-2994.77 9538,-2994.77"/>
<text text-anchor="middle" x="9314" y="-2979.57" font-family="Times,serif" font-size="14.00">MHA Layer 12 GPU 9</text>
<text text-anchor="middle" x="9314" y="-2964.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9314" y="-2949.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer11_gpu9&#45;&gt;mha_layer12_gpu9 -->
<g id="edge1162" class="edge">
<title>aggregate_layer11_gpu9&#45;&gt;mha_layer12_gpu9</title>
<path fill="none" stroke="black" d="M9271.26,-3030.67C9277.77,-3021.31 9284.4,-3011.79 9290.43,-3003.12"/>
<polygon fill="black" stroke="black" points="9293.4,-3004.99 9296.24,-2994.78 9287.66,-3000.99 9293.4,-3004.99"/>
</g>
<!-- route_layer11_gpu10&#45;&gt;comm_layer11 -->
<g id="edge1115" class="edge">
<title>route_layer11_gpu10&#45;&gt;comm_layer11</title>
<path fill="none" stroke="black" d="M10015.56,-3409.77C9925.85,-3401.74 9827.55,-3393.65 9737,-3387.72 9213.68,-3353.46 8599.71,-3332.13 8264.88,-3322.09"/>
<polygon fill="black" stroke="black" points="8264.67,-3318.58 8254.57,-3321.78 8264.46,-3325.58 8264.67,-3318.58"/>
</g>
<!-- mha_layer12_gpu10 -->
<g id="node984" class="node">
<title>mha_layer12_gpu10</title>
<path fill="lightblue" stroke="black" d="M10474,-2994.77C10474,-2994.77 10026,-2994.77 10026,-2994.77 10020,-2994.77 10014,-2988.77 10014,-2982.77 10014,-2982.77 10014,-2953.77 10014,-2953.77 10014,-2947.77 10020,-2941.77 10026,-2941.77 10026,-2941.77 10474,-2941.77 10474,-2941.77 10480,-2941.77 10486,-2947.77 10486,-2953.77 10486,-2953.77 10486,-2982.77 10486,-2982.77 10486,-2988.77 10480,-2994.77 10474,-2994.77"/>
<text text-anchor="middle" x="10250" y="-2979.57" font-family="Times,serif" font-size="14.00">MHA Layer 12 GPU 10</text>
<text text-anchor="middle" x="10250" y="-2964.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10250" y="-2949.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer11_gpu10&#45;&gt;mha_layer12_gpu10 -->
<g id="edge1163" class="edge">
<title>aggregate_layer11_gpu10&#45;&gt;mha_layer12_gpu10</title>
<path fill="none" stroke="black" d="M10191.57,-3030.67C10200.85,-3020.92 10210.29,-3011 10218.81,-3002.05"/>
<polygon fill="black" stroke="black" points="10221.36,-3004.44 10225.72,-2994.78 10216.29,-2999.61 10221.36,-3004.44"/>
</g>
<!-- route_layer11_gpu11&#45;&gt;comm_layer11 -->
<g id="edge1116" class="edge">
<title>route_layer11_gpu11&#45;&gt;comm_layer11</title>
<path fill="none" stroke="black" d="M10962.49,-3409.78C10867.54,-3401.45 10762.51,-3393.2 10666,-3387.72 9786.29,-3337.8 8740.29,-3322.01 8268.71,-3317.22"/>
<polygon fill="black" stroke="black" points="8268.75,-3313.72 8258.71,-3317.12 8268.68,-3320.72 8268.75,-3313.72"/>
</g>
<!-- mha_layer12_gpu11 -->
<g id="node985" class="node">
<title>mha_layer12_gpu11</title>
<path fill="lightblue" stroke="black" d="M11424,-2994.77C11424,-2994.77 10976,-2994.77 10976,-2994.77 10970,-2994.77 10964,-2988.77 10964,-2982.77 10964,-2982.77 10964,-2953.77 10964,-2953.77 10964,-2947.77 10970,-2941.77 10976,-2941.77 10976,-2941.77 11424,-2941.77 11424,-2941.77 11430,-2941.77 11436,-2947.77 11436,-2953.77 11436,-2953.77 11436,-2982.77 11436,-2982.77 11436,-2988.77 11430,-2994.77 11424,-2994.77"/>
<text text-anchor="middle" x="11200" y="-2979.57" font-family="Times,serif" font-size="14.00">MHA Layer 12 GPU 11</text>
<text text-anchor="middle" x="11200" y="-2964.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11200" y="-2949.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer11_gpu11&#45;&gt;mha_layer12_gpu11 -->
<g id="edge1164" class="edge">
<title>aggregate_layer11_gpu11&#45;&gt;mha_layer12_gpu11</title>
<path fill="none" stroke="black" d="M11134,-3030.67C11144.58,-3020.83 11155.36,-3010.8 11165.06,-3001.78"/>
<polygon fill="black" stroke="black" points="11167.64,-3004.15 11172.58,-2994.78 11162.87,-2999.03 11167.64,-3004.15"/>
</g>
<!-- route_layer11_gpu12&#45;&gt;comm_layer11 -->
<g id="edge1117" class="edge">
<title>route_layer11_gpu12&#45;&gt;comm_layer11</title>
<path fill="none" stroke="black" d="M11917.35,-3409.71C11820.12,-3401.25 11712.14,-3392.93 11613,-3387.72 10359.64,-3321.83 8857.73,-3314.72 8269.66,-3314.71"/>
<polygon fill="black" stroke="black" points="8269.36,-3311.21 8259.36,-3314.72 8269.36,-3318.21 8269.36,-3311.21"/>
</g>
<!-- mha_layer12_gpu12 -->
<g id="node986" class="node">
<title>mha_layer12_gpu12</title>
<path fill="lightblue" stroke="black" d="M12494,-2994.77C12494,-2994.77 12046,-2994.77 12046,-2994.77 12040,-2994.77 12034,-2988.77 12034,-2982.77 12034,-2982.77 12034,-2953.77 12034,-2953.77 12034,-2947.77 12040,-2941.77 12046,-2941.77 12046,-2941.77 12494,-2941.77 12494,-2941.77 12500,-2941.77 12506,-2947.77 12506,-2953.77 12506,-2953.77 12506,-2982.77 12506,-2982.77 12506,-2988.77 12500,-2994.77 12494,-2994.77"/>
<text text-anchor="middle" x="12270" y="-2979.57" font-family="Times,serif" font-size="14.00">MHA Layer 12 GPU 12</text>
<text text-anchor="middle" x="12270" y="-2964.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12270" y="-2949.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer11_gpu12&#45;&gt;mha_layer12_gpu12 -->
<g id="edge1165" class="edge">
<title>aggregate_layer11_gpu12&#45;&gt;mha_layer12_gpu12</title>
<path fill="none" stroke="black" d="M12115.82,-3030.67C12143.47,-3019.66 12171.7,-3008.41 12196.33,-2998.61"/>
<polygon fill="black" stroke="black" points="12197.94,-3001.73 12205.94,-2994.78 12195.35,-2995.23 12197.94,-3001.73"/>
</g>
<!-- route_layer11_gpu13&#45;&gt;comm_layer11 -->
<g id="edge1118" class="edge">
<title>route_layer11_gpu13&#45;&gt;comm_layer11</title>
<path fill="none" stroke="black" d="M12877.61,-3409.7C12778.87,-3401.14 12668.89,-3392.78 12568,-3387.72 11721.33,-3345.29 9097.43,-3323.08 8269.2,-3316.99"/>
<polygon fill="black" stroke="black" points="8268.96,-3313.49 8258.94,-3316.92 8268.91,-3320.49 8268.96,-3313.49"/>
</g>
<!-- mha_layer12_gpu13 -->
<g id="node987" class="node">
<title>mha_layer12_gpu13</title>
<path fill="lightblue" stroke="black" d="M13155,-2994.77C13155,-2994.77 12707,-2994.77 12707,-2994.77 12701,-2994.77 12695,-2988.77 12695,-2982.77 12695,-2982.77 12695,-2953.77 12695,-2953.77 12695,-2947.77 12701,-2941.77 12707,-2941.77 12707,-2941.77 13155,-2941.77 13155,-2941.77 13161,-2941.77 13167,-2947.77 13167,-2953.77 13167,-2953.77 13167,-2982.77 13167,-2982.77 13167,-2988.77 13161,-2994.77 13155,-2994.77"/>
<text text-anchor="middle" x="12931" y="-2979.57" font-family="Times,serif" font-size="14.00">MHA Layer 12 GPU 13</text>
<text text-anchor="middle" x="12931" y="-2964.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12931" y="-2949.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer11_gpu13&#45;&gt;mha_layer12_gpu13 -->
<g id="edge1166" class="edge">
<title>aggregate_layer11_gpu13&#45;&gt;mha_layer12_gpu13</title>
<path fill="none" stroke="black" d="M12843.36,-3030.67C12857.96,-3020.44 12872.85,-3010 12886.12,-3000.71"/>
<polygon fill="black" stroke="black" points="12888.4,-3003.38 12894.58,-2994.78 12884.39,-2997.65 12888.4,-3003.38"/>
</g>
<!-- route_layer11_gpu14&#45;&gt;comm_layer11 -->
<g id="edge1119" class="edge">
<title>route_layer11_gpu14&#45;&gt;comm_layer11</title>
<path fill="none" stroke="black" d="M13839.41,-3409.61C13740.15,-3401.01 13629.49,-3392.65 13528,-3387.72 12483.78,-3336.99 9207.27,-3320.06 8269.23,-3316.19"/>
<polygon fill="black" stroke="black" points="8268.99,-3312.69 8258.98,-3316.15 8268.96,-3319.69 8268.99,-3312.69"/>
</g>
<!-- mha_layer12_gpu14 -->
<g id="node988" class="node">
<title>mha_layer12_gpu14</title>
<path fill="lightblue" stroke="black" d="M13730,-2994.77C13730,-2994.77 13282,-2994.77 13282,-2994.77 13276,-2994.77 13270,-2988.77 13270,-2982.77 13270,-2982.77 13270,-2953.77 13270,-2953.77 13270,-2947.77 13276,-2941.77 13282,-2941.77 13282,-2941.77 13730,-2941.77 13730,-2941.77 13736,-2941.77 13742,-2947.77 13742,-2953.77 13742,-2953.77 13742,-2982.77 13742,-2982.77 13742,-2988.77 13736,-2994.77 13730,-2994.77"/>
<text text-anchor="middle" x="13506" y="-2979.57" font-family="Times,serif" font-size="14.00">MHA Layer 12 GPU 14</text>
<text text-anchor="middle" x="13506" y="-2964.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13506" y="-2949.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer11_gpu14&#45;&gt;mha_layer12_gpu14 -->
<g id="edge1167" class="edge">
<title>aggregate_layer11_gpu14&#45;&gt;mha_layer12_gpu14</title>
<path fill="none" stroke="black" d="M13497.89,-3030.67C13499.04,-3021.9 13500.22,-3012.98 13501.31,-3004.76"/>
<polygon fill="black" stroke="black" points="13504.79,-3005.15 13502.63,-2994.78 13497.85,-3004.24 13504.79,-3005.15"/>
</g>
<!-- route_layer11_gpu15&#45;&gt;comm_layer11 -->
<g id="edge1120" class="edge">
<title>route_layer11_gpu15&#45;&gt;comm_layer11</title>
<path fill="none" stroke="black" d="M14802.31,-3409.52C14702.79,-3400.91 14591.8,-3392.56 14490,-3387.72 13246.62,-3328.61 9308.7,-3317.53 8269.49,-3315.62"/>
<polygon fill="black" stroke="black" points="8269.28,-3312.12 8259.27,-3315.6 8269.27,-3319.12 8269.28,-3312.12"/>
</g>
<!-- mha_layer12_gpu15 -->
<g id="node989" class="node">
<title>mha_layer12_gpu15</title>
<path fill="lightblue" stroke="black" d="M15153,-2994.77C15153,-2994.77 14705,-2994.77 14705,-2994.77 14699,-2994.77 14693,-2988.77 14693,-2982.77 14693,-2982.77 14693,-2953.77 14693,-2953.77 14693,-2947.77 14699,-2941.77 14705,-2941.77 14705,-2941.77 15153,-2941.77 15153,-2941.77 15159,-2941.77 15165,-2947.77 15165,-2953.77 15165,-2953.77 15165,-2982.77 15165,-2982.77 15165,-2988.77 15159,-2994.77 15153,-2994.77"/>
<text text-anchor="middle" x="14929" y="-2979.57" font-family="Times,serif" font-size="14.00">MHA Layer 12 GPU 15</text>
<text text-anchor="middle" x="14929" y="-2964.57" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14929" y="-2949.57" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer11_gpu15&#45;&gt;mha_layer12_gpu15 -->
<g id="edge1168" class="edge">
<title>aggregate_layer11_gpu15&#45;&gt;mha_layer12_gpu15</title>
<path fill="none" stroke="black" d="M14794.3,-3030.67C14818.13,-3019.8 14842.46,-3008.71 14863.78,-2999"/>
<polygon fill="black" stroke="black" points="14865.38,-3002.11 14873.03,-2994.78 14862.48,-2995.74 14865.38,-3002.11"/>
</g>
<!-- comm_layer11&#45;&gt;expert_layer11_gpu0_expert0 -->
<g id="edge1121" class="edge">
<title>comm_layer11&#45;&gt;expert_layer11_gpu0_expert0</title>
<path fill="none" stroke="black" d="M7773.21,-3311.68C7012.04,-3306.41 4604.38,-3286.98 2611,-3240.77 2357.89,-3234.9 2068.88,-3225.03 1866.69,-3217.61"/>
<polygon fill="black" stroke="black" points="1866.65,-3214.11 1856.53,-3217.24 1866.39,-3221.1 1866.65,-3214.11"/>
</g>
<!-- comm_layer11&#45;&gt;expert_layer11_gpu1_expert1 -->
<g id="edge1122" class="edge">
<title>comm_layer11&#45;&gt;expert_layer11_gpu1_expert1</title>
<path fill="none" stroke="black" d="M7773.14,-3311.64C7107.21,-3306.73 5196.15,-3289.18 3608,-3240.77 3446.95,-3235.86 3266.32,-3227.86 3123.71,-3220.97"/>
<polygon fill="black" stroke="black" points="3123.67,-3217.47 3113.51,-3220.48 3123.33,-3224.46 3123.67,-3217.47"/>
</g>
<!-- comm_layer11&#45;&gt;expert_layer11_gpu2_expert2 -->
<g id="edge1123" class="edge">
<title>comm_layer11&#45;&gt;expert_layer11_gpu2_expert2</title>
<path fill="none" stroke="black" d="M7774.31,-3309.67C7222.37,-3301.14 5826.79,-3277.55 4660,-3240.77 4479.92,-3235.09 4277,-3226.65 4121.11,-3219.72"/>
<polygon fill="black" stroke="black" points="4121.06,-3216.21 4110.91,-3219.27 4120.75,-3223.21 4121.06,-3216.21"/>
</g>
<!-- comm_layer11&#45;&gt;expert_layer11_gpu3_expert3 -->
<g id="edge1124" class="edge">
<title>comm_layer11&#45;&gt;expert_layer11_gpu3_expert3</title>
<path fill="none" stroke="black" d="M7775.25,-3308.63C7326.07,-3299.5 6329.77,-3276.87 5491,-3240.77 5386.81,-3236.28 5272.08,-3229.97 5172.69,-3224.07"/>
<polygon fill="black" stroke="black" points="5172.7,-3220.57 5162.51,-3223.47 5172.28,-3227.56 5172.7,-3220.57"/>
</g>
<!-- comm_layer11&#45;&gt;expert_layer11_gpu4_expert4 -->
<g id="edge1125" class="edge">
<title>comm_layer11&#45;&gt;expert_layer11_gpu4_expert4</title>
<path fill="none" stroke="black" d="M7776.54,-3307.62C7418.67,-3298.39 6723.2,-3277.33 6133,-3240.77 6091.2,-3238.18 6046.89,-3234.89 6003.77,-3231.41"/>
<polygon fill="black" stroke="black" points="6003.97,-3227.91 5993.72,-3230.59 6003.4,-3234.89 6003.97,-3227.91"/>
</g>
<!-- comm_layer11&#45;&gt;expert_layer11_gpu5_expert5 -->
<g id="edge1126" class="edge">
<title>comm_layer11&#45;&gt;expert_layer11_gpu5_expert5</title>
<path fill="none" stroke="black" d="M7790.95,-3299.93C7555.72,-3285.87 7175.89,-3262.73 6848,-3240.77 6782.41,-3236.37 6711.57,-3231.4 6645.63,-3226.66"/>
<polygon fill="black" stroke="black" points="6645.74,-3223.16 6635.52,-3225.94 6645.24,-3230.14 6645.74,-3223.16"/>
</g>
<!-- comm_layer11&#45;&gt;expert_layer11_gpu6_expert6 -->
<g id="edge1127" class="edge">
<title>comm_layer11&#45;&gt;expert_layer11_gpu6_expert6</title>
<path fill="none" stroke="black" d="M7824.54,-3291.1C7689.85,-3275.52 7508.1,-3254.5 7360.84,-3237.47"/>
<polygon fill="black" stroke="black" points="7361.08,-3233.98 7350.74,-3236.3 7360.27,-3240.93 7361.08,-3233.98"/>
</g>
<!-- comm_layer11&#45;&gt;expert_layer11_gpu7_expert7 -->
<g id="edge1128" class="edge">
<title>comm_layer11&#45;&gt;expert_layer11_gpu7_expert7</title>
<path fill="none" stroke="black" d="M7917.28,-3279.87C7883.58,-3268.48 7845.74,-3255.69 7811.4,-3244.07"/>
<polygon fill="black" stroke="black" points="7812.4,-3240.72 7801.81,-3240.83 7810.16,-3247.35 7812.4,-3240.72"/>
</g>
<!-- comm_layer11&#45;&gt;expert_layer11_gpu8_expert8 -->
<g id="edge1129" class="edge">
<title>comm_layer11&#45;&gt;expert_layer11_gpu8_expert8</title>
<path fill="none" stroke="black" d="M8114.72,-3279.87C8148.42,-3268.48 8186.26,-3255.69 8220.6,-3244.07"/>
<polygon fill="black" stroke="black" points="8221.84,-3247.35 8230.19,-3240.83 8219.6,-3240.72 8221.84,-3247.35"/>
</g>
<!-- comm_layer11&#45;&gt;expert_layer11_gpu9_expert9 -->
<g id="edge1130" class="edge">
<title>comm_layer11&#45;&gt;expert_layer11_gpu9_expert9</title>
<path fill="none" stroke="black" d="M8216.71,-3293.06C8384.91,-3276.15 8626.1,-3251.9 8808.33,-3233.57"/>
<polygon fill="black" stroke="black" points="8808.73,-3237.05 8818.33,-3232.57 8808.03,-3230.09 8808.73,-3237.05"/>
</g>
<!-- comm_layer11&#45;&gt;expert_layer11_gpu10_expert10 -->
<g id="edge1131" class="edge">
<title>comm_layer11&#45;&gt;expert_layer11_gpu10_expert10</title>
<path fill="none" stroke="black" d="M8243.33,-3300.79C8503.54,-3286.49 8942.52,-3262.24 9320,-3240.77 9421.38,-3235 9532.95,-3228.53 9630.1,-3222.86"/>
<polygon fill="black" stroke="black" points="9630.58,-3226.34 9640.36,-3222.26 9630.17,-3219.35 9630.58,-3226.34"/>
</g>
<!-- comm_layer11&#45;&gt;expert_layer11_gpu11_expert11 -->
<g id="edge1132" class="edge">
<title>comm_layer11&#45;&gt;expert_layer11_gpu11_expert11</title>
<path fill="none" stroke="black" d="M8254.39,-3306.58C8647.67,-3295.25 9457.11,-3270.55 10142,-3240.77 10262.73,-3235.52 10396.53,-3228.59 10509.17,-3222.44"/>
<polygon fill="black" stroke="black" points="10509.52,-3225.92 10519.31,-3221.88 10509.14,-3218.93 10509.52,-3225.92"/>
</g>
<!-- comm_layer11&#45;&gt;expert_layer11_gpu12_expert12 -->
<g id="edge1133" class="edge">
<title>comm_layer11&#45;&gt;expert_layer11_gpu12_expert12</title>
<path fill="none" stroke="black" d="M8257.57,-3309.68C8767.98,-3301.64 9993.69,-3279.72 11021,-3240.77 11146.46,-3236.01 11285.72,-3229.01 11402.04,-3222.68"/>
<polygon fill="black" stroke="black" points="11402.35,-3226.16 11412.15,-3222.12 11401.97,-3219.17 11402.35,-3226.16"/>
</g>
<!-- comm_layer11&#45;&gt;expert_layer11_gpu13_expert13 -->
<g id="edge1134" class="edge">
<title>comm_layer11&#45;&gt;expert_layer11_gpu13_expert13</title>
<path fill="none" stroke="black" d="M8258.98,-3311.93C8872.1,-3307.91 10531.66,-3292.72 11914,-3240.77 12020.86,-3236.75 12138.65,-3230.44 12240.21,-3224.41"/>
<polygon fill="black" stroke="black" points="12240.53,-3227.9 12250.3,-3223.81 12240.11,-3220.91 12240.53,-3227.9"/>
</g>
<!-- comm_layer11&#45;&gt;expert_layer11_gpu14_expert14 -->
<g id="edge1135" class="edge">
<title>comm_layer11&#45;&gt;expert_layer11_gpu14_expert14</title>
<path fill="none" stroke="black" d="M8259.49,-3313.59C8958.59,-3313.72 11032.1,-3307.94 12752,-3240.77 12839.45,-3237.35 12935,-3231.87 13020.32,-3226.34"/>
<polygon fill="black" stroke="black" points="13020.66,-3229.83 13030.41,-3225.69 13020.2,-3222.85 13020.66,-3229.83"/>
</g>
<!-- comm_layer11&#45;&gt;expert_layer11_gpu15_expert15 -->
<g id="edge1136" class="edge">
<title>comm_layer11&#45;&gt;expert_layer11_gpu15_expert15</title>
<path fill="none" stroke="black" d="M8259.37,-3312.83C9031.29,-3310.91 11494.12,-3300.2 13532,-3240.77 13689.28,-3236.18 13865.5,-3228.29 14005.4,-3221.38"/>
<polygon fill="black" stroke="black" points="14005.59,-3224.87 14015.41,-3220.88 14005.24,-3217.88 14005.59,-3224.87"/>
</g>
<!-- gate_layer12_gpu0 -->
<g id="node990" class="node">
<title>gate_layer12_gpu0</title>
<path fill="lightsteelblue" stroke="black" d="M706.07,-2904.43C706.07,-2904.43 256.93,-2854.1 256.93,-2854.1 250.96,-2853.43 250.96,-2852.1 256.93,-2851.43 256.93,-2851.43 706.07,-2801.1 706.07,-2801.1 712.04,-2800.43 723.96,-2800.43 729.93,-2801.1 729.93,-2801.1 1179.07,-2851.43 1179.07,-2851.43 1185.04,-2852.1 1185.04,-2853.43 1179.07,-2854.1 1179.07,-2854.1 729.93,-2904.43 729.93,-2904.43 723.96,-2905.1 712.04,-2905.1 706.07,-2904.43"/>
<text text-anchor="middle" x="718" y="-2864.07" font-family="Times,serif" font-size="14.00">Gate Layer 12 GPU 0</text>
<text text-anchor="middle" x="718" y="-2849.07" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="718" y="-2834.07" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer12_gpu0&#45;&gt;gate_layer12_gpu0 -->
<g id="edge1169" class="edge">
<title>mha_layer12_gpu0&#45;&gt;gate_layer12_gpu0</title>
<path fill="none" stroke="black" d="M866.43,-2941.51C847.09,-2930.08 823.66,-2916.23 801.18,-2902.94"/>
<polygon fill="black" stroke="black" points="802.68,-2899.76 792.29,-2897.68 799.12,-2905.78 802.68,-2899.76"/>
</g>
<!-- gate_layer12_gpu1 -->
<g id="node991" class="node">
<title>gate_layer12_gpu1</title>
<path fill="lightsteelblue" stroke="black" d="M1670.07,-2904.43C1670.07,-2904.43 1220.93,-2854.1 1220.93,-2854.1 1214.96,-2853.43 1214.96,-2852.1 1220.93,-2851.43 1220.93,-2851.43 1670.07,-2801.1 1670.07,-2801.1 1676.04,-2800.43 1687.96,-2800.43 1693.93,-2801.1 1693.93,-2801.1 2143.07,-2851.43 2143.07,-2851.43 2149.04,-2852.1 2149.04,-2853.43 2143.07,-2854.1 2143.07,-2854.1 1693.93,-2904.43 1693.93,-2904.43 1687.96,-2905.1 1676.04,-2905.1 1670.07,-2904.43"/>
<text text-anchor="middle" x="1682" y="-2864.07" font-family="Times,serif" font-size="14.00">Gate Layer 12 GPU 1</text>
<text text-anchor="middle" x="1682" y="-2849.07" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="1682" y="-2834.07" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer12_gpu1&#45;&gt;gate_layer12_gpu1 -->
<g id="edge1170" class="edge">
<title>mha_layer12_gpu1&#45;&gt;gate_layer12_gpu1</title>
<path fill="none" stroke="black" d="M2058.63,-2941.72C1995,-2926.86 1913.64,-2907.86 1842.82,-2891.33"/>
<polygon fill="black" stroke="black" points="1843.44,-2887.87 1832.91,-2889.01 1841.85,-2894.69 1843.44,-2887.87"/>
</g>
<!-- gate_layer12_gpu2 -->
<g id="node992" class="node">
<title>gate_layer12_gpu2</title>
<path fill="lightsteelblue" stroke="black" d="M2634.07,-2904.43C2634.07,-2904.43 2184.93,-2854.1 2184.93,-2854.1 2178.96,-2853.43 2178.96,-2852.1 2184.93,-2851.43 2184.93,-2851.43 2634.07,-2801.1 2634.07,-2801.1 2640.04,-2800.43 2651.96,-2800.43 2657.93,-2801.1 2657.93,-2801.1 3107.07,-2851.43 3107.07,-2851.43 3113.04,-2852.1 3113.04,-2853.43 3107.07,-2854.1 3107.07,-2854.1 2657.93,-2904.43 2657.93,-2904.43 2651.96,-2905.1 2640.04,-2905.1 2634.07,-2904.43"/>
<text text-anchor="middle" x="2646" y="-2864.07" font-family="Times,serif" font-size="14.00">Gate Layer 12 GPU 2</text>
<text text-anchor="middle" x="2646" y="-2849.07" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="2646" y="-2834.07" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer12_gpu2&#45;&gt;gate_layer12_gpu2 -->
<g id="edge1171" class="edge">
<title>mha_layer12_gpu2&#45;&gt;gate_layer12_gpu2</title>
<path fill="none" stroke="black" d="M2875.2,-2941.65C2841.49,-2928.72 2799.62,-2912.67 2760.94,-2897.84"/>
<polygon fill="black" stroke="black" points="2761.77,-2894.41 2751.18,-2894.1 2759.26,-2900.95 2761.77,-2894.41"/>
</g>
<!-- gate_layer12_gpu3 -->
<g id="node993" class="node">
<title>gate_layer12_gpu3</title>
<path fill="lightsteelblue" stroke="black" d="M3598.07,-2904.43C3598.07,-2904.43 3148.93,-2854.1 3148.93,-2854.1 3142.96,-2853.43 3142.96,-2852.1 3148.93,-2851.43 3148.93,-2851.43 3598.07,-2801.1 3598.07,-2801.1 3604.04,-2800.43 3615.96,-2800.43 3621.93,-2801.1 3621.93,-2801.1 4071.07,-2851.43 4071.07,-2851.43 4077.04,-2852.1 4077.04,-2853.43 4071.07,-2854.1 4071.07,-2854.1 3621.93,-2904.43 3621.93,-2904.43 3615.96,-2905.1 3604.04,-2905.1 3598.07,-2904.43"/>
<text text-anchor="middle" x="3610" y="-2864.07" font-family="Times,serif" font-size="14.00">Gate Layer 12 GPU 3</text>
<text text-anchor="middle" x="3610" y="-2849.07" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="3610" y="-2834.07" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer12_gpu3&#45;&gt;gate_layer12_gpu3 -->
<g id="edge1172" class="edge">
<title>mha_layer12_gpu3&#45;&gt;gate_layer12_gpu3</title>
<path fill="none" stroke="black" d="M3620.82,-2941.51C3619.85,-2933.63 3618.74,-2924.61 3617.6,-2915.41"/>
<polygon fill="black" stroke="black" points="3621.07,-2914.9 3616.37,-2905.41 3614.12,-2915.76 3621.07,-2914.9"/>
</g>
<!-- gate_layer12_gpu4 -->
<g id="node994" class="node">
<title>gate_layer12_gpu4</title>
<path fill="lightsteelblue" stroke="black" d="M4562.07,-2904.43C4562.07,-2904.43 4112.93,-2854.1 4112.93,-2854.1 4106.96,-2853.43 4106.96,-2852.1 4112.93,-2851.43 4112.93,-2851.43 4562.07,-2801.1 4562.07,-2801.1 4568.04,-2800.43 4579.96,-2800.43 4585.93,-2801.1 4585.93,-2801.1 5035.07,-2851.43 5035.07,-2851.43 5041.04,-2852.1 5041.04,-2853.43 5035.07,-2854.1 5035.07,-2854.1 4585.93,-2904.43 4585.93,-2904.43 4579.96,-2905.1 4568.04,-2905.1 4562.07,-2904.43"/>
<text text-anchor="middle" x="4574" y="-2864.07" font-family="Times,serif" font-size="14.00">Gate Layer 12 GPU 4</text>
<text text-anchor="middle" x="4574" y="-2849.07" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4574" y="-2834.07" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer12_gpu4&#45;&gt;gate_layer12_gpu4 -->
<g id="edge1173" class="edge">
<title>mha_layer12_gpu4&#45;&gt;gate_layer12_gpu4</title>
<path fill="none" stroke="black" d="M4757.52,-2941.65C4732.03,-2929.45 4700.73,-2914.46 4671.25,-2900.34"/>
<polygon fill="black" stroke="black" points="4672.69,-2897.15 4662.16,-2895.99 4669.67,-2903.46 4672.69,-2897.15"/>
</g>
<!-- gate_layer12_gpu5 -->
<g id="node995" class="node">
<title>gate_layer12_gpu5</title>
<path fill="lightsteelblue" stroke="black" d="M5526.07,-2904.43C5526.07,-2904.43 5076.93,-2854.1 5076.93,-2854.1 5070.96,-2853.43 5070.96,-2852.1 5076.93,-2851.43 5076.93,-2851.43 5526.07,-2801.1 5526.07,-2801.1 5532.04,-2800.43 5543.96,-2800.43 5549.93,-2801.1 5549.93,-2801.1 5999.07,-2851.43 5999.07,-2851.43 6005.04,-2852.1 6005.04,-2853.43 5999.07,-2854.1 5999.07,-2854.1 5549.93,-2904.43 5549.93,-2904.43 5543.96,-2905.1 5532.04,-2905.1 5526.07,-2904.43"/>
<text text-anchor="middle" x="5538" y="-2864.07" font-family="Times,serif" font-size="14.00">Gate Layer 12 GPU 5</text>
<text text-anchor="middle" x="5538" y="-2849.07" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5538" y="-2834.07" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer12_gpu5&#45;&gt;gate_layer12_gpu5 -->
<g id="edge1174" class="edge">
<title>mha_layer12_gpu5&#45;&gt;gate_layer12_gpu5</title>
<path fill="none" stroke="black" d="M5798.18,-2941.65C5758.42,-2928.22 5708.69,-2911.43 5663.39,-2896.12"/>
<polygon fill="black" stroke="black" points="5664.39,-2892.77 5653.8,-2892.88 5662.15,-2899.4 5664.39,-2892.77"/>
</g>
<!-- gate_layer12_gpu6 -->
<g id="node996" class="node">
<title>gate_layer12_gpu6</title>
<path fill="lightsteelblue" stroke="black" d="M6490.07,-2904.43C6490.07,-2904.43 6040.93,-2854.1 6040.93,-2854.1 6034.96,-2853.43 6034.96,-2852.1 6040.93,-2851.43 6040.93,-2851.43 6490.07,-2801.1 6490.07,-2801.1 6496.04,-2800.43 6507.96,-2800.43 6513.93,-2801.1 6513.93,-2801.1 6963.07,-2851.43 6963.07,-2851.43 6969.04,-2852.1 6969.04,-2853.43 6963.07,-2854.1 6963.07,-2854.1 6513.93,-2904.43 6513.93,-2904.43 6507.96,-2905.1 6496.04,-2905.1 6490.07,-2904.43"/>
<text text-anchor="middle" x="6502" y="-2864.07" font-family="Times,serif" font-size="14.00">Gate Layer 12 GPU 6</text>
<text text-anchor="middle" x="6502" y="-2849.07" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6502" y="-2834.07" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer12_gpu6&#45;&gt;gate_layer12_gpu6 -->
<g id="edge1175" class="edge">
<title>mha_layer12_gpu6&#45;&gt;gate_layer12_gpu6</title>
<path fill="none" stroke="black" d="M6738.95,-2941.65C6703.62,-2928.55 6659.65,-2912.24 6619.22,-2897.24"/>
<polygon fill="black" stroke="black" points="6620.43,-2893.96 6609.84,-2893.76 6618,-2900.52 6620.43,-2893.96"/>
</g>
<!-- gate_layer12_gpu7 -->
<g id="node997" class="node">
<title>gate_layer12_gpu7</title>
<path fill="lightsteelblue" stroke="black" d="M7454.07,-2904.43C7454.07,-2904.43 7004.93,-2854.1 7004.93,-2854.1 6998.96,-2853.43 6998.96,-2852.1 7004.93,-2851.43 7004.93,-2851.43 7454.07,-2801.1 7454.07,-2801.1 7460.04,-2800.43 7471.96,-2800.43 7477.93,-2801.1 7477.93,-2801.1 7927.07,-2851.43 7927.07,-2851.43 7933.04,-2852.1 7933.04,-2853.43 7927.07,-2854.1 7927.07,-2854.1 7477.93,-2904.43 7477.93,-2904.43 7471.96,-2905.1 7460.04,-2905.1 7454.07,-2904.43"/>
<text text-anchor="middle" x="7466" y="-2864.07" font-family="Times,serif" font-size="14.00">Gate Layer 12 GPU 7</text>
<text text-anchor="middle" x="7466" y="-2849.07" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="7466" y="-2834.07" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer12_gpu7&#45;&gt;gate_layer12_gpu7 -->
<g id="edge1176" class="edge">
<title>mha_layer12_gpu7&#45;&gt;gate_layer12_gpu7</title>
<path fill="none" stroke="black" d="M7489.97,-2941.51C7487.74,-2933.36 7485.17,-2923.97 7482.57,-2914.43"/>
<polygon fill="black" stroke="black" points="7485.86,-2913.21 7479.85,-2904.49 7479.11,-2915.06 7485.86,-2913.21"/>
</g>
<!-- gate_layer12_gpu8 -->
<g id="node998" class="node">
<title>gate_layer12_gpu8</title>
<path fill="lightsteelblue" stroke="black" d="M8418.07,-2904.43C8418.07,-2904.43 7968.93,-2854.1 7968.93,-2854.1 7962.96,-2853.43 7962.96,-2852.1 7968.93,-2851.43 7968.93,-2851.43 8418.07,-2801.1 8418.07,-2801.1 8424.04,-2800.43 8435.96,-2800.43 8441.93,-2801.1 8441.93,-2801.1 8891.07,-2851.43 8891.07,-2851.43 8897.04,-2852.1 8897.04,-2853.43 8891.07,-2854.1 8891.07,-2854.1 8441.93,-2904.43 8441.93,-2904.43 8435.96,-2905.1 8424.04,-2905.1 8418.07,-2904.43"/>
<text text-anchor="middle" x="8430" y="-2864.07" font-family="Times,serif" font-size="14.00">Gate Layer 12 GPU 8</text>
<text text-anchor="middle" x="8430" y="-2849.07" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="8430" y="-2834.07" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer12_gpu8&#45;&gt;gate_layer12_gpu8 -->
<g id="edge1177" class="edge">
<title>mha_layer12_gpu8&#45;&gt;gate_layer12_gpu8</title>
<path fill="none" stroke="black" d="M8412.22,-2941.51C8413.85,-2933.45 8415.73,-2924.19 8417.64,-2914.77"/>
<polygon fill="black" stroke="black" points="8421.07,-2915.44 8419.63,-2904.95 8414.21,-2914.05 8421.07,-2915.44"/>
</g>
<!-- gate_layer12_gpu9 -->
<g id="node999" class="node">
<title>gate_layer12_gpu9</title>
<path fill="lightsteelblue" stroke="black" d="M9382.07,-2904.43C9382.07,-2904.43 8932.93,-2854.1 8932.93,-2854.1 8926.96,-2853.43 8926.96,-2852.1 8932.93,-2851.43 8932.93,-2851.43 9382.07,-2801.1 9382.07,-2801.1 9388.04,-2800.43 9399.96,-2800.43 9405.93,-2801.1 9405.93,-2801.1 9855.07,-2851.43 9855.07,-2851.43 9861.04,-2852.1 9861.04,-2853.43 9855.07,-2854.1 9855.07,-2854.1 9405.93,-2904.43 9405.93,-2904.43 9399.96,-2905.1 9388.04,-2905.1 9382.07,-2904.43"/>
<text text-anchor="middle" x="9394" y="-2864.07" font-family="Times,serif" font-size="14.00">Gate Layer 12 GPU 9</text>
<text text-anchor="middle" x="9394" y="-2849.07" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="9394" y="-2834.07" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer12_gpu9&#45;&gt;gate_layer12_gpu9 -->
<g id="edge1178" class="edge">
<title>mha_layer12_gpu9&#45;&gt;gate_layer12_gpu9</title>
<path fill="none" stroke="black" d="M9332.15,-2941.51C9338.69,-2932.23 9346.35,-2921.36 9354.02,-2910.49"/>
<polygon fill="black" stroke="black" points="9356.96,-2912.4 9359.86,-2902.21 9351.24,-2908.36 9356.96,-2912.4"/>
</g>
<!-- gate_layer12_gpu10 -->
<g id="node1000" class="node">
<title>gate_layer12_gpu10</title>
<path fill="lightsteelblue" stroke="black" d="M10346.07,-2904.43C10346.07,-2904.43 9896.93,-2854.1 9896.93,-2854.1 9890.96,-2853.43 9890.96,-2852.1 9896.93,-2851.43 9896.93,-2851.43 10346.07,-2801.1 10346.07,-2801.1 10352.04,-2800.43 10363.96,-2800.43 10369.93,-2801.1 10369.93,-2801.1 10819.07,-2851.43 10819.07,-2851.43 10825.04,-2852.1 10825.04,-2853.43 10819.07,-2854.1 10819.07,-2854.1 10369.93,-2904.43 10369.93,-2904.43 10363.96,-2905.1 10352.04,-2905.1 10346.07,-2904.43"/>
<text text-anchor="middle" x="10358" y="-2864.07" font-family="Times,serif" font-size="14.00">Gate Layer 12 GPU 10</text>
<text text-anchor="middle" x="10358" y="-2849.07" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="10358" y="-2834.07" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer12_gpu10&#45;&gt;gate_layer12_gpu10 -->
<g id="edge1179" class="edge">
<title>mha_layer12_gpu10&#45;&gt;gate_layer12_gpu10</title>
<path fill="none" stroke="black" d="M10274.51,-2941.51C10283.9,-2931.64 10295.01,-2919.96 10306.01,-2908.4"/>
<polygon fill="black" stroke="black" points="10308.85,-2910.5 10313.2,-2900.84 10303.78,-2905.67 10308.85,-2910.5"/>
</g>
<!-- gate_layer12_gpu11 -->
<g id="node1001" class="node">
<title>gate_layer12_gpu11</title>
<path fill="lightsteelblue" stroke="black" d="M11310.07,-2904.43C11310.07,-2904.43 10860.93,-2854.1 10860.93,-2854.1 10854.96,-2853.43 10854.96,-2852.1 10860.93,-2851.43 10860.93,-2851.43 11310.07,-2801.1 11310.07,-2801.1 11316.04,-2800.43 11327.96,-2800.43 11333.93,-2801.1 11333.93,-2801.1 11783.07,-2851.43 11783.07,-2851.43 11789.04,-2852.1 11789.04,-2853.43 11783.07,-2854.1 11783.07,-2854.1 11333.93,-2904.43 11333.93,-2904.43 11327.96,-2905.1 11316.04,-2905.1 11310.07,-2904.43"/>
<text text-anchor="middle" x="11322" y="-2864.07" font-family="Times,serif" font-size="14.00">Gate Layer 12 GPU 11</text>
<text text-anchor="middle" x="11322" y="-2849.07" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11322" y="-2834.07" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer12_gpu11&#45;&gt;gate_layer12_gpu11 -->
<g id="edge1180" class="edge">
<title>mha_layer12_gpu11&#45;&gt;gate_layer12_gpu11</title>
<path fill="none" stroke="black" d="M11227.68,-2941.51C11238.61,-2931.34 11251.6,-2919.26 11264.39,-2907.36"/>
<polygon fill="black" stroke="black" points="11266.95,-2909.76 11271.89,-2900.39 11262.18,-2904.64 11266.95,-2909.76"/>
</g>
<!-- gate_layer12_gpu12 -->
<g id="node1002" class="node">
<title>gate_layer12_gpu12</title>
<path fill="lightsteelblue" stroke="black" d="M12274.07,-2904.43C12274.07,-2904.43 11824.93,-2854.1 11824.93,-2854.1 11818.96,-2853.43 11818.96,-2852.1 11824.93,-2851.43 11824.93,-2851.43 12274.07,-2801.1 12274.07,-2801.1 12280.04,-2800.43 12291.96,-2800.43 12297.93,-2801.1 12297.93,-2801.1 12747.07,-2851.43 12747.07,-2851.43 12753.04,-2852.1 12753.04,-2853.43 12747.07,-2854.1 12747.07,-2854.1 12297.93,-2904.43 12297.93,-2904.43 12291.96,-2905.1 12280.04,-2905.1 12274.07,-2904.43"/>
<text text-anchor="middle" x="12286" y="-2864.07" font-family="Times,serif" font-size="14.00">Gate Layer 12 GPU 12</text>
<text text-anchor="middle" x="12286" y="-2849.07" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="12286" y="-2834.07" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer12_gpu12&#45;&gt;gate_layer12_gpu12 -->
<g id="edge1181" class="edge">
<title>mha_layer12_gpu12&#45;&gt;gate_layer12_gpu12</title>
<path fill="none" stroke="black" d="M12273.63,-2941.51C12274.74,-2933.63 12276.01,-2924.61 12277.31,-2915.41"/>
<polygon fill="black" stroke="black" points="12280.79,-2915.8 12278.72,-2905.41 12273.86,-2914.82 12280.79,-2915.8"/>
</g>
<!-- gate_layer12_gpu13 -->
<g id="node1003" class="node">
<title>gate_layer12_gpu13</title>
<path fill="lightsteelblue" stroke="black" d="M13238.07,-2904.43C13238.07,-2904.43 12788.93,-2854.1 12788.93,-2854.1 12782.96,-2853.43 12782.96,-2852.1 12788.93,-2851.43 12788.93,-2851.43 13238.07,-2801.1 13238.07,-2801.1 13244.04,-2800.43 13255.96,-2800.43 13261.93,-2801.1 13261.93,-2801.1 13711.07,-2851.43 13711.07,-2851.43 13717.04,-2852.1 13717.04,-2853.43 13711.07,-2854.1 13711.07,-2854.1 13261.93,-2904.43 13261.93,-2904.43 13255.96,-2905.1 13244.04,-2905.1 13238.07,-2904.43"/>
<text text-anchor="middle" x="13250" y="-2864.07" font-family="Times,serif" font-size="14.00">Gate Layer 12 GPU 13</text>
<text text-anchor="middle" x="13250" y="-2849.07" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13250" y="-2834.07" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer12_gpu13&#45;&gt;gate_layer12_gpu13 -->
<g id="edge1182" class="edge">
<title>mha_layer12_gpu13&#45;&gt;gate_layer12_gpu13</title>
<path fill="none" stroke="black" d="M13002.99,-2941.65C13040.23,-2928.4 13086.69,-2911.87 13129.24,-2896.73"/>
<polygon fill="black" stroke="black" points="13130.57,-2899.97 13138.82,-2893.32 13128.23,-2893.38 13130.57,-2899.97"/>
</g>
<!-- gate_layer12_gpu14 -->
<g id="node1004" class="node">
<title>gate_layer12_gpu14</title>
<path fill="lightsteelblue" stroke="black" d="M14202.07,-2904.43C14202.07,-2904.43 13752.93,-2854.1 13752.93,-2854.1 13746.96,-2853.43 13746.96,-2852.1 13752.93,-2851.43 13752.93,-2851.43 14202.07,-2801.1 14202.07,-2801.1 14208.04,-2800.43 14219.96,-2800.43 14225.93,-2801.1 14225.93,-2801.1 14675.07,-2851.43 14675.07,-2851.43 14681.04,-2852.1 14681.04,-2853.43 14675.07,-2854.1 14675.07,-2854.1 14225.93,-2904.43 14225.93,-2904.43 14219.96,-2905.1 14208.04,-2905.1 14202.07,-2904.43"/>
<text text-anchor="middle" x="14214" y="-2864.07" font-family="Times,serif" font-size="14.00">Gate Layer 12 GPU 14</text>
<text text-anchor="middle" x="14214" y="-2849.07" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14214" y="-2834.07" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer12_gpu14&#45;&gt;gate_layer12_gpu14 -->
<g id="edge1183" class="edge">
<title>mha_layer12_gpu14&#45;&gt;gate_layer12_gpu14</title>
<path fill="none" stroke="black" d="M13665.33,-2941.72C13768.15,-2925.24 13902.76,-2903.66 14012.92,-2886"/>
<polygon fill="black" stroke="black" points="14013.5,-2889.45 14022.82,-2884.41 14012.39,-2882.54 14013.5,-2889.45"/>
</g>
<!-- gate_layer12_gpu15 -->
<g id="node1005" class="node">
<title>gate_layer12_gpu15</title>
<path fill="lightsteelblue" stroke="black" d="M15166.07,-2904.43C15166.07,-2904.43 14716.93,-2854.1 14716.93,-2854.1 14710.96,-2853.43 14710.96,-2852.1 14716.93,-2851.43 14716.93,-2851.43 15166.07,-2801.1 15166.07,-2801.1 15172.04,-2800.43 15183.96,-2800.43 15189.93,-2801.1 15189.93,-2801.1 15639.07,-2851.43 15639.07,-2851.43 15645.04,-2852.1 15645.04,-2853.43 15639.07,-2854.1 15639.07,-2854.1 15189.93,-2904.43 15189.93,-2904.43 15183.96,-2905.1 15172.04,-2905.1 15166.07,-2904.43"/>
<text text-anchor="middle" x="15178" y="-2864.07" font-family="Times,serif" font-size="14.00">Gate Layer 12 GPU 15</text>
<text text-anchor="middle" x="15178" y="-2849.07" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="15178" y="-2834.07" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer12_gpu15&#45;&gt;gate_layer12_gpu15 -->
<g id="edge1184" class="edge">
<title>mha_layer12_gpu15&#45;&gt;gate_layer12_gpu15</title>
<path fill="none" stroke="black" d="M14985.19,-2941.65C15012.35,-2929.28 15045.78,-2914.04 15077.14,-2899.74"/>
<polygon fill="black" stroke="black" points="15078.71,-2902.87 15086.35,-2895.54 15075.8,-2896.5 15078.71,-2902.87"/>
</g>
<!-- route_layer12_gpu0 -->
<g id="node1022" class="node">
<title>route_layer12_gpu0</title>
<path fill="orange" stroke="black" d="M1385.74,-2763.77C1385.74,-2763.77 877.24,-2763.77 877.24,-2763.77 871.24,-2763.77 860.5,-2760.09 855.75,-2756.42 855.75,-2756.42 737.75,-2665.11 737.75,-2665.11 733,-2661.44 734.26,-2657.77 740.26,-2657.77 740.26,-2657.77 1248.76,-2657.77 1248.76,-2657.77 1254.76,-2657.77 1265.5,-2661.44 1270.25,-2665.11 1270.25,-2665.11 1388.25,-2756.42 1388.25,-2756.42 1393,-2760.09 1391.74,-2763.77 1385.74,-2763.77"/>
<text text-anchor="middle" x="1063" y="-2722.07" font-family="Times,serif" font-size="14.00">Token Router Layer 12 GPU 0</text>
<text text-anchor="middle" x="1063" y="-2707.07" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="1063" y="-2692.07" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer12_gpu0&#45;&gt;route_layer12_gpu0 -->
<g id="edge1185" class="edge">
<title>gate_layer12_gpu0&#45;&gt;route_layer12_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M818.72,-2810.9C852.04,-2797.38 889.7,-2782.09 925.31,-2767.64"/>
<polygon fill="black" stroke="black" points="926.85,-2770.79 934.8,-2763.79 924.22,-2764.31 926.85,-2770.79"/>
</g>
<!-- route_layer12_gpu1 -->
<g id="node1024" class="node">
<title>route_layer12_gpu1</title>
<path fill="orange" stroke="black" d="M2211.74,-2763.77C2211.74,-2763.77 1703.24,-2763.77 1703.24,-2763.77 1697.24,-2763.77 1686.5,-2760.09 1681.75,-2756.42 1681.75,-2756.42 1563.75,-2665.11 1563.75,-2665.11 1559,-2661.44 1560.26,-2657.77 1566.26,-2657.77 1566.26,-2657.77 2074.76,-2657.77 2074.76,-2657.77 2080.76,-2657.77 2091.5,-2661.44 2096.25,-2665.11 2096.25,-2665.11 2214.25,-2756.42 2214.25,-2756.42 2219,-2760.09 2217.74,-2763.77 2211.74,-2763.77"/>
<text text-anchor="middle" x="1889" y="-2722.07" font-family="Times,serif" font-size="14.00">Token Router Layer 12 GPU 1</text>
<text text-anchor="middle" x="1889" y="-2707.07" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="1889" y="-2692.07" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer12_gpu1&#45;&gt;route_layer12_gpu1 -->
<g id="edge1186" class="edge">
<title>gate_layer12_gpu1&#45;&gt;route_layer12_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1748.07,-2807.08C1765.71,-2795.15 1785.04,-2782.08 1803.57,-2769.55"/>
<polygon fill="black" stroke="black" points="1805.69,-2772.33 1812.02,-2763.83 1801.77,-2766.54 1805.69,-2772.33"/>
</g>
<!-- route_layer12_gpu2 -->
<g id="node1026" class="node">
<title>route_layer12_gpu2</title>
<path fill="orange" stroke="black" d="M3313.74,-2763.77C3313.74,-2763.77 2805.24,-2763.77 2805.24,-2763.77 2799.24,-2763.77 2788.5,-2760.09 2783.75,-2756.42 2783.75,-2756.42 2665.75,-2665.11 2665.75,-2665.11 2661,-2661.44 2662.26,-2657.77 2668.26,-2657.77 2668.26,-2657.77 3176.76,-2657.77 3176.76,-2657.77 3182.76,-2657.77 3193.5,-2661.44 3198.25,-2665.11 3198.25,-2665.11 3316.25,-2756.42 3316.25,-2756.42 3321,-2760.09 3319.74,-2763.77 3313.74,-2763.77"/>
<text text-anchor="middle" x="2991" y="-2722.07" font-family="Times,serif" font-size="14.00">Token Router Layer 12 GPU 2</text>
<text text-anchor="middle" x="2991" y="-2707.07" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="2991" y="-2692.07" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer12_gpu2&#45;&gt;route_layer12_gpu2 -->
<g id="edge1187" class="edge">
<title>gate_layer12_gpu2&#45;&gt;route_layer12_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2746.72,-2810.9C2780.04,-2797.38 2817.7,-2782.09 2853.31,-2767.64"/>
<polygon fill="black" stroke="black" points="2854.85,-2770.79 2862.8,-2763.79 2852.22,-2764.31 2854.85,-2770.79"/>
</g>
<!-- route_layer12_gpu3 -->
<g id="node1028" class="node">
<title>route_layer12_gpu3</title>
<path fill="orange" stroke="black" d="M4139.74,-2763.77C4139.74,-2763.77 3631.24,-2763.77 3631.24,-2763.77 3625.24,-2763.77 3614.5,-2760.09 3609.75,-2756.42 3609.75,-2756.42 3491.75,-2665.11 3491.75,-2665.11 3487,-2661.44 3488.26,-2657.77 3494.26,-2657.77 3494.26,-2657.77 4002.76,-2657.77 4002.76,-2657.77 4008.76,-2657.77 4019.5,-2661.44 4024.25,-2665.11 4024.25,-2665.11 4142.25,-2756.42 4142.25,-2756.42 4147,-2760.09 4145.74,-2763.77 4139.74,-2763.77"/>
<text text-anchor="middle" x="3817" y="-2722.07" font-family="Times,serif" font-size="14.00">Token Router Layer 12 GPU 3</text>
<text text-anchor="middle" x="3817" y="-2707.07" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="3817" y="-2692.07" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer12_gpu3&#45;&gt;route_layer12_gpu3 -->
<g id="edge1188" class="edge">
<title>gate_layer12_gpu3&#45;&gt;route_layer12_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3676.07,-2807.08C3693.71,-2795.15 3713.04,-2782.08 3731.57,-2769.55"/>
<polygon fill="black" stroke="black" points="3733.69,-2772.33 3740.02,-2763.83 3729.77,-2766.54 3733.69,-2772.33"/>
</g>
<!-- route_layer12_gpu4 -->
<g id="node1030" class="node">
<title>route_layer12_gpu4</title>
<path fill="orange" stroke="black" d="M5172.74,-2763.77C5172.74,-2763.77 4664.24,-2763.77 4664.24,-2763.77 4658.24,-2763.77 4647.5,-2760.09 4642.75,-2756.42 4642.75,-2756.42 4524.75,-2665.11 4524.75,-2665.11 4520,-2661.44 4521.26,-2657.77 4527.26,-2657.77 4527.26,-2657.77 5035.76,-2657.77 5035.76,-2657.77 5041.76,-2657.77 5052.5,-2661.44 5057.25,-2665.11 5057.25,-2665.11 5175.25,-2756.42 5175.25,-2756.42 5180,-2760.09 5178.74,-2763.77 5172.74,-2763.77"/>
<text text-anchor="middle" x="4850" y="-2722.07" font-family="Times,serif" font-size="14.00">Token Router Layer 12 GPU 4</text>
<text text-anchor="middle" x="4850" y="-2707.07" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="4850" y="-2692.07" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer12_gpu4&#45;&gt;route_layer12_gpu4 -->
<g id="edge1189" class="edge">
<title>gate_layer12_gpu4&#45;&gt;route_layer12_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4658.31,-2809C4683.52,-2796.21 4711.56,-2781.99 4738.24,-2768.45"/>
<polygon fill="black" stroke="black" points="4739.9,-2771.54 4747.23,-2763.89 4736.73,-2765.3 4739.9,-2771.54"/>
</g>
<!-- route_layer12_gpu5 -->
<g id="node1032" class="node">
<title>route_layer12_gpu5</title>
<path fill="orange" stroke="black" d="M5998.74,-2763.77C5998.74,-2763.77 5490.24,-2763.77 5490.24,-2763.77 5484.24,-2763.77 5473.5,-2760.09 5468.75,-2756.42 5468.75,-2756.42 5350.75,-2665.11 5350.75,-2665.11 5346,-2661.44 5347.26,-2657.77 5353.26,-2657.77 5353.26,-2657.77 5861.76,-2657.77 5861.76,-2657.77 5867.76,-2657.77 5878.5,-2661.44 5883.25,-2665.11 5883.25,-2665.11 6001.25,-2756.42 6001.25,-2756.42 6006,-2760.09 6004.74,-2763.77 5998.74,-2763.77"/>
<text text-anchor="middle" x="5676" y="-2722.07" font-family="Times,serif" font-size="14.00">Token Router Layer 12 GPU 5</text>
<text text-anchor="middle" x="5676" y="-2707.07" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="5676" y="-2692.07" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer12_gpu5&#45;&gt;route_layer12_gpu5 -->
<g id="edge1190" class="edge">
<title>gate_layer12_gpu5&#45;&gt;route_layer12_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5584.34,-2804.76C5594.87,-2794.07 5606.2,-2782.58 5617.17,-2771.45"/>
<polygon fill="black" stroke="black" points="5619.8,-2773.77 5624.32,-2764.19 5614.81,-2768.86 5619.8,-2773.77"/>
</g>
<!-- route_layer12_gpu6 -->
<g id="node1034" class="node">
<title>route_layer12_gpu6</title>
<path fill="orange" stroke="black" d="M6962.74,-2763.77C6962.74,-2763.77 6454.24,-2763.77 6454.24,-2763.77 6448.24,-2763.77 6437.5,-2760.09 6432.75,-2756.42 6432.75,-2756.42 6314.75,-2665.11 6314.75,-2665.11 6310,-2661.44 6311.26,-2657.77 6317.26,-2657.77 6317.26,-2657.77 6825.76,-2657.77 6825.76,-2657.77 6831.76,-2657.77 6842.5,-2661.44 6847.25,-2665.11 6847.25,-2665.11 6965.25,-2756.42 6965.25,-2756.42 6970,-2760.09 6968.74,-2763.77 6962.74,-2763.77"/>
<text text-anchor="middle" x="6640" y="-2722.07" font-family="Times,serif" font-size="14.00">Token Router Layer 12 GPU 6</text>
<text text-anchor="middle" x="6640" y="-2707.07" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="6640" y="-2692.07" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer12_gpu6&#45;&gt;route_layer12_gpu6 -->
<g id="edge1191" class="edge">
<title>gate_layer12_gpu6&#45;&gt;route_layer12_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6548.34,-2804.76C6558.87,-2794.07 6570.2,-2782.58 6581.17,-2771.45"/>
<polygon fill="black" stroke="black" points="6583.8,-2773.77 6588.32,-2764.19 6578.81,-2768.86 6583.8,-2773.77"/>
</g>
<!-- route_layer12_gpu7 -->
<g id="node1036" class="node">
<title>route_layer12_gpu7</title>
<path fill="orange" stroke="black" d="M7857.74,-2763.77C7857.74,-2763.77 7349.24,-2763.77 7349.24,-2763.77 7343.24,-2763.77 7332.5,-2760.09 7327.75,-2756.42 7327.75,-2756.42 7209.75,-2665.11 7209.75,-2665.11 7205,-2661.44 7206.26,-2657.77 7212.26,-2657.77 7212.26,-2657.77 7720.76,-2657.77 7720.76,-2657.77 7726.76,-2657.77 7737.5,-2661.44 7742.25,-2665.11 7742.25,-2665.11 7860.25,-2756.42 7860.25,-2756.42 7865,-2760.09 7863.74,-2763.77 7857.74,-2763.77"/>
<text text-anchor="middle" x="7535" y="-2722.07" font-family="Times,serif" font-size="14.00">Token Router Layer 12 GPU 7</text>
<text text-anchor="middle" x="7535" y="-2707.07" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="7535" y="-2692.07" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer12_gpu7&#45;&gt;route_layer12_gpu7 -->
<g id="edge1192" class="edge">
<title>gate_layer12_gpu7&#45;&gt;route_layer12_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7490.33,-2802.41C7494.97,-2792.98 7499.89,-2783.01 7504.69,-2773.26"/>
<polygon fill="black" stroke="black" points="7507.97,-2774.52 7509.26,-2764 7501.7,-2771.42 7507.97,-2774.52"/>
</g>
<!-- route_layer12_gpu8 -->
<g id="node1038" class="node">
<title>route_layer12_gpu8</title>
<path fill="orange" stroke="black" d="M8683.74,-2763.77C8683.74,-2763.77 8175.24,-2763.77 8175.24,-2763.77 8169.24,-2763.77 8158.5,-2760.09 8153.75,-2756.42 8153.75,-2756.42 8035.75,-2665.11 8035.75,-2665.11 8031,-2661.44 8032.26,-2657.77 8038.26,-2657.77 8038.26,-2657.77 8546.76,-2657.77 8546.76,-2657.77 8552.76,-2657.77 8563.5,-2661.44 8568.25,-2665.11 8568.25,-2665.11 8686.25,-2756.42 8686.25,-2756.42 8691,-2760.09 8689.74,-2763.77 8683.74,-2763.77"/>
<text text-anchor="middle" x="8361" y="-2722.07" font-family="Times,serif" font-size="14.00">Token Router Layer 12 GPU 8</text>
<text text-anchor="middle" x="8361" y="-2707.07" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="8361" y="-2692.07" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer12_gpu8&#45;&gt;route_layer12_gpu8 -->
<g id="edge1193" class="edge">
<title>gate_layer12_gpu8&#45;&gt;route_layer12_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8405.67,-2802.41C8401.03,-2792.98 8396.11,-2783.01 8391.31,-2773.26"/>
<polygon fill="black" stroke="black" points="8394.3,-2771.42 8386.74,-2764 8388.03,-2774.52 8394.3,-2771.42"/>
</g>
<!-- route_layer12_gpu9 -->
<g id="node1040" class="node">
<title>route_layer12_gpu9</title>
<path fill="orange" stroke="black" d="M9578.74,-2763.77C9578.74,-2763.77 9070.24,-2763.77 9070.24,-2763.77 9064.24,-2763.77 9053.5,-2760.09 9048.75,-2756.42 9048.75,-2756.42 8930.75,-2665.11 8930.75,-2665.11 8926,-2661.44 8927.26,-2657.77 8933.26,-2657.77 8933.26,-2657.77 9441.76,-2657.77 9441.76,-2657.77 9447.76,-2657.77 9458.5,-2661.44 9463.25,-2665.11 9463.25,-2665.11 9581.25,-2756.42 9581.25,-2756.42 9586,-2760.09 9584.74,-2763.77 9578.74,-2763.77"/>
<text text-anchor="middle" x="9256" y="-2722.07" font-family="Times,serif" font-size="14.00">Token Router Layer 12 GPU 9</text>
<text text-anchor="middle" x="9256" y="-2707.07" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="9256" y="-2692.07" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer12_gpu9&#45;&gt;route_layer12_gpu9 -->
<g id="edge1194" class="edge">
<title>gate_layer12_gpu9&#45;&gt;route_layer12_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9347.66,-2804.76C9337.13,-2794.07 9325.8,-2782.58 9314.83,-2771.45"/>
<polygon fill="black" stroke="black" points="9317.19,-2768.86 9307.68,-2764.19 9312.2,-2773.77 9317.19,-2768.86"/>
</g>
<!-- route_layer12_gpu10 -->
<g id="node1042" class="node">
<title>route_layer12_gpu10</title>
<path fill="orange" stroke="black" d="M10507.74,-2763.77C10507.74,-2763.77 9999.24,-2763.77 9999.24,-2763.77 9993.24,-2763.77 9982.5,-2760.09 9977.75,-2756.42 9977.75,-2756.42 9859.75,-2665.11 9859.75,-2665.11 9855,-2661.44 9856.26,-2657.77 9862.26,-2657.77 9862.26,-2657.77 10370.76,-2657.77 10370.76,-2657.77 10376.76,-2657.77 10387.5,-2661.44 10392.25,-2665.11 10392.25,-2665.11 10510.25,-2756.42 10510.25,-2756.42 10515,-2760.09 10513.74,-2763.77 10507.74,-2763.77"/>
<text text-anchor="middle" x="10185" y="-2722.07" font-family="Times,serif" font-size="14.00">Token Router Layer 12 GPU 10</text>
<text text-anchor="middle" x="10185" y="-2707.07" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="10185" y="-2692.07" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer12_gpu10&#45;&gt;route_layer12_gpu10 -->
<g id="edge1195" class="edge">
<title>gate_layer12_gpu10&#45;&gt;route_layer12_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10301.35,-2805.93C10287.3,-2794.55 10272.05,-2782.21 10257.36,-2770.33"/>
<polygon fill="black" stroke="black" points="10259.24,-2767.35 10249.27,-2763.78 10254.84,-2772.79 10259.24,-2767.35"/>
</g>
<!-- route_layer12_gpu11 -->
<g id="node1044" class="node">
<title>route_layer12_gpu11</title>
<path fill="orange" stroke="black" d="M11454.74,-2763.77C11454.74,-2763.77 10946.24,-2763.77 10946.24,-2763.77 10940.24,-2763.77 10929.5,-2760.09 10924.75,-2756.42 10924.75,-2756.42 10806.75,-2665.11 10806.75,-2665.11 10802,-2661.44 10803.26,-2657.77 10809.26,-2657.77 10809.26,-2657.77 11317.76,-2657.77 11317.76,-2657.77 11323.76,-2657.77 11334.5,-2661.44 11339.25,-2665.11 11339.25,-2665.11 11457.25,-2756.42 11457.25,-2756.42 11462,-2760.09 11460.74,-2763.77 11454.74,-2763.77"/>
<text text-anchor="middle" x="11132" y="-2722.07" font-family="Times,serif" font-size="14.00">Token Router Layer 12 GPU 11</text>
<text text-anchor="middle" x="11132" y="-2707.07" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="11132" y="-2692.07" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer12_gpu11&#45;&gt;route_layer12_gpu11 -->
<g id="edge1196" class="edge">
<title>gate_layer12_gpu11&#45;&gt;route_layer12_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11260.57,-2806.51C11244.74,-2794.83 11227.47,-2782.11 11210.87,-2769.88"/>
<polygon fill="black" stroke="black" points="11212.92,-2767.04 11202.79,-2763.93 11208.77,-2772.68 11212.92,-2767.04"/>
</g>
<!-- route_layer12_gpu12 -->
<g id="node1046" class="node">
<title>route_layer12_gpu12</title>
<path fill="orange" stroke="black" d="M12409.74,-2763.77C12409.74,-2763.77 11901.24,-2763.77 11901.24,-2763.77 11895.24,-2763.77 11884.5,-2760.09 11879.75,-2756.42 11879.75,-2756.42 11761.75,-2665.11 11761.75,-2665.11 11757,-2661.44 11758.26,-2657.77 11764.26,-2657.77 11764.26,-2657.77 12272.76,-2657.77 12272.76,-2657.77 12278.76,-2657.77 12289.5,-2661.44 12294.25,-2665.11 12294.25,-2665.11 12412.25,-2756.42 12412.25,-2756.42 12417,-2760.09 12415.74,-2763.77 12409.74,-2763.77"/>
<text text-anchor="middle" x="12087" y="-2722.07" font-family="Times,serif" font-size="14.00">Token Router Layer 12 GPU 12</text>
<text text-anchor="middle" x="12087" y="-2707.07" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="12087" y="-2692.07" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer12_gpu12&#45;&gt;route_layer12_gpu12 -->
<g id="edge1197" class="edge">
<title>gate_layer12_gpu12&#45;&gt;route_layer12_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12222.21,-2806.89C12205.51,-2795.14 12187.25,-2782.3 12169.71,-2769.96"/>
<polygon fill="black" stroke="black" points="12171.36,-2766.84 12161.17,-2763.95 12167.34,-2772.56 12171.36,-2766.84"/>
</g>
<!-- route_layer12_gpu13 -->
<g id="node1048" class="node">
<title>route_layer12_gpu13</title>
<path fill="orange" stroke="black" d="M13369.74,-2763.77C13369.74,-2763.77 12861.24,-2763.77 12861.24,-2763.77 12855.24,-2763.77 12844.5,-2760.09 12839.75,-2756.42 12839.75,-2756.42 12721.75,-2665.11 12721.75,-2665.11 12717,-2661.44 12718.26,-2657.77 12724.26,-2657.77 12724.26,-2657.77 13232.76,-2657.77 13232.76,-2657.77 13238.76,-2657.77 13249.5,-2661.44 13254.25,-2665.11 13254.25,-2665.11 13372.25,-2756.42 13372.25,-2756.42 13377,-2760.09 13375.74,-2763.77 13369.74,-2763.77"/>
<text text-anchor="middle" x="13047" y="-2722.07" font-family="Times,serif" font-size="14.00">Token Router Layer 12 GPU 13</text>
<text text-anchor="middle" x="13047" y="-2707.07" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="13047" y="-2692.07" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer12_gpu13&#45;&gt;route_layer12_gpu13 -->
<g id="edge1198" class="edge">
<title>gate_layer12_gpu13&#45;&gt;route_layer12_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13184.93,-2806.89C13167.89,-2795.14 13149.27,-2782.3 13131.38,-2769.96"/>
<polygon fill="black" stroke="black" points="13132.88,-2766.74 13122.66,-2763.95 13128.91,-2772.51 13132.88,-2766.74"/>
</g>
<!-- route_layer12_gpu14 -->
<g id="node1050" class="node">
<title>route_layer12_gpu14</title>
<path fill="orange" stroke="black" d="M14331.74,-2763.77C14331.74,-2763.77 13823.24,-2763.77 13823.24,-2763.77 13817.24,-2763.77 13806.5,-2760.09 13801.75,-2756.42 13801.75,-2756.42 13683.75,-2665.11 13683.75,-2665.11 13679,-2661.44 13680.26,-2657.77 13686.26,-2657.77 13686.26,-2657.77 14194.76,-2657.77 14194.76,-2657.77 14200.76,-2657.77 14211.5,-2661.44 14216.25,-2665.11 14216.25,-2665.11 14334.25,-2756.42 14334.25,-2756.42 14339,-2760.09 14337.74,-2763.77 14331.74,-2763.77"/>
<text text-anchor="middle" x="14009" y="-2722.07" font-family="Times,serif" font-size="14.00">Token Router Layer 12 GPU 14</text>
<text text-anchor="middle" x="14009" y="-2707.07" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="14009" y="-2692.07" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer12_gpu14&#45;&gt;route_layer12_gpu14 -->
<g id="edge1199" class="edge">
<title>gate_layer12_gpu14&#45;&gt;route_layer12_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14148.57,-2807.08C14131.1,-2795.15 14111.96,-2782.08 14093.61,-2769.55"/>
<polygon fill="black" stroke="black" points="14095.47,-2766.58 14085.24,-2763.83 14091.52,-2772.36 14095.47,-2766.58"/>
</g>
<!-- route_layer12_gpu15 -->
<g id="node1052" class="node">
<title>route_layer12_gpu15</title>
<path fill="orange" stroke="black" d="M15294.74,-2763.77C15294.74,-2763.77 14786.24,-2763.77 14786.24,-2763.77 14780.24,-2763.77 14769.5,-2760.09 14764.75,-2756.42 14764.75,-2756.42 14646.75,-2665.11 14646.75,-2665.11 14642,-2661.44 14643.26,-2657.77 14649.26,-2657.77 14649.26,-2657.77 15157.76,-2657.77 15157.76,-2657.77 15163.76,-2657.77 15174.5,-2661.44 15179.25,-2665.11 15179.25,-2665.11 15297.25,-2756.42 15297.25,-2756.42 15302,-2760.09 15300.74,-2763.77 15294.74,-2763.77"/>
<text text-anchor="middle" x="14972" y="-2722.07" font-family="Times,serif" font-size="14.00">Token Router Layer 12 GPU 15</text>
<text text-anchor="middle" x="14972" y="-2707.07" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="14972" y="-2692.07" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer12_gpu15&#45;&gt;route_layer12_gpu15 -->
<g id="edge1200" class="edge">
<title>gate_layer12_gpu15&#45;&gt;route_layer12_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15112.25,-2807.08C15094.69,-2795.15 15075.46,-2782.08 15057.02,-2769.55"/>
<polygon fill="black" stroke="black" points="15058.85,-2766.56 15048.61,-2763.83 15054.91,-2772.35 15058.85,-2766.56"/>
</g>
<!-- expert_layer12_gpu0_expert0 -->
<g id="node1006" class="node">
<title>expert_layer12_gpu0_expert0</title>
<path fill="lightcoral" stroke="black" d="M1836.5,-2510.81C1836.5,-2510.81 1367.5,-2510.81 1367.5,-2510.81 1361.5,-2510.81 1355.5,-2504.81 1355.5,-2498.81 1355.5,-2498.81 1355.5,-2454.81 1355.5,-2454.81 1355.5,-2448.81 1361.5,-2442.81 1367.5,-2442.81 1367.5,-2442.81 1836.5,-2442.81 1836.5,-2442.81 1842.5,-2442.81 1848.5,-2448.81 1848.5,-2454.81 1848.5,-2454.81 1848.5,-2498.81 1848.5,-2498.81 1848.5,-2504.81 1842.5,-2510.81 1836.5,-2510.81"/>
<text text-anchor="middle" x="1602" y="-2495.61" font-family="Times,serif" font-size="14.00">Expert 0 Layer 12 GPU 0</text>
<text text-anchor="middle" x="1602" y="-2480.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="1602" y="-2465.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="1602" y="-2450.61" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer12_gpu0 -->
<g id="node1023" class="node">
<title>aggregate_layer12_gpu0</title>
<path fill="orange" stroke="black" d="M1465.29,-2406.81C1465.29,-2406.81 978.19,-2406.81 978.19,-2406.81 972.19,-2406.81 961.52,-2403.05 956.85,-2399.28 956.85,-2399.28 844.06,-2308.34 844.06,-2308.34 839.38,-2304.58 840.71,-2300.81 846.71,-2300.81 846.71,-2300.81 1333.81,-2300.81 1333.81,-2300.81 1339.81,-2300.81 1350.48,-2304.58 1355.15,-2308.34 1355.15,-2308.34 1467.94,-2399.28 1467.94,-2399.28 1472.62,-2403.05 1471.29,-2406.81 1465.29,-2406.81"/>
<text text-anchor="middle" x="1156" y="-2365.11" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 12 GPU 0</text>
<text text-anchor="middle" x="1156" y="-2350.11" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="1156" y="-2335.11" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer12_gpu0_expert0&#45;&gt;aggregate_layer12_gpu0 -->
<g id="edge1233" class="edge">
<title>expert_layer12_gpu0_expert0&#45;&gt;aggregate_layer12_gpu0</title>
<path fill="none" stroke="black" d="M1480.13,-2442.75C1442.2,-2432.46 1399.33,-2420.83 1357.47,-2409.47"/>
<polygon fill="black" stroke="black" points="1358.28,-2406.07 1347.71,-2406.82 1356.45,-2412.82 1358.28,-2406.07"/>
</g>
<!-- expert_layer12_gpu1_expert1 -->
<g id="node1007" class="node">
<title>expert_layer12_gpu1_expert1</title>
<path fill="lightcoral" stroke="black" d="M3038.5,-2510.81C3038.5,-2510.81 2569.5,-2510.81 2569.5,-2510.81 2563.5,-2510.81 2557.5,-2504.81 2557.5,-2498.81 2557.5,-2498.81 2557.5,-2454.81 2557.5,-2454.81 2557.5,-2448.81 2563.5,-2442.81 2569.5,-2442.81 2569.5,-2442.81 3038.5,-2442.81 3038.5,-2442.81 3044.5,-2442.81 3050.5,-2448.81 3050.5,-2454.81 3050.5,-2454.81 3050.5,-2498.81 3050.5,-2498.81 3050.5,-2504.81 3044.5,-2510.81 3038.5,-2510.81"/>
<text text-anchor="middle" x="2804" y="-2495.61" font-family="Times,serif" font-size="14.00">Expert 1 Layer 12 GPU 1</text>
<text text-anchor="middle" x="2804" y="-2480.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2804" y="-2465.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2804" y="-2450.61" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer12_gpu1 -->
<g id="node1025" class="node">
<title>aggregate_layer12_gpu1</title>
<path fill="orange" stroke="black" d="M2455.29,-2406.81C2455.29,-2406.81 1968.19,-2406.81 1968.19,-2406.81 1962.19,-2406.81 1951.52,-2403.05 1946.85,-2399.28 1946.85,-2399.28 1834.06,-2308.34 1834.06,-2308.34 1829.38,-2304.58 1830.71,-2300.81 1836.71,-2300.81 1836.71,-2300.81 2323.81,-2300.81 2323.81,-2300.81 2329.81,-2300.81 2340.48,-2304.58 2345.15,-2308.34 2345.15,-2308.34 2457.94,-2399.28 2457.94,-2399.28 2462.62,-2403.05 2461.29,-2406.81 2455.29,-2406.81"/>
<text text-anchor="middle" x="2146" y="-2365.11" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 12 GPU 1</text>
<text text-anchor="middle" x="2146" y="-2350.11" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="2146" y="-2335.11" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer12_gpu1_expert1&#45;&gt;aggregate_layer12_gpu1 -->
<g id="edge1234" class="edge">
<title>expert_layer12_gpu1_expert1&#45;&gt;aggregate_layer12_gpu1</title>
<path fill="none" stroke="black" d="M2624.2,-2442.75C2566.95,-2432.22 2502.06,-2420.29 2438.95,-2408.68"/>
<polygon fill="black" stroke="black" points="2439.31,-2405.19 2428.84,-2406.82 2438.04,-2412.08 2439.31,-2405.19"/>
</g>
<!-- expert_layer12_gpu2_expert2 -->
<g id="node1008" class="node">
<title>expert_layer12_gpu2_expert2</title>
<path fill="lightcoral" stroke="black" d="M3895.5,-2510.81C3895.5,-2510.81 3426.5,-2510.81 3426.5,-2510.81 3420.5,-2510.81 3414.5,-2504.81 3414.5,-2498.81 3414.5,-2498.81 3414.5,-2454.81 3414.5,-2454.81 3414.5,-2448.81 3420.5,-2442.81 3426.5,-2442.81 3426.5,-2442.81 3895.5,-2442.81 3895.5,-2442.81 3901.5,-2442.81 3907.5,-2448.81 3907.5,-2454.81 3907.5,-2454.81 3907.5,-2498.81 3907.5,-2498.81 3907.5,-2504.81 3901.5,-2510.81 3895.5,-2510.81"/>
<text text-anchor="middle" x="3661" y="-2495.61" font-family="Times,serif" font-size="14.00">Expert 2 Layer 12 GPU 2</text>
<text text-anchor="middle" x="3661" y="-2480.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3661" y="-2465.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3661" y="-2450.61" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer12_gpu2 -->
<g id="node1027" class="node">
<title>aggregate_layer12_gpu2</title>
<path fill="orange" stroke="black" d="M3511.29,-2406.81C3511.29,-2406.81 3024.19,-2406.81 3024.19,-2406.81 3018.19,-2406.81 3007.52,-2403.05 3002.85,-2399.28 3002.85,-2399.28 2890.06,-2308.34 2890.06,-2308.34 2885.38,-2304.58 2886.71,-2300.81 2892.71,-2300.81 2892.71,-2300.81 3379.81,-2300.81 3379.81,-2300.81 3385.81,-2300.81 3396.48,-2304.58 3401.15,-2308.34 3401.15,-2308.34 3513.94,-2399.28 3513.94,-2399.28 3518.62,-2403.05 3517.29,-2406.81 3511.29,-2406.81"/>
<text text-anchor="middle" x="3202" y="-2365.11" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 12 GPU 2</text>
<text text-anchor="middle" x="3202" y="-2350.11" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="3202" y="-2335.11" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer12_gpu2_expert2&#45;&gt;aggregate_layer12_gpu2 -->
<g id="edge1235" class="edge">
<title>expert_layer12_gpu2_expert2&#45;&gt;aggregate_layer12_gpu2</title>
<path fill="none" stroke="black" d="M3535.58,-2442.75C3496.46,-2432.44 3452.23,-2420.78 3409.07,-2409.4"/>
<polygon fill="black" stroke="black" points="3409.86,-2405.99 3399.3,-2406.82 3408.08,-2412.76 3409.86,-2405.99"/>
</g>
<!-- expert_layer12_gpu3_expert3 -->
<g id="node1009" class="node">
<title>expert_layer12_gpu3_expert3</title>
<path fill="lightcoral" stroke="black" d="M4579.5,-2510.81C4579.5,-2510.81 4110.5,-2510.81 4110.5,-2510.81 4104.5,-2510.81 4098.5,-2504.81 4098.5,-2498.81 4098.5,-2498.81 4098.5,-2454.81 4098.5,-2454.81 4098.5,-2448.81 4104.5,-2442.81 4110.5,-2442.81 4110.5,-2442.81 4579.5,-2442.81 4579.5,-2442.81 4585.5,-2442.81 4591.5,-2448.81 4591.5,-2454.81 4591.5,-2454.81 4591.5,-2498.81 4591.5,-2498.81 4591.5,-2504.81 4585.5,-2510.81 4579.5,-2510.81"/>
<text text-anchor="middle" x="4345" y="-2495.61" font-family="Times,serif" font-size="14.00">Expert 3 Layer 12 GPU 3</text>
<text text-anchor="middle" x="4345" y="-2480.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4345" y="-2465.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4345" y="-2450.61" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer12_gpu3 -->
<g id="node1029" class="node">
<title>aggregate_layer12_gpu3</title>
<path fill="orange" stroke="black" d="M4513.29,-2406.81C4513.29,-2406.81 4026.19,-2406.81 4026.19,-2406.81 4020.19,-2406.81 4009.52,-2403.05 4004.85,-2399.28 4004.85,-2399.28 3892.06,-2308.34 3892.06,-2308.34 3887.38,-2304.58 3888.71,-2300.81 3894.71,-2300.81 3894.71,-2300.81 4381.81,-2300.81 4381.81,-2300.81 4387.81,-2300.81 4398.48,-2304.58 4403.15,-2308.34 4403.15,-2308.34 4515.94,-2399.28 4515.94,-2399.28 4520.62,-2403.05 4519.29,-2406.81 4513.29,-2406.81"/>
<text text-anchor="middle" x="4204" y="-2365.11" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 12 GPU 3</text>
<text text-anchor="middle" x="4204" y="-2350.11" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="4204" y="-2335.11" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer12_gpu3_expert3&#45;&gt;aggregate_layer12_gpu3 -->
<g id="edge1236" class="edge">
<title>expert_layer12_gpu3_expert3&#45;&gt;aggregate_layer12_gpu3</title>
<path fill="none" stroke="black" d="M4306.47,-2442.75C4295.9,-2433.68 4284.12,-2423.57 4272.41,-2413.52"/>
<polygon fill="black" stroke="black" points="4274.61,-2410.8 4264.74,-2406.94 4270.05,-2416.11 4274.61,-2410.8"/>
</g>
<!-- expert_layer12_gpu4_expert4 -->
<g id="node1010" class="node">
<title>expert_layer12_gpu4_expert4</title>
<path fill="lightcoral" stroke="black" d="M5558.5,-2510.81C5558.5,-2510.81 5089.5,-2510.81 5089.5,-2510.81 5083.5,-2510.81 5077.5,-2504.81 5077.5,-2498.81 5077.5,-2498.81 5077.5,-2454.81 5077.5,-2454.81 5077.5,-2448.81 5083.5,-2442.81 5089.5,-2442.81 5089.5,-2442.81 5558.5,-2442.81 5558.5,-2442.81 5564.5,-2442.81 5570.5,-2448.81 5570.5,-2454.81 5570.5,-2454.81 5570.5,-2498.81 5570.5,-2498.81 5570.5,-2504.81 5564.5,-2510.81 5558.5,-2510.81"/>
<text text-anchor="middle" x="5324" y="-2495.61" font-family="Times,serif" font-size="14.00">Expert 4 Layer 12 GPU 4</text>
<text text-anchor="middle" x="5324" y="-2480.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5324" y="-2465.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5324" y="-2450.61" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer12_gpu4 -->
<g id="node1031" class="node">
<title>aggregate_layer12_gpu4</title>
<path fill="orange" stroke="black" d="M5345.29,-2406.81C5345.29,-2406.81 4858.19,-2406.81 4858.19,-2406.81 4852.19,-2406.81 4841.52,-2403.05 4836.85,-2399.28 4836.85,-2399.28 4724.06,-2308.34 4724.06,-2308.34 4719.38,-2304.58 4720.71,-2300.81 4726.71,-2300.81 4726.71,-2300.81 5213.81,-2300.81 5213.81,-2300.81 5219.81,-2300.81 5230.48,-2304.58 5235.15,-2308.34 5235.15,-2308.34 5347.94,-2399.28 5347.94,-2399.28 5352.62,-2403.05 5351.29,-2406.81 5345.29,-2406.81"/>
<text text-anchor="middle" x="5036" y="-2365.11" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 12 GPU 4</text>
<text text-anchor="middle" x="5036" y="-2350.11" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="5036" y="-2335.11" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer12_gpu4_expert4&#45;&gt;aggregate_layer12_gpu4 -->
<g id="edge1237" class="edge">
<title>expert_layer12_gpu4_expert4&#45;&gt;aggregate_layer12_gpu4</title>
<path fill="none" stroke="black" d="M5245.3,-2442.75C5221.79,-2432.87 5195.34,-2421.76 5169.34,-2410.84"/>
<polygon fill="black" stroke="black" points="5170.37,-2407.47 5159.8,-2406.82 5167.66,-2413.93 5170.37,-2407.47"/>
</g>
<!-- expert_layer12_gpu5_expert5 -->
<g id="node1011" class="node">
<title>expert_layer12_gpu5_expert5</title>
<path fill="lightcoral" stroke="black" d="M6468.5,-2510.81C6468.5,-2510.81 5999.5,-2510.81 5999.5,-2510.81 5993.5,-2510.81 5987.5,-2504.81 5987.5,-2498.81 5987.5,-2498.81 5987.5,-2454.81 5987.5,-2454.81 5987.5,-2448.81 5993.5,-2442.81 5999.5,-2442.81 5999.5,-2442.81 6468.5,-2442.81 6468.5,-2442.81 6474.5,-2442.81 6480.5,-2448.81 6480.5,-2454.81 6480.5,-2454.81 6480.5,-2498.81 6480.5,-2498.81 6480.5,-2504.81 6474.5,-2510.81 6468.5,-2510.81"/>
<text text-anchor="middle" x="6234" y="-2495.61" font-family="Times,serif" font-size="14.00">Expert 5 Layer 12 GPU 5</text>
<text text-anchor="middle" x="6234" y="-2480.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6234" y="-2465.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6234" y="-2450.61" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer12_gpu5 -->
<g id="node1033" class="node">
<title>aggregate_layer12_gpu5</title>
<path fill="orange" stroke="black" d="M6287.29,-2406.81C6287.29,-2406.81 5800.19,-2406.81 5800.19,-2406.81 5794.19,-2406.81 5783.52,-2403.05 5778.85,-2399.28 5778.85,-2399.28 5666.06,-2308.34 5666.06,-2308.34 5661.38,-2304.58 5662.71,-2300.81 5668.71,-2300.81 5668.71,-2300.81 6155.81,-2300.81 6155.81,-2300.81 6161.81,-2300.81 6172.48,-2304.58 6177.15,-2308.34 6177.15,-2308.34 6289.94,-2399.28 6289.94,-2399.28 6294.62,-2403.05 6293.29,-2406.81 6287.29,-2406.81"/>
<text text-anchor="middle" x="5978" y="-2365.11" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 12 GPU 5</text>
<text text-anchor="middle" x="5978" y="-2350.11" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="5978" y="-2335.11" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer12_gpu5_expert5&#45;&gt;aggregate_layer12_gpu5 -->
<g id="edge1238" class="edge">
<title>expert_layer12_gpu5_expert5&#45;&gt;aggregate_layer12_gpu5</title>
<path fill="none" stroke="black" d="M6164.05,-2442.75C6143.4,-2432.99 6120.19,-2422.02 6097.35,-2411.23"/>
<polygon fill="black" stroke="black" points="6098.82,-2408.05 6088.29,-2406.94 6095.83,-2414.38 6098.82,-2408.05"/>
</g>
<!-- expert_layer12_gpu6_expert6 -->
<g id="node1012" class="node">
<title>expert_layer12_gpu6_expert6</title>
<path fill="lightcoral" stroke="black" d="M7124.5,-2510.81C7124.5,-2510.81 6655.5,-2510.81 6655.5,-2510.81 6649.5,-2510.81 6643.5,-2504.81 6643.5,-2498.81 6643.5,-2498.81 6643.5,-2454.81 6643.5,-2454.81 6643.5,-2448.81 6649.5,-2442.81 6655.5,-2442.81 6655.5,-2442.81 7124.5,-2442.81 7124.5,-2442.81 7130.5,-2442.81 7136.5,-2448.81 7136.5,-2454.81 7136.5,-2454.81 7136.5,-2498.81 7136.5,-2498.81 7136.5,-2504.81 7130.5,-2510.81 7124.5,-2510.81"/>
<text text-anchor="middle" x="6890" y="-2495.61" font-family="Times,serif" font-size="14.00">Expert 6 Layer 12 GPU 6</text>
<text text-anchor="middle" x="6890" y="-2480.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6890" y="-2465.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6890" y="-2450.61" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer12_gpu6 -->
<g id="node1035" class="node">
<title>aggregate_layer12_gpu6</title>
<path fill="orange" stroke="black" d="M7089.29,-2406.81C7089.29,-2406.81 6602.19,-2406.81 6602.19,-2406.81 6596.19,-2406.81 6585.52,-2403.05 6580.85,-2399.28 6580.85,-2399.28 6468.06,-2308.34 6468.06,-2308.34 6463.38,-2304.58 6464.71,-2300.81 6470.71,-2300.81 6470.71,-2300.81 6957.81,-2300.81 6957.81,-2300.81 6963.81,-2300.81 6974.48,-2304.58 6979.15,-2308.34 6979.15,-2308.34 7091.94,-2399.28 7091.94,-2399.28 7096.62,-2403.05 7095.29,-2406.81 7089.29,-2406.81"/>
<text text-anchor="middle" x="6780" y="-2365.11" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 12 GPU 6</text>
<text text-anchor="middle" x="6780" y="-2350.11" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="6780" y="-2335.11" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer12_gpu6_expert6&#45;&gt;aggregate_layer12_gpu6 -->
<g id="edge1239" class="edge">
<title>expert_layer12_gpu6_expert6&#45;&gt;aggregate_layer12_gpu6</title>
<path fill="none" stroke="black" d="M6859.94,-2442.75C6851.93,-2433.94 6843.03,-2424.14 6834.15,-2414.38"/>
<polygon fill="black" stroke="black" points="6836.7,-2411.99 6827.39,-2406.94 6831.53,-2416.69 6836.7,-2411.99"/>
</g>
<!-- expert_layer12_gpu7_expert7 -->
<g id="node1013" class="node">
<title>expert_layer12_gpu7_expert7</title>
<path fill="lightcoral" stroke="black" d="M7801.5,-2510.81C7801.5,-2510.81 7332.5,-2510.81 7332.5,-2510.81 7326.5,-2510.81 7320.5,-2504.81 7320.5,-2498.81 7320.5,-2498.81 7320.5,-2454.81 7320.5,-2454.81 7320.5,-2448.81 7326.5,-2442.81 7332.5,-2442.81 7332.5,-2442.81 7801.5,-2442.81 7801.5,-2442.81 7807.5,-2442.81 7813.5,-2448.81 7813.5,-2454.81 7813.5,-2454.81 7813.5,-2498.81 7813.5,-2498.81 7813.5,-2504.81 7807.5,-2510.81 7801.5,-2510.81"/>
<text text-anchor="middle" x="7567" y="-2495.61" font-family="Times,serif" font-size="14.00">Expert 7 Layer 12 GPU 7</text>
<text text-anchor="middle" x="7567" y="-2480.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7567" y="-2465.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7567" y="-2450.61" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer12_gpu7 -->
<g id="node1037" class="node">
<title>aggregate_layer12_gpu7</title>
<path fill="orange" stroke="black" d="M7820.29,-2406.81C7820.29,-2406.81 7333.19,-2406.81 7333.19,-2406.81 7327.19,-2406.81 7316.52,-2403.05 7311.85,-2399.28 7311.85,-2399.28 7199.06,-2308.34 7199.06,-2308.34 7194.38,-2304.58 7195.71,-2300.81 7201.71,-2300.81 7201.71,-2300.81 7688.81,-2300.81 7688.81,-2300.81 7694.81,-2300.81 7705.48,-2304.58 7710.15,-2308.34 7710.15,-2308.34 7822.94,-2399.28 7822.94,-2399.28 7827.62,-2403.05 7826.29,-2406.81 7820.29,-2406.81"/>
<text text-anchor="middle" x="7511" y="-2365.11" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 12 GPU 7</text>
<text text-anchor="middle" x="7511" y="-2350.11" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="7511" y="-2335.11" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer12_gpu7_expert7&#45;&gt;aggregate_layer12_gpu7 -->
<g id="edge1240" class="edge">
<title>expert_layer12_gpu7_expert7&#45;&gt;aggregate_layer12_gpu7</title>
<path fill="none" stroke="black" d="M7551.7,-2442.75C7547.86,-2434.46 7543.62,-2425.29 7539.37,-2416.11"/>
<polygon fill="black" stroke="black" points="7542.5,-2414.55 7535.12,-2406.94 7536.15,-2417.49 7542.5,-2414.55"/>
</g>
<!-- expert_layer12_gpu8_expert8 -->
<g id="node1014" class="node">
<title>expert_layer12_gpu8_expert8</title>
<path fill="lightcoral" stroke="black" d="M8425.5,-2510.81C8425.5,-2510.81 7956.5,-2510.81 7956.5,-2510.81 7950.5,-2510.81 7944.5,-2504.81 7944.5,-2498.81 7944.5,-2498.81 7944.5,-2454.81 7944.5,-2454.81 7944.5,-2448.81 7950.5,-2442.81 7956.5,-2442.81 7956.5,-2442.81 8425.5,-2442.81 8425.5,-2442.81 8431.5,-2442.81 8437.5,-2448.81 8437.5,-2454.81 8437.5,-2454.81 8437.5,-2498.81 8437.5,-2498.81 8437.5,-2504.81 8431.5,-2510.81 8425.5,-2510.81"/>
<text text-anchor="middle" x="8191" y="-2495.61" font-family="Times,serif" font-size="14.00">Expert 8 Layer 12 GPU 8</text>
<text text-anchor="middle" x="8191" y="-2480.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8191" y="-2465.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8191" y="-2450.61" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer12_gpu8 -->
<g id="node1039" class="node">
<title>aggregate_layer12_gpu8</title>
<path fill="orange" stroke="black" d="M8557.29,-2406.81C8557.29,-2406.81 8070.19,-2406.81 8070.19,-2406.81 8064.19,-2406.81 8053.52,-2403.05 8048.85,-2399.28 8048.85,-2399.28 7936.06,-2308.34 7936.06,-2308.34 7931.38,-2304.58 7932.71,-2300.81 7938.71,-2300.81 7938.71,-2300.81 8425.81,-2300.81 8425.81,-2300.81 8431.81,-2300.81 8442.48,-2304.58 8447.15,-2308.34 8447.15,-2308.34 8559.94,-2399.28 8559.94,-2399.28 8564.62,-2403.05 8563.29,-2406.81 8557.29,-2406.81"/>
<text text-anchor="middle" x="8248" y="-2365.11" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 12 GPU 8</text>
<text text-anchor="middle" x="8248" y="-2350.11" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="8248" y="-2335.11" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer12_gpu8_expert8&#45;&gt;aggregate_layer12_gpu8 -->
<g id="edge1241" class="edge">
<title>expert_layer12_gpu8_expert8&#45;&gt;aggregate_layer12_gpu8</title>
<path fill="none" stroke="black" d="M8206.58,-2442.75C8210.48,-2434.46 8214.8,-2425.29 8219.13,-2416.11"/>
<polygon fill="black" stroke="black" points="8222.35,-2417.48 8223.44,-2406.94 8216.02,-2414.5 8222.35,-2417.48"/>
</g>
<!-- expert_layer12_gpu9_expert9 -->
<g id="node1015" class="node">
<title>expert_layer12_gpu9_expert9</title>
<path fill="lightcoral" stroke="black" d="M9162.5,-2510.81C9162.5,-2510.81 8693.5,-2510.81 8693.5,-2510.81 8687.5,-2510.81 8681.5,-2504.81 8681.5,-2498.81 8681.5,-2498.81 8681.5,-2454.81 8681.5,-2454.81 8681.5,-2448.81 8687.5,-2442.81 8693.5,-2442.81 8693.5,-2442.81 9162.5,-2442.81 9162.5,-2442.81 9168.5,-2442.81 9174.5,-2448.81 9174.5,-2454.81 9174.5,-2454.81 9174.5,-2498.81 9174.5,-2498.81 9174.5,-2504.81 9168.5,-2510.81 9162.5,-2510.81"/>
<text text-anchor="middle" x="8928" y="-2495.61" font-family="Times,serif" font-size="14.00">Expert 9 Layer 12 GPU 9</text>
<text text-anchor="middle" x="8928" y="-2480.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8928" y="-2465.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8928" y="-2450.61" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer12_gpu9 -->
<g id="node1041" class="node">
<title>aggregate_layer12_gpu9</title>
<path fill="orange" stroke="black" d="M9407.29,-2406.81C9407.29,-2406.81 8920.19,-2406.81 8920.19,-2406.81 8914.19,-2406.81 8903.52,-2403.05 8898.85,-2399.28 8898.85,-2399.28 8786.06,-2308.34 8786.06,-2308.34 8781.38,-2304.58 8782.71,-2300.81 8788.71,-2300.81 8788.71,-2300.81 9275.81,-2300.81 9275.81,-2300.81 9281.81,-2300.81 9292.48,-2304.58 9297.15,-2308.34 9297.15,-2308.34 9409.94,-2399.28 9409.94,-2399.28 9414.62,-2403.05 9413.29,-2406.81 9407.29,-2406.81"/>
<text text-anchor="middle" x="9098" y="-2365.11" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 12 GPU 9</text>
<text text-anchor="middle" x="9098" y="-2350.11" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="9098" y="-2335.11" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer12_gpu9_expert9&#45;&gt;aggregate_layer12_gpu9 -->
<g id="edge1242" class="edge">
<title>expert_layer12_gpu9_expert9&#45;&gt;aggregate_layer12_gpu9</title>
<path fill="none" stroke="black" d="M8974.45,-2442.75C8987.44,-2433.51 9001.94,-2423.18 9016.32,-2412.95"/>
<polygon fill="black" stroke="black" points="9018.65,-2415.59 9024.76,-2406.94 9014.59,-2409.89 9018.65,-2415.59"/>
</g>
<!-- expert_layer12_gpu10_expert10 -->
<g id="node1016" class="node">
<title>expert_layer12_gpu10_expert10</title>
<path fill="lightcoral" stroke="black" d="M9984.5,-2510.81C9984.5,-2510.81 9515.5,-2510.81 9515.5,-2510.81 9509.5,-2510.81 9503.5,-2504.81 9503.5,-2498.81 9503.5,-2498.81 9503.5,-2454.81 9503.5,-2454.81 9503.5,-2448.81 9509.5,-2442.81 9515.5,-2442.81 9515.5,-2442.81 9984.5,-2442.81 9984.5,-2442.81 9990.5,-2442.81 9996.5,-2448.81 9996.5,-2454.81 9996.5,-2454.81 9996.5,-2498.81 9996.5,-2498.81 9996.5,-2504.81 9990.5,-2510.81 9984.5,-2510.81"/>
<text text-anchor="middle" x="9750" y="-2495.61" font-family="Times,serif" font-size="14.00">Expert 10 Layer 12 GPU 10</text>
<text text-anchor="middle" x="9750" y="-2480.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9750" y="-2465.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9750" y="-2450.61" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer12_gpu10 -->
<g id="node1043" class="node">
<title>aggregate_layer12_gpu10</title>
<path fill="orange" stroke="black" d="M10314.29,-2406.81C10314.29,-2406.81 9827.19,-2406.81 9827.19,-2406.81 9821.19,-2406.81 9810.52,-2403.05 9805.85,-2399.28 9805.85,-2399.28 9693.06,-2308.34 9693.06,-2308.34 9688.38,-2304.58 9689.71,-2300.81 9695.71,-2300.81 9695.71,-2300.81 10182.81,-2300.81 10182.81,-2300.81 10188.81,-2300.81 10199.48,-2304.58 10204.15,-2308.34 10204.15,-2308.34 10316.94,-2399.28 10316.94,-2399.28 10321.62,-2403.05 10320.29,-2406.81 10314.29,-2406.81"/>
<text text-anchor="middle" x="10005" y="-2365.11" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 12 GPU 10</text>
<text text-anchor="middle" x="10005" y="-2350.11" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="10005" y="-2335.11" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer12_gpu10_expert10&#45;&gt;aggregate_layer12_gpu10 -->
<g id="edge1243" class="edge">
<title>expert_layer12_gpu10_expert10&#45;&gt;aggregate_layer12_gpu10</title>
<path fill="none" stroke="black" d="M9819.68,-2442.75C9840.16,-2433.03 9863.16,-2422.12 9885.81,-2411.37"/>
<polygon fill="black" stroke="black" points="9887.61,-2414.39 9895.15,-2406.94 9884.61,-2408.07 9887.61,-2414.39"/>
</g>
<!-- expert_layer12_gpu11_expert11 -->
<g id="node1017" class="node">
<title>expert_layer12_gpu11_expert11</title>
<path fill="lightcoral" stroke="black" d="M10863.5,-2510.81C10863.5,-2510.81 10394.5,-2510.81 10394.5,-2510.81 10388.5,-2510.81 10382.5,-2504.81 10382.5,-2498.81 10382.5,-2498.81 10382.5,-2454.81 10382.5,-2454.81 10382.5,-2448.81 10388.5,-2442.81 10394.5,-2442.81 10394.5,-2442.81 10863.5,-2442.81 10863.5,-2442.81 10869.5,-2442.81 10875.5,-2448.81 10875.5,-2454.81 10875.5,-2454.81 10875.5,-2498.81 10875.5,-2498.81 10875.5,-2504.81 10869.5,-2510.81 10863.5,-2510.81"/>
<text text-anchor="middle" x="10629" y="-2495.61" font-family="Times,serif" font-size="14.00">Expert 11 Layer 12 GPU 11</text>
<text text-anchor="middle" x="10629" y="-2480.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10629" y="-2465.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10629" y="-2450.61" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer12_gpu11 -->
<g id="node1045" class="node">
<title>aggregate_layer12_gpu11</title>
<path fill="orange" stroke="black" d="M11250.29,-2406.81C11250.29,-2406.81 10763.19,-2406.81 10763.19,-2406.81 10757.19,-2406.81 10746.52,-2403.05 10741.85,-2399.28 10741.85,-2399.28 10629.06,-2308.34 10629.06,-2308.34 10624.38,-2304.58 10625.71,-2300.81 10631.71,-2300.81 10631.71,-2300.81 11118.81,-2300.81 11118.81,-2300.81 11124.81,-2300.81 11135.48,-2304.58 11140.15,-2308.34 11140.15,-2308.34 11252.94,-2399.28 11252.94,-2399.28 11257.62,-2403.05 11256.29,-2406.81 11250.29,-2406.81"/>
<text text-anchor="middle" x="10941" y="-2365.11" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 12 GPU 11</text>
<text text-anchor="middle" x="10941" y="-2350.11" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="10941" y="-2335.11" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer12_gpu11_expert11&#45;&gt;aggregate_layer12_gpu11 -->
<g id="edge1244" class="edge">
<title>expert_layer12_gpu11_expert11&#45;&gt;aggregate_layer12_gpu11</title>
<path fill="none" stroke="black" d="M10714.26,-2442.75C10739.95,-2432.79 10768.89,-2421.56 10797.28,-2410.55"/>
<polygon fill="black" stroke="black" points="10798.83,-2413.7 10806.89,-2406.82 10796.3,-2407.18 10798.83,-2413.7"/>
</g>
<!-- expert_layer12_gpu12_expert12 -->
<g id="node1018" class="node">
<title>expert_layer12_gpu12_expert12</title>
<path fill="lightcoral" stroke="black" d="M11756.5,-2510.81C11756.5,-2510.81 11287.5,-2510.81 11287.5,-2510.81 11281.5,-2510.81 11275.5,-2504.81 11275.5,-2498.81 11275.5,-2498.81 11275.5,-2454.81 11275.5,-2454.81 11275.5,-2448.81 11281.5,-2442.81 11287.5,-2442.81 11287.5,-2442.81 11756.5,-2442.81 11756.5,-2442.81 11762.5,-2442.81 11768.5,-2448.81 11768.5,-2454.81 11768.5,-2454.81 11768.5,-2498.81 11768.5,-2498.81 11768.5,-2504.81 11762.5,-2510.81 11756.5,-2510.81"/>
<text text-anchor="middle" x="11522" y="-2495.61" font-family="Times,serif" font-size="14.00">Expert 12 Layer 12 GPU 12</text>
<text text-anchor="middle" x="11522" y="-2480.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11522" y="-2465.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11522" y="-2450.61" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer12_gpu12 -->
<g id="node1047" class="node">
<title>aggregate_layer12_gpu12</title>
<path fill="orange" stroke="black" d="M12157.29,-2406.81C12157.29,-2406.81 11670.19,-2406.81 11670.19,-2406.81 11664.19,-2406.81 11653.52,-2403.05 11648.85,-2399.28 11648.85,-2399.28 11536.06,-2308.34 11536.06,-2308.34 11531.38,-2304.58 11532.71,-2300.81 11538.71,-2300.81 11538.71,-2300.81 12025.81,-2300.81 12025.81,-2300.81 12031.81,-2300.81 12042.48,-2304.58 12047.15,-2308.34 12047.15,-2308.34 12159.94,-2399.28 12159.94,-2399.28 12164.62,-2403.05 12163.29,-2406.81 12157.29,-2406.81"/>
<text text-anchor="middle" x="11848" y="-2365.11" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 12 GPU 12</text>
<text text-anchor="middle" x="11848" y="-2350.11" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="11848" y="-2335.11" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer12_gpu12_expert12&#45;&gt;aggregate_layer12_gpu12 -->
<g id="edge1245" class="edge">
<title>expert_layer12_gpu12_expert12&#45;&gt;aggregate_layer12_gpu12</title>
<path fill="none" stroke="black" d="M11611.08,-2442.75C11638.04,-2432.74 11668.43,-2421.46 11698.22,-2410.41"/>
<polygon fill="black" stroke="black" points="11699.71,-2413.59 11707.87,-2406.82 11697.28,-2407.02 11699.71,-2413.59"/>
</g>
<!-- expert_layer12_gpu13_expert13 -->
<g id="node1019" class="node">
<title>expert_layer12_gpu13_expert13</title>
<path fill="lightcoral" stroke="black" d="M12594.5,-2510.81C12594.5,-2510.81 12125.5,-2510.81 12125.5,-2510.81 12119.5,-2510.81 12113.5,-2504.81 12113.5,-2498.81 12113.5,-2498.81 12113.5,-2454.81 12113.5,-2454.81 12113.5,-2448.81 12119.5,-2442.81 12125.5,-2442.81 12125.5,-2442.81 12594.5,-2442.81 12594.5,-2442.81 12600.5,-2442.81 12606.5,-2448.81 12606.5,-2454.81 12606.5,-2454.81 12606.5,-2498.81 12606.5,-2498.81 12606.5,-2504.81 12600.5,-2510.81 12594.5,-2510.81"/>
<text text-anchor="middle" x="12360" y="-2495.61" font-family="Times,serif" font-size="14.00">Expert 13 Layer 12 GPU 13</text>
<text text-anchor="middle" x="12360" y="-2480.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12360" y="-2465.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12360" y="-2450.61" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer12_gpu13 -->
<g id="node1049" class="node">
<title>aggregate_layer12_gpu13</title>
<path fill="orange" stroke="black" d="M12941.29,-2406.81C12941.29,-2406.81 12454.19,-2406.81 12454.19,-2406.81 12448.19,-2406.81 12437.52,-2403.05 12432.85,-2399.28 12432.85,-2399.28 12320.06,-2308.34 12320.06,-2308.34 12315.38,-2304.58 12316.71,-2300.81 12322.71,-2300.81 12322.71,-2300.81 12809.81,-2300.81 12809.81,-2300.81 12815.81,-2300.81 12826.48,-2304.58 12831.15,-2308.34 12831.15,-2308.34 12943.94,-2399.28 12943.94,-2399.28 12948.62,-2403.05 12947.29,-2406.81 12941.29,-2406.81"/>
<text text-anchor="middle" x="12632" y="-2365.11" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 12 GPU 13</text>
<text text-anchor="middle" x="12632" y="-2350.11" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="12632" y="-2335.11" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer12_gpu13_expert13&#45;&gt;aggregate_layer12_gpu13 -->
<g id="edge1246" class="edge">
<title>expert_layer12_gpu13_expert13&#45;&gt;aggregate_layer12_gpu13</title>
<path fill="none" stroke="black" d="M12434.33,-2442.75C12456.43,-2432.92 12481.3,-2421.85 12505.74,-2410.98"/>
<polygon fill="black" stroke="black" points="12507.37,-2414.09 12515.08,-2406.82 12504.52,-2407.69 12507.37,-2414.09"/>
</g>
<!-- expert_layer12_gpu14_expert14 -->
<g id="node1020" class="node">
<title>expert_layer12_gpu14_expert14</title>
<path fill="lightcoral" stroke="black" d="M13547.5,-2510.81C13547.5,-2510.81 13078.5,-2510.81 13078.5,-2510.81 13072.5,-2510.81 13066.5,-2504.81 13066.5,-2498.81 13066.5,-2498.81 13066.5,-2454.81 13066.5,-2454.81 13066.5,-2448.81 13072.5,-2442.81 13078.5,-2442.81 13078.5,-2442.81 13547.5,-2442.81 13547.5,-2442.81 13553.5,-2442.81 13559.5,-2448.81 13559.5,-2454.81 13559.5,-2454.81 13559.5,-2498.81 13559.5,-2498.81 13559.5,-2504.81 13553.5,-2510.81 13547.5,-2510.81"/>
<text text-anchor="middle" x="13313" y="-2495.61" font-family="Times,serif" font-size="14.00">Expert 14 Layer 12 GPU 14</text>
<text text-anchor="middle" x="13313" y="-2480.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="13313" y="-2465.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="13313" y="-2450.61" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer12_gpu14 -->
<g id="node1051" class="node">
<title>aggregate_layer12_gpu14</title>
<path fill="orange" stroke="black" d="M14009.29,-2406.81C14009.29,-2406.81 13522.19,-2406.81 13522.19,-2406.81 13516.19,-2406.81 13505.52,-2403.05 13500.85,-2399.28 13500.85,-2399.28 13388.06,-2308.34 13388.06,-2308.34 13383.38,-2304.58 13384.71,-2300.81 13390.71,-2300.81 13390.71,-2300.81 13877.81,-2300.81 13877.81,-2300.81 13883.81,-2300.81 13894.48,-2304.58 13899.15,-2308.34 13899.15,-2308.34 14011.94,-2399.28 14011.94,-2399.28 14016.62,-2403.05 14015.29,-2406.81 14009.29,-2406.81"/>
<text text-anchor="middle" x="13700" y="-2365.11" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 12 GPU 14</text>
<text text-anchor="middle" x="13700" y="-2350.11" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="13700" y="-2335.11" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer12_gpu14_expert14&#45;&gt;aggregate_layer12_gpu14 -->
<g id="edge1247" class="edge">
<title>expert_layer12_gpu14_expert14&#45;&gt;aggregate_layer12_gpu14</title>
<path fill="none" stroke="black" d="M13418.75,-2442.75C13451.31,-2432.57 13488.08,-2421.07 13524.03,-2409.83"/>
<polygon fill="black" stroke="black" points="13525.15,-2413.15 13533.65,-2406.82 13523.06,-2406.47 13525.15,-2413.15"/>
</g>
<!-- expert_layer12_gpu15_expert15 -->
<g id="node1021" class="node">
<title>expert_layer12_gpu15_expert15</title>
<path fill="lightcoral" stroke="black" d="M14532.5,-2510.81C14532.5,-2510.81 14063.5,-2510.81 14063.5,-2510.81 14057.5,-2510.81 14051.5,-2504.81 14051.5,-2498.81 14051.5,-2498.81 14051.5,-2454.81 14051.5,-2454.81 14051.5,-2448.81 14057.5,-2442.81 14063.5,-2442.81 14063.5,-2442.81 14532.5,-2442.81 14532.5,-2442.81 14538.5,-2442.81 14544.5,-2448.81 14544.5,-2454.81 14544.5,-2454.81 14544.5,-2498.81 14544.5,-2498.81 14544.5,-2504.81 14538.5,-2510.81 14532.5,-2510.81"/>
<text text-anchor="middle" x="14298" y="-2495.61" font-family="Times,serif" font-size="14.00">Expert 15 Layer 12 GPU 15</text>
<text text-anchor="middle" x="14298" y="-2480.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14298" y="-2465.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14298" y="-2450.61" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer12_gpu15 -->
<g id="node1053" class="node">
<title>aggregate_layer12_gpu15</title>
<path fill="orange" stroke="black" d="M15025.29,-2406.81C15025.29,-2406.81 14538.19,-2406.81 14538.19,-2406.81 14532.19,-2406.81 14521.52,-2403.05 14516.85,-2399.28 14516.85,-2399.28 14404.06,-2308.34 14404.06,-2308.34 14399.38,-2304.58 14400.71,-2300.81 14406.71,-2300.81 14406.71,-2300.81 14893.81,-2300.81 14893.81,-2300.81 14899.81,-2300.81 14910.48,-2304.58 14915.15,-2308.34 14915.15,-2308.34 15027.94,-2399.28 15027.94,-2399.28 15032.62,-2403.05 15031.29,-2406.81 15025.29,-2406.81"/>
<text text-anchor="middle" x="14716" y="-2365.11" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 12 GPU 15</text>
<text text-anchor="middle" x="14716" y="-2350.11" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="14716" y="-2335.11" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer12_gpu15_expert15&#45;&gt;aggregate_layer12_gpu15 -->
<g id="edge1248" class="edge">
<title>expert_layer12_gpu15_expert15&#45;&gt;aggregate_layer12_gpu15</title>
<path fill="none" stroke="black" d="M14412.22,-2442.75C14447.54,-2432.53 14487.44,-2420.97 14526.43,-2409.69"/>
<polygon fill="black" stroke="black" points="14527.69,-2412.97 14536.32,-2406.82 14525.74,-2406.24 14527.69,-2412.97"/>
</g>
<!-- comm_layer12 -->
<g id="node1054" class="node">
<title>comm_layer12</title>
<ellipse fill="lightpink" stroke="black" cx="7879" cy="-2584.29" rx="243.49" ry="37.45"/>
<text text-anchor="middle" x="7879" y="-2595.59" font-family="Times,serif" font-size="14.00">Cross&#45;GPU Communication Layer 12</text>
<text text-anchor="middle" x="7879" y="-2580.59" font-family="Times,serif" font-size="14.00">Input: Tokens from routing decisions</text>
<text text-anchor="middle" x="7879" y="-2565.59" font-family="Times,serif" font-size="14.00">Output: Tokens delivered to destination GPUs</text>
</g>
<!-- route_layer12_gpu0&#45;&gt;comm_layer12 -->
<g id="edge1201" class="edge">
<title>route_layer12_gpu0&#45;&gt;comm_layer12</title>
<path fill="none" stroke="black" d="M1290.65,-2680.67C1370.89,-2671.62 1461.82,-2662.72 1545,-2657.77 2758.5,-2585.53 6599.96,-2584.01 7625.35,-2584.94"/>
<polygon fill="black" stroke="black" points="7625.42,-2588.44 7635.42,-2584.94 7625.43,-2581.44 7625.42,-2588.44"/>
</g>
<!-- mha_layer13_gpu0 -->
<g id="node1055" class="node">
<title>mha_layer13_gpu0</title>
<path fill="lightblue" stroke="black" d="M992,-2264.81C992,-2264.81 544,-2264.81 544,-2264.81 538,-2264.81 532,-2258.81 532,-2252.81 532,-2252.81 532,-2223.81 532,-2223.81 532,-2217.81 538,-2211.81 544,-2211.81 544,-2211.81 992,-2211.81 992,-2211.81 998,-2211.81 1004,-2217.81 1004,-2223.81 1004,-2223.81 1004,-2252.81 1004,-2252.81 1004,-2258.81 998,-2264.81 992,-2264.81"/>
<text text-anchor="middle" x="768" y="-2249.61" font-family="Times,serif" font-size="14.00">MHA Layer 13 GPU 0</text>
<text text-anchor="middle" x="768" y="-2234.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="768" y="-2219.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer12_gpu0&#45;&gt;mha_layer13_gpu0 -->
<g id="edge1249" class="edge">
<title>aggregate_layer12_gpu0&#45;&gt;mha_layer13_gpu0</title>
<path fill="none" stroke="black" d="M978.18,-2300.8C939.35,-2289.44 899.64,-2277.82 865.35,-2267.79"/>
<polygon fill="black" stroke="black" points="865.94,-2264.32 855.36,-2264.87 863.97,-2271.03 865.94,-2264.32"/>
</g>
<!-- route_layer12_gpu1&#45;&gt;comm_layer12 -->
<g id="edge1202" class="edge">
<title>route_layer12_gpu1&#45;&gt;comm_layer12</title>
<path fill="none" stroke="black" d="M2128.64,-2689.96C2277.68,-2678.48 2473.36,-2664.92 2647,-2657.77 3633.87,-2617.11 6719.27,-2593.23 7626.01,-2586.96"/>
<polygon fill="black" stroke="black" points="7626.27,-2590.46 7636.24,-2586.89 7626.22,-2583.46 7626.27,-2590.46"/>
</g>
<!-- mha_layer13_gpu1 -->
<g id="node1056" class="node">
<title>mha_layer13_gpu1</title>
<path fill="lightblue" stroke="black" d="M2304,-2264.81C2304,-2264.81 1856,-2264.81 1856,-2264.81 1850,-2264.81 1844,-2258.81 1844,-2252.81 1844,-2252.81 1844,-2223.81 1844,-2223.81 1844,-2217.81 1850,-2211.81 1856,-2211.81 1856,-2211.81 2304,-2211.81 2304,-2211.81 2310,-2211.81 2316,-2217.81 2316,-2223.81 2316,-2223.81 2316,-2252.81 2316,-2252.81 2316,-2258.81 2310,-2264.81 2304,-2264.81"/>
<text text-anchor="middle" x="2080" y="-2249.61" font-family="Times,serif" font-size="14.00">MHA Layer 13 GPU 1</text>
<text text-anchor="middle" x="2080" y="-2234.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2080" y="-2219.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer12_gpu1&#45;&gt;mha_layer13_gpu1 -->
<g id="edge1250" class="edge">
<title>aggregate_layer12_gpu1&#45;&gt;mha_layer13_gpu1</title>
<path fill="none" stroke="black" d="M2115.7,-2300.71C2110.38,-2291.56 2104.96,-2282.23 2100,-2273.71"/>
<polygon fill="black" stroke="black" points="2102.89,-2271.71 2094.84,-2264.83 2096.84,-2275.23 2102.89,-2271.71"/>
</g>
<!-- route_layer12_gpu2&#45;&gt;comm_layer12 -->
<g id="edge1203" class="edge">
<title>route_layer12_gpu2&#45;&gt;comm_layer12</title>
<path fill="none" stroke="black" d="M3218.66,-2680.9C3298.91,-2671.87 3389.84,-2662.93 3473,-2657.77 4289.24,-2607.13 6815.15,-2590.52 7625.79,-2586.42"/>
<polygon fill="black" stroke="black" points="7625.86,-2589.92 7635.84,-2586.37 7625.82,-2582.92 7625.86,-2589.92"/>
</g>
<!-- mha_layer13_gpu2 -->
<g id="node1057" class="node">
<title>mha_layer13_gpu2</title>
<path fill="lightblue" stroke="black" d="M2912,-2264.81C2912,-2264.81 2464,-2264.81 2464,-2264.81 2458,-2264.81 2452,-2258.81 2452,-2252.81 2452,-2252.81 2452,-2223.81 2452,-2223.81 2452,-2217.81 2458,-2211.81 2464,-2211.81 2464,-2211.81 2912,-2211.81 2912,-2211.81 2918,-2211.81 2924,-2217.81 2924,-2223.81 2924,-2223.81 2924,-2252.81 2924,-2252.81 2924,-2258.81 2918,-2264.81 2912,-2264.81"/>
<text text-anchor="middle" x="2688" y="-2249.61" font-family="Times,serif" font-size="14.00">MHA Layer 13 GPU 2</text>
<text text-anchor="middle" x="2688" y="-2234.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2688" y="-2219.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer12_gpu2&#45;&gt;mha_layer13_gpu2 -->
<g id="edge1251" class="edge">
<title>aggregate_layer12_gpu2&#45;&gt;mha_layer13_gpu2</title>
<path fill="none" stroke="black" d="M2966.44,-2300.8C2913.78,-2289.17 2859.91,-2277.27 2813.76,-2267.08"/>
<polygon fill="black" stroke="black" points="2814.25,-2263.61 2803.73,-2264.87 2812.74,-2270.44 2814.25,-2263.61"/>
</g>
<!-- route_layer12_gpu3&#45;&gt;comm_layer12 -->
<g id="edge1204" class="edge">
<title>route_layer12_gpu3&#45;&gt;comm_layer12</title>
<path fill="none" stroke="black" d="M4054.76,-2688.65C4187.44,-2677.67 4355.78,-2665.04 4506,-2657.77 5670.75,-2601.34 7063.88,-2588.84 7625.72,-2586.08"/>
<polygon fill="black" stroke="black" points="7626,-2589.58 7635.98,-2586.03 7625.96,-2582.58 7626,-2589.58"/>
</g>
<!-- mha_layer13_gpu3 -->
<g id="node1058" class="node">
<title>mha_layer13_gpu3</title>
<path fill="lightblue" stroke="black" d="M3822,-2264.81C3822,-2264.81 3374,-2264.81 3374,-2264.81 3368,-2264.81 3362,-2258.81 3362,-2252.81 3362,-2252.81 3362,-2223.81 3362,-2223.81 3362,-2217.81 3368,-2211.81 3374,-2211.81 3374,-2211.81 3822,-2211.81 3822,-2211.81 3828,-2211.81 3834,-2217.81 3834,-2223.81 3834,-2223.81 3834,-2252.81 3834,-2252.81 3834,-2258.81 3828,-2264.81 3822,-2264.81"/>
<text text-anchor="middle" x="3598" y="-2249.61" font-family="Times,serif" font-size="14.00">MHA Layer 13 GPU 3</text>
<text text-anchor="middle" x="3598" y="-2234.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3598" y="-2219.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer12_gpu3&#45;&gt;mha_layer13_gpu3 -->
<g id="edge1252" class="edge">
<title>aggregate_layer12_gpu3&#45;&gt;mha_layer13_gpu3</title>
<path fill="none" stroke="black" d="M3926.27,-2300.8C3863.54,-2289.05 3799.35,-2277.02 3744.56,-2266.76"/>
<polygon fill="black" stroke="black" points="3744.92,-2263.27 3734.44,-2264.87 3743.63,-2270.15 3744.92,-2263.27"/>
</g>
<!-- route_layer12_gpu4&#45;&gt;comm_layer12 -->
<g id="edge1205" class="edge">
<title>route_layer12_gpu4&#45;&gt;comm_layer12</title>
<path fill="none" stroke="black" d="M5078.31,-2681.4C5158.41,-2672.44 5249.08,-2663.41 5332,-2657.77 6170.71,-2600.68 7167.75,-2588.41 7625.88,-2585.88"/>
<polygon fill="black" stroke="black" points="7625.95,-2589.38 7635.93,-2585.82 7625.91,-2582.38 7625.95,-2589.38"/>
</g>
<!-- mha_layer13_gpu4 -->
<g id="node1059" class="node">
<title>mha_layer13_gpu4</title>
<path fill="lightblue" stroke="black" d="M5043,-2264.81C5043,-2264.81 4595,-2264.81 4595,-2264.81 4589,-2264.81 4583,-2258.81 4583,-2252.81 4583,-2252.81 4583,-2223.81 4583,-2223.81 4583,-2217.81 4589,-2211.81 4595,-2211.81 4595,-2211.81 5043,-2211.81 5043,-2211.81 5049,-2211.81 5055,-2217.81 5055,-2223.81 5055,-2223.81 5055,-2252.81 5055,-2252.81 5055,-2258.81 5049,-2264.81 5043,-2264.81"/>
<text text-anchor="middle" x="4819" y="-2249.61" font-family="Times,serif" font-size="14.00">MHA Layer 13 GPU 4</text>
<text text-anchor="middle" x="4819" y="-2234.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4819" y="-2219.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer12_gpu4&#45;&gt;mha_layer13_gpu4 -->
<g id="edge1253" class="edge">
<title>aggregate_layer12_gpu4&#45;&gt;mha_layer13_gpu4</title>
<path fill="none" stroke="black" d="M4936.39,-2300.71C4915.99,-2290.05 4895.18,-2279.16 4876.84,-2269.57"/>
<polygon fill="black" stroke="black" points="4878.26,-2266.36 4867.78,-2264.83 4875.02,-2272.56 4878.26,-2266.36"/>
</g>
<!-- route_layer12_gpu5&#45;&gt;comm_layer12 -->
<g id="edge1206" class="edge">
<title>route_layer12_gpu5&#45;&gt;comm_layer12</title>
<path fill="none" stroke="black" d="M5912.84,-2687.78C6028.34,-2677.6 6169.35,-2665.97 6296,-2657.77 6768.57,-2627.14 7321.32,-2604.93 7632.77,-2593.67"/>
<polygon fill="black" stroke="black" points="7632.97,-2597.16 7642.84,-2593.31 7632.72,-2590.17 7632.97,-2597.16"/>
</g>
<!-- mha_layer13_gpu5 -->
<g id="node1060" class="node">
<title>mha_layer13_gpu5</title>
<path fill="lightblue" stroke="black" d="M5727,-2264.81C5727,-2264.81 5279,-2264.81 5279,-2264.81 5273,-2264.81 5267,-2258.81 5267,-2252.81 5267,-2252.81 5267,-2223.81 5267,-2223.81 5267,-2217.81 5273,-2211.81 5279,-2211.81 5279,-2211.81 5727,-2211.81 5727,-2211.81 5733,-2211.81 5739,-2217.81 5739,-2223.81 5739,-2223.81 5739,-2252.81 5739,-2252.81 5739,-2258.81 5733,-2264.81 5727,-2264.81"/>
<text text-anchor="middle" x="5503" y="-2249.61" font-family="Times,serif" font-size="14.00">MHA Layer 13 GPU 5</text>
<text text-anchor="middle" x="5503" y="-2234.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5503" y="-2219.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer12_gpu5&#45;&gt;mha_layer13_gpu5 -->
<g id="edge1254" class="edge">
<title>aggregate_layer12_gpu5&#45;&gt;mha_layer13_gpu5</title>
<path fill="none" stroke="black" d="M5760.31,-2300.8C5711.85,-2289.22 5662.28,-2277.37 5619.75,-2267.21"/>
<polygon fill="black" stroke="black" points="5620.49,-2263.79 5609.95,-2264.87 5618.86,-2270.6 5620.49,-2263.79"/>
</g>
<!-- route_layer12_gpu6&#45;&gt;comm_layer12 -->
<g id="edge1207" class="edge">
<title>route_layer12_gpu6&#45;&gt;comm_layer12</title>
<path fill="none" stroke="black" d="M6874.87,-2686.17C7103.44,-2663.21 7447.62,-2628.63 7667.78,-2606.51"/>
<polygon fill="black" stroke="black" points="7668.24,-2609.98 7677.84,-2605.5 7667.54,-2603.02 7668.24,-2609.98"/>
</g>
<!-- mha_layer13_gpu6 -->
<g id="node1061" class="node">
<title>mha_layer13_gpu6</title>
<path fill="lightblue" stroke="black" d="M6853,-2264.81C6853,-2264.81 6405,-2264.81 6405,-2264.81 6399,-2264.81 6393,-2258.81 6393,-2252.81 6393,-2252.81 6393,-2223.81 6393,-2223.81 6393,-2217.81 6399,-2211.81 6405,-2211.81 6405,-2211.81 6853,-2211.81 6853,-2211.81 6859,-2211.81 6865,-2217.81 6865,-2223.81 6865,-2223.81 6865,-2252.81 6865,-2252.81 6865,-2258.81 6859,-2264.81 6853,-2264.81"/>
<text text-anchor="middle" x="6629" y="-2249.61" font-family="Times,serif" font-size="14.00">MHA Layer 13 GPU 6</text>
<text text-anchor="middle" x="6629" y="-2234.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6629" y="-2219.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer12_gpu6&#45;&gt;mha_layer13_gpu6 -->
<g id="edge1255" class="edge">
<title>aggregate_layer12_gpu6&#45;&gt;mha_layer13_gpu6</title>
<path fill="none" stroke="black" d="M6710.69,-2300.71C6697.21,-2290.58 6683.46,-2280.25 6671.19,-2271.02"/>
<polygon fill="black" stroke="black" points="6673.04,-2268.04 6662.94,-2264.83 6668.83,-2273.63 6673.04,-2268.04"/>
</g>
<!-- route_layer12_gpu7&#45;&gt;comm_layer12 -->
<g id="edge1208" class="edge">
<title>route_layer12_gpu7&#45;&gt;comm_layer12</title>
<path fill="none" stroke="black" d="M7678.89,-2657.7C7711.54,-2645.89 7745.57,-2633.57 7776.12,-2622.52"/>
<polygon fill="black" stroke="black" points="7777.69,-2625.67 7785.91,-2618.98 7775.31,-2619.09 7777.69,-2625.67"/>
</g>
<!-- mha_layer13_gpu7 -->
<g id="node1062" class="node">
<title>mha_layer13_gpu7</title>
<path fill="lightblue" stroke="black" d="M7584,-2264.81C7584,-2264.81 7136,-2264.81 7136,-2264.81 7130,-2264.81 7124,-2258.81 7124,-2252.81 7124,-2252.81 7124,-2223.81 7124,-2223.81 7124,-2217.81 7130,-2211.81 7136,-2211.81 7136,-2211.81 7584,-2211.81 7584,-2211.81 7590,-2211.81 7596,-2217.81 7596,-2223.81 7596,-2223.81 7596,-2252.81 7596,-2252.81 7596,-2258.81 7590,-2264.81 7584,-2264.81"/>
<text text-anchor="middle" x="7360" y="-2249.61" font-family="Times,serif" font-size="14.00">MHA Layer 13 GPU 7</text>
<text text-anchor="middle" x="7360" y="-2234.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7360" y="-2219.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer12_gpu7&#45;&gt;mha_layer13_gpu7 -->
<g id="edge1256" class="edge">
<title>aggregate_layer12_gpu7&#45;&gt;mha_layer13_gpu7</title>
<path fill="none" stroke="black" d="M7441.69,-2300.71C7428.21,-2290.58 7414.46,-2280.25 7402.19,-2271.02"/>
<polygon fill="black" stroke="black" points="7404.04,-2268.04 7393.94,-2264.83 7399.83,-2273.63 7404.04,-2268.04"/>
</g>
<!-- route_layer12_gpu8&#45;&gt;comm_layer12 -->
<g id="edge1209" class="edge">
<title>route_layer12_gpu8&#45;&gt;comm_layer12</title>
<path fill="none" stroke="black" d="M8159.38,-2657.7C8109.27,-2644.76 8056.83,-2631.21 8011.03,-2619.39"/>
<polygon fill="black" stroke="black" points="8011.62,-2615.92 8001.06,-2616.81 8009.87,-2622.7 8011.62,-2615.92"/>
</g>
<!-- mha_layer13_gpu8 -->
<g id="node1063" class="node">
<title>mha_layer13_gpu8</title>
<path fill="lightblue" stroke="black" d="M8491,-2264.81C8491,-2264.81 8043,-2264.81 8043,-2264.81 8037,-2264.81 8031,-2258.81 8031,-2252.81 8031,-2252.81 8031,-2223.81 8031,-2223.81 8031,-2217.81 8037,-2211.81 8043,-2211.81 8043,-2211.81 8491,-2211.81 8491,-2211.81 8497,-2211.81 8503,-2217.81 8503,-2223.81 8503,-2223.81 8503,-2252.81 8503,-2252.81 8503,-2258.81 8497,-2264.81 8491,-2264.81"/>
<text text-anchor="middle" x="8267" y="-2249.61" font-family="Times,serif" font-size="14.00">MHA Layer 13 GPU 8</text>
<text text-anchor="middle" x="8267" y="-2234.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8267" y="-2219.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer12_gpu8&#45;&gt;mha_layer13_gpu8 -->
<g id="edge1257" class="edge">
<title>aggregate_layer12_gpu8&#45;&gt;mha_layer13_gpu8</title>
<path fill="none" stroke="black" d="M8256.72,-2300.71C8258.19,-2291.95 8259.68,-2283.03 8261.06,-2274.81"/>
<polygon fill="black" stroke="black" points="8264.53,-2275.27 8262.73,-2264.83 8257.63,-2274.11 8264.53,-2275.27"/>
</g>
<!-- route_layer12_gpu9&#45;&gt;comm_layer12 -->
<g id="edge1210" class="edge">
<title>route_layer12_gpu9&#45;&gt;comm_layer12</title>
<path fill="none" stroke="black" d="M8950.73,-2680.6C8870.78,-2673.06 8784.66,-2665.02 8705,-2657.77 8499.63,-2639.07 8265.46,-2618.6 8099.03,-2604.2"/>
<polygon fill="black" stroke="black" points="8098.93,-2600.68 8088.67,-2603.3 8098.33,-2607.65 8098.93,-2600.68"/>
</g>
<!-- mha_layer13_gpu9 -->
<g id="node1064" class="node">
<title>mha_layer13_gpu9</title>
<path fill="lightblue" stroke="black" d="M9398,-2264.81C9398,-2264.81 8950,-2264.81 8950,-2264.81 8944,-2264.81 8938,-2258.81 8938,-2252.81 8938,-2252.81 8938,-2223.81 8938,-2223.81 8938,-2217.81 8944,-2211.81 8950,-2211.81 8950,-2211.81 9398,-2211.81 9398,-2211.81 9404,-2211.81 9410,-2217.81 9410,-2223.81 9410,-2223.81 9410,-2252.81 9410,-2252.81 9410,-2258.81 9404,-2264.81 9398,-2264.81"/>
<text text-anchor="middle" x="9174" y="-2249.61" font-family="Times,serif" font-size="14.00">MHA Layer 13 GPU 9</text>
<text text-anchor="middle" x="9174" y="-2234.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9174" y="-2219.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer12_gpu9&#45;&gt;mha_layer13_gpu9 -->
<g id="edge1258" class="edge">
<title>aggregate_layer12_gpu9&#45;&gt;mha_layer13_gpu9</title>
<path fill="none" stroke="black" d="M9132.89,-2300.71C9139.15,-2291.36 9145.53,-2281.84 9151.33,-2273.17"/>
<polygon fill="black" stroke="black" points="9154.26,-2275.08 9156.92,-2264.83 9148.44,-2271.19 9154.26,-2275.08"/>
</g>
<!-- route_layer12_gpu10&#45;&gt;comm_layer12 -->
<g id="edge1211" class="edge">
<title>route_layer12_gpu10&#45;&gt;comm_layer12</title>
<path fill="none" stroke="black" d="M9878.56,-2679.82C9788.85,-2671.79 9690.55,-2663.69 9600,-2657.77 9076.68,-2623.51 8462.71,-2602.17 8127.88,-2592.13"/>
<polygon fill="black" stroke="black" points="8127.67,-2588.63 8117.57,-2591.83 8127.46,-2595.62 8127.67,-2588.63"/>
</g>
<!-- mha_layer13_gpu10 -->
<g id="node1065" class="node">
<title>mha_layer13_gpu10</title>
<path fill="lightblue" stroke="black" d="M10333,-2264.81C10333,-2264.81 9885,-2264.81 9885,-2264.81 9879,-2264.81 9873,-2258.81 9873,-2252.81 9873,-2252.81 9873,-2223.81 9873,-2223.81 9873,-2217.81 9879,-2211.81 9885,-2211.81 9885,-2211.81 10333,-2211.81 10333,-2211.81 10339,-2211.81 10345,-2217.81 10345,-2223.81 10345,-2223.81 10345,-2252.81 10345,-2252.81 10345,-2258.81 10339,-2264.81 10333,-2264.81"/>
<text text-anchor="middle" x="10109" y="-2249.61" font-family="Times,serif" font-size="14.00">MHA Layer 13 GPU 10</text>
<text text-anchor="middle" x="10109" y="-2234.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10109" y="-2219.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer12_gpu10&#45;&gt;mha_layer13_gpu10 -->
<g id="edge1259" class="edge">
<title>aggregate_layer12_gpu10&#45;&gt;mha_layer13_gpu10</title>
<path fill="none" stroke="black" d="M10052.74,-2300.71C10061.58,-2291.07 10070.58,-2281.24 10078.72,-2272.36"/>
<polygon fill="black" stroke="black" points="10081.45,-2274.56 10085.62,-2264.83 10076.29,-2269.84 10081.45,-2274.56"/>
</g>
<!-- route_layer12_gpu11&#45;&gt;comm_layer12 -->
<g id="edge1212" class="edge">
<title>route_layer12_gpu11&#45;&gt;comm_layer12</title>
<path fill="none" stroke="black" d="M10825.49,-2679.83C10730.54,-2671.5 10625.51,-2663.24 10529,-2657.77 9649.29,-2607.85 8603.29,-2592.06 8131.71,-2587.27"/>
<polygon fill="black" stroke="black" points="8131.75,-2583.77 8121.71,-2587.17 8131.68,-2590.77 8131.75,-2583.77"/>
</g>
<!-- mha_layer13_gpu11 -->
<g id="node1066" class="node">
<title>mha_layer13_gpu11</title>
<path fill="lightblue" stroke="black" d="M11283,-2264.81C11283,-2264.81 10835,-2264.81 10835,-2264.81 10829,-2264.81 10823,-2258.81 10823,-2252.81 10823,-2252.81 10823,-2223.81 10823,-2223.81 10823,-2217.81 10829,-2211.81 10835,-2211.81 10835,-2211.81 11283,-2211.81 11283,-2211.81 11289,-2211.81 11295,-2217.81 11295,-2223.81 11295,-2223.81 11295,-2252.81 11295,-2252.81 11295,-2258.81 11289,-2264.81 11283,-2264.81"/>
<text text-anchor="middle" x="11059" y="-2249.61" font-family="Times,serif" font-size="14.00">MHA Layer 13 GPU 11</text>
<text text-anchor="middle" x="11059" y="-2234.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11059" y="-2219.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer12_gpu11&#45;&gt;mha_layer13_gpu11 -->
<g id="edge1260" class="edge">
<title>aggregate_layer12_gpu11&#45;&gt;mha_layer13_gpu11</title>
<path fill="none" stroke="black" d="M10995.16,-2300.71C11005.4,-2290.87 11015.82,-2280.85 11025.2,-2271.82"/>
<polygon fill="black" stroke="black" points="11027.69,-2274.28 11032.47,-2264.83 11022.84,-2269.24 11027.69,-2274.28"/>
</g>
<!-- route_layer12_gpu12&#45;&gt;comm_layer12 -->
<g id="edge1213" class="edge">
<title>route_layer12_gpu12&#45;&gt;comm_layer12</title>
<path fill="none" stroke="black" d="M11780.35,-2679.76C11683.12,-2671.29 11575.14,-2662.98 11476,-2657.77 10222.64,-2591.87 8720.73,-2584.77 8132.66,-2584.76"/>
<polygon fill="black" stroke="black" points="8132.36,-2581.26 8122.36,-2584.76 8132.36,-2588.26 8132.36,-2581.26"/>
</g>
<!-- mha_layer13_gpu12 -->
<g id="node1067" class="node">
<title>mha_layer13_gpu12</title>
<path fill="lightblue" stroke="black" d="M12323,-2264.81C12323,-2264.81 11875,-2264.81 11875,-2264.81 11869,-2264.81 11863,-2258.81 11863,-2252.81 11863,-2252.81 11863,-2223.81 11863,-2223.81 11863,-2217.81 11869,-2211.81 11875,-2211.81 11875,-2211.81 12323,-2211.81 12323,-2211.81 12329,-2211.81 12335,-2217.81 12335,-2223.81 12335,-2223.81 12335,-2252.81 12335,-2252.81 12335,-2258.81 12329,-2264.81 12323,-2264.81"/>
<text text-anchor="middle" x="12099" y="-2249.61" font-family="Times,serif" font-size="14.00">MHA Layer 13 GPU 12</text>
<text text-anchor="middle" x="12099" y="-2234.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12099" y="-2219.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer12_gpu12&#45;&gt;mha_layer13_gpu12 -->
<g id="edge1261" class="edge">
<title>aggregate_layer12_gpu12&#45;&gt;mha_layer13_gpu12</title>
<path fill="none" stroke="black" d="M11963.22,-2300.71C11987.24,-2289.85 12011.77,-2278.76 12033.25,-2269.04"/>
<polygon fill="black" stroke="black" points="12034.91,-2272.14 12042.58,-2264.83 12032.02,-2265.76 12034.91,-2272.14"/>
</g>
<!-- route_layer12_gpu13&#45;&gt;comm_layer12 -->
<g id="edge1214" class="edge">
<title>route_layer12_gpu13&#45;&gt;comm_layer12</title>
<path fill="none" stroke="black" d="M12740.61,-2679.75C12641.87,-2671.19 12531.89,-2662.82 12431,-2657.77 11584.33,-2615.34 8960.43,-2593.13 8132.2,-2587.04"/>
<polygon fill="black" stroke="black" points="8131.96,-2583.54 8121.94,-2586.97 8131.91,-2590.54 8131.96,-2583.54"/>
</g>
<!-- mha_layer13_gpu13 -->
<g id="node1068" class="node">
<title>mha_layer13_gpu13</title>
<path fill="lightblue" stroke="black" d="M12898,-2264.81C12898,-2264.81 12450,-2264.81 12450,-2264.81 12444,-2264.81 12438,-2258.81 12438,-2252.81 12438,-2252.81 12438,-2223.81 12438,-2223.81 12438,-2217.81 12444,-2211.81 12450,-2211.81 12450,-2211.81 12898,-2211.81 12898,-2211.81 12904,-2211.81 12910,-2217.81 12910,-2223.81 12910,-2223.81 12910,-2252.81 12910,-2252.81 12910,-2258.81 12904,-2264.81 12898,-2264.81"/>
<text text-anchor="middle" x="12674" y="-2249.61" font-family="Times,serif" font-size="14.00">MHA Layer 13 GPU 13</text>
<text text-anchor="middle" x="12674" y="-2234.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12674" y="-2219.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer12_gpu13&#45;&gt;mha_layer13_gpu13 -->
<g id="edge1262" class="edge">
<title>aggregate_layer12_gpu13&#45;&gt;mha_layer13_gpu13</title>
<path fill="none" stroke="black" d="M12651.28,-2300.71C12654.6,-2291.75 12657.97,-2282.63 12661.07,-2274.26"/>
<polygon fill="black" stroke="black" points="12664.37,-2275.42 12664.56,-2264.83 12657.81,-2272.99 12664.37,-2275.42"/>
</g>
<!-- route_layer12_gpu14&#45;&gt;comm_layer12 -->
<g id="edge1215" class="edge">
<title>route_layer12_gpu14&#45;&gt;comm_layer12</title>
<path fill="none" stroke="black" d="M13702.41,-2679.65C13603.15,-2671.06 13492.49,-2662.7 13391,-2657.77 12346.78,-2607.03 9070.27,-2590.11 8132.23,-2586.23"/>
<polygon fill="black" stroke="black" points="8131.99,-2582.73 8121.98,-2586.19 8131.96,-2589.73 8131.99,-2582.73"/>
</g>
<!-- mha_layer13_gpu14 -->
<g id="node1069" class="node">
<title>mha_layer13_gpu14</title>
<path fill="lightblue" stroke="black" d="M14109,-2264.81C14109,-2264.81 13661,-2264.81 13661,-2264.81 13655,-2264.81 13649,-2258.81 13649,-2252.81 13649,-2252.81 13649,-2223.81 13649,-2223.81 13649,-2217.81 13655,-2211.81 13661,-2211.81 13661,-2211.81 14109,-2211.81 14109,-2211.81 14115,-2211.81 14121,-2217.81 14121,-2223.81 14121,-2223.81 14121,-2252.81 14121,-2252.81 14121,-2258.81 14115,-2264.81 14109,-2264.81"/>
<text text-anchor="middle" x="13885" y="-2249.61" font-family="Times,serif" font-size="14.00">MHA Layer 13 GPU 14</text>
<text text-anchor="middle" x="13885" y="-2234.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13885" y="-2219.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer12_gpu14&#45;&gt;mha_layer13_gpu14 -->
<g id="edge1263" class="edge">
<title>aggregate_layer12_gpu14&#45;&gt;mha_layer13_gpu14</title>
<path fill="none" stroke="black" d="M13784.92,-2300.71C13801.91,-2290.29 13819.25,-2279.65 13834.61,-2270.23"/>
<polygon fill="black" stroke="black" points="13836.72,-2273.04 13843.41,-2264.83 13833.06,-2267.07 13836.72,-2273.04"/>
</g>
<!-- route_layer12_gpu15&#45;&gt;comm_layer12 -->
<g id="edge1216" class="edge">
<title>route_layer12_gpu15&#45;&gt;comm_layer12</title>
<path fill="none" stroke="black" d="M14665.31,-2679.57C14565.79,-2670.96 14454.8,-2662.61 14353,-2657.77 13109.62,-2598.66 9171.7,-2587.58 8132.49,-2585.66"/>
<polygon fill="black" stroke="black" points="8132.28,-2582.16 8122.27,-2585.65 8132.27,-2589.16 8132.28,-2582.16"/>
</g>
<!-- mha_layer13_gpu15 -->
<g id="node1070" class="node">
<title>mha_layer13_gpu15</title>
<path fill="lightblue" stroke="black" d="M15099,-2264.81C15099,-2264.81 14651,-2264.81 14651,-2264.81 14645,-2264.81 14639,-2258.81 14639,-2252.81 14639,-2252.81 14639,-2223.81 14639,-2223.81 14639,-2217.81 14645,-2211.81 14651,-2211.81 14651,-2211.81 15099,-2211.81 15099,-2211.81 15105,-2211.81 15111,-2217.81 15111,-2223.81 15111,-2223.81 15111,-2252.81 15111,-2252.81 15111,-2258.81 15105,-2264.81 15099,-2264.81"/>
<text text-anchor="middle" x="14875" y="-2249.61" font-family="Times,serif" font-size="14.00">MHA Layer 13 GPU 15</text>
<text text-anchor="middle" x="14875" y="-2234.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14875" y="-2219.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer12_gpu15&#45;&gt;mha_layer13_gpu15 -->
<g id="edge1264" class="edge">
<title>aggregate_layer12_gpu15&#45;&gt;mha_layer13_gpu15</title>
<path fill="none" stroke="black" d="M14788.99,-2300.71C14803.32,-2290.48 14817.93,-2280.05 14830.95,-2270.76"/>
<polygon fill="black" stroke="black" points="14833.15,-2273.49 14839.26,-2264.83 14829.09,-2267.79 14833.15,-2273.49"/>
</g>
<!-- comm_layer12&#45;&gt;expert_layer12_gpu0_expert0 -->
<g id="edge1217" class="edge">
<title>comm_layer12&#45;&gt;expert_layer12_gpu0_expert0</title>
<path fill="none" stroke="black" d="M7636.21,-2581.83C6881.78,-2576.89 4511.16,-2558.39 2548,-2510.81 2314.78,-2505.16 2049.31,-2495.63 1859.08,-2488.26"/>
<polygon fill="black" stroke="black" points="1859.07,-2484.76 1848.94,-2487.87 1858.8,-2491.75 1859.07,-2484.76"/>
</g>
<!-- comm_layer12&#45;&gt;expert_layer12_gpu1_expert1 -->
<g id="edge1218" class="edge">
<title>comm_layer12&#45;&gt;expert_layer12_gpu1_expert1</title>
<path fill="none" stroke="black" d="M7635.82,-2582.65C6962.92,-2580.17 5019.32,-2568.19 3405,-2510.81 3292.07,-2506.8 3167.31,-2500.29 3060.86,-2494.11"/>
<polygon fill="black" stroke="black" points="3060.81,-2490.6 3050.62,-2493.51 3060.4,-2497.59 3060.81,-2490.6"/>
</g>
<!-- comm_layer12&#45;&gt;expert_layer12_gpu2_expert2 -->
<g id="edge1219" class="edge">
<title>comm_layer12&#45;&gt;expert_layer12_gpu2_expert2</title>
<path fill="none" stroke="black" d="M7635.8,-2583.51C7034.05,-2582.99 5427.32,-2575.15 4089,-2510.81 4033.52,-2508.15 3974.07,-2504.24 3917.67,-2500.03"/>
<polygon fill="black" stroke="black" points="3917.78,-2496.53 3907.54,-2499.27 3917.25,-2503.51 3917.78,-2496.53"/>
</g>
<!-- comm_layer12&#45;&gt;expert_layer12_gpu3_expert3 -->
<g id="edge1220" class="edge">
<title>comm_layer12&#45;&gt;expert_layer12_gpu3_expert3</title>
<path fill="none" stroke="black" d="M7638.3,-2578.69C7152.36,-2569.06 6019.35,-2544.79 5068,-2510.81 4913.34,-2505.29 4740.14,-2497.44 4602.04,-2490.79"/>
<polygon fill="black" stroke="black" points="4601.9,-2487.28 4591.74,-2490.29 4601.56,-2494.27 4601.9,-2487.28"/>
</g>
<!-- comm_layer12&#45;&gt;expert_layer12_gpu4_expert4 -->
<g id="edge1221" class="edge">
<title>comm_layer12&#45;&gt;expert_layer12_gpu4_expert4</title>
<path fill="none" stroke="black" d="M7642.61,-2575.21C7283.08,-2562.72 6577.27,-2537.36 5978,-2510.81 5847.09,-2505.02 5701.49,-2497.75 5580.96,-2491.51"/>
<polygon fill="black" stroke="black" points="5581.03,-2488.01 5570.86,-2490.99 5580.66,-2495 5581.03,-2488.01"/>
</g>
<!-- comm_layer12&#45;&gt;expert_layer12_gpu5_expert5 -->
<g id="edge1222" class="edge">
<title>comm_layer12&#45;&gt;expert_layer12_gpu5_expert5</title>
<path fill="none" stroke="black" d="M7650,-2571.62C7400.16,-2558.5 6988.47,-2535.75 6634,-2510.81 6587.68,-2507.56 6538.38,-2503.76 6490.78,-2499.92"/>
<polygon fill="black" stroke="black" points="6490.9,-2496.42 6480.65,-2499.1 6490.33,-2503.4 6490.9,-2496.42"/>
</g>
<!-- comm_layer12&#45;&gt;expert_layer12_gpu6_expert6 -->
<g id="edge1223" class="edge">
<title>comm_layer12&#45;&gt;expert_layer12_gpu6_expert6</title>
<path fill="none" stroke="black" d="M7681.83,-2562.26C7528.39,-2545.9 7314.19,-2523.05 7147.26,-2505.25"/>
<polygon fill="black" stroke="black" points="7147.15,-2501.72 7136.84,-2504.14 7146.41,-2508.68 7147.15,-2501.72"/>
</g>
<!-- comm_layer12&#45;&gt;expert_layer12_gpu7_expert7 -->
<g id="edge1224" class="edge">
<title>comm_layer12&#45;&gt;expert_layer12_gpu7_expert7</title>
<path fill="none" stroke="black" d="M7780.28,-2549.92C7746.58,-2538.52 7708.74,-2525.73 7674.4,-2514.12"/>
<polygon fill="black" stroke="black" points="7675.4,-2510.77 7664.81,-2510.88 7673.16,-2517.4 7675.4,-2510.77"/>
</g>
<!-- comm_layer12&#45;&gt;expert_layer12_gpu8_expert8 -->
<g id="edge1225" class="edge">
<title>comm_layer12&#45;&gt;expert_layer12_gpu8_expert8</title>
<path fill="none" stroke="black" d="M7977.72,-2549.92C8011.42,-2538.52 8049.26,-2525.73 8083.6,-2514.12"/>
<polygon fill="black" stroke="black" points="8084.84,-2517.4 8093.19,-2510.88 8082.6,-2510.77 8084.84,-2517.4"/>
</g>
<!-- comm_layer12&#45;&gt;expert_layer12_gpu9_expert9 -->
<g id="edge1226" class="edge">
<title>comm_layer12&#45;&gt;expert_layer12_gpu9_expert9</title>
<path fill="none" stroke="black" d="M8079.71,-2563.11C8247.91,-2546.2 8489.1,-2521.94 8671.33,-2503.62"/>
<polygon fill="black" stroke="black" points="8671.73,-2507.1 8681.33,-2502.62 8671.03,-2500.13 8671.73,-2507.1"/>
</g>
<!-- comm_layer12&#45;&gt;expert_layer12_gpu10_expert10 -->
<g id="edge1227" class="edge">
<title>comm_layer12&#45;&gt;expert_layer12_gpu10_expert10</title>
<path fill="none" stroke="black" d="M8106.33,-2570.84C8366.54,-2556.54 8805.52,-2532.29 9183,-2510.81 9284.38,-2505.05 9395.95,-2498.58 9493.1,-2492.91"/>
<polygon fill="black" stroke="black" points="9493.58,-2496.39 9503.36,-2492.31 9493.17,-2489.4 9493.58,-2496.39"/>
</g>
<!-- comm_layer12&#45;&gt;expert_layer12_gpu11_expert11 -->
<g id="edge1228" class="edge">
<title>comm_layer12&#45;&gt;expert_layer12_gpu11_expert11</title>
<path fill="none" stroke="black" d="M8117.39,-2576.62C8510.67,-2565.29 9320.11,-2540.59 10005,-2510.81 10125.73,-2505.56 10259.53,-2498.63 10372.17,-2492.48"/>
<polygon fill="black" stroke="black" points="10372.52,-2495.97 10382.31,-2491.93 10372.14,-2488.98 10372.52,-2495.97"/>
</g>
<!-- comm_layer12&#45;&gt;expert_layer12_gpu12_expert12 -->
<g id="edge1229" class="edge">
<title>comm_layer12&#45;&gt;expert_layer12_gpu12_expert12</title>
<path fill="none" stroke="black" d="M8120.57,-2579.72C8630.98,-2571.69 9856.69,-2549.76 10884,-2510.81 11009.46,-2506.06 11148.72,-2499.05 11265.04,-2492.72"/>
<polygon fill="black" stroke="black" points="11265.35,-2496.21 11275.15,-2492.17 11264.97,-2489.22 11265.35,-2496.21"/>
</g>
<!-- comm_layer12&#45;&gt;expert_layer12_gpu13_expert13 -->
<g id="edge1230" class="edge">
<title>comm_layer12&#45;&gt;expert_layer12_gpu13_expert13</title>
<path fill="none" stroke="black" d="M8121.98,-2581.98C8735.1,-2577.96 10394.66,-2562.77 11777,-2510.81 11883.86,-2506.8 12001.65,-2500.49 12103.21,-2494.46"/>
<polygon fill="black" stroke="black" points="12103.53,-2497.94 12113.3,-2493.85 12103.11,-2490.96 12103.53,-2497.94"/>
</g>
<!-- comm_layer12&#45;&gt;expert_layer12_gpu14_expert14 -->
<g id="edge1231" class="edge">
<title>comm_layer12&#45;&gt;expert_layer12_gpu14_expert14</title>
<path fill="none" stroke="black" d="M8122.13,-2582.31C8820.8,-2578.9 10894.37,-2564.64 12615,-2510.81 12761.1,-2506.24 12924.29,-2498.66 13056.12,-2491.92"/>
<polygon fill="black" stroke="black" points="13056.55,-2495.41 13066.36,-2491.4 13056.19,-2488.41 13056.55,-2495.41"/>
</g>
<!-- comm_layer12&#45;&gt;expert_layer12_gpu15_expert15 -->
<g id="edge1232" class="edge">
<title>comm_layer12&#45;&gt;expert_layer12_gpu15_expert15</title>
<path fill="none" stroke="black" d="M8122.34,-2583.01C8909.73,-2581.5 11459.41,-2571.89 13568,-2510.81 13725.28,-2506.26 13901.5,-2498.37 14041.4,-2491.45"/>
<polygon fill="black" stroke="black" points="14041.59,-2494.94 14051.41,-2490.95 14041.25,-2487.95 14041.59,-2494.94"/>
</g>
<!-- gate_layer13_gpu0 -->
<g id="node1071" class="node">
<title>gate_layer13_gpu0</title>
<path fill="lightsteelblue" stroke="black" d="M562.07,-2174.48C562.07,-2174.48 112.93,-2124.15 112.93,-2124.15 106.96,-2123.48 106.96,-2122.15 112.93,-2121.48 112.93,-2121.48 562.07,-2071.15 562.07,-2071.15 568.04,-2070.48 579.96,-2070.48 585.93,-2071.15 585.93,-2071.15 1035.07,-2121.48 1035.07,-2121.48 1041.04,-2122.15 1041.04,-2123.48 1035.07,-2124.15 1035.07,-2124.15 585.93,-2174.48 585.93,-2174.48 579.96,-2175.15 568.04,-2175.15 562.07,-2174.48"/>
<text text-anchor="middle" x="574" y="-2134.11" font-family="Times,serif" font-size="14.00">Gate Layer 13 GPU 0</text>
<text text-anchor="middle" x="574" y="-2119.11" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="574" y="-2104.11" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer13_gpu0&#45;&gt;gate_layer13_gpu0 -->
<g id="edge1265" class="edge">
<title>mha_layer13_gpu0&#45;&gt;gate_layer13_gpu0</title>
<path fill="none" stroke="black" d="M723.98,-2211.56C704.25,-2200.02 680.31,-2186.01 657.4,-2172.61"/>
<polygon fill="black" stroke="black" points="659.08,-2169.53 648.68,-2167.5 655.54,-2175.57 659.08,-2169.53"/>
</g>
<!-- gate_layer13_gpu1 -->
<g id="node1072" class="node">
<title>gate_layer13_gpu1</title>
<path fill="lightsteelblue" stroke="black" d="M1526.07,-2174.48C1526.07,-2174.48 1076.93,-2124.15 1076.93,-2124.15 1070.96,-2123.48 1070.96,-2122.15 1076.93,-2121.48 1076.93,-2121.48 1526.07,-2071.15 1526.07,-2071.15 1532.04,-2070.48 1543.96,-2070.48 1549.93,-2071.15 1549.93,-2071.15 1999.07,-2121.48 1999.07,-2121.48 2005.04,-2122.15 2005.04,-2123.48 1999.07,-2124.15 1999.07,-2124.15 1549.93,-2174.48 1549.93,-2174.48 1543.96,-2175.15 1532.04,-2175.15 1526.07,-2174.48"/>
<text text-anchor="middle" x="1538" y="-2134.11" font-family="Times,serif" font-size="14.00">Gate Layer 13 GPU 1</text>
<text text-anchor="middle" x="1538" y="-2119.11" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="1538" y="-2104.11" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer13_gpu1&#45;&gt;gate_layer13_gpu1 -->
<g id="edge1266" class="edge">
<title>mha_layer13_gpu1&#45;&gt;gate_layer13_gpu1</title>
<path fill="none" stroke="black" d="M1958.03,-2211.77C1884.91,-2196.46 1790.78,-2176.75 1710.17,-2159.87"/>
<polygon fill="black" stroke="black" points="1710.41,-2156.34 1699.91,-2157.72 1708.98,-2163.19 1710.41,-2156.34"/>
</g>
<!-- gate_layer13_gpu2 -->
<g id="node1073" class="node">
<title>gate_layer13_gpu2</title>
<path fill="lightsteelblue" stroke="black" d="M2490.07,-2174.48C2490.07,-2174.48 2040.93,-2124.15 2040.93,-2124.15 2034.96,-2123.48 2034.96,-2122.15 2040.93,-2121.48 2040.93,-2121.48 2490.07,-2071.15 2490.07,-2071.15 2496.04,-2070.48 2507.96,-2070.48 2513.93,-2071.15 2513.93,-2071.15 2963.07,-2121.48 2963.07,-2121.48 2969.04,-2122.15 2969.04,-2123.48 2963.07,-2124.15 2963.07,-2124.15 2513.93,-2174.48 2513.93,-2174.48 2507.96,-2175.15 2496.04,-2175.15 2490.07,-2174.48"/>
<text text-anchor="middle" x="2502" y="-2134.11" font-family="Times,serif" font-size="14.00">Gate Layer 13 GPU 2</text>
<text text-anchor="middle" x="2502" y="-2119.11" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="2502" y="-2104.11" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer13_gpu2&#45;&gt;gate_layer13_gpu2 -->
<g id="edge1267" class="edge">
<title>mha_layer13_gpu2&#45;&gt;gate_layer13_gpu2</title>
<path fill="none" stroke="black" d="M2645.79,-2211.56C2627.15,-2200.18 2604.59,-2186.41 2582.91,-2173.18"/>
<polygon fill="black" stroke="black" points="2584.69,-2170.17 2574.33,-2167.95 2581.05,-2176.15 2584.69,-2170.17"/>
</g>
<!-- gate_layer13_gpu3 -->
<g id="node1074" class="node">
<title>gate_layer13_gpu3</title>
<path fill="lightsteelblue" stroke="black" d="M3454.07,-2174.48C3454.07,-2174.48 3004.93,-2124.15 3004.93,-2124.15 2998.96,-2123.48 2998.96,-2122.15 3004.93,-2121.48 3004.93,-2121.48 3454.07,-2071.15 3454.07,-2071.15 3460.04,-2070.48 3471.96,-2070.48 3477.93,-2071.15 3477.93,-2071.15 3927.07,-2121.48 3927.07,-2121.48 3933.04,-2122.15 3933.04,-2123.48 3927.07,-2124.15 3927.07,-2124.15 3477.93,-2174.48 3477.93,-2174.48 3471.96,-2175.15 3460.04,-2175.15 3454.07,-2174.48"/>
<text text-anchor="middle" x="3466" y="-2134.11" font-family="Times,serif" font-size="14.00">Gate Layer 13 GPU 3</text>
<text text-anchor="middle" x="3466" y="-2119.11" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="3466" y="-2104.11" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer13_gpu3&#45;&gt;gate_layer13_gpu3 -->
<g id="edge1268" class="edge">
<title>mha_layer13_gpu3&#45;&gt;gate_layer13_gpu3</title>
<path fill="none" stroke="black" d="M3568.05,-2211.56C3555.98,-2201.18 3541.6,-2188.82 3527.49,-2176.68"/>
<polygon fill="black" stroke="black" points="3529.56,-2173.85 3519.7,-2169.98 3525,-2179.16 3529.56,-2173.85"/>
</g>
<!-- gate_layer13_gpu4 -->
<g id="node1075" class="node">
<title>gate_layer13_gpu4</title>
<path fill="lightsteelblue" stroke="black" d="M4418.07,-2174.48C4418.07,-2174.48 3968.93,-2124.15 3968.93,-2124.15 3962.96,-2123.48 3962.96,-2122.15 3968.93,-2121.48 3968.93,-2121.48 4418.07,-2071.15 4418.07,-2071.15 4424.04,-2070.48 4435.96,-2070.48 4441.93,-2071.15 4441.93,-2071.15 4891.07,-2121.48 4891.07,-2121.48 4897.04,-2122.15 4897.04,-2123.48 4891.07,-2124.15 4891.07,-2124.15 4441.93,-2174.48 4441.93,-2174.48 4435.96,-2175.15 4424.04,-2175.15 4418.07,-2174.48"/>
<text text-anchor="middle" x="4430" y="-2134.11" font-family="Times,serif" font-size="14.00">Gate Layer 13 GPU 4</text>
<text text-anchor="middle" x="4430" y="-2119.11" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4430" y="-2104.11" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer13_gpu4&#45;&gt;gate_layer13_gpu4 -->
<g id="edge1269" class="edge">
<title>mha_layer13_gpu4&#45;&gt;gate_layer13_gpu4</title>
<path fill="none" stroke="black" d="M4731.22,-2211.7C4683.23,-2197.7 4622.69,-2180.04 4568.5,-2164.22"/>
<polygon fill="black" stroke="black" points="4569.39,-2160.84 4558.81,-2161.4 4567.43,-2167.56 4569.39,-2160.84"/>
</g>
<!-- gate_layer13_gpu5 -->
<g id="node1076" class="node">
<title>gate_layer13_gpu5</title>
<path fill="lightsteelblue" stroke="black" d="M5382.07,-2174.48C5382.07,-2174.48 4932.93,-2124.15 4932.93,-2124.15 4926.96,-2123.48 4926.96,-2122.15 4932.93,-2121.48 4932.93,-2121.48 5382.07,-2071.15 5382.07,-2071.15 5388.04,-2070.48 5399.96,-2070.48 5405.93,-2071.15 5405.93,-2071.15 5855.07,-2121.48 5855.07,-2121.48 5861.04,-2122.15 5861.04,-2123.48 5855.07,-2124.15 5855.07,-2124.15 5405.93,-2174.48 5405.93,-2174.48 5399.96,-2175.15 5388.04,-2175.15 5382.07,-2174.48"/>
<text text-anchor="middle" x="5394" y="-2134.11" font-family="Times,serif" font-size="14.00">Gate Layer 13 GPU 5</text>
<text text-anchor="middle" x="5394" y="-2119.11" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5394" y="-2104.11" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer13_gpu5&#45;&gt;gate_layer13_gpu5 -->
<g id="edge1270" class="edge">
<title>mha_layer13_gpu5&#45;&gt;gate_layer13_gpu5</title>
<path fill="none" stroke="black" d="M5478.27,-2211.56C5468.7,-2201.59 5457.36,-2189.79 5446.15,-2178.12"/>
<polygon fill="black" stroke="black" points="5448.66,-2175.68 5439.21,-2170.89 5443.61,-2180.53 5448.66,-2175.68"/>
</g>
<!-- gate_layer13_gpu6 -->
<g id="node1077" class="node">
<title>gate_layer13_gpu6</title>
<path fill="lightsteelblue" stroke="black" d="M6346.07,-2174.48C6346.07,-2174.48 5896.93,-2124.15 5896.93,-2124.15 5890.96,-2123.48 5890.96,-2122.15 5896.93,-2121.48 5896.93,-2121.48 6346.07,-2071.15 6346.07,-2071.15 6352.04,-2070.48 6363.96,-2070.48 6369.93,-2071.15 6369.93,-2071.15 6819.07,-2121.48 6819.07,-2121.48 6825.04,-2122.15 6825.04,-2123.48 6819.07,-2124.15 6819.07,-2124.15 6369.93,-2174.48 6369.93,-2174.48 6363.96,-2175.15 6352.04,-2175.15 6346.07,-2174.48"/>
<text text-anchor="middle" x="6358" y="-2134.11" font-family="Times,serif" font-size="14.00">Gate Layer 13 GPU 6</text>
<text text-anchor="middle" x="6358" y="-2119.11" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6358" y="-2104.11" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer13_gpu6&#45;&gt;gate_layer13_gpu6 -->
<g id="edge1271" class="edge">
<title>mha_layer13_gpu6&#45;&gt;gate_layer13_gpu6</title>
<path fill="none" stroke="black" d="M6567.84,-2211.7C6537.61,-2199.04 6500.22,-2183.38 6465.41,-2168.8"/>
<polygon fill="black" stroke="black" points="6466.73,-2165.55 6456.15,-2164.92 6464.02,-2172.01 6466.73,-2165.55"/>
</g>
<!-- gate_layer13_gpu7 -->
<g id="node1078" class="node">
<title>gate_layer13_gpu7</title>
<path fill="lightsteelblue" stroke="black" d="M7310.07,-2174.48C7310.07,-2174.48 6860.93,-2124.15 6860.93,-2124.15 6854.96,-2123.48 6854.96,-2122.15 6860.93,-2121.48 6860.93,-2121.48 7310.07,-2071.15 7310.07,-2071.15 7316.04,-2070.48 7327.96,-2070.48 7333.93,-2071.15 7333.93,-2071.15 7783.07,-2121.48 7783.07,-2121.48 7789.04,-2122.15 7789.04,-2123.48 7783.07,-2124.15 7783.07,-2124.15 7333.93,-2174.48 7333.93,-2174.48 7327.96,-2175.15 7316.04,-2175.15 7310.07,-2174.48"/>
<text text-anchor="middle" x="7322" y="-2134.11" font-family="Times,serif" font-size="14.00">Gate Layer 13 GPU 7</text>
<text text-anchor="middle" x="7322" y="-2119.11" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="7322" y="-2104.11" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer13_gpu7&#45;&gt;gate_layer13_gpu7 -->
<g id="edge1272" class="edge">
<title>mha_layer13_gpu7&#45;&gt;gate_layer13_gpu7</title>
<path fill="none" stroke="black" d="M7351.38,-2211.56C7348.59,-2203.22 7345.36,-2193.59 7342.1,-2183.84"/>
<polygon fill="black" stroke="black" points="7345.32,-2182.45 7338.83,-2174.08 7338.68,-2184.67 7345.32,-2182.45"/>
</g>
<!-- gate_layer13_gpu8 -->
<g id="node1079" class="node">
<title>gate_layer13_gpu8</title>
<path fill="lightsteelblue" stroke="black" d="M8274.07,-2174.48C8274.07,-2174.48 7824.93,-2124.15 7824.93,-2124.15 7818.96,-2123.48 7818.96,-2122.15 7824.93,-2121.48 7824.93,-2121.48 8274.07,-2071.15 8274.07,-2071.15 8280.04,-2070.48 8291.96,-2070.48 8297.93,-2071.15 8297.93,-2071.15 8747.07,-2121.48 8747.07,-2121.48 8753.04,-2122.15 8753.04,-2123.48 8747.07,-2124.15 8747.07,-2124.15 8297.93,-2174.48 8297.93,-2174.48 8291.96,-2175.15 8280.04,-2175.15 8274.07,-2174.48"/>
<text text-anchor="middle" x="8286" y="-2134.11" font-family="Times,serif" font-size="14.00">Gate Layer 13 GPU 8</text>
<text text-anchor="middle" x="8286" y="-2119.11" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="8286" y="-2104.11" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer13_gpu8&#45;&gt;gate_layer13_gpu8 -->
<g id="edge1273" class="edge">
<title>mha_layer13_gpu8&#45;&gt;gate_layer13_gpu8</title>
<path fill="none" stroke="black" d="M8271.31,-2211.56C8272.65,-2203.59 8274.18,-2194.43 8275.74,-2185.12"/>
<polygon fill="black" stroke="black" points="8279.23,-2185.43 8277.43,-2174.99 8272.33,-2184.28 8279.23,-2185.43"/>
</g>
<!-- gate_layer13_gpu9 -->
<g id="node1080" class="node">
<title>gate_layer13_gpu9</title>
<path fill="lightsteelblue" stroke="black" d="M9238.07,-2174.48C9238.07,-2174.48 8788.93,-2124.15 8788.93,-2124.15 8782.96,-2123.48 8782.96,-2122.15 8788.93,-2121.48 8788.93,-2121.48 9238.07,-2071.15 9238.07,-2071.15 9244.04,-2070.48 9255.96,-2070.48 9261.93,-2071.15 9261.93,-2071.15 9711.07,-2121.48 9711.07,-2121.48 9717.04,-2122.15 9717.04,-2123.48 9711.07,-2124.15 9711.07,-2124.15 9261.93,-2174.48 9261.93,-2174.48 9255.96,-2175.15 9244.04,-2175.15 9238.07,-2174.48"/>
<text text-anchor="middle" x="9250" y="-2134.11" font-family="Times,serif" font-size="14.00">Gate Layer 13 GPU 9</text>
<text text-anchor="middle" x="9250" y="-2119.11" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="9250" y="-2104.11" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer13_gpu9&#45;&gt;gate_layer13_gpu9 -->
<g id="edge1274" class="edge">
<title>mha_layer13_gpu9&#45;&gt;gate_layer13_gpu9</title>
<path fill="none" stroke="black" d="M9191.25,-2211.56C9197.4,-2202.37 9204.59,-2191.62 9211.8,-2180.86"/>
<polygon fill="black" stroke="black" points="9214.91,-2182.51 9217.56,-2172.25 9209.09,-2178.62 9214.91,-2182.51"/>
</g>
<!-- gate_layer13_gpu10 -->
<g id="node1081" class="node">
<title>gate_layer13_gpu10</title>
<path fill="lightsteelblue" stroke="black" d="M10202.07,-2174.48C10202.07,-2174.48 9752.93,-2124.15 9752.93,-2124.15 9746.96,-2123.48 9746.96,-2122.15 9752.93,-2121.48 9752.93,-2121.48 10202.07,-2071.15 10202.07,-2071.15 10208.04,-2070.48 10219.96,-2070.48 10225.93,-2071.15 10225.93,-2071.15 10675.07,-2121.48 10675.07,-2121.48 10681.04,-2122.15 10681.04,-2123.48 10675.07,-2124.15 10675.07,-2124.15 10225.93,-2174.48 10225.93,-2174.48 10219.96,-2175.15 10208.04,-2175.15 10202.07,-2174.48"/>
<text text-anchor="middle" x="10214" y="-2134.11" font-family="Times,serif" font-size="14.00">Gate Layer 13 GPU 10</text>
<text text-anchor="middle" x="10214" y="-2119.11" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="10214" y="-2104.11" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer13_gpu10&#45;&gt;gate_layer13_gpu10 -->
<g id="edge1275" class="edge">
<title>mha_layer13_gpu10&#45;&gt;gate_layer13_gpu10</title>
<path fill="none" stroke="black" d="M10132.83,-2211.56C10141.86,-2201.79 10152.53,-2190.26 10163.11,-2178.83"/>
<polygon fill="black" stroke="black" points="10165.81,-2181.06 10170.03,-2171.34 10160.67,-2176.31 10165.81,-2181.06"/>
</g>
<!-- gate_layer13_gpu11 -->
<g id="node1082" class="node">
<title>gate_layer13_gpu11</title>
<path fill="lightsteelblue" stroke="black" d="M11166.07,-2174.48C11166.07,-2174.48 10716.93,-2124.15 10716.93,-2124.15 10710.96,-2123.48 10710.96,-2122.15 10716.93,-2121.48 10716.93,-2121.48 11166.07,-2071.15 11166.07,-2071.15 11172.04,-2070.48 11183.96,-2070.48 11189.93,-2071.15 11189.93,-2071.15 11639.07,-2121.48 11639.07,-2121.48 11645.04,-2122.15 11645.04,-2123.48 11639.07,-2124.15 11639.07,-2124.15 11189.93,-2174.48 11189.93,-2174.48 11183.96,-2175.15 11172.04,-2175.15 11166.07,-2174.48"/>
<text text-anchor="middle" x="11178" y="-2134.11" font-family="Times,serif" font-size="14.00">Gate Layer 13 GPU 11</text>
<text text-anchor="middle" x="11178" y="-2119.11" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11178" y="-2104.11" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer13_gpu11&#45;&gt;gate_layer13_gpu11 -->
<g id="edge1276" class="edge">
<title>mha_layer13_gpu11&#45;&gt;gate_layer13_gpu11</title>
<path fill="none" stroke="black" d="M11086,-2211.56C11096.67,-2201.39 11109.34,-2189.3 11121.81,-2177.4"/>
<polygon fill="black" stroke="black" points="11124.3,-2179.87 11129.12,-2170.44 11119.47,-2174.81 11124.3,-2179.87"/>
</g>
<!-- gate_layer13_gpu12 -->
<g id="node1083" class="node">
<title>gate_layer13_gpu12</title>
<path fill="lightsteelblue" stroke="black" d="M12130.07,-2174.48C12130.07,-2174.48 11680.93,-2124.15 11680.93,-2124.15 11674.96,-2123.48 11674.96,-2122.15 11680.93,-2121.48 11680.93,-2121.48 12130.07,-2071.15 12130.07,-2071.15 12136.04,-2070.48 12147.96,-2070.48 12153.93,-2071.15 12153.93,-2071.15 12603.07,-2121.48 12603.07,-2121.48 12609.04,-2122.15 12609.04,-2123.48 12603.07,-2124.15 12603.07,-2124.15 12153.93,-2174.48 12153.93,-2174.48 12147.96,-2175.15 12136.04,-2175.15 12130.07,-2174.48"/>
<text text-anchor="middle" x="12142" y="-2134.11" font-family="Times,serif" font-size="14.00">Gate Layer 13 GPU 12</text>
<text text-anchor="middle" x="12142" y="-2119.11" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="12142" y="-2104.11" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer13_gpu12&#45;&gt;gate_layer13_gpu12 -->
<g id="edge1277" class="edge">
<title>mha_layer13_gpu12&#45;&gt;gate_layer13_gpu12</title>
<path fill="none" stroke="black" d="M12108.76,-2211.56C12111.95,-2203.13 12115.64,-2193.39 12119.38,-2183.53"/>
<polygon fill="black" stroke="black" points="12122.69,-2184.67 12122.96,-2174.08 12116.14,-2182.19 12122.69,-2184.67"/>
</g>
<!-- gate_layer13_gpu13 -->
<g id="node1084" class="node">
<title>gate_layer13_gpu13</title>
<path fill="lightsteelblue" stroke="black" d="M13094.07,-2174.48C13094.07,-2174.48 12644.93,-2124.15 12644.93,-2124.15 12638.96,-2123.48 12638.96,-2122.15 12644.93,-2121.48 12644.93,-2121.48 13094.07,-2071.15 13094.07,-2071.15 13100.04,-2070.48 13111.96,-2070.48 13117.93,-2071.15 13117.93,-2071.15 13567.07,-2121.48 13567.07,-2121.48 13573.04,-2122.15 13573.04,-2123.48 13567.07,-2124.15 13567.07,-2124.15 13117.93,-2174.48 13117.93,-2174.48 13111.96,-2175.15 13100.04,-2175.15 13094.07,-2174.48"/>
<text text-anchor="middle" x="13106" y="-2134.11" font-family="Times,serif" font-size="14.00">Gate Layer 13 GPU 13</text>
<text text-anchor="middle" x="13106" y="-2119.11" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13106" y="-2104.11" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer13_gpu13&#45;&gt;gate_layer13_gpu13 -->
<g id="edge1278" class="edge">
<title>mha_layer13_gpu13&#45;&gt;gate_layer13_gpu13</title>
<path fill="none" stroke="black" d="M12771.22,-2211.77C12826.01,-2197.38 12895.6,-2179.09 12957.13,-2162.93"/>
<polygon fill="black" stroke="black" points="12958.15,-2166.28 12966.93,-2160.35 12956.37,-2159.51 12958.15,-2166.28"/>
</g>
<!-- gate_layer13_gpu14 -->
<g id="node1085" class="node">
<title>gate_layer13_gpu14</title>
<path fill="lightsteelblue" stroke="black" d="M14058.07,-2174.48C14058.07,-2174.48 13608.93,-2124.15 13608.93,-2124.15 13602.96,-2123.48 13602.96,-2122.15 13608.93,-2121.48 13608.93,-2121.48 14058.07,-2071.15 14058.07,-2071.15 14064.04,-2070.48 14075.96,-2070.48 14081.93,-2071.15 14081.93,-2071.15 14531.07,-2121.48 14531.07,-2121.48 14537.04,-2122.15 14537.04,-2123.48 14531.07,-2124.15 14531.07,-2124.15 14081.93,-2174.48 14081.93,-2174.48 14075.96,-2175.15 14064.04,-2175.15 14058.07,-2174.48"/>
<text text-anchor="middle" x="14070" y="-2134.11" font-family="Times,serif" font-size="14.00">Gate Layer 13 GPU 14</text>
<text text-anchor="middle" x="14070" y="-2119.11" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14070" y="-2104.11" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer13_gpu14&#45;&gt;gate_layer13_gpu14 -->
<g id="edge1279" class="edge">
<title>mha_layer13_gpu14&#45;&gt;gate_layer13_gpu14</title>
<path fill="none" stroke="black" d="M13926.98,-2211.56C13945.52,-2200.18 13967.97,-2186.41 13989.53,-2173.18"/>
<polygon fill="black" stroke="black" points="13991.36,-2176.17 13998.05,-2167.95 13987.7,-2170.2 13991.36,-2176.17"/>
</g>
<!-- gate_layer13_gpu15 -->
<g id="node1086" class="node">
<title>gate_layer13_gpu15</title>
<path fill="lightsteelblue" stroke="black" d="M15022.07,-2174.48C15022.07,-2174.48 14572.93,-2124.15 14572.93,-2124.15 14566.96,-2123.48 14566.96,-2122.15 14572.93,-2121.48 14572.93,-2121.48 15022.07,-2071.15 15022.07,-2071.15 15028.04,-2070.48 15039.96,-2070.48 15045.93,-2071.15 15045.93,-2071.15 15495.07,-2121.48 15495.07,-2121.48 15501.04,-2122.15 15501.04,-2123.48 15495.07,-2124.15 15495.07,-2124.15 15045.93,-2174.48 15045.93,-2174.48 15039.96,-2175.15 15028.04,-2175.15 15022.07,-2174.48"/>
<text text-anchor="middle" x="15034" y="-2134.11" font-family="Times,serif" font-size="14.00">Gate Layer 13 GPU 15</text>
<text text-anchor="middle" x="15034" y="-2119.11" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="15034" y="-2104.11" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer13_gpu15&#45;&gt;gate_layer13_gpu15 -->
<g id="edge1280" class="edge">
<title>mha_layer13_gpu15&#45;&gt;gate_layer13_gpu15</title>
<path fill="none" stroke="black" d="M14911.08,-2211.56C14926.41,-2200.61 14944.86,-2187.45 14962.74,-2174.68"/>
<polygon fill="black" stroke="black" points="14964.8,-2177.51 14970.9,-2168.85 14960.73,-2171.81 14964.8,-2177.51"/>
</g>
<!-- route_layer13_gpu0 -->
<g id="node1103" class="node">
<title>route_layer13_gpu0</title>
<path fill="orange" stroke="black" d="M1190.74,-2033.81C1190.74,-2033.81 682.24,-2033.81 682.24,-2033.81 676.24,-2033.81 665.5,-2030.14 660.75,-2026.47 660.75,-2026.47 542.75,-1935.16 542.75,-1935.16 538,-1931.49 539.26,-1927.81 545.26,-1927.81 545.26,-1927.81 1053.76,-1927.81 1053.76,-1927.81 1059.76,-1927.81 1070.5,-1931.49 1075.25,-1935.16 1075.25,-1935.16 1193.25,-2026.47 1193.25,-2026.47 1198,-2030.14 1196.74,-2033.81 1190.74,-2033.81"/>
<text text-anchor="middle" x="868" y="-1992.11" font-family="Times,serif" font-size="14.00">Token Router Layer 13 GPU 0</text>
<text text-anchor="middle" x="868" y="-1977.11" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="868" y="-1962.11" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer13_gpu0&#45;&gt;route_layer13_gpu0 -->
<g id="edge1281" class="edge">
<title>gate_layer13_gpu0&#45;&gt;route_layer13_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M662.61,-2079.62C689.92,-2066.61 720.44,-2052.08 749.42,-2038.28"/>
<polygon fill="black" stroke="black" points="751.25,-2041.28 758.77,-2033.83 748.24,-2034.96 751.25,-2041.28"/>
</g>
<!-- route_layer13_gpu1 -->
<g id="node1105" class="node">
<title>route_layer13_gpu1</title>
<path fill="orange" stroke="black" d="M2292.74,-2033.81C2292.74,-2033.81 1784.24,-2033.81 1784.24,-2033.81 1778.24,-2033.81 1767.5,-2030.14 1762.75,-2026.47 1762.75,-2026.47 1644.75,-1935.16 1644.75,-1935.16 1640,-1931.49 1641.26,-1927.81 1647.26,-1927.81 1647.26,-1927.81 2155.76,-1927.81 2155.76,-1927.81 2161.76,-1927.81 2172.5,-1931.49 2177.25,-1935.16 2177.25,-1935.16 2295.25,-2026.47 2295.25,-2026.47 2300,-2030.14 2298.74,-2033.81 2292.74,-2033.81"/>
<text text-anchor="middle" x="1970" y="-1992.11" font-family="Times,serif" font-size="14.00">Token Router Layer 13 GPU 1</text>
<text text-anchor="middle" x="1970" y="-1977.11" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="1970" y="-1962.11" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer13_gpu1&#45;&gt;route_layer13_gpu1 -->
<g id="edge1282" class="edge">
<title>gate_layer13_gpu1&#45;&gt;route_layer13_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1657.48,-2083.09C1701.4,-2068.86 1752.02,-2052.45 1799.56,-2037.05"/>
<polygon fill="black" stroke="black" points="1800.91,-2040.29 1809.34,-2033.88 1798.75,-2033.63 1800.91,-2040.29"/>
</g>
<!-- route_layer13_gpu2 -->
<g id="node1107" class="node">
<title>route_layer13_gpu2</title>
<path fill="orange" stroke="black" d="M3187.74,-2033.81C3187.74,-2033.81 2679.24,-2033.81 2679.24,-2033.81 2673.24,-2033.81 2662.5,-2030.14 2657.75,-2026.47 2657.75,-2026.47 2539.75,-1935.16 2539.75,-1935.16 2535,-1931.49 2536.26,-1927.81 2542.26,-1927.81 2542.26,-1927.81 3050.76,-1927.81 3050.76,-1927.81 3056.76,-1927.81 3067.5,-1931.49 3072.25,-1935.16 3072.25,-1935.16 3190.25,-2026.47 3190.25,-2026.47 3195,-2030.14 3193.74,-2033.81 3187.74,-2033.81"/>
<text text-anchor="middle" x="2865" y="-1992.11" font-family="Times,serif" font-size="14.00">Token Router Layer 13 GPU 2</text>
<text text-anchor="middle" x="2865" y="-1977.11" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="2865" y="-1962.11" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer13_gpu2&#45;&gt;route_layer13_gpu2 -->
<g id="edge1283" class="edge">
<title>gate_layer13_gpu2&#45;&gt;route_layer13_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2606.51,-2081.51C2642.04,-2067.81 2682.39,-2052.24 2720.48,-2037.55"/>
<polygon fill="black" stroke="black" points="2722.04,-2040.7 2730.11,-2033.84 2719.52,-2034.17 2722.04,-2040.7"/>
</g>
<!-- route_layer13_gpu3 -->
<g id="node1109" class="node">
<title>route_layer13_gpu3</title>
<path fill="orange" stroke="black" d="M3978.74,-2033.81C3978.74,-2033.81 3470.24,-2033.81 3470.24,-2033.81 3464.24,-2033.81 3453.5,-2030.14 3448.75,-2026.47 3448.75,-2026.47 3330.75,-1935.16 3330.75,-1935.16 3326,-1931.49 3327.26,-1927.81 3333.26,-1927.81 3333.26,-1927.81 3841.76,-1927.81 3841.76,-1927.81 3847.76,-1927.81 3858.5,-1931.49 3863.25,-1935.16 3863.25,-1935.16 3981.25,-2026.47 3981.25,-2026.47 3986,-2030.14 3984.74,-2033.81 3978.74,-2033.81"/>
<text text-anchor="middle" x="3656" y="-1992.11" font-family="Times,serif" font-size="14.00">Token Router Layer 13 GPU 3</text>
<text text-anchor="middle" x="3656" y="-1977.11" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="3656" y="-1962.11" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer13_gpu3&#45;&gt;route_layer13_gpu3 -->
<g id="edge1284" class="edge">
<title>gate_layer13_gpu3&#45;&gt;route_layer13_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3527.43,-2076.55C3543.26,-2064.88 3560.53,-2052.16 3577.13,-2039.93"/>
<polygon fill="black" stroke="black" points="3579.23,-2042.73 3585.21,-2033.98 3575.08,-2037.09 3579.23,-2042.73"/>
</g>
<!-- route_layer13_gpu4 -->
<g id="node1111" class="node">
<title>route_layer13_gpu4</title>
<path fill="orange" stroke="black" d="M4925.74,-2033.81C4925.74,-2033.81 4417.24,-2033.81 4417.24,-2033.81 4411.24,-2033.81 4400.5,-2030.14 4395.75,-2026.47 4395.75,-2026.47 4277.75,-1935.16 4277.75,-1935.16 4273,-1931.49 4274.26,-1927.81 4280.26,-1927.81 4280.26,-1927.81 4788.76,-1927.81 4788.76,-1927.81 4794.76,-1927.81 4805.5,-1931.49 4810.25,-1935.16 4810.25,-1935.16 4928.25,-2026.47 4928.25,-2026.47 4933,-2030.14 4931.74,-2033.81 4925.74,-2033.81"/>
<text text-anchor="middle" x="4603" y="-1992.11" font-family="Times,serif" font-size="14.00">Token Router Layer 13 GPU 4</text>
<text text-anchor="middle" x="4603" y="-1977.11" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="4603" y="-1962.11" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer13_gpu4&#45;&gt;route_layer13_gpu4 -->
<g id="edge1285" class="edge">
<title>gate_layer13_gpu4&#45;&gt;route_layer13_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4486.65,-2075.97C4500.7,-2064.6 4515.95,-2052.26 4530.64,-2040.37"/>
<polygon fill="black" stroke="black" points="4533.16,-2042.83 4538.73,-2033.82 4528.76,-2037.39 4533.16,-2042.83"/>
</g>
<!-- route_layer13_gpu5 -->
<g id="node1113" class="node">
<title>route_layer13_gpu5</title>
<path fill="orange" stroke="black" d="M6027.74,-2033.81C6027.74,-2033.81 5519.24,-2033.81 5519.24,-2033.81 5513.24,-2033.81 5502.5,-2030.14 5497.75,-2026.47 5497.75,-2026.47 5379.75,-1935.16 5379.75,-1935.16 5375,-1931.49 5376.26,-1927.81 5382.26,-1927.81 5382.26,-1927.81 5890.76,-1927.81 5890.76,-1927.81 5896.76,-1927.81 5907.5,-1931.49 5912.25,-1935.16 5912.25,-1935.16 6030.25,-2026.47 6030.25,-2026.47 6035,-2030.14 6033.74,-2033.81 6027.74,-2033.81"/>
<text text-anchor="middle" x="5705" y="-1992.11" font-family="Times,serif" font-size="14.00">Token Router Layer 13 GPU 5</text>
<text text-anchor="middle" x="5705" y="-1977.11" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="5705" y="-1962.11" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer13_gpu5&#45;&gt;route_layer13_gpu5 -->
<g id="edge1286" class="edge">
<title>gate_layer13_gpu5&#45;&gt;route_layer13_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5486.89,-2080C5516.21,-2066.8 5549.1,-2051.99 5580.27,-2037.96"/>
<polygon fill="black" stroke="black" points="5581.77,-2041.13 5589.45,-2033.83 5578.89,-2034.74 5581.77,-2041.13"/>
</g>
<!-- route_layer13_gpu6 -->
<g id="node1115" class="node">
<title>route_layer13_gpu6</title>
<path fill="orange" stroke="black" d="M6922.74,-2033.81C6922.74,-2033.81 6414.24,-2033.81 6414.24,-2033.81 6408.24,-2033.81 6397.5,-2030.14 6392.75,-2026.47 6392.75,-2026.47 6274.75,-1935.16 6274.75,-1935.16 6270,-1931.49 6271.26,-1927.81 6277.26,-1927.81 6277.26,-1927.81 6785.76,-1927.81 6785.76,-1927.81 6791.76,-1927.81 6802.5,-1931.49 6807.25,-1935.16 6807.25,-1935.16 6925.25,-2026.47 6925.25,-2026.47 6930,-2030.14 6928.74,-2033.81 6922.74,-2033.81"/>
<text text-anchor="middle" x="6600" y="-1992.11" font-family="Times,serif" font-size="14.00">Token Router Layer 13 GPU 6</text>
<text text-anchor="middle" x="6600" y="-1977.11" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="6600" y="-1962.11" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer13_gpu6&#45;&gt;route_layer13_gpu6 -->
<g id="edge1287" class="edge">
<title>gate_layer13_gpu6&#45;&gt;route_layer13_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6433.57,-2078.09C6454.88,-2065.77 6478.38,-2052.17 6500.84,-2039.18"/>
<polygon fill="black" stroke="black" points="6502.82,-2042.08 6509.72,-2034.04 6499.31,-2036.02 6502.82,-2042.08"/>
</g>
<!-- route_layer13_gpu7 -->
<g id="node1117" class="node">
<title>route_layer13_gpu7</title>
<path fill="orange" stroke="black" d="M7713.74,-2033.81C7713.74,-2033.81 7205.24,-2033.81 7205.24,-2033.81 7199.24,-2033.81 7188.5,-2030.14 7183.75,-2026.47 7183.75,-2026.47 7065.75,-1935.16 7065.75,-1935.16 7061,-1931.49 7062.26,-1927.81 7068.26,-1927.81 7068.26,-1927.81 7576.76,-1927.81 7576.76,-1927.81 7582.76,-1927.81 7593.5,-1931.49 7598.25,-1935.16 7598.25,-1935.16 7716.25,-2026.47 7716.25,-2026.47 7721,-2030.14 7719.74,-2033.81 7713.74,-2033.81"/>
<text text-anchor="middle" x="7391" y="-1992.11" font-family="Times,serif" font-size="14.00">Token Router Layer 13 GPU 7</text>
<text text-anchor="middle" x="7391" y="-1977.11" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="7391" y="-1962.11" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer13_gpu7&#45;&gt;route_layer13_gpu7 -->
<g id="edge1288" class="edge">
<title>gate_layer13_gpu7&#45;&gt;route_layer13_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7346.33,-2072.45C7350.97,-2063.03 7355.89,-2053.05 7360.69,-2043.3"/>
<polygon fill="black" stroke="black" points="7363.97,-2044.57 7365.26,-2034.05 7357.7,-2041.47 7363.97,-2044.57"/>
</g>
<!-- route_layer13_gpu8 -->
<g id="node1119" class="node">
<title>route_layer13_gpu8</title>
<path fill="orange" stroke="black" d="M8539.74,-2033.81C8539.74,-2033.81 8031.24,-2033.81 8031.24,-2033.81 8025.24,-2033.81 8014.5,-2030.14 8009.75,-2026.47 8009.75,-2026.47 7891.75,-1935.16 7891.75,-1935.16 7887,-1931.49 7888.26,-1927.81 7894.26,-1927.81 7894.26,-1927.81 8402.76,-1927.81 8402.76,-1927.81 8408.76,-1927.81 8419.5,-1931.49 8424.25,-1935.16 8424.25,-1935.16 8542.25,-2026.47 8542.25,-2026.47 8547,-2030.14 8545.74,-2033.81 8539.74,-2033.81"/>
<text text-anchor="middle" x="8217" y="-1992.11" font-family="Times,serif" font-size="14.00">Token Router Layer 13 GPU 8</text>
<text text-anchor="middle" x="8217" y="-1977.11" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="8217" y="-1962.11" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer13_gpu8&#45;&gt;route_layer13_gpu8 -->
<g id="edge1289" class="edge">
<title>gate_layer13_gpu8&#45;&gt;route_layer13_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8261.67,-2072.45C8257.03,-2063.03 8252.11,-2053.05 8247.31,-2043.3"/>
<polygon fill="black" stroke="black" points="8250.3,-2041.47 8242.74,-2034.05 8244.03,-2044.57 8250.3,-2041.47"/>
</g>
<!-- route_layer13_gpu9 -->
<g id="node1121" class="node">
<title>route_layer13_gpu9</title>
<path fill="orange" stroke="black" d="M9434.74,-2033.81C9434.74,-2033.81 8926.24,-2033.81 8926.24,-2033.81 8920.24,-2033.81 8909.5,-2030.14 8904.75,-2026.47 8904.75,-2026.47 8786.75,-1935.16 8786.75,-1935.16 8782,-1931.49 8783.26,-1927.81 8789.26,-1927.81 8789.26,-1927.81 9297.76,-1927.81 9297.76,-1927.81 9303.76,-1927.81 9314.5,-1931.49 9319.25,-1935.16 9319.25,-1935.16 9437.25,-2026.47 9437.25,-2026.47 9442,-2030.14 9440.74,-2033.81 9434.74,-2033.81"/>
<text text-anchor="middle" x="9112" y="-1992.11" font-family="Times,serif" font-size="14.00">Token Router Layer 13 GPU 9</text>
<text text-anchor="middle" x="9112" y="-1977.11" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="9112" y="-1962.11" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer13_gpu9&#45;&gt;route_layer13_gpu9 -->
<g id="edge1290" class="edge">
<title>gate_layer13_gpu9&#45;&gt;route_layer13_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9203.66,-2074.81C9193.13,-2064.12 9181.8,-2052.63 9170.83,-2041.49"/>
<polygon fill="black" stroke="black" points="9173.19,-2038.9 9163.68,-2034.24 9168.2,-2043.82 9173.19,-2038.9"/>
</g>
<!-- route_layer13_gpu10 -->
<g id="node1123" class="node">
<title>route_layer13_gpu10</title>
<path fill="orange" stroke="black" d="M10363.74,-2033.81C10363.74,-2033.81 9855.24,-2033.81 9855.24,-2033.81 9849.24,-2033.81 9838.5,-2030.14 9833.75,-2026.47 9833.75,-2026.47 9715.75,-1935.16 9715.75,-1935.16 9711,-1931.49 9712.26,-1927.81 9718.26,-1927.81 9718.26,-1927.81 10226.76,-1927.81 10226.76,-1927.81 10232.76,-1927.81 10243.5,-1931.49 10248.25,-1935.16 10248.25,-1935.16 10366.25,-2026.47 10366.25,-2026.47 10371,-2030.14 10369.74,-2033.81 10363.74,-2033.81"/>
<text text-anchor="middle" x="10041" y="-1992.11" font-family="Times,serif" font-size="14.00">Token Router Layer 13 GPU 10</text>
<text text-anchor="middle" x="10041" y="-1977.11" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="10041" y="-1962.11" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer13_gpu10&#45;&gt;route_layer13_gpu10 -->
<g id="edge1291" class="edge">
<title>gate_layer13_gpu10&#45;&gt;route_layer13_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10157.35,-2075.97C10143.3,-2064.6 10128.05,-2052.26 10113.36,-2040.37"/>
<polygon fill="black" stroke="black" points="10115.24,-2037.39 10105.27,-2033.82 10110.84,-2042.83 10115.24,-2037.39"/>
</g>
<!-- route_layer13_gpu11 -->
<g id="node1125" class="node">
<title>route_layer13_gpu11</title>
<path fill="orange" stroke="black" d="M11310.74,-2033.81C11310.74,-2033.81 10802.24,-2033.81 10802.24,-2033.81 10796.24,-2033.81 10785.5,-2030.14 10780.75,-2026.47 10780.75,-2026.47 10662.75,-1935.16 10662.75,-1935.16 10658,-1931.49 10659.26,-1927.81 10665.26,-1927.81 10665.26,-1927.81 11173.76,-1927.81 11173.76,-1927.81 11179.76,-1927.81 11190.5,-1931.49 11195.25,-1935.16 11195.25,-1935.16 11313.25,-2026.47 11313.25,-2026.47 11318,-2030.14 11316.74,-2033.81 11310.74,-2033.81"/>
<text text-anchor="middle" x="10988" y="-1992.11" font-family="Times,serif" font-size="14.00">Token Router Layer 13 GPU 11</text>
<text text-anchor="middle" x="10988" y="-1977.11" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="10988" y="-1962.11" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer13_gpu11&#45;&gt;route_layer13_gpu11 -->
<g id="edge1292" class="edge">
<title>gate_layer13_gpu11&#45;&gt;route_layer13_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11116.57,-2076.55C11100.74,-2064.88 11083.47,-2052.16 11066.87,-2039.93"/>
<polygon fill="black" stroke="black" points="11068.92,-2037.09 11058.79,-2033.98 11064.77,-2042.73 11068.92,-2037.09"/>
</g>
<!-- route_layer13_gpu12 -->
<g id="node1127" class="node">
<title>route_layer13_gpu12</title>
<path fill="orange" stroke="black" d="M12265.74,-2033.81C12265.74,-2033.81 11757.24,-2033.81 11757.24,-2033.81 11751.24,-2033.81 11740.5,-2030.14 11735.75,-2026.47 11735.75,-2026.47 11617.75,-1935.16 11617.75,-1935.16 11613,-1931.49 11614.26,-1927.81 11620.26,-1927.81 11620.26,-1927.81 12128.76,-1927.81 12128.76,-1927.81 12134.76,-1927.81 12145.5,-1931.49 12150.25,-1935.16 12150.25,-1935.16 12268.25,-2026.47 12268.25,-2026.47 12273,-2030.14 12271.74,-2033.81 12265.74,-2033.81"/>
<text text-anchor="middle" x="11943" y="-1992.11" font-family="Times,serif" font-size="14.00">Token Router Layer 13 GPU 12</text>
<text text-anchor="middle" x="11943" y="-1977.11" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="11943" y="-1962.11" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer13_gpu12&#45;&gt;route_layer13_gpu12 -->
<g id="edge1293" class="edge">
<title>gate_layer13_gpu12&#45;&gt;route_layer13_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12078.21,-2076.94C12061.51,-2065.19 12043.25,-2052.34 12025.71,-2040"/>
<polygon fill="black" stroke="black" points="12027.36,-2036.89 12017.17,-2033.99 12023.34,-2042.61 12027.36,-2036.89"/>
</g>
<!-- route_layer13_gpu13 -->
<g id="node1129" class="node">
<title>route_layer13_gpu13</title>
<path fill="orange" stroke="black" d="M13225.74,-2033.81C13225.74,-2033.81 12717.24,-2033.81 12717.24,-2033.81 12711.24,-2033.81 12700.5,-2030.14 12695.75,-2026.47 12695.75,-2026.47 12577.75,-1935.16 12577.75,-1935.16 12573,-1931.49 12574.26,-1927.81 12580.26,-1927.81 12580.26,-1927.81 13088.76,-1927.81 13088.76,-1927.81 13094.76,-1927.81 13105.5,-1931.49 13110.25,-1935.16 13110.25,-1935.16 13228.25,-2026.47 13228.25,-2026.47 13233,-2030.14 13231.74,-2033.81 13225.74,-2033.81"/>
<text text-anchor="middle" x="12903" y="-1992.11" font-family="Times,serif" font-size="14.00">Token Router Layer 13 GPU 13</text>
<text text-anchor="middle" x="12903" y="-1977.11" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="12903" y="-1962.11" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer13_gpu13&#45;&gt;route_layer13_gpu13 -->
<g id="edge1294" class="edge">
<title>gate_layer13_gpu13&#45;&gt;route_layer13_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13040.93,-2076.94C13023.89,-2065.19 13005.27,-2052.34 12987.38,-2040"/>
<polygon fill="black" stroke="black" points="12988.88,-2036.79 12978.66,-2033.99 12984.91,-2042.55 12988.88,-2036.79"/>
</g>
<!-- route_layer13_gpu14 -->
<g id="node1131" class="node">
<title>route_layer13_gpu14</title>
<path fill="orange" stroke="black" d="M14187.74,-2033.81C14187.74,-2033.81 13679.24,-2033.81 13679.24,-2033.81 13673.24,-2033.81 13662.5,-2030.14 13657.75,-2026.47 13657.75,-2026.47 13539.75,-1935.16 13539.75,-1935.16 13535,-1931.49 13536.26,-1927.81 13542.26,-1927.81 13542.26,-1927.81 14050.76,-1927.81 14050.76,-1927.81 14056.76,-1927.81 14067.5,-1931.49 14072.25,-1935.16 14072.25,-1935.16 14190.25,-2026.47 14190.25,-2026.47 14195,-2030.14 14193.74,-2033.81 14187.74,-2033.81"/>
<text text-anchor="middle" x="13865" y="-1992.11" font-family="Times,serif" font-size="14.00">Token Router Layer 13 GPU 14</text>
<text text-anchor="middle" x="13865" y="-1977.11" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="13865" y="-1962.11" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer13_gpu14&#45;&gt;route_layer13_gpu14 -->
<g id="edge1295" class="edge">
<title>gate_layer13_gpu14&#45;&gt;route_layer13_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14004.57,-2077.13C13987.1,-2065.2 13967.96,-2052.12 13949.61,-2039.59"/>
<polygon fill="black" stroke="black" points="13951.47,-2036.63 13941.24,-2033.88 13947.52,-2042.41 13951.47,-2036.63"/>
</g>
<!-- route_layer13_gpu15 -->
<g id="node1133" class="node">
<title>route_layer13_gpu15</title>
<path fill="orange" stroke="black" d="M15150.74,-2033.81C15150.74,-2033.81 14642.24,-2033.81 14642.24,-2033.81 14636.24,-2033.81 14625.5,-2030.14 14620.75,-2026.47 14620.75,-2026.47 14502.75,-1935.16 14502.75,-1935.16 14498,-1931.49 14499.26,-1927.81 14505.26,-1927.81 14505.26,-1927.81 15013.76,-1927.81 15013.76,-1927.81 15019.76,-1927.81 15030.5,-1931.49 15035.25,-1935.16 15035.25,-1935.16 15153.25,-2026.47 15153.25,-2026.47 15158,-2030.14 15156.74,-2033.81 15150.74,-2033.81"/>
<text text-anchor="middle" x="14828" y="-1992.11" font-family="Times,serif" font-size="14.00">Token Router Layer 13 GPU 15</text>
<text text-anchor="middle" x="14828" y="-1977.11" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="14828" y="-1962.11" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer13_gpu15&#45;&gt;route_layer13_gpu15 -->
<g id="edge1296" class="edge">
<title>gate_layer13_gpu15&#45;&gt;route_layer13_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14968.25,-2077.13C14950.69,-2065.2 14931.46,-2052.12 14913.02,-2039.59"/>
<polygon fill="black" stroke="black" points="14914.85,-2036.6 14904.61,-2033.88 14910.91,-2042.39 14914.85,-2036.6"/>
</g>
<!-- expert_layer13_gpu0_expert0 -->
<g id="node1087" class="node">
<title>expert_layer13_gpu0_expert0</title>
<path fill="lightcoral" stroke="black" d="M1914.5,-1780.86C1914.5,-1780.86 1445.5,-1780.86 1445.5,-1780.86 1439.5,-1780.86 1433.5,-1774.86 1433.5,-1768.86 1433.5,-1768.86 1433.5,-1724.86 1433.5,-1724.86 1433.5,-1718.86 1439.5,-1712.86 1445.5,-1712.86 1445.5,-1712.86 1914.5,-1712.86 1914.5,-1712.86 1920.5,-1712.86 1926.5,-1718.86 1926.5,-1724.86 1926.5,-1724.86 1926.5,-1768.86 1926.5,-1768.86 1926.5,-1774.86 1920.5,-1780.86 1914.5,-1780.86"/>
<text text-anchor="middle" x="1680" y="-1765.66" font-family="Times,serif" font-size="14.00">Expert 0 Layer 13 GPU 0</text>
<text text-anchor="middle" x="1680" y="-1750.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="1680" y="-1735.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="1680" y="-1720.66" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer13_gpu0 -->
<g id="node1104" class="node">
<title>aggregate_layer13_gpu0</title>
<path fill="orange" stroke="black" d="M1402.29,-1676.86C1402.29,-1676.86 915.19,-1676.86 915.19,-1676.86 909.19,-1676.86 898.52,-1673.09 893.85,-1669.33 893.85,-1669.33 781.06,-1578.39 781.06,-1578.39 776.38,-1574.63 777.71,-1570.86 783.71,-1570.86 783.71,-1570.86 1270.81,-1570.86 1270.81,-1570.86 1276.81,-1570.86 1287.48,-1574.63 1292.15,-1578.39 1292.15,-1578.39 1404.94,-1669.33 1404.94,-1669.33 1409.62,-1673.09 1408.29,-1676.86 1402.29,-1676.86"/>
<text text-anchor="middle" x="1093" y="-1635.16" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 13 GPU 0</text>
<text text-anchor="middle" x="1093" y="-1620.16" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="1093" y="-1605.16" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer13_gpu0_expert0&#45;&gt;aggregate_layer13_gpu0 -->
<g id="edge1329" class="edge">
<title>expert_layer13_gpu0_expert0&#45;&gt;aggregate_layer13_gpu0</title>
<path fill="none" stroke="black" d="M1519.6,-1712.8C1468.84,-1702.33 1411.35,-1690.48 1355.38,-1678.95"/>
<polygon fill="black" stroke="black" points="1355.82,-1675.46 1345.32,-1676.87 1354.41,-1682.32 1355.82,-1675.46"/>
</g>
<!-- expert_layer13_gpu1_expert1 -->
<g id="node1088" class="node">
<title>expert_layer13_gpu1_expert1</title>
<path fill="lightcoral" stroke="black" d="M3115.5,-1780.86C3115.5,-1780.86 2646.5,-1780.86 2646.5,-1780.86 2640.5,-1780.86 2634.5,-1774.86 2634.5,-1768.86 2634.5,-1768.86 2634.5,-1724.86 2634.5,-1724.86 2634.5,-1718.86 2640.5,-1712.86 2646.5,-1712.86 2646.5,-1712.86 3115.5,-1712.86 3115.5,-1712.86 3121.5,-1712.86 3127.5,-1718.86 3127.5,-1724.86 3127.5,-1724.86 3127.5,-1768.86 3127.5,-1768.86 3127.5,-1774.86 3121.5,-1780.86 3115.5,-1780.86"/>
<text text-anchor="middle" x="2881" y="-1765.66" font-family="Times,serif" font-size="14.00">Expert 1 Layer 13 GPU 1</text>
<text text-anchor="middle" x="2881" y="-1750.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2881" y="-1735.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2881" y="-1720.66" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer13_gpu1 -->
<g id="node1106" class="node">
<title>aggregate_layer13_gpu1</title>
<path fill="orange" stroke="black" d="M2313.29,-1676.86C2313.29,-1676.86 1826.19,-1676.86 1826.19,-1676.86 1820.19,-1676.86 1809.52,-1673.09 1804.85,-1669.33 1804.85,-1669.33 1692.06,-1578.39 1692.06,-1578.39 1687.38,-1574.63 1688.71,-1570.86 1694.71,-1570.86 1694.71,-1570.86 2181.81,-1570.86 2181.81,-1570.86 2187.81,-1570.86 2198.48,-1574.63 2203.15,-1578.39 2203.15,-1578.39 2315.94,-1669.33 2315.94,-1669.33 2320.62,-1673.09 2319.29,-1676.86 2313.29,-1676.86"/>
<text text-anchor="middle" x="2004" y="-1635.16" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 13 GPU 1</text>
<text text-anchor="middle" x="2004" y="-1620.16" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="2004" y="-1605.16" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer13_gpu1_expert1&#45;&gt;aggregate_layer13_gpu1 -->
<g id="edge1330" class="edge">
<title>expert_layer13_gpu1_expert1&#45;&gt;aggregate_layer13_gpu1</title>
<path fill="none" stroke="black" d="M2641.65,-1712.84C2543.75,-1699.33 2429.04,-1683.5 2324.11,-1669.03"/>
<polygon fill="black" stroke="black" points="2324.37,-1665.53 2313.98,-1667.63 2323.41,-1672.46 2324.37,-1665.53"/>
</g>
<!-- expert_layer13_gpu2_expert2 -->
<g id="node1089" class="node">
<title>expert_layer13_gpu2_expert2</title>
<path fill="lightcoral" stroke="black" d="M3971.5,-1780.86C3971.5,-1780.86 3502.5,-1780.86 3502.5,-1780.86 3496.5,-1780.86 3490.5,-1774.86 3490.5,-1768.86 3490.5,-1768.86 3490.5,-1724.86 3490.5,-1724.86 3490.5,-1718.86 3496.5,-1712.86 3502.5,-1712.86 3502.5,-1712.86 3971.5,-1712.86 3971.5,-1712.86 3977.5,-1712.86 3983.5,-1718.86 3983.5,-1724.86 3983.5,-1724.86 3983.5,-1768.86 3983.5,-1768.86 3983.5,-1774.86 3977.5,-1780.86 3971.5,-1780.86"/>
<text text-anchor="middle" x="3737" y="-1765.66" font-family="Times,serif" font-size="14.00">Expert 2 Layer 13 GPU 2</text>
<text text-anchor="middle" x="3737" y="-1750.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3737" y="-1735.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3737" y="-1720.66" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer13_gpu2 -->
<g id="node1108" class="node">
<title>aggregate_layer13_gpu2</title>
<path fill="orange" stroke="black" d="M3245.29,-1676.86C3245.29,-1676.86 2758.19,-1676.86 2758.19,-1676.86 2752.19,-1676.86 2741.52,-1673.09 2736.85,-1669.33 2736.85,-1669.33 2624.06,-1578.39 2624.06,-1578.39 2619.38,-1574.63 2620.71,-1570.86 2626.71,-1570.86 2626.71,-1570.86 3113.81,-1570.86 3113.81,-1570.86 3119.81,-1570.86 3130.48,-1574.63 3135.15,-1578.39 3135.15,-1578.39 3247.94,-1669.33 3247.94,-1669.33 3252.62,-1673.09 3251.29,-1676.86 3245.29,-1676.86"/>
<text text-anchor="middle" x="2936" y="-1635.16" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 13 GPU 2</text>
<text text-anchor="middle" x="2936" y="-1620.16" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="2936" y="-1605.16" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer13_gpu2_expert2&#45;&gt;aggregate_layer13_gpu2 -->
<g id="edge1331" class="edge">
<title>expert_layer13_gpu2_expert2&#45;&gt;aggregate_layer13_gpu2</title>
<path fill="none" stroke="black" d="M3518.39,-1712.84C3439.33,-1700.89 3348.26,-1687.14 3261.98,-1674.1"/>
<polygon fill="black" stroke="black" points="3262.44,-1670.63 3252.03,-1672.6 3261.39,-1677.55 3262.44,-1670.63"/>
</g>
<!-- expert_layer13_gpu3_expert3 -->
<g id="node1090" class="node">
<title>expert_layer13_gpu3_expert3</title>
<path fill="lightcoral" stroke="black" d="M4655.5,-1780.86C4655.5,-1780.86 4186.5,-1780.86 4186.5,-1780.86 4180.5,-1780.86 4174.5,-1774.86 4174.5,-1768.86 4174.5,-1768.86 4174.5,-1724.86 4174.5,-1724.86 4174.5,-1718.86 4180.5,-1712.86 4186.5,-1712.86 4186.5,-1712.86 4655.5,-1712.86 4655.5,-1712.86 4661.5,-1712.86 4667.5,-1718.86 4667.5,-1724.86 4667.5,-1724.86 4667.5,-1768.86 4667.5,-1768.86 4667.5,-1774.86 4661.5,-1780.86 4655.5,-1780.86"/>
<text text-anchor="middle" x="4421" y="-1765.66" font-family="Times,serif" font-size="14.00">Expert 3 Layer 13 GPU 3</text>
<text text-anchor="middle" x="4421" y="-1750.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4421" y="-1735.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4421" y="-1720.66" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer13_gpu3 -->
<g id="node1110" class="node">
<title>aggregate_layer13_gpu3</title>
<path fill="orange" stroke="black" d="M4014.29,-1676.86C4014.29,-1676.86 3527.19,-1676.86 3527.19,-1676.86 3521.19,-1676.86 3510.52,-1673.09 3505.85,-1669.33 3505.85,-1669.33 3393.06,-1578.39 3393.06,-1578.39 3388.38,-1574.63 3389.71,-1570.86 3395.71,-1570.86 3395.71,-1570.86 3882.81,-1570.86 3882.81,-1570.86 3888.81,-1570.86 3899.48,-1574.63 3904.15,-1578.39 3904.15,-1578.39 4016.94,-1669.33 4016.94,-1669.33 4021.62,-1673.09 4020.29,-1676.86 4014.29,-1676.86"/>
<text text-anchor="middle" x="3705" y="-1635.16" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 13 GPU 3</text>
<text text-anchor="middle" x="3705" y="-1620.16" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="3705" y="-1605.16" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer13_gpu3_expert3&#45;&gt;aggregate_layer13_gpu3 -->
<g id="edge1332" class="edge">
<title>expert_layer13_gpu3_expert3&#45;&gt;aggregate_layer13_gpu3</title>
<path fill="none" stroke="black" d="M4225.35,-1712.8C4162.8,-1702.23 4091.86,-1690.24 4022.93,-1678.59"/>
<polygon fill="black" stroke="black" points="4023.21,-1675.09 4012.77,-1676.87 4022.05,-1681.99 4023.21,-1675.09"/>
</g>
<!-- expert_layer13_gpu4_expert4 -->
<g id="node1091" class="node">
<title>expert_layer13_gpu4_expert4</title>
<path fill="lightcoral" stroke="black" d="M5252.5,-1780.86C5252.5,-1780.86 4783.5,-1780.86 4783.5,-1780.86 4777.5,-1780.86 4771.5,-1774.86 4771.5,-1768.86 4771.5,-1768.86 4771.5,-1724.86 4771.5,-1724.86 4771.5,-1718.86 4777.5,-1712.86 4783.5,-1712.86 4783.5,-1712.86 5252.5,-1712.86 5252.5,-1712.86 5258.5,-1712.86 5264.5,-1718.86 5264.5,-1724.86 5264.5,-1724.86 5264.5,-1768.86 5264.5,-1768.86 5264.5,-1774.86 5258.5,-1780.86 5252.5,-1780.86"/>
<text text-anchor="middle" x="5018" y="-1765.66" font-family="Times,serif" font-size="14.00">Expert 4 Layer 13 GPU 4</text>
<text text-anchor="middle" x="5018" y="-1750.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5018" y="-1735.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5018" y="-1720.66" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer13_gpu4 -->
<g id="node1112" class="node">
<title>aggregate_layer13_gpu4</title>
<path fill="orange" stroke="black" d="M5054.29,-1676.86C5054.29,-1676.86 4567.19,-1676.86 4567.19,-1676.86 4561.19,-1676.86 4550.52,-1673.09 4545.85,-1669.33 4545.85,-1669.33 4433.06,-1578.39 4433.06,-1578.39 4428.38,-1574.63 4429.71,-1570.86 4435.71,-1570.86 4435.71,-1570.86 4922.81,-1570.86 4922.81,-1570.86 4928.81,-1570.86 4939.48,-1574.63 4944.15,-1578.39 4944.15,-1578.39 5056.94,-1669.33 5056.94,-1669.33 5061.62,-1673.09 5060.29,-1676.86 5054.29,-1676.86"/>
<text text-anchor="middle" x="4745" y="-1635.16" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 13 GPU 4</text>
<text text-anchor="middle" x="4745" y="-1620.16" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="4745" y="-1605.16" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer13_gpu4_expert4&#45;&gt;aggregate_layer13_gpu4 -->
<g id="edge1333" class="edge">
<title>expert_layer13_gpu4_expert4&#45;&gt;aggregate_layer13_gpu4</title>
<path fill="none" stroke="black" d="M4943.4,-1712.8C4921.21,-1702.96 4896.26,-1691.9 4871.72,-1681.03"/>
<polygon fill="black" stroke="black" points="4872.91,-1677.72 4862.35,-1676.87 4870.07,-1684.12 4872.91,-1677.72"/>
</g>
<!-- expert_layer13_gpu5_expert5 -->
<g id="node1092" class="node">
<title>expert_layer13_gpu5_expert5</title>
<path fill="lightcoral" stroke="black" d="M6124.5,-1780.86C6124.5,-1780.86 5655.5,-1780.86 5655.5,-1780.86 5649.5,-1780.86 5643.5,-1774.86 5643.5,-1768.86 5643.5,-1768.86 5643.5,-1724.86 5643.5,-1724.86 5643.5,-1718.86 5649.5,-1712.86 5655.5,-1712.86 5655.5,-1712.86 6124.5,-1712.86 6124.5,-1712.86 6130.5,-1712.86 6136.5,-1718.86 6136.5,-1724.86 6136.5,-1724.86 6136.5,-1768.86 6136.5,-1768.86 6136.5,-1774.86 6130.5,-1780.86 6124.5,-1780.86"/>
<text text-anchor="middle" x="5890" y="-1765.66" font-family="Times,serif" font-size="14.00">Expert 5 Layer 13 GPU 5</text>
<text text-anchor="middle" x="5890" y="-1750.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5890" y="-1735.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5890" y="-1720.66" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer13_gpu5 -->
<g id="node1114" class="node">
<title>aggregate_layer13_gpu5</title>
<path fill="orange" stroke="black" d="M6027.29,-1676.86C6027.29,-1676.86 5540.19,-1676.86 5540.19,-1676.86 5534.19,-1676.86 5523.52,-1673.09 5518.85,-1669.33 5518.85,-1669.33 5406.06,-1578.39 5406.06,-1578.39 5401.38,-1574.63 5402.71,-1570.86 5408.71,-1570.86 5408.71,-1570.86 5895.81,-1570.86 5895.81,-1570.86 5901.81,-1570.86 5912.48,-1574.63 5917.15,-1578.39 5917.15,-1578.39 6029.94,-1669.33 6029.94,-1669.33 6034.62,-1673.09 6033.29,-1676.86 6027.29,-1676.86"/>
<text text-anchor="middle" x="5718" y="-1635.16" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 13 GPU 5</text>
<text text-anchor="middle" x="5718" y="-1620.16" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="5718" y="-1605.16" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer13_gpu5_expert5&#45;&gt;aggregate_layer13_gpu5 -->
<g id="edge1334" class="edge">
<title>expert_layer13_gpu5_expert5&#45;&gt;aggregate_layer13_gpu5</title>
<path fill="none" stroke="black" d="M5843,-1712.8C5829.86,-1703.55 5815.19,-1693.23 5800.64,-1682.99"/>
<polygon fill="black" stroke="black" points="5802.29,-1679.88 5792.1,-1676.99 5798.26,-1685.6 5802.29,-1679.88"/>
</g>
<!-- expert_layer13_gpu6_expert6 -->
<g id="node1093" class="node">
<title>expert_layer13_gpu6_expert6</title>
<path fill="lightcoral" stroke="black" d="M6969.5,-1780.86C6969.5,-1780.86 6500.5,-1780.86 6500.5,-1780.86 6494.5,-1780.86 6488.5,-1774.86 6488.5,-1768.86 6488.5,-1768.86 6488.5,-1724.86 6488.5,-1724.86 6488.5,-1718.86 6494.5,-1712.86 6500.5,-1712.86 6500.5,-1712.86 6969.5,-1712.86 6969.5,-1712.86 6975.5,-1712.86 6981.5,-1718.86 6981.5,-1724.86 6981.5,-1724.86 6981.5,-1768.86 6981.5,-1768.86 6981.5,-1774.86 6975.5,-1780.86 6969.5,-1780.86"/>
<text text-anchor="middle" x="6735" y="-1765.66" font-family="Times,serif" font-size="14.00">Expert 6 Layer 13 GPU 6</text>
<text text-anchor="middle" x="6735" y="-1750.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6735" y="-1735.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6735" y="-1720.66" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer13_gpu6 -->
<g id="node1116" class="node">
<title>aggregate_layer13_gpu6</title>
<path fill="orange" stroke="black" d="M6810.29,-1676.86C6810.29,-1676.86 6323.19,-1676.86 6323.19,-1676.86 6317.19,-1676.86 6306.52,-1673.09 6301.85,-1669.33 6301.85,-1669.33 6189.06,-1578.39 6189.06,-1578.39 6184.38,-1574.63 6185.71,-1570.86 6191.71,-1570.86 6191.71,-1570.86 6678.81,-1570.86 6678.81,-1570.86 6684.81,-1570.86 6695.48,-1574.63 6700.15,-1578.39 6700.15,-1578.39 6812.94,-1669.33 6812.94,-1669.33 6817.62,-1673.09 6816.29,-1676.86 6810.29,-1676.86"/>
<text text-anchor="middle" x="6501" y="-1635.16" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 13 GPU 6</text>
<text text-anchor="middle" x="6501" y="-1620.16" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="6501" y="-1605.16" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer13_gpu6_expert6&#45;&gt;aggregate_layer13_gpu6 -->
<g id="edge1335" class="edge">
<title>expert_layer13_gpu6_expert6&#45;&gt;aggregate_layer13_gpu6</title>
<path fill="none" stroke="black" d="M6671.06,-1712.8C6652.43,-1703.17 6631.53,-1692.36 6610.93,-1681.7"/>
<polygon fill="black" stroke="black" points="6612.3,-1678.47 6601.81,-1676.99 6609.08,-1684.69 6612.3,-1678.47"/>
</g>
<!-- expert_layer13_gpu7_expert7 -->
<g id="node1094" class="node">
<title>expert_layer13_gpu7_expert7</title>
<path fill="lightcoral" stroke="black" d="M7647.5,-1780.86C7647.5,-1780.86 7178.5,-1780.86 7178.5,-1780.86 7172.5,-1780.86 7166.5,-1774.86 7166.5,-1768.86 7166.5,-1768.86 7166.5,-1724.86 7166.5,-1724.86 7166.5,-1718.86 7172.5,-1712.86 7178.5,-1712.86 7178.5,-1712.86 7647.5,-1712.86 7647.5,-1712.86 7653.5,-1712.86 7659.5,-1718.86 7659.5,-1724.86 7659.5,-1724.86 7659.5,-1768.86 7659.5,-1768.86 7659.5,-1774.86 7653.5,-1780.86 7647.5,-1780.86"/>
<text text-anchor="middle" x="7413" y="-1765.66" font-family="Times,serif" font-size="14.00">Expert 7 Layer 13 GPU 7</text>
<text text-anchor="middle" x="7413" y="-1750.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7413" y="-1735.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7413" y="-1720.66" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer13_gpu7 -->
<g id="node1118" class="node">
<title>aggregate_layer13_gpu7</title>
<path fill="orange" stroke="black" d="M7655.29,-1676.86C7655.29,-1676.86 7168.19,-1676.86 7168.19,-1676.86 7162.19,-1676.86 7151.52,-1673.09 7146.85,-1669.33 7146.85,-1669.33 7034.06,-1578.39 7034.06,-1578.39 7029.38,-1574.63 7030.71,-1570.86 7036.71,-1570.86 7036.71,-1570.86 7523.81,-1570.86 7523.81,-1570.86 7529.81,-1570.86 7540.48,-1574.63 7545.15,-1578.39 7545.15,-1578.39 7657.94,-1669.33 7657.94,-1669.33 7662.62,-1673.09 7661.29,-1676.86 7655.29,-1676.86"/>
<text text-anchor="middle" x="7346" y="-1635.16" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 13 GPU 7</text>
<text text-anchor="middle" x="7346" y="-1620.16" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="7346" y="-1605.16" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer13_gpu7_expert7&#45;&gt;aggregate_layer13_gpu7 -->
<g id="edge1336" class="edge">
<title>expert_layer13_gpu7_expert7&#45;&gt;aggregate_layer13_gpu7</title>
<path fill="none" stroke="black" d="M7394.69,-1712.8C7390.05,-1704.42 7384.92,-1695.15 7379.78,-1685.86"/>
<polygon fill="black" stroke="black" points="7382.77,-1684.04 7374.86,-1676.99 7376.65,-1687.43 7382.77,-1684.04"/>
</g>
<!-- expert_layer13_gpu8_expert8 -->
<g id="node1095" class="node">
<title>expert_layer13_gpu8_expert8</title>
<path fill="lightcoral" stroke="black" d="M8292.5,-1780.86C8292.5,-1780.86 7823.5,-1780.86 7823.5,-1780.86 7817.5,-1780.86 7811.5,-1774.86 7811.5,-1768.86 7811.5,-1768.86 7811.5,-1724.86 7811.5,-1724.86 7811.5,-1718.86 7817.5,-1712.86 7823.5,-1712.86 7823.5,-1712.86 8292.5,-1712.86 8292.5,-1712.86 8298.5,-1712.86 8304.5,-1718.86 8304.5,-1724.86 8304.5,-1724.86 8304.5,-1768.86 8304.5,-1768.86 8304.5,-1774.86 8298.5,-1780.86 8292.5,-1780.86"/>
<text text-anchor="middle" x="8058" y="-1765.66" font-family="Times,serif" font-size="14.00">Expert 8 Layer 13 GPU 8</text>
<text text-anchor="middle" x="8058" y="-1750.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8058" y="-1735.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8058" y="-1720.66" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer13_gpu8 -->
<g id="node1120" class="node">
<title>aggregate_layer13_gpu8</title>
<path fill="orange" stroke="black" d="M8434.29,-1676.86C8434.29,-1676.86 7947.19,-1676.86 7947.19,-1676.86 7941.19,-1676.86 7930.52,-1673.09 7925.85,-1669.33 7925.85,-1669.33 7813.06,-1578.39 7813.06,-1578.39 7808.38,-1574.63 7809.71,-1570.86 7815.71,-1570.86 7815.71,-1570.86 8302.81,-1570.86 8302.81,-1570.86 8308.81,-1570.86 8319.48,-1574.63 8324.15,-1578.39 8324.15,-1578.39 8436.94,-1669.33 8436.94,-1669.33 8441.62,-1673.09 8440.29,-1676.86 8434.29,-1676.86"/>
<text text-anchor="middle" x="8125" y="-1635.16" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 13 GPU 8</text>
<text text-anchor="middle" x="8125" y="-1620.16" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="8125" y="-1605.16" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer13_gpu8_expert8&#45;&gt;aggregate_layer13_gpu8 -->
<g id="edge1337" class="edge">
<title>expert_layer13_gpu8_expert8&#45;&gt;aggregate_layer13_gpu8</title>
<path fill="none" stroke="black" d="M8076.31,-1712.8C8080.95,-1704.42 8086.08,-1695.15 8091.22,-1685.86"/>
<polygon fill="black" stroke="black" points="8094.35,-1687.43 8096.14,-1676.99 8088.23,-1684.04 8094.35,-1687.43"/>
</g>
<!-- expert_layer13_gpu9_expert9 -->
<g id="node1096" class="node">
<title>expert_layer13_gpu9_expert9</title>
<path fill="lightcoral" stroke="black" d="M8987.5,-1780.86C8987.5,-1780.86 8518.5,-1780.86 8518.5,-1780.86 8512.5,-1780.86 8506.5,-1774.86 8506.5,-1768.86 8506.5,-1768.86 8506.5,-1724.86 8506.5,-1724.86 8506.5,-1718.86 8512.5,-1712.86 8518.5,-1712.86 8518.5,-1712.86 8987.5,-1712.86 8987.5,-1712.86 8993.5,-1712.86 8999.5,-1718.86 8999.5,-1724.86 8999.5,-1724.86 8999.5,-1768.86 8999.5,-1768.86 8999.5,-1774.86 8993.5,-1780.86 8987.5,-1780.86"/>
<text text-anchor="middle" x="8753" y="-1765.66" font-family="Times,serif" font-size="14.00">Expert 9 Layer 13 GPU 9</text>
<text text-anchor="middle" x="8753" y="-1750.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8753" y="-1735.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8753" y="-1720.66" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer13_gpu9 -->
<g id="node1122" class="node">
<title>aggregate_layer13_gpu9</title>
<path fill="orange" stroke="black" d="M9180.29,-1676.86C9180.29,-1676.86 8693.19,-1676.86 8693.19,-1676.86 8687.19,-1676.86 8676.52,-1673.09 8671.85,-1669.33 8671.85,-1669.33 8559.06,-1578.39 8559.06,-1578.39 8554.38,-1574.63 8555.71,-1570.86 8561.71,-1570.86 8561.71,-1570.86 9048.81,-1570.86 9048.81,-1570.86 9054.81,-1570.86 9065.48,-1574.63 9070.15,-1578.39 9070.15,-1578.39 9182.94,-1669.33 9182.94,-1669.33 9187.62,-1673.09 9186.29,-1676.86 9180.29,-1676.86"/>
<text text-anchor="middle" x="8871" y="-1635.16" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 13 GPU 9</text>
<text text-anchor="middle" x="8871" y="-1620.16" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="8871" y="-1605.16" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer13_gpu9_expert9&#45;&gt;aggregate_layer13_gpu9 -->
<g id="edge1338" class="edge">
<title>expert_layer13_gpu9_expert9&#45;&gt;aggregate_layer13_gpu9</title>
<path fill="none" stroke="black" d="M8785.24,-1712.8C8793.84,-1703.99 8803.39,-1694.19 8812.91,-1684.43"/>
<polygon fill="black" stroke="black" points="8815.69,-1686.59 8820.17,-1676.99 8810.68,-1681.7 8815.69,-1686.59"/>
</g>
<!-- expert_layer13_gpu10_expert10 -->
<g id="node1097" class="node">
<title>expert_layer13_gpu10_expert10</title>
<path fill="lightcoral" stroke="black" d="M9750.5,-1780.86C9750.5,-1780.86 9281.5,-1780.86 9281.5,-1780.86 9275.5,-1780.86 9269.5,-1774.86 9269.5,-1768.86 9269.5,-1768.86 9269.5,-1724.86 9269.5,-1724.86 9269.5,-1718.86 9275.5,-1712.86 9281.5,-1712.86 9281.5,-1712.86 9750.5,-1712.86 9750.5,-1712.86 9756.5,-1712.86 9762.5,-1718.86 9762.5,-1724.86 9762.5,-1724.86 9762.5,-1768.86 9762.5,-1768.86 9762.5,-1774.86 9756.5,-1780.86 9750.5,-1780.86"/>
<text text-anchor="middle" x="9516" y="-1765.66" font-family="Times,serif" font-size="14.00">Expert 10 Layer 13 GPU 10</text>
<text text-anchor="middle" x="9516" y="-1750.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9516" y="-1735.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9516" y="-1720.66" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer13_gpu10 -->
<g id="node1124" class="node">
<title>aggregate_layer13_gpu10</title>
<path fill="orange" stroke="black" d="M10010.29,-1676.86C10010.29,-1676.86 9523.19,-1676.86 9523.19,-1676.86 9517.19,-1676.86 9506.52,-1673.09 9501.85,-1669.33 9501.85,-1669.33 9389.06,-1578.39 9389.06,-1578.39 9384.38,-1574.63 9385.71,-1570.86 9391.71,-1570.86 9391.71,-1570.86 9878.81,-1570.86 9878.81,-1570.86 9884.81,-1570.86 9895.48,-1574.63 9900.15,-1578.39 9900.15,-1578.39 10012.94,-1669.33 10012.94,-1669.33 10017.62,-1673.09 10016.29,-1676.86 10010.29,-1676.86"/>
<text text-anchor="middle" x="9701" y="-1635.16" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 13 GPU 10</text>
<text text-anchor="middle" x="9701" y="-1620.16" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="9701" y="-1605.16" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer13_gpu10_expert10&#45;&gt;aggregate_layer13_gpu10 -->
<g id="edge1339" class="edge">
<title>expert_layer13_gpu10_expert10&#45;&gt;aggregate_layer13_gpu10</title>
<path fill="none" stroke="black" d="M9566.55,-1712.8C9580.81,-1703.47 9596.76,-1693.04 9612.56,-1682.71"/>
<polygon fill="black" stroke="black" points="9614.85,-1685.39 9621.3,-1676.99 9611.02,-1679.53 9614.85,-1685.39"/>
</g>
<!-- expert_layer13_gpu11_expert11 -->
<g id="node1098" class="node">
<title>expert_layer13_gpu11_expert11</title>
<path fill="lightcoral" stroke="black" d="M10504.5,-1780.86C10504.5,-1780.86 10035.5,-1780.86 10035.5,-1780.86 10029.5,-1780.86 10023.5,-1774.86 10023.5,-1768.86 10023.5,-1768.86 10023.5,-1724.86 10023.5,-1724.86 10023.5,-1718.86 10029.5,-1712.86 10035.5,-1712.86 10035.5,-1712.86 10504.5,-1712.86 10504.5,-1712.86 10510.5,-1712.86 10516.5,-1718.86 10516.5,-1724.86 10516.5,-1724.86 10516.5,-1768.86 10516.5,-1768.86 10516.5,-1774.86 10510.5,-1780.86 10504.5,-1780.86"/>
<text text-anchor="middle" x="10270" y="-1765.66" font-family="Times,serif" font-size="14.00">Expert 11 Layer 13 GPU 11</text>
<text text-anchor="middle" x="10270" y="-1750.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10270" y="-1735.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10270" y="-1720.66" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer13_gpu11 -->
<g id="node1126" class="node">
<title>aggregate_layer13_gpu11</title>
<path fill="orange" stroke="black" d="M10755.29,-1676.86C10755.29,-1676.86 10268.19,-1676.86 10268.19,-1676.86 10262.19,-1676.86 10251.52,-1673.09 10246.85,-1669.33 10246.85,-1669.33 10134.06,-1578.39 10134.06,-1578.39 10129.38,-1574.63 10130.71,-1570.86 10136.71,-1570.86 10136.71,-1570.86 10623.81,-1570.86 10623.81,-1570.86 10629.81,-1570.86 10640.48,-1574.63 10645.15,-1578.39 10645.15,-1578.39 10757.94,-1669.33 10757.94,-1669.33 10762.62,-1673.09 10761.29,-1676.86 10755.29,-1676.86"/>
<text text-anchor="middle" x="10446" y="-1635.16" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 13 GPU 11</text>
<text text-anchor="middle" x="10446" y="-1620.16" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="10446" y="-1605.16" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer13_gpu11_expert11&#45;&gt;aggregate_layer13_gpu11 -->
<g id="edge1340" class="edge">
<title>expert_layer13_gpu11_expert11&#45;&gt;aggregate_layer13_gpu11</title>
<path fill="none" stroke="black" d="M10318.09,-1712.8C10331.66,-1703.47 10346.84,-1693.04 10361.86,-1682.71"/>
<polygon fill="black" stroke="black" points="10363.92,-1685.54 10370.18,-1676.99 10359.96,-1679.77 10363.92,-1685.54"/>
</g>
<!-- expert_layer13_gpu12_expert12 -->
<g id="node1099" class="node">
<title>expert_layer13_gpu12_expert12</title>
<path fill="lightcoral" stroke="black" d="M11232.5,-1780.86C11232.5,-1780.86 10763.5,-1780.86 10763.5,-1780.86 10757.5,-1780.86 10751.5,-1774.86 10751.5,-1768.86 10751.5,-1768.86 10751.5,-1724.86 10751.5,-1724.86 10751.5,-1718.86 10757.5,-1712.86 10763.5,-1712.86 10763.5,-1712.86 11232.5,-1712.86 11232.5,-1712.86 11238.5,-1712.86 11244.5,-1718.86 11244.5,-1724.86 11244.5,-1724.86 11244.5,-1768.86 11244.5,-1768.86 11244.5,-1774.86 11238.5,-1780.86 11232.5,-1780.86"/>
<text text-anchor="middle" x="10998" y="-1765.66" font-family="Times,serif" font-size="14.00">Expert 12 Layer 13 GPU 12</text>
<text text-anchor="middle" x="10998" y="-1750.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10998" y="-1735.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10998" y="-1720.66" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer13_gpu12 -->
<g id="node1128" class="node">
<title>aggregate_layer13_gpu12</title>
<path fill="orange" stroke="black" d="M11458.29,-1676.86C11458.29,-1676.86 10971.19,-1676.86 10971.19,-1676.86 10965.19,-1676.86 10954.52,-1673.09 10949.85,-1669.33 10949.85,-1669.33 10837.06,-1578.39 10837.06,-1578.39 10832.38,-1574.63 10833.71,-1570.86 10839.71,-1570.86 10839.71,-1570.86 11326.81,-1570.86 11326.81,-1570.86 11332.81,-1570.86 11343.48,-1574.63 11348.15,-1578.39 11348.15,-1578.39 11460.94,-1669.33 11460.94,-1669.33 11465.62,-1673.09 11464.29,-1676.86 11458.29,-1676.86"/>
<text text-anchor="middle" x="11149" y="-1635.16" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 13 GPU 12</text>
<text text-anchor="middle" x="11149" y="-1620.16" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="11149" y="-1605.16" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer13_gpu12_expert12&#45;&gt;aggregate_layer13_gpu12 -->
<g id="edge1341" class="edge">
<title>expert_layer13_gpu12_expert12&#45;&gt;aggregate_layer13_gpu12</title>
<path fill="none" stroke="black" d="M11039.26,-1712.8C11050.69,-1703.64 11063.44,-1693.42 11076.09,-1683.28"/>
<polygon fill="black" stroke="black" points="11078.33,-1685.97 11083.95,-1676.99 11073.96,-1680.51 11078.33,-1685.97"/>
</g>
<!-- expert_layer13_gpu13_expert13 -->
<g id="node1100" class="node">
<title>expert_layer13_gpu13_expert13</title>
<path fill="lightcoral" stroke="black" d="M12219.5,-1780.86C12219.5,-1780.86 11750.5,-1780.86 11750.5,-1780.86 11744.5,-1780.86 11738.5,-1774.86 11738.5,-1768.86 11738.5,-1768.86 11738.5,-1724.86 11738.5,-1724.86 11738.5,-1718.86 11744.5,-1712.86 11750.5,-1712.86 11750.5,-1712.86 12219.5,-1712.86 12219.5,-1712.86 12225.5,-1712.86 12231.5,-1718.86 12231.5,-1724.86 12231.5,-1724.86 12231.5,-1768.86 12231.5,-1768.86 12231.5,-1774.86 12225.5,-1780.86 12219.5,-1780.86"/>
<text text-anchor="middle" x="11985" y="-1765.66" font-family="Times,serif" font-size="14.00">Expert 13 Layer 13 GPU 13</text>
<text text-anchor="middle" x="11985" y="-1750.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11985" y="-1735.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11985" y="-1720.66" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer13_gpu13 -->
<g id="node1130" class="node">
<title>aggregate_layer13_gpu13</title>
<path fill="orange" stroke="black" d="M12703.29,-1676.86C12703.29,-1676.86 12216.19,-1676.86 12216.19,-1676.86 12210.19,-1676.86 12199.52,-1673.09 12194.85,-1669.33 12194.85,-1669.33 12082.06,-1578.39 12082.06,-1578.39 12077.38,-1574.63 12078.71,-1570.86 12084.71,-1570.86 12084.71,-1570.86 12571.81,-1570.86 12571.81,-1570.86 12577.81,-1570.86 12588.48,-1574.63 12593.15,-1578.39 12593.15,-1578.39 12705.94,-1669.33 12705.94,-1669.33 12710.62,-1673.09 12709.29,-1676.86 12703.29,-1676.86"/>
<text text-anchor="middle" x="12394" y="-1635.16" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 13 GPU 13</text>
<text text-anchor="middle" x="12394" y="-1620.16" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="12394" y="-1605.16" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer13_gpu13_expert13&#45;&gt;aggregate_layer13_gpu13 -->
<g id="edge1342" class="edge">
<title>expert_layer13_gpu13_expert13&#45;&gt;aggregate_layer13_gpu13</title>
<path fill="none" stroke="black" d="M12096.76,-1712.8C12131.32,-1702.57 12170.36,-1691.02 12208.51,-1679.73"/>
<polygon fill="black" stroke="black" points="12209.6,-1683.06 12218.19,-1676.87 12207.61,-1676.35 12209.6,-1683.06"/>
</g>
<!-- expert_layer13_gpu14_expert14 -->
<g id="node1101" class="node">
<title>expert_layer13_gpu14_expert14</title>
<path fill="lightcoral" stroke="black" d="M13189.5,-1780.86C13189.5,-1780.86 12720.5,-1780.86 12720.5,-1780.86 12714.5,-1780.86 12708.5,-1774.86 12708.5,-1768.86 12708.5,-1768.86 12708.5,-1724.86 12708.5,-1724.86 12708.5,-1718.86 12714.5,-1712.86 12720.5,-1712.86 12720.5,-1712.86 13189.5,-1712.86 13189.5,-1712.86 13195.5,-1712.86 13201.5,-1718.86 13201.5,-1724.86 13201.5,-1724.86 13201.5,-1768.86 13201.5,-1768.86 13201.5,-1774.86 13195.5,-1780.86 13189.5,-1780.86"/>
<text text-anchor="middle" x="12955" y="-1765.66" font-family="Times,serif" font-size="14.00">Expert 14 Layer 13 GPU 14</text>
<text text-anchor="middle" x="12955" y="-1750.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12955" y="-1735.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12955" y="-1720.66" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer13_gpu14 -->
<g id="node1132" class="node">
<title>aggregate_layer13_gpu14</title>
<path fill="orange" stroke="black" d="M13656.29,-1676.86C13656.29,-1676.86 13169.19,-1676.86 13169.19,-1676.86 13163.19,-1676.86 13152.52,-1673.09 13147.85,-1669.33 13147.85,-1669.33 13035.06,-1578.39 13035.06,-1578.39 13030.38,-1574.63 13031.71,-1570.86 13037.71,-1570.86 13037.71,-1570.86 13524.81,-1570.86 13524.81,-1570.86 13530.81,-1570.86 13541.48,-1574.63 13546.15,-1578.39 13546.15,-1578.39 13658.94,-1669.33 13658.94,-1669.33 13663.62,-1673.09 13662.29,-1676.86 13656.29,-1676.86"/>
<text text-anchor="middle" x="13347" y="-1635.16" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 13 GPU 14</text>
<text text-anchor="middle" x="13347" y="-1620.16" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="13347" y="-1605.16" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer13_gpu14_expert14&#45;&gt;aggregate_layer13_gpu14 -->
<g id="edge1343" class="edge">
<title>expert_layer13_gpu14_expert14&#45;&gt;aggregate_layer13_gpu14</title>
<path fill="none" stroke="black" d="M13062.12,-1712.8C13095.1,-1702.62 13132.34,-1691.12 13168.76,-1679.88"/>
<polygon fill="black" stroke="black" points="13169.98,-1683.17 13178.5,-1676.87 13167.91,-1676.48 13169.98,-1683.17"/>
</g>
<!-- expert_layer13_gpu15_expert15 -->
<g id="node1102" class="node">
<title>expert_layer13_gpu15_expert15</title>
<path fill="lightcoral" stroke="black" d="M14250.5,-1780.86C14250.5,-1780.86 13781.5,-1780.86 13781.5,-1780.86 13775.5,-1780.86 13769.5,-1774.86 13769.5,-1768.86 13769.5,-1768.86 13769.5,-1724.86 13769.5,-1724.86 13769.5,-1718.86 13775.5,-1712.86 13781.5,-1712.86 13781.5,-1712.86 14250.5,-1712.86 14250.5,-1712.86 14256.5,-1712.86 14262.5,-1718.86 14262.5,-1724.86 14262.5,-1724.86 14262.5,-1768.86 14262.5,-1768.86 14262.5,-1774.86 14256.5,-1780.86 14250.5,-1780.86"/>
<text text-anchor="middle" x="14016" y="-1765.66" font-family="Times,serif" font-size="14.00">Expert 15 Layer 13 GPU 15</text>
<text text-anchor="middle" x="14016" y="-1750.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14016" y="-1735.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="14016" y="-1720.66" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer13_gpu15 -->
<g id="node1134" class="node">
<title>aggregate_layer13_gpu15</title>
<path fill="orange" stroke="black" d="M14809.29,-1676.86C14809.29,-1676.86 14322.19,-1676.86 14322.19,-1676.86 14316.19,-1676.86 14305.52,-1673.09 14300.85,-1669.33 14300.85,-1669.33 14188.06,-1578.39 14188.06,-1578.39 14183.38,-1574.63 14184.71,-1570.86 14190.71,-1570.86 14190.71,-1570.86 14677.81,-1570.86 14677.81,-1570.86 14683.81,-1570.86 14694.48,-1574.63 14699.15,-1578.39 14699.15,-1578.39 14811.94,-1669.33 14811.94,-1669.33 14816.62,-1673.09 14815.29,-1676.86 14809.29,-1676.86"/>
<text text-anchor="middle" x="14500" y="-1635.16" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 13 GPU 15</text>
<text text-anchor="middle" x="14500" y="-1620.16" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="14500" y="-1605.16" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer13_gpu15_expert15&#45;&gt;aggregate_layer13_gpu15 -->
<g id="edge1344" class="edge">
<title>expert_layer13_gpu15_expert15&#45;&gt;aggregate_layer13_gpu15</title>
<path fill="none" stroke="black" d="M14148.26,-1712.8C14193.78,-1701.41 14245.88,-1688.39 14295.78,-1675.91"/>
<polygon fill="black" stroke="black" points="14296.88,-1679.25 14305.73,-1673.43 14295.18,-1672.46 14296.88,-1679.25"/>
</g>
<!-- comm_layer13 -->
<g id="node1135" class="node">
<title>comm_layer13</title>
<ellipse fill="lightpink" stroke="black" cx="7735" cy="-1854.34" rx="243.49" ry="37.45"/>
<text text-anchor="middle" x="7735" y="-1865.64" font-family="Times,serif" font-size="14.00">Cross&#45;GPU Communication Layer 13</text>
<text text-anchor="middle" x="7735" y="-1850.64" font-family="Times,serif" font-size="14.00">Input: Tokens from routing decisions</text>
<text text-anchor="middle" x="7735" y="-1835.64" font-family="Times,serif" font-size="14.00">Output: Tokens delivered to destination GPUs</text>
</g>
<!-- route_layer13_gpu0&#45;&gt;comm_layer13 -->
<g id="edge1297" class="edge">
<title>route_layer13_gpu0&#45;&gt;comm_layer13</title>
<path fill="none" stroke="black" d="M1107.63,-1959.89C1256.67,-1948.36 1452.35,-1934.79 1626,-1927.81 2794.08,-1880.86 6479.95,-1861.03 7481.63,-1856.43"/>
<polygon fill="black" stroke="black" points="7481.86,-1859.92 7491.84,-1856.38 7481.82,-1852.92 7481.86,-1859.92"/>
</g>
<!-- mha_layer14_gpu0 -->
<g id="node1136" class="node">
<title>mha_layer14_gpu0</title>
<path fill="lightblue" stroke="black" d="M929,-1534.86C929,-1534.86 481,-1534.86 481,-1534.86 475,-1534.86 469,-1528.86 469,-1522.86 469,-1522.86 469,-1493.86 469,-1493.86 469,-1487.86 475,-1481.86 481,-1481.86 481,-1481.86 929,-1481.86 929,-1481.86 935,-1481.86 941,-1487.86 941,-1493.86 941,-1493.86 941,-1522.86 941,-1522.86 941,-1528.86 935,-1534.86 929,-1534.86"/>
<text text-anchor="middle" x="705" y="-1519.66" font-family="Times,serif" font-size="14.00">MHA Layer 14 GPU 0</text>
<text text-anchor="middle" x="705" y="-1504.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="705" y="-1489.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer13_gpu0&#45;&gt;mha_layer14_gpu0 -->
<g id="edge1345" class="edge">
<title>aggregate_layer13_gpu0&#45;&gt;mha_layer14_gpu0</title>
<path fill="none" stroke="black" d="M915.18,-1570.84C876.35,-1559.48 836.64,-1547.87 802.35,-1537.84"/>
<polygon fill="black" stroke="black" points="802.94,-1534.36 792.36,-1534.91 800.97,-1541.08 802.94,-1534.36"/>
</g>
<!-- route_layer13_gpu1&#45;&gt;comm_layer13 -->
<g id="edge1298" class="edge">
<title>route_layer13_gpu1&#45;&gt;comm_layer13</title>
<path fill="none" stroke="black" d="M2201.59,-1953.79C2299.95,-1943.83 2415.94,-1933.49 2521,-1927.81 3503.45,-1874.71 6576.44,-1859.53 7481.67,-1856.16"/>
<polygon fill="black" stroke="black" points="7481.9,-1859.66 7491.89,-1856.12 7481.88,-1852.66 7481.9,-1859.66"/>
</g>
<!-- mha_layer14_gpu1 -->
<g id="node1137" class="node">
<title>mha_layer14_gpu1</title>
<path fill="lightblue" stroke="black" d="M2162,-1534.86C2162,-1534.86 1714,-1534.86 1714,-1534.86 1708,-1534.86 1702,-1528.86 1702,-1522.86 1702,-1522.86 1702,-1493.86 1702,-1493.86 1702,-1487.86 1708,-1481.86 1714,-1481.86 1714,-1481.86 2162,-1481.86 2162,-1481.86 2168,-1481.86 2174,-1487.86 2174,-1493.86 2174,-1493.86 2174,-1522.86 2174,-1522.86 2174,-1528.86 2168,-1534.86 2162,-1534.86"/>
<text text-anchor="middle" x="1938" y="-1519.66" font-family="Times,serif" font-size="14.00">MHA Layer 14 GPU 1</text>
<text text-anchor="middle" x="1938" y="-1504.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1938" y="-1489.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer13_gpu1&#45;&gt;mha_layer14_gpu1 -->
<g id="edge1346" class="edge">
<title>aggregate_layer13_gpu1&#45;&gt;mha_layer14_gpu1</title>
<path fill="none" stroke="black" d="M1973.7,-1570.76C1968.38,-1561.6 1962.96,-1552.28 1958,-1543.76"/>
<polygon fill="black" stroke="black" points="1960.89,-1541.76 1952.84,-1534.87 1954.84,-1545.28 1960.89,-1541.76"/>
</g>
<!-- route_layer13_gpu2&#45;&gt;comm_layer13 -->
<g id="edge1299" class="edge">
<title>route_layer13_gpu2&#45;&gt;comm_layer13</title>
<path fill="none" stroke="black" d="M3090.57,-1949.15C3161.32,-1940.72 3239.79,-1932.59 3312,-1927.81 4131.53,-1873.57 6669.19,-1859.37 7481.86,-1856.17"/>
<polygon fill="black" stroke="black" points="7481.95,-1859.67 7491.94,-1856.13 7481.92,-1852.67 7481.95,-1859.67"/>
</g>
<!-- mha_layer14_gpu2 -->
<g id="node1138" class="node">
<title>mha_layer14_gpu2</title>
<path fill="lightblue" stroke="black" d="M2782,-1534.86C2782,-1534.86 2334,-1534.86 2334,-1534.86 2328,-1534.86 2322,-1528.86 2322,-1522.86 2322,-1522.86 2322,-1493.86 2322,-1493.86 2322,-1487.86 2328,-1481.86 2334,-1481.86 2334,-1481.86 2782,-1481.86 2782,-1481.86 2788,-1481.86 2794,-1487.86 2794,-1493.86 2794,-1493.86 2794,-1522.86 2794,-1522.86 2794,-1528.86 2788,-1534.86 2782,-1534.86"/>
<text text-anchor="middle" x="2558" y="-1519.66" font-family="Times,serif" font-size="14.00">MHA Layer 14 GPU 2</text>
<text text-anchor="middle" x="2558" y="-1504.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2558" y="-1489.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer13_gpu2&#45;&gt;mha_layer14_gpu2 -->
<g id="edge1347" class="edge">
<title>aggregate_layer13_gpu2&#45;&gt;mha_layer14_gpu2</title>
<path fill="none" stroke="black" d="M2762.76,-1570.84C2724.93,-1559.48 2686.25,-1547.87 2652.84,-1537.84"/>
<polygon fill="black" stroke="black" points="2653.69,-1534.44 2643.11,-1534.91 2651.68,-1541.14 2653.69,-1534.44"/>
</g>
<!-- route_layer13_gpu3&#45;&gt;comm_layer13 -->
<g id="edge1300" class="edge">
<title>route_layer13_gpu3&#45;&gt;comm_layer13</title>
<path fill="none" stroke="black" d="M3890.57,-1956.01C4002.07,-1945.61 4137.29,-1934.32 4259,-1927.81 5464.35,-1863.34 6907.66,-1855.37 7481.63,-1854.97"/>
<polygon fill="black" stroke="black" points="7481.69,-1858.47 7491.69,-1854.96 7481.69,-1851.47 7481.69,-1858.47"/>
</g>
<!-- mha_layer14_gpu3 -->
<g id="node1139" class="node">
<title>mha_layer14_gpu3</title>
<path fill="lightblue" stroke="black" d="M3778,-1534.86C3778,-1534.86 3330,-1534.86 3330,-1534.86 3324,-1534.86 3318,-1528.86 3318,-1522.86 3318,-1522.86 3318,-1493.86 3318,-1493.86 3318,-1487.86 3324,-1481.86 3330,-1481.86 3330,-1481.86 3778,-1481.86 3778,-1481.86 3784,-1481.86 3790,-1487.86 3790,-1493.86 3790,-1493.86 3790,-1522.86 3790,-1522.86 3790,-1528.86 3784,-1534.86 3778,-1534.86"/>
<text text-anchor="middle" x="3554" y="-1519.66" font-family="Times,serif" font-size="14.00">MHA Layer 14 GPU 3</text>
<text text-anchor="middle" x="3554" y="-1504.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3554" y="-1489.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer13_gpu3&#45;&gt;mha_layer14_gpu3 -->
<g id="edge1348" class="edge">
<title>aggregate_layer13_gpu3&#45;&gt;mha_layer14_gpu3</title>
<path fill="none" stroke="black" d="M3635.69,-1570.76C3622.21,-1560.63 3608.46,-1550.3 3596.19,-1541.07"/>
<polygon fill="black" stroke="black" points="3598.04,-1538.08 3587.94,-1534.87 3593.83,-1543.68 3598.04,-1538.08"/>
</g>
<!-- route_layer13_gpu4&#45;&gt;comm_layer13 -->
<g id="edge1301" class="edge">
<title>route_layer13_gpu4&#45;&gt;comm_layer13</title>
<path fill="none" stroke="black" d="M4843.96,-1960.94C4992.86,-1949.86 5187.92,-1936.39 5361,-1927.81 6134.32,-1889.5 7050.41,-1868.4 7483.79,-1859.87"/>
<polygon fill="black" stroke="black" points="7484.01,-1863.37 7493.94,-1859.67 7483.87,-1856.37 7484.01,-1863.37"/>
</g>
<!-- mha_layer14_gpu4 -->
<g id="node1140" class="node">
<title>mha_layer14_gpu4</title>
<path fill="lightblue" stroke="black" d="M4818,-1534.86C4818,-1534.86 4370,-1534.86 4370,-1534.86 4364,-1534.86 4358,-1528.86 4358,-1522.86 4358,-1522.86 4358,-1493.86 4358,-1493.86 4358,-1487.86 4364,-1481.86 4370,-1481.86 4370,-1481.86 4818,-1481.86 4818,-1481.86 4824,-1481.86 4830,-1487.86 4830,-1493.86 4830,-1493.86 4830,-1522.86 4830,-1522.86 4830,-1528.86 4824,-1534.86 4818,-1534.86"/>
<text text-anchor="middle" x="4594" y="-1519.66" font-family="Times,serif" font-size="14.00">MHA Layer 14 GPU 4</text>
<text text-anchor="middle" x="4594" y="-1504.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4594" y="-1489.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer13_gpu4&#45;&gt;mha_layer14_gpu4 -->
<g id="edge1349" class="edge">
<title>aggregate_layer13_gpu4&#45;&gt;mha_layer14_gpu4</title>
<path fill="none" stroke="black" d="M4675.69,-1570.76C4662.21,-1560.63 4648.46,-1550.3 4636.19,-1541.07"/>
<polygon fill="black" stroke="black" points="4638.04,-1538.08 4627.94,-1534.87 4633.83,-1543.68 4638.04,-1538.08"/>
</g>
<!-- route_layer13_gpu5&#45;&gt;comm_layer13 -->
<g id="edge1302" class="edge">
<title>route_layer13_gpu5&#45;&gt;comm_layer13</title>
<path fill="none" stroke="black" d="M5938.73,-1955.4C6036.67,-1945.79 6151.78,-1935.28 6256,-1927.81 6689.34,-1896.76 7195.08,-1875.12 7488.78,-1864"/>
<polygon fill="black" stroke="black" points="7489.28,-1867.49 7499.14,-1863.61 7489.02,-1860.49 7489.28,-1867.49"/>
</g>
<!-- mha_layer14_gpu5 -->
<g id="node1141" class="node">
<title>mha_layer14_gpu5</title>
<path fill="lightblue" stroke="black" d="M5639,-1534.86C5639,-1534.86 5191,-1534.86 5191,-1534.86 5185,-1534.86 5179,-1528.86 5179,-1522.86 5179,-1522.86 5179,-1493.86 5179,-1493.86 5179,-1487.86 5185,-1481.86 5191,-1481.86 5191,-1481.86 5639,-1481.86 5639,-1481.86 5645,-1481.86 5651,-1487.86 5651,-1493.86 5651,-1493.86 5651,-1522.86 5651,-1522.86 5651,-1528.86 5645,-1534.86 5639,-1534.86"/>
<text text-anchor="middle" x="5415" y="-1519.66" font-family="Times,serif" font-size="14.00">MHA Layer 14 GPU 5</text>
<text text-anchor="middle" x="5415" y="-1504.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5415" y="-1489.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer13_gpu5&#45;&gt;mha_layer14_gpu5 -->
<g id="edge1350" class="edge">
<title>aggregate_layer13_gpu5&#45;&gt;mha_layer14_gpu5</title>
<path fill="none" stroke="black" d="M5578.92,-1570.76C5549.26,-1559.65 5518.97,-1548.31 5492.63,-1538.44"/>
<polygon fill="black" stroke="black" points="5493.7,-1535.1 5483.11,-1534.87 5491.25,-1541.66 5493.7,-1535.1"/>
</g>
<!-- route_layer13_gpu6&#45;&gt;comm_layer13 -->
<g id="edge1303" class="edge">
<title>route_layer13_gpu6&#45;&gt;comm_layer13</title>
<path fill="none" stroke="black" d="M6829.93,-1952.58C6899.64,-1944.46 6976.43,-1935.63 7047,-1927.81 7207.42,-1910.03 7389.01,-1890.95 7525.34,-1876.83"/>
<polygon fill="black" stroke="black" points="7525.9,-1880.29 7535.48,-1875.78 7525.18,-1873.32 7525.9,-1880.29"/>
</g>
<!-- mha_layer14_gpu6 -->
<g id="node1142" class="node">
<title>mha_layer14_gpu6</title>
<path fill="lightblue" stroke="black" d="M6611,-1534.86C6611,-1534.86 6163,-1534.86 6163,-1534.86 6157,-1534.86 6151,-1528.86 6151,-1522.86 6151,-1522.86 6151,-1493.86 6151,-1493.86 6151,-1487.86 6157,-1481.86 6163,-1481.86 6163,-1481.86 6611,-1481.86 6611,-1481.86 6617,-1481.86 6623,-1487.86 6623,-1493.86 6623,-1493.86 6623,-1522.86 6623,-1522.86 6623,-1528.86 6617,-1534.86 6611,-1534.86"/>
<text text-anchor="middle" x="6387" y="-1519.66" font-family="Times,serif" font-size="14.00">MHA Layer 14 GPU 6</text>
<text text-anchor="middle" x="6387" y="-1504.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6387" y="-1489.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer13_gpu6&#45;&gt;mha_layer14_gpu6 -->
<g id="edge1351" class="edge">
<title>aggregate_layer13_gpu6&#45;&gt;mha_layer14_gpu6</title>
<path fill="none" stroke="black" d="M6448.67,-1570.76C6438.89,-1561.02 6428.91,-1551.09 6419.92,-1542.14"/>
<polygon fill="black" stroke="black" points="6422.18,-1539.45 6412.63,-1534.87 6417.24,-1544.41 6422.18,-1539.45"/>
</g>
<!-- route_layer13_gpu7&#45;&gt;comm_layer13 -->
<g id="edge1304" class="edge">
<title>route_layer13_gpu7&#45;&gt;comm_layer13</title>
<path fill="none" stroke="black" d="M7534.89,-1927.75C7567.54,-1915.93 7601.57,-1903.62 7632.12,-1892.57"/>
<polygon fill="black" stroke="black" points="7633.69,-1895.72 7641.91,-1889.02 7631.31,-1889.13 7633.69,-1895.72"/>
</g>
<!-- mha_layer14_gpu7 -->
<g id="node1143" class="node">
<title>mha_layer14_gpu7</title>
<path fill="lightblue" stroke="black" d="M7504,-1534.86C7504,-1534.86 7056,-1534.86 7056,-1534.86 7050,-1534.86 7044,-1528.86 7044,-1522.86 7044,-1522.86 7044,-1493.86 7044,-1493.86 7044,-1487.86 7050,-1481.86 7056,-1481.86 7056,-1481.86 7504,-1481.86 7504,-1481.86 7510,-1481.86 7516,-1487.86 7516,-1493.86 7516,-1493.86 7516,-1522.86 7516,-1522.86 7516,-1528.86 7510,-1534.86 7504,-1534.86"/>
<text text-anchor="middle" x="7280" y="-1519.66" font-family="Times,serif" font-size="14.00">MHA Layer 14 GPU 7</text>
<text text-anchor="middle" x="7280" y="-1504.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7280" y="-1489.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer13_gpu7&#45;&gt;mha_layer14_gpu7 -->
<g id="edge1352" class="edge">
<title>aggregate_layer13_gpu7&#45;&gt;mha_layer14_gpu7</title>
<path fill="none" stroke="black" d="M7315.7,-1570.76C7310.38,-1561.6 7304.96,-1552.28 7300,-1543.76"/>
<polygon fill="black" stroke="black" points="7302.89,-1541.76 7294.84,-1534.87 7296.84,-1545.28 7302.89,-1541.76"/>
</g>
<!-- route_layer13_gpu8&#45;&gt;comm_layer13 -->
<g id="edge1305" class="edge">
<title>route_layer13_gpu8&#45;&gt;comm_layer13</title>
<path fill="none" stroke="black" d="M8015.38,-1927.75C7965.27,-1914.8 7912.83,-1901.26 7867.03,-1889.43"/>
<polygon fill="black" stroke="black" points="7867.62,-1885.97 7857.06,-1886.86 7865.87,-1892.75 7867.62,-1885.97"/>
</g>
<!-- mha_layer14_gpu8 -->
<g id="node1144" class="node">
<title>mha_layer14_gpu8</title>
<path fill="lightblue" stroke="black" d="M8415,-1534.86C8415,-1534.86 7967,-1534.86 7967,-1534.86 7961,-1534.86 7955,-1528.86 7955,-1522.86 7955,-1522.86 7955,-1493.86 7955,-1493.86 7955,-1487.86 7961,-1481.86 7967,-1481.86 7967,-1481.86 8415,-1481.86 8415,-1481.86 8421,-1481.86 8427,-1487.86 8427,-1493.86 8427,-1493.86 8427,-1522.86 8427,-1522.86 8427,-1528.86 8421,-1534.86 8415,-1534.86"/>
<text text-anchor="middle" x="8191" y="-1519.66" font-family="Times,serif" font-size="14.00">MHA Layer 14 GPU 8</text>
<text text-anchor="middle" x="8191" y="-1504.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8191" y="-1489.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer13_gpu8&#45;&gt;mha_layer14_gpu8 -->
<g id="edge1353" class="edge">
<title>aggregate_layer13_gpu8&#45;&gt;mha_layer14_gpu8</title>
<path fill="none" stroke="black" d="M8155.3,-1570.76C8160.62,-1561.6 8166.04,-1552.28 8171,-1543.76"/>
<polygon fill="black" stroke="black" points="8174.16,-1545.28 8176.16,-1534.87 8168.11,-1541.76 8174.16,-1545.28"/>
</g>
<!-- route_layer13_gpu9&#45;&gt;comm_layer13 -->
<g id="edge1306" class="edge">
<title>route_layer13_gpu9&#45;&gt;comm_layer13</title>
<path fill="none" stroke="black" d="M8806.73,-1950.64C8726.78,-1943.1 8640.66,-1935.07 8561,-1927.81 8355.63,-1909.11 8121.46,-1888.65 7955.03,-1874.25"/>
<polygon fill="black" stroke="black" points="7954.93,-1870.73 7944.67,-1873.35 7954.33,-1877.7 7954.93,-1870.73"/>
</g>
<!-- mha_layer14_gpu9 -->
<g id="node1145" class="node">
<title>mha_layer14_gpu9</title>
<path fill="lightblue" stroke="black" d="M9128,-1534.86C9128,-1534.86 8680,-1534.86 8680,-1534.86 8674,-1534.86 8668,-1528.86 8668,-1522.86 8668,-1522.86 8668,-1493.86 8668,-1493.86 8668,-1487.86 8674,-1481.86 8680,-1481.86 8680,-1481.86 9128,-1481.86 9128,-1481.86 9134,-1481.86 9140,-1487.86 9140,-1493.86 9140,-1493.86 9140,-1522.86 9140,-1522.86 9140,-1528.86 9134,-1534.86 9128,-1534.86"/>
<text text-anchor="middle" x="8904" y="-1519.66" font-family="Times,serif" font-size="14.00">MHA Layer 14 GPU 9</text>
<text text-anchor="middle" x="8904" y="-1504.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8904" y="-1489.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer13_gpu9&#45;&gt;mha_layer14_gpu9 -->
<g id="edge1354" class="edge">
<title>aggregate_layer13_gpu9&#45;&gt;mha_layer14_gpu9</title>
<path fill="none" stroke="black" d="M8886.15,-1570.76C8888.73,-1561.89 8891.35,-1552.88 8893.76,-1544.58"/>
<polygon fill="black" stroke="black" points="8897.15,-1545.45 8896.58,-1534.87 8890.43,-1543.5 8897.15,-1545.45"/>
</g>
<!-- route_layer13_gpu10&#45;&gt;comm_layer13 -->
<g id="edge1307" class="edge">
<title>route_layer13_gpu10&#45;&gt;comm_layer13</title>
<path fill="none" stroke="black" d="M9734.56,-1949.87C9644.85,-1941.83 9546.55,-1933.74 9456,-1927.81 8932.68,-1893.55 8318.71,-1872.22 7983.88,-1862.18"/>
<polygon fill="black" stroke="black" points="7983.67,-1858.67 7973.57,-1861.87 7983.46,-1865.67 7983.67,-1858.67"/>
</g>
<!-- mha_layer14_gpu10 -->
<g id="node1146" class="node">
<title>mha_layer14_gpu10</title>
<path fill="lightblue" stroke="black" d="M10353,-1534.86C10353,-1534.86 9905,-1534.86 9905,-1534.86 9899,-1534.86 9893,-1528.86 9893,-1522.86 9893,-1522.86 9893,-1493.86 9893,-1493.86 9893,-1487.86 9899,-1481.86 9905,-1481.86 9905,-1481.86 10353,-1481.86 10353,-1481.86 10359,-1481.86 10365,-1487.86 10365,-1493.86 10365,-1493.86 10365,-1522.86 10365,-1522.86 10365,-1528.86 10359,-1534.86 10353,-1534.86"/>
<text text-anchor="middle" x="10129" y="-1519.66" font-family="Times,serif" font-size="14.00">MHA Layer 14 GPU 10</text>
<text text-anchor="middle" x="10129" y="-1504.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10129" y="-1489.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer13_gpu10&#45;&gt;mha_layer14_gpu10 -->
<g id="edge1355" class="edge">
<title>aggregate_layer13_gpu10&#45;&gt;mha_layer14_gpu10</title>
<path fill="none" stroke="black" d="M9892.47,-1572.09C9937.2,-1560.22 9983.26,-1548.01 10022.71,-1537.55"/>
<polygon fill="black" stroke="black" points="10023.82,-1540.87 10032.59,-1534.93 10022.03,-1534.11 10023.82,-1540.87"/>
</g>
<!-- route_layer13_gpu11&#45;&gt;comm_layer13 -->
<g id="edge1308" class="edge">
<title>route_layer13_gpu11&#45;&gt;comm_layer13</title>
<path fill="none" stroke="black" d="M10681.49,-1949.88C10586.54,-1941.55 10481.51,-1933.29 10385,-1927.81 9505.29,-1877.9 8459.29,-1862.11 7987.71,-1857.32"/>
<polygon fill="black" stroke="black" points="7987.75,-1853.82 7977.71,-1857.21 7987.68,-1860.82 7987.75,-1853.82"/>
</g>
<!-- mha_layer14_gpu11 -->
<g id="node1147" class="node">
<title>mha_layer14_gpu11</title>
<path fill="lightblue" stroke="black" d="M10955,-1534.86C10955,-1534.86 10507,-1534.86 10507,-1534.86 10501,-1534.86 10495,-1528.86 10495,-1522.86 10495,-1522.86 10495,-1493.86 10495,-1493.86 10495,-1487.86 10501,-1481.86 10507,-1481.86 10507,-1481.86 10955,-1481.86 10955,-1481.86 10961,-1481.86 10967,-1487.86 10967,-1493.86 10967,-1493.86 10967,-1522.86 10967,-1522.86 10967,-1528.86 10961,-1534.86 10955,-1534.86"/>
<text text-anchor="middle" x="10731" y="-1519.66" font-family="Times,serif" font-size="14.00">MHA Layer 14 GPU 11</text>
<text text-anchor="middle" x="10731" y="-1504.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10731" y="-1489.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer13_gpu11&#45;&gt;mha_layer14_gpu11 -->
<g id="edge1356" class="edge">
<title>aggregate_layer13_gpu11&#45;&gt;mha_layer14_gpu11</title>
<path fill="none" stroke="black" d="M10576.82,-1570.76C10604.47,-1559.75 10632.7,-1548.51 10657.33,-1538.7"/>
<polygon fill="black" stroke="black" points="10658.94,-1541.83 10666.94,-1534.87 10656.35,-1535.32 10658.94,-1541.83"/>
</g>
<!-- route_layer13_gpu12&#45;&gt;comm_layer13 -->
<g id="edge1309" class="edge">
<title>route_layer13_gpu12&#45;&gt;comm_layer13</title>
<path fill="none" stroke="black" d="M11636.35,-1949.8C11539.12,-1941.34 11431.14,-1933.03 11332,-1927.81 10078.64,-1861.92 8576.73,-1854.82 7988.66,-1854.81"/>
<polygon fill="black" stroke="black" points="7988.36,-1851.31 7978.36,-1854.81 7988.36,-1858.31 7988.36,-1851.31"/>
</g>
<!-- mha_layer14_gpu12 -->
<g id="node1148" class="node">
<title>mha_layer14_gpu12</title>
<path fill="lightblue" stroke="black" d="M11501,-1534.86C11501,-1534.86 11053,-1534.86 11053,-1534.86 11047,-1534.86 11041,-1528.86 11041,-1522.86 11041,-1522.86 11041,-1493.86 11041,-1493.86 11041,-1487.86 11047,-1481.86 11053,-1481.86 11053,-1481.86 11501,-1481.86 11501,-1481.86 11507,-1481.86 11513,-1487.86 11513,-1493.86 11513,-1493.86 11513,-1522.86 11513,-1522.86 11513,-1528.86 11507,-1534.86 11501,-1534.86"/>
<text text-anchor="middle" x="11277" y="-1519.66" font-family="Times,serif" font-size="14.00">MHA Layer 14 GPU 12</text>
<text text-anchor="middle" x="11277" y="-1504.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11277" y="-1489.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer13_gpu12&#45;&gt;mha_layer14_gpu12 -->
<g id="edge1357" class="edge">
<title>aggregate_layer13_gpu12&#45;&gt;mha_layer14_gpu12</title>
<path fill="none" stroke="black" d="M11207.76,-1570.76C11218.96,-1560.82 11230.39,-1550.69 11240.64,-1541.6"/>
<polygon fill="black" stroke="black" points="11243.07,-1544.13 11248.23,-1534.87 11238.42,-1538.89 11243.07,-1544.13"/>
</g>
<!-- route_layer13_gpu13&#45;&gt;comm_layer13 -->
<g id="edge1310" class="edge">
<title>route_layer13_gpu13&#45;&gt;comm_layer13</title>
<path fill="none" stroke="black" d="M12596.61,-1949.8C12497.87,-1941.24 12387.89,-1932.87 12287,-1927.81 11440.33,-1885.39 8816.43,-1863.17 7988.2,-1857.09"/>
<polygon fill="black" stroke="black" points="7987.96,-1853.59 7977.94,-1857.01 7987.91,-1860.59 7987.96,-1853.59"/>
</g>
<!-- mha_layer14_gpu13 -->
<g id="node1149" class="node">
<title>mha_layer14_gpu13</title>
<path fill="lightblue" stroke="black" d="M13131,-1534.86C13131,-1534.86 12683,-1534.86 12683,-1534.86 12677,-1534.86 12671,-1528.86 12671,-1522.86 12671,-1522.86 12671,-1493.86 12671,-1493.86 12671,-1487.86 12677,-1481.86 12683,-1481.86 12683,-1481.86 13131,-1481.86 13131,-1481.86 13137,-1481.86 13143,-1487.86 13143,-1493.86 13143,-1493.86 13143,-1522.86 13143,-1522.86 13143,-1528.86 13137,-1534.86 13131,-1534.86"/>
<text text-anchor="middle" x="12907" y="-1519.66" font-family="Times,serif" font-size="14.00">MHA Layer 14 GPU 13</text>
<text text-anchor="middle" x="12907" y="-1504.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12907" y="-1489.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer13_gpu13&#45;&gt;mha_layer14_gpu13 -->
<g id="edge1358" class="edge">
<title>aggregate_layer13_gpu13&#45;&gt;mha_layer14_gpu13</title>
<path fill="none" stroke="black" d="M12593.81,-1578.65C12656.97,-1564.68 12724.97,-1549.63 12781.41,-1537.15"/>
<polygon fill="black" stroke="black" points="12782.44,-1540.5 12791.44,-1534.93 12780.92,-1533.67 12782.44,-1540.5"/>
</g>
<!-- route_layer13_gpu14&#45;&gt;comm_layer13 -->
<g id="edge1311" class="edge">
<title>route_layer13_gpu14&#45;&gt;comm_layer13</title>
<path fill="none" stroke="black" d="M13558.41,-1949.7C13459.15,-1941.11 13348.49,-1932.74 13247,-1927.81 12202.78,-1877.08 8926.27,-1860.15 7988.23,-1856.28"/>
<polygon fill="black" stroke="black" points="7987.99,-1852.78 7977.98,-1856.24 7987.96,-1859.78 7987.99,-1852.78"/>
</g>
<!-- mha_layer14_gpu14 -->
<g id="node1150" class="node">
<title>mha_layer14_gpu14</title>
<path fill="lightblue" stroke="black" d="M13706,-1534.86C13706,-1534.86 13258,-1534.86 13258,-1534.86 13252,-1534.86 13246,-1528.86 13246,-1522.86 13246,-1522.86 13246,-1493.86 13246,-1493.86 13246,-1487.86 13252,-1481.86 13258,-1481.86 13258,-1481.86 13706,-1481.86 13706,-1481.86 13712,-1481.86 13718,-1487.86 13718,-1493.86 13718,-1493.86 13718,-1522.86 13718,-1522.86 13718,-1528.86 13712,-1534.86 13706,-1534.86"/>
<text text-anchor="middle" x="13482" y="-1519.66" font-family="Times,serif" font-size="14.00">MHA Layer 14 GPU 14</text>
<text text-anchor="middle" x="13482" y="-1504.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13482" y="-1489.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer13_gpu14&#45;&gt;mha_layer14_gpu14 -->
<g id="edge1359" class="edge">
<title>aggregate_layer13_gpu14&#45;&gt;mha_layer14_gpu14</title>
<path fill="none" stroke="black" d="M13408.97,-1570.76C13420.9,-1560.73 13433.07,-1550.49 13443.97,-1541.34"/>
<polygon fill="black" stroke="black" points="13446.25,-1543.99 13451.65,-1534.87 13441.75,-1538.63 13446.25,-1543.99"/>
</g>
<!-- route_layer13_gpu15&#45;&gt;comm_layer13 -->
<g id="edge1312" class="edge">
<title>route_layer13_gpu15&#45;&gt;comm_layer13</title>
<path fill="none" stroke="black" d="M14521.31,-1949.62C14421.79,-1941 14310.8,-1932.65 14209,-1927.81 12965.62,-1868.71 9027.7,-1857.62 7988.49,-1855.71"/>
<polygon fill="black" stroke="black" points="7988.28,-1852.21 7978.27,-1855.69 7988.27,-1859.21 7988.28,-1852.21"/>
</g>
<!-- mha_layer14_gpu15 -->
<g id="node1151" class="node">
<title>mha_layer14_gpu15</title>
<path fill="lightblue" stroke="black" d="M14959,-1534.86C14959,-1534.86 14511,-1534.86 14511,-1534.86 14505,-1534.86 14499,-1528.86 14499,-1522.86 14499,-1522.86 14499,-1493.86 14499,-1493.86 14499,-1487.86 14505,-1481.86 14511,-1481.86 14511,-1481.86 14959,-1481.86 14959,-1481.86 14965,-1481.86 14971,-1487.86 14971,-1493.86 14971,-1493.86 14971,-1522.86 14971,-1522.86 14971,-1528.86 14965,-1534.86 14959,-1534.86"/>
<text text-anchor="middle" x="14735" y="-1519.66" font-family="Times,serif" font-size="14.00">MHA Layer 14 GPU 15</text>
<text text-anchor="middle" x="14735" y="-1504.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14735" y="-1489.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer13_gpu15&#45;&gt;mha_layer14_gpu15 -->
<g id="edge1360" class="edge">
<title>aggregate_layer13_gpu15&#45;&gt;mha_layer14_gpu15</title>
<path fill="none" stroke="black" d="M14607.87,-1570.76C14630.16,-1559.99 14652.92,-1549 14672.9,-1539.35"/>
<polygon fill="black" stroke="black" points="14674.69,-1542.37 14682.17,-1534.87 14671.65,-1536.07 14674.69,-1542.37"/>
</g>
<!-- comm_layer13&#45;&gt;expert_layer13_gpu0_expert0 -->
<g id="edge1313" class="edge">
<title>comm_layer13&#45;&gt;expert_layer13_gpu0_expert0</title>
<path fill="none" stroke="black" d="M7492.27,-1851.68C6758.38,-1846.28 4498.18,-1826.85 2625,-1780.86 2392.03,-1775.14 2126.84,-1765.62 1936.81,-1758.27"/>
<polygon fill="black" stroke="black" points="1936.81,-1754.76 1926.68,-1757.87 1936.54,-1761.76 1936.81,-1754.76"/>
</g>
<!-- comm_layer13&#45;&gt;expert_layer13_gpu1_expert1 -->
<g id="edge1314" class="edge">
<title>comm_layer13&#45;&gt;expert_layer13_gpu1_expert1</title>
<path fill="none" stroke="black" d="M7491.81,-1852.42C6841.2,-1849.26 5006.48,-1835.79 3481,-1780.86 3368.39,-1776.81 3243.99,-1770.3 3137.79,-1764.13"/>
<polygon fill="black" stroke="black" points="3137.76,-1760.62 3127.58,-1763.53 3137.36,-1767.61 3137.76,-1760.62"/>
</g>
<!-- comm_layer13&#45;&gt;expert_layer13_gpu2_expert2 -->
<g id="edge1315" class="edge">
<title>comm_layer13&#45;&gt;expert_layer13_gpu2_expert2</title>
<path fill="none" stroke="black" d="M7491.63,-1853.15C6914.02,-1851.65 5415.18,-1841.7 4165,-1780.86 4109.52,-1778.16 4050.08,-1774.24 3993.67,-1770.03"/>
<polygon fill="black" stroke="black" points="3993.78,-1766.53 3983.54,-1769.27 3993.25,-1773.51 3993.78,-1766.53"/>
</g>
<!-- comm_layer13&#45;&gt;expert_layer13_gpu3_expert3 -->
<g id="edge1316" class="edge">
<title>comm_layer13&#45;&gt;expert_layer13_gpu3_expert3</title>
<path fill="none" stroke="black" d="M7491.48,-1853.34C6983.59,-1852.03 5774.35,-1842.1 4762,-1780.86 4734.65,-1779.21 4706.1,-1777.08 4677.67,-1774.7"/>
<polygon fill="black" stroke="black" points="4677.88,-1771.21 4667.62,-1773.85 4677.29,-1778.18 4677.88,-1771.21"/>
</g>
<!-- comm_layer13&#45;&gt;expert_layer13_gpu4_expert4 -->
<g id="edge1317" class="edge">
<title>comm_layer13&#45;&gt;expert_layer13_gpu4_expert4</title>
<path fill="none" stroke="black" d="M7496.66,-1846.59C7106.99,-1835.23 6309.23,-1810.59 5634,-1780.86 5516.11,-1775.67 5385.58,-1768.83 5275.14,-1762.73"/>
<polygon fill="black" stroke="black" points="5275.04,-1759.22 5264.86,-1762.16 5274.65,-1766.21 5275.04,-1759.22"/>
</g>
<!-- comm_layer13&#45;&gt;expert_layer13_gpu5_expert5 -->
<g id="edge1318" class="edge">
<title>comm_layer13&#45;&gt;expert_layer13_gpu5_expert5</title>
<path fill="none" stroke="black" d="M7508.77,-1840.4C7164.02,-1820.69 6509.13,-1783.25 6146.93,-1762.55"/>
<polygon fill="black" stroke="black" points="6147.02,-1759.05 6136.84,-1761.97 6146.62,-1766.04 6147.02,-1759.05"/>
</g>
<!-- comm_layer13&#45;&gt;expert_layer13_gpu6_expert6 -->
<g id="edge1319" class="edge">
<title>comm_layer13&#45;&gt;expert_layer13_gpu6_expert6</title>
<path fill="none" stroke="black" d="M7537.13,-1832.47C7380.84,-1815.98 7161.54,-1792.85 6991.73,-1774.94"/>
<polygon fill="black" stroke="black" points="6991.96,-1771.44 6981.64,-1773.88 6991.22,-1778.4 6991.96,-1771.44"/>
</g>
<!-- comm_layer13&#45;&gt;expert_layer13_gpu7_expert7 -->
<g id="edge1320" class="edge">
<title>comm_layer13&#45;&gt;expert_layer13_gpu7_expert7</title>
<path fill="none" stroke="black" d="M7633.56,-1820.11C7598.68,-1808.68 7559.46,-1795.83 7523.87,-1784.18"/>
<polygon fill="black" stroke="black" points="7524.52,-1780.71 7513.93,-1780.92 7522.34,-1787.36 7524.52,-1780.71"/>
</g>
<!-- comm_layer13&#45;&gt;expert_layer13_gpu8_expert8 -->
<g id="edge1321" class="edge">
<title>comm_layer13&#45;&gt;expert_layer13_gpu8_expert8</title>
<path fill="none" stroke="black" d="M7836.31,-1820.25C7871.55,-1808.74 7911.26,-1795.78 7947.22,-1784.03"/>
<polygon fill="black" stroke="black" points="7948.35,-1787.35 7956.77,-1780.92 7946.18,-1780.69 7948.35,-1787.35"/>
</g>
<!-- comm_layer13&#45;&gt;expert_layer13_gpu9_expert9 -->
<g id="edge1322" class="edge">
<title>comm_layer13&#45;&gt;expert_layer13_gpu9_expert9</title>
<path fill="none" stroke="black" d="M7934,-1832.72C8094.66,-1816.07 8321.88,-1792.53 8496.24,-1774.46"/>
<polygon fill="black" stroke="black" points="8496.75,-1777.93 8506.34,-1773.42 8496.03,-1770.97 8496.75,-1777.93"/>
</g>
<!-- comm_layer13&#45;&gt;expert_layer13_gpu10_expert10 -->
<g id="edge1323" class="edge">
<title>comm_layer13&#45;&gt;expert_layer13_gpu10_expert10</title>
<path fill="none" stroke="black" d="M7962.4,-1840.94C8217.09,-1826.93 8642.18,-1803.16 9008,-1780.86 9089.64,-1775.88 9178.64,-1770.19 9259.01,-1764.96"/>
<polygon fill="black" stroke="black" points="9259.52,-1768.43 9269.27,-1764.29 9259.06,-1761.44 9259.52,-1768.43"/>
</g>
<!-- comm_layer13&#45;&gt;expert_layer13_gpu11_expert11 -->
<g id="edge1324" class="edge">
<title>comm_layer13&#45;&gt;expert_layer13_gpu11_expert11</title>
<path fill="none" stroke="black" d="M7974.1,-1847.18C8354.64,-1836.86 9121.48,-1813.89 9771,-1780.86 9849.63,-1776.86 9935.16,-1771.56 10012.84,-1766.37"/>
<polygon fill="black" stroke="black" points="10013.51,-1769.83 10023.26,-1765.67 10013.05,-1762.85 10013.51,-1769.83"/>
</g>
<!-- comm_layer13&#45;&gt;expert_layer13_gpu12_expert12 -->
<g id="edge1325" class="edge">
<title>comm_layer13&#45;&gt;expert_layer13_gpu12_expert12</title>
<path fill="none" stroke="black" d="M7977.24,-1850.6C8461.48,-1844.35 9583.35,-1825.92 10525,-1780.86 10595.14,-1777.5 10671.06,-1772.72 10741.11,-1767.83"/>
<polygon fill="black" stroke="black" points="10741.67,-1771.3 10751.4,-1767.11 10741.18,-1764.32 10741.67,-1771.3"/>
</g>
<!-- comm_layer13&#45;&gt;expert_layer13_gpu13_expert13 -->
<g id="edge1326" class="edge">
<title>comm_layer13&#45;&gt;expert_layer13_gpu13_expert13</title>
<path fill="none" stroke="black" d="M7977.1,-1850.39C8547.79,-1842.99 10021.95,-1821.28 11253,-1780.86 11410.84,-1775.68 11587.74,-1767.76 11728.09,-1760.98"/>
<polygon fill="black" stroke="black" points="11728.31,-1764.47 11738.13,-1760.49 11727.98,-1757.48 11728.31,-1764.47"/>
</g>
<!-- comm_layer13&#45;&gt;expert_layer13_gpu14_expert14 -->
<g id="edge1327" class="edge">
<title>comm_layer13&#45;&gt;expert_layer13_gpu14_expert14</title>
<path fill="none" stroke="black" d="M7978.01,-1851.99C8653.81,-1847.7 10612.79,-1831.49 12240,-1780.86 12391.92,-1776.13 12561.89,-1768.39 12697.98,-1761.59"/>
<polygon fill="black" stroke="black" points="12698.32,-1765.08 12708.13,-1761.08 12697.97,-1758.09 12698.32,-1765.08"/>
</g>
<!-- comm_layer13&#45;&gt;expert_layer13_gpu15_expert15 -->
<g id="edge1328" class="edge">
<title>comm_layer13&#45;&gt;expert_layer13_gpu15_expert15</title>
<path fill="none" stroke="black" d="M7978.24,-1852.52C8746.3,-1849.41 11188.63,-1835.61 13210,-1780.86 13393.56,-1775.89 13600.54,-1767.35 13758.78,-1760.21"/>
<polygon fill="black" stroke="black" points="13759.3,-1763.69 13769.13,-1759.74 13758.98,-1756.69 13759.3,-1763.69"/>
</g>
<!-- gate_layer14_gpu0 -->
<g id="node1152" class="node">
<title>gate_layer14_gpu0</title>
<path fill="lightsteelblue" stroke="black" d="M499.07,-1444.52C499.07,-1444.52 49.93,-1394.2 49.93,-1394.2 43.96,-1393.53 43.96,-1392.19 49.93,-1391.52 49.93,-1391.52 499.07,-1341.2 499.07,-1341.2 505.04,-1340.53 516.96,-1340.53 522.93,-1341.2 522.93,-1341.2 972.07,-1391.52 972.07,-1391.52 978.04,-1392.19 978.04,-1393.53 972.07,-1394.2 972.07,-1394.2 522.93,-1444.52 522.93,-1444.52 516.96,-1445.19 505.04,-1445.19 499.07,-1444.52"/>
<text text-anchor="middle" x="511" y="-1404.16" font-family="Times,serif" font-size="14.00">Gate Layer 14 GPU 0</text>
<text text-anchor="middle" x="511" y="-1389.16" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="511" y="-1374.16" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer14_gpu0&#45;&gt;gate_layer14_gpu0 -->
<g id="edge1361" class="edge">
<title>mha_layer14_gpu0&#45;&gt;gate_layer14_gpu0</title>
<path fill="none" stroke="black" d="M660.98,-1481.61C641.25,-1470.06 617.31,-1456.06 594.4,-1442.65"/>
<polygon fill="black" stroke="black" points="596.08,-1439.58 585.68,-1437.55 592.54,-1445.62 596.08,-1439.58"/>
</g>
<!-- gate_layer14_gpu1 -->
<g id="node1153" class="node">
<title>gate_layer14_gpu1</title>
<path fill="lightsteelblue" stroke="black" d="M1463.07,-1444.52C1463.07,-1444.52 1013.93,-1394.2 1013.93,-1394.2 1007.96,-1393.53 1007.96,-1392.19 1013.93,-1391.52 1013.93,-1391.52 1463.07,-1341.2 1463.07,-1341.2 1469.04,-1340.53 1480.96,-1340.53 1486.93,-1341.2 1486.93,-1341.2 1936.07,-1391.52 1936.07,-1391.52 1942.04,-1392.19 1942.04,-1393.53 1936.07,-1394.2 1936.07,-1394.2 1486.93,-1444.52 1486.93,-1444.52 1480.96,-1445.19 1469.04,-1445.19 1463.07,-1444.52"/>
<text text-anchor="middle" x="1475" y="-1404.16" font-family="Times,serif" font-size="14.00">Gate Layer 14 GPU 1</text>
<text text-anchor="middle" x="1475" y="-1389.16" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="1475" y="-1374.16" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer14_gpu1&#45;&gt;gate_layer14_gpu1 -->
<g id="edge1362" class="edge">
<title>mha_layer14_gpu1&#45;&gt;gate_layer14_gpu1</title>
<path fill="none" stroke="black" d="M1833.81,-1481.82C1773.95,-1467.14 1697.61,-1448.43 1630.75,-1432.04"/>
<polygon fill="black" stroke="black" points="1631.51,-1428.62 1620.96,-1429.64 1629.84,-1435.42 1631.51,-1428.62"/>
</g>
<!-- gate_layer14_gpu2 -->
<g id="node1154" class="node">
<title>gate_layer14_gpu2</title>
<path fill="lightsteelblue" stroke="black" d="M2427.07,-1444.52C2427.07,-1444.52 1977.93,-1394.2 1977.93,-1394.2 1971.96,-1393.53 1971.96,-1392.19 1977.93,-1391.52 1977.93,-1391.52 2427.07,-1341.2 2427.07,-1341.2 2433.04,-1340.53 2444.96,-1340.53 2450.93,-1341.2 2450.93,-1341.2 2900.07,-1391.52 2900.07,-1391.52 2906.04,-1392.19 2906.04,-1393.53 2900.07,-1394.2 2900.07,-1394.2 2450.93,-1444.52 2450.93,-1444.52 2444.96,-1445.19 2433.04,-1445.19 2427.07,-1444.52"/>
<text text-anchor="middle" x="2439" y="-1404.16" font-family="Times,serif" font-size="14.00">Gate Layer 14 GPU 2</text>
<text text-anchor="middle" x="2439" y="-1389.16" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="2439" y="-1374.16" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer14_gpu2&#45;&gt;gate_layer14_gpu2 -->
<g id="edge1363" class="edge">
<title>mha_layer14_gpu2&#45;&gt;gate_layer14_gpu2</title>
<path fill="none" stroke="black" d="M2531,-1481.61C2520.33,-1471.44 2507.66,-1459.35 2495.19,-1447.45"/>
<polygon fill="black" stroke="black" points="2497.53,-1444.85 2487.88,-1440.48 2492.7,-1449.92 2497.53,-1444.85"/>
</g>
<!-- gate_layer14_gpu3 -->
<g id="node1155" class="node">
<title>gate_layer14_gpu3</title>
<path fill="lightsteelblue" stroke="black" d="M3391.07,-1444.52C3391.07,-1444.52 2941.93,-1394.2 2941.93,-1394.2 2935.96,-1393.53 2935.96,-1392.19 2941.93,-1391.52 2941.93,-1391.52 3391.07,-1341.2 3391.07,-1341.2 3397.04,-1340.53 3408.96,-1340.53 3414.93,-1341.2 3414.93,-1341.2 3864.07,-1391.52 3864.07,-1391.52 3870.04,-1392.19 3870.04,-1393.53 3864.07,-1394.2 3864.07,-1394.2 3414.93,-1444.52 3414.93,-1444.52 3408.96,-1445.19 3397.04,-1445.19 3391.07,-1444.52"/>
<text text-anchor="middle" x="3403" y="-1404.16" font-family="Times,serif" font-size="14.00">Gate Layer 14 GPU 3</text>
<text text-anchor="middle" x="3403" y="-1389.16" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="3403" y="-1374.16" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer14_gpu3&#45;&gt;gate_layer14_gpu3 -->
<g id="edge1364" class="edge">
<title>mha_layer14_gpu3&#45;&gt;gate_layer14_gpu3</title>
<path fill="none" stroke="black" d="M3519.74,-1481.61C3505.38,-1470.81 3488.15,-1457.86 3471.39,-1445.27"/>
<polygon fill="black" stroke="black" points="3473.32,-1442.34 3463.22,-1439.13 3469.11,-1447.93 3473.32,-1442.34"/>
</g>
<!-- gate_layer14_gpu4 -->
<g id="node1156" class="node">
<title>gate_layer14_gpu4</title>
<path fill="lightsteelblue" stroke="black" d="M4355.07,-1444.52C4355.07,-1444.52 3905.93,-1394.2 3905.93,-1394.2 3899.96,-1393.53 3899.96,-1392.19 3905.93,-1391.52 3905.93,-1391.52 4355.07,-1341.2 4355.07,-1341.2 4361.04,-1340.53 4372.96,-1340.53 4378.93,-1341.2 4378.93,-1341.2 4828.07,-1391.52 4828.07,-1391.52 4834.04,-1392.19 4834.04,-1393.53 4828.07,-1394.2 4828.07,-1394.2 4378.93,-1444.52 4378.93,-1444.52 4372.96,-1445.19 4361.04,-1445.19 4355.07,-1444.52"/>
<text text-anchor="middle" x="4367" y="-1404.16" font-family="Times,serif" font-size="14.00">Gate Layer 14 GPU 4</text>
<text text-anchor="middle" x="4367" y="-1389.16" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4367" y="-1374.16" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer14_gpu4&#45;&gt;gate_layer14_gpu4 -->
<g id="edge1365" class="edge">
<title>mha_layer14_gpu4&#45;&gt;gate_layer14_gpu4</title>
<path fill="none" stroke="black" d="M4542.77,-1481.75C4518.7,-1469.71 4489.22,-1454.97 4461.33,-1441.02"/>
<polygon fill="black" stroke="black" points="4462.85,-1437.87 4452.34,-1436.53 4459.72,-1444.13 4462.85,-1437.87"/>
</g>
<!-- gate_layer14_gpu5 -->
<g id="node1157" class="node">
<title>gate_layer14_gpu5</title>
<path fill="lightsteelblue" stroke="black" d="M5319.07,-1444.52C5319.07,-1444.52 4869.93,-1394.2 4869.93,-1394.2 4863.96,-1393.53 4863.96,-1392.19 4869.93,-1391.52 4869.93,-1391.52 5319.07,-1341.2 5319.07,-1341.2 5325.04,-1340.53 5336.96,-1340.53 5342.93,-1341.2 5342.93,-1341.2 5792.07,-1391.52 5792.07,-1391.52 5798.04,-1392.19 5798.04,-1393.53 5792.07,-1394.2 5792.07,-1394.2 5342.93,-1444.52 5342.93,-1444.52 5336.96,-1445.19 5325.04,-1445.19 5319.07,-1444.52"/>
<text text-anchor="middle" x="5331" y="-1404.16" font-family="Times,serif" font-size="14.00">Gate Layer 14 GPU 5</text>
<text text-anchor="middle" x="5331" y="-1389.16" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5331" y="-1374.16" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer14_gpu5&#45;&gt;gate_layer14_gpu5 -->
<g id="edge1366" class="edge">
<title>mha_layer14_gpu5&#45;&gt;gate_layer14_gpu5</title>
<path fill="none" stroke="black" d="M5395.94,-1481.61C5389.07,-1472.33 5381.03,-1461.46 5372.98,-1450.59"/>
<polygon fill="black" stroke="black" points="5375.61,-1448.26 5366.85,-1442.3 5369.99,-1452.42 5375.61,-1448.26"/>
</g>
<!-- gate_layer14_gpu6 -->
<g id="node1158" class="node">
<title>gate_layer14_gpu6</title>
<path fill="lightsteelblue" stroke="black" d="M6283.07,-1444.52C6283.07,-1444.52 5833.93,-1394.2 5833.93,-1394.2 5827.96,-1393.53 5827.96,-1392.19 5833.93,-1391.52 5833.93,-1391.52 6283.07,-1341.2 6283.07,-1341.2 6289.04,-1340.53 6300.96,-1340.53 6306.93,-1341.2 6306.93,-1341.2 6756.07,-1391.52 6756.07,-1391.52 6762.04,-1392.19 6762.04,-1393.53 6756.07,-1394.2 6756.07,-1394.2 6306.93,-1444.52 6306.93,-1444.52 6300.96,-1445.19 6289.04,-1445.19 6283.07,-1444.52"/>
<text text-anchor="middle" x="6295" y="-1404.16" font-family="Times,serif" font-size="14.00">Gate Layer 14 GPU 6</text>
<text text-anchor="middle" x="6295" y="-1389.16" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6295" y="-1374.16" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer14_gpu6&#45;&gt;gate_layer14_gpu6 -->
<g id="edge1367" class="edge">
<title>mha_layer14_gpu6&#45;&gt;gate_layer14_gpu6</title>
<path fill="none" stroke="black" d="M6366.12,-1481.61C6358.44,-1472.13 6349.42,-1461 6340.42,-1449.9"/>
<polygon fill="black" stroke="black" points="6342.91,-1447.41 6333.9,-1441.85 6337.47,-1451.82 6342.91,-1447.41"/>
</g>
<!-- gate_layer14_gpu7 -->
<g id="node1159" class="node">
<title>gate_layer14_gpu7</title>
<path fill="lightsteelblue" stroke="black" d="M7247.07,-1444.52C7247.07,-1444.52 6797.93,-1394.2 6797.93,-1394.2 6791.96,-1393.53 6791.96,-1392.19 6797.93,-1391.52 6797.93,-1391.52 7247.07,-1341.2 7247.07,-1341.2 7253.04,-1340.53 7264.96,-1340.53 7270.93,-1341.2 7270.93,-1341.2 7720.07,-1391.52 7720.07,-1391.52 7726.04,-1392.19 7726.04,-1393.53 7720.07,-1394.2 7720.07,-1394.2 7270.93,-1444.52 7270.93,-1444.52 7264.96,-1445.19 7253.04,-1445.19 7247.07,-1444.52"/>
<text text-anchor="middle" x="7259" y="-1404.16" font-family="Times,serif" font-size="14.00">Gate Layer 14 GPU 7</text>
<text text-anchor="middle" x="7259" y="-1389.16" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="7259" y="-1374.16" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer14_gpu7&#45;&gt;gate_layer14_gpu7 -->
<g id="edge1368" class="edge">
<title>mha_layer14_gpu7&#45;&gt;gate_layer14_gpu7</title>
<path fill="none" stroke="black" d="M7275.23,-1481.61C7273.76,-1473.63 7272.07,-1464.48 7270.34,-1455.17"/>
<polygon fill="black" stroke="black" points="7273.73,-1454.24 7268.47,-1445.04 7266.85,-1455.51 7273.73,-1454.24"/>
</g>
<!-- gate_layer14_gpu8 -->
<g id="node1160" class="node">
<title>gate_layer14_gpu8</title>
<path fill="lightsteelblue" stroke="black" d="M8211.07,-1444.52C8211.07,-1444.52 7761.93,-1394.2 7761.93,-1394.2 7755.96,-1393.53 7755.96,-1392.19 7761.93,-1391.52 7761.93,-1391.52 8211.07,-1341.2 8211.07,-1341.2 8217.04,-1340.53 8228.96,-1340.53 8234.93,-1341.2 8234.93,-1341.2 8684.07,-1391.52 8684.07,-1391.52 8690.04,-1392.19 8690.04,-1393.53 8684.07,-1394.2 8684.07,-1394.2 8234.93,-1444.52 8234.93,-1444.52 8228.96,-1445.19 8217.04,-1445.19 8211.07,-1444.52"/>
<text text-anchor="middle" x="8223" y="-1404.16" font-family="Times,serif" font-size="14.00">Gate Layer 14 GPU 8</text>
<text text-anchor="middle" x="8223" y="-1389.16" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="8223" y="-1374.16" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer14_gpu8&#45;&gt;gate_layer14_gpu8 -->
<g id="edge1369" class="edge">
<title>mha_layer14_gpu8&#45;&gt;gate_layer14_gpu8</title>
<path fill="none" stroke="black" d="M8198.26,-1481.61C8200.58,-1473.36 8203.26,-1463.87 8205.98,-1454.23"/>
<polygon fill="black" stroke="black" points="8209.35,-1455.16 8208.7,-1444.58 8202.62,-1453.26 8209.35,-1455.16"/>
</g>
<!-- gate_layer14_gpu9 -->
<g id="node1161" class="node">
<title>gate_layer14_gpu9</title>
<path fill="lightsteelblue" stroke="black" d="M9175.07,-1444.52C9175.07,-1444.52 8725.93,-1394.2 8725.93,-1394.2 8719.96,-1393.53 8719.96,-1392.19 8725.93,-1391.52 8725.93,-1391.52 9175.07,-1341.2 9175.07,-1341.2 9181.04,-1340.53 9192.96,-1340.53 9198.93,-1341.2 9198.93,-1341.2 9648.07,-1391.52 9648.07,-1391.52 9654.04,-1392.19 9654.04,-1393.53 9648.07,-1394.2 9648.07,-1394.2 9198.93,-1444.52 9198.93,-1444.52 9192.96,-1445.19 9181.04,-1445.19 9175.07,-1444.52"/>
<text text-anchor="middle" x="9187" y="-1404.16" font-family="Times,serif" font-size="14.00">Gate Layer 14 GPU 9</text>
<text text-anchor="middle" x="9187" y="-1389.16" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="9187" y="-1374.16" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer14_gpu9&#45;&gt;gate_layer14_gpu9 -->
<g id="edge1370" class="edge">
<title>mha_layer14_gpu9&#45;&gt;gate_layer14_gpu9</title>
<path fill="none" stroke="black" d="M8967.86,-1481.75C8999.74,-1468.96 9039.23,-1453.13 9075.87,-1438.43"/>
<polygon fill="black" stroke="black" points="9077.63,-1441.49 9085.61,-1434.52 9075.03,-1435 9077.63,-1441.49"/>
</g>
<!-- gate_layer14_gpu10 -->
<g id="node1162" class="node">
<title>gate_layer14_gpu10</title>
<path fill="lightsteelblue" stroke="black" d="M10139.07,-1444.52C10139.07,-1444.52 9689.93,-1394.2 9689.93,-1394.2 9683.96,-1393.53 9683.96,-1392.19 9689.93,-1391.52 9689.93,-1391.52 10139.07,-1341.2 10139.07,-1341.2 10145.04,-1340.53 10156.96,-1340.53 10162.93,-1341.2 10162.93,-1341.2 10612.07,-1391.52 10612.07,-1391.52 10618.04,-1392.19 10618.04,-1393.53 10612.07,-1394.2 10612.07,-1394.2 10162.93,-1444.52 10162.93,-1444.52 10156.96,-1445.19 10145.04,-1445.19 10139.07,-1444.52"/>
<text text-anchor="middle" x="10151" y="-1404.16" font-family="Times,serif" font-size="14.00">Gate Layer 14 GPU 10</text>
<text text-anchor="middle" x="10151" y="-1389.16" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="10151" y="-1374.16" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer14_gpu10&#45;&gt;gate_layer14_gpu10 -->
<g id="edge1371" class="edge">
<title>mha_layer14_gpu10&#45;&gt;gate_layer14_gpu10</title>
<path fill="none" stroke="black" d="M10133.99,-1481.61C10135.55,-1473.55 10137.35,-1464.29 10139.17,-1454.87"/>
<polygon fill="black" stroke="black" points="10142.61,-1455.52 10141.08,-1445.04 10135.74,-1454.19 10142.61,-1455.52"/>
</g>
<!-- gate_layer14_gpu11 -->
<g id="node1163" class="node">
<title>gate_layer14_gpu11</title>
<path fill="lightsteelblue" stroke="black" d="M11103.07,-1444.52C11103.07,-1444.52 10653.93,-1394.2 10653.93,-1394.2 10647.96,-1393.53 10647.96,-1392.19 10653.93,-1391.52 10653.93,-1391.52 11103.07,-1341.2 11103.07,-1341.2 11109.04,-1340.53 11120.96,-1340.53 11126.93,-1341.2 11126.93,-1341.2 11576.07,-1391.52 11576.07,-1391.52 11582.04,-1392.19 11582.04,-1393.53 11576.07,-1394.2 11576.07,-1394.2 11126.93,-1444.52 11126.93,-1444.52 11120.96,-1445.19 11109.04,-1445.19 11103.07,-1444.52"/>
<text text-anchor="middle" x="11115" y="-1404.16" font-family="Times,serif" font-size="14.00">Gate Layer 14 GPU 11</text>
<text text-anchor="middle" x="11115" y="-1389.16" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11115" y="-1374.16" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer14_gpu11&#45;&gt;gate_layer14_gpu11 -->
<g id="edge1372" class="edge">
<title>mha_layer14_gpu11&#45;&gt;gate_layer14_gpu11</title>
<path fill="none" stroke="black" d="M10817.66,-1481.75C10864.72,-1467.84 10924.01,-1450.31 10977.25,-1434.58"/>
<polygon fill="black" stroke="black" points="10978.51,-1437.85 10987.11,-1431.66 10976.53,-1431.14 10978.51,-1437.85"/>
</g>
<!-- gate_layer14_gpu12 -->
<g id="node1164" class="node">
<title>gate_layer14_gpu12</title>
<path fill="lightsteelblue" stroke="black" d="M12067.07,-1444.52C12067.07,-1444.52 11617.93,-1394.2 11617.93,-1394.2 11611.96,-1393.53 11611.96,-1392.19 11617.93,-1391.52 11617.93,-1391.52 12067.07,-1341.2 12067.07,-1341.2 12073.04,-1340.53 12084.96,-1340.53 12090.93,-1341.2 12090.93,-1341.2 12540.07,-1391.52 12540.07,-1391.52 12546.04,-1392.19 12546.04,-1393.53 12540.07,-1394.2 12540.07,-1394.2 12090.93,-1444.52 12090.93,-1444.52 12084.96,-1445.19 12073.04,-1445.19 12067.07,-1444.52"/>
<text text-anchor="middle" x="12079" y="-1404.16" font-family="Times,serif" font-size="14.00">Gate Layer 14 GPU 12</text>
<text text-anchor="middle" x="12079" y="-1389.16" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="12079" y="-1374.16" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer14_gpu12&#45;&gt;gate_layer14_gpu12 -->
<g id="edge1373" class="edge">
<title>mha_layer14_gpu12&#45;&gt;gate_layer14_gpu12</title>
<path fill="none" stroke="black" d="M11457.23,-1481.85C11577.53,-1464.83 11736.33,-1442.36 11863.33,-1424.38"/>
<polygon fill="black" stroke="black" points="11864.17,-1427.8 11873.58,-1422.93 11863.18,-1420.87 11864.17,-1427.8"/>
</g>
<!-- gate_layer14_gpu13 -->
<g id="node1165" class="node">
<title>gate_layer14_gpu13</title>
<path fill="lightsteelblue" stroke="black" d="M13031.07,-1444.52C13031.07,-1444.52 12581.93,-1394.2 12581.93,-1394.2 12575.96,-1393.53 12575.96,-1392.19 12581.93,-1391.52 12581.93,-1391.52 13031.07,-1341.2 13031.07,-1341.2 13037.04,-1340.53 13048.96,-1340.53 13054.93,-1341.2 13054.93,-1341.2 13504.07,-1391.52 13504.07,-1391.52 13510.04,-1392.19 13510.04,-1393.53 13504.07,-1394.2 13504.07,-1394.2 13054.93,-1444.52 13054.93,-1444.52 13048.96,-1445.19 13037.04,-1445.19 13031.07,-1444.52"/>
<text text-anchor="middle" x="13043" y="-1404.16" font-family="Times,serif" font-size="14.00">Gate Layer 14 GPU 13</text>
<text text-anchor="middle" x="13043" y="-1389.16" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13043" y="-1374.16" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer14_gpu13&#45;&gt;gate_layer14_gpu13 -->
<g id="edge1374" class="edge">
<title>mha_layer14_gpu13&#45;&gt;gate_layer14_gpu13</title>
<path fill="none" stroke="black" d="M12937.86,-1481.61C12950.36,-1471.18 12965.27,-1458.73 12979.88,-1446.54"/>
<polygon fill="black" stroke="black" points="12982.51,-1448.9 12987.95,-1439.8 12978.03,-1443.52 12982.51,-1448.9"/>
</g>
<!-- gate_layer14_gpu14 -->
<g id="node1166" class="node">
<title>gate_layer14_gpu14</title>
<path fill="lightsteelblue" stroke="black" d="M13995.07,-1444.52C13995.07,-1444.52 13545.93,-1394.2 13545.93,-1394.2 13539.96,-1393.53 13539.96,-1392.19 13545.93,-1391.52 13545.93,-1391.52 13995.07,-1341.2 13995.07,-1341.2 14001.04,-1340.53 14012.96,-1340.53 14018.93,-1341.2 14018.93,-1341.2 14468.07,-1391.52 14468.07,-1391.52 14474.04,-1392.19 14474.04,-1393.53 14468.07,-1394.2 14468.07,-1394.2 14018.93,-1444.52 14018.93,-1444.52 14012.96,-1445.19 14001.04,-1445.19 13995.07,-1444.52"/>
<text text-anchor="middle" x="14007" y="-1404.16" font-family="Times,serif" font-size="14.00">Gate Layer 14 GPU 14</text>
<text text-anchor="middle" x="14007" y="-1389.16" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14007" y="-1374.16" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer14_gpu14&#45;&gt;gate_layer14_gpu14 -->
<g id="edge1375" class="edge">
<title>mha_layer14_gpu14&#45;&gt;gate_layer14_gpu14</title>
<path fill="none" stroke="black" d="M13600.15,-1481.82C13670.47,-1466.62 13760.84,-1447.08 13838.55,-1430.28"/>
<polygon fill="black" stroke="black" points="13839.41,-1433.67 13848.44,-1428.14 13837.93,-1426.83 13839.41,-1433.67"/>
</g>
<!-- gate_layer14_gpu15 -->
<g id="node1167" class="node">
<title>gate_layer14_gpu15</title>
<path fill="lightsteelblue" stroke="black" d="M14959.07,-1444.52C14959.07,-1444.52 14509.93,-1394.2 14509.93,-1394.2 14503.96,-1393.53 14503.96,-1392.19 14509.93,-1391.52 14509.93,-1391.52 14959.07,-1341.2 14959.07,-1341.2 14965.04,-1340.53 14976.96,-1340.53 14982.93,-1341.2 14982.93,-1341.2 15432.07,-1391.52 15432.07,-1391.52 15438.04,-1392.19 15438.04,-1393.53 15432.07,-1394.2 15432.07,-1394.2 14982.93,-1444.52 14982.93,-1444.52 14976.96,-1445.19 14965.04,-1445.19 14959.07,-1444.52"/>
<text text-anchor="middle" x="14971" y="-1404.16" font-family="Times,serif" font-size="14.00">Gate Layer 14 GPU 15</text>
<text text-anchor="middle" x="14971" y="-1389.16" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14971" y="-1374.16" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer14_gpu15&#45;&gt;gate_layer14_gpu15 -->
<g id="edge1376" class="edge">
<title>mha_layer14_gpu15&#45;&gt;gate_layer14_gpu15</title>
<path fill="none" stroke="black" d="M14788.26,-1481.75C14813.64,-1469.54 14844.8,-1454.55 14874.16,-1440.43"/>
<polygon fill="black" stroke="black" points="14875.72,-1443.57 14883.21,-1436.08 14872.68,-1437.26 14875.72,-1443.57"/>
</g>
<!-- route_layer14_gpu0 -->
<g id="node1184" class="node">
<title>route_layer14_gpu0</title>
<path fill="orange" stroke="black" d="M1109.74,-1303.86C1109.74,-1303.86 601.24,-1303.86 601.24,-1303.86 595.24,-1303.86 584.5,-1300.19 579.75,-1296.52 579.75,-1296.52 461.75,-1205.2 461.75,-1205.2 457,-1201.53 458.26,-1197.86 464.26,-1197.86 464.26,-1197.86 972.76,-1197.86 972.76,-1197.86 978.76,-1197.86 989.5,-1201.53 994.25,-1205.2 994.25,-1205.2 1112.25,-1296.52 1112.25,-1296.52 1117,-1300.19 1115.74,-1303.86 1109.74,-1303.86"/>
<text text-anchor="middle" x="787" y="-1262.16" font-family="Times,serif" font-size="14.00">Token Router Layer 14 GPU 0</text>
<text text-anchor="middle" x="787" y="-1247.16" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="787" y="-1232.16" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer14_gpu0&#45;&gt;route_layer14_gpu0 -->
<g id="edge1377" class="edge">
<title>gate_layer14_gpu0&#45;&gt;route_layer14_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M595.31,-1349.09C620.52,-1336.31 648.56,-1322.08 675.24,-1308.55"/>
<polygon fill="black" stroke="black" points="676.9,-1311.63 684.23,-1303.99 673.73,-1305.39 676.9,-1311.63"/>
</g>
<!-- route_layer14_gpu1 -->
<g id="node1186" class="node">
<title>route_layer14_gpu1</title>
<path fill="orange" stroke="black" d="M2349.74,-1303.86C2349.74,-1303.86 1841.24,-1303.86 1841.24,-1303.86 1835.24,-1303.86 1824.5,-1300.19 1819.75,-1296.52 1819.75,-1296.52 1701.75,-1205.2 1701.75,-1205.2 1697,-1201.53 1698.26,-1197.86 1704.26,-1197.86 1704.26,-1197.86 2212.76,-1197.86 2212.76,-1197.86 2218.76,-1197.86 2229.5,-1201.53 2234.25,-1205.2 2234.25,-1205.2 2352.25,-1296.52 2352.25,-1296.52 2357,-1300.19 2355.74,-1303.86 2349.74,-1303.86"/>
<text text-anchor="middle" x="2027" y="-1262.16" font-family="Times,serif" font-size="14.00">Token Router Layer 14 GPU 1</text>
<text text-anchor="middle" x="2027" y="-1247.16" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="2027" y="-1232.16" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer14_gpu1&#45;&gt;route_layer14_gpu1 -->
<g id="edge1378" class="edge">
<title>gate_layer14_gpu1&#45;&gt;route_layer14_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1617.51,-1355.72C1678.41,-1340.27 1750.72,-1321.93 1817.51,-1304.99"/>
<polygon fill="black" stroke="black" points="1818.49,-1308.35 1827.32,-1302.5 1816.77,-1301.57 1818.49,-1308.35"/>
</g>
<!-- route_layer14_gpu2 -->
<g id="node1188" class="node">
<title>route_layer14_gpu2</title>
<path fill="orange" stroke="black" d="M3313.74,-1303.86C3313.74,-1303.86 2805.24,-1303.86 2805.24,-1303.86 2799.24,-1303.86 2788.5,-1300.19 2783.75,-1296.52 2783.75,-1296.52 2665.75,-1205.2 2665.75,-1205.2 2661,-1201.53 2662.26,-1197.86 2668.26,-1197.86 2668.26,-1197.86 3176.76,-1197.86 3176.76,-1197.86 3182.76,-1197.86 3193.5,-1201.53 3198.25,-1205.2 3198.25,-1205.2 3316.25,-1296.52 3316.25,-1296.52 3321,-1300.19 3319.74,-1303.86 3313.74,-1303.86"/>
<text text-anchor="middle" x="2991" y="-1262.16" font-family="Times,serif" font-size="14.00">Token Router Layer 14 GPU 2</text>
<text text-anchor="middle" x="2991" y="-1247.16" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="2991" y="-1232.16" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer14_gpu2&#45;&gt;route_layer14_gpu2 -->
<g id="edge1379" class="edge">
<title>gate_layer14_gpu2&#45;&gt;route_layer14_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2581.51,-1355.72C2642.41,-1340.27 2714.72,-1321.93 2781.51,-1304.99"/>
<polygon fill="black" stroke="black" points="2782.49,-1308.35 2791.32,-1302.5 2780.77,-1301.57 2782.49,-1308.35"/>
</g>
<!-- route_layer14_gpu3 -->
<g id="node1190" class="node">
<title>route_layer14_gpu3</title>
<path fill="orange" stroke="black" d="M4139.74,-1303.86C4139.74,-1303.86 3631.24,-1303.86 3631.24,-1303.86 3625.24,-1303.86 3614.5,-1300.19 3609.75,-1296.52 3609.75,-1296.52 3491.75,-1205.2 3491.75,-1205.2 3487,-1201.53 3488.26,-1197.86 3494.26,-1197.86 3494.26,-1197.86 4002.76,-1197.86 4002.76,-1197.86 4008.76,-1197.86 4019.5,-1201.53 4024.25,-1205.2 4024.25,-1205.2 4142.25,-1296.52 4142.25,-1296.52 4147,-1300.19 4145.74,-1303.86 4139.74,-1303.86"/>
<text text-anchor="middle" x="3817" y="-1262.16" font-family="Times,serif" font-size="14.00">Token Router Layer 14 GPU 3</text>
<text text-anchor="middle" x="3817" y="-1247.16" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="3817" y="-1232.16" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer14_gpu3&#45;&gt;route_layer14_gpu3 -->
<g id="edge1380" class="edge">
<title>gate_layer14_gpu3&#45;&gt;route_layer14_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3518.6,-1352.77C3560.36,-1338.65 3608.34,-1322.42 3653.44,-1307.17"/>
<polygon fill="black" stroke="black" points="3654.66,-1310.45 3663.01,-1303.93 3652.42,-1303.82 3654.66,-1310.45"/>
</g>
<!-- route_layer14_gpu4 -->
<g id="node1192" class="node">
<title>route_layer14_gpu4</title>
<path fill="orange" stroke="black" d="M4896.74,-1303.86C4896.74,-1303.86 4388.24,-1303.86 4388.24,-1303.86 4382.24,-1303.86 4371.5,-1300.19 4366.75,-1296.52 4366.75,-1296.52 4248.75,-1205.2 4248.75,-1205.2 4244,-1201.53 4245.26,-1197.86 4251.26,-1197.86 4251.26,-1197.86 4759.76,-1197.86 4759.76,-1197.86 4765.76,-1197.86 4776.5,-1201.53 4781.25,-1205.2 4781.25,-1205.2 4899.25,-1296.52 4899.25,-1296.52 4904,-1300.19 4902.74,-1303.86 4896.74,-1303.86"/>
<text text-anchor="middle" x="4574" y="-1262.16" font-family="Times,serif" font-size="14.00">Token Router Layer 14 GPU 4</text>
<text text-anchor="middle" x="4574" y="-1247.16" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="4574" y="-1232.16" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer14_gpu4&#45;&gt;route_layer14_gpu4 -->
<g id="edge1381" class="edge">
<title>gate_layer14_gpu4&#45;&gt;route_layer14_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4433.07,-1347.18C4450.71,-1335.24 4470.04,-1322.17 4488.57,-1309.64"/>
<polygon fill="black" stroke="black" points="4490.69,-1312.43 4497.02,-1303.93 4486.77,-1306.63 4490.69,-1312.43"/>
</g>
<!-- route_layer14_gpu5 -->
<g id="node1194" class="node">
<title>route_layer14_gpu5</title>
<path fill="orange" stroke="black" d="M5860.74,-1303.86C5860.74,-1303.86 5352.24,-1303.86 5352.24,-1303.86 5346.24,-1303.86 5335.5,-1300.19 5330.75,-1296.52 5330.75,-1296.52 5212.75,-1205.2 5212.75,-1205.2 5208,-1201.53 5209.26,-1197.86 5215.26,-1197.86 5215.26,-1197.86 5723.76,-1197.86 5723.76,-1197.86 5729.76,-1197.86 5740.5,-1201.53 5745.25,-1205.2 5745.25,-1205.2 5863.25,-1296.52 5863.25,-1296.52 5868,-1300.19 5866.74,-1303.86 5860.74,-1303.86"/>
<text text-anchor="middle" x="5538" y="-1262.16" font-family="Times,serif" font-size="14.00">Token Router Layer 14 GPU 5</text>
<text text-anchor="middle" x="5538" y="-1247.16" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="5538" y="-1232.16" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer14_gpu5&#45;&gt;route_layer14_gpu5 -->
<g id="edge1382" class="edge">
<title>gate_layer14_gpu5&#45;&gt;route_layer14_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5397.07,-1347.18C5414.71,-1335.24 5434.04,-1322.17 5452.57,-1309.64"/>
<polygon fill="black" stroke="black" points="5454.69,-1312.43 5461.02,-1303.93 5450.77,-1306.63 5454.69,-1312.43"/>
</g>
<!-- route_layer14_gpu6 -->
<g id="node1196" class="node">
<title>route_layer14_gpu6</title>
<path fill="orange" stroke="black" d="M6824.74,-1303.86C6824.74,-1303.86 6316.24,-1303.86 6316.24,-1303.86 6310.24,-1303.86 6299.5,-1300.19 6294.75,-1296.52 6294.75,-1296.52 6176.75,-1205.2 6176.75,-1205.2 6172,-1201.53 6173.26,-1197.86 6179.26,-1197.86 6179.26,-1197.86 6687.76,-1197.86 6687.76,-1197.86 6693.76,-1197.86 6704.5,-1201.53 6709.25,-1205.2 6709.25,-1205.2 6827.25,-1296.52 6827.25,-1296.52 6832,-1300.19 6830.74,-1303.86 6824.74,-1303.86"/>
<text text-anchor="middle" x="6502" y="-1262.16" font-family="Times,serif" font-size="14.00">Token Router Layer 14 GPU 6</text>
<text text-anchor="middle" x="6502" y="-1247.16" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="6502" y="-1232.16" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer14_gpu6&#45;&gt;route_layer14_gpu6 -->
<g id="edge1383" class="edge">
<title>gate_layer14_gpu6&#45;&gt;route_layer14_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6361.07,-1347.18C6378.71,-1335.24 6398.04,-1322.17 6416.57,-1309.64"/>
<polygon fill="black" stroke="black" points="6418.69,-1312.43 6425.02,-1303.93 6414.77,-1306.63 6418.69,-1312.43"/>
</g>
<!-- route_layer14_gpu7 -->
<g id="node1198" class="node">
<title>route_layer14_gpu7</title>
<path fill="orange" stroke="black" d="M7650.74,-1303.86C7650.74,-1303.86 7142.24,-1303.86 7142.24,-1303.86 7136.24,-1303.86 7125.5,-1300.19 7120.75,-1296.52 7120.75,-1296.52 7002.75,-1205.2 7002.75,-1205.2 6998,-1201.53 6999.26,-1197.86 7005.26,-1197.86 7005.26,-1197.86 7513.76,-1197.86 7513.76,-1197.86 7519.76,-1197.86 7530.5,-1201.53 7535.25,-1205.2 7535.25,-1205.2 7653.25,-1296.52 7653.25,-1296.52 7658,-1300.19 7656.74,-1303.86 7650.74,-1303.86"/>
<text text-anchor="middle" x="7328" y="-1262.16" font-family="Times,serif" font-size="14.00">Token Router Layer 14 GPU 7</text>
<text text-anchor="middle" x="7328" y="-1247.16" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="7328" y="-1232.16" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer14_gpu7&#45;&gt;route_layer14_gpu7 -->
<g id="edge1384" class="edge">
<title>gate_layer14_gpu7&#45;&gt;route_layer14_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7283.33,-1342.5C7287.97,-1333.08 7292.89,-1323.1 7297.69,-1313.35"/>
<polygon fill="black" stroke="black" points="7300.97,-1314.61 7302.26,-1304.09 7294.7,-1311.52 7300.97,-1314.61"/>
</g>
<!-- route_layer14_gpu8 -->
<g id="node1200" class="node">
<title>route_layer14_gpu8</title>
<path fill="orange" stroke="black" d="M8476.74,-1303.86C8476.74,-1303.86 7968.24,-1303.86 7968.24,-1303.86 7962.24,-1303.86 7951.5,-1300.19 7946.75,-1296.52 7946.75,-1296.52 7828.75,-1205.2 7828.75,-1205.2 7824,-1201.53 7825.26,-1197.86 7831.26,-1197.86 7831.26,-1197.86 8339.76,-1197.86 8339.76,-1197.86 8345.76,-1197.86 8356.5,-1201.53 8361.25,-1205.2 8361.25,-1205.2 8479.25,-1296.52 8479.25,-1296.52 8484,-1300.19 8482.74,-1303.86 8476.74,-1303.86"/>
<text text-anchor="middle" x="8154" y="-1262.16" font-family="Times,serif" font-size="14.00">Token Router Layer 14 GPU 8</text>
<text text-anchor="middle" x="8154" y="-1247.16" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="8154" y="-1232.16" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer14_gpu8&#45;&gt;route_layer14_gpu8 -->
<g id="edge1385" class="edge">
<title>gate_layer14_gpu8&#45;&gt;route_layer14_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8198.67,-1342.5C8194.03,-1333.08 8189.11,-1323.1 8184.31,-1313.35"/>
<polygon fill="black" stroke="black" points="8187.3,-1311.52 8179.74,-1304.09 8181.03,-1314.61 8187.3,-1311.52"/>
</g>
<!-- route_layer14_gpu9 -->
<g id="node1202" class="node">
<title>route_layer14_gpu9</title>
<path fill="orange" stroke="black" d="M9371.74,-1303.86C9371.74,-1303.86 8863.24,-1303.86 8863.24,-1303.86 8857.24,-1303.86 8846.5,-1300.19 8841.75,-1296.52 8841.75,-1296.52 8723.75,-1205.2 8723.75,-1205.2 8719,-1201.53 8720.26,-1197.86 8726.26,-1197.86 8726.26,-1197.86 9234.76,-1197.86 9234.76,-1197.86 9240.76,-1197.86 9251.5,-1201.53 9256.25,-1205.2 9256.25,-1205.2 9374.25,-1296.52 9374.25,-1296.52 9379,-1300.19 9377.74,-1303.86 9371.74,-1303.86"/>
<text text-anchor="middle" x="9049" y="-1262.16" font-family="Times,serif" font-size="14.00">Token Router Layer 14 GPU 9</text>
<text text-anchor="middle" x="9049" y="-1247.16" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="9049" y="-1232.16" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer14_gpu9&#45;&gt;route_layer14_gpu9 -->
<g id="edge1386" class="edge">
<title>gate_layer14_gpu9&#45;&gt;route_layer14_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9140.66,-1344.85C9130.13,-1334.17 9118.8,-1322.67 9107.83,-1311.54"/>
<polygon fill="black" stroke="black" points="9110.19,-1308.95 9100.68,-1304.29 9105.2,-1313.87 9110.19,-1308.95"/>
</g>
<!-- route_layer14_gpu10 -->
<g id="node1204" class="node">
<title>route_layer14_gpu10</title>
<path fill="orange" stroke="black" d="M10300.74,-1303.86C10300.74,-1303.86 9792.24,-1303.86 9792.24,-1303.86 9786.24,-1303.86 9775.5,-1300.19 9770.75,-1296.52 9770.75,-1296.52 9652.75,-1205.2 9652.75,-1205.2 9648,-1201.53 9649.26,-1197.86 9655.26,-1197.86 9655.26,-1197.86 10163.76,-1197.86 10163.76,-1197.86 10169.76,-1197.86 10180.5,-1201.53 10185.25,-1205.2 10185.25,-1205.2 10303.25,-1296.52 10303.25,-1296.52 10308,-1300.19 10306.74,-1303.86 10300.74,-1303.86"/>
<text text-anchor="middle" x="9978" y="-1262.16" font-family="Times,serif" font-size="14.00">Token Router Layer 14 GPU 10</text>
<text text-anchor="middle" x="9978" y="-1247.16" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="9978" y="-1232.16" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer14_gpu10&#45;&gt;route_layer14_gpu10 -->
<g id="edge1387" class="edge">
<title>gate_layer14_gpu10&#45;&gt;route_layer14_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10094.35,-1346.02C10080.3,-1334.65 10065.05,-1322.31 10050.36,-1310.42"/>
<polygon fill="black" stroke="black" points="10052.24,-1307.44 10042.27,-1303.87 10047.84,-1312.88 10052.24,-1307.44"/>
</g>
<!-- route_layer14_gpu11 -->
<g id="node1206" class="node">
<title>route_layer14_gpu11</title>
<path fill="orange" stroke="black" d="M11247.74,-1303.86C11247.74,-1303.86 10739.24,-1303.86 10739.24,-1303.86 10733.24,-1303.86 10722.5,-1300.19 10717.75,-1296.52 10717.75,-1296.52 10599.75,-1205.2 10599.75,-1205.2 10595,-1201.53 10596.26,-1197.86 10602.26,-1197.86 10602.26,-1197.86 11110.76,-1197.86 11110.76,-1197.86 11116.76,-1197.86 11127.5,-1201.53 11132.25,-1205.2 11132.25,-1205.2 11250.25,-1296.52 11250.25,-1296.52 11255,-1300.19 11253.74,-1303.86 11247.74,-1303.86"/>
<text text-anchor="middle" x="10925" y="-1262.16" font-family="Times,serif" font-size="14.00">Token Router Layer 14 GPU 11</text>
<text text-anchor="middle" x="10925" y="-1247.16" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="10925" y="-1232.16" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer14_gpu11&#45;&gt;route_layer14_gpu11 -->
<g id="edge1388" class="edge">
<title>gate_layer14_gpu11&#45;&gt;route_layer14_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11053.57,-1346.6C11037.74,-1334.93 11020.47,-1322.2 11003.87,-1309.98"/>
<polygon fill="black" stroke="black" points="11005.92,-1307.14 10995.79,-1304.02 11001.77,-1312.77 11005.92,-1307.14"/>
</g>
<!-- route_layer14_gpu12 -->
<g id="node1208" class="node">
<title>route_layer14_gpu12</title>
<path fill="orange" stroke="black" d="M12202.74,-1303.86C12202.74,-1303.86 11694.24,-1303.86 11694.24,-1303.86 11688.24,-1303.86 11677.5,-1300.19 11672.75,-1296.52 11672.75,-1296.52 11554.75,-1205.2 11554.75,-1205.2 11550,-1201.53 11551.26,-1197.86 11557.26,-1197.86 11557.26,-1197.86 12065.76,-1197.86 12065.76,-1197.86 12071.76,-1197.86 12082.5,-1201.53 12087.25,-1205.2 12087.25,-1205.2 12205.25,-1296.52 12205.25,-1296.52 12210,-1300.19 12208.74,-1303.86 12202.74,-1303.86"/>
<text text-anchor="middle" x="11880" y="-1262.16" font-family="Times,serif" font-size="14.00">Token Router Layer 14 GPU 12</text>
<text text-anchor="middle" x="11880" y="-1247.16" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="11880" y="-1232.16" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer14_gpu12&#45;&gt;route_layer14_gpu12 -->
<g id="edge1389" class="edge">
<title>gate_layer14_gpu12&#45;&gt;route_layer14_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12015.21,-1346.99C11998.51,-1335.23 11980.25,-1322.39 11962.71,-1310.05"/>
<polygon fill="black" stroke="black" points="11964.36,-1306.93 11954.17,-1304.04 11960.34,-1312.66 11964.36,-1306.93"/>
</g>
<!-- route_layer14_gpu13 -->
<g id="node1210" class="node">
<title>route_layer14_gpu13</title>
<path fill="orange" stroke="black" d="M13162.74,-1303.86C13162.74,-1303.86 12654.24,-1303.86 12654.24,-1303.86 12648.24,-1303.86 12637.5,-1300.19 12632.75,-1296.52 12632.75,-1296.52 12514.75,-1205.2 12514.75,-1205.2 12510,-1201.53 12511.26,-1197.86 12517.26,-1197.86 12517.26,-1197.86 13025.76,-1197.86 13025.76,-1197.86 13031.76,-1197.86 13042.5,-1201.53 13047.25,-1205.2 13047.25,-1205.2 13165.25,-1296.52 13165.25,-1296.52 13170,-1300.19 13168.74,-1303.86 13162.74,-1303.86"/>
<text text-anchor="middle" x="12840" y="-1262.16" font-family="Times,serif" font-size="14.00">Token Router Layer 14 GPU 13</text>
<text text-anchor="middle" x="12840" y="-1247.16" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="12840" y="-1232.16" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer14_gpu13&#45;&gt;route_layer14_gpu13 -->
<g id="edge1390" class="edge">
<title>gate_layer14_gpu13&#45;&gt;route_layer14_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12977.93,-1346.99C12960.89,-1335.23 12942.27,-1322.39 12924.38,-1310.05"/>
<polygon fill="black" stroke="black" points="12925.88,-1306.84 12915.66,-1304.04 12921.91,-1312.6 12925.88,-1306.84"/>
</g>
<!-- route_layer14_gpu14 -->
<g id="node1212" class="node">
<title>route_layer14_gpu14</title>
<path fill="orange" stroke="black" d="M14124.74,-1303.86C14124.74,-1303.86 13616.24,-1303.86 13616.24,-1303.86 13610.24,-1303.86 13599.5,-1300.19 13594.75,-1296.52 13594.75,-1296.52 13476.75,-1205.2 13476.75,-1205.2 13472,-1201.53 13473.26,-1197.86 13479.26,-1197.86 13479.26,-1197.86 13987.76,-1197.86 13987.76,-1197.86 13993.76,-1197.86 14004.5,-1201.53 14009.25,-1205.2 14009.25,-1205.2 14127.25,-1296.52 14127.25,-1296.52 14132,-1300.19 14130.74,-1303.86 14124.74,-1303.86"/>
<text text-anchor="middle" x="13802" y="-1262.16" font-family="Times,serif" font-size="14.00">Token Router Layer 14 GPU 14</text>
<text text-anchor="middle" x="13802" y="-1247.16" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="13802" y="-1232.16" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer14_gpu14&#45;&gt;route_layer14_gpu14 -->
<g id="edge1391" class="edge">
<title>gate_layer14_gpu14&#45;&gt;route_layer14_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13941.57,-1347.18C13924.1,-1335.24 13904.96,-1322.17 13886.61,-1309.64"/>
<polygon fill="black" stroke="black" points="13888.47,-1306.67 13878.24,-1303.93 13884.52,-1312.46 13888.47,-1306.67"/>
</g>
<!-- route_layer14_gpu15 -->
<g id="node1214" class="node">
<title>route_layer14_gpu15</title>
<path fill="orange" stroke="black" d="M15087.74,-1303.86C15087.74,-1303.86 14579.24,-1303.86 14579.24,-1303.86 14573.24,-1303.86 14562.5,-1300.19 14557.75,-1296.52 14557.75,-1296.52 14439.75,-1205.2 14439.75,-1205.2 14435,-1201.53 14436.26,-1197.86 14442.26,-1197.86 14442.26,-1197.86 14950.76,-1197.86 14950.76,-1197.86 14956.76,-1197.86 14967.5,-1201.53 14972.25,-1205.2 14972.25,-1205.2 15090.25,-1296.52 15090.25,-1296.52 15095,-1300.19 15093.74,-1303.86 15087.74,-1303.86"/>
<text text-anchor="middle" x="14765" y="-1262.16" font-family="Times,serif" font-size="14.00">Token Router Layer 14 GPU 15</text>
<text text-anchor="middle" x="14765" y="-1247.16" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="14765" y="-1232.16" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer14_gpu15&#45;&gt;route_layer14_gpu15 -->
<g id="edge1392" class="edge">
<title>gate_layer14_gpu15&#45;&gt;route_layer14_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14905.25,-1347.18C14887.69,-1335.24 14868.46,-1322.17 14850.02,-1309.64"/>
<polygon fill="black" stroke="black" points="14851.85,-1306.65 14841.61,-1303.93 14847.91,-1312.44 14851.85,-1306.65"/>
</g>
<!-- expert_layer14_gpu0_expert0 -->
<g id="node1168" class="node">
<title>expert_layer14_gpu0_expert0</title>
<path fill="lightcoral" stroke="black" d="M1803.5,-1050.91C1803.5,-1050.91 1334.5,-1050.91 1334.5,-1050.91 1328.5,-1050.91 1322.5,-1044.91 1322.5,-1038.91 1322.5,-1038.91 1322.5,-994.91 1322.5,-994.91 1322.5,-988.91 1328.5,-982.91 1334.5,-982.91 1334.5,-982.91 1803.5,-982.91 1803.5,-982.91 1809.5,-982.91 1815.5,-988.91 1815.5,-994.91 1815.5,-994.91 1815.5,-1038.91 1815.5,-1038.91 1815.5,-1044.91 1809.5,-1050.91 1803.5,-1050.91"/>
<text text-anchor="middle" x="1569" y="-1035.71" font-family="Times,serif" font-size="14.00">Expert 0 Layer 14 GPU 0</text>
<text text-anchor="middle" x="1569" y="-1020.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="1569" y="-1005.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="1569" y="-990.71" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer14_gpu0 -->
<g id="node1185" class="node">
<title>aggregate_layer14_gpu0</title>
<path fill="orange" stroke="black" d="M1803.29,-946.91C1803.29,-946.91 1316.19,-946.91 1316.19,-946.91 1310.19,-946.91 1299.52,-943.14 1294.85,-939.37 1294.85,-939.37 1182.06,-848.44 1182.06,-848.44 1177.38,-844.67 1178.71,-840.91 1184.71,-840.91 1184.71,-840.91 1671.81,-840.91 1671.81,-840.91 1677.81,-840.91 1688.48,-844.67 1693.15,-848.44 1693.15,-848.44 1805.94,-939.37 1805.94,-939.37 1810.62,-943.14 1809.29,-946.91 1803.29,-946.91"/>
<text text-anchor="middle" x="1494" y="-905.21" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 14 GPU 0</text>
<text text-anchor="middle" x="1494" y="-890.21" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="1494" y="-875.21" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer14_gpu0_expert0&#45;&gt;aggregate_layer14_gpu0 -->
<g id="edge1425" class="edge">
<title>expert_layer14_gpu0_expert0&#45;&gt;aggregate_layer14_gpu0</title>
<path fill="none" stroke="black" d="M1548.51,-982.84C1543.26,-974.38 1537.45,-965 1531.63,-955.62"/>
<polygon fill="black" stroke="black" points="1534.55,-953.69 1526.31,-947.03 1528.6,-957.38 1534.55,-953.69"/>
</g>
<!-- expert_layer14_gpu1_expert1 -->
<g id="node1169" class="node">
<title>expert_layer14_gpu1_expert1</title>
<path fill="lightcoral" stroke="black" d="M2996.5,-1050.91C2996.5,-1050.91 2527.5,-1050.91 2527.5,-1050.91 2521.5,-1050.91 2515.5,-1044.91 2515.5,-1038.91 2515.5,-1038.91 2515.5,-994.91 2515.5,-994.91 2515.5,-988.91 2521.5,-982.91 2527.5,-982.91 2527.5,-982.91 2996.5,-982.91 2996.5,-982.91 3002.5,-982.91 3008.5,-988.91 3008.5,-994.91 3008.5,-994.91 3008.5,-1038.91 3008.5,-1038.91 3008.5,-1044.91 3002.5,-1050.91 2996.5,-1050.91"/>
<text text-anchor="middle" x="2762" y="-1035.71" font-family="Times,serif" font-size="14.00">Expert 1 Layer 14 GPU 1</text>
<text text-anchor="middle" x="2762" y="-1020.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2762" y="-1005.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2762" y="-990.71" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer14_gpu1 -->
<g id="node1187" class="node">
<title>aggregate_layer14_gpu1</title>
<path fill="orange" stroke="black" d="M2876.29,-946.91C2876.29,-946.91 2389.19,-946.91 2389.19,-946.91 2383.19,-946.91 2372.52,-943.14 2367.85,-939.37 2367.85,-939.37 2255.06,-848.44 2255.06,-848.44 2250.38,-844.67 2251.71,-840.91 2257.71,-840.91 2257.71,-840.91 2744.81,-840.91 2744.81,-840.91 2750.81,-840.91 2761.48,-844.67 2766.15,-848.44 2766.15,-848.44 2878.94,-939.37 2878.94,-939.37 2883.62,-943.14 2882.29,-946.91 2876.29,-946.91"/>
<text text-anchor="middle" x="2567" y="-905.21" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 14 GPU 1</text>
<text text-anchor="middle" x="2567" y="-890.21" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="2567" y="-875.21" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer14_gpu1_expert1&#45;&gt;aggregate_layer14_gpu1 -->
<g id="edge1426" class="edge">
<title>expert_layer14_gpu1_expert1&#45;&gt;aggregate_layer14_gpu1</title>
<path fill="none" stroke="black" d="M2708.72,-982.84C2693.54,-973.43 2676.56,-962.89 2659.76,-952.47"/>
<polygon fill="black" stroke="black" points="2661.35,-949.33 2651.01,-947.03 2657.66,-955.28 2661.35,-949.33"/>
</g>
<!-- expert_layer14_gpu2_expert2 -->
<g id="node1170" class="node">
<title>expert_layer14_gpu2_expert2</title>
<path fill="lightcoral" stroke="black" d="M3981.5,-1050.91C3981.5,-1050.91 3512.5,-1050.91 3512.5,-1050.91 3506.5,-1050.91 3500.5,-1044.91 3500.5,-1038.91 3500.5,-1038.91 3500.5,-994.91 3500.5,-994.91 3500.5,-988.91 3506.5,-982.91 3512.5,-982.91 3512.5,-982.91 3981.5,-982.91 3981.5,-982.91 3987.5,-982.91 3993.5,-988.91 3993.5,-994.91 3993.5,-994.91 3993.5,-1038.91 3993.5,-1038.91 3993.5,-1044.91 3987.5,-1050.91 3981.5,-1050.91"/>
<text text-anchor="middle" x="3747" y="-1035.71" font-family="Times,serif" font-size="14.00">Expert 2 Layer 14 GPU 2</text>
<text text-anchor="middle" x="3747" y="-1020.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3747" y="-1005.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3747" y="-990.71" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer14_gpu2 -->
<g id="node1189" class="node">
<title>aggregate_layer14_gpu2</title>
<path fill="orange" stroke="black" d="M3777.29,-946.91C3777.29,-946.91 3290.19,-946.91 3290.19,-946.91 3284.19,-946.91 3273.52,-943.14 3268.85,-939.37 3268.85,-939.37 3156.06,-848.44 3156.06,-848.44 3151.38,-844.67 3152.71,-840.91 3158.71,-840.91 3158.71,-840.91 3645.81,-840.91 3645.81,-840.91 3651.81,-840.91 3662.48,-844.67 3667.15,-848.44 3667.15,-848.44 3779.94,-939.37 3779.94,-939.37 3784.62,-943.14 3783.29,-946.91 3777.29,-946.91"/>
<text text-anchor="middle" x="3468" y="-905.21" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 14 GPU 2</text>
<text text-anchor="middle" x="3468" y="-890.21" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="3468" y="-875.21" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer14_gpu2_expert2&#45;&gt;aggregate_layer14_gpu2 -->
<g id="edge1427" class="edge">
<title>expert_layer14_gpu2_expert2&#45;&gt;aggregate_layer14_gpu2</title>
<path fill="none" stroke="black" d="M3670.76,-982.84C3647.99,-972.97 3622.36,-961.85 3597.18,-950.93"/>
<polygon fill="black" stroke="black" points="3598.49,-947.69 3587.93,-946.92 3595.71,-954.11 3598.49,-947.69"/>
</g>
<!-- expert_layer14_gpu3_expert3 -->
<g id="node1171" class="node">
<title>expert_layer14_gpu3_expert3</title>
<path fill="lightcoral" stroke="black" d="M4980.5,-1050.91C4980.5,-1050.91 4511.5,-1050.91 4511.5,-1050.91 4505.5,-1050.91 4499.5,-1044.91 4499.5,-1038.91 4499.5,-1038.91 4499.5,-994.91 4499.5,-994.91 4499.5,-988.91 4505.5,-982.91 4511.5,-982.91 4511.5,-982.91 4980.5,-982.91 4980.5,-982.91 4986.5,-982.91 4992.5,-988.91 4992.5,-994.91 4992.5,-994.91 4992.5,-1038.91 4992.5,-1038.91 4992.5,-1044.91 4986.5,-1050.91 4980.5,-1050.91"/>
<text text-anchor="middle" x="4746" y="-1035.71" font-family="Times,serif" font-size="14.00">Expert 3 Layer 14 GPU 3</text>
<text text-anchor="middle" x="4746" y="-1020.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4746" y="-1005.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4746" y="-990.71" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer14_gpu3 -->
<g id="node1191" class="node">
<title>aggregate_layer14_gpu3</title>
<path fill="orange" stroke="black" d="M4558.29,-946.91C4558.29,-946.91 4071.19,-946.91 4071.19,-946.91 4065.19,-946.91 4054.52,-943.14 4049.85,-939.37 4049.85,-939.37 3937.06,-848.44 3937.06,-848.44 3932.38,-844.67 3933.71,-840.91 3939.71,-840.91 3939.71,-840.91 4426.81,-840.91 4426.81,-840.91 4432.81,-840.91 4443.48,-844.67 4448.15,-848.44 4448.15,-848.44 4560.94,-939.37 4560.94,-939.37 4565.62,-943.14 4564.29,-946.91 4558.29,-946.91"/>
<text text-anchor="middle" x="4249" y="-905.21" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 14 GPU 3</text>
<text text-anchor="middle" x="4249" y="-890.21" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="4249" y="-875.21" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer14_gpu3_expert3&#45;&gt;aggregate_layer14_gpu3 -->
<g id="edge1428" class="edge">
<title>expert_layer14_gpu3_expert3&#45;&gt;aggregate_layer14_gpu3</title>
<path fill="none" stroke="black" d="M4610.19,-982.84C4567.66,-972.49 4519.55,-960.77 4472.63,-949.35"/>
<polygon fill="black" stroke="black" points="4473.18,-945.88 4462.63,-946.92 4471.52,-952.68 4473.18,-945.88"/>
</g>
<!-- expert_layer14_gpu4_expert4 -->
<g id="node1172" class="node">
<title>expert_layer14_gpu4_expert4</title>
<path fill="lightcoral" stroke="black" d="M5574.5,-1050.91C5574.5,-1050.91 5105.5,-1050.91 5105.5,-1050.91 5099.5,-1050.91 5093.5,-1044.91 5093.5,-1038.91 5093.5,-1038.91 5093.5,-994.91 5093.5,-994.91 5093.5,-988.91 5099.5,-982.91 5105.5,-982.91 5105.5,-982.91 5574.5,-982.91 5574.5,-982.91 5580.5,-982.91 5586.5,-988.91 5586.5,-994.91 5586.5,-994.91 5586.5,-1038.91 5586.5,-1038.91 5586.5,-1044.91 5580.5,-1050.91 5574.5,-1050.91"/>
<text text-anchor="middle" x="5340" y="-1035.71" font-family="Times,serif" font-size="14.00">Expert 4 Layer 14 GPU 4</text>
<text text-anchor="middle" x="5340" y="-1020.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5340" y="-1005.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5340" y="-990.71" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer14_gpu4 -->
<g id="node1193" class="node">
<title>aggregate_layer14_gpu4</title>
<path fill="orange" stroke="black" d="M5499.29,-946.91C5499.29,-946.91 5012.19,-946.91 5012.19,-946.91 5006.19,-946.91 4995.52,-943.14 4990.85,-939.37 4990.85,-939.37 4878.06,-848.44 4878.06,-848.44 4873.38,-844.67 4874.71,-840.91 4880.71,-840.91 4880.71,-840.91 5367.81,-840.91 5367.81,-840.91 5373.81,-840.91 5384.48,-844.67 5389.15,-848.44 5389.15,-848.44 5501.94,-939.37 5501.94,-939.37 5506.62,-943.14 5505.29,-946.91 5499.29,-946.91"/>
<text text-anchor="middle" x="5190" y="-905.21" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 14 GPU 4</text>
<text text-anchor="middle" x="5190" y="-890.21" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="5190" y="-875.21" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer14_gpu4_expert4&#45;&gt;aggregate_layer14_gpu4 -->
<g id="edge1429" class="edge">
<title>expert_layer14_gpu4_expert4&#45;&gt;aggregate_layer14_gpu4</title>
<path fill="none" stroke="black" d="M5299.01,-982.84C5287.66,-973.69 5274.99,-963.47 5262.42,-953.33"/>
<polygon fill="black" stroke="black" points="5264.6,-950.59 5254.62,-947.03 5260.21,-956.04 5264.6,-950.59"/>
</g>
<!-- expert_layer14_gpu5_expert5 -->
<g id="node1173" class="node">
<title>expert_layer14_gpu5_expert5</title>
<path fill="lightcoral" stroke="black" d="M6305.5,-1050.91C6305.5,-1050.91 5836.5,-1050.91 5836.5,-1050.91 5830.5,-1050.91 5824.5,-1044.91 5824.5,-1038.91 5824.5,-1038.91 5824.5,-994.91 5824.5,-994.91 5824.5,-988.91 5830.5,-982.91 5836.5,-982.91 5836.5,-982.91 6305.5,-982.91 6305.5,-982.91 6311.5,-982.91 6317.5,-988.91 6317.5,-994.91 6317.5,-994.91 6317.5,-1038.91 6317.5,-1038.91 6317.5,-1044.91 6311.5,-1050.91 6305.5,-1050.91"/>
<text text-anchor="middle" x="6071" y="-1035.71" font-family="Times,serif" font-size="14.00">Expert 5 Layer 14 GPU 5</text>
<text text-anchor="middle" x="6071" y="-1020.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6071" y="-1005.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6071" y="-990.71" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer14_gpu5 -->
<g id="node1195" class="node">
<title>aggregate_layer14_gpu5</title>
<path fill="orange" stroke="black" d="M6220.29,-946.91C6220.29,-946.91 5733.19,-946.91 5733.19,-946.91 5727.19,-946.91 5716.52,-943.14 5711.85,-939.37 5711.85,-939.37 5599.06,-848.44 5599.06,-848.44 5594.38,-844.67 5595.71,-840.91 5601.71,-840.91 5601.71,-840.91 6088.81,-840.91 6088.81,-840.91 6094.81,-840.91 6105.48,-844.67 6110.15,-848.44 6110.15,-848.44 6222.94,-939.37 6222.94,-939.37 6227.62,-943.14 6226.29,-946.91 6220.29,-946.91"/>
<text text-anchor="middle" x="5911" y="-905.21" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 14 GPU 5</text>
<text text-anchor="middle" x="5911" y="-890.21" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="5911" y="-875.21" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer14_gpu5_expert5&#45;&gt;aggregate_layer14_gpu5 -->
<g id="edge1430" class="edge">
<title>expert_layer14_gpu5_expert5&#45;&gt;aggregate_layer14_gpu5</title>
<path fill="none" stroke="black" d="M6027.28,-982.84C6015.17,-973.69 6001.66,-963.47 5988.25,-953.33"/>
<polygon fill="black" stroke="black" points="5990.02,-950.27 5979.93,-947.03 5985.79,-955.86 5990.02,-950.27"/>
</g>
<!-- expert_layer14_gpu6_expert6 -->
<g id="node1174" class="node">
<title>expert_layer14_gpu6_expert6</title>
<path fill="lightcoral" stroke="black" d="M6988.5,-1050.91C6988.5,-1050.91 6519.5,-1050.91 6519.5,-1050.91 6513.5,-1050.91 6507.5,-1044.91 6507.5,-1038.91 6507.5,-1038.91 6507.5,-994.91 6507.5,-994.91 6507.5,-988.91 6513.5,-982.91 6519.5,-982.91 6519.5,-982.91 6988.5,-982.91 6988.5,-982.91 6994.5,-982.91 7000.5,-988.91 7000.5,-994.91 7000.5,-994.91 7000.5,-1038.91 7000.5,-1038.91 7000.5,-1044.91 6994.5,-1050.91 6988.5,-1050.91"/>
<text text-anchor="middle" x="6754" y="-1035.71" font-family="Times,serif" font-size="14.00">Expert 6 Layer 14 GPU 6</text>
<text text-anchor="middle" x="6754" y="-1020.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6754" y="-1005.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6754" y="-990.71" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer14_gpu6 -->
<g id="node1197" class="node">
<title>aggregate_layer14_gpu6</title>
<path fill="orange" stroke="black" d="M6911.29,-946.91C6911.29,-946.91 6424.19,-946.91 6424.19,-946.91 6418.19,-946.91 6407.52,-943.14 6402.85,-939.37 6402.85,-939.37 6290.06,-848.44 6290.06,-848.44 6285.38,-844.67 6286.71,-840.91 6292.71,-840.91 6292.71,-840.91 6779.81,-840.91 6779.81,-840.91 6785.81,-840.91 6796.48,-844.67 6801.15,-848.44 6801.15,-848.44 6913.94,-939.37 6913.94,-939.37 6918.62,-943.14 6917.29,-946.91 6911.29,-946.91"/>
<text text-anchor="middle" x="6602" y="-905.21" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 14 GPU 6</text>
<text text-anchor="middle" x="6602" y="-890.21" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="6602" y="-875.21" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer14_gpu6_expert6&#45;&gt;aggregate_layer14_gpu6 -->
<g id="edge1431" class="edge">
<title>expert_layer14_gpu6_expert6&#45;&gt;aggregate_layer14_gpu6</title>
<path fill="none" stroke="black" d="M6712.47,-982.84C6700.96,-973.69 6688.13,-963.47 6675.39,-953.33"/>
<polygon fill="black" stroke="black" points="6677.49,-950.52 6667.48,-947.03 6673.13,-956 6677.49,-950.52"/>
</g>
<!-- expert_layer14_gpu7_expert7 -->
<g id="node1175" class="node">
<title>expert_layer14_gpu7_expert7</title>
<path fill="lightcoral" stroke="black" d="M7581.5,-1050.91C7581.5,-1050.91 7112.5,-1050.91 7112.5,-1050.91 7106.5,-1050.91 7100.5,-1044.91 7100.5,-1038.91 7100.5,-1038.91 7100.5,-994.91 7100.5,-994.91 7100.5,-988.91 7106.5,-982.91 7112.5,-982.91 7112.5,-982.91 7581.5,-982.91 7581.5,-982.91 7587.5,-982.91 7593.5,-988.91 7593.5,-994.91 7593.5,-994.91 7593.5,-1038.91 7593.5,-1038.91 7593.5,-1044.91 7587.5,-1050.91 7581.5,-1050.91"/>
<text text-anchor="middle" x="7347" y="-1035.71" font-family="Times,serif" font-size="14.00">Expert 7 Layer 14 GPU 7</text>
<text text-anchor="middle" x="7347" y="-1020.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7347" y="-1005.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7347" y="-990.71" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer14_gpu7 -->
<g id="node1199" class="node">
<title>aggregate_layer14_gpu7</title>
<path fill="orange" stroke="black" d="M7587.29,-946.91C7587.29,-946.91 7100.19,-946.91 7100.19,-946.91 7094.19,-946.91 7083.52,-943.14 7078.85,-939.37 7078.85,-939.37 6966.06,-848.44 6966.06,-848.44 6961.38,-844.67 6962.71,-840.91 6968.71,-840.91 6968.71,-840.91 7455.81,-840.91 7455.81,-840.91 7461.81,-840.91 7472.48,-844.67 7477.15,-848.44 7477.15,-848.44 7589.94,-939.37 7589.94,-939.37 7594.62,-943.14 7593.29,-946.91 7587.29,-946.91"/>
<text text-anchor="middle" x="7278" y="-905.21" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 14 GPU 7</text>
<text text-anchor="middle" x="7278" y="-890.21" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="7278" y="-875.21" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer14_gpu7_expert7&#45;&gt;aggregate_layer14_gpu7 -->
<g id="edge1432" class="edge">
<title>expert_layer14_gpu7_expert7&#45;&gt;aggregate_layer14_gpu7</title>
<path fill="none" stroke="black" d="M7328.15,-982.84C7323.37,-974.46 7318.08,-965.2 7312.79,-955.91"/>
<polygon fill="black" stroke="black" points="7315.72,-953.99 7307.73,-947.03 7309.64,-957.45 7315.72,-953.99"/>
</g>
<!-- expert_layer14_gpu8_expert8 -->
<g id="node1176" class="node">
<title>expert_layer14_gpu8_expert8</title>
<path fill="lightcoral" stroke="black" d="M8231.5,-1050.91C8231.5,-1050.91 7762.5,-1050.91 7762.5,-1050.91 7756.5,-1050.91 7750.5,-1044.91 7750.5,-1038.91 7750.5,-1038.91 7750.5,-994.91 7750.5,-994.91 7750.5,-988.91 7756.5,-982.91 7762.5,-982.91 7762.5,-982.91 8231.5,-982.91 8231.5,-982.91 8237.5,-982.91 8243.5,-988.91 8243.5,-994.91 8243.5,-994.91 8243.5,-1038.91 8243.5,-1038.91 8243.5,-1044.91 8237.5,-1050.91 8231.5,-1050.91"/>
<text text-anchor="middle" x="7997" y="-1035.71" font-family="Times,serif" font-size="14.00">Expert 8 Layer 14 GPU 8</text>
<text text-anchor="middle" x="7997" y="-1020.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7997" y="-1005.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7997" y="-990.71" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer14_gpu8 -->
<g id="node1201" class="node">
<title>aggregate_layer14_gpu8</title>
<path fill="orange" stroke="black" d="M8376.29,-946.91C8376.29,-946.91 7889.19,-946.91 7889.19,-946.91 7883.19,-946.91 7872.52,-943.14 7867.85,-939.37 7867.85,-939.37 7755.06,-848.44 7755.06,-848.44 7750.38,-844.67 7751.71,-840.91 7757.71,-840.91 7757.71,-840.91 8244.81,-840.91 8244.81,-840.91 8250.81,-840.91 8261.48,-844.67 8266.15,-848.44 8266.15,-848.44 8378.94,-939.37 8378.94,-939.37 8383.62,-943.14 8382.29,-946.91 8376.29,-946.91"/>
<text text-anchor="middle" x="8067" y="-905.21" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 14 GPU 8</text>
<text text-anchor="middle" x="8067" y="-890.21" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="8067" y="-875.21" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer14_gpu8_expert8&#45;&gt;aggregate_layer14_gpu8 -->
<g id="edge1433" class="edge">
<title>expert_layer14_gpu8_expert8&#45;&gt;aggregate_layer14_gpu8</title>
<path fill="none" stroke="black" d="M8016.13,-982.84C8020.97,-974.46 8026.34,-965.2 8031.71,-955.91"/>
<polygon fill="black" stroke="black" points="8034.87,-957.44 8036.84,-947.03 8028.81,-953.94 8034.87,-957.44"/>
</g>
<!-- expert_layer14_gpu9_expert9 -->
<g id="node1177" class="node">
<title>expert_layer14_gpu9_expert9</title>
<path fill="lightcoral" stroke="black" d="M8978.5,-1050.91C8978.5,-1050.91 8509.5,-1050.91 8509.5,-1050.91 8503.5,-1050.91 8497.5,-1044.91 8497.5,-1038.91 8497.5,-1038.91 8497.5,-994.91 8497.5,-994.91 8497.5,-988.91 8503.5,-982.91 8509.5,-982.91 8509.5,-982.91 8978.5,-982.91 8978.5,-982.91 8984.5,-982.91 8990.5,-988.91 8990.5,-994.91 8990.5,-994.91 8990.5,-1038.91 8990.5,-1038.91 8990.5,-1044.91 8984.5,-1050.91 8978.5,-1050.91"/>
<text text-anchor="middle" x="8744" y="-1035.71" font-family="Times,serif" font-size="14.00">Expert 9 Layer 14 GPU 9</text>
<text text-anchor="middle" x="8744" y="-1020.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8744" y="-1005.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8744" y="-990.71" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer14_gpu9 -->
<g id="node1203" class="node">
<title>aggregate_layer14_gpu9</title>
<path fill="orange" stroke="black" d="M9220.29,-946.91C9220.29,-946.91 8733.19,-946.91 8733.19,-946.91 8727.19,-946.91 8716.52,-943.14 8711.85,-939.37 8711.85,-939.37 8599.06,-848.44 8599.06,-848.44 8594.38,-844.67 8595.71,-840.91 8601.71,-840.91 8601.71,-840.91 9088.81,-840.91 9088.81,-840.91 9094.81,-840.91 9105.48,-844.67 9110.15,-848.44 9110.15,-848.44 9222.94,-939.37 9222.94,-939.37 9227.62,-943.14 9226.29,-946.91 9220.29,-946.91"/>
<text text-anchor="middle" x="8911" y="-905.21" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 14 GPU 9</text>
<text text-anchor="middle" x="8911" y="-890.21" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="8911" y="-875.21" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer14_gpu9_expert9&#45;&gt;aggregate_layer14_gpu9 -->
<g id="edge1434" class="edge">
<title>expert_layer14_gpu9_expert9&#45;&gt;aggregate_layer14_gpu9</title>
<path fill="none" stroke="black" d="M8789.63,-982.84C8802.39,-973.6 8816.64,-963.28 8830.77,-953.04"/>
<polygon fill="black" stroke="black" points="8833.01,-955.74 8839.06,-947.03 8828.9,-950.07 8833.01,-955.74"/>
</g>
<!-- expert_layer14_gpu10_expert10 -->
<g id="node1178" class="node">
<title>expert_layer14_gpu10_expert10</title>
<path fill="lightcoral" stroke="black" d="M9728.5,-1050.91C9728.5,-1050.91 9259.5,-1050.91 9259.5,-1050.91 9253.5,-1050.91 9247.5,-1044.91 9247.5,-1038.91 9247.5,-1038.91 9247.5,-994.91 9247.5,-994.91 9247.5,-988.91 9253.5,-982.91 9259.5,-982.91 9259.5,-982.91 9728.5,-982.91 9728.5,-982.91 9734.5,-982.91 9740.5,-988.91 9740.5,-994.91 9740.5,-994.91 9740.5,-1038.91 9740.5,-1038.91 9740.5,-1044.91 9734.5,-1050.91 9728.5,-1050.91"/>
<text text-anchor="middle" x="9494" y="-1035.71" font-family="Times,serif" font-size="14.00">Expert 10 Layer 14 GPU 10</text>
<text text-anchor="middle" x="9494" y="-1020.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9494" y="-1005.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9494" y="-990.71" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer14_gpu10 -->
<g id="node1205" class="node">
<title>aggregate_layer14_gpu10</title>
<path fill="orange" stroke="black" d="M9973.29,-946.91C9973.29,-946.91 9486.19,-946.91 9486.19,-946.91 9480.19,-946.91 9469.52,-943.14 9464.85,-939.37 9464.85,-939.37 9352.06,-848.44 9352.06,-848.44 9347.38,-844.67 9348.71,-840.91 9354.71,-840.91 9354.71,-840.91 9841.81,-840.91 9841.81,-840.91 9847.81,-840.91 9858.48,-844.67 9863.15,-848.44 9863.15,-848.44 9975.94,-939.37 9975.94,-939.37 9980.62,-943.14 9979.29,-946.91 9973.29,-946.91"/>
<text text-anchor="middle" x="9664" y="-905.21" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 14 GPU 10</text>
<text text-anchor="middle" x="9664" y="-890.21" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="9664" y="-875.21" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer14_gpu10_expert10&#45;&gt;aggregate_layer14_gpu10 -->
<g id="edge1435" class="edge">
<title>expert_layer14_gpu10_expert10&#45;&gt;aggregate_layer14_gpu10</title>
<path fill="none" stroke="black" d="M9540.45,-982.84C9553.44,-973.6 9567.94,-963.28 9582.32,-953.04"/>
<polygon fill="black" stroke="black" points="9584.65,-955.68 9590.76,-947.03 9580.59,-949.98 9584.65,-955.68"/>
</g>
<!-- expert_layer14_gpu11_expert11 -->
<g id="node1179" class="node">
<title>expert_layer14_gpu11_expert11</title>
<path fill="lightcoral" stroke="black" d="M10456.5,-1050.91C10456.5,-1050.91 9987.5,-1050.91 9987.5,-1050.91 9981.5,-1050.91 9975.5,-1044.91 9975.5,-1038.91 9975.5,-1038.91 9975.5,-994.91 9975.5,-994.91 9975.5,-988.91 9981.5,-982.91 9987.5,-982.91 9987.5,-982.91 10456.5,-982.91 10456.5,-982.91 10462.5,-982.91 10468.5,-988.91 10468.5,-994.91 10468.5,-994.91 10468.5,-1038.91 10468.5,-1038.91 10468.5,-1044.91 10462.5,-1050.91 10456.5,-1050.91"/>
<text text-anchor="middle" x="10222" y="-1035.71" font-family="Times,serif" font-size="14.00">Expert 11 Layer 14 GPU 11</text>
<text text-anchor="middle" x="10222" y="-1020.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10222" y="-1005.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10222" y="-990.71" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer14_gpu11 -->
<g id="node1207" class="node">
<title>aggregate_layer14_gpu11</title>
<path fill="orange" stroke="black" d="M10680.29,-946.91C10680.29,-946.91 10193.19,-946.91 10193.19,-946.91 10187.19,-946.91 10176.52,-943.14 10171.85,-939.37 10171.85,-939.37 10059.06,-848.44 10059.06,-848.44 10054.38,-844.67 10055.71,-840.91 10061.71,-840.91 10061.71,-840.91 10548.81,-840.91 10548.81,-840.91 10554.81,-840.91 10565.48,-844.67 10570.15,-848.44 10570.15,-848.44 10682.94,-939.37 10682.94,-939.37 10687.62,-943.14 10686.29,-946.91 10680.29,-946.91"/>
<text text-anchor="middle" x="10371" y="-905.21" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 14 GPU 11</text>
<text text-anchor="middle" x="10371" y="-890.21" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="10371" y="-875.21" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer14_gpu11_expert11&#45;&gt;aggregate_layer14_gpu11 -->
<g id="edge1436" class="edge">
<title>expert_layer14_gpu11_expert11&#45;&gt;aggregate_layer14_gpu11</title>
<path fill="none" stroke="black" d="M10262.71,-982.84C10273.88,-973.77 10286.34,-963.66 10298.71,-953.61"/>
<polygon fill="black" stroke="black" points="10301.25,-956.05 10306.81,-947.03 10296.84,-950.62 10301.25,-956.05"/>
</g>
<!-- expert_layer14_gpu12_expert12 -->
<g id="node1180" class="node">
<title>expert_layer14_gpu12_expert12</title>
<path fill="lightcoral" stroke="black" d="M11162.5,-1050.91C11162.5,-1050.91 10693.5,-1050.91 10693.5,-1050.91 10687.5,-1050.91 10681.5,-1044.91 10681.5,-1038.91 10681.5,-1038.91 10681.5,-994.91 10681.5,-994.91 10681.5,-988.91 10687.5,-982.91 10693.5,-982.91 10693.5,-982.91 11162.5,-982.91 11162.5,-982.91 11168.5,-982.91 11174.5,-988.91 11174.5,-994.91 11174.5,-994.91 11174.5,-1038.91 11174.5,-1038.91 11174.5,-1044.91 11168.5,-1050.91 11162.5,-1050.91"/>
<text text-anchor="middle" x="10928" y="-1035.71" font-family="Times,serif" font-size="14.00">Expert 12 Layer 14 GPU 12</text>
<text text-anchor="middle" x="10928" y="-1020.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10928" y="-1005.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10928" y="-990.71" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer14_gpu12 -->
<g id="node1209" class="node">
<title>aggregate_layer14_gpu12</title>
<path fill="orange" stroke="black" d="M11364.29,-946.91C11364.29,-946.91 10877.19,-946.91 10877.19,-946.91 10871.19,-946.91 10860.52,-943.14 10855.85,-939.37 10855.85,-939.37 10743.06,-848.44 10743.06,-848.44 10738.38,-844.67 10739.71,-840.91 10745.71,-840.91 10745.71,-840.91 11232.81,-840.91 11232.81,-840.91 11238.81,-840.91 11249.48,-844.67 11254.15,-848.44 11254.15,-848.44 11366.94,-939.37 11366.94,-939.37 11371.62,-943.14 11370.29,-946.91 11364.29,-946.91"/>
<text text-anchor="middle" x="11055" y="-905.21" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 14 GPU 12</text>
<text text-anchor="middle" x="11055" y="-890.21" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="11055" y="-875.21" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer14_gpu12_expert12&#45;&gt;aggregate_layer14_gpu12 -->
<g id="edge1437" class="edge">
<title>expert_layer14_gpu12_expert12&#45;&gt;aggregate_layer14_gpu12</title>
<path fill="none" stroke="black" d="M10962.7,-982.84C10972.04,-973.95 10982.43,-964.05 10992.78,-954.19"/>
<polygon fill="black" stroke="black" points="10995.46,-956.47 11000.29,-947.03 10990.63,-951.4 10995.46,-956.47"/>
</g>
<!-- expert_layer14_gpu13_expert13 -->
<g id="node1181" class="node">
<title>expert_layer14_gpu13_expert13</title>
<path fill="lightcoral" stroke="black" d="M12149.5,-1050.91C12149.5,-1050.91 11680.5,-1050.91 11680.5,-1050.91 11674.5,-1050.91 11668.5,-1044.91 11668.5,-1038.91 11668.5,-1038.91 11668.5,-994.91 11668.5,-994.91 11668.5,-988.91 11674.5,-982.91 11680.5,-982.91 11680.5,-982.91 12149.5,-982.91 12149.5,-982.91 12155.5,-982.91 12161.5,-988.91 12161.5,-994.91 12161.5,-994.91 12161.5,-1038.91 12161.5,-1038.91 12161.5,-1044.91 12155.5,-1050.91 12149.5,-1050.91"/>
<text text-anchor="middle" x="11915" y="-1035.71" font-family="Times,serif" font-size="14.00">Expert 13 Layer 14 GPU 13</text>
<text text-anchor="middle" x="11915" y="-1020.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11915" y="-1005.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11915" y="-990.71" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer14_gpu13 -->
<g id="node1211" class="node">
<title>aggregate_layer14_gpu13</title>
<path fill="orange" stroke="black" d="M12632.29,-946.91C12632.29,-946.91 12145.19,-946.91 12145.19,-946.91 12139.19,-946.91 12128.52,-943.14 12123.85,-939.37 12123.85,-939.37 12011.06,-848.44 12011.06,-848.44 12006.38,-844.67 12007.71,-840.91 12013.71,-840.91 12013.71,-840.91 12500.81,-840.91 12500.81,-840.91 12506.81,-840.91 12517.48,-844.67 12522.15,-848.44 12522.15,-848.44 12634.94,-939.37 12634.94,-939.37 12639.62,-943.14 12638.29,-946.91 12632.29,-946.91"/>
<text text-anchor="middle" x="12323" y="-905.21" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 14 GPU 13</text>
<text text-anchor="middle" x="12323" y="-890.21" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="12323" y="-875.21" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer14_gpu13_expert13&#45;&gt;aggregate_layer14_gpu13 -->
<g id="edge1438" class="edge">
<title>expert_layer14_gpu13_expert13&#45;&gt;aggregate_layer14_gpu13</title>
<path fill="none" stroke="black" d="M12026.49,-982.84C12060.96,-972.62 12099.91,-961.07 12137.97,-949.78"/>
<polygon fill="black" stroke="black" points="12139.03,-953.12 12147.62,-946.92 12137.04,-946.41 12139.03,-953.12"/>
</g>
<!-- expert_layer14_gpu14_expert14 -->
<g id="node1182" class="node">
<title>expert_layer14_gpu14_expert14</title>
<path fill="lightcoral" stroke="black" d="M13125.5,-1050.91C13125.5,-1050.91 12656.5,-1050.91 12656.5,-1050.91 12650.5,-1050.91 12644.5,-1044.91 12644.5,-1038.91 12644.5,-1038.91 12644.5,-994.91 12644.5,-994.91 12644.5,-988.91 12650.5,-982.91 12656.5,-982.91 12656.5,-982.91 13125.5,-982.91 13125.5,-982.91 13131.5,-982.91 13137.5,-988.91 13137.5,-994.91 13137.5,-994.91 13137.5,-1038.91 13137.5,-1038.91 13137.5,-1044.91 13131.5,-1050.91 13125.5,-1050.91"/>
<text text-anchor="middle" x="12891" y="-1035.71" font-family="Times,serif" font-size="14.00">Expert 14 Layer 14 GPU 14</text>
<text text-anchor="middle" x="12891" y="-1020.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12891" y="-1005.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12891" y="-990.71" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer14_gpu14 -->
<g id="node1213" class="node">
<title>aggregate_layer14_gpu14</title>
<path fill="orange" stroke="black" d="M13596.29,-946.91C13596.29,-946.91 13109.19,-946.91 13109.19,-946.91 13103.19,-946.91 13092.52,-943.14 13087.85,-939.37 13087.85,-939.37 12975.06,-848.44 12975.06,-848.44 12970.38,-844.67 12971.71,-840.91 12977.71,-840.91 12977.71,-840.91 13464.81,-840.91 13464.81,-840.91 13470.81,-840.91 13481.48,-844.67 13486.15,-848.44 13486.15,-848.44 13598.94,-939.37 13598.94,-939.37 13603.62,-943.14 13602.29,-946.91 13596.29,-946.91"/>
<text text-anchor="middle" x="13287" y="-905.21" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 14 GPU 14</text>
<text text-anchor="middle" x="13287" y="-890.21" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="13287" y="-875.21" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer14_gpu14_expert14&#45;&gt;aggregate_layer14_gpu14 -->
<g id="edge1439" class="edge">
<title>expert_layer14_gpu14_expert14&#45;&gt;aggregate_layer14_gpu14</title>
<path fill="none" stroke="black" d="M12999.21,-982.84C13032.53,-972.66 13070.15,-961.17 13106.94,-949.92"/>
<polygon fill="black" stroke="black" points="13108.24,-953.19 13116.78,-946.92 13106.19,-946.49 13108.24,-953.19"/>
</g>
<!-- expert_layer14_gpu15_expert15 -->
<g id="node1183" class="node">
<title>expert_layer14_gpu15_expert15</title>
<path fill="lightcoral" stroke="black" d="M14019.5,-1050.91C14019.5,-1050.91 13550.5,-1050.91 13550.5,-1050.91 13544.5,-1050.91 13538.5,-1044.91 13538.5,-1038.91 13538.5,-1038.91 13538.5,-994.91 13538.5,-994.91 13538.5,-988.91 13544.5,-982.91 13550.5,-982.91 13550.5,-982.91 14019.5,-982.91 14019.5,-982.91 14025.5,-982.91 14031.5,-988.91 14031.5,-994.91 14031.5,-994.91 14031.5,-1038.91 14031.5,-1038.91 14031.5,-1044.91 14025.5,-1050.91 14019.5,-1050.91"/>
<text text-anchor="middle" x="13785" y="-1035.71" font-family="Times,serif" font-size="14.00">Expert 15 Layer 14 GPU 15</text>
<text text-anchor="middle" x="13785" y="-1020.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="13785" y="-1005.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="13785" y="-990.71" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer14_gpu15 -->
<g id="node1215" class="node">
<title>aggregate_layer14_gpu15</title>
<path fill="orange" stroke="black" d="M14409.29,-946.91C14409.29,-946.91 13922.19,-946.91 13922.19,-946.91 13916.19,-946.91 13905.52,-943.14 13900.85,-939.37 13900.85,-939.37 13788.06,-848.44 13788.06,-848.44 13783.38,-844.67 13784.71,-840.91 13790.71,-840.91 13790.71,-840.91 14277.81,-840.91 14277.81,-840.91 14283.81,-840.91 14294.48,-844.67 14299.15,-848.44 14299.15,-848.44 14411.94,-939.37 14411.94,-939.37 14416.62,-943.14 14415.29,-946.91 14409.29,-946.91"/>
<text text-anchor="middle" x="14100" y="-905.21" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 14 GPU 15</text>
<text text-anchor="middle" x="14100" y="-890.21" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="14100" y="-875.21" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer14_gpu15_expert15&#45;&gt;aggregate_layer14_gpu15 -->
<g id="edge1440" class="edge">
<title>expert_layer14_gpu15_expert15&#45;&gt;aggregate_layer14_gpu15</title>
<path fill="none" stroke="black" d="M13871.08,-982.84C13897.02,-972.88 13926.23,-961.65 13954.9,-950.64"/>
<polygon fill="black" stroke="black" points="13956.52,-953.77 13964.6,-946.92 13954.01,-947.24 13956.52,-953.77"/>
</g>
<!-- comm_layer14 -->
<g id="node1216" class="node">
<title>comm_layer14</title>
<ellipse fill="lightpink" stroke="black" cx="7672" cy="-1124.38" rx="243.49" ry="37.45"/>
<text text-anchor="middle" x="7672" y="-1135.68" font-family="Times,serif" font-size="14.00">Cross&#45;GPU Communication Layer 14</text>
<text text-anchor="middle" x="7672" y="-1120.68" font-family="Times,serif" font-size="14.00">Input: Tokens from routing decisions</text>
<text text-anchor="middle" x="7672" y="-1105.68" font-family="Times,serif" font-size="14.00">Output: Tokens delivered to destination GPUs</text>
</g>
<!-- route_layer14_gpu0&#45;&gt;comm_layer14 -->
<g id="edge1393" class="edge">
<title>route_layer14_gpu0&#45;&gt;comm_layer14</title>
<path fill="none" stroke="black" d="M1030.24,-1232.72C1210.38,-1220.76 1461.88,-1205.61 1683,-1197.86 2826.58,-1157.78 6430.44,-1133.05 7419.02,-1126.9"/>
<polygon fill="black" stroke="black" points="7419.12,-1130.4 7429.1,-1126.83 7419.08,-1123.4 7419.12,-1130.4"/>
</g>
<!-- mha_layer15_gpu0 -->
<g id="node1217" class="node">
<title>mha_layer15_gpu0</title>
<path fill="lightblue" stroke="black" d="M1559,-804.91C1559,-804.91 1111,-804.91 1111,-804.91 1105,-804.91 1099,-798.91 1099,-792.91 1099,-792.91 1099,-763.91 1099,-763.91 1099,-757.91 1105,-751.91 1111,-751.91 1111,-751.91 1559,-751.91 1559,-751.91 1565,-751.91 1571,-757.91 1571,-763.91 1571,-763.91 1571,-792.91 1571,-792.91 1571,-798.91 1565,-804.91 1559,-804.91"/>
<text text-anchor="middle" x="1335" y="-789.71" font-family="Times,serif" font-size="14.00">MHA Layer 15 GPU 0</text>
<text text-anchor="middle" x="1335" y="-774.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1335" y="-759.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer14_gpu0&#45;&gt;mha_layer15_gpu0 -->
<g id="edge1441" class="edge">
<title>aggregate_layer14_gpu0&#45;&gt;mha_layer15_gpu0</title>
<path fill="none" stroke="black" d="M1421.01,-840.81C1406.68,-830.58 1392.07,-820.14 1379.05,-810.85"/>
<polygon fill="black" stroke="black" points="1380.91,-807.88 1370.74,-804.92 1376.85,-813.58 1380.91,-807.88"/>
</g>
<!-- route_layer14_gpu1&#45;&gt;comm_layer14 -->
<g id="edge1394" class="edge">
<title>route_layer14_gpu1&#45;&gt;comm_layer14</title>
<path fill="none" stroke="black" d="M2261.91,-1226.3C2377.72,-1215.67 2519.56,-1204.12 2647,-1197.86 3590.85,-1151.53 6535.3,-1131.71 7418.86,-1126.71"/>
<polygon fill="black" stroke="black" points="7419.18,-1130.21 7429.16,-1126.65 7419.14,-1123.21 7419.18,-1130.21"/>
</g>
<!-- mha_layer15_gpu1 -->
<g id="node1218" class="node">
<title>mha_layer15_gpu1</title>
<path fill="lightblue" stroke="black" d="M2593,-804.91C2593,-804.91 2145,-804.91 2145,-804.91 2139,-804.91 2133,-798.91 2133,-792.91 2133,-792.91 2133,-763.91 2133,-763.91 2133,-757.91 2139,-751.91 2145,-751.91 2145,-751.91 2593,-751.91 2593,-751.91 2599,-751.91 2605,-757.91 2605,-763.91 2605,-763.91 2605,-792.91 2605,-792.91 2605,-798.91 2599,-804.91 2593,-804.91"/>
<text text-anchor="middle" x="2369" y="-789.71" font-family="Times,serif" font-size="14.00">MHA Layer 15 GPU 1</text>
<text text-anchor="middle" x="2369" y="-774.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2369" y="-759.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer14_gpu1&#45;&gt;mha_layer15_gpu1 -->
<g id="edge1442" class="edge">
<title>aggregate_layer14_gpu1&#45;&gt;mha_layer15_gpu1</title>
<path fill="none" stroke="black" d="M2476.11,-840.81C2457.76,-830.28 2439.03,-819.55 2422.47,-810.06"/>
<polygon fill="black" stroke="black" points="2423.92,-806.86 2413.51,-804.92 2420.44,-812.93 2423.92,-806.86"/>
</g>
<!-- route_layer14_gpu2&#45;&gt;comm_layer14 -->
<g id="edge1395" class="edge">
<title>route_layer14_gpu2&#45;&gt;comm_layer14</title>
<path fill="none" stroke="black" d="M3218.97,-1221C3299.14,-1211.98 3389.94,-1203.05 3473,-1197.86 4247.05,-1149.52 6634.45,-1131.47 7419.16,-1126.75"/>
<polygon fill="black" stroke="black" points="7419.19,-1130.25 7429.17,-1126.69 7419.15,-1123.25 7419.19,-1130.25"/>
</g>
<!-- mha_layer15_gpu2 -->
<g id="node1219" class="node">
<title>mha_layer15_gpu2</title>
<path fill="lightblue" stroke="black" d="M3289,-804.91C3289,-804.91 2841,-804.91 2841,-804.91 2835,-804.91 2829,-798.91 2829,-792.91 2829,-792.91 2829,-763.91 2829,-763.91 2829,-757.91 2835,-751.91 2841,-751.91 2841,-751.91 3289,-751.91 3289,-751.91 3295,-751.91 3301,-757.91 3301,-763.91 3301,-763.91 3301,-792.91 3301,-792.91 3301,-798.91 3295,-804.91 3289,-804.91"/>
<text text-anchor="middle" x="3065" y="-789.71" font-family="Times,serif" font-size="14.00">MHA Layer 15 GPU 2</text>
<text text-anchor="middle" x="3065" y="-774.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3065" y="-759.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer14_gpu2&#45;&gt;mha_layer15_gpu2 -->
<g id="edge1443" class="edge">
<title>aggregate_layer14_gpu2&#45;&gt;mha_layer15_gpu2</title>
<path fill="none" stroke="black" d="M3283.31,-840.89C3242.8,-829.48 3201.38,-817.82 3165.66,-807.76"/>
<polygon fill="black" stroke="black" points="3166.31,-804.3 3155.74,-804.96 3164.41,-811.04 3166.31,-804.3"/>
</g>
<!-- route_layer14_gpu3&#45;&gt;comm_layer14 -->
<g id="edge1396" class="edge">
<title>route_layer14_gpu3&#45;&gt;comm_layer14</title>
<path fill="none" stroke="black" d="M4040.29,-1217.43C4101.65,-1209.7 4168.29,-1202.38 4230,-1197.86 4849.79,-1152.44 6733.8,-1132.99 7419.23,-1127.28"/>
<polygon fill="black" stroke="black" points="7419.26,-1130.78 7429.23,-1127.2 7419.2,-1123.78 7419.26,-1130.78"/>
</g>
<!-- mha_layer15_gpu3 -->
<g id="node1220" class="node">
<title>mha_layer15_gpu3</title>
<path fill="lightblue" stroke="black" d="M3937,-804.91C3937,-804.91 3489,-804.91 3489,-804.91 3483,-804.91 3477,-798.91 3477,-792.91 3477,-792.91 3477,-763.91 3477,-763.91 3477,-757.91 3483,-751.91 3489,-751.91 3489,-751.91 3937,-751.91 3937,-751.91 3943,-751.91 3949,-757.91 3949,-763.91 3949,-763.91 3949,-792.91 3949,-792.91 3949,-798.91 3943,-804.91 3937,-804.91"/>
<text text-anchor="middle" x="3713" y="-789.71" font-family="Times,serif" font-size="14.00">MHA Layer 15 GPU 3</text>
<text text-anchor="middle" x="3713" y="-774.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3713" y="-759.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer14_gpu3&#45;&gt;mha_layer15_gpu3 -->
<g id="edge1444" class="edge">
<title>aggregate_layer14_gpu3&#45;&gt;mha_layer15_gpu3</title>
<path fill="none" stroke="black" d="M4003.35,-840.89C3948.21,-829.21 3891.8,-817.27 3843.54,-807.05"/>
<polygon fill="black" stroke="black" points="3844.19,-803.61 3833.68,-804.96 3842.74,-810.46 3844.19,-803.61"/>
</g>
<!-- route_layer14_gpu4&#45;&gt;comm_layer14 -->
<g id="edge1397" class="edge">
<title>route_layer14_gpu4&#45;&gt;comm_layer14</title>
<path fill="none" stroke="black" d="M4809.68,-1227.06C4925.37,-1216.64 5066.88,-1205.04 5194,-1197.86 6006.66,-1151.93 6970.99,-1134.31 7419.38,-1128.23"/>
<polygon fill="black" stroke="black" points="7419.6,-1131.73 7429.55,-1128.1 7419.51,-1124.73 7419.6,-1131.73"/>
</g>
<!-- mha_layer15_gpu4 -->
<g id="node1221" class="node">
<title>mha_layer15_gpu4</title>
<path fill="lightblue" stroke="black" d="M4664,-804.91C4664,-804.91 4216,-804.91 4216,-804.91 4210,-804.91 4204,-798.91 4204,-792.91 4204,-792.91 4204,-763.91 4204,-763.91 4204,-757.91 4210,-751.91 4216,-751.91 4216,-751.91 4664,-751.91 4664,-751.91 4670,-751.91 4676,-757.91 4676,-763.91 4676,-763.91 4676,-792.91 4676,-792.91 4676,-798.91 4670,-804.91 4664,-804.91"/>
<text text-anchor="middle" x="4440" y="-789.71" font-family="Times,serif" font-size="14.00">MHA Layer 15 GPU 4</text>
<text text-anchor="middle" x="4440" y="-774.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4440" y="-759.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer14_gpu4&#45;&gt;mha_layer15_gpu4 -->
<g id="edge1445" class="edge">
<title>aggregate_layer14_gpu4&#45;&gt;mha_layer15_gpu4</title>
<path fill="none" stroke="black" d="M4873.83,-845.06C4786.7,-831.87 4695.22,-818.03 4618.85,-806.47"/>
<polygon fill="black" stroke="black" points="4619.07,-802.97 4608.66,-804.93 4618.02,-809.89 4619.07,-802.97"/>
</g>
<!-- route_layer14_gpu5&#45;&gt;comm_layer14 -->
<g id="edge1398" class="edge">
<title>route_layer14_gpu5&#45;&gt;comm_layer14</title>
<path fill="none" stroke="black" d="M5774.85,-1227.99C5890.35,-1217.84 6031.35,-1206.2 6158,-1197.86 6605.05,-1168.42 7127.11,-1146.08 7426.68,-1134.42"/>
<polygon fill="black" stroke="black" points="7426.95,-1137.91 7436.81,-1134.03 7426.68,-1130.92 7426.95,-1137.91"/>
</g>
<!-- mha_layer15_gpu5 -->
<g id="node1222" class="node">
<title>mha_layer15_gpu5</title>
<path fill="lightblue" stroke="black" d="M5832,-804.91C5832,-804.91 5384,-804.91 5384,-804.91 5378,-804.91 5372,-798.91 5372,-792.91 5372,-792.91 5372,-763.91 5372,-763.91 5372,-757.91 5378,-751.91 5384,-751.91 5384,-751.91 5832,-751.91 5832,-751.91 5838,-751.91 5844,-757.91 5844,-763.91 5844,-763.91 5844,-792.91 5844,-792.91 5844,-798.91 5838,-804.91 5832,-804.91"/>
<text text-anchor="middle" x="5608" y="-789.71" font-family="Times,serif" font-size="14.00">MHA Layer 15 GPU 5</text>
<text text-anchor="middle" x="5608" y="-774.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5608" y="-759.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer14_gpu5&#45;&gt;mha_layer15_gpu5 -->
<g id="edge1446" class="edge">
<title>aggregate_layer14_gpu5&#45;&gt;mha_layer15_gpu5</title>
<path fill="none" stroke="black" d="M5771.92,-840.81C5742.26,-829.7 5711.97,-818.35 5685.63,-808.49"/>
<polygon fill="black" stroke="black" points="5686.7,-805.15 5676.11,-804.92 5684.25,-811.71 5686.7,-805.15"/>
</g>
<!-- route_layer14_gpu6&#45;&gt;comm_layer14 -->
<g id="edge1399" class="edge">
<title>route_layer14_gpu6&#45;&gt;comm_layer14</title>
<path fill="none" stroke="black" d="M6734.58,-1224.65C6813.73,-1216.1 6902.71,-1206.53 6984,-1197.86 7144.93,-1180.7 7327.07,-1161.53 7463.5,-1147.21"/>
<polygon fill="black" stroke="black" points="7464.07,-1150.67 7473.65,-1146.14 7463.34,-1143.71 7464.07,-1150.67"/>
</g>
<!-- mha_layer15_gpu6 -->
<g id="node1223" class="node">
<title>mha_layer15_gpu6</title>
<path fill="lightblue" stroke="black" d="M6675,-804.91C6675,-804.91 6227,-804.91 6227,-804.91 6221,-804.91 6215,-798.91 6215,-792.91 6215,-792.91 6215,-763.91 6215,-763.91 6215,-757.91 6221,-751.91 6227,-751.91 6227,-751.91 6675,-751.91 6675,-751.91 6681,-751.91 6687,-757.91 6687,-763.91 6687,-763.91 6687,-792.91 6687,-792.91 6687,-798.91 6681,-804.91 6675,-804.91"/>
<text text-anchor="middle" x="6451" y="-789.71" font-family="Times,serif" font-size="14.00">MHA Layer 15 GPU 6</text>
<text text-anchor="middle" x="6451" y="-774.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6451" y="-759.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer14_gpu6&#45;&gt;mha_layer15_gpu6 -->
<g id="edge1447" class="edge">
<title>aggregate_layer14_gpu6&#45;&gt;mha_layer15_gpu6</title>
<path fill="none" stroke="black" d="M6532.69,-840.81C6519.21,-830.67 6505.46,-820.34 6493.19,-811.12"/>
<polygon fill="black" stroke="black" points="6495.04,-808.13 6484.94,-804.92 6490.83,-813.73 6495.04,-808.13"/>
</g>
<!-- route_layer14_gpu7&#45;&gt;comm_layer14 -->
<g id="edge1400" class="edge">
<title>route_layer14_gpu7&#45;&gt;comm_layer14</title>
<path fill="none" stroke="black" d="M7471.89,-1197.79C7504.54,-1185.98 7538.57,-1173.66 7569.12,-1162.61"/>
<polygon fill="black" stroke="black" points="7570.69,-1165.76 7578.91,-1159.07 7568.31,-1159.18 7570.69,-1165.76"/>
</g>
<!-- mha_layer15_gpu7 -->
<g id="node1224" class="node">
<title>mha_layer15_gpu7</title>
<path fill="lightblue" stroke="black" d="M7456,-804.91C7456,-804.91 7008,-804.91 7008,-804.91 7002,-804.91 6996,-798.91 6996,-792.91 6996,-792.91 6996,-763.91 6996,-763.91 6996,-757.91 7002,-751.91 7008,-751.91 7008,-751.91 7456,-751.91 7456,-751.91 7462,-751.91 7468,-757.91 7468,-763.91 7468,-763.91 7468,-792.91 7468,-792.91 7468,-798.91 7462,-804.91 7456,-804.91"/>
<text text-anchor="middle" x="7232" y="-789.71" font-family="Times,serif" font-size="14.00">MHA Layer 15 GPU 7</text>
<text text-anchor="middle" x="7232" y="-774.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7232" y="-759.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer14_gpu7&#45;&gt;mha_layer15_gpu7 -->
<g id="edge1448" class="edge">
<title>aggregate_layer14_gpu7&#45;&gt;mha_layer15_gpu7</title>
<path fill="none" stroke="black" d="M7256.88,-840.81C7253.25,-831.84 7249.56,-822.72 7246.16,-814.35"/>
<polygon fill="black" stroke="black" points="7249.34,-812.87 7242.34,-804.92 7242.85,-815.5 7249.34,-812.87"/>
</g>
<!-- route_layer14_gpu8&#45;&gt;comm_layer14 -->
<g id="edge1401" class="edge">
<title>route_layer14_gpu8&#45;&gt;comm_layer14</title>
<path fill="none" stroke="black" d="M7952.38,-1197.79C7902.27,-1184.85 7849.83,-1171.31 7804.03,-1159.48"/>
<polygon fill="black" stroke="black" points="7804.62,-1156.02 7794.06,-1156.91 7802.87,-1162.8 7804.62,-1156.02"/>
</g>
<!-- mha_layer15_gpu8 -->
<g id="node1225" class="node">
<title>mha_layer15_gpu8</title>
<path fill="lightblue" stroke="black" d="M8350,-804.91C8350,-804.91 7902,-804.91 7902,-804.91 7896,-804.91 7890,-798.91 7890,-792.91 7890,-792.91 7890,-763.91 7890,-763.91 7890,-757.91 7896,-751.91 7902,-751.91 7902,-751.91 8350,-751.91 8350,-751.91 8356,-751.91 8362,-757.91 8362,-763.91 8362,-763.91 8362,-792.91 8362,-792.91 8362,-798.91 8356,-804.91 8350,-804.91"/>
<text text-anchor="middle" x="8126" y="-789.71" font-family="Times,serif" font-size="14.00">MHA Layer 15 GPU 8</text>
<text text-anchor="middle" x="8126" y="-774.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8126" y="-759.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer14_gpu8&#45;&gt;mha_layer15_gpu8 -->
<g id="edge1449" class="edge">
<title>aggregate_layer14_gpu8&#45;&gt;mha_layer15_gpu8</title>
<path fill="none" stroke="black" d="M8094.08,-840.81C8098.84,-831.65 8103.69,-822.33 8108.12,-813.81"/>
<polygon fill="black" stroke="black" points="8111.23,-815.41 8112.74,-804.92 8105.02,-812.18 8111.23,-815.41"/>
</g>
<!-- route_layer14_gpu9&#45;&gt;comm_layer14 -->
<g id="edge1402" class="edge">
<title>route_layer14_gpu9&#45;&gt;comm_layer14</title>
<path fill="none" stroke="black" d="M8743.73,-1220.69C8663.78,-1213.15 8577.66,-1205.11 8498,-1197.86 8292.63,-1179.16 8058.46,-1158.69 7892.03,-1144.29"/>
<polygon fill="black" stroke="black" points="7891.93,-1140.77 7881.67,-1143.4 7891.33,-1147.75 7891.93,-1140.77"/>
</g>
<!-- mha_layer15_gpu9 -->
<g id="node1226" class="node">
<title>mha_layer15_gpu9</title>
<path fill="lightblue" stroke="black" d="M9367,-804.91C9367,-804.91 8919,-804.91 8919,-804.91 8913,-804.91 8907,-798.91 8907,-792.91 8907,-792.91 8907,-763.91 8907,-763.91 8907,-757.91 8913,-751.91 8919,-751.91 8919,-751.91 9367,-751.91 9367,-751.91 9373,-751.91 9379,-757.91 9379,-763.91 9379,-763.91 9379,-792.91 9379,-792.91 9379,-798.91 9373,-804.91 9367,-804.91"/>
<text text-anchor="middle" x="9143" y="-789.71" font-family="Times,serif" font-size="14.00">MHA Layer 15 GPU 9</text>
<text text-anchor="middle" x="9143" y="-774.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9143" y="-759.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer14_gpu9&#45;&gt;mha_layer15_gpu9 -->
<g id="edge1450" class="edge">
<title>aggregate_layer14_gpu9&#45;&gt;mha_layer15_gpu9</title>
<path fill="none" stroke="black" d="M9017.49,-840.81C9039.5,-830.04 9061.97,-819.05 9081.69,-809.4"/>
<polygon fill="black" stroke="black" points="9083.4,-812.46 9090.85,-804.92 9080.33,-806.17 9083.4,-812.46"/>
</g>
<!-- route_layer14_gpu10&#45;&gt;comm_layer14 -->
<g id="edge1403" class="edge">
<title>route_layer14_gpu10&#45;&gt;comm_layer14</title>
<path fill="none" stroke="black" d="M9671.56,-1219.91C9581.85,-1211.88 9483.55,-1203.79 9393,-1197.86 8869.68,-1163.6 8255.71,-1142.27 7920.88,-1132.23"/>
<polygon fill="black" stroke="black" points="7920.67,-1128.72 7910.57,-1131.92 7920.46,-1135.72 7920.67,-1128.72"/>
</g>
<!-- mha_layer15_gpu10 -->
<g id="node1227" class="node">
<title>mha_layer15_gpu10</title>
<path fill="lightblue" stroke="black" d="M10113,-804.91C10113,-804.91 9665,-804.91 9665,-804.91 9659,-804.91 9653,-798.91 9653,-792.91 9653,-792.91 9653,-763.91 9653,-763.91 9653,-757.91 9659,-751.91 9665,-751.91 9665,-751.91 10113,-751.91 10113,-751.91 10119,-751.91 10125,-757.91 10125,-763.91 10125,-763.91 10125,-792.91 10125,-792.91 10125,-798.91 10119,-804.91 10113,-804.91"/>
<text text-anchor="middle" x="9889" y="-789.71" font-family="Times,serif" font-size="14.00">MHA Layer 15 GPU 10</text>
<text text-anchor="middle" x="9889" y="-774.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9889" y="-759.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer14_gpu10&#45;&gt;mha_layer15_gpu10 -->
<g id="edge1451" class="edge">
<title>aggregate_layer14_gpu10&#45;&gt;mha_layer15_gpu10</title>
<path fill="none" stroke="black" d="M9767.28,-840.81C9788.53,-830.09 9810.21,-819.15 9829.28,-809.53"/>
<polygon fill="black" stroke="black" points="9831.07,-812.55 9838.42,-804.92 9827.92,-806.3 9831.07,-812.55"/>
</g>
<!-- route_layer14_gpu11&#45;&gt;comm_layer14 -->
<g id="edge1404" class="edge">
<title>route_layer14_gpu11&#45;&gt;comm_layer14</title>
<path fill="none" stroke="black" d="M10618.49,-1219.92C10523.54,-1211.59 10418.51,-1203.34 10322,-1197.86 9442.29,-1147.94 8396.29,-1132.15 7924.71,-1127.36"/>
<polygon fill="black" stroke="black" points="7924.75,-1123.86 7914.71,-1127.26 7924.68,-1130.86 7924.75,-1123.86"/>
</g>
<!-- mha_layer15_gpu11 -->
<g id="node1228" class="node">
<title>mha_layer15_gpu11</title>
<path fill="lightblue" stroke="black" d="M10731,-804.91C10731,-804.91 10283,-804.91 10283,-804.91 10277,-804.91 10271,-798.91 10271,-792.91 10271,-792.91 10271,-763.91 10271,-763.91 10271,-757.91 10277,-751.91 10283,-751.91 10283,-751.91 10731,-751.91 10731,-751.91 10737,-751.91 10743,-757.91 10743,-763.91 10743,-763.91 10743,-792.91 10743,-792.91 10743,-798.91 10737,-804.91 10731,-804.91"/>
<text text-anchor="middle" x="10507" y="-789.71" font-family="Times,serif" font-size="14.00">MHA Layer 15 GPU 11</text>
<text text-anchor="middle" x="10507" y="-774.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10507" y="-759.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer14_gpu11&#45;&gt;mha_layer15_gpu11 -->
<g id="edge1452" class="edge">
<title>aggregate_layer14_gpu11&#45;&gt;mha_layer15_gpu11</title>
<path fill="none" stroke="black" d="M10433.43,-840.81C10445.45,-830.77 10457.71,-820.54 10468.69,-811.38"/>
<polygon fill="black" stroke="black" points="10470.99,-814.01 10476.43,-804.92 10466.51,-808.64 10470.99,-814.01"/>
</g>
<!-- route_layer14_gpu12&#45;&gt;comm_layer14 -->
<g id="edge1405" class="edge">
<title>route_layer14_gpu12&#45;&gt;comm_layer14</title>
<path fill="none" stroke="black" d="M11573.35,-1219.85C11476.12,-1211.39 11368.14,-1203.07 11269,-1197.86 10015.64,-1131.97 8513.73,-1124.86 7925.66,-1124.85"/>
<polygon fill="black" stroke="black" points="7925.36,-1121.35 7915.36,-1124.86 7925.36,-1128.35 7925.36,-1121.35"/>
</g>
<!-- mha_layer15_gpu12 -->
<g id="node1229" class="node">
<title>mha_layer15_gpu12</title>
<path fill="lightblue" stroke="black" d="M11285,-804.91C11285,-804.91 10837,-804.91 10837,-804.91 10831,-804.91 10825,-798.91 10825,-792.91 10825,-792.91 10825,-763.91 10825,-763.91 10825,-757.91 10831,-751.91 10837,-751.91 10837,-751.91 11285,-751.91 11285,-751.91 11291,-751.91 11297,-757.91 11297,-763.91 11297,-763.91 11297,-792.91 11297,-792.91 11297,-798.91 11291,-804.91 11285,-804.91"/>
<text text-anchor="middle" x="11061" y="-789.71" font-family="Times,serif" font-size="14.00">MHA Layer 15 GPU 12</text>
<text text-anchor="middle" x="11061" y="-774.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11061" y="-759.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer14_gpu12&#45;&gt;mha_layer15_gpu12 -->
<g id="edge1453" class="edge">
<title>aggregate_layer14_gpu12&#45;&gt;mha_layer15_gpu12</title>
<path fill="none" stroke="black" d="M11057.75,-840.81C11058.21,-832.14 11058.68,-823.32 11059.11,-815.17"/>
<polygon fill="black" stroke="black" points="11062.62,-815.09 11059.65,-804.92 11055.63,-814.72 11062.62,-815.09"/>
</g>
<!-- route_layer14_gpu13&#45;&gt;comm_layer14 -->
<g id="edge1406" class="edge">
<title>route_layer14_gpu13&#45;&gt;comm_layer14</title>
<path fill="none" stroke="black" d="M12533.61,-1219.84C12434.87,-1211.28 12324.89,-1202.92 12224,-1197.86 11377.33,-1155.43 8753.43,-1133.22 7925.2,-1127.13"/>
<polygon fill="black" stroke="black" points="7924.96,-1123.63 7914.94,-1127.06 7924.91,-1130.63 7924.96,-1123.63"/>
</g>
<!-- mha_layer15_gpu13 -->
<g id="node1230" class="node">
<title>mha_layer15_gpu13</title>
<path fill="lightblue" stroke="black" d="M13158,-804.91C13158,-804.91 12710,-804.91 12710,-804.91 12704,-804.91 12698,-798.91 12698,-792.91 12698,-792.91 12698,-763.91 12698,-763.91 12698,-757.91 12704,-751.91 12710,-751.91 12710,-751.91 13158,-751.91 13158,-751.91 13164,-751.91 13170,-757.91 13170,-763.91 13170,-763.91 13170,-792.91 13170,-792.91 13170,-798.91 13164,-804.91 13158,-804.91"/>
<text text-anchor="middle" x="12934" y="-789.71" font-family="Times,serif" font-size="14.00">MHA Layer 15 GPU 13</text>
<text text-anchor="middle" x="12934" y="-774.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12934" y="-759.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer14_gpu13&#45;&gt;mha_layer15_gpu13 -->
<g id="edge1454" class="edge">
<title>aggregate_layer14_gpu13&#45;&gt;mha_layer15_gpu13</title>
<path fill="none" stroke="black" d="M12529.86,-854.48C12614.01,-838.85 12709.36,-821.14 12786.3,-806.84"/>
<polygon fill="black" stroke="black" points="12787.35,-810.21 12796.55,-804.94 12786.08,-803.33 12787.35,-810.21"/>
</g>
<!-- route_layer14_gpu14&#45;&gt;comm_layer14 -->
<g id="edge1407" class="edge">
<title>route_layer14_gpu14&#45;&gt;comm_layer14</title>
<path fill="none" stroke="black" d="M13495.41,-1219.75C13396.15,-1211.15 13285.49,-1202.79 13184,-1197.86 12139.78,-1147.13 8863.27,-1130.2 7925.23,-1126.33"/>
<polygon fill="black" stroke="black" points="7924.99,-1122.83 7914.98,-1126.29 7924.96,-1129.83 7924.99,-1122.83"/>
</g>
<!-- mha_layer15_gpu14 -->
<g id="node1231" class="node">
<title>mha_layer15_gpu14</title>
<path fill="lightblue" stroke="black" d="M13819,-804.91C13819,-804.91 13371,-804.91 13371,-804.91 13365,-804.91 13359,-798.91 13359,-792.91 13359,-792.91 13359,-763.91 13359,-763.91 13359,-757.91 13365,-751.91 13371,-751.91 13371,-751.91 13819,-751.91 13819,-751.91 13825,-751.91 13831,-757.91 13831,-763.91 13831,-763.91 13831,-792.91 13831,-792.91 13831,-798.91 13825,-804.91 13819,-804.91"/>
<text text-anchor="middle" x="13595" y="-789.71" font-family="Times,serif" font-size="14.00">MHA Layer 15 GPU 14</text>
<text text-anchor="middle" x="13595" y="-774.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13595" y="-759.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer14_gpu14&#45;&gt;mha_layer15_gpu14 -->
<g id="edge1455" class="edge">
<title>aggregate_layer14_gpu14&#45;&gt;mha_layer15_gpu14</title>
<path fill="none" stroke="black" d="M13428.38,-840.81C13458.52,-829.7 13489.31,-818.35 13516.09,-808.49"/>
<polygon fill="black" stroke="black" points="13517.59,-811.66 13525.76,-804.92 13515.17,-805.09 13517.59,-811.66"/>
</g>
<!-- route_layer14_gpu15&#45;&gt;comm_layer14 -->
<g id="edge1408" class="edge">
<title>route_layer14_gpu15&#45;&gt;comm_layer14</title>
<path fill="none" stroke="black" d="M14458.31,-1219.66C14358.79,-1211.05 14247.8,-1202.7 14146,-1197.86 12902.62,-1138.75 8964.7,-1127.67 7925.49,-1125.76"/>
<polygon fill="black" stroke="black" points="7925.28,-1122.26 7915.27,-1125.74 7925.27,-1129.26 7925.28,-1122.26"/>
</g>
<!-- mha_layer15_gpu15 -->
<g id="node1232" class="node">
<title>mha_layer15_gpu15</title>
<path fill="lightblue" stroke="black" d="M14394,-804.91C14394,-804.91 13946,-804.91 13946,-804.91 13940,-804.91 13934,-798.91 13934,-792.91 13934,-792.91 13934,-763.91 13934,-763.91 13934,-757.91 13940,-751.91 13946,-751.91 13946,-751.91 14394,-751.91 14394,-751.91 14400,-751.91 14406,-757.91 14406,-763.91 14406,-763.91 14406,-792.91 14406,-792.91 14406,-798.91 14400,-804.91 14394,-804.91"/>
<text text-anchor="middle" x="14170" y="-789.71" font-family="Times,serif" font-size="14.00">MHA Layer 15 GPU 15</text>
<text text-anchor="middle" x="14170" y="-774.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14170" y="-759.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
</g>
<!-- aggregate_layer14_gpu15&#45;&gt;mha_layer15_gpu15 -->
<g id="edge1456" class="edge">
<title>aggregate_layer14_gpu15&#45;&gt;mha_layer15_gpu15</title>
<path fill="none" stroke="black" d="M14132.13,-840.81C14137.84,-831.55 14143.65,-822.13 14148.95,-813.54"/>
<polygon fill="black" stroke="black" points="14151.99,-815.27 14154.26,-804.92 14146.04,-811.59 14151.99,-815.27"/>
</g>
<!-- comm_layer14&#45;&gt;expert_layer14_gpu0_expert0 -->
<g id="edge1409" class="edge">
<title>comm_layer14&#45;&gt;expert_layer14_gpu0_expert0</title>
<path fill="none" stroke="black" d="M7429.24,-1121.8C6690.08,-1116.6 4401.94,-1097.59 2506,-1050.91 2275.79,-1045.24 2013.88,-1035.76 1825.6,-1028.41"/>
<polygon fill="black" stroke="black" points="1825.69,-1024.91 1815.56,-1028.02 1825.42,-1031.9 1825.69,-1024.91"/>
</g>
<!-- comm_layer14&#45;&gt;expert_layer14_gpu1_expert1 -->
<g id="edge1410" class="edge">
<title>comm_layer14&#45;&gt;expert_layer14_gpu1_expert1</title>
<path fill="none" stroke="black" d="M7429.23,-1121.54C6786.55,-1116.15 4987.6,-1097.74 3491,-1050.91 3334.1,-1046 3158.31,-1038.11 3018.67,-1031.28"/>
<polygon fill="black" stroke="black" points="3018.84,-1027.78 3008.68,-1030.79 3018.5,-1034.77 3018.84,-1027.78"/>
</g>
<!-- comm_layer14&#45;&gt;expert_layer14_gpu2_expert2 -->
<g id="edge1411" class="edge">
<title>comm_layer14&#45;&gt;expert_layer14_gpu2_expert2</title>
<path fill="none" stroke="black" d="M7430.45,-1119.66C6898.87,-1111.08 5587.62,-1087.78 4490,-1050.91 4328.38,-1045.48 4147.06,-1037.46 4004,-1030.69"/>
<polygon fill="black" stroke="black" points="4003.92,-1027.18 3993.77,-1030.2 4003.59,-1034.17 4003.92,-1027.18"/>
</g>
<!-- comm_layer14&#45;&gt;expert_layer14_gpu3_expert3 -->
<g id="edge1412" class="edge">
<title>comm_layer14&#45;&gt;expert_layer14_gpu3_expert3</title>
<path fill="none" stroke="black" d="M7429.12,-1122.19C6970.41,-1118.7 5945.31,-1104.95 5084,-1050.91 5057.67,-1049.25 5030.21,-1047.17 5002.83,-1044.86"/>
<polygon fill="black" stroke="black" points="5003.01,-1041.36 4992.74,-1044 5002.41,-1048.34 5003.01,-1041.36"/>
</g>
<!-- comm_layer14&#45;&gt;expert_layer14_gpu4_expert4 -->
<g id="edge1413" class="edge">
<title>comm_layer14&#45;&gt;expert_layer14_gpu4_expert4</title>
<path fill="none" stroke="black" d="M7434.08,-1116.41C7080.71,-1105.53 6396.31,-1082.44 5815,-1050.91 5744.29,-1047.07 5667.72,-1042.11 5597.12,-1037.2"/>
<polygon fill="black" stroke="black" points="5596.97,-1033.68 5586.75,-1036.48 5596.48,-1040.66 5596.97,-1033.68"/>
</g>
<!-- comm_layer14&#45;&gt;expert_layer14_gpu5_expert5 -->
<g id="edge1414" class="edge">
<title>comm_layer14&#45;&gt;expert_layer14_gpu5_expert5</title>
<path fill="none" stroke="black" d="M7446.05,-1110.47C7209.6,-1096.72 6827.64,-1073.82 6498,-1050.91 6442.9,-1047.08 6383.82,-1042.69 6327.71,-1038.39"/>
<polygon fill="black" stroke="black" points="6327.87,-1034.9 6317.63,-1037.62 6327.34,-1041.88 6327.87,-1034.9"/>
</g>
<!-- comm_layer14&#45;&gt;expert_layer14_gpu6_expert6 -->
<g id="edge1415" class="edge">
<title>comm_layer14&#45;&gt;expert_layer14_gpu6_expert6</title>
<path fill="none" stroke="black" d="M7480.12,-1101.34C7343.96,-1085.69 7159.7,-1064.52 7010.87,-1047.42"/>
<polygon fill="black" stroke="black" points="7011.01,-1043.91 7000.67,-1046.25 7010.21,-1050.87 7011.01,-1043.91"/>
</g>
<!-- comm_layer14&#45;&gt;expert_layer14_gpu7_expert7 -->
<g id="edge1416" class="edge">
<title>comm_layer14&#45;&gt;expert_layer14_gpu7_expert7</title>
<path fill="none" stroke="black" d="M7570.06,-1090.3C7534.6,-1078.79 7494.65,-1065.83 7458.46,-1054.08"/>
<polygon fill="black" stroke="black" points="7459.45,-1050.72 7448.86,-1050.96 7457.29,-1057.38 7459.45,-1050.72"/>
</g>
<!-- comm_layer14&#45;&gt;expert_layer14_gpu8_expert8 -->
<g id="edge1417" class="edge">
<title>comm_layer14&#45;&gt;expert_layer14_gpu8_expert8</title>
<path fill="none" stroke="black" d="M7773.94,-1090.3C7809.4,-1078.79 7849.35,-1065.83 7885.54,-1054.08"/>
<polygon fill="black" stroke="black" points="7886.71,-1057.38 7895.14,-1050.96 7884.55,-1050.72 7886.71,-1057.38"/>
</g>
<!-- comm_layer14&#45;&gt;expert_layer14_gpu9_expert9 -->
<g id="edge1418" class="edge">
<title>comm_layer14&#45;&gt;expert_layer14_gpu9_expert9</title>
<path fill="none" stroke="black" d="M7874.26,-1103.48C8048.02,-1086.39 8299.5,-1061.64 8487.4,-1043.15"/>
<polygon fill="black" stroke="black" points="8487.81,-1046.63 8497.42,-1042.17 8487.13,-1039.66 8487.81,-1046.63"/>
</g>
<!-- comm_layer14&#45;&gt;expert_layer14_gpu10_expert10 -->
<g id="edge1419" class="edge">
<title>comm_layer14&#45;&gt;expert_layer14_gpu10_expert10</title>
<path fill="none" stroke="black" d="M7901,-1111.71C8165.53,-1098.04 8613.82,-1074.26 8999,-1050.91 9076.34,-1046.22 9160.45,-1040.75 9237.02,-1035.63"/>
<polygon fill="black" stroke="black" points="9237.55,-1039.1 9247.29,-1034.94 9237.08,-1032.12 9237.55,-1039.1"/>
</g>
<!-- comm_layer14&#45;&gt;expert_layer14_gpu11_expert11 -->
<g id="edge1420" class="edge">
<title>comm_layer14&#45;&gt;expert_layer14_gpu11_expert11</title>
<path fill="none" stroke="black" d="M7911.59,-1117.73C8298.3,-1107.99 9083.99,-1085.7 9749,-1050.91 9819.12,-1047.24 9895.04,-1042.35 9965.09,-1037.46"/>
<polygon fill="black" stroke="black" points="9965.65,-1040.93 9975.38,-1036.74 9965.16,-1033.95 9965.65,-1040.93"/>
</g>
<!-- comm_layer14&#45;&gt;expert_layer14_gpu12_expert12 -->
<g id="edge1421" class="edge">
<title>comm_layer14&#45;&gt;expert_layer14_gpu12_expert12</title>
<path fill="none" stroke="black" d="M7914.62,-1120.97C8400.97,-1115.27 9529.75,-1097.77 10477,-1050.91 10539.99,-1047.79 10607.85,-1043.38 10671.33,-1038.8"/>
<polygon fill="black" stroke="black" points="10671.76,-1042.27 10681.48,-1038.06 10671.25,-1035.29 10671.76,-1042.27"/>
</g>
<!-- comm_layer14&#45;&gt;expert_layer14_gpu13_expert13 -->
<g id="edge1422" class="edge">
<title>comm_layer14&#45;&gt;expert_layer14_gpu13_expert13</title>
<path fill="none" stroke="black" d="M7913.89,-1120.42C8483.63,-1113.01 9954.59,-1091.27 11183,-1050.91 11340.84,-1045.72 11517.74,-1037.8 11658.09,-1031.02"/>
<polygon fill="black" stroke="black" points="11658.31,-1034.52 11668.13,-1030.54 11657.98,-1027.53 11658.31,-1034.52"/>
</g>
<!-- comm_layer14&#45;&gt;expert_layer14_gpu14_expert14 -->
<g id="edge1423" class="edge">
<title>comm_layer14&#45;&gt;expert_layer14_gpu14_expert14</title>
<path fill="none" stroke="black" d="M7914.93,-1122C8589.96,-1117.6 10545.56,-1101.16 12170,-1050.91 12323.96,-1046.14 12496.3,-1038.35 12633.87,-1031.53"/>
<polygon fill="black" stroke="black" points="12634.32,-1035.01 12644.14,-1031.02 12633.97,-1028.02 12634.32,-1035.01"/>
</g>
<!-- comm_layer14&#45;&gt;expert_layer14_gpu15_expert15 -->
<g id="edge1424" class="edge">
<title>comm_layer14&#45;&gt;expert_layer14_gpu15_expert15</title>
<path fill="none" stroke="black" d="M7915.22,-1123.49C8683.22,-1123.11 11125.32,-1116.44 13146,-1050.91 13271.82,-1046.83 13411.46,-1039.89 13528.03,-1033.43"/>
<polygon fill="black" stroke="black" points="13528.37,-1036.92 13538.16,-1032.87 13527.98,-1029.93 13528.37,-1036.92"/>
</g>
<!-- gate_layer15_gpu0 -->
<g id="node1233" class="node">
<title>gate_layer15_gpu0</title>
<path fill="lightsteelblue" stroke="black" d="M461.07,-714.57C461.07,-714.57 11.93,-664.24 11.93,-664.24 5.96,-663.57 5.96,-662.24 11.93,-661.57 11.93,-661.57 461.07,-611.24 461.07,-611.24 467.04,-610.57 478.96,-610.57 484.93,-611.24 484.93,-611.24 934.07,-661.57 934.07,-661.57 940.04,-662.24 940.04,-663.57 934.07,-664.24 934.07,-664.24 484.93,-714.57 484.93,-714.57 478.96,-715.24 467.04,-715.24 461.07,-714.57"/>
<text text-anchor="middle" x="473" y="-674.21" font-family="Times,serif" font-size="14.00">Gate Layer 15 GPU 0</text>
<text text-anchor="middle" x="473" y="-659.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="473" y="-644.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer15_gpu0&#45;&gt;gate_layer15_gpu0 -->
<g id="edge1457" class="edge">
<title>mha_layer15_gpu0&#45;&gt;gate_layer15_gpu0</title>
<path fill="none" stroke="black" d="M1141.28,-751.9C1009.43,-734.54 834.54,-711.51 696.74,-693.37"/>
<polygon fill="black" stroke="black" points="696.84,-689.85 686.46,-692.01 695.92,-696.79 696.84,-689.85"/>
</g>
<!-- gate_layer15_gpu1 -->
<g id="node1234" class="node">
<title>gate_layer15_gpu1</title>
<path fill="lightsteelblue" stroke="black" d="M1425.07,-714.57C1425.07,-714.57 975.93,-664.24 975.93,-664.24 969.96,-663.57 969.96,-662.24 975.93,-661.57 975.93,-661.57 1425.07,-611.24 1425.07,-611.24 1431.04,-610.57 1442.96,-610.57 1448.93,-611.24 1448.93,-611.24 1898.07,-661.57 1898.07,-661.57 1904.04,-662.24 1904.04,-663.57 1898.07,-664.24 1898.07,-664.24 1448.93,-714.57 1448.93,-714.57 1442.96,-715.24 1431.04,-715.24 1425.07,-714.57"/>
<text text-anchor="middle" x="1437" y="-674.21" font-family="Times,serif" font-size="14.00">Gate Layer 15 GPU 1</text>
<text text-anchor="middle" x="1437" y="-659.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="1437" y="-644.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer15_gpu1&#45;&gt;gate_layer15_gpu1 -->
<g id="edge1458" class="edge">
<title>mha_layer15_gpu1&#45;&gt;gate_layer15_gpu1</title>
<path fill="none" stroke="black" d="M2159.55,-751.9C2014.08,-734.18 1820.16,-710.57 1669.84,-692.26"/>
<polygon fill="black" stroke="black" points="1669.9,-688.74 1659.55,-691.01 1669.05,-695.69 1669.9,-688.74"/>
</g>
<!-- gate_layer15_gpu2 -->
<g id="node1235" class="node">
<title>gate_layer15_gpu2</title>
<path fill="lightsteelblue" stroke="black" d="M2389.07,-714.57C2389.07,-714.57 1939.93,-664.24 1939.93,-664.24 1933.96,-663.57 1933.96,-662.24 1939.93,-661.57 1939.93,-661.57 2389.07,-611.24 2389.07,-611.24 2395.04,-610.57 2406.96,-610.57 2412.93,-611.24 2412.93,-611.24 2862.07,-661.57 2862.07,-661.57 2868.04,-662.24 2868.04,-663.57 2862.07,-664.24 2862.07,-664.24 2412.93,-714.57 2412.93,-714.57 2406.96,-715.24 2395.04,-715.24 2389.07,-714.57"/>
<text text-anchor="middle" x="2401" y="-674.21" font-family="Times,serif" font-size="14.00">Gate Layer 15 GPU 2</text>
<text text-anchor="middle" x="2401" y="-659.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="2401" y="-644.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer15_gpu2&#45;&gt;gate_layer15_gpu2 -->
<g id="edge1459" class="edge">
<title>mha_layer15_gpu2&#45;&gt;gate_layer15_gpu2</title>
<path fill="none" stroke="black" d="M2915.57,-751.86C2820.82,-735.67 2697.29,-714.55 2595,-697.07"/>
<polygon fill="black" stroke="black" points="2595.31,-693.57 2584.86,-695.33 2594.13,-700.47 2595.31,-693.57"/>
</g>
<!-- gate_layer15_gpu3 -->
<g id="node1236" class="node">
<title>gate_layer15_gpu3</title>
<path fill="lightsteelblue" stroke="black" d="M3353.07,-714.57C3353.07,-714.57 2903.93,-664.24 2903.93,-664.24 2897.96,-663.57 2897.96,-662.24 2903.93,-661.57 2903.93,-661.57 3353.07,-611.24 3353.07,-611.24 3359.04,-610.57 3370.96,-610.57 3376.93,-611.24 3376.93,-611.24 3826.07,-661.57 3826.07,-661.57 3832.04,-662.24 3832.04,-663.57 3826.07,-664.24 3826.07,-664.24 3376.93,-714.57 3376.93,-714.57 3370.96,-715.24 3359.04,-715.24 3353.07,-714.57"/>
<text text-anchor="middle" x="3365" y="-674.21" font-family="Times,serif" font-size="14.00">Gate Layer 15 GPU 3</text>
<text text-anchor="middle" x="3365" y="-659.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="3365" y="-644.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer15_gpu3&#45;&gt;gate_layer15_gpu3 -->
<g id="edge1460" class="edge">
<title>mha_layer15_gpu3&#45;&gt;gate_layer15_gpu3</title>
<path fill="none" stroke="black" d="M3634.47,-751.79C3592.93,-738.24 3540.87,-721.27 3493.62,-705.85"/>
<polygon fill="black" stroke="black" points="3494.51,-702.47 3483.92,-702.69 3492.34,-709.12 3494.51,-702.47"/>
</g>
<!-- gate_layer15_gpu4 -->
<g id="node1237" class="node">
<title>gate_layer15_gpu4</title>
<path fill="lightsteelblue" stroke="black" d="M4317.07,-714.57C4317.07,-714.57 3867.93,-664.24 3867.93,-664.24 3861.96,-663.57 3861.96,-662.24 3867.93,-661.57 3867.93,-661.57 4317.07,-611.24 4317.07,-611.24 4323.04,-610.57 4334.96,-610.57 4340.93,-611.24 4340.93,-611.24 4790.07,-661.57 4790.07,-661.57 4796.04,-662.24 4796.04,-663.57 4790.07,-664.24 4790.07,-664.24 4340.93,-714.57 4340.93,-714.57 4334.96,-715.24 4323.04,-715.24 4317.07,-714.57"/>
<text text-anchor="middle" x="4329" y="-674.21" font-family="Times,serif" font-size="14.00">Gate Layer 15 GPU 4</text>
<text text-anchor="middle" x="4329" y="-659.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="4329" y="-644.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer15_gpu4&#45;&gt;gate_layer15_gpu4 -->
<g id="edge1461" class="edge">
<title>mha_layer15_gpu4&#45;&gt;gate_layer15_gpu4</title>
<path fill="none" stroke="black" d="M4414.81,-751.65C4405.07,-741.69 4393.52,-729.88 4382.11,-718.21"/>
<polygon fill="black" stroke="black" points="4384.53,-715.69 4375.04,-710.98 4379.53,-720.58 4384.53,-715.69"/>
</g>
<!-- gate_layer15_gpu5 -->
<g id="node1238" class="node">
<title>gate_layer15_gpu5</title>
<path fill="lightsteelblue" stroke="black" d="M5281.07,-714.57C5281.07,-714.57 4831.93,-664.24 4831.93,-664.24 4825.96,-663.57 4825.96,-662.24 4831.93,-661.57 4831.93,-661.57 5281.07,-611.24 5281.07,-611.24 5287.04,-610.57 5298.96,-610.57 5304.93,-611.24 5304.93,-611.24 5754.07,-661.57 5754.07,-661.57 5760.04,-662.24 5760.04,-663.57 5754.07,-664.24 5754.07,-664.24 5304.93,-714.57 5304.93,-714.57 5298.96,-715.24 5287.04,-715.24 5281.07,-714.57"/>
<text text-anchor="middle" x="5293" y="-674.21" font-family="Times,serif" font-size="14.00">Gate Layer 15 GPU 5</text>
<text text-anchor="middle" x="5293" y="-659.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="5293" y="-644.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer15_gpu5&#45;&gt;gate_layer15_gpu5 -->
<g id="edge1462" class="edge">
<title>mha_layer15_gpu5&#45;&gt;gate_layer15_gpu5</title>
<path fill="none" stroke="black" d="M5536.92,-751.79C5500.22,-738.57 5454.47,-722.09 5412.53,-706.98"/>
<polygon fill="black" stroke="black" points="5413.68,-703.67 5403.09,-703.57 5411.31,-710.26 5413.68,-703.67"/>
</g>
<!-- gate_layer15_gpu6 -->
<g id="node1239" class="node">
<title>gate_layer15_gpu6</title>
<path fill="lightsteelblue" stroke="black" d="M6245.07,-714.57C6245.07,-714.57 5795.93,-664.24 5795.93,-664.24 5789.96,-663.57 5789.96,-662.24 5795.93,-661.57 5795.93,-661.57 6245.07,-611.24 6245.07,-611.24 6251.04,-610.57 6262.96,-610.57 6268.93,-611.24 6268.93,-611.24 6718.07,-661.57 6718.07,-661.57 6724.04,-662.24 6724.04,-663.57 6718.07,-664.24 6718.07,-664.24 6268.93,-714.57 6268.93,-714.57 6262.96,-715.24 6251.04,-715.24 6245.07,-714.57"/>
<text text-anchor="middle" x="6257" y="-674.21" font-family="Times,serif" font-size="14.00">Gate Layer 15 GPU 6</text>
<text text-anchor="middle" x="6257" y="-659.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="6257" y="-644.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer15_gpu6&#45;&gt;gate_layer15_gpu6 -->
<g id="edge1463" class="edge">
<title>mha_layer15_gpu6&#45;&gt;gate_layer15_gpu6</title>
<path fill="none" stroke="black" d="M6406.98,-751.65C6387.25,-740.11 6363.31,-726.1 6340.4,-712.7"/>
<polygon fill="black" stroke="black" points="6342.08,-709.63 6331.68,-707.6 6338.54,-715.67 6342.08,-709.63"/>
</g>
<!-- gate_layer15_gpu7 -->
<g id="node1240" class="node">
<title>gate_layer15_gpu7</title>
<path fill="lightsteelblue" stroke="black" d="M7209.07,-714.57C7209.07,-714.57 6759.93,-664.24 6759.93,-664.24 6753.96,-663.57 6753.96,-662.24 6759.93,-661.57 6759.93,-661.57 7209.07,-611.24 7209.07,-611.24 7215.04,-610.57 7226.96,-610.57 7232.93,-611.24 7232.93,-611.24 7682.07,-661.57 7682.07,-661.57 7688.04,-662.24 7688.04,-663.57 7682.07,-664.24 7682.07,-664.24 7232.93,-714.57 7232.93,-714.57 7226.96,-715.24 7215.04,-715.24 7209.07,-714.57"/>
<text text-anchor="middle" x="7221" y="-674.21" font-family="Times,serif" font-size="14.00">Gate Layer 15 GPU 7</text>
<text text-anchor="middle" x="7221" y="-659.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="7221" y="-644.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer15_gpu7&#45;&gt;gate_layer15_gpu7 -->
<g id="edge1464" class="edge">
<title>mha_layer15_gpu7&#45;&gt;gate_layer15_gpu7</title>
<path fill="none" stroke="black" d="M7229.5,-751.65C7228.74,-743.77 7227.87,-734.75 7226.97,-725.55"/>
<polygon fill="black" stroke="black" points="7230.45,-725.16 7226,-715.55 7223.49,-725.84 7230.45,-725.16"/>
</g>
<!-- gate_layer15_gpu8 -->
<g id="node1241" class="node">
<title>gate_layer15_gpu8</title>
<path fill="lightsteelblue" stroke="black" d="M8173.07,-714.57C8173.07,-714.57 7723.93,-664.24 7723.93,-664.24 7717.96,-663.57 7717.96,-662.24 7723.93,-661.57 7723.93,-661.57 8173.07,-611.24 8173.07,-611.24 8179.04,-610.57 8190.96,-610.57 8196.93,-611.24 8196.93,-611.24 8646.07,-661.57 8646.07,-661.57 8652.04,-662.24 8652.04,-663.57 8646.07,-664.24 8646.07,-664.24 8196.93,-714.57 8196.93,-714.57 8190.96,-715.24 8179.04,-715.24 8173.07,-714.57"/>
<text text-anchor="middle" x="8185" y="-674.21" font-family="Times,serif" font-size="14.00">Gate Layer 15 GPU 8</text>
<text text-anchor="middle" x="8185" y="-659.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="8185" y="-644.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer15_gpu8&#45;&gt;gate_layer15_gpu8 -->
<g id="edge1465" class="edge">
<title>mha_layer15_gpu8&#45;&gt;gate_layer15_gpu8</title>
<path fill="none" stroke="black" d="M8139.39,-751.65C8143.96,-742.85 8149.29,-732.61 8154.64,-722.3"/>
<polygon fill="black" stroke="black" points="8157.84,-723.75 8159.35,-713.26 8151.63,-720.52 8157.84,-723.75"/>
</g>
<!-- gate_layer15_gpu9 -->
<g id="node1242" class="node">
<title>gate_layer15_gpu9</title>
<path fill="lightsteelblue" stroke="black" d="M9137.07,-714.57C9137.07,-714.57 8687.93,-664.24 8687.93,-664.24 8681.96,-663.57 8681.96,-662.24 8687.93,-661.57 8687.93,-661.57 9137.07,-611.24 9137.07,-611.24 9143.04,-610.57 9154.96,-610.57 9160.93,-611.24 9160.93,-611.24 9610.07,-661.57 9610.07,-661.57 9616.04,-662.24 9616.04,-663.57 9610.07,-664.24 9610.07,-664.24 9160.93,-714.57 9160.93,-714.57 9154.96,-715.24 9143.04,-715.24 9137.07,-714.57"/>
<text text-anchor="middle" x="9149" y="-674.21" font-family="Times,serif" font-size="14.00">Gate Layer 15 GPU 9</text>
<text text-anchor="middle" x="9149" y="-659.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="9149" y="-644.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer15_gpu9&#45;&gt;gate_layer15_gpu9 -->
<g id="edge1466" class="edge">
<title>mha_layer15_gpu9&#45;&gt;gate_layer15_gpu9</title>
<path fill="none" stroke="black" d="M9144.36,-751.65C9144.77,-743.95 9145.23,-735.16 9145.71,-726.18"/>
<polygon fill="black" stroke="black" points="9149.21,-726.17 9146.25,-716 9142.22,-725.8 9149.21,-726.17"/>
</g>
<!-- gate_layer15_gpu10 -->
<g id="node1243" class="node">
<title>gate_layer15_gpu10</title>
<path fill="lightsteelblue" stroke="black" d="M10101.07,-714.57C10101.07,-714.57 9651.93,-664.24 9651.93,-664.24 9645.96,-663.57 9645.96,-662.24 9651.93,-661.57 9651.93,-661.57 10101.07,-611.24 10101.07,-611.24 10107.04,-610.57 10118.96,-610.57 10124.93,-611.24 10124.93,-611.24 10574.07,-661.57 10574.07,-661.57 10580.04,-662.24 10580.04,-663.57 10574.07,-664.24 10574.07,-664.24 10124.93,-714.57 10124.93,-714.57 10118.96,-715.24 10107.04,-715.24 10101.07,-714.57"/>
<text text-anchor="middle" x="10113" y="-674.21" font-family="Times,serif" font-size="14.00">Gate Layer 15 GPU 10</text>
<text text-anchor="middle" x="10113" y="-659.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="10113" y="-644.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer15_gpu10&#45;&gt;gate_layer15_gpu10 -->
<g id="edge1467" class="edge">
<title>mha_layer15_gpu10&#45;&gt;gate_layer15_gpu10</title>
<path fill="none" stroke="black" d="M9939.55,-751.79C9963.2,-739.81 9992.14,-725.14 10019.56,-711.25"/>
<polygon fill="black" stroke="black" points="10021.45,-714.22 10028.79,-706.57 10018.29,-707.97 10021.45,-714.22"/>
</g>
<!-- gate_layer15_gpu11 -->
<g id="node1244" class="node">
<title>gate_layer15_gpu11</title>
<path fill="lightsteelblue" stroke="black" d="M11065.07,-714.57C11065.07,-714.57 10615.93,-664.24 10615.93,-664.24 10609.96,-663.57 10609.96,-662.24 10615.93,-661.57 10615.93,-661.57 11065.07,-611.24 11065.07,-611.24 11071.04,-610.57 11082.96,-610.57 11088.93,-611.24 11088.93,-611.24 11538.07,-661.57 11538.07,-661.57 11544.04,-662.24 11544.04,-663.57 11538.07,-664.24 11538.07,-664.24 11088.93,-714.57 11088.93,-714.57 11082.96,-715.24 11071.04,-715.24 11065.07,-714.57"/>
<text text-anchor="middle" x="11077" y="-674.21" font-family="Times,serif" font-size="14.00">Gate Layer 15 GPU 11</text>
<text text-anchor="middle" x="11077" y="-659.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="11077" y="-644.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer15_gpu11&#45;&gt;gate_layer15_gpu11 -->
<g id="edge1468" class="edge">
<title>mha_layer15_gpu11&#45;&gt;gate_layer15_gpu11</title>
<path fill="none" stroke="black" d="M10635.27,-751.86C10713.35,-736.32 10814.21,-716.23 10899.83,-699.18"/>
<polygon fill="black" stroke="black" points="10900.54,-702.61 10909.66,-697.23 10899.17,-695.75 10900.54,-702.61"/>
</g>
<!-- gate_layer15_gpu12 -->
<g id="node1245" class="node">
<title>gate_layer15_gpu12</title>
<path fill="lightsteelblue" stroke="black" d="M12029.07,-714.57C12029.07,-714.57 11579.93,-664.24 11579.93,-664.24 11573.96,-663.57 11573.96,-662.24 11579.93,-661.57 11579.93,-661.57 12029.07,-611.24 12029.07,-611.24 12035.04,-610.57 12046.96,-610.57 12052.93,-611.24 12052.93,-611.24 12502.07,-661.57 12502.07,-661.57 12508.04,-662.24 12508.04,-663.57 12502.07,-664.24 12502.07,-664.24 12052.93,-714.57 12052.93,-714.57 12046.96,-715.24 12035.04,-715.24 12029.07,-714.57"/>
<text text-anchor="middle" x="12041" y="-674.21" font-family="Times,serif" font-size="14.00">Gate Layer 15 GPU 12</text>
<text text-anchor="middle" x="12041" y="-659.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="12041" y="-644.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer15_gpu12&#45;&gt;gate_layer15_gpu12 -->
<g id="edge1469" class="edge">
<title>mha_layer15_gpu12&#45;&gt;gate_layer15_gpu12</title>
<path fill="none" stroke="black" d="M11281.24,-751.9C11436.14,-733.96 11643.31,-709.97 11802.18,-691.57"/>
<polygon fill="black" stroke="black" points="11803.05,-694.99 11812.58,-690.36 11802.24,-688.04 11803.05,-694.99"/>
</g>
<!-- gate_layer15_gpu13 -->
<g id="node1246" class="node">
<title>gate_layer15_gpu13</title>
<path fill="lightsteelblue" stroke="black" d="M12993.07,-714.57C12993.07,-714.57 12543.93,-664.24 12543.93,-664.24 12537.96,-663.57 12537.96,-662.24 12543.93,-661.57 12543.93,-661.57 12993.07,-611.24 12993.07,-611.24 12999.04,-610.57 13010.96,-610.57 13016.93,-611.24 13016.93,-611.24 13466.07,-661.57 13466.07,-661.57 13472.04,-662.24 13472.04,-663.57 13466.07,-664.24 13466.07,-664.24 13016.93,-714.57 13016.93,-714.57 13010.96,-715.24 12999.04,-715.24 12993.07,-714.57"/>
<text text-anchor="middle" x="13005" y="-674.21" font-family="Times,serif" font-size="14.00">Gate Layer 15 GPU 13</text>
<text text-anchor="middle" x="13005" y="-659.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13005" y="-644.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer15_gpu13&#45;&gt;gate_layer15_gpu13 -->
<g id="edge1470" class="edge">
<title>mha_layer15_gpu13&#45;&gt;gate_layer15_gpu13</title>
<path fill="none" stroke="black" d="M12950.11,-751.65C12955.79,-742.57 12962.43,-731.96 12969.09,-721.32"/>
<polygon fill="black" stroke="black" points="12972.08,-723.14 12974.41,-712.8 12966.14,-719.42 12972.08,-723.14"/>
</g>
<!-- gate_layer15_gpu14 -->
<g id="node1247" class="node">
<title>gate_layer15_gpu14</title>
<path fill="lightsteelblue" stroke="black" d="M13957.07,-714.57C13957.07,-714.57 13507.93,-664.24 13507.93,-664.24 13501.96,-663.57 13501.96,-662.24 13507.93,-661.57 13507.93,-661.57 13957.07,-611.24 13957.07,-611.24 13963.04,-610.57 13974.96,-610.57 13980.93,-611.24 13980.93,-611.24 14430.07,-661.57 14430.07,-661.57 14436.04,-662.24 14436.04,-663.57 14430.07,-664.24 14430.07,-664.24 13980.93,-714.57 13980.93,-714.57 13974.96,-715.24 13963.04,-715.24 13957.07,-714.57"/>
<text text-anchor="middle" x="13969" y="-674.21" font-family="Times,serif" font-size="14.00">Gate Layer 15 GPU 14</text>
<text text-anchor="middle" x="13969" y="-659.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="13969" y="-644.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer15_gpu14&#45;&gt;gate_layer15_gpu14 -->
<g id="edge1471" class="edge">
<title>mha_layer15_gpu14&#45;&gt;gate_layer15_gpu14</title>
<path fill="none" stroke="black" d="M13679.4,-751.79C13725.03,-737.94 13782.48,-720.51 13834.14,-704.83"/>
<polygon fill="black" stroke="black" points="13835.17,-708.18 13843.72,-701.93 13833.14,-701.48 13835.17,-708.18"/>
</g>
<!-- gate_layer15_gpu15 -->
<g id="node1248" class="node">
<title>gate_layer15_gpu15</title>
<path fill="lightsteelblue" stroke="black" d="M14921.07,-714.57C14921.07,-714.57 14471.93,-664.24 14471.93,-664.24 14465.96,-663.57 14465.96,-662.24 14471.93,-661.57 14471.93,-661.57 14921.07,-611.24 14921.07,-611.24 14927.04,-610.57 14938.96,-610.57 14944.93,-611.24 14944.93,-611.24 15394.07,-661.57 15394.07,-661.57 15400.04,-662.24 15400.04,-663.57 15394.07,-664.24 15394.07,-664.24 14944.93,-714.57 14944.93,-714.57 14938.96,-715.24 14927.04,-715.24 14921.07,-714.57"/>
<text text-anchor="middle" x="14933" y="-674.21" font-family="Times,serif" font-size="14.00">Gate Layer 15 GPU 15</text>
<text text-anchor="middle" x="14933" y="-659.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="14933" y="-644.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_selections=2]</text>
</g>
<!-- mha_layer15_gpu15&#45;&gt;gate_layer15_gpu15 -->
<g id="edge1472" class="edge">
<title>mha_layer15_gpu15&#45;&gt;gate_layer15_gpu15</title>
<path fill="none" stroke="black" d="M14341.71,-751.86C14454.76,-735.05 14603.49,-712.92 14723.5,-695.07"/>
<polygon fill="black" stroke="black" points="14724.18,-698.51 14733.56,-693.57 14723.15,-691.58 14724.18,-698.51"/>
</g>
<!-- route_layer15_gpu0 -->
<g id="node1265" class="node">
<title>route_layer15_gpu0</title>
<path fill="orange" stroke="black" d="M959.74,-573.91C959.74,-573.91 451.24,-573.91 451.24,-573.91 445.24,-573.91 434.5,-570.23 429.75,-566.56 429.75,-566.56 311.75,-475.25 311.75,-475.25 307,-471.58 308.26,-467.91 314.26,-467.91 314.26,-467.91 822.76,-467.91 822.76,-467.91 828.76,-467.91 839.5,-471.58 844.25,-475.25 844.25,-475.25 962.25,-566.56 962.25,-566.56 967,-570.23 965.74,-573.91 959.74,-573.91"/>
<text text-anchor="middle" x="637" y="-532.21" font-family="Times,serif" font-size="14.00">Token Router Layer 15 GPU 0</text>
<text text-anchor="middle" x="637" y="-517.21" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="637" y="-502.21" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer15_gpu0&#45;&gt;route_layer15_gpu0 -->
<g id="edge1473" class="edge">
<title>gate_layer15_gpu0&#45;&gt;route_layer15_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M527.15,-615.68C540.18,-604.56 554.27,-592.53 567.87,-580.92"/>
<polygon fill="black" stroke="black" points="570.48,-583.29 575.81,-574.14 565.94,-577.97 570.48,-583.29"/>
</g>
<!-- route_layer15_gpu1 -->
<g id="node1267" class="node">
<title>route_layer15_gpu1</title>
<path fill="orange" stroke="black" d="M2475.74,-573.91C2475.74,-573.91 1967.24,-573.91 1967.24,-573.91 1961.24,-573.91 1950.5,-570.23 1945.75,-566.56 1945.75,-566.56 1827.75,-475.25 1827.75,-475.25 1823,-471.58 1824.26,-467.91 1830.26,-467.91 1830.26,-467.91 2338.76,-467.91 2338.76,-467.91 2344.76,-467.91 2355.5,-471.58 2360.25,-475.25 2360.25,-475.25 2478.25,-566.56 2478.25,-566.56 2483,-570.23 2481.74,-573.91 2475.74,-573.91"/>
<text text-anchor="middle" x="2153" y="-532.21" font-family="Times,serif" font-size="14.00">Token Router Layer 15 GPU 1</text>
<text text-anchor="middle" x="2153" y="-517.21" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="2153" y="-502.21" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer15_gpu1&#45;&gt;route_layer15_gpu1 -->
<g id="edge1474" class="edge">
<title>gate_layer15_gpu1&#45;&gt;route_layer15_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1606.23,-628.82C1703.37,-609.82 1826.47,-585.75 1931.27,-565.26"/>
<polygon fill="black" stroke="black" points="1932.21,-568.64 1941.35,-563.29 1930.87,-561.77 1932.21,-568.64"/>
</g>
<!-- route_layer15_gpu2 -->
<g id="node1269" class="node">
<title>route_layer15_gpu2</title>
<path fill="orange" stroke="black" d="M3577.74,-573.91C3577.74,-573.91 3069.24,-573.91 3069.24,-573.91 3063.24,-573.91 3052.5,-570.23 3047.75,-566.56 3047.75,-566.56 2929.75,-475.25 2929.75,-475.25 2925,-471.58 2926.26,-467.91 2932.26,-467.91 2932.26,-467.91 3440.76,-467.91 3440.76,-467.91 3446.76,-467.91 3457.5,-471.58 3462.25,-475.25 3462.25,-475.25 3580.25,-566.56 3580.25,-566.56 3585,-570.23 3583.74,-573.91 3577.74,-573.91"/>
<text text-anchor="middle" x="3255" y="-532.21" font-family="Times,serif" font-size="14.00">Token Router Layer 15 GPU 2</text>
<text text-anchor="middle" x="3255" y="-517.21" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="3255" y="-502.21" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer15_gpu2&#45;&gt;route_layer15_gpu2 -->
<g id="edge1475" class="edge">
<title>gate_layer15_gpu2&#45;&gt;route_layer15_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2589.47,-631.01C2718.14,-609.92 2889.35,-581.85 3025.9,-559.46"/>
<polygon fill="black" stroke="black" points="3026.78,-562.87 3036.08,-557.8 3025.65,-555.96 3026.78,-562.87"/>
</g>
<!-- route_layer15_gpu3 -->
<g id="node1271" class="node">
<title>route_layer15_gpu3</title>
<path fill="orange" stroke="black" d="M4472.74,-573.91C4472.74,-573.91 3964.24,-573.91 3964.24,-573.91 3958.24,-573.91 3947.5,-570.23 3942.75,-566.56 3942.75,-566.56 3824.75,-475.25 3824.75,-475.25 3820,-471.58 3821.26,-467.91 3827.26,-467.91 3827.26,-467.91 4335.76,-467.91 4335.76,-467.91 4341.76,-467.91 4352.5,-471.58 4357.25,-475.25 4357.25,-475.25 4475.25,-566.56 4475.25,-566.56 4480,-570.23 4478.74,-573.91 4472.74,-573.91"/>
<text text-anchor="middle" x="4150" y="-532.21" font-family="Times,serif" font-size="14.00">Token Router Layer 15 GPU 3</text>
<text text-anchor="middle" x="4150" y="-517.21" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="4150" y="-502.21" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer15_gpu3&#45;&gt;route_layer15_gpu3 -->
<g id="edge1476" class="edge">
<title>gate_layer15_gpu3&#45;&gt;route_layer15_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3544.11,-629.96C3657.01,-609.83 3803.74,-583.66 3924.53,-562.12"/>
<polygon fill="black" stroke="black" points="3925.42,-565.51 3934.65,-560.31 3924.2,-558.62 3925.42,-565.51"/>
</g>
<!-- route_layer15_gpu4 -->
<g id="node1273" class="node">
<title>route_layer15_gpu4</title>
<path fill="orange" stroke="black" d="M5263.74,-573.91C5263.74,-573.91 4755.24,-573.91 4755.24,-573.91 4749.24,-573.91 4738.5,-570.23 4733.75,-566.56 4733.75,-566.56 4615.75,-475.25 4615.75,-475.25 4611,-471.58 4612.26,-467.91 4618.26,-467.91 4618.26,-467.91 5126.76,-467.91 5126.76,-467.91 5132.76,-467.91 5143.5,-471.58 5148.25,-475.25 5148.25,-475.25 5266.25,-566.56 5266.25,-566.56 5271,-570.23 5269.74,-573.91 5263.74,-573.91"/>
<text text-anchor="middle" x="4941" y="-532.21" font-family="Times,serif" font-size="14.00">Token Router Layer 15 GPU 4</text>
<text text-anchor="middle" x="4941" y="-517.21" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="4941" y="-502.21" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer15_gpu4&#45;&gt;route_layer15_gpu4 -->
<g id="edge1477" class="edge">
<title>gate_layer15_gpu4&#45;&gt;route_layer15_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4481.85,-626.94C4555.85,-610.01 4645.95,-589.4 4726.66,-570.94"/>
<polygon fill="black" stroke="black" points="4727.49,-574.34 4736.46,-568.7 4725.93,-567.52 4727.49,-574.34"/>
</g>
<!-- route_layer15_gpu5 -->
<g id="node1275" class="node">
<title>route_layer15_gpu5</title>
<path fill="orange" stroke="black" d="M6003.74,-573.91C6003.74,-573.91 5495.24,-573.91 5495.24,-573.91 5489.24,-573.91 5478.5,-570.23 5473.75,-566.56 5473.75,-566.56 5355.75,-475.25 5355.75,-475.25 5351,-471.58 5352.26,-467.91 5358.26,-467.91 5358.26,-467.91 5866.76,-467.91 5866.76,-467.91 5872.76,-467.91 5883.5,-471.58 5888.25,-475.25 5888.25,-475.25 6006.25,-566.56 6006.25,-566.56 6011,-570.23 6009.74,-573.91 6003.74,-573.91"/>
<text text-anchor="middle" x="5681" y="-532.21" font-family="Times,serif" font-size="14.00">Token Router Layer 15 GPU 5</text>
<text text-anchor="middle" x="5681" y="-517.21" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="5681" y="-502.21" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer15_gpu5&#45;&gt;route_layer15_gpu5 -->
<g id="edge1478" class="edge">
<title>gate_layer15_gpu5&#45;&gt;route_layer15_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5403.15,-622.16C5441.7,-608.25 5485.73,-592.36 5527.2,-577.4"/>
<polygon fill="black" stroke="black" points="5528.62,-580.61 5536.84,-573.92 5526.24,-574.03 5528.62,-580.61"/>
</g>
<!-- route_layer15_gpu6 -->
<g id="node1277" class="node">
<title>route_layer15_gpu6</title>
<path fill="orange" stroke="black" d="M6717.74,-573.91C6717.74,-573.91 6209.24,-573.91 6209.24,-573.91 6203.24,-573.91 6192.5,-570.23 6187.75,-566.56 6187.75,-566.56 6069.75,-475.25 6069.75,-475.25 6065,-471.58 6066.26,-467.91 6072.26,-467.91 6072.26,-467.91 6580.76,-467.91 6580.76,-467.91 6586.76,-467.91 6597.5,-471.58 6602.25,-475.25 6602.25,-475.25 6720.25,-566.56 6720.25,-566.56 6725,-570.23 6723.74,-573.91 6717.74,-573.91"/>
<text text-anchor="middle" x="6395" y="-532.21" font-family="Times,serif" font-size="14.00">Token Router Layer 15 GPU 6</text>
<text text-anchor="middle" x="6395" y="-517.21" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="6395" y="-502.21" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer15_gpu6&#45;&gt;route_layer15_gpu6 -->
<g id="edge1479" class="edge">
<title>gate_layer15_gpu6&#45;&gt;route_layer15_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6303.34,-614.9C6313.87,-604.21 6325.2,-592.72 6336.17,-581.59"/>
<polygon fill="black" stroke="black" points="6338.8,-583.91 6343.32,-574.33 6333.81,-579 6338.8,-583.91"/>
</g>
<!-- route_layer15_gpu7 -->
<g id="node1279" class="node">
<title>route_layer15_gpu7</title>
<path fill="orange" stroke="black" d="M7612.74,-573.91C7612.74,-573.91 7104.24,-573.91 7104.24,-573.91 7098.24,-573.91 7087.5,-570.23 7082.75,-566.56 7082.75,-566.56 6964.75,-475.25 6964.75,-475.25 6960,-471.58 6961.26,-467.91 6967.26,-467.91 6967.26,-467.91 7475.76,-467.91 7475.76,-467.91 7481.76,-467.91 7492.5,-471.58 7497.25,-475.25 7497.25,-475.25 7615.25,-566.56 7615.25,-566.56 7620,-570.23 7618.74,-573.91 7612.74,-573.91"/>
<text text-anchor="middle" x="7290" y="-532.21" font-family="Times,serif" font-size="14.00">Token Router Layer 15 GPU 7</text>
<text text-anchor="middle" x="7290" y="-517.21" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="7290" y="-502.21" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer15_gpu7&#45;&gt;route_layer15_gpu7 -->
<g id="edge1480" class="edge">
<title>gate_layer15_gpu7&#45;&gt;route_layer15_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7245.33,-612.55C7249.97,-603.12 7254.89,-593.15 7259.69,-583.4"/>
<polygon fill="black" stroke="black" points="7262.97,-584.66 7264.26,-574.14 7256.7,-581.56 7262.97,-584.66"/>
</g>
<!-- route_layer15_gpu8 -->
<g id="node1281" class="node">
<title>route_layer15_gpu8</title>
<path fill="orange" stroke="black" d="M8438.74,-573.91C8438.74,-573.91 7930.24,-573.91 7930.24,-573.91 7924.24,-573.91 7913.5,-570.23 7908.75,-566.56 7908.75,-566.56 7790.75,-475.25 7790.75,-475.25 7786,-471.58 7787.26,-467.91 7793.26,-467.91 7793.26,-467.91 8301.76,-467.91 8301.76,-467.91 8307.76,-467.91 8318.5,-471.58 8323.25,-475.25 8323.25,-475.25 8441.25,-566.56 8441.25,-566.56 8446,-570.23 8444.74,-573.91 8438.74,-573.91"/>
<text text-anchor="middle" x="8116" y="-532.21" font-family="Times,serif" font-size="14.00">Token Router Layer 15 GPU 8</text>
<text text-anchor="middle" x="8116" y="-517.21" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="8116" y="-502.21" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer15_gpu8&#45;&gt;route_layer15_gpu8 -->
<g id="edge1481" class="edge">
<title>gate_layer15_gpu8&#45;&gt;route_layer15_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8160.67,-612.55C8156.03,-603.12 8151.11,-593.15 8146.31,-583.4"/>
<polygon fill="black" stroke="black" points="8149.3,-581.56 8141.74,-574.14 8143.03,-584.66 8149.3,-581.56"/>
</g>
<!-- route_layer15_gpu9 -->
<g id="node1283" class="node">
<title>route_layer15_gpu9</title>
<path fill="orange" stroke="black" d="M9333.74,-573.91C9333.74,-573.91 8825.24,-573.91 8825.24,-573.91 8819.24,-573.91 8808.5,-570.23 8803.75,-566.56 8803.75,-566.56 8685.75,-475.25 8685.75,-475.25 8681,-471.58 8682.26,-467.91 8688.26,-467.91 8688.26,-467.91 9196.76,-467.91 9196.76,-467.91 9202.76,-467.91 9213.5,-471.58 9218.25,-475.25 9218.25,-475.25 9336.25,-566.56 9336.25,-566.56 9341,-570.23 9339.74,-573.91 9333.74,-573.91"/>
<text text-anchor="middle" x="9011" y="-532.21" font-family="Times,serif" font-size="14.00">Token Router Layer 15 GPU 9</text>
<text text-anchor="middle" x="9011" y="-517.21" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="9011" y="-502.21" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer15_gpu9&#45;&gt;route_layer15_gpu9 -->
<g id="edge1482" class="edge">
<title>gate_layer15_gpu9&#45;&gt;route_layer15_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9102.66,-614.9C9092.13,-604.21 9080.8,-592.72 9069.83,-581.59"/>
<polygon fill="black" stroke="black" points="9072.19,-579 9062.68,-574.33 9067.2,-583.91 9072.19,-579"/>
</g>
<!-- route_layer15_gpu10 -->
<g id="node1285" class="node">
<title>route_layer15_gpu10</title>
<path fill="orange" stroke="black" d="M10262.74,-573.91C10262.74,-573.91 9754.24,-573.91 9754.24,-573.91 9748.24,-573.91 9737.5,-570.23 9732.75,-566.56 9732.75,-566.56 9614.75,-475.25 9614.75,-475.25 9610,-471.58 9611.26,-467.91 9617.26,-467.91 9617.26,-467.91 10125.76,-467.91 10125.76,-467.91 10131.76,-467.91 10142.5,-471.58 10147.25,-475.25 10147.25,-475.25 10265.25,-566.56 10265.25,-566.56 10270,-570.23 10268.74,-573.91 10262.74,-573.91"/>
<text text-anchor="middle" x="9940" y="-532.21" font-family="Times,serif" font-size="14.00">Token Router Layer 15 GPU 10</text>
<text text-anchor="middle" x="9940" y="-517.21" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="9940" y="-502.21" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer15_gpu10&#45;&gt;route_layer15_gpu10 -->
<g id="edge1483" class="edge">
<title>gate_layer15_gpu10&#45;&gt;route_layer15_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10056.35,-616.07C10042.3,-604.69 10027.05,-592.35 10012.36,-580.47"/>
<polygon fill="black" stroke="black" points="10014.24,-577.49 10004.27,-573.92 10009.84,-582.93 10014.24,-577.49"/>
</g>
<!-- route_layer15_gpu11 -->
<g id="node1287" class="node">
<title>route_layer15_gpu11</title>
<path fill="orange" stroke="black" d="M11209.74,-573.91C11209.74,-573.91 10701.24,-573.91 10701.24,-573.91 10695.24,-573.91 10684.5,-570.23 10679.75,-566.56 10679.75,-566.56 10561.75,-475.25 10561.75,-475.25 10557,-471.58 10558.26,-467.91 10564.26,-467.91 10564.26,-467.91 11072.76,-467.91 11072.76,-467.91 11078.76,-467.91 11089.5,-471.58 11094.25,-475.25 11094.25,-475.25 11212.25,-566.56 11212.25,-566.56 11217,-570.23 11215.74,-573.91 11209.74,-573.91"/>
<text text-anchor="middle" x="10887" y="-532.21" font-family="Times,serif" font-size="14.00">Token Router Layer 15 GPU 11</text>
<text text-anchor="middle" x="10887" y="-517.21" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="10887" y="-502.21" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer15_gpu11&#45;&gt;route_layer15_gpu11 -->
<g id="edge1484" class="edge">
<title>gate_layer15_gpu11&#45;&gt;route_layer15_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11015.57,-616.65C10999.74,-604.97 10982.47,-592.25 10965.87,-580.02"/>
<polygon fill="black" stroke="black" points="10967.92,-577.18 10957.79,-574.07 10963.77,-582.82 10967.92,-577.18"/>
</g>
<!-- route_layer15_gpu12 -->
<g id="node1289" class="node">
<title>route_layer15_gpu12</title>
<path fill="orange" stroke="black" d="M12164.74,-573.91C12164.74,-573.91 11656.24,-573.91 11656.24,-573.91 11650.24,-573.91 11639.5,-570.23 11634.75,-566.56 11634.75,-566.56 11516.75,-475.25 11516.75,-475.25 11512,-471.58 11513.26,-467.91 11519.26,-467.91 11519.26,-467.91 12027.76,-467.91 12027.76,-467.91 12033.76,-467.91 12044.5,-471.58 12049.25,-475.25 12049.25,-475.25 12167.25,-566.56 12167.25,-566.56 12172,-570.23 12170.74,-573.91 12164.74,-573.91"/>
<text text-anchor="middle" x="11842" y="-532.21" font-family="Times,serif" font-size="14.00">Token Router Layer 15 GPU 12</text>
<text text-anchor="middle" x="11842" y="-517.21" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="11842" y="-502.21" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer15_gpu12&#45;&gt;route_layer15_gpu12 -->
<g id="edge1485" class="edge">
<title>gate_layer15_gpu12&#45;&gt;route_layer15_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11977.21,-617.03C11960.51,-605.28 11942.25,-592.44 11924.71,-580.1"/>
<polygon fill="black" stroke="black" points="11926.36,-576.98 11916.17,-574.09 11922.34,-582.7 11926.36,-576.98"/>
</g>
<!-- route_layer15_gpu13 -->
<g id="node1291" class="node">
<title>route_layer15_gpu13</title>
<path fill="orange" stroke="black" d="M13124.74,-573.91C13124.74,-573.91 12616.24,-573.91 12616.24,-573.91 12610.24,-573.91 12599.5,-570.23 12594.75,-566.56 12594.75,-566.56 12476.75,-475.25 12476.75,-475.25 12472,-471.58 12473.26,-467.91 12479.26,-467.91 12479.26,-467.91 12987.76,-467.91 12987.76,-467.91 12993.76,-467.91 13004.5,-471.58 13009.25,-475.25 13009.25,-475.25 13127.25,-566.56 13127.25,-566.56 13132,-570.23 13130.74,-573.91 13124.74,-573.91"/>
<text text-anchor="middle" x="12802" y="-532.21" font-family="Times,serif" font-size="14.00">Token Router Layer 15 GPU 13</text>
<text text-anchor="middle" x="12802" y="-517.21" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="12802" y="-502.21" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer15_gpu13&#45;&gt;route_layer15_gpu13 -->
<g id="edge1486" class="edge">
<title>gate_layer15_gpu13&#45;&gt;route_layer15_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12939.93,-617.03C12922.89,-605.28 12904.27,-592.44 12886.38,-580.1"/>
<polygon fill="black" stroke="black" points="12887.88,-576.88 12877.66,-574.09 12883.91,-582.65 12887.88,-576.88"/>
</g>
<!-- route_layer15_gpu14 -->
<g id="node1293" class="node">
<title>route_layer15_gpu14</title>
<path fill="orange" stroke="black" d="M14086.74,-573.91C14086.74,-573.91 13578.24,-573.91 13578.24,-573.91 13572.24,-573.91 13561.5,-570.23 13556.75,-566.56 13556.75,-566.56 13438.75,-475.25 13438.75,-475.25 13434,-471.58 13435.26,-467.91 13441.26,-467.91 13441.26,-467.91 13949.76,-467.91 13949.76,-467.91 13955.76,-467.91 13966.5,-471.58 13971.25,-475.25 13971.25,-475.25 14089.25,-566.56 14089.25,-566.56 14094,-570.23 14092.74,-573.91 14086.74,-573.91"/>
<text text-anchor="middle" x="13764" y="-532.21" font-family="Times,serif" font-size="14.00">Token Router Layer 15 GPU 14</text>
<text text-anchor="middle" x="13764" y="-517.21" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="13764" y="-502.21" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer15_gpu14&#45;&gt;route_layer15_gpu14 -->
<g id="edge1487" class="edge">
<title>gate_layer15_gpu14&#45;&gt;route_layer15_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13903.57,-617.22C13886.1,-605.29 13866.96,-592.22 13848.61,-579.69"/>
<polygon fill="black" stroke="black" points="13850.47,-576.72 13840.24,-573.97 13846.52,-582.5 13850.47,-576.72"/>
</g>
<!-- route_layer15_gpu15 -->
<g id="node1295" class="node">
<title>route_layer15_gpu15</title>
<path fill="orange" stroke="black" d="M15049.74,-573.91C15049.74,-573.91 14541.24,-573.91 14541.24,-573.91 14535.24,-573.91 14524.5,-570.23 14519.75,-566.56 14519.75,-566.56 14401.75,-475.25 14401.75,-475.25 14397,-471.58 14398.26,-467.91 14404.26,-467.91 14404.26,-467.91 14912.76,-467.91 14912.76,-467.91 14918.76,-467.91 14929.5,-471.58 14934.25,-475.25 14934.25,-475.25 15052.25,-566.56 15052.25,-566.56 15057,-570.23 15055.74,-573.91 15049.74,-573.91"/>
<text text-anchor="middle" x="14727" y="-532.21" font-family="Times,serif" font-size="14.00">Token Router Layer 15 GPU 15</text>
<text text-anchor="middle" x="14727" y="-517.21" font-family="Times,serif" font-size="14.00">Input: Tokens with routing decisions</text>
<text text-anchor="middle" x="14727" y="-502.21" font-family="Times,serif" font-size="14.00">Output: Tokens sent to destination experts</text>
</g>
<!-- gate_layer15_gpu15&#45;&gt;route_layer15_gpu15 -->
<g id="edge1488" class="edge">
<title>gate_layer15_gpu15&#45;&gt;route_layer15_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14867.25,-617.22C14849.69,-605.29 14830.46,-592.22 14812.02,-579.69"/>
<polygon fill="black" stroke="black" points="14813.85,-576.7 14803.61,-573.97 14809.91,-582.49 14813.85,-576.7"/>
</g>
<!-- expert_layer15_gpu0_expert0 -->
<g id="node1249" class="node">
<title>expert_layer15_gpu0_expert0</title>
<path fill="lightcoral" stroke="black" d="M3001.5,-320.95C3001.5,-320.95 2532.5,-320.95 2532.5,-320.95 2526.5,-320.95 2520.5,-314.95 2520.5,-308.95 2520.5,-308.95 2520.5,-264.95 2520.5,-264.95 2520.5,-258.95 2526.5,-252.95 2532.5,-252.95 2532.5,-252.95 3001.5,-252.95 3001.5,-252.95 3007.5,-252.95 3013.5,-258.95 3013.5,-264.95 3013.5,-264.95 3013.5,-308.95 3013.5,-308.95 3013.5,-314.95 3007.5,-320.95 3001.5,-320.95"/>
<text text-anchor="middle" x="2767" y="-305.75" font-family="Times,serif" font-size="14.00">Expert 0 Layer 15 GPU 0</text>
<text text-anchor="middle" x="2767" y="-290.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2767" y="-275.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="2767" y="-260.75" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer15_gpu0 -->
<g id="node1266" class="node">
<title>aggregate_layer15_gpu0</title>
<path fill="orange" stroke="black" d="M2986.29,-216.95C2986.29,-216.95 2499.19,-216.95 2499.19,-216.95 2493.19,-216.95 2482.52,-213.19 2477.85,-209.42 2477.85,-209.42 2365.06,-118.49 2365.06,-118.49 2360.38,-114.72 2361.71,-110.95 2367.71,-110.95 2367.71,-110.95 2854.81,-110.95 2854.81,-110.95 2860.81,-110.95 2871.48,-114.72 2876.15,-118.49 2876.15,-118.49 2988.94,-209.42 2988.94,-209.42 2993.62,-213.19 2992.29,-216.95 2986.29,-216.95"/>
<text text-anchor="middle" x="2677" y="-175.25" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 15 GPU 0</text>
<text text-anchor="middle" x="2677" y="-160.25" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="2677" y="-145.25" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer15_gpu0_expert0&#45;&gt;aggregate_layer15_gpu0 -->
<g id="edge1521" class="edge">
<title>expert_layer15_gpu0_expert0&#45;&gt;aggregate_layer15_gpu0</title>
<path fill="none" stroke="black" d="M2742.41,-252.89C2736.05,-244.34 2729,-234.86 2721.95,-225.38"/>
<polygon fill="black" stroke="black" points="2724.55,-223.02 2715.77,-217.08 2718.93,-227.19 2724.55,-223.02"/>
</g>
<!-- expert_layer15_gpu1_expert1 -->
<g id="node1250" class="node">
<title>expert_layer15_gpu1_expert1</title>
<path fill="lightcoral" stroke="black" d="M3962.5,-320.95C3962.5,-320.95 3493.5,-320.95 3493.5,-320.95 3487.5,-320.95 3481.5,-314.95 3481.5,-308.95 3481.5,-308.95 3481.5,-264.95 3481.5,-264.95 3481.5,-258.95 3487.5,-252.95 3493.5,-252.95 3493.5,-252.95 3962.5,-252.95 3962.5,-252.95 3968.5,-252.95 3974.5,-258.95 3974.5,-264.95 3974.5,-264.95 3974.5,-308.95 3974.5,-308.95 3974.5,-314.95 3968.5,-320.95 3962.5,-320.95"/>
<text text-anchor="middle" x="3728" y="-305.75" font-family="Times,serif" font-size="14.00">Expert 1 Layer 15 GPU 1</text>
<text text-anchor="middle" x="3728" y="-290.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3728" y="-275.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="3728" y="-260.75" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer15_gpu1 -->
<g id="node1268" class="node">
<title>aggregate_layer15_gpu1</title>
<path fill="orange" stroke="black" d="M3647.29,-216.95C3647.29,-216.95 3160.19,-216.95 3160.19,-216.95 3154.19,-216.95 3143.52,-213.19 3138.85,-209.42 3138.85,-209.42 3026.06,-118.49 3026.06,-118.49 3021.38,-114.72 3022.71,-110.95 3028.71,-110.95 3028.71,-110.95 3515.81,-110.95 3515.81,-110.95 3521.81,-110.95 3532.48,-114.72 3537.15,-118.49 3537.15,-118.49 3649.94,-209.42 3649.94,-209.42 3654.62,-213.19 3653.29,-216.95 3647.29,-216.95"/>
<text text-anchor="middle" x="3338" y="-175.25" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 15 GPU 1</text>
<text text-anchor="middle" x="3338" y="-160.25" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="3338" y="-145.25" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer15_gpu1_expert1&#45;&gt;aggregate_layer15_gpu1 -->
<g id="edge1522" class="edge">
<title>expert_layer15_gpu1_expert1&#45;&gt;aggregate_layer15_gpu1</title>
<path fill="none" stroke="black" d="M3621.43,-252.89C3588.62,-242.71 3551.56,-231.21 3515.33,-219.97"/>
<polygon fill="black" stroke="black" points="3516.23,-216.59 3505.64,-216.96 3514.15,-223.27 3516.23,-216.59"/>
</g>
<!-- expert_layer15_gpu2_expert2 -->
<g id="node1251" class="node">
<title>expert_layer15_gpu2_expert2</title>
<path fill="lightcoral" stroke="black" d="M4698.5,-320.95C4698.5,-320.95 4229.5,-320.95 4229.5,-320.95 4223.5,-320.95 4217.5,-314.95 4217.5,-308.95 4217.5,-308.95 4217.5,-264.95 4217.5,-264.95 4217.5,-258.95 4223.5,-252.95 4229.5,-252.95 4229.5,-252.95 4698.5,-252.95 4698.5,-252.95 4704.5,-252.95 4710.5,-258.95 4710.5,-264.95 4710.5,-264.95 4710.5,-308.95 4710.5,-308.95 4710.5,-314.95 4704.5,-320.95 4698.5,-320.95"/>
<text text-anchor="middle" x="4464" y="-305.75" font-family="Times,serif" font-size="14.00">Expert 2 Layer 15 GPU 2</text>
<text text-anchor="middle" x="4464" y="-290.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4464" y="-275.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="4464" y="-260.75" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer15_gpu2 -->
<g id="node1270" class="node">
<title>aggregate_layer15_gpu2</title>
<path fill="orange" stroke="black" d="M4308.29,-216.95C4308.29,-216.95 3821.19,-216.95 3821.19,-216.95 3815.19,-216.95 3804.52,-213.19 3799.85,-209.42 3799.85,-209.42 3687.06,-118.49 3687.06,-118.49 3682.38,-114.72 3683.71,-110.95 3689.71,-110.95 3689.71,-110.95 4176.81,-110.95 4176.81,-110.95 4182.81,-110.95 4193.48,-114.72 4198.15,-118.49 4198.15,-118.49 4310.94,-209.42 4310.94,-209.42 4315.62,-213.19 4314.29,-216.95 4308.29,-216.95"/>
<text text-anchor="middle" x="3999" y="-175.25" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 15 GPU 2</text>
<text text-anchor="middle" x="3999" y="-160.25" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="3999" y="-145.25" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer15_gpu2_expert2&#45;&gt;aggregate_layer15_gpu2 -->
<g id="edge1523" class="edge">
<title>expert_layer15_gpu2_expert2&#45;&gt;aggregate_layer15_gpu2</title>
<path fill="none" stroke="black" d="M4336.94,-252.89C4297.31,-242.58 4252.5,-230.92 4208.78,-219.54"/>
<polygon fill="black" stroke="black" points="4209.44,-216.1 4198.88,-216.96 4207.68,-222.87 4209.44,-216.1"/>
</g>
<!-- expert_layer15_gpu3_expert3 -->
<g id="node1252" class="node">
<title>expert_layer15_gpu3_expert3</title>
<path fill="lightcoral" stroke="black" d="M5321.5,-320.95C5321.5,-320.95 4852.5,-320.95 4852.5,-320.95 4846.5,-320.95 4840.5,-314.95 4840.5,-308.95 4840.5,-308.95 4840.5,-264.95 4840.5,-264.95 4840.5,-258.95 4846.5,-252.95 4852.5,-252.95 4852.5,-252.95 5321.5,-252.95 5321.5,-252.95 5327.5,-252.95 5333.5,-258.95 5333.5,-264.95 5333.5,-264.95 5333.5,-308.95 5333.5,-308.95 5333.5,-314.95 5327.5,-320.95 5321.5,-320.95"/>
<text text-anchor="middle" x="5087" y="-305.75" font-family="Times,serif" font-size="14.00">Expert 3 Layer 15 GPU 3</text>
<text text-anchor="middle" x="5087" y="-290.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5087" y="-275.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5087" y="-260.75" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer15_gpu3 -->
<g id="node1272" class="node">
<title>aggregate_layer15_gpu3</title>
<path fill="orange" stroke="black" d="M4969.29,-216.95C4969.29,-216.95 4482.19,-216.95 4482.19,-216.95 4476.19,-216.95 4465.52,-213.19 4460.85,-209.42 4460.85,-209.42 4348.06,-118.49 4348.06,-118.49 4343.38,-114.72 4344.71,-110.95 4350.71,-110.95 4350.71,-110.95 4837.81,-110.95 4837.81,-110.95 4843.81,-110.95 4854.48,-114.72 4859.15,-118.49 4859.15,-118.49 4971.94,-209.42 4971.94,-209.42 4976.62,-213.19 4975.29,-216.95 4969.29,-216.95"/>
<text text-anchor="middle" x="4660" y="-175.25" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 15 GPU 3</text>
<text text-anchor="middle" x="4660" y="-160.25" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="4660" y="-145.25" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer15_gpu3_expert3&#45;&gt;aggregate_layer15_gpu3 -->
<g id="edge1524" class="edge">
<title>expert_layer15_gpu3_expert3&#45;&gt;aggregate_layer15_gpu3</title>
<path fill="none" stroke="black" d="M4970.32,-252.89C4934.16,-242.64 4893.31,-231.07 4853.4,-219.76"/>
<polygon fill="black" stroke="black" points="4854.12,-216.32 4843.55,-216.96 4852.21,-223.06 4854.12,-216.32"/>
</g>
<!-- expert_layer15_gpu4_expert4 -->
<g id="node1253" class="node">
<title>expert_layer15_gpu4_expert4</title>
<path fill="lightcoral" stroke="black" d="M5888.5,-320.95C5888.5,-320.95 5419.5,-320.95 5419.5,-320.95 5413.5,-320.95 5407.5,-314.95 5407.5,-308.95 5407.5,-308.95 5407.5,-264.95 5407.5,-264.95 5407.5,-258.95 5413.5,-252.95 5419.5,-252.95 5419.5,-252.95 5888.5,-252.95 5888.5,-252.95 5894.5,-252.95 5900.5,-258.95 5900.5,-264.95 5900.5,-264.95 5900.5,-308.95 5900.5,-308.95 5900.5,-314.95 5894.5,-320.95 5888.5,-320.95"/>
<text text-anchor="middle" x="5654" y="-305.75" font-family="Times,serif" font-size="14.00">Expert 4 Layer 15 GPU 4</text>
<text text-anchor="middle" x="5654" y="-290.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5654" y="-275.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="5654" y="-260.75" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer15_gpu4 -->
<g id="node1274" class="node">
<title>aggregate_layer15_gpu4</title>
<path fill="orange" stroke="black" d="M5630.29,-216.95C5630.29,-216.95 5143.19,-216.95 5143.19,-216.95 5137.19,-216.95 5126.52,-213.19 5121.85,-209.42 5121.85,-209.42 5009.06,-118.49 5009.06,-118.49 5004.38,-114.72 5005.71,-110.95 5011.71,-110.95 5011.71,-110.95 5498.81,-110.95 5498.81,-110.95 5504.81,-110.95 5515.48,-114.72 5520.15,-118.49 5520.15,-118.49 5632.94,-209.42 5632.94,-209.42 5637.62,-213.19 5636.29,-216.95 5630.29,-216.95"/>
<text text-anchor="middle" x="5321" y="-175.25" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 15 GPU 4</text>
<text text-anchor="middle" x="5321" y="-160.25" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="5321" y="-145.25" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer15_gpu4_expert4&#45;&gt;aggregate_layer15_gpu4 -->
<g id="edge1525" class="edge">
<title>expert_layer15_gpu4_expert4&#45;&gt;aggregate_layer15_gpu4</title>
<path fill="none" stroke="black" d="M5563.01,-252.89C5535.35,-242.84 5504.16,-231.51 5473.6,-220.4"/>
<polygon fill="black" stroke="black" points="5474.73,-217.09 5464.14,-216.96 5472.34,-223.67 5474.73,-217.09"/>
</g>
<!-- expert_layer15_gpu5_expert5 -->
<g id="node1254" class="node">
<title>expert_layer15_gpu5_expert5</title>
<path fill="lightcoral" stroke="black" d="M6427.5,-320.95C6427.5,-320.95 5958.5,-320.95 5958.5,-320.95 5952.5,-320.95 5946.5,-314.95 5946.5,-308.95 5946.5,-308.95 5946.5,-264.95 5946.5,-264.95 5946.5,-258.95 5952.5,-252.95 5958.5,-252.95 5958.5,-252.95 6427.5,-252.95 6427.5,-252.95 6433.5,-252.95 6439.5,-258.95 6439.5,-264.95 6439.5,-264.95 6439.5,-308.95 6439.5,-308.95 6439.5,-314.95 6433.5,-320.95 6427.5,-320.95"/>
<text text-anchor="middle" x="6193" y="-305.75" font-family="Times,serif" font-size="14.00">Expert 5 Layer 15 GPU 5</text>
<text text-anchor="middle" x="6193" y="-290.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6193" y="-275.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6193" y="-260.75" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer15_gpu5 -->
<g id="node1276" class="node">
<title>aggregate_layer15_gpu5</title>
<path fill="orange" stroke="black" d="M6291.29,-216.95C6291.29,-216.95 5804.19,-216.95 5804.19,-216.95 5798.19,-216.95 5787.52,-213.19 5782.85,-209.42 5782.85,-209.42 5670.06,-118.49 5670.06,-118.49 5665.38,-114.72 5666.71,-110.95 5672.71,-110.95 5672.71,-110.95 6159.81,-110.95 6159.81,-110.95 6165.81,-110.95 6176.48,-114.72 6181.15,-118.49 6181.15,-118.49 6293.94,-209.42 6293.94,-209.42 6298.62,-213.19 6297.29,-216.95 6291.29,-216.95"/>
<text text-anchor="middle" x="5982" y="-175.25" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 15 GPU 5</text>
<text text-anchor="middle" x="5982" y="-160.25" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="5982" y="-145.25" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer15_gpu5_expert5&#45;&gt;aggregate_layer15_gpu5 -->
<g id="edge1526" class="edge">
<title>expert_layer15_gpu5_expert5&#45;&gt;aggregate_layer15_gpu5</title>
<path fill="none" stroke="black" d="M6135.34,-252.89C6118.7,-243.35 6100.04,-232.65 6081.62,-222.08"/>
<polygon fill="black" stroke="black" points="6083.32,-219.02 6072.9,-217.08 6079.83,-225.09 6083.32,-219.02"/>
</g>
<!-- expert_layer15_gpu6_expert6 -->
<g id="node1255" class="node">
<title>expert_layer15_gpu6_expert6</title>
<path fill="lightcoral" stroke="black" d="M6952.5,-320.95C6952.5,-320.95 6483.5,-320.95 6483.5,-320.95 6477.5,-320.95 6471.5,-314.95 6471.5,-308.95 6471.5,-308.95 6471.5,-264.95 6471.5,-264.95 6471.5,-258.95 6477.5,-252.95 6483.5,-252.95 6483.5,-252.95 6952.5,-252.95 6952.5,-252.95 6958.5,-252.95 6964.5,-258.95 6964.5,-264.95 6964.5,-264.95 6964.5,-308.95 6964.5,-308.95 6964.5,-314.95 6958.5,-320.95 6952.5,-320.95"/>
<text text-anchor="middle" x="6718" y="-305.75" font-family="Times,serif" font-size="14.00">Expert 6 Layer 15 GPU 6</text>
<text text-anchor="middle" x="6718" y="-290.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6718" y="-275.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="6718" y="-260.75" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer15_gpu6 -->
<g id="node1278" class="node">
<title>aggregate_layer15_gpu6</title>
<path fill="orange" stroke="black" d="M6952.29,-216.95C6952.29,-216.95 6465.19,-216.95 6465.19,-216.95 6459.19,-216.95 6448.52,-213.19 6443.85,-209.42 6443.85,-209.42 6331.06,-118.49 6331.06,-118.49 6326.38,-114.72 6327.71,-110.95 6333.71,-110.95 6333.71,-110.95 6820.81,-110.95 6820.81,-110.95 6826.81,-110.95 6837.48,-114.72 6842.15,-118.49 6842.15,-118.49 6954.94,-209.42 6954.94,-209.42 6959.62,-213.19 6958.29,-216.95 6952.29,-216.95"/>
<text text-anchor="middle" x="6643" y="-175.25" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 15 GPU 6</text>
<text text-anchor="middle" x="6643" y="-160.25" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="6643" y="-145.25" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer15_gpu6_expert6&#45;&gt;aggregate_layer15_gpu6 -->
<g id="edge1527" class="edge">
<title>expert_layer15_gpu6_expert6&#45;&gt;aggregate_layer15_gpu6</title>
<path fill="none" stroke="black" d="M6697.51,-252.89C6692.26,-244.43 6686.45,-235.05 6680.63,-225.67"/>
<polygon fill="black" stroke="black" points="6683.55,-223.74 6675.31,-217.08 6677.6,-227.42 6683.55,-223.74"/>
</g>
<!-- expert_layer15_gpu7_expert7 -->
<g id="node1256" class="node">
<title>expert_layer15_gpu7_expert7</title>
<path fill="lightcoral" stroke="black" d="M7575.5,-320.95C7575.5,-320.95 7106.5,-320.95 7106.5,-320.95 7100.5,-320.95 7094.5,-314.95 7094.5,-308.95 7094.5,-308.95 7094.5,-264.95 7094.5,-264.95 7094.5,-258.95 7100.5,-252.95 7106.5,-252.95 7106.5,-252.95 7575.5,-252.95 7575.5,-252.95 7581.5,-252.95 7587.5,-258.95 7587.5,-264.95 7587.5,-264.95 7587.5,-308.95 7587.5,-308.95 7587.5,-314.95 7581.5,-320.95 7575.5,-320.95"/>
<text text-anchor="middle" x="7341" y="-305.75" font-family="Times,serif" font-size="14.00">Expert 7 Layer 15 GPU 7</text>
<text text-anchor="middle" x="7341" y="-290.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7341" y="-275.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7341" y="-260.75" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer15_gpu7 -->
<g id="node1280" class="node">
<title>aggregate_layer15_gpu7</title>
<path fill="orange" stroke="black" d="M7613.29,-216.95C7613.29,-216.95 7126.19,-216.95 7126.19,-216.95 7120.19,-216.95 7109.52,-213.19 7104.85,-209.42 7104.85,-209.42 6992.06,-118.49 6992.06,-118.49 6987.38,-114.72 6988.71,-110.95 6994.71,-110.95 6994.71,-110.95 7481.81,-110.95 7481.81,-110.95 7487.81,-110.95 7498.48,-114.72 7503.15,-118.49 7503.15,-118.49 7615.94,-209.42 7615.94,-209.42 7620.62,-213.19 7619.29,-216.95 7613.29,-216.95"/>
<text text-anchor="middle" x="7304" y="-175.25" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 15 GPU 7</text>
<text text-anchor="middle" x="7304" y="-160.25" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="7304" y="-145.25" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer15_gpu7_expert7&#45;&gt;aggregate_layer15_gpu7 -->
<g id="edge1528" class="edge">
<title>expert_layer15_gpu7_expert7&#45;&gt;aggregate_layer15_gpu7</title>
<path fill="none" stroke="black" d="M7330.89,-252.89C7328.41,-244.77 7325.67,-235.82 7322.92,-226.82"/>
<polygon fill="black" stroke="black" points="7326.21,-225.62 7319.94,-217.08 7319.52,-227.67 7326.21,-225.62"/>
</g>
<!-- expert_layer15_gpu8_expert8 -->
<g id="node1257" class="node">
<title>expert_layer15_gpu8_expert8</title>
<path fill="lightcoral" stroke="black" d="M8161.5,-320.95C8161.5,-320.95 7692.5,-320.95 7692.5,-320.95 7686.5,-320.95 7680.5,-314.95 7680.5,-308.95 7680.5,-308.95 7680.5,-264.95 7680.5,-264.95 7680.5,-258.95 7686.5,-252.95 7692.5,-252.95 7692.5,-252.95 8161.5,-252.95 8161.5,-252.95 8167.5,-252.95 8173.5,-258.95 8173.5,-264.95 8173.5,-264.95 8173.5,-308.95 8173.5,-308.95 8173.5,-314.95 8167.5,-320.95 8161.5,-320.95"/>
<text text-anchor="middle" x="7927" y="-305.75" font-family="Times,serif" font-size="14.00">Expert 8 Layer 15 GPU 8</text>
<text text-anchor="middle" x="7927" y="-290.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7927" y="-275.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="7927" y="-260.75" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer15_gpu8 -->
<g id="node1282" class="node">
<title>aggregate_layer15_gpu8</title>
<path fill="orange" stroke="black" d="M8274.29,-216.95C8274.29,-216.95 7787.19,-216.95 7787.19,-216.95 7781.19,-216.95 7770.52,-213.19 7765.85,-209.42 7765.85,-209.42 7653.06,-118.49 7653.06,-118.49 7648.38,-114.72 7649.71,-110.95 7655.71,-110.95 7655.71,-110.95 8142.81,-110.95 8142.81,-110.95 8148.81,-110.95 8159.48,-114.72 8164.15,-118.49 8164.15,-118.49 8276.94,-209.42 8276.94,-209.42 8281.62,-213.19 8280.29,-216.95 8274.29,-216.95"/>
<text text-anchor="middle" x="7965" y="-175.25" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 15 GPU 8</text>
<text text-anchor="middle" x="7965" y="-160.25" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="7965" y="-145.25" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer15_gpu8_expert8&#45;&gt;aggregate_layer15_gpu8 -->
<g id="edge1529" class="edge">
<title>expert_layer15_gpu8_expert8&#45;&gt;aggregate_layer15_gpu8</title>
<path fill="none" stroke="black" d="M7937.38,-252.89C7939.93,-244.77 7942.75,-235.82 7945.57,-226.82"/>
<polygon fill="black" stroke="black" points="7948.97,-227.67 7948.63,-217.08 7942.29,-225.57 7948.97,-227.67"/>
</g>
<!-- expert_layer15_gpu9_expert9 -->
<g id="node1258" class="node">
<title>expert_layer15_gpu9_expert9</title>
<path fill="lightcoral" stroke="black" d="M8784.5,-320.95C8784.5,-320.95 8315.5,-320.95 8315.5,-320.95 8309.5,-320.95 8303.5,-314.95 8303.5,-308.95 8303.5,-308.95 8303.5,-264.95 8303.5,-264.95 8303.5,-258.95 8309.5,-252.95 8315.5,-252.95 8315.5,-252.95 8784.5,-252.95 8784.5,-252.95 8790.5,-252.95 8796.5,-258.95 8796.5,-264.95 8796.5,-264.95 8796.5,-308.95 8796.5,-308.95 8796.5,-314.95 8790.5,-320.95 8784.5,-320.95"/>
<text text-anchor="middle" x="8550" y="-305.75" font-family="Times,serif" font-size="14.00">Expert 9 Layer 15 GPU 9</text>
<text text-anchor="middle" x="8550" y="-290.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8550" y="-275.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="8550" y="-260.75" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer15_gpu9 -->
<g id="node1284" class="node">
<title>aggregate_layer15_gpu9</title>
<path fill="orange" stroke="black" d="M8935.29,-216.95C8935.29,-216.95 8448.19,-216.95 8448.19,-216.95 8442.19,-216.95 8431.52,-213.19 8426.85,-209.42 8426.85,-209.42 8314.06,-118.49 8314.06,-118.49 8309.38,-114.72 8310.71,-110.95 8316.71,-110.95 8316.71,-110.95 8803.81,-110.95 8803.81,-110.95 8809.81,-110.95 8820.48,-114.72 8825.15,-118.49 8825.15,-118.49 8937.94,-209.42 8937.94,-209.42 8942.62,-213.19 8941.29,-216.95 8935.29,-216.95"/>
<text text-anchor="middle" x="8626" y="-175.25" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 15 GPU 9</text>
<text text-anchor="middle" x="8626" y="-160.25" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="8626" y="-145.25" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer15_gpu9_expert9&#45;&gt;aggregate_layer15_gpu9 -->
<g id="edge1530" class="edge">
<title>expert_layer15_gpu9_expert9&#45;&gt;aggregate_layer15_gpu9</title>
<path fill="none" stroke="black" d="M8570.77,-252.89C8576.08,-244.43 8581.97,-235.05 8587.86,-225.67"/>
<polygon fill="black" stroke="black" points="8590.9,-227.41 8593.26,-217.08 8584.98,-223.69 8590.9,-227.41"/>
</g>
<!-- expert_layer15_gpu10_expert10 -->
<g id="node1259" class="node">
<title>expert_layer15_gpu10_expert10</title>
<path fill="lightcoral" stroke="black" d="M9426.5,-320.95C9426.5,-320.95 8957.5,-320.95 8957.5,-320.95 8951.5,-320.95 8945.5,-314.95 8945.5,-308.95 8945.5,-308.95 8945.5,-264.95 8945.5,-264.95 8945.5,-258.95 8951.5,-252.95 8957.5,-252.95 8957.5,-252.95 9426.5,-252.95 9426.5,-252.95 9432.5,-252.95 9438.5,-258.95 9438.5,-264.95 9438.5,-264.95 9438.5,-308.95 9438.5,-308.95 9438.5,-314.95 9432.5,-320.95 9426.5,-320.95"/>
<text text-anchor="middle" x="9192" y="-305.75" font-family="Times,serif" font-size="14.00">Expert 10 Layer 15 GPU 10</text>
<text text-anchor="middle" x="9192" y="-290.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9192" y="-275.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9192" y="-260.75" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer15_gpu10 -->
<g id="node1286" class="node">
<title>aggregate_layer15_gpu10</title>
<path fill="orange" stroke="black" d="M9596.29,-216.95C9596.29,-216.95 9109.19,-216.95 9109.19,-216.95 9103.19,-216.95 9092.52,-213.19 9087.85,-209.42 9087.85,-209.42 8975.06,-118.49 8975.06,-118.49 8970.38,-114.72 8971.71,-110.95 8977.71,-110.95 8977.71,-110.95 9464.81,-110.95 9464.81,-110.95 9470.81,-110.95 9481.48,-114.72 9486.15,-118.49 9486.15,-118.49 9598.94,-209.42 9598.94,-209.42 9603.62,-213.19 9602.29,-216.95 9596.29,-216.95"/>
<text text-anchor="middle" x="9287" y="-175.25" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 15 GPU 10</text>
<text text-anchor="middle" x="9287" y="-160.25" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="9287" y="-145.25" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer15_gpu10_expert10&#45;&gt;aggregate_layer15_gpu10 -->
<g id="edge1531" class="edge">
<title>expert_layer15_gpu10_expert10&#45;&gt;aggregate_layer15_gpu10</title>
<path fill="none" stroke="black" d="M9217.96,-252.89C9224.74,-244.25 9232.26,-234.67 9239.78,-225.1"/>
<polygon fill="black" stroke="black" points="9242.65,-227.11 9246.07,-217.08 9237.15,-222.78 9242.65,-227.11"/>
</g>
<!-- expert_layer15_gpu11_expert11 -->
<g id="node1260" class="node">
<title>expert_layer15_gpu11_expert11</title>
<path fill="lightcoral" stroke="black" d="M10078.5,-320.95C10078.5,-320.95 9609.5,-320.95 9609.5,-320.95 9603.5,-320.95 9597.5,-314.95 9597.5,-308.95 9597.5,-308.95 9597.5,-264.95 9597.5,-264.95 9597.5,-258.95 9603.5,-252.95 9609.5,-252.95 9609.5,-252.95 10078.5,-252.95 10078.5,-252.95 10084.5,-252.95 10090.5,-258.95 10090.5,-264.95 10090.5,-264.95 10090.5,-308.95 10090.5,-308.95 10090.5,-314.95 10084.5,-320.95 10078.5,-320.95"/>
<text text-anchor="middle" x="9844" y="-305.75" font-family="Times,serif" font-size="14.00">Expert 11 Layer 15 GPU 11</text>
<text text-anchor="middle" x="9844" y="-290.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9844" y="-275.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="9844" y="-260.75" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer15_gpu11 -->
<g id="node1288" class="node">
<title>aggregate_layer15_gpu11</title>
<path fill="orange" stroke="black" d="M10257.29,-216.95C10257.29,-216.95 9770.19,-216.95 9770.19,-216.95 9764.19,-216.95 9753.52,-213.19 9748.85,-209.42 9748.85,-209.42 9636.06,-118.49 9636.06,-118.49 9631.38,-114.72 9632.71,-110.95 9638.71,-110.95 9638.71,-110.95 10125.81,-110.95 10125.81,-110.95 10131.81,-110.95 10142.48,-114.72 10147.15,-118.49 10147.15,-118.49 10259.94,-209.42 10259.94,-209.42 10264.62,-213.19 10263.29,-216.95 10257.29,-216.95"/>
<text text-anchor="middle" x="9948" y="-175.25" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 15 GPU 11</text>
<text text-anchor="middle" x="9948" y="-160.25" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="9948" y="-145.25" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer15_gpu11_expert11&#45;&gt;aggregate_layer15_gpu11 -->
<g id="edge1532" class="edge">
<title>expert_layer15_gpu11_expert11&#45;&gt;aggregate_layer15_gpu11</title>
<path fill="none" stroke="black" d="M9872.42,-252.89C9879.92,-244.17 9888.24,-234.48 9896.55,-224.81"/>
<polygon fill="black" stroke="black" points="9899.33,-226.95 9903.2,-217.08 9894.02,-222.38 9899.33,-226.95"/>
</g>
<!-- expert_layer15_gpu12_expert12 -->
<g id="node1261" class="node">
<title>expert_layer15_gpu12_expert12</title>
<path fill="lightcoral" stroke="black" d="M10734.5,-320.95C10734.5,-320.95 10265.5,-320.95 10265.5,-320.95 10259.5,-320.95 10253.5,-314.95 10253.5,-308.95 10253.5,-308.95 10253.5,-264.95 10253.5,-264.95 10253.5,-258.95 10259.5,-252.95 10265.5,-252.95 10265.5,-252.95 10734.5,-252.95 10734.5,-252.95 10740.5,-252.95 10746.5,-258.95 10746.5,-264.95 10746.5,-264.95 10746.5,-308.95 10746.5,-308.95 10746.5,-314.95 10740.5,-320.95 10734.5,-320.95"/>
<text text-anchor="middle" x="10500" y="-305.75" font-family="Times,serif" font-size="14.00">Expert 12 Layer 15 GPU 12</text>
<text text-anchor="middle" x="10500" y="-290.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10500" y="-275.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="10500" y="-260.75" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer15_gpu12 -->
<g id="node1290" class="node">
<title>aggregate_layer15_gpu12</title>
<path fill="orange" stroke="black" d="M10918.29,-216.95C10918.29,-216.95 10431.19,-216.95 10431.19,-216.95 10425.19,-216.95 10414.52,-213.19 10409.85,-209.42 10409.85,-209.42 10297.06,-118.49 10297.06,-118.49 10292.38,-114.72 10293.71,-110.95 10299.71,-110.95 10299.71,-110.95 10786.81,-110.95 10786.81,-110.95 10792.81,-110.95 10803.48,-114.72 10808.15,-118.49 10808.15,-118.49 10920.94,-209.42 10920.94,-209.42 10925.62,-213.19 10924.29,-216.95 10918.29,-216.95"/>
<text text-anchor="middle" x="10609" y="-175.25" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 15 GPU 12</text>
<text text-anchor="middle" x="10609" y="-160.25" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="10609" y="-145.25" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer15_gpu12_expert12&#45;&gt;aggregate_layer15_gpu12 -->
<g id="edge1533" class="edge">
<title>expert_layer15_gpu12_expert12&#45;&gt;aggregate_layer15_gpu12</title>
<path fill="none" stroke="black" d="M10529.78,-252.89C10537.72,-244.08 10546.54,-234.28 10555.34,-224.52"/>
<polygon fill="black" stroke="black" points="10557.95,-226.85 10562.04,-217.08 10552.75,-222.17 10557.95,-226.85"/>
</g>
<!-- expert_layer15_gpu13_expert13 -->
<g id="node1262" class="node">
<title>expert_layer15_gpu13_expert13</title>
<path fill="lightcoral" stroke="black" d="M11393.5,-320.95C11393.5,-320.95 10924.5,-320.95 10924.5,-320.95 10918.5,-320.95 10912.5,-314.95 10912.5,-308.95 10912.5,-308.95 10912.5,-264.95 10912.5,-264.95 10912.5,-258.95 10918.5,-252.95 10924.5,-252.95 10924.5,-252.95 11393.5,-252.95 11393.5,-252.95 11399.5,-252.95 11405.5,-258.95 11405.5,-264.95 11405.5,-264.95 11405.5,-308.95 11405.5,-308.95 11405.5,-314.95 11399.5,-320.95 11393.5,-320.95"/>
<text text-anchor="middle" x="11159" y="-305.75" font-family="Times,serif" font-size="14.00">Expert 13 Layer 15 GPU 13</text>
<text text-anchor="middle" x="11159" y="-290.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11159" y="-275.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11159" y="-260.75" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer15_gpu13 -->
<g id="node1292" class="node">
<title>aggregate_layer15_gpu13</title>
<path fill="orange" stroke="black" d="M11579.29,-216.95C11579.29,-216.95 11092.19,-216.95 11092.19,-216.95 11086.19,-216.95 11075.52,-213.19 11070.85,-209.42 11070.85,-209.42 10958.06,-118.49 10958.06,-118.49 10953.38,-114.72 10954.71,-110.95 10960.71,-110.95 10960.71,-110.95 11447.81,-110.95 11447.81,-110.95 11453.81,-110.95 11464.48,-114.72 11469.15,-118.49 11469.15,-118.49 11581.94,-209.42 11581.94,-209.42 11586.62,-213.19 11585.29,-216.95 11579.29,-216.95"/>
<text text-anchor="middle" x="11270" y="-175.25" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 15 GPU 13</text>
<text text-anchor="middle" x="11270" y="-160.25" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="11270" y="-145.25" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer15_gpu13_expert13&#45;&gt;aggregate_layer15_gpu13 -->
<g id="edge1534" class="edge">
<title>expert_layer15_gpu13_expert13&#45;&gt;aggregate_layer15_gpu13</title>
<path fill="none" stroke="black" d="M11189.33,-252.89C11197.41,-244.08 11206.4,-234.28 11215.35,-224.52"/>
<polygon fill="black" stroke="black" points="11218,-226.82 11222.18,-217.08 11212.84,-222.08 11218,-226.82"/>
</g>
<!-- expert_layer15_gpu14_expert14 -->
<g id="node1263" class="node">
<title>expert_layer15_gpu14_expert14</title>
<path fill="lightcoral" stroke="black" d="M12053.5,-320.95C12053.5,-320.95 11584.5,-320.95 11584.5,-320.95 11578.5,-320.95 11572.5,-314.95 11572.5,-308.95 11572.5,-308.95 11572.5,-264.95 11572.5,-264.95 11572.5,-258.95 11578.5,-252.95 11584.5,-252.95 11584.5,-252.95 12053.5,-252.95 12053.5,-252.95 12059.5,-252.95 12065.5,-258.95 12065.5,-264.95 12065.5,-264.95 12065.5,-308.95 12065.5,-308.95 12065.5,-314.95 12059.5,-320.95 12053.5,-320.95"/>
<text text-anchor="middle" x="11819" y="-305.75" font-family="Times,serif" font-size="14.00">Expert 14 Layer 15 GPU 14</text>
<text text-anchor="middle" x="11819" y="-290.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11819" y="-275.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="11819" y="-260.75" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer15_gpu14 -->
<g id="node1294" class="node">
<title>aggregate_layer15_gpu14</title>
<path fill="orange" stroke="black" d="M12240.29,-216.95C12240.29,-216.95 11753.19,-216.95 11753.19,-216.95 11747.19,-216.95 11736.52,-213.19 11731.85,-209.42 11731.85,-209.42 11619.06,-118.49 11619.06,-118.49 11614.38,-114.72 11615.71,-110.95 11621.71,-110.95 11621.71,-110.95 12108.81,-110.95 12108.81,-110.95 12114.81,-110.95 12125.48,-114.72 12130.15,-118.49 12130.15,-118.49 12242.94,-209.42 12242.94,-209.42 12247.62,-213.19 12246.29,-216.95 12240.29,-216.95"/>
<text text-anchor="middle" x="11931" y="-175.25" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 15 GPU 14</text>
<text text-anchor="middle" x="11931" y="-160.25" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="11931" y="-145.25" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer15_gpu14_expert14&#45;&gt;aggregate_layer15_gpu14 -->
<g id="edge1535" class="edge">
<title>expert_layer15_gpu14_expert14&#45;&gt;aggregate_layer15_gpu14</title>
<path fill="none" stroke="black" d="M11849.6,-252.89C11857.76,-244.08 11866.83,-234.28 11875.86,-224.52"/>
<polygon fill="black" stroke="black" points="11878.53,-226.8 11882.75,-217.08 11873.39,-222.04 11878.53,-226.8"/>
</g>
<!-- expert_layer15_gpu15_expert15 -->
<g id="node1264" class="node">
<title>expert_layer15_gpu15_expert15</title>
<path fill="lightcoral" stroke="black" d="M12713.5,-320.95C12713.5,-320.95 12244.5,-320.95 12244.5,-320.95 12238.5,-320.95 12232.5,-314.95 12232.5,-308.95 12232.5,-308.95 12232.5,-264.95 12232.5,-264.95 12232.5,-258.95 12238.5,-252.95 12244.5,-252.95 12244.5,-252.95 12713.5,-252.95 12713.5,-252.95 12719.5,-252.95 12725.5,-258.95 12725.5,-264.95 12725.5,-264.95 12725.5,-308.95 12725.5,-308.95 12725.5,-314.95 12719.5,-320.95 12713.5,-320.95"/>
<text text-anchor="middle" x="12479" y="-305.75" font-family="Times,serif" font-size="14.00">Expert 15 Layer 15 GPU 15</text>
<text text-anchor="middle" x="12479" y="-290.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12479" y="-275.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, token_dim=4096]</text>
<text text-anchor="middle" x="12479" y="-260.75" font-family="Times,serif" font-size="14.00">MLP: 4096&#45;&gt;16384akey=4096</text>
</g>
<!-- aggregate_layer15_gpu15 -->
<g id="node1296" class="node">
<title>aggregate_layer15_gpu15</title>
<path fill="orange" stroke="black" d="M12901.29,-216.95C12901.29,-216.95 12414.19,-216.95 12414.19,-216.95 12408.19,-216.95 12397.52,-213.19 12392.85,-209.42 12392.85,-209.42 12280.06,-118.49 12280.06,-118.49 12275.38,-114.72 12276.71,-110.95 12282.71,-110.95 12282.71,-110.95 12769.81,-110.95 12769.81,-110.95 12775.81,-110.95 12786.48,-114.72 12791.15,-118.49 12791.15,-118.49 12903.94,-209.42 12903.94,-209.42 12908.62,-213.19 12907.29,-216.95 12901.29,-216.95"/>
<text text-anchor="middle" x="12592" y="-175.25" font-family="Times,serif" font-size="14.00">Token Aggregator Layer 15 GPU 15</text>
<text text-anchor="middle" x="12592" y="-160.25" font-family="Times,serif" font-size="14.00">Input: Processed tokens from all experts</text>
<text text-anchor="middle" x="12592" y="-145.25" font-family="Times,serif" font-size="14.00">Output: Combined token representations</text>
</g>
<!-- expert_layer15_gpu15_expert15&#45;&gt;aggregate_layer15_gpu15 -->
<g id="edge1536" class="edge">
<title>expert_layer15_gpu15_expert15&#45;&gt;aggregate_layer15_gpu15</title>
<path fill="none" stroke="black" d="M12509.88,-252.89C12518.11,-244.08 12527.25,-234.28 12536.37,-224.52"/>
<polygon fill="black" stroke="black" points="12539.05,-226.78 12543.32,-217.08 12533.94,-222 12539.05,-226.78"/>
</g>
<!-- comm_layer15 -->
<g id="node1297" class="node">
<title>comm_layer15</title>
<ellipse fill="lightpink" stroke="black" cx="7634" cy="-394.43" rx="243.49" ry="37.45"/>
<text text-anchor="middle" x="7634" y="-405.73" font-family="Times,serif" font-size="14.00">Cross&#45;GPU Communication Layer 15</text>
<text text-anchor="middle" x="7634" y="-390.73" font-family="Times,serif" font-size="14.00">Input: Tokens from routing decisions</text>
<text text-anchor="middle" x="7634" y="-375.73" font-family="Times,serif" font-size="14.00">Output: Tokens delivered to destination GPUs</text>
</g>
<!-- route_layer15_gpu0&#45;&gt;comm_layer15 -->
<g id="edge1489" class="edge">
<title>route_layer15_gpu0&#45;&gt;comm_layer15</title>
<path fill="none" stroke="black" d="M884.99,-506.61C1122.15,-494.43 1489.87,-476.97 1809,-467.91 3964.41,-406.7 6569.91,-397.17 7380.78,-395.7"/>
<polygon fill="black" stroke="black" points="7380.83,-399.2 7390.83,-395.68 7380.82,-392.2 7380.83,-399.2"/>
</g>
<!-- output -->
<g id="node1298" class="node">
<title>output</title>
<ellipse fill="lightgray" stroke="black" cx="7634" cy="-37.48" rx="317.48" ry="37.45"/>
<text text-anchor="middle" x="7634" y="-48.78" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="7634" y="-33.78" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, token_dim=4096]</text>
<text text-anchor="middle" x="7634" y="-18.78" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, token_dim=4096]</text>
</g>
<!-- aggregate_layer15_gpu0&#45;&gt;output -->
<g id="edge1537" class="edge">
<title>aggregate_layer15_gpu0&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2885.25,-125.69C2925.84,-119.71 2968.15,-114.38 3008,-110.95 3432,-74.51 6324.34,-48.73 7307.61,-40.94"/>
<polygon fill="black" stroke="black" points="7307.69,-44.44 7317.66,-40.86 7307.63,-37.44 7307.69,-44.44"/>
</g>
<!-- route_layer15_gpu1&#45;&gt;comm_layer15 -->
<g id="edge1490" class="edge">
<title>route_layer15_gpu1&#45;&gt;comm_layer15</title>
<path fill="none" stroke="black" d="M2392.64,-500.2C2541.69,-488.75 2737.37,-475.19 2911,-467.91 3793.22,-430.9 6533.28,-404.87 7381.27,-397.53"/>
<polygon fill="black" stroke="black" points="7381.5,-401.03 7391.47,-397.44 7381.44,-394.03 7381.5,-401.03"/>
</g>
<!-- aggregate_layer15_gpu1&#45;&gt;output -->
<g id="edge1538" class="edge">
<title>aggregate_layer15_gpu1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3546.26,-125.77C3586.85,-119.79 3629.16,-114.43 3669,-110.95 4371.45,-49.65 6488.23,-40.05 7306.33,-38.66"/>
<polygon fill="black" stroke="black" points="7306.49,-42.16 7316.49,-38.64 7306.48,-35.16 7306.49,-42.16"/>
</g>
<!-- route_layer15_gpu2&#45;&gt;comm_layer15 -->
<g id="edge1491" class="edge">
<title>route_layer15_gpu2&#45;&gt;comm_layer15</title>
<path fill="none" stroke="black" d="M3486.95,-494.11C3585.23,-484.2 3701.08,-473.84 3806,-467.91 4504.75,-428.38 6644.13,-404.84 7381.26,-397.73"/>
<polygon fill="black" stroke="black" points="7381.51,-401.23 7391.47,-397.63 7381.44,-394.23 7381.51,-401.23"/>
</g>
<!-- aggregate_layer15_gpu2&#45;&gt;output -->
<g id="edge1539" class="edge">
<title>aggregate_layer15_gpu2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M4207.71,-125.82C4248.16,-119.86 4290.31,-114.49 4330,-110.95 4900.36,-60.13 6589.98,-44.5 7306.69,-40.08"/>
<polygon fill="black" stroke="black" points="7306.93,-43.58 7316.91,-40.02 7306.89,-36.58 7306.93,-43.58"/>
</g>
<!-- route_layer15_gpu3&#45;&gt;comm_layer15 -->
<g id="edge1492" class="edge">
<title>route_layer15_gpu3&#45;&gt;comm_layer15</title>
<path fill="none" stroke="black" d="M4375.88,-489.54C4446.55,-481.14 4524.91,-472.95 4597,-467.91 5135.5,-430.24 6754.71,-406.47 7381.95,-398.46"/>
<polygon fill="black" stroke="black" points="7382.07,-401.96 7392.02,-398.33 7381.98,-394.96 7382.07,-401.96"/>
</g>
<!-- aggregate_layer15_gpu3&#45;&gt;output -->
<g id="edge1540" class="edge">
<title>aggregate_layer15_gpu3&#45;&gt;output</title>
<path fill="none" stroke="black" d="M4868.73,-126C4909.18,-120.02 4951.32,-114.6 4991,-110.95 5431.12,-70.52 6704.61,-49.9 7308.68,-42.17"/>
<polygon fill="black" stroke="black" points="7308.89,-45.67 7318.85,-42.04 7308.81,-38.67 7308.89,-45.67"/>
</g>
<!-- route_layer15_gpu4&#45;&gt;comm_layer15 -->
<g id="edge1493" class="edge">
<title>route_layer15_gpu4&#45;&gt;comm_layer15</title>
<path fill="none" stroke="black" d="M5163.37,-486.77C5219.89,-479.44 5280.59,-472.49 5337,-467.91 6077.62,-407.74 6956.32,-396.76 7380.23,-395.24"/>
<polygon fill="black" stroke="black" points="7380.48,-398.74 7390.47,-395.2 7380.46,-391.74 7380.48,-398.74"/>
</g>
<!-- aggregate_layer15_gpu4&#45;&gt;output -->
<g id="edge1541" class="edge">
<title>aggregate_layer15_gpu4&#45;&gt;output</title>
<path fill="none" stroke="black" d="M5530.2,-126.22C5570.51,-120.24 5612.48,-114.77 5652,-110.95 6232.65,-54.93 6912.79,-41.31 7306.45,-38.51"/>
<polygon fill="black" stroke="black" points="7306.59,-42.01 7316.56,-38.44 7306.54,-35.01 7306.59,-42.01"/>
</g>
<!-- route_layer15_gpu5&#45;&gt;comm_layer15 -->
<g id="edge1494" class="edge">
<title>route_layer15_gpu5&#45;&gt;comm_layer15</title>
<path fill="none" stroke="black" d="M5901.69,-485.43C5950.74,-478.74 6002.56,-472.41 6051,-467.91 6520.15,-424.3 7070.07,-406.6 7382.72,-399.66"/>
<polygon fill="black" stroke="black" points="7382.9,-403.16 7392.82,-399.44 7382.74,-396.16 7382.9,-403.16"/>
</g>
<!-- aggregate_layer15_gpu5&#45;&gt;output -->
<g id="edge1542" class="edge">
<title>aggregate_layer15_gpu5&#45;&gt;output</title>
<path fill="none" stroke="black" d="M6191.7,-126.74C6231.87,-120.73 6273.66,-115.11 6313,-110.95 6654.37,-74.87 7047.38,-56.21 7315.4,-46.94"/>
<polygon fill="black" stroke="black" points="7315.8,-50.43 7325.67,-46.58 7315.56,-43.43 7315.8,-50.43"/>
</g>
<!-- route_layer15_gpu6&#45;&gt;comm_layer15 -->
<g id="edge1495" class="edge">
<title>route_layer15_gpu6&#45;&gt;comm_layer15</title>
<path fill="none" stroke="black" d="M6629.87,-496.31C6858.44,-473.35 7202.62,-438.77 7422.78,-416.65"/>
<polygon fill="black" stroke="black" points="7423.24,-420.12 7432.84,-415.64 7422.54,-413.16 7423.24,-420.12"/>
</g>
<!-- aggregate_layer15_gpu6&#45;&gt;output -->
<g id="edge1543" class="edge">
<title>aggregate_layer15_gpu6&#45;&gt;output</title>
<path fill="none" stroke="black" d="M6854.68,-128.2C6894.29,-122.12 6935.37,-116.11 6974,-110.95 7109.3,-92.91 7260.65,-76.05 7384.25,-63.14"/>
<polygon fill="black" stroke="black" points="7384.65,-66.62 7394.23,-62.1 7383.93,-59.65 7384.65,-66.62"/>
</g>
<!-- route_layer15_gpu7&#45;&gt;comm_layer15 -->
<g id="edge1496" class="edge">
<title>route_layer15_gpu7&#45;&gt;comm_layer15</title>
<path fill="none" stroke="black" d="M7433.89,-467.84C7466.54,-456.03 7500.57,-443.71 7531.12,-432.66"/>
<polygon fill="black" stroke="black" points="7532.69,-435.81 7540.91,-429.12 7530.31,-429.23 7532.69,-435.81"/>
</g>
<!-- aggregate_layer15_gpu7&#45;&gt;output -->
<g id="edge1544" class="edge">
<title>aggregate_layer15_gpu7&#45;&gt;output</title>
<path fill="none" stroke="black" d="M7442.04,-110.89C7472.19,-99.51 7503.57,-87.67 7532.01,-76.95"/>
<polygon fill="black" stroke="black" points="7533.42,-80.16 7541.54,-73.35 7530.95,-73.61 7533.42,-80.16"/>
</g>
<!-- route_layer15_gpu8&#45;&gt;comm_layer15 -->
<g id="edge1497" class="edge">
<title>route_layer15_gpu8&#45;&gt;comm_layer15</title>
<path fill="none" stroke="black" d="M7914.38,-467.84C7864.27,-454.9 7811.83,-441.35 7766.03,-429.53"/>
<polygon fill="black" stroke="black" points="7766.62,-426.06 7756.06,-426.95 7764.87,-432.84 7766.62,-426.06"/>
</g>
<!-- aggregate_layer15_gpu8&#45;&gt;output -->
<g id="edge1545" class="edge">
<title>aggregate_layer15_gpu8&#45;&gt;output</title>
<path fill="none" stroke="black" d="M7826.54,-110.89C7796.3,-99.51 7764.82,-87.67 7736.29,-76.95"/>
<polygon fill="black" stroke="black" points="7737.33,-73.6 7726.74,-73.35 7734.87,-80.15 7737.33,-73.6"/>
</g>
<!-- route_layer15_gpu9&#45;&gt;comm_layer15 -->
<g id="edge1498" class="edge">
<title>route_layer15_gpu9&#45;&gt;comm_layer15</title>
<path fill="none" stroke="black" d="M8705.73,-490.74C8625.78,-483.2 8539.66,-475.16 8460,-467.91 8254.63,-449.21 8020.46,-428.74 7854.03,-414.34"/>
<polygon fill="black" stroke="black" points="7853.93,-410.82 7843.67,-413.44 7853.33,-417.79 7853.93,-410.82"/>
</g>
<!-- aggregate_layer15_gpu9&#45;&gt;output -->
<g id="edge1546" class="edge">
<title>aggregate_layer15_gpu9&#45;&gt;output</title>
<path fill="none" stroke="black" d="M8306.31,-112.48C8302.52,-111.96 8298.75,-111.45 8295,-110.95 8159.49,-92.89 8007.91,-76.03 7884.12,-63.12"/>
<polygon fill="black" stroke="black" points="7884.44,-59.64 7874.13,-62.09 7883.71,-66.6 7884.44,-59.64"/>
</g>
<!-- route_layer15_gpu10&#45;&gt;comm_layer15 -->
<g id="edge1499" class="edge">
<title>route_layer15_gpu10&#45;&gt;comm_layer15</title>
<path fill="none" stroke="black" d="M9633.56,-489.96C9543.85,-481.93 9445.55,-473.83 9355,-467.91 8831.68,-433.65 8217.71,-412.31 7882.88,-402.27"/>
<polygon fill="black" stroke="black" points="7882.67,-398.77 7872.57,-401.97 7882.46,-405.76 7882.67,-398.77"/>
</g>
<!-- aggregate_layer15_gpu10&#45;&gt;output -->
<g id="edge1547" class="edge">
<title>aggregate_layer15_gpu10&#45;&gt;output</title>
<path fill="none" stroke="black" d="M8966.91,-112.14C8963.25,-111.73 8959.62,-111.34 8956,-110.95 8614.23,-74.83 8220.73,-56.18 7952.51,-46.92"/>
<polygon fill="black" stroke="black" points="7952.34,-43.41 7942.23,-46.56 7952.1,-50.4 7952.34,-43.41"/>
</g>
<!-- route_layer15_gpu11&#45;&gt;comm_layer15 -->
<g id="edge1500" class="edge">
<title>route_layer15_gpu11&#45;&gt;comm_layer15</title>
<path fill="none" stroke="black" d="M10580.49,-489.97C10485.54,-481.64 10380.51,-473.38 10284,-467.91 9404.29,-417.99 8358.29,-402.2 7886.71,-397.41"/>
<polygon fill="black" stroke="black" points="7886.75,-393.91 7876.71,-397.31 7886.68,-400.91 7886.75,-393.91"/>
</g>
<!-- aggregate_layer15_gpu11&#45;&gt;output -->
<g id="edge1548" class="edge">
<title>aggregate_layer15_gpu11&#45;&gt;output</title>
<path fill="none" stroke="black" d="M9627.92,-112.04C9624.26,-111.67 9620.62,-111.3 9617,-110.95 9036.06,-54.91 8355.57,-41.3 7961.72,-38.51"/>
<polygon fill="black" stroke="black" points="7961.62,-35.01 7951.6,-38.44 7961.57,-42.01 7961.62,-35.01"/>
</g>
<!-- route_layer15_gpu12&#45;&gt;comm_layer15 -->
<g id="edge1501" class="edge">
<title>route_layer15_gpu12&#45;&gt;comm_layer15</title>
<path fill="none" stroke="black" d="M11535.35,-489.9C11438.12,-481.43 11330.14,-473.12 11231,-467.91 9977.64,-402.01 8475.73,-394.91 7887.66,-394.9"/>
<polygon fill="black" stroke="black" points="7887.36,-391.4 7877.36,-394.9 7887.36,-398.4 7887.36,-391.4"/>
</g>
<!-- aggregate_layer15_gpu12&#45;&gt;output -->
<g id="edge1549" class="edge">
<title>aggregate_layer15_gpu12&#45;&gt;output</title>
<path fill="none" stroke="black" d="M10288.92,-111.99C10285.26,-111.63 10281.62,-111.29 10278,-110.95 9837.72,-70.5 8563.74,-49.9 7959.44,-42.17"/>
<polygon fill="black" stroke="black" points="7959.31,-38.67 7949.27,-42.04 7959.22,-45.67 7959.31,-38.67"/>
</g>
<!-- route_layer15_gpu13&#45;&gt;comm_layer15 -->
<g id="edge1502" class="edge">
<title>route_layer15_gpu13&#45;&gt;comm_layer15</title>
<path fill="none" stroke="black" d="M12495.61,-489.89C12396.87,-481.33 12286.89,-472.96 12186,-467.91 11339.33,-425.48 8715.43,-403.27 7887.2,-397.18"/>
<polygon fill="black" stroke="black" points="7886.96,-393.68 7876.94,-397.11 7886.91,-400.68 7886.96,-393.68"/>
</g>
<!-- aggregate_layer15_gpu13&#45;&gt;output -->
<g id="edge1550" class="edge">
<title>aggregate_layer15_gpu13&#45;&gt;output</title>
<path fill="none" stroke="black" d="M10949.92,-111.97C10946.26,-111.61 10942.62,-111.28 10939,-110.95 10368.38,-60.1 8677.81,-44.49 7961.07,-40.07"/>
<polygon fill="black" stroke="black" points="7960.88,-36.57 7950.86,-40.01 7960.83,-43.57 7960.88,-36.57"/>
</g>
<!-- route_layer15_gpu14&#45;&gt;comm_layer15 -->
<g id="edge1503" class="edge">
<title>route_layer15_gpu14&#45;&gt;comm_layer15</title>
<path fill="none" stroke="black" d="M13457.41,-489.79C13358.15,-481.2 13247.49,-472.84 13146,-467.91 12101.78,-417.17 8825.27,-400.25 7887.23,-396.37"/>
<polygon fill="black" stroke="black" points="7886.99,-392.87 7876.98,-396.33 7886.96,-399.87 7886.99,-392.87"/>
</g>
<!-- aggregate_layer15_gpu14&#45;&gt;output -->
<g id="edge1551" class="edge">
<title>aggregate_layer15_gpu14&#45;&gt;output</title>
<path fill="none" stroke="black" d="M11610.92,-111.95C11607.26,-111.6 11603.62,-111.27 11600,-110.95 10897.37,-49.63 8780.06,-40.04 7961.76,-38.66"/>
<polygon fill="black" stroke="black" points="7961.6,-35.16 7951.59,-38.64 7961.59,-42.16 7961.6,-35.16"/>
</g>
<!-- route_layer15_gpu15&#45;&gt;comm_layer15 -->
<g id="edge1504" class="edge">
<title>route_layer15_gpu15&#45;&gt;comm_layer15</title>
<path fill="none" stroke="black" d="M14420.31,-489.71C14320.79,-481.1 14209.8,-472.75 14108,-467.91 12864.62,-408.8 8926.7,-397.72 7887.49,-395.8"/>
<polygon fill="black" stroke="black" points="7887.28,-392.3 7877.27,-395.79 7887.27,-399.3 7887.28,-392.3"/>
</g>
<!-- aggregate_layer15_gpu15&#45;&gt;output -->
<g id="edge1552" class="edge">
<title>aggregate_layer15_gpu15&#45;&gt;output</title>
<path fill="none" stroke="black" d="M12271.92,-111.93C12268.26,-111.59 12264.62,-111.26 12261,-110.95 11836.91,-74.5 8943.94,-48.73 7960.46,-40.94"/>
<polygon fill="black" stroke="black" points="7960.43,-37.44 7950.41,-40.86 7960.38,-44.44 7960.43,-37.44"/>
</g>
<!-- comm_layer15&#45;&gt;expert_layer15_gpu0_expert0 -->
<g id="edge1505" class="edge">
<title>comm_layer15&#45;&gt;expert_layer15_gpu0_expert0</title>
<path fill="none" stroke="black" d="M7391.17,-391.69C6750.39,-386.57 4960.86,-368.75 3472,-320.95 3323.55,-316.19 3157.62,-308.54 3024.04,-301.8"/>
<polygon fill="black" stroke="black" points="3023.83,-298.29 3013.67,-301.28 3023.48,-305.28 3023.83,-298.29"/>
</g>
<!-- comm_layer15&#45;&gt;expert_layer15_gpu1_expert1 -->
<g id="edge1506" class="edge">
<title>comm_layer15&#45;&gt;expert_layer15_gpu1_expert1</title>
<path fill="none" stroke="black" d="M7391.13,-392.25C6830.22,-388.66 5401.29,-374.56 4208,-320.95 4135.48,-317.7 4056.87,-312.85 3984.67,-307.86"/>
<polygon fill="black" stroke="black" points="3984.75,-304.36 3974.53,-307.16 3984.26,-311.34 3984.75,-304.36"/>
</g>
<!-- comm_layer15&#45;&gt;expert_layer15_gpu2_expert2 -->
<g id="edge1507" class="edge">
<title>comm_layer15&#45;&gt;expert_layer15_gpu2_expert2</title>
<path fill="none" stroke="black" d="M7391.01,-392.36C6904.62,-389.07 5776.84,-375.65 4831,-320.95 4795.39,-318.89 4757.88,-316.17 4720.99,-313.16"/>
<polygon fill="black" stroke="black" points="4720.86,-309.64 4710.61,-312.3 4720.28,-316.61 4720.86,-309.64"/>
</g>
<!-- comm_layer15&#45;&gt;expert_layer15_gpu3_expert3 -->
<g id="edge1508" class="edge">
<title>comm_layer15&#45;&gt;expert_layer15_gpu3_expert3</title>
<path fill="none" stroke="black" d="M7391.34,-391.39C6980.54,-386.62 6122.09,-371.04 5398,-320.95 5380.4,-319.74 5362.27,-318.3 5344.01,-316.71"/>
<polygon fill="black" stroke="black" points="5344.12,-313.21 5333.85,-315.82 5343.51,-320.18 5344.12,-313.21"/>
</g>
<!-- comm_layer15&#45;&gt;expert_layer15_gpu4_expert4 -->
<g id="edge1509" class="edge">
<title>comm_layer15&#45;&gt;expert_layer15_gpu4_expert4</title>
<path fill="none" stroke="black" d="M7393.38,-388.71C7064.18,-380.99 6455.1,-362.17 5937,-320.95 5928.4,-320.27 5919.66,-319.53 5910.84,-318.73"/>
<polygon fill="black" stroke="black" points="5911.12,-315.24 5900.85,-317.82 5910.49,-322.22 5911.12,-315.24"/>
</g>
<!-- comm_layer15&#45;&gt;expert_layer15_gpu5_expert5 -->
<g id="edge1510" class="edge">
<title>comm_layer15&#45;&gt;expert_layer15_gpu5_expert5</title>
<path fill="none" stroke="black" d="M7401.86,-383.21C7165.18,-371.82 6787.56,-350.96 6462,-320.95 6457.96,-320.58 6453.9,-320.2 6449.8,-319.8"/>
<polygon fill="black" stroke="black" points="6449.87,-316.29 6439.57,-318.8 6449.18,-323.26 6449.87,-316.29"/>
</g>
<!-- comm_layer15&#45;&gt;expert_layer15_gpu6_expert6 -->
<g id="edge1511" class="edge">
<title>comm_layer15&#45;&gt;expert_layer15_gpu6_expert6</title>
<path fill="none" stroke="black" d="M7442.26,-371.35C7306.63,-355.73 7123.28,-334.62 6975,-317.55"/>
<polygon fill="black" stroke="black" points="6975.17,-314.04 6964.84,-316.38 6974.37,-321 6975.17,-314.04"/>
</g>
<!-- comm_layer15&#45;&gt;expert_layer15_gpu7_expert7 -->
<g id="edge1512" class="edge">
<title>comm_layer15&#45;&gt;expert_layer15_gpu7_expert7</title>
<path fill="none" stroke="black" d="M7540.49,-359.77C7509.3,-348.54 7474.4,-335.98 7442.63,-324.54"/>
<polygon fill="black" stroke="black" points="7443.47,-321.12 7432.87,-321.03 7441.1,-327.71 7443.47,-321.12"/>
</g>
<!-- comm_layer15&#45;&gt;expert_layer15_gpu8_expert8 -->
<g id="edge1513" class="edge">
<title>comm_layer15&#45;&gt;expert_layer15_gpu8_expert8</title>
<path fill="none" stroke="black" d="M7727.51,-359.77C7758.7,-348.54 7793.6,-335.98 7825.37,-324.54"/>
<polygon fill="black" stroke="black" points="7826.9,-327.71 7835.13,-321.03 7824.53,-321.12 7826.9,-327.71"/>
</g>
<!-- comm_layer15&#45;&gt;expert_layer15_gpu9_expert9 -->
<g id="edge1514" class="edge">
<title>comm_layer15&#45;&gt;expert_layer15_gpu9_expert9</title>
<path fill="none" stroke="black" d="M7825.74,-371.35C7961.37,-355.73 8144.72,-334.62 8293,-317.55"/>
<polygon fill="black" stroke="black" points="8293.63,-321 8303.16,-316.38 8292.83,-314.04 8293.63,-321"/>
</g>
<!-- comm_layer15&#45;&gt;expert_layer15_gpu10_expert10 -->
<g id="edge1515" class="edge">
<title>comm_layer15&#45;&gt;expert_layer15_gpu10_expert10</title>
<path fill="none" stroke="black" d="M7861.05,-380.94C8097.05,-367.6 8477.06,-345.08 8805,-320.95 8847.11,-317.85 8891.78,-314.3 8935.23,-310.69"/>
<polygon fill="black" stroke="black" points="8935.69,-314.17 8945.36,-309.85 8935.11,-307.19 8935.69,-314.17"/>
</g>
<!-- comm_layer15&#45;&gt;expert_layer15_gpu11_expert11 -->
<g id="edge1516" class="edge">
<title>comm_layer15&#45;&gt;expert_layer15_gpu11_expert11</title>
<path fill="none" stroke="black" d="M7872.83,-387.15C8219.74,-377.29 8883.22,-355.64 9447,-320.95 9492.34,-318.16 9540.55,-314.63 9587.17,-310.93"/>
<polygon fill="black" stroke="black" points="9587.71,-314.39 9597.4,-310.11 9587.15,-307.42 9587.71,-314.39"/>
</g>
<!-- comm_layer15&#45;&gt;expert_layer15_gpu12_expert12 -->
<g id="edge1517" class="edge">
<title>comm_layer15&#45;&gt;expert_layer15_gpu12_expert12</title>
<path fill="none" stroke="black" d="M7876.04,-390.54C8317.94,-384.33 9284.93,-366.39 10099,-320.95 10145.64,-318.35 10195.27,-314.86 10243.15,-311.11"/>
<polygon fill="black" stroke="black" points="10243.65,-314.58 10253.34,-310.31 10243.1,-307.61 10243.65,-314.58"/>
</g>
<!-- comm_layer15&#45;&gt;expert_layer15_gpu13_expert13 -->
<g id="edge1518" class="edge">
<title>comm_layer15&#45;&gt;expert_layer15_gpu13_expert13</title>
<path fill="none" stroke="black" d="M7876.99,-392.6C8402.4,-389.76 9683.34,-377.12 10755,-320.95 10802.67,-318.46 10853.43,-314.96 10902.31,-311.18"/>
<polygon fill="black" stroke="black" points="10902.69,-314.66 10912.39,-310.4 10902.15,-307.68 10902.69,-314.66"/>
</g>
<!-- comm_layer15&#45;&gt;expert_layer15_gpu14_expert14 -->
<g id="edge1519" class="edge">
<title>comm_layer15&#45;&gt;expert_layer15_gpu14_expert14</title>
<path fill="none" stroke="black" d="M7877.41,-394C8478.25,-394.26 10079.97,-388.03 11414,-320.95 11461.95,-318.54 11513.04,-315.08 11562.19,-311.3"/>
<polygon fill="black" stroke="black" points="11562.62,-314.77 11572.32,-310.51 11562.08,-307.8 11562.62,-314.77"/>
</g>
<!-- comm_layer15&#45;&gt;expert_layer15_gpu15_expert15 -->
<g id="edge1520" class="edge">
<title>comm_layer15&#45;&gt;expert_layer15_gpu15_expert15</title>
<path fill="none" stroke="black" d="M7876.53,-391.55C8679.4,-385.01 11246.59,-361.37 12074,-320.95 12121.96,-318.61 12173.04,-315.18 12222.2,-311.41"/>
<polygon fill="black" stroke="black" points="12222.63,-314.89 12232.33,-310.62 12222.09,-307.91 12222.63,-314.89"/>
</g>
</g>
</svg>
