<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Expert_Parallelism_DAG Pages: 1 -->
<svg width="8007pt" height="1126pt"
 viewBox="0.00 0.00 8007.14 1126.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1122)">
<title>Expert_Parallelism_DAG</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1122 8003.14,-1122 8003.14,4 -4,4"/>
<!-- mha_input -->
<g id="node1" class="node">
<title>mha_input</title>
<ellipse fill="lightblue" stroke="black" cx="285.67" cy="-558.5" rx="285.84" ry="37.45"/>
<text text-anchor="middle" x="285.67" y="-569.8" font-family="Times,serif" font-size="14.00">MHA Input</text>
<text text-anchor="middle" x="285.67" y="-554.8" font-family="Times,serif" font-size="14.00">[batch_size=32, seq_len=2048, heads=128, d_k=128]</text>
<text text-anchor="middle" x="285.67" y="-539.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- gate -->
<g id="node2" class="node">
<title>gate</title>
<polygon fill="orange" stroke="black" points="1379.86,-611.5 766.07,-611.5 608.17,-505.5 1221.96,-505.5 1379.86,-611.5"/>
<text text-anchor="middle" x="994.01" y="-569.8" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="994.01" y="-554.8" font-family="Times,serif" font-size="14.00">[batch_size=32, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="994.01" y="-539.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- mha_input&#45;&gt;gate -->
<g id="edge1" class="edge">
<title>mha_input&#45;&gt;gate</title>
<path fill="none" stroke="black" d="M571.42,-558.5C606.03,-558.5 641.55,-558.5 676.58,-558.5"/>
<polygon fill="black" stroke="black" points="676.94,-562 686.94,-558.5 676.94,-555 676.94,-562"/>
</g>
<!-- token_split -->
<g id="node3" class="node">
<title>token_split</title>
<polygon fill="yellow" stroke="black" points="3040.02,-611.5 1749.02,-611.5 1416.91,-505.5 2707.91,-505.5 3040.02,-611.5"/>
<text text-anchor="middle" x="2228.46" y="-569.8" font-family="Times,serif" font-size="14.00">Token Split</text>
<text text-anchor="middle" x="2228.46" y="-554.8" font-family="Times,serif" font-size="14.00">[batch_size=32, seq_len=2048, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="2228.46" y="-539.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- gate&#45;&gt;token_split -->
<g id="edge2" class="edge">
<title>gate&#45;&gt;token_split</title>
<path fill="none" stroke="black" d="M1301.25,-558.5C1384.56,-558.5 1478.1,-558.5 1572.85,-558.5"/>
<polygon fill="black" stroke="black" points="1572.91,-562 1582.91,-558.5 1572.91,-555 1572.91,-562"/>
</g>
<!-- expert_0_linear1 -->
<g id="node4" class="node">
<title>expert_0_linear1</title>
<polygon fill="lightblue" stroke="black" points="3976.24,-1118 3188.24,-1118 3188.24,-1065 3976.24,-1065 3976.24,-1118"/>
<text text-anchor="middle" x="3582.24" y="-1102.8" font-family="Times,serif" font-size="14.00">Expert 0 Linear 1</text>
<text text-anchor="middle" x="3582.24" y="-1087.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="3582.24" y="-1072.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- token_split&#45;&gt;expert_0_linear1 -->
<g id="edge3" class="edge">
<title>token_split&#45;&gt;expert_0_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2303.35,-611.51C2458.29,-719.25 2832.34,-961.59 3188.24,-1056.5 3196.51,-1058.7 3204.9,-1060.78 3213.39,-1062.73"/>
<polygon fill="black" stroke="black" points="3212.88,-1066.2 3223.4,-1064.96 3214.4,-1059.36 3212.88,-1066.2"/>
<text text-anchor="middle" x="3114.24" y="-1052.3" font-family="Times,serif" font-size="14.00">send to GPU 0</text>
</g>
<!-- expert_1_linear1 -->
<g id="node7" class="node">
<title>expert_1_linear1</title>
<polygon fill="lightblue" stroke="black" points="3976.24,-1047 3188.24,-1047 3188.24,-994 3976.24,-994 3976.24,-1047"/>
<text text-anchor="middle" x="3582.24" y="-1031.8" font-family="Times,serif" font-size="14.00">Expert 1 Linear 1</text>
<text text-anchor="middle" x="3582.24" y="-1016.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="3582.24" y="-1001.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- token_split&#45;&gt;expert_1_linear1 -->
<g id="edge7" class="edge">
<title>token_split&#45;&gt;expert_1_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2320.97,-611.67C2487.32,-705.45 2853.13,-898.54 3188.24,-985.5 3196.85,-987.73 3205.6,-989.83 3214.45,-991.8"/>
<polygon fill="black" stroke="black" points="3213.97,-995.28 3224.49,-993.97 3215.45,-988.44 3213.97,-995.28"/>
<text text-anchor="middle" x="3114.24" y="-981.3" font-family="Times,serif" font-size="14.00">send to GPU 1</text>
</g>
<!-- expert_2_linear1 -->
<g id="node10" class="node">
<title>expert_2_linear1</title>
<polygon fill="lightblue" stroke="black" points="3976.24,-976 3188.24,-976 3188.24,-923 3976.24,-923 3976.24,-976"/>
<text text-anchor="middle" x="3582.24" y="-960.8" font-family="Times,serif" font-size="14.00">Expert 2 Linear 1</text>
<text text-anchor="middle" x="3582.24" y="-945.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="3582.24" y="-930.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- token_split&#45;&gt;expert_2_linear1 -->
<g id="edge11" class="edge">
<title>token_split&#45;&gt;expert_2_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2341.93,-611.53C2518.03,-691.96 2871.51,-842.95 3188.24,-914.5 3198.73,-916.87 3209.41,-919.08 3220.21,-921.14"/>
<polygon fill="black" stroke="black" points="3219.7,-924.61 3230.17,-922.99 3220.98,-917.72 3219.7,-924.61"/>
<text text-anchor="middle" x="3114.24" y="-911.3" font-family="Times,serif" font-size="14.00">send to GPU 2</text>
</g>
<!-- expert_3_linear1 -->
<g id="node13" class="node">
<title>expert_3_linear1</title>
<polygon fill="lightblue" stroke="black" points="3976.24,-905 3188.24,-905 3188.24,-852 3976.24,-852 3976.24,-905"/>
<text text-anchor="middle" x="3582.24" y="-889.8" font-family="Times,serif" font-size="14.00">Expert 3 Linear 1</text>
<text text-anchor="middle" x="3582.24" y="-874.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="3582.24" y="-859.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- token_split&#45;&gt;expert_3_linear1 -->
<g id="edge15" class="edge">
<title>token_split&#45;&gt;expert_3_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2374.62,-611.59C2560.5,-677.25 2893.81,-787.22 3188.24,-843.5 3201.11,-845.96 3214.25,-848.25 3227.54,-850.37"/>
<polygon fill="black" stroke="black" points="3227.32,-853.88 3237.74,-851.97 3228.4,-846.97 3227.32,-853.88"/>
<text text-anchor="middle" x="3114.24" y="-841.3" font-family="Times,serif" font-size="14.00">send to GPU 3</text>
</g>
<!-- expert_4_linear1 -->
<g id="node16" class="node">
<title>expert_4_linear1</title>
<polygon fill="lightblue" stroke="black" points="3976.24,-834 3188.24,-834 3188.24,-781 3976.24,-781 3976.24,-834"/>
<text text-anchor="middle" x="3582.24" y="-818.8" font-family="Times,serif" font-size="14.00">Expert 4 Linear 1</text>
<text text-anchor="middle" x="3582.24" y="-803.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="3582.24" y="-788.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- token_split&#45;&gt;expert_4_linear1 -->
<g id="edge19" class="edge">
<title>token_split&#45;&gt;expert_4_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2430.94,-611.54C2623.95,-660.43 2924.08,-731.44 3188.24,-772.5 3204.72,-775.06 3221.62,-777.45 3238.71,-779.68"/>
<polygon fill="black" stroke="black" points="3238.43,-783.17 3248.79,-780.98 3239.32,-776.23 3238.43,-783.17"/>
<text text-anchor="middle" x="3114.24" y="-771.3" font-family="Times,serif" font-size="14.00">send to GPU 4</text>
</g>
<!-- expert_5_linear1 -->
<g id="node19" class="node">
<title>expert_5_linear1</title>
<polygon fill="lightblue" stroke="black" points="3976.24,-763 3188.24,-763 3188.24,-710 3976.24,-710 3976.24,-763"/>
<text text-anchor="middle" x="3582.24" y="-747.8" font-family="Times,serif" font-size="14.00">Expert 5 Linear 1</text>
<text text-anchor="middle" x="3582.24" y="-732.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="3582.24" y="-717.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- token_split&#45;&gt;expert_5_linear1 -->
<g id="edge23" class="edge">
<title>token_split&#45;&gt;expert_5_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2552.25,-611.51C2737.91,-640.78 2975.8,-676.22 3188.24,-701.5 3209.94,-704.08 3232.34,-706.56 3254.92,-708.93"/>
<polygon fill="black" stroke="black" points="3254.65,-712.42 3264.95,-709.97 3255.37,-705.46 3254.65,-712.42"/>
<text text-anchor="middle" x="3114.24" y="-701.3" font-family="Times,serif" font-size="14.00">send to GPU 5</text>
</g>
<!-- expert_6_linear1 -->
<g id="node22" class="node">
<title>expert_6_linear1</title>
<polygon fill="lightblue" stroke="black" points="3976.24,-692 3188.24,-692 3188.24,-639 3976.24,-639 3976.24,-692"/>
<text text-anchor="middle" x="3582.24" y="-676.8" font-family="Times,serif" font-size="14.00">Expert 6 Linear 1</text>
<text text-anchor="middle" x="3582.24" y="-661.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="3582.24" y="-646.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- token_split&#45;&gt;expert_6_linear1 -->
<g id="edge27" class="edge">
<title>token_split&#45;&gt;expert_6_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2899.41,-611.53C3016.03,-620.76 3132.88,-630.01 3236.07,-638.18"/>
<polygon fill="black" stroke="black" points="3236.09,-641.69 3246.34,-638.99 3236.64,-634.71 3236.09,-641.69"/>
<text text-anchor="middle" x="3114.24" y="-635.3" font-family="Times,serif" font-size="14.00">send to GPU 6</text>
</g>
<!-- expert_7_linear1 -->
<g id="node25" class="node">
<title>expert_7_linear1</title>
<polygon fill="lightblue" stroke="black" points="3976.24,-621 3188.24,-621 3188.24,-568 3976.24,-568 3976.24,-621"/>
<text text-anchor="middle" x="3582.24" y="-605.8" font-family="Times,serif" font-size="14.00">Expert 7 Linear 1</text>
<text text-anchor="middle" x="3582.24" y="-590.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="3582.24" y="-575.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- token_split&#45;&gt;expert_7_linear1 -->
<g id="edge31" class="edge">
<title>token_split&#45;&gt;expert_7_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2933.07,-577.24C3016.87,-579.47 3100.11,-581.69 3177.61,-583.75"/>
<polygon fill="black" stroke="black" points="3177.92,-587.26 3188.01,-584.03 3178.11,-580.26 3177.92,-587.26"/>
<text text-anchor="middle" x="3114.24" y="-586.3" font-family="Times,serif" font-size="14.00">send to GPU 7</text>
</g>
<!-- expert_8_linear1 -->
<g id="node28" class="node">
<title>expert_8_linear1</title>
<polygon fill="lightblue" stroke="black" points="3976.24,-550 3188.24,-550 3188.24,-497 3976.24,-497 3976.24,-550"/>
<text text-anchor="middle" x="3582.24" y="-534.8" font-family="Times,serif" font-size="14.00">Expert 8 Linear 1</text>
<text text-anchor="middle" x="3582.24" y="-519.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="3582.24" y="-504.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- token_split&#45;&gt;expert_8_linear1 -->
<g id="edge35" class="edge">
<title>token_split&#45;&gt;expert_8_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2825.82,-543.06C2944.86,-539.98 3067.24,-536.81 3177.91,-533.94"/>
<polygon fill="black" stroke="black" points="3178.33,-537.43 3188.24,-533.68 3178.15,-530.44 3178.33,-537.43"/>
<text text-anchor="middle" x="3114.24" y="-540.3" font-family="Times,serif" font-size="14.00">send to GPU 8</text>
</g>
<!-- expert_9_linear1 -->
<g id="node31" class="node">
<title>expert_9_linear1</title>
<polygon fill="lightblue" stroke="black" points="3976.24,-479 3188.24,-479 3188.24,-426 3976.24,-426 3976.24,-479"/>
<text text-anchor="middle" x="3582.24" y="-463.8" font-family="Times,serif" font-size="14.00">Expert 9 Linear 1</text>
<text text-anchor="middle" x="3582.24" y="-448.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="3582.24" y="-433.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- token_split&#45;&gt;expert_9_linear1 -->
<g id="edge39" class="edge">
<title>token_split&#45;&gt;expert_9_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2747.27,-517.9C2909.75,-505.16 3085.14,-491.4 3232.96,-479.81"/>
<polygon fill="black" stroke="black" points="3233.41,-483.29 3243.11,-479.01 3232.86,-476.31 3233.41,-483.29"/>
<text text-anchor="middle" x="3114.24" y="-496.3" font-family="Times,serif" font-size="14.00">send to GPU 9</text>
</g>
<!-- expert_10_linear1 -->
<g id="node34" class="node">
<title>expert_10_linear1</title>
<polygon fill="lightblue" stroke="black" points="3976.24,-408 3188.24,-408 3188.24,-355 3976.24,-355 3976.24,-408"/>
<text text-anchor="middle" x="3582.24" y="-392.8" font-family="Times,serif" font-size="14.00">Expert 10 Linear 1</text>
<text text-anchor="middle" x="3582.24" y="-377.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="3582.24" y="-362.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- token_split&#45;&gt;expert_10_linear1 -->
<g id="edge43" class="edge">
<title>token_split&#45;&gt;expert_10_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2734.47,-513.92C2912.92,-493.17 3089.33,-465.48 3170.24,-431.5 3179.59,-427.58 3178.82,-421.22 3188.24,-417.5 3193.75,-415.32 3199.34,-413.25 3204.99,-411.28"/>
<polygon fill="black" stroke="black" points="3206.2,-414.57 3214.56,-408.06 3203.97,-407.93 3206.2,-414.57"/>
<text text-anchor="middle" x="3114.24" y="-467.3" font-family="Times,serif" font-size="14.00">send to GPU 10</text>
</g>
<!-- expert_11_linear1 -->
<g id="node37" class="node">
<title>expert_11_linear1</title>
<polygon fill="lightblue" stroke="black" points="3976.24,-337 3188.24,-337 3188.24,-284 3976.24,-284 3976.24,-337"/>
<text text-anchor="middle" x="3582.24" y="-321.8" font-family="Times,serif" font-size="14.00">Expert 11 Linear 1</text>
<text text-anchor="middle" x="3582.24" y="-306.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="3582.24" y="-291.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- token_split&#45;&gt;expert_11_linear1 -->
<g id="edge47" class="edge">
<title>token_split&#45;&gt;expert_11_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2542.67,-505.48C2806.19,-459.84 3144.26,-398.43 3170.24,-379.5 3183.74,-369.66 3174.28,-355.68 3188.24,-346.5 3190.43,-345.06 3192.65,-343.65 3194.88,-342.28"/>
<polygon fill="black" stroke="black" points="3196.76,-345.24 3203.61,-337.16 3193.21,-339.21 3196.76,-345.24"/>
<text text-anchor="middle" x="3114.24" y="-409.3" font-family="Times,serif" font-size="14.00">send to GPU 11</text>
</g>
<!-- expert_12_linear1 -->
<g id="node40" class="node">
<title>expert_12_linear1</title>
<polygon fill="lightblue" stroke="black" points="3976.24,-266 3188.24,-266 3188.24,-213 3976.24,-213 3976.24,-266"/>
<text text-anchor="middle" x="3582.24" y="-250.8" font-family="Times,serif" font-size="14.00">Expert 12 Linear 1</text>
<text text-anchor="middle" x="3582.24" y="-235.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="3582.24" y="-220.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- token_split&#45;&gt;expert_12_linear1 -->
<g id="edge51" class="edge">
<title>token_split&#45;&gt;expert_12_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2474.98,-505.46C2735.15,-447.51 3115.97,-357.01 3170.24,-312.5 3184.38,-300.9 3173.2,-285.9 3188.24,-275.5 3190.19,-274.15 3192.15,-272.84 3194.14,-271.55"/>
<polygon fill="black" stroke="black" points="3196.29,-274.34 3202.95,-266.1 3192.6,-268.39 3196.29,-274.34"/>
<text text-anchor="middle" x="3114.24" y="-361.3" font-family="Times,serif" font-size="14.00">send to GPU 12</text>
</g>
<!-- expert_13_linear1 -->
<g id="node43" class="node">
<title>expert_13_linear1</title>
<polygon fill="lightblue" stroke="black" points="3976.24,-195 3188.24,-195 3188.24,-142 3976.24,-142 3976.24,-195"/>
<text text-anchor="middle" x="3582.24" y="-179.8" font-family="Times,serif" font-size="14.00">Expert 13 Linear 1</text>
<text text-anchor="middle" x="3582.24" y="-164.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="3582.24" y="-149.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- token_split&#45;&gt;expert_13_linear1 -->
<g id="edge55" class="edge">
<title>token_split&#45;&gt;expert_13_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2415.23,-505.43C2609.02,-446.78 2919.02,-343.59 3170.24,-216.5 3178.82,-212.16 3179.18,-207.7 3188.24,-204.5 3194.75,-202.2 3201.36,-200.02 3208.05,-197.97"/>
<polygon fill="black" stroke="black" points="3209.31,-201.24 3217.89,-195.04 3207.31,-194.53 3209.31,-201.24"/>
<text text-anchor="middle" x="3114.24" y="-267.3" font-family="Times,serif" font-size="14.00">send to GPU 13</text>
</g>
<!-- expert_14_linear1 -->
<g id="node46" class="node">
<title>expert_14_linear1</title>
<polygon fill="lightblue" stroke="black" points="3976.24,-124 3188.24,-124 3188.24,-71 3976.24,-71 3976.24,-124"/>
<text text-anchor="middle" x="3582.24" y="-108.8" font-family="Times,serif" font-size="14.00">Expert 14 Linear 1</text>
<text text-anchor="middle" x="3582.24" y="-93.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="3582.24" y="-78.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- token_split&#45;&gt;expert_14_linear1 -->
<g id="edge59" class="edge">
<title>token_split&#45;&gt;expert_14_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2321.35,-505.49C2487.95,-412.23 2853.65,-220.47 3188.24,-133.5 3198.36,-130.87 3208.66,-128.43 3219.09,-126.16"/>
<polygon fill="black" stroke="black" points="3220.08,-129.53 3229.13,-124.03 3218.63,-122.68 3220.08,-129.53"/>
<text text-anchor="middle" x="3114.24" y="-168.3" font-family="Times,serif" font-size="14.00">send to GPU 14</text>
</g>
<!-- expert_15_linear1 -->
<g id="node49" class="node">
<title>expert_15_linear1</title>
<polygon fill="lightblue" stroke="black" points="3976.24,-53 3188.24,-53 3188.24,0 3976.24,0 3976.24,-53"/>
<text text-anchor="middle" x="3582.24" y="-37.8" font-family="Times,serif" font-size="14.00">Expert 15 Linear 1</text>
<text text-anchor="middle" x="3582.24" y="-22.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="3582.24" y="-7.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- token_split&#45;&gt;expert_15_linear1 -->
<g id="edge63" class="edge">
<title>token_split&#45;&gt;expert_15_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2303.67,-505.43C2458.82,-397.91 2832.69,-156.59 3188.24,-62.5 3198.16,-59.88 3208.25,-57.44 3218.48,-55.17"/>
<polygon fill="black" stroke="black" points="3219.28,-58.58 3228.32,-53.05 3217.81,-51.73 3219.28,-58.58"/>
<text text-anchor="middle" x="3114.24" y="-99.3" font-family="Times,serif" font-size="14.00">send to GPU 15</text>
</g>
<!-- expert_0_gelu -->
<g id="node5" class="node">
<title>expert_0_gelu</title>
<polygon fill="lightgreen" stroke="black" points="4777.24,-1118 4013.24,-1118 4013.24,-1065 4777.24,-1065 4777.24,-1118"/>
<text text-anchor="middle" x="4395.24" y="-1102.8" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="4395.24" y="-1087.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="4395.24" y="-1072.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_0_linear1&#45;&gt;expert_0_gelu -->
<g id="edge4" class="edge">
<title>expert_0_linear1&#45;&gt;expert_0_gelu</title>
<path fill="none" stroke="black" d="M3976.27,-1091.5C3985.22,-1091.5 3994.18,-1091.5 4003.13,-1091.5"/>
<polygon fill="black" stroke="black" points="4003.23,-1095 4013.23,-1091.5 4003.23,-1088 4003.23,-1095"/>
</g>
<!-- expert_0_linear2 -->
<g id="node6" class="node">
<title>expert_0_linear2</title>
<polygon fill="lightblue" stroke="black" points="5602.24,-1118 4814.24,-1118 4814.24,-1065 5602.24,-1065 5602.24,-1118"/>
<text text-anchor="middle" x="5208.24" y="-1102.8" font-family="Times,serif" font-size="14.00">Expert 0 Linear 2</text>
<text text-anchor="middle" x="5208.24" y="-1087.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="5208.24" y="-1072.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_0_gelu&#45;&gt;expert_0_linear2 -->
<g id="edge5" class="edge">
<title>expert_0_gelu&#45;&gt;expert_0_linear2</title>
<path fill="none" stroke="black" d="M4777.4,-1091.5C4786.29,-1091.5 4795.19,-1091.5 4804.1,-1091.5"/>
<polygon fill="black" stroke="black" points="4804.14,-1095 4814.14,-1091.5 4804.14,-1088 4804.14,-1095"/>
</g>
<!-- expert_aggregate -->
<g id="node52" class="node">
<title>expert_aggregate</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="7390.58,-611.5 6099.57,-611.5 5767.46,-505.5 7058.47,-505.5 7390.58,-611.5"/>
<text text-anchor="middle" x="6579.02" y="-569.8" font-family="Times,serif" font-size="14.00">Expert Aggregate</text>
<text text-anchor="middle" x="6579.02" y="-554.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="6579.02" y="-539.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_0_linear2&#45;&gt;expert_aggregate -->
<g id="edge6" class="edge">
<title>expert_0_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5562.75,-1065C5576.13,-1062.42 5589.34,-1059.59 5602.24,-1056.5 5960.42,-970.65 6335.09,-729.7 6496.33,-617.44"/>
<polygon fill="black" stroke="black" points="6498.59,-620.13 6504.78,-611.54 6494.58,-614.39 6498.59,-620.13"/>
<text text-anchor="middle" x="5684.74" y="-1052.3" font-family="Times,serif" font-size="14.00">recv from GPU 0</text>
</g>
<!-- expert_1_gelu -->
<g id="node8" class="node">
<title>expert_1_gelu</title>
<polygon fill="lightgreen" stroke="black" points="4777.24,-1047 4013.24,-1047 4013.24,-994 4777.24,-994 4777.24,-1047"/>
<text text-anchor="middle" x="4395.24" y="-1031.8" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="4395.24" y="-1016.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="4395.24" y="-1001.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_1_linear1&#45;&gt;expert_1_gelu -->
<g id="edge8" class="edge">
<title>expert_1_linear1&#45;&gt;expert_1_gelu</title>
<path fill="none" stroke="black" d="M3976.27,-1020.5C3985.22,-1020.5 3994.18,-1020.5 4003.13,-1020.5"/>
<polygon fill="black" stroke="black" points="4003.23,-1024 4013.23,-1020.5 4003.23,-1017 4003.23,-1024"/>
</g>
<!-- expert_1_linear2 -->
<g id="node9" class="node">
<title>expert_1_linear2</title>
<polygon fill="lightblue" stroke="black" points="5602.24,-1047 4814.24,-1047 4814.24,-994 5602.24,-994 5602.24,-1047"/>
<text text-anchor="middle" x="5208.24" y="-1031.8" font-family="Times,serif" font-size="14.00">Expert 1 Linear 2</text>
<text text-anchor="middle" x="5208.24" y="-1016.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="5208.24" y="-1001.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_1_gelu&#45;&gt;expert_1_linear2 -->
<g id="edge9" class="edge">
<title>expert_1_gelu&#45;&gt;expert_1_linear2</title>
<path fill="none" stroke="black" d="M4777.4,-1020.5C4786.29,-1020.5 4795.19,-1020.5 4804.1,-1020.5"/>
<polygon fill="black" stroke="black" points="4804.14,-1024 4814.14,-1020.5 4804.14,-1017 4804.14,-1024"/>
</g>
<!-- expert_1_linear2&#45;&gt;expert_aggregate -->
<g id="edge10" class="edge">
<title>expert_1_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5562.75,-994C5576.13,-991.42 5589.34,-988.59 5602.24,-985.5 5939.39,-904.69 6306.09,-713.21 6478.21,-616.51"/>
<polygon fill="black" stroke="black" points="6480.02,-619.51 6487.01,-611.56 6476.58,-613.41 6480.02,-619.51"/>
<text text-anchor="middle" x="5684.74" y="-982.3" font-family="Times,serif" font-size="14.00">recv from GPU 1</text>
</g>
<!-- expert_2_gelu -->
<g id="node11" class="node">
<title>expert_2_gelu</title>
<polygon fill="lightgreen" stroke="black" points="4777.24,-976 4013.24,-976 4013.24,-923 4777.24,-923 4777.24,-976"/>
<text text-anchor="middle" x="4395.24" y="-960.8" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="4395.24" y="-945.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="4395.24" y="-930.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_2_linear1&#45;&gt;expert_2_gelu -->
<g id="edge12" class="edge">
<title>expert_2_linear1&#45;&gt;expert_2_gelu</title>
<path fill="none" stroke="black" d="M3976.27,-949.5C3985.22,-949.5 3994.18,-949.5 4003.13,-949.5"/>
<polygon fill="black" stroke="black" points="4003.23,-953 4013.23,-949.5 4003.23,-946 4003.23,-953"/>
</g>
<!-- expert_2_linear2 -->
<g id="node12" class="node">
<title>expert_2_linear2</title>
<polygon fill="lightblue" stroke="black" points="5602.24,-976 4814.24,-976 4814.24,-923 5602.24,-923 5602.24,-976"/>
<text text-anchor="middle" x="5208.24" y="-960.8" font-family="Times,serif" font-size="14.00">Expert 2 Linear 2</text>
<text text-anchor="middle" x="5208.24" y="-945.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="5208.24" y="-930.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_2_gelu&#45;&gt;expert_2_linear2 -->
<g id="edge13" class="edge">
<title>expert_2_gelu&#45;&gt;expert_2_linear2</title>
<path fill="none" stroke="black" d="M4777.4,-949.5C4786.29,-949.5 4795.19,-949.5 4804.1,-949.5"/>
<polygon fill="black" stroke="black" points="4804.14,-953 4814.14,-949.5 4804.14,-946 4804.14,-953"/>
</g>
<!-- expert_2_linear2&#45;&gt;expert_aggregate -->
<g id="edge14" class="edge">
<title>expert_2_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5559.77,-922.99C5574.16,-920.41 5588.37,-917.59 5602.24,-914.5 5918.4,-844.02 6271.29,-697.18 6453.71,-615.83"/>
<polygon fill="black" stroke="black" points="6455.37,-618.92 6463.07,-611.65 6452.52,-612.53 6455.37,-618.92"/>
<text text-anchor="middle" x="5684.74" y="-911.3" font-family="Times,serif" font-size="14.00">recv from GPU 2</text>
</g>
<!-- expert_3_gelu -->
<g id="node14" class="node">
<title>expert_3_gelu</title>
<polygon fill="lightgreen" stroke="black" points="4777.24,-905 4013.24,-905 4013.24,-852 4777.24,-852 4777.24,-905"/>
<text text-anchor="middle" x="4395.24" y="-889.8" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="4395.24" y="-874.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="4395.24" y="-859.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_3_linear1&#45;&gt;expert_3_gelu -->
<g id="edge16" class="edge">
<title>expert_3_linear1&#45;&gt;expert_3_gelu</title>
<path fill="none" stroke="black" d="M3976.27,-878.5C3985.22,-878.5 3994.18,-878.5 4003.13,-878.5"/>
<polygon fill="black" stroke="black" points="4003.23,-882 4013.23,-878.5 4003.23,-875 4003.23,-882"/>
</g>
<!-- expert_3_linear2 -->
<g id="node15" class="node">
<title>expert_3_linear2</title>
<polygon fill="lightblue" stroke="black" points="5602.24,-905 4814.24,-905 4814.24,-852 5602.24,-852 5602.24,-905"/>
<text text-anchor="middle" x="5208.24" y="-889.8" font-family="Times,serif" font-size="14.00">Expert 3 Linear 2</text>
<text text-anchor="middle" x="5208.24" y="-874.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="5208.24" y="-859.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_3_gelu&#45;&gt;expert_3_linear2 -->
<g id="edge17" class="edge">
<title>expert_3_gelu&#45;&gt;expert_3_linear2</title>
<path fill="none" stroke="black" d="M4777.4,-878.5C4786.29,-878.5 4795.19,-878.5 4804.1,-878.5"/>
<polygon fill="black" stroke="black" points="4804.14,-882 4814.14,-878.5 4804.14,-875 4804.14,-882"/>
</g>
<!-- expert_3_linear2&#45;&gt;expert_aggregate -->
<g id="edge18" class="edge">
<title>expert_3_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5551.94,-851.99C5568.99,-849.42 5585.83,-846.6 5602.24,-843.5 5896.64,-787.95 6229.68,-680.75 6420.65,-614.83"/>
<polygon fill="black" stroke="black" points="6421.89,-618.1 6430.2,-611.52 6419.6,-611.48 6421.89,-618.1"/>
<text text-anchor="middle" x="5684.74" y="-841.3" font-family="Times,serif" font-size="14.00">recv from GPU 3</text>
</g>
<!-- expert_4_gelu -->
<g id="node17" class="node">
<title>expert_4_gelu</title>
<polygon fill="lightgreen" stroke="black" points="4777.24,-834 4013.24,-834 4013.24,-781 4777.24,-781 4777.24,-834"/>
<text text-anchor="middle" x="4395.24" y="-818.8" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="4395.24" y="-803.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="4395.24" y="-788.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_4_linear1&#45;&gt;expert_4_gelu -->
<g id="edge20" class="edge">
<title>expert_4_linear1&#45;&gt;expert_4_gelu</title>
<path fill="none" stroke="black" d="M3976.27,-807.5C3985.22,-807.5 3994.18,-807.5 4003.13,-807.5"/>
<polygon fill="black" stroke="black" points="4003.23,-811 4013.23,-807.5 4003.23,-804 4003.23,-811"/>
</g>
<!-- expert_4_linear2 -->
<g id="node18" class="node">
<title>expert_4_linear2</title>
<polygon fill="lightblue" stroke="black" points="5602.24,-834 4814.24,-834 4814.24,-781 5602.24,-781 5602.24,-834"/>
<text text-anchor="middle" x="5208.24" y="-818.8" font-family="Times,serif" font-size="14.00">Expert 4 Linear 2</text>
<text text-anchor="middle" x="5208.24" y="-803.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="5208.24" y="-788.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_4_gelu&#45;&gt;expert_4_linear2 -->
<g id="edge21" class="edge">
<title>expert_4_gelu&#45;&gt;expert_4_linear2</title>
<path fill="none" stroke="black" d="M4777.4,-807.5C4786.29,-807.5 4795.19,-807.5 4804.1,-807.5"/>
<polygon fill="black" stroke="black" points="4804.14,-811 4814.14,-807.5 4804.14,-804 4804.14,-811"/>
</g>
<!-- expert_4_linear2&#45;&gt;expert_aggregate -->
<g id="edge22" class="edge">
<title>expert_4_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5540.88,-780.99C5561.68,-778.39 5582.27,-775.57 5602.24,-772.5 5866.28,-731.96 6165.82,-662.73 6362.56,-614.02"/>
<polygon fill="black" stroke="black" points="6363.58,-617.37 6372.44,-611.57 6361.89,-610.58 6363.58,-617.37"/>
<text text-anchor="middle" x="5684.74" y="-771.3" font-family="Times,serif" font-size="14.00">recv from GPU 4</text>
</g>
<!-- expert_5_gelu -->
<g id="node20" class="node">
<title>expert_5_gelu</title>
<polygon fill="lightgreen" stroke="black" points="4777.24,-763 4013.24,-763 4013.24,-710 4777.24,-710 4777.24,-763"/>
<text text-anchor="middle" x="4395.24" y="-747.8" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="4395.24" y="-732.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="4395.24" y="-717.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_5_linear1&#45;&gt;expert_5_gelu -->
<g id="edge24" class="edge">
<title>expert_5_linear1&#45;&gt;expert_5_gelu</title>
<path fill="none" stroke="black" d="M3976.27,-736.5C3985.22,-736.5 3994.18,-736.5 4003.13,-736.5"/>
<polygon fill="black" stroke="black" points="4003.23,-740 4013.23,-736.5 4003.23,-733 4003.23,-740"/>
</g>
<!-- expert_5_linear2 -->
<g id="node21" class="node">
<title>expert_5_linear2</title>
<polygon fill="lightblue" stroke="black" points="5602.24,-763 4814.24,-763 4814.24,-710 5602.24,-710 5602.24,-763"/>
<text text-anchor="middle" x="5208.24" y="-747.8" font-family="Times,serif" font-size="14.00">Expert 5 Linear 2</text>
<text text-anchor="middle" x="5208.24" y="-732.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="5208.24" y="-717.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_5_gelu&#45;&gt;expert_5_linear2 -->
<g id="edge25" class="edge">
<title>expert_5_gelu&#45;&gt;expert_5_linear2</title>
<path fill="none" stroke="black" d="M4777.4,-736.5C4786.29,-736.5 4795.19,-736.5 4804.1,-736.5"/>
<polygon fill="black" stroke="black" points="4804.14,-740 4814.14,-736.5 4804.14,-733 4804.14,-740"/>
</g>
<!-- expert_5_linear2&#45;&gt;expert_aggregate -->
<g id="edge26" class="edge">
<title>expert_5_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5524.72,-709.99C5550.97,-707.3 5577.07,-704.46 5602.24,-701.5 5814.29,-676.54 6051.3,-641.96 6238.63,-613.06"/>
<polygon fill="black" stroke="black" points="6239.29,-616.5 6248.64,-611.52 6238.22,-609.59 6239.29,-616.5"/>
<text text-anchor="middle" x="5684.74" y="-701.3" font-family="Times,serif" font-size="14.00">recv from GPU 5</text>
</g>
<!-- expert_6_gelu -->
<g id="node23" class="node">
<title>expert_6_gelu</title>
<polygon fill="lightgreen" stroke="black" points="4777.24,-692 4013.24,-692 4013.24,-639 4777.24,-639 4777.24,-692"/>
<text text-anchor="middle" x="4395.24" y="-676.8" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="4395.24" y="-661.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="4395.24" y="-646.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_6_linear1&#45;&gt;expert_6_gelu -->
<g id="edge28" class="edge">
<title>expert_6_linear1&#45;&gt;expert_6_gelu</title>
<path fill="none" stroke="black" d="M3976.27,-665.5C3985.22,-665.5 3994.18,-665.5 4003.13,-665.5"/>
<polygon fill="black" stroke="black" points="4003.23,-669 4013.23,-665.5 4003.23,-662 4003.23,-669"/>
</g>
<!-- expert_6_linear2 -->
<g id="node24" class="node">
<title>expert_6_linear2</title>
<polygon fill="lightblue" stroke="black" points="5602.24,-692 4814.24,-692 4814.24,-639 5602.24,-639 5602.24,-692"/>
<text text-anchor="middle" x="5208.24" y="-676.8" font-family="Times,serif" font-size="14.00">Expert 6 Linear 2</text>
<text text-anchor="middle" x="5208.24" y="-661.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="5208.24" y="-646.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_6_gelu&#45;&gt;expert_6_linear2 -->
<g id="edge29" class="edge">
<title>expert_6_gelu&#45;&gt;expert_6_linear2</title>
<path fill="none" stroke="black" d="M4777.4,-665.5C4786.29,-665.5 4795.19,-665.5 4804.1,-665.5"/>
<polygon fill="black" stroke="black" points="4804.14,-669 4814.14,-665.5 4804.14,-662 4804.14,-669"/>
</g>
<!-- expert_6_linear2&#45;&gt;expert_aggregate -->
<g id="edge30" class="edge">
<title>expert_6_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5548.47,-638.98C5699.84,-627.15 5881.72,-612.93 6050.23,-599.76"/>
<polygon fill="black" stroke="black" points="6050.58,-603.24 6060.28,-598.97 6050.04,-596.26 6050.58,-603.24"/>
<text text-anchor="middle" x="5684.74" y="-635.3" font-family="Times,serif" font-size="14.00">recv from GPU 6</text>
</g>
<!-- expert_7_gelu -->
<g id="node26" class="node">
<title>expert_7_gelu</title>
<polygon fill="lightgreen" stroke="black" points="4777.24,-621 4013.24,-621 4013.24,-568 4777.24,-568 4777.24,-621"/>
<text text-anchor="middle" x="4395.24" y="-605.8" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="4395.24" y="-590.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="4395.24" y="-575.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_7_linear1&#45;&gt;expert_7_gelu -->
<g id="edge32" class="edge">
<title>expert_7_linear1&#45;&gt;expert_7_gelu</title>
<path fill="none" stroke="black" d="M3976.27,-594.5C3985.22,-594.5 3994.18,-594.5 4003.13,-594.5"/>
<polygon fill="black" stroke="black" points="4003.23,-598 4013.23,-594.5 4003.23,-591 4003.23,-598"/>
</g>
<!-- expert_7_linear2 -->
<g id="node27" class="node">
<title>expert_7_linear2</title>
<polygon fill="lightblue" stroke="black" points="5602.24,-621 4814.24,-621 4814.24,-568 5602.24,-568 5602.24,-621"/>
<text text-anchor="middle" x="5208.24" y="-605.8" font-family="Times,serif" font-size="14.00">Expert 7 Linear 2</text>
<text text-anchor="middle" x="5208.24" y="-590.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="5208.24" y="-575.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_7_gelu&#45;&gt;expert_7_linear2 -->
<g id="edge33" class="edge">
<title>expert_7_gelu&#45;&gt;expert_7_linear2</title>
<path fill="none" stroke="black" d="M4777.4,-594.5C4786.29,-594.5 4795.19,-594.5 4804.1,-594.5"/>
<polygon fill="black" stroke="black" points="4804.14,-598 4814.14,-594.5 4804.14,-591 4804.14,-598"/>
</g>
<!-- expert_7_linear2&#45;&gt;expert_aggregate -->
<g id="edge34" class="edge">
<title>expert_7_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5602.4,-584.16C5717.85,-581.12 5846.9,-577.73 5972.37,-574.43"/>
<polygon fill="black" stroke="black" points="5972.65,-577.92 5982.55,-574.16 5972.46,-570.93 5972.65,-577.92"/>
<text text-anchor="middle" x="5684.74" y="-586.3" font-family="Times,serif" font-size="14.00">recv from GPU 7</text>
</g>
<!-- expert_8_gelu -->
<g id="node29" class="node">
<title>expert_8_gelu</title>
<polygon fill="lightgreen" stroke="black" points="4777.24,-550 4013.24,-550 4013.24,-497 4777.24,-497 4777.24,-550"/>
<text text-anchor="middle" x="4395.24" y="-534.8" font-family="Times,serif" font-size="14.00">Expert 8 GELU</text>
<text text-anchor="middle" x="4395.24" y="-519.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="4395.24" y="-504.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_8_linear1&#45;&gt;expert_8_gelu -->
<g id="edge36" class="edge">
<title>expert_8_linear1&#45;&gt;expert_8_gelu</title>
<path fill="none" stroke="black" d="M3976.27,-523.5C3985.22,-523.5 3994.18,-523.5 4003.13,-523.5"/>
<polygon fill="black" stroke="black" points="4003.23,-527 4013.23,-523.5 4003.23,-520 4003.23,-527"/>
</g>
<!-- expert_8_linear2 -->
<g id="node30" class="node">
<title>expert_8_linear2</title>
<polygon fill="lightblue" stroke="black" points="5602.24,-550 4814.24,-550 4814.24,-497 5602.24,-497 5602.24,-550"/>
<text text-anchor="middle" x="5208.24" y="-534.8" font-family="Times,serif" font-size="14.00">Expert 8 Linear 2</text>
<text text-anchor="middle" x="5208.24" y="-519.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="5208.24" y="-504.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_8_gelu&#45;&gt;expert_8_linear2 -->
<g id="edge37" class="edge">
<title>expert_8_gelu&#45;&gt;expert_8_linear2</title>
<path fill="none" stroke="black" d="M4777.4,-523.5C4786.29,-523.5 4795.19,-523.5 4804.1,-523.5"/>
<polygon fill="black" stroke="black" points="4804.14,-527 4814.14,-523.5 4804.14,-520 4804.14,-527"/>
</g>
<!-- expert_8_linear2&#45;&gt;expert_aggregate -->
<g id="edge38" class="edge">
<title>expert_8_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5602.4,-533.55C5685.67,-535.68 5776.01,-537.99 5866.98,-540.32"/>
<polygon fill="black" stroke="black" points="5867.13,-543.82 5877.21,-540.58 5867.31,-536.83 5867.13,-543.82"/>
<text text-anchor="middle" x="5684.74" y="-540.3" font-family="Times,serif" font-size="14.00">recv from GPU 8</text>
</g>
<!-- expert_9_gelu -->
<g id="node32" class="node">
<title>expert_9_gelu</title>
<polygon fill="lightgreen" stroke="black" points="4777.24,-479 4013.24,-479 4013.24,-426 4777.24,-426 4777.24,-479"/>
<text text-anchor="middle" x="4395.24" y="-463.8" font-family="Times,serif" font-size="14.00">Expert 9 GELU</text>
<text text-anchor="middle" x="4395.24" y="-448.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="4395.24" y="-433.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_9_linear1&#45;&gt;expert_9_gelu -->
<g id="edge40" class="edge">
<title>expert_9_linear1&#45;&gt;expert_9_gelu</title>
<path fill="none" stroke="black" d="M3976.27,-452.5C3985.22,-452.5 3994.18,-452.5 4003.13,-452.5"/>
<polygon fill="black" stroke="black" points="4003.23,-456 4013.23,-452.5 4003.23,-449 4003.23,-456"/>
</g>
<!-- expert_9_linear2 -->
<g id="node33" class="node">
<title>expert_9_linear2</title>
<polygon fill="lightblue" stroke="black" points="5602.24,-479 4814.24,-479 4814.24,-426 5602.24,-426 5602.24,-479"/>
<text text-anchor="middle" x="5208.24" y="-463.8" font-family="Times,serif" font-size="14.00">Expert 9 Linear 2</text>
<text text-anchor="middle" x="5208.24" y="-448.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="5208.24" y="-433.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_9_gelu&#45;&gt;expert_9_linear2 -->
<g id="edge41" class="edge">
<title>expert_9_gelu&#45;&gt;expert_9_linear2</title>
<path fill="none" stroke="black" d="M4777.4,-452.5C4786.29,-452.5 4795.19,-452.5 4804.1,-452.5"/>
<polygon fill="black" stroke="black" points="4804.14,-456 4814.14,-452.5 4804.14,-449 4804.14,-456"/>
</g>
<!-- expert_9_linear2&#45;&gt;expert_aggregate -->
<g id="edge42" class="edge">
<title>expert_9_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5551.55,-479.01C5653.02,-486.87 5768,-495.77 5883.36,-504.7"/>
<polygon fill="black" stroke="black" points="5883.21,-508.2 5893.45,-505.49 5883.75,-501.22 5883.21,-508.2"/>
<text text-anchor="middle" x="5684.74" y="-496.3" font-family="Times,serif" font-size="14.00">recv from GPU 9</text>
</g>
<!-- expert_10_gelu -->
<g id="node35" class="node">
<title>expert_10_gelu</title>
<polygon fill="lightgreen" stroke="black" points="4777.24,-408 4013.24,-408 4013.24,-355 4777.24,-355 4777.24,-408"/>
<text text-anchor="middle" x="4395.24" y="-392.8" font-family="Times,serif" font-size="14.00">Expert 10 GELU</text>
<text text-anchor="middle" x="4395.24" y="-377.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="4395.24" y="-362.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_10_linear1&#45;&gt;expert_10_gelu -->
<g id="edge44" class="edge">
<title>expert_10_linear1&#45;&gt;expert_10_gelu</title>
<path fill="none" stroke="black" d="M3976.27,-381.5C3985.22,-381.5 3994.18,-381.5 4003.13,-381.5"/>
<polygon fill="black" stroke="black" points="4003.23,-385 4013.23,-381.5 4003.23,-378 4003.23,-385"/>
</g>
<!-- expert_10_linear2 -->
<g id="node36" class="node">
<title>expert_10_linear2</title>
<polygon fill="lightblue" stroke="black" points="5602.24,-408 4814.24,-408 4814.24,-355 5602.24,-355 5602.24,-408"/>
<text text-anchor="middle" x="5208.24" y="-392.8" font-family="Times,serif" font-size="14.00">Expert 10 Linear 2</text>
<text text-anchor="middle" x="5208.24" y="-377.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="5208.24" y="-362.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_10_gelu&#45;&gt;expert_10_linear2 -->
<g id="edge45" class="edge">
<title>expert_10_gelu&#45;&gt;expert_10_linear2</title>
<path fill="none" stroke="black" d="M4777.4,-381.5C4786.29,-381.5 4795.19,-381.5 4804.1,-381.5"/>
<polygon fill="black" stroke="black" points="4804.14,-385 4814.14,-381.5 4804.14,-378 4804.14,-385"/>
</g>
<!-- expert_10_linear2&#45;&gt;expert_aggregate -->
<g id="edge46" class="edge">
<title>expert_10_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5575.92,-408.06C5584.85,-410.96 5593.64,-414.1 5602.24,-417.5 5611.67,-421.22 5610.89,-427.59 5620.24,-431.5 5665.91,-450.62 5873.17,-479.11 6083.26,-504.27"/>
<polygon fill="black" stroke="black" points="6082.92,-507.76 6093.26,-505.47 6083.75,-500.8 6082.92,-507.76"/>
<text text-anchor="middle" x="5684.74" y="-460.3" font-family="Times,serif" font-size="14.00">recv from GPU 10</text>
</g>
<!-- expert_11_gelu -->
<g id="node38" class="node">
<title>expert_11_gelu</title>
<polygon fill="lightgreen" stroke="black" points="4777.24,-337 4013.24,-337 4013.24,-284 4777.24,-284 4777.24,-337"/>
<text text-anchor="middle" x="4395.24" y="-321.8" font-family="Times,serif" font-size="14.00">Expert 11 GELU</text>
<text text-anchor="middle" x="4395.24" y="-306.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="4395.24" y="-291.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_11_linear1&#45;&gt;expert_11_gelu -->
<g id="edge48" class="edge">
<title>expert_11_linear1&#45;&gt;expert_11_gelu</title>
<path fill="none" stroke="black" d="M3976.27,-310.5C3985.22,-310.5 3994.18,-310.5 4003.13,-310.5"/>
<polygon fill="black" stroke="black" points="4003.23,-314 4013.23,-310.5 4003.23,-307 4003.23,-314"/>
</g>
<!-- expert_11_linear2 -->
<g id="node39" class="node">
<title>expert_11_linear2</title>
<polygon fill="lightblue" stroke="black" points="5602.24,-337 4814.24,-337 4814.24,-284 5602.24,-284 5602.24,-337"/>
<text text-anchor="middle" x="5208.24" y="-321.8" font-family="Times,serif" font-size="14.00">Expert 11 Linear 2</text>
<text text-anchor="middle" x="5208.24" y="-306.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="5208.24" y="-291.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_11_gelu&#45;&gt;expert_11_linear2 -->
<g id="edge49" class="edge">
<title>expert_11_gelu&#45;&gt;expert_11_linear2</title>
<path fill="none" stroke="black" d="M4777.4,-310.5C4786.29,-310.5 4795.19,-310.5 4804.1,-310.5"/>
<polygon fill="black" stroke="black" points="4804.14,-314 4814.14,-310.5 4804.14,-307 4804.14,-314"/>
</g>
<!-- expert_11_linear2&#45;&gt;expert_aggregate -->
<g id="edge50" class="edge">
<title>expert_11_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5586.88,-337.16C5592.11,-340.1 5597.23,-343.21 5602.24,-346.5 5616.2,-355.68 5606.72,-369.68 5620.24,-379.5 5633.71,-389.28 5992.82,-454.72 6267.37,-503.67"/>
<polygon fill="black" stroke="black" points="6267.05,-507.17 6277.51,-505.48 6268.28,-500.28 6267.05,-507.17"/>
<text text-anchor="middle" x="5684.74" y="-411.3" font-family="Times,serif" font-size="14.00">recv from GPU 11</text>
</g>
<!-- expert_12_gelu -->
<g id="node41" class="node">
<title>expert_12_gelu</title>
<polygon fill="lightgreen" stroke="black" points="4777.24,-266 4013.24,-266 4013.24,-213 4777.24,-213 4777.24,-266"/>
<text text-anchor="middle" x="4395.24" y="-250.8" font-family="Times,serif" font-size="14.00">Expert 12 GELU</text>
<text text-anchor="middle" x="4395.24" y="-235.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="4395.24" y="-220.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_12_linear1&#45;&gt;expert_12_gelu -->
<g id="edge52" class="edge">
<title>expert_12_linear1&#45;&gt;expert_12_gelu</title>
<path fill="none" stroke="black" d="M3976.27,-239.5C3985.22,-239.5 3994.18,-239.5 4003.13,-239.5"/>
<polygon fill="black" stroke="black" points="4003.23,-243 4013.23,-239.5 4003.23,-236 4003.23,-243"/>
</g>
<!-- expert_12_linear2 -->
<g id="node42" class="node">
<title>expert_12_linear2</title>
<polygon fill="lightblue" stroke="black" points="5602.24,-266 4814.24,-266 4814.24,-213 5602.24,-213 5602.24,-266"/>
<text text-anchor="middle" x="5208.24" y="-250.8" font-family="Times,serif" font-size="14.00">Expert 12 Linear 2</text>
<text text-anchor="middle" x="5208.24" y="-235.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="5208.24" y="-220.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_12_gelu&#45;&gt;expert_12_linear2 -->
<g id="edge53" class="edge">
<title>expert_12_gelu&#45;&gt;expert_12_linear2</title>
<path fill="none" stroke="black" d="M4777.4,-239.5C4786.29,-239.5 4795.19,-239.5 4804.1,-239.5"/>
<polygon fill="black" stroke="black" points="4804.14,-243 4814.14,-239.5 4804.14,-236 4804.14,-243"/>
</g>
<!-- expert_12_linear2&#45;&gt;expert_aggregate -->
<g id="edge54" class="edge">
<title>expert_12_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5587.54,-266.1C5592.54,-269.06 5597.45,-272.19 5602.24,-275.5 5617.29,-285.9 5606.08,-300.93 5620.24,-312.5 5648.7,-335.74 6067.42,-437.91 6341.72,-503.05"/>
<polygon fill="black" stroke="black" points="6341.28,-506.54 6351.82,-505.45 6342.9,-499.73 6341.28,-506.54"/>
<text text-anchor="middle" x="5684.74" y="-354.3" font-family="Times,serif" font-size="14.00">recv from GPU 12</text>
</g>
<!-- expert_13_gelu -->
<g id="node44" class="node">
<title>expert_13_gelu</title>
<polygon fill="lightgreen" stroke="black" points="4777.24,-195 4013.24,-195 4013.24,-142 4777.24,-142 4777.24,-195"/>
<text text-anchor="middle" x="4395.24" y="-179.8" font-family="Times,serif" font-size="14.00">Expert 13 GELU</text>
<text text-anchor="middle" x="4395.24" y="-164.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="4395.24" y="-149.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_13_linear1&#45;&gt;expert_13_gelu -->
<g id="edge56" class="edge">
<title>expert_13_linear1&#45;&gt;expert_13_gelu</title>
<path fill="none" stroke="black" d="M3976.27,-168.5C3985.22,-168.5 3994.18,-168.5 4003.13,-168.5"/>
<polygon fill="black" stroke="black" points="4003.23,-172 4013.23,-168.5 4003.23,-165 4003.23,-172"/>
</g>
<!-- expert_13_linear2 -->
<g id="node45" class="node">
<title>expert_13_linear2</title>
<polygon fill="lightblue" stroke="black" points="5602.24,-195 4814.24,-195 4814.24,-142 5602.24,-142 5602.24,-195"/>
<text text-anchor="middle" x="5208.24" y="-179.8" font-family="Times,serif" font-size="14.00">Expert 13 Linear 2</text>
<text text-anchor="middle" x="5208.24" y="-164.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="5208.24" y="-149.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_13_gelu&#45;&gt;expert_13_linear2 -->
<g id="edge57" class="edge">
<title>expert_13_gelu&#45;&gt;expert_13_linear2</title>
<path fill="none" stroke="black" d="M4777.4,-168.5C4786.29,-168.5 4795.19,-168.5 4804.1,-168.5"/>
<polygon fill="black" stroke="black" points="4804.14,-172 4814.14,-168.5 4804.14,-165 4804.14,-172"/>
</g>
<!-- expert_13_linear2&#45;&gt;expert_aggregate -->
<g id="edge58" class="edge">
<title>expert_13_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5572.59,-195.04C5582.65,-197.93 5592.55,-201.08 5602.24,-204.5 5611.31,-207.7 5611.65,-212.18 5620.24,-216.5 5870.95,-342.43 6179.42,-443.79 6377.37,-502.57"/>
<polygon fill="black" stroke="black" points="6376.42,-505.94 6387.01,-505.42 6378.41,-499.22 6376.42,-505.94"/>
<text text-anchor="middle" x="5684.74" y="-278.3" font-family="Times,serif" font-size="14.00">recv from GPU 13</text>
</g>
<!-- expert_14_gelu -->
<g id="node47" class="node">
<title>expert_14_gelu</title>
<polygon fill="lightgreen" stroke="black" points="4777.24,-124 4013.24,-124 4013.24,-71 4777.24,-71 4777.24,-124"/>
<text text-anchor="middle" x="4395.24" y="-108.8" font-family="Times,serif" font-size="14.00">Expert 14 GELU</text>
<text text-anchor="middle" x="4395.24" y="-93.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="4395.24" y="-78.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_14_linear1&#45;&gt;expert_14_gelu -->
<g id="edge60" class="edge">
<title>expert_14_linear1&#45;&gt;expert_14_gelu</title>
<path fill="none" stroke="black" d="M3976.27,-97.5C3985.22,-97.5 3994.18,-97.5 4003.13,-97.5"/>
<polygon fill="black" stroke="black" points="4003.23,-101 4013.23,-97.5 4003.23,-94 4003.23,-101"/>
</g>
<!-- expert_14_linear2 -->
<g id="node48" class="node">
<title>expert_14_linear2</title>
<polygon fill="lightblue" stroke="black" points="5602.24,-124 4814.24,-124 4814.24,-71 5602.24,-71 5602.24,-124"/>
<text text-anchor="middle" x="5208.24" y="-108.8" font-family="Times,serif" font-size="14.00">Expert 14 Linear 2</text>
<text text-anchor="middle" x="5208.24" y="-93.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="5208.24" y="-78.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_14_gelu&#45;&gt;expert_14_linear2 -->
<g id="edge61" class="edge">
<title>expert_14_gelu&#45;&gt;expert_14_linear2</title>
<path fill="none" stroke="black" d="M4777.4,-97.5C4786.29,-97.5 4795.19,-97.5 4804.1,-97.5"/>
<polygon fill="black" stroke="black" points="4804.14,-101 4814.14,-97.5 4804.14,-94 4804.14,-101"/>
</g>
<!-- expert_14_linear2&#45;&gt;expert_aggregate -->
<g id="edge62" class="edge">
<title>expert_14_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5560.8,-124.04C5574.86,-126.89 5588.72,-130.03 5602.24,-133.5 5936.07,-219.09 6301.4,-405.55 6475.14,-500.47"/>
<polygon fill="black" stroke="black" points="6473.58,-503.6 6484.03,-505.34 6476.94,-497.47 6473.58,-503.6"/>
<text text-anchor="middle" x="5684.74" y="-177.3" font-family="Times,serif" font-size="14.00">recv from GPU 14</text>
</g>
<!-- expert_15_gelu -->
<g id="node50" class="node">
<title>expert_15_gelu</title>
<polygon fill="lightgreen" stroke="black" points="4777.24,-53 4013.24,-53 4013.24,0 4777.24,0 4777.24,-53"/>
<text text-anchor="middle" x="4395.24" y="-37.8" font-family="Times,serif" font-size="14.00">Expert 15 GELU</text>
<text text-anchor="middle" x="4395.24" y="-22.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="4395.24" y="-7.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_15_linear1&#45;&gt;expert_15_gelu -->
<g id="edge64" class="edge">
<title>expert_15_linear1&#45;&gt;expert_15_gelu</title>
<path fill="none" stroke="black" d="M3976.27,-26.5C3985.22,-26.5 3994.18,-26.5 4003.13,-26.5"/>
<polygon fill="black" stroke="black" points="4003.23,-30 4013.23,-26.5 4003.23,-23 4003.23,-30"/>
</g>
<!-- expert_15_linear2 -->
<g id="node51" class="node">
<title>expert_15_linear2</title>
<polygon fill="lightblue" stroke="black" points="5602.24,-53 4814.24,-53 4814.24,0 5602.24,0 5602.24,-53"/>
<text text-anchor="middle" x="5208.24" y="-37.8" font-family="Times,serif" font-size="14.00">Expert 15 Linear 2</text>
<text text-anchor="middle" x="5208.24" y="-22.8" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="5208.24" y="-7.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_15_gelu&#45;&gt;expert_15_linear2 -->
<g id="edge65" class="edge">
<title>expert_15_gelu&#45;&gt;expert_15_linear2</title>
<path fill="none" stroke="black" d="M4777.4,-26.5C4786.29,-26.5 4795.19,-26.5 4804.1,-26.5"/>
<polygon fill="black" stroke="black" points="4804.14,-30 4814.14,-26.5 4804.14,-23 4804.14,-30"/>
</g>
<!-- expert_15_linear2&#45;&gt;expert_aggregate -->
<g id="edge66" class="edge">
<title>expert_15_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5558.08,-53.04C5573.06,-55.89 5587.84,-59.03 5602.24,-62.5 5959.57,-148.62 6333.95,-387.74 6495.64,-499.5"/>
<polygon fill="black" stroke="black" points="6493.91,-502.56 6504.12,-505.38 6497.89,-496.8 6493.91,-502.56"/>
<text text-anchor="middle" x="5684.74" y="-107.3" font-family="Times,serif" font-size="14.00">recv from GPU 15</text>
</g>
<!-- mha_output -->
<g id="node53" class="node">
<title>mha_output</title>
<ellipse fill="lightgreen" stroke="black" cx="7713.47" cy="-558.5" rx="285.84" ry="37.45"/>
<text text-anchor="middle" x="7713.47" y="-569.8" font-family="Times,serif" font-size="14.00">MHA Output</text>
<text text-anchor="middle" x="7713.47" y="-554.8" font-family="Times,serif" font-size="14.00">[batch_size=32, seq_len=2048, heads=128, d_k=128]</text>
<text text-anchor="middle" x="7713.47" y="-539.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_aggregate&#45;&gt;mha_output -->
<g id="edge67" class="edge">
<title>expert_aggregate&#45;&gt;mha_output</title>
<path fill="none" stroke="black" d="M7224.81,-558.5C7291.69,-558.5 7357.08,-558.5 7417.14,-558.5"/>
<polygon fill="black" stroke="black" points="7417.51,-562 7427.51,-558.5 7417.51,-555 7417.51,-562"/>
</g>
</g>
</svg>
