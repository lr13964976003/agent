<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Tensor_Shapes_DAG Pages: 1 -->
<svg width="12886pt" height="1658pt"
 viewBox="0.00 0.00 12886.00 1657.91" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1653.91)">
<title>Tensor_Shapes_DAG</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1653.91 12882,-1653.91 12882,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="6120" cy="-1612.43" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="6120" y="-1623.73" font-family="Times,serif" font-size="14.00">Input Tensor</text>
<text text-anchor="middle" x="6120" y="-1608.73" font-family="Times,serif" font-size="14.00">[batch_size=32, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="6120" y="-1593.73" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layernorm1 -->
<g id="node2" class="node">
<title>layernorm1</title>
<polygon fill="lightgray" stroke="black" points="6496.5,-1537.95 5743.5,-1537.95 5743.5,-1484.95 6496.5,-1484.95 6496.5,-1537.95"/>
<text text-anchor="middle" x="6120" y="-1522.75" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="6120" y="-1507.75" font-family="Times,serif" font-size="14.00">[batch_size=32, seq_len=2048, token_dim=7168] &#45;&gt; [batch_size=32, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="6120" y="-1492.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;layernorm1 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layernorm1</title>
<path fill="none" stroke="black" d="M6120,-1574.86C6120,-1566.16 6120,-1556.9 6120,-1548.25"/>
<polygon fill="black" stroke="black" points="6123.5,-1548.07 6120,-1538.07 6116.5,-1548.07 6123.5,-1548.07"/>
</g>
<!-- qkv_proj -->
<g id="node3" class="node">
<title>qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="6512.5,-1447.95 5727.5,-1447.95 5727.5,-1394.95 6512.5,-1394.95 6512.5,-1447.95"/>
<text text-anchor="middle" x="6120" y="-1432.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6120" y="-1417.75" font-family="Times,serif" font-size="14.00">[batch_size=32, seq_len=2048, token_dim=7168] &#45;&gt; [batch_size=32, seq_len=2048, heads=128, d_k=384]</text>
<text text-anchor="middle" x="6120" y="-1402.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layernorm1&#45;&gt;qkv_proj -->
<g id="edge2" class="edge">
<title>layernorm1&#45;&gt;qkv_proj</title>
<path fill="none" stroke="black" d="M6120,-1484.53C6120,-1476.29 6120,-1467.03 6120,-1458.23"/>
<polygon fill="black" stroke="black" points="6123.5,-1458.19 6120,-1448.19 6116.5,-1458.19 6123.5,-1458.19"/>
</g>
<!-- attention -->
<g id="node4" class="node">
<title>attention</title>
<polygon fill="lightcoral" stroke="black" points="6528,-1357.95 5712,-1357.95 5712,-1304.95 6528,-1304.95 6528,-1357.95"/>
<text text-anchor="middle" x="6120" y="-1342.75" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="6120" y="-1327.75" font-family="Times,serif" font-size="14.00">[batch_size=32, seq_len=2048, heads=128, d_k=128] &#45;&gt; [batch_size=32, seq_len=2048, heads=128, d_k=128]</text>
<text text-anchor="middle" x="6120" y="-1312.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- qkv_proj&#45;&gt;attention -->
<g id="edge3" class="edge">
<title>qkv_proj&#45;&gt;attention</title>
<path fill="none" stroke="black" d="M6120,-1394.53C6120,-1386.29 6120,-1377.03 6120,-1368.23"/>
<polygon fill="black" stroke="black" points="6123.5,-1368.19 6120,-1358.19 6116.5,-1368.19 6123.5,-1368.19"/>
</g>
<!-- attn_out -->
<g id="node5" class="node">
<title>attn_out</title>
<polygon fill="lightyellow" stroke="black" points="6512.5,-1267.95 5727.5,-1267.95 5727.5,-1214.95 6512.5,-1214.95 6512.5,-1267.95"/>
<text text-anchor="middle" x="6120" y="-1252.75" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="6120" y="-1237.75" font-family="Times,serif" font-size="14.00">[batch_size=32, seq_len=2048, heads=128, d_k=128] &#45;&gt; [batch_size=32, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="6120" y="-1222.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- attention&#45;&gt;attn_out -->
<g id="edge4" class="edge">
<title>attention&#45;&gt;attn_out</title>
<path fill="none" stroke="black" d="M6120,-1304.53C6120,-1296.29 6120,-1287.03 6120,-1278.23"/>
<polygon fill="black" stroke="black" points="6123.5,-1278.19 6120,-1268.19 6116.5,-1278.19 6123.5,-1278.19"/>
</g>
<!-- residual1 -->
<g id="node6" class="node">
<title>residual1</title>
<polygon fill="purple" stroke="black" points="6505.84,-1177.95 5892.05,-1177.95 5734.16,-1071.95 6347.95,-1071.95 6505.84,-1177.95"/>
<text text-anchor="middle" x="6120" y="-1136.25" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6120" y="-1121.25" font-family="Times,serif" font-size="14.00">[batch_size=32, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="6120" y="-1106.25" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- attn_out&#45;&gt;residual1 -->
<g id="edge5" class="edge">
<title>attn_out&#45;&gt;residual1</title>
<path fill="none" stroke="black" d="M6120,-1214.76C6120,-1206.82 6120,-1197.7 6120,-1188.39"/>
<polygon fill="black" stroke="black" points="6123.5,-1188.27 6120,-1178.27 6116.5,-1188.27 6123.5,-1188.27"/>
</g>
<!-- layernorm2 -->
<g id="node7" class="node">
<title>layernorm2</title>
<polygon fill="lightgray" stroke="black" points="6496.5,-1034.95 5743.5,-1034.95 5743.5,-981.95 6496.5,-981.95 6496.5,-1034.95"/>
<text text-anchor="middle" x="6120" y="-1019.75" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="6120" y="-1004.75" font-family="Times,serif" font-size="14.00">[batch_size=32, seq_len=2048, token_dim=7168] &#45;&gt; [batch_size=32, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="6120" y="-989.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- residual1&#45;&gt;layernorm2 -->
<g id="edge6" class="edge">
<title>residual1&#45;&gt;layernorm2</title>
<path fill="none" stroke="black" d="M6120,-1071.73C6120,-1062.77 6120,-1053.65 6120,-1045.25"/>
<polygon fill="black" stroke="black" points="6123.5,-1045.06 6120,-1035.06 6116.5,-1045.06 6123.5,-1045.06"/>
</g>
<!-- gate -->
<g id="node8" class="node">
<title>gate</title>
<polygon fill="orange" stroke="black" points="6836.29,-944.95 5696.83,-944.95 5403.71,-838.95 6543.17,-838.95 6836.29,-944.95"/>
<text text-anchor="middle" x="6120" y="-903.25" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="6120" y="-888.25" font-family="Times,serif" font-size="14.00">[batch_size=32, seq_len=2048, token_dim=7168] &#45;&gt; [batch_size=32, seq_len=2048, top_k=2]</text>
<text text-anchor="middle" x="6120" y="-873.25" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layernorm2&#45;&gt;gate -->
<g id="edge7" class="edge">
<title>layernorm2&#45;&gt;gate</title>
<path fill="none" stroke="black" d="M6120,-981.76C6120,-973.82 6120,-964.7 6120,-955.39"/>
<polygon fill="black" stroke="black" points="6123.5,-955.27 6120,-945.27 6116.5,-955.27 6123.5,-955.27"/>
</g>
<!-- token_split -->
<g id="node9" class="node">
<title>token_split</title>
<polygon fill="yellow" stroke="black" points="6931.56,-801.95 5640.55,-801.95 5308.44,-695.95 6599.45,-695.95 6931.56,-801.95"/>
<text text-anchor="middle" x="6120" y="-760.25" font-family="Times,serif" font-size="14.00">Token Split</text>
<text text-anchor="middle" x="6120" y="-745.25" font-family="Times,serif" font-size="14.00">[batch_size=32, seq_len=2048, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="6120" y="-730.25" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- gate&#45;&gt;token_split -->
<g id="edge8" class="edge">
<title>gate&#45;&gt;token_split</title>
<path fill="none" stroke="black" d="M6120,-838.85C6120,-830.28 6120,-821.32 6120,-812.53"/>
<polygon fill="black" stroke="black" points="6123.5,-812.31 6120,-802.31 6116.5,-812.31 6123.5,-812.31"/>
</g>
<!-- expert_0_linear1 -->
<g id="node10" class="node">
<title>expert_0_linear1</title>
<polygon fill="lightblue" stroke="black" points="788,-644.95 0,-644.95 0,-591.95 788,-591.95 788,-644.95"/>
<text text-anchor="middle" x="394" y="-629.75" font-family="Times,serif" font-size="14.00">Expert 0 Linear 1</text>
<text text-anchor="middle" x="394" y="-614.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="394" y="-599.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- token_split&#45;&gt;expert_0_linear1 -->
<g id="edge9" class="edge">
<title>token_split&#45;&gt;expert_0_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5441.91,-738.63C4624.82,-726.88 3210.38,-704.94 1997,-677.95 1466.98,-666.17 1331.7,-669.1 798.31,-645.01"/>
<polygon fill="black" stroke="black" points="798.18,-641.5 788.04,-644.54 797.87,-648.49 798.18,-641.5"/>
<text text-anchor="middle" x="2048.5" y="-666.75" font-family="Times,serif" font-size="14.00">send to GPU 0</text>
</g>
<!-- expert_1_linear1 -->
<g id="node13" class="node">
<title>expert_1_linear1</title>
<polygon fill="lightblue" stroke="black" points="1594,-644.95 806,-644.95 806,-591.95 1594,-591.95 1594,-644.95"/>
<text text-anchor="middle" x="1200" y="-629.75" font-family="Times,serif" font-size="14.00">Expert 1 Linear 1</text>
<text text-anchor="middle" x="1200" y="-614.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="1200" y="-599.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- token_split&#45;&gt;expert_1_linear1 -->
<g id="edge13" class="edge">
<title>token_split&#45;&gt;expert_1_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5429.53,-734.63C4759.33,-721.39 3713.37,-699.95 2807,-677.95 2275.24,-665.05 2139.48,-669.14 1604.34,-645.01"/>
<polygon fill="black" stroke="black" points="1604.18,-641.5 1594.04,-644.54 1603.87,-648.49 1604.18,-641.5"/>
<text text-anchor="middle" x="2858.5" y="-666.75" font-family="Times,serif" font-size="14.00">send to GPU 1</text>
</g>
<!-- expert_2_linear1 -->
<g id="node16" class="node">
<title>expert_2_linear1</title>
<polygon fill="lightblue" stroke="black" points="2400,-644.95 1612,-644.95 1612,-591.95 2400,-591.95 2400,-644.95"/>
<text text-anchor="middle" x="2006" y="-629.75" font-family="Times,serif" font-size="14.00">Expert 2 Linear 1</text>
<text text-anchor="middle" x="2006" y="-614.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="2006" y="-599.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- token_split&#45;&gt;expert_2_linear1 -->
<g id="edge17" class="edge">
<title>token_split&#45;&gt;expert_2_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5436.17,-736.72C4693.73,-722.73 3472.84,-694.46 2410.18,-645"/>
<polygon fill="black" stroke="black" points="2410.19,-641.5 2400.04,-644.53 2409.86,-648.49 2410.19,-641.5"/>
<text text-anchor="middle" x="3170.5" y="-666.75" font-family="Times,serif" font-size="14.00">send to GPU 2</text>
</g>
<!-- expert_3_linear1 -->
<g id="node19" class="node">
<title>expert_3_linear1</title>
<polygon fill="lightblue" stroke="black" points="3206,-644.95 2418,-644.95 2418,-591.95 3206,-591.95 3206,-644.95"/>
<text text-anchor="middle" x="2812" y="-629.75" font-family="Times,serif" font-size="14.00">Expert 3 Linear 1</text>
<text text-anchor="middle" x="2812" y="-614.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="2812" y="-599.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- token_split&#45;&gt;expert_3_linear1 -->
<g id="edge21" class="edge">
<title>token_split&#45;&gt;expert_3_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5409.42,-728.26C4823.72,-710.72 3971.04,-682.15 3216.03,-645"/>
<polygon fill="black" stroke="black" points="3216.2,-641.5 3206.04,-644.51 3215.85,-648.49 3216.2,-641.5"/>
<text text-anchor="middle" x="3984.5" y="-666.75" font-family="Times,serif" font-size="14.00">send to GPU 3</text>
</g>
<!-- expert_4_linear1 -->
<g id="node22" class="node">
<title>expert_4_linear1</title>
<polygon fill="lightblue" stroke="black" points="4012,-644.95 3224,-644.95 3224,-591.95 4012,-591.95 4012,-644.95"/>
<text text-anchor="middle" x="3618" y="-629.75" font-family="Times,serif" font-size="14.00">Expert 4 Linear 1</text>
<text text-anchor="middle" x="3618" y="-614.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="3618" y="-599.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- token_split&#45;&gt;expert_4_linear1 -->
<g id="edge25" class="edge">
<title>token_split&#45;&gt;expert_4_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5362.97,-713.4C4966.74,-694.66 4473.29,-670.31 4022.35,-645.03"/>
<polygon fill="black" stroke="black" points="4022.22,-641.51 4012.04,-644.45 4021.83,-648.5 4022.22,-641.51"/>
<text text-anchor="middle" x="4649.5" y="-666.75" font-family="Times,serif" font-size="14.00">send to GPU 4</text>
</g>
<!-- expert_5_linear1 -->
<g id="node25" class="node">
<title>expert_5_linear1</title>
<polygon fill="lightblue" stroke="black" points="4818,-644.95 4030,-644.95 4030,-591.95 4818,-591.95 4818,-644.95"/>
<text text-anchor="middle" x="4424" y="-629.75" font-family="Times,serif" font-size="14.00">Expert 5 Linear 1</text>
<text text-anchor="middle" x="4424" y="-614.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="4424" y="-599.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- token_split&#45;&gt;expert_5_linear1 -->
<g id="edge29" class="edge">
<title>token_split&#45;&gt;expert_5_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5433.53,-695.94C5205.77,-678.69 4961.86,-660.2 4770.85,-645.73"/>
<polygon fill="black" stroke="black" points="4770.88,-642.23 4760.65,-644.96 4770.35,-649.21 4770.88,-642.23"/>
<text text-anchor="middle" x="5222.5" y="-666.75" font-family="Times,serif" font-size="14.00">send to GPU 5</text>
</g>
<!-- expert_6_linear1 -->
<g id="node28" class="node">
<title>expert_6_linear1</title>
<polygon fill="lightblue" stroke="black" points="5624,-644.95 4836,-644.95 4836,-591.95 5624,-591.95 5624,-644.95"/>
<text text-anchor="middle" x="5230" y="-629.75" font-family="Times,serif" font-size="14.00">Expert 6 Linear 1</text>
<text text-anchor="middle" x="5230" y="-614.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="5230" y="-599.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- token_split&#45;&gt;expert_6_linear1 -->
<g id="edge33" class="edge">
<title>token_split&#45;&gt;expert_6_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5759.61,-695.92C5642.06,-678.95 5516.34,-660.8 5416.89,-646.44"/>
<polygon fill="black" stroke="black" points="5417.14,-642.94 5406.74,-644.97 5416.14,-649.86 5417.14,-642.94"/>
<text text-anchor="middle" x="5673.5" y="-666.75" font-family="Times,serif" font-size="14.00">send to GPU 6</text>
</g>
<!-- expert_7_linear1 -->
<g id="node31" class="node">
<title>expert_7_linear1</title>
<polygon fill="lightblue" stroke="black" points="6430,-644.95 5642,-644.95 5642,-591.95 6430,-591.95 6430,-644.95"/>
<text text-anchor="middle" x="6036" y="-629.75" font-family="Times,serif" font-size="14.00">Expert 7 Linear 1</text>
<text text-anchor="middle" x="6036" y="-614.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="6036" y="-599.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- token_split&#45;&gt;expert_7_linear1 -->
<g id="edge37" class="edge">
<title>token_split&#45;&gt;expert_7_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6080.9,-695.66C6076.79,-689.76 6072.74,-683.77 6069,-677.95 6064.1,-670.33 6059.13,-661.94 6054.58,-653.96"/>
<polygon fill="black" stroke="black" points="6057.61,-652.19 6049.66,-645.17 6051.5,-655.61 6057.61,-652.19"/>
<text text-anchor="middle" x="6120.5" y="-666.75" font-family="Times,serif" font-size="14.00">send to GPU 7</text>
</g>
<!-- expert_8_linear1 -->
<g id="node34" class="node">
<title>expert_8_linear1</title>
<polygon fill="lightblue" stroke="black" points="7236,-644.95 6448,-644.95 6448,-591.95 7236,-591.95 7236,-644.95"/>
<text text-anchor="middle" x="6842" y="-629.75" font-family="Times,serif" font-size="14.00">Expert 8 Linear 1</text>
<text text-anchor="middle" x="6842" y="-614.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="6842" y="-599.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- token_split&#45;&gt;expert_8_linear1 -->
<g id="edge41" class="edge">
<title>token_split&#45;&gt;expert_8_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6178.52,-695.75C6196.17,-682.8 6216.36,-670.49 6237,-662.95 6243.19,-660.69 6337.05,-653.55 6449.06,-645.69"/>
<polygon fill="black" stroke="black" points="6449.52,-649.16 6459.25,-644.97 6449.03,-642.18 6449.52,-649.16"/>
<text text-anchor="middle" x="6288.5" y="-666.75" font-family="Times,serif" font-size="14.00">send to GPU 8</text>
</g>
<!-- expert_9_linear1 -->
<g id="node37" class="node">
<title>expert_9_linear1</title>
<polygon fill="lightblue" stroke="black" points="8042,-644.95 7254,-644.95 7254,-591.95 8042,-591.95 8042,-644.95"/>
<text text-anchor="middle" x="7648" y="-629.75" font-family="Times,serif" font-size="14.00">Expert 9 Linear 1</text>
<text text-anchor="middle" x="7648" y="-614.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="7648" y="-599.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- token_split&#45;&gt;expert_9_linear1 -->
<g id="edge45" class="edge">
<title>token_split&#45;&gt;expert_9_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6289.48,-695.94C6339.71,-682.7 6395.15,-670.18 6447,-662.95 6619.59,-638.91 7052.22,-652.07 7243.91,-644.96"/>
<polygon fill="black" stroke="black" points="7244.11,-648.46 7253.97,-644.56 7243.83,-641.46 7244.11,-648.46"/>
<text text-anchor="middle" x="6498.5" y="-666.75" font-family="Times,serif" font-size="14.00">send to GPU 9</text>
</g>
<!-- expert_10_linear1 -->
<g id="node40" class="node">
<title>expert_10_linear1</title>
<polygon fill="lightblue" stroke="black" points="8848,-644.95 8060,-644.95 8060,-591.95 8848,-591.95 8848,-644.95"/>
<text text-anchor="middle" x="8454" y="-629.75" font-family="Times,serif" font-size="14.00">Expert 10 Linear 1</text>
<text text-anchor="middle" x="8454" y="-614.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="8454" y="-599.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- token_split&#45;&gt;expert_10_linear1 -->
<g id="edge49" class="edge">
<title>token_split&#45;&gt;expert_10_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6444.85,-695.94C6540.33,-682.72 6645.13,-670.21 6742,-662.95 7028.85,-641.46 7744,-655.81 8049.71,-644.98"/>
<polygon fill="black" stroke="black" points="8050.1,-648.47 8059.97,-644.6 8049.84,-641.47 8050.1,-648.47"/>
<text text-anchor="middle" x="6798" y="-666.75" font-family="Times,serif" font-size="14.00">send to GPU 10</text>
</g>
<!-- expert_11_linear1 -->
<g id="node43" class="node">
<title>expert_11_linear1</title>
<polygon fill="lightblue" stroke="black" points="9654,-644.95 8866,-644.95 8866,-591.95 9654,-591.95 9654,-644.95"/>
<text text-anchor="middle" x="9260" y="-629.75" font-family="Times,serif" font-size="14.00">Expert 11 Linear 1</text>
<text text-anchor="middle" x="9260" y="-614.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="9260" y="-599.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- token_split&#45;&gt;expert_11_linear1 -->
<g id="edge53" class="edge">
<title>token_split&#45;&gt;expert_11_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6618.92,-702.15C6805.46,-686.88 7019.28,-671.57 7214,-662.95 7940.17,-630.8 8125.52,-671.64 8855.72,-644.99"/>
<polygon fill="black" stroke="black" points="8856.1,-648.48 8865.97,-644.61 8855.85,-641.48 8856.1,-648.48"/>
<text text-anchor="middle" x="7270" y="-666.75" font-family="Times,serif" font-size="14.00">send to GPU 11</text>
</g>
<!-- expert_12_linear1 -->
<g id="node46" class="node">
<title>expert_12_linear1</title>
<polygon fill="lightblue" stroke="black" points="10460,-644.95 9672,-644.95 9672,-591.95 10460,-591.95 10460,-644.95"/>
<text text-anchor="middle" x="10066" y="-629.75" font-family="Times,serif" font-size="14.00">Expert 12 Linear 1</text>
<text text-anchor="middle" x="10066" y="-614.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="10066" y="-599.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- token_split&#45;&gt;expert_12_linear1 -->
<g id="edge57" class="edge">
<title>token_split&#45;&gt;expert_12_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6670.22,-718.47C7050.15,-699.32 7567.1,-675.63 8023,-662.95 8748.27,-642.78 8932.86,-671.71 9661.74,-644.99"/>
<polygon fill="black" stroke="black" points="9662.1,-648.48 9671.97,-644.61 9661.85,-641.48 9662.1,-648.48"/>
<text text-anchor="middle" x="8079" y="-666.75" font-family="Times,serif" font-size="14.00">send to GPU 12</text>
</g>
<!-- expert_13_linear1 -->
<g id="node49" class="node">
<title>expert_13_linear1</title>
<polygon fill="lightblue" stroke="black" points="11266,-644.95 10478,-644.95 10478,-591.95 11266,-591.95 11266,-644.95"/>
<text text-anchor="middle" x="10872" y="-629.75" font-family="Times,serif" font-size="14.00">Expert 13 Linear 1</text>
<text text-anchor="middle" x="10872" y="-614.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="10872" y="-599.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- token_split&#45;&gt;expert_13_linear1 -->
<g id="edge61" class="edge">
<title>token_split&#45;&gt;expert_13_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6712.31,-731.94C7388.37,-713.94 8527.32,-684.41 9507,-662.95 9931.19,-653.66 10040.03,-662.32 10467.8,-644.99"/>
<polygon fill="black" stroke="black" points="10468.12,-648.48 10477.97,-644.58 10467.83,-641.49 10468.12,-648.48"/>
<text text-anchor="middle" x="9563" y="-666.75" font-family="Times,serif" font-size="14.00">send to GPU 13</text>
</g>
<!-- expert_14_linear1 -->
<g id="node52" class="node">
<title>expert_14_linear1</title>
<polygon fill="lightblue" stroke="black" points="12072,-644.95 11284,-644.95 11284,-591.95 12072,-591.95 12072,-644.95"/>
<text text-anchor="middle" x="11678" y="-629.75" font-family="Times,serif" font-size="14.00">Expert 14 Linear 1</text>
<text text-anchor="middle" x="11678" y="-614.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="11678" y="-599.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- token_split&#45;&gt;expert_14_linear1 -->
<g id="edge65" class="edge">
<title>token_split&#45;&gt;expert_14_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6750.65,-744.12C7720.5,-736.26 9636.76,-712.88 11273.76,-645"/>
<polygon fill="black" stroke="black" points="11274.12,-648.49 11283.97,-644.57 11273.83,-641.49 11274.12,-648.49"/>
<text text-anchor="middle" x="10772" y="-666.75" font-family="Times,serif" font-size="14.00">send to GPU 14</text>
</g>
<!-- expert_15_linear1 -->
<g id="node55" class="node">
<title>expert_15_linear1</title>
<polygon fill="lightblue" stroke="black" points="12878,-644.95 12090,-644.95 12090,-591.95 12878,-591.95 12878,-644.95"/>
<text text-anchor="middle" x="12484" y="-629.75" font-family="Times,serif" font-size="14.00">Expert 15 Linear 1</text>
<text text-anchor="middle" x="12484" y="-614.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="12484" y="-599.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- token_split&#45;&gt;expert_15_linear1 -->
<g id="edge69" class="edge">
<title>token_split&#45;&gt;expert_15_linear1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6740.8,-741.02C7642.07,-730.42 9365.53,-708.22 10832,-677.95 11383.8,-666.57 11524.54,-669.78 12079.69,-645.01"/>
<polygon fill="black" stroke="black" points="12080.13,-648.49 12089.96,-644.55 12079.82,-641.5 12080.13,-648.49"/>
<text text-anchor="middle" x="11639" y="-666.75" font-family="Times,serif" font-size="14.00">send to GPU 15</text>
</g>
<!-- expert_0_gelu -->
<g id="node11" class="node">
<title>expert_0_gelu</title>
<polygon fill="lightgreen" stroke="black" points="776,-554.95 12,-554.95 12,-501.95 776,-501.95 776,-554.95"/>
<text text-anchor="middle" x="394" y="-539.75" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="394" y="-524.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="394" y="-509.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_0_linear1&#45;&gt;expert_0_gelu -->
<g id="edge10" class="edge">
<title>expert_0_linear1&#45;&gt;expert_0_gelu</title>
<path fill="none" stroke="black" d="M394,-591.53C394,-583.29 394,-574.03 394,-565.23"/>
<polygon fill="black" stroke="black" points="397.5,-565.19 394,-555.19 390.5,-565.19 397.5,-565.19"/>
</g>
<!-- expert_0_linear2 -->
<g id="node12" class="node">
<title>expert_0_linear2</title>
<polygon fill="lightblue" stroke="black" points="788,-464.95 0,-464.95 0,-411.95 788,-411.95 788,-464.95"/>
<text text-anchor="middle" x="394" y="-449.75" font-family="Times,serif" font-size="14.00">Expert 0 Linear 2</text>
<text text-anchor="middle" x="394" y="-434.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="394" y="-419.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_0_gelu&#45;&gt;expert_0_linear2 -->
<g id="edge11" class="edge">
<title>expert_0_gelu&#45;&gt;expert_0_linear2</title>
<path fill="none" stroke="black" d="M394,-501.53C394,-493.29 394,-484.03 394,-475.23"/>
<polygon fill="black" stroke="black" points="397.5,-475.19 394,-465.19 390.5,-475.19 397.5,-475.19"/>
</g>
<!-- expert_aggregate -->
<g id="node58" class="node">
<title>expert_aggregate</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="7249.56,-360.95 5958.55,-360.95 5626.44,-254.95 6917.45,-254.95 7249.56,-360.95"/>
<text text-anchor="middle" x="6438" y="-319.25" font-family="Times,serif" font-size="14.00">Expert Aggregate</text>
<text text-anchor="middle" x="6438" y="-304.25" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, token_dim=7168] &#45;&gt; [batch_size=32, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="6438" y="-289.25" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_0_linear2&#45;&gt;expert_aggregate -->
<g id="edge12" class="edge">
<title>expert_0_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M788.04,-412.37C791.03,-412.23 794.02,-412.09 797,-411.95 1333.1,-387.67 1467.48,-390.52 2004,-378.95 3359.86,-349.72 4949.2,-327.57 5808.73,-316.6"/>
<polygon fill="black" stroke="black" points="5808.85,-320.1 5818.81,-316.47 5808.76,-313.1 5808.85,-320.1"/>
<text text-anchor="middle" x="2064" y="-382.75" font-family="Times,serif" font-size="14.00">recv from GPU 0</text>
</g>
<!-- expert_1_gelu -->
<g id="node14" class="node">
<title>expert_1_gelu</title>
<polygon fill="lightgreen" stroke="black" points="1582,-554.95 818,-554.95 818,-501.95 1582,-501.95 1582,-554.95"/>
<text text-anchor="middle" x="1200" y="-539.75" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="1200" y="-524.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="1200" y="-509.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_1_linear1&#45;&gt;expert_1_gelu -->
<g id="edge14" class="edge">
<title>expert_1_linear1&#45;&gt;expert_1_gelu</title>
<path fill="none" stroke="black" d="M1200,-591.53C1200,-583.29 1200,-574.03 1200,-565.23"/>
<polygon fill="black" stroke="black" points="1203.5,-565.19 1200,-555.19 1196.5,-565.19 1203.5,-565.19"/>
</g>
<!-- expert_1_linear2 -->
<g id="node15" class="node">
<title>expert_1_linear2</title>
<polygon fill="lightblue" stroke="black" points="1594,-464.95 806,-464.95 806,-411.95 1594,-411.95 1594,-464.95"/>
<text text-anchor="middle" x="1200" y="-449.75" font-family="Times,serif" font-size="14.00">Expert 1 Linear 2</text>
<text text-anchor="middle" x="1200" y="-434.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="1200" y="-419.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_1_gelu&#45;&gt;expert_1_linear2 -->
<g id="edge15" class="edge">
<title>expert_1_gelu&#45;&gt;expert_1_linear2</title>
<path fill="none" stroke="black" d="M1200,-501.53C1200,-493.29 1200,-484.03 1200,-475.23"/>
<polygon fill="black" stroke="black" points="1203.5,-475.19 1200,-465.19 1196.5,-475.19 1203.5,-475.19"/>
</g>
<!-- expert_1_linear2&#45;&gt;expert_aggregate -->
<g id="edge16" class="edge">
<title>expert_1_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1594.03,-412.34C1597.03,-412.21 1600.02,-412.08 1603,-411.95 3106.88,-348.38 4875.63,-323.34 5800.73,-314.03"/>
<polygon fill="black" stroke="black" points="5800.93,-317.53 5810.89,-313.93 5800.86,-310.53 5800.93,-317.53"/>
<text text-anchor="middle" x="2454" y="-382.75" font-family="Times,serif" font-size="14.00">recv from GPU 1</text>
</g>
<!-- expert_2_gelu -->
<g id="node17" class="node">
<title>expert_2_gelu</title>
<polygon fill="lightgreen" stroke="black" points="2388,-554.95 1624,-554.95 1624,-501.95 2388,-501.95 2388,-554.95"/>
<text text-anchor="middle" x="2006" y="-539.75" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="2006" y="-524.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="2006" y="-509.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_2_linear1&#45;&gt;expert_2_gelu -->
<g id="edge18" class="edge">
<title>expert_2_linear1&#45;&gt;expert_2_gelu</title>
<path fill="none" stroke="black" d="M2006,-591.53C2006,-583.29 2006,-574.03 2006,-565.23"/>
<polygon fill="black" stroke="black" points="2009.5,-565.19 2006,-555.19 2002.5,-565.19 2009.5,-565.19"/>
</g>
<!-- expert_2_linear2 -->
<g id="node18" class="node">
<title>expert_2_linear2</title>
<polygon fill="lightblue" stroke="black" points="2400,-464.95 1612,-464.95 1612,-411.95 2400,-411.95 2400,-464.95"/>
<text text-anchor="middle" x="2006" y="-449.75" font-family="Times,serif" font-size="14.00">Expert 2 Linear 2</text>
<text text-anchor="middle" x="2006" y="-434.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="2006" y="-419.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_2_gelu&#45;&gt;expert_2_linear2 -->
<g id="edge19" class="edge">
<title>expert_2_gelu&#45;&gt;expert_2_linear2</title>
<path fill="none" stroke="black" d="M2006,-501.53C2006,-493.29 2006,-484.03 2006,-475.23"/>
<polygon fill="black" stroke="black" points="2009.5,-475.19 2006,-465.19 2002.5,-475.19 2009.5,-475.19"/>
</g>
<!-- expert_2_linear2&#45;&gt;expert_aggregate -->
<g id="edge20" class="edge">
<title>expert_2_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2400.03,-412.33C2403.03,-412.2 2406.02,-412.08 2409,-411.95 2826.5,-394.76 2931.26,-403.7 3349,-393.95 4215.37,-373.74 5218.29,-345.19 5840.48,-326.88"/>
<polygon fill="black" stroke="black" points="5840.63,-330.37 5850.53,-326.58 5840.43,-323.38 5840.63,-330.37"/>
<text text-anchor="middle" x="4001" y="-382.75" font-family="Times,serif" font-size="14.00">recv from GPU 2</text>
</g>
<!-- expert_3_gelu -->
<g id="node20" class="node">
<title>expert_3_gelu</title>
<polygon fill="lightgreen" stroke="black" points="3194,-554.95 2430,-554.95 2430,-501.95 3194,-501.95 3194,-554.95"/>
<text text-anchor="middle" x="2812" y="-539.75" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="2812" y="-524.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="2812" y="-509.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_3_linear1&#45;&gt;expert_3_gelu -->
<g id="edge22" class="edge">
<title>expert_3_linear1&#45;&gt;expert_3_gelu</title>
<path fill="none" stroke="black" d="M2812,-591.53C2812,-583.29 2812,-574.03 2812,-565.23"/>
<polygon fill="black" stroke="black" points="2815.5,-565.19 2812,-555.19 2808.5,-565.19 2815.5,-565.19"/>
</g>
<!-- expert_3_linear2 -->
<g id="node21" class="node">
<title>expert_3_linear2</title>
<polygon fill="lightblue" stroke="black" points="3206,-464.95 2418,-464.95 2418,-411.95 3206,-411.95 3206,-464.95"/>
<text text-anchor="middle" x="2812" y="-449.75" font-family="Times,serif" font-size="14.00">Expert 3 Linear 2</text>
<text text-anchor="middle" x="2812" y="-434.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="2812" y="-419.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_3_gelu&#45;&gt;expert_3_linear2 -->
<g id="edge23" class="edge">
<title>expert_3_gelu&#45;&gt;expert_3_linear2</title>
<path fill="none" stroke="black" d="M2812,-501.53C2812,-493.29 2812,-484.03 2812,-475.23"/>
<polygon fill="black" stroke="black" points="2815.5,-475.19 2812,-465.19 2808.5,-475.19 2815.5,-475.19"/>
</g>
<!-- expert_3_linear2&#45;&gt;expert_aggregate -->
<g id="edge24" class="edge">
<title>expert_3_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3206.03,-412.3C3209.03,-412.18 3212.02,-412.07 3215,-411.95 3853.26,-387.78 4013.57,-413.14 4652,-393.95 5064.39,-381.56 5529.99,-359.12 5882.38,-340.41"/>
<polygon fill="black" stroke="black" points="5882.71,-343.9 5892.51,-339.88 5882.34,-336.91 5882.71,-343.9"/>
<text text-anchor="middle" x="5104" y="-382.75" font-family="Times,serif" font-size="14.00">recv from GPU 3</text>
</g>
<!-- expert_4_gelu -->
<g id="node23" class="node">
<title>expert_4_gelu</title>
<polygon fill="lightgreen" stroke="black" points="4000,-554.95 3236,-554.95 3236,-501.95 4000,-501.95 4000,-554.95"/>
<text text-anchor="middle" x="3618" y="-539.75" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="3618" y="-524.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="3618" y="-509.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_4_linear1&#45;&gt;expert_4_gelu -->
<g id="edge26" class="edge">
<title>expert_4_linear1&#45;&gt;expert_4_gelu</title>
<path fill="none" stroke="black" d="M3618,-591.53C3618,-583.29 3618,-574.03 3618,-565.23"/>
<polygon fill="black" stroke="black" points="3621.5,-565.19 3618,-555.19 3614.5,-565.19 3621.5,-565.19"/>
</g>
<!-- expert_4_linear2 -->
<g id="node24" class="node">
<title>expert_4_linear2</title>
<polygon fill="lightblue" stroke="black" points="4012,-464.95 3224,-464.95 3224,-411.95 4012,-411.95 4012,-464.95"/>
<text text-anchor="middle" x="3618" y="-449.75" font-family="Times,serif" font-size="14.00">Expert 4 Linear 2</text>
<text text-anchor="middle" x="3618" y="-434.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="3618" y="-419.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_4_gelu&#45;&gt;expert_4_linear2 -->
<g id="edge27" class="edge">
<title>expert_4_gelu&#45;&gt;expert_4_linear2</title>
<path fill="none" stroke="black" d="M3618,-501.53C3618,-493.29 3618,-484.03 3618,-475.23"/>
<polygon fill="black" stroke="black" points="3621.5,-475.19 3618,-465.19 3614.5,-475.19 3621.5,-475.19"/>
</g>
<!-- expert_4_linear2&#45;&gt;expert_aggregate -->
<g id="edge28" class="edge">
<title>expert_4_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4012.03,-412.3C4015.03,-412.18 4018.02,-412.07 4021,-411.95 4622.39,-388.94 4773.82,-421.95 5375,-393.95 5556.53,-385.5 5755.13,-371.03 5931.02,-356.4"/>
<polygon fill="black" stroke="black" points="5931.57,-359.87 5941.24,-355.55 5930.98,-352.9 5931.57,-359.87"/>
<text text-anchor="middle" x="5669" y="-382.75" font-family="Times,serif" font-size="14.00">recv from GPU 4</text>
</g>
<!-- expert_5_gelu -->
<g id="node26" class="node">
<title>expert_5_gelu</title>
<polygon fill="lightgreen" stroke="black" points="4806,-554.95 4042,-554.95 4042,-501.95 4806,-501.95 4806,-554.95"/>
<text text-anchor="middle" x="4424" y="-539.75" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="4424" y="-524.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="4424" y="-509.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_5_linear1&#45;&gt;expert_5_gelu -->
<g id="edge30" class="edge">
<title>expert_5_linear1&#45;&gt;expert_5_gelu</title>
<path fill="none" stroke="black" d="M4424,-591.53C4424,-583.29 4424,-574.03 4424,-565.23"/>
<polygon fill="black" stroke="black" points="4427.5,-565.19 4424,-555.19 4420.5,-565.19 4427.5,-565.19"/>
</g>
<!-- expert_5_linear2 -->
<g id="node27" class="node">
<title>expert_5_linear2</title>
<polygon fill="lightblue" stroke="black" points="4818,-464.95 4030,-464.95 4030,-411.95 4818,-411.95 4818,-464.95"/>
<text text-anchor="middle" x="4424" y="-449.75" font-family="Times,serif" font-size="14.00">Expert 5 Linear 2</text>
<text text-anchor="middle" x="4424" y="-434.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="4424" y="-419.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_5_gelu&#45;&gt;expert_5_linear2 -->
<g id="edge31" class="edge">
<title>expert_5_gelu&#45;&gt;expert_5_linear2</title>
<path fill="none" stroke="black" d="M4424,-501.53C4424,-493.29 4424,-484.03 4424,-475.23"/>
<polygon fill="black" stroke="black" points="4427.5,-475.19 4424,-465.19 4420.5,-475.19 4427.5,-475.19"/>
</g>
<!-- expert_5_linear2&#45;&gt;expert_aggregate -->
<g id="edge32" class="edge">
<title>expert_5_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4818.03,-412.33C4821.03,-412.2 4824.02,-412.07 4827,-411.95 5262.71,-394.18 5373.19,-427.16 5808,-393.95 5901.83,-386.79 6003.05,-374.96 6096.33,-362.38"/>
<polygon fill="black" stroke="black" points="6097.05,-365.82 6106.49,-361 6096.11,-358.88 6097.05,-365.82"/>
<text text-anchor="middle" x="6007" y="-382.75" font-family="Times,serif" font-size="14.00">recv from GPU 5</text>
</g>
<!-- expert_6_gelu -->
<g id="node29" class="node">
<title>expert_6_gelu</title>
<polygon fill="lightgreen" stroke="black" points="5612,-554.95 4848,-554.95 4848,-501.95 5612,-501.95 5612,-554.95"/>
<text text-anchor="middle" x="5230" y="-539.75" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="5230" y="-524.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="5230" y="-509.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_6_linear1&#45;&gt;expert_6_gelu -->
<g id="edge34" class="edge">
<title>expert_6_linear1&#45;&gt;expert_6_gelu</title>
<path fill="none" stroke="black" d="M5230,-591.53C5230,-583.29 5230,-574.03 5230,-565.23"/>
<polygon fill="black" stroke="black" points="5233.5,-565.19 5230,-555.19 5226.5,-565.19 5233.5,-565.19"/>
</g>
<!-- expert_6_linear2 -->
<g id="node30" class="node">
<title>expert_6_linear2</title>
<polygon fill="lightblue" stroke="black" points="5624,-464.95 4836,-464.95 4836,-411.95 5624,-411.95 5624,-464.95"/>
<text text-anchor="middle" x="5230" y="-449.75" font-family="Times,serif" font-size="14.00">Expert 6 Linear 2</text>
<text text-anchor="middle" x="5230" y="-434.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="5230" y="-419.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_6_gelu&#45;&gt;expert_6_linear2 -->
<g id="edge35" class="edge">
<title>expert_6_gelu&#45;&gt;expert_6_linear2</title>
<path fill="none" stroke="black" d="M5230,-501.53C5230,-493.29 5230,-484.03 5230,-475.23"/>
<polygon fill="black" stroke="black" points="5233.5,-475.19 5230,-465.19 5226.5,-475.19 5233.5,-475.19"/>
</g>
<!-- expert_6_linear2&#45;&gt;expert_aggregate -->
<g id="edge36" class="edge">
<title>expert_6_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5624.04,-412.42C5627.04,-412.26 5630.02,-412.11 5633,-411.95 5838.67,-401.45 5892.12,-422.94 6096,-393.95 6145.83,-386.87 6198.95,-375.56 6248.1,-363.47"/>
<polygon fill="black" stroke="black" points="6249.02,-366.85 6257.88,-361.05 6247.33,-360.06 6249.02,-366.85"/>
<text text-anchor="middle" x="6232" y="-382.75" font-family="Times,serif" font-size="14.00">recv from GPU 6</text>
</g>
<!-- expert_7_gelu -->
<g id="node32" class="node">
<title>expert_7_gelu</title>
<polygon fill="lightgreen" stroke="black" points="6418,-554.95 5654,-554.95 5654,-501.95 6418,-501.95 6418,-554.95"/>
<text text-anchor="middle" x="6036" y="-539.75" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="6036" y="-524.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="6036" y="-509.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_7_linear1&#45;&gt;expert_7_gelu -->
<g id="edge38" class="edge">
<title>expert_7_linear1&#45;&gt;expert_7_gelu</title>
<path fill="none" stroke="black" d="M6036,-591.53C6036,-583.29 6036,-574.03 6036,-565.23"/>
<polygon fill="black" stroke="black" points="6039.5,-565.19 6036,-555.19 6032.5,-565.19 6039.5,-565.19"/>
</g>
<!-- expert_7_linear2 -->
<g id="node33" class="node">
<title>expert_7_linear2</title>
<polygon fill="lightblue" stroke="black" points="6430,-464.95 5642,-464.95 5642,-411.95 6430,-411.95 6430,-464.95"/>
<text text-anchor="middle" x="6036" y="-449.75" font-family="Times,serif" font-size="14.00">Expert 7 Linear 2</text>
<text text-anchor="middle" x="6036" y="-434.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="6036" y="-419.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_7_gelu&#45;&gt;expert_7_linear2 -->
<g id="edge39" class="edge">
<title>expert_7_gelu&#45;&gt;expert_7_linear2</title>
<path fill="none" stroke="black" d="M6036,-501.53C6036,-493.29 6036,-484.03 6036,-475.23"/>
<polygon fill="black" stroke="black" points="6039.5,-475.19 6036,-465.19 6032.5,-475.19 6039.5,-475.19"/>
</g>
<!-- expert_7_linear2&#45;&gt;expert_aggregate -->
<g id="edge40" class="edge">
<title>expert_7_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6255.69,-411.89C6275.03,-406.93 6294.06,-401.01 6312,-393.95 6329.77,-386.96 6347.57,-377.13 6363.95,-366.62"/>
<polygon fill="black" stroke="black" points="6365.95,-369.49 6372.39,-361.07 6362.11,-363.64 6365.95,-369.49"/>
<text text-anchor="middle" x="6402" y="-382.75" font-family="Times,serif" font-size="14.00">recv from GPU 7</text>
</g>
<!-- expert_8_gelu -->
<g id="node35" class="node">
<title>expert_8_gelu</title>
<polygon fill="lightgreen" stroke="black" points="7224,-554.95 6460,-554.95 6460,-501.95 7224,-501.95 7224,-554.95"/>
<text text-anchor="middle" x="6842" y="-539.75" font-family="Times,serif" font-size="14.00">Expert 8 GELU</text>
<text text-anchor="middle" x="6842" y="-524.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="6842" y="-509.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_8_linear1&#45;&gt;expert_8_gelu -->
<g id="edge42" class="edge">
<title>expert_8_linear1&#45;&gt;expert_8_gelu</title>
<path fill="none" stroke="black" d="M6842,-591.53C6842,-583.29 6842,-574.03 6842,-565.23"/>
<polygon fill="black" stroke="black" points="6845.5,-565.19 6842,-555.19 6838.5,-565.19 6845.5,-565.19"/>
</g>
<!-- expert_8_linear2 -->
<g id="node36" class="node">
<title>expert_8_linear2</title>
<polygon fill="lightblue" stroke="black" points="7236,-464.95 6448,-464.95 6448,-411.95 7236,-411.95 7236,-464.95"/>
<text text-anchor="middle" x="6842" y="-449.75" font-family="Times,serif" font-size="14.00">Expert 8 Linear 2</text>
<text text-anchor="middle" x="6842" y="-434.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="6842" y="-419.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_8_gelu&#45;&gt;expert_8_linear2 -->
<g id="edge43" class="edge">
<title>expert_8_gelu&#45;&gt;expert_8_linear2</title>
<path fill="none" stroke="black" d="M6842,-501.53C6842,-493.29 6842,-484.03 6842,-475.23"/>
<polygon fill="black" stroke="black" points="6845.5,-475.19 6842,-465.19 6838.5,-475.19 6845.5,-475.19"/>
</g>
<!-- expert_8_linear2&#45;&gt;expert_aggregate -->
<g id="edge44" class="edge">
<title>expert_8_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6761.7,-411.91C6718.59,-398.2 6663.69,-380.74 6611.4,-364.11"/>
<polygon fill="black" stroke="black" points="6612.26,-360.71 6601.67,-361.01 6610.14,-367.38 6612.26,-360.71"/>
<text text-anchor="middle" x="6760" y="-382.75" font-family="Times,serif" font-size="14.00">recv from GPU 8</text>
</g>
<!-- expert_9_gelu -->
<g id="node38" class="node">
<title>expert_9_gelu</title>
<polygon fill="lightgreen" stroke="black" points="8030,-554.95 7266,-554.95 7266,-501.95 8030,-501.95 8030,-554.95"/>
<text text-anchor="middle" x="7648" y="-539.75" font-family="Times,serif" font-size="14.00">Expert 9 GELU</text>
<text text-anchor="middle" x="7648" y="-524.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="7648" y="-509.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_9_linear1&#45;&gt;expert_9_gelu -->
<g id="edge46" class="edge">
<title>expert_9_linear1&#45;&gt;expert_9_gelu</title>
<path fill="none" stroke="black" d="M7648,-591.53C7648,-583.29 7648,-574.03 7648,-565.23"/>
<polygon fill="black" stroke="black" points="7651.5,-565.19 7648,-555.19 7644.5,-565.19 7651.5,-565.19"/>
</g>
<!-- expert_9_linear2 -->
<g id="node39" class="node">
<title>expert_9_linear2</title>
<polygon fill="lightblue" stroke="black" points="8042,-464.95 7254,-464.95 7254,-411.95 8042,-411.95 8042,-464.95"/>
<text text-anchor="middle" x="7648" y="-449.75" font-family="Times,serif" font-size="14.00">Expert 9 Linear 2</text>
<text text-anchor="middle" x="7648" y="-434.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="7648" y="-419.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_9_gelu&#45;&gt;expert_9_linear2 -->
<g id="edge47" class="edge">
<title>expert_9_gelu&#45;&gt;expert_9_linear2</title>
<path fill="none" stroke="black" d="M7648,-501.53C7648,-493.29 7648,-484.03 7648,-475.23"/>
<polygon fill="black" stroke="black" points="7651.5,-475.19 7648,-465.19 7644.5,-475.19 7651.5,-475.19"/>
</g>
<!-- expert_9_linear2&#45;&gt;expert_aggregate -->
<g id="edge48" class="edge">
<title>expert_9_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7407.86,-411.95C7273.37,-397.67 7100.5,-379.31 6938.04,-362.06"/>
<polygon fill="black" stroke="black" points="6938.16,-358.55 6927.85,-360.97 6937.42,-365.51 6938.16,-358.55"/>
<text text-anchor="middle" x="7283" y="-382.75" font-family="Times,serif" font-size="14.00">recv from GPU 9</text>
</g>
<!-- expert_10_gelu -->
<g id="node41" class="node">
<title>expert_10_gelu</title>
<polygon fill="lightgreen" stroke="black" points="8836,-554.95 8072,-554.95 8072,-501.95 8836,-501.95 8836,-554.95"/>
<text text-anchor="middle" x="8454" y="-539.75" font-family="Times,serif" font-size="14.00">Expert 10 GELU</text>
<text text-anchor="middle" x="8454" y="-524.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="8454" y="-509.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_10_linear1&#45;&gt;expert_10_gelu -->
<g id="edge50" class="edge">
<title>expert_10_linear1&#45;&gt;expert_10_gelu</title>
<path fill="none" stroke="black" d="M8454,-591.53C8454,-583.29 8454,-574.03 8454,-565.23"/>
<polygon fill="black" stroke="black" points="8457.5,-565.19 8454,-555.19 8450.5,-565.19 8457.5,-565.19"/>
</g>
<!-- expert_10_linear2 -->
<g id="node42" class="node">
<title>expert_10_linear2</title>
<polygon fill="lightblue" stroke="black" points="8848,-464.95 8060,-464.95 8060,-411.95 8848,-411.95 8848,-464.95"/>
<text text-anchor="middle" x="8454" y="-449.75" font-family="Times,serif" font-size="14.00">Expert 10 Linear 2</text>
<text text-anchor="middle" x="8454" y="-434.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="8454" y="-419.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_10_gelu&#45;&gt;expert_10_linear2 -->
<g id="edge51" class="edge">
<title>expert_10_gelu&#45;&gt;expert_10_linear2</title>
<path fill="none" stroke="black" d="M8454,-501.53C8454,-493.29 8454,-484.03 8454,-475.23"/>
<polygon fill="black" stroke="black" points="8457.5,-475.19 8454,-465.19 8450.5,-475.19 8457.5,-475.19"/>
</g>
<!-- expert_10_linear2&#45;&gt;expert_aggregate -->
<g id="edge52" class="edge">
<title>expert_10_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8059.91,-412.33C7831.65,-397.78 7535.55,-378.91 7258.94,-361.28"/>
<polygon fill="black" stroke="black" points="7258.89,-357.77 7248.69,-360.63 7258.45,-364.76 7258.89,-357.77"/>
<text text-anchor="middle" x="7809.5" y="-382.75" font-family="Times,serif" font-size="14.00">recv from GPU 10</text>
</g>
<!-- expert_11_gelu -->
<g id="node44" class="node">
<title>expert_11_gelu</title>
<polygon fill="lightgreen" stroke="black" points="9642,-554.95 8878,-554.95 8878,-501.95 9642,-501.95 9642,-554.95"/>
<text text-anchor="middle" x="9260" y="-539.75" font-family="Times,serif" font-size="14.00">Expert 11 GELU</text>
<text text-anchor="middle" x="9260" y="-524.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="9260" y="-509.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_11_linear1&#45;&gt;expert_11_gelu -->
<g id="edge54" class="edge">
<title>expert_11_linear1&#45;&gt;expert_11_gelu</title>
<path fill="none" stroke="black" d="M9260,-591.53C9260,-583.29 9260,-574.03 9260,-565.23"/>
<polygon fill="black" stroke="black" points="9263.5,-565.19 9260,-555.19 9256.5,-565.19 9263.5,-565.19"/>
</g>
<!-- expert_11_linear2 -->
<g id="node45" class="node">
<title>expert_11_linear2</title>
<polygon fill="lightblue" stroke="black" points="9654,-464.95 8866,-464.95 8866,-411.95 9654,-411.95 9654,-464.95"/>
<text text-anchor="middle" x="9260" y="-449.75" font-family="Times,serif" font-size="14.00">Expert 11 Linear 2</text>
<text text-anchor="middle" x="9260" y="-434.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="9260" y="-419.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_11_gelu&#45;&gt;expert_11_linear2 -->
<g id="edge55" class="edge">
<title>expert_11_gelu&#45;&gt;expert_11_linear2</title>
<path fill="none" stroke="black" d="M9260,-501.53C9260,-493.29 9260,-484.03 9260,-475.23"/>
<polygon fill="black" stroke="black" points="9263.5,-475.19 9260,-465.19 9256.5,-475.19 9263.5,-475.19"/>
</g>
<!-- expert_11_linear2&#45;&gt;expert_aggregate -->
<g id="edge56" class="edge">
<title>expert_11_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8865.96,-412.43C8862.96,-412.27 8859.98,-412.11 8857,-411.95 8295.77,-382.25 7660.94,-355.48 7182.47,-336.68"/>
<polygon fill="black" stroke="black" points="7182.39,-333.17 7172.26,-336.28 7182.12,-340.17 7182.39,-333.17"/>
<text text-anchor="middle" x="8526.5" y="-382.75" font-family="Times,serif" font-size="14.00">recv from GPU 11</text>
</g>
<!-- expert_12_gelu -->
<g id="node47" class="node">
<title>expert_12_gelu</title>
<polygon fill="lightgreen" stroke="black" points="10448,-554.95 9684,-554.95 9684,-501.95 10448,-501.95 10448,-554.95"/>
<text text-anchor="middle" x="10066" y="-539.75" font-family="Times,serif" font-size="14.00">Expert 12 GELU</text>
<text text-anchor="middle" x="10066" y="-524.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="10066" y="-509.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_12_linear1&#45;&gt;expert_12_gelu -->
<g id="edge58" class="edge">
<title>expert_12_linear1&#45;&gt;expert_12_gelu</title>
<path fill="none" stroke="black" d="M10066,-591.53C10066,-583.29 10066,-574.03 10066,-565.23"/>
<polygon fill="black" stroke="black" points="10069.5,-565.19 10066,-555.19 10062.5,-565.19 10069.5,-565.19"/>
</g>
<!-- expert_12_linear2 -->
<g id="node48" class="node">
<title>expert_12_linear2</title>
<polygon fill="lightblue" stroke="black" points="10460,-464.95 9672,-464.95 9672,-411.95 10460,-411.95 10460,-464.95"/>
<text text-anchor="middle" x="10066" y="-449.75" font-family="Times,serif" font-size="14.00">Expert 12 Linear 2</text>
<text text-anchor="middle" x="10066" y="-434.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="10066" y="-419.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_12_gelu&#45;&gt;expert_12_linear2 -->
<g id="edge59" class="edge">
<title>expert_12_gelu&#45;&gt;expert_12_linear2</title>
<path fill="none" stroke="black" d="M10066,-501.53C10066,-493.29 10066,-484.03 10066,-475.23"/>
<polygon fill="black" stroke="black" points="10069.5,-475.19 10066,-465.19 10062.5,-475.19 10069.5,-475.19"/>
</g>
<!-- expert_12_linear2&#45;&gt;expert_aggregate -->
<g id="edge60" class="edge">
<title>expert_12_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9671.96,-412.39C9668.96,-412.24 9665.98,-412.09 9663,-411.95 8797.54,-370.76 7800.62,-341.75 7147.02,-325.23"/>
<polygon fill="black" stroke="black" points="7147.03,-321.73 7136.94,-324.97 7146.85,-328.73 7147.03,-321.73"/>
<text text-anchor="middle" x="9289.5" y="-382.75" font-family="Times,serif" font-size="14.00">recv from GPU 12</text>
</g>
<!-- expert_13_gelu -->
<g id="node50" class="node">
<title>expert_13_gelu</title>
<polygon fill="lightgreen" stroke="black" points="11254,-554.95 10490,-554.95 10490,-501.95 11254,-501.95 11254,-554.95"/>
<text text-anchor="middle" x="10872" y="-539.75" font-family="Times,serif" font-size="14.00">Expert 13 GELU</text>
<text text-anchor="middle" x="10872" y="-524.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="10872" y="-509.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_13_linear1&#45;&gt;expert_13_gelu -->
<g id="edge62" class="edge">
<title>expert_13_linear1&#45;&gt;expert_13_gelu</title>
<path fill="none" stroke="black" d="M10872,-591.53C10872,-583.29 10872,-574.03 10872,-565.23"/>
<polygon fill="black" stroke="black" points="10875.5,-565.19 10872,-555.19 10868.5,-565.19 10875.5,-565.19"/>
</g>
<!-- expert_13_linear2 -->
<g id="node51" class="node">
<title>expert_13_linear2</title>
<polygon fill="lightblue" stroke="black" points="11266,-464.95 10478,-464.95 10478,-411.95 11266,-411.95 11266,-464.95"/>
<text text-anchor="middle" x="10872" y="-449.75" font-family="Times,serif" font-size="14.00">Expert 13 Linear 2</text>
<text text-anchor="middle" x="10872" y="-434.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="10872" y="-419.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_13_gelu&#45;&gt;expert_13_linear2 -->
<g id="edge63" class="edge">
<title>expert_13_gelu&#45;&gt;expert_13_linear2</title>
<path fill="none" stroke="black" d="M10872,-501.53C10872,-493.29 10872,-484.03 10872,-475.23"/>
<polygon fill="black" stroke="black" points="10875.5,-475.19 10872,-465.19 10868.5,-475.19 10875.5,-475.19"/>
</g>
<!-- expert_13_linear2&#45;&gt;expert_aggregate -->
<g id="edge64" class="edge">
<title>expert_13_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10477.96,-412.38C10474.96,-412.23 10471.98,-412.09 10469,-411.95 9975.54,-389.02 9851.82,-392.21 9358,-378.95 8602.72,-358.68 7737.48,-338.3 7146.12,-324.79"/>
<polygon fill="black" stroke="black" points="7145.77,-321.29 7135.69,-324.56 7145.61,-328.28 7145.77,-321.29"/>
<text text-anchor="middle" x="10053.5" y="-382.75" font-family="Times,serif" font-size="14.00">recv from GPU 13</text>
</g>
<!-- expert_14_gelu -->
<g id="node53" class="node">
<title>expert_14_gelu</title>
<polygon fill="lightgreen" stroke="black" points="12060,-554.95 11296,-554.95 11296,-501.95 12060,-501.95 12060,-554.95"/>
<text text-anchor="middle" x="11678" y="-539.75" font-family="Times,serif" font-size="14.00">Expert 14 GELU</text>
<text text-anchor="middle" x="11678" y="-524.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="11678" y="-509.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_14_linear1&#45;&gt;expert_14_gelu -->
<g id="edge66" class="edge">
<title>expert_14_linear1&#45;&gt;expert_14_gelu</title>
<path fill="none" stroke="black" d="M11678,-591.53C11678,-583.29 11678,-574.03 11678,-565.23"/>
<polygon fill="black" stroke="black" points="11681.5,-565.19 11678,-555.19 11674.5,-565.19 11681.5,-565.19"/>
</g>
<!-- expert_14_linear2 -->
<g id="node54" class="node">
<title>expert_14_linear2</title>
<polygon fill="lightblue" stroke="black" points="12072,-464.95 11284,-464.95 11284,-411.95 12072,-411.95 12072,-464.95"/>
<text text-anchor="middle" x="11678" y="-449.75" font-family="Times,serif" font-size="14.00">Expert 14 Linear 2</text>
<text text-anchor="middle" x="11678" y="-434.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="11678" y="-419.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_14_gelu&#45;&gt;expert_14_linear2 -->
<g id="edge67" class="edge">
<title>expert_14_gelu&#45;&gt;expert_14_linear2</title>
<path fill="none" stroke="black" d="M11678,-501.53C11678,-493.29 11678,-484.03 11678,-475.23"/>
<polygon fill="black" stroke="black" points="11681.5,-475.19 11678,-465.19 11674.5,-475.19 11681.5,-475.19"/>
</g>
<!-- expert_14_linear2&#45;&gt;expert_aggregate -->
<g id="edge68" class="edge">
<title>expert_14_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11283.96,-412.37C11280.96,-412.23 11277.98,-412.09 11275,-411.95 10762.89,-388.43 10634.51,-391.16 10122,-378.95 9079.92,-354.14 7871.86,-332.55 7131.32,-320.14"/>
<polygon fill="black" stroke="black" points="7131.32,-316.64 7121.26,-319.97 7131.2,-323.64 7131.32,-316.64"/>
<text text-anchor="middle" x="10859.5" y="-382.75" font-family="Times,serif" font-size="14.00">recv from GPU 14</text>
</g>
<!-- expert_15_gelu -->
<g id="node56" class="node">
<title>expert_15_gelu</title>
<polygon fill="lightgreen" stroke="black" points="12866,-554.95 12102,-554.95 12102,-501.95 12866,-501.95 12866,-554.95"/>
<text text-anchor="middle" x="12484" y="-539.75" font-family="Times,serif" font-size="14.00">Expert 15 GELU</text>
<text text-anchor="middle" x="12484" y="-524.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, hidden=2048]</text>
<text text-anchor="middle" x="12484" y="-509.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_15_linear1&#45;&gt;expert_15_gelu -->
<g id="edge70" class="edge">
<title>expert_15_linear1&#45;&gt;expert_15_gelu</title>
<path fill="none" stroke="black" d="M12484,-591.53C12484,-583.29 12484,-574.03 12484,-565.23"/>
<polygon fill="black" stroke="black" points="12487.5,-565.19 12484,-555.19 12480.5,-565.19 12487.5,-565.19"/>
</g>
<!-- expert_15_linear2 -->
<g id="node57" class="node">
<title>expert_15_linear2</title>
<polygon fill="lightblue" stroke="black" points="12878,-464.95 12090,-464.95 12090,-411.95 12878,-411.95 12878,-464.95"/>
<text text-anchor="middle" x="12484" y="-449.75" font-family="Times,serif" font-size="14.00">Expert 15 Linear 2</text>
<text text-anchor="middle" x="12484" y="-434.75" font-family="Times,serif" font-size="14.00">[batch_size=32, tokens_per_expert, hidden=2048] &#45;&gt; [batch_size=32, tokens_per_expert, token_dim=7168]</text>
<text text-anchor="middle" x="12484" y="-419.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_15_gelu&#45;&gt;expert_15_linear2 -->
<g id="edge71" class="edge">
<title>expert_15_gelu&#45;&gt;expert_15_linear2</title>
<path fill="none" stroke="black" d="M12484,-501.53C12484,-493.29 12484,-484.03 12484,-475.23"/>
<polygon fill="black" stroke="black" points="12487.5,-475.19 12484,-465.19 12480.5,-475.19 12487.5,-475.19"/>
</g>
<!-- expert_15_linear2&#45;&gt;expert_aggregate -->
<g id="edge72" class="edge">
<title>expert_15_linear2&#45;&gt;expert_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12089.96,-412.37C12086.96,-412.23 12083.98,-412.09 12081,-411.95 11568.89,-388.43 11440.53,-390.28 10928,-378.95 9578.89,-349.13 8001.47,-327.64 7121.26,-316.84"/>
<polygon fill="black" stroke="black" points="7121.3,-313.34 7111.26,-316.72 7121.21,-320.34 7121.3,-313.34"/>
<text text-anchor="middle" x="11665.5" y="-382.75" font-family="Times,serif" font-size="14.00">recv from GPU 15</text>
</g>
<!-- residual2 -->
<g id="node59" class="node">
<title>residual2</title>
<polygon fill="purple" stroke="black" points="6823.84,-217.95 6210.05,-217.95 6052.16,-111.95 6665.95,-111.95 6823.84,-217.95"/>
<text text-anchor="middle" x="6438" y="-176.25" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="6438" y="-161.25" font-family="Times,serif" font-size="14.00">[batch_size=32, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="6438" y="-146.25" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_aggregate&#45;&gt;residual2 -->
<g id="edge73" class="edge">
<title>expert_aggregate&#45;&gt;residual2</title>
<path fill="none" stroke="black" d="M6438,-254.85C6438,-246.28 6438,-237.32 6438,-228.53"/>
<polygon fill="black" stroke="black" points="6441.5,-228.31 6438,-218.31 6434.5,-228.31 6441.5,-228.31"/>
</g>
<!-- output -->
<g id="node60" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="6438" cy="-37.48" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="6438" y="-48.78" font-family="Times,serif" font-size="14.00">Layer Output</text>
<text text-anchor="middle" x="6438" y="-33.78" font-family="Times,serif" font-size="14.00">[batch_size=32, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="6438" y="-18.78" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- residual2&#45;&gt;output -->
<g id="edge74" class="edge">
<title>residual2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M6438,-111.83C6438,-102.93 6438,-93.73 6438,-84.98"/>
<polygon fill="black" stroke="black" points="6441.5,-84.96 6438,-74.96 6434.5,-84.96 6441.5,-84.96"/>
</g>
</g>
</svg>
