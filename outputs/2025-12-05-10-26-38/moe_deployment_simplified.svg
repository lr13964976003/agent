<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="7916pt" height="1174pt"
 viewBox="0.00 0.00 7916.40 1173.72" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1169.72)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1169.72 7912.4,-1169.72 7912.4,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<path fill="lightblue" stroke="black" d="M36.4,-306.35C36.4,-306.35 3490.4,-306.35 3490.4,-306.35 3496.4,-306.35 3502.4,-312.35 3502.4,-318.35 3502.4,-318.35 3502.4,-895.98 3502.4,-895.98 3502.4,-901.98 3496.4,-907.98 3490.4,-907.98 3490.4,-907.98 36.4,-907.98 36.4,-907.98 30.4,-907.98 24.4,-901.98 24.4,-895.98 24.4,-895.98 24.4,-318.35 24.4,-318.35 24.4,-312.35 30.4,-306.35 36.4,-306.35"/>
<text text-anchor="middle" x="1763.4" y="-892.78" font-family="Times,serif" font-size="14.00">Stage 0: GPUs 0&#45;3</text>
<text text-anchor="middle" x="1763.4" y="-877.78" font-family="Times,serif" font-size="14.00">Layers 0&#45;3</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage1</title>
<path fill="lightgreen" stroke="black" d="M3570.4,-610.86C3570.4,-610.86 7839.4,-610.86 7839.4,-610.86 7845.4,-610.86 7851.4,-616.86 7851.4,-622.86 7851.4,-622.86 7851.4,-727.81 7851.4,-727.81 7851.4,-733.81 7845.4,-739.81 7839.4,-739.81 7839.4,-739.81 3570.4,-739.81 3570.4,-739.81 3564.4,-739.81 3558.4,-733.81 3558.4,-727.81 3558.4,-727.81 3558.4,-622.86 3558.4,-622.86 3558.4,-616.86 3564.4,-610.86 3570.4,-610.86"/>
<text text-anchor="middle" x="5704.9" y="-724.61" font-family="Times,serif" font-size="14.00">Stage 1: GPUs 4&#45;7</text>
<text text-anchor="middle" x="5704.9" y="-709.61" font-family="Times,serif" font-size="14.00">Layers 4&#45;7</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_stage2</title>
<path fill="lightyellow" stroke="black" d="M3546.4,-453.3C3546.4,-453.3 7864.4,-453.3 7864.4,-453.3 7870.4,-453.3 7876.4,-459.3 7876.4,-465.3 7876.4,-465.3 7876.4,-570.25 7876.4,-570.25 7876.4,-576.25 7870.4,-582.25 7864.4,-582.25 7864.4,-582.25 3546.4,-582.25 3546.4,-582.25 3540.4,-582.25 3534.4,-576.25 3534.4,-570.25 3534.4,-570.25 3534.4,-465.3 3534.4,-465.3 3534.4,-459.3 3540.4,-453.3 3546.4,-453.3"/>
<text text-anchor="middle" x="5705.4" y="-567.05" font-family="Times,serif" font-size="14.00">Stage 2: GPUs 8&#45;11</text>
<text text-anchor="middle" x="5705.4" y="-552.05" font-family="Times,serif" font-size="14.00">Layers 8&#45;11</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_stage3</title>
<path fill="lightcoral" stroke="black" d="M3522.4,-295.74C3522.4,-295.74 7888.4,-295.74 7888.4,-295.74 7894.4,-295.74 7900.4,-301.74 7900.4,-307.74 7900.4,-307.74 7900.4,-412.69 7900.4,-412.69 7900.4,-418.69 7894.4,-424.69 7888.4,-424.69 7888.4,-424.69 3522.4,-424.69 3522.4,-424.69 3516.4,-424.69 3510.4,-418.69 3510.4,-412.69 3510.4,-412.69 3510.4,-307.74 3510.4,-307.74 3510.4,-301.74 3516.4,-295.74 3522.4,-295.74"/>
<text text-anchor="middle" x="5705.4" y="-409.49" font-family="Times,serif" font-size="14.00">Stage 3: GPUs 12&#45;15</text>
<text text-anchor="middle" x="5705.4" y="-394.49" font-family="Times,serif" font-size="14.00">Layers 12&#45;15</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="none" stroke="black" cx="152.4" cy="-1138.85" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="152.4" y="-1142.65" font-family="Times,serif" font-size="14.00">Input Batch</text>
<text text-anchor="middle" x="152.4" y="-1127.65" font-family="Times,serif" font-size="14.00">[128, 1024, 1024]</text>
</g>
<!-- dp_split -->
<g id="node2" class="node">
<title>dp_split</title>
<polygon fill="none" stroke="black" points="304.71,-1039.98 62.42,-1039.98 0.1,-933.98 242.38,-933.98 304.71,-1039.98"/>
<text text-anchor="middle" x="152.4" y="-998.28" font-family="Times,serif" font-size="14.00">Data Parallel Split</text>
<text text-anchor="middle" x="152.4" y="-983.28" font-family="Times,serif" font-size="14.00">→ 2 groups of 64</text>
<text text-anchor="middle" x="152.4" y="-968.28" font-family="Times,serif" font-size="14.00">[64, 1024, 1024]</text>
</g>
<!-- input&#45;&gt;dp_split -->
<g id="edge1" class="edge">
<title>input&#45;&gt;dp_split</title>
<path fill="none" stroke="black" d="M152.4,-1111.7C152.4,-1111.7 152.4,-1050.01 152.4,-1050.01"/>
<polygon fill="black" stroke="black" points="155.9,-1050.01 152.4,-1040.01 148.9,-1050.01 155.9,-1050.01"/>
</g>
<!-- s0_l0_attn -->
<g id="node3" class="node">
<title>s0_l0_attn</title>
<ellipse fill="none" stroke="black" cx="152.4" cy="-813.9" rx="120.42" ry="48.17"/>
<text text-anchor="middle" x="152.4" y="-832.7" font-family="Times,serif" font-size="14.00">Layer 0 Attention</text>
<text text-anchor="middle" x="152.4" y="-817.7" font-family="Times,serif" font-size="14.00">4&#45;way Tensor Parallel</text>
<text text-anchor="middle" x="152.4" y="-802.7" font-family="Times,serif" font-size="14.00">QKV→Scores→Output</text>
<text text-anchor="middle" x="152.4" y="-787.7" font-family="Times,serif" font-size="14.00">GPU: 0,1,2,3</text>
</g>
<!-- dp_split&#45;&gt;s0_l0_attn -->
<g id="edge2" class="edge">
<title>dp_split&#45;&gt;s0_l0_attn</title>
<path fill="none" stroke="black" d="M152.4,-933.64C152.4,-933.64 152.4,-872.06 152.4,-872.06"/>
<polygon fill="black" stroke="black" points="155.9,-872.06 152.4,-862.06 148.9,-872.06 155.9,-872.06"/>
</g>
<!-- s0_l0_attn_comm -->
<g id="node4" class="node">
<title>s0_l0_attn_comm</title>
<ellipse fill="none" stroke="black" cx="155.4" cy="-656.34" rx="115.93" ry="26.74"/>
<text text-anchor="middle" x="155.4" y="-660.14" font-family="Times,serif" font-size="14.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="155.4" y="-645.14" font-family="Times,serif" font-size="14.00">GPU: 0,1,2,3</text>
</g>
<!-- s0_l0_attn&#45;&gt;s0_l0_attn_comm -->
<g id="edge3" class="edge">
<title>s0_l0_attn&#45;&gt;s0_l0_attn_comm</title>
<path fill="none" stroke="black" d="M155.4,-765.77C155.4,-765.77 155.4,-693.57 155.4,-693.57"/>
<polygon fill="black" stroke="black" points="158.9,-693.57 155.4,-683.57 151.9,-693.57 158.9,-693.57"/>
</g>
<!-- s0_l0_moe -->
<g id="node5" class="node">
<title>s0_l0_moe</title>
<ellipse fill="none" stroke="black" cx="159.4" cy="-498.78" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="159.4" y="-517.58" font-family="Times,serif" font-size="14.00">Layer 0 MoE</text>
<text text-anchor="middle" x="159.4" y="-502.58" font-family="Times,serif" font-size="14.00">16&#45;way Expert Parallel</text>
<text text-anchor="middle" x="159.4" y="-487.58" font-family="Times,serif" font-size="14.00">4 experts per GPU</text>
<text text-anchor="middle" x="159.4" y="-472.58" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s0_l0_attn_comm&#45;&gt;s0_l0_moe -->
<g id="edge4" class="edge">
<title>s0_l0_attn_comm&#45;&gt;s0_l0_moe</title>
<path fill="none" stroke="black" d="M155.4,-629.25C155.4,-629.25 155.4,-557.12 155.4,-557.12"/>
<polygon fill="black" stroke="black" points="158.9,-557.12 155.4,-547.12 151.9,-557.12 158.9,-557.12"/>
</g>
<!-- s0_l0_moe_comm -->
<g id="node6" class="node">
<title>s0_l0_moe_comm</title>
<ellipse fill="none" stroke="black" cx="159.4" cy="-341.22" rx="81.13" ry="26.74"/>
<text text-anchor="middle" x="159.4" y="-345.02" font-family="Times,serif" font-size="14.00">MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="159.4" y="-330.02" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s0_l0_moe&#45;&gt;s0_l0_moe_comm -->
<g id="edge5" class="edge">
<title>s0_l0_moe&#45;&gt;s0_l0_moe_comm</title>
<path fill="none" stroke="black" d="M159.4,-450.65C159.4,-450.65 159.4,-378.45 159.4,-378.45"/>
<polygon fill="black" stroke="black" points="162.9,-378.45 159.4,-368.45 155.9,-378.45 162.9,-378.45"/>
</g>
<!-- s0_l1_attn -->
<g id="node7" class="node">
<title>s0_l1_attn</title>
<ellipse fill="none" stroke="black" cx="3111.4" cy="-813.9" rx="120.42" ry="37.45"/>
<text text-anchor="middle" x="3111.4" y="-825.2" font-family="Times,serif" font-size="14.00">Layer 1 Attention</text>
<text text-anchor="middle" x="3111.4" y="-810.2" font-family="Times,serif" font-size="14.00">4&#45;way Tensor Parallel</text>
<text text-anchor="middle" x="3111.4" y="-795.2" font-family="Times,serif" font-size="14.00">GPU: 0,1,2,3</text>
</g>
<!-- s0_l1_attn_comm -->
<g id="node8" class="node">
<title>s0_l1_attn_comm</title>
<ellipse fill="none" stroke="black" cx="2841.4" cy="-813.9" rx="131.54" ry="26.74"/>
<text text-anchor="middle" x="2841.4" y="-817.7" font-family="Times,serif" font-size="14.00">Layer 1 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="2841.4" y="-802.7" font-family="Times,serif" font-size="14.00">GPU: 0,1,2,3</text>
</g>
<!-- s0_l1_moe -->
<g id="node9" class="node">
<title>s0_l1_moe</title>
<ellipse fill="none" stroke="black" cx="2565.4" cy="-813.9" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="2565.4" y="-825.2" font-family="Times,serif" font-size="14.00">Layer 1 MoE</text>
<text text-anchor="middle" x="2565.4" y="-810.2" font-family="Times,serif" font-size="14.00">16&#45;way Expert Parallel</text>
<text text-anchor="middle" x="2565.4" y="-795.2" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s0_l1_moe_comm -->
<g id="node10" class="node">
<title>s0_l1_moe_comm</title>
<ellipse fill="none" stroke="black" cx="2298.4" cy="-813.9" rx="122.16" ry="26.74"/>
<text text-anchor="middle" x="2298.4" y="-817.7" font-family="Times,serif" font-size="14.00">Layer 1 MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="2298.4" y="-802.7" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s0_l2_attn -->
<g id="node11" class="node">
<title>s0_l2_attn</title>
<ellipse fill="none" stroke="black" cx="2037.4" cy="-813.9" rx="120.42" ry="37.45"/>
<text text-anchor="middle" x="2037.4" y="-825.2" font-family="Times,serif" font-size="14.00">Layer 2 Attention</text>
<text text-anchor="middle" x="2037.4" y="-810.2" font-family="Times,serif" font-size="14.00">4&#45;way Tensor Parallel</text>
<text text-anchor="middle" x="2037.4" y="-795.2" font-family="Times,serif" font-size="14.00">GPU: 0,1,2,3</text>
</g>
<!-- s0_l2_attn_comm -->
<g id="node12" class="node">
<title>s0_l2_attn_comm</title>
<ellipse fill="none" stroke="black" cx="1767.4" cy="-813.9" rx="131.54" ry="26.74"/>
<text text-anchor="middle" x="1767.4" y="-817.7" font-family="Times,serif" font-size="14.00">Layer 2 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="1767.4" y="-802.7" font-family="Times,serif" font-size="14.00">GPU: 0,1,2,3</text>
</g>
<!-- s0_l2_moe -->
<g id="node13" class="node">
<title>s0_l2_moe</title>
<ellipse fill="none" stroke="black" cx="1491.4" cy="-813.9" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="1491.4" y="-825.2" font-family="Times,serif" font-size="14.00">Layer 2 MoE</text>
<text text-anchor="middle" x="1491.4" y="-810.2" font-family="Times,serif" font-size="14.00">16&#45;way Expert Parallel</text>
<text text-anchor="middle" x="1491.4" y="-795.2" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s0_l2_moe_comm -->
<g id="node14" class="node">
<title>s0_l2_moe_comm</title>
<ellipse fill="none" stroke="black" cx="1224.4" cy="-813.9" rx="122.16" ry="26.74"/>
<text text-anchor="middle" x="1224.4" y="-817.7" font-family="Times,serif" font-size="14.00">Layer 2 MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="1224.4" y="-802.7" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s0_l3_attn -->
<g id="node15" class="node">
<title>s0_l3_attn</title>
<ellipse fill="none" stroke="black" cx="963.4" cy="-813.9" rx="120.42" ry="37.45"/>
<text text-anchor="middle" x="963.4" y="-825.2" font-family="Times,serif" font-size="14.00">Layer 3 Attention</text>
<text text-anchor="middle" x="963.4" y="-810.2" font-family="Times,serif" font-size="14.00">4&#45;way Tensor Parallel</text>
<text text-anchor="middle" x="963.4" y="-795.2" font-family="Times,serif" font-size="14.00">GPU: 0,1,2,3</text>
</g>
<!-- s0_l3_attn_comm -->
<g id="node16" class="node">
<title>s0_l3_attn_comm</title>
<ellipse fill="none" stroke="black" cx="693.4" cy="-813.9" rx="131.54" ry="26.74"/>
<text text-anchor="middle" x="693.4" y="-817.7" font-family="Times,serif" font-size="14.00">Layer 3 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="693.4" y="-802.7" font-family="Times,serif" font-size="14.00">GPU: 0,1,2,3</text>
</g>
<!-- s0_l3_moe -->
<g id="node17" class="node">
<title>s0_l3_moe</title>
<ellipse fill="none" stroke="black" cx="417.4" cy="-813.9" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="417.4" y="-825.2" font-family="Times,serif" font-size="14.00">Layer 3 MoE</text>
<text text-anchor="middle" x="417.4" y="-810.2" font-family="Times,serif" font-size="14.00">16&#45;way Expert Parallel</text>
<text text-anchor="middle" x="417.4" y="-795.2" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s0_l3_moe_comm -->
<g id="node18" class="node">
<title>s0_l3_moe_comm</title>
<ellipse fill="none" stroke="black" cx="3372.4" cy="-813.9" rx="122.16" ry="26.74"/>
<text text-anchor="middle" x="3372.4" y="-817.7" font-family="Times,serif" font-size="14.00">Layer 3 MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="3372.4" y="-802.7" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s1_l4_attn -->
<g id="node19" class="node">
<title>s1_l4_attn</title>
<ellipse fill="none" stroke="black" cx="7723.4" cy="-656.34" rx="120.42" ry="37.45"/>
<text text-anchor="middle" x="7723.4" y="-667.64" font-family="Times,serif" font-size="14.00">Layer 4 Attention</text>
<text text-anchor="middle" x="7723.4" y="-652.64" font-family="Times,serif" font-size="14.00">4&#45;way Tensor Parallel</text>
<text text-anchor="middle" x="7723.4" y="-637.64" font-family="Times,serif" font-size="14.00">GPU: 4,5,6,7</text>
</g>
<!-- s0_l3_moe_comm&#45;&gt;s1_l4_attn -->
<g id="edge6" class="edge">
<title>s0_l3_moe_comm&#45;&gt;s1_l4_attn</title>
<path fill="none" stroke="black" d="M3494.75,-813C4200.81,-813 7723.4,-813 7723.4,-813 7723.4,-813 7723.4,-703.86 7723.4,-703.86"/>
<polygon fill="black" stroke="black" points="7726.9,-703.86 7723.4,-693.86 7719.9,-703.86 7726.9,-703.86"/>
</g>
<!-- s1_l4_attn_comm -->
<g id="node20" class="node">
<title>s1_l4_attn_comm</title>
<ellipse fill="none" stroke="black" cx="7453.4" cy="-656.34" rx="131.54" ry="26.74"/>
<text text-anchor="middle" x="7453.4" y="-660.14" font-family="Times,serif" font-size="14.00">Layer 4 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="7453.4" y="-645.14" font-family="Times,serif" font-size="14.00">GPU: 4,5,6,7</text>
</g>
<!-- s1_l4_moe -->
<g id="node21" class="node">
<title>s1_l4_moe</title>
<ellipse fill="none" stroke="black" cx="7177.4" cy="-656.34" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="7177.4" y="-667.64" font-family="Times,serif" font-size="14.00">Layer 4 MoE</text>
<text text-anchor="middle" x="7177.4" y="-652.64" font-family="Times,serif" font-size="14.00">16&#45;way Expert Parallel</text>
<text text-anchor="middle" x="7177.4" y="-637.64" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s1_l4_moe_comm -->
<g id="node22" class="node">
<title>s1_l4_moe_comm</title>
<ellipse fill="none" stroke="black" cx="6910.4" cy="-656.34" rx="122.16" ry="26.74"/>
<text text-anchor="middle" x="6910.4" y="-660.14" font-family="Times,serif" font-size="14.00">Layer 4 MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="6910.4" y="-645.14" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s1_l5_attn -->
<g id="node23" class="node">
<title>s1_l5_attn</title>
<ellipse fill="none" stroke="black" cx="6649.4" cy="-656.34" rx="120.42" ry="37.45"/>
<text text-anchor="middle" x="6649.4" y="-667.64" font-family="Times,serif" font-size="14.00">Layer 5 Attention</text>
<text text-anchor="middle" x="6649.4" y="-652.64" font-family="Times,serif" font-size="14.00">4&#45;way Tensor Parallel</text>
<text text-anchor="middle" x="6649.4" y="-637.64" font-family="Times,serif" font-size="14.00">GPU: 4,5,6,7</text>
</g>
<!-- s1_l5_attn_comm -->
<g id="node24" class="node">
<title>s1_l5_attn_comm</title>
<ellipse fill="none" stroke="black" cx="6379.4" cy="-656.34" rx="131.54" ry="26.74"/>
<text text-anchor="middle" x="6379.4" y="-660.14" font-family="Times,serif" font-size="14.00">Layer 5 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="6379.4" y="-645.14" font-family="Times,serif" font-size="14.00">GPU: 4,5,6,7</text>
</g>
<!-- s1_l5_moe -->
<g id="node25" class="node">
<title>s1_l5_moe</title>
<ellipse fill="none" stroke="black" cx="6103.4" cy="-656.34" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="6103.4" y="-667.64" font-family="Times,serif" font-size="14.00">Layer 5 MoE</text>
<text text-anchor="middle" x="6103.4" y="-652.64" font-family="Times,serif" font-size="14.00">16&#45;way Expert Parallel</text>
<text text-anchor="middle" x="6103.4" y="-637.64" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s1_l5_moe_comm -->
<g id="node26" class="node">
<title>s1_l5_moe_comm</title>
<ellipse fill="none" stroke="black" cx="5836.4" cy="-656.34" rx="122.16" ry="26.74"/>
<text text-anchor="middle" x="5836.4" y="-660.14" font-family="Times,serif" font-size="14.00">Layer 5 MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="5836.4" y="-645.14" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s1_l6_attn -->
<g id="node27" class="node">
<title>s1_l6_attn</title>
<ellipse fill="none" stroke="black" cx="5575.4" cy="-656.34" rx="120.42" ry="37.45"/>
<text text-anchor="middle" x="5575.4" y="-667.64" font-family="Times,serif" font-size="14.00">Layer 6 Attention</text>
<text text-anchor="middle" x="5575.4" y="-652.64" font-family="Times,serif" font-size="14.00">4&#45;way Tensor Parallel</text>
<text text-anchor="middle" x="5575.4" y="-637.64" font-family="Times,serif" font-size="14.00">GPU: 4,5,6,7</text>
</g>
<!-- s1_l6_attn_comm -->
<g id="node28" class="node">
<title>s1_l6_attn_comm</title>
<ellipse fill="none" stroke="black" cx="5305.4" cy="-656.34" rx="131.54" ry="26.74"/>
<text text-anchor="middle" x="5305.4" y="-660.14" font-family="Times,serif" font-size="14.00">Layer 6 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="5305.4" y="-645.14" font-family="Times,serif" font-size="14.00">GPU: 4,5,6,7</text>
</g>
<!-- s1_l6_moe -->
<g id="node29" class="node">
<title>s1_l6_moe</title>
<ellipse fill="none" stroke="black" cx="5029.4" cy="-656.34" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="5029.4" y="-667.64" font-family="Times,serif" font-size="14.00">Layer 6 MoE</text>
<text text-anchor="middle" x="5029.4" y="-652.64" font-family="Times,serif" font-size="14.00">16&#45;way Expert Parallel</text>
<text text-anchor="middle" x="5029.4" y="-637.64" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s1_l6_moe_comm -->
<g id="node30" class="node">
<title>s1_l6_moe_comm</title>
<ellipse fill="none" stroke="black" cx="4762.4" cy="-656.34" rx="122.16" ry="26.74"/>
<text text-anchor="middle" x="4762.4" y="-660.14" font-family="Times,serif" font-size="14.00">Layer 6 MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="4762.4" y="-645.14" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s1_l7_attn -->
<g id="node31" class="node">
<title>s1_l7_attn</title>
<ellipse fill="none" stroke="black" cx="4501.4" cy="-656.34" rx="120.42" ry="37.45"/>
<text text-anchor="middle" x="4501.4" y="-667.64" font-family="Times,serif" font-size="14.00">Layer 7 Attention</text>
<text text-anchor="middle" x="4501.4" y="-652.64" font-family="Times,serif" font-size="14.00">4&#45;way Tensor Parallel</text>
<text text-anchor="middle" x="4501.4" y="-637.64" font-family="Times,serif" font-size="14.00">GPU: 4,5,6,7</text>
</g>
<!-- s1_l7_attn_comm -->
<g id="node32" class="node">
<title>s1_l7_attn_comm</title>
<ellipse fill="none" stroke="black" cx="4231.4" cy="-656.34" rx="131.54" ry="26.74"/>
<text text-anchor="middle" x="4231.4" y="-660.14" font-family="Times,serif" font-size="14.00">Layer 7 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="4231.4" y="-645.14" font-family="Times,serif" font-size="14.00">GPU: 4,5,6,7</text>
</g>
<!-- s1_l7_moe -->
<g id="node33" class="node">
<title>s1_l7_moe</title>
<ellipse fill="none" stroke="black" cx="3955.4" cy="-656.34" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="3955.4" y="-667.64" font-family="Times,serif" font-size="14.00">Layer 7 MoE</text>
<text text-anchor="middle" x="3955.4" y="-652.64" font-family="Times,serif" font-size="14.00">16&#45;way Expert Parallel</text>
<text text-anchor="middle" x="3955.4" y="-637.64" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s1_l7_moe_comm -->
<g id="node34" class="node">
<title>s1_l7_moe_comm</title>
<ellipse fill="none" stroke="black" cx="3688.4" cy="-656.34" rx="122.16" ry="26.74"/>
<text text-anchor="middle" x="3688.4" y="-660.14" font-family="Times,serif" font-size="14.00">Layer 7 MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="3688.4" y="-645.14" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s2_l8_attn -->
<g id="node35" class="node">
<title>s2_l8_attn</title>
<ellipse fill="none" stroke="black" cx="7748.4" cy="-498.78" rx="120.42" ry="37.45"/>
<text text-anchor="middle" x="7748.4" y="-510.08" font-family="Times,serif" font-size="14.00">Layer 8 Attention</text>
<text text-anchor="middle" x="7748.4" y="-495.08" font-family="Times,serif" font-size="14.00">4&#45;way Tensor Parallel</text>
<text text-anchor="middle" x="7748.4" y="-480.08" font-family="Times,serif" font-size="14.00">GPU: 8,9,10,11</text>
</g>
<!-- s1_l7_moe_comm&#45;&gt;s2_l8_attn -->
<g id="edge7" class="edge">
<title>s1_l7_moe_comm&#45;&gt;s2_l8_attn</title>
<path fill="none" stroke="black" d="M3805.41,-648.19C3805.41,-610.53 3805.41,-455 3805.41,-455 3805.41,-455 7643.24,-455 7643.24,-455 7643.24,-455 7643.24,-470.47 7643.24,-470.47"/>
<polygon fill="black" stroke="black" points="7639.74,-470.47 7643.24,-480.47 7646.74,-470.47 7639.74,-470.47"/>
</g>
<!-- s2_l8_attn_comm -->
<g id="node36" class="node">
<title>s2_l8_attn_comm</title>
<ellipse fill="none" stroke="black" cx="7478.4" cy="-498.78" rx="131.54" ry="26.74"/>
<text text-anchor="middle" x="7478.4" y="-502.58" font-family="Times,serif" font-size="14.00">Layer 8 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="7478.4" y="-487.58" font-family="Times,serif" font-size="14.00">GPU: 8,9,10,11</text>
</g>
<!-- s2_l8_moe -->
<g id="node37" class="node">
<title>s2_l8_moe</title>
<ellipse fill="none" stroke="black" cx="7202.4" cy="-498.78" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="7202.4" y="-510.08" font-family="Times,serif" font-size="14.00">Layer 8 MoE</text>
<text text-anchor="middle" x="7202.4" y="-495.08" font-family="Times,serif" font-size="14.00">16&#45;way Expert Parallel</text>
<text text-anchor="middle" x="7202.4" y="-480.08" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s2_l8_moe_comm -->
<g id="node38" class="node">
<title>s2_l8_moe_comm</title>
<ellipse fill="none" stroke="black" cx="6935.4" cy="-498.78" rx="122.16" ry="26.74"/>
<text text-anchor="middle" x="6935.4" y="-502.58" font-family="Times,serif" font-size="14.00">Layer 8 MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="6935.4" y="-487.58" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s2_l9_attn -->
<g id="node39" class="node">
<title>s2_l9_attn</title>
<ellipse fill="none" stroke="black" cx="6674.4" cy="-498.78" rx="120.42" ry="37.45"/>
<text text-anchor="middle" x="6674.4" y="-510.08" font-family="Times,serif" font-size="14.00">Layer 9 Attention</text>
<text text-anchor="middle" x="6674.4" y="-495.08" font-family="Times,serif" font-size="14.00">4&#45;way Tensor Parallel</text>
<text text-anchor="middle" x="6674.4" y="-480.08" font-family="Times,serif" font-size="14.00">GPU: 8,9,10,11</text>
</g>
<!-- s2_l9_attn_comm -->
<g id="node40" class="node">
<title>s2_l9_attn_comm</title>
<ellipse fill="none" stroke="black" cx="6404.4" cy="-498.78" rx="131.54" ry="26.74"/>
<text text-anchor="middle" x="6404.4" y="-502.58" font-family="Times,serif" font-size="14.00">Layer 9 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="6404.4" y="-487.58" font-family="Times,serif" font-size="14.00">GPU: 8,9,10,11</text>
</g>
<!-- s2_l9_moe -->
<g id="node41" class="node">
<title>s2_l9_moe</title>
<ellipse fill="none" stroke="black" cx="6128.4" cy="-498.78" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="6128.4" y="-510.08" font-family="Times,serif" font-size="14.00">Layer 9 MoE</text>
<text text-anchor="middle" x="6128.4" y="-495.08" font-family="Times,serif" font-size="14.00">16&#45;way Expert Parallel</text>
<text text-anchor="middle" x="6128.4" y="-480.08" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s2_l9_moe_comm -->
<g id="node42" class="node">
<title>s2_l9_moe_comm</title>
<ellipse fill="none" stroke="black" cx="5861.4" cy="-498.78" rx="122.16" ry="26.74"/>
<text text-anchor="middle" x="5861.4" y="-502.58" font-family="Times,serif" font-size="14.00">Layer 9 MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="5861.4" y="-487.58" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s2_l10_attn -->
<g id="node43" class="node">
<title>s2_l10_attn</title>
<ellipse fill="none" stroke="black" cx="5600.4" cy="-498.78" rx="120.42" ry="37.45"/>
<text text-anchor="middle" x="5600.4" y="-510.08" font-family="Times,serif" font-size="14.00">Layer 10 Attention</text>
<text text-anchor="middle" x="5600.4" y="-495.08" font-family="Times,serif" font-size="14.00">4&#45;way Tensor Parallel</text>
<text text-anchor="middle" x="5600.4" y="-480.08" font-family="Times,serif" font-size="14.00">GPU: 8,9,10,11</text>
</g>
<!-- s2_l10_attn_comm -->
<g id="node44" class="node">
<title>s2_l10_attn_comm</title>
<ellipse fill="none" stroke="black" cx="5324.4" cy="-498.78" rx="137.77" ry="26.74"/>
<text text-anchor="middle" x="5324.4" y="-502.58" font-family="Times,serif" font-size="14.00">Layer 10 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="5324.4" y="-487.58" font-family="Times,serif" font-size="14.00">GPU: 8,9,10,11</text>
</g>
<!-- s2_l10_moe -->
<g id="node45" class="node">
<title>s2_l10_moe</title>
<ellipse fill="none" stroke="black" cx="5042.4" cy="-498.78" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="5042.4" y="-510.08" font-family="Times,serif" font-size="14.00">Layer 10 MoE</text>
<text text-anchor="middle" x="5042.4" y="-495.08" font-family="Times,serif" font-size="14.00">16&#45;way Expert Parallel</text>
<text text-anchor="middle" x="5042.4" y="-480.08" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s2_l10_moe_comm -->
<g id="node46" class="node">
<title>s2_l10_moe_comm</title>
<ellipse fill="none" stroke="black" cx="4769.4" cy="-498.78" rx="128.89" ry="26.74"/>
<text text-anchor="middle" x="4769.4" y="-502.58" font-family="Times,serif" font-size="14.00">Layer 10 MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="4769.4" y="-487.58" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s2_l11_attn -->
<g id="node47" class="node">
<title>s2_l11_attn</title>
<ellipse fill="none" stroke="black" cx="4502.4" cy="-498.78" rx="120.42" ry="37.45"/>
<text text-anchor="middle" x="4502.4" y="-510.08" font-family="Times,serif" font-size="14.00">Layer 11 Attention</text>
<text text-anchor="middle" x="4502.4" y="-495.08" font-family="Times,serif" font-size="14.00">4&#45;way Tensor Parallel</text>
<text text-anchor="middle" x="4502.4" y="-480.08" font-family="Times,serif" font-size="14.00">GPU: 8,9,10,11</text>
</g>
<!-- s2_l11_attn_comm -->
<g id="node48" class="node">
<title>s2_l11_attn_comm</title>
<ellipse fill="none" stroke="black" cx="4226.4" cy="-498.78" rx="137.77" ry="26.74"/>
<text text-anchor="middle" x="4226.4" y="-502.58" font-family="Times,serif" font-size="14.00">Layer 11 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="4226.4" y="-487.58" font-family="Times,serif" font-size="14.00">GPU: 8,9,10,11</text>
</g>
<!-- s2_l11_moe -->
<g id="node49" class="node">
<title>s2_l11_moe</title>
<ellipse fill="none" stroke="black" cx="3944.4" cy="-498.78" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="3944.4" y="-510.08" font-family="Times,serif" font-size="14.00">Layer 11 MoE</text>
<text text-anchor="middle" x="3944.4" y="-495.08" font-family="Times,serif" font-size="14.00">16&#45;way Expert Parallel</text>
<text text-anchor="middle" x="3944.4" y="-480.08" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s2_l11_moe_comm -->
<g id="node50" class="node">
<title>s2_l11_moe_comm</title>
<ellipse fill="none" stroke="black" cx="3671.4" cy="-498.78" rx="128.89" ry="26.74"/>
<text text-anchor="middle" x="3671.4" y="-502.58" font-family="Times,serif" font-size="14.00">Layer 11 MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="3671.4" y="-487.58" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s3_l12_attn -->
<g id="node51" class="node">
<title>s3_l12_attn</title>
<ellipse fill="none" stroke="black" cx="7772.4" cy="-341.22" rx="120.42" ry="37.45"/>
<text text-anchor="middle" x="7772.4" y="-352.52" font-family="Times,serif" font-size="14.00">Layer 12 Attention</text>
<text text-anchor="middle" x="7772.4" y="-337.52" font-family="Times,serif" font-size="14.00">4&#45;way Tensor Parallel</text>
<text text-anchor="middle" x="7772.4" y="-322.52" font-family="Times,serif" font-size="14.00">GPU: 12,13,14,15</text>
</g>
<!-- s2_l11_moe_comm&#45;&gt;s3_l12_attn -->
<g id="edge8" class="edge">
<title>s2_l11_moe_comm&#45;&gt;s3_l12_attn</title>
<path fill="none" stroke="black" d="M3784.96,-485.9C3784.96,-462.18 3784.96,-414 3784.96,-414 3784.96,-414 7760.4,-414 7760.4,-414 7760.4,-414 7760.4,-388.89 7760.4,-388.89"/>
<polygon fill="black" stroke="black" points="7763.9,-388.89 7760.4,-378.89 7756.9,-388.89 7763.9,-388.89"/>
</g>
<!-- s3_l12_attn_comm -->
<g id="node52" class="node">
<title>s3_l12_attn_comm</title>
<ellipse fill="none" stroke="black" cx="7496.4" cy="-341.22" rx="137.77" ry="26.74"/>
<text text-anchor="middle" x="7496.4" y="-345.02" font-family="Times,serif" font-size="14.00">Layer 12 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="7496.4" y="-330.02" font-family="Times,serif" font-size="14.00">GPU: 12,13,14,15</text>
</g>
<!-- s3_l12_moe -->
<g id="node53" class="node">
<title>s3_l12_moe</title>
<ellipse fill="none" stroke="black" cx="7214.4" cy="-341.22" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="7214.4" y="-352.52" font-family="Times,serif" font-size="14.00">Layer 12 MoE</text>
<text text-anchor="middle" x="7214.4" y="-337.52" font-family="Times,serif" font-size="14.00">16&#45;way Expert Parallel</text>
<text text-anchor="middle" x="7214.4" y="-322.52" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s3_l12_moe_comm -->
<g id="node54" class="node">
<title>s3_l12_moe_comm</title>
<ellipse fill="none" stroke="black" cx="6941.4" cy="-341.22" rx="128.89" ry="26.74"/>
<text text-anchor="middle" x="6941.4" y="-345.02" font-family="Times,serif" font-size="14.00">Layer 12 MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="6941.4" y="-330.02" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s3_l13_attn -->
<g id="node55" class="node">
<title>s3_l13_attn</title>
<ellipse fill="none" stroke="black" cx="6674.4" cy="-341.22" rx="120.42" ry="37.45"/>
<text text-anchor="middle" x="6674.4" y="-352.52" font-family="Times,serif" font-size="14.00">Layer 13 Attention</text>
<text text-anchor="middle" x="6674.4" y="-337.52" font-family="Times,serif" font-size="14.00">4&#45;way Tensor Parallel</text>
<text text-anchor="middle" x="6674.4" y="-322.52" font-family="Times,serif" font-size="14.00">GPU: 12,13,14,15</text>
</g>
<!-- s3_l13_attn_comm -->
<g id="node56" class="node">
<title>s3_l13_attn_comm</title>
<ellipse fill="none" stroke="black" cx="6398.4" cy="-341.22" rx="137.77" ry="26.74"/>
<text text-anchor="middle" x="6398.4" y="-345.02" font-family="Times,serif" font-size="14.00">Layer 13 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="6398.4" y="-330.02" font-family="Times,serif" font-size="14.00">GPU: 12,13,14,15</text>
</g>
<!-- s3_l13_moe -->
<g id="node57" class="node">
<title>s3_l13_moe</title>
<ellipse fill="none" stroke="black" cx="6116.4" cy="-341.22" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="6116.4" y="-352.52" font-family="Times,serif" font-size="14.00">Layer 13 MoE</text>
<text text-anchor="middle" x="6116.4" y="-337.52" font-family="Times,serif" font-size="14.00">16&#45;way Expert Parallel</text>
<text text-anchor="middle" x="6116.4" y="-322.52" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s3_l13_moe_comm -->
<g id="node58" class="node">
<title>s3_l13_moe_comm</title>
<ellipse fill="none" stroke="black" cx="5843.4" cy="-341.22" rx="128.89" ry="26.74"/>
<text text-anchor="middle" x="5843.4" y="-345.02" font-family="Times,serif" font-size="14.00">Layer 13 MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="5843.4" y="-330.02" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s3_l14_attn -->
<g id="node59" class="node">
<title>s3_l14_attn</title>
<ellipse fill="none" stroke="black" cx="5576.4" cy="-341.22" rx="120.42" ry="37.45"/>
<text text-anchor="middle" x="5576.4" y="-352.52" font-family="Times,serif" font-size="14.00">Layer 14 Attention</text>
<text text-anchor="middle" x="5576.4" y="-337.52" font-family="Times,serif" font-size="14.00">4&#45;way Tensor Parallel</text>
<text text-anchor="middle" x="5576.4" y="-322.52" font-family="Times,serif" font-size="14.00">GPU: 12,13,14,15</text>
</g>
<!-- s3_l14_attn_comm -->
<g id="node60" class="node">
<title>s3_l14_attn_comm</title>
<ellipse fill="none" stroke="black" cx="5300.4" cy="-341.22" rx="137.77" ry="26.74"/>
<text text-anchor="middle" x="5300.4" y="-345.02" font-family="Times,serif" font-size="14.00">Layer 14 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="5300.4" y="-330.02" font-family="Times,serif" font-size="14.00">GPU: 12,13,14,15</text>
</g>
<!-- s3_l14_moe -->
<g id="node61" class="node">
<title>s3_l14_moe</title>
<ellipse fill="none" stroke="black" cx="5018.4" cy="-341.22" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="5018.4" y="-352.52" font-family="Times,serif" font-size="14.00">Layer 14 MoE</text>
<text text-anchor="middle" x="5018.4" y="-337.52" font-family="Times,serif" font-size="14.00">16&#45;way Expert Parallel</text>
<text text-anchor="middle" x="5018.4" y="-322.52" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s3_l14_moe_comm -->
<g id="node62" class="node">
<title>s3_l14_moe_comm</title>
<ellipse fill="none" stroke="black" cx="4745.4" cy="-341.22" rx="128.89" ry="26.74"/>
<text text-anchor="middle" x="4745.4" y="-345.02" font-family="Times,serif" font-size="14.00">Layer 14 MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="4745.4" y="-330.02" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s3_l15_attn -->
<g id="node63" class="node">
<title>s3_l15_attn</title>
<ellipse fill="none" stroke="black" cx="4478.4" cy="-341.22" rx="120.42" ry="37.45"/>
<text text-anchor="middle" x="4478.4" y="-352.52" font-family="Times,serif" font-size="14.00">Layer 15 Attention</text>
<text text-anchor="middle" x="4478.4" y="-337.52" font-family="Times,serif" font-size="14.00">4&#45;way Tensor Parallel</text>
<text text-anchor="middle" x="4478.4" y="-322.52" font-family="Times,serif" font-size="14.00">GPU: 12,13,14,15</text>
</g>
<!-- s3_l15_attn_comm -->
<g id="node64" class="node">
<title>s3_l15_attn_comm</title>
<ellipse fill="none" stroke="black" cx="4202.4" cy="-341.22" rx="137.77" ry="26.74"/>
<text text-anchor="middle" x="4202.4" y="-345.02" font-family="Times,serif" font-size="14.00">Layer 15 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="4202.4" y="-330.02" font-family="Times,serif" font-size="14.00">GPU: 12,13,14,15</text>
</g>
<!-- s3_l15_moe -->
<g id="node65" class="node">
<title>s3_l15_moe</title>
<ellipse fill="none" stroke="black" cx="3920.4" cy="-341.22" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="3920.4" y="-352.52" font-family="Times,serif" font-size="14.00">Layer 15 MoE</text>
<text text-anchor="middle" x="3920.4" y="-337.52" font-family="Times,serif" font-size="14.00">16&#45;way Expert Parallel</text>
<text text-anchor="middle" x="3920.4" y="-322.52" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- s3_l15_moe_comm -->
<g id="node66" class="node">
<title>s3_l15_moe_comm</title>
<ellipse fill="none" stroke="black" cx="3647.4" cy="-341.22" rx="128.89" ry="26.74"/>
<text text-anchor="middle" x="3647.4" y="-345.02" font-family="Times,serif" font-size="14.00">Layer 15 MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="3647.4" y="-330.02" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- output_agg -->
<g id="node67" class="node">
<title>output_agg</title>
<polygon fill="none" stroke="black" points="3812.09,-231.74 3550.11,-231.74 3482.72,-125.74 3744.7,-125.74 3812.09,-231.74"/>
<text text-anchor="middle" x="3647.4" y="-190.04" font-family="Times,serif" font-size="14.00">Output Aggregation</text>
<text text-anchor="middle" x="3647.4" y="-175.04" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="3647.4" y="-160.04" font-family="Times,serif" font-size="14.00">GPU: 12,13,14,15</text>
</g>
<!-- s3_l15_moe_comm&#45;&gt;output_agg -->
<g id="edge9" class="edge">
<title>s3_l15_moe_comm&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M3647.4,-314.02C3647.4,-314.02 3647.4,-242.01 3647.4,-242.01"/>
<polygon fill="black" stroke="black" points="3650.9,-242.01 3647.4,-232.01 3643.9,-242.01 3650.9,-242.01"/>
</g>
<!-- output -->
<g id="node68" class="node">
<title>output</title>
<ellipse fill="none" stroke="black" cx="3647.4" cy="-26.87" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="3647.4" y="-30.67" font-family="Times,serif" font-size="14.00">Final Output</text>
<text text-anchor="middle" x="3647.4" y="-15.67" font-family="Times,serif" font-size="14.00">[128, 1024, 1024]</text>
</g>
<!-- output_agg&#45;&gt;output -->
<g id="edge10" class="edge">
<title>output_agg&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3647.4,-125.62C3647.4,-125.62 3647.4,-64.15 3647.4,-64.15"/>
<polygon fill="black" stroke="black" points="3650.9,-64.15 3647.4,-54.15 3643.9,-64.15 3650.9,-64.15"/>
</g>
</g>
</svg>
