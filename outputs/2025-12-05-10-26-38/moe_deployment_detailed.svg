<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="79918pt" height="1226pt"
 viewBox="0.00 0.00 79917.73 1226.33" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1222.33)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1222.33 79913.73,-1222.33 79913.73,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="white" stroke="black" cx="2232" cy="-1150.33" rx="251.96" ry="37.45"/>
<text text-anchor="middle" x="2232" y="-1161.63" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="2232" y="-1146.63" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="2232" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: ALL</text>
</g>
<!-- dp_split -->
<g id="node2" class="node">
<title>dp_split</title>
<polygon fill="lightpink" stroke="black" points="2591.51,-1016.33 2019.61,-1016.33 1872.49,-910.33 2444.39,-910.33 2591.51,-1016.33"/>
<text text-anchor="middle" x="2232" y="-974.63" font-family="Times,serif" font-size="14.00">Data Parallel Split</text>
<text text-anchor="middle" x="2232" y="-959.63" font-family="Times,serif" font-size="14.00">[batch_size=64, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="2232" y="-944.63" font-family="Times,serif" font-size="14.00">GPU: Routing</text>
</g>
<!-- input&#45;&gt;dp_split -->
<g id="edge1" class="edge">
<title>input&#45;&gt;dp_split</title>
<path fill="none" stroke="black" d="M2232,-1112.49C2232,-1112.49 2232,-1026.35 2232,-1026.35"/>
<polygon fill="black" stroke="black" points="2235.5,-1026.35 2232,-1016.35 2228.5,-1026.35 2235.5,-1026.35"/>
</g>
<!-- layer0_attn_qkv_gpu0 -->
<g id="node3" class="node">
<title>layer0_attn_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1993.5,-844.33 1786.5,-844.33 1786.5,-761.33 1993.5,-761.33 1993.5,-844.33"/>
<text text-anchor="middle" x="1890" y="-829.13" font-family="Times,serif" font-size="14.00">Layer0 Attention QKV Proj</text>
<text text-anchor="middle" x="1890" y="-814.13" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="1890" y="-799.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="1890" y="-784.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="1890" y="-769.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- dp_split&#45;&gt;layer0_attn_qkv_gpu0 -->
<g id="edge2" class="edge">
<title>dp_split&#45;&gt;layer0_attn_qkv_gpu0</title>
<path fill="none" stroke="black" d="M1932.87,-909.89C1932.87,-909.89 1932.87,-854.37 1932.87,-854.37"/>
<polygon fill="black" stroke="black" points="1936.37,-854.37 1932.87,-844.37 1929.37,-854.37 1936.37,-854.37"/>
</g>
<!-- layer0_attn_qkv_gpu1 -->
<g id="node4" class="node">
<title>layer0_attn_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2220.5,-844.33 2013.5,-844.33 2013.5,-761.33 2220.5,-761.33 2220.5,-844.33"/>
<text text-anchor="middle" x="2117" y="-829.13" font-family="Times,serif" font-size="14.00">Layer0 Attention QKV Proj</text>
<text text-anchor="middle" x="2117" y="-814.13" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="2117" y="-799.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="2117" y="-784.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="2117" y="-769.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- dp_split&#45;&gt;layer0_attn_qkv_gpu1 -->
<g id="edge7" class="edge">
<title>dp_split&#45;&gt;layer0_attn_qkv_gpu1</title>
<path fill="none" stroke="black" d="M2117,-909.89C2117,-909.89 2117,-854.37 2117,-854.37"/>
<polygon fill="black" stroke="black" points="2120.5,-854.37 2117,-844.37 2113.5,-854.37 2120.5,-854.37"/>
</g>
<!-- layer0_attn_qkv_gpu2 -->
<g id="node5" class="node">
<title>layer0_attn_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2447.5,-844.33 2240.5,-844.33 2240.5,-761.33 2447.5,-761.33 2447.5,-844.33"/>
<text text-anchor="middle" x="2344" y="-829.13" font-family="Times,serif" font-size="14.00">Layer0 Attention QKV Proj</text>
<text text-anchor="middle" x="2344" y="-814.13" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="2344" y="-799.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="2344" y="-784.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="2344" y="-769.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- dp_split&#45;&gt;layer0_attn_qkv_gpu2 -->
<g id="edge12" class="edge">
<title>dp_split&#45;&gt;layer0_attn_qkv_gpu2</title>
<path fill="none" stroke="black" d="M2344,-909.89C2344,-909.89 2344,-854.37 2344,-854.37"/>
<polygon fill="black" stroke="black" points="2347.5,-854.37 2344,-844.37 2340.5,-854.37 2347.5,-854.37"/>
</g>
<!-- layer0_attn_qkv_gpu3 -->
<g id="node6" class="node">
<title>layer0_attn_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2676.5,-844.33 2469.5,-844.33 2469.5,-761.33 2676.5,-761.33 2676.5,-844.33"/>
<text text-anchor="middle" x="2573" y="-829.13" font-family="Times,serif" font-size="14.00">Layer0 Attention QKV Proj</text>
<text text-anchor="middle" x="2573" y="-814.13" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="2573" y="-799.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="2573" y="-784.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="2573" y="-769.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- dp_split&#45;&gt;layer0_attn_qkv_gpu3 -->
<g id="edge17" class="edge">
<title>dp_split&#45;&gt;layer0_attn_qkv_gpu3</title>
<path fill="none" stroke="black" d="M2530.63,-963.22C2530.63,-963.22 2530.63,-854.7 2530.63,-854.7"/>
<polygon fill="black" stroke="black" points="2534.13,-854.7 2530.63,-844.7 2527.13,-854.7 2534.13,-854.7"/>
</g>
<!-- layer0_attn_score_gpu0 -->
<g id="node7" class="node">
<title>layer0_attn_score_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1992,-725.33 1780,-725.33 1780,-657.33 1992,-657.33 1992,-725.33"/>
<text text-anchor="middle" x="1886" y="-710.13" font-family="Times,serif" font-size="14.00">Layer0 Attention Scores</text>
<text text-anchor="middle" x="1886" y="-695.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="1886" y="-680.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="1886" y="-665.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_attn_qkv_gpu0&#45;&gt;layer0_attn_score_gpu0 -->
<g id="edge3" class="edge">
<title>layer0_attn_qkv_gpu0&#45;&gt;layer0_attn_score_gpu0</title>
<path fill="none" stroke="black" d="M1889.25,-761.31C1889.25,-761.31 1889.25,-735.6 1889.25,-735.6"/>
<polygon fill="black" stroke="black" points="1892.75,-735.6 1889.25,-725.6 1885.75,-735.6 1892.75,-735.6"/>
</g>
<!-- layer0_attn_score_gpu1 -->
<g id="node8" class="node">
<title>layer0_attn_score_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2222,-725.33 2010,-725.33 2010,-657.33 2222,-657.33 2222,-725.33"/>
<text text-anchor="middle" x="2116" y="-710.13" font-family="Times,serif" font-size="14.00">Layer0 Attention Scores</text>
<text text-anchor="middle" x="2116" y="-695.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="2116" y="-680.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="2116" y="-665.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_attn_qkv_gpu1&#45;&gt;layer0_attn_score_gpu1 -->
<g id="edge8" class="edge">
<title>layer0_attn_qkv_gpu1&#45;&gt;layer0_attn_score_gpu1</title>
<path fill="none" stroke="black" d="M2117,-761.31C2117,-761.31 2117,-735.6 2117,-735.6"/>
<polygon fill="black" stroke="black" points="2120.5,-735.6 2117,-725.6 2113.5,-735.6 2120.5,-735.6"/>
</g>
<!-- layer0_attn_score_gpu2 -->
<g id="node9" class="node">
<title>layer0_attn_score_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2452,-725.33 2240,-725.33 2240,-657.33 2452,-657.33 2452,-725.33"/>
<text text-anchor="middle" x="2346" y="-710.13" font-family="Times,serif" font-size="14.00">Layer0 Attention Scores</text>
<text text-anchor="middle" x="2346" y="-695.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="2346" y="-680.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="2346" y="-665.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_attn_qkv_gpu2&#45;&gt;layer0_attn_score_gpu2 -->
<g id="edge13" class="edge">
<title>layer0_attn_qkv_gpu2&#45;&gt;layer0_attn_score_gpu2</title>
<path fill="none" stroke="black" d="M2344,-761.31C2344,-761.31 2344,-735.6 2344,-735.6"/>
<polygon fill="black" stroke="black" points="2347.5,-735.6 2344,-725.6 2340.5,-735.6 2347.5,-735.6"/>
</g>
<!-- layer0_attn_score_gpu3 -->
<g id="node10" class="node">
<title>layer0_attn_score_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2682,-725.33 2470,-725.33 2470,-657.33 2682,-657.33 2682,-725.33"/>
<text text-anchor="middle" x="2576" y="-710.13" font-family="Times,serif" font-size="14.00">Layer0 Attention Scores</text>
<text text-anchor="middle" x="2576" y="-695.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="2576" y="-680.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="2576" y="-665.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_attn_qkv_gpu3&#45;&gt;layer0_attn_score_gpu3 -->
<g id="edge18" class="edge">
<title>layer0_attn_qkv_gpu3&#45;&gt;layer0_attn_score_gpu3</title>
<path fill="none" stroke="black" d="M2573.25,-761.31C2573.25,-761.31 2573.25,-735.6 2573.25,-735.6"/>
<polygon fill="black" stroke="black" points="2576.75,-735.6 2573.25,-725.6 2569.75,-735.6 2576.75,-735.6"/>
</g>
<!-- layer0_attn_out_gpu0 -->
<g id="node11" class="node">
<title>layer0_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1997,-621.33 1805,-621.33 1805,-538.33 1997,-538.33 1997,-621.33"/>
<text text-anchor="middle" x="1901" y="-606.13" font-family="Times,serif" font-size="14.00">Layer0 Attention Output</text>
<text text-anchor="middle" x="1901" y="-591.13" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="1901" y="-576.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="1901" y="-561.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="1901" y="-546.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_attn_score_gpu0&#45;&gt;layer0_attn_out_gpu0 -->
<g id="edge4" class="edge">
<title>layer0_attn_score_gpu0&#45;&gt;layer0_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M1898.5,-657.27C1898.5,-657.27 1898.5,-631.55 1898.5,-631.55"/>
<polygon fill="black" stroke="black" points="1902,-631.55 1898.5,-621.55 1895,-631.55 1902,-631.55"/>
</g>
<!-- layer0_attn_out_gpu1 -->
<g id="node12" class="node">
<title>layer0_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2217,-621.33 2025,-621.33 2025,-538.33 2217,-538.33 2217,-621.33"/>
<text text-anchor="middle" x="2121" y="-606.13" font-family="Times,serif" font-size="14.00">Layer0 Attention Output</text>
<text text-anchor="middle" x="2121" y="-591.13" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="2121" y="-576.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="2121" y="-561.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="2121" y="-546.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_attn_score_gpu1&#45;&gt;layer0_attn_out_gpu1 -->
<g id="edge9" class="edge">
<title>layer0_attn_score_gpu1&#45;&gt;layer0_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M2121,-657.27C2121,-657.27 2121,-631.55 2121,-631.55"/>
<polygon fill="black" stroke="black" points="2124.5,-631.55 2121,-621.55 2117.5,-631.55 2124.5,-631.55"/>
</g>
<!-- layer0_attn_out_gpu2 -->
<g id="node13" class="node">
<title>layer0_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2437,-621.33 2245,-621.33 2245,-538.33 2437,-538.33 2437,-621.33"/>
<text text-anchor="middle" x="2341" y="-606.13" font-family="Times,serif" font-size="14.00">Layer0 Attention Output</text>
<text text-anchor="middle" x="2341" y="-591.13" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="2341" y="-576.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="2341" y="-561.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="2341" y="-546.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_attn_score_gpu2&#45;&gt;layer0_attn_out_gpu2 -->
<g id="edge14" class="edge">
<title>layer0_attn_score_gpu2&#45;&gt;layer0_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M2341,-657.27C2341,-657.27 2341,-631.55 2341,-631.55"/>
<polygon fill="black" stroke="black" points="2344.5,-631.55 2341,-621.55 2337.5,-631.55 2344.5,-631.55"/>
</g>
<!-- layer0_attn_out_gpu3 -->
<g id="node14" class="node">
<title>layer0_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2662,-621.33 2470,-621.33 2470,-538.33 2662,-538.33 2662,-621.33"/>
<text text-anchor="middle" x="2566" y="-606.13" font-family="Times,serif" font-size="14.00">Layer0 Attention Output</text>
<text text-anchor="middle" x="2566" y="-591.13" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="2566" y="-576.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="2566" y="-561.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="2566" y="-546.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_attn_score_gpu3&#45;&gt;layer0_attn_out_gpu3 -->
<g id="edge19" class="edge">
<title>layer0_attn_score_gpu3&#45;&gt;layer0_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M2566,-657.27C2566,-657.27 2566,-631.55 2566,-631.55"/>
<polygon fill="black" stroke="black" points="2569.5,-631.55 2566,-621.55 2562.5,-631.55 2569.5,-631.55"/>
</g>
<!-- layer0_attn_allreduce -->
<g id="node15" class="node">
<title>layer0_attn_allreduce</title>
<ellipse fill="lightgray" stroke="black" cx="2231" cy="-443.64" rx="137.36" ry="58.88"/>
<text text-anchor="middle" x="2231" y="-469.94" font-family="Times,serif" font-size="14.00">Layer0 Attention</text>
<text text-anchor="middle" x="2231" y="-454.94" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="2231" y="-439.94" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="2231" y="-424.94" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1024]</text>
<text text-anchor="middle" x="2231" y="-409.94" font-family="Times,serif" font-size="14.00">GPU: 0,1,2,3</text>
</g>
<!-- layer0_attn_out_gpu0&#45;&gt;layer0_attn_allreduce -->
<g id="edge5" class="edge">
<title>layer0_attn_out_gpu0&#45;&gt;layer0_attn_allreduce</title>
<path fill="none" stroke="black" d="M1914.5,-538.31C1914.5,-504.73 1914.5,-463 1914.5,-463 1914.5,-463 2091.35,-463 2091.35,-463"/>
<polygon fill="black" stroke="black" points="2091.35,-466.5 2101.35,-463 2091.35,-459.5 2091.35,-466.5"/>
</g>
<!-- layer0_attn_out_gpu1&#45;&gt;layer0_attn_allreduce -->
<g id="edge10" class="edge">
<title>layer0_attn_out_gpu1&#45;&gt;layer0_attn_allreduce</title>
<path fill="none" stroke="black" d="M2155.41,-538.23C2155.41,-538.23 2155.41,-502.64 2155.41,-502.64"/>
<polygon fill="black" stroke="black" points="2158.91,-502.64 2155.41,-492.64 2151.91,-502.64 2158.91,-502.64"/>
</g>
<!-- layer0_attn_out_gpu2&#45;&gt;layer0_attn_allreduce -->
<g id="edge15" class="edge">
<title>layer0_attn_out_gpu2&#45;&gt;layer0_attn_allreduce</title>
<path fill="none" stroke="black" d="M2306.59,-538.23C2306.59,-538.23 2306.59,-502.64 2306.59,-502.64"/>
<polygon fill="black" stroke="black" points="2310.09,-502.64 2306.59,-492.64 2303.09,-502.64 2310.09,-502.64"/>
</g>
<!-- layer0_attn_out_gpu3&#45;&gt;layer0_attn_allreduce -->
<g id="edge20" class="edge">
<title>layer0_attn_out_gpu3&#45;&gt;layer0_attn_allreduce</title>
<path fill="none" stroke="black" d="M2550,-538.31C2550,-504.73 2550,-463 2550,-463 2550,-463 2370.75,-463 2370.75,-463"/>
<polygon fill="black" stroke="black" points="2370.75,-459.5 2360.75,-463 2370.75,-466.5 2370.75,-459.5"/>
</g>
<!-- layer0_moe_route_gpu0 -->
<g id="node322" class="node">
<title>layer0_moe_route_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2018,-348.95 1832,-348.95 1832,-312.95 2018,-312.95 2018,-348.95"/>
<text text-anchor="middle" x="1925" y="-327.25" font-family="Times,serif" font-size="14.00">layer0_moe_route_gpu0</text>
</g>
<!-- layer0_attn_allreduce&#45;&gt;layer0_moe_route_gpu0 -->
<g id="edge6" class="edge">
<title>layer0_attn_allreduce&#45;&gt;layer0_moe_route_gpu0</title>
<path fill="none" stroke="black" d="M2101.64,-424C2055.17,-424 2014,-424 2014,-424 2014,-424 2014,-359.34 2014,-359.34"/>
<polygon fill="black" stroke="black" points="2017.5,-359.34 2014,-349.34 2010.5,-359.34 2017.5,-359.34"/>
</g>
<!-- layer0_moe_route_gpu1 -->
<g id="node323" class="node">
<title>layer0_moe_route_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2222,-348.95 2036,-348.95 2036,-312.95 2222,-312.95 2222,-348.95"/>
<text text-anchor="middle" x="2129" y="-327.25" font-family="Times,serif" font-size="14.00">layer0_moe_route_gpu1</text>
</g>
<!-- layer0_attn_allreduce&#45;&gt;layer0_moe_route_gpu1 -->
<g id="edge11" class="edge">
<title>layer0_attn_allreduce&#45;&gt;layer0_moe_route_gpu1</title>
<path fill="none" stroke="black" d="M2157.91,-393.89C2157.91,-393.89 2157.91,-359.17 2157.91,-359.17"/>
<polygon fill="black" stroke="black" points="2161.41,-359.17 2157.91,-349.17 2154.41,-359.17 2161.41,-359.17"/>
</g>
<!-- layer0_moe_route_gpu2 -->
<g id="node324" class="node">
<title>layer0_moe_route_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2426,-348.95 2240,-348.95 2240,-312.95 2426,-312.95 2426,-348.95"/>
<text text-anchor="middle" x="2333" y="-327.25" font-family="Times,serif" font-size="14.00">layer0_moe_route_gpu2</text>
</g>
<!-- layer0_attn_allreduce&#45;&gt;layer0_moe_route_gpu2 -->
<g id="edge16" class="edge">
<title>layer0_attn_allreduce&#45;&gt;layer0_moe_route_gpu2</title>
<path fill="none" stroke="black" d="M2304.09,-393.89C2304.09,-393.89 2304.09,-359.17 2304.09,-359.17"/>
<polygon fill="black" stroke="black" points="2307.59,-359.17 2304.09,-349.17 2300.59,-359.17 2307.59,-359.17"/>
</g>
<!-- layer0_moe_route_gpu3 -->
<g id="node325" class="node">
<title>layer0_moe_route_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2630,-348.95 2444,-348.95 2444,-312.95 2630,-312.95 2630,-348.95"/>
<text text-anchor="middle" x="2537" y="-327.25" font-family="Times,serif" font-size="14.00">layer0_moe_route_gpu3</text>
</g>
<!-- layer0_attn_allreduce&#45;&gt;layer0_moe_route_gpu3 -->
<g id="edge21" class="edge">
<title>layer0_attn_allreduce&#45;&gt;layer0_moe_route_gpu3</title>
<path fill="none" stroke="black" d="M2360.36,-424C2406.83,-424 2448,-424 2448,-424 2448,-424 2448,-359.34 2448,-359.34"/>
<polygon fill="black" stroke="black" points="2451.5,-359.34 2448,-349.34 2444.5,-359.34 2451.5,-359.34"/>
</g>
<!-- layer0_moe_route -->
<g id="node16" class="node">
<title>layer0_moe_route</title>
<polygon fill="lightblue" stroke="black" points="2878.88,-1218.33 2578.42,-1218.33 2501.12,-1082.33 2801.58,-1082.33 2878.88,-1218.33"/>
<text text-anchor="middle" x="2690" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer0 MoE Routing</text>
<text text-anchor="middle" x="2690" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="2690" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="2690" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 0,1,2,3</text>
</g>
<!-- layer0_expert0 -->
<g id="node17" class="node">
<title>layer0_expert0</title>
<polygon fill="lightblue" stroke="black" points="206,-117 0,-117 0,-49 206,-49 206,-117"/>
<text text-anchor="middle" x="103" y="-101.8" font-family="Times,serif" font-size="14.00">Layer0 Expert 0_0</text>
<text text-anchor="middle" x="103" y="-86.8" font-family="Times,serif" font-size="14.00">Input: [~70, 1024, 1024]</text>
<text text-anchor="middle" x="103" y="-71.8" font-family="Times,serif" font-size="14.00">Output: [~70, 1024, 2048]</text>
<text text-anchor="middle" x="103" y="-56.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_expert1 -->
<g id="node18" class="node">
<title>layer0_expert1</title>
<polygon fill="lightblue" stroke="black" points="430,-117 224,-117 224,-49 430,-49 430,-117"/>
<text text-anchor="middle" x="327" y="-101.8" font-family="Times,serif" font-size="14.00">Layer0 Expert 0_1</text>
<text text-anchor="middle" x="327" y="-86.8" font-family="Times,serif" font-size="14.00">Input: [~70, 1024, 1024]</text>
<text text-anchor="middle" x="327" y="-71.8" font-family="Times,serif" font-size="14.00">Output: [~70, 1024, 2048]</text>
<text text-anchor="middle" x="327" y="-56.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_expert2 -->
<g id="node19" class="node">
<title>layer0_expert2</title>
<polygon fill="lightblue" stroke="black" points="654,-117 448,-117 448,-49 654,-49 654,-117"/>
<text text-anchor="middle" x="551" y="-101.8" font-family="Times,serif" font-size="14.00">Layer0 Expert 0_2</text>
<text text-anchor="middle" x="551" y="-86.8" font-family="Times,serif" font-size="14.00">Input: [~70, 1024, 1024]</text>
<text text-anchor="middle" x="551" y="-71.8" font-family="Times,serif" font-size="14.00">Output: [~70, 1024, 2048]</text>
<text text-anchor="middle" x="551" y="-56.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_expert3 -->
<g id="node20" class="node">
<title>layer0_expert3</title>
<polygon fill="lightblue" stroke="black" points="878,-117 672,-117 672,-49 878,-49 878,-117"/>
<text text-anchor="middle" x="775" y="-101.8" font-family="Times,serif" font-size="14.00">Layer0 Expert 0_3</text>
<text text-anchor="middle" x="775" y="-86.8" font-family="Times,serif" font-size="14.00">Input: [~70, 1024, 1024]</text>
<text text-anchor="middle" x="775" y="-71.8" font-family="Times,serif" font-size="14.00">Output: [~70, 1024, 2048]</text>
<text text-anchor="middle" x="775" y="-56.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_expert4 -->
<g id="node21" class="node">
<title>layer0_expert4</title>
<polygon fill="lightgreen" stroke="black" points="1102,-117 896,-117 896,-49 1102,-49 1102,-117"/>
<text text-anchor="middle" x="999" y="-101.8" font-family="Times,serif" font-size="14.00">Layer0 Expert 1_0</text>
<text text-anchor="middle" x="999" y="-86.8" font-family="Times,serif" font-size="14.00">Input: [~70, 1024, 1024]</text>
<text text-anchor="middle" x="999" y="-71.8" font-family="Times,serif" font-size="14.00">Output: [~70, 1024, 2048]</text>
<text text-anchor="middle" x="999" y="-56.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_expert5 -->
<g id="node22" class="node">
<title>layer0_expert5</title>
<polygon fill="lightgreen" stroke="black" points="1326,-117 1120,-117 1120,-49 1326,-49 1326,-117"/>
<text text-anchor="middle" x="1223" y="-101.8" font-family="Times,serif" font-size="14.00">Layer0 Expert 1_1</text>
<text text-anchor="middle" x="1223" y="-86.8" font-family="Times,serif" font-size="14.00">Input: [~70, 1024, 1024]</text>
<text text-anchor="middle" x="1223" y="-71.8" font-family="Times,serif" font-size="14.00">Output: [~70, 1024, 2048]</text>
<text text-anchor="middle" x="1223" y="-56.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_expert6 -->
<g id="node23" class="node">
<title>layer0_expert6</title>
<polygon fill="lightgreen" stroke="black" points="1550,-117 1344,-117 1344,-49 1550,-49 1550,-117"/>
<text text-anchor="middle" x="1447" y="-101.8" font-family="Times,serif" font-size="14.00">Layer0 Expert 1_2</text>
<text text-anchor="middle" x="1447" y="-86.8" font-family="Times,serif" font-size="14.00">Input: [~70, 1024, 1024]</text>
<text text-anchor="middle" x="1447" y="-71.8" font-family="Times,serif" font-size="14.00">Output: [~70, 1024, 2048]</text>
<text text-anchor="middle" x="1447" y="-56.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_expert7 -->
<g id="node24" class="node">
<title>layer0_expert7</title>
<polygon fill="lightgreen" stroke="black" points="1774,-117 1568,-117 1568,-49 1774,-49 1774,-117"/>
<text text-anchor="middle" x="1671" y="-101.8" font-family="Times,serif" font-size="14.00">Layer0 Expert 1_3</text>
<text text-anchor="middle" x="1671" y="-86.8" font-family="Times,serif" font-size="14.00">Input: [~70, 1024, 1024]</text>
<text text-anchor="middle" x="1671" y="-71.8" font-family="Times,serif" font-size="14.00">Output: [~70, 1024, 2048]</text>
<text text-anchor="middle" x="1671" y="-56.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_expert8 -->
<g id="node25" class="node">
<title>layer0_expert8</title>
<polygon fill="lightyellow" stroke="black" points="1998,-117 1792,-117 1792,-49 1998,-49 1998,-117"/>
<text text-anchor="middle" x="1895" y="-101.8" font-family="Times,serif" font-size="14.00">Layer0 Expert 2_0</text>
<text text-anchor="middle" x="1895" y="-86.8" font-family="Times,serif" font-size="14.00">Input: [~70, 1024, 1024]</text>
<text text-anchor="middle" x="1895" y="-71.8" font-family="Times,serif" font-size="14.00">Output: [~70, 1024, 2048]</text>
<text text-anchor="middle" x="1895" y="-56.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer0_expert9 -->
<g id="node26" class="node">
<title>layer0_expert9</title>
<polygon fill="lightyellow" stroke="black" points="2222,-117 2016,-117 2016,-49 2222,-49 2222,-117"/>
<text text-anchor="middle" x="2119" y="-101.8" font-family="Times,serif" font-size="14.00">Layer0 Expert 2_1</text>
<text text-anchor="middle" x="2119" y="-86.8" font-family="Times,serif" font-size="14.00">Input: [~70, 1024, 1024]</text>
<text text-anchor="middle" x="2119" y="-71.8" font-family="Times,serif" font-size="14.00">Output: [~70, 1024, 2048]</text>
<text text-anchor="middle" x="2119" y="-56.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer0_expert10 -->
<g id="node27" class="node">
<title>layer0_expert10</title>
<polygon fill="lightyellow" stroke="black" points="2446,-117 2240,-117 2240,-49 2446,-49 2446,-117"/>
<text text-anchor="middle" x="2343" y="-101.8" font-family="Times,serif" font-size="14.00">Layer0 Expert 2_2</text>
<text text-anchor="middle" x="2343" y="-86.8" font-family="Times,serif" font-size="14.00">Input: [~70, 1024, 1024]</text>
<text text-anchor="middle" x="2343" y="-71.8" font-family="Times,serif" font-size="14.00">Output: [~70, 1024, 2048]</text>
<text text-anchor="middle" x="2343" y="-56.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer0_expert11 -->
<g id="node28" class="node">
<title>layer0_expert11</title>
<polygon fill="lightyellow" stroke="black" points="2670,-117 2464,-117 2464,-49 2670,-49 2670,-117"/>
<text text-anchor="middle" x="2567" y="-101.8" font-family="Times,serif" font-size="14.00">Layer0 Expert 2_3</text>
<text text-anchor="middle" x="2567" y="-86.8" font-family="Times,serif" font-size="14.00">Input: [~70, 1024, 1024]</text>
<text text-anchor="middle" x="2567" y="-71.8" font-family="Times,serif" font-size="14.00">Output: [~70, 1024, 2048]</text>
<text text-anchor="middle" x="2567" y="-56.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer0_expert12 -->
<g id="node29" class="node">
<title>layer0_expert12</title>
<polygon fill="lightcoral" stroke="black" points="2894,-117 2688,-117 2688,-49 2894,-49 2894,-117"/>
<text text-anchor="middle" x="2791" y="-101.8" font-family="Times,serif" font-size="14.00">Layer0 Expert 3_0</text>
<text text-anchor="middle" x="2791" y="-86.8" font-family="Times,serif" font-size="14.00">Input: [~70, 1024, 1024]</text>
<text text-anchor="middle" x="2791" y="-71.8" font-family="Times,serif" font-size="14.00">Output: [~70, 1024, 2048]</text>
<text text-anchor="middle" x="2791" y="-56.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer0_expert13 -->
<g id="node30" class="node">
<title>layer0_expert13</title>
<polygon fill="lightcoral" stroke="black" points="3118,-117 2912,-117 2912,-49 3118,-49 3118,-117"/>
<text text-anchor="middle" x="3015" y="-101.8" font-family="Times,serif" font-size="14.00">Layer0 Expert 3_1</text>
<text text-anchor="middle" x="3015" y="-86.8" font-family="Times,serif" font-size="14.00">Input: [~70, 1024, 1024]</text>
<text text-anchor="middle" x="3015" y="-71.8" font-family="Times,serif" font-size="14.00">Output: [~70, 1024, 2048]</text>
<text text-anchor="middle" x="3015" y="-56.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer0_expert14 -->
<g id="node31" class="node">
<title>layer0_expert14</title>
<polygon fill="lightcoral" stroke="black" points="3342,-117 3136,-117 3136,-49 3342,-49 3342,-117"/>
<text text-anchor="middle" x="3239" y="-101.8" font-family="Times,serif" font-size="14.00">Layer0 Expert 3_2</text>
<text text-anchor="middle" x="3239" y="-86.8" font-family="Times,serif" font-size="14.00">Input: [~70, 1024, 1024]</text>
<text text-anchor="middle" x="3239" y="-71.8" font-family="Times,serif" font-size="14.00">Output: [~70, 1024, 2048]</text>
<text text-anchor="middle" x="3239" y="-56.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer0_expert15 -->
<g id="node32" class="node">
<title>layer0_expert15</title>
<polygon fill="lightcoral" stroke="black" points="3566,-117 3360,-117 3360,-49 3566,-49 3566,-117"/>
<text text-anchor="middle" x="3463" y="-101.8" font-family="Times,serif" font-size="14.00">Layer0 Expert 3_3</text>
<text text-anchor="middle" x="3463" y="-86.8" font-family="Times,serif" font-size="14.00">Input: [~70, 1024, 1024]</text>
<text text-anchor="middle" x="3463" y="-71.8" font-family="Times,serif" font-size="14.00">Output: [~70, 1024, 2048]</text>
<text text-anchor="middle" x="3463" y="-56.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer0_moe_all2all -->
<g id="node33" class="node">
<title>layer0_moe_all2all</title>
<ellipse fill="lightgray" stroke="black" cx="2231" cy="-239.48" rx="137.36" ry="37.45"/>
<text text-anchor="middle" x="2231" y="-250.78" font-family="Times,serif" font-size="14.00">Layer0 MoE</text>
<text text-anchor="middle" x="2231" y="-235.78" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All Communication</text>
<text text-anchor="middle" x="2231" y="-220.78" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer0_moe_all2all&#45;&gt;layer0_expert0 -->
<g id="edge26" class="edge">
<title>layer0_moe_all2all&#45;&gt;layer0_expert0</title>
<path fill="none" stroke="black" d="M2124.01,-263C1692.49,-263 103,-263 103,-263 103,-263 103,-127.28 103,-127.28"/>
<polygon fill="black" stroke="black" points="106.5,-127.28 103,-117.28 99.5,-127.28 106.5,-127.28"/>
</g>
<!-- layer0_moe_all2all&#45;&gt;layer0_expert1 -->
<g id="edge27" class="edge">
<title>layer0_moe_all2all&#45;&gt;layer0_expert1</title>
<path fill="none" stroke="black" d="M2107.54,-256C1685.62,-256 327,-256 327,-256 327,-256 327,-127.18 327,-127.18"/>
<polygon fill="black" stroke="black" points="330.5,-127.18 327,-117.18 323.5,-127.18 330.5,-127.18"/>
</g>
<!-- layer0_moe_all2all&#45;&gt;layer0_expert2 -->
<g id="edge28" class="edge">
<title>layer0_moe_all2all&#45;&gt;layer0_expert2</title>
<path fill="none" stroke="black" d="M2098.12,-249C1701.09,-249 551,-249 551,-249 551,-249 551,-127.4 551,-127.4"/>
<polygon fill="black" stroke="black" points="554.5,-127.4 551,-117.4 547.5,-127.4 554.5,-127.4"/>
</g>
<!-- layer0_moe_all2all&#45;&gt;layer0_expert3 -->
<g id="edge29" class="edge">
<title>layer0_moe_all2all&#45;&gt;layer0_expert3</title>
<path fill="none" stroke="black" d="M2094.02,-242C1731.57,-242 775,-242 775,-242 775,-242 775,-127.11 775,-127.11"/>
<polygon fill="black" stroke="black" points="778.5,-127.11 775,-117.11 771.5,-127.11 778.5,-127.11"/>
</g>
<!-- layer0_moe_all2all&#45;&gt;layer0_expert4 -->
<g id="edge30" class="edge">
<title>layer0_moe_all2all&#45;&gt;layer0_expert4</title>
<path fill="none" stroke="black" d="M2094.15,-236C1773.2,-236 999,-236 999,-236 999,-236 999,-127.34 999,-127.34"/>
<polygon fill="black" stroke="black" points="1002.5,-127.34 999,-117.34 995.5,-127.34 1002.5,-127.34"/>
</g>
<!-- layer0_moe_all2all&#45;&gt;layer0_expert5 -->
<g id="edge31" class="edge">
<title>layer0_moe_all2all&#45;&gt;layer0_expert5</title>
<path fill="none" stroke="black" d="M2099.22,-229C1825.99,-229 1223,-229 1223,-229 1223,-229 1223,-127.23 1223,-127.23"/>
<polygon fill="black" stroke="black" points="1226.5,-127.23 1223,-117.23 1219.5,-127.23 1226.5,-127.23"/>
</g>
<!-- layer0_moe_all2all&#45;&gt;layer0_expert6 -->
<g id="edge32" class="edge">
<title>layer0_moe_all2all&#45;&gt;layer0_expert6</title>
<path fill="none" stroke="black" d="M2109.36,-222C1889.15,-222 1447,-222 1447,-222 1447,-222 1447,-127 1447,-127"/>
<polygon fill="black" stroke="black" points="1450.5,-127 1447,-117 1443.5,-127 1450.5,-127"/>
</g>
<!-- layer0_moe_all2all&#45;&gt;layer0_expert7 -->
<g id="edge33" class="edge">
<title>layer0_moe_all2all&#45;&gt;layer0_expert7</title>
<path fill="none" stroke="black" d="M2126.98,-215C1965.03,-215 1671,-215 1671,-215 1671,-215 1671,-127.34 1671,-127.34"/>
<polygon fill="black" stroke="black" points="1674.5,-127.34 1671,-117.34 1667.5,-127.34 1674.5,-127.34"/>
</g>
<!-- layer0_moe_all2all&#45;&gt;layer0_expert8 -->
<g id="edge34" class="edge">
<title>layer0_moe_all2all&#45;&gt;layer0_expert8</title>
<path fill="none" stroke="black" d="M2156.51,-208C2063.09,-208 1915,-208 1915,-208 1915,-208 1915,-127.16 1915,-127.16"/>
<polygon fill="black" stroke="black" points="1918.5,-127.16 1915,-117.16 1911.5,-127.16 1918.5,-127.16"/>
</g>
<!-- layer0_moe_all2all&#45;&gt;layer0_expert9 -->
<g id="edge35" class="edge">
<title>layer0_moe_all2all&#45;&gt;layer0_expert9</title>
<path fill="none" stroke="black" d="M2157.91,-207.43C2157.91,-207.43 2157.91,-127.17 2157.91,-127.17"/>
<polygon fill="black" stroke="black" points="2161.41,-127.17 2157.91,-117.17 2154.41,-127.17 2161.41,-127.17"/>
</g>
<!-- layer0_moe_all2all&#45;&gt;layer0_expert10 -->
<g id="edge36" class="edge">
<title>layer0_moe_all2all&#45;&gt;layer0_expert10</title>
<path fill="none" stroke="black" d="M2261.36,-202.79C2261.36,-202.79 2261.36,-127.05 2261.36,-127.05"/>
<polygon fill="black" stroke="black" points="2264.86,-127.05 2261.36,-117.05 2257.86,-127.05 2264.86,-127.05"/>
</g>
<!-- layer0_moe_all2all&#45;&gt;layer0_expert11 -->
<g id="edge37" class="edge">
<title>layer0_moe_all2all&#45;&gt;layer0_expert11</title>
<path fill="none" stroke="black" d="M2324.53,-212C2417.71,-212 2547,-212 2547,-212 2547,-212 2547,-127.23 2547,-127.23"/>
<polygon fill="black" stroke="black" points="2550.5,-127.23 2547,-117.23 2543.5,-127.23 2550.5,-127.23"/>
</g>
<!-- layer0_moe_all2all&#45;&gt;layer0_expert12 -->
<g id="edge38" class="edge">
<title>layer0_moe_all2all&#45;&gt;layer0_expert12</title>
<path fill="none" stroke="black" d="M2354.27,-223C2517.06,-223 2783.34,-223 2783.34,-223 2783.34,-223 2783.34,-127.25 2783.34,-127.25"/>
<polygon fill="black" stroke="black" points="2786.84,-127.25 2783.34,-117.25 2779.84,-127.25 2786.84,-127.25"/>
</g>
<!-- layer0_moe_all2all&#45;&gt;layer0_expert13 -->
<g id="edge39" class="edge">
<title>layer0_moe_all2all&#45;&gt;layer0_expert13</title>
<path fill="none" stroke="black" d="M2366.74,-234C2589.4,-234 3007.75,-234 3007.75,-234 3007.75,-234 3007.75,-127.26 3007.75,-127.26"/>
<polygon fill="black" stroke="black" points="3011.25,-127.26 3007.75,-117.26 3004.25,-127.26 3011.25,-127.26"/>
</g>
<!-- layer0_moe_all2all&#45;&gt;layer0_expert14 -->
<g id="edge40" class="edge">
<title>layer0_moe_all2all&#45;&gt;layer0_expert14</title>
<path fill="none" stroke="black" d="M2367.19,-244C2641.58,-244 3235,-244 3235,-244 3235,-244 3235,-127.14 3235,-127.14"/>
<polygon fill="black" stroke="black" points="3238.5,-127.14 3235,-117.14 3231.5,-127.14 3238.5,-127.14"/>
</g>
<!-- layer0_moe_all2all&#45;&gt;layer0_expert15 -->
<g id="edge41" class="edge">
<title>layer0_moe_all2all&#45;&gt;layer0_expert15</title>
<path fill="none" stroke="black" d="M2355.93,-255C2667.12,-255 3452,-255 3452,-255 3452,-255 3452,-127.39 3452,-127.39"/>
<polygon fill="black" stroke="black" points="3455.5,-127.39 3452,-117.39 3448.5,-127.39 3455.5,-127.39"/>
</g>
<!-- layer0_moe_agg -->
<g id="node34" class="node">
<title>layer0_moe_agg</title>
<polygon fill="lightblue" stroke="black" points="3986.26,-166 3666.1,-166 3583.74,0 3903.9,0 3986.26,-166"/>
<text text-anchor="middle" x="3785" y="-109.3" font-family="Times,serif" font-size="14.00">Layer0 MoE</text>
<text text-anchor="middle" x="3785" y="-94.3" font-family="Times,serif" font-size="14.00">Output Aggregation</text>
<text text-anchor="middle" x="3785" y="-79.3" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="3785" y="-64.3" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1024]</text>
<text text-anchor="middle" x="3785" y="-49.3" font-family="Times,serif" font-size="14.00">GPU: 0,1,2,3</text>
</g>
<!-- layer0_moe_all2all&#45;&gt;layer0_moe_agg -->
<g id="edge42" class="edge">
<title>layer0_moe_all2all&#45;&gt;layer0_moe_agg</title>
<path fill="none" stroke="black" d="M2346.82,-219.27C2346.82,-194.56 2346.82,-156 2346.82,-156 2346.82,-156 3651.14,-156 3651.14,-156"/>
<polygon fill="black" stroke="black" points="3651.14,-159.5 3661.14,-156 3651.14,-152.5 3651.14,-159.5"/>
</g>
<!-- layer0_moe_all2all&#45;&gt;layer0_moe_agg -->
<g id="edge43" class="edge">
<title>layer0_moe_all2all&#45;&gt;layer0_moe_agg</title>
<path fill="none" stroke="black" d="M2325.45,-212.19C2325.45,-184.6 2325.45,-146 2325.45,-146 2325.45,-146 3646.12,-146 3646.12,-146"/>
<polygon fill="black" stroke="black" points="3646.12,-149.5 3656.12,-146 3646.12,-142.5 3646.12,-149.5"/>
</g>
<!-- layer0_moe_all2all&#45;&gt;layer0_moe_agg -->
<g id="edge44" class="edge">
<title>layer0_moe_all2all&#45;&gt;layer0_moe_agg</title>
<path fill="none" stroke="black" d="M2304.09,-207.59C2304.09,-177.18 2304.09,-136 2304.09,-136 2304.09,-136 3640.97,-136 3640.97,-136"/>
<polygon fill="black" stroke="black" points="3640.97,-139.5 3650.97,-136 3640.97,-132.5 3640.97,-139.5"/>
</g>
<!-- layer0_moe_all2all&#45;&gt;layer0_moe_agg -->
<g id="edge45" class="edge">
<title>layer0_moe_all2all&#45;&gt;layer0_moe_agg</title>
<path fill="none" stroke="black" d="M2282.73,-204.5C2282.73,-171.16 2282.73,-126 2282.73,-126 2282.73,-126 3636.03,-126 3636.03,-126"/>
<polygon fill="black" stroke="black" points="3636.03,-129.5 3646.03,-126 3636.03,-122.5 3636.03,-129.5"/>
</g>
<!-- layer1_attn_qkv_gpu0 -->
<g id="node35" class="node">
<title>layer1_attn_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="3103.5,-1191.83 2896.5,-1191.83 2896.5,-1108.83 3103.5,-1108.83 3103.5,-1191.83"/>
<text text-anchor="middle" x="3000" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer1 Attention QKV Proj</text>
<text text-anchor="middle" x="3000" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="3000" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="3000" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="3000" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_attn_score_gpu0 -->
<g id="node36" class="node">
<title>layer1_attn_score_gpu0</title>
<polygon fill="lightblue" stroke="black" points="3334,-1184.33 3122,-1184.33 3122,-1116.33 3334,-1116.33 3334,-1184.33"/>
<text text-anchor="middle" x="3228" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer1 Attention Scores</text>
<text text-anchor="middle" x="3228" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="3228" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="3228" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_attn_out_gpu0 -->
<g id="node37" class="node">
<title>layer1_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="3544,-1191.83 3352,-1191.83 3352,-1108.83 3544,-1108.83 3544,-1191.83"/>
<text text-anchor="middle" x="3448" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer1 Attention Output</text>
<text text-anchor="middle" x="3448" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="3448" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="3448" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="3448" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_moe_route_gpu0 -->
<g id="node38" class="node">
<title>layer1_moe_route_gpu0</title>
<polygon fill="lightblue" stroke="black" points="3939.88,-1218.33 3639.42,-1218.33 3562.12,-1082.33 3862.58,-1082.33 3939.88,-1218.33"/>
<text text-anchor="middle" x="3751" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer1 MoE Routing</text>
<text text-anchor="middle" x="3751" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="3751" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="3751" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_attn_qkv_gpu1 -->
<g id="node39" class="node">
<title>layer1_attn_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="4164.5,-1191.83 3957.5,-1191.83 3957.5,-1108.83 4164.5,-1108.83 4164.5,-1191.83"/>
<text text-anchor="middle" x="4061" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer1 Attention QKV Proj</text>
<text text-anchor="middle" x="4061" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="4061" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="4061" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="4061" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_attn_score_gpu1 -->
<g id="node40" class="node">
<title>layer1_attn_score_gpu1</title>
<polygon fill="lightblue" stroke="black" points="4395,-1184.33 4183,-1184.33 4183,-1116.33 4395,-1116.33 4395,-1184.33"/>
<text text-anchor="middle" x="4289" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer1 Attention Scores</text>
<text text-anchor="middle" x="4289" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="4289" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="4289" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_attn_out_gpu1 -->
<g id="node41" class="node">
<title>layer1_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="4605,-1191.83 4413,-1191.83 4413,-1108.83 4605,-1108.83 4605,-1191.83"/>
<text text-anchor="middle" x="4509" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer1 Attention Output</text>
<text text-anchor="middle" x="4509" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="4509" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="4509" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="4509" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_moe_route_gpu1 -->
<g id="node42" class="node">
<title>layer1_moe_route_gpu1</title>
<polygon fill="lightblue" stroke="black" points="5000.88,-1218.33 4700.42,-1218.33 4623.12,-1082.33 4923.58,-1082.33 5000.88,-1218.33"/>
<text text-anchor="middle" x="4812" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer1 MoE Routing</text>
<text text-anchor="middle" x="4812" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="4812" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="4812" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_attn_qkv_gpu2 -->
<g id="node43" class="node">
<title>layer1_attn_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="5225.5,-1191.83 5018.5,-1191.83 5018.5,-1108.83 5225.5,-1108.83 5225.5,-1191.83"/>
<text text-anchor="middle" x="5122" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer1 Attention QKV Proj</text>
<text text-anchor="middle" x="5122" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="5122" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="5122" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="5122" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_attn_score_gpu2 -->
<g id="node44" class="node">
<title>layer1_attn_score_gpu2</title>
<polygon fill="lightblue" stroke="black" points="5456,-1184.33 5244,-1184.33 5244,-1116.33 5456,-1116.33 5456,-1184.33"/>
<text text-anchor="middle" x="5350" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer1 Attention Scores</text>
<text text-anchor="middle" x="5350" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="5350" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="5350" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_attn_out_gpu2 -->
<g id="node45" class="node">
<title>layer1_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="5666,-1191.83 5474,-1191.83 5474,-1108.83 5666,-1108.83 5666,-1191.83"/>
<text text-anchor="middle" x="5570" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer1 Attention Output</text>
<text text-anchor="middle" x="5570" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="5570" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="5570" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="5570" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_moe_route_gpu2 -->
<g id="node46" class="node">
<title>layer1_moe_route_gpu2</title>
<polygon fill="lightblue" stroke="black" points="6061.88,-1218.33 5761.42,-1218.33 5684.12,-1082.33 5984.58,-1082.33 6061.88,-1218.33"/>
<text text-anchor="middle" x="5873" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer1 MoE Routing</text>
<text text-anchor="middle" x="5873" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="5873" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="5873" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_attn_qkv_gpu3 -->
<g id="node47" class="node">
<title>layer1_attn_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="6286.5,-1191.83 6079.5,-1191.83 6079.5,-1108.83 6286.5,-1108.83 6286.5,-1191.83"/>
<text text-anchor="middle" x="6183" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer1 Attention QKV Proj</text>
<text text-anchor="middle" x="6183" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="6183" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="6183" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="6183" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_attn_score_gpu3 -->
<g id="node48" class="node">
<title>layer1_attn_score_gpu3</title>
<polygon fill="lightblue" stroke="black" points="6517,-1184.33 6305,-1184.33 6305,-1116.33 6517,-1116.33 6517,-1184.33"/>
<text text-anchor="middle" x="6411" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer1 Attention Scores</text>
<text text-anchor="middle" x="6411" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="6411" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="6411" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_attn_out_gpu3 -->
<g id="node49" class="node">
<title>layer1_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="6727,-1191.83 6535,-1191.83 6535,-1108.83 6727,-1108.83 6727,-1191.83"/>
<text text-anchor="middle" x="6631" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer1 Attention Output</text>
<text text-anchor="middle" x="6631" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="6631" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="6631" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="6631" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_moe_route_gpu3 -->
<g id="node50" class="node">
<title>layer1_moe_route_gpu3</title>
<polygon fill="lightblue" stroke="black" points="7122.88,-1218.33 6822.42,-1218.33 6745.12,-1082.33 7045.58,-1082.33 7122.88,-1218.33"/>
<text text-anchor="middle" x="6934" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer1 MoE Routing</text>
<text text-anchor="middle" x="6934" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="6934" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="6934" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_attn_allreduce -->
<g id="node51" class="node">
<title>layer1_attn_allreduce</title>
<ellipse fill="lightgray" stroke="black" cx="7238" cy="-1150.33" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="7238" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer1 Attention</text>
<text text-anchor="middle" x="7238" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="7238" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 0,1,2,3</text>
</g>
<!-- layer1_moe_all2all -->
<g id="node52" class="node">
<title>layer1_moe_all2all</title>
<ellipse fill="lightgray" stroke="black" cx="7490" cy="-1150.33" rx="137.36" ry="37.45"/>
<text text-anchor="middle" x="7490" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer1 MoE</text>
<text text-anchor="middle" x="7490" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All Communication</text>
<text text-anchor="middle" x="7490" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer1_moe_agg -->
<g id="node53" class="node">
<title>layer1_moe_agg</title>
<polygon fill="lightblue" stroke="black" points="7974.69,-1203.33 7712.71,-1203.33 7645.31,-1097.33 7907.29,-1097.33 7974.69,-1203.33"/>
<text text-anchor="middle" x="7810" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer1 MoE</text>
<text text-anchor="middle" x="7810" y="-1146.63" font-family="Times,serif" font-size="14.00">Output Aggregation</text>
<text text-anchor="middle" x="7810" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 0,1,2,3</text>
</g>
<!-- layer2_attn_qkv_gpu0 -->
<g id="node54" class="node">
<title>layer2_attn_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="8199.5,-1191.83 7992.5,-1191.83 7992.5,-1108.83 8199.5,-1108.83 8199.5,-1191.83"/>
<text text-anchor="middle" x="8096" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer2 Attention QKV Proj</text>
<text text-anchor="middle" x="8096" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="8096" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="8096" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="8096" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_attn_score_gpu0 -->
<g id="node55" class="node">
<title>layer2_attn_score_gpu0</title>
<polygon fill="lightblue" stroke="black" points="8430,-1184.33 8218,-1184.33 8218,-1116.33 8430,-1116.33 8430,-1184.33"/>
<text text-anchor="middle" x="8324" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer2 Attention Scores</text>
<text text-anchor="middle" x="8324" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="8324" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="8324" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_attn_out_gpu0 -->
<g id="node56" class="node">
<title>layer2_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="8640,-1191.83 8448,-1191.83 8448,-1108.83 8640,-1108.83 8640,-1191.83"/>
<text text-anchor="middle" x="8544" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer2 Attention Output</text>
<text text-anchor="middle" x="8544" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="8544" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="8544" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="8544" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_moe_route_gpu0 -->
<g id="node57" class="node">
<title>layer2_moe_route_gpu0</title>
<polygon fill="lightblue" stroke="black" points="9035.88,-1218.33 8735.42,-1218.33 8658.12,-1082.33 8958.58,-1082.33 9035.88,-1218.33"/>
<text text-anchor="middle" x="8847" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer2 MoE Routing</text>
<text text-anchor="middle" x="8847" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="8847" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="8847" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_attn_qkv_gpu1 -->
<g id="node58" class="node">
<title>layer2_attn_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="9260.5,-1191.83 9053.5,-1191.83 9053.5,-1108.83 9260.5,-1108.83 9260.5,-1191.83"/>
<text text-anchor="middle" x="9157" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer2 Attention QKV Proj</text>
<text text-anchor="middle" x="9157" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="9157" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="9157" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="9157" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_attn_score_gpu1 -->
<g id="node59" class="node">
<title>layer2_attn_score_gpu1</title>
<polygon fill="lightblue" stroke="black" points="9491,-1184.33 9279,-1184.33 9279,-1116.33 9491,-1116.33 9491,-1184.33"/>
<text text-anchor="middle" x="9385" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer2 Attention Scores</text>
<text text-anchor="middle" x="9385" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="9385" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="9385" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_attn_out_gpu1 -->
<g id="node60" class="node">
<title>layer2_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="9701,-1191.83 9509,-1191.83 9509,-1108.83 9701,-1108.83 9701,-1191.83"/>
<text text-anchor="middle" x="9605" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer2 Attention Output</text>
<text text-anchor="middle" x="9605" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="9605" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="9605" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="9605" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_moe_route_gpu1 -->
<g id="node61" class="node">
<title>layer2_moe_route_gpu1</title>
<polygon fill="lightblue" stroke="black" points="10096.88,-1218.33 9796.42,-1218.33 9719.12,-1082.33 10019.58,-1082.33 10096.88,-1218.33"/>
<text text-anchor="middle" x="9908" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer2 MoE Routing</text>
<text text-anchor="middle" x="9908" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="9908" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="9908" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_attn_qkv_gpu2 -->
<g id="node62" class="node">
<title>layer2_attn_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="10321.5,-1191.83 10114.5,-1191.83 10114.5,-1108.83 10321.5,-1108.83 10321.5,-1191.83"/>
<text text-anchor="middle" x="10218" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer2 Attention QKV Proj</text>
<text text-anchor="middle" x="10218" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="10218" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="10218" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="10218" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_attn_score_gpu2 -->
<g id="node63" class="node">
<title>layer2_attn_score_gpu2</title>
<polygon fill="lightblue" stroke="black" points="10552,-1184.33 10340,-1184.33 10340,-1116.33 10552,-1116.33 10552,-1184.33"/>
<text text-anchor="middle" x="10446" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer2 Attention Scores</text>
<text text-anchor="middle" x="10446" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="10446" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="10446" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_attn_out_gpu2 -->
<g id="node64" class="node">
<title>layer2_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="10762,-1191.83 10570,-1191.83 10570,-1108.83 10762,-1108.83 10762,-1191.83"/>
<text text-anchor="middle" x="10666" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer2 Attention Output</text>
<text text-anchor="middle" x="10666" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="10666" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="10666" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="10666" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_moe_route_gpu2 -->
<g id="node65" class="node">
<title>layer2_moe_route_gpu2</title>
<polygon fill="lightblue" stroke="black" points="11157.88,-1218.33 10857.42,-1218.33 10780.12,-1082.33 11080.58,-1082.33 11157.88,-1218.33"/>
<text text-anchor="middle" x="10969" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer2 MoE Routing</text>
<text text-anchor="middle" x="10969" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="10969" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="10969" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_attn_qkv_gpu3 -->
<g id="node66" class="node">
<title>layer2_attn_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="11382.5,-1191.83 11175.5,-1191.83 11175.5,-1108.83 11382.5,-1108.83 11382.5,-1191.83"/>
<text text-anchor="middle" x="11279" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer2 Attention QKV Proj</text>
<text text-anchor="middle" x="11279" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="11279" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="11279" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="11279" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_attn_score_gpu3 -->
<g id="node67" class="node">
<title>layer2_attn_score_gpu3</title>
<polygon fill="lightblue" stroke="black" points="11613,-1184.33 11401,-1184.33 11401,-1116.33 11613,-1116.33 11613,-1184.33"/>
<text text-anchor="middle" x="11507" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer2 Attention Scores</text>
<text text-anchor="middle" x="11507" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="11507" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="11507" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_attn_out_gpu3 -->
<g id="node68" class="node">
<title>layer2_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="11823,-1191.83 11631,-1191.83 11631,-1108.83 11823,-1108.83 11823,-1191.83"/>
<text text-anchor="middle" x="11727" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer2 Attention Output</text>
<text text-anchor="middle" x="11727" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="11727" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="11727" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="11727" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_moe_route_gpu3 -->
<g id="node69" class="node">
<title>layer2_moe_route_gpu3</title>
<polygon fill="lightblue" stroke="black" points="12218.88,-1218.33 11918.42,-1218.33 11841.12,-1082.33 12141.58,-1082.33 12218.88,-1218.33"/>
<text text-anchor="middle" x="12030" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer2 MoE Routing</text>
<text text-anchor="middle" x="12030" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="12030" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="12030" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_attn_allreduce -->
<g id="node70" class="node">
<title>layer2_attn_allreduce</title>
<ellipse fill="lightgray" stroke="black" cx="12334" cy="-1150.33" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="12334" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer2 Attention</text>
<text text-anchor="middle" x="12334" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="12334" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 0,1,2,3</text>
</g>
<!-- layer2_moe_all2all -->
<g id="node71" class="node">
<title>layer2_moe_all2all</title>
<ellipse fill="lightgray" stroke="black" cx="12586" cy="-1150.33" rx="137.36" ry="37.45"/>
<text text-anchor="middle" x="12586" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer2 MoE</text>
<text text-anchor="middle" x="12586" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All Communication</text>
<text text-anchor="middle" x="12586" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer2_moe_agg -->
<g id="node72" class="node">
<title>layer2_moe_agg</title>
<polygon fill="lightblue" stroke="black" points="13070.69,-1203.33 12808.71,-1203.33 12741.31,-1097.33 13003.29,-1097.33 13070.69,-1203.33"/>
<text text-anchor="middle" x="12906" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer2 MoE</text>
<text text-anchor="middle" x="12906" y="-1146.63" font-family="Times,serif" font-size="14.00">Output Aggregation</text>
<text text-anchor="middle" x="12906" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 0,1,2,3</text>
</g>
<!-- layer3_attn_qkv_gpu0 -->
<g id="node73" class="node">
<title>layer3_attn_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="13295.5,-1191.83 13088.5,-1191.83 13088.5,-1108.83 13295.5,-1108.83 13295.5,-1191.83"/>
<text text-anchor="middle" x="13192" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer3 Attention QKV Proj</text>
<text text-anchor="middle" x="13192" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="13192" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="13192" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="13192" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_attn_score_gpu0 -->
<g id="node74" class="node">
<title>layer3_attn_score_gpu0</title>
<polygon fill="lightblue" stroke="black" points="13526,-1184.33 13314,-1184.33 13314,-1116.33 13526,-1116.33 13526,-1184.33"/>
<text text-anchor="middle" x="13420" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer3 Attention Scores</text>
<text text-anchor="middle" x="13420" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="13420" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="13420" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_attn_out_gpu0 -->
<g id="node75" class="node">
<title>layer3_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="13736,-1191.83 13544,-1191.83 13544,-1108.83 13736,-1108.83 13736,-1191.83"/>
<text text-anchor="middle" x="13640" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer3 Attention Output</text>
<text text-anchor="middle" x="13640" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="13640" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="13640" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="13640" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_moe_route_gpu0 -->
<g id="node76" class="node">
<title>layer3_moe_route_gpu0</title>
<polygon fill="lightblue" stroke="black" points="14131.88,-1218.33 13831.42,-1218.33 13754.12,-1082.33 14054.58,-1082.33 14131.88,-1218.33"/>
<text text-anchor="middle" x="13943" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer3 MoE Routing</text>
<text text-anchor="middle" x="13943" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="13943" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="13943" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_attn_qkv_gpu1 -->
<g id="node77" class="node">
<title>layer3_attn_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="14356.5,-1191.83 14149.5,-1191.83 14149.5,-1108.83 14356.5,-1108.83 14356.5,-1191.83"/>
<text text-anchor="middle" x="14253" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer3 Attention QKV Proj</text>
<text text-anchor="middle" x="14253" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="14253" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="14253" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="14253" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_attn_score_gpu1 -->
<g id="node78" class="node">
<title>layer3_attn_score_gpu1</title>
<polygon fill="lightblue" stroke="black" points="14587,-1184.33 14375,-1184.33 14375,-1116.33 14587,-1116.33 14587,-1184.33"/>
<text text-anchor="middle" x="14481" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer3 Attention Scores</text>
<text text-anchor="middle" x="14481" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="14481" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="14481" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_attn_out_gpu1 -->
<g id="node79" class="node">
<title>layer3_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="14797,-1191.83 14605,-1191.83 14605,-1108.83 14797,-1108.83 14797,-1191.83"/>
<text text-anchor="middle" x="14701" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer3 Attention Output</text>
<text text-anchor="middle" x="14701" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="14701" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="14701" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="14701" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_moe_route_gpu1 -->
<g id="node80" class="node">
<title>layer3_moe_route_gpu1</title>
<polygon fill="lightblue" stroke="black" points="15192.88,-1218.33 14892.42,-1218.33 14815.12,-1082.33 15115.58,-1082.33 15192.88,-1218.33"/>
<text text-anchor="middle" x="15004" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer3 MoE Routing</text>
<text text-anchor="middle" x="15004" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="15004" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="15004" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_attn_qkv_gpu2 -->
<g id="node81" class="node">
<title>layer3_attn_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="15417.5,-1191.83 15210.5,-1191.83 15210.5,-1108.83 15417.5,-1108.83 15417.5,-1191.83"/>
<text text-anchor="middle" x="15314" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer3 Attention QKV Proj</text>
<text text-anchor="middle" x="15314" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="15314" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="15314" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="15314" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_attn_score_gpu2 -->
<g id="node82" class="node">
<title>layer3_attn_score_gpu2</title>
<polygon fill="lightblue" stroke="black" points="15648,-1184.33 15436,-1184.33 15436,-1116.33 15648,-1116.33 15648,-1184.33"/>
<text text-anchor="middle" x="15542" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer3 Attention Scores</text>
<text text-anchor="middle" x="15542" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="15542" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="15542" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_attn_out_gpu2 -->
<g id="node83" class="node">
<title>layer3_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="15858,-1191.83 15666,-1191.83 15666,-1108.83 15858,-1108.83 15858,-1191.83"/>
<text text-anchor="middle" x="15762" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer3 Attention Output</text>
<text text-anchor="middle" x="15762" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="15762" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="15762" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="15762" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_moe_route_gpu2 -->
<g id="node84" class="node">
<title>layer3_moe_route_gpu2</title>
<polygon fill="lightblue" stroke="black" points="16253.88,-1218.33 15953.42,-1218.33 15876.12,-1082.33 16176.58,-1082.33 16253.88,-1218.33"/>
<text text-anchor="middle" x="16065" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer3 MoE Routing</text>
<text text-anchor="middle" x="16065" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="16065" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="16065" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_attn_qkv_gpu3 -->
<g id="node85" class="node">
<title>layer3_attn_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="16478.5,-1191.83 16271.5,-1191.83 16271.5,-1108.83 16478.5,-1108.83 16478.5,-1191.83"/>
<text text-anchor="middle" x="16375" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer3 Attention QKV Proj</text>
<text text-anchor="middle" x="16375" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="16375" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="16375" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="16375" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_attn_score_gpu3 -->
<g id="node86" class="node">
<title>layer3_attn_score_gpu3</title>
<polygon fill="lightblue" stroke="black" points="16709,-1184.33 16497,-1184.33 16497,-1116.33 16709,-1116.33 16709,-1184.33"/>
<text text-anchor="middle" x="16603" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer3 Attention Scores</text>
<text text-anchor="middle" x="16603" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="16603" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="16603" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_attn_out_gpu3 -->
<g id="node87" class="node">
<title>layer3_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="16919,-1191.83 16727,-1191.83 16727,-1108.83 16919,-1108.83 16919,-1191.83"/>
<text text-anchor="middle" x="16823" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer3 Attention Output</text>
<text text-anchor="middle" x="16823" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="16823" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="16823" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="16823" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_moe_route_gpu3 -->
<g id="node88" class="node">
<title>layer3_moe_route_gpu3</title>
<polygon fill="lightblue" stroke="black" points="17314.88,-1218.33 17014.42,-1218.33 16937.12,-1082.33 17237.58,-1082.33 17314.88,-1218.33"/>
<text text-anchor="middle" x="17126" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer3 MoE Routing</text>
<text text-anchor="middle" x="17126" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="17126" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="17126" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_attn_allreduce -->
<g id="node89" class="node">
<title>layer3_attn_allreduce</title>
<ellipse fill="lightgray" stroke="black" cx="17430" cy="-1150.33" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="17430" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer3 Attention</text>
<text text-anchor="middle" x="17430" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="17430" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 0,1,2,3</text>
</g>
<!-- layer3_moe_all2all -->
<g id="node90" class="node">
<title>layer3_moe_all2all</title>
<ellipse fill="lightgray" stroke="black" cx="17682" cy="-1150.33" rx="137.36" ry="37.45"/>
<text text-anchor="middle" x="17682" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer3 MoE</text>
<text text-anchor="middle" x="17682" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All Communication</text>
<text text-anchor="middle" x="17682" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer3_moe_agg -->
<g id="node91" class="node">
<title>layer3_moe_agg</title>
<polygon fill="lightblue" stroke="black" points="18166.69,-1203.33 17904.71,-1203.33 17837.31,-1097.33 18099.29,-1097.33 18166.69,-1203.33"/>
<text text-anchor="middle" x="18002" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer3 MoE</text>
<text text-anchor="middle" x="18002" y="-1146.63" font-family="Times,serif" font-size="14.00">Output Aggregation</text>
<text text-anchor="middle" x="18002" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 0,1,2,3</text>
</g>
<!-- layer4_attn_qkv_gpu4 -->
<g id="node92" class="node">
<title>layer4_attn_qkv_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="18391.5,-1191.83 18184.5,-1191.83 18184.5,-1108.83 18391.5,-1108.83 18391.5,-1191.83"/>
<text text-anchor="middle" x="18288" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer4 Attention QKV Proj</text>
<text text-anchor="middle" x="18288" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="18288" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="18288" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="18288" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_attn_score_gpu4 -->
<g id="node93" class="node">
<title>layer4_attn_score_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="18622,-1184.33 18410,-1184.33 18410,-1116.33 18622,-1116.33 18622,-1184.33"/>
<text text-anchor="middle" x="18516" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer4 Attention Scores</text>
<text text-anchor="middle" x="18516" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="18516" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="18516" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_attn_out_gpu4 -->
<g id="node94" class="node">
<title>layer4_attn_out_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="18832,-1191.83 18640,-1191.83 18640,-1108.83 18832,-1108.83 18832,-1191.83"/>
<text text-anchor="middle" x="18736" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer4 Attention Output</text>
<text text-anchor="middle" x="18736" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="18736" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="18736" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="18736" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_moe_route_gpu4 -->
<g id="node95" class="node">
<title>layer4_moe_route_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="19227.88,-1218.33 18927.42,-1218.33 18850.12,-1082.33 19150.58,-1082.33 19227.88,-1218.33"/>
<text text-anchor="middle" x="19039" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer4 MoE Routing</text>
<text text-anchor="middle" x="19039" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="19039" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="19039" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_attn_qkv_gpu5 -->
<g id="node96" class="node">
<title>layer4_attn_qkv_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="19452.5,-1191.83 19245.5,-1191.83 19245.5,-1108.83 19452.5,-1108.83 19452.5,-1191.83"/>
<text text-anchor="middle" x="19349" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer4 Attention QKV Proj</text>
<text text-anchor="middle" x="19349" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="19349" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="19349" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="19349" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer4_attn_score_gpu5 -->
<g id="node97" class="node">
<title>layer4_attn_score_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="19683,-1184.33 19471,-1184.33 19471,-1116.33 19683,-1116.33 19683,-1184.33"/>
<text text-anchor="middle" x="19577" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer4 Attention Scores</text>
<text text-anchor="middle" x="19577" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="19577" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="19577" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer4_attn_out_gpu5 -->
<g id="node98" class="node">
<title>layer4_attn_out_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="19893,-1191.83 19701,-1191.83 19701,-1108.83 19893,-1108.83 19893,-1191.83"/>
<text text-anchor="middle" x="19797" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer4 Attention Output</text>
<text text-anchor="middle" x="19797" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="19797" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="19797" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="19797" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer4_moe_route_gpu5 -->
<g id="node99" class="node">
<title>layer4_moe_route_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="20288.88,-1218.33 19988.42,-1218.33 19911.12,-1082.33 20211.58,-1082.33 20288.88,-1218.33"/>
<text text-anchor="middle" x="20100" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer4 MoE Routing</text>
<text text-anchor="middle" x="20100" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="20100" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="20100" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer4_attn_qkv_gpu6 -->
<g id="node100" class="node">
<title>layer4_attn_qkv_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="20513.5,-1191.83 20306.5,-1191.83 20306.5,-1108.83 20513.5,-1108.83 20513.5,-1191.83"/>
<text text-anchor="middle" x="20410" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer4 Attention QKV Proj</text>
<text text-anchor="middle" x="20410" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="20410" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="20410" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="20410" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer4_attn_score_gpu6 -->
<g id="node101" class="node">
<title>layer4_attn_score_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="20744,-1184.33 20532,-1184.33 20532,-1116.33 20744,-1116.33 20744,-1184.33"/>
<text text-anchor="middle" x="20638" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer4 Attention Scores</text>
<text text-anchor="middle" x="20638" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="20638" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="20638" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer4_attn_out_gpu6 -->
<g id="node102" class="node">
<title>layer4_attn_out_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="20954,-1191.83 20762,-1191.83 20762,-1108.83 20954,-1108.83 20954,-1191.83"/>
<text text-anchor="middle" x="20858" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer4 Attention Output</text>
<text text-anchor="middle" x="20858" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="20858" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="20858" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="20858" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer4_moe_route_gpu6 -->
<g id="node103" class="node">
<title>layer4_moe_route_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="21349.88,-1218.33 21049.42,-1218.33 20972.12,-1082.33 21272.58,-1082.33 21349.88,-1218.33"/>
<text text-anchor="middle" x="21161" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer4 MoE Routing</text>
<text text-anchor="middle" x="21161" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="21161" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="21161" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer4_attn_qkv_gpu7 -->
<g id="node104" class="node">
<title>layer4_attn_qkv_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="21574.5,-1191.83 21367.5,-1191.83 21367.5,-1108.83 21574.5,-1108.83 21574.5,-1191.83"/>
<text text-anchor="middle" x="21471" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer4 Attention QKV Proj</text>
<text text-anchor="middle" x="21471" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="21471" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="21471" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="21471" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer4_attn_score_gpu7 -->
<g id="node105" class="node">
<title>layer4_attn_score_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="21805,-1184.33 21593,-1184.33 21593,-1116.33 21805,-1116.33 21805,-1184.33"/>
<text text-anchor="middle" x="21699" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer4 Attention Scores</text>
<text text-anchor="middle" x="21699" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="21699" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="21699" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer4_attn_out_gpu7 -->
<g id="node106" class="node">
<title>layer4_attn_out_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="22015,-1191.83 21823,-1191.83 21823,-1108.83 22015,-1108.83 22015,-1191.83"/>
<text text-anchor="middle" x="21919" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer4 Attention Output</text>
<text text-anchor="middle" x="21919" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="21919" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="21919" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="21919" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer4_moe_route_gpu7 -->
<g id="node107" class="node">
<title>layer4_moe_route_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="22410.88,-1218.33 22110.42,-1218.33 22033.12,-1082.33 22333.58,-1082.33 22410.88,-1218.33"/>
<text text-anchor="middle" x="22222" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer4 MoE Routing</text>
<text text-anchor="middle" x="22222" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="22222" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="22222" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer4_attn_allreduce -->
<g id="node108" class="node">
<title>layer4_attn_allreduce</title>
<ellipse fill="lightgray" stroke="black" cx="22526" cy="-1150.33" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="22526" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer4 Attention</text>
<text text-anchor="middle" x="22526" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="22526" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 4,5,6,7</text>
</g>
<!-- layer4_moe_all2all -->
<g id="node109" class="node">
<title>layer4_moe_all2all</title>
<ellipse fill="lightgray" stroke="black" cx="22778" cy="-1150.33" rx="137.36" ry="37.45"/>
<text text-anchor="middle" x="22778" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer4 MoE</text>
<text text-anchor="middle" x="22778" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All Communication</text>
<text text-anchor="middle" x="22778" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer4_moe_agg -->
<g id="node110" class="node">
<title>layer4_moe_agg</title>
<polygon fill="lightgreen" stroke="black" points="23262.69,-1203.33 23000.71,-1203.33 22933.31,-1097.33 23195.29,-1097.33 23262.69,-1203.33"/>
<text text-anchor="middle" x="23098" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer4 MoE</text>
<text text-anchor="middle" x="23098" y="-1146.63" font-family="Times,serif" font-size="14.00">Output Aggregation</text>
<text text-anchor="middle" x="23098" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 4,5,6,7</text>
</g>
<!-- layer5_attn_qkv_gpu4 -->
<g id="node111" class="node">
<title>layer5_attn_qkv_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="23487.5,-1191.83 23280.5,-1191.83 23280.5,-1108.83 23487.5,-1108.83 23487.5,-1191.83"/>
<text text-anchor="middle" x="23384" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer5 Attention QKV Proj</text>
<text text-anchor="middle" x="23384" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="23384" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="23384" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="23384" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer5_attn_score_gpu4 -->
<g id="node112" class="node">
<title>layer5_attn_score_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="23718,-1184.33 23506,-1184.33 23506,-1116.33 23718,-1116.33 23718,-1184.33"/>
<text text-anchor="middle" x="23612" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer5 Attention Scores</text>
<text text-anchor="middle" x="23612" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="23612" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="23612" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer5_attn_out_gpu4 -->
<g id="node113" class="node">
<title>layer5_attn_out_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="23928,-1191.83 23736,-1191.83 23736,-1108.83 23928,-1108.83 23928,-1191.83"/>
<text text-anchor="middle" x="23832" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer5 Attention Output</text>
<text text-anchor="middle" x="23832" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="23832" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="23832" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="23832" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer5_moe_route_gpu4 -->
<g id="node114" class="node">
<title>layer5_moe_route_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="24323.88,-1218.33 24023.42,-1218.33 23946.12,-1082.33 24246.58,-1082.33 24323.88,-1218.33"/>
<text text-anchor="middle" x="24135" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer5 MoE Routing</text>
<text text-anchor="middle" x="24135" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="24135" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="24135" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer5_attn_qkv_gpu5 -->
<g id="node115" class="node">
<title>layer5_attn_qkv_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="24548.5,-1191.83 24341.5,-1191.83 24341.5,-1108.83 24548.5,-1108.83 24548.5,-1191.83"/>
<text text-anchor="middle" x="24445" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer5 Attention QKV Proj</text>
<text text-anchor="middle" x="24445" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="24445" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="24445" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="24445" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer5_attn_score_gpu5 -->
<g id="node116" class="node">
<title>layer5_attn_score_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="24779,-1184.33 24567,-1184.33 24567,-1116.33 24779,-1116.33 24779,-1184.33"/>
<text text-anchor="middle" x="24673" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer5 Attention Scores</text>
<text text-anchor="middle" x="24673" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="24673" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="24673" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer5_attn_out_gpu5 -->
<g id="node117" class="node">
<title>layer5_attn_out_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="24989,-1191.83 24797,-1191.83 24797,-1108.83 24989,-1108.83 24989,-1191.83"/>
<text text-anchor="middle" x="24893" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer5 Attention Output</text>
<text text-anchor="middle" x="24893" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="24893" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="24893" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="24893" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer5_moe_route_gpu5 -->
<g id="node118" class="node">
<title>layer5_moe_route_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="25384.88,-1218.33 25084.42,-1218.33 25007.12,-1082.33 25307.58,-1082.33 25384.88,-1218.33"/>
<text text-anchor="middle" x="25196" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer5 MoE Routing</text>
<text text-anchor="middle" x="25196" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="25196" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="25196" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer5_attn_qkv_gpu6 -->
<g id="node119" class="node">
<title>layer5_attn_qkv_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="25609.5,-1191.83 25402.5,-1191.83 25402.5,-1108.83 25609.5,-1108.83 25609.5,-1191.83"/>
<text text-anchor="middle" x="25506" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer5 Attention QKV Proj</text>
<text text-anchor="middle" x="25506" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="25506" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="25506" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="25506" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer5_attn_score_gpu6 -->
<g id="node120" class="node">
<title>layer5_attn_score_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="25840,-1184.33 25628,-1184.33 25628,-1116.33 25840,-1116.33 25840,-1184.33"/>
<text text-anchor="middle" x="25734" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer5 Attention Scores</text>
<text text-anchor="middle" x="25734" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="25734" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="25734" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer5_attn_out_gpu6 -->
<g id="node121" class="node">
<title>layer5_attn_out_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="26050,-1191.83 25858,-1191.83 25858,-1108.83 26050,-1108.83 26050,-1191.83"/>
<text text-anchor="middle" x="25954" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer5 Attention Output</text>
<text text-anchor="middle" x="25954" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="25954" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="25954" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="25954" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer5_moe_route_gpu6 -->
<g id="node122" class="node">
<title>layer5_moe_route_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="26445.88,-1218.33 26145.42,-1218.33 26068.12,-1082.33 26368.58,-1082.33 26445.88,-1218.33"/>
<text text-anchor="middle" x="26257" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer5 MoE Routing</text>
<text text-anchor="middle" x="26257" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="26257" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="26257" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer5_attn_qkv_gpu7 -->
<g id="node123" class="node">
<title>layer5_attn_qkv_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="26670.5,-1191.83 26463.5,-1191.83 26463.5,-1108.83 26670.5,-1108.83 26670.5,-1191.83"/>
<text text-anchor="middle" x="26567" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer5 Attention QKV Proj</text>
<text text-anchor="middle" x="26567" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="26567" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="26567" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="26567" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer5_attn_score_gpu7 -->
<g id="node124" class="node">
<title>layer5_attn_score_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="26901,-1184.33 26689,-1184.33 26689,-1116.33 26901,-1116.33 26901,-1184.33"/>
<text text-anchor="middle" x="26795" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer5 Attention Scores</text>
<text text-anchor="middle" x="26795" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="26795" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="26795" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer5_attn_out_gpu7 -->
<g id="node125" class="node">
<title>layer5_attn_out_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="27111,-1191.83 26919,-1191.83 26919,-1108.83 27111,-1108.83 27111,-1191.83"/>
<text text-anchor="middle" x="27015" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer5 Attention Output</text>
<text text-anchor="middle" x="27015" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="27015" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="27015" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="27015" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer5_moe_route_gpu7 -->
<g id="node126" class="node">
<title>layer5_moe_route_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="27506.88,-1218.33 27206.42,-1218.33 27129.12,-1082.33 27429.58,-1082.33 27506.88,-1218.33"/>
<text text-anchor="middle" x="27318" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer5 MoE Routing</text>
<text text-anchor="middle" x="27318" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="27318" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="27318" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer5_attn_allreduce -->
<g id="node127" class="node">
<title>layer5_attn_allreduce</title>
<ellipse fill="lightgray" stroke="black" cx="27622" cy="-1150.33" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="27622" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer5 Attention</text>
<text text-anchor="middle" x="27622" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="27622" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 4,5,6,7</text>
</g>
<!-- layer5_moe_all2all -->
<g id="node128" class="node">
<title>layer5_moe_all2all</title>
<ellipse fill="lightgray" stroke="black" cx="27874" cy="-1150.33" rx="137.36" ry="37.45"/>
<text text-anchor="middle" x="27874" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer5 MoE</text>
<text text-anchor="middle" x="27874" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All Communication</text>
<text text-anchor="middle" x="27874" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer5_moe_agg -->
<g id="node129" class="node">
<title>layer5_moe_agg</title>
<polygon fill="lightgreen" stroke="black" points="28358.69,-1203.33 28096.71,-1203.33 28029.31,-1097.33 28291.29,-1097.33 28358.69,-1203.33"/>
<text text-anchor="middle" x="28194" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer5 MoE</text>
<text text-anchor="middle" x="28194" y="-1146.63" font-family="Times,serif" font-size="14.00">Output Aggregation</text>
<text text-anchor="middle" x="28194" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 4,5,6,7</text>
</g>
<!-- layer6_attn_qkv_gpu4 -->
<g id="node130" class="node">
<title>layer6_attn_qkv_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="28583.5,-1191.83 28376.5,-1191.83 28376.5,-1108.83 28583.5,-1108.83 28583.5,-1191.83"/>
<text text-anchor="middle" x="28480" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer6 Attention QKV Proj</text>
<text text-anchor="middle" x="28480" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="28480" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="28480" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="28480" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer6_attn_score_gpu4 -->
<g id="node131" class="node">
<title>layer6_attn_score_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="28814,-1184.33 28602,-1184.33 28602,-1116.33 28814,-1116.33 28814,-1184.33"/>
<text text-anchor="middle" x="28708" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer6 Attention Scores</text>
<text text-anchor="middle" x="28708" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="28708" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="28708" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer6_attn_out_gpu4 -->
<g id="node132" class="node">
<title>layer6_attn_out_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="29024,-1191.83 28832,-1191.83 28832,-1108.83 29024,-1108.83 29024,-1191.83"/>
<text text-anchor="middle" x="28928" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer6 Attention Output</text>
<text text-anchor="middle" x="28928" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="28928" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="28928" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="28928" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer6_moe_route_gpu4 -->
<g id="node133" class="node">
<title>layer6_moe_route_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="29419.88,-1218.33 29119.42,-1218.33 29042.12,-1082.33 29342.58,-1082.33 29419.88,-1218.33"/>
<text text-anchor="middle" x="29231" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer6 MoE Routing</text>
<text text-anchor="middle" x="29231" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="29231" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="29231" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer6_attn_qkv_gpu5 -->
<g id="node134" class="node">
<title>layer6_attn_qkv_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="29644.5,-1191.83 29437.5,-1191.83 29437.5,-1108.83 29644.5,-1108.83 29644.5,-1191.83"/>
<text text-anchor="middle" x="29541" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer6 Attention QKV Proj</text>
<text text-anchor="middle" x="29541" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="29541" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="29541" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="29541" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer6_attn_score_gpu5 -->
<g id="node135" class="node">
<title>layer6_attn_score_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="29875,-1184.33 29663,-1184.33 29663,-1116.33 29875,-1116.33 29875,-1184.33"/>
<text text-anchor="middle" x="29769" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer6 Attention Scores</text>
<text text-anchor="middle" x="29769" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="29769" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="29769" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer6_attn_out_gpu5 -->
<g id="node136" class="node">
<title>layer6_attn_out_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="30085,-1191.83 29893,-1191.83 29893,-1108.83 30085,-1108.83 30085,-1191.83"/>
<text text-anchor="middle" x="29989" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer6 Attention Output</text>
<text text-anchor="middle" x="29989" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="29989" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="29989" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="29989" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer6_moe_route_gpu5 -->
<g id="node137" class="node">
<title>layer6_moe_route_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="30480.88,-1218.33 30180.42,-1218.33 30103.12,-1082.33 30403.58,-1082.33 30480.88,-1218.33"/>
<text text-anchor="middle" x="30292" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer6 MoE Routing</text>
<text text-anchor="middle" x="30292" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="30292" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="30292" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer6_attn_qkv_gpu6 -->
<g id="node138" class="node">
<title>layer6_attn_qkv_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="30705.5,-1191.83 30498.5,-1191.83 30498.5,-1108.83 30705.5,-1108.83 30705.5,-1191.83"/>
<text text-anchor="middle" x="30602" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer6 Attention QKV Proj</text>
<text text-anchor="middle" x="30602" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="30602" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="30602" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="30602" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer6_attn_score_gpu6 -->
<g id="node139" class="node">
<title>layer6_attn_score_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="30936,-1184.33 30724,-1184.33 30724,-1116.33 30936,-1116.33 30936,-1184.33"/>
<text text-anchor="middle" x="30830" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer6 Attention Scores</text>
<text text-anchor="middle" x="30830" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="30830" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="30830" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer6_attn_out_gpu6 -->
<g id="node140" class="node">
<title>layer6_attn_out_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="31146,-1191.83 30954,-1191.83 30954,-1108.83 31146,-1108.83 31146,-1191.83"/>
<text text-anchor="middle" x="31050" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer6 Attention Output</text>
<text text-anchor="middle" x="31050" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="31050" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="31050" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="31050" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer6_moe_route_gpu6 -->
<g id="node141" class="node">
<title>layer6_moe_route_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="31541.88,-1218.33 31241.42,-1218.33 31164.12,-1082.33 31464.58,-1082.33 31541.88,-1218.33"/>
<text text-anchor="middle" x="31353" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer6 MoE Routing</text>
<text text-anchor="middle" x="31353" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="31353" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="31353" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer6_attn_qkv_gpu7 -->
<g id="node142" class="node">
<title>layer6_attn_qkv_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="31766.5,-1191.83 31559.5,-1191.83 31559.5,-1108.83 31766.5,-1108.83 31766.5,-1191.83"/>
<text text-anchor="middle" x="31663" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer6 Attention QKV Proj</text>
<text text-anchor="middle" x="31663" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="31663" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="31663" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="31663" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer6_attn_score_gpu7 -->
<g id="node143" class="node">
<title>layer6_attn_score_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="31997,-1184.33 31785,-1184.33 31785,-1116.33 31997,-1116.33 31997,-1184.33"/>
<text text-anchor="middle" x="31891" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer6 Attention Scores</text>
<text text-anchor="middle" x="31891" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="31891" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="31891" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer6_attn_out_gpu7 -->
<g id="node144" class="node">
<title>layer6_attn_out_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="32207,-1191.83 32015,-1191.83 32015,-1108.83 32207,-1108.83 32207,-1191.83"/>
<text text-anchor="middle" x="32111" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer6 Attention Output</text>
<text text-anchor="middle" x="32111" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="32111" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="32111" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="32111" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer6_moe_route_gpu7 -->
<g id="node145" class="node">
<title>layer6_moe_route_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="32602.88,-1218.33 32302.42,-1218.33 32225.12,-1082.33 32525.58,-1082.33 32602.88,-1218.33"/>
<text text-anchor="middle" x="32414" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer6 MoE Routing</text>
<text text-anchor="middle" x="32414" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="32414" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="32414" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer6_attn_allreduce -->
<g id="node146" class="node">
<title>layer6_attn_allreduce</title>
<ellipse fill="lightgray" stroke="black" cx="32718" cy="-1150.33" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="32718" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer6 Attention</text>
<text text-anchor="middle" x="32718" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="32718" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 4,5,6,7</text>
</g>
<!-- layer6_moe_all2all -->
<g id="node147" class="node">
<title>layer6_moe_all2all</title>
<ellipse fill="lightgray" stroke="black" cx="32970" cy="-1150.33" rx="137.36" ry="37.45"/>
<text text-anchor="middle" x="32970" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer6 MoE</text>
<text text-anchor="middle" x="32970" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All Communication</text>
<text text-anchor="middle" x="32970" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer6_moe_agg -->
<g id="node148" class="node">
<title>layer6_moe_agg</title>
<polygon fill="lightgreen" stroke="black" points="33454.69,-1203.33 33192.71,-1203.33 33125.31,-1097.33 33387.29,-1097.33 33454.69,-1203.33"/>
<text text-anchor="middle" x="33290" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer6 MoE</text>
<text text-anchor="middle" x="33290" y="-1146.63" font-family="Times,serif" font-size="14.00">Output Aggregation</text>
<text text-anchor="middle" x="33290" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 4,5,6,7</text>
</g>
<!-- layer7_attn_qkv_gpu4 -->
<g id="node149" class="node">
<title>layer7_attn_qkv_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="33679.5,-1191.83 33472.5,-1191.83 33472.5,-1108.83 33679.5,-1108.83 33679.5,-1191.83"/>
<text text-anchor="middle" x="33576" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer7 Attention QKV Proj</text>
<text text-anchor="middle" x="33576" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="33576" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="33576" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="33576" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer7_attn_score_gpu4 -->
<g id="node150" class="node">
<title>layer7_attn_score_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="33910,-1184.33 33698,-1184.33 33698,-1116.33 33910,-1116.33 33910,-1184.33"/>
<text text-anchor="middle" x="33804" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer7 Attention Scores</text>
<text text-anchor="middle" x="33804" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="33804" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="33804" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer7_attn_out_gpu4 -->
<g id="node151" class="node">
<title>layer7_attn_out_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="34120,-1191.83 33928,-1191.83 33928,-1108.83 34120,-1108.83 34120,-1191.83"/>
<text text-anchor="middle" x="34024" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer7 Attention Output</text>
<text text-anchor="middle" x="34024" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="34024" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="34024" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="34024" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer7_moe_route_gpu4 -->
<g id="node152" class="node">
<title>layer7_moe_route_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="34515.88,-1218.33 34215.42,-1218.33 34138.12,-1082.33 34438.58,-1082.33 34515.88,-1218.33"/>
<text text-anchor="middle" x="34327" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer7 MoE Routing</text>
<text text-anchor="middle" x="34327" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="34327" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="34327" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer7_attn_qkv_gpu5 -->
<g id="node153" class="node">
<title>layer7_attn_qkv_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="34740.5,-1191.83 34533.5,-1191.83 34533.5,-1108.83 34740.5,-1108.83 34740.5,-1191.83"/>
<text text-anchor="middle" x="34637" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer7 Attention QKV Proj</text>
<text text-anchor="middle" x="34637" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="34637" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="34637" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="34637" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer7_attn_score_gpu5 -->
<g id="node154" class="node">
<title>layer7_attn_score_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="34971,-1184.33 34759,-1184.33 34759,-1116.33 34971,-1116.33 34971,-1184.33"/>
<text text-anchor="middle" x="34865" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer7 Attention Scores</text>
<text text-anchor="middle" x="34865" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="34865" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="34865" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer7_attn_out_gpu5 -->
<g id="node155" class="node">
<title>layer7_attn_out_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="35181,-1191.83 34989,-1191.83 34989,-1108.83 35181,-1108.83 35181,-1191.83"/>
<text text-anchor="middle" x="35085" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer7 Attention Output</text>
<text text-anchor="middle" x="35085" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="35085" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="35085" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="35085" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer7_moe_route_gpu5 -->
<g id="node156" class="node">
<title>layer7_moe_route_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="35576.88,-1218.33 35276.42,-1218.33 35199.12,-1082.33 35499.58,-1082.33 35576.88,-1218.33"/>
<text text-anchor="middle" x="35388" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer7 MoE Routing</text>
<text text-anchor="middle" x="35388" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="35388" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="35388" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer7_attn_qkv_gpu6 -->
<g id="node157" class="node">
<title>layer7_attn_qkv_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="35801.5,-1191.83 35594.5,-1191.83 35594.5,-1108.83 35801.5,-1108.83 35801.5,-1191.83"/>
<text text-anchor="middle" x="35698" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer7 Attention QKV Proj</text>
<text text-anchor="middle" x="35698" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="35698" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="35698" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="35698" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer7_attn_score_gpu6 -->
<g id="node158" class="node">
<title>layer7_attn_score_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="36032,-1184.33 35820,-1184.33 35820,-1116.33 36032,-1116.33 36032,-1184.33"/>
<text text-anchor="middle" x="35926" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer7 Attention Scores</text>
<text text-anchor="middle" x="35926" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="35926" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="35926" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer7_attn_out_gpu6 -->
<g id="node159" class="node">
<title>layer7_attn_out_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="36242,-1191.83 36050,-1191.83 36050,-1108.83 36242,-1108.83 36242,-1191.83"/>
<text text-anchor="middle" x="36146" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer7 Attention Output</text>
<text text-anchor="middle" x="36146" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="36146" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="36146" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="36146" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer7_moe_route_gpu6 -->
<g id="node160" class="node">
<title>layer7_moe_route_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="36637.88,-1218.33 36337.42,-1218.33 36260.12,-1082.33 36560.58,-1082.33 36637.88,-1218.33"/>
<text text-anchor="middle" x="36449" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer7 MoE Routing</text>
<text text-anchor="middle" x="36449" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="36449" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="36449" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer7_attn_qkv_gpu7 -->
<g id="node161" class="node">
<title>layer7_attn_qkv_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="36862.5,-1191.83 36655.5,-1191.83 36655.5,-1108.83 36862.5,-1108.83 36862.5,-1191.83"/>
<text text-anchor="middle" x="36759" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer7 Attention QKV Proj</text>
<text text-anchor="middle" x="36759" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="36759" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="36759" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="36759" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer7_attn_score_gpu7 -->
<g id="node162" class="node">
<title>layer7_attn_score_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="37093,-1184.33 36881,-1184.33 36881,-1116.33 37093,-1116.33 37093,-1184.33"/>
<text text-anchor="middle" x="36987" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer7 Attention Scores</text>
<text text-anchor="middle" x="36987" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="36987" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="36987" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer7_attn_out_gpu7 -->
<g id="node163" class="node">
<title>layer7_attn_out_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="37303,-1191.83 37111,-1191.83 37111,-1108.83 37303,-1108.83 37303,-1191.83"/>
<text text-anchor="middle" x="37207" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer7 Attention Output</text>
<text text-anchor="middle" x="37207" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="37207" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="37207" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="37207" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer7_moe_route_gpu7 -->
<g id="node164" class="node">
<title>layer7_moe_route_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="37698.88,-1218.33 37398.42,-1218.33 37321.12,-1082.33 37621.58,-1082.33 37698.88,-1218.33"/>
<text text-anchor="middle" x="37510" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer7 MoE Routing</text>
<text text-anchor="middle" x="37510" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="37510" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="37510" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer7_attn_allreduce -->
<g id="node165" class="node">
<title>layer7_attn_allreduce</title>
<ellipse fill="lightgray" stroke="black" cx="37814" cy="-1150.33" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="37814" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer7 Attention</text>
<text text-anchor="middle" x="37814" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="37814" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 4,5,6,7</text>
</g>
<!-- layer7_moe_all2all -->
<g id="node166" class="node">
<title>layer7_moe_all2all</title>
<ellipse fill="lightgray" stroke="black" cx="38066" cy="-1150.33" rx="137.36" ry="37.45"/>
<text text-anchor="middle" x="38066" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer7 MoE</text>
<text text-anchor="middle" x="38066" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All Communication</text>
<text text-anchor="middle" x="38066" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer7_moe_agg -->
<g id="node167" class="node">
<title>layer7_moe_agg</title>
<polygon fill="lightgreen" stroke="black" points="38550.69,-1203.33 38288.71,-1203.33 38221.31,-1097.33 38483.29,-1097.33 38550.69,-1203.33"/>
<text text-anchor="middle" x="38386" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer7 MoE</text>
<text text-anchor="middle" x="38386" y="-1146.63" font-family="Times,serif" font-size="14.00">Output Aggregation</text>
<text text-anchor="middle" x="38386" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 4,5,6,7</text>
</g>
<!-- layer8_attn_qkv_gpu8 -->
<g id="node168" class="node">
<title>layer8_attn_qkv_gpu8</title>
<polygon fill="lightyellow" stroke="black" points="38775.5,-1191.83 38568.5,-1191.83 38568.5,-1108.83 38775.5,-1108.83 38775.5,-1191.83"/>
<text text-anchor="middle" x="38672" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer8 Attention QKV Proj</text>
<text text-anchor="middle" x="38672" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="38672" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="38672" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="38672" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer8_attn_score_gpu8 -->
<g id="node169" class="node">
<title>layer8_attn_score_gpu8</title>
<polygon fill="lightyellow" stroke="black" points="39006,-1184.33 38794,-1184.33 38794,-1116.33 39006,-1116.33 39006,-1184.33"/>
<text text-anchor="middle" x="38900" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer8 Attention Scores</text>
<text text-anchor="middle" x="38900" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="38900" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="38900" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer8_attn_out_gpu8 -->
<g id="node170" class="node">
<title>layer8_attn_out_gpu8</title>
<polygon fill="lightyellow" stroke="black" points="39216,-1191.83 39024,-1191.83 39024,-1108.83 39216,-1108.83 39216,-1191.83"/>
<text text-anchor="middle" x="39120" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer8 Attention Output</text>
<text text-anchor="middle" x="39120" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="39120" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="39120" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="39120" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer8_moe_route_gpu8 -->
<g id="node171" class="node">
<title>layer8_moe_route_gpu8</title>
<polygon fill="lightyellow" stroke="black" points="39611.88,-1218.33 39311.42,-1218.33 39234.12,-1082.33 39534.58,-1082.33 39611.88,-1218.33"/>
<text text-anchor="middle" x="39423" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer8 MoE Routing</text>
<text text-anchor="middle" x="39423" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="39423" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="39423" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer8_attn_qkv_gpu9 -->
<g id="node172" class="node">
<title>layer8_attn_qkv_gpu9</title>
<polygon fill="lightyellow" stroke="black" points="39836.5,-1191.83 39629.5,-1191.83 39629.5,-1108.83 39836.5,-1108.83 39836.5,-1191.83"/>
<text text-anchor="middle" x="39733" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer8 Attention QKV Proj</text>
<text text-anchor="middle" x="39733" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="39733" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="39733" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="39733" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer8_attn_score_gpu9 -->
<g id="node173" class="node">
<title>layer8_attn_score_gpu9</title>
<polygon fill="lightyellow" stroke="black" points="40067,-1184.33 39855,-1184.33 39855,-1116.33 40067,-1116.33 40067,-1184.33"/>
<text text-anchor="middle" x="39961" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer8 Attention Scores</text>
<text text-anchor="middle" x="39961" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="39961" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="39961" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer8_attn_out_gpu9 -->
<g id="node174" class="node">
<title>layer8_attn_out_gpu9</title>
<polygon fill="lightyellow" stroke="black" points="40277,-1191.83 40085,-1191.83 40085,-1108.83 40277,-1108.83 40277,-1191.83"/>
<text text-anchor="middle" x="40181" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer8 Attention Output</text>
<text text-anchor="middle" x="40181" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="40181" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="40181" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="40181" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer8_moe_route_gpu9 -->
<g id="node175" class="node">
<title>layer8_moe_route_gpu9</title>
<polygon fill="lightyellow" stroke="black" points="40672.88,-1218.33 40372.42,-1218.33 40295.12,-1082.33 40595.58,-1082.33 40672.88,-1218.33"/>
<text text-anchor="middle" x="40484" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer8 MoE Routing</text>
<text text-anchor="middle" x="40484" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="40484" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="40484" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer8_attn_qkv_gpu10 -->
<g id="node176" class="node">
<title>layer8_attn_qkv_gpu10</title>
<polygon fill="lightyellow" stroke="black" points="40897.5,-1191.83 40690.5,-1191.83 40690.5,-1108.83 40897.5,-1108.83 40897.5,-1191.83"/>
<text text-anchor="middle" x="40794" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer8 Attention QKV Proj</text>
<text text-anchor="middle" x="40794" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="40794" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="40794" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="40794" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer8_attn_score_gpu10 -->
<g id="node177" class="node">
<title>layer8_attn_score_gpu10</title>
<polygon fill="lightyellow" stroke="black" points="41128,-1184.33 40916,-1184.33 40916,-1116.33 41128,-1116.33 41128,-1184.33"/>
<text text-anchor="middle" x="41022" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer8 Attention Scores</text>
<text text-anchor="middle" x="41022" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="41022" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="41022" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer8_attn_out_gpu10 -->
<g id="node178" class="node">
<title>layer8_attn_out_gpu10</title>
<polygon fill="lightyellow" stroke="black" points="41338,-1191.83 41146,-1191.83 41146,-1108.83 41338,-1108.83 41338,-1191.83"/>
<text text-anchor="middle" x="41242" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer8 Attention Output</text>
<text text-anchor="middle" x="41242" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="41242" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="41242" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="41242" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer8_moe_route_gpu10 -->
<g id="node179" class="node">
<title>layer8_moe_route_gpu10</title>
<polygon fill="lightyellow" stroke="black" points="41733.88,-1218.33 41433.42,-1218.33 41356.12,-1082.33 41656.58,-1082.33 41733.88,-1218.33"/>
<text text-anchor="middle" x="41545" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer8 MoE Routing</text>
<text text-anchor="middle" x="41545" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="41545" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="41545" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer8_attn_qkv_gpu11 -->
<g id="node180" class="node">
<title>layer8_attn_qkv_gpu11</title>
<polygon fill="lightyellow" stroke="black" points="41958.5,-1191.83 41751.5,-1191.83 41751.5,-1108.83 41958.5,-1108.83 41958.5,-1191.83"/>
<text text-anchor="middle" x="41855" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer8 Attention QKV Proj</text>
<text text-anchor="middle" x="41855" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="41855" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="41855" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="41855" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer8_attn_score_gpu11 -->
<g id="node181" class="node">
<title>layer8_attn_score_gpu11</title>
<polygon fill="lightyellow" stroke="black" points="42189,-1184.33 41977,-1184.33 41977,-1116.33 42189,-1116.33 42189,-1184.33"/>
<text text-anchor="middle" x="42083" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer8 Attention Scores</text>
<text text-anchor="middle" x="42083" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="42083" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="42083" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer8_attn_out_gpu11 -->
<g id="node182" class="node">
<title>layer8_attn_out_gpu11</title>
<polygon fill="lightyellow" stroke="black" points="42399,-1191.83 42207,-1191.83 42207,-1108.83 42399,-1108.83 42399,-1191.83"/>
<text text-anchor="middle" x="42303" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer8 Attention Output</text>
<text text-anchor="middle" x="42303" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="42303" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="42303" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="42303" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer8_moe_route_gpu11 -->
<g id="node183" class="node">
<title>layer8_moe_route_gpu11</title>
<polygon fill="lightyellow" stroke="black" points="42794.88,-1218.33 42494.42,-1218.33 42417.12,-1082.33 42717.58,-1082.33 42794.88,-1218.33"/>
<text text-anchor="middle" x="42606" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer8 MoE Routing</text>
<text text-anchor="middle" x="42606" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="42606" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="42606" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer8_attn_allreduce -->
<g id="node184" class="node">
<title>layer8_attn_allreduce</title>
<ellipse fill="lightgray" stroke="black" cx="42910" cy="-1150.33" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="42910" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer8 Attention</text>
<text text-anchor="middle" x="42910" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="42910" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 8,9,10,11</text>
</g>
<!-- layer8_moe_all2all -->
<g id="node185" class="node">
<title>layer8_moe_all2all</title>
<ellipse fill="lightgray" stroke="black" cx="43162" cy="-1150.33" rx="137.36" ry="37.45"/>
<text text-anchor="middle" x="43162" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer8 MoE</text>
<text text-anchor="middle" x="43162" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All Communication</text>
<text text-anchor="middle" x="43162" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer8_moe_agg -->
<g id="node186" class="node">
<title>layer8_moe_agg</title>
<polygon fill="lightyellow" stroke="black" points="43646.69,-1203.33 43384.71,-1203.33 43317.31,-1097.33 43579.29,-1097.33 43646.69,-1203.33"/>
<text text-anchor="middle" x="43482" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer8 MoE</text>
<text text-anchor="middle" x="43482" y="-1146.63" font-family="Times,serif" font-size="14.00">Output Aggregation</text>
<text text-anchor="middle" x="43482" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 8,9,10,11</text>
</g>
<!-- layer9_attn_qkv_gpu8 -->
<g id="node187" class="node">
<title>layer9_attn_qkv_gpu8</title>
<polygon fill="lightyellow" stroke="black" points="43871.5,-1191.83 43664.5,-1191.83 43664.5,-1108.83 43871.5,-1108.83 43871.5,-1191.83"/>
<text text-anchor="middle" x="43768" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer9 Attention QKV Proj</text>
<text text-anchor="middle" x="43768" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="43768" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="43768" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="43768" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer9_attn_score_gpu8 -->
<g id="node188" class="node">
<title>layer9_attn_score_gpu8</title>
<polygon fill="lightyellow" stroke="black" points="44102,-1184.33 43890,-1184.33 43890,-1116.33 44102,-1116.33 44102,-1184.33"/>
<text text-anchor="middle" x="43996" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer9 Attention Scores</text>
<text text-anchor="middle" x="43996" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="43996" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="43996" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer9_attn_out_gpu8 -->
<g id="node189" class="node">
<title>layer9_attn_out_gpu8</title>
<polygon fill="lightyellow" stroke="black" points="44312,-1191.83 44120,-1191.83 44120,-1108.83 44312,-1108.83 44312,-1191.83"/>
<text text-anchor="middle" x="44216" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer9 Attention Output</text>
<text text-anchor="middle" x="44216" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="44216" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="44216" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="44216" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer9_moe_route_gpu8 -->
<g id="node190" class="node">
<title>layer9_moe_route_gpu8</title>
<polygon fill="lightyellow" stroke="black" points="44707.88,-1218.33 44407.42,-1218.33 44330.12,-1082.33 44630.58,-1082.33 44707.88,-1218.33"/>
<text text-anchor="middle" x="44519" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer9 MoE Routing</text>
<text text-anchor="middle" x="44519" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="44519" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="44519" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer9_attn_qkv_gpu9 -->
<g id="node191" class="node">
<title>layer9_attn_qkv_gpu9</title>
<polygon fill="lightyellow" stroke="black" points="44932.5,-1191.83 44725.5,-1191.83 44725.5,-1108.83 44932.5,-1108.83 44932.5,-1191.83"/>
<text text-anchor="middle" x="44829" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer9 Attention QKV Proj</text>
<text text-anchor="middle" x="44829" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="44829" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="44829" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="44829" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer9_attn_score_gpu9 -->
<g id="node192" class="node">
<title>layer9_attn_score_gpu9</title>
<polygon fill="lightyellow" stroke="black" points="45163,-1184.33 44951,-1184.33 44951,-1116.33 45163,-1116.33 45163,-1184.33"/>
<text text-anchor="middle" x="45057" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer9 Attention Scores</text>
<text text-anchor="middle" x="45057" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="45057" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="45057" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer9_attn_out_gpu9 -->
<g id="node193" class="node">
<title>layer9_attn_out_gpu9</title>
<polygon fill="lightyellow" stroke="black" points="45373,-1191.83 45181,-1191.83 45181,-1108.83 45373,-1108.83 45373,-1191.83"/>
<text text-anchor="middle" x="45277" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer9 Attention Output</text>
<text text-anchor="middle" x="45277" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="45277" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="45277" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="45277" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer9_moe_route_gpu9 -->
<g id="node194" class="node">
<title>layer9_moe_route_gpu9</title>
<polygon fill="lightyellow" stroke="black" points="45768.88,-1218.33 45468.42,-1218.33 45391.12,-1082.33 45691.58,-1082.33 45768.88,-1218.33"/>
<text text-anchor="middle" x="45580" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer9 MoE Routing</text>
<text text-anchor="middle" x="45580" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="45580" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="45580" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer9_attn_qkv_gpu10 -->
<g id="node195" class="node">
<title>layer9_attn_qkv_gpu10</title>
<polygon fill="lightyellow" stroke="black" points="45993.5,-1191.83 45786.5,-1191.83 45786.5,-1108.83 45993.5,-1108.83 45993.5,-1191.83"/>
<text text-anchor="middle" x="45890" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer9 Attention QKV Proj</text>
<text text-anchor="middle" x="45890" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="45890" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="45890" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="45890" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer9_attn_score_gpu10 -->
<g id="node196" class="node">
<title>layer9_attn_score_gpu10</title>
<polygon fill="lightyellow" stroke="black" points="46224,-1184.33 46012,-1184.33 46012,-1116.33 46224,-1116.33 46224,-1184.33"/>
<text text-anchor="middle" x="46118" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer9 Attention Scores</text>
<text text-anchor="middle" x="46118" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="46118" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="46118" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer9_attn_out_gpu10 -->
<g id="node197" class="node">
<title>layer9_attn_out_gpu10</title>
<polygon fill="lightyellow" stroke="black" points="46434,-1191.83 46242,-1191.83 46242,-1108.83 46434,-1108.83 46434,-1191.83"/>
<text text-anchor="middle" x="46338" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer9 Attention Output</text>
<text text-anchor="middle" x="46338" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="46338" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="46338" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="46338" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer9_moe_route_gpu10 -->
<g id="node198" class="node">
<title>layer9_moe_route_gpu10</title>
<polygon fill="lightyellow" stroke="black" points="46829.88,-1218.33 46529.42,-1218.33 46452.12,-1082.33 46752.58,-1082.33 46829.88,-1218.33"/>
<text text-anchor="middle" x="46641" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer9 MoE Routing</text>
<text text-anchor="middle" x="46641" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="46641" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="46641" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer9_attn_qkv_gpu11 -->
<g id="node199" class="node">
<title>layer9_attn_qkv_gpu11</title>
<polygon fill="lightyellow" stroke="black" points="47054.5,-1191.83 46847.5,-1191.83 46847.5,-1108.83 47054.5,-1108.83 47054.5,-1191.83"/>
<text text-anchor="middle" x="46951" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer9 Attention QKV Proj</text>
<text text-anchor="middle" x="46951" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="46951" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="46951" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="46951" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer9_attn_score_gpu11 -->
<g id="node200" class="node">
<title>layer9_attn_score_gpu11</title>
<polygon fill="lightyellow" stroke="black" points="47285,-1184.33 47073,-1184.33 47073,-1116.33 47285,-1116.33 47285,-1184.33"/>
<text text-anchor="middle" x="47179" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer9 Attention Scores</text>
<text text-anchor="middle" x="47179" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="47179" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="47179" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer9_attn_out_gpu11 -->
<g id="node201" class="node">
<title>layer9_attn_out_gpu11</title>
<polygon fill="lightyellow" stroke="black" points="47495,-1191.83 47303,-1191.83 47303,-1108.83 47495,-1108.83 47495,-1191.83"/>
<text text-anchor="middle" x="47399" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer9 Attention Output</text>
<text text-anchor="middle" x="47399" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="47399" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="47399" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="47399" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer9_moe_route_gpu11 -->
<g id="node202" class="node">
<title>layer9_moe_route_gpu11</title>
<polygon fill="lightyellow" stroke="black" points="47890.88,-1218.33 47590.42,-1218.33 47513.12,-1082.33 47813.58,-1082.33 47890.88,-1218.33"/>
<text text-anchor="middle" x="47702" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer9 MoE Routing</text>
<text text-anchor="middle" x="47702" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="47702" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="47702" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer9_attn_allreduce -->
<g id="node203" class="node">
<title>layer9_attn_allreduce</title>
<ellipse fill="lightgray" stroke="black" cx="48006" cy="-1150.33" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="48006" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer9 Attention</text>
<text text-anchor="middle" x="48006" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="48006" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 8,9,10,11</text>
</g>
<!-- layer9_moe_all2all -->
<g id="node204" class="node">
<title>layer9_moe_all2all</title>
<ellipse fill="lightgray" stroke="black" cx="48258" cy="-1150.33" rx="137.36" ry="37.45"/>
<text text-anchor="middle" x="48258" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer9 MoE</text>
<text text-anchor="middle" x="48258" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All Communication</text>
<text text-anchor="middle" x="48258" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer9_moe_agg -->
<g id="node205" class="node">
<title>layer9_moe_agg</title>
<polygon fill="lightyellow" stroke="black" points="48742.69,-1203.33 48480.71,-1203.33 48413.31,-1097.33 48675.29,-1097.33 48742.69,-1203.33"/>
<text text-anchor="middle" x="48578" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer9 MoE</text>
<text text-anchor="middle" x="48578" y="-1146.63" font-family="Times,serif" font-size="14.00">Output Aggregation</text>
<text text-anchor="middle" x="48578" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 8,9,10,11</text>
</g>
<!-- layer10_attn_qkv_gpu8 -->
<g id="node206" class="node">
<title>layer10_attn_qkv_gpu8</title>
<polygon fill="lightyellow" stroke="black" points="48977,-1191.83 48761,-1191.83 48761,-1108.83 48977,-1108.83 48977,-1191.83"/>
<text text-anchor="middle" x="48869" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer10 Attention QKV Proj</text>
<text text-anchor="middle" x="48869" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="48869" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="48869" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="48869" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer10_attn_score_gpu8 -->
<g id="node207" class="node">
<title>layer10_attn_score_gpu8</title>
<polygon fill="lightyellow" stroke="black" points="49207,-1184.33 48995,-1184.33 48995,-1116.33 49207,-1116.33 49207,-1184.33"/>
<text text-anchor="middle" x="49101" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer10 Attention Scores</text>
<text text-anchor="middle" x="49101" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="49101" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="49101" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer10_attn_out_gpu8 -->
<g id="node208" class="node">
<title>layer10_attn_out_gpu8</title>
<polygon fill="lightyellow" stroke="black" points="49426.5,-1191.83 49225.5,-1191.83 49225.5,-1108.83 49426.5,-1108.83 49426.5,-1191.83"/>
<text text-anchor="middle" x="49326" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer10 Attention Output</text>
<text text-anchor="middle" x="49326" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="49326" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="49326" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="49326" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer10_moe_route_gpu8 -->
<g id="node209" class="node">
<title>layer10_moe_route_gpu8</title>
<polygon fill="lightyellow" stroke="black" points="49821.88,-1218.33 49521.42,-1218.33 49444.12,-1082.33 49744.58,-1082.33 49821.88,-1218.33"/>
<text text-anchor="middle" x="49633" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer10 MoE Routing</text>
<text text-anchor="middle" x="49633" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="49633" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="49633" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer10_attn_qkv_gpu9 -->
<g id="node210" class="node">
<title>layer10_attn_qkv_gpu9</title>
<polygon fill="lightyellow" stroke="black" points="50056,-1191.83 49840,-1191.83 49840,-1108.83 50056,-1108.83 50056,-1191.83"/>
<text text-anchor="middle" x="49948" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer10 Attention QKV Proj</text>
<text text-anchor="middle" x="49948" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="49948" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="49948" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="49948" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer10_attn_score_gpu9 -->
<g id="node211" class="node">
<title>layer10_attn_score_gpu9</title>
<polygon fill="lightyellow" stroke="black" points="50286,-1184.33 50074,-1184.33 50074,-1116.33 50286,-1116.33 50286,-1184.33"/>
<text text-anchor="middle" x="50180" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer10 Attention Scores</text>
<text text-anchor="middle" x="50180" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="50180" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="50180" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer10_attn_out_gpu9 -->
<g id="node212" class="node">
<title>layer10_attn_out_gpu9</title>
<polygon fill="lightyellow" stroke="black" points="50505.5,-1191.83 50304.5,-1191.83 50304.5,-1108.83 50505.5,-1108.83 50505.5,-1191.83"/>
<text text-anchor="middle" x="50405" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer10 Attention Output</text>
<text text-anchor="middle" x="50405" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="50405" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="50405" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="50405" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer10_moe_route_gpu9 -->
<g id="node213" class="node">
<title>layer10_moe_route_gpu9</title>
<polygon fill="lightyellow" stroke="black" points="50900.88,-1218.33 50600.42,-1218.33 50523.12,-1082.33 50823.58,-1082.33 50900.88,-1218.33"/>
<text text-anchor="middle" x="50712" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer10 MoE Routing</text>
<text text-anchor="middle" x="50712" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="50712" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="50712" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer10_attn_qkv_gpu10 -->
<g id="node214" class="node">
<title>layer10_attn_qkv_gpu10</title>
<polygon fill="lightyellow" stroke="black" points="51135,-1191.83 50919,-1191.83 50919,-1108.83 51135,-1108.83 51135,-1191.83"/>
<text text-anchor="middle" x="51027" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer10 Attention QKV Proj</text>
<text text-anchor="middle" x="51027" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="51027" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="51027" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="51027" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer10_attn_score_gpu10 -->
<g id="node215" class="node">
<title>layer10_attn_score_gpu10</title>
<polygon fill="lightyellow" stroke="black" points="51365,-1184.33 51153,-1184.33 51153,-1116.33 51365,-1116.33 51365,-1184.33"/>
<text text-anchor="middle" x="51259" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer10 Attention Scores</text>
<text text-anchor="middle" x="51259" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="51259" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="51259" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer10_attn_out_gpu10 -->
<g id="node216" class="node">
<title>layer10_attn_out_gpu10</title>
<polygon fill="lightyellow" stroke="black" points="51584.5,-1191.83 51383.5,-1191.83 51383.5,-1108.83 51584.5,-1108.83 51584.5,-1191.83"/>
<text text-anchor="middle" x="51484" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer10 Attention Output</text>
<text text-anchor="middle" x="51484" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="51484" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="51484" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="51484" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer10_moe_route_gpu10 -->
<g id="node217" class="node">
<title>layer10_moe_route_gpu10</title>
<polygon fill="lightyellow" stroke="black" points="51979.88,-1218.33 51679.42,-1218.33 51602.12,-1082.33 51902.58,-1082.33 51979.88,-1218.33"/>
<text text-anchor="middle" x="51791" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer10 MoE Routing</text>
<text text-anchor="middle" x="51791" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="51791" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="51791" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer10_attn_qkv_gpu11 -->
<g id="node218" class="node">
<title>layer10_attn_qkv_gpu11</title>
<polygon fill="lightyellow" stroke="black" points="52214,-1191.83 51998,-1191.83 51998,-1108.83 52214,-1108.83 52214,-1191.83"/>
<text text-anchor="middle" x="52106" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer10 Attention QKV Proj</text>
<text text-anchor="middle" x="52106" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="52106" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="52106" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="52106" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer10_attn_score_gpu11 -->
<g id="node219" class="node">
<title>layer10_attn_score_gpu11</title>
<polygon fill="lightyellow" stroke="black" points="52444,-1184.33 52232,-1184.33 52232,-1116.33 52444,-1116.33 52444,-1184.33"/>
<text text-anchor="middle" x="52338" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer10 Attention Scores</text>
<text text-anchor="middle" x="52338" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="52338" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="52338" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer10_attn_out_gpu11 -->
<g id="node220" class="node">
<title>layer10_attn_out_gpu11</title>
<polygon fill="lightyellow" stroke="black" points="52663.5,-1191.83 52462.5,-1191.83 52462.5,-1108.83 52663.5,-1108.83 52663.5,-1191.83"/>
<text text-anchor="middle" x="52563" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer10 Attention Output</text>
<text text-anchor="middle" x="52563" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="52563" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="52563" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="52563" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer10_moe_route_gpu11 -->
<g id="node221" class="node">
<title>layer10_moe_route_gpu11</title>
<polygon fill="lightyellow" stroke="black" points="53058.88,-1218.33 52758.42,-1218.33 52681.12,-1082.33 52981.58,-1082.33 53058.88,-1218.33"/>
<text text-anchor="middle" x="52870" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer10 MoE Routing</text>
<text text-anchor="middle" x="52870" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="52870" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="52870" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer10_attn_allreduce -->
<g id="node222" class="node">
<title>layer10_attn_allreduce</title>
<ellipse fill="lightgray" stroke="black" cx="53180" cy="-1150.33" rx="103.48" ry="37.45"/>
<text text-anchor="middle" x="53180" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer10 Attention</text>
<text text-anchor="middle" x="53180" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="53180" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 8,9,10,11</text>
</g>
<!-- layer10_moe_all2all -->
<g id="node223" class="node">
<title>layer10_moe_all2all</title>
<ellipse fill="lightgray" stroke="black" cx="53438" cy="-1150.33" rx="137.36" ry="37.45"/>
<text text-anchor="middle" x="53438" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer10 MoE</text>
<text text-anchor="middle" x="53438" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All Communication</text>
<text text-anchor="middle" x="53438" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer10_moe_agg -->
<g id="node224" class="node">
<title>layer10_moe_agg</title>
<polygon fill="lightyellow" stroke="black" points="53922.69,-1203.33 53660.71,-1203.33 53593.31,-1097.33 53855.29,-1097.33 53922.69,-1203.33"/>
<text text-anchor="middle" x="53758" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer10 MoE</text>
<text text-anchor="middle" x="53758" y="-1146.63" font-family="Times,serif" font-size="14.00">Output Aggregation</text>
<text text-anchor="middle" x="53758" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 8,9,10,11</text>
</g>
<!-- layer11_attn_qkv_gpu8 -->
<g id="node225" class="node">
<title>layer11_attn_qkv_gpu8</title>
<polygon fill="lightyellow" stroke="black" points="54157,-1191.83 53941,-1191.83 53941,-1108.83 54157,-1108.83 54157,-1191.83"/>
<text text-anchor="middle" x="54049" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer11 Attention QKV Proj</text>
<text text-anchor="middle" x="54049" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="54049" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="54049" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="54049" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer11_attn_score_gpu8 -->
<g id="node226" class="node">
<title>layer11_attn_score_gpu8</title>
<polygon fill="lightyellow" stroke="black" points="54387,-1184.33 54175,-1184.33 54175,-1116.33 54387,-1116.33 54387,-1184.33"/>
<text text-anchor="middle" x="54281" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer11 Attention Scores</text>
<text text-anchor="middle" x="54281" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="54281" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="54281" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer11_attn_out_gpu8 -->
<g id="node227" class="node">
<title>layer11_attn_out_gpu8</title>
<polygon fill="lightyellow" stroke="black" points="54606.5,-1191.83 54405.5,-1191.83 54405.5,-1108.83 54606.5,-1108.83 54606.5,-1191.83"/>
<text text-anchor="middle" x="54506" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer11 Attention Output</text>
<text text-anchor="middle" x="54506" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="54506" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="54506" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="54506" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer11_moe_route_gpu8 -->
<g id="node228" class="node">
<title>layer11_moe_route_gpu8</title>
<polygon fill="lightyellow" stroke="black" points="55001.88,-1218.33 54701.42,-1218.33 54624.12,-1082.33 54924.58,-1082.33 55001.88,-1218.33"/>
<text text-anchor="middle" x="54813" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer11 MoE Routing</text>
<text text-anchor="middle" x="54813" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="54813" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="54813" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer11_attn_qkv_gpu9 -->
<g id="node229" class="node">
<title>layer11_attn_qkv_gpu9</title>
<polygon fill="lightyellow" stroke="black" points="55236,-1191.83 55020,-1191.83 55020,-1108.83 55236,-1108.83 55236,-1191.83"/>
<text text-anchor="middle" x="55128" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer11 Attention QKV Proj</text>
<text text-anchor="middle" x="55128" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="55128" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="55128" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="55128" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer11_attn_score_gpu9 -->
<g id="node230" class="node">
<title>layer11_attn_score_gpu9</title>
<polygon fill="lightyellow" stroke="black" points="55466,-1184.33 55254,-1184.33 55254,-1116.33 55466,-1116.33 55466,-1184.33"/>
<text text-anchor="middle" x="55360" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer11 Attention Scores</text>
<text text-anchor="middle" x="55360" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="55360" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="55360" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer11_attn_out_gpu9 -->
<g id="node231" class="node">
<title>layer11_attn_out_gpu9</title>
<polygon fill="lightyellow" stroke="black" points="55685.5,-1191.83 55484.5,-1191.83 55484.5,-1108.83 55685.5,-1108.83 55685.5,-1191.83"/>
<text text-anchor="middle" x="55585" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer11 Attention Output</text>
<text text-anchor="middle" x="55585" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="55585" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="55585" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="55585" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer11_moe_route_gpu9 -->
<g id="node232" class="node">
<title>layer11_moe_route_gpu9</title>
<polygon fill="lightyellow" stroke="black" points="56080.88,-1218.33 55780.42,-1218.33 55703.12,-1082.33 56003.58,-1082.33 56080.88,-1218.33"/>
<text text-anchor="middle" x="55892" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer11 MoE Routing</text>
<text text-anchor="middle" x="55892" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="55892" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="55892" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer11_attn_qkv_gpu10 -->
<g id="node233" class="node">
<title>layer11_attn_qkv_gpu10</title>
<polygon fill="lightyellow" stroke="black" points="56315,-1191.83 56099,-1191.83 56099,-1108.83 56315,-1108.83 56315,-1191.83"/>
<text text-anchor="middle" x="56207" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer11 Attention QKV Proj</text>
<text text-anchor="middle" x="56207" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="56207" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="56207" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="56207" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer11_attn_score_gpu10 -->
<g id="node234" class="node">
<title>layer11_attn_score_gpu10</title>
<polygon fill="lightyellow" stroke="black" points="56545,-1184.33 56333,-1184.33 56333,-1116.33 56545,-1116.33 56545,-1184.33"/>
<text text-anchor="middle" x="56439" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer11 Attention Scores</text>
<text text-anchor="middle" x="56439" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="56439" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="56439" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer11_attn_out_gpu10 -->
<g id="node235" class="node">
<title>layer11_attn_out_gpu10</title>
<polygon fill="lightyellow" stroke="black" points="56764.5,-1191.83 56563.5,-1191.83 56563.5,-1108.83 56764.5,-1108.83 56764.5,-1191.83"/>
<text text-anchor="middle" x="56664" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer11 Attention Output</text>
<text text-anchor="middle" x="56664" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="56664" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="56664" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="56664" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer11_moe_route_gpu10 -->
<g id="node236" class="node">
<title>layer11_moe_route_gpu10</title>
<polygon fill="lightyellow" stroke="black" points="57159.88,-1218.33 56859.42,-1218.33 56782.12,-1082.33 57082.58,-1082.33 57159.88,-1218.33"/>
<text text-anchor="middle" x="56971" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer11 MoE Routing</text>
<text text-anchor="middle" x="56971" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="56971" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="56971" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer11_attn_qkv_gpu11 -->
<g id="node237" class="node">
<title>layer11_attn_qkv_gpu11</title>
<polygon fill="lightyellow" stroke="black" points="57394,-1191.83 57178,-1191.83 57178,-1108.83 57394,-1108.83 57394,-1191.83"/>
<text text-anchor="middle" x="57286" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer11 Attention QKV Proj</text>
<text text-anchor="middle" x="57286" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="57286" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="57286" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="57286" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer11_attn_score_gpu11 -->
<g id="node238" class="node">
<title>layer11_attn_score_gpu11</title>
<polygon fill="lightyellow" stroke="black" points="57624,-1184.33 57412,-1184.33 57412,-1116.33 57624,-1116.33 57624,-1184.33"/>
<text text-anchor="middle" x="57518" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer11 Attention Scores</text>
<text text-anchor="middle" x="57518" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="57518" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="57518" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer11_attn_out_gpu11 -->
<g id="node239" class="node">
<title>layer11_attn_out_gpu11</title>
<polygon fill="lightyellow" stroke="black" points="57843.5,-1191.83 57642.5,-1191.83 57642.5,-1108.83 57843.5,-1108.83 57843.5,-1191.83"/>
<text text-anchor="middle" x="57743" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer11 Attention Output</text>
<text text-anchor="middle" x="57743" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="57743" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="57743" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="57743" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer11_moe_route_gpu11 -->
<g id="node240" class="node">
<title>layer11_moe_route_gpu11</title>
<polygon fill="lightyellow" stroke="black" points="58238.88,-1218.33 57938.42,-1218.33 57861.12,-1082.33 58161.58,-1082.33 58238.88,-1218.33"/>
<text text-anchor="middle" x="58050" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer11 MoE Routing</text>
<text text-anchor="middle" x="58050" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="58050" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="58050" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer11_attn_allreduce -->
<g id="node241" class="node">
<title>layer11_attn_allreduce</title>
<ellipse fill="lightgray" stroke="black" cx="58360" cy="-1150.33" rx="103.48" ry="37.45"/>
<text text-anchor="middle" x="58360" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer11 Attention</text>
<text text-anchor="middle" x="58360" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="58360" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 8,9,10,11</text>
</g>
<!-- layer11_moe_all2all -->
<g id="node242" class="node">
<title>layer11_moe_all2all</title>
<ellipse fill="lightgray" stroke="black" cx="58618" cy="-1150.33" rx="137.36" ry="37.45"/>
<text text-anchor="middle" x="58618" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer11 MoE</text>
<text text-anchor="middle" x="58618" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All Communication</text>
<text text-anchor="middle" x="58618" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer11_moe_agg -->
<g id="node243" class="node">
<title>layer11_moe_agg</title>
<polygon fill="lightyellow" stroke="black" points="59102.69,-1203.33 58840.71,-1203.33 58773.31,-1097.33 59035.29,-1097.33 59102.69,-1203.33"/>
<text text-anchor="middle" x="58938" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer11 MoE</text>
<text text-anchor="middle" x="58938" y="-1146.63" font-family="Times,serif" font-size="14.00">Output Aggregation</text>
<text text-anchor="middle" x="58938" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 8,9,10,11</text>
</g>
<!-- layer12_attn_qkv_gpu12 -->
<g id="node244" class="node">
<title>layer12_attn_qkv_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="59337,-1191.83 59121,-1191.83 59121,-1108.83 59337,-1108.83 59337,-1191.83"/>
<text text-anchor="middle" x="59229" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer12 Attention QKV Proj</text>
<text text-anchor="middle" x="59229" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="59229" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="59229" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="59229" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer12_attn_score_gpu12 -->
<g id="node245" class="node">
<title>layer12_attn_score_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="59567,-1184.33 59355,-1184.33 59355,-1116.33 59567,-1116.33 59567,-1184.33"/>
<text text-anchor="middle" x="59461" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer12 Attention Scores</text>
<text text-anchor="middle" x="59461" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="59461" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="59461" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer12_attn_out_gpu12 -->
<g id="node246" class="node">
<title>layer12_attn_out_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="59786.5,-1191.83 59585.5,-1191.83 59585.5,-1108.83 59786.5,-1108.83 59786.5,-1191.83"/>
<text text-anchor="middle" x="59686" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer12 Attention Output</text>
<text text-anchor="middle" x="59686" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="59686" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="59686" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="59686" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer12_moe_route_gpu12 -->
<g id="node247" class="node">
<title>layer12_moe_route_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="60181.88,-1218.33 59881.42,-1218.33 59804.12,-1082.33 60104.58,-1082.33 60181.88,-1218.33"/>
<text text-anchor="middle" x="59993" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer12 MoE Routing</text>
<text text-anchor="middle" x="59993" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="59993" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="59993" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer12_attn_qkv_gpu13 -->
<g id="node248" class="node">
<title>layer12_attn_qkv_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="60416,-1191.83 60200,-1191.83 60200,-1108.83 60416,-1108.83 60416,-1191.83"/>
<text text-anchor="middle" x="60308" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer12 Attention QKV Proj</text>
<text text-anchor="middle" x="60308" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="60308" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="60308" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="60308" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer12_attn_score_gpu13 -->
<g id="node249" class="node">
<title>layer12_attn_score_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="60646,-1184.33 60434,-1184.33 60434,-1116.33 60646,-1116.33 60646,-1184.33"/>
<text text-anchor="middle" x="60540" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer12 Attention Scores</text>
<text text-anchor="middle" x="60540" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="60540" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="60540" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer12_attn_out_gpu13 -->
<g id="node250" class="node">
<title>layer12_attn_out_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="60865.5,-1191.83 60664.5,-1191.83 60664.5,-1108.83 60865.5,-1108.83 60865.5,-1191.83"/>
<text text-anchor="middle" x="60765" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer12 Attention Output</text>
<text text-anchor="middle" x="60765" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="60765" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="60765" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="60765" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer12_moe_route_gpu13 -->
<g id="node251" class="node">
<title>layer12_moe_route_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="61260.88,-1218.33 60960.42,-1218.33 60883.12,-1082.33 61183.58,-1082.33 61260.88,-1218.33"/>
<text text-anchor="middle" x="61072" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer12 MoE Routing</text>
<text text-anchor="middle" x="61072" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="61072" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="61072" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer12_attn_qkv_gpu14 -->
<g id="node252" class="node">
<title>layer12_attn_qkv_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="61495,-1191.83 61279,-1191.83 61279,-1108.83 61495,-1108.83 61495,-1191.83"/>
<text text-anchor="middle" x="61387" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer12 Attention QKV Proj</text>
<text text-anchor="middle" x="61387" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="61387" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="61387" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="61387" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer12_attn_score_gpu14 -->
<g id="node253" class="node">
<title>layer12_attn_score_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="61725,-1184.33 61513,-1184.33 61513,-1116.33 61725,-1116.33 61725,-1184.33"/>
<text text-anchor="middle" x="61619" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer12 Attention Scores</text>
<text text-anchor="middle" x="61619" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="61619" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="61619" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer12_attn_out_gpu14 -->
<g id="node254" class="node">
<title>layer12_attn_out_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="61944.5,-1191.83 61743.5,-1191.83 61743.5,-1108.83 61944.5,-1108.83 61944.5,-1191.83"/>
<text text-anchor="middle" x="61844" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer12 Attention Output</text>
<text text-anchor="middle" x="61844" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="61844" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="61844" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="61844" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer12_moe_route_gpu14 -->
<g id="node255" class="node">
<title>layer12_moe_route_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="62339.88,-1218.33 62039.42,-1218.33 61962.12,-1082.33 62262.58,-1082.33 62339.88,-1218.33"/>
<text text-anchor="middle" x="62151" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer12 MoE Routing</text>
<text text-anchor="middle" x="62151" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="62151" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="62151" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer12_attn_qkv_gpu15 -->
<g id="node256" class="node">
<title>layer12_attn_qkv_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="62574,-1191.83 62358,-1191.83 62358,-1108.83 62574,-1108.83 62574,-1191.83"/>
<text text-anchor="middle" x="62466" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer12 Attention QKV Proj</text>
<text text-anchor="middle" x="62466" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="62466" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="62466" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="62466" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer12_attn_score_gpu15 -->
<g id="node257" class="node">
<title>layer12_attn_score_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="62804,-1184.33 62592,-1184.33 62592,-1116.33 62804,-1116.33 62804,-1184.33"/>
<text text-anchor="middle" x="62698" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer12 Attention Scores</text>
<text text-anchor="middle" x="62698" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="62698" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="62698" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer12_attn_out_gpu15 -->
<g id="node258" class="node">
<title>layer12_attn_out_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="63023.5,-1191.83 62822.5,-1191.83 62822.5,-1108.83 63023.5,-1108.83 63023.5,-1191.83"/>
<text text-anchor="middle" x="62923" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer12 Attention Output</text>
<text text-anchor="middle" x="62923" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="62923" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="62923" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="62923" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer12_moe_route_gpu15 -->
<g id="node259" class="node">
<title>layer12_moe_route_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="63418.88,-1218.33 63118.42,-1218.33 63041.12,-1082.33 63341.58,-1082.33 63418.88,-1218.33"/>
<text text-anchor="middle" x="63230" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer12 MoE Routing</text>
<text text-anchor="middle" x="63230" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="63230" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="63230" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer12_attn_allreduce -->
<g id="node260" class="node">
<title>layer12_attn_allreduce</title>
<ellipse fill="lightgray" stroke="black" cx="63540" cy="-1150.33" rx="103.48" ry="37.45"/>
<text text-anchor="middle" x="63540" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer12 Attention</text>
<text text-anchor="middle" x="63540" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="63540" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 12,13,14,15</text>
</g>
<!-- layer12_moe_all2all -->
<g id="node261" class="node">
<title>layer12_moe_all2all</title>
<ellipse fill="lightgray" stroke="black" cx="63798" cy="-1150.33" rx="137.36" ry="37.45"/>
<text text-anchor="middle" x="63798" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer12 MoE</text>
<text text-anchor="middle" x="63798" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All Communication</text>
<text text-anchor="middle" x="63798" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer12_moe_agg -->
<g id="node262" class="node">
<title>layer12_moe_agg</title>
<polygon fill="lightcoral" stroke="black" points="64282.69,-1203.33 64020.71,-1203.33 63953.31,-1097.33 64215.29,-1097.33 64282.69,-1203.33"/>
<text text-anchor="middle" x="64118" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer12 MoE</text>
<text text-anchor="middle" x="64118" y="-1146.63" font-family="Times,serif" font-size="14.00">Output Aggregation</text>
<text text-anchor="middle" x="64118" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 12,13,14,15</text>
</g>
<!-- layer13_attn_qkv_gpu12 -->
<g id="node263" class="node">
<title>layer13_attn_qkv_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="64517,-1191.83 64301,-1191.83 64301,-1108.83 64517,-1108.83 64517,-1191.83"/>
<text text-anchor="middle" x="64409" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer13 Attention QKV Proj</text>
<text text-anchor="middle" x="64409" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="64409" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="64409" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="64409" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer13_attn_score_gpu12 -->
<g id="node264" class="node">
<title>layer13_attn_score_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="64747,-1184.33 64535,-1184.33 64535,-1116.33 64747,-1116.33 64747,-1184.33"/>
<text text-anchor="middle" x="64641" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer13 Attention Scores</text>
<text text-anchor="middle" x="64641" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="64641" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="64641" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer13_attn_out_gpu12 -->
<g id="node265" class="node">
<title>layer13_attn_out_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="64966.5,-1191.83 64765.5,-1191.83 64765.5,-1108.83 64966.5,-1108.83 64966.5,-1191.83"/>
<text text-anchor="middle" x="64866" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer13 Attention Output</text>
<text text-anchor="middle" x="64866" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="64866" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="64866" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="64866" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer13_moe_route_gpu12 -->
<g id="node266" class="node">
<title>layer13_moe_route_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="65361.88,-1218.33 65061.42,-1218.33 64984.12,-1082.33 65284.58,-1082.33 65361.88,-1218.33"/>
<text text-anchor="middle" x="65173" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer13 MoE Routing</text>
<text text-anchor="middle" x="65173" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="65173" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="65173" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer13_attn_qkv_gpu13 -->
<g id="node267" class="node">
<title>layer13_attn_qkv_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="65596,-1191.83 65380,-1191.83 65380,-1108.83 65596,-1108.83 65596,-1191.83"/>
<text text-anchor="middle" x="65488" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer13 Attention QKV Proj</text>
<text text-anchor="middle" x="65488" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="65488" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="65488" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="65488" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer13_attn_score_gpu13 -->
<g id="node268" class="node">
<title>layer13_attn_score_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="65826,-1184.33 65614,-1184.33 65614,-1116.33 65826,-1116.33 65826,-1184.33"/>
<text text-anchor="middle" x="65720" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer13 Attention Scores</text>
<text text-anchor="middle" x="65720" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="65720" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="65720" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer13_attn_out_gpu13 -->
<g id="node269" class="node">
<title>layer13_attn_out_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="66045.5,-1191.83 65844.5,-1191.83 65844.5,-1108.83 66045.5,-1108.83 66045.5,-1191.83"/>
<text text-anchor="middle" x="65945" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer13 Attention Output</text>
<text text-anchor="middle" x="65945" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="65945" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="65945" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="65945" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer13_moe_route_gpu13 -->
<g id="node270" class="node">
<title>layer13_moe_route_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="66440.88,-1218.33 66140.42,-1218.33 66063.12,-1082.33 66363.58,-1082.33 66440.88,-1218.33"/>
<text text-anchor="middle" x="66252" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer13 MoE Routing</text>
<text text-anchor="middle" x="66252" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="66252" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="66252" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer13_attn_qkv_gpu14 -->
<g id="node271" class="node">
<title>layer13_attn_qkv_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="66675,-1191.83 66459,-1191.83 66459,-1108.83 66675,-1108.83 66675,-1191.83"/>
<text text-anchor="middle" x="66567" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer13 Attention QKV Proj</text>
<text text-anchor="middle" x="66567" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="66567" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="66567" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="66567" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer13_attn_score_gpu14 -->
<g id="node272" class="node">
<title>layer13_attn_score_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="66905,-1184.33 66693,-1184.33 66693,-1116.33 66905,-1116.33 66905,-1184.33"/>
<text text-anchor="middle" x="66799" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer13 Attention Scores</text>
<text text-anchor="middle" x="66799" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="66799" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="66799" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer13_attn_out_gpu14 -->
<g id="node273" class="node">
<title>layer13_attn_out_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="67124.5,-1191.83 66923.5,-1191.83 66923.5,-1108.83 67124.5,-1108.83 67124.5,-1191.83"/>
<text text-anchor="middle" x="67024" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer13 Attention Output</text>
<text text-anchor="middle" x="67024" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="67024" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="67024" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="67024" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer13_moe_route_gpu14 -->
<g id="node274" class="node">
<title>layer13_moe_route_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="67519.88,-1218.33 67219.42,-1218.33 67142.12,-1082.33 67442.58,-1082.33 67519.88,-1218.33"/>
<text text-anchor="middle" x="67331" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer13 MoE Routing</text>
<text text-anchor="middle" x="67331" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="67331" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="67331" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer13_attn_qkv_gpu15 -->
<g id="node275" class="node">
<title>layer13_attn_qkv_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="67754,-1191.83 67538,-1191.83 67538,-1108.83 67754,-1108.83 67754,-1191.83"/>
<text text-anchor="middle" x="67646" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer13 Attention QKV Proj</text>
<text text-anchor="middle" x="67646" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="67646" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="67646" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="67646" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer13_attn_score_gpu15 -->
<g id="node276" class="node">
<title>layer13_attn_score_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="67984,-1184.33 67772,-1184.33 67772,-1116.33 67984,-1116.33 67984,-1184.33"/>
<text text-anchor="middle" x="67878" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer13 Attention Scores</text>
<text text-anchor="middle" x="67878" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="67878" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="67878" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer13_attn_out_gpu15 -->
<g id="node277" class="node">
<title>layer13_attn_out_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="68203.5,-1191.83 68002.5,-1191.83 68002.5,-1108.83 68203.5,-1108.83 68203.5,-1191.83"/>
<text text-anchor="middle" x="68103" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer13 Attention Output</text>
<text text-anchor="middle" x="68103" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="68103" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="68103" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="68103" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer13_moe_route_gpu15 -->
<g id="node278" class="node">
<title>layer13_moe_route_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="68598.88,-1218.33 68298.42,-1218.33 68221.12,-1082.33 68521.58,-1082.33 68598.88,-1218.33"/>
<text text-anchor="middle" x="68410" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer13 MoE Routing</text>
<text text-anchor="middle" x="68410" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="68410" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="68410" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer13_attn_allreduce -->
<g id="node279" class="node">
<title>layer13_attn_allreduce</title>
<ellipse fill="lightgray" stroke="black" cx="68720" cy="-1150.33" rx="103.48" ry="37.45"/>
<text text-anchor="middle" x="68720" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer13 Attention</text>
<text text-anchor="middle" x="68720" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="68720" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 12,13,14,15</text>
</g>
<!-- layer13_moe_all2all -->
<g id="node280" class="node">
<title>layer13_moe_all2all</title>
<ellipse fill="lightgray" stroke="black" cx="68978" cy="-1150.33" rx="137.36" ry="37.45"/>
<text text-anchor="middle" x="68978" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer13 MoE</text>
<text text-anchor="middle" x="68978" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All Communication</text>
<text text-anchor="middle" x="68978" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer13_moe_agg -->
<g id="node281" class="node">
<title>layer13_moe_agg</title>
<polygon fill="lightcoral" stroke="black" points="69462.69,-1203.33 69200.71,-1203.33 69133.31,-1097.33 69395.29,-1097.33 69462.69,-1203.33"/>
<text text-anchor="middle" x="69298" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer13 MoE</text>
<text text-anchor="middle" x="69298" y="-1146.63" font-family="Times,serif" font-size="14.00">Output Aggregation</text>
<text text-anchor="middle" x="69298" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 12,13,14,15</text>
</g>
<!-- layer14_attn_qkv_gpu12 -->
<g id="node282" class="node">
<title>layer14_attn_qkv_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="69697,-1191.83 69481,-1191.83 69481,-1108.83 69697,-1108.83 69697,-1191.83"/>
<text text-anchor="middle" x="69589" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer14 Attention QKV Proj</text>
<text text-anchor="middle" x="69589" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="69589" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="69589" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="69589" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer14_attn_score_gpu12 -->
<g id="node283" class="node">
<title>layer14_attn_score_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="69927,-1184.33 69715,-1184.33 69715,-1116.33 69927,-1116.33 69927,-1184.33"/>
<text text-anchor="middle" x="69821" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer14 Attention Scores</text>
<text text-anchor="middle" x="69821" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="69821" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="69821" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer14_attn_out_gpu12 -->
<g id="node284" class="node">
<title>layer14_attn_out_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="70146.5,-1191.83 69945.5,-1191.83 69945.5,-1108.83 70146.5,-1108.83 70146.5,-1191.83"/>
<text text-anchor="middle" x="70046" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer14 Attention Output</text>
<text text-anchor="middle" x="70046" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="70046" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="70046" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="70046" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer14_moe_route_gpu12 -->
<g id="node285" class="node">
<title>layer14_moe_route_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="70541.88,-1218.33 70241.42,-1218.33 70164.12,-1082.33 70464.58,-1082.33 70541.88,-1218.33"/>
<text text-anchor="middle" x="70353" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer14 MoE Routing</text>
<text text-anchor="middle" x="70353" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="70353" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="70353" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer14_attn_qkv_gpu13 -->
<g id="node286" class="node">
<title>layer14_attn_qkv_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="70776,-1191.83 70560,-1191.83 70560,-1108.83 70776,-1108.83 70776,-1191.83"/>
<text text-anchor="middle" x="70668" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer14 Attention QKV Proj</text>
<text text-anchor="middle" x="70668" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="70668" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="70668" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="70668" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer14_attn_score_gpu13 -->
<g id="node287" class="node">
<title>layer14_attn_score_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="71006,-1184.33 70794,-1184.33 70794,-1116.33 71006,-1116.33 71006,-1184.33"/>
<text text-anchor="middle" x="70900" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer14 Attention Scores</text>
<text text-anchor="middle" x="70900" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="70900" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="70900" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer14_attn_out_gpu13 -->
<g id="node288" class="node">
<title>layer14_attn_out_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="71225.5,-1191.83 71024.5,-1191.83 71024.5,-1108.83 71225.5,-1108.83 71225.5,-1191.83"/>
<text text-anchor="middle" x="71125" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer14 Attention Output</text>
<text text-anchor="middle" x="71125" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="71125" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="71125" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="71125" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer14_moe_route_gpu13 -->
<g id="node289" class="node">
<title>layer14_moe_route_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="71620.88,-1218.33 71320.42,-1218.33 71243.12,-1082.33 71543.58,-1082.33 71620.88,-1218.33"/>
<text text-anchor="middle" x="71432" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer14 MoE Routing</text>
<text text-anchor="middle" x="71432" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="71432" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="71432" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer14_attn_qkv_gpu14 -->
<g id="node290" class="node">
<title>layer14_attn_qkv_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="71855,-1191.83 71639,-1191.83 71639,-1108.83 71855,-1108.83 71855,-1191.83"/>
<text text-anchor="middle" x="71747" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer14 Attention QKV Proj</text>
<text text-anchor="middle" x="71747" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="71747" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="71747" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="71747" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer14_attn_score_gpu14 -->
<g id="node291" class="node">
<title>layer14_attn_score_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="72085,-1184.33 71873,-1184.33 71873,-1116.33 72085,-1116.33 72085,-1184.33"/>
<text text-anchor="middle" x="71979" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer14 Attention Scores</text>
<text text-anchor="middle" x="71979" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="71979" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="71979" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer14_attn_out_gpu14 -->
<g id="node292" class="node">
<title>layer14_attn_out_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="72304.5,-1191.83 72103.5,-1191.83 72103.5,-1108.83 72304.5,-1108.83 72304.5,-1191.83"/>
<text text-anchor="middle" x="72204" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer14 Attention Output</text>
<text text-anchor="middle" x="72204" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="72204" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="72204" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="72204" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer14_moe_route_gpu14 -->
<g id="node293" class="node">
<title>layer14_moe_route_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="72699.88,-1218.33 72399.42,-1218.33 72322.12,-1082.33 72622.58,-1082.33 72699.88,-1218.33"/>
<text text-anchor="middle" x="72511" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer14 MoE Routing</text>
<text text-anchor="middle" x="72511" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="72511" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="72511" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer14_attn_qkv_gpu15 -->
<g id="node294" class="node">
<title>layer14_attn_qkv_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="72934,-1191.83 72718,-1191.83 72718,-1108.83 72934,-1108.83 72934,-1191.83"/>
<text text-anchor="middle" x="72826" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer14 Attention QKV Proj</text>
<text text-anchor="middle" x="72826" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="72826" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="72826" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="72826" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer14_attn_score_gpu15 -->
<g id="node295" class="node">
<title>layer14_attn_score_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="73164,-1184.33 72952,-1184.33 72952,-1116.33 73164,-1116.33 73164,-1184.33"/>
<text text-anchor="middle" x="73058" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer14 Attention Scores</text>
<text text-anchor="middle" x="73058" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="73058" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="73058" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer14_attn_out_gpu15 -->
<g id="node296" class="node">
<title>layer14_attn_out_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="73383.5,-1191.83 73182.5,-1191.83 73182.5,-1108.83 73383.5,-1108.83 73383.5,-1191.83"/>
<text text-anchor="middle" x="73283" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer14 Attention Output</text>
<text text-anchor="middle" x="73283" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="73283" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="73283" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="73283" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer14_moe_route_gpu15 -->
<g id="node297" class="node">
<title>layer14_moe_route_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="73778.88,-1218.33 73478.42,-1218.33 73401.12,-1082.33 73701.58,-1082.33 73778.88,-1218.33"/>
<text text-anchor="middle" x="73590" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer14 MoE Routing</text>
<text text-anchor="middle" x="73590" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="73590" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="73590" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer14_attn_allreduce -->
<g id="node298" class="node">
<title>layer14_attn_allreduce</title>
<ellipse fill="lightgray" stroke="black" cx="73900" cy="-1150.33" rx="103.48" ry="37.45"/>
<text text-anchor="middle" x="73900" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer14 Attention</text>
<text text-anchor="middle" x="73900" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="73900" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 12,13,14,15</text>
</g>
<!-- layer14_moe_all2all -->
<g id="node299" class="node">
<title>layer14_moe_all2all</title>
<ellipse fill="lightgray" stroke="black" cx="74158" cy="-1150.33" rx="137.36" ry="37.45"/>
<text text-anchor="middle" x="74158" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer14 MoE</text>
<text text-anchor="middle" x="74158" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All Communication</text>
<text text-anchor="middle" x="74158" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer14_moe_agg -->
<g id="node300" class="node">
<title>layer14_moe_agg</title>
<polygon fill="lightcoral" stroke="black" points="74642.69,-1203.33 74380.71,-1203.33 74313.31,-1097.33 74575.29,-1097.33 74642.69,-1203.33"/>
<text text-anchor="middle" x="74478" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer14 MoE</text>
<text text-anchor="middle" x="74478" y="-1146.63" font-family="Times,serif" font-size="14.00">Output Aggregation</text>
<text text-anchor="middle" x="74478" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 12,13,14,15</text>
</g>
<!-- layer15_attn_qkv_gpu12 -->
<g id="node301" class="node">
<title>layer15_attn_qkv_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="74877,-1191.83 74661,-1191.83 74661,-1108.83 74877,-1108.83 74877,-1191.83"/>
<text text-anchor="middle" x="74769" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer15 Attention QKV Proj</text>
<text text-anchor="middle" x="74769" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="74769" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="74769" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="74769" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer15_attn_score_gpu12 -->
<g id="node302" class="node">
<title>layer15_attn_score_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="75107,-1184.33 74895,-1184.33 74895,-1116.33 75107,-1116.33 75107,-1184.33"/>
<text text-anchor="middle" x="75001" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer15 Attention Scores</text>
<text text-anchor="middle" x="75001" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="75001" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="75001" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer15_attn_out_gpu12 -->
<g id="node303" class="node">
<title>layer15_attn_out_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="75326.5,-1191.83 75125.5,-1191.83 75125.5,-1108.83 75326.5,-1108.83 75326.5,-1191.83"/>
<text text-anchor="middle" x="75226" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer15 Attention Output</text>
<text text-anchor="middle" x="75226" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="75226" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="75226" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="75226" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer15_moe_route_gpu12 -->
<g id="node304" class="node">
<title>layer15_moe_route_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="75721.88,-1218.33 75421.42,-1218.33 75344.12,-1082.33 75644.58,-1082.33 75721.88,-1218.33"/>
<text text-anchor="middle" x="75533" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer15 MoE Routing</text>
<text text-anchor="middle" x="75533" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="75533" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="75533" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer15_attn_qkv_gpu13 -->
<g id="node305" class="node">
<title>layer15_attn_qkv_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="75956,-1191.83 75740,-1191.83 75740,-1108.83 75956,-1108.83 75956,-1191.83"/>
<text text-anchor="middle" x="75848" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer15 Attention QKV Proj</text>
<text text-anchor="middle" x="75848" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="75848" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="75848" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="75848" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer15_attn_score_gpu13 -->
<g id="node306" class="node">
<title>layer15_attn_score_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="76186,-1184.33 75974,-1184.33 75974,-1116.33 76186,-1116.33 76186,-1184.33"/>
<text text-anchor="middle" x="76080" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer15 Attention Scores</text>
<text text-anchor="middle" x="76080" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="76080" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="76080" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer15_attn_out_gpu13 -->
<g id="node307" class="node">
<title>layer15_attn_out_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="76405.5,-1191.83 76204.5,-1191.83 76204.5,-1108.83 76405.5,-1108.83 76405.5,-1191.83"/>
<text text-anchor="middle" x="76305" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer15 Attention Output</text>
<text text-anchor="middle" x="76305" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="76305" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="76305" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="76305" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer15_moe_route_gpu13 -->
<g id="node308" class="node">
<title>layer15_moe_route_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="76800.88,-1218.33 76500.42,-1218.33 76423.12,-1082.33 76723.58,-1082.33 76800.88,-1218.33"/>
<text text-anchor="middle" x="76612" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer15 MoE Routing</text>
<text text-anchor="middle" x="76612" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="76612" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="76612" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer15_attn_qkv_gpu14 -->
<g id="node309" class="node">
<title>layer15_attn_qkv_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="77035,-1191.83 76819,-1191.83 76819,-1108.83 77035,-1108.83 77035,-1191.83"/>
<text text-anchor="middle" x="76927" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer15 Attention QKV Proj</text>
<text text-anchor="middle" x="76927" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="76927" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="76927" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="76927" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer15_attn_score_gpu14 -->
<g id="node310" class="node">
<title>layer15_attn_score_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="77265,-1184.33 77053,-1184.33 77053,-1116.33 77265,-1116.33 77265,-1184.33"/>
<text text-anchor="middle" x="77159" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer15 Attention Scores</text>
<text text-anchor="middle" x="77159" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="77159" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="77159" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer15_attn_out_gpu14 -->
<g id="node311" class="node">
<title>layer15_attn_out_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="77484.5,-1191.83 77283.5,-1191.83 77283.5,-1108.83 77484.5,-1108.83 77484.5,-1191.83"/>
<text text-anchor="middle" x="77384" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer15 Attention Output</text>
<text text-anchor="middle" x="77384" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="77384" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="77384" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="77384" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer15_moe_route_gpu14 -->
<g id="node312" class="node">
<title>layer15_moe_route_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="77879.88,-1218.33 77579.42,-1218.33 77502.12,-1082.33 77802.58,-1082.33 77879.88,-1218.33"/>
<text text-anchor="middle" x="77691" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer15 MoE Routing</text>
<text text-anchor="middle" x="77691" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="77691" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="77691" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer15_attn_qkv_gpu15 -->
<g id="node313" class="node">
<title>layer15_attn_qkv_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="78114,-1191.83 77898,-1191.83 77898,-1108.83 78114,-1108.83 78114,-1191.83"/>
<text text-anchor="middle" x="78006" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer15 Attention QKV Proj</text>
<text text-anchor="middle" x="78006" y="-1161.63" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
<text text-anchor="middle" x="78006" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="78006" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="78006" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer15_attn_score_gpu15 -->
<g id="node314" class="node">
<title>layer15_attn_score_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="78344,-1184.33 78132,-1184.33 78132,-1116.33 78344,-1116.33 78344,-1184.33"/>
<text text-anchor="middle" x="78238" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer15 Attention Scores</text>
<text text-anchor="middle" x="78238" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 16, 1024, 64]</text>
<text text-anchor="middle" x="78238" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 4, 1024, 1024]</text>
<text text-anchor="middle" x="78238" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer15_attn_out_gpu15 -->
<g id="node315" class="node">
<title>layer15_attn_out_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="78563.5,-1191.83 78362.5,-1191.83 78362.5,-1108.83 78563.5,-1108.83 78563.5,-1191.83"/>
<text text-anchor="middle" x="78463" y="-1176.63" font-family="Times,serif" font-size="14.00">Layer15 Attention Output</text>
<text text-anchor="middle" x="78463" y="-1161.63" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
<text text-anchor="middle" x="78463" y="-1146.63" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 256]</text>
<text text-anchor="middle" x="78463" y="-1131.63" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 256]</text>
<text text-anchor="middle" x="78463" y="-1116.63" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer15_moe_route_gpu15 -->
<g id="node316" class="node">
<title>layer15_moe_route_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="78958.88,-1218.33 78658.42,-1218.33 78581.12,-1082.33 78881.58,-1082.33 78958.88,-1218.33"/>
<text text-anchor="middle" x="78770" y="-1169.13" font-family="Times,serif" font-size="14.00">Layer15 MoE Routing</text>
<text text-anchor="middle" x="78770" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [64, 1024, 1024]</text>
<text text-anchor="middle" x="78770" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [64, 1024, 1]</text>
<text text-anchor="middle" x="78770" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer15_attn_allreduce -->
<g id="node317" class="node">
<title>layer15_attn_allreduce</title>
<ellipse fill="lightgray" stroke="black" cx="79080" cy="-1150.33" rx="103.48" ry="37.45"/>
<text text-anchor="middle" x="79080" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer15 Attention</text>
<text text-anchor="middle" x="79080" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="79080" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 12,13,14,15</text>
</g>
<!-- layer15_moe_all2all -->
<g id="node318" class="node">
<title>layer15_moe_all2all</title>
<ellipse fill="lightgray" stroke="black" cx="79338" cy="-1150.33" rx="137.36" ry="37.45"/>
<text text-anchor="middle" x="79338" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer15 MoE</text>
<text text-anchor="middle" x="79338" y="-1146.63" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All Communication</text>
<text text-anchor="middle" x="79338" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer15_moe_agg -->
<g id="node319" class="node">
<title>layer15_moe_agg</title>
<polygon fill="lightcoral" stroke="black" points="79822.69,-1203.33 79560.71,-1203.33 79493.31,-1097.33 79755.29,-1097.33 79822.69,-1203.33"/>
<text text-anchor="middle" x="79658" y="-1161.63" font-family="Times,serif" font-size="14.00">Layer15 MoE</text>
<text text-anchor="middle" x="79658" y="-1146.63" font-family="Times,serif" font-size="14.00">Output Aggregation</text>
<text text-anchor="middle" x="79658" y="-1131.63" font-family="Times,serif" font-size="14.00">GPU: 12,13,14,15</text>
</g>
<!-- output_agg -->
<g id="node320" class="node">
<title>output_agg</title>
<polygon fill="lightpink" stroke="black" points="79868.42,-1046.33 79533.69,-1046.33 79447.58,-880.33 79782.31,-880.33 79868.42,-1046.33"/>
<text text-anchor="middle" x="79658" y="-989.63" font-family="Times,serif" font-size="14.00">Output Aggregation</text>
<text text-anchor="middle" x="79658" y="-974.63" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="79658" y="-959.63" font-family="Times,serif" font-size="14.00">Input: [128, 1024, 1024]</text>
<text text-anchor="middle" x="79658" y="-944.63" font-family="Times,serif" font-size="14.00">Output: [128, 1024, 1024]</text>
<text text-anchor="middle" x="79658" y="-929.63" font-family="Times,serif" font-size="14.00">GPU: 12,13,14,15</text>
</g>
<!-- layer15_moe_agg&#45;&gt;output_agg -->
<g id="edge46" class="edge">
<title>layer15_moe_agg&#45;&gt;output_agg</title>
<path fill="none" stroke="black" d="M79658,-1097.25C79658,-1097.25 79658,-1056.62 79658,-1056.62"/>
<polygon fill="black" stroke="black" points="79661.5,-1056.62 79658,-1046.62 79654.5,-1056.62 79661.5,-1056.62"/>
</g>
<!-- output -->
<g id="node321" class="node">
<title>output</title>
<ellipse fill="white" stroke="black" cx="79658" cy="-802.83" rx="251.96" ry="37.45"/>
<text text-anchor="middle" x="79658" y="-814.13" font-family="Times,serif" font-size="14.00">Final Output</text>
<text text-anchor="middle" x="79658" y="-799.13" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="79658" y="-784.13" font-family="Times,serif" font-size="14.00">GPU: ALL</text>
</g>
<!-- output_agg&#45;&gt;output -->
<g id="edge47" class="edge">
<title>output_agg&#45;&gt;output</title>
<path fill="none" stroke="black" d="M79658,-880.26C79658,-880.26 79658,-850.52 79658,-850.52"/>
<polygon fill="black" stroke="black" points="79661.5,-850.52 79658,-840.52 79654.5,-850.52 79661.5,-850.52"/>
</g>
<!-- layer0_moe_route_gpu0&#45;&gt;layer0_moe_all2all -->
<g id="edge22" class="edge">
<title>layer0_moe_route_gpu0&#45;&gt;layer0_moe_all2all</title>
<path fill="none" stroke="black" d="M2007,-312.67C2007,-294.71 2007,-270 2007,-270 2007,-270 2141.4,-270 2141.4,-270"/>
<polygon fill="black" stroke="black" points="2141.4,-273.5 2151.4,-270 2141.4,-266.5 2141.4,-273.5"/>
</g>
<!-- layer0_moe_route_gpu1&#45;&gt;layer0_moe_all2all -->
<g id="edge23" class="edge">
<title>layer0_moe_route_gpu1&#45;&gt;layer0_moe_all2all</title>
<path fill="none" stroke="black" d="M2157.91,-312.88C2157.91,-312.88 2157.91,-281.22 2157.91,-281.22"/>
<polygon fill="black" stroke="black" points="2161.41,-281.22 2157.91,-271.22 2154.41,-281.22 2161.41,-281.22"/>
</g>
<!-- layer0_moe_route_gpu2&#45;&gt;layer0_moe_all2all -->
<g id="edge24" class="edge">
<title>layer0_moe_route_gpu2&#45;&gt;layer0_moe_all2all</title>
<path fill="none" stroke="black" d="M2304.09,-312.88C2304.09,-312.88 2304.09,-281.22 2304.09,-281.22"/>
<polygon fill="black" stroke="black" points="2307.59,-281.22 2304.09,-271.22 2300.59,-281.22 2307.59,-281.22"/>
</g>
<!-- layer0_moe_route_gpu3&#45;&gt;layer0_moe_all2all -->
<g id="edge25" class="edge">
<title>layer0_moe_route_gpu3&#45;&gt;layer0_moe_all2all</title>
<path fill="none" stroke="black" d="M2455,-312.86C2455,-293.64 2455,-266 2455,-266 2455,-266 2337.95,-266 2337.95,-266"/>
<polygon fill="black" stroke="black" points="2337.95,-262.5 2327.95,-266 2337.95,-269.5 2337.95,-262.5"/>
</g>
</g>
</svg>
