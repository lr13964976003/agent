<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_tp8_pp2 Pages: 1 -->
<svg width="12305pt" height="2614pt"
 viewBox="0.00 0.00 12304.52 2613.72" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2609.72)">
<title>baseline_tp8_pp2</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2609.72 12300.52,-2609.72 12300.52,4 -4,4"/>
<!-- INPUT -->
<g id="node1" class="node">
<title>INPUT</title>
<polygon fill="none" stroke="black" points="8713,-2075.29 8369,-2075.29 8369,-2007.29 8713,-2007.29 8713,-2075.29"/>
<text text-anchor="middle" x="8541" y="-2060.09" font-family="Times,serif" font-size="14.00">INPUT</text>
<text text-anchor="middle" x="8541" y="-2045.09" font-family="Times,serif" font-size="14.00">GPU: all</text>
<text text-anchor="middle" x="8541" y="-2030.09" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="8541" y="-2015.09" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_resid1 -->
<g id="node22" class="node">
<title>stage0_layer0_resid1</title>
<polygon fill="none" stroke="black" points="8961,-1967.81 8597,-1967.81 8597,-1899.81 8961,-1899.81 8961,-1967.81"/>
<text text-anchor="middle" x="8779" y="-1952.61" font-family="Times,serif" font-size="14.00">stage0_layer0_resid1</text>
<text text-anchor="middle" x="8779" y="-1937.61" font-family="Times,serif" font-size="14.00">GPU: all_stage0</text>
<text text-anchor="middle" x="8779" y="-1922.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024 (x2)</text>
<text text-anchor="middle" x="8779" y="-1907.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- INPUT&#45;&gt;stage0_layer0_resid1 -->
<g id="edge27" class="edge">
<title>INPUT&#45;&gt;stage0_layer0_resid1</title>
<path fill="none" stroke="black" d="M8615.65,-2007.21C8640.78,-1996.07 8669,-1983.56 8694.81,-1972.12"/>
<polygon fill="black" stroke="black" points="8696.48,-1975.21 8704.2,-1967.96 8693.64,-1968.81 8696.48,-1975.21"/>
</g>
<!-- stage0_layer0_mha_qkv_tp0 -->
<g id="node2" class="node">
<title>stage0_layer0_mha_qkv_tp0</title>
<polygon fill="none" stroke="black" points="7841.5,-2605.72 7470.5,-2605.72 7470.5,-2537.72 7841.5,-2537.72 7841.5,-2605.72"/>
<text text-anchor="middle" x="7656" y="-2590.52" font-family="Times,serif" font-size="14.00">stage0_layer0_mha_qkv_tp0</text>
<text text-anchor="middle" x="7656" y="-2575.52" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="7656" y="-2560.52" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="7656" y="-2545.52" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- stage0_layer0_ag_qkv -->
<g id="node10" class="node">
<title>stage0_layer0_ag_qkv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="9017" cy="-2464.24" rx="293.4" ry="37.45"/>
<text text-anchor="middle" x="9017" y="-2475.54" font-family="Times,serif" font-size="14.00">stage0_layer0_ag_qkv</text>
<text text-anchor="middle" x="9017" y="-2460.54" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, heads=16, d_k=64 (shard)</text>
<text text-anchor="middle" x="9017" y="-2445.54" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64 (full)</text>
</g>
<!-- stage0_layer0_mha_qkv_tp0&#45;&gt;stage0_layer0_ag_qkv -->
<g id="edge1" class="edge">
<title>stage0_layer0_mha_qkv_tp0&#45;&gt;stage0_layer0_ag_qkv</title>
<path fill="none" stroke="black" d="M7841.54,-2538.73C7844.38,-2538.38 7847.2,-2538.04 7850,-2537.72 8146.57,-2503.39 8487.56,-2484.58 8724.04,-2474.79"/>
<polygon fill="black" stroke="black" points="8724.32,-2478.28 8734.17,-2474.38 8724.03,-2471.29 8724.32,-2478.28"/>
</g>
<!-- stage0_layer0_mha_qkv_tp1 -->
<g id="node3" class="node">
<title>stage0_layer0_mha_qkv_tp1</title>
<polygon fill="none" stroke="black" points="8230.5,-2605.72 7859.5,-2605.72 7859.5,-2537.72 8230.5,-2537.72 8230.5,-2605.72"/>
<text text-anchor="middle" x="8045" y="-2590.52" font-family="Times,serif" font-size="14.00">stage0_layer0_mha_qkv_tp1</text>
<text text-anchor="middle" x="8045" y="-2575.52" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="8045" y="-2560.52" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="8045" y="-2545.52" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- stage0_layer0_mha_qkv_tp1&#45;&gt;stage0_layer0_ag_qkv -->
<g id="edge2" class="edge">
<title>stage0_layer0_mha_qkv_tp1&#45;&gt;stage0_layer0_ag_qkv</title>
<path fill="none" stroke="black" d="M8230.56,-2538.85C8233.39,-2538.47 8236.21,-2538.09 8239,-2537.72 8410.74,-2515.15 8604.72,-2497.06 8756.02,-2484.6"/>
<polygon fill="black" stroke="black" points="8756.7,-2488.06 8766.38,-2483.75 8756.13,-2481.08 8756.7,-2488.06"/>
</g>
<!-- stage0_layer0_mha_qkv_tp2 -->
<g id="node4" class="node">
<title>stage0_layer0_mha_qkv_tp2</title>
<polygon fill="none" stroke="black" points="8619.5,-2605.72 8248.5,-2605.72 8248.5,-2537.72 8619.5,-2537.72 8619.5,-2605.72"/>
<text text-anchor="middle" x="8434" y="-2590.52" font-family="Times,serif" font-size="14.00">stage0_layer0_mha_qkv_tp2</text>
<text text-anchor="middle" x="8434" y="-2575.52" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="8434" y="-2560.52" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="8434" y="-2545.52" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- stage0_layer0_mha_qkv_tp2&#45;&gt;stage0_layer0_ag_qkv -->
<g id="edge3" class="edge">
<title>stage0_layer0_mha_qkv_tp2&#45;&gt;stage0_layer0_ag_qkv</title>
<path fill="none" stroke="black" d="M8616.47,-2537.71C8688.24,-2524.72 8770.33,-2509.87 8841.42,-2497.01"/>
<polygon fill="black" stroke="black" points="8842.16,-2500.43 8851.38,-2495.21 8840.91,-2493.54 8842.16,-2500.43"/>
</g>
<!-- stage0_layer0_mha_qkv_tp3 -->
<g id="node5" class="node">
<title>stage0_layer0_mha_qkv_tp3</title>
<polygon fill="none" stroke="black" points="9008.5,-2605.72 8637.5,-2605.72 8637.5,-2537.72 9008.5,-2537.72 9008.5,-2605.72"/>
<text text-anchor="middle" x="8823" y="-2590.52" font-family="Times,serif" font-size="14.00">stage0_layer0_mha_qkv_tp3</text>
<text text-anchor="middle" x="8823" y="-2575.52" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="8823" y="-2560.52" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="8823" y="-2545.52" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- stage0_layer0_mha_qkv_tp3&#45;&gt;stage0_layer0_ag_qkv -->
<g id="edge4" class="edge">
<title>stage0_layer0_mha_qkv_tp3&#45;&gt;stage0_layer0_ag_qkv</title>
<path fill="none" stroke="black" d="M8883.85,-2537.64C8902.45,-2527.52 8923.12,-2516.29 8942.51,-2505.74"/>
<polygon fill="black" stroke="black" points="8944.21,-2508.8 8951.32,-2500.95 8940.86,-2502.65 8944.21,-2508.8"/>
</g>
<!-- stage0_layer0_mha_qkv_tp4 -->
<g id="node6" class="node">
<title>stage0_layer0_mha_qkv_tp4</title>
<polygon fill="none" stroke="black" points="9397.5,-2605.72 9026.5,-2605.72 9026.5,-2537.72 9397.5,-2537.72 9397.5,-2605.72"/>
<text text-anchor="middle" x="9212" y="-2590.52" font-family="Times,serif" font-size="14.00">stage0_layer0_mha_qkv_tp4</text>
<text text-anchor="middle" x="9212" y="-2575.52" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="9212" y="-2560.52" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="9212" y="-2545.52" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- stage0_layer0_mha_qkv_tp4&#45;&gt;stage0_layer0_ag_qkv -->
<g id="edge5" class="edge">
<title>stage0_layer0_mha_qkv_tp4&#45;&gt;stage0_layer0_ag_qkv</title>
<path fill="none" stroke="black" d="M9150.84,-2537.64C9132.14,-2527.52 9111.37,-2516.29 9091.87,-2505.74"/>
<polygon fill="black" stroke="black" points="9093.48,-2502.63 9083.02,-2500.95 9090.15,-2508.79 9093.48,-2502.63"/>
</g>
<!-- stage0_layer0_mha_qkv_tp5 -->
<g id="node7" class="node">
<title>stage0_layer0_mha_qkv_tp5</title>
<polygon fill="none" stroke="black" points="9786.5,-2605.72 9415.5,-2605.72 9415.5,-2537.72 9786.5,-2537.72 9786.5,-2605.72"/>
<text text-anchor="middle" x="9601" y="-2590.52" font-family="Times,serif" font-size="14.00">stage0_layer0_mha_qkv_tp5</text>
<text text-anchor="middle" x="9601" y="-2575.52" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="9601" y="-2560.52" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="9601" y="-2545.52" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- stage0_layer0_mha_qkv_tp5&#45;&gt;stage0_layer0_ag_qkv -->
<g id="edge6" class="edge">
<title>stage0_layer0_mha_qkv_tp5&#45;&gt;stage0_layer0_ag_qkv</title>
<path fill="none" stroke="black" d="M9418.22,-2537.71C9346.32,-2524.72 9264.1,-2509.87 9192.88,-2497.01"/>
<polygon fill="black" stroke="black" points="9193.37,-2493.54 9182.91,-2495.21 9192.13,-2500.43 9193.37,-2493.54"/>
</g>
<!-- stage0_layer0_mha_qkv_tp6 -->
<g id="node8" class="node">
<title>stage0_layer0_mha_qkv_tp6</title>
<polygon fill="none" stroke="black" points="10175.5,-2605.72 9804.5,-2605.72 9804.5,-2537.72 10175.5,-2537.72 10175.5,-2605.72"/>
<text text-anchor="middle" x="9990" y="-2590.52" font-family="Times,serif" font-size="14.00">stage0_layer0_mha_qkv_tp6</text>
<text text-anchor="middle" x="9990" y="-2575.52" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="9990" y="-2560.52" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="9990" y="-2545.52" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- stage0_layer0_mha_qkv_tp6&#45;&gt;stage0_layer0_ag_qkv -->
<g id="edge7" class="edge">
<title>stage0_layer0_mha_qkv_tp6&#45;&gt;stage0_layer0_ag_qkv</title>
<path fill="none" stroke="black" d="M9804.44,-2538.85C9801.61,-2538.46 9798.79,-2538.09 9796,-2537.72 9624.04,-2515.13 9429.81,-2497.04 9278.32,-2484.59"/>
<polygon fill="black" stroke="black" points="9278.19,-2481.07 9267.94,-2483.74 9277.62,-2488.04 9278.19,-2481.07"/>
</g>
<!-- stage0_layer0_mha_qkv_tp7 -->
<g id="node9" class="node">
<title>stage0_layer0_mha_qkv_tp7</title>
<polygon fill="none" stroke="black" points="10564.5,-2605.72 10193.5,-2605.72 10193.5,-2537.72 10564.5,-2537.72 10564.5,-2605.72"/>
<text text-anchor="middle" x="10379" y="-2590.52" font-family="Times,serif" font-size="14.00">stage0_layer0_mha_qkv_tp7</text>
<text text-anchor="middle" x="10379" y="-2575.52" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="10379" y="-2560.52" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="10379" y="-2545.52" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- stage0_layer0_mha_qkv_tp7&#45;&gt;stage0_layer0_ag_qkv -->
<g id="edge8" class="edge">
<title>stage0_layer0_mha_qkv_tp7&#45;&gt;stage0_layer0_ag_qkv</title>
<path fill="none" stroke="black" d="M10193.46,-2538.73C10190.62,-2538.38 10187.8,-2538.04 10185,-2537.72 9888.05,-2503.35 9546.61,-2484.55 9309.91,-2474.77"/>
<polygon fill="black" stroke="black" points="9309.91,-2471.27 9299.78,-2474.35 9309.63,-2478.26 9309.91,-2471.27"/>
</g>
<!-- stage0_layer0_mha_score -->
<g id="node11" class="node">
<title>stage0_layer0_mha_score</title>
<polygon fill="none" stroke="black" points="9222,-2390.77 8812,-2390.77 8812,-2322.77 9222,-2322.77 9222,-2390.77"/>
<text text-anchor="middle" x="9017" y="-2375.57" font-family="Times,serif" font-size="14.00">stage0_layer0_mha_score</text>
<text text-anchor="middle" x="9017" y="-2360.57" font-family="Times,serif" font-size="14.00">GPU: all_stage0</text>
<text text-anchor="middle" x="9017" y="-2345.57" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, heads=16, d_k=64</text>
<text text-anchor="middle" x="9017" y="-2330.57" font-family="Times,serif" font-size="14.00">Out: batch_size, heads=16, seq_len=128, seq_len=128</text>
</g>
<!-- stage0_layer0_ag_qkv&#45;&gt;stage0_layer0_mha_score -->
<g id="edge9" class="edge">
<title>stage0_layer0_ag_qkv&#45;&gt;stage0_layer0_mha_score</title>
<path fill="none" stroke="black" d="M9017,-2426.65C9017,-2418.36 9017,-2409.48 9017,-2400.94"/>
<polygon fill="black" stroke="black" points="9020.5,-2400.77 9017,-2390.77 9013.5,-2400.77 9020.5,-2400.77"/>
</g>
<!-- stage0_layer0_mha_softmax -->
<g id="node12" class="node">
<title>stage0_layer0_mha_softmax</title>
<polygon fill="none" stroke="black" points="9222,-2286.77 8812,-2286.77 8812,-2218.77 9222,-2218.77 9222,-2286.77"/>
<text text-anchor="middle" x="9017" y="-2271.57" font-family="Times,serif" font-size="14.00">stage0_layer0_mha_softmax</text>
<text text-anchor="middle" x="9017" y="-2256.57" font-family="Times,serif" font-size="14.00">GPU: all_stage0</text>
<text text-anchor="middle" x="9017" y="-2241.57" font-family="Times,serif" font-size="14.00">In: batch_size, heads=16, seq_len=128, seq_len=128</text>
<text text-anchor="middle" x="9017" y="-2226.57" font-family="Times,serif" font-size="14.00">Out: batch_size, heads=16, seq_len=128, seq_len=128</text>
</g>
<!-- stage0_layer0_mha_score&#45;&gt;stage0_layer0_mha_softmax -->
<g id="edge10" class="edge">
<title>stage0_layer0_mha_score&#45;&gt;stage0_layer0_mha_softmax</title>
<path fill="none" stroke="black" d="M9017,-2322.65C9017,-2314.54 9017,-2305.75 9017,-2297.24"/>
<polygon fill="black" stroke="black" points="9020.5,-2297.07 9017,-2287.07 9013.5,-2297.07 9020.5,-2297.07"/>
</g>
<!-- stage0_layer0_mha_out_tp0 -->
<g id="node13" class="node">
<title>stage0_layer0_mha_out_tp0</title>
<polygon fill="none" stroke="black" points="7760,-2182.77 7362,-2182.77 7362,-2114.77 7760,-2114.77 7760,-2182.77"/>
<text text-anchor="middle" x="7561" y="-2167.57" font-family="Times,serif" font-size="14.00">stage0_layer0_mha_out_tp0</text>
<text text-anchor="middle" x="7561" y="-2152.57" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="7561" y="-2137.57" font-family="Times,serif" font-size="14.00">In: batch_size, heads=16, seq_len=128, seq_len=128</text>
<text text-anchor="middle" x="7561" y="-2122.57" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//8</text>
</g>
<!-- stage0_layer0_mha_softmax&#45;&gt;stage0_layer0_mha_out_tp0 -->
<g id="edge11" class="edge">
<title>stage0_layer0_mha_softmax&#45;&gt;stage0_layer0_mha_out_tp0</title>
<path fill="none" stroke="black" d="M8811.93,-2246.85C8566.45,-2239.49 8142.88,-2222.15 7770.39,-2182.88"/>
<polygon fill="black" stroke="black" points="7770.53,-2179.37 7760.21,-2181.8 7769.79,-2186.33 7770.53,-2179.37"/>
</g>
<!-- stage0_layer0_mha_out_tp1 -->
<g id="node14" class="node">
<title>stage0_layer0_mha_out_tp1</title>
<polygon fill="none" stroke="black" points="8176,-2182.77 7778,-2182.77 7778,-2114.77 8176,-2114.77 8176,-2182.77"/>
<text text-anchor="middle" x="7977" y="-2167.57" font-family="Times,serif" font-size="14.00">stage0_layer0_mha_out_tp1</text>
<text text-anchor="middle" x="7977" y="-2152.57" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="7977" y="-2137.57" font-family="Times,serif" font-size="14.00">In: batch_size, heads=16, seq_len=128, seq_len=128</text>
<text text-anchor="middle" x="7977" y="-2122.57" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//8</text>
</g>
<!-- stage0_layer0_mha_softmax&#45;&gt;stage0_layer0_mha_out_tp1 -->
<g id="edge12" class="edge">
<title>stage0_layer0_mha_softmax&#45;&gt;stage0_layer0_mha_out_tp1</title>
<path fill="none" stroke="black" d="M8811.84,-2239.03C8645.74,-2227.71 8405.55,-2209.05 8186.32,-2182.9"/>
<polygon fill="black" stroke="black" points="8186.57,-2179.4 8176.23,-2181.69 8185.74,-2186.35 8186.57,-2179.4"/>
</g>
<!-- stage0_layer0_mha_out_tp2 -->
<g id="node15" class="node">
<title>stage0_layer0_mha_out_tp2</title>
<polygon fill="none" stroke="black" points="8592,-2182.77 8194,-2182.77 8194,-2114.77 8592,-2114.77 8592,-2182.77"/>
<text text-anchor="middle" x="8393" y="-2167.57" font-family="Times,serif" font-size="14.00">stage0_layer0_mha_out_tp2</text>
<text text-anchor="middle" x="8393" y="-2152.57" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="8393" y="-2137.57" font-family="Times,serif" font-size="14.00">In: batch_size, heads=16, seq_len=128, seq_len=128</text>
<text text-anchor="middle" x="8393" y="-2122.57" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//8</text>
</g>
<!-- stage0_layer0_mha_softmax&#45;&gt;stage0_layer0_mha_out_tp2 -->
<g id="edge13" class="edge">
<title>stage0_layer0_mha_softmax&#45;&gt;stage0_layer0_mha_out_tp2</title>
<path fill="none" stroke="black" d="M8814.84,-2218.72C8746.81,-2207.6 8670.8,-2195.18 8602.24,-2183.97"/>
<polygon fill="black" stroke="black" points="8602.61,-2180.48 8592.18,-2182.32 8601.48,-2187.39 8602.61,-2180.48"/>
</g>
<!-- stage0_layer0_mha_out_tp3 -->
<g id="node16" class="node">
<title>stage0_layer0_mha_out_tp3</title>
<polygon fill="none" stroke="black" points="9008,-2182.77 8610,-2182.77 8610,-2114.77 9008,-2114.77 9008,-2182.77"/>
<text text-anchor="middle" x="8809" y="-2167.57" font-family="Times,serif" font-size="14.00">stage0_layer0_mha_out_tp3</text>
<text text-anchor="middle" x="8809" y="-2152.57" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="8809" y="-2137.57" font-family="Times,serif" font-size="14.00">In: batch_size, heads=16, seq_len=128, seq_len=128</text>
<text text-anchor="middle" x="8809" y="-2122.57" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//8</text>
</g>
<!-- stage0_layer0_mha_softmax&#45;&gt;stage0_layer0_mha_out_tp3 -->
<g id="edge14" class="edge">
<title>stage0_layer0_mha_softmax&#45;&gt;stage0_layer0_mha_out_tp3</title>
<path fill="none" stroke="black" d="M8949.47,-2218.65C8929.11,-2208.67 8906.62,-2197.64 8885.71,-2187.39"/>
<polygon fill="black" stroke="black" points="8887.07,-2184.15 8876.55,-2182.89 8883.99,-2190.44 8887.07,-2184.15"/>
</g>
<!-- stage0_layer0_mha_out_tp4 -->
<g id="node17" class="node">
<title>stage0_layer0_mha_out_tp4</title>
<polygon fill="none" stroke="black" points="9424,-2182.77 9026,-2182.77 9026,-2114.77 9424,-2114.77 9424,-2182.77"/>
<text text-anchor="middle" x="9225" y="-2167.57" font-family="Times,serif" font-size="14.00">stage0_layer0_mha_out_tp4</text>
<text text-anchor="middle" x="9225" y="-2152.57" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="9225" y="-2137.57" font-family="Times,serif" font-size="14.00">In: batch_size, heads=16, seq_len=128, seq_len=128</text>
<text text-anchor="middle" x="9225" y="-2122.57" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//8</text>
</g>
<!-- stage0_layer0_mha_softmax&#45;&gt;stage0_layer0_mha_out_tp4 -->
<g id="edge15" class="edge">
<title>stage0_layer0_mha_softmax&#45;&gt;stage0_layer0_mha_out_tp4</title>
<path fill="none" stroke="black" d="M9084.53,-2218.65C9104.89,-2208.67 9127.38,-2197.64 9148.29,-2187.39"/>
<polygon fill="black" stroke="black" points="9150.01,-2190.44 9157.45,-2182.89 9146.93,-2184.15 9150.01,-2190.44"/>
</g>
<!-- stage0_layer0_mha_out_tp5 -->
<g id="node18" class="node">
<title>stage0_layer0_mha_out_tp5</title>
<polygon fill="none" stroke="black" points="9840,-2182.77 9442,-2182.77 9442,-2114.77 9840,-2114.77 9840,-2182.77"/>
<text text-anchor="middle" x="9641" y="-2167.57" font-family="Times,serif" font-size="14.00">stage0_layer0_mha_out_tp5</text>
<text text-anchor="middle" x="9641" y="-2152.57" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="9641" y="-2137.57" font-family="Times,serif" font-size="14.00">In: batch_size, heads=16, seq_len=128, seq_len=128</text>
<text text-anchor="middle" x="9641" y="-2122.57" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//8</text>
</g>
<!-- stage0_layer0_mha_softmax&#45;&gt;stage0_layer0_mha_out_tp5 -->
<g id="edge16" class="edge">
<title>stage0_layer0_mha_softmax&#45;&gt;stage0_layer0_mha_out_tp5</title>
<path fill="none" stroke="black" d="M9219.16,-2218.72C9287.19,-2207.6 9363.2,-2195.18 9431.76,-2183.97"/>
<polygon fill="black" stroke="black" points="9432.52,-2187.39 9441.82,-2182.32 9431.39,-2180.48 9432.52,-2187.39"/>
</g>
<!-- stage0_layer0_mha_out_tp6 -->
<g id="node19" class="node">
<title>stage0_layer0_mha_out_tp6</title>
<polygon fill="none" stroke="black" points="10256,-2182.77 9858,-2182.77 9858,-2114.77 10256,-2114.77 10256,-2182.77"/>
<text text-anchor="middle" x="10057" y="-2167.57" font-family="Times,serif" font-size="14.00">stage0_layer0_mha_out_tp6</text>
<text text-anchor="middle" x="10057" y="-2152.57" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="10057" y="-2137.57" font-family="Times,serif" font-size="14.00">In: batch_size, heads=16, seq_len=128, seq_len=128</text>
<text text-anchor="middle" x="10057" y="-2122.57" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//8</text>
</g>
<!-- stage0_layer0_mha_softmax&#45;&gt;stage0_layer0_mha_out_tp6 -->
<g id="edge17" class="edge">
<title>stage0_layer0_mha_softmax&#45;&gt;stage0_layer0_mha_out_tp6</title>
<path fill="none" stroke="black" d="M9222.16,-2239.03C9388.26,-2227.71 9628.45,-2209.05 9847.68,-2182.9"/>
<polygon fill="black" stroke="black" points="9848.26,-2186.35 9857.77,-2181.69 9847.43,-2179.4 9848.26,-2186.35"/>
</g>
<!-- stage0_layer0_mha_out_tp7 -->
<g id="node20" class="node">
<title>stage0_layer0_mha_out_tp7</title>
<polygon fill="none" stroke="black" points="10672,-2182.77 10274,-2182.77 10274,-2114.77 10672,-2114.77 10672,-2182.77"/>
<text text-anchor="middle" x="10473" y="-2167.57" font-family="Times,serif" font-size="14.00">stage0_layer0_mha_out_tp7</text>
<text text-anchor="middle" x="10473" y="-2152.57" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="10473" y="-2137.57" font-family="Times,serif" font-size="14.00">In: batch_size, heads=16, seq_len=128, seq_len=128</text>
<text text-anchor="middle" x="10473" y="-2122.57" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//8</text>
</g>
<!-- stage0_layer0_mha_softmax&#45;&gt;stage0_layer0_mha_out_tp7 -->
<g id="edge18" class="edge">
<title>stage0_layer0_mha_softmax&#45;&gt;stage0_layer0_mha_out_tp7</title>
<path fill="none" stroke="black" d="M9222.07,-2246.85C9467.55,-2239.49 9891.12,-2222.15 10263.61,-2182.88"/>
<polygon fill="black" stroke="black" points="10264.21,-2186.33 10273.79,-2181.8 10263.47,-2179.37 10264.21,-2186.33"/>
</g>
<!-- stage0_layer0_ar_mha -->
<g id="node21" class="node">
<title>stage0_layer0_ar_mha</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="9017" cy="-2041.29" rx="286.26" ry="37.45"/>
<text text-anchor="middle" x="9017" y="-2052.59" font-family="Times,serif" font-size="14.00">stage0_layer0_ar_mha</text>
<text text-anchor="middle" x="9017" y="-2037.59" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024//8 (shard)</text>
<text text-anchor="middle" x="9017" y="-2022.59" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024 (full)</text>
</g>
<!-- stage0_layer0_mha_out_tp0&#45;&gt;stage0_layer0_ar_mha -->
<g id="edge19" class="edge">
<title>stage0_layer0_mha_out_tp0&#45;&gt;stage0_layer0_ar_mha</title>
<path fill="none" stroke="black" d="M7760.21,-2115.66C7763.16,-2115.35 7766.09,-2115.05 7769,-2114.77 8190.84,-2073.48 8299.51,-2112.8 8722,-2078.77 8751.12,-2076.42 8781.78,-2073.33 8811.88,-2069.94"/>
<polygon fill="black" stroke="black" points="8812.52,-2073.39 8822.06,-2068.77 8811.73,-2066.43 8812.52,-2073.39"/>
</g>
<!-- stage0_layer0_mha_out_tp1&#45;&gt;stage0_layer0_ar_mha -->
<g id="edge20" class="edge">
<title>stage0_layer0_mha_out_tp1&#45;&gt;stage0_layer0_ar_mha</title>
<path fill="none" stroke="black" d="M8176.22,-2115.78C8179.17,-2115.43 8182.09,-2115.09 8185,-2114.77 8422.7,-2088 8483.88,-2101.45 8722,-2078.77 8750.03,-2076.1 8779.52,-2072.91 8808.56,-2069.54"/>
<polygon fill="black" stroke="black" points="8809.29,-2072.98 8818.81,-2068.34 8808.48,-2066.03 8809.29,-2072.98"/>
</g>
<!-- stage0_layer0_mha_out_tp2&#45;&gt;stage0_layer0_ar_mha -->
<g id="edge21" class="edge">
<title>stage0_layer0_mha_out_tp2&#45;&gt;stage0_layer0_ar_mha</title>
<path fill="none" stroke="black" d="M8588.3,-2114.75C8667.24,-2101.41 8757.82,-2086.1 8835.33,-2073"/>
<polygon fill="black" stroke="black" points="8835.92,-2076.45 8845.2,-2071.33 8834.76,-2069.55 8835.92,-2076.45"/>
</g>
<!-- stage0_layer0_mha_out_tp3&#45;&gt;stage0_layer0_ar_mha -->
<g id="edge22" class="edge">
<title>stage0_layer0_mha_out_tp3&#45;&gt;stage0_layer0_ar_mha</title>
<path fill="none" stroke="black" d="M8874.24,-2114.68C8894.47,-2104.43 8916.97,-2093.01 8938.02,-2082.34"/>
<polygon fill="black" stroke="black" points="8939.61,-2085.46 8946.95,-2077.81 8936.44,-2079.22 8939.61,-2085.46"/>
</g>
<!-- stage0_layer0_mha_out_tp4&#45;&gt;stage0_layer0_ar_mha -->
<g id="edge23" class="edge">
<title>stage0_layer0_mha_out_tp4&#45;&gt;stage0_layer0_ar_mha</title>
<path fill="none" stroke="black" d="M9159.76,-2114.68C9139.53,-2104.43 9117.03,-2093.01 9095.98,-2082.34"/>
<polygon fill="black" stroke="black" points="9097.56,-2079.22 9087.05,-2077.81 9094.39,-2085.46 9097.56,-2079.22"/>
</g>
<!-- stage0_layer0_mha_out_tp5&#45;&gt;stage0_layer0_ar_mha -->
<g id="edge24" class="edge">
<title>stage0_layer0_mha_out_tp5&#45;&gt;stage0_layer0_ar_mha</title>
<path fill="none" stroke="black" d="M9445.7,-2114.75C9366.76,-2101.41 9276.18,-2086.1 9198.67,-2073"/>
<polygon fill="black" stroke="black" points="9199.24,-2069.55 9188.8,-2071.33 9198.08,-2076.45 9199.24,-2069.55"/>
</g>
<!-- stage0_layer0_mha_out_tp6&#45;&gt;stage0_layer0_ar_mha -->
<g id="edge25" class="edge">
<title>stage0_layer0_mha_out_tp6&#45;&gt;stage0_layer0_ar_mha</title>
<path fill="none" stroke="black" d="M9857.77,-2115.86C9854.83,-2115.49 9851.9,-2115.12 9849,-2114.77 9658.35,-2091.37 9442.22,-2072.78 9278.03,-2060.29"/>
<polygon fill="black" stroke="black" points="9278.02,-2056.77 9267.78,-2059.51 9277.49,-2063.75 9278.02,-2056.77"/>
</g>
<!-- stage0_layer0_mha_out_tp7&#45;&gt;stage0_layer0_ar_mha -->
<g id="edge26" class="edge">
<title>stage0_layer0_mha_out_tp7&#45;&gt;stage0_layer0_ar_mha</title>
<path fill="none" stroke="black" d="M10273.78,-2115.75C10270.84,-2115.41 10267.91,-2115.08 10265,-2114.77 9936.82,-2079.29 9558.09,-2060.39 9304.7,-2050.89"/>
<polygon fill="black" stroke="black" points="9304.74,-2047.38 9294.62,-2050.51 9304.48,-2054.38 9304.74,-2047.38"/>
</g>
<!-- stage0_layer0_ar_mha&#45;&gt;stage0_layer0_resid1 -->
<g id="edge28" class="edge">
<title>stage0_layer0_ar_mha&#45;&gt;stage0_layer0_resid1</title>
<path fill="none" stroke="black" d="M8937.75,-2005.17C8913.65,-1994.49 8887.09,-1982.72 8862.71,-1971.91"/>
<polygon fill="black" stroke="black" points="8864.04,-1968.67 8853.48,-1967.82 8861.2,-1975.07 8864.04,-1968.67"/>
</g>
<!-- stage0_layer0_moe_gate -->
<g id="node23" class="node">
<title>stage0_layer0_moe_gate</title>
<polygon fill="none" stroke="black" points="6130,-1863.81 5798,-1863.81 5798,-1795.81 6130,-1795.81 6130,-1863.81"/>
<text text-anchor="middle" x="5964" y="-1848.61" font-family="Times,serif" font-size="14.00">stage0_layer0_moe_gate</text>
<text text-anchor="middle" x="5964" y="-1833.61" font-family="Times,serif" font-size="14.00">GPU: all_stage0</text>
<text text-anchor="middle" x="5964" y="-1818.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="5964" y="-1803.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, 64</text>
</g>
<!-- stage0_layer0_resid1&#45;&gt;stage0_layer0_moe_gate -->
<g id="edge29" class="edge">
<title>stage0_layer0_resid1&#45;&gt;stage0_layer0_moe_gate</title>
<path fill="none" stroke="black" d="M8596.74,-1926.21C8085.76,-1907.69 6644,-1855.45 6140.32,-1837.2"/>
<polygon fill="black" stroke="black" points="6140.17,-1833.69 6130.05,-1836.83 6139.92,-1840.69 6140.17,-1833.69"/>
</g>
<!-- stage0_layer0_resid2 -->
<g id="node57" class="node">
<title>stage0_layer0_resid2</title>
<polygon fill="none" stroke="black" points="8961,-1551.81 8597,-1551.81 8597,-1483.81 8961,-1483.81 8961,-1551.81"/>
<text text-anchor="middle" x="8779" y="-1536.61" font-family="Times,serif" font-size="14.00">stage0_layer0_resid2</text>
<text text-anchor="middle" x="8779" y="-1521.61" font-family="Times,serif" font-size="14.00">GPU: all_stage0</text>
<text text-anchor="middle" x="8779" y="-1506.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024 (x2)</text>
<text text-anchor="middle" x="8779" y="-1491.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_resid1&#45;&gt;stage0_layer0_resid2 -->
<g id="edge94" class="edge">
<title>stage0_layer0_resid1&#45;&gt;stage0_layer0_resid2</title>
<path fill="none" stroke="black" d="M8961.11,-1928.33C9567.53,-1912.54 11485.32,-1855.21 11575,-1759.81 11595.7,-1737.79 11595.7,-1713.83 11575,-1691.81 11485.82,-1596.95 9589.01,-1539.73 8971.45,-1523.56"/>
<polygon fill="black" stroke="black" points="8971.2,-1520.06 8961.11,-1523.29 8971.02,-1527.05 8971.2,-1520.06"/>
</g>
<!-- stage0_layer0_exp0 -->
<g id="node24" class="node">
<title>stage0_layer0_exp0</title>
<polygon fill="none" stroke="black" points="344,-1759.81 0,-1759.81 0,-1691.81 344,-1691.81 344,-1759.81"/>
<text text-anchor="middle" x="172" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp0</text>
<text text-anchor="middle" x="172" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="172" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="172" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp0 -->
<g id="edge30" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp0</title>
<path fill="none" stroke="black" d="M5797.87,-1828.44C4931.93,-1826.25 952.89,-1813.38 354.58,-1759.87"/>
<polygon fill="black" stroke="black" points="354.63,-1756.36 344.35,-1758.92 353.99,-1763.33 354.63,-1756.36"/>
</g>
<!-- stage0_layer0_exp1 -->
<g id="node25" class="node">
<title>stage0_layer0_exp1</title>
<polygon fill="none" stroke="black" points="706,-1759.81 362,-1759.81 362,-1691.81 706,-1691.81 706,-1759.81"/>
<text text-anchor="middle" x="534" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp1</text>
<text text-anchor="middle" x="534" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="534" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="534" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp1 -->
<g id="edge31" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp1</title>
<path fill="none" stroke="black" d="M5797.7,-1828.28C4966.13,-1825.41 1277.17,-1809.98 716.71,-1759.88"/>
<polygon fill="black" stroke="black" points="716.64,-1756.36 706.35,-1758.92 715.99,-1763.33 716.64,-1756.36"/>
</g>
<!-- stage0_layer0_exp2 -->
<g id="node26" class="node">
<title>stage0_layer0_exp2</title>
<polygon fill="none" stroke="black" points="1068,-1759.81 724,-1759.81 724,-1691.81 1068,-1691.81 1068,-1759.81"/>
<text text-anchor="middle" x="896" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp2</text>
<text text-anchor="middle" x="896" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="896" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="896" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp2 -->
<g id="edge32" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp2</title>
<path fill="none" stroke="black" d="M5797.72,-1828.11C5001.88,-1824.52 1599.35,-1806.59 1078.34,-1759.85"/>
<polygon fill="black" stroke="black" points="1078.64,-1756.36 1068.35,-1758.91 1077.98,-1763.33 1078.64,-1756.36"/>
</g>
<!-- stage0_layer0_exp3 -->
<g id="node27" class="node">
<title>stage0_layer0_exp3</title>
<polygon fill="none" stroke="black" points="1430,-1759.81 1086,-1759.81 1086,-1691.81 1430,-1691.81 1430,-1759.81"/>
<text text-anchor="middle" x="1258" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp3</text>
<text text-anchor="middle" x="1258" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="1258" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="1258" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp3 -->
<g id="edge33" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp3</title>
<path fill="none" stroke="black" d="M5797.82,-1827.91C5039.55,-1823.55 1924.44,-1803.22 1440.63,-1759.87"/>
<polygon fill="black" stroke="black" points="1440.64,-1756.36 1430.35,-1758.91 1439.98,-1763.33 1440.64,-1756.36"/>
</g>
<!-- stage0_layer0_exp4 -->
<g id="node28" class="node">
<title>stage0_layer0_exp4</title>
<polygon fill="none" stroke="black" points="1792,-1759.81 1448,-1759.81 1448,-1691.81 1792,-1691.81 1792,-1759.81"/>
<text text-anchor="middle" x="1620" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp4</text>
<text text-anchor="middle" x="1620" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="1620" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="1620" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp4 -->
<g id="edge34" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp4</title>
<path fill="none" stroke="black" d="M5797.97,-1827.67C5078.59,-1822.5 2247.42,-1799.85 1802.42,-1759.85"/>
<polygon fill="black" stroke="black" points="1802.64,-1756.36 1792.35,-1758.9 1801.98,-1763.33 1802.64,-1756.36"/>
</g>
<!-- stage0_layer0_exp5 -->
<g id="node29" class="node">
<title>stage0_layer0_exp5</title>
<polygon fill="none" stroke="black" points="2154,-1759.81 1810,-1759.81 1810,-1691.81 2154,-1691.81 2154,-1759.81"/>
<text text-anchor="middle" x="1982" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp5</text>
<text text-anchor="middle" x="1982" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="1982" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="1982" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp5 -->
<g id="edge35" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp5</title>
<path fill="none" stroke="black" d="M5797.91,-1829.38C5165.15,-1831 2904.24,-1831.57 2164.33,-1759.88"/>
<polygon fill="black" stroke="black" points="2164.65,-1756.39 2154.36,-1758.9 2163.97,-1763.36 2164.65,-1756.39"/>
</g>
<!-- stage0_layer0_exp6 -->
<g id="node30" class="node">
<title>stage0_layer0_exp6</title>
<polygon fill="none" stroke="black" points="2516,-1759.81 2172,-1759.81 2172,-1691.81 2516,-1691.81 2516,-1759.81"/>
<text text-anchor="middle" x="2344" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp6</text>
<text text-anchor="middle" x="2344" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="2344" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="2344" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp6 -->
<g id="edge36" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp6</title>
<path fill="none" stroke="black" d="M5797.9,-1829.01C5204.8,-1829.16 3191.95,-1824.82 2526.54,-1759.9"/>
<polygon fill="black" stroke="black" points="2526.65,-1756.39 2516.36,-1758.89 2525.96,-1763.36 2526.65,-1756.39"/>
</g>
<!-- stage0_layer0_exp7 -->
<g id="node31" class="node">
<title>stage0_layer0_exp7</title>
<polygon fill="none" stroke="black" points="2878,-1759.81 2534,-1759.81 2534,-1691.81 2878,-1691.81 2878,-1759.81"/>
<text text-anchor="middle" x="2706" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp7</text>
<text text-anchor="middle" x="2706" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="2706" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="2706" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp7 -->
<g id="edge37" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp7</title>
<path fill="none" stroke="black" d="M5797.93,-1828.55C5246.73,-1827.13 3479.83,-1818.1 2888.69,-1759.92"/>
<polygon fill="black" stroke="black" points="2888.66,-1756.39 2878.36,-1758.88 2887.96,-1763.36 2888.66,-1756.39"/>
</g>
<!-- stage0_layer0_exp8 -->
<g id="node32" class="node">
<title>stage0_layer0_exp8</title>
<polygon fill="none" stroke="black" points="3240,-1759.81 2896,-1759.81 2896,-1691.81 3240,-1691.81 3240,-1759.81"/>
<text text-anchor="middle" x="3068" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp8</text>
<text text-anchor="middle" x="3068" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="3068" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="3068" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp8 -->
<g id="edge38" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp8</title>
<path fill="none" stroke="black" d="M5797.73,-1827.96C5290.62,-1824.84 3767.29,-1811.41 3250.51,-1759.9"/>
<polygon fill="black" stroke="black" points="3250.66,-1756.4 3240.36,-1758.87 3249.95,-1763.36 3250.66,-1756.4"/>
</g>
<!-- stage0_layer0_exp9 -->
<g id="node33" class="node">
<title>stage0_layer0_exp9</title>
<polygon fill="none" stroke="black" points="3602,-1759.81 3258,-1759.81 3258,-1691.81 3602,-1691.81 3602,-1759.81"/>
<text text-anchor="middle" x="3430" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp9</text>
<text text-anchor="middle" x="3430" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="3430" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="3430" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp9 -->
<g id="edge39" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp9</title>
<path fill="none" stroke="black" d="M5797.72,-1827.2C5338,-1822.24 4055.22,-1804.75 3612.34,-1759.89"/>
<polygon fill="black" stroke="black" points="3612.67,-1756.4 3602.36,-1758.85 3611.95,-1763.36 3612.67,-1756.4"/>
</g>
<!-- stage0_layer0_exp10 -->
<g id="node34" class="node">
<title>stage0_layer0_exp10</title>
<polygon fill="none" stroke="black" points="3964,-1759.81 3620,-1759.81 3620,-1691.81 3964,-1691.81 3964,-1759.81"/>
<text text-anchor="middle" x="3792" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp10</text>
<text text-anchor="middle" x="3792" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="3792" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="3792" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp10 -->
<g id="edge40" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp10</title>
<path fill="none" stroke="black" d="M5797.76,-1826.17C5389.45,-1819.19 4344.34,-1798.16 3974.57,-1759.91"/>
<polygon fill="black" stroke="black" points="3974.67,-1756.4 3964.36,-1758.83 3973.94,-1763.36 3974.67,-1756.4"/>
</g>
<!-- stage0_layer0_exp11 -->
<g id="node35" class="node">
<title>stage0_layer0_exp11</title>
<polygon fill="none" stroke="black" points="4326,-1759.81 3982,-1759.81 3982,-1691.81 4326,-1691.81 4326,-1759.81"/>
<text text-anchor="middle" x="4154" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp11</text>
<text text-anchor="middle" x="4154" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="4154" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="4154" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp11 -->
<g id="edge41" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp11</title>
<path fill="none" stroke="black" d="M5797.8,-1829.33C5504.34,-1828.56 4875.26,-1819.43 4336.68,-1759.95"/>
<polygon fill="black" stroke="black" points="4336.69,-1756.43 4326.37,-1758.8 4335.92,-1763.39 4336.69,-1756.43"/>
</g>
<!-- stage0_layer0_exp12 -->
<g id="node36" class="node">
<title>stage0_layer0_exp12</title>
<polygon fill="none" stroke="black" points="4688,-1759.81 4344,-1759.81 4344,-1691.81 4688,-1691.81 4688,-1759.81"/>
<text text-anchor="middle" x="4516" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp12</text>
<text text-anchor="middle" x="4516" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="4516" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="4516" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp12 -->
<g id="edge42" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp12</title>
<path fill="none" stroke="black" d="M5797.91,-1826.43C5557.27,-1821.47 5097.68,-1806.4 4698.39,-1759.93"/>
<polygon fill="black" stroke="black" points="4698.71,-1756.44 4688.37,-1758.75 4697.9,-1763.39 4698.71,-1756.44"/>
</g>
<!-- stage0_layer0_exp13 -->
<g id="node37" class="node">
<title>stage0_layer0_exp13</title>
<polygon fill="none" stroke="black" points="5050,-1759.81 4706,-1759.81 4706,-1691.81 5050,-1691.81 5050,-1759.81"/>
<text text-anchor="middle" x="4878" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp13</text>
<text text-anchor="middle" x="4878" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="4878" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="4878" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp13 -->
<g id="edge43" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp13</title>
<path fill="none" stroke="black" d="M5797.92,-1821.35C5618.31,-1812.09 5323.49,-1793.41 5060.51,-1759.96"/>
<polygon fill="black" stroke="black" points="5060.75,-1756.47 5050.38,-1758.67 5059.86,-1763.41 5060.75,-1756.47"/>
</g>
<!-- stage0_layer0_exp14 -->
<g id="node38" class="node">
<title>stage0_layer0_exp14</title>
<polygon fill="none" stroke="black" points="5412,-1759.81 5068,-1759.81 5068,-1691.81 5412,-1691.81 5412,-1759.81"/>
<text text-anchor="middle" x="5240" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp14</text>
<text text-anchor="middle" x="5240" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="5240" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="5240" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp14 -->
<g id="edge44" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp14</title>
<path fill="none" stroke="black" d="M5797.92,-1810.06C5692.99,-1797.65 5554.33,-1780.21 5422.68,-1760.05"/>
<polygon fill="black" stroke="black" points="5422.83,-1756.53 5412.41,-1758.47 5421.76,-1763.45 5422.83,-1756.53"/>
</g>
<!-- stage0_layer0_exp15 -->
<g id="node39" class="node">
<title>stage0_layer0_exp15</title>
<polygon fill="none" stroke="black" points="5774,-1759.81 5430,-1759.81 5430,-1691.81 5774,-1691.81 5774,-1759.81"/>
<text text-anchor="middle" x="5602" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp15</text>
<text text-anchor="middle" x="5602" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="5602" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="5602" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp15 -->
<g id="edge45" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp15</title>
<path fill="none" stroke="black" d="M5846.47,-1795.7C5808.88,-1785.11 5767.11,-1773.34 5728.89,-1762.57"/>
<polygon fill="black" stroke="black" points="5729.83,-1759.19 5719.25,-1759.85 5727.93,-1765.93 5729.83,-1759.19"/>
</g>
<!-- stage0_layer0_exp16 -->
<g id="node40" class="node">
<title>stage0_layer0_exp16</title>
<polygon fill="none" stroke="black" points="6136,-1759.81 5792,-1759.81 5792,-1691.81 6136,-1691.81 6136,-1759.81"/>
<text text-anchor="middle" x="5964" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp16</text>
<text text-anchor="middle" x="5964" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="5964" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="5964" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp16 -->
<g id="edge46" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp16</title>
<path fill="none" stroke="black" d="M5964,-1795.7C5964,-1787.59 5964,-1778.8 5964,-1770.29"/>
<polygon fill="black" stroke="black" points="5967.5,-1770.11 5964,-1760.11 5960.5,-1770.11 5967.5,-1770.11"/>
</g>
<!-- stage0_layer0_exp17 -->
<g id="node41" class="node">
<title>stage0_layer0_exp17</title>
<polygon fill="none" stroke="black" points="6498,-1759.81 6154,-1759.81 6154,-1691.81 6498,-1691.81 6498,-1759.81"/>
<text text-anchor="middle" x="6326" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp17</text>
<text text-anchor="middle" x="6326" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="6326" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="6326" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp17 -->
<g id="edge47" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp17</title>
<path fill="none" stroke="black" d="M6081.53,-1795.7C6119.12,-1785.11 6160.89,-1773.34 6199.11,-1762.57"/>
<polygon fill="black" stroke="black" points="6200.07,-1765.93 6208.75,-1759.85 6198.17,-1759.19 6200.07,-1765.93"/>
</g>
<!-- stage0_layer0_exp18 -->
<g id="node42" class="node">
<title>stage0_layer0_exp18</title>
<polygon fill="none" stroke="black" points="6860,-1759.81 6516,-1759.81 6516,-1691.81 6860,-1691.81 6860,-1759.81"/>
<text text-anchor="middle" x="6688" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp18</text>
<text text-anchor="middle" x="6688" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="6688" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="6688" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp18 -->
<g id="edge48" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp18</title>
<path fill="none" stroke="black" d="M6130.08,-1810.06C6235.01,-1797.65 6373.67,-1780.21 6505.32,-1760.05"/>
<polygon fill="black" stroke="black" points="6506.24,-1763.45 6515.59,-1758.47 6505.17,-1756.53 6506.24,-1763.45"/>
</g>
<!-- stage0_layer0_exp19 -->
<g id="node43" class="node">
<title>stage0_layer0_exp19</title>
<polygon fill="none" stroke="black" points="7222,-1759.81 6878,-1759.81 6878,-1691.81 7222,-1691.81 7222,-1759.81"/>
<text text-anchor="middle" x="7050" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp19</text>
<text text-anchor="middle" x="7050" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="7050" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="7050" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp19 -->
<g id="edge49" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp19</title>
<path fill="none" stroke="black" d="M6130.08,-1821.35C6309.69,-1812.09 6604.51,-1793.41 6867.49,-1759.96"/>
<polygon fill="black" stroke="black" points="6868.14,-1763.41 6877.62,-1758.67 6867.25,-1756.47 6868.14,-1763.41"/>
</g>
<!-- stage0_layer0_exp20 -->
<g id="node44" class="node">
<title>stage0_layer0_exp20</title>
<polygon fill="none" stroke="black" points="7584,-1759.81 7240,-1759.81 7240,-1691.81 7584,-1691.81 7584,-1759.81"/>
<text text-anchor="middle" x="7412" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp20</text>
<text text-anchor="middle" x="7412" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="7412" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="7412" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp20 -->
<g id="edge50" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp20</title>
<path fill="none" stroke="black" d="M6130.09,-1826.43C6370.73,-1821.47 6830.32,-1806.4 7229.61,-1759.93"/>
<polygon fill="black" stroke="black" points="7230.1,-1763.39 7239.63,-1758.75 7229.29,-1756.44 7230.1,-1763.39"/>
</g>
<!-- stage0_layer0_exp21 -->
<g id="node45" class="node">
<title>stage0_layer0_exp21</title>
<polygon fill="none" stroke="black" points="7946,-1759.81 7602,-1759.81 7602,-1691.81 7946,-1691.81 7946,-1759.81"/>
<text text-anchor="middle" x="7774" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp21</text>
<text text-anchor="middle" x="7774" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="7774" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="7774" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp21 -->
<g id="edge51" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp21</title>
<path fill="none" stroke="black" d="M6130.2,-1829.33C6423.66,-1828.56 7052.74,-1819.43 7591.32,-1759.95"/>
<polygon fill="black" stroke="black" points="7592.08,-1763.39 7601.63,-1758.8 7591.31,-1756.43 7592.08,-1763.39"/>
</g>
<!-- stage0_layer0_exp22 -->
<g id="node46" class="node">
<title>stage0_layer0_exp22</title>
<polygon fill="none" stroke="black" points="8308,-1759.81 7964,-1759.81 7964,-1691.81 8308,-1691.81 8308,-1759.81"/>
<text text-anchor="middle" x="8136" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp22</text>
<text text-anchor="middle" x="8136" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="8136" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="8136" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp22 -->
<g id="edge52" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp22</title>
<path fill="none" stroke="black" d="M6130.24,-1826.17C6538.55,-1819.19 7583.66,-1798.16 7953.43,-1759.91"/>
<polygon fill="black" stroke="black" points="7954.06,-1763.36 7963.64,-1758.83 7953.33,-1756.4 7954.06,-1763.36"/>
</g>
<!-- stage0_layer0_exp23 -->
<g id="node47" class="node">
<title>stage0_layer0_exp23</title>
<polygon fill="none" stroke="black" points="8670,-1759.81 8326,-1759.81 8326,-1691.81 8670,-1691.81 8670,-1759.81"/>
<text text-anchor="middle" x="8498" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp23</text>
<text text-anchor="middle" x="8498" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="8498" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="8498" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp23 -->
<g id="edge53" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp23</title>
<path fill="none" stroke="black" d="M6130.28,-1827.2C6590,-1822.24 7872.78,-1804.75 8315.66,-1759.89"/>
<polygon fill="black" stroke="black" points="8316.05,-1763.36 8325.64,-1758.85 8315.33,-1756.4 8316.05,-1763.36"/>
</g>
<!-- stage0_layer0_exp24 -->
<g id="node48" class="node">
<title>stage0_layer0_exp24</title>
<polygon fill="none" stroke="black" points="9032,-1759.81 8688,-1759.81 8688,-1691.81 9032,-1691.81 9032,-1759.81"/>
<text text-anchor="middle" x="8860" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp24</text>
<text text-anchor="middle" x="8860" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="8860" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="8860" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp24 -->
<g id="edge54" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp24</title>
<path fill="none" stroke="black" d="M6130.27,-1827.96C6637.38,-1824.84 8160.71,-1811.41 8677.49,-1759.9"/>
<polygon fill="black" stroke="black" points="8678.05,-1763.36 8687.64,-1758.87 8677.34,-1756.4 8678.05,-1763.36"/>
</g>
<!-- stage0_layer0_exp25 -->
<g id="node49" class="node">
<title>stage0_layer0_exp25</title>
<polygon fill="none" stroke="black" points="9394,-1759.81 9050,-1759.81 9050,-1691.81 9394,-1691.81 9394,-1759.81"/>
<text text-anchor="middle" x="9222" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp25</text>
<text text-anchor="middle" x="9222" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="9222" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="9222" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp25 -->
<g id="edge55" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp25</title>
<path fill="none" stroke="black" d="M6130.07,-1828.55C6681.27,-1827.13 8448.17,-1818.1 9039.31,-1759.92"/>
<polygon fill="black" stroke="black" points="9040.04,-1763.36 9049.64,-1758.88 9039.34,-1756.39 9040.04,-1763.36"/>
</g>
<!-- stage0_layer0_exp26 -->
<g id="node50" class="node">
<title>stage0_layer0_exp26</title>
<polygon fill="none" stroke="black" points="9756,-1759.81 9412,-1759.81 9412,-1691.81 9756,-1691.81 9756,-1759.81"/>
<text text-anchor="middle" x="9584" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp26</text>
<text text-anchor="middle" x="9584" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="9584" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="9584" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp26 -->
<g id="edge56" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp26</title>
<path fill="none" stroke="black" d="M6130.1,-1829.01C6723.2,-1829.16 8736.05,-1824.82 9401.46,-1759.9"/>
<polygon fill="black" stroke="black" points="9402.04,-1763.36 9411.64,-1758.89 9401.35,-1756.39 9402.04,-1763.36"/>
</g>
<!-- stage0_layer0_exp27 -->
<g id="node51" class="node">
<title>stage0_layer0_exp27</title>
<polygon fill="none" stroke="black" points="10118,-1759.81 9774,-1759.81 9774,-1691.81 10118,-1691.81 10118,-1759.81"/>
<text text-anchor="middle" x="9946" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp27</text>
<text text-anchor="middle" x="9946" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="9946" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="9946" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp27 -->
<g id="edge57" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp27</title>
<path fill="none" stroke="black" d="M6130.09,-1829.38C6762.85,-1831 9023.76,-1831.57 9763.67,-1759.88"/>
<polygon fill="black" stroke="black" points="9764.03,-1763.36 9773.64,-1758.9 9763.35,-1756.39 9764.03,-1763.36"/>
</g>
<!-- stage0_layer0_exp28 -->
<g id="node52" class="node">
<title>stage0_layer0_exp28</title>
<polygon fill="none" stroke="black" points="10480,-1759.81 10136,-1759.81 10136,-1691.81 10480,-1691.81 10480,-1759.81"/>
<text text-anchor="middle" x="10308" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp28</text>
<text text-anchor="middle" x="10308" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="10308" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="10308" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp28 -->
<g id="edge58" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp28</title>
<path fill="none" stroke="black" d="M6130.03,-1827.67C6849.41,-1822.5 9680.58,-1799.85 10125.58,-1759.85"/>
<polygon fill="black" stroke="black" points="10126.02,-1763.33 10135.65,-1758.9 10125.36,-1756.36 10126.02,-1763.33"/>
</g>
<!-- stage0_layer0_exp29 -->
<g id="node53" class="node">
<title>stage0_layer0_exp29</title>
<polygon fill="none" stroke="black" points="10842,-1759.81 10498,-1759.81 10498,-1691.81 10842,-1691.81 10842,-1759.81"/>
<text text-anchor="middle" x="10670" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp29</text>
<text text-anchor="middle" x="10670" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="10670" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="10670" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp29 -->
<g id="edge59" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp29</title>
<path fill="none" stroke="black" d="M6130.18,-1827.91C6888.45,-1823.55 10003.56,-1803.22 10487.37,-1759.87"/>
<polygon fill="black" stroke="black" points="10488.02,-1763.33 10497.65,-1758.91 10487.36,-1756.36 10488.02,-1763.33"/>
</g>
<!-- stage0_layer0_exp30 -->
<g id="node54" class="node">
<title>stage0_layer0_exp30</title>
<polygon fill="none" stroke="black" points="11204,-1759.81 10860,-1759.81 10860,-1691.81 11204,-1691.81 11204,-1759.81"/>
<text text-anchor="middle" x="11032" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp30</text>
<text text-anchor="middle" x="11032" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="11032" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="11032" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp30 -->
<g id="edge60" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp30</title>
<path fill="none" stroke="black" d="M6130.28,-1828.11C6926.12,-1824.52 10328.65,-1806.59 10849.66,-1759.85"/>
<polygon fill="black" stroke="black" points="10850.02,-1763.33 10859.65,-1758.91 10849.36,-1756.36 10850.02,-1763.33"/>
</g>
<!-- stage0_layer0_exp31 -->
<g id="node55" class="node">
<title>stage0_layer0_exp31</title>
<polygon fill="none" stroke="black" points="11566,-1759.81 11222,-1759.81 11222,-1691.81 11566,-1691.81 11566,-1759.81"/>
<text text-anchor="middle" x="11394" y="-1744.61" font-family="Times,serif" font-size="14.00">stage0_layer0_exp31</text>
<text text-anchor="middle" x="11394" y="-1729.61" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="11394" y="-1714.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="11394" y="-1699.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp31 -->
<g id="edge61" class="edge">
<title>stage0_layer0_moe_gate&#45;&gt;stage0_layer0_exp31</title>
<path fill="none" stroke="black" d="M6130.3,-1828.28C6961.87,-1825.41 10650.83,-1809.98 11211.29,-1759.88"/>
<polygon fill="black" stroke="black" points="11212.01,-1763.33 11221.65,-1758.92 11211.36,-1756.36 11212.01,-1763.33"/>
</g>
<!-- stage0_layer0_moe_agg -->
<g id="node56" class="node">
<title>stage0_layer0_moe_agg</title>
<polygon fill="none" stroke="black" points="6146,-1655.81 5782,-1655.81 5782,-1587.81 6146,-1587.81 6146,-1655.81"/>
<text text-anchor="middle" x="5964" y="-1640.61" font-family="Times,serif" font-size="14.00">stage0_layer0_moe_agg</text>
<text text-anchor="middle" x="5964" y="-1625.61" font-family="Times,serif" font-size="14.00">GPU: all_stage0</text>
<text text-anchor="middle" x="5964" y="-1610.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024 (x4)</text>
<text text-anchor="middle" x="5964" y="-1595.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_exp0&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge62" class="edge">
<title>stage0_layer0_exp0&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M344.35,-1692.7C347.25,-1692.39 350.14,-1692.09 353,-1691.81 900.53,-1638.91 4849.4,-1625.65 5771.72,-1623.26"/>
<polygon fill="black" stroke="black" points="5771.78,-1626.76 5781.77,-1623.23 5771.76,-1619.76 5771.78,-1626.76"/>
</g>
<!-- stage0_layer0_exp1&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge63" class="edge">
<title>stage0_layer0_exp1&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M706.35,-1692.71C709.25,-1692.39 712.14,-1692.09 715,-1691.81 1224.73,-1642.35 4885.96,-1626.55 5771.52,-1623.43"/>
<polygon fill="black" stroke="black" points="5771.83,-1626.93 5781.81,-1623.4 5771.8,-1619.93 5771.83,-1626.93"/>
</g>
<!-- stage0_layer0_exp2&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge64" class="edge">
<title>stage0_layer0_exp2&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M1068.35,-1692.71C1071.26,-1692.39 1074.14,-1692.09 1077,-1691.81 1549.07,-1645.77 4924.62,-1627.52 5771.61,-1623.64"/>
<polygon fill="black" stroke="black" points="5771.78,-1627.14 5781.76,-1623.59 5771.75,-1620.14 5771.78,-1627.14"/>
</g>
<!-- stage0_layer0_exp3&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge65" class="edge">
<title>stage0_layer0_exp3&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M1430.35,-1692.72C1433.26,-1692.4 1436.14,-1692.09 1439,-1691.81 1873.49,-1649.19 4964.51,-1628.57 5771.61,-1623.87"/>
<polygon fill="black" stroke="black" points="5771.89,-1627.37 5781.87,-1623.81 5771.85,-1620.37 5771.89,-1627.37"/>
</g>
<!-- stage0_layer0_exp4&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge66" class="edge">
<title>stage0_layer0_exp4&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M1792.35,-1692.72C1795.26,-1692.4 1798.14,-1692.1 1801,-1691.81 2198.03,-1652.6 5006.45,-1629.7 5771.79,-1624.15"/>
<polygon fill="black" stroke="black" points="5771.83,-1627.65 5781.81,-1624.07 5771.78,-1620.65 5771.83,-1627.65"/>
</g>
<!-- stage0_layer0_exp5&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge67" class="edge">
<title>stage0_layer0_exp5&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M2154.36,-1692.73C2157.26,-1692.4 2160.14,-1692.1 2163,-1691.81 2874.07,-1621.01 5101.75,-1620.62 5771.6,-1622.18"/>
<polygon fill="black" stroke="black" points="5771.82,-1625.68 5781.83,-1622.2 5771.84,-1618.68 5771.82,-1625.68"/>
</g>
<!-- stage0_layer0_exp6&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge68" class="edge">
<title>stage0_layer0_exp6&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M2516.36,-1692.74C2519.26,-1692.41 2522.14,-1692.1 2525,-1691.81 3162.06,-1627.77 5144.81,-1622.6 5771.85,-1622.61"/>
<polygon fill="black" stroke="black" points="5771.89,-1626.11 5781.89,-1622.61 5771.89,-1619.11 5771.89,-1626.11"/>
</g>
<!-- stage0_layer0_exp7&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge69" class="edge">
<title>stage0_layer0_exp7&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M2878.36,-1692.75C2881.26,-1692.42 2884.14,-1692.1 2887,-1691.81 3450.24,-1634.52 5189.36,-1624.8 5771.73,-1623.15"/>
<polygon fill="black" stroke="black" points="5771.91,-1626.65 5781.9,-1623.12 5771.89,-1619.65 5771.91,-1626.65"/>
</g>
<!-- stage0_layer0_exp8&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge70" class="edge">
<title>stage0_layer0_exp8&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M3240.36,-1692.76C3243.26,-1692.42 3246.14,-1692.11 3249,-1691.81 3738.78,-1641.25 5236.46,-1627.26 5771.5,-1623.83"/>
<polygon fill="black" stroke="black" points="5771.65,-1627.33 5781.63,-1623.76 5771.61,-1620.33 5771.65,-1627.33"/>
</g>
<!-- stage0_layer0_exp9&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge71" class="edge">
<title>stage0_layer0_exp9&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M3602.36,-1692.77C3605.26,-1692.43 3608.14,-1692.11 3611,-1691.81 4027.8,-1647.96 5287.08,-1630.09 5771.36,-1624.71"/>
<polygon fill="black" stroke="black" points="5771.64,-1628.21 5781.6,-1624.6 5771.56,-1621.21 5771.64,-1628.21"/>
</g>
<!-- stage0_layer0_exp10&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge72" class="edge">
<title>stage0_layer0_exp10&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M3964.36,-1692.79C3967.26,-1692.45 3970.14,-1692.12 3973,-1691.81 4317.6,-1654.63 5342.97,-1633.38 5771.95,-1625.9"/>
<polygon fill="black" stroke="black" points="5772.03,-1629.4 5781.97,-1625.73 5771.91,-1622.4 5772.03,-1629.4"/>
</g>
<!-- stage0_layer0_exp11&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge73" class="edge">
<title>stage0_layer0_exp11&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M4326.37,-1692.82C4329.26,-1692.47 4332.14,-1692.13 4335,-1691.81 4852.02,-1634.01 5466.28,-1623.64 5771.69,-1622.39"/>
<polygon fill="black" stroke="black" points="5771.99,-1625.89 5781.97,-1622.35 5771.96,-1618.89 5771.99,-1625.89"/>
</g>
<!-- stage0_layer0_exp12&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge74" class="edge">
<title>stage0_layer0_exp12&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M4688.37,-1692.87C4691.27,-1692.5 4694.15,-1692.15 4697,-1691.81 5076.24,-1647.1 5522.82,-1631.3 5771.66,-1625.76"/>
<polygon fill="black" stroke="black" points="5771.97,-1629.26 5781.89,-1625.54 5771.82,-1622.26 5771.97,-1629.26"/>
</g>
<!-- stage0_layer0_exp13&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge75" class="edge">
<title>stage0_layer0_exp13&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M5050.38,-1692.96C5053.27,-1692.56 5056.15,-1692.18 5059,-1691.81 5303.96,-1660.23 5588.22,-1641.46 5771.82,-1631.65"/>
<polygon fill="black" stroke="black" points="5772.05,-1635.14 5781.85,-1631.11 5771.68,-1628.15 5772.05,-1635.14"/>
</g>
<!-- stage0_layer0_exp14&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge76" class="edge">
<title>stage0_layer0_exp14&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M5412.41,-1693.16C5415.29,-1692.7 5418.16,-1692.25 5421,-1691.81 5537.11,-1673.86 5667.72,-1657.16 5771.74,-1644.68"/>
<polygon fill="black" stroke="black" points="5772.21,-1648.15 5781.73,-1643.49 5771.38,-1641.2 5772.21,-1648.15"/>
</g>
<!-- stage0_layer0_exp15&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge77" class="edge">
<title>stage0_layer0_exp15&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M5719.53,-1691.7C5757.12,-1681.11 5798.89,-1669.34 5837.11,-1658.57"/>
<polygon fill="black" stroke="black" points="5838.07,-1661.93 5846.75,-1655.85 5836.17,-1655.19 5838.07,-1661.93"/>
</g>
<!-- stage0_layer0_exp16&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge78" class="edge">
<title>stage0_layer0_exp16&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M5964,-1691.7C5964,-1683.59 5964,-1674.8 5964,-1666.29"/>
<polygon fill="black" stroke="black" points="5967.5,-1666.11 5964,-1656.11 5960.5,-1666.11 5967.5,-1666.11"/>
</g>
<!-- stage0_layer0_exp17&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge79" class="edge">
<title>stage0_layer0_exp17&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M6208.47,-1691.7C6170.88,-1681.11 6129.11,-1669.34 6090.89,-1658.57"/>
<polygon fill="black" stroke="black" points="6091.83,-1655.19 6081.25,-1655.85 6089.93,-1661.93 6091.83,-1655.19"/>
</g>
<!-- stage0_layer0_exp18&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge80" class="edge">
<title>stage0_layer0_exp18&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M6515.59,-1693.16C6512.71,-1692.7 6509.84,-1692.25 6507,-1691.81 6390.89,-1673.86 6260.28,-1657.16 6156.26,-1644.68"/>
<polygon fill="black" stroke="black" points="6156.62,-1641.2 6146.27,-1643.49 6155.79,-1648.15 6156.62,-1641.2"/>
</g>
<!-- stage0_layer0_exp19&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge81" class="edge">
<title>stage0_layer0_exp19&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M6877.62,-1692.96C6874.73,-1692.56 6871.85,-1692.18 6869,-1691.81 6624.04,-1660.23 6339.78,-1641.46 6156.18,-1631.65"/>
<polygon fill="black" stroke="black" points="6156.32,-1628.15 6146.15,-1631.11 6155.95,-1635.14 6156.32,-1628.15"/>
</g>
<!-- stage0_layer0_exp20&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge82" class="edge">
<title>stage0_layer0_exp20&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M7239.63,-1692.87C7236.73,-1692.5 7233.85,-1692.15 7231,-1691.81 6851.76,-1647.1 6405.18,-1631.3 6156.34,-1625.76"/>
<polygon fill="black" stroke="black" points="6156.18,-1622.26 6146.11,-1625.54 6156.03,-1629.26 6156.18,-1622.26"/>
</g>
<!-- stage0_layer0_exp21&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge83" class="edge">
<title>stage0_layer0_exp21&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M7601.63,-1692.82C7598.74,-1692.47 7595.86,-1692.13 7593,-1691.81 7075.98,-1634.01 6461.72,-1623.64 6156.31,-1622.39"/>
<polygon fill="black" stroke="black" points="6156.04,-1618.89 6146.03,-1622.35 6156.01,-1625.89 6156.04,-1618.89"/>
</g>
<!-- stage0_layer0_exp22&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge84" class="edge">
<title>stage0_layer0_exp22&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M7963.64,-1692.79C7960.74,-1692.45 7957.86,-1692.12 7955,-1691.81 7610.4,-1654.63 6585.03,-1633.38 6156.05,-1625.9"/>
<polygon fill="black" stroke="black" points="6156.09,-1622.4 6146.03,-1625.73 6155.97,-1629.4 6156.09,-1622.4"/>
</g>
<!-- stage0_layer0_exp23&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge85" class="edge">
<title>stage0_layer0_exp23&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M8325.64,-1692.77C8322.74,-1692.43 8319.86,-1692.11 8317,-1691.81 7900.2,-1647.96 6640.92,-1630.09 6156.64,-1624.71"/>
<polygon fill="black" stroke="black" points="6156.44,-1621.21 6146.4,-1624.6 6156.36,-1628.21 6156.44,-1621.21"/>
</g>
<!-- stage0_layer0_exp24&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge86" class="edge">
<title>stage0_layer0_exp24&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M8687.64,-1692.76C8684.74,-1692.42 8681.86,-1692.11 8679,-1691.81 8189.22,-1641.25 6691.54,-1627.26 6156.5,-1623.83"/>
<polygon fill="black" stroke="black" points="6156.39,-1620.33 6146.37,-1623.76 6156.35,-1627.33 6156.39,-1620.33"/>
</g>
<!-- stage0_layer0_exp25&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge87" class="edge">
<title>stage0_layer0_exp25&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M9049.64,-1692.75C9046.74,-1692.42 9043.86,-1692.1 9041,-1691.81 8477.76,-1634.52 6738.64,-1624.8 6156.27,-1623.15"/>
<polygon fill="black" stroke="black" points="6156.11,-1619.65 6146.1,-1623.12 6156.09,-1626.65 6156.11,-1619.65"/>
</g>
<!-- stage0_layer0_exp26&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge88" class="edge">
<title>stage0_layer0_exp26&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M9411.64,-1692.74C9408.74,-1692.41 9405.86,-1692.1 9403,-1691.81 8765.94,-1627.77 6783.19,-1622.6 6156.15,-1622.61"/>
<polygon fill="black" stroke="black" points="6156.11,-1619.11 6146.11,-1622.61 6156.11,-1626.11 6156.11,-1619.11"/>
</g>
<!-- stage0_layer0_exp27&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge89" class="edge">
<title>stage0_layer0_exp27&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M9773.64,-1692.73C9770.74,-1692.4 9767.86,-1692.1 9765,-1691.81 9053.93,-1621.01 6826.25,-1620.62 6156.4,-1622.18"/>
<polygon fill="black" stroke="black" points="6156.16,-1618.68 6146.17,-1622.2 6156.18,-1625.68 6156.16,-1618.68"/>
</g>
<!-- stage0_layer0_exp28&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge90" class="edge">
<title>stage0_layer0_exp28&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M10135.65,-1692.72C10132.74,-1692.4 10129.86,-1692.1 10127,-1691.81 9729.97,-1652.6 6921.55,-1629.7 6156.21,-1624.15"/>
<polygon fill="black" stroke="black" points="6156.22,-1620.65 6146.19,-1624.07 6156.17,-1627.65 6156.22,-1620.65"/>
</g>
<!-- stage0_layer0_exp29&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge91" class="edge">
<title>stage0_layer0_exp29&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M10497.65,-1692.72C10494.74,-1692.4 10491.86,-1692.09 10489,-1691.81 10054.51,-1649.19 6963.49,-1628.57 6156.39,-1623.87"/>
<polygon fill="black" stroke="black" points="6156.15,-1620.37 6146.13,-1623.81 6156.11,-1627.37 6156.15,-1620.37"/>
</g>
<!-- stage0_layer0_exp30&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge92" class="edge">
<title>stage0_layer0_exp30&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M10859.65,-1692.71C10856.74,-1692.39 10853.86,-1692.09 10851,-1691.81 10378.93,-1645.77 7003.38,-1627.52 6156.39,-1623.64"/>
<polygon fill="black" stroke="black" points="6156.25,-1620.14 6146.24,-1623.59 6156.22,-1627.14 6156.25,-1620.14"/>
</g>
<!-- stage0_layer0_exp31&#45;&gt;stage0_layer0_moe_agg -->
<g id="edge93" class="edge">
<title>stage0_layer0_exp31&#45;&gt;stage0_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M11221.65,-1692.71C11218.75,-1692.39 11215.86,-1692.09 11213,-1691.81 10703.27,-1642.35 7042.04,-1626.55 6156.48,-1623.43"/>
<polygon fill="black" stroke="black" points="6156.2,-1619.93 6146.19,-1623.4 6156.17,-1626.93 6156.2,-1619.93"/>
</g>
<!-- stage0_layer0_moe_agg&#45;&gt;stage0_layer0_resid2 -->
<g id="edge95" class="edge">
<title>stage0_layer0_moe_agg&#45;&gt;stage0_layer0_resid2</title>
<path fill="none" stroke="black" d="M6146.26,-1614.21C6651.92,-1595.89 8069.09,-1544.54 8586.65,-1525.78"/>
<polygon fill="black" stroke="black" points="8586.97,-1529.27 8596.83,-1525.41 8586.71,-1522.28 8586.97,-1529.27"/>
</g>
<!-- stage0_layer0_send_stage1 -->
<g id="node58" class="node">
<title>stage0_layer0_send_stage1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="8779" cy="-1410.34" rx="243.49" ry="37.45"/>
<text text-anchor="middle" x="8779" y="-1421.64" font-family="Times,serif" font-size="14.00">stage0_layer0_send_stage1</text>
<text text-anchor="middle" x="8779" y="-1406.64" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="8779" y="-1391.64" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_resid2&#45;&gt;stage0_layer0_send_stage1 -->
<g id="edge96" class="edge">
<title>stage0_layer0_resid2&#45;&gt;stage0_layer0_send_stage1</title>
<path fill="none" stroke="black" d="M8779,-1483.73C8779,-1475.57 8779,-1466.67 8779,-1457.99"/>
<polygon fill="black" stroke="black" points="8782.5,-1457.97 8779,-1447.97 8775.5,-1457.97 8782.5,-1457.97"/>
</g>
<!-- stage1_layer0_recv -->
<g id="node59" class="node">
<title>stage1_layer0_recv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="8779" cy="-1299.38" rx="243.49" ry="37.45"/>
<text text-anchor="middle" x="8779" y="-1310.68" font-family="Times,serif" font-size="14.00">stage1_layer0_recv</text>
<text text-anchor="middle" x="8779" y="-1295.68" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="8779" y="-1280.68" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage0_layer0_send_stage1&#45;&gt;stage1_layer0_recv -->
<g id="edge97" class="edge">
<title>stage0_layer0_send_stage1&#45;&gt;stage1_layer0_recv</title>
<path fill="none" stroke="black" d="M8779,-1372.75C8779,-1364.58 8779,-1355.8 8779,-1347.27"/>
<polygon fill="black" stroke="black" points="8782.5,-1347.06 8779,-1337.06 8775.5,-1347.06 8782.5,-1347.06"/>
</g>
<!-- stage1_layer0_mha_qkv_tp0 -->
<g id="node60" class="node">
<title>stage1_layer0_mha_qkv_tp0</title>
<polygon fill="none" stroke="black" points="7408.5,-1225.91 7037.5,-1225.91 7037.5,-1157.91 7408.5,-1157.91 7408.5,-1225.91"/>
<text text-anchor="middle" x="7223" y="-1210.71" font-family="Times,serif" font-size="14.00">stage1_layer0_mha_qkv_tp0</text>
<text text-anchor="middle" x="7223" y="-1195.71" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="7223" y="-1180.71" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="7223" y="-1165.71" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- stage1_layer0_recv&#45;&gt;stage1_layer0_mha_qkv_tp0 -->
<g id="edge98" class="edge">
<title>stage1_layer0_recv&#45;&gt;stage1_layer0_mha_qkv_tp0</title>
<path fill="none" stroke="black" d="M8538.13,-1293.95C8267.66,-1287.05 7815.68,-1269.72 7418.5,-1226.03"/>
<polygon fill="black" stroke="black" points="7418.86,-1222.55 7408.54,-1224.93 7418.09,-1229.51 7418.86,-1222.55"/>
</g>
<!-- stage1_layer0_mha_qkv_tp1 -->
<g id="node61" class="node">
<title>stage1_layer0_mha_qkv_tp1</title>
<polygon fill="none" stroke="black" points="7797.5,-1225.91 7426.5,-1225.91 7426.5,-1157.91 7797.5,-1157.91 7797.5,-1225.91"/>
<text text-anchor="middle" x="7612" y="-1210.71" font-family="Times,serif" font-size="14.00">stage1_layer0_mha_qkv_tp1</text>
<text text-anchor="middle" x="7612" y="-1195.71" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="7612" y="-1180.71" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="7612" y="-1165.71" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- stage1_layer0_recv&#45;&gt;stage1_layer0_mha_qkv_tp1 -->
<g id="edge99" class="edge">
<title>stage1_layer0_recv&#45;&gt;stage1_layer0_mha_qkv_tp1</title>
<path fill="none" stroke="black" d="M8548.39,-1287.33C8353.37,-1276.54 8066.45,-1257.28 7807.52,-1226.06"/>
<polygon fill="black" stroke="black" points="7807.9,-1222.58 7797.55,-1224.85 7807.05,-1229.53 7807.9,-1222.58"/>
</g>
<!-- stage1_layer0_mha_qkv_tp2 -->
<g id="node62" class="node">
<title>stage1_layer0_mha_qkv_tp2</title>
<polygon fill="none" stroke="black" points="8186.5,-1225.91 7815.5,-1225.91 7815.5,-1157.91 8186.5,-1157.91 8186.5,-1225.91"/>
<text text-anchor="middle" x="8001" y="-1210.71" font-family="Times,serif" font-size="14.00">stage1_layer0_mha_qkv_tp2</text>
<text text-anchor="middle" x="8001" y="-1195.71" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="8001" y="-1180.71" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="8001" y="-1165.71" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- stage1_layer0_recv&#45;&gt;stage1_layer0_mha_qkv_tp2 -->
<g id="edge100" class="edge">
<title>stage1_layer0_recv&#45;&gt;stage1_layer0_mha_qkv_tp2</title>
<path fill="none" stroke="black" d="M8585.7,-1276.61C8474.59,-1263.55 8332.16,-1245.91 8196.73,-1226.14"/>
<polygon fill="black" stroke="black" points="8196.98,-1222.64 8186.57,-1224.65 8195.96,-1229.57 8196.98,-1222.64"/>
</g>
<!-- stage1_layer0_mha_qkv_tp3 -->
<g id="node63" class="node">
<title>stage1_layer0_mha_qkv_tp3</title>
<polygon fill="none" stroke="black" points="8575.5,-1225.91 8204.5,-1225.91 8204.5,-1157.91 8575.5,-1157.91 8575.5,-1225.91"/>
<text text-anchor="middle" x="8390" y="-1210.71" font-family="Times,serif" font-size="14.00">stage1_layer0_mha_qkv_tp3</text>
<text text-anchor="middle" x="8390" y="-1195.71" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="8390" y="-1180.71" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="8390" y="-1165.71" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- stage1_layer0_recv&#45;&gt;stage1_layer0_mha_qkv_tp3 -->
<g id="edge101" class="edge">
<title>stage1_layer0_recv&#45;&gt;stage1_layer0_mha_qkv_tp3</title>
<path fill="none" stroke="black" d="M8661.5,-1266.52C8617.42,-1254.57 8567.06,-1240.92 8521.78,-1228.64"/>
<polygon fill="black" stroke="black" points="8522.47,-1225.2 8511.9,-1225.96 8520.64,-1231.96 8522.47,-1225.2"/>
</g>
<!-- stage1_layer0_mha_qkv_tp4 -->
<g id="node64" class="node">
<title>stage1_layer0_mha_qkv_tp4</title>
<polygon fill="none" stroke="black" points="8964.5,-1225.91 8593.5,-1225.91 8593.5,-1157.91 8964.5,-1157.91 8964.5,-1225.91"/>
<text text-anchor="middle" x="8779" y="-1210.71" font-family="Times,serif" font-size="14.00">stage1_layer0_mha_qkv_tp4</text>
<text text-anchor="middle" x="8779" y="-1195.71" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="8779" y="-1180.71" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="8779" y="-1165.71" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- stage1_layer0_recv&#45;&gt;stage1_layer0_mha_qkv_tp4 -->
<g id="edge102" class="edge">
<title>stage1_layer0_recv&#45;&gt;stage1_layer0_mha_qkv_tp4</title>
<path fill="none" stroke="black" d="M8779,-1261.79C8779,-1253.5 8779,-1244.62 8779,-1236.08"/>
<polygon fill="black" stroke="black" points="8782.5,-1235.91 8779,-1225.91 8775.5,-1235.91 8782.5,-1235.91"/>
</g>
<!-- stage1_layer0_mha_qkv_tp5 -->
<g id="node65" class="node">
<title>stage1_layer0_mha_qkv_tp5</title>
<polygon fill="none" stroke="black" points="9353.5,-1225.91 8982.5,-1225.91 8982.5,-1157.91 9353.5,-1157.91 9353.5,-1225.91"/>
<text text-anchor="middle" x="9168" y="-1210.71" font-family="Times,serif" font-size="14.00">stage1_layer0_mha_qkv_tp5</text>
<text text-anchor="middle" x="9168" y="-1195.71" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="9168" y="-1180.71" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="9168" y="-1165.71" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- stage1_layer0_recv&#45;&gt;stage1_layer0_mha_qkv_tp5 -->
<g id="edge103" class="edge">
<title>stage1_layer0_recv&#45;&gt;stage1_layer0_mha_qkv_tp5</title>
<path fill="none" stroke="black" d="M8896.5,-1266.52C8940.58,-1254.57 8990.94,-1240.92 9036.22,-1228.64"/>
<polygon fill="black" stroke="black" points="9037.36,-1231.96 9046.1,-1225.96 9035.53,-1225.2 9037.36,-1231.96"/>
</g>
<!-- stage1_layer0_mha_qkv_tp6 -->
<g id="node66" class="node">
<title>stage1_layer0_mha_qkv_tp6</title>
<polygon fill="none" stroke="black" points="9742.5,-1225.91 9371.5,-1225.91 9371.5,-1157.91 9742.5,-1157.91 9742.5,-1225.91"/>
<text text-anchor="middle" x="9557" y="-1210.71" font-family="Times,serif" font-size="14.00">stage1_layer0_mha_qkv_tp6</text>
<text text-anchor="middle" x="9557" y="-1195.71" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="9557" y="-1180.71" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="9557" y="-1165.71" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- stage1_layer0_recv&#45;&gt;stage1_layer0_mha_qkv_tp6 -->
<g id="edge104" class="edge">
<title>stage1_layer0_recv&#45;&gt;stage1_layer0_mha_qkv_tp6</title>
<path fill="none" stroke="black" d="M8971.96,-1276.55C9082.88,-1263.48 9225.06,-1245.83 9361.05,-1226.03"/>
<polygon fill="black" stroke="black" points="9361.86,-1229.44 9371.24,-1224.53 9360.84,-1222.52 9361.86,-1229.44"/>
</g>
<!-- stage1_layer0_mha_qkv_tp7 -->
<g id="node67" class="node">
<title>stage1_layer0_mha_qkv_tp7</title>
<polygon fill="none" stroke="black" points="10131.5,-1225.91 9760.5,-1225.91 9760.5,-1157.91 10131.5,-1157.91 10131.5,-1225.91"/>
<text text-anchor="middle" x="9946" y="-1210.71" font-family="Times,serif" font-size="14.00">stage1_layer0_mha_qkv_tp7</text>
<text text-anchor="middle" x="9946" y="-1195.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="9946" y="-1180.71" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="9946" y="-1165.71" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- stage1_layer0_recv&#45;&gt;stage1_layer0_mha_qkv_tp7 -->
<g id="edge105" class="edge">
<title>stage1_layer0_recv&#45;&gt;stage1_layer0_mha_qkv_tp7</title>
<path fill="none" stroke="black" d="M9009.61,-1287.33C9204.63,-1276.54 9491.55,-1257.28 9750.48,-1226.06"/>
<polygon fill="black" stroke="black" points="9750.95,-1229.53 9760.45,-1224.85 9750.1,-1222.58 9750.95,-1229.53"/>
</g>
<!-- stage1_layer0_resid1 -->
<g id="node80" class="node">
<title>stage1_layer0_resid1</title>
<polygon fill="none" stroke="black" points="9657,-588 9313,-588 9313,-520 9657,-520 9657,-588"/>
<text text-anchor="middle" x="9485" y="-572.8" font-family="Times,serif" font-size="14.00">stage1_layer0_resid1</text>
<text text-anchor="middle" x="9485" y="-557.8" font-family="Times,serif" font-size="14.00">GPU: all_stage1</text>
<text text-anchor="middle" x="9485" y="-542.8" font-family="Times,serif" font-size="14.00">In: x2</text>
<text text-anchor="middle" x="9485" y="-527.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_recv&#45;&gt;stage1_layer0_resid1 -->
<g id="edge132" class="edge">
<title>stage1_layer0_recv&#45;&gt;stage1_layer0_resid1</title>
<path fill="none" stroke="black" d="M9019.35,-1293.47C9399.4,-1284.59 10100.51,-1263.23 10141,-1225.91 10187.32,-1183.2 10160,-1148.43 10160,-1085.43 10160,-1085.43 10160,-1085.43 10160,-767.95 10160,-664.33 9867.04,-604.82 9667.12,-576.27"/>
<polygon fill="black" stroke="black" points="9667.47,-572.78 9657.08,-574.85 9666.49,-579.71 9667.47,-572.78"/>
</g>
<!-- stage1_layer0_ag_qkv -->
<g id="node68" class="node">
<title>stage1_layer0_ag_qkv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="8605" cy="-1084.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="8605" y="-1095.73" font-family="Times,serif" font-size="14.00">stage1_layer0_ag_qkv</text>
<text text-anchor="middle" x="8605" y="-1080.73" font-family="Times,serif" font-size="14.00">In: shard</text>
<text text-anchor="middle" x="8605" y="-1065.73" font-family="Times,serif" font-size="14.00">Out: full</text>
</g>
<!-- stage1_layer0_mha_qkv_tp0&#45;&gt;stage1_layer0_ag_qkv -->
<g id="edge106" class="edge">
<title>stage1_layer0_mha_qkv_tp0&#45;&gt;stage1_layer0_ag_qkv</title>
<path fill="none" stroke="black" d="M7408.54,-1158.91C7411.38,-1158.57 7414.2,-1158.23 7417,-1157.91 7798.91,-1113.9 8253.17,-1095.58 8472.91,-1088.85"/>
<polygon fill="black" stroke="black" points="8473.31,-1092.34 8483.2,-1088.54 8473.09,-1085.34 8473.31,-1092.34"/>
</g>
<!-- stage1_layer0_mha_qkv_tp1&#45;&gt;stage1_layer0_ag_qkv -->
<g id="edge107" class="edge">
<title>stage1_layer0_mha_qkv_tp1&#45;&gt;stage1_layer0_ag_qkv</title>
<path fill="none" stroke="black" d="M7797.56,-1159.03C7800.39,-1158.65 7803.21,-1158.27 7806,-1157.91 8041.33,-1127.27 8317.34,-1105.31 8475.64,-1094.05"/>
<polygon fill="black" stroke="black" points="8476.17,-1097.52 8485.89,-1093.32 8475.67,-1090.53 8476.17,-1097.52"/>
</g>
<!-- stage1_layer0_mha_qkv_tp2&#45;&gt;stage1_layer0_ag_qkv -->
<g id="edge108" class="edge">
<title>stage1_layer0_mha_qkv_tp2&#45;&gt;stage1_layer0_ag_qkv</title>
<path fill="none" stroke="black" d="M8186.74,-1158.47C8285.78,-1141.17 8404.52,-1120.44 8490.14,-1105.49"/>
<polygon fill="black" stroke="black" points="8490.9,-1108.91 8500.15,-1103.74 8489.7,-1102.01 8490.9,-1108.91"/>
</g>
<!-- stage1_layer0_mha_qkv_tp3&#45;&gt;stage1_layer0_ag_qkv -->
<g id="edge109" class="edge">
<title>stage1_layer0_mha_qkv_tp3&#45;&gt;stage1_layer0_ag_qkv</title>
<path fill="none" stroke="black" d="M8457.44,-1157.82C8481.24,-1146.14 8508.11,-1132.96 8532.33,-1121.08"/>
<polygon fill="black" stroke="black" points="8534.03,-1124.14 8541.47,-1116.6 8530.95,-1117.86 8534.03,-1124.14"/>
</g>
<!-- stage1_layer0_mha_qkv_tp4&#45;&gt;stage1_layer0_ag_qkv -->
<g id="edge110" class="edge">
<title>stage1_layer0_mha_qkv_tp4&#45;&gt;stage1_layer0_ag_qkv</title>
<path fill="none" stroke="black" d="M8724.42,-1157.82C8706.44,-1146.92 8686.3,-1134.71 8667.76,-1123.47"/>
<polygon fill="black" stroke="black" points="8669.45,-1120.41 8659.09,-1118.22 8665.82,-1126.39 8669.45,-1120.41"/>
</g>
<!-- stage1_layer0_mha_qkv_tp5&#45;&gt;stage1_layer0_ag_qkv -->
<g id="edge111" class="edge">
<title>stage1_layer0_mha_qkv_tp5&#45;&gt;stage1_layer0_ag_qkv</title>
<path fill="none" stroke="black" d="M8991.79,-1157.89C8902.4,-1141.15 8796.45,-1121.3 8718.06,-1106.61"/>
<polygon fill="black" stroke="black" points="8718.63,-1103.16 8708.16,-1104.76 8717.34,-1110.04 8718.63,-1103.16"/>
</g>
<!-- stage1_layer0_mha_qkv_tp6&#45;&gt;stage1_layer0_ag_qkv -->
<g id="edge112" class="edge">
<title>stage1_layer0_mha_qkv_tp6&#45;&gt;stage1_layer0_ag_qkv</title>
<path fill="none" stroke="black" d="M9371.26,-1159.16C9368.15,-1158.73 9365.06,-1158.31 9362,-1157.91 9141.94,-1128.79 8884.4,-1106.66 8733.54,-1094.89"/>
<polygon fill="black" stroke="black" points="8733.55,-1091.38 8723.31,-1094.1 8733.01,-1098.36 8733.55,-1091.38"/>
</g>
<!-- stage1_layer0_mha_qkv_tp7&#45;&gt;stage1_layer0_ag_qkv -->
<g id="edge113" class="edge">
<title>stage1_layer0_mha_qkv_tp7&#45;&gt;stage1_layer0_ag_qkv</title>
<path fill="none" stroke="black" d="M9760.46,-1158.92C9757.62,-1158.57 9754.8,-1158.23 9752,-1157.91 9385.71,-1115.3 8950.48,-1096.44 8736.77,-1089.24"/>
<polygon fill="black" stroke="black" points="8736.87,-1085.74 8726.76,-1088.91 8736.64,-1092.74 8736.87,-1085.74"/>
</g>
<!-- stage1_layer0_mha_score -->
<g id="node69" class="node">
<title>stage1_layer0_mha_score</title>
<polygon fill="none" stroke="black" points="8810,-1010.95 8400,-1010.95 8400,-942.95 8810,-942.95 8810,-1010.95"/>
<text text-anchor="middle" x="8605" y="-995.75" font-family="Times,serif" font-size="14.00">stage1_layer0_mha_score</text>
<text text-anchor="middle" x="8605" y="-980.75" font-family="Times,serif" font-size="14.00">GPU: all_stage1</text>
<text text-anchor="middle" x="8605" y="-965.75" font-family="Times,serif" font-size="14.00">In: full</text>
<text text-anchor="middle" x="8605" y="-950.75" font-family="Times,serif" font-size="14.00">Out: batch_size, heads=16, seq_len=128, seq_len=128</text>
</g>
<!-- stage1_layer0_ag_qkv&#45;&gt;stage1_layer0_mha_score -->
<g id="edge114" class="edge">
<title>stage1_layer0_ag_qkv&#45;&gt;stage1_layer0_mha_score</title>
<path fill="none" stroke="black" d="M8605,-1046.84C8605,-1038.54 8605,-1029.66 8605,-1021.13"/>
<polygon fill="black" stroke="black" points="8608.5,-1020.95 8605,-1010.95 8601.5,-1020.95 8608.5,-1020.95"/>
</g>
<!-- stage1_layer0_mha_softmax -->
<g id="node70" class="node">
<title>stage1_layer0_mha_softmax</title>
<polygon fill="none" stroke="black" points="8810,-906.95 8400,-906.95 8400,-838.95 8810,-838.95 8810,-906.95"/>
<text text-anchor="middle" x="8605" y="-891.75" font-family="Times,serif" font-size="14.00">stage1_layer0_mha_softmax</text>
<text text-anchor="middle" x="8605" y="-876.75" font-family="Times,serif" font-size="14.00">GPU: all_stage1</text>
<text text-anchor="middle" x="8605" y="-861.75" font-family="Times,serif" font-size="14.00">In: batch_size, heads=16, seq_len=128, seq_len=128</text>
<text text-anchor="middle" x="8605" y="-846.75" font-family="Times,serif" font-size="14.00">Out: batch_size, heads=16, seq_len=128, seq_len=128</text>
</g>
<!-- stage1_layer0_mha_score&#45;&gt;stage1_layer0_mha_softmax -->
<g id="edge115" class="edge">
<title>stage1_layer0_mha_score&#45;&gt;stage1_layer0_mha_softmax</title>
<path fill="none" stroke="black" d="M8605,-942.84C8605,-934.73 8605,-925.94 8605,-917.43"/>
<polygon fill="black" stroke="black" points="8608.5,-917.25 8605,-907.25 8601.5,-917.25 8608.5,-917.25"/>
</g>
<!-- stage1_layer0_mha_out_tp0 -->
<g id="node71" class="node">
<title>stage1_layer0_mha_out_tp0</title>
<polygon fill="none" stroke="black" points="7472,-802.95 7110,-802.95 7110,-734.95 7472,-734.95 7472,-802.95"/>
<text text-anchor="middle" x="7291" y="-787.75" font-family="Times,serif" font-size="14.00">stage1_layer0_mha_out_tp0</text>
<text text-anchor="middle" x="7291" y="-772.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="7291" y="-757.75" font-family="Times,serif" font-size="14.00">In: full</text>
<text text-anchor="middle" x="7291" y="-742.75" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//8</text>
</g>
<!-- stage1_layer0_mha_softmax&#45;&gt;stage1_layer0_mha_out_tp0 -->
<g id="edge116" class="edge">
<title>stage1_layer0_mha_softmax&#45;&gt;stage1_layer0_mha_out_tp0</title>
<path fill="none" stroke="black" d="M8399.8,-866.17C8176.33,-858.31 7808.31,-840.77 7482.32,-803.06"/>
<polygon fill="black" stroke="black" points="7482.54,-799.57 7472.21,-801.89 7481.73,-806.52 7482.54,-799.57"/>
</g>
<!-- stage1_layer0_mha_out_tp1 -->
<g id="node72" class="node">
<title>stage1_layer0_mha_out_tp1</title>
<polygon fill="none" stroke="black" points="7852,-802.95 7490,-802.95 7490,-734.95 7852,-734.95 7852,-802.95"/>
<text text-anchor="middle" x="7671" y="-787.75" font-family="Times,serif" font-size="14.00">stage1_layer0_mha_out_tp1</text>
<text text-anchor="middle" x="7671" y="-772.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="7671" y="-757.75" font-family="Times,serif" font-size="14.00">In: full</text>
<text text-anchor="middle" x="7671" y="-742.75" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//8</text>
</g>
<!-- stage1_layer0_mha_softmax&#45;&gt;stage1_layer0_mha_out_tp1 -->
<g id="edge117" class="edge">
<title>stage1_layer0_mha_softmax&#45;&gt;stage1_layer0_mha_out_tp1</title>
<path fill="none" stroke="black" d="M8399.64,-857.32C8252.59,-845.79 8049.75,-827.74 7862.27,-803.09"/>
<polygon fill="black" stroke="black" points="7862.6,-799.6 7852.22,-801.76 7861.68,-806.54 7862.6,-799.6"/>
</g>
<!-- stage1_layer0_mha_out_tp2 -->
<g id="node73" class="node">
<title>stage1_layer0_mha_out_tp2</title>
<polygon fill="none" stroke="black" points="8232,-802.95 7870,-802.95 7870,-734.95 8232,-734.95 8232,-802.95"/>
<text text-anchor="middle" x="8051" y="-787.75" font-family="Times,serif" font-size="14.00">stage1_layer0_mha_out_tp2</text>
<text text-anchor="middle" x="8051" y="-772.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="8051" y="-757.75" font-family="Times,serif" font-size="14.00">In: full</text>
<text text-anchor="middle" x="8051" y="-742.75" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//8</text>
</g>
<!-- stage1_layer0_mha_softmax&#45;&gt;stage1_layer0_mha_out_tp2 -->
<g id="edge118" class="edge">
<title>stage1_layer0_mha_softmax&#45;&gt;stage1_layer0_mha_out_tp2</title>
<path fill="none" stroke="black" d="M8425.51,-838.91C8366.39,-828.02 8300.47,-815.88 8240.61,-804.86"/>
<polygon fill="black" stroke="black" points="8241.14,-801.4 8230.67,-803.03 8239.87,-808.29 8241.14,-801.4"/>
</g>
<!-- stage1_layer0_mha_out_tp3 -->
<g id="node74" class="node">
<title>stage1_layer0_mha_out_tp3</title>
<polygon fill="none" stroke="black" points="8612,-802.95 8250,-802.95 8250,-734.95 8612,-734.95 8612,-802.95"/>
<text text-anchor="middle" x="8431" y="-787.75" font-family="Times,serif" font-size="14.00">stage1_layer0_mha_out_tp3</text>
<text text-anchor="middle" x="8431" y="-772.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="8431" y="-757.75" font-family="Times,serif" font-size="14.00">In: full</text>
<text text-anchor="middle" x="8431" y="-742.75" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//8</text>
</g>
<!-- stage1_layer0_mha_softmax&#45;&gt;stage1_layer0_mha_out_tp3 -->
<g id="edge119" class="edge">
<title>stage1_layer0_mha_softmax&#45;&gt;stage1_layer0_mha_out_tp3</title>
<path fill="none" stroke="black" d="M8548.51,-838.84C8531.86,-829.08 8513.51,-818.32 8496.35,-808.26"/>
<polygon fill="black" stroke="black" points="8497.9,-805.12 8487.51,-803.08 8494.36,-811.15 8497.9,-805.12"/>
</g>
<!-- stage1_layer0_mha_out_tp4 -->
<g id="node75" class="node">
<title>stage1_layer0_mha_out_tp4</title>
<polygon fill="none" stroke="black" points="8992,-802.95 8630,-802.95 8630,-734.95 8992,-734.95 8992,-802.95"/>
<text text-anchor="middle" x="8811" y="-787.75" font-family="Times,serif" font-size="14.00">stage1_layer0_mha_out_tp4</text>
<text text-anchor="middle" x="8811" y="-772.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="8811" y="-757.75" font-family="Times,serif" font-size="14.00">In: full</text>
<text text-anchor="middle" x="8811" y="-742.75" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//8</text>
</g>
<!-- stage1_layer0_mha_softmax&#45;&gt;stage1_layer0_mha_out_tp4 -->
<g id="edge120" class="edge">
<title>stage1_layer0_mha_softmax&#45;&gt;stage1_layer0_mha_out_tp4</title>
<path fill="none" stroke="black" d="M8671.88,-838.84C8692.04,-828.85 8714.32,-817.83 8735.02,-807.57"/>
<polygon fill="black" stroke="black" points="8736.69,-810.65 8744.1,-803.08 8733.59,-804.38 8736.69,-810.65"/>
</g>
<!-- stage1_layer0_mha_out_tp5 -->
<g id="node76" class="node">
<title>stage1_layer0_mha_out_tp5</title>
<polygon fill="none" stroke="black" points="9372,-802.95 9010,-802.95 9010,-734.95 9372,-734.95 9372,-802.95"/>
<text text-anchor="middle" x="9191" y="-787.75" font-family="Times,serif" font-size="14.00">stage1_layer0_mha_out_tp5</text>
<text text-anchor="middle" x="9191" y="-772.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="9191" y="-757.75" font-family="Times,serif" font-size="14.00">In: full</text>
<text text-anchor="middle" x="9191" y="-742.75" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//8</text>
</g>
<!-- stage1_layer0_mha_softmax&#45;&gt;stage1_layer0_mha_out_tp5 -->
<g id="edge121" class="edge">
<title>stage1_layer0_mha_softmax&#45;&gt;stage1_layer0_mha_out_tp5</title>
<path fill="none" stroke="black" d="M8794.85,-838.91C8860.51,-827.48 8934.1,-814.67 8999.86,-803.22"/>
<polygon fill="black" stroke="black" points="9000.67,-806.63 9009.92,-801.47 8999.47,-799.74 9000.67,-806.63"/>
</g>
<!-- stage1_layer0_mha_out_tp6 -->
<g id="node77" class="node">
<title>stage1_layer0_mha_out_tp6</title>
<polygon fill="none" stroke="black" points="9752,-802.95 9390,-802.95 9390,-734.95 9752,-734.95 9752,-802.95"/>
<text text-anchor="middle" x="9571" y="-787.75" font-family="Times,serif" font-size="14.00">stage1_layer0_mha_out_tp6</text>
<text text-anchor="middle" x="9571" y="-772.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="9571" y="-757.75" font-family="Times,serif" font-size="14.00">In: full</text>
<text text-anchor="middle" x="9571" y="-742.75" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//8</text>
</g>
<!-- stage1_layer0_mha_softmax&#45;&gt;stage1_layer0_mha_out_tp6 -->
<g id="edge122" class="edge">
<title>stage1_layer0_mha_softmax&#45;&gt;stage1_layer0_mha_out_tp6</title>
<path fill="none" stroke="black" d="M8810.15,-858.39C8964.28,-847.09 9180.73,-828.86 9379.72,-803.09"/>
<polygon fill="black" stroke="black" points="9380.32,-806.54 9389.78,-801.77 9379.41,-799.6 9380.32,-806.54"/>
</g>
<!-- stage1_layer0_mha_out_tp7 -->
<g id="node78" class="node">
<title>stage1_layer0_mha_out_tp7</title>
<polygon fill="none" stroke="black" points="10132,-802.95 9770,-802.95 9770,-734.95 10132,-734.95 10132,-802.95"/>
<text text-anchor="middle" x="9951" y="-787.75" font-family="Times,serif" font-size="14.00">stage1_layer0_mha_out_tp7</text>
<text text-anchor="middle" x="9951" y="-772.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="9951" y="-757.75" font-family="Times,serif" font-size="14.00">In: full</text>
<text text-anchor="middle" x="9951" y="-742.75" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//8</text>
</g>
<!-- stage1_layer0_mha_softmax&#45;&gt;stage1_layer0_mha_out_tp7 -->
<g id="edge123" class="edge">
<title>stage1_layer0_mha_softmax&#45;&gt;stage1_layer0_mha_out_tp7</title>
<path fill="none" stroke="black" d="M8810.25,-866.66C9039.58,-859.15 9421.93,-841.85 9759.81,-803.05"/>
<polygon fill="black" stroke="black" points="9760.26,-806.52 9769.79,-801.89 9759.46,-799.57 9760.26,-806.52"/>
</g>
<!-- stage1_layer0_ar_mha -->
<g id="node79" class="node">
<title>stage1_layer0_ar_mha</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="8811" cy="-661.48" rx="124.4" ry="37.45"/>
<text text-anchor="middle" x="8811" y="-672.78" font-family="Times,serif" font-size="14.00">stage1_layer0_ar_mha</text>
<text text-anchor="middle" x="8811" y="-657.78" font-family="Times,serif" font-size="14.00">In: shard</text>
<text text-anchor="middle" x="8811" y="-642.78" font-family="Times,serif" font-size="14.00">Out: full</text>
</g>
<!-- stage1_layer0_mha_out_tp0&#45;&gt;stage1_layer0_ar_mha -->
<g id="edge124" class="edge">
<title>stage1_layer0_mha_out_tp0&#45;&gt;stage1_layer0_ar_mha</title>
<path fill="none" stroke="black" d="M7472.2,-735.99C7475.16,-735.63 7478.09,-735.28 7481,-734.95 7916.47,-685.44 8436.13,-669.52 8676.63,-664.58"/>
<polygon fill="black" stroke="black" points="8676.9,-668.08 8686.82,-664.38 8676.76,-661.08 8676.9,-668.08"/>
</g>
<!-- stage1_layer0_mha_out_tp1&#45;&gt;stage1_layer0_ar_mha -->
<g id="edge125" class="edge">
<title>stage1_layer0_mha_out_tp1&#45;&gt;stage1_layer0_ar_mha</title>
<path fill="none" stroke="black" d="M7852.21,-736.08C7855.16,-735.69 7858.09,-735.32 7861,-734.95 8151.51,-698.73 8494.42,-677.95 8678.41,-668.57"/>
<polygon fill="black" stroke="black" points="8678.59,-672.07 8688.4,-668.07 8678.24,-665.08 8678.59,-672.07"/>
</g>
<!-- stage1_layer0_mha_out_tp2&#45;&gt;stage1_layer0_ar_mha -->
<g id="edge126" class="edge">
<title>stage1_layer0_mha_out_tp2&#45;&gt;stage1_layer0_ar_mha</title>
<path fill="none" stroke="black" d="M8232.24,-736.29C8235.18,-735.83 8238.1,-735.39 8241,-734.95 8393.65,-712 8570.01,-690.32 8685.66,-676.75"/>
<polygon fill="black" stroke="black" points="8686.09,-680.23 8695.61,-675.59 8685.27,-673.27 8686.09,-680.23"/>
</g>
<!-- stage1_layer0_mha_out_tp3&#45;&gt;stage1_layer0_ar_mha -->
<g id="edge127" class="edge">
<title>stage1_layer0_mha_out_tp3&#45;&gt;stage1_layer0_ar_mha</title>
<path fill="none" stroke="black" d="M8549.93,-734.94C8601.77,-720.55 8661.87,-703.87 8711.32,-690.15"/>
<polygon fill="black" stroke="black" points="8712.36,-693.49 8721.06,-687.44 8710.49,-686.74 8712.36,-693.49"/>
</g>
<!-- stage1_layer0_mha_out_tp4&#45;&gt;stage1_layer0_ar_mha -->
<g id="edge128" class="edge">
<title>stage1_layer0_mha_out_tp4&#45;&gt;stage1_layer0_ar_mha</title>
<path fill="none" stroke="black" d="M8811,-734.87C8811,-726.71 8811,-717.81 8811,-709.13"/>
<polygon fill="black" stroke="black" points="8814.5,-709.11 8811,-699.11 8807.5,-709.11 8814.5,-709.11"/>
</g>
<!-- stage1_layer0_mha_out_tp5&#45;&gt;stage1_layer0_ar_mha -->
<g id="edge129" class="edge">
<title>stage1_layer0_mha_out_tp5&#45;&gt;stage1_layer0_ar_mha</title>
<path fill="none" stroke="black" d="M9072.07,-734.94C9020.23,-720.55 8960.13,-703.87 8910.68,-690.15"/>
<polygon fill="black" stroke="black" points="8911.51,-686.74 8900.94,-687.44 8909.64,-693.49 8911.51,-686.74"/>
</g>
<!-- stage1_layer0_mha_out_tp6&#45;&gt;stage1_layer0_ar_mha -->
<g id="edge130" class="edge">
<title>stage1_layer0_mha_out_tp6&#45;&gt;stage1_layer0_ar_mha</title>
<path fill="none" stroke="black" d="M9389.76,-736.29C9386.82,-735.83 9383.9,-735.39 9381,-734.95 9228.35,-712 9051.99,-690.32 8936.34,-676.75"/>
<polygon fill="black" stroke="black" points="8936.73,-673.27 8926.39,-675.59 8935.91,-680.23 8936.73,-673.27"/>
</g>
<!-- stage1_layer0_mha_out_tp7&#45;&gt;stage1_layer0_ar_mha -->
<g id="edge131" class="edge">
<title>stage1_layer0_mha_out_tp7&#45;&gt;stage1_layer0_ar_mha</title>
<path fill="none" stroke="black" d="M9769.79,-736.08C9766.84,-735.69 9763.91,-735.32 9761,-734.95 9470.49,-698.73 9127.58,-677.95 8943.59,-668.57"/>
<polygon fill="black" stroke="black" points="8943.76,-665.08 8933.6,-668.07 8943.41,-672.07 8943.76,-665.08"/>
</g>
<!-- stage1_layer0_ar_mha&#45;&gt;stage1_layer0_resid1 -->
<g id="edge133" class="edge">
<title>stage1_layer0_ar_mha&#45;&gt;stage1_layer0_resid1</title>
<path fill="none" stroke="black" d="M8920.41,-643.35C9023.67,-627.2 9180.42,-602.66 9302.58,-583.55"/>
<polygon fill="black" stroke="black" points="9303.46,-586.95 9312.8,-581.95 9302.38,-580.04 9303.46,-586.95"/>
</g>
<!-- stage1_layer0_moe_gate -->
<g id="node81" class="node">
<title>stage1_layer0_moe_gate</title>
<polygon fill="none" stroke="black" points="6836,-484 6504,-484 6504,-416 6836,-416 6836,-484"/>
<text text-anchor="middle" x="6670" y="-468.8" font-family="Times,serif" font-size="14.00">stage1_layer0_moe_gate</text>
<text text-anchor="middle" x="6670" y="-453.8" font-family="Times,serif" font-size="14.00">GPU: all_stage1</text>
<text text-anchor="middle" x="6670" y="-438.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="6670" y="-423.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, 64</text>
</g>
<!-- stage1_layer0_resid1&#45;&gt;stage1_layer0_moe_gate -->
<g id="edge134" class="edge">
<title>stage1_layer0_resid1&#45;&gt;stage1_layer0_moe_gate</title>
<path fill="none" stroke="black" d="M9312.88,-546.76C8811.13,-528.58 7353.43,-475.76 6846.35,-457.39"/>
<polygon fill="black" stroke="black" points="6846.13,-453.88 6836.01,-457.02 6845.88,-460.88 6846.13,-453.88"/>
</g>
<!-- stage1_layer0_resid2 -->
<g id="node115" class="node">
<title>stage1_layer0_resid2</title>
<polygon fill="none" stroke="black" points="9657,-172 9313,-172 9313,-104 9657,-104 9657,-172"/>
<text text-anchor="middle" x="9485" y="-156.8" font-family="Times,serif" font-size="14.00">stage1_layer0_resid2</text>
<text text-anchor="middle" x="9485" y="-141.8" font-family="Times,serif" font-size="14.00">GPU: all_stage1</text>
<text text-anchor="middle" x="9485" y="-126.8" font-family="Times,serif" font-size="14.00">In: x2</text>
<text text-anchor="middle" x="9485" y="-111.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_resid1&#45;&gt;stage1_layer0_resid2 -->
<g id="edge199" class="edge">
<title>stage1_layer0_resid1&#45;&gt;stage1_layer0_resid2</title>
<path fill="none" stroke="black" d="M9657.2,-548.78C10252.32,-533.36 12190.83,-475.93 12281,-380 12301.7,-357.98 12301.7,-334.02 12281,-312 12191.33,-216.61 10274.04,-159.29 9667.35,-143.49"/>
<polygon fill="black" stroke="black" points="9667.29,-139.98 9657.2,-143.22 9667.11,-146.98 9667.29,-139.98"/>
</g>
<!-- stage1_layer0_exp32 -->
<g id="node82" class="node">
<title>stage1_layer0_exp32</title>
<polygon fill="none" stroke="black" points="1050,-380 706,-380 706,-312 1050,-312 1050,-380"/>
<text text-anchor="middle" x="878" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp32</text>
<text text-anchor="middle" x="878" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="878" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="878" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp32 -->
<g id="edge135" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp32</title>
<path fill="none" stroke="black" d="M6503.87,-448.62C5637.93,-446.43 1658.89,-433.57 1060.58,-380.06"/>
<polygon fill="black" stroke="black" points="1060.63,-376.55 1050.35,-379.11 1059.99,-383.52 1060.63,-376.55"/>
</g>
<!-- stage1_layer0_exp33 -->
<g id="node83" class="node">
<title>stage1_layer0_exp33</title>
<polygon fill="none" stroke="black" points="1412,-380 1068,-380 1068,-312 1412,-312 1412,-380"/>
<text text-anchor="middle" x="1240" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp33</text>
<text text-anchor="middle" x="1240" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="1240" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="1240" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp33 -->
<g id="edge136" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp33</title>
<path fill="none" stroke="black" d="M6503.7,-448.47C5672.13,-445.6 1983.17,-430.17 1422.71,-380.07"/>
<polygon fill="black" stroke="black" points="1422.64,-376.55 1412.35,-379.11 1421.99,-383.52 1422.64,-376.55"/>
</g>
<!-- stage1_layer0_exp34 -->
<g id="node84" class="node">
<title>stage1_layer0_exp34</title>
<polygon fill="none" stroke="black" points="1774,-380 1430,-380 1430,-312 1774,-312 1774,-380"/>
<text text-anchor="middle" x="1602" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp34</text>
<text text-anchor="middle" x="1602" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="1602" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="1602" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp34 -->
<g id="edge137" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp34</title>
<path fill="none" stroke="black" d="M6503.72,-448.3C5707.88,-444.7 2305.35,-426.77 1784.34,-380.04"/>
<polygon fill="black" stroke="black" points="1784.64,-376.55 1774.35,-379.1 1783.98,-383.52 1784.64,-376.55"/>
</g>
<!-- stage1_layer0_exp35 -->
<g id="node85" class="node">
<title>stage1_layer0_exp35</title>
<polygon fill="none" stroke="black" points="2136,-380 1792,-380 1792,-312 2136,-312 2136,-380"/>
<text text-anchor="middle" x="1964" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp35</text>
<text text-anchor="middle" x="1964" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="1964" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="1964" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp35 -->
<g id="edge138" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp35</title>
<path fill="none" stroke="black" d="M6503.82,-448.09C5745.55,-443.74 2630.44,-423.4 2146.63,-380.06"/>
<polygon fill="black" stroke="black" points="2146.64,-376.55 2136.35,-379.1 2145.98,-383.51 2146.64,-376.55"/>
</g>
<!-- stage1_layer0_exp36 -->
<g id="node86" class="node">
<title>stage1_layer0_exp36</title>
<polygon fill="none" stroke="black" points="2498,-380 2154,-380 2154,-312 2498,-312 2498,-380"/>
<text text-anchor="middle" x="2326" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp36</text>
<text text-anchor="middle" x="2326" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="2326" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="2326" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp36 -->
<g id="edge139" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp36</title>
<path fill="none" stroke="black" d="M6503.97,-447.86C5784.59,-442.69 2953.42,-420.04 2508.42,-380.04"/>
<polygon fill="black" stroke="black" points="2508.64,-376.54 2498.35,-379.09 2507.98,-383.51 2508.64,-376.54"/>
</g>
<!-- stage1_layer0_exp37 -->
<g id="node87" class="node">
<title>stage1_layer0_exp37</title>
<polygon fill="none" stroke="black" points="2860,-380 2516,-380 2516,-312 2860,-312 2860,-380"/>
<text text-anchor="middle" x="2688" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp37</text>
<text text-anchor="middle" x="2688" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="2688" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="2688" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp37 -->
<g id="edge140" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp37</title>
<path fill="none" stroke="black" d="M6503.91,-449.57C5871.15,-451.19 3610.24,-451.76 2870.33,-380.07"/>
<polygon fill="black" stroke="black" points="2870.65,-376.58 2860.36,-379.09 2869.97,-383.55 2870.65,-376.58"/>
</g>
<!-- stage1_layer0_exp38 -->
<g id="node88" class="node">
<title>stage1_layer0_exp38</title>
<polygon fill="none" stroke="black" points="3222,-380 2878,-380 2878,-312 3222,-312 3222,-380"/>
<text text-anchor="middle" x="3050" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp38</text>
<text text-anchor="middle" x="3050" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="3050" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="3050" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp38 -->
<g id="edge141" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp38</title>
<path fill="none" stroke="black" d="M6503.9,-449.2C5910.8,-449.35 3897.95,-445.01 3232.54,-380.09"/>
<polygon fill="black" stroke="black" points="3232.65,-376.58 3222.36,-379.08 3231.96,-383.55 3232.65,-376.58"/>
</g>
<!-- stage1_layer0_exp39 -->
<g id="node89" class="node">
<title>stage1_layer0_exp39</title>
<polygon fill="none" stroke="black" points="3584,-380 3240,-380 3240,-312 3584,-312 3584,-380"/>
<text text-anchor="middle" x="3412" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp39</text>
<text text-anchor="middle" x="3412" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="3412" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="3412" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp39 -->
<g id="edge142" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp39</title>
<path fill="none" stroke="black" d="M6503.93,-448.73C5952.73,-447.31 4185.83,-438.29 3594.69,-380.1"/>
<polygon fill="black" stroke="black" points="3594.66,-376.58 3584.36,-379.07 3593.96,-383.55 3594.66,-376.58"/>
</g>
<!-- stage1_layer0_exp40 -->
<g id="node90" class="node">
<title>stage1_layer0_exp40</title>
<polygon fill="none" stroke="black" points="3946,-380 3602,-380 3602,-312 3946,-312 3946,-380"/>
<text text-anchor="middle" x="3774" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp40</text>
<text text-anchor="middle" x="3774" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="3774" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="3774" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp40 -->
<g id="edge143" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp40</title>
<path fill="none" stroke="black" d="M6503.73,-448.15C5996.62,-445.03 4473.29,-431.6 3956.51,-380.09"/>
<polygon fill="black" stroke="black" points="3956.66,-376.58 3946.36,-379.06 3955.95,-383.55 3956.66,-376.58"/>
</g>
<!-- stage1_layer0_exp41 -->
<g id="node91" class="node">
<title>stage1_layer0_exp41</title>
<polygon fill="none" stroke="black" points="4308,-380 3964,-380 3964,-312 4308,-312 4308,-380"/>
<text text-anchor="middle" x="4136" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp41</text>
<text text-anchor="middle" x="4136" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="4136" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="4136" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp41 -->
<g id="edge144" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp41</title>
<path fill="none" stroke="black" d="M6503.72,-447.39C6044,-442.43 4761.22,-424.94 4318.34,-380.07"/>
<polygon fill="black" stroke="black" points="4318.67,-376.59 4308.36,-379.04 4317.95,-383.55 4318.67,-376.59"/>
</g>
<!-- stage1_layer0_exp42 -->
<g id="node92" class="node">
<title>stage1_layer0_exp42</title>
<polygon fill="none" stroke="black" points="4670,-380 4326,-380 4326,-312 4670,-312 4670,-380"/>
<text text-anchor="middle" x="4498" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp42</text>
<text text-anchor="middle" x="4498" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="4498" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="4498" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp42 -->
<g id="edge145" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp42</title>
<path fill="none" stroke="black" d="M6503.76,-446.36C6095.45,-439.37 5050.34,-418.35 4680.57,-380.1"/>
<polygon fill="black" stroke="black" points="4680.67,-376.59 4670.36,-379.02 4679.94,-383.55 4680.67,-376.59"/>
</g>
<!-- stage1_layer0_exp43 -->
<g id="node93" class="node">
<title>stage1_layer0_exp43</title>
<polygon fill="none" stroke="black" points="5032,-380 4688,-380 4688,-312 5032,-312 5032,-380"/>
<text text-anchor="middle" x="4860" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp43</text>
<text text-anchor="middle" x="4860" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="4860" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="4860" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp43 -->
<g id="edge146" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp43</title>
<path fill="none" stroke="black" d="M6503.8,-449.51C6210.34,-448.75 5581.26,-439.62 5042.68,-380.13"/>
<polygon fill="black" stroke="black" points="5042.69,-376.61 5032.37,-378.99 5041.92,-383.57 5042.69,-376.61"/>
</g>
<!-- stage1_layer0_exp44 -->
<g id="node94" class="node">
<title>stage1_layer0_exp44</title>
<polygon fill="none" stroke="black" points="5394,-380 5050,-380 5050,-312 5394,-312 5394,-380"/>
<text text-anchor="middle" x="5222" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp44</text>
<text text-anchor="middle" x="5222" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="5222" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="5222" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp44 -->
<g id="edge147" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp44</title>
<path fill="none" stroke="black" d="M6503.91,-446.61C6263.27,-441.66 5803.68,-426.59 5404.39,-380.11"/>
<polygon fill="black" stroke="black" points="5404.71,-376.63 5394.37,-378.94 5403.9,-383.58 5404.71,-376.63"/>
</g>
<!-- stage1_layer0_exp45 -->
<g id="node95" class="node">
<title>stage1_layer0_exp45</title>
<polygon fill="none" stroke="black" points="5756,-380 5412,-380 5412,-312 5756,-312 5756,-380"/>
<text text-anchor="middle" x="5584" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp45</text>
<text text-anchor="middle" x="5584" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="5584" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="5584" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp45 -->
<g id="edge148" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp45</title>
<path fill="none" stroke="black" d="M6503.92,-441.54C6324.31,-432.27 6029.49,-413.6 5766.51,-380.15"/>
<polygon fill="black" stroke="black" points="5766.75,-376.65 5756.38,-378.85 5765.86,-383.6 5766.75,-376.65"/>
</g>
<!-- stage1_layer0_exp46 -->
<g id="node96" class="node">
<title>stage1_layer0_exp46</title>
<polygon fill="none" stroke="black" points="6118,-380 5774,-380 5774,-312 6118,-312 6118,-380"/>
<text text-anchor="middle" x="5946" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp46</text>
<text text-anchor="middle" x="5946" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="5946" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="5946" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp46 -->
<g id="edge149" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp46</title>
<path fill="none" stroke="black" d="M6503.92,-430.25C6398.99,-417.84 6260.33,-400.4 6128.68,-380.24"/>
<polygon fill="black" stroke="black" points="6128.83,-376.72 6118.41,-378.65 6127.76,-383.63 6128.83,-376.72"/>
</g>
<!-- stage1_layer0_exp47 -->
<g id="node97" class="node">
<title>stage1_layer0_exp47</title>
<polygon fill="none" stroke="black" points="6480,-380 6136,-380 6136,-312 6480,-312 6480,-380"/>
<text text-anchor="middle" x="6308" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp47</text>
<text text-anchor="middle" x="6308" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="6308" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="6308" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp47 -->
<g id="edge150" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp47</title>
<path fill="none" stroke="black" d="M6552.47,-415.88C6514.88,-405.29 6473.11,-393.52 6434.89,-382.75"/>
<polygon fill="black" stroke="black" points="6435.83,-379.38 6425.25,-380.04 6433.93,-386.12 6435.83,-379.38"/>
</g>
<!-- stage1_layer0_exp48 -->
<g id="node98" class="node">
<title>stage1_layer0_exp48</title>
<polygon fill="none" stroke="black" points="6842,-380 6498,-380 6498,-312 6842,-312 6842,-380"/>
<text text-anchor="middle" x="6670" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp48</text>
<text text-anchor="middle" x="6670" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="6670" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="6670" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp48 -->
<g id="edge151" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp48</title>
<path fill="none" stroke="black" d="M6670,-415.88C6670,-407.78 6670,-398.98 6670,-390.47"/>
<polygon fill="black" stroke="black" points="6673.5,-390.3 6670,-380.3 6666.5,-390.3 6673.5,-390.3"/>
</g>
<!-- stage1_layer0_exp49 -->
<g id="node99" class="node">
<title>stage1_layer0_exp49</title>
<polygon fill="none" stroke="black" points="7204,-380 6860,-380 6860,-312 7204,-312 7204,-380"/>
<text text-anchor="middle" x="7032" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp49</text>
<text text-anchor="middle" x="7032" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="7032" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="7032" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp49 -->
<g id="edge152" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp49</title>
<path fill="none" stroke="black" d="M6787.53,-415.88C6825.12,-405.29 6866.89,-393.52 6905.11,-382.75"/>
<polygon fill="black" stroke="black" points="6906.07,-386.12 6914.75,-380.04 6904.17,-379.38 6906.07,-386.12"/>
</g>
<!-- stage1_layer0_exp50 -->
<g id="node100" class="node">
<title>stage1_layer0_exp50</title>
<polygon fill="none" stroke="black" points="7566,-380 7222,-380 7222,-312 7566,-312 7566,-380"/>
<text text-anchor="middle" x="7394" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp50</text>
<text text-anchor="middle" x="7394" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="7394" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="7394" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp50 -->
<g id="edge153" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp50</title>
<path fill="none" stroke="black" d="M6836.08,-430.25C6941.01,-417.84 7079.67,-400.4 7211.32,-380.24"/>
<polygon fill="black" stroke="black" points="7212.24,-383.63 7221.59,-378.65 7211.17,-376.72 7212.24,-383.63"/>
</g>
<!-- stage1_layer0_exp51 -->
<g id="node101" class="node">
<title>stage1_layer0_exp51</title>
<polygon fill="none" stroke="black" points="7928,-380 7584,-380 7584,-312 7928,-312 7928,-380"/>
<text text-anchor="middle" x="7756" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp51</text>
<text text-anchor="middle" x="7756" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="7756" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="7756" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp51 -->
<g id="edge154" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp51</title>
<path fill="none" stroke="black" d="M6836.08,-441.54C7015.69,-432.27 7310.51,-413.6 7573.49,-380.15"/>
<polygon fill="black" stroke="black" points="7574.14,-383.6 7583.62,-378.85 7573.25,-376.65 7574.14,-383.6"/>
</g>
<!-- stage1_layer0_exp52 -->
<g id="node102" class="node">
<title>stage1_layer0_exp52</title>
<polygon fill="none" stroke="black" points="8290,-380 7946,-380 7946,-312 8290,-312 8290,-380"/>
<text text-anchor="middle" x="8118" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp52</text>
<text text-anchor="middle" x="8118" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="8118" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="8118" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp52 -->
<g id="edge155" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp52</title>
<path fill="none" stroke="black" d="M6836.09,-446.61C7076.73,-441.66 7536.32,-426.59 7935.61,-380.11"/>
<polygon fill="black" stroke="black" points="7936.1,-383.58 7945.63,-378.94 7935.29,-376.63 7936.1,-383.58"/>
</g>
<!-- stage1_layer0_exp53 -->
<g id="node103" class="node">
<title>stage1_layer0_exp53</title>
<polygon fill="none" stroke="black" points="8652,-380 8308,-380 8308,-312 8652,-312 8652,-380"/>
<text text-anchor="middle" x="8480" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp53</text>
<text text-anchor="middle" x="8480" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="8480" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="8480" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp53 -->
<g id="edge156" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp53</title>
<path fill="none" stroke="black" d="M6836.2,-449.51C7129.66,-448.75 7758.74,-439.62 8297.32,-380.13"/>
<polygon fill="black" stroke="black" points="8298.08,-383.57 8307.63,-378.99 8297.31,-376.61 8298.08,-383.57"/>
</g>
<!-- stage1_layer0_exp54 -->
<g id="node104" class="node">
<title>stage1_layer0_exp54</title>
<polygon fill="none" stroke="black" points="9014,-380 8670,-380 8670,-312 9014,-312 9014,-380"/>
<text text-anchor="middle" x="8842" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp54</text>
<text text-anchor="middle" x="8842" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="8842" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="8842" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp54 -->
<g id="edge157" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp54</title>
<path fill="none" stroke="black" d="M6836.24,-446.36C7244.55,-439.37 8289.66,-418.35 8659.43,-380.1"/>
<polygon fill="black" stroke="black" points="8660.06,-383.55 8669.64,-379.02 8659.33,-376.59 8660.06,-383.55"/>
</g>
<!-- stage1_layer0_exp55 -->
<g id="node105" class="node">
<title>stage1_layer0_exp55</title>
<polygon fill="none" stroke="black" points="9376,-380 9032,-380 9032,-312 9376,-312 9376,-380"/>
<text text-anchor="middle" x="9204" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp55</text>
<text text-anchor="middle" x="9204" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="9204" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="9204" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp55 -->
<g id="edge158" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp55</title>
<path fill="none" stroke="black" d="M6836.28,-447.39C7296,-442.43 8578.78,-424.94 9021.66,-380.07"/>
<polygon fill="black" stroke="black" points="9022.05,-383.55 9031.64,-379.04 9021.33,-376.59 9022.05,-383.55"/>
</g>
<!-- stage1_layer0_exp56 -->
<g id="node106" class="node">
<title>stage1_layer0_exp56</title>
<polygon fill="none" stroke="black" points="9738,-380 9394,-380 9394,-312 9738,-312 9738,-380"/>
<text text-anchor="middle" x="9566" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp56</text>
<text text-anchor="middle" x="9566" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="9566" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="9566" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp56 -->
<g id="edge159" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp56</title>
<path fill="none" stroke="black" d="M6836.27,-448.15C7343.38,-445.03 8866.71,-431.6 9383.49,-380.09"/>
<polygon fill="black" stroke="black" points="9384.05,-383.55 9393.64,-379.06 9383.34,-376.58 9384.05,-383.55"/>
</g>
<!-- stage1_layer0_exp57 -->
<g id="node107" class="node">
<title>stage1_layer0_exp57</title>
<polygon fill="none" stroke="black" points="10100,-380 9756,-380 9756,-312 10100,-312 10100,-380"/>
<text text-anchor="middle" x="9928" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp57</text>
<text text-anchor="middle" x="9928" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="9928" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="9928" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp57 -->
<g id="edge160" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp57</title>
<path fill="none" stroke="black" d="M6836.07,-448.73C7387.27,-447.31 9154.17,-438.29 9745.31,-380.1"/>
<polygon fill="black" stroke="black" points="9746.04,-383.55 9755.64,-379.07 9745.34,-376.58 9746.04,-383.55"/>
</g>
<!-- stage1_layer0_exp58 -->
<g id="node108" class="node">
<title>stage1_layer0_exp58</title>
<polygon fill="none" stroke="black" points="10462,-380 10118,-380 10118,-312 10462,-312 10462,-380"/>
<text text-anchor="middle" x="10290" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp58</text>
<text text-anchor="middle" x="10290" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="10290" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="10290" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp58 -->
<g id="edge161" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp58</title>
<path fill="none" stroke="black" d="M6836.1,-449.2C7429.2,-449.35 9442.05,-445.01 10107.46,-380.09"/>
<polygon fill="black" stroke="black" points="10108.04,-383.55 10117.64,-379.08 10107.35,-376.58 10108.04,-383.55"/>
</g>
<!-- stage1_layer0_exp59 -->
<g id="node109" class="node">
<title>stage1_layer0_exp59</title>
<polygon fill="none" stroke="black" points="10824,-380 10480,-380 10480,-312 10824,-312 10824,-380"/>
<text text-anchor="middle" x="10652" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp59</text>
<text text-anchor="middle" x="10652" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="10652" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="10652" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp59 -->
<g id="edge162" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp59</title>
<path fill="none" stroke="black" d="M6836.09,-449.57C7468.85,-451.19 9729.76,-451.76 10469.67,-380.07"/>
<polygon fill="black" stroke="black" points="10470.03,-383.55 10479.64,-379.09 10469.35,-376.58 10470.03,-383.55"/>
</g>
<!-- stage1_layer0_exp60 -->
<g id="node110" class="node">
<title>stage1_layer0_exp60</title>
<polygon fill="none" stroke="black" points="11186,-380 10842,-380 10842,-312 11186,-312 11186,-380"/>
<text text-anchor="middle" x="11014" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp60</text>
<text text-anchor="middle" x="11014" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="11014" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="11014" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp60 -->
<g id="edge163" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp60</title>
<path fill="none" stroke="black" d="M6836.03,-447.86C7555.41,-442.69 10386.58,-420.04 10831.58,-380.04"/>
<polygon fill="black" stroke="black" points="10832.02,-383.51 10841.65,-379.09 10831.36,-376.54 10832.02,-383.51"/>
</g>
<!-- stage1_layer0_exp61 -->
<g id="node111" class="node">
<title>stage1_layer0_exp61</title>
<polygon fill="none" stroke="black" points="11548,-380 11204,-380 11204,-312 11548,-312 11548,-380"/>
<text text-anchor="middle" x="11376" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp61</text>
<text text-anchor="middle" x="11376" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="11376" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="11376" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp61 -->
<g id="edge164" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp61</title>
<path fill="none" stroke="black" d="M6836.18,-448.09C7594.45,-443.74 10709.56,-423.4 11193.37,-380.06"/>
<polygon fill="black" stroke="black" points="11194.02,-383.51 11203.65,-379.1 11193.36,-376.55 11194.02,-383.51"/>
</g>
<!-- stage1_layer0_exp62 -->
<g id="node112" class="node">
<title>stage1_layer0_exp62</title>
<polygon fill="none" stroke="black" points="11910,-380 11566,-380 11566,-312 11910,-312 11910,-380"/>
<text text-anchor="middle" x="11738" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp62</text>
<text text-anchor="middle" x="11738" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="11738" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="11738" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp62 -->
<g id="edge165" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp62</title>
<path fill="none" stroke="black" d="M6836.28,-448.3C7632.12,-444.7 11034.65,-426.77 11555.66,-380.04"/>
<polygon fill="black" stroke="black" points="11556.02,-383.52 11565.65,-379.1 11555.36,-376.55 11556.02,-383.52"/>
</g>
<!-- stage1_layer0_exp63 -->
<g id="node113" class="node">
<title>stage1_layer0_exp63</title>
<polygon fill="none" stroke="black" points="12272,-380 11928,-380 11928,-312 12272,-312 12272,-380"/>
<text text-anchor="middle" x="12100" y="-364.8" font-family="Times,serif" font-size="14.00">stage1_layer0_exp63</text>
<text text-anchor="middle" x="12100" y="-349.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="12100" y="-334.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="12100" y="-319.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp63 -->
<g id="edge166" class="edge">
<title>stage1_layer0_moe_gate&#45;&gt;stage1_layer0_exp63</title>
<path fill="none" stroke="black" d="M6836.3,-448.47C7667.87,-445.6 11356.83,-430.17 11917.29,-380.07"/>
<polygon fill="black" stroke="black" points="11918.01,-383.52 11927.65,-379.11 11917.36,-376.55 11918.01,-383.52"/>
</g>
<!-- stage1_layer0_moe_agg -->
<g id="node114" class="node">
<title>stage1_layer0_moe_agg</title>
<polygon fill="none" stroke="black" points="6842,-276 6498,-276 6498,-208 6842,-208 6842,-276"/>
<text text-anchor="middle" x="6670" y="-260.8" font-family="Times,serif" font-size="14.00">stage1_layer0_moe_agg</text>
<text text-anchor="middle" x="6670" y="-245.8" font-family="Times,serif" font-size="14.00">GPU: all_stage1</text>
<text text-anchor="middle" x="6670" y="-230.8" font-family="Times,serif" font-size="14.00">In: x4</text>
<text text-anchor="middle" x="6670" y="-215.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_exp32&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge167" class="edge">
<title>stage1_layer0_exp32&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M1050.35,-312.89C1053.25,-312.57 1056.14,-312.28 1059,-312 1608.5,-258.91 5583.86,-245.74 6487.56,-243.42"/>
<polygon fill="black" stroke="black" points="6487.74,-246.92 6497.73,-243.39 6487.72,-239.92 6487.74,-246.92"/>
</g>
<!-- stage1_layer0_exp33&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge168" class="edge">
<title>stage1_layer0_exp33&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M1412.35,-312.89C1415.25,-312.58 1418.14,-312.28 1421,-312 1932.71,-262.34 5620.4,-246.62 6487.7,-243.59"/>
<polygon fill="black" stroke="black" points="6487.79,-247.09 6497.77,-243.55 6487.76,-240.09 6487.79,-247.09"/>
</g>
<!-- stage1_layer0_exp34&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge169" class="edge">
<title>stage1_layer0_exp34&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M1774.35,-312.9C1777.26,-312.58 1780.14,-312.28 1783,-312 2256.92,-265.78 5657.09,-247.56 6487.44,-243.78"/>
<polygon fill="black" stroke="black" points="6487.7,-247.28 6497.69,-243.73 6487.67,-240.28 6487.7,-247.28"/>
</g>
<!-- stage1_layer0_exp35&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge170" class="edge">
<title>stage1_layer0_exp35&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M2136.35,-312.9C2139.26,-312.58 2142.14,-312.28 2145,-312 2581.31,-269.19 5696.52,-248.58 6487.66,-244"/>
<polygon fill="black" stroke="black" points="6487.74,-247.5 6497.71,-243.94 6487.69,-240.5 6487.74,-247.5"/>
</g>
<!-- stage1_layer0_exp36&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge171" class="edge">
<title>stage1_layer0_exp36&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M2498.35,-312.91C2501.26,-312.59 2504.14,-312.28 2507,-312 2905.77,-272.61 5737.14,-249.69 6487.74,-244.26"/>
<polygon fill="black" stroke="black" points="6487.86,-247.76 6497.83,-244.19 6487.81,-240.76 6487.86,-247.76"/>
</g>
<!-- stage1_layer0_exp37&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge172" class="edge">
<title>stage1_layer0_exp37&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M2860.36,-312.91C2863.26,-312.59 2866.14,-312.28 2869,-312 3583.75,-240.83 5830.82,-240.8 6487.86,-242.39"/>
<polygon fill="black" stroke="black" points="6487.88,-245.89 6497.89,-242.42 6487.9,-238.89 6487.88,-245.89"/>
</g>
<!-- stage1_layer0_exp38&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge173" class="edge">
<title>stage1_layer0_exp38&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M3222.36,-312.92C3225.26,-312.6 3228.14,-312.29 3231,-312 3871.41,-247.61 5871.71,-242.74 6487.64,-242.8"/>
<polygon fill="black" stroke="black" points="6487.94,-246.3 6497.94,-242.8 6487.94,-239.3 6487.94,-246.3"/>
</g>
<!-- stage1_layer0_exp39&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge174" class="edge">
<title>stage1_layer0_exp39&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M3584.36,-312.93C3587.26,-312.6 3590.14,-312.29 3593,-312 4159.32,-254.39 5914.42,-244.88 6487.18,-243.31"/>
<polygon fill="black" stroke="black" points="6487.61,-246.81 6497.6,-243.28 6487.59,-239.81 6487.61,-246.81"/>
</g>
<!-- stage1_layer0_exp40&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge175" class="edge">
<title>stage1_layer0_exp40&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M3946.36,-312.94C3949.26,-312.61 3952.14,-312.3 3955,-312 4447.86,-261.12 5961.35,-247.28 6487.49,-243.95"/>
<polygon fill="black" stroke="black" points="6487.85,-247.45 6497.83,-243.89 6487.81,-240.45 6487.85,-247.45"/>
</g>
<!-- stage1_layer0_exp41&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge176" class="edge">
<title>stage1_layer0_exp41&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M4308.36,-312.96C4311.26,-312.62 4314.14,-312.3 4317,-312 4736.83,-267.83 6011.41,-250.01 6487.79,-244.78"/>
<polygon fill="black" stroke="black" points="6487.9,-248.28 6497.86,-244.67 6487.82,-241.28 6487.9,-248.28"/>
</g>
<!-- stage1_layer0_exp42&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge177" class="edge">
<title>stage1_layer0_exp42&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M4670.36,-312.98C4673.26,-312.64 4676.14,-312.31 4679,-312 5026.18,-274.54 6064.36,-253.24 6487.48,-245.92"/>
<polygon fill="black" stroke="black" points="6487.73,-249.42 6497.67,-245.75 6487.61,-242.42 6487.73,-249.42"/>
</g>
<!-- stage1_layer0_exp43&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge178" class="edge">
<title>stage1_layer0_exp43&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M5032.37,-313.01C5035.26,-312.66 5038.14,-312.32 5041,-312 5563.76,-253.56 6185.93,-243.6 6487.74,-242.54"/>
<polygon fill="black" stroke="black" points="6487.91,-246.04 6497.9,-242.5 6487.89,-239.04 6487.91,-246.04"/>
</g>
<!-- stage1_layer0_exp44&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge179" class="edge">
<title>stage1_layer0_exp44&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M5394.37,-313.06C5397.27,-312.69 5400.15,-312.34 5403,-312 5787.37,-266.68 6240.91,-251.07 6487.64,-245.73"/>
<polygon fill="black" stroke="black" points="6487.86,-249.23 6497.78,-245.51 6487.71,-242.23 6487.86,-249.23"/>
</g>
<!-- stage1_layer0_exp45&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge180" class="edge">
<title>stage1_layer0_exp45&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M5756.38,-313.15C5759.27,-312.75 5762.15,-312.37 5765,-312 6014.37,-279.85 6304.47,-260.97 6487.64,-251.31"/>
<polygon fill="black" stroke="black" points="6487.84,-254.81 6497.64,-250.79 6487.48,-247.81 6487.84,-254.81"/>
</g>
<!-- stage1_layer0_exp46&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge181" class="edge">
<title>stage1_layer0_exp46&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M6118.41,-313.35C6121.29,-312.89 6124.16,-312.44 6127,-312 6246.86,-293.47 6382.18,-276.27 6487.75,-263.67"/>
<polygon fill="black" stroke="black" points="6488.35,-267.12 6497.87,-262.47 6487.52,-260.17 6488.35,-267.12"/>
</g>
<!-- stage1_layer0_exp47&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge182" class="edge">
<title>stage1_layer0_exp47&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M6425.53,-311.88C6463.12,-301.29 6504.89,-289.52 6543.11,-278.75"/>
<polygon fill="black" stroke="black" points="6544.07,-282.12 6552.75,-276.04 6542.17,-275.38 6544.07,-282.12"/>
</g>
<!-- stage1_layer0_exp48&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge183" class="edge">
<title>stage1_layer0_exp48&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M6670,-311.88C6670,-303.78 6670,-294.98 6670,-286.47"/>
<polygon fill="black" stroke="black" points="6673.5,-286.3 6670,-276.3 6666.5,-286.3 6673.5,-286.3"/>
</g>
<!-- stage1_layer0_exp49&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge184" class="edge">
<title>stage1_layer0_exp49&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M6914.47,-311.88C6876.88,-301.29 6835.11,-289.52 6796.89,-278.75"/>
<polygon fill="black" stroke="black" points="6797.83,-275.38 6787.25,-276.04 6795.93,-282.12 6797.83,-275.38"/>
</g>
<!-- stage1_layer0_exp50&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge185" class="edge">
<title>stage1_layer0_exp50&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M7221.59,-313.35C7218.71,-312.89 7215.84,-312.44 7213,-312 7093.14,-293.47 6957.82,-276.27 6852.25,-263.67"/>
<polygon fill="black" stroke="black" points="6852.48,-260.17 6842.13,-262.47 6851.65,-267.12 6852.48,-260.17"/>
</g>
<!-- stage1_layer0_exp51&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge186" class="edge">
<title>stage1_layer0_exp51&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M7583.62,-313.15C7580.73,-312.75 7577.85,-312.37 7575,-312 7325.63,-279.85 7035.53,-260.97 6852.36,-251.31"/>
<polygon fill="black" stroke="black" points="6852.52,-247.81 6842.36,-250.79 6852.16,-254.81 6852.52,-247.81"/>
</g>
<!-- stage1_layer0_exp52&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge187" class="edge">
<title>stage1_layer0_exp52&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M7945.63,-313.06C7942.73,-312.69 7939.85,-312.34 7937,-312 7552.63,-266.68 7099.09,-251.07 6852.36,-245.73"/>
<polygon fill="black" stroke="black" points="6852.29,-242.23 6842.22,-245.51 6852.14,-249.23 6852.29,-242.23"/>
</g>
<!-- stage1_layer0_exp53&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge188" class="edge">
<title>stage1_layer0_exp53&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M8307.63,-313.01C8304.74,-312.66 8301.86,-312.32 8299,-312 7776.24,-253.56 7154.07,-243.6 6852.26,-242.54"/>
<polygon fill="black" stroke="black" points="6852.11,-239.04 6842.1,-242.5 6852.09,-246.04 6852.11,-239.04"/>
</g>
<!-- stage1_layer0_exp54&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge189" class="edge">
<title>stage1_layer0_exp54&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M8669.64,-312.98C8666.74,-312.64 8663.86,-312.31 8661,-312 8313.82,-274.54 7275.64,-253.24 6852.52,-245.92"/>
<polygon fill="black" stroke="black" points="6852.39,-242.42 6842.33,-245.75 6852.27,-249.42 6852.39,-242.42"/>
</g>
<!-- stage1_layer0_exp55&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge190" class="edge">
<title>stage1_layer0_exp55&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M9031.64,-312.96C9028.74,-312.62 9025.86,-312.3 9023,-312 8603.17,-267.83 7328.59,-250.01 6852.21,-244.78"/>
<polygon fill="black" stroke="black" points="6852.18,-241.28 6842.14,-244.67 6852.1,-248.28 6852.18,-241.28"/>
</g>
<!-- stage1_layer0_exp56&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge191" class="edge">
<title>stage1_layer0_exp56&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M9393.64,-312.94C9390.74,-312.61 9387.86,-312.3 9385,-312 8892.14,-261.12 7378.65,-247.28 6852.51,-243.95"/>
<polygon fill="black" stroke="black" points="6852.19,-240.45 6842.17,-243.89 6852.15,-247.45 6852.19,-240.45"/>
</g>
<!-- stage1_layer0_exp57&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge192" class="edge">
<title>stage1_layer0_exp57&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M9755.64,-312.93C9752.74,-312.6 9749.86,-312.29 9747,-312 9180.68,-254.39 7425.58,-244.88 6852.82,-243.31"/>
<polygon fill="black" stroke="black" points="6852.41,-239.81 6842.4,-243.28 6852.39,-246.81 6852.41,-239.81"/>
</g>
<!-- stage1_layer0_exp58&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge193" class="edge">
<title>stage1_layer0_exp58&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M10117.64,-312.92C10114.74,-312.6 10111.86,-312.29 10109,-312 9468.59,-247.61 7468.29,-242.74 6852.36,-242.8"/>
<polygon fill="black" stroke="black" points="6852.06,-239.3 6842.06,-242.8 6852.06,-246.3 6852.06,-239.3"/>
</g>
<!-- stage1_layer0_exp59&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge194" class="edge">
<title>stage1_layer0_exp59&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M10479.64,-312.91C10476.74,-312.59 10473.86,-312.28 10471,-312 9756.25,-240.83 7509.18,-240.8 6852.14,-242.39"/>
<polygon fill="black" stroke="black" points="6852.1,-238.89 6842.11,-242.42 6852.12,-245.89 6852.1,-238.89"/>
</g>
<!-- stage1_layer0_exp60&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge195" class="edge">
<title>stage1_layer0_exp60&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M10841.65,-312.91C10838.74,-312.59 10835.86,-312.28 10833,-312 10434.23,-272.61 7602.86,-249.69 6852.26,-244.26"/>
<polygon fill="black" stroke="black" points="6852.19,-240.76 6842.17,-244.19 6852.14,-247.76 6852.19,-240.76"/>
</g>
<!-- stage1_layer0_exp61&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge196" class="edge">
<title>stage1_layer0_exp61&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M11203.65,-312.9C11200.74,-312.58 11197.86,-312.28 11195,-312 10758.69,-269.19 7643.48,-248.58 6852.34,-244"/>
<polygon fill="black" stroke="black" points="6852.31,-240.5 6842.29,-243.94 6852.26,-247.5 6852.31,-240.5"/>
</g>
<!-- stage1_layer0_exp62&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge197" class="edge">
<title>stage1_layer0_exp62&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M11565.65,-312.9C11562.74,-312.58 11559.86,-312.28 11557,-312 11083.08,-265.78 7682.91,-247.56 6852.56,-243.78"/>
<polygon fill="black" stroke="black" points="6852.33,-240.28 6842.31,-243.73 6852.3,-247.28 6852.33,-240.28"/>
</g>
<!-- stage1_layer0_exp63&#45;&gt;stage1_layer0_moe_agg -->
<g id="edge198" class="edge">
<title>stage1_layer0_exp63&#45;&gt;stage1_layer0_moe_agg</title>
<path fill="none" stroke="black" d="M11927.65,-312.89C11924.75,-312.58 11921.86,-312.28 11919,-312 11407.29,-262.34 7719.6,-246.62 6852.3,-243.59"/>
<polygon fill="black" stroke="black" points="6852.24,-240.09 6842.23,-243.55 6852.21,-247.09 6852.24,-240.09"/>
</g>
<!-- stage1_layer0_moe_agg&#45;&gt;stage1_layer0_resid2 -->
<g id="edge200" class="edge">
<title>stage1_layer0_moe_agg&#45;&gt;stage1_layer0_resid2</title>
<path fill="none" stroke="black" d="M6842.12,-234.76C7341.91,-216.65 8790.23,-164.17 9302.69,-145.61"/>
<polygon fill="black" stroke="black" points="9302.9,-149.1 9312.76,-145.24 9302.64,-142.11 9302.9,-149.1"/>
</g>
<!-- OUTPUT -->
<g id="node116" class="node">
<title>OUTPUT</title>
<polygon fill="none" stroke="black" points="9657,-68 9313,-68 9313,0 9657,0 9657,-68"/>
<text text-anchor="middle" x="9485" y="-52.8" font-family="Times,serif" font-size="14.00">OUTPUT</text>
<text text-anchor="middle" x="9485" y="-37.8" font-family="Times,serif" font-size="14.00">GPU: all</text>
<text text-anchor="middle" x="9485" y="-22.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="9485" y="-7.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- stage1_layer0_resid2&#45;&gt;OUTPUT -->
<g id="edge201" class="edge">
<title>stage1_layer0_resid2&#45;&gt;OUTPUT</title>
<path fill="none" stroke="black" d="M9485,-103.88C9485,-95.78 9485,-86.98 9485,-78.47"/>
<polygon fill="black" stroke="black" points="9488.5,-78.3 9485,-68.3 9481.5,-78.3 9488.5,-78.3"/>
</g>
</g>
</svg>
